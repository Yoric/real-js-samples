var getWxLoginMethod=function(){var qTimer=null;var timerAuto=null;var qrData={"client_key":"","qrcode_url":""};var Qrcode={getQrcode:function(){$.ajax({url:"http://vip.book.sina.com.cn/weibobook/mp/mp_qrcode.php",type:"GET",cache:false,dataType:"json",success:function(data){if(data.status.code==0){qrData=data.data;$("#qrs").attr("src",qrData.qrcode_url);qTimer=setInterval(function(){if(qrData.qrcode_url!=""){Qrcode.checkStatus()}},3000)}else{$("#outTimeTips").html("二维码获取失败,请"+"<a href=''>"+" 刷新 "+"</a>"+"后重试")}},error:function(data){}})},checkStatus:function(){$.ajax({url:"http://vip.book.sina.com.cn/weibobook/mp/mp_status.php",type:"GET",data:{"client_key":encodeURI(qrData.client_key)},cache:false,dataType:"json",success:function(data){if(data.status.code==0){if(qTimer){clearInterval(qTimer)}Qrcode.loginQCode()}else{if(data.status.code!=5){if(qTimer){clearInterval(qTimer)}}}},error:function(data){if(qTimer){clearInterval(qTimer)}}})},loginQCode:function(){window.location.reload()}};var docHeight=$(document).height();var top=($(window).height()-500)/2;var left=($(window).width()-802)/2;var scrollTop=$(document).scrollTop();var scrollLeft=$(document).scrollLeft();var staticPath=_cfg["static"].slice(-1)=="/"?_cfg["static"]:_cfg["static"]+"/";var html='<div id="mask">';html+='     <img src= "'+staticPath+"paidRead/assets/images/logo-news.png"+'" id="title">';html+='     <img src="'+staticPath+"paidRead/assets/images/wxLogin-left.png"+'" id="left">';html+='     <div id="right">';html+="        <p>微信扫码 , 关注后自动登录</p>";html+='        <div><img id="qrs"></div>';html+='        <p id="outTimeTips"></p>';html+='        <span id="other-login">使用其他账号登录  >></span>';html+="     </div>";html+='     <img src="'+staticPath+"paidRead/assets/images/wxLogin-close.png"+'" id="close">';html+="   </div>";$("body").append('<div id="overlay"></div>');$("body").append(html);$("#overlay").height(docHeight).css({"opacity":0.2,"position":"absolute","top":0,"left":0,"background-color":"rgb(0, 0, 0)","width":"100%","z-index":5000});$("#mask").css({"opacity":1,"position":"absolute","top":top+scrollTop,"left":left+scrollLeft,"height":"412px","width":"698px","background-color":"#fff","z-index":6000,"border-radius":"20px","padding":"23px 78px 65px 26px"});$("#title").css({"display":"block","height":"38px","width":"96px","margin-bottom":"17px",});$("#left").css({"height":"286px","width":"197px","margin-right":"142px","margin-left":"92px","margin-bottom":"10px"});$("#right").css({"display":"inline-block",});$("#right > p:first-child").css({"font-size":"20px","color":"#666","margin-bottom":"27px","text-align":"center"});$("#right > div").css({"width":"240px","height":"240px","padding":"10px",});$("#right > div > img").css({"width":"240px","height":"240px",});$("#right > span").css({"display":"block","font-size":"14px","color":"#FF9B32","text-align":"center","cursor":"pointer","margin-top":"14px"});$("#outTimeTips").css({"color":"#f00","text-align":"center","font-size":"16px",});$("#close").css({"opacity":1,"position":"absolute","top":"-13px","right":"-13px","height":"42px","width":"42px","z-index":6001,"border-radius":"15px"});Qrcode.getQrcode();timerAuto=setTimeout(function(){$("#overlay").remove();$("#mask").remove();if(qTimer){clearInterval(qTimer)}},270000);$("#close").live("click",function(){$("#overlay").remove();$("#mask").remove();if(qTimer){clearInterval(qTimer)}if(timerAuto){clearTimeout(timerAuto)}});$("#other-login").live("click",function(){$("#overlay").remove();$("#mask").remove();if(qTimer){clearInterval(qTimer)}if(timerAuto){clearTimeout(timerAuto)}WBtopPublic.showLoginLayer({"lang":"zh-cn","loginSuccessUrl":window.location.href?window.location.href:""});return false})};var SMK=window.SMK||{};var gCacheData={};var gNewCacheData={};var gLoadico='<div class="load_32_32"><p></p><div>拼命的为您加载中，请稍后..</div></div>';var gMiniLoadico='<div class="loadmini"><p></p></div>';SMK.namespace=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=SMK;for(var i=(levels[0]=="SMK")?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};String.prototype.strLength=function(type){var flag=type==undefined?false:true;var count=0;for(var i=0;i<this.length;i++){if(this.charCodeAt(i)>255){count+=2}else{count++}}if(!flag){return count}if(Math.round(count/2)==1){var strlenth=1}else{var strlenth=Math.round(count/2)}return strlenth};String.prototype.strCut=function(len){var wlen=this.strLength(),str;if(wlen>len){var c=this.replace(/&/g," ").replace(/[^\x00-\xff]/g,"&&");str=this.slice(0,c.slice(0,len).replace(/&&/g," ").replace(/&/g,"").length)}return str};String.prototype.codeUrl=function(isCode){var flag=typeof isCode=="undefined"||isCode?true:false;var newStr="";if(flag){newStr=encodeURIComponent(this);newStr=newStr.replace(/\*/g,"%2A");newStr=newStr.replace(/\!/g,"%21");newStr=newStr.replace(/\(/g,"%28");newStr=newStr.replace(/\)/g,"%29");newStr=newStr.replace(/\'/g,"%27")}else{newStr=decodeURIComponent(this)
}return newStr};SMK.namespace("SMK.pop");SMK.namespace("SMK.util");SMK.namespace("SMK.xing");SMK.namespace("SMK.sen");SMK.util.customArray=function(arr,type,flag){var index,len=arr.length;if(type){var retVal=Math.max.apply({},arr)}else{var retVal=Math.min.apply({},arr)}for(var i=0;i<len;i++){if(arr[i]==retVal){index=i;break}}return flag?{val:retVal,index:index}:retVal};SMK.namespace("SMK.md5");(function(c){var b=0;var a="";var d=8;SMK.md5.val=function(e){return SMK.md5.binl2hex(SMK.md5.core(SMK.md5.str2binl(e),e.length*d))};SMK.md5.core=function(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=SMK.md5.f(o,n,m,l,p[g+0],7,-680876936);l=SMK.md5.f(l,o,n,m,p[g+1],12,-389564586);m=SMK.md5.f(m,l,o,n,p[g+2],17,606105819);n=SMK.md5.f(n,m,l,o,p[g+3],22,-1044525330);o=SMK.md5.f(o,n,m,l,p[g+4],7,-176418897);l=SMK.md5.f(l,o,n,m,p[g+5],12,1200080426);m=SMK.md5.f(m,l,o,n,p[g+6],17,-1473231341);n=SMK.md5.f(n,m,l,o,p[g+7],22,-45705983);o=SMK.md5.f(o,n,m,l,p[g+8],7,1770035416);l=SMK.md5.f(l,o,n,m,p[g+9],12,-1958414417);m=SMK.md5.f(m,l,o,n,p[g+10],17,-42063);n=SMK.md5.f(n,m,l,o,p[g+11],22,-1990404162);o=SMK.md5.f(o,n,m,l,p[g+12],7,1804603682);l=SMK.md5.f(l,o,n,m,p[g+13],12,-40341101);m=SMK.md5.f(m,l,o,n,p[g+14],17,-1502002290);n=SMK.md5.f(n,m,l,o,p[g+15],22,1236535329);o=SMK.md5.g(o,n,m,l,p[g+1],5,-165796510);l=SMK.md5.g(l,o,n,m,p[g+6],9,-1069501632);m=SMK.md5.g(m,l,o,n,p[g+11],14,643717713);n=SMK.md5.g(n,m,l,o,p[g+0],20,-373897302);o=SMK.md5.g(o,n,m,l,p[g+5],5,-701558691);l=SMK.md5.g(l,o,n,m,p[g+10],9,38016083);m=SMK.md5.g(m,l,o,n,p[g+15],14,-660478335);n=SMK.md5.g(n,m,l,o,p[g+4],20,-405537848);o=SMK.md5.g(o,n,m,l,p[g+9],5,568446438);l=SMK.md5.g(l,o,n,m,p[g+14],9,-1019803690);m=SMK.md5.g(m,l,o,n,p[g+3],14,-187363961);n=SMK.md5.g(n,m,l,o,p[g+8],20,1163531501);o=SMK.md5.g(o,n,m,l,p[g+13],5,-1444681467);l=SMK.md5.g(l,o,n,m,p[g+2],9,-51403784);m=SMK.md5.g(m,l,o,n,p[g+7],14,1735328473);n=SMK.md5.g(n,m,l,o,p[g+12],20,-1926607734);o=SMK.md5.h(o,n,m,l,p[g+5],4,-378558);l=SMK.md5.h(l,o,n,m,p[g+8],11,-2022574463);m=SMK.md5.h(m,l,o,n,p[g+11],16,1839030562);n=SMK.md5.h(n,m,l,o,p[g+14],23,-35309556);o=SMK.md5.h(o,n,m,l,p[g+1],4,-1530992060);l=SMK.md5.h(l,o,n,m,p[g+4],11,1272893353);m=SMK.md5.h(m,l,o,n,p[g+7],16,-155497632);n=SMK.md5.h(n,m,l,o,p[g+10],23,-1094730640);o=SMK.md5.h(o,n,m,l,p[g+13],4,681279174);l=SMK.md5.h(l,o,n,m,p[g+0],11,-358537222);m=SMK.md5.h(m,l,o,n,p[g+3],16,-722521979);n=SMK.md5.h(n,m,l,o,p[g+6],23,76029189);o=SMK.md5.h(o,n,m,l,p[g+9],4,-640364487);l=SMK.md5.h(l,o,n,m,p[g+12],11,-421815835);m=SMK.md5.h(m,l,o,n,p[g+15],16,530742520);n=SMK.md5.h(n,m,l,o,p[g+2],23,-995338651);o=SMK.md5.i(o,n,m,l,p[g+0],6,-198630844);l=SMK.md5.i(l,o,n,m,p[g+7],10,1126891415);m=SMK.md5.i(m,l,o,n,p[g+14],15,-1416354905);n=SMK.md5.i(n,m,l,o,p[g+5],21,-57434055);o=SMK.md5.i(o,n,m,l,p[g+12],6,1700485571);l=SMK.md5.i(l,o,n,m,p[g+3],10,-1894986606);m=SMK.md5.i(m,l,o,n,p[g+10],15,-1051523);n=SMK.md5.i(n,m,l,o,p[g+1],21,-2054922799);o=SMK.md5.i(o,n,m,l,p[g+8],6,1873313359);l=SMK.md5.i(l,o,n,m,p[g+15],10,-30611744);m=SMK.md5.i(m,l,o,n,p[g+6],15,-1560198380);n=SMK.md5.i(n,m,l,o,p[g+13],21,1309151649);o=SMK.md5.i(o,n,m,l,p[g+4],6,-145523070);l=SMK.md5.i(l,o,n,m,p[g+11],10,-1120210379);m=SMK.md5.i(m,l,o,n,p[g+2],15,718787259);n=SMK.md5.i(n,m,l,o,p[g+9],21,-343485551);o=SMK.md5.s(o,j);n=SMK.md5.s(n,h);m=SMK.md5.s(m,f);l=SMK.md5.s(l,e)}return Array(o,n,m,l)};SMK.md5.s=function(e,h){var g=(e&65535)+(h&65535);var f=(e>>16)+(h>>16)+(g>>16);return(f<<16)|(g&65535)};SMK.md5.cmn=function(j,g,f,e,i,h){return SMK.md5.s(SMK.md5.bit_rol(SMK.md5.s(SMK.md5.s(g,j),SMK.md5.s(e,h)),i),f)};SMK.md5.f=function(g,f,k,j,e,i,h){return SMK.md5.cmn((f&k)|((~f)&j),g,f,e,i,h)};SMK.md5.g=function(g,f,k,j,e,i,h){return SMK.md5.cmn((f&j)|(k&(~j)),g,f,e,i,h)};SMK.md5.h=function(g,f,k,j,e,i,h){return SMK.md5.cmn(f^k^j,g,f,e,i,h)};SMK.md5.i=function(g,f,k,j,e,i,h){return SMK.md5.cmn(k^(f|(~j)),g,f,e,i,h)};SMK.md5.binl2hex=function(g){var f=b?"0123456789ABCDEF":"0123456789abcdef";var h="";for(var e=0;e<g.length*4;e++){h+=f.charAt((g[e>>2]>>((e%4)*8+4))&15)+f.charAt((g[e>>2]>>((e%4)*8))&15)}return h};SMK.md5.str2binl=function(h){var g=Array();var e=(1<<d)-1;for(var f=0;f<h.length*d;f+=d){g[f>>5]|=(h.charCodeAt(f/d)&e)<<(f%32)}return g};SMK.md5.bit_rol=function(e,f){return(e<<f)|(e>>>(32-f))}})(jQuery);SMK.util.attEvent=function(element,eType,handle){if(typeof handle!="function"){return}var type=eType.indexOf("on")==-1?eType:eType.slice(2);if(element.attachEvent){element.attachEvent("on"+type,handle)}else{element.addEventListener(type,handle,false)}};SMK.util.filterHtmlTag=function(str,allowed){var allowed=typeof allowed!="undefined"?allowed:"";allowed=(((allowed||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var tags=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,commentsAndPhpTags=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return str.replace(commentsAndPhpTags,"").replace(tags,function($0,$1){return allowed.indexOf("<"+$1.toLowerCase()+">")>-1?$0:""
})};SMK.util.encodeStr=function(html){var newStr="";newStr=html.replace(/\</g,"&lt;");newStr=newStr.replace(/\>/g,"&gt;");return newStr};SMK.util.echoJson=function(json){if(!gVConfig.debug){return}var str="";for(key in json){str+=key+"==>"+json[key]+"\n"}if(gVConfig.debug&&$.browser.msie){alert(str)}else{SMK.log(json)}};SMK.util.getUrlParam=function(key,stri){var val=null;var str=stri==undefined?window.location.search.substring(1):stri.split("?")[1];if(str.length!=0){var arr=str.split("&");for(i=0;i<arr.length;i++){if(arr[i].split("=")[0]==key){val=arr[i].split("=")[1];break}}return val}return null};SMK.LOG=SMK.log=function(){if(!gVConfig.debug){return}if(gVConfig.alert||SMK.util.getUrlParam("alert")){var str="";for(i=0;i<arguments.length;i++){str+=i+'==>"'+arguments[i]+'"\n'}alert(str)}else{}};SMK.util.isClassName=function(element,styleName){return $(element).hasClass(styleName)};SMK.util.getElData=function(element,att){var json={},temp=[],len;var str=$(element).attr(att?att:"ajax-data");if(!str){return{}}temp=str.split("&");len=temp.length;for(var i=0;i<len;i++){var a=temp[i].split("=");json[a[0]]=a[1]}return json};SMK.util.getElementInfo=function(element){var json={};if(element===undefined){element=$(window)}if($(element).length==0){return null}if(element.get(0)==window){json.h=$(element).height();json.w=$(element).width();json.st=$(element).scrollTop();json.sl=$(element).scrollLeft()}else{json.h=$(element).innerHeight();json.w=$(element).innerWidth()}if(element.get(0)==window){return json}json.t=Math.floor($(element).offset().top);json.l=Math.floor($(element).offset().left);return json};SMK.util.countdown=function(startTime,curTime,endTime,callback){var timeer=null;var day=24*60*60;var hour=60*60;var minute=60;var cur=new Date((typeof curTime=="number"?curTime:parseInt(curTime))*1000);var start=new Date((typeof startTime=="number"?startTime:parseInt(startTime))*1000);var end=new Date((typeof endTime=="number"?endTime:parseInt(endTime))*1000);var temp=curTime;var timeObj={};timeer=setInterval(function(){if(temp>endTime){timeObj.code="end";timeObj.date=end;clearInterval(timeer)}else{if(temp<startTime){timeObj.code="unstart";timeObj.date=start;clearInterval(timeer)}else{var surplus=endTime-temp;timeObj.code="start";timeObj.d=Math.floor(surplus/day);timeObj.h=Math.floor(surplus%day/hour);timeObj.m=Math.floor(surplus%day%hour/minute);timeObj.s=Math.floor(surplus%day%hour%minute)}}if(typeof callback=="function"){callback(timeObj)}temp++},1000)};SMK.util.maxCharTips=function(element,tipsColor,Color){var c=typeof color!="undefined"?color:"";var tc=typeof tipsColor!="undefined"?tipsColor:"#f9cbcb";var flag=6;var time=setInterval(function(){if(flag<1){clearInterval(time);return}if(flag%2==0){$(element).css("background",tc)}else{$(element).css("background",c)}flag--},100)};$.fn.pasteEvents=function(delay){if(delay===undefined){delay=300}return $(this).each(function(){var $el=$(this);$el.bind("paste",function(){$el.trigger("prepaste");setTimeout(function(){$el.trigger("postpaste")},delay)})})};SMK.util.paste=function(element){if(!$(element).attr("eventflag")){if(!$(element).attr("sendpost")){$(element).keyup()}$(element).bind("postpaste",function(){$(element).keyup();$(element).attr("eventflag",true)}).pasteEvents()}};SMK.util.fous=function(element,string){SMK.util.paste(element);var val=$(element).val();if(val==string){$(element).val("").css("color","#444")}else{$(element).css("color","#444")}$(element).blur(function(){var val=$(this).val();if(val==""){$(element).val(string).css("color","#999")}})};SMK.util.maxChar=function(options){var defin={e:null,p:".js_all_smail",t:".textTips",s:"sr-btn-green",d:"sr-btn-disabled",b:".gPostBtn",a:0,c:null,f:null};var opt=$.extend({},defin,options);var parent=$(opt.e).closest(opt.p),btn=parent.find(opt.b),tips=parent.find(opt.t);var maxStr=$(opt.e).attr("maxlenth");var val=$.trim($(opt.e).val());if(val==""){tips.html("<span>你还可以输入</span><font>"+maxStr+"</font><span>字</span>");btn.removeClass(opt.s).addClass(opt.d);$(opt.e).attr("sendpost",false);if(opt.a){SMK.util.txtAutoHeight($(opt.e),20)}return}var strlen=val.strLength(true);if(opt.a){SMK.util.txtAutoHeight($(opt.e),20)}var surplusChar=maxStr-strlen;if(surplusChar>=0){if(typeof opt.c==="function"){opt.c(opt,tips)}else{tips.html("<span>你还可以输入</span><font>"+surplusChar+"</font><span>字</span>")}btn.removeClass(opt.d).addClass(opt.s);$(opt.e).attr("sendpost",true)}else{if(typeof opt.c==="function"){opt.c(opt,tips)}else{tips.html('<span>你输入已经超过</span><font style="color:#f00">'+Math.abs(surplusChar)+"</font><span>字</span>")}btn.removeClass(opt.s).addClass(opt.d);$(opt.e).attr("sendpost",false)}};SMK.util.txtAutoHeight=function(element,minHeight){var id="#SMKTextareaDiv";if($(id).length>0){$(id).remove()}var w=$(element).width();if($(id).length==0){var html=$('<textarea id="SMKTextareaDiv" style="font-family:Arial,Helvetica,sans-serif;overflow:hidden;line-height:20px; margin:0;border:0;padding:0;position:absolute;top:-9999px;left:-9999px;"></textarea>').css({width:w,height:minHeight});
    $("body").append(html)}else{var html=$(id)}html.val(element.val());var h=html.get(0).scrollHeight>minHeight?html.get(0).scrollHeight:minHeight;$(element).css("height",h);element.unbind("blur").blur(function(){html.remove()})};SMK.util.random=function(min,max){return Math.ceil(Math.random()*(max-min)+min)};SMK.util.showBrowser=function(){if(SMK.util.getUrlParam("liulanqi")||SMK.util.getUrlParam("browser")){var maxNum=SMK.util.getUrlParam("num")?parseInt(SMK.util.getUrlParam("num")):15;var i=0,str="";for(key in window.navigator){str+=key+"==>"+window.navigator[key]+"\n";if(i>maxNum){break}i++}alert(str)}};SMK.util.showBrowser();SMK.namespace("SMK.config");SMK.config._setting=$.extend({},gVConfig);SMK.config.get=function(key){return SMK.config._setting[key]?SMK.config._setting[key]:null};SMK.config.set=function(key,value){if($.isPlainObject(key)){$.extend(SMK.config._setting,key)}else{SMK.config._setting[key]=value}};SMK.config.set("domain",function(){var hostArr=location.hostname.split(".");var str="."+hostArr.slice(-2).join(".");if(str==".com.cn"){str="."+hostArr.slice(-3).join(".")}if(window.location.host.indexOf("book.sina.com.cn")!=-1){str=".vip.book.sina.com.cn"}return str}());SMK.config.set("host",location.protocol+"//"+location.hostname+"/");SMK.config.set("nodata",$('<div class="sr-nodata-block-box"><div class="sr-nodata-block"><p class="fn14"></p></div></div>'));SMK.namespace("SMK.request");SMK.request._send=function(url,type,textType,_data,_successCallback,_errorCallback){if(url=="localhostTest"){_successCallback(textType);return}var data=null;var successCallback=null;var errorCallback=null;if(!$.isPlainObject(_data)&&$.isFunction(_data)){successCallback=_data;errorCallback=_successCallback}else{data=_data;successCallback=_successCallback;errorCallback=_errorCallback}var host=location.protocol+"//"+location.hostname;var crossdomain=url.substr(0,host.length)==host?false:true;var options={url:url,type:crossdomain?"GET":type,data:arguments.length==2?{}:data,timeout:10000,cache:false};if(crossdomain){options["dataType"]="jsonp";options["jsonp"]="callback"}else{options["dataType"]=textType}if(successCallback){options["success"]=function(ret){successCallback(ret)}}if(errorCallback){options["error"]=errorCallback}jQuery.ajax(options)};SMK.request.get=function(url,data,textType,success,error){if(typeof textType=="function"){var _success=textType;var _textType="json";var _error=typeof success!="undefined"?success:null}else{if(typeof textType=="string"||url=="localhostTest"){var _textType=textType;var _success=success;var _error=typeof error!="undefined"?error:null}}SMK.request._send(url,"GET",_textType,data,_success,_error)};SMK.request.post=function(url,data,textType,success,error){if(typeof textType=="function"){var _success=textType;var _textType="json";var _error=typeof success!="undefined"?success:null}else{if(typeof textType=="string"||url=="localhostTest"){var _textType=textType;var _success=success;var _error=typeof error!="undefined"?error:null}}SMK.request._send(url,"POST",_textType,data,_success,_error)};SMK.request.ajaxFlag=false;SMK.request.ajax=function(json){var blockName={node:null,type:"html",isLoading:true,loadstyle:"load_16_center",callback:null,order:"random",num:null};var isWait=typeof json.isWait=="undefined"&&!json.isWait?false:true;if(typeof json.url=="undefined"){if(gVConfig.debug){alert("请求出错了，存放返回数据节点元素或者没有传入请求地址")}return}if(isWait){if(SMK.request.ajaxFlag){return}SMK.request.ajaxFlag=true}var action="",i=0;if(json.contNode){for(key in json.contNode){if(i==0){action+=key}else{action+=","+key}var contNodeWrap=$.extend({},blockName,json.contNode[key]);if($(contNodeWrap.node).children().length>0){$(contNodeWrap.node).css("height",$(contNodeWrap.node).height())}if(contNodeWrap.type=="html"){$(contNodeWrap.node).html("")}else{if(contNodeWrap.type=="append"){}else{if(contNodeWrap.type=="prepend"){}}}if(contNodeWrap.isLoading){$(contNodeWrap.node).addClass(contNodeWrap.loadstyle)}i++}}if(typeof json.start=="function"){json.start(json)}var data=$.extend({},{action:action},json.data?json.data:{});var handle=function(ret){if(ret&&parseInt(ret.code)==1&&ret.data){if(isWait){SMK.request.ajaxFlag=false}if(json.contNode){for(key in json.contNode){var contNodeWrap=$.extend({},blockName,json.contNode[key]);if(contNodeWrap.isLoading){$(contNodeWrap.node).removeClass(contNodeWrap.loadstyle)}$(contNodeWrap.node).css("height","auto");var html=ret.data[key].html;if(contNodeWrap.type=="html"){$(contNodeWrap.node).html(html)}else{if(contNodeWrap.type=="append"){$(contNodeWrap.node).append(html)}else{if(contNodeWrap.type=="prepend"){$(contNodeWrap.node).prepend(html)}}}if(typeof contNodeWrap.callback=="function"){contNodeWrap.callback(ret.data[key],contNodeWrap)}}}if(typeof json.callback=="function"){json.callback(ret,json)}}else{errorhandle(ret)}};var errorhandle=function(ret){if(json.contNode){for(key in json.contNode){var contNodeWrap=$.extend({},blockName,json.contNode[key]);if(contNodeWrap.isLoading){$(contNodeWrap.node).removeClass(contNodeWrap.loadstyle)
}$(contNodeWrap.node).css("height","auto")}}if(typeof json.errCallback=="function"){json.errCallback(ret,json)}if(gVConfig.debug){alert(ret.responseText)}if(isWait){SMK.request.ajaxFlag=false}};SMK.request[json.type=="get"?"get":"post"](json.url,data,json.typeText?json.typeText:"json",handle,errorhandle)};SMK.request.load=function(json){var param={};param.url=json.u;param.data=json.d?json.d:{};param.isWait=false;param.contNode=$.extend({},json.o);if(json.b){param.callback=json.b}SMK.request.ajax(param)};SMK.util.globalTips=function(text,json){var a={title:"提示",width:300,time:1000,element:null,remove:true,showClose:true,drag:false,closeCallback:null,callback:null,tips_id:"",txtIcon:"",btnAlign:"center"};var opt=$.extend({},a,json);var html=$("<div class='sr-messages'></div>");html.children().remove();if(opt.txtIcon){html.append('<i class="'+opt.txtIcon+'"></i>')}html.append("<em>"+text+"</em>");SMK.pop.tips(opt.tips_id,html,opt)};SMK.util.confirm=function(text,json){var confirmCss=json.confirmCss?json.confirmCss:"sr-btn-green";var autoClose=json.autoClose==undefined?true:false;var cancelCss=json.cancelCss?json.cancelCss:"sr-btn-gray";var confirmText=json.confirmText?json.confirmText:'<em style="padding:0 6px;">确定</em>';var cancelText=json.cancelText?json.cancelText:'<em style="padding:0 6px;">取消</em>';var btn={definConfirm:{text:confirmText,style:confirmCss,handle:function(dialog,btn,options){if(typeof json.confirmCallback=="function"){json.confirmCallback(dialog,btn,options);if(autoClose){dialog.find(".close a").click()}}else{dialog.find(".close a").click()}}},definCancel:{text:cancelText,style:cancelCss,handle:function(dialog,btn,options){if(typeof json.cancelCallback=="function"){json.cancelCallback(dialog,btn,options)}dialog.find(".close a").click()}}};var btned=$.extend({},btn,(json.myBtn?json.myBtn:{}));var a={title:"确认提示框",width:300,time:0,element:null,remove:true,btn:btned,btnAlign:"center",showClose:true,shortcut:false};var html=$('<div class="comConfirm">'+text+"</div>");var opt=$.extend({},a,json);var id=json.id?json.id:"";SMK.pop.tips(id,html,opt)};SMK.namespace("SMK.cookie");SMK.cookie.get=function(key,value,options){options=options||{};var result,decode=options.raw?function(s){return s}:decodeURIComponent;return(result=new RegExp("(?:^|; )"+encodeURIComponent(key)+"=([^;]*)").exec(document.cookie))?decode(result[1]):null};SMK.cookie.remove=function(key,options){SMK.cookie.set(key,null,options?options:{})};SMK.cookie.set=function(key,value,opt){var options=$.extend({},{domain:SMK.config.get("domain")?SMK.config.get("domain"):"",path:"/"},opt);if(value===null||value===undefined){options.expires=-1}if(typeof options.expires==="number"){var seconds=options.expires,t=options.expires=new Date();t.setTime(t.getTime()+seconds*1000*60*60)}value=String(value);return(document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join(""))};SMK.util.getCfgLogin=function(){var __cfg={};if($CONFIG){__cfg["name"]=$CONFIG["name"];__cfg["uid"]=$CONFIG["uid"];__cfg["islogin"]=$CONFIG["islogin"]}return __cfg};SMK.util.getLoginInfo=function(){var cookieSup=SMK.util.getCfgLogin();if(!cookieSup.islogin||!cookieSup.uid){return null}return cookieSup};SMK.util.getLoginStatus=function(){if(SMK.util.getUrlParam("s")=="nolog"){return true}var json=SMK.util.getLoginInfo();if(!json||!json.uid||json.uid=="deleted"){return false}else{return true}};SMK.util.updateLoginInfo=function(){if(!$CONFIG){$CONFIG={}}$CONFIG["uid"]=0;$CONFIG["islogin"]=0;SMK.util.checkLogin()};SMK.util.checkLogin=function(url,options){if(SMK.util.getUrlParam("s")=="nolog"){return true}var definOpt={url:url?url:window.location.href,isDialog:true,tpl:"card_html",loginCss:"sr-btn-green",regCss:"sr-btn-gray"};var opt=$.extend({},definOpt,(options==undefined?{}:options));var html='<div class="checkLoginTips">';html+='	<div class="intro">';html+="		<p>本次操作需要您</p>";html+="		<p>使用<span>新浪微博账号</span>或者<span>新浪邮箱账号</span>登录</p>";html+="	</div>";html+='	<div class="loginBtn"><a class="'+opt.loginCss+'" href="#"><span><em>登录</em></span></a></div>';html+='	<div class="reg"><em class="subtext">还未开通？赶快免费注册一个吧！</em><a class="'+opt.regCss+'" href="http://weibo.com/signup/signup.php" target="_blank"><span><em>注册新浪微博</em></span></a></div>';html+="</div>";if(WBtopGlobal!==undefined){var sina_sup=SMK.util.getLoginInfo();if(opt.isDialog){SMK.pop.tips("",html,{title:"欢迎来到微博读书",width:400,tpl:opt.tpl,mask:true,remove:true,drag:false,callback:function(dialog,opt){dialog.find(".loginBtn a").click(function(e){dialog.find(".close a").click();window.scrollTo(0,0);setTimeout(function(){WBtopPublic.showLoginLayer({"lang":"zh-cn","loginSuccessUrl":opt.url})},100);return false})}});return false}if(!sina_sup||!sina_sup.uid||sina_sup.uid=="deleted"){SMK.log(opt.url);WBtopPublic.showLoginLayer({"lang":"zh-cn","loginSuccessUrl":opt.url});
    return false}return true}else{setTimeout(function(){SMK.util.checkLogin(url,options)},1000)}};SMK.util.search_old=function(parent,callback){(function(el){var type=el.attr("page-type");var defineStr="请输入关键字...";var maxlen=parseInt(el.find("input").attr("maxlength")),input=el.find("input");var btn=el.find(".sr-search-btn a,.sr-search-mini-btn a");if(defineStr!=input.val()){input.css({color:"#666"})}if(type=="index"){el.find(".sr-index-search-t span").click(function(){$(this).addClass("active").siblings().removeClass("active")})}input.focus(function(){var str=$(this).val();if(defineStr==str){$(this).val("").css({color:"#666"})}else{$(this).css({color:"#666"})}}).blur(function(){var str=$(this).val();if(str==""){$(this).val(defineStr).css("color","#999")}});btn.live("click",function(){if(type=="index"){var definUrl=el.find(".sr-index-search-t span.active").attr("defin-url")}else{var definUrl=input.attr("defin-url")}if(!$.trim(input.val())||input.val()==defineStr){!callback&&(window.location.href=definUrl);return false}callback?callback():searchFn();return false});$(el).find("input").keypress(function(e){if(e.keyCode=="13"){btn.click()}});var searchFn=function(){if(type=="index"){var searchstr=el.find(".sr-index-search-t span.active").attr("search-url")}else{var searchstr=input.attr("search-url")}var str=$.trim(input.val()).codeUrl();var reg=/{keyword}/;var url=searchstr.replace(reg,str);location.href=url}})(parent)};SMK.util.search={defConfig:{wrap:".js-prettysearch",input_parent:".prettysearch-input-parent",search_btn:".prettysearch-btn",hover_class:"hover",focus_class:"focus",lable_txt:"请输入关键字...",url:"",defaul_url:"",keyword_exp:"{keyword}",callback:null},init:function(setting){var me=this,$wrap,$input,$P_input,$btn;setting=$.extend(me.defConfig,setting||{});if(setting.url===""){return}$wrap=$(setting.wrap);if($wrap.length==0){return}$P_input=$wrap.find(setting.input_parent);if($P_input.length==0){return}$input=$P_input.find("input");$btn=$wrap.find(setting.search_btn);$input.focus(function(){$input.val()==setting.lable_txt&&$input.val("");$P_input.addClass(setting.focus_class)}).blur(function(){$P_input.removeClass(setting.focus_class);$.trim($input.val())==""&&$input.val(setting.lable_txt)});$P_input.hover(function(){$P_input.addClass(setting.hover_class)},function(){$P_input.removeClass(setting.hover_class)}).keypress(function(e){e.keyCode==13&&me.search(setting,$.trim($input.val()))});$btn.on("click",function(e){e.preventDefault();if($input.val()=="找喜欢的作者和书"){return false}me.search(setting,$.trim($input.val()))})},search:function(setting,keyword){if(keyword==""||keyword==setting.lable_txt){if(window.location.href!=setting.default_url){window.location.href=setting.default_url}return}typeof setting.callback=="function"&&setting.callback();window.location.href=setting.url.replace(setting.keyword_exp,keyword)}};(function(){var $input=$(".sr-js-searchbox").find("input");SMK.util.search.init({wrap:".sr-js-searchbox",input_parent:".input",search_btn:".btn_search",lable_txt:"找喜欢的作者和书",url:$input.attr("search-url"),default_url:$input.attr("default-url"),keyword_exp:"{keyword}",callback:function(){}})})();SMK.util.change=function(cfg){var o={data:{},par:".sr-aside-works",cont:".sr-aside-cont",dataName:"data-post",dataPos:".sr-switch-data-wrap",modelName:"hotBookList"};var opt=$.extend({},o,cfg);$(opt.btn).unbind().click(function(){var cont=$(opt.cont);opt.toPost=$.extend({},opt.data,SMK.util.getElData($(opt.dataPos),opt.dataName));SMK.request.post(opt.url,opt.toPost,function(ret){cont.html(ret.data[opt.modelName].html);opt.fn&&opt.fn()},function(ret){gVConfig.debug&&SMK.log(ret.responseText)})})};(function(){var foucsCss="blur";var list=$("input[data-type=blur],textarea[data-type=blur],select[data-type=blur]");if(!list.length){return}list.live("focus",function(e){$(this).addClass(foucsCss)});list.live("blur",function(e){$(this).removeClass(foucsCss)})})();(function($){var ver=gVConfig.ver;if($.browser.version=="6.0"){var dialogimg=new Image();var dialogClose=new Image();var dialogM=new Image();var Imagetype="gif"+ver;dialogimg.src=gVConfig["static"]+"/package/common/images/poptip."+Imagetype;dialogClose.src=gVConfig["static"]+"/package/common/images/popbox."+Imagetype;dialogM.src=gVConfig["static"]+"/package/common/images/poptip-v."+Imagetype}var _zindex=5000;var timeHider=null;var _count=0;var _over=true;var _load='<div class="load"><p></p><div style="padding:10px 0 0">拼命的为您加载中，请稍后..</div></div>';var _lastDialog=null;var _defaults={id:false,title:"窗口模式",showClose:true,time:0,mask:true,width:350,element:null,btn:null,btnAlign:"right",align:"center",drag:true,fixTop:0,checkLogin:false,remove:true,dir:"down",css:"dialogCss",icoAlign:"center",eType:"show",active:0,actCss:"active",hideTitle:false,tpl:"card_html",shortcut:true,type:"post",arrow:null};var staticPath=_cfg["static"].slice(-1)=="/"?_cfg["static"]:_cfg["static"]+"/";gVConfig.loadCss(staticPath+"paidRead/assets/css/p.dialog.css");var fDialog=function(content,options){this.options=$.extend({},_defaults,options);
    this.content=content;this.count=_count;_count++;_zindex++};fDialog.prototype={autoClose:function(element){if(this.options.time!==0){timeHider=setTimeout(function(){element.find(".close a").click()},this.options.time)}},tower:function(element){var index=$(element).attr("dialog_count");$(element).attr("dialog_flag",true);var selector="#"+(this.options.id?this.options.id:"dialog_"+index);if(this.content){$(selector).find(".dialog_content").html(this.content)}this.setContent($(selector),this.options.width);this.autoClose($(selector));this.maskDiv(index)},one:function(element){var that=this;$(element).attr("dialog_count",that.count);$(element).attr("dialog_flag",true);var html=$(that[that.options.tpl]()).css("width",that.options.width).attr("dialog_count",that.count).addClass("dialog_tips");html.attr("id",that.options.id?that.options.id:"dialog_"+(that.count));if(that.content){html.find(".dialog_content").html(that.content)}if(that.options.hideTitle){html.find(".title").hide()}else{html.find(".title p").html(that.options.title)}html.find(".title .close a").attr("dialog_count",that.count);if(!that.options.showClose){html.find(".title .close a").hide()}if(!that.options.arrow){html.find(".arrow").remove()}if(that.options.btn){that.btn(html,that.options.btn,that.count);html.find(".btn").addClass("btn_"+that.options.btnAlign)}else{html.find(".btn").remove()}html.find(".btn").css("width",that.options.width-44);$("body").append(html);return html},getElement:function(){if(!this.options.element||this.options.element.get(0)==window){$("body").append('<div id="definElemenetDiv_'+(this.count)+'" style="display:none"></div>');var el=$("#definElemenetDiv_"+(this.count));return el}else{return this.options.element}},close:function(element,dialog,fn){$(element).removeAttr("dialog_flag");var index=element.attr("dialog_count");if(typeof timeHider!="undefined"){clearTimeout(timeHider);timeHider=null}if(this.options.remove){element.removeAttr("dialog_count");dialog.remove();if($("#mask_opacity_"+index).length>0){$("#mask_opacity_"+index).remove()}}else{dialog.fadeOut(500);if($("#mask_opacity_"+index).length>0){$("#mask_opacity_"+index).fadeOut(500)}}if($("#definElemenetDiv_"+(this.count)).length>0){$("#definElemenetDiv_"+(this.count)).remove()}if(typeof fn=="function"){fn()}else{if(typeof this.options.closeCallback=="function"){this.options.closeCallback(dialog,this.options)}}},maskDiv:function(index){if(!this.options.mask){return}var html=$('<div id="mask_opacity_'+index+'"></div>');var h=Math.max($(window).outerHeight(),$(document).outerHeight());if($("#mask_opacity_"+index).length>0){$("#mask_opacity_"+index).show()}else{$("body").append(html);html.css({position:"absolute",top:0,left:0,width:"100%",height:h,opacity:0.2,filter:"alpha(opacity=20)","background-color":"#000","z-index":_zindex-1})}},tips:function(){var element=this.getElement(),that=this;if($(element).attr("dialog_flag")=="true"){return}if($(element).attr("dialog_count")){this.tower(element);return}var ohtml=this.one(element);if(that.options.align=="center"){ohtml.hide();that.setContent(ohtml,that.options.width);that.autoClose(ohtml);that.maskDiv(that.count)}ohtml.find(".close a").unbind("click").click(function(){that.close(element,ohtml);return false});if(typeof that.options.callback=="function"){that.options.callback(ohtml,that.options)}},box:function(){var element=this.getElement(),that=this;if(this.options.checkLogin&&!SMK.util.getLoginStatus()){SMK.util.checkLogin();return}if(!that.options.url){if(gVConfig&&gVConfig.debug){alert("请您传入请求地址！")}return}if($(element).attr("dialog_count")){this.tower(element);return}var ohtml=this.one(element);ohtml.find(".dialog_content").html(_load);this.maskDiv(that.count);$("body").append(ohtml);this.setContent(ohtml,this.options.width,true);var callret=null;ohtml.find(".close a").unbind("click").click(function(){that.close(element,ohtml,function(){if(typeof that.options.closeCallback=="function"){that.options.closeCallback(ohtml,that.options,callret)}});return false});SMK.request[this.options.type](this.options.url,this.options.data,function(ret){callret=ret;if(ret){if(ret.code==1||ret.code===0){ohtml.find(".dialog_content").html(ret.data.html);that.setContent(ohtml,that.options.width,true);if(typeof(that.options.callback)=="function"){that.options.callback(ohtml,that.options,ret)}}else{if(ret.code==10097){ohtml.find(".close a").trigger("click");SMK.util.updateLoginInfo()}}}},function(ret){if(gVConfig&&gVConfig.debug){alert(ret.responseText)}})},tagTips:function(){var me=this;(function(opt,z,cont,len){var opti=opt;var content=cont;var html=me.tag_html();html.attr("id",opt.id?opt.id:"dialog_tagTips"+len);if(!opti.closeShow){html.find(".close").remove()}if(opti.closeShow){html.find(".layerBox").css("padding","7px 10px 7px 10px");html.find(".layerBox").html(content).css("width",opti.width-40)}else{html.find(".layerBox").html(content).css("width",opti.width-20)}if(opti.eType=="show"){me.tagPosition(html,opti,z);$("body").append(html);if(typeof opt.callback=="function"){opt.callback(html,opti)
}if(opti.closeShow){html.find(".close a").click(function(){html.remove()})}}else{var timer,over=true;var hideTimer=function(){if(over){html.remove()}};$(me.options.element).unbind("mouseover").mouseover(function(e){if(over){if($("#dialog_tagTips"+len).length==0){me.tagPosition(html,me.options,_zindex);$("body").append(html);if(typeof me.options.callback=="function"){me.options.callback(html,me.options)}}html.mouseover(function(e){over=false;e.stopPropagation()});html.mouseout(function(e){over=true;setTimeout(hideTimer,50);e.stopPropagation()})}over=false;e.stopPropagation()});$(me.options.element).mouseover();$(me.options.element).mouseout(function(e){over=true;setTimeout(hideTimer,50);e.stopPropagation()})}})(this.options,_zindex,this.content,_count)},select:function(){if(this.options.element.attr("count")){return}var me=this;(function(opt,z,len){var html=me.select_html(),showvalue=opt.element.find("span");opt.element.attr("count",len);html.attr("id","gSelectDate_"+len).attr("count",len);html=me.createList(html,opt);html.find("ul").css("width",opt.width-4);html.find(".dir").remove();$("body").append(html);me.position(html,opt,z);html.find("li").click(function(){var _this=$(this);var val=$(this).attr("data-value"),txt=$(this).find("a").html();showvalue.html(txt).attr("value",val);if(typeof opt.callback=="function"){opt.callback(opt,val,txt)}html.remove();opt.element.removeAttr("count")});var timer,over=true;var hideTimer=function(){if(over){html.remove();opt.element.removeAttr("count")}};$(opt.element).mouseout(function(e){over=true;setTimeout(hideTimer,1000);e.stopPropagation()});$(opt.element).mouseover(function(e){over=false;e.stopPropagation()});html.mouseover(function(e){over=false;e.stopPropagation()});html.mouseout(function(e){over=true;setTimeout(hideTimer,1000);e.stopPropagation()})})(this.options,_zindex,_count)},position:function(element,options,zIndex){var win=this.getElementInfo($(window));var ele=this.getElementInfo(element);var source=this.getElementInfo(options.element);var _top=-9999,_left=-9999;if(source.l+ele.w>=win.w){if(win.h+win.st>=source.h+source.t+ele.h){_top=source.t+source.h;_left=source.l-(ele.w-source.w)}else{_top=source.t-ele.h;_left=source.l-(ele.w-source.w)}}else{if(win.h+win.st>=source.h+source.t+ele.h){_top=source.h+source.t;_left=source.l}else{_top=_top=source.t-ele.h;_left=source.l}}element.css({top:_top,left:_left,"z-index":zIndex}).show()},createList:function(dom,opt){var list="";var index=opt.element.find("span").attr("value");if(opt.value){for(key in opt.value){var css=index==key?' class="'+opt.actCss+'"':"";list+='<li data-value="'+key+'"'+css+'><a href="#" onclick="return false;">'+opt.value[key]+"</a></li>"}dom.find("ul").html(list)}return dom},tagPosition:function(dom,opt,zIndex){var dialog={w:opt.width+20};var dir={w:8};var source=this.getElementInfo(opt.element);var win=this.getElementInfo($(window));var _top=-9999,_left=-9999,_dirLeft=-9999;if(opt.dir=="down"){_top=source.t+source.h;if(source.l+source.w/2<dialog.w/2){_dirLeft=(dialog.w-dir.w)/2-(dialog.w/2-(source.l+source.w/2));_left=0}else{if(source.l+(dialog.w+source.w)/2>=win.w){_dirLeft=dialog.w/2-(win.w-(source.l+(source.w+dialog.w-dir.w)/2));_left=win.w-dialog.w}else{_dirLeft=Math.floor((dialog.w-dir.w)/2);_left=source.l-Math.floor((dialog.w-source.w)/2)}}}dom.find(".dir").addClass("down").css({left:_dirLeft});dom.css({top:_top,left:_left,width:opt.width,"z-index":zIndex})},btn:function(dom,btn,dialog_count){var me=this;for(val in btn){(function(_btn){if(typeof _btn.text!="undefined"&&typeof _btn.style!="undefined"){var oBtn=$('<a href="javascript:void(0);"><span></span></a>');if(_btn.style){oBtn.addClass(_btn.style)}if(_btn.target){oBtn.attr("target",_btn.target)}if(_btn.text){oBtn.children().html(_btn.text)}if(_btn.url){oBtn.attr("href",_btn.url)}if(_btn.handle&&typeof(_btn.handle)=="function"){oBtn.click(function(){_btn.handle(dom,$(this),me.options);over=true;if($("#definElemenetDiv").length>0){$("#definElemenetDiv").remove()}if(!_btn.url){return false}})}else{if(val=="ok"||val=="cancel"){oBtn.click(function(){dom.find(".close a").click();if($("#definElemenetDiv").length>0){$("#definElemenetDiv").remove()}return false})}}$(dom).find(".btn").append(oBtn)}})(btn[val])}$(dom).find(".btn").css("width",$(dom).width()-40)},setContent:function(dom,width,animateType){var me=this;if(this.options.shortcut){$(document).unbind("keydown").keydown(function(e){if(e.which==" 27"){dom.find(".close a").click()}})}var me=this;$(dom).css({"height":"auto"});var win_w=$(window).width(),win_h=$(window).height();scrolltop=$(window).scrollTop();var me_w=width,me_h=dom.outerHeight();var _left=Math.floor((win_w-me_w)/2);var weibo=$("#weibo_top_public").is(":visible")?$("#weibo_top_public .gn_bg").outerHeight():0;var _top=Math.floor((win_h-me_h)/2)+scrolltop;var h=$(dom).outerHeight();if(animateType){var border=!parseInt($(dom).css("border-left-width"))?0:parseInt($(dom).css("border-left-width"));var padding=!parseInt($(dom).css("padding-left"))?0:parseInt($(dom).css("padding-left"));
    var popheight=$(dom).outerHeight();_top=popheight>win_h?me.options.fixTop+scrolltop:_top;dom.css({"top":(Math.floor(win_h/2-me_h/2)+scrolltop)<=weibo?weibo:(Math.floor(win_h/2-me_h/2)+scrolltop),"left":Math.floor(win_w/2-me_w/2),"z-index":_zindex,height:h-border*2-padding*2,width:me_w}).show()}else{var popheight=$(dom).outerHeight();_top=popheight>win_h?me.options.fixTop+scrolltop:_top;dom.css({"top":_top<=weibo?weibo:_top,"left":_left,"z-index":_zindex}).fadeIn(500)}if(this.options.drag){var _offsetX=0,_offsetY=0,driggTimeout,driggTime;$(dom).find(".title p").css("cursor","move");$(dom).find(".title p").mousedown(function(e){$("body").css({"cursor":"move"});driggTime=(new Date()).getTime();var drigging_me=$(this);_offsetX=e.pageX-drigging_me.offset().left+8;_offsetY=e.pageY-drigging_me.offset().top+8;var domobj=SMK.util.getElementInfo($(dom));if(_offsetY>=drigging_me.outerHeight()||_offsetX>=drigging_me.outerWidth()){return}$(document).mousemove(function(e){var win=SMK.util.getElementInfo($(window));var x=e.pageX-_offsetX;var y=e.pageY-_offsetY;var htmldomW=me.options.tpl=="dialog2_html"?Math.floor(domobj.w+2):domobj.w;if(x<=0){x=0}if(x>=win.w-htmldomW){x=win.w-htmldomW}if(y<=win.st+me.options.fixTop+weibo){y=win.st+weibo}if(y>=(win.st+win.h)-domobj.h){y=(win.st+win.h)-domobj.h}$(document).mouseup(function(){$(document).unbind("mousemove");$("body").css({"cursor":"auto"})});$(dom).css({"left":x,"top":y})});return false}).mouseup(function(){$(document).unbind("mousemove");$("body").css({"cursor":"auto"})})}},card_html:function(){var html='<div class="poppuCard dialog" style="top:-9999px;left:-9999px;">';html+='	<table class="dg_table" border="0" cellpadding="0" cellspacing="0">';html+='		<tr><th class="bgc popTL"></th><th class="bgc popTM"></th><th class="bgc popTR"></th></tr>';html+='		<tr><td class="bgc popML">&nbsp;</td>';html+='			<td class="bgc popMM">';html+='				<div class="layerBox">';html+='					<div class="title"><p></p><div class="close"><a href="javascript:void(0)"></a></div></div>';html+='					<div class="arrow arrow1"></div>';html+='					<div class="dialog_content"></div>';html+='					<div class="btn"></div>';html+="				</div>";html+="			</td>";html+='  			<td class="bgc popMR">&nbsp;</td></tr>';html+='		<tr><td class="bgc popBL"></td><td class="bgc popBM"></td><td class="bgc popBR"></td></tr>';html+="	</table>";html+="</div>";return $(html)},dialog2_html:function(){var html='<div class="sr-dialog-box2">';html+='	<div class="layerBox">';html+='		<div class="title"><p></p><div class="close"><a dialog_count="0" href="javascript:void(0)"></a></div></div>';html+='		<div class="arrow arrow1"></div>';html+='		<div class="dialog_content"></div>';html+='		<div class="btn"></div>';html+="	</div>";html+="</div>";return $(html)},tag_html:function(){var html='<div class="'+this.options.css+' defaultCss" style="top:-9999px; left:-9999px;">';html+='	<div class="tagsWrapper">';html+='		<div class="dir"></div>';html+='		<div class="close"><a href="javascript:;">关闭</a></div>';html+='		<div class="layerBox"></div>';html+="	</div>";html+="</div>";return $(html)},select_html:function(){var html='<div class="gSelectDateList" style="display:none">';html+='	<div class="dir"></div>';html+="    <ul></ul>";html+="</div>";return $(html)},getElementInfo:function(el){var json={};if(el.get(0)==window){json.h=$(el).height();json.w=$(el).width();json.st=$(el).scrollTop();json.sl=$(el).scrollLeft()}else{json.h=$(el).innerHeight();json.w=$(el).innerWidth()}if(el.get(0)==window){return json}json.t=Math.floor($(el).offset().top);json.l=Math.floor($(el).offset().left);return json}};SMK.namespace("SMK.dialog");SMK.dialog.show=function(content,options){if(_lastDialog){_lastDialog=null}_lastDialog=new fDialog(content,options);return _lastDialog};SMK.pop.tips=function(id,content,options){var options=options||{};options.id=id?id:false;SMK.dialog.show(content,options);_lastDialog.tips()};SMK.pop.box=function(id,options){var options=options||{};options.id=id?id:false;SMK.dialog.show("",options);_lastDialog.box()};SMK.pop.tag=function(content,options){var param=options||{};SMK.dialog.show(content,options);_lastDialog.tagTips()};SMK.pop.select=function(options){var options=options||{};SMK.dialog.show("",options);_lastDialog.select()};SMK.pop.changeParam=function(param){$.extend(_defaults,param)}})(jQuery);(function(){$(".sr-js-checkLogin").live("click",function(){SMK.util.checkLogin();return SMK.util.getLoginStatus()})})();(function(){if(_cfg["uid"]==0){$(".bookShelf_rt > a").live("click",getWxLoginMethod)}$(".sr-js-wxCheckLogin").live("click",getWxLoginMethod)})();(function(){var defined={actCss:"actClassname",hoverCss:"hoverClass",btnEl:null,menuEl:null,width:null,dir:"left",time:100},_lastObjcet=null;var count=0;var temp="positionHaddle_";var reSizeObj={};SMK.namespace("SMK.menu");var menu=function(options){this.opt=$.extend({},defined,options);this.opt.over=true;this.opt.timer=null;count++};menu.prototype={click:function(){var that=this;
    if(this.opt.btnEl.length==0||this.opt.menuEl.length==0){return}this.position();this.opt.btnEl.bind("click",function(e){var _this=$(this);if(that.opt.menuEl.is(":hidden")){_this.removeClass(that.opt.hoverCss).addClass(that.opt.actCss);that.opt.menuEl.show();$("body").bind("click",function(e){that.opt.menuEl.hide();_this.removeClass(that.opt.actCss).addClass(that.opt.hoverCss);$(this).unbind("click");e.stopPropagation()});that.opt.menuEl.bind("click",function(e){e.stopPropagation()})}else{that.opt.menuEl.hide();_this.removeClass(that.opt.hoverCss).addClass(that.opt.actCss)}e.preventDefault();e.stopPropagation()});reSizeObj[temp+count]=function(){that.position()};that.reSize()},position:function(){var info=UE.util.getElementInfo(this.opt.btnEl);if(!this.opt.width){this.opt.width=$(this.opt.menuEl).outerWidth(true)}var top=info.h+info.t;if(this.opt.dir=="left"){var left=info.l}else{if(this.opt.dir=="right"){var left=info.l-($(this.opt.menuEl).outerWidth(true)-info.w)}else{if(this.opt.dir=="center"){var num=$(this.opt.menuEl).outerWidth(true)/2-info.w/2;var left=info.l-num}}}this.opt.menuEl.css({left:left,top:top,width:this.opt.width})},hover:function(){var that=this;if(this.opt.btnEl.length==0||this.opt.menuEl.length==0){return}this.position();this.opt.btnEl.mouseover(function(e){if(that.opt.over){that.opt.menuEl.show();that.opt.btnEl.addClass(that.opt.hoverCss).removeClass(that.opt.actCss);that.opt.over=false}}).mouseout(function(e){that.opt.over=true;setTimeout(function(){that.hideTimer()},50)}).click(function(){return false});this.opt.menuEl.mouseover(function(e){that.opt.over=false}).mouseout(function(e){that.opt.over=true;setTimeout(function(){that.hideTimer()},50)});reSizeObj[temp+count]=function(){that.position()};that.reSize()},hideTimer:function(){if(this.opt.over){this.opt.menuEl.hide();this.opt.btnEl.removeClass(this.opt.hoverCss).addClass(this.opt.actCss)}},reSize:function(){var that=this;var timeer=null;$(window).unbind("resize").bind("resize",function(e){if(timeer){clearTimeout(timeer)}timeer=setTimeout(function(){for(var key in reSizeObj){if(typeof reSizeObj[key]=="function"){reSizeObj[key]()}}},that.opt.time)})}};var createObj=function(options){if(_lastObjcet){_lastObjcet=null}_lastObjcet=new menu(options);return _lastObjcet};SMK.menu.hover=function(options){options=options==undefined?{}:options;createObj(options).hover()};SMK.menu.click=function(options){options=options==undefined?{}:options;createObj(options).click()};SMK.menu.tab=function(options){var defin={eType:"click",tabEleParent:null,contEleParent:null,css:"active",callback:null};var opt=$.extend({},defin,options?options:{});if(opt.eType!="click"&&opt.eType!="hover"){return}opt.tabEleParent.children()[opt.eType](function(e){if($(this).hasClass(opt.css)){return false}var index=$(this).index();$(this).addClass(opt.css).siblings().removeClass(opt.css);opt.contEleParent.children().eq(index).show().siblings().hide();if(typeof opt.callback=="function"){opt.callback(opt)}e.stopPropagation();return false})};var dropMenu={bindEvt:function(){var $body=$("body"),timer;if(!$body.length){return}$body.on("mouseout",'[data-widget="dropdown"]',function(){var $this=$(this);timer&&clearTimeout(timer);timer=setTimeout(function(){$this.removeClass("WDS_hover")},100)});$body.on("mouseover",'[data-widget="dropdown"]',function(){var $this=$(this);$this.parents("ul").find(".WDS_hover").removeClass("WDS_hover");$this.addClass("WDS_hover");timer&&clearTimeout(timer)});var inputSelector=".WDS_frm_search .WDS_ipt_1, .WDS_ipt_search";$body.on("focus",inputSelector,function(){$(this).addClass("WDS_ipt_focus")}).on("blur",inputSelector,function(){$(this).removeClass("WDS_ipt_focus")})},init:function(){this.bindEvt()}};dropMenu.init();(function(){var navMsg={getMsgNum:function(){var that=this,$num=that.$num,url=$num.attr("ajax-url");if(!!url){$.ajax({url:url,type:"GET",dataType:"json",success:function(data){var num=data&&data.data&&data.data.count||0;$num.text(num)},error:function(){$num.text(0)}})}},init:function(){var selector={li:"#nav_msg",num:".brush1"};var that=this,$li=$(selector.li),$num;if($li.length){$num=$li.find(selector.num);if($num.length){that.$num=$num;that.getMsgNum()}}}}})();var _timer=null;$(".ico-fq").mouseover(function(){var $el=$(this);var target=$el.data("target");if(!target){return}var position=$el.offset();var $tips=$('.fq-tips[data-tips="'+target+'"]');var left=position.left+$el.width()+10,top=position.top-50;$(".fq-tips").hide();$tips.css({left:left,top:top}).show()}).mouseout(function(){hideFqTips()});$(".fq-tips").mouseover(function(){clearFqTimer()}).mouseout(function(){hideFqTips()});function clearFqTimer(){if(_timer){clearTimeout(_timer)}}function hideFqTips(){clearFqTimer();_timer=setTimeout(function(){$(".fq-tips").hide()},200)}})();$(function(){$("body").on("focus","[data-placeholder]",function(e){var $this=$(this);var value=$.trim($this.val());var defaultValue=$.trim($this.attr("data-placeholder"));if(value==defaultValue){$this.val("")
}}).on("blur","[data-placeholder]",function(){var $this=$(this);var value=$.trim($this.val());var defaultValue=$.trim($this.attr("data-placeholder"));if(!value){$this.val(defaultValue)}})});var WDStopNav={fetchNavStatus:function(url){var _this=this;$.ajax({url:url,type:"GET",cache:false,dataType:"json",error:function(data){},success:function(data){if(data.code==1){var _html=data.data&&data.data.html;_html&&_this.$wrap.html(_html)}}})},init:function(url){this.$wrap=$("#WDS_TopNav");if(!this.$wrap.length){return}this.fetchNavStatus(url)}};$(function(){var tabDabang={tab:function(){var miniTab=$('.miniTab li:not(".ts-hide")'),tabCon=$(".tabCon ul");for(var i=0;i<miniTab.length;i++){$(miniTab[i]).on("mouseenter",function(){for(var j=0;j<miniTab.length;j++){$(miniTab[j]).removeClass("cur");$(tabCon[j]).hide()}$(this).addClass("cur");var index=$(this).attr("index");$(tabCon[index]).show().siblings().hide()})}$(".miniTab li.ts-hide").on("mouseenter",function(){var text=$(this).prev().find("a").text();$(this).find(".miniTab-ts").css("display","block");$(this).addClass("cur");var _this=$(this);$(".miniTab-ts").on("click",function(){$(this).hide();if(text=="原创男文"){_this.prev().find("a").text("原创女文");_this.prev().attr("index","3");_this.find(".miniTab-ts a").text("原创男文");var index=_this.attr("index")}else{_this.prev().find("a").text("原创男文");_this.prev().attr("index","2");_this.find(".miniTab-ts a").text("原创女文");var index=_this.prev().attr("index")}_this.prev().addClass("cur").siblings().removeClass("cur");for(var i=0;i<tabCon.length;i++){$(tabCon[i]).hide()}$(tabCon[index]).show()})}).on("mouseleave",function(){$(this).find(".miniTab-ts").css("display","none")})},DaBang:function(){function daBang($el){var pageUrl="";var shareUrl="http://service.weibo.com/share/share.php?";var share={title:$el.data("content"),appkey:"",content:"utf-8",$pic:$el.data("pic")};var url=shareUrl+$.param(share);var top=(window.screen.height-400)/2;var left=(window.screen.width-650)/2;window.open(url,"shareWindow","height=400, width=650, top="+top+", left="+left+", toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no")}var bang={bind:function(){$(document).on("click",'[node-type="share"]',function(e){e.preventDefault();daBang($(this))})},init:function(){this.bind()}};bang.init();return bang},init:function(){this.DaBang();this.tab()}};tabDabang.init()});