$(function(){var e=$("body .wrapper .body")[0].className.replace(/\s*body\s*/,""),t=1,n=2,r=e=="wangzhi"||e=="putong"?n:t,i=$(".form"),s="",o={},u=function(t,n){s="";var r=n.id.substr(6),i=$(n).parents("p").first(),u=n.tagName.toLowerCase()=="textarea"?"textarea":n.type,a=i.find("label:first").html(),f=!!a.match(/>\*</),c=$(n).val().replace(/^\s*(.+?)\s*$/,"$1"),h,p;a=a.replace(/\uff1a|<(\w*).+?\/\1>/g,"");if(i.find(".tip").length>0)return s=!0,!1;if(u=="radio"){if(o[n.name])return!0;o[n.name]=!0}f&&(u=="radio"&&$("input[name='"+n.name+"']:checked").length==0?r="empty":c.length==0&&(r="empty"));switch(e+"-"+r){case"wangzhi-url":var d=c.split("\n");if(d.length>20)s="\u4e00\u6b21\u6700\u591a\u63d0\u4ea420\u4e2a\u7f51\u5740";else for(p=0;p<d.length;p++)if(!d[p].match(/^(https?|ftp):\/\/.*$/i)){s="\u7f51\u5740\u683c\u5f0f\u6709\u8bef\uff0c\u6bcf\u6761\u7f51\u5740\u5e94\u4ee5http://\u6216https://\u5f00\u5934";break}break;case"wangzhi-describe":s=c.length<8?a+"\u4e0d\u80fd\u5c11\u4e8e8\u4e2a\u5b57\u3002":c.length<=512?"":a+"\u4e0d\u80fd\u591a\u4e8e512\u4e2a\u5b57\u3002";break;case"putong-email":case"wangzhi-email":s=c.match(/^[\w.]+@(?:\w+.){1,5}\.\w+$/)?"":"email\u5730\u5740\u586b\u5199\u6709\u8bef\u3002",!s&&e=="putong"&&c.match(/@(\w+\.)?qq\.com$/)&&(confirm("\u63d0\u9192\uff1a\u7533\u8bc9\u5904\u7406\u7ed3\u679c\u4f1a\u901a\u8fc7\u90ae\u4ef6\u53d1\u9001\u7ed9\u60a8\uff0c\u901a\u77e5\u90ae\u4ef6\u53ef\u80fd\u4f1a\u88abQQ\u90ae\u7bb1\u8bef\u62a5\u6210\u5783\u573e\u90ae\u4ef6\u3002\u786e\u8ba4\u8981\u4f7f\u7528QQ\u90ae\u7bb1\u5417\uff1f")||(s=!0));break;case"putong-url":s=c.match(/^((https?|ftp):\/\/)?[A-Za-z0-9\-\_]+\.[A-Za-z0-9\-]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/i)?"":a+"\u683c\u5f0f\u6709\u8bef";break;case"putong-detail":s=c.length>=20?"":a+"\u6700\u5c1120\u4e2a\u5b57";break;case"putong-ic":s=c==""||c.match(/^\d{17}[x\d]$/i)?"":a+"\u586b\u5199\u6709\u8bef";break;case"putong-tel":s=c==""||c.match(/^\+?\(?\d[\d\-()]{5,15}\d$/)?"":a+"\u586b\u5199\u6709\u8bef";break;case"wenjian-im-value":case"putong-im-value":if(c.length==0)break;case"wenjian-im-id":case"putong-im-id":var v=$(n).siblings("select").val();h=v=="qq"?/\d{5,11}/:v=="msn"?/^[\w.]+@(?:\w+.){1,5}\w+$/:/.*/,s=c.match(h)?"":v.toUpperCase()+"\u586b\u5199\u6709\u8bef";break;case"wangzhi-captcha":case"wenjian-captcha":case"wenjian-code":case"putong-captcha":case"putong-code":s=c.match(/^\w{4,8}$/)?"":"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801",s&&l.renew();break;case"wangzhi-empty":case"wenjian-empty":case"putong-empty":s=u=="radio"||u=="checkbox"?"\u8bf7\u9009\u62e9"+a:a+"\u4e0d\u80fd\u4e3a\u7a7a"}if(s===!0)return!1;if(s){var m=$('<span class="tip block"><label></label><i></i>'+s+"</span>");return(u=="radio"||u=="checkbox")&&$('input[name="'+n.name+'"]').focus(function(){m.remove()}),$(n).focus(function(){m.remove()}),m.appendTo(i),!1}return!0},a=function(e){o={},i.find("input:not([type=submit]):not([type=hidden]),textarea").each(u),s||($(this).find("input[type=submit]").val("\u63d0\u4ea4\u4e2d...").addClass("disable").attr("disabled","disabled"),i.submit())};i.find("input:not([type=submit]):not([type=hidden]),textarea").blur(function(){u(0,this)}),$(":submit").click(function(e){e.preventDefault(),QHPass.when.signIn(a)});var f={init:function(){if("placeholder"in document.createElement("input"))return;$("input, textarea").each(function(e,t){var n=$(t).attr("placeholder");if(n){var r=$(t),i=$("<span />").addClass("placeholder").html(n).insertBefore(t);i.click(function(){r.focus()}),r.blur(function(){r.val().length==0&&i.css("display","inline")}).focus(function(){i.hide()})}})}},l={$img:$(),init:function(){var e=this,n=$(".form .captcha");this.$img=n.find("img,.captcha-img"),n.find(".link").add(this.$img).click(function(t){t.preventDefault(),e.renew()}),r==t&&this.renew()},renew:function(){var e=!1,t=this;if(r==n){var i=this.$img.attr("src").replace(/([\?\&])?t=.*$|$/,"&")+"t="+(new Date).getTime();this.$img.attr("src",i),this.$img.siblings("input").val("")}else e||$.ajax({url:"http://sampleup.sd.360.cn/sampleup_imgcode_json.php",dataType:"jsonp",beforeSend:function(){e=!0},success:function(n){e=!1,t.$img.attr("src","http://captcha.360.cn/image.php?app=360sd&t="+n.en),t.$img.siblings("input").val(""),$("#captcha-en").val(n.en)}})}};l.init(),f.init()});