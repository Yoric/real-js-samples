(function(){if(!a){var a=(function(){var g={};var b="theia";var d=[];var c=200;var f;g[b]={IE:/msie/i.test(navigator.userAgent),E:function(h){if(typeof h==="string"){return document.getElementById(h)}else{return h}},C:function(h){var i;h=h.toUpperCase();if(h=="TEXT"){i=document.createTextNode("")}else{if(h=="BUFFER"){i=document.createDocumentFragment()}else{i=document.createElement(h)}}return i},log:function(){var n,m=arguments,j=m.length,i=[].slice.apply(m,[0,j]),k="error",h;while(i[--j]){if(i[j] instanceof Error){n=i.splice(j,1)[0];break}}if(!n){n=new Error();k="log"}h=[i,k,new Date().getTime(),n.message,n.stack];if(f){try{f.apply(null,h)}catch(o){}}else{d.length>=c&&d.shift();d.push(h)}},_regLogFn:function(h){f=h},_clearLogList:function(){return d.splice(0,d.length)}};var e=g[b];e.register=function(m,h,l){if(!l||typeof l!="string"){l=b}if(!g[l]){g[l]={}}var j=g[l];var o=m.split(".");var n=j;var i=null;while(i=o.shift()){if(o.length){if(n[i]===undefined){n[i]={}}n=n[i]}else{if(n[i]===undefined){try{if(l&&l!==b){if(m==="core.util.listener"){n[i]=g[b].core.util.listener;return true}if(m==="core.util.connect"){n[i]=g[b].core.util.connect;return true}}n[i]=h(j);return true}catch(p){setTimeout(function(){console.log(p)},0)}}}}return false};e.unRegister=function(l,j){if(!j||typeof j!="string"){j=b}var i=g[j];var n=l.split(".");var m=i;var h=null;while(h=n.shift()){if(n.length){if(m[h]===undefined){return false}m=m[h]}else{if(m[h]!==undefined){delete m[h];return true}}}return false};e.regShort=function(h,i){if(e[h]!==undefined){throw"["+h+"] : short : has been register"}e[h]=i};e.shortRegister=function(m,h,l){if(!l||typeof l!="string"){l=b}var j=g[l];var o=m.split(".");if(!h){return false}if(j[h]){return false}var n=j;var i=null;while(i=o.shift()){if(o.length){if(n[i]===undefined){return false}n=n[i]}else{if(n[i]!==undefined){if(j[h]){return false}j[h]=n[i];return true}}}return false};e.getPKG=function(h){if(!h||typeof h!="string"){h=b}return g[h]};return e})()}a.register("core.dom.sizzle",function(l){var r=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,k=0,f=Object.prototype.toString,q=false,j=true;[0,0].sort(function(){j=false;return 0});var c=function(x,e,A,B){A=A||[];e=e||document;var D=e;if(e.nodeType!==1&&e.nodeType!==9){return[]}if(!x||typeof x!=="string"){return A}var y=[],u,F,I,t,w=true,v=c.isXML(e),C=x,E,H,G,z;do{r.exec("");u=r.exec(C);if(u){C=u[3];y.push(u[1]);if(u[2]){t=u[3];break}}}while(u);if(y.length>1&&m.exec(x)){if(y.length===2&&g.relative[y[0]]){F=i(y[0]+y[1],e)}else{F=g.relative[y[0]]?[e]:c(y.shift(),e);while(y.length){x=y.shift();if(g.relative[x]){x+=y.shift()}F=i(x,F)}}}else{if(!B&&y.length>1&&e.nodeType===9&&!v&&g.match.ID.test(y[0])&&!g.match.ID.test(y[y.length-1])){E=c.find(y.shift(),e,v);e=E.expr?c.filter(E.expr,E.set)[0]:E.set[0]}if(e){E=B?{expr:y.pop(),set:b(B)}:c.find(y.pop(),y.length===1&&(y[0]==="~"||y[0]==="+")&&e.parentNode?e.parentNode:e,v);F=E.expr?c.filter(E.expr,E.set):E.set;if(y.length>0){I=b(F)}else{w=false}while(y.length){H=y.pop();G=H;if(!g.relative[H]){H=""}else{G=y.pop()}if(G==null){G=e}g.relative[H](I,G,v)}}else{I=y=[]}}if(!I){I=F}if(!I){c.error(H||x)}if(f.call(I)==="[object Array]"){if(!w){A.push.apply(A,I)}else{if(e&&e.nodeType===1){for(z=0;I[z]!=null;z++){if(I[z]&&(I[z]===true||I[z].nodeType===1&&c.contains(e,I[z]))){A.push(F[z])}}}else{for(z=0;I[z]!=null;z++){if(I[z]&&I[z].nodeType===1){A.push(F[z])}}}}}else{b(I,A)}if(t){c(t,D,A,B);c.uniqueSort(A)}return A};c.uniqueSort=function(t){if(d){q=j;t.sort(d);if(q){for(var e=1;e<t.length;e++){if(t[e]===t[e-1]){t.splice(e--,1)}}}}return t};c.matches=function(e,t){return c(e,null,null,t)};c.find=function(z,e,A){var y;if(!z){return[]}for(var v=0,u=g.order.length;v<u;v++){var x=g.order[v],w;if((w=g.leftMatch[x].exec(z))){var t=w[1];w.splice(1,1);if(t.substr(t.length-1)!=="\\"){w[1]=(w[1]||"").replace(/\\/g,"");y=g.find[x](w,e,A);if(y!=null){z=z.replace(g.match[x],"");break}}}}if(!y){y=e.getElementsByTagName("*")}return{set:y,expr:z}};c.filter=function(D,C,G,w){var u=D,I=[],A=C,y,e,z=C&&C[0]&&c.isXML(C[0]);while(D&&C.length){for(var B in g.filter){if((y=g.leftMatch[B].exec(D))!=null&&y[2]){var t=g.filter[B],H,F,v=y[1];e=false;y.splice(1,1);if(v.substr(v.length-1)==="\\"){continue}if(A===I){I=[]}if(g.preFilter[B]){y=g.preFilter[B](y,A,G,I,w,z);if(!y){e=H=true}else{if(y===true){continue}}}if(y){for(var x=0;(F=A[x])!=null;x++){if(F){H=t(F,y,x,A);var E=w^!!H;if(G&&H!=null){if(E){e=true}else{A[x]=false}}else{if(E){I.push(F);e=true}}}}}if(H!==undefined){if(!G){A=I}D=D.replace(g.match[B],"");if(!e){return[]}break}}}if(D===u){if(e==null){c.error(D)}else{break}}u=D}return A};c.error=function(e){throw"Syntax error, unrecognized expression: "+e};var g={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(e){return e.getAttribute("href")}},relative:{"+":function(y,t){var v=typeof t==="string",x=v&&!/\W/.test(t),z=v&&!x;if(x){t=t.toLowerCase()}for(var u=0,e=y.length,w;u<e;u++){if((w=y[u])){while((w=w.previousSibling)&&w.nodeType!==1){}y[u]=z||w&&w.nodeName.toLowerCase()===t?w||false:w===t}}if(z){c.filter(t,y,true)}},">":function(y,t){var w=typeof t==="string",x,u=0,e=y.length;if(w&&!/\W/.test(t)){t=t.toLowerCase();for(;u<e;u++){x=y[u];if(x){var v=x.parentNode;y[u]=v.nodeName.toLowerCase()===t?v:false}}}else{for(;u<e;u++){x=y[u];if(x){y[u]=w?x.parentNode:x.parentNode===t}}if(w){c.filter(t,y,true)}}},"":function(v,t,x){var u=k++,e=s,w;if(typeof t==="string"&&!/\W/.test(t)){t=t.toLowerCase();w=t;e=p}e("parentNode",t,u,v,w,x)},"~":function(v,t,x){var u=k++,e=s,w;if(typeof t==="string"&&!/\W/.test(t)){t=t.toLowerCase();w=t;e=p}e("previousSibling",t,u,v,w,x)}},find:{ID:function(t,u,v){if(typeof u.getElementById!=="undefined"&&!v){var e=u.getElementById(t[1]);return e?[e]:[]}},NAME:function(u,x){if(typeof x.getElementsByName!=="undefined"){var t=[],w=x.getElementsByName(u[1]);for(var v=0,e=w.length;v<e;v++){if(w[v].getAttribute("name")===u[1]){t.push(w[v])}}return t.length===0?null:t}},TAG:function(e,t){return t.getElementsByTagName(e[1])}},preFilter:{CLASS:function(v,t,u,e,y,z){v=" "+v[1].replace(/\\/g,"")+" ";if(z){return v}for(var w=0,x;(x=t[w])!=null;w++){if(x){if(y^(x.className&&(" "+x.className+" ").replace(/[\t\n]/g," ").indexOf(v)>=0)){if(!u){e.push(x)}}else{if(u){t[w]=false}}}}return false},ID:function(e){return e[1].replace(/\\/g,"")},TAG:function(t,e){return t[1].toLowerCase()},CHILD:function(e){if(e[1]==="nth"){var t=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(e[2]==="even"&&"2n"||e[2]==="odd"&&"2n+1"||!/\D/.test(e[2])&&"0n+"+e[2]||e[2]);e[2]=(t[1]+(t[2]||1))-0;e[3]=t[3]-0}e[0]=k++;return e},ATTR:function(w,t,u,e,x,y){var v=w[1].replace(/\\/g,"");if(!y&&g.attrMap[v]){w[1]=g.attrMap[v]}if(w[2]==="~="){w[4]=" "+w[4]+" "}return w},PSEUDO:function(w,t,u,e,x){if(w[1]==="not"){if((r.exec(w[3])||"").length>1||/^\w/.test(w[3])){w[3]=c(w[3],null,null,t)}else{var v=c.filter(w[3],t,u,true^x);if(!u){e.push.apply(e,v)}return false}}else{if(g.match.POS.test(w[0])||g.match.CHILD.test(w[0])){return true}}return w},POS:function(e){e.unshift(true);return e}},filters:{enabled:function(e){return e.disabled===false&&e.type!=="hidden"},disabled:function(e){return e.disabled===true},checked:function(e){return e.checked===true},selected:function(e){e.parentNode.selectedIndex;return e.selected===true},parent:function(e){return !!e.firstChild},empty:function(e){return !e.firstChild},has:function(u,t,e){return !!c(e[3],u).length},header:function(e){return(/h\d/i).test(e.nodeName)},text:function(e){return"text"===e.type},radio:function(e){return"radio"===e.type},checkbox:function(e){return"checkbox"===e.type},file:function(e){return"file"===e.type},password:function(e){return"password"===e.type},submit:function(e){return"submit"===e.type},image:function(e){return"image"===e.type},reset:function(e){return"reset"===e.type},button:function(e){return"button"===e.type||e.nodeName.toLowerCase()==="button"},input:function(e){return(/input|select|textarea|button/i).test(e.nodeName)}},setFilters:{first:function(t,e){return e===0},last:function(u,t,e,v){return t===v.length-1},even:function(t,e){return e%2===0},odd:function(t,e){return e%2===1},lt:function(u,t,e){return t<e[3]-0},gt:function(u,t,e){return t>e[3]-0},nth:function(u,t,e){return e[3]-0===t},eq:function(u,t,e){return e[3]-0===t}},filter:{PSEUDO:function(u,z,y,A){var e=z[1],t=g.filters[e];if(t){return t(u,y,z,A)}else{if(e==="contains"){return(u.textContent||u.innerText||c.getText([u])||"").indexOf(z[3])>=0}else{if(e==="not"){var v=z[3];for(var x=0,w=v.length;x<w;x++){if(v[x]===u){return false}}return true}else{c.error("Syntax error, unrecognized expression: "+e)}}}},CHILD:function(e,v){var y=v[1],t=e;switch(y){case"only":case"first":while((t=t.previousSibling)){if(t.nodeType===1){return false}}if(y==="first"){return true}t=e;case"last":while((t=t.nextSibling)){if(t.nodeType===1){return false}}return true;case"nth":var u=v[2],B=v[3];if(u===1&&B===0){return true}var x=v[0],A=e.parentNode;if(A&&(A.sizcache!==x||!e.nodeIndex)){var w=0;for(t=A.firstChild;t;t=t.nextSibling){if(t.nodeType===1){t.nodeIndex=++w}}A.sizcache=x}var z=e.nodeIndex-B;if(u===0){return z===0}else{return(z%u===0&&z/u>=0)}}},ID:function(t,e){return t.nodeType===1&&t.getAttribute("id")===e},TAG:function(t,e){return(e==="*"&&t.nodeType===1)||t.nodeName.toLowerCase()===e},CLASS:function(t,e){return(" "+(t.className||t.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(x,v){var u=v[1],e=g.attrHandle[u]?g.attrHandle[u](x):x[u]!=null?x[u]:x.getAttribute(u),y=e+"",w=v[2],t=v[4];return e==null?w==="!=":w==="="?y===t:w==="*="?y.indexOf(t)>=0:w==="~="?(" "+y+" ").indexOf(t)>=0:!t?y&&e!==false:w==="!="?y!==t:w==="^="?y.indexOf(t)===0:w==="$="?y.substr(y.length-t.length)===t:w==="|="?y===t||y.substr(0,t.length+1)===t+"-":false},POS:function(w,t,u,x){var e=t[2],v=g.setFilters[e];if(v){return v(w,u,t,x)}}}};c.selectors=g;var m=g.match.POS,h=function(t,e){return"\\"+(e-0+1)};for(var o in g.match){g.match[o]=new RegExp(g.match[o].source+(/(?![^\[]*\])(?![^\(]*\))/.source));g.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+g.match[o].source.replace(/\\(\d+)/g,h))}var b=function(t,e){t=Array.prototype.slice.call(t,0);if(e){e.push.apply(e,t);return e}return t};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(n){b=function(w,v){var t=v||[],u=0;if(f.call(w)==="[object Array]"){Array.prototype.push.apply(t,w)}else{if(typeof w.length==="number"){for(var e=w.length;u<e;u++){t.push(w[u])}}else{for(;w[u];u++){t.push(w[u])}}}return t}}var d;if(document.documentElement.compareDocumentPosition){d=function(t,e){if(!t.compareDocumentPosition||!e.compareDocumentPosition){if(t==e){q=true}return t.compareDocumentPosition?-1:1}var u=t.compareDocumentPosition(e)&4?-1:t===e?0:1;if(u===0){q=true}return u}}else{if("sourceIndex" in document.documentElement){d=function(t,e){if(!t.sourceIndex||!e.sourceIndex){if(t==e){q=true}return t.sourceIndex?-1:1}var u=t.sourceIndex-e.sourceIndex;if(u===0){q=true}return u}}else{if(document.createRange){d=function(v,t){if(!v.ownerDocument||!t.ownerDocument){if(v==t){q=true}return v.ownerDocument?-1:1}var u=v.ownerDocument.createRange(),e=t.ownerDocument.createRange();u.setStart(v,0);u.setEnd(v,0);e.setStart(t,0);e.setEnd(t,0);var w=u.compareBoundaryPoints(Range.START_TO_END,e);if(w===0){q=true}return w}}}}c.getText=function(e){var t="",v;for(var u=0;e[u];u++){v=e[u];if(v.nodeType===3||v.nodeType===4){t+=v.nodeValue}else{if(v.nodeType!==8){t+=c.getText(v.childNodes)}}}return t};(function(){var t=document.createElement("div"),u="script"+(new Date()).getTime();t.innerHTML="<a name='"+u+"'/>";var e=document.documentElement;e.insertBefore(t,e.firstChild);if(document.getElementById(u)){g.find.ID=function(w,x,y){if(typeof x.getElementById!=="undefined"&&!y){var v=x.getElementById(w[1]);return v?v.id===w[1]||typeof v.getAttributeNode!=="undefined"&&v.getAttributeNode("id").nodeValue===w[1]?[v]:undefined:[]}};g.filter.ID=function(x,v){var w=typeof x.getAttributeNode!=="undefined"&&x.getAttributeNode("id");return x.nodeType===1&&w&&w.nodeValue===v}}e.removeChild(t);e=t=null})();(function(){var e=document.createElement("div");e.appendChild(document.createComment(""));if(e.getElementsByTagName("*").length>0){g.find.TAG=function(t,x){var w=x.getElementsByTagName(t[1]);if(t[1]==="*"){var v=[];for(var u=0;w[u];u++){if(w[u].nodeType===1){v.push(w[u])}}w=v}return w}}e.innerHTML="<a href='#'></a>";if(e.firstChild&&typeof e.firstChild.getAttribute!=="undefined"&&e.firstChild.getAttribute("href")!=="#"){g.attrHandle.href=function(t){return t.getAttribute("href",2)}}e=null})();if(document.querySelectorAll){(function(){var e=c,u=document.createElement("div");u.innerHTML="<p class='TEST'></p>";if(u.querySelectorAll&&u.querySelectorAll(".TEST").length===0){return}c=function(y,x,v,w){x=x||document;if(!w&&x.nodeType===9&&!c.isXML(x)){try{return b(x.querySelectorAll(y),v)}catch(z){}}return e(y,x,v,w)};for(var t in e){c[t]=e[t]}u=null})()}(function(){var e=document.createElement("div");e.innerHTML="<div class='test e'></div><div class='test'></div>";if(!e.getElementsByClassName||e.getElementsByClassName("e").length===0){return}e.lastChild.className="e";if(e.getElementsByClassName("e").length===1){return}g.order.splice(1,0,"CLASS");g.find.CLASS=function(t,u,v){if(typeof u.getElementsByClassName!=="undefined"&&!v){return u.getElementsByClassName(t[1])}};e=null})();function p(t,y,x,B,z,A){for(var v=0,u=B.length;v<u;v++){var e=B[v];if(e){e=e[t];var w=false;while(e){if(e.sizcache===x){w=B[e.sizset];break}if(e.nodeType===1&&!A){e.sizcache=x;e.sizset=v}if(e.nodeName.toLowerCase()===y){w=e;break}e=e[t]}B[v]=w}}}function s(t,y,x,B,z,A){for(var v=0,u=B.length;v<u;v++){var e=B[v];if(e){e=e[t];var w=false;while(e){if(e.sizcache===x){w=B[e.sizset];break}if(e.nodeType===1){if(!A){e.sizcache=x;e.sizset=v}if(typeof y!=="string"){if(e===y){w=true;break}}else{if(c.filter(y,[e]).length>0){w=e;break}}}e=e[t]}B[v]=w}}}c.contains=document.compareDocumentPosition?function(t,e){return !!(t.compareDocumentPosition(e)&16)}:function(t,e){return t!==e&&(t.contains?t.contains(e):true)};c.isXML=function(e){var t=(e?e.ownerDocument||e:0).documentElement;return t?t.nodeName!=="HTML":false};var i=function(e,z){var v=[],w="",x,u=z.nodeType?[z]:z;while((x=g.match.PSEUDO.exec(e))){w+=x[0];e=e.replace(g.match.PSEUDO,"")}e=g.relative[e]?e+"*":e;for(var y=0,t=u.length;y<t;y++){c(e,u[y],v)}return c.filter(w,v)};return c});a.register("core.dom.builder",function(b){return function(f,e){var k=((typeof f)==="string");var c=f;if(k){c=b.C("div");c.innerHTML=f}var l,g;l={};if(e){for(m in selectorList){l[m]=b.core.dom.sizzle(e[m].toString(),c)}}else{g=b.core.dom.sizzle("[node-type]",c);for(var h=0,j=g.length;h<j;h+=1){var m=g[h].getAttribute("node-type");if(!l[m]){l[m]=[]}l[m].push(g[h])}}var d=f;if(k){d=b.C("buffer");while(c.childNodes[0]){d.appendChild(c.childNodes[0])}}return{box:d,list:l}}});a.register("core.dom.isNode",function(b){return function(c){return(c!=undefined)&&Boolean(c.nodeName)&&Boolean(c.nodeType)}});a.register("core.evt.addEvent",function(b){return function(e,d,c){e=b.E(e);if(e==null){return false}if(typeof c!=="function"){return false}if(e.addEventListener){e.addEventListener(d,c,false)}else{if(e.attachEvent){e.attachEvent("on"+d,c)}else{e["on"+d]=c}}return true}});a.register("core.util.browser",function(i){var b=navigator.userAgent.toLowerCase();var l=window.external||"";var d,f,g,n,h;var c=function(e){var m=0;return parseFloat(e.replace(/\./g,function(){return(m++==1)?"":"."}))};try{if((/windows|win32/i).test(b)){h="windows"}else{if((/macintosh/i).test(b)){h="macintosh"}else{if((/rhino/i).test(b)){h="rhino"}}}if((f=b.match(/applewebkit\/([^\s]*)/))&&f[1]){d="webkit";n=c(f[1])}else{if((f=b.match(/presto\/([\d.]*)/))&&f[1]){d="presto";n=c(f[1])}else{if(f=b.match(/msie\s([^;]*)/)){d="trident";n=1;if((f=b.match(/trident\/([\d.]*)/))&&f[1]){n=c(f[1])}}else{if(/gecko/.test(b)){d="gecko";n=1;if((f=b.match(/rv:([\d.]*)/))&&f[1]){n=c(f[1])}}}}}if(/world/.test(b)){g="world"}else{if(/360se/.test(b)){g="360"}else{if((/maxthon/.test(b))||typeof l.max_version=="number"){g="maxthon"}else{if(/tencenttraveler\s([\d.]*)/.test(b)){g="tt"}else{if(/se\s([\d.]*)/.test(b)){g="sogou"}}}}}}catch(k){}var j={OS:h,CORE:d,Version:n,EXTRA:(g?g:false),IE:/msie/.test(b),OPERA:/opera/.test(b),MOZ:/gecko/.test(b)&&!/(compatible|webkit)/.test(b),IE5:/msie 5 /.test(b),IE55:/msie 5.5/.test(b),IE6:/msie 6/.test(b),IE7:/msie 7/.test(b),IE8:/msie 8/.test(b),IE9:/msie 9/.test(b),IE10:/msie 10/.test(b),SAFARI:!/chrome\/([\d.]*)/.test(b)&&/\/([\da-f.]*) safari/.test(b),CHROME:/chrome\/([\d.]*)/.test(b),IPAD:/\(ipad/i.test(b),IPHONE:/\(iphone/i.test(b),ITOUCH:/\(itouch/i.test(b),MOBILE:/mobile/i.test(b)};return j});a.register("core.func.getType",function(b){return function(c){var d;return((d=typeof(c))=="object"?c==null&&"null"||Object.prototype.toString.call(c).slice(8,-1):d).toLowerCase()}});a.register("core.dom.ready",function(h){var d=[];var m=false;var l=h.core.func.getType;var i=h.core.util.browser;var g=h.core.evt.addEvent;var j=function(){if(!m){if(document.readyState==="complete"){return true}}return m};var e=function(){if(m==true){return}m=true;for(var o=0,n=d.length;o<n;o++){if(l(d[o])==="function"){try{d[o].call()}catch(p){}}}d=[]};var b=function(){if(j()){e();return}try{document.documentElement.doScroll("left")}catch(n){setTimeout(arguments.callee,25);return}e()};var c=function(){if(j()){e();return}setTimeout(arguments.callee,25)};var f=function(){g(document,"DOMContentLoaded",e)};var k=function(){g(window,"load",e)};if(!j()){if(h.IE&&window===window.top){b()}f();c();k()}return function(n){if(j()){if(l(n)==="function"){n.call()}}else{d.push(n)}}});a.register("core.dom.setStyle",function(c){function b(){if("y" in b){return b.y}return b.y=("filters" in c.C("div"))}return function(d,e,f){if(b()){switch(e){case"opacity":d.style.filter="alpha(opacity="+(f*100)+")";if(!d.currentStyle||!d.currentStyle.hasLayout){d.style.zoom=1}break;case"float":e="styleFloat";default:d.style[e]=f}}else{if(e=="float"){e="cssFloat"}d.style[e]=f}}});a.register("core.dom.getStyle",function(c){function b(){if("y" in b){return b.y}return b.y=("filters" in c.C("div"))}return function(f,h){if(b()){switch(h){case"opacity":var j=100;try{j=f.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(i){try{j=f.filters("alpha").opacity}catch(i){}}return j/100;case"float":h="styleFloat";default:var g=f.currentStyle?f.currentStyle[h]:null;return(f.style[h]||g)}}else{if(h=="float"){h="cssFloat"}try{var d=document.defaultView.getComputedStyle(f,"")}catch(i){}return f.style[h]||d?d[h]:null}}});a.register("core.dom.hasClassName",function(b){return function(d,c){return(new RegExp("(^|\\s)"+c+"($|\\s)").test(d.className))}});a.register("core.str.trim",function(b){return function(f){if(typeof f!=="string"){throw"trim need a string as parameter"}var c=f.length;var e=0;var d=/(\u3000|\s|\t|\u00A0)/;while(e<c){if(!d.test(f.charAt(e))){break}e+=1}while(c>e){if(!d.test(f.charAt(c-1))){break}c-=1}return f.slice(e,c)}});a.register("core.dom.addClassName",function(b){return function(d,c){if(d.nodeType===1){if(!b.core.dom.hasClassName(d,c)){d.className=b.core.str.trim(d.className)+" "+c}}}});a.register("core.dom.removeClassName",function(b){return function(d,c){if(d.nodeType===1){if(b.core.dom.hasClassName(d,c)){d.className=d.className.replace(new RegExp("(^|\\s)"+c+"($|\\s)")," ")}}}});a.register("core.dom.contains",function(b){return function(c,d){if(c===d){return false}else{if(c.compareDocumentPosition){return((c.compareDocumentPosition(d)&16)===16)}else{if(c.contains&&d.nodeType===1){return c.contains(d)}else{while(d=d.parentNode){if(c===d){return true}}}}}return false}});a.register("core.util.scrollPos",function(b){return function(e){e=e||document;var c=e.documentElement;var d=e.body;return{top:Math.max(window.pageYOffset||0,c.scrollTop,d.scrollTop),left:Math.max(window.pageXOffset||0,c.scrollLeft,d.scrollLeft)}}});a.register("core.obj.parseParam",function(b){return function(e,d,c){var f,g={};d=d||{};for(f in e){g[f]=e[f];if(d[f]!=null){if(c){if(e.hasOwnProperty(f)){g[f]=d[f]}}else{g[f]=d[f]}}}return g}});a.register("core.dom.position",function(d){var b=function(h){var i,g,f,e,k,j;i=h.getBoundingClientRect();g=d.core.util.scrollPos();f=h.ownerDocument.body;e=h.ownerDocument.documentElement;k=e.clientTop||f.clientTop||0;j=e.clientLeft||f.clientLeft||0;return{l:parseInt(i.left+g.left-j,10)||0,t:parseInt(i.top+g.top-k,10)||0}};var c=function(g,e){var h,f;h=[g.offsetLeft,g.offsetTop];f=g.offsetParent;if(f!==g&&f!==e){while(f){h[0]+=f.offsetLeft;h[1]+=f.offsetTop;f=f.offsetParent}}if(d.core.util.browser.OPERA!=-1||(d.core.util.browser.SAFARI!=-1&&g.style.position=="absolute")){h[0]-=document.body.offsetLeft;h[1]-=document.body.offsetTop}if(g.parentNode){f=g.parentNode}else{f=null}while(f&&!/^body|html$/i.test(f.tagName)&&f!==e){if(f.style.display.search(/^inline|table-row.*$/i)){h[0]-=f.scrollLeft;h[1]-=f.scrollTop}f=f.parentNode}return{l:parseInt(h[0],10),t:parseInt(h[1],10)}};return function(g,e){if(g==document.body){return false}if(g.parentNode==null){return false}if(g.style.display=="none"){return false}var f=d.core.obj.parseParam({parent:null},e);if(g.getBoundingClientRect){if(f.parent){var i=b(g);var h=b(f.parent);return{l:i.l-h.l,t:i.t-h.t}}else{return b(g)}}else{return c(g,f.parent||document.body)}}});a.register("core.util.hideContainer",function(d){var e;var b=function(){if(e){return}e=d.C("div");e.style.cssText="position:absolute;top:-9999px;left:-9999px;";document.getElementsByTagName("head")[0].appendChild(e)};var c={appendChild:function(f){if(d.core.dom.isNode(f)){b();e.appendChild(f)}},removeChild:function(f){if(d.core.dom.isNode(f)){e&&e.removeChild(f)}}};return c});a.register("core.dom.getSize",function(c){var b=function(e){if(!c.core.dom.isNode(e)){throw"core.dom.getSize need Element as first parameter"}return{width:e.offsetWidth,height:e.offsetHeight}};var d=function(f){var e=null;if(f.style.display==="none"){f.style.visibility="hidden";f.style.display="";e=b(f);f.style.display="none";f.style.visibility="visible"}else{e=b(f)}return e};return function(f){var e={};if(!f.parentNode){c.core.util.hideContainer.appendChild(f);e=d(f);c.core.util.hideContainer.removeChild(f)}else{e=d(f)}return e}});a.register("core.dom.cssText",function(d){var g=function(n){var m=0;var l=[];var p="close";var j=false;var h=null;var k=function(i){l.push({type:"info",content:n.slice(0,m)});l.push({type:"sign",content:n.slice(m,m+1)});n=n.slice(m+1);m=0};while(n){var o=n.charAt(m);switch(o){case":":if(!j){if(p==="close"){l.push({type:"attr",content:n.slice(0,m)});l.push({type:"sign",content:n.slice(m,m+1)});n=n.slice(m+1);m=0;p="open";break}}m+=1;break;case";":if(!j){if(p==="open"){l.push({type:"info",content:n.slice(0,m)});l.push({type:"sign",content:n.slice(m,m+1)})}n=n.slice(m+1);m=0;p="close";break}m+=1;break;case'"':case"'":if(j){if(o===h){j=!j;h=null}}else{j=!j;h=o}m+=1;break;case" ":case"!":case",":case"(":case")":k(o);break;case"":l.push({type:"info",content:n.slice(0,m)});n="";m=0;break;default:m+=1}}return l};var f=function(l){var j={};var m;for(var k=0,h=l.length;k<h;k+=1){if(l[k].type==="attr"){m=l[k]["content"];j[m]=""}else{if(l[k].type==="sign"&&l[k]["content"]===";"){m=null;continue}else{if(l[k].type==="sign"&&l[k]["content"]===":"){continue}else{if(m!==null){j[m]+=l[k]["content"]}}}}}return j};var b=({webkit:"-webkit-",presto:"-o-",trident:"-ms-",gecko:"-moz-"})[d.core.util.browser.CORE];var e=["transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","animation","animation-delay","animation-direction","animation-duration","animation-iteration-count","animation-name","animation-play-state","animation-timing-function"];var c=function(k){for(var j=0,h=e.length;j<h;j+=1){if(k===e[j]){return true}}return false};return function(j){var k=f(g(j||""));var h=function(m,l){m=m.toLowerCase();k[m]=l;if(c(m)){k[b+m]=l}return i};var i={push:h,remove:function(l){l=l.toLowerCase();k[l]&&delete k[l];if(c(l)){if(k[b+l]){delete k[b+l]}}return i},merge:function(n){var m=f(g(n||""));for(var l in m){h(l,m[l])}},getCss:function(){var m=[];for(var l in k){m.push(l+":"+k[l])}return m.join(";")}};return i}});a.register("core.arr.isArray",function(b){return function(c){return Object.prototype.toString.call(c)==="[object Array]"}});a.register("core.arr.foreach",function(d){var b=function(k,g){var j=[];for(var h=0,f=k.length;h<f;h+=1){var e=g(k[h],h);if(e===false){break}else{if(e!==null){j[h]=e}}}return j};var c=function(i,f){var h={};for(var g in i){var e=f(i[g],g);if(e===false){break}else{if(e!==null){h[g]=e}}}return h};return function(f,e){if(d.core.arr.isArray(f)||(f.length&&f[0]!==undefined)){return b(f,e)}else{if(typeof f==="object"){return c(f,e)}}return null}});a.register("core.evt.removeEvent",function(b){return function(e,d,c){e=b.E(e);if(e==null){return false}if(typeof c!=="function"){return false}if(e.removeEventListener){e.removeEventListener(d,c,false)}else{if(e.detachEvent){e.detachEvent("on"+d,c)}}e["on"+d]=null;return true}});a.register("core.evt.getEvent",function(b){return(function(){if(document.addEventListener){return function(){var d=arguments.callee;var c;do{c=d.arguments[0];if(c&&(c.constructor==Event||c.constructor==MouseEvent||c.constructor==KeyboardEvent)){return c}}while(d=d.caller);return c}}else{return function(e,d,c){return window.event}}}())});a.register("core.evt.stopEvent",function(b){return function(c){c=c||b.core.evt.getEvent();if(c.preventDefault){c.preventDefault();c.stopPropagation()}else{c.cancelBubble=true;c.returnValue=false}return false}});a.register("core.evt.preventDefault",function(b){return function(c){c=c||b.core.evt.getEvent();if(c.preventDefault){c.preventDefault()}else{c.returnValue=false}}});a.register("core.json.queryToJson",function(b){return function(e,j){var l=b.core.str.trim(e).split("&");var k={};var d=function(i){if(j){return decodeURIComponent(i)}else{return i}};for(var g=0,h=l.length;g<h;g++){if(l[g]){var f=l[g].split("=");var c=f[0];var m=f[1];if(f.length<2){m=c;c="$nullName"}if(!k[c]){k[c]=d(m)}else{if(b.core.arr.isArray(k[c])!=true){k[c]=[k[c]]}k[c].push(d(m))}}}return k}});a.register("core.evt.fixEvent",function(c){var b="clientX clientY pageX pageY screenX screenY".split(" ");return function(g){g=g||c.core.evt.getEvent();if(!g.target){g.target=g.srcElement||document}if(g.pageX==null&&g.clientX!=null){var f=document.documentElement;var d=document.body;g.pageX=g.clientX+(f.scrollLeft||d&&d.scrollLeft||0)-(f.clientLeft||d&&d.clientLeft||0);g.pageY=g.clientY+(f.scrollTop||d&&d.scrollTop||0)-(f.clientTop||d&&d.clientTop||0)}if(!g.which&&g.button){if(g.button&1){g.which=1}else{if(g.button&4){g.which=2}else{if(g.button&2){g.which=3}}}}if(g.relatedTarget===undefined){g.relatedTarget=g.fromElement||g.toElement}if(g.layerX==null&&g.offsetX!=null){g.layerX=g.offsetX;g.layerY=g.offsetY}return g}});a.register("core.obj.isEmpty",function(b){return function(e,d){for(var c in e){if(d||e.hasOwnProperty(c)){return false}}return true}});a.register("core.func.empty",function(){return function(){}});a.register("core.evt.delegatedEvent",function(c){var b=function(g,f){for(var e=0,d=g.length;e<d;e+=1){if(c.core.dom.contains(g[e],f)){return true}}return false};return function(f,i){if(!c.core.dom.isNode(f)){throw"core.evt.delegatedEvent need an Element as first Parameter"}if(!i){i=[]}if(c.core.arr.isArray(i)){i=[i]}var d={};var h=function(m){var j=c.core.evt.fixEvent(m);var l=j.target;var k=m.type;e(l,k,j)};var e=function(n,m,k){var l=null;var o=function(){var r,p,q;r=n.getAttribute("action-target");if(r){p=c.core.dom.sizzle(r,f);if(p.length){q=k.target=p[0]}}o=c.core.func.empty;return q};var j=function(){var p=o()||n;if(d[m]&&d[m][l]){return d[m][l]({evt:k,el:p,box:f,data:c.core.json.queryToJson(p.getAttribute("action-data")||"")})}else{return true}};if(b(i,n)){return false}else{if(!c.core.dom.contains(f,n)){return false}else{while(n&&n!==f){if(n.nodeType===1){l=n.getAttribute("action-type");if(l&&j()===false){break}}n=n.parentNode}}}};var g={};g.add=function(l,m,k){if(!d[m]){d[m]={};c.core.evt.addEvent(f,m,h)}var j=d[m];j[l]=k};g.remove=function(j,k){if(d[k]){delete d[k][j];if(c.core.obj.isEmpty(d[k])){delete d[k];c.core.evt.removeEvent(f,k,h)}}};g.pushExcept=function(j){i.push(j)};g.removeExcept=function(l){if(!l){i=[]}else{for(var k=0,j=i.length;k<j;k+=1){if(i[k]===l){i.splice(k,1)}}}};g.clearExcept=function(j){i=[]};g.fireAction=function(k,n,j,m){var l="";if(m&&m.actionData){l=m.actionData}if(d[n]&&d[n][k]){d[n][k]({evt:j,el:null,box:f,data:c.core.json.queryToJson(l),fireFrom:"fireAction"})}};g.fireInject=function(m,n,j){var k=m.getAttribute("action-type");var l=m.getAttribute("action-data");if(k&&d[n]&&d[n][k]){d[n][k]({evt:j,el:m,box:f,data:c.core.json.queryToJson(l||""),fireFrom:"fireInject"})}};g.fireDom=function(k,l,j){e(k,l,j||{})};g.destroy=function(){for(var m in d){for(var j in d[m]){delete d[m][j]}delete d[m];c.core.evt.removeEvent(f,m,h)}};return g}});a.register("core.dom.removeNode",function(b){return function(c){c=b.E(c)||c;try{c.parentNode.removeChild(c)}catch(d){}}});a.register("core.util.getUniqueKey",function(d){var b=(new Date()).getTime().toString(),c=1;return function(){return b+(c++)}});a.register("core.str.parseURL",function(b){return function(e){var d=/^(?:([A-Za-z]+):(\/{0,3}))?([0-9.\-A-Za-z]+\.[0-9A-Za-z]+)?(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;var j=["url","scheme","slash","host","port","path","query","hash"];var g=d.exec(e);var h={};for(var f=0,c=j.length;f<c;f+=1){h[j[f]]=g[f]||""}return h}});a.register("core.json.jsonToQuery",function(b){var c=function(e,d){e=e==null?"":e;e=b.core.str.trim(e.toString());if(d){return encodeURIComponent(e)}return e};return function(h,f){var j=[];if(typeof h=="object"){for(var e in h){if(e==="$nullName"){j=j.concat(h[e]);continue}if(h[e] instanceof Array){for(var g=0,d=h[e].length;g<d;g++){j.push(e+"="+c(h[e][g],f))}}else{if(typeof h[e]!="function"){j.push(e+"="+c(h[e],f))}}}}if(j.length){return j.join("&")}return""}});a.register("core.util.URL",function(b){return function(g,d){var f=b.core.obj.parseParam({isEncodeQuery:false,isEncodeHash:false},d||{});var e={};var i=b.core.str.parseURL(g);var c=b.core.json.queryToJson(i.query);var h=b.core.json.queryToJson(i.hash);e.setParam=function(j,k){c[j]=k;return this};e.getParam=function(j){return c[j]};e.setParams=function(k){for(var j in k){e.setParam(j,k[j])}return this};e.setHash=function(j,k){h[j]=k;return this};e.getHash=function(j){return h[j]};e.valueOf=e.toString=function(){var j=[];var k=b.core.json.jsonToQuery(c,f.isEncodeQuery);var l=b.core.json.jsonToQuery(h,f.isEncodeQuery);if(i.scheme!=""){j.push(i.scheme+":");j.push(i.slash)}if(i.host!=""){j.push(i.host);if(i.port!=""){j.push(":");j.push(i.port)}}j.push("/");j.push(i.path);if(k!=""){j.push("?"+k)}if(l!=""){j.push("#"+l)}return j.join("")};return e}});a.register("core.io.scriptLoader",function(c){var d={};var b={url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:c.core.func.empty,onTimeout:c.core.func.empty,isEncode:false,uniqueID:null};return function(i){var g,e;var f=c.core.obj.parseParam(b,i);if(f.url==""){throw"scriptLoader: url is null"}var h=f.uniqueID||c.core.util.getUniqueKey();g=d[h];if(g!=null&&c.IE!=true){c.core.dom.removeNode(g);g=null}if(g==null){g=d[h]=c.C("script")}g.charset=f.charset;g.id="scriptRequest_script_"+h;g.type="text/javascript";if(f.onComplete!=null){if(c.IE){g.onreadystatechange=function(){if(g.readyState.toLowerCase()=="loaded"||g.readyState.toLowerCase()=="complete"){try{clearTimeout(e);document.getElementsByTagName("head")[0].removeChild(g);g.onreadystatechange=null}catch(j){}f.onComplete()}}}else{g.onload=function(){try{clearTimeout(e);c.core.dom.removeNode(g)}catch(j){}f.onComplete()}}}g.src=c.core.util.URL(f.url,{isEncodeQuery:f.isEncode}).setParams(f.args).toString();document.getElementsByTagName("head")[0].appendChild(g);if(f.timeout>0){e=setTimeout(function(){try{document.getElementsByTagName("head")[0].removeChild(g)}catch(j){}f.onTimeout()},f.timeout)}return g}});a.register("core.io.jsonp",function(b){return function(g){var e=b.core.obj.parseParam({url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,responseName:null,isEncode:false,varkey:"callback"},g);var h=-1;var f=e.responseName||("STK_"+b.core.util.getUniqueKey());e.args[e.varkey]=f;var c=e.onComplete;var d=e.onTimeout;window[f]=function(i){if(h!=2&&c!=null){h=1;c(i)}};e.onComplete=null;e.onTimeout=function(){if(h!=1&&d!=null){h=2;d()}};return b.core.io.scriptLoader(e)}});a.register("core.arr.indexOf",function(b){return function(e,f){if(f.indexOf){return f.indexOf(e)}for(var d=0,c=f.length;d<c;d++){if(f[d]===e){return d}}return -1}});a.register("core.arr.inArray",function(b){return function(c,d){return b.core.arr.indexOf(c,d)>-1}});a.register("core.json.merge",function(d){var c=function(f){if(f===undefined){return true}if(f===null){return true}if(d.core.arr.inArray((typeof f),["number","string","function","boolean"])){return true}if(d.core.dom.isNode(f)){return true}return false};var b=function(h,l,m){if(c(m)){h[l]=m;return}if(d.core.arr.isArray(m)){if(!d.core.arr.isArray(h[l])){h[l]=[]}for(var j=0,f=m.length;j<f;j+=1){b(h[l],j,m[j])}return}if(typeof m==="object"){if(c(h[l])||d.core.arr.isArray(h[l])){h[l]={}}for(var g in m){b(h[l],g,m[g])}return}};var e=function(h,j,g){var i={};if(g){for(var f in h){b(i,f,h[f])}for(var f in j){b(i,f,j[f])}}else{for(var f in h){i[f]=h[f]}for(var f in j){i[f]=j[f]}}return i};return function(f,i,h){var g=d.core.obj.parseParam({isDeep:false},h);return e(f,i,g.isDeep)}});a.register("core.obj.beget",function(c){var b=function(){};return function(d){b.prototype=d;return new b()}});a.register("core.str.encodeHTML",function(b){return function(c){if(typeof c!=="string"){throw"encodeHTML need a string as parameter"}return c.replace(/\&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;").replace(/\'/g,"&#39;").replace(/\u00A0/g,"&nbsp;").replace(/(\u0020|\u000B|\u2028|\u2029|\f)/g,"&#32;")}});a.register("core.str.bLength",function(b){return function(d){if(!d){return 0}var c=d.match(/[^\x00-\xff]/g);return(d.length+(!c?0:c.length))}});a.register("core.str.leftB",function(b){return function(e,c){var d=e.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");e=e.slice(0,d.slice(0,c).replace(/\*\*/g," ").replace(/\*/g,"").length);if(b.core.str.bLength(e)>c&&c>0){e=e.slice(0,e.length-1)}return e}});a.register("core.util.easyTemplate",function(c){var b=function(f,h){if(!f){return""}if(f!==b.template){b.template=f;b.aStatement=b.parsing(b.separate(f))}var e=b.aStatement;var g=function(d){if(d){h=d}return arguments.callee};g.toString=function(){return(new Function(e[0],e[1]))(h)};return g};b.separate=function(d){var f=/\\'/g;var e=d.replace(/(<(\/?)#(.*?(?:\(.*?\))*)>)|(')|([\r\n\t])|(\$\{([^\}]*?)\})/g,function(j,i,p,o,n,m,l,k){if(i){return"{|}"+(p?"-":"+")+o+"{|}"}if(n){return"\\'"}if(m){return""}if(l){return"'+("+k.replace(f,"'")+")+'"}});return e};b.parsing=function(m){var l,f,i,e,h,g,j,k=["var aRet = [];"];j=m.split(/\{\|\}/);var d=/\s/;while(j.length){i=j.shift();if(!i){continue}h=i.charAt(0);if(h!=="+"&&h!=="-"){i="'"+i+"'";k.push("aRet.push("+i+");");continue}e=i.split(d);switch(e[0]){case"+et":l=e[1];f=e[2];k.push('aRet.push("<!--'+l+' start-->");');break;case"-et":k.push('aRet.push("<!--'+l+' end-->");');break;case"+if":e.splice(0,1);k.push("if"+e.join(" ")+"{");break;case"+elseif":e.splice(0,1);k.push("}else if"+e.join(" ")+"{");break;case"-if":k.push("}");break;case"+else":k.push("}else{");break;case"+list":k.push("if("+e[1]+".constructor === Array){with({i:0,l:"+e[1]+".length,"+e[3]+"_index:0,"+e[3]+":null}){for(i=l;i--;){"+e[3]+"_index=(l-i-1);"+e[3]+"="+e[1]+"["+e[3]+"_index];");break;case"-list":k.push("}}}");break;default:break}}k.push('return aRet.join("");');return[f,k.join("")]};return b});a.register("core.evt.custEvent",function(d){var i="__custEventKey__",c=1,h={},e=function(m,l){var k=(typeof m=="number")?m:m[i];return(k&&h[k])&&{obj:(typeof l=="string"?h[k][l]:h[k]),key:k}};var g={};var j=function(p,m,l,n,k){if(p&&typeof m=="string"&&l){var o=e(p,m);if(!o||!o.obj){throw"custEvent ("+m+") is undefined !"}o.obj.push({fn:l,data:n,once:k});return o.key}};var b=function(m,t,r,n){var v=true;var p=function(){v=false};if(m&&typeof t=="string"){var k=e(m,t),q;if(k&&(q=k.obj)){r=typeof r!="undefined"&&[].concat(r)||[];for(var l=q.length-1;l>-1&&q[l];l--){var u=q[l].fn;var s=q[l].once;if(u&&u.apply){try{u.apply(m,[{obj:m,type:t,data:q[l].data,preventDefault:p}].concat(r));if(s){q.splice(l,1)}}catch(o){d.log("[error][custEvent]"+o.message,o,o.stack)}}}if(v&&d.core.func.getType(n)==="function"){n()}return k.key}}};var f={define:function(o,m){if(o&&m){var l=(typeof o=="number")?o:o[i]||(o[i]=c++),n=h[l]||(h[l]={});m=[].concat(m);for(var k=0;k<m.length;k++){n[m[k]]||(n[m[k]]=[])}return l}},undefine:function(n,m){if(n){var l=(typeof n=="number")?n:n[i];if(l&&h[l]){if(m){m=[].concat(m);for(var k=0;k<m.length;k++){if(m[k] in h[l]){delete h[l][m[k]]}}}else{delete h[l]}}}},add:function(n,l,k,m){return j(n,l,k,m,false)},once:function(n,l,k,m){return j(n,l,k,m,true)},remove:function(p,n,m){if(p){var o=e(p,n),q,k;if(o&&(q=o.obj)){if(d.core.arr.isArray(q)){if(m){var l=0;while(q[l]){if(q[l].fn===m){break}l++}q.splice(l,1)}else{q.splice(0,q.length)}}else{for(var l in q){q[l]=[]}}return o.key}}},fire:function(n,m,k,l){return b(n,m,k,l)},hook:function(t,v,n){if(!t||!v||!n){return}var q=[],o=t[i],r=o&&h[o],l,u=v[i]||(v[i]=c++),k;if(r){k=g[o+"_"+u]||(g[o+"_"+u]={});var s=function(x){var w=true;b(v,k[x.type].type,Array.prototype.slice.apply(arguments,[1,arguments.length]),function(){w=false});w&&x.preventDefault()};for(var p in n){var m=n[p];if(!k[p]){if(l=r[p]){l.push({fn:s,data:undefined});k[p]={fn:s,type:m};q.push(m)}}}f.define(v,q)}},unhook:function(r,l,q){if(!r||!l||!q){return}var n=r[i],p=l[i],k=g[n+"_"+p];if(k){for(var m in q){var o=q[m];if(k[m]){f.remove(r,m,k[m].fn)}}}},destroy:function(){h={};c=1;g={}}};return f});a.register("core.util.drag",function(d){var b=function(f){f.cancelBubble=true;return false};var c=function(f,e){f.clientX=e.clientX;f.clientY=e.clientY;f.pageX=e.clientX+d.core.util.scrollPos()["left"];f.pageY=e.clientY+d.core.util.scrollPos()["top"];return f};return function(f,n){if(!d.core.dom.isNode(f)){throw"core.util.drag need Element as first parameter"}var m=d.core.obj.parseParam({actRect:[],actObj:{}},n);var j={};var k=d.core.evt.custEvent.define(m.actObj,"dragStart");var g=d.core.evt.custEvent.define(m.actObj,"dragEnd");var h=d.core.evt.custEvent.define(m.actObj,"draging");var l=function(p){var o=c({},p);document.body.onselectstart=function(){return false};d.core.evt.addEvent(document,"mousemove",i);d.core.evt.addEvent(document,"mouseup",e);d.core.evt.addEvent(document,"click",b,true);if(p.preventDefault){p.preventDefault();p.stopPropagation()}d.core.evt.custEvent.fire(k,"dragStart",o);return false};var i=function(p){var o=c({},p);p.cancelBubble=true;d.core.evt.custEvent.fire(k,"draging",o)};var e=function(p){var o=c({},p);document.body.onselectstart=function(){return true};d.core.evt.removeEvent(document,"mousemove",i);d.core.evt.removeEvent(document,"mouseup",e);d.core.evt.removeEvent(document,"click",b,true);d.core.evt.custEvent.fire(k,"dragEnd",o)};d.core.evt.addEvent(f,"mousedown",l);j.destroy=function(){d.core.evt.removeEvent(f,"mousedown",l);m=null};j.getActObj=function(){return m.actObj};return j}});a.register("core.util.storage",function(f){var b=window.localStorage;if(b){return{get:function(e){return unescape(b.getItem(e))},set:function(e,h,i){b.setItem(e,escape(h))},del:function(e){b.removeItem(e)},clear:function(){b.clear()},getAll:function(){var e=b.length,j=null,k=[];for(var h=0;h<e;h++){j=b.key(h);k.push(j+"="+b.getItem(j))}return k.join("; ")}}}else{if(window.ActiveXObject){var c=document.documentElement;var d="localstorage";try{c.addBehavior("#default#userdata");c.save("localstorage")}catch(g){}return{set:function(e,h){c.setAttribute(e,h);c.save(d)},get:function(e){c.load(d);return c.getAttribute(e)},del:function(e){c.removeAttribute(e);c.save(d)}}}else{return{get:function(m){var j=document.cookie.split("; "),h=j.length,e=[];for(var k=0;k<h;k++){e=j[k].split("=");if(m===e[0]){return unescape(e[1])}}return null},set:function(e,h,i){if(!(i&&(i instanceof Date))){i=new Date();i.setDate(i.getDate()+1)}document.cookie=e+"="+escape(h)+"; expires="+i.toGMTString()},del:function(e){document.cookie=e+"=''; expires=Fri, 31 Dec 1999 23:59:59 GMT;"},clear:function(){var j=document.cookie.split("; "),h=j.length,e=[];for(var k=0;k<h;k++){e=j[k].split("=");this.deleteKey(e[0])}},getAll:function(){return unescape(document.cookie.toString())}}}}});a.register("core.util.cookie",function(c){var b={set:function(h,k,j){var e=[];var i,g;var f=c.core.obj.parseParam({expire:null,path:"/",domain:null,secure:null,encode:true},j);if(f.encode==true){k=escape(k)}e.push(h+"="+k);if(f.path!=null){e.push("path="+f.path)}if(f.domain!=null){e.push("domain="+f.domain)}if(f.secure!=null){e.push(f.secure)}if(f.expire!=null){i=new Date();g=i.getTime()+f.expire*3600000;i.setTime(g);e.push("expires="+i.toGMTString())}document.cookie=e.join(";")},get:function(f){f=f.replace(/([\.\[\]\$])/g,"\\$1");var e=new RegExp(f+"=([^;]*)?;","i");var g=document.cookie+";";var d=g.match(e);if(d){return d[1]||""}else{return""}},remove:function(d,e){e=e||{};e.expire=-10;b.set(d,"",e)}};return b});a.register("core.util.language",function(b){return function(e,g){var f=[];for(var d=2,c=arguments.length;d<c;d+=1){f.push(arguments[d])}return e.replace(/#L\{((.*?)(?:[^\\]))\}/ig,function(){var i=arguments[1];var h;if(g&&g[i]!==undefined){h=g[i]}else{h=i}if(f.length){h=h.replace(/(\%s)/ig,function(){var j=f.shift();if(j!==undefined){return j}else{return arguments[0]}})}return h})}});a.register("core.util.listener",function(b){return(function(){var d={};var e=[];var c;var f=function(){if(e.length==0){return}clearTimeout(c);var g=e.splice(0,1)[0];try{g.func.apply(g.func,[].concat(g.data))}catch(h){}c=setTimeout(f,25)};return{register:function(g,i,h){d[g]=d[g]||{};d[g][i]=d[g][i]||[];d[g][i].push(h)},fire:function(j,l,m){var k;var h,g;if(d[j]&&d[j][l]&&d[j][l].length>0){k=d[j][l];k.data_cache=m;for(h=0,g=k.length;h<g;h++){e.push({channel:j,evt:l,func:k[h],data:m})}f()}},remove:function(j,l,k){if(d[j]){if(d[j][l]){for(var h=0,g=d[j][l].length;h<g;h++){if(d[j][l][h]===k){d[j][l].splice(h,1);break}}}}},list:function(){return d},cache:function(g,h){if(d[g]&&d[g][h]){return d[g][h].data_cache}}}})()});(function(){var c=a.core;var d={isNode:c.dom.isNode,Ready:c.dom.ready,setStyle:c.dom.setStyle,getStyle:c.dom.getStyle,addClassName:c.dom.addClassName,hasClassName:c.dom.hasClassName,removeClassName:c.dom.removeClassName,contains:c.dom.contains,position:c.dom.position,foreach:c.arr.foreach,isArray:c.arr.isArray,addEvent:c.evt.addEvent,removeEvent:c.evt.removeEvent,getEvent:c.evt.getEvent,stopEvent:c.evt.stopEvent,preventDefault:c.evt.preventDefault,getType:c.func.getType,funcEmpty:c.func.empty,jsonp:c.io.jsonp,scriptLoader:c.io.scriptLoader,merge:c.json.merge,jsonToQuery:c.json.jsonToQuery,beget:c.obj.beget,parseParam:c.obj.parseParam,bLength:c.str.bLength,leftB:c.str.leftB,trim:c.str.trim,encodeHTML:c.str.encodeHTML,cookie:c.util.cookie,drag:c.util.drag,listener:c.util.listener,browser:c.util.browser,language:c.language,getUniqueKey:c.util.getUniqueKey};for(var b in d){if(d[b]){a.regShort(b,d[b])}}})();a.register("common.listener",function(c){var d={};var b={};b.define=function(f,g){if(d[f]!=null){throw"common.listener.define: 频道已被占用"}d[f]=g;var e={};e.register=function(i,h){if(d[f]==null){throw"common.listener.define: 频道未定义"}c.core.util.listener.register(f,i,h)};e.fire=function(h,i){if(d[f]==null){throw"commonlistener.define: 频道未定义"}c.core.util.listener.fire(f,h,i)};e.remove=function(i,h){c.core.util.listener.remove(f,i,h)};return e};return b});a.register("common.channel.plugin",function(b){return b.common.listener.define("common.channel.plugin",["outlogin_ready","plugin_ready","weibolist_show","weibolist_hide"])});a.register("kit.obj.append",function(b){return function(g){for(var f=1,d=arguments.length;f<d;f++){var c=arguments[f]||{};for(var e in c){g[e]=c[e]}}return g}});a.register("kit.dom.builder",function(c){var b=null;return function(d){var e=null;if(typeof(d)=="string"){if(!b){b=c.C("div")}b.innerHTML=d;e=b.children[0];b.removeChild(e);b.innerHTML=""}else{e=d}var g={};var f=e.getElementsByTagName("*");if(f.length>0){c.foreach(f,function(j){if(c.isNode(j)){var i=j.getAttribute("node-type");if(i){if(!g[i]){g[i]=[]}g[i].push(j)}}})}var h={};h.box=e;h.list=g;return h}});a.register("kit.dom.parseDOM",function(b){return function(d){for(var c in d){if(d[c]&&(d[c].length==1)){d[c]=d[c][0]}}return d}});a.register("kit.dom.loadStyle",function(e){var d;var c=e.funcEmpty;var b=e.core.util.browser;return function(g,n){var m,h,j=false,l=false;var k=e.parseParam({id:e.getUniqueKey(),timeout:30*1000,styleCheck:null,onLoad:c,onTimeout:c,props:{charset:"utf-8",rel:"stylesheet",media:"screen",type:"text/css"}},n);m=e.C("link");e.foreach(k.props,function(p,o){m[o]=p});m.id=k.id;m.href=g;var f=function(){clearInterval(h);if(!l&&!j){if(e.getType(k.onLoad)==="function"){setTimeout(k.onLoad,100)}}j=true};if(b.IE){m.onload=f}else{if(e.getType(k.styleCheck)==="function"){h=setInterval(function(){if(k.styleCheck()){f()}},10)}else{var i=document.createElement("img");i.onerror=f;i.src=g}}if(k.timeout&&k.onTimeout){setTimeout(function(){clearInterval(h);if(!j&&e.getType(k.onTimeout)==="function"){l=true;k.onTimeout()}},k.timeout)}if(!d){d=document.getElementsByTagName("head")[0]}d.appendChild(m)}});a.register("kit.dom.appendStyle",function(b){return function(f,c){var d=b.parseParam({autoAppend:true,target:null,type:"text/css"},c);var e;f=f||"";f=f.toString();if(b.isNode(d.target)&&d.target.tagName.toLowerCase()==="style"){e=d.target}else{e=document.createElement("style");e.setAttribute("type",d.type)}if(e.styleSheet){e.styleSheet.cssText=e.innerHTML+f}else{e.appendChild(document.createTextNode(f))}if(d.autoAppend){document.getElementsByTagName("head")[0].appendChild(e)}return e}});a.register("kit.util.makeReady",function(b){return function(d){var e=b.parseParam({timeout:30*1000,condition:b.funcEmpty,ready:b.funcEmpty},d);var c,f;return{reset:function(){if(c){c.length=0;c=null}if(f){clearTimeout(f);f=null}},exec:function(g){var h=this;if(b.getType(g)==="function"){if(e.condition()){g()}else{if(!c){c=[];c.push(g);if(!f){f=setTimeout(h.reset,e.timeout)}e.ready(function(){clearTimeout(f);f=null;while(b.getType(c)==="array"&&c.length>0){c.shift()()}})}else{c.push(g)}}}},destroy:function(){this.reset()}}}});a.register("comp.defaultStyle",function(c){var b=['.tn-title-login-custom{float:left!important;font-family: "Microsoft YaHei","微软雅黑","SimSun","宋体"!important;position:relative!important;}',".tn-title-login-custom .tn-user-custom{float:left!important;font-size:12px!important;}",".tn-title-login-custom .tn-user-greet{float:left!important;height:17px!important;padding:12px 0!important;width:51px!important; line-height:17px!important;overflow:hidden!important;}",".tn-title-login-custom .tn-tab-custom{position:relative!important;float:left!important;border-width:0 1px!important;border-style:solid!important;width:85px!important;height:17px!important;padding:12px 0!important;_padding:14px 0 10px!important;text-align:center!important;font-style:normal!important;text-decoration:none!important; vertical-align:top!important;}",".tn-title-login-custom .tn-tab-custom-login{width:57px!important;_float:left;}",".tn-title-login-custom .tn-tab-custom i{font-style:normal!important;}",".tn-title-login-custom .tn-tab-custom:hover{text-decoration:none!important;}",".tn-title-login-custom .tn-tab-custom .tn-new-custom{display:none;position:absolute!important;right:2px!important;margin-top:-10px!important;height:11px!important;width:13px!important;padding-left:3px!important;font-size:8px!important;overflow:hidden!important;line-height:10px!important;text-align:center!important;-webkit-text-size-adjust:none!important;font-style:normal!important;}",".tn-title-login-custom .tn-tab-custom .tn-arrow-custom{display: inline-block!important;font-size: 12px!important;height: 5px!important;line-height: 13px!important;margin: 0 0 0 5px!important;overflow: hidden!important;transform: none!important;vertical-align: middle!important;width:9px!important;font-style:normal!important;}",".tn-title-login-custom .tn-topmenulist-custom{position:absolute!important;right:0!important;top:41px!important;border-width:1px 1px 0!important;border-style:solid!important;width:85px!important;overflow:hidden!important;}",".tn-title-login-custom .tn-topmenulist-custom .tn-text-list{margin-bottom:-2px!important;margin:0!important;padding:0!important;}",".tn-title-login-custom .tn-topmenulist-custom li{border-bottom-width:1px!important;border-bottom-style:solid!important;line-height:31px!important; list-style:none!important;margin:0!important;padding:0!important;}",".tn-title-login-custom .tn-topmenulist-custom a{display:block!important;padding:0 15px!important;text-decoration:none!important;text-align:left!important;}",".tn-title-login-custom .tn-topmenulist-custom a em{float:right!important;font-style:normal!important;}",".tn-title-login-custom .tn-topmenulist-custom a:hover{text-decoration:none!important;}",".tn-title-login-custom .tn-topmenulist-custom a.tn-user-custom-logout{background:#f2f2f2!important;color:#0a8cd2!important;}",".tn-title-login-custom .tn-topmenulist-custom a.tn-user-custom-logout:hover{text-decoration:underline!important;}","/*可覆盖样式区域*/",".tn-title-login-custom .tn-user-custom{background:#f7f7f7;}",".tn-title-login-custom .tn-tab-custom{border-color:#f7f7f7;color:#ff8601;}",".tn-title-login-custom .tn-tab-custom:hover,",".tn-title-login-custom .tn-tab-custom-onmouse{background:#eaeaea;border-color:#ff8503;color:#ff8601;}",".tn-title-login-custom .tn-tab-custom .tn-new-custom{background:url(http://i.sso.sina.com.cn/images/login/icon_custom.png) no-repeat 0 -30px;color:#fff;text-align:center;-webkit-text-size-adjust: none;}",".tn-title-login-custom .tn-tab-custom .tn-arrow-custom{ background:url(http://i.sso.sina.com.cn/images/login/icon_custom.png) no-repeat scroll 0 0 transparent; }",".tn-title-login-custom .tn-topmenulist-custom{border-color:#ff8601;background:#fff;}",".tn-title-login-custom .tn-topmenulist-custom li{border-bottom-color:#ff8601;}",".tn-title-login-custom .tn-topmenulist-custom a{color:#000;}",".tn-title-login-custom .tn-topmenulist-custom a em{color:#ff8603;}",".tn-title-login-custom .tn-topmenulist-custom a:hover{background:#fff6d9;color:#ff8601;}"];return{get:function(){if(typeof b!=="string"){b=b.join("\n")}return b}}});a.register("comp.userpanel.dropmenu",function(h){var d=h.core.evt.addEvent;var b=h.core.dom.contains;var c=h.core.evt.removeEvent;var g=h.core.dom.addClassName;var f=h.core.dom.removeClassName;var e=h.core.util.listener;return function(o){var p={};var i=4097,n=4098,w=4096;var q,l;var y;var v=false;var z=5;var t=h.parseParam({button:null,menu:null,id:null,onActive:function(){},onCancel:function(){},activeClass:"active"},o);var u=function(D){if(y){clearTimeout(y);y=null}var E=D.fromElement||D.relatedTarget;if(!h.isNode(E)){return}if(b(q,E)||E==t.button){return}l.style.display="";if(!v){t.onActive&&t.onActive();e.fire("clearfloat","clear",[t.id])}g(q,t.activeClass);v=true};var k=function(D){var E=D.toElement||D.relatedTarget;if(!h.isNode(E)){return}if(b(q,E)){return}y=setTimeout(function(){l.style.display="none";t.onCancel&&t.onCancel();if(h.isNode(q)){f(q,t.activeClass)}v=false},z)};var s=function(D){if(y){clearTimeout(y);y=null}var E=D.fromElement||D.relatedTarget;if(!h.isNode(E)){return}if(b(l,E)){return}e.fire("clearfloat","clear",[t.id]);l.style.display="";if(!v){t.onActive&&t.onActive()}g(q,t.activeClass);v=true};var m=function(D){var E=D.toElement||D.relatedTarget;if(!h.isNode(E)){return}if(b(l,E)){return}y=setTimeout(function(){l.style.display="none";t.onCancel&&t.onCancel();f(q,t.activeClass);v=false},z)};var C=function(){c(q,"mouseover",u);c(q,"mouseout",k);c(l,"mouseover",s);c(l,"mouseout",m)};var x=function(){y=setTimeout(function(){l.style.display="none";f(q,t.activeClass);if(v){t.onCancel()}v=false},z)};var j=function(){q=t.button;l=t.menu;if(!q||!l){throw"node is not defined"}};var r=function(){d(q,"mouseover",u);d(q,"mouseout",k);d(l,"mouseover",s);d(l,"mouseout",m)};var B=function(){};var A=function(){j();r();B()};A();p.hide=x;p.destroy=C;return p}});a.register("core.util.winSize",function(b){return function(d){var c,e;var f;if(d){f=d.document}else{f=document}if(f.compatMode==="CSS1Compat"){c=f.documentElement.clientWidth;e=f.documentElement.clientHeight}else{if(self.innerHeight){if(d){f=d.self}else{f=self}c=f.innerWidth;e=f.innerHeight}else{if(f.documentElement&&f.documentElement.clientHeight){c=f.documentElement.clientWidth;e=f.documentElement.clientHeight}else{if(f.body){c=f.body.clientWidth;e=f.body.clientHeight}}}}return{width:c,height:e}}});a.register("kit.extra.merge",function(b){return function(d,c){var f={};for(var e in d){f[e]=d[e]}for(var e in c){f[e]=c[e]}return f}});a.register("kit.io.ajax",function(b){return function(j){var i,g,f,h,k,c,d;c=function(m){k=false;j.onComplete(m,i.args);setTimeout(l,0)};d=function(m){k=false;j.onFail(m,i.args);setTimeout(l,0)};f=[];h=null;k=false;i=b.parseParam({url:"",method:"get",responseType:"json",timeout:30*1000,onTraning:b.funcEmpty,isEncode:true},j);i.onComplete=c;i.onFail=d;var l=function(){if(!f.length){return}if(k===true){return}k=true;i.args=f.shift();h=b.ajax(i)};var e=function(n){while(f.length){f.shift()}k=false;if(h){try{h.abort()}catch(m){}}h=null};g={};g.request=function(m){if(!m){m={}}if(m&&!m.setting_rid&&window.$CONFIG&&$CONFIG.setting_rid){m.setting_rid=$CONFIG.setting_rid}if(j.noQueue){e()}if(!j.uniqueRequest||!h){f.push(m);m._t=0;l()}};g.abort=e;return g}});a.register("kit.io.jsonp",function(b){return function(e){var d,g,c,i,f;d=b.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:30*1000,onComplete:b.funcEmpty,onTraning:b.funcEmpty,onFail:b.funcEmpty,isEncode:true},e);c=[];i={};f=false;var h=function(){if(!c.length){return}if(f===true){return}f=true;i.args=c.shift();i.onComplete=function(j){f=false;d.onComplete(j,i.args);setTimeout(h,0)};i.onFail=function(j){f=false;d.onFail(j);setTimeout(h,0)};b.jsonp(b.kit.extra.merge(d,{args:i.args,onComplete:function(j){i.onComplete(j)},onFail:function(j){try{i.onFail(j)}catch(k){}}}))};g={};g.request=function(j){if(!j){j={}}if(j&&!j.setting_rid&&window.$CONFIG&&$CONFIG.setting_rid){j.setting_rid=$CONFIG.setting_rid}c.push(j);j._t=1;h()};g.abort=function(j){while(c.length){c.shift()}f=false;i=null};return g}});a.register("kit.io.jsonp2",function(b){return function(g){var e=b.core.obj.parseParam({url:"",charset:"UTF-8",timeout:30*1000,args:{},onComplete:null,onTimeout:null,responseName:null,isEncode:false,varkey:"varname"},g);var h=-1;var f=e.responseName||("STK_"+b.core.util.getUniqueKey());e.args[e.varkey]=f;var c=e.onComplete;var d=e.onTimeout;e.onTimeout=function(){if(h!=1&&d!=null){h=2;d()}};e.onComplete=function(){if(h!=2&&c!=null){h=1;c(window[f]);window[f]=undefined}};return b.core.io.scriptLoader(e)}});a.register("kit.io.inter",function(b){return function(){var c,e,d;c={};e={};d={};c.register=function(g,f){if(e[g]!==undefined){throw g+" interface has been registered"}e[g]=f;d[g]={}};c.hookComplete=function(f,h){var g=b.core.util.getUniqueKey();d[f][g]=h;return g};c.removeHook=function(f,g){if(d[f]&&d[f][g]){delete d[f][g]}};c.getTrans=function(h,f){var g=b.kit.extra.merge(e[h],f);g.onComplete=function(j,m){try{f.onComplete(j,m)}catch(l){}if(j.code==="100000"){try{f.onSuccess(j,m)}catch(l){}}else{try{f.onError(j,m)}catch(l){}}for(var i in d[h]){try{d[h][i](j,m)}catch(l){}}};if(e[h]["requestMode"]==="jsonp"){return b.kit.io.jsonp(g)}else{if(e[h]["requestMode"]==="ijax"){return b.kit.io.ijax(g)}else{return b.kit.io.ajax(g)}}};c.request=function(i,f,h){var g=b.core.json.merge(e[i],f);if(h&&!h.setting_rid&&window.$CONFIG&&$CONFIG.setting_rid){h.setting_rid=$CONFIG.setting_rid}g.onComplete=function(l,n){try{f.onComplete(l,n)}catch(m){}if(l.code==="100000"){try{f.onSuccess(l,n)}catch(m){}}else{try{f.onError(l,n)}catch(m){}}for(var j in d[i]){try{d[i][j](l,n)}catch(m){}}};g=b.core.obj.cut(g,["noqueue"]);g.args=h;if(e[i]["requestMode"]==="jsonp"){return b.jsonp(g)}else{if(e[i]["requestMode"]==="jsonp2"){return b.kit.io.jsonp2(g)}else{if(e[i]["requestMode"]==="ijax"){return b.ijax(g)}else{return b.ajax(g)}}}};return c}});a.register("core.obj.cut",function(b){return function(f,e){var d={};if(!b.core.arr.isArray(e)){throw"core.obj.cut need array as second parameter"}for(var c in f){if(!b.core.arr.inArray(c,e)){d[c]=f[c]}}return d}});a.register("common.trans.userPanel",function(d){var b=d.kit.io.inter();var c=b.register;c("commentInfo",{url:"http://comment5.news.sina.com.cn/user/message?action=read&version=2&type=reply",requestMode:"jsonp"});c("emailInfo",{url:"http://service.mail.sina.com.cn/mailproxy/mailnotice.php",requestMode:"jsonp"});c("weiboInfo",{url:"http://api.weibo.com/2/users/show_brief.json",requestMode:"jsonp"});return b});a.register("core.dom.insertBefore",function(b){return function(d,e){var c=e.parentNode;c.insertBefore(d,e)}});a.register("comp.userpanel.emailmenu",function(g){var e=g.common.trans.userPanel;var f=g.core.io.jsonp;var d;var b=g.core.dom.sizzle;var c=g.core.dom.insertBefore;return function(n){var o={};var u=[true];var D,l,q,F;var k=["http://mail.sina.com.cn/","http://vip.sina.com.cn","http://mail.sina.net"];var B=false;var x=function(K,J){if(K.tagName.toLowerCase()=="body"){return null}if(K.tagName.toLowerCase()==J.toLowerCase()){return K}else{return x(K.parentNode,J)}};var s=g.parseParam({tab:null,content:null,index:null,userInfo:null,allReadCallback:function(K,J){}},n);var y,H,w,i,j;var G=true,r=true;var v={data:0};var m=function(J){var K=J.data.cursor;window.open(k[K])};var I=function(J){G=J;if(G){w.style.visibility="hidden";s.allReadCallback(G,s.index)}};var z=function(L){var M=parseInt(L.data.cursor,10);window.open(k[M]);if(u[M]){return}u[M]=true;var J=true;for(var K=0;K<u.length;K++){J=J&&u[K]}I(J)};var C=function(J){if(!r){J&&J(false);return}e.request("emailInfo",{onComplete:function(L){var N=L.data;var K=N;var M=L.type;A(M);if(M==0){i=D;j=l}else{if(M==1){i=q;j=F}}i.innerHTML="查看邮件";j.innerHTML=L.data+"封新邮件";if(L.result&&t(L)){if(L.data>0){w.style.visibility="visible";G=false;s.allReadCallback(G,s.index)}else{w.style.visibility="hidden";G=true;s.allReadCallback(G,s.index)}}else{if(!L.result){r=false}}},onFail:function(){}},{action:"email"})};var t=function(K){var J=false;if(!v){v={};v.data=K.data;J=true}else{if(v.data==K.data){J=false}else{u[0]=false;J=true}v.data=K.data}return J};var A=function(L){if(B){return}B=true;var J=b("li",s.content);if(L==1&&J.length>2){c(J[1],J[0]);var M=k[0];k[0]=k[1];k[1]=M}J=b("li",s.content);for(var K=0;K<J.length;K++){J[K].setAttribute("action-data","cursor="+K)}};var h=function(){y=g.kit.dom.parseDOM(g.core.dom.builder(s.content).list);H=y.mail_num;D=y.free_mail_entrance;l=y.free_email_remind;q=y.vip_email_entrance;F=y.vip_email_remind;y=g.kit.dom.parseDOM(g.core.dom.builder(s.tab).list);w=y.new_info_icon};var p=function(){d=g.core.evt.delegatedEvent(s.content);d.add("fun_btn","click",z);d.add("url_btn","click",m)};var E=function(){h();p()};E();o.setRead=I;o.onGetInfo=C;return o}});a.register("comp.userpanel.weibomenu",function(f){var d=f.common.trans.userPanel;var e=f.core.io.jsonp;var c;var b='<div class="needlogin">还未开通微博<a target"_blank" href="http://weibo.com/signup/signup.php"  class="list-link">立刻开通</a></div>';return function(j){var k={};var o=[true,true,true];var m=f.parseParam({tab:null,content:null,index:null,userInfo:null,allReadCallback:function(A){}},j);var h=["http://weibo.com/at/weibo","http://weibo.com/comment/inbox","http://weibo.com/messages"];var q={mention_status:0,dm:0,cmt:0};var s,y,r;var w,y,i;var x=true,n=true;var u=function(A){if(!n){return}d.request("weiboInfo",{onComplete:function(C){var F=C.data;if(C.code==0&&(F.error_code==20003||F.error_code==10013)){m.content.innerHTML=b;n=false}if(C.code==1){var B=F.dm;var D=F.cmt;var E=F.mention_status;i.innerHTML=B;y.innerHTML=D;w.innerHTML=E;if(p(F)){if(E+D+B>0){r.style.visibility="visible";x=false;m.allReadCallback(x,m.index)}else{x=true;z(x)}}}},onFail:function(){throw"error of getting weiboinfo"}},{source:"2835469272"})};var p=function(C){var A=false;if(!q){A=true;q={};q.mention_status=C.mention_status;q.dm=C.dm;q.cmt=C.cmt}else{if(q.mention_status!=C.mention_status&&C.mention_status!=0){o[0]=false}if((q.cmt!=C.cmt)&&C.cmt!=0){o[1]=false}if((q.dm!=C.dm)&&C.dm!=0){o[2]=false}A=true;for(var B=0;B<o.length;B++){A=A&&o[B]}A=!A;q.mention_status=C.mention_status;q.dm=C.dm;q.cmt=C.cmt}return A};var t=function(C){var D=parseInt(C.data.cursor,10);window.open(h[D]);if(o[D]){return}o[D]=true;var A=true;for(var B=0;B<o.length;B++){A=A&&o[B]}z(A)};var g=function(){s=f.kit.dom.parseDOM(f.core.dom.builder(m.content).list);y=s.comment_num;w=s.at_num;i=s.message_num;s=f.kit.dom.parseDOM(f.core.dom.builder(m.tab).list);r=s.new_info_icon};var l=function(){c=f.core.evt.delegatedEvent(m.content);c.add("fun_btn","click",t)};var v=function(){g();l()};var z=function(A){x=A;if(x){r.style.visibility="hidden";m.allReadCallback(x,m.index)}};v();k.setRead=z;k.onGetInfo=u;return k}});a.register("comp.userpanel.commentmenu",function(e){var c=e.common.trans.userPanel;var d=e.core.io.jsonp;var b;return function(t){var n={};var s=[true];var u=["http://my.sina.com.cn/#location=cmnt"];var o=e.parseParam({tab:null,index:null,content:null,userInfo:null,allReadCallback:function(w){},newComment:function(){}},t);var h,k,l;var q=false;var f={reply:0};var j=function(w){c.request("commentInfo",{onComplete:function(y){var z=y.result.data;var x=z.reply;if(y.result.status.code==0&&m(z)){k.innerHTML=x;o.newComment&&o.newComment(x);if(z.reply>0){l.style.visibility="visible";q=false;o.allReadCallback(false,o.index)}else{l.style.visibility="hidden";q=true;o.allReadCallback(true,o.index)}}},onFail:function(){throw"error of getting comment info"}},{})};var m=function(x){var w=false;if(f.reply==x.reply){w=false}else{s[0]=false;w=true}f.reply=x.reply;return w};var p=function(w){q=w;if(q){l.style.visibility="hidden";o.allReadCallback(true,o.index)}};var i=function(y){var z=parseInt(y.data.cursor,10);window.open(u[z]);if(s[z]){return}s[z]=true;var w=true;for(var x=0;x<s.length;x++){w=w&&s[x]}p(w)};var g=function(){h=e.kit.dom.parseDOM(e.core.dom.builder(o.content).list);k=h.comment_num;h=e.kit.dom.parseDOM(e.core.dom.builder(o.tab).list);l=h.new_info_icon};var r=function(){b=e.core.evt.delegatedEvent(o.content);b.add("fun_btn","click",i)};var v=function(){g();r()};v();n.setRead=p;n.onGetInfo=j;return n}});a.register("comp.userpanel.notificationmenu",function(g){var c;var f=g.core.dom.addClassName;var e=g.core.dom.removeClassName;var b=g.core.dom.sizzle;var d=g.core.util.listener;return function(s){var t={};var h=4097,r=4098,z=4096;var G,D;var K,M;var j;var A=200,p;var k,q=60000;var E;var B=[];var O={};var o=0;var w=g.parseParam({button:null,menu:null,loginStatus:null,userInfo:null,newComment:function(){}},s);var C=function(){};var x=function(){};var v=function(){for(var P=0;P<B.length;P++){B[P].onGetInfo()}k=setInterval(function(){for(var Q=0;Q<B.length;Q++){B[Q].onGetInfo()}},q)};var H=function(){if(k){clearInterval(k);k=null}};var n=function(){E=g.comp.userpanel.dropmenu({button:w.button,menu:w.menu,onActive:C,id:2,onCancel:x});B.push(g.comp.userpanel.weibomenu({tab:M[0],content:K[0],index:0,allReadCallback:m}));B.push(g.comp.userpanel.commentmenu({tab:M[1],content:K[1],userInfo:w.userInfo,index:1,allReadCallback:m,newComment:function(P){w.newComment&&w.newComment(P)}}));B.push(g.comp.userpanel.emailmenu({tab:M[2],content:K[2],index:2,allReadCallback:m}))};var m=function(S,Q){O[Q]=S;var P=true;for(var R in O){P=P&&O[R]}if(!P){D.style.visibility="visible"}else{D.style.visibility="hidden"}};var F=function(P){p=setTimeout(function(){var U=P.el;var S=P.data;var T=parseInt(S.cursor,10);var Q;for(var R=0;R<M.length;R++){Q=b("a",M[R])[0];e(Q,"cur");K[R].style.display="none"}Q=b("a",M[T])[0];f(Q,"cur");K[T].style.display=""},A)};var J=function(P){if(p){clearTimeout(p)}};var l=function(P){d.fire("loginBtn","click")};var i=function(){if(!w.button||!w.menu){throw" node is not defined"}G=w.menu;var P=g.kit.dom.parseDOM(g.core.dom.builder(w.button).list);D=P.new_info_icon;K=g.core.dom.sizzle(".msg-wrap",G);M=g.core.dom.sizzle("li[action-type=tab_btn]",G);j=w.loginStatus};var u=function(){c=g.core.evt.delegatedEvent(G);c.add("tab_btn","mouseover",F);c.add("tab_btn","mouseout",J);c.add("login_btn","click",l)};var L=function(){n();if(w.loginStatus!=z){v()}};var I=function(){i();u();L()};I();var y=function(){E.hide()};var N=function(){if(B){for(var P=0;P<B.length;P++){B[P].setRead(true)}}D.style.visibility="hidden";c.remove("tab_btn","mouseover",F);c.remove("login_btn","click",l);H();E.destroy()};t.hide=y;t.destroy=N;return t}});a.register("comp.userpanel.template",function(d){var c={};var f='<#et temp data><div class="msg-dropdown" node-type="outer" style="display:none;"><ul class="msg-tab"><li action-type="tab_btn" action-data="cursor=0"><a   href="#0"><span>微博</span><i class="ac-icon ac-icon-message" node-type="new_info_icon" style="visibility:hidden;"></i></a></li><li action-type="tab_btn" action-data="cursor=1"><a   href="#0"><span>评论</span><i class="ac-icon ac-icon-message" node-type="new_info_icon" style="visibility:hidden;"></i></a></li><li action-type="tab_btn" action-data="cursor=2"><a class="cur"  href="#0"><span>邮箱</span><i class="ac-icon ac-icon-message" node-type="new_info_icon" style="visibility:hidden;"></i></a></li></ul><#if (data.status == 0x1000)><div class="msg-wrap"><div class="needlogin">登录后查看新消息<a class="list-link" action-type="login_btn"  suda-uatrack="key=index_top&value=imme_signin_weibo"  href="#0">立即登录</a></div></div><div class="msg-wrap"><div class="needlogin">登录后查看新消息<a class="list-link" action-type="login_btn"  suda-uatrack="key=index_top&value=imme_signin_comment"  href="#0">立即登录</a></div></div><div class="msg-wrap"><div class="needlogin">登录后查看新消息<a class="list-link" action-type="login_btn"  suda-uatrack="key=index_top&value=imme_signin_mail"  href="#0">立即登录</a></div></div><#else><div class="msg-wrap"><ul class="msg-lst"><#if (data.status == 0x1001)><li suda-uatrack="key=index_top&value=weibo_at" action-type="fun_btn" action-data="cursor=0" ><#else><li  action-type="login_btn" ></#if><#if (data.status == 0x1001)><a class="list-link"    href="#0">查看@我</a><i class="ac-icon ac-icon-at"></i><span node-type="at_num">0</span>条新@我的微博<#else><a class="list-link"   href="#0" >查看@我</a><i class="ac-icon ac-icon-at"></i><span node-type="at_num">0</span>条新@我的微博</#if></li><#if (data.status == 0x1001)><li suda-uatrack="key=index_top&value=weibo_comment" action-type="fun_btn" action-data="cursor=1" ><#else><li   action-type="login_btn" ></#if><#if (data.status == 0x1001)><a class="list-link"    href="#0">查看评论</a><i class="ac-icon ac-icon-dot"></i><span node-type="comment_num">0</span>条新评论<#else><a class="list-link"     href="#0" >查看评论</a><i class="ac-icon ac-icon-dot"></i><span node-type="comment_num">0</span>条新评论</#if></li><#if (data.status == 0x1001)><li suda-uatrack="key=index_top&value=weibo_message" action-type="fun_btn" action-data="cursor=2" ><#else><li  action-type="login_btn" ></#if><#if (data.status == 0x1001)><a class="list-link"    href="#0">查看私信</a><i class="ac-icon ac-icon-bbs"></i><span node-type="message_num">0</span>条新私信<#else><a class="list-link"    href="#0" >查看私信</a><i class="ac-icon ac-icon-bbs"></i><span node-type="message_num">0</span>条新私信</#if></li></ul></div><div class="msg-wrap"><ul class="msg-lst"><#if (data.status == 0x1001)><li suda-uatrack="key=index_top&value=comment_forward" action-type="fun_btn" action-data="cursor=0" ><#else><li  action-type="login_btn"  ></#if><#if (data.status == 0x1001)><a class="list-link" href="#0">查看回复</a><i class="ac-icon ac-icon-dot"></i><span node-type="comment_num">0</span>条新评论回复<#else><a class="list-link"  href="#0" >查看回复</a><i class="ac-icon ac-icon-dot"></i><span node-type="comment_num">0</span>条新评论回复</#if></li></ul></div><div class="msg-wrap"><ul class="msg-lst"><#if (data.status == 0x1001)><li suda-uatrack="key=index_top&value=mail_free" action-type="fun_btn" action-data="cursor=0" ><#else><li  action-type="login_btn" ></#if><#if (data.status == 0x1001)><a class="list-link"  node-type="free_mail_entrance"  href="#0">进入邮箱</a><i class="ac-icon ac-icon-mail"></i><span node-type="free_email_remind">免费邮箱</span><#else><a class="list-link"  node-type="free_mail_entrance"  href="#0" >进入邮箱</a><i class="ac-icon ac-icon-mail"></i><span node-type="free_email_remind">免费邮箱</span></#if></li><#if (data.status == 0x1001)><li suda-uatrack="key=index_top&value=mail_vip" action-type="fun_btn" action-data="cursor=1" ><#else><li  action-type="login_btn"  ></#if><#if (data.status == 0x1001)><a class="list-link" node-type="vip_email_entrance"  href="#0">进入邮箱</a><i class="ac-icon ac-icon-mvip"></i><span node-type="vip_email_remind">VIP邮箱</span><#else><a class="list-link" node-type="vip_email_entrance"  href="#0" >进入邮箱</a><i class="ac-icon ac-icon-mvip"></i><span node-type="vip_email_remind">VIP邮箱</span></#if></li><#if (data.status == 0x1001)><li suda-uatrack="key=index_top&value=mail_enterp" action-type="fun_btn" action-data="cursor=2" ><#else><li  action-type="login_btn" ></#if><#if (data.status == 0x1001)><a class="list-link"   href="#0">进入邮箱</a><i class="ac-icon ac-icon-ment"></i>企业邮箱<#else><a class="list-link"    href="#0" >进入邮箱</a><i class="ac-icon ac-icon-ment"></i>企业邮箱</#if></li></ul></div></#if></div></#et>';var b='<i  node-type="new_info_icon" class="ac-icon ac-icon-message"></i>';var g='<#et temp data><#if (data.status != 0x1000 )><div class="ac-login-cnt" node-type="outer"><#if (data.status != 0x1001)><a class="thumb" action-type="login_btn"><img src="${data.url}"></a><#elseif (data.isWeibo)><a class="thumb" href="http://weibo.com/" suda-uatrack="key=index_top&value=head_click" target="_blank"><img src="${data.url}"></a><#else><a class="thumb" href="http://login.sina.com.cn/" suda-uatrack="key=index_top&value=head_click" target="_blank"><img src="${data.url}"></a></#if><span style="display:none" class="log-links"><a    href="#0">登录</a><em class="ac-icon ac-icon-slash"></em><a   target="_blank"   href="https://login.sina.com.cn/signup/signup?entry=homepage">注册</a></span><i class="ac-icon ac-icon-aru"></i></div><#else><div class="ac-login-cnt" node-type="outer"><a class="ac-login-cnt" node-type="login_btn" href="#0"><span class="thumb"><img src="${data.url}"></span><span class="log-links">登录</span></a></div></#if></#et>';var e='<#et temp data><ul class="ac-dropdown" style="display:none;" node-type="outer"><li><#if (data.status != 0x1001)><a  action-type="login_btn" title="${data.userInfo.screen_name}" href="#0">${data.userInfo.screen_name}</a><#elseif (data.isWeibo)><a suda-uatrack="key=index_top&value=name_click"  target="_blank"  title="${data.userInfo.screen_name}" href="http://weibo.com/">${data.userInfo.screen_name}</a><#else><a suda-uatrack="key=index_top&value=name_click"  target="_blank"  title="${data.userInfo.screen_name}" href="http://login.sina.com.cn/">${data.userInfo.screen_name}</a></#if></li><#list data.links as link><li><a target="_blank" href="${link.url}">${link.title}</a></li></#list><li><#if (data.status == 0x1001)><a   target="_blank"  suda-uatrack="key=index_top&value=my_collect" href="http://my.sina.com.cn/#location=fav">我的收藏</a><#else><a  action-type="login_btn"  href="#0">我的收藏</a></#if></li><li><#if (data.status == 0x1001)><a target="_blank"  suda-uatrack="key=index_top&value=my_comment" target="_blank"   href="http://my.sina.com.cn/#location=cmnt">我的评论</a><#else><a  action-type="login_btn"    href="#0">我的评论</a></#if></li><li><a   target="_blank" suda-uatrack="key=index_top&value=logout"  href="#0" action-type="logout_btn">退出</a></li></ul></#et>';c.dropMenuTemplate=f;c.portraitTemplate=g;c.accountMenuTemplate=e;return c});a.register("comp.userpanel.loginLayer",function(d){var e=d.core.func.empty;var c=d.core.util.storage;var b=d.core.util.listener;return function(j){var k={},t;var z;var l=null;var m=d.parseParam({node:null,layer_hide:e,login_success:e,login_failure:e,logout_success:e,layer_ready:e,extra:{css:null},pre_login_state:e},j);var r=false;var n=function(H,E){var E=E||false;var D=z.nodes.box;var G=H.l;var F=H.t;css=d.core.dom.cssText(D.style.cssText);css.push("top",F+"px");css.push("left",G+"px");D.style.cssText=css.getCss()};var q=function(F){var F=F||false;l=document.body;if(!F){g(l);var E=d.core.util.winSize();var I=d.core.util.scrollPos();var D=d.core.dom.getSize(v().nodes.box);var H={l:(E.width-D.width)/2,t:I.top+(E.height-D.height)/2};n(H)}else{var G={position:"center",parentNode:null,relatedNode:null};G=d.parseParam(G,{parentNode:l,position:"center",useIframeInIE6:true});z.toggleType="normal";z.set("plugin",G)}};var i=function(D,I,L,O){var O=O||m.node;var H=d.core.dom.position(O);var L=L||"below";var J=d.core.dom.getSize(z.nodes.box);var F=d.core.dom.getSize(I);var M=d.core.dom.getSize(D);var N=d.core.dom.position(D);var K,E;var G;if(L=="below"){K=M.height+(N.t-H.t);E=-1*Math.abs(F.width-M.width)+(N.l-H.l)}else{if(L=="right"){K=(N.t-H.t);E=(N.l-H.l)+M.width}else{if(L=="left"){K=(N.t-H.t);E=(N.l-H.l)-J.width}else{if(L=="above"){K=(N.t-H.t)-J.height;E=(N.l-H.l)}}}}G=d.core.dom.cssText(I.style.cssText);G.push("top",K+"px");G.push("left",E+"px");I.style.cssText=G.getCss()};var u=function(){if(z.isLogin()){return false}else{var E=document.activeElement;var F=z.nodes.loginname.value,D=z.nodes.password.value;return !(F||D||d.contains(z.nodes.box,E))}};var A=function(){z=window.SINA_OUTLOGIN_LAYER;t.style.position="relative";l=t;z=z.set("plugin",{position:"custom"});z.set("extra",{css:m.extra.css});z.set("plugin",{parentNode:t});z.set("styles",{zIndex:999});z.register("layer_hide",function(){if(r){m.layer_hide()}r=false});z.register("login_success",function(){z.getPreLoginWeiboData({onComplete:function(D){if(D.code==0){m.login_success(null)}if(D.code==1){m.login_success(D.data)}else{throw"error of getting weiboinfo"}},onSuccess:function(D){},onFailure:function(D){throw"error of getting weiboinfo"}})});z.register("login_failure",function(){m.login_failure()});z.register("logout_success",function(){m.logout_success()});z.register("pre_login_state",function(){z.getPreLoginWeiboData({onComplete:function(D){if(D.code==1){m.pre_login_state(D.data)}else{throw"error of getting weiboinfo"}},onFailure:function(D){throw"error of getting weiboinfo"}})});z.register("layer_ready",function(){i(t,z.nodes.box);m.layer_ready()})};var v=function(){return z};var B=function(){};var g=function(E,D){if(!d.isNode(E)){throw"param elm is invalid"}var D=D||"custom";l=E;z.set("plugin",{parentNode:E,position:D})};var C=function(){if(z.nodes.box.parentNode==l){if(r){return}r=true;b.fire("clearfloat","clear",[3]);z.show()}else{r=true;z.show()}};var s=function(){return z.isLogin()};var h=function(){return z.isPreLoginState};var p=function(){return z.nodes.box};var y=function(){return z.logout()};var x=function(){return z.getSinaCookie()};var o=function(){if(u()){r=false;z.hide()}};var f=function(){if(!m.node){throw"node is not defined"}t=m.node};var w=function(){f();A()};w();k.setLayerAbsolutePosition=n;k.getOutLoginLayer=v;k.getOuter=p;k.show=C;k.logout=y;k.getSinaCookie=x;k.isLogin=s;k.destroy=B;k.isPreLoginState=h;k.hide=o;k.setCenter=q;k.setParent=g;k.setLayerPosition=i;return k}});a.register("comp.userpanel.hover",function(f){var d=f.core.evt.addEvent;var b=f.core.dom.contains;var c=f.core.evt.removeEvent;var e=[];return function(m){var o={};var u=100,g,v,t;var k=false;var j;var r=f.parseParam({button:null,content:null,delay:u,type:"1",showCallback:function(){},hideCallback:function(){}},m);var l=function(z){if(k){return}var B=z.target||z.srcElement;for(var A=0;A<e.length;A++){clearTimeout(e[A])}e=[];r.showCallback&&r.showCallback(z)};var x=function(z){if(k){return}var A=z.toElement||z.relatedTarget;if(!f.isNode(A)){return}if(!(A==g||b(g,A))){t=setTimeout(function(){r.hideCallback&&r.hideCallback(z)},u);e.push(t)}};var q=function(z){if(k||j==2){return}for(var A=0;A<e.length;A++){clearTimeout(e[A])}e=[];r.showCallback&&r.showCallback(z)};var s=function(z){j=z};var n=function(z){k=z};var i=function(z){if(k||j==2){return}var A=z.toElement||z.relatedTarget;if(!f.isNode(A)){return}if(!(A==v||b(v,A))){t=setTimeout(function(){r.hideCallback&&r.hideCallback(z)},u);e.push(t)}};var y=function(){c(g,"mouseover",l);c(g,"mouseout",x);c(v,"mouseover",q);c(v,"mouseout",i)};var h=function(){if(!f.isNode(r.button)||!f.isNode(r.content)){throw"arguments are invalid"}g=r.button;v=r.content};var p=function(){d(g,"mouseover",l);d(g,"mouseout",x);d(v,"mouseover",q);d(v,"mouseout",i)};var w=function(){h();p();j=r.type};w();o.setType=s;o.setDisabled=n;o.destroy=y;return o}});a.register("comp.userPanelNewVersion",function(O){var F;var i=O.core.evt.addEvent;var n=O.core.util.language;var c=O.kit.dom.appendStyle;var q=O.kit.dom.builder;var N=O.kit.dom.loadStyle;var ab=O.kit.util.makeReady;var k=O.core.util.listener;var L=O.comp.defaultStyle;var D=O.common.channel.plugin;var F=O.core.evt.delegatedEvent;var s=O.core.dom.sizzle;var e=O.comp.userpanel.template;var ah=O.core.dom.addClassName;var am=O.core.dom.contains;var X=O.core.dom.removeClassName;var W,M,g;var Q,H,aj,P;var al,ac;var U={};var R=false,h=false;var w="http://i.sso.sina.com.cn/images/login/pre_loading.gif";var o=[];var B;var r=4097,E=4098,ae=4096;var S,f;var G={outloginlayer:{ready:function(){},loginBtns:null},container:{node:null},extra:{css:null,outlogin:"http://i.sso.sina.com.cn/js/outlogin_layer.js",anotherButton:null},plugin:{portrait:true,links:[]}};var aa={plugin_ready:null,outlogin_ready:null,weibolist_show:null,weibolist_hide:null,new_comment:null};var A=function(aq,ao){var an=false;aq=aq.toLowerCase();for(var ap in G){if(ap==aq){an=true;break}}if(!an){throw"arguments are invalid"}ao=ao||{};var ar=G[aq];G[aq]=O.parseParam(ar,ao);return U};var Y=function(){var an=ab({condition:function(){return false},ready:function(ao){K();if(S!=ae){ad()}V()}});an.exec(function(){})};var K=function(){var ar=(f.weiboInfo)?f.weiboInfo.profile_image_url:w;var ap=(S!=ae)?ar:"http://i.sso.sina.com.cn/images/login/thumb_default.png";if(!G.plugin.portrait){ap="http://i.sso.sina.com.cn/images/login/avatar_icon.jpg"}var an=s(".ac-rgst",M)[0];var au={url:ap,status:S,isWeibo:(f.weiboInfo!=null)};var ao=O.core.util.easyTemplate(e.portraitTemplate,au).toString();var at=O.kit.dom.parseDOM(O.core.dom.builder(ao).list);var aq=at.outer;P.innerHTML="";P.appendChild(aq);Q=at.login_btn;if(S!=ae){ah(P,"ac-logined");an.style.display="none"}else{X(P,"ac-logined");an.style.display=""}z();m()};var ad=function(){var an;if(f.weiboInfo){an=f.weiboInfo;an.uid=an.id}else{an=f.sinaInfo;an.screen_name=an.nick}var au={status:S,userInfo:an,isWeibo:(f.weiboInfo!=null),links:G.plugin.links};var ao=O.core.util.easyTemplate(e.accountMenuTemplate,au).toString();var at=O.kit.dom.parseDOM(O.core.dom.builder(ao).list);var aq=at.outer;var ar=s(".ac-icon",P)[1];var ap=s(".ac-login-cnt",P)[0];P.appendChild(aq);al=O.comp.userpanel.dropmenu({button:ap,menu:aq,id:1,onActive:function(){ah(ar,"ac-icon-ard");X(ar,"ac-icon-aru");aa.weibolist_show&&aa.weibolist_show()},onCancel:function(){X(ar,"ac-icon-ard");ah(ar,"ac-icon-aru");aa.weibolist_hide&&aa.weibolist_hide()}});F=O.core.evt.delegatedEvent(aq);F.add("logout_btn","click",u)};var V=function(){var ao;if(S!=ae){if(f.weiboInfo){ao=f.weiboInfo;ao.uid=ao.id}else{ao=f.sinaInfo;ao.screen_name=ao.nick}}var aw=s(".msg-dropdown",M)[0];if(aw){aw.parentNode.removeChild(aw)}if(ac){ac.destroy()}var aq={status:S,userInfo:ao};var ap=O.core.util.easyTemplate(e.dropMenuTemplate,aq).toString();var ar=O.kit.dom.parseDOM(O.core.dom.builder(ap).list);aw=ar.outer;M.appendChild(aw);var at=s(".msg-tab",aw)[0];var an=s(".msg-wrap",aw);var av=s("li",at);for(var au=0;au<an.length;au++){an[au].style.display="none"}an[an.length-1].style.display="";ac=O.comp.userpanel.notificationmenu({button:aj,menu:aw,loginStatus:S,userInfo:f,newComment:function(ax){aa.new_comment&&aa.new_comment(ax)}})};var p=function(ao){var an=ab({condition:function(){return R},ready:function(ap){c(L.get());var aq=O.C("div");aq.setAttribute("class","css_check");aq.style.position="absolute";M.appendChild(aq);if(G.extra.css){N(G.extra.css,{timeout:10*1000,styleCheck:function(){if(O.isNode(aq)){var ar=O.getStyle(aq,"width");if(ar==="120px"){return true}}},onLoad:function(){R=true;ap&&ap()},onTimeout:function(){an.reset();throw"css file load error,please confirm the url of your css file"}})}else{R=true;ap&&ap()}}});an.exec(aa.plugin_ready)};var I=function(an){var ao=ab({condition:function(){return !!window.SINA_OUTLOGIN_LAYER},ready:function(ap){O.scriptLoader({timeout:10*1000,url:G.extra.outlogin,onComplete:ap,onTimeout:function(){ao.reset()}})}});ao.exec(an)};var v=function(){B=O.comp.userpanel.loginLayer({node:M,extra:G.extra,layer_ready:function(){p();h=true;aa.outlogin_ready&&aa.outlogin_ready()},login_success:function(an){if(!f){f={}}ah(M,"TAP14-logined");f.weiboInfo=an;d(r);Y()},login_failure:function(){X(M,"TAP14-logined");d(ae);Y()},logout_success:function(){X(M,"TAP14-logined");S=ae;Y()},pre_login_state:function(an){if(!f){f={}}ah(M,"TAP14-logined");f.weiboInfo=an;d(E);Y()},layer_hide:function(){if(Q){X(Q,"active")}}});if(G.outloginlayer.ready){G.outloginlayer.ready()}};var m=function(){if(Q){o.push(O.comp.userpanel.hover({button:Q,type:1,content:B.getOuter(),hideCallback:function(){if(Q){X(Q,"active")}B.hide()},showCallback:function(an){var ap=an.target||an.srcElement;if(ap==Q||am(Q,ap)){ah(Q,"active");for(var ao=0;ao<o.length;ao++){if(o[ao]){o[ao].setType(1)}}B.setParent(M);setTimeout(function(){B.setLayerPosition(M,B.getOuter(),"below");k.fire("clearfloat","clear");B.show()},5)}}}))}if(g){o.push(O.comp.userpanel.hover({button:g,content:B.getOuter(),hideCallback:B.hide,showCallback:function(an){var ap=an.target||an.srcElement;if(S!=r&&ap==g){for(var ao=0;ao<o.length;ao++){if(o[ao]){o[ao].setType(1)}}B.setParent(g);setTimeout(function(){B.setLayerPosition(g,B.getOuter(),"right",g);B.show()},5)}}}))}};var ai=function(ao){l(3);for(var an=0;an<o.length;an++){if(o[an]){o[an].setType(1)}}B.setParent(M);B.setLayerPosition(M,B.getOuter());B.show()};var u=function(){B.logout();af()};var d=function(an){if(!f){f={}}S=an;if(S!=ae){f.sinaInfo=B.getSinaCookie()}};var l=function(an){if(!an){return}if(ac&&an!=2){ac.hide()}if(al&&an!=1){al.hide()}if(B&&an!=3){B.hide();X(Q,"active")}};var j=function(ap,aq){var an=false;for(var ao in aa){if(ao==ap){an=true;break}}an=(O.getType(aq)==="function")&&an;if(!an){throw"arguments are invalid"}aa[ap]=aq;return U};var C=function(ap){var an=false;for(var ao in aa){if(ao==ap){an=true;break}}if(an){aa[ap]=null}};var h=function(){return h};var ag=function(ap,ao){var ao=ao||document.body;if(!O.isNode(ao)){throw"param parent is invalid"}for(var an=0;an<o.length;an++){if(o[an]){o[an].setType(2)}}B.setParent(ao);B.setLayerAbsolutePosition(ap,fixed)};var J=function(ap){var ap=ap||false;var ao=document.body;if(!O.isNode(ao)){throw"param parent is invalid"}for(var an=0;an<o.length;an++){if(o[an]){o[an].setType(2)}}B.setCenter(ap)};var y=function(){return B.getOutLoginLayer()};var t=function(){M=G.container.node;if(!M){throw"node is not defined"}if(G.extra.anotherButton&&!O.isNode(G.extra.anotherButton)){throw"param 'another button' is invalid"}else{g=G.extra.anotherButton}W=O.kit.dom.parseDOM(q(M).list);H=W.register_btn;aj=W.notification_btn;Q=W.login_btn;P=s(".ac-login",M)[0]};var z=function(){F=O.core.evt.delegatedEvent(M);F.add("login_btn","click",ai);i(Q,"click",ai);var an=k.list();if(!("loginBtn" in an)){k.register("loginBtn","click",ai)}if(!("logout" in an)){k.register("logout","logout",u)}if(!("clearfloat" in an)){k.register("clearfloat","clear",l)}};var x=function(){I(function(){v()})};var ak=function(){t();z();x()};var T=function(an,ap){if(S!=r){for(var ao=0;ao<o.length;ao++){if(o[ao]){o[ao].setType(1)}}B.setParent(M);B.setLayerPosition(M,B.getOuter());B.show();ap&&ap()}};var b=function(){return f};var Z=function(){o.push(O.comp.userpanel.hover({button:Q,type:1,content:B.getOuter(),hideCallback:B.hide,showCallback:function(an){var ap=an.target||an.srcElement;if(ap==Q){for(var ao=0;ao<o.length;ao++){if(o[ao]){o[ao].setType(1)}}B.setParent(M);B.setLayerPosition(M,B.getOuter(),"below");B.show()}}}))};var af=function(){var aq=s("[node-type=outer]",M);for(var an=0;an<aq.length;an++){var ap=aq[an].parentNode;ap.removeChild(aq[an])}if(ac){ac.destroy()}if(al){al.destroy()}B.destroy();var ao=k.list();for(var an=o.length-1;an>=0;an--){if(o[an]){o[an].destroy()}o[an]=null}};U.set=A;U.init=ak;U.remove=C;U.getOutLogin=y;U.register=j;U.hasBeenInitialed=h;U.show=T;U.getUserInfo=b;U.setOutLoginMiddle=J;U.setOutLoginLayerPosition=ag;return U});(function(c){var b=a.comp.userPanelNewVersion;b.listener=c.common.channel.plugin;b.getVersion=function(){return"1.0.2"};b.STK=a;this.SINA_USER_PANEL=b}).call(this,a)}).call(this);