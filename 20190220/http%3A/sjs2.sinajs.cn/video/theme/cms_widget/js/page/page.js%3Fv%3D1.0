SVK.register("widget.loader.widgetchannel",function(a){return a.listener("widget.loader.widgetchannel",["onVisibleReady","onStart","onComplete"])});
SVK.register("widget.extra.dom.lazyload",function(a){(function(a){function e(c,e,g,h){if(!b){b=!0;a(window).on("scroll",f);a(window).on("resize",f)}if(i(c,g,h))try{e.apply(c)}catch(j){}else d.add(function(){if(i(c,g,h)){try{e.apply(c)}catch(a){}d.remove(arguments.callee)}});return this}function f(){clearTimeout(c);c=setTimeout(function(){g()},300)}function g(){d.fire()}function h(){if(b){b=!1;a(window).off("scroll",f);a(window).off("resize",f)}}function i(b,c,d){var e,d=d||window,f=!1,g=!1,h,i,j,k,l,m,n,o,p,q;e=a(b);h=a(d);m=e.offset();p=m.left;q=m.top;try{if(d==window){k=h.scrollLeft();l=h.scrollTop();i=h.height();j=h.width()}else{k=h.offset().left;l=h.offset().top;i=h.innerHeight();j=h.innerWidth()}o=k+j-(c||0);n=l+i-(c||0);q<=n&&(g=!0);p<=o&&(f=!0)}catch(r){g=!0;f=!0}return f&&g}var b,c,d=a.Callbacks("memory");e.fire=g;e.inVisibleArea=i;e.destroy=h;a.lazyload=e;a.fn.lazyload=function(b,c,d){return a.each(a(this),function(a,f){return e(f,b,c,d)})}})(jQuery);return a.lazyload});
jQuery.ajaxSetup({accepts:{linkstyle:"text/css"}});jQuery.ajaxPrefilter("linkstyle",function(a){a.cache===undefined&&(a.cache=!1);a.type="GET"});jQuery.ajaxTransport("linkstyle",function(a){var b,c,d=navigator.userAgent.replace(/.*AppleWebKit\/(\d+)\..*/,"$1")*1<536;return{send:function(e,f){var g,h;h=function(a){a=a||200;if(!g){g=!0;h=function(){};f(a)}};b=jQuery("<link>").prop({rel:"stylesheet",charset:a.styleCharset,href:a.url}).on("load error",c=function(a){c=null;a&&h(a.type==="error"?404:200,a.type)});(function(){var a=b.get(0).sheet,c=arguments;if(d&&a){h();return}try{a.cssRules&&h()}catch(e){e.name=="NS_ERROR_DOM_SECURITY_ERR"?h():setTimeout(function(){c.callee()},10)}})();document.getElementsByTagName("head")[0].appendChild(b[0])},abort:function(){c&&c()}}});jQuery.getLinkStyle=function(a,b){return jQuery.get(a,undefined,b,"linkstyle")};
SVK.register("widget.loader.loader",function(a){(function(a){function b(b,c){var d,b=a.isArray(b)?b:[b],c=c||{},e=a.Deferred();d=b.length;a.when.apply(a,a.map(b,function(b){return a.ajax(b)})).done(function(){var b=0,c=d==1?[arguments]:arguments;a.each(c,function(a,c){c=c||[];/success/i.test(c[1])&&++b});b==d&&e.resolveWith(e,c)}).fail(function(){e.rejectWith(e,arguments)});e.done(function(){a.isFunction(c.success)&&c.success.apply(a,arguments)}).fail(function(){a.isFunction(c.error)&&c.error.apply(a,arguments)});return e.promise()}a.sinawidget={};a.sinawidget.loader=b})(jQuery);return a.sinawidget.loader});
SVK.register("widget.extra.style.mediachannel",function(a){return a.listener("widget.extra.style.mediachannel",["viewport"])});
SVK.register("widget.extra.style.viewport",function(a){var b=a.widget.extra.style.mediachannel,c=null,d,e=a.Callbacks();return function(f){function l(a,b){var d=c.getParamsByObj(a),e=c.getParamsByObj(b),f=d.w,g=d.mw,h=d.Mw,i=e.w,j=e.mw,k=e.Mw;return i&&(i==f||!g&&i<=h||!h&&i>=g||i>=g&&i<=h)?!0:j&&k&&(f<=k&&f>=j||!g&&k<=h||!h&&j>=g||k<=h&&j>=g)?!0:!j&&k&&(f&&k>=f||h&&k<=h)?!0:j&&!k&&(f&&j<=f||g&&j>=g)?!0:!1}function m(b){var c=a.core.json.queryToJson(b);return{w:parseInt(c.width)||0,mw:parseInt(c["min-width"])||0,Mw:parseInt(c["max-width"])||0}}function n(){var b=a('<div style="display:none;">'),c=[];b.attr("id",h.id);a(document.body).append(b);c.push({key:"min-width",value:b.css("min-width")});c.push({key:"max-width",value:b.css("max-width")});c.push({key:"width",value:b.css("width")});b.remove();return c}function o(b){var c={};a.each(b,function(a,b){var d=parseInt(b.value);d&&(c[b.key]=d)});(c["min-width"]||c["max-width"])&&delete c.width;return a.param(c)}function p(){var a=c.stringify(c.getParams());if(a!=k){k=a;b.viewport.fire({origin:a,context:c,scope:null})}}function q(){clearTimeout(d);d=setTimeout(e.fire,300)}var g,h,i,j,k="";if(c)return c;h=a.extend({id:"media_viewport_js_helper"},f);c={};i=function(){a(window).on("resize",q)};j=function(){a(window).off("resize",q);e.remove(p)};g=function(){i();e.add(p)};c.destroy=j;c.getParams=n;c.stringify=o;c.isContain=l;c.getParamsByObj=m;c.fire=e.fire;g();return c}});
SVK.register("widget.loader.widgetloader",function(a){var b=a.widget.loader.widgetchannel,c,d;(function(){function n(b){b=a.extend({id:"",require:[],rate:0,exports:function(){},isDepend:!1,initialize:!1,media:"",requireParams:[],template:{},loadTime:null},b);b.node=b.id?a("#"+b.id):null;b.error=b.node&&!b.node[0];b.isVisible=b.node&&b.node[0]?a.lazyload.inVisibleArea(b.node):!1;b.rate+=!!b.isVisible;a.extend(b,{getTemplate:t});return b}function o(){e.sort(function(a,b){return a.rate-b.rate<0});a.each(e,function(b,c){if(typeof c=="object"&&!c.error&&a.inArray(c,i)==-1){var d=function(b){if(b.listened)return;b.listened=!0;if(b.loadTime){a.sinawidget.addLoadEvent(b.loadTime,function(){p(b)});return}b.isVisible?f.push(b):b.node&&a.lazyload(b.node,function(){p(b)})},e=/MSIE 6.0/gi.test(navigator.userAgent);e||document.documentMode&&document.documentMode<=8?d(c):c.media?a.sinawidget.addLoadEvent(c.media,function(){d(c)}):d(c)}});(function(){var c,d,e=arguments;a.each(f,function(a,b){b&&b.async&&p(b)});f.length&&(c=f.shift())?p(c,e.callee):b.onVisibleReady.fire()})()}function p(c,d){var require=c.require,require=a.isArray(require)?require:[require],e=c.node,f=[],h;if(a.inArray(c,i)!=-1){a.isFunction(d)&&d();return}i.push(c);require=a.map(require,function(b,d){var e,f;if(b){e=r(b);if(f=c.requireParams[d]){var g=e.data;a.extend(e,f);a.extend(e.data,g)}return e}});f=a.map(require,function(a){if(a&&a._evalVar_)return a._evalVar_});require=a.map(require,function(b){if(a.inArray(b.url,g)==-1)return b});require=a.map(require,function(a){if(!s(a._evalVar_))return a});h=function(){var h;c.template&&a.each(c.template,function(a,b){c.template[a]=t(b)});a.isFunction(d)&&d();if(a.isFunction(c.exports)){h=function(){c.exports.apply(e||a,[e,c])};c.initTime?a.sinawidget.addLoadEvent(c.initTime,h):h()}a.each(require,function(a,b){b._fileType_=="js"&&b.url&&g.push(b.url)});c.initialize&&function(){var b,d;if(f.length&&(b=f.shift())&&(d=s(b))&&a.isFunction(d.init)){var g=function(){try{d.init.apply(d,[e,c])}catch(a){}};c.initTime?a.sinawidget.addLoadEvent(c.initTime,g):g();var h=function(){try{d.play()}catch(a){}},i=function(){try{d.stop()}catch(a){}};if(c.playTime&&c.stopTime){x(c.playTime,h);x(c.stopTime,i)}}}();a.isReady&&a(document).ready(function(){try{var a=document.createEvent("HTMLEvents");a.initEvent("DOMContentLoaded",!0,!0);document.dispatchEvent(a)}catch(b){}});b.onComplete.fire(c)};b.onStart.fire(c);if(require.length)if(c.isDepend){var j=[].concat(require);(function(){var b;j.length&&(b=j.shift())?a.sinawidget.loader(b).done(arguments.callee).fail(arguments.callee):setTimeout(h,0)})()}else a.sinawidget.loader(require).done(h).fail(h);else h()}function q(a){return j.test(a)?"css":"js"}function r(a){var b,c,d,e;c=q(a);if(!k.test(a)){b=a.replace(/\./g,"/")+"."+c;b=l[c]+b;c=="js"&&(e=a)}else b=a;return{url:b,_fileType_:c,_evalVar_:e,cache:!0,data:m[c]&&e?{v:m[c]}:{},dataType:{js:"script",css:"linkstyle"}[c]}}function s(b){var c,d,e,f=SVK;b=a.trim(b)||"";e=b.split(".");while(e.length&&(c=e.shift()))if(f[c]){f=f[c];e.length==0&&(d=!0)}return d?f:!1}function t(b){var c;a.tpl=a.tpl||{};if(!(c=a.tpl[b]))try{c=a("#"+b).html()}catch(d){c=""}return c}function u(a){return a.split("=").length>1}function x(b,c){v[b]=v[b]||a.Callbacks();v[b].add(c)}function y(a){try{v[a].fire()}catch(b){}}var e=[],f=[],g=[],h={},i=[],j=/\.css$/i,k=/(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/,l={js:"http://sjs0.sinajs.cn/video/live/js/",css:"http://sjs0.sinajs.cn/video/live/css/"},m={},v={},w=[];a.sinawidget.addLoadEvent=function(b,c){var d;if(a.type(b)=="string"){if(b.split("|").length>1){a.each(b.split("|"),function(b,d){a.sinawidget.addLoadEvent(d,c)});return}d=h[b]||(h[b]=a.Callbacks("once memory"));if(a.isFunction(c))if(b=="DOMContentLoaded")a(document).ready(c);else{d.add(c);a.sinawidget.isFiredEvent(b)&&a.sinawidget.fireLoadEvent(b)}}};a.sinawidget.fireLoadEvent=function(b){var d;if(c&&u(b)){a.sinawidget.fireMediaEvent(b);return}if(a.type(b)=="string"){a.inArray(b,w)==-1&&w.push(b);(d=h[b])&&d.fire()}y(b)};a.sinawidget.fireMediaEvent=function(b){a.each(h,function(d,e){if(!u(d))return;if(c.isContain(d,b)){a.inArray(b,w)==-1&&w.push(d);e.fire()}})};a.sinawidget.isFiredEvent=function(b){return a.inArray(b,w)!=-1};a.sinawidget.startLoadWidget=function(b){var f;b=b||{};f=a.isArray(b.widget)?b.widget:[b.widget];a.extend(l,b.path);a.extend(m,b.version);a.each(f,function(a,b){b&&e.push(new n(b))});o();if(d.needmedia){a.widget.extra.style.mediachannel.viewport.add(function(b){a.sinawidget.fireLoadEvent(b.origin)});c=a.widget.extra.style.viewport();c.fire()}}})(jQuery);a(document).ready(function(){a.sinawidget.fireLoadEvent("DOMContentLoaded")});b.onVisibleReady.add(function(){a.sinawidget.fireLoadEvent("onVisibleReady")});a(window).on("load",function(){a.sinawidget.fireLoadEvent("onload")});d={needmedia:!1,startLoadWidget:a.sinawidget.startLoadWidget,fireLoadEvent:a.sinawidget.fireLoadEvent,addLoadEvent:a.sinawidget.addLoadEvent};return d});
SVK.register("widget.loader.widgetpl",function(a){window.console=window.console||{};window.console.log=window.console.log||function(){};a(document).ready(function(){if(window.$widget&&window.$widgetconfig){var b=window.$widgetconfig;a.widget.loader.widgetloader.startLoadWidget({widget:window.$widget,path:{js:b.jspath,css:b.csspath},version:{js:b.jsversion||"1.0",css:b.cssversion||"1.0"}})}})});
SVK.register("widget.extra.io.jsonp",function(a){return function(b,c){var d=document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script");arguments.callee.randomnum++;var f="HTML5"+arguments.callee.randomnum+"_"+a.core.util.getUniqueKey();e.src=b+"&callback="+f;e.charset="utf-8";window[f]=function(a){if(c||typeof c=="function"){c(a);delete window[c];d.removeChild(e)}};d.appendChild(e)}});
SVK.register("widget.extra.str.numFormater",function(a){var b={getZeroPrefixedNum:function(a,b){var c=[];a=typeof a=="undefined"?"":a;for(var d=0;d<b;++d)c.push(0);return c.join("").substr(0,b-a.toString().length)+a},getSeparatedNum:function(a,b){a=(typeof a=="undefined"?"":a)+"";b=b||",";return a.replace(/(\d+)(\.\d+)?/g,function(a,c,d){return(c.length>3?c.indexOf(b)<0||c.indexOf(b)>3?arguments.callee(null,c.replace(/(\d+)(\d{3})/,"$1"+b+"$2")):c:c)+(d||"")})},showShortNum:function(a){var b=Number(a).toString(),c=b.length;if(c>8){b=b.substring(0,c-7);return b/10+"亿"}if(c>4){b=b.substring(0,c-3);return b/10+"万"}return b}};return b});
SVK.register("base.renderCommentNum",function(a){return function(b,c){var d=c?c:"cmnt_id",e=b.find("["+d+"]");if(!e[0])return!1;var f="";a.each(e,function(b,c){var e=a(c).attr(d);f+=e+","});var g=a.widget.extra.str.numFormater,h="http://comment5.news.sina.com.cn/cmnt/count?format=json&newslist="+f.slice(0,-1);a.widget.extra.io.jsonp(h,function(c){var e=c.result.count,f=e?e:{};for(var h in f)a("["+d+'="'+h+'"]',b).html(g.getSeparatedNum(f[h].total))})}});
SVK.register("widget.device.browser",function(a){return{kernel:{ie:"ActiveXObject"in window}}});
SVK.register("widget.extra.dom.ietitlechange",function(a){var b=a.widget.device.browser;if(b.kernel.ie){var c=document.title;a(document.body).bind("mouseup",function(a){setTimeout(function(){document.title!=c&&(document.title=c)},1e3)})}});



