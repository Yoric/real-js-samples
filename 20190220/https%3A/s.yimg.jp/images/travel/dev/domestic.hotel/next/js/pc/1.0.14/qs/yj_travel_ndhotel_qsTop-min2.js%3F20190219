var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.common=YAHOO.JP.trv.common||{};YAHOO.JP.trv.common.roomperson=(function($){function roomps(){}roomps.prototype={setInput:function(){this.param.room_e=$("input[name=rm]");
this.param.adlt_e=$("input[name=adlt]");this.param.childa_e=$("input[name=chlda]");this.param.childb_e=$("input[name=chldb]");this.param.childc_e=$("input[name=chldc]");this.param.childd_e=$("input[name=chldd]");
this.param.childo_e=$("input[name=chldo]");this.param.childo2_e=$("input[name=chldo2]");this.param.ci_e=$("input[name=ci]");this.param.co_e=$("input[name=co]");},calcPerson:function(args){var val=args.val,adlt=args.adlt,childA=args.childA,childB=args.childB,childC=args.childC,childD=args.childD,childO=args.childO,childO2=args.childO2,isNoBed=args.isNoBed,isPlus=args.isPlus,validate=args.validate,count=0,no_bed_count=0,validate_param=this.validate_param;
count+=parseInt(adlt);count+=isNaN(parseInt(childA))?0:parseInt(childA);count+=isNaN(parseInt(childB))?0:parseInt(childB);count+=isNaN(parseInt(childC))?0:parseInt(childC);count+=isNaN(parseInt(childO2))?0:parseInt(childO2);
if(validate_param["childD"]){no_bed_count+=isNaN(parseInt(childD))?0:parseInt(childD);}if(validate_param["childO"]){no_bed_count+=isNaN(parseInt(childO))?0:parseInt(childO);}if(isPlus){if(isNoBed){if((no_bed_count>=validate_param["nbMax"])){return false;
}}if(validate&&count>=validate_param["pMax"]){return false;}else{val++;}}else{if(validate&&count<1){return false;}else{val--;}}return val;},setApplyRoomPersonText:function(text){$(this.param.submit).text(text);
},setRoomPersonsCallback:function(fn){this.applyRoomPersonsCallback=fn;},setValidateParam:function(val){this.validate_param=val;}};return roomps;})(jQuery);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.conf={tab:{urls:["/dhotel/quicksearch/dl","/dhotel/quicksearch/da","/dhotel/quicksearch/dt","/dhotel/quicksearch/at","/dhotel/quicksearch/aa","/dhotel/quicksearch/ydp"],da:{urls:["/dhotel/quicksearch/dajal","/dhotel/quicksearch/daana"]},dapl:{urls:["/dhotel/quicksearch/dapljal","/dhotel/quicksearch/daplana"]}},ajax:{type:"GET",cache:false,timeout:5000,error:function(xhr,status,ex){}},json:"jsonp",jsonSuggest:"json",calender:{dayNames:["日","月","火","水","木","金","土"],holidays:null,jpInit:function(){$.datepicker.regional["ja"]={yearSuffix:"年",monthNames:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayNames:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],dayNamesShort:["日","月","火","水","木","金","土"],dayNamesMin:["日","月","火","水","木","金","土"],dateFormat:"yy/mm/dd",firstDay:0,prevText:"前へ",prevStatus:"",prevJumpText:"&#x3c;&#x3c;",prevJumpStatus:"",nextText:"次へ",nextStatus:"",nextJumpText:"&#x3e;&#x3e;",nextJumpStatus:"",currentText:"今日",currentStatus:"",todayText:"今日",todayStatus:"",clearText:"-",clearStatus:"",closeText:"キャンセル",closeStatus:"",yearStatus:"",monthStatus:"",weekText:"週",weekStatus:"",dayStatus:"DD d MM",defaultStatus:"",isRTL:false,showMonthAfterYear:true};
$.datepicker.setDefaults($.datepicker.regional["ja"]);$.datepicker.setDefaults({showButtonPanel:true});$.datepicker.setDefaults({numberOfMonths:2,beforeShowDay:function(date){var holidays=YAHOO.JP.trv.qs.conf.calender.holidays;
if(holidays){var key=""+date.getFullYear()+("00"+(date.getMonth()+1)).slice(-2)+("00"+date.getDate()).slice(-2);if(holidays[key]){return[true,"ui-datepicker-holiday"];}}if(date.getDay()==0){return[true,"ui-datepicker-sunday"];
}else{if(date.getDay()==6){return[true,"ui-datepicker-saturday"];}else{return[true,""];}}}});}},area:{LL:"search/area/ll",KC:"search/area/pref",SC:"search/area/city",LC:"search/area/l",MC:"search/area/m",EK:"search/eki",AP:"search/air",LM:"search/spot",SP:"search/onsen",HT:"shisetsu"},dd:{rootUrl:"/dhotel/",person:{max:6,min_adlt:1,min_child:0},personIkyu:{max:6,min_adlt:1,min_child:0},range:{fromTo:15},reset:{numText:"",dateText:"未定"}},fs:{url:{suggest:"/api/suggest"},rootUrl:"/dhotel/",qryRequestPath:"/dhotel/search/",delimiter:"---------------------------------",blockcount:[5,4,0,4,0,10,4,4],blockorder:[0,1,2,3,4,4,5,6],blockidxmap:{"LL":1,"KC":1,"LC":1,"MC":1,"EK":5,"AP":6,"LM":3,"HT":0,"SL":7,"SC":2,"SP":4},},aa:{url:{country_js_dir:"/quicksearch/aa_jsfile/"}},dl:{landmark_js_path:"/quicksearch/dt_jsfile/"},da:{jal:{limitDay:364},ana:{limitDay:355,"paxCountConditionForm.selectedAdultCount":{max:6,min:1},"paxCountConditionForm.selectedChildCount":{max:6,min:0},"paxCountConditionForm.selectedInfantCount":{max:2,min:0},"adultCount":{max:6,min:1},"childCount":{max:6,min:0},"infantCount":{max:2,min:0}}},dapl:{jal:{pref_area_js_path:"//travel.yahoo.co.jp/proxy.php/img.travel.yahoo.co.jp/domestic_dp/js/jal/",depLimitDay:200,arrLimitDay:213,nights:{max:13,min:1},adult_num:{max:6,min:1},senior_num:{max:5,min:0},child_num:{max:5,min:0},baby_num:{max:2,min:0},room_num:{max:6,min:1}},ana:{pref_l_area_js_path:"//travel.yahoo.co.jp/proxy.php/img.travel.yahoo.co.jp/domestic_dp/js/ana/v2_1/L",pref_m_area_js_path:"//travel.yahoo.co.jp/proxy.php/img.travel.yahoo.co.jp/domestic_dp/js/ana/v2_1/",depLimitMonth:10,arrLimitMonth:10,adultCnt:{max:6,min:1},}},at:{url:{country_js_dir:"/quicksearch/at_jsfile/"}}};
var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.control={DDL:{id:"",viewid:"",hdnName:"",unSelectText:'指定なし<span class="ico01 iArrowMore"></span>',bind:function(){var me=this;
$(this.id).closest("dl").find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");if($toggleArea.data("qs-status")==="off"){return;}if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");
$toggleArea.show();$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");
YAHOO.JP.trv.qs.util.bindOutsideHide(id);});$toggleArea.find("li").on("click",function(){me.select($(this));});});$(this.id).find("li").off("click").on("click",function(){me.onClick($(this));});},hide:function(){$(this.id).hide();
return this;},disable:function(){$(this.viewid).addClass("disable");$(this.id).data("qs-status","off");return this;},enable:function(){$(this.viewid).removeClass("disable");$(this.id).data("qs-status","on");
return this;},select:function($selectDOM){var html=$selectDOM.text()+'<span class="ico01 iArrowMore"></span>';var $dl=$selectDOM.closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");
var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");$selectDOM.addClass("selected");$hdnArea.val($selectDOM.data("qs-val")).change();$thisToggleAnchor.html(html);$thisToggleArea.hide();
return this;},qsVal:function($selectDOM){if($selectDOM){return $selectDOM.data("qs-val");}else{return $(this.id).data("qs-val");}},qsType:function($selectDOM){if($selectDOM){return $selectDOM.data("qs-type");
}else{return $(this.id).data("qs-type");}},clickFire:function(){$(this.id).find("li.selected").trigger("click");return this;},selectedVal:function(){return $(this.id).find("li.selected").data("qs-val");
},reset:function(){$(this.viewid).html(this.unSelectText).removeClass("disable");if(this.hdnName){$(this.hdnName).val("");}return this;},onClick:function(){},makeDOM:function(){}}};var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.util=(function($){var retryMax=10;var retryCount=0;var retryTimer=100;var sub={bindOutsideHide:function(id){$(document).off("click."+id).on("click."+id,function(e){var target=$("#"+id);
if(target.is(":hidden")||target.is(":animated")){$(document).off("click."+id);return;}if(!target.is(e.target)&&target.has(e.target).length===0){$(target).hide();$(document).off("click."+id);}});},parseIntVal:function(val){return parseInt(val,10);
},loadJS:function(ns,callback){if(retryCount>=retryMax){retryCount=0;return;}retryCount++;if(YAHOO.JP.trv.qs[ns]){retryCount=0;callback();}else{setTimeout(function(){YAHOO.JP.trv.qs.util.loadJS(ns,callback);
},retryTimer);}},isEqualSelecter:function(s1,s2){if(s1==null||s2==null){return false;}var is_each=false;s1.each(function(){var s1_1=$(this);s2.each(function(){if($(this).is(s1_1)){is_each=true;return false;
}});if(is_each){return false;}});return is_each;},getBrowserName:function(){var ua=window.navigator.userAgent.toLowerCase();var ver=window.navigator.appVersion.toLowerCase();var browser=false;if(ua.indexOf("msie")!=-1){if(ver.indexOf("msie 6.")!=-1){browser="ie6";
}else{if(ver.indexOf("msie 7.")!=-1){browser="ie7";}else{if(ver.indexOf("msie 8.")!=-1){browser="ie8";}else{if(ver.indexOf("msie 9.")!=-1){browser="ie9";}else{if(ver.indexOf("msie 10.")!=-1){browser="ie10";
}else{browser="ie";}}}}}}else{if(ua.indexOf("trident/7")!=-1){browser="ie11";}else{if(ua.indexOf("chrome")!=-1){browser="chrome";}else{if(ua.indexOf("safari")!=-1){browser="safari";}else{if(ua.indexOf("opera")!=-1){browser="opera";
}else{if(ua.indexOf("firefox")!=-1){browser="firefox";}}}}}}return browser;}};return sub;})(jQuery);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.quicksearch=(function($,conf){var $qs_search_area=null;var $qs_nav_area=null;
var _bucket_id="";function getRenderHtml(tab,bucket_id){var ajaxOption=$.extend(true,{},conf.ajax);ajaxOption.url=conf.tab.urls[YAHOO.JP.trv.qs.util.parseIntVal(tab)];ajaxOption.timeout=30000;ajaxOption.async=true;
ajaxOption.data={"bucket_id":bucket_id};ajaxOption.success=function(data,status,xhr){$.each(YAHOO.JP.trv.qs,function(k,v){if(v&&v.changedTab){v.changedTab();}});$qs_search_area.find("*").off().empty();
$qs_search_area.empty();$qs_search_area.html(data);var $li=$qs_nav_area.find("li");$.each($li,function(){if($(this).data("qs-tab")==tab){$(this).addClass("current");$(this).find("a").hide();$(this).find("span").show();
}else{$(this).removeClass("current");$(this).find("span").hide();$(this).find("a").show();}});};ajaxOption.dataType="html";$.ajax(ajaxOption);}var sub={init:function(tab,bucket_id){if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");
};}$qs_search_area=$("#qs_search_area");$qs_nav_area=$("#qs_nav_area");if(bucket_id){_bucket_id=bucket_id;}getRenderHtml(tab,_bucket_id);conf.calender.jpInit();YAHOO.JP.trv.qs.quicksearch.bind();},bind:function(){$qs_nav_area.find("li").off("click").on("click",function(){var isCurrent=$(this).is(".current");
if(!isCurrent){var tabName=$(this).data("qs-tab");getRenderHtml(tabName,_bucket_id);}});}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.abroadair=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
var $mainArea=null;var $qs_dep_ym=null;var $qs_dep_ym_view=null;var $qs_dep_d=null;var $qs_dep_d_view=null;var $qs_ap=null;var $submitForm=null;var $areacd1=null;var $countrycd1=null;var $citycd1=null;
var $ol=null;var $qs_aa_ctry_view=null;var $qs_aa_ctry=null;var $qs_aa_city_view=null;var $qs_aa_city=null;var ctryData=[];var cityData=[];var $viewData=null;var $hdnData=null;function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';
var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");
$(this).closest("li").addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);$thisToggleArea.hide();});}function getCtryData(rcd){var ajaxOption=conf.ajax;ajaxOption.url=conf.aa.url.country_js_dir+"1"+rcd;
ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){var fn="(function(){ "+data+"function Country1(name, value, cities, num){"+"    YAHOO.JP.trv.qs.abroadair.setCountry(name, value, cities, num);"+"}"+"function City1(name, value) {"+"    YAHOO.JP.trv.qs.abroadair.setCity(name, value);"+"}"+"function selectArea1(){"+"    return;"+"}"+"})();";
eval(fn);$('input[name="rcd"]').val(rcd);var ctryHtml='<ul id="qs_aa_toCtry">';var cityHtml="";var citiesNum=0;for(var i=0;i<ctryData.length;i++){var data=ctryData[i];citiesNum+=data.num;ctryHtml+='<li data-qs-val="'+data.value+'"><a href="javascript:void(0)">'+data.name+"</a></li>";
cityHtml+=getCityHtml(data.value,data.num,citiesNum);}ctryHtml+="</ul>";$qs_aa_ctry_view.html('方面（国など）を選択<span class="ico01 iArrowMore"></span>');$qs_aa_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>');
$qs_aa_ctry.html(ctryHtml);$qs_aa_city.html(cityHtml);bindSelectToggleArea($qs_aa_ctry.find("a"));$("#qs_aa_toCtry").find("li").off("click").on("click",function(){var ccd=$(this).data("qs-val");if(ccd===""){$qs_aa_ctry_view.html('方面（国など）を選択<span class="ico01 iArrowMore"></span>');
$qs_aa_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>');$qs_aa_ctry.html("");}else{$qs_aa_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>').removeClass("disable");$qs_aa_city.data("qs-status","on");
$qs_aa_city.find("ul").css("display","none");$qs_aa_city.find("ul#"+ccd).css("display","block");bindSelectToggleArea($qs_aa_city.find("a"));if($(this).data("qs-val")===$countrycd1.val()){return;}$countrycd1.val($(this).data("qs-val"));
$citycd1.val("");}});$("#qs_aa_city").find("li").off("click").on("click",function(){if($(this).data("qs-val")===$citycd1.val()){return;}$citycd1.val($(this).data("qs-val"));});ctryData=[];cityData=[];};
ajaxOption.dataType="text";$.ajax(ajaxOption);ajaxOption.beforeSend=null;}function getCityHtml(ccd,cnt,all){var cityHtml='<ul id="'+ccd+'" style="display: none;">';for(var j=(all-cnt);j<all;j++){var city=cityData[j];
cityHtml+='<li data-qs-val="'+city.value+'"><a href="javascript:void(0)">'+city.name+"</a></li>";}cityHtml+="</ul>";return cityHtml;}function bindDatePicker($jqObj,$view){var tomorrow=new Date($jqObj.val());
var limitDate=new Date(tomorrow.getFullYear(),tomorrow.getMonth()+6,0);var datepickerOption={minDate:tomorrow,maxDate:limitDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$qs_dep_ym_view.closest("dl").offset().top+$qs_dep_ym_view.closest("dl").height(),left:$mainArea.offset().left+($mainArea.width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var textYear=selectedDate.getFullYear();var textMonth=(selectedDate.getMonth()+1);var textDate=selectedDate.getDate();var tmp_ym=textYear+"年"+textMonth+"月";
var tmp_d=textDate+"日";$qs_dep_ym.find("li[data-qs-val="+textMonth+"]").trigger("click");$mainArea.find(".jsToggleTarget li[data-qs-val="+textMonth+"] a").trigger("click");$qs_dep_d.find("ul[data-qs-val="+textMonth+"] li[data-qs-val="+textDate+"]").trigger("click");
$mainArea.find(".jsToggleTarget ul[data-qs-val="+textMonth+"] li[data-qs-val="+textDate+"] a").trigger("click");}};$jqObj.datepicker("destroy");$jqObj.datepicker(datepickerOption);$view.off("click").on("click",function(){$jqObj.datepicker("show");
});}function bindStatic(){$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");if($toggleArea.data("qs-status")==="off"){return;
}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");$toggleArea.show();
$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");
bindOutsideHide(id);});});$mainArea.find(".jsToggleTarget a").off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore">';var $dl=$(this).closest("dl");var $id=$(this).closest("dd").attr("id");
var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$("form#qs_aa_submitForm").find("input#in_"+$id);$dl.find("li").removeClass("selected");$(this).closest("li").addClass("selected");
$hdnArea.val($(this).closest("li").data("qs-val")).change();$thisToggleAnchor.html(html);$thisToggleArea.hide();});$qs_ap.find("li").off("click").on("click",function(){$qs_ap.hide();$(this).closest("dd").find("li").removeClass("selected");
$(this).addClass("selected");});$qs_dep_ym.find("li").off("click").on("click",function(){$qs_dep_ym.hide();$qs_dep_d.hide();$qs_dep_d.find("ul").css("display","none");$qs_dep_d_view.html('指定なし<span class="ico01 iArrowMore">');
$qs_dep_d.find("ul[data-qs-val="+$(this).data("qs-val")+"]").css("display","block");$(this).closest("dd").find("li").removeClass("selected");$(this).addClass("selected");$qs_dep_d.find("li").removeClass("selected");
$qs_dep_d.find('li[data-qs-val=""]').addClass("selected");var $hdnArea=$("form#qs_aa_submitForm").find("input#in_qs_dep_d");$hdnArea.val("").change();var $tmp_ym=$(this).text().replace(/年/g,"/").replace(/月/g,"/");
var $tmp_day=$qs_dep_d.find("ul[data-qs-val="+$(this).data("qs-val")+"]").find("li").eq(1).text().replace(/日/g,"");$hdnDate.val($tmp_ym+$tmp_day);});$qs_dep_d.find("li").off("click").on("click",function(){var $tmp_day=0;
var $tmp_ym=$qs_dep_ym_view.text().replace(/年/g,"/").replace(/月/g,"/");if(!$(this).data("qs-val")){$tmp_day=1;}else{$tmp_day=$(this).data("qs-val");}$hdnDate.val($tmp_ym+$tmp_day);$qs_dep_d.find("li").removeClass("selected");
$(this).addClass("selected");});bindDatePicker($hdnDate,$viewDate);$("#qs_aa_toArea").find("li").off("click").on("click",function(){var rcd=$(this).data("qs-val");if(rcd===""){$qs_aa_ctry_view.html('方面（国など）を選択<span class="ico01 iArrowMore"></span>');
$qs_aa_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>');$qs_aa_ctry.html("").data("qs-status","off");$submitForm.find("input").val("");}else{$qs_aa_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>').addClass("disable");
$qs_aa_city.html("").data("qs-status","off");$qs_aa_ctry.data("qs-status","on");getCtryData(rcd);if($(this).data("qs-val")===$areacd1.val()){return;}$areacd1.val($(this).data("qs-val"));$countrycd1.val("");
$citycd1.val("");}});$("#checkbox1_3").off("change").on("change",function(){if($(this).is(":checked")){$ol.val(1);}else{$ol.val("");}});$submitForm.off("click").on("click",function(){$(this).submit();});
$("#qs_aa_detailSearch").off("click").on("click",function(){$submitForm.find("input[name=search]").val("o");$submitForm.attr("action",$(this).data("qs-href")).attr("data-rdlabel",$(this).data("data-rdlabel"));
redirect_rdsig("#qs_aa_submitForm");});$mainArea.find(".jsToggleTarget li.selected").trigger("click");}var sub={init:function(){$mainArea=$("#qs_abroadair");$qs_dep_ym=$("#qs_dep_ym");$qs_dep_ym_view=$("#qs_dep_ym_view");
$qs_dep_d=$("#qs_dep_d");$qs_dep_d_view=$("#qs_dep_d_view");$submitForm=$("#qs_aa_submitForm");$areacd1=$submitForm.find('input[name="areacd1"]');$countrycd1=$submitForm.find('input[name="countrycd1"]');
$citycd1=$submitForm.find('input[name="citycd1"]');$ol=$submitForm.find("input[name=ol]");$qs_aa_ctry_view=$("#qs_aa_ctry_view");$qs_aa_ctry=$("#qs_aa_ctry");$qs_aa_city_view=$("#qs_aa_city_view");$qs_aa_city=$("#qs_aa_city");
$viewDate=$("#qs_datepicker_view");$hdnDate=$("#qs_datepicker");$qs_ap=$("#qs_ap");YAHOO.JP.trv.qs.abroadair.bind();},bind:function(){bindStatic();},setCountry:function(name,value,cities,num){ctryData.push({"name":name,"value":value,"cities":cities,"num":num});
},setCity:function(name,value){cityData.push({"name":name,"value":value});},changedTab:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.abroadtour=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
var $mainArea=null;var $qs_dep_ym=null;var $qs_dep_ym_view=null;var $qs_dep_d=null;var $qs_dep_d_view=null;var $qs_ap=null;var $viewData=null;var $hdnData=null;var $submitForm=null;var $qs_at_ctry_view=null;
var $qs_at_ctry=null;var $qs_at_city_view=null;var $qs_at_city=null;var ctryData=[];var cityData=[];var $areacd1=null;var $countrycd1=null;var $citycd1=null;function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';
var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");
$(this).closest("li").addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);$thisToggleArea.hide();});}function getCtryData(rcd){var ajaxOption=conf.ajax;ajaxOption.url=conf.at.url.country_js_dir+"1"+rcd;
ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){var fn="(function(){ "+data+"function Country1(name, value, cities, num){"+"    YAHOO.JP.trv.qs.abroadtour.setCountry(name, value, cities, num);"+"}"+"function City1(name, value) {"+"    YAHOO.JP.trv.qs.abroadtour.setCity(name, value);"+"}"+"function selectArea1(){"+"    return;"+"}"+"})();";
eval(fn);$('input[name="rcd"]').val(rcd);var ctryHtml='<ul id="qs_at_toCtry">';var cityHtml="";var citiesNum=0;for(var i=0;i<ctryData.length;i++){var data=ctryData[i];citiesNum+=data.num;ctryHtml+='<li data-qs-val="'+data.value+'"><a href="javascript:void(0)">'+data.name+"</a></li>";
cityHtml+=getCityHtml(data.value,data.num,citiesNum);}ctryHtml+="</ul>";$qs_at_ctry_view.html('方面（国など）を選択<span class="ico01 iArrowMore"></span>');$qs_at_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>');
$qs_at_ctry.html(ctryHtml);$qs_at_city.html(cityHtml);bindSelectToggleArea($qs_at_ctry.find("a"));$("#qs_at_toCtry").find("li").off("click").on("click",function(){var ccd=$(this).data("qs-val");if(ccd===""){$qs_at_ctry_view.html('方面（国など）を選択<span class="ico01 iArrowMore"></span>');
$qs_at_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>');$qs_at_ctry.html("");}else{$qs_at_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>').removeClass("disable");$qs_at_city.data("qs-status","on");
$qs_at_city.find("ul").css("display","none");$qs_at_city.find("ul#"+ccd).css("display","block");bindSelectToggleArea($qs_at_city.find("a"));if($(this).data("qs-val")===$countrycd1.val()){return;}$countrycd1.val($(this).data("qs-val"));
$citycd1.val("");}});$("#qs_at_city").find("li").off("click").on("click",function(){if($(this).data("qs-val")===$citycd1.val()){return;}$citycd1.val($(this).data("qs-val"));});ctryData=[];cityData=[];};
ajaxOption.dataType="text";$.ajax(ajaxOption);ajaxOption.beforeSend=null;}function getCityHtml(ccd,cnt,all){var cityHtml='<ul id="'+ccd+'" style="display: none;">';for(var j=(all-cnt);j<all;j++){var city=cityData[j];
cityHtml+='<li data-qs-val="'+city.value+'"><a href="javascript:void(0)">'+city.name+"</a></li>";}cityHtml+="</ul>";return cityHtml;}function bindDatePicker($jqObj,$view){var tomorrow=new Date($jqObj.val());
var limitDate=new Date(tomorrow.getFullYear(),tomorrow.getMonth()+8,0);var datepickerOption={minDate:tomorrow,maxDate:limitDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$qs_dep_ym_view.closest("dl").offset().top+$qs_dep_ym_view.closest("dl").height(),left:$mainArea.offset().left+($mainArea.width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var textYear=selectedDate.getFullYear();var textMonth=(selectedDate.getMonth()+1);var textDate=selectedDate.getDate();var tmp_ym=textYear+"年"+textMonth+"月";
var tmp_d=textDate+"日";$qs_dep_ym.find("li[data-qs-val="+textMonth+"]").trigger("click");$mainArea.find(".jsToggleTarget li[data-qs-val="+textMonth+"] a").trigger("click");$qs_dep_d.find("ul[data-qs-val="+textMonth+"] li[data-qs-val="+textDate+"]").trigger("click");
$mainArea.find(".jsToggleTarget ul[data-qs-val="+textMonth+"] li[data-qs-val="+textDate+"] a").trigger("click");}};$jqObj.datepicker("destroy");$jqObj.datepicker(datepickerOption);$view.off("click").on("click",function(){$jqObj.datepicker("show");
});}function bindStatic(){$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");if($toggleArea.data("qs-status")==="off"){return;
}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");$toggleArea.show();
$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");
bindOutsideHide(id);});});$mainArea.find(".jsToggleTarget a").off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore">';var $dl=$(this).closest("dl");var $id=$(this).closest("dd").attr("id");
var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$("form#qs_at_submitForm").find("input#in_"+$id);$dl.find("li").removeClass("selected");$(this).closest("li").addClass("selected");
$hdnArea.val($(this).closest("li").data("qs-val")).change();$thisToggleAnchor.html(html);$thisToggleArea.hide();});$qs_ap.find("li").off("click").on("click",function(){$qs_ap.hide();$(this).closest("dd").find("li").removeClass("selected");
$(this).addClass("selected");});$qs_dep_ym.find("li").off("click").on("click",function(){$qs_dep_ym.hide();$qs_dep_d.hide();$qs_dep_d.find("ul").css("display","none");$qs_dep_d_view.html('指定なし<span class="ico01 iArrowMore">');
$qs_dep_d.find("ul[data-qs-val="+$(this).data("qs-val")+"]").css("display","block");$(this).closest("dd").find("li").removeClass("selected");$(this).addClass("selected");$qs_dep_d.find("li").removeClass("selected");
$qs_dep_d.find('li[data-qs-val=""]').addClass("selected");var $hdnArea=$("form#qs_at_submitForm").find("input#in_qs_dep_d");$hdnArea.val("").change();var $tmp_ym=$(this).text().replace(/年/g,"/").replace(/月/g,"/");
var $tmp_day=$qs_dep_d.find("ul[data-qs-val="+$(this).data("qs-val")+"]").find("li").eq(1).text().replace(/日/g,"");$hdnDate.val($tmp_ym+$tmp_day);var $input_ym=$(this).text().replace(/年/g,"").replace(/月/g,"");
$submitForm.find("input[name=dy]").val($input_ym.substr(0,4));$submitForm.find("input[name=dm]").val($input_ym.substr(4));});$qs_dep_d.find("li").off("click").on("click",function(){var $tmp_day=0;var $tmp_ym=$qs_dep_ym_view.text().replace(/年/g,"/").replace(/月/g,"/");
if(!$(this).data("qs-val")){$tmp_day=1;}else{$tmp_day=$(this).data("qs-val");}$hdnDate.val($tmp_ym+$tmp_day);$qs_dep_d.find("li").removeClass("selected");$(this).addClass("selected");});bindDatePicker($hdnDate,$viewDate);
$("#qs_at_toArea").find("li").off("click").on("click",function(){var rcd=$(this).data("qs-val");if(rcd===""){$qs_at_ctry_view.html('方面（国など）を選択<span class="ico01 iArrowMore"></span>');$qs_at_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>');
$qs_at_ctry.html("").data("qs-status","off");$submitForm.find("input").val("");}else{$qs_at_city_view.html('都市を選択<span class="ico01 iArrowMore"></span>').addClass("disable");$qs_at_city.html("").data("qs-status","off");
$qs_at_ctry.data("qs-status","on");getCtryData(rcd);if($(this).data("qs-val")===$areacd1.val()){return;}$areacd1.val($(this).data("qs-val"));$countrycd1.val("");$citycd1.val("");}});$("#checkbox1_3").off("change").on("change",function(){if($(this).is(":checked")){$("form#qs_at_submitForm").find("input[name=ol]").val("o");
}else{$("form#qs_at_submitForm").find("input[name=ol]").val("");}});$submitForm.off("click").on("click",function(){$(this).submit();});$("#qs_at_detailSearch").off("click").on("click",function(){$submitForm.append('<input type="hidden" name="type" value="o"/>');
$submitForm.attr("action",$(this).data("qs-href")).attr("data-rdlabel",$(this).data("data-rdlabel"));redirect_rdsig("#qs_at_submitForm");});$mainArea.find(".jsToggleTarget li.selected").trigger("click");
}var sub={init:function(){$mainArea=$("#qs_abroadtour");$qs_dep_ym=$("#qs_dep_ym");$qs_dep_ym_view=$("#qs_dep_ym_view");$qs_dep_d=$("#qs_dep_d");$qs_dep_d_view=$("#qs_dep_d_view");$submitForm=$("#qs_at_submitForm");
$areacd1=$submitForm.find('input[name="areacd1"]');$countrycd1=$submitForm.find('input[name="countrycd1"]');$citycd1=$submitForm.find('input[name="citycd1"]');$qs_at_ctry_view=$("#qs_at_ctry_view");$qs_at_ctry=$("#qs_at_ctry");
$qs_at_city_view=$("#qs_at_city_view");$qs_at_city=$("#qs_at_city");$viewDate=$("#qs_datepicker_view");$hdnDate=$("#qs_datepicker");$qs_ap=$("#qs_ap");YAHOO.JP.trv.qs.abroadtour.bind();},bind:function(){bindStatic();
},setCountry:function(name,value,cities,num){ctryData.push({"name":name,"value":value,"cities":cities,"num":num});},setCity:function(name,value){cityData.push({"name":name,"value":value});},changedTab:function(){}};
return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticair=(function($,conf){var sub={init:function(){},renderTabHtml:function(tab){var ajaxOption=$.extend(true,{},conf.ajax);
ajaxOption.url=conf.tab.da.urls[YAHOO.JP.trv.qs.util.parseIntVal(tab)];ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){$.each(YAHOO.JP.trv.qs,function(k,v){if(v&&v.changedTabAir){v.changedTabAir();
}});$("#qs_domesticair").find("*").off().empty();$("#qs_domesticair").html(data);};ajaxOption.dataType="html";$.ajax(ajaxOption);},changedTab:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticair_jal=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");
var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");$(this).addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);
$thisToggleArea.hide();});}function bindDatePicker(option){var $hdnDate=option.hdnDate;var $viewDate=option.viewDate;var minDate=option.minDate;var maxDate=option.maxDate;$hdnDate.datepicker("destroy");
$hdnDate.datepicker({minDate:minDate,maxDate:maxDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$viewDate.offset().top+$viewDate.height(),left:$("#qs_da_jalArea").offset().left+($("#qs_da_jalArea").width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var selectedDateText=selectedDate.getFullYear()+"/"+(selectedDate.getMonth()+1)+"/"+selectedDate.getDate();var dayOfWeek=selectedDate.getDay();
var week=conf.calender.dayNames[dayOfWeek];selectedDateText+="（"+week+"）";$viewDate.html('<span class="ico01 iCal"></span><span class="func on">'+selectedDateText+"</span>");if(option.selectCallback){option.selectCallback(selectedDate);
}}});$viewDate.off("click").on("click",function(){$hdnDate.datepicker("show");});}var sub={init:function(){YAHOO.JP.trv.qs.domesticair_jal.bind();},bind:function(){$("#qs_da_anaTab").off("click").on("click",function(){YAHOO.JP.trv.qs.domesticair.renderTabHtml(1);
});$("#qs_da_jal_submit_btn").off("click").on("click",function(){$("#qs_da_jal_submit_form").submit();});var $mainArea=$("#qs_da_jalArea");$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");
if($toggleArea.data("qs-status")==="off"){return;}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");
$toggleArea.show();$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");
bindOutsideHide(id);});});bindSelectToggleArea($mainArea.find(".jsToggleTarget li"));var nowDate=new Date($("#qs_da_jal_cal_val").val());var maxDate=new Date(nowDate.getFullYear(),nowDate.getMonth(),nowDate.getDate()+conf.da.jal.limitDay);
bindDatePicker({hdnDate:$("#qs_da_jal_cal_val"),viewDate:$("#qs_da_jal_cal_view"),minDate:nowDate,maxDate:maxDate,selectCallback:function(selectedDate){var textMonth=(selectedDate.getMonth()+1);$("#qs_da_jal_cal_mon").val(textMonth);
$("#qs_da_jal_cal_day").val(selectedDate.getDate());}});},changedTabAir:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticair_ana=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");
var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");$(this).addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);
$thisToggleArea.hide();});}function bindDatePicker(option){var $hdnDate=option.hdnDate;var $viewDate=option.viewDate;var minDate=option.minDate;var maxDate=option.maxDate;$hdnDate.datepicker("destroy");
$hdnDate.datepicker({minDate:minDate,maxDate:maxDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$viewDate.offset().top+$viewDate.height(),left:$("#qs_da_anaArea").offset().left+($("#qs_da_anaArea").width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var selectedDateText=selectedDate.getFullYear()+"/"+(selectedDate.getMonth()+1)+"/"+selectedDate.getDate();var dayOfWeek=selectedDate.getDay();
var week=conf.calender.dayNames[dayOfWeek];selectedDateText+="（"+week+"）";$viewDate.html('<span class="ico01 iCal"></span><span class="func on">'+selectedDateText+"</span>");if(option.selectCallback){option.selectCallback(selectedDate);
}}});$viewDate.off("click").on("click",function(){$hdnDate.datepicker("show");});}var sub={init:function(){YAHOO.JP.trv.qs.domesticair_ana.bind();},bind:function(){$("#qs_da_jalTab").off("click").on("click",function(){YAHOO.JP.trv.qs.domesticair.renderTabHtml(0);
});var $mainArea=$("#qs_da_anaArea");$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");if($toggleArea.data("qs-status")==="off"){return;
}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");$toggleArea.show();
$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");
bindOutsideHide(id);});});bindSelectToggleArea($mainArea.find(".jsToggleTarget li"));var nowDate=new Date($("#qs_da_ana_cal_val").val());var maxDate=new Date(nowDate.getFullYear(),nowDate.getMonth(),nowDate.getDate()+conf.da.ana.limitDay);
bindDatePicker({hdnDate:$("#qs_da_ana_cal_val"),viewDate:$("#qs_da_ana_cal_view"),minDate:nowDate,maxDate:maxDate,selectCallback:function(selectedDate){var textMonth=(selectedDate.getMonth()+1);$("#qs_da_ana_cal_mon").val(textMonth);
$("#qs_da_ana_cal_day").val(selectedDate.getDate());}});$("#qs_da_ana_numArea").find(".iPlus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();
val=val===""?0:val;var targetName=$targetNum.attr("name");if(val<conf.da.ana[targetName].max){val++;}$targetNum.val(val);if(targetName==="autoNINZU"){$("#qs_dapl_ana_numArea").find("input[name=autoNUMPTO]").val(val);
}});$("#qs_da_ana_numArea").find(".iMinus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("name");
var min=0;if(val>conf.da.ana[targetName].min){val--;}$targetNum.val(val);if(targetName==="autoNINZU"){$("#qs_dapl_ana_numArea").find("input[name=autoNUMPTO]").val(val);}});$("#qs_da_ana_submit_btn").off("click").on("click",function(){$("#qs_da_ana_submit_form").submit();
});},changedTabAir:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticair_ana_v2=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");
var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");$(this).addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);
$thisToggleArea.hide();});}function bindDatePicker(option){var $hdnDate=option.hdnDate;var $viewDate=option.viewDate;var minDate=option.minDate;var maxDate=option.maxDate;$hdnDate.datepicker("destroy");
$hdnDate.datepicker({minDate:minDate,maxDate:maxDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$viewDate.offset().top+$viewDate.height(),left:$mainArea.offset().left+($mainArea.width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var selectedDateText=selectedDate.getFullYear()+"/"+(selectedDate.getMonth()+1)+"/"+selectedDate.getDate();var dayOfWeek=selectedDate.getDay();
var week=conf.calender.dayNames[dayOfWeek];selectedDateText+="（"+week+"）";$viewDate.html('<span class="ico01 iCal"></span><span class="func on">'+selectedDateText+"</span>");if(option.selectCallback){option.selectCallback(selectedDate);
}}});$viewDate.off("click").on("click",function(){if($viewDate.hasClass("dayInput--off")){return false;}$hdnDate.datepicker("show");});}var sub={init:function(){$mainArea=$("#qs_dapl_ana_main");$jalTab=$("#qs_dapl_ana_jal_tab");
$nowDate=$("#qs_dapl_ana_now_cal_val");$viewDepDate=$("#qs_dapl_ana_dep_cal_view");$hdnDepDate=$("#qs_dapl_ana_dep_cal_val");$viewArrDate=$("#qs_dapl_ana_arr_cal_view");$hdnArrDate=$("#qs_dapl_ana_arr_cal_val");
YAHOO.JP.trv.qs.domesticair_ana_v2.bind();},bind:function(){$("#qs_dapl_ana_jal_tab").off("click").on("click",function(){YAHOO.JP.trv.qs.domesticair.renderTabHtml(0);});$("#qs_da_seetfee_S").off("click").on("click",function(){$("#qs_dapl_ana_arr_cal_view").addClass("dayInput--off");
$("#qs_dapl_ana_bFromView").parents(".mdPullDown").removeClass("mdPullDown--off");$("#qs_dapl_ana_bFromView").addClass("disable");$("#qs_dapl_ana_bToView").parents(".mdPullDown").removeClass("mdPullDown--off");
$("#qs_dapl_ana_bToView").addClass("disable");});$("#qs_da_seetfee_Y").off("click").on("click",function(){$("#qs_dapl_ana_arr_cal_view").removeClass("dayInput--off");$("#qs_dapl_ana_bFromView").parents(".mdPullDown").addClass("mdPullDown--off");
$("#qs_dapl_ana_bFromView").removeClass("disable");$("#qs_dapl_ana_bToView").parents(".mdPullDown").addClass("mdPullDown--off");$("#qs_dapl_ana_bToView").removeClass("disable");});var $mainArea=$("#qs_dapl_ana_main");
$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");if($toggleArea.data("qs-status")==="off"){return;}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();
}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");$toggleArea.show();$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);
}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");bindOutsideHide(id);});});bindSelectToggleArea($mainArea.find(".jsToggleTarget li"));
$("#qs_dapl_ana_gFrom").find("li").on("click",function(){$("#qs_dapl_ana_bToView").html($(this).find("a").text());$("#qs_dapl_ana_bToVal").val($(this).data("qs-val"));});$("#qs_dapl_ana_gTo").find("li").on("click",function(){$("#qs_dapl_ana_bFromView").html($(this).find("a").text());
$("#qs_dapl_ana_bFromVal").val($(this).data("qs-val"));});var minDepDate=new Date($hdnDepDate.val());var nowDate=new Date($nowDate.val());var maxDepDate=new Date(nowDate.getFullYear(),nowDate.getMonth(),nowDate.getDate()+conf.da.ana.limitDay);
bindDatePicker({hdnDate:$hdnDepDate,viewDate:$viewDepDate,minDate:minDepDate,maxDate:maxDepDate,selectCallback:function(selectedDate){var textYear=selectedDate.getFullYear()+"";var textMonth=selectedDate.getMonth()+1;
textMonth=("00"+textMonth).slice(-2);var textDate=selectedDate.getDate();textDate=("00"+textDate).slice(-2);$("#qs_dapl_ana_autoDate").val(textYear+textMonth+textDate);$("#qs_dapl_ana_dep_cal_mon").val(textYear+textMonth);
$("#qs_dapl_ana_dep_cal_day").val(selectedDate.getDate());var tomorrow=new Date(selectedDate);if(tomorrow<maxDepDate){tomorrow.setDate(tomorrow.getDate()+1);}var arrTextYear=tomorrow.getFullYear()+"";var arrTextMonth=tomorrow.getMonth()+1;
arrTextMonth=("00"+arrTextMonth).slice(-2);var arrTextDate=tomorrow.getDate();arrTextDate=("00"+arrTextDate).slice(-2);$("#qs_dapl_ana_autoAIRreturnDate").val(arrTextYear+arrTextMonth+arrTextDate);$("#qs_dapl_ana_arr_cal_mon").val(arrTextYear+arrTextMonth);
$("#qs_dapl_ana_arr_cal_day").val(tomorrow.getDate());$hdnArrDate.val([tomorrow.getFullYear(),tomorrow.getMonth()+1,tomorrow.getDate()].join("/"));$hdnArrDate.datepicker("setDate",tomorrow);var minArrDateText=tomorrow.getFullYear()+"/"+(tomorrow.getMonth()+1)+"/"+tomorrow.getDate();
var dayOfWeek=tomorrow.getDay();var week=conf.calender.dayNames[dayOfWeek];minArrDateText+="（"+week+"）";$viewArrDate.html('<span class="ico01 iCal"></span><span class="func on">'+minArrDateText+"</span>");
}});var minArrDate=new Date($hdnArrDate.val());var maxArrDate=new Date(nowDate.getFullYear(),nowDate.getMonth(),nowDate.getDate()+conf.da.ana.limitDay);bindDatePicker({hdnDate:$hdnArrDate,viewDate:$viewArrDate,minDate:minArrDate,maxDate:maxArrDate,selectCallback:function(selectedDate){var textYear=selectedDate.getFullYear()+"";
var textMonth=selectedDate.getMonth()+1;textMonth=("00"+textMonth).slice(-2);var textDate=selectedDate.getDate();textDate=("00"+textDate).slice(-2);$("#qs_dapl_ana_autoAIRreturnDate").val(textYear+textMonth+textDate);
$("#qs_dapl_ana_arr_cal_mon").val(textYear+textMonth);$("#qs_dapl_ana_arr_cal_day").val(selectedDate.getDate());}});$("#qs_da_ana_numArea").find(".iPlus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");
var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("name");if(val<conf.da.ana[targetName].max){val++;}$targetNum.val(val);if(targetName==="autoNINZU"){$("#qs_dapl_ana_numArea").find("input[name=autoNUMPTO]").val(val);
}});$("#qs_da_ana_numArea").find(".iMinus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("name");
var min=0;if(val>conf.da.ana[targetName].min){val--;}$targetNum.val(val);if(targetName==="autoNINZU"){$("#qs_dapl_ana_numArea").find("input[name=autoNUMPTO]").val(val);}});$("#qs_da_ana_submit_btn").off("click").on("click",function(){$("#qs_da_ana_submit_form").submit();
});},changedTabAir:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticairhotel=(function($,conf){var sub={init:function(){},renderTabHtml:function(tab){var ajaxOption=$.extend(true,{},conf.ajax);
ajaxOption.url=conf.tab.dapl.urls[YAHOO.JP.trv.qs.util.parseIntVal(tab)];ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){$.each(YAHOO.JP.trv.qs,function(k,v){if(v&&v.changedTabAirHotel){v.changedTabAirHotel();
}});$("#qs_domesticairhotel").find("*").off().empty();$("#qs_domesticairhotel").html(data);};ajaxOption.dataType="html";$.ajax(ajaxOption);},changedTab:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);
var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticairhotel_ana=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
var $mainArea=null;var $anaTab=null;var $nowDate=null;var $viewDepDate=null;var $hdnDepDate=null;var $minDepDate=null;var $viewArrDate=null;var $hdnArrDate=null;var $minArrDate=null;var beforeSelectDepTo=null;
var beforeSelectRegion=null;var ana_airport_map={"CTS":new Array("02","001","001"),"RIS":new Array("02","012","063"),"WKJ":new Array("02","012","062"),"MBE":new Array("02","010",""),"MMB":new Array("02","010",""),"AKJ":new Array("02","004","020"),"SHB":new Array("02","011",""),"KUH":new Array("02","011","055"),"OBO":new Array("02","006","033"),"HKD":new Array("02","009","043"),"AOJ":new Array("08","401","401"),"ONJ":new Array("08","403","416"),"AXT":new Array("08","403","416"),"SYO":new Array("08","405",""),"SDJ":new Array("08","404","427"),"FKS":new Array("08","406","449"),"HND":new Array("07","301",""),"NRT":new Array("07","303","331"),"HAC":new Array("07","301","314"),"KIJ":new Array("07","308","347"),"FSZ":new Array("15","802",""),"NGO":new Array("15","801","802"),"TOY":new Array("14","702","708"),"KMQ":new Array("14","701","701"),"NTQ":new Array("14","701","702"),"ITM":new Array("10","501",""),"KIX":new Array("10","501",""),"UKB":new Array("10","503","540"),"OKJ":new Array("11","602","608"),"HIJ":new Array("11","601","601"),"IWK":new Array("11","605","635"),"UBJ":new Array("11","605","628"),"TTJ":new Array("11","603","615"),"YGJ":new Array("11","603","616"),"IWJ":new Array("11","604",""),"TAK":new Array("11","607","641"),"TKS":new Array("11","606","637"),"MYJ":new Array("11","608","646"),"KCZ":new Array("11","609","653"),"FUK":new Array("05","201","201"),"KKJ":new Array("05","201","206"),"HSG":new Array("05","202","210"),"OIT":new Array("05","205","231"),"KMJ":new Array("05","204","224"),"NGS":new Array("05","203","216"),"TSJ":new Array("05","203","222"),"IKI":new Array("05","203",""),"FUJ":new Array("05","203","223"),"KMI":new Array("05","206","237"),"KOJ":new Array("05","207","243"),"OKA":new Array("03","101",""),"MMY":new Array("03","103","113"),"ISG":new Array("03","102","108")};
function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");
var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");$(this).addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);
$thisToggleArea.hide();});}function bindDatePicker(option){var $hdnDate=option.hdnDate;var $viewDate=option.viewDate;var minDate=option.minDate;var maxDate=option.maxDate;$hdnDate.datepicker("destroy");
$hdnDate.datepicker({minDate:minDate,maxDate:maxDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$viewDate.offset().top+$viewDate.height(),left:$mainArea.offset().left+($mainArea.width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var selectedDateText=selectedDate.getFullYear()+"/"+(selectedDate.getMonth()+1)+"/"+selectedDate.getDate();var dayOfWeek=selectedDate.getDay();
var week=conf.calender.dayNames[dayOfWeek];selectedDateText+="（"+week+"）";$viewDate.html('<span class="ico01 iCal"></span><span class="func on">'+selectedDateText+"</span>");if(option.selectCallback){option.selectCallback(selectedDate);
}}});$viewDate.off("click").on("click",function(){$hdnDate.datepicker("show");});}function getRegion(cd){$("#qs_dapl_ana_districtCd").val(ana_airport_map[cd][0]);var ajaxOption=$.extend(true,{},conf.ajax);
ajaxOption.url=conf.dapl.ana.pref_l_area_js_path+ana_airport_map[cd][0];ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){var jsfunc=" (function(){ "+data;jsfunc+=" function anaReloadRegion(){} ";
jsfunc+=" return anaRegions; })(); ";var regionData=eval(jsfunc);var html="<ul>";var selectedCode=ana_airport_map[cd][1];var selectedAreaCode=null;for(var i=0;i<regionData.length;i+=2){var css_clazz="";
if(selectedCode===regionData[i]){html+='<input type="hidden" id="qs_dapl_ana_lAreaVal" name="regionCd" value="'+regionData[i]+'"></input>';$("#qs_dapl_ana_lAreaView").html(regionData[i+1]+'<span class="ico01 iArrowMore"></span>').removeClass("disable");
css_clazz=' class="selected" ';selectedAreaCode=regionData[i];}html+="<li "+css_clazz+'" data-qs-arr-val="'+cd+'" data-qs-val="'+regionData[i]+'">'+'<a href="javascript:void(0);">'+regionData[i+1]+"</a>"+"</li>";
}html+="</ul>";$("#qs_dapl_ana_lArea").html(html).data("qs-status","on");bindSelectToggleArea($("#qs_dapl_ana_lArea li"));$("#qs_dapl_ana_lArea").find("li").on("click",function(){var selectVal=$(this).data("qs-val");
if(selectVal===beforeSelectRegion){return;}getArea($(this).data("qs-arr-val"),selectVal);});getArea(cd,selectedAreaCode);};ajaxOption.dataType="text";$.ajax(ajaxOption);}function getArea(cd,regioncd){var ajaxOption=$.extend(true,{},conf.ajax);
ajaxOption.url=conf.dapl.ana.pref_m_area_js_path+regioncd;ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){var jsfunc=" (function(){ "+data;jsfunc+=" function anaReloadArea(){} ";jsfunc+=" return anaAreas; })(); ";
var areaData=eval(jsfunc);var html="<ul>";var selectedCode=null;selectedCode=ana_airport_map[cd][2];if(selectedCode===""||areaData.join().indexOf(selectedCode)<0){selectedCode=areaData[0];}var selectedAreaCode=null;
for(var i=0;i<areaData.length;i+=2){var css_clazz="";if(selectedCode===areaData[i]){html+='<input type="hidden" id="qs_dapl_ana_mAreaVal" name="areaCd" value="'+areaData[i]+'"></input>';$("#qs_dapl_ana_mAreaView").html(areaData[i+1]+'<span class="ico01 iArrowMore"></span>').removeClass("disable");
css_clazz=' class="selected" ';}html+="<li"+css_clazz+' data-qs-val="'+areaData[i]+'">'+'<a href="javascript:void(0);">'+areaData[i+1]+"</a>"+"</li>";}html+="</ul>";$("#qs_dapl_ana_mArea").html(html).data("qs-status","on");
bindSelectToggleArea($("#qs_dapl_ana_mArea li"));beforeSelectRegion=regioncd;};ajaxOption.dataType="text";$.ajax(ajaxOption);}var sub={init:function(){$mainArea=$("#qs_dapl_ana_main");$jalTab=$("#qs_dapl_ana_jal_tab");
$nowDate=$("#qs_dapl_ana_now_cal_val");$viewDepDate=$("#qs_dapl_ana_dep_cal_view");$hdnDepDate=$("#qs_dapl_ana_dep_cal_val");$minDepDate=$("#qs_dapl_ana_dep_cal_min");$viewArrDate=$("#qs_dapl_ana_arr_cal_view");
$hdnArrDate=$("#qs_dapl_ana_arr_cal_val");$minArrDate=$("#qs_dapl_ana_arr_cal_min");YAHOO.JP.trv.qs.domesticairhotel_ana.bind();},bind:function(){$jalTab.off("click").on("click",function(){YAHOO.JP.trv.qs.domesticairhotel.renderTabHtml(0);
});$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");if($toggleArea.data("qs-status")==="off"){return;}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();
}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");$toggleArea.show();$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);
}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");bindOutsideHide(id);});});bindSelectToggleArea($mainArea.find(".jsToggleTarget li"));
$("#qs_dapl_ana_gFrom").find("li").on("click",function(){$("#qs_dapl_ana_bToView").html($(this).find("a").text()+'<span class="ico01 iArrowMore"></span>');$("#qs_dapl_ana_bToVal").val($(this).data("qs-val"));
});$("#qs_dapl_ana_gTo").find("li").on("click",function(){if($(this).data("qs-val")===beforeSelectDepTo){return;}var selectedVal=$(this).data("qs-val");beforeSelectDepTo=selectedVal;$("#qs_dapl_ana_bFrom").find("li[data-qs-val="+selectedVal+"]").trigger("click");
getRegion($(this).data("qs-val"));});$("#qs_dapl_ana_lArea").find("li").on("click",function(){getDaplArea($(this).data("qs-val"));});var minDepDate=new Date($minDepDate.val());var nowDate=new Date($nowDate.val());
var maxDepDate=new Date(nowDate.getFullYear(),nowDate.getMonth()+(conf.dapl.ana.depLimitMonth+1),0);bindDatePicker({hdnDate:$hdnDepDate,viewDate:$viewDepDate,minDate:minDepDate,maxDate:maxDepDate,selectCallback:function(selectedDate){var textYear=selectedDate.getFullYear()+"";
var textMonth=selectedDate.getMonth()+1;textMonth=("00"+textMonth).slice(-2);var textDate=selectedDate.getDate();textDate=("00"+textDate).slice(-2);$("#qs_dapl_ana_goDeptDt").val(textYear+textMonth+textDate);
$("#qs_dapl_ana_dep_cal_mon").val(textYear+textMonth);$("#qs_dapl_ana_dep_cal_day").val(selectedDate.getDate());var tomorrow=new Date(selectedDate);if(tomorrow<maxDepDate){tomorrow.setDate(tomorrow.getDate()+1);
}var arrTextYear=tomorrow.getFullYear()+"";var arrTextMonth=tomorrow.getMonth()+1;arrTextMonth=("00"+arrTextMonth).slice(-2);var arrTextDate=tomorrow.getDate();arrTextDate=("00"+arrTextDate).slice(-2);
$("#qs_dapl_ana_rtnDeptDt").val(arrTextYear+arrTextMonth+arrTextDate);$("#qs_dapl_ana_arr_cal_mon").val(arrTextYear+arrTextMonth);$("#qs_dapl_ana_arr_cal_day").val(tomorrow.getDate());$hdnArrDate.val([tomorrow.getFullYear(),tomorrow.getMonth()+1,tomorrow.getDate()].join("/"));
$hdnArrDate.datepicker("setDate",tomorrow);var minArrDateText=tomorrow.getFullYear()+"/"+(tomorrow.getMonth()+1)+"/"+tomorrow.getDate();var dayOfWeek=tomorrow.getDay();var week=conf.calender.dayNames[dayOfWeek];
minArrDateText+="（"+week+"）";$viewArrDate.html('<span class="ico01 iCal"></span><span class="func on">'+minArrDateText+"</span>");}});var minArrDate=new Date($minArrDate.val());var maxArrDate=new Date(nowDate.getFullYear(),nowDate.getMonth()+(conf.dapl.ana.arrLimitMonth+1),0);
bindDatePicker({hdnDate:$hdnArrDate,viewDate:$viewArrDate,minDate:minArrDate,maxDate:maxArrDate,selectCallback:function(selectedDate){var textYear=selectedDate.getFullYear()+"";var textMonth=selectedDate.getMonth()+1;
textMonth=("00"+textMonth).slice(-2);var textDate=selectedDate.getDate();textDate=("00"+textDate).slice(-2);$("#qs_dapl_ana_rtnDeptDt").val(textYear+textMonth+textDate);$("#qs_dapl_ana_arr_cal_mon").val(textYear+textMonth);
$("#qs_dapl_ana_arr_cal_day").val(selectedDate.getDate());}});$("#qs_dapl_ana_numArea").find(".iPlus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();
val=val===""?0:val;var targetName=$targetNum.attr("name");if(val<conf.dapl.ana[targetName].max){val++;}$targetNum.val(val);});$("#qs_dapl_ana_numArea").find(".iMinus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");
var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("name");var min=0;if(val>conf.dapl.ana[targetName].min){val--;}$targetNum.val(val);});},changedTabAirHotel:function(){}};return sub;
})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticairhotel_jal=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
var $mainArea=null;var $anaTab=null;var $nowDate=null;var $viewDepDate=null;var $hdnDepDate=null;var $minDepDate=null;var $viewArrDate=null;var $hdnArrDate=null;var $minArrDate=null;array_airarea={"AGJ":"47","AKJ":"01","AOJ":"02","ASJ":"46","AXT":"05","CTS":"01","FKS":"07","FUK":"40","GAJ":"06","HIJ":"34","HKD":"01","HNA":"03","HND":"13","HTR":"47","ISG":"47","ITM":"27","IZO":"32","KCZ":"39","KIJ":"17","KIX":"27","KJP":"47","KKJ":"40","KKX":"46","KMI":"45","KMJ":"43","KMQ":"19","KOJ":"46","KTD":"47","KUH":"01","KUM":"46","MBE":"01","MMB":"01","MMD":"47","MMJ":"16","MMY":"47","MSJ":"02","MYJ":"38","NGO":"23","NGS":"42","NKM":"23","NRT":"12","OBO":"01","OGN":"47","OIT":"44","OKA":"47","OKD":"01","OKE":"46","OKI":"32","OKJ":"33","RNJ":"46","SDJ":"04","SHM":"30","CTS":"01","TAK":"37","TJH":"28","TKN":"46","TKS":"36","TNE":"46","TOY":"18","TRA":"47","UBJ":"35","UEO":"47","UKB":"28","NGY":"23","OSA":"27","FSZ":"21"};
function setPeriod(t){var periodNum=parseInt($("#qs_dapl_jal_numArea").find("input[name=nights]").val());var depDate=new Date($hdnDepDate.val());var arrDate=new Date($hdnArrDate.val());var setPeriod=(arrDate.getTime()-depDate.getTime())/86400000;
if(t.hasClass("iPlus")){if(periodNum<conf.dapl.jal.nights.max&&periodNum<setPeriod){periodNum++;}}else{if(setPeriod>conf.dapl.jal.nights.max){periodNum=conf.dapl.jal.nights.max;}else{if(setPeriod<conf.dapl.jal.nights.min){periodNum=conf.dapl.jal.nights.min;
}else{periodNum=setPeriod;}}}$("#qs_dapl_jal_numArea").find("input[name=nights]").val(periodNum);}function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';
var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");
$(this).addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);$thisToggleArea.hide();});}function bindDatePicker(option){var $hdnDate=option.hdnDate;var $viewDate=option.viewDate;
var minDate=option.minDate;var maxDate=option.maxDate;$hdnDate.datepicker("destroy");$hdnDate.datepicker({minDate:minDate,maxDate:maxDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$viewDate.offset().top+$viewDate.height(),left:$mainArea.offset().left+($mainArea.width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var selectedDateText=selectedDate.getFullYear()+"/"+(selectedDate.getMonth()+1)+"/"+selectedDate.getDate();var dayOfWeek=selectedDate.getDay();
var week=conf.calender.dayNames[dayOfWeek];selectedDateText+="（"+week+"）";$viewDate.html('<span class="ico01 iCal"></span><span class="func on">'+selectedDateText+"</span>");if(option.selectCallback){option.selectCallback(selectedDate);
}}});$viewDate.off("click").on("click",function(){$hdnDate.datepicker("show");});}function getDaplArea(cd){var ajaxOption=$.extend(true,{},conf.ajax);cd+="";if(cd.length>2){cd=cd.substr(0,2);}ajaxOption.url=conf.dapl.jal.pref_area_js_path+cd;
ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){var jsfunc=" (function(){ "+data;jsfunc+=" function yj_travel_reloadarea(){} ";jsfunc+=" return array_larea; })(); ";var lAreaData=eval(jsfunc);
var html="<ul>";for(var i=0;i<lAreaData.length;i+=2){var css_clazz="";if(i===0){html+='<input type="hidden" id="qs_dapl_jal_pref" name="stay_area_cd" value="'+lAreaData[0]+'"></input>';css_clazz=' class="selected" ';
$("#qs_dapl_jal_mAreaView").html(lAreaData[1]+'<span class="ico01 iArrowMore"></span>');}html+="<li"+css_clazz+' data-qs-val="'+lAreaData[i]+'">'+'<a href="javascript:void(0);">'+lAreaData[i+1]+"</a>"+"</li>";
}html+="</ul>";$("#qs_dapl_jal_mArea").html(html);bindSelectToggleArea($("#qs_dapl_jal_mArea li"));};ajaxOption.dataType="text";$.ajax(ajaxOption);}var sub={init:function(){$mainArea=$("#qs_dapl_jal_main");
$anaTab=$("#qs_dapl_jal_ana_tab");$nowDate=$("#qs_dapl_jal_now_cal_val");$viewDepDate=$("#qs_dapl_jal_dep_cal_view");$hdnDepDate=$("#qs_dapl_jal_dep_cal_val");$minDepDate=$("#qs_dapl_jal_dep_cal_min");
$viewArrDate=$("#qs_dapl_jal_arr_cal_view");$hdnArrDate=$("#qs_dapl_jal_arr_cal_val");$minArrDate=$("#qs_dapl_jal_arr_cal_min");YAHOO.JP.trv.qs.domesticairhotel_jal.bind();getDaplArea($("#qs_dapl_jal_pref").val());
},bind:function(){$anaTab.off("click").on("click",function(){YAHOO.JP.trv.qs.domesticairhotel.renderTabHtml(1);});$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");
if($toggleArea.data("qs-status")==="off"){return;}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");
$toggleArea.show();$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");
bindOutsideHide(id);});});bindSelectToggleArea($mainArea.find(".jsToggleTarget li"));$("#qs_dapl_jal_gFrom").find("li").on("click",function(){$("#qs_dapl_jal_bToView").html($(this).find("a").text()+'<span class="ico01 iArrowMore"></span>');
$("#qs_dapl_jal_bToVal").val($(this).data("qs-val"));});$("#qs_dapl_jal_gTo").find("li").on("click",function(){var selectedVal=$(this).data("qs-val");$("#qs_dapl_jal_bFrom").find("li[data-qs-val="+selectedVal+"]").trigger("click");
$("#qs_dapl_jal_lArea").find("li[data-qs-val="+(array_airarea[selectedVal]+"0000")+"]").trigger("click");});$("#qs_dapl_jal_lArea").find("li").on("click",function(){getDaplArea($(this).data("qs-val"));
});var minDepDate=new Date($minDepDate.val());var nowDate=new Date($nowDate.val());var maxDepDate=new Date(nowDate.getFullYear(),nowDate.getMonth(),nowDate.getDate()+conf.dapl.jal.depLimitDay);bindDatePicker({hdnDate:$hdnDepDate,viewDate:$viewDepDate,minDate:minDepDate,maxDate:maxDepDate,selectCallback:function(selectedDate){var textMonth=(selectedDate.getMonth()+1);
$("#qs_dapl_jal_dep_cal_mon").val(textMonth);$("#qs_dapl_jal_stay_mon").val(textMonth);$("#qs_dapl_jal_dep_cal_day").val(selectedDate.getDate());$("#qs_dapl_jal_stay_day").val(selectedDate.getDate());var tomorrow=new Date(selectedDate);
tomorrow.setDate(tomorrow.getDate()+1);var arrTextMonth=(tomorrow.getMonth()+1);$("#qs_dapl_jal_arr_cal_mon").val(arrTextMonth);$("#qs_dapl_jal_arr_cal_day").val(tomorrow.getDate());$hdnArrDate.val([tomorrow.getFullYear(),tomorrow.getMonth()+1,tomorrow.getDate()].join("/"));
$hdnArrDate.datepicker("setDate",tomorrow);var selectedDateText=tomorrow.getFullYear()+"/"+(tomorrow.getMonth()+1)+"/"+tomorrow.getDate();var dayOfWeek=tomorrow.getDay();var week=conf.calender.dayNames[dayOfWeek];
selectedDateText+="（"+week+"）";$viewArrDate.html('<span class="ico01 iCal"></span><span class="func on">'+selectedDateText+"</span>");setPeriod($(this));}});var minArrDate=new Date($minArrDate.val());var maxArrDate=new Date(nowDate.getFullYear(),nowDate.getMonth(),nowDate.getDate()+conf.dapl.jal.arrLimitDay);
bindDatePicker({hdnDate:$hdnArrDate,viewDate:$viewArrDate,minDate:minArrDate,maxDate:maxArrDate,selectCallback:function(selectedDate){var textMonth=(selectedDate.getMonth()+1);$("#qs_dapl_jal_arr_cal_mon").val(textMonth);
$("#qs_dapl_jal_arr_cal_day").val(selectedDate.getDate());setPeriod($(this));}});$("#qs_dapl_jal_numArea").find(".iPlus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");
var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("name");if(targetName=="nights"){setPeriod($(this));}else{if(val<conf.dapl.jal[targetName].max){val++;}$targetNum.val(val).change();
}});$("#qs_dapl_jal_numArea").find(".iMinus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("name");
if(val>conf.dapl.jal[targetName].min){val--;}$targetNum.val(val).change();});$("#qs_dapl_jal_form [name=adult_num]").off("change").on("change",function(){$("#qs_dapl_jal_form [name=stay_adult_num]").val($(this).val());
});$("#qs_dapl_jal_form [name=senior_num]").off("change").on("change",function(){$("#qs_dapl_jal_form [name=stay_senior_num]").val($(this).val());});$("#qs_dapl_jal_form [name=child_num]").off("change").on("change",function(){$("#qs_dapl_jal_form [name=stay_child_num]").val($(this).val());
$("#qs_dapl_jal_form [name=room_child_num1]").val($(this).val());});$("#qs_dapl_jal_form [name=baby_num]").off("change").on("change",function(){$("#qs_dapl_jal_form [name=stay_baby_num]").val($(this).val());
});},changedTabAirHotel:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};var BT_L_AREA_MST=BT_L_AREA_MST||null;var BT_M_AREA_MST=BT_M_AREA_MST||null;YAHOO.JP.trv.qs.domesticlodging=(function($,conf){var _bucketId="";
var SEARCH_PARAM={ci:true,co:true,rm:true,adlt:true,chelem:true,bbyboth:true,melonly:true,ftnonly:true,bbynthr:true,llcd:true,prfcd:true,lcd:true,mcd:true,sgttyp:true,sgtcd:true,sgtnm:true,qry:true,sc_i:true};
var sub={init:function(bucketId){if(bucketId){_bucketId=bucketId;}this.bind();$(".searchBtn .submitNormal").removeAttr("disabled");},bind:function(){$("#qs_dl_submit").off("click").on("click",function(){return YAHOO.JP.trv.qs.domesticlodging.submit();
});$("#setNoDate_01").change(function(){$("#qs_checkinDate").toggle();$("#qs_checkoutDate").toggle();$("#qs_detail_room_person").toggle();$("#qs_detail_search_icon").toggle();$("#qs_checkinDate_not_determin").toggle();
$("#qs_checkoutDate_not_determin").toggle();$("#qs_detail_room_person_not_determin").toggle();if($("#qs_roomperson_area.disable")[0]){$("#qs_roomperson_area.disable").removeClass("disable");}else{$("#qs_roomperson_area").addClass("disable");
}});},changedTab:function(){},submit:function(){var url=conf.dd.rootUrl;var seo_path="";var $submitForm=$("#hotelSearch");var $mcd=$submitForm.find("input[name=mcd]"),$lcd=$submitForm.find("input[name=lcd]"),$prfcd=$submitForm.find("input[name=prfcd]"),$llcd=$submitForm.find("input[name=llcd]");
$("#qs_noResultArea").hide();$("#qs_popularResultArea").hide();$("#qs_freewordResultArea").hide();var $notDeterminChk=$("#setNoDate_01");if($notDeterminChk.prop("checked")){$submitForm.find("input[name=ci]").val("");
$submitForm.find("input[name=co]").val("");$submitForm.find("input[name=rm]").val("");$submitForm.find("input[name=adlt]").val("");$submitForm.find("input[name=chelem]").val("");$submitForm.find("input[name=bbyboth]").val("");
$submitForm.find("input[name=melonly]").val("");$submitForm.find("input[name=ftnonly]").val("");$submitForm.find("input[name=bbynthr]").val("");}if($submitForm.find("input[name=sgttyp]").val()!==""){$mcd.val("");
$lcd.val("");$prfcd.val("");$llcd.val("");$submitForm.find("input[name=qry]").val("");seo_path=createSuggestPath($submitForm.find("input[name=sgttyp]").val(),$submitForm.find("input[name=sgtcd]").val());
}else{if($("#qs_freewordText").val()!==""){$submitForm.find("input[name=qry]").val($("#qs_freewordText").val());$mcd.val("");$lcd.val("");$prfcd.val("");$llcd.val("");seo_path="search/";}else{if($mcd.val()!==""){seo_path=conf.area["MC"]+"/"+$mcd.val()+"/";
$lcd.val("");$prfcd.val("");$llcd.val("");}else{if($lcd.val()!==""){seo_path=conf.area["LC"]+"/"+$lcd.val()+"/";$prfcd.val("");$llcd.val("");}else{if($prfcd.val()!==""){seo_path=conf.area["KC"]+"/"+$prfcd.val()+"/";
}else{if($llcd.val()!==""){seo_path=conf.area["LL"]+"/"+$llcd.val()+"/";}}}}}}$("#hotelSearch input, #hotelSearch select").each(function(){var val=$(this).val();if(val===null||val===""){$(this).prop("disabled",true);
}if(!SEARCH_PARAM[$(this).attr("name")]){$(this).prop("disabled",true);}});$submitForm.attr("action",url+seo_path);$submitForm.submit();}};function createSuggestPath(type,cd){return conf.area[type]+"/"+cd+"/";
}return sub;})(jQuery,$.extend({},YAHOO.JP.trv.qs.conf,true));var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};var BT_L_AREA_MST=BT_L_AREA_MST||null;var BT_M_AREA_MST=BT_M_AREA_MST||null;YAHOO.JP.trv.qs.domesticlodging_area=(function($,conf){var L_MASTER={};
var M_MASTER={};var llPrefArea=$.extend({},YAHOO.JP.trv.qs.control.DDL,{id:"#qs_llpref",viewid:"#qs_llpref_view",hdnLLName:"input[name=llcd]",hdnPrefName:"input[name=prfcd]",onClick:function($this){this.hide();
lArea.hide();mArea.hide();var hdnVal="";var qsType=this.qsType($this);if(qsType==="ll"){hdnVal=$(this.hdnLLName).val();}else{hdnVal=$(this.hdnPrefName).val();}var qsVal=this.qsVal($this);if(qsVal===hdnVal){return;
}lArea.reset().disable();mArea.reset().disable();if(qsType==="ll"){$(this.hdnLLName).val(qsVal).change();$(this.hdnPrefName).val("").change();}else{if(qsType==="pref"){lArea.enable();$(this.hdnPrefName).val(qsVal).change();
$(this.hdnLLName).val("").change();lArea.makeDOM(qsVal);mArea.makeDOM("");}}}});var lArea=$.extend({},YAHOO.JP.trv.qs.control.DDL,{id:"#qs_l",viewid:"#qs_l_view",hdnName:"input[name=lcd]",onClick:function($this){llPrefArea.hide();
lArea.hide();mArea.hide();var qsType=this.qsType($this);if(qsType===$(this.hdnName).val()){return;}var code=this.qsVal($this);if(code!=null){mArea.reset().enable();$(this.hdnName).val(code).change();mArea.makeDOM(code);
}else{lArea.reset();mArea.reset().disable();$(this.hdnName).change();$("input[name=mcd]").change();}},makeDOM:function(code){var ldata=L_MASTER[code];var li='<li class="selected"><a href="javascript:void(0);">指定なし</a></li>';
if(ldata!=null){for(var i=0;i<ldata.length;i++){var data=ldata[i];if(data.name){li+='<li data-qs-val="'+data.code+'" data-qs-neighbor-code="'+data.neighbor.code+'"><a href="javascript:void(0);">'+data.name+"</a></li>";
}}}$(this.id).find("ul").remove("li");$(this.id).find("ul").html(li);this.bind();}});var mArea=$.extend({},YAHOO.JP.trv.qs.control.DDL,{id:"#qs_m",viewid:"#qs_m_view",hdnName:"input[name=mcd]",onClick:function($this){$(this.hdnName).val(this.qsVal($this)).change();
},makeDOM:function(code){this.create_qs_m(code);$("#qs_m").on("change",function(){var list=$("#qs_m").find("[val]:checked"),disp=list.map(function(){return $(this).attr("disp");}).get(),val=list.map(function(){return $(this).attr("val");
}).get(),msg="指定なし",value="";if(disp.length>1){msg=disp[0]+"... 他";value=val.join(",");}else{if(disp.length==1){msg=disp[0];value=val[0];}}$("#qs_m_view")[0].innerHTML=msg+'<span class="ico01 iArrowMore"></span>';
$("input[name=mcd]").val(value);});},create_qs_m:function(code){var mdata=M_MASTER[code];var li=$('<li><input type="checkbox" id="" val="" disp=""><label for=""></label></li>');if(mdata!=null){$(this.id).find("ul").find("li").remove();
for(var i=0;i<mdata.length;i++){var data=mdata[i];if(data.name){var clone_li_tmp=li.clone();var input_tag=clone_li_tmp.find("input");input_tag.attr("id","checkbox"+i);input_tag.attr("val",data.code);input_tag.attr("disp",data.name);
var label_tag=clone_li_tmp.find("label");label_tag.attr("for","checkbox"+i);clone_li_tmp[0].getElementsByTagName("label")[0].innerHTML=data.name;$(this.id).find("ul").append(clone_li_tmp);}}}}});$(document).on("click",function(e){var qs_m=$("#qs_m");
if(qs_m.css("display")!="none"){if(!$(e.target).closest("#qs_m").length){qs_m.hide();}}else{if(($(e.target).closest("#qs_m_view").length)&&($(e.target).closest("#qs_m_view")[0].classList[1]!="disable")){qs_m.show();
}}});return{init:function(){if(BT_L_AREA_MST){L_MASTER={};$.each(BT_L_AREA_MST,function(k,v){if(!L_MASTER[v.parentcode]){L_MASTER[v.parentcode]=[];}L_MASTER[v.parentcode].push({name:v.name,code:k,neighbor:v.neighbor});
});}if(BT_M_AREA_MST){M_MASTER={};$.each(BT_M_AREA_MST,function(k,v){if(!M_MASTER[v.parentcode]){M_MASTER[v.parentcode]=[];}M_MASTER[v.parentcode].push({name:v.name,code:k});});}this.bind();},bind:function(){llPrefArea.bind();
llPrefArea.clickFire();},disable:function(){llPrefArea.disable();lArea.disable();mArea.disable();},enable:function(){llPrefArea.enable();if(!$(llPrefArea.hdnLLName).val()){lArea.enable();if(lArea.selectedVal()){mArea.enable();
}}}};})(jQuery,$.extend({},YAHOO.JP.trv.qs.conf,true));var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticlodging_checkinout=(function($,conf){var _ci="input[name=ci]";var _co="input[name=co]";
var _hdnCheckinDate="#qs_checkinDate_tmp";var _hdnCheckoutDate="#qs_checkoutDate_tmp";var _viewCheckinDate="#qs_checkinDate";var _viewCheckoutDate="#qs_checkoutDate";var ymd=new Date();var yyyy=ymd.getFullYear();
var mm=toDoubleDigits(ymd.getMonth()+1);var dd=toDoubleDigits(ymd.getDate());var n_ymd=new Date(yyyy,ymd.getMonth(),ymd.getDate()+1);var n_yyyy=n_ymd.getFullYear();var n_mm=toDoubleDigits(n_ymd.getMonth()+1);
var n_dd=toDoubleDigits(n_ymd.getDate());var today=""+yyyy+mm+dd;var nextday=""+n_yyyy+n_mm+n_dd;function _setDateText(){var ciText="";var coText="";var ciVal=$(_ci).val();var coVal=$(_co).val();var formatDate=function(str){return str.substr(0,4)+"/"+YAHOO.JP.trv.qs.util.parseIntVal(str.substr(4,2))+"/"+YAHOO.JP.trv.qs.util.parseIntVal(str.substr(6,2));
};if(ciVal!==""&&ciVal.length===8){ciText=formatDate(ciVal);var dayOfWeek=(new Date(ciText)).getDay();var week=conf.calender.dayNames[dayOfWeek];ciText+="（"+week+"）";$(_viewCheckinDate).find(".func").text(ciText).removeClass("off").addClass("on");
}else{ciText=conf.dd.reset.dateText;$(_viewCheckinDate).find(".func").text(ciText).removeClass("on").addClass("off");}if(coVal!==""&&coVal.length===8){coText=formatDate(coVal);var dayOfWeek=(new Date(coText)).getDay();
var week=conf.calender.dayNames[dayOfWeek];coText+="（"+week+"）";$(_viewCheckoutDate).find(".func").text(coText).removeClass("off").addClass("on");}else{coText=conf.dd.reset.dateText;$(_viewCheckoutDate).find(".func").text(coText).removeClass("on").addClass("off");
}if(ciVal!==""&&coVal!==""&&today>=ciVal&&nextday>=coVal){$("#checkbox4_7").prop("disabled",false);}else{$("#checkbox4_7").prop("disabled",true);$("#checkbox4_7").prop("checked",false);}}function _bindToDate(fromDate){var tomorrow=new Date(fromDate);
tomorrow.setDate(tomorrow.getDate()+1);var limitDate=new Date(tomorrow);limitDate.setDate(limitDate.getDate()+(conf.dd.range.fromTo-1));_bindDatePicker($(_hdnCheckoutDate),$(_viewCheckoutDate),{minDate:tomorrow,maxDate:limitDate,onSelectCallback:function(dateText,inst){$(_co).val(dateText.split("/").join("")).change();
}});}function _bindDatePicker($jqObj,$view,option){var onSelectCallback=option.onSelectCallback;var datepickerOption={beforeShow:function(input,inst){if($("#qs_reset").is(":checked")){$("#qs_reset").prop("checked",false).change();
$("#qs_roomperson_area").removeClass("disable");}var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$view.offset().top+$view.height(),left:$(_area).offset().left+($(_area).width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var dayOfWeek=$(this).datepicker("getDate").getDay();var week=conf.calender.dayNames[dayOfWeek];$view.find(".func").text(dateText+"（"+week+"）");if(onSelectCallback){onSelectCallback(dateText,inst);
}_setDateText();}};if(option.minDate){datepickerOption.minDate=option.minDate;}if(option.maxDate){datepickerOption.maxDate=option.maxDate;}$jqObj.datepicker("destroy");$jqObj.datepicker(datepickerOption);
$view.off("click").on("click",function(){if($("#ui-datepicker-div").is(":visible")){$jqObj.datepicker("hide");return;}$jqObj.datepicker("show");});}function toDoubleDigits(num){num+="";if(num.length===1){num="0"+num;
}return num;}return{init:function(areaid){_area=areaid;_setDateText();this.bind();},bind:function(){var minChkinDate=new Date($("#qs_dl_nowDate").val());var maxChkinDate="";if(minChkinDate.getDate()<=1){maxChkinDate=new Date(minChkinDate.getFullYear()+2,minChkinDate.getMonth()-1,0);
}else{maxChkinDate=new Date(minChkinDate.getFullYear()+2,minChkinDate.getMonth(),0);}_bindDatePicker($(_hdnCheckinDate),$(_viewCheckinDate),{minDate:minChkinDate,maxDate:maxChkinDate,onSelectCallback:function(dateText,inst){var $ci=$(_ci),$co=$(_co),$hdnCheckoutDate=$(_hdnCheckoutDate);
var checkinDate=new Date(dateText);var checkoutDate=$hdnCheckoutDate.datepicker("getDate");_bindToDate(checkinDate);$ci.val(dateText.split("/").join("")).change();var diffDate=(checkoutDate-checkinDate)/86400000-1;
if(checkinDate>=checkoutDate||diffDate>=conf.dd.range.fromTo){var tomorrow=new Date(checkinDate);tomorrow.setDate(tomorrow.getDate()+1);$hdnCheckoutDate.val([tomorrow.getFullYear(),tomorrow.getMonth()+1,tomorrow.getDate()].join("/"));
$hdnCheckoutDate.datepicker("setDate",tomorrow);$co.val($hdnCheckoutDate.val().split("/").join("")).change();}}});_bindToDate($(_hdnCheckinDate).val());},isPendingSelect:function(){return $("#qs_reset").is(":checked");
},remove:function(){$(_ci).remove();$(_co).remove();},setDateText:function(){_setDateText();}};})(jQuery,$.extend({},YAHOO.JP.trv.qs.conf,true));var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticlodging_roomperson=(function($,conf){var _isChild=false;var _isDispBreakdown=false;
var _cpCode=null;var _beforeRoomNum=1;var _isDispTop=false;var _isHansoku=false;var _bucket_id="";var _roomPersonArea="#qs_roomperson_area";var _rm="input[name=rm]";var _adlt="input[name=adlt]";var _childa="input[name=chlda]";
var _childb="input[name=chldb]";var _childc="input[name=chldc]";var _childd="input[name=chldd]";var _childo="input[name=chldo]";var _roomNum="#qs_room_num";var _roomNumView="#qs_room_numView";var _roomPersonInputArea="#qs_detail_search_area";
var _dispPersonLabel="";var _dispPersonListLabel="利用人数";var _applyRoomPersonsCallback=null;var _chelem="input[name=chelem]";var _bbyboth="input[name=bbyboth]";var _melonly="input[name=melonly]";var _ftnonly="input[name=ftnonly]";
var _bbynthr="input[name=bbynthr]";var _childText_total="";var _childText_default="------";var _validatable=false;var _validateParam=null;var _areaId="";var _ci="input[name=ci]";var _co="input[name=co]";
var rmChangeDDL=$.extend({},YAHOO.JP.trv.qs.control.DDL,{id:"#qs_room_num",viewid:"#qs_room_numView",hdnName:"input[name=rm]",onClick:function($this){$(this.id).val(this.qsVal($this));}});var personChange={bind:function(id){$(id).find(".iPlus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");
var val=$targetNum.val();val=val===""?0:parseInt(val);if(_validatable){var count=val;var validate=true;if(_isChild){validate=false;var $adltInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_adltInput]");
var $childaInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childaInput]");var $childbInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childbInput]");var $childcInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childcInput]");
var $childdInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childdInput]");var $childoInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childoInput]");var target=$(this).parent().find("input").attr("data-name");
if(target=="qs_adltInput"){validate=true;}else{if(target=="qs_childaInput"&&_validateParam["childAincld"]){validate=true;}else{if(target=="qs_childbInput"&&_validateParam["childBincld"]){validate=true;
}else{if(target=="qs_childcInput"&&_validateParam["childCincld"]){validate=true;}else{if(target=="qs_childdInput"&&_validateParam["childDincld"]){validate=true;}else{if(target=="qs_childoInput"&&_validateParam["childOincld"]){validate=true;
}}}}}}if(validate){count=parseInt($adltInput.val());if(_validateParam["childAincld"]){count+=parseInt($childaInput.val());}if(_validateParam["childBincld"]){count+=parseInt($childbInput.val());}if(_validateParam["childCincld"]){count+=parseInt($childcInput.val());
}if(_validateParam["childDincld"]){count+=parseInt($childdInput.val());}if(_validateParam["childOincld"]){count+=parseInt($childoInput.val());}}}if((validate&&count>=_validateParam["pMax"])||(val>=conf.dd.person.max)){var errorTips=$(this).closest("dl.roomAssign").find(".errorTips");
errorTips.slideDown("fast",function(){var id=$(this).attr("id");YAHOO.JP.trv.qs.util.bindOutsideHide(id);$(".tipsClose").click(function(){$("#"+id).hide();});});}else{if(val<conf.dd.person.max){val++;}}}else{if(val<conf.dd.person.max){val++;
}}$targetNum.val(val);});$(id).find(".iMinus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("data-name");
var min=targetName==="qs_adltInput"?conf.dd.person.min_adlt:conf.dd.person.min_child;if(val>min){if(_validatable){var count=val;var validate=true;if(_isChild){validate=false;var $adltInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_adltInput]");
var $childaInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childaInput]");var $childbInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childbInput]");var $childcInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childcInput]");
var $childdInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childdInput]");var $childoInput=$(this).closest("dl.roomAssign").find("input[data-name=qs_childoInput]");var target=$(this).parent().find("input").attr("data-name");
if(!_validateParam["childAincld"]&&!_validateParam["childBincld"]&&!_validateParam["childCincld"]&&!_validateParam["childDincld"]&&!_validateParam["childOincld"]){if(target=="qs_adltInput"){validate=true;
}else{if(target=="qs_childaInput"&&_validateParam["childAincld"]){validate=true;}else{if(target=="qs_childbInput"&&_validateParam["childBincld"]){validate=true;}else{if(target=="qs_childcInput"&&_validateParam["childCincld"]){validate=true;
}else{if(target=="qs_childdInput"&&_validateParam["childDincld"]){validate=true;}else{if(target=="qs_childoInput"&&_validateParam["childOincld"]){validate=true;}}}}}}}if(validate){count=parseInt($adltInput.val());
if(_validateParam["childAincld"]){count+=parseInt($childaInput.val());}if(_validateParam["childBincld"]){count+=parseInt($childbInput.val());}if(_validateParam["childCincld"]){count+=parseInt($childcInput.val());
}if(_validateParam["childDincld"]){count+=parseInt($childdInput.val());}if(_validateParam["childOincld"]){count+=parseInt($childoInput.val());}}}if(validate&&count<=_validateParam["pMin"]){var errorTips=$(this).closest("dl.roomAssign").find(".errorTips");
errorTips.slideDown("fast",function(){var id=$(this).attr("id");YAHOO.JP.trv.qs.util.bindOutsideHide(id);$(".tipsClose").click(function(){$("#"+id).hide();});});}else{val--;}}else{val--;}}$targetNum.val(val);
});}};function _showRoomPersons(){var adltNums=$(_adlt).val().split(",");var childaNums=null;var childbNums=null;var childcNums=null;var childdNums=null;var childoNums=null;if(_isChild){childaNums=$(_childa).val().split(",");
childbNums=$(_childb).val().split(",");childcNums=$(_childc).val().split(",");childdNums=$(_childd).val().split(",");childoNums=$(_childo).val().split(",");}$(_roomNumView).html(($(_rm).val()===""?1:$(_rm).val())+'<span class="ico01 iArrowMore">');
var $roomArea=$("#qs_roomArea");var html="";for(var i=0;i<adltNums.length;i++){var roomData={adltNum:adltNums[i]};if(_isChild){roomData["childaNum"]=childaNums[i];roomData["childbNum"]=childbNums[i];roomData["childcNum"]=childcNums[i];
roomData["childdNum"]=childdNums[i];roomData["childoNum"]=childoNums[i];}html+=_makeRoomTemplate(i+1,roomData,_isChild);}$roomArea.html(html);rmChangeDDL.bind();personChange.bind(_roomPersonInputArea);
}function _showChildCheckbox(){var child_elem=$(_chelem).val();var baby_both=$(_bbyboth).val();var meal_only=$(_melonly).val();var futon_only=$(_ftnonly).val();var baby_nthr=$(_bbynthr).val();if(child_elem=="1"){$("#ch_elem").prop("checked",true);
}else{$("#ch_elem").prop("checked",false);}if(baby_both=="1"){$("#bby_both").prop("checked",true);}else{$("#bby_both").prop("checked",false);}if(meal_only=="1"){$("#mel_only").prop("checked",true);}else{$("#mel_only").prop("checked",false);
}if(futon_only=="1"){$("#ftn_only").prop("checked",true);}else{$("#ftn_only").prop("checked",false);}if(baby_nthr=="1"){$("#bby_nthr").prop("checked",true);}else{$("#bby_nthr").prop("checked",false);}_makeChildText();
}function _applyRoomPersons(){var $roomPersonInputArea=$(_roomPersonInputArea);var $adltInput=$roomPersonInputArea.find("input[data-name=qs_adltInput]");$(_rm).val($(_roomNum).val()).change();$(_adlt).val($adltInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(",")).change();if(!_isDispBreakdown){_applySearchChild();}if(_isChild){var $childaInput=$roomPersonInputArea.find("input[data-name=qs_childaInput]");var $childbInput=$roomPersonInputArea.find("input[data-name=qs_childbInput]");
var $childcInput=$roomPersonInputArea.find("input[data-name=qs_childcInput]");var $childdInput=$roomPersonInputArea.find("input[data-name=qs_childdInput]");var $childoInput=$roomPersonInputArea.find("input[data-name=qs_childoInput]");
$(_childa).val($childaInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));$(_childb).val($childbInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));$(_childc).val($childcInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));$(_childd).val($childdInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));$(_childo).val($childoInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));}_setRoomText();$(_roomPersonInputArea).hide();$("#child_notice_modal").hide();
}function _applySearchChild(){if($("#ch_elem").prop("checked")){$(_chelem).val(1);}else{$(_chelem).val("");}if($("#bby_both").prop("checked")){$(_bbyboth).val(1);}else{$(_bbyboth).val("");}if($("#mel_only").prop("checked")){$(_melonly).val(1);
}else{$(_melonly).val("");}if($("#ftn_only").prop("checked")){$(_ftnonly).val(1);}else{$(_ftnonly).val("");}if($("#bby_nthr").prop("checked")){$(_bbynthr).val(1);}else{$(_bbynthr).val("");}}function _setRoomText(){var roomNum=0;
var adltNum=0;roomNum=$(_rm).val()?$(_rm).val():1;if((roomNum>=2&&_cpCode==="004")||(_cpCode==="006")){$("#ikome_ikyu").show();}var $anchor=$("#qs_detail_search_anchor");if($anchor.is(".off")){return;}var roomCount=function($jqObj){var total=0;
$.each($jqObj.val().split(","),function(k,v){try{total+=isNaN(YAHOO.JP.trv.qs.util.parseIntVal(v))?0:YAHOO.JP.trv.qs.util.parseIntVal(v);}catch(e){}});return total;};adltNum=roomCount($(_adlt));adltNum=adltNum===0?2:adltNum;
_makeChildText();var html="";if(_isChild){var childNum=0;childNum=(function(){var total=0;total+=roomCount($(_childa));total+=roomCount($(_childb));total+=roomCount($(_childc));total+=roomCount($(_childd));
total+=roomCount($(_childo));return total;})();html="<span>"+roomNum+"部屋</span>大人"+adltNum+"名&nbsp;子ども"+childNum+"名</span>";}else{if($(_adlt).val()!==""){if(!_isDispBreakdown&&!_isHansoku){var childStrNum=_getChildStrNum((roomNum+adltNum).length);
html="<span>"+roomNum+"部屋・"+_dispPersonLabel+adltNum+"名・"+_childText_total.slice(0,childStrNum)+"</span>";}else{html="<span>"+roomNum+"部屋</span>"+_dispPersonLabel+adltNum+"名</span>";}}else{html="<span>"+conf.dd.reset.dateText+"</span>";
}}$anchor.html(html);}function _roomAreaClickableCheck(enabled){var $rm=$(_rm);var $adlt=$(_adlt);var $childa=$(_childa);var $childb=$(_childb);var $childc=$(_childc);var $childd=$(_childd);var $childo=$(_childo);
if(enabled){$("#qs_roomperson_area").removeClass("disable");$("#qs_detail_search_anchor").removeClass("off").addClass("on");$("#qs_checkoutDate > span.func").removeClass("off").addClass("on");if($adlt.val()===""&&$adlt.val()===""){$rm.val(1);
$adlt.val(2);}var tmpRmVal=$rm.data("qs-tmp-val");if(tmpRmVal){$rm.val(tmpRmVal);}var tmpAdltVal=$adlt.data("qs-tmp-val");if(tmpAdltVal){$adlt.val(tmpAdltVal);}var tmpChelemVal=$(_chelem).data("qs-tmp-val");
if(tmpChelemVal){$(_chelem).val(tmpChelemVal);}var tmpBbybothVal=$(_bbyboth).data("qs-tmp-val");if(tmpBbybothVal){$(_bbyboth).val(tmpBbybothVal);}var tmpMelonlyVal=$(_melonly).data("qs-tmp-val");if(tmpMelonlyVal){$(_melonly).val(tmpMelonlyVal);
}var tmpFtnonlyVal=$(_ftnonly).data("qs-tmp-val");if(tmpFtnonlyVal){$(_ftnonly).val(tmpFtnonlyVal);}var tmpBbynthrVal=$(_bbynthr).data("qs-tmp-val");if(tmpBbynthrVal){$(_bbynthr).val(tmpBbynthrVal);}if(_isChild){var tmpChildaVal=$childa.data("qs-tmp-val");
if(tmpChildaVal){$childa.val(tmpChildaVal);}var tmpChildbVal=$childb.data("qs-tmp-val");if(tmpChildbVal){$childb.val(tmpChildbVal);}var tmpChildcVal=$childc.data("qs-tmp-val");if(tmpChildcVal){$childc.val(tmpChildcVal);
}var tmpChilddVal=$childd.data("qs-tmp-val");if(tmpChilddVal){$childd.val(tmpChilddVal);}var tmpChildoVal=$childo.data("qs-tmp-val");if(tmpChildoVal){$childo.val(tmpChildoVal);}}_setRoomText();}else{$("#qs_roomperson_area").addClass("disable");
$("#qs_detail_search_anchor").html("<span>"+conf.dd.reset.dateText+"</span>");$("#qs_detail_search_anchor").removeClass("on").addClass("off");$("#qs_checkoutDate > span.func").removeClass("on").addClass("off");
$rm.data("qs-tmp-val",$rm.val()).val("");$adlt.data("qs-tmp-val",$adlt.val()).val("");$(_chelem).data("qs-tmp-val",$(_chelem).val()).val("");$(_bbyboth).data("qs-tmp-val",$(_bbyboth).val()).val("");$(_melonly).data("qs-tmp-val",$(_melonly).val()).val("");
$(_ftnonly).data("qs-tmp-val",$(_ftnonly).val()).val("");$(_bbynthr).data("qs-tmp-val",$(_bbynthr).val()).val("");if(_isChild){$childa.data("qs-tmp-val",$childa.val()).val("");$childb.data("qs-tmp-val",$childb.val()).val("");
$childc.data("qs-tmp-val",$childc.val()).val("");$childd.data("qs-tmp-val",$childd.val()).val("");$childo.data("qs-tmp-val",$childo.val()).val("");}}}function _disable(){_setRoomText();_roomAreaClickableCheck(false);
}function _enable(){_roomAreaClickableCheck(true);_setRoomText();}function _makeChildText(){_childText_total="";if($("#ch_elem").prop("checked")){_childText_total="小学生、";}if($("#bby_both").prop("checked")){_childText_total+="幼児（食事・布団あり）、";
}if($("#mel_only").prop("checked")){_childText_total+="幼児（食事あり・布団なし）、";}if($("#ftn_only").prop("checked")){_childText_total+="幼児（布団あり・食事なし）、";}if($("#bby_nthr").prop("checked")){_childText_total+="幼児（食事・布団なし）、";
}if(_childText_total==""){_childText_total=_childText_default;}else{_childText_total=_childText_total.slice(0,_childText_total.length-1);}}function _getChildStrNum(strnum){var ret=0;var max_num=6;if(_childText_total==_childText_default){ret=max_num;
if(strnum>=3&&_isDispTop){ret=max_num-(strnum-1);}}else{if(_isDispTop){if(strnum==2){ret=4;}else{if(strnum==3){ret=3;}else{if(strnum==4||strnum==5){ret=2;}}}ret=ret-1;}else{if(strnum==2||strnum==3){ret=4;
}else{if(strnum==4||strnum==5){ret=3;}}}}return ret;}function _outsideHide(id){$(document).off("click.body").on("click.body",function(e){var target=$("#"+id);var child_modal=$("#child_notice_modal");if(target.is(":hidden")||target.is(":animated")){$(document).off("click."+id);
return;}if($("#child_notice_modal").is(":hidden")&&$("#child_notice_modal").attr("cmp")!=="1"){if(!target.is(e.target)&&target.has(e.target).length===0){$(target).hide();$(document).off("click."+id);_showChildCheckbox();
}}else{if(!(child_modal).is(e.target)&&!target.is(e.target)&&child_modal.has(e.target).length===0&&target.has(e.target).length===0){$("#child_notice_modal").hide();$(document).off("click."+id);}}});}function _makeRoomTemplate(idx,roomData,isChild){var roomHtml="";
if(_validatable&&(!_validateParam["childA"]&&!_validateParam["childB"]&&!_validateParam["childC"]&&!_validateParam["childD"]&&!_validateParam["childO"])){isChild=false;}if(isChild&&_validatable){roomHtml='<dl class="roomAssign">'+'<div id="errorTips'+(idx)+'" class="errorTips" style="display:none;left:76px;">ご指定の人数は設定できません。<a class="tipsClose" href="javascript:void(0);">×</a></div>'+"<dt>"+(idx)+"部屋目</dt>"+'<dd class="cf">'+'<label class="mdKeyNumber cf">大人'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_adltInput" type="text" value="'+(roomData.adltNum?roomData.adltNum:1)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf">小学生'+'<span class="control cf">'+(_validateParam["childA"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childaInput" type="text" value="'+(roomData.childaNum?roomData.childaNum:0)+'" readonly="readonly"'+(_validateParam["childA"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childA"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+"</dd>"+"<dd>"+'<dl class="baby cf">'+"<dt>幼児</dt>"+'<dd class="cf">'+'<label class="mdKeyNumber cf'+(_validateParam["childB"]?"":" disable")+'">食事・布団あり'+'<span class="control cf">'+(_validateParam["childB"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childbInput" type="text" value="'+(roomData.childbNum?roomData.childbNum:0)+'"  readonly="readonly"'+(_validateParam["childB"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childB"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+'<label class="mdKeyNumber cf'+(_validateParam["childO"]?"":" disable")+'">食事あり'+'<span class="control cf">'+(_validateParam["childO"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childoInput" type="text" value="'+(roomData.childoNum?roomData.childoNum:0)+'"  readonly="readonly"'+(_validateParam["childO"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childO"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+'<label class="mdKeyNumber cf'+(_validateParam["childC"]?"":" disable")+'">布団あり'+'<span class="control cf">'+(_validateParam["childC"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childcInput" type="text" value="'+(roomData.childcNum?roomData.childcNum:0)+'"  readonly="readonly"'+(_validateParam["childC"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childC"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+'<label class="mdKeyNumber cf'+(_validateParam["childD"]?"":" disable")+'">食事・布団なし'+'<span class="control cf">'+(_validateParam["childD"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childdInput" type="text" value="'+(roomData.childdNum?roomData.childdNum:0)+'"  readonly="readonly"'+(_validateParam["childD"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childD"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+"</dd>"+"</dl>"+"</dd>"+"</dl>";
}else{if(isChild){roomHtml='<dl class="roomAssign">'+"<dt>"+(idx)+"部屋目</dt>"+'<dd class="cf">'+'<label class="mdKeyNumber cf">大人'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_adltInput" type="text" value="'+(roomData.adltNum?roomData.adltNum:1)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf">小学生'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childaInput" type="text" value="'+(roomData.childaNum?roomData.childaNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+"</dd>"+"<dd>"+'<dl class="baby cf">'+"<dt>幼児</dt>"+'<dd class="cf">'+'<label class="mdKeyNumber cf">食事・布団あり'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childbInput" type="text" value="'+(roomData.childbNum?roomData.childbNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+'</label class="cf">'+'<label class="mdKeyNumber cf">食事あり'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childoInput" type="text" value="'+(roomData.childoNum?roomData.childoNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf">布団あり'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childcInput" type="text" value="'+(roomData.childcNum?roomData.childcNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf">食事・布団なし'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childdInput" type="text" value="'+(roomData.childdNum?roomData.childdNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+"</dd>"+"</dl>"+"</dd>"+"</dl>";
}else{roomHtml='<dl class="roomAssign">'+'<div id="errorTips'+(idx)+'" class="errorTips" style="display:none;left:76px;">ご指定の人数は設定できません。<a class="tipsClose" href="javascript:void(0);">×</a></div>'+"<dt>"+(idx)+"部屋目</dt>"+'<dd class="cf">'+'<label class="mdKeyNumber cf">'+_dispPersonListLabel+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_adltInput" type="text" value="'+(roomData.adltNum?roomData.adltNum:1)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+"</dd>"+"</dl>";
}}return roomHtml;}function _makeChildCheckbox(){var childCheckbox="";childCheckbox='<div class="mdPullDown_Child">'+'<div class="inner">'+'<p class="title">子どもの宿泊条件で絞り込む</p>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="ch_elem">'+'<input type="checkbox" id="ch_elem" class="checkRegular" value="1">'+'<span class="checkbox"></span>小学生</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="bby_both">'+'<input type="checkbox" id="bby_both" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（食事・布団あり）</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="mel_only">'+'<input type="checkbox" id="mel_only" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（食事あり・布団なし）</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="ftn_only">'+'<input type="checkbox" id="ftn_only" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（布団あり・食事なし）</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="bby_nthr">'+'<input type="checkbox" id="bby_nthr" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（食事・布団なし）</label>'+"</div><!-- /.inner -->"+"</div><!-- /.mdPullDown_Child -->";
return childCheckbox;}return{init:function(isChild,isDispBreakdown,isDispTop,isHansoku,bucket_id){if(isChild){_isChild=isChild;}_cpCode=$("#qs_cp_cd").val();_isHansoku=isHansoku;if(isDispBreakdown){_isDispBreakdown=isDispBreakdown;
_dispPersonLabel="大人";_dispPersonListLabel="大人";}else{if(!_isHansoku){_dispPersonListLabel="大人人数";}}_isDispTop=isDispTop;if(bucket_id){_bucket_id=bucket_id;}this.bind();$qsReset=$("#qs_reset");if($(_ci).val()===""&&$(_co).val()===""){if($qsReset.is(":not(:checked)")){$qsReset.prop("checked",true).change();
}}else{if($qsReset.is(":checked")){$("#qs_reset").prop("checked",false).change();}}var $rm=$(_rm);_beforeRoomNum=$rm.val()?$rm.val():1;if(YAHOO.JP.trv.qs.domesticlodging_checkinout){if(YAHOO.JP.trv.qs.domesticlodging_checkinout.isPendingSelect()){_disable();
}else{if(!isHansoku){_showChildCheckbox();}_setRoomText();}}},bind:function(){$("#qs_detail_room_person").off("click").on("click",function(){if($("#qs_reset").is(":checked")){$("#qs_reset").prop("checked",false).change();
$("#qs_roomperson_area").removeClass("disable");}if($("#child_notice_modal").is(":visible")){$(_roomPersonInputArea).hide();$("#child_notice_modal").hide();return;}_beforeRoomNum=YAHOO.JP.trv.qs.util.parseIntVal($(_rm).val())?YAHOO.JP.trv.qs.util.parseIntVal($(_rm).val()):1;
$("#qs_room_num").val(_beforeRoomNum);_showRoomPersons();$(_roomPersonInputArea).slideDown("fast",function(){var id=$(this).attr("id");_outsideHide(id);}).find("li[data-qs-val="+_beforeRoomNum+"]").trigger("click");
});$("#qs_detail_search_closeBtn").off("click").on("click",function(){_showChildCheckbox();$(_roomPersonInputArea).hide();$("#child_notice_modal").hide();});$("#qs_applyRoomPersons").off("click").on("click",function(){_applyRoomPersons();
if(_applyRoomPersonsCallback){_applyRoomPersonsCallback();}});$("#qs_room_num").off("change").on("change",function(){var html="";var $roomArea=$("#qs_roomArea");var roomNum=YAHOO.JP.trv.qs.util.parseIntVal($(this).val());
if((roomNum>=2&&_cpCode==="004")||(_cpCode==="006")){$("#ikome_ikyu").show();}else{$("#ikome_ikyu").hide();}if(_beforeRoomNum<roomNum){for(var i=(_beforeRoomNum+1);i<=roomNum;i++){html+=_makeRoomTemplate(i,{adltNum:_validatable?_validateParam["pMin"]:1,childaNum:0,childbNum:0,childcNum:0,childdNum:0,childoNum:0},_isChild);
}$roomArea.append(html);rmChangeDDL.bind();personChange.bind(_roomPersonInputArea);}else{var resetVal=_beforeRoomNum-roomNum;for(var i=0;i<resetVal;i++){$roomArea.children().last().remove();}}_beforeRoomNum=roomNum;
});if(!_isHansoku){$("#qs_search_child").html(_makeChildCheckbox());}$("#qs_reset").off("change").on("change",function(){if($(this).is(":checked")){$(_areaId).hide();$(_ci).data("qs-tmp-val",$(_ci).val()).val("");
$(_co).data("qs-tmp-val",$(_co).val()).val("");_disable();if(YAHOO.JP.trv.qs.util.getBrowserName()=="firefox"){$(this).attr("checked",true);}}else{var ciValue=$(_ci).data("qs-tmp-val");var coValue=$(_co).data("qs-tmp-val");
if(!ciValue){ciValue=$("#qs_default_ci").val();}if(!coValue){coValue=$("#qs_default_co").val();}$(_ci).val(ciValue);$(_co).val(coValue);_enable();if(YAHOO.JP.trv.qs.util.getBrowserName()=="firefox"){$(this).removeAttr("checked");
}}YAHOO.JP.trv.qs.domesticlodging_checkinout.setDateText();});$("#child_notice_link").off("click").on("click",function(){if($("#child_notice_modal").is(":visible")){$("#child_notice_modal").hide();return;
}var offset=$(_roomPersonInputArea).position();$("#child_notice_modal").css("top",offset.top+45);$("#child_notice_modal").css("left",offset.left-282);$("#child_notice_modal").slideDown("fast");$("#child_notice_modal").attr("cmp","0");
var withCloseSelecter=".mdAreaFilter .jsToggleCtr"+", .mdMapStart"+", #qs_checkinDate"+", #qs_checkoutDate"+", #qs_freewordText"+", #sdc_morecondition_open"+", #qs_freewordReset"+", .mdFilter";var withCloser=$(withCloseSelecter);
withCloser.off("click.with_close").on("click.with_close",function(){withCloser.off("click.with_close");$(_roomPersonInputArea).hide();$("#child_notice_modal").hide();});});$("#child_notice_close").off("click").on("click",function(){$("#child_notice_modal").hide();
$("#child_notice_modal").attr("cmp","1");});},setRoomValue:function(){var $rm=$(_rm);var $adlt=$(_adlt);if($rm.val()===""){$rm.val(1);$adlt.val(2);}$(_chelem).val("");$(_bbyboth).val("");$(_melonly).val("");
$(_ftnonly).val("");$(_bbynthr).val("");_showChildCheckbox();_setRoomText();},remove:function(){var $rm=$(_rm);var $adlt=$(_adlt);var $childa=$(_childa);var $childb=$(_childb);var $childc=$(_childc);var $childd=$(_childd);
var $childo=$(_childo);$rm.remove();$adlt.remove();if(_isChild){$childa.remove();$childb.remove();$childc.remove();$childd.remove();$childo.remove();}$(_roomPersonArea).remove();},setApplyRoomPersonText:function(text){$("#qs_applyRoomPersons").text(text);
},applyRoomPersonsCallback:function(fn){_applyRoomPersonsCallback=fn;},validatable:function(bool){_validatable=bool;},setValidate:function(val){_validateParam=val;},_showChildCheckbox:_showChildCheckbox,_setRoomText:_setRoomText};
})(jQuery,$.extend({},YAHOO.JP.trv.qs.conf,true));var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticlodging_roomperson_ikyu=(function($,conf){var roomps=new YAHOO.JP.trv.common.roomperson();
roomps.init=function(param){this.param=param;this.DEFAULT_ROMMS="1";this.DEFAULT_ADLTS="2";this.proc();};roomps.proc=function(){this.setInput();var rm=this.param.room_e;this.beforeRoomNum=rm.val()?rm.val():1;
this.makeRoomDDL();this.makePersonChange();this.updateView();this.bindProc();};roomps.makeRoomDDL=function(){var param=this.param,room=param.room,roomnum=param.roomnum,roomnum_view=param.roomnum_view;this.roomDDL=$.extend({},YAHOO.JP.trv.qs.control.DDL,{id:roomnum,viewid:roomnum_view,hdnName:room,onClick:function($this){$(this.id).val(this.qsVal($this));
}});};roomps.makePersonChange=function(){var param=this.param,max_person=conf.dd.personIkyu.max,min_person_adlt=conf.dd.personIkyu.min_adlt,min_person_child=conf.dd.personIkyu.min_child,that=this;function error_Tips(context){var errorTips=$(context).closest("dl.roomAssignnew").find(".errorTipsnew");
errorTips.slideDown("fast",function(){var t=$(this),id=t.attr("id");t.find(".tipsClose").click(function(){t.hide();});});}this.personChange={bind:function(_id){$(_id).find(".iPlus, .iMinus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input"),val=$targetNum.val(),name=$targetNum.data("name"),isPlus=$(this).hasClass("iPlus")?true:false,validate_param=that.validate_param,validate=false,minus_min="";
val=(val==="")?0:parseInt(val);if(!isPlus){minus_min=(name=="qs_adltInput")?min_person_adlt:min_person_child;}if(!isPlus&&val<=minus_min){return;}if(isPlus&&val>=max_person){error_Tips(this);return;}if(name=="qs_adltInput"){validate=true;
}else{if(name=="qs_childaInput"){validate=true;}else{if(name=="qs_childbInput"){validate=true;}else{if(name=="qs_childcInput"){validate=true;}else{if(name=="qs_childdInput"){validate=false;}else{if(name=="qs_childoInput"){validate=false;
}else{if(name=="qs_childo2Input"){validate=true;}}}}}}}var persons={};persons.val=val,persons.isPlus=isPlus,persons.validate=validate,persons.isNoBed=(name=="qs_childdInput"||name=="qs_childoInput"),persons.adlt=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_adltInput]").val(),persons.childA=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childaInput]").val(),persons.childB=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childbInput]").val(),persons.childC=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childcInput]").val(),persons.childD=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childdInput]").val(),persons.childO=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childoInput]").val(),persons.childO2=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childo2Input]").val(),res_val=0;
res_val=that.calcPerson(persons);if(res_val===false){error_Tips(this);return;}$targetNum.val(res_val);});}};};roomps.bindProc=function(){this.bindView();this.bindButton();this.bindRoomnum();};roomps.bindView=function(){var param=this.param,view=param.view,icon=param.icon,qs_reset=param.qs_reset,room=param.room_e,roomnum=$(param.roomnum),pullarea=$(param.pullarea),parseint=YAHOO.JP.trv.qs.util.parseIntVal,$ci=param.ci_e,$co=param.co_e,that=this;
$(icon).off("click").on("click",function(){if($(this).hasClass("off")){$ci.val($ci.data("qs-tmp-val"));$co.val($co.data("qs-tmp-val"));that.roomAreaClickableCheck(true);that.updateView();$(qs_reset).removeAttr("checked");
YAHOO.JP.trv.qs.domesticlodging_checkinout.setDateText();}that.beforeRoomNum=parseint(room.val())?parseint(room.val()):1;roomnum.val(that.beforeRoomNum);that.showRoomPersons();pullarea.slideDown("fast",function(){YAHOO.JP.trv.qs.util.bindOutsideHide($(this).attr("id"));
}).find("li[data-qs-val="+that.beforeRoomNum+"]").trigger("click");});};roomps.bindButton=function(){var param=this.param,close=param.close,submit=param.submit,pullarea=param.pullarea,qs_reset=param.qs_reset,error_tips_id=param.error_tips_id,$room=param.room_e,$roomnum=$(param.roomnum),$adlt=param.adlt_e,$childa=param.childa_e,$childb=param.childb_e,$childc=param.childc_e,$childd=param.childd_e,$childo=param.childo_e,$childo2=param.childo2_e,$ci=param.ci_e,$co=param.co_e,that=this,child_modal=param.pullarea;
$(close).off("click").on("click",function(){$(pullarea+", "+child_modal).hide();});$(submit).off("click").on("click",function(){if(!checkCapacity()){$(pullarea).animate({scrollTop:0},500);return;}applyRoomPersons();
if(that.applyRoomPersonsCallback){that.applyRoomPersonsCallback();}});$(qs_reset).off("change").on("change",function(){if($(this).is(":checked")){$ci.data("qs-tmp-val",$ci.val()).val("");$co.data("qs-tmp-val",$co.val()).val("");
that.updateView();that.roomAreaClickableCheck(false);$(this).attr("checked",true);}else{$ci.val($ci.data("qs-tmp-val"));$co.val($co.data("qs-tmp-val"));that.roomAreaClickableCheck(true);that.updateView();
$(this).removeAttr("checked");}YAHOO.JP.trv.qs.domesticlodging_checkinout.setDateText();});function checkCapacity(){var ret=true;var qsInput=[$(pullarea).find("input[data-name=qs_adltInput]"),$(pullarea).find("input[data-name=qs_childaInput]"),$(pullarea).find("input[data-name=qs_childbInput]"),$(pullarea).find("input[data-name=qs_childcInput]"),$(pullarea).find("input[data-name=qs_childo2Input]")];
for(var i=0;i<qsInput[0].length;i++){var count=0;$.each(qsInput,function(j,jval){if(jval.val()!=null&&typeof jval.val()!="undefined"){count+=parseInt(jval.map(function(k,kval){return $(this).val()===""?0:$(this).val();
})[i]);}});if(that.validate_param.pMin>count||that.validate_param.pMax<count){var errorTips=$("#"+error_tips_id+(i+1));errorTips.slideDown("fast",function(){var t=$(this),id=t.attr("id");t.find(".tipsClose").click(function(){t.hide();
});});ret=false;}}return ret;}function applyRoomPersons(){var $pullarea=$(pullarea),$adltInput=$pullarea.find("input[data-name=qs_adltInput]"),$childaInput=$pullarea.find("input[data-name=qs_childaInput]"),$childbInput=$pullarea.find("input[data-name=qs_childbInput]"),$childcInput=$pullarea.find("input[data-name=qs_childcInput]"),$childdInput=$pullarea.find("input[data-name=qs_childdInput]"),$childoInput=$pullarea.find("input[data-name=qs_childoInput]"),$childo2Input=$pullarea.find("input[data-name=qs_childo2Input]");
$room.val($roomnum.val());$adlt.val($adltInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));$childa.val($childaInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));$childb.val($childbInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));$childc.val($childcInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));$childd.val($childdInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));$childo.val($childoInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));$childo2.val($childo2Input.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));that.updateView();$(pullarea+", "+child_modal).hide();}};roomps.bindRoomnum=function(){var param=this.param,pullarea=param.pullarea,$roomnum=$(param.roomnum),$roomarea=$(param.roomarea),that=this;
$roomnum.off("change").on("change",function(){var html="",room_num=YAHOO.JP.trv.qs.util.parseIntVal($(this).val()),before_num=that.beforeRoomNum;if(before_num<room_num){for(var i=(before_num+1);i<=room_num;
i++){html+=that.makeRoomTemplate(i,{adltNum:that.validate_param["pMin"]});}$roomarea.append(html);that.roomDDL.bind();that.personChange.bind(pullarea);}else{for(var i=0,e=(before_num-room_num);i<e;i++){$roomarea.children().last().remove();
}}that.beforeRoomNum=room_num;});};roomps.updateView=function(){var param=this.param,$adlt=param.adlt_e,$childa=param.childa_e,$childb=param.childb_e,$childc=param.childc_e,$childd=param.childd_e,$childo=param.childo_e,$childo2=param.childo2_e,$room=param.room_e,$view=$(param.view);
function personsCount($trgt){var total=0,str=$trgt.val();if(!str){return 0;}$.each(str.split(","),function(k,v){try{total+=isNaN(YAHOO.JP.trv.qs.util.parseIntVal(v))?0:YAHOO.JP.trv.qs.util.parseIntVal(v);
}catch(e){}});return total;}var room_num_txt=$room.val()||this.DEFAULT_ROMMS+"";var adlt_num_txt=personsCount($adlt)||this.DEFAULT_ADLTS+"";var child_num_txt=(function(){var total=0;total+=personsCount($childa);
total+=personsCount($childb);total+=personsCount($childc);total+=personsCount($childd);total+=personsCount($childo);total+=personsCount($childo2);return total;})();var html="<span>"+room_num_txt+"部屋</span>大人"+adlt_num_txt+"名&nbsp;子ども"+child_num_txt+"名</span>";
$view.html(html);};roomps.showRoomPersons=function(){var param=this.param,$adlt=param.adlt_e,$childa=param.childa_e,$childb=param.childb_e,$childc=param.childc_e,$childd=param.childd_e,$childo=param.childo_e,$childo2=param.childo2_e,$room=param.room_e,$roomnum_view=$(param.roomnum_view),$roomarea=$(param.roomarea),pullarea=param.pullarea,html="";
var adlt_nums=$adlt.val().split(","),childa_nums=$childa.val().split(","),childb_nums=$childb.val().split(","),childc_nums=$childc.val().split(","),childd_nums=$childd.val().split(","),childo_nums=$childo.val().split(","),childo2_nums=$childo2.val().split(",");
$roomnum_view.html(($room.val()||1)+'<span class="ico01 iArrowMore">');for(var i=0,l=adlt_nums.length;i<l;i++){var room_data={adltNum:adlt_nums[i],childaNum:childa_nums[i],childbNum:childb_nums[i],childcNum:childc_nums[i],childdNum:childd_nums[i],childoNum:childo_nums[i],childo2Num:childo2_nums[i]};
html+=this.makeRoomTemplate(i+1,room_data);}$roomarea.html(html);this.roomDDL.bind();this.personChange.bind(pullarea);};roomps.roomAreaClickableCheck=function(enabled){var param=this.param,$adlt=param.adlt_e,$childa=param.childa_e,$childb=param.childb_e,$childc=param.childc_e,$childd=param.childd_e,$childo=param.childo_e,$childo2=param.childo2_e,$room=param.room_e,$view=$(param.view),$roomperson=$(param.roomperson);
if(enabled){$roomperson.removeClass("disable");$view.removeClass("off").addClass("on").parent().removeClass("off").addClass("on");if($room.data("qs-tmp-val")){$room.val($room.data("qs-tmp-val"));}if($adlt.data("qs-tmp-val")){$adlt.val($adlt.data("qs-tmp-val"));
}if($childa.data("qs-tmp-val")){$childa.val($childa.data("qs-tmp-val"));}if($childb.data("qs-tmp-val")){$childb.val($childb.data("qs-tmp-val"));}if($childc.data("qs-tmp-val")){$childc.val($childc.data("qs-tmp-val"));
}if($childd.data("qs-tmp-val")){$childd.val($childd.data("qs-tmp-val"));}if($childo.data("qs-tmp-val")){$childo.val($childo.data("qs-tmp-val"));}if($childo2.data("qs-tmp-val")){$childo2.val($childo2.data("qs-tmp-val"));
}}else{$roomperson.addClass("disable");$view.removeClass("on").addClass("off").parent().removeClass("on").addClass("off");$view.html("<span>"+conf.dd.reset.dateText+"</span>");$room.data("qs-tmp-val",$room.val()).val("");
$adlt.data("qs-tmp-val",$adlt.val()).val("");$childa.data("qs-tmp-val",$childa.val()).val("");$childb.data("qs-tmp-val",$childb.val()).val("");$childc.data("qs-tmp-val",$childc.val()).val("");$childd.data("qs-tmp-val",$childd.val()).val("");
$childo.data("qs-tmp-val",$childo.val()).val("");$childo2.data("qs-tmp-val",$childo2.val()).val("");}};roomps.makeRoomTemplate=function(idx,room_data){var that=this,validate_param=this.validate_param,html="";
return makeTemplate();function makeTemplate(){var html=[];var isAcceptSchoolchildren=(validate_param.childA||validate_param.childO2);var isAcceptPreschoolers=(validate_param.childB||validate_param.childC);
var isAcceptNoBedding=(validate_param.childD||validate_param.childO);html.push('<dl class="roomAssignnew">');html.push(getErrorTips(idx));html.push("<dt>"+(idx)+"部屋目</dt>");html.push('<div class="Number'+((!isAcceptSchoolchildren&&!isAcceptPreschoolers&&!isAcceptNoBedding)?" Number--man":"")+'">');
html.push('<dd class="cf">');html.push(getAdaltTemplate(room_data));html.push("</dd></div>");if(isAcceptSchoolchildren){html.push('<div class="Number'+((!isAcceptPreschoolers&&!isAcceptNoBedding)?" Number--man":"")+'">');
html.push('<dd class="cf">');html.push(getSchoolchildrenTemplate(room_data,validate_param));html.push("</dd></div>");}if(isAcceptPreschoolers){html.push('<div class="Number'+((!isAcceptNoBedding)?" Number--man":"")+'">');
html.push('<dd class="cf">');html.push(getPreschoolersTemplate(room_data,validate_param));html.push("</dd></div>");}if(isAcceptNoBedding){html.push('<div class="Number Number--man">');html.push('<dd class="cf">');
html.push(getNoBeddingTemplate(room_data,validate_param));html.push("</dd></div>");}html.push("</dl>");return html.join("");}function getErrorTips(idx){return'<div class="errorTipsnew" id="'+that.param.error_tips_id+idx+'" style="display:none;">ご指定の人数は設定できません。<a class="tipsClose" href="javascript:void(0);">×</a></div>';
}function getAdaltTemplate(){var html='<label class="mdKeyNumber cf new">'+'<span class="man">大人</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_adltInput" type="text" value="'+(room_data.adltNum?room_data.adltNum:1)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>";
return html;}function getSchoolchildrenTemplate(){var html='<label class="mdKeyNumber cf new"><span class="schoolchildren">小学生</span>';if(validate_param.childA){html+='<span class="schoolchildrenH">高学年</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childaInput" type="text" value="'+(room_data.childaNum?room_data.childaNum:0)+'" readonly="readonly">'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>";
}if(validate_param.childO2){html+='<span class="schoolchildrenL">低学年</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childo2Input" type="text" value="'+(room_data.childo2Num?room_data.childo2Num:0)+'" readonly="readonly">'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>";
}html+="</label>";return html;}function getPreschoolersTemplate(){var html='<label class="mdKeyNumber cf new"><span class="schoolchildren">未就学</span>';if(validate_param.childB){html+='<span class="babyMealbed">食事・寝具利用</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childbInput" type="text" value="'+(room_data.childbNum?room_data.childbNum:0)+'" readonly="readonly">'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>";
}if(validate_param.childC){html+='<span class="babyBed">寝具のみ</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childcInput" type="text" value="'+(room_data.childcNum?room_data.childcNum:0)+'" readonly="readonly">'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>";
}html+="</label>";return html;}function getNoBeddingTemplate(){var html='<label class="mdKeyNumber cf new"><span class="schoolchildren">添い寝</span>';if(validate_param.childO){html+='<span class="babyMeal">食事のみ</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childoInput" type="text" value="'+(room_data.childoNum?room_data.childoNum:0)+'" readonly="readonly">'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>";
}if(validate_param.childD){html+='<span class="babyMealbedNo">食事・寝具なし</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childdInput" type="text" value="'+(room_data.childdNum?room_data.childdNum:0)+'" readonly="readonly">'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>";
}html+="</label>";return html;}};return roomps;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domesticlodging_roomperson_test=(function($,conf){var _isChild=false;var _isDispBreakdown=false;
var _cpCode=null;var _beforeRoomNum=1;var _isDispTop=false;var _isHansoku=false;var _bucket_id="";var _roomPersonArea="#qs_roomperson_area";var _rm="input[name=rm]";var _adlt="input[name=adlt]";var _childa="input[name=chlda]";
var _childb="input[name=chldb]";var _childc="input[name=chldc]";var _childd="input[name=chldd]";var _childo="input[name=chldo]";var _dispPersonLabel="";var _dispPersonListLabel="利用人数";var _applyRoomPersonsCallback=null;
var _chelem="input[name=chelem]";var _bbyboth="input[name=bbyboth]";var _melonly="input[name=melonly]";var _ftnonly="input[name=ftnonly]";var _bbynthr="input[name=bbynthr]";var _childText_total="";var _childText_default="------";
var _validatable=false;var _validateParam=null;var _areaId="";var _ci="input[name=ci]";var _co="input[name=co]";var _upper_change_module_flg=false;var _roomNum_upper="#qs_room_num_upper";var _roomNumView_upper="#qs_room_numView_upper";
var _roomPersonInputArea_upper="#qs_detail_search_area_upper";var rmChangeDDL_upper=$.extend({},YAHOO.JP.trv.qs.control.DDL,{id:"#qs_room_num_upper",viewid:"#qs_room_numView_upper",hdnName:"input[name=rm]",onClick:function($this){$(this.id).val(this.qsVal($this));
}});var personChange={bind:function(id){$(id).find(".iPlus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();val=val===""?0:parseInt(val);
if(_validatable){var count=val;var validate=true;if(_isChild){validate=false;var $adltInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_adltInput]");var $childaInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childaInput]");
var $childbInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childbInput]");var $childcInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childcInput]");var $childdInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childdInput]");
var $childoInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childoInput]");var target=$(this).parent().find("input").attr("data-name");if(target=="qs_adltInput"){validate=true;}else{if(target=="qs_childaInput"&&_validateParam["childAincld"]){validate=true;
}else{if(target=="qs_childbInput"&&_validateParam["childBincld"]){validate=true;}else{if(target=="qs_childcInput"&&_validateParam["childCincld"]){validate=true;}else{if(target=="qs_childdInput"&&_validateParam["childDincld"]){validate=true;
}else{if(target=="qs_childoInput"&&_validateParam["childOincld"]){validate=true;}}}}}}if(validate){count=parseInt($adltInput.val());if(_validateParam["childAincld"]){count+=parseInt($childaInput.val());
}if(_validateParam["childBincld"]){count+=parseInt($childbInput.val());}if(_validateParam["childCincld"]){count+=parseInt($childcInput.val());}if(_validateParam["childDincld"]){count+=parseInt($childdInput.val());
}if(_validateParam["childOincld"]){count+=parseInt($childoInput.val());}}}if((validate&&count>=_validateParam["pMax"])||(val>=conf.dd.person.max)){var errorTips=$(this).closest("dl.roomAssignnew").find(".errorTipsnew");
errorTips.slideDown("fast",function(){var id=$(this).attr("id");YAHOO.JP.trv.qs.util.bindOutsideHide(id);$(".tipsClose").click(function(){$("#"+id).hide();});});}else{if(val<conf.dd.person.max){val++;}}}else{if(val<conf.dd.person.max){val++;
}}$targetNum.val(val);});$(id).find(".iMinus").off("click").on("click",function(){var $targetNum=$(this).closest("span").find("input");var val=$targetNum.val();val=val===""?0:val;var targetName=$targetNum.attr("data-name");
var min=targetName==="qs_adltInput"?conf.dd.person.min_adlt:conf.dd.person.min_child;if(val>min){if(_validatable){var count=val;var validate=true;if(_isChild){validate=false;var $adltInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_adltInput]");
var $childaInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childaInput]");var $childbInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childbInput]");var $childcInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childcInput]");
var $childdInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childdInput]");var $childoInput=$(this).closest("dl.roomAssignnew").find("input[data-name=qs_childoInput]");var target=$(this).parent().find("input").attr("data-name");
if(!_validateParam["childAincld"]&&!_validateParam["childBincld"]&&!_validateParam["childCincld"]&&!_validateParam["childDincld"]&&!_validateParam["childOincld"]){if(target=="qs_adltInput"){validate=true;
}else{if(target=="qs_childaInput"&&_validateParam["childAincld"]){validate=true;}else{if(target=="qs_childbInput"&&_validateParam["childBincld"]){validate=true;}else{if(target=="qs_childcInput"&&_validateParam["childCincld"]){validate=true;
}else{if(target=="qs_childdInput"&&_validateParam["childDincld"]){validate=true;}else{if(target=="qs_childoInput"&&_validateParam["childOincld"]){validate=true;}}}}}}}if(validate){count=parseInt($adltInput.val());
if(_validateParam["childAincld"]){count+=parseInt($childaInput.val());}if(_validateParam["childBincld"]){count+=parseInt($childbInput.val());}if(_validateParam["childCincld"]){count+=parseInt($childcInput.val());
}if(_validateParam["childDincld"]){count+=parseInt($childdInput.val());}if(_validateParam["childOincld"]){count+=parseInt($childoInput.val());}}}if(validate&&count<=_validateParam["pMin"]){var errorTips=$(this).closest("dl.roomAssignnew").find(".errorTipsnew");
errorTips.slideDown("fast",function(){var id=$(this).attr("id");YAHOO.JP.trv.qs.util.bindOutsideHide(id);$(".tipsClose").click(function(){$("#"+id).hide();});});}else{val--;}}else{val--;}}$targetNum.val(val);
});}};function _showRoomPersons(){var adltNums=$(_adlt).val().split(",");var childaNums=null;var childbNums=null;var childcNums=null;var childdNums=null;var childoNums=null;if(_isChild){childaNums=$(_childa).val().split(",");
childbNums=$(_childb).val().split(",");childcNums=$(_childc).val().split(",");childdNums=$(_childd).val().split(",");childoNums=$(_childo).val().split(",");}$(_roomNumView_upper).html(($(_rm).val()===""?1:$(_rm).val())+'<span class="ico01 iArrowMore">');
var $roomArea=$("#qs_roomArea_upper");var html="";for(var i=0;i<adltNums.length;i++){var roomData={adltNum:adltNums[i]};if(_isChild){roomData["childaNum"]=childaNums[i];roomData["childbNum"]=childbNums[i];
roomData["childcNum"]=childcNums[i];roomData["childdNum"]=childdNums[i];roomData["childoNum"]=childoNums[i];}html+=_makeRoomTemplate(i+1,roomData,_isChild);}$roomArea.html(html);rmChangeDDL_upper.bind();
personChange.bind(_roomPersonInputArea_upper);}function _showChildCheckbox(){var child_elem=$(_chelem).val();var baby_both=$(_bbyboth).val();var meal_only=$(_melonly).val();var futon_only=$(_ftnonly).val();
var baby_nthr=$(_bbynthr).val();if(child_elem=="1"){$("#ch_elem").prop("checked",true);}else{$("#ch_elem").prop("checked",false);}if(baby_both=="1"){$("#bby_both").prop("checked",true);}else{$("#bby_both").prop("checked",false);
}if(meal_only=="1"){$("#mel_only").prop("checked",true);}else{$("#mel_only").prop("checked",false);}if(futon_only=="1"){$("#ftn_only").prop("checked",true);}else{$("#ftn_only").prop("checked",false);}if(baby_nthr=="1"){$("#bby_nthr").prop("checked",true);
}else{$("#bby_nthr").prop("checked",false);}_makeChildText();}function _applyRoomPersons(){var $roomPersonInputArea=$(_roomPersonInputArea_upper);var $adltInput=$roomPersonInputArea.find("input[data-name=qs_adltInput]");
$(_rm).val($(_roomNum_upper).val()).change();$(_adlt).val($adltInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(",")).change();if(!_isDispBreakdown){_applySearchChild();
}if(_isChild){var $childaInput=$roomPersonInputArea.find("input[data-name=qs_childaInput]");var $childbInput=$roomPersonInputArea.find("input[data-name=qs_childbInput]");var $childcInput=$roomPersonInputArea.find("input[data-name=qs_childcInput]");
var $childdInput=$roomPersonInputArea.find("input[data-name=qs_childdInput]");var $childoInput=$roomPersonInputArea.find("input[data-name=qs_childoInput]");$(_childa).val($childaInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));$(_childb).val($childbInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));$(_childc).val($childcInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));$(_childd).val($childdInput.map(function(index,el){return $(this).val()===""?0:$(this).val();}).get().join(","));$(_childo).val($childoInput.map(function(index,el){return $(this).val()===""?0:$(this).val();
}).get().join(","));}_setRoomText();$(_roomPersonInputArea_upper).hide();$("#child_notice_modal").hide();}function _applySearchChild(){if($("#ch_elem").prop("checked")){$(_chelem).val(1);}else{$(_chelem).val("");
}if($("#bby_both").prop("checked")){$(_bbyboth).val(1);}else{$(_bbyboth).val("");}if($("#mel_only").prop("checked")){$(_melonly).val(1);}else{$(_melonly).val("");}if($("#ftn_only").prop("checked")){$(_ftnonly).val(1);
}else{$(_ftnonly).val("");}if($("#bby_nthr").prop("checked")){$(_bbynthr).val(1);}else{$(_bbynthr).val("");}}function _setRoomText(){var roomNum=0;var adltNum=0;roomNum=$(_rm).val()?$(_rm).val():1;if((roomNum>=2&&_cpCode==="004")||(_cpCode==="006")){$("#ikome_ikyu_upper").show();
}var $anchor=$("#qs_detail_search_anchor_upper");if($anchor.is(".off")){return;}var roomCount=function($jqObj){var total=0;$.each($jqObj.val().split(","),function(k,v){try{total+=isNaN(YAHOO.JP.trv.qs.util.parseIntVal(v))?0:YAHOO.JP.trv.qs.util.parseIntVal(v);
}catch(e){}});return total;};adltNum=roomCount($(_adlt));adltNum=adltNum===0?2:adltNum;_makeChildText();var html="";if(_isChild){var childNum=0;childNum=(function(){var total=0;total+=roomCount($(_childa));
total+=roomCount($(_childb));total+=roomCount($(_childc));total+=roomCount($(_childd));total+=roomCount($(_childo));return total;})();html=roomNum+"部屋&nbsp;大人"+adltNum+"名&nbsp;子ども"+childNum+"名";}else{if($(_adlt).val()!==""){if(!_isDispBreakdown&&!_isHansoku){var childStrNum=_getChildStrNum((roomNum+adltNum).length);
html="<span>"+roomNum+"部屋・"+_dispPersonLabel+adltNum+"名・"+_childText_total.slice(0,childStrNum)+"</span>";}else{html=roomNum+"部屋&nbsp;"+_dispPersonLabel+adltNum+"名";}}else{html="<span>"+conf.dd.reset.dateText+"</span>";
}}$anchor.html(html);}function _roomAreaClickableCheck(enabled){var $rm=$(_rm);var $adlt=$(_adlt);var $childa=$(_childa);var $childb=$(_childb);var $childc=$(_childc);var $childd=$(_childd);var $childo=$(_childo);
if(enabled){$("#qs_roomperson_area").removeClass("disable");$("#qs_detail_search_anchor_upper").removeClass("off").addClass("on");$("#qs_checkoutDate > span.func").removeClass("off").addClass("on");if($adlt.val()===""&&$adlt.val()===""){$rm.val(1);
$adlt.val(2);}var tmpRmVal=$rm.data("qs-tmp-val");if(tmpRmVal){$rm.val(tmpRmVal);}var tmpAdltVal=$adlt.data("qs-tmp-val");if(tmpAdltVal){$adlt.val(tmpAdltVal);}var tmpChelemVal=$(_chelem).data("qs-tmp-val");
if(tmpChelemVal){$(_chelem).val(tmpChelemVal);}var tmpBbybothVal=$(_bbyboth).data("qs-tmp-val");if(tmpBbybothVal){$(_bbyboth).val(tmpBbybothVal);}var tmpMelonlyVal=$(_melonly).data("qs-tmp-val");if(tmpMelonlyVal){$(_melonly).val(tmpMelonlyVal);
}var tmpFtnonlyVal=$(_ftnonly).data("qs-tmp-val");if(tmpFtnonlyVal){$(_ftnonly).val(tmpFtnonlyVal);}var tmpBbynthrVal=$(_bbynthr).data("qs-tmp-val");if(tmpBbynthrVal){$(_bbynthr).val(tmpBbynthrVal);}if(_isChild){var tmpChildaVal=$childa.data("qs-tmp-val");
if(tmpChildaVal){$childa.val(tmpChildaVal);}var tmpChildbVal=$childb.data("qs-tmp-val");if(tmpChildbVal){$childb.val(tmpChildbVal);}var tmpChildcVal=$childc.data("qs-tmp-val");if(tmpChildcVal){$childc.val(tmpChildcVal);
}var tmpChilddVal=$childd.data("qs-tmp-val");if(tmpChilddVal){$childd.val(tmpChilddVal);}var tmpChildoVal=$childo.data("qs-tmp-val");if(tmpChildoVal){$childo.val(tmpChildoVal);}}_setRoomText();}else{$("#qs_roomperson_area").addClass("disable");
$("#qs_detail_search_anchor_upper").html("<span>"+conf.dd.reset.dateText+"</span>");$("#qs_detail_search_anchor_upper").removeClass("on").addClass("off");$("#qs_checkoutDate > span.func").removeClass("on").addClass("off");
$rm.data("qs-tmp-val",$rm.val()).val("");$adlt.data("qs-tmp-val",$adlt.val()).val("");$(_chelem).data("qs-tmp-val",$(_chelem).val()).val("");$(_bbyboth).data("qs-tmp-val",$(_bbyboth).val()).val("");$(_melonly).data("qs-tmp-val",$(_melonly).val()).val("");
$(_ftnonly).data("qs-tmp-val",$(_ftnonly).val()).val("");$(_bbynthr).data("qs-tmp-val",$(_bbynthr).val()).val("");if(_isChild){$childa.data("qs-tmp-val",$childa.val()).val("");$childb.data("qs-tmp-val",$childb.val()).val("");
$childc.data("qs-tmp-val",$childc.val()).val("");$childd.data("qs-tmp-val",$childd.val()).val("");$childo.data("qs-tmp-val",$childo.val()).val("");}}}function _disable(){_setRoomText();_roomAreaClickableCheck(false);
}function _enable(){_roomAreaClickableCheck(true);_setRoomText();}function _makeChildText(){_childText_total="";if($("#ch_elem").prop("checked")){_childText_total="小学生、";}if($("#bby_both").prop("checked")){_childText_total+="幼児（食事・布団あり）、";
}if($("#mel_only").prop("checked")){_childText_total+="幼児（食事あり・布団なし）、";}if($("#ftn_only").prop("checked")){_childText_total+="幼児（布団あり・食事なし）、";}if($("#bby_nthr").prop("checked")){_childText_total+="幼児（食事・布団なし）、";
}if(_childText_total==""){_childText_total=_childText_default;}else{_childText_total=_childText_total.slice(0,_childText_total.length-1);}}function _getChildStrNum(strnum){var ret=0;var max_num=6;if(_childText_total==_childText_default){ret=max_num;
if(strnum>=3&&_isDispTop){ret=max_num-(strnum-1);}}else{if(_isDispTop){if(strnum==2){ret=4;}else{if(strnum==3){ret=3;}else{if(strnum==4||strnum==5){ret=2;}}}ret=ret-1;}else{if(strnum==2||strnum==3){ret=4;
}else{if(strnum==4||strnum==5){ret=3;}}}}return ret;}function _outsideHide(id){$(document).off("click.body").on("click.body",function(e){var target=$("#"+id);var child_modal=$("#child_notice_modal");if(target.is(":hidden")||target.is(":animated")){$(document).off("click."+id);
return;}if($("#child_notice_modal").is(":hidden")&&$("#child_notice_modal").attr("cmp")!=="1"){if(!target.is(e.target)&&target.has(e.target).length===0){$(target).hide();$(document).off("click."+id);_showChildCheckbox();
}}else{if(!(child_modal).is(e.target)&&!target.is(e.target)&&child_modal.has(e.target).length===0&&target.has(e.target).length===0){$("#child_notice_modal").hide();$(document).off("click."+id);}}});}function _makeRoomTemplate(idx,roomData,isChild){var roomHtml="";
if(_validatable&&(!_validateParam["childA"]&&!_validateParam["childB"]&&!_validateParam["childC"]&&!_validateParam["childD"]&&!_validateParam["childO"])){isChild=false;}if(isChild&&_validatable){roomHtml='<dl class="roomAssignnew">'+'<div id="errorTips_upper'+(idx)+'" class="errorTipsnew" style="display:none;">ご指定の人数は設定できません。<a class="tipsClose" href="javascript:void(0);">×</a></div>'+"<dt>"+(idx)+"部屋目</dt>"+'<div class="Number">'+'<dd class="cf">'+'<label class="mdKeyNumber cf new"><span class="man">大人</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_adltInput" type="text" value="'+(roomData.adltNum?roomData.adltNum:1)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf new">小学生'+'<span class="control cf">'+(_validateParam["childA"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childaInput" type="text" value="'+(roomData.childaNum?roomData.childaNum:0)+'" readonly="readonly"'+(_validateParam["childA"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childA"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+"</dd>"+"<dd>"+'<dl class="baby cf">'+"<dt>幼児</dt>"+'<dd class="cf">'+'<label class="mdKeyNumber cf new'+(_validateParam["childB"]?"":" disable")+'">食事・布団あり'+'<span class="control cf">'+(_validateParam["childB"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childbInput" type="text" value="'+(roomData.childbNum?roomData.childbNum:0)+'"  readonly="readonly"'+(_validateParam["childB"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childB"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+'<label class="mdKeyNumber cf new'+(_validateParam["childO"]?"":" disable")+'">食事あり'+'<span class="control cf">'+(_validateParam["childO"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childoInput" type="text" value="'+(roomData.childoNum?roomData.childoNum:0)+'"  readonly="readonly"'+(_validateParam["childO"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childO"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+'<label class="mdKeyNumber cf new'+(_validateParam["childC"]?"":" disable")+'">布団あり'+'<span class="control cf">'+(_validateParam["childC"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childcInput" type="text" value="'+(roomData.childcNum?roomData.childcNum:0)+'"  readonly="readonly"'+(_validateParam["childC"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childC"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+'<label class="mdKeyNumber cf new'+(_validateParam["childD"]?"":" disable")+'">食事・布団なし'+'<span class="control cf">'+(_validateParam["childD"]?'<a href="javascript:void(0);" class="iMinus">-</a>':'<span class="iMinusDis">-</span>')+'<span class="inputText cf">'+'<input data-name="qs_childdInput" type="text" value="'+(roomData.childdNum?roomData.childdNum:0)+'"  readonly="readonly"'+(_validateParam["childD"]?"":" disabled")+"/>"+"<span>名</span>"+"</span>"+(_validateParam["childD"]?'<a href="javascript:void(0);" class="iPlus">+</a>':'<span class="iPlusDis">+</span>')+"</span>"+"</label>"+"</dd>"+"</div>"+"</dl>"+"</dd>"+"</dl>";
}else{if(isChild){roomHtml='<dl class="roomAssignnew">'+"<dt>"+(idx)+"部屋目</dt>"+'<div class="Number">'+'<dd class="cf">'+'<label class="mdKeyNumber cf new"> <span class="man">大人</span>'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_adltInput" type="text" value="'+(roomData.adltNum?roomData.adltNum:1)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf new">小学生'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childaInput" type="text" value="'+(roomData.childaNum?roomData.childaNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+"</dd>"+"<dd>"+'<dl class="baby cf">'+"<dt>幼児</dt>"+'<dd class="cf">'+'<label class="mdKeyNumber cf new">食事・布団あり'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childbInput" type="text" value="'+(roomData.childbNum?roomData.childbNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+'</label class="cf">'+'<label class="mdKeyNumber cf new">食事あり'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childoInput" type="text" value="'+(roomData.childoNum?roomData.childoNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf new">布団あり'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childcInput" type="text" value="'+(roomData.childcNum?roomData.childcNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+'<label class="mdKeyNumber cf new">食事・布団なし'+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_childdInput" type="text" value="'+(roomData.childdNum?roomData.childdNum:0)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+"</dd>"+"</div>"+"</dl>"+"</dd>"+"</dl>";
}else{roomHtml='<dl class="roomAssignnew">'+'<div id="errorTips_upper'+(idx)+'" class="errorTipsnew" style="display:none;">ご指定の人数は設定できません。<a class="tipsClose" href="javascript:void(0);">×</a></div>'+"<dt>"+(idx)+"部屋目</dt>"+'<div class="Number">'+'<dd class="cf">'+'<label class="mdKeyNumber cf new"><span class="man">'+_dispPersonListLabel+"</span>"+'<span class="control cf">'+'<a href="javascript:void(0);" class="iMinus">-</a>'+'<span class="inputText cf">'+'<input data-name="qs_adltInput" type="text" value="'+(roomData.adltNum?roomData.adltNum:1)+'"  readonly="readonly" />'+"<span>名</span>"+"</span>"+'<a href="javascript:void(0);" class="iPlus">+</a>'+"</span>"+"</label>"+"</dd>"+"</dl>";
}}return roomHtml;}function _makeChildCheckbox(){var childCheckbox="";childCheckbox='<div class="mdPullDown_Child">'+'<div class="inner">'+'<p class="title">子どもの宿泊条件で絞り込む</p>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="ch_elem">'+'<input type="checkbox" id="ch_elem" class="checkRegular" value="1">'+'<span class="checkbox"></span>小学生</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="bby_both">'+'<input type="checkbox" id="bby_both" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（食事・布団あり）</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="mel_only">'+'<input type="checkbox" id="mel_only" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（食事あり・布団なし）</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="ftn_only">'+'<input type="checkbox" id="ftn_only" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（布団あり・食事なし）</label>'+'<label class="checkLabel jsRoomPersonsCheck cf" for="bby_nthr">'+'<input type="checkbox" id="bby_nthr" class="checkRegular" value="1">'+'<span class="checkbox"></span>幼児（食事・布団なし）</label>'+"</div><!-- /.inner -->"+"</div><!-- /.mdPullDown_Child -->";
return childCheckbox;}return{init:function(isChild,isDispBreakdown,isDispTop,isHansoku,bucket_id){if(isChild){_isChild=isChild;}_cpCode=$("#qs_cp_cd").val();_isHansoku=isHansoku;if(isDispBreakdown){_isDispBreakdown=isDispBreakdown;
_dispPersonLabel="大人";_dispPersonListLabel="大人";}else{if(!_isHansoku){_dispPersonListLabel="大人人数";}}_isDispTop=isDispTop;if(bucket_id){_bucket_id=bucket_id;}this.bind();$qsReset=$("#qs_reset");if($(_ci).val()===""&&$(_co).val()===""){if($qsReset.is(":not(:checked)")){$qsReset.prop("checked",true).change();
}}else{if($qsReset.is(":checked")){$("#qs_reset").prop("checked",false).change();}}var $rm=$(_rm);_beforeRoomNum=$rm.val()?$rm.val():1;if(YAHOO.JP.trv.qs.domesticlodging_checkinout){if(YAHOO.JP.trv.qs.domesticlodging_checkinout.isPendingSelect()){_disable();
}else{if(!isHansoku){_showChildCheckbox();}_setRoomText();}}},bind:function(){$("#qs_detail_room_person_upper").off("click").on("click",function(){if($("#qs_reset").is(":checked")){$("#qs_reset").prop("checked",false).change();
$("#qs_roomperson_area_upper").removeClass("disable");}if($("#child_notice_modal").is(":visible")){$(_roomPersonInputArea_upper).hide();$("#child_notice_modal").hide();return;}_beforeRoomNum=YAHOO.JP.trv.qs.util.parseIntVal($(_rm).val())?YAHOO.JP.trv.qs.util.parseIntVal($(_rm).val()):1;
$("#qs_room_num_upper").val(_beforeRoomNum);_showRoomPersons();$(_roomPersonInputArea_upper).slideDown("fast",function(){var id=$(this).attr("id");_outsideHide(id);}).find("li[data-qs-val="+_beforeRoomNum+"]").trigger("click");
});$("#qs_detail_search_closeBtn_upper").off("click").on("click",function(){_showChildCheckbox();$(_roomPersonInputArea_upper).hide();$("#child_notice_modal_upper").hide();});$("#qs_applyRoomPersons_upper").off("click").on("click",function(){_applyRoomPersons();
if(_applyRoomPersonsCallback){_applyRoomPersonsCallback();}});$("#qs_room_num_upper").off("change").on("change",function(){var html="";var $roomArea=$("#qs_roomArea_upper");var roomNum=YAHOO.JP.trv.qs.util.parseIntVal($(this).val());
if((roomNum>=2&&_cpCode==="004")||(_cpCode==="006")){$("#ikome_ikyu_upper").show();}else{$("#ikome_ikyu_upper").hide();}if(_beforeRoomNum<roomNum){for(var i=(_beforeRoomNum+1);i<=roomNum;i++){html+=_makeRoomTemplate(i,{adltNum:_validatable?_validateParam["pMin"]:1,childaNum:0,childbNum:0,childcNum:0,childdNum:0,childoNum:0},_isChild);
}$roomArea.append(html);rmChangeDDL_upper.bind();personChange.bind(_roomPersonInputArea_upper);}else{var resetVal=_beforeRoomNum-roomNum;for(var i=0;i<resetVal;i++){$roomArea.children().last().remove();
}}_beforeRoomNum=roomNum;});if(!_isHansoku){$("#qs_search_child").html(_makeChildCheckbox());}$("#qs_reset").off("change").on("change",function(){if($(this).is(":checked")){$(_areaId).hide();$(_ci).data("qs-tmp-val",$(_ci).val()).val("");
$(_co).data("qs-tmp-val",$(_co).val()).val("");_disable();if(YAHOO.JP.trv.qs.util.getBrowserName()=="firefox"){$(this).attr("checked",true);}}else{var ciValue=$(_ci).data("qs-tmp-val");var coValue=$(_co).data("qs-tmp-val");
if(!ciValue){ciValue=$("#qs_default_ci").val();}if(!coValue){coValue=$("#qs_default_co").val();}$(_ci).val(ciValue);$(_co).val(coValue);_enable();if(YAHOO.JP.trv.qs.util.getBrowserName()=="firefox"){$(this).removeAttr("checked");
}}YAHOO.JP.trv.qs.domesticlodging_checkinout.setDateText();});$("#child_notice_link").off("click").on("click",function(){if($("#child_notice_modal").is(":visible")){$("#child_notice_modal").hide();return;
}var offset=$(_roomPersonInputArea).position();$("#child_notice_modal").css("top",offset.top+45);$("#child_notice_modal").css("left",offset.left-282);$("#child_notice_modal").slideDown("fast");$("#child_notice_modal").attr("cmp","0");
var withCloseSelecter=".mdAreaFilter .jsToggleCtr"+", .mdMapStart"+", #qs_checkinDate"+", #qs_checkoutDate"+", #qs_freewordText"+", #sdc_morecondition_open"+", #qs_freewordReset"+", .mdFilter";var withCloser=$(withCloseSelecter);
withCloser.off("click.with_close").on("click.with_close",function(){withCloser.off("click.with_close");$(_roomPersonInputArea).hide();$("#child_notice_modal").hide();});});$("#child_notice_close").off("click").on("click",function(){$("#child_notice_modal").hide();
$("#child_notice_modal").attr("cmp","1");});},setRoomValue:function(){var $rm=$(_rm);var $adlt=$(_adlt);if($rm.val()===""){$rm.val(1);$adlt.val(2);}$(_chelem).val("");$(_bbyboth).val("");$(_melonly).val("");
$(_ftnonly).val("");$(_bbynthr).val("");_showChildCheckbox();_setRoomText();},remove:function(){var $rm=$(_rm);var $adlt=$(_adlt);var $childa=$(_childa);var $childb=$(_childb);var $childc=$(_childc);var $childd=$(_childd);
var $childo=$(_childo);$rm.remove();$adlt.remove();if(_isChild){$childa.remove();$childb.remove();$childc.remove();$childd.remove();$childo.remove();}$(_roomPersonArea).remove();},setApplyRoomPersonText:function(text){$("#qs_applyRoomPersons_upper").text(text);
},applyRoomPersonsCallback:function(fn){_applyRoomPersonsCallback=fn;},validatable:function(bool){_validatable=bool;},setValidate:function(val){_validateParam=val;},_showChildCheckbox:_showChildCheckbox,_setRoomText:_setRoomText};
})(jQuery,$.extend({},YAHOO.JP.trv.qs.conf,true));var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.domestictour=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
var $mainArea=null;var $qs_dep_ym=null;var $qs_dep_ym_view=null;var $qs_dep_d=null;var $qs_dep_d_view=null;var $viewDate=null;var $hdnDate=null;var $selectCarArea=null;var $landmarkViewArea=null;var $landmarkArea=null;
var $chkld=null;var $roomSelectArea=null;var sigData=[];function bindSelectToggleArea(jqObj){$(jqObj).off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore"></span>';
var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");var $hdnArea=$dl.find("input:hidden");$dl.find("li").removeClass("selected");
$(this).addClass("selected");$hdnArea.val($(this).data("qs-val")).change();$thisToggleAnchor.html(html);$thisToggleArea.hide();});}function getDlLandmark(lcd){var ajaxOption=$.extend(true,{},conf.ajax);
ajaxOption.url=conf.dl.landmark_js_path+lcd;ajaxOption.async=true;ajaxOption.success=function(data,status,xhr){var fn="(function(){ "+data+"function setSig(name, code){"+"    YAHOO.JP.trv.qs.domestictour.setSig(name, code);"+"}"+"function createSigData(){"+"    return;"+"}"+"})();";
eval(fn);var html="<ul>";html+='<input type="hidden" name="sig_cd" value=""></input>';html+=' <li class="region" data-qs-val=""><a href="javascript:void(0)">指定なし</a></li>';for(var i=0;i<sigData.length;
i++){var data=sigData[i];html+=' <li class="region" data-qs-val="'+data.code+'"><a href="javascript:void(0)">'+data.name+"</a></li>";}html+="</ul>";$landmarkViewArea.html('観光地・温泉地を選択<span class="ico01 iArrowMore"></span>');
$landmarkArea.html(html);bindSelectToggleArea($landmarkArea.find("li"));sigData=[];};ajaxOption.dataType="text";$.ajax(ajaxOption);}function bindDatePicker($jqObj,$view){var tomorrow=new Date($jqObj.val());
var limitDate=new Date(tomorrow.getFullYear(),tomorrow.getMonth()+6,0);var datepickerOption={minDate:tomorrow,maxDate:limitDate,beforeShow:function(input,inst){var calendar=inst.dpDiv;setTimeout(function(){calendar.css({top:$qs_dep_ym_view.closest("dl").offset().top+$qs_dep_ym_view.closest("dl").height(),left:$mainArea.offset().left+($mainArea.width()/2-calendar.width()/2)});
},1);},onSelect:function(dateText,inst){var selectedDate=new Date(dateText);var textMonth=(selectedDate.getMonth()+1);var textDate=selectedDate.getDate();$qs_dep_ym.find("li[data-qs-val="+textMonth+"]").trigger("click");
$mainArea.find(".jsToggleTarget li[data-qs-val="+textMonth+"] a").trigger("click");$qs_dep_d.find("ul[data-qs-val="+textMonth+"] li[data-qs-val="+textDate+"]").trigger("click");$mainArea.find(".jsToggleTarget ul[data-qs-val="+textMonth+"] li[data-qs-val="+textDate+"] a").trigger("click");
textMonth=("00"+textMonth).slice(-2);$("#qs_dtour_cal_val_mon").val(selectedDate.getFullYear()+textMonth);$("#qs_dtour_cal_val_day").val(selectedDate.getDate());}};$jqObj.datepicker("destroy");$jqObj.datepicker(datepickerOption);
$view.off("click").on("click",function(){$jqObj.datepicker("show");});}var sub={init:function(){$mainArea=$("#qs_domestictour");$qs_dep_ym=$("#qs_dep_ym");$qs_dep_ym_view=$("#qs_dep_ym_view");$qs_dep_d=$("#qs_dep_d");
$qs_dep_d_view=$("#qs_dep_d_view");$selectCarArea=$("#qs_dtour_car");$landmarkViewArea=$("#qs_dt_landmarkViewArea");$landmarkArea=$("#qs_dt_landmarkArea");$roomSelectArea=$("#qs_dt_roomSelectArea");$viewDate=$("#qs_datepicker_view");
$hdnDate=$("#qs_dtour_cal_val");$chkld=$("#qs_dt_chkld");YAHOO.JP.trv.qs.domestictour.bind();},bind:function(){$mainArea.find(".jsToggleCtr").off("click").on("click",function(){var $toggleArea=$(this).closest("dl").find(".jsToggleTarget");
if($toggleArea.attr("id")===$roomSelectArea.attr("id")){if($chkld.is(":checked")){return;}}if($toggleArea.data("qs-status")==="off"){return;}$mainArea.find(".jsToggleTarget").each(function(k,v){if($toggleArea.attr("id")!==$(this).attr("id")){$(this).hide();
}});if($toggleArea.is(":hidden")){$toggleArea.css("visibility","hidden");$toggleArea.show();$toggleArea.scrollTop(0);var pos=$toggleArea.find("li.selected").position();if(pos){$toggleArea.scrollTop(pos.top);
}$toggleArea.hide();$toggleArea.css("visibility","visible");}$toggleArea.slideToggle("fast",function(){var id=$(this).attr("id");bindOutsideHide(id);});});bindSelectToggleArea($("#qs_dt_fromArea").find("li"));
bindSelectToggleArea($roomSelectArea.find("li"));bindSelectToggleArea($("#qs_dt_toArea_").find("li"));$("#qs_dt_toArea").find("li").on("click",function(){var lcd=$(this).data("qs-val");var beforeLcdSelecter=$("#qs_dt_toArea").find("input[type=hidden]");
if(beforeLcdSelecter.data("qs-before-lcd")==lcd){return;}$landmarkViewArea.removeClass("disable");if(lcd===""){$landmarkViewArea.html('観光地・温泉地を選択<span class="ico01 iArrowMore"></span>').addClass("disable");
$landmarkArea.html("").data("qs-status","off");}else{$landmarkArea.data("qs-status","on");getDlLandmark(lcd);}beforeLcdSelecter.data("qs-before-lcd",lcd);});$qs_dep_ym.find("li").off("click").on("click",function(){$qs_dep_ym.hide();
$qs_dep_d.hide();$qs_dep_d.find("ul").css("display","none");$qs_dep_d_view.html('指定なし<span class="ico01 iArrowMore">');$qs_dep_d.find("ul[data-qs-val="+$(this).data("qs-val")+"]").css("display","block");
$(this).closest("dd").find("li").removeClass("selected");$(this).addClass("selected");$qs_dep_d.find("li").removeClass("selected");$qs_dep_d.find('li[data-qs-val=""]').addClass("selected");var $tmp_ym=$(this).text().replace(/年/g,"/").replace(/月/g,"/");
var $tmp_day=$qs_dep_d.find("ul[data-qs-val="+$(this).data("qs-val")+"]").find("li").eq(1).text().replace(/日/g,"");$hdnDate.val($tmp_ym+$tmp_day);var html=$(this).text()+'<span class="ico01 iArrowMore">';
var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");$thisToggleAnchor.html(html);var $input_ym=$(this).text().replace(/年/g,"").replace(/月/g,"");var $text_y=$input_ym.substr(0,4);
var $text_m=$input_ym.substr(4);$text_m=("00"+$text_m).slice(-2);$("#qs_dtour_cal_val_mon").val($text_y+$text_m);});$qs_dep_d.find("li").off("click").on("click",function(){var $tmp_day=0;var $tmp_ym=$qs_dep_ym_view.text().replace(/年/g,"/").replace(/月/g,"/");
if(!$(this).data("qs-val")){$tmp_day=1;}else{$tmp_day=$(this).data("qs-val");$("#qs_dtour_cal_val_day").val($tmp_day);}$hdnDate.val($tmp_ym+$tmp_day);$mainArea.find(".jsToggleTarget a").off("click").on("click",function(){var html=$(this).text()+'<span class="ico01 iArrowMore">';
var $dl=$(this).closest("dl");var $thisToggleAnchor=$dl.find(".jsToggleCtr");var $thisToggleArea=$dl.find(".jsToggleTarget");$dl.find("li").removeClass("selected");$(this).closest("li").addClass("selected");
$thisToggleAnchor.html(html);$thisToggleArea.hide();});});bindDatePicker($hdnDate,$viewDate);$selectCarArea.find("li").off("click").on("click",function(){var isSelected=$(this).is(".on");if(isSelected){$(this).removeClass("on").addClass("off");
$(this).find("input:checkbox").prop("checked",null);}else{$(this).removeClass("off").addClass("on");$(this).find("input:checkbox").prop("checked","true");}});$chkld.off("change").on("change",function(){if($(this).is(":checked")){$roomSelectArea.find("li[data-qs-val=2]").trigger("click");
$("#qs_dt_roomSelectAreaView").addClass("disable");}else{$("#qs_dt_roomSelectAreaView").removeClass("disable");}});$("#qs_dt_detailSearch").off("click").on("click",function(){var okonomiX=$("<input>").attr("name","okonomi_x").attr("type","hidden").val("1");
var okonomiY=$("<input>").attr("name","okonomi_y").attr("type","hidden").val("1");var sigCd=$("#qs_dt_form").find("input[name=sig_cd]");if(!sigCd[0]){sigCd=$("<input>").attr("name","sig_cd").attr("type","hidden").val("");
}$("#qs_dt_form").attr("action",$(this).data("qs-href")).attr("data-rdlabel",$(this).data("data-rdlabel")).append(okonomiX).append(okonomiY).append(sigCd);redirect_rdsig("#qs_dt_form");});},setSig:function(name,code){sigData.push({"name":name,"code":code});
},changedTab:function(){}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.qs=YAHOO.JP.trv.qs||{};YAHOO.JP.trv.qs.freeword=(function($,conf){var bindOutsideHide=YAHOO.JP.trv.qs.util.bindOutsideHide;
var _suggestSearchFormID=null;var _ajaxFlg=false;var $freewordArea=null;var $freewordText=null;var $freewordResultArea=null;var $popularResultArea=null;var $noResultArea=null;var $noKeyWord=null;var beforeSuggestText="";
var _bucketId="";var zeromatchFlg=false;var zeromatchPointer=0;var zeromatchHistory=[];var freewordAreaLinkCount=null;var unsentLinkViews=[];var trackingLogMaxLength=300;var jsonUseFixedMinLength=4;var secKey="kwda";
var retryMax=10;var retryCount=0;var retryTimer=100;var noImage="https://iwiz-dhotel-travel.c.yimg.jp/im_siggIi8PE5hUSnBgP9ExbqbkEQ---x156-y117/c/dhotel-travel/00/00/noimage.jpg";var SUGGEST_SPECIAL_PARAMS={sc_i:"suggest",};
var sc_i="suggest";function sgtLinkAction(jqObj){var type=$(jqObj).data("qs-sgttyp");var cd=$(jqObj).data("qs-sgtcd");var $freewordSuggestSearch=$(_suggestSearchFormID);var url=conf.fs.rootUrl;url+=conf.area[type]+"/";
url+=cd+"/";var checkedhotels=$(".hotelType input:checked");if(url.indexOf("search")!=-1&&checkedhotels.size()==1){hotelid=checkedhotels.attr("id");if(hotelid=="checkbox8_1"){url+="ryokan/";}else{if(hotelid=="checkbox8_2"){url+="hotel/";
}else{if(hotelid=="checkbox8_3"){url+="bizhotel/";}}}}$freewordSuggestSearch.attr("action",url);$freewordSuggestSearch.find("input[name=qry]").prop("disabled",true);var srt=$freewordSuggestSearch.find("input[name=srt]").val();
if(srt==="3"){$freewordSuggestSearch.find("input[name=srt]").prop("disabled",true);}$freewordSuggestSearch.find("input[name=sgttyp]").prop("disabled",false).val(type);$freewordSuggestSearch.find("input[name=sgtcd]").prop("disabled",false).val(cd);
$freewordSuggestSearch.find("input[name=sgtnm]").prop("disabled",false).val($(jqObj).data("qs-sgtnm"));YAHOO.JP.lib.formhint.clearPlaceholder();sendClickLog($(jqObj),function(){$freewordSuggestSearch.submit();
});}function bindSuggest(){$freewordText.off("click").on("click",function(){if($(this).val()===""){$freewordResultArea.hide();$popularResultArea.slideDown("fast",function(){var id=$(this).attr("id");bindOutsideHide(id);
setAndSendSuggestLinkTracker();});}});$freewordText.off("keyup").on("keyup",function(){requestSuggest($(this).val());if($(this).val().length>=1){YAHOO.JP.trv.qs.domesticlodging_area.disable();}else{YAHOO.JP.trv.qs.domesticlodging_area.enable();
}$(this).change();});$freewordText.off("input").on("input",function(){if($(this).val().length<=0){$(this).change();return;}requestSuggest($(this).val());if($(this).val().length>=1){YAHOO.JP.trv.qs.domesticlodging_area.disable();
}else{YAHOO.JP.trv.qs.domesticlodging_area.enable();}$(this).change();});}function requestSuggest(text){$("#qs_freewordReset").hide();if(text!==""){$popularResultArea.hide();$("#qs_freewordReset").show();
setAndSendCloseButtonTracker();if(beforeSuggestText!==text&&!_ajaxFlg){_ajaxFlg=true;var ajaxOption=$.extend(true,{},conf.ajax);ajaxOption.url=conf.fs.url.suggest;ajaxOption.dataType=conf.jsonSuggest;ajaxOption.async=true;
ajaxOption.data={"query":text,"result":5,"type":null};ajaxOption.success=function(data,status,xhr){suggestCallback(data);};ajaxOption.complete=function(xhr,status){_ajaxFlg=false;};$.ajax(ajaxOption);}}else{$freewordResultArea.hide();
$popularResultArea.slideDown("fast",function(){var id=$(this).attr("id");bindOutsideHide(id);});}beforeSuggestText=text;}function suggestCallback(data){var result=data.ResultSet.Result;var html=new Array(conf.fs.blockorder.length);
if(typeof result!="undefined"){storeZeromatchHistory(data["@query"],result);}if(typeof result=="undefined"||result.length===0){$popularResultArea.hide();$freewordResultArea.hide();}else{var isAllBlank=true;
var blockcount=0;var backBlock=null;$.each(result,function(k,v){for(var key in v){if(typeof v[key]=="number"){v[key]=v[key].toString();}}if(!(v.CategoryCode in conf.fs.blockidxmap)){return true;}if($.trim(v.CategoryCode)==="SL"&&(!v.Url||!v.Name)){return true;
}var blockidx=conf.fs.blockidxmap[v.CategoryCode];var blockorder=conf.fs.blockorder[blockidx];var maxBlockCount=conf.fs.blockcount[blockidx];if(maxBlockCount===0){return true;}html[blockorder]=html[blockorder]?html[blockorder]:"";
if(backBlock!==null&&backBlock!==v.Block){html[blockorder]+="</ul>";html[blockorder]+="<ul>";blockcount=0;}else{if(backBlock===null){html[blockorder]+="<ul>";}}var areaCode=("0"+$.trim(v.PrefCode)).slice(-2);
var suffix="";if($.trim(v.CategoryCode)==="EK"){suffix="駅";}else{if($.trim(v.CategoryCode)==="LL"){suffix="地方";}}if(maxBlockCount>blockcount){if($.trim(v.CategoryCode)==="SL"){var suggestImage=$.trim(v.Image)?$.trim(v.Image):noImage;
var url=$.trim(v.Url)+(v.Url.indexOf("?")!=-1?"&":"?")+$.param(SUGGEST_SPECIAL_PARAMS);html[blockorder]+='<li class="featureList_list"><a href="'+url+'" class="featureList_link">'+'<p class="featureList_image"><img src="'+suggestImage+'"></p><p class="featureList_text">'+$.trim(v.Name)+"</p></a></li>";
}else{html[blockorder]+='<li><a name="qs_suggestLink" data-qs-sgttyp="'+$.trim(v.CategoryCode)+'" data-qs-sgtcd="'+$.trim(v.Code)+'" data-qs-sgtnm="'+$.trim(v.Name)+'" data-qs-sc_i="'+sc_i+'" href="javascript:void(0);">'+$.trim(v.Name)+suffix+($.trim(v.PrefCode)?"</a>"+"<span>（"+BT_PREF_AREA_MST[areaCode].name+"）</span>":"</a>")+"</li>";
}isAllBlank=false;}blockcount++;backBlock=v.Block;});html[conf.fs.blockorder.length-1]=html[conf.fs.blockorder.length-1]?html[conf.fs.blockorder.length-1]+"</ul>":"</ul>";if(isAllBlank){$popularResultArea.hide();
$freewordResultArea.hide();return;}$popularResultArea.hide();$freewordResultArea.html(html.join("")).slideDown("fast",function(){var id=$(this).attr("id");bindOutsideHide(id);});$freewordResultArea.find("a[name=qs_suggestLink]").off("click").on("click",function(){sgtLinkActionForTest(this);
});setAndSendSuggestLinkTracker();}}function initZeromatchHistory(){zeromatchFlg=false;zeromatchPointer=0;zeromatchHistory=[];}function getLinkCount(){if(!freewordAreaLinkCount){var search=$("#qs_query_search");
if(search.data("rapid_p")!=undefined){freewordAreaLinkCount=search.data("rapid_p")+1;}else{freewordAreaLinkCount=$("a").length+1;}}return freewordAreaLinkCount++;}function setAndSendCloseButtonTracker(){if($("#qs_freewordReset").data("ylk")){return true;
}var slk="del",_p=getLinkCount();var ylk="sec:"+secKey+";"+"slk:"+slk+";";$("#qs_freewordReset").data("ylk",ylk).data("rapid_p",_p);sendLinkViews([{"sec":secKey,"_links":[{"slk":slk,"_p":_p}]}]);}function setAndSendSuggestLinkTracker(){var slk="list",pos="_",link_data=[];
$("a[name=qs_popularSpotName], a[name=qs_suggestLink]").each(function(){if($(this).data("ylk")){return true;}var stp=$(this).data("qs-sgttyp"),scd=$(this).data("qs-sgtcd"),ylk="sec:"+secKey+";"+"slk:"+slk+";"+"pos:"+pos+";"+"stp:"+stp+";"+"scd:"+scd+";",_p=getLinkCount();
$(this).data("ylk",ylk).data("rapid_p",_p);link_data.push({"slk":slk,"pos":pos,"stp":stp,"scd":scd,"_p":_p});});if(link_data.length>0){sendLinkViews([{"sec":secKey,"_links":link_data}]);}}function storeZeromatchHistory(query,result){if(result.length>0){if(zeromatchFlg){zeromatchFlg=false;
++zeromatchPointer;}}else{if(!zeromatchFlg){zeromatchFlg=true;}zeromatchHistory[zeromatchPointer]=query;}}function createZstrData(zeromatch_data_base){var zstr_data=[],remaining_zeromach_data=[],zstr="",target_data=zeromatch_data_base.concat();
while(target_data.length>0){zstr=JSON.stringify(target_data);if(zstr.length<=trackingLogMaxLength){break;}remaining_zeromach_data.push(target_data.pop());}if(zstr.length>trackingLogMaxLength){var cut_length=trackingLogMaxLength-jsonUseFixedMinLength,cut_target=zeromatch_data_base[0];
do{var cut_zeromatch_data=cut_target.substr(0,cut_length--);zstr=JSON.stringify([cut_zeromatch_data]);}while(zstr.length>trackingLogMaxLength);remaining_zeromach_data.pop();}zstr_data.push(zstr);if(remaining_zeromach_data.length>0){zstr_data=zstr_data.concat(createZstrData(remaining_zeromach_data));
}return zstr_data;}function sendZeromatchData(){if(zeromatchHistory.length==0){return;}var zeromatch_data={"sec":secKey,"_links":[],},slk="zero";var zstr_data=createZstrData(zeromatchHistory);$.each(zstr_data,function(k,zstr){var link_data={"zstr":zstr,"slk":slk,"_p":getLinkCount()};
zeromatch_data._links.push(link_data);});sendLinkViews([zeromatch_data],function(){$.each(zeromatch_data._links,function(k,ylk){var _p=ylk._p;delete ylk.slk;delete ylk._p;YAHOO.JP.trv.ins.beaconClick(secKey,slk,_p,ylk);
});});initZeromatchHistory();}function sendClickLog(click_target,callback){$.tvPg.rapid3.sendBeaconClick(click_target,"",callback);}function sendLinkViews(link_data,callback){var ins=YAHOO.JP.trv.ins||{};
if(!ins||!ins.beaconLinkViews){$.each(link_data,function(k,v){if(v.sec!=secKey){return true;}unsentLinkViews=unsentLinkViews.concat(v._links);});return;}if(unsentLinkViews.length>0){$.each(link_data,function(k,v){if(v.sec!=secKey){return true;
}v._links=v._links.concat(unsentLinkViews);unsentLinkViews=[];return false;});}if($.isFunction(callback)){callback={"call":callback};}ins.beaconLinkViews(link_data,false,{},callback);}function disableFreeKey(){$("#qs_freewordKey").addClass("disabled");
$freewordText.prop("disabled",true);$("#qs_freewordReset").hide();$freewordText.removeAttr("placeholder");$freewordText.addClass("dis");}function sgtLinkActionForTest(jqObj){var type=$(jqObj).data("qs-sgttyp");
var cd=$(jqObj).data("qs-sgtcd");var $submitForm=$("#hotelSearch");$submitForm.find("input[name=qry]").prop("disabled",true);$submitForm.find("input[name=sgttyp]").prop("disabled",false).val(type);$submitForm.find("input[name=sgtcd]").prop("disabled",false).val(cd);
$submitForm.find("input[name=sgtnm]").prop("disabled",false).val($(jqObj).data("qs-sgtnm"));$submitForm.find("input[name=sc_i]").prop("disabled",false).val($(jqObj).data("qs-sc_i"));sendClickLog($(jqObj),function(){YAHOO.JP.trv.qs.domesticlodging.submit();
});}function setNoResultMessage(isNoResult){if(isNoResult){$noResultArea.show();$freewordText.addClass("invalid");}else{$noResultArea.hide();if(($noKeyWord==null)||($noKeyWord.css("display")=="none")){$freewordText.removeClass("invalid");
}}}function setNoKeyMessage(isNoKey){if(isNoKey){$freewordText.addClass("invalid");$noKeyWord.show();}else{$noKeyWord.hide();if($noResultArea==null||$noResultArea.css("display")=="none"){$freewordText.removeClass("invalid");
}}}function noEnterKey(){$("#qs_freewordText").keydown(function(e){if((e.which&&e.which===13)||(e.keyCode&&e.keyCode===13)){return false;}else{return true;}});}var sub={init:function(suggestSearchFormID,bucketId){_suggestSearchFormID=suggestSearchFormID;
_ajaxFlg=false;if(bucketId){_bucketId=bucketId;}$freewordArea=$("#qs_freewordArea");$freewordText=$("#qs_freewordText");if($freewordText.val()!==""){$("#qs_freewordReset").show();setAndSendCloseButtonTracker();
}$freewordResultArea=$("#qs_freewordResultArea");$popularResultArea=$("#qs_popularResultArea");YAHOO.JP.trv.qs.freeword.bind();initZeromatchHistory();noEnterKey();},bind:function(){bindSuggest();$("#qs_freewordResultAreaCloseBtn").off("click").on("click",function(){$popularResultArea.hide();
});$popularResultArea.find("a[name=qs_popularSpotName]").off("click").on("click",function(){sgtLinkActionForTest(this);});$("#qs_freewordReset").off("click").on("click",function(){$(this).hide();$freewordText.val("").focus().change();
$freewordResultArea.hide();beforeSuggestText="";$popularResultArea.slideDown("fast",function(){var id=$(this).attr("id");bindOutsideHide(id);});if($(this).data("qs-viewtype")==="spot"){$(".mdAreaFilter").remove();
$("#disabledTxt").remove();if(YAHOO.JP.trv.qs.domesticlodging_checkinout){YAHOO.JP.trv.qs.domesticlodging_checkinout.remove();}if(YAHOO.JP.trv.qs.domesticlodging_roomperson){YAHOO.JP.trv.qs.domesticlodging_roomperson.remove();
}$qry=$("input[name=qry]");$qry.prop("disabled",false);$qry.val("");$qry.focus();$(".spotLabel").remove();var area_info=$("#area_info");area_info.attr("data-area-type","");area_info.attr("data-area-cd","");
area_info.attr("data-area-name","");}YAHOO.JP.trv.qs.domesticlodging_area.enable();sendClickLog($(this));});YAHOO.JP.trv.qs.freeword.waitLoadFormhint();},bindforload:function(){$(window).off("beforeunload.zeromatch").on("beforeunload.zeromatch",sendZeromatchData);
},waitLoadFormhint:function(){if(retryCount>=retryMax){retryCount=0;return;}retryCount++;if(YAHOO.JP.lib){retryCount=0;YAHOO.JP.lib.domReady.add(function(){YAHOO.JP.lib.formhint.init({FORMHINT_CLASS_NAME:"jsAutoPlaceholder",FORM_ID:"hotelSearch"});
});}else{setTimeout(function(){YAHOO.JP.trv.qs.freeword.waitLoadFormhint();},retryTimer);}}};return sub;})(jQuery,YAHOO.JP.trv.qs.conf);