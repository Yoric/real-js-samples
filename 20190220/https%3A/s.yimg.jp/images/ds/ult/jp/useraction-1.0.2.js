(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)})([function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var Logger=__webpack_require__(3);var ViewableManager=__webpack_require__(5);var DwellListener=__webpack_require__(16);var YjsmhListener=__webpack_require__(17);var OffsetManager=__webpack_require__(18);var keyMap=__webpack_require__(2);if(typeof window.YAHOO==="undefined"||!window.YAHOO){window.YAHOO={}}YAHOO.i13n=YAHOO.i13n||{};YAHOO.i13n.JP=YAHOO.i13n.JP||{};YAHOO.i13n.JP.UserAction=function(userConfing){var noProcessFunction={addModules:function(){},enableAutoOffset:function(){},setTopOffset:function(){},setBottomOffset:function(){},setPageParam:function(){},addPageParam:function(){},setYlkWhitelist:function(){},stop:function(){},start:function(){}};if(U.isLessThanIE8(document,navigator)){return noProcessFunction}var config=__webpack_require__(4)(document.defaultView,userConfing);if(location.href.indexOf("shadebug=1")>=0&&config.debugLevel<1){config.debugLevel=1}var log=Logger();var vmgrs=[];var om=OffsetManager();DwellListener(vmgrs);YjsmhListener(vmgrs);return{addModules:function(target){if(U.isArray(target)){target.forEach(function(v){config.targetModules.push({id:v+""})})}else{config.targetModules.push({id:target+""})}return this},enableAutoOffset:function(time){if(U.isNumber(time)){config.offsetReevaluateTime=time}config.autoOffset=true;return this},setTopOffset:function(offset){config.autoOffset=false;config.viewableTopOffset=offset;return this},setBottomOffset:function(offset){config.autoOffset=false;config.viewableBottomOffset=offset;return this},setPageParam:function(pp){Object.keys(pp).forEach(function(key){if(U.isString(keyMap[key])){pp[keyMap[key]]=pp[key];delete pp[key]}});config.pp=pp;return this},addPageParam:function(arg1,arg2){if(arguments.length===1&&U.isObject(arg1)){Object.keys(arg1).forEach(function(key){if(U.isString(keyMap[key])){config.pp[keyMap[key]]=arg1[key]}else{config.pp[key]=arg1[key]}})}else if(U.isString(arg1)&&U.isPrimitive(arg2)){if(U.isString(keyMap[arg1])){arg1=keyMap[arg1]}config.pp[arg1]=arg2}else{log.w("Invalid argments: addPageParam()")}return this},setYlkWhitelist:function(ylkWhitelist){if(U.isArray(ylkWhitelist)){config.ylkWhitelist=ylkWhitelist}else{log.w("Invalid argment. expect Array[String] : setYlkWhitelist()")}return this},stop:function(){vmgrs.forEach(function(v){v.stop()});om.stop();return this},start:function(){config.targetModules.forEach(function(mod){var isFind=false;vmgrs.forEach(function(vm){if(mod.id===vm.getListId()){isFind=true;if(!vm.isActive()){vm.start()}}});if(!isFind){var vmgr=ViewableManager(mod.id);vmgr.start();vmgrs.push(vmgr);log.d("New tracking started!",config)}});om.start();return this}}}},function(module,exports,__webpack_require__){"use strict";var keyMap=__webpack_require__(2);var MAX_VALUE_LENGTH=300;module.exports={is:function(type,obj){var clas=Object.prototype.toString.call(obj).slice(8,-1);return typeof obj!=="undefined"&&obj!==null&&clas===type},isObject:function(val){return this.is("Object",val)},isArray:function(val){return this.is("Array",val)},isString:function(val){return this.is("String",val)},isNumber:function(val){return this.is("Number",val)},isBoolean:function(val){return this.is("Boolean",val)},isPrimitive:function(val){return this.isNumber(val)||this.isString(val)||this.isBoolean(val)},isFunction:function(val){return this.is("Function",val)},isNull:function(val){return val===null},isNaN:function(val){return val!==val},findKey:function(obj,key){return this.is("Object",obj)&&obj.hasOwnProperty(key)},isUndef:function(val){return typeof val==="undefined"},isDOMElement:function(obj){var type=Object.prototype.toString.call(obj).slice(8,-1);return type.match(/^HTML.*Element$/)},isDivElement:function(val){return this.is("HTMLDivElement",val)},getContentEnv:function(el,attrName,mapDelim,valDelim){var contentConfig={};var key,value;attrName=this.isString(attrName)?attrName:"data-ual";var attr=el.getAttribute(attrName);if(this.isString(attr)){var ary=attr.split(mapDelim);var length=ary.length;for(var i=0;i<length;i++){var kv=ary[i].split(valDelim);if(kv.length>1){key=kv[0];if(this.isString(keyMap[key])){key=keyMap[key]}kv.shift();value=kv.join(valDelim);if(value.length>MAX_VALUE_LENGTH){value=value.substr(0,MAX_VALUE_LENGTH)}contentConfig[key]=value}}}return contentConfig},setContentEnv:function(el,attrName,evnObject,mapDelim,valDelim){var newParamString="";Object.keys(evnObject).forEach(function(key){newParamString+=key+valDelim+evnObject[key]+mapDelim});el.setAttribute(attrName,newParamString)},merge:function(){var rv={};var length=arguments.length;function work(k){rv[k]=this[k]}for(var i=0;i<length;i++){Object.keys(arguments[i]).forEach(work,arguments[i])}return rv},mergeOverwrite:function(){var rv=arguments[0];var length=arguments.length;function work(k){rv[k]=this[k]}for(var i=1;i<length;i++){Object.keys(arguments[i]).forEach(work,arguments[i])}return rv},getTime:function(){var date=new Date;return date.getTime()},getHundredArray:function(){var ary=new Array(100);for(var i=0;i<100;i++){ary[i]=0}return ary},getOs:function(defaultView){var os,ua=defaultView.navigator.userAgent;if(ua.match(/windows\sphone/i)){os="windowsphone"}else if(ua.match(/windows/i)){os="windows"}else if(ua.match(/iphone|ipad/i)){os="ios"}else if(ua.match(/mac|ppc/i)){os="mac"}else if(ua.match(/android/i)){os="android"}else{os="other"}return os},hasClass:function(el,className){return(" "+el.className+" ").replace(/[\n\t]/g," ").indexOf(" "+className+" ")!==-1},getXPath:function(e){if(e.nodeType===9){return""}if(e.hasAttribute("id")){return'id("'+e.getAttribute("id")+'")'}var p=e.parentNode;var t=this.getXPath(p)+"/"+e.tagName.toLowerCase();var c=p.childNodes;var g=0;var s;for(var i=0,n=c.length;i<n;++i){if(c[i].nodeName===e.nodeName&&c[i].nodeType===e.nodeType){++g;if(c[i]===e){s=g}}}if(g===1){return t}t+="["+s+"]";return t},isLessThanIE8:function(doc,nav){var isIE=nav.userAgent.match(/MSIE\s[^;]*/)||nav.userAgent.match(/Trident\/[^;]*/)?1:0;if(isIE){var iev=-1;if(doc.documentMode){iev=doc.documentMode}else{iev=5;if(doc.compatMode){if(doc.compatMode==="CSS1Compat"){iev=7}}}if(iev<9){return true}}return false}}},function(module,exports){"use strict";module.exports={content_id:"contid",id_type:"idtype",associated_id:"associd",content_service:"contsvc",content_type:"ctypeid",ss_join_key:"ssjkey",screen_id:"scid"}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);function printLog(func,args){var array=Array.prototype.slice.call(args);var d=new Date;array.unshift("["+d.toLocaleTimeString()+"."+d.getUTCMilliseconds()+"]");array.unshift("[UAL]");try{func.apply(console,array)}catch(e){console.log("[UAL] ["+d.toLocaleTimeString()+"."+d.getUTCMilliseconds()+"] print error")}}module.exports=function(){var config=__webpack_require__(4)();var debugLevel=config.debugLevel;if(U.isUndef(console)||U.isUndef(console.log)){return{d:function(){},w:function(){},e:function(){}}}else{return{d:function(){if(debugLevel>0){printLog(console.log,arguments)}},w:function(){if(U.isUndef(console.warn)){printLog(console.log,arguments)}else{printLog(console.warn,arguments)}},e:function(){if(U.isUndef(console.error)){printLog(console.log,arguments)}else{printLog(console.error,arguments)}}}}}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var DEFAULT="default",LIST="list",DETAIL="detail",DIGEST="digest";function configure(defaultView,userConfig){var u=typeof userConfig==="object"?userConfig:{};var d={targetModules:[],pollingTime:100,offsetReevaluateTime:1e3,autoOffset:false,viewableTopOffset:0,viewableBottomOffset:0,debugLevel:0,valDelim:":",mapDelim:";",dataAttr:"data-ual",trackingTypeAttr:"data-ual-view-type",goToDigestNoflow:{attr:"data-ual-gotodigest-noflow",name:"go_to_article"},goToArticle:{attr:"data-ual-gotoarticle",name:"go_to_article"},goToArticleNoflow:{attr:"data-ual-gotoarticle-noflow",name:"go_to_article"},newDataAttr:"data-ual-new-data",updateDataAttr:"data-ual-update-data",rapidAttr:"data-ylk",pp:{apptype:"web"},ylkWhitelist:["sec","slk","pos"],queueSize:30,interval:5e3,noClickListen:"no-click-resp",nofollowClass:"rapidnofollow",yqlHost:null};return{targetModules:U.isArray(u.targetModules)?u.targetModules:d.targetModules,pollingTime:U.isNumber(u.pollingTime)?u.pollingTime:d.pollingTime,offsetReevaluateTime:U.isNumber(u.offsetReevaluateTime)?u.offsetReevaluateTime:d.offsetReevaluateTime,autoOffset:U.isBoolean(u.autoOffset)?u.autoOffset:d.autoOffset,viewableTopOffset:U.isNumber(u.viewableTopOffset)?u.viewableTopOffset:d.viewableTopOffset,viewableBottomOffset:U.isNumber(u.viewableBottomOffset)?u.viewableBottomOffset:d.viewableBottomOffset,debugLevel:U.isNumber(u.debugLevel)?u.debugLevel:d.debugLevel,valDelim:U.isString(u.valDelim)?u.valDelim:d.valDelim,mapDelim:U.isString(u.mapDelim)?u.mapDelim:d.mapDelim,dataAttr:U.isString(u.dataAttr)?u.dataAttr:d.dataAttr,trackingTypeAttr:U.isString(u.trackingTypeAttr)?u.trackingTypeAttr:d.trackingTypeAttr,goToDigestNoflow:U.isObject(u.goToDigestNoflow)?u.goToDigestNoflow:d.goToDigestNoflow,goToArticle:U.isObject(u.goToArticle)?u.goToArticle:d.goToArticle,goToArticleNoflow:U.isObject(u.goToArticleNoflow)?u.goToArticleNoflow:d.goToArticleNoflow,newDataAttr:U.isString(u.newDataAttr)?u.newDataAttr:d.newDataAttr,updateDataAttr:U.isString(u.updateDataAttr)?u.updateDataAttr:d.updateDataAttr,rapidAttr:U.isString(u.rapidAttr)?u.rapidAttr:d.rapidAttr,pp:U.isObject(u.pp)?u.pp:d.pp,ylkWhitelist:U.isArray(u.ylkWhitelist)?u.ylkWhitelist:d.ylkWhitelist,queueSize:U.isNumber(u.queueSize)?u.queueSize:d.queueSize,interval:U.isNumber(u.interval)?u.interval:d.interval,noClickListen:U.isString(u.noClickListen)?u.noClickListen:d.noClickListen,nofollowClass:U.isString(u.nofollowClass)?u.nofollowClass:d.nofollowClass,yqlHost:U.isString(u.yqlHost)?u.yqlHost:d.yqlHost,DEFAULT:DEFAULT,LIST:LIST,DETAIL:DETAIL,DIGEST:DIGEST,ALLOW_TYPE:[DEFAULT,LIST,DETAIL,DIGEST],libPageParam:{_handler:"shn",os:U.getOs(defaultView),sdk:"Rapid",ext:"UserActionLogger",extv:"1.0.2"}}}var instance;module.exports=function(defaultView,userConfig){instance=instance||configure(defaultView,userConfig);return instance}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var createViewstartData=__webpack_require__(6);var createViewendData=__webpack_require__(7);var Logger=__webpack_require__(3);var Visibility=__webpack_require__(8);var ContentEventManager=__webpack_require__(9);module.exports=function(elementId){var config=__webpack_require__(4)();var queueManager=__webpack_require__(15)();var log=Logger();var visibility=Visibility();var visibleContents={};var invalidTypeError=false;var ref={isSuspend:true};var moduleElement=document.getElementById(elementId);if(U.isNull(moduleElement)){log.e("The ID of the specified list can not be found. Viewable Complete the calculation. : (ID = "+elementId+")");return{}}var moduleParam=U.getContentEnv(moduleElement,config.dataAttr,config.mapDelim,config.valDelim);var contentEventManager=ContentEventManager(visibleContents,moduleParam,ref);function reevaluateModuleViewability(){var contentElements=moduleElement.querySelectorAll("["+config.dataAttr+"]");var checkedContent={};var length=U.isNumber(contentElements.length)?contentElements.length:0;for(var i=0;i<length;i++){var time=U.getTime();var el=contentElements[i];var contentXPath=U.isUndef(el.xpath)?U.getXPath(el):el.xpath;var type=el.getAttribute(config.trackingTypeAttr);if(config.ALLOW_TYPE.indexOf(type)<0){if(!invalidTypeError){log.e("Data-ual-view-type isn't set correctly! Start tracking as list.",el);invalidTypeError=true}type=config.DEFAULT}el.xpath=contentXPath;checkedContent[contentXPath]=1;if(U.isUndef(visibleContents[contentXPath])){visibleContents[contentXPath]={st:0,vr:0,_type:type};if(type===config.LIST||type===config.DEFAULT){visibleContents[contentXPath].vat=0;visibleContents[contentXPath]._viewable_in_time=0}}var vc=visibleContents[contentXPath];var vap=visibility.getAreaProportion(el);if(vap>0){if(config.debugLevel>1){var div=el.querySelector(".uainfo");if(!div){div=document.createElement("div");div.className="uainfo";div.style.position="absolute";div.style.backgroundColor="rgba(0,0,0,0.4)";div.style.color="#FFF";div.style.padding="3px";div.style.left=0;div.fontSize="13pt";div.zIndex="100000";el.appendChild(div)}div.innerHTML="";if(U.isObject(vc._env)&&U.isString(vc._env.contid)){div.innerHTML+=vc._env.contid.substr(0,12)+"<br>"}div.innerHTML+=(vap*100+"").substr(0,5)+"%<br>ViewRate:"+vc.vr+"%<br>";if(!U.isUndef(vc.st)){div.innerHTML+="ViewTime:"+Math.floor((U.getTime()-vc.st)/1e3)+"秒"}}vc._env=U.getContentEnv(el,config.dataAttr,config.mapDelim,config.valDelim);if(vc.st===0){vc.st=time;vc._rate_work=U.getHundredArray();queueManager.push(createViewstartData(type,U.merge(moduleParam,vc._env,{ts:time})));if(config.debugLevel>1){el.style.borderLeft="2px solid red";el.style.borderRight="2px solid red";el.style.borderBottom="2px solid red"}}if(type===config.LIST||type===config.DEFAULT){if(vap>=.5&&vc._viewable_in_time===0){vc._viewable_in_time=time}else if(vap<.5&&vc._viewable_in_time!==0){vc.vat+=time-vc._viewable_in_time;vc._viewable_in_time=0}}var vr=visibility.getReadProportion(vc,el);if(U.isNumber(vr)){vc.vr=vr}}else if(vc.st!==0){queueManager.push(createViewendData(type,U.merge(moduleParam,vc._env,vc)));delete visibleContents[contentXPath];if(type===config.DETAIL||type===config.DIGEST){queueManager.send()}if(config.debugLevel>1){el.style.borderLeft="2px solid rgba(0,0,0,0)";el.style.borderRight="2px solid rgba(0,0,0,0)";el.style.borderBottom="2px solid rgba(0,0,0,0)"}}contentEventManager.addFlowEvent(el)}queueManager.flush(visibleContents,moduleParam,checkedContent);if(queueManager.isOverMaxQueueSize()){queueManager.send()}queueManager.setTimer();setTimeout(function(){if(!ref.isSuspend){reevaluateModuleViewability()}},config.pollingTime)}return{start:function(){ref.isSuspend=false;reevaluateModuleViewability()},suspend:function(){queueManager.send();ref.isSuspend=true},stop:function(){queueManager.flush(visibleContents,moduleParam);queueManager.send();ref.isSuspend=true},send:function(){queueManager.send()},isActive:function(){return!ref.isSuspend},getListId:function(){return elementId},getQueueSize:function(){return queueManager.getQueueSize}}}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var ACTION_MAP={"default":"",list:"view_article_list_start",detail:"view_article_detail_start",digest:"view_article_digest_start"};var Logger=__webpack_require__(3);module.exports=function(type,params){var log=Logger();if(U.findKey(ACTION_MAP,type)){params.actid=ACTION_MAP[type]}if(!U.findKey(params,"slk")){params.slk="_"}log.d("["+params.actid+"] contid = "+params.contid);return params}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var ACTION_MAP={"default":"",list:"view_article_list_end",detail:"view_article_detail_end",digest:"view_article_digest_end"};var Logger=__webpack_require__(3);module.exports=function(type,params){var log=Logger();var time=U.getTime();params.et=time;params.ts=time;params.vt=time-params.st;if(U.findKey(ACTION_MAP,type)){params.actid=ACTION_MAP[type]}delete params._rate_work;delete params._env;delete params._type;if(U.isNumber(params.vat)&&U.findKey(params,"_viewable_in_time")){if(U.isNumber(params._viewable_in_time)&&params._viewable_in_time!==0){params.vat+=time-params._viewable_in_time}delete params._viewable_in_time}if(!U.findKey(params,"slk")){params.slk="_"}log.d("["+params.actid+"] contid = "+params.contid);return params}},function(module,exports,__webpack_require__){"use strict";module.exports=function(){var config=__webpack_require__(4)();return{getAreaProportion:function(el){var linkStyle=window.getComputedStyle(el);var topOffset=config.viewableTopOffset;var bottomOffset=config.viewableBottomOffset;if(linkStyle.getPropertyValue("visibility")==="hidden"||linkStyle.getPropertyValue("display")==="none"){return 0}var elRect=el.getBoundingClientRect();var viewableRect={};var windowInnerHeight=window.innerHeight||document.documentElement.clientHeight;var windowInnerWidth=window.innerWidth||document.documentElement.clientWidth;windowInnerHeight-=bottomOffset;if(elRect.left>=windowInnerWidth||elRect.top>=windowInnerHeight){return 0}windowInnerHeight-=topOffset;viewableRect.right=elRect.right;viewableRect.bottom=elRect.bottom;viewableRect.left=elRect.left;viewableRect.top=elRect.top;if(topOffset!==0){viewableRect.top-=topOffset;viewableRect.bottom-=topOffset}viewableRect.top=viewableRect.top<0?0:viewableRect.top;viewableRect.left=viewableRect.left<0?0:viewableRect.left;viewableRect.bottom=viewableRect.bottom>windowInnerHeight?windowInnerHeight:viewableRect.bottom;viewableRect.right=viewableRect.right>windowInnerWidth?windowInnerWidth:viewableRect.right;viewableRect.width=viewableRect.right-viewableRect.left;viewableRect.height=viewableRect.bottom-viewableRect.top;return viewableRect.width*viewableRect.height/(elRect.width*elRect.height)},getReadProportion:function(vc,el){var elRect=el.getBoundingClientRect();var windowInnerHeight=window.innerHeight||document.documentElement.clientHeight;var topOffset=config.viewableTopOffset;var bottomOffset=config.viewableBottomOffset;if(elRect.top>windowInnerHeight-bottomOffset){return null}if(elRect.bottom-topOffset<0){return null}if(vc.vr===100){return null}windowInnerHeight-=bottomOffset+topOffset;var orgRect={top:elRect.top-topOffset,bottom:elRect.bottom-topOffset};var viewableRect={top:orgRect.top<0?0:orgRect.top,bottom:orgRect.bottom>windowInnerHeight?windowInnerHeight:orgRect.bottom};viewableRect.top-=orgRect.top;viewableRect.bottom-=orgRect.top;orgRect.bottom-=orgRect.top;orgRect.top-=orgRect.top;var scale=orgRect.bottom/100;var tp=viewableRect.top/scale;var bp=viewableRect.bottom/scale;for(var i=Math.ceil(tp);i<Math.floor(bp);i++){vc._rate_work[i]=true}var r=0;for(i=0;i<100;i++){r+=vc._rate_work[i]===true?1:0}return vc.vr>r?vc.vr:r}}}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var ClickHandler=__webpack_require__(10);module.exports=function(visibleContents,moduleParam,ref){var config=__webpack_require__(4)();var gotoSelector="["+config.goToArticle.attr+"], ["+config.goToArticleNoflow.attr+"], ["+config.goToDigestNoflow.attr+"]";var clickHandler=ClickHandler(visibleContents,moduleParam,ref);return{addFlowEvent:function(contentElement){var clickableElements=contentElement.querySelectorAll(gotoSelector),clickableElementsLength=clickableElements.length,contentXPath=U.getXPath(contentElement);for(var i=0;i<clickableElementsLength;i++){var el=clickableElements[i];var handler=null;if(!U.isUndef(el.__ual_id)){continue}if(el.getAttribute(config.goToArticle.attr)!==null){handler=clickHandler.goToArticle}else if(el.getAttribute(config.goToArticleNoflow.attr)!==null){handler=clickHandler.goToNoflow}else if(el.getAttribute(config.goToDigestNoflow.attr)!==null){handler=clickHandler.goToNoflow}if(handler!==null){el.__ual_id=contentXPath;el.addEventListener("click",handler,true)}}}}}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var createGotoData=__webpack_require__(11);var createViewendData=__webpack_require__(7);var getParentDomByAttribute=__webpack_require__(13);var newParamSetter=__webpack_require__(14);module.exports=function(visibleContents,moduleParam,ref){var config=__webpack_require__(4)();var queueManager=__webpack_require__(15)();return{goToArticle:function(event){var clickParam=createGotoData.call(this,moduleParam,"goToArticle",event,true);if(U.isObject(clickParam)){queueManager.push(clickParam);queueManager.flush(visibleContents,moduleParam);queueManager.send()}ref.isSuspend=true},goToNoflow:function(event){var ualElement=getParentDomByAttribute(this,config.dataAttr);var xpath=U.getXPath(ualElement);var vc=visibleContents[xpath];var clickParam={};if(U.isObject(vc)){queueManager.push(createViewendData(vc._type,U.merge(moduleParam,vc._env,vc)));delete visibleContents[xpath]}if(this.getAttribute(config.goToDigestNoflow.attr)){clickParam=createGotoData.call(this,moduleParam,"goToDigestNoflow",event,false)}else{clickParam=createGotoData.call(this,moduleParam,"goToArticleNoflow",event,false)}queueManager.push(clickParam);queueManager.send();newParamSetter(this)}}}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var Logger=__webpack_require__(3);var rapidUtil=__webpack_require__(12);var getParentDomByAttribute=__webpack_require__(13);module.exports=function(moduleParam,action,event,pageFlow){var config=__webpack_require__(4)();var log=Logger();function getAnchorTag(){var target=event.target||event.srcElement;var targetNodeName="";try{if(target&&target.nodeType===3){target=target.parentNode}}catch(exception){log.e(exception)}while(target&&(targetNodeName=target.nodeName.toLowerCase())&&targetNodeName!=="a"){target=target.parentNode}return target}function getUALData(el){var dataUal={};var ualContent=getParentDomByAttribute(el,config.dataAttr);if(ualContent){dataUal=U.getContentEnv(ualContent,config.dataAttr,config.mapDelim,config.valDelim)}return dataUal}var href;var parentEnv=getUALData(event.target||event.srcElement);var selfEnv=U.getContentEnv(this,config[action].attr,config.mapDelim,config.valDelim);if(U.isUndef(this.__ual_id)){return null}if(pageFlow){var atag=getAnchorTag();if(U.isNull(atag)){log.w("anchor tag not found.");return null}href=atag.getAttribute("href")}else{href=location.href}var clickParam=U.merge(rapidUtil.getYlkParam(config,this),moduleParam,{href:href},parentEnv,selfEnv,{actid:config[action].name,ts:U.getTime()});log.d("["+config[action].name+"] contid = "+clickParam.contid);return clickParam}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);module.exports={getYlkParam:function(config,rapidLink){var commonParam={};if(!U.isUndef(rapidLink)&&!U.isNull(rapidLink)){var rapidYlk=U.getContentEnv(rapidLink,config.rapidAttr,config.mapDelim,config.valDelim);if(U.findKey(rapidYlk,"rsec")){rapidYlk.sec=rapidYlk.rsec}config.ylkWhitelist.forEach(function(k){if(U.findKey(rapidYlk,k)){commonParam[k]=rapidYlk[k]}})}if(!U.findKey(commonParam,"slk")){commonParam.slk="_"}return commonParam}}},function(module,exports){"use strict";module.exports=function(ualContent,attr){while(ualContent&&ualContent.getAttribute(attr)===null){ualContent=ualContent.parentNode}return ualContent}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var getParentDomByAttribute=__webpack_require__(13);module.exports=function(noflowElement){var config=__webpack_require__(4)();var newParam=noflowElement.getAttribute(config.newDataAttr);var updateParam=noflowElement.getAttribute(config.updateDataAttr);var parent=getParentDomByAttribute(noflowElement,config.dataAttr);if(U.isDOMElement(parent)&&U.isFunction(parent.setAttribute)){if(noflowElement.getAttribute(config.goToDigestNoflow.attr)){parent.setAttribute(config.trackingTypeAttr,config.DIGEST)}else if(noflowElement.getAttribute(config.goToArticleNoflow.attr)){parent.setAttribute(config.trackingTypeAttr,config.DETAIL)}if(U.isString(newParam)&&newParam.length>0){parent.setAttribute(config.dataAttr,newParam)}else if(U.isString(updateParam)&&updateParam.length>0){var current=U.getContentEnv(parent,config.dataAttr,config.mapDelim,config.valDelim);var update=U.getContentEnv(noflowElement,config.updateDataAttr,config.mapDelim,config.valDelim);var newParamObject=U.merge(current,update);U.setContentEnv(parent,config.dataAttr,newParamObject,config.mapDelim,config.valDelim)}}}},function(module,exports,__webpack_require__){var Rapid=window.YAHOO.i13n.Rapid;"use strict";var U=__webpack_require__(1);var Logger=__webpack_require__(3);var createViewendData=__webpack_require__(7);function QueueManager(){var config=__webpack_require__(4)();var log=Logger();var queue=[];var timer=null;var rapid;try{if(U.isString(config.yqlHost)){rapid=Rapid({spaceid:0,pageview_on_init:false,apv:false,yql_host:config.yqlHost,compr_on:false})}else{rapid=Rapid({spaceid:0,pageview_on_init:false,apv:false,compr_on:false})}}catch(exception){log.e("Rapid is not loaded.")}function resetTimer(){if(!U.isNull(timer)){clearTimeout(timer);timer=null}}function send(){if(queue.length>0){try{rapid.setRapidAttribute({keys:config.pp});rapid.beaconLinkViews([{sec:"s",_links:queue}],false,{pp:U.merge(config.pp,config.libPageParam),use_jsonp:true});log.d("Send completely!",queue);queue=[]}catch(e){log.e("Sending failed. Rapid not found.")}}resetTimer()}function setTimer(){if(U.isNull(timer)&&queue.length>0){timer=setTimeout(send,config.interval)}}return{flush:function(visibleContents,moduleParam,checkedContent){var type;checkedContent=U.isObject(checkedContent)?checkedContent:{};for(var key in visibleContents){if(U.isUndef(checkedContent[key])&&visibleContents[key].st!==0){type=visibleContents[key]._type;if(config.ALLOW_TYPE.indexOf(type)<0){type=config.DEFAULT}queue.push(createViewendData(type,U.merge(moduleParam,visibleContents[key]._env,visibleContents[key])));log.d("[view_end] contid = "+visibleContents[key].contid);delete visibleContents[key]}}},send:function(){send()},push:function(data){queue.push(JSON.parse(JSON.stringify(data)))},resetTimer:function(){resetTimer()},setTimer:function(){setTimer()},isOverMaxQueueSize:function(){return queue.length>config.queueSize},getQueueSize:function(){return queue.length}}}var instance;module.exports=function(){instance=instance||QueueManager();return instance}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var Logger=__webpack_require__(3);var ACTIVE=1,INACTIVE=0;module.exports=function(vmgrs){var log=Logger();var events={focus:ACTIVE,pageshow:ACTIVE,"visibilitychange-visible":ACTIVE,blur:INACTIVE,pagehide:INACTIVE,"visibilitychange-hidden":INACTIVE,beforeunload:INACTIVE,unload:INACTIVE};var state=ACTIVE;var hidden,visibilityChange;if(typeof document.hidden!=="undefined"){hidden="hidden";visibilityChange="visibilitychange"}else if(typeof document.mozHidden!=="undefined"){hidden="mozHidden";visibilityChange="mozvisibilitychange"}else if(typeof document.msHidden!=="undefined"){hidden="msHidden";visibilityChange="msvisibilitychange"}else if(typeof document.webkitHidden!=="undefined"){hidden="webkitHidden";visibilityChange="webkitvisibilitychange"}function callback(e){var newState=-1;var eventType=e.type;if(e.type===visibilityChange){if(document[hidden]){eventType="visibilitychange-hidden"}else{eventType="visibilitychange-visible"}}if(Object.prototype.hasOwnProperty.call(events,eventType)){newState=events[eventType]}if(newState===-1){return}if(state===newState){return}state=newState;if(state===INACTIVE){if(U.isArray(vmgrs)){vmgrs.forEach(function(vmgr){vmgr.stop()})}log.d("Dwell changeing ["+e.type+"] => inactive.")}else if(state===ACTIVE){if(U.isArray(vmgrs)){vmgrs.forEach(function(vmgr){if(!vmgr.isActive()){vmgr.start()}})}log.d("Dwell changeing ["+e.type+"] => active.")}}Object.keys(events).forEach(function(key){window.addEventListener(key,callback,true)});window.addEventListener(visibilityChange,callback,true);return{destroy:function(){Object.keys(events).forEach(function(key){window.removeEventListener(key,callback,true)});window.removeEventListener(visibilityChange,callback,true)},isActive:function(){return state===ACTIVE}}}},function(module,exports,__webpack_require__){"use strict";var U=__webpack_require__(1);var Logger=__webpack_require__(3);var ACTIVE=1,INACTIVE=0;var TARGET="wrapper";module.exports=function(vmgrs){var log=Logger();var wrapper=document.getElementById(TARGET);var state=ACTIVE;var events={yjsmhSidebarOpen:INACTIVE,yjsmhSidebarClose:ACTIVE,yjsmhNotificationMenuOpen:INACTIVE,yjsmhNotificationMenuClose:ACTIVE};function callback(e){var newState=-1;var eventType=e.type;if(Object.prototype.hasOwnProperty.call(events,eventType)){newState=events[eventType]}if(newState===-1){return}if(state===newState){return}state=newState;log.d("Masthead status changed ["+e.type+"]",vmgrs);if(state===INACTIVE){if(U.isArray(vmgrs)){vmgrs.forEach(function(vmgr){vmgr.stop()})}}else if(state===ACTIVE){if(U.isArray(vmgrs)){vmgrs.forEach(function(vmgr){if(!vmgr.isActive()){vmgr.start()}})}}}if(U.isDivElement(wrapper)){Object.keys(events).forEach(function(key){wrapper.addEventListener(key,callback,false)})}return{destroy:function(){if(U.isDivElement(wrapper)){Object.keys(events).forEach(function(key){window.removeEventListener(this[key],callback,false)},events)}},isActive:function(){return state===ACTIVE}}}},function(module,exports,__webpack_require__){"use strict";var getOffset=__webpack_require__(19);var Logger=__webpack_require__(3);module.exports=function(){var config=__webpack_require__(4)();var log=Logger();var isSuspend=true;function reevaluateOffset(){if(config.autoOffset){var elements=document.getElementsByTagName("*");var offset=getOffset(document.defaultView,elements);if(config.viewableTopOffset!==offset.top){log.d("changed top offset. before["+config.viewableTopOffset+"] after["+offset.top+"]");config.viewableTopOffset=offset.top}if(config.viewableBottomOffset!==offset.bottom){log.d("changed bottom offset. before["+config.viewableBottomOffset+"] after["+offset.bottom+"]");config.viewableBottomOffset=offset.bottom}}setTimeout(function(){if(!isSuspend){reevaluateOffset()}},config.offsetReevaluateTime)}return{start:function(){isSuspend=false;reevaluateOffset()},stop:function(){isSuspend=true}}}},function(module,exports){"use strict";module.exports=function(defaultView,allElements){var offset={top:0,bottom:0},length=allElements.length,windowCenterWidth=defaultView.innerWidth/2,windowCenterHeight=defaultView.innerHeight/2;for(var i=0;i<length;i++){var el=allElements[i];var style=defaultView.getComputedStyle(el,"");if(style.position==="fixed"&&style.display!=="none"&&style.visibility!=="hidden"){var rect=el.getBoundingClientRect();var width=rect.right-rect.left;var height=rect.bottom-rect.top;if(height>0&&width>windowCenterWidth){if(rect.top<windowCenterHeight){offset.top=offset.top<rect.bottom?rect.bottom:offset.top}else if(rect.bottom>windowCenterHeight){offset.bottom=offset.bottom<rect.top?rect.bottom-rect.top:offset.bottom}}}}return offset}}]);
