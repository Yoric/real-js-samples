(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"0c1e":function(e,t,n){var a=n("1029"),o=n("d869"),i=function(e,t){i.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(i,a.Model,{name:o.ChatPageModel.NAME,isChatPage:!0,_isOnPrivate:!1,_isChatLocked:!1,_currentModelName:null,_isPrivateEndDisplayed:!1,setIsOnPrivate:function(e){a.Config.set("isOnPrivate",e),this._isOnPrivate=e},getIsOnPrivate:function(){return this._isOnPrivate},getIsLocked:function(){return this._isChatLocked},setCurrentModelName:function(e){this._currentModelName=e},getCurrentModelName:function(){return this._currentModelName},setIsLocked:function(e){this._isChatLocked=e},getIsMinimized:function(){return this._isMinimized},setIsMinimized:function(e){this._isMinimized=e},setIsPrivateEndDisplayed:function(e){this._isPrivateEndDisplayed=e},isPrivateEndDisplayed:function(){return this._isPrivateEndDisplayed},setAppletReady:function(e){a.Config.set(o.ChatPageModel.MEMBERAPPLET_READY_STATE,e)},isAppletReady:function(){return a.Config.get(o.ChatPageModel.MEMBERAPPLET_READY_STATE)}})},"3aaa":function(e,t,n){var i=n("1029"),a=n("d869"),r=(n("7ab0"),n("989a"),n("0592").default),o=n("83cb"),s=n("a9a1").store,l=n("cbc5").setPerformerNick,h=function(e,t){h.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(h,o,{name:a.HTML5ChatPageController.NAME,html5Client:null,appletReady:!1,modalOpened:!1,init:function(e,t){h.superclass.init.call(this,e,t),this.registerHistory()},onPrivateStartClick:function(){h.superclass.onPrivateStartClick.call(this)},_setSessionIdOnApplet:function(e){this.html5Client.setSessionId(e)},muteChatApplet:function(){this.html5Client.mute()},unMuteChatApplet:function(){this.html5Client.unMute()},onModalClosed:function(){this.model.isPrivateEndDisplayed()||setTimeout(i.bind(this.replaceState,this),0),this.html5Client.enableKeyboard(),this.keyboardDisabled=!1,this.modalOpened=!1},onModalOpened:function(){this.appletReady&&(this.html5Client.disableKeyboard(),this.keyboardDisabled=!0),this.modalOpened=!0},onAppletReady:function(){this.appletReady=!0,this.modalOpened&&!this.keyboardDisabled&&this.html5Client.disableKeyboard()},replaceState:function(){var e=this.model.getCurrentModelName(),t=e;""!==location.hash&&(t+=location.hash);try{window.history.replaceState({HTML5ChatPageController:{name:e,state:this.nextPerformerHistoryEntry,params:e,url:e}},null,t)}catch(e){console.error("error: ",e)}},onGetPerformerDetails:function(e,t){var n,a,o=this.model.getCurrentModelName();h.superclass.onGetPerformerDetails.apply(this,arguments),n=this.model.getCurrentModelName(),a=i.Config.get("htmlTitle").replace(o,n),s.dispatch(l(n)),r.pushState({HTML5ChatPageController:{name:n,state:this.nextPerformerHistoryEntry,params:n,url:n}},a,n,t)},_refreshFlashVars:function(e){i.Config.set("HTMLAppletVars",e)},setPerformerDetailsOnApplet:function(){this.html5Client.enableKeyboard(),this.html5Client.performerDetailsReady(this._performerData)},onStartVideoCall:function(e){this.model.getCurrentModelName()!==e?(this.pleaseCallMeBack=e,i.fireEvent(a.FlashExternal.GLOBALEVENT_GET_PERFORMER_DETAILS,e)):this.html5Client.startVideoCall()},onStreamReady:function(){if(this.pleaseCallMeBack===this.model.getCurrentModelName()){this.pleaseCallMeBack=null;var e=this;setTimeout(function(){e.html5Client.startVideoCall()},0)}},bind:function(){h.superclass.bind.call(this),i.on([{element:i.Broadcaster,event:a.BasicController.GLOBALEVENT_REFRESH_APPLET_SESSION,handler:this._setSessionIdOnApplet},{element:i.Broadcaster,event:a.ModalComponent.GLOBALEVENT_MODAL_CLOSED,handler:this.onModalClosed},{element:i.Broadcaster,event:a.ModalComponent.GLOBALEVENT_MODAL_OPENED,handler:this.onModalOpened},{element:i.Broadcaster,event:a.FlashExternal.GLOBALEVENT_APPLET_READY,handler:this.onAppletReady},{element:i.Broadcaster,event:a.FlashExternal.GLOBALEVENT_APPLET_STREAM_READY,handler:this.onStreamReady}],this)}})},"5d02":function(e,t,n){var a=n("b441"),o=n("5aa8"),i=function(e){i.superclass.constructor.call(this,e)};e.exports=Ext.extend(i,a,{name:"FlashChatPageView",hideChat:function(){this.minimizeMemberApplet()},showChat:function(){this.resetAppletSize()},hideHTML5Applet:function(){try{o.isWin7IE11()?Ext.fly("member_client_container").addClass("minified"):Ext.fly("member_client_container").display("none")}catch(e){}}})},"71fb":function(e,t,r){"use strict";r.r(t);var n=r("1029"),a=r.n(n),o=r("d869"),i=r.n(o),s=r("a9a1"),l=r("cbc5"),h=r("0592"),E=r("7ab0"),d=r.n(E),c=r("e568"),C=r.n(c),_=r("3aaa"),p=r.n(_),m=r("5d02"),A=r.n(m),u=r("0c1e"),P=r.n(u),T=r("c384"),L=r.n(T),f=function e(t,n){e.superclass.constructor.call(this,t,n)};Ext.extend(f,a.a.Component,{name:i.a.ChatPageComponentAbstract.NAME,controllerClassName:p.a,viewClassName:A.a,modelClassName:P.a,privateEndContainerId:"freechat_container",applet:null,init:function(e,t){f.superclass.init.call(this,e,t),this._addGlobalEvents(),this._setChatController()},_addGlobalEvents:function(){a.a.addEvents(i.a.ChatPageComponentAbstract.GLOBALEVENT_PRIVATE_START,i.a.ChatPageComponentAbstract.GLOBALEVENT_PRIVATE_END,i.a.ChatPageComponentAbstract.GLOBALEVENT_PRIVATE_TEASER_LEFT,i.a.ChatPageComponentAbstract.GLOBALEVENT_APPLET_GET_CREDITS_CLICK,i.a.ChatPageComponentAbstract.GLOBALEVENT_APPLET_RESIZE,i.a.ChatPageComponentAbstract.GLOBALEVENT_MODEL_CHANGE,i.a.ChatPageComponentAbstract.GLOBALEVENT_APPLET_LOAD_READY,i.a.ChatPageComponentAbstract.GLOBALEVENT_APPLET_RECOMMENDER_CLICK,i.a.ChatPageComponentAbstract.GLOBALEVENT_SET_MODEL_FROM_HISTORY,i.a.ChatPageComponentAbstract.GLOBALEVENT_OPEN_CHAT,i.a.ChatPageComponentAbstract.GLOBALEVENT_ESC_KEYPRESS,i.a.ChatPageComponentAbstract.GLOBALEVENT_CLOSE_CHAT,i.a.ChatPageComponentAbstract.GLOBALEVENT_WINDOW_RESIZE,i.a.ChatPageComponentAbstract.GLOBALEVENT_HISTORY_CHANGE)},setApplet:function(){throw"You must override this method"},_setModelContentComponent:function(){var n=this,e=a.a.Config.get("performerHasStory"),t=a.a.Config.get("performerMyStoryProfilePictureUrl");void 0!==e&&(e?s.store.dispatch(l.setPerformerHasStory()):s.store.dispatch(l.setPerformerHasNoStory())),void 0!==t&&s.store.dispatch(l.setSmallProfilePicture(t)),Promise.all([r.e(3),r.e(4),r.e(21),r.e(1),r.e(15)]).then(r.bind(null,"92aa")).then(function(e){var t=e.default;n.modelContentComponent instanceof t||(n.modelContentComponent=new t(n.element,{chatComponent:n}))}).catch(function(e){return"An error occurred while loading the component"})},_setChatController:function(){var e=this.controllerClassName;return this._chatController instanceof e||(this._chatController=new e({items:{IndexBroadcaster:{component:a.a.Broadcaster,listeners:a.a.object([[i.a.FlashExternal.GLOBALEVENT_LAYOUT_MODE_CHANGE,"onAppletLayoutModeChange"],[i.a.FlashExternal.GLOBALEVENT_PRIVATE_START,"onPrivateStartClick"],[i.a.FlashExternal.GLOBALEVENT_PRIVATE_END,"onPrivateEnd"],[i.a.FlashExternal.GLOBALEVENT_PEEK_END,"onPrivateEnd"],[i.a.FlashExternal.GLOBALEVENT_EXIT_FULLSCREEN,"onExitFullScreen"],[i.a.FlashExternal.GLOBALEVENT_UPDATE_SCROLL_POSITION,"onUpdateScrollPosition"],[i.a.FlashExternal.GLOBALEVENT_GET_PERFORMER_DETAILS,"onGetPerformerDetails"],[i.a.FlashExternal.GLOBALEVENT_VIP_SHOW_STARTED,"onVipShowStarted"]])},model:{component:this._setChatModel()},view:{component:this._setChatView()}}}),a.a.on([{element:this._chatController,event:i.a.ChatPageControllerAbstract.EVENT_MODEL_CHANGE,handler:this.onModelChange},{element:this._chatController,event:i.a.FlashChatPageControllerAbstract.EVENT_APPLET_RESIZE,handler:this.onAppletResize},{element:this._chatController,event:i.a.FlashChatPageControllerAbstract.EVENT_WINDOW_RESIZE,handler:this.onWindowResize},{element:this._chatController,event:i.a.ChatPageController.HISTORY_CHANGE,handler:this.onHistoryChange}],this)),this._chatController},_setChatView:function(){throw"You must override this method"},_setChatModel:function(){var e=this.modelClassName,t=s.store.getState().performer.nick;return this._chatModel instanceof e||(this._chatModel=new e({performerName:t}),this._chatModel.setCurrentModelName(t)),this._chatModel},getChatModel:function(){return this._setChatModel()},onWindowResize:function(){a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_WINDOW_RESIZE,{scope:this})},onPrivateStartClick:function(){a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_PRIVATE_START,{scope:this,currentModelName:this._chatModel.getCurrentModelName()})},onPeekEnd:function(){a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_PRIVATE_END,{scope:this,currentModelName:this._chatModel.getCurrentModelName()})},onPrivateEnd:function(e){throw"You must override this method."},setPrivateEnd:function(e){throw"You must override this method."},getPrivateEndContainer:function(a,o){var i=this.privateEndContainerId;return new Promise(function(n){return Promise.all([r.e(5),r.e(25)]).then(r.bind(null,"c4ae")).then(function(e){var t=e.default;n(new t(i,{isHTML5Version:o,modelData:a,items:{}}))})})},onPrivateEndContentReady:function(){throw"You must override this method"},onPrivateEndClose:function(){if(d.a.isChatPage()){var e={category:a.a.getMeta("category")};window.location.href=a.a.getUrl(a.a.Config.get("listPageRoutes").listPage,e,{},"")}else this._destroyPrivateEndContainer(),this.closeApplet()},onPrivateEndRecommenderClick:function(){this._destroyPrivateEndContainer(),this._chatView.showHTML5Applet()},_destroyPrivateEndContainer:function(){this._chatModel.setIsPrivateEndDisplayed(!1),this._privateEndContainer&&(this._privateEndContainer.destroy(),delete this._privateEndContainer)},onPrivateTeaserLeft:function(e){a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_PRIVATE_TEASER_LEFT,{scope:this,privateTeaserLeft:e})},onGetCreditsClick:function(e){var t=function(e){return e.name===i.a.ChatModalComponent.NAME};if(null==C.a.getUserType())h.default.navigate("signup",{trigger:!0,preventNavigateBack:!1});else{var n="payment";void 0!==e.selectedPackage&&(n+="?package="+e.selectedPackage),h.default.navigate(n,{trigger:!0,replace:!1,preventNavigateBack:d.a.isChatPage(),keepActiveModal:t,lockActiveModal:t,data:{arrivedFromApplet:!0}})}},onModelChange:function(e){this._destroyPrivateEndContainer(),a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_MODEL_CHANGE,{scope:this,modelData:e.modelData}),a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_APPLET_LOAD_READY,{scope:this,modelData:e.modelData}),a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_APPLET_RECOMMENDER_CLICK,{scope:this,modelName:e.modelData.performerId,firstModelName:e.flashVars.performerid,modelData:e.modelData})},onAppletResize:function(){a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_APPLET_RESIZE,this)},onHistoryChange:function(e){a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_HISTORY_CHANGE,e)},onCloseApplet:function(){this.closeApplet()},onCloseChatModal:function(e){e.scope.name===i.a.ChatModalComponent.NAME&&this.closeChatModal()},openChatModal:function(e){this._chatController.openChatModal(e)},lockChatModal:function(){this._chatController.lockChatModal()},closeChatModal:function(){a.a.Config.set("isChatOpenInOverlay",!1),this._destroyPrivateEndContainer(),this._chatController.closeChatModal()},closeApplet:function(){this._chatController.closeApplet()},getIsOnPrivate:function(){return this._chatModel.getIsOnPrivate()},getIsMinimized:function(){return this._chatModel.getIsMinimized()},onMuteChatApplet:function(){this._chatController.muteChatApplet()},onUnMuteChatApplet:function(){this._chatController.unMuteChatApplet()},onAppletReady:function(){this._chatModel&&this._chatModel.setAppletReady(!0)},onStatusChange:function(){throw"onStatusChange method must be implemented"},bind:function(){f.superclass.bind.call(this),a.a.on([{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_APPLET_READY,handler:this.onAppletReady},{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_PRIVATE_START,handler:this.onPrivateStartClick},{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_VIDEO_CALL_START,handler:this.onPrivateStartClick},{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_PRIVATE_END,handler:this.onPrivateEnd},{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_PEEK_END,handler:this.onPeekEnd},{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_PRIVATE_TEASER_LEFT,handler:this.onPrivateTeaserLeft},{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_APPLET_GET_CREDITS_CLICK,handler:this.onGetCreditsClick},{element:a.a.Broadcaster,event:i.a.FlashExternal.GLOBALEVENT_CLOSE_POPUP,handler:this.onCloseApplet},{element:a.a.Broadcaster,event:i.a.ModalComponent.GLOBALEVENT_MODAL_CLOSED,handler:this.onCloseChatModal},{element:a.a.Broadcaster,event:i.a.PhotoViewerComponent.GLOBALEVENT_VIDEO_PLAY_STARTED,handler:this.onMuteChatApplet},{element:a.a.Broadcaster,event:i.a.GalleryController.GLOBALEVENT_VIDEO_PLAYER_START,handler:this.onMuteChatApplet},{element:a.a.Broadcaster,event:i.a.GalleryController.GLOBALEVENT_VIDEO_PLAYER_STOP,handler:this.onUnMuteChatApplet},{element:a.a.Broadcaster,event:i.a.PhotoViewerComponent.GLOBALEVENT_VIDEO_PLAY_STOPPED,handler:this.onUnMuteChatApplet},{element:L.a.getInstance(),event:i.a.StatusUpdaterComponent.PERFORMER_STATUS_CHANGES_EVENT,handler:this.onStatusChange}],this)}});var v=f,M=r("5aa8"),N=r.n(M),O=function e(t){e.superclass.constructor.call(this,t)};Ext.extend(O,a.a.View,{name:i.a.HTML5ChatPageView.NAME,hideHTML5Applet:function(){N.a.isWin7IE11()?Ext.fly("member_client_container").addClass("minified"):Ext.fly("member_client_container").display("none").addClass("hidden")},showHTML5Applet:function(){N.a.isWin7IE11()?Ext.fly("member_client_container").removeClass("minified"):Ext.fly("member_client_container").display("block").removeClass("hidden")},clearStyle:function(){Ext.fly("member_client_container").attr("style","")},setAppletSizeType:function(e){a.a.Storage.set(i.a.HTML5ChatPageComponent.APPLET_SIZE_STORAGE_LABEL,e),this.element.data("size-type",e)}});var g=O,V=r("2ce1"),S=r("3032"),R=r.n(S),b=r("f94d"),B=r("dab4"),y=r.n(B),I=function e(t,n){e.superclass.constructor.call(this,t,n)};Ext.extend(I,v,{name:i.a.HTML5ChatPageComponent.NAME,flashObjectId:"chatapplet",freeChatId:"freechat",controllerClassName:p.a,viewClassName:g,init:function(e,t){I.superclass.init.call(this,e,t),d.a.isChatPage()&&this._setModelContentComponent(),R.a.appletSendMessageBind(),b.default.appletReady.then(function(e){this.setEvents(e)}.bind(this))},setEvents:function(e){e.onShowGallery=this.onShowGallery,e.onSetFixSize=this._setChatView().setAppletSizeType.bind(this,i.a.HTML5ChatPageComponent.SIZE_FIX),e.onSetFluidSize=this._setChatView().setAppletSizeType.bind(this,i.a.HTML5ChatPageComponent.SIZE_FLUID),e.onSubscribe=V.a.memberApplet.subscribe},onShowGallery:function(e){h.default.navigate("modelgallery/"+e,{trigger:!0,preventNavigateBack:!1,replace:!1,keepActiveModal:!0,lockActiveModal:!0})},_setChatView:function(){var e=this.viewClassName;return this._chatView instanceof e||(this._chatView=new e({id:"freechat_container",model:this._setChatModel()})),this._chatView},_setChatController:function(){var e=this.controllerClassName;return this._chatController instanceof e||(this._chatController=new e({html5Client:b.default.instance,items:{IndexBroadcaster:{component:a.a.Broadcaster,listeners:a.a.object([[i.a.FlashExternal.GLOBALEVENT_VIDEO_CALL_START,"onPrivateStartClick"],[i.a.FlashExternal.GLOBALEVENT_PRIVATE_START,"onPrivateStartClick"],[i.a.FlashExternal.GLOBALEVENT_PRIVATE_END,"onPrivateEnd"],[i.a.FlashExternal.GLOBALEVENT_PEEK_END,"onPrivateEnd"],[i.a.FlashExternal.GLOBALEVENT_GET_PERFORMER_DETAILS,"onGetPerformerDetails"],[i.a.ModelMessagesConversationController.GLOBALEVENT_VIDEO_CALL_START,"onStartVideoCall"]])},model:{component:this._setChatModel(),listeners:{}},view:{component:this._setChatView(),listeners:{}}}}),a.a.on([{element:this._chatController,event:i.a.ChatPageControllerAbstract.EVENT_MODEL_CHANGE,handler:this.onModelChange},{element:this._chatController,event:i.a.ChatPageController.HISTORY_CHANGE,handler:this.onHistoryChange}],this),d.a.isHokkaido()&&Ext.fly("breadcrumb")&&this._chatController.addComponent({component:new y.a({id:"breadcrumb"}),listeners:{}},"breadCrumbView")),this._chatController},sendEscPressToApplet:function(){this.getChatModel().getIsOnPrivate()||this._chatController.closeApplet()},onBackToPrivate:function(){this._destroyPrivateEndContainer(),this._chatView.showHTML5Applet(),b.default.instance.applet.backToPrivate()},onCallAgain:function(){this._destroyPrivateEndContainer(),this._chatView.showHTML5Applet(),b.default.instance.applet.startVideoCall()},setPrivateEnd:function(e){e=Ext.apply(a.a.Config.get("HTMLAppletVars"),e),this.getPrivateEndContainer(e,!1).then(a.a.bind(function(e){this._privateEndContainer=e,a.a.on([{element:this._privateEndContainer,event:i.a.PrivateEndContainer.EVENT_CLOSE,handler:this.onPrivateEndClose},{element:this._privateEndContainer,event:i.a.PrivateEndContainer.EVENT_PRIVATE_END_CONTENT_READY,handler:this.onPrivateEndContentReady},{element:this._privateEndContainer,event:i.a.PrivateEndContainer.GLOBALEVENT_PRIVATE_END_RECOMMENDER_CLICK,handler:this.onPrivateEndRecommenderClick},{element:this._privateEndContainer,event:i.a.PrivateEndContainer.EVENT_BACK_TO_PRIVATE,handler:this.onBackToPrivate},{element:this._privateEndContainer,event:i.a.PrivateEndContainer.EVENT_CALL_AGAIN,handler:this.onCallAgain},{element:this._privateEndContainer,event:i.a.PrivateEndContainer.EVENT_PRIVATE_END_DESTROYED,handler:this.onPrivateEndDestroyed}],this)},this))},onPrivateEndContentReady:function(){this._chatView.hideHTML5Applet()},onPrivateEnd:function(e){a.a.fireEvent(i.a.ChatPageComponentAbstract.GLOBALEVENT_PRIVATE_END,{scope:this,currentModelName:this._chatModel.getCurrentModelName()}),this._chatModel.isPrivateEndDisplayed()||this._chatModel.getIsLocked()||(this._chatModel.setIsPrivateEndDisplayed(!0),Promise.resolve().then(a.a.bind(function(){this.setPrivateEnd(e)},this).bind(null,r)).catch(r.oe))},onPrivateEndDestroyed:function(){this._chatView.clearStyle()},onPrivateEndClose:function(){this._chatView.showHTML5Applet(),I.superclass.onPrivateEndClose.call(this)},onStatusChange:function(e){b.default.instance.updateRecommender(e)},onMuteChatApplet:function(){b.default.instance.mute()},onUnMuteChatApplet:function(){b.default.instance.unMute()}});t.default=I},c384:function(e,t,n){var a=n("1029"),o=n("d869"),i=n("e781"),r=function(){if(r._instance)throw new Error("This is a singleton class. Please use .getInstance() method instead of new.");this._bindEvents()};r.getInstance=function(){return r._instance||(r._instance=new r)},e.exports=Ext.extend(r,a.Component,{onStatusChange:function(e){this.fireEvent(o.StatusUpdaterComponent.PERFORMER_STATUS_CHANGES_EVENT,e.header)},_bindEvents:function(){this.addEvents(a.keys(o.StatusUpdaterComponent.PERFORMER_STATUS_CHANGES_EVENT)),a.on([{element:i.getClient(),event:o.StatusUpdaterComponent.PERFORMER_STATUS_CHANGES_EVENT_JAWS,handler:a.bind(this.onStatusChange,this)}],this)}})}}]);