var Slider=function(t){var s=function(t){this.conf=this._extends({wrap:"slider",itemClass:"slider_item",startOn:0,slideBy:1,speed:6,isVertical:false,isLoop:true,autoPlay:true,autoInterval:3,onReady:function(t){},onAniStart:function(t){},onAniEnd:function(t){},onEdge:function(t){}},t);this._initDoms();this._initStates();this._initEvents();this._launch()};s.prototype={_id:function(t){return document.getElementById(t)},_class:function(t,s,n){var e=[],o,a,r;if(s===null)s=document.body;if(n===null)n="*";if(s.getElementsByClassName){return s.getElementsByClassName(t)}o=s.getElementsByTagName(n);a=o.length;r=new RegExp("(^|\\s)"+t+"(\\s|$)");for(i=0,j=0;i<a;i++){if(r.test(o[i].className)){e[j]=o[i];j++}}return e},_extends:function(t,s){for(var i in s){t[i]=s[i]}return t},_css3Prop:function(){if(this.css3Prop)return this.css3Prop;var t={};var s=document.createElement("div").style;var i=function(){var t=["t","webkitT","MozT","msT","OT"],i,n=0,e=t.length;for(;n<e;n++){i=t[n]+"ransform";if(i in s)return t[n].substr(0,t[n].length-1)}return false}();this.css3Prop={support:typeof i==="boolean"?false:true,vendor:i,cssVendor:i?"-"+i.toLowerCase()+"-":"",transform:n("transform"),transition:n("transition"),transitionProperty:n("transitionProperty"),transitionDuration:n("transitionDuration"),transformOrigin:n("transformOrigin"),transitionTimingFunction:n("transitionTimingFunction"),transitionDelay:n("transitionDelay"),transitionEnd:n("transitionend")};return this.css3Prop;function n(t){if(i===false)return false;if(i==="")return t;return i+t.charAt(0).toUpperCase()+t.substr(1)}},_easeOut:function(t,s,i,n){return-i*(t/=n)*(t-2)+s},_addEvent:function(t,s,i){t.attachEvent?t.attachEvent("on"+s,i):t.addEventListener(s,i,false)},_initDoms:function(t){var s=this,i=this.conf,n=s._id(i.wrap),e,o,a=n.innerHTML,r,l,u;e=i.isVertical?"":' style="float:left;"';o=i.isLoop?"<div"+e+">"+a+"</div><div"+e+">"+a+"</div>":a;r='<div style="'+(i.isVertical?"height":"width")+':30000px;zoom:1;">'+o+"</div>";n.innerHTML=r;l=n.getElementsByTagName("div")[0];l.style.position="relative";u=this._class(i.itemClass,n,"div");for(var d=0,c=u.length;d<c;d++){u[d].style["float"]=i.isVertical?"none":"left"}this.doms={wrap:n,aniWrap:l,items:u}},_initStates:function(t){var s=this,i=this.conf,n=this.doms,e=n.items,o=this._css3Prop(),a,r,l,u,d,c,h,f,m,v,p,_,P,y,x,E;l=i.isVertical?"v":"h";d=i.isVertical?n.wrap.clientHeight:n.wrap.clientWidth;u=e.length;c=i.speed/10;a=d*i.slideBy;p=i.isVertical?"offsetTop":"offsetLeft";_=i.isVertical?"offsetHeight":"offsetWidth";P=[];for(var T=0;T<u;T++){P.push(e[T][p])}y=P[u-1]+e[u-1][_];h="ontouchstart"in window;f=i.isVertical?"marginTop":"marginLeft";if(o.vendor===""){x="transform "+c+"s ease-out"}else if(o.vendor){x="-"+o.vendor+"-transform "+c+"s ease-out"}E=function(){var t=s.conf,i=s.doms,n=s.states,e=s._css3Prop();t.onAniEnd&&t.onAniEnd.call(s);n.animating=false;i.aniWrap.removeEventListener(e.transitionEnd,arguments.callee,false)};this.states={curIdx:i.startOn,slideDir:l,wrapSize:d,total:u,slidePX:a,itemPos:P,totalPX:y,duration:c,supportTouch:h,cssProterty:f,to:null,now:0,fromPos:null,movedPos:null,animating:false,transitionAni:x,onTransitionEnd:E,touchStartX:null,touchStartY:null,deltaDis0:null,deltaDis1:null,startPos:null}},_initEvents:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=n.wrap;this._addEvent(o,"mouseover",function(){if(i.autoPlay){clearInterval(s._auto);s._auto=null}});this._addEvent(o,"mouseout",function(){if(i.autoPlay){s.autoSlide(true)}});if(e.supportTouch){this._addEvent(o,"touchstart",function(t){s._touchstart(t)});this._addEvent(o,"touchmove",function(t){s._touchmove(t)});this._addEvent(o,"touchend",function(t){s._touchend(t)})}},_launch:function(){var t=this.conf,s=this.doms,i=this.states;if("startOn"in t){this._moveToEle(t.startOn);i.fromPos=-i.wrapSize*t.startOnPX}else if("startOnPX"in t){this._moveByPx(t.startOnPX,true);i.fromPos=-t.startOnPX}t.onReady&&t.onReady.call(this);if(t.autoPlay){this.autoSlide(true)}},_touchstart:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=this._css3Prop();if(t.touches.length!==1){return}if(i.isLoop){if(e.curIdx===0){e.curIdx+=e.total/2}if(e.curIdx==e.total-1){e.curIdx-=e.total/2}n.aniWrap.style[o.transition]="all 0s ease-out";this._moveToEle(e.curIdx)}clearInterval(this._auto);this._auto=null;e.touchStartX=t.touches[0].pageX;e.touchStartY=t.touches[0].pageY;if(i.isVertical){e.deltaDis0=e.touchStartY}else{e.deltaDis0=e.touchStartX}e.startPos=-e.curIdx*e.slidePX;e.touched=true},_touchmove:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=this._css3Prop(),a,r,l,u,d,c;if(t.touches.length!==1){return}a=t.touches[0].pageX;r=t.touches[0].pageY;l=a-e.touchStartX;u=r-e.touchStartY;if(i.isVertical){e.deltaDis1=r-e.deltaDis0;d=e.startPos+u}else{e.deltaDis1=a-e.deltaDis0;d=e.startPos+l}c=i.isVertical?"translate3d(0,"+d+"px,0)":"translate3d("+d+"px,0,0)";n.aniWrap.style[o.transform]=c},_touchend:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=this._css3Prop(),a;if(e.deltaDis1<-30){this.next();e.deltaDis1=0}else if(e.deltaDis1>30){this.prev();e.deltaDis1=0}else{this._slideToCss3(e.curIdx)}e.touched=false},_moveToEle:function(t,s,i){var n=this,e=this.conf,o=this.doms,a=this.states,r=a.curIdx,l=s?r+t:t,u=o.aniWrap,d=o.items,c=d[l],h=this._css3Prop(),f,m;if(t!==r){e.onIndexChanged&&e.onIndexChanged.call(this,t)}f=-a.itemPos[l];m=e.isVertical?"translate3d(0,"+f+"px,0)":"translate3d("+f+"px,0,0)";if(h.vendor!==false){if(a.animating){u.removeEventListener(h.transitionEnd,a.onTransitionEnd,false)}u.style[h.transition]="all 0s ease-out";u.style[h.transform]=m;a.curIdx=l;setTimeout(function(){i&&i.call(n)},20)}else{u.style[a.cssProterty]=f+"px";a.curIdx=l;i&&i.call(this)}},_moveToPX:function(t,s,i){var n=this,e=this.conf,o=this.doms,a=this.states,r=o.aniWrap,l=o.items,u=l[toIdx],d=this._css3Prop(),c,h},_slideToCss3:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=n.items,a=n.aniWrap,r=this._css3Prop(),l,u;a.style[r.transition]=e.transitionAni;l=i.isVertical?-o[t].offsetTop:-o[t].offsetLeft;u=i.isVertical?"translate3d(0,"+l+"px,0)":"translate3d("+l+"px,0,0)";a.style[r.transform]=u;if(e.animating){a.removeEventListener(r.transitionEnd,e.onTransitionEnd,false)}a.style[r.transform]=u;a.addEventListener(r.transitionEnd,e.onTransitionEnd,false);e.curIdx=t},_slideToTdt:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=n.aniWrap,a=e.cssProterty,r=e.duration*1e3,l=e.now,u=e.wrapSize,d;if(e.to===null||e.to==t){e.fromPos=-e.curIdx*u}else{e.fromPos=e.movedPos;e.now=0}if(r-l<20){o.style[a]=-t*u+"px";e.curIdx=t;clearTimeout(this.aniInterval);this.aniInterval=null;e.now=0;e.to=null;e.fromPos=-e.curIdx*u;e.movedPos=null;i.onAniEnd&&i.onAniEnd.call(this);e.animating=false;return}d=this._easeOut(l,e.fromPos,-t*u-e.fromPos,r);o.style[a]=d+"px";e.now+=20;e.movedPos=d;this.aniInterval=setTimeout(function(){s._slideToTdt(t)},20)},prev:function(){var t=this.conf,s=this.doms,i=this.states,n=i.curIdx,e;if(t.isLoop&&n===0){this._moveToEle(i.total/2,false,function(){e=i.curIdx-t.slideBy;this.slideTo(e)})}else{e=i.curIdx-t.slideBy;this.slideTo(e)}},next:function(){var t=this.conf,s=this.doms,i=this.states,n=i.curIdx,e;if(t.isLoop&&n===i.total-1){this._moveToEle(i.total/2-1,false,function(){e=i.curIdx+t.slideBy;this.slideTo(e)})}else{e=i.curIdx+t.slideBy;this.slideTo(e)}},slideByEle:function(t){var s=this.states.curIdx+t;this.slideTo(s)},slideTo:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=e.curIdx,a=e.total,r=this._css3Prop(),l,u;l=t>a-1?t%a:t<0?a+t%a:t;if(l===o){return}i.onIndexChanged&&i.onIndexChanged.call(this,l);e.animating=true;if(i.autoPlay){this.autoSlide(true)}i.onAniStart&&i.onAniStart.call(this);if(r.vendor!==false){this._slideToCss3(l)}else{this._slideToTdt(l)}},autoSlide:function(t){var s=this;if(this._auto){clearInterval(this._auto);this._auto=null}if(t){this._auto=setInterval(function(){s.next()},this.conf.autoInterval*1e3)}},refresh:function(t){var s=this,i=this.conf,n=this.doms,e=this.states,o=this._css3Prop(),a;a=i.isVertical?n.wrap.clientHeight:n.wrap.clientWidth;e.slidePX=a*i.slideBy;if(e.animating){e.onTransitionEnd()}n.aniWrap.style[o.transition]="all 0s ease-out";this._moveToEle(e.curIdx)},destroy:function(){}};return s}();