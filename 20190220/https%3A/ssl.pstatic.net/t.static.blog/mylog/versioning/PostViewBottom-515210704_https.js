var PostViewBottomTitleListController=$Class({$jsMVC:jsMVC.$Controller,$init:function(){this._popularPostCurrentPage=0},start:function(k,g,b,d,c,h,f,i,a,e,j){this.mPostViewBottomTitleList=jsMVC.getModel("postViewBottomTitleListController","postViewBottomTitleListModel");this.vPostViewBottomTitleList=jsMVC.getView("postViewBottomTitleListController","postViewBottomTitleListView");this.sBlogId=k;this.nFirstLogNo=g;this.bIsShowPopularPosts=b;this.sViewDate=f;this.nParentCategoryNo=(f!=""||d==0)?"":d;this.nCategoryNo=(c==0||d==c)?"":c;this.sEncodedCategoryName=h;this.nFirstSortDate=i;this.sFrom=a;this.isThumbnailViewType=e;this.countPerPage=j;$Fn(this._load,this).attach(window,"load");$Fn(this._click,this).attach($("postListBottom"),"click")},_load:function(){this.vPostViewBottomTitleList.start(this.sBlogId,this.nFirstLogNo,this.bIsShowPopularPosts,this.nParentCategoryNo,this.nCategoryNo,this.sViewDate,this.sFrom,this.isThumbnailViewType);this._fetchBottomTitleList(false,false,this.nFirstLogNo,this.nFirstSortDate);if(this.bIsShowPopularPosts){this._popularPostCurrentPage=1;this._fetchPopularPostTitle(this._popularPostCurrentPage)}},_click:function(b){var c=$Element(cssquery.getSingle("!a",b.element)?cssquery.getSingle("!a",b.element):b.element);if(c==null){return}var e=utility.getParam(c.className());if(c.hasClass("_previous_category")||c.hasClass("_next_category")){if(c.hasClass("_previous_category")){clickcr(b.element,"rec_others.prev","","",b.$value())}else{clickcr(b.element,"rec_others.next","","",b.$value())}if(e.length==2){var a=e[0];var d=e[1];if(a!=""&&d!=""){this._fetchBottomTitleList(c.hasClass("_previous_category"),!c.hasClass("_previous_category"),a,d)}}}else{if(c.hasClass("_previous_popular")){this._fetchPopularPostWithPreProcess(true,b)}else{if(c.hasClass("_next_popular")){this._fetchPopularPostWithPreProcess(false,b)}else{if(c.hasClass("_oPhotoPaginateMove")){oPhotoPaginate.move(e[0])}}}}if(c.hasClass("_returnFalse")){b.stop()}},_fetchPopularPostWithPreProcess:function(c,b){var a;if(c){a="rec_most.prev";this._popularPostCurrentPage--;if(this._popularPostCurrentPage<=0){this._popularPostCurrentPage=1}}else{a="rec_most.next";this._popularPostCurrentPage++}clickcr(b.element,a,"","",b.$value());this._fetchPopularPostTitle(this._popularPostCurrentPage)},_fetchBottomTitleList:function(e,b,a,d){if(!a){a=this.nFirstLogNo}if(!d){d=this.vPostViewBottomTitleList.findSortDateInMilli();if(isNaN(d)){d=new Date().getTime()}}var c={sBlogId:this.sBlogId,sLogNo:a,nParentCategoryNo:this.nParentCategoryNo,nCategoryNo:this.nCategoryNo,sViewDate:this.sViewDate,bShowNextPage:!!b,bShowPreviousPage:!!e,nSortDateInMilli:d,isThumbnailViewType:this.isThumbnailViewType,countPerPage:this.countPerPage};this.mPostViewBottomTitleList.fetchTitleList(c)},_fetchPopularPostTitle:function(a){this.mPostViewBottomTitleList.fetchPopularPostTitleList({sBlogId:this.sBlogId,nPage:a})}});var PostViewBottomTitleListModel=$Class({$init:function(){this.gotBottomCategoryPostTitleList=new jsMVC.Event();this.gotPopularPostTitleList=new jsMVC.Event()},_isNotValidRequiredParam:function(a){if(a==null||a.sBlogId==null){return true}return false},fetchTitleList:function(c){if(this._isNotValidRequiredParam(c)){return}var a="/PostViewBottomTitleListAsync.nhn";var b=$Fn(this._afterFetchBottomCategoryPostTitleList,this).bind();this._fetch(a,b,this._makeParameterMap(c))},fetchPopularPostTitleList:function(c){if(this._isNotValidRequiredParam(c)){return}var d="PostViewPopularPostTitleListAsync.nhn";var b=$Fn(this._afterFetchTopPostTitleList,this).bind();var a=$Element(document.body).className();this._fetch(d,b,{blogId:c.sBlogId,currentPage:c.nPage,bodyClassName:a})},_fetch:function(b,c,a){new $Ajax(b,{onload:function(d){c(d)},method:"get"}).request(a)},_makeParameterMap:function(b){var a=$H({blogId:b.sBlogId,logNo:b.sLogNo,viewDate:b.sViewDate,categoryNo:b.nCategoryNo,parentCategoryNo:b.nParentCategoryNo,showNextPage:b.bShowNextPage,showPreviousPage:b.bShowPreviousPage,sortDateInMilli:b.nSortDateInMilli,isThumbnailViewType:b.isThumbnailViewType,countPerPage:b.countPerPage}).filter(function(d,c,e){return d!=null});return a.$value()},_afterFetchBottomCategoryPostTitleList:function(a){if(a.status()==200){var b=a.json();if(b.success!=true){return}this.gotBottomCategoryPostTitleList.notify({aPostList:b.postList,bHasNextPage:b.hasNextPage,bHasPreviousPage:b.hasPreviousPage,nNextIndexLogNo:b.nextIndexLogNo,nNextIndexSortDate:b.nextIndexSortDate,nPreviousIndexLogNo:b.previousIndexLogNo,nPreviousIndexSortDate:b.previousIndexSortDate,bIsThumbnailViewType:b.isThumbnailViewType})}},_afterFetchTopPostTitleList:function(a){if(a.status()==200){var b=a.json();this.gotPopularPostTitleList.notify({bIsSuccess:b.success,aPostList:b.postList,bHasNextPage:b.hasNextPage,bHasPreviousPage:b.hasPreviousPage,bIsThumbnailViewType:b.isThumbnailViewType})}}});var PostViewBottomTitleListView=$Class({$init:function(){this._wtplListBody="";this._wtplThumbnailListBody="";this._wtplPopularPostTextListBody="";this._elPostListBottomDiv=$("postListBottom")},start:function(g,e,d,c,b,f,a){this.nFirstPostLogNo=e;this._initTitleTemplate(g,c,b,f,d,a);this._assignModelEventHandlers();this._locateTopButton()},_initTitleTemplate:function(j,d,b,e,c,a){var g=[];g.push('<tr class="{=isOn}"><td class="title"><div class="wrap_td">');g.push('{if commentCount}<div class="meta_data"><span class="num pcol3">({=commentCount})</span></div>{/if}');g.push('<span class="ell2 pcol2">');g.push('<a logno="{=logNo}" href="/PostView.nhn?blogId=');g.push(j);g.push("&logNo={=logNo}&parentCategoryNo=");g.push(d);g.push("&categoryNo=");g.push(b);g.push("&viewDate=");g.push(e);g.push("&isShowPopularPosts=");g.push(c);g.push("&from=");g.push(a);g.push("\" class=\"pcol2\" onclick=\"clickcr(this,'{=nClickCode}','','',event);\">");g.push("{=title}");g.push("</a></span>");g.push('<i class="cline"></i>');g.push("</div></td>");g.push('<td class="date">');g.push('<div class="wrap_td">');g.push('<span class="date pcol2">{=addDate}</span>');g.push('<i class="cline"></i>');g.push("</div></td></tr>");this._wtplListBody=$Template(g.join(""));var i=[];i.push('<li class="item {=isOn}">');i.push('<a href="/PostView.nhn?blogId={=blogId}&logNo={=logNo}&categoryNo={=categoryNo}&parentCategoryNo={=parentCategoryNo}" class="link pcol2">');i.push('{if thumbnailPath != ""}');i.push('<img class="thumb" alt="섬네일" src="{=thumbnailPath}" onerror="this.onerror=\'\';this.src=\'{=errorImg}\';" />');i.push("{/if}");i.push('<div class="desc">');i.push('<strong class="title ell">{=title}</strong>');i.push('<span class="date">{=addDate}</span>');i.push('{if commentCount != ""}');i.push('<span class="read">');i.push('<i class="icon"><span class="blind">댓글수</span></i> {=commentCount}');i.push("</span>");i.push("{/if}");i.push('<i class="bg"></i>');i.push("</div>");i.push("{=tplVideo}");i.push('<i class="aline"></i><i class="aline3 pcol3"></i>');i.push("</a>");i.push("</li>");this._wtplThumbnailListBody=$Template(i.join(""));var h=[];h.push('<tr class="{=isOn}">');h.push('<td class="title">');h.push('<div class="wrap_td">');h.push('{if commentCount}<div class="meta_data"><span class="num pcol3">({=commentCount})</span></div>{/if}');h.push('<span class="ell2 pcol2">');h.push('<a logno="{=logNo}" href="/PostView.nhn?blogId=');h.push(j);h.push("&logNo={=logNo}&parentCategoryNo=");h.push(d);h.push("&categoryNo=");h.push(b);h.push("&viewDate=");h.push(e);h.push("&isShowPopularPosts=");h.push(c);h.push("&from=");h.push(a);h.push("\" class=\"pcol2\" onclick=\"clickcr(this,'{=nClickCode}','','',event);\">");h.push("{=title}");h.push("</a>");h.push("</span>");h.push('<i class="cline"></i>');h.push("</div>");h.push("</td>");h.push('<td class="date">');h.push('<div class="wrap_td"><span class="date pcol2">{=addDate}</span><i class="cline"></i></div>');h.push("</td>");h.push("</tr>");this._wtplPopularPostTextListBody=$Template(h.join(""));var f=[];f.push('<strong class="blind">페이지 이동하기</strong>');f.push('{if !bHasPreviousPage}<span href="#" class="pre pcol2"><i class="icon"></i>이전<span class="blind">페이지로 이동</span></span>{else}<a href="#" class="pre pcol2 _previous{=sNavigationPostfix} _param({=nPreviousIndexLogNo}|{=nPreviousIndexSortDate}) _returnFalse aggregate_click_delegate"><i class="icon"></i>이전<span class="blind">페이지로 이동</span></a>{/if}');f.push('{if !bHasNextPage}<span href="#" class="next pcol2">다음<span class="blind">페이지로 이동</span><i class="icon"></i></span>{else}<a href="#" class="next pcol2 _next{=sNavigationPostfix} _param({=nNextIndexLogNo}|{=nNextIndexSortDate}) _returnFalse aggregate_click_delegate">다음<span class="blind">페이지로 이동</span><i class="icon"></i></a>{/if}');this._wtplNavigation=$Template(f.join(""))},_assignModelEventHandlers:function(){var a=jsMVC.getModel("postViewBottomTitleListController","postViewBottomTitleListModel");a.gotBottomCategoryPostTitleList.attach($Fn(function(b){var c=b.bIsThumbnailViewType?"postBottomThumbnailTitleListBody":"postBottomTitleListBody";var d=b.bIsThumbnailViewType?"postBottomThumbnailTitleListNavigation":"postBottomTitleListNavigation";this._generateTitleList(b.aPostList,b.bHasNextPage,b.bHasPreviousPage,b.nNextIndexLogNo,b.nNextIndexSortDate,b.nPreviousIndexLogNo,b.nPreviousIndexSortDate,c,d,"_category","rec_others.title",b.bIsThumbnailViewType)},this).bind());a.gotPopularPostTitleList.attach($Fn(function(b){if(!!b.bIsSuccess&&b.aPostList.length>0){var c=b.bIsThumbnailViewType?"popularThumbList":"popularTextList";this._generatePopularPostTitleList(b.aPostList,b.bHasNextPage,b.bHasPreviousPage,"","","","",c,"_popular","rec_most.title")}else{$Element("postBottomTitleListTop").show()}},this).bind())},_generateTitleList:function(n,q,a,d,m,e,h,g,l,c,b,p){var o=$Element(g);if(!o){return}var k=[];if(p){for(var f=0;f<n.length;f++){var j=n[f];k.push(this._wtplThumbnailListBody.process({blogId:blogId,logNo:j.logNo,categoryNo:categoryNo,parentCategoryNo:parentCategoryNo,isOn:this.nFirstPostLogNo==j.logNo?"on":"",thumbnailPath:j.thumbnailPath,tplVideo:j.isVideo?$("tpl_video").innerHTML:"",title:utility.decodeURIComponentForJava(j.filteredEncodedTitle),addDate:j.addDate,commentCount:j.commentCount,nClickCode:b,errorImg:gsStaticNetUrl+"/blog/no_image2.svg"}))}}else{for(var f=0;f<n.length;f++){var j=n[f];k.push(this._wtplListBody.process({logNo:j.logNo,isOn:this.nFirstPostLogNo==j.logNo?"on":"",title:utility.decodeURIComponentForJava(j.filteredEncodedTitle),addDate:j.addDate,commentCount:j.commentCount,nClickCode:b}))}}o.html(k.join(""));if(a||q){$Element(l).html(this._wtplNavigation.process({bHasPreviousPage:a,bHasNextPage:q,nNextIndexLogNo:d,nNextIndexSortDate:m,nPreviousIndexLogNo:e,nPreviousIndexSortDate:h,sNavigationPostfix:c}))}},_generatePopularPostTitleList:function(m,n,a,d,l,e,h,g,c,b){var k=[];for(var f=0;f<m.length;f++){var j=m[f];k.push(this._wtplPopularPostTextListBody.process({logNo:j.logNo,title:utility.decodeURIComponentForJava(j.filteredEncodedTitle),addDate:j.addDate,commentCount:j.commentCount,nClickCode:b,isOn:this.nFirstPostLogNo==j.logNo?"on":""}))}$Element(g+"_popularPostListBoddy").html(k.join(""));$Element(g).show();if(a||n){$Element(g+"_popularPostListPaginate").html(this._wtplNavigation.process({bHasPreviousPage:a,bHasNextPage:n,nNextIndexLogNo:d,nNextIndexSortDate:l,nPreviousIndexLogNo:e,nPreviousIndexSortDate:h,sNavigationPostfix:c}))}},_topButtonMarkUp:"<a href=\"#\" onclick=\"clickcr(this, 'rec.top', '', '', event)\"><span class=\"pcol2 i1\"><em>▲</em> top</span></a>",_locateTopButton:function(a){var b=$$("._toTop");if(a!=null&&b.length>a){b[a].innerHTML=this._topButtonMarkUp}else{if(b!=null&&b.length>0){b[b.length-1].innerHTML=this._topButtonMarkUp}}},findSortDateInMilli:function(){var a=$$.getSingle("._postAddDate");if(!!a){return Date.parse(a.innerHTML)}else{return new Date().getTime()}}});jsMVC.setController("postViewBottomTitleListController",PostViewBottomTitleListController);jsMVC.setModel("postViewBottomTitleListController","postViewBottomTitleListModel",PostViewBottomTitleListModel);jsMVC.setView("postViewBottomTitleListController","postViewBottomTitleListView",PostViewBottomTitleListView);var postViewBottomTitleListController=jsMVC.getController("postViewBottomTitleListController");if(typeof(window.defineNHNJS)=="undefined"){window.defineNHNJS={}}window.defineNHNJS["PostViewBottom-515210704_js"]=true;
