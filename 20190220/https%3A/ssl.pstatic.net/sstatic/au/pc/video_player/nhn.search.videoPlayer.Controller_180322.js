window.nhn=window.nhn||{},window.nhn.search=window.nhn.search||{},window.nhn.search.videoPlayer=window.nhn.search.videoPlayer||{},window.nhn.search.videoPlayer.Controller=function(t){function e(r){if(i[r])return i[r].exports;var s=i[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){(function(e){var i=eg.Class.extend(eg.Component,{construct:function(t){this.option(t||{}),this._initVars(),this._initModules(),this._attachEvents(),this._start()},_initVars:function(){this._$base=e(this.option("$base")),this._persistId=this.option("persistId"),this._$list=this.option("$list"),this._toggleListClass=this.option("toggleListClass"),this._$item=this.option("$item"),this._toggleItemClass=this.option("toggleItemClass"),this._triggerSelector="._trigger",this._targetSelector="._target",this._closeSelector="._close",this._retrySelector="._retry",this._$trigger=this._$list.find(this._triggerSelector),this._$target=this._$list.find(this._targetSelector),this._$errorTmpl=this.option("$errorTmpl"),this._htNaver=this.option("htNaver"),this._tmplNaver=this._htNaver.tmpl,this._htYoutube=this.option("htYoutube"),this._tmplYoutube=this._htYoutube.tmpl},_initModules:function(){this._oPlayer=[]},_attachEvents:function(){var t=this;this._$item&&this._$item.on("click",t._triggerSelector,function(e){t._clickPlayVideo(e),t.trigger("clicklog-trigger-click",e)}),this._$list&&this._$list.on("click",t._closeSelector,function(e){t._onClickCloseVideo(e),t.trigger("clicklog-close-click",e)}),this._$list&&this._$list.on("click",t._retrySelector,function(e){t._onClickRetry(e),t.trigger("clicklog-retry-click",e)}),e(window).on("rotate",e.proxy(this,"_onRotate"))},_start:function(){this._persist()},_restore:function(t){},_showError:function(t,e){var i=this._$target.eq(e.index);html=this._$errorTmpl.html(),html=html.replace("{=api}",e.api).replace("{=index}",e.index),i.html(html)},_onClickCloseVideo:function(t){t.preventDefault();var i=e(t.currentTarget);if(i.hasClass("_close"))var r=i.closest(this._targetSelector),s=this._$item.eq(this._$target.index(r));else var a=this._$trigger.index(i),s=this._$item.eq(a),r=this._$target.eq(a);var l=s.data("index"),o=s.find(this._triggerSelector),n=o.data("source");if("youtube"===n)s.find("._ytplayer").each(function(){this.src=this.src.replace("autoplay=1","autoplay=0")});else if("naver"===n)try{this._oPlayer[l].pause()}catch(h){}s.removeClass(this._toggleItemClass),this._$list.removeClass(this._toggleListClass),r.hide()},_closeAllVideo:function(){for(var t=null,e=null,i=null,r=null,s=0;s<this._$item.length;s++)if(t=this._$item.eq(s),i=t.data("index"),e=t.find(this._triggerSelector),this._$target.eq(s),r=e.data("source"),t.hasClass(this._toggleItemClass)){if("youtube"===r)t.find("._ytplayer").each(function(){this.src=this.src.replace("autoplay=1","autoplay=0")});else if("naver"===r)try{this._oPlayer[i].pause()}catch(a){}t.removeClass(this._toggleItemClass)}t.removeClass(this._toggleItemClass),this._$list.removeClass(this._toggleListClass),this._$target.hide()},_playNaver:function(t,e,i){var r=t.data("index"),s=t.find(this._triggerSelector),a=(s.data("api"),null);if("undefined"!=typeof this._oPlayer[r])return void this._oPlayer[r].play();a=this._tmplNaver.html(),a=a.replace("{=id}",i.sVid).replace(/{=realUrl}/gi,i.sRealUrl).replace(/{=playUrl}/gi,i.sPlayUrl).replace("{=title}",i.title).replace("{=info1}",i.sServiceName).replace("{=info2}",i.sDate).replace("{=info3}",i.sPlayTime),e.html(a),this._oPlayer[r]=new naver.WebPlayer(i.sVid,i.sInKey,0,0,i.sService,this._htNaver.playerType,null),"RMC"===i.sService?this._oPlayer[r].setProperties({skinName:this._htNaver.skinName,coverImageURL:i.sThumbnailUrl,infraType:i.infraType,advertiseInfo:this._htNaver.advertiseInfo,advertiseUrl:this._htNaver.advertiseUrl,autoPlay:!0}):this._oPlayer[r].setProperties({skinName:this._htNaver.skinName,coverImageURL:i.sThumbnailUrl,infraType:i.infraType,autoPlay:!0}),this._oPlayer[r].displayPlayer(e.find("._nplayer").get(0))},_playYoutube:function(t,e,i){var r=(t.data("index"),t.find(this._triggerSelector)),s=(r.data("api"),null);return e.text()>10?void e.hide():"ie"===eg.agent().browser.name&&parseInt(eg.agent().browser.version,10)<9?(e.hide(),void alert("IE8에서는 Youtube 영상 바로재생이 지원되지 않습니다.")):(s=this._tmplYoutube.html(),s=s.replace(/{=playUrl}/gi,i.sPlayUrl).replace(/{=realUrl}/gi,i.sRealUrl).replace("{=title}",i.title).replace("{=info1}",i.sServiceName).replace("{=info2}",i.sDate).replace("{=info3}",i.sPlayTime),void e.html(s))},_clickPlayVideo:function(t){t.preventDefault();var i=e(t.delegateTarget),r=i.find(this._triggerSelector),s=this._$item.index(i),a=i.find(this._targetSelector).length?i.find(this._targetSelector):this._$target.eq(s),l=r.data("api"),o=this;if(i.hasClass(this._toggleItemClass))return void this._onClickCloseVideo(t);this._closeAllVideo(),i.addClass(this._toggleItemClass),this._$list.addClass(this._toggleListClass),a.show();e.ajax({method:"GET",url:l,dataType:"jsonp",jsonp:"_callback",xhrFields:{withCredentials:!0},cache:!0,timeout:3e3}).done(function(t){"Youtube"===t.sServiceName?(r.attr("data-source","youtube"),o._playYoutube(i,a,t)):(r.attr("data-source","naver"),o._playNaver(i,a,t))}).fail(function(){var t={api:l,index:s};o._showError(i,t)})},_onClickRetry:function(t){t.preventDefault();var i=e(t.currentTarget),r=i.data("index"),s=i.data("api"),a=this._$item.eq(r);$target=this._$target.eq(r),self=this,$target.show();e.ajax({method:"GET",url:s,dataType:"jsonp",jsonp:"_callback",xhrFields:{withCredentials:!0},cache:!0,timeout:3e3}).done(function(t){"Youtube"===t.sServiceName?(i.attr("data-source","youtube"),self._playYoutube(a,$target,t)):(i.attr("data-source","naver"),self._playNaver(a,$target,t))}).fail(function(){var t={api:s,index:r};self._showError(a,t)})},_onRotate:function(){},_persist:function(){},_setPersist:function(t,e){}});t.exports=i}).call(e,i(2))},function(t,e){!function(){t.exports=window.jQuery}()}]);
//# sourceMappingURL=nhn.search.videoPlayer.Controller.js.map