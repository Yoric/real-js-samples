window.O365 = window.O365 || {}; O365.ShellAriaLogger = (function() {var clienttelemetry_build;(function(f){f.version="2.9.0"})(clienttelemetry_build||(clienttelemetry_build={}));var Microsoft;
(function(f){(function(d){(function(b){b[b.BT_STOP=0]="BT_STOP";b[b.BT_STOP_BASE=1]="BT_STOP_BASE";b[b.BT_BOOL=2]="BT_BOOL";b[b.BT_UINT8=3]="BT_UINT8";b[b.BT_UINT16=4]="BT_UINT16";b[b.BT_UINT32=5]="BT_UINT32";b[b.BT_UINT64=6]="BT_UINT64";b[b.BT_FLOAT=7]="BT_FLOAT";b[b.BT_DOUBLE=8]="BT_DOUBLE";b[b.BT_STRING=9]="BT_STRING";b[b.BT_STRUCT=10]="BT_STRUCT";b[b.BT_LIST=11]="BT_LIST";b[b.BT_SET=12]="BT_SET";b[b.BT_MAP=13]="BT_MAP";b[b.BT_INT8=14]="BT_INT8";b[b.BT_INT16=15]="BT_INT16";b[b.BT_INT32=16]="BT_INT32";
b[b.BT_INT64=17]="BT_INT64";b[b.BT_WSTRING=18]="BT_WSTRING";b[b.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"})(d.BondDataType||(d.BondDataType={}));(function(b){b[b.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL";b[b.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL";b[b.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL";b[b.JSON_PROTOCOL=21322]="JSON_PROTOCOL";b[b.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL";b[b.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"})(d.ProtocolType||(d.ProtocolType={}))})(f.Bond||(f.Bond={}))})(Microsoft||
(Microsoft={}));
(function(f){(function(d){(function(b){var c=function(){function a(){this._buffer=[]}a.prototype.Add=function(a){for(var e=0;e<this._buffer.length&&this._buffer[e]!=a;++e);e==this._buffer.length&&this._buffer.push(a)};a.prototype.Count=function(){return this._buffer.length};a.prototype.GetBuffer=function(){return this._buffer};return a}();b.Set=c;c=function(){function a(){this._buffer=[]}a.prototype.Add=function(a,e){-1==this._getIndex(a)&&this._buffer.push({Key:a,Value:e})};a.prototype.AddOrReplace=function(a,
e){var r=this._getIndex(a);0<=r?this._buffer[r]={Key:a,Value:e}:this._buffer.push({Key:a,Value:e})};a.prototype.Remove=function(a){a=this._getIndex(a);0<=a&&this._buffer.splice(a,1)};a.prototype.Count=function(){return this._buffer.length};a.prototype.GetBuffer=function(){return this._buffer};a.prototype.ContainsKey=function(a){return 0<=this._getIndex(a)?!0:!1};a.prototype.Get=function(a){a=this._getIndex(a);return 0<=a?this._buffer[a].Value:null};a.prototype._getIndex=function(a){for(var e=0,r=
-1;e<this._buffer.length;++e)if(this._buffer[e].Key==a){r=e;break}return r};return a}();b.Map=c})(d.Collections||(d.Collections={}))})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(d){(function(c){var a=function(){function a(){}a.GetBytes=function(e){for(var r=[],a=0;a<e.length;++a){var b=e.charCodeAt(a);128>b?r.push(b):2048>b?r.push(192|b>>6,128|b&63):55296>b||57344<=b?r.push(224|b>>12,128|b>>6&63,128|b&63):(b=65536+((b&1023)<<10|e.charCodeAt(++a)&1023),r.push(240|b>>18,128|b>>12&63,128|b>>6&63,128|b&63))}return r};return a}();c.Utf8=a;a=function(){function a(){}a.GetString=function(e){var a=[],b=e.length%3,c,l,d,n=function(e){return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>
18&63),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>12&63),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>6&63),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e&63)].join("")};c=0;for(d=e.length-b;c<d;c+=3)l=(e[c]<<16)+(e[c+1]<<8)+e[c+2],a.push(n(l));switch(b){case 1:l=e[e.length-1];a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l>>2));a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l<<
4&63));a.push("==");break;case 2:l=(e[e.length-2]<<8)+e[e.length-1],a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l>>10)),a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l>>4&63)),a.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(l<<2&63)),a.push("=")}return a.join("")};return a}();c.Base64=a;a=function(){function a(){}a.GetBytes=function(e){for(var a=[];e&4294967168;)a.push(e&127|128),e>>>=7;a.push(e&
127);return a};return a}();c.Varint=a;a=function(){function a(){}a.GetBytes=function(e){var a=e.low;e=e.high;for(var b=[];e||4294967168&a;)b.push(a&127|128),a=(e&127)<<25|a>>>7,e>>>=7;b.push(a&127);return b};return a}();c.Varint64=a;a=function(){function a(){}a.GetBytes=function(e){if(d.BrowserChecker.IsDataViewSupport()){var a=new DataView(new ArrayBuffer(4));a.setFloat32(0,e,!0);e=[];for(var c=0;4>c;++c)e.push(a.getUint8(c));return e}return b.ConvertNumberToArray(e,!1)};return a}();c.Float=a;a=
function(){function a(){}a.GetBytes=function(e){if(d.BrowserChecker.IsDataViewSupport()){var a=new DataView(new ArrayBuffer(8));a.setFloat64(0,e,!0);e=[];for(var c=0;8>c;++c)e.push(a.getUint8(c));return e}return b.ConvertNumberToArray(e,!0)};return a}();c.Double=a;a=function(){function a(){}a.EncodeZigzag16=function(e){e=d.Number.ToInt16(e);return e<<1^e>>15};a.EncodeZigzag32=function(e){e=d.Number.ToInt32(e);return e<<1^e>>31};a.EncodeZigzag64=function(e){var a=e.low,b=e.high;e=b<<1|a>>>31;a<<=1;
b&2147483648&&(e=~e,a=~a);b=new d.UInt64("0");b.low=a;b.high=e;return b};return a}();c.Zigzag=a})(d.Encoding||(d.Encoding={}));(function(c){var a=function(){function a(){}a.GetString=function(e){for(var a=[],b=0;b<e.length;++b){var c=e[b];if(191>=c)a.push(String.fromCharCode(c));else if(223>=c){var l=e[++b];a.push(String.fromCharCode((c&31)<<6|l&63))}else if(239>=c){var l=e[++b],d=e[++b];a.push(String.fromCharCode((c&15)<<12|(l&63)<<6|d&63))}else{var l=e[++b],d=e[++b],n=e[++b],c=(c&7)<<18|(l&63)<<
12|(d&63)<<6|n&63,c=c-65536;a.push(String.fromCharCode(55296|c>>10&1023));a.push(String.fromCharCode(56320|c&1023))}}return a.join("")};return a}();c.Utf8=a;a=function(){function a(){}a.GetBytes=function(a){for(var b=[],c=0;c<a.length;++c){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c++)),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c++)),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c++)),
n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c));b.push(l<<2|d>>4);0<=h&&(b.push(d<<4&240|h>>2),0<=n&&b.push(h<<6&192|n))}return b};return a}();c.Base64=a;a=function(){function a(){}a.GetInt64=function(a){var b=new f.Bond.Int64("0");a=this._Read(a);b.low=a[0];1<a.length&&(b.high=a[1]);return b};a.GetNumber=function(a){return this._Read(a)[0]};a._Read=function(a){for(var b=[],c=0,l=!0,d=0;l;){var h=a.shift(),l=0!=(h&128),h=h&127;if(28>d)c|=h<<d,d+=7;else{c|=
h<<d;b.push(c);c=h>>4;d=3;break}}for(;l&&!(h=a.shift(),l=0!=(h&128),h&=127,c|=h<<d,d+=7,32<=d););b.push(c);return b};return a}();c.Varint=a;a=function(){function a(){}a.GetNumber=function(a){if(d.BrowserChecker.IsDataViewSupport()){for(var c=new DataView(new ArrayBuffer(4)),l=0;4>l;++l)c.setUint8(l,a[l]);return c.getFloat32(0,!0)}return b.ConvertArrayToNumber(a,!1)};return a}();c.Float=a;a=function(){function a(){}a.GetNumber=function(a){if(d.BrowserChecker.IsDataViewSupport()){for(var c=new DataView(new ArrayBuffer(8)),
l=0;8>l;++l)c.setUint8(l,a[l]);return c.getFloat64(0,!0)}return b.ConvertArrayToNumber(a,!0)};return a}();c.Double=a;a=function(){function a(){}a.DecodeZigzag16=function(a){return((65535&a)>>>1^-(a&1))<<16>>16};a.DecodeZigzag32=function(a){return a>>>1^-(a&1)};a.DecodeZigzag64=function(a){var b=a.high>>>1,c=a.low&1,l=a.low>>>1,l=(a.high&1)<<31|l;c&&(l^=4294967295,b^=4294967295);a=new f.Bond.UInt64("0");a.low=l;a.high=b;return a};return a}();c.Zigzag=a})(d.Decoding||(d.Decoding={}));var b=function(){function b(){}
b.ConvertNumberToArray=function(a,b){if(!a)return b?this._doubleZero:this._floatZero;var e=b?52:23,c=(1<<(b?11:8)-1)-1,d=0>a?1:0;a=Math.abs(a);for(var g=Math.floor(a),f=a-g,h=2*(c+2)+e,n=Array(h),k=0;k<h;)n[k++]=0;for(k=c+2;k&&g;)n[--k]=g%2,g=Math.floor(g/2);for(k=c+1;k<h-1&&0<f;)f*=2,1<=f?(n[++k]=1,--f):n[++k]=0;for(f=0;f<h&&!n[f];++f);h=c+1-f;k=f+e;if(n[k+1]){for(;k>f&&!(n[k]=1-n[k]);--k);k==f&&++h}if(h>c||g)return d?b?this._doubleNegInifinity:this._floatNegInifinity:b?this._doubleInifinity:this._floatInifinity;
if(h<1-c)return b?this._doubleZero:this._floatZero;if(b){for(k=g=0;20>k;++k)g=g<<1|n[++f];for(e=0;52>k;++k)e=e<<1|n[++f];g=d<<31|(g|h+c<<20)&2147483647;c=[e&255,e>>8&255,e>>16&255,e>>>24,g&255,g>>8&255,g>>16&255,g>>>24]}else{for(k=g=0;23>k;++k)g=g<<1|n[++f];g=d<<31|(g|h+c<<23)&2147483647;c=[g&255,g>>8&255,g>>16&255,g>>>24]}return c};b.ConvertArrayToNumber=function(a,b){var e=(1<<(b?11:8)-1)-1,c=0!=(a[b?7:3]&128),f=b?(a[7]&127)<<4|(a[6]&240)>>4:(a[3]&127)<<1|(a[2]&128)>>7;if(255==f)throw new d.Exception("Not a valid float/double buffer.");
var g=1,t=1;if(b){var h=(a[6]&15)<<28|(a[5]&255)<<20|(a[4]&255)<<12,n=a[3]<<24|(a[2]&255)<<16|(a[1]&255)<<8|a[0]&255;if(!f&&!h&&!n)return 0;for(var k=0;20>k;++k)t/=2,0>h&&(g+=t),h<<=1;for(k=0;32>k;++k)t/=2,0>n&&(g+=t),n<<=1}else{h=(a[2]&127)<<25|(a[1]&255)<<17|(a[0]&255)<<9;if(!f&&!h)return 0;for(k=0;23>k;++k)t/=2,0>h&&(g+=t),h<<=1}g*=Math.pow(2,f-e);return c?0-g:g};return b}();b._floatZero=[0,0,0,0];b._doubleZero=[0,0,0,0,0,0,0,0];b._floatInifinity=[0,0,128,127];b._floatNegInifinity=[0,0,128,255];
b._doubleInifinity=[0,0,0,0,0,0,240,127];b._doubleNegInifinity=[0,0,0,0,0,0,240,255]})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(d){(function(b){var c=function(){function a(){this._buffer=[]}a.prototype.WriteByte=function(a){this._buffer.push(d.Number.ToByte(a))};a.prototype.Write=function(a,e,b){for(;b--;)this.WriteByte(a[e++])};a.prototype.GetBuffer=function(){return this._buffer};return a}();b.MemoryStream=c})(d.IO||(d.IO={}))})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(d){var b=function(){return function(b,a){this.Type=b;this.Id=a}}();d.FieldTag=b;b=function(){return function(b,a){this.ElementType=b;this.Size=a}}();d.ContainerTag=b;b=function(){return function(b,a,l){this.KeyType=b;this.ValueType=a;this.Size=l}}();d.KeyValueContainerTag=b;b=function(){return function(){}}();d.Bonded=b;b=function(){function b(a){this.high=this.low=0;this.low=parseInt(a);0>this.low&&(this.high=-1)}b.prototype.Equals=function(a){a=new b(a);return this.low==a.low&&
this.high==a.high};return b}();d.Int64=b;b=function(){function b(a){this.high=this.low=0;this.low=parseInt(a)}b.prototype.Equals=function(a){a=new b(a);return this.low==a.low&&this.high==a.high};return b}();d.UInt64=b;b=function(){function b(){}b.ToByte=function(a){return this.ToUInt8(a)};b.ToInt8=function(a){return a&127|(a&128)<<24>>24};b.ToInt16=function(a){return a&32767|(a&32768)<<16>>16};b.ToInt32=function(a){return a&2147483647|a&2147483648};b.ToUInt8=function(a){return a&255};b.ToUInt16=function(a){return a&
65535};b.ToUInt32=function(a){return a&4294967295};return b}();d.Number=b;b=function(){return function(b){this.Message=b}}();d.Exception=b;b=function(){return function(){}}();d.KeyValuePair=b;b=function(){function b(){}b.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView};return b}();d.BrowserChecker=b})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));
(function(f){(function(d){var b=function(){function b(a){this._stream=a}b.prototype.WriteBlob=function(a){this._stream.Write(a,0,a.length)};b.prototype.WriteBool=function(a){this._stream.WriteByte(a?1:0)};b.prototype.WriteContainerBegin=function(a,b){this.WriteUInt8(b);this.WriteUInt32(a)};b.prototype.WriteMapContainerBegin=function(a,b,e){this.WriteUInt8(b);this.WriteUInt8(e);this.WriteUInt32(a)};b.prototype.WriteContainerEnd=function(){};b.prototype.WriteDouble=function(a){a=d.Encoding.Double.GetBytes(a);
this._stream.Write(a,0,a.length)};b.prototype.WriteFloat=function(a){a=d.Encoding.Float.GetBytes(a);this._stream.Write(a,0,a.length)};b.prototype.WriteFieldBegin=function(a,b,e){5>=b?this._stream.WriteByte(a|b<<5):255>=b?(this._stream.WriteByte(a|192),this._stream.WriteByte(b)):(this._stream.WriteByte(a|224),this._stream.WriteByte(b),this._stream.WriteByte(b>>8))};b.prototype.WriteFieldEnd=function(){};b.prototype.WriteFieldOmitted=function(a,b,e){};b.prototype.WriteInt16=function(a){a=d.Encoding.Zigzag.EncodeZigzag16(a);
this.WriteUInt16(a)};b.prototype.WriteInt32=function(a){a=d.Encoding.Zigzag.EncodeZigzag32(a);this.WriteUInt32(a)};b.prototype.WriteInt64=function(a){this.WriteUInt64(d.Encoding.Zigzag.EncodeZigzag64(a))};b.prototype.WriteInt8=function(a){this._stream.WriteByte(d.Number.ToInt8(a))};b.prototype.WriteString=function(a){""==a?this.WriteUInt32(0):(a=d.Encoding.Utf8.GetBytes(a),this.WriteUInt32(a.length),this._stream.Write(a,0,a.length))};b.prototype.WriteStructBegin=function(a,b){};b.prototype.WriteStructEnd=
function(a){this.WriteUInt8(a?d.BondDataType.BT_STOP_BASE:d.BondDataType.BT_STOP)};b.prototype.WriteUInt16=function(a){a=d.Encoding.Varint.GetBytes(d.Number.ToUInt16(a));this._stream.Write(a,0,a.length)};b.prototype.WriteUInt32=function(a){a=d.Encoding.Varint.GetBytes(d.Number.ToUInt32(a));this._stream.Write(a,0,a.length)};b.prototype.WriteUInt64=function(a){a=d.Encoding.Varint64.GetBytes(a);this._stream.Write(a,0,a.length)};b.prototype.WriteUInt8=function(a){this._stream.WriteByte(d.Number.ToUInt8(a))};
b.prototype.WriteWString=function(a){this.WriteUInt32(a.length);for(var b=0;b<a.length;++b){var e=a.charCodeAt(b);this._stream.WriteByte(e);this._stream.WriteByte(e>>>8)}};return b}();d.CompactBinaryProtocolWriter=b;b=function(){return function(){}}();d.CompactBinaryProtocolReader=b})(f.Bond||(f.Bond={}))})(Microsoft||(Microsoft={}));var sct;
(function(f){var d=function(){function b(){}b.IsSafari=function(){if(null===b._isSafari)if("undefined"!==typeof navigator&&navigator.userAgent){var c=navigator.userAgent.toLowerCase();0<=c.indexOf("safari")&&0>c.indexOf("chrome")?b._isSafari=!0:b._isSafari=!1}else b._isSafari=!1;return b._isSafari};b.IsReactNative=function(){null===b._isReactNative&&(b._isReactNative="undefined"!==typeof navigator&&navigator.product?"ReactNative"===navigator.product:!1);return b._isReactNative};b.IsUint8ArrSupported=
function(){return!f.Utils.IsSafari()&&"undefined"!==typeof Uint8Array&&!f.Utils.IsReactNative()};b.ajax=function(c,a){var d=b._createConnection();if(c.headers){var e="qsp=true",r;for(r in c.headers)e+="&",e+=encodeURIComponent(r),e+="=",e+=encodeURIComponent(c.headers[r]);0>c.url.indexOf("?")?c.url+="?":c.url+="&";c.url+=e}d.open(c.type,c.url,!a);c.complete&&(d.onload=function(){c.complete(d)},d.ontimeout=function(){c.complete(d)},d.onerror=function(){c.complete(d)},d.onabort=function(){c.complete(d)});
d.send(c.data)};b.keys=function(b){if(Object.keys)return Object.keys(b);var a=[],d;for(d in b)b.hasOwnProperty(d)&&a.push(d);return a};b.IsUsingXDomainRequest=function(){null==b._usingXDomainRequest&&(b._usingXDomainRequest="undefined"==typeof(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?!0:!1);return b._usingXDomainRequest};b._createConnection=function(){var c=new XMLHttpRequest;return b.IsUsingXDomainRequest()?new XDomainRequest:c};return b}();d._isSafari=null;d._isReactNative=
null;d._usingXDomainRequest=null;f.Utils=d})(sct||(sct={}));var microsoft;
(function(f){(function(d){(function(b){(function(c){var a=function(){function a(){}a.GetGuid=function(){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[a(),a(),"-",a(),"-",a(),"-",a(),"-",a(),a(),a()].join("")};a.GetTimeStamp=function(){var a=(new Date).getTime(),b=new Microsoft.Bond.Int64("0");b.low=a&4294967295;b.high=Math.floor(a/4294967296);return b};a.GetTimeStampWithValue=function(a){var b=new Microsoft.Bond.Int64("0");b.low=a&4294967295;b.high=
Math.floor(a/4294967296);return b};return a}();c.utils=a;(function(a){a[a.NotSet=0]="NotSet";a[a.Event=1]="Event";a[a.PerformanceCounter=2]="PerformanceCounter";a[a.Anomaly=3]="Anomaly";a[a.Prediction=4]="Prediction";a[a.TraceLog=5]="TraceLog";a[a.EventSourceLog=6]="EventSourceLog";a[a.HttpLog=7]="HttpLog";a[a.PerformanceCounterAzure=8]="PerformanceCounterAzure";a[a.PerformanceCounterGfs=9]="PerformanceCounterGfs"})(c.RecordType||(c.RecordType={}));(function(a){a[a.NotSet=0]="NotSet";a[a.O365=1]=
"O365";a[a.SkypeBI=2]="SkypeBI";a[a.SkypeData=3]="SkypeData"})(c.PIIScrubber||(c.PIIScrubber={}));(function(a){a[a.NotSet=0]="NotSet";a[a.DistinguishedName=1]="DistinguishedName";a[a.GenericData=2]="GenericData";a[a.IPV4Address=3]="IPV4Address";a[a.IPv6Address=4]="IPv6Address";a[a.MailSubject=5]="MailSubject";a[a.PhoneNumber=6]="PhoneNumber";a[a.QueryString=7]="QueryString";a[a.SipAddress=8]="SipAddress";a[a.SmtpAddress=9]="SmtpAddress";a[a.Identity=10]="Identity";a[a.Uri=11]="Uri";a[a.Fqdn=12]="Fqdn";
a[a.IPV4AddressLegacy=13]="IPV4AddressLegacy"})(c.PIIKind||(c.PIIKind={}));(function(a){a[a.Unknown=0]="Unknown";a[a.MSACID=1]="MSACID";a[a.MSAPUID=2]="MSAPUID";a[a.ANID=3]="ANID";a[a.OrgIdCID=4]="OrgIdCID";a[a.OrgIdPUID=5]="OrgIdPUID";a[a.UserObjectId=6]="UserObjectId";a[a.Skype=7]="Skype";a[a.Yammer=8]="Yammer";a[a.EmailAddress=9]="EmailAddress";a[a.PhoneNumber=10]="PhoneNumber";a[a.SipAddress=11]="SipAddress";a[a.MUID=12]="MUID"})(c.UserIdType||(c.UserIdType={}));var d=function(){function a(){this.ScrubType=
b.datamodels.PIIScrubber.NotSet;this.Kind=b.datamodels.PIIKind.NotSet;this.RawContent=""}a.prototype.Write=function(a){this.WriteImpl(a,!1)};a.prototype.WriteImpl=function(a,e){a.WriteStructBegin(null,e);this.ScrubType!=b.datamodels.PIIScrubber.NotSet?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,1,null),a.WriteInt32(this.ScrubType),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,1,null);this.Kind!=b.datamodels.PIIKind.NotSet?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,
2,null),a.WriteInt32(this.Kind),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null);""!=this.RawContent?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,3,null),a.WriteString(this.RawContent),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,3,null);a.WriteStructEnd(e)};a.prototype.Read=function(a){this.ReadImpl(a,!1)};a.prototype.ReadImpl=function(a,b){};return a}();c.PII=d;d=function(){function e(){this.Id=a.GetGuid();this.Timestamp=
a.GetTimeStamp();this.EventType=this.Type="";this.Extension=new Microsoft.Bond.Collections.Map;this.RecordType=b.datamodels.RecordType.NotSet;this.PIIExtensions=new Microsoft.Bond.Collections.Map}e.prototype.AddOrReplacePII=function(a,e,c){var d=new b.datamodels.PII;d.RawContent=e;d.Kind=c;d.ScrubType=b.datamodels.PIIScrubber.O365;this.PIIExtensions.AddOrReplace(a,d)};e.prototype.Write=function(a){this.WriteImpl(a,!1)};e.prototype.WriteImpl=function(a,e){a.WriteStructBegin(null,e);""!=this.Id?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,
1,null),a.WriteString(this.Id),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,1,null);this.Timestamp.Equals("0")?a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,3,null):(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,3,null),a.WriteInt64(this.Timestamp),a.WriteFieldEnd());""!=this.Type?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),a.WriteString(this.Type),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,
5,null);""!=this.EventType?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,6,null),a.WriteString(this.EventType),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,6,null);if(this.Extension.Count()){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,13,null);a.WriteMapContainerBegin(this.Extension.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRING);for(var c=0;c<this.Extension.GetBuffer().length;++c)a.WriteString(this.Extension.GetBuffer()[c].Key),
a.WriteString(this.Extension.GetBuffer()[c].Value);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,13,null);this.RecordType!=b.datamodels.RecordType.NotSet?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,24,null),a.WriteInt32(this.RecordType),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,24,null);if(this.PIIExtensions.Count()){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,30,null);a.WriteMapContainerBegin(this.PIIExtensions.Count(),
Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRUCT);for(c=0;c<this.PIIExtensions.GetBuffer().length;++c)a.WriteString(this.PIIExtensions.GetBuffer()[c].Key),this.PIIExtensions.GetBuffer()[c].Value.WriteImpl(a,!1);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,30,null);a.WriteStructEnd(e)};e.prototype.Read=function(a){this.ReadImpl(a,!1)};e.prototype.ReadImpl=function(a,b){};return e}();c.Record=d;d=function(){function a(){this.DataPackageId=
this.Source="";this.Timestamp=new Microsoft.Bond.Int64("0");this.Records=[]}a.prototype.Write=function(a){this.WriteImpl(a,!1)};a.prototype.WriteImpl=function(a,b){a.WriteStructBegin(null,b);""!=this.Source?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,2,null),a.WriteString(this.Source),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,2,null);""!=this.DataPackageId?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),a.WriteString(this.DataPackageId),
a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null);this.Timestamp.Equals("0")?a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,6,null):(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,6,null),a.WriteInt64(this.Timestamp),a.WriteFieldEnd());if(this.Records.length){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,8,null);a.WriteContainerBegin(this.Records.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var c=0;c<this.Records.length;++c)this.Records[c].WriteImpl(a,
!1);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,8,null);a.WriteStructEnd(b)};a.prototype.Read=function(a){this.ReadImpl(a,!1)};a.prototype.ReadImpl=function(a,b){};return a}();c.DataPackage=d;d=function(){function a(){this.DataPackages=[];this.RequestRetryCount=0}a.prototype.Write=function(a){this.WriteImpl(a,!1)};a.prototype.WriteImpl=function(a,b){a.WriteStructBegin(null,b);if(this.DataPackages.length){a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,
1,null);a.WriteContainerBegin(this.DataPackages.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var c=0;c<this.DataPackages.length;++c)this.DataPackages[c].WriteImpl(a,!1);a.WriteContainerEnd();a.WriteFieldEnd()}else a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(a.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),a.WriteInt32(this.RequestRetryCount),a.WriteFieldEnd()):a.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null);a.WriteStructEnd(b)};
a.prototype.Read=function(a){this.ReadImpl(a,!1)};a.prototype.ReadImpl=function(a,b){};return a}();c.ClientToCollectorRequest=d})(b.datamodels||(b.datamodels={}))})(d.telemetry||(d.telemetry={}))})(f.applications||(f.applications={}))})(microsoft||(microsoft={}));
(function(f){(function(d){(function(b){(function(c){var a;(function(a){a[a.SENT=0]="SENT";a[a.SEND_FAILED=1]="SEND_FAILED"})(a=c.CallbackEventType||(c.CallbackEventType={}));var d;(function(a){a[a.DATARV_ERROR_OK=0]="DATARV_ERROR_OK";a[a.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT";a[a.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG";a[a.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES";a[a.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS";
a[a.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"})(d=c.DATARV_ERROR||(c.DATARV_ERROR={}));var e=function(){function a(b){this._errorCode=d.DATARV_ERROR_OK;this._errorCode=b}a.prototype.ErrorCode=function(){return this._errorCode};a.prototype.toString=function(){switch(this._errorCode){case d.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case d.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case d.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";
case d.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case d.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case d.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}};return a}();c.Exception=e;var f=function(){return function(){}}();c.TelemetryConfig=f;f=function(){function a(){}a.CreateTelemetryManager=function(){return new t};return a}();c.TelemetryManagerFactory=f;var q=function(){function a(){}
a.MaxPackageSizeInBytes=function(){return 3E6};a.TimeIntervalForNextSendInMS=function(){return 1E3};return a}(),g;(function(a){a[a.Created=0]="Created";a[a.Initialized=1]="Initialized";a[a.Started=2]="Started"})(g||(g={}));var t=function(){function c(){this._MaxPackageSizeInBytes=q.MaxPackageSizeInBytes();this._listeners=[];this._status=g.Created;this._testServerResponseHook=this._etag=null;this._isPaused=!1}c.prototype.Initialize=function(a){if(this._status!=g.Created)throw new e(d.DATARV_ERROR_INVALID_STATUS);
if(!a||!a.collectorUrl)throw new e(d.DATARV_ERROR_INVALID_CONFIG);this._config=a;this._Reset();this._status=g.Initialized;this._Verbose("Initialize() done")};c.prototype.AddListener=function(a){if(this._status<g.Initialized)throw new e(d.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",a].join(""));for(var b=0;b<this._listeners.length;++b)if(this._listeners[b]==a){this._Verbose("the listener has been added already, index: "+
b);return}this._listeners.push(a);this._Verbose("AddListener() done, the new length: "+this._listeners.length)};c.prototype.RemoveListener=function(a){if(this._status<g.Initialized)throw new e(d.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",a].join(""));for(var b=0;b<this._listeners.length;++b)if(this._listeners[b]==a){1==this._listeners.length?this._listeners=[]:b==this._listeners.length-1?this._listeners.pop():
this._listeners[b]=this._listeners.pop();this._Verbose(["this listener has been found, index: ",b,"new length: ",this._listeners.length].join(""));return}this._Verbose("listener isn't been found, new length"+this._listeners.length)};c.prototype.Start=function(){if(this._status<g.Initialized)throw new e(d.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",c._tag].join(" "));this._status>=g.Started&&this._Verbose("Start() already, ignore");++c._tag;this._status=g.Started;
this._Verbose(["Start() done, status: ",this._status,"tag: ",c._tag].join(""))};c.prototype.Stop=function(){if(this._status<g.Initialized)throw new e(d.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status);this._status==g.Initialized?this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=g.Initialized,this._Verbose("Stop() done, status: "+this._status))};c.prototype.Pause=function(){this._isPaused=!0;this._CleanTimer()};c.prototype.Resume=function(){this._isPaused=
!1;this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)};c.prototype.Flush=function(a){this._eventsCache.IsEmpty()||this._WorkThread(a,!0)};c.prototype.SendAsync=function(a,b){if(this._status<g.Initialized)throw new e(d.DATARV_ERROR_INVALID_STATUS);this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",a,"count:",b.length].join(" "));if(this._status<g.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!a||!b)throw this._Error("SendAsync(), tenantToken or events is null or empty"),
new e(d.DATARV_ERROR_INVALID_ARG);for(var p=0;p<b.length;++p)if(!b[p].Id||!c._eventTypeRegex.test(b[p].EventType)||b[p].Timestamp.Equals("0"))throw this._Error(["eventId:",b[p].Id,"eventType:",b[p].EventType,"timestamp high:",b[p].Timestamp.high,"timestamp low:",b[p].Timestamp.low].join("")),new e(d.DATARV_ERROR_INVALID_EVENT);this._eventsCache.AddEvents(a,b);this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" "));this._eventsCache.IsEmpty()||
this._timer||this._ScheduleTimer(!1);this._Verbose("SendAsync() done");return!0};c.prototype._WorkThread=function(a,b){var p=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<g.Started)this._Verbose("_WorkThread, status is not started, return");else{var m=this._eventsCache.DequeuEvents();if(null==m)this._Verbose("_WorkThread, No events found, return"),this._CleanTimer();else{var e=this._PackEvents(m.tenantToken,m.events);this._eventsCache.AddEvents(m.tenantToken,e.remainedEvents);
if(null==e.buffer||0==e.buffer.length)this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1));else if(this._testServerResponseHook){var d=this._testServerResponseHook();setTimeout(this._SendCallback(h,m.tenantToken,e.sendEvents,d,!1,null),100)}else{var f={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary",
"client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+clienttelemetry_build.version},complete:function(c){return p._SendCallback(h,m.tenantToken,e.sendEvents,c,b,a)}};sct.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),f.data=new Uint8Array(e.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),f.data=Microsoft.Bond.Encoding.Base64.GetString(e.buffer),f.headers["content-encoding"]="base64");m.tenantToken&&(f.headers["x-apikey"]=
m.tenantToken);var h=c._tag;this._lastActiveTime=(new Date).getTime();sct.Utils.ajax(f,b);this._Verbose("_Workthread, send via jquery, tag: "+h)}}}}catch(l){this._Error("_WorkThread, exception: "+l)}};c.prototype._PackEvents=function(a,c){this._Verbose("_PackageEvents, total Count: "+c.length);var p=new b.datamodels.ClientToCollectorRequest,m=new b.datamodels.DataPackage;m.Source="JS_default_source";m.DataPackageId=b.datamodels.utils.GetGuid();m.Timestamp=b.datamodels.utils.GetTimeStamp();var e,d=
c;for(c=[];;){m.Records=[];m.Records.push.apply(m.Records,d);p.DataPackages=[];p.DataPackages.push(m);e=this._Serialize(p);this._Verbose(["_PackageEvents, sendEvents.length:",d.length,"buffer.length:",e.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join(""));if(e.length<this._MaxPackageSizeInBytes)break;else if(1==d.length){d=[];e=null;break}e=d.splice(0,Math.floor(d.length/2));this._Verbose("_PackageEvents, too large, package again");c.push.apply(c,d);d=e}this._Verbose(["_PakcageEvents done, sendEventsCount:",
d.length,"buffer.length:",null==e?0:e.length,"remained events:",c.length].join(""));return{buffer:e,sendEvents:d,remainedEvents:c}};c.prototype._Serialize=function(a){var b=new Microsoft.Bond.IO.MemoryStream,p=new Microsoft.Bond.CompactBinaryProtocolWriter(b);a.Write(p);return b.GetBuffer()};c.prototype._SendCallback=function(b,e,p,m,d,v){this._Verbose(["_SendCallbacktag:",b,"current tag:",c._tag,"tenantToken:",e,"events count:",p.length,"jqXHR:",m].join(""));v&&v(m?m.status:0,e,p);if(!d)if(d=m&&
"undefined"!==typeof m.status&&200===m.status,this._status<g.Started||b<c._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else if(!d&&(m&&"undefined"!==typeof m.status&&501!==m.status&&505!==m.status&&(300>m.status||500<=m.status||408===m.status)||!m||"undefined"===typeof m.status))this._Verbose("retry statusCode: "+(m?m.status:0)),this._eventsCache.AddEvents(e,p),this._ScheduleTimer(!0);else{for(b=0;b<this._listeners.length;++b)this._listeners[b](d?a.SENT:a.SEND_FAILED,
m?m.status:0,e,p);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}};c.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer);this._timer&&(clearTimeout(this._timer),this._timer=null)};c.prototype._ScheduleTimer=function(a){var b=this;this._isPaused||(this._Verbose("_ScheduleTimer: isRetry: "+a),this._CleanTimer(),a?(this._Verbose("_ScheduleTimer, current factor: "+
this._rescheduleFactor),a=Math.floor(5*this._rescheduleFactor*(1+Math.random())),this._timer=setTimeout(function(){return b._WorkThread(null,!1)},1E3*a),this._Verbose("_ScheduleTimer, next try (s): "+a),this._rescheduleFactor<<=1,64<this._rescheduleFactor&&(this._rescheduleFactor=1)):(a=0,a=(new Date).getTime()-this._lastActiveTime,a=a>q.TimeIntervalForNextSendInMS()?0:q.TimeIntervalForNextSendInMS()-a,this._timer=setTimeout(function(){return b._WorkThread(null,!1)},a),this._Verbose("_ScheduleTimer, next try: "+
a),this._rescheduleFactor=1))};c.prototype._Verbose=function(a){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+a)};c.prototype._Info=function(a){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+a)};c.prototype._Error=function(a){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+a)};c.prototype._Reset=function(){this._Verbose("Reset()");this._CleanTimer();this._lastActiveTime=0;this._rescheduleFactor=1;this._sendingEvents=[];this._eventsCache=
new h};c.prototype.__GetListenerArray=function(){return this._listeners};c.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()};c.prototype.__IsScheduled=function(){return null!=this._timer};c.prototype.__ChageMaxPackageSizeInKB=function(a){this._MaxPackageSizeInBytes=1024*a};c.prototype.__SetTestServerResponseHook=function(a){this._testServerResponseHook=a};return c}();t._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/;t._tag=0;var h=function(){function a(){this._events=
{};this._tokens=[]}a.prototype.AddEvents=function(a,b){b.length&&(this._events[a]||(this._events[a]=[],this._tokens.push(a)),this._events[a].push.apply(this._events[a],b))};a.prototype.IsEmpty=function(){return 0==this._tokens.length};a.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var a=this._tokens.shift(),b=this._events[a];delete this._events[a];return{tenantToken:a,events:b}};a.prototype.GetTotalEventsCount=function(){var a=0,b;for(b in this._events)a+=this._events[b].length;
return a};return a}()})(b._sender||(b._sender={}))})(d.telemetry||(d.telemetry={}))})(f.applications||(f.applications={}))})(microsoft||(microsoft={}));
(function(f){(function(d){(function(b){var c=b._sender.TelemetryManagerFactory.CreateTelemetryManager(),a=function(){return function(){this.collectorUrl=null;this.enableAutoUserSession=!1;this.browserOverrides=null;this.disableCookies=!1}}();a.COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/";a.COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/";a.COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/";a.COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/";
a.COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/";b.LogConfiguration=a;var d=function(){return function(){this.onGetData=this.onSaveData=null}}();b.LogConfigurationBrowserOverrides=d;var e=function(){function a(){this.pii=this.value=null}a._isPii=function(a){return null===a||void 0===a||a===b.datamodels.PIIKind.NotSet||isNaN(a)?!1:void 0!==b.datamodels.PIIKind[a]};return a}(),r=function(){function a(){this.timestamp=this.name=null;this.properties={};this.eventType=null}a.prototype.setProperty=
function(c,e,d){if(!c||!a._propertyNameRegex.test(c))throw new g(q.INVALID_PROPERTY_NAME);this.properties[c]=d?{value:e,pii:d!=b.datamodels.PIIKind.NotSet?d:null}:{value:e,pii:null}};return a}();r._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/;b.EventProperties=r;var q;(function(a){a[a.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN";a[a.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME";a[a.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME";a[a.MISSING_FAILURE_SIGNATURE=
5]="MISSING_FAILURE_SIGNATURE";a[a.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL";a[a.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID";a[a.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME";a[a.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE";a[a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET"})(q=b.TelemetryError||(b.TelemetryError={}));var g=function(){function a(b){this.errorCode=null;this.errorCode=b}a.prototype.ErrorCode=function(){return this.errorCode};
a.prototype.toString=function(){switch(this.errorCode){case q.INVALID_TENANT_TOKEN:return"Invalid tenant token";case q.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case q.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case q.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case q.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";
case q.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case q.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case q.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case q.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error"}};
return a}();b.Exception=g;var t=function(){function a(p){this.contextMap={};this.piiKind=b.datamodels.PIIKind.NotSet;this._allowDeviceInfoFields=!1;this._allowDeviceInfoFields=p}a.prototype.setAppId=function(a){a&&(this.contextMap["AppInfo.Id"]=a)};a.prototype.setAppVersion=function(a){a&&(this.contextMap["AppInfo.Version"]=a)};a.prototype.setAppLanguage=function(a){a&&(this.contextMap["AppInfo.Language"]=a)};a.prototype.setDeviceId=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=
a,h.checkAndUpdateDeviceId(a))};a.prototype.setDeviceOsName=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=a)};a.prototype.setDeviceOsVersion=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=a)};a.prototype.setDeviceBrowserName=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=a)};a.prototype.setDeviceBrowserVersion=function(a){a&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=
a)};a.prototype.setUserId=function(a,b,p){a&&(this.contextMap["UserInfo.Id"]=a);if(p)this.contextMap["UserInfo.IdType"]=p;else{switch(b){case f.applications.telemetry.datamodels.PIIKind.SipAddress:a=f.applications.telemetry.datamodels.UserIdType.SipAddress;break;case f.applications.telemetry.datamodels.PIIKind.PhoneNumber:a=f.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case f.applications.telemetry.datamodels.PIIKind.SmtpAddress:a=f.applications.telemetry.datamodels.UserIdType.EmailAddress;
break;default:a=f.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=a}if(!b)switch(p){case f.applications.telemetry.datamodels.UserIdType.Skype:b=f.applications.telemetry.datamodels.PIIKind.Identity;break;case f.applications.telemetry.datamodels.UserIdType.EmailAddress:b=f.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case f.applications.telemetry.datamodels.UserIdType.PhoneNumber:b=f.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case f.applications.telemetry.datamodels.UserIdType.SipAddress:b=
f.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:b=f.applications.telemetry.datamodels.PIIKind.NotSet}e._isPii(b)&&(this.piiKind=b)};a.prototype.setUserMsaId=function(a){a&&(this.contextMap["UserInfo.MsaId"]=a)};a.prototype.setUserANID=function(a){a&&(this.contextMap["UserInfo.ANID"]=a)};a.prototype.setUserAdvertisingId=function(a){a&&(this.contextMap["UserInfo.AdvertisingId"]=a)};a.prototype.setUserTimeZone=function(a){a&&(this.contextMap["UserInfo.TimeZone"]=a)};a.prototype.setUserLanguage=
function(a){a&&(this.contextMap["UserInfo.Language"]=a)};return a}();b.SemanticContext=t;var h=function(){function a(){}a.initialize=function(c,e){this._overrides=c;this._disableCookies=e;var d=a._getAppLanguage();d&&a.semanticContext.setAppLanguage(d);(d=a._getUserLanguage())&&a.semanticContext.setUserLanguage(d);var f=(new Date).getTimezoneOffset(),d=f%60,f=(f-d)/60,g="+";0<f&&(g="-");a.semanticContext.setUserTimeZone(g+(10>f?"0"+f:f.toString())+":"+(10>d?"0"+d:d.toString()));a._getUserAgent()&&
(a.semanticContext.setDeviceBrowserName(a._getBrowserName()),a.semanticContext.setDeviceBrowserVersion(a._getBrowserVersion()),a.semanticContext.setDeviceOsName(a._getOsName()),a.semanticContext.setDeviceOsVersion(a._getOsVersion()));this._disableCookies&&!this._overrides?(a._deleteCookie(a.DEVICE_ID_COOKIE),a._deleteCookie(a.FIRST_LAUNCH_TIME_COOKIE)):((d=a._getData(a.DEVICE_ID_COOKIE))&&""!=d||(d=b.datamodels.utils.GetGuid()),a.semanticContext.setDeviceId(d))};a.checkAndUpdateDeviceId=function(b){var c=
a._getData(a.DEVICE_ID_COOKIE),d=a._getData(a.FIRST_LAUNCH_TIME_COOKIE);c!==b&&(d=(new Date).getTime().toString());a.firstLaunchTime=parseInt(d);a._saveData(a.DEVICE_ID_COOKIE,b);a._saveData(a.FIRST_LAUNCH_TIME_COOKIE,d)};a._saveData=function(b,c){if(this._overrides)this._overrides.onSaveData(b,c);else if("undefined"!==typeof document&&"undefined"!==typeof document.cookie&&!a._disableCookies){var d=new Date;d.setTime(d.getTime()+31536E6);d="expires="+d.toUTCString();document.cookie=b+"="+c+"; "+d}};
a._getData=function(b){if(this._overrides)return this._overrides.onGetData(b)||"";if("undefined"!==typeof document&&"undefined"!==typeof document.cookie&&!a._disableCookies){b+="=";for(var c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d],f=0;" "==e.charAt(f);)f++;e=e.substring(f);if(0==e.indexOf(b))return e.substring(b.length,e.length)}}return""};a._getUserAgent=function(){return"undefined"!==typeof navigator?navigator.userAgent||"":""};a._getAppLanguage=function(){return"undefined"!==
typeof document&&document.documentElement?document.documentElement.lang:null};a._getUserLanguage=function(){return"undefined"!==typeof navigator?navigator.userLanguage||navigator.language:null};a._userAgentContainsString=function(b){return-1<a._getUserAgent().indexOf(b)};a._isIe=function(){return a._userAgentContainsString("Trident")};a._isEdge=function(){return a._userAgentContainsString(a.BROWSERS.EDGE)};a._isOpera=function(){return a._userAgentContainsString("OPR/")};a._getBrowserName=function(){return a._isOpera()?
a.BROWSERS.UNKNOWN:a._userAgentContainsString(a.BROWSERS.PHANTOMJS)?a.BROWSERS.PHANTOMJS:a._isIe()?a.BROWSERS.MSIE:a._isEdge()?a.BROWSERS.EDGE:a._userAgentContainsString(a.BROWSERS.ELECTRON)?a.BROWSERS.ELECTRON:a._userAgentContainsString(a.BROWSERS.CHROME)?a.BROWSERS.CHROME:a._userAgentContainsString(a.BROWSERS.FIREFOX)?a.BROWSERS.FIREFOX:a._userAgentContainsString(a.BROWSERS.SAFARI)?a.BROWSERS.SAFARI:a._userAgentContainsString(a.BROWSERS.SKYPE_SHELL)?a.BROWSERS.SKYPE_SHELL:a.BROWSERS.UNKNOWN};a._getBrowserVersion=
function(){function b(){var c;c=a._getUserAgent();var d=c.match(new RegExp(a.BROWSERS.MSIE+" "+a.REGEX_VERSION));if(d)return d[1];if(c=c.match(new RegExp("rv:"+a.REGEX_VERSION)))return c[1]}function c(b){b===a.BROWSERS.SAFARI&&(b="Version");return(b=a._getUserAgent().match(new RegExp(b+"/"+a.REGEX_VERSION)))?b[1]:a.UNKNOWN_VERSION}return a._isIe()?b():c(a._getBrowserName())};a._getOsName=function(){return a._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?a.OPERATING_SYSTEMS.WINDOWS_PHONE:a._getUserAgent().match(/ arm;/i)?
a.OPERATING_SYSTEMS.WINDOWS_RT:a._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?a.OPERATING_SYSTEMS.IOS:a._getUserAgent().match(/android/i)?a.OPERATING_SYSTEMS.ANDROID:a._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?a.OPERATING_SYSTEMS.LINUX:a._getUserAgent().match(/(macintosh|mac os x)/i)?a.OPERATING_SYSTEMS.MACOSX:a._getUserAgent().match(/(windows|win32)/i)?a.OPERATING_SYSTEMS.WINDOWS:
a.OPERATING_SYSTEMS.UNKNOWN};a._getOsVersion=function(){function b(){var c=a._getUserAgent().match(new RegExp("Windows NT "+a.REGEX_VERSION));return c&&a.VERSION_MAPPINGS[c[1]]?a.VERSION_MAPPINGS[c[1]]:a.UNKNOWN_VERSION}function c(){var b=a._getUserAgent().match(new RegExp(a.OPERATING_SYSTEMS.MACOSX+" "+a.REGEX_VERSION_MAC));if(b){var b=b[1].replace(/_/g,"."),d=[];if(b)return d=-1<b.indexOf(".")?".":-1<b.indexOf("_")?"_":null,d?(d=b.split(d),d[0]):b}return a.UNKNOWN_VERSION}return a._getOsName()===
a.OPERATING_SYSTEMS.WINDOWS?b():a._getOsName()===a.OPERATING_SYSTEMS.MACOSX?c():a.UNKNOWN_VERSION};return a}();h.semanticContext=new t(!0);h.firstLaunchTime=-1;h.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"};h.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"};
h.VERSION_MAPPINGS={"5.1":"XP","6.0":"Vista","6.1":"7","6.2":"8","6.3":"8.1","10.0":"10"};h.REGEX_VERSION="([\\d,.]+)";h.REGEX_VERSION_MAC="([\\d,_,.]+)";h.UNKNOWN_VERSION="Unknown";h.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId";h.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime";h._deleteCookie=function(a){"undefined"!==typeof document&&"undefined"!==typeof document.cookie&&(document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")};h._disableCookies=!1;var n;
(function(a){a[a.STARTED=0]="STARTED";a[a.ENDED=1]="ENDED"})(n=b.SessionState||(b.SessionState={}));var k=function(){function a(){}a.initialize=function(b,e){if(!a._initialized){if(!b)throw new g(q.INVALID_TENANT_TOKEN);a._defaultToken=b;a._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/";a._configuration=e;if(!("undefined"!==typeof window||e&&e.browserOverrides&&e.browserOverrides.onGetData))throw new g(q.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var f=null;if(e)if(e.collectorUrl&&
(a._tmConfig.collectorUrl=e.collectorUrl),e.browserOverrides){f=new d;if(e.browserOverrides.onGetData?!e.browserOverrides.onSaveData:e.browserOverrides.onSaveData)throw new g(q.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);f.onGetData=e.browserOverrides.onGetData;f.onSaveData=e.browserOverrides.onSaveData}else e.disableCookies&&(a._sessionEnabled=!1);c.Initialize(a._tmConfig);c.Start();h.initialize(f,e.disableCookies);a._initialized=!0;"undefined"!==typeof window&&window.addEventListener&&(e&&e.enableAutoUserSession&&
(a._logger=new u,a._logger.logSession(n.STARTED)),window.addEventListener("beforeunload",a._teardown))}};a.pauseTransmission=function(){c.Pause()};a.resumeTransmission=function(){c.Resume()};a.flush=function(a){c.Flush(a)};a.addCallbackListener=function(b){a._initialized&&c.AddListener(b)};a.setContext=function(b,c,d){a._contextProperties.setProperty(b,c,d)};a.isInitialized=function(){return a._initialized};a.getDefaultToken=function(){return a._defaultToken};a.getSemanticContext=function(){return a._semanticContext};
a._getInitIdForToken=function(c){a._initIdMap[c]||(a._initIdMap[c]=b.datamodels.utils.GetGuid());return a._initIdMap[c]};a._getSequenceForToken=function(b){a._sequenceMap[b]||(a._sequenceMap[b]=0);a._sequenceMap[b]++;return a._sequenceMap[b]};a._teardown=function(){a._logger&&a._logger.logSession(n.ENDED);a.flush()};a.__backToUninitialized=function(){a._tmConfig=new b._sender.TelemetryConfig;a._semanticContext=new t(!0);a._contextProperties=new r;a._configuration=null;c=b._sender.TelemetryManagerFactory.CreateTelemetryManager();
a._initialized=!1;a._initIdMap={};a._sequenceMap={}};return a}();k._initialized=!1;k._defaultToken=null;k._tmConfig=new b._sender.TelemetryConfig;k._logger=null;k._initIdMap={};k._sequenceMap={};k._configuration=null;k._contextProperties=new r;k._semanticContext=new t(!0);k._sessionEnabled=!0;b.LogManager=k;var u=function(){function a(b){this._tenantToken=this._initId=null;this._contextProperties=new r;this._semanticContext=new t(!1);this._sessionStartTime=0;this._sessionId=null;this._tenantToken=
b?b:k.getDefaultToken();this._initId=k._getInitIdForToken(this._tenantToken)}a.prototype.logEvent=function(a){if(!a.name)throw new g(q.MISSING_EVENT_PROPERTIES_NAME);var b=this._createEventRecord(a.name,a.eventType);this._addPropertiesAndSendEvent(b,a)};a.prototype.logFailure=function(a,b,c,d,e){if(!a)throw new g(q.MISSING_FAILURE_SIGNATURE);if(!b)throw new g(q.MISSING_FAILURE_DETAIL);var f=this._createEventRecord("failure","failure");f.Extension.Add("Failure.Signature",a);f.Extension.Add("Failure.Detail",
b);c&&f.Extension.Add("Failure.Category",c);d&&f.Extension.Add("Failure.Id",d);this._addPropertiesAndSendEvent(f,e)};a.prototype.logPageView=function(a,b,c,d,e,f){if(!a)throw new g(q.MISSING_PAGEVIEW_ID);if(!b)throw new g(q.MISSING_PAGEVIEW_NAME);var h=this._createEventRecord("pageview","pageview");h.Extension.Add("PageView.Id",a);h.Extension.Add("PageView.Name",b);c&&h.Extension.Add("PageView.Category",c);d&&h.Extension.Add("PageView.Uri",d);e&&h.Extension.Add("PageView.ReferrerUri",e);this._addPropertiesAndSendEvent(h,
f)};a.prototype.logSession=function(a,c){if(k._sessionEnabled){if(a!==n.STARTED&&a!==n.ENDED)throw new g(q.INVALID_SESSION_STATE);var d=this._createEventRecord("session","session");if(a===n.STARTED){if(0<this._sessionStartTime)return;this._sessionStartTime=(new Date).getTime();this._sessionId=b.datamodels.utils.GetGuid();d.Extension.Add("Session.Id",this._sessionId);d.Extension.Add("Session.State","Started")}else if(a===n.ENDED){if(0==this._sessionStartTime)return;var e=Math.floor(((new Date).getTime()-
this._sessionStartTime)/1E3);d.Extension.Add("Session.Duration",e.toString());d.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(e));d.Extension.Add("Session.Id",this._sessionId);d.Extension.Add("Session.State","Ended");this._sessionId=null;this._sessionStartTime=0}d.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(h.firstLaunchTime)));this._addPropertiesAndSendEvent(d,c)}};a.prototype.getSessionId=function(){return this._sessionId};a.prototype.setContext=
function(a,b,c){this._contextProperties.setProperty(a,b,c)};a.prototype.getSemanticContext=function(){return this._semanticContext};a.prototype._getSessionDurationFromTime=function(a){return 0>a?"Undefined":3>=a?"UpTo3Sec":10>=a?"UpTo10Sec":30>=a?"UpTo30Sec":60>=a?"UpTo60Sec":180>=a?"UpTo3Min":600>=a?"UpTo10Min":1800>=a?"UpTo30Min":"Above30Min"};a.prototype._createEventRecord=function(a,c){var d=new b.datamodels.Record;c||(c="custom");d.EventType=a.toLowerCase();d.Type=c.toLowerCase();d.Extension.Add("EventInfo.Source",
"JS_default_source");d.Extension.Add("EventInfo.InitId",this._initId);d.Extension.Add("EventInfo.Sequence",k._getSequenceForToken(this._tenantToken).toString());d.Extension.Add("EventInfo.Name",a.toLowerCase());var e=new Date;d.Timestamp=b.datamodels.utils.GetTimeStampWithValue(e.getTime());d.Extension.Add("EventInfo.Time",this._getISOString(e));d.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+clienttelemetry_build.version);return d};a.prototype._getISOString=function(a){function b(a){return 10>
a?"0"+a:a.toString()}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"."+function(a){return 10>a?"00"+a:100>a?"0"+a:a.toString()}(a.getUTCMilliseconds())+"Z"};a.prototype._addCustomPropertiesToEvent=function(a,b){this._addSemanticContext(a,h.semanticContext);this._addSemanticContext(a,k._semanticContext);this._addSemanticContext(a,this._semanticContext);this._sessionId&&a.Extension.Add("Session.Id",this._sessionId);
this._addEventPropertiesToEvent(a,k._contextProperties);this._addEventPropertiesToEvent(a,this._contextProperties);this._addEventPropertiesToEvent(a,b)};a.prototype._addSemanticContext=function(a,c){if(c&&c.contextMap){var d=c.contextMap,e;for(e in c.contextMap)"UserInfo.Id"==e&&c.piiKind!=b.datamodels.PIIKind.NotSet?a.AddOrReplacePII(e,d[e],c.piiKind):a.Extension.AddOrReplace(e,d[e])}};a.prototype._addEventPropertiesToEvent=function(a,c){if(c){c.timestamp&&c.timestamp>=(new Date("1/1/2000")).getTime()&&
(a.Timestamp=b.datamodels.utils.GetTimeStampWithValue(c.timestamp),a.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(c.timestamp))));c.name&&(a.EventType=c.name.toLowerCase(),a.Extension.AddOrReplace("EventInfo.Name",c.name.toLowerCase()));var d=c.properties;if(d)for(var f in d)f&&(d[f].value||!1===d[f].value||0==d[f].value||""==d[f].value)&&(e._isPii(d[f].pii)?(a.AddOrReplacePII(f,d[f].value.toString(),d[f].pii),a.Extension.Remove(f)):(a.Extension.AddOrReplace(f,d[f].value.toString()),
a.PIIExtensions.Remove(f)))}};a.prototype._addPropertiesAndSendEvent=function(a,b){this._addCustomPropertiesToEvent(a,b);k.isInitialized()&&(this._sanitizeName(a),c.SendAsync(this._tenantToken,[a]))};a.prototype._sanitizeName=function(a){var b=a.EventType.replace(/\./g,"_");a.EventType=b;a.Extension.AddOrReplace("EventInfo.Name",b)};return a}();b.Logger=u})(d.telemetry||(d.telemetry={}))})(f.applications||(f.applications={}))})(microsoft||(microsoft={}));
"undefined"!=typeof module&&(module.exports=microsoft.applications.telemetry);; return microsoft.applications.telemetry;})();
