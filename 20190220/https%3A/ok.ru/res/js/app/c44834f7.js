define(function(){var a;var c=".jpg";var b=".webp";function f(g){this.element=g;this.promo=this.element.getAttribute("data-promo");this.useWebP=this.element.getAttribute("data-use-webp")==="true";this.staticPath=this.element.getAttribute("data-static");this.basePath=this.staticPath+"res/i/anonym/"+this.promo+"/image";this.rootHtmlNode=document.documentElement;this.extension=c;this.promoButton=this.element.querySelector(".prl_adv_a");this.linkPixel=this.element.getAttribute("data-link-pixel");this.hasLinkPixel=this.promoButton&&this.linkPixel&&this.linkPixel.length!==0&&this.linkPixel!=="null";}f.prototype={init:function(){if(this.promo!=="default"){if(this.useWebP&&(this.rootHtmlNode.classList.contains("chrome")||this.rootHtmlNode.classList.contains("mac-chrome"))){this.extension=b;}}if(this.hasLinkPixel){this._linkPixelHandler=this.linkPixelHandler.bind(this);this.promoButton.addEventListener("click",this._linkPixelHandler);}return this;},destroy:function(){if(this.hasLinkPixel){this.promoButton.removeEventListener("click",this._linkPixelHandler);}},setImage:function(){this.element.style.backgroundImage="url("+this.getSrc()+")";return this;},getSrc:function(){return this.basePath+this.extension;},loadImage:function(){var g=new Image();g.onload=function(){this.setImage();this.element.classList.add("__show");}.bind(this);g.onerror=function(){if(this.extension===b){this.extension=c;g.src=this.getSrc();}}.bind(this);g.src=this.getSrc();},linkPixelHandler:function(){var g=new Image();g.src=this.linkPixel+new Date().getTime();}};function d(g){a=new f(g).init();return a.loadImage();}function e(){a.destroy();}return{activate:d,deactivate:e};});