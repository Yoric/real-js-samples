define(["OK/logger"],function(s){var t=document,n,e,h="h-mod",r="href",a="data-module",j="data-activate",i="activate",g=/(\?|\&)cmd=([^\&]+)/,c="OK/",m=null,b=[],l=function(u){var x,v,w;if(u.id&&u.id.indexOf("hook_")===0){v=u.id.substr(5);w=v.substr(0,v.indexOf("_"));if(w!=="Block"){s.success("capture.gwt",w,n);}}x=u.firstChild;while(x){l(x);x=x.nextSibling;}},p=function(y){var w,u,v;try{w=Array.prototype.slice.call(y);}catch(x){v=y.length;if(v>0){w=new Array(v);for(u=0;u<v;u+=1){w[u]=y[u];}}else{w=[];}}return w;},q=function(v){var u=v.match(g);if(u){return u[2];}},k=function(u){var w=u.getAttribute(j)||i;return function v(y){var x;if(typeof y==="function"){x=new y(u.id);}else{x=y;}x[w](u);b.push(x);};},d=function(w,u){var x,v;if(m!==null&&m.indexOf(u)===-1){return;}u=c+u;x=k(w);if(require.defined(u)){v=require(u);x(v);}else{require([u],x);}},f=function(B){var C,E,u,y,D,z,x,v,A;B=B||t;C=B.getElementsByClassName(h);u=p(C);y=u.length;for(D=0;D<y;D+=1){x=u[D];v=x.getAttribute(a);if(v){d(x,v);}}if(e){E=B.getElementsByTagName("a");u=p(E);y=u.length;for(D=0;D<y;D+=1){x=u[D];A=x.getAttribute(r);if(A){var w=q(A);if(w){v=e[w];if(v){d(x,v);}}}}}if(n){l(B);}},o=function(u){if(t.readyState==="interactive"||t.readyState==="complete"){f(u);}else{t.addEventListener("DOMContentLoaded",f);}};return{setWhiteList:function(u){m=u;},activate:o,activateDocument:function(w,A){if(w&&w.length){e={};var v,u,z,y,x;for(v=0;v<w.length;v+=1){u=w[v];z=u.split(":");y=z[0];if(z.length===1){x=z[0];}else{x=z[1];}e[y]=x;}}n=A;o();}};});