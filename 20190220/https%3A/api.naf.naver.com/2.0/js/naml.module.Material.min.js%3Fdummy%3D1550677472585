naml.createNamespace("naml.module").Material=najindo.$Class({$init:function(){},init:function(a){this._initVar(a),this._createComponent(),this._analysisMapData()},_initVar:function(a){this._sEnvType=a.envType,this._oAdditionalList=null,this._oDataUpdator=null,this._htAdditionalData=null,this._htLiveUpdateData=null,this._vListEl=null},_createComponent:function(){var a=this;this._oAdditionalList=new naml.module.MaterialAdditionalList({type:this._sEnvType}),this._oDataUpdator=new naml.module.MaterialDataUpdator({type:this._sEnvType,selector:".__live_contents_"}),this._oDataUpdator.attach("updateInfo",function(b){a._updateMapData(b.htData),a.updateInfo()})},run:function(a){this.option({elAdditionalList:"end_of_naml_document"}),this.option(a),this._vListEl=this.option("elAdditionalList"),null!==this._htLiveUpdateData&&this._oDataUpdator.updateData(),this._makeAdiitionalList()},updateInfo:function(){this._oDataUpdator.updateMaterialContents(),this._makeAdiitionalList(),this.fireEvent("updateMaterialInfo",{})},_makeAdiitionalList:function(){null!==this._htAdditionalData&&this._oAdditionalList.generateList(this._vListEl)},updateData:function(){this._oDataUpdator.updateData()},_analysisMapData:function(){var a,b,c;for(var e in NAML_MATERIAL_MAP){a=NAML_MATERIAL_MAP[e],b=[],c=[];for(var f in a)a[f].useAdditionalList&&b.push(a[f]),a[f].liveContents&&c.push(this._getTypeId(e,a[f]));b.length>0&&(this._htAdditionalData=null!==this._htAdditionalData?this._htAdditionalData:{},b=b.reverse(),this._htAdditionalData[e]=b),c.length>0&&(this._htLiveUpdateData=null!==this._htLiveUpdateData?this._htLiveUpdateData:{},this._htLiveUpdateData[e]=c)}this._oAdditionalList.setData(this._htAdditionalData),this._oDataUpdator.setData(this._htLiveUpdateData)},_updateMapData:function(a){var b;for(var c in a){b=a[c];for(var d in b){var e=NAML_MATERIAL_MAP[c][d],f=b[d];for(var g in f)e[g]=f[g];NAML_MATERIAL_MAP[c][d]=e}}this._analysisMapData()},_getTypeId:function(a,b){var c="";switch(a){case"book":c=b.bid;break;case"movie":c=b.movieCode;break;case"music":c=b.albumId}return c}}).extend(najindo.Component||najindo.m.Component),naml.createNamespace("naml.m.module").Material=naml.module.Material;