naml.createNamespace("naml.module").MaterialDataUpdator=najindo.$Class({$init:function(t){this.option(t||{}),this._initVar()},_initVar:function(){this._sLiveContentsSelector=this.option("selector"),this._htParamData=null,this._sApiURL=naml.API_URL_HOST+"/material/getMaterialData.nhn",this._isUpdate=!1,this._htUpdateData=null},setData:function(t){this._htParamData=t},updateData:function(){this._requestMaterialInfo()},_requestMaterialInfo:function(){var t=this;naml.ajaxRequest(this._sApiURL,{sReqType:"jsonp",method:"get",fnSuccess:function(a){var e=a.json();"success"==e.result&&(t._htUpdateData=e.data,t._updateMapData(e.data))},fnError:function(){}},{reqData:this._getParamList()})},_getParamList:function(){var t,a=[],e=this._htParamData,i=0;for(var r in e){t=e[r],i>0&&a.push("|"),a.push(r),a.push("_");for(var n=0;n<t.length;n++)n>0&&a.push("-"),a.push(t[n]);i++}return a.join("")},_updateMapData:function(t){this.fireEvent("updateInfo",{htData:t})},updateMaterialContents:function(){var t=this._htUpdateData;if(null!==t)for(var a in t)this._updateContentsByType(a)},_updateContentsByType:function(t){for(var a=najindo.$$(this._sLiveContentsSelector+t),e=0;e<a.length;e++)this._upateViewInfo(t,a[e],this._getUpdateFunc(t))},_getUpdateFunc:function(t){function a(t){var a=t.split("https://dthumb-phinf.pstatic.net/?src=")[1];if(!a)return t;var e=a.split("&twidth=")[0];return e?e:t}return"book"==t?function(t,e,i){if(t&&"true"!=t.attr("data-update")){switch(e){case"author":t.html(i+" 저");break;case"translator":t.html(i+" 역");break;case"thumnailImage":var r=a(i);r&&r.indexOf("http://static.naver.net/book/image/noimg3.gif")>-1&&(r="https://ssl.pstatic.net/static/ncc/image/no_image.PNG"),t.attr("src",t.attr("src").replace(a(t.attr("src")),r));break;case"title":"A"!==t.$value().nodeName&&(t=t.query("a")),t.html(i);break;case"publishDate":t.html(i);break;default:t.html(i)}t.attr("data-update","true")}}:"movie"==t?function(t,a,e,i){t&&"true"!=t.attr("data-update")&&("point"==a?t.html(e):"pointPercent"==a?t.css("width",e+"%"):"actualPoint"==a?t.html(e):"actualPointPercent"==a?t.css("width",e+"%"):"expertPoint"==a?t.html(e):"expertPointPercent"==a?t.css("width",e+"%"):"reservationAble"==a?1==e?(t.show("inline-block"),t.attr("href",i.reservationUrl)):t.hide():"downloadAble"==a?1==e?(t.show("inline-block"),t.attr("href",i.downloadUrl)):t.hide():"publishDate"==a?t.html(e):"runtime"==a&&(0==e?t.parent().hide():(t.html(e),t.parent().show())),t.attr("data-update","true"))}:"music"==t?function(t,e,i){var r=najindo.$Template("{for index:artist in artistList}{if index>0}, {/if}{if artist.artistId>0}<a href='http://music.naver.com/artist/home.nhn?artistId={=artist.artistId}' target=\"_blank'\" onclick=\"naml.nclicks(this, 'lnk.msart', '', '', event)\">{/if}{=artist.artistName}{if artist.artistId>0}</a>{/if}{/for}");t&&"true"!=t.attr("data-update")&&("albumTitle"==e?t.html(i):"releaseDate"==e?t.html(i):"albumListImg"==e?t.attr("src","https://dthumb-phinf.pstatic.net/?src="+i+"&twidth=95&theight=95&opts=10&qlt=80&sharpen=true"):"albumImg"==e?"mobile"==t.attr("data-device")?t.attr("src","https://dthumb-phinf.pstatic.net/?src="+i+"&twidth=121&theight=121&opts=10&qlt=80&sharpen=true"):t.attr("src",t.attr("src").replace(a(t.attr("src")),a(i))):"score"==e?t.html(i):"scorePercent"==e?t.css("width",i+"%"):"artistList"==e?t.html(r.process({artistList:i})):"firstArtist"==e?t.html(r.process({artistList:[i]})+(i.hasMoreArtist?" 외":"")):"releaseDate"==e&&t.html(i),t.attr("data-update","true"))}:function(){}},_upateViewInfo:function(t,a,e){var i,r,n=najindo.$Element(a);if(n){i=n.attr("data-id"),r=this._htUpdateData[t][i];for(var s in r)e(n.query(".__"+s),s,r[s],r)}}}).extend(najindo.Component||najindo.m.Component);