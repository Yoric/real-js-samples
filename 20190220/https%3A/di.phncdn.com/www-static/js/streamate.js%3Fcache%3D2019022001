function authConsent(e,t,n,a){if(!0===LIVE_LIVE.hasCamhubAccount)return!1;t="client"===e?!t:t,n||(n="");var o=document.getElementById("consentModal");if(t&&o){var c=new MG_Modal({content:o,className:"consentConfirmationContainer "+n});c.openModal();var r=$j("#consentModal").data("url");$j("#modalWrapMTubes.consentConfirmationContainer button").on("click",function(){$j(this).hasClass("yesBtn")?consent.consent=1:consent.consent=0,$j.ajax({type:"POST",url:r,data:consent}).done(function(e){c.closeModal()}).fail(function(e){c.closeModal()}).always(function(e){a&&a()})})}}function toggleClass(e,t){if(e&&t){var n=e.className,a=n.indexOf(t);-1==a?n+=" "+t:n=n.substr(0,a)+n.substr(a+t.length),e.className=n}}function getAllElementIds(e,t){var n=e.data("id");return t.push(n),t}function createPHLiveAccount(){$j.ajax({type:"POST",url:createAccountObj.url,data:$j("#signup_form").serialize(),success:function(e){location.assign(createAccountObj.redirect)},error:function(){return location.reload(),!1}})}function createPHLiveAccountuUserData(){var e=$j("#signup_form").serialize();$j.ajax({type:"POST",url:"/live/update_user_data_ajax",data:e,success:function(t){$j.ajax({type:"POST",url:"/front/authenticate",data:e,success:function(e){location.assign(createAccountObj.redirect)}})},error:function(){return location.reload(),!1}})}function isValidEmailAddress(e){return new RegExp(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/gim).test(e)}function login(e){$j.ajax({type:"POST",url:"/front/authenticate",dataType:"json",cache:!1,data:$j("#login_form").serialize(),success:function(t){"email"==e?$j.ajax({type:"POST",url:"/live/authenticate_streamate_user",dataType:"json",cache:!1,data:$j("#login_form").serialize()+"&success="+t.success+"&message="+t.message+"&premium_redirect_cookie="+t.premium_redirect_cookie+"&from="+LIVE_LOGIN.from,success:function(e){loginWithEmail(e,t)}}):loginWithUsername(t)},error:function(){return location.reload(),!1}})}function loginWithEmail(e,t){switch(e.success){case 0:$j("#errors").html(e.message).css({color:"red","margin-bottom":"10px"});break;case 1:case 2:loginWithUsername(t);break;case 3:$j("#errors").html("Signing in...").css({color:"green","margin-bottom":"10px"}),window.location.href="/live/create_account?userdata="+e.userdata+"&from="+LIVE_LOGIN.from+"&track="+LIVE_LOGIN.track;break;case 4:$j("#errors").html(e.message).css({color:"red","margin-bottom":"10px"})}}function loginWithUsername(e){"0"==e.premium_redirect_cookie?e.redirect?($j("#errors").html("Signing in...").css({color:"green","margin-bottom":"10px"}),location.assign(e.redirect),$j("#loginBtn").prop("disabled",!0)):$j("#errors").html(e.message).css({color:"red","margin-bottom":"10px"}):$j.ajax({url:premiumRedirectCookieURL,cache:!1,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(){e.redirect?($j("#errors").html(loginAccountObj.signingInText+"...").css({color:"green","margin-bottom":"10px"}),document.location.assign(e.redirect),$j("#loginBtn").prop("disabled",!0)):$j("#errors").html(e.message).css({color:"red","margin-bottom":"10px"})}})}function checkInputChange(){return Array.prototype.forEach.call(allInputTags,function(e,t){var n=document.getElementById(e.id);MG_Utils.addEventHandler(n,"change",function(){boolFlag=!0})}),boolFlag}function setIdleTimeout(e,t,n){function a(){r=setTimeout(o,e),$j(document).on("mousemove keypress",c)}function o(){r=0,t()}function c(){r?clearTimeout(r):n(),$j(document).off("mousemove keypress",c),setTimeout(a,1e3)}var r=0;$j(a)}var sideBox=document.querySelectorAll(".sideCatBox"),usernameField=document.getElementById("modal-username"),passwordField=document.getElementById("modal-password"),allInputTags=document.querySelectorAll(".js_getTag"),boolFlag=!0,createAccountDiv=$j(".streamate-createaccount-container"),loginAccountDiv=$j(".streamate-login-container"),createAccountObj="undefined"!=typeof WIDGET_CREATE_PORNHUBLIVE_ACCOUNT?WIDGET_CREATE_PORNHUBLIVE_ACCOUNT:"undefined"!=typeof LIVE_CREATE_ACCOUNT?LIVE_CREATE_ACCOUNT:"",loginAccountObj="undefined"!=typeof LIVE_LOGIN?LIVE_LOGIN:"",consent={consent:0};$j(document).ready(function(){function e(){var e=$j("#js-allowSharing");return 0===e.length||(e.length>0?!!e.is(":checked")||($j(".gdrpContainer").addClass("gdprContainerError"),$j("#errors").html("You must check the consent box first").addClass("gdprError"),!1):void 0)}"undefined"!=typeof LIVE_LIVE&&authConsent("page",LIVE_LIVE.showGdprConsent,"agree");var t=[],n=[],a=$j(".streamateContent li .streamateBlock");"undefined"!=typeof LIVE_LIVE&&LIVE_LIVE.checkIfObjExists&&(a.each(function(){n=getAllElementIds($j(this),t)}),setIdleTimeout(3e4,function(){return!1},function(){$j.ajax({type:"POST",url:"/live/ajax_update_streamate_status",data:{streamateIds:n},success:function(e){obj=e,obj.success&&a.each(function(){var e=$j(this),t=e.find(".bar").attr("class").split(" ")[2],n=e.find(".circle").attr("class").split(" ")[1];$j.each(obj.streamates,function(){this.id==e.data("id")&&(e.find("img").attr("src",this.picture_url),e.find(".bar").removeClass(t).addClass(this.bar),e.find(".circle").removeClass(n).addClass(this.circle),e.find(".getLabel").html(this.label))})})}})})),$j("#sideCatContainer").on("click",function(){toggleClass(sideBox[0],"display-none")}),$j("#js_freeAccountBtn").on("click",function(){if(LIVE_LIVE.checkLiu&&LIVE_LIVE.checkSakey)return!1;LIVE_LIVE.checkLiu?window.location.href="/live?t=1"+(void 0!==LIVE_LIVE.track?"&track="+LIVE_LIVE.track:""):window.location.href="/live/create_account?from="+LIVE_LIVE.from+(void 0!==LIVE_LIVE.track?"&track="+LIVE_LIVE.track:"")+"&s="+LIVE_LIVE.segment}),$j("#username").val()&&$j("#password").val()&&check_username_soon(),1===createAccountObj.checkUserData&&$j("#result_email").removeClass("empty").addClass("create_account_passed"),$j("#selectCountry").on("change",function(){"US"===$j(this).val()?$j("#zipCodeInputWrapper").removeClass("displayNone"):$j("#zipCodeInputWrapper").addClass("displayNone")}),$j("#submitNewAccount").on("click",function(t){if(t.preventDefault(),e()&&(checkEmpty("username"),checkEmpty("password"),createAccountObj.checkUserData||checkEmpty("email"),enable_submit()))if($j("#zipCodeInputWrapper").hasClass("displayNone"))$j(this).prop("disabled",!0),1===createAccountObj.checkUserData?createPHLiveAccountuUserData():createPHLiveAccount();else{var n=checkEmpty("zipcode");n&&($j(this).prop("disabled",!0),1===createAccountObj.checkUserData?createPHLiveAccountuUserData():createPHLiveAccount())}}),$j("#loginBtn").on("click",function(e){return e.preventDefault(),""!=usernameField.value&&""!=passwordField.value&&(!!checkInputChange()&&(login(isValidEmailAddress($j("#modal-username").val())?"email":"username"),void(boolFlag=!1)))}),$j("#js-allowSharing").change(function(){$j(this).is(":checked")?$j(this).val(1):$j(this).val(0)})}),$j(".streamate-page").keypress(function(e){(createAccountDiv.length||loginAccountDiv.length)&&13==e.which&&(e.preventDefault(),$j("#submitNewAccount").length?$j("#submitNewAccount").trigger("click"):$j("#loginBtn").trigger("click"))});