(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=false;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=false;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){
"use strict";
/**
 * Main entry point.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var Api = require("./src/Api/Api");
exports.Api = Api;
var FloodgateEngine_1 = require("./src/FloodgateEngine");
exports.FloodgateEngine = FloodgateEngine_1.FloodgateEngine;

},{"./src/Api/Api":5,"./src/FloodgateEngine":16}],2:[function(require,module,exports){
"use strict";
/**
 * Class to track ticks against a list of expected counts in a thread-safe way
 * Main API of interest is incrementActivity, which returns an enumerated value indicating
 * whether or not the increment resulted in no thresholds crossed, a single activity threshold crossed,
 * or the final activity threshold crossed.
 */
var ActivityTracker = /** @class */ (function () {
    function ActivityTracker(trackingSet) {
        if (!trackingSet) {
            throw new Error("trackingSet must not be null");
        }
        if (trackingSet.getList().length > 32) {
            throw new Error("trackingSet list size must be less than 32");
        }
        this.isOrdered = trackingSet.getIsOrdered();
        this.trackedActivities = trackingSet.getList();
        /**
         * For ordered sets, the current index.
         */
        this.currentIndex = 0;
        this.activationMask = 0;
        this.currentActivationFlags = 0;
        this.isActivationByInitPending = false;
        this.currentCounts = new Array(this.trackedActivities.length);
        this.currentStartTimes = new Array(this.trackedActivities.length);
        this.currentSessionCounts = new Array(this.trackedActivities.length);
        for (var i = 0; i < this.trackedActivities.length; i++) {
            this.currentCounts[i] = 0;
            this.currentSessionCounts[i] = 0;
        }
        for (var i = 0; i < this.trackedActivities.length; i++) {
            this.activationMask |= 0x1 << i;
            if (this.trackedActivities[i].getCount() < 1) {
                this.trackedActivities[i].setCount(1);
            }
        }
    }
    /**
     * Get the count for the activity at the specified index. Returns 0 for out-of-range indices
     *
     * @param index index
     */
    ActivityTracker.prototype.getCount = function (index) {
        if (!this.isValidIndex(index)) {
            return 0;
        }
        return this.currentCounts[index];
    };
    /**
     * Get the count for the activity at the specified index, as tracked only for this session.
     * Returns 0 for out-of-range indices
     *
     * @param index index
     */
    ActivityTracker.prototype.getSessionCount = function (index) {
        if (!this.isValidIndex(index)) {
            return 0;
        }
        return this.currentSessionCounts[index];
    };
    /**
     * Get the StartTime for the activity at the specified index. Returns null for out-of-range indices
     *
     * @param index index
     */
    ActivityTracker.prototype.getStartTime = function (index) {
        if (!this.isValidIndex(index)) {
            return null;
        }
        return this.currentStartTimes[index];
    };
    /**
     * A get-and-set method. Returns the current SessionCount, resetting it to zero and adding it into
     * the established baseline.
     *
     * @param index index
     */
    ActivityTracker.prototype.moveSessionCountIntoBaseCount = function (index) {
        if (!this.isValidIndex(index)) {
            return 0;
        }
        var sessionCount = this.currentSessionCounts[index];
        this.currentSessionCounts[index] = 0;
        return sessionCount;
    };
    /**
     * Forcibly set the counts for the activities in the trackingSet.
     * Unlike other APIs, this expects vector indices to match the order
     * of the ActivityTrackingSet.List initially used to construct this tracker.
     * (When data is copied from a different IndexedTracker, it will properly use the IndexedTracker.Index to query internals)
     * Note:
     * 1) Assumes a count of 0 for any missing index in undersized arrays.
     * 2) Respects and enforces ordered list initialization (i.e. all init values are ignored once a unfinished activity is
     * encountered in an ordered tracking list).
     * 3) If the tracker is fully Activated as a result of this call, the next call to IncrementActivity will raise the
     * IncrementEdgeResult.AllActivitiesActivated, for any valid index accepted by IsPermittedIndexForActivationByInit().
     */
    ActivityTracker.prototype.initCounts = function (baselineCounts, otherTrackers, wasAlreadyActivatedThisSession) {
        // NOTE: baselineIncrements and sessionIncrements are sorted the same as the initial trackedActivity set, which
        // for this class is the same as trackedActivities
        if (wasAlreadyActivatedThisSession === void 0) { wasAlreadyActivatedThisSession = false; }
        for (var i = 0; i < this.trackedActivities.length; i++) {
            // Only accept values up to the current index, when ordered
            if (this.isOrdered && i > this.currentIndex) {
                break;
            }
            // Start off by pulling values from this session
            if (i < otherTrackers.length && otherTrackers[i]) {
                this.currentSessionCounts[i] = this.currentCounts[i] = otherTrackers[i].tracker.getSessionCount(otherTrackers[i].index);
                this.currentStartTimes[i] = otherTrackers[i].tracker.getStartTime(otherTrackers[i].index);
            }
            // If we've got a baseline from previous sessions, add it in as well
            if (this.trackedActivities[i].getIsAggregate() && i < baselineCounts.length) {
                this.currentCounts[i] += baselineCounts[i];
            }
            if (this.hasCountCrossedThreshold(i)) {
                this.finishActivityAtIndex(i);
            }
        }
        if (this.isActivated() && !wasAlreadyActivatedThisSession) {
            // Mark this object so that the next time any permitted activation event is logged, the survey will activate
            this.isActivationByInitPending = true;
        }
    };
    ActivityTracker.prototype.generateActivityIndexList = function () {
        var indexList = new Array();
        for (var i = 0; i < this.trackedActivities.length; i++) {
            var current = new ActivityTracker.ActivityIndex();
            current.activity = this.trackedActivities[i].getActivity();
            current.index = i;
            indexList.push(current);
        }
        return indexList;
    };
    /**
     * Increments the count at the specified index by the given increment.  Returns a value indicating whether
     * or not this call triggered a transition edge (activating the activity at 'index', or finishing the activation
     * of the final pending activity)
     */
    ActivityTracker.prototype.incrementActivity = function (index, increment) {
        if (!this.isValidIndex(index)) {
            return ActivityTracker.IncrementResult.Pending;
        }
        if (increment < 0) {
            throw new Error("increment must be non-negative");
        }
        // Ordered sets must be triggered in order.  We can only track at the current index, or before
        if (this.isOrdered && index > this.currentIndex) {
            return ActivityTracker.IncrementResult.Pending;
        }
        // Add to our counts after storing off our current state
        var startedLessThanThreshold = !this.hasCountCrossedThreshold(index);
        this.currentCounts[index] += increment;
        this.currentSessionCounts[index] += increment;
        if (this.isActivationByInitPending) {
            if (this.isPermittedIndexForActivationByInit(index)) {
                // This tracker was completed due to the initialization from previous increment data
                // now that we've store this activities increments, raise the AllActivitiesActivated signal
                return this.commitActivation();
            }
            else {
                // Still waiting for a valid re-activation activity
                return ActivityTracker.IncrementResult.Pending;
            }
        }
        if (!(startedLessThanThreshold && this.hasCountCrossedThreshold(index))) {
            // Still waiting for this activity to finish
            return ActivityTracker.IncrementResult.Pending;
        }
        // Mark this activity as complete in our flag collection
        this.finishActivityAtIndex(index);
        if (this.isActivated()) {
            return this.commitActivation();
        }
        return ActivityTracker.IncrementResult.SingleActivityActivated;
    };
    /**
     * Explicitly sets a start timestamp (now if startTime is null) for the specified activity index. Overwrites any previous StartTime.
     */
    ActivityTracker.prototype.startTime = function (index, startTime) {
        if (!this.isValidIndex(index)) {
            return;
        }
        this.currentStartTimes[index] = (!startTime) ? new Date() : startTime;
    };
    /**
     * Computes the "count" delta (delta in whatever units are appropriate for a subsequent call to IncrementActivity)
     * elapsed between now and a previously logged StartTime for this activity index.
     * Always clears the previous StartTime.
     * Returns 0 if no previous StartTime was logged, or if StartTime > StopTime
     */
    ActivityTracker.prototype.stopTime = function (index, stopTime) {
        if (!this.isValidIndex(index)) {
            return 0;
        }
        var startTime = this.currentStartTimes[index];
        this.currentStartTimes[index] = null;
        if (!startTime) {
            return 0;
        }
        stopTime = (!stopTime) ? new Date() : stopTime;
        if (startTime > stopTime) {
            return 0;
        }
        var deltaMS = stopTime.getTime() - startTime.getTime();
        // Currently all timer activities return seconds as the increment unit
        return deltaMS / 1000;
    };
    /**
     * Returns true if the index is valid for accessing the stored activity counts, false otherwise
     */
    ActivityTracker.prototype.isValidIndex = function (index) {
        return index < this.trackedActivities.length;
    };
    /**
     * Gets whether or not the full set of activities for this tracker have exceeded their trigger thresholds
     */
    ActivityTracker.prototype.isActivated = function () {
        return (this.currentActivationFlags & this.activationMask) === this.activationMask;
    };
    /**
        * Marks the activity at the index as finished. Includes setting the proper
        * activation flags and potentially advancing the current index for ordered tracking sets
        */
    ActivityTracker.prototype.finishActivityAtIndex = function (index) {
        if (!this.isValidIndex(index)) {
            throw new Error("Index is not valid");
        }
        this.currentActivationFlags |= 0x1 << index;
        if (index + 1 < this.trackedActivities.length) {
            this.currentIndex = index + 1;
        }
    };
    /**
     * @param index index
     * @return true if the counts for the activity at the specified index have met or exceeded the threshold count.
     */
    ActivityTracker.prototype.hasCountCrossedThreshold = function (index) {
        if (!this.isValidIndex(index)) {
            throw new Error("Index is not valid");
        }
        return this.currentCounts[index] >= this.trackedActivities[index].getCount();
    };
    /**
     * Returns true if the index refers to an activity that can re-activate a tracked object (aka return AllActivitiesActivated)
     * that was initialized as "complete" via initCounts.
     * Note: For unordered sets, any activity is valid. For ordered sequences, only the final activity is valid
     */
    ActivityTracker.prototype.isPermittedIndexForActivationByInit = function (index) {
        return !this.isOrdered || ((index + 1) === this.currentCounts.length);
    };
    ActivityTracker.prototype.commitActivation = function () {
        this.isActivationByInitPending = false;
        return ActivityTracker.IncrementResult.AllActivitiesActivated;
    };
    return ActivityTracker;
}());
(function (ActivityTracker) {
    /**
     * Structure returned by an ActivityTracker to call back into
     * IncrementActivity with valid index values
     */
    var ActivityIndex = /** @class */ (function () {
        function ActivityIndex() {
        }
        return ActivityIndex;
    }());
    ActivityTracker.ActivityIndex = ActivityIndex;
    var IncrementResult;
    (function (IncrementResult) {
        /**
         * No thresholds crossed as a result of this increment operation
         */
        IncrementResult[IncrementResult["Pending"] = 0] = "Pending";
        /**
         * The threshold for the targeted activity index was crossed as a result of this increment operation
         */
        IncrementResult[IncrementResult["SingleActivityActivated"] = 1] = "SingleActivityActivated";
        /**
         * The threshold for the targeted activity index was crossed as a result of this increment operation
         * and this was the final activity being tracked
         */
        IncrementResult[IncrementResult["AllActivitiesActivated"] = 2] = "AllActivitiesActivated";
    })(IncrementResult = ActivityTracker.IncrementResult || (ActivityTracker.IncrementResult = {}));
})(ActivityTracker || (ActivityTracker = {}));
module.exports = ActivityTracker;

},{}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Basic structure used to configure an ActivityTracker
 */
var ActivityTrackingData = /** @class */ (function () {
    function ActivityTrackingData(activity, count, isAggregate) {
        this.activity = activity;
        this.count = count;
        this.isAggregate = isAggregate;
    }
    ActivityTrackingData.prototype.getActivity = function () {
        return this.activity;
    };
    ActivityTrackingData.prototype.getCount = function () {
        return this.count;
    };
    ActivityTrackingData.prototype.setCount = function (count) {
        this.count = count;
    };
    ActivityTrackingData.prototype.getIsAggregate = function () {
        return this.isAggregate;
    };
    return ActivityTrackingData;
}());
exports.ActivityTrackingData = ActivityTrackingData;

},{}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Class to hold a collection of Activity Tracking Data
 */
var ActivityTrackingSet = /** @class */ (function () {
    function ActivityTrackingSet(isOrdered, list) {
        this.isOrdered = isOrdered;
        this.list = list;
    }
    ActivityTrackingSet.prototype.getIsOrdered = function () {
        return this.isOrdered;
    };
    ActivityTrackingSet.prototype.getList = function () {
        return this.list;
    };
    return ActivityTrackingSet;
}());
exports.ActivityTrackingSet = ActivityTrackingSet;

},{}],5:[function(require,module,exports){
"use strict";
/**
 * Parent module for all modules in Api/
 */
Object.defineProperty(exports, "__esModule", { value: true });
var ISurveyInfo = require("./../ISurveyInfo");
exports.ISurveyInfo = ISurveyInfo;
var IActivityListener = require("./IActivityListener");
exports.IActivityListener = IActivityListener;
var IFloodgateStorageProvider = require("./IFloodgateStorageProvider");
exports.IFloodgateStorageProvider = IFloodgateStorageProvider;
var IFloodgateStringProvider = require("./IFloodgateStringProvider");
exports.IFloodgateStringProvider = IFloodgateStringProvider;
var IPromptComponent = require("./IPromptComponent");
exports.IPromptComponent = IPromptComponent;
var ISurvey = require("./ISurvey");
exports.ISurvey = ISurvey;
var ISurveyComponent = require("./ISurveyComponent");
exports.ISurveyComponent = ISurveyComponent;

},{"./../ISurveyInfo":22,"./IActivityListener":6,"./IFloodgateStorageProvider":7,"./IFloodgateStringProvider":8,"./IPromptComponent":9,"./ISurvey":10,"./ISurveyComponent":11}],6:[function(require,module,exports){
"use strict";
var IActivityListener;
(function (IActivityListener) {
    var ActivityName = /** @class */ (function () {
        function ActivityName() {
        }
        ActivityName.AppLaunch = "AppLaunch";
        ActivityName.AppUsageTime = "AppUsageTime";
        ActivityName.AppResume = "AppResume";
        return ActivityName;
    }());
    IActivityListener.ActivityName = ActivityName;
})(IActivityListener || (IActivityListener = {}));
module.exports = IActivityListener;

},{}],7:[function(require,module,exports){
"use strict";
var IFloodgateStorageProvider;
(function (IFloodgateStorageProvider) {
    /**
     * Enum for the files used by floodgate
     */
    var FileType;
    (function (FileType) {
        FileType[FileType["FloodgateSettings"] = 0] = "FloodgateSettings";
        FileType[FileType["SurveyActivationStats"] = 1] = "SurveyActivationStats";
        FileType[FileType["SurveyEventActivityStats"] = 2] = "SurveyEventActivityStats";
        FileType[FileType["CampaignDefinitions"] = 3] = "CampaignDefinitions";
        FileType[FileType["CampaignStates"] = 4] = "CampaignStates";
        FileType[FileType["GovernedChannelStates"] = 5] = "GovernedChannelStates";
    })(FileType = IFloodgateStorageProvider.FileType || (IFloodgateStorageProvider.FileType = {}));
})(IFloodgateStorageProvider || (IFloodgateStorageProvider = {}));
module.exports = IFloodgateStorageProvider;

},{}],8:[function(require,module,exports){
"use strict";
var IFloodgateStringProvider;
(function (IFloodgateStringProvider) {
    /**
     * Enum for the strings used by floodgate
     */
    var StringType;
    (function (StringType) {
        StringType[StringType["NpsPromptTitle"] = 0] = "NpsPromptTitle";
        StringType[StringType["NpsPromptQuestion"] = 1] = "NpsPromptQuestion";
        StringType[StringType["NpsPromptYesLabel"] = 2] = "NpsPromptYesLabel";
        StringType[StringType["NpsPromptNotNowLabel"] = 3] = "NpsPromptNotNowLabel";
        StringType[StringType["NpsRatingQuestion"] = 4] = "NpsRatingQuestion";
        StringType[StringType["Nps11RatingValue0"] = 5] = "Nps11RatingValue0";
        StringType[StringType["Nps11RatingValue1"] = 6] = "Nps11RatingValue1";
        StringType[StringType["Nps11RatingValue2"] = 7] = "Nps11RatingValue2";
        StringType[StringType["Nps11RatingValue3"] = 8] = "Nps11RatingValue3";
        StringType[StringType["Nps11RatingValue4"] = 9] = "Nps11RatingValue4";
        StringType[StringType["Nps11RatingValue5"] = 10] = "Nps11RatingValue5";
        StringType[StringType["Nps11RatingValue6"] = 11] = "Nps11RatingValue6";
        StringType[StringType["Nps11RatingValue7"] = 12] = "Nps11RatingValue7";
        StringType[StringType["Nps11RatingValue8"] = 13] = "Nps11RatingValue8";
        StringType[StringType["Nps11RatingValue9"] = 14] = "Nps11RatingValue9";
        StringType[StringType["Nps11RatingValue10"] = 15] = "Nps11RatingValue10";
        StringType[StringType["Nps5RatingValue1"] = 16] = "Nps5RatingValue1";
        StringType[StringType["Nps5RatingValue2"] = 17] = "Nps5RatingValue2";
        StringType[StringType["Nps5RatingValue3"] = 18] = "Nps5RatingValue3";
        StringType[StringType["Nps5RatingValue4"] = 19] = "Nps5RatingValue4";
        StringType[StringType["Nps5RatingValue5"] = 20] = "Nps5RatingValue5";
        StringType[StringType["NpsCommentQuestion"] = 21] = "NpsCommentQuestion";
        StringType[StringType["PsatPromptTitle"] = 22] = "PsatPromptTitle";
        StringType[StringType["PsatPromptQuestion"] = 23] = "PsatPromptQuestion";
        StringType[StringType["PsatPromptYesLabel"] = 24] = "PsatPromptYesLabel";
        StringType[StringType["PsatPromptNotNowLabel"] = 25] = "PsatPromptNotNowLabel";
        StringType[StringType["PsatRatingQuestion"] = 26] = "PsatRatingQuestion";
        StringType[StringType["PsatRatingValue1"] = 27] = "PsatRatingValue1";
        StringType[StringType["PsatRatingValue2"] = 28] = "PsatRatingValue2";
        StringType[StringType["PsatRatingValue3"] = 29] = "PsatRatingValue3";
        StringType[StringType["PsatRatingValue4"] = 30] = "PsatRatingValue4";
        StringType[StringType["PsatRatingValue5"] = 31] = "PsatRatingValue5";
        StringType[StringType["PsatCommentQuestion"] = 32] = "PsatCommentQuestion";
        StringType[StringType["BpsPromptTitle"] = 33] = "BpsPromptTitle";
        StringType[StringType["BpsPromptQuestion"] = 34] = "BpsPromptQuestion";
        StringType[StringType["BpsPromptYesLabel"] = 35] = "BpsPromptYesLabel";
        StringType[StringType["BpsPromptNotNowLabel"] = 36] = "BpsPromptNotNowLabel";
        StringType[StringType["BpsRatingQuestion"] = 37] = "BpsRatingQuestion";
        StringType[StringType["BpsRatingValue1"] = 38] = "BpsRatingValue1";
        StringType[StringType["BpsRatingValue2"] = 39] = "BpsRatingValue2";
        StringType[StringType["BpsCommentQuestion"] = 40] = "BpsCommentQuestion";
    })(StringType = IFloodgateStringProvider.StringType || (IFloodgateStringProvider.StringType = {}));
})(IFloodgateStringProvider || (IFloodgateStringProvider = {}));
module.exports = IFloodgateStringProvider;

},{}],9:[function(require,module,exports){
"use strict";
var IPromptComponent;
(function (IPromptComponent) {
    var PromptButton;
    (function (PromptButton) {
        PromptButton[PromptButton["Unselected"] = 0] = "Unselected";
        PromptButton[PromptButton["Yes"] = 1] = "Yes";
        PromptButton[PromptButton["No"] = 2] = "No";
    })(PromptButton = IPromptComponent.PromptButton || (IPromptComponent.PromptButton = {}));
})(IPromptComponent || (IPromptComponent = {}));
module.exports = IPromptComponent;

},{}],10:[function(require,module,exports){
"use strict";
var ISurvey;
(function (ISurvey) {
    var Type;
    (function (Type) {
        // A Feedback survey. Contains a single question with a free-form text response
        Type[Type["Feedback"] = 0] = "Feedback";
        // An NPS (net promoter score) survey. Asks user to rate "whether or not they would recommend this product to family/friends".
        // Contains a prompt, question, and rating
        Type[Type["Nps"] = 1] = "Nps";
        // A PSAT (product satisfaction) survey. Asks user to rate "overall, based on their experience, how satisifed are they with this app"
        // Contains a prompt, question, and rating
        Type[Type["Psat"] = 2] = "Psat";
        // A BPS (build promotion) survey. Asks user to choose between Yes and No options of promoting the current build to the next audience ring
        // Contains a prompt, question, and rating (Yes/No)
        Type[Type["Bps"] = 3] = "Bps";
        // A FPS (feature promotion) survey. Asks user to rate a given app feature.
        // Contains a prompt, question, and rating
        Type[Type["Fps"] = 4] = "Fps";
        // A NLQS (net language quality score) survey. Asks user to rate the language quality.
        // Contains a prompt, question, and rating
        Type[Type["Nlqs"] = 5] = "Nlqs";
    })(Type = ISurvey.Type || (ISurvey.Type = {}));
    ISurvey.DOM_FEEDBACKSURVEY_TAGNAME = "FeedbackSurvey";
    ISurvey.DOM_NPS_TAGNAME = "Nps";
    ISurvey.DOM_PSAT_TAGNAME = "Psat";
    ISurvey.DOM_BPS_TAGNAME = "Bps";
    ISurvey.DOM_FPS_TAGNAME = "Fps";
    ISurvey.DOM_NLQS_TAGNAME = "Nlqs";
})(ISurvey || (ISurvey = {}));
module.exports = ISurvey;

},{}],11:[function(require,module,exports){
"use strict";
var ISurveyComponent;
(function (ISurveyComponent) {
    var Type;
    (function (Type) {
        // A quick pop-up requesting participation in a survey
        Type[Type["Prompt"] = "Prompt"] = "Prompt";
        // A question paired with a free-form text response
        Type[Type["Comment"] = "Comment"] = "Comment";
        // A question asking for a selection from a list of allowed values with numeric meaning
        Type[Type["Rating"] = "Rating"] = "Rating";
    })(Type = ISurveyComponent.Type || (ISurveyComponent.Type = {}));
    ISurveyComponent.DOM_PROMPT_TAGNAME = "Prompt";
    ISurveyComponent.DOM_COMMENT_TAGNAME = "Comment";
    ISurveyComponent.DOM_RATING_TAGNAME = "Rating";
    ISurveyComponent.JSON_PROMPT_KEYNAME = "prompt";
    ISurveyComponent.JSON_COMMENT_KEYNAME = "comment";
    ISurveyComponent.JSON_RATING_KEYNAME = "rating";
})(ISurveyComponent || (ISurveyComponent = {}));
module.exports = ISurveyComponent;

},{}],12:[function(require,module,exports){
"use strict";
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var IFloodgateStorageProvider = require("../Api/IFloodgateStorageProvider");
var FloodgateEngine_1 = require("../FloodgateEngine");
var GovernedChannel_1 = require("../GovernedChannel");
var ISurveyInfo = require("../ISurveyInfo");
var Utils = require("../Utils");
// region Language Range
/**
 * Base class representing a language range in a campaign setting
 */
var CampaignLanguageRange = /** @class */ (function () {
    function CampaignLanguageRange() {
    }
    CampaignLanguageRange.deserialize = function (input) {
        var result;
        if (input && input.Type === 0) {
            result = CampaignLanguageRangeLanguageSubtag.deserialize(input);
        }
        if (result === undefined) {
            return null;
        }
        return result;
    };
    CampaignLanguageRange.prototype.validate = function () {
        return true;
    };
    return CampaignLanguageRange;
}());
exports.CampaignLanguageRange = CampaignLanguageRange;
/**
 * Represents a range matching on the "language subtag" against fully specified language tags, according to RFC 5646
 */
var CampaignLanguageRangeLanguageSubtag = /** @class */ (function (_super) {
    __extends(CampaignLanguageRangeLanguageSubtag, _super);
    // public for UT only
    function CampaignLanguageRangeLanguageSubtag() {
        return _super.call(this) || this;
    }
    CampaignLanguageRangeLanguageSubtag.deserialize = function (input) {
        var result = new CampaignLanguageRangeLanguageSubtag();
        if (input) {
            result.languageSubTag = input.Value;
        }
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    // @Override
    CampaignLanguageRangeLanguageSubtag.prototype.isInRange = function (language) {
        if (Utils.isNullOrUndefined(language)) {
            return false;
        }
        var extractedLanguageSubTag = Utils.extractLanguageSubtag(language);
        if (Utils.isNullOrUndefined(extractedLanguageSubTag)) {
            return false;
        }
        // compare strings ignoring case
        return extractedLanguageSubTag.toLocaleUpperCase() === this.languageSubTag.toLocaleUpperCase();
    };
    // @Override
    CampaignLanguageRangeLanguageSubtag.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.languageSubTag) || !Utils.isString(this.languageSubTag)) {
            return false;
        }
        // Reject any spec that isn't exactly a language subtag
        if (!Utils.isValidLanguageSubTag(this.languageSubTag)) {
            return false;
        }
        return true;
    };
    return CampaignLanguageRangeLanguageSubtag;
}(CampaignLanguageRange));
exports.CampaignLanguageRangeLanguageSubtag = CampaignLanguageRangeLanguageSubtag;
// endregion
// region Scope
var CampaignScope = /** @class */ (function () {
    function CampaignScope() {
    }
    CampaignScope.deserialize = function (input) {
        var result;
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        switch (input.Type) {
            case 0:
                result = CampaignScopeAny.deserialize(input);
                break;
            case 1:
                result = CampaignScopeEnvironmentCrossProduct.deserialize(input);
                break;
        }
        if (result === undefined) {
            return null;
        }
        return result;
    };
    CampaignScope.prototype.validate = function () {
        return true;
    };
    return CampaignScope;
}());
exports.CampaignScope = CampaignScope;
var CampaignScopeAny = /** @class */ (function (_super) {
    __extends(CampaignScopeAny, _super);
    // public for UT only
    function CampaignScopeAny() {
        return _super.call(this) || this;
    }
    CampaignScopeAny.deserialize = function (input) {
        return new CampaignScopeAny();
    };
    // @Override
    CampaignScopeAny.prototype.isInScope = function (environmentProvider) {
        return true;
    };
    // @Override
    CampaignScopeAny.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        return true;
    };
    return CampaignScopeAny;
}(CampaignScope));
exports.CampaignScopeAny = CampaignScopeAny;
var CampaignScopeEnvironmentCrossProduct = /** @class */ (function (_super) {
    __extends(CampaignScopeEnvironmentCrossProduct, _super);
    // public for UT only
    function CampaignScopeEnvironmentCrossProduct() {
        return _super.call(this) || this;
    }
    CampaignScopeEnvironmentCrossProduct.deserialize = function (input) {
        var result = new CampaignScopeEnvironmentCrossProduct();
        var languageRanges = [];
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        for (var key in input.Languages) {
            if (input.Languages.hasOwnProperty(key)) {
                var readRange = input.Languages[key];
                if (readRange) {
                    languageRanges.push(CampaignLanguageRange.deserialize(readRange));
                }
            }
        }
        if (languageRanges.length === 0) {
            languageRanges = null;
        }
        result.languageRanges = languageRanges;
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    // @Override
    CampaignScopeEnvironmentCrossProduct.prototype.isInScope = function (environmentProvider) {
        if (Utils.isNullOrUndefined(this.languageRanges)) {
            return true;
        }
        if (Utils.isNullOrUndefined(environmentProvider) || !environmentProvider.getLanguage()) {
            return false;
        }
        // If the environment matches a single pattern, then this is a yes
        for (var key in this.languageRanges) {
            if (this.languageRanges.hasOwnProperty(key)) {
                var range = this.languageRanges[key];
                if (range.isInRange(environmentProvider.getLanguage())) {
                    return true;
                }
            }
        }
        return false;
    };
    // @Override
    CampaignScopeEnvironmentCrossProduct.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        // Null languageRanges is allowed, means will match with everything.
        if (this.languageRanges) {
            for (var key in this.languageRanges) {
                if (this.languageRanges.hasOwnProperty(key) && !this.languageRanges[key]) {
                    return false;
                }
            }
        }
        return true;
    };
    return CampaignScopeEnvironmentCrossProduct;
}(CampaignScope));
exports.CampaignScopeEnvironmentCrossProduct = CampaignScopeEnvironmentCrossProduct;
// endregion
// region Durations
/**
 * Base class representing a duration in a campaign setting
 */
var CampaignDuration = /** @class */ (function () {
    function CampaignDuration() {
    }
    CampaignDuration.deserialize = function (input) {
        var result;
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        switch (input.Type) {
            case 0:
                result = CampaignDurationTimeInterval.deserialize(input);
                break;
            case 1:
                result = CampaignDurationSingleBuildChange.deserialize(input);
                break;
        }
        if (result === undefined) {
            return null;
        }
        return result;
    };
    CampaignDuration.prototype.validate = function () {
        return true;
    };
    return CampaignDuration;
}());
exports.CampaignDuration = CampaignDuration;
/**
 * A Duration expressed in seconds. UTC datetime comparisons are used to determine expiration.
 */
var CampaignDurationTimeInterval = /** @class */ (function (_super) {
    __extends(CampaignDurationTimeInterval, _super);
    // public for UT only
    function CampaignDurationTimeInterval() {
        return _super.call(this) || this;
    }
    CampaignDurationTimeInterval.deserialize = function (input) {
        var result = new CampaignDurationTimeInterval();
        if (input) {
            result.intervalSeconds = input.IntervalSeconds;
        }
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    // @Override
    CampaignDurationTimeInterval.prototype.asTimeIntervalSeconds = function () {
        return this.intervalSeconds;
    };
    // @Override
    CampaignDurationTimeInterval.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        if (!Utils.isNumber(this.intervalSeconds)) {
            return false;
        }
        return true;
    };
    return CampaignDurationTimeInterval;
}(CampaignDuration));
exports.CampaignDurationTimeInterval = CampaignDurationTimeInterval;
/**
 * A Duration representing exactly 1 change in build number
 */
var CampaignDurationSingleBuildChange = /** @class */ (function (_super) {
    __extends(CampaignDurationSingleBuildChange, _super);
    // public for UT only
    function CampaignDurationSingleBuildChange() {
        return _super.call(this) || this;
    }
    CampaignDurationSingleBuildChange.deserialize = function (input) {
        return new CampaignDurationSingleBuildChange();
    };
    // @Override
    CampaignDurationSingleBuildChange.prototype.asTimeIntervalSeconds = function () {
        return null;
    };
    return CampaignDurationSingleBuildChange;
}(CampaignDuration));
exports.CampaignDurationSingleBuildChange = CampaignDurationSingleBuildChange;
/**
 * Class representing AdditionalDataRequested in CampaignDefinition
 */
var CampaignAdditionalDataRequested = /** @class */ (function () {
    function CampaignAdditionalDataRequested() {
    }
    CampaignAdditionalDataRequested.deserialize = function (additionalDataRequested) {
        var result = new CampaignAdditionalDataRequested();
        if (!Utils.isNullOrUndefined(additionalDataRequested)) {
            // Convert from AdditionalDataRequested string to enum
            result.additionalData = [];
            for (var _i = 0, additionalDataRequested_1 = additionalDataRequested; _i < additionalDataRequested_1.length; _i++) {
                var additionalData = additionalDataRequested_1[_i];
                if (additionalData === "EmailAddress") {
                    result.additionalData.push(ISurveyInfo.AdditionalDataType.EmailAddress);
                }
            }
        }
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignAdditionalDataRequested.prototype.validate = function () {
        if (Utils.isNullOrUndefined(this.additionalData)) {
            return false;
        }
        return true;
    };
    return CampaignAdditionalDataRequested;
}());
exports.CampaignAdditionalDataRequested = CampaignAdditionalDataRequested;
// endregion
// region Distribution Schemes
var CampaignDistribution = /** @class */ (function () {
    function CampaignDistribution() {
    }
    CampaignDistribution.deserialize = function (input) {
        var result;
        if (input && input.Type === 0) {
            result = CampaignDistributionRamp.deserialize(input);
        }
        if (result === undefined) {
            return null;
        }
        return result;
    };
    CampaignDistribution.prototype.validate = function () {
        return true;
    };
    return CampaignDistribution;
}());
exports.CampaignDistribution = CampaignDistribution;
var CampaignDistributionRamp = /** @class */ (function (_super) {
    __extends(CampaignDistributionRamp, _super);
    function CampaignDistributionRamp() {
        return _super.call(this) || this;
    }
    CampaignDistributionRamp.deserialize = function (input) {
        var result = new CampaignDistributionRamp();
        if (input) {
            result.maxDelaySeconds = input.MaxDelaySeconds;
            result.chunks = input.Chunks;
        }
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    // @Override
    CampaignDistributionRamp.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        if (!Utils.isNumber(this.maxDelaySeconds) || this.maxDelaySeconds < 0) {
            return false;
        }
        if (!Utils.isNumber(this.chunks) || this.chunks < 0) {
            return false;
        }
        return true;
    };
    return CampaignDistributionRamp;
}(CampaignDistribution));
exports.CampaignDistributionRamp = CampaignDistributionRamp;
// endregion
// region Nomination Scheme
var CampaignNominationScheme = /** @class */ (function () {
    function CampaignNominationScheme() {
    }
    CampaignNominationScheme.deserialize = function (input) {
        var result;
        if (input && input.Type === 0) {
            result = CampaignNominationSchemeRatioPercentage.deserialize(input);
        }
        if (result === undefined) {
            return null;
        }
        return result;
    };
    /**
     * @return The amount of time the survey should be active, in seconds. Abstracts the difference between nominationPeriod and the fallback
     */
    CampaignNominationScheme.prototype.getActiveSurveyTimeIntervalSeconds = function () {
        var nominationTimIntervalSeconds = this.nominationPeriod.asTimeIntervalSeconds();
        if (Utils.isNumber(nominationTimIntervalSeconds)) {
            return nominationTimIntervalSeconds;
        }
        return this.fallbackSurveyDurationSeconds;
    };
    /**
     * @return The survey start time, possibly adjusted by an underlying DistributionModel.
     */
    CampaignNominationScheme.prototype.calculateSurveyStartTimeFromDate = function (soonestStartTime) {
        // No adjustment in base class.  Derived classes can override and implement delays like a "ramp"
        return soonestStartTime ? soonestStartTime : new Date();
    };
    /**
     * @return The survey expiration time, based on the nomination periods and the survey's adjusted start time
     */
    CampaignNominationScheme.prototype.calculateSurveyExpirationTimeFromSurveyStartTime = function (surveyStartTime) {
        surveyStartTime = surveyStartTime ? surveyStartTime : new Date();
        return Utils.addSecondsWithoutOverflow(surveyStartTime, this.getActiveSurveyTimeIntervalSeconds());
    };
    /**
     * @return The appropriate campaign cool down based on whether or not the user activated the survey
     */
    CampaignNominationScheme.prototype.getCampaignCooldown = function (didUserActivateSurvey) {
        if (didUserActivateSurvey) {
            return this.cooldownPeriod;
        }
        else {
            return this.nominationPeriod;
        }
    };
    CampaignNominationScheme.prototype.validate = function () {
        if (Utils.isNullOrUndefined(this.nominationPeriod)) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.cooldownPeriod)) {
            this.cooldownPeriod = this.nominationPeriod;
        }
        if (!Utils.isNumber(this.nominationPeriod.asTimeIntervalSeconds())) {
            if (!Utils.isNumber(this.fallbackSurveyDurationSeconds) || this.fallbackSurveyDurationSeconds <= 0) {
                return false;
            }
        }
        return true;
    };
    return CampaignNominationScheme;
}());
exports.CampaignNominationScheme = CampaignNominationScheme;
/**
 * Class representing a set of campaign nomination rules to evaluate for in-scope campaigns:
 * percentage
 * re-election durations
 * distribution model (for "nominated" candidates)
 */
var CampaignNominationSchemeRatioPercentage = /** @class */ (function (_super) {
    __extends(CampaignNominationSchemeRatioPercentage, _super);
    function CampaignNominationSchemeRatioPercentage() {
        return _super.call(this) || this;
    }
    CampaignNominationSchemeRatioPercentage.deserialize = function (input) {
        var result = new CampaignNominationSchemeRatioPercentage();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        if (input.DistributionModel) {
            result.distributionModel = CampaignDistribution.deserialize(input.DistributionModel);
        }
        if (input.CooldownPeriod) {
            result.cooldownPeriod = CampaignDuration.deserialize(input.CooldownPeriod);
        }
        if (input.NominationPeriod) {
            result.nominationPeriod = CampaignDuration.deserialize(input.NominationPeriod);
        }
        result.fallbackSurveyDurationSeconds = input.FallbackSurveyDurationSeconds;
        result.percentageDenominator = input.PercentageDenominator;
        result.percentageNumerator = input.PercentageNumerator;
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    // @Override
    CampaignNominationSchemeRatioPercentage.prototype.evaluateNominationRules = function () {
        var rand = Math.random();
        // Creates a random number between [0 to (percentageDenominator - 1)]
        // In range [0 to (percentageDenominator - 1)] exactly 'percentageNumerator' values are < percentageNumerator
        return Math.floor(rand * this.percentageDenominator) < this.percentageNumerator;
    };
    // @Override
    CampaignNominationSchemeRatioPercentage.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        if (!Utils.isNumber(this.percentageDenominator) || !Utils.isNumber(this.percentageNumerator)) {
            return false;
        }
        if (this.percentageDenominator <= 0 || this.percentageNumerator < 0) {
            return false;
        }
        if (this.percentageNumerator > this.percentageDenominator) {
            return false;
        }
        // distribution model may be null
        return true;
    };
    return CampaignNominationSchemeRatioPercentage;
}(CampaignNominationScheme));
exports.CampaignNominationSchemeRatioPercentage = CampaignNominationSchemeRatioPercentage;
// endregion
// region Survey Event Definitions
var CampaignSurveyEvent = /** @class */ (function () {
    function CampaignSurveyEvent() {
    }
    CampaignSurveyEvent.deserialize = function (input) {
        var result;
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        switch (input.Type) {
            case 0:
                result = CampaignSurveyEventCountedActivity.deserialize(input);
                break;
            case 1:
                result = CampaignSurveyEventCountedActivitySequence.deserialize(input);
                break;
        }
        if (result === undefined) {
            return null;
        }
        return result;
    };
    CampaignSurveyEvent.prototype.validate = function () {
        return true;
    };
    return CampaignSurveyEvent;
}());
exports.CampaignSurveyEvent = CampaignSurveyEvent;
var CampaignSurveyEventCountedActivity = /** @class */ (function (_super) {
    __extends(CampaignSurveyEventCountedActivity, _super);
    // public for UT only
    function CampaignSurveyEventCountedActivity() {
        return _super.call(this) || this;
    }
    CampaignSurveyEventCountedActivity.deserialize = function (input) {
        var result = new CampaignSurveyEventCountedActivity();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.activity = input.Activity;
        result.count = input.Count;
        result.isAggregate = input.IsAggregate;
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    // @Override
    CampaignSurveyEventCountedActivity.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.activity) || !Utils.isString(this.activity)) {
            return false;
        }
        if (!Utils.isNumber(this.count) || this.count <= 0) {
            return false;
        }
        if (!Utils.isBoolean(this.isAggregate)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyEventCountedActivity;
}(CampaignSurveyEvent));
exports.CampaignSurveyEventCountedActivity = CampaignSurveyEventCountedActivity;
var CampaignSurveyEventCountedActivitySequence = /** @class */ (function (_super) {
    __extends(CampaignSurveyEventCountedActivitySequence, _super);
    // public for UT only
    function CampaignSurveyEventCountedActivitySequence() {
        return _super.call(this) || this;
    }
    CampaignSurveyEventCountedActivitySequence.deserialize = function (input) {
        var result = new CampaignSurveyEventCountedActivitySequence();
        var sequence = [];
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        for (var key in input.Sequence) {
            if (input.Sequence.hasOwnProperty(key)) {
                var readActivity = input.Sequence[key];
                if (readActivity) {
                    sequence.push(CampaignSurveyEventCountedActivity.deserialize(readActivity));
                }
            }
        }
        if (sequence.length === 0) {
            sequence = null;
        }
        result.sequence = sequence;
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    // @Override
    CampaignSurveyEventCountedActivitySequence.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.sequence)) {
            return false;
        }
        for (var key in this.sequence) {
            if (this.sequence.hasOwnProperty(key) && !this.sequence[key]) {
                return false;
            }
        }
        return true;
    };
    return CampaignSurveyEventCountedActivitySequence;
}(CampaignSurveyEvent));
exports.CampaignSurveyEventCountedActivitySequence = CampaignSurveyEventCountedActivitySequence;
// endregion
// region Survey Content Definitions
var CampaignSurveyContent = /** @class */ (function () {
    function CampaignSurveyContent() {
    }
    CampaignSurveyContent.deserialize = function (input) {
        var result = new CampaignSurveyContent();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.prompt = CampaignSurveyContentPrompt.deserialize(input.Prompt);
        result.rating = CampaignSurveyContentRating.deserialize(input.Rating);
        result.comment = CampaignSurveyContentComment.deserialize(input.Question);
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyContent.prototype.validate = function () {
        // both rating and comment are required - in sync with current version of mso implementation.
        if (Utils.isNullOrUndefined(this.prompt) || Utils.isNullOrUndefined(this.rating) || Utils.isNullOrUndefined(this.comment)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyContent;
}());
exports.CampaignSurveyContent = CampaignSurveyContent;
var CampaignSurveyContentPrompt = /** @class */ (function () {
    function CampaignSurveyContentPrompt() {
    }
    CampaignSurveyContentPrompt.deserialize = function (input) {
        var result = new CampaignSurveyContentPrompt();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.title = input.Title;
        result.question = input.Question;
        result.yesLabel = input.YesLabel;
        result.noLabel = input.NoLabel;
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyContentPrompt.prototype.validate = function () {
        if (Utils.isNullOrUndefined(this.title) || !Utils.isString(this.title) ||
            Utils.isNullOrUndefined(this.question) || !Utils.isString(this.question) ||
            Utils.isNullOrUndefined(this.yesLabel) || !Utils.isString(this.yesLabel) ||
            Utils.isNullOrUndefined(this.noLabel) || !Utils.isString(this.noLabel)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyContentPrompt;
}());
exports.CampaignSurveyContentPrompt = CampaignSurveyContentPrompt;
var CampaignSurveyContentRating = /** @class */ (function () {
    function CampaignSurveyContentRating() {
    }
    CampaignSurveyContentRating.deserialize = function (input) {
        var result = new CampaignSurveyContentRating();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.isZeroBased = input.IsZeroBased;
        result.question = input.Question;
        result.ratingValuesAscending = input.RatingValuesAscending;
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyContentRating.prototype.validate = function () {
        // expect ratingValuesAscending to contain between 2 to 11 values
        if (Utils.isNullOrUndefined(this.question) || !Utils.isString(this.question) ||
            Utils.isNullOrUndefined(this.ratingValuesAscending) || !Array.isArray(this.ratingValuesAscending) ||
            this.ratingValuesAscending.length < 2 || this.ratingValuesAscending.length > 11) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.isZeroBased)) {
            // default to false if not provided
            this.isZeroBased = false;
        }
        else if (!Utils.isBoolean(this.isZeroBased)) {
            // fail validation if non boolean value is provided
            return false;
        }
        // expect all ratingValuesAscending values to be string
        for (var key in this.ratingValuesAscending) {
            if (this.ratingValuesAscending.hasOwnProperty(key)) {
                if (!Utils.isString(this.ratingValuesAscending[key])) {
                    return false;
                }
            }
        }
        return true;
    };
    return CampaignSurveyContentRating;
}());
exports.CampaignSurveyContentRating = CampaignSurveyContentRating;
var CampaignSurveyContentComment = /** @class */ (function () {
    function CampaignSurveyContentComment() {
    }
    CampaignSurveyContentComment.deserialize = function (input) {
        var result = new CampaignSurveyContentComment();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        // @SerializedName("Question")
        result.question = input.Question;
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyContentComment.prototype.validate = function () {
        if (Utils.isNullOrUndefined(this.question) || !Utils.isString(this.question)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyContentComment;
}());
exports.CampaignSurveyContentComment = CampaignSurveyContentComment;
// endregion
// region Survey Template definitions
var CampaignSurveyTemplate = /** @class */ (function () {
    function CampaignSurveyTemplate() {
    }
    CampaignSurveyTemplate.deserialize = function (input) {
        var result;
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        switch (input.Type) {
            case 0:
                result = CampaignSurveyTemplateNps5PointStatic.deserialize(input);
                break;
            case 1:
                result = CampaignSurveyTemplateNps11PointStatic.deserialize(input);
                break;
            case 2:
                result = CampaignSurveyTemplateFps.deserialize(input);
                break;
            case 3:
                result = CampaignSurveyTemplateNlqs.deserialize(input);
                break;
            case 4:
                result = CampaignSurveyTemplateNps.deserialize(input);
                break;
        }
        if (result === undefined) {
            return null;
        }
        return result;
    };
    CampaignSurveyTemplate.prototype.validate = function () {
        if (Utils.isNullOrUndefined(this.activationEvent)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyTemplate;
}());
exports.CampaignSurveyTemplate = CampaignSurveyTemplate;
var CampaignSurveyTemplateFps = /** @class */ (function (_super) {
    __extends(CampaignSurveyTemplateFps, _super);
    // public for UT only
    function CampaignSurveyTemplateFps() {
        return _super.call(this) || this;
    }
    CampaignSurveyTemplateFps.deserialize = function (input) {
        var result = new CampaignSurveyTemplateFps();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);
        result.content = CampaignSurveyContent.deserialize(input.Content);
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyTemplateFps.prototype.validate = function () {
        if (!_super.prototype.validate.call(this) || Utils.isNullOrUndefined(this.content)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyTemplateFps;
}(CampaignSurveyTemplate));
exports.CampaignSurveyTemplateFps = CampaignSurveyTemplateFps;
var CampaignSurveyTemplateNlqs = /** @class */ (function (_super) {
    __extends(CampaignSurveyTemplateNlqs, _super);
    // public for UT only
    function CampaignSurveyTemplateNlqs() {
        return _super.call(this) || this;
    }
    CampaignSurveyTemplateNlqs.deserialize = function (input) {
        var result = new CampaignSurveyTemplateNlqs();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);
        result.content = CampaignSurveyContent.deserialize(input.Content);
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyTemplateNlqs.prototype.validate = function () {
        if (!_super.prototype.validate.call(this) || Utils.isNullOrUndefined(this.content)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyTemplateNlqs;
}(CampaignSurveyTemplate));
exports.CampaignSurveyTemplateNlqs = CampaignSurveyTemplateNlqs;
var CampaignSurveyTemplateNps = /** @class */ (function (_super) {
    __extends(CampaignSurveyTemplateNps, _super);
    // public for UT only
    function CampaignSurveyTemplateNps() {
        return _super.call(this) || this;
    }
    CampaignSurveyTemplateNps.deserialize = function (input) {
        var result = new CampaignSurveyTemplateNps();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);
        result.content = CampaignSurveyContent.deserialize(input.Content);
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyTemplateNps.prototype.validate = function () {
        if (!_super.prototype.validate.call(this) || Utils.isNullOrUndefined(this.content)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyTemplateNps;
}(CampaignSurveyTemplate));
exports.CampaignSurveyTemplateNps = CampaignSurveyTemplateNps;
var CampaignSurveyTemplateNps5PointStatic = /** @class */ (function (_super) {
    __extends(CampaignSurveyTemplateNps5PointStatic, _super);
    // public for UT only
    function CampaignSurveyTemplateNps5PointStatic() {
        return _super.call(this) || this;
    }
    CampaignSurveyTemplateNps5PointStatic.deserialize = function (input) {
        var result = new CampaignSurveyTemplateNps5PointStatic();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyTemplateNps5PointStatic.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyTemplateNps5PointStatic;
}(CampaignSurveyTemplate));
exports.CampaignSurveyTemplateNps5PointStatic = CampaignSurveyTemplateNps5PointStatic;
var CampaignSurveyTemplateNps11PointStatic = /** @class */ (function (_super) {
    __extends(CampaignSurveyTemplateNps11PointStatic, _super);
    function CampaignSurveyTemplateNps11PointStatic() {
        return _super.call(this) || this;
    }
    CampaignSurveyTemplateNps11PointStatic.deserialize = function (input) {
        var result = new CampaignSurveyTemplateNps11PointStatic();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.activationEvent = CampaignSurveyEvent.deserialize(input.ActivationEvent);
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignSurveyTemplateNps11PointStatic.prototype.validate = function () {
        if (!_super.prototype.validate.call(this)) {
            return false;
        }
        return true;
    };
    return CampaignSurveyTemplateNps11PointStatic;
}(CampaignSurveyTemplate));
exports.CampaignSurveyTemplateNps11PointStatic = CampaignSurveyTemplateNps11PointStatic;
// endregion
// region Campaign Definition
var CampaignDefinition = /** @class */ (function () {
    function CampaignDefinition() {
    }
    /**
     * Method to deserialize a JSON object to class object
     * @param input: JSON object
     * Returns result of validation check
     */
    CampaignDefinition.deserialize = function (input) {
        var result = new CampaignDefinition();
        if (Utils.isNullOrUndefined(input)) {
            return null;
        }
        result.campaignId = input.CampaignId;
        result.governedChannelType = input.GovernedChannelType;
        result.startTime = input.StartTimeUtc;
        result.endTime = input.EndTimeUtc;
        var additionalDataRequested = CampaignAdditionalDataRequested.deserialize(input.AdditionalDataRequested);
        result.additionalDataRequested = additionalDataRequested ? additionalDataRequested.additionalData : [];
        if (input.SurveyTemplate) {
            result.surveyTemplate = CampaignSurveyTemplate.deserialize(input.SurveyTemplate);
        }
        if (input.NominationScheme) {
            result.nominationScheme = CampaignNominationScheme.deserialize(input.NominationScheme);
        }
        if (input.Scope) {
            result.scope = CampaignScope.deserialize(input.Scope);
        }
        if (!result.validate()) {
            return null;
        }
        return result;
    };
    CampaignDefinition.prototype.validate = function () {
        if (Utils.isNullOrUndefined(this.scope)) {
            this.scope = new CampaignScopeAny();
        }
        if (Utils.isNullOrUndefined(this.campaignId) || !Utils.isString(this.campaignId)) {
            return false;
        }
        if (!Utils.isNumber(this.governedChannelType) || !Utils.isEnumValue(this.governedChannelType, GovernedChannel_1.GovernedChannelType)) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.nominationScheme)) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.surveyTemplate)) {
            return false;
        }
        // Campaigns with no start date are effectively disabled, in fact, this is the supported way to stage a definition but have it be turned off
        if (Utils.isNullOrUndefined(this.startTime)) {
            this.startTime = Utils.getDistantFuture();
        }
        else if (Utils.isUtcDatetimeString(this.startTime)) {
            this.startTime = Utils.stringToDate(this.startTime);
        }
        else {
            return false;
        }
        // Campaigns with no end date are effectively on indefinitely
        if (Utils.isNullOrUndefined(this.endTime)) {
            this.endTime = Utils.getDistantFuture();
        }
        else if (Utils.isUtcDatetimeString(this.endTime)) {
            this.endTime = Utils.stringToDate(this.endTime);
        }
        else {
            return false;
        }
        return true;
    };
    return CampaignDefinition;
}());
exports.CampaignDefinition = CampaignDefinition;
/**
 * Given an array of campaign definitions, returns the valid ones and errors if any are invalid.
 * @param input: JSON object
 * Returns the valid definitions and the error as string if any.
 */
function FilterValidCampaignDefinitions(campaignDefinitions) {
    var result = [];
    if (Utils.isNullOrUndefined(campaignDefinitions)) {
        return { result: result, error: "Empty" };
    }
    if (!Array.isArray(campaignDefinitions)) {
        return { result: result, error: "Not an array" };
    }
    var badIndexes = [];
    for (var i = 0; i < campaignDefinitions.length; i++) {
        var definition = campaignDefinitions[i];
        if (definition) {
            var newDefinition = CampaignDefinition.deserialize(definition);
            newDefinition
                ? result.push(newDefinition)
                : badIndexes.push(i);
        }
        else {
            badIndexes.push(i);
        }
    }
    var error = badIndexes.length > 0 ? "Invalid campaign definitions at indexes: " + badIndexes.toString() : undefined;
    return { result: result, error: error };
}
exports.FilterValidCampaignDefinitions = FilterValidCampaignDefinitions;
var FileSystemCampaignDefinitionProvider = /** @class */ (function () {
    function FileSystemCampaignDefinitionProvider(storage) {
        if (Utils.isNullOrUndefined(storage)) {
            throw new Error("storage must not be null");
        }
        this.storage = storage;
    }
    FileSystemCampaignDefinitionProvider.prototype.load = function () {
        var definitionString = this.storage.read(IFloodgateStorageProvider.FileType.CampaignDefinitions);
        if (Utils.isNullOrUndefined(definitionString)) {
            return [];
        }
        var readDefinitions;
        try {
            readDefinitions = JSON.parse(definitionString);
        }
        catch (e) {
            FloodgateEngine_1.FloodgateEngine.getTelemetryLogger().log_CampaignLoad_Failed(e.toString());
            return [];
        }
        // This ignores errors in validation for now.
        return FilterValidCampaignDefinitions(readDefinitions).result;
    };
    return FileSystemCampaignDefinitionProvider;
}());
exports.FileSystemCampaignDefinitionProvider = FileSystemCampaignDefinitionProvider;

},{"../Api/IFloodgateStorageProvider":7,"../FloodgateEngine":16,"../GovernedChannel":18,"../ISurveyInfo":22,"../Utils":36}],13:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Utils = require("../Utils");
var CampaignDefinitionProvider_1 = require("./CampaignDefinitionProvider");
var CampaignStateProvider_1 = require("./CampaignStateProvider");
var CampaignSurveyFactory_1 = require("./CampaignSurveyFactory");
/**
 * The standard campaign manager implementation.
 */
var CampaignManager = /** @class */ (function () {
    function CampaignManager(stateProvider, definitionProvider, stringProvider, environmentProvider, currentBuildNumber, currentDate) {
        if (!stateProvider) {
            throw new Error("stateProvider must not be null");
        }
        if (!definitionProvider) {
            throw new Error("definitionProvider must not be null");
        }
        if (!stringProvider) {
            throw new Error("stringProvider must not be null");
        }
        if (Utils.isNullOrUndefined(currentBuildNumber)) {
            throw new Error("currentBuildNumber must not be null");
        }
        this.campaignStates = {};
        this.campaignDefinitions = {};
        this.stateProvider = stateProvider;
        this.definitionProvider = definitionProvider;
        this.stringProvider = stringProvider;
        this.environmentProvider = environmentProvider; // Can be null
        this.currentBuildNumber = currentBuildNumber;
        currentDate = currentDate ? currentDate : new Date();
        // TODO check "after test refactoring - remove this and rely on a call to "refresh" to do this work"
        this.refreshSurveyDefinitionsPrivate(null, currentDate);
    }
    CampaignManager.isStateUpForNomination = function (state, definition, date, buildNumber) {
        if (!state || !definition) {
            return false;
        }
        date = date ? date : new Date();
        // Check manual override
        if (state.ForceCandidacy) {
            return true;
        }
        // Figure out which duration we're using based on whether or not the user triggered the survey
        var campaignCooldownDuration = definition.nominationScheme.getCampaignCooldown(state.IsCandidate && state.DidCandidateTriggerSurvey);
        if (!campaignCooldownDuration) {
            return false;
        }
        // First check for build-based rules. Eventually this could get more complex if we supported counting differently seen build numbers
        if (CampaignManager.hasBuildChangeDurationElapsed(campaignCooldownDuration, state.LastNominationBuildNumber, buildNumber)) {
            return true;
        }
        // Next check date rules
        return CampaignManager.hasTimeIntervalDurationElapsed(campaignCooldownDuration, state.getCooldownStartDate(), date);
    };
    CampaignManager.isDateInRange = function (date, startDate, endDate) {
        date = date ? date : new Date();
        startDate = startDate ? startDate : Utils.getDistantPast();
        endDate = endDate ? endDate : Utils.getDistantFuture();
        // Check Start/Expire date range
        if (startDate.getTime() <= date.getTime() && endDate.getTime() >= date.getTime()) {
            return true;
        }
        return false;
    };
    CampaignManager.hasTimeIntervalDurationElapsed = function (duration, startDate, date) {
        if (Utils.isNullOrUndefined(duration) || !(duration instanceof CampaignDefinitionProvider_1.CampaignDurationTimeInterval)) {
            return false;
        }
        if (!startDate || !date) {
            return false;
        }
        var endDate = Utils.addSecondsWithoutOverflow(startDate, duration.intervalSeconds);
        return date.getTime() >= endDate.getTime();
    };
    CampaignManager.hasBuildChangeDurationElapsed = function (duration, startBuild, build) {
        if (Utils.isNullOrUndefined(duration) || !(duration instanceof CampaignDefinitionProvider_1.CampaignDurationSingleBuildChange)) {
            return false;
        }
        if (Utils.isNullOrUndefined(startBuild) || Utils.isNullOrUndefined(build)) {
            return (startBuild === null) !== (build === null);
        }
        return !(startBuild === build);
    };
    CampaignManager.isCampaignInScope = function (definition, date, environmentProvider) {
        if (!definition) {
            return false;
        }
        date = date ? date : new Date();
        // Check Start/Expire date range
        if (!CampaignManager.isDateInRangeWithDefinition(date, definition)) {
            return false;
        }
        if (definition.scope) {
            if (!definition.scope.isInScope(environmentProvider)) {
                return false;
            }
        }
        // If we get here, the definition is relevant
        return true;
    };
    CampaignManager.isDateInRangeWithDefinition = function (date, definition) {
        if (!definition) {
            return false;
        }
        date = date ? date : new Date();
        return CampaignManager.isDateInRange(date, 
        // null start dates should be impossible, but if set, should mean the campaign is disabled
        definition.startTime ? definition.startTime : Utils.getDistantFuture(), definition.endTime);
    };
    // @Override
    CampaignManager.prototype.getActiveSurveys = function () {
        var surveys = {};
        for (var key in this.campaignStates) {
            if (this.campaignStates.hasOwnProperty(key)) {
                var state = this.campaignStates[key];
                if (!state.IsCandidate) {
                    continue;
                }
                // This is a requirement because we keep some otherwise "stale" campaigns around for the save routine
                var definition = this.campaignDefinitions[state.CampaignId];
                if (!definition) {
                    continue;
                }
                var survey = CampaignSurveyFactory_1.CampaignSurveyFactory.makeSurvey(state, definition.governedChannelType, definition.surveyTemplate, this.stringProvider, definition.additionalDataRequested);
                if (!survey) {
                    continue;
                }
                surveys[survey.getSurveyInfo().getId()] = survey;
            }
        }
        return surveys;
    };
    // @Override
    CampaignManager.prototype.onCampaignSurveyActivated = function (campaignId, takenDate) {
        var state = this.campaignStates[campaignId];
        if (!state) {
            return;
        }
        takenDate = takenDate ? takenDate : new Date();
        state.markCurrentSurveyTakenOnDate(takenDate);
        this.saveCampaignState();
    };
    CampaignManager.prototype.getCampaignStates = function () {
        return this.campaignStates;
    };
    CampaignManager.prototype.getCampaignDefinitions = function () {
        return this.campaignDefinitions;
    };
    // region ISurveyClient methods
    // @Override
    CampaignManager.prototype.onSurveyActivated = function (surveyInfo) {
        if (!surveyInfo) {
            return;
        }
        this.onCampaignSurveyActivated(surveyInfo.getBackEndId(), new Date());
    };
    // @Override
    CampaignManager.prototype.refreshSurveyDefinitions = function (channelTypes) {
        this.refreshSurveyDefinitionsPrivate(channelTypes, new Date());
    };
    // @Override
    CampaignManager.prototype.getAppSurveys = function () {
        return this.getActiveSurveys();
    };
    // endregion
    CampaignManager.prototype.refreshSurveyDefinitionsPrivate = function (channelTypes, date) {
        this.campaignStates = {};
        this.campaignDefinitions = {};
        this.loadAndFilterCampaignData(date, channelTypes);
        this.evaluateCampaigns(date);
        this.saveCampaignState();
    };
    /**
     * Load and filter the campaigns definitions and states
     */
    CampaignManager.prototype.loadAndFilterCampaignData = function (currentDate, channelTypes) {
        currentDate = currentDate ? currentDate : new Date();
        var loadedDefinitionsMap = {};
        var loadedDefinitions = this.definitionProvider.load();
        // Load filtered campaign definitions
        for (var key in loadedDefinitions) {
            if (loadedDefinitions.hasOwnProperty(key)) {
                var definition = loadedDefinitions[key];
                loadedDefinitionsMap[definition.campaignId] = definition;
                if (channelTypes && (channelTypes.indexOf(definition.governedChannelType) < 0)) {
                    continue;
                }
                if (!CampaignManager.isCampaignInScope(definition, currentDate, this.environmentProvider)) {
                    continue;
                }
                this.campaignDefinitions[definition.campaignId] = definition;
            }
        }
        // Load campaign state, filtering out the expired definitions
        var loadedStates = this.stateProvider.load();
        var staleLoadedStates = [];
        for (var key in loadedStates) {
            if (loadedStates.hasOwnProperty(key)) {
                var state = loadedStates[key];
                if (!this.campaignDefinitions.hasOwnProperty(state.CampaignId)) {
                    staleLoadedStates.push(state);
                }
                this.campaignStates[state.CampaignId] = state;
            }
        }
        /*
         * Stale State data cleanup
         * State needs to be cleaned up when:
         * 1) The campaign has expired
         * 2) The campaign is no longer present in the definitions (think ECS or other outages or very old expirations)
         *    In this case the state should still be cleaned up on it's reelection date
         * 3) When the user is out of scope (for an otherwise active campaign) and is up for nomination

         * This optimizes the user experience in case the campaign pops up or gets renewed when we would have preferred the user remain in cool down

         * 2&3 are basically the same, and 1 is a special case optimization on top of 2&3 for earlier clean up

         * To do 2 & 3, we just look at states with no matching definition (after filtering), and reject them if they are past their nomination period
         * To do 1, we just need to keep a list/hash of the definitions that we filtered out this load cycle, specifically for expiration dates, and bypass
         * the cool down "wait" for these specifically

         * For now, allowing some "grace" for "missing"/"blippy" campaign definitions (in case they pop in and out of ECS) by deferring missing
         * deletion by a delay-time specified by the original campaign.
         */
        for (var key in staleLoadedStates) {
            if (staleLoadedStates.hasOwnProperty(key)) {
                var state = staleLoadedStates[key];
                if (!state) {
                    continue;
                }
                var definition = loadedDefinitionsMap[state.CampaignId];
                var shouldRemove = false;
                if (!definition) {
                    if (state.LastNominationTimeUtc.getTime() <= Utils.subtractSecondsWithoutOverflow(currentDate, state.DeleteAfterSecondsWhenStale).getTime()) {
                        shouldRemove = true;
                    }
                }
                else if (CampaignManager.isStateUpForNomination(state, definition, currentDate, this.currentBuildNumber)) {
                    shouldRemove = true;
                }
                // The next time we write to storage, these will be removed
                if (shouldRemove) {
                    delete this.campaignStates[state.CampaignId];
                }
            }
        }
    };
    /**
     * Given the loaded campaign definitions and states from previous sessions, run anything up for nomination
     */
    CampaignManager.prototype.evaluateCampaigns = function (currentDate) {
        // Loop through campaigns definitions, and update their state if necessary
        currentDate = currentDate ? currentDate : new Date();
        for (var key in this.campaignDefinitions) {
            if (this.campaignDefinitions.hasOwnProperty(key)) {
                var definition = this.campaignDefinitions[key];
                var state = this.campaignStates[definition.campaignId];
                if (!state || CampaignManager.isStateUpForNomination(state, definition, currentDate, this.currentBuildNumber)) {
                    var lastSurveyId = state ? state.LastSurveyId : "";
                    var lastSurveyStartTime = state ? state.LastSurveyStartTimeUtc : Utils.getDistantPast();
                    var lastSurveyExpirationTime = state ? state.LastSurveyExpirationTimeUtc : Utils.getDistantPast();
                    var lastSurveyActivatedTime = state ? state.LastSurveyActivatedTimeUtc : Utils.getDistantPast();
                    // Run the nomination
                    var isCandidate = (state && state.ForceCandidacy) || definition.nominationScheme.evaluateNominationRules();
                    if (isCandidate) {
                        // Make new survey properties for the next call to get the active surveys
                        lastSurveyId = Utils.guid();
                        lastSurveyStartTime = definition.nominationScheme.calculateSurveyStartTimeFromDate(currentDate);
                        lastSurveyExpirationTime = definition.nominationScheme.calculateSurveyExpirationTimeFromSurveyStartTime(lastSurveyStartTime);
                    }
                    var newState = new CampaignStateProvider_1.CampaignState(definition.campaignId, currentDate, this.currentBuildNumber, definition.nominationScheme.getActiveSurveyTimeIntervalSeconds(), false, isCandidate, false, lastSurveyActivatedTime, lastSurveyId, lastSurveyStartTime, lastSurveyExpirationTime);
                    // Save the new state to our local cache
                    this.campaignStates[newState.CampaignId] = newState;
                }
            }
        }
    };
    CampaignManager.prototype.saveCampaignState = function () {
        // Sort by campaignId, ascending for uniformity
        var states = Utils.makeArrayFromObjectValuesSortedByKeyString(this.campaignStates);
        this.stateProvider.save(states);
    };
    return CampaignManager;
}());
exports.CampaignManager = CampaignManager;

},{"../Utils":36,"./CampaignDefinitionProvider":12,"./CampaignStateProvider":14,"./CampaignSurveyFactory":15}],14:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var IFloodgateStorageProvider = require("../Api/IFloodgateStorageProvider");
var Utils = require("../Utils");
var CampaignState = /** @class */ (function () {
    function CampaignState(campaignId, lastNominationTime, lastNominationBuildNumber, deleteAfterSecondsWhenStale, ForceCandidacy, isCandidate, didCandidateTriggerSurvey, lastSurveyActivatedTime, lastSurveyId, lastSurveyStartTime, lastSurveyExpirationTime) {
        this.CampaignId = campaignId;
        this.LastNominationTimeUtc = lastNominationTime;
        this.LastNominationBuildNumber = lastNominationBuildNumber;
        this.DeleteAfterSecondsWhenStale = deleteAfterSecondsWhenStale;
        this.ForceCandidacy = ForceCandidacy;
        this.IsCandidate = isCandidate;
        this.DidCandidateTriggerSurvey = didCandidateTriggerSurvey;
        this.LastSurveyActivatedTimeUtc = lastSurveyActivatedTime;
        this.LastSurveyId = lastSurveyId;
        this.LastSurveyStartTimeUtc = lastSurveyStartTime;
        this.LastSurveyExpirationTimeUtc = lastSurveyExpirationTime;
        if (!this.validate()) {
            throw new Error("Constructor arguments are not valid");
        }
    }
    /**
     * Method to deserialize a JSON object to class object
     * @param input: JSON object
     * Returns class object
     */
    CampaignState.deserialize = function (input) {
        var result;
        if (!input) {
            return null;
        }
        try {
            result = new CampaignState(input.CampaignId, input.LastNominationTimeUtc, input.LastNominationBuildNumber, input.DeleteAfterSecondsWhenStale, false, // ForceCandidacy
            input.IsCandidate, input.DidCandidateTriggerSurvey, input.LastSurveyActivatedTimeUtc, input.LastSurveyId, input.LastSurveyStartTimeUtc, input.LastSurveyExpirationTimeUtc);
        }
        catch (e) {
            // TODO(gachoi) Log parsing failed
            return null;
        }
        return result;
    };
    CampaignState.prototype.validate = function () {
        if (!this.CampaignId || !Utils.isString(this.CampaignId)) {
            return false;
        }
        if (Utils.isNullOrUndefined(this.LastNominationBuildNumber)
            || !Utils.isString(this.LastNominationBuildNumber)) {
            return false;
        }
        if (!Utils.isNumber(this.DeleteAfterSecondsWhenStale) || this.DeleteAfterSecondsWhenStale < 0) {
            return false;
        }
        if (!Utils.isBoolean(this.IsCandidate) || !Utils.isBoolean(this.DidCandidateTriggerSurvey)) {
            return false;
        }
        if (this.IsCandidate) {
            // Disallow the following null's if isCandidate == true
            if (Utils.isNullOrUndefined(this.LastSurveyStartTimeUtc) || Utils.isNullOrUndefined(this.LastSurveyExpirationTimeUtc)) {
                return false;
            }
            // LastSurveyId could be ""
            if (!Utils.isString(this.LastSurveyId)) {
                return false;
            }
        }
        if (this.DidCandidateTriggerSurvey) {
            // Disallow the following null's if didCandidateTriggerSurvey == true
            if (Utils.isNullOrUndefined(this.LastSurveyActivatedTimeUtc)) {
                return false;
            }
        }
        if (Utils.isNullOrUndefined(this.LastSurveyId)) {
            this.LastSurveyId = "";
        }
        else if (!Utils.isString(this.LastSurveyId)) {
            return false;
        }
        // LastNominationTime does not allow null
        if (Utils.isUtcDatetimeString(this.LastNominationTimeUtc)) {
            this.LastNominationTimeUtc = Utils.stringToDate(this.LastNominationTimeUtc);
            // invalidate if it's not a Date object
        }
        else if (!Utils.isDate(this.LastNominationTimeUtc)) {
            return false;
        }
        // Set value to distance past if value not provided
        if (Utils.isNullOrUndefined(this.LastSurveyActivatedTimeUtc)) {
            this.LastSurveyActivatedTimeUtc = Utils.getDistantPast();
            // check if it's UTC date time string, possibly coming from deserialize method
        }
        else if (Utils.isUtcDatetimeString(this.LastSurveyActivatedTimeUtc)) {
            this.LastSurveyActivatedTimeUtc = Utils.stringToDate(this.LastSurveyActivatedTimeUtc);
            // invalidate if it's not a Date object
        }
        else if (!Utils.isDate(this.LastSurveyActivatedTimeUtc)) {
            return false;
        }
        // Set value to distance past if value not provided
        if (Utils.isNullOrUndefined(this.LastSurveyStartTimeUtc)) {
            this.LastSurveyStartTimeUtc = Utils.getDistantPast();
            // check if it's string, possibly coming from deserialize method
        }
        else if (Utils.isUtcDatetimeString(this.LastSurveyStartTimeUtc)) {
            this.LastSurveyStartTimeUtc = Utils.stringToDate(this.LastSurveyStartTimeUtc);
            // invalidate if it's not a Date object
        }
        else if (!Utils.isDate(this.LastSurveyStartTimeUtc)) {
            return false;
        }
        // Set value to distance past if value not provided
        if (Utils.isNullOrUndefined(this.LastSurveyExpirationTimeUtc)) {
            this.LastSurveyExpirationTimeUtc = Utils.getDistantPast();
            // check if it's string, possibly coming from deserialize method
        }
        else if (Utils.isUtcDatetimeString(this.LastSurveyExpirationTimeUtc)) {
            this.LastSurveyExpirationTimeUtc = Utils.stringToDate(this.LastSurveyExpirationTimeUtc);
        }
        else if (!Utils.isDate(this.LastSurveyExpirationTimeUtc)) {
            return false;
        }
        return true;
    };
    /**
     * Record that the current survey was taken on this date
     *
     * @param date date
     */
    CampaignState.prototype.markCurrentSurveyTakenOnDate = function (date) {
        this.DidCandidateTriggerSurvey = true;
        this.LastSurveyActivatedTimeUtc = date != null ? date : new Date();
    };
    CampaignState.prototype.getCooldownStartDate = function () {
        if (!this.IsCandidate) {
            return this.LastNominationTimeUtc;
        }
        if (this.DidCandidateTriggerSurvey) {
            return this.LastSurveyActivatedTimeUtc;
        }
        // In practice this wil be equal to lastNominationTime, but
        // distribution models like a ramp effectively cause us to
        // shift our "effective nomination date" forward with the survey start date
        return this.LastSurveyStartTimeUtc;
    };
    return CampaignState;
}());
exports.CampaignState = CampaignState;
/**
 * Class representing what is stored in the file.
 */
var FileData = /** @class */ (function () {
    function FileData() {
    }
    return FileData;
}());
var FileBasedCampaignStateProvider = /** @class */ (function () {
    function FileBasedCampaignStateProvider(storage) {
        if (!storage) {
            throw new Error("storage must not be null");
        }
        this.storage = storage;
    }
    // @Override
    FileBasedCampaignStateProvider.prototype.load = function () {
        var readString = this.storage.read(IFloodgateStorageProvider.FileType.CampaignStates);
        if (!readString) {
            return [];
        }
        var fileData;
        try {
            fileData = JSON.parse(readString);
        }
        catch (e) {
            // TODO(gachoi) Log parsing failed
            return [];
        }
        var result = [];
        if (fileData && fileData.CampaignStates) {
            fileData.CampaignStates.forEach(function (state) {
                var newState = CampaignState.deserialize(state);
                if (newState) {
                    result.push(newState);
                }
            });
        }
        return result;
    };
    // @Override
    FileBasedCampaignStateProvider.prototype.save = function (campaignStates) {
        if (!campaignStates) {
            return;
        }
        var fileData = new FileData();
        fileData.CampaignStates = campaignStates;
        var writeString = JSON.stringify(fileData);
        this.storage.write(IFloodgateStorageProvider.FileType.CampaignStates, writeString);
    };
    return FileBasedCampaignStateProvider;
}());
exports.FileBasedCampaignStateProvider = FileBasedCampaignStateProvider;

},{"../Api/IFloodgateStorageProvider":7,"../Utils":36}],15:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var SurveyEvents_1 = require("../SurveyEvents");
var FpsSurvey = require("../Surveys/FpsSurvey");
var NlqsSurvey = require("../Surveys/NlqsSurvey");
var NpsSurvey = require("../Surveys/NpsSurvey");
var SurveyDataSource = require("../Surveys/SurveyDataSource");
var Utils = require("../Utils");
var CampaignDefinitionProvider_1 = require("./CampaignDefinitionProvider");
/**
 * Contains methods to take a campaign definition + state and generate an ISurvey
 */
var CampaignSurveyFactory = /** @class */ (function () {
    function CampaignSurveyFactory() {
    }
    // region Survey methods
    CampaignSurveyFactory.makeSurvey = function (state, governedChannelType, surveyModel, stringProvider, additionalDataRequested) {
        if (!state || !surveyModel || !stringProvider) {
            return null;
        }
        if (surveyModel instanceof CampaignDefinitionProvider_1.CampaignSurveyTemplateNps5PointStatic) {
            return NpsSurvey.make5Point(CampaignSurveyFactory.makeSurveyDataSourceData(state, governedChannelType, surveyModel, additionalDataRequested), stringProvider);
        }
        else if (surveyModel instanceof CampaignDefinitionProvider_1.CampaignSurveyTemplateNps11PointStatic) {
            return NpsSurvey.make11Point(CampaignSurveyFactory.makeSurveyDataSourceData(state, governedChannelType, surveyModel, additionalDataRequested), stringProvider);
        }
        else if (surveyModel instanceof CampaignDefinitionProvider_1.CampaignSurveyTemplateFps) {
            return FpsSurvey.makeFps(CampaignSurveyFactory.makeSurveyDataSourceData(state, governedChannelType, surveyModel, additionalDataRequested), stringProvider, surveyModel);
        }
        else if (surveyModel instanceof CampaignDefinitionProvider_1.CampaignSurveyTemplateNlqs) {
            return NlqsSurvey.makeNlqs(CampaignSurveyFactory.makeSurveyDataSourceData(state, governedChannelType, surveyModel, additionalDataRequested), stringProvider, surveyModel);
        }
        else if (surveyModel instanceof CampaignDefinitionProvider_1.CampaignSurveyTemplateNps) {
            return NpsSurvey.makeCustom(CampaignSurveyFactory.makeSurveyDataSourceData(state, governedChannelType, surveyModel, additionalDataRequested), stringProvider, surveyModel);
        }
        else {
            return null;
        }
    };
    CampaignSurveyFactory.makeSurveyDataSourceData = function (state, governedChannelType, surveyModel, additionalDataRequested) {
        if (!state || !surveyModel) {
            return null;
        }
        var surveyData = new SurveyDataSource.SurveyDataSourceData();
        surveyData.activationEvent = CampaignSurveyFactory.makeEvent(state, surveyModel.activationEvent);
        surveyData.id = state.LastSurveyId;
        surveyData.backEndIdentifier = state.CampaignId;
        surveyData.expirationTimeUtc = Utils.dateToShortUtcString(state.LastSurveyExpirationTimeUtc);
        surveyData.governedChannelType = governedChannelType;
        surveyData.startTimeUtc = Utils.dateToShortUtcString(state.LastSurveyStartTimeUtc);
        surveyData.additionalDataRequested = additionalDataRequested || [];
        return surveyData;
    };
    // endregion
    // region Event methods
    CampaignSurveyFactory.makeCountedActivityEventData = function (eventModel) {
        if (!eventModel) {
            return null;
        }
        var eventData = new SurveyEvents_1.CountedActivityEventData();
        eventData.activity = eventModel.activity;
        eventData.count = eventModel.count;
        eventData.isAggregate = eventModel.isAggregate;
        return eventData;
    };
    CampaignSurveyFactory.makeCountedActivityEvent = function (state, eventModel) {
        if (!state || !eventModel) {
            return null;
        }
        var eventData = CampaignSurveyFactory.makeCountedActivityEventData(eventModel);
        if (!eventData) {
            return null;
        }
        return new SurveyEvents_1.CountedActivityEvent(eventData);
    };
    CampaignSurveyFactory.makeCountedActivitySequenceEvent = function (state, eventModel) {
        if (!state || !eventModel) {
            return null;
        }
        var sequenceEventData = new SurveyEvents_1.CountedActivitySequenceEventData();
        sequenceEventData.sequence = [];
        for (var _i = 0, _a = eventModel.sequence; _i < _a.length; _i++) {
            var event_1 = _a[_i];
            var eventData = CampaignSurveyFactory.makeCountedActivityEventData(event_1);
            if (!eventData) {
                return null;
            }
            sequenceEventData.sequence.push(eventData);
        }
        return new SurveyEvents_1.CountedActivitySequenceEvent(sequenceEventData);
    };
    CampaignSurveyFactory.makeEvent = function (state, eventModel) {
        if (eventModel instanceof CampaignDefinitionProvider_1.CampaignSurveyEventCountedActivity) {
            return CampaignSurveyFactory.makeCountedActivityEvent(state, eventModel);
        }
        else if (eventModel instanceof CampaignDefinitionProvider_1.CampaignSurveyEventCountedActivitySequence) {
            return CampaignSurveyFactory.makeCountedActivitySequenceEvent(state, eventModel);
        }
        else {
            return null;
        }
    };
    return CampaignSurveyFactory;
}());
exports.CampaignSurveyFactory = CampaignSurveyFactory;

},{"../SurveyEvents":28,"../Surveys/FpsSurvey":32,"../Surveys/NlqsSurvey":33,"../Surveys/NpsSurvey":34,"../Surveys/SurveyDataSource":35,"../Utils":36,"./CampaignDefinitionProvider":12}],16:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var IFloodgateStorageProvider = require("./Api/IFloodgateStorageProvider");
var CampaignDefinitionProvider_1 = require("./Campaign/CampaignDefinitionProvider");
var CampaignManager_1 = require("./Campaign/CampaignManager");
var CampaignStateProvider_1 = require("./Campaign/CampaignStateProvider");
var FloodgateSettings_1 = require("./FloodgateSettings");
var GovernedChannelStateProvider_1 = require("./GovernedChannelStateProvider");
var Governor_1 = require("./Governor");
var SurveyActivityListener = require("./SurveyActivityListener");
var SurveyStatCollectionActivation_1 = require("./SurveyStatCollectionActivation");
var SurveyStatCollectionEventActivity_1 = require("./SurveyStatCollectionEventActivity");
// Telemetry logger with no-op logger
var DefaultFloodgateTelemetryLogger = /** @class */ (function () {
    function DefaultFloodgateTelemetryLogger() {
    }
    // @Override
    DefaultFloodgateTelemetryLogger.prototype.log_TriggerMet = function (campaignId, surveyId, surveyType) { };
    // @Override
    DefaultFloodgateTelemetryLogger.prototype.log_UserSelected = function (campaignId, surveyId, surveyType) { };
    // @Override
    DefaultFloodgateTelemetryLogger.prototype.log_CampaignLoad_Failed = function (errorMessage) { };
    return DefaultFloodgateTelemetryLogger;
}());
/**
 * Floodgate Engine class.  The main wiring hub and the brains responsible for
 * linking together the survey definitions, governance, activity tracking, and
 * survey launchers.  Only one-instance-at-a-time of these should be created
 * per app session.
 */
var FloodgateEngine = /** @class */ (function () {
    function FloodgateEngine(surveyClient, activityListener, launcherFactory, onSurveyActivatedCallback, storage, governor) {
        this.candidateSurveys = {};
        this.launchedSurveys = {};
        this.launchedLaunchers = [];
        if (!surveyClient) {
            throw new Error("surveyClient must not be null");
        }
        if (!activityListener) {
            throw new Error("activityListener must not be null");
        }
        if (!launcherFactory) {
            throw new Error("launcherFactory must not be null");
        }
        if (!onSurveyActivatedCallback) {
            throw new Error("onSurveyActivatedCallback must not be null");
        }
        if (!storage) {
            throw new Error("storage must not be null");
        }
        if (!governor) {
            throw new Error("governor must not be null");
        }
        this.surveyClient = surveyClient;
        this.activityListener = activityListener;
        this.launcherFactory = launcherFactory;
        this.onSurveyActivatedCallback = onSurveyActivatedCallback;
        this.storage = storage;
        this.governor = governor;
        this.started = false;
        this.loggedFirstStart = false;
        // Initialize our list to a valid, empty collection
        this.setPendingSurveys(null);
        // If the listener was pre-configured with survey for some reason, clear it now
        this.activityListener.clearSurveys();
        // Link ourselves with the listener
        var thisObj = this; // Save current object in a variable to allow access from callback.
        this.activityListener.setCallback({
            run: function (survey) {
                thisObj.onSurveyActivated(survey);
            },
        });
    }
    FloodgateEngine.setTelemetryLogger = function (telemetryLogger) {
        if (!telemetryLogger) {
            throw new Error("telemetryLogger must not be null");
        }
        FloodgateEngine.telemetryLogger = telemetryLogger;
    };
    FloodgateEngine.getTelemetryLogger = function () {
        return FloodgateEngine.telemetryLogger;
    };
    FloodgateEngine.make = function (buildVersion, launcherFactory, onSurveyActivatedCallback, storageProvider, stringProvider, environmentProvider) {
        return new FloodgateEngine(new CampaignManager_1.CampaignManager(new CampaignStateProvider_1.FileBasedCampaignStateProvider(storageProvider), new CampaignDefinitionProvider_1.FileSystemCampaignDefinitionProvider(storageProvider), stringProvider, environmentProvider, buildVersion, new Date()), new SurveyActivityListener({ run: function (survey) { } }), launcherFactory, onSurveyActivatedCallback, storageProvider, new Governor_1.Governor(new GovernedChannelStateProvider_1.FileBasedGovernedChannelStateProvider(storageProvider)));
    };
    /**
     * Save all internal stats and floodgateSettings (merging with existing file contents), without stopping the engine.
     */
    FloodgateEngine.prototype.mergeAndSave = function () {
        this.saveSettings();
        this.saveSurveyActivationHistory();
        this.saveSurveyEventActivityHistory();
    };
    /**
     * Start the engine.  Checks feature enable state, causes survey definitions to be read, and tracked activities to be set on the listener.
     */
    FloodgateEngine.prototype.start = function () {
        if (this.started) {
            return;
        }
        // Load up the general floodgateSettings
        this.floodgateSettings = FloodgateSettings_1.FloodgateSettings.fromJson(this.readString(IFloodgateStorageProvider.FileType.FloodgateSettings));
        // Load up the prior survey history and prior event counts
        this.previousSurveyActivationStats =
            SurveyStatCollectionActivation_1.SurveyStatCollectionActivation.fromJson(this.readString(IFloodgateStorageProvider.FileType.SurveyActivationStats));
        this.previousSurveyEventActivityStats =
            SurveyStatCollectionEventActivity_1.SurveyStatCollectionEventActivity.fromJson(this.readString(IFloodgateStorageProvider.FileType.SurveyEventActivityStats));
        // Make sure we've loaded the current survey definitions
        var channels = this.governor.getAvailableChannelData();
        var channelTypes = [];
        channels.forEach(function (channel) {
            if (channel) {
                channelTypes.push(channel.getType());
            }
        });
        this.surveyClient.refreshSurveyDefinitions(channelTypes);
        // Update our survey list, and push that through to the listener
        this.setPendingSurveys(this.surveyClient.getAppSurveys());
        this.updateActivityListenerWithCurrentSurveyDefinitions();
        // Mark us as started
        this.started = true;
        // Log our first start (aka floodgate boot) event
        if (!this.loggedFirstStart) {
            this.loggedFirstStart = true;
            this.getActivityListener().logActivity("FloodgateFirstStart");
        }
    };
    /**
     * Stop the engine.  Causes tracked activities to be cleared and any in-progress counters not otherwise saved to be thrown out.
     */
    FloodgateEngine.prototype.stop = function () {
        if (!this.started) {
            return;
        }
        this.mergeAndSave();
        // Clear our Survey list, and push that through to the listener
        this.setPendingSurveys(null);
        this.updateActivityListenerWithCurrentSurveyDefinitions();
        this.started = false;
    };
    /**
     * Gets the IActivityListener logging interface for callers that want to log directly rather than through telemetry
     */
    FloodgateEngine.prototype.getActivityListener = function () {
        return this.activityListener;
    };
    FloodgateEngine.prototype.saveSettings = function () {
        this.storage.fileLock(IFloodgateStorageProvider.FileType.FloodgateSettings);
        try {
            this.writeString(IFloodgateStorageProvider.FileType.FloodgateSettings, FloodgateSettings_1.FloodgateSettings.toJson(this.floodgateSettings));
        }
        finally {
            this.storage.fileUnlock(IFloodgateStorageProvider.FileType.FloodgateSettings);
        }
    };
    FloodgateEngine.prototype.saveSurveyActivationHistory = function () {
        this.storage.fileLock(IFloodgateStorageProvider.FileType.SurveyActivationStats);
        try {
            var statCollection = SurveyStatCollectionActivation_1.SurveyStatCollectionActivation.fromJson(this.readString(IFloodgateStorageProvider.FileType.SurveyActivationStats));
            // Build the update collection
            var updateCollection = new SurveyStatCollectionActivation_1.SurveyStatCollectionActivation();
            for (var key in this.launchedSurveys) {
                if (this.launchedSurveys.hasOwnProperty(key)) {
                    var stats = new SurveyStatCollectionActivation_1.SurveyActivationStats();
                    var survey = this.launchedSurveys[key];
                    stats.Type = survey.getType();
                    stats.ExpirationTimeUtc = survey.getSurveyInfo().getExpirationTimeUtc();
                    stats.ActivationTimeUtc = new Date();
                    // Make this part of the update list
                    updateCollection.addStats(survey.getSurveyInfo().getId(), stats);
                }
            }
            // Actually merge our updates into the full collection
            statCollection.accumulate(updateCollection);
            this.writeString(IFloodgateStorageProvider.FileType.SurveyActivationStats, SurveyStatCollectionActivation_1.SurveyStatCollectionActivation.toJson(statCollection));
            // Make sure to keep our internal collection consistent with what we just wrote
            this.previousSurveyActivationStats = statCollection;
        }
        finally {
            this.storage.fileUnlock(IFloodgateStorageProvider.FileType.SurveyActivationStats);
        }
    };
    FloodgateEngine.prototype.saveSurveyEventActivityHistory = function () {
        this.storage.fileLock(IFloodgateStorageProvider.FileType.SurveyEventActivityStats);
        try {
            var statCollection = SurveyStatCollectionEventActivity_1.SurveyStatCollectionEventActivity.fromJson(this.readString(IFloodgateStorageProvider.FileType.SurveyEventActivityStats));
            var now = new Date();
            // Fill out our list of updates
            var updateCollection = new SurveyStatCollectionEventActivity_1.SurveyStatCollectionEventActivity();
            var _loop_1 = function (key) {
                if (this_1.candidateSurveys.hasOwnProperty(key)) {
                    var stats = new SurveyStatCollectionEventActivity_1.SurveyEventActivityStats();
                    var survey = this_1.candidateSurveys[key];
                    if (!survey.getSurveyInfo().isActiveForDate(now)) {
                        return "continue";
                    }
                    stats.ExpirationTimeUtc = survey.getSurveyInfo().getExpirationTimeUtc();
                    // Get the activities which are aggregated, if there aren't any continue
                    var allActivities = survey.getSurveyInfo().getActivationEvent().getTrackingSet();
                    var aggregateActivities_1 = [];
                    allActivities.getList().forEach(function (data) {
                        if (data && data.getIsAggregate()) {
                            aggregateActivities_1.push(data.getActivity());
                        }
                    });
                    if (aggregateActivities_1.length === 0) {
                        return "continue";
                    }
                    stats.Counts = new Array(aggregateActivities_1.length);
                    // Save off the counts we've added for this session
                    for (var i = 0; i < aggregateActivities_1.length; i++) {
                        stats.Counts[i] = this_1.activityListener.moveSessionCountIntoBaseCount(aggregateActivities_1[i]);
                    }
                    // Make this part of the update list
                    updateCollection.addStats(survey.getSurveyInfo().getId(), stats);
                }
            };
            var this_1 = this;
            for (var key in this.candidateSurveys) {
                _loop_1(key);
            }
            // Actually merge our updates into the full collection
            statCollection.accumulate(updateCollection);
            this.writeString(IFloodgateStorageProvider.FileType.SurveyEventActivityStats, SurveyStatCollectionEventActivity_1.SurveyStatCollectionEventActivity.toJson(statCollection));
            // Make sure to keep our internal collection consistent with what we just wrote
            this.previousSurveyEventActivityStats = statCollection;
        }
        finally {
            this.storage.fileUnlock(IFloodgateStorageProvider.FileType.SurveyEventActivityStats);
        }
    };
    FloodgateEngine.prototype.setPendingSurveys = function (pendingSurveys) {
        if (!pendingSurveys) {
            // Turn null into a valid empty collection
            this.candidateSurveys = {};
        }
        else {
            this.candidateSurveys = pendingSurveys;
        }
    };
    FloodgateEngine.prototype.updateActivityListenerWithCurrentSurveyDefinitions = function () {
        // Get a vector of Surveys from our id-based map
        var surveyList = new Array();
        for (var key in this.candidateSurveys) {
            if (this.candidateSurveys.hasOwnProperty(key)) {
                var survey = this.candidateSurveys[key];
                // Skip over any candidate surveys that have been previously completed
                if (this.previousSurveyActivationStats.getBySurveyId(survey.getSurveyInfo().getId())) {
                    // TODO (gachoi) log that Skipping previously activated survey
                    continue;
                }
                if (!survey.getSurveyInfo().isActiveForDate(new Date())) {
                    continue;
                }
                FloodgateEngine.telemetryLogger.log_UserSelected(survey.getSurveyInfo().getBackEndId(), survey.getSurveyInfo().getId(), survey.getType());
                surveyList.push(survey);
            }
        }
        this.activityListener.setSurveys(surveyList, this.previousSurveyEventActivityStats);
    };
    FloodgateEngine.prototype.onSurveyActivated = function (survey) {
        FloodgateEngine.telemetryLogger.log_TriggerMet(survey.getSurveyInfo().getBackEndId(), survey.getSurveyInfo().getId(), survey.getType());
        var launchSurvey = false;
        var governedChannelType = survey.getSurveyInfo().getGovernedChannelType();
        // Figure out if the activated survey is still relevant
        if (!this.candidateSurveys[survey.getSurveyInfo().getId()]) {
            // Survey is no longer relevant but was activated. Suppress it.
            // TODO(gachoi) log INFO Survey was activated but is no longer registered
        }
        else if (!survey.getSurveyInfo().isActiveForDate(new Date())) {
            // Survey is no longer active (e.g. it was when we registered it but it has now expired)
        }
        else if (!this.governor.isChannelOpen(governedChannelType)) {
            // Channel has closed, suppress the survey
        }
        else {
            if (Object.keys(this.launchedSurveys).length === 0) {
                // for now we only support launching one survey per session
                // Track this survey activation for the launch history tracker
                this.launchedSurveys[survey.getSurveyInfo().getId()] = survey;
                launchSurvey = true;
            }
        }
        // At this point, regardless of whether or not the survey is still relevant, we should flush out the stats, and shut off further survey launches
        this.mergeAndSave();
        this.activityListener.clearSurveys();
        // Actually launch the survey
        if (launchSurvey) {
            this.governor.startChannelCooldown(governedChannelType);
            this.surveyClient.onSurveyActivated(survey.getSurveyInfo());
            this.launchLauncher(survey);
        }
    };
    FloodgateEngine.prototype.readString = function (fileType) {
        return this.storage.read(fileType);
    };
    FloodgateEngine.prototype.writeString = function (fileType, str) {
        this.storage.write(fileType, str);
    };
    FloodgateEngine.prototype.launchLauncher = function (survey) {
        var launcher = this.launcherFactory.makeSurveyLauncher(survey);
        if (launcher) {
            this.launchedLaunchers.push(launcher);
            this.onSurveyActivatedCallback.onSurveyActivated(launcher);
        }
    };
    // Initialize telemetry logger with no-op logger
    FloodgateEngine.telemetryLogger = new DefaultFloodgateTelemetryLogger();
    return FloodgateEngine;
}());
exports.FloodgateEngine = FloodgateEngine;

},{"./Api/IFloodgateStorageProvider":7,"./Campaign/CampaignDefinitionProvider":12,"./Campaign/CampaignManager":13,"./Campaign/CampaignStateProvider":14,"./FloodgateSettings":17,"./GovernedChannelStateProvider":19,"./Governor":20,"./SurveyActivityListener":24,"./SurveyStatCollectionActivation":30,"./SurveyStatCollectionEventActivity":31}],17:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * General floodgate settings
 */
var FloodgateSettings = /** @class */ (function () {
    function FloodgateSettings() {
    }
    /**
     * Convert to Json
     */
    FloodgateSettings.toJson = function (object) {
        return JSON.stringify(object);
    };
    /**
     * Load from Json
     */
    FloodgateSettings.fromJson = function (json) {
        return JSON.parse(json);
    };
    return FloodgateSettings;
}());
exports.FloodgateSettings = FloodgateSettings;

},{}],18:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Utils = require("./Utils");
var GovernedChannelType;
(function (GovernedChannelType) {
    GovernedChannelType[GovernedChannelType["Standard"] = 0] = "Standard";
    GovernedChannelType[GovernedChannelType["Urgent"] = 1] = "Urgent";
})(GovernedChannelType = exports.GovernedChannelType || (exports.GovernedChannelType = {}));
(function (GovernedChannelType) {
    function getDefault() { return GovernedChannelType.Standard; }
    GovernedChannelType.getDefault = getDefault;
})(GovernedChannelType = exports.GovernedChannelType || (exports.GovernedChannelType = {}));
var GovernedChannel = /** @class */ (function () {
    function GovernedChannel(type, name, cooldownSeconds, cooldownStartTime) {
        if (!Utils.isEnumValue(type, GovernedChannelType)) {
            throw new Error("type is not a valid GovernedChannelType");
        }
        if (!name) {
            throw new Error("name must not be null or empty");
        }
        if (cooldownSeconds < 0) {
            throw new Error("cooldownSeconds must not be negative");
        }
        this.type = type;
        this.name = name;
        this.cooldownSeconds = cooldownSeconds;
        this.setCooldownStartTime(cooldownStartTime);
    }
    GovernedChannel.prototype.setCooldownStartTime = function (cooldownStartTime) {
        // Set the start time
        this.cooldownStartTime = cooldownStartTime;
        if (Utils.isNullOrUndefined(this.cooldownStartTime)) {
            // Null cooldownStartTime means cool down has never been initiated, so set the cooldownEndTime to distant past
            this.cooldownEndTime = Utils.getDistantPast();
        }
        else {
            // Calculate the end time, but don't overflow past max.
            this.cooldownEndTime = Utils.addSecondsWithoutOverflow(this.cooldownStartTime, this.cooldownSeconds);
        }
    };
    // @Override
    GovernedChannel.prototype.isOpen = function () {
        return this.isOpenAtDate(new Date());
    };
    // @Override
    GovernedChannel.prototype.isOpenAtDate = function (date) {
        if (!date) {
            return false;
        }
        return (date > this.cooldownEndTime);
    };
    // @Override
    GovernedChannel.prototype.getType = function () {
        return this.type;
    };
    // @Override
    GovernedChannel.prototype.getName = function () {
        return this.name;
    };
    // @Override
    GovernedChannel.prototype.getCooldownSeconds = function () {
        return this.cooldownSeconds;
    };
    // @Override
    GovernedChannel.prototype.getCooldownStartTime = function () {
        return this.cooldownStartTime;
    };
    // @Override
    GovernedChannel.prototype.getCooldownEndTime = function () {
        return this.cooldownEndTime;
    };
    return GovernedChannel;
}());
exports.GovernedChannel = GovernedChannel;

},{"./Utils":36}],19:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var IFloodgateStorageProvider = require("./Api/IFloodgateStorageProvider");
var GovernedChannel_1 = require("./GovernedChannel");
var Utils = require("./Utils");
var GovernedChannelState = /** @class */ (function () {
    function GovernedChannelState(type, cooldownStartTime) {
        this.ChannelType = type;
        this.CooldownStartTimeUtc = cooldownStartTime;
        if (!this.validate()) {
            throw new Error("Constructor arguments are not valid");
        }
    }
    /**
     * Method to deserialize a JSON object to class object
     * @param input: JSON object
     * Returns class object
     */
    GovernedChannelState.deserialize = function (input) {
        var result;
        if (!input) {
            return null;
        }
        // Validation is handled by GovernedChannelState's constructor
        try {
            result = new GovernedChannelState(input.ChannelType, input.CooldownStartTimeUtc);
        }
        catch (e) {
            // TODO(gachoi) Log parsing failed
            return null;
        }
        return result;
    };
    GovernedChannelState.prototype.validate = function () {
        if (!Utils.isEnumValue(this.ChannelType, GovernedChannel_1.GovernedChannelType)) {
            return false;
        }
        // make it a date object if it's a valid UTC date time value
        if (Utils.isUtcDatetimeString(this.CooldownStartTimeUtc)) {
            this.CooldownStartTimeUtc = Utils.stringToDate(this.CooldownStartTimeUtc);
            // Allow null and bad cooldownStartTime
        }
        else if (Utils.isNullOrUndefined(this.CooldownStartTimeUtc) || !Utils.isDate(this.CooldownStartTimeUtc)) {
            this.CooldownStartTimeUtc = Utils.getDistantPast();
        }
        return true;
    };
    GovernedChannelState.prototype.getType = function () {
        return this.ChannelType;
    };
    GovernedChannelState.prototype.getCooldownStartTime = function () {
        return this.CooldownStartTimeUtc;
    };
    return GovernedChannelState;
}());
exports.GovernedChannelState = GovernedChannelState;
/**
 * Class representing what is stored in the file.
 */
var FileData = /** @class */ (function () {
    function FileData() {
    }
    return FileData;
}());
var FileBasedGovernedChannelStateProvider = /** @class */ (function () {
    function FileBasedGovernedChannelStateProvider(storage) {
        if (!storage) {
            throw new Error("storage must not be null");
        }
        this.storage = storage;
    }
    // @Override
    FileBasedGovernedChannelStateProvider.prototype.load = function () {
        // Load channel state from file using _storageProvider (get back string)
        var readString = this.storage.read(IFloodgateStorageProvider.FileType.GovernedChannelStates);
        if (!readString) {
            return [];
        }
        var fileData;
        try {
            fileData = JSON.parse(readString);
        }
        catch (e) {
            // TODO(gachoi) Log parsing failed
            return [];
        }
        var result = [];
        if (fileData && fileData.ChannelStates) {
            fileData.ChannelStates.forEach(function (state) {
                var newState = GovernedChannelState.deserialize(state);
                if (newState) {
                    result.push(newState);
                }
            });
        }
        return result;
    };
    // @Override
    FileBasedGovernedChannelStateProvider.prototype.save = function (states) {
        if (!states) {
            return;
        }
        var fileData = new FileData();
        fileData.ChannelStates = states;
        var writeString = JSON.stringify(fileData);
        this.storage.write(IFloodgateStorageProvider.FileType.GovernedChannelStates, writeString);
    };
    return FileBasedGovernedChannelStateProvider;
}());
exports.FileBasedGovernedChannelStateProvider = FileBasedGovernedChannelStateProvider;

},{"./Api/IFloodgateStorageProvider":7,"./GovernedChannel":18,"./Utils":36}],20:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GovernedChannel_1 = require("./GovernedChannel");
var GovernedChannelStateProvider_1 = require("./GovernedChannelStateProvider");
var Utils = require("./Utils");
var DefaultChannelData = /** @class */ (function () {
    function DefaultChannelData(name, cooldownSeconds) {
        this.name = name;
        this.cooldownSeconds = cooldownSeconds;
    }
    return DefaultChannelData;
}());
var Governor = /** @class */ (function () {
    function Governor(channelStateProvider) {
        if (!channelStateProvider) {
            throw new Error("channelStateProvider must not be null");
        }
        this.channelStateProvider = channelStateProvider;
        this.loadChannels();
    }
    // @Override
    Governor.prototype.getAvailableChannelData = function () {
        var channelData = [];
        for (var key in this.channels) {
            if (this.channels.hasOwnProperty(key)) {
                var channel = this.channels[key];
                if (channel.isOpen()) {
                    channelData.push(channel);
                }
            }
        }
        return channelData;
    };
    // @Override
    Governor.prototype.isChannelOpen = function (type) {
        if (Utils.isNullOrUndefined(type)) {
            throw new Error("type must not be null");
        }
        return this.channels[type].isOpen();
    };
    // @Override
    Governor.prototype.startChannelCooldown = function (type, date) {
        if (Utils.isNullOrUndefined(type)) {
            throw new Error("type must not be null");
        }
        date = date ? date : new Date();
        // Start the cool down
        this.channels[type].setCooldownStartTime(date);
        // Save the new channel state for future sessions
        this.saveChannelStatesToProvider();
    };
    Governor.prototype.loadChannels = function () {
        // Load up state from previous sessions
        this.loadChannelStatesFromProvider();
        // For any missing channels, init them from scratch
        // There's no straightforward way to iterate enums, we need to iterate through the enum array
        //    filtering out just the numeric enum values (excluding enum names).
        for (var item in GovernedChannel_1.GovernedChannelType) {
            if (GovernedChannel_1.GovernedChannelType.hasOwnProperty(item)) {
                var key = Number(item);
                // skip if key is not numeric enum value, or if already exists
                if (isNaN(key) || this.channels[key]) {
                    continue;
                }
                var defaultData = Governor.defaultChannelData[key];
                var newChannel = new GovernedChannel_1.GovernedChannel(key, defaultData.name, defaultData.cooldownSeconds, null);
                this.channels[key] = newChannel;
            }
        }
    };
    Governor.prototype.loadChannelStatesFromProvider = function () {
        this.channels = [];
        var channelStates = this.channelStateProvider.load();
        for (var key in channelStates) {
            if (channelStates.hasOwnProperty(key)) {
                var channelState = channelStates[key];
                var type = channelState.getType();
                var defaultData = Governor.defaultChannelData[type];
                var newChannel = new GovernedChannel_1.GovernedChannel(type, defaultData.name, defaultData.cooldownSeconds, channelState.getCooldownStartTime());
                this.channels[newChannel.getType()] = newChannel;
            }
        }
    };
    Governor.prototype.saveChannelStatesToProvider = function () {
        // Build up the list of channel states
        var channelStates = [];
        for (var key in this.channels) {
            if (this.channels.hasOwnProperty(key)) {
                var channel = this.channels[key];
                var channelState = new GovernedChannelStateProvider_1.GovernedChannelState(channel.getType(), channel.getCooldownStartTime());
                channelStates.push(channelState);
            }
        }
        this.channelStateProvider.save(channelStates);
    };
    Governor.minute = 60;
    Governor.hour = 60 * Governor.minute;
    Governor.day = 24 * Governor.hour;
    // Array of default values for each channel type. Indexed by the GovernedChannelType enum name.
    Governor.defaultChannelData = [
        new DefaultChannelData(GovernedChannel_1.GovernedChannelType[GovernedChannel_1.GovernedChannelType.Standard], 14 * Governor.day),
        new DefaultChannelData(GovernedChannel_1.GovernedChannelType[GovernedChannel_1.GovernedChannelType.Urgent], 4 * Governor.hour),
    ];
    return Governor;
}());
exports.Governor = Governor;

},{"./GovernedChannel":18,"./GovernedChannelStateProvider":19,"./Utils":36}],21:[function(require,module,exports){
"use strict";
var ISurveyEvent;
(function (ISurveyEvent) {
    var Type;
    (function (Type) {
        // A string to listen to, with a trigger threshold, and potentially cross-session aggregation
        Type[Type["CountedActivity"] = "CountedActivity"] = "CountedActivity";
        // An ordered list of CountedActivities, to be activated in sequence
        Type[Type["CountedActivitySequence"] = "CountedActivitySequence"] = "CountedActivitySequence";
    })(Type = ISurveyEvent.Type || (ISurveyEvent.Type = {}));
})(ISurveyEvent || (ISurveyEvent = {}));
module.exports = ISurveyEvent;

},{}],22:[function(require,module,exports){
"use strict";
var ISurveyInfo;
(function (ISurveyInfo) {
    var LaunchType;
    (function (LaunchType) {
        // No launch type specified, defer to the launcher factory code
        LaunchType[LaunchType["Default"] = "Default"] = "Default";
        // Prefer a notification-based launcher (like the windows toast launcher when present)
        LaunchType[LaunchType["Notification"] = "Notification"] = "Notification";
        // Prefer a modal-dialog based launcher
        LaunchType[LaunchType["Modal"] = "Modal"] = "Modal";
    })(LaunchType = ISurveyInfo.LaunchType || (ISurveyInfo.LaunchType = {}));
    var AdditionalDataType;
    (function (AdditionalDataType) {
        // Request email address
        AdditionalDataType[AdditionalDataType["EmailAddress"] = 0] = "EmailAddress";
    })(AdditionalDataType = ISurveyInfo.AdditionalDataType || (ISurveyInfo.AdditionalDataType = {}));
    ISurveyInfo.DOM_TYPE_TAGNAME = "Type";
    ISurveyInfo.DOM_TYPE_VALUE = "Survey";
    ISurveyInfo.DOM_ID_TAGNAME = "SurveyID";
    ISurveyInfo.JSON_SURVEY_KEYNAME = "survey";
    ISurveyInfo.JSON_ID_KEYNAME = "surveyId";
})(ISurveyInfo || (ISurveyInfo = {}));
module.exports = ISurveyInfo;

},{}],23:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var IndexedTracker = /** @class */ (function () {
    function IndexedTracker() {
    }
    return IndexedTracker;
}());
exports.IndexedTracker = IndexedTracker;

},{}],24:[function(require,module,exports){
"use strict";
var ActivityTracker = require("./ActivityTracker");
var IndexedTracker_1 = require("./IndexedTracker");
var SurveyStatCollectionEventActivity_1 = require("./SurveyStatCollectionEventActivity");
/**
 * This class tracks log calls against named activity strings (matched on strict case-sensitive equality)
 * and calls the provided callback when all activity thresholds for a given survey have been crossed
 *
 * // todo (gachoi): Refactor callback with Promise
 */
var SurveyActivityListener = /** @class */ (function () {
    function SurveyActivityListener(callback) {
        if (!callback) {
            throw new Error("callback must not be null");
        }
        this.trackedActivityMap = {};
        this.callback = callback;
    }
    SurveyActivityListener.prototype.logActivity = function (activityName, increment) {
        if (increment === void 0) { increment = 1; }
        this.logActivity_private(activityName, SurveyActivityListener.LogActionType.Increment, increment, null);
    };
    SurveyActivityListener.prototype.logActivityStartTime = function (activityName, startTime) {
        this.logActivity_private(activityName, SurveyActivityListener.LogActionType.StartTime, 0, startTime);
    };
    SurveyActivityListener.prototype.logActivityStopTime = function (activityName, stopTime) {
        this.logActivity_private(activityName, SurveyActivityListener.LogActionType.StopTime, 0, stopTime);
    };
    SurveyActivityListener.prototype.setSurveys = function (surveys, baseline) {
        if (baseline === void 0) { baseline = new SurveyStatCollectionEventActivity_1.SurveyStatCollectionEventActivity(); }
        if (!surveys || surveys.length === 0 || !baseline) {
            return;
        }
        // Populate a new map based on the passed in surveys, but propagating and tracking activity counts
        // we may have seen against those events
        // NOTE: We will lose activity counts for survey events that are no longer relevant.
        var newMap = new Object();
        for (var _i = 0, surveys_1 = surveys; _i < surveys_1.length; _i++) {
            var survey = surveys_1[_i];
            var trackingSet = survey.getSurveyInfo().getActivationEvent().getTrackingSet();
            // Don't add the survey if any of its events overlap with an already registered survey
            var hasOverlap = false;
            for (var _a = 0, _b = trackingSet.getList(); _a < _b.length; _a++) {
                var trackingData = _b[_a];
                if (newMap.hasOwnProperty(trackingData.getActivity())) {
                    hasOverlap = true;
                    break;
                }
            }
            if (hasOverlap) {
                continue;
            }
            // At this point, the survey's activities are safe to add.
            // Set up the structures we need to transfer baseline counts (from previous sessions) or current counts (from previous trackers)
            // Both vectors must be sorted in the same order as the trackingSet.List items
            var baselineStats = baseline.getBySurveyId(survey.getSurveyInfo().getId());
            var baselineCounts = [trackingSet.getList().length];
            var currentIndexedTrackers = new Array(trackingSet.getList().length);
            var currentBaselineIndex = 0;
            var currentIndex = 0;
            for (var _c = 0, _d = trackingSet.getList(); _c < _d.length; _c++) {
                var trackingData = _d[_c];
                // Baseline stats are only stored for events with "IsAggregate = true"
                baselineCounts[currentIndex] = 0;
                if (trackingData.getIsAggregate() && baselineStats && currentBaselineIndex < baselineStats.Counts.length) {
                    baselineCounts[currentIndex] = baselineStats.Counts[currentBaselineIndex++];
                }
                // Session stats may be available in the previous trackedActivityMap
                // Transfer the old "current session" count to the new tracker
                // Is set to null if not available
                currentIndexedTrackers[currentIndex] = this.trackedActivityMap[trackingData.getActivity()];
                currentIndex++;
            }
            // Make a new tracker and init the counts appropriately.
            var newTracker = new ActivityTracker(trackingSet);
            // If in a future change we start keeping trackers registered past activation, this will change
            newTracker.initCounts(baselineCounts, currentIndexedTrackers, false /*wasActivatedThisSession*/);
            // Setup the indexed trackers
            for (var _e = 0, _f = newTracker.generateActivityIndexList(); _e < _f.length; _e++) {
                var activityIndex = _f[_e];
                var indexedTracker = new IndexedTracker_1.IndexedTracker();
                indexedTracker.index = activityIndex.index;
                indexedTracker.survey = survey;
                indexedTracker.tracker = newTracker;
                // Register the new tracker in our new map
                newMap[activityIndex.activity] = indexedTracker;
            }
        }
        // Set the new map in place of the old
        this.copyObject(this.trackedActivityMap, newMap);
    };
    SurveyActivityListener.prototype.clearSurveys = function () {
        var _this = this;
        Object.getOwnPropertyNames(this.trackedActivityMap).forEach(function (key) {
            delete _this.trackedActivityMap[key];
        });
    };
    SurveyActivityListener.prototype.getCount = function (activity) {
        var indexedTracker;
        indexedTracker = this.trackedActivityMap[activity];
        if (!indexedTracker) {
            return 0;
        }
        return indexedTracker.tracker.getCount(indexedTracker.index);
    };
    SurveyActivityListener.prototype.getSessionCount = function (activity) {
        var indexedTracker;
        indexedTracker = this.trackedActivityMap[activity];
        if (!indexedTracker) {
            return 0;
        }
        return indexedTracker.tracker.getSessionCount(indexedTracker.index);
    };
    /**
     * An atomic get-and-set method.  Returns the current SessionCount, resetting it to zero and adding it into the established baseline
     */
    SurveyActivityListener.prototype.moveSessionCountIntoBaseCount = function (activity) {
        var indexedTracker;
        indexedTracker = this.trackedActivityMap[activity];
        if (!indexedTracker) {
            return 0;
        }
        return indexedTracker.tracker.moveSessionCountIntoBaseCount(indexedTracker.index);
    };
    SurveyActivityListener.prototype.getSurvey = function (activity) {
        var indexedTracker;
        indexedTracker = this.trackedActivityMap[activity];
        if (!indexedTracker) {
            return null;
        }
        return indexedTracker.survey;
    };
    SurveyActivityListener.prototype.setCallback = function (callback) {
        this.callback = callback;
    };
    SurveyActivityListener.prototype.logActivity_private = function (activityName, logType, increment, timestamp) {
        var indexedTracker;
        var result;
        indexedTracker = this.trackedActivityMap[activityName];
        if (!indexedTracker) {
            return;
        }
        switch (logType) {
            case SurveyActivityListener.LogActionType.StartTime: {
                indexedTracker.tracker.startTime(indexedTracker.index, timestamp);
                return;
            }
            case SurveyActivityListener.LogActionType.StopTime: {
                increment = indexedTracker.tracker.stopTime(indexedTracker.index, timestamp);
                // fall through to increment the activity as well.
            }
            case SurveyActivityListener.LogActionType.Increment: {
                break;
            }
            default: {
                return;
            }
        }
        result = indexedTracker.tracker.incrementActivity(indexedTracker.index, increment);
        if (result === ActivityTracker.IncrementResult.AllActivitiesActivated) {
            this.executeCallback(indexedTracker.survey);
        }
    };
    SurveyActivityListener.prototype.executeCallback = function (survey) {
        this.callback.run(survey);
    };
    SurveyActivityListener.prototype.copyObject = function (target, source) {
        Object.keys(source).forEach(function (key) {
            target[key] = source[key];
        });
    };
    return SurveyActivityListener;
}());
(function (SurveyActivityListener) {
    var LogActionType;
    (function (LogActionType) {
        LogActionType[LogActionType["Increment"] = 0] = "Increment";
        LogActionType[LogActionType["StartTime"] = 1] = "StartTime";
        LogActionType[LogActionType["StopTime"] = 2] = "StopTime";
    })(LogActionType = SurveyActivityListener.LogActionType || (SurveyActivityListener.LogActionType = {}));
})(SurveyActivityListener || (SurveyActivityListener = {}));
module.exports = SurveyActivityListener;

},{"./ActivityTracker":2,"./IndexedTracker":23,"./SurveyStatCollectionEventActivity":31}],25:[function(require,module,exports){
"use strict";
var ISurveyComponent = require("./../Api/ISurveyComponent");
var CommentComponent = /** @class */ (function () {
    function CommentComponent(data) {
        if (!data) {
            throw new Error("data must not be null");
        }
        if (!data.question) {
            throw new Error("data.question must not be null or empty");
        }
        this.data = data;
        this.userComment = "";
    }
    CommentComponent.make = function (data) {
        try {
            return new CommentComponent(data);
        }
        catch (e) {
            return null;
        }
    };
    // @Override
    CommentComponent.prototype.getType = function () {
        return ISurveyComponent.Type.Comment;
    };
    // @Override
    CommentComponent.prototype.getQuestion = function () {
        return this.data.question;
    };
    // @Override
    CommentComponent.prototype.setSubmittedText = function (userComment) {
        this.userComment = userComment;
    };
    // @Override
    CommentComponent.prototype.getSubmittedText = function () {
        return this.userComment;
    };
    // @Override
    CommentComponent.prototype.getDomElements = function (doc) {
        if (!doc) {
            throw new Error("Document must not be null");
        }
        var element = doc.createElement(ISurveyComponent.DOM_COMMENT_TAGNAME);
        element.appendChild(doc.createTextNode(this.getSubmittedText()));
        return [element];
    };
    // @Override
    CommentComponent.prototype.getJsonElements = function () {
        var result = {};
        result[ISurveyComponent.JSON_COMMENT_KEYNAME] = this.getSubmittedText();
        return result;
    };
    return CommentComponent;
}());
(function (CommentComponent) {
    var CommentComponentData = /** @class */ (function () {
        function CommentComponentData() {
        }
        return CommentComponentData;
    }());
    CommentComponent.CommentComponentData = CommentComponentData;
})(CommentComponent || (CommentComponent = {}));
module.exports = CommentComponent;

},{"./../Api/ISurveyComponent":11}],26:[function(require,module,exports){
"use strict";
var IPromptComponent = require("./../Api/IPromptComponent");
var ISurveyComponent = require("./../Api/ISurveyComponent");
var PromptComponent = /** @class */ (function () {
    function PromptComponent(data) {
        if (!data) {
            throw new Error("data must not be null");
        }
        if (!data.question) {
            throw new Error("data.question must not be null or empty");
        }
        if (!data.title) {
            throw new Error("data.title must not be null or empty");
        }
        if (!data.yesButtonLabel) {
            throw new Error("data.yesButtonLabel must not be null or empty");
        }
        if (!data.noButtonLabel) {
            throw new Error("data.noButtonLabel must not be null or empty");
        }
        this.data = data;
        this.selectedButton = IPromptComponent.PromptButton.Unselected;
    }
    PromptComponent.make = function (data) {
        try {
            return new PromptComponent(data);
        }
        catch (e) {
            return null;
        }
    };
    // @Override
    PromptComponent.prototype.getType = function () {
        return ISurveyComponent.Type.Prompt;
    };
    // @Override
    PromptComponent.prototype.getTitle = function () {
        return this.data.title;
    };
    // @Override
    PromptComponent.prototype.getQuestion = function () {
        return this.data.question;
    };
    // @Override
    PromptComponent.prototype.getYesButtonText = function () {
        return this.data.yesButtonLabel;
    };
    // @Override
    PromptComponent.prototype.getNoButtonText = function () {
        return this.data.noButtonLabel;
    };
    // @Override
    PromptComponent.prototype.setButtonSelected = function (selected) {
        if (selected) {
            this.selectedButton = selected;
        }
    };
    // @Override
    PromptComponent.prototype.getButtonSelected = function () {
        return this.selectedButton;
    };
    // @Override
    PromptComponent.prototype.getDomElements = function (doc) {
        if (!doc) {
            throw new Error("Document must not be null");
        }
        var element = doc.createElement(ISurveyComponent.DOM_PROMPT_TAGNAME);
        element.appendChild(doc.createTextNode(this.promptButtonToString(this.getButtonSelected())));
        return [element];
    };
    // @Override
    PromptComponent.prototype.getJsonElements = function () {
        var result = {};
        result[ISurveyComponent.JSON_PROMPT_KEYNAME] = this.promptButtonToString(this.getButtonSelected());
        return result;
    };
    PromptComponent.prototype.promptButtonToString = function (value) {
        switch (value) {
            case IPromptComponent.PromptButton.Unselected:
                return "Unselected";
            case IPromptComponent.PromptButton.Yes:
                return "Yes";
            case IPromptComponent.PromptButton.No:
                return "No";
            default:
                return "Unknown";
        }
    };
    return PromptComponent;
}());
(function (PromptComponent) {
    var PromptComponentData = /** @class */ (function () {
        function PromptComponentData() {
        }
        return PromptComponentData;
    }());
    PromptComponent.PromptComponentData = PromptComponentData;
})(PromptComponent || (PromptComponent = {}));
module.exports = PromptComponent;

},{"./../Api/IPromptComponent":9,"./../Api/ISurveyComponent":11}],27:[function(require,module,exports){
"use strict";
var ISurveyComponent = require("./../Api/ISurveyComponent");
var RatingComponent = /** @class */ (function () {
    function RatingComponent(data) {
        if (!data) {
            throw new Error("data must not be null");
        }
        if (!data.question) {
            throw new Error("data.question must not be null or empty");
        }
        if (!data.ratingValuesAscending || data.ratingValuesAscending.length < 2) {
            throw new Error("data.ratingValuesAscending must not be null or have less than two choices");
        }
        data.ratingValuesAscending.forEach(function (rating) {
            if (!rating) {
                throw new Error("rating values must not contain null or empty");
            }
        });
        this.data = data;
        this.selectedIndex = -1;
    }
    RatingComponent.make = function (data) {
        try {
            return new RatingComponent(data);
        }
        catch (e) {
            return null;
        }
    };
    RatingComponent.prototype.getType = function () {
        return ISurveyComponent.Type.Rating;
    };
    RatingComponent.prototype.getQuestion = function () {
        return this.data.question;
    };
    RatingComponent.prototype.getRatingValuesAscending = function () {
        return this.data.ratingValuesAscending;
    };
    RatingComponent.prototype.getSelectedRating = function () {
        if (!this.isRatingIndexValid(this.selectedIndex)) {
            return "";
        }
        return this.data.ratingValuesAscending[this.selectedIndex];
    };
    RatingComponent.prototype.setSelectedRatingIndex = function (selected) {
        if (this.isRatingIndexValid(selected)) {
            this.selectedIndex = selected;
        }
        else {
            this.selectedIndex = -1;
        }
    };
    RatingComponent.prototype.getSelectedRatingIndex = function () {
        return this.selectedIndex;
    };
    RatingComponent.prototype.getDomElements = function (doc) {
        if (!doc) {
            throw new Error("Document must not be null");
        }
        var element = doc.createElement(ISurveyComponent.DOM_RATING_TAGNAME);
        if (!this.isRatingIndexValid(this.getSelectedRatingIndex())) {
            element.appendChild(doc.createTextNode("Not rated"));
        }
        else {
            // Enforce six digits after the decimal
            element.appendChild(doc.createTextNode(this.getNormalizedRatingScore().toFixed(6)));
        }
        return [element];
    };
    // @Override
    RatingComponent.prototype.getJsonElements = function () {
        var result = {};
        if (!this.isRatingIndexValid(this.getSelectedRatingIndex())) {
            result[ISurveyComponent.JSON_RATING_KEYNAME] = "Not rated";
        }
        else {
            result[ISurveyComponent.JSON_RATING_KEYNAME] = this.getNormalizedRatingScore();
        }
        return result;
    };
    RatingComponent.prototype.isRatingIndexValid = function (index) {
        return (index >= 0 && index < this.data.ratingValuesAscending.length);
    };
    RatingComponent.prototype.getNormalizedRatingScore = function () {
        if (!this.isRatingIndexValid(this.getSelectedRatingIndex())) {
            return 0;
        }
        if (this.data.isZeroBased) {
            return (this.selectedIndex) / (this.data.ratingValuesAscending.length - 1);
        }
        else {
            return (this.selectedIndex + 1.0) / this.data.ratingValuesAscending.length;
        }
    };
    return RatingComponent;
}());
(function (RatingComponent) {
    var RatingComponentData = /** @class */ (function () {
        function RatingComponentData() {
        }
        return RatingComponentData;
    }());
    RatingComponent.RatingComponentData = RatingComponentData;
})(RatingComponent || (RatingComponent = {}));
module.exports = RatingComponent;

},{"./../Api/ISurveyComponent":11}],28:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ActivityTrackingData_1 = require("./ActivityTrackingData");
var ActivityTrackingSet_1 = require("./ActivityTrackingSet");
var ISurveyEvent = require("./ISurveyEvent");
var CountedActivityEvent = /** @class */ (function () {
    function CountedActivityEvent(data) {
        if (!data) {
            throw new Error("data must not be null");
        }
        if (data.count <= 0) {
            throw new Error("count must be greater than 0");
        }
        if (!data.activity || data.activity.length === 0) {
            throw new Error("activity must not be null or an empty string");
        }
        this.data = data;
    }
    CountedActivityEvent.make = function (data) {
        try {
            return new CountedActivityEvent(data);
        }
        catch (e) {
            return null;
        }
    };
    CountedActivityEvent.prototype.getActivity = function () {
        return this.data.activity;
    };
    CountedActivityEvent.prototype.getCount = function () {
        return this.data.count;
    };
    CountedActivityEvent.prototype.isAggregate = function () {
        return this.data.isAggregate;
    };
    CountedActivityEvent.prototype.getType = function () {
        return ISurveyEvent.Type.CountedActivity;
    };
    CountedActivityEvent.prototype.getTrackingSet = function () {
        var trackingDataList = new Array();
        trackingDataList.push(new ActivityTrackingData_1.ActivityTrackingData(this.data.activity, this.data.count, this.data.isAggregate));
        return new ActivityTrackingSet_1.ActivityTrackingSet(false, trackingDataList);
    };
    return CountedActivityEvent;
}());
exports.CountedActivityEvent = CountedActivityEvent;
/**
 * Data class for serialization and deserialization. Do not add logic in here.
 */
var CountedActivityEventData = /** @class */ (function () {
    function CountedActivityEventData() {
    }
    return CountedActivityEventData;
}());
exports.CountedActivityEventData = CountedActivityEventData;
var CountedActivitySequenceEvent = /** @class */ (function () {
    function CountedActivitySequenceEvent(data) {
        if (!data) {
            throw new Error("data must not be null");
        }
        if (!data.sequence) {
            throw new Error("data.sequence must not be null");
        }
        if (data.sequence.length === 0) {
            throw new Error("data.sequence size must be greater than 0");
        }
        this.data = [];
        for (var _i = 0, _a = data.sequence; _i < _a.length; _i++) {
            var countedActivityEventData = _a[_i];
            this.data.push(new CountedActivityEvent(countedActivityEventData));
        }
    }
    CountedActivitySequenceEvent.make = function (data) {
        try {
            return new CountedActivitySequenceEvent(data);
        }
        catch (e) {
            return null;
        }
    };
    CountedActivitySequenceEvent.prototype.getSequence = function () {
        return this.data;
    };
    CountedActivitySequenceEvent.prototype.getType = function () {
        return ISurveyEvent.Type.CountedActivitySequence;
    };
    CountedActivitySequenceEvent.prototype.getTrackingSet = function () {
        var trackingDataList = new Array();
        for (var _i = 0, _a = this.data; _i < _a.length; _i++) {
            var countedActivityEvent = _a[_i];
            trackingDataList.push(new ActivityTrackingData_1.ActivityTrackingData(countedActivityEvent.getActivity(), countedActivityEvent.getCount(), countedActivityEvent.isAggregate()));
        }
        return new ActivityTrackingSet_1.ActivityTrackingSet(true, trackingDataList);
    };
    return CountedActivitySequenceEvent;
}());
exports.CountedActivitySequenceEvent = CountedActivitySequenceEvent;
/**
 * Data class for serialization and deserialization. Do not add logic in here.
 */
var CountedActivitySequenceEventData = /** @class */ (function () {
    function CountedActivitySequenceEventData() {
    }
    /**
     * No args constructor needed for serialization.
     */
    CountedActivitySequenceEventData.prototype.CountedActivitySequenceEventData = function () {
    };
    return CountedActivitySequenceEventData;
}());
exports.CountedActivitySequenceEventData = CountedActivitySequenceEventData;

},{"./ActivityTrackingData":3,"./ActivityTrackingSet":4,"./ISurveyEvent":21}],29:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Generic class for managing a collection of survey stats. Includes read-from/write-to json structures or a file,
 * as well as merge routines for combining collections
 */
var SurveyStatCollection = /** @class */ (function () {
    function SurveyStatCollection() {
        // The following property name matches the JSON root key name for proper serialization/ deserialization
        this.Surveys = {};
        this.Surveys = {};
    }
    /**
     * Add stats. Overwrites if already exists.
     */
    SurveyStatCollection.prototype.addStats = function (surveyId, stats) {
        this.Surveys[surveyId] = stats;
    };
    /**
     * Get a SurveyActivationStats object by surveyId. Returns null if surveyId is not found
     */
    SurveyStatCollection.prototype.getBySurveyId = function (surveyId) {
        return (this.Surveys[surveyId]);
    };
    /**
     * Get all stats available
     */
    SurveyStatCollection.prototype.getStats = function () {
        return this.Surveys;
    };
    return SurveyStatCollection;
}());
exports.SurveyStatCollection = SurveyStatCollection;

},{}],30:[function(require,module,exports){
"use strict";
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var ISurvey = require("./Api/ISurvey");
var SurveyStatCollection_1 = require("./SurveyStatCollection");
var Utils = require("./Utils");
/**
 * StatCollection for activated surveys.  Should be used to track the SurveyIds
 * that have been recently shown to a user
 */
// TODO (gachoi) Check if this applies - VSOBug: 1443010 One bad Stat object fails the entire serialization
var SurveyStatCollectionActivation = /** @class */ (function (_super) {
    __extends(SurveyStatCollectionActivation, _super);
    function SurveyStatCollectionActivation() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Load from Json
     */
    SurveyStatCollectionActivation.fromJson = function (json) {
        var statCollection = new SurveyStatCollectionActivation();
        if (!json) {
            // TODO (gachoi) Log null json passed
            return statCollection;
        }
        var readStats;
        try {
            readStats = JSON.parse(json);
        }
        catch (e) {
            // TODO (gachoi) Log parsing failed
            return statCollection;
        }
        if (!statCollection.deserialize(readStats)) {
            return new SurveyStatCollectionActivation();
        }
        return statCollection;
    };
    /**
     * Convert to Json
     */
    SurveyStatCollectionActivation.toJson = function (object) {
        if (!object) {
            // TODO (gachoi) log that null object passed
            object = new SurveyStatCollectionActivation();
        }
        return JSON.stringify(object);
    };
    /**
     * Add another SurveyStatCollectionActivation object
     */
    SurveyStatCollectionActivation.prototype.accumulate = function (other) {
        if (!other) {
            return;
        }
        var stats = other.getStats();
        // SurveyActivationStats accumulation simply overwrites any keys from 'other' into our collection
        for (var key in stats) {
            if (stats.hasOwnProperty(key)) {
                this.addStats(key, stats[key]);
            }
        }
    };
    /**
     * Method to deserialize SurveyStatCollectionActivation
     * @param input: collection of SurveyStatCollectionActivation
     * Returns result of validation check
     */
    SurveyStatCollectionActivation.prototype.deserialize = function (input) {
        var rawStats = input.Surveys;
        var now = new Date();
        for (var key in rawStats) {
            if (rawStats.hasOwnProperty(key)) {
                var newStat = new SurveyActivationStats();
                if (newStat.deserialize(rawStats[key]) && newStat.ExpirationTimeUtc > now) {
                    this.addStats(key, newStat);
                }
            }
        }
        return this.validate();
    };
    /**
     * Validate the Surveys
     * Returns false if validation fails
     */
    SurveyStatCollectionActivation.prototype.validate = function () {
        return Utils.isObject(this.getStats());
    };
    return SurveyStatCollectionActivation;
}(SurveyStatCollection_1.SurveyStatCollection));
exports.SurveyStatCollectionActivation = SurveyStatCollectionActivation;
var SurveyActivationStats = /** @class */ (function () {
    function SurveyActivationStats() {
    }
    /**
     * Method to deserialize a JSON object to class object
     * @param input: JSON object
     * Returns result of validation check
     */
    SurveyActivationStats.prototype.deserialize = function (input) {
        this.ActivationTimeUtc = input.ActivationTimeUtc;
        this.ExpirationTimeUtc = input.ExpirationTimeUtc;
        this.Type = input.Type;
        return this.validate();
    };
    /**
     * Method to call after deserialization to validate generated object.
     * Returns false if not valid.
     */
    SurveyActivationStats.prototype.validate = function () {
        // make it a date object if it's a valid UTC date time value
        if (Utils.isUtcDatetimeString(this.ActivationTimeUtc)) {
            this.ActivationTimeUtc = Utils.stringToDate(this.ActivationTimeUtc);
        }
        else {
            return false;
        }
        // make it a date object if it's a valid UTC date time value
        if (Utils.isUtcDatetimeString(this.ExpirationTimeUtc)) {
            this.ExpirationTimeUtc = Utils.stringToDate(this.ExpirationTimeUtc);
        }
        else {
            return false;
        }
        return Utils.isEnumValue(this.Type, ISurvey.Type);
    };
    return SurveyActivationStats;
}());
exports.SurveyActivationStats = SurveyActivationStats;

},{"./Api/ISurvey":10,"./SurveyStatCollection":29,"./Utils":36}],31:[function(require,module,exports){
"use strict";
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
var SurveyStatCollection_1 = require("./SurveyStatCollection");
var Utils = require("./Utils");
/**
 * StatCollection for EventActivity counts.  Should be used to store/merge
 * aggregate values between sessions tracking the same surveys/events
 * E.g. A survey that activates after 3 boots.
 */
// TODO (gachoi) check the following - VSOBug: 1443010 One bad Stat object fails the entire serialization
var SurveyStatCollectionEventActivity = /** @class */ (function (_super) {
    __extends(SurveyStatCollectionEventActivity, _super);
    function SurveyStatCollectionEventActivity() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Load from Json
     */
    SurveyStatCollectionEventActivity.fromJson = function (json) {
        var statCollection = new SurveyStatCollectionEventActivity();
        if (!json) {
            // TODO (gachoi) Log null json passed
            return statCollection;
        }
        var readStats;
        try {
            readStats = JSON.parse(json);
        }
        catch (e) {
            // TODO (gachoi) Log parsing failed
            return statCollection;
        }
        if (!statCollection.deserialize(readStats)) {
            return new SurveyStatCollectionEventActivity();
        }
        return statCollection;
    };
    /**
     * Convert to Json
     */
    SurveyStatCollectionEventActivity.toJson = function (object) {
        if (!object) {
            // TODO (gachoi) log that null object passed
            object = new SurveyStatCollectionEventActivity();
        }
        return JSON.stringify(object);
    };
    /**
     * Add another SurveyStatCollectionEventActivity object
     */
    SurveyStatCollectionEventActivity.prototype.accumulate = function (other) {
        if (!other) {
            return;
        }
        var stats = other.getStats();
        // SurveyEventActivityStats accumulation simply overwrites any keys from 'other' into our collection
        for (var key in stats) {
            if (stats.hasOwnProperty(key)) {
                var ourStats = this.getBySurveyId(key);
                // If it does not already exist
                if (!ourStats) {
                    ourStats = new SurveyEventActivityStats();
                    ourStats.Counts = [];
                    this.addStats(key, ourStats);
                }
                ourStats.ExpirationTimeUtc = stats[key].ExpirationTimeUtc;
                // If for some reason the other counts array is larger, resize ourStats.counts
                if (ourStats.Counts.length < stats[key].Counts.length) {
                    var resizedCounts = ourStats.Counts.slice();
                    ourStats.Counts = resizedCounts;
                }
                for (var i = 0; i < stats[key].Counts.length; i++) {
                    if (!ourStats.Counts[i]) {
                        ourStats.Counts[i] = 0;
                    }
                    ourStats.Counts[i] += stats[key].Counts[i];
                }
            }
        }
    };
    /**
     * Method to deserialize SurveyStatCollectionEventActivity
     * @param input: collection of SurveyStatCollectionEventActivity
     * Returns result of validation check
     */
    SurveyStatCollectionEventActivity.prototype.deserialize = function (input) {
        var rawStats = input.Surveys;
        var now = new Date();
        for (var key in rawStats) {
            if (rawStats.hasOwnProperty(key)) {
                var newStat = new SurveyEventActivityStats();
                if (newStat.deserialize(rawStats[key]) && newStat.ExpirationTimeUtc > now) {
                    this.addStats(key, newStat);
                }
            }
        }
        return this.validate();
    };
    /**
     * Validate the Surveys
     * Returns false if validation fails
     */
    SurveyStatCollectionEventActivity.prototype.validate = function () {
        return Utils.isObject(this.getStats());
    };
    return SurveyStatCollectionEventActivity;
}(SurveyStatCollection_1.SurveyStatCollection));
exports.SurveyStatCollectionEventActivity = SurveyStatCollectionEventActivity;
var SurveyEventActivityStats = /** @class */ (function () {
    function SurveyEventActivityStats() {
    }
    /**
     * Method to deserialize a JSON object to class object
     * @param input: JSON object
     * Returns result of validation check
     */
    SurveyEventActivityStats.prototype.deserialize = function (input) {
        this.ExpirationTimeUtc = input.ExpirationTimeUtc;
        this.Counts = input.Counts;
        return this.validate();
    };
    /**
     * Method to call after deserialization to validate generated object.
     * Returns false if not valid.
     */
    SurveyEventActivityStats.prototype.validate = function () {
        if (!this.Counts) {
            return false;
        }
        for (var i = 0; i < this.Counts.length; i++) {
            var val = this.Counts[i];
            if (!Utils.isNumber(val)) {
                return false;
            }
            if (val < 0) {
                this.Counts[i] = 0;
            }
        }
        // make it a date object if it's a valid UTC date time value
        if (Utils.isUtcDatetimeString(this.ExpirationTimeUtc)) {
            this.ExpirationTimeUtc = Utils.stringToDate(this.ExpirationTimeUtc);
        }
        else {
            return false;
        }
        return true;
    };
    return SurveyEventActivityStats;
}());
exports.SurveyEventActivityStats = SurveyEventActivityStats;

},{"./SurveyStatCollection":29,"./Utils":36}],32:[function(require,module,exports){
"use strict";
var ISurvey = require("../Api/ISurvey");
var ISurveyComponent = require("../Api/ISurveyComponent");
var CommentComponent = require("../SurveyComponents/CommentComponent");
var PromptComponent = require("../SurveyComponents/PromptComponent");
var RatingComponent = require("../SurveyComponents/RatingComponent");
var Utils = require("../Utils");
var SurveyDataSource = require("./SurveyDataSource");
var FpsSurvey = /** @class */ (function () {
    function FpsSurvey(data) {
        if (Utils.isNullOrUndefined(data)) {
            throw new Error("data must not be null");
        }
        this.surveyInfo = new SurveyDataSource(data.baseData);
        this.prompt = new PromptComponent(data.promptData);
        this.question = new CommentComponent(data.commentData);
        this.rating = new RatingComponent(data.ratingData);
    }
    FpsSurvey.make = function (data) {
        try {
            return new FpsSurvey(data);
        }
        catch (e) {
            return null;
        }
    };
    FpsSurvey.makeFps = function (baseData, sp, surveyModel) {
        if (Utils.isNullOrUndefined(baseData) || Utils.isNullOrUndefined(sp) || Utils.isNullOrUndefined(surveyModel)) {
            return null;
        }
        var ratingValuesAscending = [];
        var content = surveyModel.content;
        if (Utils.isNullOrUndefined(content) || Utils.isNullOrUndefined(content.comment)
            || Utils.isNullOrUndefined(content.prompt) || Utils.isNullOrUndefined(content.rating)) {
            return null;
        }
        var data = new FpsSurvey.FpsSurveyData();
        data.baseData = baseData;
        data.promptData = new PromptComponent.PromptComponentData();
        data.ratingData = new RatingComponent.RatingComponentData();
        data.commentData = new CommentComponent.CommentComponentData();
        data.promptData.title = sp.getCustomString(content.prompt.title);
        data.promptData.question = sp.getCustomString(content.prompt.question);
        data.promptData.yesButtonLabel = sp.getCustomString(content.prompt.yesLabel);
        data.promptData.noButtonLabel = sp.getCustomString(content.prompt.noLabel);
        data.ratingData.question = sp.getCustomString(content.rating.question);
        data.ratingData.isZeroBased = content.rating.isZeroBased;
        data.commentData.question = sp.getCustomString(content.comment.question);
        for (var _i = 0, _a = content.rating.ratingValuesAscending; _i < _a.length; _i++) {
            var value = _a[_i];
            var customString = sp.getCustomString(value);
            if (Utils.isNullOrUndefined(customString)) {
                return null;
            }
            ratingValuesAscending.push(customString);
        }
        data.ratingData.ratingValuesAscending = ratingValuesAscending;
        if (Utils.isNullOrUndefined(data.ratingData.question)
            || Utils.isNullOrUndefined(data.commentData.question)
            || Utils.isNullOrUndefined(data.promptData.title)
            || Utils.isNullOrUndefined(data.promptData.question)
            || Utils.isNullOrUndefined(data.promptData.yesButtonLabel)
            || Utils.isNullOrUndefined(data.promptData.noButtonLabel)
            || Utils.isNullOrUndefined(data.ratingData.ratingValuesAscending)) {
            return null;
        }
        return this.make(data);
    };
    // @Override
    FpsSurvey.prototype.getType = function () {
        return ISurvey.Type.Fps;
    };
    // @Override
    FpsSurvey.prototype.getSurveyInfo = function () {
        return this.surveyInfo;
    };
    // @Override
    FpsSurvey.prototype.getCommentComponent = function () {
        return this.question;
    };
    // @Override
    FpsSurvey.prototype.getPromptComponent = function () {
        return this.prompt;
    };
    // @Override
    FpsSurvey.prototype.getRatingComponent = function () {
        return this.rating;
    };
    // @Override
    FpsSurvey.prototype.getComponent = function (componentType) {
        switch (componentType) {
            case ISurveyComponent.Type.Comment:
                return this.getCommentComponent();
            case ISurveyComponent.Type.Prompt:
                return this.getPromptComponent();
            case ISurveyComponent.Type.Rating:
                return this.getRatingComponent();
            default:
                return null;
        }
    };
    // @Override
    FpsSurvey.prototype.getDomElements = function (doc) {
        if (Utils.isNullOrUndefined(doc)) {
            throw new Error("Document must not be null");
        }
        var element = doc.createElement(ISurvey.DOM_FPS_TAGNAME);
        this.getSurveyInfo().getDomElements(doc).forEach(function (child) {
            if (!Utils.isNullOrUndefined(child)) {
                element.appendChild(child);
            }
        });
        this.getCommentComponent().getDomElements(doc).forEach(function (child) {
            if (!Utils.isNullOrUndefined(child)) {
                element.appendChild(child);
            }
        });
        this.getRatingComponent().getDomElements(doc).forEach(function (child) {
            if (!Utils.isNullOrUndefined(child)) {
                element.appendChild(child);
            }
        });
        return [element];
    };
    // @Override
    FpsSurvey.prototype.getJsonElements = function () {
        var result = {};
        result = Utils.overrideValues(this.getSurveyInfo().getJsonElements(), result);
        result = Utils.overrideValues(this.getCommentComponent().getJsonElements(), result);
        result = Utils.overrideValues(this.getRatingComponent().getJsonElements(), result);
        return result;
    };
    return FpsSurvey;
}());
(function (FpsSurvey) {
    /**
     * Data required for a Fps Survey
     */
    var FpsSurveyData = /** @class */ (function () {
        function FpsSurveyData() {
        }
        return FpsSurveyData;
    }());
    FpsSurvey.FpsSurveyData = FpsSurveyData;
})(FpsSurvey || (FpsSurvey = {}));
module.exports = FpsSurvey;

},{"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":25,"../SurveyComponents/PromptComponent":26,"../SurveyComponents/RatingComponent":27,"../Utils":36,"./SurveyDataSource":35}],33:[function(require,module,exports){
"use strict";
var ISurvey = require("../Api/ISurvey");
var ISurveyComponent = require("../Api/ISurveyComponent");
var CommentComponent = require("../SurveyComponents/CommentComponent");
var PromptComponent = require("../SurveyComponents/PromptComponent");
var RatingComponent = require("../SurveyComponents/RatingComponent");
var Utils = require("../Utils");
var SurveyDataSource = require("./SurveyDataSource");
var NlqsSurvey = /** @class */ (function () {
    function NlqsSurvey(data) {
        if (Utils.isNullOrUndefined(data)) {
            throw new Error("data must not be null");
        }
        this.surveyInfo = new SurveyDataSource(data.baseData);
        this.prompt = new PromptComponent(data.promptData);
        this.question = new CommentComponent(data.commentData);
        this.rating = new RatingComponent(data.ratingData);
    }
    NlqsSurvey.make = function (data) {
        try {
            return new NlqsSurvey(data);
        }
        catch (e) {
            return null;
        }
    };
    NlqsSurvey.makeNlqs = function (baseData, sp, surveyModel) {
        if (Utils.isNullOrUndefined(baseData) || Utils.isNullOrUndefined(sp) || Utils.isNullOrUndefined(surveyModel)) {
            return null;
        }
        var ratingValuesAscending = [];
        var content = surveyModel.content;
        if (Utils.isNullOrUndefined(content) || Utils.isNullOrUndefined(content.comment)
            || Utils.isNullOrUndefined(content.prompt) || Utils.isNullOrUndefined(content.rating)) {
            return null;
        }
        var data = new NlqsSurvey.NlqsSurveyData();
        data.baseData = baseData;
        data.promptData = new PromptComponent.PromptComponentData();
        data.ratingData = new RatingComponent.RatingComponentData();
        data.commentData = new CommentComponent.CommentComponentData();
        data.promptData.title = sp.getCustomString(content.prompt.title);
        data.promptData.question = sp.getCustomString(content.prompt.question);
        data.promptData.yesButtonLabel = sp.getCustomString(content.prompt.yesLabel);
        data.promptData.noButtonLabel = sp.getCustomString(content.prompt.noLabel);
        data.ratingData.question = sp.getCustomString(content.rating.question);
        data.ratingData.isZeroBased = content.rating.isZeroBased;
        data.commentData.question = sp.getCustomString(content.comment.question);
        for (var _i = 0, _a = content.rating.ratingValuesAscending; _i < _a.length; _i++) {
            var value = _a[_i];
            var customString = sp.getCustomString(value);
            if (Utils.isNullOrUndefined(customString)) {
                return null;
            }
            ratingValuesAscending.push(customString);
        }
        data.ratingData.ratingValuesAscending = ratingValuesAscending;
        if (Utils.isNullOrUndefined(data.ratingData.question)
            || Utils.isNullOrUndefined(data.commentData.question)
            || Utils.isNullOrUndefined(data.promptData.title)
            || Utils.isNullOrUndefined(data.promptData.question)
            || Utils.isNullOrUndefined(data.promptData.yesButtonLabel)
            || Utils.isNullOrUndefined(data.promptData.noButtonLabel)
            || Utils.isNullOrUndefined(data.ratingData.ratingValuesAscending)) {
            return null;
        }
        return this.make(data);
    };
    // @Override
    NlqsSurvey.prototype.getType = function () {
        return ISurvey.Type.Nlqs;
    };
    // @Override
    NlqsSurvey.prototype.getSurveyInfo = function () {
        return this.surveyInfo;
    };
    // @Override
    NlqsSurvey.prototype.getCommentComponent = function () {
        return this.question;
    };
    // @Override
    NlqsSurvey.prototype.getPromptComponent = function () {
        return this.prompt;
    };
    // @Override
    NlqsSurvey.prototype.getRatingComponent = function () {
        return this.rating;
    };
    // @Override
    NlqsSurvey.prototype.getComponent = function (componentType) {
        switch (componentType) {
            case ISurveyComponent.Type.Comment:
                return this.getCommentComponent();
            case ISurveyComponent.Type.Prompt:
                return this.getPromptComponent();
            case ISurveyComponent.Type.Rating:
                return this.getRatingComponent();
            default:
                return null;
        }
    };
    // @Override
    NlqsSurvey.prototype.getDomElements = function (doc) {
        if (Utils.isNullOrUndefined(doc)) {
            throw new Error("Document must not be null");
        }
        var element = doc.createElement(ISurvey.DOM_NLQS_TAGNAME);
        this.getSurveyInfo().getDomElements(doc).forEach(function (child) {
            if (!Utils.isNullOrUndefined(child)) {
                element.appendChild(child);
            }
        });
        this.getCommentComponent().getDomElements(doc).forEach(function (child) {
            if (!Utils.isNullOrUndefined(child)) {
                element.appendChild(child);
            }
        });
        this.getRatingComponent().getDomElements(doc).forEach(function (child) {
            if (!Utils.isNullOrUndefined(child)) {
                element.appendChild(child);
            }
        });
        return [element];
    };
    // @Override
    NlqsSurvey.prototype.getJsonElements = function () {
        var result = {};
        result = Utils.overrideValues(this.getSurveyInfo().getJsonElements(), result);
        result = Utils.overrideValues(this.getCommentComponent().getJsonElements(), result);
        result = Utils.overrideValues(this.getRatingComponent().getJsonElements(), result);
        return result;
    };
    return NlqsSurvey;
}());
(function (NlqsSurvey) {
    /**
     * Data required for a Nlqs Survey
     */
    var NlqsSurveyData = /** @class */ (function () {
        function NlqsSurveyData() {
        }
        return NlqsSurveyData;
    }());
    NlqsSurvey.NlqsSurveyData = NlqsSurveyData;
})(NlqsSurvey || (NlqsSurvey = {}));
module.exports = NlqsSurvey;

},{"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":25,"../SurveyComponents/PromptComponent":26,"../SurveyComponents/RatingComponent":27,"../Utils":36,"./SurveyDataSource":35}],34:[function(require,module,exports){
"use strict";
var IFloodgateStringProvider = require("../Api/IFloodgateStringProvider");
var ISurvey = require("../Api/ISurvey");
var ISurveyComponent = require("../Api/ISurveyComponent");
var CommentComponent = require("../SurveyComponents/CommentComponent");
var PromptComponent = require("../SurveyComponents/PromptComponent");
var RatingComponent = require("../SurveyComponents/RatingComponent");
var Utils = require("../Utils");
var SurveyDataSource = require("./SurveyDataSource");
var NpsSurvey = /** @class */ (function () {
    function NpsSurvey(data) {
        if (!data) {
            throw new Error("data must not be null");
        }
        this.surveyInfo = new SurveyDataSource(data.baseData);
        this.prompt = new PromptComponent(data.promptData);
        this.question = new CommentComponent(data.commentData);
        this.rating = new RatingComponent(data.ratingData);
    }
    NpsSurvey.make = function (data) {
        try {
            return new NpsSurvey(data);
        }
        catch (e) {
            return null;
        }
    };
    NpsSurvey.makeCustom = function (baseData, sp, surveyModel) {
        if (Utils.isNullOrUndefined(baseData) || Utils.isNullOrUndefined(sp) || Utils.isNullOrUndefined(surveyModel)) {
            return null;
        }
        var ratingValuesAscending = [];
        var content = surveyModel.content;
        if (Utils.isNullOrUndefined(content) || Utils.isNullOrUndefined(content.comment)
            || Utils.isNullOrUndefined(content.prompt) || Utils.isNullOrUndefined(content.rating)) {
            return null;
        }
        var data = new NpsSurvey.NpsSurveyData();
        data.baseData = baseData;
        data.promptData = new PromptComponent.PromptComponentData();
        data.ratingData = new RatingComponent.RatingComponentData();
        data.commentData = new CommentComponent.CommentComponentData();
        data.promptData.title = sp.getCustomString(content.prompt.title);
        data.promptData.question = sp.getCustomString(content.prompt.question);
        data.promptData.yesButtonLabel = sp.getCustomString(content.prompt.yesLabel);
        data.promptData.noButtonLabel = sp.getCustomString(content.prompt.noLabel);
        data.ratingData.question = sp.getCustomString(content.rating.question);
        data.ratingData.isZeroBased = content.rating.isZeroBased;
        data.commentData.question = sp.getCustomString(content.comment.question);
        for (var _i = 0, _a = content.rating.ratingValuesAscending; _i < _a.length; _i++) {
            var value = _a[_i];
            var customString = sp.getCustomString(value);
            if (Utils.isNullOrUndefined(customString)) {
                return null;
            }
            ratingValuesAscending.push(customString);
        }
        data.ratingData.ratingValuesAscending = ratingValuesAscending;
        if (Utils.isNullOrUndefined(data.ratingData.question)
            || Utils.isNullOrUndefined(data.commentData.question)
            || Utils.isNullOrUndefined(data.promptData.title)
            || Utils.isNullOrUndefined(data.promptData.question)
            || Utils.isNullOrUndefined(data.promptData.yesButtonLabel)
            || Utils.isNullOrUndefined(data.promptData.noButtonLabel)
            || Utils.isNullOrUndefined(data.ratingData.ratingValuesAscending)) {
            return null;
        }
        return this.make(data);
    };
    NpsSurvey.make5Point = function (baseData, sp) {
        if (!baseData || !sp) {
            return null;
        }
        var data = new NpsSurvey.NpsSurveyData();
        data.baseData = baseData;
        data.ratingData = new RatingComponent.RatingComponentData();
        data.ratingData.isZeroBased = false;
        data.commentData = new CommentComponent.CommentComponentData();
        data.promptData = new PromptComponent.PromptComponentData();
        data.ratingData.question = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsRatingQuestion);
        data.commentData.question = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsCommentQuestion);
        data.promptData.title = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptTitle);
        data.promptData.question = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptQuestion);
        data.promptData.yesButtonLabel = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptYesLabel);
        data.promptData.noButtonLabel = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptNotNowLabel);
        var ratingValuesAscending = new Array(5);
        ratingValuesAscending[0] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps5RatingValue1);
        ratingValuesAscending[1] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps5RatingValue2);
        ratingValuesAscending[2] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps5RatingValue3);
        ratingValuesAscending[3] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps5RatingValue4);
        ratingValuesAscending[4] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps5RatingValue5);
        if (!data.ratingData.question
            || !data.commentData.question
            || !data.promptData.title
            || !data.promptData.question
            || !data.promptData.yesButtonLabel
            || !data.promptData.noButtonLabel
            || !ratingValuesAscending[0]
            || !ratingValuesAscending[1]
            || !ratingValuesAscending[2]
            || !ratingValuesAscending[3]
            || !ratingValuesAscending[4]) {
            return null;
        }
        data.ratingData.ratingValuesAscending = ratingValuesAscending;
        return this.make(data);
    };
    NpsSurvey.make11Point = function (baseData, sp) {
        if (!baseData || !sp) {
            return null;
        }
        var data = new NpsSurvey.NpsSurveyData();
        data.baseData = baseData;
        data.ratingData = new RatingComponent.RatingComponentData();
        data.ratingData.isZeroBased = true;
        data.commentData = new CommentComponent.CommentComponentData();
        data.promptData = new PromptComponent.PromptComponentData();
        data.ratingData.question = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsRatingQuestion);
        data.commentData.question = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsCommentQuestion);
        data.promptData.title = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptTitle);
        data.promptData.question = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptQuestion);
        data.promptData.yesButtonLabel = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptYesLabel);
        data.promptData.noButtonLabel = sp.loadStringResource(IFloodgateStringProvider.StringType.NpsPromptNotNowLabel);
        var ratingValuesAscending = new Array(11);
        ratingValuesAscending[0] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue0);
        ratingValuesAscending[1] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue1);
        ratingValuesAscending[2] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue2);
        ratingValuesAscending[3] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue3);
        ratingValuesAscending[4] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue4);
        ratingValuesAscending[5] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue5);
        ratingValuesAscending[6] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue6);
        ratingValuesAscending[7] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue7);
        ratingValuesAscending[8] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue8);
        ratingValuesAscending[9] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue9);
        ratingValuesAscending[10] = sp.loadStringResource(IFloodgateStringProvider.StringType.Nps11RatingValue10);
        if (!data.ratingData.question
            || !data.commentData.question
            || !data.promptData.title
            || !data.promptData.question
            || !data.promptData.yesButtonLabel
            || !data.promptData.noButtonLabel
            || !ratingValuesAscending[0]
            || !ratingValuesAscending[1]
            || !ratingValuesAscending[2]
            || !ratingValuesAscending[3]
            || !ratingValuesAscending[4]
            || !ratingValuesAscending[5]
            || !ratingValuesAscending[6]
            || !ratingValuesAscending[7]
            || !ratingValuesAscending[8]
            || !ratingValuesAscending[9]
            || !ratingValuesAscending[10]) {
            return null;
        }
        data.ratingData.ratingValuesAscending = ratingValuesAscending;
        return this.make(data);
    };
    // @Override
    NpsSurvey.prototype.getType = function () {
        return ISurvey.Type.Nps;
    };
    // @Override
    NpsSurvey.prototype.getSurveyInfo = function () {
        return this.surveyInfo;
    };
    // @Override
    NpsSurvey.prototype.getCommentComponent = function () {
        return this.question;
    };
    // @Override
    NpsSurvey.prototype.getPromptComponent = function () {
        return this.prompt;
    };
    // @Override
    NpsSurvey.prototype.getRatingComponent = function () {
        return this.rating;
    };
    // @Override
    NpsSurvey.prototype.getComponent = function (componentType) {
        switch (componentType) {
            case ISurveyComponent.Type.Comment:
                return this.getCommentComponent();
            case ISurveyComponent.Type.Prompt:
                return this.getPromptComponent();
            case ISurveyComponent.Type.Rating:
                return this.getRatingComponent();
            default:
                return null;
        }
    };
    // @Override
    NpsSurvey.prototype.getDomElements = function (doc) {
        if (!doc) {
            throw new Error("Document must not be null");
        }
        var element = doc.createElement(ISurvey.DOM_NPS_TAGNAME);
        this.getSurveyInfo().getDomElements(doc).forEach(function (child) {
            if (child) {
                element.appendChild(child);
            }
        });
        this.getCommentComponent().getDomElements(doc).forEach(function (child) {
            if (child) {
                element.appendChild(child);
            }
        });
        this.getRatingComponent().getDomElements(doc).forEach(function (child) {
            if (child) {
                element.appendChild(child);
            }
        });
        return [element];
    };
    // @Override
    NpsSurvey.prototype.getJsonElements = function () {
        var result = {};
        result = Utils.overrideValues(this.getSurveyInfo().getJsonElements(), result);
        result = Utils.overrideValues(this.getCommentComponent().getJsonElements(), result);
        result = Utils.overrideValues(this.getRatingComponent().getJsonElements(), result);
        return result;
    };
    return NpsSurvey;
}());
(function (NpsSurvey) {
    /**
     * Data required for a Nps Survey
     */
    var NpsSurveyData = /** @class */ (function () {
        function NpsSurveyData() {
        }
        return NpsSurveyData;
    }());
    NpsSurvey.NpsSurveyData = NpsSurveyData;
})(NpsSurvey || (NpsSurvey = {}));
module.exports = NpsSurvey;

},{"../Api/IFloodgateStringProvider":8,"../Api/ISurvey":10,"../Api/ISurveyComponent":11,"../SurveyComponents/CommentComponent":25,"../SurveyComponents/PromptComponent":26,"../SurveyComponents/RatingComponent":27,"../Utils":36,"./SurveyDataSource":35}],35:[function(require,module,exports){
"use strict";
var GovernedChannel_1 = require("../GovernedChannel");
var ISurveyInfo = require("../ISurveyInfo");
var Utils = require("../Utils");
var SurveyDataSource = /** @class */ (function () {
    function SurveyDataSource(data) {
        if (Utils.isNullOrUndefined(data)) {
            throw new Error("data must not be null");
        }
        if (Utils.isNullOrUndefined(data.id) || data.id === "") {
            throw new Error("data.id must not be null or empty");
        }
        if (Utils.isNullOrUndefined(data.governedChannelType)) {
            data.governedChannelType = GovernedChannel_1.GovernedChannelType.getDefault();
        }
        if (Utils.isNullOrUndefined(data.expirationTimeUtc) || data.expirationTimeUtc === "") {
            throw new Error("data.expirationTimeUtc must not be null or empty");
        }
        if (Utils.isNullOrUndefined(data.activationEvent)) {
            throw new Error("data.activationEvent must not be null");
        }
        if (Utils.isNullOrUndefined(data.backEndIdentifier) || data.backEndIdentifier === "") {
            data.backEndIdentifier = data.id;
        }
        this.data = data;
    }
    // @Override
    SurveyDataSource.prototype.getId = function () {
        return this.data.id;
    };
    // @Override
    SurveyDataSource.prototype.getBackEndId = function () {
        return this.data.backEndIdentifier;
    };
    // @Override
    SurveyDataSource.prototype.getGovernedChannelType = function () {
        return this.data.governedChannelType;
    };
    // @Override
    SurveyDataSource.prototype.getRawStartTimeUtc = function () {
        return this.data.startTimeUtc;
    };
    // @Override
    SurveyDataSource.prototype.getStartTimeUtc = function () {
        if (Utils.isNullOrUndefined(this.data.startTimeUtc)) {
            return Utils.getDistantPast(); // Optional start date means the survey has started
        }
        var parsed = new Date(this.data.startTimeUtc);
        if (!Utils.isDate(parsed)) {
            return Utils.getDistantFuture(); // Badly specified start dates means the survey never starts
        }
        return parsed;
    };
    // @Override
    SurveyDataSource.prototype.getExpirationTimeUtc = function () {
        // Bad or missing expiration date means survey is always expired.
        if (Utils.isNullOrUndefined(this.data.expirationTimeUtc)) {
            return Utils.getDistantPast();
        }
        var parsed = new Date(this.data.expirationTimeUtc);
        if (!Utils.isDate(parsed)) {
            return Utils.getDistantPast();
        }
        return parsed;
    };
    // @Override
    SurveyDataSource.prototype.getRawExpirationTimeUtc = function () {
        return this.data.expirationTimeUtc;
    };
    // @Override
    SurveyDataSource.prototype.isActiveForDate = function (date) {
        if (Utils.isNullOrUndefined(date)) {
            return false;
        }
        return (date >= this.getStartTimeUtc() && date <= this.getExpirationTimeUtc());
    };
    // @Override
    SurveyDataSource.prototype.getActivationEvent = function () {
        return this.data.activationEvent;
    };
    // @Override
    SurveyDataSource.prototype.getPreferredLaunchType = function () {
        return this.data.preferredLaunchType;
    };
    // @Override
    SurveyDataSource.prototype.isAdditionalDataRequested = function (additionalDataToCheck) {
        for (var _i = 0, _a = this.data.additionalDataRequested; _i < _a.length; _i++) {
            var additionalData = _a[_i];
            if (additionalData === additionalDataToCheck) {
                return true;
            }
        }
        return false;
    };
    // @Override
    SurveyDataSource.prototype.getDomElements = function (doc) {
        if (!doc) {
            throw new Error("Document must not be null");
        }
        var typeElement = doc.createElement(ISurveyInfo.DOM_TYPE_TAGNAME);
        typeElement.appendChild(doc.createTextNode(ISurveyInfo.DOM_TYPE_VALUE));
        var idElement = doc.createElement(ISurveyInfo.DOM_ID_TAGNAME);
        idElement.appendChild(doc.createTextNode(this.getBackEndId()));
        return [typeElement, idElement];
    };
    // @Override
    SurveyDataSource.prototype.getJsonElements = function () {
        var surveyObject = {};
        surveyObject[ISurveyInfo.JSON_ID_KEYNAME] = this.getBackEndId();
        var result = {};
        result[ISurveyInfo.JSON_SURVEY_KEYNAME] = surveyObject;
        return result;
    };
    return SurveyDataSource;
}());
(function (SurveyDataSource) {
    /**
     * Basic data needed for all Surveys
     */
    var SurveyDataSourceData = /** @class */ (function () {
        function SurveyDataSourceData() {
            this.preferredLaunchType = ISurveyInfo.LaunchType.Default;
        }
        return SurveyDataSourceData;
    }());
    SurveyDataSource.SurveyDataSourceData = SurveyDataSourceData;
})(SurveyDataSource || (SurveyDataSource = {}));
module.exports = SurveyDataSource;

},{"../GovernedChannel":18,"../ISurveyInfo":22,"../Utils":36}],36:[function(require,module,exports){
"use strict";
/*
 * Utils.ts
 *
 * Module for utility functions
 */
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Add time to a given date
 * Example, timeAdd(new Date(), 'minute', 5)  //returns 5 minutes from now
 * @param date  Date to start with
 * @param interval  One of: hour or h, minute or m, second or s
 * @param units  units of the given interval to add
 * @return date
 */
function timeAdd(date, interval, units) {
    switch (interval.toLowerCase()) {
        case "h":
        case "hour":
            return new Date(date.getTime() + (units * 3600000));
        case "m":
        case "minute":
            return new Date(date.getTime() + (units * 60000));
        case "s":
        case "second":
            return new Date(date.getTime() + (units * 1000));
        default:
            throw new Error("Invalid interval value of " + interval);
    }
}
exports.timeAdd = timeAdd;
/**
 * Check if an input value is a valid date, null or undefined return false.
 * @param input  input value
 * @return boolean
 */
function isDate(input) {
    if (Object.prototype.toString.call(input) === "[object Date]") {
        // it is a date
        if (!(isNaN(input.getTime()))) {
            return true;
        }
    }
    return false;
}
exports.isDate = isDate;
/**
 * Check if an input value is a valid value in the input enum
 * @param value  input value
 * @param input  input enum
 * Returns true if value exists in the enum
 */
function isEnumValue(value, input) {
    return (value in input);
}
exports.isEnumValue = isEnumValue;
/**
 * Check if an input value is a number
 * @param value: input value
 */
function isNumber(value) {
    return (value !== null && !isNaN(value) && isFinite(value));
}
exports.isNumber = isNumber;
/**
 * Check if an input value is null or undefined
 * @param value: input value
 */
function isNullOrUndefined(value) {
    return (value === null || value === undefined);
}
exports.isNullOrUndefined = isNullOrUndefined;
/**
 * Check if an input value is an object
 * @param value: input value
 */
function isObject(value) {
    return (value !== null && value !== undefined && (typeof value === "object"));
}
exports.isObject = isObject;
/**
 * Check if given value is a string
 * @param {any} value value
 */
function isString(value) {
    return (typeof value === "string");
}
exports.isString = isString;
/**
 * Check if value is an object
 * @param {any} value value
 */
function isBoolean(value) {
    return typeof (value) === "boolean";
}
exports.isBoolean = isBoolean;
/**
 * Returns a lower temporal boundary
 * @return date
 */
function getDistantPast() {
    // Corresponds to UTC 0001-12-30T00:00:00Z
    return new Date(-62104233600000);
}
exports.getDistantPast = getDistantPast;
/**
 * Get an upper temporal boundary
 * @return date
 */
function getDistantFuture() {
    // Corresponds to UTC 4001-01-01T00:00:00Z
    return new Date(64092211200000);
}
exports.getDistantFuture = getDistantFuture;
exports.MAX_DATE_MILLISECONDS = 8640000000000000;
exports.MIN_DATE_MILLISECONDS = -8640000000000000;
/**
 * Adds seconds to a date, if overflows returns Date(Number.Max_VALUE)
 *
 * @param date    date to add to
 * @param seconds seconds as number
 * @return Resulting date
 */
function addSecondsWithoutOverflow(date, seconds) {
    if (!date) {
        return null;
    }
    if (seconds < 0) {
        return subtractSecondsWithoutOverflow(date, -1 * seconds);
    }
    else {
        var milliseconds = date.getTime() + seconds * 1000;
        if (milliseconds < exports.MAX_DATE_MILLISECONDS) {
            return new Date(milliseconds);
        }
        else {
            return new Date(exports.MAX_DATE_MILLISECONDS);
        }
    }
}
exports.addSecondsWithoutOverflow = addSecondsWithoutOverflow;
/**
 * Subtracts seconds from a date, if overflows returns Date(Number.MIN_VALUE)
 *
 * @param date   date to subtract from
 * @param seconds seconds as number
 * @return Resulting date
 */
function subtractSecondsWithoutOverflow(date, seconds) {
    if (!date) {
        return null;
    }
    if (seconds < 0) {
        seconds = -seconds;
        return this.addSecondsWithoutOverflow(date, seconds);
    }
    var milliseconds = date.getTime() - (seconds * 1000);
    if (milliseconds > exports.MIN_DATE_MILLISECONDS) {
        return new Date(milliseconds);
    }
    else {
        return new Date(exports.MIN_DATE_MILLISECONDS);
    }
}
exports.subtractSecondsWithoutOverflow = subtractSecondsWithoutOverflow;
// region Language related
/**
 * Effectively un-anchored on the right side because tags can have many more trailing sub-parts than we care to extract
 * Refer to https://www.ietf.org/rfc/rfc5646.txt
 */
var LANGUAGE_AND_SCRIPT_TAG_PATTERN = "^" +
    // capture 1:language subtag
    "(" +
    "(?:[a-zA-Z]{2,3}(?:-[a-zA-Z]{3}){0,3})" + // 2-3 Alpha chars, followed by up to three optional extension tags, each of format -AAA, A=Alpha char
    "|" +
    "(?:[a-zA-Z]{4,8})" + // 4-Alpha chars (reserved in standard) or 5-8 Alpha chars
    ")" +
    "(?:" +
    "-" +
    // capture 2: optional script subtag (without leading dash), exactly 4 alpha chars
    "([a-zA-Z]{4})" + // 4-Alpha chars
    ")?" +
    // capture 3: optional region subtag (without leading dash), exactly 2 alpha chars or 3 digits
    "(?:-([a-zA-Z]{2}|[0-9]{3}))?" +
    "(" +
    // capture 4: any left-overs, rejecting remainder strings that don't end here or lead with a dash.
    "-.*" +
    ")?" +
    "$";
function isValidLanguageSubTag(subTag) {
    if (!subTag) {
        return false;
    }
    var extractedSubTag = extractLanguageSubtag(subTag);
    if (!extractedSubTag) {
        return false;
    }
    return extractedSubTag === subTag;
}
exports.isValidLanguageSubTag = isValidLanguageSubTag;
function extractLanguageSubtag(language) {
    if (!language) {
        return null;
    }
    var matches = language.match(LANGUAGE_AND_SCRIPT_TAG_PATTERN);
    if (!matches || matches.length < 1 || !isNullOrUndefined(matches[4])) {
        return null;
    }
    // return the first capture group which should be the original input if there is a match
    // For example, "en-US" input should return "en-US", and "en" input should return "en".
    return matches[0];
}
exports.extractLanguageSubtag = extractLanguageSubtag;
// endregion
/**
 * Create guid string
 */
function guid() {
    // Stitch in '4' in the third group
    return (randomHex4() + randomHex4() + "-" + randomHex4() + "-4" + randomHex4().substr(0, 3) + "-" + randomHex4() + "-"
        + randomHex4() + randomHex4() + randomHex4()).toLowerCase();
}
exports.guid = guid;
/**
 * Create random Hex4 string
 */
function randomHex4() {
    return (Math.floor(((1 + Math.random()) * 0x10000))).toString(16).substring(1);
}
/**
 * Create an array from input object values sorted by object key
 * @param Object input object
 * @return array
 */
function makeArrayFromObjectValuesSortedByKeyString(object) {
    var keys = Object.keys(object);
    keys.sort();
    var values = [];
    for (var id in keys) {
        if (keys.hasOwnProperty(id)) {
            var key = keys[id];
            values.push(object[key]);
        }
    }
    return values;
}
exports.makeArrayFromObjectValuesSortedByKeyString = makeArrayFromObjectValuesSortedByKeyString;
/**
 * Create a date object from an input string
 * @param Object input string
 * @return date
 */
function stringToDate(input) {
    if (!isString(input)) {
        return null;
    }
    var newDate = input ? new Date(input) : null;
    return isDate(newDate) ? newDate : null;
}
exports.stringToDate = stringToDate;
/**
 * Takes two objects (source, target) and returns the target object with values in the source added to it.
 * It overwrites any source properties which already exist in target.
 */
function overrideValues(sourceObject, targetobject) {
    if (!targetobject) {
        return targetobject;
    }
    var result = targetobject;
    if (sourceObject) {
        for (var field in sourceObject) {
            if (sourceObject.hasOwnProperty(field)) {
                result[field] = sourceObject[field];
            }
        }
    }
    return result;
}
exports.overrideValues = overrideValues;
/**
 * Test a string is in our supported ISO8601 UTC format of "yyyy-MM-ddTHH:mm:ssZ" and "yyyy-MM-ddTHH:mm:ss.fffZ"
 * @param input Input string to be evaluated.
 */
function isUtcDatetimeString(input) {
    if (!isString(input)) {
        return false;
    }
    var supportedUtcRegex = /^(\d{4}\-\d\d\-\d\dT\d\d:\d\d:\d\d(\.\d\d\d)?Z)$/;
    return supportedUtcRegex.test(input);
}
exports.isUtcDatetimeString = isUtcDatetimeString;
/**
 * Convert a date object to a string in ISO8601 UTC format supported by Floodgate ("yyyy-MM-ddTHH:mm:ssZ")
 * @param input Input date object
 */
function dateToShortUtcString(input) {
    if (!isDate(input)) {
        return null;
    }
    function pad(n) {
        return (n < 10) ? ("0" + n) : n.toString();
    }
    return input.getUTCFullYear() +
        "-" + pad(input.getUTCMonth() + 1) +
        "-" + pad(input.getUTCDate()) +
        "T" + pad(input.getUTCHours()) +
        ":" + pad(input.getUTCMinutes()) +
        ":" + pad(input.getUTCSeconds()) +
        "Z";
}
exports.dateToShortUtcString = dateToShortUtcString;

},{}],37:[function(require,module,exports){
(function (process,global){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.4+314e4831
 */

(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
	typeof define === 'function' && define.amd ? define(factory) :
	(global.ES6Promise = factory());
}(this, (function () { 'use strict';

function objectOrFunction(x) {
  var type = typeof x;
  return x !== null && (type === 'object' || type === 'function');
}

function isFunction(x) {
  return typeof x === 'function';
}



var _isArray = void 0;
if (Array.isArray) {
  _isArray = Array.isArray;
} else {
  _isArray = function (x) {
    return Object.prototype.toString.call(x) === '[object Array]';
  };
}

var isArray = _isArray;

var len = 0;
var vertxNext = void 0;
var customSchedulerFn = void 0;

var asap = function asap(callback, arg) {
  queue[len] = callback;
  queue[len + 1] = arg;
  len += 2;
  if (len === 2) {
    // If len is 2, that means that we need to schedule an async flush.
    // If additional callbacks are queued before the queue is flushed, they
    // will be processed by this flush that we are scheduling.
    if (customSchedulerFn) {
      customSchedulerFn(flush);
    } else {
      scheduleFlush();
    }
  }
};

function setScheduler(scheduleFn) {
  customSchedulerFn = scheduleFn;
}

function setAsap(asapFn) {
  asap = asapFn;
}

var browserWindow = typeof window !== 'undefined' ? window : undefined;
var browserGlobal = browserWindow || {};
var BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;
var isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';

// test for web worker but not in IE10
var isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';

// node
function useNextTick() {
  // node version 0.10.x displays a deprecation warning when nextTick is used recursively
  // see https://github.com/cujojs/when/issues/410 for details
  return function () {
    return process.nextTick(flush);
  };
}

// vertx
function useVertxTimer() {
  if (typeof vertxNext !== 'undefined') {
    return function () {
      vertxNext(flush);
    };
  }

  return useSetTimeout();
}

function useMutationObserver() {
  var iterations = 0;
  var observer = new BrowserMutationObserver(flush);
  var node = document.createTextNode('');
  observer.observe(node, { characterData: true });

  return function () {
    node.data = iterations = ++iterations % 2;
  };
}

// web worker
function useMessageChannel() {
  var channel = new MessageChannel();
  channel.port1.onmessage = flush;
  return function () {
    return channel.port2.postMessage(0);
  };
}

function useSetTimeout() {
  // Store setTimeout reference so es6-promise will be unaffected by
  // other code modifying setTimeout (like sinon.useFakeTimers())
  var globalSetTimeout = setTimeout;
  return function () {
    return globalSetTimeout(flush, 1);
  };
}

var queue = new Array(1000);
function flush() {
  for (var i = 0; i < len; i += 2) {
    var callback = queue[i];
    var arg = queue[i + 1];

    callback(arg);

    queue[i] = undefined;
    queue[i + 1] = undefined;
  }

  len = 0;
}

function attemptVertx() {
  try {
    var vertx = Function('return this')().require('vertx');
    vertxNext = vertx.runOnLoop || vertx.runOnContext;
    return useVertxTimer();
  } catch (e) {
    return useSetTimeout();
  }
}

var scheduleFlush = void 0;
// Decide what async method to use to triggering processing of queued callbacks:
if (isNode) {
  scheduleFlush = useNextTick();
} else if (BrowserMutationObserver) {
  scheduleFlush = useMutationObserver();
} else if (isWorker) {
  scheduleFlush = useMessageChannel();
} else if (browserWindow === undefined && typeof require === 'function') {
  scheduleFlush = attemptVertx();
} else {
  scheduleFlush = useSetTimeout();
}

function then(onFulfillment, onRejection) {
  var parent = this;

  var child = new this.constructor(noop);

  if (child[PROMISE_ID] === undefined) {
    makePromise(child);
  }

  var _state = parent._state;


  if (_state) {
    var callback = arguments[_state - 1];
    asap(function () {
      return invokeCallback(_state, child, callback, parent._result);
    });
  } else {
    subscribe(parent, child, onFulfillment, onRejection);
  }

  return child;
}

/**
  `Promise.resolve` returns a promise that will become resolved with the
  passed `value`. It is shorthand for the following:

  ```javascript
  let promise = new Promise(function(resolve, reject){
    resolve(1);
  });

  promise.then(function(value){
    // value === 1
  });
  ```

  Instead of writing the above, your code now simply becomes the following:

  ```javascript
  let promise = Promise.resolve(1);

  promise.then(function(value){
    // value === 1
  });
  ```

  @method resolve
  @static
  @param {Any} value value that the returned promise will be resolved with
  Useful for tooling.
  @return {Promise} a promise that will become fulfilled with the given
  `value`
*/
function resolve$1(object) {
  /*jshint validthis:true */
  var Constructor = this;

  if (object && typeof object === 'object' && object.constructor === Constructor) {
    return object;
  }

  var promise = new Constructor(noop);
  resolve(promise, object);
  return promise;
}

var PROMISE_ID = Math.random().toString(36).substring(2);

function noop() {}

var PENDING = void 0;
var FULFILLED = 1;
var REJECTED = 2;

var TRY_CATCH_ERROR = { error: null };

function selfFulfillment() {
  return new TypeError("You cannot resolve a promise with itself");
}

function cannotReturnOwn() {
  return new TypeError('A promises callback cannot return that same promise.');
}

function getThen(promise) {
  try {
    return promise.then;
  } catch (error) {
    TRY_CATCH_ERROR.error = error;
    return TRY_CATCH_ERROR;
  }
}

function tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {
  try {
    then$$1.call(value, fulfillmentHandler, rejectionHandler);
  } catch (e) {
    return e;
  }
}

function handleForeignThenable(promise, thenable, then$$1) {
  asap(function (promise) {
    var sealed = false;
    var error = tryThen(then$$1, thenable, function (value) {
      if (sealed) {
        return;
      }
      sealed = true;
      if (thenable !== value) {
        resolve(promise, value);
      } else {
        fulfill(promise, value);
      }
    }, function (reason) {
      if (sealed) {
        return;
      }
      sealed = true;

      reject(promise, reason);
    }, 'Settle: ' + (promise._label || ' unknown promise'));

    if (!sealed && error) {
      sealed = true;
      reject(promise, error);
    }
  }, promise);
}

function handleOwnThenable(promise, thenable) {
  if (thenable._state === FULFILLED) {
    fulfill(promise, thenable._result);
  } else if (thenable._state === REJECTED) {
    reject(promise, thenable._result);
  } else {
    subscribe(thenable, undefined, function (value) {
      return resolve(promise, value);
    }, function (reason) {
      return reject(promise, reason);
    });
  }
}

function handleMaybeThenable(promise, maybeThenable, then$$1) {
  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {
    handleOwnThenable(promise, maybeThenable);
  } else {
    if (then$$1 === TRY_CATCH_ERROR) {
      reject(promise, TRY_CATCH_ERROR.error);
      TRY_CATCH_ERROR.error = null;
    } else if (then$$1 === undefined) {
      fulfill(promise, maybeThenable);
    } else if (isFunction(then$$1)) {
      handleForeignThenable(promise, maybeThenable, then$$1);
    } else {
      fulfill(promise, maybeThenable);
    }
  }
}

function resolve(promise, value) {
  if (promise === value) {
    reject(promise, selfFulfillment());
  } else if (objectOrFunction(value)) {
    handleMaybeThenable(promise, value, getThen(value));
  } else {
    fulfill(promise, value);
  }
}

function publishRejection(promise) {
  if (promise._onerror) {
    promise._onerror(promise._result);
  }

  publish(promise);
}

function fulfill(promise, value) {
  if (promise._state !== PENDING) {
    return;
  }

  promise._result = value;
  promise._state = FULFILLED;

  if (promise._subscribers.length !== 0) {
    asap(publish, promise);
  }
}

function reject(promise, reason) {
  if (promise._state !== PENDING) {
    return;
  }
  promise._state = REJECTED;
  promise._result = reason;

  asap(publishRejection, promise);
}

function subscribe(parent, child, onFulfillment, onRejection) {
  var _subscribers = parent._subscribers;
  var length = _subscribers.length;


  parent._onerror = null;

  _subscribers[length] = child;
  _subscribers[length + FULFILLED] = onFulfillment;
  _subscribers[length + REJECTED] = onRejection;

  if (length === 0 && parent._state) {
    asap(publish, parent);
  }
}

function publish(promise) {
  var subscribers = promise._subscribers;
  var settled = promise._state;

  if (subscribers.length === 0) {
    return;
  }

  var child = void 0,
      callback = void 0,
      detail = promise._result;

  for (var i = 0; i < subscribers.length; i += 3) {
    child = subscribers[i];
    callback = subscribers[i + settled];

    if (child) {
      invokeCallback(settled, child, callback, detail);
    } else {
      callback(detail);
    }
  }

  promise._subscribers.length = 0;
}

function tryCatch(callback, detail) {
  try {
    return callback(detail);
  } catch (e) {
    TRY_CATCH_ERROR.error = e;
    return TRY_CATCH_ERROR;
  }
}

function invokeCallback(settled, promise, callback, detail) {
  var hasCallback = isFunction(callback),
      value = void 0,
      error = void 0,
      succeeded = void 0,
      failed = void 0;

  if (hasCallback) {
    value = tryCatch(callback, detail);

    if (value === TRY_CATCH_ERROR) {
      failed = true;
      error = value.error;
      value.error = null;
    } else {
      succeeded = true;
    }

    if (promise === value) {
      reject(promise, cannotReturnOwn());
      return;
    }
  } else {
    value = detail;
    succeeded = true;
  }

  if (promise._state !== PENDING) {
    // noop
  } else if (hasCallback && succeeded) {
    resolve(promise, value);
  } else if (failed) {
    reject(promise, error);
  } else if (settled === FULFILLED) {
    fulfill(promise, value);
  } else if (settled === REJECTED) {
    reject(promise, value);
  }
}

function initializePromise(promise, resolver) {
  try {
    resolver(function resolvePromise(value) {
      resolve(promise, value);
    }, function rejectPromise(reason) {
      reject(promise, reason);
    });
  } catch (e) {
    reject(promise, e);
  }
}

var id = 0;
function nextId() {
  return id++;
}

function makePromise(promise) {
  promise[PROMISE_ID] = id++;
  promise._state = undefined;
  promise._result = undefined;
  promise._subscribers = [];
}

function validationError() {
  return new Error('Array Methods must be provided an Array');
}

var Enumerator = function () {
  function Enumerator(Constructor, input) {
    this._instanceConstructor = Constructor;
    this.promise = new Constructor(noop);

    if (!this.promise[PROMISE_ID]) {
      makePromise(this.promise);
    }

    if (isArray(input)) {
      this.length = input.length;
      this._remaining = input.length;

      this._result = new Array(this.length);

      if (this.length === 0) {
        fulfill(this.promise, this._result);
      } else {
        this.length = this.length || 0;
        this._enumerate(input);
        if (this._remaining === 0) {
          fulfill(this.promise, this._result);
        }
      }
    } else {
      reject(this.promise, validationError());
    }
  }

  Enumerator.prototype._enumerate = function _enumerate(input) {
    for (var i = 0; this._state === PENDING && i < input.length; i++) {
      this._eachEntry(input[i], i);
    }
  };

  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {
    var c = this._instanceConstructor;
    var resolve$$1 = c.resolve;


    if (resolve$$1 === resolve$1) {
      var _then = getThen(entry);

      if (_then === then && entry._state !== PENDING) {
        this._settledAt(entry._state, i, entry._result);
      } else if (typeof _then !== 'function') {
        this._remaining--;
        this._result[i] = entry;
      } else if (c === Promise$1) {
        var promise = new c(noop);
        handleMaybeThenable(promise, entry, _then);
        this._willSettleAt(promise, i);
      } else {
        this._willSettleAt(new c(function (resolve$$1) {
          return resolve$$1(entry);
        }), i);
      }
    } else {
      this._willSettleAt(resolve$$1(entry), i);
    }
  };

  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {
    var promise = this.promise;


    if (promise._state === PENDING) {
      this._remaining--;

      if (state === REJECTED) {
        reject(promise, value);
      } else {
        this._result[i] = value;
      }
    }

    if (this._remaining === 0) {
      fulfill(promise, this._result);
    }
  };

  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {
    var enumerator = this;

    subscribe(promise, undefined, function (value) {
      return enumerator._settledAt(FULFILLED, i, value);
    }, function (reason) {
      return enumerator._settledAt(REJECTED, i, reason);
    });
  };

  return Enumerator;
}();

/**
  `Promise.all` accepts an array of promises, and returns a new promise which
  is fulfilled with an array of fulfillment values for the passed promises, or
  rejected with the reason of the first passed promise to be rejected. It casts all
  elements of the passed iterable to promises as it runs this algorithm.

  Example:

  ```javascript
  let promise1 = resolve(1);
  let promise2 = resolve(2);
  let promise3 = resolve(3);
  let promises = [ promise1, promise2, promise3 ];

  Promise.all(promises).then(function(array){
    // The array here would be [ 1, 2, 3 ];
  });
  ```

  If any of the `promises` given to `all` are rejected, the first promise
  that is rejected will be given as an argument to the returned promises's
  rejection handler. For example:

  Example:

  ```javascript
  let promise1 = resolve(1);
  let promise2 = reject(new Error("2"));
  let promise3 = reject(new Error("3"));
  let promises = [ promise1, promise2, promise3 ];

  Promise.all(promises).then(function(array){
    // Code here never runs because there are rejected promises!
  }, function(error) {
    // error.message === "2"
  });
  ```

  @method all
  @static
  @param {Array} entries array of promises
  @param {String} label optional string for labeling the promise.
  Useful for tooling.
  @return {Promise} promise that is fulfilled when all `promises` have been
  fulfilled, or rejected if any of them become rejected.
  @static
*/
function all(entries) {
  return new Enumerator(this, entries).promise;
}

/**
  `Promise.race` returns a new promise which is settled in the same way as the
  first passed promise to settle.

  Example:

  ```javascript
  let promise1 = new Promise(function(resolve, reject){
    setTimeout(function(){
      resolve('promise 1');
    }, 200);
  });

  let promise2 = new Promise(function(resolve, reject){
    setTimeout(function(){
      resolve('promise 2');
    }, 100);
  });

  Promise.race([promise1, promise2]).then(function(result){
    // result === 'promise 2' because it was resolved before promise1
    // was resolved.
  });
  ```

  `Promise.race` is deterministic in that only the state of the first
  settled promise matters. For example, even if other promises given to the
  `promises` array argument are resolved, but the first settled promise has
  become rejected before the other promises became fulfilled, the returned
  promise will become rejected:

  ```javascript
  let promise1 = new Promise(function(resolve, reject){
    setTimeout(function(){
      resolve('promise 1');
    }, 200);
  });

  let promise2 = new Promise(function(resolve, reject){
    setTimeout(function(){
      reject(new Error('promise 2'));
    }, 100);
  });

  Promise.race([promise1, promise2]).then(function(result){
    // Code here never runs
  }, function(reason){
    // reason.message === 'promise 2' because promise 2 became rejected before
    // promise 1 became fulfilled
  });
  ```

  An example real-world use case is implementing timeouts:

  ```javascript
  Promise.race([ajax('foo.json'), timeout(5000)])
  ```

  @method race
  @static
  @param {Array} promises array of promises to observe
  Useful for tooling.
  @return {Promise} a promise which settles in the same way as the first passed
  promise to settle.
*/
function race(entries) {
  /*jshint validthis:true */
  var Constructor = this;

  if (!isArray(entries)) {
    return new Constructor(function (_, reject) {
      return reject(new TypeError('You must pass an array to race.'));
    });
  } else {
    return new Constructor(function (resolve, reject) {
      var length = entries.length;
      for (var i = 0; i < length; i++) {
        Constructor.resolve(entries[i]).then(resolve, reject);
      }
    });
  }
}

/**
  `Promise.reject` returns a promise rejected with the passed `reason`.
  It is shorthand for the following:

  ```javascript
  let promise = new Promise(function(resolve, reject){
    reject(new Error('WHOOPS'));
  });

  promise.then(function(value){
    // Code here doesn't run because the promise is rejected!
  }, function(reason){
    // reason.message === 'WHOOPS'
  });
  ```

  Instead of writing the above, your code now simply becomes the following:

  ```javascript
  let promise = Promise.reject(new Error('WHOOPS'));

  promise.then(function(value){
    // Code here doesn't run because the promise is rejected!
  }, function(reason){
    // reason.message === 'WHOOPS'
  });
  ```

  @method reject
  @static
  @param {Any} reason value that the returned promise will be rejected with.
  Useful for tooling.
  @return {Promise} a promise rejected with the given `reason`.
*/
function reject$1(reason) {
  /*jshint validthis:true */
  var Constructor = this;
  var promise = new Constructor(noop);
  reject(promise, reason);
  return promise;
}

function needsResolver() {
  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');
}

function needsNew() {
  throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
}

/**
  Promise objects represent the eventual result of an asynchronous operation. The
  primary way of interacting with a promise is through its `then` method, which
  registers callbacks to receive either a promise's eventual value or the reason
  why the promise cannot be fulfilled.

  Terminology
  -----------

  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.
  - `thenable` is an object or function that defines a `then` method.
  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).
  - `exception` is a value that is thrown using the throw statement.
  - `reason` is a value that indicates why a promise was rejected.
  - `settled` the final resting state of a promise, fulfilled or rejected.

  A promise can be in one of three states: pending, fulfilled, or rejected.

  Promises that are fulfilled have a fulfillment value and are in the fulfilled
  state.  Promises that are rejected have a rejection reason and are in the
  rejected state.  A fulfillment value is never a thenable.

  Promises can also be said to *resolve* a value.  If this value is also a
  promise, then the original promise's settled state will match the value's
  settled state.  So a promise that *resolves* a promise that rejects will
  itself reject, and a promise that *resolves* a promise that fulfills will
  itself fulfill.


  Basic Usage:
  ------------

  ```js
  let promise = new Promise(function(resolve, reject) {
    // on success
    resolve(value);

    // on failure
    reject(reason);
  });

  promise.then(function(value) {
    // on fulfillment
  }, function(reason) {
    // on rejection
  });
  ```

  Advanced Usage:
  ---------------

  Promises shine when abstracting away asynchronous interactions such as
  `XMLHttpRequest`s.

  ```js
  function getJSON(url) {
    return new Promise(function(resolve, reject){
      let xhr = new XMLHttpRequest();

      xhr.open('GET', url);
      xhr.onreadystatechange = handler;
      xhr.responseType = 'json';
      xhr.setRequestHeader('Accept', 'application/json');
      xhr.send();

      function handler() {
        if (this.readyState === this.DONE) {
          if (this.status === 200) {
            resolve(this.response);
          } else {
            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));
          }
        }
      };
    });
  }

  getJSON('/posts.json').then(function(json) {
    // on fulfillment
  }, function(reason) {
    // on rejection
  });
  ```

  Unlike callbacks, promises are great composable primitives.

  ```js
  Promise.all([
    getJSON('/posts'),
    getJSON('/comments')
  ]).then(function(values){
    values[0] // => postsJSON
    values[1] // => commentsJSON

    return values;
  });
  ```

  @class Promise
  @param {Function} resolver
  Useful for tooling.
  @constructor
*/

var Promise$1 = function () {
  function Promise(resolver) {
    this[PROMISE_ID] = nextId();
    this._result = this._state = undefined;
    this._subscribers = [];

    if (noop !== resolver) {
      typeof resolver !== 'function' && needsResolver();
      this instanceof Promise ? initializePromise(this, resolver) : needsNew();
    }
  }

  /**
  The primary way of interacting with a promise is through its `then` method,
  which registers callbacks to receive either a promise's eventual value or the
  reason why the promise cannot be fulfilled.
   ```js
  findUser().then(function(user){
    // user is available
  }, function(reason){
    // user is unavailable, and you are given the reason why
  });
  ```
   Chaining
  --------
   The return value of `then` is itself a promise.  This second, 'downstream'
  promise is resolved with the return value of the first promise's fulfillment
  or rejection handler, or rejected if the handler throws an exception.
   ```js
  findUser().then(function (user) {
    return user.name;
  }, function (reason) {
    return 'default name';
  }).then(function (userName) {
    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it
    // will be `'default name'`
  });
   findUser().then(function (user) {
    throw new Error('Found user, but still unhappy');
  }, function (reason) {
    throw new Error('`findUser` rejected and we're unhappy');
  }).then(function (value) {
    // never reached
  }, function (reason) {
    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.
    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.
  });
  ```
  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.
   ```js
  findUser().then(function (user) {
    throw new PedagogicalException('Upstream error');
  }).then(function (value) {
    // never reached
  }).then(function (value) {
    // never reached
  }, function (reason) {
    // The `PedgagocialException` is propagated all the way down to here
  });
  ```
   Assimilation
  ------------
   Sometimes the value you want to propagate to a downstream promise can only be
  retrieved asynchronously. This can be achieved by returning a promise in the
  fulfillment or rejection handler. The downstream promise will then be pending
  until the returned promise is settled. This is called *assimilation*.
   ```js
  findUser().then(function (user) {
    return findCommentsByAuthor(user);
  }).then(function (comments) {
    // The user's comments are now available
  });
  ```
   If the assimliated promise rejects, then the downstream promise will also reject.
   ```js
  findUser().then(function (user) {
    return findCommentsByAuthor(user);
  }).then(function (comments) {
    // If `findCommentsByAuthor` fulfills, we'll have the value here
  }, function (reason) {
    // If `findCommentsByAuthor` rejects, we'll have the reason here
  });
  ```
   Simple Example
  --------------
   Synchronous Example
   ```javascript
  let result;
   try {
    result = findResult();
    // success
  } catch(reason) {
    // failure
  }
  ```
   Errback Example
   ```js
  findResult(function(result, err){
    if (err) {
      // failure
    } else {
      // success
    }
  });
  ```
   Promise Example;
   ```javascript
  findResult().then(function(result){
    // success
  }, function(reason){
    // failure
  });
  ```
   Advanced Example
  --------------
   Synchronous Example
   ```javascript
  let author, books;
   try {
    author = findAuthor();
    books  = findBooksByAuthor(author);
    // success
  } catch(reason) {
    // failure
  }
  ```
   Errback Example
   ```js
   function foundBooks(books) {
   }
   function failure(reason) {
   }
   findAuthor(function(author, err){
    if (err) {
      failure(err);
      // failure
    } else {
      try {
        findBoooksByAuthor(author, function(books, err) {
          if (err) {
            failure(err);
          } else {
            try {
              foundBooks(books);
            } catch(reason) {
              failure(reason);
            }
          }
        });
      } catch(error) {
        failure(err);
      }
      // success
    }
  });
  ```
   Promise Example;
   ```javascript
  findAuthor().
    then(findBooksByAuthor).
    then(function(books){
      // found books
  }).catch(function(reason){
    // something went wrong
  });
  ```
   @method then
  @param {Function} onFulfilled
  @param {Function} onRejected
  Useful for tooling.
  @return {Promise}
  */

  /**
  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same
  as the catch block of a try/catch statement.
  ```js
  function findAuthor(){
  throw new Error('couldn't find that author');
  }
  // synchronous
  try {
  findAuthor();
  } catch(reason) {
  // something went wrong
  }
  // async with promises
  findAuthor().catch(function(reason){
  // something went wrong
  });
  ```
  @method catch
  @param {Function} onRejection
  Useful for tooling.
  @return {Promise}
  */


  Promise.prototype.catch = function _catch(onRejection) {
    return this.then(null, onRejection);
  };

  /**
    `finally` will be invoked regardless of the promise's fate just as native
    try/catch/finally behaves
  
    Synchronous example:
  
    ```js
    findAuthor() {
      if (Math.random() > 0.5) {
        throw new Error();
      }
      return new Author();
    }
  
    try {
      return findAuthor(); // succeed or fail
    } catch(error) {
      return findOtherAuther();
    } finally {
      // always runs
      // doesn't affect the return value
    }
    ```
  
    Asynchronous example:
  
    ```js
    findAuthor().catch(function(reason){
      return findOtherAuther();
    }).finally(function(){
      // author was either found, or not
    });
    ```
  
    @method finally
    @param {Function} callback
    @return {Promise}
  */


  Promise.prototype.finally = function _finally(callback) {
    var promise = this;
    var constructor = promise.constructor;

    return promise.then(function (value) {
      return constructor.resolve(callback()).then(function () {
        return value;
      });
    }, function (reason) {
      return constructor.resolve(callback()).then(function () {
        throw reason;
      });
    });
  };

  return Promise;
}();

Promise$1.prototype.then = then;
Promise$1.all = all;
Promise$1.race = race;
Promise$1.resolve = resolve$1;
Promise$1.reject = reject$1;
Promise$1._setScheduler = setScheduler;
Promise$1._setAsap = setAsap;
Promise$1._asap = asap;

/*global self*/
function polyfill() {
  var local = void 0;

  if (typeof global !== 'undefined') {
    local = global;
  } else if (typeof self !== 'undefined') {
    local = self;
  } else {
    try {
      local = Function('return this')();
    } catch (e) {
      throw new Error('polyfill failed because global object is unavailable in this environment');
    }
  }

  var P = local.Promise;

  if (P) {
    var promiseToString = null;
    try {
      promiseToString = Object.prototype.toString.call(P.resolve());
    } catch (e) {
      // silently ignored
    }

    if (promiseToString === '[object Promise]' && !P.cast) {
      return;
    }
  }

  local.Promise = Promise$1;
}

// Strange compat..
Promise$1.polyfill = polyfill;
Promise$1.Promise = Promise$1;

return Promise$1;

})));





}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":38}],38:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],39:[function(require,module,exports){
"use strict";
/**
 * App_Common.ts
 *
 * Common logic for entrypoints.
 */
exports.__esModule = true;
var UIStrings = require("./UIStrings/UIStrings");
var Version_1 = require("./Version");
var Configuration = require("./Configuration/Configuration");
var Window = require("./Window/Window");
var Logging = require("./Logging/Logging");
var Theme = require("./Theme");
var es6_promise_1 = require("es6-promise");
var APP_NAME = "OfficeFeedbackSDK";
/**
 * Has the SDK been initialized
 */
var initialized = false;
/**
 * Load the style sheet
 * @param url The url of the stylesheet
 */
function loadStylesheet(url) {
    "use strict";
    var link = document.createElement("link");
    link.rel = "stylesheet";
    link.type = "text/css";
    link.href = url;
    var entry = document.getElementsByTagName("script")[0];
    entry.parentNode.insertBefore(link, entry);
}
/**
 * Load the script and callback after it is loaded
 * @param url The url of the script
 * @param callback The callback
 */
function loadScript(url) {
    return new es6_promise_1.Promise(function (resolve, reject) {
        var script = document.createElement("script");
        script.async = true;
        if (script.readyState) {
            script.onreadystatechange = function () {
                if (script.readyState === "loaded" || script.readyState === "complete") {
                    script.onreadystatechange = null;
                    resolve();
                }
            };
        }
        else {
            script.onload = function () {
                resolve();
            };
        }
        script.onerror = function () {
            reject();
        };
        script.src = url;
        var entry = document.getElementsByTagName("script")[0];
        entry.parentNode.insertBefore(script, entry);
    });
}
/**
 * Initialize common modules
 * @param initOptions init options
 */
function initializeModules(initOptions) {
    Logging.initialize(initOptions.environment, APP_NAME, Version_1["default"], (initOptions.telemetryGroup) ? initOptions.telemetryGroup.audienceGroup : undefined, initOptions.appId.toString(), initOptions.sessionId, initOptions.build);
    Theme.initialize(initOptions.primaryColour, initOptions.secondaryColour);
}
/**
 * Set ui Strings.
 * @param data the ui strings
 */
function setUIStrings(data) {
    UIStrings.setUIStrings(data);
}
;
/**
 * Initialize
 */
function initialize() {
    return new es6_promise_1.Promise(function (resolve, reject) {
        if (!initialized) {
            if (!Window.get().OfficeBrowserFeedback.initOptions) {
                reject("Window.OfficeBrowserFeedback.initOptions not set");
                return;
            }
            Window.get().OfficeBrowserFeedback.sdkVersion = Version_1["default"];
            Configuration.get().setCommonInitOptions(Window.get().OfficeBrowserFeedback.initOptions);
            var initOptionsCommon_1 = Configuration.get().getCommonInitOptions();
            loadStylesheet(initOptionsCommon_1.stylesUrl);
            var intlFileUrl_1 = initOptionsCommon_1.intlUrl + initOptionsCommon_1.locale.toLowerCase() + "/" +
                initOptionsCommon_1.intlFilename;
            loadScript(intlFileUrl_1)
                .then(function onLoadScriptFulfilled() {
                if (!UIStrings.getUIStrings()) {
                    reject("UiStrings were not loaded from " + intlFileUrl_1);
                    return;
                }
                initializeModules(initOptionsCommon_1);
                initialized = true;
                resolve();
            })["catch"](function onLoadScriptRejected(err) {
                reject("Script load failed for " + intlFileUrl_1);
            });
        }
        else {
            resolve();
        }
    });
}
exports.initialize = initialize;
/**
 * Reset the module. Used in unit tests.
 */
function reset() {
    initialized = false;
}
exports.reset = reset;
/* Make the setUIStrings method available globally */
Window.setSetUiStrings(setUIStrings);
},{"./Configuration/Configuration":42,"./Logging/Logging":54,"./Theme":60,"./UIStrings/UIStrings":65,"./Version":85,"./Window/Window":87,"es6-promise":37}],40:[function(require,module,exports){
"use strict";
/**
 * App_Floodgate.ts
 *
 * The entry point for floodgate.
 */
exports.__esModule = true;
var App_Common = require("./App_Common");
var UI = require("./UI/UI");
var Configuration = require("./Configuration/Configuration");
var Window = require("./Window/Window");
var AdaptiveSurveyLauncherFactory_1 = require("./FloodgateCore/AdaptiveSurveyLauncherFactory");
var CustomUISurvey_1 = require("./FloodgateCore/UISurvey/CustomUISurvey");
var DummyUISurvey_1 = require("./FloodgateCore/UISurvey/DummyUISurvey");
var FloodgateEnvironmentProvider_1 = require("./FloodgateCore/FloodgateEnvironmentProvider");
var FloodgateStorageProvider_1 = require("./FloodgateCore/FloodgateStorageProvider");
var FloodgateStringProvider_1 = require("./FloodgateCore/FloodgateStringProvider");
var FloodgateTelemetryLogger_1 = require("./FloodgateCore/FloodgateTelemetryLogger");
var officefloodgatecore_1 = require("@ms-ofb/officefloodgatecore");
var CampaignDefinitionProvider_1 = require("@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider");
var Api_1 = require("@ms-ofb/officefloodgatecore/dist/src/Api/Api");
var es6_promise_1 = require("es6-promise");
/**
 * Has floodgate been initialized
 */
var initialized = false;
/**
 * Has the control been opened. Prevents more than one dialog being generated.
 */
var opened = false;
var engine;
/**
 * Initialize. Must be called before any other call to floodgate.
 * @returns A promise which will be rejected if the call fails.
 */
function initialize() {
    return new es6_promise_1.Promise(function (resolve, reject) {
        if (!FloodgateStorageProvider_1["default"].isStorageAvailable()) {
            reject("window.localStorage is not available.");
            return;
        }
        if (!initialized) {
            App_Common.initialize()
                .then(function onInitializeFulfilled() {
                Window.get().OfficeBrowserFeedback.floodgate = Window.get().OfficeBrowserFeedback.floodgate || {};
                var floodgateInitOptions = Window.get().OfficeBrowserFeedback.floodgate.initOptions;
                floodgateInitOptions = floodgateInitOptions || {};
                // Validate and copy campaign definitions to local storage 
                if (floodgateInitOptions.campaignDefinitions !== undefined) {
                    var filteredResult = CampaignDefinitionProvider_1.FilterValidCampaignDefinitions(floodgateInitOptions.campaignDefinitions);
                    if (filteredResult.error) {
                        reject("floodgate.initOptions.campaignDefinitions error: " + filteredResult.error);
                        return;
                    }
                    (new FloodgateStorageProvider_1["default"]()).write(Api_1.IFloodgateStorageProvider.FileType.CampaignDefinitions, JSON.stringify(floodgateInitOptions.campaignDefinitions));
                }
                Configuration.get().setFloodgateInitOptions(Window.get().OfficeBrowserFeedback.floodgate.initOptions);
                officefloodgatecore_1.FloodgateEngine.setTelemetryLogger(new FloodgateTelemetryLogger_1["default"]());
                initialized = true;
                resolve();
            })["catch"](function onInitializeRejected(err) {
                reject("Initialization failed: {" + err + "}");
            });
        }
        else {
            resolve();
        }
    });
}
exports.initialize = initialize;
/**
 * To support the multi-window scenario on web we need to initialize the engine on each resume.
 * Hence this seperate method which does make() and start() together.
 */
function start() {
    return new es6_promise_1.Promise(function (resolve, reject) {
        try {
            engine = officefloodgatecore_1.FloodgateEngine.make(Configuration.get().getCommonInitOptions().build ? Configuration.get().getCommonInitOptions().build : "", new AdaptiveSurveyLauncherFactory_1["default"](), Configuration.get().getFloodgateInitOptions().onSurveyActivatedCallback, new FloodgateStorageProvider_1["default"](), new FloodgateStringProvider_1["default"](), new FloodgateEnvironmentProvider_1["default"]());
            engine.start();
        }
        catch (e) {
            reject("Failed to start floodgate engine: " + e.toString());
            return;
        }
        resolve();
    });
}
exports.start = start;
/**
 * A proxy for the engine.stop() method for consistency with the start() method.
 */
function stop() {
    if (engine) {
        engine.stop();
    }
}
exports.stop = stop;
/**
 * Get the engine object
 * @returns the engine object
 */
function getEngine() {
    return engine;
}
exports.getEngine = getEngine;
/**
 * Display the given Survey with it's prompt
 * @param survey the survey to show
 * @returns A promise which will be rejected if the call fails.
 */
function showSurvey(survey) {
    return new es6_promise_1.Promise(function (resolve, reject) {
        if (opened) {
            reject("Control already open");
            return;
        }
        Configuration.get().setFloodgateSurvey(survey ? survey : new DummyUISurvey_1["default"]());
        UI.createSurvey(function () { opened = false; });
        opened = true;
        resolve();
    });
}
exports.showSurvey = showSurvey;
/**
 * Method to allow users to launch a custom survey directly
 * @param survey the custom survey to show
 */
function showCustomSurvey(survey) {
    return showSurvey(new CustomUISurvey_1["default"](survey));
}
exports.showCustomSurvey = showCustomSurvey;
/**
 * Reset the floodgate module. Used in unit tests.
 */
function reset() {
    App_Common.reset();
    initialized = false;
    opened = false;
}
exports.reset = reset;
Window.setFloodgateShowCustomSurvey(showCustomSurvey);
Window.setFloodgateShowSurvey(showSurvey);
Window.setFloodgateGetEngine(getEngine);
Window.setFloodgateInitialize(initialize);
Window.setFloodgateStart(start);
Window.setFloodgateStop(stop);
},{"./App_Common":39,"./Configuration/Configuration":42,"./FloodgateCore/AdaptiveSurveyLauncherFactory":44,"./FloodgateCore/FloodgateEnvironmentProvider":45,"./FloodgateCore/FloodgateStorageProvider":46,"./FloodgateCore/FloodgateStringProvider":47,"./FloodgateCore/FloodgateTelemetryLogger":48,"./FloodgateCore/UISurvey/CustomUISurvey":49,"./FloodgateCore/UISurvey/DummyUISurvey":50,"./UI/UI":82,"./Window/Window":87,"@ms-ofb/officefloodgatecore":1,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5,"@ms-ofb/officefloodgatecore/dist/src/Campaign/CampaignDefinitionProvider":12,"es6-promise":37}],41:[function(require,module,exports){
"use strict";
/**
 * App_inAppFeedback.ts
 *
 * The entry point for inAppFeedback.
 */
exports.__esModule = true;
var App_Common = require("./App_Common");
var Configuration = require("./Configuration/Configuration");
var Logging = require("./Logging/Logging");
var UI = require("./UI/UI");
var Window = require("./Window/Window");
var es6_promise_1 = require("es6-promise");
/**
 * Has inAppFeedback been initialized
 */
var initialized = false;
/**
 * Initialize
 * @returns A promise which will be rejected if the call fails.
 */
function initialize() {
    return new es6_promise_1.Promise(function (resolve, reject) {
        if (!initialized) {
            App_Common.initialize()
                .then(function onInitializeFulfilled() {
                if (!Window.get().OfficeBrowserFeedback.initOptions) {
                    reject("Window.OfficeBrowserFeedback.initOptions not set");
                    return;
                }
                Configuration.get().setInAppFeedbackInitOptions(Window.get().OfficeBrowserFeedback.initOptions);
                initialized = true;
                resolve();
            })["catch"](function onInitializeRejected(err) { reject("Initialization failed: {" + err + "}"); });
        }
        else {
            resolve();
        }
    });
}
exports.initialize = initialize;
/**
 * Has the control been opened. Prevents more than one dialog being generated.
 */
var opened = false;
/**
 * Handler to launch the multi feedback dialog
 * @param launchOptions optional feedback properties
 * @returns A promise which will be rejected if the call fails.
 */
function multiFeedback(launchOptions) {
    return new es6_promise_1.Promise(function (resolve, reject) {
        if (opened) {
            reject("Control already open");
            return;
        }
        initialize()
            .then(function onInitializeFulfilled() {
            Configuration.get().setInAppFeedbackLaunchOptions(launchOptions);
            UI.createBellyBandMulti(function () { opened = false; });
            Logging.getLogger().logEvent(Logging.EventIds.InApp.UI.Picker.Shown.VALUE, {
                IsBugEnabled: Configuration.get().getInAppFeedbackInitOptions().bugForm,
                IsIdeaEnabled: Configuration.get().getInAppFeedbackInitOptions().userVoice !== undefined
            });
            opened = true;
            resolve();
        })["catch"](function onInitializeRejected(err) { reject("Initialization failed: {" + err + "}"); });
    });
}
exports.multiFeedback = multiFeedback;
/**
 * Handler to launch the single feedback dialog
 * @param feedbackType the feedback type
 * @param launchOptions optional feedback properties
 * @returns A promise which will be rejected if the call fails.
 */
function singleFeedback(feedbackType, launchOptions) {
    return new es6_promise_1.Promise(function (resolve, reject) {
        if (opened) {
            reject("Control already open");
            return;
        }
        var feedbackTypeEnum = Configuration.validateFeedbackType(feedbackType);
        initialize()
            .then(function onInitializeFulfilled() {
            Configuration.get().setInAppFeedbackLaunchOptions(launchOptions);
            UI.createBellyBandSingle(function () { opened = false; }, feedbackTypeEnum);
            Logging.getLogger().logEvent(Logging.EventIds.InApp.UI.Form.Shown.VALUE, {
                FeedbackType: feedbackTypeEnum
            });
            opened = true;
            resolve();
        })["catch"](function onInitializeRejected(err) { reject("Initialization failed: {" + err + "}"); });
    });
}
exports.singleFeedback = singleFeedback;
/**
 * Reset the inappfeedback module. Used in unit tests.
 */
function reset() {
    App_Common.reset();
    initialized = false;
    opened = false;
}
exports.reset = reset;
/* Make the FeedbackDialog methods available globally */
Window.setMultiFeedback(multiFeedback);
Window.setSingleFeedback(singleFeedback);
},{"./App_Common":39,"./Configuration/Configuration":42,"./Logging/Logging":54,"./UI/UI":82,"./Window/Window":87,"es6-promise":37}],42:[function(require,module,exports){
"use strict";
/**
 * Configuration.ts
 *
 * Module for logic relating to the sdk user configuration
 */
exports.__esModule = true;
var Utils = require("./../Utils");
var Constants = require("./../Constants");
var Localization = require("./../Localization");
/**
 * Class representing a configuration (user provided options)
 */
var Configuration = (function () {
    function Configuration() {
    }
    /**
     * Validate category options, default "show" to false if CategoryOptions is not provided.
     * @param categories Category options
     * @returns {ICategoryOptions} the validated CategoryOptions
     */
    Configuration.validateCategoryOptions = function (categories) {
        if (!categories) {
            return { show: false };
        }
        Utils.expectBoolean(categories.show, "categories.show");
        if (categories.customCategories) {
            Utils.expectArray(categories.customCategories, "categories.customCategories");
            for (var _i = 0, _a = categories.customCategories; _i < _a.length; _i++) {
                var customCategory = _a[_i];
                Utils.expectString(customCategory, "custom category '" + customCategory + "'");
                if (customCategory.length > 20) {
                    throw "custom category '" + customCategory + "' too long, max 20 characters.";
                }
            }
        }
        return categories;
    };
    Configuration.prototype.getCommonInitOptions = function () {
        return this.commonInitOptions;
    };
    Configuration.prototype.getInAppFeedbackInitOptions = function () {
        return this.inAppFeedbackInitOptions;
    };
    Configuration.prototype.getInAppFeedbackLaunchOptions = function () {
        return this.inAppFeedbackLaunchOptions;
    };
    Configuration.prototype.getFloodgateInitOptions = function () {
        return this.floodgateInitOptions;
    };
    Configuration.prototype.getFloodgateSurvey = function () {
        return this.floodgateSurvey;
    };
    /**
     * Set initOptions for common functionality.
     */
    Configuration.prototype.setCommonInitOptions = function (passedInitOptions) {
        Utils.expectObject(passedInitOptions, "passedInitOptions");
        var initOptions = {
            appId: passedInitOptions.appId,
            applicationGroup: passedInitOptions.applicationGroup || {},
            build: passedInitOptions.build,
            cid: passedInitOptions.cid,
            environment: passedInitOptions.environment,
            intlFilename: passedInitOptions.intlFilename,
            intlUrl: passedInitOptions.intlUrl,
            locale: passedInitOptions.locale,
            onError: passedInitOptions.onError,
            originalLocale: passedInitOptions.locale,
            primaryColour: passedInitOptions.primaryColour,
            secondaryColour: passedInitOptions.secondaryColour,
            sessionId: passedInitOptions.sessionId,
            stylesUrl: passedInitOptions.stylesUrl,
            telemetryGroup: passedInitOptions.telemetryGroup || {},
            userEmail: passedInitOptions.userEmail,
            userEmailConsentDefault: passedInitOptions.userEmailConsentDefault,
            webGroup: passedInitOptions.webGroup || {}
        };
        Utils.expectNumber(initOptions.appId, "initOptions.appId");
        if (!(initOptions.appId % 1 === 0 && initOptions.appId > 0)) {
            throw "initOptions.appId is not a positive integer: " + initOptions.appId;
        }
        Utils.expectString(initOptions.stylesUrl, "initOptions.stylesUrl");
        Utils.expectString(initOptions.intlUrl, "initOptions.intlUrl");
        if (initOptions.intlFilename !== undefined) {
            Utils.expectString(initOptions.intlFilename, "initOptions.intlFilename");
        }
        else {
            initOptions.intlFilename = "officebrowserfeedbackstrings.js";
        }
        Utils.expectNumber(initOptions.environment, "initOptions.environment");
        if (!(initOptions.environment === 1 || initOptions.environment === 0)) {
            throw "initOptions.environment has a bad value: " + initOptions.environment;
        }
        if (initOptions.userEmail !== undefined) {
            Utils.expectString(initOptions.userEmail, "initOptions.userEmail");
        }
        if (initOptions.userEmailConsentDefault !== undefined) {
            Utils.expectBoolean(initOptions.userEmailConsentDefault, "initOptions.userEmailConsentDefault");
        }
        if (initOptions.sessionId !== undefined) {
            Utils.expectString(initOptions.sessionId, "initOptions.sessionId");
        }
        else {
            initOptions.sessionId = "00000000-0000-0000-0000-000000000000";
        }
        // Copy sessionID over to telemetryGroup
        initOptions.telemetryGroup.processSessionId = initOptions.sessionId;
        if (initOptions.cid !== undefined) {
            Utils.expectString(initOptions.cid, "initOptions.cid");
            // Copy cid over to extendedManifestData of applicationGroup
            initOptions.applicationGroup.extendedManifestData = JSON.stringify({ cid: initOptions.cid });
        }
        if (initOptions.build !== undefined) {
            Utils.expectString(initOptions.build, "initOptions.build");
            var buildRegex = "^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$";
            if (!new RegExp(buildRegex).test(initOptions.build)) {
                initOptions.build = "0.0.0.0";
            }
        }
        else {
            initOptions.build = "0.0.0.0";
        }
        // Copy build over to telemetryGroup
        initOptions.telemetryGroup.officeBuild = initOptions.build;
        var hexColourRegex = new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$", "i");
        if (initOptions.primaryColour !== undefined) {
            if (!hexColourRegex.test(initOptions.primaryColour)) {
                initOptions.primaryColour = undefined;
            }
        }
        if (initOptions.secondaryColour !== undefined) {
            if (!hexColourRegex.test(initOptions.secondaryColour)) {
                initOptions.secondaryColour = undefined;
            }
        }
        if (initOptions.locale !== undefined) {
            Utils.expectString(initOptions.locale, "initOptions.locale");
            initOptions.locale = Localization.validate(initOptions.locale);
        }
        else {
            initOptions.locale = "en";
        }
        if (initOptions.onError === undefined) {
            initOptions.onError = function (err) { return; };
        }
        this.commonInitOptions = initOptions;
    };
    /**
     * Set init options for inAppFeedback
     */
    Configuration.prototype.setInAppFeedbackInitOptions = function (passedInitOptions) {
        Utils.expectObject(passedInitOptions, "passedInitOptions");
        var initOptions = {
            bugForm: passedInitOptions.bugForm,
            onDismiss: passedInitOptions.onDismiss,
            screenshot: passedInitOptions.screenshot,
            userEmail: passedInitOptions.userEmail,
            userVoice: passedInitOptions.userVoice !== undefined ?
                {
                    url: passedInitOptions.userVoice.url
                } :
                undefined
        };
        if (initOptions.onDismiss === undefined) {
            initOptions.onDismiss = function (submitted) { return; };
        }
        if (initOptions.bugForm !== undefined) {
            Utils.expectBoolean(initOptions.bugForm, "initOptions.bugForm");
        }
        else {
            initOptions.bugForm = false;
        }
        if (initOptions.userEmail !== undefined) {
            Utils.expectString(initOptions.userEmail, "initOptions.userEmail");
        }
        if (initOptions.screenshot !== undefined) {
            Utils.expectBoolean(initOptions.screenshot, "initOptions.screenshot");
        }
        else {
            initOptions.screenshot = true;
        }
        if (initOptions.userVoice !== undefined) {
            Utils.expectObject(initOptions.userVoice, "initOptions.userVoice");
            Utils.expectString(initOptions.userVoice.url, "initOptions.userVoice.url");
        }
        this.inAppFeedbackInitOptions = initOptions;
    };
    /**
     * Set launch options for inAppFeedback
     */
    Configuration.prototype.setInAppFeedbackLaunchOptions = function (launchOptions) {
        if (!this.commonInitOptions) {
            throw "commonInitOptions not set";
        }
        if (!launchOptions) {
            launchOptions = {};
        }
        // Override any setting done in LaunchOptions for the metadataGroups
        this.commonInitOptions.applicationGroup = Utils.overrideValues(launchOptions.applicationGroup, this.commonInitOptions.applicationGroup);
        this.commonInitOptions.telemetryGroup = Utils.overrideValues(launchOptions.telemetryGroup, this.commonInitOptions.telemetryGroup);
        this.commonInitOptions.webGroup = Utils.overrideValues(launchOptions.webGroup, this.commonInitOptions.webGroup);
        launchOptions.categories = Configuration.validateCategoryOptions(launchOptions.categories);
        this.inAppFeedbackLaunchOptions = launchOptions;
    };
    /**
     * Set init options for floodgate
     */
    Configuration.prototype.setFloodgateInitOptions = function (passedInitOptions) {
        Utils.expectObject(passedInitOptions, "passedInitOptions");
        var initOptions = {
            autoDismiss: passedInitOptions.autoDismiss,
            campaignDefinitions: passedInitOptions.campaignDefinitions,
            onDismiss: passedInitOptions.onDismiss,
            onSurveyActivatedCallback: passedInitOptions.onSurveyActivatedCallback,
            uIStringGetter: passedInitOptions.uIStringGetter
        };
        if (initOptions.autoDismiss === undefined) {
            initOptions.autoDismiss = Constants.AutoDismissValues.NoAutoDismiss;
        }
        if (initOptions.onDismiss === undefined) {
            initOptions.onDismiss = function (campaignId, submitted) { return; };
        }
        if (initOptions.onSurveyActivatedCallback === undefined) {
            var defaultOnSurveyActivatedCallback = {
                onSurveyActivated: function (launcher) {
                    launcher.launch();
                }
            };
            initOptions.onSurveyActivatedCallback = defaultOnSurveyActivatedCallback;
        }
        if (initOptions.uIStringGetter === undefined) {
            initOptions.uIStringGetter = function (str) { return str; }; // By default return the string as is.
        }
        this.floodgateInitOptions = initOptions;
    };
    /**
     * Set the floodgate survey
     */
    Configuration.prototype.setFloodgateSurvey = function (survey) {
        this.floodgateSurvey = survey;
    };
    return Configuration;
}());
exports.Configuration = Configuration;
var configuration = new Configuration();
/**
 * Get the current configuration
 */
function get() {
    return configuration;
}
exports.get = get;
/**
 * Validate feedbackType
 * @param feedbackType feedbackType
 * @returns {Constants.FeedbackType} the validated feedbackType
 */
function validateFeedbackType(feedbackType) {
    Utils.expectString(feedbackType, "feedbackType");
    if (feedbackType === Constants.FeedbackType[Constants.FeedbackType.Smile]) {
        return Constants.FeedbackType.Smile;
    }
    else if (feedbackType === Constants.FeedbackType[Constants.FeedbackType.Frown]) {
        return Constants.FeedbackType.Frown;
    }
    else if (feedbackType === Constants.FeedbackType[Constants.FeedbackType.Bug]) {
        return Constants.FeedbackType.Bug;
    }
    else {
        throw "feedbackType should be one of Smile, Frown or Bug";
    }
}
exports.validateFeedbackType = validateFeedbackType;
},{"./../Constants":43,"./../Localization":52,"./../Utils":84}],43:[function(require,module,exports){
"use strict";
/**
* Constants.ts
*
* A module for all the constants.
*/
exports.__esModule = true;
/**
 * HTML attribute names
 */
var AttributeName = (function () {
    function AttributeName() {
    }
    AttributeName.AriaLabel = "aria-label";
    AttributeName.Class = "class";
    AttributeName.DataHtml2CanvasIgnore = "data-html2canvas-ignore";
    AttributeName.Disabled = "disabled";
    AttributeName.Fill = "fill";
    AttributeName.For = "for";
    AttributeName.Form = "form";
    AttributeName.Height = "height";
    AttributeName.HRef = "href";
    AttributeName.Id = "id";
    AttributeName.MaxLength = "maxlength";
    AttributeName.Name = "name";
    AttributeName.Placeholder = "placeholder";
    AttributeName.Points = "points";
    AttributeName.Rel = "rel";
    AttributeName.Role = "role";
    AttributeName.Source = "src";
    AttributeName.Stroke = "stroke";
    AttributeName.TabIndex = "tabindex";
    AttributeName.Target = "target";
    AttributeName.Transform = "transform";
    AttributeName.Type = "type";
    AttributeName.Value = "value";
    AttributeName.ViewBox = "viewBox";
    AttributeName.Width = "width";
    AttributeName.xlinkHref = "xlink:href";
    AttributeName.X = "x";
    AttributeName.Y = "y";
    return AttributeName;
}());
exports.AttributeName = AttributeName;
/**
 * HTML attribute values
 */
var AttributeValue = (function () {
    function AttributeValue() {
    }
    AttributeValue.BlankWindow = "_blank";
    AttributeValue.Button = "button";
    AttributeValue.Checkbox = "checkbox";
    AttributeValue.Checked = "checked";
    AttributeValue.False = "false";
    AttributeValue.Zero = "0";
    AttributeValue.Polite = "polite";
    AttributeValue.Radio = "radio";
    AttributeValue.Submit = "submit";
    AttributeValue.Text = "text";
    AttributeValue.TextAreaMaxLength = "1000";
    AttributeValue.True = "true";
    AttributeValue.Unchecked = "unchecked";
    AttributeValue.NoReferrer = "noreferrer";
    return AttributeValue;
}());
exports.AttributeValue = AttributeValue;
/**
 * URL Parameters
 */
var UrlParameters = (function () {
    function UrlParameters() {
    }
    UrlParameters.CLCID = "CLCID";
    return UrlParameters;
}());
exports.UrlParameters = UrlParameters;
/**
 * CSS classes
 */
var Classes = (function () {
    function Classes() {
    }
    Classes.CheckBox = "obf-CheckBox";
    Classes.FontSubtitle = "obf-FontSubtitle";
    Classes.FontText = "obf-FontText";
    Classes.FontSubText = "obf-FontSubText";
    Classes.FontSubSubText = "obf-FontSubSubText";
    Classes.Hidden = "obf-Hidden";
    Classes.Link = "obf-Link";
    Classes.MarginLeft60px = "obf-MarginLeft60px";
    Classes.NarrowLayout = "obf-NarrowLayout";
    Classes.PrivacyStatementLinkDiv = "obf-PrivacyStatementLinkDiv";
    Classes.Rtl = "obf-Rtl";
    Classes.Spinner = "obf-Spinner";
    Classes.SpinnerCircle = "obf-SpinnerCircle";
    Classes.SubmitButton = "obf-SubmitButton";
    Classes.TextInput = "obf-TextInput";
    Classes.Visible = "obf-Visible";
    // rating control
    Classes.Rating = "obf-Rating";
    Classes.RatingGraphic = "obf-RatingGraphic";
    Classes.RatingGraphicFilled = "obf-RatingGraphic-Filled";
    // choice group control
    Classes.ChoiceGroup = "obf-ChoiceGroup";
    Classes.ChoiceGroupIcon = "obf-ChoiceGroupIcon";
    // region BellyBand
    Classes.OverallAnchor = "obf-OverallAnchor";
    Classes.OverallAnchorActive = "obf-OverallAnchorActive";
    Classes.OverallImage = "obf-OverallImage";
    Classes.OverallText = "obf-OverallText";
    Classes.SingleLayout = "obf-SingleLayout";
    Classes.ShowRightBorder = "obf-ShowRightBorder";
    Classes.SlideLeft = "obf-slideLeft";
    Classes.TextAlignLeft = "obf-TextAlignLeft";
    Classes.FormContainer = "obf-FormContainer";
    // form classes
    Classes.FormQuestionMiddleText = "obf-FormQuestionMiddleText";
    Classes.FormMiddleText = "obf-FormMiddleText";
    Classes.FormCategoriesDropdown = "obf-FormCategoriesDropdown";
    Classes.FormComment = "obf-FormComment";
    Classes.FormRatingContainer = "obf-FormRatingContainer";
    Classes.FormRatingLabel = "obf-FormRatingLabel";
    Classes.FormRating = "obf-FormRating";
    Classes.FormEmailInput = "obf-FormEmailInput";
    Classes.FormBottomContainer = "obf-FormBottomContainer";
    Classes.FormSubmitButtonContainer = "obf-FormSubmitButtonContainer";
    Classes.FormScreenshotContainer = "obf-FormScreenshotContainer";
    Classes.FormScreenshotLabel = "obf-FormScreenshotLabel";
    Classes.FormScreenshotCheckbox = "obf-FormScreenshotCheckbox";
    // email textbox classes
    Classes.TFormEmailCheckbox = "obf-TFormEmailCheckbox";
    Classes.TFormEmailLabel = "obf-TFormEmailLabel ";
    // email checkbox classes
    Classes.EmailCheckBoxLabel = "obf-EmailCheckBoxLabel";
    // endregion
    // region Toast
    Classes.Toast = "obf-Toast";
    return Classes;
}());
exports.Classes = Classes;
/**
 * HTML element ids
 */
var IDs = (function () {
    function IDs() {
    }
    // region BellyBand
    IDs.ColumnSeparatorDiv = "obf-ColumnSeparatorDiv";
    IDs.OverallAnchorsContainer = "obf-OverallAnchorsContainer";
    IDs.OverallFrownAnchor = "obf-OverallFrownAnchor";
    IDs.OverallFrownDiv = "obf-OverallFrownDiv";
    IDs.OverallFrownImage = "obf-OverallFrownImage";
    IDs.OverallFrownText = "obf-OverallFrownText";
    IDs.OverallSmileAnchor = "obf-OverallSmileAnchor";
    IDs.OverallSmileDiv = "obf-OverallSmileDiv";
    IDs.OverallSmileImage = "obf-OverallSmileImage";
    IDs.OverallSmileText = "obf-OverallSmileText";
    IDs.OverallIdeaAnchor = "obf-OverallIdeaAnchor";
    IDs.OverallIdeaDiv = "obf-OverallIdeaDiv";
    IDs.OverallIdeaImage = "obf-OverallIdeaImage";
    IDs.OverallIdeaText = "obf-OverallIdeaText";
    IDs.OverallBugAnchor = "obf-OverallBugAnchor";
    IDs.OverallBugDiv = "obf-OverallBugDiv";
    IDs.OverallBugImage = "obf-OverallBugImage";
    IDs.OverallBugText = "obf-OverallBugText";
    IDs.QuestionLeftText = "obf-QuestionLeftText";
    IDs.LeftFormContainer = "obf-LeftFormContainer";
    IDs.MainContainer = "obf-MainContainer";
    IDs.MainContentHolder = "obf-MainContentHolder";
    IDs.MiddleFormContainer = "obf-MiddleFormContainer";
    IDs.OverlayBackground = "obf-OverlayBackground";
    IDs.PrivacyStatementLink = "obf-PrivacyStatementLink";
    IDs.FirstTabbable = "obf-FirstTabbable";
    IDs.LastTabbable = "obf-LastTabbable";
    // Single form ids
    IDs.SingleFormContainer = "obf-SingleFormContainer";
    IDs.SingleFormQuestionMiddleText = "obf-SingleFormQuestionMiddleText";
    IDs.SingleFormCategoriesDropdown = "obf-SingleFormCategoriesDropdown";
    IDs.SingleFormComment = "obf-SingleFormComment";
    IDs.SingleFormEmailInput = "obf-SingleFormEmailInput";
    IDs.SingleFormRating = "obf-SingleFormRating";
    IDs.SingleFormScreenshotCheckbox = "obf-SingleFormScreenshotCheckbox";
    IDs.SingleFormSubmitButton = "obf-SingleFormSubmitButton";
    IDs.SingleFormSubmitButtonSpinner = "obf-SingleFormSubmitButtonSpinner";
    // Basic form ids
    IDs.BasicFormContainer = "obf-BasicFormContainer";
    IDs.BasicFormQuestionMiddleText = "obf-BasicFormQuestionMiddleText";
    IDs.BasicFormCategoriesDropdown = "obf-BasicFormCategoriesDropdown";
    IDs.BasicFormComment = "obf-BasicFormComment";
    IDs.BasicFormEmailInput = "obf-BasicFormEmailInput";
    IDs.BasicFormRating = "obf-BasicFormRating";
    IDs.BasicFormScreenshotCheckbox = "obf-BasicFormScreenshotCheckbox";
    IDs.BasicFormSubmitButton = "obf-BasicFormSubmitButton";
    IDs.BasicFormSubmitButtonSpinner = "obf-BasicFormSubmitButtonSpinner";
    // UserVoice form ids
    IDs.UserVoiceFormContainer = "obf-UserVoiceFormContainer";
    IDs.UserVoiceFormGoButton = "obf-UserVoiceFormGoButton";
    // endregion
    // region Toast
    IDs.ToastContainer = "obf-ToastContainer";
    IDs.ToastCancel = "obf-ToastCancel";
    // Prompt ids
    IDs.TPromptContainer = "obf-TPromptContainer";
    IDs.TPromptTitle = "obf-TPromptTitle";
    IDs.TPromptText = "obf-TPromptText";
    // Survey ids
    IDs.TFormContainer = "obf-TFormContainer";
    IDs.TFormTitle = "obf-TFormTitle";
    IDs.TFormRating = "obf-TFormRating";
    IDs.TFormComment = "obf-TFormComment";
    IDs.TFormEmailTextBox = "obf-TFormEmailTextBox";
    IDs.TFormEmailCheckBox = "obf-TFormEmailCheckBox";
    IDs.TFormEmailLabel = "obf-TFormEmailLabel";
    IDs.TFormSubmitButton = "obf-TFormSubmitButton";
    IDs.TFormSubmitButtonSpinner = "obf-TFormSubmitButtonSpinner";
    IDs.TFormSubmitButtonContainer = "obf-TFormSubmitButtonContainer";
    return IDs;
}());
exports.IDs = IDs;
/**
 * Keys
 */
var Keys = (function () {
    function Keys() {
    }
    Keys.Esc = 27;
    Keys.Tab = 9;
    return Keys;
}());
exports.Keys = Keys;
/**
 * Values for types of feedback that go into the json
 * Also used to determine the FormTemplate used on each one of the feedback types.
 */
var FeedbackType;
(function (FeedbackType) {
    FeedbackType[FeedbackType["Smile"] = 0] = "Smile";
    FeedbackType[FeedbackType["Frown"] = 1] = "Frown";
    FeedbackType[FeedbackType["Idea"] = 2] = "Idea";
    FeedbackType[FeedbackType["Bug"] = 3] = "Bug";
})(FeedbackType = exports.FeedbackType || (exports.FeedbackType = {}));
/**
 * Values for the environment
 */
var Environment;
(function (Environment) {
    Environment[Environment["Production"] = 0] = "Production";
    Environment[Environment["Int"] = 1] = "Int";
})(Environment = exports.Environment || (exports.Environment = {}));
/**
 * Values for autodismiss
 */
var AutoDismissValues;
(function (AutoDismissValues) {
    AutoDismissValues[AutoDismissValues["NoAutoDismiss"] = 0] = "NoAutoDismiss";
    AutoDismissValues[AutoDismissValues["SevenSeconds"] = 1] = "SevenSeconds";
    AutoDismissValues[AutoDismissValues["FourteenSeconds"] = 2] = "FourteenSeconds";
    AutoDismissValues[AutoDismissValues["TwentyOneSeconds"] = 3] = "TwentyOneSeconds";
    AutoDismissValues[AutoDismissValues["TwentyEightSeconds"] = 4] = "TwentyEightSeconds";
})(AutoDismissValues = exports.AutoDismissValues || (exports.AutoDismissValues = {}));
/**
 * HTML tags
 */
var Tags = (function () {
    function Tags() {
    }
    Tags.Anchor = "A";
    Tags.Button = "button";
    Tags.Defs = "defs";
    Tags.Div = "div";
    Tags.FieldSet = "fieldset";
    Tags.Form = "form";
    Tags.Img = "img";
    Tags.Input = "input";
    Tags.Label = "label";
    Tags.Legend = "legend";
    Tags.Option = "option";
    Tags.Polygon = "polygon";
    Tags.Select = "select";
    Tags.Span = "span";
    Tags.Svg = "svg";
    Tags.TextArea = "textarea";
    Tags.Use = "use";
    return Tags;
}());
exports.Tags = Tags;
/**
 * URLs
 */
var Urls = (function () {
    function Urls() {
    }
    /**
     * Link to the feedback Privacy Statement
     */
    Urls.PrivacyStatementLink = "http://go.microsoft.com/fwlink/?LinkID=390004";
    return Urls;
}());
exports.Urls = Urls;
},{}],44:[function(require,module,exports){
"use strict";
/**
 * Survey launcher factory for Web SDK
 */
exports.__esModule = true;
var UISurvey_1 = require("./../FloodgateCore/UISurvey/UISurvey");
var Window = require("./../Window/Window");
var AdaptiveSurveyLauncherFactory = (function () {
    function AdaptiveSurveyLauncherFactory() {
    }
    AdaptiveSurveyLauncherFactory.prototype.makeSurveyLauncher = function (survey) {
        return new RudeSurveyLauncher(survey);
    };
    return AdaptiveSurveyLauncherFactory;
}());
exports["default"] = AdaptiveSurveyLauncherFactory;
var RudeSurveyLauncher = (function () {
    function RudeSurveyLauncher(survey) {
        this.survey = survey;
    }
    RudeSurveyLauncher.prototype.launch = function () {
        Window.get().OfficeBrowserFeedback.floodgate.showSurvey(new UISurvey_1["default"](this.survey));
    };
    return RudeSurveyLauncher;
}());
},{"./../FloodgateCore/UISurvey/UISurvey":51,"./../Window/Window":87}],45:[function(require,module,exports){
"use strict";
/**
 * Implementation for IFloodgateEnvironmentProvider for web SDK.
 * We pass the SDK's internal locale here and not the one which the host app specifies.
 */
exports.__esModule = true;
var Configuration = require("./../Configuration/Configuration");
var FloodgateEnvironmentProvider = (function () {
    function FloodgateEnvironmentProvider() {
    }
    FloodgateEnvironmentProvider.prototype.getLanguage = function () {
        return Configuration.get().getCommonInitOptions().originalLocale;
    };
    return FloodgateEnvironmentProvider;
}());
exports["default"] = FloodgateEnvironmentProvider;
},{"./../Configuration/Configuration":42}],46:[function(require,module,exports){
"use strict";
/**
 * Implementation of IFloodgateStorageProvider for Web SDK
 */
exports.__esModule = true;
var Api_1 = require("@ms-ofb/officefloodgatecore/dist/src/Api/Api");
var Window = require("./../Window/Window");
var Logging = require("./../Logging/Logging");
var FileType = Api_1.IFloodgateStorageProvider.FileType;
var fileTypeToKeyMap = {};
fileTypeToKeyMap[FileType.CampaignDefinitions.toString()] = "obf-CampaignDefinitions";
fileTypeToKeyMap[FileType.CampaignStates.toString()] = "obf-CampaignStates";
fileTypeToKeyMap[FileType.FloodgateSettings.toString()] = "obf-FloodgateSettings";
fileTypeToKeyMap[FileType.GovernedChannelStates.toString()] = "obf-GovernedChannelStates";
fileTypeToKeyMap[FileType.SurveyActivationStats.toString()] = "obf-SurveyActivationStats";
fileTypeToKeyMap[FileType.SurveyEventActivityStats.toString()] = "obf-SurveyEventActivityStats";
var FloodgateStorageProvider = (function () {
    function FloodgateStorageProvider() {
    }
    /**
     * Code to detect localStorage presence.
     * Copied from MDN: https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API
     */
    FloodgateStorageProvider.isStorageAvailable = function () {
        try {
            var x = "__storage_test__";
            Window.get().localStorage.setItem(x, x);
            Window.get().localStorage.removeItem(x);
            return true;
        }
        catch (e) {
            return e instanceof DOMException && (
            // everything except Firefox
            e.code === 22 ||
                // Firefox
                e.code === 1014 ||
                // test name field too, because code might not be present
                // everything except Firefox
                e.name === "QuotaExceededError" ||
                // Firefox
                e.name === "NS_ERROR_DOM_QUOTA_REACHED") &&
                // acknowledge QuotaExceededError only if there's something already stored
                Window.get().localStorage.length !== 0;
        }
    };
    /**
     * Lock the file to prevent access from another process.
     */
    FloodgateStorageProvider.prototype.fileLock = function (fileType) {
        // JS runs on a single thread in the browser.
        return;
    };
    /**
     * Unlock the file.
     */
    FloodgateStorageProvider.prototype.fileUnlock = function (fileType) {
        // JS runs on a single thread in the browser.
        return;
    };
    /**
     * Read the file
     */
    FloodgateStorageProvider.prototype.read = function (fileType) {
        if (!(fileType in FileType) || !fileTypeToKeyMap.hasOwnProperty(fileType.toString())) {
            return "";
        }
        var storageKey = fileTypeToKeyMap[fileType];
        var result;
        try {
            result = Window.get().localStorage.getItem(storageKey);
        }
        catch (e) {
            Logging.getLogger().logEvent(Logging.EventIds.Survey.Floodgate.FileRead.Failed.VALUE, {
                ErrorMessage: e.toString(),
                FileName: storageKey
            });
            return "";
        }
        return result;
    };
    /**
     * Write to the file
     */
    FloodgateStorageProvider.prototype.write = function (fileType, content) {
        if (!(fileType in FileType) || !fileTypeToKeyMap.hasOwnProperty(fileType.toString())) {
            return;
        }
        var storageKey = fileTypeToKeyMap[fileType];
        try {
            Window.get().localStorage.setItem(storageKey, content);
        }
        catch (e) {
            Logging.getLogger().logEvent(Logging.EventIds.Survey.Floodgate.FileWrite.Failed.VALUE, {
                ErrorMessage: e.toString(),
                FileName: storageKey
            });
            return;
        }
    };
    return FloodgateStorageProvider;
}());
exports["default"] = FloodgateStorageProvider;
},{"./../Logging/Logging":54,"./../Window/Window":87,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],47:[function(require,module,exports){
"use strict";
/**
 * Implementation of IFloodgateStringProvider for Web SDK
 */
exports.__esModule = true;
var Api = require("@ms-ofb/officefloodgatecore/dist/src/Api/Api");
var UIStrings = require("./../UIStrings/UIStrings");
var Configuration = require("./../Configuration/Configuration");
/* tslint:disable:max-line-length */
var FloodgateStringProvider = (function () {
    function FloodgateStringProvider() {
    }
    FloodgateStringProvider.prototype.loadStringResource = function (stringId) {
        var uiStrings = UIStrings.getUIStrings();
        switch (stringId) {
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue0): return uiStrings.Floodgate.Nps.Rating.Points11Value0;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue1): return uiStrings.Floodgate.Nps.Rating.Points11Value1;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue2): return uiStrings.Floodgate.Nps.Rating.Points11Value2;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue3): return uiStrings.Floodgate.Nps.Rating.Points11Value3;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue4): return uiStrings.Floodgate.Nps.Rating.Points11Value4;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue5): return uiStrings.Floodgate.Nps.Rating.Points11Value5;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue6): return uiStrings.Floodgate.Nps.Rating.Points11Value6;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue7): return uiStrings.Floodgate.Nps.Rating.Points11Value7;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue8): return uiStrings.Floodgate.Nps.Rating.Points11Value8;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue9): return uiStrings.Floodgate.Nps.Rating.Points11Value9;
            case (Api.IFloodgateStringProvider.StringType.Nps11RatingValue10): return uiStrings.Floodgate.Nps.Rating.Points11Value10;
            case (Api.IFloodgateStringProvider.StringType.Nps5RatingValue1): return uiStrings.Floodgate.Nps.Rating.Points5Value1;
            case (Api.IFloodgateStringProvider.StringType.Nps5RatingValue2): return uiStrings.Floodgate.Nps.Rating.Points5Value2;
            case (Api.IFloodgateStringProvider.StringType.Nps5RatingValue3): return uiStrings.Floodgate.Nps.Rating.Points5Value3;
            case (Api.IFloodgateStringProvider.StringType.Nps5RatingValue4): return uiStrings.Floodgate.Nps.Rating.Points5Value4;
            case (Api.IFloodgateStringProvider.StringType.Nps5RatingValue5): return uiStrings.Floodgate.Nps.Rating.Points5Value5;
            case (Api.IFloodgateStringProvider.StringType.NpsRatingQuestion): return uiStrings.Floodgate.Nps.Rating.Question;
            case (Api.IFloodgateStringProvider.StringType.NpsCommentQuestion): return uiStrings.Floodgate.Nps.Comment.Question;
            case (Api.IFloodgateStringProvider.StringType.NpsPromptNotNowLabel): return uiStrings.Floodgate.Nps.Prompt.No;
            case (Api.IFloodgateStringProvider.StringType.NpsPromptQuestion): return uiStrings.Floodgate.Nps.Prompt.Question;
            case (Api.IFloodgateStringProvider.StringType.NpsPromptTitle): return uiStrings.Floodgate.Nps.Prompt.Title;
            case (Api.IFloodgateStringProvider.StringType.NpsPromptYesLabel): return uiStrings.Floodgate.Nps.Prompt.Yes;
            default:
                return "";
        }
    };
    FloodgateStringProvider.prototype.getCustomString = function (str) {
        return Configuration.get().getFloodgateInitOptions().uIStringGetter(str);
    };
    return FloodgateStringProvider;
}());
exports["default"] = FloodgateStringProvider;
},{"./../Configuration/Configuration":42,"./../UIStrings/UIStrings":65,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],48:[function(require,module,exports){
"use strict";
/**
 * Implementation of IFloodgateTelemetryLogger for Web SDK
 */
exports.__esModule = true;
var Logging = require("../Logging/Logging");
var IFloodgateTelemetryLogger = (function () {
    function IFloodgateTelemetryLogger() {
    }
    /**
     * Log that a survey's trigger was met.
     * @param campaignId Id of the campaign the survey belongs to.
     * @param surveyId Id of the survey.
     * @param surveyType Type of the survey.
     */
    IFloodgateTelemetryLogger.prototype.log_TriggerMet = function (campaignId, surveyId, surveyType) {
        Logging.getLogger().logEvent(Logging.EventIds.Survey.Floodgate.TriggerMet.VALUE, {
            CampaignId: campaignId,
            SurveyId: surveyId,
            SurveyType: surveyType
        });
    };
    /**
     * Log that a user was selected(nominated) for a survey
     * @param campaignId Id of the campaign the survey belongs to.
     * @param surveyId Id of the survey.
     * @param surveyType Type of the survey.
     */
    IFloodgateTelemetryLogger.prototype.log_UserSelected = function (campaignId, surveyId, surveyType) {
        Logging.getLogger().logEvent(Logging.EventIds.Survey.Floodgate.UserSelected.VALUE, {
            CampaignId: campaignId,
            SurveyId: surveyId,
            SurveyType: surveyType
        });
    };
    /**
     * Log that campaign definitions failed to load.
     * @param errorMessage error message
     */
    IFloodgateTelemetryLogger.prototype.log_CampaignLoad_Failed = function (errorMessage) {
        Logging.getLogger().logEvent(Logging.EventIds.Survey.Floodgate.CampaignLoad.Failed.VALUE, {
            ErrorMessage: errorMessage
        });
    };
    return IFloodgateTelemetryLogger;
}());
exports["default"] = IFloodgateTelemetryLogger;
},{"../Logging/Logging":54}],49:[function(require,module,exports){
"use strict";
/**
 * IUISurvey implementation based on an ICustomSurvey object
 */
exports.__esModule = true;
var Utils = require("../../Utils");
var CustomUISurvey = (function () {
    function CustomUISurvey(survey) {
        this.comment = "";
        this.ratingIndex = -1;
        this.showPrompt = survey.showPrompt;
        this.showEmailRequest = Utils.isBoolean(survey.showEmailRequest) ? survey.showEmailRequest : false;
        this.survey = survey;
    }
    CustomUISurvey.prototype.getPromptQuestion = function () {
        return this.survey.promptQuestion;
    };
    CustomUISurvey.prototype.getTitle = function () {
        return this.survey.title;
    };
    CustomUISurvey.prototype.getPromptYesButtonText = function () {
        return this.survey.promptYesButtonText;
    };
    CustomUISurvey.prototype.getPromptNoButtonText = function () {
        return this.survey.promptNoButtonText;
    };
    CustomUISurvey.prototype.getRatingValuesAscending = function () {
        return this.survey.ratingValuesAscending;
    };
    CustomUISurvey.prototype.getRatingQuestion = function () {
        return this.survey.ratingQuestion;
    };
    CustomUISurvey.prototype.getCommentQuestion = function () {
        return this.survey.commentQuestion;
    };
    CustomUISurvey.prototype.setValues = function (ratingIndex, comment) {
        this.comment = comment;
        if (this.isRatingIndexValid(ratingIndex)) {
            this.ratingIndex = ratingIndex;
        }
        else {
            this.ratingIndex = -1;
        }
    };
    CustomUISurvey.prototype.getJsonElements = function () {
        var result = {};
        result.comment = this.comment;
        result.rating = this.getNormalizedRatingScore();
        result.survey = {
            surveyId: this.getCampaignId()
        };
        return result;
    };
    CustomUISurvey.prototype.getSurveyType = function () {
        return this.survey.surveyType;
    };
    CustomUISurvey.prototype.getCampaignId = function () {
        return this.survey.campaignId;
    };
    CustomUISurvey.prototype.getId = function () {
        return this.getCampaignId();
    };
    CustomUISurvey.prototype.isRatingIndexValid = function (index) {
        return (index >= 0 && index < this.survey.ratingValuesAscending.length);
    };
    CustomUISurvey.prototype.getNormalizedRatingScore = function () {
        if (!this.isRatingIndexValid(this.ratingIndex)) {
            return -1;
        }
        if (this.survey.isZeroBased) {
            return (this.ratingIndex) / (this.survey.ratingValuesAscending.length - 1);
        }
        else {
            return (this.ratingIndex + 1.0) / this.survey.ratingValuesAscending.length;
        }
    };
    return CustomUISurvey;
}());
exports["default"] = CustomUISurvey;
},{"../../Utils":84}],50:[function(require,module,exports){
"use strict";
/**
 * Dummy IUISurvey implementation without dependancy on officefloodgatecore
 */
exports.__esModule = true;
var Utils = require("../../Utils");
var Api = require("@ms-ofb/officefloodgatecore/dist/src/Api/Api");
var DummySurvey = (function () {
    function DummySurvey() {
        this.showPrompt = true;
        this.showEmailRequest = true;
        this.comment = "";
    }
    DummySurvey.prototype.getPromptQuestion = function () {
        return "Prompt question?";
    };
    DummySurvey.prototype.getTitle = function () {
        return "Title";
    };
    DummySurvey.prototype.getPromptYesButtonText = function () {
        return "Yes";
    };
    DummySurvey.prototype.getPromptNoButtonText = function () {
        return "No";
    };
    DummySurvey.prototype.getRatingValuesAscending = function () {
        return ["worst", "worse", "ok", "better", "best"];
    };
    DummySurvey.prototype.getRatingQuestion = function () {
        return "Rating question?";
    };
    DummySurvey.prototype.getCommentQuestion = function () {
        return "Comment question?";
    };
    DummySurvey.prototype.setValues = function (selectedIndex, comment) {
        if (comment) {
            this.comment = comment;
        }
        if (Utils.isInteger(selectedIndex) && selectedIndex >= 0 && selectedIndex <= 4) {
            this.rating = selectedIndex / 4.0;
        }
    };
    DummySurvey.prototype.getJsonElements = function () {
        var result = {};
        if (this.comment) {
            result.comment = this.comment;
        }
        if (this.rating) {
            result.rating = this.rating;
        }
        return result;
    };
    DummySurvey.prototype.getSurveyType = function () {
        return Api.ISurvey.Type.Nps;
    };
    DummySurvey.prototype.getCampaignId = function () {
        return "10000000-0000-0000-0000-000000000000";
    };
    DummySurvey.prototype.getId = function () {
        return "00000000-0000-0000-0000-000000000000";
    };
    return DummySurvey;
}());
exports["default"] = DummySurvey;
},{"../../Utils":84,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],51:[function(require,module,exports){
"use strict";
/**
 * An implementation of IUISurvey based on floodgate.core INpsSurvey
 */
exports.__esModule = true;
var Api = require("@ms-ofb/officefloodgatecore/dist/src/Api/Api");
var UISurvey = (function () {
    function UISurvey(survey) {
        this.showPrompt = true;
        this.showEmailRequest = false;
        if (!survey) {
            throw Error("survey must not be null");
        }
        else {
            this.survey = survey;
        }
        var promptComponent = survey.getComponent(Api.ISurveyComponent.Type.Prompt);
        var commentComponent = survey.getComponent(Api.ISurveyComponent.Type.Comment);
        var ratingComponent = survey.getComponent(Api.ISurveyComponent.Type.Rating);
        if (promptComponent) {
            this.prompt = promptComponent;
        }
        else {
            throw Error("prompt component must not be null");
        }
        // Check for additonalDataRequested options
        this.showEmailRequest = survey.getSurveyInfo().isAdditionalDataRequested(Api.ISurveyInfo.AdditionalDataType.EmailAddress);
        if (commentComponent) {
            this.comment = commentComponent;
        }
        else {
            throw Error("comment component must not be null");
        }
        if (ratingComponent) {
            this.rating = ratingComponent;
        }
        else {
            throw Error("rating component must not be null");
        }
    }
    UISurvey.prototype.getPromptQuestion = function () {
        return this.prompt.getQuestion();
    };
    UISurvey.prototype.getTitle = function () {
        return this.prompt.getTitle();
    };
    UISurvey.prototype.getPromptYesButtonText = function () {
        return this.prompt.getYesButtonText();
    };
    UISurvey.prototype.getPromptNoButtonText = function () {
        return this.prompt.getNoButtonText();
    };
    UISurvey.prototype.getRatingValuesAscending = function () {
        return this.rating.getRatingValuesAscending();
    };
    UISurvey.prototype.getRatingQuestion = function () {
        return this.rating.getQuestion();
    };
    UISurvey.prototype.getCommentQuestion = function () {
        return this.comment.getQuestion();
    };
    UISurvey.prototype.setValues = function (selectedIndex, comment) {
        this.rating.setSelectedRatingIndex(selectedIndex);
        this.comment.setSubmittedText(comment);
    };
    UISurvey.prototype.getJsonElements = function () {
        return this.survey.getJsonElements();
    };
    UISurvey.prototype.getSurveyType = function () {
        return this.survey.getType();
    };
    UISurvey.prototype.getCampaignId = function () {
        return this.survey.getSurveyInfo().getBackEndId();
    };
    UISurvey.prototype.getId = function () {
        return this.survey.getSurveyInfo().getId();
    };
    return UISurvey;
}());
exports["default"] = UISurvey;
},{"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],52:[function(require,module,exports){
"use strict";
/**
* Localization.ts
*
* Module for Localization
*/
exports.__esModule = true;
/**
 * List of supported Locales
 * REMINDER: update readme to match the list below if change is made
 */
var supportedLocales = [
    "af",
    "am",
    "ar",
    "as",
    "az",
    "be",
    "bg",
    "bn-BD",
    "bn-IN",
    "bs",
    "ca",
    "ca-Es-VALENCIA",
    "chr-Cher",
    "cs",
    "cy",
    "da",
    "de",
    "el",
    "en-GB",
    "es",
    "es-MX",
    "et",
    "eu",
    "fa",
    "fi",
    "fil",
    "fr",
    "fr-CA",
    "ga",
    "gd",
    "gl",
    "gu",
    "ha-Latn-NG",
    "he",
    "hi",
    "hr",
    "hu",
    "hy",
    "id",
    "is",
    "it",
    "ja",
    "ka",
    "kk",
    "km-KH",
    "kn",
    "ko",
    "kok",
    "ky",
    "lb",
    "lo",
    "lt",
    "lv",
    "mi",
    "mk",
    "ml",
    "mn",
    "mr",
    "ms",
    "mt",
    "nb-NO",
    "ne",
    "nl",
    "nn-NO",
    "or",
    "pa",
    "pl",
    "prs",
    "pt-BR",
    "pt-PT",
    "quz",
    "ro",
    "ru",
    "sd",
    "si",
    "sk",
    "sl",
    "sq",
    "sr-Cyrl-BA",
    "sr-Cyrl-RS",
    "sr-Latn-RS",
    "sv",
    "sw",
    "ta",
    "te",
    "th",
    "tk",
    "tr",
    "tt",
    "ug",
    "uk",
    "ur",
    "uz-Latn-UZ",
    "vi",
    "zh-Hans",
    "zh-Hant",
];
var localeVariantToSupportedlocaleMap = {
    "ZH-CN": "zh-Hans",
    "ZH-HK": "zh-Hant",
    "ZH-MO": "zh-Hant",
    "ZH-SG": "zh-Hans",
    "ZH-TW": "zh-Hant"
};
function validate(locale) {
    var localeUpperCase = locale.toLocaleUpperCase();
    // support for Chinese ll-cc, VSO Bug 1583389
    if (localeUpperCase in localeVariantToSupportedlocaleMap) {
        return localeVariantToSupportedlocaleMap[localeUpperCase];
    }
    // return supported locale if exact match found
    for (var _i = 0, supportedLocales_1 = supportedLocales; _i < supportedLocales_1.length; _i++) {
        var supportedLocale = supportedLocales_1[_i];
        if (supportedLocale.toUpperCase() === localeUpperCase) {
            return supportedLocale;
        }
    }
    var localePartOne = localeUpperCase.split("-")[0];
    // return supported "ll" if exact match not found, but "ll" matches
    for (var _a = 0, supportedLocales_2 = supportedLocales; _a < supportedLocales_2.length; _a++) {
        var supportedLocale = supportedLocales_2[_a];
        if (supportedLocale.toUpperCase() === localePartOne) {
            return supportedLocale;
        }
    }
    // default everything else to en
    return "en";
}
exports.validate = validate;
},{}],53:[function(require,module,exports){
"use strict";
/**
 * Constants.ts
 *
 * Module to hold logging-related constants
 */
exports.__esModule = true;
var EventIds = (function () {
    function EventIds() {
    }
    EventIds.InApp = (_a = (function () {
            function class_1() {
            }
            return class_1;
        }()),
        _a.UI = (_b = (function () {
                function class_2() {
                }
                return class_2;
            }()),
            _b.Picker = (_c = (function () {
                    function class_3() {
                    }
                    return class_3;
                }()),
                _c.Shown = (_d = (function () {
                        function class_4() {
                        }
                        return class_4;
                    }()),
                    _d.VALUE = { name: "InApp_UI_Picker_Shown" },
                    _d),
                _c),
            _b.Form = (_e = (function () {
                    function class_5() {
                    }
                    return class_5;
                }()),
                _e.Shown = (_f = (function () {
                        function class_6() {
                        }
                        return class_6;
                    }()),
                    _f.VALUE = { name: "InApp_UI_Form_Shown" },
                    _f),
                _e.Submit = (_g = (function () {
                        function class_7() {
                        }
                        return class_7;
                    }()),
                    _g.VALUE = { name: "InApp_UI_Form_Submit" },
                    _g),
                _e),
            _b),
        _a);
    EventIds.Survey = (_h = (function () {
            function class_8() {
            }
            return class_8;
        }()),
        _h.UI = (_j = (function () {
                function class_9() {
                }
                return class_9;
            }()),
            _j.Prompt = (_k = (function () {
                    function class_10() {
                    }
                    return class_10;
                }()),
                _k.Shown = (_l = (function () {
                        function class_11() {
                        }
                        return class_11;
                    }()),
                    _l.VALUE = { name: "Survey_UI_Prompt_Shown" },
                    _l),
                _k),
            _j.Form = (_m = (function () {
                    function class_12() {
                    }
                    return class_12;
                }()),
                _m.Shown = (_o = (function () {
                        function class_13() {
                        }
                        return class_13;
                    }()),
                    _o.VALUE = { name: "Survey_UI_Form_Shown" },
                    _o),
                _m.Submit = (_p = (function () {
                        function class_14() {
                        }
                        return class_14;
                    }()),
                    _p.VALUE = { name: "Survey_UI_Form_Submit" },
                    _p),
                _m),
            _j),
        _h.Floodgate = (_q = (function () {
                function class_15() {
                }
                return class_15;
            }()),
            _q.TriggerMet = (_r = (function () {
                    function class_16() {
                    }
                    return class_16;
                }()),
                _r.VALUE = { name: "Survey_Floodgate_TriggerMet" },
                _r),
            _q.UserSelected = (_s = (function () {
                    function class_17() {
                    }
                    return class_17;
                }()),
                _s.VALUE = { name: "Survey_Floodgate_UserSelected" },
                _s),
            _q.CampaignLoad = (_t = (function () {
                    function class_18() {
                    }
                    return class_18;
                }()),
                _t.Failed = (_u = (function () {
                        function class_19() {
                        }
                        return class_19;
                    }()),
                    _u.VALUE = { name: "Survey_Floodgate_CampaignLoad_Failed" },
                    _u),
                _t),
            _q.FileWrite = (_v = (function () {
                    function class_20() {
                    }
                    return class_20;
                }()),
                _v.Failed = (_w = (function () {
                        function class_21() {
                        }
                        return class_21;
                    }()),
                    _w.VALUE = { name: "Survey_Floodgate_FileWrite_Failed" },
                    _w),
                _v),
            _q.FileRead = (_x = (function () {
                    function class_22() {
                    }
                    return class_22;
                }()),
                _x.Failed = (_y = (function () {
                        function class_23() {
                        }
                        return class_23;
                    }()),
                    _y.VALUE = { name: "Survey_Floodgate_FileRead_Failed" },
                    _y),
                _x),
            _q),
        _h);
    EventIds.Shared = (_z = (function () {
            function class_24() {
            }
            return class_24;
        }()),
        _z.Upload = (_0 = (function () {
                function class_25() {
                }
                return class_25;
            }()),
            _0.Failed = (_1 = (function () {
                    function class_26() {
                    }
                    return class_26;
                }()),
                _1.VALUE = { name: "Shared_Upload_Failed" },
                _1),
            _0),
        _z.Screenshot = (_2 = (function () {
                function class_27() {
                }
                return class_27;
            }()),
            _2.Render = (_3 = (function () {
                    function class_28() {
                    }
                    return class_28;
                }()),
                _3.Failed = (_4 = (function () {
                        function class_29() {
                        }
                        return class_29;
                    }()),
                    _4.VALUE = { name: "Shared_Screenshot_Render_Failed" },
                    _4),
                _3.Success = (_5 = (function () {
                        function class_30() {
                        }
                        return class_30;
                    }()),
                    _5.VALUE = { name: "Shared_Screenshot_Render_Success" },
                    _5),
                _3),
            _2.GetContent = (_6 = (function () {
                    function class_31() {
                    }
                    return class_31;
                }()),
                _6.Failed = (_7 = (function () {
                        function class_32() {
                        }
                        return class_32;
                    }()),
                    _7.DefaultImage = (_8 = (function () {
                            function class_33() {
                            }
                            return class_33;
                        }()),
                        _8.Returned = (_9 = (function () {
                                function class_34() {
                                }
                                return class_34;
                            }()),
                            _9.VALUE = { name: "Shared_Screenshot_GetContent_Failed_DefaultImage_Returned" },
                            _9),
                        _8),
                    _7),
                _6),
            _2),
        _z);
    return EventIds;
    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2, _3, _4, _5, _6, _7, _8, _9;
}());
exports.EventIds = EventIds;
},{}],54:[function(require,module,exports){
"use strict";
exports.__esModule = true;
var Constants_1 = require("./../Constants");
var Contracts_1 = require("./Telemetry/Contracts");
var Utils = require("./../Utils");
var TelemetryLoggerFactory_1 = require("./Telemetry/TelemetryLoggerFactory");
var Constants_2 = require("./Constants");
exports.EventIds = Constants_2.EventIds;
var NAMESPACE = "Office_Feedback";
var logger;
/**
 * Initialize the logging module
 * @param environment environment
 * @param appName app name
 * @param appVersion app version
 * @param audienceGroup audience group
 * @param hostId host id
 * @param hostSessionId host session Id
 * @param hostVersion host version
 */
function initialize(environment, appName, appVersion, audienceGroup, hostId, hostSessionId, hostVersion) {
    logger = new Logger(TelemetryLoggerFactory_1["default"].create(TokenManager.getTenantToken(environment), NAMESPACE, new Contracts_1.App(appName, appVersion), new Contracts_1.Session(Utils.guid()), new Contracts_1.Host(hostId, hostSessionId, hostVersion), new Contracts_1.Release(audienceGroup)));
}
exports.initialize = initialize;
/**
 * Get the logger object
 */
function getLogger() {
    return logger;
}
exports.getLogger = getLogger;
/**
 * Class representing a logger for the feedback SDK
 */
var Logger = (function () {
    function Logger(telemetryLogger) {
        if (!telemetryLogger) {
            throw new Error("telemetryLogger must not be null");
        }
        this.telemetryLogger = telemetryLogger;
    }
    /**
     * Log an event
     * @param eventId event Id
     * @param customProperties custom properties to add to the log
     */
    Logger.prototype.logEvent = function (eventId, customProperties) {
        if (!eventId) {
            throw new Error("eventId must not be null");
        }
        customProperties = customProperties || {};
        customProperties[Logger.EVENT_ID] = eventId.name;
        this.telemetryLogger.logEvent(Logger.EVENT_NAME, customProperties);
    };
    Logger.EVENT_NAME = "SDK";
    Logger.EVENT_ID = "EventId";
    return Logger;
}());
exports.Logger = Logger;
var TokenManager = (function () {
    function TokenManager() {
    }
    TokenManager.getTenantToken = function (environment) {
        if (environment === Constants_1.Environment.Production) {
            return TokenManager.TENANT_TOKEN_PRODUCTION;
        }
        else {
            return TokenManager.TENANT_TOKEN_PRE_PRODUCTION;
        }
    };
    TokenManager.TENANT_TOKEN_PRODUCTION = "d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360"; // "Office Feedback" Prod Aria tenant
    TokenManager.TENANT_TOKEN_PRE_PRODUCTION = "2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736"; // "Office Feedback" Sandbox Aria tenant
    return TokenManager;
}());
},{"./../Constants":43,"./../Utils":84,"./Constants":53,"./Telemetry/Contracts":57,"./Telemetry/TelemetryLoggerFactory":58}],55:[function(require,module,exports){
"use strict";
/**
* Aria.ts
*
* Module for wrapper around Aria
*/
exports.__esModule = true;
var aria = require("./../../thirdparty/aria-webjs-compact-sdk-1.2.0");
function AWT() { return aria.AWT; }
exports.AWT = AWT;
;
},{"./../../thirdparty/aria-webjs-compact-sdk-1.2.0":88}],56:[function(require,module,exports){
"use strict";
/**
 * An Aria-based logger
 */
exports.__esModule = true;
var Aria = require("./Aria");
var Contracts_1 = require("./Contracts");
var AriaTelemetryLogger = (function () {
    function AriaTelemetryLogger(tenantToken, namespace, app, session, host, release) {
        if (!tenantToken) {
            throw new Error("tenantToken must not be null");
        }
        if (!namespace) {
            throw new Error("namespace must not be null");
        }
        if (!app) {
            throw new Error("app must not be null");
        }
        if (!session) {
            throw new Error("session must not be null");
        }
        Aria.AWT().initialize(tenantToken);
        this.namespace = namespace;
        this.oesApp = app;
        this.oesSession = session;
        this.oesHost = host;
        this.oesRelease = release;
        this.sequence = 1; // Sequence starts at 1 not 0
    }
    AriaTelemetryLogger.setApp = function (properties, app) {
        properties["App.Name"] = app.getName();
        properties["App.Platform"] = app.getPlatform();
        properties["App.Version"] = app.getVersion();
    };
    AriaTelemetryLogger.setSession = function (properties, session) {
        properties["Session.Id"] = session.getId();
    };
    AriaTelemetryLogger.setHost = function (properties, host) {
        if (host) {
            properties["Host.Id"] = host.getId();
            // To be GDPR compliant do not log Host.SessionId
            properties["Host.Version"] = host.getVersion();
        }
    };
    AriaTelemetryLogger.setEvent = function (properties, event) {
        properties["Event.Name"] = event.getName();
        properties["Event.Id"] = event.getId();
        properties["Event.Source"] = event.getSource();
        properties["Event.SchemaVersion"] = event.getSchemaVersion();
        properties["Event.Sequence"] = event.getSequence();
    };
    AriaTelemetryLogger.setRelease = function (properties, release) {
        if (release) {
            properties["Release.AudienceGroup"] = release.getAudienceGroup();
        }
    };
    AriaTelemetryLogger.prototype.logEvent = function (eventName, customProperties) {
        if (!eventName) {
            throw new Error("eventName must not be null");
        }
        var oesEvent = new Contracts_1.Event(this.namespace + AriaTelemetryLogger.EVENT_NAME_DELIMITER + eventName, this.oesSession.getId(), this.sequence);
        var ariaProperties = {};
        if (customProperties != null) {
            for (var key in customProperties) {
                if (customProperties.hasOwnProperty(key)) {
                    ariaProperties[AriaTelemetryLogger.CUSTOM_PROPERTIES_FIELD_PREFIX + key] = customProperties[key];
                }
            }
        }
        AriaTelemetryLogger.setApp(ariaProperties, this.oesApp);
        AriaTelemetryLogger.setSession(ariaProperties, this.oesSession);
        AriaTelemetryLogger.setHost(ariaProperties, this.oesHost);
        AriaTelemetryLogger.setRelease(ariaProperties, this.oesRelease);
        AriaTelemetryLogger.setEvent(ariaProperties, oesEvent);
        Aria.AWT().logEvent({
            name: oesEvent.getName(),
            properties: ariaProperties
        });
        this.sequence++;
    };
    // Event.name is set as namespace<DELIMITER>eventName
    AriaTelemetryLogger.EVENT_NAME_DELIMITER = "_";
    AriaTelemetryLogger.CUSTOM_PROPERTIES_FIELD_PREFIX = "Data.";
    return AriaTelemetryLogger;
}());
exports["default"] = AriaTelemetryLogger;
},{"./Aria":55,"./Contracts":57}],57:[function(require,module,exports){
"use strict";
/**
 * Contracts enforced by OfficeEventSchema (OES)
 */
exports.__esModule = true;
var App = (function () {
    function App(name, version) {
        if (!name) {
            throw new Error("name must not be null");
        }
        if (!version) {
            throw new Error("version must not be null");
        }
        this.name = name;
        this.version = version;
    }
    App.prototype.getName = function () {
        return this.name;
    };
    App.prototype.getPlatform = function () {
        return App.PLATFORM;
    };
    App.prototype.getVersion = function () {
        return this.version;
    };
    App.PLATFORM = "Web";
    return App;
}());
exports.App = App;
var Session = (function () {
    function Session(id) {
        if (!id) {
            throw new Error("id must not be null");
        }
        this.id = id;
    }
    Session.prototype.getId = function () {
        return this.id;
    };
    return Session;
}());
exports.Session = Session;
var Host = (function () {
    function Host(id, sessionId, version) {
        this.id = id;
        this.sessionId = sessionId;
        this.version = version;
    }
    Host.prototype.getId = function () {
        return this.id;
    };
    Host.prototype.getSessionId = function () {
        return this.sessionId;
    };
    Host.prototype.getVersion = function () {
        return this.version;
    };
    return Host;
}());
exports.Host = Host;
var Event = (function () {
    function Event(name, sessionId, sequence) {
        if (!name) {
            throw new Error("name must not be null");
        }
        if (!sessionId) {
            throw new Error("sessionId must not be null");
        }
        if ((!sequence && sequence !== 0) || sequence < 0) {
            throw new Error("sequence must not be negative");
        }
        this.name = name;
        this.id = sessionId + Event.ID_DELIMITER + sequence;
        this.sequence = sequence;
    }
    Event.prototype.getName = function () {
        return this.name;
    };
    Event.prototype.getId = function () {
        return this.id;
    };
    Event.prototype.getSource = function () {
        return Event.SOURCE;
    };
    Event.prototype.getSchemaVersion = function () {
        return Event.SCHEMA_VERSION;
    };
    Event.prototype.getSequence = function () {
        return this.sequence;
    };
    // Id is set to sessionId<DELIMITER>sequence
    Event.ID_DELIMITER = ".";
    Event.SOURCE = "MsoThin";
    Event.SCHEMA_VERSION = 1;
    return Event;
}());
exports.Event = Event;
var Release = (function () {
    function Release(audienceGroup) {
        this.audienceGroup = audienceGroup;
    }
    Release.prototype.getAudienceGroup = function () {
        return this.audienceGroup;
    };
    return Release;
}());
exports.Release = Release;
},{}],58:[function(require,module,exports){
"use strict";
/**
 * Factory to return ITelemetryLogger objects
 */
exports.__esModule = true;
var AriaTelemetryLogger_1 = require("./AriaTelemetryLogger");
var TelemetryLoggerFactory = (function () {
    function TelemetryLoggerFactory() {
    }
    TelemetryLoggerFactory.create = function (tenantToken, namespace, app, session, host, release) {
        return new AriaTelemetryLogger_1["default"](tenantToken, namespace, app, session, host, release);
    };
    return TelemetryLoggerFactory;
}());
exports["default"] = TelemetryLoggerFactory;
},{"./AriaTelemetryLogger":56}],59:[function(require,module,exports){
"use strict";
/**
* Screenshot.ts
*
* A module for screenshot related logic.
* Note: It uses the htnl2canvas package. The package could be used as is, it is not packaged correctly for browserify.
* Using it without browserify would have polluted the global namespace by overriding "window.html2canvas".
* Until these issues get fixed the code has been changed to pollute window.OfficeBrowserFeedback.html2canvas instead.
*/
exports.__esModule = true;
var Window = require("./Window/Window");
/**
 * Create screenshot
 */
function createScreenShot() {
    var html2canvas = Window.get().OfficeBrowserFeedback.html2canvas();
    return html2canvas(document.body, { background: "#ffffff" });
}
exports.createScreenShot = createScreenShot;
},{"./Window/Window":87}],60:[function(require,module,exports){
"use strict";
/**
* Theme.ts
*
* Module for the UI Theme
*/
exports.__esModule = true;
var Constants = require("./Constants");
var defaultPrimaryColour = "#0167B0";
var defaultSecondaryColour = "#194789";
/**
 * Init
 * @param {string} primaryColour Primary Colour
 * @param {string} secondaryColour Secondary Colour
 */
function initialize(primaryColour, secondaryColour) {
    if (primaryColour === void 0) { primaryColour = undefined; }
    if (secondaryColour === void 0) { secondaryColour = undefined; }
    if (!primaryColour) {
        primaryColour = defaultPrimaryColour;
    }
    if (!secondaryColour) {
        secondaryColour = defaultSecondaryColour;
    }
    var sheet = document.createElement("style");
    sheet.textContent =
        "." + Constants.Classes.OverallAnchor + ":hover { background-color: " + secondaryColour + " } " +
            ("." + Constants.Classes.OverallAnchorActive + " { background-color: " + primaryColour + " } ") +
            ("." + Constants.Classes.SpinnerCircle + " { background-color: " + primaryColour + " } ") +
            (
            // tslint:disable-next-line:max-line-length
            "." + Constants.Classes.ChoiceGroup + " input[type=radio]:checked+label>." + Constants.Classes.ChoiceGroupIcon + " { border-color: " + primaryColour + " } ") +
            (
            // tslint:disable-next-line:max-line-length
            "." + Constants.Classes.ChoiceGroup + " input[type=radio]:hover+label>." + Constants.Classes.ChoiceGroupIcon + " { border-color: " + secondaryColour + " } ") +
            (
            // tslint:disable-next-line:max-line-length
            "." + Constants.Classes.ChoiceGroup + " input[type=radio]:checked+label>." + Constants.Classes.ChoiceGroupIcon + ">span { background-color: " + primaryColour + " } ") +
            ("." + Constants.Classes.SubmitButton + " { background-color: " + primaryColour + " } ") +
            ("." + Constants.Classes.SubmitButton + ":hover { background-color: " + secondaryColour + " } ") +
            ("." + Constants.Classes.Link + " { color: " + primaryColour + " } ") +
            ("." + Constants.Classes.Link + ":hover { color: " + secondaryColour + " } ") +
            ("#" + Constants.IDs.TPromptTitle + " { color: " + primaryColour + " } ") +
            ("#" + Constants.IDs.TFormTitle + " { color: " + primaryColour + " } ");
    document.body.appendChild(sheet);
}
exports.initialize = initialize;
},{"./Constants":43}],61:[function(require,module,exports){
"use strict";
/**
 * Manifest.ts
 * Module for managing the manifest file
 */
exports.__esModule = true;
var Constants_1 = require("./../../Constants");
var Manifest = (function () {
    function Manifest(manifestType, appId, submitTime, type, clientFeedbackId, applicationGroup, telemetryGroup, webGroup) {
        this.manifestData = {
            appId: appId,
            application: applicationGroup,
            clientFeedbackId: clientFeedbackId,
            manifestType: manifestType,
            source: "Client",
            submitTime: submitTime,
            telemetry: telemetryGroup,
            type: sanitizeType(type),
            web: webGroup
        };
    }
    Manifest.prototype.setComment = function (comment) {
        this.manifestData.comment = comment;
    };
    Manifest.prototype.setEmail = function (email) {
        this.manifestData.email = email;
    };
    Manifest.prototype.setCategory = function (category) {
        this.manifestData.telemetry = this.manifestData.telemetry || {};
        this.manifestData.telemetry.featureArea = category;
    };
    /**
     * Set freeform custom values in manifest. Throws if values are already set.
     * @param values the values as a JS object
     */
    Manifest.prototype.setValues = function (values) {
        if (values) {
            for (var field in values) {
                if (values.hasOwnProperty(field)) {
                    if (this.manifestData.hasOwnProperty(field)) {
                        throw Error("Key '" + field + "' already exists in manifest.");
                    }
                    this.manifestData[field] = values[field];
                }
            }
        }
    };
    Manifest.prototype.getContent = function () {
        return new Blob([JSON.stringify(this.manifestData)], { type: "application/json" });
    };
    return Manifest;
}());
exports.Manifest = Manifest;
function sanitizeType(type) {
    if (type === "Survey") {
        return type;
    }
    else {
        return Constants_1.FeedbackType[type];
    }
}
},{"./../../Constants":43}],62:[function(require,module,exports){
"use strict";
/**
 * Screenshot.ts
 * Module for managing the screenshot file
 */
exports.__esModule = true;
var Logging = require("./../../Logging/Logging");
var Screenshot = (function () {
    function Screenshot(screenshot) {
        this.screenshot = screenshot;
    }
    Screenshot.prototype.getContent = function () {
        var imgString;
        try {
            imgString = this.screenshot.toDataURL("image/jpeg").split(",")[1];
        }
        catch (e) {
            Logging.getLogger().logEvent(Logging.EventIds.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE, { ErrorMessage: e.toString() });
            // return an image with "Screenshot cannot be captured" message
            imgString = "iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII=";
        }
        var blobBin = atob(imgString);
        var array = [];
        for (var i = 0; i < blobBin.length; i++) {
            array.push(blobBin.charCodeAt(i));
        }
        var file = new Blob([new Uint8Array(array)], { type: "image/jpeg" });
        return file;
    };
    return Screenshot;
}());
exports.Screenshot = Screenshot;
},{"./../../Logging/Logging":54}],63:[function(require,module,exports){
"use strict";
exports.__esModule = true;
var es6_promise_1 = require("es6-promise");
var HTTP_TIMEOUT = 4000; // timeout in milliseconds
/**
 * Make an http request with retries
 * @param method the http method "GET", "POST" etc
 * @param url the url
 * @param requestBody the request body
 * @param maxRetries the maximum number of retries
 * @param onLoad the onload handler
 */
function makeHttpRequest(method, url, requestBody, maxRetries, onLoad) {
    var makeRequest = function (retries) {
        return new es6_promise_1.Promise(function (resolve, reject) {
            var xhr = new XMLHttpRequest();
            xhr.open(method, url, true);
            xhr.timeout = HTTP_TIMEOUT;
            xhr.onload = function () { onLoad(xhr, resolve, reject); };
            xhr.ontimeout = function () {
                if (retries > 0) {
                    makeRequest(retries - 1).then(resolve, reject);
                }
                else {
                    reject(new Error("Request to '" + url + "' timed out. timeout: " + HTTP_TIMEOUT));
                }
            };
            xhr.onerror = function () {
                if (retries > 0) {
                    makeRequest(retries - 1).then(resolve, reject);
                }
                else {
                    reject(new Error("Request to '" + url + "' errored. " + xhr.status + ": " + xhr.responseText));
                }
            };
            xhr.send(requestBody);
        });
    };
    return makeRequest(maxRetries);
}
var uploadEndpointInt = "https://petrol-int.office.microsoft.com/v1/feedback";
var uploadEndpointProd = "https://petrol.office.microsoft.com/v1/feedback";
/**
 * Send a payload to Petrol
 * @param isProduction is production?
 * @param manifest manifest content
 * @param screenshot screenshot content
 * @param diagnostics diagnostics content
 */
function send(isProduction, manifest, screenshot, diagnostics) {
    if (manifest === undefined) {
        return es6_promise_1.Promise.reject(new Error("Manifest cannot be undefined"));
    }
    var formData = new FormData();
    formData.append("Manifest", manifest);
    if (screenshot) {
        formData.append("Screenshot", screenshot);
    }
    if (diagnostics) {
        formData.append("Diagnostics", diagnostics);
    }
    return makeHttpRequest("POST", isProduction ? uploadEndpointProd : uploadEndpointInt, formData, 2, function (xhr, resolve, reject) {
        if (xhr.status !== 200) {
            reject(new Error("Non-200 response with status code: " + xhr.status + ", response: " + xhr.responseText));
        }
        resolve();
    });
}
exports.send = send;
},{"es6-promise":37}],64:[function(require,module,exports){
"use strict";
/**
 * Feedback.ts
 *
 * Module for payload transport.
 */
exports.__esModule = true;
var Constants = require("./../Constants");
var Utils = require("./../Utils");
var Logging = require("./../Logging/Logging");
var Petrol = require("./Petrol");
var Screenshot_1 = require("./Files/Screenshot");
var Configuration = require("../Configuration/Configuration");
var Manifest_1 = require("./Files/Manifest");
var Transporter = (function () {
    function Transporter(environment, manifestType, appId, type, applicationGroup, telemetryGroup, webGroup) {
        this.manifest = new Manifest_1.Manifest(manifestType, appId, new Date().toISOString(), type, Utils.guid(), applicationGroup, telemetryGroup, webGroup);
        this.environment = environment;
    }
    Transporter.prototype.setComment = function (comment) {
        this.manifest.setComment(comment);
    };
    Transporter.prototype.setEmail = function (email) {
        this.manifest.setEmail(email);
    };
    Transporter.prototype.setCategory = function (category) {
        this.manifest.setCategory(category);
    };
    Transporter.prototype.setScreenshot = function (screenshot) {
        this.screenshot = new Screenshot_1.Screenshot(screenshot);
    };
    /**
     * Set freeform custom values in manifest. Throws if values are already set.
     * @param values the values as a JS object
     */
    Transporter.prototype.setManifestValues = function (values) {
        this.manifest.setValues(values);
    };
    /**
     * Submit the payload
     */
    Transporter.prototype.submit = function () {
        var manifestContent = this.manifest.getContent();
        var screenshotContent = undefined;
        if (this.screenshot) {
            screenshotContent = this.screenshot.getContent();
        }
        return Petrol.send(this.environment === Constants.Environment.Production, manifestContent, screenshotContent)["catch"](function onRejected(err) {
            Configuration.get().getCommonInitOptions().onError("Payload submission failed: " + err.message);
            Logging.getLogger().logEvent(Logging.EventIds.Shared.Upload.Failed.VALUE, { ErrorMessage: err.message });
        });
    };
    return Transporter;
}());
exports.Transporter = Transporter;
},{"../Configuration/Configuration":42,"./../Constants":43,"./../Logging/Logging":54,"./../Utils":84,"./Files/Manifest":61,"./Files/Screenshot":62,"./Petrol":63}],65:[function(require,module,exports){
"use strict";
/**
* UIStrings.ts
*
* Module for the strings to display
*/
exports.__esModule = true;
/**
 * Localized UI strings
 */
var uIStrings;
/**
 * Set UI strings
 * @param {string} data List of localized UI strings
 */
function setUIStrings(data) {
    uIStrings = data;
}
exports.setUIStrings = setUIStrings;
/**
 * Get UI strings
 * @returns the UIStrings
 */
function getUIStrings() {
    return uIStrings;
}
exports.getUIStrings = getUIStrings;
},{}],66:[function(require,module,exports){
"use strict";
/**
 * BellyBand.ts
 *
 * Module for the BellyBand UI
 */
exports.__esModule = true;
var Constants_1 = require("./../../Constants");
var Events = require("./Events");
var Layout = require("./Layout");
var Renderer = require("./../Renderer");
var Utils = require("./../Utils");
var WindowProperties = require("./../../WindowProperties");
var BasicFormTemplate = require("./FormTemplates/BasicFormTemplate");
var UserVoiceFormTemplate = require("./FormTemplates/UserVoiceFormTemplate");
var Configuration = require("./../../Configuration/Configuration");
/**
 * UI initialization for multi, including creating all feedback related HTML elements and setting
 * initial visibility of elements
 */
function createMulti(onClose) {
    // Create the feedbackType -> IFormTemplate mapping
    var formTemplates = {};
    formTemplates[Constants_1.FeedbackType.Smile] = BasicFormTemplate;
    formTemplates[Constants_1.FeedbackType.Frown] = BasicFormTemplate;
    // Show uservoice only if locale is en
    if (Configuration.get().getInAppFeedbackInitOptions().userVoice &&
        Configuration.get().getCommonInitOptions().locale === "en") {
        formTemplates[Constants_1.FeedbackType.Idea] = UserVoiceFormTemplate;
    }
    else {
        formTemplates[Constants_1.FeedbackType.Idea] = BasicFormTemplate;
    }
    if (Configuration.get().getInAppFeedbackInitOptions().bugForm) {
        formTemplates[Constants_1.FeedbackType.Bug] = BasicFormTemplate;
    }
    create(Renderer.elementFromJson(Layout.generateMulti(formTemplates)));
    var useNarrowScreenLayout = WindowProperties.isNarrow();
    Events.registerMulti(formTemplates, useNarrowScreenLayout, function (submitted) {
        Utils.setElementVisibility(Constants_1.IDs.OverlayBackground, false);
        Utils.deleteElementById(Constants_1.IDs.OverlayBackground);
        Configuration.get().getInAppFeedbackInitOptions().onDismiss(submitted);
        onClose();
    });
    // If the screen size is narrow, add the Narrow class to the outermost div so that 
    // the CSS used corresponds to the small screen UI
    if (useNarrowScreenLayout) {
        Utils.addClassById(Constants_1.IDs.OverlayBackground, Constants_1.Classes.NarrowLayout);
    }
}
exports.createMulti = createMulti;
/**
 * UI initialization for single, including creating all feedback related HTML elements and setting
 * initial visibility of elements
 * @return {void}
 */
function createSingle(onClose, feedbackType) {
    create(Renderer.elementFromJson(Layout.generateSingle()));
    Events.registerSingle(feedbackType, function (submitted) {
        Utils.setElementVisibility(Constants_1.IDs.OverlayBackground, false);
        Utils.deleteElementById(Constants_1.IDs.OverlayBackground);
        Configuration.get().getInAppFeedbackInitOptions().onDismiss(submitted);
        onClose();
    });
    Utils.addClassById(Constants_1.IDs.OverlayBackground, Constants_1.Classes.SingleLayout);
}
exports.createSingle = createSingle;
/**
 * Attach the UI element to the DOM.
 * @param userInterface the UI element
 */
function create(userInterface) {
    document.body.insertBefore(userInterface, document.body.firstChild);
    Utils.setElementVisibility(Constants_1.IDs.OverlayBackground, true);
    if (Utils.getInternetExplorerVersion() > 9 || Utils.getInternetExplorerVersion() === -1) {
        // Show the main feedback UI after a certain time to wait for the CSS keyframes animation to finish if 
        // the browser is IE10 and above or non-IE
        setTimeout(onMainContainerRender, 900);
    }
    else {
        onMainContainerRender();
    }
}
/**
 * Code to run when the main container animation has completed.
 */
function onMainContainerRender() {
    // Show the MainContentHolder inside the MainContainer
    Utils.setElementVisibility(Constants_1.IDs.MainContentHolder, true);
    if (document.getElementById(Constants_1.IDs.OverallSmileAnchor)) {
        // Multi feedback
        document.getElementById(Constants_1.IDs.OverallSmileAnchor).focus();
    }
    else if (document.getElementById(Constants_1.IDs.SingleFormComment)) {
        // Single feedback
        document.getElementById(Constants_1.IDs.SingleFormComment).focus();
    }
}
/**
 * UI dismiss. Delete all feedback related HTML elements
 * @return {void}
 */
function dismiss() {
    return;
}
exports.dismiss = dismiss;
},{"./../../Configuration/Configuration":42,"./../../Constants":43,"./../../WindowProperties":86,"./../Renderer":77,"./../Utils":83,"./Events":67,"./FormTemplates/BasicFormTemplate":68,"./FormTemplates/UserVoiceFormTemplate":71,"./Layout":72}],67:[function(require,module,exports){
"use strict";
/**
* Events.ts
*
* A module for all Event handling.
*/
exports.__esModule = true;
var Transport_1 = require("./../../Transport/Transport");
var Configuration = require("./../../Configuration/Configuration");
var Constants_1 = require("./../../Constants");
var Logging = require("./../../Logging/Logging");
var Screenshot = require("./../../Screenshot");
var SpinnerControl_1 = require("./../SpinnerControl");
var UiUtils = require("./../Utils");
var TabFocus = require("./TabFocus");
/**
 * Whether to use narrow layout
 */
var useNarrowLayout = false;
/**
 * Callback for when the feedback dialog is dismissed
 */
var onDismiss;
/**
 * The Selected feedback type, undefined if none selected
 */
var selectedFeedbackType = undefined;
/**
 * feedbackType -> IFormTemplate mapping for multi BellyBand
 */
var formTemplates;
/**
 * Dismiss all, including networking, UI, and events
 * @param submitted Was the control submitted (true), or cancelled (false)?
 */
function dismissAll(submitted) {
    unregister();
    onDismiss(submitted);
}
/**
 * List of listeners and the ids they are attached to. This ensures all events are correctly unregistered.
 */
var listenersList = [];
function addListener(id, event, listener) {
    UiUtils.registerListener(id, event, listener);
    listenersList.push({ event: event, id: id, listener: listener });
}
function removeListeners() {
    for (var _i = 0, listenersList_1 = listenersList; _i < listenersList_1.length; _i++) {
        var listener = listenersList_1[_i];
        UiUtils.unregisterListener(listener.id, listener.event, listener.listener);
    }
    listenersList = [];
}
/**
 * Register events for single belly band
 */
function registerSingle(feedbackType, ON_DISMISS) {
    if (ON_DISMISS === void 0) { ON_DISMISS = function (submitted) { return; }; }
    selectedFeedbackType = feedbackType;
    // SingleFormTemplate events
    addListener(Constants_1.IDs.SingleFormSubmitButton, "click", submitButtonHandlerFactory(Constants_1.IDs.SingleFormSubmitButton, Constants_1.IDs.SingleFormSubmitButtonSpinner, Constants_1.IDs.SingleFormComment, Constants_1.IDs.SingleFormEmailInput, Constants_1.IDs.SingleFormScreenshotCheckbox, Constants_1.IDs.SingleFormCategoriesDropdown));
    registerCommon(ON_DISMISS);
}
exports.registerSingle = registerSingle;
/**
 * Register events for multi belly band
 */
function registerMulti(FORMTEMPLATES, USE_NARROW_LAYOUT, ON_DISMISS) {
    if (ON_DISMISS === void 0) { ON_DISMISS = function (submitted) { return; }; }
    useNarrowLayout = USE_NARROW_LAYOUT;
    formTemplates = FORMTEMPLATES;
    addListener(Constants_1.IDs.OverallSmileAnchor, "click", overallSmileHandler);
    addListener(Constants_1.IDs.OverallFrownAnchor, "click", overallFrownHandler);
    addListener(Constants_1.IDs.OverallIdeaAnchor, "click", overallIdeaHandler);
    addListener(Constants_1.IDs.OverallBugAnchor, "click", overallBugHandler);
    // BasicFormTemplate events
    addListener(Constants_1.IDs.BasicFormSubmitButton, "click", submitButtonHandlerFactory(Constants_1.IDs.BasicFormSubmitButton, Constants_1.IDs.BasicFormSubmitButtonSpinner, Constants_1.IDs.BasicFormComment, Constants_1.IDs.BasicFormEmailInput, Constants_1.IDs.BasicFormScreenshotCheckbox, Constants_1.IDs.BasicFormCategoriesDropdown));
    // UserVoiceFormTemplate events
    addListener(Constants_1.IDs.UserVoiceFormGoButton, "click", UserVoiceFormGoButtonHandler);
    registerCommon(ON_DISMISS);
}
exports.registerMulti = registerMulti;
function registerCommon(ON_DISMISS) {
    onDismiss = ON_DISMISS;
    UiUtils.addEventListenerHelper(window, "keyup", keyEventHandler);
    addListener(Constants_1.IDs.OverlayBackground, "click", overlayBackgroundHandler);
    addListener(Constants_1.IDs.MainContainer, "click", mainContainerHandler);
    addListener(Constants_1.IDs.MainContainer, "keyup", tabKeyEventHandler);
    addListener(Constants_1.IDs.PrivacyStatementLink, "click", privacyStatementLinkHandler);
}
/**
 * Listener un-registration
 */
function unregister() {
    UiUtils.removeEventListenerHelper(window, "keyup", keyEventHandler);
    removeListeners();
}
/**
 * Tab key event handler
 * @param event The Event object
 */
function tabKeyEventHandler(event) {
    var keyCode = event.keyCode || event.which;
    if (keyCode === Constants_1.Keys.Tab) {
        if ((document.activeElement.id === Constants_1.IDs.FirstTabbable && event.shiftKey) ||
            (document.activeElement.id === Constants_1.IDs.LastTabbable && !event.shiftKey)) {
            event.stopPropagation();
            TabFocus.cycleTabFocus(document.activeElement);
        }
    }
}
/**
 * Key event handler
 * @param event The Event object
 */
function keyEventHandler(event) {
    // dismiss feedback upon pressing the escape key
    if (event.keyCode === Constants_1.Keys.Esc) {
        event.preventDefault();
        event.stopPropagation();
        dismissAll(false /*submitted*/);
    }
}
/**
 * Overlay background event handler. Dismiss feedback upon clicking on the background area
 * @param event The Event object
 */
function overlayBackgroundHandler(event) {
    event.preventDefault();
    event.stopPropagation();
    dismissAll(false /*submitted*/);
}
/**
 * Main container event handler. When clicking on main container area, do not propagate the event to lower level.
 * @param event The Event object
 */
function mainContainerHandler(event) {
    event.stopPropagation();
}
/**
 * Privacy statement link handler. When clicking on the privacy statement link,
 * do not propagate the event to lower level.
 * @param event The Event object
 */
function privacyStatementLinkHandler(event) {
    event.stopPropagation();
}
/**
 * Overall button click handler
 * @param event The Event object
 * @param achorId The id of the anchor html element which was selected
 */
function overallHandler(event, anchorId) {
    event.preventDefault();
    event.stopPropagation();
    UiUtils.replaceClassesById(Constants_1.IDs.OverallSmileAnchor, Constants_1.Classes.OverallAnchorActive);
    UiUtils.replaceClassesById(Constants_1.IDs.OverallFrownAnchor, Constants_1.Classes.OverallAnchorActive);
    UiUtils.replaceClassesById(Constants_1.IDs.OverallIdeaAnchor, Constants_1.Classes.OverallAnchorActive);
    UiUtils.replaceClassesById(Constants_1.IDs.OverallBugAnchor, Constants_1.Classes.OverallAnchorActive);
    UiUtils.addClassById(anchorId, Constants_1.Classes.OverallAnchorActive);
    Logging.getLogger().logEvent(Logging.EventIds.InApp.UI.Form.Shown.VALUE, { FeedbackType: selectedFeedbackType });
    var formTemplate = formTemplates[selectedFeedbackType];
    mainContentHolderSlideLeft(formTemplate.containerId);
    formTemplate.onSelect(selectedFeedbackType);
}
/**
 * Smile button event handler
 * @param event The Event object
 */
function overallSmileHandler(event) {
    selectedFeedbackType = Constants_1.FeedbackType.Smile;
    overallHandler(event, Constants_1.IDs.OverallSmileAnchor);
}
/**
 * Frown button event handler
 * @param event The Event object
 */
function overallFrownHandler(event) {
    selectedFeedbackType = Constants_1.FeedbackType.Frown;
    overallHandler(event, Constants_1.IDs.OverallFrownAnchor);
}
/**
 * Idea button event handler
 * @param event The Event object
 */
function overallIdeaHandler(event) {
    selectedFeedbackType = Constants_1.FeedbackType.Idea;
    overallHandler(event, Constants_1.IDs.OverallIdeaAnchor);
}
/**
 * Bug button event handler
 * @param event The Event object
 */
function overallBugHandler(event) {
    selectedFeedbackType = Constants_1.FeedbackType.Bug;
    overallHandler(event, Constants_1.IDs.OverallBugAnchor);
}
/**
 * Main content holder slide left animation
 * @param {string} containerId The id of the container to be made visible
 * @return {void}
 */
function mainContentHolderSlideLeft(containerId) {
    for (var feedbackType in formTemplates) {
        if (formTemplates.hasOwnProperty(feedbackType)) {
            UiUtils.setElementVisibility(formTemplates[feedbackType].containerId, false);
        }
    }
    if (useNarrowLayout) {
        UiUtils.setElementVisibility(Constants_1.IDs.LeftFormContainer, false);
        UiUtils.setElementVisibility(Constants_1.IDs.MiddleFormContainer, true);
        UiUtils.setElementVisibility(containerId, true);
    }
    else {
        UiUtils.addClassById(Constants_1.IDs.ColumnSeparatorDiv, Constants_1.Classes.ShowRightBorder);
        UiUtils.setElementVisibility(Constants_1.IDs.MiddleFormContainer, true);
        UiUtils.setElementVisibility(containerId, true);
        UiUtils.addClassById(Constants_1.IDs.LeftFormContainer, Constants_1.Classes.SlideLeft);
        UiUtils.addClassById(Constants_1.IDs.MiddleFormContainer, Constants_1.Classes.SlideLeft);
    }
}
/**
 * Submit button event handler factory
 * @param event The Event object
 */
function submitButtonHandlerFactory(submitButtonId, spinnerId, commentInputId, emailInputId, screenshotCheckboxId, categoriesDropdownId) {
    return function (event) {
        event.preventDefault();
        event.stopPropagation();
        UiUtils.setElementVisibility(submitButtonId, false);
        var spinner = new SpinnerControl_1.Spinner(spinnerId);
        var transporter = new Transport_1.Transporter(Configuration.get().getCommonInitOptions().environment, "Sas", Configuration.get().getCommonInitOptions().appId, selectedFeedbackType, Configuration.get().getCommonInitOptions().applicationGroup, Configuration.get().getCommonInitOptions().telemetryGroup, Configuration.get().getCommonInitOptions().webGroup);
        var commentElement = document.getElementById(commentInputId);
        var commentEntered = (commentElement && !!commentElement.value);
        if (commentEntered) {
            transporter.setComment(commentElement.value);
        }
        var emailElement = document.getElementById(emailInputId);
        var isEmailIncluded = (emailElement && !!emailElement.value);
        if (isEmailIncluded) {
            transporter.setEmail(emailElement.value);
        }
        var screenshotCheckBox = document.getElementById(screenshotCheckboxId);
        var screenshotCheckBoxSelected = screenshotCheckBox && screenshotCheckBox.checked;
        var categoryElement = document.getElementById(categoriesDropdownId);
        var isCategorySelected = (categoryElement && categoryElement.selectedIndex > 0);
        if (isCategorySelected) {
            transporter.setCategory(categoryElement.value);
        }
        Logging.getLogger().logEvent(Logging.EventIds.InApp.UI.Form.Submit.VALUE, {
            FeedbackType: selectedFeedbackType,
            IsEmailIncluded: isEmailIncluded,
            IsScreenshotIncluded: screenshotCheckBoxSelected
        });
        if (screenshotCheckBoxSelected) {
            var startTime_1 = performance.now();
            Screenshot.createScreenShot().then(function (canvas) {
                var endTime = performance.now();
                Logging.getLogger().logEvent(Logging.EventIds.Shared.Screenshot.Render.Success.VALUE, { TimeMilliseconds: endTime - startTime_1 });
                transporter.setScreenshot(canvas);
                transporter.submit();
            })["catch"](function (error) {
                var endTime = performance.now();
                Logging.getLogger().logEvent(Logging.EventIds.Shared.Screenshot.Render.Failed.VALUE, { ErrorMessage: error, TimeMilliseconds: endTime - startTime_1 });
                transporter.submit();
            });
        }
        else {
            transporter.submit();
        }
        spinner.destroy();
        dismissAll(true /*submitted*/);
    };
}
/**
 * UserVoiceForm Go button event handler
 * Opens UserVoice forum in a new window
 * @param event The Event object
 */
function UserVoiceFormGoButtonHandler(event) {
    event.preventDefault();
    event.stopPropagation();
    window.open(document.getElementById(Constants_1.IDs.UserVoiceFormGoButton).getAttribute(Constants_1.AttributeName.Source));
    dismissAll(false /* submitted */);
}
},{"./../../Configuration/Configuration":42,"./../../Constants":43,"./../../Logging/Logging":54,"./../../Screenshot":59,"./../../Transport/Transport":64,"./../SpinnerControl":78,"./../Utils":83,"./TabFocus":73}],68:[function(require,module,exports){
"use strict";
/**
* BasicFormTemplate.ts
*
* A form template with contact info fields.
*/
exports.__esModule = true;
var UIStrings = require("./../../../UIStrings/UIStrings");
var FormTemplateType_1 = require("./FormTemplateType");
var CategoriesDropdown = require("./../../CategoriesDropdown");
var RatingControl = require("./../../RatingControl");
var Constants = require("./../../../Constants");
var Configuration = require("./../../../Configuration/Configuration");
/**
 * Generate the markup
 * @returns the markup as json
 */
function generate() {
    var categories = Configuration.get().getInAppFeedbackLaunchOptions().categories;
    var formSchema = {
        children: [
            {
                attributes: [{ name: Constants.AttributeName.For, value: Constants.IDs.BasicFormComment }],
                classes: [
                    Constants.Classes.FontSubtitle,
                    Constants.Classes.TextAlignLeft,
                    Constants.Classes.FormQuestionMiddleText,
                ],
                id: Constants.IDs.BasicFormQuestionMiddleText,
                tag: Constants.Tags.Label
            },
            {
                attributes: [{ name: Constants.AttributeName.Id, value: Constants.IDs.BasicFormCategoriesDropdown }],
                brs: categories.show,
                children: CategoriesDropdown.generate(categories ? categories.customCategories : null),
                classes: [Constants.Classes.FontSubText, Constants.Classes.FormCategoriesDropdown, Constants.Classes.TextInput],
                tag: Constants.Tags.Select
            },
            {
                attributes: [
                    {
                        name: Constants.AttributeName.Placeholder,
                        value: UIStrings.getUIStrings().Form.CommentPlaceholder
                    },
                    {
                        name: Constants.AttributeName.MaxLength,
                        value: Constants.AttributeValue.TextAreaMaxLength
                    },
                ],
                classes: [Constants.Classes.FontSubText, Constants.Classes.FormComment, Constants.Classes.TextInput],
                id: Constants.IDs.BasicFormComment,
                tag: Constants.Tags.TextArea
            },
            {
                brs: false,
                children: [
                    {
                        attributes: [{ name: Constants.AttributeName.For, value: Constants.IDs.BasicFormRating }],
                        classes: [Constants.Classes.FontText, Constants.Classes.TextAlignLeft, Constants.Classes.FormRatingLabel],
                        innerText: UIStrings.getUIStrings().Form.RatingLabel,
                        tag: Constants.Tags.Label
                    },
                    RatingControl.generate(Constants.IDs.BasicFormRating),
                ],
                classes: [Constants.Classes.FormRatingContainer]
            },
            {
                attributes: [
                    {
                        name: Constants.AttributeName.Type,
                        value: Constants.AttributeValue.Text
                    },
                    {
                        name: Constants.AttributeName.Placeholder,
                        value: UIStrings.getUIStrings().Form.EmailPlaceholder
                    },
                    {
                        name: Constants.AttributeName.AriaLabel,
                        value: UIStrings.getUIStrings().Form.EmailPlaceholder
                    },
                    {
                        name: Constants.AttributeName.Name,
                        value: Constants.IDs.BasicFormEmailInput
                    },
                    {
                        name: Constants.AttributeName.MaxLength,
                        value: Constants.AttributeValue.TextAreaMaxLength
                    },
                    {
                        name: Constants.AttributeName.Value,
                        value: Configuration.get().getInAppFeedbackInitOptions().userEmail
                            ? Configuration.get().getInAppFeedbackInitOptions().userEmail
                            : ""
                    },
                ],
                classes: [Constants.Classes.FontSubText, Constants.Classes.FormEmailInput, Constants.Classes.TextInput],
                id: Constants.IDs.BasicFormEmailInput,
                tag: Constants.Tags.Input
            },
            {
                children: [
                    {
                        children: [
                            {
                                attributes: [
                                    {
                                        name: Constants.AttributeName.Type,
                                        value: Constants.AttributeValue.Checkbox
                                    },
                                    {
                                        name: Constants.AttributeName.Value,
                                        value: Constants.AttributeValue.Unchecked
                                    },
                                ],
                                brs: Configuration.get().getInAppFeedbackInitOptions().screenshot,
                                classes: [Constants.Classes.FormScreenshotCheckbox, Constants.Classes.CheckBox],
                                id: Constants.IDs.BasicFormScreenshotCheckbox,
                                tag: Constants.Tags.Input
                            },
                            {
                                attributes: [{ name: Constants.AttributeName.For, value: Constants.IDs.BasicFormScreenshotCheckbox }],
                                brs: Configuration.get().getInAppFeedbackInitOptions().screenshot,
                                classes: [Constants.Classes.FontText, Constants.Classes.TextAlignLeft, Constants.Classes.FormScreenshotLabel],
                                innerText: UIStrings.getUIStrings().Form.ScreenshotLabel,
                                tag: Constants.Tags.Label
                            },
                        ],
                        classes: [Constants.Classes.FormScreenshotContainer]
                    },
                    {
                        children: [
                            {
                                classes: [
                                    Constants.Classes.FontSubText,
                                    Constants.Classes.SubmitButton,
                                ],
                                id: Constants.IDs.BasicFormSubmitButton,
                                innerText: UIStrings.getUIStrings().Form.Submit,
                                tag: Constants.Tags.Button
                            },
                            {
                                classes: [Constants.Classes.Spinner, Constants.Classes.Hidden],
                                id: Constants.IDs.BasicFormSubmitButtonSpinner,
                                tag: Constants.Tags.Div
                            },
                        ],
                        classes: [Constants.Classes.FormSubmitButtonContainer]
                    },
                ],
                classes: [Constants.Classes.FormBottomContainer]
            },
        ],
        classes: [Constants.Classes.Hidden, Constants.Classes.MarginLeft60px],
        id: exports.containerId
    };
    return formSchema;
}
exports.generate = generate;
/**
 * The id for the container. This is the id of the top-most element and should
 * be unique to each form
 */
exports.containerId = Constants.IDs.BasicFormContainer;
/**
 * Forms may be used for different feedback types. This method executes form
 * specific logic when the feedback type is selected
 * @param feedbackType feedback type
 */
function onSelect(feedbackType) {
    switch (feedbackType) {
        case Constants.FeedbackType.Smile: {
            document.getElementById(Constants.IDs.BasicFormQuestionMiddleText).textContent =
                UIStrings.getUIStrings().SmileForm.Title;
            break;
        }
        case Constants.FeedbackType.Frown: {
            document.getElementById(Constants.IDs.BasicFormQuestionMiddleText).textContent =
                UIStrings.getUIStrings().FrownForm.Title;
            break;
        }
        case Constants.FeedbackType.Idea: {
            document.getElementById(Constants.IDs.BasicFormQuestionMiddleText).textContent =
                UIStrings.getUIStrings().IdeaForm.Title;
            break;
        }
        case Constants.FeedbackType.Bug: {
            document.getElementById(Constants.IDs.BasicFormQuestionMiddleText).textContent =
                UIStrings.getUIStrings().BugForm.Title;
            break;
        }
        default: {
            break;
        }
    }
    document.getElementById(Constants.IDs.BasicFormComment).focus();
}
exports.onSelect = onSelect;
/**
 * Form template type
 */
exports.type = FormTemplateType_1.FormTemplateType.Basic;
},{"./../../../Configuration/Configuration":42,"./../../../Constants":43,"./../../../UIStrings/UIStrings":65,"./../../CategoriesDropdown":74,"./../../RatingControl":76,"./FormTemplateType":69}],69:[function(require,module,exports){
"use strict";
/**
* FormTemplateType.ts
*
* An enum for the types of forms available.
*/
exports.__esModule = true;
var FormTemplateType;
(function (FormTemplateType) {
    FormTemplateType[FormTemplateType["Single"] = 0] = "Single";
    FormTemplateType[FormTemplateType["Basic"] = 1] = "Basic";
    FormTemplateType[FormTemplateType["UserVoice"] = 2] = "UserVoice";
})(FormTemplateType = exports.FormTemplateType || (exports.FormTemplateType = {}));
},{}],70:[function(require,module,exports){
"use strict";
/**
* SingleFormTemplate.ts
*
* A form template with contact info fields.
*/
exports.__esModule = true;
var UIStrings = require("./../../../UIStrings/UIStrings");
var FormTemplateType_1 = require("./FormTemplateType");
var CategoriesDropdown = require("./../../CategoriesDropdown");
var RatingControl = require("./../../RatingControl");
var Configuration = require("./../../../Configuration/Configuration");
var Constants = require("./../../../Constants");
/**
 * Generate the markup
 * @returns the markup as json
 */
function generate() {
    var categories = Configuration.get().getInAppFeedbackLaunchOptions().categories;
    var formSchema = {
        children: [
            {
                attributes: [{ name: Constants.AttributeName.For, value: Constants.IDs.SingleFormComment }],
                classes: [
                    Constants.Classes.FontSubtitle,
                    Constants.Classes.TextAlignLeft,
                    Constants.Classes.FormQuestionMiddleText,
                ],
                id: Constants.IDs.SingleFormQuestionMiddleText,
                innerText: UIStrings.getUIStrings().SingleForm.Title,
                tag: Constants.Tags.Label
            },
            {
                attributes: [{ name: Constants.AttributeName.Id, value: Constants.IDs.SingleFormCategoriesDropdown }],
                brs: categories.show,
                children: CategoriesDropdown.generate(categories ? categories.customCategories : null),
                classes: [Constants.Classes.FontSubText, Constants.Classes.FormCategoriesDropdown, Constants.Classes.TextInput],
                tag: Constants.Tags.Select
            },
            {
                attributes: [
                    {
                        name: Constants.AttributeName.Placeholder,
                        value: UIStrings.getUIStrings().Form.CommentPlaceholder
                    },
                    {
                        name: Constants.AttributeName.MaxLength,
                        value: Constants.AttributeValue.TextAreaMaxLength
                    },
                ],
                classes: [Constants.Classes.FontSubText, Constants.Classes.FormComment, Constants.Classes.TextInput],
                id: Constants.IDs.SingleFormComment,
                tag: Constants.Tags.TextArea
            },
            {
                brs: false,
                children: [
                    {
                        attributes: [{ name: Constants.AttributeName.For, value: Constants.IDs.SingleFormRating }],
                        classes: [
                            Constants.Classes.FontSubText,
                            Constants.Classes.TextAlignLeft,
                            Constants.Classes.FormRatingLabel,
                        ],
                        innerText: UIStrings.getUIStrings().Form.RatingLabel,
                        tag: Constants.Tags.Label
                    },
                    RatingControl.generate(Constants.IDs.SingleFormRating),
                ],
                classes: [Constants.Classes.FormRatingContainer]
            },
            {
                attributes: [
                    {
                        name: Constants.AttributeName.Type,
                        value: Constants.AttributeValue.Text
                    },
                    {
                        name: Constants.AttributeName.Placeholder,
                        value: UIStrings.getUIStrings().Form.EmailPlaceholder
                    },
                    {
                        name: Constants.AttributeName.AriaLabel,
                        value: UIStrings.getUIStrings().Form.EmailPlaceholder
                    },
                    {
                        name: Constants.AttributeName.Name,
                        value: Constants.IDs.SingleFormEmailInput
                    },
                    {
                        name: Constants.AttributeName.MaxLength,
                        value: Constants.AttributeValue.TextAreaMaxLength
                    },
                    {
                        name: Constants.AttributeName.Value,
                        value: Configuration.get().getInAppFeedbackInitOptions().userEmail
                            ? Configuration.get().getInAppFeedbackInitOptions().userEmail
                            : ""
                    },
                ],
                classes: [Constants.Classes.FontSubText, Constants.Classes.FormEmailInput, Constants.Classes.TextInput],
                id: Constants.IDs.SingleFormEmailInput,
                tag: Constants.Tags.Input
            },
            {
                children: [
                    {
                        attributes: [
                            {
                                name: Constants.AttributeName.HRef,
                                value: Constants.Urls.PrivacyStatementLink
                            },
                            {
                                name: Constants.AttributeName.Target,
                                value: Constants.AttributeValue.BlankWindow
                            },
                            {
                                name: Constants.AttributeName.Rel,
                                value: Constants.AttributeValue.NoReferrer
                            },
                        ],
                        classes: [Constants.Classes.Link],
                        id: Constants.IDs.PrivacyStatementLink,
                        innerText: UIStrings.getUIStrings().PrivacyStatement,
                        tag: Constants.Tags.Anchor
                    },
                ],
                classes: [Constants.Classes.FontSubSubText, Constants.Classes.TextAlignLeft,
                    Constants.Classes.PrivacyStatementLinkDiv]
            },
            {
                children: [
                    {
                        children: [
                            {
                                attributes: [
                                    {
                                        name: Constants.AttributeName.Type,
                                        value: Constants.AttributeValue.Checkbox
                                    },
                                    {
                                        name: Constants.AttributeName.Value,
                                        value: Constants.AttributeValue.Unchecked
                                    },
                                ],
                                brs: Configuration.get().getInAppFeedbackInitOptions().screenshot,
                                classes: [Constants.Classes.FormScreenshotCheckbox, Constants.Classes.CheckBox],
                                id: Constants.IDs.SingleFormScreenshotCheckbox,
                                tag: Constants.Tags.Input
                            },
                            {
                                attributes: [{ name: Constants.AttributeName.For, value: Constants.IDs.SingleFormScreenshotCheckbox }],
                                brs: Configuration.get().getInAppFeedbackInitOptions().screenshot,
                                classes: [Constants.Classes.FontText, Constants.Classes.TextAlignLeft, Constants.Classes.FormScreenshotLabel],
                                innerText: UIStrings.getUIStrings().Form.ScreenshotLabel,
                                tag: Constants.Tags.Label
                            },
                        ],
                        classes: [Constants.Classes.FormScreenshotContainer]
                    },
                    {
                        children: [
                            {
                                classes: [
                                    Constants.Classes.FontSubText,
                                    Constants.Classes.SubmitButton,
                                ],
                                id: Constants.IDs.SingleFormSubmitButton,
                                innerText: UIStrings.getUIStrings().Form.Submit,
                                tag: Constants.Tags.Button
                            },
                            {
                                classes: [Constants.Classes.Spinner, Constants.Classes.Hidden],
                                id: Constants.IDs.SingleFormSubmitButtonSpinner,
                                tag: Constants.Tags.Div
                            },
                        ],
                        classes: [Constants.Classes.FormSubmitButtonContainer]
                    },
                ],
                classes: [Constants.Classes.FormBottomContainer]
            },
        ],
        id: exports.containerId
    };
    return formSchema;
}
exports.generate = generate;
/**
 * The id for the container. This is the id of the top-most element and should
 * be unique to each form
 */
exports.containerId = Constants.IDs.SingleFormContainer;
/**
 * Forms may be used for different feedback types. This method executes form
 * specific logic when the feedback type is selected
 * @param feedbackType feedback type
 */
function onSelect(feedbackType) {
    document.getElementById(Constants.IDs.SingleFormComment).focus();
}
exports.onSelect = onSelect;
/**
 * Form template type
 */
exports.type = FormTemplateType_1.FormTemplateType.Single;
},{"./../../../Configuration/Configuration":42,"./../../../Constants":43,"./../../../UIStrings/UIStrings":65,"./../../CategoriesDropdown":74,"./../../RatingControl":76,"./FormTemplateType":69}],71:[function(require,module,exports){
"use strict";
/**
* UserVoiceFormTemplate
*
* A form template for directing to user voice.
*/
exports.__esModule = true;
var UIStrings = require("./../../../UIStrings/UIStrings");
var FormTemplateType_1 = require("./FormTemplateType");
var Constants = require("./../../../Constants");
var Configuration = require("./../../../Configuration/Configuration");
/**
 * Generate the markup
 * @returns the markup as json
 */
function generate() {
    var initOptions = Configuration.get().getInAppFeedbackInitOptions().userVoice;
    var formSchema = {
        children: [
            {
                classes: [Constants.Classes.FontSubtitle, Constants.Classes.TextAlignLeft,
                    Constants.Classes.FormQuestionMiddleText],
                innerText: UIStrings.getUIStrings().UserVoiceForm.Title
            },
            {
                classes: [Constants.Classes.FontText, Constants.Classes.TextAlignLeft,
                    Constants.Classes.FormMiddleText],
                innerText: UIStrings.getUIStrings().UserVoiceForm.Text
            },
            {
                children: [
                    {
                        children: [
                            {
                                attributes: [
                                    {
                                        name: Constants.AttributeName.Source,
                                        value: initOptions.url
                                    },
                                ],
                                classes: [
                                    Constants.Classes.SubmitButton,
                                    Constants.Classes.FontSubText,
                                ],
                                id: Constants.IDs.UserVoiceFormGoButton,
                                innerText: UIStrings.getUIStrings().UserVoiceForm.Button,
                                tag: Constants.Tags.Button
                            },
                        ],
                        classes: [Constants.Classes.FormSubmitButtonContainer]
                    },
                ],
                classes: [Constants.Classes.FormBottomContainer]
            },
        ],
        classes: [Constants.Classes.Hidden, Constants.Classes.MarginLeft60px],
        id: exports.containerId
    };
    return formSchema;
}
exports.generate = generate;
/**
 * The id for the container. This is the id of the top-most element and should
 * be unique to each form
 */
exports.containerId = Constants.IDs.UserVoiceFormContainer;
/**
 * Forms may be used for different feedback types. This method executes form
 * specific logic when the feedback type is selected
 * @param feedbackType feedback type
 */
function onSelect(feedbackType) {
    document.getElementById(Constants.IDs.UserVoiceFormGoButton).focus();
}
exports.onSelect = onSelect;
/**
 * Form template type
 */
exports.type = FormTemplateType_1.FormTemplateType.UserVoice;
},{"./../../../Configuration/Configuration":42,"./../../../Constants":43,"./../../../UIStrings/UIStrings":65,"./FormTemplateType":69}],72:[function(require,module,exports){
"use strict";
/**
* Layout.ts
*
* Module for the layout
*/
exports.__esModule = true;
var Constants_1 = require("./../../Constants");
var UIStrings = require("./../../UIStrings/UIStrings");
var Utils = require("./../Utils");
var SingleFormTemplate = require("./FormTemplates/SingleFormTemplate");
/**
 * Generates the multi layout as a Renderer.IUIAsJson object
 *
 * The TabFocus.ts has a dependency in the mainContainer. All tabbable elements
 * should be placed inside the mainContainer otherwise TabFocus.ts will not
 * function as expected.
 * @param {[key: number]: IFormTemplate} formTemplates FeedbackType -> FormTemplate mapping
 * @returns {Renderer.IUIAsJson} Renderer.IUIAsJson object
 */
function generateMulti(formTemplates) {
    var schema = {
        attributes: [{ name: Constants_1.AttributeName.DataHtml2CanvasIgnore, value: Constants_1.AttributeValue.True }],
        children: [
            {
                attributes: [
                    { name: Constants_1.AttributeName.Role, value: "dialog" },
                    { name: "aria-modal", value: "true" },
                    { name: "aria-describedby", value: Constants_1.IDs.QuestionLeftText },
                ],
                children: [
                    {
                        // This adds a "first" dummy tabbable div to the mainContainer. It's used as a marker
                        // to handle tabs and shift tabs so focus will stay with elements on just the feedback
                        // dialog. Do not relocate this without updating the TabFocus.ts code.
                        attributes: [{ name: Constants_1.AttributeName.TabIndex, value: Constants_1.AttributeValue.Zero }],
                        id: Constants_1.IDs.FirstTabbable
                    },
                    {
                        children: [
                            {
                                children: [
                                    {
                                        classes: [Constants_1.Classes.FontSubtitle, Constants_1.Classes.TextAlignLeft],
                                        id: Constants_1.IDs.QuestionLeftText,
                                        innerText: UIStrings.getUIStrings().FeedbackSubtitle
                                    },
                                    {
                                        children: [
                                            {
                                                children: generateOverallAnchors(formTemplates),
                                                id: Constants_1.IDs.OverallAnchorsContainer
                                            },
                                        ],
                                        id: Constants_1.IDs.ColumnSeparatorDiv
                                    },
                                    {
                                        children: [
                                            {
                                                attributes: [
                                                    {
                                                        name: Constants_1.AttributeName.HRef,
                                                        value: Constants_1.Urls.PrivacyStatementLink
                                                    },
                                                    {
                                                        name: Constants_1.AttributeName.Target,
                                                        value: Constants_1.AttributeValue.BlankWindow
                                                    },
                                                    {
                                                        name: Constants_1.AttributeName.Rel,
                                                        value: Constants_1.AttributeValue.NoReferrer
                                                    },
                                                ],
                                                classes: [Constants_1.Classes.Link],
                                                id: Constants_1.IDs.PrivacyStatementLink,
                                                innerText: UIStrings.getUIStrings().PrivacyStatement,
                                                tag: Constants_1.Tags.Anchor
                                            },
                                        ],
                                        classes: [Constants_1.Classes.FontSubSubText, Constants_1.Classes.TextAlignLeft, Constants_1.Classes.PrivacyStatementLinkDiv]
                                    },
                                ],
                                classes: [Constants_1.Classes.FormContainer],
                                id: Constants_1.IDs.LeftFormContainer
                            },
                            {
                                children: generateMultiForms(formTemplates),
                                classes: [Constants_1.Classes.FormContainer, Constants_1.Classes.Hidden],
                                id: Constants_1.IDs.MiddleFormContainer
                            },
                        ],
                        classes: [Constants_1.Classes.Hidden],
                        id: Constants_1.IDs.MainContentHolder,
                        tag: Constants_1.Tags.Form
                    },
                    {
                        // This adds a "last" dummy tabbable div to the mainContainer. It's used as a marker
                        // to handle tabs and shift tabs so focus will stay with elements on just the feedback
                        // dialog. Do not relocate this without updating the TabFocus.ts code.
                        attributes: [{ name: Constants_1.AttributeName.TabIndex, value: Constants_1.AttributeValue.Zero }],
                        id: Constants_1.IDs.LastTabbable
                    },
                ],
                id: Constants_1.IDs.MainContainer
            },
        ],
        classes: [Utils.isRightToLeft() ? Constants_1.Classes.Rtl : ""],
        id: Constants_1.IDs.OverlayBackground
    };
    return schema;
}
exports.generateMulti = generateMulti;
/**
 * Generates the single layout as a Renderer.IUIAsJson object
 *
 * The TabFocus.ts has a dependency in the mainContainer. All tabbable elements
 * should be placed inside the mainContainer otherwise TabFocus.ts will not
 * function as expected.
 * @returns {Renderer.IUIAsJson} Renderer.IUIAsJson object
 */
function generateSingle() {
    var schema = {
        attributes: [{ name: Constants_1.AttributeName.DataHtml2CanvasIgnore, value: Constants_1.AttributeValue.True }],
        children: [
            {
                children: [
                    {
                        // This adds a "first" dummy tabbable div to the mainContainer. It's used as a marker
                        // to handle tabs and shift tabs so focus will stay with elements on just the feedback
                        // dialog. Do not relocate this without updating the TabFocus.ts code.
                        attributes: [{ name: Constants_1.AttributeName.TabIndex, value: Constants_1.AttributeValue.Zero }],
                        id: Constants_1.IDs.FirstTabbable
                    },
                    {
                        children: [
                            {
                                children: [SingleFormTemplate.generate()],
                                classes: [Constants_1.Classes.FormContainer],
                                id: Constants_1.IDs.MiddleFormContainer
                            },
                        ],
                        classes: [Constants_1.Classes.Hidden],
                        id: Constants_1.IDs.MainContentHolder,
                        tag: Constants_1.Tags.Form
                    },
                    {
                        // This adds a "last" dummy tabbable div to the mainContainer. It's used as a marker
                        // to handle tabs and shift tabs so focus will stay with elements on just the feedback
                        // dialog. Do not relocate this without updating the TabFocus.ts code.
                        attributes: [{ name: Constants_1.AttributeName.TabIndex, value: Constants_1.AttributeValue.Zero }],
                        id: Constants_1.IDs.LastTabbable
                    },
                ],
                id: Constants_1.IDs.MainContainer
            },
        ],
        classes: [Constants_1.Classes.SingleLayout, Utils.isRightToLeft() ? Constants_1.Classes.Rtl : ""],
        id: Constants_1.IDs.OverlayBackground
    };
    return schema;
}
exports.generateSingle = generateSingle;
/**
 * Generate Renderer.IUIAsJson objects that holds the different forms that will be used on the bellyband.
 * This is used to generate just one form of each one of the templates that are actually going to be used.
 * @param {[key: number]: IFormTemplate} formTemplates FeedbackType -> FormTemplate mapping
 * @returns {Renderer.IUIAsJson} Renderer.IUIAsJson object
 */
function generateMultiForms(formTemplates) {
    var wrapper = {
        children: []
    };
    var pushedContainers = {};
    for (var feedbackType in formTemplates) {
        if (formTemplates.hasOwnProperty(feedbackType)) {
            var notExists = !(formTemplates[feedbackType].containerId in pushedContainers);
            if (notExists) {
                wrapper.children.push(formTemplates[feedbackType].generate());
                pushedContainers[formTemplates[feedbackType].containerId] = true;
            }
        }
    }
    return wrapper.children;
}
/**
 * Generates Renderer.IUIAsJson object that holds the different anchors that will be used on the bellyband.
 * @param {[key: number]: IFormTemplate} formTemplates FeedbackType -> FormTemplate mapping
 * @returns {Renderer.IUIAsJson} Renderer.IUIAsJson object
 */
function generateOverallAnchors(formTemplates) {
    var wrapper = {
        children: []
    };
    if (Constants_1.FeedbackType.Smile in formTemplates) {
        wrapper.children.push(generateOverallAnchor(Constants_1.IDs.OverallSmileAnchor, Constants_1.IDs.OverallSmileImage, 
        // The svg code for the image
        // tslint:disable-next-line:max-line-length
        '<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM36 58.6c-8.5 0-16-4.1-20.9-10.4l3.5-3.6c3.5 4.5 9.9 7.6 17.4 7.6 7.4 0 13.9-3.1 17.4-7.6l3.6 3.6C52.1 54.4 44.4 58.6 36 58.6Z"/></svg>', Constants_1.IDs.OverallSmileText, UIStrings.getUIStrings().SmileForm.Anchor));
    }
    if (Constants_1.FeedbackType.Frown in formTemplates) {
        wrapper.children.push(generateOverallAnchor(Constants_1.IDs.OverallFrownAnchor, Constants_1.IDs.OverallFrownImage, 
        // The svg code for the image
        // tslint:disable-next-line:max-line-length
        '<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM52.8 57.9c-3.3-4.4-9.6-7.3-16.7-7.3 -7.2 0-13.4 3-16.7 7.3l-3.4-3.4c4.7-6.1 11.9-10 20.1-10 8.2 0 15.5 4 20.2 10L52.8 57.9Z"/></svg>', Constants_1.IDs.OverallFrownText, UIStrings.getUIStrings().FrownForm.Anchor));
    }
    if (Constants_1.FeedbackType.Idea in formTemplates) {
        wrapper.children.push(generateOverallAnchor(Constants_1.IDs.OverallIdeaAnchor, Constants_1.IDs.OverallIdeaImage, 
        // The svg code for the image
        // tslint:disable-next-line:max-line-length
        '<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M42.3 62H29.2c-1.1 0-2 0.9-2 2s1.9 2 3 2h11.1c1.1 0 3-0.9 3-2S43.4 62 42.3 62ZM36 1.1C25 1.1 14.8 7 14.8 20.6c0 2.2 0.8 4.4 0.7 4.1 1.2 2.9 2.7 5.6 6.3 10.9 4.2 6.3 4.7 7.6 4.8 11.1v1.3c0 1.3 1 3 2.7 3h13.5c1.7 0 2.8-1.7 2.8-3v-1.5c0.1-3.5 0.1-4.7 4.2-10.9 3.6-5.4 5.7-8.4 6.8-11 0 0 0.6-1.6 0.6-4.1C57.2 6.9 47 1.1 36 1.1ZM31.9 11.9c-3.2 0-5.6 4.2-5.5 6.2 0.2 4-4.4 3.8-4.4 0.6 0-5.3 2.8-10.3 8.5-10.9C34.6 7.3 34.6 11.9 31.9 11.9ZM43.6 55h-15c-1.1 0-2 0.9-2 2v1c0 1.1 0.9 2 2 2h15c1.1 0 2-0.9 2-2v-1C45.6 55.9 44.7 55 43.6 55ZM39.1 68h-6c-0.8 0-1.5 0.7-1.5 1.5s1.2 1.5 2 1.5h5c0.8 0 2-0.7 2-1.5S39.9 68 39.1 68Z"/></svg>', Constants_1.IDs.OverallIdeaText, UIStrings.getUIStrings().IdeaForm.Anchor));
    }
    if (Constants_1.FeedbackType.Bug in formTemplates) {
        wrapper.children.push(generateOverallAnchor(Constants_1.IDs.OverallBugAnchor, Constants_1.IDs.OverallBugImage, 
        // The svg code for the image
        // tslint:disable-next-line:max-line-length
        '<svg viewBox="150 100 1748 1748" width="24px" height="24px" focusable="false"><path d="M1824 1088q0 26-19 45t-45 19h-224q0 171-67 290l208 209q19 19 19 45t-19 45q-18 19-45 19t-45-19l-198-197q-5 5-15 13t-42 28.5-65 36.5-82 29-97 13v-896h-128v896q-51 0-101.5-13.5t-87-33-66-39-43.5-32.5l-15-14-183 207q-20 21-48 21-24 0-43-16-19-18-20.5-44.5t15.5-46.5l202-227q-58-114-58-274h-224q-26 0-45-19t-19-45 19-45 45-19h224v-294l-173-173q-19-19-19-45t19-45 45-19 45 19l173 173h844l173-173q19-19 45-19t45 19 19 45-19 45l-173 173v294h224q26 0 45 19t19 45zm-480-576h-640q0-133 93.5-226.5t226.5-93.5 226.5 93.5 93.5 226.5z"/></svg>', Constants_1.IDs.OverallBugText, UIStrings.getUIStrings().BugForm.Anchor));
    }
    return wrapper.children;
}
/**
 * Generates a Renderer.IUIAsJson object that holds an anchor that will be used on the bellyband.
 * @param overallAnchorID the overall anchor id
 * @param overallImageID the image id
 * @param imageClass the image class (icon)
 * @param overallTextID the id for text box
 * @param uiString the string to display
 */
function generateOverallAnchor(overallAnchorID, overallImageID, svgImage, overallTextID, uiString) {
    return {
        attributes: [
            { name: Constants_1.AttributeName.Type, value: Constants_1.AttributeValue.Button },
        ],
        children: [
            {
                classes: [Constants_1.Classes.OverallImage],
                id: overallImageID,
                innerHTML: svgImage,
                tag: Constants_1.Tags.Div
            },
            {
                classes: [Constants_1.Classes.FontSubtitle, Constants_1.Classes.OverallText],
                id: overallTextID,
                innerText: uiString
            },
        ],
        classes: [Constants_1.Classes.OverallAnchor, Constants_1.Classes.TextAlignLeft],
        id: overallAnchorID,
        tag: Constants_1.Tags.Button
    };
}
},{"./../../Constants":43,"./../../UIStrings/UIStrings":65,"./../Utils":83,"./FormTemplates/SingleFormTemplate":70}],73:[function(require,module,exports){
"use strict";
/**
* TabFocus.ts
*
* Module to handle tab and shift tab focus
*/
exports.__esModule = true;
var Constants_1 = require("./../../Constants");
/**
 * Keeps tabs and shift tabs focus on visible elements of the feedback dialog
 * This prevents tabs and shift tabs cycle focus to elements of the background main page.
 * @param focusedElement The in-focus element object
 */
function cycleTabFocus(focusedElement) {
    var elements = getTabbableElements();
    // when a tab lands on the last dummy tabbable element, set focus to the first
    // visible element which is the one after the first dummy tabbable element
    if (focusedElement.id === Constants_1.IDs.LastTabbable) {
        for (var i = 0; i < elements.length; i++) {
            var element = elements[i];
            if (element.id === Constants_1.IDs.FirstTabbable || !checkVisible(element)) {
                continue;
            }
            element.focus();
            return;
        }
        // when a shift tab lands on the first dummy tabbable element, set focus to the last
        // visible element which is the one before the last dummy tabbable element
    }
    else if (focusedElement.id === Constants_1.IDs.FirstTabbable) {
        for (var i = elements.length - 1; i >= 0; i--) {
            var element = elements[i];
            if (element.id === Constants_1.IDs.LastTabbable || !checkVisible(element)) {
                continue;
            }
            element.focus();
            return;
        }
    }
}
exports.cycleTabFocus = cycleTabFocus;
/**
 * Returns a list of tabbable elements.
 * @returns {NodeListOf<Element>} list of tabbable elements
 */
function getTabbableElements() {
    var tabbableSelector = "a[href], area[href], input:not([disabled]):not([tabindex=\'-1\']), " +
        "button:not([disabled]):not([tabindex=\'-1\']), select:not([disabled]):not([tabindex=\'-1\']), " +
        "textarea:not([disabled]):not([tabindex =\'-1\']), " +
        "object, *[tabindex]:not([tabindex=\'-1\']), *[contenteditable=true]";
    return document.getElementById(Constants_1.IDs.MainContainer).querySelectorAll(tabbableSelector);
}
/**
 * Returns visibility of an element by inspecting the element's parent class name for visible/hidden value.
 * Walk up the parent chain if needed.
 * @param element The element object
 * @returns {Boolean} whether the element is visible
 */
function checkVisible(element) {
    if (!element.parentElement) {
        return false;
    }
    // don't bother if parent element id is just whitespace or empty
    if (/\S/.test(element.parentElement.id)) {
        if (element.parentElement.className.indexOf(Constants_1.Classes.Visible) >= 0) {
            return true;
        }
        if (element.parentElement.className.indexOf(Constants_1.Classes.Hidden) >= 0) {
            return false;
        }
    }
    return checkVisible(element.parentElement);
}
},{"./../../Constants":43}],74:[function(require,module,exports){
"use strict";
/**
* CategoriesDropdown.ts
*
* A module to render the categories dropdown
*/
exports.__esModule = true;
var UIStrings = require("./../UIStrings/UIStrings");
var Constants = require("./../Constants");
/**
 * Generate custom categories drop-down list. The list will contain just the
 * placeholder string if customCategories contains no value.
 * @param customCategories category values
 */
function generate(customCategories) {
    var categories = customCategories ? customCategories : [];
    var result = [{
            attributes: [{ name: "selected", value: "true" }],
            innerText: UIStrings.getUIStrings().Form.CategoryPlaceholder,
            tag: Constants.Tags.Option
        }];
    for (var _i = 0, categories_1 = categories; _i < categories_1.length; _i++) {
        var category = categories_1[_i];
        result.push({
            innerText: category,
            tag: Constants.Tags.Option
        });
    }
    return result;
}
exports.generate = generate;
},{"./../Constants":43,"./../UIStrings/UIStrings":65}],75:[function(require,module,exports){
"use strict";
/**
 * ChoiceGroupControl.ts
 *
 * A module for rendering a choice group.
 */
exports.__esModule = true;
var Constants = require("./../Constants");
function generateRadioGroup(id, question, choices) {
    var fieldSet = {
        children: [
            {
                classes: [Constants.Classes.FontSubText],
                innerText: question,
                tag: Constants.Tags.Legend
            },
        ],
        tag: Constants.Tags.FieldSet
    };
    for (var _i = 0, choices_1 = choices; _i < choices_1.length; _i++) {
        var choice = choices_1[_i];
        Array.prototype.push.apply(fieldSet.children, generateRadioButton(choice[0].toString(), choice[1], id));
    }
    return {
        children: [fieldSet],
        classes: [Constants.Classes.ChoiceGroup],
        id: id
    };
}
exports.generateRadioGroup = generateRadioGroup;
function generateRadioButton(value, label, id) {
    return [
        {
            attributes: [
                { name: Constants.AttributeName.Type, value: Constants.AttributeValue.Radio },
                { name: Constants.AttributeName.Value, value: value },
                { name: Constants.AttributeName.Name, value: id },
            ],
            id: value,
            tag: Constants.Tags.Input
        },
        {
            attributes: [{ name: Constants.AttributeName.For, value: value }],
            children: [
                {
                    children: [{ tag: Constants.Tags.Span }],
                    classes: [Constants.Classes.ChoiceGroupIcon],
                    tag: Constants.Tags.Span
                },
                {
                    classes: ["obf-ChoiceGroupLabel"],
                    innerHTML: label,
                    tag: Constants.Tags.Span
                },
            ],
            classes: [Constants.Classes.FontSubText],
            tag: Constants.Tags.Label
        },
    ];
}
},{"./../Constants":43}],76:[function(require,module,exports){
"use strict";
/**
* RatingControl.ts
*
* A module for a rating control.
*/
exports.__esModule = true;
var Constants = require("./../Constants");
var starId = "obf-star";
var starDefinition = {
    children: [
        {
            attributes: [
                { name: Constants.AttributeName.Id, value: starId },
                { name: Constants.AttributeName.X, value: "0" },
                { name: Constants.AttributeName.Y, value: "0" },
                { name: Constants.AttributeName.Width, value: "105" },
                { name: Constants.AttributeName.Height, value: "100" },
                {
                    name: Constants.AttributeName.Points,
                    value: "52.5, 80.3 84, 100 76.3, 63 105, 38 67.2, 35 52.5, 0 37.8, 35 0, 38 28.7, 63 20, 100 52.5, 80.3"
                },
            ],
            id: starId,
            tag: Constants.Tags.Polygon
        },
    ],
    tag: Constants.Tags.Defs
};
var firstStar = {
    attributes: [{ name: Constants.AttributeName.xlinkHref, value: "#" + starId }],
    tag: Constants.Tags.Use
};
var secondStar = {
    attributes: [
        { name: Constants.AttributeName.xlinkHref, value: "#" + starId },
        { name: Constants.AttributeName.Transform, value: "translate(105 0)" },
    ],
    tag: Constants.Tags.Use
};
var thirdStar = {
    attributes: [
        { name: Constants.AttributeName.xlinkHref, value: "#" + starId },
        { name: Constants.AttributeName.Transform, value: "translate(210 0)" },
    ],
    tag: Constants.Tags.Use
};
var fourthStar = {
    attributes: [
        { name: Constants.AttributeName.xlinkHref, value: "#" + starId },
        { name: Constants.AttributeName.Transform, value: "translate(315 0)" },
    ],
    tag: Constants.Tags.Use
};
var fifthStar = {
    attributes: [
        { name: Constants.AttributeName.xlinkHref, value: "#" + starId },
        { name: Constants.AttributeName.Transform, value: "translate(420 0)" },
    ],
    tag: Constants.Tags.Use
};
var emptyStars = {
    attributes: [{ name: Constants.AttributeName.ViewBox, value: "0 0 525 100" }],
    children: [starDefinition, firstStar, secondStar, thirdStar, fourthStar, fifthStar],
    classes: [Constants.Classes.RatingGraphic],
    tag: Constants.Tags.Svg
};
var oneFilledStar = {
    attributes: [{ name: Constants.AttributeName.ViewBox, value: "0 0 105 100" }],
    children: [starDefinition, firstStar],
    classes: [Constants.Classes.RatingGraphic, Constants.Classes.RatingGraphicFilled],
    tag: Constants.Tags.Svg
};
var twoFilledStar = {
    attributes: [{ name: Constants.AttributeName.ViewBox, value: "0 0 210 100" }],
    children: [starDefinition, firstStar, secondStar],
    classes: [Constants.Classes.RatingGraphic, Constants.Classes.RatingGraphicFilled],
    tag: Constants.Tags.Svg
};
var threeFilledStar = {
    attributes: [{ name: Constants.AttributeName.ViewBox, value: "0 0 315 100" }],
    children: [starDefinition, firstStar, secondStar, thirdStar],
    classes: [Constants.Classes.RatingGraphic, Constants.Classes.RatingGraphicFilled],
    tag: Constants.Tags.Svg
};
var fourFilledStar = {
    attributes: [{ name: Constants.AttributeName.ViewBox, value: "0 0 420 100" }],
    children: [starDefinition, firstStar, secondStar, thirdStar, fourthStar],
    classes: [Constants.Classes.RatingGraphic, Constants.Classes.RatingGraphicFilled],
    tag: Constants.Tags.Svg
};
var fiveFilledStar = {
    attributes: [{ name: Constants.AttributeName.ViewBox, value: "0 0 525 100" }],
    children: [starDefinition, firstStar, secondStar, thirdStar, fourthStar, fifthStar],
    classes: [Constants.Classes.RatingGraphic, Constants.Classes.RatingGraphicFilled],
    tag: Constants.Tags.Svg
};
function generate(id) {
    return {
        children: [
            emptyStars,
            {
                attributes: [
                    { name: Constants.AttributeName.Type, value: "radio" },
                    { name: Constants.AttributeName.Name, value: id },
                    { name: Constants.AttributeName.Value, value: "1" },
                ],
                tag: Constants.Tags.Input
            },
            oneFilledStar,
            {
                attributes: [
                    { name: Constants.AttributeName.Type, value: "radio" },
                    { name: Constants.AttributeName.Name, value: id },
                    { name: Constants.AttributeName.Value, value: "2" },
                ],
                tag: Constants.Tags.Input
            },
            twoFilledStar,
            {
                attributes: [
                    { name: Constants.AttributeName.Type, value: "radio" },
                    { name: Constants.AttributeName.Name, value: id },
                    { name: Constants.AttributeName.Value, value: "3" },
                ],
                tag: Constants.Tags.Input
            },
            threeFilledStar,
            {
                attributes: [
                    { name: Constants.AttributeName.Type, value: "radio" },
                    { name: Constants.AttributeName.Name, value: id },
                    { name: Constants.AttributeName.Value, value: "4" },
                ],
                tag: Constants.Tags.Input
            },
            fourFilledStar,
            {
                attributes: [
                    { name: Constants.AttributeName.Type, value: "radio" },
                    { name: Constants.AttributeName.Name, value: id },
                    { name: Constants.AttributeName.Value, value: "5" },
                ],
                tag: Constants.Tags.Input
            },
            fiveFilledStar,
        ],
        classes: [Constants.Classes.Rating],
        id: id,
        tag: Constants.Tags.Span
    };
}
exports.generate = generate;
},{"./../Constants":43}],77:[function(require,module,exports){
"use strict";
/**
* Renderer.ts
*
* Module for rendering the markup
*/
exports.__esModule = true;
var Constants = require("./../Constants");
/**
 * Create DOM elements from Json structure
 * @param {UiAsJson} schema The Json structure
 * @param {boolean} svg Create svg element instead of html?
 * @return {HTMLElement} HTML elements with tree structure
 */
function elementFromJson(schema, svg) {
    if (typeof schema.brs === "undefined") {
        schema.brs = true;
    }
    if (!schema.brs) {
        return null;
    }
    if (!schema.tag) {
        schema.tag = Constants.Tags.Div;
    }
    var element;
    if (schema.tag === Constants.Tags.Svg) {
        svg = true;
    }
    if (svg) {
        element = document.createElementNS("http://www.w3.org/2000/svg", schema.tag);
    }
    else {
        element = document.createElement(schema.tag);
    }
    if (schema.attributes) {
        var attribute = void 0;
        for (var i = 0; i < schema.attributes.length; i++) {
            attribute = schema.attributes[i];
            if (attribute.name === Constants.AttributeName.xlinkHref) {
                element.setAttributeNS("http://www.w3.org/1999/xlink", Constants.AttributeName.HRef, attribute.value);
            }
            else {
                element.setAttribute(attribute.name, attribute.value);
            }
        }
    }
    if (schema.id) {
        element.id = schema.id;
    }
    if (schema.classes) {
        var concatClasses = schema.classes.join(" ");
        if (svg) {
            element.setAttribute(Constants.AttributeName.Class, concatClasses);
        }
        else {
            element.className = concatClasses;
        }
    }
    if (schema.innerText && !svg) {
        element.textContent = schema.innerText;
    }
    if (schema.innerHTML && !svg) {
        element.innerHTML = schema.innerHTML;
    }
    if (schema.children) {
        for (var i = 0; i < schema.children.length; i++) {
            // Sometimes IE mis-reports length
            var cur = schema.children[i];
            if (cur) {
                var child = elementFromJson(cur, svg);
                if (child) {
                    element.appendChild(child);
                }
            }
        }
    }
    return element;
}
exports.elementFromJson = elementFromJson;
},{"./../Constants":43}],78:[function(require,module,exports){
"use strict";
/**
* Spinner.ts
*
* A module for a spinner.
*/
exports.__esModule = true;
var Constants = require("./../Constants");
var Utils = require("./Utils");
var animationSpeed = 90;
var numCircles = 8;
var offsetSize = 0.2;
var parentSize = 34;
var fadeIncrement = 1 / numCircles;
var Spinner = (function () {
    /**
     * Constructor
     * @param id id of the element to attach the spinner to
     */
    function Spinner(id) {
        this.circleObjects = [];
        this.spinnerId = id;
        this.spinner = document.getElementById(this.spinnerId);
        this.createCirclesAndArrange();
        this.initializeOpacities();
        this.start();
        Utils.setElementVisibility(id, true);
    }
    /**
     * Destroys the spinner
     */
    Spinner.prototype.destroy = function () {
        Utils.setElementVisibility(this.spinnerId, false);
        this.stop();
    };
    /**
     * Starts the animation
     */
    Spinner.prototype.start = function () {
        var _this = this;
        this.stop();
        this.interval = setInterval(function () {
            var i = _this.circleObjects.length;
            while (i--) {
                fade(_this.circleObjects[i]);
            }
        }, animationSpeed);
    };
    /**
     * Stops the animation
     */
    Spinner.prototype.stop = function () {
        clearInterval(this.interval);
    };
    Spinner.prototype.createCirclesAndArrange = function () {
        var angle = 0;
        var offset = parentSize * offsetSize;
        var step = (2 * Math.PI) / numCircles;
        var i = numCircles;
        var circleObject;
        var radius = (parentSize - offset) * 0.5;
        while (i--) {
            var circle = createCircle();
            var x = Math.round(parentSize * 0.5 + radius * Math.cos(angle) - circle.clientWidth * 0.5) - offset * 0.5;
            var y = Math.round(parentSize * 0.5 + radius * Math.sin(angle) - circle.clientHeight * 0.5) - offset * 0.5;
            this.spinner.appendChild(circle);
            circle.style.left = x + "px";
            circle.style.top = y + "px";
            angle += step;
            circleObject = { element: circle, j: i };
            this.circleObjects.push(circleObject);
        }
    };
    Spinner.prototype.initializeOpacities = function () {
        var i = 0;
        var j = 1;
        var opacity;
        for (i; i < numCircles; i++) {
            var circleObject = this.circleObjects[i];
            opacity = (fadeIncrement * j++);
            setOpacity(circleObject.element, opacity);
        }
    };
    return Spinner;
}());
exports.Spinner = Spinner;
function fade(circleObject) {
    var opacity = getOpacity(circleObject.element) - fadeIncrement;
    if (opacity <= 0) {
        opacity = 1;
    }
    setOpacity(circleObject.element, opacity);
}
function getOpacity(element) {
    return parseFloat(window.getComputedStyle(element).getPropertyValue("opacity"));
}
function setOpacity(element, opacity) {
    element.style.opacity = opacity.toString();
}
function createCircle() {
    var circle = document.createElement("div");
    circle.classList.add(Constants.Classes.SpinnerCircle);
    circle.style.width = circle.style.height = parentSize * offsetSize + "px";
    return circle;
}
},{"./../Constants":43,"./Utils":83}],79:[function(require,module,exports){
"use strict";
/**
 * Events.ts
 *
 * A module for all Event handling.
 */
exports.__esModule = true;
var Transport_1 = require("./../../Transport/Transport");
var Constants_1 = require("./../../Constants");
var UiUtils = require("./../Utils");
var SpinnerControl_1 = require("./../SpinnerControl");
var Logging = require("./../../Logging/Logging");
var Configuration = require("./../../Configuration/Configuration");
var Api = require("@ms-ofb/officefloodgatecore/dist/src/Api/Api");
/**
 * Callback for when the feedback dialog is dismissed
 */
var onDismiss;
/**
 * Is the prompt up
 */
var isPromptUp;
/**
 * Dismiss all, including networking, UI, and events
 * @param submitted Was the control submitted (true), or cancelled (false)?
 */
function dismissAll(submitted) {
    unregister();
    onDismiss(submitted);
}
/**
 * Listener un-registration
 */
function unregister() {
    removeListeners();
}
/**
 * List of listeners and the ids they are attached to. This ensures all events are correctly unregistered.
 */
var listenersList = [];
function addListener(id, event, listener) {
    UiUtils.registerListener(id, event, listener);
    listenersList.push({ event: event, id: id, listener: listener });
}
function removeListeners() {
    for (var _i = 0, listenersList_1 = listenersList; _i < listenersList_1.length; _i++) {
        var listener = listenersList_1[_i];
        UiUtils.unregisterListener(listener.id, listener.event, listener.listener);
    }
    listenersList = [];
}
/**
 * Register events for toast
 */
function register(ON_DISMISS) {
    if (ON_DISMISS === void 0) { ON_DISMISS = function (submitted) { return; }; }
    onDismiss = ON_DISMISS;
    isPromptUp = true;
    addListener(Constants_1.IDs.ToastContainer, "keyup", toastKeyEventHandler);
    addListener(Constants_1.IDs.ToastCancel, "click", toastCancelHandler);
    addListener(Constants_1.IDs.TPromptContainer, "click", promptContainerHandler);
    addListener(Constants_1.IDs.TFormSubmitButton, "click", submitButtonHandler);
    addListener(Constants_1.IDs.TFormEmailCheckBox, "click", emailCheckBoxHandler);
    emailCheckBoxHandler(null); // call the checkbox handler to process the initial state
    var ratingElements = document.querySelectorAll("input[name=\"" + Constants_1.IDs.TFormRating + "\"]");
    for (var i = 0; i < ratingElements.length; ++i) {
        UiUtils.registerListenerToElement(ratingElements[i], "click", ratingInputHandler);
    }
    if (!Configuration.get().getFloodgateSurvey().showPrompt) {
        showSurveyScreen();
    }
    else {
        Logging.getLogger().logEvent(Logging.EventIds.Survey.UI.Prompt.Shown.VALUE, {
            CampaignId: Configuration.get().getFloodgateSurvey().getCampaignId(),
            SurveyId: Configuration.get().getFloodgateSurvey().getId(),
            SurveyType: Configuration.get().getFloodgateSurvey().getSurveyType()
        });
    }
    // Auto dismiss if needed
    var autoDimiss = Configuration.get().getFloodgateInitOptions().autoDismiss;
    if (autoDimiss !== Constants_1.AutoDismissValues.NoAutoDismiss) {
        var autoDimissDuration = void 0;
        switch (autoDimiss) {
            case (Constants_1.AutoDismissValues.SevenSeconds):
                autoDimissDuration = 7000;
                break;
            case (Constants_1.AutoDismissValues.FourteenSeconds):
                autoDimissDuration = 14000;
                break;
            case (Constants_1.AutoDismissValues.TwentyOneSeconds):
                autoDimissDuration = 21000;
                break;
            case (Constants_1.AutoDismissValues.TwentyEightSeconds):
                autoDimissDuration = 28000;
                break;
            default:
        }
        if (autoDimissDuration !== undefined) {
            setTimeout(function () {
                if (isPromptUp) {
                    dismissAll(false);
                }
            }, autoDimissDuration);
        }
    }
}
exports.register = register;
function emailCheckBoxHandler(event) {
    // show email if checked and show default string if unchecked
    var emailCheckBox = document.getElementById(Constants_1.IDs.TFormEmailCheckBox);
    if (emailCheckBox) {
        var emailTextBox = document.getElementById(Constants_1.IDs.TFormEmailTextBox);
        emailTextBox.value = emailCheckBox.checked ? Configuration.get().getCommonInitOptions().userEmail : null;
        emailTextBox.disabled = !emailCheckBox.checked;
    }
}
function toastKeyEventHandler(event) {
    // dismiss upon pressing the escape key
    if (event.keyCode === Constants_1.Keys.Esc) {
        event.preventDefault();
        event.stopPropagation();
        dismissAll(false);
    }
}
function toastCancelHandler(event) {
    event.preventDefault();
    event.stopPropagation();
    dismissAll(false);
}
function promptContainerHandler(event) {
    event.preventDefault();
    event.stopPropagation();
    showSurveyScreen();
}
function showSurveyScreen() {
    isPromptUp = false;
    UiUtils.setElementVisibility(Constants_1.IDs.TPromptContainer, false);
    UiUtils.setElementVisibility(Constants_1.IDs.TFormContainer, true);
    Logging.getLogger().logEvent(Logging.EventIds.Survey.UI.Form.Shown.VALUE, {
        CampaignId: Configuration.get().getFloodgateSurvey().getCampaignId(),
        SurveyId: Configuration.get().getFloodgateSurvey().getId(),
        SurveyType: Configuration.get().getFloodgateSurvey().getSurveyType()
    });
}
function ratingInputHandler(event) {
    document.getElementById(Constants_1.IDs.TFormSubmitButton).disabled = false;
}
function submitButtonHandler(event) {
    event.preventDefault();
    event.stopPropagation();
    UiUtils.setElementVisibility(Constants_1.IDs.TFormSubmitButton, false);
    var spinner = new SpinnerControl_1.Spinner(Constants_1.IDs.TFormSubmitButtonSpinner);
    var transporter = new Transport_1.Transporter(Configuration.get().getCommonInitOptions().environment, Api.ISurvey.Type[Configuration.get().getFloodgateSurvey().getSurveyType()], Configuration.get().getCommonInitOptions().appId, "Survey", Configuration.get().getCommonInitOptions().applicationGroup, Configuration.get().getCommonInitOptions().telemetryGroup, Configuration.get().getCommonInitOptions().webGroup);
    var commentElement = document.getElementById(Constants_1.IDs.TFormComment);
    var commentEntered = (commentElement && !!commentElement.value);
    var selectedRating = document.querySelector("input[name=\"" + Constants_1.IDs.TFormRating + "\"]:checked");
    Configuration.get().getFloodgateSurvey().setValues(Number(selectedRating.value), commentEntered ? commentElement.value : "");
    // Add survey-specific data to manifest
    transporter.setManifestValues(Configuration.get().getFloodgateSurvey().getJsonElements());
    // Send email address if user gives consent
    var emailCheckBox = document.getElementById(Constants_1.IDs.TFormEmailCheckBox);
    var emailTextBox = document.getElementById(Constants_1.IDs.TFormEmailTextBox);
    if (emailCheckBox && emailCheckBox.checked && emailTextBox.value !== "") {
        transporter.setEmail(emailTextBox.value);
    }
    transporter.submit();
    spinner.destroy();
    dismissAll(true);
    Logging.getLogger().logEvent(Logging.EventIds.Survey.UI.Form.Submit.VALUE, {
        CampaignId: Configuration.get().getFloodgateSurvey().getCampaignId(),
        SurveyId: Configuration.get().getFloodgateSurvey().getId(),
        SurveyType: Configuration.get().getFloodgateSurvey().getSurveyType()
    });
}
},{"./../../Configuration/Configuration":42,"./../../Constants":43,"./../../Logging/Logging":54,"./../../Transport/Transport":64,"./../SpinnerControl":78,"./../Utils":83,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":5}],80:[function(require,module,exports){
"use strict";
/**
 * Layout.ts
 *
 * Module for the layout
 */
exports.__esModule = true;
var ChoiceGroupControl = require("./../ChoiceGroupControl");
var Configuration = require("./../../Configuration/Configuration");
var Constants_1 = require("./../../Constants");
var UIStrings = require("./../../UIStrings/UIStrings");
var Utils = require("./../Utils");
var Constants = require("./../../Constants");
/**
 * Generates the toast
 *
 * @returns {Renderer.IUIAsJson} Renderer.IUIAsJson object
 */
function generate() {
    var schema = {
        attributes: [
            { name: Constants_1.AttributeName.DataHtml2CanvasIgnore, value: Constants_1.AttributeValue.True },
            { name: Constants_1.AttributeName.Role, value: "dialog" },
            { name: "aria-labelledby", value: Constants_1.IDs.TPromptTitle },
            { name: "aria-describedby", value: Constants_1.IDs.TPromptText },
        ],
        children: [
            {
                attributes: [
                    { name: Constants_1.AttributeName.Type, value: Constants_1.AttributeValue.Button },
                    { name: Constants_1.AttributeName.AriaLabel, value: UIStrings.getUIStrings().CloseLabel },
                ],
                id: Constants_1.IDs.ToastCancel,
                // tslint:disable-next-line:max-line-length
                innerHTML: '<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z" fill="#000"/></svg>',
                tag: Constants_1.Tags.Button
            },
            generatePrompt(),
            generateForm(),
        ],
        classes: [Constants_1.Classes.Toast, Utils.isRightToLeft() ? Constants_1.Classes.Rtl : ""],
        id: Constants_1.IDs.ToastContainer
    };
    return schema;
}
exports.generate = generate;
function generatePrompt() {
    var promptSchema = {
        attributes: [{ name: "aria-labelledby", value: Constants_1.IDs.TPromptTitle }],
        children: [
            {
                classes: [
                    Constants_1.Classes.FontText,
                    Constants_1.Classes.TextAlignLeft,
                ],
                id: Constants_1.IDs.TPromptTitle,
                innerText: Configuration.get().getFloodgateSurvey().getTitle()
            },
            {
                classes: [
                    Constants_1.Classes.FontSubText,
                    Constants_1.Classes.TextAlignLeft,
                ],
                id: Constants_1.IDs.TPromptText,
                innerText: Configuration.get().getFloodgateSurvey().getPromptQuestion()
            },
        ],
        id: Constants_1.IDs.TPromptContainer,
        tag: Constants_1.Tags.Button
    };
    return promptSchema;
}
function userEmailConsentDefault() {
    var userEmailConsentDefault = Configuration.get().getCommonInitOptions().userEmailConsentDefault;
    return userEmailConsentDefault ? Constants.AttributeValue.Checked : Constants.AttributeValue.Unchecked;
}
function generateForm() {
    var formSchema = {
        children: [
            {
                classes: [
                    Constants_1.Classes.FontText,
                    Constants_1.Classes.TextAlignLeft,
                ],
                id: Constants_1.IDs.TFormTitle,
                innerText: Configuration.get().getFloodgateSurvey().getTitle()
            },
            generateRatingControl(),
            {
                attributes: [
                    {
                        name: Constants_1.AttributeName.Placeholder,
                        value: Configuration.get().getFloodgateSurvey().getCommentQuestion()
                    },
                    {
                        name: Constants_1.AttributeName.AriaLabel,
                        value: Configuration.get().getFloodgateSurvey().getCommentQuestion()
                    },
                    {
                        name: Constants_1.AttributeName.MaxLength,
                        value: Constants_1.AttributeValue.TextAreaMaxLength
                    },
                ],
                classes: [Constants_1.Classes.FontSubText, Constants_1.Classes.TextInput],
                id: Constants_1.IDs.TFormComment,
                tag: Constants_1.Tags.TextArea
            },
            {
                brs: Configuration.get().getFloodgateSurvey().showEmailRequest,
                children: [
                    {
                        attributes: [
                            {
                                name: Constants.AttributeName.Type,
                                value: Constants.AttributeValue.Checkbox
                            },
                            {
                                name: userEmailConsentDefault(),
                                value: ""
                            },
                        ],
                        classes: [Constants.Classes.TFormEmailCheckbox, Constants.Classes.CheckBox],
                        id: Constants.IDs.TFormEmailCheckBox,
                        tag: Constants.Tags.Input
                    },
                    {
                        attributes: [{ name: Constants.AttributeName.For, value: Constants.IDs.TFormEmailCheckBox }],
                        classes: [Constants.Classes.FontSubText, Constants.Classes.TextAlignLeft, Constants.Classes.TFormEmailLabel],
                        innerText: UIStrings.getUIStrings().Form.EmailCheckBoxLabel,
                        tag: Constants.Tags.Label
                    },
                    {
                        attributes: [
                            {
                                name: Constants.AttributeName.Type,
                                value: Constants.AttributeValue.Text
                            },
                            {
                                name: Constants.AttributeName.Placeholder,
                                value: UIStrings.getUIStrings().Form.EmailPlaceholder
                            },
                            {
                                name: Constants.AttributeName.AriaLabel,
                                value: UIStrings.getUIStrings().Form.EmailPlaceholder
                            },
                            {
                                name: Constants.AttributeName.Name,
                                value: Constants.IDs.BasicFormEmailInput
                            },
                            {
                                name: Constants.AttributeName.MaxLength,
                                value: Constants.AttributeValue.TextAreaMaxLength
                            },
                            {
                                name: Constants.AttributeName.Value,
                                value: Configuration.get().getCommonInitOptions().userEmailConsentDefault
                                    ? Configuration.get().getCommonInitOptions().userEmail
                                    : ""
                            },
                        ],
                        classes: [Constants.Classes.FontSubText, Constants.Classes.FormEmailInput, Constants.Classes.TextInput],
                        id: Constants.IDs.TFormEmailTextBox,
                        tag: Constants.Tags.Input
                    },
                ]
            },
            {
                children: [
                    {
                        attributes: [
                            {
                                name: Constants_1.AttributeName.HRef,
                                value: Constants_1.Urls.PrivacyStatementLink
                            },
                            {
                                name: Constants_1.AttributeName.Target,
                                value: Constants_1.AttributeValue.BlankWindow
                            },
                            {
                                name: Constants_1.AttributeName.Rel,
                                value: Constants_1.AttributeValue.NoReferrer
                            },
                        ],
                        classes: [Constants_1.Classes.Link],
                        innerText: UIStrings.getUIStrings().PrivacyStatement,
                        tag: Constants_1.Tags.Anchor
                    },
                ],
                classes: [Constants_1.Classes.FontSubSubText, Constants_1.Classes.TextAlignLeft, Constants_1.Classes.PrivacyStatementLinkDiv]
            },
            {
                children: [
                    {
                        attributes: [{ name: Constants_1.AttributeName.Disabled, value: Constants_1.AttributeValue.True }],
                        classes: [
                            Constants_1.Classes.FontSubText,
                            Constants_1.Classes.SubmitButton,
                        ],
                        id: Constants_1.IDs.TFormSubmitButton,
                        innerText: UIStrings.getUIStrings().Form.Submit,
                        tag: Constants_1.Tags.Button
                    },
                    {
                        classes: [Constants_1.Classes.Spinner, Constants_1.Classes.Hidden],
                        id: Constants_1.IDs.TFormSubmitButtonSpinner,
                        tag: Constants_1.Tags.Div
                    },
                ],
                id: Constants_1.IDs.TFormSubmitButtonContainer
            },
        ],
        classes: [Constants_1.Classes.Hidden],
        id: Constants_1.IDs.TFormContainer
    };
    return formSchema;
}
function generateRatingControl() {
    var choices = [];
    var ratingValues = Configuration.get().getFloodgateSurvey().getRatingValuesAscending();
    var index = 0;
    for (var _i = 0, ratingValues_1 = ratingValues; _i < ratingValues_1.length; _i++) {
        var ratingValue = ratingValues_1[_i];
        choices.push([index, ratingValue]);
        index++;
    }
    // Ratings need to be shown in descending order
    return ChoiceGroupControl.generateRadioGroup(Constants_1.IDs.TFormRating, Configuration.get().getFloodgateSurvey().getRatingQuestion(), choices.reverse());
}
},{"./../../Configuration/Configuration":42,"./../../Constants":43,"./../../UIStrings/UIStrings":65,"./../ChoiceGroupControl":75,"./../Utils":83}],81:[function(require,module,exports){
"use strict";
/**
 * Toast.ts
 *
 * Module for the Toast UI
 */
exports.__esModule = true;
var Constants_1 = require("./../../Constants");
var Events = require("./Events");
var Layout = require("./Layout");
var Renderer = require("./../Renderer");
var Utils = require("./../Utils");
var Configuration = require("./../../Configuration/Configuration");
/**
 * UI initialization for toast
 */
function createSurvey(onClose) {
    create(Renderer.elementFromJson(Layout.generate()));
    Events.register(function (submitted) {
        Utils.setElementVisibility(Constants_1.IDs.ToastContainer, false);
        Utils.deleteElementById(Constants_1.IDs.ToastContainer);
        Configuration.get().getFloodgateInitOptions().onDismiss(Configuration.get().getFloodgateSurvey().getCampaignId(), submitted);
        onClose();
    });
}
exports.createSurvey = createSurvey;
function create(userInterface) {
    document.body.insertBefore(userInterface, document.body.firstChild);
    Utils.setElementVisibility(Constants_1.IDs.ToastContainer, true);
}
},{"./../../Configuration/Configuration":42,"./../../Constants":43,"./../Renderer":77,"./../Utils":83,"./Events":79,"./Layout":80}],82:[function(require,module,exports){
"use strict";
/**
* UI.ts
*
* Module for the UI
*/
exports.__esModule = true;
var BellyBand_1 = require("./BellyBand/BellyBand");
exports.createBellyBandMulti = BellyBand_1.createMulti;
var BellyBand_2 = require("./BellyBand/BellyBand");
exports.createBellyBandSingle = BellyBand_2.createSingle;
var Toast_1 = require("./Toast/Toast");
exports.createSurvey = Toast_1.createSurvey;
},{"./BellyBand/BellyBand":66,"./Toast/Toast":81}],83:[function(require,module,exports){
"use strict";
/**
* Utils.ts
*
* Module for utility functions
*/
exports.__esModule = true;
var Constants = require("./../Constants");
/**
 * Set HTML element visibility
 * @param {string} id The Id of the HTML element
 * @param {any} vis The visibility to be set (true or false)
 * @return {void}
 */
function setElementVisibility(id, vis) {
    var oldClassName = vis ? Constants.Classes.Hidden : Constants.Classes.Visible;
    var newClassName = vis ? Constants.Classes.Visible : Constants.Classes.Hidden;
    replaceClassesById(id, oldClassName, newClassName);
}
exports.setElementVisibility = setElementVisibility;
/**
 * Delete HTML element by Id
 * @param {string} id The Id of the HTML element
 * @return {void}
 */
function deleteElementById(id) {
    var element = document.getElementById(id);
    if (element != null && element.parentNode != null) {
        element.parentNode.removeChild(element);
    }
}
exports.deleteElementById = deleteElementById;
/**
 * Add a CSS class to an HTML element by Id
 * @param {string} id The Id of the HTML element
 * @param {string} newClassName The name of CSS class to be added
 * @return {void}
 */
function addClassById(id, newClass) {
    var element = document.getElementById(id);
    if (!element) {
        return;
    }
    // check is the class already exists, if not add it
    if (!element.className.match(new RegExp("\\b" + newClass + "\\b"))) {
        // we use className instead of classList to support IE9
        element.className = element.className + " " + newClass;
    }
}
exports.addClassById = addClassById;
/**
 * Delete a CSS class of an HTML element by Id
 * @param {string} id The Id of the HTML element
 * @param {string} oldClassName The name of CSS class to be deleted
 * @return {void}
 */
function deleteClassById(id, oldClass) {
    var element = document.getElementById(id);
    if (!element) {
        return;
    }
    // we use className instead of classList to support IE9
    // get rid of any occurrences of the class we don"t want
    element.className = element.className.split(new RegExp("\\b" + oldClass + "\\b", "i")).join(" ");
    // get rid of extra whitespaces
    element.className = element.className.split(/\s+/).join(" ");
}
exports.deleteClassById = deleteClassById;
/**
 * Delete an CSS class and (or) add an CSS class to an HTML element by Id
 * @param {string} id The Id of the HTML element
 * @param {string} oldClassName The name of CSS class to be deleted
 * @param {string} newClassName The name of CSS class to be added
 * @return {void}
 */
function replaceClassesById(id, oldClassName, newClassName) {
    deleteClassById(id, oldClassName);
    addClassById(id, newClassName);
}
exports.replaceClassesById = replaceClassesById;
/**
 * Set attribute on an HTML element
 * @param {string} id The Id of the HTML element
 * @param {string} attriName The attribute name
 * @param {string} attriValue The attribute value
 * @return {void}
 */
function setAttributeOnHtmlElement(id, attriName, attriValue) {
    var htmlElement = document.getElementById(id);
    if (htmlElement) {
        htmlElement.setAttribute(attriName, attriValue);
    }
}
exports.setAttributeOnHtmlElement = setAttributeOnHtmlElement;
/**
 * Add event listener helper function (wrapper) that deals with IE 8 compatability
 * @param object The object to add event listener to
 * @param type The event type
 * @param listener The listener function
 */
function addEventListenerHelper(object, type, listener) {
    if (object.addEventListener) {
        object.addEventListener(type, listener, false);
    }
    else if (object.attachEvent) {
        object.attachEvent("on" + type, listener);
    }
}
exports.addEventListenerHelper = addEventListenerHelper;
/**
 * Remove event listener helper function (wrapper) that deals with IE 8 compatability
 * @param object The object to remove event listener from
 * @param type The event type
 * @param listener The listener function
 */
function removeEventListenerHelper(object, type, listener) {
    if (object.removeEventListener) {
        object.removeEventListener(type, listener, false);
    }
    else if (object.detachEvent) {
        object.detachEvent("on" + type, listener);
    }
}
exports.removeEventListenerHelper = removeEventListenerHelper;
/**
 * Register event listener
 * @param id The Id of the HTML element
 * @param type The event type
 * @param listener The listener function
 */
function registerListener(id, type, listener) {
    var element = document.getElementById(id);
    if (element) {
        addEventListenerHelper(element, type, listener);
    }
}
exports.registerListener = registerListener;
/**
 * Register event listener
 * @param element The HTML element
 * @param type The event type
 * @param listener The listener function
 */
function registerListenerToElement(element, type, listener) {
    if (element) {
        addEventListenerHelper(element, type, listener);
    }
}
exports.registerListenerToElement = registerListenerToElement;
/**
 * Un-register event listener
 * @param id The Id of the HTML element
 * @param type The event type
 * @param listener The listener function
 */
function unregisterListener(id, type, listener) {
    var element = document.getElementById(id);
    if (element) {
        removeEventListenerHelper(element, type, listener);
    }
}
exports.unregisterListener = unregisterListener;
/**
 * Returns the version of Internet Explorer or -1 for non-IE browser
 * @return {number} The IE version
 */
function getInternetExplorerVersion() {
    var rv = -1;
    var ua = window.navigator.userAgent;
    // since IE 11, 'MSIE' is not a keyword in its user agent string anymore
    // determine whether the browser is IE or not, and the version of IE based on Trident keyword and its version
    if (ua.indexOf("Trident") > -1) {
        var re = new RegExp("Trident/([0-9]{1,}[\.0-9]{0,})");
        if (re.exec(ua) != null) {
            rv = parseFloat(RegExp.$1);
            rv += 4; // trident version + 4 is the IE version
        }
    }
    return rv;
}
exports.getInternetExplorerVersion = getInternetExplorerVersion;
/**
 * Check if the current text direction is right to left
 */
function isRightToLeft() {
    return getComputedStyle(document.documentElement).direction === "rtl";
}
exports.isRightToLeft = isRightToLeft;
},{"./../Constants":43}],84:[function(require,module,exports){
"use strict";
/*
* Utils.ts
*
* Module for utility functions
*/
exports.__esModule = true;
/**
 * Check if given value is a number
 * @param {any} value value
 */
function isNumber(value) {
    return (typeof value === "number");
}
/**
 * Check if given value is an integer
 * @param {any} value value
 */
function isInteger(value) {
    return typeof value === "number" &&
        isFinite(value) &&
        Math.floor(value) === value;
}
exports.isInteger = isInteger;
/**
 * Check if given value is a string
 * @param {any} value value
 */
function isString(value) {
    return (typeof value === "string");
}
/**
 * Check if value is an object
 * @param {any} value value
 */
function isObject(value) {
    return (!isNullorUndefined(value) && typeof (value) === "object");
}
/**
 * Check if value is an object
 * @param {any} value value
 */
function isBoolean(value) {
    return typeof (value) === "boolean";
}
exports.isBoolean = isBoolean;
/**
 * Check if value is "null" or "undefined"
 * @param {any} value value
 */
function isNullorUndefined(value) {
    return (value == null);
}
/**
 * Check if value is a valid guid
 * @param {any} value value
 */
function isGuid(value) {
    return (isString(value) &&
        /^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(value));
}
/**
 * Throw if not object
 */
function expectObject(value, name) {
    if (!isObject(value)) {
        throw name + " is not an object: " + value;
    }
}
exports.expectObject = expectObject;
/**
 * Throw if not number
 */
function expectNumber(value, name) {
    if (!isNumber(value)) {
        throw name + " is not a number: " + value;
    }
}
exports.expectNumber = expectNumber;
/**
 * Throw if not string
 */
function expectString(value, name) {
    if (!isString(value)) {
        throw name + " is not a string: " + value;
    }
}
exports.expectString = expectString;
/**
 * Throw if not boolean
 */
function expectBoolean(value, name) {
    if (!isBoolean(value)) {
        throw name + " is not a boolean: " + value;
    }
}
exports.expectBoolean = expectBoolean;
/**
 * Throw if not guid
 */
function expectGuid(value, name) {
    if (!isGuid(value)) {
        throw name + " is not a guid: " + value;
    }
}
exports.expectGuid = expectGuid;
/**
 * Throw if not array
 */
function expectArray(value, name) {
    if (!Array.isArray(value)) {
        throw name + " is not an array: " + value;
    }
}
exports.expectArray = expectArray;
/**
 * Create guid string
 */
function guid() {
    // Stitch in '4' in the third group
    return (randomHex4() + randomHex4() + "-" + randomHex4() + "-4" + randomHex4().substr(0, 3) + "-" + randomHex4() + "-"
        + randomHex4() + randomHex4() + randomHex4()).toLowerCase();
}
exports.guid = guid;
/**
 * Create random Hex4 string
 */
function randomHex4() {
    return (Math.floor(((1 + Math.random()) * 0x10000))).toString(16).substring(1);
}
/**
 * Takes two objects (source, target) and returns the target object with values in the source added to it.
 * It overwrites any source properties which already exist in target.
 * @param sourceObject the source
 * @param targetobject the target
 * @returns the result
 */
function overrideValues(sourceObject, targetobject) {
    if (!targetobject) {
        return targetobject;
    }
    var result = targetobject;
    if (sourceObject) {
        for (var field in sourceObject) {
            if (sourceObject.hasOwnProperty(field)) {
                result[field] = sourceObject[field];
            }
        }
    }
    return result;
}
exports.overrideValues = overrideValues;
},{}],85:[function(require,module,exports){
"use strict";
exports.__esModule = true;
exports["default"] = "1.2.7";
},{}],86:[function(require,module,exports){
"use strict";
/**
 * WindowProperties.ts
 *
 * Module to track window properties.
 */
exports.__esModule = true;
/**
 * Is the window narrow?
 * @returns True if it is, false otherwise
 */
function isNarrow() {
    var narrowScreenBoundary = 800;
    if (window.innerWidth) {
        return window.innerWidth < narrowScreenBoundary;
    }
    // if we can't find the width; go with narrow.
    return true;
}
exports.isNarrow = isNarrow;
},{}],87:[function(require,module,exports){
"use strict";
/**
* Window.ts
*
* Module wrapping around the global window object
*/
exports.__esModule = true;
/**
 * Get the IWindow object
 */
function get() { return window; }
exports.get = get;
/**
 * Set the setUiStrings() method
 * @param setUiStrings the method
 */
function setSetUiStrings(setUiStrings) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.setUiStrings = setUiStrings;
}
exports.setSetUiStrings = setSetUiStrings;
/**
 * Set the singleFeedback() method
 * @param singleFeedback the method
 */
function setSingleFeedback(singleFeedback) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.singleFeedback = singleFeedback;
}
exports.setSingleFeedback = setSingleFeedback;
/**
 * Set the multiFeedback() method
 * @param multiFeedback the method
 */
function setMultiFeedback(multiFeedback) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.multiFeedback = multiFeedback;
}
exports.setMultiFeedback = setMultiFeedback;
/**
 * Set the floodgate showSurvey() method
 * @param floodgateShowSurvey the method
 */
function setFloodgateShowSurvey(floodgateShowSurvey) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.floodgate = window.OfficeBrowserFeedback.floodgate || {};
    window.OfficeBrowserFeedback.floodgate.showSurvey = floodgateShowSurvey;
}
exports.setFloodgateShowSurvey = setFloodgateShowSurvey;
/**
 * Set the floodgate showCustomSurvey() method
 * @param floodgateShowSurvey the method
 */
function setFloodgateShowCustomSurvey(floodgateShowCustomSurvey) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.floodgate = window.OfficeBrowserFeedback.floodgate || {};
    window.OfficeBrowserFeedback.floodgate.showCustomSurvey = floodgateShowCustomSurvey;
}
exports.setFloodgateShowCustomSurvey = setFloodgateShowCustomSurvey;
/**
 * Set the floodgate initialize() method
 * @param floodgateInitialize the method
 */
function setFloodgateInitialize(floodgateInitialize) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.floodgate = window.OfficeBrowserFeedback.floodgate || {};
    window.OfficeBrowserFeedback.floodgate.initialize = floodgateInitialize;
}
exports.setFloodgateInitialize = setFloodgateInitialize;
/**
 * Set the floodgate start() method
 * @param floodgateStart the method
 */
function setFloodgateStart(floodgateStart) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.floodgate = window.OfficeBrowserFeedback.floodgate || {};
    window.OfficeBrowserFeedback.floodgate.start = floodgateStart;
}
exports.setFloodgateStart = setFloodgateStart;
/**
 * Set the floodgate stop() method
 * @param floodgateStop the method
 */
function setFloodgateStop(floodgateStop) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.floodgate = window.OfficeBrowserFeedback.floodgate || {};
    window.OfficeBrowserFeedback.floodgate.stop = floodgateStop;
}
exports.setFloodgateStop = setFloodgateStop;
/**
 * Set the floodgate getEngine() method
 * @param floodgateGetEngine the method
 */
function setFloodgateGetEngine(floodgateGetEngine) {
    window.OfficeBrowserFeedback = window.OfficeBrowserFeedback || {};
    window.OfficeBrowserFeedback.floodgate = window.OfficeBrowserFeedback.floodgate || {};
    window.OfficeBrowserFeedback.floodgate.getEngine = floodgateGetEngine;
}
exports.setFloodgateGetEngine = setFloodgateGetEngine;
},{}],88:[function(require,module,exports){
(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else {
		var a = factory();
		for(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];
	}
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = __webpack_require__(1);


/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	/**
	* AriaSDK.ts
	* Author: Abhilash Panwar (abpanwar)
	* Copyright: Microsoft 2016
	*/
	var Enums_1 = __webpack_require__(2);
	exports.AWTPiiKind = Enums_1.AWTPiiKind;
	var AWT_1 = __webpack_require__(3);
	exports.AWT = AWT_1.default;
	exports.AWT_COLLECTOR_URL_UNITED_STATES = 'https://us.pipe.aria.microsoft.com/Collector/3.0/';
	exports.AWT_COLLECTOR_URL_GERMANY = 'https://de.pipe.aria.microsoft.com/Collector/3.0/';
	exports.AWT_COLLECTOR_URL_JAPAN = 'https://jp.pipe.aria.microsoft.com/Collector/3.0/';
	exports.AWT_COLLECTOR_URL_AUSTRALIA = 'https://au.pipe.aria.microsoft.com/Collector/3.0/';
	exports.AWT_COLLECTOR_URL_EUROPE = 'https://eu.pipe.aria.microsoft.com/Collector/3.0/';


/***/ },
/* 2 */
/***/ function(module, exports) {

	/**
	* Enums.ts
	* Author: Abhilash Panwar (abpanwar)
	* Copyright: Microsoft 2016
	* Common enum values used in the SDK.
	*/
	"use strict";
	var AWTPiiKind;
	(function (AWTPiiKind) {
	    AWTPiiKind[AWTPiiKind["NotSet"] = 0] = "NotSet";
	    AWTPiiKind[AWTPiiKind["DistinguishedName"] = 1] = "DistinguishedName";
	    AWTPiiKind[AWTPiiKind["GenericData"] = 2] = "GenericData";
	    AWTPiiKind[AWTPiiKind["IPV4Address"] = 3] = "IPV4Address";
	    AWTPiiKind[AWTPiiKind["IPv6Address"] = 4] = "IPv6Address";
	    AWTPiiKind[AWTPiiKind["MailSubject"] = 5] = "MailSubject";
	    AWTPiiKind[AWTPiiKind["PhoneNumber"] = 6] = "PhoneNumber";
	    AWTPiiKind[AWTPiiKind["QueryString"] = 7] = "QueryString";
	    AWTPiiKind[AWTPiiKind["SipAddress"] = 8] = "SipAddress";
	    AWTPiiKind[AWTPiiKind["SmtpAddress"] = 9] = "SmtpAddress";
	    AWTPiiKind[AWTPiiKind["Identity"] = 10] = "Identity";
	    AWTPiiKind[AWTPiiKind["Uri"] = 11] = "Uri";
	    AWTPiiKind[AWTPiiKind["Fqdn"] = 12] = "Fqdn";
	    // Supports scrubbing of the last octet in a IPV4 address. E.g. 10.121.227.147 becomes 10.121.227.*
	    AWTPiiKind[AWTPiiKind["IPV4AddressLegacy"] = 13] = "IPV4AddressLegacy";
	})(AWTPiiKind = exports.AWTPiiKind || (exports.AWTPiiKind = {}));


/***/ },
/* 3 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	var Enums_1 = __webpack_require__(2);
	var AWTTransmissionManager_1 = __webpack_require__(4);
	var Utils = __webpack_require__(12);
	var Version = __webpack_require__(15);
	var AllTokens = 'allTkns';
	var EventNameAndTypeRegex = /^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/;
	var EventNameDotRegex = /\./g;
	var PropertyNameRegex = /^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/;
	var AWT = (function () {
	    function AWT() {
	    }
	    AWT.initialize = function (tenantToken, configuration) {
	        if (configuration === void 0) { configuration = {}; }
	        if (this._isInitialized) {
	            // tslint:disable-next-line
	            throw 'Already Initialized';
	        }
	        this._defaultTenantToken = tenantToken;
	        this._overrideValuesFromConfig(configuration);
	        //Create sender
	        AWTTransmissionManager_1.default.initialize(this._config);
	        this._isInitialized = true;
	    };
	    AWT.flush = function (callback) {
	        if (this._isInitialized && !this._isDestroyed) {
	            AWTTransmissionManager_1.default.flush(callback);
	        }
	    };
	    AWT.flushAndTeardown = function () {
	        if (this._isInitialized && !this._isDestroyed) {
	            this._isDestroyed = true;
	            AWTTransmissionManager_1.default.flushAndTeardown();
	        }
	    };
	    AWT.setContext = function (name, property, tenantToken) {
	        if (tenantToken === void 0) { tenantToken = AllTokens; }
	        property = this._sanitizeProperty(name, property);
	        if (property === null) {
	            return;
	        }
	        if (!this._contextProperties[tenantToken]) {
	            this._contextProperties[tenantToken] = {};
	        }
	        this._contextProperties[tenantToken][name] = property;
	    };
	    AWT.logEvent = function (event) {
	        var _this = this;
	        if (this._isInitialized) {
	            if (!event.name || !event.properties) {
	                return;
	            }
	            event.name = event.name.toLowerCase();
	            event.name.replace(EventNameDotRegex, '_');
	            var typePrefix = '';
	            if (!event.type) {
	                event.type = 'custom';
	            }
	            else {
	                event.type.toLowerCase();
	                typePrefix = 'custom.';
	            }
	            if (!EventNameAndTypeRegex.test(event.name) || !EventNameAndTypeRegex.test(event.type)) {
	                return;
	            }
	            event.type = typePrefix + event.type;
	            if (isNaN(event.timestamp)) {
	                event.timestamp = (new Date()).getTime();
	            }
	            if (!event.tenantToken) {
	                event.tenantToken = this._defaultTenantToken;
	            }
	            event.id = Utils.newGuid();
	            Object.keys(event.properties).forEach(function (name) {
	                event.properties[name] = _this._sanitizeProperty(name, event.properties[name]);
	                if (event.properties[name] === null) {
	                    delete event.properties[name];
	                }
	            });
	            this._addContextIfAbsent(event, event.tenantToken);
	            this._addContextIfAbsent(event, AllTokens);
	            if (Object.keys(event.properties).length === 0) {
	                return;
	            }
	            this._setDefaultProperty(event, 'EventInfo.InitId', this._getInitId(event.tenantToken));
	            this._setDefaultProperty(event, 'EventInfo.Sequence', this._getSequenceId(event.tenantToken));
	            this._setDefaultProperty(event, 'EventInfo.SdkVersion', Version.FullVersionString);
	            this._setDefaultProperty(event, 'EventInfo.Name', event.name);
	            this._setDefaultProperty(event, 'EventInfo.Time', (new Date(event.timestamp)).toISOString());
	            AWTTransmissionManager_1.default.sendEvent(event);
	        }
	    };
	    AWT._overrideValuesFromConfig = function (config) {
	        if (config.collectorUrl) {
	            this._config.collectorUrl = config.collectorUrl;
	        }
	        if (config.sendingTimer > 1000) {
	            this._config.sendingTimer = config.sendingTimer;
	        }
	    };
	    AWT._getInitId = function (tenantToken) {
	        if (this._initIdMap[tenantToken] === undefined) {
	            this._initIdMap[tenantToken] = Utils.newGuid();
	        }
	        return this._initIdMap[tenantToken];
	    };
	    AWT._getSequenceId = function (tenantToken) {
	        if (this._sequenceIdMap[tenantToken] === undefined) {
	            this._sequenceIdMap[tenantToken] = 0;
	        }
	        return (++this._sequenceIdMap[tenantToken]).toString();
	    };
	    AWT._setDefaultProperty = function (event, name, value) {
	        event.properties[name] = { value: value, pii: Enums_1.AWTPiiKind.NotSet };
	    };
	    AWT._addContextIfAbsent = function (event, tenantToken) {
	        if (this._contextProperties[tenantToken]) {
	            var context_1 = this._contextProperties[tenantToken];
	            Object.keys(context_1).forEach(function (name) {
	                if (!event.properties[name]) {
	                    event.properties[name] = context_1[name];
	                }
	            });
	        }
	    };
	    AWT._sanitizeProperty = function (name, property) {
	        if (typeof property === 'string' || typeof property === 'number' || typeof property === 'boolean') {
	            property = { value: property };
	        }
	        if (!PropertyNameRegex.test(name) || property === undefined || property === null
	            || property.value === null || property.value === undefined || property.value === '') {
	            return null;
	        }
	        if (typeof property.pii === 'undefined') {
	            property.pii = Enums_1.AWTPiiKind.NotSet;
	        }
	        property.value = property.value.toString();
	        return Utils.isPii(property.pii) ? property : null;
	    };
	    return AWT;
	}());
	AWT._isInitialized = false;
	AWT._isDestroyed = false;
	AWT._contextProperties = {};
	AWT._sequenceIdMap = {};
	AWT._initIdMap = {};
	AWT._config = {
	    collectorUrl: 'https://browser.pipe.aria.microsoft.com/Collector/3.0/',
	    sendingTimer: 1000
	};
	Object.defineProperty(exports, "__esModule", { value: true });
	exports.default = AWT;


/***/ },
/* 4 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	var AWTRecordBatcher_1 = __webpack_require__(5);
	var AWTBondSerializer_1 = __webpack_require__(6);
	var AWTRetryPolicy_1 = __webpack_require__(13);
	var AWTKillSwitch_1 = __webpack_require__(14);
	var Version = __webpack_require__(15);
	var FlushCheckTimer = 250;
	var RequestSizeLimitBytes = 2936012; //approx 2.8 Mb
	var MaxRetries = 4;
	var AWTTransmissionManager = (function () {
	    function AWTTransmissionManager() {
	    }
	    AWTTransmissionManager.initialize = function (config) {
	        this._inboundQueues.push([]);
	        this._recordBatcher = new AWTRecordBatcher_1.default(RequestSizeLimitBytes, this._outboundQueue);
	        this._newEventsAllowed = true;
	        if (typeof Uint8Array === 'undefined') {
	            this._urlString += '&content-encoding=base64';
	        }
	        this._sendingTimer = config.sendingTimer;
	        this._urlString = config.collectorUrl + this._urlString + '&x-apikey=';
	    };
	    //Push the event into the inbound queue and return
	    AWTTransmissionManager.sendEvent = function (event) {
	        var _this = this;
	        if (this._newEventsAllowed) {
	            //Add event to the last inbound queue
	            this._inboundQueues[this._inboundQueues.length - 1].push(event);
	            if (!this._running && this._timeout < 0 && !this._isCurrentlyFlushing) {
	                this._timeout = setTimeout(function () { return _this._batchAndSendEvents(false); }, this._sendingTimer);
	            }
	        }
	    };
	    AWTTransmissionManager.flushAndTeardown = function () {
	        this._newEventsAllowed = false;
	        this._batchAndSendEvents(true);
	    };
	    AWTTransmissionManager.flush = function (callback) {
	        this._inboundQueues.push([]);
	        if (!this._isCurrentlyFlushing) {
	            this._isCurrentlyFlushing = true;
	            this._flush(callback);
	        }
	        else {
	            this._flushQueue.push(callback);
	        }
	    };
	    AWTTransmissionManager._batchAndSendEvents = function (isTeardown) {
	        this._running = true;
	        while (this._inboundQueues[0].length > 0 && this._outboundQueue.length < 1) {
	            this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());
	        }
	        if (this._outboundQueue.length === 0) {
	            this._recordBatcher.flushBatch();
	        }
	        this._sendRequest(this._outboundQueue.pop(), 0, isTeardown);
	    };
	    AWTTransmissionManager._retryRequestIfNeeded = function (conn, request, tokenCount, apikey, retryCount) {
	        var _this = this;
	        var shouldRetry = true;
	        if (conn && typeof conn.status !== 'undefined') {
	            var killedTokens = this._killSwitch.setKillSwitchTenants(conn.getResponseHeader('kill-tokens'), conn.getResponseHeader('kill-duration-seconds'));
	            killedTokens.forEach(function (key) {
	                delete request[key];
	                tokenCount--;
	            });
	            if (!AWTRetryPolicy_1.default.shouldRetryForStatus(conn.status) || tokenCount <= 0) {
	                shouldRetry = false;
	            }
	        }
	        if (shouldRetry && retryCount < MaxRetries) {
	            setTimeout(function () { return _this._sendRequest(request, retryCount + 1, false); }, AWTRetryPolicy_1.default.getMillisToBackoffForRetry(retryCount));
	        }
	        else {
	            this._handleRequestFinished(null);
	        }
	    };
	    AWTTransmissionManager._sendRequest = function (request, retryCount, isTeardown) {
	        var _this = this;
	        var conn = new XMLHttpRequest();
	        var tokenCount = 0;
	        var apikey = '';
	        Object.keys(request).forEach(function (token) {
	            if (!_this._killSwitch.isTenantKilled(token)) {
	                if (apikey.length > 0) {
	                    apikey += ',';
	                }
	                apikey += token;
	                tokenCount++;
	            }
	            else {
	                delete request[token];
	            }
	        });
	        conn.open('POST', this._urlString + apikey, !isTeardown);
	        if (!isTeardown) {
	            conn.ontimeout = function () {
	                _this._retryRequestIfNeeded(conn, request, tokenCount, apikey, retryCount);
	            };
	            conn.onerror = function () {
	                _this._retryRequestIfNeeded(conn, request, tokenCount, apikey, retryCount);
	            };
	            conn.onload = function () {
	                _this._handleRequestFinished(conn);
	            };
	        }
	        if (tokenCount > 0) {
	            var blob = AWTBondSerializer_1.default.getPayloadBlob(request, tokenCount);
	            if (typeof Uint8Array === 'undefined') {
	                conn.send(AWTBondSerializer_1.default.base64Encode(blob));
	            }
	            else {
	                conn.send(new Uint8Array(blob));
	            }
	        }
	        else if (isTeardown) {
	            this._handleRequestFinished(null);
	        }
	    };
	    AWTTransmissionManager._handleRequestFinished = function (conn) {
	        var _this = this;
	        if (conn) {
	            this._killSwitch.setKillSwitchTenants(conn.getResponseHeader('kill-tokens'), conn.getResponseHeader('kill-duration-seconds'));
	        }
	        if (this._inboundQueues[0].length > 0) {
	            this._timeout = setTimeout(function () { return _this._batchAndSendEvents(false); }, this._sendingTimer);
	        }
	        else {
	            this._timeout = -1;
	            this._running = false;
	        }
	    };
	    AWTTransmissionManager._flush = function (callback) {
	        var _this = this;
	        if (!this._running) {
	            if (this._timeout > -1) {
	                clearTimeout(this._timeout);
	                this._timeout = -1;
	            }
	            if (this._inboundQueues[0].length > 0) {
	                this._batchAndSendEvents(false);
	            }
	        }
	        this._checkPrimaryInboundQueueEmpty(function () {
	            //Move the next queue to be primary
	            _this._inboundQueues.shift();
	            if (callback !== null && callback !== undefined) {
	                callback();
	            }
	            if (_this._flushQueue.length > 0) {
	                setTimeout(function () { return _this._flush(_this._flushQueue.shift()); }, _this._sendingTimer);
	            }
	            else {
	                _this._isCurrentlyFlushing = false;
	                if (_this._inboundQueues[0].length > 0) {
	                    _this._timeout = setTimeout(function () { return _this._batchAndSendEvents(false); }, _this._sendingTimer);
	                }
	            }
	        });
	    };
	    AWTTransmissionManager._checkPrimaryInboundQueueEmpty = function (callback) {
	        var _this = this;
	        if (this._inboundQueues[0].length === 0) {
	            this._checkOutboundQueueEmptyAndSent(callback);
	        }
	        else {
	            setTimeout(function () { return _this._checkPrimaryInboundQueueEmpty(callback); }, FlushCheckTimer);
	        }
	    };
	    AWTTransmissionManager._checkOutboundQueueEmptyAndSent = function (callback) {
	        var _this = this;
	        if (!this._running) {
	            callback();
	        }
	        else {
	            setTimeout(function () { return _this._checkOutboundQueueEmptyAndSent(callback); }, FlushCheckTimer);
	        }
	    };
	    return AWTTransmissionManager;
	}());
	AWTTransmissionManager._outboundQueue = [];
	AWTTransmissionManager._inboundQueues = [];
	AWTTransmissionManager._newEventsAllowed = false;
	AWTTransmissionManager._killSwitch = new AWTKillSwitch_1.default();
	AWTTransmissionManager._isCurrentlyFlushing = false;
	AWTTransmissionManager._flushQueue = [];
	AWTTransmissionManager._running = false;
	AWTTransmissionManager._timeout = -1;
	AWTTransmissionManager._urlString = '?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version='
	    + Version.FullVersionString;
	Object.defineProperty(exports, "__esModule", { value: true });
	exports.default = AWTTransmissionManager;


/***/ },
/* 5 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	var AWTBondSerializer_1 = __webpack_require__(6);
	var AWTRecordBatcher = (function () {
	    function AWTRecordBatcher(_maxRequestSize, _outboundQueue) {
	        this._maxRequestSize = _maxRequestSize;
	        this._outboundQueue = _outboundQueue;
	        this._currentBatch = {};
	        this._currentBatchSize = 0;
	    }
	    AWTRecordBatcher.prototype.addEventToBatch = function (event) {
	        var serializedEvent = AWTBondSerializer_1.default.getEventBlob(event);
	        if (serializedEvent.length > this._maxRequestSize) {
	            //single event too big
	            return;
	        }
	        if (this._currentBatchSize + serializedEvent.length > this._maxRequestSize) {
	            this.flushBatch();
	        }
	        else {
	            if (this._currentBatch[event.tenantToken] === undefined) {
	                this._currentBatch[event.tenantToken] = [];
	            }
	            this._currentBatch[event.tenantToken].push(serializedEvent);
	            this._currentBatchSize += serializedEvent.length;
	        }
	    };
	    AWTRecordBatcher.prototype.flushBatch = function () {
	        if (this._currentBatchSize > 0) {
	            this._outboundQueue.push(this._currentBatch);
	            this._currentBatch = {};
	            this._currentBatchSize = 0;
	        }
	    };
	    return AWTRecordBatcher;
	}());
	Object.defineProperty(exports, "__esModule", { value: true });
	exports.default = AWTRecordBatcher;


/***/ },
/* 6 */
/***/ function(module, exports, __webpack_require__) {

	/**
	* AWTBondSerializer.ts
	* Author: Brent Erickson (brericks) and Abhilash Panwar (abpanwar)
	* Copyright: Microsoft 2016
	* Class to handler bond serialization.
	*/
	"use strict";
	var Bond = __webpack_require__(7);
	var Enums_1 = __webpack_require__(2);
	var Utils = __webpack_require__(12);
	var AWTBondSerializer = (function () {
	    function AWTBondSerializer() {
	    }
	    AWTBondSerializer.getPayloadBlob = function (requestDictionary, tokenCount) {
	        var stream = new Bond.IO.MemoryStream();
	        var writer = new Bond.CompactBinaryProtocolWriter(stream);
	        // Begin ClientCollector request
	        //Write TokenToDataPackagesMap
	        writer.WriteFieldBegin(Bond.BondDataType.BT_MAP, 3);
	        writer.WriteMapContainerBegin(tokenCount, Bond.BondDataType.BT_STRING, Bond.BondDataType.BT_LIST);
	        Object.keys(requestDictionary).forEach(function (token) {
	            //write token
	            writer.WriteString(token);
	            var dataPackage = requestDictionary[token];
	            // Write list of DataPackages
	            writer.WriteContainerBegin(1, Bond.BondDataType.BT_STRUCT);
	            // Source
	            writer.WriteFieldBegin(Bond.BondDataType.BT_STRING, 2);
	            writer.WriteString('act_default_source');
	            // DataPackageId
	            writer.WriteFieldBegin(Bond.BondDataType.BT_STRING, 5);
	            writer.WriteString(Utils.newGuid());
	            // Timestamp
	            writer.WriteFieldBegin(Bond.BondDataType.BT_INT64, 6);
	            writer.WriteInt64(Utils.numberToBondInt64(Date.now()));
	            // Records
	            writer.WriteFieldBegin(Bond.BondDataType.BT_LIST, 8);
	            writer.WriteContainerBegin(dataPackage.length, Bond.BondDataType.BT_STRUCT);
	            for (var i = 0; i < dataPackage.length; ++i) {
	                writer.WriteBlob(dataPackage[i]);
	            }
	            writer.WriteStructEnd(false);
	        });
	        // End ClientCollector
	        writer.WriteStructEnd(false);
	        return stream.GetBuffer();
	    };
	    // As per mappings at https://skype.visualstudio.com/SCC/F.S4L.FUNDAMENTALS/_git/infrastructure_data_clienttelemetry?
	    // path=%2Fclienttelemetry%2Fsrc%2Fbond%2FDataPackage.bond&version=GBdev2&_a=contents
	    // Requires that the values of AWTEventData.properties must all be AWTEventProperty
	    AWTBondSerializer.getEventBlob = function (eventData) {
	        var stream = new Bond.IO.MemoryStream();
	        var writer = new Bond.CompactBinaryProtocolWriter(stream);
	        // ID
	        writer.WriteFieldBegin(Bond.BondDataType.BT_STRING, 1);
	        writer.WriteString(eventData.id);
	        // Timestamp
	        writer.WriteFieldBegin(Bond.BondDataType.BT_INT64, 3);
	        writer.WriteInt64(Utils.numberToBondInt64(eventData.timestamp));
	        // Type
	        writer.WriteFieldBegin(Bond.BondDataType.BT_STRING, 5);
	        writer.WriteString(eventData.type);
	        // Event Type
	        writer.WriteFieldBegin(Bond.BondDataType.BT_STRING, 6);
	        writer.WriteString(eventData.name);
	        var propsString = [];
	        var piiProps = [];
	        // Iterate across event data properties and separate based on pii
	        Object.keys(eventData.properties).forEach(function (key) {
	            var property = eventData.properties[key];
	            if (property.pii === Enums_1.AWTPiiKind.NotSet) {
	                propsString.push(key);
	            }
	            else {
	                piiProps.push(key);
	            }
	        });
	        //Extension map
	        if (propsString.length) {
	            writer.WriteFieldBegin(Bond.BondDataType.BT_MAP, 13);
	            writer.WriteMapContainerBegin(propsString.length, Bond.BondDataType.BT_STRING, Bond.BondDataType.BT_STRING);
	            propsString.forEach(function (name) {
	                writer.WriteString(name);
	                writer.WriteString(eventData.properties[name].value);
	            });
	        }
	        // Pii
	        if (piiProps.length) {
	            writer.WriteFieldBegin(Bond.BondDataType.BT_MAP, 30);
	            writer.WriteMapContainerBegin(piiProps.length, Bond.BondDataType.BT_STRING, Bond.BondDataType.BT_STRUCT);
	            piiProps.forEach(function (name) {
	                writer.WriteString(name);
	                // PII Data
	                // O365 scrubber type
	                writer.WriteFieldBegin(Bond.BondDataType.BT_INT32, 1);
	                writer.WriteInt32(1);
	                // PII Kind
	                writer.WriteFieldBegin(Bond.BondDataType.BT_INT32, 2);
	                writer.WriteInt32(eventData.properties[name].pii);
	                // Value
	                writer.WriteFieldBegin(Bond.BondDataType.BT_STRING, 3);
	                writer.WriteString(eventData.properties[name].value);
	                writer.WriteStructEnd(false);
	            });
	        }
	        writer.WriteStructEnd(false);
	        return stream.GetBuffer();
	    };
	    AWTBondSerializer.base64Encode = function (data) {
	        return Bond.Encoding.Base64.GetString(data);
	    };
	    return AWTBondSerializer;
	}());
	Object.defineProperty(exports, "__esModule", { value: true });
	exports.default = AWTBondSerializer;


/***/ },
/* 7 */
/***/ function(module, exports, __webpack_require__) {

	/**
	* microsoft.bond.ts
	* Copyright: Microsoft 2016
	*/
	"use strict";
	var bond_const_1 = __webpack_require__(8);
	exports.BondDataType = bond_const_1.BondDataType;
	var Encoding = __webpack_require__(9);
	exports.Encoding = Encoding;
	var IO = __webpack_require__(11);
	exports.IO = IO;
	var microsoft_bond_primitives_1 = __webpack_require__(10);
	exports.Int64 = microsoft_bond_primitives_1.Int64;
	exports.UInt64 = microsoft_bond_primitives_1.UInt64;
	exports.Number = microsoft_bond_primitives_1.Number;
	var CompactBinaryProtocolWriter = (function () {
	    function CompactBinaryProtocolWriter(stream) {
	        this._stream = stream;
	    }
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteBlob = function (blob) {
	        this._stream.Write(blob, 0, blob.length);
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteContainerBegin = function (size, elementType) {
	        this.WriteUInt8(elementType);
	        this.WriteUInt32(size);
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteMapContainerBegin = function (size, keyType, valueType) {
	        this.WriteUInt8(keyType);
	        this.WriteUInt8(valueType);
	        this.WriteUInt32(size);
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteFieldBegin = function (type, id) {
	        if (id <= 5) {
	            this._stream.WriteByte(type | (id << 5));
	        }
	        else if (id <= 0xff) {
	            this._stream.WriteByte(type | (6 << 5));
	            this._stream.WriteByte(id);
	        }
	        else {
	            this._stream.WriteByte(type | (7 << 5));
	            this._stream.WriteByte(id);
	            this._stream.WriteByte(id >> 8);
	        }
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteInt32 = function (value) {
	        value = Encoding.Zigzag.EncodeZigzag32(value);
	        this.WriteUInt32(value);
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteInt64 = function (value) {
	        this.WriteUInt64(Encoding.Zigzag.EncodeZigzag64(value));
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteString = function (value) {
	        if (value === '') {
	            this.WriteUInt32(0 /*length*/);
	        }
	        else {
	            var array = Encoding.Utf8.GetBytes(value);
	            this.WriteUInt32(array.length);
	            this._stream.Write(array, 0, array.length);
	        }
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteStructEnd = function (isBase) {
	        this.WriteUInt8(isBase ? bond_const_1.BondDataType.BT_STOP_BASE : bond_const_1.BondDataType.BT_STOP);
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteUInt32 = function (value) {
	        var array = Encoding.Varint.GetBytes(microsoft_bond_primitives_1.Number.ToUInt32(value));
	        this._stream.Write(array, 0, array.length);
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteUInt64 = function (value) {
	        var array = Encoding.Varint64.GetBytes(value);
	        this._stream.Write(array, 0, array.length);
	    };
	    /*override*/
	    CompactBinaryProtocolWriter.prototype.WriteUInt8 = function (value) {
	        this._stream.WriteByte(microsoft_bond_primitives_1.Number.ToUInt8(value));
	    };
	    return CompactBinaryProtocolWriter;
	}());
	exports.CompactBinaryProtocolWriter = CompactBinaryProtocolWriter;


/***/ },
/* 8 */
/***/ function(module, exports) {

	/**
	* bond_const.ts
	* Copyright: Microsoft 2016
	*/
	"use strict";
	//------------------------------------------------------------------------------
	// <auto-generated>
	//     This code was generated by a tool.
	//
	//     Tool     : bondc, Version=3.0.1, Build=bond-git.debug.not
	//     Template : Microsoft.Bond.Rules.dll#TypeScript.tt
	//     File     : bond_const.ts
	//
	//     Changes to this file may cause incorrect behavior and will be lost when
	//     the code is regenerated.
	// </auto-generated>
	//------------------------------------------------------------------------------
	var BondDataType;
	(function (BondDataType) {
	    BondDataType[BondDataType["BT_STOP"] = 0] = "BT_STOP";
	    BondDataType[BondDataType["BT_STOP_BASE"] = 1] = "BT_STOP_BASE";
	    BondDataType[BondDataType["BT_UINT8"] = 3] = "BT_UINT8";
	    BondDataType[BondDataType["BT_UINT32"] = 5] = "BT_UINT32";
	    BondDataType[BondDataType["BT_UINT64"] = 6] = "BT_UINT64";
	    BondDataType[BondDataType["BT_STRING"] = 9] = "BT_STRING";
	    BondDataType[BondDataType["BT_STRUCT"] = 10] = "BT_STRUCT";
	    BondDataType[BondDataType["BT_LIST"] = 11] = "BT_LIST";
	    BondDataType[BondDataType["BT_MAP"] = 13] = "BT_MAP";
	    BondDataType[BondDataType["BT_INT32"] = 16] = "BT_INT32";
	    BondDataType[BondDataType["BT_INT64"] = 17] = "BT_INT64";
	    BondDataType[BondDataType["BT_UNAVAILABLE"] = 127] = "BT_UNAVAILABLE";
	})(BondDataType = exports.BondDataType || (exports.BondDataType = {}));


/***/ },
/* 9 */
/***/ function(module, exports, __webpack_require__) {

	/**
	* microsoft.bond.encoding.ts
	* Copyright: Microsoft 2016
	*/
	"use strict";
	var microsoft_bond_primitives_1 = __webpack_require__(10);
	var Utf8 = (function () {
	    function Utf8() {
	    }
	    Utf8.GetBytes = function (value) {
	        var array = [];
	        for (var i = 0; i < value.length; ++i) {
	            var char = value.charCodeAt(i);
	            if (char < 0x80) {
	                array.push(char);
	            }
	            else if (char < 0x800) {
	                array.push(0xc0 | (char >> 6), 0x80 | (char & 0x3f));
	            }
	            else if (char < 0xd800 || char >= 0xe000) {
	                array.push(0xe0 | (char >> 12), 0x80 | ((char >> 6) & 0x3f), 0x80 | (char & 0x3f));
	            }
	            else {
	                char = 0x10000 + (((char & 0x3ff) << 10) | (value.charCodeAt(++i) & 0x3ff));
	                array.push(0xf0 | (char >> 18), 0x80 | ((char >> 12) & 0x3f), 0x80 | ((char >> 6) & 0x3f), 0x80 | (char & 0x3f));
	            }
	        }
	        return array;
	    };
	    return Utf8;
	}());
	exports.Utf8 = Utf8;
	var Base64 = (function () {
	    function Base64() {
	    }
	    Base64.GetString = function (inArray) {
	        var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
	        var output = [];
	        var paddingBytes = inArray.length % 3;
	        var toBase64 = function (num) {
	            return [lookup.charAt((num >> 18) & 0x3F),
	                lookup.charAt((num >> 12) & 0x3F),
	                lookup.charAt((num >> 6) & 0x3F),
	                lookup.charAt(num & 0x3F)].join('');
	        };
	        for (var i = 0, length_1 = inArray.length - paddingBytes; i < length_1; i += 3) {
	            var temp = (inArray[i] << 16) + (inArray[i + 1] << 8) + (inArray[i + 2]);
	            output.push(toBase64(temp));
	        }
	        switch (paddingBytes) {
	            case 1:
	                var temp = inArray[inArray.length - 1];
	                output.push(lookup.charAt(temp >> 2));
	                output.push(lookup.charAt((temp << 4) & 0x3F));
	                output.push('==');
	                break;
	            case 2:
	                var temp2 = (inArray[inArray.length - 2] << 8) + (inArray[inArray.length - 1]);
	                output.push(lookup.charAt(temp2 >> 10));
	                output.push(lookup.charAt((temp2 >> 4) & 0x3F));
	                output.push(lookup.charAt((temp2 << 2) & 0x3F));
	                output.push('=');
	                break;
	        }
	        return output.join('');
	    };
	    return Base64;
	}());
	exports.Base64 = Base64;
	var Varint = (function () {
	    function Varint() {
	    }
	    Varint.GetBytes = function (value) {
	        var array = [];
	        while (value & 0xffffff80) {
	            array.push((value & 0x7f) | 0x80);
	            value >>>= 7;
	        }
	        array.push(value & 0x7f);
	        return array;
	    };
	    return Varint;
	}());
	exports.Varint = Varint;
	var Varint64 = (function () {
	    function Varint64() {
	    }
	    Varint64.GetBytes = function (value) {
	        var low = value.low;
	        var high = value.high;
	        var array = [];
	        while (high || (0xffffff80 & low)) {
	            array.push((low & 0x7f) | 0x80);
	            low = ((high & 0x7f) << 25) | (low >>> 7);
	            high >>>= 7;
	        }
	        array.push(low & 0x7f);
	        return array;
	    };
	    return Varint64;
	}());
	exports.Varint64 = Varint64;
	var Zigzag = (function () {
	    function Zigzag() {
	    }
	    Zigzag.EncodeZigzag32 = function (value) {
	        value = microsoft_bond_primitives_1.Number.ToInt32(value);
	        return ((value << 1) ^ (value >> (4 /*sizeof(int)*/ * 8 - 1)));
	    };
	    Zigzag.EncodeZigzag64 = function (value) {
	        var low = value.low;
	        var high = value.high;
	        var tmpH = (high << 1) | (low >>> 31);
	        var tmpL = low << 1;
	        if (high & 0x80000000) {
	            tmpH = ~tmpH;
	            tmpL = ~tmpL;
	        }
	        var res = new microsoft_bond_primitives_1.UInt64('0');
	        res.low = tmpL;
	        res.high = tmpH;
	        return res;
	    };
	    return Zigzag;
	}());
	exports.Zigzag = Zigzag;


/***/ },
/* 10 */
/***/ function(module, exports) {

	/**
	* microsoft.bond.primitives.ts
	* Copyright: Microsoft 2016
	*/
	"use strict";
	var Int64 = (function () {
	    // BUG!!: need implement, currently, just handle 32bits number
	    function Int64(numberStr) {
	        this.low = 0;
	        this.high = 0;
	        this.low = parseInt(numberStr, 10);
	        if (this.low < 0) {
	            this.high = -1;
	        }
	    }
	    Int64.prototype.Equals = function (numberStr) {
	        var tmp = new Int64(numberStr);
	        return this.low === tmp.low && this.high === tmp.high;
	    };
	    return Int64;
	}());
	exports.Int64 = Int64;
	var UInt64 = (function () {
	    // BUG!!: need implement, currently, just handle 32bits number
	    function UInt64(numberStr) {
	        this.low = 0;
	        this.high = 0;
	        this.low = parseInt(numberStr, 10);
	    }
	    UInt64.prototype.Equals = function (numberStr) {
	        var tmp = new UInt64(numberStr);
	        return this.low === tmp.low && this.high === tmp.high;
	    };
	    return UInt64;
	}());
	exports.UInt64 = UInt64;
	var Number = (function () {
	    function Number() {
	    }
	    Number.ToByte = function (value) {
	        return this.ToUInt8(value);
	    };
	    Number.ToInt16 = function (value) {
	        var signMask = (value & 0x8000) << 16 >> 16;
	        return (value & 0x7fff) | signMask;
	    };
	    Number.ToInt32 = function (value) {
	        var signMask = (value & 0x80000000);
	        return (value & 0x7fffffff) | signMask;
	    };
	    Number.ToUInt8 = function (value) {
	        return value & 0xff;
	    };
	    Number.ToUInt32 = function (value) {
	        return value & 0xffffffff;
	    };
	    return Number;
	}());
	exports.Number = Number;


/***/ },
/* 11 */
/***/ function(module, exports, __webpack_require__) {

	/**
	* microsoft.bond.io.ts
	* Copyright: Microsoft 2016
	*/
	"use strict";
	var microsoft_bond_primitives_1 = __webpack_require__(10);
	var MemoryStream = (function () {
	    function MemoryStream() {
	        this._buffer = [];
	    }
	    /*override*/
	    MemoryStream.prototype.WriteByte = function (byte) {
	        this._buffer.push(microsoft_bond_primitives_1.Number.ToByte(byte));
	    };
	    /*override*/
	    MemoryStream.prototype.Write = function (buffer, offset, count) {
	        while (count--) {
	            this.WriteByte(buffer[offset++]);
	        }
	    };
	    /**
	     * Returns the array of unsigned bytes from which this stream was created.
	     */
	    MemoryStream.prototype.GetBuffer = function () {
	        return this._buffer;
	    };
	    return MemoryStream;
	}());
	exports.MemoryStream = MemoryStream;


/***/ },
/* 12 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	/**
	* Utils.ts
	* Author: Brent Erickson (brericks) and Abhilash Panwar (abpanwar)
	* Copyright: Microsoft 2016
	* Common functions used in the SDK.
	*/
	var microsoft_bond_primitives_1 = __webpack_require__(10);
	var GuidRegex = /[xy]/g;
	function numberToBondInt64(value) {
	    // Construct bond timestamp for aria
	    var bond_value = new microsoft_bond_primitives_1.Int64('0');
	    bond_value.low = value & 0xffffffff;
	    bond_value.high = Math.floor(value / 0x100000000);
	    return bond_value;
	}
	exports.numberToBondInt64 = numberToBondInt64;
	function newGuid() {
	    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(GuidRegex, function (c) {
	        var r = (Math.random() * 16 | 0), v = (c === 'x' ? r : r & 0x3 | 0x8);
	        return v.toString(16);
	    });
	}
	exports.newGuid = newGuid;
	function isPii(value) {
	    if (!isNaN(value) && value !== null && value >= 0 && value <= 13) {
	        return true;
	    }
	    return false;
	}
	exports.isPii = isPii;


/***/ },
/* 13 */
/***/ function(module, exports) {

	"use strict";
	/**
	* AWTRetryPolicy.ts
	* Author: Abhilash Panwar (abpanwar)
	* Copyright: Microsoft 2016
	* Class for retry policy.
	*/
	var RandomizationLowerThreshold = 0.8;
	var RandomizationUpperThreshold = 1.2;
	var BaseBackoff = 3000;
	var MaxBackoff = 120000;
	var AWTRetryPolicy = (function () {
	    function AWTRetryPolicy() {
	    }
	    AWTRetryPolicy.shouldRetryForStatus = function (httpStatusCode) {
	        /* The below expression reads that we should only retry for:
	            - HttpStatusCodes that are smaller than 300.
	            - HttpStatusCodes greater or equal to 500 (except for 501-NotImplement
	              and 505-HttpVersionNotSupport).
	            - HttpStatusCode 408-RequestTimeout.
	           This is based on Microsoft.WindowsAzure.Storage.RetryPolicies.ExponentialRetry class */
	        return !((httpStatusCode >= 300 && httpStatusCode < 500 && httpStatusCode !== 408)
	            || (httpStatusCode === 501)
	            || (httpStatusCode === 505));
	    };
	    AWTRetryPolicy.getMillisToBackoffForRetry = function (retriesSoFar) {
	        var waitDuration = 0;
	        var minBackoff = BaseBackoff * RandomizationLowerThreshold;
	        var maxBackoff = BaseBackoff * RandomizationUpperThreshold;
	        var randomBackoff = Math.floor(Math.random() * (maxBackoff - minBackoff)) + minBackoff;
	        waitDuration = Math.pow(4, retriesSoFar) * randomBackoff;
	        return Math.min(waitDuration, MaxBackoff);
	    };
	    return AWTRetryPolicy;
	}());
	Object.defineProperty(exports, "__esModule", { value: true });
	exports.default = AWTRetryPolicy;


/***/ },
/* 14 */
/***/ function(module, exports) {

	"use strict";
	var SecToMsMultiplier = 1000;
	var AWTKillSwitch = (function () {
	    function AWTKillSwitch() {
	        this._killedTokenDictionary = {};
	    }
	    AWTKillSwitch.prototype.setKillSwitchTenants = function (killTokens, killDuration) {
	        var _this = this;
	        if (killTokens && killDuration) {
	            try {
	                var killedTokens = killTokens.split(',');
	                if (killDuration === 'this-request-only') {
	                    return killedTokens;
	                }
	                var durationMs_1 = parseInt(killDuration, 10) * SecToMsMultiplier;
	                killedTokens.forEach(function (token) {
	                    _this._killedTokenDictionary[token] = Date.now() + durationMs_1;
	                });
	            }
	            catch (ex) {
	                return [];
	            }
	        }
	        return [];
	    };
	    AWTKillSwitch.prototype.isTenantKilled = function (tenantToken) {
	        if (this._killedTokenDictionary[tenantToken] !== undefined && this._killedTokenDictionary[tenantToken] > Date.now()) {
	            return true;
	        }
	        delete this._killedTokenDictionary[tenantToken];
	        return false;
	    };
	    return AWTKillSwitch;
	}());
	Object.defineProperty(exports, "__esModule", { value: true });
	exports.default = AWTKillSwitch;


/***/ },
/* 15 */
/***/ function(module, exports) {

	"use strict";
	/**
	* Version.ts
	* Author: Abhilash Panwar (abpanwar)
	* Copyright: Microsoft 2016
	* Class for SDK version.
	*/
	exports.Version = '1.2.0';
	exports.FullVersionString = 'AWT-Web-CJS-' + exports.Version;


/***/ }
/******/ ])
});
;

},{}],89:[function(require,module,exports){
(function (global){
/*
  html2canvas 0.5.0-beta3 <http://html2canvas.hertzen.com>
  Copyright (c) 2016 Niklas von Hertzen

  Released under  License
*/
var Promise = require('es6-promise').Promise;

!function(e) {window.OfficeBrowserFeedback.html2canvas = e}(function () {var define, module, exports;return (function e(t, n, r) {function s(o, u) { if (!n[o]) { if (!t[o]) { var a = typeof require == "function" && require; if (!u && a) return a(o, !0); if (i) return i(o, !0); var f = new Error("Cannot find module '" + o + "'"); throw f.code = "MODULE_NOT_FOUND", f } var l = n[o] = { exports: {} }; t[o][0].call(l.exports, function (e) { var n = t[o][1][e]; return s(n ? n : e) }, l, l.exports, e, t, n, r) } return n[o].exports } var i = typeof require == "function" && require; for (var o = 0; o < r.length; o++) s(r[o]); return s})({1: [function (_dereq_, module, exports) {
(function (global){
/*! http://mths.be/punycode v1.2.4 by @mathias */
;(function(root) {

    /** Detect free variables */
    var freeExports = typeof exports == 'object' && exports;
    var freeModule = typeof module == 'object' && module &&
        module.exports == freeExports && module;
    var freeGlobal = typeof global == 'object' && global;
    if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {
        root = freeGlobal;
    }

    /**
     * The `punycode` object.
     * @name punycode
     * @type Object
     */
    var punycode,

    /** Highest positive signed 32-bit float value */
    maxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1

    /** Bootstring parameters */
    base = 36,
    tMin = 1,
    tMax = 26,
    skew = 38,
    damp = 700,
    initialBias = 72,
    initialN = 128, // 0x80
    delimiter = '-', // '\x2D'

    /** Regular expressions */
    regexPunycode = /^xn--/,
    regexNonASCII = /[^ -~]/, // unprintable ASCII chars + non-ASCII chars
    regexSeparators = /\x2E|\u3002|\uFF0E|\uFF61/g, // RFC 3490 separators

    /** Error messages */
    errors = {
        'overflow': 'Overflow: input needs wider integers to process',
        'not-basic': 'Illegal input >= 0x80 (not a basic code point)',
        'invalid-input': 'Invalid input'
    },

    /** Convenience shortcuts */
    baseMinusTMin = base - tMin,
    floor = Math.floor,
    stringFromCharCode = String.fromCharCode,

    /** Temporary variable */
    key;

    /*--------------------------------------------------------------------------*/

    /**
     * A generic error utility function.
     * @private
     * @param {String} type The error type.
     * @returns {Error} Throws a `RangeError` with the applicable error message.
     */
    function error(type) {
        throw RangeError(errors[type]);
    }

    /**
     * A generic `Array#map` utility function.
     * @private
     * @param {Array} array The array to iterate over.
     * @param {Function} callback The function that gets called for every array
     * item.
     * @returns {Array} A new array of values returned by the callback function.
     */
    function map(array, fn) {
        var length = array.length;
        while (length--) {
            array[length] = fn(array[length]);
        }
        return array;
    }

    /**
     * A simple `Array#map`-like wrapper to work with domain name strings.
     * @private
     * @param {String} domain The domain name.
     * @param {Function} callback The function that gets called for every
     * character.
     * @returns {Array} A new string of characters returned by the callback
     * function.
     */
    function mapDomain(string, fn) {
        return map(string.split(regexSeparators), fn).join('.');
    }

    /**
     * Creates an array containing the numeric code points of each Unicode
     * character in the string. While JavaScript uses UCS-2 internally,
     * this function will convert a pair of surrogate halves (each of which
     * UCS-2 exposes as separate characters) into a single code point,
     * matching UTF-16.
     * @see `punycode.ucs2.encode`
     * @see <http://mathiasbynens.be/notes/javascript-encoding>
     * @memberOf punycode.ucs2
     * @name decode
     * @param {String} string The Unicode input string (UCS-2).
     * @returns {Array} The new array of code points.
     */
    function ucs2decode(string) {
        var output = [],
            counter = 0,
            length = string.length,
            value,
            extra;
        while (counter < length) {
            value = string.charCodeAt(counter++);
            if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
                // high surrogate, and there is a next character
                extra = string.charCodeAt(counter++);
                if ((extra & 0xFC00) == 0xDC00) { // low surrogate
                    output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
                } else {
                    // unmatched surrogate; only append this code unit, in case the next
                    // code unit is the high surrogate of a surrogate pair
                    output.push(value);
                    counter--;
                }
            } else {
                output.push(value);
            }
        }
        return output;
    }

    /**
     * Creates a string based on an array of numeric code points.
     * @see `punycode.ucs2.decode`
     * @memberOf punycode.ucs2
     * @name encode
     * @param {Array} codePoints The array of numeric code points.
     * @returns {String} The new Unicode string (UCS-2).
     */
    function ucs2encode(array) {
        return map(array, function(value) {
            var output = '';
            if (value > 0xFFFF) {
                value -= 0x10000;
                output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
                value = 0xDC00 | value & 0x3FF;
            }
            output += stringFromCharCode(value);
            return output;
        }).join('');
    }

    /**
     * Converts a basic code point into a digit/integer.
     * @see `digitToBasic()`
     * @private
     * @param {Number} codePoint The basic numeric code point value.
     * @returns {Number} The numeric value of a basic code point (for use in
     * representing integers) in the range `0` to `base - 1`, or `base` if
     * the code point does not represent a value.
     */
    function basicToDigit(codePoint) {
        if (codePoint - 48 < 10) {
            return codePoint - 22;
        }
        if (codePoint - 65 < 26) {
            return codePoint - 65;
        }
        if (codePoint - 97 < 26) {
            return codePoint - 97;
        }
        return base;
    }

    /**
     * Converts a digit/integer into a basic code point.
     * @see `basicToDigit()`
     * @private
     * @param {Number} digit The numeric value of a basic code point.
     * @returns {Number} The basic code point whose value (when used for
     * representing integers) is `digit`, which needs to be in the range
     * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is
     * used; else, the lowercase form is used. The behavior is undefined
     * if `flag` is non-zero and `digit` has no uppercase form.
     */
    function digitToBasic(digit, flag) {
        //  0..25 map to ASCII a..z or A..Z
        // 26..35 map to ASCII 0..9
        return digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);
    }

    /**
     * Bias adaptation function as per section 3.4 of RFC 3492.
     * http://tools.ietf.org/html/rfc3492#section-3.4
     * @private
     */
    function adapt(delta, numPoints, firstTime) {
        var k = 0;
        delta = firstTime ? floor(delta / damp) : delta >> 1;
        delta += floor(delta / numPoints);
        for (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {
            delta = floor(delta / baseMinusTMin);
        }
        return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));
    }

    /**
     * Converts a Punycode string of ASCII-only symbols to a string of Unicode
     * symbols.
     * @memberOf punycode
     * @param {String} input The Punycode string of ASCII-only symbols.
     * @returns {String} The resulting string of Unicode symbols.
     */
    function decode(input) {
        // Don't use UCS-2
        var output = [],
            inputLength = input.length,
            out,
            i = 0,
            n = initialN,
            bias = initialBias,
            basic,
            j,
            index,
            oldi,
            w,
            k,
            digit,
            t,
            /** Cached calculation results */
            baseMinusT;

        // Handle the basic code points: let `basic` be the number of input code
        // points before the last delimiter, or `0` if there is none, then copy
        // the first basic code points to the output.

        basic = input.lastIndexOf(delimiter);
        if (basic < 0) {
            basic = 0;
        }

        for (j = 0; j < basic; ++j) {
            // if it's not a basic code point
            if (input.charCodeAt(j) >= 0x80) {
                error('not-basic');
            }
            output.push(input.charCodeAt(j));
        }

        // Main decoding loop: start just after the last delimiter if any basic code
        // points were copied; start at the beginning otherwise.

        for (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {

            // `index` is the index of the next character to be consumed.
            // Decode a generalized variable-length integer into `delta`,
            // which gets added to `i`. The overflow checking is easier
            // if we increase `i` as we go, then subtract off its starting
            // value at the end to obtain `delta`.
            for (oldi = i, w = 1, k = base; /* no condition */; k += base) {

                if (index >= inputLength) {
                    error('invalid-input');
                }

                digit = basicToDigit(input.charCodeAt(index++));

                if (digit >= base || digit > floor((maxInt - i) / w)) {
                    error('overflow');
                }

                i += digit * w;
                t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);

                if (digit < t) {
                    break;
                }

                baseMinusT = base - t;
                if (w > floor(maxInt / baseMinusT)) {
                    error('overflow');
                }

                w *= baseMinusT;

            }

            out = output.length + 1;
            bias = adapt(i - oldi, out, oldi == 0);

            // `i` was supposed to wrap around from `out` to `0`,
            // incrementing `n` each time, so we'll fix that now:
            if (floor(i / out) > maxInt - n) {
                error('overflow');
            }

            n += floor(i / out);
            i %= out;

            // Insert `n` at position `i` of the output
            output.splice(i++, 0, n);

        }

        return ucs2encode(output);
    }

    /**
     * Converts a string of Unicode symbols to a Punycode string of ASCII-only
     * symbols.
     * @memberOf punycode
     * @param {String} input The string of Unicode symbols.
     * @returns {String} The resulting Punycode string of ASCII-only symbols.
     */
    function encode(input) {
        var n,
            delta,
            handledCPCount,
            basicLength,
            bias,
            j,
            m,
            q,
            k,
            t,
            currentValue,
            output = [],
            /** `inputLength` will hold the number of code points in `input`. */
            inputLength,
            /** Cached calculation results */
            handledCPCountPlusOne,
            baseMinusT,
            qMinusT;

        // Convert the input in UCS-2 to Unicode
        input = ucs2decode(input);

        // Cache the length
        inputLength = input.length;

        // Initialize the state
        n = initialN;
        delta = 0;
        bias = initialBias;

        // Handle the basic code points
        for (j = 0; j < inputLength; ++j) {
            currentValue = input[j];
            if (currentValue < 0x80) {
                output.push(stringFromCharCode(currentValue));
            }
        }

        handledCPCount = basicLength = output.length;

        // `handledCPCount` is the number of code points that have been handled;
        // `basicLength` is the number of basic code points.

        // Finish the basic string - if it is not empty - with a delimiter
        if (basicLength) {
            output.push(delimiter);
        }

        // Main encoding loop:
        while (handledCPCount < inputLength) {

            // All non-basic code points < n have been handled already. Find the next
            // larger one:
            for (m = maxInt, j = 0; j < inputLength; ++j) {
                currentValue = input[j];
                if (currentValue >= n && currentValue < m) {
                    m = currentValue;
                }
            }

            // Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,
            // but guard against overflow
            handledCPCountPlusOne = handledCPCount + 1;
            if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {
                error('overflow');
            }

            delta += (m - n) * handledCPCountPlusOne;
            n = m;

            for (j = 0; j < inputLength; ++j) {
                currentValue = input[j];

                if (currentValue < n && ++delta > maxInt) {
                    error('overflow');
                }

                if (currentValue == n) {
                    // Represent delta as a generalized variable-length integer
                    for (q = delta, k = base; /* no condition */; k += base) {
                        t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);
                        if (q < t) {
                            break;
                        }
                        qMinusT = q - t;
                        baseMinusT = base - t;
                        output.push(
                            stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))
                        );
                        q = floor(qMinusT / baseMinusT);
                    }

                    output.push(stringFromCharCode(digitToBasic(q, 0)));
                    bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
                    delta = 0;
                    ++handledCPCount;
                }
            }

            ++delta;
            ++n;

        }
        return output.join('');
    }

    /**
     * Converts a Punycode string representing a domain name to Unicode. Only the
     * Punycoded parts of the domain name will be converted, i.e. it doesn't
     * matter if you call it on a string that has already been converted to
     * Unicode.
     * @memberOf punycode
     * @param {String} domain The Punycode domain name to convert to Unicode.
     * @returns {String} The Unicode representation of the given Punycode
     * string.
     */
    function toUnicode(domain) {
        return mapDomain(domain, function(string) {
            return regexPunycode.test(string)
                ? decode(string.slice(4).toLowerCase())
                : string;
        });
    }

    /**
     * Converts a Unicode string representing a domain name to Punycode. Only the
     * non-ASCII parts of the domain name will be converted, i.e. it doesn't
     * matter if you call it with a domain that's already in ASCII.
     * @memberOf punycode
     * @param {String} domain The domain name to convert, as a Unicode string.
     * @returns {String} The Punycode representation of the given domain name.
     */
    function toASCII(domain) {
        return mapDomain(domain, function(string) {
            return regexNonASCII.test(string)
                ? 'xn--' + encode(string)
                : string;
        });
    }

    /*--------------------------------------------------------------------------*/

    /** Define the public API */
    punycode = {
        /**
         * A string representing the current Punycode.js version number.
         * @memberOf punycode
         * @type String
         */
        'version': '1.2.4',
        /**
         * An object of methods to convert from JavaScript's internal character
         * representation (UCS-2) to Unicode code points, and back.
         * @see <http://mathiasbynens.be/notes/javascript-encoding>
         * @memberOf punycode
         * @type Object
         */
        'ucs2': {
            'decode': ucs2decode,
            'encode': ucs2encode
        },
        'decode': decode,
        'encode': encode,
        'toASCII': toASCII,
        'toUnicode': toUnicode
    };

    /** Expose `punycode` */
    // Some AMD build optimizers, like r.js, check for specific condition patterns
    // like the following:
    if (
        typeof define == 'function' &&
        typeof define.amd == 'object' &&
        define.amd
    ) {
        define('punycode', function() {
            return punycode;
        });
    } else if (freeExports && !freeExports.nodeType) {
        if (freeModule) { // in Node.js or RingoJS v0.8.0+
            freeModule.exports = punycode;
        } else { // in Narwhal or RingoJS v0.7.0-
            for (key in punycode) {
                punycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);
            }
        }
    } else { // in Rhino or a web browser
        root.punycode = punycode;
    }

}(this));

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],2:[function(_dereq_,module,exports){
var log = _dereq_('./log');

function restoreOwnerScroll(ownerDocument, x, y) {
    if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {
        ownerDocument.defaultView.scrollTo(x, y);
    }
}

function cloneCanvasContents(canvas, clonedCanvas) {
    try {
        if (clonedCanvas) {
            clonedCanvas.width = canvas.width;
            clonedCanvas.height = canvas.height;
            clonedCanvas.getContext("2d").putImageData(canvas.getContext("2d").getImageData(0, 0, canvas.width, canvas.height), 0, 0);
        }
    } catch(e) {
        log("Unable to copy canvas content from", canvas, e);
    }
}

function cloneNode(node, javascriptEnabled) {
    var clone = node.nodeType === 3 ? document.createTextNode(node.nodeValue) : node.cloneNode(false);

    var child = node.firstChild;
    while(child) {
        if (javascriptEnabled === true || child.nodeType !== 1 || child.nodeName !== 'SCRIPT') {
            clone.appendChild(cloneNode(child, javascriptEnabled));
        }
        child = child.nextSibling;
    }

    if (node.nodeType === 1) {
        clone._scrollTop = node.scrollTop;
        clone._scrollLeft = node.scrollLeft;
        if (node.nodeName === "CANVAS") {
            cloneCanvasContents(node, clone);
        } else if (node.nodeName === "TEXTAREA" || node.nodeName === "SELECT") {
            clone.value = node.value;
        }
    }

    return clone;
}

function initNode(node) {
    if (node.nodeType === 1) {
        node.scrollTop = node._scrollTop;
        node.scrollLeft = node._scrollLeft;

        var child = node.firstChild;
        while(child) {
            initNode(child);
            child = child.nextSibling;
        }
    }
}

module.exports = function(ownerDocument, containerDocument, width, height, options, x ,y) {
    var documentElement = cloneNode(ownerDocument.documentElement, options.javascriptEnabled);
    var container = containerDocument.createElement("iframe");

    container.className = "html2canvas-container";
    container.style.visibility = "hidden";
    container.style.position = "fixed";
    container.style.left = "-10000px";
    container.style.top = "0px";
    container.style.border = "0";
    container.width = width;
    container.height = height;
    container.scrolling = "no"; // ios won't scroll without it
    containerDocument.body.appendChild(container);

    return new Promise(function(resolve) {
        var documentClone = container.contentWindow.document;

        /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle
         if window url is about:blank, we can assign the url to current by writing onto the document
         */
        container.contentWindow.onload = container.onload = function() {
            var interval = setInterval(function() {
                if (documentClone.body.childNodes.length > 0) {
                    initNode(documentClone.documentElement);
                    clearInterval(interval);
                    if (options.type === "view") {
                        container.contentWindow.scrollTo(x, y);
                        if ((/(iPad|iPhone|iPod)/g).test(navigator.userAgent) && (container.contentWindow.scrollY !== y || container.contentWindow.scrollX !== x)) {
                            documentClone.documentElement.style.top = (-y) + "px";
                            documentClone.documentElement.style.left = (-x) + "px";
                            documentClone.documentElement.style.position = 'absolute';
                        }
                    }
                    resolve(container);
                }
            }, 50);
        };

        documentClone.open();
        documentClone.write("<!DOCTYPE html><html></html>");
        // Chrome scrolls the parent document for some reason after the write to the cloned window???
        restoreOwnerScroll(ownerDocument, x, y);
        documentClone.replaceChild(documentClone.adoptNode(documentElement), documentClone.documentElement);
        documentClone.close();
    });
};

},{"./log":13}],3:[function(_dereq_,module,exports){
// http://dev.w3.org/csswg/css-color/

function Color(value) {
    this.r = 0;
    this.g = 0;
    this.b = 0;
    this.a = null;
    var result = this.fromArray(value) ||
        this.namedColor(value) ||
        this.rgb(value) ||
        this.rgba(value) ||
        this.hex6(value) ||
        this.hex3(value);
}

Color.prototype.darken = function(amount) {
    var a = 1 - amount;
    return  new Color([
        Math.round(this.r * a),
        Math.round(this.g * a),
        Math.round(this.b * a),
        this.a
    ]);
};

Color.prototype.isTransparent = function() {
    return this.a === 0;
};

Color.prototype.isBlack = function() {
    return this.r === 0 && this.g === 0 && this.b === 0;
};

Color.prototype.fromArray = function(array) {
    if (Array.isArray(array)) {
        this.r = Math.min(array[0], 255);
        this.g = Math.min(array[1], 255);
        this.b = Math.min(array[2], 255);
        if (array.length > 3) {
            this.a = array[3];
        }
    }

    return (Array.isArray(array));
};

var _hex3 = /^#([a-f0-9]{3})$/i;

Color.prototype.hex3 = function(value) {
    var match = null;
    if ((match = value.match(_hex3)) !== null) {
        this.r = parseInt(match[1][0] + match[1][0], 16);
        this.g = parseInt(match[1][1] + match[1][1], 16);
        this.b = parseInt(match[1][2] + match[1][2], 16);
    }
    return match !== null;
};

var _hex6 = /^#([a-f0-9]{6})$/i;

Color.prototype.hex6 = function(value) {
    var match = null;
    if ((match = value.match(_hex6)) !== null) {
        this.r = parseInt(match[1].substring(0, 2), 16);
        this.g = parseInt(match[1].substring(2, 4), 16);
        this.b = parseInt(match[1].substring(4, 6), 16);
    }
    return match !== null;
};


var _rgb = /^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;

Color.prototype.rgb = function(value) {
    var match = null;
    if ((match = value.match(_rgb)) !== null) {
        this.r = Number(match[1]);
        this.g = Number(match[2]);
        this.b = Number(match[3]);
    }
    return match !== null;
};

var _rgba = /^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;

Color.prototype.rgba = function(value) {
    var match = null;
    if ((match = value.match(_rgba)) !== null) {
        this.r = Number(match[1]);
        this.g = Number(match[2]);
        this.b = Number(match[3]);
        this.a = Number(match[4]);
    }
    return match !== null;
};

Color.prototype.toString = function() {
    return this.a !== null && this.a !== 1 ?
    "rgba(" + [this.r, this.g, this.b, this.a].join(",") + ")" :
    "rgb(" + [this.r, this.g, this.b].join(",") + ")";
};

Color.prototype.namedColor = function(value) {
    value = value.toLowerCase();
    var color = colors[value];
    if (color) {
        this.r = color[0];
        this.g = color[1];
        this.b = color[2];
    } else if (value === "transparent") {
        this.r = this.g = this.b = this.a = 0;
        return true;
    }

    return !!color;
};

Color.prototype.isColor = true;

// JSON.stringify([].slice.call($$('.named-color-table tr'), 1).map(function(row) { return [row.childNodes[3].textContent, row.childNodes[5].textContent.trim().split(",").map(Number)] }).reduce(function(data, row) {data[row[0]] = row[1]; return data}, {}))
var colors = {
    "aliceblue": [240, 248, 255],
    "antiquewhite": [250, 235, 215],
    "aqua": [0, 255, 255],
    "aquamarine": [127, 255, 212],
    "azure": [240, 255, 255],
    "beige": [245, 245, 220],
    "bisque": [255, 228, 196],
    "black": [0, 0, 0],
    "blanchedalmond": [255, 235, 205],
    "blue": [0, 0, 255],
    "blueviolet": [138, 43, 226],
    "brown": [165, 42, 42],
    "burlywood": [222, 184, 135],
    "cadetblue": [95, 158, 160],
    "chartreuse": [127, 255, 0],
    "chocolate": [210, 105, 30],
    "coral": [255, 127, 80],
    "cornflowerblue": [100, 149, 237],
    "cornsilk": [255, 248, 220],
    "crimson": [220, 20, 60],
    "cyan": [0, 255, 255],
    "darkblue": [0, 0, 139],
    "darkcyan": [0, 139, 139],
    "darkgoldenrod": [184, 134, 11],
    "darkgray": [169, 169, 169],
    "darkgreen": [0, 100, 0],
    "darkgrey": [169, 169, 169],
    "darkkhaki": [189, 183, 107],
    "darkmagenta": [139, 0, 139],
    "darkolivegreen": [85, 107, 47],
    "darkorange": [255, 140, 0],
    "darkorchid": [153, 50, 204],
    "darkred": [139, 0, 0],
    "darksalmon": [233, 150, 122],
    "darkseagreen": [143, 188, 143],
    "darkslateblue": [72, 61, 139],
    "darkslategray": [47, 79, 79],
    "darkslategrey": [47, 79, 79],
    "darkturquoise": [0, 206, 209],
    "darkviolet": [148, 0, 211],
    "deeppink": [255, 20, 147],
    "deepskyblue": [0, 191, 255],
    "dimgray": [105, 105, 105],
    "dimgrey": [105, 105, 105],
    "dodgerblue": [30, 144, 255],
    "firebrick": [178, 34, 34],
    "floralwhite": [255, 250, 240],
    "forestgreen": [34, 139, 34],
    "fuchsia": [255, 0, 255],
    "gainsboro": [220, 220, 220],
    "ghostwhite": [248, 248, 255],
    "gold": [255, 215, 0],
    "goldenrod": [218, 165, 32],
    "gray": [128, 128, 128],
    "green": [0, 128, 0],
    "greenyellow": [173, 255, 47],
    "grey": [128, 128, 128],
    "honeydew": [240, 255, 240],
    "hotpink": [255, 105, 180],
    "indianred": [205, 92, 92],
    "indigo": [75, 0, 130],
    "ivory": [255, 255, 240],
    "khaki": [240, 230, 140],
    "lavender": [230, 230, 250],
    "lavenderblush": [255, 240, 245],
    "lawngreen": [124, 252, 0],
    "lemonchiffon": [255, 250, 205],
    "lightblue": [173, 216, 230],
    "lightcoral": [240, 128, 128],
    "lightcyan": [224, 255, 255],
    "lightgoldenrodyellow": [250, 250, 210],
    "lightgray": [211, 211, 211],
    "lightgreen": [144, 238, 144],
    "lightgrey": [211, 211, 211],
    "lightpink": [255, 182, 193],
    "lightsalmon": [255, 160, 122],
    "lightseagreen": [32, 178, 170],
    "lightskyblue": [135, 206, 250],
    "lightslategray": [119, 136, 153],
    "lightslategrey": [119, 136, 153],
    "lightsteelblue": [176, 196, 222],
    "lightyellow": [255, 255, 224],
    "lime": [0, 255, 0],
    "limegreen": [50, 205, 50],
    "linen": [250, 240, 230],
    "magenta": [255, 0, 255],
    "maroon": [128, 0, 0],
    "mediumaquamarine": [102, 205, 170],
    "mediumblue": [0, 0, 205],
    "mediumorchid": [186, 85, 211],
    "mediumpurple": [147, 112, 219],
    "mediumseagreen": [60, 179, 113],
    "mediumslateblue": [123, 104, 238],
    "mediumspringgreen": [0, 250, 154],
    "mediumturquoise": [72, 209, 204],
    "mediumvioletred": [199, 21, 133],
    "midnightblue": [25, 25, 112],
    "mintcream": [245, 255, 250],
    "mistyrose": [255, 228, 225],
    "moccasin": [255, 228, 181],
    "navajowhite": [255, 222, 173],
    "navy": [0, 0, 128],
    "oldlace": [253, 245, 230],
    "olive": [128, 128, 0],
    "olivedrab": [107, 142, 35],
    "orange": [255, 165, 0],
    "orangered": [255, 69, 0],
    "orchid": [218, 112, 214],
    "palegoldenrod": [238, 232, 170],
    "palegreen": [152, 251, 152],
    "paleturquoise": [175, 238, 238],
    "palevioletred": [219, 112, 147],
    "papayawhip": [255, 239, 213],
    "peachpuff": [255, 218, 185],
    "peru": [205, 133, 63],
    "pink": [255, 192, 203],
    "plum": [221, 160, 221],
    "powderblue": [176, 224, 230],
    "purple": [128, 0, 128],
    "rebeccapurple": [102, 51, 153],
    "red": [255, 0, 0],
    "rosybrown": [188, 143, 143],
    "royalblue": [65, 105, 225],
    "saddlebrown": [139, 69, 19],
    "salmon": [250, 128, 114],
    "sandybrown": [244, 164, 96],
    "seagreen": [46, 139, 87],
    "seashell": [255, 245, 238],
    "sienna": [160, 82, 45],
    "silver": [192, 192, 192],
    "skyblue": [135, 206, 235],
    "slateblue": [106, 90, 205],
    "slategray": [112, 128, 144],
    "slategrey": [112, 128, 144],
    "snow": [255, 250, 250],
    "springgreen": [0, 255, 127],
    "steelblue": [70, 130, 180],
    "tan": [210, 180, 140],
    "teal": [0, 128, 128],
    "thistle": [216, 191, 216],
    "tomato": [255, 99, 71],
    "turquoise": [64, 224, 208],
    "violet": [238, 130, 238],
    "wheat": [245, 222, 179],
    "white": [255, 255, 255],
    "whitesmoke": [245, 245, 245],
    "yellow": [255, 255, 0],
    "yellowgreen": [154, 205, 50]
};

module.exports = Color;

},{}],4:[function(_dereq_,module,exports){
var Support = _dereq_('./support');
var CanvasRenderer = _dereq_('./renderers/canvas');
var ImageLoader = _dereq_('./imageloader');
var NodeParser = _dereq_('./nodeparser');
var NodeContainer = _dereq_('./nodecontainer');
var log = _dereq_('./log');
var utils = _dereq_('./utils');
var createWindowClone = _dereq_('./clone');
var loadUrlDocument = _dereq_('./proxy').loadUrlDocument;
var getBounds = utils.getBounds;

var html2canvasNodeAttribute = "data-html2canvas-node";
var html2canvasCloneIndex = 0;

function html2canvas(nodeList, options) {
    var index = html2canvasCloneIndex++;
    options = options || {};
    if (options.logging) {
        log.options.logging = true;
        log.options.start = Date.now();
    }

    options.async = typeof(options.async) === "undefined" ? true : options.async;
    options.allowTaint = typeof(options.allowTaint) === "undefined" ? false : options.allowTaint;
    options.removeContainer = typeof(options.removeContainer) === "undefined" ? true : options.removeContainer;
    options.javascriptEnabled = typeof(options.javascriptEnabled) === "undefined" ? false : options.javascriptEnabled;
    options.imageTimeout = typeof(options.imageTimeout) === "undefined" ? 10000 : options.imageTimeout;
    options.renderer = typeof(options.renderer) === "function" ? options.renderer : CanvasRenderer;
    options.strict = !!options.strict;

    if (typeof(nodeList) === "string") {
        if (typeof(options.proxy) !== "string") {
            return Promise.reject("Proxy must be used when rendering url");
        }
        var width = options.width != null ? options.width : window.innerWidth;
        var height = options.height != null ? options.height : window.innerHeight;
        return loadUrlDocument(absoluteUrl(nodeList), options.proxy, document, width, height, options).then(function(container) {
            return renderWindow(container.contentWindow.document.documentElement, container, options, width, height);
        });
    }

    var node = ((nodeList === undefined) ? [document.documentElement] : ((nodeList.length) ? nodeList : [nodeList]))[0];
    node.setAttribute(html2canvasNodeAttribute + index, index);
    return renderDocument(node.ownerDocument, options, node.ownerDocument.defaultView.innerWidth, node.ownerDocument.defaultView.innerHeight, index).then(function(canvas) {
        if (typeof(options.onrendered) === "function") {
            log("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas");
            options.onrendered(canvas);
        }
        return canvas;
    });
}

html2canvas.CanvasRenderer = CanvasRenderer;
html2canvas.NodeContainer = NodeContainer;
html2canvas.log = log;
html2canvas.utils = utils;

var html2canvasExport = (typeof(document) === "undefined" || typeof(Object.create) !== "function" || typeof(document.createElement("canvas").getContext) !== "function") ? function() {
    return Promise.reject("No canvas support");
} : html2canvas;

module.exports = html2canvasExport;

if (typeof(define) === 'function' && define.amd) {
    define('html2canvas', [], function() {
        return html2canvasExport;
    });
}

function renderDocument(document, options, windowWidth, windowHeight, html2canvasIndex) {
    return createWindowClone(document, document, windowWidth, windowHeight, options, document.defaultView.pageXOffset, document.defaultView.pageYOffset).then(function(container) {
        log("Document cloned");
        var attributeName = html2canvasNodeAttribute + html2canvasIndex;
        var selector = "[" + attributeName + "='" + html2canvasIndex + "']";
        document.querySelector(selector).removeAttribute(attributeName);
        var clonedWindow = container.contentWindow;
        var node = clonedWindow.document.querySelector(selector);
        var oncloneHandler = (typeof(options.onclone) === "function") ? Promise.resolve(options.onclone(clonedWindow.document)) : Promise.resolve(true);
        return oncloneHandler.then(function() {
            return renderWindow(node, container, options, windowWidth, windowHeight);
        });
    });
}

function renderWindow(node, container, options, windowWidth, windowHeight) {
    var clonedWindow = container.contentWindow;
    var support = new Support(clonedWindow.document);
    var imageLoader = new ImageLoader(options, support);
    var bounds = getBounds(node);
    var width = options.type === "view" ? windowWidth : documentWidth(clonedWindow.document);
    var height = options.type === "view" ? windowHeight : documentHeight(clonedWindow.document);
    var renderer = new options.renderer(width, height, imageLoader, options, document);
    var parser = new NodeParser(node, renderer, support, imageLoader, options);
    return parser.ready.then(function() {
        log("Finished rendering");
        var canvas;

        if (options.type === "view") {
            canvas = crop(renderer.canvas, {width: renderer.canvas.width, height: renderer.canvas.height, top: 0, left: 0, x: 0, y: 0});
        } else if (node === clonedWindow.document.body || node === clonedWindow.document.documentElement || options.canvas != null) {
            canvas = renderer.canvas;
        } else {
            canvas = crop(renderer.canvas, {width:  options.width != null ? options.width : bounds.width, height: options.height != null ? options.height : bounds.height, top: bounds.top, left: bounds.left, x: 0, y: 0});
        }

        cleanupContainer(container, options);
        return canvas;
    });
}

function cleanupContainer(container, options) {
    if (options.removeContainer) {
        container.parentNode.removeChild(container);
        log("Cleaned up container");
    }
}

function crop(canvas, bounds) {
    var croppedCanvas = document.createElement("canvas");
    var x1 = Math.min(canvas.width - 1, Math.max(0, bounds.left));
    var x2 = Math.min(canvas.width, Math.max(1, bounds.left + bounds.width));
    var y1 = Math.min(canvas.height - 1, Math.max(0, bounds.top));
    var y2 = Math.min(canvas.height, Math.max(1, bounds.top + bounds.height));
    croppedCanvas.width = bounds.width;
    croppedCanvas.height =  bounds.height;
    var width = x2-x1;
    var height = y2-y1;
    log("Cropping canvas at:", "left:", bounds.left, "top:", bounds.top, "width:", width, "height:", height);
    log("Resulting crop with width", bounds.width, "and height", bounds.height, "with x", x1, "and y", y1);
    croppedCanvas.getContext("2d").drawImage(canvas, x1, y1, width, height, bounds.x, bounds.y, width, height);
    return croppedCanvas;
}

function documentWidth (doc) {
    return Math.max(
        Math.max(doc.body.scrollWidth, doc.documentElement.scrollWidth),
        Math.max(doc.body.offsetWidth, doc.documentElement.offsetWidth),
        Math.max(doc.body.clientWidth, doc.documentElement.clientWidth)
    );
}

function documentHeight (doc) {
    return Math.max(
        Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight),
        Math.max(doc.body.offsetHeight, doc.documentElement.offsetHeight),
        Math.max(doc.body.clientHeight, doc.documentElement.clientHeight)
    );
}

function absoluteUrl(url) {
    var link = document.createElement("a");
    link.href = url;
    link.href = link.href;
    return link;
}

},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(_dereq_,module,exports){
var log = _dereq_('./log');
var smallImage = _dereq_('./utils').smallImage;

function DummyImageContainer(src) {
    this.src = src;
    log("DummyImageContainer for", src);
    if (!this.promise || !this.image) {
        log("Initiating DummyImageContainer");
        DummyImageContainer.prototype.image = new Image();
        var image = this.image;
        DummyImageContainer.prototype.promise = new Promise(function(resolve, reject) {
            image.onload = resolve;
            image.onerror = reject;
            image.src = smallImage();
            if (image.complete === true) {
                resolve(image);
            }
        });
    }
}

module.exports = DummyImageContainer;

},{"./log":13,"./utils":26}],6:[function(_dereq_,module,exports){
var smallImage = _dereq_('./utils').smallImage;

function Font(family, size) {
    var container = document.createElement('div'),
        img = document.createElement('img'),
        span = document.createElement('span'),
        sampleText = 'Hidden Text',
        baseline,
        middle;

    container.style.visibility = "hidden";
    container.style.fontFamily = family;
    container.style.fontSize = size;
    container.style.margin = 0;
    container.style.padding = 0;

    document.body.appendChild(container);

    img.src = smallImage();
    img.width = 1;
    img.height = 1;

    img.style.margin = 0;
    img.style.padding = 0;
    img.style.verticalAlign = "baseline";

    span.style.fontFamily = family;
    span.style.fontSize = size;
    span.style.margin = 0;
    span.style.padding = 0;

    span.appendChild(document.createTextNode(sampleText));
    container.appendChild(span);
    container.appendChild(img);
    baseline = (img.offsetTop - span.offsetTop) + 1;

    container.removeChild(span);
    container.appendChild(document.createTextNode(sampleText));

    container.style.lineHeight = "normal";
    img.style.verticalAlign = "super";

    middle = (img.offsetTop-container.offsetTop) + 1;

    document.body.removeChild(container);

    this.baseline = baseline;
    this.lineWidth = 1;
    this.middle = middle;
}

module.exports = Font;

},{"./utils":26}],7:[function(_dereq_,module,exports){
var Font = _dereq_('./font');

function FontMetrics() {
    this.data = {};
}

FontMetrics.prototype.getMetrics = function(family, size) {
    if (this.data[family + "-" + size] === undefined) {
        this.data[family + "-" + size] = new Font(family, size);
    }
    return this.data[family + "-" + size];
};

module.exports = FontMetrics;

},{"./font":6}],8:[function(_dereq_,module,exports){
var utils = _dereq_('./utils');
var getBounds = utils.getBounds;
var loadUrlDocument = _dereq_('./proxy').loadUrlDocument;

function FrameContainer(container, sameOrigin, options) {
    this.image = null;
    this.src = container;
    var self = this;
    var bounds = getBounds(container);
    this.promise = (!sameOrigin ? this.proxyLoad(options.proxy, bounds, options) : new Promise(function(resolve) {
        if (container.contentWindow.document.URL === "about:blank" || container.contentWindow.document.documentElement == null) {
            container.contentWindow.onload = container.onload = function() {
                resolve(container);
            };
        } else {
            resolve(container);
        }
    })).then(function(container) {
        var html2canvas = _dereq_('./core');
        return html2canvas(container.contentWindow.document.documentElement, {type: 'view', width: container.width, height: container.height, proxy: options.proxy, javascriptEnabled: options.javascriptEnabled, removeContainer: options.removeContainer, allowTaint: options.allowTaint, imageTimeout: options.imageTimeout / 2});
    }).then(function(canvas) {
        return self.image = canvas;
    });
}

FrameContainer.prototype.proxyLoad = function(proxy, bounds, options) {
    var container = this.src;
    return loadUrlDocument(container.src, proxy, container.ownerDocument, bounds.width, bounds.height, options);
};

module.exports = FrameContainer;

},{"./core":4,"./proxy":16,"./utils":26}],9:[function(_dereq_,module,exports){
function GradientContainer(imageData) {
    this.src = imageData.value;
    this.colorStops = [];
    this.type = null;
    this.x0 = 0.5;
    this.y0 = 0.5;
    this.x1 = 0.5;
    this.y1 = 0.5;
    this.promise = Promise.resolve(true);
}

GradientContainer.TYPES = {
    LINEAR: 1,
    RADIAL: 2
};

// TODO: support hsl[a], negative %/length values
// TODO: support <angle> (e.g. -?\d{1,3}(?:\.\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )
GradientContainer.REGEXP_COLORSTOP = /^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i;

module.exports = GradientContainer;

},{}],10:[function(_dereq_,module,exports){
function ImageContainer(src, cors) {
    this.src = src;
    this.image = new Image();
    var self = this;
    this.tainted = null;
    this.promise = new Promise(function(resolve, reject) {
        self.image.onload = resolve;
        self.image.onerror = reject;
        if (cors) {
            self.image.crossOrigin = "anonymous";
        }
        self.image.src = src;
        if (self.image.complete === true) {
            resolve(self.image);
        }
    });
}

module.exports = ImageContainer;

},{}],11:[function(_dereq_,module,exports){
var log = _dereq_('./log');
var ImageContainer = _dereq_('./imagecontainer');
var DummyImageContainer = _dereq_('./dummyimagecontainer');
var ProxyImageContainer = _dereq_('./proxyimagecontainer');
var FrameContainer = _dereq_('./framecontainer');
var SVGContainer = _dereq_('./svgcontainer');
var SVGNodeContainer = _dereq_('./svgnodecontainer');
var LinearGradientContainer = _dereq_('./lineargradientcontainer');
var WebkitGradientContainer = _dereq_('./webkitgradientcontainer');
var bind = _dereq_('./utils').bind;

function ImageLoader(options, support) {
    this.link = null;
    this.options = options;
    this.support = support;
    this.origin = this.getOrigin(window.location.href);
}

ImageLoader.prototype.findImages = function(nodes) {
    var images = [];
    nodes.reduce(function(imageNodes, container) {
        switch(container.node.nodeName) {
        case "IMG":
            return imageNodes.concat([{
                args: [container.node.src],
                method: "url"
            }]);
        case "svg":
        case "IFRAME":
            return imageNodes.concat([{
                args: [container.node],
                method: container.node.nodeName
            }]);
        }
        return imageNodes;
    }, []).forEach(this.addImage(images, this.loadImage), this);
    return images;
};

ImageLoader.prototype.findBackgroundImage = function(images, container) {
    container.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(images, this.loadImage), this);
    return images;
};

ImageLoader.prototype.addImage = function(images, callback) {
    return function(newImage) {
        newImage.args.forEach(function(image) {
            if (!this.imageExists(images, image)) {
                images.splice(0, 0, callback.call(this, newImage));
                log('Added image #' + (images.length), typeof(image) === "string" ? image.substring(0, 100) : image);
            }
        }, this);
    };
};

ImageLoader.prototype.hasImageBackground = function(imageData) {
    return imageData.method !== "none";
};

ImageLoader.prototype.loadImage = function(imageData) {
    if (imageData.method === "url") {
        var src = imageData.args[0];
        if (this.isSVG(src) && !this.support.svg && !this.options.allowTaint) {
            return new SVGContainer(src);
        } else if (src.match(/data:image\/.*;base64,/i)) {
            return new ImageContainer(src.replace(/url\(['"]{0,}|['"]{0,}\)$/ig, ''), false);
        } else if (this.isSameOrigin(src) || this.options.allowTaint === true || this.isSVG(src)) {
            return new ImageContainer(src, false);
        } else if (this.support.cors && !this.options.allowTaint && this.options.useCORS) {
            return new ImageContainer(src, true);
        } else if (this.options.proxy) {
            return new ProxyImageContainer(src, this.options.proxy);
        } else {
            return new DummyImageContainer(src);
        }
    } else if (imageData.method === "linear-gradient") {
        return new LinearGradientContainer(imageData);
    } else if (imageData.method === "gradient") {
        return new WebkitGradientContainer(imageData);
    } else if (imageData.method === "svg") {
        return new SVGNodeContainer(imageData.args[0], this.support.svg);
    } else if (imageData.method === "IFRAME") {
        return new FrameContainer(imageData.args[0], this.isSameOrigin(imageData.args[0].src), this.options);
    } else {
        return new DummyImageContainer(imageData);
    }
};

ImageLoader.prototype.isSVG = function(src) {
    return src.substring(src.length - 3).toLowerCase() === "svg" || SVGContainer.prototype.isInline(src);
};

ImageLoader.prototype.imageExists = function(images, src) {
    return images.some(function(image) {
        return image.src === src;
    });
};

ImageLoader.prototype.isSameOrigin = function(url) {
    return (this.getOrigin(url) === this.origin);
};

ImageLoader.prototype.getOrigin = function(url) {
    var link = this.link || (this.link = document.createElement("a"));
    link.href = url;
    link.href = link.href; // IE9, LOL! - http://jsfiddle.net/niklasvh/2e48b/
    return link.protocol + link.hostname + link.port;
};

ImageLoader.prototype.getPromise = function(container) {
    return this.timeout(container, this.options.imageTimeout)['catch'](function() {
        var dummy = new DummyImageContainer(container.src);
        return dummy.promise.then(function(image) {
            container.image = image;
        });
    });
};

ImageLoader.prototype.get = function(src) {
    var found = null;
    return this.images.some(function(img) {
        return (found = img).src === src;
    }) ? found : null;
};

ImageLoader.prototype.fetch = function(nodes) {
    this.images = nodes.reduce(bind(this.findBackgroundImage, this), this.findImages(nodes));
    this.images.forEach(function(image, index) {
        image.promise.then(function() {
            log("Succesfully loaded image #"+ (index+1), image);
        }, function(e) {
            log("Failed loading image #"+ (index+1), image, e);
        });
    });
    this.ready = Promise.all(this.images.map(this.getPromise, this));
    log("Finished searching images");
    return this;
};

ImageLoader.prototype.timeout = function(container, timeout) {
    var timer;
    var promise = Promise.race([container.promise, new Promise(function(res, reject) {
        timer = setTimeout(function() {
            log("Timed out loading image", container);
            reject(container);
        }, timeout);
    })]).then(function(container) {
        clearTimeout(timer);
        return container;
    });
    promise['catch'](function() {
        clearTimeout(timer);
    });
    return promise;
};

module.exports = ImageLoader;

},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(_dereq_,module,exports){
var GradientContainer = _dereq_('./gradientcontainer');
var Color = _dereq_('./color');

function LinearGradientContainer(imageData) {
    GradientContainer.apply(this, arguments);
    this.type = GradientContainer.TYPES.LINEAR;

    var hasDirection = LinearGradientContainer.REGEXP_DIRECTION.test( imageData.args[0] ) ||
        !GradientContainer.REGEXP_COLORSTOP.test( imageData.args[0] );

    if (hasDirection) {
        imageData.args[0].split(/\s+/).reverse().forEach(function(position, index) {
            switch(position) {
            case "left":
                this.x0 = 0;
                this.x1 = 1;
                break;
            case "top":
                this.y0 = 0;
                this.y1 = 1;
                break;
            case "right":
                this.x0 = 1;
                this.x1 = 0;
                break;
            case "bottom":
                this.y0 = 1;
                this.y1 = 0;
                break;
            case "to":
                var y0 = this.y0;
                var x0 = this.x0;
                this.y0 = this.y1;
                this.x0 = this.x1;
                this.x1 = x0;
                this.y1 = y0;
                break;
            case "center":
                break; // centered by default
            // Firefox internally converts position keywords to percentages:
            // http://www.w3.org/TR/2010/WD-CSS2-20101207/colors.html#propdef-background-position
            default: // percentage or absolute length
                // TODO: support absolute start point positions (e.g., use bounds to convert px to a ratio)
                var ratio = parseFloat(position, 10) * 1e-2;
                if (isNaN(ratio)) { // invalid or unhandled value
                    break;
                }
                if (index === 0) {
                    this.y0 = ratio;
                    this.y1 = 1 - this.y0;
                } else {
                    this.x0 = ratio;
                    this.x1 = 1 - this.x0;
                }
                break;
            }
        }, this);
    } else {
        this.y0 = 0;
        this.y1 = 1;
    }

    this.colorStops = imageData.args.slice(hasDirection ? 1 : 0).map(function(colorStop) {
        var colorStopMatch = colorStop.match(GradientContainer.REGEXP_COLORSTOP);
        var value = +colorStopMatch[2];
        var unit = value === 0 ? "%" : colorStopMatch[3]; // treat "0" as "0%"
        return {
            color: new Color(colorStopMatch[1]),
            // TODO: support absolute stop positions (e.g., compute gradient line length & convert px to ratio)
            stop: unit === "%" ? value / 100 : null
        };
    });

    if (this.colorStops[0].stop === null) {
        this.colorStops[0].stop = 0;
    }

    if (this.colorStops[this.colorStops.length - 1].stop === null) {
        this.colorStops[this.colorStops.length - 1].stop = 1;
    }

    // calculates and fills-in explicit stop positions when omitted from rule
    this.colorStops.forEach(function(colorStop, index) {
        if (colorStop.stop === null) {
            this.colorStops.slice(index).some(function(find, count) {
                if (find.stop !== null) {
                    colorStop.stop = ((find.stop - this.colorStops[index - 1].stop) / (count + 1)) + this.colorStops[index - 1].stop;
                    return true;
                } else {
                    return false;
                }
            }, this);
        }
    }, this);
}

LinearGradientContainer.prototype = Object.create(GradientContainer.prototype);

// TODO: support <angle> (e.g. -?\d{1,3}(?:\.\d+)deg, etc. : https://developer.mozilla.org/docs/Web/CSS/angle )
LinearGradientContainer.REGEXP_DIRECTION = /^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i;

module.exports = LinearGradientContainer;

},{"./color":3,"./gradientcontainer":9}],13:[function(_dereq_,module,exports){
var logger = function() {
    if (logger.options.logging && window.console && window.console.log) {
        Function.prototype.bind.call(window.console.log, (window.console)).apply(window.console, [(Date.now() - logger.options.start) + "ms", "html2canvas:"].concat([].slice.call(arguments, 0)));
    }
};

logger.options = {logging: false};
module.exports = logger;

},{}],14:[function(_dereq_,module,exports){
var Color = _dereq_('./color');
var utils = _dereq_('./utils');
var getBounds = utils.getBounds;
var parseBackgrounds = utils.parseBackgrounds;
var offsetBounds = utils.offsetBounds;

function NodeContainer(node, parent) {
    this.node = node;
    this.parent = parent;
    this.stack = null;
    this.bounds = null;
    this.borders = null;
    this.clip = [];
    this.backgroundClip = [];
    this.offsetBounds = null;
    this.visible = null;
    this.computedStyles = null;
    this.colors = {};
    this.styles = {};
    this.backgroundImages = null;
    this.transformData = null;
    this.transformMatrix = null;
    this.isPseudoElement = false;
    this.opacity = null;
}

NodeContainer.prototype.cloneTo = function(stack) {
    stack.visible = this.visible;
    stack.borders = this.borders;
    stack.bounds = this.bounds;
    stack.clip = this.clip;
    stack.backgroundClip = this.backgroundClip;
    stack.computedStyles = this.computedStyles;
    stack.styles = this.styles;
    stack.backgroundImages = this.backgroundImages;
    stack.opacity = this.opacity;
};

NodeContainer.prototype.getOpacity = function() {
    return this.opacity === null ? (this.opacity = this.cssFloat('opacity')) : this.opacity;
};

NodeContainer.prototype.assignStack = function(stack) {
    this.stack = stack;
    stack.children.push(this);
};

NodeContainer.prototype.isElementVisible = function() {
    return this.node.nodeType === Node.TEXT_NODE ? this.parent.visible : (
        this.css('display') !== "none" &&
        this.css('visibility') !== "hidden" &&
        !this.node.hasAttribute("data-html2canvas-ignore") &&
        (this.node.nodeName !== "INPUT" || this.node.getAttribute("type") !== "hidden")
    );
};

NodeContainer.prototype.css = function(attribute) {
    if (!this.computedStyles) {
        this.computedStyles = this.isPseudoElement ? this.parent.computedStyle(this.before ? ":before" : ":after") : this.computedStyle(null);
    }

    return this.styles[attribute] || (this.styles[attribute] = this.computedStyles[attribute]);
};

NodeContainer.prototype.prefixedCss = function(attribute) {
    var prefixes = ["webkit", "moz", "ms", "o"];
    var value = this.css(attribute);
    if (value === undefined) {
        prefixes.some(function(prefix) {
            value = this.css(prefix + attribute.substr(0, 1).toUpperCase() + attribute.substr(1));
            return value !== undefined;
        }, this);
    }
    return value === undefined ? null : value;
};

NodeContainer.prototype.computedStyle = function(type) {
    return this.node.ownerDocument.defaultView.getComputedStyle(this.node, type);
};

NodeContainer.prototype.cssInt = function(attribute) {
    var value = parseInt(this.css(attribute), 10);
    return (isNaN(value)) ? 0 : value; // borders in old IE are throwing 'medium' for demo.html
};

NodeContainer.prototype.color = function(attribute) {
    return this.colors[attribute] || (this.colors[attribute] = new Color(this.css(attribute)));
};

NodeContainer.prototype.cssFloat = function(attribute) {
    var value = parseFloat(this.css(attribute));
    return (isNaN(value)) ? 0 : value;
};

NodeContainer.prototype.fontWeight = function() {
    var weight = this.css("fontWeight");
    switch(parseInt(weight, 10)){
    case 401:
        weight = "bold";
        break;
    case 400:
        weight = "normal";
        break;
    }
    return weight;
};

NodeContainer.prototype.parseClip = function() {
    var matches = this.css('clip').match(this.CLIP);
    if (matches) {
        return {
            top: parseInt(matches[1], 10),
            right: parseInt(matches[2], 10),
            bottom: parseInt(matches[3], 10),
            left: parseInt(matches[4], 10)
        };
    }
    return null;
};

NodeContainer.prototype.parseBackgroundImages = function() {
    return this.backgroundImages || (this.backgroundImages = parseBackgrounds(this.css("backgroundImage")));
};

NodeContainer.prototype.cssList = function(property, index) {
    var value = (this.css(property) || '').split(',');
    value = value[index || 0] || value[0] || 'auto';
    value = value.trim().split(' ');
    if (value.length === 1) {
        value = [value[0], isPercentage(value[0]) ? 'auto' : value[0]];
    }
    return value;
};

NodeContainer.prototype.parseBackgroundSize = function(bounds, image, index) {
    var size = this.cssList("backgroundSize", index);
    var width, height;

    if (isPercentage(size[0])) {
        width = bounds.width * parseFloat(size[0]) / 100;
    } else if (/contain|cover/.test(size[0])) {
        var targetRatio = bounds.width / bounds.height, currentRatio = image.width / image.height;
        return (targetRatio < currentRatio ^ size[0] === 'contain') ?  {width: bounds.height * currentRatio, height: bounds.height} : {width: bounds.width, height: bounds.width / currentRatio};
    } else {
        width = parseInt(size[0], 10);
    }

    if (size[0] === 'auto' && size[1] === 'auto') {
        height = image.height;
    } else if (size[1] === 'auto') {
        height = width / image.width * image.height;
    } else if (isPercentage(size[1])) {
        height =  bounds.height * parseFloat(size[1]) / 100;
    } else {
        height = parseInt(size[1], 10);
    }

    if (size[0] === 'auto') {
        width = height / image.height * image.width;
    }

    return {width: width, height: height};
};

NodeContainer.prototype.parseBackgroundPosition = function(bounds, image, index, backgroundSize) {
    var position = this.cssList('backgroundPosition', index);
    var left, top;

    if (isPercentage(position[0])){
        left = (bounds.width - (backgroundSize || image).width) * (parseFloat(position[0]) / 100);
    } else {
        left = parseInt(position[0], 10);
    }

    if (position[1] === 'auto') {
        top = left / image.width * image.height;
    } else if (isPercentage(position[1])){
        top =  (bounds.height - (backgroundSize || image).height) * parseFloat(position[1]) / 100;
    } else {
        top = parseInt(position[1], 10);
    }

    if (position[0] === 'auto') {
        left = top / image.height * image.width;
    }

    return {left: left, top: top};
};

NodeContainer.prototype.parseBackgroundRepeat = function(index) {
    return this.cssList("backgroundRepeat", index)[0];
};

NodeContainer.prototype.parseTextShadows = function() {
    var textShadow = this.css("textShadow");
    var results = [];

    if (textShadow && textShadow !== 'none') {
        var shadows = textShadow.match(this.TEXT_SHADOW_PROPERTY);
        for (var i = 0; shadows && (i < shadows.length); i++) {
            var s = shadows[i].match(this.TEXT_SHADOW_VALUES);
            results.push({
                color: new Color(s[0]),
                offsetX: s[1] ? parseFloat(s[1].replace('px', '')) : 0,
                offsetY: s[2] ? parseFloat(s[2].replace('px', '')) : 0,
                blur: s[3] ? s[3].replace('px', '') : 0
            });
        }
    }
    return results;
};

NodeContainer.prototype.parseTransform = function() {
    if (!this.transformData) {
        if (this.hasTransform()) {
            var offset = this.parseBounds();
            var origin = this.prefixedCss("transformOrigin").split(" ").map(removePx).map(asFloat);
            origin[0] += offset.left;
            origin[1] += offset.top;
            this.transformData = {
                origin: origin,
                matrix: this.parseTransformMatrix()
            };
        } else {
            this.transformData = {
                origin: [0, 0],
                matrix: [1, 0, 0, 1, 0, 0]
            };
        }
    }
    return this.transformData;
};

NodeContainer.prototype.parseTransformMatrix = function() {
    if (!this.transformMatrix) {
        var transform = this.prefixedCss("transform");
        var matrix = transform ? parseMatrix(transform.match(this.MATRIX_PROPERTY)) : null;
        this.transformMatrix = matrix ? matrix : [1, 0, 0, 1, 0, 0];
    }
    return this.transformMatrix;
};

NodeContainer.prototype.parseBounds = function() {
    return this.bounds || (this.bounds = this.hasTransform() ? offsetBounds(this.node) : getBounds(this.node));
};

NodeContainer.prototype.hasTransform = function() {
    return this.parseTransformMatrix().join(",") !== "1,0,0,1,0,0" || (this.parent && this.parent.hasTransform());
};

NodeContainer.prototype.getValue = function() {
    var value = this.node.value || "";
    if (this.node.tagName === "SELECT") {
        value = selectionValue(this.node);
    } else if (this.node.type === "password") {
        value = Array(value.length + 1).join('\u2022'); // jshint ignore:line
    }
    return value.length === 0 ? (this.node.placeholder || "") : value;
};

NodeContainer.prototype.MATRIX_PROPERTY = /(matrix|matrix3d)\((.+)\)/;
NodeContainer.prototype.TEXT_SHADOW_PROPERTY = /((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g;
NodeContainer.prototype.TEXT_SHADOW_VALUES = /(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g;
NodeContainer.prototype.CLIP = /^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/;

function selectionValue(node) {
    var option = node.options[node.selectedIndex || 0];
    return option ? (option.text || "") : "";
}

function parseMatrix(match) {
    if (match && match[1] === "matrix") {
        return match[2].split(",").map(function(s) {
            return parseFloat(s.trim());
        });
    } else if (match && match[1] === "matrix3d") {
        var matrix3d = match[2].split(",").map(function(s) {
          return parseFloat(s.trim());
        });
        return [matrix3d[0], matrix3d[1], matrix3d[4], matrix3d[5], matrix3d[12], matrix3d[13]];
    }
}

function isPercentage(value) {
    return value.toString().indexOf("%") !== -1;
}

function removePx(str) {
    return str.replace("px", "");
}

function asFloat(str) {
    return parseFloat(str);
}

module.exports = NodeContainer;

},{"./color":3,"./utils":26}],15:[function(_dereq_,module,exports){
var log = _dereq_('./log');
var punycode = _dereq_('punycode');
var NodeContainer = _dereq_('./nodecontainer');
var TextContainer = _dereq_('./textcontainer');
var PseudoElementContainer = _dereq_('./pseudoelementcontainer');
var FontMetrics = _dereq_('./fontmetrics');
var Color = _dereq_('./color');
var StackingContext = _dereq_('./stackingcontext');
var utils = _dereq_('./utils');
var bind = utils.bind;
var getBounds = utils.getBounds;
var parseBackgrounds = utils.parseBackgrounds;
var offsetBounds = utils.offsetBounds;

function NodeParser(element, renderer, support, imageLoader, options) {
    log("Starting NodeParser");
    this.renderer = renderer;
    this.options = options;
    this.range = null;
    this.support = support;
    this.renderQueue = [];
    this.stack = new StackingContext(true, 1, element.ownerDocument, null);
    var parent = new NodeContainer(element, null);
    if (options.background) {
        renderer.rectangle(0, 0, renderer.width, renderer.height, new Color(options.background));
    }
    if (element === element.ownerDocument.documentElement) {
        // http://www.w3.org/TR/css3-background/#special-backgrounds
        var canvasBackground = new NodeContainer(parent.color('backgroundColor').isTransparent() ? element.ownerDocument.body : element.ownerDocument.documentElement, null);
        renderer.rectangle(0, 0, renderer.width, renderer.height, canvasBackground.color('backgroundColor'));
    }
    parent.visibile = parent.isElementVisible();
    this.createPseudoHideStyles(element.ownerDocument);
    this.disableAnimations(element.ownerDocument);
    this.nodes = flatten([parent].concat(this.getChildren(parent)).filter(function(container) {
        return container.visible = container.isElementVisible();
    }).map(this.getPseudoElements, this));
    this.fontMetrics = new FontMetrics();
    log("Fetched nodes, total:", this.nodes.length);
    log("Calculate overflow clips");
    this.calculateOverflowClips();
    log("Start fetching images");
    this.images = imageLoader.fetch(this.nodes.filter(isElement));
    this.ready = this.images.ready.then(bind(function() {
        log("Images loaded, starting parsing");
        log("Creating stacking contexts");
        this.createStackingContexts();
        log("Sorting stacking contexts");
        this.sortStackingContexts(this.stack);
        this.parse(this.stack);
        log("Render queue created with " + this.renderQueue.length + " items");
        return new Promise(bind(function(resolve) {
            if (!options.async) {
                this.renderQueue.forEach(this.paint, this);
                resolve();
            } else if (typeof(options.async) === "function") {
                options.async.call(this, this.renderQueue, resolve);
            } else if (this.renderQueue.length > 0){
                this.renderIndex = 0;
                this.asyncRenderer(this.renderQueue, resolve);
            } else {
                resolve();
            }
        }, this));
    }, this));
}

NodeParser.prototype.calculateOverflowClips = function() {
    this.nodes.forEach(function(container) {
        if (isElement(container)) {
            if (isPseudoElement(container)) {
                container.appendToDOM();
            }
            container.borders = this.parseBorders(container);
            var clip = (container.css('overflow') === "hidden") ? [container.borders.clip] : [];
            var cssClip = container.parseClip();
            if (cssClip && ["absolute", "fixed"].indexOf(container.css('position')) !== -1) {
                clip.push([["rect",
                        container.bounds.left + cssClip.left,
                        container.bounds.top + cssClip.top,
                        cssClip.right - cssClip.left,
                        cssClip.bottom - cssClip.top
                ]]);
            }
            container.clip = hasParentClip(container) ? container.parent.clip.concat(clip) : clip;
            container.backgroundClip = (container.css('overflow') !== "hidden") ? container.clip.concat([container.borders.clip]) : container.clip;
            if (isPseudoElement(container)) {
                container.cleanDOM();
            }
        } else if (isTextNode(container)) {
            container.clip = hasParentClip(container) ? container.parent.clip : [];
        }
        if (!isPseudoElement(container)) {
            container.bounds = null;
        }
    }, this);
};

function hasParentClip(container) {
    return container.parent && container.parent.clip.length;
}

NodeParser.prototype.asyncRenderer = function(queue, resolve, asyncTimer) {
    asyncTimer = asyncTimer || Date.now();
    this.paint(queue[this.renderIndex++]);
    if (queue.length === this.renderIndex) {
        resolve();
    } else if (asyncTimer + 20 > Date.now()) {
        this.asyncRenderer(queue, resolve, asyncTimer);
    } else {
        setTimeout(bind(function() {
            this.asyncRenderer(queue, resolve);
        }, this), 0);
    }
};

NodeParser.prototype.createPseudoHideStyles = function(document) {
    this.createStyles(document, '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ':before { content: "" !important; display: none !important; }' +
        '.' + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER + ':after { content: "" !important; display: none !important; }');
};

NodeParser.prototype.disableAnimations = function(document) {
    this.createStyles(document, '* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; ' +
        '-webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}');
};

NodeParser.prototype.createStyles = function(document, styles) {
    var hidePseudoElements = document.createElement('style');
    hidePseudoElements.innerHTML = styles;
    document.body.appendChild(hidePseudoElements);
};

NodeParser.prototype.getPseudoElements = function(container) {
    var nodes = [[container]];
    if (container.node.nodeType === Node.ELEMENT_NODE) {
        var before = this.getPseudoElement(container, ":before");
        var after = this.getPseudoElement(container, ":after");

        if (before) {
            nodes.push(before);
        }

        if (after) {
            nodes.push(after);
        }
    }
    return flatten(nodes);
};

function toCamelCase(str) {
    return str.replace(/(\-[a-z])/g, function(match){
        return match.toUpperCase().replace('-','');
    });
}

NodeParser.prototype.getPseudoElement = function(container, type) {
    var style = container.computedStyle(type);
    if(!style || !style.content || style.content === "none" || style.content === "-moz-alt-content" || style.display === "none") {
        return null;
    }

    var content = stripQuotes(style.content);
    var isImage = content.substr(0, 3) === 'url';
    var pseudoNode = document.createElement(isImage ? 'img' : 'html2canvaspseudoelement');
    var pseudoContainer = new PseudoElementContainer(pseudoNode, container, type);

    for (var i = style.length-1; i >= 0; i--) {
        var property = toCamelCase(style.item(i));
        pseudoNode.style[property] = style[property];
    }

    pseudoNode.className = PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + " " + PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER;

    if (isImage) {
        pseudoNode.src = parseBackgrounds(content)[0].args[0];
        return [pseudoContainer];
    } else {
        var text = document.createTextNode(content);
        pseudoNode.appendChild(text);
        return [pseudoContainer, new TextContainer(text, pseudoContainer)];
    }
};


NodeParser.prototype.getChildren = function(parentContainer) {
    return flatten([].filter.call(parentContainer.node.childNodes, renderableNode).map(function(node) {
        var container = [node.nodeType === Node.TEXT_NODE ? new TextContainer(node, parentContainer) : new NodeContainer(node, parentContainer)].filter(nonIgnoredElement);
        return node.nodeType === Node.ELEMENT_NODE && container.length && node.tagName !== "TEXTAREA" ? (container[0].isElementVisible() ? container.concat(this.getChildren(container[0])) : []) : container;
    }, this));
};

NodeParser.prototype.newStackingContext = function(container, hasOwnStacking) {
    var stack = new StackingContext(hasOwnStacking, container.getOpacity(), container.node, container.parent);
    container.cloneTo(stack);
    var parentStack = hasOwnStacking ? stack.getParentStack(this) : stack.parent.stack;
    parentStack.contexts.push(stack);
    container.stack = stack;
};

NodeParser.prototype.createStackingContexts = function() {
    this.nodes.forEach(function(container) {
        if (isElement(container) && (this.isRootElement(container) || hasOpacity(container) || isPositionedForStacking(container) || this.isBodyWithTransparentRoot(container) || container.hasTransform())) {
            this.newStackingContext(container, true);
        } else if (isElement(container) && ((isPositioned(container) && zIndex0(container)) || isInlineBlock(container) || isFloating(container))) {
            this.newStackingContext(container, false);
        } else {
            container.assignStack(container.parent.stack);
        }
    }, this);
};

NodeParser.prototype.isBodyWithTransparentRoot = function(container) {
    return container.node.nodeName === "BODY" && container.parent.color('backgroundColor').isTransparent();
};

NodeParser.prototype.isRootElement = function(container) {
    return container.parent === null;
};

NodeParser.prototype.sortStackingContexts = function(stack) {
    stack.contexts.sort(zIndexSort(stack.contexts.slice(0)));
    stack.contexts.forEach(this.sortStackingContexts, this);
};

NodeParser.prototype.parseTextBounds = function(container) {
    return function(text, index, textList) {
        if (container.parent.css("textDecoration").substr(0, 4) !== "none" || text.trim().length !== 0) {
            if (this.support.rangeBounds && !container.parent.hasTransform()) {
                var offset = textList.slice(0, index).join("").length;
                return this.getRangeBounds(container.node, offset, text.length);
            } else if (container.node && typeof(container.node.data) === "string") {
                var replacementNode = container.node.splitText(text.length);
                var bounds = this.getWrapperBounds(container.node, container.parent.hasTransform());
                container.node = replacementNode;
                return bounds;
            }
        } else if(!this.support.rangeBounds || container.parent.hasTransform()){
            container.node = container.node.splitText(text.length);
        }
        return {};
    };
};

NodeParser.prototype.getWrapperBounds = function(node, transform) {
    var wrapper = node.ownerDocument.createElement('html2canvaswrapper');
    var parent = node.parentNode,
        backupText = node.cloneNode(true);

    wrapper.appendChild(node.cloneNode(true));
    parent.replaceChild(wrapper, node);
    var bounds = transform ? offsetBounds(wrapper) : getBounds(wrapper);
    parent.replaceChild(backupText, wrapper);
    return bounds;
};

NodeParser.prototype.getRangeBounds = function(node, offset, length) {
    var range = this.range || (this.range = node.ownerDocument.createRange());
    range.setStart(node, offset);
    range.setEnd(node, offset + length);
    return range.getBoundingClientRect();
};

function ClearTransform() {}

NodeParser.prototype.parse = function(stack) {
    // http://www.w3.org/TR/CSS21/visuren.html#z-index
    var negativeZindex = stack.contexts.filter(negativeZIndex); // 2. the child stacking contexts with negative stack levels (most negative first).
    var descendantElements = stack.children.filter(isElement);
    var descendantNonFloats = descendantElements.filter(not(isFloating));
    var nonInlineNonPositionedDescendants = descendantNonFloats.filter(not(isPositioned)).filter(not(inlineLevel)); // 3 the in-flow, non-inline-level, non-positioned descendants.
    var nonPositionedFloats = descendantElements.filter(not(isPositioned)).filter(isFloating); // 4. the non-positioned floats.
    var inFlow = descendantNonFloats.filter(not(isPositioned)).filter(inlineLevel); // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.
    var stackLevel0 = stack.contexts.concat(descendantNonFloats.filter(isPositioned)).filter(zIndex0); // 6. the child stacking contexts with stack level 0 and the positioned descendants with stack level 0.
    var text = stack.children.filter(isTextNode).filter(hasText);
    var positiveZindex = stack.contexts.filter(positiveZIndex); // 7. the child stacking contexts with positive stack levels (least positive first).
    negativeZindex.concat(nonInlineNonPositionedDescendants).concat(nonPositionedFloats)
        .concat(inFlow).concat(stackLevel0).concat(text).concat(positiveZindex).forEach(function(container) {
            this.renderQueue.push(container);
            if (isStackingContext(container)) {
                this.parse(container);
                this.renderQueue.push(new ClearTransform());
            }
        }, this);
};

NodeParser.prototype.paint = function(container) {
    try {
        if (container instanceof ClearTransform) {
            this.renderer.ctx.restore();
        } else if (isTextNode(container)) {
            if (isPseudoElement(container.parent)) {
                container.parent.appendToDOM();
            }
            this.paintText(container);
            if (isPseudoElement(container.parent)) {
                container.parent.cleanDOM();
            }
        } else {
            this.paintNode(container);
        }
    } catch(e) {
        log(e);
        if (this.options.strict) {
            throw e;
        }
    }
};

NodeParser.prototype.paintNode = function(container) {
    if (isStackingContext(container)) {
        this.renderer.setOpacity(container.opacity);
        this.renderer.ctx.save();
        if (container.hasTransform()) {
            this.renderer.setTransform(container.parseTransform());
        }
    }

    if (container.node.nodeName === "INPUT" && container.node.type === "checkbox") {
        this.paintCheckbox(container);
    } else if (container.node.nodeName === "INPUT" && container.node.type === "radio") {
        this.paintRadio(container);
    } else {
        this.paintElement(container);
    }
};

NodeParser.prototype.paintElement = function(container) {
    var bounds = container.parseBounds();
    this.renderer.clip(container.backgroundClip, function() {
        this.renderer.renderBackground(container, bounds, container.borders.borders.map(getWidth));
    }, this);

    this.renderer.clip(container.clip, function() {
        this.renderer.renderBorders(container.borders.borders);
    }, this);

    this.renderer.clip(container.backgroundClip, function() {
        switch (container.node.nodeName) {
        case "svg":
        case "IFRAME":
            var imgContainer = this.images.get(container.node);
            if (imgContainer) {
                this.renderer.renderImage(container, bounds, container.borders, imgContainer);
            } else {
                log("Error loading <" + container.node.nodeName + ">", container.node);
            }
            break;
        case "IMG":
            var imageContainer = this.images.get(container.node.src);
            if (imageContainer) {
                this.renderer.renderImage(container, bounds, container.borders, imageContainer);
            } else {
                log("Error loading <img>", container.node.src);
            }
            break;
        case "CANVAS":
            this.renderer.renderImage(container, bounds, container.borders, {image: container.node});
            break;
        case "SELECT":
        case "INPUT":
        case "TEXTAREA":
            this.paintFormValue(container);
            break;
        }
    }, this);
};

NodeParser.prototype.paintCheckbox = function(container) {
    var b = container.parseBounds();

    var size = Math.min(b.width, b.height);
    var bounds = {width: size - 1, height: size - 1, top: b.top, left: b.left};
    var r = [3, 3];
    var radius = [r, r, r, r];
    var borders = [1,1,1,1].map(function(w) {
        return {color: new Color('#A5A5A5'), width: w};
    });

    var borderPoints = calculateCurvePoints(bounds, radius, borders);

    this.renderer.clip(container.backgroundClip, function() {
        this.renderer.rectangle(bounds.left + 1, bounds.top + 1, bounds.width - 2, bounds.height - 2, new Color("#DEDEDE"));
        this.renderer.renderBorders(calculateBorders(borders, bounds, borderPoints, radius));
        if (container.node.checked) {
            this.renderer.font(new Color('#424242'), 'normal', 'normal', 'bold', (size - 3) + "px", 'arial');
            this.renderer.text("\u2714", bounds.left + size / 6, bounds.top + size - 1);
        }
    }, this);
};

NodeParser.prototype.paintRadio = function(container) {
    var bounds = container.parseBounds();

    var size = Math.min(bounds.width, bounds.height) - 2;

    this.renderer.clip(container.backgroundClip, function() {
        this.renderer.circleStroke(bounds.left + 1, bounds.top + 1, size, new Color('#DEDEDE'), 1, new Color('#A5A5A5'));
        if (container.node.checked) {
            this.renderer.circle(Math.ceil(bounds.left + size / 4) + 1, Math.ceil(bounds.top + size / 4) + 1, Math.floor(size / 2), new Color('#424242'));
        }
    }, this);
};

NodeParser.prototype.paintFormValue = function(container) {
    var value = container.getValue();
    if (value.length > 0) {
        var document = container.node.ownerDocument;
        var wrapper = document.createElement('html2canvaswrapper');
        var properties = ['lineHeight', 'textAlign', 'fontFamily', 'fontWeight', 'fontSize', 'color',
            'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom',
            'width', 'height', 'borderLeftStyle', 'borderTopStyle', 'borderLeftWidth', 'borderTopWidth',
            'boxSizing', 'whiteSpace', 'wordWrap'];

        properties.forEach(function(property) {
            try {
                wrapper.style[property] = container.css(property);
            } catch(e) {
                // Older IE has issues with "border"
                log("html2canvas: Parse: Exception caught in renderFormValue: " + e.message);
            }
        });
        var bounds = container.parseBounds();
        wrapper.style.position = "fixed";
        wrapper.style.left = bounds.left + "px";
        wrapper.style.top = bounds.top + "px";
        wrapper.textContent = value;
        document.body.appendChild(wrapper);
        this.paintText(new TextContainer(wrapper.firstChild, container));
        document.body.removeChild(wrapper);
    }
};

NodeParser.prototype.paintText = function(container) {
    container.applyTextTransform();
    var characters = punycode.ucs2.decode(container.node.data);
    var textList = (!this.options.letterRendering || noLetterSpacing(container)) && !hasUnicode(container.node.data) ? getWords(characters) : characters.map(function(character) {
        return punycode.ucs2.encode([character]);
    });

    var weight = container.parent.fontWeight();
    var size = container.parent.css('fontSize');
    var family = container.parent.css('fontFamily');
    var shadows = container.parent.parseTextShadows();

    this.renderer.font(container.parent.color('color'), container.parent.css('fontStyle'), container.parent.css('fontVariant'), weight, size, family);
    if (shadows.length) {
        // TODO: support multiple text shadows
        this.renderer.fontShadow(shadows[0].color, shadows[0].offsetX, shadows[0].offsetY, shadows[0].blur);
    } else {
        this.renderer.clearShadow();
    }

    this.renderer.clip(container.parent.clip, function() {
        textList.map(this.parseTextBounds(container), this).forEach(function(bounds, index) {
            if (bounds) {
                this.renderer.text(textList[index], bounds.left, bounds.bottom);
                this.renderTextDecoration(container.parent, bounds, this.fontMetrics.getMetrics(family, size));
            }
        }, this);
    }, this);
};

NodeParser.prototype.renderTextDecoration = function(container, bounds, metrics) {
    switch(container.css("textDecoration").split(" ")[0]) {
    case "underline":
        // Draws a line at the baseline of the font
        // TODO As some browsers display the line as more than 1px if the font-size is big, need to take that into account both in position and size
        this.renderer.rectangle(bounds.left, Math.round(bounds.top + metrics.baseline + metrics.lineWidth), bounds.width, 1, container.color("color"));
        break;
    case "overline":
        this.renderer.rectangle(bounds.left, Math.round(bounds.top), bounds.width, 1, container.color("color"));
        break;
    case "line-through":
        // TODO try and find exact position for line-through
        this.renderer.rectangle(bounds.left, Math.ceil(bounds.top + metrics.middle + metrics.lineWidth), bounds.width, 1, container.color("color"));
        break;
    }
};

var borderColorTransforms = {
    inset: [
        ["darken", 0.60],
        ["darken", 0.10],
        ["darken", 0.10],
        ["darken", 0.60]
    ]
};

NodeParser.prototype.parseBorders = function(container) {
    var nodeBounds = container.parseBounds();
    var radius = getBorderRadiusData(container);
    var borders = ["Top", "Right", "Bottom", "Left"].map(function(side, index) {
        var style = container.css('border' + side + 'Style');
        var color = container.color('border' + side + 'Color');
        if (style === "inset" && color.isBlack()) {
            color = new Color([255, 255, 255, color.a]); // this is wrong, but
        }
        var colorTransform = borderColorTransforms[style] ? borderColorTransforms[style][index] : null;
        return {
            width: container.cssInt('border' + side + 'Width'),
            color: colorTransform ? color[colorTransform[0]](colorTransform[1]) : color,
            args: null
        };
    });
    var borderPoints = calculateCurvePoints(nodeBounds, radius, borders);

    return {
        clip: this.parseBackgroundClip(container, borderPoints, borders, radius, nodeBounds),
        borders: calculateBorders(borders, nodeBounds, borderPoints, radius)
    };
};

function calculateBorders(borders, nodeBounds, borderPoints, radius) {
    return borders.map(function(border, borderSide) {
        if (border.width > 0) {
            var bx = nodeBounds.left;
            var by = nodeBounds.top;
            var bw = nodeBounds.width;
            var bh = nodeBounds.height - (borders[2].width);

            switch(borderSide) {
            case 0:
                // top border
                bh = borders[0].width;
                border.args = drawSide({
                        c1: [bx, by],
                        c2: [bx + bw, by],
                        c3: [bx + bw - borders[1].width, by + bh],
                        c4: [bx + borders[3].width, by + bh]
                    }, radius[0], radius[1],
                    borderPoints.topLeftOuter, borderPoints.topLeftInner, borderPoints.topRightOuter, borderPoints.topRightInner);
                break;
            case 1:
                // right border
                bx = nodeBounds.left + nodeBounds.width - (borders[1].width);
                bw = borders[1].width;

                border.args = drawSide({
                        c1: [bx + bw, by],
                        c2: [bx + bw, by + bh + borders[2].width],
                        c3: [bx, by + bh],
                        c4: [bx, by + borders[0].width]
                    }, radius[1], radius[2],
                    borderPoints.topRightOuter, borderPoints.topRightInner, borderPoints.bottomRightOuter, borderPoints.bottomRightInner);
                break;
            case 2:
                // bottom border
                by = (by + nodeBounds.height) - (borders[2].width);
                bh = borders[2].width;
                border.args = drawSide({
                        c1: [bx + bw, by + bh],
                        c2: [bx, by + bh],
                        c3: [bx + borders[3].width, by],
                        c4: [bx + bw - borders[3].width, by]
                    }, radius[2], radius[3],
                    borderPoints.bottomRightOuter, borderPoints.bottomRightInner, borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner);
                break;
            case 3:
                // left border
                bw = borders[3].width;
                border.args = drawSide({
                        c1: [bx, by + bh + borders[2].width],
                        c2: [bx, by],
                        c3: [bx + bw, by + borders[0].width],
                        c4: [bx + bw, by + bh]
                    }, radius[3], radius[0],
                    borderPoints.bottomLeftOuter, borderPoints.bottomLeftInner, borderPoints.topLeftOuter, borderPoints.topLeftInner);
                break;
            }
        }
        return border;
    });
}

NodeParser.prototype.parseBackgroundClip = function(container, borderPoints, borders, radius, bounds) {
    var backgroundClip = container.css('backgroundClip'),
        borderArgs = [];

    switch(backgroundClip) {
    case "content-box":
    case "padding-box":
        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftInner, borderPoints.topRightInner, bounds.left + borders[3].width, bounds.top + borders[0].width);
        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightInner, borderPoints.bottomRightInner, bounds.left + bounds.width - borders[1].width, bounds.top + borders[0].width);
        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightInner, borderPoints.bottomLeftInner, bounds.left + bounds.width - borders[1].width, bounds.top + bounds.height - borders[2].width);
        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftInner, borderPoints.topLeftInner, bounds.left + borders[3].width, bounds.top + bounds.height - borders[2].width);
        break;

    default:
        parseCorner(borderArgs, radius[0], radius[1], borderPoints.topLeftOuter, borderPoints.topRightOuter, bounds.left, bounds.top);
        parseCorner(borderArgs, radius[1], radius[2], borderPoints.topRightOuter, borderPoints.bottomRightOuter, bounds.left + bounds.width, bounds.top);
        parseCorner(borderArgs, radius[2], radius[3], borderPoints.bottomRightOuter, borderPoints.bottomLeftOuter, bounds.left + bounds.width, bounds.top + bounds.height);
        parseCorner(borderArgs, radius[3], radius[0], borderPoints.bottomLeftOuter, borderPoints.topLeftOuter, bounds.left, bounds.top + bounds.height);
        break;
    }

    return borderArgs;
};

function getCurvePoints(x, y, r1, r2) {
    var kappa = 4 * ((Math.sqrt(2) - 1) / 3);
    var ox = (r1) * kappa, // control point offset horizontal
        oy = (r2) * kappa, // control point offset vertical
        xm = x + r1, // x-middle
        ym = y + r2; // y-middle
    return {
        topLeft: bezierCurve({x: x, y: ym}, {x: x, y: ym - oy}, {x: xm - ox, y: y}, {x: xm, y: y}),
        topRight: bezierCurve({x: x, y: y}, {x: x + ox,y: y}, {x: xm, y: ym - oy}, {x: xm, y: ym}),
        bottomRight: bezierCurve({x: xm, y: y}, {x: xm, y: y + oy}, {x: x + ox, y: ym}, {x: x, y: ym}),
        bottomLeft: bezierCurve({x: xm, y: ym}, {x: xm - ox, y: ym}, {x: x, y: y + oy}, {x: x, y:y})
    };
}

function calculateCurvePoints(bounds, borderRadius, borders) {
    var x = bounds.left,
        y = bounds.top,
        width = bounds.width,
        height = bounds.height,

        tlh = borderRadius[0][0] < width / 2 ? borderRadius[0][0] : width / 2,
        tlv = borderRadius[0][1] < height / 2 ? borderRadius[0][1] : height / 2,
        trh = borderRadius[1][0] < width / 2 ? borderRadius[1][0] : width / 2,
        trv = borderRadius[1][1] < height / 2 ? borderRadius[1][1] : height / 2,
        brh = borderRadius[2][0] < width / 2 ? borderRadius[2][0] : width / 2,
        brv = borderRadius[2][1] < height / 2 ? borderRadius[2][1] : height / 2,
        blh = borderRadius[3][0] < width / 2 ? borderRadius[3][0] : width / 2,
        blv = borderRadius[3][1] < height / 2 ? borderRadius[3][1] : height / 2;

    var topWidth = width - trh,
        rightHeight = height - brv,
        bottomWidth = width - brh,
        leftHeight = height - blv;

    return {
        topLeftOuter: getCurvePoints(x, y, tlh, tlv).topLeft.subdivide(0.5),
        topLeftInner: getCurvePoints(x + borders[3].width, y + borders[0].width, Math.max(0, tlh - borders[3].width), Math.max(0, tlv - borders[0].width)).topLeft.subdivide(0.5),
        topRightOuter: getCurvePoints(x + topWidth, y, trh, trv).topRight.subdivide(0.5),
        topRightInner: getCurvePoints(x + Math.min(topWidth, width + borders[3].width), y + borders[0].width, (topWidth > width + borders[3].width) ? 0 :trh - borders[3].width, trv - borders[0].width).topRight.subdivide(0.5),
        bottomRightOuter: getCurvePoints(x + bottomWidth, y + rightHeight, brh, brv).bottomRight.subdivide(0.5),
        bottomRightInner: getCurvePoints(x + Math.min(bottomWidth, width - borders[3].width), y + Math.min(rightHeight, height + borders[0].width), Math.max(0, brh - borders[1].width),  brv - borders[2].width).bottomRight.subdivide(0.5),
        bottomLeftOuter: getCurvePoints(x, y + leftHeight, blh, blv).bottomLeft.subdivide(0.5),
        bottomLeftInner: getCurvePoints(x + borders[3].width, y + leftHeight, Math.max(0, blh - borders[3].width), blv - borders[2].width).bottomLeft.subdivide(0.5)
    };
}

function bezierCurve(start, startControl, endControl, end) {
    var lerp = function (a, b, t) {
        return {
            x: a.x + (b.x - a.x) * t,
            y: a.y + (b.y - a.y) * t
        };
    };

    return {
        start: start,
        startControl: startControl,
        endControl: endControl,
        end: end,
        subdivide: function(t) {
            var ab = lerp(start, startControl, t),
                bc = lerp(startControl, endControl, t),
                cd = lerp(endControl, end, t),
                abbc = lerp(ab, bc, t),
                bccd = lerp(bc, cd, t),
                dest = lerp(abbc, bccd, t);
            return [bezierCurve(start, ab, abbc, dest), bezierCurve(dest, bccd, cd, end)];
        },
        curveTo: function(borderArgs) {
            borderArgs.push(["bezierCurve", startControl.x, startControl.y, endControl.x, endControl.y, end.x, end.y]);
        },
        curveToReversed: function(borderArgs) {
            borderArgs.push(["bezierCurve", endControl.x, endControl.y, startControl.x, startControl.y, start.x, start.y]);
        }
    };
}

function drawSide(borderData, radius1, radius2, outer1, inner1, outer2, inner2) {
    var borderArgs = [];

    if (radius1[0] > 0 || radius1[1] > 0) {
        borderArgs.push(["line", outer1[1].start.x, outer1[1].start.y]);
        outer1[1].curveTo(borderArgs);
    } else {
        borderArgs.push([ "line", borderData.c1[0], borderData.c1[1]]);
    }

    if (radius2[0] > 0 || radius2[1] > 0) {
        borderArgs.push(["line", outer2[0].start.x, outer2[0].start.y]);
        outer2[0].curveTo(borderArgs);
        borderArgs.push(["line", inner2[0].end.x, inner2[0].end.y]);
        inner2[0].curveToReversed(borderArgs);
    } else {
        borderArgs.push(["line", borderData.c2[0], borderData.c2[1]]);
        borderArgs.push(["line", borderData.c3[0], borderData.c3[1]]);
    }

    if (radius1[0] > 0 || radius1[1] > 0) {
        borderArgs.push(["line", inner1[1].end.x, inner1[1].end.y]);
        inner1[1].curveToReversed(borderArgs);
    } else {
        borderArgs.push(["line", borderData.c4[0], borderData.c4[1]]);
    }

    return borderArgs;
}

function parseCorner(borderArgs, radius1, radius2, corner1, corner2, x, y) {
    if (radius1[0] > 0 || radius1[1] > 0) {
        borderArgs.push(["line", corner1[0].start.x, corner1[0].start.y]);
        corner1[0].curveTo(borderArgs);
        corner1[1].curveTo(borderArgs);
    } else {
        borderArgs.push(["line", x, y]);
    }

    if (radius2[0] > 0 || radius2[1] > 0) {
        borderArgs.push(["line", corner2[0].start.x, corner2[0].start.y]);
    }
}

function negativeZIndex(container) {
    return container.cssInt("zIndex") < 0;
}

function positiveZIndex(container) {
    return container.cssInt("zIndex") > 0;
}

function zIndex0(container) {
    return container.cssInt("zIndex") === 0;
}

function inlineLevel(container) {
    return ["inline", "inline-block", "inline-table"].indexOf(container.css("display")) !== -1;
}

function isStackingContext(container) {
    return (container instanceof StackingContext);
}

function hasText(container) {
    return container.node.data.trim().length > 0;
}

function noLetterSpacing(container) {
    return (/^(normal|none|0px)$/.test(container.parent.css("letterSpacing")));
}

function getBorderRadiusData(container) {
    return ["TopLeft", "TopRight", "BottomRight", "BottomLeft"].map(function(side) {
        var value = container.css('border' + side + 'Radius');
        var arr = value.split(" ");
        if (arr.length <= 1) {
            arr[1] = arr[0];
        }
        return arr.map(asInt);
    });
}

function renderableNode(node) {
    return (node.nodeType === Node.TEXT_NODE || node.nodeType === Node.ELEMENT_NODE);
}

function isPositionedForStacking(container) {
    var position = container.css("position");
    var zIndex = (["absolute", "relative", "fixed"].indexOf(position) !== -1) ? container.css("zIndex") : "auto";
    return zIndex !== "auto";
}

function isPositioned(container) {
    return container.css("position") !== "static";
}

function isFloating(container) {
    return container.css("float") !== "none";
}

function isInlineBlock(container) {
    return ["inline-block", "inline-table"].indexOf(container.css("display")) !== -1;
}

function not(callback) {
    var context = this;
    return function() {
        return !callback.apply(context, arguments);
    };
}

function isElement(container) {
    return container.node.nodeType === Node.ELEMENT_NODE;
}

function isPseudoElement(container) {
    return container.isPseudoElement === true;
}

function isTextNode(container) {
    return container.node.nodeType === Node.TEXT_NODE;
}

function zIndexSort(contexts) {
    return function(a, b) {
        return (a.cssInt("zIndex") + (contexts.indexOf(a) / contexts.length)) - (b.cssInt("zIndex") + (contexts.indexOf(b) / contexts.length));
    };
}

function hasOpacity(container) {
    return container.getOpacity() < 1;
}

function asInt(value) {
    return parseInt(value, 10);
}

function getWidth(border) {
    return border.width;
}

function nonIgnoredElement(nodeContainer) {
    return (nodeContainer.node.nodeType !== Node.ELEMENT_NODE || ["SCRIPT", "HEAD", "TITLE", "OBJECT", "BR", "OPTION"].indexOf(nodeContainer.node.nodeName) === -1);
}

function flatten(arrays) {
    return [].concat.apply([], arrays);
}

function stripQuotes(content) {
    var first = content.substr(0, 1);
    return (first === content.substr(content.length - 1) && first.match(/'|"/)) ? content.substr(1, content.length - 2) : content;
}

function getWords(characters) {
    var words = [], i = 0, onWordBoundary = false, word;
    while(characters.length) {
        if (isWordBoundary(characters[i]) === onWordBoundary) {
            word = characters.splice(0, i);
            if (word.length) {
                words.push(punycode.ucs2.encode(word));
            }
            onWordBoundary =! onWordBoundary;
            i = 0;
        } else {
            i++;
        }

        if (i >= characters.length) {
            word = characters.splice(0, i);
            if (word.length) {
                words.push(punycode.ucs2.encode(word));
            }
        }
    }
    return words;
}

function isWordBoundary(characterCode) {
    return [
        32, // <space>
        13, // \r
        10, // \n
        9, // \t
        45 // -
    ].indexOf(characterCode) !== -1;
}

function hasUnicode(string) {
    return (/[^\u0000-\u00ff]/).test(string);
}

module.exports = NodeParser;

},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,"punycode":1}],16:[function(_dereq_,module,exports){
var XHR = _dereq_('./xhr');
var utils = _dereq_('./utils');
var log = _dereq_('./log');
var createWindowClone = _dereq_('./clone');
var decode64 = utils.decode64;

function Proxy(src, proxyUrl, document) {
    var supportsCORS = ('withCredentials' in new XMLHttpRequest());
    if (!proxyUrl) {
        return Promise.reject("No proxy configured");
    }
    var callback = createCallback(supportsCORS);
    var url = createProxyUrl(proxyUrl, src, callback);

    return supportsCORS ? XHR(url) : (jsonp(document, url, callback).then(function(response) {
        return decode64(response.content);
    }));
}
var proxyCount = 0;

function ProxyURL(src, proxyUrl, document) {
    var supportsCORSImage = ('crossOrigin' in new Image());
    var callback = createCallback(supportsCORSImage);
    var url = createProxyUrl(proxyUrl, src, callback);
    return (supportsCORSImage ? Promise.resolve(url) : jsonp(document, url, callback).then(function(response) {
        return "data:" + response.type + ";base64," + response.content;
    }));
}

function jsonp(document, url, callback) {
    return new Promise(function(resolve, reject) {
        var s = document.createElement("script");
        var cleanup = function() {
            delete window.OfficeBrowserFeedback.html2canvas.proxy[callback];
            document.body.removeChild(s);
        };
        window.OfficeBrowserFeedback.html2canvas.proxy[callback] = function (response) {
            cleanup();
            resolve(response);
        };
        s.src = url;
        s.onerror = function(e) {
            cleanup();
            reject(e);
        };
        document.body.appendChild(s);
    });
}

function createCallback(useCORS) {
    return !useCORS ? "html2canvas_" + Date.now() + "_" + (++proxyCount) + "_" + Math.round(Math.random() * 100000) : "";
}

function createProxyUrl(proxyUrl, src, callback) {
    return proxyUrl + "?url=" + encodeURIComponent(src) + (callback.length ? "&callback=html2canvas.proxy." + callback : "");
}

function documentFromHTML(src) {
    return function(html) {
        var parser = new DOMParser(), doc;
        try {
            doc = parser.parseFromString(html, "text/html");
        } catch(e) {
            log("DOMParser not supported, falling back to createHTMLDocument");
            doc = document.implementation.createHTMLDocument("");
            try {
                doc.open();
                doc.write(html);
                doc.close();
            } catch(ee) {
                log("createHTMLDocument write not supported, falling back to document.body.innerHTML");
                doc.body.innerHTML = html; // ie9 doesnt support writing to documentElement
            }
        }

        var b = doc.querySelector("base");
        if (!b || !b.href.host) {
            var base = doc.createElement("base");
            base.href = src;
            doc.head.insertBefore(base, doc.head.firstChild);
        }

        return doc;
    };
}

function loadUrlDocument(src, proxy, document, width, height, options) {
    return new Proxy(src, proxy, window.document).then(documentFromHTML(src)).then(function(doc) {
        return createWindowClone(doc, document, width, height, options, 0, 0);
    });
}

exports.Proxy = Proxy;
exports.ProxyURL = ProxyURL;
exports.loadUrlDocument = loadUrlDocument;

},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(_dereq_,module,exports){
var ProxyURL = _dereq_('./proxy').ProxyURL;

function ProxyImageContainer(src, proxy) {
    var link = document.createElement("a");
    link.href = src;
    src = link.href;
    this.src = src;
    this.image = new Image();
    var self = this;
    this.promise = new Promise(function(resolve, reject) {
        self.image.crossOrigin = "Anonymous";
        self.image.onload = resolve;
        self.image.onerror = reject;

        new ProxyURL(src, proxy, document).then(function(url) {
            self.image.src = url;
        })['catch'](reject);
    });
}

module.exports = ProxyImageContainer;

},{"./proxy":16}],18:[function(_dereq_,module,exports){
var NodeContainer = _dereq_('./nodecontainer');

function PseudoElementContainer(node, parent, type) {
    NodeContainer.call(this, node, parent);
    this.isPseudoElement = true;
    this.before = type === ":before";
}

PseudoElementContainer.prototype.cloneTo = function(stack) {
    PseudoElementContainer.prototype.cloneTo.call(this, stack);
    stack.isPseudoElement = true;
    stack.before = this.before;
};

PseudoElementContainer.prototype = Object.create(NodeContainer.prototype);

PseudoElementContainer.prototype.appendToDOM = function() {
    if (this.before) {
        this.parent.node.insertBefore(this.node, this.parent.node.firstChild);
    } else {
        this.parent.node.appendChild(this.node);
    }
    this.parent.node.className += " " + this.getHideClass();
};

PseudoElementContainer.prototype.cleanDOM = function() {
    this.node.parentNode.removeChild(this.node);
    this.parent.node.className = this.parent.node.className.replace(this.getHideClass(), "");
};

PseudoElementContainer.prototype.getHideClass = function() {
    return this["PSEUDO_HIDE_ELEMENT_CLASS_" + (this.before ? "BEFORE" : "AFTER")];
};

PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = "___html2canvas___pseudoelement_before";
PseudoElementContainer.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER = "___html2canvas___pseudoelement_after";

module.exports = PseudoElementContainer;

},{"./nodecontainer":14}],19:[function(_dereq_,module,exports){
var log = _dereq_('./log');

function Renderer(width, height, images, options, document) {
    this.width = width;
    this.height = height;
    this.images = images;
    this.options = options;
    this.document = document;
}

Renderer.prototype.renderImage = function(container, bounds, borderData, imageContainer) {
    var paddingLeft = container.cssInt('paddingLeft'),
        paddingTop = container.cssInt('paddingTop'),
        paddingRight = container.cssInt('paddingRight'),
        paddingBottom = container.cssInt('paddingBottom'),
        borders = borderData.borders;

    var width = bounds.width - (borders[1].width + borders[3].width + paddingLeft + paddingRight);
    var height = bounds.height - (borders[0].width + borders[2].width + paddingTop + paddingBottom);
    this.drawImage(
        imageContainer,
        0,
        0,
        imageContainer.image.width || width,
        imageContainer.image.height || height,
        bounds.left + paddingLeft + borders[3].width,
        bounds.top + paddingTop + borders[0].width,
        width,
        height
    );
};

Renderer.prototype.renderBackground = function(container, bounds, borderData) {
    if (bounds.height > 0 && bounds.width > 0) {
        this.renderBackgroundColor(container, bounds);
        this.renderBackgroundImage(container, bounds, borderData);
    }
};

Renderer.prototype.renderBackgroundColor = function(container, bounds) {
    var color = container.color("backgroundColor");
    if (!color.isTransparent()) {
        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, color);
    }
};

Renderer.prototype.renderBorders = function(borders) {
    borders.forEach(this.renderBorder, this);
};

Renderer.prototype.renderBorder = function(data) {
    if (!data.color.isTransparent() && data.args !== null) {
        this.drawShape(data.args, data.color);
    }
};

Renderer.prototype.renderBackgroundImage = function(container, bounds, borderData) {
    var backgroundImages = container.parseBackgroundImages();
    backgroundImages.reverse().forEach(function(backgroundImage, index, arr) {
        switch(backgroundImage.method) {
        case "url":
            var image = this.images.get(backgroundImage.args[0]);
            if (image) {
                this.renderBackgroundRepeating(container, bounds, image, arr.length - (index+1), borderData);
            } else {
                log("Error loading background-image", backgroundImage.args[0]);
            }
            break;
        case "linear-gradient":
        case "gradient":
            var gradientImage = this.images.get(backgroundImage.value);
            if (gradientImage) {
                this.renderBackgroundGradient(gradientImage, bounds, borderData);
            } else {
                log("Error loading background-image", backgroundImage.args[0]);
            }
            break;
        case "none":
            break;
        default:
            log("Unknown background-image type", backgroundImage.args[0]);
        }
    }, this);
};

Renderer.prototype.renderBackgroundRepeating = function(container, bounds, imageContainer, index, borderData) {
    var size = container.parseBackgroundSize(bounds, imageContainer.image, index);
    var position = container.parseBackgroundPosition(bounds, imageContainer.image, index, size);
    var repeat = container.parseBackgroundRepeat(index);
    switch (repeat) {
    case "repeat-x":
    case "repeat no-repeat":
        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + borderData[3], bounds.top + position.top + borderData[0], 99999, size.height, borderData);
        break;
    case "repeat-y":
    case "no-repeat repeat":
        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + borderData[0], size.width, 99999, borderData);
        break;
    case "no-repeat":
        this.backgroundRepeatShape(imageContainer, position, size, bounds, bounds.left + position.left + borderData[3], bounds.top + position.top + borderData[0], size.width, size.height, borderData);
        break;
    default:
        this.renderBackgroundRepeat(imageContainer, position, size, {top: bounds.top, left: bounds.left}, borderData[3], borderData[0]);
        break;
    }
};

module.exports = Renderer;

},{"./log":13}],20:[function(_dereq_,module,exports){
var Renderer = _dereq_('../renderer');
var LinearGradientContainer = _dereq_('../lineargradientcontainer');
var log = _dereq_('../log');

function CanvasRenderer(width, height) {
    Renderer.apply(this, arguments);
    this.canvas = this.options.canvas || this.document.createElement("canvas");
    if (!this.options.canvas) {
        this.canvas.width = width;
        this.canvas.height = height;
    }
    this.ctx = this.canvas.getContext("2d");
    this.taintCtx = this.document.createElement("canvas").getContext("2d");
    this.ctx.textBaseline = "bottom";
    this.variables = {};
    log("Initialized CanvasRenderer with size", width, "x", height);
}

CanvasRenderer.prototype = Object.create(Renderer.prototype);

CanvasRenderer.prototype.setFillStyle = function(fillStyle) {
    this.ctx.fillStyle = typeof(fillStyle) === "object" && !!fillStyle.isColor ? fillStyle.toString() : fillStyle;
    return this.ctx;
};

CanvasRenderer.prototype.rectangle = function(left, top, width, height, color) {
    this.setFillStyle(color).fillRect(left, top, width, height);
};

CanvasRenderer.prototype.circle = function(left, top, size, color) {
    this.setFillStyle(color);
    this.ctx.beginPath();
    this.ctx.arc(left + size / 2, top + size / 2, size / 2, 0, Math.PI*2, true);
    this.ctx.closePath();
    this.ctx.fill();
};

CanvasRenderer.prototype.circleStroke = function(left, top, size, color, stroke, strokeColor) {
    this.circle(left, top, size, color);
    this.ctx.strokeStyle = strokeColor.toString();
    this.ctx.stroke();
};

CanvasRenderer.prototype.drawShape = function(shape, color) {
    this.shape(shape);
    this.setFillStyle(color).fill();
};

CanvasRenderer.prototype.taints = function(imageContainer) {
    if (imageContainer.tainted === null) {
        this.taintCtx.drawImage(imageContainer.image, 0, 0);
        try {
            this.taintCtx.getImageData(0, 0, 1, 1);
            imageContainer.tainted = false;
        } catch(e) {
            this.taintCtx = document.createElement("canvas").getContext("2d");
            imageContainer.tainted = true;
        }
    }

    return imageContainer.tainted;
};

CanvasRenderer.prototype.drawImage = function(imageContainer, sx, sy, sw, sh, dx, dy, dw, dh) {
    if (!this.taints(imageContainer) || this.options.allowTaint) {
        this.ctx.drawImage(imageContainer.image, sx, sy, sw, sh, dx, dy, dw, dh);
    }
};

CanvasRenderer.prototype.clip = function(shapes, callback, context) {
    this.ctx.save();
    shapes.filter(hasEntries).forEach(function(shape) {
        this.shape(shape).clip();
    }, this);
    callback.call(context);
    this.ctx.restore();
};

CanvasRenderer.prototype.shape = function(shape) {
    this.ctx.beginPath();
    shape.forEach(function(point, index) {
        if (point[0] === "rect") {
            this.ctx.rect.apply(this.ctx, point.slice(1));
        } else {
            this.ctx[(index === 0) ? "moveTo" : point[0] + "To" ].apply(this.ctx, point.slice(1));
        }
    }, this);
    this.ctx.closePath();
    return this.ctx;
};

CanvasRenderer.prototype.font = function(color, style, variant, weight, size, family) {
    this.setFillStyle(color).font = [style, variant, weight, size, family].join(" ").split(",")[0];
};

CanvasRenderer.prototype.fontShadow = function(color, offsetX, offsetY, blur) {
    this.setVariable("shadowColor", color.toString())
        .setVariable("shadowOffsetY", offsetX)
        .setVariable("shadowOffsetX", offsetY)
        .setVariable("shadowBlur", blur);
};

CanvasRenderer.prototype.clearShadow = function() {
    this.setVariable("shadowColor", "rgba(0,0,0,0)");
};

CanvasRenderer.prototype.setOpacity = function(opacity) {
    this.ctx.globalAlpha = opacity;
};

CanvasRenderer.prototype.setTransform = function(transform) {
    this.ctx.translate(transform.origin[0], transform.origin[1]);
    this.ctx.transform.apply(this.ctx, transform.matrix);
    this.ctx.translate(-transform.origin[0], -transform.origin[1]);
};

CanvasRenderer.prototype.setVariable = function(property, value) {
    if (this.variables[property] !== value) {
        this.variables[property] = this.ctx[property] = value;
    }

    return this;
};

CanvasRenderer.prototype.text = function(text, left, bottom) {
    this.ctx.fillText(text, left, bottom);
};

CanvasRenderer.prototype.backgroundRepeatShape = function(imageContainer, backgroundPosition, size, bounds, left, top, width, height, borderData) {
    var shape = [
        ["line", Math.round(left), Math.round(top)],
        ["line", Math.round(left + width), Math.round(top)],
        ["line", Math.round(left + width), Math.round(height + top)],
        ["line", Math.round(left), Math.round(height + top)]
    ];
    this.clip([shape], function() {
        this.renderBackgroundRepeat(imageContainer, backgroundPosition, size, bounds, borderData[3], borderData[0]);
    }, this);
};

CanvasRenderer.prototype.renderBackgroundRepeat = function(imageContainer, backgroundPosition, size, bounds, borderLeft, borderTop) {
    var offsetX = Math.round(bounds.left + backgroundPosition.left + borderLeft), offsetY = Math.round(bounds.top + backgroundPosition.top + borderTop);
    this.setFillStyle(this.ctx.createPattern(this.resizeImage(imageContainer, size), "repeat"));
    this.ctx.translate(offsetX, offsetY);
    this.ctx.fill();
    this.ctx.translate(-offsetX, -offsetY);
};

CanvasRenderer.prototype.renderBackgroundGradient = function(gradientImage, bounds) {
    if (gradientImage instanceof LinearGradientContainer) {
        var gradient = this.ctx.createLinearGradient(
            bounds.left + bounds.width * gradientImage.x0,
            bounds.top + bounds.height * gradientImage.y0,
            bounds.left +  bounds.width * gradientImage.x1,
            bounds.top +  bounds.height * gradientImage.y1);
        gradientImage.colorStops.forEach(function(colorStop) {
            gradient.addColorStop(colorStop.stop, colorStop.color.toString());
        });
        this.rectangle(bounds.left, bounds.top, bounds.width, bounds.height, gradient);
    }
};

CanvasRenderer.prototype.resizeImage = function(imageContainer, size) {
    var image = imageContainer.image;
    if(image.width === size.width && image.height === size.height) {
        return image;
    }

    var ctx, canvas = document.createElement('canvas');
    canvas.width = size.width;
    canvas.height = size.height;
    ctx = canvas.getContext("2d");
    ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size.width, size.height );
    return canvas;
};

function hasEntries(array) {
    return array.length > 0;
}

module.exports = CanvasRenderer;

},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(_dereq_,module,exports){
var NodeContainer = _dereq_('./nodecontainer');

function StackingContext(hasOwnStacking, opacity, element, parent) {
    NodeContainer.call(this, element, parent);
    this.ownStacking = hasOwnStacking;
    this.contexts = [];
    this.children = [];
    this.opacity = (this.parent ? this.parent.stack.opacity : 1) * opacity;
}

StackingContext.prototype = Object.create(NodeContainer.prototype);

StackingContext.prototype.getParentStack = function(context) {
    var parentStack = (this.parent) ? this.parent.stack : null;
    return parentStack ? (parentStack.ownStacking ? parentStack : parentStack.getParentStack(context)) : context.stack;
};

module.exports = StackingContext;

},{"./nodecontainer":14}],22:[function(_dereq_,module,exports){
function Support(document) {
    this.rangeBounds = this.testRangeBounds(document);
    this.cors = this.testCORS();
    this.svg = this.testSVG();
}

Support.prototype.testRangeBounds = function(document) {
    var range, testElement, rangeBounds, rangeHeight, support = false;

    if (document.createRange) {
        range = document.createRange();
        if (range.getBoundingClientRect) {
            testElement = document.createElement('boundtest');
            testElement.style.height = "123px";
            testElement.style.display = "block";
            document.body.appendChild(testElement);

            range.selectNode(testElement);
            rangeBounds = range.getBoundingClientRect();
            rangeHeight = rangeBounds.height;

            if (rangeHeight === 123) {
                support = true;
            }
            document.body.removeChild(testElement);
        }
    }

    return support;
};

Support.prototype.testCORS = function() {
    return typeof((new Image()).crossOrigin) !== "undefined";
};

Support.prototype.testSVG = function() {
    var img = new Image();
    var canvas = document.createElement("canvas");
    var ctx =  canvas.getContext("2d");
    img.src = "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";

    try {
        ctx.drawImage(img, 0, 0);
        canvas.toDataURL();
    } catch(e) {
        return false;
    }
    return true;
};

module.exports = Support;

},{}],23:[function(_dereq_,module,exports){
var XHR = _dereq_('./xhr');
var decode64 = _dereq_('./utils').decode64;

function SVGContainer(src) {
    this.src = src;
    this.image = null;
    var self = this;

    this.promise = this.hasFabric().then(function() {
        return (self.isInline(src) ? Promise.resolve(self.inlineFormatting(src)) : XHR(src));
    }).then(function(svg) {
        return new Promise(function(resolve) {
            window.OfficeBrowserFeedback.html2canvas.svg.fabric.loadSVGFromString(svg, self.createCanvas.call(self, resolve));
        });
    });
}

SVGContainer.prototype.hasFabric = function() {
    return !window.OfficeBrowserFeedback.html2canvas.svg || !window.OfficeBrowserFeedback.html2canvas.svg.fabric ? Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg")) : Promise.resolve();
};

SVGContainer.prototype.inlineFormatting = function(src) {
    return (/^data:image\/svg\+xml;base64,/.test(src)) ? this.decode64(this.removeContentType(src)) : this.removeContentType(src);
};

SVGContainer.prototype.removeContentType = function(src) {
    return src.replace(/^data:image\/svg\+xml(;base64)?,/,'');
};

SVGContainer.prototype.isInline = function(src) {
    return (/^data:image\/svg\+xml/i.test(src));
};

SVGContainer.prototype.createCanvas = function(resolve) {
    var self = this;
    return function (objects, options) {
        var canvas = new window.OfficeBrowserFeedback.html2canvas.svg.fabric.StaticCanvas('c');
        self.image = canvas.lowerCanvasEl;
        canvas
            .setWidth(options.width)
            .setHeight(options.height)
            .add(window.OfficeBrowserFeedback.html2canvas.svg.fabric.util.groupSVGElements(objects, options))
            .renderAll();
        resolve(canvas.lowerCanvasEl);
    };
};

SVGContainer.prototype.decode64 = function(str) {
    return (typeof(window.atob) === "function") ? window.atob(str) : decode64(str);
};

module.exports = SVGContainer;

},{"./utils":26,"./xhr":28}],24:[function(_dereq_,module,exports){
var SVGContainer = _dereq_('./svgcontainer');

function SVGNodeContainer(node, _native) {
    this.src = node;
    this.image = null;
    var self = this;

    this.promise = _native ? new Promise(function(resolve, reject) {
        self.image = new Image();
        self.image.onload = resolve;
        self.image.onerror = reject;
        self.image.src = "data:image/svg+xml," + (new XMLSerializer()).serializeToString(node);
        if (self.image.complete === true) {
            resolve(self.image);
        }
    }) : this.hasFabric().then(function() {
        return new Promise(function(resolve) {
            window.OfficeBrowserFeedback.html2canvas.svg.fabric.parseSVGDocument(node, self.createCanvas.call(self, resolve));
        });
    });
}

SVGNodeContainer.prototype = Object.create(SVGContainer.prototype);

module.exports = SVGNodeContainer;

},{"./svgcontainer":23}],25:[function(_dereq_,module,exports){
var NodeContainer = _dereq_('./nodecontainer');

function TextContainer(node, parent) {
    NodeContainer.call(this, node, parent);
}

TextContainer.prototype = Object.create(NodeContainer.prototype);

TextContainer.prototype.applyTextTransform = function() {
    this.node.data = this.transform(this.parent.css("textTransform"));
};

TextContainer.prototype.transform = function(transform) {
    var text = this.node.data;
    switch(transform){
        case "lowercase":
            return text.toLowerCase();
        case "capitalize":
            return text.replace(/(^|\s|:|-|\(|\))([a-z])/g, capitalize);
        case "uppercase":
            return text.toUpperCase();
        default:
            return text;
    }
};

function capitalize(m, p1, p2) {
    if (m.length > 0) {
        return p1 + p2.toUpperCase();
    }
}

module.exports = TextContainer;

},{"./nodecontainer":14}],26:[function(_dereq_,module,exports){
exports.smallImage = function smallImage() {
    return "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
};

exports.bind = function(callback, context) {
    return function() {
        return callback.apply(context, arguments);
    };
};

/*
 * base64-arraybuffer
 * https://github.com/niklasvh/base64-arraybuffer
 *
 * Copyright (c) 2012 Niklas von Hertzen
 * Licensed under the MIT license.
 */

exports.decode64 = function(base64) {
    var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    var len = base64.length, i, encoded1, encoded2, encoded3, encoded4, byte1, byte2, byte3;

    var output = "";

    for (i = 0; i < len; i+=4) {
        encoded1 = chars.indexOf(base64[i]);
        encoded2 = chars.indexOf(base64[i+1]);
        encoded3 = chars.indexOf(base64[i+2]);
        encoded4 = chars.indexOf(base64[i+3]);

        byte1 = (encoded1 << 2) | (encoded2 >> 4);
        byte2 = ((encoded2 & 15) << 4) | (encoded3 >> 2);
        byte3 = ((encoded3 & 3) << 6) | encoded4;
        if (encoded3 === 64) {
            output += String.fromCharCode(byte1);
        } else if (encoded4 === 64 || encoded4 === -1) {
            output += String.fromCharCode(byte1, byte2);
        } else{
            output += String.fromCharCode(byte1, byte2, byte3);
        }
    }

    return output;
};

exports.getBounds = function(node) {
    if (node.getBoundingClientRect) {
        var clientRect = node.getBoundingClientRect();
        var width = node.offsetWidth == null ? clientRect.width : node.offsetWidth;
        return {
            top: clientRect.top,
            bottom: clientRect.bottom || (clientRect.top + clientRect.height),
            right: clientRect.left + width,
            left: clientRect.left,
            width:  width,
            height: node.offsetHeight == null ? clientRect.height : node.offsetHeight
        };
    }
    return {};
};

exports.offsetBounds = function(node) {
    var parent = node.offsetParent ? exports.offsetBounds(node.offsetParent) : {top: 0, left: 0};

    return {
        top: node.offsetTop + parent.top,
        bottom: node.offsetTop + node.offsetHeight + parent.top,
        right: node.offsetLeft + parent.left + node.offsetWidth,
        left: node.offsetLeft + parent.left,
        width: node.offsetWidth,
        height: node.offsetHeight
    };
};

exports.parseBackgrounds = function(backgroundImage) {
    var whitespace = ' \r\n\t',
        method, definition, prefix, prefix_i, block, results = [],
        mode = 0, numParen = 0, quote, args;
    var appendResult = function() {
        if(method) {
            if (definition.substr(0, 1) === '"') {
                definition = definition.substr(1, definition.length - 2);
            }
            if (definition) {
                args.push(definition);
            }
            if (method.substr(0, 1) === '-' && (prefix_i = method.indexOf('-', 1 ) + 1) > 0) {
                prefix = method.substr(0, prefix_i);
                method = method.substr(prefix_i);
            }
            results.push({
                prefix: prefix,
                method: method.toLowerCase(),
                value: block,
                args: args,
                image: null
            });
        }
        args = [];
        method = prefix = definition = block = '';
    };
    args = [];
    method = prefix = definition = block = '';
    backgroundImage.split("").forEach(function(c) {
        if (mode === 0 && whitespace.indexOf(c) > -1) {
            return;
        }
        switch(c) {
        case '"':
            if(!quote) {
                quote = c;
            } else if(quote === c) {
                quote = null;
            }
            break;
        case '(':
            if(quote) {
                break;
            } else if(mode === 0) {
                mode = 1;
                block += c;
                return;
            } else {
                numParen++;
            }
            break;
        case ')':
            if (quote) {
                break;
            } else if(mode === 1) {
                if(numParen === 0) {
                    mode = 0;
                    block += c;
                    appendResult();
                    return;
                } else {
                    numParen--;
                }
            }
            break;

        case ',':
            if (quote) {
                break;
            } else if(mode === 0) {
                appendResult();
                return;
            } else if (mode === 1) {
                if (numParen === 0 && !method.match(/^url$/i)) {
                    args.push(definition);
                    definition = '';
                    block += c;
                    return;
                }
            }
            break;
        }

        block += c;
        if (mode === 0) {
            method += c;
        } else {
            definition += c;
        }
    });

    appendResult();
    return results;
};

},{}],27:[function(_dereq_,module,exports){
var GradientContainer = _dereq_('./gradientcontainer');

function WebkitGradientContainer(imageData) {
    GradientContainer.apply(this, arguments);
    this.type = imageData.args[0] === "linear" ? GradientContainer.TYPES.LINEAR : GradientContainer.TYPES.RADIAL;
}

WebkitGradientContainer.prototype = Object.create(GradientContainer.prototype);

module.exports = WebkitGradientContainer;

},{"./gradientcontainer":9}],28:[function(_dereq_,module,exports){
function XHR(url) {
    return new Promise(function(resolve, reject) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url);

        xhr.onload = function() {
            if (xhr.status === 200) {
                resolve(xhr.responseText);
            } else {
                reject(new Error(xhr.statusText));
            }
        };

        xhr.onerror = function() {
            reject(new Error("Network Error"));
        };

        xhr.send();
    });
}

module.exports = XHR;

},{}]},{},[4])(4)
});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"es6-promise":37}]},{},[40,41,89])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3QvaW5kZXguanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0FjdGl2aXR5VHJhY2tlci5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvQWN0aXZpdHlUcmFja2luZ0RhdGEuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0FjdGl2aXR5VHJhY2tpbmdTZXQuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0FwaS9BcGkuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0FwaS9JQWN0aXZpdHlMaXN0ZW5lci5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvQXBpL0lGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0FwaS9JRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0FwaS9JUHJvbXB0Q29tcG9uZW50LmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9BcGkvSVN1cnZleS5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvQXBpL0lTdXJ2ZXlDb21wb25lbnQuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0NhbXBhaWduL0NhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyLmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9DYW1wYWlnbi9DYW1wYWlnbk1hbmFnZXIuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0NhbXBhaWduL0NhbXBhaWduU3RhdGVQcm92aWRlci5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvQ2FtcGFpZ24vQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5LmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9GbG9vZGdhdGVFbmdpbmUuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0Zsb29kZ2F0ZVNldHRpbmdzLmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9Hb3Zlcm5lZENoYW5uZWwuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0dvdmVybmVkQ2hhbm5lbFN0YXRlUHJvdmlkZXIuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0dvdmVybm9yLmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9JU3VydmV5RXZlbnQuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL0lTdXJ2ZXlJbmZvLmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9JbmRleGVkVHJhY2tlci5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvU3VydmV5Q29tcG9uZW50cy9Db21tZW50Q29tcG9uZW50LmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9TdXJ2ZXlDb21wb25lbnRzL1Byb21wdENvbXBvbmVudC5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvU3VydmV5Q29tcG9uZW50cy9SYXRpbmdDb21wb25lbnQuanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL1N1cnZleUV2ZW50cy5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvU3VydmV5U3RhdENvbGxlY3Rpb24uanMiLCIuLi9GbG9vZGdhdGVDb3JlL2Rpc3Qvc3JjL1N1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbi5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9TdXJ2ZXlzL0Zwc1N1cnZleS5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvU3VydmV5cy9ObHFzU3VydmV5LmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9TdXJ2ZXlzL05wc1N1cnZleS5qcyIsIi4uL0Zsb29kZ2F0ZUNvcmUvZGlzdC9zcmMvU3VydmV5cy9TdXJ2ZXlEYXRhU291cmNlLmpzIiwiLi4vRmxvb2RnYXRlQ29yZS9kaXN0L3NyYy9VdGlscy5qcyIsIm5vZGVfbW9kdWxlcy9lczYtcHJvbWlzZS9kaXN0L2VzNi1wcm9taXNlLmpzIiwibm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsInNjcmlwdHMvYXBwL0FwcF9Db21tb24udHMiLCJzY3JpcHRzL2FwcC9BcHBfRmxvb2RnYXRlLnRzIiwic2NyaXB0cy9hcHAvQXBwX0luQXBwRmVlZGJhY2sudHMiLCJzY3JpcHRzL2FwcC9Db25maWd1cmF0aW9uL0NvbmZpZ3VyYXRpb24udHMiLCJzY3JpcHRzL2FwcC9Db25zdGFudHMudHMiLCJzY3JpcHRzL2FwcC9GbG9vZGdhdGVDb3JlL0FkYXB0aXZlU3VydmV5TGF1bmNoZXJGYWN0b3J5LnRzIiwic2NyaXB0cy9hcHAvRmxvb2RnYXRlQ29yZS9GbG9vZGdhdGVFbnZpcm9ubWVudFByb3ZpZGVyLnRzIiwic2NyaXB0cy9hcHAvRmxvb2RnYXRlQ29yZS9GbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIudHMiLCJzY3JpcHRzL2FwcC9GbG9vZGdhdGVDb3JlL0Zsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLnRzIiwic2NyaXB0cy9hcHAvRmxvb2RnYXRlQ29yZS9GbG9vZGdhdGVUZWxlbWV0cnlMb2dnZXIudHMiLCJzY3JpcHRzL2FwcC9GbG9vZGdhdGVDb3JlL1VJU3VydmV5L0N1c3RvbVVJU3VydmV5LnRzIiwic2NyaXB0cy9hcHAvRmxvb2RnYXRlQ29yZS9VSVN1cnZleS9EdW1teVVJU3VydmV5LnRzIiwic2NyaXB0cy9hcHAvRmxvb2RnYXRlQ29yZS9VSVN1cnZleS9VSVN1cnZleS50cyIsInNjcmlwdHMvYXBwL0xvY2FsaXphdGlvbi50cyIsInNjcmlwdHMvYXBwL0xvZ2dpbmcvQ29uc3RhbnRzLnRzIiwic2NyaXB0cy9hcHAvTG9nZ2luZy9Mb2dnaW5nLnRzIiwic2NyaXB0cy9hcHAvTG9nZ2luZy9UZWxlbWV0cnkvQXJpYS50cyIsInNjcmlwdHMvYXBwL0xvZ2dpbmcvVGVsZW1ldHJ5L0FyaWFUZWxlbWV0cnlMb2dnZXIudHMiLCJzY3JpcHRzL2FwcC9Mb2dnaW5nL1RlbGVtZXRyeS9Db250cmFjdHMudHMiLCJzY3JpcHRzL2FwcC9Mb2dnaW5nL1RlbGVtZXRyeS9UZWxlbWV0cnlMb2dnZXJGYWN0b3J5LnRzIiwic2NyaXB0cy9hcHAvU2NyZWVuc2hvdC50cyIsInNjcmlwdHMvYXBwL1RoZW1lLnRzIiwic2NyaXB0cy9hcHAvVHJhbnNwb3J0L0ZpbGVzL01hbmlmZXN0LnRzIiwic2NyaXB0cy9hcHAvVHJhbnNwb3J0L0ZpbGVzL1NjcmVlbnNob3QudHMiLCJzY3JpcHRzL2FwcC9UcmFuc3BvcnQvUGV0cm9sLnRzIiwic2NyaXB0cy9hcHAvVHJhbnNwb3J0L1RyYW5zcG9ydC50cyIsInNjcmlwdHMvYXBwL1VJU3RyaW5ncy9VSVN0cmluZ3MudHMiLCJzY3JpcHRzL2FwcC9VSS9CZWxseUJhbmQvQmVsbHlCYW5kLnRzIiwic2NyaXB0cy9hcHAvVUkvQmVsbHlCYW5kL0V2ZW50cy50cyIsInNjcmlwdHMvYXBwL1VJL0JlbGx5QmFuZC9Gb3JtVGVtcGxhdGVzL0Jhc2ljRm9ybVRlbXBsYXRlLnRzIiwic2NyaXB0cy9hcHAvVUkvQmVsbHlCYW5kL0Zvcm1UZW1wbGF0ZXMvRm9ybVRlbXBsYXRlVHlwZS50cyIsInNjcmlwdHMvYXBwL1VJL0JlbGx5QmFuZC9Gb3JtVGVtcGxhdGVzL1NpbmdsZUZvcm1UZW1wbGF0ZS50cyIsInNjcmlwdHMvYXBwL1VJL0JlbGx5QmFuZC9Gb3JtVGVtcGxhdGVzL1VzZXJWb2ljZUZvcm1UZW1wbGF0ZS50cyIsInNjcmlwdHMvYXBwL1VJL0JlbGx5QmFuZC9MYXlvdXQudHMiLCJzY3JpcHRzL2FwcC9VSS9CZWxseUJhbmQvVGFiRm9jdXMudHMiLCJzY3JpcHRzL2FwcC9VSS9DYXRlZ29yaWVzRHJvcGRvd24udHMiLCJzY3JpcHRzL2FwcC9VSS9DaG9pY2VHcm91cENvbnRyb2wudHMiLCJzY3JpcHRzL2FwcC9VSS9SYXRpbmdDb250cm9sLnRzIiwic2NyaXB0cy9hcHAvVUkvUmVuZGVyZXIudHMiLCJzY3JpcHRzL2FwcC9VSS9TcGlubmVyQ29udHJvbC50cyIsInNjcmlwdHMvYXBwL1VJL1RvYXN0L0V2ZW50cy50cyIsInNjcmlwdHMvYXBwL1VJL1RvYXN0L0xheW91dC50cyIsInNjcmlwdHMvYXBwL1VJL1RvYXN0L1RvYXN0LnRzIiwic2NyaXB0cy9hcHAvVUkvVUkudHMiLCJzY3JpcHRzL2FwcC9VSS9VdGlscy50cyIsInNjcmlwdHMvYXBwL1V0aWxzLnRzIiwic2NyaXB0cy9hcHAvVmVyc2lvbi50cyIsInNjcmlwdHMvYXBwL1dpbmRvd1Byb3BlcnRpZXMudHMiLCJzY3JpcHRzL2FwcC9XaW5kb3cvV2luZG93LnRzIiwic2NyaXB0cy9hcHAvdGhpcmRwYXJ0eS9hcmlhLXdlYmpzLWNvbXBhY3Qtc2RrLTEuMi4wLmpzIiwic2NyaXB0cy9hcHAvdGhpcmRwYXJ0eS9odG1sMmNhbnZhcy9odG1sMmNhbnZhcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDemhDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN2VEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUMzcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDbG5DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIE1haW4gZW50cnkgcG9pbnQuXG4gKi9cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBBcGkgPSByZXF1aXJlKFwiLi9zcmMvQXBpL0FwaVwiKTtcbmV4cG9ydHMuQXBpID0gQXBpO1xudmFyIEZsb29kZ2F0ZUVuZ2luZV8xID0gcmVxdWlyZShcIi4vc3JjL0Zsb29kZ2F0ZUVuZ2luZVwiKTtcbmV4cG9ydHMuRmxvb2RnYXRlRW5naW5lID0gRmxvb2RnYXRlRW5naW5lXzEuRmxvb2RnYXRlRW5naW5lO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIENsYXNzIHRvIHRyYWNrIHRpY2tzIGFnYWluc3QgYSBsaXN0IG9mIGV4cGVjdGVkIGNvdW50cyBpbiBhIHRocmVhZC1zYWZlIHdheVxuICogTWFpbiBBUEkgb2YgaW50ZXJlc3QgaXMgaW5jcmVtZW50QWN0aXZpdHksIHdoaWNoIHJldHVybnMgYW4gZW51bWVyYXRlZCB2YWx1ZSBpbmRpY2F0aW5nXG4gKiB3aGV0aGVyIG9yIG5vdCB0aGUgaW5jcmVtZW50IHJlc3VsdGVkIGluIG5vIHRocmVzaG9sZHMgY3Jvc3NlZCwgYSBzaW5nbGUgYWN0aXZpdHkgdGhyZXNob2xkIGNyb3NzZWQsXG4gKiBvciB0aGUgZmluYWwgYWN0aXZpdHkgdGhyZXNob2xkIGNyb3NzZWQuXG4gKi9cbnZhciBBY3Rpdml0eVRyYWNrZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQWN0aXZpdHlUcmFja2VyKHRyYWNraW5nU2V0KSB7XG4gICAgICAgIGlmICghdHJhY2tpbmdTZXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRyYWNraW5nU2V0IG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRyYWNraW5nU2V0LmdldExpc3QoKS5sZW5ndGggPiAzMikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidHJhY2tpbmdTZXQgbGlzdCBzaXplIG11c3QgYmUgbGVzcyB0aGFuIDMyXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNPcmRlcmVkID0gdHJhY2tpbmdTZXQuZ2V0SXNPcmRlcmVkKCk7XG4gICAgICAgIHRoaXMudHJhY2tlZEFjdGl2aXRpZXMgPSB0cmFja2luZ1NldC5nZXRMaXN0KCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBGb3Igb3JkZXJlZCBzZXRzLCB0aGUgY3VycmVudCBpbmRleC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5hY3RpdmF0aW9uTWFzayA9IDA7XG4gICAgICAgIHRoaXMuY3VycmVudEFjdGl2YXRpb25GbGFncyA9IDA7XG4gICAgICAgIHRoaXMuaXNBY3RpdmF0aW9uQnlJbml0UGVuZGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmN1cnJlbnRDb3VudHMgPSBuZXcgQXJyYXkodGhpcy50cmFja2VkQWN0aXZpdGllcy5sZW5ndGgpO1xuICAgICAgICB0aGlzLmN1cnJlbnRTdGFydFRpbWVzID0gbmV3IEFycmF5KHRoaXMudHJhY2tlZEFjdGl2aXRpZXMubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50U2Vzc2lvbkNvdW50cyA9IG5ldyBBcnJheSh0aGlzLnRyYWNrZWRBY3Rpdml0aWVzLmxlbmd0aCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFja2VkQWN0aXZpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50Q291bnRzW2ldID0gMDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlc3Npb25Db3VudHNbaV0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFja2VkQWN0aXZpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5hY3RpdmF0aW9uTWFzayB8PSAweDEgPDwgaTtcbiAgICAgICAgICAgIGlmICh0aGlzLnRyYWNrZWRBY3Rpdml0aWVzW2ldLmdldENvdW50KCkgPCAxKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFja2VkQWN0aXZpdGllc1tpXS5zZXRDb3VudCgxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGNvdW50IGZvciB0aGUgYWN0aXZpdHkgYXQgdGhlIHNwZWNpZmllZCBpbmRleC4gUmV0dXJucyAwIGZvciBvdXQtb2YtcmFuZ2UgaW5kaWNlc1xuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4IGluZGV4XG4gICAgICovXG4gICAgQWN0aXZpdHlUcmFja2VyLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNWYWxpZEluZGV4KGluZGV4KSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudENvdW50c1tpbmRleF07XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGNvdW50IGZvciB0aGUgYWN0aXZpdHkgYXQgdGhlIHNwZWNpZmllZCBpbmRleCwgYXMgdHJhY2tlZCBvbmx5IGZvciB0aGlzIHNlc3Npb24uXG4gICAgICogUmV0dXJucyAwIGZvciBvdXQtb2YtcmFuZ2UgaW5kaWNlc1xuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4IGluZGV4XG4gICAgICovXG4gICAgQWN0aXZpdHlUcmFja2VyLnByb3RvdHlwZS5nZXRTZXNzaW9uQ291bnQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmFsaWRJbmRleChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTZXNzaW9uQ291bnRzW2luZGV4XTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCB0aGUgU3RhcnRUaW1lIGZvciB0aGUgYWN0aXZpdHkgYXQgdGhlIHNwZWNpZmllZCBpbmRleC4gUmV0dXJucyBudWxsIGZvciBvdXQtb2YtcmFuZ2UgaW5kaWNlc1xuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4IGluZGV4XG4gICAgICovXG4gICAgQWN0aXZpdHlUcmFja2VyLnByb3RvdHlwZS5nZXRTdGFydFRpbWUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmFsaWRJbmRleChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdGFydFRpbWVzW2luZGV4XTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEEgZ2V0LWFuZC1zZXQgbWV0aG9kLiBSZXR1cm5zIHRoZSBjdXJyZW50IFNlc3Npb25Db3VudCwgcmVzZXR0aW5nIGl0IHRvIHplcm8gYW5kIGFkZGluZyBpdCBpbnRvXG4gICAgICogdGhlIGVzdGFibGlzaGVkIGJhc2VsaW5lLlxuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4IGluZGV4XG4gICAgICovXG4gICAgQWN0aXZpdHlUcmFja2VyLnByb3RvdHlwZS5tb3ZlU2Vzc2lvbkNvdW50SW50b0Jhc2VDb3VudCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNWYWxpZEluZGV4KGluZGV4KSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlc3Npb25Db3VudCA9IHRoaXMuY3VycmVudFNlc3Npb25Db3VudHNbaW5kZXhdO1xuICAgICAgICB0aGlzLmN1cnJlbnRTZXNzaW9uQ291bnRzW2luZGV4XSA9IDA7XG4gICAgICAgIHJldHVybiBzZXNzaW9uQ291bnQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBGb3JjaWJseSBzZXQgdGhlIGNvdW50cyBmb3IgdGhlIGFjdGl2aXRpZXMgaW4gdGhlIHRyYWNraW5nU2V0LlxuICAgICAqIFVubGlrZSBvdGhlciBBUElzLCB0aGlzIGV4cGVjdHMgdmVjdG9yIGluZGljZXMgdG8gbWF0Y2ggdGhlIG9yZGVyXG4gICAgICogb2YgdGhlIEFjdGl2aXR5VHJhY2tpbmdTZXQuTGlzdCBpbml0aWFsbHkgdXNlZCB0byBjb25zdHJ1Y3QgdGhpcyB0cmFja2VyLlxuICAgICAqIChXaGVuIGRhdGEgaXMgY29waWVkIGZyb20gYSBkaWZmZXJlbnQgSW5kZXhlZFRyYWNrZXIsIGl0IHdpbGwgcHJvcGVybHkgdXNlIHRoZSBJbmRleGVkVHJhY2tlci5JbmRleCB0byBxdWVyeSBpbnRlcm5hbHMpXG4gICAgICogTm90ZTpcbiAgICAgKiAxKSBBc3N1bWVzIGEgY291bnQgb2YgMCBmb3IgYW55IG1pc3NpbmcgaW5kZXggaW4gdW5kZXJzaXplZCBhcnJheXMuXG4gICAgICogMikgUmVzcGVjdHMgYW5kIGVuZm9yY2VzIG9yZGVyZWQgbGlzdCBpbml0aWFsaXphdGlvbiAoaS5lLiBhbGwgaW5pdCB2YWx1ZXMgYXJlIGlnbm9yZWQgb25jZSBhIHVuZmluaXNoZWQgYWN0aXZpdHkgaXNcbiAgICAgKiBlbmNvdW50ZXJlZCBpbiBhbiBvcmRlcmVkIHRyYWNraW5nIGxpc3QpLlxuICAgICAqIDMpIElmIHRoZSB0cmFja2VyIGlzIGZ1bGx5IEFjdGl2YXRlZCBhcyBhIHJlc3VsdCBvZiB0aGlzIGNhbGwsIHRoZSBuZXh0IGNhbGwgdG8gSW5jcmVtZW50QWN0aXZpdHkgd2lsbCByYWlzZSB0aGVcbiAgICAgKiBJbmNyZW1lbnRFZGdlUmVzdWx0LkFsbEFjdGl2aXRpZXNBY3RpdmF0ZWQsIGZvciBhbnkgdmFsaWQgaW5kZXggYWNjZXB0ZWQgYnkgSXNQZXJtaXR0ZWRJbmRleEZvckFjdGl2YXRpb25CeUluaXQoKS5cbiAgICAgKi9cbiAgICBBY3Rpdml0eVRyYWNrZXIucHJvdG90eXBlLmluaXRDb3VudHMgPSBmdW5jdGlvbiAoYmFzZWxpbmVDb3VudHMsIG90aGVyVHJhY2tlcnMsIHdhc0FscmVhZHlBY3RpdmF0ZWRUaGlzU2Vzc2lvbikge1xuICAgICAgICAvLyBOT1RFOiBiYXNlbGluZUluY3JlbWVudHMgYW5kIHNlc3Npb25JbmNyZW1lbnRzIGFyZSBzb3J0ZWQgdGhlIHNhbWUgYXMgdGhlIGluaXRpYWwgdHJhY2tlZEFjdGl2aXR5IHNldCwgd2hpY2hcbiAgICAgICAgLy8gZm9yIHRoaXMgY2xhc3MgaXMgdGhlIHNhbWUgYXMgdHJhY2tlZEFjdGl2aXRpZXNcbiAgICAgICAgaWYgKHdhc0FscmVhZHlBY3RpdmF0ZWRUaGlzU2Vzc2lvbiA9PT0gdm9pZCAwKSB7IHdhc0FscmVhZHlBY3RpdmF0ZWRUaGlzU2Vzc2lvbiA9IGZhbHNlOyB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50cmFja2VkQWN0aXZpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgLy8gT25seSBhY2NlcHQgdmFsdWVzIHVwIHRvIHRoZSBjdXJyZW50IGluZGV4LCB3aGVuIG9yZGVyZWRcbiAgICAgICAgICAgIGlmICh0aGlzLmlzT3JkZXJlZCAmJiBpID4gdGhpcy5jdXJyZW50SW5kZXgpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFN0YXJ0IG9mZiBieSBwdWxsaW5nIHZhbHVlcyBmcm9tIHRoaXMgc2Vzc2lvblxuICAgICAgICAgICAgaWYgKGkgPCBvdGhlclRyYWNrZXJzLmxlbmd0aCAmJiBvdGhlclRyYWNrZXJzW2ldKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U2Vzc2lvbkNvdW50c1tpXSA9IHRoaXMuY3VycmVudENvdW50c1tpXSA9IG90aGVyVHJhY2tlcnNbaV0udHJhY2tlci5nZXRTZXNzaW9uQ291bnQob3RoZXJUcmFja2Vyc1tpXS5pbmRleCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhcnRUaW1lc1tpXSA9IG90aGVyVHJhY2tlcnNbaV0udHJhY2tlci5nZXRTdGFydFRpbWUob3RoZXJUcmFja2Vyc1tpXS5pbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiB3ZSd2ZSBnb3QgYSBiYXNlbGluZSBmcm9tIHByZXZpb3VzIHNlc3Npb25zLCBhZGQgaXQgaW4gYXMgd2VsbFxuICAgICAgICAgICAgaWYgKHRoaXMudHJhY2tlZEFjdGl2aXRpZXNbaV0uZ2V0SXNBZ2dyZWdhdGUoKSAmJiBpIDwgYmFzZWxpbmVDb3VudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Q291bnRzW2ldICs9IGJhc2VsaW5lQ291bnRzW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGFzQ291bnRDcm9zc2VkVGhyZXNob2xkKGkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maW5pc2hBY3Rpdml0eUF0SW5kZXgoaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaXNBY3RpdmF0ZWQoKSAmJiAhd2FzQWxyZWFkeUFjdGl2YXRlZFRoaXNTZXNzaW9uKSB7XG4gICAgICAgICAgICAvLyBNYXJrIHRoaXMgb2JqZWN0IHNvIHRoYXQgdGhlIG5leHQgdGltZSBhbnkgcGVybWl0dGVkIGFjdGl2YXRpb24gZXZlbnQgaXMgbG9nZ2VkLCB0aGUgc3VydmV5IHdpbGwgYWN0aXZhdGVcbiAgICAgICAgICAgIHRoaXMuaXNBY3RpdmF0aW9uQnlJbml0UGVuZGluZyA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjdGl2aXR5VHJhY2tlci5wcm90b3R5cGUuZ2VuZXJhdGVBY3Rpdml0eUluZGV4TGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGluZGV4TGlzdCA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudHJhY2tlZEFjdGl2aXRpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50ID0gbmV3IEFjdGl2aXR5VHJhY2tlci5BY3Rpdml0eUluZGV4KCk7XG4gICAgICAgICAgICBjdXJyZW50LmFjdGl2aXR5ID0gdGhpcy50cmFja2VkQWN0aXZpdGllc1tpXS5nZXRBY3Rpdml0eSgpO1xuICAgICAgICAgICAgY3VycmVudC5pbmRleCA9IGk7XG4gICAgICAgICAgICBpbmRleExpc3QucHVzaChjdXJyZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXhMaXN0O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogSW5jcmVtZW50cyB0aGUgY291bnQgYXQgdGhlIHNwZWNpZmllZCBpbmRleCBieSB0aGUgZ2l2ZW4gaW5jcmVtZW50LiAgUmV0dXJucyBhIHZhbHVlIGluZGljYXRpbmcgd2hldGhlclxuICAgICAqIG9yIG5vdCB0aGlzIGNhbGwgdHJpZ2dlcmVkIGEgdHJhbnNpdGlvbiBlZGdlIChhY3RpdmF0aW5nIHRoZSBhY3Rpdml0eSBhdCAnaW5kZXgnLCBvciBmaW5pc2hpbmcgdGhlIGFjdGl2YXRpb25cbiAgICAgKiBvZiB0aGUgZmluYWwgcGVuZGluZyBhY3Rpdml0eSlcbiAgICAgKi9cbiAgICBBY3Rpdml0eVRyYWNrZXIucHJvdG90eXBlLmluY3JlbWVudEFjdGl2aXR5ID0gZnVuY3Rpb24gKGluZGV4LCBpbmNyZW1lbnQpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzVmFsaWRJbmRleChpbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybiBBY3Rpdml0eVRyYWNrZXIuSW5jcmVtZW50UmVzdWx0LlBlbmRpbmc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGluY3JlbWVudCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImluY3JlbWVudCBtdXN0IGJlIG5vbi1uZWdhdGl2ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBPcmRlcmVkIHNldHMgbXVzdCBiZSB0cmlnZ2VyZWQgaW4gb3JkZXIuICBXZSBjYW4gb25seSB0cmFjayBhdCB0aGUgY3VycmVudCBpbmRleCwgb3IgYmVmb3JlXG4gICAgICAgIGlmICh0aGlzLmlzT3JkZXJlZCAmJiBpbmRleCA+IHRoaXMuY3VycmVudEluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gQWN0aXZpdHlUcmFja2VyLkluY3JlbWVudFJlc3VsdC5QZW5kaW5nO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFkZCB0byBvdXIgY291bnRzIGFmdGVyIHN0b3Jpbmcgb2ZmIG91ciBjdXJyZW50IHN0YXRlXG4gICAgICAgIHZhciBzdGFydGVkTGVzc1RoYW5UaHJlc2hvbGQgPSAhdGhpcy5oYXNDb3VudENyb3NzZWRUaHJlc2hvbGQoaW5kZXgpO1xuICAgICAgICB0aGlzLmN1cnJlbnRDb3VudHNbaW5kZXhdICs9IGluY3JlbWVudDtcbiAgICAgICAgdGhpcy5jdXJyZW50U2Vzc2lvbkNvdW50c1tpbmRleF0gKz0gaW5jcmVtZW50O1xuICAgICAgICBpZiAodGhpcy5pc0FjdGl2YXRpb25CeUluaXRQZW5kaW5nKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1Blcm1pdHRlZEluZGV4Rm9yQWN0aXZhdGlvbkJ5SW5pdChpbmRleCkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHRyYWNrZXIgd2FzIGNvbXBsZXRlZCBkdWUgdG8gdGhlIGluaXRpYWxpemF0aW9uIGZyb20gcHJldmlvdXMgaW5jcmVtZW50IGRhdGFcbiAgICAgICAgICAgICAgICAvLyBub3cgdGhhdCB3ZSd2ZSBzdG9yZSB0aGlzIGFjdGl2aXRpZXMgaW5jcmVtZW50cywgcmFpc2UgdGhlIEFsbEFjdGl2aXRpZXNBY3RpdmF0ZWQgc2lnbmFsXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tbWl0QWN0aXZhdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gU3RpbGwgd2FpdGluZyBmb3IgYSB2YWxpZCByZS1hY3RpdmF0aW9uIGFjdGl2aXR5XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFjdGl2aXR5VHJhY2tlci5JbmNyZW1lbnRSZXN1bHQuUGVuZGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIShzdGFydGVkTGVzc1RoYW5UaHJlc2hvbGQgJiYgdGhpcy5oYXNDb3VudENyb3NzZWRUaHJlc2hvbGQoaW5kZXgpKSkge1xuICAgICAgICAgICAgLy8gU3RpbGwgd2FpdGluZyBmb3IgdGhpcyBhY3Rpdml0eSB0byBmaW5pc2hcbiAgICAgICAgICAgIHJldHVybiBBY3Rpdml0eVRyYWNrZXIuSW5jcmVtZW50UmVzdWx0LlBlbmRpbmc7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTWFyayB0aGlzIGFjdGl2aXR5IGFzIGNvbXBsZXRlIGluIG91ciBmbGFnIGNvbGxlY3Rpb25cbiAgICAgICAgdGhpcy5maW5pc2hBY3Rpdml0eUF0SW5kZXgoaW5kZXgpO1xuICAgICAgICBpZiAodGhpcy5pc0FjdGl2YXRlZCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21taXRBY3RpdmF0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEFjdGl2aXR5VHJhY2tlci5JbmNyZW1lbnRSZXN1bHQuU2luZ2xlQWN0aXZpdHlBY3RpdmF0ZWQ7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBFeHBsaWNpdGx5IHNldHMgYSBzdGFydCB0aW1lc3RhbXAgKG5vdyBpZiBzdGFydFRpbWUgaXMgbnVsbCkgZm9yIHRoZSBzcGVjaWZpZWQgYWN0aXZpdHkgaW5kZXguIE92ZXJ3cml0ZXMgYW55IHByZXZpb3VzIFN0YXJ0VGltZS5cbiAgICAgKi9cbiAgICBBY3Rpdml0eVRyYWNrZXIucHJvdG90eXBlLnN0YXJ0VGltZSA9IGZ1bmN0aW9uIChpbmRleCwgc3RhcnRUaW1lKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkSW5kZXgoaW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jdXJyZW50U3RhcnRUaW1lc1tpbmRleF0gPSAoIXN0YXJ0VGltZSkgPyBuZXcgRGF0ZSgpIDogc3RhcnRUaW1lO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgdGhlIFwiY291bnRcIiBkZWx0YSAoZGVsdGEgaW4gd2hhdGV2ZXIgdW5pdHMgYXJlIGFwcHJvcHJpYXRlIGZvciBhIHN1YnNlcXVlbnQgY2FsbCB0byBJbmNyZW1lbnRBY3Rpdml0eSlcbiAgICAgKiBlbGFwc2VkIGJldHdlZW4gbm93IGFuZCBhIHByZXZpb3VzbHkgbG9nZ2VkIFN0YXJ0VGltZSBmb3IgdGhpcyBhY3Rpdml0eSBpbmRleC5cbiAgICAgKiBBbHdheXMgY2xlYXJzIHRoZSBwcmV2aW91cyBTdGFydFRpbWUuXG4gICAgICogUmV0dXJucyAwIGlmIG5vIHByZXZpb3VzIFN0YXJ0VGltZSB3YXMgbG9nZ2VkLCBvciBpZiBTdGFydFRpbWUgPiBTdG9wVGltZVxuICAgICAqL1xuICAgIEFjdGl2aXR5VHJhY2tlci5wcm90b3R5cGUuc3RvcFRpbWUgPSBmdW5jdGlvbiAoaW5kZXgsIHN0b3BUaW1lKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkSW5kZXgoaW5kZXgpKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhcnRUaW1lID0gdGhpcy5jdXJyZW50U3RhcnRUaW1lc1tpbmRleF07XG4gICAgICAgIHRoaXMuY3VycmVudFN0YXJ0VGltZXNbaW5kZXhdID0gbnVsbDtcbiAgICAgICAgaWYgKCFzdGFydFRpbWUpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHN0b3BUaW1lID0gKCFzdG9wVGltZSkgPyBuZXcgRGF0ZSgpIDogc3RvcFRpbWU7XG4gICAgICAgIGlmIChzdGFydFRpbWUgPiBzdG9wVGltZSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlbHRhTVMgPSBzdG9wVGltZS5nZXRUaW1lKCkgLSBzdGFydFRpbWUuZ2V0VGltZSgpO1xuICAgICAgICAvLyBDdXJyZW50bHkgYWxsIHRpbWVyIGFjdGl2aXRpZXMgcmV0dXJuIHNlY29uZHMgYXMgdGhlIGluY3JlbWVudCB1bml0XG4gICAgICAgIHJldHVybiBkZWx0YU1TIC8gMTAwMDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgaW5kZXggaXMgdmFsaWQgZm9yIGFjY2Vzc2luZyB0aGUgc3RvcmVkIGFjdGl2aXR5IGNvdW50cywgZmFsc2Ugb3RoZXJ3aXNlXG4gICAgICovXG4gICAgQWN0aXZpdHlUcmFja2VyLnByb3RvdHlwZS5pc1ZhbGlkSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4IDwgdGhpcy50cmFja2VkQWN0aXZpdGllcy5sZW5ndGg7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHdoZXRoZXIgb3Igbm90IHRoZSBmdWxsIHNldCBvZiBhY3Rpdml0aWVzIGZvciB0aGlzIHRyYWNrZXIgaGF2ZSBleGNlZWRlZCB0aGVpciB0cmlnZ2VyIHRocmVzaG9sZHNcbiAgICAgKi9cbiAgICBBY3Rpdml0eVRyYWNrZXIucHJvdG90eXBlLmlzQWN0aXZhdGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuY3VycmVudEFjdGl2YXRpb25GbGFncyAmIHRoaXMuYWN0aXZhdGlvbk1hc2spID09PSB0aGlzLmFjdGl2YXRpb25NYXNrO1xuICAgIH07XG4gICAgLyoqXG4gICAgICAgICogTWFya3MgdGhlIGFjdGl2aXR5IGF0IHRoZSBpbmRleCBhcyBmaW5pc2hlZC4gSW5jbHVkZXMgc2V0dGluZyB0aGUgcHJvcGVyXG4gICAgICAgICogYWN0aXZhdGlvbiBmbGFncyBhbmQgcG90ZW50aWFsbHkgYWR2YW5jaW5nIHRoZSBjdXJyZW50IGluZGV4IGZvciBvcmRlcmVkIHRyYWNraW5nIHNldHNcbiAgICAgICAgKi9cbiAgICBBY3Rpdml0eVRyYWNrZXIucHJvdG90eXBlLmZpbmlzaEFjdGl2aXR5QXRJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNWYWxpZEluZGV4KGluZGV4KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW5kZXggaXMgbm90IHZhbGlkXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3VycmVudEFjdGl2YXRpb25GbGFncyB8PSAweDEgPDwgaW5kZXg7XG4gICAgICAgIGlmIChpbmRleCArIDEgPCB0aGlzLnRyYWNrZWRBY3Rpdml0aWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50SW5kZXggPSBpbmRleCArIDE7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBpbmRleCBpbmRleFxuICAgICAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgY291bnRzIGZvciB0aGUgYWN0aXZpdHkgYXQgdGhlIHNwZWNpZmllZCBpbmRleCBoYXZlIG1ldCBvciBleGNlZWRlZCB0aGUgdGhyZXNob2xkIGNvdW50LlxuICAgICAqL1xuICAgIEFjdGl2aXR5VHJhY2tlci5wcm90b3R5cGUuaGFzQ291bnRDcm9zc2VkVGhyZXNob2xkID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIGlmICghdGhpcy5pc1ZhbGlkSW5kZXgoaW5kZXgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbmRleCBpcyBub3QgdmFsaWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudENvdW50c1tpbmRleF0gPj0gdGhpcy50cmFja2VkQWN0aXZpdGllc1tpbmRleF0uZ2V0Q291bnQoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgaW5kZXggcmVmZXJzIHRvIGFuIGFjdGl2aXR5IHRoYXQgY2FuIHJlLWFjdGl2YXRlIGEgdHJhY2tlZCBvYmplY3QgKGFrYSByZXR1cm4gQWxsQWN0aXZpdGllc0FjdGl2YXRlZClcbiAgICAgKiB0aGF0IHdhcyBpbml0aWFsaXplZCBhcyBcImNvbXBsZXRlXCIgdmlhIGluaXRDb3VudHMuXG4gICAgICogTm90ZTogRm9yIHVub3JkZXJlZCBzZXRzLCBhbnkgYWN0aXZpdHkgaXMgdmFsaWQuIEZvciBvcmRlcmVkIHNlcXVlbmNlcywgb25seSB0aGUgZmluYWwgYWN0aXZpdHkgaXMgdmFsaWRcbiAgICAgKi9cbiAgICBBY3Rpdml0eVRyYWNrZXIucHJvdG90eXBlLmlzUGVybWl0dGVkSW5kZXhGb3JBY3RpdmF0aW9uQnlJbml0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5pc09yZGVyZWQgfHwgKChpbmRleCArIDEpID09PSB0aGlzLmN1cnJlbnRDb3VudHMubGVuZ3RoKTtcbiAgICB9O1xuICAgIEFjdGl2aXR5VHJhY2tlci5wcm90b3R5cGUuY29tbWl0QWN0aXZhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pc0FjdGl2YXRpb25CeUluaXRQZW5kaW5nID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBBY3Rpdml0eVRyYWNrZXIuSW5jcmVtZW50UmVzdWx0LkFsbEFjdGl2aXRpZXNBY3RpdmF0ZWQ7XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aXZpdHlUcmFja2VyO1xufSgpKTtcbihmdW5jdGlvbiAoQWN0aXZpdHlUcmFja2VyKSB7XG4gICAgLyoqXG4gICAgICogU3RydWN0dXJlIHJldHVybmVkIGJ5IGFuIEFjdGl2aXR5VHJhY2tlciB0byBjYWxsIGJhY2sgaW50b1xuICAgICAqIEluY3JlbWVudEFjdGl2aXR5IHdpdGggdmFsaWQgaW5kZXggdmFsdWVzXG4gICAgICovXG4gICAgdmFyIEFjdGl2aXR5SW5kZXggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEFjdGl2aXR5SW5kZXgoKSB7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEFjdGl2aXR5SW5kZXg7XG4gICAgfSgpKTtcbiAgICBBY3Rpdml0eVRyYWNrZXIuQWN0aXZpdHlJbmRleCA9IEFjdGl2aXR5SW5kZXg7XG4gICAgdmFyIEluY3JlbWVudFJlc3VsdDtcbiAgICAoZnVuY3Rpb24gKEluY3JlbWVudFJlc3VsdCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogTm8gdGhyZXNob2xkcyBjcm9zc2VkIGFzIGEgcmVzdWx0IG9mIHRoaXMgaW5jcmVtZW50IG9wZXJhdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgSW5jcmVtZW50UmVzdWx0W0luY3JlbWVudFJlc3VsdFtcIlBlbmRpbmdcIl0gPSAwXSA9IFwiUGVuZGluZ1wiO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRocmVzaG9sZCBmb3IgdGhlIHRhcmdldGVkIGFjdGl2aXR5IGluZGV4IHdhcyBjcm9zc2VkIGFzIGEgcmVzdWx0IG9mIHRoaXMgaW5jcmVtZW50IG9wZXJhdGlvblxuICAgICAgICAgKi9cbiAgICAgICAgSW5jcmVtZW50UmVzdWx0W0luY3JlbWVudFJlc3VsdFtcIlNpbmdsZUFjdGl2aXR5QWN0aXZhdGVkXCJdID0gMV0gPSBcIlNpbmdsZUFjdGl2aXR5QWN0aXZhdGVkXCI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdGhyZXNob2xkIGZvciB0aGUgdGFyZ2V0ZWQgYWN0aXZpdHkgaW5kZXggd2FzIGNyb3NzZWQgYXMgYSByZXN1bHQgb2YgdGhpcyBpbmNyZW1lbnQgb3BlcmF0aW9uXG4gICAgICAgICAqIGFuZCB0aGlzIHdhcyB0aGUgZmluYWwgYWN0aXZpdHkgYmVpbmcgdHJhY2tlZFxuICAgICAgICAgKi9cbiAgICAgICAgSW5jcmVtZW50UmVzdWx0W0luY3JlbWVudFJlc3VsdFtcIkFsbEFjdGl2aXRpZXNBY3RpdmF0ZWRcIl0gPSAyXSA9IFwiQWxsQWN0aXZpdGllc0FjdGl2YXRlZFwiO1xuICAgIH0pKEluY3JlbWVudFJlc3VsdCA9IEFjdGl2aXR5VHJhY2tlci5JbmNyZW1lbnRSZXN1bHQgfHwgKEFjdGl2aXR5VHJhY2tlci5JbmNyZW1lbnRSZXN1bHQgPSB7fSkpO1xufSkoQWN0aXZpdHlUcmFja2VyIHx8IChBY3Rpdml0eVRyYWNrZXIgPSB7fSkpO1xubW9kdWxlLmV4cG9ydHMgPSBBY3Rpdml0eVRyYWNrZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQmFzaWMgc3RydWN0dXJlIHVzZWQgdG8gY29uZmlndXJlIGFuIEFjdGl2aXR5VHJhY2tlclxuICovXG52YXIgQWN0aXZpdHlUcmFja2luZ0RhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQWN0aXZpdHlUcmFja2luZ0RhdGEoYWN0aXZpdHksIGNvdW50LCBpc0FnZ3JlZ2F0ZSkge1xuICAgICAgICB0aGlzLmFjdGl2aXR5ID0gYWN0aXZpdHk7XG4gICAgICAgIHRoaXMuY291bnQgPSBjb3VudDtcbiAgICAgICAgdGhpcy5pc0FnZ3JlZ2F0ZSA9IGlzQWdncmVnYXRlO1xuICAgIH1cbiAgICBBY3Rpdml0eVRyYWNraW5nRGF0YS5wcm90b3R5cGUuZ2V0QWN0aXZpdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2aXR5O1xuICAgIH07XG4gICAgQWN0aXZpdHlUcmFja2luZ0RhdGEucHJvdG90eXBlLmdldENvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb3VudDtcbiAgICB9O1xuICAgIEFjdGl2aXR5VHJhY2tpbmdEYXRhLnByb3RvdHlwZS5zZXRDb3VudCA9IGZ1bmN0aW9uIChjb3VudCkge1xuICAgICAgICB0aGlzLmNvdW50ID0gY291bnQ7XG4gICAgfTtcbiAgICBBY3Rpdml0eVRyYWNraW5nRGF0YS5wcm90b3R5cGUuZ2V0SXNBZ2dyZWdhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzQWdncmVnYXRlO1xuICAgIH07XG4gICAgcmV0dXJuIEFjdGl2aXR5VHJhY2tpbmdEYXRhO1xufSgpKTtcbmV4cG9ydHMuQWN0aXZpdHlUcmFja2luZ0RhdGEgPSBBY3Rpdml0eVRyYWNraW5nRGF0YTtcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBDbGFzcyB0byBob2xkIGEgY29sbGVjdGlvbiBvZiBBY3Rpdml0eSBUcmFja2luZyBEYXRhXG4gKi9cbnZhciBBY3Rpdml0eVRyYWNraW5nU2V0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFjdGl2aXR5VHJhY2tpbmdTZXQoaXNPcmRlcmVkLCBsaXN0KSB7XG4gICAgICAgIHRoaXMuaXNPcmRlcmVkID0gaXNPcmRlcmVkO1xuICAgICAgICB0aGlzLmxpc3QgPSBsaXN0O1xuICAgIH1cbiAgICBBY3Rpdml0eVRyYWNraW5nU2V0LnByb3RvdHlwZS5nZXRJc09yZGVyZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzT3JkZXJlZDtcbiAgICB9O1xuICAgIEFjdGl2aXR5VHJhY2tpbmdTZXQucHJvdG90eXBlLmdldExpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3Q7XG4gICAgfTtcbiAgICByZXR1cm4gQWN0aXZpdHlUcmFja2luZ1NldDtcbn0oKSk7XG5leHBvcnRzLkFjdGl2aXR5VHJhY2tpbmdTZXQgPSBBY3Rpdml0eVRyYWNraW5nU2V0O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG4vKipcbiAqIFBhcmVudCBtb2R1bGUgZm9yIGFsbCBtb2R1bGVzIGluIEFwaS9cbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIElTdXJ2ZXlJbmZvID0gcmVxdWlyZShcIi4vLi4vSVN1cnZleUluZm9cIik7XG5leHBvcnRzLklTdXJ2ZXlJbmZvID0gSVN1cnZleUluZm87XG52YXIgSUFjdGl2aXR5TGlzdGVuZXIgPSByZXF1aXJlKFwiLi9JQWN0aXZpdHlMaXN0ZW5lclwiKTtcbmV4cG9ydHMuSUFjdGl2aXR5TGlzdGVuZXIgPSBJQWN0aXZpdHlMaXN0ZW5lcjtcbnZhciBJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyID0gcmVxdWlyZShcIi4vSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlclwiKTtcbmV4cG9ydHMuSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlciA9IElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXI7XG52YXIgSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyID0gcmVxdWlyZShcIi4vSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyXCIpO1xuZXhwb3J0cy5JRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIgPSBJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXI7XG52YXIgSVByb21wdENvbXBvbmVudCA9IHJlcXVpcmUoXCIuL0lQcm9tcHRDb21wb25lbnRcIik7XG5leHBvcnRzLklQcm9tcHRDb21wb25lbnQgPSBJUHJvbXB0Q29tcG9uZW50O1xudmFyIElTdXJ2ZXkgPSByZXF1aXJlKFwiLi9JU3VydmV5XCIpO1xuZXhwb3J0cy5JU3VydmV5ID0gSVN1cnZleTtcbnZhciBJU3VydmV5Q29tcG9uZW50ID0gcmVxdWlyZShcIi4vSVN1cnZleUNvbXBvbmVudFwiKTtcbmV4cG9ydHMuSVN1cnZleUNvbXBvbmVudCA9IElTdXJ2ZXlDb21wb25lbnQ7XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBJQWN0aXZpdHlMaXN0ZW5lcjtcbihmdW5jdGlvbiAoSUFjdGl2aXR5TGlzdGVuZXIpIHtcbiAgICB2YXIgQWN0aXZpdHlOYW1lID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBBY3Rpdml0eU5hbWUoKSB7XG4gICAgICAgIH1cbiAgICAgICAgQWN0aXZpdHlOYW1lLkFwcExhdW5jaCA9IFwiQXBwTGF1bmNoXCI7XG4gICAgICAgIEFjdGl2aXR5TmFtZS5BcHBVc2FnZVRpbWUgPSBcIkFwcFVzYWdlVGltZVwiO1xuICAgICAgICBBY3Rpdml0eU5hbWUuQXBwUmVzdW1lID0gXCJBcHBSZXN1bWVcIjtcbiAgICAgICAgcmV0dXJuIEFjdGl2aXR5TmFtZTtcbiAgICB9KCkpO1xuICAgIElBY3Rpdml0eUxpc3RlbmVyLkFjdGl2aXR5TmFtZSA9IEFjdGl2aXR5TmFtZTtcbn0pKElBY3Rpdml0eUxpc3RlbmVyIHx8IChJQWN0aXZpdHlMaXN0ZW5lciA9IHt9KSk7XG5tb2R1bGUuZXhwb3J0cyA9IElBY3Rpdml0eUxpc3RlbmVyO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlcjtcbihmdW5jdGlvbiAoSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlcikge1xuICAgIC8qKlxuICAgICAqIEVudW0gZm9yIHRoZSBmaWxlcyB1c2VkIGJ5IGZsb29kZ2F0ZVxuICAgICAqL1xuICAgIHZhciBGaWxlVHlwZTtcbiAgICAoZnVuY3Rpb24gKEZpbGVUeXBlKSB7XG4gICAgICAgIEZpbGVUeXBlW0ZpbGVUeXBlW1wiRmxvb2RnYXRlU2V0dGluZ3NcIl0gPSAwXSA9IFwiRmxvb2RnYXRlU2V0dGluZ3NcIjtcbiAgICAgICAgRmlsZVR5cGVbRmlsZVR5cGVbXCJTdXJ2ZXlBY3RpdmF0aW9uU3RhdHNcIl0gPSAxXSA9IFwiU3VydmV5QWN0aXZhdGlvblN0YXRzXCI7XG4gICAgICAgIEZpbGVUeXBlW0ZpbGVUeXBlW1wiU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzXCJdID0gMl0gPSBcIlN1cnZleUV2ZW50QWN0aXZpdHlTdGF0c1wiO1xuICAgICAgICBGaWxlVHlwZVtGaWxlVHlwZVtcIkNhbXBhaWduRGVmaW5pdGlvbnNcIl0gPSAzXSA9IFwiQ2FtcGFpZ25EZWZpbml0aW9uc1wiO1xuICAgICAgICBGaWxlVHlwZVtGaWxlVHlwZVtcIkNhbXBhaWduU3RhdGVzXCJdID0gNF0gPSBcIkNhbXBhaWduU3RhdGVzXCI7XG4gICAgICAgIEZpbGVUeXBlW0ZpbGVUeXBlW1wiR292ZXJuZWRDaGFubmVsU3RhdGVzXCJdID0gNV0gPSBcIkdvdmVybmVkQ2hhbm5lbFN0YXRlc1wiO1xuICAgIH0pKEZpbGVUeXBlID0gSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZSB8fCAoSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZSA9IHt9KSk7XG59KShJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyIHx8IChJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlcjtcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIElGbG9vZGdhdGVTdHJpbmdQcm92aWRlcjtcbihmdW5jdGlvbiAoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyKSB7XG4gICAgLyoqXG4gICAgICogRW51bSBmb3IgdGhlIHN0cmluZ3MgdXNlZCBieSBmbG9vZGdhdGVcbiAgICAgKi9cbiAgICB2YXIgU3RyaW5nVHlwZTtcbiAgICAoZnVuY3Rpb24gKFN0cmluZ1R5cGUpIHtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzUHJvbXB0VGl0bGVcIl0gPSAwXSA9IFwiTnBzUHJvbXB0VGl0bGVcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzUHJvbXB0UXVlc3Rpb25cIl0gPSAxXSA9IFwiTnBzUHJvbXB0UXVlc3Rpb25cIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzUHJvbXB0WWVzTGFiZWxcIl0gPSAyXSA9IFwiTnBzUHJvbXB0WWVzTGFiZWxcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzUHJvbXB0Tm90Tm93TGFiZWxcIl0gPSAzXSA9IFwiTnBzUHJvbXB0Tm90Tm93TGFiZWxcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzUmF0aW5nUXVlc3Rpb25cIl0gPSA0XSA9IFwiTnBzUmF0aW5nUXVlc3Rpb25cIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzMTFSYXRpbmdWYWx1ZTBcIl0gPSA1XSA9IFwiTnBzMTFSYXRpbmdWYWx1ZTBcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzMTFSYXRpbmdWYWx1ZTFcIl0gPSA2XSA9IFwiTnBzMTFSYXRpbmdWYWx1ZTFcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzMTFSYXRpbmdWYWx1ZTJcIl0gPSA3XSA9IFwiTnBzMTFSYXRpbmdWYWx1ZTJcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzMTFSYXRpbmdWYWx1ZTNcIl0gPSA4XSA9IFwiTnBzMTFSYXRpbmdWYWx1ZTNcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzMTFSYXRpbmdWYWx1ZTRcIl0gPSA5XSA9IFwiTnBzMTFSYXRpbmdWYWx1ZTRcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzMTFSYXRpbmdWYWx1ZTVcIl0gPSAxMF0gPSBcIk5wczExUmF0aW5nVmFsdWU1XCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIk5wczExUmF0aW5nVmFsdWU2XCJdID0gMTFdID0gXCJOcHMxMVJhdGluZ1ZhbHVlNlwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJOcHMxMVJhdGluZ1ZhbHVlN1wiXSA9IDEyXSA9IFwiTnBzMTFSYXRpbmdWYWx1ZTdcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzMTFSYXRpbmdWYWx1ZThcIl0gPSAxM10gPSBcIk5wczExUmF0aW5nVmFsdWU4XCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIk5wczExUmF0aW5nVmFsdWU5XCJdID0gMTRdID0gXCJOcHMxMVJhdGluZ1ZhbHVlOVwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJOcHMxMVJhdGluZ1ZhbHVlMTBcIl0gPSAxNV0gPSBcIk5wczExUmF0aW5nVmFsdWUxMFwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJOcHM1UmF0aW5nVmFsdWUxXCJdID0gMTZdID0gXCJOcHM1UmF0aW5nVmFsdWUxXCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIk5wczVSYXRpbmdWYWx1ZTJcIl0gPSAxN10gPSBcIk5wczVSYXRpbmdWYWx1ZTJcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzNVJhdGluZ1ZhbHVlM1wiXSA9IDE4XSA9IFwiTnBzNVJhdGluZ1ZhbHVlM1wiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJOcHM1UmF0aW5nVmFsdWU0XCJdID0gMTldID0gXCJOcHM1UmF0aW5nVmFsdWU0XCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIk5wczVSYXRpbmdWYWx1ZTVcIl0gPSAyMF0gPSBcIk5wczVSYXRpbmdWYWx1ZTVcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiTnBzQ29tbWVudFF1ZXN0aW9uXCJdID0gMjFdID0gXCJOcHNDb21tZW50UXVlc3Rpb25cIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiUHNhdFByb21wdFRpdGxlXCJdID0gMjJdID0gXCJQc2F0UHJvbXB0VGl0bGVcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiUHNhdFByb21wdFF1ZXN0aW9uXCJdID0gMjNdID0gXCJQc2F0UHJvbXB0UXVlc3Rpb25cIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiUHNhdFByb21wdFllc0xhYmVsXCJdID0gMjRdID0gXCJQc2F0UHJvbXB0WWVzTGFiZWxcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiUHNhdFByb21wdE5vdE5vd0xhYmVsXCJdID0gMjVdID0gXCJQc2F0UHJvbXB0Tm90Tm93TGFiZWxcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiUHNhdFJhdGluZ1F1ZXN0aW9uXCJdID0gMjZdID0gXCJQc2F0UmF0aW5nUXVlc3Rpb25cIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiUHNhdFJhdGluZ1ZhbHVlMVwiXSA9IDI3XSA9IFwiUHNhdFJhdGluZ1ZhbHVlMVwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJQc2F0UmF0aW5nVmFsdWUyXCJdID0gMjhdID0gXCJQc2F0UmF0aW5nVmFsdWUyXCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIlBzYXRSYXRpbmdWYWx1ZTNcIl0gPSAyOV0gPSBcIlBzYXRSYXRpbmdWYWx1ZTNcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiUHNhdFJhdGluZ1ZhbHVlNFwiXSA9IDMwXSA9IFwiUHNhdFJhdGluZ1ZhbHVlNFwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJQc2F0UmF0aW5nVmFsdWU1XCJdID0gMzFdID0gXCJQc2F0UmF0aW5nVmFsdWU1XCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIlBzYXRDb21tZW50UXVlc3Rpb25cIl0gPSAzMl0gPSBcIlBzYXRDb21tZW50UXVlc3Rpb25cIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiQnBzUHJvbXB0VGl0bGVcIl0gPSAzM10gPSBcIkJwc1Byb21wdFRpdGxlXCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIkJwc1Byb21wdFF1ZXN0aW9uXCJdID0gMzRdID0gXCJCcHNQcm9tcHRRdWVzdGlvblwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJCcHNQcm9tcHRZZXNMYWJlbFwiXSA9IDM1XSA9IFwiQnBzUHJvbXB0WWVzTGFiZWxcIjtcbiAgICAgICAgU3RyaW5nVHlwZVtTdHJpbmdUeXBlW1wiQnBzUHJvbXB0Tm90Tm93TGFiZWxcIl0gPSAzNl0gPSBcIkJwc1Byb21wdE5vdE5vd0xhYmVsXCI7XG4gICAgICAgIFN0cmluZ1R5cGVbU3RyaW5nVHlwZVtcIkJwc1JhdGluZ1F1ZXN0aW9uXCJdID0gMzddID0gXCJCcHNSYXRpbmdRdWVzdGlvblwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJCcHNSYXRpbmdWYWx1ZTFcIl0gPSAzOF0gPSBcIkJwc1JhdGluZ1ZhbHVlMVwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJCcHNSYXRpbmdWYWx1ZTJcIl0gPSAzOV0gPSBcIkJwc1JhdGluZ1ZhbHVlMlwiO1xuICAgICAgICBTdHJpbmdUeXBlW1N0cmluZ1R5cGVbXCJCcHNDb21tZW50UXVlc3Rpb25cIl0gPSA0MF0gPSBcIkJwc0NvbW1lbnRRdWVzdGlvblwiO1xuICAgIH0pKFN0cmluZ1R5cGUgPSBJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZSB8fCAoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUgPSB7fSkpO1xufSkoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyIHx8IChJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIgPSB7fSkpO1xubW9kdWxlLmV4cG9ydHMgPSBJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBJUHJvbXB0Q29tcG9uZW50O1xuKGZ1bmN0aW9uIChJUHJvbXB0Q29tcG9uZW50KSB7XG4gICAgdmFyIFByb21wdEJ1dHRvbjtcbiAgICAoZnVuY3Rpb24gKFByb21wdEJ1dHRvbikge1xuICAgICAgICBQcm9tcHRCdXR0b25bUHJvbXB0QnV0dG9uW1wiVW5zZWxlY3RlZFwiXSA9IDBdID0gXCJVbnNlbGVjdGVkXCI7XG4gICAgICAgIFByb21wdEJ1dHRvbltQcm9tcHRCdXR0b25bXCJZZXNcIl0gPSAxXSA9IFwiWWVzXCI7XG4gICAgICAgIFByb21wdEJ1dHRvbltQcm9tcHRCdXR0b25bXCJOb1wiXSA9IDJdID0gXCJOb1wiO1xuICAgIH0pKFByb21wdEJ1dHRvbiA9IElQcm9tcHRDb21wb25lbnQuUHJvbXB0QnV0dG9uIHx8IChJUHJvbXB0Q29tcG9uZW50LlByb21wdEJ1dHRvbiA9IHt9KSk7XG59KShJUHJvbXB0Q29tcG9uZW50IHx8IChJUHJvbXB0Q29tcG9uZW50ID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gSVByb21wdENvbXBvbmVudDtcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIElTdXJ2ZXk7XG4oZnVuY3Rpb24gKElTdXJ2ZXkpIHtcbiAgICB2YXIgVHlwZTtcbiAgICAoZnVuY3Rpb24gKFR5cGUpIHtcbiAgICAgICAgLy8gQSBGZWVkYmFjayBzdXJ2ZXkuIENvbnRhaW5zIGEgc2luZ2xlIHF1ZXN0aW9uIHdpdGggYSBmcmVlLWZvcm0gdGV4dCByZXNwb25zZVxuICAgICAgICBUeXBlW1R5cGVbXCJGZWVkYmFja1wiXSA9IDBdID0gXCJGZWVkYmFja1wiO1xuICAgICAgICAvLyBBbiBOUFMgKG5ldCBwcm9tb3RlciBzY29yZSkgc3VydmV5LiBBc2tzIHVzZXIgdG8gcmF0ZSBcIndoZXRoZXIgb3Igbm90IHRoZXkgd291bGQgcmVjb21tZW5kIHRoaXMgcHJvZHVjdCB0byBmYW1pbHkvZnJpZW5kc1wiLlxuICAgICAgICAvLyBDb250YWlucyBhIHByb21wdCwgcXVlc3Rpb24sIGFuZCByYXRpbmdcbiAgICAgICAgVHlwZVtUeXBlW1wiTnBzXCJdID0gMV0gPSBcIk5wc1wiO1xuICAgICAgICAvLyBBIFBTQVQgKHByb2R1Y3Qgc2F0aXNmYWN0aW9uKSBzdXJ2ZXkuIEFza3MgdXNlciB0byByYXRlIFwib3ZlcmFsbCwgYmFzZWQgb24gdGhlaXIgZXhwZXJpZW5jZSwgaG93IHNhdGlzaWZlZCBhcmUgdGhleSB3aXRoIHRoaXMgYXBwXCJcbiAgICAgICAgLy8gQ29udGFpbnMgYSBwcm9tcHQsIHF1ZXN0aW9uLCBhbmQgcmF0aW5nXG4gICAgICAgIFR5cGVbVHlwZVtcIlBzYXRcIl0gPSAyXSA9IFwiUHNhdFwiO1xuICAgICAgICAvLyBBIEJQUyAoYnVpbGQgcHJvbW90aW9uKSBzdXJ2ZXkuIEFza3MgdXNlciB0byBjaG9vc2UgYmV0d2VlbiBZZXMgYW5kIE5vIG9wdGlvbnMgb2YgcHJvbW90aW5nIHRoZSBjdXJyZW50IGJ1aWxkIHRvIHRoZSBuZXh0IGF1ZGllbmNlIHJpbmdcbiAgICAgICAgLy8gQ29udGFpbnMgYSBwcm9tcHQsIHF1ZXN0aW9uLCBhbmQgcmF0aW5nIChZZXMvTm8pXG4gICAgICAgIFR5cGVbVHlwZVtcIkJwc1wiXSA9IDNdID0gXCJCcHNcIjtcbiAgICAgICAgLy8gQSBGUFMgKGZlYXR1cmUgcHJvbW90aW9uKSBzdXJ2ZXkuIEFza3MgdXNlciB0byByYXRlIGEgZ2l2ZW4gYXBwIGZlYXR1cmUuXG4gICAgICAgIC8vIENvbnRhaW5zIGEgcHJvbXB0LCBxdWVzdGlvbiwgYW5kIHJhdGluZ1xuICAgICAgICBUeXBlW1R5cGVbXCJGcHNcIl0gPSA0XSA9IFwiRnBzXCI7XG4gICAgICAgIC8vIEEgTkxRUyAobmV0IGxhbmd1YWdlIHF1YWxpdHkgc2NvcmUpIHN1cnZleS4gQXNrcyB1c2VyIHRvIHJhdGUgdGhlIGxhbmd1YWdlIHF1YWxpdHkuXG4gICAgICAgIC8vIENvbnRhaW5zIGEgcHJvbXB0LCBxdWVzdGlvbiwgYW5kIHJhdGluZ1xuICAgICAgICBUeXBlW1R5cGVbXCJObHFzXCJdID0gNV0gPSBcIk5scXNcIjtcbiAgICB9KShUeXBlID0gSVN1cnZleS5UeXBlIHx8IChJU3VydmV5LlR5cGUgPSB7fSkpO1xuICAgIElTdXJ2ZXkuRE9NX0ZFRURCQUNLU1VSVkVZX1RBR05BTUUgPSBcIkZlZWRiYWNrU3VydmV5XCI7XG4gICAgSVN1cnZleS5ET01fTlBTX1RBR05BTUUgPSBcIk5wc1wiO1xuICAgIElTdXJ2ZXkuRE9NX1BTQVRfVEFHTkFNRSA9IFwiUHNhdFwiO1xuICAgIElTdXJ2ZXkuRE9NX0JQU19UQUdOQU1FID0gXCJCcHNcIjtcbiAgICBJU3VydmV5LkRPTV9GUFNfVEFHTkFNRSA9IFwiRnBzXCI7XG4gICAgSVN1cnZleS5ET01fTkxRU19UQUdOQU1FID0gXCJObHFzXCI7XG59KShJU3VydmV5IHx8IChJU3VydmV5ID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gSVN1cnZleTtcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIElTdXJ2ZXlDb21wb25lbnQ7XG4oZnVuY3Rpb24gKElTdXJ2ZXlDb21wb25lbnQpIHtcbiAgICB2YXIgVHlwZTtcbiAgICAoZnVuY3Rpb24gKFR5cGUpIHtcbiAgICAgICAgLy8gQSBxdWljayBwb3AtdXAgcmVxdWVzdGluZyBwYXJ0aWNpcGF0aW9uIGluIGEgc3VydmV5XG4gICAgICAgIFR5cGVbVHlwZVtcIlByb21wdFwiXSA9IFwiUHJvbXB0XCJdID0gXCJQcm9tcHRcIjtcbiAgICAgICAgLy8gQSBxdWVzdGlvbiBwYWlyZWQgd2l0aCBhIGZyZWUtZm9ybSB0ZXh0IHJlc3BvbnNlXG4gICAgICAgIFR5cGVbVHlwZVtcIkNvbW1lbnRcIl0gPSBcIkNvbW1lbnRcIl0gPSBcIkNvbW1lbnRcIjtcbiAgICAgICAgLy8gQSBxdWVzdGlvbiBhc2tpbmcgZm9yIGEgc2VsZWN0aW9uIGZyb20gYSBsaXN0IG9mIGFsbG93ZWQgdmFsdWVzIHdpdGggbnVtZXJpYyBtZWFuaW5nXG4gICAgICAgIFR5cGVbVHlwZVtcIlJhdGluZ1wiXSA9IFwiUmF0aW5nXCJdID0gXCJSYXRpbmdcIjtcbiAgICB9KShUeXBlID0gSVN1cnZleUNvbXBvbmVudC5UeXBlIHx8IChJU3VydmV5Q29tcG9uZW50LlR5cGUgPSB7fSkpO1xuICAgIElTdXJ2ZXlDb21wb25lbnQuRE9NX1BST01QVF9UQUdOQU1FID0gXCJQcm9tcHRcIjtcbiAgICBJU3VydmV5Q29tcG9uZW50LkRPTV9DT01NRU5UX1RBR05BTUUgPSBcIkNvbW1lbnRcIjtcbiAgICBJU3VydmV5Q29tcG9uZW50LkRPTV9SQVRJTkdfVEFHTkFNRSA9IFwiUmF0aW5nXCI7XG4gICAgSVN1cnZleUNvbXBvbmVudC5KU09OX1BST01QVF9LRVlOQU1FID0gXCJwcm9tcHRcIjtcbiAgICBJU3VydmV5Q29tcG9uZW50LkpTT05fQ09NTUVOVF9LRVlOQU1FID0gXCJjb21tZW50XCI7XG4gICAgSVN1cnZleUNvbXBvbmVudC5KU09OX1JBVElOR19LRVlOQU1FID0gXCJyYXRpbmdcIjtcbn0pKElTdXJ2ZXlDb21wb25lbnQgfHwgKElTdXJ2ZXlDb21wb25lbnQgPSB7fSkpO1xubW9kdWxlLmV4cG9ydHMgPSBJU3VydmV5Q29tcG9uZW50O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyID0gcmVxdWlyZShcIi4uL0FwaS9JRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyXCIpO1xudmFyIEZsb29kZ2F0ZUVuZ2luZV8xID0gcmVxdWlyZShcIi4uL0Zsb29kZ2F0ZUVuZ2luZVwiKTtcbnZhciBHb3Zlcm5lZENoYW5uZWxfMSA9IHJlcXVpcmUoXCIuLi9Hb3Zlcm5lZENoYW5uZWxcIik7XG52YXIgSVN1cnZleUluZm8gPSByZXF1aXJlKFwiLi4vSVN1cnZleUluZm9cIik7XG52YXIgVXRpbHMgPSByZXF1aXJlKFwiLi4vVXRpbHNcIik7XG4vLyByZWdpb24gTGFuZ3VhZ2UgUmFuZ2Vcbi8qKlxuICogQmFzZSBjbGFzcyByZXByZXNlbnRpbmcgYSBsYW5ndWFnZSByYW5nZSBpbiBhIGNhbXBhaWduIHNldHRpbmdcbiAqL1xudmFyIENhbXBhaWduTGFuZ3VhZ2VSYW5nZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnbkxhbmd1YWdlUmFuZ2UoKSB7XG4gICAgfVxuICAgIENhbXBhaWduTGFuZ3VhZ2VSYW5nZS5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAoaW5wdXQgJiYgaW5wdXQuVHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gQ2FtcGFpZ25MYW5ndWFnZVJhbmdlTGFuZ3VhZ2VTdWJ0YWcuZGVzZXJpYWxpemUoaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENhbXBhaWduTGFuZ3VhZ2VSYW5nZS5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduTGFuZ3VhZ2VSYW5nZTtcbn0oKSk7XG5leHBvcnRzLkNhbXBhaWduTGFuZ3VhZ2VSYW5nZSA9IENhbXBhaWduTGFuZ3VhZ2VSYW5nZTtcbi8qKlxuICogUmVwcmVzZW50cyBhIHJhbmdlIG1hdGNoaW5nIG9uIHRoZSBcImxhbmd1YWdlIHN1YnRhZ1wiIGFnYWluc3QgZnVsbHkgc3BlY2lmaWVkIGxhbmd1YWdlIHRhZ3MsIGFjY29yZGluZyB0byBSRkMgNTY0NlxuICovXG52YXIgQ2FtcGFpZ25MYW5ndWFnZVJhbmdlTGFuZ3VhZ2VTdWJ0YWcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENhbXBhaWduTGFuZ3VhZ2VSYW5nZUxhbmd1YWdlU3VidGFnLCBfc3VwZXIpO1xuICAgIC8vIHB1YmxpYyBmb3IgVVQgb25seVxuICAgIGZ1bmN0aW9uIENhbXBhaWduTGFuZ3VhZ2VSYW5nZUxhbmd1YWdlU3VidGFnKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICB9XG4gICAgQ2FtcGFpZ25MYW5ndWFnZVJhbmdlTGFuZ3VhZ2VTdWJ0YWcuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW1wYWlnbkxhbmd1YWdlUmFuZ2VMYW5ndWFnZVN1YnRhZygpO1xuICAgICAgICBpZiAoaW5wdXQpIHtcbiAgICAgICAgICAgIHJlc3VsdC5sYW5ndWFnZVN1YlRhZyA9IGlucHV0LlZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDYW1wYWlnbkxhbmd1YWdlUmFuZ2VMYW5ndWFnZVN1YnRhZy5wcm90b3R5cGUuaXNJblJhbmdlID0gZnVuY3Rpb24gKGxhbmd1YWdlKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChsYW5ndWFnZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXh0cmFjdGVkTGFuZ3VhZ2VTdWJUYWcgPSBVdGlscy5leHRyYWN0TGFuZ3VhZ2VTdWJ0YWcobGFuZ3VhZ2UpO1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZXh0cmFjdGVkTGFuZ3VhZ2VTdWJUYWcpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29tcGFyZSBzdHJpbmdzIGlnbm9yaW5nIGNhc2VcbiAgICAgICAgcmV0dXJuIGV4dHJhY3RlZExhbmd1YWdlU3ViVGFnLnRvTG9jYWxlVXBwZXJDYXNlKCkgPT09IHRoaXMubGFuZ3VhZ2VTdWJUYWcudG9Mb2NhbGVVcHBlckNhc2UoKTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduTGFuZ3VhZ2VSYW5nZUxhbmd1YWdlU3VidGFnLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnZhbGlkYXRlLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5sYW5ndWFnZVN1YlRhZykgfHwgIVV0aWxzLmlzU3RyaW5nKHRoaXMubGFuZ3VhZ2VTdWJUYWcpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVqZWN0IGFueSBzcGVjIHRoYXQgaXNuJ3QgZXhhY3RseSBhIGxhbmd1YWdlIHN1YnRhZ1xuICAgICAgICBpZiAoIVV0aWxzLmlzVmFsaWRMYW5ndWFnZVN1YlRhZyh0aGlzLmxhbmd1YWdlU3ViVGFnKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduTGFuZ3VhZ2VSYW5nZUxhbmd1YWdlU3VidGFnO1xufShDYW1wYWlnbkxhbmd1YWdlUmFuZ2UpKTtcbmV4cG9ydHMuQ2FtcGFpZ25MYW5ndWFnZVJhbmdlTGFuZ3VhZ2VTdWJ0YWcgPSBDYW1wYWlnbkxhbmd1YWdlUmFuZ2VMYW5ndWFnZVN1YnRhZztcbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIFNjb3BlXG52YXIgQ2FtcGFpZ25TY29wZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnblNjb3BlKCkge1xuICAgIH1cbiAgICBDYW1wYWlnblNjb3BlLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoaW5wdXQuVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IENhbXBhaWduU2NvcGVBbnkuZGVzZXJpYWxpemUoaW5wdXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdC5kZXNlcmlhbGl6ZShpbnB1dCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQ2FtcGFpZ25TY29wZS5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduU2NvcGU7XG59KCkpO1xuZXhwb3J0cy5DYW1wYWlnblNjb3BlID0gQ2FtcGFpZ25TY29wZTtcbnZhciBDYW1wYWlnblNjb3BlQW55ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDYW1wYWlnblNjb3BlQW55LCBfc3VwZXIpO1xuICAgIC8vIHB1YmxpYyBmb3IgVVQgb25seVxuICAgIGZ1bmN0aW9uIENhbXBhaWduU2NvcGVBbnkoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDYW1wYWlnblNjb3BlQW55LmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2FtcGFpZ25TY29wZUFueSgpO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgQ2FtcGFpZ25TY29wZUFueS5wcm90b3R5cGUuaXNJblNjb3BlID0gZnVuY3Rpb24gKGVudmlyb25tZW50UHJvdmlkZXIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDYW1wYWlnblNjb3BlQW55LnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnZhbGlkYXRlLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnblNjb3BlQW55O1xufShDYW1wYWlnblNjb3BlKSk7XG5leHBvcnRzLkNhbXBhaWduU2NvcGVBbnkgPSBDYW1wYWlnblNjb3BlQW55O1xudmFyIENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2FtcGFpZ25TY29wZUVudmlyb25tZW50Q3Jvc3NQcm9kdWN0LCBfc3VwZXIpO1xuICAgIC8vIHB1YmxpYyBmb3IgVVQgb25seVxuICAgIGZ1bmN0aW9uIENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdC5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdCgpO1xuICAgICAgICB2YXIgbGFuZ3VhZ2VSYW5nZXMgPSBbXTtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIga2V5IGluIGlucHV0Lkxhbmd1YWdlcykge1xuICAgICAgICAgICAgaWYgKGlucHV0Lkxhbmd1YWdlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlYWRSYW5nZSA9IGlucHV0Lkxhbmd1YWdlc1trZXldO1xuICAgICAgICAgICAgICAgIGlmIChyZWFkUmFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2VSYW5nZXMucHVzaChDYW1wYWlnbkxhbmd1YWdlUmFuZ2UuZGVzZXJpYWxpemUocmVhZFJhbmdlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChsYW5ndWFnZVJhbmdlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGxhbmd1YWdlUmFuZ2VzID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQubGFuZ3VhZ2VSYW5nZXMgPSBsYW5ndWFnZVJhbmdlcztcbiAgICAgICAgaWYgKCFyZXN1bHQudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdC5wcm90b3R5cGUuaXNJblNjb3BlID0gZnVuY3Rpb24gKGVudmlyb25tZW50UHJvdmlkZXIpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGFuZ3VhZ2VSYW5nZXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZW52aXJvbm1lbnRQcm92aWRlcikgfHwgIWVudmlyb25tZW50UHJvdmlkZXIuZ2V0TGFuZ3VhZ2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIElmIHRoZSBlbnZpcm9ubWVudCBtYXRjaGVzIGEgc2luZ2xlIHBhdHRlcm4sIHRoZW4gdGhpcyBpcyBhIHllc1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5sYW5ndWFnZVJhbmdlcykge1xuICAgICAgICAgICAgaWYgKHRoaXMubGFuZ3VhZ2VSYW5nZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHRoaXMubGFuZ3VhZ2VSYW5nZXNba2V5XTtcbiAgICAgICAgICAgICAgICBpZiAocmFuZ2UuaXNJblJhbmdlKGVudmlyb25tZW50UHJvdmlkZXIuZ2V0TGFuZ3VhZ2UoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdC5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS52YWxpZGF0ZS5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTnVsbCBsYW5ndWFnZVJhbmdlcyBpcyBhbGxvd2VkLCBtZWFucyB3aWxsIG1hdGNoIHdpdGggZXZlcnl0aGluZy5cbiAgICAgICAgaWYgKHRoaXMubGFuZ3VhZ2VSYW5nZXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmxhbmd1YWdlUmFuZ2VzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGFuZ3VhZ2VSYW5nZXMuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAhdGhpcy5sYW5ndWFnZVJhbmdlc1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25TY29wZUVudmlyb25tZW50Q3Jvc3NQcm9kdWN0O1xufShDYW1wYWlnblNjb3BlKSk7XG5leHBvcnRzLkNhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdCA9IENhbXBhaWduU2NvcGVFbnZpcm9ubWVudENyb3NzUHJvZHVjdDtcbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIER1cmF0aW9uc1xuLyoqXG4gKiBCYXNlIGNsYXNzIHJlcHJlc2VudGluZyBhIGR1cmF0aW9uIGluIGEgY2FtcGFpZ24gc2V0dGluZ1xuICovXG52YXIgQ2FtcGFpZ25EdXJhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnbkR1cmF0aW9uKCkge1xuICAgIH1cbiAgICBDYW1wYWlnbkR1cmF0aW9uLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoaW5wdXQuVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IENhbXBhaWduRHVyYXRpb25UaW1lSW50ZXJ2YWwuZGVzZXJpYWxpemUoaW5wdXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IENhbXBhaWduRHVyYXRpb25TaW5nbGVCdWlsZENoYW5nZS5kZXNlcmlhbGl6ZShpbnB1dCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQ2FtcGFpZ25EdXJhdGlvbi5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduRHVyYXRpb247XG59KCkpO1xuZXhwb3J0cy5DYW1wYWlnbkR1cmF0aW9uID0gQ2FtcGFpZ25EdXJhdGlvbjtcbi8qKlxuICogQSBEdXJhdGlvbiBleHByZXNzZWQgaW4gc2Vjb25kcy4gVVRDIGRhdGV0aW1lIGNvbXBhcmlzb25zIGFyZSB1c2VkIHRvIGRldGVybWluZSBleHBpcmF0aW9uLlxuICovXG52YXIgQ2FtcGFpZ25EdXJhdGlvblRpbWVJbnRlcnZhbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2FtcGFpZ25EdXJhdGlvblRpbWVJbnRlcnZhbCwgX3N1cGVyKTtcbiAgICAvLyBwdWJsaWMgZm9yIFVUIG9ubHlcbiAgICBmdW5jdGlvbiBDYW1wYWlnbkR1cmF0aW9uVGltZUludGVydmFsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICB9XG4gICAgQ2FtcGFpZ25EdXJhdGlvblRpbWVJbnRlcnZhbC5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduRHVyYXRpb25UaW1lSW50ZXJ2YWwoKTtcbiAgICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgICAgICByZXN1bHQuaW50ZXJ2YWxTZWNvbmRzID0gaW5wdXQuSW50ZXJ2YWxTZWNvbmRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDYW1wYWlnbkR1cmF0aW9uVGltZUludGVydmFsLnByb3RvdHlwZS5hc1RpbWVJbnRlcnZhbFNlY29uZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmludGVydmFsU2Vjb25kcztcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduRHVyYXRpb25UaW1lSW50ZXJ2YWwucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIV9zdXBlci5wcm90b3R5cGUudmFsaWRhdGUuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghVXRpbHMuaXNOdW1iZXIodGhpcy5pbnRlcnZhbFNlY29uZHMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25EdXJhdGlvblRpbWVJbnRlcnZhbDtcbn0oQ2FtcGFpZ25EdXJhdGlvbikpO1xuZXhwb3J0cy5DYW1wYWlnbkR1cmF0aW9uVGltZUludGVydmFsID0gQ2FtcGFpZ25EdXJhdGlvblRpbWVJbnRlcnZhbDtcbi8qKlxuICogQSBEdXJhdGlvbiByZXByZXNlbnRpbmcgZXhhY3RseSAxIGNoYW5nZSBpbiBidWlsZCBudW1iZXJcbiAqL1xudmFyIENhbXBhaWduRHVyYXRpb25TaW5nbGVCdWlsZENoYW5nZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2FtcGFpZ25EdXJhdGlvblNpbmdsZUJ1aWxkQ2hhbmdlLCBfc3VwZXIpO1xuICAgIC8vIHB1YmxpYyBmb3IgVVQgb25seVxuICAgIGZ1bmN0aW9uIENhbXBhaWduRHVyYXRpb25TaW5nbGVCdWlsZENoYW5nZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduRHVyYXRpb25TaW5nbGVCdWlsZENoYW5nZS5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICByZXR1cm4gbmV3IENhbXBhaWduRHVyYXRpb25TaW5nbGVCdWlsZENoYW5nZSgpO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgQ2FtcGFpZ25EdXJhdGlvblNpbmdsZUJ1aWxkQ2hhbmdlLnByb3RvdHlwZS5hc1RpbWVJbnRlcnZhbFNlY29uZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduRHVyYXRpb25TaW5nbGVCdWlsZENoYW5nZTtcbn0oQ2FtcGFpZ25EdXJhdGlvbikpO1xuZXhwb3J0cy5DYW1wYWlnbkR1cmF0aW9uU2luZ2xlQnVpbGRDaGFuZ2UgPSBDYW1wYWlnbkR1cmF0aW9uU2luZ2xlQnVpbGRDaGFuZ2U7XG4vKipcbiAqIENsYXNzIHJlcHJlc2VudGluZyBBZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCBpbiBDYW1wYWlnbkRlZmluaXRpb25cbiAqL1xudmFyIENhbXBhaWduQWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25BZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCgpIHtcbiAgICB9XG4gICAgQ2FtcGFpZ25BZGRpdGlvbmFsRGF0YVJlcXVlc3RlZC5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChhZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduQWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQoKTtcbiAgICAgICAgaWYgKCFVdGlscy5pc051bGxPclVuZGVmaW5lZChhZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCkpIHtcbiAgICAgICAgICAgIC8vIENvbnZlcnQgZnJvbSBBZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCBzdHJpbmcgdG8gZW51bVxuICAgICAgICAgICAgcmVzdWx0LmFkZGl0aW9uYWxEYXRhID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkXzEgPSBhZGRpdGlvbmFsRGF0YVJlcXVlc3RlZDsgX2kgPCBhZGRpdGlvbmFsRGF0YVJlcXVlc3RlZF8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBhZGRpdGlvbmFsRGF0YSA9IGFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkXzFbX2ldO1xuICAgICAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRGF0YSA9PT0gXCJFbWFpbEFkZHJlc3NcIikge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkaXRpb25hbERhdGEucHVzaChJU3VydmV5SW5mby5BZGRpdGlvbmFsRGF0YVR5cGUuRW1haWxBZGRyZXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZXN1bHQudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENhbXBhaWduQWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5hZGRpdGlvbmFsRGF0YSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnbkFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkO1xufSgpKTtcbmV4cG9ydHMuQ2FtcGFpZ25BZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCA9IENhbXBhaWduQWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQ7XG4vLyBlbmRyZWdpb25cbi8vIHJlZ2lvbiBEaXN0cmlidXRpb24gU2NoZW1lc1xudmFyIENhbXBhaWduRGlzdHJpYnV0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENhbXBhaWduRGlzdHJpYnV0aW9uKCkge1xuICAgIH1cbiAgICBDYW1wYWlnbkRpc3RyaWJ1dGlvbi5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAoaW5wdXQgJiYgaW5wdXQuVHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gQ2FtcGFpZ25EaXN0cmlidXRpb25SYW1wLmRlc2VyaWFsaXplKGlucHV0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBDYW1wYWlnbkRpc3RyaWJ1dGlvbi5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduRGlzdHJpYnV0aW9uO1xufSgpKTtcbmV4cG9ydHMuQ2FtcGFpZ25EaXN0cmlidXRpb24gPSBDYW1wYWlnbkRpc3RyaWJ1dGlvbjtcbnZhciBDYW1wYWlnbkRpc3RyaWJ1dGlvblJhbXAgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENhbXBhaWduRGlzdHJpYnV0aW9uUmFtcCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDYW1wYWlnbkRpc3RyaWJ1dGlvblJhbXAoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDYW1wYWlnbkRpc3RyaWJ1dGlvblJhbXAuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW1wYWlnbkRpc3RyaWJ1dGlvblJhbXAoKTtcbiAgICAgICAgaWYgKGlucHV0KSB7XG4gICAgICAgICAgICByZXN1bHQubWF4RGVsYXlTZWNvbmRzID0gaW5wdXQuTWF4RGVsYXlTZWNvbmRzO1xuICAgICAgICAgICAgcmVzdWx0LmNodW5rcyA9IGlucHV0LkNodW5rcztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJlc3VsdC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgQ2FtcGFpZ25EaXN0cmlidXRpb25SYW1wLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnZhbGlkYXRlLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIVV0aWxzLmlzTnVtYmVyKHRoaXMubWF4RGVsYXlTZWNvbmRzKSB8fCB0aGlzLm1heERlbGF5U2Vjb25kcyA8IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIVV0aWxzLmlzTnVtYmVyKHRoaXMuY2h1bmtzKSB8fCB0aGlzLmNodW5rcyA8IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnbkRpc3RyaWJ1dGlvblJhbXA7XG59KENhbXBhaWduRGlzdHJpYnV0aW9uKSk7XG5leHBvcnRzLkNhbXBhaWduRGlzdHJpYnV0aW9uUmFtcCA9IENhbXBhaWduRGlzdHJpYnV0aW9uUmFtcDtcbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIE5vbWluYXRpb24gU2NoZW1lXG52YXIgQ2FtcGFpZ25Ob21pbmF0aW9uU2NoZW1lID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENhbXBhaWduTm9taW5hdGlvblNjaGVtZSgpIHtcbiAgICB9XG4gICAgQ2FtcGFpZ25Ob21pbmF0aW9uU2NoZW1lLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmIChpbnB1dCAmJiBpbnB1dC5UeXBlID09PSAwKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBDYW1wYWlnbk5vbWluYXRpb25TY2hlbWVSYXRpb1BlcmNlbnRhZ2UuZGVzZXJpYWxpemUoaW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gVGhlIGFtb3VudCBvZiB0aW1lIHRoZSBzdXJ2ZXkgc2hvdWxkIGJlIGFjdGl2ZSwgaW4gc2Vjb25kcy4gQWJzdHJhY3RzIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gbm9taW5hdGlvblBlcmlvZCBhbmQgdGhlIGZhbGxiYWNrXG4gICAgICovXG4gICAgQ2FtcGFpZ25Ob21pbmF0aW9uU2NoZW1lLnByb3RvdHlwZS5nZXRBY3RpdmVTdXJ2ZXlUaW1lSW50ZXJ2YWxTZWNvbmRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbm9taW5hdGlvblRpbUludGVydmFsU2Vjb25kcyA9IHRoaXMubm9taW5hdGlvblBlcmlvZC5hc1RpbWVJbnRlcnZhbFNlY29uZHMoKTtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVtYmVyKG5vbWluYXRpb25UaW1JbnRlcnZhbFNlY29uZHMpKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9taW5hdGlvblRpbUludGVydmFsU2Vjb25kcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5mYWxsYmFja1N1cnZleUR1cmF0aW9uU2Vjb25kcztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEByZXR1cm4gVGhlIHN1cnZleSBzdGFydCB0aW1lLCBwb3NzaWJseSBhZGp1c3RlZCBieSBhbiB1bmRlcmx5aW5nIERpc3RyaWJ1dGlvbk1vZGVsLlxuICAgICAqL1xuICAgIENhbXBhaWduTm9taW5hdGlvblNjaGVtZS5wcm90b3R5cGUuY2FsY3VsYXRlU3VydmV5U3RhcnRUaW1lRnJvbURhdGUgPSBmdW5jdGlvbiAoc29vbmVzdFN0YXJ0VGltZSkge1xuICAgICAgICAvLyBObyBhZGp1c3RtZW50IGluIGJhc2UgY2xhc3MuICBEZXJpdmVkIGNsYXNzZXMgY2FuIG92ZXJyaWRlIGFuZCBpbXBsZW1lbnQgZGVsYXlzIGxpa2UgYSBcInJhbXBcIlxuICAgICAgICByZXR1cm4gc29vbmVzdFN0YXJ0VGltZSA/IHNvb25lc3RTdGFydFRpbWUgOiBuZXcgRGF0ZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQHJldHVybiBUaGUgc3VydmV5IGV4cGlyYXRpb24gdGltZSwgYmFzZWQgb24gdGhlIG5vbWluYXRpb24gcGVyaW9kcyBhbmQgdGhlIHN1cnZleSdzIGFkanVzdGVkIHN0YXJ0IHRpbWVcbiAgICAgKi9cbiAgICBDYW1wYWlnbk5vbWluYXRpb25TY2hlbWUucHJvdG90eXBlLmNhbGN1bGF0ZVN1cnZleUV4cGlyYXRpb25UaW1lRnJvbVN1cnZleVN0YXJ0VGltZSA9IGZ1bmN0aW9uIChzdXJ2ZXlTdGFydFRpbWUpIHtcbiAgICAgICAgc3VydmV5U3RhcnRUaW1lID0gc3VydmV5U3RhcnRUaW1lID8gc3VydmV5U3RhcnRUaW1lIDogbmV3IERhdGUoKTtcbiAgICAgICAgcmV0dXJuIFV0aWxzLmFkZFNlY29uZHNXaXRob3V0T3ZlcmZsb3coc3VydmV5U3RhcnRUaW1lLCB0aGlzLmdldEFjdGl2ZVN1cnZleVRpbWVJbnRlcnZhbFNlY29uZHMoKSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBAcmV0dXJuIFRoZSBhcHByb3ByaWF0ZSBjYW1wYWlnbiBjb29sIGRvd24gYmFzZWQgb24gd2hldGhlciBvciBub3QgdGhlIHVzZXIgYWN0aXZhdGVkIHRoZSBzdXJ2ZXlcbiAgICAgKi9cbiAgICBDYW1wYWlnbk5vbWluYXRpb25TY2hlbWUucHJvdG90eXBlLmdldENhbXBhaWduQ29vbGRvd24gPSBmdW5jdGlvbiAoZGlkVXNlckFjdGl2YXRlU3VydmV5KSB7XG4gICAgICAgIGlmIChkaWRVc2VyQWN0aXZhdGVTdXJ2ZXkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvb2xkb3duUGVyaW9kO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubm9taW5hdGlvblBlcmlvZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2FtcGFpZ25Ob21pbmF0aW9uU2NoZW1lLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubm9taW5hdGlvblBlcmlvZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jb29sZG93blBlcmlvZCkpIHtcbiAgICAgICAgICAgIHRoaXMuY29vbGRvd25QZXJpb2QgPSB0aGlzLm5vbWluYXRpb25QZXJpb2Q7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFVdGlscy5pc051bWJlcih0aGlzLm5vbWluYXRpb25QZXJpb2QuYXNUaW1lSW50ZXJ2YWxTZWNvbmRzKCkpKSB7XG4gICAgICAgICAgICBpZiAoIVV0aWxzLmlzTnVtYmVyKHRoaXMuZmFsbGJhY2tTdXJ2ZXlEdXJhdGlvblNlY29uZHMpIHx8IHRoaXMuZmFsbGJhY2tTdXJ2ZXlEdXJhdGlvblNlY29uZHMgPD0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnbk5vbWluYXRpb25TY2hlbWU7XG59KCkpO1xuZXhwb3J0cy5DYW1wYWlnbk5vbWluYXRpb25TY2hlbWUgPSBDYW1wYWlnbk5vbWluYXRpb25TY2hlbWU7XG4vKipcbiAqIENsYXNzIHJlcHJlc2VudGluZyBhIHNldCBvZiBjYW1wYWlnbiBub21pbmF0aW9uIHJ1bGVzIHRvIGV2YWx1YXRlIGZvciBpbi1zY29wZSBjYW1wYWlnbnM6XG4gKiBwZXJjZW50YWdlXG4gKiByZS1lbGVjdGlvbiBkdXJhdGlvbnNcbiAqIGRpc3RyaWJ1dGlvbiBtb2RlbCAoZm9yIFwibm9taW5hdGVkXCIgY2FuZGlkYXRlcylcbiAqL1xudmFyIENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2FtcGFpZ25Ob21pbmF0aW9uU2NoZW1lUmF0aW9QZXJjZW50YWdlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZS5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZSgpO1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuRGlzdHJpYnV0aW9uTW9kZWwpIHtcbiAgICAgICAgICAgIHJlc3VsdC5kaXN0cmlidXRpb25Nb2RlbCA9IENhbXBhaWduRGlzdHJpYnV0aW9uLmRlc2VyaWFsaXplKGlucHV0LkRpc3RyaWJ1dGlvbk1vZGVsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5wdXQuQ29vbGRvd25QZXJpb2QpIHtcbiAgICAgICAgICAgIHJlc3VsdC5jb29sZG93blBlcmlvZCA9IENhbXBhaWduRHVyYXRpb24uZGVzZXJpYWxpemUoaW5wdXQuQ29vbGRvd25QZXJpb2QpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5Ob21pbmF0aW9uUGVyaW9kKSB7XG4gICAgICAgICAgICByZXN1bHQubm9taW5hdGlvblBlcmlvZCA9IENhbXBhaWduRHVyYXRpb24uZGVzZXJpYWxpemUoaW5wdXQuTm9taW5hdGlvblBlcmlvZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LmZhbGxiYWNrU3VydmV5RHVyYXRpb25TZWNvbmRzID0gaW5wdXQuRmFsbGJhY2tTdXJ2ZXlEdXJhdGlvblNlY29uZHM7XG4gICAgICAgIHJlc3VsdC5wZXJjZW50YWdlRGVub21pbmF0b3IgPSBpbnB1dC5QZXJjZW50YWdlRGVub21pbmF0b3I7XG4gICAgICAgIHJlc3VsdC5wZXJjZW50YWdlTnVtZXJhdG9yID0gaW5wdXQuUGVyY2VudGFnZU51bWVyYXRvcjtcbiAgICAgICAgaWYgKCFyZXN1bHQudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZS5wcm90b3R5cGUuZXZhbHVhdGVOb21pbmF0aW9uUnVsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByYW5kID0gTWF0aC5yYW5kb20oKTtcbiAgICAgICAgLy8gQ3JlYXRlcyBhIHJhbmRvbSBudW1iZXIgYmV0d2VlbiBbMCB0byAocGVyY2VudGFnZURlbm9taW5hdG9yIC0gMSldXG4gICAgICAgIC8vIEluIHJhbmdlIFswIHRvIChwZXJjZW50YWdlRGVub21pbmF0b3IgLSAxKV0gZXhhY3RseSAncGVyY2VudGFnZU51bWVyYXRvcicgdmFsdWVzIGFyZSA8IHBlcmNlbnRhZ2VOdW1lcmF0b3JcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IocmFuZCAqIHRoaXMucGVyY2VudGFnZURlbm9taW5hdG9yKSA8IHRoaXMucGVyY2VudGFnZU51bWVyYXRvcjtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZS5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS52YWxpZGF0ZS5jYWxsKHRoaXMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFVdGlscy5pc051bWJlcih0aGlzLnBlcmNlbnRhZ2VEZW5vbWluYXRvcikgfHwgIVV0aWxzLmlzTnVtYmVyKHRoaXMucGVyY2VudGFnZU51bWVyYXRvcikpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wZXJjZW50YWdlRGVub21pbmF0b3IgPD0gMCB8fCB0aGlzLnBlcmNlbnRhZ2VOdW1lcmF0b3IgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucGVyY2VudGFnZU51bWVyYXRvciA+IHRoaXMucGVyY2VudGFnZURlbm9taW5hdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZGlzdHJpYnV0aW9uIG1vZGVsIG1heSBiZSBudWxsXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZTtcbn0oQ2FtcGFpZ25Ob21pbmF0aW9uU2NoZW1lKSk7XG5leHBvcnRzLkNhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZSA9IENhbXBhaWduTm9taW5hdGlvblNjaGVtZVJhdGlvUGVyY2VudGFnZTtcbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIFN1cnZleSBFdmVudCBEZWZpbml0aW9uc1xudmFyIENhbXBhaWduU3VydmV5RXZlbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25TdXJ2ZXlFdmVudCgpIHtcbiAgICB9XG4gICAgQ2FtcGFpZ25TdXJ2ZXlFdmVudC5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGlucHV0LlR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5LmRlc2VyaWFsaXplKGlucHV0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5U2VxdWVuY2UuZGVzZXJpYWxpemUoaW5wdXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENhbXBhaWduU3VydmV5RXZlbnQucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnblN1cnZleUV2ZW50O1xufSgpKTtcbmV4cG9ydHMuQ2FtcGFpZ25TdXJ2ZXlFdmVudCA9IENhbXBhaWduU3VydmV5RXZlbnQ7XG52YXIgQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eSwgX3N1cGVyKTtcbiAgICAvLyBwdWJsaWMgZm9yIFVUIG9ubHlcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICB9XG4gICAgQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eS5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduU3VydmV5RXZlbnRDb3VudGVkQWN0aXZpdHkoKTtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LmFjdGl2aXR5ID0gaW5wdXQuQWN0aXZpdHk7XG4gICAgICAgIHJlc3VsdC5jb3VudCA9IGlucHV0LkNvdW50O1xuICAgICAgICByZXN1bHQuaXNBZ2dyZWdhdGUgPSBpbnB1dC5Jc0FnZ3JlZ2F0ZTtcbiAgICAgICAgaWYgKCFyZXN1bHQudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduU3VydmV5RXZlbnRDb3VudGVkQWN0aXZpdHkucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIV9zdXBlci5wcm90b3R5cGUudmFsaWRhdGUuY2FsbCh0aGlzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLmFjdGl2aXR5KSB8fCAhVXRpbHMuaXNTdHJpbmcodGhpcy5hY3Rpdml0eSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIVV0aWxzLmlzTnVtYmVyKHRoaXMuY291bnQpIHx8IHRoaXMuY291bnQgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghVXRpbHMuaXNCb29sZWFuKHRoaXMuaXNBZ2dyZWdhdGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eTtcbn0oQ2FtcGFpZ25TdXJ2ZXlFdmVudCkpO1xuZXhwb3J0cy5DYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5ID0gQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eTtcbnZhciBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5U2VxdWVuY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENhbXBhaWduU3VydmV5RXZlbnRDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZSwgX3N1cGVyKTtcbiAgICAvLyBwdWJsaWMgZm9yIFVUIG9ubHlcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5U2VxdWVuY2UoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5U2VxdWVuY2UuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5U2VxdWVuY2UoKTtcbiAgICAgICAgdmFyIHNlcXVlbmNlID0gW107XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBpbnB1dC5TZXF1ZW5jZSkge1xuICAgICAgICAgICAgaWYgKGlucHV0LlNlcXVlbmNlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZEFjdGl2aXR5ID0gaW5wdXQuU2VxdWVuY2Vba2V5XTtcbiAgICAgICAgICAgICAgICBpZiAocmVhZEFjdGl2aXR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlcXVlbmNlLnB1c2goQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eS5kZXNlcmlhbGl6ZShyZWFkQWN0aXZpdHkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlcXVlbmNlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgc2VxdWVuY2UgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5zZXF1ZW5jZSA9IHNlcXVlbmNlO1xuICAgICAgICBpZiAoIXJlc3VsdC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eVNlcXVlbmNlLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnZhbGlkYXRlLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zZXF1ZW5jZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5zZXF1ZW5jZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2VxdWVuY2UuaGFzT3duUHJvcGVydHkoa2V5KSAmJiAhdGhpcy5zZXF1ZW5jZVtrZXldKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduU3VydmV5RXZlbnRDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZTtcbn0oQ2FtcGFpZ25TdXJ2ZXlFdmVudCkpO1xuZXhwb3J0cy5DYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5U2VxdWVuY2UgPSBDYW1wYWlnblN1cnZleUV2ZW50Q291bnRlZEFjdGl2aXR5U2VxdWVuY2U7XG4vLyBlbmRyZWdpb25cbi8vIHJlZ2lvbiBTdXJ2ZXkgQ29udGVudCBEZWZpbml0aW9uc1xudmFyIENhbXBhaWduU3VydmV5Q29udGVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN1cnZleUNvbnRlbnQoKSB7XG4gICAgfVxuICAgIENhbXBhaWduU3VydmV5Q29udGVudC5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduU3VydmV5Q29udGVudCgpO1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQucHJvbXB0ID0gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50UHJvbXB0LmRlc2VyaWFsaXplKGlucHV0LlByb21wdCk7XG4gICAgICAgIHJlc3VsdC5yYXRpbmcgPSBDYW1wYWlnblN1cnZleUNvbnRlbnRSYXRpbmcuZGVzZXJpYWxpemUoaW5wdXQuUmF0aW5nKTtcbiAgICAgICAgcmVzdWx0LmNvbW1lbnQgPSBDYW1wYWlnblN1cnZleUNvbnRlbnRDb21tZW50LmRlc2VyaWFsaXplKGlucHV0LlF1ZXN0aW9uKTtcbiAgICAgICAgaWYgKCFyZXN1bHQudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENhbXBhaWduU3VydmV5Q29udGVudC5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGJvdGggcmF0aW5nIGFuZCBjb21tZW50IGFyZSByZXF1aXJlZCAtIGluIHN5bmMgd2l0aCBjdXJyZW50IHZlcnNpb24gb2YgbXNvIGltcGxlbWVudGF0aW9uLlxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wcm9tcHQpIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucmF0aW5nKSB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLmNvbW1lbnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50O1xufSgpKTtcbmV4cG9ydHMuQ2FtcGFpZ25TdXJ2ZXlDb250ZW50ID0gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50O1xudmFyIENhbXBhaWduU3VydmV5Q29udGVudFByb21wdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN1cnZleUNvbnRlbnRQcm9tcHQoKSB7XG4gICAgfVxuICAgIENhbXBhaWduU3VydmV5Q29udGVudFByb21wdC5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduU3VydmV5Q29udGVudFByb21wdCgpO1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQudGl0bGUgPSBpbnB1dC5UaXRsZTtcbiAgICAgICAgcmVzdWx0LnF1ZXN0aW9uID0gaW5wdXQuUXVlc3Rpb247XG4gICAgICAgIHJlc3VsdC55ZXNMYWJlbCA9IGlucHV0Llllc0xhYmVsO1xuICAgICAgICByZXN1bHQubm9MYWJlbCA9IGlucHV0Lk5vTGFiZWw7XG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBDYW1wYWlnblN1cnZleUNvbnRlbnRQcm9tcHQucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy50aXRsZSkgfHwgIVV0aWxzLmlzU3RyaW5nKHRoaXMudGl0bGUpIHx8XG4gICAgICAgICAgICBVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLnF1ZXN0aW9uKSB8fCAhVXRpbHMuaXNTdHJpbmcodGhpcy5xdWVzdGlvbikgfHxcbiAgICAgICAgICAgIFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMueWVzTGFiZWwpIHx8ICFVdGlscy5pc1N0cmluZyh0aGlzLnllc0xhYmVsKSB8fFxuICAgICAgICAgICAgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5ub0xhYmVsKSB8fCAhVXRpbHMuaXNTdHJpbmcodGhpcy5ub0xhYmVsKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduU3VydmV5Q29udGVudFByb21wdDtcbn0oKSk7XG5leHBvcnRzLkNhbXBhaWduU3VydmV5Q29udGVudFByb21wdCA9IENhbXBhaWduU3VydmV5Q29udGVudFByb21wdDtcbnZhciBDYW1wYWlnblN1cnZleUNvbnRlbnRSYXRpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50UmF0aW5nKCkge1xuICAgIH1cbiAgICBDYW1wYWlnblN1cnZleUNvbnRlbnRSYXRpbmcuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW1wYWlnblN1cnZleUNvbnRlbnRSYXRpbmcoKTtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LmlzWmVyb0Jhc2VkID0gaW5wdXQuSXNaZXJvQmFzZWQ7XG4gICAgICAgIHJlc3VsdC5xdWVzdGlvbiA9IGlucHV0LlF1ZXN0aW9uO1xuICAgICAgICByZXN1bHQucmF0aW5nVmFsdWVzQXNjZW5kaW5nID0gaW5wdXQuUmF0aW5nVmFsdWVzQXNjZW5kaW5nO1xuICAgICAgICBpZiAoIXJlc3VsdC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQ2FtcGFpZ25TdXJ2ZXlDb250ZW50UmF0aW5nLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gZXhwZWN0IHJhdGluZ1ZhbHVlc0FzY2VuZGluZyB0byBjb250YWluIGJldHdlZW4gMiB0byAxMSB2YWx1ZXNcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucXVlc3Rpb24pIHx8ICFVdGlscy5pc1N0cmluZyh0aGlzLnF1ZXN0aW9uKSB8fFxuICAgICAgICAgICAgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5yYXRpbmdWYWx1ZXNBc2NlbmRpbmcpIHx8ICFBcnJheS5pc0FycmF5KHRoaXMucmF0aW5nVmFsdWVzQXNjZW5kaW5nKSB8fFxuICAgICAgICAgICAgdGhpcy5yYXRpbmdWYWx1ZXNBc2NlbmRpbmcubGVuZ3RoIDwgMiB8fCB0aGlzLnJhdGluZ1ZhbHVlc0FzY2VuZGluZy5sZW5ndGggPiAxMSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLmlzWmVyb0Jhc2VkKSkge1xuICAgICAgICAgICAgLy8gZGVmYXVsdCB0byBmYWxzZSBpZiBub3QgcHJvdmlkZWRcbiAgICAgICAgICAgIHRoaXMuaXNaZXJvQmFzZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghVXRpbHMuaXNCb29sZWFuKHRoaXMuaXNaZXJvQmFzZWQpKSB7XG4gICAgICAgICAgICAvLyBmYWlsIHZhbGlkYXRpb24gaWYgbm9uIGJvb2xlYW4gdmFsdWUgaXMgcHJvdmlkZWRcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBleHBlY3QgYWxsIHJhdGluZ1ZhbHVlc0FzY2VuZGluZyB2YWx1ZXMgdG8gYmUgc3RyaW5nXG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLnJhdGluZ1ZhbHVlc0FzY2VuZGluZykge1xuICAgICAgICAgICAgaWYgKHRoaXMucmF0aW5nVmFsdWVzQXNjZW5kaW5nLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIVV0aWxzLmlzU3RyaW5nKHRoaXMucmF0aW5nVmFsdWVzQXNjZW5kaW5nW2tleV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50UmF0aW5nO1xufSgpKTtcbmV4cG9ydHMuQ2FtcGFpZ25TdXJ2ZXlDb250ZW50UmF0aW5nID0gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50UmF0aW5nO1xudmFyIENhbXBhaWduU3VydmV5Q29udGVudENvbW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50Q29tbWVudCgpIHtcbiAgICB9XG4gICAgQ2FtcGFpZ25TdXJ2ZXlDb250ZW50Q29tbWVudC5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IENhbXBhaWduU3VydmV5Q29udGVudENvbW1lbnQoKTtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQFNlcmlhbGl6ZWROYW1lKFwiUXVlc3Rpb25cIilcbiAgICAgICAgcmVzdWx0LnF1ZXN0aW9uID0gaW5wdXQuUXVlc3Rpb247XG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBDYW1wYWlnblN1cnZleUNvbnRlbnRDb21tZW50LnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucXVlc3Rpb24pIHx8ICFVdGlscy5pc1N0cmluZyh0aGlzLnF1ZXN0aW9uKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduU3VydmV5Q29udGVudENvbW1lbnQ7XG59KCkpO1xuZXhwb3J0cy5DYW1wYWlnblN1cnZleUNvbnRlbnRDb21tZW50ID0gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50Q29tbWVudDtcbi8vIGVuZHJlZ2lvblxuLy8gcmVnaW9uIFN1cnZleSBUZW1wbGF0ZSBkZWZpbml0aW9uc1xudmFyIENhbXBhaWduU3VydmV5VGVtcGxhdGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZSgpIHtcbiAgICB9XG4gICAgQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZS5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoaW5wdXQpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGlucHV0LlR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzNVBvaW50U3RhdGljLmRlc2VyaWFsaXplKGlucHV0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzMTFQb2ludFN0YXRpYy5kZXNlcmlhbGl6ZShpbnB1dCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZUZwcy5kZXNlcmlhbGl6ZShpbnB1dCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZU5scXMuZGVzZXJpYWxpemUoaW5wdXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMuZGVzZXJpYWxpemUoaW5wdXQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENhbXBhaWduU3VydmV5VGVtcGxhdGUucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5hY3RpdmF0aW9uRXZlbnQpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZTtcbn0oKSk7XG5leHBvcnRzLkNhbXBhaWduU3VydmV5VGVtcGxhdGUgPSBDYW1wYWlnblN1cnZleVRlbXBsYXRlO1xudmFyIENhbXBhaWduU3VydmV5VGVtcGxhdGVGcHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENhbXBhaWduU3VydmV5VGVtcGxhdGVGcHMsIF9zdXBlcik7XG4gICAgLy8gcHVibGljIGZvciBVVCBvbmx5XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZUZwcygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduU3VydmV5VGVtcGxhdGVGcHMuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW1wYWlnblN1cnZleVRlbXBsYXRlRnBzKCk7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5hY3RpdmF0aW9uRXZlbnQgPSBDYW1wYWlnblN1cnZleUV2ZW50LmRlc2VyaWFsaXplKGlucHV0LkFjdGl2YXRpb25FdmVudCk7XG4gICAgICAgIHJlc3VsdC5jb250ZW50ID0gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50LmRlc2VyaWFsaXplKGlucHV0LkNvbnRlbnQpO1xuICAgICAgICBpZiAoIXJlc3VsdC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZUZwcy5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS52YWxpZGF0ZS5jYWxsKHRoaXMpIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY29udGVudCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnblN1cnZleVRlbXBsYXRlRnBzO1xufShDYW1wYWlnblN1cnZleVRlbXBsYXRlKSk7XG5leHBvcnRzLkNhbXBhaWduU3VydmV5VGVtcGxhdGVGcHMgPSBDYW1wYWlnblN1cnZleVRlbXBsYXRlRnBzO1xudmFyIENhbXBhaWduU3VydmV5VGVtcGxhdGVObHFzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDYW1wYWlnblN1cnZleVRlbXBsYXRlTmxxcywgX3N1cGVyKTtcbiAgICAvLyBwdWJsaWMgZm9yIFVUIG9ubHlcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN1cnZleVRlbXBsYXRlTmxxcygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduU3VydmV5VGVtcGxhdGVObHFzLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBuZXcgQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZU5scXMoKTtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LmFjdGl2YXRpb25FdmVudCA9IENhbXBhaWduU3VydmV5RXZlbnQuZGVzZXJpYWxpemUoaW5wdXQuQWN0aXZhdGlvbkV2ZW50KTtcbiAgICAgICAgcmVzdWx0LmNvbnRlbnQgPSBDYW1wYWlnblN1cnZleUNvbnRlbnQuZGVzZXJpYWxpemUoaW5wdXQuQ29udGVudCk7XG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBDYW1wYWlnblN1cnZleVRlbXBsYXRlTmxxcy5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS52YWxpZGF0ZS5jYWxsKHRoaXMpIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY29udGVudCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnblN1cnZleVRlbXBsYXRlTmxxcztcbn0oQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZSkpO1xuZXhwb3J0cy5DYW1wYWlnblN1cnZleVRlbXBsYXRlTmxxcyA9IENhbXBhaWduU3VydmV5VGVtcGxhdGVObHFzO1xudmFyIENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMsIF9zdXBlcik7XG4gICAgLy8gcHVibGljIGZvciBVVCBvbmx5XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZU5wcygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzKCk7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5hY3RpdmF0aW9uRXZlbnQgPSBDYW1wYWlnblN1cnZleUV2ZW50LmRlc2VyaWFsaXplKGlucHV0LkFjdGl2YXRpb25FdmVudCk7XG4gICAgICAgIHJlc3VsdC5jb250ZW50ID0gQ2FtcGFpZ25TdXJ2ZXlDb250ZW50LmRlc2VyaWFsaXplKGlucHV0LkNvbnRlbnQpO1xuICAgICAgICBpZiAoIXJlc3VsdC52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZU5wcy5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS52YWxpZGF0ZS5jYWxsKHRoaXMpIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY29udGVudCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzO1xufShDYW1wYWlnblN1cnZleVRlbXBsYXRlKSk7XG5leHBvcnRzLkNhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMgPSBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzO1xudmFyIENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHM1UG9pbnRTdGF0aWMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHM1UG9pbnRTdGF0aWMsIF9zdXBlcik7XG4gICAgLy8gcHVibGljIGZvciBVVCBvbmx5XG4gICAgZnVuY3Rpb24gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZU5wczVQb2ludFN0YXRpYygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHM1UG9pbnRTdGF0aWMuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzNVBvaW50U3RhdGljKCk7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5hY3RpdmF0aW9uRXZlbnQgPSBDYW1wYWlnblN1cnZleUV2ZW50LmRlc2VyaWFsaXplKGlucHV0LkFjdGl2YXRpb25FdmVudCk7XG4gICAgICAgIGlmICghcmVzdWx0LnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzNVBvaW50U3RhdGljLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnZhbGlkYXRlLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzNVBvaW50U3RhdGljO1xufShDYW1wYWlnblN1cnZleVRlbXBsYXRlKSk7XG5leHBvcnRzLkNhbXBhaWduU3VydmV5VGVtcGxhdGVOcHM1UG9pbnRTdGF0aWMgPSBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzNVBvaW50U3RhdGljO1xudmFyIENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMxMVBvaW50U3RhdGljID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzMTFQb2ludFN0YXRpYywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzMTFQb2ludFN0YXRpYygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMxMVBvaW50U3RhdGljLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBuZXcgQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZU5wczExUG9pbnRTdGF0aWMoKTtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGlucHV0KSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LmFjdGl2YXRpb25FdmVudCA9IENhbXBhaWduU3VydmV5RXZlbnQuZGVzZXJpYWxpemUoaW5wdXQuQWN0aXZhdGlvbkV2ZW50KTtcbiAgICAgICAgaWYgKCFyZXN1bHQudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMxMVBvaW50U3RhdGljLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnZhbGlkYXRlLmNhbGwodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIHJldHVybiBDYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzMTFQb2ludFN0YXRpYztcbn0oQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZSkpO1xuZXhwb3J0cy5DYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzMTFQb2ludFN0YXRpYyA9IENhbXBhaWduU3VydmV5VGVtcGxhdGVOcHMxMVBvaW50U3RhdGljO1xuLy8gZW5kcmVnaW9uXG4vLyByZWdpb24gQ2FtcGFpZ24gRGVmaW5pdGlvblxudmFyIENhbXBhaWduRGVmaW5pdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnbkRlZmluaXRpb24oKSB7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gb2JqZWN0IHRvIGNsYXNzIG9iamVjdFxuICAgICAqIEBwYXJhbSBpbnB1dDogSlNPTiBvYmplY3RcbiAgICAgKiBSZXR1cm5zIHJlc3VsdCBvZiB2YWxpZGF0aW9uIGNoZWNrXG4gICAgICovXG4gICAgQ2FtcGFpZ25EZWZpbml0aW9uLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBuZXcgQ2FtcGFpZ25EZWZpbml0aW9uKCk7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChpbnB1dCkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5jYW1wYWlnbklkID0gaW5wdXQuQ2FtcGFpZ25JZDtcbiAgICAgICAgcmVzdWx0LmdvdmVybmVkQ2hhbm5lbFR5cGUgPSBpbnB1dC5Hb3Zlcm5lZENoYW5uZWxUeXBlO1xuICAgICAgICByZXN1bHQuc3RhcnRUaW1lID0gaW5wdXQuU3RhcnRUaW1lVXRjO1xuICAgICAgICByZXN1bHQuZW5kVGltZSA9IGlucHV0LkVuZFRpbWVVdGM7XG4gICAgICAgIHZhciBhZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCA9IENhbXBhaWduQWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQuZGVzZXJpYWxpemUoaW5wdXQuQWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQpO1xuICAgICAgICByZXN1bHQuYWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQgPSBhZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCA/IGFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkLmFkZGl0aW9uYWxEYXRhIDogW107XG4gICAgICAgIGlmIChpbnB1dC5TdXJ2ZXlUZW1wbGF0ZSkge1xuICAgICAgICAgICAgcmVzdWx0LnN1cnZleVRlbXBsYXRlID0gQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZS5kZXNlcmlhbGl6ZShpbnB1dC5TdXJ2ZXlUZW1wbGF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlucHV0Lk5vbWluYXRpb25TY2hlbWUpIHtcbiAgICAgICAgICAgIHJlc3VsdC5ub21pbmF0aW9uU2NoZW1lID0gQ2FtcGFpZ25Ob21pbmF0aW9uU2NoZW1lLmRlc2VyaWFsaXplKGlucHV0Lk5vbWluYXRpb25TY2hlbWUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnB1dC5TY29wZSkge1xuICAgICAgICAgICAgcmVzdWx0LnNjb3BlID0gQ2FtcGFpZ25TY29wZS5kZXNlcmlhbGl6ZShpbnB1dC5TY29wZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZXN1bHQudmFsaWRhdGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIENhbXBhaWduRGVmaW5pdGlvbi5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLnNjb3BlKSkge1xuICAgICAgICAgICAgdGhpcy5zY29wZSA9IG5ldyBDYW1wYWlnblNjb3BlQW55KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuY2FtcGFpZ25JZCkgfHwgIVV0aWxzLmlzU3RyaW5nKHRoaXMuY2FtcGFpZ25JZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIVV0aWxzLmlzTnVtYmVyKHRoaXMuZ292ZXJuZWRDaGFubmVsVHlwZSkgfHwgIVV0aWxzLmlzRW51bVZhbHVlKHRoaXMuZ292ZXJuZWRDaGFubmVsVHlwZSwgR292ZXJuZWRDaGFubmVsXzEuR292ZXJuZWRDaGFubmVsVHlwZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5ub21pbmF0aW9uU2NoZW1lKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLnN1cnZleVRlbXBsYXRlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIENhbXBhaWducyB3aXRoIG5vIHN0YXJ0IGRhdGUgYXJlIGVmZmVjdGl2ZWx5IGRpc2FibGVkLCBpbiBmYWN0LCB0aGlzIGlzIHRoZSBzdXBwb3J0ZWQgd2F5IHRvIHN0YWdlIGEgZGVmaW5pdGlvbiBidXQgaGF2ZSBpdCBiZSB0dXJuZWQgb2ZmXG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLnN0YXJ0VGltZSkpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lID0gVXRpbHMuZ2V0RGlzdGFudEZ1dHVyZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKFV0aWxzLmlzVXRjRGF0ZXRpbWVTdHJpbmcodGhpcy5zdGFydFRpbWUpKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IFV0aWxzLnN0cmluZ1RvRGF0ZSh0aGlzLnN0YXJ0VGltZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2FtcGFpZ25zIHdpdGggbm8gZW5kIGRhdGUgYXJlIGVmZmVjdGl2ZWx5IG9uIGluZGVmaW5pdGVseVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5lbmRUaW1lKSkge1xuICAgICAgICAgICAgdGhpcy5lbmRUaW1lID0gVXRpbHMuZ2V0RGlzdGFudEZ1dHVyZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKFV0aWxzLmlzVXRjRGF0ZXRpbWVTdHJpbmcodGhpcy5lbmRUaW1lKSkge1xuICAgICAgICAgICAgdGhpcy5lbmRUaW1lID0gVXRpbHMuc3RyaW5nVG9EYXRlKHRoaXMuZW5kVGltZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25EZWZpbml0aW9uO1xufSgpKTtcbmV4cG9ydHMuQ2FtcGFpZ25EZWZpbml0aW9uID0gQ2FtcGFpZ25EZWZpbml0aW9uO1xuLyoqXG4gKiBHaXZlbiBhbiBhcnJheSBvZiBjYW1wYWlnbiBkZWZpbml0aW9ucywgcmV0dXJucyB0aGUgdmFsaWQgb25lcyBhbmQgZXJyb3JzIGlmIGFueSBhcmUgaW52YWxpZC5cbiAqIEBwYXJhbSBpbnB1dDogSlNPTiBvYmplY3RcbiAqIFJldHVybnMgdGhlIHZhbGlkIGRlZmluaXRpb25zIGFuZCB0aGUgZXJyb3IgYXMgc3RyaW5nIGlmIGFueS5cbiAqL1xuZnVuY3Rpb24gRmlsdGVyVmFsaWRDYW1wYWlnbkRlZmluaXRpb25zKGNhbXBhaWduRGVmaW5pdGlvbnMpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGNhbXBhaWduRGVmaW5pdGlvbnMpKSB7XG4gICAgICAgIHJldHVybiB7IHJlc3VsdDogcmVzdWx0LCBlcnJvcjogXCJFbXB0eVwiIH07XG4gICAgfVxuICAgIGlmICghQXJyYXkuaXNBcnJheShjYW1wYWlnbkRlZmluaXRpb25zKSkge1xuICAgICAgICByZXR1cm4geyByZXN1bHQ6IHJlc3VsdCwgZXJyb3I6IFwiTm90IGFuIGFycmF5XCIgfTtcbiAgICB9XG4gICAgdmFyIGJhZEluZGV4ZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbXBhaWduRGVmaW5pdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGRlZmluaXRpb24gPSBjYW1wYWlnbkRlZmluaXRpb25zW2ldO1xuICAgICAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgICAgICAgdmFyIG5ld0RlZmluaXRpb24gPSBDYW1wYWlnbkRlZmluaXRpb24uZGVzZXJpYWxpemUoZGVmaW5pdGlvbik7XG4gICAgICAgICAgICBuZXdEZWZpbml0aW9uXG4gICAgICAgICAgICAgICAgPyByZXN1bHQucHVzaChuZXdEZWZpbml0aW9uKVxuICAgICAgICAgICAgICAgIDogYmFkSW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYmFkSW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBlcnJvciA9IGJhZEluZGV4ZXMubGVuZ3RoID4gMCA/IFwiSW52YWxpZCBjYW1wYWlnbiBkZWZpbml0aW9ucyBhdCBpbmRleGVzOiBcIiArIGJhZEluZGV4ZXMudG9TdHJpbmcoKSA6IHVuZGVmaW5lZDtcbiAgICByZXR1cm4geyByZXN1bHQ6IHJlc3VsdCwgZXJyb3I6IGVycm9yIH07XG59XG5leHBvcnRzLkZpbHRlclZhbGlkQ2FtcGFpZ25EZWZpbml0aW9ucyA9IEZpbHRlclZhbGlkQ2FtcGFpZ25EZWZpbml0aW9ucztcbnZhciBGaWxlU3lzdGVtQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmlsZVN5c3RlbUNhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyKHN0b3JhZ2UpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHN0b3JhZ2UpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzdG9yYWdlIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcbiAgICB9XG4gICAgRmlsZVN5c3RlbUNhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZGVmaW5pdGlvblN0cmluZyA9IHRoaXMuc3RvcmFnZS5yZWFkKElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIuRmlsZVR5cGUuQ2FtcGFpZ25EZWZpbml0aW9ucyk7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkZWZpbml0aW9uU3RyaW5nKSkge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZWFkRGVmaW5pdGlvbnM7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZWFkRGVmaW5pdGlvbnMgPSBKU09OLnBhcnNlKGRlZmluaXRpb25TdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBGbG9vZGdhdGVFbmdpbmVfMS5GbG9vZGdhdGVFbmdpbmUuZ2V0VGVsZW1ldHJ5TG9nZ2VyKCkubG9nX0NhbXBhaWduTG9hZF9GYWlsZWQoZS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGlzIGlnbm9yZXMgZXJyb3JzIGluIHZhbGlkYXRpb24gZm9yIG5vdy5cbiAgICAgICAgcmV0dXJuIEZpbHRlclZhbGlkQ2FtcGFpZ25EZWZpbml0aW9ucyhyZWFkRGVmaW5pdGlvbnMpLnJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBGaWxlU3lzdGVtQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXI7XG59KCkpO1xuZXhwb3J0cy5GaWxlU3lzdGVtQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXIgPSBGaWxlU3lzdGVtQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBVdGlscyA9IHJlcXVpcmUoXCIuLi9VdGlsc1wiKTtcbnZhciBDYW1wYWlnbkRlZmluaXRpb25Qcm92aWRlcl8xID0gcmVxdWlyZShcIi4vQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJcIik7XG52YXIgQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9DYW1wYWlnblN0YXRlUHJvdmlkZXJcIik7XG52YXIgQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5XzEgPSByZXF1aXJlKFwiLi9DYW1wYWlnblN1cnZleUZhY3RvcnlcIik7XG4vKipcbiAqIFRoZSBzdGFuZGFyZCBjYW1wYWlnbiBtYW5hZ2VyIGltcGxlbWVudGF0aW9uLlxuICovXG52YXIgQ2FtcGFpZ25NYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENhbXBhaWduTWFuYWdlcihzdGF0ZVByb3ZpZGVyLCBkZWZpbml0aW9uUHJvdmlkZXIsIHN0cmluZ1Byb3ZpZGVyLCBlbnZpcm9ubWVudFByb3ZpZGVyLCBjdXJyZW50QnVpbGROdW1iZXIsIGN1cnJlbnREYXRlKSB7XG4gICAgICAgIGlmICghc3RhdGVQcm92aWRlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic3RhdGVQcm92aWRlciBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGVmaW5pdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkZWZpbml0aW9uUHJvdmlkZXIgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0cmluZ1Byb3ZpZGVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzdHJpbmdQcm92aWRlciBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChjdXJyZW50QnVpbGROdW1iZXIpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjdXJyZW50QnVpbGROdW1iZXIgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNhbXBhaWduU3RhdGVzID0ge307XG4gICAgICAgIHRoaXMuY2FtcGFpZ25EZWZpbml0aW9ucyA9IHt9O1xuICAgICAgICB0aGlzLnN0YXRlUHJvdmlkZXIgPSBzdGF0ZVByb3ZpZGVyO1xuICAgICAgICB0aGlzLmRlZmluaXRpb25Qcm92aWRlciA9IGRlZmluaXRpb25Qcm92aWRlcjtcbiAgICAgICAgdGhpcy5zdHJpbmdQcm92aWRlciA9IHN0cmluZ1Byb3ZpZGVyO1xuICAgICAgICB0aGlzLmVudmlyb25tZW50UHJvdmlkZXIgPSBlbnZpcm9ubWVudFByb3ZpZGVyOyAvLyBDYW4gYmUgbnVsbFxuICAgICAgICB0aGlzLmN1cnJlbnRCdWlsZE51bWJlciA9IGN1cnJlbnRCdWlsZE51bWJlcjtcbiAgICAgICAgY3VycmVudERhdGUgPSBjdXJyZW50RGF0ZSA/IGN1cnJlbnREYXRlIDogbmV3IERhdGUoKTtcbiAgICAgICAgLy8gVE9ETyBjaGVjayBcImFmdGVyIHRlc3QgcmVmYWN0b3JpbmcgLSByZW1vdmUgdGhpcyBhbmQgcmVseSBvbiBhIGNhbGwgdG8gXCJyZWZyZXNoXCIgdG8gZG8gdGhpcyB3b3JrXCJcbiAgICAgICAgdGhpcy5yZWZyZXNoU3VydmV5RGVmaW5pdGlvbnNQcml2YXRlKG51bGwsIGN1cnJlbnREYXRlKTtcbiAgICB9XG4gICAgQ2FtcGFpZ25NYW5hZ2VyLmlzU3RhdGVVcEZvck5vbWluYXRpb24gPSBmdW5jdGlvbiAoc3RhdGUsIGRlZmluaXRpb24sIGRhdGUsIGJ1aWxkTnVtYmVyKSB7XG4gICAgICAgIGlmICghc3RhdGUgfHwgIWRlZmluaXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBkYXRlID0gZGF0ZSA/IGRhdGUgOiBuZXcgRGF0ZSgpO1xuICAgICAgICAvLyBDaGVjayBtYW51YWwgb3ZlcnJpZGVcbiAgICAgICAgaWYgKHN0YXRlLkZvcmNlQ2FuZGlkYWN5KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBGaWd1cmUgb3V0IHdoaWNoIGR1cmF0aW9uIHdlJ3JlIHVzaW5nIGJhc2VkIG9uIHdoZXRoZXIgb3Igbm90IHRoZSB1c2VyIHRyaWdnZXJlZCB0aGUgc3VydmV5XG4gICAgICAgIHZhciBjYW1wYWlnbkNvb2xkb3duRHVyYXRpb24gPSBkZWZpbml0aW9uLm5vbWluYXRpb25TY2hlbWUuZ2V0Q2FtcGFpZ25Db29sZG93bihzdGF0ZS5Jc0NhbmRpZGF0ZSAmJiBzdGF0ZS5EaWRDYW5kaWRhdGVUcmlnZ2VyU3VydmV5KTtcbiAgICAgICAgaWYgKCFjYW1wYWlnbkNvb2xkb3duRHVyYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBGaXJzdCBjaGVjayBmb3IgYnVpbGQtYmFzZWQgcnVsZXMuIEV2ZW50dWFsbHkgdGhpcyBjb3VsZCBnZXQgbW9yZSBjb21wbGV4IGlmIHdlIHN1cHBvcnRlZCBjb3VudGluZyBkaWZmZXJlbnRseSBzZWVuIGJ1aWxkIG51bWJlcnNcbiAgICAgICAgaWYgKENhbXBhaWduTWFuYWdlci5oYXNCdWlsZENoYW5nZUR1cmF0aW9uRWxhcHNlZChjYW1wYWlnbkNvb2xkb3duRHVyYXRpb24sIHN0YXRlLkxhc3ROb21pbmF0aW9uQnVpbGROdW1iZXIsIGJ1aWxkTnVtYmVyKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gTmV4dCBjaGVjayBkYXRlIHJ1bGVzXG4gICAgICAgIHJldHVybiBDYW1wYWlnbk1hbmFnZXIuaGFzVGltZUludGVydmFsRHVyYXRpb25FbGFwc2VkKGNhbXBhaWduQ29vbGRvd25EdXJhdGlvbiwgc3RhdGUuZ2V0Q29vbGRvd25TdGFydERhdGUoKSwgZGF0ZSk7XG4gICAgfTtcbiAgICBDYW1wYWlnbk1hbmFnZXIuaXNEYXRlSW5SYW5nZSA9IGZ1bmN0aW9uIChkYXRlLCBzdGFydERhdGUsIGVuZERhdGUpIHtcbiAgICAgICAgZGF0ZSA9IGRhdGUgPyBkYXRlIDogbmV3IERhdGUoKTtcbiAgICAgICAgc3RhcnREYXRlID0gc3RhcnREYXRlID8gc3RhcnREYXRlIDogVXRpbHMuZ2V0RGlzdGFudFBhc3QoKTtcbiAgICAgICAgZW5kRGF0ZSA9IGVuZERhdGUgPyBlbmREYXRlIDogVXRpbHMuZ2V0RGlzdGFudEZ1dHVyZSgpO1xuICAgICAgICAvLyBDaGVjayBTdGFydC9FeHBpcmUgZGF0ZSByYW5nZVxuICAgICAgICBpZiAoc3RhcnREYXRlLmdldFRpbWUoKSA8PSBkYXRlLmdldFRpbWUoKSAmJiBlbmREYXRlLmdldFRpbWUoKSA+PSBkYXRlLmdldFRpbWUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgQ2FtcGFpZ25NYW5hZ2VyLmhhc1RpbWVJbnRlcnZhbER1cmF0aW9uRWxhcHNlZCA9IGZ1bmN0aW9uIChkdXJhdGlvbiwgc3RhcnREYXRlLCBkYXRlKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkdXJhdGlvbikgfHwgIShkdXJhdGlvbiBpbnN0YW5jZW9mIENhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyXzEuQ2FtcGFpZ25EdXJhdGlvblRpbWVJbnRlcnZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0YXJ0RGF0ZSB8fCAhZGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbmREYXRlID0gVXRpbHMuYWRkU2Vjb25kc1dpdGhvdXRPdmVyZmxvdyhzdGFydERhdGUsIGR1cmF0aW9uLmludGVydmFsU2Vjb25kcyk7XG4gICAgICAgIHJldHVybiBkYXRlLmdldFRpbWUoKSA+PSBlbmREYXRlLmdldFRpbWUoKTtcbiAgICB9O1xuICAgIENhbXBhaWduTWFuYWdlci5oYXNCdWlsZENoYW5nZUR1cmF0aW9uRWxhcHNlZCA9IGZ1bmN0aW9uIChkdXJhdGlvbiwgc3RhcnRCdWlsZCwgYnVpbGQpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGR1cmF0aW9uKSB8fCAhKGR1cmF0aW9uIGluc3RhbmNlb2YgQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJfMS5DYW1wYWlnbkR1cmF0aW9uU2luZ2xlQnVpbGRDaGFuZ2UpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHN0YXJ0QnVpbGQpIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGJ1aWxkKSkge1xuICAgICAgICAgICAgcmV0dXJuIChzdGFydEJ1aWxkID09PSBudWxsKSAhPT0gKGJ1aWxkID09PSBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIShzdGFydEJ1aWxkID09PSBidWlsZCk7XG4gICAgfTtcbiAgICBDYW1wYWlnbk1hbmFnZXIuaXNDYW1wYWlnbkluU2NvcGUgPSBmdW5jdGlvbiAoZGVmaW5pdGlvbiwgZGF0ZSwgZW52aXJvbm1lbnRQcm92aWRlcikge1xuICAgICAgICBpZiAoIWRlZmluaXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBkYXRlID0gZGF0ZSA/IGRhdGUgOiBuZXcgRGF0ZSgpO1xuICAgICAgICAvLyBDaGVjayBTdGFydC9FeHBpcmUgZGF0ZSByYW5nZVxuICAgICAgICBpZiAoIUNhbXBhaWduTWFuYWdlci5pc0RhdGVJblJhbmdlV2l0aERlZmluaXRpb24oZGF0ZSwgZGVmaW5pdGlvbikpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGVmaW5pdGlvbi5zY29wZSkge1xuICAgICAgICAgICAgaWYgKCFkZWZpbml0aW9uLnNjb3BlLmlzSW5TY29wZShlbnZpcm9ubWVudFByb3ZpZGVyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB3ZSBnZXQgaGVyZSwgdGhlIGRlZmluaXRpb24gaXMgcmVsZXZhbnRcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBDYW1wYWlnbk1hbmFnZXIuaXNEYXRlSW5SYW5nZVdpdGhEZWZpbml0aW9uID0gZnVuY3Rpb24gKGRhdGUsIGRlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKCFkZWZpbml0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZGF0ZSA9IGRhdGUgPyBkYXRlIDogbmV3IERhdGUoKTtcbiAgICAgICAgcmV0dXJuIENhbXBhaWduTWFuYWdlci5pc0RhdGVJblJhbmdlKGRhdGUsIFxuICAgICAgICAvLyBudWxsIHN0YXJ0IGRhdGVzIHNob3VsZCBiZSBpbXBvc3NpYmxlLCBidXQgaWYgc2V0LCBzaG91bGQgbWVhbiB0aGUgY2FtcGFpZ24gaXMgZGlzYWJsZWRcbiAgICAgICAgZGVmaW5pdGlvbi5zdGFydFRpbWUgPyBkZWZpbml0aW9uLnN0YXJ0VGltZSA6IFV0aWxzLmdldERpc3RhbnRGdXR1cmUoKSwgZGVmaW5pdGlvbi5lbmRUaW1lKTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduTWFuYWdlci5wcm90b3R5cGUuZ2V0QWN0aXZlU3VydmV5cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN1cnZleXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuY2FtcGFpZ25TdGF0ZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbXBhaWduU3RhdGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLmNhbXBhaWduU3RhdGVzW2tleV07XG4gICAgICAgICAgICAgICAgaWYgKCFzdGF0ZS5Jc0NhbmRpZGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHJlcXVpcmVtZW50IGJlY2F1c2Ugd2Uga2VlcCBzb21lIG90aGVyd2lzZSBcInN0YWxlXCIgY2FtcGFpZ25zIGFyb3VuZCBmb3IgdGhlIHNhdmUgcm91dGluZVxuICAgICAgICAgICAgICAgIHZhciBkZWZpbml0aW9uID0gdGhpcy5jYW1wYWlnbkRlZmluaXRpb25zW3N0YXRlLkNhbXBhaWduSWRdO1xuICAgICAgICAgICAgICAgIGlmICghZGVmaW5pdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHN1cnZleSA9IENhbXBhaWduU3VydmV5RmFjdG9yeV8xLkNhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlU3VydmV5KHN0YXRlLCBkZWZpbml0aW9uLmdvdmVybmVkQ2hhbm5lbFR5cGUsIGRlZmluaXRpb24uc3VydmV5VGVtcGxhdGUsIHRoaXMuc3RyaW5nUHJvdmlkZXIsIGRlZmluaXRpb24uYWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQpO1xuICAgICAgICAgICAgICAgIGlmICghc3VydmV5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdXJ2ZXlzW3N1cnZleS5nZXRTdXJ2ZXlJbmZvKCkuZ2V0SWQoKV0gPSBzdXJ2ZXk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1cnZleXM7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDYW1wYWlnbk1hbmFnZXIucHJvdG90eXBlLm9uQ2FtcGFpZ25TdXJ2ZXlBY3RpdmF0ZWQgPSBmdW5jdGlvbiAoY2FtcGFpZ25JZCwgdGFrZW5EYXRlKSB7XG4gICAgICAgIHZhciBzdGF0ZSA9IHRoaXMuY2FtcGFpZ25TdGF0ZXNbY2FtcGFpZ25JZF07XG4gICAgICAgIGlmICghc3RhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0YWtlbkRhdGUgPSB0YWtlbkRhdGUgPyB0YWtlbkRhdGUgOiBuZXcgRGF0ZSgpO1xuICAgICAgICBzdGF0ZS5tYXJrQ3VycmVudFN1cnZleVRha2VuT25EYXRlKHRha2VuRGF0ZSk7XG4gICAgICAgIHRoaXMuc2F2ZUNhbXBhaWduU3RhdGUoKTtcbiAgICB9O1xuICAgIENhbXBhaWduTWFuYWdlci5wcm90b3R5cGUuZ2V0Q2FtcGFpZ25TdGF0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbXBhaWduU3RhdGVzO1xuICAgIH07XG4gICAgQ2FtcGFpZ25NYW5hZ2VyLnByb3RvdHlwZS5nZXRDYW1wYWlnbkRlZmluaXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jYW1wYWlnbkRlZmluaXRpb25zO1xuICAgIH07XG4gICAgLy8gcmVnaW9uIElTdXJ2ZXlDbGllbnQgbWV0aG9kc1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENhbXBhaWduTWFuYWdlci5wcm90b3R5cGUub25TdXJ2ZXlBY3RpdmF0ZWQgPSBmdW5jdGlvbiAoc3VydmV5SW5mbykge1xuICAgICAgICBpZiAoIXN1cnZleUluZm8pIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uQ2FtcGFpZ25TdXJ2ZXlBY3RpdmF0ZWQoc3VydmV5SW5mby5nZXRCYWNrRW5kSWQoKSwgbmV3IERhdGUoKSk7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDYW1wYWlnbk1hbmFnZXIucHJvdG90eXBlLnJlZnJlc2hTdXJ2ZXlEZWZpbml0aW9ucyA9IGZ1bmN0aW9uIChjaGFubmVsVHlwZXMpIHtcbiAgICAgICAgdGhpcy5yZWZyZXNoU3VydmV5RGVmaW5pdGlvbnNQcml2YXRlKGNoYW5uZWxUeXBlcywgbmV3IERhdGUoKSk7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDYW1wYWlnbk1hbmFnZXIucHJvdG90eXBlLmdldEFwcFN1cnZleXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFjdGl2ZVN1cnZleXMoKTtcbiAgICB9O1xuICAgIC8vIGVuZHJlZ2lvblxuICAgIENhbXBhaWduTWFuYWdlci5wcm90b3R5cGUucmVmcmVzaFN1cnZleURlZmluaXRpb25zUHJpdmF0ZSA9IGZ1bmN0aW9uIChjaGFubmVsVHlwZXMsIGRhdGUpIHtcbiAgICAgICAgdGhpcy5jYW1wYWlnblN0YXRlcyA9IHt9O1xuICAgICAgICB0aGlzLmNhbXBhaWduRGVmaW5pdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5sb2FkQW5kRmlsdGVyQ2FtcGFpZ25EYXRhKGRhdGUsIGNoYW5uZWxUeXBlcyk7XG4gICAgICAgIHRoaXMuZXZhbHVhdGVDYW1wYWlnbnMoZGF0ZSk7XG4gICAgICAgIHRoaXMuc2F2ZUNhbXBhaWduU3RhdGUoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIExvYWQgYW5kIGZpbHRlciB0aGUgY2FtcGFpZ25zIGRlZmluaXRpb25zIGFuZCBzdGF0ZXNcbiAgICAgKi9cbiAgICBDYW1wYWlnbk1hbmFnZXIucHJvdG90eXBlLmxvYWRBbmRGaWx0ZXJDYW1wYWlnbkRhdGEgPSBmdW5jdGlvbiAoY3VycmVudERhdGUsIGNoYW5uZWxUeXBlcykge1xuICAgICAgICBjdXJyZW50RGF0ZSA9IGN1cnJlbnREYXRlID8gY3VycmVudERhdGUgOiBuZXcgRGF0ZSgpO1xuICAgICAgICB2YXIgbG9hZGVkRGVmaW5pdGlvbnNNYXAgPSB7fTtcbiAgICAgICAgdmFyIGxvYWRlZERlZmluaXRpb25zID0gdGhpcy5kZWZpbml0aW9uUHJvdmlkZXIubG9hZCgpO1xuICAgICAgICAvLyBMb2FkIGZpbHRlcmVkIGNhbXBhaWduIGRlZmluaXRpb25zXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBsb2FkZWREZWZpbml0aW9ucykge1xuICAgICAgICAgICAgaWYgKGxvYWRlZERlZmluaXRpb25zLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmaW5pdGlvbiA9IGxvYWRlZERlZmluaXRpb25zW2tleV07XG4gICAgICAgICAgICAgICAgbG9hZGVkRGVmaW5pdGlvbnNNYXBbZGVmaW5pdGlvbi5jYW1wYWlnbklkXSA9IGRlZmluaXRpb247XG4gICAgICAgICAgICAgICAgaWYgKGNoYW5uZWxUeXBlcyAmJiAoY2hhbm5lbFR5cGVzLmluZGV4T2YoZGVmaW5pdGlvbi5nb3Zlcm5lZENoYW5uZWxUeXBlKSA8IDApKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIUNhbXBhaWduTWFuYWdlci5pc0NhbXBhaWduSW5TY29wZShkZWZpbml0aW9uLCBjdXJyZW50RGF0ZSwgdGhpcy5lbnZpcm9ubWVudFByb3ZpZGVyKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1wYWlnbkRlZmluaXRpb25zW2RlZmluaXRpb24uY2FtcGFpZ25JZF0gPSBkZWZpbml0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIExvYWQgY2FtcGFpZ24gc3RhdGUsIGZpbHRlcmluZyBvdXQgdGhlIGV4cGlyZWQgZGVmaW5pdGlvbnNcbiAgICAgICAgdmFyIGxvYWRlZFN0YXRlcyA9IHRoaXMuc3RhdGVQcm92aWRlci5sb2FkKCk7XG4gICAgICAgIHZhciBzdGFsZUxvYWRlZFN0YXRlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gbG9hZGVkU3RhdGVzKSB7XG4gICAgICAgICAgICBpZiAobG9hZGVkU3RhdGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSBsb2FkZWRTdGF0ZXNba2V5XTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FtcGFpZ25EZWZpbml0aW9ucy5oYXNPd25Qcm9wZXJ0eShzdGF0ZS5DYW1wYWlnbklkKSkge1xuICAgICAgICAgICAgICAgICAgICBzdGFsZUxvYWRlZFN0YXRlcy5wdXNoKHN0YXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1wYWlnblN0YXRlc1tzdGF0ZS5DYW1wYWlnbklkXSA9IHN0YXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgICAqIFN0YWxlIFN0YXRlIGRhdGEgY2xlYW51cFxuICAgICAgICAgKiBTdGF0ZSBuZWVkcyB0byBiZSBjbGVhbmVkIHVwIHdoZW46XG4gICAgICAgICAqIDEpIFRoZSBjYW1wYWlnbiBoYXMgZXhwaXJlZFxuICAgICAgICAgKiAyKSBUaGUgY2FtcGFpZ24gaXMgbm8gbG9uZ2VyIHByZXNlbnQgaW4gdGhlIGRlZmluaXRpb25zICh0aGluayBFQ1Mgb3Igb3RoZXIgb3V0YWdlcyBvciB2ZXJ5IG9sZCBleHBpcmF0aW9ucylcbiAgICAgICAgICogICAgSW4gdGhpcyBjYXNlIHRoZSBzdGF0ZSBzaG91bGQgc3RpbGwgYmUgY2xlYW5lZCB1cCBvbiBpdCdzIHJlZWxlY3Rpb24gZGF0ZVxuICAgICAgICAgKiAzKSBXaGVuIHRoZSB1c2VyIGlzIG91dCBvZiBzY29wZSAoZm9yIGFuIG90aGVyd2lzZSBhY3RpdmUgY2FtcGFpZ24pIGFuZCBpcyB1cCBmb3Igbm9taW5hdGlvblxuXHJcbiAgICAgICAgICogVGhpcyBvcHRpbWl6ZXMgdGhlIHVzZXIgZXhwZXJpZW5jZSBpbiBjYXNlIHRoZSBjYW1wYWlnbiBwb3BzIHVwIG9yIGdldHMgcmVuZXdlZCB3aGVuIHdlIHdvdWxkIGhhdmUgcHJlZmVycmVkIHRoZSB1c2VyIHJlbWFpbiBpbiBjb29sIGRvd25cblxyXG4gICAgICAgICAqIDImMyBhcmUgYmFzaWNhbGx5IHRoZSBzYW1lLCBhbmQgMSBpcyBhIHNwZWNpYWwgY2FzZSBvcHRpbWl6YXRpb24gb24gdG9wIG9mIDImMyBmb3IgZWFybGllciBjbGVhbiB1cFxuXHJcbiAgICAgICAgICogVG8gZG8gMiAmIDMsIHdlIGp1c3QgbG9vayBhdCBzdGF0ZXMgd2l0aCBubyBtYXRjaGluZyBkZWZpbml0aW9uIChhZnRlciBmaWx0ZXJpbmcpLCBhbmQgcmVqZWN0IHRoZW0gaWYgdGhleSBhcmUgcGFzdCB0aGVpciBub21pbmF0aW9uIHBlcmlvZFxuICAgICAgICAgKiBUbyBkbyAxLCB3ZSBqdXN0IG5lZWQgdG8ga2VlcCBhIGxpc3QvaGFzaCBvZiB0aGUgZGVmaW5pdGlvbnMgdGhhdCB3ZSBmaWx0ZXJlZCBvdXQgdGhpcyBsb2FkIGN5Y2xlLCBzcGVjaWZpY2FsbHkgZm9yIGV4cGlyYXRpb24gZGF0ZXMsIGFuZCBieXBhc3NcbiAgICAgICAgICogdGhlIGNvb2wgZG93biBcIndhaXRcIiBmb3IgdGhlc2Ugc3BlY2lmaWNhbGx5XG5cclxuICAgICAgICAgKiBGb3Igbm93LCBhbGxvd2luZyBzb21lIFwiZ3JhY2VcIiBmb3IgXCJtaXNzaW5nXCIvXCJibGlwcHlcIiBjYW1wYWlnbiBkZWZpbml0aW9ucyAoaW4gY2FzZSB0aGV5IHBvcCBpbiBhbmQgb3V0IG9mIEVDUykgYnkgZGVmZXJyaW5nIG1pc3NpbmdcbiAgICAgICAgICogZGVsZXRpb24gYnkgYSBkZWxheS10aW1lIHNwZWNpZmllZCBieSB0aGUgb3JpZ2luYWwgY2FtcGFpZ24uXG4gICAgICAgICAqL1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gc3RhbGVMb2FkZWRTdGF0ZXMpIHtcbiAgICAgICAgICAgIGlmIChzdGFsZUxvYWRlZFN0YXRlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlID0gc3RhbGVMb2FkZWRTdGF0ZXNba2V5XTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmaW5pdGlvbiA9IGxvYWRlZERlZmluaXRpb25zTWFwW3N0YXRlLkNhbXBhaWduSWRdO1xuICAgICAgICAgICAgICAgIHZhciBzaG91bGRSZW1vdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoIWRlZmluaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLkxhc3ROb21pbmF0aW9uVGltZVV0Yy5nZXRUaW1lKCkgPD0gVXRpbHMuc3VidHJhY3RTZWNvbmRzV2l0aG91dE92ZXJmbG93KGN1cnJlbnREYXRlLCBzdGF0ZS5EZWxldGVBZnRlclNlY29uZHNXaGVuU3RhbGUpLmdldFRpbWUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkUmVtb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChDYW1wYWlnbk1hbmFnZXIuaXNTdGF0ZVVwRm9yTm9taW5hdGlvbihzdGF0ZSwgZGVmaW5pdGlvbiwgY3VycmVudERhdGUsIHRoaXMuY3VycmVudEJ1aWxkTnVtYmVyKSkge1xuICAgICAgICAgICAgICAgICAgICBzaG91bGRSZW1vdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBUaGUgbmV4dCB0aW1lIHdlIHdyaXRlIHRvIHN0b3JhZ2UsIHRoZXNlIHdpbGwgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgIGlmIChzaG91bGRSZW1vdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuY2FtcGFpZ25TdGF0ZXNbc3RhdGUuQ2FtcGFpZ25JZF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHaXZlbiB0aGUgbG9hZGVkIGNhbXBhaWduIGRlZmluaXRpb25zIGFuZCBzdGF0ZXMgZnJvbSBwcmV2aW91cyBzZXNzaW9ucywgcnVuIGFueXRoaW5nIHVwIGZvciBub21pbmF0aW9uXG4gICAgICovXG4gICAgQ2FtcGFpZ25NYW5hZ2VyLnByb3RvdHlwZS5ldmFsdWF0ZUNhbXBhaWducyA9IGZ1bmN0aW9uIChjdXJyZW50RGF0ZSkge1xuICAgICAgICAvLyBMb29wIHRocm91Z2ggY2FtcGFpZ25zIGRlZmluaXRpb25zLCBhbmQgdXBkYXRlIHRoZWlyIHN0YXRlIGlmIG5lY2Vzc2FyeVxuICAgICAgICBjdXJyZW50RGF0ZSA9IGN1cnJlbnREYXRlID8gY3VycmVudERhdGUgOiBuZXcgRGF0ZSgpO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5jYW1wYWlnbkRlZmluaXRpb25zKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW1wYWlnbkRlZmluaXRpb25zLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmaW5pdGlvbiA9IHRoaXMuY2FtcGFpZ25EZWZpbml0aW9uc1trZXldO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9IHRoaXMuY2FtcGFpZ25TdGF0ZXNbZGVmaW5pdGlvbi5jYW1wYWlnbklkXTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0YXRlIHx8IENhbXBhaWduTWFuYWdlci5pc1N0YXRlVXBGb3JOb21pbmF0aW9uKHN0YXRlLCBkZWZpbml0aW9uLCBjdXJyZW50RGF0ZSwgdGhpcy5jdXJyZW50QnVpbGROdW1iZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXN0U3VydmV5SWQgPSBzdGF0ZSA/IHN0YXRlLkxhc3RTdXJ2ZXlJZCA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXN0U3VydmV5U3RhcnRUaW1lID0gc3RhdGUgPyBzdGF0ZS5MYXN0U3VydmV5U3RhcnRUaW1lVXRjIDogVXRpbHMuZ2V0RGlzdGFudFBhc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RTdXJ2ZXlFeHBpcmF0aW9uVGltZSA9IHN0YXRlID8gc3RhdGUuTGFzdFN1cnZleUV4cGlyYXRpb25UaW1lVXRjIDogVXRpbHMuZ2V0RGlzdGFudFBhc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RTdXJ2ZXlBY3RpdmF0ZWRUaW1lID0gc3RhdGUgPyBzdGF0ZS5MYXN0U3VydmV5QWN0aXZhdGVkVGltZVV0YyA6IFV0aWxzLmdldERpc3RhbnRQYXN0KCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJ1biB0aGUgbm9taW5hdGlvblxuICAgICAgICAgICAgICAgICAgICB2YXIgaXNDYW5kaWRhdGUgPSAoc3RhdGUgJiYgc3RhdGUuRm9yY2VDYW5kaWRhY3kpIHx8IGRlZmluaXRpb24ubm9taW5hdGlvblNjaGVtZS5ldmFsdWF0ZU5vbWluYXRpb25SdWxlcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNDYW5kaWRhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgbmV3IHN1cnZleSBwcm9wZXJ0aWVzIGZvciB0aGUgbmV4dCBjYWxsIHRvIGdldCB0aGUgYWN0aXZlIHN1cnZleXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RTdXJ2ZXlJZCA9IFV0aWxzLmd1aWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RTdXJ2ZXlTdGFydFRpbWUgPSBkZWZpbml0aW9uLm5vbWluYXRpb25TY2hlbWUuY2FsY3VsYXRlU3VydmV5U3RhcnRUaW1lRnJvbURhdGUoY3VycmVudERhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdFN1cnZleUV4cGlyYXRpb25UaW1lID0gZGVmaW5pdGlvbi5ub21pbmF0aW9uU2NoZW1lLmNhbGN1bGF0ZVN1cnZleUV4cGlyYXRpb25UaW1lRnJvbVN1cnZleVN0YXJ0VGltZShsYXN0U3VydmV5U3RhcnRUaW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3U3RhdGUgPSBuZXcgQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyXzEuQ2FtcGFpZ25TdGF0ZShkZWZpbml0aW9uLmNhbXBhaWduSWQsIGN1cnJlbnREYXRlLCB0aGlzLmN1cnJlbnRCdWlsZE51bWJlciwgZGVmaW5pdGlvbi5ub21pbmF0aW9uU2NoZW1lLmdldEFjdGl2ZVN1cnZleVRpbWVJbnRlcnZhbFNlY29uZHMoKSwgZmFsc2UsIGlzQ2FuZGlkYXRlLCBmYWxzZSwgbGFzdFN1cnZleUFjdGl2YXRlZFRpbWUsIGxhc3RTdXJ2ZXlJZCwgbGFzdFN1cnZleVN0YXJ0VGltZSwgbGFzdFN1cnZleUV4cGlyYXRpb25UaW1lKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSB0aGUgbmV3IHN0YXRlIHRvIG91ciBsb2NhbCBjYWNoZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbXBhaWduU3RhdGVzW25ld1N0YXRlLkNhbXBhaWduSWRdID0gbmV3U3RhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBDYW1wYWlnbk1hbmFnZXIucHJvdG90eXBlLnNhdmVDYW1wYWlnblN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBTb3J0IGJ5IGNhbXBhaWduSWQsIGFzY2VuZGluZyBmb3IgdW5pZm9ybWl0eVxuICAgICAgICB2YXIgc3RhdGVzID0gVXRpbHMubWFrZUFycmF5RnJvbU9iamVjdFZhbHVlc1NvcnRlZEJ5S2V5U3RyaW5nKHRoaXMuY2FtcGFpZ25TdGF0ZXMpO1xuICAgICAgICB0aGlzLnN0YXRlUHJvdmlkZXIuc2F2ZShzdGF0ZXMpO1xuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduTWFuYWdlcjtcbn0oKSk7XG5leHBvcnRzLkNhbXBhaWduTWFuYWdlciA9IENhbXBhaWduTWFuYWdlcjtcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIgPSByZXF1aXJlKFwiLi4vQXBpL0lGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXJcIik7XG52YXIgVXRpbHMgPSByZXF1aXJlKFwiLi4vVXRpbHNcIik7XG52YXIgQ2FtcGFpZ25TdGF0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN0YXRlKGNhbXBhaWduSWQsIGxhc3ROb21pbmF0aW9uVGltZSwgbGFzdE5vbWluYXRpb25CdWlsZE51bWJlciwgZGVsZXRlQWZ0ZXJTZWNvbmRzV2hlblN0YWxlLCBGb3JjZUNhbmRpZGFjeSwgaXNDYW5kaWRhdGUsIGRpZENhbmRpZGF0ZVRyaWdnZXJTdXJ2ZXksIGxhc3RTdXJ2ZXlBY3RpdmF0ZWRUaW1lLCBsYXN0U3VydmV5SWQsIGxhc3RTdXJ2ZXlTdGFydFRpbWUsIGxhc3RTdXJ2ZXlFeHBpcmF0aW9uVGltZSkge1xuICAgICAgICB0aGlzLkNhbXBhaWduSWQgPSBjYW1wYWlnbklkO1xuICAgICAgICB0aGlzLkxhc3ROb21pbmF0aW9uVGltZVV0YyA9IGxhc3ROb21pbmF0aW9uVGltZTtcbiAgICAgICAgdGhpcy5MYXN0Tm9taW5hdGlvbkJ1aWxkTnVtYmVyID0gbGFzdE5vbWluYXRpb25CdWlsZE51bWJlcjtcbiAgICAgICAgdGhpcy5EZWxldGVBZnRlclNlY29uZHNXaGVuU3RhbGUgPSBkZWxldGVBZnRlclNlY29uZHNXaGVuU3RhbGU7XG4gICAgICAgIHRoaXMuRm9yY2VDYW5kaWRhY3kgPSBGb3JjZUNhbmRpZGFjeTtcbiAgICAgICAgdGhpcy5Jc0NhbmRpZGF0ZSA9IGlzQ2FuZGlkYXRlO1xuICAgICAgICB0aGlzLkRpZENhbmRpZGF0ZVRyaWdnZXJTdXJ2ZXkgPSBkaWRDYW5kaWRhdGVUcmlnZ2VyU3VydmV5O1xuICAgICAgICB0aGlzLkxhc3RTdXJ2ZXlBY3RpdmF0ZWRUaW1lVXRjID0gbGFzdFN1cnZleUFjdGl2YXRlZFRpbWU7XG4gICAgICAgIHRoaXMuTGFzdFN1cnZleUlkID0gbGFzdFN1cnZleUlkO1xuICAgICAgICB0aGlzLkxhc3RTdXJ2ZXlTdGFydFRpbWVVdGMgPSBsYXN0U3VydmV5U3RhcnRUaW1lO1xuICAgICAgICB0aGlzLkxhc3RTdXJ2ZXlFeHBpcmF0aW9uVGltZVV0YyA9IGxhc3RTdXJ2ZXlFeHBpcmF0aW9uVGltZTtcbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvbnN0cnVjdG9yIGFyZ3VtZW50cyBhcmUgbm90IHZhbGlkXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gb2JqZWN0IHRvIGNsYXNzIG9iamVjdFxuICAgICAqIEBwYXJhbSBpbnB1dDogSlNPTiBvYmplY3RcbiAgICAgKiBSZXR1cm5zIGNsYXNzIG9iamVjdFxuICAgICAqL1xuICAgIENhbXBhaWduU3RhdGUuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgaWYgKCFpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBDYW1wYWlnblN0YXRlKGlucHV0LkNhbXBhaWduSWQsIGlucHV0Lkxhc3ROb21pbmF0aW9uVGltZVV0YywgaW5wdXQuTGFzdE5vbWluYXRpb25CdWlsZE51bWJlciwgaW5wdXQuRGVsZXRlQWZ0ZXJTZWNvbmRzV2hlblN0YWxlLCBmYWxzZSwgLy8gRm9yY2VDYW5kaWRhY3lcbiAgICAgICAgICAgIGlucHV0LklzQ2FuZGlkYXRlLCBpbnB1dC5EaWRDYW5kaWRhdGVUcmlnZ2VyU3VydmV5LCBpbnB1dC5MYXN0U3VydmV5QWN0aXZhdGVkVGltZVV0YywgaW5wdXQuTGFzdFN1cnZleUlkLCBpbnB1dC5MYXN0U3VydmV5U3RhcnRUaW1lVXRjLCBpbnB1dC5MYXN0U3VydmV5RXhwaXJhdGlvblRpbWVVdGMpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBUT0RPKGdhY2hvaSkgTG9nIHBhcnNpbmcgZmFpbGVkXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQ2FtcGFpZ25TdGF0ZS5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5DYW1wYWlnbklkIHx8ICFVdGlscy5pc1N0cmluZyh0aGlzLkNhbXBhaWduSWQpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuTGFzdE5vbWluYXRpb25CdWlsZE51bWJlcilcbiAgICAgICAgICAgIHx8ICFVdGlscy5pc1N0cmluZyh0aGlzLkxhc3ROb21pbmF0aW9uQnVpbGROdW1iZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFVdGlscy5pc051bWJlcih0aGlzLkRlbGV0ZUFmdGVyU2Vjb25kc1doZW5TdGFsZSkgfHwgdGhpcy5EZWxldGVBZnRlclNlY29uZHNXaGVuU3RhbGUgPCAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFVdGlscy5pc0Jvb2xlYW4odGhpcy5Jc0NhbmRpZGF0ZSkgfHwgIVV0aWxzLmlzQm9vbGVhbih0aGlzLkRpZENhbmRpZGF0ZVRyaWdnZXJTdXJ2ZXkpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuSXNDYW5kaWRhdGUpIHtcbiAgICAgICAgICAgIC8vIERpc2FsbG93IHRoZSBmb2xsb3dpbmcgbnVsbCdzIGlmIGlzQ2FuZGlkYXRlID09IHRydWVcbiAgICAgICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLkxhc3RTdXJ2ZXlTdGFydFRpbWVVdGMpIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuTGFzdFN1cnZleUV4cGlyYXRpb25UaW1lVXRjKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIExhc3RTdXJ2ZXlJZCBjb3VsZCBiZSBcIlwiXG4gICAgICAgICAgICBpZiAoIVV0aWxzLmlzU3RyaW5nKHRoaXMuTGFzdFN1cnZleUlkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5EaWRDYW5kaWRhdGVUcmlnZ2VyU3VydmV5KSB7XG4gICAgICAgICAgICAvLyBEaXNhbGxvdyB0aGUgZm9sbG93aW5nIG51bGwncyBpZiBkaWRDYW5kaWRhdGVUcmlnZ2VyU3VydmV5ID09IHRydWVcbiAgICAgICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLkxhc3RTdXJ2ZXlBY3RpdmF0ZWRUaW1lVXRjKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5MYXN0U3VydmV5SWQpKSB7XG4gICAgICAgICAgICB0aGlzLkxhc3RTdXJ2ZXlJZCA9IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIVV0aWxzLmlzU3RyaW5nKHRoaXMuTGFzdFN1cnZleUlkKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIExhc3ROb21pbmF0aW9uVGltZSBkb2VzIG5vdCBhbGxvdyBudWxsXG4gICAgICAgIGlmIChVdGlscy5pc1V0Y0RhdGV0aW1lU3RyaW5nKHRoaXMuTGFzdE5vbWluYXRpb25UaW1lVXRjKSkge1xuICAgICAgICAgICAgdGhpcy5MYXN0Tm9taW5hdGlvblRpbWVVdGMgPSBVdGlscy5zdHJpbmdUb0RhdGUodGhpcy5MYXN0Tm9taW5hdGlvblRpbWVVdGMpO1xuICAgICAgICAgICAgLy8gaW52YWxpZGF0ZSBpZiBpdCdzIG5vdCBhIERhdGUgb2JqZWN0XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIVV0aWxzLmlzRGF0ZSh0aGlzLkxhc3ROb21pbmF0aW9uVGltZVV0YykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBTZXQgdmFsdWUgdG8gZGlzdGFuY2UgcGFzdCBpZiB2YWx1ZSBub3QgcHJvdmlkZWRcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuTGFzdFN1cnZleUFjdGl2YXRlZFRpbWVVdGMpKSB7XG4gICAgICAgICAgICB0aGlzLkxhc3RTdXJ2ZXlBY3RpdmF0ZWRUaW1lVXRjID0gVXRpbHMuZ2V0RGlzdGFudFBhc3QoKTtcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGl0J3MgVVRDIGRhdGUgdGltZSBzdHJpbmcsIHBvc3NpYmx5IGNvbWluZyBmcm9tIGRlc2VyaWFsaXplIG1ldGhvZFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKFV0aWxzLmlzVXRjRGF0ZXRpbWVTdHJpbmcodGhpcy5MYXN0U3VydmV5QWN0aXZhdGVkVGltZVV0YykpIHtcbiAgICAgICAgICAgIHRoaXMuTGFzdFN1cnZleUFjdGl2YXRlZFRpbWVVdGMgPSBVdGlscy5zdHJpbmdUb0RhdGUodGhpcy5MYXN0U3VydmV5QWN0aXZhdGVkVGltZVV0Yyk7XG4gICAgICAgICAgICAvLyBpbnZhbGlkYXRlIGlmIGl0J3Mgbm90IGEgRGF0ZSBvYmplY3RcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghVXRpbHMuaXNEYXRlKHRoaXMuTGFzdFN1cnZleUFjdGl2YXRlZFRpbWVVdGMpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0IHZhbHVlIHRvIGRpc3RhbmNlIHBhc3QgaWYgdmFsdWUgbm90IHByb3ZpZGVkXG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLkxhc3RTdXJ2ZXlTdGFydFRpbWVVdGMpKSB7XG4gICAgICAgICAgICB0aGlzLkxhc3RTdXJ2ZXlTdGFydFRpbWVVdGMgPSBVdGlscy5nZXREaXN0YW50UGFzdCgpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgaXQncyBzdHJpbmcsIHBvc3NpYmx5IGNvbWluZyBmcm9tIGRlc2VyaWFsaXplIG1ldGhvZFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKFV0aWxzLmlzVXRjRGF0ZXRpbWVTdHJpbmcodGhpcy5MYXN0U3VydmV5U3RhcnRUaW1lVXRjKSkge1xuICAgICAgICAgICAgdGhpcy5MYXN0U3VydmV5U3RhcnRUaW1lVXRjID0gVXRpbHMuc3RyaW5nVG9EYXRlKHRoaXMuTGFzdFN1cnZleVN0YXJ0VGltZVV0Yyk7XG4gICAgICAgICAgICAvLyBpbnZhbGlkYXRlIGlmIGl0J3Mgbm90IGEgRGF0ZSBvYmplY3RcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghVXRpbHMuaXNEYXRlKHRoaXMuTGFzdFN1cnZleVN0YXJ0VGltZVV0YykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBTZXQgdmFsdWUgdG8gZGlzdGFuY2UgcGFzdCBpZiB2YWx1ZSBub3QgcHJvdmlkZWRcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuTGFzdFN1cnZleUV4cGlyYXRpb25UaW1lVXRjKSkge1xuICAgICAgICAgICAgdGhpcy5MYXN0U3VydmV5RXhwaXJhdGlvblRpbWVVdGMgPSBVdGlscy5nZXREaXN0YW50UGFzdCgpO1xuICAgICAgICAgICAgLy8gY2hlY2sgaWYgaXQncyBzdHJpbmcsIHBvc3NpYmx5IGNvbWluZyBmcm9tIGRlc2VyaWFsaXplIG1ldGhvZFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKFV0aWxzLmlzVXRjRGF0ZXRpbWVTdHJpbmcodGhpcy5MYXN0U3VydmV5RXhwaXJhdGlvblRpbWVVdGMpKSB7XG4gICAgICAgICAgICB0aGlzLkxhc3RTdXJ2ZXlFeHBpcmF0aW9uVGltZVV0YyA9IFV0aWxzLnN0cmluZ1RvRGF0ZSh0aGlzLkxhc3RTdXJ2ZXlFeHBpcmF0aW9uVGltZVV0Yyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIVV0aWxzLmlzRGF0ZSh0aGlzLkxhc3RTdXJ2ZXlFeHBpcmF0aW9uVGltZVV0YykpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFJlY29yZCB0aGF0IHRoZSBjdXJyZW50IHN1cnZleSB3YXMgdGFrZW4gb24gdGhpcyBkYXRlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0ZSBkYXRlXG4gICAgICovXG4gICAgQ2FtcGFpZ25TdGF0ZS5wcm90b3R5cGUubWFya0N1cnJlbnRTdXJ2ZXlUYWtlbk9uRGF0ZSA9IGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgICAgIHRoaXMuRGlkQ2FuZGlkYXRlVHJpZ2dlclN1cnZleSA9IHRydWU7XG4gICAgICAgIHRoaXMuTGFzdFN1cnZleUFjdGl2YXRlZFRpbWVVdGMgPSBkYXRlICE9IG51bGwgPyBkYXRlIDogbmV3IERhdGUoKTtcbiAgICB9O1xuICAgIENhbXBhaWduU3RhdGUucHJvdG90eXBlLmdldENvb2xkb3duU3RhcnREYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuSXNDYW5kaWRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLkxhc3ROb21pbmF0aW9uVGltZVV0YztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5EaWRDYW5kaWRhdGVUcmlnZ2VyU3VydmV5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5MYXN0U3VydmV5QWN0aXZhdGVkVGltZVV0YztcbiAgICAgICAgfVxuICAgICAgICAvLyBJbiBwcmFjdGljZSB0aGlzIHdpbCBiZSBlcXVhbCB0byBsYXN0Tm9taW5hdGlvblRpbWUsIGJ1dFxuICAgICAgICAvLyBkaXN0cmlidXRpb24gbW9kZWxzIGxpa2UgYSByYW1wIGVmZmVjdGl2ZWx5IGNhdXNlIHVzIHRvXG4gICAgICAgIC8vIHNoaWZ0IG91ciBcImVmZmVjdGl2ZSBub21pbmF0aW9uIGRhdGVcIiBmb3J3YXJkIHdpdGggdGhlIHN1cnZleSBzdGFydCBkYXRlXG4gICAgICAgIHJldHVybiB0aGlzLkxhc3RTdXJ2ZXlTdGFydFRpbWVVdGM7XG4gICAgfTtcbiAgICByZXR1cm4gQ2FtcGFpZ25TdGF0ZTtcbn0oKSk7XG5leHBvcnRzLkNhbXBhaWduU3RhdGUgPSBDYW1wYWlnblN0YXRlO1xuLyoqXG4gKiBDbGFzcyByZXByZXNlbnRpbmcgd2hhdCBpcyBzdG9yZWQgaW4gdGhlIGZpbGUuXG4gKi9cbnZhciBGaWxlRGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWxlRGF0YSgpIHtcbiAgICB9XG4gICAgcmV0dXJuIEZpbGVEYXRhO1xufSgpKTtcbnZhciBGaWxlQmFzZWRDYW1wYWlnblN0YXRlUHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmlsZUJhc2VkQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyKHN0b3JhZ2UpIHtcbiAgICAgICAgaWYgKCFzdG9yYWdlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzdG9yYWdlIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcbiAgICB9XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRmlsZUJhc2VkQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVhZFN0cmluZyA9IHRoaXMuc3RvcmFnZS5yZWFkKElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIuRmlsZVR5cGUuQ2FtcGFpZ25TdGF0ZXMpO1xuICAgICAgICBpZiAoIXJlYWRTdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsZURhdGE7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmaWxlRGF0YSA9IEpTT04ucGFyc2UocmVhZFN0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oZ2FjaG9pKSBMb2cgcGFyc2luZyBmYWlsZWRcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIGlmIChmaWxlRGF0YSAmJiBmaWxlRGF0YS5DYW1wYWlnblN0YXRlcykge1xuICAgICAgICAgICAgZmlsZURhdGEuQ2FtcGFpZ25TdGF0ZXMuZm9yRWFjaChmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3U3RhdGUgPSBDYW1wYWlnblN0YXRlLmRlc2VyaWFsaXplKHN0YXRlKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3U3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobmV3U3RhdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBGaWxlQmFzZWRDYW1wYWlnblN0YXRlUHJvdmlkZXIucHJvdG90eXBlLnNhdmUgPSBmdW5jdGlvbiAoY2FtcGFpZ25TdGF0ZXMpIHtcbiAgICAgICAgaWYgKCFjYW1wYWlnblN0YXRlcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaWxlRGF0YSA9IG5ldyBGaWxlRGF0YSgpO1xuICAgICAgICBmaWxlRGF0YS5DYW1wYWlnblN0YXRlcyA9IGNhbXBhaWduU3RhdGVzO1xuICAgICAgICB2YXIgd3JpdGVTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShmaWxlRGF0YSk7XG4gICAgICAgIHRoaXMuc3RvcmFnZS53cml0ZShJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLkNhbXBhaWduU3RhdGVzLCB3cml0ZVN0cmluZyk7XG4gICAgfTtcbiAgICByZXR1cm4gRmlsZUJhc2VkQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydHMuRmlsZUJhc2VkQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyID0gRmlsZUJhc2VkQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU3VydmV5RXZlbnRzXzEgPSByZXF1aXJlKFwiLi4vU3VydmV5RXZlbnRzXCIpO1xudmFyIEZwc1N1cnZleSA9IHJlcXVpcmUoXCIuLi9TdXJ2ZXlzL0Zwc1N1cnZleVwiKTtcbnZhciBObHFzU3VydmV5ID0gcmVxdWlyZShcIi4uL1N1cnZleXMvTmxxc1N1cnZleVwiKTtcbnZhciBOcHNTdXJ2ZXkgPSByZXF1aXJlKFwiLi4vU3VydmV5cy9OcHNTdXJ2ZXlcIik7XG52YXIgU3VydmV5RGF0YVNvdXJjZSA9IHJlcXVpcmUoXCIuLi9TdXJ2ZXlzL1N1cnZleURhdGFTb3VyY2VcIik7XG52YXIgVXRpbHMgPSByZXF1aXJlKFwiLi4vVXRpbHNcIik7XG52YXIgQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJfMSA9IHJlcXVpcmUoXCIuL0NhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyXCIpO1xuLyoqXG4gKiBDb250YWlucyBtZXRob2RzIHRvIHRha2UgYSBjYW1wYWlnbiBkZWZpbml0aW9uICsgc3RhdGUgYW5kIGdlbmVyYXRlIGFuIElTdXJ2ZXlcbiAqL1xudmFyIENhbXBhaWduU3VydmV5RmFjdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDYW1wYWlnblN1cnZleUZhY3RvcnkoKSB7XG4gICAgfVxuICAgIC8vIHJlZ2lvbiBTdXJ2ZXkgbWV0aG9kc1xuICAgIENhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlU3VydmV5ID0gZnVuY3Rpb24gKHN0YXRlLCBnb3Zlcm5lZENoYW5uZWxUeXBlLCBzdXJ2ZXlNb2RlbCwgc3RyaW5nUHJvdmlkZXIsIGFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkKSB7XG4gICAgICAgIGlmICghc3RhdGUgfHwgIXN1cnZleU1vZGVsIHx8ICFzdHJpbmdQcm92aWRlcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN1cnZleU1vZGVsIGluc3RhbmNlb2YgQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJfMS5DYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzNVBvaW50U3RhdGljKSB7XG4gICAgICAgICAgICByZXR1cm4gTnBzU3VydmV5Lm1ha2U1UG9pbnQoQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5Lm1ha2VTdXJ2ZXlEYXRhU291cmNlRGF0YShzdGF0ZSwgZ292ZXJuZWRDaGFubmVsVHlwZSwgc3VydmV5TW9kZWwsIGFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkKSwgc3RyaW5nUHJvdmlkZXIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHN1cnZleU1vZGVsIGluc3RhbmNlb2YgQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJfMS5DYW1wYWlnblN1cnZleVRlbXBsYXRlTnBzMTFQb2ludFN0YXRpYykge1xuICAgICAgICAgICAgcmV0dXJuIE5wc1N1cnZleS5tYWtlMTFQb2ludChDYW1wYWlnblN1cnZleUZhY3RvcnkubWFrZVN1cnZleURhdGFTb3VyY2VEYXRhKHN0YXRlLCBnb3Zlcm5lZENoYW5uZWxUeXBlLCBzdXJ2ZXlNb2RlbCwgYWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQpLCBzdHJpbmdQcm92aWRlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoc3VydmV5TW9kZWwgaW5zdGFuY2VvZiBDYW1wYWlnbkRlZmluaXRpb25Qcm92aWRlcl8xLkNhbXBhaWduU3VydmV5VGVtcGxhdGVGcHMpIHtcbiAgICAgICAgICAgIHJldHVybiBGcHNTdXJ2ZXkubWFrZUZwcyhDYW1wYWlnblN1cnZleUZhY3RvcnkubWFrZVN1cnZleURhdGFTb3VyY2VEYXRhKHN0YXRlLCBnb3Zlcm5lZENoYW5uZWxUeXBlLCBzdXJ2ZXlNb2RlbCwgYWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQpLCBzdHJpbmdQcm92aWRlciwgc3VydmV5TW9kZWwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHN1cnZleU1vZGVsIGluc3RhbmNlb2YgQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJfMS5DYW1wYWlnblN1cnZleVRlbXBsYXRlTmxxcykge1xuICAgICAgICAgICAgcmV0dXJuIE5scXNTdXJ2ZXkubWFrZU5scXMoQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5Lm1ha2VTdXJ2ZXlEYXRhU291cmNlRGF0YShzdGF0ZSwgZ292ZXJuZWRDaGFubmVsVHlwZSwgc3VydmV5TW9kZWwsIGFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkKSwgc3RyaW5nUHJvdmlkZXIsIHN1cnZleU1vZGVsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzdXJ2ZXlNb2RlbCBpbnN0YW5jZW9mIENhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyXzEuQ2FtcGFpZ25TdXJ2ZXlUZW1wbGF0ZU5wcykge1xuICAgICAgICAgICAgcmV0dXJuIE5wc1N1cnZleS5tYWtlQ3VzdG9tKENhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlU3VydmV5RGF0YVNvdXJjZURhdGEoc3RhdGUsIGdvdmVybmVkQ2hhbm5lbFR5cGUsIHN1cnZleU1vZGVsLCBhZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCksIHN0cmluZ1Byb3ZpZGVyLCBzdXJ2ZXlNb2RlbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5Lm1ha2VTdXJ2ZXlEYXRhU291cmNlRGF0YSA9IGZ1bmN0aW9uIChzdGF0ZSwgZ292ZXJuZWRDaGFubmVsVHlwZSwgc3VydmV5TW9kZWwsIGFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkKSB7XG4gICAgICAgIGlmICghc3RhdGUgfHwgIXN1cnZleU1vZGVsKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3VydmV5RGF0YSA9IG5ldyBTdXJ2ZXlEYXRhU291cmNlLlN1cnZleURhdGFTb3VyY2VEYXRhKCk7XG4gICAgICAgIHN1cnZleURhdGEuYWN0aXZhdGlvbkV2ZW50ID0gQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5Lm1ha2VFdmVudChzdGF0ZSwgc3VydmV5TW9kZWwuYWN0aXZhdGlvbkV2ZW50KTtcbiAgICAgICAgc3VydmV5RGF0YS5pZCA9IHN0YXRlLkxhc3RTdXJ2ZXlJZDtcbiAgICAgICAgc3VydmV5RGF0YS5iYWNrRW5kSWRlbnRpZmllciA9IHN0YXRlLkNhbXBhaWduSWQ7XG4gICAgICAgIHN1cnZleURhdGEuZXhwaXJhdGlvblRpbWVVdGMgPSBVdGlscy5kYXRlVG9TaG9ydFV0Y1N0cmluZyhzdGF0ZS5MYXN0U3VydmV5RXhwaXJhdGlvblRpbWVVdGMpO1xuICAgICAgICBzdXJ2ZXlEYXRhLmdvdmVybmVkQ2hhbm5lbFR5cGUgPSBnb3Zlcm5lZENoYW5uZWxUeXBlO1xuICAgICAgICBzdXJ2ZXlEYXRhLnN0YXJ0VGltZVV0YyA9IFV0aWxzLmRhdGVUb1Nob3J0VXRjU3RyaW5nKHN0YXRlLkxhc3RTdXJ2ZXlTdGFydFRpbWVVdGMpO1xuICAgICAgICBzdXJ2ZXlEYXRhLmFkZGl0aW9uYWxEYXRhUmVxdWVzdGVkID0gYWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQgfHwgW107XG4gICAgICAgIHJldHVybiBzdXJ2ZXlEYXRhO1xuICAgIH07XG4gICAgLy8gZW5kcmVnaW9uXG4gICAgLy8gcmVnaW9uIEV2ZW50IG1ldGhvZHNcbiAgICBDYW1wYWlnblN1cnZleUZhY3RvcnkubWFrZUNvdW50ZWRBY3Rpdml0eUV2ZW50RGF0YSA9IGZ1bmN0aW9uIChldmVudE1vZGVsKSB7XG4gICAgICAgIGlmICghZXZlbnRNb2RlbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGV2ZW50RGF0YSA9IG5ldyBTdXJ2ZXlFdmVudHNfMS5Db3VudGVkQWN0aXZpdHlFdmVudERhdGEoKTtcbiAgICAgICAgZXZlbnREYXRhLmFjdGl2aXR5ID0gZXZlbnRNb2RlbC5hY3Rpdml0eTtcbiAgICAgICAgZXZlbnREYXRhLmNvdW50ID0gZXZlbnRNb2RlbC5jb3VudDtcbiAgICAgICAgZXZlbnREYXRhLmlzQWdncmVnYXRlID0gZXZlbnRNb2RlbC5pc0FnZ3JlZ2F0ZTtcbiAgICAgICAgcmV0dXJuIGV2ZW50RGF0YTtcbiAgICB9O1xuICAgIENhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlQ291bnRlZEFjdGl2aXR5RXZlbnQgPSBmdW5jdGlvbiAoc3RhdGUsIGV2ZW50TW9kZWwpIHtcbiAgICAgICAgaWYgKCFzdGF0ZSB8fCAhZXZlbnRNb2RlbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGV2ZW50RGF0YSA9IENhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlQ291bnRlZEFjdGl2aXR5RXZlbnREYXRhKGV2ZW50TW9kZWwpO1xuICAgICAgICBpZiAoIWV2ZW50RGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBTdXJ2ZXlFdmVudHNfMS5Db3VudGVkQWN0aXZpdHlFdmVudChldmVudERhdGEpO1xuICAgIH07XG4gICAgQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5Lm1ha2VDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZUV2ZW50ID0gZnVuY3Rpb24gKHN0YXRlLCBldmVudE1vZGVsKSB7XG4gICAgICAgIGlmICghc3RhdGUgfHwgIWV2ZW50TW9kZWwpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZXF1ZW5jZUV2ZW50RGF0YSA9IG5ldyBTdXJ2ZXlFdmVudHNfMS5Db3VudGVkQWN0aXZpdHlTZXF1ZW5jZUV2ZW50RGF0YSgpO1xuICAgICAgICBzZXF1ZW5jZUV2ZW50RGF0YS5zZXF1ZW5jZSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZXZlbnRNb2RlbC5zZXF1ZW5jZTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBldmVudF8xID0gX2FbX2ldO1xuICAgICAgICAgICAgdmFyIGV2ZW50RGF0YSA9IENhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlQ291bnRlZEFjdGl2aXR5RXZlbnREYXRhKGV2ZW50XzEpO1xuICAgICAgICAgICAgaWYgKCFldmVudERhdGEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlcXVlbmNlRXZlbnREYXRhLnNlcXVlbmNlLnB1c2goZXZlbnREYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFN1cnZleUV2ZW50c18xLkNvdW50ZWRBY3Rpdml0eVNlcXVlbmNlRXZlbnQoc2VxdWVuY2VFdmVudERhdGEpO1xuICAgIH07XG4gICAgQ2FtcGFpZ25TdXJ2ZXlGYWN0b3J5Lm1ha2VFdmVudCA9IGZ1bmN0aW9uIChzdGF0ZSwgZXZlbnRNb2RlbCkge1xuICAgICAgICBpZiAoZXZlbnRNb2RlbCBpbnN0YW5jZW9mIENhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyXzEuQ2FtcGFpZ25TdXJ2ZXlFdmVudENvdW50ZWRBY3Rpdml0eSkge1xuICAgICAgICAgICAgcmV0dXJuIENhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlQ291bnRlZEFjdGl2aXR5RXZlbnQoc3RhdGUsIGV2ZW50TW9kZWwpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50TW9kZWwgaW5zdGFuY2VvZiBDYW1wYWlnbkRlZmluaXRpb25Qcm92aWRlcl8xLkNhbXBhaWduU3VydmV5RXZlbnRDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIENhbXBhaWduU3VydmV5RmFjdG9yeS5tYWtlQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudChzdGF0ZSwgZXZlbnRNb2RlbCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIENhbXBhaWduU3VydmV5RmFjdG9yeTtcbn0oKSk7XG5leHBvcnRzLkNhbXBhaWduU3VydmV5RmFjdG9yeSA9IENhbXBhaWduU3VydmV5RmFjdG9yeTtcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIgPSByZXF1aXJlKFwiLi9BcGkvSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlclwiKTtcbnZhciBDYW1wYWlnbkRlZmluaXRpb25Qcm92aWRlcl8xID0gcmVxdWlyZShcIi4vQ2FtcGFpZ24vQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJcIik7XG52YXIgQ2FtcGFpZ25NYW5hZ2VyXzEgPSByZXF1aXJlKFwiLi9DYW1wYWlnbi9DYW1wYWlnbk1hbmFnZXJcIik7XG52YXIgQ2FtcGFpZ25TdGF0ZVByb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9DYW1wYWlnbi9DYW1wYWlnblN0YXRlUHJvdmlkZXJcIik7XG52YXIgRmxvb2RnYXRlU2V0dGluZ3NfMSA9IHJlcXVpcmUoXCIuL0Zsb29kZ2F0ZVNldHRpbmdzXCIpO1xudmFyIEdvdmVybmVkQ2hhbm5lbFN0YXRlUHJvdmlkZXJfMSA9IHJlcXVpcmUoXCIuL0dvdmVybmVkQ2hhbm5lbFN0YXRlUHJvdmlkZXJcIik7XG52YXIgR292ZXJub3JfMSA9IHJlcXVpcmUoXCIuL0dvdmVybm9yXCIpO1xudmFyIFN1cnZleUFjdGl2aXR5TGlzdGVuZXIgPSByZXF1aXJlKFwiLi9TdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyXCIpO1xudmFyIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbl8xID0gcmVxdWlyZShcIi4vU3VydmV5U3RhdENvbGxlY3Rpb25BY3RpdmF0aW9uXCIpO1xudmFyIFN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eV8xID0gcmVxdWlyZShcIi4vU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5XCIpO1xuLy8gVGVsZW1ldHJ5IGxvZ2dlciB3aXRoIG5vLW9wIGxvZ2dlclxudmFyIERlZmF1bHRGbG9vZGdhdGVUZWxlbWV0cnlMb2dnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVmYXVsdEZsb29kZ2F0ZVRlbGVtZXRyeUxvZ2dlcigpIHtcbiAgICB9XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRGVmYXVsdEZsb29kZ2F0ZVRlbGVtZXRyeUxvZ2dlci5wcm90b3R5cGUubG9nX1RyaWdnZXJNZXQgPSBmdW5jdGlvbiAoY2FtcGFpZ25JZCwgc3VydmV5SWQsIHN1cnZleVR5cGUpIHsgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBEZWZhdWx0Rmxvb2RnYXRlVGVsZW1ldHJ5TG9nZ2VyLnByb3RvdHlwZS5sb2dfVXNlclNlbGVjdGVkID0gZnVuY3Rpb24gKGNhbXBhaWduSWQsIHN1cnZleUlkLCBzdXJ2ZXlUeXBlKSB7IH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRGVmYXVsdEZsb29kZ2F0ZVRlbGVtZXRyeUxvZ2dlci5wcm90b3R5cGUubG9nX0NhbXBhaWduTG9hZF9GYWlsZWQgPSBmdW5jdGlvbiAoZXJyb3JNZXNzYWdlKSB7IH07XG4gICAgcmV0dXJuIERlZmF1bHRGbG9vZGdhdGVUZWxlbWV0cnlMb2dnZXI7XG59KCkpO1xuLyoqXG4gKiBGbG9vZGdhdGUgRW5naW5lIGNsYXNzLiAgVGhlIG1haW4gd2lyaW5nIGh1YiBhbmQgdGhlIGJyYWlucyByZXNwb25zaWJsZSBmb3JcbiAqIGxpbmtpbmcgdG9nZXRoZXIgdGhlIHN1cnZleSBkZWZpbml0aW9ucywgZ292ZXJuYW5jZSwgYWN0aXZpdHkgdHJhY2tpbmcsIGFuZFxuICogc3VydmV5IGxhdW5jaGVycy4gIE9ubHkgb25lLWluc3RhbmNlLWF0LWEtdGltZSBvZiB0aGVzZSBzaG91bGQgYmUgY3JlYXRlZFxuICogcGVyIGFwcCBzZXNzaW9uLlxuICovXG52YXIgRmxvb2RnYXRlRW5naW5lID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZsb29kZ2F0ZUVuZ2luZShzdXJ2ZXlDbGllbnQsIGFjdGl2aXR5TGlzdGVuZXIsIGxhdW5jaGVyRmFjdG9yeSwgb25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjaywgc3RvcmFnZSwgZ292ZXJub3IpIHtcbiAgICAgICAgdGhpcy5jYW5kaWRhdGVTdXJ2ZXlzID0ge307XG4gICAgICAgIHRoaXMubGF1bmNoZWRTdXJ2ZXlzID0ge307XG4gICAgICAgIHRoaXMubGF1bmNoZWRMYXVuY2hlcnMgPSBbXTtcbiAgICAgICAgaWYgKCFzdXJ2ZXlDbGllbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInN1cnZleUNsaWVudCBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghYWN0aXZpdHlMaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYWN0aXZpdHlMaXN0ZW5lciBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghbGF1bmNoZXJGYWN0b3J5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJsYXVuY2hlckZhY3RvcnkgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW9uU3VydmV5QWN0aXZhdGVkQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIm9uU3VydmV5QWN0aXZhdGVkQ2FsbGJhY2sgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0b3JhZ2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInN0b3JhZ2UgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWdvdmVybm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJnb3Zlcm5vciBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3VydmV5Q2xpZW50ID0gc3VydmV5Q2xpZW50O1xuICAgICAgICB0aGlzLmFjdGl2aXR5TGlzdGVuZXIgPSBhY3Rpdml0eUxpc3RlbmVyO1xuICAgICAgICB0aGlzLmxhdW5jaGVyRmFjdG9yeSA9IGxhdW5jaGVyRmFjdG9yeTtcbiAgICAgICAgdGhpcy5vblN1cnZleUFjdGl2YXRlZENhbGxiYWNrID0gb25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjaztcbiAgICAgICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZTtcbiAgICAgICAgdGhpcy5nb3Zlcm5vciA9IGdvdmVybm9yO1xuICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sb2dnZWRGaXJzdFN0YXJ0ID0gZmFsc2U7XG4gICAgICAgIC8vIEluaXRpYWxpemUgb3VyIGxpc3QgdG8gYSB2YWxpZCwgZW1wdHkgY29sbGVjdGlvblxuICAgICAgICB0aGlzLnNldFBlbmRpbmdTdXJ2ZXlzKG51bGwpO1xuICAgICAgICAvLyBJZiB0aGUgbGlzdGVuZXIgd2FzIHByZS1jb25maWd1cmVkIHdpdGggc3VydmV5IGZvciBzb21lIHJlYXNvbiwgY2xlYXIgaXQgbm93XG4gICAgICAgIHRoaXMuYWN0aXZpdHlMaXN0ZW5lci5jbGVhclN1cnZleXMoKTtcbiAgICAgICAgLy8gTGluayBvdXJzZWx2ZXMgd2l0aCB0aGUgbGlzdGVuZXJcbiAgICAgICAgdmFyIHRoaXNPYmogPSB0aGlzOyAvLyBTYXZlIGN1cnJlbnQgb2JqZWN0IGluIGEgdmFyaWFibGUgdG8gYWxsb3cgYWNjZXNzIGZyb20gY2FsbGJhY2suXG4gICAgICAgIHRoaXMuYWN0aXZpdHlMaXN0ZW5lci5zZXRDYWxsYmFjayh7XG4gICAgICAgICAgICBydW46IGZ1bmN0aW9uIChzdXJ2ZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzT2JqLm9uU3VydmV5QWN0aXZhdGVkKHN1cnZleSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgRmxvb2RnYXRlRW5naW5lLnNldFRlbGVtZXRyeUxvZ2dlciA9IGZ1bmN0aW9uICh0ZWxlbWV0cnlMb2dnZXIpIHtcbiAgICAgICAgaWYgKCF0ZWxlbWV0cnlMb2dnZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInRlbGVtZXRyeUxvZ2dlciBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIEZsb29kZ2F0ZUVuZ2luZS50ZWxlbWV0cnlMb2dnZXIgPSB0ZWxlbWV0cnlMb2dnZXI7XG4gICAgfTtcbiAgICBGbG9vZGdhdGVFbmdpbmUuZ2V0VGVsZW1ldHJ5TG9nZ2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gRmxvb2RnYXRlRW5naW5lLnRlbGVtZXRyeUxvZ2dlcjtcbiAgICB9O1xuICAgIEZsb29kZ2F0ZUVuZ2luZS5tYWtlID0gZnVuY3Rpb24gKGJ1aWxkVmVyc2lvbiwgbGF1bmNoZXJGYWN0b3J5LCBvblN1cnZleUFjdGl2YXRlZENhbGxiYWNrLCBzdG9yYWdlUHJvdmlkZXIsIHN0cmluZ1Byb3ZpZGVyLCBlbnZpcm9ubWVudFByb3ZpZGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgRmxvb2RnYXRlRW5naW5lKG5ldyBDYW1wYWlnbk1hbmFnZXJfMS5DYW1wYWlnbk1hbmFnZXIobmV3IENhbXBhaWduU3RhdGVQcm92aWRlcl8xLkZpbGVCYXNlZENhbXBhaWduU3RhdGVQcm92aWRlcihzdG9yYWdlUHJvdmlkZXIpLCBuZXcgQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXJfMS5GaWxlU3lzdGVtQ2FtcGFpZ25EZWZpbml0aW9uUHJvdmlkZXIoc3RvcmFnZVByb3ZpZGVyKSwgc3RyaW5nUHJvdmlkZXIsIGVudmlyb25tZW50UHJvdmlkZXIsIGJ1aWxkVmVyc2lvbiwgbmV3IERhdGUoKSksIG5ldyBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyKHsgcnVuOiBmdW5jdGlvbiAoc3VydmV5KSB7IH0gfSksIGxhdW5jaGVyRmFjdG9yeSwgb25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjaywgc3RvcmFnZVByb3ZpZGVyLCBuZXcgR292ZXJub3JfMS5Hb3Zlcm5vcihuZXcgR292ZXJuZWRDaGFubmVsU3RhdGVQcm92aWRlcl8xLkZpbGVCYXNlZEdvdmVybmVkQ2hhbm5lbFN0YXRlUHJvdmlkZXIoc3RvcmFnZVByb3ZpZGVyKSkpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogU2F2ZSBhbGwgaW50ZXJuYWwgc3RhdHMgYW5kIGZsb29kZ2F0ZVNldHRpbmdzIChtZXJnaW5nIHdpdGggZXhpc3RpbmcgZmlsZSBjb250ZW50cyksIHdpdGhvdXQgc3RvcHBpbmcgdGhlIGVuZ2luZS5cbiAgICAgKi9cbiAgICBGbG9vZGdhdGVFbmdpbmUucHJvdG90eXBlLm1lcmdlQW5kU2F2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy5zYXZlU3VydmV5QWN0aXZhdGlvbkhpc3RvcnkoKTtcbiAgICAgICAgdGhpcy5zYXZlU3VydmV5RXZlbnRBY3Rpdml0eUhpc3RvcnkoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFN0YXJ0IHRoZSBlbmdpbmUuICBDaGVja3MgZmVhdHVyZSBlbmFibGUgc3RhdGUsIGNhdXNlcyBzdXJ2ZXkgZGVmaW5pdGlvbnMgdG8gYmUgcmVhZCwgYW5kIHRyYWNrZWQgYWN0aXZpdGllcyB0byBiZSBzZXQgb24gdGhlIGxpc3RlbmVyLlxuICAgICAqL1xuICAgIEZsb29kZ2F0ZUVuZ2luZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBMb2FkIHVwIHRoZSBnZW5lcmFsIGZsb29kZ2F0ZVNldHRpbmdzXG4gICAgICAgIHRoaXMuZmxvb2RnYXRlU2V0dGluZ3MgPSBGbG9vZGdhdGVTZXR0aW5nc18xLkZsb29kZ2F0ZVNldHRpbmdzLmZyb21Kc29uKHRoaXMucmVhZFN0cmluZyhJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLkZsb29kZ2F0ZVNldHRpbmdzKSk7XG4gICAgICAgIC8vIExvYWQgdXAgdGhlIHByaW9yIHN1cnZleSBoaXN0b3J5IGFuZCBwcmlvciBldmVudCBjb3VudHNcbiAgICAgICAgdGhpcy5wcmV2aW91c1N1cnZleUFjdGl2YXRpb25TdGF0cyA9XG4gICAgICAgICAgICBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb25fMS5TdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb24uZnJvbUpzb24odGhpcy5yZWFkU3RyaW5nKElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIuRmlsZVR5cGUuU3VydmV5QWN0aXZhdGlvblN0YXRzKSk7XG4gICAgICAgIHRoaXMucHJldmlvdXNTdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMgPVxuICAgICAgICAgICAgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5XzEuU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LmZyb21Kc29uKHRoaXMucmVhZFN0cmluZyhJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLlN1cnZleUV2ZW50QWN0aXZpdHlTdGF0cykpO1xuICAgICAgICAvLyBNYWtlIHN1cmUgd2UndmUgbG9hZGVkIHRoZSBjdXJyZW50IHN1cnZleSBkZWZpbml0aW9uc1xuICAgICAgICB2YXIgY2hhbm5lbHMgPSB0aGlzLmdvdmVybm9yLmdldEF2YWlsYWJsZUNoYW5uZWxEYXRhKCk7XG4gICAgICAgIHZhciBjaGFubmVsVHlwZXMgPSBbXTtcbiAgICAgICAgY2hhbm5lbHMuZm9yRWFjaChmdW5jdGlvbiAoY2hhbm5lbCkge1xuICAgICAgICAgICAgaWYgKGNoYW5uZWwpIHtcbiAgICAgICAgICAgICAgICBjaGFubmVsVHlwZXMucHVzaChjaGFubmVsLmdldFR5cGUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnN1cnZleUNsaWVudC5yZWZyZXNoU3VydmV5RGVmaW5pdGlvbnMoY2hhbm5lbFR5cGVzKTtcbiAgICAgICAgLy8gVXBkYXRlIG91ciBzdXJ2ZXkgbGlzdCwgYW5kIHB1c2ggdGhhdCB0aHJvdWdoIHRvIHRoZSBsaXN0ZW5lclxuICAgICAgICB0aGlzLnNldFBlbmRpbmdTdXJ2ZXlzKHRoaXMuc3VydmV5Q2xpZW50LmdldEFwcFN1cnZleXMoKSk7XG4gICAgICAgIHRoaXMudXBkYXRlQWN0aXZpdHlMaXN0ZW5lcldpdGhDdXJyZW50U3VydmV5RGVmaW5pdGlvbnMoKTtcbiAgICAgICAgLy8gTWFyayB1cyBhcyBzdGFydGVkXG4gICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XG4gICAgICAgIC8vIExvZyBvdXIgZmlyc3Qgc3RhcnQgKGFrYSBmbG9vZGdhdGUgYm9vdCkgZXZlbnRcbiAgICAgICAgaWYgKCF0aGlzLmxvZ2dlZEZpcnN0U3RhcnQpIHtcbiAgICAgICAgICAgIHRoaXMubG9nZ2VkRmlyc3RTdGFydCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmdldEFjdGl2aXR5TGlzdGVuZXIoKS5sb2dBY3Rpdml0eShcIkZsb29kZ2F0ZUZpcnN0U3RhcnRcIik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFN0b3AgdGhlIGVuZ2luZS4gIENhdXNlcyB0cmFja2VkIGFjdGl2aXRpZXMgdG8gYmUgY2xlYXJlZCBhbmQgYW55IGluLXByb2dyZXNzIGNvdW50ZXJzIG5vdCBvdGhlcndpc2Ugc2F2ZWQgdG8gYmUgdGhyb3duIG91dC5cbiAgICAgKi9cbiAgICBGbG9vZGdhdGVFbmdpbmUucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGFydGVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tZXJnZUFuZFNhdmUoKTtcbiAgICAgICAgLy8gQ2xlYXIgb3VyIFN1cnZleSBsaXN0LCBhbmQgcHVzaCB0aGF0IHRocm91Z2ggdG8gdGhlIGxpc3RlbmVyXG4gICAgICAgIHRoaXMuc2V0UGVuZGluZ1N1cnZleXMobnVsbCk7XG4gICAgICAgIHRoaXMudXBkYXRlQWN0aXZpdHlMaXN0ZW5lcldpdGhDdXJyZW50U3VydmV5RGVmaW5pdGlvbnMoKTtcbiAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBJQWN0aXZpdHlMaXN0ZW5lciBsb2dnaW5nIGludGVyZmFjZSBmb3IgY2FsbGVycyB0aGF0IHdhbnQgdG8gbG9nIGRpcmVjdGx5IHJhdGhlciB0aGFuIHRocm91Z2ggdGVsZW1ldHJ5XG4gICAgICovXG4gICAgRmxvb2RnYXRlRW5naW5lLnByb3RvdHlwZS5nZXRBY3Rpdml0eUxpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3Rpdml0eUxpc3RlbmVyO1xuICAgIH07XG4gICAgRmxvb2RnYXRlRW5naW5lLnByb3RvdHlwZS5zYXZlU2V0dGluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZS5maWxlTG9jayhJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLkZsb29kZ2F0ZVNldHRpbmdzKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMud3JpdGVTdHJpbmcoSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZS5GbG9vZGdhdGVTZXR0aW5ncywgRmxvb2RnYXRlU2V0dGluZ3NfMS5GbG9vZGdhdGVTZXR0aW5ncy50b0pzb24odGhpcy5mbG9vZGdhdGVTZXR0aW5ncykpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5zdG9yYWdlLmZpbGVVbmxvY2soSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZS5GbG9vZGdhdGVTZXR0aW5ncyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZsb29kZ2F0ZUVuZ2luZS5wcm90b3R5cGUuc2F2ZVN1cnZleUFjdGl2YXRpb25IaXN0b3J5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnN0b3JhZ2UuZmlsZUxvY2soSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZS5TdXJ2ZXlBY3RpdmF0aW9uU3RhdHMpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHN0YXRDb2xsZWN0aW9uID0gU3VydmV5U3RhdENvbGxlY3Rpb25BY3RpdmF0aW9uXzEuU3VydmV5U3RhdENvbGxlY3Rpb25BY3RpdmF0aW9uLmZyb21Kc29uKHRoaXMucmVhZFN0cmluZyhJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLlN1cnZleUFjdGl2YXRpb25TdGF0cykpO1xuICAgICAgICAgICAgLy8gQnVpbGQgdGhlIHVwZGF0ZSBjb2xsZWN0aW9uXG4gICAgICAgICAgICB2YXIgdXBkYXRlQ29sbGVjdGlvbiA9IG5ldyBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb25fMS5TdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb24oKTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmxhdW5jaGVkU3VydmV5cykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxhdW5jaGVkU3VydmV5cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IG5ldyBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb25fMS5TdXJ2ZXlBY3RpdmF0aW9uU3RhdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1cnZleSA9IHRoaXMubGF1bmNoZWRTdXJ2ZXlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIHN0YXRzLlR5cGUgPSBzdXJ2ZXkuZ2V0VHlwZSgpO1xuICAgICAgICAgICAgICAgICAgICBzdGF0cy5FeHBpcmF0aW9uVGltZVV0YyA9IHN1cnZleS5nZXRTdXJ2ZXlJbmZvKCkuZ2V0RXhwaXJhdGlvblRpbWVVdGMoKTtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHMuQWN0aXZhdGlvblRpbWVVdGMgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIHRoaXMgcGFydCBvZiB0aGUgdXBkYXRlIGxpc3RcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ29sbGVjdGlvbi5hZGRTdGF0cyhzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmdldElkKCksIHN0YXRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBY3R1YWxseSBtZXJnZSBvdXIgdXBkYXRlcyBpbnRvIHRoZSBmdWxsIGNvbGxlY3Rpb25cbiAgICAgICAgICAgIHN0YXRDb2xsZWN0aW9uLmFjY3VtdWxhdGUodXBkYXRlQ29sbGVjdGlvbik7XG4gICAgICAgICAgICB0aGlzLndyaXRlU3RyaW5nKElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIuRmlsZVR5cGUuU3VydmV5QWN0aXZhdGlvblN0YXRzLCBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb25fMS5TdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb24udG9Kc29uKHN0YXRDb2xsZWN0aW9uKSk7XG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgdG8ga2VlcCBvdXIgaW50ZXJuYWwgY29sbGVjdGlvbiBjb25zaXN0ZW50IHdpdGggd2hhdCB3ZSBqdXN0IHdyb3RlXG4gICAgICAgICAgICB0aGlzLnByZXZpb3VzU3VydmV5QWN0aXZhdGlvblN0YXRzID0gc3RhdENvbGxlY3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2UuZmlsZVVubG9jayhJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLlN1cnZleUFjdGl2YXRpb25TdGF0cyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZsb29kZ2F0ZUVuZ2luZS5wcm90b3R5cGUuc2F2ZVN1cnZleUV2ZW50QWN0aXZpdHlIaXN0b3J5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnN0b3JhZ2UuZmlsZUxvY2soSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZS5TdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHN0YXRDb2xsZWN0aW9uID0gU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5XzEuU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LmZyb21Kc29uKHRoaXMucmVhZFN0cmluZyhJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLlN1cnZleUV2ZW50QWN0aXZpdHlTdGF0cykpO1xuICAgICAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAvLyBGaWxsIG91dCBvdXIgbGlzdCBvZiB1cGRhdGVzXG4gICAgICAgICAgICB2YXIgdXBkYXRlQ29sbGVjdGlvbiA9IG5ldyBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkV2ZW50QWN0aXZpdHlfMS5TdXJ2ZXlTdGF0Q29sbGVjdGlvbkV2ZW50QWN0aXZpdHkoKTtcbiAgICAgICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzXzEuY2FuZGlkYXRlU3VydmV5cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGF0cyA9IG5ldyBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkV2ZW50QWN0aXZpdHlfMS5TdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1cnZleSA9IHRoaXNfMS5jYW5kaWRhdGVTdXJ2ZXlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICghc3VydmV5LmdldFN1cnZleUluZm8oKS5pc0FjdGl2ZUZvckRhdGUobm93KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0cy5FeHBpcmF0aW9uVGltZVV0YyA9IHN1cnZleS5nZXRTdXJ2ZXlJbmZvKCkuZ2V0RXhwaXJhdGlvblRpbWVVdGMoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBhY3Rpdml0aWVzIHdoaWNoIGFyZSBhZ2dyZWdhdGVkLCBpZiB0aGVyZSBhcmVuJ3QgYW55IGNvbnRpbnVlXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbGxBY3Rpdml0aWVzID0gc3VydmV5LmdldFN1cnZleUluZm8oKS5nZXRBY3RpdmF0aW9uRXZlbnQoKS5nZXRUcmFja2luZ1NldCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWdncmVnYXRlQWN0aXZpdGllc18xID0gW107XG4gICAgICAgICAgICAgICAgICAgIGFsbEFjdGl2aXRpZXMuZ2V0TGlzdCgpLmZvckVhY2goZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhICYmIGRhdGEuZ2V0SXNBZ2dyZWdhdGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZUFjdGl2aXRpZXNfMS5wdXNoKGRhdGEuZ2V0QWN0aXZpdHkoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWdncmVnYXRlQWN0aXZpdGllc18xLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiY29udGludWVcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzdGF0cy5Db3VudHMgPSBuZXcgQXJyYXkoYWdncmVnYXRlQWN0aXZpdGllc18xLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgb2ZmIHRoZSBjb3VudHMgd2UndmUgYWRkZWQgZm9yIHRoaXMgc2Vzc2lvblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFnZ3JlZ2F0ZUFjdGl2aXRpZXNfMS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHMuQ291bnRzW2ldID0gdGhpc18xLmFjdGl2aXR5TGlzdGVuZXIubW92ZVNlc3Npb25Db3VudEludG9CYXNlQ291bnQoYWdncmVnYXRlQWN0aXZpdGllc18xW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIHRoaXMgcGFydCBvZiB0aGUgdXBkYXRlIGxpc3RcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlQ29sbGVjdGlvbi5hZGRTdGF0cyhzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmdldElkKCksIHN0YXRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIHRoaXNfMSA9IHRoaXM7XG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5jYW5kaWRhdGVTdXJ2ZXlzKSB7XG4gICAgICAgICAgICAgICAgX2xvb3BfMShrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQWN0dWFsbHkgbWVyZ2Ugb3VyIHVwZGF0ZXMgaW50byB0aGUgZnVsbCBjb2xsZWN0aW9uXG4gICAgICAgICAgICBzdGF0Q29sbGVjdGlvbi5hY2N1bXVsYXRlKHVwZGF0ZUNvbGxlY3Rpb24pO1xuICAgICAgICAgICAgdGhpcy53cml0ZVN0cmluZyhJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLlN1cnZleUV2ZW50QWN0aXZpdHlTdGF0cywgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5XzEuU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LnRvSnNvbihzdGF0Q29sbGVjdGlvbikpO1xuICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRvIGtlZXAgb3VyIGludGVybmFsIGNvbGxlY3Rpb24gY29uc2lzdGVudCB3aXRoIHdoYXQgd2UganVzdCB3cm90ZVxuICAgICAgICAgICAgdGhpcy5wcmV2aW91c1N1cnZleUV2ZW50QWN0aXZpdHlTdGF0cyA9IHN0YXRDb2xsZWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdGhpcy5zdG9yYWdlLmZpbGVVbmxvY2soSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZS5TdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGbG9vZGdhdGVFbmdpbmUucHJvdG90eXBlLnNldFBlbmRpbmdTdXJ2ZXlzID0gZnVuY3Rpb24gKHBlbmRpbmdTdXJ2ZXlzKSB7XG4gICAgICAgIGlmICghcGVuZGluZ1N1cnZleXMpIHtcbiAgICAgICAgICAgIC8vIFR1cm4gbnVsbCBpbnRvIGEgdmFsaWQgZW1wdHkgY29sbGVjdGlvblxuICAgICAgICAgICAgdGhpcy5jYW5kaWRhdGVTdXJ2ZXlzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmNhbmRpZGF0ZVN1cnZleXMgPSBwZW5kaW5nU3VydmV5cztcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmxvb2RnYXRlRW5naW5lLnByb3RvdHlwZS51cGRhdGVBY3Rpdml0eUxpc3RlbmVyV2l0aEN1cnJlbnRTdXJ2ZXlEZWZpbml0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gR2V0IGEgdmVjdG9yIG9mIFN1cnZleXMgZnJvbSBvdXIgaWQtYmFzZWQgbWFwXG4gICAgICAgIHZhciBzdXJ2ZXlMaXN0ID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmNhbmRpZGF0ZVN1cnZleXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbmRpZGF0ZVN1cnZleXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHZhciBzdXJ2ZXkgPSB0aGlzLmNhbmRpZGF0ZVN1cnZleXNba2V5XTtcbiAgICAgICAgICAgICAgICAvLyBTa2lwIG92ZXIgYW55IGNhbmRpZGF0ZSBzdXJ2ZXlzIHRoYXQgaGF2ZSBiZWVuIHByZXZpb3VzbHkgY29tcGxldGVkXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJldmlvdXNTdXJ2ZXlBY3RpdmF0aW9uU3RhdHMuZ2V0QnlTdXJ2ZXlJZChzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmdldElkKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE8gKGdhY2hvaSkgbG9nIHRoYXQgU2tpcHBpbmcgcHJldmlvdXNseSBhY3RpdmF0ZWQgc3VydmV5XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXN1cnZleS5nZXRTdXJ2ZXlJbmZvKCkuaXNBY3RpdmVGb3JEYXRlKG5ldyBEYXRlKCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBGbG9vZGdhdGVFbmdpbmUudGVsZW1ldHJ5TG9nZ2VyLmxvZ19Vc2VyU2VsZWN0ZWQoc3VydmV5LmdldFN1cnZleUluZm8oKS5nZXRCYWNrRW5kSWQoKSwgc3VydmV5LmdldFN1cnZleUluZm8oKS5nZXRJZCgpLCBzdXJ2ZXkuZ2V0VHlwZSgpKTtcbiAgICAgICAgICAgICAgICBzdXJ2ZXlMaXN0LnB1c2goc3VydmV5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFjdGl2aXR5TGlzdGVuZXIuc2V0U3VydmV5cyhzdXJ2ZXlMaXN0LCB0aGlzLnByZXZpb3VzU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzKTtcbiAgICB9O1xuICAgIEZsb29kZ2F0ZUVuZ2luZS5wcm90b3R5cGUub25TdXJ2ZXlBY3RpdmF0ZWQgPSBmdW5jdGlvbiAoc3VydmV5KSB7XG4gICAgICAgIEZsb29kZ2F0ZUVuZ2luZS50ZWxlbWV0cnlMb2dnZXIubG9nX1RyaWdnZXJNZXQoc3VydmV5LmdldFN1cnZleUluZm8oKS5nZXRCYWNrRW5kSWQoKSwgc3VydmV5LmdldFN1cnZleUluZm8oKS5nZXRJZCgpLCBzdXJ2ZXkuZ2V0VHlwZSgpKTtcbiAgICAgICAgdmFyIGxhdW5jaFN1cnZleSA9IGZhbHNlO1xuICAgICAgICB2YXIgZ292ZXJuZWRDaGFubmVsVHlwZSA9IHN1cnZleS5nZXRTdXJ2ZXlJbmZvKCkuZ2V0R292ZXJuZWRDaGFubmVsVHlwZSgpO1xuICAgICAgICAvLyBGaWd1cmUgb3V0IGlmIHRoZSBhY3RpdmF0ZWQgc3VydmV5IGlzIHN0aWxsIHJlbGV2YW50XG4gICAgICAgIGlmICghdGhpcy5jYW5kaWRhdGVTdXJ2ZXlzW3N1cnZleS5nZXRTdXJ2ZXlJbmZvKCkuZ2V0SWQoKV0pIHtcbiAgICAgICAgICAgIC8vIFN1cnZleSBpcyBubyBsb25nZXIgcmVsZXZhbnQgYnV0IHdhcyBhY3RpdmF0ZWQuIFN1cHByZXNzIGl0LlxuICAgICAgICAgICAgLy8gVE9ETyhnYWNob2kpIGxvZyBJTkZPIFN1cnZleSB3YXMgYWN0aXZhdGVkIGJ1dCBpcyBubyBsb25nZXIgcmVnaXN0ZXJlZFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmlzQWN0aXZlRm9yRGF0ZShuZXcgRGF0ZSgpKSkge1xuICAgICAgICAgICAgLy8gU3VydmV5IGlzIG5vIGxvbmdlciBhY3RpdmUgKGUuZy4gaXQgd2FzIHdoZW4gd2UgcmVnaXN0ZXJlZCBpdCBidXQgaXQgaGFzIG5vdyBleHBpcmVkKVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF0aGlzLmdvdmVybm9yLmlzQ2hhbm5lbE9wZW4oZ292ZXJuZWRDaGFubmVsVHlwZSkpIHtcbiAgICAgICAgICAgIC8vIENoYW5uZWwgaGFzIGNsb3NlZCwgc3VwcHJlc3MgdGhlIHN1cnZleVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubGF1bmNoZWRTdXJ2ZXlzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBmb3Igbm93IHdlIG9ubHkgc3VwcG9ydCBsYXVuY2hpbmcgb25lIHN1cnZleSBwZXIgc2Vzc2lvblxuICAgICAgICAgICAgICAgIC8vIFRyYWNrIHRoaXMgc3VydmV5IGFjdGl2YXRpb24gZm9yIHRoZSBsYXVuY2ggaGlzdG9yeSB0cmFja2VyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXVuY2hlZFN1cnZleXNbc3VydmV5LmdldFN1cnZleUluZm8oKS5nZXRJZCgpXSA9IHN1cnZleTtcbiAgICAgICAgICAgICAgICBsYXVuY2hTdXJ2ZXkgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIEF0IHRoaXMgcG9pbnQsIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciBvciBub3QgdGhlIHN1cnZleSBpcyBzdGlsbCByZWxldmFudCwgd2Ugc2hvdWxkIGZsdXNoIG91dCB0aGUgc3RhdHMsIGFuZCBzaHV0IG9mZiBmdXJ0aGVyIHN1cnZleSBsYXVuY2hlc1xuICAgICAgICB0aGlzLm1lcmdlQW5kU2F2ZSgpO1xuICAgICAgICB0aGlzLmFjdGl2aXR5TGlzdGVuZXIuY2xlYXJTdXJ2ZXlzKCk7XG4gICAgICAgIC8vIEFjdHVhbGx5IGxhdW5jaCB0aGUgc3VydmV5XG4gICAgICAgIGlmIChsYXVuY2hTdXJ2ZXkpIHtcbiAgICAgICAgICAgIHRoaXMuZ292ZXJub3Iuc3RhcnRDaGFubmVsQ29vbGRvd24oZ292ZXJuZWRDaGFubmVsVHlwZSk7XG4gICAgICAgICAgICB0aGlzLnN1cnZleUNsaWVudC5vblN1cnZleUFjdGl2YXRlZChzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpKTtcbiAgICAgICAgICAgIHRoaXMubGF1bmNoTGF1bmNoZXIoc3VydmV5KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmxvb2RnYXRlRW5naW5lLnByb3RvdHlwZS5yZWFkU3RyaW5nID0gZnVuY3Rpb24gKGZpbGVUeXBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2UucmVhZChmaWxlVHlwZSk7XG4gICAgfTtcbiAgICBGbG9vZGdhdGVFbmdpbmUucHJvdG90eXBlLndyaXRlU3RyaW5nID0gZnVuY3Rpb24gKGZpbGVUeXBlLCBzdHIpIHtcbiAgICAgICAgdGhpcy5zdG9yYWdlLndyaXRlKGZpbGVUeXBlLCBzdHIpO1xuICAgIH07XG4gICAgRmxvb2RnYXRlRW5naW5lLnByb3RvdHlwZS5sYXVuY2hMYXVuY2hlciA9IGZ1bmN0aW9uIChzdXJ2ZXkpIHtcbiAgICAgICAgdmFyIGxhdW5jaGVyID0gdGhpcy5sYXVuY2hlckZhY3RvcnkubWFrZVN1cnZleUxhdW5jaGVyKHN1cnZleSk7XG4gICAgICAgIGlmIChsYXVuY2hlcikge1xuICAgICAgICAgICAgdGhpcy5sYXVuY2hlZExhdW5jaGVycy5wdXNoKGxhdW5jaGVyKTtcbiAgICAgICAgICAgIHRoaXMub25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjay5vblN1cnZleUFjdGl2YXRlZChsYXVuY2hlcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8vIEluaXRpYWxpemUgdGVsZW1ldHJ5IGxvZ2dlciB3aXRoIG5vLW9wIGxvZ2dlclxuICAgIEZsb29kZ2F0ZUVuZ2luZS50ZWxlbWV0cnlMb2dnZXIgPSBuZXcgRGVmYXVsdEZsb29kZ2F0ZVRlbGVtZXRyeUxvZ2dlcigpO1xuICAgIHJldHVybiBGbG9vZGdhdGVFbmdpbmU7XG59KCkpO1xuZXhwb3J0cy5GbG9vZGdhdGVFbmdpbmUgPSBGbG9vZGdhdGVFbmdpbmU7XG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogR2VuZXJhbCBmbG9vZGdhdGUgc2V0dGluZ3NcbiAqL1xudmFyIEZsb29kZ2F0ZVNldHRpbmdzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZsb29kZ2F0ZVNldHRpbmdzKCkge1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRvIEpzb25cbiAgICAgKi9cbiAgICBGbG9vZGdhdGVTZXR0aW5ncy50b0pzb24gPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmplY3QpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogTG9hZCBmcm9tIEpzb25cbiAgICAgKi9cbiAgICBGbG9vZGdhdGVTZXR0aW5ncy5mcm9tSnNvbiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGpzb24pO1xuICAgIH07XG4gICAgcmV0dXJuIEZsb29kZ2F0ZVNldHRpbmdzO1xufSgpKTtcbmV4cG9ydHMuRmxvb2RnYXRlU2V0dGluZ3MgPSBGbG9vZGdhdGVTZXR0aW5ncztcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIFV0aWxzID0gcmVxdWlyZShcIi4vVXRpbHNcIik7XG52YXIgR292ZXJuZWRDaGFubmVsVHlwZTtcbihmdW5jdGlvbiAoR292ZXJuZWRDaGFubmVsVHlwZSkge1xuICAgIEdvdmVybmVkQ2hhbm5lbFR5cGVbR292ZXJuZWRDaGFubmVsVHlwZVtcIlN0YW5kYXJkXCJdID0gMF0gPSBcIlN0YW5kYXJkXCI7XG4gICAgR292ZXJuZWRDaGFubmVsVHlwZVtHb3Zlcm5lZENoYW5uZWxUeXBlW1wiVXJnZW50XCJdID0gMV0gPSBcIlVyZ2VudFwiO1xufSkoR292ZXJuZWRDaGFubmVsVHlwZSA9IGV4cG9ydHMuR292ZXJuZWRDaGFubmVsVHlwZSB8fCAoZXhwb3J0cy5Hb3Zlcm5lZENoYW5uZWxUeXBlID0ge30pKTtcbihmdW5jdGlvbiAoR292ZXJuZWRDaGFubmVsVHlwZSkge1xuICAgIGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBHb3Zlcm5lZENoYW5uZWxUeXBlLlN0YW5kYXJkOyB9XG4gICAgR292ZXJuZWRDaGFubmVsVHlwZS5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcbn0pKEdvdmVybmVkQ2hhbm5lbFR5cGUgPSBleHBvcnRzLkdvdmVybmVkQ2hhbm5lbFR5cGUgfHwgKGV4cG9ydHMuR292ZXJuZWRDaGFubmVsVHlwZSA9IHt9KSk7XG52YXIgR292ZXJuZWRDaGFubmVsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdvdmVybmVkQ2hhbm5lbCh0eXBlLCBuYW1lLCBjb29sZG93blNlY29uZHMsIGNvb2xkb3duU3RhcnRUaW1lKSB7XG4gICAgICAgIGlmICghVXRpbHMuaXNFbnVtVmFsdWUodHlwZSwgR292ZXJuZWRDaGFubmVsVHlwZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInR5cGUgaXMgbm90IGEgdmFsaWQgR292ZXJuZWRDaGFubmVsVHlwZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIm5hbWUgbXVzdCBub3QgYmUgbnVsbCBvciBlbXB0eVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29vbGRvd25TZWNvbmRzIDwgMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY29vbGRvd25TZWNvbmRzIG11c3Qgbm90IGJlIG5lZ2F0aXZlXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuY29vbGRvd25TZWNvbmRzID0gY29vbGRvd25TZWNvbmRzO1xuICAgICAgICB0aGlzLnNldENvb2xkb3duU3RhcnRUaW1lKGNvb2xkb3duU3RhcnRUaW1lKTtcbiAgICB9XG4gICAgR292ZXJuZWRDaGFubmVsLnByb3RvdHlwZS5zZXRDb29sZG93blN0YXJ0VGltZSA9IGZ1bmN0aW9uIChjb29sZG93blN0YXJ0VGltZSkge1xuICAgICAgICAvLyBTZXQgdGhlIHN0YXJ0IHRpbWVcbiAgICAgICAgdGhpcy5jb29sZG93blN0YXJ0VGltZSA9IGNvb2xkb3duU3RhcnRUaW1lO1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5jb29sZG93blN0YXJ0VGltZSkpIHtcbiAgICAgICAgICAgIC8vIE51bGwgY29vbGRvd25TdGFydFRpbWUgbWVhbnMgY29vbCBkb3duIGhhcyBuZXZlciBiZWVuIGluaXRpYXRlZCwgc28gc2V0IHRoZSBjb29sZG93bkVuZFRpbWUgdG8gZGlzdGFudCBwYXN0XG4gICAgICAgICAgICB0aGlzLmNvb2xkb3duRW5kVGltZSA9IFV0aWxzLmdldERpc3RhbnRQYXN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGVuZCB0aW1lLCBidXQgZG9uJ3Qgb3ZlcmZsb3cgcGFzdCBtYXguXG4gICAgICAgICAgICB0aGlzLmNvb2xkb3duRW5kVGltZSA9IFV0aWxzLmFkZFNlY29uZHNXaXRob3V0T3ZlcmZsb3codGhpcy5jb29sZG93blN0YXJ0VGltZSwgdGhpcy5jb29sZG93blNlY29uZHMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBHb3Zlcm5lZENoYW5uZWwucHJvdG90eXBlLmlzT3BlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXNPcGVuQXREYXRlKG5ldyBEYXRlKCkpO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgR292ZXJuZWRDaGFubmVsLnByb3RvdHlwZS5pc09wZW5BdERhdGUgPSBmdW5jdGlvbiAoZGF0ZSkge1xuICAgICAgICBpZiAoIWRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGRhdGUgPiB0aGlzLmNvb2xkb3duRW5kVGltZSk7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBHb3Zlcm5lZENoYW5uZWwucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnR5cGU7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBHb3Zlcm5lZENoYW5uZWwucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBHb3Zlcm5lZENoYW5uZWwucHJvdG90eXBlLmdldENvb2xkb3duU2Vjb25kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29vbGRvd25TZWNvbmRzO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgR292ZXJuZWRDaGFubmVsLnByb3RvdHlwZS5nZXRDb29sZG93blN0YXJ0VGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29vbGRvd25TdGFydFRpbWU7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBHb3Zlcm5lZENoYW5uZWwucHJvdG90eXBlLmdldENvb2xkb3duRW5kVGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29vbGRvd25FbmRUaW1lO1xuICAgIH07XG4gICAgcmV0dXJuIEdvdmVybmVkQ2hhbm5lbDtcbn0oKSk7XG5leHBvcnRzLkdvdmVybmVkQ2hhbm5lbCA9IEdvdmVybmVkQ2hhbm5lbDtcbiIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIgPSByZXF1aXJlKFwiLi9BcGkvSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlclwiKTtcbnZhciBHb3Zlcm5lZENoYW5uZWxfMSA9IHJlcXVpcmUoXCIuL0dvdmVybmVkQ2hhbm5lbFwiKTtcbnZhciBVdGlscyA9IHJlcXVpcmUoXCIuL1V0aWxzXCIpO1xudmFyIEdvdmVybmVkQ2hhbm5lbFN0YXRlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdvdmVybmVkQ2hhbm5lbFN0YXRlKHR5cGUsIGNvb2xkb3duU3RhcnRUaW1lKSB7XG4gICAgICAgIHRoaXMuQ2hhbm5lbFR5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLkNvb2xkb3duU3RhcnRUaW1lVXRjID0gY29vbGRvd25TdGFydFRpbWU7XG4gICAgICAgIGlmICghdGhpcy52YWxpZGF0ZSgpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb25zdHJ1Y3RvciBhcmd1bWVudHMgYXJlIG5vdCB2YWxpZFwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIG9iamVjdCB0byBjbGFzcyBvYmplY3RcbiAgICAgKiBAcGFyYW0gaW5wdXQ6IEpTT04gb2JqZWN0XG4gICAgICogUmV0dXJucyBjbGFzcyBvYmplY3RcbiAgICAgKi9cbiAgICBHb3Zlcm5lZENoYW5uZWxTdGF0ZS5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAoIWlucHV0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICAvLyBWYWxpZGF0aW9uIGlzIGhhbmRsZWQgYnkgR292ZXJuZWRDaGFubmVsU3RhdGUncyBjb25zdHJ1Y3RvclxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IEdvdmVybmVkQ2hhbm5lbFN0YXRlKGlucHV0LkNoYW5uZWxUeXBlLCBpbnB1dC5Db29sZG93blN0YXJ0VGltZVV0Yyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oZ2FjaG9pKSBMb2cgcGFyc2luZyBmYWlsZWRcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBHb3Zlcm5lZENoYW5uZWxTdGF0ZS5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghVXRpbHMuaXNFbnVtVmFsdWUodGhpcy5DaGFubmVsVHlwZSwgR292ZXJuZWRDaGFubmVsXzEuR292ZXJuZWRDaGFubmVsVHlwZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBtYWtlIGl0IGEgZGF0ZSBvYmplY3QgaWYgaXQncyBhIHZhbGlkIFVUQyBkYXRlIHRpbWUgdmFsdWVcbiAgICAgICAgaWYgKFV0aWxzLmlzVXRjRGF0ZXRpbWVTdHJpbmcodGhpcy5Db29sZG93blN0YXJ0VGltZVV0YykpIHtcbiAgICAgICAgICAgIHRoaXMuQ29vbGRvd25TdGFydFRpbWVVdGMgPSBVdGlscy5zdHJpbmdUb0RhdGUodGhpcy5Db29sZG93blN0YXJ0VGltZVV0Yyk7XG4gICAgICAgICAgICAvLyBBbGxvdyBudWxsIGFuZCBiYWQgY29vbGRvd25TdGFydFRpbWVcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZCh0aGlzLkNvb2xkb3duU3RhcnRUaW1lVXRjKSB8fCAhVXRpbHMuaXNEYXRlKHRoaXMuQ29vbGRvd25TdGFydFRpbWVVdGMpKSB7XG4gICAgICAgICAgICB0aGlzLkNvb2xkb3duU3RhcnRUaW1lVXRjID0gVXRpbHMuZ2V0RGlzdGFudFBhc3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIEdvdmVybmVkQ2hhbm5lbFN0YXRlLnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5DaGFubmVsVHlwZTtcbiAgICB9O1xuICAgIEdvdmVybmVkQ2hhbm5lbFN0YXRlLnByb3RvdHlwZS5nZXRDb29sZG93blN0YXJ0VGltZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQ29vbGRvd25TdGFydFRpbWVVdGM7XG4gICAgfTtcbiAgICByZXR1cm4gR292ZXJuZWRDaGFubmVsU3RhdGU7XG59KCkpO1xuZXhwb3J0cy5Hb3Zlcm5lZENoYW5uZWxTdGF0ZSA9IEdvdmVybmVkQ2hhbm5lbFN0YXRlO1xuLyoqXG4gKiBDbGFzcyByZXByZXNlbnRpbmcgd2hhdCBpcyBzdG9yZWQgaW4gdGhlIGZpbGUuXG4gKi9cbnZhciBGaWxlRGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWxlRGF0YSgpIHtcbiAgICB9XG4gICAgcmV0dXJuIEZpbGVEYXRhO1xufSgpKTtcbnZhciBGaWxlQmFzZWRHb3Zlcm5lZENoYW5uZWxTdGF0ZVByb3ZpZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZpbGVCYXNlZEdvdmVybmVkQ2hhbm5lbFN0YXRlUHJvdmlkZXIoc3RvcmFnZSkge1xuICAgICAgICBpZiAoIXN0b3JhZ2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInN0b3JhZ2UgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgIH1cbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBGaWxlQmFzZWRHb3Zlcm5lZENoYW5uZWxTdGF0ZVByb3ZpZGVyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBMb2FkIGNoYW5uZWwgc3RhdGUgZnJvbSBmaWxlIHVzaW5nIF9zdG9yYWdlUHJvdmlkZXIgKGdldCBiYWNrIHN0cmluZylcbiAgICAgICAgdmFyIHJlYWRTdHJpbmcgPSB0aGlzLnN0b3JhZ2UucmVhZChJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyLkZpbGVUeXBlLkdvdmVybmVkQ2hhbm5lbFN0YXRlcyk7XG4gICAgICAgIGlmICghcmVhZFN0cmluZykge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBmaWxlRGF0YTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZpbGVEYXRhID0gSlNPTi5wYXJzZShyZWFkU3RyaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gVE9ETyhnYWNob2kpIExvZyBwYXJzaW5nIGZhaWxlZFxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgaWYgKGZpbGVEYXRhICYmIGZpbGVEYXRhLkNoYW5uZWxTdGF0ZXMpIHtcbiAgICAgICAgICAgIGZpbGVEYXRhLkNoYW5uZWxTdGF0ZXMuZm9yRWFjaChmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3U3RhdGUgPSBHb3Zlcm5lZENoYW5uZWxTdGF0ZS5kZXNlcmlhbGl6ZShzdGF0ZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1N0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKG5ld1N0YXRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRmlsZUJhc2VkR292ZXJuZWRDaGFubmVsU3RhdGVQcm92aWRlci5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uIChzdGF0ZXMpIHtcbiAgICAgICAgaWYgKCFzdGF0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZmlsZURhdGEgPSBuZXcgRmlsZURhdGEoKTtcbiAgICAgICAgZmlsZURhdGEuQ2hhbm5lbFN0YXRlcyA9IHN0YXRlcztcbiAgICAgICAgdmFyIHdyaXRlU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoZmlsZURhdGEpO1xuICAgICAgICB0aGlzLnN0b3JhZ2Uud3JpdGUoSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZS5Hb3Zlcm5lZENoYW5uZWxTdGF0ZXMsIHdyaXRlU3RyaW5nKTtcbiAgICB9O1xuICAgIHJldHVybiBGaWxlQmFzZWRHb3Zlcm5lZENoYW5uZWxTdGF0ZVByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydHMuRmlsZUJhc2VkR292ZXJuZWRDaGFubmVsU3RhdGVQcm92aWRlciA9IEZpbGVCYXNlZEdvdmVybmVkQ2hhbm5lbFN0YXRlUHJvdmlkZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBHb3Zlcm5lZENoYW5uZWxfMSA9IHJlcXVpcmUoXCIuL0dvdmVybmVkQ2hhbm5lbFwiKTtcbnZhciBHb3Zlcm5lZENoYW5uZWxTdGF0ZVByb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9Hb3Zlcm5lZENoYW5uZWxTdGF0ZVByb3ZpZGVyXCIpO1xudmFyIFV0aWxzID0gcmVxdWlyZShcIi4vVXRpbHNcIik7XG52YXIgRGVmYXVsdENoYW5uZWxEYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIERlZmF1bHRDaGFubmVsRGF0YShuYW1lLCBjb29sZG93blNlY29uZHMpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5jb29sZG93blNlY29uZHMgPSBjb29sZG93blNlY29uZHM7XG4gICAgfVxuICAgIHJldHVybiBEZWZhdWx0Q2hhbm5lbERhdGE7XG59KCkpO1xudmFyIEdvdmVybm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEdvdmVybm9yKGNoYW5uZWxTdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgIGlmICghY2hhbm5lbFN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNoYW5uZWxTdGF0ZVByb3ZpZGVyIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaGFubmVsU3RhdGVQcm92aWRlciA9IGNoYW5uZWxTdGF0ZVByb3ZpZGVyO1xuICAgICAgICB0aGlzLmxvYWRDaGFubmVscygpO1xuICAgIH1cbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBHb3Zlcm5vci5wcm90b3R5cGUuZ2V0QXZhaWxhYmxlQ2hhbm5lbERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjaGFubmVsRGF0YSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5jaGFubmVscykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hhbm5lbHMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHZhciBjaGFubmVsID0gdGhpcy5jaGFubmVsc1trZXldO1xuICAgICAgICAgICAgICAgIGlmIChjaGFubmVsLmlzT3BlbigpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5uZWxEYXRhLnB1c2goY2hhbm5lbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjaGFubmVsRGF0YTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIEdvdmVybm9yLnByb3RvdHlwZS5pc0NoYW5uZWxPcGVuID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHR5cGUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0eXBlIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhbm5lbHNbdHlwZV0uaXNPcGVuKCk7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBHb3Zlcm5vci5wcm90b3R5cGUuc3RhcnRDaGFubmVsQ29vbGRvd24gPSBmdW5jdGlvbiAodHlwZSwgZGF0ZSkge1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodHlwZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInR5cGUgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBkYXRlID0gZGF0ZSA/IGRhdGUgOiBuZXcgRGF0ZSgpO1xuICAgICAgICAvLyBTdGFydCB0aGUgY29vbCBkb3duXG4gICAgICAgIHRoaXMuY2hhbm5lbHNbdHlwZV0uc2V0Q29vbGRvd25TdGFydFRpbWUoZGF0ZSk7XG4gICAgICAgIC8vIFNhdmUgdGhlIG5ldyBjaGFubmVsIHN0YXRlIGZvciBmdXR1cmUgc2Vzc2lvbnNcbiAgICAgICAgdGhpcy5zYXZlQ2hhbm5lbFN0YXRlc1RvUHJvdmlkZXIoKTtcbiAgICB9O1xuICAgIEdvdmVybm9yLnByb3RvdHlwZS5sb2FkQ2hhbm5lbHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIExvYWQgdXAgc3RhdGUgZnJvbSBwcmV2aW91cyBzZXNzaW9uc1xuICAgICAgICB0aGlzLmxvYWRDaGFubmVsU3RhdGVzRnJvbVByb3ZpZGVyKCk7XG4gICAgICAgIC8vIEZvciBhbnkgbWlzc2luZyBjaGFubmVscywgaW5pdCB0aGVtIGZyb20gc2NyYXRjaFxuICAgICAgICAvLyBUaGVyZSdzIG5vIHN0cmFpZ2h0Zm9yd2FyZCB3YXkgdG8gaXRlcmF0ZSBlbnVtcywgd2UgbmVlZCB0byBpdGVyYXRlIHRocm91Z2ggdGhlIGVudW0gYXJyYXlcbiAgICAgICAgLy8gICAgZmlsdGVyaW5nIG91dCBqdXN0IHRoZSBudW1lcmljIGVudW0gdmFsdWVzIChleGNsdWRpbmcgZW51bSBuYW1lcykuXG4gICAgICAgIGZvciAodmFyIGl0ZW0gaW4gR292ZXJuZWRDaGFubmVsXzEuR292ZXJuZWRDaGFubmVsVHlwZSkge1xuICAgICAgICAgICAgaWYgKEdvdmVybmVkQ2hhbm5lbF8xLkdvdmVybmVkQ2hhbm5lbFR5cGUuaGFzT3duUHJvcGVydHkoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gTnVtYmVyKGl0ZW0pO1xuICAgICAgICAgICAgICAgIC8vIHNraXAgaWYga2V5IGlzIG5vdCBudW1lcmljIGVudW0gdmFsdWUsIG9yIGlmIGFscmVhZHkgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKGtleSkgfHwgdGhpcy5jaGFubmVsc1trZXldKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdERhdGEgPSBHb3Zlcm5vci5kZWZhdWx0Q2hhbm5lbERhdGFba2V5XTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Q2hhbm5lbCA9IG5ldyBHb3Zlcm5lZENoYW5uZWxfMS5Hb3Zlcm5lZENoYW5uZWwoa2V5LCBkZWZhdWx0RGF0YS5uYW1lLCBkZWZhdWx0RGF0YS5jb29sZG93blNlY29uZHMsIG51bGwpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhbm5lbHNba2V5XSA9IG5ld0NoYW5uZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdvdmVybm9yLnByb3RvdHlwZS5sb2FkQ2hhbm5lbFN0YXRlc0Zyb21Qcm92aWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jaGFubmVscyA9IFtdO1xuICAgICAgICB2YXIgY2hhbm5lbFN0YXRlcyA9IHRoaXMuY2hhbm5lbFN0YXRlUHJvdmlkZXIubG9hZCgpO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gY2hhbm5lbFN0YXRlcykge1xuICAgICAgICAgICAgaWYgKGNoYW5uZWxTdGF0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHZhciBjaGFubmVsU3RhdGUgPSBjaGFubmVsU3RhdGVzW2tleV07XG4gICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBjaGFubmVsU3RhdGUuZ2V0VHlwZSgpO1xuICAgICAgICAgICAgICAgIHZhciBkZWZhdWx0RGF0YSA9IEdvdmVybm9yLmRlZmF1bHRDaGFubmVsRGF0YVt0eXBlXTtcbiAgICAgICAgICAgICAgICB2YXIgbmV3Q2hhbm5lbCA9IG5ldyBHb3Zlcm5lZENoYW5uZWxfMS5Hb3Zlcm5lZENoYW5uZWwodHlwZSwgZGVmYXVsdERhdGEubmFtZSwgZGVmYXVsdERhdGEuY29vbGRvd25TZWNvbmRzLCBjaGFubmVsU3RhdGUuZ2V0Q29vbGRvd25TdGFydFRpbWUoKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFubmVsc1tuZXdDaGFubmVsLmdldFR5cGUoKV0gPSBuZXdDaGFubmVsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHb3Zlcm5vci5wcm90b3R5cGUuc2F2ZUNoYW5uZWxTdGF0ZXNUb1Byb3ZpZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBCdWlsZCB1cCB0aGUgbGlzdCBvZiBjaGFubmVsIHN0YXRlc1xuICAgICAgICB2YXIgY2hhbm5lbFN0YXRlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5jaGFubmVscykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hhbm5lbHMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHZhciBjaGFubmVsID0gdGhpcy5jaGFubmVsc1trZXldO1xuICAgICAgICAgICAgICAgIHZhciBjaGFubmVsU3RhdGUgPSBuZXcgR292ZXJuZWRDaGFubmVsU3RhdGVQcm92aWRlcl8xLkdvdmVybmVkQ2hhbm5lbFN0YXRlKGNoYW5uZWwuZ2V0VHlwZSgpLCBjaGFubmVsLmdldENvb2xkb3duU3RhcnRUaW1lKCkpO1xuICAgICAgICAgICAgICAgIGNoYW5uZWxTdGF0ZXMucHVzaChjaGFubmVsU3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hhbm5lbFN0YXRlUHJvdmlkZXIuc2F2ZShjaGFubmVsU3RhdGVzKTtcbiAgICB9O1xuICAgIEdvdmVybm9yLm1pbnV0ZSA9IDYwO1xuICAgIEdvdmVybm9yLmhvdXIgPSA2MCAqIEdvdmVybm9yLm1pbnV0ZTtcbiAgICBHb3Zlcm5vci5kYXkgPSAyNCAqIEdvdmVybm9yLmhvdXI7XG4gICAgLy8gQXJyYXkgb2YgZGVmYXVsdCB2YWx1ZXMgZm9yIGVhY2ggY2hhbm5lbCB0eXBlLiBJbmRleGVkIGJ5IHRoZSBHb3Zlcm5lZENoYW5uZWxUeXBlIGVudW0gbmFtZS5cbiAgICBHb3Zlcm5vci5kZWZhdWx0Q2hhbm5lbERhdGEgPSBbXG4gICAgICAgIG5ldyBEZWZhdWx0Q2hhbm5lbERhdGEoR292ZXJuZWRDaGFubmVsXzEuR292ZXJuZWRDaGFubmVsVHlwZVtHb3Zlcm5lZENoYW5uZWxfMS5Hb3Zlcm5lZENoYW5uZWxUeXBlLlN0YW5kYXJkXSwgMTQgKiBHb3Zlcm5vci5kYXkpLFxuICAgICAgICBuZXcgRGVmYXVsdENoYW5uZWxEYXRhKEdvdmVybmVkQ2hhbm5lbF8xLkdvdmVybmVkQ2hhbm5lbFR5cGVbR292ZXJuZWRDaGFubmVsXzEuR292ZXJuZWRDaGFubmVsVHlwZS5VcmdlbnRdLCA0ICogR292ZXJub3IuaG91ciksXG4gICAgXTtcbiAgICByZXR1cm4gR292ZXJub3I7XG59KCkpO1xuZXhwb3J0cy5Hb3Zlcm5vciA9IEdvdmVybm9yO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgSVN1cnZleUV2ZW50O1xuKGZ1bmN0aW9uIChJU3VydmV5RXZlbnQpIHtcbiAgICB2YXIgVHlwZTtcbiAgICAoZnVuY3Rpb24gKFR5cGUpIHtcbiAgICAgICAgLy8gQSBzdHJpbmcgdG8gbGlzdGVuIHRvLCB3aXRoIGEgdHJpZ2dlciB0aHJlc2hvbGQsIGFuZCBwb3RlbnRpYWxseSBjcm9zcy1zZXNzaW9uIGFnZ3JlZ2F0aW9uXG4gICAgICAgIFR5cGVbVHlwZVtcIkNvdW50ZWRBY3Rpdml0eVwiXSA9IFwiQ291bnRlZEFjdGl2aXR5XCJdID0gXCJDb3VudGVkQWN0aXZpdHlcIjtcbiAgICAgICAgLy8gQW4gb3JkZXJlZCBsaXN0IG9mIENvdW50ZWRBY3Rpdml0aWVzLCB0byBiZSBhY3RpdmF0ZWQgaW4gc2VxdWVuY2VcbiAgICAgICAgVHlwZVtUeXBlW1wiQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VcIl0gPSBcIkNvdW50ZWRBY3Rpdml0eVNlcXVlbmNlXCJdID0gXCJDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZVwiO1xuICAgIH0pKFR5cGUgPSBJU3VydmV5RXZlbnQuVHlwZSB8fCAoSVN1cnZleUV2ZW50LlR5cGUgPSB7fSkpO1xufSkoSVN1cnZleUV2ZW50IHx8IChJU3VydmV5RXZlbnQgPSB7fSkpO1xubW9kdWxlLmV4cG9ydHMgPSBJU3VydmV5RXZlbnQ7XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBJU3VydmV5SW5mbztcbihmdW5jdGlvbiAoSVN1cnZleUluZm8pIHtcbiAgICB2YXIgTGF1bmNoVHlwZTtcbiAgICAoZnVuY3Rpb24gKExhdW5jaFR5cGUpIHtcbiAgICAgICAgLy8gTm8gbGF1bmNoIHR5cGUgc3BlY2lmaWVkLCBkZWZlciB0byB0aGUgbGF1bmNoZXIgZmFjdG9yeSBjb2RlXG4gICAgICAgIExhdW5jaFR5cGVbTGF1bmNoVHlwZVtcIkRlZmF1bHRcIl0gPSBcIkRlZmF1bHRcIl0gPSBcIkRlZmF1bHRcIjtcbiAgICAgICAgLy8gUHJlZmVyIGEgbm90aWZpY2F0aW9uLWJhc2VkIGxhdW5jaGVyIChsaWtlIHRoZSB3aW5kb3dzIHRvYXN0IGxhdW5jaGVyIHdoZW4gcHJlc2VudClcbiAgICAgICAgTGF1bmNoVHlwZVtMYXVuY2hUeXBlW1wiTm90aWZpY2F0aW9uXCJdID0gXCJOb3RpZmljYXRpb25cIl0gPSBcIk5vdGlmaWNhdGlvblwiO1xuICAgICAgICAvLyBQcmVmZXIgYSBtb2RhbC1kaWFsb2cgYmFzZWQgbGF1bmNoZXJcbiAgICAgICAgTGF1bmNoVHlwZVtMYXVuY2hUeXBlW1wiTW9kYWxcIl0gPSBcIk1vZGFsXCJdID0gXCJNb2RhbFwiO1xuICAgIH0pKExhdW5jaFR5cGUgPSBJU3VydmV5SW5mby5MYXVuY2hUeXBlIHx8IChJU3VydmV5SW5mby5MYXVuY2hUeXBlID0ge30pKTtcbiAgICB2YXIgQWRkaXRpb25hbERhdGFUeXBlO1xuICAgIChmdW5jdGlvbiAoQWRkaXRpb25hbERhdGFUeXBlKSB7XG4gICAgICAgIC8vIFJlcXVlc3QgZW1haWwgYWRkcmVzc1xuICAgICAgICBBZGRpdGlvbmFsRGF0YVR5cGVbQWRkaXRpb25hbERhdGFUeXBlW1wiRW1haWxBZGRyZXNzXCJdID0gMF0gPSBcIkVtYWlsQWRkcmVzc1wiO1xuICAgIH0pKEFkZGl0aW9uYWxEYXRhVHlwZSA9IElTdXJ2ZXlJbmZvLkFkZGl0aW9uYWxEYXRhVHlwZSB8fCAoSVN1cnZleUluZm8uQWRkaXRpb25hbERhdGFUeXBlID0ge30pKTtcbiAgICBJU3VydmV5SW5mby5ET01fVFlQRV9UQUdOQU1FID0gXCJUeXBlXCI7XG4gICAgSVN1cnZleUluZm8uRE9NX1RZUEVfVkFMVUUgPSBcIlN1cnZleVwiO1xuICAgIElTdXJ2ZXlJbmZvLkRPTV9JRF9UQUdOQU1FID0gXCJTdXJ2ZXlJRFwiO1xuICAgIElTdXJ2ZXlJbmZvLkpTT05fU1VSVkVZX0tFWU5BTUUgPSBcInN1cnZleVwiO1xuICAgIElTdXJ2ZXlJbmZvLkpTT05fSURfS0VZTkFNRSA9IFwic3VydmV5SWRcIjtcbn0pKElTdXJ2ZXlJbmZvIHx8IChJU3VydmV5SW5mbyA9IHt9KSk7XG5tb2R1bGUuZXhwb3J0cyA9IElTdXJ2ZXlJbmZvO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgSW5kZXhlZFRyYWNrZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSW5kZXhlZFRyYWNrZXIoKSB7XG4gICAgfVxuICAgIHJldHVybiBJbmRleGVkVHJhY2tlcjtcbn0oKSk7XG5leHBvcnRzLkluZGV4ZWRUcmFja2VyID0gSW5kZXhlZFRyYWNrZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBBY3Rpdml0eVRyYWNrZXIgPSByZXF1aXJlKFwiLi9BY3Rpdml0eVRyYWNrZXJcIik7XG52YXIgSW5kZXhlZFRyYWNrZXJfMSA9IHJlcXVpcmUoXCIuL0luZGV4ZWRUcmFja2VyXCIpO1xudmFyIFN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eV8xID0gcmVxdWlyZShcIi4vU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5XCIpO1xuLyoqXG4gKiBUaGlzIGNsYXNzIHRyYWNrcyBsb2cgY2FsbHMgYWdhaW5zdCBuYW1lZCBhY3Rpdml0eSBzdHJpbmdzIChtYXRjaGVkIG9uIHN0cmljdCBjYXNlLXNlbnNpdGl2ZSBlcXVhbGl0eSlcbiAqIGFuZCBjYWxscyB0aGUgcHJvdmlkZWQgY2FsbGJhY2sgd2hlbiBhbGwgYWN0aXZpdHkgdGhyZXNob2xkcyBmb3IgYSBnaXZlbiBzdXJ2ZXkgaGF2ZSBiZWVuIGNyb3NzZWRcbiAqXG4gKiAvLyB0b2RvIChnYWNob2kpOiBSZWZhY3RvciBjYWxsYmFjayB3aXRoIFByb21pc2VcbiAqL1xudmFyIFN1cnZleUFjdGl2aXR5TGlzdGVuZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3VydmV5QWN0aXZpdHlMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgICAgICBpZiAoIWNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYWxsYmFjayBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudHJhY2tlZEFjdGl2aXR5TWFwID0ge307XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG4gICAgU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5wcm90b3R5cGUubG9nQWN0aXZpdHkgPSBmdW5jdGlvbiAoYWN0aXZpdHlOYW1lLCBpbmNyZW1lbnQpIHtcbiAgICAgICAgaWYgKGluY3JlbWVudCA9PT0gdm9pZCAwKSB7IGluY3JlbWVudCA9IDE7IH1cbiAgICAgICAgdGhpcy5sb2dBY3Rpdml0eV9wcml2YXRlKGFjdGl2aXR5TmFtZSwgU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5Mb2dBY3Rpb25UeXBlLkluY3JlbWVudCwgaW5jcmVtZW50LCBudWxsKTtcbiAgICB9O1xuICAgIFN1cnZleUFjdGl2aXR5TGlzdGVuZXIucHJvdG90eXBlLmxvZ0FjdGl2aXR5U3RhcnRUaW1lID0gZnVuY3Rpb24gKGFjdGl2aXR5TmFtZSwgc3RhcnRUaW1lKSB7XG4gICAgICAgIHRoaXMubG9nQWN0aXZpdHlfcHJpdmF0ZShhY3Rpdml0eU5hbWUsIFN1cnZleUFjdGl2aXR5TGlzdGVuZXIuTG9nQWN0aW9uVHlwZS5TdGFydFRpbWUsIDAsIHN0YXJ0VGltZSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLnByb3RvdHlwZS5sb2dBY3Rpdml0eVN0b3BUaW1lID0gZnVuY3Rpb24gKGFjdGl2aXR5TmFtZSwgc3RvcFRpbWUpIHtcbiAgICAgICAgdGhpcy5sb2dBY3Rpdml0eV9wcml2YXRlKGFjdGl2aXR5TmFtZSwgU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5Mb2dBY3Rpb25UeXBlLlN0b3BUaW1lLCAwLCBzdG9wVGltZSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLnByb3RvdHlwZS5zZXRTdXJ2ZXlzID0gZnVuY3Rpb24gKHN1cnZleXMsIGJhc2VsaW5lKSB7XG4gICAgICAgIGlmIChiYXNlbGluZSA9PT0gdm9pZCAwKSB7IGJhc2VsaW5lID0gbmV3IFN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eV8xLlN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eSgpOyB9XG4gICAgICAgIGlmICghc3VydmV5cyB8fCBzdXJ2ZXlzLmxlbmd0aCA9PT0gMCB8fCAhYmFzZWxpbmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBQb3B1bGF0ZSBhIG5ldyBtYXAgYmFzZWQgb24gdGhlIHBhc3NlZCBpbiBzdXJ2ZXlzLCBidXQgcHJvcGFnYXRpbmcgYW5kIHRyYWNraW5nIGFjdGl2aXR5IGNvdW50c1xuICAgICAgICAvLyB3ZSBtYXkgaGF2ZSBzZWVuIGFnYWluc3QgdGhvc2UgZXZlbnRzXG4gICAgICAgIC8vIE5PVEU6IFdlIHdpbGwgbG9zZSBhY3Rpdml0eSBjb3VudHMgZm9yIHN1cnZleSBldmVudHMgdGhhdCBhcmUgbm8gbG9uZ2VyIHJlbGV2YW50LlxuICAgICAgICB2YXIgbmV3TWFwID0gbmV3IE9iamVjdCgpO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHN1cnZleXNfMSA9IHN1cnZleXM7IF9pIDwgc3VydmV5c18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHN1cnZleSA9IHN1cnZleXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgdHJhY2tpbmdTZXQgPSBzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmdldEFjdGl2YXRpb25FdmVudCgpLmdldFRyYWNraW5nU2V0KCk7XG4gICAgICAgICAgICAvLyBEb24ndCBhZGQgdGhlIHN1cnZleSBpZiBhbnkgb2YgaXRzIGV2ZW50cyBvdmVybGFwIHdpdGggYW4gYWxyZWFkeSByZWdpc3RlcmVkIHN1cnZleVxuICAgICAgICAgICAgdmFyIGhhc092ZXJsYXAgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgX2IgPSB0cmFja2luZ1NldC5nZXRMaXN0KCk7IF9hIDwgX2IubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYWNraW5nRGF0YSA9IF9iW19hXTtcbiAgICAgICAgICAgICAgICBpZiAobmV3TWFwLmhhc093blByb3BlcnR5KHRyYWNraW5nRGF0YS5nZXRBY3Rpdml0eSgpKSkge1xuICAgICAgICAgICAgICAgICAgICBoYXNPdmVybGFwID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhhc092ZXJsYXApIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEF0IHRoaXMgcG9pbnQsIHRoZSBzdXJ2ZXkncyBhY3Rpdml0aWVzIGFyZSBzYWZlIHRvIGFkZC5cbiAgICAgICAgICAgIC8vIFNldCB1cCB0aGUgc3RydWN0dXJlcyB3ZSBuZWVkIHRvIHRyYW5zZmVyIGJhc2VsaW5lIGNvdW50cyAoZnJvbSBwcmV2aW91cyBzZXNzaW9ucykgb3IgY3VycmVudCBjb3VudHMgKGZyb20gcHJldmlvdXMgdHJhY2tlcnMpXG4gICAgICAgICAgICAvLyBCb3RoIHZlY3RvcnMgbXVzdCBiZSBzb3J0ZWQgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlIHRyYWNraW5nU2V0Lkxpc3QgaXRlbXNcbiAgICAgICAgICAgIHZhciBiYXNlbGluZVN0YXRzID0gYmFzZWxpbmUuZ2V0QnlTdXJ2ZXlJZChzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmdldElkKCkpO1xuICAgICAgICAgICAgdmFyIGJhc2VsaW5lQ291bnRzID0gW3RyYWNraW5nU2V0LmdldExpc3QoKS5sZW5ndGhdO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRJbmRleGVkVHJhY2tlcnMgPSBuZXcgQXJyYXkodHJhY2tpbmdTZXQuZ2V0TGlzdCgpLmxlbmd0aCk7XG4gICAgICAgICAgICB2YXIgY3VycmVudEJhc2VsaW5lSW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRJbmRleCA9IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBfYyA9IDAsIF9kID0gdHJhY2tpbmdTZXQuZ2V0TGlzdCgpOyBfYyA8IF9kLmxlbmd0aDsgX2MrKykge1xuICAgICAgICAgICAgICAgIHZhciB0cmFja2luZ0RhdGEgPSBfZFtfY107XG4gICAgICAgICAgICAgICAgLy8gQmFzZWxpbmUgc3RhdHMgYXJlIG9ubHkgc3RvcmVkIGZvciBldmVudHMgd2l0aCBcIklzQWdncmVnYXRlID0gdHJ1ZVwiXG4gICAgICAgICAgICAgICAgYmFzZWxpbmVDb3VudHNbY3VycmVudEluZGV4XSA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKHRyYWNraW5nRGF0YS5nZXRJc0FnZ3JlZ2F0ZSgpICYmIGJhc2VsaW5lU3RhdHMgJiYgY3VycmVudEJhc2VsaW5lSW5kZXggPCBiYXNlbGluZVN0YXRzLkNvdW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgYmFzZWxpbmVDb3VudHNbY3VycmVudEluZGV4XSA9IGJhc2VsaW5lU3RhdHMuQ291bnRzW2N1cnJlbnRCYXNlbGluZUluZGV4KytdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBTZXNzaW9uIHN0YXRzIG1heSBiZSBhdmFpbGFibGUgaW4gdGhlIHByZXZpb3VzIHRyYWNrZWRBY3Rpdml0eU1hcFxuICAgICAgICAgICAgICAgIC8vIFRyYW5zZmVyIHRoZSBvbGQgXCJjdXJyZW50IHNlc3Npb25cIiBjb3VudCB0byB0aGUgbmV3IHRyYWNrZXJcbiAgICAgICAgICAgICAgICAvLyBJcyBzZXQgdG8gbnVsbCBpZiBub3QgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgY3VycmVudEluZGV4ZWRUcmFja2Vyc1tjdXJyZW50SW5kZXhdID0gdGhpcy50cmFja2VkQWN0aXZpdHlNYXBbdHJhY2tpbmdEYXRhLmdldEFjdGl2aXR5KCldO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gTWFrZSBhIG5ldyB0cmFja2VyIGFuZCBpbml0IHRoZSBjb3VudHMgYXBwcm9wcmlhdGVseS5cbiAgICAgICAgICAgIHZhciBuZXdUcmFja2VyID0gbmV3IEFjdGl2aXR5VHJhY2tlcih0cmFja2luZ1NldCk7XG4gICAgICAgICAgICAvLyBJZiBpbiBhIGZ1dHVyZSBjaGFuZ2Ugd2Ugc3RhcnQga2VlcGluZyB0cmFja2VycyByZWdpc3RlcmVkIHBhc3QgYWN0aXZhdGlvbiwgdGhpcyB3aWxsIGNoYW5nZVxuICAgICAgICAgICAgbmV3VHJhY2tlci5pbml0Q291bnRzKGJhc2VsaW5lQ291bnRzLCBjdXJyZW50SW5kZXhlZFRyYWNrZXJzLCBmYWxzZSAvKndhc0FjdGl2YXRlZFRoaXNTZXNzaW9uKi8pO1xuICAgICAgICAgICAgLy8gU2V0dXAgdGhlIGluZGV4ZWQgdHJhY2tlcnNcbiAgICAgICAgICAgIGZvciAodmFyIF9lID0gMCwgX2YgPSBuZXdUcmFja2VyLmdlbmVyYXRlQWN0aXZpdHlJbmRleExpc3QoKTsgX2UgPCBfZi5sZW5ndGg7IF9lKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZpdHlJbmRleCA9IF9mW19lXTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhlZFRyYWNrZXIgPSBuZXcgSW5kZXhlZFRyYWNrZXJfMS5JbmRleGVkVHJhY2tlcigpO1xuICAgICAgICAgICAgICAgIGluZGV4ZWRUcmFja2VyLmluZGV4ID0gYWN0aXZpdHlJbmRleC5pbmRleDtcbiAgICAgICAgICAgICAgICBpbmRleGVkVHJhY2tlci5zdXJ2ZXkgPSBzdXJ2ZXk7XG4gICAgICAgICAgICAgICAgaW5kZXhlZFRyYWNrZXIudHJhY2tlciA9IG5ld1RyYWNrZXI7XG4gICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIG5ldyB0cmFja2VyIGluIG91ciBuZXcgbWFwXG4gICAgICAgICAgICAgICAgbmV3TWFwW2FjdGl2aXR5SW5kZXguYWN0aXZpdHldID0gaW5kZXhlZFRyYWNrZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0IHRoZSBuZXcgbWFwIGluIHBsYWNlIG9mIHRoZSBvbGRcbiAgICAgICAgdGhpcy5jb3B5T2JqZWN0KHRoaXMudHJhY2tlZEFjdGl2aXR5TWFwLCBuZXdNYXApO1xuICAgIH07XG4gICAgU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5wcm90b3R5cGUuY2xlYXJTdXJ2ZXlzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzLnRyYWNrZWRBY3Rpdml0eU1hcCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICBkZWxldGUgX3RoaXMudHJhY2tlZEFjdGl2aXR5TWFwW2tleV07XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgdmFyIGluZGV4ZWRUcmFja2VyO1xuICAgICAgICBpbmRleGVkVHJhY2tlciA9IHRoaXMudHJhY2tlZEFjdGl2aXR5TWFwW2FjdGl2aXR5XTtcbiAgICAgICAgaWYgKCFpbmRleGVkVHJhY2tlcikge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluZGV4ZWRUcmFja2VyLnRyYWNrZXIuZ2V0Q291bnQoaW5kZXhlZFRyYWNrZXIuaW5kZXgpO1xuICAgIH07XG4gICAgU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5wcm90b3R5cGUuZ2V0U2Vzc2lvbkNvdW50ID0gZnVuY3Rpb24gKGFjdGl2aXR5KSB7XG4gICAgICAgIHZhciBpbmRleGVkVHJhY2tlcjtcbiAgICAgICAgaW5kZXhlZFRyYWNrZXIgPSB0aGlzLnRyYWNrZWRBY3Rpdml0eU1hcFthY3Rpdml0eV07XG4gICAgICAgIGlmICghaW5kZXhlZFRyYWNrZXIpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbmRleGVkVHJhY2tlci50cmFja2VyLmdldFNlc3Npb25Db3VudChpbmRleGVkVHJhY2tlci5pbmRleCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBbiBhdG9taWMgZ2V0LWFuZC1zZXQgbWV0aG9kLiAgUmV0dXJucyB0aGUgY3VycmVudCBTZXNzaW9uQ291bnQsIHJlc2V0dGluZyBpdCB0byB6ZXJvIGFuZCBhZGRpbmcgaXQgaW50byB0aGUgZXN0YWJsaXNoZWQgYmFzZWxpbmVcbiAgICAgKi9cbiAgICBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLnByb3RvdHlwZS5tb3ZlU2Vzc2lvbkNvdW50SW50b0Jhc2VDb3VudCA9IGZ1bmN0aW9uIChhY3Rpdml0eSkge1xuICAgICAgICB2YXIgaW5kZXhlZFRyYWNrZXI7XG4gICAgICAgIGluZGV4ZWRUcmFja2VyID0gdGhpcy50cmFja2VkQWN0aXZpdHlNYXBbYWN0aXZpdHldO1xuICAgICAgICBpZiAoIWluZGV4ZWRUcmFja2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5kZXhlZFRyYWNrZXIudHJhY2tlci5tb3ZlU2Vzc2lvbkNvdW50SW50b0Jhc2VDb3VudChpbmRleGVkVHJhY2tlci5pbmRleCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLnByb3RvdHlwZS5nZXRTdXJ2ZXkgPSBmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgdmFyIGluZGV4ZWRUcmFja2VyO1xuICAgICAgICBpbmRleGVkVHJhY2tlciA9IHRoaXMudHJhY2tlZEFjdGl2aXR5TWFwW2FjdGl2aXR5XTtcbiAgICAgICAgaWYgKCFpbmRleGVkVHJhY2tlcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluZGV4ZWRUcmFja2VyLnN1cnZleTtcbiAgICB9O1xuICAgIFN1cnZleUFjdGl2aXR5TGlzdGVuZXIucHJvdG90eXBlLnNldENhbGxiYWNrID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9O1xuICAgIFN1cnZleUFjdGl2aXR5TGlzdGVuZXIucHJvdG90eXBlLmxvZ0FjdGl2aXR5X3ByaXZhdGUgPSBmdW5jdGlvbiAoYWN0aXZpdHlOYW1lLCBsb2dUeXBlLCBpbmNyZW1lbnQsIHRpbWVzdGFtcCkge1xuICAgICAgICB2YXIgaW5kZXhlZFRyYWNrZXI7XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGluZGV4ZWRUcmFja2VyID0gdGhpcy50cmFja2VkQWN0aXZpdHlNYXBbYWN0aXZpdHlOYW1lXTtcbiAgICAgICAgaWYgKCFpbmRleGVkVHJhY2tlcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAobG9nVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLkxvZ0FjdGlvblR5cGUuU3RhcnRUaW1lOiB7XG4gICAgICAgICAgICAgICAgaW5kZXhlZFRyYWNrZXIudHJhY2tlci5zdGFydFRpbWUoaW5kZXhlZFRyYWNrZXIuaW5kZXgsIHRpbWVzdGFtcCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLkxvZ0FjdGlvblR5cGUuU3RvcFRpbWU6IHtcbiAgICAgICAgICAgICAgICBpbmNyZW1lbnQgPSBpbmRleGVkVHJhY2tlci50cmFja2VyLnN0b3BUaW1lKGluZGV4ZWRUcmFja2VyLmluZGV4LCB0aW1lc3RhbXApO1xuICAgICAgICAgICAgICAgIC8vIGZhbGwgdGhyb3VnaCB0byBpbmNyZW1lbnQgdGhlIGFjdGl2aXR5IGFzIHdlbGwuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFN1cnZleUFjdGl2aXR5TGlzdGVuZXIuTG9nQWN0aW9uVHlwZS5JbmNyZW1lbnQ6IHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gaW5kZXhlZFRyYWNrZXIudHJhY2tlci5pbmNyZW1lbnRBY3Rpdml0eShpbmRleGVkVHJhY2tlci5pbmRleCwgaW5jcmVtZW50KTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gQWN0aXZpdHlUcmFja2VyLkluY3JlbWVudFJlc3VsdC5BbGxBY3Rpdml0aWVzQWN0aXZhdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmV4ZWN1dGVDYWxsYmFjayhpbmRleGVkVHJhY2tlci5zdXJ2ZXkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLnByb3RvdHlwZS5leGVjdXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoc3VydmV5KSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sucnVuKHN1cnZleSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLnByb3RvdHlwZS5jb3B5T2JqZWN0ID0gZnVuY3Rpb24gKHRhcmdldCwgc291cmNlKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKHNvdXJjZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyO1xufSgpKTtcbihmdW5jdGlvbiAoU3VydmV5QWN0aXZpdHlMaXN0ZW5lcikge1xuICAgIHZhciBMb2dBY3Rpb25UeXBlO1xuICAgIChmdW5jdGlvbiAoTG9nQWN0aW9uVHlwZSkge1xuICAgICAgICBMb2dBY3Rpb25UeXBlW0xvZ0FjdGlvblR5cGVbXCJJbmNyZW1lbnRcIl0gPSAwXSA9IFwiSW5jcmVtZW50XCI7XG4gICAgICAgIExvZ0FjdGlvblR5cGVbTG9nQWN0aW9uVHlwZVtcIlN0YXJ0VGltZVwiXSA9IDFdID0gXCJTdGFydFRpbWVcIjtcbiAgICAgICAgTG9nQWN0aW9uVHlwZVtMb2dBY3Rpb25UeXBlW1wiU3RvcFRpbWVcIl0gPSAyXSA9IFwiU3RvcFRpbWVcIjtcbiAgICB9KShMb2dBY3Rpb25UeXBlID0gU3VydmV5QWN0aXZpdHlMaXN0ZW5lci5Mb2dBY3Rpb25UeXBlIHx8IChTdXJ2ZXlBY3Rpdml0eUxpc3RlbmVyLkxvZ0FjdGlvblR5cGUgPSB7fSkpO1xufSkoU3VydmV5QWN0aXZpdHlMaXN0ZW5lciB8fCAoU3VydmV5QWN0aXZpdHlMaXN0ZW5lciA9IHt9KSk7XG5tb2R1bGUuZXhwb3J0cyA9IFN1cnZleUFjdGl2aXR5TGlzdGVuZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBJU3VydmV5Q29tcG9uZW50ID0gcmVxdWlyZShcIi4vLi4vQXBpL0lTdXJ2ZXlDb21wb25lbnRcIik7XG52YXIgQ29tbWVudENvbXBvbmVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb21tZW50Q29tcG9uZW50KGRhdGEpIHtcbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkYXRhIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkYXRhLnF1ZXN0aW9uKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkYXRhLnF1ZXN0aW9uIG11c3Qgbm90IGJlIG51bGwgb3IgZW1wdHlcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgdGhpcy51c2VyQ29tbWVudCA9IFwiXCI7XG4gICAgfVxuICAgIENvbW1lbnRDb21wb25lbnQubWFrZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IENvbW1lbnRDb21wb25lbnQoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDb21tZW50Q29tcG9uZW50LnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gSVN1cnZleUNvbXBvbmVudC5UeXBlLkNvbW1lbnQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDb21tZW50Q29tcG9uZW50LnByb3RvdHlwZS5nZXRRdWVzdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5xdWVzdGlvbjtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIENvbW1lbnRDb21wb25lbnQucHJvdG90eXBlLnNldFN1Ym1pdHRlZFRleHQgPSBmdW5jdGlvbiAodXNlckNvbW1lbnQpIHtcbiAgICAgICAgdGhpcy51c2VyQ29tbWVudCA9IHVzZXJDb21tZW50O1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgQ29tbWVudENvbXBvbmVudC5wcm90b3R5cGUuZ2V0U3VibWl0dGVkVGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudXNlckNvbW1lbnQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBDb21tZW50Q29tcG9uZW50LnByb3RvdHlwZS5nZXREb21FbGVtZW50cyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgaWYgKCFkb2MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudChJU3VydmV5Q29tcG9uZW50LkRPTV9DT01NRU5UX1RBR05BTUUpO1xuICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvYy5jcmVhdGVUZXh0Tm9kZSh0aGlzLmdldFN1Ym1pdHRlZFRleHQoKSkpO1xuICAgICAgICByZXR1cm4gW2VsZW1lbnRdO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgQ29tbWVudENvbXBvbmVudC5wcm90b3R5cGUuZ2V0SnNvbkVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdFtJU3VydmV5Q29tcG9uZW50LkpTT05fQ09NTUVOVF9LRVlOQU1FXSA9IHRoaXMuZ2V0U3VibWl0dGVkVGV4dCgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIENvbW1lbnRDb21wb25lbnQ7XG59KCkpO1xuKGZ1bmN0aW9uIChDb21tZW50Q29tcG9uZW50KSB7XG4gICAgdmFyIENvbW1lbnRDb21wb25lbnREYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDb21tZW50Q29tcG9uZW50RGF0YSgpIHtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQ29tbWVudENvbXBvbmVudERhdGE7XG4gICAgfSgpKTtcbiAgICBDb21tZW50Q29tcG9uZW50LkNvbW1lbnRDb21wb25lbnREYXRhID0gQ29tbWVudENvbXBvbmVudERhdGE7XG59KShDb21tZW50Q29tcG9uZW50IHx8IChDb21tZW50Q29tcG9uZW50ID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gQ29tbWVudENvbXBvbmVudDtcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIElQcm9tcHRDb21wb25lbnQgPSByZXF1aXJlKFwiLi8uLi9BcGkvSVByb21wdENvbXBvbmVudFwiKTtcbnZhciBJU3VydmV5Q29tcG9uZW50ID0gcmVxdWlyZShcIi4vLi4vQXBpL0lTdXJ2ZXlDb21wb25lbnRcIik7XG52YXIgUHJvbXB0Q29tcG9uZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFByb21wdENvbXBvbmVudChkYXRhKSB7XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YSBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS5xdWVzdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YS5xdWVzdGlvbiBtdXN0IG5vdCBiZSBudWxsIG9yIGVtcHR5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS50aXRsZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YS50aXRsZSBtdXN0IG5vdCBiZSBudWxsIG9yIGVtcHR5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS55ZXNCdXR0b25MYWJlbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YS55ZXNCdXR0b25MYWJlbCBtdXN0IG5vdCBiZSBudWxsIG9yIGVtcHR5XCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS5ub0J1dHRvbkxhYmVsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkYXRhLm5vQnV0dG9uTGFiZWwgbXVzdCBub3QgYmUgbnVsbCBvciBlbXB0eVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgICB0aGlzLnNlbGVjdGVkQnV0dG9uID0gSVByb21wdENvbXBvbmVudC5Qcm9tcHRCdXR0b24uVW5zZWxlY3RlZDtcbiAgICB9XG4gICAgUHJvbXB0Q29tcG9uZW50Lm1ha2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9tcHRDb21wb25lbnQoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBQcm9tcHRDb21wb25lbnQucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBJU3VydmV5Q29tcG9uZW50LlR5cGUuUHJvbXB0O1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgUHJvbXB0Q29tcG9uZW50LnByb3RvdHlwZS5nZXRUaXRsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS50aXRsZTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIFByb21wdENvbXBvbmVudC5wcm90b3R5cGUuZ2V0UXVlc3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEucXVlc3Rpb247XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBQcm9tcHRDb21wb25lbnQucHJvdG90eXBlLmdldFllc0J1dHRvblRleHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEueWVzQnV0dG9uTGFiZWw7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBQcm9tcHRDb21wb25lbnQucHJvdG90eXBlLmdldE5vQnV0dG9uVGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5ub0J1dHRvbkxhYmVsO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgUHJvbXB0Q29tcG9uZW50LnByb3RvdHlwZS5zZXRCdXR0b25TZWxlY3RlZCA9IGZ1bmN0aW9uIChzZWxlY3RlZCkge1xuICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRCdXR0b24gPSBzZWxlY3RlZDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgUHJvbXB0Q29tcG9uZW50LnByb3RvdHlwZS5nZXRCdXR0b25TZWxlY3RlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRCdXR0b247XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBQcm9tcHRDb21wb25lbnQucHJvdG90eXBlLmdldERvbUVsZW1lbnRzID0gZnVuY3Rpb24gKGRvYykge1xuICAgICAgICBpZiAoIWRvYykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRG9jdW1lbnQgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KElTdXJ2ZXlDb21wb25lbnQuRE9NX1BST01QVF9UQUdOQU1FKTtcbiAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChkb2MuY3JlYXRlVGV4dE5vZGUodGhpcy5wcm9tcHRCdXR0b25Ub1N0cmluZyh0aGlzLmdldEJ1dHRvblNlbGVjdGVkKCkpKSk7XG4gICAgICAgIHJldHVybiBbZWxlbWVudF07XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBQcm9tcHRDb21wb25lbnQucHJvdG90eXBlLmdldEpzb25FbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICByZXN1bHRbSVN1cnZleUNvbXBvbmVudC5KU09OX1BST01QVF9LRVlOQU1FXSA9IHRoaXMucHJvbXB0QnV0dG9uVG9TdHJpbmcodGhpcy5nZXRCdXR0b25TZWxlY3RlZCgpKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFByb21wdENvbXBvbmVudC5wcm90b3R5cGUucHJvbXB0QnV0dG9uVG9TdHJpbmcgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBJUHJvbXB0Q29tcG9uZW50LlByb21wdEJ1dHRvbi5VbnNlbGVjdGVkOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIlVuc2VsZWN0ZWRcIjtcbiAgICAgICAgICAgIGNhc2UgSVByb21wdENvbXBvbmVudC5Qcm9tcHRCdXR0b24uWWVzOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIlllc1wiO1xuICAgICAgICAgICAgY2FzZSBJUHJvbXB0Q29tcG9uZW50LlByb21wdEJ1dHRvbi5ObzpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJOb1wiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJVbmtub3duXCI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBQcm9tcHRDb21wb25lbnQ7XG59KCkpO1xuKGZ1bmN0aW9uIChQcm9tcHRDb21wb25lbnQpIHtcbiAgICB2YXIgUHJvbXB0Q29tcG9uZW50RGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUHJvbXB0Q29tcG9uZW50RGF0YSgpIHtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbXB0Q29tcG9uZW50RGF0YTtcbiAgICB9KCkpO1xuICAgIFByb21wdENvbXBvbmVudC5Qcm9tcHRDb21wb25lbnREYXRhID0gUHJvbXB0Q29tcG9uZW50RGF0YTtcbn0pKFByb21wdENvbXBvbmVudCB8fCAoUHJvbXB0Q29tcG9uZW50ID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gUHJvbXB0Q29tcG9uZW50O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgSVN1cnZleUNvbXBvbmVudCA9IHJlcXVpcmUoXCIuLy4uL0FwaS9JU3VydmV5Q29tcG9uZW50XCIpO1xudmFyIFJhdGluZ0NvbXBvbmVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSYXRpbmdDb21wb25lbnQoZGF0YSkge1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRhdGEgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRhdGEucXVlc3Rpb24pIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRhdGEucXVlc3Rpb24gbXVzdCBub3QgYmUgbnVsbCBvciBlbXB0eVwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nIHx8IGRhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nIG11c3Qgbm90IGJlIG51bGwgb3IgaGF2ZSBsZXNzIHRoYW4gdHdvIGNob2ljZXNcIik7XG4gICAgICAgIH1cbiAgICAgICAgZGF0YS5yYXRpbmdWYWx1ZXNBc2NlbmRpbmcuZm9yRWFjaChmdW5jdGlvbiAocmF0aW5nKSB7XG4gICAgICAgICAgICBpZiAoIXJhdGluZykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInJhdGluZyB2YWx1ZXMgbXVzdCBub3QgY29udGFpbiBudWxsIG9yIGVtcHR5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gLTE7XG4gICAgfVxuICAgIFJhdGluZ0NvbXBvbmVudC5tYWtlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmF0aW5nQ29tcG9uZW50KGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmF0aW5nQ29tcG9uZW50LnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gSVN1cnZleUNvbXBvbmVudC5UeXBlLlJhdGluZztcbiAgICB9O1xuICAgIFJhdGluZ0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0UXVlc3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEucXVlc3Rpb247XG4gICAgfTtcbiAgICBSYXRpbmdDb21wb25lbnQucHJvdG90eXBlLmdldFJhdGluZ1ZhbHVlc0FzY2VuZGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5yYXRpbmdWYWx1ZXNBc2NlbmRpbmc7XG4gICAgfTtcbiAgICBSYXRpbmdDb21wb25lbnQucHJvdG90eXBlLmdldFNlbGVjdGVkUmF0aW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNSYXRpbmdJbmRleFZhbGlkKHRoaXMuc2VsZWN0ZWRJbmRleCkpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nW3RoaXMuc2VsZWN0ZWRJbmRleF07XG4gICAgfTtcbiAgICBSYXRpbmdDb21wb25lbnQucHJvdG90eXBlLnNldFNlbGVjdGVkUmF0aW5nSW5kZXggPSBmdW5jdGlvbiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNSYXRpbmdJbmRleFZhbGlkKHNlbGVjdGVkKSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gc2VsZWN0ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAtMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUmF0aW5nQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTZWxlY3RlZFJhdGluZ0luZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEluZGV4O1xuICAgIH07XG4gICAgUmF0aW5nQ29tcG9uZW50LnByb3RvdHlwZS5nZXREb21FbGVtZW50cyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgaWYgKCFkb2MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudChJU3VydmV5Q29tcG9uZW50LkRPTV9SQVRJTkdfVEFHTkFNRSk7XG4gICAgICAgIGlmICghdGhpcy5pc1JhdGluZ0luZGV4VmFsaWQodGhpcy5nZXRTZWxlY3RlZFJhdGluZ0luZGV4KCkpKSB7XG4gICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvYy5jcmVhdGVUZXh0Tm9kZShcIk5vdCByYXRlZFwiKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBFbmZvcmNlIHNpeCBkaWdpdHMgYWZ0ZXIgdGhlIGRlY2ltYWxcbiAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jLmNyZWF0ZVRleHROb2RlKHRoaXMuZ2V0Tm9ybWFsaXplZFJhdGluZ1Njb3JlKCkudG9GaXhlZCg2KSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbZWxlbWVudF07XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBSYXRpbmdDb21wb25lbnQucHJvdG90eXBlLmdldEpzb25FbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICBpZiAoIXRoaXMuaXNSYXRpbmdJbmRleFZhbGlkKHRoaXMuZ2V0U2VsZWN0ZWRSYXRpbmdJbmRleCgpKSkge1xuICAgICAgICAgICAgcmVzdWx0W0lTdXJ2ZXlDb21wb25lbnQuSlNPTl9SQVRJTkdfS0VZTkFNRV0gPSBcIk5vdCByYXRlZFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0W0lTdXJ2ZXlDb21wb25lbnQuSlNPTl9SQVRJTkdfS0VZTkFNRV0gPSB0aGlzLmdldE5vcm1hbGl6ZWRSYXRpbmdTY29yZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBSYXRpbmdDb21wb25lbnQucHJvdG90eXBlLmlzUmF0aW5nSW5kZXhWYWxpZCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICByZXR1cm4gKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmRhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nLmxlbmd0aCk7XG4gICAgfTtcbiAgICBSYXRpbmdDb21wb25lbnQucHJvdG90eXBlLmdldE5vcm1hbGl6ZWRSYXRpbmdTY29yZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUmF0aW5nSW5kZXhWYWxpZCh0aGlzLmdldFNlbGVjdGVkUmF0aW5nSW5kZXgoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRhdGEuaXNaZXJvQmFzZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5zZWxlY3RlZEluZGV4KSAvICh0aGlzLmRhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nLmxlbmd0aCAtIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLnNlbGVjdGVkSW5kZXggKyAxLjApIC8gdGhpcy5kYXRhLnJhdGluZ1ZhbHVlc0FzY2VuZGluZy5sZW5ndGg7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBSYXRpbmdDb21wb25lbnQ7XG59KCkpO1xuKGZ1bmN0aW9uIChSYXRpbmdDb21wb25lbnQpIHtcbiAgICB2YXIgUmF0aW5nQ29tcG9uZW50RGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUmF0aW5nQ29tcG9uZW50RGF0YSgpIHtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUmF0aW5nQ29tcG9uZW50RGF0YTtcbiAgICB9KCkpO1xuICAgIFJhdGluZ0NvbXBvbmVudC5SYXRpbmdDb21wb25lbnREYXRhID0gUmF0aW5nQ29tcG9uZW50RGF0YTtcbn0pKFJhdGluZ0NvbXBvbmVudCB8fCAoUmF0aW5nQ29tcG9uZW50ID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gUmF0aW5nQ29tcG9uZW50O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQWN0aXZpdHlUcmFja2luZ0RhdGFfMSA9IHJlcXVpcmUoXCIuL0FjdGl2aXR5VHJhY2tpbmdEYXRhXCIpO1xudmFyIEFjdGl2aXR5VHJhY2tpbmdTZXRfMSA9IHJlcXVpcmUoXCIuL0FjdGl2aXR5VHJhY2tpbmdTZXRcIik7XG52YXIgSVN1cnZleUV2ZW50ID0gcmVxdWlyZShcIi4vSVN1cnZleUV2ZW50XCIpO1xudmFyIENvdW50ZWRBY3Rpdml0eUV2ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvdW50ZWRBY3Rpdml0eUV2ZW50KGRhdGEpIHtcbiAgICAgICAgaWYgKCFkYXRhKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkYXRhIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEuY291bnQgPD0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiY291bnQgbXVzdCBiZSBncmVhdGVyIHRoYW4gMFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRhdGEuYWN0aXZpdHkgfHwgZGF0YS5hY3Rpdml0eS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImFjdGl2aXR5IG11c3Qgbm90IGJlIG51bGwgb3IgYW4gZW1wdHkgc3RyaW5nXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgfVxuICAgIENvdW50ZWRBY3Rpdml0eUV2ZW50Lm1ha2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDb3VudGVkQWN0aXZpdHlFdmVudChkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvdW50ZWRBY3Rpdml0eUV2ZW50LnByb3RvdHlwZS5nZXRBY3Rpdml0eSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5hY3Rpdml0eTtcbiAgICB9O1xuICAgIENvdW50ZWRBY3Rpdml0eUV2ZW50LnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5jb3VudDtcbiAgICB9O1xuICAgIENvdW50ZWRBY3Rpdml0eUV2ZW50LnByb3RvdHlwZS5pc0FnZ3JlZ2F0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pc0FnZ3JlZ2F0ZTtcbiAgICB9O1xuICAgIENvdW50ZWRBY3Rpdml0eUV2ZW50LnByb3RvdHlwZS5nZXRUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gSVN1cnZleUV2ZW50LlR5cGUuQ291bnRlZEFjdGl2aXR5O1xuICAgIH07XG4gICAgQ291bnRlZEFjdGl2aXR5RXZlbnQucHJvdG90eXBlLmdldFRyYWNraW5nU2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdHJhY2tpbmdEYXRhTGlzdCA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0cmFja2luZ0RhdGFMaXN0LnB1c2gobmV3IEFjdGl2aXR5VHJhY2tpbmdEYXRhXzEuQWN0aXZpdHlUcmFja2luZ0RhdGEodGhpcy5kYXRhLmFjdGl2aXR5LCB0aGlzLmRhdGEuY291bnQsIHRoaXMuZGF0YS5pc0FnZ3JlZ2F0ZSkpO1xuICAgICAgICByZXR1cm4gbmV3IEFjdGl2aXR5VHJhY2tpbmdTZXRfMS5BY3Rpdml0eVRyYWNraW5nU2V0KGZhbHNlLCB0cmFja2luZ0RhdGFMaXN0KTtcbiAgICB9O1xuICAgIHJldHVybiBDb3VudGVkQWN0aXZpdHlFdmVudDtcbn0oKSk7XG5leHBvcnRzLkNvdW50ZWRBY3Rpdml0eUV2ZW50ID0gQ291bnRlZEFjdGl2aXR5RXZlbnQ7XG4vKipcbiAqIERhdGEgY2xhc3MgZm9yIHNlcmlhbGl6YXRpb24gYW5kIGRlc2VyaWFsaXphdGlvbi4gRG8gbm90IGFkZCBsb2dpYyBpbiBoZXJlLlxuICovXG52YXIgQ291bnRlZEFjdGl2aXR5RXZlbnREYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvdW50ZWRBY3Rpdml0eUV2ZW50RGF0YSgpIHtcbiAgICB9XG4gICAgcmV0dXJuIENvdW50ZWRBY3Rpdml0eUV2ZW50RGF0YTtcbn0oKSk7XG5leHBvcnRzLkNvdW50ZWRBY3Rpdml0eUV2ZW50RGF0YSA9IENvdW50ZWRBY3Rpdml0eUV2ZW50RGF0YTtcbnZhciBDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZUV2ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvdW50ZWRBY3Rpdml0eVNlcXVlbmNlRXZlbnQoZGF0YSkge1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRhdGEgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRhdGEuc2VxdWVuY2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRhdGEuc2VxdWVuY2UgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0YS5zZXF1ZW5jZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImRhdGEuc2VxdWVuY2Ugc2l6ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZGF0YS5zZXF1ZW5jZTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBjb3VudGVkQWN0aXZpdHlFdmVudERhdGEgPSBfYVtfaV07XG4gICAgICAgICAgICB0aGlzLmRhdGEucHVzaChuZXcgQ291bnRlZEFjdGl2aXR5RXZlbnQoY291bnRlZEFjdGl2aXR5RXZlbnREYXRhKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudC5tYWtlID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudChkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvdW50ZWRBY3Rpdml0eVNlcXVlbmNlRXZlbnQucHJvdG90eXBlLmdldFNlcXVlbmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhO1xuICAgIH07XG4gICAgQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudC5wcm90b3R5cGUuZ2V0VHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIElTdXJ2ZXlFdmVudC5UeXBlLkNvdW50ZWRBY3Rpdml0eVNlcXVlbmNlO1xuICAgIH07XG4gICAgQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudC5wcm90b3R5cGUuZ2V0VHJhY2tpbmdTZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0cmFja2luZ0RhdGFMaXN0ID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLmRhdGE7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgY291bnRlZEFjdGl2aXR5RXZlbnQgPSBfYVtfaV07XG4gICAgICAgICAgICB0cmFja2luZ0RhdGFMaXN0LnB1c2gobmV3IEFjdGl2aXR5VHJhY2tpbmdEYXRhXzEuQWN0aXZpdHlUcmFja2luZ0RhdGEoY291bnRlZEFjdGl2aXR5RXZlbnQuZ2V0QWN0aXZpdHkoKSwgY291bnRlZEFjdGl2aXR5RXZlbnQuZ2V0Q291bnQoKSwgY291bnRlZEFjdGl2aXR5RXZlbnQuaXNBZ2dyZWdhdGUoKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgQWN0aXZpdHlUcmFja2luZ1NldF8xLkFjdGl2aXR5VHJhY2tpbmdTZXQodHJ1ZSwgdHJhY2tpbmdEYXRhTGlzdCk7XG4gICAgfTtcbiAgICByZXR1cm4gQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudDtcbn0oKSk7XG5leHBvcnRzLkNvdW50ZWRBY3Rpdml0eVNlcXVlbmNlRXZlbnQgPSBDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZUV2ZW50O1xuLyoqXG4gKiBEYXRhIGNsYXNzIGZvciBzZXJpYWxpemF0aW9uIGFuZCBkZXNlcmlhbGl6YXRpb24uIERvIG5vdCBhZGQgbG9naWMgaW4gaGVyZS5cbiAqL1xudmFyIENvdW50ZWRBY3Rpdml0eVNlcXVlbmNlRXZlbnREYXRhID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvdW50ZWRBY3Rpdml0eVNlcXVlbmNlRXZlbnREYXRhKCkge1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBObyBhcmdzIGNvbnN0cnVjdG9yIG5lZWRlZCBmb3Igc2VyaWFsaXphdGlvbi5cbiAgICAgKi9cbiAgICBDb3VudGVkQWN0aXZpdHlTZXF1ZW5jZUV2ZW50RGF0YS5wcm90b3R5cGUuQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICByZXR1cm4gQ291bnRlZEFjdGl2aXR5U2VxdWVuY2VFdmVudERhdGE7XG59KCkpO1xuZXhwb3J0cy5Db3VudGVkQWN0aXZpdHlTZXF1ZW5jZUV2ZW50RGF0YSA9IENvdW50ZWRBY3Rpdml0eVNlcXVlbmNlRXZlbnREYXRhO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKipcbiAqIEdlbmVyaWMgY2xhc3MgZm9yIG1hbmFnaW5nIGEgY29sbGVjdGlvbiBvZiBzdXJ2ZXkgc3RhdHMuIEluY2x1ZGVzIHJlYWQtZnJvbS93cml0ZS10byBqc29uIHN0cnVjdHVyZXMgb3IgYSBmaWxlLFxuICogYXMgd2VsbCBhcyBtZXJnZSByb3V0aW5lcyBmb3IgY29tYmluaW5nIGNvbGxlY3Rpb25zXG4gKi9cbnZhciBTdXJ2ZXlTdGF0Q29sbGVjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlTdGF0Q29sbGVjdGlvbigpIHtcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBwcm9wZXJ0eSBuYW1lIG1hdGNoZXMgdGhlIEpTT04gcm9vdCBrZXkgbmFtZSBmb3IgcHJvcGVyIHNlcmlhbGl6YXRpb24vIGRlc2VyaWFsaXphdGlvblxuICAgICAgICB0aGlzLlN1cnZleXMgPSB7fTtcbiAgICAgICAgdGhpcy5TdXJ2ZXlzID0ge307XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBzdGF0cy4gT3ZlcndyaXRlcyBpZiBhbHJlYWR5IGV4aXN0cy5cbiAgICAgKi9cbiAgICBTdXJ2ZXlTdGF0Q29sbGVjdGlvbi5wcm90b3R5cGUuYWRkU3RhdHMgPSBmdW5jdGlvbiAoc3VydmV5SWQsIHN0YXRzKSB7XG4gICAgICAgIHRoaXMuU3VydmV5c1tzdXJ2ZXlJZF0gPSBzdGF0cztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEdldCBhIFN1cnZleUFjdGl2YXRpb25TdGF0cyBvYmplY3QgYnkgc3VydmV5SWQuIFJldHVybnMgbnVsbCBpZiBzdXJ2ZXlJZCBpcyBub3QgZm91bmRcbiAgICAgKi9cbiAgICBTdXJ2ZXlTdGF0Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0QnlTdXJ2ZXlJZCA9IGZ1bmN0aW9uIChzdXJ2ZXlJZCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuU3VydmV5c1tzdXJ2ZXlJZF0pO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogR2V0IGFsbCBzdGF0cyBhdmFpbGFibGVcbiAgICAgKi9cbiAgICBTdXJ2ZXlTdGF0Q29sbGVjdGlvbi5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlN1cnZleXM7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5U3RhdENvbGxlY3Rpb247XG59KCkpO1xuZXhwb3J0cy5TdXJ2ZXlTdGF0Q29sbGVjdGlvbiA9IFN1cnZleVN0YXRDb2xsZWN0aW9uO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBJU3VydmV5ID0gcmVxdWlyZShcIi4vQXBpL0lTdXJ2ZXlcIik7XG52YXIgU3VydmV5U3RhdENvbGxlY3Rpb25fMSA9IHJlcXVpcmUoXCIuL1N1cnZleVN0YXRDb2xsZWN0aW9uXCIpO1xudmFyIFV0aWxzID0gcmVxdWlyZShcIi4vVXRpbHNcIik7XG4vKipcbiAqIFN0YXRDb2xsZWN0aW9uIGZvciBhY3RpdmF0ZWQgc3VydmV5cy4gIFNob3VsZCBiZSB1c2VkIHRvIHRyYWNrIHRoZSBTdXJ2ZXlJZHNcbiAqIHRoYXQgaGF2ZSBiZWVuIHJlY2VudGx5IHNob3duIHRvIGEgdXNlclxuICovXG4vLyBUT0RPIChnYWNob2kpIENoZWNrIGlmIHRoaXMgYXBwbGllcyAtIFZTT0J1ZzogMTQ0MzAxMCBPbmUgYmFkIFN0YXQgb2JqZWN0IGZhaWxzIHRoZSBlbnRpcmUgc2VyaWFsaXphdGlvblxudmFyIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3VydmV5U3RhdENvbGxlY3Rpb25BY3RpdmF0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2FkIGZyb20gSnNvblxuICAgICAqL1xuICAgIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbi5mcm9tSnNvbiA9IGZ1bmN0aW9uIChqc29uKSB7XG4gICAgICAgIHZhciBzdGF0Q29sbGVjdGlvbiA9IG5ldyBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb24oKTtcbiAgICAgICAgaWYgKCFqc29uKSB7XG4gICAgICAgICAgICAvLyBUT0RPIChnYWNob2kpIExvZyBudWxsIGpzb24gcGFzc2VkXG4gICAgICAgICAgICByZXR1cm4gc3RhdENvbGxlY3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlYWRTdGF0cztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJlYWRTdGF0cyA9IEpTT04ucGFyc2UoanNvbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIFRPRE8gKGdhY2hvaSkgTG9nIHBhcnNpbmcgZmFpbGVkXG4gICAgICAgICAgICByZXR1cm4gc3RhdENvbGxlY3Rpb247XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdGF0Q29sbGVjdGlvbi5kZXNlcmlhbGl6ZShyZWFkU3RhdHMpKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdGF0Q29sbGVjdGlvbjtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENvbnZlcnQgdG8gSnNvblxuICAgICAqL1xuICAgIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbi50b0pzb24gPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gICAgICAgIGlmICghb2JqZWN0KSB7XG4gICAgICAgICAgICAvLyBUT0RPIChnYWNob2kpIGxvZyB0aGF0IG51bGwgb2JqZWN0IHBhc3NlZFxuICAgICAgICAgICAgb2JqZWN0ID0gbmV3IFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShvYmplY3QpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQWRkIGFub3RoZXIgU3VydmV5U3RhdENvbGxlY3Rpb25BY3RpdmF0aW9uIG9iamVjdFxuICAgICAqL1xuICAgIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbi5wcm90b3R5cGUuYWNjdW11bGF0ZSA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICBpZiAoIW90aGVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YXRzID0gb3RoZXIuZ2V0U3RhdHMoKTtcbiAgICAgICAgLy8gU3VydmV5QWN0aXZhdGlvblN0YXRzIGFjY3VtdWxhdGlvbiBzaW1wbHkgb3ZlcndyaXRlcyBhbnkga2V5cyBmcm9tICdvdGhlcicgaW50byBvdXIgY29sbGVjdGlvblxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gc3RhdHMpIHtcbiAgICAgICAgICAgIGlmIChzdGF0cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRTdGF0cyhrZXksIHN0YXRzW2tleV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBNZXRob2QgdG8gZGVzZXJpYWxpemUgU3VydmV5U3RhdENvbGxlY3Rpb25BY3RpdmF0aW9uXG4gICAgICogQHBhcmFtIGlucHV0OiBjb2xsZWN0aW9uIG9mIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvblxuICAgICAqIFJldHVybnMgcmVzdWx0IG9mIHZhbGlkYXRpb24gY2hlY2tcbiAgICAgKi9cbiAgICBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb24ucHJvdG90eXBlLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHZhciByYXdTdGF0cyA9IGlucHV0LlN1cnZleXM7XG4gICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gcmF3U3RhdHMpIHtcbiAgICAgICAgICAgIGlmIChyYXdTdGF0cy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1N0YXQgPSBuZXcgU3VydmV5QWN0aXZhdGlvblN0YXRzKCk7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1N0YXQuZGVzZXJpYWxpemUocmF3U3RhdHNba2V5XSkgJiYgbmV3U3RhdC5FeHBpcmF0aW9uVGltZVV0YyA+IG5vdykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZFN0YXRzKGtleSwgbmV3U3RhdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZhbGlkYXRlKCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZSB0aGUgU3VydmV5c1xuICAgICAqIFJldHVybnMgZmFsc2UgaWYgdmFsaWRhdGlvbiBmYWlsc1xuICAgICAqL1xuICAgIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbi5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBVdGlscy5pc09iamVjdCh0aGlzLmdldFN0YXRzKCkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVN0YXRDb2xsZWN0aW9uQWN0aXZhdGlvbjtcbn0oU3VydmV5U3RhdENvbGxlY3Rpb25fMS5TdXJ2ZXlTdGF0Q29sbGVjdGlvbikpO1xuZXhwb3J0cy5TdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb24gPSBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkFjdGl2YXRpb247XG52YXIgU3VydmV5QWN0aXZhdGlvblN0YXRzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFN1cnZleUFjdGl2YXRpb25TdGF0cygpIHtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRvIGRlc2VyaWFsaXplIGEgSlNPTiBvYmplY3QgdG8gY2xhc3Mgb2JqZWN0XG4gICAgICogQHBhcmFtIGlucHV0OiBKU09OIG9iamVjdFxuICAgICAqIFJldHVybnMgcmVzdWx0IG9mIHZhbGlkYXRpb24gY2hlY2tcbiAgICAgKi9cbiAgICBTdXJ2ZXlBY3RpdmF0aW9uU3RhdHMucHJvdG90eXBlLmRlc2VyaWFsaXplID0gZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgICAgIHRoaXMuQWN0aXZhdGlvblRpbWVVdGMgPSBpbnB1dC5BY3RpdmF0aW9uVGltZVV0YztcbiAgICAgICAgdGhpcy5FeHBpcmF0aW9uVGltZVV0YyA9IGlucHV0LkV4cGlyYXRpb25UaW1lVXRjO1xuICAgICAgICB0aGlzLlR5cGUgPSBpbnB1dC5UeXBlO1xuICAgICAgICByZXR1cm4gdGhpcy52YWxpZGF0ZSgpO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogTWV0aG9kIHRvIGNhbGwgYWZ0ZXIgZGVzZXJpYWxpemF0aW9uIHRvIHZhbGlkYXRlIGdlbmVyYXRlZCBvYmplY3QuXG4gICAgICogUmV0dXJucyBmYWxzZSBpZiBub3QgdmFsaWQuXG4gICAgICovXG4gICAgU3VydmV5QWN0aXZhdGlvblN0YXRzLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gbWFrZSBpdCBhIGRhdGUgb2JqZWN0IGlmIGl0J3MgYSB2YWxpZCBVVEMgZGF0ZSB0aW1lIHZhbHVlXG4gICAgICAgIGlmIChVdGlscy5pc1V0Y0RhdGV0aW1lU3RyaW5nKHRoaXMuQWN0aXZhdGlvblRpbWVVdGMpKSB7XG4gICAgICAgICAgICB0aGlzLkFjdGl2YXRpb25UaW1lVXRjID0gVXRpbHMuc3RyaW5nVG9EYXRlKHRoaXMuQWN0aXZhdGlvblRpbWVVdGMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIC8vIG1ha2UgaXQgYSBkYXRlIG9iamVjdCBpZiBpdCdzIGEgdmFsaWQgVVRDIGRhdGUgdGltZSB2YWx1ZVxuICAgICAgICBpZiAoVXRpbHMuaXNVdGNEYXRldGltZVN0cmluZyh0aGlzLkV4cGlyYXRpb25UaW1lVXRjKSkge1xuICAgICAgICAgICAgdGhpcy5FeHBpcmF0aW9uVGltZVV0YyA9IFV0aWxzLnN0cmluZ1RvRGF0ZSh0aGlzLkV4cGlyYXRpb25UaW1lVXRjKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gVXRpbHMuaXNFbnVtVmFsdWUodGhpcy5UeXBlLCBJU3VydmV5LlR5cGUpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleUFjdGl2YXRpb25TdGF0cztcbn0oKSk7XG5leHBvcnRzLlN1cnZleUFjdGl2YXRpb25TdGF0cyA9IFN1cnZleUFjdGl2YXRpb25TdGF0cztcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgU3VydmV5U3RhdENvbGxlY3Rpb25fMSA9IHJlcXVpcmUoXCIuL1N1cnZleVN0YXRDb2xsZWN0aW9uXCIpO1xudmFyIFV0aWxzID0gcmVxdWlyZShcIi4vVXRpbHNcIik7XG4vKipcbiAqIFN0YXRDb2xsZWN0aW9uIGZvciBFdmVudEFjdGl2aXR5IGNvdW50cy4gIFNob3VsZCBiZSB1c2VkIHRvIHN0b3JlL21lcmdlXG4gKiBhZ2dyZWdhdGUgdmFsdWVzIGJldHdlZW4gc2Vzc2lvbnMgdHJhY2tpbmcgdGhlIHNhbWUgc3VydmV5cy9ldmVudHNcbiAqIEUuZy4gQSBzdXJ2ZXkgdGhhdCBhY3RpdmF0ZXMgYWZ0ZXIgMyBib290cy5cbiAqL1xuLy8gVE9ETyAoZ2FjaG9pKSBjaGVjayB0aGUgZm9sbG93aW5nIC0gVlNPQnVnOiAxNDQzMDEwIE9uZSBiYWQgU3RhdCBvYmplY3QgZmFpbHMgdGhlIGVudGlyZSBzZXJpYWxpemF0aW9uXG52YXIgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdXJ2ZXlTdGF0Q29sbGVjdGlvbkV2ZW50QWN0aXZpdHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvYWQgZnJvbSBKc29uXG4gICAgICovXG4gICAgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LmZyb21Kc29uID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICAgICAgdmFyIHN0YXRDb2xsZWN0aW9uID0gbmV3IFN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eSgpO1xuICAgICAgICBpZiAoIWpzb24pIHtcbiAgICAgICAgICAgIC8vIFRPRE8gKGdhY2hvaSkgTG9nIG51bGwganNvbiBwYXNzZWRcbiAgICAgICAgICAgIHJldHVybiBzdGF0Q29sbGVjdGlvbjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVhZFN0YXRzO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmVhZFN0YXRzID0gSlNPTi5wYXJzZShqc29uKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gVE9ETyAoZ2FjaG9pKSBMb2cgcGFyc2luZyBmYWlsZWRcbiAgICAgICAgICAgIHJldHVybiBzdGF0Q29sbGVjdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0YXRDb2xsZWN0aW9uLmRlc2VyaWFsaXplKHJlYWRTdGF0cykpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0YXRDb2xsZWN0aW9uO1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29udmVydCB0byBKc29uXG4gICAgICovXG4gICAgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LnRvSnNvbiA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgaWYgKCFvYmplY3QpIHtcbiAgICAgICAgICAgIC8vIFRPRE8gKGdhY2hvaSkgbG9nIHRoYXQgbnVsbCBvYmplY3QgcGFzc2VkXG4gICAgICAgICAgICBvYmplY3QgPSBuZXcgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iamVjdCk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBZGQgYW5vdGhlciBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkV2ZW50QWN0aXZpdHkgb2JqZWN0XG4gICAgICovXG4gICAgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LnByb3RvdHlwZS5hY2N1bXVsYXRlID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIGlmICghb3RoZXIpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3RhdHMgPSBvdGhlci5nZXRTdGF0cygpO1xuICAgICAgICAvLyBTdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMgYWNjdW11bGF0aW9uIHNpbXBseSBvdmVyd3JpdGVzIGFueSBrZXlzIGZyb20gJ290aGVyJyBpbnRvIG91ciBjb2xsZWN0aW9uXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBzdGF0cykge1xuICAgICAgICAgICAgaWYgKHN0YXRzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3VyU3RhdHMgPSB0aGlzLmdldEJ5U3VydmV5SWQoa2V5KTtcbiAgICAgICAgICAgICAgICAvLyBJZiBpdCBkb2VzIG5vdCBhbHJlYWR5IGV4aXN0XG4gICAgICAgICAgICAgICAgaWYgKCFvdXJTdGF0cykge1xuICAgICAgICAgICAgICAgICAgICBvdXJTdGF0cyA9IG5ldyBTdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgb3VyU3RhdHMuQ291bnRzID0gW107XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkU3RhdHMoa2V5LCBvdXJTdGF0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG91clN0YXRzLkV4cGlyYXRpb25UaW1lVXRjID0gc3RhdHNba2V5XS5FeHBpcmF0aW9uVGltZVV0YztcbiAgICAgICAgICAgICAgICAvLyBJZiBmb3Igc29tZSByZWFzb24gdGhlIG90aGVyIGNvdW50cyBhcnJheSBpcyBsYXJnZXIsIHJlc2l6ZSBvdXJTdGF0cy5jb3VudHNcbiAgICAgICAgICAgICAgICBpZiAob3VyU3RhdHMuQ291bnRzLmxlbmd0aCA8IHN0YXRzW2tleV0uQ291bnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzaXplZENvdW50cyA9IG91clN0YXRzLkNvdW50cy5zbGljZSgpO1xuICAgICAgICAgICAgICAgICAgICBvdXJTdGF0cy5Db3VudHMgPSByZXNpemVkQ291bnRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0YXRzW2tleV0uQ291bnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghb3VyU3RhdHMuQ291bnRzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXJTdGF0cy5Db3VudHNbaV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG91clN0YXRzLkNvdW50c1tpXSArPSBzdGF0c1trZXldLkNvdW50c1tpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBkZXNlcmlhbGl6ZSBTdXJ2ZXlTdGF0Q29sbGVjdGlvbkV2ZW50QWN0aXZpdHlcbiAgICAgKiBAcGFyYW0gaW5wdXQ6IGNvbGxlY3Rpb24gb2YgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5XG4gICAgICogUmV0dXJucyByZXN1bHQgb2YgdmFsaWRhdGlvbiBjaGVja1xuICAgICAqL1xuICAgIFN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eS5wcm90b3R5cGUuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdmFyIHJhd1N0YXRzID0gaW5wdXQuU3VydmV5cztcbiAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiByYXdTdGF0cykge1xuICAgICAgICAgICAgaWYgKHJhd1N0YXRzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3U3RhdCA9IG5ldyBTdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMoKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3U3RhdC5kZXNlcmlhbGl6ZShyYXdTdGF0c1trZXldKSAmJiBuZXdTdGF0LkV4cGlyYXRpb25UaW1lVXRjID4gbm93KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkU3RhdHMoa2V5LCBuZXdTdGF0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlIHRoZSBTdXJ2ZXlzXG4gICAgICogUmV0dXJucyBmYWxzZSBpZiB2YWxpZGF0aW9uIGZhaWxzXG4gICAgICovXG4gICAgU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5LnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFV0aWxzLmlzT2JqZWN0KHRoaXMuZ2V0U3RhdHMoKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5U3RhdENvbGxlY3Rpb25FdmVudEFjdGl2aXR5O1xufShTdXJ2ZXlTdGF0Q29sbGVjdGlvbl8xLlN1cnZleVN0YXRDb2xsZWN0aW9uKSk7XG5leHBvcnRzLlN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eSA9IFN1cnZleVN0YXRDb2xsZWN0aW9uRXZlbnRBY3Rpdml0eTtcbnZhciBTdXJ2ZXlFdmVudEFjdGl2aXR5U3RhdHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzKCkge1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIG9iamVjdCB0byBjbGFzcyBvYmplY3RcbiAgICAgKiBAcGFyYW0gaW5wdXQ6IEpTT04gb2JqZWN0XG4gICAgICogUmV0dXJucyByZXN1bHQgb2YgdmFsaWRhdGlvbiBjaGVja1xuICAgICAqL1xuICAgIFN1cnZleUV2ZW50QWN0aXZpdHlTdGF0cy5wcm90b3R5cGUuZGVzZXJpYWxpemUgPSBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgdGhpcy5FeHBpcmF0aW9uVGltZVV0YyA9IGlucHV0LkV4cGlyYXRpb25UaW1lVXRjO1xuICAgICAgICB0aGlzLkNvdW50cyA9IGlucHV0LkNvdW50cztcbiAgICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGUoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIE1ldGhvZCB0byBjYWxsIGFmdGVyIGRlc2VyaWFsaXphdGlvbiB0byB2YWxpZGF0ZSBnZW5lcmF0ZWQgb2JqZWN0LlxuICAgICAqIFJldHVybnMgZmFsc2UgaWYgbm90IHZhbGlkLlxuICAgICAqL1xuICAgIFN1cnZleUV2ZW50QWN0aXZpdHlTdGF0cy5wcm90b3R5cGUudmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5Db3VudHMpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuQ291bnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gdGhpcy5Db3VudHNbaV07XG4gICAgICAgICAgICBpZiAoIVV0aWxzLmlzTnVtYmVyKHZhbCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsIDwgMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuQ291bnRzW2ldID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBtYWtlIGl0IGEgZGF0ZSBvYmplY3QgaWYgaXQncyBhIHZhbGlkIFVUQyBkYXRlIHRpbWUgdmFsdWVcbiAgICAgICAgaWYgKFV0aWxzLmlzVXRjRGF0ZXRpbWVTdHJpbmcodGhpcy5FeHBpcmF0aW9uVGltZVV0YykpIHtcbiAgICAgICAgICAgIHRoaXMuRXhwaXJhdGlvblRpbWVVdGMgPSBVdGlscy5zdHJpbmdUb0RhdGUodGhpcy5FeHBpcmF0aW9uVGltZVV0Yyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzO1xufSgpKTtcbmV4cG9ydHMuU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzID0gU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgSVN1cnZleSA9IHJlcXVpcmUoXCIuLi9BcGkvSVN1cnZleVwiKTtcbnZhciBJU3VydmV5Q29tcG9uZW50ID0gcmVxdWlyZShcIi4uL0FwaS9JU3VydmV5Q29tcG9uZW50XCIpO1xudmFyIENvbW1lbnRDb21wb25lbnQgPSByZXF1aXJlKFwiLi4vU3VydmV5Q29tcG9uZW50cy9Db21tZW50Q29tcG9uZW50XCIpO1xudmFyIFByb21wdENvbXBvbmVudCA9IHJlcXVpcmUoXCIuLi9TdXJ2ZXlDb21wb25lbnRzL1Byb21wdENvbXBvbmVudFwiKTtcbnZhciBSYXRpbmdDb21wb25lbnQgPSByZXF1aXJlKFwiLi4vU3VydmV5Q29tcG9uZW50cy9SYXRpbmdDb21wb25lbnRcIik7XG52YXIgVXRpbHMgPSByZXF1aXJlKFwiLi4vVXRpbHNcIik7XG52YXIgU3VydmV5RGF0YVNvdXJjZSA9IHJlcXVpcmUoXCIuL1N1cnZleURhdGFTb3VyY2VcIik7XG52YXIgRnBzU3VydmV5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZwc1N1cnZleShkYXRhKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkYXRhKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YSBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3VydmV5SW5mbyA9IG5ldyBTdXJ2ZXlEYXRhU291cmNlKGRhdGEuYmFzZURhdGEpO1xuICAgICAgICB0aGlzLnByb21wdCA9IG5ldyBQcm9tcHRDb21wb25lbnQoZGF0YS5wcm9tcHREYXRhKTtcbiAgICAgICAgdGhpcy5xdWVzdGlvbiA9IG5ldyBDb21tZW50Q29tcG9uZW50KGRhdGEuY29tbWVudERhdGEpO1xuICAgICAgICB0aGlzLnJhdGluZyA9IG5ldyBSYXRpbmdDb21wb25lbnQoZGF0YS5yYXRpbmdEYXRhKTtcbiAgICB9XG4gICAgRnBzU3VydmV5Lm1ha2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBGcHNTdXJ2ZXkoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcHNTdXJ2ZXkubWFrZUZwcyA9IGZ1bmN0aW9uIChiYXNlRGF0YSwgc3AsIHN1cnZleU1vZGVsKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChiYXNlRGF0YSkgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoc3ApIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHN1cnZleU1vZGVsKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJhdGluZ1ZhbHVlc0FzY2VuZGluZyA9IFtdO1xuICAgICAgICB2YXIgY29udGVudCA9IHN1cnZleU1vZGVsLmNvbnRlbnQ7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50KSB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50LmNvbW1lbnQpXG4gICAgICAgICAgICB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50LnByb21wdCkgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY29udGVudC5yYXRpbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IG5ldyBGcHNTdXJ2ZXkuRnBzU3VydmV5RGF0YSgpO1xuICAgICAgICBkYXRhLmJhc2VEYXRhID0gYmFzZURhdGE7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YSA9IG5ldyBQcm9tcHRDb21wb25lbnQuUHJvbXB0Q29tcG9uZW50RGF0YSgpO1xuICAgICAgICBkYXRhLnJhdGluZ0RhdGEgPSBuZXcgUmF0aW5nQ29tcG9uZW50LlJhdGluZ0NvbXBvbmVudERhdGEoKTtcbiAgICAgICAgZGF0YS5jb21tZW50RGF0YSA9IG5ldyBDb21tZW50Q29tcG9uZW50LkNvbW1lbnRDb21wb25lbnREYXRhKCk7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS50aXRsZSA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LnByb21wdC50aXRsZSk7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS5xdWVzdGlvbiA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LnByb21wdC5xdWVzdGlvbik7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS55ZXNCdXR0b25MYWJlbCA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LnByb21wdC55ZXNMYWJlbCk7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS5ub0J1dHRvbkxhYmVsID0gc3AuZ2V0Q3VzdG9tU3RyaW5nKGNvbnRlbnQucHJvbXB0Lm5vTGFiZWwpO1xuICAgICAgICBkYXRhLnJhdGluZ0RhdGEucXVlc3Rpb24gPSBzcC5nZXRDdXN0b21TdHJpbmcoY29udGVudC5yYXRpbmcucXVlc3Rpb24pO1xuICAgICAgICBkYXRhLnJhdGluZ0RhdGEuaXNaZXJvQmFzZWQgPSBjb250ZW50LnJhdGluZy5pc1plcm9CYXNlZDtcbiAgICAgICAgZGF0YS5jb21tZW50RGF0YS5xdWVzdGlvbiA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LmNvbW1lbnQucXVlc3Rpb24pO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29udGVudC5yYXRpbmcucmF0aW5nVmFsdWVzQXNjZW5kaW5nOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gX2FbX2ldO1xuICAgICAgICAgICAgdmFyIGN1c3RvbVN0cmluZyA9IHNwLmdldEN1c3RvbVN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY3VzdG9tU3RyaW5nKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nLnB1c2goY3VzdG9tU3RyaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBkYXRhLnJhdGluZ0RhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nID0gcmF0aW5nVmFsdWVzQXNjZW5kaW5nO1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5yYXRpbmdEYXRhLnF1ZXN0aW9uKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5jb21tZW50RGF0YS5xdWVzdGlvbilcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS50aXRsZSlcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS5xdWVzdGlvbilcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS55ZXNCdXR0b25MYWJlbClcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS5ub0J1dHRvbkxhYmVsKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5yYXRpbmdEYXRhLnJhdGluZ1ZhbHVlc0FzY2VuZGluZykpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm1ha2UoZGF0YSk7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBGcHNTdXJ2ZXkucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBJU3VydmV5LlR5cGUuRnBzO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRnBzU3VydmV5LnByb3RvdHlwZS5nZXRTdXJ2ZXlJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdXJ2ZXlJbmZvO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRnBzU3VydmV5LnByb3RvdHlwZS5nZXRDb21tZW50Q29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbjtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIEZwc1N1cnZleS5wcm90b3R5cGUuZ2V0UHJvbXB0Q29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9tcHQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBGcHNTdXJ2ZXkucHJvdG90eXBlLmdldFJhdGluZ0NvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmF0aW5nO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRnBzU3VydmV5LnByb3RvdHlwZS5nZXRDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50VHlwZSkge1xuICAgICAgICBzd2l0Y2ggKGNvbXBvbmVudFR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgSVN1cnZleUNvbXBvbmVudC5UeXBlLkNvbW1lbnQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29tbWVudENvbXBvbmVudCgpO1xuICAgICAgICAgICAgY2FzZSBJU3VydmV5Q29tcG9uZW50LlR5cGUuUHJvbXB0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFByb21wdENvbXBvbmVudCgpO1xuICAgICAgICAgICAgY2FzZSBJU3VydmV5Q29tcG9uZW50LlR5cGUuUmF0aW5nOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJhdGluZ0NvbXBvbmVudCgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgRnBzU3VydmV5LnByb3RvdHlwZS5nZXREb21FbGVtZW50cyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRvYykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudChJU3VydmV5LkRPTV9GUFNfVEFHTkFNRSk7XG4gICAgICAgIHRoaXMuZ2V0U3VydmV5SW5mbygpLmdldERvbUVsZW1lbnRzKGRvYykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGlmICghVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldENvbW1lbnRDb21wb25lbnQoKS5nZXREb21FbGVtZW50cyhkb2MpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBpZiAoIVV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nZXRSYXRpbmdDb21wb25lbnQoKS5nZXREb21FbGVtZW50cyhkb2MpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICBpZiAoIVV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFtlbGVtZW50XTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIEZwc1N1cnZleS5wcm90b3R5cGUuZ2V0SnNvbkVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdCA9IFV0aWxzLm92ZXJyaWRlVmFsdWVzKHRoaXMuZ2V0U3VydmV5SW5mbygpLmdldEpzb25FbGVtZW50cygpLCByZXN1bHQpO1xuICAgICAgICByZXN1bHQgPSBVdGlscy5vdmVycmlkZVZhbHVlcyh0aGlzLmdldENvbW1lbnRDb21wb25lbnQoKS5nZXRKc29uRWxlbWVudHMoKSwgcmVzdWx0KTtcbiAgICAgICAgcmVzdWx0ID0gVXRpbHMub3ZlcnJpZGVWYWx1ZXModGhpcy5nZXRSYXRpbmdDb21wb25lbnQoKS5nZXRKc29uRWxlbWVudHMoKSwgcmVzdWx0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBGcHNTdXJ2ZXk7XG59KCkpO1xuKGZ1bmN0aW9uIChGcHNTdXJ2ZXkpIHtcbiAgICAvKipcbiAgICAgKiBEYXRhIHJlcXVpcmVkIGZvciBhIEZwcyBTdXJ2ZXlcbiAgICAgKi9cbiAgICB2YXIgRnBzU3VydmV5RGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gRnBzU3VydmV5RGF0YSgpIHtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRnBzU3VydmV5RGF0YTtcbiAgICB9KCkpO1xuICAgIEZwc1N1cnZleS5GcHNTdXJ2ZXlEYXRhID0gRnBzU3VydmV5RGF0YTtcbn0pKEZwc1N1cnZleSB8fCAoRnBzU3VydmV5ID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gRnBzU3VydmV5O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgSVN1cnZleSA9IHJlcXVpcmUoXCIuLi9BcGkvSVN1cnZleVwiKTtcbnZhciBJU3VydmV5Q29tcG9uZW50ID0gcmVxdWlyZShcIi4uL0FwaS9JU3VydmV5Q29tcG9uZW50XCIpO1xudmFyIENvbW1lbnRDb21wb25lbnQgPSByZXF1aXJlKFwiLi4vU3VydmV5Q29tcG9uZW50cy9Db21tZW50Q29tcG9uZW50XCIpO1xudmFyIFByb21wdENvbXBvbmVudCA9IHJlcXVpcmUoXCIuLi9TdXJ2ZXlDb21wb25lbnRzL1Byb21wdENvbXBvbmVudFwiKTtcbnZhciBSYXRpbmdDb21wb25lbnQgPSByZXF1aXJlKFwiLi4vU3VydmV5Q29tcG9uZW50cy9SYXRpbmdDb21wb25lbnRcIik7XG52YXIgVXRpbHMgPSByZXF1aXJlKFwiLi4vVXRpbHNcIik7XG52YXIgU3VydmV5RGF0YVNvdXJjZSA9IHJlcXVpcmUoXCIuL1N1cnZleURhdGFTb3VyY2VcIik7XG52YXIgTmxxc1N1cnZleSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBObHFzU3VydmV5KGRhdGEpIHtcbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkYXRhIG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdXJ2ZXlJbmZvID0gbmV3IFN1cnZleURhdGFTb3VyY2UoZGF0YS5iYXNlRGF0YSk7XG4gICAgICAgIHRoaXMucHJvbXB0ID0gbmV3IFByb21wdENvbXBvbmVudChkYXRhLnByb21wdERhdGEpO1xuICAgICAgICB0aGlzLnF1ZXN0aW9uID0gbmV3IENvbW1lbnRDb21wb25lbnQoZGF0YS5jb21tZW50RGF0YSk7XG4gICAgICAgIHRoaXMucmF0aW5nID0gbmV3IFJhdGluZ0NvbXBvbmVudChkYXRhLnJhdGluZ0RhdGEpO1xuICAgIH1cbiAgICBObHFzU3VydmV5Lm1ha2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBObHFzU3VydmV5KGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTmxxc1N1cnZleS5tYWtlTmxxcyA9IGZ1bmN0aW9uIChiYXNlRGF0YSwgc3AsIHN1cnZleU1vZGVsKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChiYXNlRGF0YSkgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoc3ApIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHN1cnZleU1vZGVsKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJhdGluZ1ZhbHVlc0FzY2VuZGluZyA9IFtdO1xuICAgICAgICB2YXIgY29udGVudCA9IHN1cnZleU1vZGVsLmNvbnRlbnQ7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50KSB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50LmNvbW1lbnQpXG4gICAgICAgICAgICB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50LnByb21wdCkgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY29udGVudC5yYXRpbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IG5ldyBObHFzU3VydmV5Lk5scXNTdXJ2ZXlEYXRhKCk7XG4gICAgICAgIGRhdGEuYmFzZURhdGEgPSBiYXNlRGF0YTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhID0gbmV3IFByb21wdENvbXBvbmVudC5Qcm9tcHRDb21wb25lbnREYXRhKCk7XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YSA9IG5ldyBSYXRpbmdDb21wb25lbnQuUmF0aW5nQ29tcG9uZW50RGF0YSgpO1xuICAgICAgICBkYXRhLmNvbW1lbnREYXRhID0gbmV3IENvbW1lbnRDb21wb25lbnQuQ29tbWVudENvbXBvbmVudERhdGEoKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnRpdGxlID0gc3AuZ2V0Q3VzdG9tU3RyaW5nKGNvbnRlbnQucHJvbXB0LnRpdGxlKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnF1ZXN0aW9uID0gc3AuZ2V0Q3VzdG9tU3RyaW5nKGNvbnRlbnQucHJvbXB0LnF1ZXN0aW9uKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnllc0J1dHRvbkxhYmVsID0gc3AuZ2V0Q3VzdG9tU3RyaW5nKGNvbnRlbnQucHJvbXB0Lnllc0xhYmVsKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLm5vQnV0dG9uTGFiZWwgPSBzcC5nZXRDdXN0b21TdHJpbmcoY29udGVudC5wcm9tcHQubm9MYWJlbCk7XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5xdWVzdGlvbiA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LnJhdGluZy5xdWVzdGlvbik7XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5pc1plcm9CYXNlZCA9IGNvbnRlbnQucmF0aW5nLmlzWmVyb0Jhc2VkO1xuICAgICAgICBkYXRhLmNvbW1lbnREYXRhLnF1ZXN0aW9uID0gc3AuZ2V0Q3VzdG9tU3RyaW5nKGNvbnRlbnQuY29tbWVudC5xdWVzdGlvbik7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBjb250ZW50LnJhdGluZy5yYXRpbmdWYWx1ZXNBc2NlbmRpbmc7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBfYVtfaV07XG4gICAgICAgICAgICB2YXIgY3VzdG9tU3RyaW5nID0gc3AuZ2V0Q3VzdG9tU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChjdXN0b21TdHJpbmcpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByYXRpbmdWYWx1ZXNBc2NlbmRpbmcucHVzaChjdXN0b21TdHJpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5yYXRpbmdWYWx1ZXNBc2NlbmRpbmcgPSByYXRpbmdWYWx1ZXNBc2NlbmRpbmc7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkYXRhLnJhdGluZ0RhdGEucXVlc3Rpb24pXG4gICAgICAgICAgICB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChkYXRhLmNvbW1lbnREYXRhLnF1ZXN0aW9uKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5wcm9tcHREYXRhLnRpdGxlKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5wcm9tcHREYXRhLnF1ZXN0aW9uKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5wcm9tcHREYXRhLnllc0J1dHRvbkxhYmVsKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5wcm9tcHREYXRhLm5vQnV0dG9uTGFiZWwpXG4gICAgICAgICAgICB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChkYXRhLnJhdGluZ0RhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubWFrZShkYXRhKTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIE5scXNTdXJ2ZXkucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBJU3VydmV5LlR5cGUuTmxxcztcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIE5scXNTdXJ2ZXkucHJvdG90eXBlLmdldFN1cnZleUluZm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1cnZleUluZm87XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBObHFzU3VydmV5LnByb3RvdHlwZS5nZXRDb21tZW50Q29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbjtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIE5scXNTdXJ2ZXkucHJvdG90eXBlLmdldFByb21wdENvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbXB0O1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgTmxxc1N1cnZleS5wcm90b3R5cGUuZ2V0UmF0aW5nQ29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yYXRpbmc7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBObHFzU3VydmV5LnByb3RvdHlwZS5nZXRDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50VHlwZSkge1xuICAgICAgICBzd2l0Y2ggKGNvbXBvbmVudFR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgSVN1cnZleUNvbXBvbmVudC5UeXBlLkNvbW1lbnQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29tbWVudENvbXBvbmVudCgpO1xuICAgICAgICAgICAgY2FzZSBJU3VydmV5Q29tcG9uZW50LlR5cGUuUHJvbXB0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFByb21wdENvbXBvbmVudCgpO1xuICAgICAgICAgICAgY2FzZSBJU3VydmV5Q29tcG9uZW50LlR5cGUuUmF0aW5nOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJhdGluZ0NvbXBvbmVudCgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgTmxxc1N1cnZleS5wcm90b3R5cGUuZ2V0RG9tRWxlbWVudHMgPSBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkb2MpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJEb2N1bWVudCBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbGVtZW50ID0gZG9jLmNyZWF0ZUVsZW1lbnQoSVN1cnZleS5ET01fTkxRU19UQUdOQU1FKTtcbiAgICAgICAgdGhpcy5nZXRTdXJ2ZXlJbmZvKCkuZ2V0RG9tRWxlbWVudHMoZG9jKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgaWYgKCFVdGlscy5pc051bGxPclVuZGVmaW5lZChjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGNoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ2V0Q29tbWVudENvbXBvbmVudCgpLmdldERvbUVsZW1lbnRzKGRvYykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGlmICghVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldFJhdGluZ0NvbXBvbmVudCgpLmdldERvbUVsZW1lbnRzKGRvYykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGlmICghVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gW2VsZW1lbnRdO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgTmxxc1N1cnZleS5wcm90b3R5cGUuZ2V0SnNvbkVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdCA9IFV0aWxzLm92ZXJyaWRlVmFsdWVzKHRoaXMuZ2V0U3VydmV5SW5mbygpLmdldEpzb25FbGVtZW50cygpLCByZXN1bHQpO1xuICAgICAgICByZXN1bHQgPSBVdGlscy5vdmVycmlkZVZhbHVlcyh0aGlzLmdldENvbW1lbnRDb21wb25lbnQoKS5nZXRKc29uRWxlbWVudHMoKSwgcmVzdWx0KTtcbiAgICAgICAgcmVzdWx0ID0gVXRpbHMub3ZlcnJpZGVWYWx1ZXModGhpcy5nZXRSYXRpbmdDb21wb25lbnQoKS5nZXRKc29uRWxlbWVudHMoKSwgcmVzdWx0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBObHFzU3VydmV5O1xufSgpKTtcbihmdW5jdGlvbiAoTmxxc1N1cnZleSkge1xuICAgIC8qKlxuICAgICAqIERhdGEgcmVxdWlyZWQgZm9yIGEgTmxxcyBTdXJ2ZXlcbiAgICAgKi9cbiAgICB2YXIgTmxxc1N1cnZleURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIE5scXNTdXJ2ZXlEYXRhKCkge1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBObHFzU3VydmV5RGF0YTtcbiAgICB9KCkpO1xuICAgIE5scXNTdXJ2ZXkuTmxxc1N1cnZleURhdGEgPSBObHFzU3VydmV5RGF0YTtcbn0pKE5scXNTdXJ2ZXkgfHwgKE5scXNTdXJ2ZXkgPSB7fSkpO1xubW9kdWxlLmV4cG9ydHMgPSBObHFzU3VydmV5O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyID0gcmVxdWlyZShcIi4uL0FwaS9JRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXJcIik7XG52YXIgSVN1cnZleSA9IHJlcXVpcmUoXCIuLi9BcGkvSVN1cnZleVwiKTtcbnZhciBJU3VydmV5Q29tcG9uZW50ID0gcmVxdWlyZShcIi4uL0FwaS9JU3VydmV5Q29tcG9uZW50XCIpO1xudmFyIENvbW1lbnRDb21wb25lbnQgPSByZXF1aXJlKFwiLi4vU3VydmV5Q29tcG9uZW50cy9Db21tZW50Q29tcG9uZW50XCIpO1xudmFyIFByb21wdENvbXBvbmVudCA9IHJlcXVpcmUoXCIuLi9TdXJ2ZXlDb21wb25lbnRzL1Byb21wdENvbXBvbmVudFwiKTtcbnZhciBSYXRpbmdDb21wb25lbnQgPSByZXF1aXJlKFwiLi4vU3VydmV5Q29tcG9uZW50cy9SYXRpbmdDb21wb25lbnRcIik7XG52YXIgVXRpbHMgPSByZXF1aXJlKFwiLi4vVXRpbHNcIik7XG52YXIgU3VydmV5RGF0YVNvdXJjZSA9IHJlcXVpcmUoXCIuL1N1cnZleURhdGFTb3VyY2VcIik7XG52YXIgTnBzU3VydmV5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE5wc1N1cnZleShkYXRhKSB7XG4gICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YSBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3VydmV5SW5mbyA9IG5ldyBTdXJ2ZXlEYXRhU291cmNlKGRhdGEuYmFzZURhdGEpO1xuICAgICAgICB0aGlzLnByb21wdCA9IG5ldyBQcm9tcHRDb21wb25lbnQoZGF0YS5wcm9tcHREYXRhKTtcbiAgICAgICAgdGhpcy5xdWVzdGlvbiA9IG5ldyBDb21tZW50Q29tcG9uZW50KGRhdGEuY29tbWVudERhdGEpO1xuICAgICAgICB0aGlzLnJhdGluZyA9IG5ldyBSYXRpbmdDb21wb25lbnQoZGF0YS5yYXRpbmdEYXRhKTtcbiAgICB9XG4gICAgTnBzU3VydmV5Lm1ha2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOcHNTdXJ2ZXkoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBOcHNTdXJ2ZXkubWFrZUN1c3RvbSA9IGZ1bmN0aW9uIChiYXNlRGF0YSwgc3AsIHN1cnZleU1vZGVsKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChiYXNlRGF0YSkgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoc3ApIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHN1cnZleU1vZGVsKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJhdGluZ1ZhbHVlc0FzY2VuZGluZyA9IFtdO1xuICAgICAgICB2YXIgY29udGVudCA9IHN1cnZleU1vZGVsLmNvbnRlbnQ7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50KSB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50LmNvbW1lbnQpXG4gICAgICAgICAgICB8fCBVdGlscy5pc051bGxPclVuZGVmaW5lZChjb250ZW50LnByb21wdCkgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY29udGVudC5yYXRpbmcpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IG5ldyBOcHNTdXJ2ZXkuTnBzU3VydmV5RGF0YSgpO1xuICAgICAgICBkYXRhLmJhc2VEYXRhID0gYmFzZURhdGE7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YSA9IG5ldyBQcm9tcHRDb21wb25lbnQuUHJvbXB0Q29tcG9uZW50RGF0YSgpO1xuICAgICAgICBkYXRhLnJhdGluZ0RhdGEgPSBuZXcgUmF0aW5nQ29tcG9uZW50LlJhdGluZ0NvbXBvbmVudERhdGEoKTtcbiAgICAgICAgZGF0YS5jb21tZW50RGF0YSA9IG5ldyBDb21tZW50Q29tcG9uZW50LkNvbW1lbnRDb21wb25lbnREYXRhKCk7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS50aXRsZSA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LnByb21wdC50aXRsZSk7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS5xdWVzdGlvbiA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LnByb21wdC5xdWVzdGlvbik7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS55ZXNCdXR0b25MYWJlbCA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LnByb21wdC55ZXNMYWJlbCk7XG4gICAgICAgIGRhdGEucHJvbXB0RGF0YS5ub0J1dHRvbkxhYmVsID0gc3AuZ2V0Q3VzdG9tU3RyaW5nKGNvbnRlbnQucHJvbXB0Lm5vTGFiZWwpO1xuICAgICAgICBkYXRhLnJhdGluZ0RhdGEucXVlc3Rpb24gPSBzcC5nZXRDdXN0b21TdHJpbmcoY29udGVudC5yYXRpbmcucXVlc3Rpb24pO1xuICAgICAgICBkYXRhLnJhdGluZ0RhdGEuaXNaZXJvQmFzZWQgPSBjb250ZW50LnJhdGluZy5pc1plcm9CYXNlZDtcbiAgICAgICAgZGF0YS5jb21tZW50RGF0YS5xdWVzdGlvbiA9IHNwLmdldEN1c3RvbVN0cmluZyhjb250ZW50LmNvbW1lbnQucXVlc3Rpb24pO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29udGVudC5yYXRpbmcucmF0aW5nVmFsdWVzQXNjZW5kaW5nOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gX2FbX2ldO1xuICAgICAgICAgICAgdmFyIGN1c3RvbVN0cmluZyA9IHNwLmdldEN1c3RvbVN0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoY3VzdG9tU3RyaW5nKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nLnB1c2goY3VzdG9tU3RyaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBkYXRhLnJhdGluZ0RhdGEucmF0aW5nVmFsdWVzQXNjZW5kaW5nID0gcmF0aW5nVmFsdWVzQXNjZW5kaW5nO1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5yYXRpbmdEYXRhLnF1ZXN0aW9uKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5jb21tZW50RGF0YS5xdWVzdGlvbilcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS50aXRsZSlcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS5xdWVzdGlvbilcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS55ZXNCdXR0b25MYWJlbClcbiAgICAgICAgICAgIHx8IFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEucHJvbXB0RGF0YS5ub0J1dHRvbkxhYmVsKVxuICAgICAgICAgICAgfHwgVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5yYXRpbmdEYXRhLnJhdGluZ1ZhbHVlc0FzY2VuZGluZykpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm1ha2UoZGF0YSk7XG4gICAgfTtcbiAgICBOcHNTdXJ2ZXkubWFrZTVQb2ludCA9IGZ1bmN0aW9uIChiYXNlRGF0YSwgc3ApIHtcbiAgICAgICAgaWYgKCFiYXNlRGF0YSB8fCAhc3ApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRhID0gbmV3IE5wc1N1cnZleS5OcHNTdXJ2ZXlEYXRhKCk7XG4gICAgICAgIGRhdGEuYmFzZURhdGEgPSBiYXNlRGF0YTtcbiAgICAgICAgZGF0YS5yYXRpbmdEYXRhID0gbmV3IFJhdGluZ0NvbXBvbmVudC5SYXRpbmdDb21wb25lbnREYXRhKCk7XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5pc1plcm9CYXNlZCA9IGZhbHNlO1xuICAgICAgICBkYXRhLmNvbW1lbnREYXRhID0gbmV3IENvbW1lbnRDb21wb25lbnQuQ29tbWVudENvbXBvbmVudERhdGEoKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhID0gbmV3IFByb21wdENvbXBvbmVudC5Qcm9tcHRDb21wb25lbnREYXRhKCk7XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5xdWVzdGlvbiA9IHNwLmxvYWRTdHJpbmdSZXNvdXJjZShJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZS5OcHNSYXRpbmdRdWVzdGlvbik7XG4gICAgICAgIGRhdGEuY29tbWVudERhdGEucXVlc3Rpb24gPSBzcC5sb2FkU3RyaW5nUmVzb3VyY2UoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzQ29tbWVudFF1ZXN0aW9uKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnRpdGxlID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFRpdGxlKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnF1ZXN0aW9uID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFF1ZXN0aW9uKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnllc0J1dHRvbkxhYmVsID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFllc0xhYmVsKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLm5vQnV0dG9uTGFiZWwgPSBzcC5sb2FkU3RyaW5nUmVzb3VyY2UoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzUHJvbXB0Tm90Tm93TGFiZWwpO1xuICAgICAgICB2YXIgcmF0aW5nVmFsdWVzQXNjZW5kaW5nID0gbmV3IEFycmF5KDUpO1xuICAgICAgICByYXRpbmdWYWx1ZXNBc2NlbmRpbmdbMF0gPSBzcC5sb2FkU3RyaW5nUmVzb3VyY2UoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzNVJhdGluZ1ZhbHVlMSk7XG4gICAgICAgIHJhdGluZ1ZhbHVlc0FzY2VuZGluZ1sxXSA9IHNwLmxvYWRTdHJpbmdSZXNvdXJjZShJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZS5OcHM1UmF0aW5nVmFsdWUyKTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzJdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczVSYXRpbmdWYWx1ZTMpO1xuICAgICAgICByYXRpbmdWYWx1ZXNBc2NlbmRpbmdbM10gPSBzcC5sb2FkU3RyaW5nUmVzb3VyY2UoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzNVJhdGluZ1ZhbHVlNCk7XG4gICAgICAgIHJhdGluZ1ZhbHVlc0FzY2VuZGluZ1s0XSA9IHNwLmxvYWRTdHJpbmdSZXNvdXJjZShJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZS5OcHM1UmF0aW5nVmFsdWU1KTtcbiAgICAgICAgaWYgKCFkYXRhLnJhdGluZ0RhdGEucXVlc3Rpb25cbiAgICAgICAgICAgIHx8ICFkYXRhLmNvbW1lbnREYXRhLnF1ZXN0aW9uXG4gICAgICAgICAgICB8fCAhZGF0YS5wcm9tcHREYXRhLnRpdGxlXG4gICAgICAgICAgICB8fCAhZGF0YS5wcm9tcHREYXRhLnF1ZXN0aW9uXG4gICAgICAgICAgICB8fCAhZGF0YS5wcm9tcHREYXRhLnllc0J1dHRvbkxhYmVsXG4gICAgICAgICAgICB8fCAhZGF0YS5wcm9tcHREYXRhLm5vQnV0dG9uTGFiZWxcbiAgICAgICAgICAgIHx8ICFyYXRpbmdWYWx1ZXNBc2NlbmRpbmdbMF1cbiAgICAgICAgICAgIHx8ICFyYXRpbmdWYWx1ZXNBc2NlbmRpbmdbMV1cbiAgICAgICAgICAgIHx8ICFyYXRpbmdWYWx1ZXNBc2NlbmRpbmdbMl1cbiAgICAgICAgICAgIHx8ICFyYXRpbmdWYWx1ZXNBc2NlbmRpbmdbM11cbiAgICAgICAgICAgIHx8ICFyYXRpbmdWYWx1ZXNBc2NlbmRpbmdbNF0pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5yYXRpbmdWYWx1ZXNBc2NlbmRpbmcgPSByYXRpbmdWYWx1ZXNBc2NlbmRpbmc7XG4gICAgICAgIHJldHVybiB0aGlzLm1ha2UoZGF0YSk7XG4gICAgfTtcbiAgICBOcHNTdXJ2ZXkubWFrZTExUG9pbnQgPSBmdW5jdGlvbiAoYmFzZURhdGEsIHNwKSB7XG4gICAgICAgIGlmICghYmFzZURhdGEgfHwgIXNwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IG5ldyBOcHNTdXJ2ZXkuTnBzU3VydmV5RGF0YSgpO1xuICAgICAgICBkYXRhLmJhc2VEYXRhID0gYmFzZURhdGE7XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YSA9IG5ldyBSYXRpbmdDb21wb25lbnQuUmF0aW5nQ29tcG9uZW50RGF0YSgpO1xuICAgICAgICBkYXRhLnJhdGluZ0RhdGEuaXNaZXJvQmFzZWQgPSB0cnVlO1xuICAgICAgICBkYXRhLmNvbW1lbnREYXRhID0gbmV3IENvbW1lbnRDb21wb25lbnQuQ29tbWVudENvbXBvbmVudERhdGEoKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhID0gbmV3IFByb21wdENvbXBvbmVudC5Qcm9tcHRDb21wb25lbnREYXRhKCk7XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5xdWVzdGlvbiA9IHNwLmxvYWRTdHJpbmdSZXNvdXJjZShJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZS5OcHNSYXRpbmdRdWVzdGlvbik7XG4gICAgICAgIGRhdGEuY29tbWVudERhdGEucXVlc3Rpb24gPSBzcC5sb2FkU3RyaW5nUmVzb3VyY2UoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzQ29tbWVudFF1ZXN0aW9uKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnRpdGxlID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFRpdGxlKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnF1ZXN0aW9uID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFF1ZXN0aW9uKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLnllc0J1dHRvbkxhYmVsID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFllc0xhYmVsKTtcbiAgICAgICAgZGF0YS5wcm9tcHREYXRhLm5vQnV0dG9uTGFiZWwgPSBzcC5sb2FkU3RyaW5nUmVzb3VyY2UoSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzUHJvbXB0Tm90Tm93TGFiZWwpO1xuICAgICAgICB2YXIgcmF0aW5nVmFsdWVzQXNjZW5kaW5nID0gbmV3IEFycmF5KDExKTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzBdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWUwKTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzFdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWUxKTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzJdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWUyKTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzNdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWUzKTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzRdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWU0KTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzVdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWU1KTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzZdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWU2KTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzddID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWU3KTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzhdID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWU4KTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzldID0gc3AubG9hZFN0cmluZ1Jlc291cmNlKElGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczExUmF0aW5nVmFsdWU5KTtcbiAgICAgICAgcmF0aW5nVmFsdWVzQXNjZW5kaW5nWzEwXSA9IHNwLmxvYWRTdHJpbmdSZXNvdXJjZShJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZS5OcHMxMVJhdGluZ1ZhbHVlMTApO1xuICAgICAgICBpZiAoIWRhdGEucmF0aW5nRGF0YS5xdWVzdGlvblxuICAgICAgICAgICAgfHwgIWRhdGEuY29tbWVudERhdGEucXVlc3Rpb25cbiAgICAgICAgICAgIHx8ICFkYXRhLnByb21wdERhdGEudGl0bGVcbiAgICAgICAgICAgIHx8ICFkYXRhLnByb21wdERhdGEucXVlc3Rpb25cbiAgICAgICAgICAgIHx8ICFkYXRhLnByb21wdERhdGEueWVzQnV0dG9uTGFiZWxcbiAgICAgICAgICAgIHx8ICFkYXRhLnByb21wdERhdGEubm9CdXR0b25MYWJlbFxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1swXVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1sxXVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1syXVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1szXVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1s0XVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1s1XVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1s2XVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1s3XVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1s4XVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1s5XVxuICAgICAgICAgICAgfHwgIXJhdGluZ1ZhbHVlc0FzY2VuZGluZ1sxMF0pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGRhdGEucmF0aW5nRGF0YS5yYXRpbmdWYWx1ZXNBc2NlbmRpbmcgPSByYXRpbmdWYWx1ZXNBc2NlbmRpbmc7XG4gICAgICAgIHJldHVybiB0aGlzLm1ha2UoZGF0YSk7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBOcHNTdXJ2ZXkucHJvdG90eXBlLmdldFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBJU3VydmV5LlR5cGUuTnBzO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgTnBzU3VydmV5LnByb3RvdHlwZS5nZXRTdXJ2ZXlJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdXJ2ZXlJbmZvO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgTnBzU3VydmV5LnByb3RvdHlwZS5nZXRDb21tZW50Q29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbjtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIE5wc1N1cnZleS5wcm90b3R5cGUuZ2V0UHJvbXB0Q29tcG9uZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9tcHQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBOcHNTdXJ2ZXkucHJvdG90eXBlLmdldFJhdGluZ0NvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmF0aW5nO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgTnBzU3VydmV5LnByb3RvdHlwZS5nZXRDb21wb25lbnQgPSBmdW5jdGlvbiAoY29tcG9uZW50VHlwZSkge1xuICAgICAgICBzd2l0Y2ggKGNvbXBvbmVudFR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgSVN1cnZleUNvbXBvbmVudC5UeXBlLkNvbW1lbnQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q29tbWVudENvbXBvbmVudCgpO1xuICAgICAgICAgICAgY2FzZSBJU3VydmV5Q29tcG9uZW50LlR5cGUuUHJvbXB0OlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFByb21wdENvbXBvbmVudCgpO1xuICAgICAgICAgICAgY2FzZSBJU3VydmV5Q29tcG9uZW50LlR5cGUuUmF0aW5nOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFJhdGluZ0NvbXBvbmVudCgpO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgTnBzU3VydmV5LnByb3RvdHlwZS5nZXREb21FbGVtZW50cyA9IGZ1bmN0aW9uIChkb2MpIHtcbiAgICAgICAgaWYgKCFkb2MpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IG11c3Qgbm90IGJlIG51bGxcIik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2MuY3JlYXRlRWxlbWVudChJU3VydmV5LkRPTV9OUFNfVEFHTkFNRSk7XG4gICAgICAgIHRoaXMuZ2V0U3VydmV5SW5mbygpLmdldERvbUVsZW1lbnRzKGRvYykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGlmIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nZXRDb21tZW50Q29tcG9uZW50KCkuZ2V0RG9tRWxlbWVudHMoZG9jKS5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgaWYgKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldFJhdGluZ0NvbXBvbmVudCgpLmdldERvbUVsZW1lbnRzKGRvYykuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGlmIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFtlbGVtZW50XTtcbiAgICB9O1xuICAgIC8vIEBPdmVycmlkZVxuICAgIE5wc1N1cnZleS5wcm90b3R5cGUuZ2V0SnNvbkVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdCA9IFV0aWxzLm92ZXJyaWRlVmFsdWVzKHRoaXMuZ2V0U3VydmV5SW5mbygpLmdldEpzb25FbGVtZW50cygpLCByZXN1bHQpO1xuICAgICAgICByZXN1bHQgPSBVdGlscy5vdmVycmlkZVZhbHVlcyh0aGlzLmdldENvbW1lbnRDb21wb25lbnQoKS5nZXRKc29uRWxlbWVudHMoKSwgcmVzdWx0KTtcbiAgICAgICAgcmVzdWx0ID0gVXRpbHMub3ZlcnJpZGVWYWx1ZXModGhpcy5nZXRSYXRpbmdDb21wb25lbnQoKS5nZXRKc29uRWxlbWVudHMoKSwgcmVzdWx0KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBOcHNTdXJ2ZXk7XG59KCkpO1xuKGZ1bmN0aW9uIChOcHNTdXJ2ZXkpIHtcbiAgICAvKipcbiAgICAgKiBEYXRhIHJlcXVpcmVkIGZvciBhIE5wcyBTdXJ2ZXlcbiAgICAgKi9cbiAgICB2YXIgTnBzU3VydmV5RGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTnBzU3VydmV5RGF0YSgpIHtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTnBzU3VydmV5RGF0YTtcbiAgICB9KCkpO1xuICAgIE5wc1N1cnZleS5OcHNTdXJ2ZXlEYXRhID0gTnBzU3VydmV5RGF0YTtcbn0pKE5wc1N1cnZleSB8fCAoTnBzU3VydmV5ID0ge30pKTtcbm1vZHVsZS5leHBvcnRzID0gTnBzU3VydmV5O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgR292ZXJuZWRDaGFubmVsXzEgPSByZXF1aXJlKFwiLi4vR292ZXJuZWRDaGFubmVsXCIpO1xudmFyIElTdXJ2ZXlJbmZvID0gcmVxdWlyZShcIi4uL0lTdXJ2ZXlJbmZvXCIpO1xudmFyIFV0aWxzID0gcmVxdWlyZShcIi4uL1V0aWxzXCIpO1xudmFyIFN1cnZleURhdGFTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3VydmV5RGF0YVNvdXJjZShkYXRhKSB7XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkYXRhKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YSBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkYXRhLmlkKSB8fCBkYXRhLmlkID09PSBcIlwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkYXRhLmlkIG11c3Qgbm90IGJlIG51bGwgb3IgZW1wdHlcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEuZ292ZXJuZWRDaGFubmVsVHlwZSkpIHtcbiAgICAgICAgICAgIGRhdGEuZ292ZXJuZWRDaGFubmVsVHlwZSA9IEdvdmVybmVkQ2hhbm5lbF8xLkdvdmVybmVkQ2hhbm5lbFR5cGUuZ2V0RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChVdGlscy5pc051bGxPclVuZGVmaW5lZChkYXRhLmV4cGlyYXRpb25UaW1lVXRjKSB8fCBkYXRhLmV4cGlyYXRpb25UaW1lVXRjID09PSBcIlwiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkYXRhLmV4cGlyYXRpb25UaW1lVXRjIG11c3Qgbm90IGJlIG51bGwgb3IgZW1wdHlcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKGRhdGEuYWN0aXZhdGlvbkV2ZW50KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZGF0YS5hY3RpdmF0aW9uRXZlbnQgbXVzdCBub3QgYmUgbnVsbFwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0YS5iYWNrRW5kSWRlbnRpZmllcikgfHwgZGF0YS5iYWNrRW5kSWRlbnRpZmllciA9PT0gXCJcIikge1xuICAgICAgICAgICAgZGF0YS5iYWNrRW5kSWRlbnRpZmllciA9IGRhdGEuaWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICB9XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgU3VydmV5RGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0SWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuaWQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBTdXJ2ZXlEYXRhU291cmNlLnByb3RvdHlwZS5nZXRCYWNrRW5kSWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuYmFja0VuZElkZW50aWZpZXI7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBTdXJ2ZXlEYXRhU291cmNlLnByb3RvdHlwZS5nZXRHb3Zlcm5lZENoYW5uZWxUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmdvdmVybmVkQ2hhbm5lbFR5cGU7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBTdXJ2ZXlEYXRhU291cmNlLnByb3RvdHlwZS5nZXRSYXdTdGFydFRpbWVVdGMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuc3RhcnRUaW1lVXRjO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgU3VydmV5RGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0U3RhcnRUaW1lVXRjID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5kYXRhLnN0YXJ0VGltZVV0YykpIHtcbiAgICAgICAgICAgIHJldHVybiBVdGlscy5nZXREaXN0YW50UGFzdCgpOyAvLyBPcHRpb25hbCBzdGFydCBkYXRlIG1lYW5zIHRoZSBzdXJ2ZXkgaGFzIHN0YXJ0ZWRcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyc2VkID0gbmV3IERhdGUodGhpcy5kYXRhLnN0YXJ0VGltZVV0Yyk7XG4gICAgICAgIGlmICghVXRpbHMuaXNEYXRlKHBhcnNlZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBVdGlscy5nZXREaXN0YW50RnV0dXJlKCk7IC8vIEJhZGx5IHNwZWNpZmllZCBzdGFydCBkYXRlcyBtZWFucyB0aGUgc3VydmV5IG5ldmVyIHN0YXJ0c1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXJzZWQ7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBTdXJ2ZXlEYXRhU291cmNlLnByb3RvdHlwZS5nZXRFeHBpcmF0aW9uVGltZVV0YyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gQmFkIG9yIG1pc3NpbmcgZXhwaXJhdGlvbiBkYXRlIG1lYW5zIHN1cnZleSBpcyBhbHdheXMgZXhwaXJlZC5cbiAgICAgICAgaWYgKFV0aWxzLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZGF0YS5leHBpcmF0aW9uVGltZVV0YykpIHtcbiAgICAgICAgICAgIHJldHVybiBVdGlscy5nZXREaXN0YW50UGFzdCgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJzZWQgPSBuZXcgRGF0ZSh0aGlzLmRhdGEuZXhwaXJhdGlvblRpbWVVdGMpO1xuICAgICAgICBpZiAoIVV0aWxzLmlzRGF0ZShwYXJzZWQpKSB7XG4gICAgICAgICAgICByZXR1cm4gVXRpbHMuZ2V0RGlzdGFudFBhc3QoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyc2VkO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgU3VydmV5RGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0UmF3RXhwaXJhdGlvblRpbWVVdGMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuZXhwaXJhdGlvblRpbWVVdGM7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBTdXJ2ZXlEYXRhU291cmNlLnByb3RvdHlwZS5pc0FjdGl2ZUZvckRhdGUgPSBmdW5jdGlvbiAoZGF0ZSkge1xuICAgICAgICBpZiAoVXRpbHMuaXNOdWxsT3JVbmRlZmluZWQoZGF0ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGRhdGUgPj0gdGhpcy5nZXRTdGFydFRpbWVVdGMoKSAmJiBkYXRlIDw9IHRoaXMuZ2V0RXhwaXJhdGlvblRpbWVVdGMoKSk7XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBTdXJ2ZXlEYXRhU291cmNlLnByb3RvdHlwZS5nZXRBY3RpdmF0aW9uRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuYWN0aXZhdGlvbkV2ZW50O1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgU3VydmV5RGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0UHJlZmVycmVkTGF1bmNoVHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5wcmVmZXJyZWRMYXVuY2hUeXBlO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgU3VydmV5RGF0YVNvdXJjZS5wcm90b3R5cGUuaXNBZGRpdGlvbmFsRGF0YVJlcXVlc3RlZCA9IGZ1bmN0aW9uIChhZGRpdGlvbmFsRGF0YVRvQ2hlY2spIHtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuZGF0YS5hZGRpdGlvbmFsRGF0YVJlcXVlc3RlZDsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBhZGRpdGlvbmFsRGF0YSA9IF9hW19pXTtcbiAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsRGF0YSA9PT0gYWRkaXRpb25hbERhdGFUb0NoZWNrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgLy8gQE92ZXJyaWRlXG4gICAgU3VydmV5RGF0YVNvdXJjZS5wcm90b3R5cGUuZ2V0RG9tRWxlbWVudHMgPSBmdW5jdGlvbiAoZG9jKSB7XG4gICAgICAgIGlmICghZG9jKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJEb2N1bWVudCBtdXN0IG5vdCBiZSBudWxsXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0eXBlRWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KElTdXJ2ZXlJbmZvLkRPTV9UWVBFX1RBR05BTUUpO1xuICAgICAgICB0eXBlRWxlbWVudC5hcHBlbmRDaGlsZChkb2MuY3JlYXRlVGV4dE5vZGUoSVN1cnZleUluZm8uRE9NX1RZUEVfVkFMVUUpKTtcbiAgICAgICAgdmFyIGlkRWxlbWVudCA9IGRvYy5jcmVhdGVFbGVtZW50KElTdXJ2ZXlJbmZvLkRPTV9JRF9UQUdOQU1FKTtcbiAgICAgICAgaWRFbGVtZW50LmFwcGVuZENoaWxkKGRvYy5jcmVhdGVUZXh0Tm9kZSh0aGlzLmdldEJhY2tFbmRJZCgpKSk7XG4gICAgICAgIHJldHVybiBbdHlwZUVsZW1lbnQsIGlkRWxlbWVudF07XG4gICAgfTtcbiAgICAvLyBAT3ZlcnJpZGVcbiAgICBTdXJ2ZXlEYXRhU291cmNlLnByb3RvdHlwZS5nZXRKc29uRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdXJ2ZXlPYmplY3QgPSB7fTtcbiAgICAgICAgc3VydmV5T2JqZWN0W0lTdXJ2ZXlJbmZvLkpTT05fSURfS0VZTkFNRV0gPSB0aGlzLmdldEJhY2tFbmRJZCgpO1xuICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgIHJlc3VsdFtJU3VydmV5SW5mby5KU09OX1NVUlZFWV9LRVlOQU1FXSA9IHN1cnZleU9iamVjdDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlEYXRhU291cmNlO1xufSgpKTtcbihmdW5jdGlvbiAoU3VydmV5RGF0YVNvdXJjZSkge1xuICAgIC8qKlxuICAgICAqIEJhc2ljIGRhdGEgbmVlZGVkIGZvciBhbGwgU3VydmV5c1xuICAgICAqL1xuICAgIHZhciBTdXJ2ZXlEYXRhU291cmNlRGF0YSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gU3VydmV5RGF0YVNvdXJjZURhdGEoKSB7XG4gICAgICAgICAgICB0aGlzLnByZWZlcnJlZExhdW5jaFR5cGUgPSBJU3VydmV5SW5mby5MYXVuY2hUeXBlLkRlZmF1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN1cnZleURhdGFTb3VyY2VEYXRhO1xuICAgIH0oKSk7XG4gICAgU3VydmV5RGF0YVNvdXJjZS5TdXJ2ZXlEYXRhU291cmNlRGF0YSA9IFN1cnZleURhdGFTb3VyY2VEYXRhO1xufSkoU3VydmV5RGF0YVNvdXJjZSB8fCAoU3VydmV5RGF0YVNvdXJjZSA9IHt9KSk7XG5tb2R1bGUuZXhwb3J0cyA9IFN1cnZleURhdGFTb3VyY2U7XG4iLCJcInVzZSBzdHJpY3RcIjtcbi8qXG4gKiBVdGlscy50c1xuICpcbiAqIE1vZHVsZSBmb3IgdXRpbGl0eSBmdW5jdGlvbnNcbiAqL1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBBZGQgdGltZSB0byBhIGdpdmVuIGRhdGVcbiAqIEV4YW1wbGUsIHRpbWVBZGQobmV3IERhdGUoKSwgJ21pbnV0ZScsIDUpICAvL3JldHVybnMgNSBtaW51dGVzIGZyb20gbm93XG4gKiBAcGFyYW0gZGF0ZSAgRGF0ZSB0byBzdGFydCB3aXRoXG4gKiBAcGFyYW0gaW50ZXJ2YWwgIE9uZSBvZjogaG91ciBvciBoLCBtaW51dGUgb3IgbSwgc2Vjb25kIG9yIHNcbiAqIEBwYXJhbSB1bml0cyAgdW5pdHMgb2YgdGhlIGdpdmVuIGludGVydmFsIHRvIGFkZFxuICogQHJldHVybiBkYXRlXG4gKi9cbmZ1bmN0aW9uIHRpbWVBZGQoZGF0ZSwgaW50ZXJ2YWwsIHVuaXRzKSB7XG4gICAgc3dpdGNoIChpbnRlcnZhbC50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgIGNhc2UgXCJoXCI6XG4gICAgICAgIGNhc2UgXCJob3VyXCI6XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZGF0ZS5nZXRUaW1lKCkgKyAodW5pdHMgKiAzNjAwMDAwKSk7XG4gICAgICAgIGNhc2UgXCJtXCI6XG4gICAgICAgIGNhc2UgXCJtaW51dGVcIjpcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSArICh1bml0cyAqIDYwMDAwKSk7XG4gICAgICAgIGNhc2UgXCJzXCI6XG4gICAgICAgIGNhc2UgXCJzZWNvbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldFRpbWUoKSArICh1bml0cyAqIDEwMDApKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgaW50ZXJ2YWwgdmFsdWUgb2YgXCIgKyBpbnRlcnZhbCk7XG4gICAgfVxufVxuZXhwb3J0cy50aW1lQWRkID0gdGltZUFkZDtcbi8qKlxuICogQ2hlY2sgaWYgYW4gaW5wdXQgdmFsdWUgaXMgYSB2YWxpZCBkYXRlLCBudWxsIG9yIHVuZGVmaW5lZCByZXR1cm4gZmFsc2UuXG4gKiBAcGFyYW0gaW5wdXQgIGlucHV0IHZhbHVlXG4gKiBAcmV0dXJuIGJvb2xlYW5cbiAqL1xuZnVuY3Rpb24gaXNEYXRlKGlucHV0KSB7XG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChpbnB1dCkgPT09IFwiW29iamVjdCBEYXRlXVwiKSB7XG4gICAgICAgIC8vIGl0IGlzIGEgZGF0ZVxuICAgICAgICBpZiAoIShpc05hTihpbnB1dC5nZXRUaW1lKCkpKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZXhwb3J0cy5pc0RhdGUgPSBpc0RhdGU7XG4vKipcbiAqIENoZWNrIGlmIGFuIGlucHV0IHZhbHVlIGlzIGEgdmFsaWQgdmFsdWUgaW4gdGhlIGlucHV0IGVudW1cbiAqIEBwYXJhbSB2YWx1ZSAgaW5wdXQgdmFsdWVcbiAqIEBwYXJhbSBpbnB1dCAgaW5wdXQgZW51bVxuICogUmV0dXJucyB0cnVlIGlmIHZhbHVlIGV4aXN0cyBpbiB0aGUgZW51bVxuICovXG5mdW5jdGlvbiBpc0VudW1WYWx1ZSh2YWx1ZSwgaW5wdXQpIHtcbiAgICByZXR1cm4gKHZhbHVlIGluIGlucHV0KTtcbn1cbmV4cG9ydHMuaXNFbnVtVmFsdWUgPSBpc0VudW1WYWx1ZTtcbi8qKlxuICogQ2hlY2sgaWYgYW4gaW5wdXQgdmFsdWUgaXMgYSBudW1iZXJcbiAqIEBwYXJhbSB2YWx1ZTogaW5wdXQgdmFsdWVcbiAqL1xuZnVuY3Rpb24gaXNOdW1iZXIodmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlICE9PSBudWxsICYmICFpc05hTih2YWx1ZSkgJiYgaXNGaW5pdGUodmFsdWUpKTtcbn1cbmV4cG9ydHMuaXNOdW1iZXIgPSBpc051bWJlcjtcbi8qKlxuICogQ2hlY2sgaWYgYW4gaW5wdXQgdmFsdWUgaXMgbnVsbCBvciB1bmRlZmluZWRcbiAqIEBwYXJhbSB2YWx1ZTogaW5wdXQgdmFsdWVcbiAqL1xuZnVuY3Rpb24gaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpO1xufVxuZXhwb3J0cy5pc051bGxPclVuZGVmaW5lZCA9IGlzTnVsbE9yVW5kZWZpbmVkO1xuLyoqXG4gKiBDaGVjayBpZiBhbiBpbnB1dCB2YWx1ZSBpcyBhbiBvYmplY3RcbiAqIEBwYXJhbSB2YWx1ZTogaW5wdXQgdmFsdWVcbiAqL1xuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQgJiYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikpO1xufVxuZXhwb3J0cy5pc09iamVjdCA9IGlzT2JqZWN0O1xuLyoqXG4gKiBDaGVjayBpZiBnaXZlbiB2YWx1ZSBpcyBhIHN0cmluZ1xuICogQHBhcmFtIHthbnl9IHZhbHVlIHZhbHVlXG4gKi9cbmZ1bmN0aW9uIGlzU3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpO1xufVxuZXhwb3J0cy5pc1N0cmluZyA9IGlzU3RyaW5nO1xuLyoqXG4gKiBDaGVjayBpZiB2YWx1ZSBpcyBhbiBvYmplY3RcbiAqIEBwYXJhbSB7YW55fSB2YWx1ZSB2YWx1ZVxuICovXG5mdW5jdGlvbiBpc0Jvb2xlYW4odmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mICh2YWx1ZSkgPT09IFwiYm9vbGVhblwiO1xufVxuZXhwb3J0cy5pc0Jvb2xlYW4gPSBpc0Jvb2xlYW47XG4vKipcbiAqIFJldHVybnMgYSBsb3dlciB0ZW1wb3JhbCBib3VuZGFyeVxuICogQHJldHVybiBkYXRlXG4gKi9cbmZ1bmN0aW9uIGdldERpc3RhbnRQYXN0KCkge1xuICAgIC8vIENvcnJlc3BvbmRzIHRvIFVUQyAwMDAxLTEyLTMwVDAwOjAwOjAwWlxuICAgIHJldHVybiBuZXcgRGF0ZSgtNjIxMDQyMzM2MDAwMDApO1xufVxuZXhwb3J0cy5nZXREaXN0YW50UGFzdCA9IGdldERpc3RhbnRQYXN0O1xuLyoqXG4gKiBHZXQgYW4gdXBwZXIgdGVtcG9yYWwgYm91bmRhcnlcbiAqIEByZXR1cm4gZGF0ZVxuICovXG5mdW5jdGlvbiBnZXREaXN0YW50RnV0dXJlKCkge1xuICAgIC8vIENvcnJlc3BvbmRzIHRvIFVUQyA0MDAxLTAxLTAxVDAwOjAwOjAwWlxuICAgIHJldHVybiBuZXcgRGF0ZSg2NDA5MjIxMTIwMDAwMCk7XG59XG5leHBvcnRzLmdldERpc3RhbnRGdXR1cmUgPSBnZXREaXN0YW50RnV0dXJlO1xuZXhwb3J0cy5NQVhfREFURV9NSUxMSVNFQ09ORFMgPSA4NjQwMDAwMDAwMDAwMDAwO1xuZXhwb3J0cy5NSU5fREFURV9NSUxMSVNFQ09ORFMgPSAtODY0MDAwMDAwMDAwMDAwMDtcbi8qKlxuICogQWRkcyBzZWNvbmRzIHRvIGEgZGF0ZSwgaWYgb3ZlcmZsb3dzIHJldHVybnMgRGF0ZShOdW1iZXIuTWF4X1ZBTFVFKVxuICpcbiAqIEBwYXJhbSBkYXRlICAgIGRhdGUgdG8gYWRkIHRvXG4gKiBAcGFyYW0gc2Vjb25kcyBzZWNvbmRzIGFzIG51bWJlclxuICogQHJldHVybiBSZXN1bHRpbmcgZGF0ZVxuICovXG5mdW5jdGlvbiBhZGRTZWNvbmRzV2l0aG91dE92ZXJmbG93KGRhdGUsIHNlY29uZHMpIHtcbiAgICBpZiAoIWRhdGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmIChzZWNvbmRzIDwgMCkge1xuICAgICAgICByZXR1cm4gc3VidHJhY3RTZWNvbmRzV2l0aG91dE92ZXJmbG93KGRhdGUsIC0xICogc2Vjb25kcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgbWlsbGlzZWNvbmRzID0gZGF0ZS5nZXRUaW1lKCkgKyBzZWNvbmRzICogMTAwMDtcbiAgICAgICAgaWYgKG1pbGxpc2Vjb25kcyA8IGV4cG9ydHMuTUFYX0RBVEVfTUlMTElTRUNPTkRTKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUobWlsbGlzZWNvbmRzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShleHBvcnRzLk1BWF9EQVRFX01JTExJU0VDT05EUyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLmFkZFNlY29uZHNXaXRob3V0T3ZlcmZsb3cgPSBhZGRTZWNvbmRzV2l0aG91dE92ZXJmbG93O1xuLyoqXG4gKiBTdWJ0cmFjdHMgc2Vjb25kcyBmcm9tIGEgZGF0ZSwgaWYgb3ZlcmZsb3dzIHJldHVybnMgRGF0ZShOdW1iZXIuTUlOX1ZBTFVFKVxuICpcbiAqIEBwYXJhbSBkYXRlICAgZGF0ZSB0byBzdWJ0cmFjdCBmcm9tXG4gKiBAcGFyYW0gc2Vjb25kcyBzZWNvbmRzIGFzIG51bWJlclxuICogQHJldHVybiBSZXN1bHRpbmcgZGF0ZVxuICovXG5mdW5jdGlvbiBzdWJ0cmFjdFNlY29uZHNXaXRob3V0T3ZlcmZsb3coZGF0ZSwgc2Vjb25kcykge1xuICAgIGlmICghZGF0ZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKHNlY29uZHMgPCAwKSB7XG4gICAgICAgIHNlY29uZHMgPSAtc2Vjb25kcztcbiAgICAgICAgcmV0dXJuIHRoaXMuYWRkU2Vjb25kc1dpdGhvdXRPdmVyZmxvdyhkYXRlLCBzZWNvbmRzKTtcbiAgICB9XG4gICAgdmFyIG1pbGxpc2Vjb25kcyA9IGRhdGUuZ2V0VGltZSgpIC0gKHNlY29uZHMgKiAxMDAwKTtcbiAgICBpZiAobWlsbGlzZWNvbmRzID4gZXhwb3J0cy5NSU5fREFURV9NSUxMSVNFQ09ORFMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKG1pbGxpc2Vjb25kcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoZXhwb3J0cy5NSU5fREFURV9NSUxMSVNFQ09ORFMpO1xuICAgIH1cbn1cbmV4cG9ydHMuc3VidHJhY3RTZWNvbmRzV2l0aG91dE92ZXJmbG93ID0gc3VidHJhY3RTZWNvbmRzV2l0aG91dE92ZXJmbG93O1xuLy8gcmVnaW9uIExhbmd1YWdlIHJlbGF0ZWRcbi8qKlxuICogRWZmZWN0aXZlbHkgdW4tYW5jaG9yZWQgb24gdGhlIHJpZ2h0IHNpZGUgYmVjYXVzZSB0YWdzIGNhbiBoYXZlIG1hbnkgbW9yZSB0cmFpbGluZyBzdWItcGFydHMgdGhhbiB3ZSBjYXJlIHRvIGV4dHJhY3RcbiAqIFJlZmVyIHRvIGh0dHBzOi8vd3d3LmlldGYub3JnL3JmYy9yZmM1NjQ2LnR4dFxuICovXG52YXIgTEFOR1VBR0VfQU5EX1NDUklQVF9UQUdfUEFUVEVSTiA9IFwiXlwiICtcbiAgICAvLyBjYXB0dXJlIDE6bGFuZ3VhZ2Ugc3VidGFnXG4gICAgXCIoXCIgK1xuICAgIFwiKD86W2EtekEtWl17MiwzfSg/Oi1bYS16QS1aXXszfSl7MCwzfSlcIiArIC8vIDItMyBBbHBoYSBjaGFycywgZm9sbG93ZWQgYnkgdXAgdG8gdGhyZWUgb3B0aW9uYWwgZXh0ZW5zaW9uIHRhZ3MsIGVhY2ggb2YgZm9ybWF0IC1BQUEsIEE9QWxwaGEgY2hhclxuICAgIFwifFwiICtcbiAgICBcIig/OlthLXpBLVpdezQsOH0pXCIgKyAvLyA0LUFscGhhIGNoYXJzIChyZXNlcnZlZCBpbiBzdGFuZGFyZCkgb3IgNS04IEFscGhhIGNoYXJzXG4gICAgXCIpXCIgK1xuICAgIFwiKD86XCIgK1xuICAgIFwiLVwiICtcbiAgICAvLyBjYXB0dXJlIDI6IG9wdGlvbmFsIHNjcmlwdCBzdWJ0YWcgKHdpdGhvdXQgbGVhZGluZyBkYXNoKSwgZXhhY3RseSA0IGFscGhhIGNoYXJzXG4gICAgXCIoW2EtekEtWl17NH0pXCIgKyAvLyA0LUFscGhhIGNoYXJzXG4gICAgXCIpP1wiICtcbiAgICAvLyBjYXB0dXJlIDM6IG9wdGlvbmFsIHJlZ2lvbiBzdWJ0YWcgKHdpdGhvdXQgbGVhZGluZyBkYXNoKSwgZXhhY3RseSAyIGFscGhhIGNoYXJzIG9yIDMgZGlnaXRzXG4gICAgXCIoPzotKFthLXpBLVpdezJ9fFswLTldezN9KSk/XCIgK1xuICAgIFwiKFwiICtcbiAgICAvLyBjYXB0dXJlIDQ6IGFueSBsZWZ0LW92ZXJzLCByZWplY3RpbmcgcmVtYWluZGVyIHN0cmluZ3MgdGhhdCBkb24ndCBlbmQgaGVyZSBvciBsZWFkIHdpdGggYSBkYXNoLlxuICAgIFwiLS4qXCIgK1xuICAgIFwiKT9cIiArXG4gICAgXCIkXCI7XG5mdW5jdGlvbiBpc1ZhbGlkTGFuZ3VhZ2VTdWJUYWcoc3ViVGFnKSB7XG4gICAgaWYgKCFzdWJUYWcpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgZXh0cmFjdGVkU3ViVGFnID0gZXh0cmFjdExhbmd1YWdlU3VidGFnKHN1YlRhZyk7XG4gICAgaWYgKCFleHRyYWN0ZWRTdWJUYWcpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gZXh0cmFjdGVkU3ViVGFnID09PSBzdWJUYWc7XG59XG5leHBvcnRzLmlzVmFsaWRMYW5ndWFnZVN1YlRhZyA9IGlzVmFsaWRMYW5ndWFnZVN1YlRhZztcbmZ1bmN0aW9uIGV4dHJhY3RMYW5ndWFnZVN1YnRhZyhsYW5ndWFnZSkge1xuICAgIGlmICghbGFuZ3VhZ2UpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBtYXRjaGVzID0gbGFuZ3VhZ2UubWF0Y2goTEFOR1VBR0VfQU5EX1NDUklQVF9UQUdfUEFUVEVSTik7XG4gICAgaWYgKCFtYXRjaGVzIHx8IG1hdGNoZXMubGVuZ3RoIDwgMSB8fCAhaXNOdWxsT3JVbmRlZmluZWQobWF0Y2hlc1s0XSkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIC8vIHJldHVybiB0aGUgZmlyc3QgY2FwdHVyZSBncm91cCB3aGljaCBzaG91bGQgYmUgdGhlIG9yaWdpbmFsIGlucHV0IGlmIHRoZXJlIGlzIGEgbWF0Y2hcbiAgICAvLyBGb3IgZXhhbXBsZSwgXCJlbi1VU1wiIGlucHV0IHNob3VsZCByZXR1cm4gXCJlbi1VU1wiLCBhbmQgXCJlblwiIGlucHV0IHNob3VsZCByZXR1cm4gXCJlblwiLlxuICAgIHJldHVybiBtYXRjaGVzWzBdO1xufVxuZXhwb3J0cy5leHRyYWN0TGFuZ3VhZ2VTdWJ0YWcgPSBleHRyYWN0TGFuZ3VhZ2VTdWJ0YWc7XG4vLyBlbmRyZWdpb25cbi8qKlxuICogQ3JlYXRlIGd1aWQgc3RyaW5nXG4gKi9cbmZ1bmN0aW9uIGd1aWQoKSB7XG4gICAgLy8gU3RpdGNoIGluICc0JyBpbiB0aGUgdGhpcmQgZ3JvdXBcbiAgICByZXR1cm4gKHJhbmRvbUhleDQoKSArIHJhbmRvbUhleDQoKSArIFwiLVwiICsgcmFuZG9tSGV4NCgpICsgXCItNFwiICsgcmFuZG9tSGV4NCgpLnN1YnN0cigwLCAzKSArIFwiLVwiICsgcmFuZG9tSGV4NCgpICsgXCItXCJcbiAgICAgICAgKyByYW5kb21IZXg0KCkgKyByYW5kb21IZXg0KCkgKyByYW5kb21IZXg0KCkpLnRvTG93ZXJDYXNlKCk7XG59XG5leHBvcnRzLmd1aWQgPSBndWlkO1xuLyoqXG4gKiBDcmVhdGUgcmFuZG9tIEhleDQgc3RyaW5nXG4gKi9cbmZ1bmN0aW9uIHJhbmRvbUhleDQoKSB7XG4gICAgcmV0dXJuIChNYXRoLmZsb29yKCgoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCkpKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xufVxuLyoqXG4gKiBDcmVhdGUgYW4gYXJyYXkgZnJvbSBpbnB1dCBvYmplY3QgdmFsdWVzIHNvcnRlZCBieSBvYmplY3Qga2V5XG4gKiBAcGFyYW0gT2JqZWN0IGlucHV0IG9iamVjdFxuICogQHJldHVybiBhcnJheVxuICovXG5mdW5jdGlvbiBtYWtlQXJyYXlGcm9tT2JqZWN0VmFsdWVzU29ydGVkQnlLZXlTdHJpbmcob2JqZWN0KSB7XG4gICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpO1xuICAgIGtleXMuc29ydCgpO1xuICAgIHZhciB2YWx1ZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpZCBpbiBrZXlzKSB7XG4gICAgICAgIGlmIChrZXlzLmhhc093blByb3BlcnR5KGlkKSkge1xuICAgICAgICAgICAgdmFyIGtleSA9IGtleXNbaWRdO1xuICAgICAgICAgICAgdmFsdWVzLnB1c2gob2JqZWN0W2tleV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZXM7XG59XG5leHBvcnRzLm1ha2VBcnJheUZyb21PYmplY3RWYWx1ZXNTb3J0ZWRCeUtleVN0cmluZyA9IG1ha2VBcnJheUZyb21PYmplY3RWYWx1ZXNTb3J0ZWRCeUtleVN0cmluZztcbi8qKlxuICogQ3JlYXRlIGEgZGF0ZSBvYmplY3QgZnJvbSBhbiBpbnB1dCBzdHJpbmdcbiAqIEBwYXJhbSBPYmplY3QgaW5wdXQgc3RyaW5nXG4gKiBAcmV0dXJuIGRhdGVcbiAqL1xuZnVuY3Rpb24gc3RyaW5nVG9EYXRlKGlucHV0KSB7XG4gICAgaWYgKCFpc1N0cmluZyhpbnB1dCkpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBuZXdEYXRlID0gaW5wdXQgPyBuZXcgRGF0ZShpbnB1dCkgOiBudWxsO1xuICAgIHJldHVybiBpc0RhdGUobmV3RGF0ZSkgPyBuZXdEYXRlIDogbnVsbDtcbn1cbmV4cG9ydHMuc3RyaW5nVG9EYXRlID0gc3RyaW5nVG9EYXRlO1xuLyoqXG4gKiBUYWtlcyB0d28gb2JqZWN0cyAoc291cmNlLCB0YXJnZXQpIGFuZCByZXR1cm5zIHRoZSB0YXJnZXQgb2JqZWN0IHdpdGggdmFsdWVzIGluIHRoZSBzb3VyY2UgYWRkZWQgdG8gaXQuXG4gKiBJdCBvdmVyd3JpdGVzIGFueSBzb3VyY2UgcHJvcGVydGllcyB3aGljaCBhbHJlYWR5IGV4aXN0IGluIHRhcmdldC5cbiAqL1xuZnVuY3Rpb24gb3ZlcnJpZGVWYWx1ZXMoc291cmNlT2JqZWN0LCB0YXJnZXRvYmplY3QpIHtcbiAgICBpZiAoIXRhcmdldG9iamVjdCkge1xuICAgICAgICByZXR1cm4gdGFyZ2V0b2JqZWN0O1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gdGFyZ2V0b2JqZWN0O1xuICAgIGlmIChzb3VyY2VPYmplY3QpIHtcbiAgICAgICAgZm9yICh2YXIgZmllbGQgaW4gc291cmNlT2JqZWN0KSB7XG4gICAgICAgICAgICBpZiAoc291cmNlT2JqZWN0Lmhhc093blByb3BlcnR5KGZpZWxkKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtmaWVsZF0gPSBzb3VyY2VPYmplY3RbZmllbGRdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLm92ZXJyaWRlVmFsdWVzID0gb3ZlcnJpZGVWYWx1ZXM7XG4vKipcbiAqIFRlc3QgYSBzdHJpbmcgaXMgaW4gb3VyIHN1cHBvcnRlZCBJU084NjAxIFVUQyBmb3JtYXQgb2YgXCJ5eXl5LU1NLWRkVEhIOm1tOnNzWlwiIGFuZCBcInl5eXktTU0tZGRUSEg6bW06c3MuZmZmWlwiXG4gKiBAcGFyYW0gaW5wdXQgSW5wdXQgc3RyaW5nIHRvIGJlIGV2YWx1YXRlZC5cbiAqL1xuZnVuY3Rpb24gaXNVdGNEYXRldGltZVN0cmluZyhpbnB1dCkge1xuICAgIGlmICghaXNTdHJpbmcoaW5wdXQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIHN1cHBvcnRlZFV0Y1JlZ2V4ID0gL14oXFxkezR9XFwtXFxkXFxkXFwtXFxkXFxkVFxcZFxcZDpcXGRcXGQ6XFxkXFxkKFxcLlxcZFxcZFxcZCk/WikkLztcbiAgICByZXR1cm4gc3VwcG9ydGVkVXRjUmVnZXgudGVzdChpbnB1dCk7XG59XG5leHBvcnRzLmlzVXRjRGF0ZXRpbWVTdHJpbmcgPSBpc1V0Y0RhdGV0aW1lU3RyaW5nO1xuLyoqXG4gKiBDb252ZXJ0IGEgZGF0ZSBvYmplY3QgdG8gYSBzdHJpbmcgaW4gSVNPODYwMSBVVEMgZm9ybWF0IHN1cHBvcnRlZCBieSBGbG9vZGdhdGUgKFwieXl5eS1NTS1kZFRISDptbTpzc1pcIilcbiAqIEBwYXJhbSBpbnB1dCBJbnB1dCBkYXRlIG9iamVjdFxuICovXG5mdW5jdGlvbiBkYXRlVG9TaG9ydFV0Y1N0cmluZyhpbnB1dCkge1xuICAgIGlmICghaXNEYXRlKGlucHV0KSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgZnVuY3Rpb24gcGFkKG4pIHtcbiAgICAgICAgcmV0dXJuIChuIDwgMTApID8gKFwiMFwiICsgbikgOiBuLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHJldHVybiBpbnB1dC5nZXRVVENGdWxsWWVhcigpICtcbiAgICAgICAgXCItXCIgKyBwYWQoaW5wdXQuZ2V0VVRDTW9udGgoKSArIDEpICtcbiAgICAgICAgXCItXCIgKyBwYWQoaW5wdXQuZ2V0VVRDRGF0ZSgpKSArXG4gICAgICAgIFwiVFwiICsgcGFkKGlucHV0LmdldFVUQ0hvdXJzKCkpICtcbiAgICAgICAgXCI6XCIgKyBwYWQoaW5wdXQuZ2V0VVRDTWludXRlcygpKSArXG4gICAgICAgIFwiOlwiICsgcGFkKGlucHV0LmdldFVUQ1NlY29uZHMoKSkgK1xuICAgICAgICBcIlpcIjtcbn1cbmV4cG9ydHMuZGF0ZVRvU2hvcnRVdGNTdHJpbmcgPSBkYXRlVG9TaG9ydFV0Y1N0cmluZztcbiIsIi8qIVxuICogQG92ZXJ2aWV3IGVzNi1wcm9taXNlIC0gYSB0aW55IGltcGxlbWVudGF0aW9uIG9mIFByb21pc2VzL0ErLlxuICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTQgWWVodWRhIEthdHosIFRvbSBEYWxlLCBTdGVmYW4gUGVubmVyIGFuZCBjb250cmlidXRvcnMgKENvbnZlcnNpb24gdG8gRVM2IEFQSSBieSBKYWtlIEFyY2hpYmFsZClcbiAqIEBsaWNlbnNlICAgTGljZW5zZWQgdW5kZXIgTUlUIGxpY2Vuc2VcbiAqICAgICAgICAgICAgU2VlIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGVmYW5wZW5uZXIvZXM2LXByb21pc2UvbWFzdGVyL0xJQ0VOU0VcbiAqIEB2ZXJzaW9uICAgdjQuMi40KzMxNGU0ODMxXG4gKi9cblxuKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcblx0dHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuXHR0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuXHQoZ2xvYmFsLkVTNlByb21pc2UgPSBmYWN0b3J5KCkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIG9iamVjdE9yRnVuY3Rpb24oeCkge1xuICB2YXIgdHlwZSA9IHR5cGVvZiB4O1xuICByZXR1cm4geCAhPT0gbnVsbCAmJiAodHlwZSA9PT0gJ29iamVjdCcgfHwgdHlwZSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oeCkge1xuICByZXR1cm4gdHlwZW9mIHggPT09ICdmdW5jdGlvbic7XG59XG5cblxuXG52YXIgX2lzQXJyYXkgPSB2b2lkIDA7XG5pZiAoQXJyYXkuaXNBcnJheSkge1xuICBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXk7XG59IGVsc2Uge1xuICBfaXNBcnJheSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4KSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfTtcbn1cblxudmFyIGlzQXJyYXkgPSBfaXNBcnJheTtcblxudmFyIGxlbiA9IDA7XG52YXIgdmVydHhOZXh0ID0gdm9pZCAwO1xudmFyIGN1c3RvbVNjaGVkdWxlckZuID0gdm9pZCAwO1xuXG52YXIgYXNhcCA9IGZ1bmN0aW9uIGFzYXAoY2FsbGJhY2ssIGFyZykge1xuICBxdWV1ZVtsZW5dID0gY2FsbGJhY2s7XG4gIHF1ZXVlW2xlbiArIDFdID0gYXJnO1xuICBsZW4gKz0gMjtcbiAgaWYgKGxlbiA9PT0gMikge1xuICAgIC8vIElmIGxlbiBpcyAyLCB0aGF0IG1lYW5zIHRoYXQgd2UgbmVlZCB0byBzY2hlZHVsZSBhbiBhc3luYyBmbHVzaC5cbiAgICAvLyBJZiBhZGRpdGlvbmFsIGNhbGxiYWNrcyBhcmUgcXVldWVkIGJlZm9yZSB0aGUgcXVldWUgaXMgZmx1c2hlZCwgdGhleVxuICAgIC8vIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IHRoaXMgZmx1c2ggdGhhdCB3ZSBhcmUgc2NoZWR1bGluZy5cbiAgICBpZiAoY3VzdG9tU2NoZWR1bGVyRm4pIHtcbiAgICAgIGN1c3RvbVNjaGVkdWxlckZuKGZsdXNoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2NoZWR1bGVGbHVzaCgpO1xuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gc2V0U2NoZWR1bGVyKHNjaGVkdWxlRm4pIHtcbiAgY3VzdG9tU2NoZWR1bGVyRm4gPSBzY2hlZHVsZUZuO1xufVxuXG5mdW5jdGlvbiBzZXRBc2FwKGFzYXBGbikge1xuICBhc2FwID0gYXNhcEZuO1xufVxuXG52YXIgYnJvd3NlcldpbmRvdyA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdW5kZWZpbmVkO1xudmFyIGJyb3dzZXJHbG9iYWwgPSBicm93c2VyV2luZG93IHx8IHt9O1xudmFyIEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyID0gYnJvd3Nlckdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGJyb3dzZXJHbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjtcbnZhciBpc05vZGUgPSB0eXBlb2Ygc2VsZiA9PT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHt9LnRvU3RyaW5nLmNhbGwocHJvY2VzcykgPT09ICdbb2JqZWN0IHByb2Nlc3NdJztcblxuLy8gdGVzdCBmb3Igd2ViIHdvcmtlciBidXQgbm90IGluIElFMTBcbnZhciBpc1dvcmtlciA9IHR5cGVvZiBVaW50OENsYW1wZWRBcnJheSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGltcG9ydFNjcmlwdHMgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCc7XG5cbi8vIG5vZGVcbmZ1bmN0aW9uIHVzZU5leHRUaWNrKCkge1xuICAvLyBub2RlIHZlcnNpb24gMC4xMC54IGRpc3BsYXlzIGEgZGVwcmVjYXRpb24gd2FybmluZyB3aGVuIG5leHRUaWNrIGlzIHVzZWQgcmVjdXJzaXZlbHlcbiAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9jdWpvanMvd2hlbi9pc3N1ZXMvNDEwIGZvciBkZXRhaWxzXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpO1xuICB9O1xufVxuXG4vLyB2ZXJ0eFxuZnVuY3Rpb24gdXNlVmVydHhUaW1lcigpIHtcbiAgaWYgKHR5cGVvZiB2ZXJ0eE5leHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZlcnR4TmV4dChmbHVzaCk7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB1c2VTZXRUaW1lb3V0KCk7XG59XG5cbmZ1bmN0aW9uIHVzZU11dGF0aW9uT2JzZXJ2ZXIoKSB7XG4gIHZhciBpdGVyYXRpb25zID0gMDtcbiAgdmFyIG9ic2VydmVyID0gbmV3IEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyKGZsdXNoKTtcbiAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7XG4gIG9ic2VydmVyLm9ic2VydmUobm9kZSwgeyBjaGFyYWN0ZXJEYXRhOiB0cnVlIH0pO1xuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgbm9kZS5kYXRhID0gaXRlcmF0aW9ucyA9ICsraXRlcmF0aW9ucyAlIDI7XG4gIH07XG59XG5cbi8vIHdlYiB3b3JrZXJcbmZ1bmN0aW9uIHVzZU1lc3NhZ2VDaGFubmVsKCkge1xuICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZsdXNoO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjaGFubmVsLnBvcnQyLnBvc3RNZXNzYWdlKDApO1xuICB9O1xufVxuXG5mdW5jdGlvbiB1c2VTZXRUaW1lb3V0KCkge1xuICAvLyBTdG9yZSBzZXRUaW1lb3V0IHJlZmVyZW5jZSBzbyBlczYtcHJvbWlzZSB3aWxsIGJlIHVuYWZmZWN0ZWQgYnlcbiAgLy8gb3RoZXIgY29kZSBtb2RpZnlpbmcgc2V0VGltZW91dCAobGlrZSBzaW5vbi51c2VGYWtlVGltZXJzKCkpXG4gIHZhciBnbG9iYWxTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZ2xvYmFsU2V0VGltZW91dChmbHVzaCwgMSk7XG4gIH07XG59XG5cbnZhciBxdWV1ZSA9IG5ldyBBcnJheSgxMDAwKTtcbmZ1bmN0aW9uIGZsdXNoKCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgdmFyIGNhbGxiYWNrID0gcXVldWVbaV07XG4gICAgdmFyIGFyZyA9IHF1ZXVlW2kgKyAxXTtcblxuICAgIGNhbGxiYWNrKGFyZyk7XG5cbiAgICBxdWV1ZVtpXSA9IHVuZGVmaW5lZDtcbiAgICBxdWV1ZVtpICsgMV0gPSB1bmRlZmluZWQ7XG4gIH1cblxuICBsZW4gPSAwO1xufVxuXG5mdW5jdGlvbiBhdHRlbXB0VmVydHgoKSB7XG4gIHRyeSB7XG4gICAgdmFyIHZlcnR4ID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKS5yZXF1aXJlKCd2ZXJ0eCcpO1xuICAgIHZlcnR4TmV4dCA9IHZlcnR4LnJ1bk9uTG9vcCB8fCB2ZXJ0eC5ydW5PbkNvbnRleHQ7XG4gICAgcmV0dXJuIHVzZVZlcnR4VGltZXIoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB1c2VTZXRUaW1lb3V0KCk7XG4gIH1cbn1cblxudmFyIHNjaGVkdWxlRmx1c2ggPSB2b2lkIDA7XG4vLyBEZWNpZGUgd2hhdCBhc3luYyBtZXRob2QgdG8gdXNlIHRvIHRyaWdnZXJpbmcgcHJvY2Vzc2luZyBvZiBxdWV1ZWQgY2FsbGJhY2tzOlxuaWYgKGlzTm9kZSkge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTmV4dFRpY2soKTtcbn0gZWxzZSBpZiAoQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZU11dGF0aW9uT2JzZXJ2ZXIoKTtcbn0gZWxzZSBpZiAoaXNXb3JrZXIpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZU1lc3NhZ2VDaGFubmVsKCk7XG59IGVsc2UgaWYgKGJyb3dzZXJXaW5kb3cgPT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgcmVxdWlyZSA9PT0gJ2Z1bmN0aW9uJykge1xuICBzY2hlZHVsZUZsdXNoID0gYXR0ZW1wdFZlcnR4KCk7XG59IGVsc2Uge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlU2V0VGltZW91dCgpO1xufVxuXG5mdW5jdGlvbiB0aGVuKG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG4gIHZhciBwYXJlbnQgPSB0aGlzO1xuXG4gIHZhciBjaGlsZCA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG5vb3ApO1xuXG4gIGlmIChjaGlsZFtQUk9NSVNFX0lEXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbWFrZVByb21pc2UoY2hpbGQpO1xuICB9XG5cbiAgdmFyIF9zdGF0ZSA9IHBhcmVudC5fc3RhdGU7XG5cblxuICBpZiAoX3N0YXRlKSB7XG4gICAgdmFyIGNhbGxiYWNrID0gYXJndW1lbnRzW19zdGF0ZSAtIDFdO1xuICAgIGFzYXAoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGludm9rZUNhbGxiYWNrKF9zdGF0ZSwgY2hpbGQsIGNhbGxiYWNrLCBwYXJlbnQuX3Jlc3VsdCk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKTtcbiAgfVxuXG4gIHJldHVybiBjaGlsZDtcbn1cblxuLyoqXG4gIGBQcm9taXNlLnJlc29sdmVgIHJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCBiZWNvbWUgcmVzb2x2ZWQgd2l0aCB0aGVcbiAgcGFzc2VkIGB2YWx1ZWAuIEl0IGlzIHNob3J0aGFuZCBmb3IgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICByZXNvbHZlKDEpO1xuICB9KTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIHZhbHVlID09PSAxXG4gIH0pO1xuICBgYGBcblxuICBJbnN0ZWFkIG9mIHdyaXRpbmcgdGhlIGFib3ZlLCB5b3VyIGNvZGUgbm93IHNpbXBseSBiZWNvbWVzIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgxKTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIHZhbHVlID09PSAxXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIHJlc29sdmVcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FueX0gdmFsdWUgdmFsdWUgdGhhdCB0aGUgcmV0dXJuZWQgcHJvbWlzZSB3aWxsIGJlIHJlc29sdmVkIHdpdGhcbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgdGhhdCB3aWxsIGJlY29tZSBmdWxmaWxsZWQgd2l0aCB0aGUgZ2l2ZW5cbiAgYHZhbHVlYFxuKi9cbmZ1bmN0aW9uIHJlc29sdmUkMShvYmplY3QpIHtcbiAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcblxuICBpZiAob2JqZWN0ICYmIHR5cGVvZiBvYmplY3QgPT09ICdvYmplY3QnICYmIG9iamVjdC5jb25zdHJ1Y3RvciA9PT0gQ29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gb2JqZWN0O1xuICB9XG5cbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG4gIHJlc29sdmUocHJvbWlzZSwgb2JqZWN0KTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbnZhciBQUk9NSVNFX0lEID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIpO1xuXG5mdW5jdGlvbiBub29wKCkge31cblxudmFyIFBFTkRJTkcgPSB2b2lkIDA7XG52YXIgRlVMRklMTEVEID0gMTtcbnZhciBSRUpFQ1RFRCA9IDI7XG5cbnZhciBUUllfQ0FUQ0hfRVJST1IgPSB7IGVycm9yOiBudWxsIH07XG5cbmZ1bmN0aW9uIHNlbGZGdWxmaWxsbWVudCgpIHtcbiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoXCJZb3UgY2Fubm90IHJlc29sdmUgYSBwcm9taXNlIHdpdGggaXRzZWxmXCIpO1xufVxuXG5mdW5jdGlvbiBjYW5ub3RSZXR1cm5Pd24oKSB7XG4gIHJldHVybiBuZXcgVHlwZUVycm9yKCdBIHByb21pc2VzIGNhbGxiYWNrIGNhbm5vdCByZXR1cm4gdGhhdCBzYW1lIHByb21pc2UuJyk7XG59XG5cbmZ1bmN0aW9uIGdldFRoZW4ocHJvbWlzZSkge1xuICB0cnkge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgVFJZX0NBVENIX0VSUk9SLmVycm9yID0gZXJyb3I7XG4gICAgcmV0dXJuIFRSWV9DQVRDSF9FUlJPUjtcbiAgfVxufVxuXG5mdW5jdGlvbiB0cnlUaGVuKHRoZW4kJDEsIHZhbHVlLCBmdWxmaWxsbWVudEhhbmRsZXIsIHJlamVjdGlvbkhhbmRsZXIpIHtcbiAgdHJ5IHtcbiAgICB0aGVuJCQxLmNhbGwodmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUsIHRoZW4kJDEpIHtcbiAgYXNhcChmdW5jdGlvbiAocHJvbWlzZSkge1xuICAgIHZhciBzZWFsZWQgPSBmYWxzZTtcbiAgICB2YXIgZXJyb3IgPSB0cnlUaGVuKHRoZW4kJDEsIHRoZW5hYmxlLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGlmIChzZWFsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VhbGVkID0gdHJ1ZTtcbiAgICAgIGlmICh0aGVuYWJsZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICBpZiAoc2VhbGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNlYWxlZCA9IHRydWU7XG5cbiAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgIH0sICdTZXR0bGU6ICcgKyAocHJvbWlzZS5fbGFiZWwgfHwgJyB1bmtub3duIHByb21pc2UnKSk7XG5cbiAgICBpZiAoIXNlYWxlZCAmJiBlcnJvcikge1xuICAgICAgc2VhbGVkID0gdHJ1ZTtcbiAgICAgIHJlamVjdChwcm9taXNlLCBlcnJvcik7XG4gICAgfVxuICB9LCBwcm9taXNlKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlT3duVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUpIHtcbiAgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gRlVMRklMTEVEKSB7XG4gICAgZnVsZmlsbChwcm9taXNlLCB0aGVuYWJsZS5fcmVzdWx0KTtcbiAgfSBlbHNlIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IFJFSkVDVEVEKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuICB9IGVsc2Uge1xuICAgIHN1YnNjcmliZSh0aGVuYWJsZSwgdW5kZWZpbmVkLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICByZXR1cm4gcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuJCQxKSB7XG4gIGlmIChtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yID09PSBwcm9taXNlLmNvbnN0cnVjdG9yICYmIHRoZW4kJDEgPT09IHRoZW4gJiYgbWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3Rvci5yZXNvbHZlID09PSByZXNvbHZlJDEpIHtcbiAgICBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAodGhlbiQkMSA9PT0gVFJZX0NBVENIX0VSUk9SKSB7XG4gICAgICByZWplY3QocHJvbWlzZSwgVFJZX0NBVENIX0VSUk9SLmVycm9yKTtcbiAgICAgIFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IG51bGw7XG4gICAgfSBlbHNlIGlmICh0aGVuJCQxID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG4gICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoZW4kJDEpKSB7XG4gICAgICBoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSwgdGhlbiQkMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpIHtcbiAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHNlbGZGdWxmaWxsbWVudCgpKTtcbiAgfSBlbHNlIGlmIChvYmplY3RPckZ1bmN0aW9uKHZhbHVlKSkge1xuICAgIGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgdmFsdWUsIGdldFRoZW4odmFsdWUpKTtcbiAgfSBlbHNlIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwdWJsaXNoUmVqZWN0aW9uKHByb21pc2UpIHtcbiAgaWYgKHByb21pc2UuX29uZXJyb3IpIHtcbiAgICBwcm9taXNlLl9vbmVycm9yKHByb21pc2UuX3Jlc3VsdCk7XG4gIH1cblxuICBwdWJsaXNoKHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBmdWxmaWxsKHByb21pc2UsIHZhbHVlKSB7XG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHByb21pc2UuX3Jlc3VsdCA9IHZhbHVlO1xuICBwcm9taXNlLl9zdGF0ZSA9IEZVTEZJTExFRDtcblxuICBpZiAocHJvbWlzZS5fc3Vic2NyaWJlcnMubGVuZ3RoICE9PSAwKSB7XG4gICAgYXNhcChwdWJsaXNoLCBwcm9taXNlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZWplY3QocHJvbWlzZSwgcmVhc29uKSB7XG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIHJldHVybjtcbiAgfVxuICBwcm9taXNlLl9zdGF0ZSA9IFJFSkVDVEVEO1xuICBwcm9taXNlLl9yZXN1bHQgPSByZWFzb247XG5cbiAgYXNhcChwdWJsaXNoUmVqZWN0aW9uLCBwcm9taXNlKTtcbn1cblxuZnVuY3Rpb24gc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG4gIHZhciBfc3Vic2NyaWJlcnMgPSBwYXJlbnQuX3N1YnNjcmliZXJzO1xuICB2YXIgbGVuZ3RoID0gX3N1YnNjcmliZXJzLmxlbmd0aDtcblxuXG4gIHBhcmVudC5fb25lcnJvciA9IG51bGw7XG5cbiAgX3N1YnNjcmliZXJzW2xlbmd0aF0gPSBjaGlsZDtcbiAgX3N1YnNjcmliZXJzW2xlbmd0aCArIEZVTEZJTExFRF0gPSBvbkZ1bGZpbGxtZW50O1xuICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgUkVKRUNURURdID0gb25SZWplY3Rpb247XG5cbiAgaWYgKGxlbmd0aCA9PT0gMCAmJiBwYXJlbnQuX3N0YXRlKSB7XG4gICAgYXNhcChwdWJsaXNoLCBwYXJlbnQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2gocHJvbWlzZSkge1xuICB2YXIgc3Vic2NyaWJlcnMgPSBwcm9taXNlLl9zdWJzY3JpYmVycztcbiAgdmFyIHNldHRsZWQgPSBwcm9taXNlLl9zdGF0ZTtcblxuICBpZiAoc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNoaWxkID0gdm9pZCAwLFxuICAgICAgY2FsbGJhY2sgPSB2b2lkIDAsXG4gICAgICBkZXRhaWwgPSBwcm9taXNlLl9yZXN1bHQ7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJzY3JpYmVycy5sZW5ndGg7IGkgKz0gMykge1xuICAgIGNoaWxkID0gc3Vic2NyaWJlcnNbaV07XG4gICAgY2FsbGJhY2sgPSBzdWJzY3JpYmVyc1tpICsgc2V0dGxlZF07XG5cbiAgICBpZiAoY2hpbGQpIHtcbiAgICAgIGludm9rZUNhbGxiYWNrKHNldHRsZWQsIGNoaWxkLCBjYWxsYmFjaywgZGV0YWlsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FsbGJhY2soZGV0YWlsKTtcbiAgICB9XG4gIH1cblxuICBwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggPSAwO1xufVxuXG5mdW5jdGlvbiB0cnlDYXRjaChjYWxsYmFjaywgZGV0YWlsKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrKGRldGFpbCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBUUllfQ0FUQ0hfRVJST1IuZXJyb3IgPSBlO1xuICAgIHJldHVybiBUUllfQ0FUQ0hfRVJST1I7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW52b2tlQ2FsbGJhY2soc2V0dGxlZCwgcHJvbWlzZSwgY2FsbGJhY2ssIGRldGFpbCkge1xuICB2YXIgaGFzQ2FsbGJhY2sgPSBpc0Z1bmN0aW9uKGNhbGxiYWNrKSxcbiAgICAgIHZhbHVlID0gdm9pZCAwLFxuICAgICAgZXJyb3IgPSB2b2lkIDAsXG4gICAgICBzdWNjZWVkZWQgPSB2b2lkIDAsXG4gICAgICBmYWlsZWQgPSB2b2lkIDA7XG5cbiAgaWYgKGhhc0NhbGxiYWNrKSB7XG4gICAgdmFsdWUgPSB0cnlDYXRjaChjYWxsYmFjaywgZGV0YWlsKTtcblxuICAgIGlmICh2YWx1ZSA9PT0gVFJZX0NBVENIX0VSUk9SKSB7XG4gICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgZXJyb3IgPSB2YWx1ZS5lcnJvcjtcbiAgICAgIHZhbHVlLmVycm9yID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VjY2VlZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCBjYW5ub3RSZXR1cm5Pd24oKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhbHVlID0gZGV0YWlsO1xuICAgIHN1Y2NlZWRlZCA9IHRydWU7XG4gIH1cblxuICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICAvLyBub29wXG4gIH0gZWxzZSBpZiAoaGFzQ2FsbGJhY2sgJiYgc3VjY2VlZGVkKSB7XG4gICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gIH0gZWxzZSBpZiAoZmFpbGVkKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcbiAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBGVUxGSUxMRUQpIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBSRUpFQ1RFRCkge1xuICAgIHJlamVjdChwcm9taXNlLCB2YWx1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdGlhbGl6ZVByb21pc2UocHJvbWlzZSwgcmVzb2x2ZXIpIHtcbiAgdHJ5IHtcbiAgICByZXNvbHZlcihmdW5jdGlvbiByZXNvbHZlUHJvbWlzZSh2YWx1ZSkge1xuICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gICAgfSwgZnVuY3Rpb24gcmVqZWN0UHJvbWlzZShyZWFzb24pIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIGUpO1xuICB9XG59XG5cbnZhciBpZCA9IDA7XG5mdW5jdGlvbiBuZXh0SWQoKSB7XG4gIHJldHVybiBpZCsrO1xufVxuXG5mdW5jdGlvbiBtYWtlUHJvbWlzZShwcm9taXNlKSB7XG4gIHByb21pc2VbUFJPTUlTRV9JRF0gPSBpZCsrO1xuICBwcm9taXNlLl9zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgcHJvbWlzZS5fcmVzdWx0ID0gdW5kZWZpbmVkO1xuICBwcm9taXNlLl9zdWJzY3JpYmVycyA9IFtdO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0aW9uRXJyb3IoKSB7XG4gIHJldHVybiBuZXcgRXJyb3IoJ0FycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheScpO1xufVxuXG52YXIgRW51bWVyYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRW51bWVyYXRvcihDb25zdHJ1Y3RvciwgaW5wdXQpIHtcbiAgICB0aGlzLl9pbnN0YW5jZUNvbnN0cnVjdG9yID0gQ29uc3RydWN0b3I7XG4gICAgdGhpcy5wcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuXG4gICAgaWYgKCF0aGlzLnByb21pc2VbUFJPTUlTRV9JRF0pIHtcbiAgICAgIG1ha2VQcm9taXNlKHRoaXMucHJvbWlzZSk7XG4gICAgfVxuXG4gICAgaWYgKGlzQXJyYXkoaW5wdXQpKSB7XG4gICAgICB0aGlzLmxlbmd0aCA9IGlucHV0Lmxlbmd0aDtcbiAgICAgIHRoaXMuX3JlbWFpbmluZyA9IGlucHV0Lmxlbmd0aDtcblxuICAgICAgdGhpcy5fcmVzdWx0ID0gbmV3IEFycmF5KHRoaXMubGVuZ3RoKTtcblxuICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGZ1bGZpbGwodGhpcy5wcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLmxlbmd0aCB8fCAwO1xuICAgICAgICB0aGlzLl9lbnVtZXJhdGUoaW5wdXQpO1xuICAgICAgICBpZiAodGhpcy5fcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVqZWN0KHRoaXMucHJvbWlzZSwgdmFsaWRhdGlvbkVycm9yKCkpO1xuICAgIH1cbiAgfVxuXG4gIEVudW1lcmF0b3IucHJvdG90eXBlLl9lbnVtZXJhdGUgPSBmdW5jdGlvbiBfZW51bWVyYXRlKGlucHV0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IHRoaXMuX3N0YXRlID09PSBQRU5ESU5HICYmIGkgPCBpbnB1dC5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5fZWFjaEVudHJ5KGlucHV0W2ldLCBpKTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VhY2hFbnRyeSA9IGZ1bmN0aW9uIF9lYWNoRW50cnkoZW50cnksIGkpIHtcbiAgICB2YXIgYyA9IHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3I7XG4gICAgdmFyIHJlc29sdmUkJDEgPSBjLnJlc29sdmU7XG5cblxuICAgIGlmIChyZXNvbHZlJCQxID09PSByZXNvbHZlJDEpIHtcbiAgICAgIHZhciBfdGhlbiA9IGdldFRoZW4oZW50cnkpO1xuXG4gICAgICBpZiAoX3RoZW4gPT09IHRoZW4gJiYgZW50cnkuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgICAgIHRoaXMuX3NldHRsZWRBdChlbnRyeS5fc3RhdGUsIGksIGVudHJ5Ll9yZXN1bHQpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgX3RoZW4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG4gICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IGVudHJ5O1xuICAgICAgfSBlbHNlIGlmIChjID09PSBQcm9taXNlJDEpIHtcbiAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgYyhub29wKTtcbiAgICAgICAgaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBlbnRyeSwgX3RoZW4pO1xuICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQocHJvbWlzZSwgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQobmV3IGMoZnVuY3Rpb24gKHJlc29sdmUkJDEpIHtcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZSQkMShlbnRyeSk7XG4gICAgICAgIH0pLCBpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KHJlc29sdmUkJDEoZW50cnkpLCBpKTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX3NldHRsZWRBdCA9IGZ1bmN0aW9uIF9zZXR0bGVkQXQoc3RhdGUsIGksIHZhbHVlKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG5cblxuICAgIGlmIChwcm9taXNlLl9zdGF0ZSA9PT0gUEVORElORykge1xuICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICAgICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX3dpbGxTZXR0bGVBdCA9IGZ1bmN0aW9uIF93aWxsU2V0dGxlQXQocHJvbWlzZSwgaSkge1xuICAgIHZhciBlbnVtZXJhdG9yID0gdGhpcztcblxuICAgIHN1YnNjcmliZShwcm9taXNlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGVudW1lcmF0b3IuX3NldHRsZWRBdChGVUxGSUxMRUQsIGksIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICByZXR1cm4gZW51bWVyYXRvci5fc2V0dGxlZEF0KFJFSkVDVEVELCBpLCByZWFzb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBFbnVtZXJhdG9yO1xufSgpO1xuXG4vKipcbiAgYFByb21pc2UuYWxsYCBhY2NlcHRzIGFuIGFycmF5IG9mIHByb21pc2VzLCBhbmQgcmV0dXJucyBhIG5ldyBwcm9taXNlIHdoaWNoXG4gIGlzIGZ1bGZpbGxlZCB3aXRoIGFuIGFycmF5IG9mIGZ1bGZpbGxtZW50IHZhbHVlcyBmb3IgdGhlIHBhc3NlZCBwcm9taXNlcywgb3JcbiAgcmVqZWN0ZWQgd2l0aCB0aGUgcmVhc29uIG9mIHRoZSBmaXJzdCBwYXNzZWQgcHJvbWlzZSB0byBiZSByZWplY3RlZC4gSXQgY2FzdHMgYWxsXG4gIGVsZW1lbnRzIG9mIHRoZSBwYXNzZWQgaXRlcmFibGUgdG8gcHJvbWlzZXMgYXMgaXQgcnVucyB0aGlzIGFsZ29yaXRobS5cblxuICBFeGFtcGxlOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gcmVzb2x2ZSgxKTtcbiAgbGV0IHByb21pc2UyID0gcmVzb2x2ZSgyKTtcbiAgbGV0IHByb21pc2UzID0gcmVzb2x2ZSgzKTtcbiAgbGV0IHByb21pc2VzID0gWyBwcm9taXNlMSwgcHJvbWlzZTIsIHByb21pc2UzIF07XG5cbiAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYXJyYXkpe1xuICAgIC8vIFRoZSBhcnJheSBoZXJlIHdvdWxkIGJlIFsgMSwgMiwgMyBdO1xuICB9KTtcbiAgYGBgXG5cbiAgSWYgYW55IG9mIHRoZSBgcHJvbWlzZXNgIGdpdmVuIHRvIGBhbGxgIGFyZSByZWplY3RlZCwgdGhlIGZpcnN0IHByb21pc2VcbiAgdGhhdCBpcyByZWplY3RlZCB3aWxsIGJlIGdpdmVuIGFzIGFuIGFyZ3VtZW50IHRvIHRoZSByZXR1cm5lZCBwcm9taXNlcydzXG4gIHJlamVjdGlvbiBoYW5kbGVyLiBGb3IgZXhhbXBsZTpcblxuICBFeGFtcGxlOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gcmVzb2x2ZSgxKTtcbiAgbGV0IHByb21pc2UyID0gcmVqZWN0KG5ldyBFcnJvcihcIjJcIikpO1xuICBsZXQgcHJvbWlzZTMgPSByZWplY3QobmV3IEVycm9yKFwiM1wiKSk7XG4gIGxldCBwcm9taXNlcyA9IFsgcHJvbWlzZTEsIHByb21pc2UyLCBwcm9taXNlMyBdO1xuXG4gIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKGFycmF5KXtcbiAgICAvLyBDb2RlIGhlcmUgbmV2ZXIgcnVucyBiZWNhdXNlIHRoZXJlIGFyZSByZWplY3RlZCBwcm9taXNlcyFcbiAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAvLyBlcnJvci5tZXNzYWdlID09PSBcIjJcIlxuICB9KTtcbiAgYGBgXG5cbiAgQG1ldGhvZCBhbGxcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FycmF5fSBlbnRyaWVzIGFycmF5IG9mIHByb21pc2VzXG4gIEBwYXJhbSB7U3RyaW5nfSBsYWJlbCBvcHRpb25hbCBzdHJpbmcgZm9yIGxhYmVsaW5nIHRoZSBwcm9taXNlLlxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgdGhhdCBpcyBmdWxmaWxsZWQgd2hlbiBhbGwgYHByb21pc2VzYCBoYXZlIGJlZW5cbiAgZnVsZmlsbGVkLCBvciByZWplY3RlZCBpZiBhbnkgb2YgdGhlbSBiZWNvbWUgcmVqZWN0ZWQuXG4gIEBzdGF0aWNcbiovXG5mdW5jdGlvbiBhbGwoZW50cmllcykge1xuICByZXR1cm4gbmV3IEVudW1lcmF0b3IodGhpcywgZW50cmllcykucHJvbWlzZTtcbn1cblxuLyoqXG4gIGBQcm9taXNlLnJhY2VgIHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aGljaCBpcyBzZXR0bGVkIGluIHRoZSBzYW1lIHdheSBhcyB0aGVcbiAgZmlyc3QgcGFzc2VkIHByb21pc2UgdG8gc2V0dGxlLlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlc29sdmUoJ3Byb21pc2UgMScpO1xuICAgIH0sIDIwMCk7XG4gIH0pO1xuXG4gIGxldCBwcm9taXNlMiA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAyJyk7XG4gICAgfSwgMTAwKTtcbiAgfSk7XG5cbiAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gcmVzdWx0ID09PSAncHJvbWlzZSAyJyBiZWNhdXNlIGl0IHdhcyByZXNvbHZlZCBiZWZvcmUgcHJvbWlzZTFcbiAgICAvLyB3YXMgcmVzb2x2ZWQuXG4gIH0pO1xuICBgYGBcblxuICBgUHJvbWlzZS5yYWNlYCBpcyBkZXRlcm1pbmlzdGljIGluIHRoYXQgb25seSB0aGUgc3RhdGUgb2YgdGhlIGZpcnN0XG4gIHNldHRsZWQgcHJvbWlzZSBtYXR0ZXJzLiBGb3IgZXhhbXBsZSwgZXZlbiBpZiBvdGhlciBwcm9taXNlcyBnaXZlbiB0byB0aGVcbiAgYHByb21pc2VzYCBhcnJheSBhcmd1bWVudCBhcmUgcmVzb2x2ZWQsIGJ1dCB0aGUgZmlyc3Qgc2V0dGxlZCBwcm9taXNlIGhhc1xuICBiZWNvbWUgcmVqZWN0ZWQgYmVmb3JlIHRoZSBvdGhlciBwcm9taXNlcyBiZWNhbWUgZnVsZmlsbGVkLCB0aGUgcmV0dXJuZWRcbiAgcHJvbWlzZSB3aWxsIGJlY29tZSByZWplY3RlZDpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAxJyk7XG4gICAgfSwgMjAwKTtcbiAgfSk7XG5cbiAgbGV0IHByb21pc2UyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZWplY3QobmV3IEVycm9yKCdwcm9taXNlIDInKSk7XG4gICAgfSwgMTAwKTtcbiAgfSk7XG5cbiAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gQ29kZSBoZXJlIG5ldmVyIHJ1bnNcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ3Byb21pc2UgMicgYmVjYXVzZSBwcm9taXNlIDIgYmVjYW1lIHJlamVjdGVkIGJlZm9yZVxuICAgIC8vIHByb21pc2UgMSBiZWNhbWUgZnVsZmlsbGVkXG4gIH0pO1xuICBgYGBcblxuICBBbiBleGFtcGxlIHJlYWwtd29ybGQgdXNlIGNhc2UgaXMgaW1wbGVtZW50aW5nIHRpbWVvdXRzOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgUHJvbWlzZS5yYWNlKFthamF4KCdmb28uanNvbicpLCB0aW1lb3V0KDUwMDApXSlcbiAgYGBgXG5cbiAgQG1ldGhvZCByYWNlXG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBcnJheX0gcHJvbWlzZXMgYXJyYXkgb2YgcHJvbWlzZXMgdG8gb2JzZXJ2ZVxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB3aGljaCBzZXR0bGVzIGluIHRoZSBzYW1lIHdheSBhcyB0aGUgZmlyc3QgcGFzc2VkXG4gIHByb21pc2UgdG8gc2V0dGxlLlxuKi9cbmZ1bmN0aW9uIHJhY2UoZW50cmllcykge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG4gIGlmICghaXNBcnJheShlbnRyaWVzKSkge1xuICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24gKF8sIHJlamVjdCkge1xuICAgICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGFuIGFycmF5IHRvIHJhY2UuJykpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGVudHJpZXMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKGVudHJpZXNbaV0pLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAgYFByb21pc2UucmVqZWN0YCByZXR1cm5zIGEgcHJvbWlzZSByZWplY3RlZCB3aXRoIHRoZSBwYXNzZWQgYHJlYXNvbmAuXG4gIEl0IGlzIHNob3J0aGFuZCBmb3IgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICByZWplY3QobmV3IEVycm9yKCdXSE9PUFMnKSk7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gQ29kZSBoZXJlIGRvZXNuJ3QgcnVuIGJlY2F1c2UgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQhXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdXSE9PUFMnXG4gIH0pO1xuICBgYGBcblxuICBJbnN0ZWFkIG9mIHdyaXRpbmcgdGhlIGFib3ZlLCB5b3VyIGNvZGUgbm93IHNpbXBseSBiZWNvbWVzIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignV0hPT1BTJykpO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gQ29kZSBoZXJlIGRvZXNuJ3QgcnVuIGJlY2F1c2UgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQhXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdXSE9PUFMnXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIHJlamVjdFxuICBAc3RhdGljXG4gIEBwYXJhbSB7QW55fSByZWFzb24gdmFsdWUgdGhhdCB0aGUgcmV0dXJuZWQgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGguXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHJlamVjdGVkIHdpdGggdGhlIGdpdmVuIGByZWFzb25gLlxuKi9cbmZ1bmN0aW9uIHJlamVjdCQxKHJlYXNvbikge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcbiAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5mdW5jdGlvbiBuZWVkc1Jlc29sdmVyKCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGEgcmVzb2x2ZXIgZnVuY3Rpb24gYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yJyk7XG59XG5cbmZ1bmN0aW9uIG5lZWRzTmV3KCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmFpbGVkIHRvIGNvbnN0cnVjdCAnUHJvbWlzZSc6IFBsZWFzZSB1c2UgdGhlICduZXcnIG9wZXJhdG9yLCB0aGlzIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uXCIpO1xufVxuXG4vKipcbiAgUHJvbWlzZSBvYmplY3RzIHJlcHJlc2VudCB0aGUgZXZlbnR1YWwgcmVzdWx0IG9mIGFuIGFzeW5jaHJvbm91cyBvcGVyYXRpb24uIFRoZVxuICBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLCB3aGljaFxuICByZWdpc3RlcnMgY2FsbGJhY2tzIHRvIHJlY2VpdmUgZWl0aGVyIGEgcHJvbWlzZSdzIGV2ZW50dWFsIHZhbHVlIG9yIHRoZSByZWFzb25cbiAgd2h5IHRoZSBwcm9taXNlIGNhbm5vdCBiZSBmdWxmaWxsZWQuXG5cbiAgVGVybWlub2xvZ3lcbiAgLS0tLS0tLS0tLS1cblxuICAtIGBwcm9taXNlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gd2l0aCBhIGB0aGVuYCBtZXRob2Qgd2hvc2UgYmVoYXZpb3IgY29uZm9ybXMgdG8gdGhpcyBzcGVjaWZpY2F0aW9uLlxuICAtIGB0aGVuYWJsZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGVmaW5lcyBhIGB0aGVuYCBtZXRob2QuXG4gIC0gYHZhbHVlYCBpcyBhbnkgbGVnYWwgSmF2YVNjcmlwdCB2YWx1ZSAoaW5jbHVkaW5nIHVuZGVmaW5lZCwgYSB0aGVuYWJsZSwgb3IgYSBwcm9taXNlKS5cbiAgLSBgZXhjZXB0aW9uYCBpcyBhIHZhbHVlIHRoYXQgaXMgdGhyb3duIHVzaW5nIHRoZSB0aHJvdyBzdGF0ZW1lbnQuXG4gIC0gYHJlYXNvbmAgaXMgYSB2YWx1ZSB0aGF0IGluZGljYXRlcyB3aHkgYSBwcm9taXNlIHdhcyByZWplY3RlZC5cbiAgLSBgc2V0dGxlZGAgdGhlIGZpbmFsIHJlc3Rpbmcgc3RhdGUgb2YgYSBwcm9taXNlLCBmdWxmaWxsZWQgb3IgcmVqZWN0ZWQuXG5cbiAgQSBwcm9taXNlIGNhbiBiZSBpbiBvbmUgb2YgdGhyZWUgc3RhdGVzOiBwZW5kaW5nLCBmdWxmaWxsZWQsIG9yIHJlamVjdGVkLlxuXG4gIFByb21pc2VzIHRoYXQgYXJlIGZ1bGZpbGxlZCBoYXZlIGEgZnVsZmlsbG1lbnQgdmFsdWUgYW5kIGFyZSBpbiB0aGUgZnVsZmlsbGVkXG4gIHN0YXRlLiAgUHJvbWlzZXMgdGhhdCBhcmUgcmVqZWN0ZWQgaGF2ZSBhIHJlamVjdGlvbiByZWFzb24gYW5kIGFyZSBpbiB0aGVcbiAgcmVqZWN0ZWQgc3RhdGUuICBBIGZ1bGZpbGxtZW50IHZhbHVlIGlzIG5ldmVyIGEgdGhlbmFibGUuXG5cbiAgUHJvbWlzZXMgY2FuIGFsc28gYmUgc2FpZCB0byAqcmVzb2x2ZSogYSB2YWx1ZS4gIElmIHRoaXMgdmFsdWUgaXMgYWxzbyBhXG4gIHByb21pc2UsIHRoZW4gdGhlIG9yaWdpbmFsIHByb21pc2UncyBzZXR0bGVkIHN0YXRlIHdpbGwgbWF0Y2ggdGhlIHZhbHVlJ3NcbiAgc2V0dGxlZCBzdGF0ZS4gIFNvIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgcmVqZWN0cyB3aWxsXG4gIGl0c2VsZiByZWplY3QsIGFuZCBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHdpbGxcbiAgaXRzZWxmIGZ1bGZpbGwuXG5cblxuICBCYXNpYyBVc2FnZTpcbiAgLS0tLS0tLS0tLS0tXG5cbiAgYGBganNcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAvLyBvbiBzdWNjZXNzXG4gICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAvLyBvbiBmYWlsdXJlXG4gICAgcmVqZWN0KHJlYXNvbik7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgIC8vIG9uIGZ1bGZpbGxtZW50XG4gIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgIC8vIG9uIHJlamVjdGlvblxuICB9KTtcbiAgYGBgXG5cbiAgQWR2YW5jZWQgVXNhZ2U6XG4gIC0tLS0tLS0tLS0tLS0tLVxuXG4gIFByb21pc2VzIHNoaW5lIHdoZW4gYWJzdHJhY3RpbmcgYXdheSBhc3luY2hyb25vdXMgaW50ZXJhY3Rpb25zIHN1Y2ggYXNcbiAgYFhNTEh0dHBSZXF1ZXN0YHMuXG5cbiAgYGBganNcbiAgZnVuY3Rpb24gZ2V0SlNPTih1cmwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gaGFuZGxlcjtcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XG4gICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgIHhoci5zZW5kKCk7XG5cbiAgICAgIGZ1bmN0aW9uIGhhbmRsZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuRE9ORSkge1xuICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdnZXRKU09OOiBgJyArIHVybCArICdgIGZhaWxlZCB3aXRoIHN0YXR1czogWycgKyB0aGlzLnN0YXR1cyArICddJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldEpTT04oJy9wb3N0cy5qc29uJykudGhlbihmdW5jdGlvbihqc29uKSB7XG4gICAgLy8gb24gZnVsZmlsbG1lbnRcbiAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgLy8gb24gcmVqZWN0aW9uXG4gIH0pO1xuICBgYGBcblxuICBVbmxpa2UgY2FsbGJhY2tzLCBwcm9taXNlcyBhcmUgZ3JlYXQgY29tcG9zYWJsZSBwcmltaXRpdmVzLlxuXG4gIGBgYGpzXG4gIFByb21pc2UuYWxsKFtcbiAgICBnZXRKU09OKCcvcG9zdHMnKSxcbiAgICBnZXRKU09OKCcvY29tbWVudHMnKVxuICBdKS50aGVuKGZ1bmN0aW9uKHZhbHVlcyl7XG4gICAgdmFsdWVzWzBdIC8vID0+IHBvc3RzSlNPTlxuICAgIHZhbHVlc1sxXSAvLyA9PiBjb21tZW50c0pTT05cblxuICAgIHJldHVybiB2YWx1ZXM7XG4gIH0pO1xuICBgYGBcblxuICBAY2xhc3MgUHJvbWlzZVxuICBAcGFyYW0ge0Z1bmN0aW9ufSByZXNvbHZlclxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEBjb25zdHJ1Y3RvclxuKi9cblxudmFyIFByb21pc2UkMSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICAgIHRoaXNbUFJPTUlTRV9JRF0gPSBuZXh0SWQoKTtcbiAgICB0aGlzLl9yZXN1bHQgPSB0aGlzLl9zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9zdWJzY3JpYmVycyA9IFtdO1xuXG4gICAgaWYgKG5vb3AgIT09IHJlc29sdmVyKSB7XG4gICAgICB0eXBlb2YgcmVzb2x2ZXIgIT09ICdmdW5jdGlvbicgJiYgbmVlZHNSZXNvbHZlcigpO1xuICAgICAgdGhpcyBpbnN0YW5jZW9mIFByb21pc2UgPyBpbml0aWFsaXplUHJvbWlzZSh0aGlzLCByZXNvbHZlcikgOiBuZWVkc05ldygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICBUaGUgcHJpbWFyeSB3YXkgb2YgaW50ZXJhY3Rpbmcgd2l0aCBhIHByb21pc2UgaXMgdGhyb3VnaCBpdHMgYHRoZW5gIG1ldGhvZCxcbiAgd2hpY2ggcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGVcbiAgcmVhc29uIHdoeSB0aGUgcHJvbWlzZSBjYW5ub3QgYmUgZnVsZmlsbGVkLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpe1xuICAgIC8vIHVzZXIgaXMgYXZhaWxhYmxlXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gdXNlciBpcyB1bmF2YWlsYWJsZSwgYW5kIHlvdSBhcmUgZ2l2ZW4gdGhlIHJlYXNvbiB3aHlcbiAgfSk7XG4gIGBgYFxuICAgQ2hhaW5pbmdcbiAgLS0tLS0tLS1cbiAgIFRoZSByZXR1cm4gdmFsdWUgb2YgYHRoZW5gIGlzIGl0c2VsZiBhIHByb21pc2UuICBUaGlzIHNlY29uZCwgJ2Rvd25zdHJlYW0nXG4gIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmaXJzdCBwcm9taXNlJ3MgZnVsZmlsbG1lbnRcbiAgb3IgcmVqZWN0aW9uIGhhbmRsZXIsIG9yIHJlamVjdGVkIGlmIHRoZSBoYW5kbGVyIHRocm93cyBhbiBleGNlcHRpb24uXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gdXNlci5uYW1lO1xuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgcmV0dXJuICdkZWZhdWx0IG5hbWUnO1xuICB9KS50aGVuKGZ1bmN0aW9uICh1c2VyTmFtZSkge1xuICAgIC8vIElmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgdXNlck5hbWVgIHdpbGwgYmUgdGhlIHVzZXIncyBuYW1lLCBvdGhlcndpc2UgaXRcbiAgICAvLyB3aWxsIGJlIGAnZGVmYXVsdCBuYW1lJ2BcbiAgfSk7XG4gICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZvdW5kIHVzZXIsIGJ1dCBzdGlsbCB1bmhhcHB5Jyk7XG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknKTtcbiAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAvLyBuZXZlciByZWFjaGVkXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBpZiBgZmluZFVzZXJgIGZ1bGZpbGxlZCwgYHJlYXNvbmAgd2lsbCBiZSAnRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknLlxuICAgIC8vIElmIGBmaW5kVXNlcmAgcmVqZWN0ZWQsIGByZWFzb25gIHdpbGwgYmUgJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknLlxuICB9KTtcbiAgYGBgXG4gIElmIHRoZSBkb3duc3RyZWFtIHByb21pc2UgZG9lcyBub3Qgc3BlY2lmeSBhIHJlamVjdGlvbiBoYW5kbGVyLCByZWplY3Rpb24gcmVhc29ucyB3aWxsIGJlIHByb3BhZ2F0ZWQgZnVydGhlciBkb3duc3RyZWFtLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgdGhyb3cgbmV3IFBlZGFnb2dpY2FsRXhjZXB0aW9uKCdVcHN0cmVhbSBlcnJvcicpO1xuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAvLyBuZXZlciByZWFjaGVkXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBUaGUgYFBlZGdhZ29jaWFsRXhjZXB0aW9uYCBpcyBwcm9wYWdhdGVkIGFsbCB0aGUgd2F5IGRvd24gdG8gaGVyZVxuICB9KTtcbiAgYGBgXG4gICBBc3NpbWlsYXRpb25cbiAgLS0tLS0tLS0tLS0tXG4gICBTb21ldGltZXMgdGhlIHZhbHVlIHlvdSB3YW50IHRvIHByb3BhZ2F0ZSB0byBhIGRvd25zdHJlYW0gcHJvbWlzZSBjYW4gb25seSBiZVxuICByZXRyaWV2ZWQgYXN5bmNocm9ub3VzbHkuIFRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJldHVybmluZyBhIHByb21pc2UgaW4gdGhlXG4gIGZ1bGZpbGxtZW50IG9yIHJlamVjdGlvbiBoYW5kbGVyLiBUaGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgdGhlbiBiZSBwZW5kaW5nXG4gIHVudGlsIHRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHNldHRsZWQuIFRoaXMgaXMgY2FsbGVkICphc3NpbWlsYXRpb24qLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuICB9KS50aGVuKGZ1bmN0aW9uIChjb21tZW50cykge1xuICAgIC8vIFRoZSB1c2VyJ3MgY29tbWVudHMgYXJlIG5vdyBhdmFpbGFibGVcbiAgfSk7XG4gIGBgYFxuICAgSWYgdGhlIGFzc2ltbGlhdGVkIHByb21pc2UgcmVqZWN0cywgdGhlbiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgYWxzbyByZWplY3QuXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG4gICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCBmdWxmaWxscywgd2UnbGwgaGF2ZSB0aGUgdmFsdWUgaGVyZVxuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCByZWplY3RzLCB3ZSdsbCBoYXZlIHRoZSByZWFzb24gaGVyZVxuICB9KTtcbiAgYGBgXG4gICBTaW1wbGUgRXhhbXBsZVxuICAtLS0tLS0tLS0tLS0tLVxuICAgU3luY2hyb25vdXMgRXhhbXBsZVxuICAgYGBgamF2YXNjcmlwdFxuICBsZXQgcmVzdWx0O1xuICAgdHJ5IHtcbiAgICByZXN1bHQgPSBmaW5kUmVzdWx0KCk7XG4gICAgLy8gc3VjY2Vzc1xuICB9IGNhdGNoKHJlYXNvbikge1xuICAgIC8vIGZhaWx1cmVcbiAgfVxuICBgYGBcbiAgIEVycmJhY2sgRXhhbXBsZVxuICAgYGBganNcbiAgZmluZFJlc3VsdChmdW5jdGlvbihyZXN1bHQsIGVycil7XG4gICAgaWYgKGVycikge1xuICAgICAgLy8gZmFpbHVyZVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzdWNjZXNzXG4gICAgfVxuICB9KTtcbiAgYGBgXG4gICBQcm9taXNlIEV4YW1wbGU7XG4gICBgYGBqYXZhc2NyaXB0XG4gIGZpbmRSZXN1bHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gc3VjY2Vzc1xuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIGZhaWx1cmVcbiAgfSk7XG4gIGBgYFxuICAgQWR2YW5jZWQgRXhhbXBsZVxuICAtLS0tLS0tLS0tLS0tLVxuICAgU3luY2hyb25vdXMgRXhhbXBsZVxuICAgYGBgamF2YXNjcmlwdFxuICBsZXQgYXV0aG9yLCBib29rcztcbiAgIHRyeSB7XG4gICAgYXV0aG9yID0gZmluZEF1dGhvcigpO1xuICAgIGJvb2tzICA9IGZpbmRCb29rc0J5QXV0aG9yKGF1dGhvcik7XG4gICAgLy8gc3VjY2Vzc1xuICB9IGNhdGNoKHJlYXNvbikge1xuICAgIC8vIGZhaWx1cmVcbiAgfVxuICBgYGBcbiAgIEVycmJhY2sgRXhhbXBsZVxuICAgYGBganNcbiAgIGZ1bmN0aW9uIGZvdW5kQm9va3MoYm9va3MpIHtcbiAgIH1cbiAgIGZ1bmN0aW9uIGZhaWx1cmUocmVhc29uKSB7XG4gICB9XG4gICBmaW5kQXV0aG9yKGZ1bmN0aW9uKGF1dGhvciwgZXJyKXtcbiAgICBpZiAoZXJyKSB7XG4gICAgICBmYWlsdXJlKGVycik7XG4gICAgICAvLyBmYWlsdXJlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZpbmRCb29va3NCeUF1dGhvcihhdXRob3IsIGZ1bmN0aW9uKGJvb2tzLCBlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBmYWlsdXJlKGVycik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGZvdW5kQm9va3MoYm9va3MpO1xuICAgICAgICAgICAgfSBjYXRjaChyZWFzb24pIHtcbiAgICAgICAgICAgICAgZmFpbHVyZShyZWFzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoKGVycm9yKSB7XG4gICAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgIH1cbiAgICAgIC8vIHN1Y2Nlc3NcbiAgICB9XG4gIH0pO1xuICBgYGBcbiAgIFByb21pc2UgRXhhbXBsZTtcbiAgIGBgYGphdmFzY3JpcHRcbiAgZmluZEF1dGhvcigpLlxuICAgIHRoZW4oZmluZEJvb2tzQnlBdXRob3IpLlxuICAgIHRoZW4oZnVuY3Rpb24oYm9va3Mpe1xuICAgICAgLy8gZm91bmQgYm9va3NcbiAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICB9KTtcbiAgYGBgXG4gICBAbWV0aG9kIHRoZW5cbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25GdWxmaWxsZWRcbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3RlZFxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9XG4gICovXG5cbiAgLyoqXG4gIGBjYXRjaGAgaXMgc2ltcGx5IHN1Z2FyIGZvciBgdGhlbih1bmRlZmluZWQsIG9uUmVqZWN0aW9uKWAgd2hpY2ggbWFrZXMgaXQgdGhlIHNhbWVcbiAgYXMgdGhlIGNhdGNoIGJsb2NrIG9mIGEgdHJ5L2NhdGNoIHN0YXRlbWVudC5cbiAgYGBganNcbiAgZnVuY3Rpb24gZmluZEF1dGhvcigpe1xuICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkbid0IGZpbmQgdGhhdCBhdXRob3InKTtcbiAgfVxuICAvLyBzeW5jaHJvbm91c1xuICB0cnkge1xuICBmaW5kQXV0aG9yKCk7XG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gIH1cbiAgLy8gYXN5bmMgd2l0aCBwcm9taXNlc1xuICBmaW5kQXV0aG9yKCkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgfSk7XG4gIGBgYFxuICBAbWV0aG9kIGNhdGNoXG4gIEBwYXJhbSB7RnVuY3Rpb259IG9uUmVqZWN0aW9uXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX1cbiAgKi9cblxuXG4gIFByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24gX2NhdGNoKG9uUmVqZWN0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGlvbik7XG4gIH07XG5cbiAgLyoqXG4gICAgYGZpbmFsbHlgIHdpbGwgYmUgaW52b2tlZCByZWdhcmRsZXNzIG9mIHRoZSBwcm9taXNlJ3MgZmF0ZSBqdXN0IGFzIG5hdGl2ZVxuICAgIHRyeS9jYXRjaC9maW5hbGx5IGJlaGF2ZXNcbiAgXG4gICAgU3luY2hyb25vdXMgZXhhbXBsZTpcbiAgXG4gICAgYGBganNcbiAgICBmaW5kQXV0aG9yKCkge1xuICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPiAwLjUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IEF1dGhvcigpO1xuICAgIH1cbiAgXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmaW5kQXV0aG9yKCk7IC8vIHN1Y2NlZWQgb3IgZmFpbFxuICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgIHJldHVybiBmaW5kT3RoZXJBdXRoZXIoKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gYWx3YXlzIHJ1bnNcbiAgICAgIC8vIGRvZXNuJ3QgYWZmZWN0IHRoZSByZXR1cm4gdmFsdWVcbiAgICB9XG4gICAgYGBgXG4gIFxuICAgIEFzeW5jaHJvbm91cyBleGFtcGxlOlxuICBcbiAgICBgYGBqc1xuICAgIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAgICAgcmV0dXJuIGZpbmRPdGhlckF1dGhlcigpO1xuICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24oKXtcbiAgICAgIC8vIGF1dGhvciB3YXMgZWl0aGVyIGZvdW5kLCBvciBub3RcbiAgICB9KTtcbiAgICBgYGBcbiAgXG4gICAgQG1ldGhvZCBmaW5hbGx5XG4gICAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAgICBAcmV0dXJuIHtQcm9taXNlfVxuICAqL1xuXG5cbiAgUHJvbWlzZS5wcm90b3R5cGUuZmluYWxseSA9IGZ1bmN0aW9uIF9maW5hbGx5KGNhbGxiYWNrKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzO1xuICAgIHZhciBjb25zdHJ1Y3RvciA9IHByb21pc2UuY29uc3RydWN0b3I7XG5cbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH0pO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5yZXNvbHZlKGNhbGxiYWNrKCkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICB0aHJvdyByZWFzb247XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gUHJvbWlzZTtcbn0oKTtcblxuUHJvbWlzZSQxLnByb3RvdHlwZS50aGVuID0gdGhlbjtcblByb21pc2UkMS5hbGwgPSBhbGw7XG5Qcm9taXNlJDEucmFjZSA9IHJhY2U7XG5Qcm9taXNlJDEucmVzb2x2ZSA9IHJlc29sdmUkMTtcblByb21pc2UkMS5yZWplY3QgPSByZWplY3QkMTtcblByb21pc2UkMS5fc2V0U2NoZWR1bGVyID0gc2V0U2NoZWR1bGVyO1xuUHJvbWlzZSQxLl9zZXRBc2FwID0gc2V0QXNhcDtcblByb21pc2UkMS5fYXNhcCA9IGFzYXA7XG5cbi8qZ2xvYmFsIHNlbGYqL1xuZnVuY3Rpb24gcG9seWZpbGwoKSB7XG4gIHZhciBsb2NhbCA9IHZvaWQgMDtcblxuICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsb2NhbCA9IGdsb2JhbDtcbiAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsb2NhbCA9IHNlbGY7XG4gIH0gZWxzZSB7XG4gICAgdHJ5IHtcbiAgICAgIGxvY2FsID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BvbHlmaWxsIGZhaWxlZCBiZWNhdXNlIGdsb2JhbCBvYmplY3QgaXMgdW5hdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBQID0gbG9jYWwuUHJvbWlzZTtcblxuICBpZiAoUCkge1xuICAgIHZhciBwcm9taXNlVG9TdHJpbmcgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICBwcm9taXNlVG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUC5yZXNvbHZlKCkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIHNpbGVudGx5IGlnbm9yZWRcbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZVRvU3RyaW5nID09PSAnW29iamVjdCBQcm9taXNlXScgJiYgIVAuY2FzdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGxvY2FsLlByb21pc2UgPSBQcm9taXNlJDE7XG59XG5cbi8vIFN0cmFuZ2UgY29tcGF0Li5cblByb21pc2UkMS5wb2x5ZmlsbCA9IHBvbHlmaWxsO1xuUHJvbWlzZSQxLlByb21pc2UgPSBQcm9taXNlJDE7XG5cbnJldHVybiBQcm9taXNlJDE7XG5cbn0pKSk7XG5cblxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1lczYtcHJvbWlzZS5tYXBcbiIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCIvKipcclxuICogQXBwX0NvbW1vbi50c1xyXG4gKlxyXG4gKiBDb21tb24gbG9naWMgZm9yIGVudHJ5cG9pbnRzLlxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIFVJU3RyaW5ncyBmcm9tIFwiLi9VSVN0cmluZ3MvVUlTdHJpbmdzXCI7XHJcbmltcG9ydCBWZXJzaW9uIGZyb20gXCIuL1ZlcnNpb25cIjtcclxuaW1wb3J0ICogYXMgQ29uZmlndXJhdGlvbiBmcm9tIFwiLi9Db25maWd1cmF0aW9uL0NvbmZpZ3VyYXRpb25cIjtcclxuaW1wb3J0ICogYXMgV2luZG93IGZyb20gXCIuL1dpbmRvdy9XaW5kb3dcIjtcclxuaW1wb3J0ICogYXMgTG9nZ2luZyBmcm9tIFwiLi9Mb2dnaW5nL0xvZ2dpbmdcIjtcclxuaW1wb3J0ICogYXMgVGhlbWUgZnJvbSBcIi4vVGhlbWVcIjtcclxuXHJcbmltcG9ydCB7UHJvbWlzZX0gZnJvbSBcImVzNi1wcm9taXNlXCI7XHJcblxyXG5jb25zdCBBUFBfTkFNRTogc3RyaW5nID0gXCJPZmZpY2VGZWVkYmFja1NES1wiO1xyXG5cclxuLyoqXHJcbiAqIEhhcyB0aGUgU0RLIGJlZW4gaW5pdGlhbGl6ZWRcclxuICovXHJcbmxldCBpbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuLyoqXHJcbiAqIExvYWQgdGhlIHN0eWxlIHNoZWV0XHJcbiAqIEBwYXJhbSB1cmwgVGhlIHVybCBvZiB0aGUgc3R5bGVzaGVldFxyXG4gKi9cclxuZnVuY3Rpb24gbG9hZFN0eWxlc2hlZXQodXJsOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHJcblx0bGV0IGxpbms6IEhUTUxMaW5rRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xyXG5cclxuXHRsaW5rLnJlbCA9IFwic3R5bGVzaGVldFwiO1xyXG5cdGxpbmsudHlwZSA9IFwidGV4dC9jc3NcIjtcclxuXHRsaW5rLmhyZWYgPSB1cmw7XHJcblxyXG5cdGxldCBlbnRyeTogSFRNTFNjcmlwdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKVswXTtcclxuXHRlbnRyeS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShsaW5rLCBlbnRyeSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2FkIHRoZSBzY3JpcHQgYW5kIGNhbGxiYWNrIGFmdGVyIGl0IGlzIGxvYWRlZFxyXG4gKiBAcGFyYW0gdXJsIFRoZSB1cmwgb2YgdGhlIHNjcmlwdFxyXG4gKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrXHJcbiAqL1xyXG5mdW5jdGlvbiBsb2FkU2NyaXB0KHVybDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0bGV0IHNjcmlwdDogYW55ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcclxuXHRcdHNjcmlwdC5hc3luYyA9IHRydWU7XHJcblxyXG5cdFx0aWYgKHNjcmlwdC5yZWFkeVN0YXRlKSB7IC8vIElFXHJcblx0XHRcdHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAoc2NyaXB0LnJlYWR5U3RhdGUgPT09IFwibG9hZGVkXCIgfHwgc2NyaXB0LnJlYWR5U3RhdGUgPT09IFwiY29tcGxldGVcIikge1xyXG5cdFx0XHRcdFx0c2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XHJcblx0XHRcdFx0XHRyZXNvbHZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cdFx0fSBlbHNlIHsgIC8vIE90aGVyc1xyXG5cdFx0XHRzY3JpcHQub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cmVzb2x2ZSgpO1xyXG5cdFx0XHR9O1xyXG5cdFx0fVxyXG5cclxuXHRcdHNjcmlwdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJlamVjdCgpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRzY3JpcHQuc3JjID0gdXJsO1xyXG5cdFx0bGV0IGVudHJ5OiBIVE1MU2NyaXB0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpWzBdO1xyXG5cdFx0ZW50cnkucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2NyaXB0LCBlbnRyeSk7XHJcblx0fSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplIGNvbW1vbiBtb2R1bGVzXHJcbiAqIEBwYXJhbSBpbml0T3B0aW9ucyBpbml0IG9wdGlvbnNcclxuICovXHJcbmZ1bmN0aW9uIGluaXRpYWxpemVNb2R1bGVzKGluaXRPcHRpb25zOiBDb25maWd1cmF0aW9uLklJbml0T3B0aW9uc0NvbW1vbik6IHZvaWQge1xyXG5cdExvZ2dpbmcuaW5pdGlhbGl6ZShpbml0T3B0aW9ucy5lbnZpcm9ubWVudCwgQVBQX05BTUUsIFZlcnNpb24sXHJcblx0XHQoaW5pdE9wdGlvbnMudGVsZW1ldHJ5R3JvdXApID8gaW5pdE9wdGlvbnMudGVsZW1ldHJ5R3JvdXAuYXVkaWVuY2VHcm91cCA6IHVuZGVmaW5lZCxcclxuXHRcdGluaXRPcHRpb25zLmFwcElkLnRvU3RyaW5nKCksIGluaXRPcHRpb25zLnNlc3Npb25JZCwgaW5pdE9wdGlvbnMuYnVpbGQpO1xyXG5cdFRoZW1lLmluaXRpYWxpemUoaW5pdE9wdGlvbnMucHJpbWFyeUNvbG91ciwgaW5pdE9wdGlvbnMuc2Vjb25kYXJ5Q29sb3VyKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCB1aSBTdHJpbmdzLlxyXG4gKiBAcGFyYW0gZGF0YSB0aGUgdWkgc3RyaW5nc1xyXG4gKi9cclxuZnVuY3Rpb24gc2V0VUlTdHJpbmdzKGRhdGE6IGFueSk6IHZvaWQge1xyXG5cdFVJU3RyaW5ncy5zZXRVSVN0cmluZ3MoZGF0YSk7XHJcbn07XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemUoKTogUHJvbWlzZTxhbnk+IHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0aWYgKCFpbml0aWFsaXplZCkge1xyXG5cdFx0XHRpZiAoIVdpbmRvdy5nZXQoKS5PZmZpY2VCcm93c2VyRmVlZGJhY2suaW5pdE9wdGlvbnMpIHtcclxuXHRcdFx0XHRyZWplY3QoXCJXaW5kb3cuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmluaXRPcHRpb25zIG5vdCBzZXRcIik7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRXaW5kb3cuZ2V0KCkuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLnNka1ZlcnNpb24gPSBWZXJzaW9uO1xyXG5cclxuXHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5zZXRDb21tb25Jbml0T3B0aW9ucyhXaW5kb3cuZ2V0KCkuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmluaXRPcHRpb25zKTtcclxuXHJcblx0XHRcdGxldCBpbml0T3B0aW9uc0NvbW1vbiA9IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKTtcclxuXHRcdFx0bG9hZFN0eWxlc2hlZXQoaW5pdE9wdGlvbnNDb21tb24uc3R5bGVzVXJsKTtcclxuXHJcblx0XHRcdGxldCBpbnRsRmlsZVVybDogc3RyaW5nID0gaW5pdE9wdGlvbnNDb21tb24uaW50bFVybCArIGluaXRPcHRpb25zQ29tbW9uLmxvY2FsZS50b0xvd2VyQ2FzZSgpICsgXCIvXCIgK1xyXG5cdFx0XHRcdGluaXRPcHRpb25zQ29tbW9uLmludGxGaWxlbmFtZTtcclxuXHJcblx0XHRcdGxvYWRTY3JpcHQoaW50bEZpbGVVcmwpXHJcblx0XHRcdC50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uIG9uTG9hZFNjcmlwdEZ1bGZpbGxlZCgpIHtcclxuXHRcdFx0XHRcdGlmICghVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpKSB7XHJcblx0XHRcdFx0XHRcdHJlamVjdChcIlVpU3RyaW5ncyB3ZXJlIG5vdCBsb2FkZWQgZnJvbSBcIiArIGludGxGaWxlVXJsKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdGluaXRpYWxpemVNb2R1bGVzKGluaXRPcHRpb25zQ29tbW9uKTtcclxuXHRcdFx0XHRcdGluaXRpYWxpemVkID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0XHRyZXNvbHZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHQpLmNhdGNoKFxyXG5cdFx0XHRcdGZ1bmN0aW9uIG9uTG9hZFNjcmlwdFJlamVjdGVkKGVycikge1xyXG5cdFx0XHRcdFx0cmVqZWN0KFwiU2NyaXB0IGxvYWQgZmFpbGVkIGZvciBcIiArIGludGxGaWxlVXJsKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZXNvbHZlKCk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXNldCB0aGUgbW9kdWxlLiBVc2VkIGluIHVuaXQgdGVzdHMuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVzZXQoKSB7XHJcblx0aW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxufVxyXG5cclxuLyogTWFrZSB0aGUgc2V0VUlTdHJpbmdzIG1ldGhvZCBhdmFpbGFibGUgZ2xvYmFsbHkgKi9cclxuV2luZG93LnNldFNldFVpU3RyaW5ncyhzZXRVSVN0cmluZ3MpO1xyXG4iLCIvKipcclxuICogQXBwX0Zsb29kZ2F0ZS50c1xyXG4gKlxyXG4gKiBUaGUgZW50cnkgcG9pbnQgZm9yIGZsb29kZ2F0ZS5cclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBBcHBfQ29tbW9uIGZyb20gXCIuL0FwcF9Db21tb25cIjtcclxuaW1wb3J0ICogYXMgVUkgZnJvbSBcIi4vVUkvVUlcIjtcclxuaW1wb3J0ICogYXMgQ29uZmlndXJhdGlvbiBmcm9tIFwiLi9Db25maWd1cmF0aW9uL0NvbmZpZ3VyYXRpb25cIjtcclxuaW1wb3J0ICogYXMgV2luZG93IGZyb20gXCIuL1dpbmRvdy9XaW5kb3dcIjtcclxuaW1wb3J0IEFkYXB0aXZlU3VydmV5TGF1bmNoZXJGYWN0b3J5IGZyb20gXCIuL0Zsb29kZ2F0ZUNvcmUvQWRhcHRpdmVTdXJ2ZXlMYXVuY2hlckZhY3RvcnlcIjtcclxuaW1wb3J0IEN1c3RvbVVJU3VydmV5IGZyb20gXCIuL0Zsb29kZ2F0ZUNvcmUvVUlTdXJ2ZXkvQ3VzdG9tVUlTdXJ2ZXlcIjtcclxuaW1wb3J0IER1bW15VUlTdXJ2ZXkgZnJvbSBcIi4vRmxvb2RnYXRlQ29yZS9VSVN1cnZleS9EdW1teVVJU3VydmV5XCI7XHJcbmltcG9ydCBGbG9vZGdhdGVFbnZpcm9ubWVudFByb3ZpZGVyIGZyb20gXCIuL0Zsb29kZ2F0ZUNvcmUvRmxvb2RnYXRlRW52aXJvbm1lbnRQcm92aWRlclwiO1xyXG5pbXBvcnQgRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyIGZyb20gXCIuL0Zsb29kZ2F0ZUNvcmUvRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyXCI7XHJcbmltcG9ydCBGbG9vZGdhdGVTdHJpbmdQcm92aWRlciBmcm9tIFwiLi9GbG9vZGdhdGVDb3JlL0Zsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyXCI7XHJcbmltcG9ydCBGbG9vZGdhdGVUZWxlbWV0cnlMb2dnZXIgZnJvbSBcIi4vRmxvb2RnYXRlQ29yZS9GbG9vZGdhdGVUZWxlbWV0cnlMb2dnZXJcIjtcclxuaW1wb3J0IElDdXN0b21TdXJ2ZXkgZnJvbSBcIi4vRmxvb2RnYXRlQ29yZS9JQ3VzdG9tU3VydmV5XCI7XHJcbmltcG9ydCBJVUlTdXJ2ZXkgZnJvbSBcIi4vRmxvb2RnYXRlQ29yZS9VSVN1cnZleS9JVUlTdXJ2ZXlcIjtcclxuXHJcbmltcG9ydCB7IEZsb29kZ2F0ZUVuZ2luZSB9IGZyb20gXCJAbXMtb2ZiL29mZmljZWZsb29kZ2F0ZWNvcmVcIjtcclxuaW1wb3J0IHsgRmlsdGVyVmFsaWRDYW1wYWlnbkRlZmluaXRpb25zIH0gZnJvbVxyXG5cdFwiQG1zLW9mYi9vZmZpY2VmbG9vZGdhdGVjb3JlL2Rpc3Qvc3JjL0NhbXBhaWduL0NhbXBhaWduRGVmaW5pdGlvblByb3ZpZGVyXCI7XHJcbmltcG9ydCB7IElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIgfSBmcm9tIFwiQG1zLW9mYi9vZmZpY2VmbG9vZGdhdGVjb3JlL2Rpc3Qvc3JjL0FwaS9BcGlcIjtcclxuXHJcbmltcG9ydCB7IFByb21pc2UgfSBmcm9tIFwiZXM2LXByb21pc2VcIjtcclxuXHJcbi8qKlxyXG4gKiBIYXMgZmxvb2RnYXRlIGJlZW4gaW5pdGlhbGl6ZWRcclxuICovXHJcbmxldCBpbml0aWFsaXplZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuLyoqXHJcbiAqIEhhcyB0aGUgY29udHJvbCBiZWVuIG9wZW5lZC4gUHJldmVudHMgbW9yZSB0aGFuIG9uZSBkaWFsb2cgYmVpbmcgZ2VuZXJhdGVkLlxyXG4gKi9cclxubGV0IG9wZW5lZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxubGV0IGVuZ2luZTogRmxvb2RnYXRlRW5naW5lO1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUuIE11c3QgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgY2FsbCB0byBmbG9vZGdhdGUuXHJcbiAqIEByZXR1cm5zIEEgcHJvbWlzZSB3aGljaCB3aWxsIGJlIHJlamVjdGVkIGlmIHRoZSBjYWxsIGZhaWxzLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemUoKTogUHJvbWlzZTxhbnk+IHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0aWYgKCFGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIuaXNTdG9yYWdlQXZhaWxhYmxlKCkpIHtcclxuXHRcdFx0cmVqZWN0KFwid2luZG93LmxvY2FsU3RvcmFnZSBpcyBub3QgYXZhaWxhYmxlLlwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghaW5pdGlhbGl6ZWQpIHtcclxuXHRcdFx0QXBwX0NvbW1vbi5pbml0aWFsaXplKClcclxuXHRcdFx0LnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24gb25Jbml0aWFsaXplRnVsZmlsbGVkKCkge1xyXG5cdFx0XHRcdFx0V2luZG93LmdldCgpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUgPSBXaW5kb3cuZ2V0KCkuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmZsb29kZ2F0ZSB8fCB7fSBhcyBhbnk7XHJcblxyXG5cdFx0XHRcdFx0bGV0IGZsb29kZ2F0ZUluaXRPcHRpb25zID0gV2luZG93LmdldCgpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUuaW5pdE9wdGlvbnM7XHJcblx0XHRcdFx0XHRmbG9vZGdhdGVJbml0T3B0aW9ucyA9IGZsb29kZ2F0ZUluaXRPcHRpb25zIHx8IHt9IGFzIGFueTtcclxuXHJcblx0XHRcdFx0XHQvLyBWYWxpZGF0ZSBhbmQgY29weSBjYW1wYWlnbiBkZWZpbml0aW9ucyB0byBsb2NhbCBzdG9yYWdlIFxyXG5cdFx0XHRcdFx0aWYgKGZsb29kZ2F0ZUluaXRPcHRpb25zLmNhbXBhaWduRGVmaW5pdGlvbnMgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBmaWx0ZXJlZFJlc3VsdCA9IEZpbHRlclZhbGlkQ2FtcGFpZ25EZWZpbml0aW9ucyhmbG9vZGdhdGVJbml0T3B0aW9ucy5jYW1wYWlnbkRlZmluaXRpb25zKTtcclxuXHJcblx0XHRcdFx0XHRcdGlmIChmaWx0ZXJlZFJlc3VsdC5lcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdHJlamVjdChcImZsb29kZ2F0ZS5pbml0T3B0aW9ucy5jYW1wYWlnbkRlZmluaXRpb25zIGVycm9yOiBcIiArIGZpbHRlcmVkUmVzdWx0LmVycm9yKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdChuZXcgRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyKCkpLndyaXRlKFxyXG5cdFx0XHRcdFx0XHRcdElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIuRmlsZVR5cGUuQ2FtcGFpZ25EZWZpbml0aW9ucyxcclxuXHRcdFx0XHRcdFx0XHRKU09OLnN0cmluZ2lmeShmbG9vZGdhdGVJbml0T3B0aW9ucy5jYW1wYWlnbkRlZmluaXRpb25zKVxyXG5cdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuc2V0Rmxvb2RnYXRlSW5pdE9wdGlvbnMoV2luZG93LmdldCgpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUuaW5pdE9wdGlvbnMpO1xyXG5cclxuXHRcdFx0XHRcdEZsb29kZ2F0ZUVuZ2luZS5zZXRUZWxlbWV0cnlMb2dnZXIobmV3IEZsb29kZ2F0ZVRlbGVtZXRyeUxvZ2dlcigpKTtcclxuXHJcblx0XHRcdFx0XHRpbml0aWFsaXplZCA9IHRydWU7XHJcblx0XHRcdFx0XHRyZXNvbHZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHQpXHJcblx0XHRcdC5jYXRjaChcclxuXHRcdFx0XHRmdW5jdGlvbiBvbkluaXRpYWxpemVSZWplY3RlZChlcnIpIHtcclxuXHRcdFx0XHRcdHJlamVjdChcIkluaXRpYWxpemF0aW9uIGZhaWxlZDoge1wiICsgZXJyICsgXCJ9XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJlc29sdmUoKTtcclxuXHRcdH1cclxuXHR9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRvIHN1cHBvcnQgdGhlIG11bHRpLXdpbmRvdyBzY2VuYXJpbyBvbiB3ZWIgd2UgbmVlZCB0byBpbml0aWFsaXplIHRoZSBlbmdpbmUgb24gZWFjaCByZXN1bWUuXHJcbiAqIEhlbmNlIHRoaXMgc2VwZXJhdGUgbWV0aG9kIHdoaWNoIGRvZXMgbWFrZSgpIGFuZCBzdGFydCgpIHRvZ2V0aGVyLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0KCk6IFByb21pc2U8YW55PiB7XHJcblx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGVuZ2luZSA9IEZsb29kZ2F0ZUVuZ2luZS5tYWtlKFxyXG5cdFx0XHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS5idWlsZCA/IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS5idWlsZCA6IFwiXCIsXHJcblx0XHRcdFx0bmV3IEFkYXB0aXZlU3VydmV5TGF1bmNoZXJGYWN0b3J5KCksXHJcblx0XHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVJbml0T3B0aW9ucygpLm9uU3VydmV5QWN0aXZhdGVkQ2FsbGJhY2ssXHJcblx0XHRcdFx0bmV3IEZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlcigpLFxyXG5cdFx0XHRcdG5ldyBGbG9vZGdhdGVTdHJpbmdQcm92aWRlcigpLFxyXG5cdFx0XHRcdG5ldyBGbG9vZGdhdGVFbnZpcm9ubWVudFByb3ZpZGVyKClcclxuXHRcdFx0KTtcclxuXHJcblx0XHRcdGVuZ2luZS5zdGFydCgpO1xyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRyZWplY3QoXCJGYWlsZWQgdG8gc3RhcnQgZmxvb2RnYXRlIGVuZ2luZTogXCIgKyBlLnRvU3RyaW5nKCkpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0cmVzb2x2ZSgpO1xyXG5cdH0pO1xyXG59XHJcblxyXG4vKipcclxuICogQSBwcm94eSBmb3IgdGhlIGVuZ2luZS5zdG9wKCkgbWV0aG9kIGZvciBjb25zaXN0ZW5jeSB3aXRoIHRoZSBzdGFydCgpIG1ldGhvZC5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzdG9wKCkge1xyXG5cdGlmIChlbmdpbmUpIHtcclxuXHRcdGVuZ2luZS5zdG9wKCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogR2V0IHRoZSBlbmdpbmUgb2JqZWN0XHJcbiAqIEByZXR1cm5zIHRoZSBlbmdpbmUgb2JqZWN0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RW5naW5lKCk6IEZsb29kZ2F0ZUVuZ2luZSB7XHJcblx0cmV0dXJuIGVuZ2luZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERpc3BsYXkgdGhlIGdpdmVuIFN1cnZleSB3aXRoIGl0J3MgcHJvbXB0XHJcbiAqIEBwYXJhbSBzdXJ2ZXkgdGhlIHN1cnZleSB0byBzaG93XHJcbiAqIEByZXR1cm5zIEEgcHJvbWlzZSB3aGljaCB3aWxsIGJlIHJlamVjdGVkIGlmIHRoZSBjYWxsIGZhaWxzLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dTdXJ2ZXkoc3VydmV5OiBJVUlTdXJ2ZXkpOiBQcm9taXNlPGFueT4ge1xyXG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcblx0XHRpZiAob3BlbmVkKSB7XHJcblx0XHRcdHJlamVjdChcIkNvbnRyb2wgYWxyZWFkeSBvcGVuXCIpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5zZXRGbG9vZGdhdGVTdXJ2ZXkoc3VydmV5ID8gc3VydmV5IDogbmV3IER1bW15VUlTdXJ2ZXkoKSk7XHJcblx0XHRVSS5jcmVhdGVTdXJ2ZXkoZnVuY3Rpb24gKCkgeyBvcGVuZWQgPSBmYWxzZTsgfSk7XHJcblx0XHRvcGVuZWQgPSB0cnVlO1xyXG5cdFx0cmVzb2x2ZSgpO1xyXG5cdH0pO1xyXG59XHJcblxyXG4vKipcclxuICogTWV0aG9kIHRvIGFsbG93IHVzZXJzIHRvIGxhdW5jaCBhIGN1c3RvbSBzdXJ2ZXkgZGlyZWN0bHlcclxuICogQHBhcmFtIHN1cnZleSB0aGUgY3VzdG9tIHN1cnZleSB0byBzaG93XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2hvd0N1c3RvbVN1cnZleShzdXJ2ZXk6IElDdXN0b21TdXJ2ZXkpOiBQcm9taXNlPGFueT4ge1xyXG5cdHJldHVybiBzaG93U3VydmV5KG5ldyBDdXN0b21VSVN1cnZleShzdXJ2ZXkpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlc2V0IHRoZSBmbG9vZGdhdGUgbW9kdWxlLiBVc2VkIGluIHVuaXQgdGVzdHMuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVzZXQoKSB7XHJcblx0QXBwX0NvbW1vbi5yZXNldCgpO1xyXG5cdGluaXRpYWxpemVkID0gZmFsc2U7XHJcblx0b3BlbmVkID0gZmFsc2U7XHJcbn1cclxuXHJcbldpbmRvdy5zZXRGbG9vZGdhdGVTaG93Q3VzdG9tU3VydmV5KHNob3dDdXN0b21TdXJ2ZXkpO1xyXG5XaW5kb3cuc2V0Rmxvb2RnYXRlU2hvd1N1cnZleShzaG93U3VydmV5KTtcclxuV2luZG93LnNldEZsb29kZ2F0ZUdldEVuZ2luZShnZXRFbmdpbmUpO1xyXG5XaW5kb3cuc2V0Rmxvb2RnYXRlSW5pdGlhbGl6ZShpbml0aWFsaXplKTtcclxuV2luZG93LnNldEZsb29kZ2F0ZVN0YXJ0KHN0YXJ0KTtcclxuV2luZG93LnNldEZsb29kZ2F0ZVN0b3Aoc3RvcCk7XHJcbiIsIi8qKlxyXG4gKiBBcHBfaW5BcHBGZWVkYmFjay50c1xyXG4gKlxyXG4gKiBUaGUgZW50cnkgcG9pbnQgZm9yIGluQXBwRmVlZGJhY2suXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgQXBwX0NvbW1vbiBmcm9tIFwiLi9BcHBfQ29tbW9uXCI7XHJcbmltcG9ydCAqIGFzIENvbmZpZ3VyYXRpb24gZnJvbSBcIi4vQ29uZmlndXJhdGlvbi9Db25maWd1cmF0aW9uXCI7XHJcbmltcG9ydCAqIGFzIExvZ2dpbmcgZnJvbSBcIi4vTG9nZ2luZy9Mb2dnaW5nXCI7XHJcbmltcG9ydCAqIGFzIFVJIGZyb20gXCIuL1VJL1VJXCI7XHJcbmltcG9ydCAqIGFzIFdpbmRvdyBmcm9tIFwiLi9XaW5kb3cvV2luZG93XCI7XHJcbmltcG9ydCB7IElMYXVuY2hPcHRpb25zSW5BcHBGZWVkYmFjayB9IGZyb20gXCIuL0NvbmZpZ3VyYXRpb24vSUxhdW5jaE9wdGlvbnNcIjtcclxuXHJcbmltcG9ydCB7IFByb21pc2UgfSBmcm9tIFwiZXM2LXByb21pc2VcIjtcclxuXHJcbi8qKlxyXG4gKiBIYXMgaW5BcHBGZWVkYmFjayBiZWVuIGluaXRpYWxpemVkXHJcbiAqL1xyXG5sZXQgaW5pdGlhbGl6ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbi8qKlxyXG4gKiBJbml0aWFsaXplXHJcbiAqIEByZXR1cm5zIEEgcHJvbWlzZSB3aGljaCB3aWxsIGJlIHJlamVjdGVkIGlmIHRoZSBjYWxsIGZhaWxzLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemUoKTogUHJvbWlzZTxhbnk+IHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0aWYgKCFpbml0aWFsaXplZCkge1xyXG5cdFx0XHRBcHBfQ29tbW9uLmluaXRpYWxpemUoKVxyXG5cdFx0XHQudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbiBvbkluaXRpYWxpemVGdWxmaWxsZWQoKSB7XHJcblx0XHRcdFx0XHRpZiAoIVdpbmRvdy5nZXQoKS5PZmZpY2VCcm93c2VyRmVlZGJhY2suaW5pdE9wdGlvbnMpIHtcclxuXHRcdFx0XHRcdFx0cmVqZWN0KFwiV2luZG93Lk9mZmljZUJyb3dzZXJGZWVkYmFjay5pbml0T3B0aW9ucyBub3Qgc2V0XCIpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5zZXRJbkFwcEZlZWRiYWNrSW5pdE9wdGlvbnMoV2luZG93LmdldCgpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5pbml0T3B0aW9ucyk7XHJcblx0XHRcdFx0XHRpbml0aWFsaXplZCA9IHRydWU7XHJcblxyXG5cdFx0XHRcdFx0cmVzb2x2ZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0KVxyXG5cdFx0XHQuY2F0Y2goXHJcblx0XHRcdFx0ZnVuY3Rpb24gb25Jbml0aWFsaXplUmVqZWN0ZWQoZXJyKSB7IHJlamVjdChcIkluaXRpYWxpemF0aW9uIGZhaWxlZDoge1wiICsgZXJyICsgXCJ9XCIpOyB9XHJcblx0XHRcdCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZXNvbHZlKCk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYXMgdGhlIGNvbnRyb2wgYmVlbiBvcGVuZWQuIFByZXZlbnRzIG1vcmUgdGhhbiBvbmUgZGlhbG9nIGJlaW5nIGdlbmVyYXRlZC5cclxuICovXHJcbmxldCBvcGVuZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbi8qKlxyXG4gKiBIYW5kbGVyIHRvIGxhdW5jaCB0aGUgbXVsdGkgZmVlZGJhY2sgZGlhbG9nXHJcbiAqIEBwYXJhbSBsYXVuY2hPcHRpb25zIG9wdGlvbmFsIGZlZWRiYWNrIHByb3BlcnRpZXNcclxuICogQHJldHVybnMgQSBwcm9taXNlIHdoaWNoIHdpbGwgYmUgcmVqZWN0ZWQgaWYgdGhlIGNhbGwgZmFpbHMuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbXVsdGlGZWVkYmFjayhsYXVuY2hPcHRpb25zPzogSUxhdW5jaE9wdGlvbnNJbkFwcEZlZWRiYWNrKTogUHJvbWlzZTxhbnk+IHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0aWYgKG9wZW5lZCkge1xyXG5cdFx0XHRyZWplY3QoXCJDb250cm9sIGFscmVhZHkgb3BlblwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGluaXRpYWxpemUoKVxyXG5cdFx0LnRoZW4oXHJcblx0XHRcdGZ1bmN0aW9uIG9uSW5pdGlhbGl6ZUZ1bGZpbGxlZCgpIHtcclxuXHRcdFx0XHRDb25maWd1cmF0aW9uLmdldCgpLnNldEluQXBwRmVlZGJhY2tMYXVuY2hPcHRpb25zKGxhdW5jaE9wdGlvbnMpO1xyXG5cdFx0XHRcdFVJLmNyZWF0ZUJlbGx5QmFuZE11bHRpKGZ1bmN0aW9uICgpIHsgb3BlbmVkID0gZmFsc2U7IH0pO1xyXG5cdFx0XHRcdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5JbkFwcC5VSS5QaWNrZXIuU2hvd24uVkFMVUUsXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdElzQnVnRW5hYmxlZDogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRJbkFwcEZlZWRiYWNrSW5pdE9wdGlvbnMoKS5idWdGb3JtLFxyXG5cdFx0XHRcdFx0XHRJc0lkZWFFbmFibGVkOiBDb25maWd1cmF0aW9uLmdldCgpLmdldEluQXBwRmVlZGJhY2tJbml0T3B0aW9ucygpLnVzZXJWb2ljZSAhPT0gdW5kZWZpbmVkLFxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0b3BlbmVkID0gdHJ1ZTtcclxuXHRcdFx0XHRyZXNvbHZlKCk7XHJcblx0XHRcdH1cclxuXHRcdClcclxuXHRcdC5jYXRjaChcclxuXHRcdFx0ZnVuY3Rpb24gb25Jbml0aWFsaXplUmVqZWN0ZWQoZXJyKSB7IHJlamVjdChcIkluaXRpYWxpemF0aW9uIGZhaWxlZDoge1wiICsgZXJyICsgXCJ9XCIpOyB9XHJcblx0XHQpO1xyXG5cdH0pO1xyXG59XHJcblxyXG4vKipcclxuICogSGFuZGxlciB0byBsYXVuY2ggdGhlIHNpbmdsZSBmZWVkYmFjayBkaWFsb2dcclxuICogQHBhcmFtIGZlZWRiYWNrVHlwZSB0aGUgZmVlZGJhY2sgdHlwZVxyXG4gKiBAcGFyYW0gbGF1bmNoT3B0aW9ucyBvcHRpb25hbCBmZWVkYmFjayBwcm9wZXJ0aWVzXHJcbiAqIEByZXR1cm5zIEEgcHJvbWlzZSB3aGljaCB3aWxsIGJlIHJlamVjdGVkIGlmIHRoZSBjYWxsIGZhaWxzLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNpbmdsZUZlZWRiYWNrKGZlZWRiYWNrVHlwZTogc3RyaW5nLCBsYXVuY2hPcHRpb25zPzogSUxhdW5jaE9wdGlvbnNJbkFwcEZlZWRiYWNrKTogUHJvbWlzZTxhbnk+IHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0aWYgKG9wZW5lZCkge1xyXG5cdFx0XHRyZWplY3QoXCJDb250cm9sIGFscmVhZHkgb3BlblwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBmZWVkYmFja1R5cGVFbnVtID0gQ29uZmlndXJhdGlvbi52YWxpZGF0ZUZlZWRiYWNrVHlwZShmZWVkYmFja1R5cGUpO1xyXG5cclxuXHRcdGluaXRpYWxpemUoKVxyXG5cdFx0LnRoZW4oXHJcblx0XHRcdGZ1bmN0aW9uIG9uSW5pdGlhbGl6ZUZ1bGZpbGxlZCgpIHtcclxuXHRcdFx0XHRDb25maWd1cmF0aW9uLmdldCgpLnNldEluQXBwRmVlZGJhY2tMYXVuY2hPcHRpb25zKGxhdW5jaE9wdGlvbnMpO1xyXG5cdFx0XHRcdFVJLmNyZWF0ZUJlbGx5QmFuZFNpbmdsZShmdW5jdGlvbiAoKSB7IG9wZW5lZCA9IGZhbHNlOyB9LCBmZWVkYmFja1R5cGVFbnVtKTtcclxuXHRcdFx0XHRMb2dnaW5nLmdldExvZ2dlcigpLmxvZ0V2ZW50KExvZ2dpbmcuRXZlbnRJZHMuSW5BcHAuVUkuRm9ybS5TaG93bi5WQUxVRSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0RmVlZGJhY2tUeXBlOiBmZWVkYmFja1R5cGVFbnVtLFxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0b3BlbmVkID0gdHJ1ZTtcclxuXHRcdFx0XHRyZXNvbHZlKCk7XHJcblx0XHRcdH1cclxuXHRcdClcclxuXHRcdC5jYXRjaChcclxuXHRcdFx0ZnVuY3Rpb24gb25Jbml0aWFsaXplUmVqZWN0ZWQoZXJyKSB7IHJlamVjdChcIkluaXRpYWxpemF0aW9uIGZhaWxlZDoge1wiICsgZXJyICsgXCJ9XCIpOyB9XHJcblx0XHQpO1xyXG5cdH0pO1xyXG59XHJcblxyXG4vKipcclxuICogUmVzZXQgdGhlIGluYXBwZmVlZGJhY2sgbW9kdWxlLiBVc2VkIGluIHVuaXQgdGVzdHMuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVzZXQoKSB7XHJcblx0QXBwX0NvbW1vbi5yZXNldCgpO1xyXG5cdGluaXRpYWxpemVkID0gZmFsc2U7XHJcblx0b3BlbmVkID0gZmFsc2U7XHJcbn1cclxuXHJcbi8qIE1ha2UgdGhlIEZlZWRiYWNrRGlhbG9nIG1ldGhvZHMgYXZhaWxhYmxlIGdsb2JhbGx5ICovXHJcbldpbmRvdy5zZXRNdWx0aUZlZWRiYWNrKG11bHRpRmVlZGJhY2spO1xyXG5XaW5kb3cuc2V0U2luZ2xlRmVlZGJhY2soc2luZ2xlRmVlZGJhY2spO1xyXG4iLCIvKipcclxuICogQ29uZmlndXJhdGlvbi50c1xyXG4gKlxyXG4gKiBNb2R1bGUgZm9yIGxvZ2ljIHJlbGF0aW5nIHRvIHRoZSBzZGsgdXNlciBjb25maWd1cmF0aW9uXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSBcIi4vLi4vVXRpbHNcIjtcclxuaW1wb3J0ICogYXMgQ29uc3RhbnRzIGZyb20gXCIuLy4uL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgKiBhcyBMb2NhbGl6YXRpb24gZnJvbSBcIi4vLi4vTG9jYWxpemF0aW9uXCI7XHJcbmltcG9ydCB7IElDYXRlZ29yeU9wdGlvbnMgfSBmcm9tIFwiLi9JQ2F0ZWdvcnlPcHRpb25zXCI7XHJcbmltcG9ydCAqIGFzIElJbml0T3B0aW9ucyBmcm9tIFwiLi9JSW5pdE9wdGlvbnNcIjtcclxuaW1wb3J0ICogYXMgSUxhdW5jaE9wdGlvbnMgZnJvbSBcIi4vSUxhdW5jaE9wdGlvbnNcIjtcclxuaW1wb3J0IElVSVN1cnZleSBmcm9tIFwiLi8uLi9GbG9vZGdhdGVDb3JlL1VJU3VydmV5L0lVSVN1cnZleVwiO1xyXG5pbXBvcnQgeyBJT25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjaywgSVN1cnZleUxhdW5jaGVyIH0gZnJvbSBcIkBtcy1vZmIvb2ZmaWNlZmxvb2RnYXRlY29yZS9kaXN0L3NyYy9BcGkvQXBpXCI7XHJcblxyXG5leHBvcnQgKiBmcm9tIFwiLi9JSW5pdE9wdGlvbnNcIjtcclxuZXhwb3J0ICogZnJvbSBcIi4vSUxhdW5jaE9wdGlvbnNcIjtcclxuXHJcbi8qKlxyXG4gKiBDbGFzcyByZXByZXNlbnRpbmcgYSBjb25maWd1cmF0aW9uICh1c2VyIHByb3ZpZGVkIG9wdGlvbnMpXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ29uZmlndXJhdGlvbiB7XHJcblx0LyoqXHJcblx0ICogVmFsaWRhdGUgY2F0ZWdvcnkgb3B0aW9ucywgZGVmYXVsdCBcInNob3dcIiB0byBmYWxzZSBpZiBDYXRlZ29yeU9wdGlvbnMgaXMgbm90IHByb3ZpZGVkLlxyXG5cdCAqIEBwYXJhbSBjYXRlZ29yaWVzIENhdGVnb3J5IG9wdGlvbnNcclxuXHQgKiBAcmV0dXJucyB7SUNhdGVnb3J5T3B0aW9uc30gdGhlIHZhbGlkYXRlZCBDYXRlZ29yeU9wdGlvbnNcclxuXHQgKi9cclxuXHRwcml2YXRlIHN0YXRpYyB2YWxpZGF0ZUNhdGVnb3J5T3B0aW9ucyhjYXRlZ29yaWVzPzogSUNhdGVnb3J5T3B0aW9ucyk6IElDYXRlZ29yeU9wdGlvbnMge1xyXG5cdFx0aWYgKCFjYXRlZ29yaWVzKSB7XHJcblx0XHRcdHJldHVybiB7IHNob3c6IGZhbHNlIH07XHJcblx0XHR9XHJcblxyXG5cdFx0VXRpbHMuZXhwZWN0Qm9vbGVhbihjYXRlZ29yaWVzLnNob3csIFwiY2F0ZWdvcmllcy5zaG93XCIpO1xyXG5cdFx0aWYgKGNhdGVnb3JpZXMuY3VzdG9tQ2F0ZWdvcmllcykge1xyXG5cdFx0XHRVdGlscy5leHBlY3RBcnJheShjYXRlZ29yaWVzLmN1c3RvbUNhdGVnb3JpZXMsIFwiY2F0ZWdvcmllcy5jdXN0b21DYXRlZ29yaWVzXCIpO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgY3VzdG9tQ2F0ZWdvcnkgb2YgY2F0ZWdvcmllcy5jdXN0b21DYXRlZ29yaWVzKSB7XHJcblx0XHRcdFx0VXRpbHMuZXhwZWN0U3RyaW5nKGN1c3RvbUNhdGVnb3J5LCBcImN1c3RvbSBjYXRlZ29yeSAnXCIgKyBjdXN0b21DYXRlZ29yeSArIFwiJ1wiKTtcclxuXHRcdFx0XHRpZiAoY3VzdG9tQ2F0ZWdvcnkubGVuZ3RoID4gMjApIHtcclxuXHRcdFx0XHRcdHRocm93IFwiY3VzdG9tIGNhdGVnb3J5ICdcIiArIGN1c3RvbUNhdGVnb3J5ICsgXCInIHRvbyBsb25nLCBtYXggMjAgY2hhcmFjdGVycy5cIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gY2F0ZWdvcmllcztcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgY29tbW9uSW5pdE9wdGlvbnM6IElJbml0T3B0aW9ucy5JSW5pdE9wdGlvbnNDb21tb247XHJcblxyXG5cdHByaXZhdGUgaW5BcHBGZWVkYmFja0luaXRPcHRpb25zOiBJSW5pdE9wdGlvbnMuSUluaXRPcHRpb25zSW5BcHBGZWVkYmFjaztcclxuXHRwcml2YXRlIGluQXBwRmVlZGJhY2tMYXVuY2hPcHRpb25zOiBJTGF1bmNoT3B0aW9ucy5JTGF1bmNoT3B0aW9uc0luQXBwRmVlZGJhY2s7XHJcblxyXG5cdHByaXZhdGUgZmxvb2RnYXRlSW5pdE9wdGlvbnM6IElJbml0T3B0aW9ucy5JSW5pdE9wdGlvbnNGbG9vZGdhdGU7XHJcblx0cHJpdmF0ZSBmbG9vZGdhdGVTdXJ2ZXk6IElVSVN1cnZleTtcclxuXHJcblx0cHVibGljIGdldENvbW1vbkluaXRPcHRpb25zKCk6IElJbml0T3B0aW9ucy5JSW5pdE9wdGlvbnNDb21tb24ge1xyXG5cdFx0cmV0dXJuIHRoaXMuY29tbW9uSW5pdE9wdGlvbnM7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0SW5BcHBGZWVkYmFja0luaXRPcHRpb25zKCk6IElJbml0T3B0aW9ucy5JSW5pdE9wdGlvbnNJbkFwcEZlZWRiYWNrIHtcclxuXHRcdHJldHVybiB0aGlzLmluQXBwRmVlZGJhY2tJbml0T3B0aW9ucztcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRJbkFwcEZlZWRiYWNrTGF1bmNoT3B0aW9ucygpOiBJTGF1bmNoT3B0aW9ucy5JTGF1bmNoT3B0aW9uc0luQXBwRmVlZGJhY2sge1xyXG5cdFx0cmV0dXJuIHRoaXMuaW5BcHBGZWVkYmFja0xhdW5jaE9wdGlvbnM7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0Rmxvb2RnYXRlSW5pdE9wdGlvbnMoKTogSUluaXRPcHRpb25zLklJbml0T3B0aW9uc0Zsb29kZ2F0ZSB7XHJcblx0XHRyZXR1cm4gdGhpcy5mbG9vZGdhdGVJbml0T3B0aW9ucztcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRGbG9vZGdhdGVTdXJ2ZXkoKTogSVVJU3VydmV5IHtcclxuXHRcdHJldHVybiB0aGlzLmZsb29kZ2F0ZVN1cnZleTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldCBpbml0T3B0aW9ucyBmb3IgY29tbW9uIGZ1bmN0aW9uYWxpdHkuXHJcblx0ICovXHJcblx0cHVibGljIHNldENvbW1vbkluaXRPcHRpb25zKHBhc3NlZEluaXRPcHRpb25zOiBJSW5pdE9wdGlvbnMuSUluaXRPcHRpb25zQ29tbW9uKSB7XHJcblx0XHRVdGlscy5leHBlY3RPYmplY3QocGFzc2VkSW5pdE9wdGlvbnMsIFwicGFzc2VkSW5pdE9wdGlvbnNcIik7XHJcblxyXG5cdFx0bGV0IGluaXRPcHRpb25zOiBJSW5pdE9wdGlvbnMuSUluaXRPcHRpb25zQ29tbW9uID0ge1xyXG5cdFx0XHRhcHBJZDogcGFzc2VkSW5pdE9wdGlvbnMuYXBwSWQsXHJcblx0XHRcdGFwcGxpY2F0aW9uR3JvdXA6IHBhc3NlZEluaXRPcHRpb25zLmFwcGxpY2F0aW9uR3JvdXAgfHwge30sXHJcblx0XHRcdGJ1aWxkOiBwYXNzZWRJbml0T3B0aW9ucy5idWlsZCxcclxuXHRcdFx0Y2lkOiBwYXNzZWRJbml0T3B0aW9ucy5jaWQsXHJcblx0XHRcdGVudmlyb25tZW50OiBwYXNzZWRJbml0T3B0aW9ucy5lbnZpcm9ubWVudCxcclxuXHRcdFx0aW50bEZpbGVuYW1lOiBwYXNzZWRJbml0T3B0aW9ucy5pbnRsRmlsZW5hbWUsXHJcblx0XHRcdGludGxVcmw6IHBhc3NlZEluaXRPcHRpb25zLmludGxVcmwsXHJcblx0XHRcdGxvY2FsZTogcGFzc2VkSW5pdE9wdGlvbnMubG9jYWxlLFxyXG5cdFx0XHRvbkVycm9yOiBwYXNzZWRJbml0T3B0aW9ucy5vbkVycm9yLFxyXG5cdFx0XHRvcmlnaW5hbExvY2FsZTogcGFzc2VkSW5pdE9wdGlvbnMubG9jYWxlLFxyXG5cdFx0XHRwcmltYXJ5Q29sb3VyOiBwYXNzZWRJbml0T3B0aW9ucy5wcmltYXJ5Q29sb3VyLFxyXG5cdFx0XHRzZWNvbmRhcnlDb2xvdXI6IHBhc3NlZEluaXRPcHRpb25zLnNlY29uZGFyeUNvbG91cixcclxuXHRcdFx0c2Vzc2lvbklkOiBwYXNzZWRJbml0T3B0aW9ucy5zZXNzaW9uSWQsXHJcblx0XHRcdHN0eWxlc1VybDogcGFzc2VkSW5pdE9wdGlvbnMuc3R5bGVzVXJsLFxyXG5cdFx0XHR0ZWxlbWV0cnlHcm91cDogcGFzc2VkSW5pdE9wdGlvbnMudGVsZW1ldHJ5R3JvdXAgfHwge30sXHJcblx0XHRcdHVzZXJFbWFpbDogcGFzc2VkSW5pdE9wdGlvbnMudXNlckVtYWlsLFxyXG5cdFx0XHR1c2VyRW1haWxDb25zZW50RGVmYXVsdDogcGFzc2VkSW5pdE9wdGlvbnMudXNlckVtYWlsQ29uc2VudERlZmF1bHQsXHJcblx0XHRcdHdlYkdyb3VwOiBwYXNzZWRJbml0T3B0aW9ucy53ZWJHcm91cCB8fCB7fSxcclxuXHRcdH07XHJcblxyXG5cdFx0VXRpbHMuZXhwZWN0TnVtYmVyKGluaXRPcHRpb25zLmFwcElkLCBcImluaXRPcHRpb25zLmFwcElkXCIpO1xyXG5cdFx0aWYgKCEoaW5pdE9wdGlvbnMuYXBwSWQgJSAxID09PSAwICYmIGluaXRPcHRpb25zLmFwcElkID4gMCkpIHtcclxuXHRcdFx0dGhyb3cgXCJpbml0T3B0aW9ucy5hcHBJZCBpcyBub3QgYSBwb3NpdGl2ZSBpbnRlZ2VyOiBcIiArIGluaXRPcHRpb25zLmFwcElkO1xyXG5cdFx0fVxyXG5cclxuXHRcdFV0aWxzLmV4cGVjdFN0cmluZyhpbml0T3B0aW9ucy5zdHlsZXNVcmwsIFwiaW5pdE9wdGlvbnMuc3R5bGVzVXJsXCIpO1xyXG5cdFx0VXRpbHMuZXhwZWN0U3RyaW5nKGluaXRPcHRpb25zLmludGxVcmwsIFwiaW5pdE9wdGlvbnMuaW50bFVybFwiKTtcclxuXHJcblx0XHRpZiAoaW5pdE9wdGlvbnMuaW50bEZpbGVuYW1lICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0VXRpbHMuZXhwZWN0U3RyaW5nKGluaXRPcHRpb25zLmludGxGaWxlbmFtZSwgXCJpbml0T3B0aW9ucy5pbnRsRmlsZW5hbWVcIik7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpbml0T3B0aW9ucy5pbnRsRmlsZW5hbWUgPSBcIm9mZmljZWJyb3dzZXJmZWVkYmFja3N0cmluZ3MuanNcIjtcclxuXHRcdH1cclxuXHJcblx0XHRVdGlscy5leHBlY3ROdW1iZXIoaW5pdE9wdGlvbnMuZW52aXJvbm1lbnQsIFwiaW5pdE9wdGlvbnMuZW52aXJvbm1lbnRcIik7XHJcblx0XHRpZiAoIShpbml0T3B0aW9ucy5lbnZpcm9ubWVudCA9PT0gMSB8fCBpbml0T3B0aW9ucy5lbnZpcm9ubWVudCA9PT0gMCkpIHtcclxuXHRcdFx0dGhyb3cgXCJpbml0T3B0aW9ucy5lbnZpcm9ubWVudCBoYXMgYSBiYWQgdmFsdWU6IFwiICsgaW5pdE9wdGlvbnMuZW52aXJvbm1lbnQ7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGluaXRPcHRpb25zLnVzZXJFbWFpbCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdFN0cmluZyhpbml0T3B0aW9ucy51c2VyRW1haWwsIFwiaW5pdE9wdGlvbnMudXNlckVtYWlsXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChpbml0T3B0aW9ucy51c2VyRW1haWxDb25zZW50RGVmYXVsdCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdEJvb2xlYW4oaW5pdE9wdGlvbnMudXNlckVtYWlsQ29uc2VudERlZmF1bHQsIFwiaW5pdE9wdGlvbnMudXNlckVtYWlsQ29uc2VudERlZmF1bHRcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGluaXRPcHRpb25zLnNlc3Npb25JZCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdFN0cmluZyhpbml0T3B0aW9ucy5zZXNzaW9uSWQsIFwiaW5pdE9wdGlvbnMuc2Vzc2lvbklkXCIpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aW5pdE9wdGlvbnMuc2Vzc2lvbklkID0gXCIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDBcIjtcclxuXHRcdH1cclxuXHRcdC8vIENvcHkgc2Vzc2lvbklEIG92ZXIgdG8gdGVsZW1ldHJ5R3JvdXBcclxuXHRcdGluaXRPcHRpb25zLnRlbGVtZXRyeUdyb3VwLnByb2Nlc3NTZXNzaW9uSWQgPSBpbml0T3B0aW9ucy5zZXNzaW9uSWQ7XHJcblxyXG5cdFx0aWYgKGluaXRPcHRpb25zLmNpZCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdFN0cmluZyhpbml0T3B0aW9ucy5jaWQsIFwiaW5pdE9wdGlvbnMuY2lkXCIpO1xyXG5cclxuXHRcdFx0Ly8gQ29weSBjaWQgb3ZlciB0byBleHRlbmRlZE1hbmlmZXN0RGF0YSBvZiBhcHBsaWNhdGlvbkdyb3VwXHJcblx0XHRcdGluaXRPcHRpb25zLmFwcGxpY2F0aW9uR3JvdXAuZXh0ZW5kZWRNYW5pZmVzdERhdGEgPSBKU09OLnN0cmluZ2lmeSh7IGNpZDogaW5pdE9wdGlvbnMuY2lkIH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChpbml0T3B0aW9ucy5idWlsZCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdFN0cmluZyhpbml0T3B0aW9ucy5idWlsZCwgXCJpbml0T3B0aW9ucy5idWlsZFwiKTtcclxuXHRcdFx0bGV0IGJ1aWxkUmVnZXggPSBcIl5bMC05XXsxLDl9KFxcXFwuWzAtOV17MSw5fSk/KFxcXFwuWzAtOV17MSw5fSk/KFxcXFwuWzAtOV17MSw5fSk/JFwiO1xyXG5cdFx0XHRpZiAoIW5ldyBSZWdFeHAoYnVpbGRSZWdleCkudGVzdChpbml0T3B0aW9ucy5idWlsZCkpIHtcclxuXHRcdFx0XHRpbml0T3B0aW9ucy5idWlsZCA9IFwiMC4wLjAuMFwiO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpbml0T3B0aW9ucy5idWlsZCA9IFwiMC4wLjAuMFwiO1xyXG5cdFx0fVxyXG5cdFx0Ly8gQ29weSBidWlsZCBvdmVyIHRvIHRlbGVtZXRyeUdyb3VwXHJcblx0XHRpbml0T3B0aW9ucy50ZWxlbWV0cnlHcm91cC5vZmZpY2VCdWlsZCA9IGluaXRPcHRpb25zLmJ1aWxkO1xyXG5cclxuXHRcdGxldCBoZXhDb2xvdXJSZWdleCA9IG5ldyBSZWdFeHAoXCJeI1swLTlhLWZdezN9KFswLTlhLWZdezN9KT8kXCIsIFwiaVwiKTtcclxuXHRcdGlmIChpbml0T3B0aW9ucy5wcmltYXJ5Q29sb3VyICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0aWYgKCFoZXhDb2xvdXJSZWdleC50ZXN0KGluaXRPcHRpb25zLnByaW1hcnlDb2xvdXIpKSB7XHJcblx0XHRcdFx0aW5pdE9wdGlvbnMucHJpbWFyeUNvbG91ciA9IHVuZGVmaW5lZDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChpbml0T3B0aW9ucy5zZWNvbmRhcnlDb2xvdXIgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpZiAoIWhleENvbG91clJlZ2V4LnRlc3QoaW5pdE9wdGlvbnMuc2Vjb25kYXJ5Q29sb3VyKSkge1xyXG5cdFx0XHRcdGluaXRPcHRpb25zLnNlY29uZGFyeUNvbG91ciA9IHVuZGVmaW5lZDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChpbml0T3B0aW9ucy5sb2NhbGUgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRVdGlscy5leHBlY3RTdHJpbmcoaW5pdE9wdGlvbnMubG9jYWxlLCBcImluaXRPcHRpb25zLmxvY2FsZVwiKTtcclxuXHRcdFx0aW5pdE9wdGlvbnMubG9jYWxlID0gTG9jYWxpemF0aW9uLnZhbGlkYXRlKGluaXRPcHRpb25zLmxvY2FsZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpbml0T3B0aW9ucy5sb2NhbGUgPSBcImVuXCI7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGluaXRPcHRpb25zLm9uRXJyb3IgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpbml0T3B0aW9ucy5vbkVycm9yID0gKGVycjogc3RyaW5nKSA9PiB7IHJldHVybjsgfTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNvbW1vbkluaXRPcHRpb25zID0gaW5pdE9wdGlvbnM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTZXQgaW5pdCBvcHRpb25zIGZvciBpbkFwcEZlZWRiYWNrXHJcblx0ICovXHJcblx0cHVibGljIHNldEluQXBwRmVlZGJhY2tJbml0T3B0aW9ucyhwYXNzZWRJbml0T3B0aW9uczogSUluaXRPcHRpb25zLklJbml0T3B0aW9uc0luQXBwRmVlZGJhY2spIHtcclxuXHRcdFV0aWxzLmV4cGVjdE9iamVjdChwYXNzZWRJbml0T3B0aW9ucywgXCJwYXNzZWRJbml0T3B0aW9uc1wiKTtcclxuXHJcblx0XHRsZXQgaW5pdE9wdGlvbnM6IElJbml0T3B0aW9ucy5JSW5pdE9wdGlvbnNJbkFwcEZlZWRiYWNrID0ge1xyXG5cdFx0XHRidWdGb3JtOiBwYXNzZWRJbml0T3B0aW9ucy5idWdGb3JtLFxyXG5cdFx0XHRvbkRpc21pc3M6IHBhc3NlZEluaXRPcHRpb25zLm9uRGlzbWlzcyxcclxuXHRcdFx0c2NyZWVuc2hvdDogcGFzc2VkSW5pdE9wdGlvbnMuc2NyZWVuc2hvdCxcclxuXHRcdFx0dXNlckVtYWlsOiBwYXNzZWRJbml0T3B0aW9ucy51c2VyRW1haWwsXHJcblx0XHRcdHVzZXJWb2ljZTogcGFzc2VkSW5pdE9wdGlvbnMudXNlclZvaWNlICE9PSB1bmRlZmluZWQgP1xyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHVybDogcGFzc2VkSW5pdE9wdGlvbnMudXNlclZvaWNlLnVybCxcclxuXHRcdFx0XHR9IDpcclxuXHRcdFx0XHR1bmRlZmluZWQsXHJcblx0XHR9O1xyXG5cclxuXHRcdGlmIChpbml0T3B0aW9ucy5vbkRpc21pc3MgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpbml0T3B0aW9ucy5vbkRpc21pc3MgPSBmdW5jdGlvbiAoc3VibWl0dGVkOiBib29sZWFuKSB7IHJldHVybjsgfTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaW5pdE9wdGlvbnMuYnVnRm9ybSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdEJvb2xlYW4oaW5pdE9wdGlvbnMuYnVnRm9ybSwgXCJpbml0T3B0aW9ucy5idWdGb3JtXCIpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aW5pdE9wdGlvbnMuYnVnRm9ybSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChpbml0T3B0aW9ucy51c2VyRW1haWwgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRVdGlscy5leHBlY3RTdHJpbmcoaW5pdE9wdGlvbnMudXNlckVtYWlsLCBcImluaXRPcHRpb25zLnVzZXJFbWFpbFwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaW5pdE9wdGlvbnMuc2NyZWVuc2hvdCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdEJvb2xlYW4oaW5pdE9wdGlvbnMuc2NyZWVuc2hvdCwgXCJpbml0T3B0aW9ucy5zY3JlZW5zaG90XCIpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0aW5pdE9wdGlvbnMuc2NyZWVuc2hvdCA9IHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGluaXRPcHRpb25zLnVzZXJWb2ljZSAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdFV0aWxzLmV4cGVjdE9iamVjdChpbml0T3B0aW9ucy51c2VyVm9pY2UsIFwiaW5pdE9wdGlvbnMudXNlclZvaWNlXCIpO1xyXG5cdFx0XHRVdGlscy5leHBlY3RTdHJpbmcoaW5pdE9wdGlvbnMudXNlclZvaWNlLnVybCwgXCJpbml0T3B0aW9ucy51c2VyVm9pY2UudXJsXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuaW5BcHBGZWVkYmFja0luaXRPcHRpb25zID0gaW5pdE9wdGlvbnM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTZXQgbGF1bmNoIG9wdGlvbnMgZm9yIGluQXBwRmVlZGJhY2tcclxuXHQgKi9cclxuXHRwdWJsaWMgc2V0SW5BcHBGZWVkYmFja0xhdW5jaE9wdGlvbnMobGF1bmNoT3B0aW9ucz86IElMYXVuY2hPcHRpb25zLklMYXVuY2hPcHRpb25zSW5BcHBGZWVkYmFjaykge1xyXG5cdFx0aWYgKCF0aGlzLmNvbW1vbkluaXRPcHRpb25zKSB7XHJcblx0XHRcdHRocm93IFwiY29tbW9uSW5pdE9wdGlvbnMgbm90IHNldFwiO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghbGF1bmNoT3B0aW9ucykge1xyXG5cdFx0XHRsYXVuY2hPcHRpb25zID0ge307XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gT3ZlcnJpZGUgYW55IHNldHRpbmcgZG9uZSBpbiBMYXVuY2hPcHRpb25zIGZvciB0aGUgbWV0YWRhdGFHcm91cHNcclxuXHRcdHRoaXMuY29tbW9uSW5pdE9wdGlvbnMuYXBwbGljYXRpb25Hcm91cCA9IFV0aWxzLm92ZXJyaWRlVmFsdWVzKGxhdW5jaE9wdGlvbnMuYXBwbGljYXRpb25Hcm91cCxcclxuXHRcdFx0dGhpcy5jb21tb25Jbml0T3B0aW9ucy5hcHBsaWNhdGlvbkdyb3VwKTtcclxuXHRcdHRoaXMuY29tbW9uSW5pdE9wdGlvbnMudGVsZW1ldHJ5R3JvdXAgPSBVdGlscy5vdmVycmlkZVZhbHVlcyhsYXVuY2hPcHRpb25zLnRlbGVtZXRyeUdyb3VwLFxyXG5cdFx0XHR0aGlzLmNvbW1vbkluaXRPcHRpb25zLnRlbGVtZXRyeUdyb3VwKTtcclxuXHRcdHRoaXMuY29tbW9uSW5pdE9wdGlvbnMud2ViR3JvdXAgPSBVdGlscy5vdmVycmlkZVZhbHVlcyhsYXVuY2hPcHRpb25zLndlYkdyb3VwLFxyXG5cdFx0XHR0aGlzLmNvbW1vbkluaXRPcHRpb25zLndlYkdyb3VwKTtcclxuXHJcblx0XHRsYXVuY2hPcHRpb25zLmNhdGVnb3JpZXMgPSBDb25maWd1cmF0aW9uLnZhbGlkYXRlQ2F0ZWdvcnlPcHRpb25zKGxhdW5jaE9wdGlvbnMuY2F0ZWdvcmllcyk7XHJcblxyXG5cdFx0dGhpcy5pbkFwcEZlZWRiYWNrTGF1bmNoT3B0aW9ucyA9IGxhdW5jaE9wdGlvbnM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTZXQgaW5pdCBvcHRpb25zIGZvciBmbG9vZGdhdGVcclxuXHQgKi9cclxuXHRwdWJsaWMgc2V0Rmxvb2RnYXRlSW5pdE9wdGlvbnMocGFzc2VkSW5pdE9wdGlvbnM6IElJbml0T3B0aW9ucy5JSW5pdE9wdGlvbnNGbG9vZGdhdGUpIHtcclxuXHRcdFV0aWxzLmV4cGVjdE9iamVjdChwYXNzZWRJbml0T3B0aW9ucywgXCJwYXNzZWRJbml0T3B0aW9uc1wiKTtcclxuXHJcblx0XHRsZXQgaW5pdE9wdGlvbnM6IElJbml0T3B0aW9ucy5JSW5pdE9wdGlvbnNGbG9vZGdhdGUgPSB7XHJcblx0XHRcdGF1dG9EaXNtaXNzOiBwYXNzZWRJbml0T3B0aW9ucy5hdXRvRGlzbWlzcyxcclxuXHRcdFx0Y2FtcGFpZ25EZWZpbml0aW9uczogcGFzc2VkSW5pdE9wdGlvbnMuY2FtcGFpZ25EZWZpbml0aW9ucyxcclxuXHRcdFx0b25EaXNtaXNzOiBwYXNzZWRJbml0T3B0aW9ucy5vbkRpc21pc3MsXHJcblx0XHRcdG9uU3VydmV5QWN0aXZhdGVkQ2FsbGJhY2s6IHBhc3NlZEluaXRPcHRpb25zLm9uU3VydmV5QWN0aXZhdGVkQ2FsbGJhY2ssXHJcblx0XHRcdHVJU3RyaW5nR2V0dGVyOiBwYXNzZWRJbml0T3B0aW9ucy51SVN0cmluZ0dldHRlcixcclxuXHRcdH07XHJcblxyXG5cdFx0aWYgKGluaXRPcHRpb25zLmF1dG9EaXNtaXNzID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0aW5pdE9wdGlvbnMuYXV0b0Rpc21pc3MgPSBDb25zdGFudHMuQXV0b0Rpc21pc3NWYWx1ZXMuTm9BdXRvRGlzbWlzcztcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaW5pdE9wdGlvbnMub25EaXNtaXNzID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0aW5pdE9wdGlvbnMub25EaXNtaXNzID0gKGNhbXBhaWduSWQ6IHN0cmluZywgc3VibWl0dGVkOiBib29sZWFuKSA9PiB7IHJldHVybjsgfTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaW5pdE9wdGlvbnMub25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjayA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdGxldCBkZWZhdWx0T25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjazogSU9uU3VydmV5QWN0aXZhdGVkQ2FsbGJhY2sgPSB7XHJcblx0XHRcdFx0b25TdXJ2ZXlBY3RpdmF0ZWQobGF1bmNoZXI6IElTdXJ2ZXlMYXVuY2hlcik6IHZvaWQge1xyXG5cdFx0XHRcdFx0bGF1bmNoZXIubGF1bmNoKCk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdGluaXRPcHRpb25zLm9uU3VydmV5QWN0aXZhdGVkQ2FsbGJhY2sgPSBkZWZhdWx0T25TdXJ2ZXlBY3RpdmF0ZWRDYWxsYmFjaztcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoaW5pdE9wdGlvbnMudUlTdHJpbmdHZXR0ZXIgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRpbml0T3B0aW9ucy51SVN0cmluZ0dldHRlciA9IChzdHI6IHN0cmluZykgPT4gc3RyOyAvLyBCeSBkZWZhdWx0IHJldHVybiB0aGUgc3RyaW5nIGFzIGlzLlxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZmxvb2RnYXRlSW5pdE9wdGlvbnMgPSBpbml0T3B0aW9ucztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldCB0aGUgZmxvb2RnYXRlIHN1cnZleVxyXG5cdCAqL1xyXG5cdHB1YmxpYyBzZXRGbG9vZGdhdGVTdXJ2ZXkoc3VydmV5OiBJVUlTdXJ2ZXkpOiB2b2lkIHtcclxuXHRcdHRoaXMuZmxvb2RnYXRlU3VydmV5ID0gc3VydmV5O1xyXG5cdH1cclxufVxyXG5cclxubGV0IGNvbmZpZ3VyYXRpb246IENvbmZpZ3VyYXRpb24gPSBuZXcgQ29uZmlndXJhdGlvbigpO1xyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgY3VycmVudCBjb25maWd1cmF0aW9uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0KCk6IENvbmZpZ3VyYXRpb24ge1xyXG5cdHJldHVybiBjb25maWd1cmF0aW9uO1xyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgZmVlZGJhY2tUeXBlXHJcbiAqIEBwYXJhbSBmZWVkYmFja1R5cGUgZmVlZGJhY2tUeXBlXHJcbiAqIEByZXR1cm5zIHtDb25zdGFudHMuRmVlZGJhY2tUeXBlfSB0aGUgdmFsaWRhdGVkIGZlZWRiYWNrVHlwZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRmVlZGJhY2tUeXBlKGZlZWRiYWNrVHlwZTogc3RyaW5nKTogQ29uc3RhbnRzLkZlZWRiYWNrVHlwZSB7XHJcblx0VXRpbHMuZXhwZWN0U3RyaW5nKGZlZWRiYWNrVHlwZSwgXCJmZWVkYmFja1R5cGVcIik7XHJcblxyXG5cdGlmIChmZWVkYmFja1R5cGUgPT09IENvbnN0YW50cy5GZWVkYmFja1R5cGVbQ29uc3RhbnRzLkZlZWRiYWNrVHlwZS5TbWlsZV0pIHtcclxuXHRcdHJldHVybiBDb25zdGFudHMuRmVlZGJhY2tUeXBlLlNtaWxlO1xyXG5cdH0gZWxzZSBpZiAoZmVlZGJhY2tUeXBlID09PSBDb25zdGFudHMuRmVlZGJhY2tUeXBlW0NvbnN0YW50cy5GZWVkYmFja1R5cGUuRnJvd25dKSB7XHJcblx0XHRyZXR1cm4gQ29uc3RhbnRzLkZlZWRiYWNrVHlwZS5Gcm93bjtcclxuXHR9IGVsc2UgaWYgKGZlZWRiYWNrVHlwZSA9PT0gQ29uc3RhbnRzLkZlZWRiYWNrVHlwZVtDb25zdGFudHMuRmVlZGJhY2tUeXBlLkJ1Z10pIHtcclxuXHRcdHJldHVybiBDb25zdGFudHMuRmVlZGJhY2tUeXBlLkJ1ZztcclxuXHR9IGVsc2Uge1xyXG5cdFx0dGhyb3cgXCJmZWVkYmFja1R5cGUgc2hvdWxkIGJlIG9uZSBvZiBTbWlsZSwgRnJvd24gb3IgQnVnXCI7XHJcblx0fVxyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBDb25zdGFudHMudHNcclxuICpcclxuICogQSBtb2R1bGUgZm9yIGFsbCB0aGUgY29uc3RhbnRzLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBIVE1MIGF0dHJpYnV0ZSBuYW1lc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEF0dHJpYnV0ZU5hbWUge1xyXG5cdHB1YmxpYyBzdGF0aWMgQXJpYUxhYmVsOiBzdHJpbmcgPSBcImFyaWEtbGFiZWxcIjtcclxuXHRwdWJsaWMgc3RhdGljIENsYXNzOiBzdHJpbmcgPSBcImNsYXNzXCI7XHJcblx0cHVibGljIHN0YXRpYyBEYXRhSHRtbDJDYW52YXNJZ25vcmU6IHN0cmluZyA9IFwiZGF0YS1odG1sMmNhbnZhcy1pZ25vcmVcIjtcclxuXHRwdWJsaWMgc3RhdGljIERpc2FibGVkOiBzdHJpbmcgPSBcImRpc2FibGVkXCI7XHJcblx0cHVibGljIHN0YXRpYyBGaWxsOiBzdHJpbmcgPSBcImZpbGxcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvcjogc3RyaW5nID0gXCJmb3JcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvcm06IHN0cmluZyA9IFwiZm9ybVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgSGVpZ2h0OiBzdHJpbmcgPSBcImhlaWdodFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgSFJlZjogc3RyaW5nID0gXCJocmVmXCI7XHJcblx0cHVibGljIHN0YXRpYyBJZDogc3RyaW5nID0gXCJpZFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTWF4TGVuZ3RoOiBzdHJpbmcgPSBcIm1heGxlbmd0aFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTmFtZTogc3RyaW5nID0gXCJuYW1lXCI7XHJcblx0cHVibGljIHN0YXRpYyBQbGFjZWhvbGRlcjogc3RyaW5nID0gXCJwbGFjZWhvbGRlclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgUG9pbnRzOiBzdHJpbmcgPSBcInBvaW50c1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgUmVsOiBzdHJpbmcgPSBcInJlbFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgUm9sZTogc3RyaW5nID0gXCJyb2xlXCI7XHJcblx0cHVibGljIHN0YXRpYyBTb3VyY2U6IHN0cmluZyA9IFwic3JjXCI7XHJcblx0cHVibGljIHN0YXRpYyBTdHJva2U6IHN0cmluZyA9IFwic3Ryb2tlXCI7XHJcblx0cHVibGljIHN0YXRpYyBUYWJJbmRleDogc3RyaW5nID0gXCJ0YWJpbmRleFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVGFyZ2V0OiBzdHJpbmcgPSBcInRhcmdldFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVHJhbnNmb3JtOiBzdHJpbmcgPSBcInRyYW5zZm9ybVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVHlwZTogc3RyaW5nID0gXCJ0eXBlXCI7XHJcblx0cHVibGljIHN0YXRpYyBWYWx1ZTogc3RyaW5nID0gXCJ2YWx1ZVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVmlld0JveDogc3RyaW5nID0gXCJ2aWV3Qm94XCI7XHJcblx0cHVibGljIHN0YXRpYyBXaWR0aDogc3RyaW5nID0gXCJ3aWR0aFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgeGxpbmtIcmVmOiBzdHJpbmcgPSBcInhsaW5rOmhyZWZcIjtcclxuXHRwdWJsaWMgc3RhdGljIFg6IHN0cmluZyA9IFwieFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgWTogc3RyaW5nID0gXCJ5XCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIVE1MIGF0dHJpYnV0ZSB2YWx1ZXNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBdHRyaWJ1dGVWYWx1ZSB7XHJcblx0cHVibGljIHN0YXRpYyBCbGFua1dpbmRvdzogc3RyaW5nID0gXCJfYmxhbmtcIjtcclxuXHRwdWJsaWMgc3RhdGljIEJ1dHRvbjogc3RyaW5nID0gXCJidXR0b25cIjtcclxuXHRwdWJsaWMgc3RhdGljIENoZWNrYm94OiBzdHJpbmcgPSBcImNoZWNrYm94XCI7XHJcblx0cHVibGljIHN0YXRpYyBDaGVja2VkOiBzdHJpbmcgPSBcImNoZWNrZWRcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZhbHNlOiBzdHJpbmcgPSBcImZhbHNlXCI7XHJcblx0cHVibGljIHN0YXRpYyBaZXJvOiBzdHJpbmcgPSBcIjBcIjtcclxuXHRwdWJsaWMgc3RhdGljIFBvbGl0ZTogc3RyaW5nID0gXCJwb2xpdGVcIjtcclxuXHRwdWJsaWMgc3RhdGljIFJhZGlvOiBzdHJpbmcgPSBcInJhZGlvXCI7XHJcblx0cHVibGljIHN0YXRpYyBTdWJtaXQ6IHN0cmluZyA9IFwic3VibWl0XCI7XHJcblx0cHVibGljIHN0YXRpYyBUZXh0OiBzdHJpbmcgPSBcInRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRleHRBcmVhTWF4TGVuZ3RoOiBzdHJpbmcgPSBcIjEwMDBcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRydWU6IHN0cmluZyA9IFwidHJ1ZVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVW5jaGVja2VkOiBzdHJpbmcgPSBcInVuY2hlY2tlZFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTm9SZWZlcnJlcjogc3RyaW5nID0gXCJub3JlZmVycmVyXCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVUkwgUGFyYW1ldGVyc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFVybFBhcmFtZXRlcnMge1xyXG5cdHB1YmxpYyBzdGF0aWMgQ0xDSUQ6IHN0cmluZyA9IFwiQ0xDSURcIjtcclxufVxyXG5cclxuLyoqXHJcbiAqIENTUyBjbGFzc2VzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQ2xhc3NlcyB7XHJcblx0cHVibGljIHN0YXRpYyBDaGVja0JveDogc3RyaW5nID0gXCJvYmYtQ2hlY2tCb3hcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvbnRTdWJ0aXRsZTogc3RyaW5nID0gXCJvYmYtRm9udFN1YnRpdGxlXCI7XHJcblx0cHVibGljIHN0YXRpYyBGb250VGV4dDogc3RyaW5nID0gXCJvYmYtRm9udFRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvbnRTdWJUZXh0OiBzdHJpbmcgPSBcIm9iZi1Gb250U3ViVGV4dFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRm9udFN1YlN1YlRleHQ6IHN0cmluZyA9IFwib2JmLUZvbnRTdWJTdWJUZXh0XCI7XHJcblx0cHVibGljIHN0YXRpYyBIaWRkZW46IHN0cmluZyA9IFwib2JmLUhpZGRlblwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTGluazogc3RyaW5nID0gXCJvYmYtTGlua1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTWFyZ2luTGVmdDYwcHg6IHN0cmluZyA9IFwib2JmLU1hcmdpbkxlZnQ2MHB4XCI7XHJcblx0cHVibGljIHN0YXRpYyBOYXJyb3dMYXlvdXQ6IHN0cmluZyA9IFwib2JmLU5hcnJvd0xheW91dFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgUHJpdmFjeVN0YXRlbWVudExpbmtEaXY6IHN0cmluZyA9IFwib2JmLVByaXZhY3lTdGF0ZW1lbnRMaW5rRGl2XCI7XHJcblx0cHVibGljIHN0YXRpYyBSdGw6IHN0cmluZyA9IFwib2JmLVJ0bFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU3Bpbm5lcjogc3RyaW5nID0gXCJvYmYtU3Bpbm5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU3Bpbm5lckNpcmNsZTogc3RyaW5nID0gXCJvYmYtU3Bpbm5lckNpcmNsZVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU3VibWl0QnV0dG9uOiBzdHJpbmcgPSBcIm9iZi1TdWJtaXRCdXR0b25cIjtcclxuXHRwdWJsaWMgc3RhdGljIFRleHRJbnB1dDogc3RyaW5nID0gXCJvYmYtVGV4dElucHV0XCI7XHJcblx0cHVibGljIHN0YXRpYyBWaXNpYmxlOiBzdHJpbmcgPSBcIm9iZi1WaXNpYmxlXCI7XHJcblxyXG5cdC8vIHJhdGluZyBjb250cm9sXHJcblx0cHVibGljIHN0YXRpYyBSYXRpbmc6IHN0cmluZyA9IFwib2JmLVJhdGluZ1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgUmF0aW5nR3JhcGhpYzogc3RyaW5nID0gXCJvYmYtUmF0aW5nR3JhcGhpY1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgUmF0aW5nR3JhcGhpY0ZpbGxlZDogc3RyaW5nID0gXCJvYmYtUmF0aW5nR3JhcGhpYy1GaWxsZWRcIjtcclxuXHJcblx0Ly8gY2hvaWNlIGdyb3VwIGNvbnRyb2xcclxuXHRwdWJsaWMgc3RhdGljIENob2ljZUdyb3VwOiBzdHJpbmcgPSBcIm9iZi1DaG9pY2VHcm91cFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgQ2hvaWNlR3JvdXBJY29uOiBzdHJpbmcgPSBcIm9iZi1DaG9pY2VHcm91cEljb25cIjtcclxuXHJcblx0Ly8gcmVnaW9uIEJlbGx5QmFuZFxyXG5cclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxBbmNob3I6IHN0cmluZyA9IFwib2JmLU92ZXJhbGxBbmNob3JcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxBbmNob3JBY3RpdmU6IHN0cmluZyA9IFwib2JmLU92ZXJhbGxBbmNob3JBY3RpdmVcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxJbWFnZTogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbEltYWdlXCI7XHJcblx0cHVibGljIHN0YXRpYyBPdmVyYWxsVGV4dDogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbFRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIFNpbmdsZUxheW91dDogc3RyaW5nID0gXCJvYmYtU2luZ2xlTGF5b3V0XCI7XHJcblx0cHVibGljIHN0YXRpYyBTaG93UmlnaHRCb3JkZXI6IHN0cmluZyA9IFwib2JmLVNob3dSaWdodEJvcmRlclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU2xpZGVMZWZ0OiBzdHJpbmcgPSBcIm9iZi1zbGlkZUxlZnRcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRleHRBbGlnbkxlZnQ6IHN0cmluZyA9IFwib2JmLVRleHRBbGlnbkxlZnRcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvcm1Db250YWluZXI6IHN0cmluZyA9IFwib2JmLUZvcm1Db250YWluZXJcIjtcclxuXHJcblx0Ly8gZm9ybSBjbGFzc2VzXHJcblx0cHVibGljIHN0YXRpYyBGb3JtUXVlc3Rpb25NaWRkbGVUZXh0OiBzdHJpbmcgPSBcIm9iZi1Gb3JtUXVlc3Rpb25NaWRkbGVUZXh0XCI7XHJcblx0cHVibGljIHN0YXRpYyBGb3JtTWlkZGxlVGV4dDogc3RyaW5nID0gXCJvYmYtRm9ybU1pZGRsZVRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvcm1DYXRlZ29yaWVzRHJvcGRvd246IHN0cmluZyA9IFwib2JmLUZvcm1DYXRlZ29yaWVzRHJvcGRvd25cIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvcm1Db21tZW50OiBzdHJpbmcgPSBcIm9iZi1Gb3JtQ29tbWVudFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRm9ybVJhdGluZ0NvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtRm9ybVJhdGluZ0NvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRm9ybVJhdGluZ0xhYmVsOiBzdHJpbmcgPSBcIm9iZi1Gb3JtUmF0aW5nTGFiZWxcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvcm1SYXRpbmc6IHN0cmluZyA9IFwib2JmLUZvcm1SYXRpbmdcIjtcclxuXHRwdWJsaWMgc3RhdGljIEZvcm1FbWFpbElucHV0OiBzdHJpbmcgPSBcIm9iZi1Gb3JtRW1haWxJbnB1dFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRm9ybUJvdHRvbUNvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtRm9ybUJvdHRvbUNvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRm9ybVN1Ym1pdEJ1dHRvbkNvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtRm9ybVN1Ym1pdEJ1dHRvbkNvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRm9ybVNjcmVlbnNob3RDb250YWluZXI6IHN0cmluZyA9IFwib2JmLUZvcm1TY3JlZW5zaG90Q29udGFpbmVyXCI7XHJcblx0cHVibGljIHN0YXRpYyBGb3JtU2NyZWVuc2hvdExhYmVsOiBzdHJpbmcgPSBcIm9iZi1Gb3JtU2NyZWVuc2hvdExhYmVsXCI7XHJcblx0cHVibGljIHN0YXRpYyBGb3JtU2NyZWVuc2hvdENoZWNrYm94OiBzdHJpbmcgPSBcIm9iZi1Gb3JtU2NyZWVuc2hvdENoZWNrYm94XCI7XHJcblxyXG5cdC8vIGVtYWlsIHRleHRib3ggY2xhc3Nlc1xyXG5cdHB1YmxpYyBzdGF0aWMgVEZvcm1FbWFpbENoZWNrYm94OiBzdHJpbmcgPSBcIm9iZi1URm9ybUVtYWlsQ2hlY2tib3hcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRGb3JtRW1haWxMYWJlbDogc3RyaW5nID0gXCJvYmYtVEZvcm1FbWFpbExhYmVsIFwiO1xyXG5cclxuXHQvLyBlbWFpbCBjaGVja2JveCBjbGFzc2VzXHJcblx0cHVibGljIHN0YXRpYyBFbWFpbENoZWNrQm94TGFiZWw6IHN0cmluZyA9IFwib2JmLUVtYWlsQ2hlY2tCb3hMYWJlbFwiO1xyXG5cclxuXHQvLyBlbmRyZWdpb25cclxuXHJcblx0Ly8gcmVnaW9uIFRvYXN0XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgVG9hc3Q6IHN0cmluZyA9IFwib2JmLVRvYXN0XCI7XHJcblxyXG5cdC8vIGVuZHJlZ2lvblxyXG59XHJcblxyXG4vKipcclxuICogSFRNTCBlbGVtZW50IGlkc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIElEcyB7XHJcblx0Ly8gcmVnaW9uIEJlbGx5QmFuZFxyXG5cdHB1YmxpYyBzdGF0aWMgQ29sdW1uU2VwYXJhdG9yRGl2OiBzdHJpbmcgPSBcIm9iZi1Db2x1bW5TZXBhcmF0b3JEaXZcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxBbmNob3JzQ29udGFpbmVyOiBzdHJpbmcgPSBcIm9iZi1PdmVyYWxsQW5jaG9yc0NvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgT3ZlcmFsbEZyb3duQW5jaG9yOiBzdHJpbmcgPSBcIm9iZi1PdmVyYWxsRnJvd25BbmNob3JcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxGcm93bkRpdjogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbEZyb3duRGl2XCI7XHJcblx0cHVibGljIHN0YXRpYyBPdmVyYWxsRnJvd25JbWFnZTogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbEZyb3duSW1hZ2VcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxGcm93blRleHQ6IHN0cmluZyA9IFwib2JmLU92ZXJhbGxGcm93blRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxTbWlsZUFuY2hvcjogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbFNtaWxlQW5jaG9yXCI7XHJcblx0cHVibGljIHN0YXRpYyBPdmVyYWxsU21pbGVEaXY6IHN0cmluZyA9IFwib2JmLU92ZXJhbGxTbWlsZURpdlwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgT3ZlcmFsbFNtaWxlSW1hZ2U6IHN0cmluZyA9IFwib2JmLU92ZXJhbGxTbWlsZUltYWdlXCI7XHJcblx0cHVibGljIHN0YXRpYyBPdmVyYWxsU21pbGVUZXh0OiBzdHJpbmcgPSBcIm9iZi1PdmVyYWxsU21pbGVUZXh0XCI7XHJcblx0cHVibGljIHN0YXRpYyBPdmVyYWxsSWRlYUFuY2hvcjogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbElkZWFBbmNob3JcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxJZGVhRGl2OiBzdHJpbmcgPSBcIm9iZi1PdmVyYWxsSWRlYURpdlwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgT3ZlcmFsbElkZWFJbWFnZTogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbElkZWFJbWFnZVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgT3ZlcmFsbElkZWFUZXh0OiBzdHJpbmcgPSBcIm9iZi1PdmVyYWxsSWRlYVRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxCdWdBbmNob3I6IHN0cmluZyA9IFwib2JmLU92ZXJhbGxCdWdBbmNob3JcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxCdWdEaXY6IHN0cmluZyA9IFwib2JmLU92ZXJhbGxCdWdEaXZcIjtcclxuXHRwdWJsaWMgc3RhdGljIE92ZXJhbGxCdWdJbWFnZTogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbEJ1Z0ltYWdlXCI7XHJcblx0cHVibGljIHN0YXRpYyBPdmVyYWxsQnVnVGV4dDogc3RyaW5nID0gXCJvYmYtT3ZlcmFsbEJ1Z1RleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIFF1ZXN0aW9uTGVmdFRleHQ6IHN0cmluZyA9IFwib2JmLVF1ZXN0aW9uTGVmdFRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIExlZnRGb3JtQ29udGFpbmVyOiBzdHJpbmcgPSBcIm9iZi1MZWZ0Rm9ybUNvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTWFpbkNvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtTWFpbkNvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTWFpbkNvbnRlbnRIb2xkZXI6IHN0cmluZyA9IFwib2JmLU1haW5Db250ZW50SG9sZGVyXCI7XHJcblx0cHVibGljIHN0YXRpYyBNaWRkbGVGb3JtQ29udGFpbmVyOiBzdHJpbmcgPSBcIm9iZi1NaWRkbGVGb3JtQ29udGFpbmVyXCI7XHJcblx0cHVibGljIHN0YXRpYyBPdmVybGF5QmFja2dyb3VuZDogc3RyaW5nID0gXCJvYmYtT3ZlcmxheUJhY2tncm91bmRcIjtcclxuXHRwdWJsaWMgc3RhdGljIFByaXZhY3lTdGF0ZW1lbnRMaW5rOiBzdHJpbmcgPSBcIm9iZi1Qcml2YWN5U3RhdGVtZW50TGlua1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRmlyc3RUYWJiYWJsZTogc3RyaW5nID0gXCJvYmYtRmlyc3RUYWJiYWJsZVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTGFzdFRhYmJhYmxlOiBzdHJpbmcgPSBcIm9iZi1MYXN0VGFiYmFibGVcIjtcclxuXHJcblx0Ly8gU2luZ2xlIGZvcm0gaWRzXHJcblx0cHVibGljIHN0YXRpYyBTaW5nbGVGb3JtQ29udGFpbmVyOiBzdHJpbmcgPSBcIm9iZi1TaW5nbGVGb3JtQ29udGFpbmVyXCI7XHJcblx0cHVibGljIHN0YXRpYyBTaW5nbGVGb3JtUXVlc3Rpb25NaWRkbGVUZXh0OiBzdHJpbmcgPSBcIm9iZi1TaW5nbGVGb3JtUXVlc3Rpb25NaWRkbGVUZXh0XCI7XHJcblx0cHVibGljIHN0YXRpYyBTaW5nbGVGb3JtQ2F0ZWdvcmllc0Ryb3Bkb3duOiBzdHJpbmcgPSBcIm9iZi1TaW5nbGVGb3JtQ2F0ZWdvcmllc0Ryb3Bkb3duXCI7XHJcblx0cHVibGljIHN0YXRpYyBTaW5nbGVGb3JtQ29tbWVudDogc3RyaW5nID0gXCJvYmYtU2luZ2xlRm9ybUNvbW1lbnRcIjtcclxuXHRwdWJsaWMgc3RhdGljIFNpbmdsZUZvcm1FbWFpbElucHV0OiBzdHJpbmcgPSBcIm9iZi1TaW5nbGVGb3JtRW1haWxJbnB1dFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU2luZ2xlRm9ybVJhdGluZzogc3RyaW5nID0gXCJvYmYtU2luZ2xlRm9ybVJhdGluZ1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU2luZ2xlRm9ybVNjcmVlbnNob3RDaGVja2JveDogc3RyaW5nID0gXCJvYmYtU2luZ2xlRm9ybVNjcmVlbnNob3RDaGVja2JveFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU2luZ2xlRm9ybVN1Ym1pdEJ1dHRvbjogc3RyaW5nID0gXCJvYmYtU2luZ2xlRm9ybVN1Ym1pdEJ1dHRvblwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU2luZ2xlRm9ybVN1Ym1pdEJ1dHRvblNwaW5uZXI6IHN0cmluZyA9IFwib2JmLVNpbmdsZUZvcm1TdWJtaXRCdXR0b25TcGlubmVyXCI7XHJcblxyXG5cdC8vIEJhc2ljIGZvcm0gaWRzXHJcblx0cHVibGljIHN0YXRpYyBCYXNpY0Zvcm1Db250YWluZXI6IHN0cmluZyA9IFwib2JmLUJhc2ljRm9ybUNvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgQmFzaWNGb3JtUXVlc3Rpb25NaWRkbGVUZXh0OiBzdHJpbmcgPSBcIm9iZi1CYXNpY0Zvcm1RdWVzdGlvbk1pZGRsZVRleHRcIjtcclxuXHRwdWJsaWMgc3RhdGljIEJhc2ljRm9ybUNhdGVnb3JpZXNEcm9wZG93bjogc3RyaW5nID0gXCJvYmYtQmFzaWNGb3JtQ2F0ZWdvcmllc0Ryb3Bkb3duXCI7XHJcblx0cHVibGljIHN0YXRpYyBCYXNpY0Zvcm1Db21tZW50OiBzdHJpbmcgPSBcIm9iZi1CYXNpY0Zvcm1Db21tZW50XCI7XHJcblx0cHVibGljIHN0YXRpYyBCYXNpY0Zvcm1FbWFpbElucHV0OiBzdHJpbmcgPSBcIm9iZi1CYXNpY0Zvcm1FbWFpbElucHV0XCI7XHJcblx0cHVibGljIHN0YXRpYyBCYXNpY0Zvcm1SYXRpbmc6IHN0cmluZyA9IFwib2JmLUJhc2ljRm9ybVJhdGluZ1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgQmFzaWNGb3JtU2NyZWVuc2hvdENoZWNrYm94OiBzdHJpbmcgPSBcIm9iZi1CYXNpY0Zvcm1TY3JlZW5zaG90Q2hlY2tib3hcIjtcclxuXHRwdWJsaWMgc3RhdGljIEJhc2ljRm9ybVN1Ym1pdEJ1dHRvbjogc3RyaW5nID0gXCJvYmYtQmFzaWNGb3JtU3VibWl0QnV0dG9uXCI7XHJcblx0cHVibGljIHN0YXRpYyBCYXNpY0Zvcm1TdWJtaXRCdXR0b25TcGlubmVyOiBzdHJpbmcgPSBcIm9iZi1CYXNpY0Zvcm1TdWJtaXRCdXR0b25TcGlubmVyXCI7XHJcblxyXG5cdC8vIFVzZXJWb2ljZSBmb3JtIGlkc1xyXG5cdHB1YmxpYyBzdGF0aWMgVXNlclZvaWNlRm9ybUNvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtVXNlclZvaWNlRm9ybUNvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVXNlclZvaWNlRm9ybUdvQnV0dG9uOiBzdHJpbmcgPSBcIm9iZi1Vc2VyVm9pY2VGb3JtR29CdXR0b25cIjtcclxuXHJcblx0Ly8gZW5kcmVnaW9uXHJcblxyXG5cdC8vIHJlZ2lvbiBUb2FzdFxyXG5cdHB1YmxpYyBzdGF0aWMgVG9hc3RDb250YWluZXI6IHN0cmluZyA9IFwib2JmLVRvYXN0Q29udGFpbmVyXCI7XHJcblx0cHVibGljIHN0YXRpYyBUb2FzdENhbmNlbDogc3RyaW5nID0gXCJvYmYtVG9hc3RDYW5jZWxcIjtcclxuXHJcblx0Ly8gUHJvbXB0IGlkc1xyXG5cdHB1YmxpYyBzdGF0aWMgVFByb21wdENvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtVFByb21wdENvbnRhaW5lclwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVFByb21wdFRpdGxlOiBzdHJpbmcgPSBcIm9iZi1UUHJvbXB0VGl0bGVcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRQcm9tcHRUZXh0OiBzdHJpbmcgPSBcIm9iZi1UUHJvbXB0VGV4dFwiO1xyXG5cclxuXHQvLyBTdXJ2ZXkgaWRzXHJcblx0cHVibGljIHN0YXRpYyBURm9ybUNvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtVEZvcm1Db250YWluZXJcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRGb3JtVGl0bGU6IHN0cmluZyA9IFwib2JmLVRGb3JtVGl0bGVcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRGb3JtUmF0aW5nOiBzdHJpbmcgPSBcIm9iZi1URm9ybVJhdGluZ1wiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVEZvcm1Db21tZW50OiBzdHJpbmcgPSBcIm9iZi1URm9ybUNvbW1lbnRcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRGb3JtRW1haWxUZXh0Qm94OiBzdHJpbmcgPSBcIm9iZi1URm9ybUVtYWlsVGV4dEJveFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVEZvcm1FbWFpbENoZWNrQm94OiBzdHJpbmcgPSBcIm9iZi1URm9ybUVtYWlsQ2hlY2tCb3hcIjtcclxuXHRwdWJsaWMgc3RhdGljIFRGb3JtRW1haWxMYWJlbDogc3RyaW5nID0gXCJvYmYtVEZvcm1FbWFpbExhYmVsXCI7XHJcblx0cHVibGljIHN0YXRpYyBURm9ybVN1Ym1pdEJ1dHRvbjogc3RyaW5nID0gXCJvYmYtVEZvcm1TdWJtaXRCdXR0b25cIjtcclxuXHRwdWJsaWMgc3RhdGljIFRGb3JtU3VibWl0QnV0dG9uU3Bpbm5lcjogc3RyaW5nID0gXCJvYmYtVEZvcm1TdWJtaXRCdXR0b25TcGlubmVyXCI7XHJcblx0cHVibGljIHN0YXRpYyBURm9ybVN1Ym1pdEJ1dHRvbkNvbnRhaW5lcjogc3RyaW5nID0gXCJvYmYtVEZvcm1TdWJtaXRCdXR0b25Db250YWluZXJcIjtcclxuXHJcblx0Ly8gZW5kcmVnaW9uXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBLZXlzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgS2V5cyB7XHJcblx0cHVibGljIHN0YXRpYyBFc2M6IG51bWJlciA9IDI3O1xyXG5cdHB1YmxpYyBzdGF0aWMgVGFiOiBudW1iZXIgPSA5O1xyXG59XHJcblxyXG4vKipcclxuICogVmFsdWVzIGZvciB0eXBlcyBvZiBmZWVkYmFjayB0aGF0IGdvIGludG8gdGhlIGpzb25cclxuICogQWxzbyB1c2VkIHRvIGRldGVybWluZSB0aGUgRm9ybVRlbXBsYXRlIHVzZWQgb24gZWFjaCBvbmUgb2YgdGhlIGZlZWRiYWNrIHR5cGVzLlxyXG4gKi9cclxuZXhwb3J0IGVudW0gRmVlZGJhY2tUeXBlIHtcclxuXHRTbWlsZSxcclxuXHRGcm93bixcclxuXHRJZGVhLFxyXG5cdEJ1Z1xyXG59XHJcblxyXG4vKipcclxuICogVmFsdWVzIGZvciB0aGUgZW52aXJvbm1lbnRcclxuICovXHJcbmV4cG9ydCBlbnVtIEVudmlyb25tZW50IHtcclxuXHRQcm9kdWN0aW9uLFxyXG5cdEludFxyXG59XHJcblxyXG4vKipcclxuICogVmFsdWVzIGZvciBhdXRvZGlzbWlzc1xyXG4gKi9cclxuZXhwb3J0IGVudW0gQXV0b0Rpc21pc3NWYWx1ZXMge1xyXG5cdE5vQXV0b0Rpc21pc3MsXHJcblx0U2V2ZW5TZWNvbmRzLFxyXG5cdEZvdXJ0ZWVuU2Vjb25kcyxcclxuXHRUd2VudHlPbmVTZWNvbmRzLFxyXG5cdFR3ZW50eUVpZ2h0U2Vjb25kc1xyXG59XHJcblxyXG4vKipcclxuICogSFRNTCB0YWdzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgVGFncyB7XHJcblx0cHVibGljIHN0YXRpYyBBbmNob3I6IHN0cmluZyA9IFwiQVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgQnV0dG9uOiBzdHJpbmcgPSBcImJ1dHRvblwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRGVmczogc3RyaW5nID0gXCJkZWZzXCI7XHJcblx0cHVibGljIHN0YXRpYyBEaXY6IHN0cmluZyA9IFwiZGl2XCI7XHJcblx0cHVibGljIHN0YXRpYyBGaWVsZFNldDogc3RyaW5nID0gXCJmaWVsZHNldFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgRm9ybTogc3RyaW5nID0gXCJmb3JtXCI7XHJcblx0cHVibGljIHN0YXRpYyBJbWc6IHN0cmluZyA9IFwiaW1nXCI7XHJcblx0cHVibGljIHN0YXRpYyBJbnB1dDogc3RyaW5nID0gXCJpbnB1dFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgTGFiZWw6IHN0cmluZyA9IFwibGFiZWxcIjtcclxuXHRwdWJsaWMgc3RhdGljIExlZ2VuZDogc3RyaW5nID0gXCJsZWdlbmRcIjtcclxuXHRwdWJsaWMgc3RhdGljIE9wdGlvbjogc3RyaW5nID0gXCJvcHRpb25cIjtcclxuXHRwdWJsaWMgc3RhdGljIFBvbHlnb246IHN0cmluZyA9IFwicG9seWdvblwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU2VsZWN0OiBzdHJpbmcgPSBcInNlbGVjdFwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgU3Bhbjogc3RyaW5nID0gXCJzcGFuXCI7XHJcblx0cHVibGljIHN0YXRpYyBTdmc6IHN0cmluZyA9IFwic3ZnXCI7XHJcblx0cHVibGljIHN0YXRpYyBUZXh0QXJlYTogc3RyaW5nID0gXCJ0ZXh0YXJlYVwiO1xyXG5cdHB1YmxpYyBzdGF0aWMgVXNlOiBzdHJpbmcgPSBcInVzZVwiO1xyXG59XHJcblxyXG4vKipcclxuICogVVJMc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFVybHMge1xyXG5cdC8qKlxyXG5cdCAqIExpbmsgdG8gdGhlIGZlZWRiYWNrIFByaXZhY3kgU3RhdGVtZW50XHJcblx0ICovXHJcblx0cHVibGljIHN0YXRpYyBQcml2YWN5U3RhdGVtZW50TGluazogc3RyaW5nID0gXCJodHRwOi8vZ28ubWljcm9zb2Z0LmNvbS9md2xpbmsvP0xpbmtJRD0zOTAwMDRcIjtcclxufVxyXG4iLCIvKipcclxuICogU3VydmV5IGxhdW5jaGVyIGZhY3RvcnkgZm9yIFdlYiBTREtcclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBBcGkgZnJvbSBcIkBtcy1vZmIvb2ZmaWNlZmxvb2RnYXRlY29yZS9kaXN0L3NyYy9BcGkvQXBpXCI7XHJcbmltcG9ydCBVSVN1cnZleSBmcm9tIFwiLi8uLi9GbG9vZGdhdGVDb3JlL1VJU3VydmV5L1VJU3VydmV5XCI7XHJcbmltcG9ydCAqIGFzIFdpbmRvdyBmcm9tIFwiLi8uLi9XaW5kb3cvV2luZG93XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZGFwdGl2ZVN1cnZleUxhdW5jaGVyRmFjdG9yeSBpbXBsZW1lbnRzIEFwaS5JU3VydmV5TGF1bmNoZXJGYWN0b3J5IHtcclxuXHRwdWJsaWMgbWFrZVN1cnZleUxhdW5jaGVyKHN1cnZleTogQXBpLklTdXJ2ZXkpOiBBcGkuSVN1cnZleUxhdW5jaGVyIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBSdWRlU3VydmV5TGF1bmNoZXIoc3VydmV5KTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIFJ1ZGVTdXJ2ZXlMYXVuY2hlciBpbXBsZW1lbnRzIEFwaS5JU3VydmV5TGF1bmNoZXIge1xyXG5cdHByaXZhdGUgc3VydmV5OiBBcGkuSVN1cnZleTtcclxuXHJcblx0Y29uc3RydWN0b3Ioc3VydmV5OiBBcGkuSVN1cnZleSkge1xyXG5cdFx0dGhpcy5zdXJ2ZXkgPSBzdXJ2ZXk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgbGF1bmNoKCk6IHZvaWQge1xyXG5cdFx0V2luZG93LmdldCgpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUuc2hvd1N1cnZleShuZXcgVUlTdXJ2ZXkodGhpcy5zdXJ2ZXkpKTtcclxuXHR9XHJcbn1cclxuIiwiLyoqXHJcbiAqIEltcGxlbWVudGF0aW9uIGZvciBJRmxvb2RnYXRlRW52aXJvbm1lbnRQcm92aWRlciBmb3Igd2ViIFNESy5cclxuICogV2UgcGFzcyB0aGUgU0RLJ3MgaW50ZXJuYWwgbG9jYWxlIGhlcmUgYW5kIG5vdCB0aGUgb25lIHdoaWNoIHRoZSBob3N0IGFwcCBzcGVjaWZpZXMuXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgQXBpIGZyb20gXCJAbXMtb2ZiL29mZmljZWZsb29kZ2F0ZWNvcmUvZGlzdC9zcmMvQXBpL0FwaVwiO1xyXG5pbXBvcnQgKiBhcyBDb25maWd1cmF0aW9uIGZyb20gXCIuLy4uL0NvbmZpZ3VyYXRpb24vQ29uZmlndXJhdGlvblwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmxvb2RnYXRlRW52aXJvbm1lbnRQcm92aWRlciBpbXBsZW1lbnRzIEFwaS5JRmxvb2RnYXRlRW52aXJvbm1lbnRQcm92aWRlciB7XHJcblx0cHVibGljIGdldExhbmd1YWdlKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRDb21tb25Jbml0T3B0aW9ucygpLm9yaWdpbmFsTG9jYWxlO1xyXG5cdH1cclxufVxyXG4iLCIvKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlciBmb3IgV2ViIFNES1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IElGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIgfSBmcm9tIFwiQG1zLW9mYi9vZmZpY2VmbG9vZGdhdGVjb3JlL2Rpc3Qvc3JjL0FwaS9BcGlcIjtcclxuaW1wb3J0ICogYXMgV2luZG93IGZyb20gXCIuLy4uL1dpbmRvdy9XaW5kb3dcIjtcclxuaW1wb3J0ICogYXMgTG9nZ2luZyBmcm9tIFwiLi8uLi9Mb2dnaW5nL0xvZ2dpbmdcIjtcclxuaW1wb3J0IEZpbGVUeXBlID0gSUZsb29kZ2F0ZVN0b3JhZ2VQcm92aWRlci5GaWxlVHlwZTtcclxuXHJcbmludGVyZmFjZSBJRmlsZVRvS2V5TWFwIHtcclxuXHRbZmlsZVR5cGU6IHN0cmluZ106IHN0cmluZztcclxufVxyXG5cclxubGV0IGZpbGVUeXBlVG9LZXlNYXA6IElGaWxlVG9LZXlNYXAgPSB7fTtcclxuZmlsZVR5cGVUb0tleU1hcFtGaWxlVHlwZS5DYW1wYWlnbkRlZmluaXRpb25zLnRvU3RyaW5nKCldID0gXCJvYmYtQ2FtcGFpZ25EZWZpbml0aW9uc1wiO1xyXG5maWxlVHlwZVRvS2V5TWFwW0ZpbGVUeXBlLkNhbXBhaWduU3RhdGVzLnRvU3RyaW5nKCldID0gXCJvYmYtQ2FtcGFpZ25TdGF0ZXNcIjtcclxuZmlsZVR5cGVUb0tleU1hcFtGaWxlVHlwZS5GbG9vZGdhdGVTZXR0aW5ncy50b1N0cmluZygpXSA9IFwib2JmLUZsb29kZ2F0ZVNldHRpbmdzXCI7XHJcbmZpbGVUeXBlVG9LZXlNYXBbRmlsZVR5cGUuR292ZXJuZWRDaGFubmVsU3RhdGVzLnRvU3RyaW5nKCldID0gXCJvYmYtR292ZXJuZWRDaGFubmVsU3RhdGVzXCI7XHJcbmZpbGVUeXBlVG9LZXlNYXBbRmlsZVR5cGUuU3VydmV5QWN0aXZhdGlvblN0YXRzLnRvU3RyaW5nKCldID0gXCJvYmYtU3VydmV5QWN0aXZhdGlvblN0YXRzXCI7XHJcbmZpbGVUeXBlVG9LZXlNYXBbRmlsZVR5cGUuU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzLnRvU3RyaW5nKCldID0gXCJvYmYtU3VydmV5RXZlbnRBY3Rpdml0eVN0YXRzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGbG9vZGdhdGVTdG9yYWdlUHJvdmlkZXIgaW1wbGVtZW50cyBJRmxvb2RnYXRlU3RvcmFnZVByb3ZpZGVyIHtcclxuXHQvKipcclxuXHQgKiBDb2RlIHRvIGRldGVjdCBsb2NhbFN0b3JhZ2UgcHJlc2VuY2UuXHJcblx0ICogQ29waWVkIGZyb20gTUROOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvV2ViX1N0b3JhZ2VfQVBJL1VzaW5nX3RoZV9XZWJfU3RvcmFnZV9BUElcclxuXHQgKi9cclxuXHRwdWJsaWMgc3RhdGljIGlzU3RvcmFnZUF2YWlsYWJsZSgpOiBib29sZWFuIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGxldCB4ID0gXCJfX3N0b3JhZ2VfdGVzdF9fXCI7XHJcblx0XHRcdFdpbmRvdy5nZXQoKS5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSh4LCB4KTtcclxuXHRcdFx0V2luZG93LmdldCgpLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHgpO1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0cmV0dXJuIGUgaW5zdGFuY2VvZiBET01FeGNlcHRpb24gJiYgKFxyXG5cdFx0XHRcdC8vIGV2ZXJ5dGhpbmcgZXhjZXB0IEZpcmVmb3hcclxuXHRcdFx0XHRlLmNvZGUgPT09IDIyIHx8XHJcblx0XHRcdFx0Ly8gRmlyZWZveFxyXG5cdFx0XHRcdGUuY29kZSA9PT0gMTAxNCB8fFxyXG5cdFx0XHRcdC8vIHRlc3QgbmFtZSBmaWVsZCB0b28sIGJlY2F1c2UgY29kZSBtaWdodCBub3QgYmUgcHJlc2VudFxyXG5cdFx0XHRcdC8vIGV2ZXJ5dGhpbmcgZXhjZXB0IEZpcmVmb3hcclxuXHRcdFx0XHRlLm5hbWUgPT09IFwiUXVvdGFFeGNlZWRlZEVycm9yXCIgfHxcclxuXHRcdFx0XHQvLyBGaXJlZm94XHJcblx0XHRcdFx0ZS5uYW1lID09PSBcIk5TX0VSUk9SX0RPTV9RVU9UQV9SRUFDSEVEXCIpICYmXHJcblx0XHRcdFx0Ly8gYWNrbm93bGVkZ2UgUXVvdGFFeGNlZWRlZEVycm9yIG9ubHkgaWYgdGhlcmUncyBzb21ldGhpbmcgYWxyZWFkeSBzdG9yZWRcclxuXHRcdFx0XHRXaW5kb3cuZ2V0KCkubG9jYWxTdG9yYWdlLmxlbmd0aCAhPT0gMDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIExvY2sgdGhlIGZpbGUgdG8gcHJldmVudCBhY2Nlc3MgZnJvbSBhbm90aGVyIHByb2Nlc3MuXHJcblx0ICovXHJcblx0cHVibGljIGZpbGVMb2NrKGZpbGVUeXBlOiBGaWxlVHlwZSk6IHZvaWQge1xyXG5cdFx0Ly8gSlMgcnVucyBvbiBhIHNpbmdsZSB0aHJlYWQgaW4gdGhlIGJyb3dzZXIuXHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBVbmxvY2sgdGhlIGZpbGUuXHJcblx0ICovXHJcblx0cHVibGljIGZpbGVVbmxvY2soZmlsZVR5cGU6IEZpbGVUeXBlKTogdm9pZCB7XHJcblx0XHQvLyBKUyBydW5zIG9uIGEgc2luZ2xlIHRocmVhZCBpbiB0aGUgYnJvd3Nlci5cclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFJlYWQgdGhlIGZpbGVcclxuXHQgKi9cclxuXHRwdWJsaWMgcmVhZChmaWxlVHlwZTogRmlsZVR5cGUpOiBzdHJpbmcge1xyXG5cdFx0aWYgKCEoZmlsZVR5cGUgaW4gRmlsZVR5cGUpIHx8ICFmaWxlVHlwZVRvS2V5TWFwLmhhc093blByb3BlcnR5KGZpbGVUeXBlLnRvU3RyaW5nKCkpKSB7XHJcblx0XHRcdHJldHVybiBcIlwiO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBzdG9yYWdlS2V5ID0gZmlsZVR5cGVUb0tleU1hcFtmaWxlVHlwZV07XHJcblx0XHRsZXQgcmVzdWx0OiBzdHJpbmc7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRyZXN1bHQgPSBXaW5kb3cuZ2V0KCkubG9jYWxTdG9yYWdlLmdldEl0ZW0oc3RvcmFnZUtleSk7XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5TdXJ2ZXkuRmxvb2RnYXRlLkZpbGVSZWFkLkZhaWxlZC5WQUxVRSxcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRFcnJvck1lc3NhZ2U6IGUudG9TdHJpbmcoKSxcclxuXHRcdFx0XHRcdEZpbGVOYW1lOiBzdG9yYWdlS2V5LFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm4gXCJcIjtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogV3JpdGUgdG8gdGhlIGZpbGVcclxuXHQgKi9cclxuXHRwdWJsaWMgd3JpdGUoZmlsZVR5cGU6IEZpbGVUeXBlLCBjb250ZW50OiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdGlmICghKGZpbGVUeXBlIGluIEZpbGVUeXBlKSB8fCAhZmlsZVR5cGVUb0tleU1hcC5oYXNPd25Qcm9wZXJ0eShmaWxlVHlwZS50b1N0cmluZygpKSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHN0b3JhZ2VLZXkgPSBmaWxlVHlwZVRvS2V5TWFwW2ZpbGVUeXBlXTtcclxuXHRcdHRyeSB7XHJcblx0XHRcdFdpbmRvdy5nZXQoKS5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCBjb250ZW50KTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0TG9nZ2luZy5nZXRMb2dnZXIoKS5sb2dFdmVudChMb2dnaW5nLkV2ZW50SWRzLlN1cnZleS5GbG9vZGdhdGUuRmlsZVdyaXRlLkZhaWxlZC5WQUxVRSxcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRFcnJvck1lc3NhZ2U6IGUudG9TdHJpbmcoKSxcclxuXHRcdFx0XHRcdEZpbGVOYW1lOiBzdG9yYWdlS2V5LFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsIi8qKlxyXG4gKiBJbXBsZW1lbnRhdGlvbiBvZiBJRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIgZm9yIFdlYiBTREtcclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBBcGkgZnJvbSBcIkBtcy1vZmIvb2ZmaWNlZmxvb2RnYXRlY29yZS9kaXN0L3NyYy9BcGkvQXBpXCI7XHJcbmltcG9ydCAqIGFzIFVJU3RyaW5ncyBmcm9tIFwiLi8uLi9VSVN0cmluZ3MvVUlTdHJpbmdzXCI7XHJcbmltcG9ydCAqIGFzIENvbmZpZ3VyYXRpb24gZnJvbSBcIi4vLi4vQ29uZmlndXJhdGlvbi9Db25maWd1cmF0aW9uXCI7XHJcblxyXG4vKiB0c2xpbnQ6ZGlzYWJsZTptYXgtbGluZS1sZW5ndGggKi9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyIGltcGxlbWVudHMgQXBpLklGbG9vZGdhdGVTdHJpbmdQcm92aWRlciB7XHJcblx0cHVibGljIGxvYWRTdHJpbmdSZXNvdXJjZShzdHJpbmdJZDogQXBpLklGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlKTogc3RyaW5nIHtcclxuXHRcdGxldCB1aVN0cmluZ3MgPSBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCk7XHJcblxyXG5cdFx0c3dpdGNoIChzdHJpbmdJZCkge1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTApOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWUwO1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTEpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWUxO1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTIpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWUyO1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTMpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWUzO1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTQpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWU0O1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTUpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWU1O1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTYpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWU2O1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTcpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWU3O1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTgpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWU4O1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTkpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czExVmFsdWU5O1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzMTFSYXRpbmdWYWx1ZTEwKTpcdFx0cmV0dXJuIHVpU3RyaW5ncy5GbG9vZGdhdGUuTnBzLlJhdGluZy5Qb2ludHMxMVZhbHVlMTA7XHJcblx0XHRcdGNhc2UgKEFwaS5JRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZS5OcHM1UmF0aW5nVmFsdWUxKTpcdFx0cmV0dXJuIHVpU3RyaW5ncy5GbG9vZGdhdGUuTnBzLlJhdGluZy5Qb2ludHM1VmFsdWUxO1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzNVJhdGluZ1ZhbHVlMik6XHRcdHJldHVybiB1aVN0cmluZ3MuRmxvb2RnYXRlLk5wcy5SYXRpbmcuUG9pbnRzNVZhbHVlMjtcclxuXHRcdFx0Y2FzZSAoQXBpLklGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wczVSYXRpbmdWYWx1ZTMpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUmF0aW5nLlBvaW50czVWYWx1ZTM7XHJcblx0XHRcdGNhc2UgKEFwaS5JRmxvb2RnYXRlU3RyaW5nUHJvdmlkZXIuU3RyaW5nVHlwZS5OcHM1UmF0aW5nVmFsdWU0KTpcdFx0cmV0dXJuIHVpU3RyaW5ncy5GbG9vZGdhdGUuTnBzLlJhdGluZy5Qb2ludHM1VmFsdWU0O1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzNVJhdGluZ1ZhbHVlNSk6XHRcdHJldHVybiB1aVN0cmluZ3MuRmxvb2RnYXRlLk5wcy5SYXRpbmcuUG9pbnRzNVZhbHVlNTtcclxuXHRcdFx0Y2FzZSAoQXBpLklGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1JhdGluZ1F1ZXN0aW9uKTpcdFx0cmV0dXJuIHVpU3RyaW5ncy5GbG9vZGdhdGUuTnBzLlJhdGluZy5RdWVzdGlvbjtcclxuXHRcdFx0Y2FzZSAoQXBpLklGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc0NvbW1lbnRRdWVzdGlvbik6XHRcdHJldHVybiB1aVN0cmluZ3MuRmxvb2RnYXRlLk5wcy5Db21tZW50LlF1ZXN0aW9uO1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzUHJvbXB0Tm90Tm93TGFiZWwpOlx0cmV0dXJuIHVpU3RyaW5ncy5GbG9vZGdhdGUuTnBzLlByb21wdC5ObztcclxuXHRcdFx0Y2FzZSAoQXBpLklGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFF1ZXN0aW9uKTpcdFx0cmV0dXJuIHVpU3RyaW5ncy5GbG9vZGdhdGUuTnBzLlByb21wdC5RdWVzdGlvbjtcclxuXHRcdFx0Y2FzZSAoQXBpLklGbG9vZGdhdGVTdHJpbmdQcm92aWRlci5TdHJpbmdUeXBlLk5wc1Byb21wdFRpdGxlKTpcdFx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUHJvbXB0LlRpdGxlO1xyXG5cdFx0XHRjYXNlIChBcGkuSUZsb29kZ2F0ZVN0cmluZ1Byb3ZpZGVyLlN0cmluZ1R5cGUuTnBzUHJvbXB0WWVzTGFiZWwpOlx0XHRyZXR1cm4gdWlTdHJpbmdzLkZsb29kZ2F0ZS5OcHMuUHJvbXB0LlllcztcclxuXHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRyZXR1cm4gXCJcIjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRDdXN0b21TdHJpbmcoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlSW5pdE9wdGlvbnMoKS51SVN0cmluZ0dldHRlcihzdHIpO1xyXG5cdH1cclxufVxyXG4iLCIvKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgSUZsb29kZ2F0ZVRlbGVtZXRyeUxvZ2dlciBmb3IgV2ViIFNES1xyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIEFwaSBmcm9tIFwiQG1zLW9mYi9vZmZpY2VmbG9vZGdhdGVjb3JlL2Rpc3Qvc3JjL0FwaS9BcGlcIjtcclxuaW1wb3J0ICogYXMgTG9nZ2luZyBmcm9tIFwiLi4vTG9nZ2luZy9Mb2dnaW5nXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJRmxvb2RnYXRlVGVsZW1ldHJ5TG9nZ2VyIGltcGxlbWVudHMgQXBpLklGbG9vZGdhdGVUZWxlbWV0cnlMb2dnZXIge1xyXG5cdC8qKlxyXG5cdCAqIExvZyB0aGF0IGEgc3VydmV5J3MgdHJpZ2dlciB3YXMgbWV0LlxyXG5cdCAqIEBwYXJhbSBjYW1wYWlnbklkIElkIG9mIHRoZSBjYW1wYWlnbiB0aGUgc3VydmV5IGJlbG9uZ3MgdG8uXHJcblx0ICogQHBhcmFtIHN1cnZleUlkIElkIG9mIHRoZSBzdXJ2ZXkuXHJcblx0ICogQHBhcmFtIHN1cnZleVR5cGUgVHlwZSBvZiB0aGUgc3VydmV5LlxyXG5cdCAqL1xyXG5cdHB1YmxpYyBsb2dfVHJpZ2dlck1ldChjYW1wYWlnbklkOiBzdHJpbmcsIHN1cnZleUlkOiBzdHJpbmcsIHN1cnZleVR5cGU6IEFwaS5JU3VydmV5LlR5cGUpOiB2b2lkIHtcclxuXHRcdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5TdXJ2ZXkuRmxvb2RnYXRlLlRyaWdnZXJNZXQuVkFMVUUsXHJcblx0XHRcdHtcclxuXHRcdFx0XHRDYW1wYWlnbklkOiBjYW1wYWlnbklkLFxyXG5cdFx0XHRcdFN1cnZleUlkOiBzdXJ2ZXlJZCxcclxuXHRcdFx0XHRTdXJ2ZXlUeXBlOiBzdXJ2ZXlUeXBlLFxyXG5cdFx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIExvZyB0aGF0IGEgdXNlciB3YXMgc2VsZWN0ZWQobm9taW5hdGVkKSBmb3IgYSBzdXJ2ZXlcclxuXHQgKiBAcGFyYW0gY2FtcGFpZ25JZCBJZCBvZiB0aGUgY2FtcGFpZ24gdGhlIHN1cnZleSBiZWxvbmdzIHRvLlxyXG5cdCAqIEBwYXJhbSBzdXJ2ZXlJZCBJZCBvZiB0aGUgc3VydmV5LlxyXG5cdCAqIEBwYXJhbSBzdXJ2ZXlUeXBlIFR5cGUgb2YgdGhlIHN1cnZleS5cclxuXHQgKi9cclxuXHRwdWJsaWMgbG9nX1VzZXJTZWxlY3RlZChjYW1wYWlnbklkOiBzdHJpbmcsIHN1cnZleUlkOiBzdHJpbmcsIHN1cnZleVR5cGU6IEFwaS5JU3VydmV5LlR5cGUpOiB2b2lkIHtcclxuXHRcdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5TdXJ2ZXkuRmxvb2RnYXRlLlVzZXJTZWxlY3RlZC5WQUxVRSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdENhbXBhaWduSWQ6IGNhbXBhaWduSWQsXHJcblx0XHRcdFx0U3VydmV5SWQ6IHN1cnZleUlkLFxyXG5cdFx0XHRcdFN1cnZleVR5cGU6IHN1cnZleVR5cGUsXHJcblx0XHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTG9nIHRoYXQgY2FtcGFpZ24gZGVmaW5pdGlvbnMgZmFpbGVkIHRvIGxvYWQuXHJcblx0ICogQHBhcmFtIGVycm9yTWVzc2FnZSBlcnJvciBtZXNzYWdlXHJcblx0ICovXHJcblx0cHVibGljIGxvZ19DYW1wYWlnbkxvYWRfRmFpbGVkKGVycm9yTWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRMb2dnaW5nLmdldExvZ2dlcigpLmxvZ0V2ZW50KExvZ2dpbmcuRXZlbnRJZHMuU3VydmV5LkZsb29kZ2F0ZS5DYW1wYWlnbkxvYWQuRmFpbGVkLlZBTFVFLFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0RXJyb3JNZXNzYWdlOiBlcnJvck1lc3NhZ2UsXHJcblx0XHRcdH0pO1xyXG5cdH1cclxufVxyXG4iLCIvKipcclxuICogSVVJU3VydmV5IGltcGxlbWVudGF0aW9uIGJhc2VkIG9uIGFuIElDdXN0b21TdXJ2ZXkgb2JqZWN0XHJcbiAqL1xyXG5cclxuaW1wb3J0IElDdXN0b21TdXJ2ZXkgZnJvbSBcIi4uL0lDdXN0b21TdXJ2ZXlcIjtcclxuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSBcIi4uLy4uL1V0aWxzXCI7XHJcbmltcG9ydCBJVUlTdXJ2ZXkgZnJvbSBcIi4vSVVJU3VydmV5XCI7XHJcbmltcG9ydCAqIGFzIEFwaSBmcm9tIFwiQG1zLW9mYi9vZmZpY2VmbG9vZGdhdGVjb3JlL2Rpc3Qvc3JjL0FwaS9BcGlcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEN1c3RvbVVJU3VydmV5IGltcGxlbWVudHMgSVVJU3VydmV5IHtcclxuXHRwdWJsaWMgc2hvd1Byb21wdDogYm9vbGVhbjtcclxuXHJcblx0cHVibGljIHNob3dFbWFpbFJlcXVlc3Q6IGJvb2xlYW47XHJcblxyXG5cdHByaXZhdGUgY29tbWVudDogc3RyaW5nID0gXCJcIjtcclxuXHRwcml2YXRlIHJhdGluZ0luZGV4OiBudW1iZXIgPSAtMTtcclxuXHRwcml2YXRlIHN1cnZleTogSUN1c3RvbVN1cnZleTtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKHN1cnZleTogSUN1c3RvbVN1cnZleSkge1xyXG5cdFx0dGhpcy5zaG93UHJvbXB0ID0gc3VydmV5LnNob3dQcm9tcHQ7XHJcblx0XHR0aGlzLnNob3dFbWFpbFJlcXVlc3QgPSAgVXRpbHMuaXNCb29sZWFuKHN1cnZleS5zaG93RW1haWxSZXF1ZXN0KSA/IHN1cnZleS5zaG93RW1haWxSZXF1ZXN0IDogZmFsc2U7XHJcblxyXG5cdFx0dGhpcy5zdXJ2ZXkgPSBzdXJ2ZXk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0UHJvbXB0UXVlc3Rpb24oKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLnN1cnZleS5wcm9tcHRRdWVzdGlvbjtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRUaXRsZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuc3VydmV5LnRpdGxlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFByb21wdFllc0J1dHRvblRleHQoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLnN1cnZleS5wcm9tcHRZZXNCdXR0b25UZXh0O1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFByb21wdE5vQnV0dG9uVGV4dCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuc3VydmV5LnByb21wdE5vQnV0dG9uVGV4dDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRSYXRpbmdWYWx1ZXNBc2NlbmRpbmcoKTogc3RyaW5nW10ge1xyXG5cdFx0cmV0dXJuIHRoaXMuc3VydmV5LnJhdGluZ1ZhbHVlc0FzY2VuZGluZztcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRSYXRpbmdRdWVzdGlvbigpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuc3VydmV5LnJhdGluZ1F1ZXN0aW9uO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldENvbW1lbnRRdWVzdGlvbigpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuc3VydmV5LmNvbW1lbnRRdWVzdGlvbjtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXRWYWx1ZXMocmF0aW5nSW5kZXg6IG51bWJlciwgY29tbWVudDogc3RyaW5nKTogdm9pZCB7XHJcblx0XHR0aGlzLmNvbW1lbnQgPSBjb21tZW50O1xyXG5cdFx0aWYgKHRoaXMuaXNSYXRpbmdJbmRleFZhbGlkKHJhdGluZ0luZGV4KSkge1xyXG5cdFx0XHR0aGlzLnJhdGluZ0luZGV4ID0gcmF0aW5nSW5kZXg7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLnJhdGluZ0luZGV4ID0gLTE7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0SnNvbkVsZW1lbnRzKCk6IGFueSB7XHJcblx0XHRsZXQgcmVzdWx0OiBhbnkgPSB7fTtcclxuXHJcblx0XHRyZXN1bHQuY29tbWVudCA9IHRoaXMuY29tbWVudDtcclxuXHRcdHJlc3VsdC5yYXRpbmcgPSB0aGlzLmdldE5vcm1hbGl6ZWRSYXRpbmdTY29yZSgpO1xyXG5cdFx0cmVzdWx0LnN1cnZleSA9IHtcclxuXHRcdFx0c3VydmV5SWQ6IHRoaXMuZ2V0Q2FtcGFpZ25JZCgpLFxyXG5cdFx0fTtcclxuXHJcblx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFN1cnZleVR5cGUoKTogQXBpLklTdXJ2ZXkuVHlwZSB7XHJcblx0XHRyZXR1cm4gdGhpcy5zdXJ2ZXkuc3VydmV5VHlwZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRDYW1wYWlnbklkKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5zdXJ2ZXkuY2FtcGFpZ25JZDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRJZCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0Q2FtcGFpZ25JZCgpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBpc1JhdGluZ0luZGV4VmFsaWQoaW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIChpbmRleCA+PSAwICYmIGluZGV4IDwgdGhpcy5zdXJ2ZXkucmF0aW5nVmFsdWVzQXNjZW5kaW5nLmxlbmd0aCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGdldE5vcm1hbGl6ZWRSYXRpbmdTY29yZSgpOiBudW1iZXIge1xyXG5cdFx0aWYgKCF0aGlzLmlzUmF0aW5nSW5kZXhWYWxpZCh0aGlzLnJhdGluZ0luZGV4KSkge1xyXG5cdFx0XHRyZXR1cm4gLTE7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuc3VydmV5LmlzWmVyb0Jhc2VkKSB7XHJcblx0XHRcdHJldHVybiAodGhpcy5yYXRpbmdJbmRleCkgLyAodGhpcy5zdXJ2ZXkucmF0aW5nVmFsdWVzQXNjZW5kaW5nLmxlbmd0aCAtIDEpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmV0dXJuICh0aGlzLnJhdGluZ0luZGV4ICsgMS4wKSAvIHRoaXMuc3VydmV5LnJhdGluZ1ZhbHVlc0FzY2VuZGluZy5sZW5ndGg7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsIi8qKlxyXG4gKiBEdW1teSBJVUlTdXJ2ZXkgaW1wbGVtZW50YXRpb24gd2l0aG91dCBkZXBlbmRhbmN5IG9uIG9mZmljZWZsb29kZ2F0ZWNvcmVcclxuICovXHJcblxyXG5pbXBvcnQgSVVJU3VydmV5IGZyb20gXCIuL0lVSVN1cnZleVwiO1xyXG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tIFwiLi4vLi4vVXRpbHNcIjtcclxuaW1wb3J0ICogYXMgQXBpIGZyb20gXCJAbXMtb2ZiL29mZmljZWZsb29kZ2F0ZWNvcmUvZGlzdC9zcmMvQXBpL0FwaVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRHVtbXlTdXJ2ZXkgaW1wbGVtZW50cyBJVUlTdXJ2ZXkge1xyXG5cdHB1YmxpYyBzaG93UHJvbXB0OiBib29sZWFuID0gdHJ1ZTtcclxuXHJcblx0cHVibGljIHNob3dFbWFpbFJlcXVlc3Q6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuXHRwcml2YXRlIGNvbW1lbnQ6IHN0cmluZyA9IFwiXCI7XHJcblx0cHJpdmF0ZSByYXRpbmc6IG51bWJlcjtcclxuXHJcblx0cHVibGljIGdldFByb21wdFF1ZXN0aW9uKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gXCJQcm9tcHQgcXVlc3Rpb24/XCI7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0VGl0bGUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBcIlRpdGxlXCI7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0UHJvbXB0WWVzQnV0dG9uVGV4dCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIFwiWWVzXCI7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0UHJvbXB0Tm9CdXR0b25UZXh0KCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gXCJOb1wiO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFJhdGluZ1ZhbHVlc0FzY2VuZGluZygpOiBzdHJpbmdbXSB7XHJcblx0XHRyZXR1cm4gW1wid29yc3RcIiwgXCJ3b3JzZVwiLCBcIm9rXCIsIFwiYmV0dGVyXCIsIFwiYmVzdFwiXTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRSYXRpbmdRdWVzdGlvbigpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIFwiUmF0aW5nIHF1ZXN0aW9uP1wiO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldENvbW1lbnRRdWVzdGlvbigpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIFwiQ29tbWVudCBxdWVzdGlvbj9cIjtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXRWYWx1ZXMoc2VsZWN0ZWRJbmRleDogbnVtYmVyLCBjb21tZW50OiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdGlmIChjb21tZW50KSB7IHRoaXMuY29tbWVudCA9IGNvbW1lbnQ7IH1cclxuXHRcdGlmIChVdGlscy5pc0ludGVnZXIoc2VsZWN0ZWRJbmRleCkgJiYgc2VsZWN0ZWRJbmRleCA+PSAwICYmIHNlbGVjdGVkSW5kZXggPD0gNCkge1xyXG5cdFx0XHR0aGlzLnJhdGluZyA9IHNlbGVjdGVkSW5kZXggLyA0LjA7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0SnNvbkVsZW1lbnRzKCk6IGFueSB7XHJcblx0XHRsZXQgcmVzdWx0OiBhbnkgPSB7fTtcclxuXHJcblx0XHRpZiAodGhpcy5jb21tZW50KSB7IHJlc3VsdC5jb21tZW50ID0gdGhpcy5jb21tZW50OyB9XHJcblx0XHRpZiAodGhpcy5yYXRpbmcpIHsgcmVzdWx0LnJhdGluZyA9IHRoaXMucmF0aW5nOyB9XHJcblxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRTdXJ2ZXlUeXBlKCk6IEFwaS5JU3VydmV5LlR5cGUge1xyXG5cdFx0cmV0dXJuIEFwaS5JU3VydmV5LlR5cGUuTnBzO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldENhbXBhaWduSWQoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBcIjEwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMFwiO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldElkKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gXCIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDBcIjtcclxuXHR9XHJcbn1cclxuIiwiLyoqXHJcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIElVSVN1cnZleSBiYXNlZCBvbiBmbG9vZGdhdGUuY29yZSBJTnBzU3VydmV5XHJcbiAqL1xyXG5cclxuaW1wb3J0IElVSVN1cnZleSBmcm9tIFwiLi9JVUlTdXJ2ZXlcIjtcclxuaW1wb3J0ICogYXMgQXBpIGZyb20gXCJAbXMtb2ZiL29mZmljZWZsb29kZ2F0ZWNvcmUvZGlzdC9zcmMvQXBpL0FwaVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVUlTdXJ2ZXkgaW1wbGVtZW50cyBJVUlTdXJ2ZXkge1xyXG5cdHB1YmxpYyBzaG93UHJvbXB0OiBib29sZWFuID0gdHJ1ZTtcclxuXHJcblx0cHVibGljIHNob3dFbWFpbFJlcXVlc3Q6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcblx0cHJpdmF0ZSBzdXJ2ZXk6IEFwaS5JU3VydmV5O1xyXG5cdHByaXZhdGUgcHJvbXB0OiBBcGkuSVByb21wdENvbXBvbmVudDtcclxuXHRwcml2YXRlIGNvbW1lbnQ6IEFwaS5JQ29tbWVudENvbXBvbmVudDtcclxuXHRwcml2YXRlIHJhdGluZzogQXBpLklSYXRpbmdDb21wb25lbnQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yKHN1cnZleTogQXBpLklTdXJ2ZXkpIHtcclxuXHRcdGlmICghc3VydmV5KSB7XHJcblx0XHRcdHRocm93IEVycm9yKFwic3VydmV5IG11c3Qgbm90IGJlIG51bGxcIik7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLnN1cnZleSA9IHN1cnZleTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgcHJvbXB0Q29tcG9uZW50OiBBcGkuSVN1cnZleUNvbXBvbmVudCA9IHN1cnZleS5nZXRDb21wb25lbnQoQXBpLklTdXJ2ZXlDb21wb25lbnQuVHlwZS5Qcm9tcHQpO1xyXG5cdFx0bGV0IGNvbW1lbnRDb21wb25lbnQ6IEFwaS5JU3VydmV5Q29tcG9uZW50ID0gc3VydmV5LmdldENvbXBvbmVudChBcGkuSVN1cnZleUNvbXBvbmVudC5UeXBlLkNvbW1lbnQpO1xyXG5cdFx0bGV0IHJhdGluZ0NvbXBvbmVudDogQXBpLklTdXJ2ZXlDb21wb25lbnQgPSBzdXJ2ZXkuZ2V0Q29tcG9uZW50KEFwaS5JU3VydmV5Q29tcG9uZW50LlR5cGUuUmF0aW5nKTtcclxuXHJcblx0XHRpZiAocHJvbXB0Q29tcG9uZW50KSB7XHJcblx0XHRcdHRoaXMucHJvbXB0ID0gKHByb21wdENvbXBvbmVudCBhcyBBcGkuSVByb21wdENvbXBvbmVudCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aHJvdyBFcnJvcihcInByb21wdCBjb21wb25lbnQgbXVzdCBub3QgYmUgbnVsbFwiKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBDaGVjayBmb3IgYWRkaXRvbmFsRGF0YVJlcXVlc3RlZCBvcHRpb25zXHJcblx0XHR0aGlzLnNob3dFbWFpbFJlcXVlc3QgPSBzdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmlzQWRkaXRpb25hbERhdGFSZXF1ZXN0ZWQoXHJcblx0XHRcdEFwaS5JU3VydmV5SW5mby5BZGRpdGlvbmFsRGF0YVR5cGUuRW1haWxBZGRyZXNzKTtcclxuXHJcblx0XHRpZiAoY29tbWVudENvbXBvbmVudCkge1xyXG5cdFx0XHR0aGlzLmNvbW1lbnQgPSAoY29tbWVudENvbXBvbmVudCBhcyBBcGkuSUNvbW1lbnRDb21wb25lbnQpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhyb3cgRXJyb3IoXCJjb21tZW50IGNvbXBvbmVudCBtdXN0IG5vdCBiZSBudWxsXCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChyYXRpbmdDb21wb25lbnQpIHtcclxuXHRcdFx0dGhpcy5yYXRpbmcgPSAocmF0aW5nQ29tcG9uZW50IGFzIEFwaS5JUmF0aW5nQ29tcG9uZW50KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRocm93IEVycm9yKFwicmF0aW5nIGNvbXBvbmVudCBtdXN0IG5vdCBiZSBudWxsXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFByb21wdFF1ZXN0aW9uKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5wcm9tcHQuZ2V0UXVlc3Rpb24oKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRUaXRsZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMucHJvbXB0LmdldFRpdGxlKCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0UHJvbXB0WWVzQnV0dG9uVGV4dCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMucHJvbXB0LmdldFllc0J1dHRvblRleHQoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRQcm9tcHROb0J1dHRvblRleHQoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLnByb21wdC5nZXROb0J1dHRvblRleHQoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRSYXRpbmdWYWx1ZXNBc2NlbmRpbmcoKTogc3RyaW5nW10ge1xyXG5cdFx0cmV0dXJuIHRoaXMucmF0aW5nLmdldFJhdGluZ1ZhbHVlc0FzY2VuZGluZygpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFJhdGluZ1F1ZXN0aW9uKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5yYXRpbmcuZ2V0UXVlc3Rpb24oKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRDb21tZW50UXVlc3Rpb24oKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLmNvbW1lbnQuZ2V0UXVlc3Rpb24oKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXRWYWx1ZXMoc2VsZWN0ZWRJbmRleDogbnVtYmVyLCBjb21tZW50OiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMucmF0aW5nLnNldFNlbGVjdGVkUmF0aW5nSW5kZXgoc2VsZWN0ZWRJbmRleCk7XHJcblx0XHR0aGlzLmNvbW1lbnQuc2V0U3VibWl0dGVkVGV4dChjb21tZW50KTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRKc29uRWxlbWVudHMoKTogYW55IHtcclxuXHRcdHJldHVybiB0aGlzLnN1cnZleS5nZXRKc29uRWxlbWVudHMoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRTdXJ2ZXlUeXBlKCk6IEFwaS5JU3VydmV5LlR5cGUge1xyXG5cdFx0cmV0dXJuIHRoaXMuc3VydmV5LmdldFR5cGUoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRDYW1wYWlnbklkKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5zdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmdldEJhY2tFbmRJZCgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldElkKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5zdXJ2ZXkuZ2V0U3VydmV5SW5mbygpLmdldElkKCk7XHJcblx0fVxyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBMb2NhbGl6YXRpb24udHNcclxuICpcclxuICogTW9kdWxlIGZvciBMb2NhbGl6YXRpb25cclxuICovXHJcblxyXG4vKipcclxuICogTGlzdCBvZiBzdXBwb3J0ZWQgTG9jYWxlc1xyXG4gKiBSRU1JTkRFUjogdXBkYXRlIHJlYWRtZSB0byBtYXRjaCB0aGUgbGlzdCBiZWxvdyBpZiBjaGFuZ2UgaXMgbWFkZVxyXG4gKi9cclxubGV0IHN1cHBvcnRlZExvY2FsZXM6IHN0cmluZ1tdID0gW1xyXG5cdFwiYWZcIixcclxuXHRcImFtXCIsXHJcblx0XCJhclwiLFxyXG5cdFwiYXNcIixcclxuXHRcImF6XCIsXHJcblx0XCJiZVwiLFxyXG5cdFwiYmdcIixcclxuXHRcImJuLUJEXCIsXHJcblx0XCJibi1JTlwiLFxyXG5cdFwiYnNcIixcclxuXHRcImNhXCIsXHJcblx0XCJjYS1Fcy1WQUxFTkNJQVwiLFxyXG5cdFwiY2hyLUNoZXJcIixcclxuXHRcImNzXCIsXHJcblx0XCJjeVwiLFxyXG5cdFwiZGFcIixcclxuXHRcImRlXCIsXHJcblx0XCJlbFwiLFxyXG5cdFwiZW4tR0JcIixcclxuXHRcImVzXCIsXHJcblx0XCJlcy1NWFwiLFxyXG5cdFwiZXRcIixcclxuXHRcImV1XCIsXHJcblx0XCJmYVwiLFxyXG5cdFwiZmlcIixcclxuXHRcImZpbFwiLFxyXG5cdFwiZnJcIixcclxuXHRcImZyLUNBXCIsXHJcblx0XCJnYVwiLFxyXG5cdFwiZ2RcIixcclxuXHRcImdsXCIsXHJcblx0XCJndVwiLFxyXG5cdFwiaGEtTGF0bi1OR1wiLFxyXG5cdFwiaGVcIixcclxuXHRcImhpXCIsXHJcblx0XCJoclwiLFxyXG5cdFwiaHVcIixcclxuXHRcImh5XCIsXHJcblx0XCJpZFwiLFxyXG5cdFwiaXNcIixcclxuXHRcIml0XCIsXHJcblx0XCJqYVwiLFxyXG5cdFwia2FcIixcclxuXHRcImtrXCIsXHJcblx0XCJrbS1LSFwiLFxyXG5cdFwia25cIixcclxuXHRcImtvXCIsXHJcblx0XCJrb2tcIixcclxuXHRcImt5XCIsXHJcblx0XCJsYlwiLFxyXG5cdFwibG9cIixcclxuXHRcImx0XCIsXHJcblx0XCJsdlwiLFxyXG5cdFwibWlcIixcclxuXHRcIm1rXCIsXHJcblx0XCJtbFwiLFxyXG5cdFwibW5cIixcclxuXHRcIm1yXCIsXHJcblx0XCJtc1wiLFxyXG5cdFwibXRcIixcclxuXHRcIm5iLU5PXCIsXHJcblx0XCJuZVwiLFxyXG5cdFwibmxcIixcclxuXHRcIm5uLU5PXCIsXHJcblx0XCJvclwiLFxyXG5cdFwicGFcIixcclxuXHRcInBsXCIsXHJcblx0XCJwcnNcIixcclxuXHRcInB0LUJSXCIsXHJcblx0XCJwdC1QVFwiLFxyXG5cdFwicXV6XCIsXHJcblx0XCJyb1wiLFxyXG5cdFwicnVcIixcclxuXHRcInNkXCIsXHJcblx0XCJzaVwiLFxyXG5cdFwic2tcIixcclxuXHRcInNsXCIsXHJcblx0XCJzcVwiLFxyXG5cdFwic3ItQ3lybC1CQVwiLFxyXG5cdFwic3ItQ3lybC1SU1wiLFxyXG5cdFwic3ItTGF0bi1SU1wiLFxyXG5cdFwic3ZcIixcclxuXHRcInN3XCIsXHJcblx0XCJ0YVwiLFxyXG5cdFwidGVcIixcclxuXHRcInRoXCIsXHJcblx0XCJ0a1wiLFxyXG5cdFwidHJcIixcclxuXHRcInR0XCIsXHJcblx0XCJ1Z1wiLFxyXG5cdFwidWtcIixcclxuXHRcInVyXCIsXHJcblx0XCJ1ei1MYXRuLVVaXCIsXHJcblx0XCJ2aVwiLFxyXG5cdFwiemgtSGFuc1wiLFxyXG5cdFwiemgtSGFudFwiLFxyXG5dO1xyXG5cclxuY29uc3QgbG9jYWxlVmFyaWFudFRvU3VwcG9ydGVkbG9jYWxlTWFwOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge1xyXG5cdFwiWkgtQ05cIjogXCJ6aC1IYW5zXCIsXHJcblx0XCJaSC1IS1wiOiBcInpoLUhhbnRcIixcclxuXHRcIlpILU1PXCI6IFwiemgtSGFudFwiLFxyXG5cdFwiWkgtU0dcIjogXCJ6aC1IYW5zXCIsXHJcblx0XCJaSC1UV1wiOiBcInpoLUhhbnRcIixcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZShsb2NhbGU6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0bGV0IGxvY2FsZVVwcGVyQ2FzZSA9IGxvY2FsZS50b0xvY2FsZVVwcGVyQ2FzZSgpO1xyXG5cclxuXHQvLyBzdXBwb3J0IGZvciBDaGluZXNlIGxsLWNjLCBWU08gQnVnIDE1ODMzODlcclxuXHRpZiAobG9jYWxlVXBwZXJDYXNlIGluIGxvY2FsZVZhcmlhbnRUb1N1cHBvcnRlZGxvY2FsZU1hcCkge1xyXG5cdFx0cmV0dXJuIGxvY2FsZVZhcmlhbnRUb1N1cHBvcnRlZGxvY2FsZU1hcFtsb2NhbGVVcHBlckNhc2VdO1xyXG5cdH1cclxuXHJcblx0Ly8gcmV0dXJuIHN1cHBvcnRlZCBsb2NhbGUgaWYgZXhhY3QgbWF0Y2ggZm91bmRcclxuXHRmb3IgKGxldCBzdXBwb3J0ZWRMb2NhbGUgb2Ygc3VwcG9ydGVkTG9jYWxlcykge1xyXG5cdFx0aWYgKHN1cHBvcnRlZExvY2FsZS50b1VwcGVyQ2FzZSgpID09PSBsb2NhbGVVcHBlckNhc2UpIHtcclxuXHRcdFx0cmV0dXJuIHN1cHBvcnRlZExvY2FsZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGxldCBsb2NhbGVQYXJ0T25lID0gbG9jYWxlVXBwZXJDYXNlLnNwbGl0KFwiLVwiKVswXTtcclxuXHQvLyByZXR1cm4gc3VwcG9ydGVkIFwibGxcIiBpZiBleGFjdCBtYXRjaCBub3QgZm91bmQsIGJ1dCBcImxsXCIgbWF0Y2hlc1xyXG5cdGZvciAobGV0IHN1cHBvcnRlZExvY2FsZSBvZiBzdXBwb3J0ZWRMb2NhbGVzKSB7XHJcblx0XHRpZiAoc3VwcG9ydGVkTG9jYWxlLnRvVXBwZXJDYXNlKCkgPT09IGxvY2FsZVBhcnRPbmUpIHtcclxuXHRcdFx0cmV0dXJuIHN1cHBvcnRlZExvY2FsZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIGRlZmF1bHQgZXZlcnl0aGluZyBlbHNlIHRvIGVuXHJcblx0cmV0dXJuIFwiZW5cIjtcclxufVxyXG4iLCIvKipcclxuICogQ29uc3RhbnRzLnRzXHJcbiAqXHJcbiAqIE1vZHVsZSB0byBob2xkIGxvZ2dpbmctcmVsYXRlZCBjb25zdGFudHNcclxuICovXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElDdXN0b21Qcm9wZXJ0aWVzIHtcclxuXHRDYW1wYWlnbklkPzogc3RyaW5nO1xyXG5cdEVycm9yTWVzc2FnZT86IHN0cmluZztcclxuXHRGZWVkYmFja1R5cGU/OiBudW1iZXI7XHJcblx0RmlsZU5hbWU/OiBzdHJpbmc7XHJcblx0SHR0cFN0YXR1c0NvZGU/OiBudW1iZXI7XHJcblx0SXNCdWdFbmFibGVkPzogYm9vbGVhbjtcclxuXHRJc0RpYWdub3N0aWNzSW5jbHVkZWQ/OiBib29sZWFuO1xyXG5cdElzRW1haWxJbmNsdWRlZD86IGJvb2xlYW47XHJcblx0SXNJZGVhRW5hYmxlZD86IGJvb2xlYW47XHJcblx0SXNTY3JlZW5zaG90SW5jbHVkZWQ/OiBib29sZWFuO1xyXG5cdFN1cnZleUlkPzogc3RyaW5nO1xyXG5cdFN1cnZleVR5cGU/OiBudW1iZXI7XHJcblx0VGltZU1pbGxpc2Vjb25kcz86IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJRXZlbnRJZCB7XHJcblx0bmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRXZlbnRJZHMge1xyXG5cdHB1YmxpYyBzdGF0aWMgSW5BcHAgPSBjbGFzcyB7XHJcblx0XHRwdWJsaWMgc3RhdGljIFVJID0gY2xhc3Mge1xyXG5cdFx0XHRwdWJsaWMgc3RhdGljIFBpY2tlciA9IGNsYXNzIHtcclxuXHRcdFx0XHRwdWJsaWMgc3RhdGljIFNob3duID0gY2xhc3Mge1xyXG5cdFx0XHRcdFx0cHVibGljIHN0YXRpYyBWQUxVRTogSUV2ZW50SWQgPSB7IG5hbWU6IFwiSW5BcHBfVUlfUGlja2VyX1Nob3duXCIgfTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0cHVibGljIHN0YXRpYyBGb3JtID0gY2xhc3Mge1xyXG5cdFx0XHRcdHB1YmxpYyBzdGF0aWMgU2hvd24gPSBjbGFzcyB7XHJcblx0XHRcdFx0XHRwdWJsaWMgc3RhdGljIFZBTFVFOiBJRXZlbnRJZCA9IHsgbmFtZTogXCJJbkFwcF9VSV9Gb3JtX1Nob3duXCIgfTtcclxuXHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRwdWJsaWMgc3RhdGljIFN1Ym1pdCA9IGNsYXNzIHtcclxuXHRcdFx0XHRcdHB1YmxpYyBzdGF0aWMgVkFMVUU6IElFdmVudElkID0geyBuYW1lOiBcIkluQXBwX1VJX0Zvcm1fU3VibWl0XCIgfTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9O1xyXG5cdFx0fTtcclxuXHR9O1xyXG5cclxuXHRwdWJsaWMgc3RhdGljIFN1cnZleSA9IGNsYXNzIHtcclxuXHRcdHB1YmxpYyBzdGF0aWMgVUkgPSBjbGFzcyB7XHJcblx0XHRcdHB1YmxpYyBzdGF0aWMgUHJvbXB0ID0gY2xhc3Mge1xyXG5cdFx0XHRcdHB1YmxpYyBzdGF0aWMgU2hvd24gPSBjbGFzcyB7XHJcblx0XHRcdFx0XHRwdWJsaWMgc3RhdGljIFZBTFVFOiBJRXZlbnRJZCA9IHsgbmFtZTogXCJTdXJ2ZXlfVUlfUHJvbXB0X1Nob3duXCIgfTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0cHVibGljIHN0YXRpYyBGb3JtID0gY2xhc3Mge1xyXG5cdFx0XHRcdHB1YmxpYyBzdGF0aWMgU2hvd24gPSBjbGFzcyB7XHJcblx0XHRcdFx0XHRwdWJsaWMgc3RhdGljIFZBTFVFOiBJRXZlbnRJZCA9IHsgbmFtZTogXCJTdXJ2ZXlfVUlfRm9ybV9TaG93blwiIH07XHJcblx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0cHVibGljIHN0YXRpYyBTdWJtaXQgPSBjbGFzcyB7XHJcblx0XHRcdFx0XHRwdWJsaWMgc3RhdGljIFZBTFVFOiBJRXZlbnRJZCA9IHsgbmFtZTogXCJTdXJ2ZXlfVUlfRm9ybV9TdWJtaXRcIiB9O1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH07XHJcblx0XHR9O1xyXG5cclxuXHRcdHB1YmxpYyBzdGF0aWMgRmxvb2RnYXRlID0gY2xhc3Mge1xyXG5cdFx0XHRwdWJsaWMgc3RhdGljIFRyaWdnZXJNZXQgPSBjbGFzcyB7XHJcblx0XHRcdFx0cHVibGljIHN0YXRpYyBWQUxVRTogSUV2ZW50SWQgPSB7IG5hbWU6IFwiU3VydmV5X0Zsb29kZ2F0ZV9UcmlnZ2VyTWV0XCIgfTtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdHB1YmxpYyBzdGF0aWMgVXNlclNlbGVjdGVkID0gY2xhc3Mge1xyXG5cdFx0XHRcdHB1YmxpYyBzdGF0aWMgVkFMVUU6IElFdmVudElkID0geyBuYW1lOiBcIlN1cnZleV9GbG9vZGdhdGVfVXNlclNlbGVjdGVkXCIgfTtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdHB1YmxpYyBzdGF0aWMgQ2FtcGFpZ25Mb2FkID0gY2xhc3Mge1xyXG5cdFx0XHRcdHB1YmxpYyBzdGF0aWMgRmFpbGVkID0gY2xhc3Mge1xyXG5cdFx0XHRcdFx0cHVibGljIHN0YXRpYyBWQUxVRTogSUV2ZW50SWQgPSB7IG5hbWU6IFwiU3VydmV5X0Zsb29kZ2F0ZV9DYW1wYWlnbkxvYWRfRmFpbGVkXCIgfTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0cHVibGljIHN0YXRpYyBGaWxlV3JpdGUgPSBjbGFzcyB7XHJcblx0XHRcdFx0cHVibGljIHN0YXRpYyBGYWlsZWQgPSBjbGFzcyB7XHJcblx0XHRcdFx0XHRwdWJsaWMgc3RhdGljIFZBTFVFOiBJRXZlbnRJZCA9IHsgbmFtZTogXCJTdXJ2ZXlfRmxvb2RnYXRlX0ZpbGVXcml0ZV9GYWlsZWRcIiB9O1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHRwdWJsaWMgc3RhdGljIEZpbGVSZWFkID0gY2xhc3Mge1xyXG5cdFx0XHRcdHB1YmxpYyBzdGF0aWMgRmFpbGVkID0gY2xhc3Mge1xyXG5cdFx0XHRcdFx0cHVibGljIHN0YXRpYyBWQUxVRTogSUV2ZW50SWQgPSB7IG5hbWU6IFwiU3VydmV5X0Zsb29kZ2F0ZV9GaWxlUmVhZF9GYWlsZWRcIiB9O1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH07XHJcblx0XHR9O1xyXG5cdH07XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgU2hhcmVkID0gY2xhc3Mge1xyXG5cdFx0cHVibGljIHN0YXRpYyBVcGxvYWQgPSBjbGFzcyB7XHJcblx0XHRcdHB1YmxpYyBzdGF0aWMgRmFpbGVkID0gY2xhc3Mge1xyXG5cdFx0XHRcdHB1YmxpYyBzdGF0aWMgVkFMVUU6IElFdmVudElkID0geyBuYW1lOiBcIlNoYXJlZF9VcGxvYWRfRmFpbGVkXCIgfTtcclxuXHRcdFx0fTtcclxuXHRcdH07XHJcblxyXG5cdFx0cHVibGljIHN0YXRpYyBTY3JlZW5zaG90ID0gY2xhc3Mge1xyXG5cdFx0XHRwdWJsaWMgc3RhdGljIFJlbmRlciA9IGNsYXNzIHtcclxuXHRcdFx0XHRwdWJsaWMgc3RhdGljIEZhaWxlZCA9IGNsYXNzIHtcclxuXHRcdFx0XHRcdHB1YmxpYyBzdGF0aWMgVkFMVUU6IElFdmVudElkID0geyBuYW1lOiBcIlNoYXJlZF9TY3JlZW5zaG90X1JlbmRlcl9GYWlsZWRcIiB9O1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdFx0cHVibGljIHN0YXRpYyBTdWNjZXNzID0gY2xhc3Mge1xyXG5cdFx0XHRcdFx0cHVibGljIHN0YXRpYyBWQUxVRTogSUV2ZW50SWQgPSB7IG5hbWU6IFwiU2hhcmVkX1NjcmVlbnNob3RfUmVuZGVyX1N1Y2Nlc3NcIiB9O1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHRwdWJsaWMgc3RhdGljIEdldENvbnRlbnQgPSBjbGFzcyB7XHJcblx0XHRcdFx0cHVibGljIHN0YXRpYyBGYWlsZWQgPSBjbGFzcyB7XHJcblx0XHRcdFx0XHRwdWJsaWMgc3RhdGljIERlZmF1bHRJbWFnZSA9IGNsYXNzIHtcclxuXHRcdFx0XHRcdFx0cHVibGljIHN0YXRpYyBSZXR1cm5lZCA9IGNsYXNzIHtcclxuXHRcdFx0XHRcdFx0XHRwdWJsaWMgc3RhdGljIFZBTFVFOiBJRXZlbnRJZCA9IHsgbmFtZTogXCJTaGFyZWRfU2NyZWVuc2hvdF9HZXRDb250ZW50X0ZhaWxlZF9EZWZhdWx0SW1hZ2VfUmV0dXJuZWRcIiB9O1xyXG5cdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0fTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9O1xyXG5cdFx0fTtcclxuXHR9O1xyXG59XHJcbiIsImltcG9ydCB7IElFdmVudElkLCBJQ3VzdG9tUHJvcGVydGllcyB9IGZyb20gXCIuL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgeyBFbnZpcm9ubWVudCB9IGZyb20gXCIuLy4uL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgeyBBcHAsIFNlc3Npb24sIEhvc3QsIFJlbGVhc2UgfSBmcm9tIFwiLi9UZWxlbWV0cnkvQ29udHJhY3RzXCI7XHJcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gXCIuLy4uL1V0aWxzXCI7XHJcbmltcG9ydCBJVGVsZW1ldHJ5TG9nZ2VyIGZyb20gXCIuL1RlbGVtZXRyeS9JVGVsZW1ldHJ5TG9nZ2VyXCI7XHJcbmltcG9ydCBUZWxlbWV0cnlMb2dnZXJGYWN0b3J5IGZyb20gXCIuL1RlbGVtZXRyeS9UZWxlbWV0cnlMb2dnZXJGYWN0b3J5XCI7XHJcblxyXG5leHBvcnQgeyBJQ3VzdG9tUHJvcGVydGllcywgSUV2ZW50SWQsIEV2ZW50SWRzIH0gZnJvbSBcIi4vQ29uc3RhbnRzXCI7XHJcblxyXG5jb25zdCBOQU1FU1BBQ0U6IHN0cmluZyA9IFwiT2ZmaWNlX0ZlZWRiYWNrXCI7XHJcblxyXG5sZXQgbG9nZ2VyOiBJTG9nZ2VyO1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgdGhlIGxvZ2dpbmcgbW9kdWxlXHJcbiAqIEBwYXJhbSBlbnZpcm9ubWVudCBlbnZpcm9ubWVudFxyXG4gKiBAcGFyYW0gYXBwTmFtZSBhcHAgbmFtZVxyXG4gKiBAcGFyYW0gYXBwVmVyc2lvbiBhcHAgdmVyc2lvblxyXG4gKiBAcGFyYW0gYXVkaWVuY2VHcm91cCBhdWRpZW5jZSBncm91cFxyXG4gKiBAcGFyYW0gaG9zdElkIGhvc3QgaWRcclxuICogQHBhcmFtIGhvc3RTZXNzaW9uSWQgaG9zdCBzZXNzaW9uIElkXHJcbiAqIEBwYXJhbSBob3N0VmVyc2lvbiBob3N0IHZlcnNpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplKGVudmlyb25tZW50OiBFbnZpcm9ubWVudCwgYXBwTmFtZTogc3RyaW5nLCBhcHBWZXJzaW9uOiBzdHJpbmcsXHJcblx0YXVkaWVuY2VHcm91cDogc3RyaW5nLCBob3N0SWQ6IHN0cmluZywgaG9zdFNlc3Npb25JZDogc3RyaW5nLCBob3N0VmVyc2lvbjogc3RyaW5nKTogdm9pZCB7XHJcblx0bG9nZ2VyID0gbmV3IExvZ2dlcihcclxuXHRcdFRlbGVtZXRyeUxvZ2dlckZhY3RvcnkuY3JlYXRlKFRva2VuTWFuYWdlci5nZXRUZW5hbnRUb2tlbihlbnZpcm9ubWVudCksXHJcblx0XHRcdE5BTUVTUEFDRSxcclxuXHRcdFx0bmV3IEFwcChhcHBOYW1lLCBhcHBWZXJzaW9uKSxcclxuXHRcdFx0bmV3IFNlc3Npb24oVXRpbHMuZ3VpZCgpKSxcclxuXHRcdFx0bmV3IEhvc3QoaG9zdElkLCBob3N0U2Vzc2lvbklkLCBob3N0VmVyc2lvbiksXHJcblx0XHRcdG5ldyBSZWxlYXNlKGF1ZGllbmNlR3JvdXApKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgdGhlIGxvZ2dlciBvYmplY3RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRMb2dnZXIoKTogSUxvZ2dlciB7XHJcblx0cmV0dXJuIGxvZ2dlcjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3IgYSBsb2dnZXJcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUxvZ2dlciB7XHJcblx0bG9nRXZlbnQoZXZlbnRJZDogSUV2ZW50SWQsIGN1c3RvbVByb3BlcnRpZXM/OiBJQ3VzdG9tUHJvcGVydGllcyk6IHZvaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGFzcyByZXByZXNlbnRpbmcgYSBsb2dnZXIgZm9yIHRoZSBmZWVkYmFjayBTREtcclxuICovXHJcbmV4cG9ydCBjbGFzcyBMb2dnZXIgaW1wbGVtZW50cyBJTG9nZ2VyIHtcclxuXHRwcml2YXRlIHN0YXRpYyBFVkVOVF9OQU1FOiBzdHJpbmcgPSBcIlNES1wiO1xyXG5cdHByaXZhdGUgc3RhdGljIEVWRU5UX0lEOiBzdHJpbmcgPSBcIkV2ZW50SWRcIjtcclxuXHJcblx0cHJpdmF0ZSB0ZWxlbWV0cnlMb2dnZXI6IElUZWxlbWV0cnlMb2dnZXI7XHJcblxyXG5cdGNvbnN0cnVjdG9yKHRlbGVtZXRyeUxvZ2dlcjogSVRlbGVtZXRyeUxvZ2dlcikge1xyXG5cdFx0aWYgKCF0ZWxlbWV0cnlMb2dnZXIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwidGVsZW1ldHJ5TG9nZ2VyIG11c3Qgbm90IGJlIG51bGxcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy50ZWxlbWV0cnlMb2dnZXIgPSB0ZWxlbWV0cnlMb2dnZXI7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBMb2cgYW4gZXZlbnRcclxuXHQgKiBAcGFyYW0gZXZlbnRJZCBldmVudCBJZFxyXG5cdCAqIEBwYXJhbSBjdXN0b21Qcm9wZXJ0aWVzIGN1c3RvbSBwcm9wZXJ0aWVzIHRvIGFkZCB0byB0aGUgbG9nXHJcblx0ICovXHJcblx0cHVibGljIGxvZ0V2ZW50KGV2ZW50SWQ6IElFdmVudElkLCBjdXN0b21Qcm9wZXJ0aWVzPzogSUN1c3RvbVByb3BlcnRpZXMpIHtcclxuXHRcdGlmICghZXZlbnRJZCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJldmVudElkIG11c3Qgbm90IGJlIG51bGxcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0Y3VzdG9tUHJvcGVydGllcyA9IGN1c3RvbVByb3BlcnRpZXMgfHwge307XHJcblx0XHQoPGFueT4gY3VzdG9tUHJvcGVydGllcylbTG9nZ2VyLkVWRU5UX0lEXSA9IGV2ZW50SWQubmFtZTtcclxuXHJcblx0XHR0aGlzLnRlbGVtZXRyeUxvZ2dlci5sb2dFdmVudChMb2dnZXIuRVZFTlRfTkFNRSwgY3VzdG9tUHJvcGVydGllcyk7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBUb2tlbk1hbmFnZXIge1xyXG5cdHB1YmxpYyBzdGF0aWMgZ2V0VGVuYW50VG9rZW4oZW52aXJvbm1lbnQ6IEVudmlyb25tZW50KTogc3RyaW5nIHtcclxuXHRcdGlmIChlbnZpcm9ubWVudCA9PT0gRW52aXJvbm1lbnQuUHJvZHVjdGlvbikge1xyXG5cdFx0XHRyZXR1cm4gVG9rZW5NYW5hZ2VyLlRFTkFOVF9UT0tFTl9QUk9EVUNUSU9OO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmV0dXJuIFRva2VuTWFuYWdlci5URU5BTlRfVE9LRU5fUFJFX1BST0RVQ1RJT047XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHN0YXRpYyBURU5BTlRfVE9LRU5fUFJPRFVDVElPTjogc3RyaW5nID1cclxuXHRcImQ3OWU4MjQzODZjNDQ0MWNiOGMxZDRhZTE1NjkwNTI2LWJkNDQzMzA5LTU0OTQtNDQ0YS1hYmE5LTBhZjllZWY5OWY4NC03MzYwXCI7IC8vIFwiT2ZmaWNlIEZlZWRiYWNrXCIgUHJvZCBBcmlhIHRlbmFudFxyXG5cdHByaXZhdGUgc3RhdGljIFRFTkFOVF9UT0tFTl9QUkVfUFJPRFVDVElPTjogc3RyaW5nID1cclxuXHRcIjJiZjZhMmZmZGRjYTRhODBhODkyYTBiMTgyMTMyOTYxLTYyNWNiMTAyLThiMGMtNDgwZS1hZjUzLTkyZTQ4Njk1ZDA4ZC03NzM2XCI7IC8vIFwiT2ZmaWNlIEZlZWRiYWNrXCIgU2FuZGJveCBBcmlhIHRlbmFudFxyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBBcmlhLnRzXHJcbiAqXHJcbiAqIE1vZHVsZSBmb3Igd3JhcHBlciBhcm91bmQgQXJpYVxyXG4gKi9cclxuXHJcbmxldCBhcmlhOiBhbnkgPSByZXF1aXJlKFwiLi8uLi8uLi90aGlyZHBhcnR5L2FyaWEtd2VianMtY29tcGFjdC1zZGstMS4yLjBcIik7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gQVdUKCkgeyByZXR1cm4gYXJpYS5BV1Q7IH07XHJcbiIsIi8qKlxyXG4gKiBBbiBBcmlhLWJhc2VkIGxvZ2dlclxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIEFyaWEgZnJvbSBcIi4vQXJpYVwiO1xyXG5pbXBvcnQgeyBBcHAsIEV2ZW50LCBTZXNzaW9uLCBIb3N0LCBSZWxlYXNlIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XHJcbmltcG9ydCBJVGVsZW1ldHJ5TG9nZ2VyIGZyb20gXCIuL0lUZWxlbWV0cnlMb2dnZXJcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFyaWFUZWxlbWV0cnlMb2dnZXIgaW1wbGVtZW50cyBJVGVsZW1ldHJ5TG9nZ2VyIHtcclxuXHQvLyBFdmVudC5uYW1lIGlzIHNldCBhcyBuYW1lc3BhY2U8REVMSU1JVEVSPmV2ZW50TmFtZVxyXG5cdHByaXZhdGUgc3RhdGljIEVWRU5UX05BTUVfREVMSU1JVEVSOiBzdHJpbmcgPSBcIl9cIjtcclxuXHRwcml2YXRlIHN0YXRpYyBDVVNUT01fUFJPUEVSVElFU19GSUVMRF9QUkVGSVg6IHN0cmluZyA9IFwiRGF0YS5cIjtcclxuXHJcblx0cHJpdmF0ZSBzdGF0aWMgc2V0QXBwKHByb3BlcnRpZXM6IGFueSwgYXBwOiBBcHApOiB2b2lkIHtcclxuXHRcdHByb3BlcnRpZXNbXCJBcHAuTmFtZVwiXSA9IGFwcC5nZXROYW1lKCk7XHJcblx0XHRwcm9wZXJ0aWVzW1wiQXBwLlBsYXRmb3JtXCJdID0gYXBwLmdldFBsYXRmb3JtKCk7XHJcblx0XHRwcm9wZXJ0aWVzW1wiQXBwLlZlcnNpb25cIl0gPSBhcHAuZ2V0VmVyc2lvbigpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBzdGF0aWMgc2V0U2Vzc2lvbihwcm9wZXJ0aWVzOiBhbnksIHNlc3Npb246IFNlc3Npb24pIHtcclxuXHRcdHByb3BlcnRpZXNbXCJTZXNzaW9uLklkXCJdID0gc2Vzc2lvbi5nZXRJZCgpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBzdGF0aWMgc2V0SG9zdChwcm9wZXJ0aWVzOiBhbnksIGhvc3Q6IEhvc3QpIHtcclxuXHRcdGlmIChob3N0KSB7XHJcblx0XHRcdHByb3BlcnRpZXNbXCJIb3N0LklkXCJdID0gaG9zdC5nZXRJZCgpO1xyXG5cdFx0XHQvLyBUbyBiZSBHRFBSIGNvbXBsaWFudCBkbyBub3QgbG9nIEhvc3QuU2Vzc2lvbklkXHJcblx0XHRcdHByb3BlcnRpZXNbXCJIb3N0LlZlcnNpb25cIl0gPSBob3N0LmdldFZlcnNpb24oKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgc3RhdGljIHNldEV2ZW50KHByb3BlcnRpZXM6IGFueSwgZXZlbnQ6IEV2ZW50KSB7XHJcblx0XHRwcm9wZXJ0aWVzW1wiRXZlbnQuTmFtZVwiXSA9IGV2ZW50LmdldE5hbWUoKTtcclxuXHRcdHByb3BlcnRpZXNbXCJFdmVudC5JZFwiXSA9IGV2ZW50LmdldElkKCk7XHJcblx0XHRwcm9wZXJ0aWVzW1wiRXZlbnQuU291cmNlXCJdID0gZXZlbnQuZ2V0U291cmNlKCk7XHJcblx0XHRwcm9wZXJ0aWVzW1wiRXZlbnQuU2NoZW1hVmVyc2lvblwiXSA9IGV2ZW50LmdldFNjaGVtYVZlcnNpb24oKTtcclxuXHRcdHByb3BlcnRpZXNbXCJFdmVudC5TZXF1ZW5jZVwiXSA9IGV2ZW50LmdldFNlcXVlbmNlKCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHN0YXRpYyBzZXRSZWxlYXNlKHByb3BlcnRpZXM6IGFueSwgcmVsZWFzZTogUmVsZWFzZSkge1xyXG5cdFx0aWYgKHJlbGVhc2UpIHtcclxuXHRcdFx0cHJvcGVydGllc1tcIlJlbGVhc2UuQXVkaWVuY2VHcm91cFwiXSA9IHJlbGVhc2UuZ2V0QXVkaWVuY2VHcm91cCgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBvZXNBcHA6IEFwcDtcclxuXHRwcml2YXRlIG9lc1Nlc3Npb246IFNlc3Npb247XHJcblx0cHJpdmF0ZSBvZXNIb3N0OiBIb3N0O1xyXG5cdHByaXZhdGUgb2VzUmVsZWFzZTogUmVsZWFzZTtcclxuXHJcblx0cHJpdmF0ZSBuYW1lc3BhY2U6IHN0cmluZztcclxuXHRwcml2YXRlIHNlcXVlbmNlOiBudW1iZXI7XHJcblxyXG5cdGNvbnN0cnVjdG9yKHRlbmFudFRva2VuOiBzdHJpbmcsIG5hbWVzcGFjZTogc3RyaW5nLCBhcHA6IEFwcCwgc2Vzc2lvbjogU2Vzc2lvbiwgaG9zdD86IEhvc3QsIHJlbGVhc2U/OiBSZWxlYXNlKSB7XHJcblx0XHRpZiAoIXRlbmFudFRva2VuKSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcihcInRlbmFudFRva2VuIG11c3Qgbm90IGJlIG51bGxcIik7XHJcblx0XHR9XHJcblx0XHRpZiAoIW5hbWVzcGFjZSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJuYW1lc3BhY2UgbXVzdCBub3QgYmUgbnVsbFwiKTtcclxuXHRcdH1cclxuXHRcdGlmICghYXBwKSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcihcImFwcCBtdXN0IG5vdCBiZSBudWxsXCIpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCFzZXNzaW9uKSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcihcInNlc3Npb24gbXVzdCBub3QgYmUgbnVsbFwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRBcmlhLkFXVCgpLmluaXRpYWxpemUodGVuYW50VG9rZW4pO1xyXG5cdFx0dGhpcy5uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XHJcblx0XHR0aGlzLm9lc0FwcCA9IGFwcDtcclxuXHRcdHRoaXMub2VzU2Vzc2lvbiA9IHNlc3Npb247XHJcblx0XHR0aGlzLm9lc0hvc3QgPSBob3N0O1xyXG5cdFx0dGhpcy5vZXNSZWxlYXNlID0gcmVsZWFzZTtcclxuXHRcdHRoaXMuc2VxdWVuY2UgPSAxOyAvLyBTZXF1ZW5jZSBzdGFydHMgYXQgMSBub3QgMFxyXG5cdH1cclxuXHJcblx0cHVibGljIGxvZ0V2ZW50KGV2ZW50TmFtZTogc3RyaW5nLCBjdXN0b21Qcm9wZXJ0aWVzPzogeyBbY3VzdG9tRmllbGQ6IHN0cmluZ106IGFueSB9KSB7XHJcblx0XHRpZiAoIWV2ZW50TmFtZSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJldmVudE5hbWUgbXVzdCBub3QgYmUgbnVsbFwiKTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgb2VzRXZlbnQ6IEV2ZW50ID0gbmV3IEV2ZW50KFxyXG5cdFx0XHR0aGlzLm5hbWVzcGFjZSArIEFyaWFUZWxlbWV0cnlMb2dnZXIuRVZFTlRfTkFNRV9ERUxJTUlURVIgKyBldmVudE5hbWUsXHJcblx0XHRcdHRoaXMub2VzU2Vzc2lvbi5nZXRJZCgpLFxyXG5cdFx0XHR0aGlzLnNlcXVlbmNlXHJcblx0XHQpO1xyXG5cclxuXHRcdGxldCBhcmlhUHJvcGVydGllczogYW55ID0ge307XHJcblxyXG5cdFx0aWYgKGN1c3RvbVByb3BlcnRpZXMgIT0gbnVsbCkge1xyXG5cdFx0XHRmb3IgKGNvbnN0IGtleSBpbiBjdXN0b21Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0aWYgKGN1c3RvbVByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG5cdFx0XHRcdFx0YXJpYVByb3BlcnRpZXNbQXJpYVRlbGVtZXRyeUxvZ2dlci5DVVNUT01fUFJPUEVSVElFU19GSUVMRF9QUkVGSVggKyBrZXldID0gY3VzdG9tUHJvcGVydGllc1trZXldO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdEFyaWFUZWxlbWV0cnlMb2dnZXIuc2V0QXBwKGFyaWFQcm9wZXJ0aWVzLCB0aGlzLm9lc0FwcCk7XHJcblx0XHRBcmlhVGVsZW1ldHJ5TG9nZ2VyLnNldFNlc3Npb24oYXJpYVByb3BlcnRpZXMsIHRoaXMub2VzU2Vzc2lvbik7XHJcblx0XHRBcmlhVGVsZW1ldHJ5TG9nZ2VyLnNldEhvc3QoYXJpYVByb3BlcnRpZXMsIHRoaXMub2VzSG9zdCk7XHJcblx0XHRBcmlhVGVsZW1ldHJ5TG9nZ2VyLnNldFJlbGVhc2UoYXJpYVByb3BlcnRpZXMsIHRoaXMub2VzUmVsZWFzZSk7XHJcblx0XHRBcmlhVGVsZW1ldHJ5TG9nZ2VyLnNldEV2ZW50KGFyaWFQcm9wZXJ0aWVzLCBvZXNFdmVudCk7XHJcblxyXG5cdFx0QXJpYS5BV1QoKS5sb2dFdmVudCh7XHJcblx0XHRcdG5hbWU6IG9lc0V2ZW50LmdldE5hbWUoKSxcclxuXHRcdFx0cHJvcGVydGllczogYXJpYVByb3BlcnRpZXMsXHJcblx0XHR9KTtcclxuXHJcblx0XHR0aGlzLnNlcXVlbmNlKys7XHJcblx0fVxyXG59XHJcbiIsIi8qKlxyXG4gKiBDb250cmFjdHMgZW5mb3JjZWQgYnkgT2ZmaWNlRXZlbnRTY2hlbWEgKE9FUylcclxuICovXHJcblxyXG5leHBvcnQgY2xhc3MgQXBwIHtcclxuXHRwcml2YXRlIHN0YXRpYyBQTEFURk9STTogc3RyaW5nID0gXCJXZWJcIjtcclxuXHJcblx0cHJpdmF0ZSBuYW1lOiBzdHJpbmc7XHJcblx0cHJpdmF0ZSB2ZXJzaW9uOiBzdHJpbmc7XHJcblxyXG5cdHB1YmxpYyBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHZlcnNpb246IHN0cmluZykge1xyXG5cdFx0aWYgKCFuYW1lKSB7XHJcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIm5hbWUgbXVzdCBub3QgYmUgbnVsbFwiKTtcclxuXHRcdH1cclxuXHRcdGlmICghdmVyc2lvbikge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJ2ZXJzaW9uIG11c3Qgbm90IGJlIG51bGxcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcclxuXHRcdHRoaXMudmVyc2lvbiA9IHZlcnNpb247XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0TmFtZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMubmFtZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRQbGF0Zm9ybSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIEFwcC5QTEFURk9STTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRWZXJzaW9uKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy52ZXJzaW9uO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFNlc3Npb24ge1xyXG5cdHByaXZhdGUgaWQ6IHN0cmluZztcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKGlkOiBzdHJpbmcpIHtcclxuXHRcdGlmICghaWQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiaWQgbXVzdCBub3QgYmUgbnVsbFwiKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmlkID0gaWQ7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0SWQoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLmlkO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEhvc3Qge1xyXG5cdHByaXZhdGUgaWQ6IHN0cmluZztcclxuXHRwcml2YXRlIHNlc3Npb25JZDogc3RyaW5nO1xyXG5cdHByaXZhdGUgdmVyc2lvbjogc3RyaW5nO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihpZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZywgdmVyc2lvbjogc3RyaW5nKSB7XHJcblx0XHR0aGlzLmlkID0gaWQ7XHJcblx0XHR0aGlzLnNlc3Npb25JZCA9IHNlc3Npb25JZDtcclxuXHRcdHRoaXMudmVyc2lvbiA9IHZlcnNpb247XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0SWQoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLmlkO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFNlc3Npb25JZCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuc2Vzc2lvbklkO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFZlcnNpb24oKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLnZlcnNpb247XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRXZlbnQge1xyXG5cdC8vIElkIGlzIHNldCB0byBzZXNzaW9uSWQ8REVMSU1JVEVSPnNlcXVlbmNlXHJcblx0cHJpdmF0ZSBzdGF0aWMgSURfREVMSU1JVEVSID0gXCIuXCI7XHJcblx0cHJpdmF0ZSBzdGF0aWMgU09VUkNFOiBzdHJpbmcgPSBcIk1zb1RoaW5cIjtcclxuXHRwcml2YXRlIHN0YXRpYyBTQ0hFTUFfVkVSU0lPTjogbnVtYmVyID0gMTtcclxuXHJcblx0cHJpdmF0ZSBuYW1lOiBzdHJpbmc7XHJcblx0cHJpdmF0ZSBpZDogc3RyaW5nO1xyXG5cdHByaXZhdGUgc2VxdWVuY2U6IG51bWJlcjtcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgc2Vzc2lvbklkOiBzdHJpbmcsIHNlcXVlbmNlOiBudW1iZXIpIHtcclxuXHRcdGlmICghbmFtZSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJuYW1lIG11c3Qgbm90IGJlIG51bGxcIik7XHJcblx0XHR9XHJcblx0XHRpZiAoIXNlc3Npb25JZCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJzZXNzaW9uSWQgbXVzdCBub3QgYmUgbnVsbFwiKTtcclxuXHRcdH1cclxuXHRcdGlmICgoIXNlcXVlbmNlICYmIHNlcXVlbmNlICE9PSAwKSB8fCBzZXF1ZW5jZSA8IDApIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwic2VxdWVuY2UgbXVzdCBub3QgYmUgbmVnYXRpdmVcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5uYW1lID0gbmFtZTtcclxuXHRcdHRoaXMuaWQgPSBzZXNzaW9uSWQgKyBFdmVudC5JRF9ERUxJTUlURVIgKyBzZXF1ZW5jZTtcclxuXHRcdHRoaXMuc2VxdWVuY2UgPSBzZXF1ZW5jZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXROYW1lKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5uYW1lO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldElkKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5pZDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRTb3VyY2UoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBFdmVudC5TT1VSQ0U7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0U2NoZW1hVmVyc2lvbigpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIEV2ZW50LlNDSEVNQV9WRVJTSU9OO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFNlcXVlbmNlKCk6IG51bWJlciB7XHJcblx0XHRyZXR1cm4gdGhpcy5zZXF1ZW5jZTtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSZWxlYXNlIHtcclxuXHRwcml2YXRlIGF1ZGllbmNlR3JvdXA6IHN0cmluZztcclxuXHJcblx0cHVibGljIGNvbnN0cnVjdG9yKGF1ZGllbmNlR3JvdXA6IHN0cmluZykge1xyXG5cdFx0dGhpcy5hdWRpZW5jZUdyb3VwID0gYXVkaWVuY2VHcm91cDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRBdWRpZW5jZUdyb3VwKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5hdWRpZW5jZUdyb3VwO1xyXG5cdH1cclxufVxyXG4iLCIvKipcclxuICogRmFjdG9yeSB0byByZXR1cm4gSVRlbGVtZXRyeUxvZ2dlciBvYmplY3RzXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgQXBwLCBTZXNzaW9uLCBIb3N0LCBSZWxlYXNlIH0gZnJvbSBcIi4vQ29udHJhY3RzXCI7XHJcbmltcG9ydCBJVGVsZW1ldHJ5TG9nZ2VyIGZyb20gXCIuL0lUZWxlbWV0cnlMb2dnZXJcIjtcclxuaW1wb3J0IEFyaWFUZWxlbWV0cnlMb2dnZXIgZnJvbSBcIi4vQXJpYVRlbGVtZXRyeUxvZ2dlclwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGVsZW1ldHJ5TG9nZ2VyRmFjdG9yeSB7XHJcblx0cHVibGljIHN0YXRpYyBjcmVhdGUodGVuYW50VG9rZW46IHN0cmluZywgbmFtZXNwYWNlOiBzdHJpbmcsIGFwcDogQXBwLCBzZXNzaW9uOiBTZXNzaW9uLFxyXG5cdFx0aG9zdDogSG9zdCwgcmVsZWFzZTogUmVsZWFzZSk6IElUZWxlbWV0cnlMb2dnZXIge1xyXG5cdFx0XHRyZXR1cm4gbmV3IEFyaWFUZWxlbWV0cnlMb2dnZXIodGVuYW50VG9rZW4sIG5hbWVzcGFjZSwgYXBwLCBzZXNzaW9uLCBob3N0LCByZWxlYXNlKTtcclxuXHRcdH1cclxufVxyXG4iLCLvu78vKipcclxuICogU2NyZWVuc2hvdC50c1xyXG4gKlxyXG4gKiBBIG1vZHVsZSBmb3Igc2NyZWVuc2hvdCByZWxhdGVkIGxvZ2ljLlxyXG4gKiBOb3RlOiBJdCB1c2VzIHRoZSBodG5sMmNhbnZhcyBwYWNrYWdlLiBUaGUgcGFja2FnZSBjb3VsZCBiZSB1c2VkIGFzIGlzLCBpdCBpcyBub3QgcGFja2FnZWQgY29ycmVjdGx5IGZvciBicm93c2VyaWZ5LlxyXG4gKiBVc2luZyBpdCB3aXRob3V0IGJyb3dzZXJpZnkgd291bGQgaGF2ZSBwb2xsdXRlZCB0aGUgZ2xvYmFsIG5hbWVzcGFjZSBieSBvdmVycmlkaW5nIFwid2luZG93Lmh0bWwyY2FudmFzXCIuXHJcbiAqIFVudGlsIHRoZXNlIGlzc3VlcyBnZXQgZml4ZWQgdGhlIGNvZGUgaGFzIGJlZW4gY2hhbmdlZCB0byBwb2xsdXRlIHdpbmRvdy5PZmZpY2VCcm93c2VyRmVlZGJhY2suaHRtbDJjYW52YXMgaW5zdGVhZC5cclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBXaW5kb3cgZnJvbSBcIi4vV2luZG93L1dpbmRvd1wiO1xyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBzY3JlZW5zaG90XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2NyZWVuU2hvdCgpOiBQcm9taXNlPEhUTUxDYW52YXNFbGVtZW50PiB7XHJcblx0bGV0IGh0bWwyY2FudmFzID0gV2luZG93LmdldCgpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5odG1sMmNhbnZhcygpO1xyXG5cdHJldHVybiBodG1sMmNhbnZhcyhkb2N1bWVudC5ib2R5LCB7IGJhY2tncm91bmQ6IFwiI2ZmZmZmZlwiIH0pO1xyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBUaGVtZS50c1xyXG4gKlxyXG4gKiBNb2R1bGUgZm9yIHRoZSBVSSBUaGVtZVxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIENvbnN0YW50cyBmcm9tIFwiLi9Db25zdGFudHNcIjtcclxuXHJcbmxldCBkZWZhdWx0UHJpbWFyeUNvbG91ciA9IFwiIzAxNjdCMFwiO1xyXG5sZXQgZGVmYXVsdFNlY29uZGFyeUNvbG91ciA9IFwiIzE5NDc4OVwiO1xyXG5cclxuLyoqXHJcbiAqIEluaXRcclxuICogQHBhcmFtIHtzdHJpbmd9IHByaW1hcnlDb2xvdXIgUHJpbWFyeSBDb2xvdXJcclxuICogQHBhcmFtIHtzdHJpbmd9IHNlY29uZGFyeUNvbG91ciBTZWNvbmRhcnkgQ29sb3VyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZShwcmltYXJ5Q29sb3VyOiBzdHJpbmcgPSB1bmRlZmluZWQsIHNlY29uZGFyeUNvbG91cjogc3RyaW5nID0gdW5kZWZpbmVkKSB7XHJcblx0aWYgKCFwcmltYXJ5Q29sb3VyKSB7XHJcblx0XHRwcmltYXJ5Q29sb3VyID0gZGVmYXVsdFByaW1hcnlDb2xvdXI7XHJcblx0fVxyXG5cclxuXHRpZiAoIXNlY29uZGFyeUNvbG91cikge1xyXG5cdFx0c2Vjb25kYXJ5Q29sb3VyID0gZGVmYXVsdFNlY29uZGFyeUNvbG91cjtcclxuXHR9XHJcblxyXG5cdGxldCBzaGVldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcclxuXHJcblx0c2hlZXQudGV4dENvbnRlbnQgPVxyXG5cdFx0YC4ke0NvbnN0YW50cy5DbGFzc2VzLk92ZXJhbGxBbmNob3J9OmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjogJHtzZWNvbmRhcnlDb2xvdXJ9IH0gYCArXHJcblx0XHRgLiR7Q29uc3RhbnRzLkNsYXNzZXMuT3ZlcmFsbEFuY2hvckFjdGl2ZX0geyBiYWNrZ3JvdW5kLWNvbG9yOiAke3ByaW1hcnlDb2xvdXJ9IH0gYCArXHJcblx0XHRgLiR7Q29uc3RhbnRzLkNsYXNzZXMuU3Bpbm5lckNpcmNsZX0geyBiYWNrZ3JvdW5kLWNvbG9yOiAke3ByaW1hcnlDb2xvdXJ9IH0gYCArXHJcblx0XHQvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXHJcblx0XHRgLiR7Q29uc3RhbnRzLkNsYXNzZXMuQ2hvaWNlR3JvdXB9IGlucHV0W3R5cGU9cmFkaW9dOmNoZWNrZWQrbGFiZWw+LiR7Q29uc3RhbnRzLkNsYXNzZXMuQ2hvaWNlR3JvdXBJY29ufSB7IGJvcmRlci1jb2xvcjogJHtwcmltYXJ5Q29sb3VyfSB9IGAgK1xyXG5cdFx0Ly8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxyXG5cdFx0YC4ke0NvbnN0YW50cy5DbGFzc2VzLkNob2ljZUdyb3VwfSBpbnB1dFt0eXBlPXJhZGlvXTpob3ZlcitsYWJlbD4uJHtDb25zdGFudHMuQ2xhc3Nlcy5DaG9pY2VHcm91cEljb259IHsgYm9yZGVyLWNvbG9yOiAke3NlY29uZGFyeUNvbG91cn0gfSBgICtcclxuXHRcdC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcclxuXHRcdGAuJHtDb25zdGFudHMuQ2xhc3Nlcy5DaG9pY2VHcm91cH0gaW5wdXRbdHlwZT1yYWRpb106Y2hlY2tlZCtsYWJlbD4uJHtDb25zdGFudHMuQ2xhc3Nlcy5DaG9pY2VHcm91cEljb259PnNwYW4geyBiYWNrZ3JvdW5kLWNvbG9yOiAke3ByaW1hcnlDb2xvdXJ9IH0gYCArXHJcblx0XHRgLiR7Q29uc3RhbnRzLkNsYXNzZXMuU3VibWl0QnV0dG9ufSB7IGJhY2tncm91bmQtY29sb3I6ICR7cHJpbWFyeUNvbG91cn0gfSBgICtcclxuXHRcdGAuJHtDb25zdGFudHMuQ2xhc3Nlcy5TdWJtaXRCdXR0b259OmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjogJHtzZWNvbmRhcnlDb2xvdXJ9IH0gYCArXHJcblx0XHRgLiR7Q29uc3RhbnRzLkNsYXNzZXMuTGlua30geyBjb2xvcjogJHtwcmltYXJ5Q29sb3VyfSB9IGAgK1xyXG5cdFx0YC4ke0NvbnN0YW50cy5DbGFzc2VzLkxpbmt9OmhvdmVyIHsgY29sb3I6ICR7c2Vjb25kYXJ5Q29sb3VyfSB9IGAgK1xyXG5cdFx0YCMke0NvbnN0YW50cy5JRHMuVFByb21wdFRpdGxlfSB7IGNvbG9yOiAke3ByaW1hcnlDb2xvdXJ9IH0gYCArXHJcblx0XHRgIyR7Q29uc3RhbnRzLklEcy5URm9ybVRpdGxlfSB7IGNvbG9yOiAke3ByaW1hcnlDb2xvdXJ9IH0gYDtcclxuXHJcblx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzaGVldCk7XHJcbn1cclxuIiwiLyoqXHJcbiAqIE1hbmlmZXN0LnRzXHJcbiAqIE1vZHVsZSBmb3IgbWFuYWdpbmcgdGhlIG1hbmlmZXN0IGZpbGVcclxuICovXHJcblxyXG5pbXBvcnQgeyBJRmlsZSB9IGZyb20gXCIuL0lGaWxlXCI7XHJcbmltcG9ydCB7IEZlZWRiYWNrVHlwZSB9IGZyb20gXCIuLy4uLy4uL0NvbnN0YW50c1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE1hbmlmZXN0IGltcGxlbWVudHMgSUZpbGUge1xyXG5cdHByaXZhdGUgbWFuaWZlc3REYXRhOiBJTWFuaWZlc3REYXRhO1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3IobWFuaWZlc3RUeXBlOiBzdHJpbmcsIGFwcElkOiBudW1iZXIsIHN1Ym1pdFRpbWU6IHN0cmluZywgdHlwZTogTWFuaWZlc3RGZWVkYmFja1R5cGUsXHJcblx0XHRjbGllbnRGZWVkYmFja0lkOiBzdHJpbmcsIGFwcGxpY2F0aW9uR3JvdXA6IElNYW5pZmVzdERhdGFBcHBsaWNhdGlvbiwgdGVsZW1ldHJ5R3JvdXA6IElNYW5pZmVzdERhdGFUZWxlbWV0cnksXHJcblx0XHR3ZWJHcm91cDogSU1hbmlmZXN0RGF0YVdlYikge1xyXG5cdFx0dGhpcy5tYW5pZmVzdERhdGEgPSB7XHJcblx0XHRcdGFwcElkOiBhcHBJZCxcclxuXHRcdFx0YXBwbGljYXRpb246IGFwcGxpY2F0aW9uR3JvdXAsXHJcblx0XHRcdGNsaWVudEZlZWRiYWNrSWQ6IGNsaWVudEZlZWRiYWNrSWQsXHJcblx0XHRcdG1hbmlmZXN0VHlwZTogbWFuaWZlc3RUeXBlLFxyXG5cdFx0XHRzb3VyY2U6IFwiQ2xpZW50XCIsXHJcblx0XHRcdHN1Ym1pdFRpbWU6IHN1Ym1pdFRpbWUsXHJcblx0XHRcdHRlbGVtZXRyeTogdGVsZW1ldHJ5R3JvdXAsXHJcblx0XHRcdHR5cGU6IHNhbml0aXplVHlwZSh0eXBlKSxcclxuXHRcdFx0d2ViOiB3ZWJHcm91cCxcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0Q29tbWVudChjb21tZW50OiBzdHJpbmcpIHtcclxuXHRcdHRoaXMubWFuaWZlc3REYXRhLmNvbW1lbnQgPSBjb21tZW50O1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldEVtYWlsKGVtYWlsOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMubWFuaWZlc3REYXRhLmVtYWlsID0gZW1haWw7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0Q2F0ZWdvcnkoY2F0ZWdvcnk6IHN0cmluZykge1xyXG5cdFx0dGhpcy5tYW5pZmVzdERhdGEudGVsZW1ldHJ5ID0gdGhpcy5tYW5pZmVzdERhdGEudGVsZW1ldHJ5IHx8IHt9O1xyXG5cdFx0dGhpcy5tYW5pZmVzdERhdGEudGVsZW1ldHJ5LmZlYXR1cmVBcmVhID0gY2F0ZWdvcnk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTZXQgZnJlZWZvcm0gY3VzdG9tIHZhbHVlcyBpbiBtYW5pZmVzdC4gVGhyb3dzIGlmIHZhbHVlcyBhcmUgYWxyZWFkeSBzZXQuXHJcblx0ICogQHBhcmFtIHZhbHVlcyB0aGUgdmFsdWVzIGFzIGEgSlMgb2JqZWN0XHJcblx0ICovXHJcblx0cHVibGljIHNldFZhbHVlcyh2YWx1ZXM6IG9iamVjdCkge1xyXG5cdFx0aWYgKHZhbHVlcykge1xyXG5cdFx0XHRmb3IgKGxldCBmaWVsZCBpbiB2YWx1ZXMpIHtcclxuXHRcdFx0XHRpZiAodmFsdWVzLmhhc093blByb3BlcnR5KGZpZWxkKSkge1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMubWFuaWZlc3REYXRhLmhhc093blByb3BlcnR5KGZpZWxkKSkge1xyXG5cdFx0XHRcdFx0XHR0aHJvdyBFcnJvcihcIktleSAnXCIgKyBmaWVsZCArIFwiJyBhbHJlYWR5IGV4aXN0cyBpbiBtYW5pZmVzdC5cIik7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0KDxhbnk+IHRoaXMubWFuaWZlc3REYXRhKVtmaWVsZF0gPSAoPGFueT4gdmFsdWVzKVtmaWVsZF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0Q29udGVudCgpOiBCbG9iIHtcclxuXHRcdHJldHVybiBuZXcgQmxvYihbSlNPTi5zdHJpbmdpZnkodGhpcy5tYW5pZmVzdERhdGEpXSwge3R5cGUgOiBcImFwcGxpY2F0aW9uL2pzb25cIn0pO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2FuaXRpemVUeXBlKHR5cGU6IE1hbmlmZXN0RmVlZGJhY2tUeXBlKTogc3RyaW5nIHtcclxuXHRpZiAodHlwZSA9PT0gXCJTdXJ2ZXlcIikge1xyXG5cdFx0cmV0dXJuIHR5cGU7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybiBGZWVkYmFja1R5cGVbdHlwZV07XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgdHlwZSBNYW5pZmVzdEZlZWRiYWNrVHlwZSA9IEZlZWRiYWNrVHlwZSB8IFwiU3VydmV5XCI7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIGZvciB0aGUgbWFuaWZlc3QgZGF0YVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJTWFuaWZlc3REYXRhIHtcclxuXHQvLyAjcmVnaW9uIFwiUmVxdWlyZWQgcHJvcGVydGllc1wiXHJcblx0bWFuaWZlc3RUeXBlOiBzdHJpbmc7XHJcblx0YXBwSWQ6IG51bWJlcjtcclxuXHRzdWJtaXRUaW1lOiBzdHJpbmc7XHJcblx0c291cmNlOiBzdHJpbmc7XHJcblx0dHlwZTogc3RyaW5nO1xyXG5cdGNsaWVudEZlZWRiYWNrSWQ6IHN0cmluZztcclxuXHQvLyAjZW5kcmVnaW9uIFwiUmVxdWlyZWQgcHJvcGVydGllc1wiXHJcblx0Y29tbWVudD86IHN0cmluZztcclxuXHRlbWFpbD86IHN0cmluZztcclxuXHRyYXRpbmc/OiBudW1iZXI7XHJcblx0c3VydmV5PzogSU1hbmlmZXN0RGF0YVN1cnZleTtcclxuXHR3ZWI/OiBJTWFuaWZlc3REYXRhV2ViO1xyXG5cdGFwcGxpY2F0aW9uPzogSU1hbmlmZXN0RGF0YUFwcGxpY2F0aW9uO1xyXG5cdHRlbGVtZXRyeT86IElNYW5pZmVzdERhdGFUZWxlbWV0cnk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgZm9yIHN1cnZleSByZWxhdGVkIHByb3BlcnRpZXMgaW4gbWFuaWZlc3RcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU1hbmlmZXN0RGF0YVN1cnZleSB7XHJcblx0c3VydmV5SWQ6IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3IgYXBwbGljYXRpb24gcmVsYXRlZCBwcm9wZXJ0aWVzIGluIG1hbmlmZXN0XHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIElNYW5pZmVzdERhdGFBcHBsaWNhdGlvbiB7XHJcblx0YXBwRGF0YT86IHN0cmluZztcclxuXHRleHRlbmRlZE1hbmlmZXN0RGF0YT86IHN0cmluZztcclxuXHRmZWVkYmFja1RlbmFudD86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3IgdGVsZW1ldHJ5IHJlbGF0ZWQgcHJvcGVydGllcyBpbiBtYW5pZmVzdFxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJTWFuaWZlc3REYXRhVGVsZW1ldHJ5IHtcclxuXHRhdWRpZW5jZT86IHN0cmluZztcclxuXHRhdWRpZW5jZUdyb3VwPzogc3RyaW5nO1xyXG5cdGNoYW5uZWw/OiBzdHJpbmc7XHJcblx0ZGV2aWNlSWQ/OiBzdHJpbmc7XHJcblx0ZGV2aWNlVHlwZT86IHN0cmluZztcclxuXHRlcnJvckNsYXNzaWZpY2F0aW9uPzogc3RyaW5nO1xyXG5cdGVycm9yQ29kZT86IHN0cmluZztcclxuXHRlcnJvck5hbWU/OiBzdHJpbmc7XHJcblx0ZmVhdHVyZUFyZWE/OiBzdHJpbmc7XHJcblx0ZmxpZ2h0cz86IHN0cmluZztcclxuXHRmbGlnaHRTb3VyY2U/OiBzdHJpbmc7XHJcblx0ZnVuZGFtZW50YWxBcmVhPzogc3RyaW5nO1xyXG5cdGluc3RhbGxhdGlvblR5cGU/OiBzdHJpbmc7XHJcblx0aXNMb2dJbmNsdWRlZD86IGJvb2xlYW47XHJcblx0aXNVc2VyU3Vic2NyaWJlcj86IGJvb2xlYW47XHJcblx0bG9nZ2FibGVVc2VySWQ/OiBzdHJpbmc7XHJcblx0b2ZmaWNlQXJjaGl0ZWN0dXJlPzogc3RyaW5nO1xyXG5cdG9mZmljZUJ1aWxkPzogc3RyaW5nO1xyXG5cdG9mZmljZUVkaXRpbmdMYW5nPzogbnVtYmVyO1xyXG5cdG9mZmljZVVJTGFuZz86IG51bWJlcjtcclxuXHRvc0JpdG5lc3M/OiBudW1iZXI7XHJcblx0b3NCdWlsZD86IHN0cmluZztcclxuXHRvc1VzZXJMYW5nPzogbnVtYmVyO1xyXG5cdHBsYXRmb3JtPzogc3RyaW5nO1xyXG5cdHByb2Nlc3NTZXNzaW9uSWQ/OiBzdHJpbmc7XHJcblx0cmluZ0lkPzogbnVtYmVyO1xyXG5cdHNrdT86IHN0cmluZztcclxuXHRzb3VyY2VDb250ZXh0Pzogc3RyaW5nO1xyXG5cdHN5c3RlbVByb2R1Y3ROYW1lPzogc3RyaW5nO1xyXG5cdHN5c3RlbU1hbnVmYWN0dXJlcj86IHN0cmluZztcclxuXHR0ZW5hbnRJZD86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3Igd2ViIHJlbGF0ZWQgcHJvcGVydGllcyBpbiBtYW5pZmVzdFxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBJTWFuaWZlc3REYXRhV2ViIHtcclxuXHRicm93c2VyPzogc3RyaW5nO1xyXG5cdGJyb3dzZXJWZXJzaW9uPzogc3RyaW5nO1xyXG5cdGRhdGFDZW50ZXI/OiBzdHJpbmc7XHJcblx0c291cmNlUGFnZU5hbWU/OiBzdHJpbmc7XHJcblx0c291cmNlUGFnZVVSST86IHN0cmluZztcclxufVxyXG4iLCIvKipcclxuICogU2NyZWVuc2hvdC50c1xyXG4gKiBNb2R1bGUgZm9yIG1hbmFnaW5nIHRoZSBzY3JlZW5zaG90IGZpbGVcclxuICovXHJcblxyXG4vKiB0c2xpbnQ6ZGlzYWJsZSBtYXgtbGluZS1sZW5ndGggKi9cclxuaW1wb3J0IHtJRmlsZX0gZnJvbSBcIi4vSUZpbGVcIjtcclxuaW1wb3J0ICogYXMgTG9nZ2luZyBmcm9tIFwiLi8uLi8uLi9Mb2dnaW5nL0xvZ2dpbmdcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTY3JlZW5zaG90IGltcGxlbWVudHMgSUZpbGUge1xyXG5cdHByaXZhdGUgc2NyZWVuc2hvdDogSFRNTENhbnZhc0VsZW1lbnQ7XHJcblxyXG5cdGNvbnN0cnVjdG9yIChzY3JlZW5zaG90OiBIVE1MQ2FudmFzRWxlbWVudCkge1xyXG5cdFx0dGhpcy5zY3JlZW5zaG90ID0gc2NyZWVuc2hvdDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRDb250ZW50KCk6IEJsb2Ige1xyXG5cdFx0bGV0IGltZ1N0cmluZzogc3RyaW5nO1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0aW1nU3RyaW5nID0gdGhpcy5zY3JlZW5zaG90LnRvRGF0YVVSTChcImltYWdlL2pwZWdcIikuc3BsaXQoXCIsXCIpWzFdO1xyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRMb2dnaW5nLmdldExvZ2dlcigpLmxvZ0V2ZW50KExvZ2dpbmcuRXZlbnRJZHMuU2hhcmVkLlNjcmVlbnNob3QuR2V0Q29udGVudC5GYWlsZWQuRGVmYXVsdEltYWdlLlJldHVybmVkLlZBTFVFLCB7IEVycm9yTWVzc2FnZTogZS50b1N0cmluZygpIH0pO1xyXG5cclxuXHRcdFx0Ly8gcmV0dXJuIGFuIGltYWdlIHdpdGggXCJTY3JlZW5zaG90IGNhbm5vdCBiZSBjYXB0dXJlZFwiIG1lc3NhZ2VcclxuXHRcdFx0aW1nU3RyaW5nID0gXCJpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBTjBBQUFBK0FRTUFBQUNWMm94MUFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWlFURlJGQUFBQS8vLy9wZG1mM1FBQUFBbHdTRmx6QUFBT3dnQUFEc0lCRlNoS2dBQUFBanRKUkVGVVNNZlYxTTFyRTBFVUFIREJhNXI4QTl2a0w2Z2lGaUkwSkgrSWg5S0x4OFRhdWtrSnVnU2hIZ3JKell2a1ZQUWtVcWd3U2VQTEVFTGFVK3pCZzhKS1Z2U1FRTnlkbHNhZHdDUXp6aVJaODJFVHhZTWZjM2dEOCtNeGp6Y2ZWOFQ4MGYwdmtROGk2OHRBUFNNU1EwUGtJNlFEcEVQa1pCSHkxV3AxL3pqbmkybHJacTJUMnVpa0RHMTdBNTRIcjB2c3Z3WElsM1dYdDAyemVJSFFCU3EzRHhIazdWTzU1eklGZ0xMcmNtYWFRQkdpcUN3UUFyQlZRVGJOWk9ETkJCNUVlMkVFcjVlR2lERzRrNW1jcWN5K0tzaCtOOEsyK2JSSTFaNjhmUk1Wb1YrWG1jRndwUUpaR29ocGtkczFXdGpwcEdMYXE1MWEyYjh5cDMxMFVXOS9IOFZmUmo2OENJS1JzV0NGUENDRU00MTlTNGJTQU9tUG1kYjNUQnJRNGxtbnQ5bjQvSGl2NWZUdW5zT3pYYkpmTFIyclUzRmQ1dWdPZTltdzBsdk5PQ054eURkSUhrcEhDdjBTM2ErTVMweVQrNHdrQUt4MWdCSmVWeGVNUmhTZU5acFhKZlkrenFBVmwrZzBtQ0ZSSk1nczZveTkrTUNNcldaYUpKd2lXRmp1V2NJU2hmK1drMlc5ZTU5T0h1MjFXUGRzc3daTkxLczl3Vjc3bUppYU1WYkJRKy8xakdaRG9mRkx1T0JVL2p6RzZPUUtua0xPWjVFdndvbE1YMlExOVRBWDlNV3l5L2FOYXJld2ZacHRlY2hkTG44QjNUYXRCL1lYQjJqNE1LdzNqVEhLWDRBTzBDYnFhU2RkTW9rSFVicjBQcFNYbUZHNE80V0l1ODZhc0NWaWhmb002blVtc2U1Z0drYkpPeVRoVmVzWDRVSTBkMDBMQllNcjU1VnVJWmw4TWtZMXVPaVR5OXYzYytTaHVYajUrTmRRZEw4Qis1Z213OFdadVJFQUFBQUFTVVZPUks1Q1lJST1cIjtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgYmxvYkJpbiA9IGF0b2IoaW1nU3RyaW5nKTtcclxuXHRcdGxldCBhcnJheSA9IFtdO1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBibG9iQmluLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGFycmF5LnB1c2goYmxvYkJpbi5jaGFyQ29kZUF0KGkpKTtcclxuXHRcdH1cclxuXHRcdGxldCBmaWxlOiBCbG9iID0gbmV3IEJsb2IoW25ldyBVaW50OEFycmF5KGFycmF5KV0sIHt0eXBlOiBcImltYWdlL2pwZWdcIn0pO1xyXG5cclxuXHRcdHJldHVybiBmaWxlO1xyXG5cdH1cclxufVxyXG4iLCJpbXBvcnQgeyBQcm9taXNlLCBUaGVuYWJsZSB9IGZyb20gXCJlczYtcHJvbWlzZVwiO1xyXG5cclxuY29uc3QgSFRUUF9USU1FT1VUOiBudW1iZXIgPSA0MDAwOyAvLyB0aW1lb3V0IGluIG1pbGxpc2Vjb25kc1xyXG5cclxuLyoqXHJcbiAqIE1ha2UgYW4gaHR0cCByZXF1ZXN0IHdpdGggcmV0cmllc1xyXG4gKiBAcGFyYW0gbWV0aG9kIHRoZSBodHRwIG1ldGhvZCBcIkdFVFwiLCBcIlBPU1RcIiBldGNcclxuICogQHBhcmFtIHVybCB0aGUgdXJsXHJcbiAqIEBwYXJhbSByZXF1ZXN0Qm9keSB0aGUgcmVxdWVzdCBib2R5XHJcbiAqIEBwYXJhbSBtYXhSZXRyaWVzIHRoZSBtYXhpbXVtIG51bWJlciBvZiByZXRyaWVzXHJcbiAqIEBwYXJhbSBvbkxvYWQgdGhlIG9ubG9hZCBoYW5kbGVyXHJcbiAqL1xyXG5mdW5jdGlvbiBtYWtlSHR0cFJlcXVlc3Q8VD4obWV0aG9kOiBzdHJpbmcsIHVybDogc3RyaW5nLCByZXF1ZXN0Qm9keTogYW55LCBtYXhSZXRyaWVzOiBudW1iZXIsXHJcblx0b25Mb2FkOiAoeGhyOiBYTUxIdHRwUmVxdWVzdCwgcmVzb2x2ZTogKHZhbHVlPzogVCB8IFRoZW5hYmxlPFQ+KSA9PiB2b2lkLCByZWplY3Q6IChlcnJvcj86IGFueSkgPT4gdm9pZCkgPT4gdm9pZFxyXG4pOiBQcm9taXNlPFQ+IHtcclxuXHRsZXQgbWFrZVJlcXVlc3Q6IChyZXRyaWVzOiBudW1iZXIpID0+IFByb21pc2U8VD4gPVxyXG5cdFx0KHJldHJpZXM6IG51bWJlcikgPT4ge1xyXG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0XHRcdGxldCB4aHI6IFhNTEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcblx0XHRcdFx0eGhyLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xyXG5cdFx0XHRcdHhoci50aW1lb3V0ID0gSFRUUF9USU1FT1VUO1xyXG5cdFx0XHRcdHhoci5vbmxvYWQgPSAoKSA9PiB7IG9uTG9hZCh4aHIsIHJlc29sdmUsIHJlamVjdCk7IH07XHJcblx0XHRcdFx0eGhyLm9udGltZW91dCA9ICgpID0+IHtcclxuXHRcdFx0XHRcdGlmIChyZXRyaWVzID4gMCkge1xyXG5cdFx0XHRcdFx0XHRtYWtlUmVxdWVzdChyZXRyaWVzIC0gMSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0cmVqZWN0KG5ldyBFcnJvcihgUmVxdWVzdCB0byAnJHt1cmx9JyB0aW1lZCBvdXQuIHRpbWVvdXQ6ICR7SFRUUF9USU1FT1VUfWApKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9O1xyXG5cdFx0XHRcdHhoci5vbmVycm9yID0gKCkgPT4ge1xyXG5cdFx0XHRcdFx0aWYgKHJldHJpZXMgPiAwKSB7XHJcblx0XHRcdFx0XHRcdG1ha2VSZXF1ZXN0KHJldHJpZXMgLSAxKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRyZWplY3QobmV3IEVycm9yKGBSZXF1ZXN0IHRvICcke3VybH0nIGVycm9yZWQuICR7eGhyLnN0YXR1c306ICR7eGhyLnJlc3BvbnNlVGV4dH1gKSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0XHR4aHIuc2VuZChyZXF1ZXN0Qm9keSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHJcblx0cmV0dXJuIG1ha2VSZXF1ZXN0KG1heFJldHJpZXMpO1xyXG59XHJcblxyXG5jb25zdCB1cGxvYWRFbmRwb2ludEludDogc3RyaW5nID0gXCJodHRwczovL3BldHJvbC1pbnQub2ZmaWNlLm1pY3Jvc29mdC5jb20vdjEvZmVlZGJhY2tcIjtcclxuY29uc3QgdXBsb2FkRW5kcG9pbnRQcm9kOiBzdHJpbmcgPSBcImh0dHBzOi8vcGV0cm9sLm9mZmljZS5taWNyb3NvZnQuY29tL3YxL2ZlZWRiYWNrXCI7XHJcblxyXG4vKipcclxuICogU2VuZCBhIHBheWxvYWQgdG8gUGV0cm9sXHJcbiAqIEBwYXJhbSBpc1Byb2R1Y3Rpb24gaXMgcHJvZHVjdGlvbj9cclxuICogQHBhcmFtIG1hbmlmZXN0IG1hbmlmZXN0IGNvbnRlbnRcclxuICogQHBhcmFtIHNjcmVlbnNob3Qgc2NyZWVuc2hvdCBjb250ZW50XHJcbiAqIEBwYXJhbSBkaWFnbm9zdGljcyBkaWFnbm9zdGljcyBjb250ZW50XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2VuZChpc1Byb2R1Y3Rpb246IGJvb2xlYW4sIG1hbmlmZXN0OiBCbG9iLCBzY3JlZW5zaG90PzogQmxvYiwgZGlhZ25vc3RpY3M/OiBCbG9iKTogUHJvbWlzZTxhbnk+IHtcclxuXHRpZiAobWFuaWZlc3QgPT09IHVuZGVmaW5lZCkge1xyXG5cdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIk1hbmlmZXN0IGNhbm5vdCBiZSB1bmRlZmluZWRcIikpO1xyXG5cdH1cclxuXHJcblx0bGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XHJcblx0Zm9ybURhdGEuYXBwZW5kKFwiTWFuaWZlc3RcIiwgbWFuaWZlc3QpO1xyXG5cclxuXHRpZiAoc2NyZWVuc2hvdCkge1xyXG5cdFx0Zm9ybURhdGEuYXBwZW5kKFwiU2NyZWVuc2hvdFwiLCBzY3JlZW5zaG90KTtcclxuXHR9XHJcblxyXG5cdGlmIChkaWFnbm9zdGljcykge1xyXG5cdFx0Zm9ybURhdGEuYXBwZW5kKFwiRGlhZ25vc3RpY3NcIiwgZGlhZ25vc3RpY3MpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIG1ha2VIdHRwUmVxdWVzdDxhbnk+KFwiUE9TVFwiLCBpc1Byb2R1Y3Rpb24gPyB1cGxvYWRFbmRwb2ludFByb2QgOiB1cGxvYWRFbmRwb2ludEludCwgZm9ybURhdGEsIDIsXHJcblx0XHRmdW5jdGlvbiAoXHJcblx0XHRcdHhocjogWE1MSHR0cFJlcXVlc3QsXHJcblx0XHRcdHJlc29sdmU6ICh2YWx1ZT86IGFueSkgPT4gdm9pZCxcclxuXHRcdFx0cmVqZWN0OiAoZXJyb3I/OiBhbnkpID0+IHZvaWRcclxuXHRcdCk6IHZvaWQge1xyXG5cdFx0XHRpZiAoeGhyLnN0YXR1cyAhPT0gMjAwKSB7XHJcblx0XHRcdFx0cmVqZWN0KG5ldyBFcnJvcihcIk5vbi0yMDAgcmVzcG9uc2Ugd2l0aCBzdGF0dXMgY29kZTogXCIgKyB4aHIuc3RhdHVzICsgXCIsIHJlc3BvbnNlOiBcIiArIHhoci5yZXNwb25zZVRleHQpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXNvbHZlKCk7XHJcblx0XHR9KTtcclxufVxyXG4iLCIvKipcclxuICogRmVlZGJhY2sudHNcclxuICpcclxuICogTW9kdWxlIGZvciBwYXlsb2FkIHRyYW5zcG9ydC5cclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBDb25zdGFudHMgZnJvbSBcIi4vLi4vQ29uc3RhbnRzXCI7XHJcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gXCIuLy4uL1V0aWxzXCI7XHJcbmltcG9ydCAqIGFzIExvZ2dpbmcgZnJvbSBcIi4vLi4vTG9nZ2luZy9Mb2dnaW5nXCI7XHJcbmltcG9ydCAqIGFzIFBldHJvbCBmcm9tIFwiLi9QZXRyb2xcIjtcclxuaW1wb3J0IHsgU2NyZWVuc2hvdCB9IGZyb20gXCIuL0ZpbGVzL1NjcmVlbnNob3RcIjtcclxuaW1wb3J0ICogYXMgQ29uZmlndXJhdGlvbiBmcm9tIFwiLi4vQ29uZmlndXJhdGlvbi9Db25maWd1cmF0aW9uXCI7XHJcbmltcG9ydCB7IE1hbmlmZXN0LCBNYW5pZmVzdEZlZWRiYWNrVHlwZSwgSU1hbmlmZXN0RGF0YUFwcGxpY2F0aW9uLCBJTWFuaWZlc3REYXRhVGVsZW1ldHJ5LCBJTWFuaWZlc3REYXRhV2ViIH1cclxuXHRmcm9tIFwiLi9GaWxlcy9NYW5pZmVzdFwiO1xyXG5cclxuaW1wb3J0IHsgUHJvbWlzZSB9IGZyb20gXCJlczYtcHJvbWlzZVwiO1xyXG5cclxuZXhwb3J0IHsgSU1hbmlmZXN0RGF0YUFwcGxpY2F0aW9uLCBJTWFuaWZlc3REYXRhVGVsZW1ldHJ5LCBJTWFuaWZlc3REYXRhV2ViIH0gZnJvbSBcIi4vRmlsZXMvTWFuaWZlc3RcIlxyXG5cclxuZXhwb3J0IGNsYXNzIFRyYW5zcG9ydGVyIHtcclxuXHRwcml2YXRlIG1hbmlmZXN0OiBNYW5pZmVzdDtcclxuXHRwcml2YXRlIHNjcmVlbnNob3Q6IFNjcmVlbnNob3Q7XHJcblx0cHJpdmF0ZSBlbnZpcm9ubWVudDogQ29uc3RhbnRzLkVudmlyb25tZW50O1xyXG5cclxuXHRwdWJsaWMgY29uc3RydWN0b3IoZW52aXJvbm1lbnQ6IENvbnN0YW50cy5FbnZpcm9ubWVudCwgbWFuaWZlc3RUeXBlOiBzdHJpbmcsIGFwcElkOiBudW1iZXIsXHJcblx0XHR0eXBlOiBNYW5pZmVzdEZlZWRiYWNrVHlwZSwgYXBwbGljYXRpb25Hcm91cDogSU1hbmlmZXN0RGF0YUFwcGxpY2F0aW9uLCB0ZWxlbWV0cnlHcm91cDogSU1hbmlmZXN0RGF0YVRlbGVtZXRyeSxcclxuXHRcdHdlYkdyb3VwOiBJTWFuaWZlc3REYXRhV2ViKSB7XHJcblx0XHR0aGlzLm1hbmlmZXN0ID0gbmV3IE1hbmlmZXN0KG1hbmlmZXN0VHlwZSwgYXBwSWQsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgdHlwZSxcclxuXHRcdFx0VXRpbHMuZ3VpZCgpLCBhcHBsaWNhdGlvbkdyb3VwLFxyXG5cdFx0XHR0ZWxlbWV0cnlHcm91cCwgd2ViR3JvdXApO1xyXG5cdFx0dGhpcy5lbnZpcm9ubWVudCA9IGVudmlyb25tZW50O1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldENvbW1lbnQoY29tbWVudDogc3RyaW5nKSB7XHJcblx0XHR0aGlzLm1hbmlmZXN0LnNldENvbW1lbnQoY29tbWVudCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0RW1haWwoZW1haWw6IHN0cmluZykge1xyXG5cdFx0dGhpcy5tYW5pZmVzdC5zZXRFbWFpbChlbWFpbCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0Q2F0ZWdvcnkoY2F0ZWdvcnk6IHN0cmluZykge1xyXG5cdFx0dGhpcy5tYW5pZmVzdC5zZXRDYXRlZ29yeShjYXRlZ29yeSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0U2NyZWVuc2hvdChzY3JlZW5zaG90OiBIVE1MQ2FudmFzRWxlbWVudCkge1xyXG5cdFx0dGhpcy5zY3JlZW5zaG90ID0gbmV3IFNjcmVlbnNob3Qoc2NyZWVuc2hvdCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTZXQgZnJlZWZvcm0gY3VzdG9tIHZhbHVlcyBpbiBtYW5pZmVzdC4gVGhyb3dzIGlmIHZhbHVlcyBhcmUgYWxyZWFkeSBzZXQuXHJcblx0ICogQHBhcmFtIHZhbHVlcyB0aGUgdmFsdWVzIGFzIGEgSlMgb2JqZWN0XHJcblx0ICovXHJcblx0cHVibGljIHNldE1hbmlmZXN0VmFsdWVzKHZhbHVlczogb2JqZWN0KSB7XHJcblx0XHR0aGlzLm1hbmlmZXN0LnNldFZhbHVlcyh2YWx1ZXMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU3VibWl0IHRoZSBwYXlsb2FkXHJcblx0ICovXHJcblx0cHVibGljIHN1Ym1pdCgpOiBQcm9taXNlPGFueT4ge1xyXG5cdFx0bGV0IG1hbmlmZXN0Q29udGVudDogQmxvYiA9IHRoaXMubWFuaWZlc3QuZ2V0Q29udGVudCgpO1xyXG5cdFx0bGV0IHNjcmVlbnNob3RDb250ZW50OiBCbG9iID0gdW5kZWZpbmVkO1xyXG5cclxuXHRcdGlmICh0aGlzLnNjcmVlbnNob3QpIHtcclxuXHRcdFx0c2NyZWVuc2hvdENvbnRlbnQgPSB0aGlzLnNjcmVlbnNob3QuZ2V0Q29udGVudCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBQZXRyb2wuc2VuZCh0aGlzLmVudmlyb25tZW50ID09PSBDb25zdGFudHMuRW52aXJvbm1lbnQuUHJvZHVjdGlvbiwgbWFuaWZlc3RDb250ZW50LCBzY3JlZW5zaG90Q29udGVudClcclxuXHRcdFx0XHQuY2F0Y2goXHJcblx0XHRcdFx0XHRmdW5jdGlvbiBvblJlamVjdGVkKGVycjogRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRDb21tb25Jbml0T3B0aW9ucygpLm9uRXJyb3IoXCJQYXlsb2FkIHN1Ym1pc3Npb24gZmFpbGVkOiBcIiArIGVyci5tZXNzYWdlKTtcclxuXHRcdFx0XHRcdFx0TG9nZ2luZy5nZXRMb2dnZXIoKS5sb2dFdmVudChMb2dnaW5nLkV2ZW50SWRzLlNoYXJlZC5VcGxvYWQuRmFpbGVkLlZBTFVFLCB7IEVycm9yTWVzc2FnZTogZXJyLm1lc3NhZ2UgfSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0KTtcclxuXHR9XHJcbn1cclxuIiwi77u/LyoqXHJcbiAqIFVJU3RyaW5ncy50c1xyXG4gKlxyXG4gKiBNb2R1bGUgZm9yIHRoZSBzdHJpbmdzIHRvIGRpc3BsYXlcclxuICovXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElVSVN0cmluZ3Mge1xyXG5cdEZlZWRiYWNrU3VidGl0bGU6IHN0cmluZztcclxuXHRQcml2YWN5U3RhdGVtZW50OiBzdHJpbmc7XHJcblxyXG5cdEZvcm06IHtcclxuXHRcdENvbW1lbnRQbGFjZWhvbGRlcjogc3RyaW5nO1xyXG5cdFx0Q2F0ZWdvcnlQbGFjZWhvbGRlcjogc3RyaW5nO1xyXG5cdFx0RW1haWxQbGFjZWhvbGRlcjogc3RyaW5nO1xyXG5cdFx0UmF0aW5nTGFiZWw6IHN0cmluZztcclxuXHRcdFNjcmVlbnNob3RMYWJlbDogc3RyaW5nO1xyXG5cdFx0RW1haWxDaGVja0JveExhYmVsOiBzdHJpbmc7XHJcblx0XHRTdWJtaXQ6IHN0cmluZztcclxuXHR9O1xyXG5cclxuXHRTaW5nbGVGb3JtOiB7XHJcblx0XHRUaXRsZTogc3RyaW5nO1xyXG5cdH07XHJcblxyXG5cdFVzZXJWb2ljZUZvcm06IHtcclxuXHRcdFRpdGxlOiBzdHJpbmc7XHJcblx0XHRUZXh0OiBzdHJpbmc7XHJcblx0XHRCdXR0b246IHN0cmluZztcclxuXHR9O1xyXG5cclxuXHRTbWlsZUZvcm06IHtcclxuXHRcdEFuY2hvcjogc3RyaW5nO1xyXG5cdFx0VGl0bGU6IHN0cmluZztcclxuXHR9O1xyXG5cclxuXHRGcm93bkZvcm06IHtcclxuXHRcdEFuY2hvcjogc3RyaW5nO1xyXG5cdFx0VGl0bGU6IHN0cmluZztcclxuXHR9O1xyXG5cclxuXHRJZGVhRm9ybToge1xyXG5cdFx0QW5jaG9yOiBzdHJpbmc7XHJcblx0XHRUaXRsZTogc3RyaW5nO1xyXG5cdH07XHJcblxyXG5cdEJ1Z0Zvcm06IHtcclxuXHRcdEFuY2hvcjogc3RyaW5nO1xyXG5cdFx0VGl0bGU6IHN0cmluZztcclxuXHR9O1xyXG5cclxuXHRGbG9vZGdhdGU6IHtcclxuXHRcdE5wczoge1xyXG5cdFx0XHRQcm9tcHQ6IHtcclxuXHRcdFx0XHRUaXRsZTogc3RyaW5nO1xyXG5cdFx0XHRcdFF1ZXN0aW9uOiBzdHJpbmc7XHJcblx0XHRcdFx0WWVzOiBzdHJpbmc7XHJcblx0XHRcdFx0Tm86IHN0cmluZztcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdENvbW1lbnQ6IHtcclxuXHRcdFx0XHRRdWVzdGlvbjogc3RyaW5nO1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0UmF0aW5nOiB7XHJcblx0XHRcdFx0UXVlc3Rpb246IHN0cmluZztcclxuXHRcdFx0XHRQb2ludHMxMVZhbHVlMDogc3RyaW5nO1xyXG5cdFx0XHRcdFBvaW50czExVmFsdWUxOiBzdHJpbmc7XHJcblx0XHRcdFx0UG9pbnRzMTFWYWx1ZTI6IHN0cmluZztcclxuXHRcdFx0XHRQb2ludHMxMVZhbHVlMzogc3RyaW5nO1xyXG5cdFx0XHRcdFBvaW50czExVmFsdWU0OiBzdHJpbmc7XHJcblx0XHRcdFx0UG9pbnRzMTFWYWx1ZTU6IHN0cmluZztcclxuXHRcdFx0XHRQb2ludHMxMVZhbHVlNjogc3RyaW5nO1xyXG5cdFx0XHRcdFBvaW50czExVmFsdWU3OiBzdHJpbmc7XHJcblx0XHRcdFx0UG9pbnRzMTFWYWx1ZTg6IHN0cmluZztcclxuXHRcdFx0XHRQb2ludHMxMVZhbHVlOTogc3RyaW5nO1xyXG5cdFx0XHRcdFBvaW50czExVmFsdWUxMDogc3RyaW5nO1xyXG5cdFx0XHRcdFBvaW50czVWYWx1ZTE6IHN0cmluZztcclxuXHRcdFx0XHRQb2ludHM1VmFsdWUyOiBzdHJpbmc7XHJcblx0XHRcdFx0UG9pbnRzNVZhbHVlMzogc3RyaW5nO1xyXG5cdFx0XHRcdFBvaW50czVWYWx1ZTQ6IHN0cmluZztcclxuXHRcdFx0XHRQb2ludHM1VmFsdWU1OiBzdHJpbmc7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHRDbG9zZUxhYmVsOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMb2NhbGl6ZWQgVUkgc3RyaW5nc1xyXG4gKi9cclxubGV0IHVJU3RyaW5nczogSVVJU3RyaW5ncztcclxuXHJcbi8qKlxyXG4gKiBTZXQgVUkgc3RyaW5nc1xyXG4gKiBAcGFyYW0ge3N0cmluZ30gZGF0YSBMaXN0IG9mIGxvY2FsaXplZCBVSSBzdHJpbmdzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0VUlTdHJpbmdzKGRhdGE6IElVSVN0cmluZ3MpIHtcclxuXHR1SVN0cmluZ3MgPSBkYXRhO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0IFVJIHN0cmluZ3NcclxuICogQHJldHVybnMgdGhlIFVJU3RyaW5nc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFVJU3RyaW5ncygpOiBJVUlTdHJpbmdzIHtcclxuXHRyZXR1cm4gdUlTdHJpbmdzO1xyXG59XHJcbiIsIi8qKlxyXG4gKiBCZWxseUJhbmQudHNcclxuICpcclxuICogTW9kdWxlIGZvciB0aGUgQmVsbHlCYW5kIFVJXHJcbiAqL1xyXG5cclxuaW1wb3J0IHtJRHMsIENsYXNzZXMsIEZlZWRiYWNrVHlwZX0gZnJvbSBcIi4vLi4vLi4vQ29uc3RhbnRzXCI7XHJcbmltcG9ydCAqIGFzIEV2ZW50cyBmcm9tIFwiLi9FdmVudHNcIjtcclxuaW1wb3J0ICogYXMgTGF5b3V0IGZyb20gXCIuL0xheW91dFwiO1xyXG5pbXBvcnQgKiBhcyBSZW5kZXJlciBmcm9tIFwiLi8uLi9SZW5kZXJlclwiO1xyXG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tIFwiLi8uLi9VdGlsc1wiO1xyXG5pbXBvcnQgKiBhcyBXaW5kb3dQcm9wZXJ0aWVzIGZyb20gXCIuLy4uLy4uL1dpbmRvd1Byb3BlcnRpZXNcIjtcclxuaW1wb3J0IHtJRm9ybVRlbXBsYXRlfSBmcm9tIFwiLi9Gb3JtVGVtcGxhdGVzL0lGb3JtVGVtcGxhdGVcIjtcclxuaW1wb3J0ICogYXMgQmFzaWNGb3JtVGVtcGxhdGUgZnJvbSBcIi4vRm9ybVRlbXBsYXRlcy9CYXNpY0Zvcm1UZW1wbGF0ZVwiO1xyXG5pbXBvcnQgKiBhcyBVc2VyVm9pY2VGb3JtVGVtcGxhdGUgZnJvbSBcIi4vRm9ybVRlbXBsYXRlcy9Vc2VyVm9pY2VGb3JtVGVtcGxhdGVcIjtcclxuaW1wb3J0ICogYXMgQ29uZmlndXJhdGlvbiBmcm9tIFwiLi8uLi8uLi9Db25maWd1cmF0aW9uL0NvbmZpZ3VyYXRpb25cIjtcclxuXHJcbmV4cG9ydCB7SVVzZXJWb2ljZUluaXRPcHRpb25zfSBmcm9tIFwiLi9Gb3JtVGVtcGxhdGVzL1VzZXJWb2ljZUZvcm1UZW1wbGF0ZVwiO1xyXG5cclxuLyoqXHJcbiAqIFVJIGluaXRpYWxpemF0aW9uIGZvciBtdWx0aSwgaW5jbHVkaW5nIGNyZWF0aW5nIGFsbCBmZWVkYmFjayByZWxhdGVkIEhUTUwgZWxlbWVudHMgYW5kIHNldHRpbmdcclxuICogaW5pdGlhbCB2aXNpYmlsaXR5IG9mIGVsZW1lbnRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTXVsdGkob25DbG9zZTogKCkgPT4gdm9pZCkge1xyXG5cdC8vIENyZWF0ZSB0aGUgZmVlZGJhY2tUeXBlIC0+IElGb3JtVGVtcGxhdGUgbWFwcGluZ1xyXG5cdGxldCBmb3JtVGVtcGxhdGVzOiB7W2tleTogbnVtYmVyXTogSUZvcm1UZW1wbGF0ZX0gPSB7fTtcclxuXHRmb3JtVGVtcGxhdGVzW0ZlZWRiYWNrVHlwZS5TbWlsZV0gPSBCYXNpY0Zvcm1UZW1wbGF0ZTtcclxuXHRmb3JtVGVtcGxhdGVzW0ZlZWRiYWNrVHlwZS5Gcm93bl0gPSBCYXNpY0Zvcm1UZW1wbGF0ZTtcclxuXHJcblx0Ly8gU2hvdyB1c2Vydm9pY2Ugb25seSBpZiBsb2NhbGUgaXMgZW5cclxuXHRpZiAoQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRJbkFwcEZlZWRiYWNrSW5pdE9wdGlvbnMoKS51c2VyVm9pY2UgJiZcclxuXHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS5sb2NhbGUgPT09IFwiZW5cIikge1xyXG5cdFx0Zm9ybVRlbXBsYXRlc1tGZWVkYmFja1R5cGUuSWRlYV0gPSBVc2VyVm9pY2VGb3JtVGVtcGxhdGU7XHJcblx0fSBlbHNlIHtcclxuXHRcdGZvcm1UZW1wbGF0ZXNbRmVlZGJhY2tUeXBlLklkZWFdID0gQmFzaWNGb3JtVGVtcGxhdGU7XHJcblx0fVxyXG5cclxuXHRpZiAoQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRJbkFwcEZlZWRiYWNrSW5pdE9wdGlvbnMoKS5idWdGb3JtKSB7XHJcblx0XHRmb3JtVGVtcGxhdGVzW0ZlZWRiYWNrVHlwZS5CdWddID0gQmFzaWNGb3JtVGVtcGxhdGU7XHJcblx0fVxyXG5cclxuXHRjcmVhdGUoUmVuZGVyZXIuZWxlbWVudEZyb21Kc29uKExheW91dC5nZW5lcmF0ZU11bHRpKGZvcm1UZW1wbGF0ZXMpKSk7XHJcblxyXG5cdGxldCB1c2VOYXJyb3dTY3JlZW5MYXlvdXQgPSBXaW5kb3dQcm9wZXJ0aWVzLmlzTmFycm93KCk7XHJcblxyXG5cdEV2ZW50cy5yZWdpc3Rlck11bHRpKFxyXG5cdFx0Zm9ybVRlbXBsYXRlcyxcclxuXHRcdHVzZU5hcnJvd1NjcmVlbkxheW91dCxcclxuXHRcdGZ1bmN0aW9uIChzdWJtaXR0ZWQ6IGJvb2xlYW4pIHtcclxuXHRcdFx0VXRpbHMuc2V0RWxlbWVudFZpc2liaWxpdHkoSURzLk92ZXJsYXlCYWNrZ3JvdW5kLCBmYWxzZSk7XHJcblx0XHRcdFV0aWxzLmRlbGV0ZUVsZW1lbnRCeUlkKElEcy5PdmVybGF5QmFja2dyb3VuZCk7XHJcblx0XHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0SW5BcHBGZWVkYmFja0luaXRPcHRpb25zKCkub25EaXNtaXNzKHN1Ym1pdHRlZCk7XHJcblx0XHRcdG9uQ2xvc2UoKTtcclxuXHRcdH1cclxuXHQpO1xyXG5cclxuXHQvLyBJZiB0aGUgc2NyZWVuIHNpemUgaXMgbmFycm93LCBhZGQgdGhlIE5hcnJvdyBjbGFzcyB0byB0aGUgb3V0ZXJtb3N0IGRpdiBzbyB0aGF0IFxyXG5cdC8vIHRoZSBDU1MgdXNlZCBjb3JyZXNwb25kcyB0byB0aGUgc21hbGwgc2NyZWVuIFVJXHJcblx0aWYgKHVzZU5hcnJvd1NjcmVlbkxheW91dCkge1xyXG5cdFx0VXRpbHMuYWRkQ2xhc3NCeUlkKElEcy5PdmVybGF5QmFja2dyb3VuZCwgQ2xhc3Nlcy5OYXJyb3dMYXlvdXQpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVJIGluaXRpYWxpemF0aW9uIGZvciBzaW5nbGUsIGluY2x1ZGluZyBjcmVhdGluZyBhbGwgZmVlZGJhY2sgcmVsYXRlZCBIVE1MIGVsZW1lbnRzIGFuZCBzZXR0aW5nXHJcbiAqIGluaXRpYWwgdmlzaWJpbGl0eSBvZiBlbGVtZW50c1xyXG4gKiBAcmV0dXJuIHt2b2lkfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNpbmdsZShvbkNsb3NlOiAoKSA9PiB2b2lkLCBmZWVkYmFja1R5cGU6IEZlZWRiYWNrVHlwZSkge1xyXG5cdGNyZWF0ZShSZW5kZXJlci5lbGVtZW50RnJvbUpzb24oTGF5b3V0LmdlbmVyYXRlU2luZ2xlKCkpKTtcclxuXHJcblx0RXZlbnRzLnJlZ2lzdGVyU2luZ2xlKFxyXG5cdFx0ZmVlZGJhY2tUeXBlLFxyXG5cdFx0ZnVuY3Rpb24gKHN1Ym1pdHRlZDogYm9vbGVhbikge1xyXG5cdFx0XHRVdGlscy5zZXRFbGVtZW50VmlzaWJpbGl0eShJRHMuT3ZlcmxheUJhY2tncm91bmQsIGZhbHNlKTtcclxuXHRcdFx0VXRpbHMuZGVsZXRlRWxlbWVudEJ5SWQoSURzLk92ZXJsYXlCYWNrZ3JvdW5kKTtcclxuXHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRJbkFwcEZlZWRiYWNrSW5pdE9wdGlvbnMoKS5vbkRpc21pc3Moc3VibWl0dGVkKTtcclxuXHRcdFx0b25DbG9zZSgpO1xyXG5cdFx0fVxyXG5cdCk7XHJcblxyXG5cdFV0aWxzLmFkZENsYXNzQnlJZChJRHMuT3ZlcmxheUJhY2tncm91bmQsIENsYXNzZXMuU2luZ2xlTGF5b3V0KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEF0dGFjaCB0aGUgVUkgZWxlbWVudCB0byB0aGUgRE9NLlxyXG4gKiBAcGFyYW0gdXNlckludGVyZmFjZSB0aGUgVUkgZWxlbWVudFxyXG4gKi9cclxuZnVuY3Rpb24gY3JlYXRlKHVzZXJJbnRlcmZhY2U6IEVsZW1lbnQpIHtcclxuXHRkb2N1bWVudC5ib2R5Lmluc2VydEJlZm9yZSh1c2VySW50ZXJmYWNlLCBkb2N1bWVudC5ib2R5LmZpcnN0Q2hpbGQpO1xyXG5cclxuXHRVdGlscy5zZXRFbGVtZW50VmlzaWJpbGl0eShJRHMuT3ZlcmxheUJhY2tncm91bmQsIHRydWUpO1xyXG5cclxuXHRpZiAoVXRpbHMuZ2V0SW50ZXJuZXRFeHBsb3JlclZlcnNpb24oKSA+IDkgfHwgVXRpbHMuZ2V0SW50ZXJuZXRFeHBsb3JlclZlcnNpb24oKSA9PT0gLTEpIHtcclxuXHRcdC8vIFNob3cgdGhlIG1haW4gZmVlZGJhY2sgVUkgYWZ0ZXIgYSBjZXJ0YWluIHRpbWUgdG8gd2FpdCBmb3IgdGhlIENTUyBrZXlmcmFtZXMgYW5pbWF0aW9uIHRvIGZpbmlzaCBpZiBcclxuXHRcdC8vIHRoZSBicm93c2VyIGlzIElFMTAgYW5kIGFib3ZlIG9yIG5vbi1JRVxyXG5cdFx0c2V0VGltZW91dChvbk1haW5Db250YWluZXJSZW5kZXIsIDkwMCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdG9uTWFpbkNvbnRhaW5lclJlbmRlcigpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENvZGUgdG8gcnVuIHdoZW4gdGhlIG1haW4gY29udGFpbmVyIGFuaW1hdGlvbiBoYXMgY29tcGxldGVkLlxyXG4gKi9cclxuZnVuY3Rpb24gb25NYWluQ29udGFpbmVyUmVuZGVyKCk6IHZvaWQge1xyXG5cdC8vIFNob3cgdGhlIE1haW5Db250ZW50SG9sZGVyIGluc2lkZSB0aGUgTWFpbkNvbnRhaW5lclxyXG5cdFV0aWxzLnNldEVsZW1lbnRWaXNpYmlsaXR5KElEcy5NYWluQ29udGVudEhvbGRlciwgdHJ1ZSk7XHJcblx0aWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKElEcy5PdmVyYWxsU21pbGVBbmNob3IpKSB7XHJcblx0XHQvLyBNdWx0aSBmZWVkYmFja1xyXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSURzLk92ZXJhbGxTbWlsZUFuY2hvcikuZm9jdXMoKTtcclxuXHR9IGVsc2UgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKElEcy5TaW5nbGVGb3JtQ29tbWVudCkpIHtcclxuXHRcdC8vIFNpbmdsZSBmZWVkYmFja1xyXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSURzLlNpbmdsZUZvcm1Db21tZW50KS5mb2N1cygpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVJIGRpc21pc3MuIERlbGV0ZSBhbGwgZmVlZGJhY2sgcmVsYXRlZCBIVE1MIGVsZW1lbnRzXHJcbiAqIEByZXR1cm4ge3ZvaWR9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZGlzbWlzcygpOiB2b2lkIHtcclxuXHRyZXR1cm47XHJcbn1cclxuIiwi77u/LyoqXHJcbiAqIEV2ZW50cy50c1xyXG4gKlxyXG4gKiBBIG1vZHVsZSBmb3IgYWxsIEV2ZW50IGhhbmRsaW5nLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFRyYW5zcG9ydGVyIH0gZnJvbSBcIi4vLi4vLi4vVHJhbnNwb3J0L1RyYW5zcG9ydFwiO1xyXG5pbXBvcnQgKiBhcyBDb25maWd1cmF0aW9uIGZyb20gXCIuLy4uLy4uL0NvbmZpZ3VyYXRpb24vQ29uZmlndXJhdGlvblwiO1xyXG5pbXBvcnQgeyBJRm9ybVRlbXBsYXRlIH0gZnJvbSBcIi4vRm9ybVRlbXBsYXRlcy9JRm9ybVRlbXBsYXRlXCI7XHJcbmltcG9ydCB7IElEcywgQ2xhc3NlcywgQXR0cmlidXRlTmFtZSwgS2V5cywgRmVlZGJhY2tUeXBlIH0gZnJvbSBcIi4vLi4vLi4vQ29uc3RhbnRzXCI7XHJcbmltcG9ydCAqIGFzIExvZ2dpbmcgZnJvbSBcIi4vLi4vLi4vTG9nZ2luZy9Mb2dnaW5nXCI7XHJcbmltcG9ydCB7IElPbkRpc21pc3NEZWxlZ2F0ZSB9IGZyb20gXCIuLy4uLy4uL0lPbkRpc21pc3NEZWxlZ2F0ZVwiO1xyXG5pbXBvcnQgKiBhcyBTY3JlZW5zaG90IGZyb20gXCIuLy4uLy4uL1NjcmVlbnNob3RcIjtcclxuaW1wb3J0IHsgU3Bpbm5lciB9IGZyb20gXCIuLy4uL1NwaW5uZXJDb250cm9sXCI7XHJcbmltcG9ydCAqIGFzIFVpVXRpbHMgZnJvbSBcIi4vLi4vVXRpbHNcIjtcclxuaW1wb3J0ICogYXMgVGFiRm9jdXMgZnJvbSBcIi4vVGFiRm9jdXNcIjtcclxuXHJcbi8qKlxyXG4gKiBXaGV0aGVyIHRvIHVzZSBuYXJyb3cgbGF5b3V0XHJcbiAqL1xyXG5sZXQgdXNlTmFycm93TGF5b3V0OiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4vKipcclxuICogQ2FsbGJhY2sgZm9yIHdoZW4gdGhlIGZlZWRiYWNrIGRpYWxvZyBpcyBkaXNtaXNzZWRcclxuICovXHJcbmxldCBvbkRpc21pc3M6IElPbkRpc21pc3NEZWxlZ2F0ZTtcclxuXHJcbi8qKlxyXG4gKiBUaGUgU2VsZWN0ZWQgZmVlZGJhY2sgdHlwZSwgdW5kZWZpbmVkIGlmIG5vbmUgc2VsZWN0ZWRcclxuICovXHJcbmxldCBzZWxlY3RlZEZlZWRiYWNrVHlwZTogRmVlZGJhY2tUeXBlID0gdW5kZWZpbmVkO1xyXG5cclxuLyoqXHJcbiAqIGZlZWRiYWNrVHlwZSAtPiBJRm9ybVRlbXBsYXRlIG1hcHBpbmcgZm9yIG11bHRpIEJlbGx5QmFuZFxyXG4gKi9cclxubGV0IGZvcm1UZW1wbGF0ZXM6IHsgW2tleTogbnVtYmVyXTogSUZvcm1UZW1wbGF0ZSB9O1xyXG5cclxuLyoqXHJcbiAqIERpc21pc3MgYWxsLCBpbmNsdWRpbmcgbmV0d29ya2luZywgVUksIGFuZCBldmVudHNcclxuICogQHBhcmFtIHN1Ym1pdHRlZCBXYXMgdGhlIGNvbnRyb2wgc3VibWl0dGVkICh0cnVlKSwgb3IgY2FuY2VsbGVkIChmYWxzZSk/XHJcbiAqL1xyXG5mdW5jdGlvbiBkaXNtaXNzQWxsKHN1Ym1pdHRlZDogYm9vbGVhbik6IHZvaWQge1xyXG5cdHVucmVnaXN0ZXIoKTtcclxuXHRvbkRpc21pc3Moc3VibWl0dGVkKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIExpc3Qgb2YgbGlzdGVuZXJzIGFuZCB0aGUgaWRzIHRoZXkgYXJlIGF0dGFjaGVkIHRvLiBUaGlzIGVuc3VyZXMgYWxsIGV2ZW50cyBhcmUgY29ycmVjdGx5IHVucmVnaXN0ZXJlZC5cclxuICovXHJcbmxldCBsaXN0ZW5lcnNMaXN0OiB7IGlkOiBzdHJpbmcsIGV2ZW50OiBzdHJpbmcsIGxpc3RlbmVyOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkIH1bXSA9IFtdO1xyXG5cclxuZnVuY3Rpb24gYWRkTGlzdGVuZXIoaWQ6IHN0cmluZywgZXZlbnQ6IHN0cmluZywgbGlzdGVuZXI6IChldmVudDogRXZlbnQpID0+IHZvaWQpOiB2b2lkIHtcclxuXHRVaVV0aWxzLnJlZ2lzdGVyTGlzdGVuZXIoaWQsIGV2ZW50LCBsaXN0ZW5lcik7XHJcblx0bGlzdGVuZXJzTGlzdC5wdXNoKHsgZXZlbnQ6IGV2ZW50LCBpZDogaWQsIGxpc3RlbmVyOiBsaXN0ZW5lciB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXJzKCk6IHZvaWQge1xyXG5cdGZvciAobGV0IGxpc3RlbmVyIG9mIGxpc3RlbmVyc0xpc3QpIHtcclxuXHRcdFVpVXRpbHMudW5yZWdpc3Rlckxpc3RlbmVyKGxpc3RlbmVyLmlkLCBsaXN0ZW5lci5ldmVudCwgbGlzdGVuZXIubGlzdGVuZXIpO1xyXG5cdH1cclxuXHRsaXN0ZW5lcnNMaXN0ID0gW107XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZWdpc3RlciBldmVudHMgZm9yIHNpbmdsZSBiZWxseSBiYW5kXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJTaW5nbGUoZmVlZGJhY2tUeXBlOiBGZWVkYmFja1R5cGUsXHJcblx0T05fRElTTUlTUzogSU9uRGlzbWlzc0RlbGVnYXRlID0gZnVuY3Rpb24gKHN1Ym1pdHRlZDogYm9vbGVhbikgeyByZXR1cm47IH0pIHtcclxuXHRzZWxlY3RlZEZlZWRiYWNrVHlwZSA9IGZlZWRiYWNrVHlwZTtcclxuXHJcblx0Ly8gU2luZ2xlRm9ybVRlbXBsYXRlIGV2ZW50c1xyXG5cdGFkZExpc3RlbmVyKElEcy5TaW5nbGVGb3JtU3VibWl0QnV0dG9uLCBcImNsaWNrXCIsIHN1Ym1pdEJ1dHRvbkhhbmRsZXJGYWN0b3J5KElEcy5TaW5nbGVGb3JtU3VibWl0QnV0dG9uLFxyXG5cdFx0SURzLlNpbmdsZUZvcm1TdWJtaXRCdXR0b25TcGlubmVyLCBJRHMuU2luZ2xlRm9ybUNvbW1lbnQsIElEcy5TaW5nbGVGb3JtRW1haWxJbnB1dCxcclxuXHRcdElEcy5TaW5nbGVGb3JtU2NyZWVuc2hvdENoZWNrYm94LCBJRHMuU2luZ2xlRm9ybUNhdGVnb3JpZXNEcm9wZG93bikpO1xyXG5cclxuXHRyZWdpc3RlckNvbW1vbihPTl9ESVNNSVNTKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlZ2lzdGVyIGV2ZW50cyBmb3IgbXVsdGkgYmVsbHkgYmFuZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyTXVsdGkoRk9STVRFTVBMQVRFUzogeyBba2V5OiBudW1iZXJdOiBJRm9ybVRlbXBsYXRlIH0sXHJcblx0VVNFX05BUlJPV19MQVlPVVQ6IGJvb2xlYW4sXHJcblx0T05fRElTTUlTUzogSU9uRGlzbWlzc0RlbGVnYXRlID0gZnVuY3Rpb24gKHN1Ym1pdHRlZDogYm9vbGVhbikgeyByZXR1cm47IH0pIHtcclxuXHR1c2VOYXJyb3dMYXlvdXQgPSBVU0VfTkFSUk9XX0xBWU9VVDtcclxuXHRmb3JtVGVtcGxhdGVzID0gRk9STVRFTVBMQVRFUztcclxuXHJcblx0YWRkTGlzdGVuZXIoSURzLk92ZXJhbGxTbWlsZUFuY2hvciwgXCJjbGlja1wiLCBvdmVyYWxsU21pbGVIYW5kbGVyKTtcclxuXHRhZGRMaXN0ZW5lcihJRHMuT3ZlcmFsbEZyb3duQW5jaG9yLCBcImNsaWNrXCIsIG92ZXJhbGxGcm93bkhhbmRsZXIpO1xyXG5cdGFkZExpc3RlbmVyKElEcy5PdmVyYWxsSWRlYUFuY2hvciwgXCJjbGlja1wiLCBvdmVyYWxsSWRlYUhhbmRsZXIpO1xyXG5cdGFkZExpc3RlbmVyKElEcy5PdmVyYWxsQnVnQW5jaG9yLCBcImNsaWNrXCIsIG92ZXJhbGxCdWdIYW5kbGVyKTtcclxuXHJcblx0Ly8gQmFzaWNGb3JtVGVtcGxhdGUgZXZlbnRzXHJcblx0YWRkTGlzdGVuZXIoSURzLkJhc2ljRm9ybVN1Ym1pdEJ1dHRvbiwgXCJjbGlja1wiLCBzdWJtaXRCdXR0b25IYW5kbGVyRmFjdG9yeShJRHMuQmFzaWNGb3JtU3VibWl0QnV0dG9uLFxyXG5cdFx0SURzLkJhc2ljRm9ybVN1Ym1pdEJ1dHRvblNwaW5uZXIsIElEcy5CYXNpY0Zvcm1Db21tZW50LCBJRHMuQmFzaWNGb3JtRW1haWxJbnB1dCxcclxuXHRcdElEcy5CYXNpY0Zvcm1TY3JlZW5zaG90Q2hlY2tib3gsIElEcy5CYXNpY0Zvcm1DYXRlZ29yaWVzRHJvcGRvd24pKTtcclxuXHJcblx0Ly8gVXNlclZvaWNlRm9ybVRlbXBsYXRlIGV2ZW50c1xyXG5cdGFkZExpc3RlbmVyKElEcy5Vc2VyVm9pY2VGb3JtR29CdXR0b24sIFwiY2xpY2tcIiwgVXNlclZvaWNlRm9ybUdvQnV0dG9uSGFuZGxlcik7XHJcblxyXG5cdHJlZ2lzdGVyQ29tbW9uKE9OX0RJU01JU1MpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZWdpc3RlckNvbW1vbihPTl9ESVNNSVNTOiBJT25EaXNtaXNzRGVsZWdhdGUpOiB2b2lkIHtcclxuXHRvbkRpc21pc3MgPSBPTl9ESVNNSVNTO1xyXG5cclxuXHRVaVV0aWxzLmFkZEV2ZW50TGlzdGVuZXJIZWxwZXIod2luZG93LCBcImtleXVwXCIsIGtleUV2ZW50SGFuZGxlcik7XHJcblxyXG5cdGFkZExpc3RlbmVyKElEcy5PdmVybGF5QmFja2dyb3VuZCwgXCJjbGlja1wiLCBvdmVybGF5QmFja2dyb3VuZEhhbmRsZXIpO1xyXG5cdGFkZExpc3RlbmVyKElEcy5NYWluQ29udGFpbmVyLCBcImNsaWNrXCIsIG1haW5Db250YWluZXJIYW5kbGVyKTtcclxuXHRhZGRMaXN0ZW5lcihJRHMuTWFpbkNvbnRhaW5lciwgXCJrZXl1cFwiLCB0YWJLZXlFdmVudEhhbmRsZXIpO1xyXG5cdGFkZExpc3RlbmVyKElEcy5Qcml2YWN5U3RhdGVtZW50TGluaywgXCJjbGlja1wiLCBwcml2YWN5U3RhdGVtZW50TGlua0hhbmRsZXIpO1xyXG59XHJcblxyXG4vKipcclxuICogTGlzdGVuZXIgdW4tcmVnaXN0cmF0aW9uXHJcbiAqL1xyXG5mdW5jdGlvbiB1bnJlZ2lzdGVyKCk6IHZvaWQge1xyXG5cdFVpVXRpbHMucmVtb3ZlRXZlbnRMaXN0ZW5lckhlbHBlcih3aW5kb3csIFwia2V5dXBcIiwga2V5RXZlbnRIYW5kbGVyKTtcclxuXHRyZW1vdmVMaXN0ZW5lcnMoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRhYiBrZXkgZXZlbnQgaGFuZGxlclxyXG4gKiBAcGFyYW0gZXZlbnQgVGhlIEV2ZW50IG9iamVjdFxyXG4gKi9cclxuZnVuY3Rpb24gdGFiS2V5RXZlbnRIYW5kbGVyKGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG5cdGxldCBrZXlDb2RlID0gKDxLZXlib2FyZEV2ZW50PiBldmVudCkua2V5Q29kZSB8fCAoPEtleWJvYXJkRXZlbnQ+IGV2ZW50KS53aGljaDtcclxuXHJcblx0aWYgKGtleUNvZGUgPT09IEtleXMuVGFiKSB7XHJcblx0XHRpZiAoKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuaWQgPT09IElEcy5GaXJzdFRhYmJhYmxlICYmICg8S2V5Ym9hcmRFdmVudD4gZXZlbnQpLnNoaWZ0S2V5KSB8fFxyXG5cdFx0XHQoZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5pZCA9PT0gSURzLkxhc3RUYWJiYWJsZSAmJiAhKDxLZXlib2FyZEV2ZW50PiBldmVudCkuc2hpZnRLZXkpKSB7XHJcblx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cdFx0XHRUYWJGb2N1cy5jeWNsZVRhYkZvY3VzKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEtleSBldmVudCBoYW5kbGVyXHJcbiAqIEBwYXJhbSBldmVudCBUaGUgRXZlbnQgb2JqZWN0XHJcbiAqL1xyXG5mdW5jdGlvbiBrZXlFdmVudEhhbmRsZXIoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcblx0Ly8gZGlzbWlzcyBmZWVkYmFjayB1cG9uIHByZXNzaW5nIHRoZSBlc2NhcGUga2V5XHJcblx0aWYgKCg8S2V5Ym9hcmRFdmVudD4gZXZlbnQpLmtleUNvZGUgPT09IEtleXMuRXNjKSB7XHJcblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdFx0ZGlzbWlzc0FsbChmYWxzZSAvKnN1Ym1pdHRlZCovKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPdmVybGF5IGJhY2tncm91bmQgZXZlbnQgaGFuZGxlci4gRGlzbWlzcyBmZWVkYmFjayB1cG9uIGNsaWNraW5nIG9uIHRoZSBiYWNrZ3JvdW5kIGFyZWFcclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIG92ZXJsYXlCYWNrZ3JvdW5kSGFuZGxlcihldmVudDogRXZlbnQpOiB2b2lkIHtcclxuXHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuXHRkaXNtaXNzQWxsKGZhbHNlIC8qc3VibWl0dGVkKi8pO1xyXG59XHJcblxyXG4vKipcclxuICogTWFpbiBjb250YWluZXIgZXZlbnQgaGFuZGxlci4gV2hlbiBjbGlja2luZyBvbiBtYWluIGNvbnRhaW5lciBhcmVhLCBkbyBub3QgcHJvcGFnYXRlIHRoZSBldmVudCB0byBsb3dlciBsZXZlbC5cclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIG1haW5Db250YWluZXJIYW5kbGVyKGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG5cdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG59XHJcblxyXG4vKipcclxuICogUHJpdmFjeSBzdGF0ZW1lbnQgbGluayBoYW5kbGVyLiBXaGVuIGNsaWNraW5nIG9uIHRoZSBwcml2YWN5IHN0YXRlbWVudCBsaW5rLFxyXG4gKiBkbyBub3QgcHJvcGFnYXRlIHRoZSBldmVudCB0byBsb3dlciBsZXZlbC5cclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIHByaXZhY3lTdGF0ZW1lbnRMaW5rSGFuZGxlcihldmVudDogRXZlbnQpOiB2b2lkIHtcclxuXHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIE92ZXJhbGwgYnV0dG9uIGNsaWNrIGhhbmRsZXJcclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICogQHBhcmFtIGFjaG9ySWQgVGhlIGlkIG9mIHRoZSBhbmNob3IgaHRtbCBlbGVtZW50IHdoaWNoIHdhcyBzZWxlY3RlZFxyXG4gKi9cclxuZnVuY3Rpb24gb3ZlcmFsbEhhbmRsZXIoZXZlbnQ6IEV2ZW50LCBhbmNob3JJZDogc3RyaW5nKTogdm9pZCB7XHJcblx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcblx0VWlVdGlscy5yZXBsYWNlQ2xhc3Nlc0J5SWQoSURzLk92ZXJhbGxTbWlsZUFuY2hvciwgQ2xhc3Nlcy5PdmVyYWxsQW5jaG9yQWN0aXZlKTtcclxuXHRVaVV0aWxzLnJlcGxhY2VDbGFzc2VzQnlJZChJRHMuT3ZlcmFsbEZyb3duQW5jaG9yLCBDbGFzc2VzLk92ZXJhbGxBbmNob3JBY3RpdmUpO1xyXG5cdFVpVXRpbHMucmVwbGFjZUNsYXNzZXNCeUlkKElEcy5PdmVyYWxsSWRlYUFuY2hvciwgQ2xhc3Nlcy5PdmVyYWxsQW5jaG9yQWN0aXZlKTtcclxuXHRVaVV0aWxzLnJlcGxhY2VDbGFzc2VzQnlJZChJRHMuT3ZlcmFsbEJ1Z0FuY2hvciwgQ2xhc3Nlcy5PdmVyYWxsQW5jaG9yQWN0aXZlKTtcclxuXHJcblx0VWlVdGlscy5hZGRDbGFzc0J5SWQoYW5jaG9ySWQsIENsYXNzZXMuT3ZlcmFsbEFuY2hvckFjdGl2ZSk7XHJcblxyXG5cdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5JbkFwcC5VSS5Gb3JtLlNob3duLlZBTFVFLCB7IEZlZWRiYWNrVHlwZTogc2VsZWN0ZWRGZWVkYmFja1R5cGUgfSk7XHJcblxyXG5cdGxldCBmb3JtVGVtcGxhdGU6IElGb3JtVGVtcGxhdGUgPSBmb3JtVGVtcGxhdGVzW3NlbGVjdGVkRmVlZGJhY2tUeXBlXTtcclxuXHJcblx0bWFpbkNvbnRlbnRIb2xkZXJTbGlkZUxlZnQoZm9ybVRlbXBsYXRlLmNvbnRhaW5lcklkKTtcclxuXHRmb3JtVGVtcGxhdGUub25TZWxlY3Qoc2VsZWN0ZWRGZWVkYmFja1R5cGUpO1xyXG59XHJcblxyXG4vKipcclxuICogU21pbGUgYnV0dG9uIGV2ZW50IGhhbmRsZXJcclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIG92ZXJhbGxTbWlsZUhhbmRsZXIoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcblx0c2VsZWN0ZWRGZWVkYmFja1R5cGUgPSBGZWVkYmFja1R5cGUuU21pbGU7XHJcblx0b3ZlcmFsbEhhbmRsZXIoZXZlbnQsIElEcy5PdmVyYWxsU21pbGVBbmNob3IpO1xyXG59XHJcblxyXG4vKipcclxuICogRnJvd24gYnV0dG9uIGV2ZW50IGhhbmRsZXJcclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIG92ZXJhbGxGcm93bkhhbmRsZXIoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcblx0c2VsZWN0ZWRGZWVkYmFja1R5cGUgPSBGZWVkYmFja1R5cGUuRnJvd247XHJcblx0b3ZlcmFsbEhhbmRsZXIoZXZlbnQsIElEcy5PdmVyYWxsRnJvd25BbmNob3IpO1xyXG59XHJcblxyXG4vKipcclxuICogSWRlYSBidXR0b24gZXZlbnQgaGFuZGxlclxyXG4gKiBAcGFyYW0gZXZlbnQgVGhlIEV2ZW50IG9iamVjdFxyXG4gKi9cclxuZnVuY3Rpb24gb3ZlcmFsbElkZWFIYW5kbGVyKGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG5cdHNlbGVjdGVkRmVlZGJhY2tUeXBlID0gRmVlZGJhY2tUeXBlLklkZWE7XHJcblx0b3ZlcmFsbEhhbmRsZXIoZXZlbnQsIElEcy5PdmVyYWxsSWRlYUFuY2hvcik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBCdWcgYnV0dG9uIGV2ZW50IGhhbmRsZXJcclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIG92ZXJhbGxCdWdIYW5kbGVyKGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG5cdHNlbGVjdGVkRmVlZGJhY2tUeXBlID0gRmVlZGJhY2tUeXBlLkJ1ZztcclxuXHRvdmVyYWxsSGFuZGxlcihldmVudCwgSURzLk92ZXJhbGxCdWdBbmNob3IpO1xyXG59XHJcblxyXG4vKipcclxuICogTWFpbiBjb250ZW50IGhvbGRlciBzbGlkZSBsZWZ0IGFuaW1hdGlvblxyXG4gKiBAcGFyYW0ge3N0cmluZ30gY29udGFpbmVySWQgVGhlIGlkIG9mIHRoZSBjb250YWluZXIgdG8gYmUgbWFkZSB2aXNpYmxlXHJcbiAqIEByZXR1cm4ge3ZvaWR9XHJcbiAqL1xyXG5mdW5jdGlvbiBtYWluQ29udGVudEhvbGRlclNsaWRlTGVmdChjb250YWluZXJJZDogc3RyaW5nKTogdm9pZCB7XHJcblx0Zm9yIChsZXQgZmVlZGJhY2tUeXBlIGluIGZvcm1UZW1wbGF0ZXMpIHtcclxuXHRcdGlmIChmb3JtVGVtcGxhdGVzLmhhc093blByb3BlcnR5KGZlZWRiYWNrVHlwZSkpIHtcclxuXHRcdFx0VWlVdGlscy5zZXRFbGVtZW50VmlzaWJpbGl0eShmb3JtVGVtcGxhdGVzW2ZlZWRiYWNrVHlwZV0uY29udGFpbmVySWQsIGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlmICh1c2VOYXJyb3dMYXlvdXQpIHtcclxuXHRcdFVpVXRpbHMuc2V0RWxlbWVudFZpc2liaWxpdHkoSURzLkxlZnRGb3JtQ29udGFpbmVyLCBmYWxzZSk7XHJcblx0XHRVaVV0aWxzLnNldEVsZW1lbnRWaXNpYmlsaXR5KElEcy5NaWRkbGVGb3JtQ29udGFpbmVyLCB0cnVlKTtcclxuXHRcdFVpVXRpbHMuc2V0RWxlbWVudFZpc2liaWxpdHkoY29udGFpbmVySWQsIHRydWUpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRVaVV0aWxzLmFkZENsYXNzQnlJZChJRHMuQ29sdW1uU2VwYXJhdG9yRGl2LCBDbGFzc2VzLlNob3dSaWdodEJvcmRlcik7XHJcblx0XHRVaVV0aWxzLnNldEVsZW1lbnRWaXNpYmlsaXR5KElEcy5NaWRkbGVGb3JtQ29udGFpbmVyLCB0cnVlKTtcclxuXHRcdFVpVXRpbHMuc2V0RWxlbWVudFZpc2liaWxpdHkoY29udGFpbmVySWQsIHRydWUpO1xyXG5cdFx0VWlVdGlscy5hZGRDbGFzc0J5SWQoSURzLkxlZnRGb3JtQ29udGFpbmVyLCBDbGFzc2VzLlNsaWRlTGVmdCk7XHJcblx0XHRVaVV0aWxzLmFkZENsYXNzQnlJZChJRHMuTWlkZGxlRm9ybUNvbnRhaW5lciwgQ2xhc3Nlcy5TbGlkZUxlZnQpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFN1Ym1pdCBidXR0b24gZXZlbnQgaGFuZGxlciBmYWN0b3J5XHJcbiAqIEBwYXJhbSBldmVudCBUaGUgRXZlbnQgb2JqZWN0XHJcbiAqL1xyXG5mdW5jdGlvbiBzdWJtaXRCdXR0b25IYW5kbGVyRmFjdG9yeShzdWJtaXRCdXR0b25JZDogc3RyaW5nLCBzcGlubmVySWQ6IHN0cmluZywgY29tbWVudElucHV0SWQ6IHN0cmluZyxcclxuXHRlbWFpbElucHV0SWQ6IHN0cmluZywgc2NyZWVuc2hvdENoZWNrYm94SWQ6IHN0cmluZywgY2F0ZWdvcmllc0Ryb3Bkb3duSWQ6IHN0cmluZyk6IChldmVudDogRXZlbnQpID0+IHZvaWQge1xyXG5cdHJldHVybiBmdW5jdGlvbiAoZXZlbnQ6IEV2ZW50KSB7XHJcblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdFx0VWlVdGlscy5zZXRFbGVtZW50VmlzaWJpbGl0eShzdWJtaXRCdXR0b25JZCwgZmFsc2UpO1xyXG5cdFx0bGV0IHNwaW5uZXIgPSBuZXcgU3Bpbm5lcihzcGlubmVySWQpO1xyXG5cclxuXHRcdGxldCB0cmFuc3BvcnRlcjogVHJhbnNwb3J0ZXIgPSBuZXcgVHJhbnNwb3J0ZXIoXHJcblx0XHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS5lbnZpcm9ubWVudCxcclxuXHRcdFx0XCJTYXNcIixcclxuXHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRDb21tb25Jbml0T3B0aW9ucygpLmFwcElkLFxyXG5cdFx0XHRzZWxlY3RlZEZlZWRiYWNrVHlwZSxcclxuXHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRDb21tb25Jbml0T3B0aW9ucygpLmFwcGxpY2F0aW9uR3JvdXAsXHJcblx0XHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS50ZWxlbWV0cnlHcm91cCxcclxuXHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRDb21tb25Jbml0T3B0aW9ucygpLndlYkdyb3VwLFxyXG5cdFx0KTtcclxuXHJcblx0XHRsZXQgY29tbWVudEVsZW1lbnQ6IEhUTUxUZXh0QXJlYUVsZW1lbnQgPSA8SFRNTFRleHRBcmVhRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29tbWVudElucHV0SWQpO1xyXG5cdFx0bGV0IGNvbW1lbnRFbnRlcmVkOiBib29sZWFuID0gKGNvbW1lbnRFbGVtZW50ICYmICEhY29tbWVudEVsZW1lbnQudmFsdWUpO1xyXG5cdFx0aWYgKGNvbW1lbnRFbnRlcmVkKSB7XHJcblx0XHRcdHRyYW5zcG9ydGVyLnNldENvbW1lbnQoY29tbWVudEVsZW1lbnQudmFsdWUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBlbWFpbEVsZW1lbnQ6IEhUTUxUZXh0QXJlYUVsZW1lbnQgPSA8SFRNTFRleHRBcmVhRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZW1haWxJbnB1dElkKTtcclxuXHRcdGxldCBpc0VtYWlsSW5jbHVkZWQ6IGJvb2xlYW4gPSAoZW1haWxFbGVtZW50ICYmICEhZW1haWxFbGVtZW50LnZhbHVlKTtcclxuXHRcdGlmIChpc0VtYWlsSW5jbHVkZWQpIHtcclxuXHRcdFx0dHJhbnNwb3J0ZXIuc2V0RW1haWwoZW1haWxFbGVtZW50LnZhbHVlKTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgc2NyZWVuc2hvdENoZWNrQm94ID0gPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNjcmVlbnNob3RDaGVja2JveElkKTtcclxuXHRcdGxldCBzY3JlZW5zaG90Q2hlY2tCb3hTZWxlY3RlZDogYm9vbGVhbiA9IHNjcmVlbnNob3RDaGVja0JveCAmJiBzY3JlZW5zaG90Q2hlY2tCb3guY2hlY2tlZDtcclxuXHJcblx0XHRsZXQgY2F0ZWdvcnlFbGVtZW50OiBIVE1MU2VsZWN0RWxlbWVudCA9IDxIVE1MU2VsZWN0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2F0ZWdvcmllc0Ryb3Bkb3duSWQpO1xyXG5cdFx0bGV0IGlzQ2F0ZWdvcnlTZWxlY3RlZDogYm9vbGVhbiA9IChjYXRlZ29yeUVsZW1lbnQgJiYgY2F0ZWdvcnlFbGVtZW50LnNlbGVjdGVkSW5kZXggPiAwKTtcclxuXHRcdGlmIChpc0NhdGVnb3J5U2VsZWN0ZWQpIHtcclxuXHRcdFx0dHJhbnNwb3J0ZXIuc2V0Q2F0ZWdvcnkoY2F0ZWdvcnlFbGVtZW50LnZhbHVlKTtcclxuXHRcdH1cclxuXHJcblx0XHRMb2dnaW5nLmdldExvZ2dlcigpLmxvZ0V2ZW50KExvZ2dpbmcuRXZlbnRJZHMuSW5BcHAuVUkuRm9ybS5TdWJtaXQuVkFMVUUsXHJcblx0XHRcdHtcclxuXHRcdFx0XHRGZWVkYmFja1R5cGU6IHNlbGVjdGVkRmVlZGJhY2tUeXBlLFxyXG5cdFx0XHRcdElzRW1haWxJbmNsdWRlZDogaXNFbWFpbEluY2x1ZGVkLFxyXG5cdFx0XHRcdElzU2NyZWVuc2hvdEluY2x1ZGVkOiBzY3JlZW5zaG90Q2hlY2tCb3hTZWxlY3RlZCxcclxuXHRcdFx0fVxyXG5cdFx0KTtcclxuXHJcblx0XHRpZiAoc2NyZWVuc2hvdENoZWNrQm94U2VsZWN0ZWQpIHtcclxuXHRcdFx0bGV0IHN0YXJ0VGltZTogbnVtYmVyID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcblx0XHRcdFNjcmVlbnNob3QuY3JlYXRlU2NyZWVuU2hvdCgpLnRoZW4oXHJcblx0XHRcdFx0KGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpID0+IHtcclxuXHRcdFx0XHRcdGxldCBlbmRUaW1lOiBudW1iZXIgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuXHRcdFx0XHRcdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5TaGFyZWQuU2NyZWVuc2hvdC5SZW5kZXIuU3VjY2Vzcy5WQUxVRSxcclxuXHRcdFx0XHRcdFx0eyBUaW1lTWlsbGlzZWNvbmRzOiBlbmRUaW1lIC0gc3RhcnRUaW1lIH0pO1xyXG5cdFx0XHRcdFx0dHJhbnNwb3J0ZXIuc2V0U2NyZWVuc2hvdChjYW52YXMpO1xyXG5cdFx0XHRcdFx0dHJhbnNwb3J0ZXIuc3VibWl0KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHQpLmNhdGNoKChlcnJvcjogYW55KSA9PiB7XHJcblx0XHRcdFx0bGV0IGVuZFRpbWU6IG51bWJlciA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG5cdFx0XHRcdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5TaGFyZWQuU2NyZWVuc2hvdC5SZW5kZXIuRmFpbGVkLlZBTFVFLFxyXG5cdFx0XHRcdFx0eyBFcnJvck1lc3NhZ2U6IGVycm9yLCBUaW1lTWlsbGlzZWNvbmRzOiBlbmRUaW1lIC0gc3RhcnRUaW1lIH0pO1xyXG5cdFx0XHRcdHRyYW5zcG9ydGVyLnN1Ym1pdCgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRyYW5zcG9ydGVyLnN1Ym1pdCgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHNwaW5uZXIuZGVzdHJveSgpO1xyXG5cdFx0ZGlzbWlzc0FsbCh0cnVlIC8qc3VibWl0dGVkKi8pO1xyXG5cdH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVc2VyVm9pY2VGb3JtIEdvIGJ1dHRvbiBldmVudCBoYW5kbGVyXHJcbiAqIE9wZW5zIFVzZXJWb2ljZSBmb3J1bSBpbiBhIG5ldyB3aW5kb3dcclxuICogQHBhcmFtIGV2ZW50IFRoZSBFdmVudCBvYmplY3RcclxuICovXHJcbmZ1bmN0aW9uIFVzZXJWb2ljZUZvcm1Hb0J1dHRvbkhhbmRsZXIoZXZlbnQ6IEV2ZW50KTogdm9pZCB7XHJcblx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcblx0d2luZG93Lm9wZW4oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSURzLlVzZXJWb2ljZUZvcm1Hb0J1dHRvbikuZ2V0QXR0cmlidXRlKEF0dHJpYnV0ZU5hbWUuU291cmNlKSk7XHJcblx0ZGlzbWlzc0FsbChmYWxzZSAvKiBzdWJtaXR0ZWQgKi8pO1xyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBCYXNpY0Zvcm1UZW1wbGF0ZS50c1xyXG4gKlxyXG4gKiBBIGZvcm0gdGVtcGxhdGUgd2l0aCBjb250YWN0IGluZm8gZmllbGRzLlxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIFVJU3RyaW5ncyBmcm9tIFwiLi8uLi8uLi8uLi9VSVN0cmluZ3MvVUlTdHJpbmdzXCI7XHJcbmltcG9ydCB7Rm9ybVRlbXBsYXRlVHlwZX0gZnJvbSBcIi4vRm9ybVRlbXBsYXRlVHlwZVwiO1xyXG5pbXBvcnQge0lVSUFzSnNvbn0gZnJvbSBcIi4vLi4vLi4vUmVuZGVyZXJcIjtcclxuaW1wb3J0ICogYXMgQ2F0ZWdvcmllc0Ryb3Bkb3duIGZyb20gXCIuLy4uLy4uL0NhdGVnb3JpZXNEcm9wZG93blwiO1xyXG5pbXBvcnQgKiBhcyBSYXRpbmdDb250cm9sIGZyb20gXCIuLy4uLy4uL1JhdGluZ0NvbnRyb2xcIjtcclxuaW1wb3J0ICogYXMgQ29uc3RhbnRzIGZyb20gXCIuLy4uLy4uLy4uL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgKiBhcyBDb25maWd1cmF0aW9uIGZyb20gXCIuLy4uLy4uLy4uL0NvbmZpZ3VyYXRpb24vQ29uZmlndXJhdGlvblwiO1xyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlIHRoZSBtYXJrdXBcclxuICogQHJldHVybnMgdGhlIG1hcmt1cCBhcyBqc29uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGUoKTogSVVJQXNKc29uIHtcclxuXHRsZXQgY2F0ZWdvcmllcyA9IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0SW5BcHBGZWVkYmFja0xhdW5jaE9wdGlvbnMoKS5jYXRlZ29yaWVzO1xyXG5cclxuXHRsZXQgZm9ybVNjaGVtYSA9IHtcclxuXHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbeyBuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5Gb3IsIHZhbHVlOiBDb25zdGFudHMuSURzLkJhc2ljRm9ybUNvbW1lbnR9XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbXHJcblx0XHRcdFx0XHRDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3VidGl0bGUsXHJcblx0XHRcdFx0XHRDb25zdGFudHMuQ2xhc3Nlcy5UZXh0QWxpZ25MZWZ0LFxyXG5cdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuRm9ybVF1ZXN0aW9uTWlkZGxlVGV4dCxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGlkOiBDb25zdGFudHMuSURzLkJhc2ljRm9ybVF1ZXN0aW9uTWlkZGxlVGV4dCxcclxuXHRcdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLkxhYmVsLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuSWQsIHZhbHVlOiBDb25zdGFudHMuSURzLkJhc2ljRm9ybUNhdGVnb3JpZXNEcm9wZG93biB9XSxcclxuXHRcdFx0XHRicnM6IGNhdGVnb3JpZXMuc2hvdyxcclxuXHRcdFx0XHRjaGlsZHJlbjogQ2F0ZWdvcmllc0Ryb3Bkb3duLmdlbmVyYXRlKGNhdGVnb3JpZXMgPyBjYXRlZ29yaWVzLmN1c3RvbUNhdGVnb3JpZXMgOiBudWxsKSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHQsIENvbnN0YW50cy5DbGFzc2VzLkZvcm1DYXRlZ29yaWVzRHJvcGRvd24sIENvbnN0YW50cy5DbGFzc2VzLlRleHRJbnB1dF0sXHJcblx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5TZWxlY3QsXHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlBsYWNlaG9sZGVyLFxyXG5cdFx0XHRcdFx0XHR2YWx1ZTogVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLkZvcm0uQ29tbWVudFBsYWNlaG9sZGVyLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTWF4TGVuZ3RoLFxyXG5cdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLkF0dHJpYnV0ZVZhbHVlLlRleHRBcmVhTWF4TGVuZ3RoLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3ViVGV4dCwgQ29uc3RhbnRzLkNsYXNzZXMuRm9ybUNvbW1lbnQsIENvbnN0YW50cy5DbGFzc2VzLlRleHRJbnB1dF0sXHJcblx0XHRcdFx0aWQ6IENvbnN0YW50cy5JRHMuQmFzaWNGb3JtQ29tbWVudCxcclxuXHRcdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLlRleHRBcmVhLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0YnJzOiBmYWxzZSwgLy8gZGlzYWJsZSByYXRpbmcgZm9yIG5vd1xyXG5cdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLkZvciwgdmFsdWU6IENvbnN0YW50cy5JRHMuQmFzaWNGb3JtUmF0aW5nIH1dLFxyXG5cdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFRleHQsIENvbnN0YW50cy5DbGFzc2VzLlRleHRBbGlnbkxlZnQsIENvbnN0YW50cy5DbGFzc2VzLkZvcm1SYXRpbmdMYWJlbF0sXHJcblx0XHRcdFx0XHRcdGlubmVyVGV4dDogVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLkZvcm0uUmF0aW5nTGFiZWwsXHJcblx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuTGFiZWwsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0UmF0aW5nQ29udHJvbC5nZW5lcmF0ZShDb25zdGFudHMuSURzLkJhc2ljRm9ybVJhdGluZyksXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9ybVJhdGluZ0NvbnRhaW5lcl0sXHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlR5cGUsXHJcblx0XHRcdFx0XHRcdHZhbHVlOiBDb25zdGFudHMuQXR0cmlidXRlVmFsdWUuVGV4dCxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlBsYWNlaG9sZGVyLFxyXG5cdFx0XHRcdFx0XHR2YWx1ZTogVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLkZvcm0uRW1haWxQbGFjZWhvbGRlcixcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLkFyaWFMYWJlbCxcclxuXHRcdFx0XHRcdFx0dmFsdWU6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLkVtYWlsUGxhY2Vob2xkZXIsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5OYW1lLFxyXG5cdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLklEcy5CYXNpY0Zvcm1FbWFpbElucHV0LFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTWF4TGVuZ3RoLFxyXG5cdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLkF0dHJpYnV0ZVZhbHVlLlRleHRBcmVhTWF4TGVuZ3RoLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmFsdWUsXHJcblx0XHRcdFx0XHRcdHZhbHVlOlxyXG5cdFx0XHRcdFx0XHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0SW5BcHBGZWVkYmFja0luaXRPcHRpb25zKCkudXNlckVtYWlsXHJcblx0XHRcdFx0XHRcdFx0PyBDb25maWd1cmF0aW9uLmdldCgpLmdldEluQXBwRmVlZGJhY2tJbml0T3B0aW9ucygpLnVzZXJFbWFpbFxyXG5cdFx0XHRcdFx0XHRcdDogXCJcIixcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHQsIENvbnN0YW50cy5DbGFzc2VzLkZvcm1FbWFpbElucHV0LCBDb25zdGFudHMuQ2xhc3Nlcy5UZXh0SW5wdXRdLFxyXG5cdFx0XHRcdGlkOiBDb25zdGFudHMuSURzLkJhc2ljRm9ybUVtYWlsSW5wdXQsXHJcblx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5JbnB1dCxcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVHlwZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLkF0dHJpYnV0ZVZhbHVlLkNoZWNrYm94LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmFsdWUsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWU6IENvbnN0YW50cy5BdHRyaWJ1dGVWYWx1ZS5VbmNoZWNrZWQsXHJcblx0XHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdFx0XHRcdFx0YnJzOiBDb25maWd1cmF0aW9uLmdldCgpLmdldEluQXBwRmVlZGJhY2tJbml0T3B0aW9ucygpLnNjcmVlbnNob3QsXHJcblx0XHRcdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9ybVNjcmVlbnNob3RDaGVja2JveCwgQ29uc3RhbnRzLkNsYXNzZXMuQ2hlY2tCb3hdLFxyXG5cdFx0XHRcdFx0XHRcdFx0aWQ6IENvbnN0YW50cy5JRHMuQmFzaWNGb3JtU2NyZWVuc2hvdENoZWNrYm94LFxyXG5cdFx0XHRcdFx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5JbnB1dCxcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLkZvciwgdmFsdWU6IENvbnN0YW50cy5JRHMuQmFzaWNGb3JtU2NyZWVuc2hvdENoZWNrYm94IH1dLFxyXG5cdFx0XHRcdFx0XHRcdFx0YnJzOiBDb25maWd1cmF0aW9uLmdldCgpLmdldEluQXBwRmVlZGJhY2tJbml0T3B0aW9ucygpLnNjcmVlbnNob3QsXHJcblx0XHRcdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFRleHQsIENvbnN0YW50cy5DbGFzc2VzLlRleHRBbGlnbkxlZnQsIENvbnN0YW50cy5DbGFzc2VzLkZvcm1TY3JlZW5zaG90TGFiZWxdLFxyXG5cdFx0XHRcdFx0XHRcdFx0aW5uZXJUZXh0OiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuRm9ybS5TY3JlZW5zaG90TGFiZWwsXHJcblx0XHRcdFx0XHRcdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLkxhYmVsLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb3JtU2NyZWVuc2hvdENvbnRhaW5lcl0sXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdGNsYXNzZXM6IFtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHQsXHJcblx0XHRcdFx0XHRcdFx0XHRcdENvbnN0YW50cy5DbGFzc2VzLlN1Ym1pdEJ1dHRvbixcclxuXHRcdFx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdFx0XHRpZDogQ29uc3RhbnRzLklEcy5CYXNpY0Zvcm1TdWJtaXRCdXR0b24sXHJcblx0XHRcdFx0XHRcdFx0XHRpbm5lclRleHQ6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLlN1Ym1pdCxcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuQnV0dG9uLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLlNwaW5uZXIsIENvbnN0YW50cy5DbGFzc2VzLkhpZGRlbl0sXHJcblx0XHRcdFx0XHRcdFx0XHRpZDogQ29uc3RhbnRzLklEcy5CYXNpY0Zvcm1TdWJtaXRCdXR0b25TcGlubmVyLFxyXG5cdFx0XHRcdFx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5EaXYsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLkZvcm1TdWJtaXRCdXR0b25Db250YWluZXJdLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb3JtQm90dG9tQ29udGFpbmVyXSxcclxuXHRcdFx0fSxcclxuXHRcdF0sXHJcblx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuSGlkZGVuLCBDb25zdGFudHMuQ2xhc3Nlcy5NYXJnaW5MZWZ0NjBweF0sXHJcblx0XHRpZDogY29udGFpbmVySWQsXHJcblx0fTtcclxuXHRyZXR1cm4gZm9ybVNjaGVtYTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSBpZCBmb3IgdGhlIGNvbnRhaW5lci4gVGhpcyBpcyB0aGUgaWQgb2YgdGhlIHRvcC1tb3N0IGVsZW1lbnQgYW5kIHNob3VsZFxyXG4gKiBiZSB1bmlxdWUgdG8gZWFjaCBmb3JtXHJcbiAqL1xyXG5leHBvcnQgbGV0IGNvbnRhaW5lcklkOiBzdHJpbmcgPSBDb25zdGFudHMuSURzLkJhc2ljRm9ybUNvbnRhaW5lcjtcclxuXHJcbi8qKlxyXG4gKiBGb3JtcyBtYXkgYmUgdXNlZCBmb3IgZGlmZmVyZW50IGZlZWRiYWNrIHR5cGVzLiBUaGlzIG1ldGhvZCBleGVjdXRlcyBmb3JtXHJcbiAqIHNwZWNpZmljIGxvZ2ljIHdoZW4gdGhlIGZlZWRiYWNrIHR5cGUgaXMgc2VsZWN0ZWRcclxuICogQHBhcmFtIGZlZWRiYWNrVHlwZSBmZWVkYmFjayB0eXBlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gb25TZWxlY3QoZmVlZGJhY2tUeXBlOiBDb25zdGFudHMuRmVlZGJhY2tUeXBlKTogdm9pZCB7XHJcblxyXG5cdHN3aXRjaCAoZmVlZGJhY2tUeXBlKSB7XHJcblx0XHRjYXNlIENvbnN0YW50cy5GZWVkYmFja1R5cGUuU21pbGU6IHtcclxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoQ29uc3RhbnRzLklEcy5CYXNpY0Zvcm1RdWVzdGlvbk1pZGRsZVRleHQpLnRleHRDb250ZW50ID1cclxuXHRcdFx0XHRVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuU21pbGVGb3JtLlRpdGxlO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHRcdGNhc2UgQ29uc3RhbnRzLkZlZWRiYWNrVHlwZS5Gcm93bjoge1xyXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChDb25zdGFudHMuSURzLkJhc2ljRm9ybVF1ZXN0aW9uTWlkZGxlVGV4dCkudGV4dENvbnRlbnQgPVxyXG5cdFx0XHRcdFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gcm93bkZvcm0uVGl0bGU7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cdFx0Y2FzZSBDb25zdGFudHMuRmVlZGJhY2tUeXBlLklkZWE6IHtcclxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoQ29uc3RhbnRzLklEcy5CYXNpY0Zvcm1RdWVzdGlvbk1pZGRsZVRleHQpLnRleHRDb250ZW50ID1cclxuXHRcdFx0XHRVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuSWRlYUZvcm0uVGl0bGU7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cdFx0Y2FzZSBDb25zdGFudHMuRmVlZGJhY2tUeXBlLkJ1Zzoge1xyXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChDb25zdGFudHMuSURzLkJhc2ljRm9ybVF1ZXN0aW9uTWlkZGxlVGV4dCkudGV4dENvbnRlbnQgPVxyXG5cdFx0XHRcdFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5CdWdGb3JtLlRpdGxlO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHRcdGRlZmF1bHQ6IHtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChDb25zdGFudHMuSURzLkJhc2ljRm9ybUNvbW1lbnQpLmZvY3VzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGb3JtIHRlbXBsYXRlIHR5cGVcclxuICovXHJcbmV4cG9ydCBsZXQgdHlwZTogRm9ybVRlbXBsYXRlVHlwZSA9IEZvcm1UZW1wbGF0ZVR5cGUuQmFzaWM7XHJcbiIsIu+7vy8qKlxyXG4gKiBGb3JtVGVtcGxhdGVUeXBlLnRzXHJcbiAqXHJcbiAqIEFuIGVudW0gZm9yIHRoZSB0eXBlcyBvZiBmb3JtcyBhdmFpbGFibGUuXHJcbiAqL1xyXG5cclxuZXhwb3J0IGVudW0gRm9ybVRlbXBsYXRlVHlwZSB7XHJcblx0U2luZ2xlID0gMCxcclxuXHRCYXNpYyA9IDEsXHJcblx0VXNlclZvaWNlID0gMlxyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBTaW5nbGVGb3JtVGVtcGxhdGUudHNcclxuICpcclxuICogQSBmb3JtIHRlbXBsYXRlIHdpdGggY29udGFjdCBpbmZvIGZpZWxkcy5cclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBVSVN0cmluZ3MgZnJvbSBcIi4vLi4vLi4vLi4vVUlTdHJpbmdzL1VJU3RyaW5nc1wiO1xyXG5pbXBvcnQge0Zvcm1UZW1wbGF0ZVR5cGV9IGZyb20gXCIuL0Zvcm1UZW1wbGF0ZVR5cGVcIjtcclxuaW1wb3J0IHtJVUlBc0pzb259IGZyb20gXCIuLy4uLy4uL1JlbmRlcmVyXCI7XHJcbmltcG9ydCAqIGFzIENhdGVnb3JpZXNEcm9wZG93biBmcm9tIFwiLi8uLi8uLi9DYXRlZ29yaWVzRHJvcGRvd25cIjtcclxuaW1wb3J0ICogYXMgUmF0aW5nQ29udHJvbCBmcm9tIFwiLi8uLi8uLi9SYXRpbmdDb250cm9sXCI7XHJcbmltcG9ydCAqIGFzIENvbmZpZ3VyYXRpb24gZnJvbSBcIi4vLi4vLi4vLi4vQ29uZmlndXJhdGlvbi9Db25maWd1cmF0aW9uXCI7XHJcbmltcG9ydCAqIGFzIENvbnN0YW50cyBmcm9tIFwiLi8uLi8uLi8uLi9Db25zdGFudHNcIjtcclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSB0aGUgbWFya3VwXHJcbiAqIEByZXR1cm5zIHRoZSBtYXJrdXAgYXMganNvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlKCk6IElVSUFzSnNvbiB7XHJcblx0bGV0IGNhdGVnb3JpZXMgPSBDb25maWd1cmF0aW9uLmdldCgpLmdldEluQXBwRmVlZGJhY2tMYXVuY2hPcHRpb25zKCkuY2F0ZWdvcmllcztcclxuXHJcblx0bGV0IGZvcm1TY2hlbWEgPSB7XHJcblx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHR7XHJcblx0XHRcdFx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuRm9yLCB2YWx1ZTogQ29uc3RhbnRzLklEcy5TaW5nbGVGb3JtQ29tbWVudCB9XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbXHJcblx0XHRcdFx0XHRDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3VidGl0bGUsXHJcblx0XHRcdFx0XHRDb25zdGFudHMuQ2xhc3Nlcy5UZXh0QWxpZ25MZWZ0LFxyXG5cdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuRm9ybVF1ZXN0aW9uTWlkZGxlVGV4dCxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGlkOiBDb25zdGFudHMuSURzLlNpbmdsZUZvcm1RdWVzdGlvbk1pZGRsZVRleHQsXHJcblx0XHRcdFx0aW5uZXJUZXh0OiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuU2luZ2xlRm9ybS5UaXRsZSxcclxuXHRcdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLkxhYmVsLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuSWQsIHZhbHVlOiBDb25zdGFudHMuSURzLlNpbmdsZUZvcm1DYXRlZ29yaWVzRHJvcGRvd24gfV0sXHJcblx0XHRcdFx0YnJzOiBjYXRlZ29yaWVzLnNob3csXHJcblx0XHRcdFx0Y2hpbGRyZW46IENhdGVnb3JpZXNEcm9wZG93bi5nZW5lcmF0ZShjYXRlZ29yaWVzID8gY2F0ZWdvcmllcy5jdXN0b21DYXRlZ29yaWVzIDogbnVsbCksXHJcblx0XHRcdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLkZvbnRTdWJUZXh0LCBDb25zdGFudHMuQ2xhc3Nlcy5Gb3JtQ2F0ZWdvcmllc0Ryb3Bkb3duLCBDb25zdGFudHMuQ2xhc3Nlcy5UZXh0SW5wdXRdLFxyXG5cdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuU2VsZWN0LFxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5QbGFjZWhvbGRlcixcclxuXHRcdFx0XHRcdFx0dmFsdWU6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLkNvbW1lbnRQbGFjZWhvbGRlcixcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLk1heExlbmd0aCxcclxuXHRcdFx0XHRcdFx0dmFsdWU6IENvbnN0YW50cy5BdHRyaWJ1dGVWYWx1ZS5UZXh0QXJlYU1heExlbmd0aCxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHQsIENvbnN0YW50cy5DbGFzc2VzLkZvcm1Db21tZW50LCBDb25zdGFudHMuQ2xhc3Nlcy5UZXh0SW5wdXRdLFxyXG5cdFx0XHRcdGlkOiBDb25zdGFudHMuSURzLlNpbmdsZUZvcm1Db21tZW50LFxyXG5cdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuVGV4dEFyZWEsXHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRicnM6IGZhbHNlLCAvLyByYXRpbmdzIGFyZSBkaXNhYmxlZCBmb3Igbm93XHJcblx0XHRcdFx0Y2hpbGRyZW46IFtcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuRm9yLCB2YWx1ZTogQ29uc3RhbnRzLklEcy5TaW5nbGVGb3JtUmF0aW5nIH1dLFxyXG5cdFx0XHRcdFx0XHRjbGFzc2VzOiBbXHJcblx0XHRcdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHQsXHJcblx0XHRcdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuVGV4dEFsaWduTGVmdCxcclxuXHRcdFx0XHRcdFx0XHRDb25zdGFudHMuQ2xhc3Nlcy5Gb3JtUmF0aW5nTGFiZWwsXHJcblx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdGlubmVyVGV4dDogVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLkZvcm0uUmF0aW5nTGFiZWwsXHJcblx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuTGFiZWwsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0UmF0aW5nQ29udHJvbC5nZW5lcmF0ZShDb25zdGFudHMuSURzLlNpbmdsZUZvcm1SYXRpbmcpLFxyXG5cdFx0XHRcdF0sXHJcblx0XHRcdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLkZvcm1SYXRpbmdDb250YWluZXJdLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5UeXBlLFxyXG5cdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLkF0dHJpYnV0ZVZhbHVlLlRleHQsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5QbGFjZWhvbGRlcixcclxuXHRcdFx0XHRcdFx0dmFsdWU6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLkVtYWlsUGxhY2Vob2xkZXIsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5BcmlhTGFiZWwsXHJcblx0XHRcdFx0XHRcdHZhbHVlOiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuRm9ybS5FbWFpbFBsYWNlaG9sZGVyLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTmFtZSxcclxuXHRcdFx0XHRcdFx0dmFsdWU6IENvbnN0YW50cy5JRHMuU2luZ2xlRm9ybUVtYWlsSW5wdXQsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5NYXhMZW5ndGgsXHJcblx0XHRcdFx0XHRcdHZhbHVlOiBDb25zdGFudHMuQXR0cmlidXRlVmFsdWUuVGV4dEFyZWFNYXhMZW5ndGgsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5WYWx1ZSxcclxuXHRcdFx0XHRcdFx0dmFsdWU6XHJcblx0XHRcdFx0XHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRJbkFwcEZlZWRiYWNrSW5pdE9wdGlvbnMoKS51c2VyRW1haWxcclxuXHRcdFx0XHRcdFx0XHQ/IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0SW5BcHBGZWVkYmFja0luaXRPcHRpb25zKCkudXNlckVtYWlsXHJcblx0XHRcdFx0XHRcdFx0OiBcIlwiLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3ViVGV4dCwgQ29uc3RhbnRzLkNsYXNzZXMuRm9ybUVtYWlsSW5wdXQsIENvbnN0YW50cy5DbGFzc2VzLlRleHRJbnB1dF0sXHJcblx0XHRcdFx0aWQ6IENvbnN0YW50cy5JRHMuU2luZ2xlRm9ybUVtYWlsSW5wdXQsXHJcblx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5JbnB1dCxcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNoaWxkcmVuOlxyXG5cdFx0XHRcdFtcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLkhSZWYsXHJcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLlVybHMuUHJpdmFjeVN0YXRlbWVudExpbmssXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5UYXJnZXQsXHJcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLkF0dHJpYnV0ZVZhbHVlLkJsYW5rV2luZG93LFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuUmVsLFxyXG5cdFx0XHRcdFx0XHRcdFx0dmFsdWU6IENvbnN0YW50cy5BdHRyaWJ1dGVWYWx1ZS5Ob1JlZmVycmVyLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5MaW5rXSxcclxuXHRcdFx0XHRcdFx0aWQ6IENvbnN0YW50cy5JRHMuUHJpdmFjeVN0YXRlbWVudExpbmssXHJcblx0XHRcdFx0XHRcdGlubmVyVGV4dDogVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLlByaXZhY3lTdGF0ZW1lbnQsXHJcblx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuQW5jaG9yLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3ViU3ViVGV4dCwgQ29uc3RhbnRzLkNsYXNzZXMuVGV4dEFsaWduTGVmdCxcclxuXHRcdFx0XHRcdENvbnN0YW50cy5DbGFzc2VzLlByaXZhY3lTdGF0ZW1lbnRMaW5rRGl2XSxcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVHlwZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLkF0dHJpYnV0ZVZhbHVlLkNoZWNrYm94LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmFsdWUsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWU6IENvbnN0YW50cy5BdHRyaWJ1dGVWYWx1ZS5VbmNoZWNrZWQsXHJcblx0XHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdFx0XHRcdFx0YnJzOiBDb25maWd1cmF0aW9uLmdldCgpLmdldEluQXBwRmVlZGJhY2tJbml0T3B0aW9ucygpLnNjcmVlbnNob3QsXHJcblx0XHRcdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9ybVNjcmVlbnNob3RDaGVja2JveCwgQ29uc3RhbnRzLkNsYXNzZXMuQ2hlY2tCb3hdLFxyXG5cdFx0XHRcdFx0XHRcdFx0aWQ6IENvbnN0YW50cy5JRHMuU2luZ2xlRm9ybVNjcmVlbnNob3RDaGVja2JveCxcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuSW5wdXQsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRhdHRyaWJ1dGVzOiBbeyBuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5Gb3IsIHZhbHVlOiBDb25zdGFudHMuSURzLlNpbmdsZUZvcm1TY3JlZW5zaG90Q2hlY2tib3ggfV0sXHJcblx0XHRcdFx0XHRcdFx0XHRicnM6IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0SW5BcHBGZWVkYmFja0luaXRPcHRpb25zKCkuc2NyZWVuc2hvdCxcclxuXHRcdFx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb250VGV4dCwgQ29uc3RhbnRzLkNsYXNzZXMuVGV4dEFsaWduTGVmdCwgQ29uc3RhbnRzLkNsYXNzZXMuRm9ybVNjcmVlbnNob3RMYWJlbF0sXHJcblx0XHRcdFx0XHRcdFx0XHRpbm5lclRleHQ6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLlNjcmVlbnNob3RMYWJlbCxcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuTGFiZWwsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLkZvcm1TY3JlZW5zaG90Q29udGFpbmVyXSxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2xhc3NlczogW1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3ViVGV4dCxcclxuXHRcdFx0XHRcdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuU3VibWl0QnV0dG9uLFxyXG5cdFx0XHRcdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdFx0XHRcdGlkOiBDb25zdGFudHMuSURzLlNpbmdsZUZvcm1TdWJtaXRCdXR0b24sXHJcblx0XHRcdFx0XHRcdFx0XHRpbm5lclRleHQ6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLlN1Ym1pdCxcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuQnV0dG9uLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLlNwaW5uZXIsIENvbnN0YW50cy5DbGFzc2VzLkhpZGRlbl0sXHJcblx0XHRcdFx0XHRcdFx0XHRpZDogQ29uc3RhbnRzLklEcy5TaW5nbGVGb3JtU3VibWl0QnV0dG9uU3Bpbm5lcixcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuRGl2LFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb3JtU3VibWl0QnV0dG9uQ29udGFpbmVyXSxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9ybUJvdHRvbUNvbnRhaW5lcl0sXHJcblx0XHRcdH0sXHJcblx0XHRdLFxyXG5cdFx0aWQ6IGNvbnRhaW5lcklkLFxyXG5cdH07XHJcblx0cmV0dXJuIGZvcm1TY2hlbWE7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgaWQgZm9yIHRoZSBjb250YWluZXIuIFRoaXMgaXMgdGhlIGlkIG9mIHRoZSB0b3AtbW9zdCBlbGVtZW50IGFuZCBzaG91bGRcclxuICogYmUgdW5pcXVlIHRvIGVhY2ggZm9ybVxyXG4gKi9cclxuZXhwb3J0IGxldCBjb250YWluZXJJZDogc3RyaW5nID0gQ29uc3RhbnRzLklEcy5TaW5nbGVGb3JtQ29udGFpbmVyO1xyXG5cclxuLyoqXHJcbiAqIEZvcm1zIG1heSBiZSB1c2VkIGZvciBkaWZmZXJlbnQgZmVlZGJhY2sgdHlwZXMuIFRoaXMgbWV0aG9kIGV4ZWN1dGVzIGZvcm1cclxuICogc3BlY2lmaWMgbG9naWMgd2hlbiB0aGUgZmVlZGJhY2sgdHlwZSBpcyBzZWxlY3RlZFxyXG4gKiBAcGFyYW0gZmVlZGJhY2tUeXBlIGZlZWRiYWNrIHR5cGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBvblNlbGVjdChmZWVkYmFja1R5cGU6IENvbnN0YW50cy5GZWVkYmFja1R5cGUpOiB2b2lkIHtcclxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChDb25zdGFudHMuSURzLlNpbmdsZUZvcm1Db21tZW50KS5mb2N1cygpO1xyXG59XHJcblxyXG4vKipcclxuICogRm9ybSB0ZW1wbGF0ZSB0eXBlXHJcbiAqL1xyXG5leHBvcnQgbGV0IHR5cGU6IEZvcm1UZW1wbGF0ZVR5cGUgPSBGb3JtVGVtcGxhdGVUeXBlLlNpbmdsZTtcclxuIiwi77u/LyoqXHJcbiAqIFVzZXJWb2ljZUZvcm1UZW1wbGF0ZVxyXG4gKlxyXG4gKiBBIGZvcm0gdGVtcGxhdGUgZm9yIGRpcmVjdGluZyB0byB1c2VyIHZvaWNlLlxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIFVJU3RyaW5ncyBmcm9tIFwiLi8uLi8uLi8uLi9VSVN0cmluZ3MvVUlTdHJpbmdzXCI7XHJcbmltcG9ydCB7Rm9ybVRlbXBsYXRlVHlwZX0gZnJvbSBcIi4vRm9ybVRlbXBsYXRlVHlwZVwiO1xyXG5pbXBvcnQge0lVSUFzSnNvbn0gZnJvbSBcIi4vLi4vLi4vUmVuZGVyZXJcIjtcclxuaW1wb3J0ICogYXMgQ29uc3RhbnRzIGZyb20gXCIuLy4uLy4uLy4uL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgKiBhcyBDb25maWd1cmF0aW9uIGZyb20gXCIuLy4uLy4uLy4uL0NvbmZpZ3VyYXRpb24vQ29uZmlndXJhdGlvblwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJVXNlclZvaWNlSW5pdE9wdGlvbnMge1xyXG5cdC8vIFVybCBmb3IgdXNlciB2b2ljZS5cclxuXHR1cmw6IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlIHRoZSBtYXJrdXBcclxuICogQHJldHVybnMgdGhlIG1hcmt1cCBhcyBqc29uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGUoKTogSVVJQXNKc29uIHtcclxuXHRsZXQgaW5pdE9wdGlvbnM6IElVc2VyVm9pY2VJbml0T3B0aW9ucyA9IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0SW5BcHBGZWVkYmFja0luaXRPcHRpb25zKCkudXNlclZvaWNlO1xyXG5cclxuXHRsZXQgZm9ybVNjaGVtYSA9IHtcclxuXHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YnRpdGxlLCBDb25zdGFudHMuQ2xhc3Nlcy5UZXh0QWxpZ25MZWZ0LFxyXG5cdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuRm9ybVF1ZXN0aW9uTWlkZGxlVGV4dF0sXHJcblx0XHRcdFx0aW5uZXJUZXh0OiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuVXNlclZvaWNlRm9ybS5UaXRsZSxcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb250VGV4dCwgQ29uc3RhbnRzLkNsYXNzZXMuVGV4dEFsaWduTGVmdCxcclxuXHRcdFx0XHRcdENvbnN0YW50cy5DbGFzc2VzLkZvcm1NaWRkbGVUZXh0XSxcclxuXHRcdFx0XHRpbm5lclRleHQ6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Vc2VyVm9pY2VGb3JtLlRleHQsXHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFtcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlNvdXJjZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogaW5pdE9wdGlvbnMudXJsLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdFx0XHRcdGNsYXNzZXM6IFtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Q29uc3RhbnRzLkNsYXNzZXMuU3VibWl0QnV0dG9uLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3ViVGV4dCxcclxuXHRcdFx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdFx0XHRpZDogQ29uc3RhbnRzLklEcy5Vc2VyVm9pY2VGb3JtR29CdXR0b24sXHJcblx0XHRcdFx0XHRcdFx0XHRpbm5lclRleHQ6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Vc2VyVm9pY2VGb3JtLkJ1dHRvbixcclxuXHRcdFx0XHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuQnV0dG9uLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb3JtU3VibWl0QnV0dG9uQ29udGFpbmVyXSxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9ybUJvdHRvbUNvbnRhaW5lcl0sXHJcblx0XHRcdH0sXHJcblx0XHRdLFxyXG5cdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLkhpZGRlbiwgQ29uc3RhbnRzLkNsYXNzZXMuTWFyZ2luTGVmdDYwcHhdLFxyXG5cdFx0aWQ6IGNvbnRhaW5lcklkLFxyXG5cdH07XHJcblx0cmV0dXJuIGZvcm1TY2hlbWE7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaGUgaWQgZm9yIHRoZSBjb250YWluZXIuIFRoaXMgaXMgdGhlIGlkIG9mIHRoZSB0b3AtbW9zdCBlbGVtZW50IGFuZCBzaG91bGRcclxuICogYmUgdW5pcXVlIHRvIGVhY2ggZm9ybVxyXG4gKi9cclxuZXhwb3J0IGxldCBjb250YWluZXJJZDogc3RyaW5nID0gQ29uc3RhbnRzLklEcy5Vc2VyVm9pY2VGb3JtQ29udGFpbmVyO1xyXG5cclxuLyoqXHJcbiAqIEZvcm1zIG1heSBiZSB1c2VkIGZvciBkaWZmZXJlbnQgZmVlZGJhY2sgdHlwZXMuIFRoaXMgbWV0aG9kIGV4ZWN1dGVzIGZvcm1cclxuICogc3BlY2lmaWMgbG9naWMgd2hlbiB0aGUgZmVlZGJhY2sgdHlwZSBpcyBzZWxlY3RlZFxyXG4gKiBAcGFyYW0gZmVlZGJhY2tUeXBlIGZlZWRiYWNrIHR5cGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBvblNlbGVjdChmZWVkYmFja1R5cGU6IENvbnN0YW50cy5GZWVkYmFja1R5cGUpOiB2b2lkIHtcclxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChDb25zdGFudHMuSURzLlVzZXJWb2ljZUZvcm1Hb0J1dHRvbikuZm9jdXMoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZvcm0gdGVtcGxhdGUgdHlwZVxyXG4gKi9cclxuZXhwb3J0IGxldCB0eXBlOiBGb3JtVGVtcGxhdGVUeXBlID0gRm9ybVRlbXBsYXRlVHlwZS5Vc2VyVm9pY2U7XHJcbiIsIu+7vy8qKlxyXG4gKiBMYXlvdXQudHNcclxuICpcclxuICogTW9kdWxlIGZvciB0aGUgbGF5b3V0XHJcbiAqL1xyXG5cclxuaW1wb3J0IHtJRm9ybVRlbXBsYXRlfSBmcm9tIFwiLi9Gb3JtVGVtcGxhdGVzL0lGb3JtVGVtcGxhdGVcIjtcclxuaW1wb3J0IHtJRHMsIENsYXNzZXMsIEF0dHJpYnV0ZU5hbWUsIEF0dHJpYnV0ZVZhbHVlLCBGZWVkYmFja1R5cGUsIFRhZ3MsIFVybHN9IGZyb20gXCIuLy4uLy4uL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgKiBhcyBSZW5kZXJlciBmcm9tIFwiLi8uLi9SZW5kZXJlclwiO1xyXG5pbXBvcnQgKiBhcyBVSVN0cmluZ3MgZnJvbSBcIi4vLi4vLi4vVUlTdHJpbmdzL1VJU3RyaW5nc1wiO1xyXG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tIFwiLi8uLi9VdGlsc1wiO1xyXG5pbXBvcnQgKiBhcyBTaW5nbGVGb3JtVGVtcGxhdGUgZnJvbSBcIi4vRm9ybVRlbXBsYXRlcy9TaW5nbGVGb3JtVGVtcGxhdGVcIjtcclxuXHJcbmV4cG9ydCB7SUZvcm1UZW1wbGF0ZX0gZnJvbSBcIi4vRm9ybVRlbXBsYXRlcy9JRm9ybVRlbXBsYXRlXCI7XHJcblxyXG4vKipcclxuICogR2VuZXJhdGVzIHRoZSBtdWx0aSBsYXlvdXQgYXMgYSBSZW5kZXJlci5JVUlBc0pzb24gb2JqZWN0XHJcbiAqXHJcbiAqIFRoZSBUYWJGb2N1cy50cyBoYXMgYSBkZXBlbmRlbmN5IGluIHRoZSBtYWluQ29udGFpbmVyLiBBbGwgdGFiYmFibGUgZWxlbWVudHNcclxuICogc2hvdWxkIGJlIHBsYWNlZCBpbnNpZGUgdGhlIG1haW5Db250YWluZXIgb3RoZXJ3aXNlIFRhYkZvY3VzLnRzIHdpbGwgbm90XHJcbiAqIGZ1bmN0aW9uIGFzIGV4cGVjdGVkLlxyXG4gKiBAcGFyYW0ge1trZXk6IG51bWJlcl06IElGb3JtVGVtcGxhdGV9IGZvcm1UZW1wbGF0ZXMgRmVlZGJhY2tUeXBlIC0+IEZvcm1UZW1wbGF0ZSBtYXBwaW5nXHJcbiAqIEByZXR1cm5zIHtSZW5kZXJlci5JVUlBc0pzb259IFJlbmRlcmVyLklVSUFzSnNvbiBvYmplY3RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZU11bHRpKGZvcm1UZW1wbGF0ZXM6IHsgW2tleTogbnVtYmVyXTogSUZvcm1UZW1wbGF0ZSB9KTogUmVuZGVyZXIuSVVJQXNKc29uIHtcclxuXHRsZXQgc2NoZW1hOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0XHRhdHRyaWJ1dGVzOiBbeyBuYW1lOiBBdHRyaWJ1dGVOYW1lLkRhdGFIdG1sMkNhbnZhc0lnbm9yZSwgdmFsdWU6IEF0dHJpYnV0ZVZhbHVlLlRydWUgfV0sXHJcblx0XHRjaGlsZHJlbjpcclxuXHRcdFtcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGF0dHJpYnV0ZXM6XHJcblx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0eyBuYW1lOiBBdHRyaWJ1dGVOYW1lLlJvbGUsIHZhbHVlOiBcImRpYWxvZ1wiIH0sXHJcblx0XHRcdFx0XHR7IG5hbWU6IFwiYXJpYS1tb2RhbFwiLCB2YWx1ZTogXCJ0cnVlXCIgfSxcclxuXHRcdFx0XHRcdHsgbmFtZTogXCJhcmlhLWRlc2NyaWJlZGJ5XCIsIHZhbHVlOiBJRHMuUXVlc3Rpb25MZWZ0VGV4dCB9LFxyXG5cdFx0XHRcdF0sXHJcblx0XHRcdFx0Y2hpbGRyZW46XHJcblx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHQvLyBUaGlzIGFkZHMgYSBcImZpcnN0XCIgZHVtbXkgdGFiYmFibGUgZGl2IHRvIHRoZSBtYWluQ29udGFpbmVyLiBJdCdzIHVzZWQgYXMgYSBtYXJrZXJcclxuXHRcdFx0XHRcdFx0Ly8gdG8gaGFuZGxlIHRhYnMgYW5kIHNoaWZ0IHRhYnMgc28gZm9jdXMgd2lsbCBzdGF5IHdpdGggZWxlbWVudHMgb24ganVzdCB0aGUgZmVlZGJhY2tcclxuXHRcdFx0XHRcdFx0Ly8gZGlhbG9nLiBEbyBub3QgcmVsb2NhdGUgdGhpcyB3aXRob3V0IHVwZGF0aW5nIHRoZSBUYWJGb2N1cy50cyBjb2RlLlxyXG5cdFx0XHRcdFx0XHRhdHRyaWJ1dGVzOiBbeyBuYW1lOiBBdHRyaWJ1dGVOYW1lLlRhYkluZGV4LCB2YWx1ZTogQXR0cmlidXRlVmFsdWUuWmVybyB9XSxcclxuXHRcdFx0XHRcdFx0aWQ6IElEcy5GaXJzdFRhYmJhYmxlLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0Y2hpbGRyZW46XHJcblx0XHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbjpcclxuXHRcdFx0XHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDbGFzc2VzLkZvbnRTdWJ0aXRsZSwgQ2xhc3Nlcy5UZXh0QWxpZ25MZWZ0XSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZDogSURzLlF1ZXN0aW9uTGVmdFRleHQsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aW5uZXJUZXh0OiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuRmVlZGJhY2tTdWJ0aXRsZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hpbGRyZW46IGdlbmVyYXRlT3ZlcmFsbEFuY2hvcnMoZm9ybVRlbXBsYXRlcyksXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlkOiBJRHMuT3ZlcmFsbEFuY2hvcnNDb250YWluZXIsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWQ6IElEcy5Db2x1bW5TZXBhcmF0b3JEaXYsXHJcblx0XHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbjpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRbXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRuYW1lOiBBdHRyaWJ1dGVOYW1lLkhSZWYsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogVXJscy5Qcml2YWN5U3RhdGVtZW50TGluayxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdG5hbWU6IEF0dHJpYnV0ZU5hbWUuVGFyZ2V0LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFsdWU6IEF0dHJpYnV0ZVZhbHVlLkJsYW5rV2luZG93LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bmFtZTogQXR0cmlidXRlTmFtZS5SZWwsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogQXR0cmlidXRlVmFsdWUuTm9SZWZlcnJlcixcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ2xhc3Nlcy5MaW5rXSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWQ6IElEcy5Qcml2YWN5U3RhdGVtZW50TGluayxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aW5uZXJUZXh0OiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuUHJpdmFjeVN0YXRlbWVudCxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGFnOiBUYWdzLkFuY2hvcixcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ2xhc3Nlcy5Gb250U3ViU3ViVGV4dCwgQ2xhc3Nlcy5UZXh0QWxpZ25MZWZ0LCBDbGFzc2VzLlByaXZhY3lTdGF0ZW1lbnRMaW5rRGl2XSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ2xhc3Nlcy5Gb3JtQ29udGFpbmVyXSxcclxuXHRcdFx0XHRcdFx0XHRcdGlkOiBJRHMuTGVmdEZvcm1Db250YWluZXIsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRjaGlsZHJlbjogZ2VuZXJhdGVNdWx0aUZvcm1zKGZvcm1UZW1wbGF0ZXMpLFxyXG5cdFx0XHRcdFx0XHRcdFx0Y2xhc3NlczogW0NsYXNzZXMuRm9ybUNvbnRhaW5lciwgQ2xhc3Nlcy5IaWRkZW5dLFxyXG5cdFx0XHRcdFx0XHRcdFx0aWQ6IElEcy5NaWRkbGVGb3JtQ29udGFpbmVyLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdF0sXHJcblx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDbGFzc2VzLkhpZGRlbl0sXHJcblx0XHRcdFx0XHRcdGlkOiBJRHMuTWFpbkNvbnRlbnRIb2xkZXIsXHJcblx0XHRcdFx0XHRcdHRhZzogVGFncy5Gb3JtLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0Ly8gVGhpcyBhZGRzIGEgXCJsYXN0XCIgZHVtbXkgdGFiYmFibGUgZGl2IHRvIHRoZSBtYWluQ29udGFpbmVyLiBJdCdzIHVzZWQgYXMgYSBtYXJrZXJcclxuXHRcdFx0XHRcdFx0Ly8gdG8gaGFuZGxlIHRhYnMgYW5kIHNoaWZ0IHRhYnMgc28gZm9jdXMgd2lsbCBzdGF5IHdpdGggZWxlbWVudHMgb24ganVzdCB0aGUgZmVlZGJhY2tcclxuXHRcdFx0XHRcdFx0Ly8gZGlhbG9nLiBEbyBub3QgcmVsb2NhdGUgdGhpcyB3aXRob3V0IHVwZGF0aW5nIHRoZSBUYWJGb2N1cy50cyBjb2RlLlxyXG5cdFx0XHRcdFx0XHRhdHRyaWJ1dGVzOiBbeyBuYW1lOiBBdHRyaWJ1dGVOYW1lLlRhYkluZGV4LCB2YWx1ZTogQXR0cmlidXRlVmFsdWUuWmVybyB9XSxcclxuXHRcdFx0XHRcdFx0aWQ6IElEcy5MYXN0VGFiYmFibGUsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdF0sXHJcblx0XHRcdFx0aWQ6IElEcy5NYWluQ29udGFpbmVyLFxyXG5cdFx0XHR9LFxyXG5cdFx0XSxcclxuXHRcdGNsYXNzZXM6IFtVdGlscy5pc1JpZ2h0VG9MZWZ0KCkgPyBDbGFzc2VzLlJ0bCA6IFwiXCIgXSxcclxuXHRcdGlkOiBJRHMuT3ZlcmxheUJhY2tncm91bmQsXHJcblx0fTtcclxuXHRyZXR1cm4gc2NoZW1hO1xyXG59XHJcblxyXG4vKipcclxuICogR2VuZXJhdGVzIHRoZSBzaW5nbGUgbGF5b3V0IGFzIGEgUmVuZGVyZXIuSVVJQXNKc29uIG9iamVjdFxyXG4gKlxyXG4gKiBUaGUgVGFiRm9jdXMudHMgaGFzIGEgZGVwZW5kZW5jeSBpbiB0aGUgbWFpbkNvbnRhaW5lci4gQWxsIHRhYmJhYmxlIGVsZW1lbnRzXHJcbiAqIHNob3VsZCBiZSBwbGFjZWQgaW5zaWRlIHRoZSBtYWluQ29udGFpbmVyIG90aGVyd2lzZSBUYWJGb2N1cy50cyB3aWxsIG5vdFxyXG4gKiBmdW5jdGlvbiBhcyBleHBlY3RlZC5cclxuICogQHJldHVybnMge1JlbmRlcmVyLklVSUFzSnNvbn0gUmVuZGVyZXIuSVVJQXNKc29uIG9iamVjdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlU2luZ2xlKCk6IFJlbmRlcmVyLklVSUFzSnNvbiB7XHJcblx0bGV0IHNjaGVtYTogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdFx0YXR0cmlidXRlczogW3sgbmFtZTogQXR0cmlidXRlTmFtZS5EYXRhSHRtbDJDYW52YXNJZ25vcmUsIHZhbHVlOiBBdHRyaWJ1dGVWYWx1ZS5UcnVlIH1dLFxyXG5cdFx0Y2hpbGRyZW46XHJcblx0XHRbXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjaGlsZHJlbjpcclxuXHRcdFx0XHRbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdC8vIFRoaXMgYWRkcyBhIFwiZmlyc3RcIiBkdW1teSB0YWJiYWJsZSBkaXYgdG8gdGhlIG1haW5Db250YWluZXIuIEl0J3MgdXNlZCBhcyBhIG1hcmtlclxyXG5cdFx0XHRcdFx0XHQvLyB0byBoYW5kbGUgdGFicyBhbmQgc2hpZnQgdGFicyBzbyBmb2N1cyB3aWxsIHN0YXkgd2l0aCBlbGVtZW50cyBvbiBqdXN0IHRoZSBmZWVkYmFja1xyXG5cdFx0XHRcdFx0XHQvLyBkaWFsb2cuIERvIG5vdCByZWxvY2F0ZSB0aGlzIHdpdGhvdXQgdXBkYXRpbmcgdGhlIFRhYkZvY3VzLnRzIGNvZGUuXHJcblx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IEF0dHJpYnV0ZU5hbWUuVGFiSW5kZXgsIHZhbHVlOiBBdHRyaWJ1dGVWYWx1ZS5aZXJvIH1dLFxyXG5cdFx0XHRcdFx0XHRpZDogSURzLkZpcnN0VGFiYmFibGUsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRjaGlsZHJlbjpcclxuXHRcdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdGNoaWxkcmVuOiBbU2luZ2xlRm9ybVRlbXBsYXRlLmdlbmVyYXRlKCldLFxyXG5cdFx0XHRcdFx0XHRcdFx0Y2xhc3NlczogW0NsYXNzZXMuRm9ybUNvbnRhaW5lcl0sXHJcblx0XHRcdFx0XHRcdFx0XHRpZDogSURzLk1pZGRsZUZvcm1Db250YWluZXIsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdFx0Y2xhc3NlczogW0NsYXNzZXMuSGlkZGVuXSxcclxuXHRcdFx0XHRcdFx0aWQ6IElEcy5NYWluQ29udGVudEhvbGRlcixcclxuXHRcdFx0XHRcdFx0dGFnOiBUYWdzLkZvcm0sXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHQvLyBUaGlzIGFkZHMgYSBcImxhc3RcIiBkdW1teSB0YWJiYWJsZSBkaXYgdG8gdGhlIG1haW5Db250YWluZXIuIEl0J3MgdXNlZCBhcyBhIG1hcmtlclxyXG5cdFx0XHRcdFx0XHQvLyB0byBoYW5kbGUgdGFicyBhbmQgc2hpZnQgdGFicyBzbyBmb2N1cyB3aWxsIHN0YXkgd2l0aCBlbGVtZW50cyBvbiBqdXN0IHRoZSBmZWVkYmFja1xyXG5cdFx0XHRcdFx0XHQvLyBkaWFsb2cuIERvIG5vdCByZWxvY2F0ZSB0aGlzIHdpdGhvdXQgdXBkYXRpbmcgdGhlIFRhYkZvY3VzLnRzIGNvZGUuXHJcblx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IEF0dHJpYnV0ZU5hbWUuVGFiSW5kZXgsIHZhbHVlOiBBdHRyaWJ1dGVWYWx1ZS5aZXJvIH1dLFxyXG5cdFx0XHRcdFx0XHRpZDogSURzLkxhc3RUYWJiYWJsZSxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRpZDogSURzLk1haW5Db250YWluZXIsXHJcblx0XHRcdH0sXHJcblx0XHRdLFxyXG5cdFx0Y2xhc3NlczogW0NsYXNzZXMuU2luZ2xlTGF5b3V0LCBVdGlscy5pc1JpZ2h0VG9MZWZ0KCkgPyBDbGFzc2VzLlJ0bCA6IFwiXCIgXSxcclxuXHRcdGlkOiBJRHMuT3ZlcmxheUJhY2tncm91bmQsXHJcblx0fTtcclxuXHRyZXR1cm4gc2NoZW1hO1xyXG59XHJcblxyXG4vKipcclxuICogR2VuZXJhdGUgUmVuZGVyZXIuSVVJQXNKc29uIG9iamVjdHMgdGhhdCBob2xkcyB0aGUgZGlmZmVyZW50IGZvcm1zIHRoYXQgd2lsbCBiZSB1c2VkIG9uIHRoZSBiZWxseWJhbmQuXHJcbiAqIFRoaXMgaXMgdXNlZCB0byBnZW5lcmF0ZSBqdXN0IG9uZSBmb3JtIG9mIGVhY2ggb25lIG9mIHRoZSB0ZW1wbGF0ZXMgdGhhdCBhcmUgYWN0dWFsbHkgZ29pbmcgdG8gYmUgdXNlZC5cclxuICogQHBhcmFtIHtba2V5OiBudW1iZXJdOiBJRm9ybVRlbXBsYXRlfSBmb3JtVGVtcGxhdGVzIEZlZWRiYWNrVHlwZSAtPiBGb3JtVGVtcGxhdGUgbWFwcGluZ1xyXG4gKiBAcmV0dXJucyB7UmVuZGVyZXIuSVVJQXNKc29ufSBSZW5kZXJlci5JVUlBc0pzb24gb2JqZWN0XHJcbiAqL1xyXG5mdW5jdGlvbiBnZW5lcmF0ZU11bHRpRm9ybXMoZm9ybVRlbXBsYXRlczogeyBba2V5OiBudW1iZXJdOiBJRm9ybVRlbXBsYXRlIH0pOiBSZW5kZXJlci5JVUlBc0pzb25bXSB7XHJcblx0bGV0IHdyYXBwZXI6IFJlbmRlcmVyLklVSUFzSnNvbiA9IHtcclxuXHRcdGNoaWxkcmVuOiBbXSxcclxuXHR9O1xyXG5cclxuXHRsZXQgcHVzaGVkQ29udGFpbmVyczogeyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0gPSB7fTtcclxuXHJcblx0Zm9yIChsZXQgZmVlZGJhY2tUeXBlIGluIGZvcm1UZW1wbGF0ZXMpIHtcclxuXHRcdGlmIChmb3JtVGVtcGxhdGVzLmhhc093blByb3BlcnR5KGZlZWRiYWNrVHlwZSkpIHtcclxuXHRcdFx0bGV0IG5vdEV4aXN0czogYm9vbGVhbiA9ICEoZm9ybVRlbXBsYXRlc1tmZWVkYmFja1R5cGVdLmNvbnRhaW5lcklkIGluIHB1c2hlZENvbnRhaW5lcnMpO1xyXG5cdFx0XHRpZiAobm90RXhpc3RzKSB7XHJcblx0XHRcdFx0d3JhcHBlci5jaGlsZHJlbi5wdXNoKGZvcm1UZW1wbGF0ZXNbZmVlZGJhY2tUeXBlXS5nZW5lcmF0ZSgpKTtcclxuXHRcdFx0XHRwdXNoZWRDb250YWluZXJzW2Zvcm1UZW1wbGF0ZXNbZmVlZGJhY2tUeXBlXS5jb250YWluZXJJZF0gPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gd3JhcHBlci5jaGlsZHJlbjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlcyBSZW5kZXJlci5JVUlBc0pzb24gb2JqZWN0IHRoYXQgaG9sZHMgdGhlIGRpZmZlcmVudCBhbmNob3JzIHRoYXQgd2lsbCBiZSB1c2VkIG9uIHRoZSBiZWxseWJhbmQuXHJcbiAqIEBwYXJhbSB7W2tleTogbnVtYmVyXTogSUZvcm1UZW1wbGF0ZX0gZm9ybVRlbXBsYXRlcyBGZWVkYmFja1R5cGUgLT4gRm9ybVRlbXBsYXRlIG1hcHBpbmdcclxuICogQHJldHVybnMge1JlbmRlcmVyLklVSUFzSnNvbn0gUmVuZGVyZXIuSVVJQXNKc29uIG9iamVjdFxyXG4gKi9cclxuZnVuY3Rpb24gZ2VuZXJhdGVPdmVyYWxsQW5jaG9ycyhmb3JtVGVtcGxhdGVzOiB7IFtrZXk6IG51bWJlcl06IElGb3JtVGVtcGxhdGUgfSk6IFJlbmRlcmVyLklVSUFzSnNvbltdIHtcclxuXHRsZXQgd3JhcHBlcjogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdFx0Y2hpbGRyZW46IFtdLFxyXG5cdH07XHJcblxyXG5cdGlmIChGZWVkYmFja1R5cGUuU21pbGUgaW4gZm9ybVRlbXBsYXRlcykge1xyXG5cdFx0d3JhcHBlci5jaGlsZHJlbi5wdXNoKGdlbmVyYXRlT3ZlcmFsbEFuY2hvcihJRHMuT3ZlcmFsbFNtaWxlQW5jaG9yLCBJRHMuT3ZlcmFsbFNtaWxlSW1hZ2UsXHJcblx0XHRcdC8vIFRoZSBzdmcgY29kZSBmb3IgdGhlIGltYWdlXHJcblx0XHRcdC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcclxuXHRcdFx0Jzxzdmcgdmlld0JveD1cIjAgMCA3MiA3MlwiIHdpZHRoPVwiMjRweFwiIGhlaWdodD1cIjI0cHhcIiBmb2N1c2FibGU9XCJmYWxzZVwiPjxwYXRoIGQ9XCJNMzYgMUMxNi43IDEgMSAxNi43IDEgMzZzMTUuNyAzNSAzNSAzNWMxOS4zIDAgMzUtMTUuNyAzNS0zNVM1NS4zIDEgMzYgMVpNNDkuMyAxOC4zYzIuMyAwIDQuMiAyLjcgNC4yIDYgMCAzLjMtMS45IDYtNC4yIDYgLTIuMyAwLTQuMi0yLjctNC4yLTZDNDUuMSAyMSA0NyAxOC4zIDQ5LjMgMTguM1pNMjIuOSAxOC4zYzIuMyAwIDQuMiAyLjcgNC4yIDYgMCAzLjMtMS45IDYtNC4yIDYgLTIuMyAwLTQuMi0yLjctNC4yLTZDMTguNyAyMSAyMC42IDE4LjMgMjIuOSAxOC4zWk0zNiA1OC42Yy04LjUgMC0xNi00LjEtMjAuOS0xMC40bDMuNS0zLjZjMy41IDQuNSA5LjkgNy42IDE3LjQgNy42IDcuNCAwIDEzLjktMy4xIDE3LjQtNy42bDMuNiAzLjZDNTIuMSA1NC40IDQ0LjQgNTguNiAzNiA1OC42WlwiLz48L3N2Zz4nLFxyXG5cdFx0XHRJRHMuT3ZlcmFsbFNtaWxlVGV4dCwgVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLlNtaWxlRm9ybS5BbmNob3IpKTtcclxuXHR9XHJcblxyXG5cdGlmIChGZWVkYmFja1R5cGUuRnJvd24gaW4gZm9ybVRlbXBsYXRlcykge1xyXG5cdFx0d3JhcHBlci5jaGlsZHJlbi5wdXNoKGdlbmVyYXRlT3ZlcmFsbEFuY2hvcihJRHMuT3ZlcmFsbEZyb3duQW5jaG9yLCBJRHMuT3ZlcmFsbEZyb3duSW1hZ2UsXHJcblx0XHRcdC8vIFRoZSBzdmcgY29kZSBmb3IgdGhlIGltYWdlXHJcblx0XHRcdC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcclxuXHRcdFx0Jzxzdmcgdmlld0JveD1cIjAgMCA3MiA3MlwiIHdpZHRoPVwiMjRweFwiIGhlaWdodD1cIjI0cHhcIiBmb2N1c2FibGU9XCJmYWxzZVwiPjxwYXRoIGQ9XCJNMzYgMUMxNi43IDEgMSAxNi43IDEgMzZzMTUuNyAzNSAzNSAzNWMxOS4zIDAgMzUtMTUuNyAzNS0zNVM1NS4zIDEgMzYgMVpNNDkuMyAxOC4zYzIuMyAwIDQuMiAyLjcgNC4yIDYgMCAzLjMtMS45IDYtNC4yIDYgLTIuMyAwLTQuMi0yLjctNC4yLTZDNDUuMSAyMSA0NyAxOC4zIDQ5LjMgMTguM1pNMjIuOSAxOC4zYzIuMyAwIDQuMiAyLjcgNC4yIDYgMCAzLjMtMS45IDYtNC4yIDYgLTIuMyAwLTQuMi0yLjctNC4yLTZDMTguNyAyMSAyMC42IDE4LjMgMjIuOSAxOC4zWk01Mi44IDU3LjljLTMuMy00LjQtOS42LTcuMy0xNi43LTcuMyAtNy4yIDAtMTMuNCAzLTE2LjcgNy4zbC0zLjQtMy40YzQuNy02LjEgMTEuOS0xMCAyMC4xLTEwIDguMiAwIDE1LjUgNCAyMC4yIDEwTDUyLjggNTcuOVpcIi8+PC9zdmc+JyxcclxuXHRcdFx0SURzLk92ZXJhbGxGcm93blRleHQsIFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gcm93bkZvcm0uQW5jaG9yKSk7XHJcblx0fVxyXG5cclxuXHRpZiAoRmVlZGJhY2tUeXBlLklkZWEgaW4gZm9ybVRlbXBsYXRlcykge1xyXG5cdFx0d3JhcHBlci5jaGlsZHJlbi5wdXNoKGdlbmVyYXRlT3ZlcmFsbEFuY2hvcihJRHMuT3ZlcmFsbElkZWFBbmNob3IsIElEcy5PdmVyYWxsSWRlYUltYWdlLFxyXG5cdFx0XHQvLyBUaGUgc3ZnIGNvZGUgZm9yIHRoZSBpbWFnZVxyXG5cdFx0XHQvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXHJcblx0XHRcdCc8c3ZnIHZpZXdCb3g9XCIwIDAgNzIgNzJcIiB3aWR0aD1cIjI0cHhcIiBoZWlnaHQ9XCIyNHB4XCIgZm9jdXNhYmxlPVwiZmFsc2VcIj48cGF0aCBkPVwiTTQyLjMgNjJIMjkuMmMtMS4xIDAtMiAwLjktMiAyczEuOSAyIDMgMmgxMS4xYzEuMSAwIDMtMC45IDMtMlM0My40IDYyIDQyLjMgNjJaTTM2IDEuMUMyNSAxLjEgMTQuOCA3IDE0LjggMjAuNmMwIDIuMiAwLjggNC40IDAuNyA0LjEgMS4yIDIuOSAyLjcgNS42IDYuMyAxMC45IDQuMiA2LjMgNC43IDcuNiA0LjggMTEuMXYxLjNjMCAxLjMgMSAzIDIuNyAzaDEzLjVjMS43IDAgMi44LTEuNyAyLjgtM3YtMS41YzAuMS0zLjUgMC4xLTQuNyA0LjItMTAuOSAzLjYtNS40IDUuNy04LjQgNi44LTExIDAgMCAwLjYtMS42IDAuNi00LjFDNTcuMiA2LjkgNDcgMS4xIDM2IDEuMVpNMzEuOSAxMS45Yy0zLjIgMC01LjYgNC4yLTUuNSA2LjIgMC4yIDQtNC40IDMuOC00LjQgMC42IDAtNS4zIDIuOC0xMC4zIDguNS0xMC45QzM0LjYgNy4zIDM0LjYgMTEuOSAzMS45IDExLjlaTTQzLjYgNTVoLTE1Yy0xLjEgMC0yIDAuOS0yIDJ2MWMwIDEuMSAwLjkgMiAyIDJoMTVjMS4xIDAgMi0wLjkgMi0ydi0xQzQ1LjYgNTUuOSA0NC43IDU1IDQzLjYgNTVaTTM5LjEgNjhoLTZjLTAuOCAwLTEuNSAwLjctMS41IDEuNXMxLjIgMS41IDIgMS41aDVjMC44IDAgMi0wLjcgMi0xLjVTMzkuOSA2OCAzOS4xIDY4WlwiLz48L3N2Zz4nLFxyXG5cdFx0XHRJRHMuT3ZlcmFsbElkZWFUZXh0LCBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuSWRlYUZvcm0uQW5jaG9yKSk7XHJcblx0fVxyXG5cclxuXHRpZiAoRmVlZGJhY2tUeXBlLkJ1ZyBpbiBmb3JtVGVtcGxhdGVzKSB7XHJcblx0XHR3cmFwcGVyLmNoaWxkcmVuLnB1c2goZ2VuZXJhdGVPdmVyYWxsQW5jaG9yKElEcy5PdmVyYWxsQnVnQW5jaG9yLCBJRHMuT3ZlcmFsbEJ1Z0ltYWdlLFxyXG5cdFx0XHQvLyBUaGUgc3ZnIGNvZGUgZm9yIHRoZSBpbWFnZVxyXG5cdFx0XHQvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXHJcblx0XHRcdCc8c3ZnIHZpZXdCb3g9XCIxNTAgMTAwIDE3NDggMTc0OFwiIHdpZHRoPVwiMjRweFwiIGhlaWdodD1cIjI0cHhcIiBmb2N1c2FibGU9XCJmYWxzZVwiPjxwYXRoIGQ9XCJNMTgyNCAxMDg4cTAgMjYtMTkgNDV0LTQ1IDE5aC0yMjRxMCAxNzEtNjcgMjkwbDIwOCAyMDlxMTkgMTkgMTkgNDV0LTE5IDQ1cS0xOCAxOS00NSAxOXQtNDUtMTlsLTE5OC0xOTdxLTUgNS0xNSAxM3QtNDIgMjguNS02NSAzNi41LTgyIDI5LTk3IDEzdi04OTZoLTEyOHY4OTZxLTUxIDAtMTAxLjUtMTMuNXQtODctMzMtNjYtMzktNDMuNS0zMi41bC0xNS0xNC0xODMgMjA3cS0yMCAyMS00OCAyMS0yNCAwLTQzLTE2LTE5LTE4LTIwLjUtNDQuNXQxNS41LTQ2LjVsMjAyLTIyN3EtNTgtMTE0LTU4LTI3NGgtMjI0cS0yNiAwLTQ1LTE5dC0xOS00NSAxOS00NSA0NS0xOWgyMjR2LTI5NGwtMTczLTE3M3EtMTktMTktMTktNDV0MTktNDUgNDUtMTkgNDUgMTlsMTczIDE3M2g4NDRsMTczLTE3M3ExOS0xOSA0NS0xOXQ0NSAxOSAxOSA0NS0xOSA0NWwtMTczIDE3M3YyOTRoMjI0cTI2IDAgNDUgMTl0MTkgNDV6bS00ODAtNTc2aC02NDBxMC0xMzMgOTMuNS0yMjYuNXQyMjYuNS05My41IDIyNi41IDkzLjUgOTMuNSAyMjYuNXpcIi8+PC9zdmc+JyxcclxuXHRcdFx0SURzLk92ZXJhbGxCdWdUZXh0LCBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuQnVnRm9ybS5BbmNob3IpKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB3cmFwcGVyLmNoaWxkcmVuO1xyXG59XHJcblxyXG4vKipcclxuICogR2VuZXJhdGVzIGEgUmVuZGVyZXIuSVVJQXNKc29uIG9iamVjdCB0aGF0IGhvbGRzIGFuIGFuY2hvciB0aGF0IHdpbGwgYmUgdXNlZCBvbiB0aGUgYmVsbHliYW5kLlxyXG4gKiBAcGFyYW0gb3ZlcmFsbEFuY2hvcklEIHRoZSBvdmVyYWxsIGFuY2hvciBpZFxyXG4gKiBAcGFyYW0gb3ZlcmFsbEltYWdlSUQgdGhlIGltYWdlIGlkXHJcbiAqIEBwYXJhbSBpbWFnZUNsYXNzIHRoZSBpbWFnZSBjbGFzcyAoaWNvbilcclxuICogQHBhcmFtIG92ZXJhbGxUZXh0SUQgdGhlIGlkIGZvciB0ZXh0IGJveFxyXG4gKiBAcGFyYW0gdWlTdHJpbmcgdGhlIHN0cmluZyB0byBkaXNwbGF5XHJcbiAqL1xyXG5mdW5jdGlvbiBnZW5lcmF0ZU92ZXJhbGxBbmNob3IoXHJcblx0b3ZlcmFsbEFuY2hvcklEOiBzdHJpbmcsIG92ZXJhbGxJbWFnZUlEOiBzdHJpbmcsIHN2Z0ltYWdlOiBzdHJpbmcsXHJcblx0b3ZlcmFsbFRleHRJRDogc3RyaW5nLCB1aVN0cmluZzogc3RyaW5nKTogUmVuZGVyZXIuSVVJQXNKc29uIHtcclxuXHRyZXR1cm4ge1xyXG5cdFx0YXR0cmlidXRlczpcclxuXHRcdFtcclxuXHRcdFx0eyBuYW1lOiBBdHRyaWJ1dGVOYW1lLlR5cGUsIHZhbHVlOiBBdHRyaWJ1dGVWYWx1ZS5CdXR0b24gfSxcclxuXHRcdF0sXHJcblx0XHRjaGlsZHJlbjpcclxuXHRcdFtcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNsYXNzZXM6IFtDbGFzc2VzLk92ZXJhbGxJbWFnZV0sXHJcblx0XHRcdFx0aWQ6IG92ZXJhbGxJbWFnZUlELFxyXG5cdFx0XHRcdGlubmVySFRNTDogc3ZnSW1hZ2UsXHJcblx0XHRcdFx0dGFnOiBUYWdzLkRpdixcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNsYXNzZXM6IFtDbGFzc2VzLkZvbnRTdWJ0aXRsZSwgQ2xhc3Nlcy5PdmVyYWxsVGV4dF0sXHJcblx0XHRcdFx0aWQ6IG92ZXJhbGxUZXh0SUQsXHJcblx0XHRcdFx0aW5uZXJUZXh0OiB1aVN0cmluZyxcclxuXHRcdFx0fSxcclxuXHRcdF0sXHJcblx0XHRjbGFzc2VzOiBbQ2xhc3Nlcy5PdmVyYWxsQW5jaG9yLCBDbGFzc2VzLlRleHRBbGlnbkxlZnRdLFxyXG5cdFx0aWQ6IG92ZXJhbGxBbmNob3JJRCxcclxuXHRcdHRhZzogVGFncy5CdXR0b24sXHJcblx0fTtcclxufVxyXG4iLCLvu78vKipcclxuICogVGFiRm9jdXMudHNcclxuICpcclxuICogTW9kdWxlIHRvIGhhbmRsZSB0YWIgYW5kIHNoaWZ0IHRhYiBmb2N1c1xyXG4gKi9cclxuXHJcbmltcG9ydCB7SURzLCBDbGFzc2VzfSBmcm9tIFwiLi8uLi8uLi9Db25zdGFudHNcIjtcclxuXHJcbi8qKlxyXG4gKiBLZWVwcyB0YWJzIGFuZCBzaGlmdCB0YWJzIGZvY3VzIG9uIHZpc2libGUgZWxlbWVudHMgb2YgdGhlIGZlZWRiYWNrIGRpYWxvZ1xyXG4gKiBUaGlzIHByZXZlbnRzIHRhYnMgYW5kIHNoaWZ0IHRhYnMgY3ljbGUgZm9jdXMgdG8gZWxlbWVudHMgb2YgdGhlIGJhY2tncm91bmQgbWFpbiBwYWdlLlxyXG4gKiBAcGFyYW0gZm9jdXNlZEVsZW1lbnQgVGhlIGluLWZvY3VzIGVsZW1lbnQgb2JqZWN0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY3ljbGVUYWJGb2N1cyhmb2N1c2VkRWxlbWVudDogRWxlbWVudCk6IHZvaWQge1xyXG5cdGxldCBlbGVtZW50cyA9IGdldFRhYmJhYmxlRWxlbWVudHMoKTtcclxuXHJcblx0Ly8gd2hlbiBhIHRhYiBsYW5kcyBvbiB0aGUgbGFzdCBkdW1teSB0YWJiYWJsZSBlbGVtZW50LCBzZXQgZm9jdXMgdG8gdGhlIGZpcnN0XHJcblx0Ly8gdmlzaWJsZSBlbGVtZW50IHdoaWNoIGlzIHRoZSBvbmUgYWZ0ZXIgdGhlIGZpcnN0IGR1bW15IHRhYmJhYmxlIGVsZW1lbnRcclxuXHRpZiAoZm9jdXNlZEVsZW1lbnQuaWQgPT09IElEcy5MYXN0VGFiYmFibGUpIHtcclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0bGV0IGVsZW1lbnQgPSAoPEhUTUxFbGVtZW50PiBlbGVtZW50c1tpXSk7XHJcblxyXG5cdFx0XHRpZiAoZWxlbWVudC5pZCA9PT0gSURzLkZpcnN0VGFiYmFibGUgfHwgIWNoZWNrVmlzaWJsZShlbGVtZW50KSkge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRlbGVtZW50LmZvY3VzKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdC8vIHdoZW4gYSBzaGlmdCB0YWIgbGFuZHMgb24gdGhlIGZpcnN0IGR1bW15IHRhYmJhYmxlIGVsZW1lbnQsIHNldCBmb2N1cyB0byB0aGUgbGFzdFxyXG5cdFx0Ly8gdmlzaWJsZSBlbGVtZW50IHdoaWNoIGlzIHRoZSBvbmUgYmVmb3JlIHRoZSBsYXN0IGR1bW15IHRhYmJhYmxlIGVsZW1lbnRcclxuXHR9IGVsc2UgaWYgKGZvY3VzZWRFbGVtZW50LmlkID09PSBJRHMuRmlyc3RUYWJiYWJsZSkge1xyXG5cdFx0Zm9yIChsZXQgaSA9IGVsZW1lbnRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcblx0XHRcdGxldCBlbGVtZW50ID0gKDxIVE1MRWxlbWVudD4gZWxlbWVudHNbaV0pO1xyXG5cclxuXHRcdFx0aWYgKGVsZW1lbnQuaWQgPT09IElEcy5MYXN0VGFiYmFibGUgfHwgIWNoZWNrVmlzaWJsZShlbGVtZW50KSkge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRlbGVtZW50LmZvY3VzKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgbGlzdCBvZiB0YWJiYWJsZSBlbGVtZW50cy5cclxuICogQHJldHVybnMge05vZGVMaXN0T2Y8RWxlbWVudD59IGxpc3Qgb2YgdGFiYmFibGUgZWxlbWVudHNcclxuICovXHJcbmZ1bmN0aW9uIGdldFRhYmJhYmxlRWxlbWVudHMoKTogTm9kZUxpc3RPZjxFbGVtZW50PiB7XHJcblx0Y29uc3QgdGFiYmFibGVTZWxlY3RvciA9IFwiYVtocmVmXSwgYXJlYVtocmVmXSwgaW5wdXQ6bm90KFtkaXNhYmxlZF0pOm5vdChbdGFiaW5kZXg9XFwnLTFcXCddKSwgXCIgK1xyXG5cdFx0XCJidXR0b246bm90KFtkaXNhYmxlZF0pOm5vdChbdGFiaW5kZXg9XFwnLTFcXCddKSwgc2VsZWN0Om5vdChbZGlzYWJsZWRdKTpub3QoW3RhYmluZGV4PVxcJy0xXFwnXSksIFwiICtcclxuXHRcdFwidGV4dGFyZWE6bm90KFtkaXNhYmxlZF0pOm5vdChbdGFiaW5kZXggPVxcJy0xXFwnXSksIFwiICtcclxuXHRcdFwib2JqZWN0LCAqW3RhYmluZGV4XTpub3QoW3RhYmluZGV4PVxcJy0xXFwnXSksICpbY29udGVudGVkaXRhYmxlPXRydWVdXCI7XHJcblxyXG5cdHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChJRHMuTWFpbkNvbnRhaW5lcikucXVlcnlTZWxlY3RvckFsbCh0YWJiYWJsZVNlbGVjdG9yKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgdmlzaWJpbGl0eSBvZiBhbiBlbGVtZW50IGJ5IGluc3BlY3RpbmcgdGhlIGVsZW1lbnQncyBwYXJlbnQgY2xhc3MgbmFtZSBmb3IgdmlzaWJsZS9oaWRkZW4gdmFsdWUuXHJcbiAqIFdhbGsgdXAgdGhlIHBhcmVudCBjaGFpbiBpZiBuZWVkZWQuXHJcbiAqIEBwYXJhbSBlbGVtZW50IFRoZSBlbGVtZW50IG9iamVjdFxyXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gd2hldGhlciB0aGUgZWxlbWVudCBpcyB2aXNpYmxlXHJcbiAqL1xyXG5mdW5jdGlvbiBjaGVja1Zpc2libGUoZWxlbWVudDogSFRNTEVsZW1lbnQpOiBib29sZWFuIHtcclxuXHRpZiAoIWVsZW1lbnQucGFyZW50RWxlbWVudCkge1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0Ly8gZG9uJ3QgYm90aGVyIGlmIHBhcmVudCBlbGVtZW50IGlkIGlzIGp1c3Qgd2hpdGVzcGFjZSBvciBlbXB0eVxyXG5cdGlmICgvXFxTLy50ZXN0KGVsZW1lbnQucGFyZW50RWxlbWVudC5pZCkpIHtcclxuXHRcdGlmIChlbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lLmluZGV4T2YoQ2xhc3Nlcy5WaXNpYmxlKSA+PSAwKSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChlbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lLmluZGV4T2YoQ2xhc3Nlcy5IaWRkZW4pID49IDApIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIGNoZWNrVmlzaWJsZShlbGVtZW50LnBhcmVudEVsZW1lbnQpO1xyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBDYXRlZ29yaWVzRHJvcGRvd24udHNcclxuICpcclxuICogQSBtb2R1bGUgdG8gcmVuZGVyIHRoZSBjYXRlZ29yaWVzIGRyb3Bkb3duXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgVUlTdHJpbmdzIGZyb20gXCIuLy4uL1VJU3RyaW5ncy9VSVN0cmluZ3NcIjtcclxuaW1wb3J0ICogYXMgQ29uc3RhbnRzIGZyb20gXCIuLy4uL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQge0lVSUFzSnNvbn0gZnJvbSBcIi4vUmVuZGVyZXJcIjtcclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZSBjdXN0b20gY2F0ZWdvcmllcyBkcm9wLWRvd24gbGlzdC4gVGhlIGxpc3Qgd2lsbCBjb250YWluIGp1c3QgdGhlXHJcbiAqIHBsYWNlaG9sZGVyIHN0cmluZyBpZiBjdXN0b21DYXRlZ29yaWVzIGNvbnRhaW5zIG5vIHZhbHVlLlxyXG4gKiBAcGFyYW0gY3VzdG9tQ2F0ZWdvcmllcyBjYXRlZ29yeSB2YWx1ZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZShjdXN0b21DYXRlZ29yaWVzOiBzdHJpbmdbXSk6IElVSUFzSnNvbltdIHtcclxuXHRsZXQgY2F0ZWdvcmllcyA9IGN1c3RvbUNhdGVnb3JpZXMgPyBjdXN0b21DYXRlZ29yaWVzIDogW107XHJcblxyXG5cdGxldCByZXN1bHQ6IElVSUFzSnNvbltdID0gW3tcclxuXHRcdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IFwic2VsZWN0ZWRcIiwgdmFsdWU6IFwidHJ1ZVwiIH1dLFxyXG5cdFx0aW5uZXJUZXh0OiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuRm9ybS5DYXRlZ29yeVBsYWNlaG9sZGVyLFxyXG5cdFx0dGFnOiBDb25zdGFudHMuVGFncy5PcHRpb24sXHJcblx0fV07XHJcblxyXG5cdGZvciAobGV0IGNhdGVnb3J5IG9mIGNhdGVnb3JpZXMpIHtcclxuXHRcdHJlc3VsdC5wdXNoKHtcclxuXHRcdFx0aW5uZXJUZXh0OiBjYXRlZ29yeSxcclxuXHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5PcHRpb24sXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHJldHVybiByZXN1bHQ7XHJcbn1cclxuIiwiLyoqXHJcbiAqIENob2ljZUdyb3VwQ29udHJvbC50c1xyXG4gKlxyXG4gKiBBIG1vZHVsZSBmb3IgcmVuZGVyaW5nIGEgY2hvaWNlIGdyb3VwLlxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIENvbnN0YW50cyBmcm9tIFwiLi8uLi9Db25zdGFudHNcIjtcclxuaW1wb3J0ICogYXMgUmVuZGVyZXIgZnJvbSBcIi4vUmVuZGVyZXJcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVJhZGlvR3JvdXAoaWQ6IHN0cmluZywgcXVlc3Rpb246IHN0cmluZyxcclxuXHRjaG9pY2VzOiBbbnVtYmVyLCBzdHJpbmddW10pOiBSZW5kZXJlci5JVUlBc0pzb24ge1xyXG5cdGxldCBmaWVsZFNldDogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdFx0Y2hpbGRyZW46IFtcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5Gb250U3ViVGV4dF0sXHJcblx0XHRcdFx0aW5uZXJUZXh0OiBxdWVzdGlvbixcclxuXHRcdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLkxlZ2VuZCxcclxuXHRcdFx0fSxcclxuXHRcdF0sXHJcblx0XHR0YWc6IENvbnN0YW50cy5UYWdzLkZpZWxkU2V0LFxyXG5cdH07XHJcblxyXG5cdGZvciAobGV0IGNob2ljZSBvZiBjaG9pY2VzKSB7XHJcblx0XHRBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShmaWVsZFNldC5jaGlsZHJlbiwgZ2VuZXJhdGVSYWRpb0J1dHRvbihjaG9pY2VbMF0udG9TdHJpbmcoKSwgY2hvaWNlWzFdLCBpZCkpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGNoaWxkcmVuOiBbZmllbGRTZXRdLFxyXG5cdFx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLkNob2ljZUdyb3VwXSxcclxuXHRcdGlkOiBpZCxcclxuXHR9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZW5lcmF0ZVJhZGlvQnV0dG9uKHZhbHVlOiBzdHJpbmcsIGxhYmVsOiBzdHJpbmcsIGlkOiBzdHJpbmcpOiBSZW5kZXJlci5JVUlBc0pzb25bXSB7XHJcblx0cmV0dXJuIFtcclxuXHRcdHtcclxuXHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVHlwZSwgdmFsdWU6IENvbnN0YW50cy5BdHRyaWJ1dGVWYWx1ZS5SYWRpbyB9LFxyXG5cdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmFsdWUsIHZhbHVlOiB2YWx1ZSB9LFxyXG5cdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTmFtZSwgdmFsdWU6IGlkIH0sXHJcblx0XHRcdF0sXHJcblx0XHRcdGlkOiB2YWx1ZSxcclxuXHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5JbnB1dCxcclxuXHRcdH0sXHJcblx0XHR7XHJcblx0XHRcdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLkZvciwgdmFsdWU6IHZhbHVlIH1dLFxyXG5cdFx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGNoaWxkcmVuOiBbeyB0YWc6IENvbnN0YW50cy5UYWdzLlNwYW4gfV0sXHJcblx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuQ2hvaWNlR3JvdXBJY29uXSxcclxuXHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuU3BhbixcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdGNsYXNzZXM6IFtcIm9iZi1DaG9pY2VHcm91cExhYmVsXCJdLFxyXG5cdFx0XHRcdFx0aW5uZXJIVE1MOiBsYWJlbCxcclxuXHRcdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuU3BhbixcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRdLFxyXG5cdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHRdLFxyXG5cdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLkxhYmVsLFxyXG5cdFx0fSxcclxuXHRdO1xyXG59XHJcbiIsIu+7vy8qKlxyXG4gKiBSYXRpbmdDb250cm9sLnRzXHJcbiAqXHJcbiAqIEEgbW9kdWxlIGZvciBhIHJhdGluZyBjb250cm9sLlxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIENvbnN0YW50cyBmcm9tIFwiLi8uLi9Db25zdGFudHNcIjtcclxuaW1wb3J0ICogYXMgUmVuZGVyZXIgZnJvbSBcIi4vUmVuZGVyZXJcIjtcclxuXHJcbmxldCBzdGFySWQ6IHN0cmluZyA9IFwib2JmLXN0YXJcIjtcclxuXHJcbmxldCBzdGFyRGVmaW5pdGlvbjogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdGNoaWxkcmVuOiBbXHJcblx0XHR7XHJcblx0XHRcdGF0dHJpYnV0ZXM6IFtcclxuXHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLklkLCB2YWx1ZTogc3RhcklkIH0sXHJcblx0XHRcdFx0eyBuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5YLCB2YWx1ZTogXCIwXCIgfSxcclxuXHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlksIHZhbHVlOiBcIjBcIiB9LFxyXG5cdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuV2lkdGgsIHZhbHVlOiBcIjEwNVwiIH0sXHJcblx0XHRcdFx0eyBuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5IZWlnaHQsIHZhbHVlOiBcIjEwMFwiIH0sXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuUG9pbnRzLFxyXG5cdFx0XHRcdFx0dmFsdWU6IFwiNTIuNSwgODAuMyA4NCwgMTAwIDc2LjMsIDYzIDEwNSwgMzggNjcuMiwgMzUgNTIuNSwgMCAzNy44LCAzNSAwLCAzOCAyOC43LCA2MyAyMCwgMTAwIDUyLjUsIDgwLjNcIixcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRdLFxyXG5cdFx0XHRpZDogc3RhcklkLFxyXG5cdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLlBvbHlnb24sXHJcblx0XHR9LFxyXG5cdF0sXHJcblx0dGFnOiBDb25zdGFudHMuVGFncy5EZWZzLFxyXG59O1xyXG5cclxubGV0IGZpcnN0U3RhcjogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLnhsaW5rSHJlZiwgdmFsdWU6IGAjJHtzdGFySWR9YCB9XSxcclxuXHR0YWc6IENvbnN0YW50cy5UYWdzLlVzZSxcclxufTtcclxuXHJcbmxldCBzZWNvbmRTdGFyOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0YXR0cmlidXRlczogW1xyXG5cdFx0eyBuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS54bGlua0hyZWYsIHZhbHVlOiBgIyR7c3RhcklkfWAgfSxcclxuXHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVHJhbnNmb3JtLCB2YWx1ZTogXCJ0cmFuc2xhdGUoMTA1IDApXCIgfSxcclxuXHRdLFxyXG5cdHRhZzogQ29uc3RhbnRzLlRhZ3MuVXNlLFxyXG59O1xyXG5cclxubGV0IHRoaXJkU3RhcjogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdGF0dHJpYnV0ZXM6IFtcclxuXHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUueGxpbmtIcmVmLCB2YWx1ZTogYCMke3N0YXJJZH1gIH0sXHJcblx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlRyYW5zZm9ybSwgdmFsdWU6IFwidHJhbnNsYXRlKDIxMCAwKVwiIH0sXHJcblx0XSxcclxuXHR0YWc6IENvbnN0YW50cy5UYWdzLlVzZSxcclxufTtcclxuXHJcbmxldCBmb3VydGhTdGFyOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0YXR0cmlidXRlczogW1xyXG5cdFx0eyBuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS54bGlua0hyZWYsIHZhbHVlOiBgIyR7c3RhcklkfWAgfSxcclxuXHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVHJhbnNmb3JtLCB2YWx1ZTogXCJ0cmFuc2xhdGUoMzE1IDApXCIgfSxcclxuXHRdLFxyXG5cdHRhZzogQ29uc3RhbnRzLlRhZ3MuVXNlLFxyXG59O1xyXG5cclxubGV0IGZpZnRoU3RhcjogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdGF0dHJpYnV0ZXM6IFtcclxuXHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUueGxpbmtIcmVmLCB2YWx1ZTogYCMke3N0YXJJZH1gIH0sXHJcblx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlRyYW5zZm9ybSwgdmFsdWU6IFwidHJhbnNsYXRlKDQyMCAwKVwiIH0sXHJcblx0XSxcclxuXHR0YWc6IENvbnN0YW50cy5UYWdzLlVzZSxcclxufTtcclxuXHJcbmxldCBlbXB0eVN0YXJzOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmlld0JveCwgdmFsdWU6IFwiMCAwIDUyNSAxMDBcIiB9XSxcclxuXHRjaGlsZHJlbjogW3N0YXJEZWZpbml0aW9uLCBmaXJzdFN0YXIsIHNlY29uZFN0YXIsIHRoaXJkU3RhciwgZm91cnRoU3RhciwgZmlmdGhTdGFyXSxcclxuXHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuUmF0aW5nR3JhcGhpY10sXHJcblx0dGFnOiBDb25zdGFudHMuVGFncy5TdmcsXHJcbn07XHJcblxyXG5sZXQgb25lRmlsbGVkU3RhcjogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlZpZXdCb3gsIHZhbHVlOiBcIjAgMCAxMDUgMTAwXCIgfV0sXHJcblx0Y2hpbGRyZW46IFtzdGFyRGVmaW5pdGlvbiwgZmlyc3RTdGFyXSxcclxuXHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuUmF0aW5nR3JhcGhpYywgQ29uc3RhbnRzLkNsYXNzZXMuUmF0aW5nR3JhcGhpY0ZpbGxlZF0sXHJcblx0dGFnOiBDb25zdGFudHMuVGFncy5TdmcsXHJcbn07XHJcblxyXG5sZXQgdHdvRmlsbGVkU3RhcjogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlZpZXdCb3gsIHZhbHVlOiBcIjAgMCAyMTAgMTAwXCIgfV0sXHJcblx0Y2hpbGRyZW46IFtzdGFyRGVmaW5pdGlvbiwgZmlyc3RTdGFyLCBzZWNvbmRTdGFyXSxcclxuXHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuUmF0aW5nR3JhcGhpYywgQ29uc3RhbnRzLkNsYXNzZXMuUmF0aW5nR3JhcGhpY0ZpbGxlZF0sXHJcblx0dGFnOiBDb25zdGFudHMuVGFncy5TdmcsXHJcbn07XHJcblxyXG5sZXQgdGhyZWVGaWxsZWRTdGFyOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmlld0JveCwgdmFsdWU6IFwiMCAwIDMxNSAxMDBcIiB9XSxcclxuXHRjaGlsZHJlbjogW3N0YXJEZWZpbml0aW9uLCBmaXJzdFN0YXIsIHNlY29uZFN0YXIsIHRoaXJkU3Rhcl0sXHJcblx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLlJhdGluZ0dyYXBoaWMsIENvbnN0YW50cy5DbGFzc2VzLlJhdGluZ0dyYXBoaWNGaWxsZWRdLFxyXG5cdHRhZzogQ29uc3RhbnRzLlRhZ3MuU3ZnLFxyXG59O1xyXG5cclxubGV0IGZvdXJGaWxsZWRTdGFyOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmlld0JveCwgdmFsdWU6IFwiMCAwIDQyMCAxMDBcIiB9XSxcclxuXHRjaGlsZHJlbjogW3N0YXJEZWZpbml0aW9uLCBmaXJzdFN0YXIsIHNlY29uZFN0YXIsIHRoaXJkU3RhciwgZm91cnRoU3Rhcl0sXHJcblx0Y2xhc3NlczogW0NvbnN0YW50cy5DbGFzc2VzLlJhdGluZ0dyYXBoaWMsIENvbnN0YW50cy5DbGFzc2VzLlJhdGluZ0dyYXBoaWNGaWxsZWRdLFxyXG5cdHRhZzogQ29uc3RhbnRzLlRhZ3MuU3ZnLFxyXG59O1xyXG5cclxubGV0IGZpdmVGaWxsZWRTdGFyOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0YXR0cmlidXRlczogW3sgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmlld0JveCwgdmFsdWU6IFwiMCAwIDUyNSAxMDBcIiB9XSxcclxuXHRjaGlsZHJlbjogW3N0YXJEZWZpbml0aW9uLCBmaXJzdFN0YXIsIHNlY29uZFN0YXIsIHRoaXJkU3RhciwgZm91cnRoU3RhciwgZmlmdGhTdGFyXSxcclxuXHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuUmF0aW5nR3JhcGhpYywgQ29uc3RhbnRzLkNsYXNzZXMuUmF0aW5nR3JhcGhpY0ZpbGxlZF0sXHJcblx0dGFnOiBDb25zdGFudHMuVGFncy5TdmcsXHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGUoaWQ6IHN0cmluZyk6IFJlbmRlcmVyLklVSUFzSnNvbiB7XHJcblx0cmV0dXJuIHtcclxuXHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdGVtcHR5U3RhcnMsXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlR5cGUsIHZhbHVlOiBcInJhZGlvXCIgfSxcclxuXHRcdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTmFtZSwgdmFsdWU6IGlkIH0sXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlZhbHVlLCB2YWx1ZTogXCIxXCIgfSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuSW5wdXQsXHJcblx0XHRcdH0sXHJcblx0XHRcdG9uZUZpbGxlZFN0YXIsXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlR5cGUsIHZhbHVlOiBcInJhZGlvXCIgfSxcclxuXHRcdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTmFtZSwgdmFsdWU6IGlkIH0sXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlZhbHVlLCB2YWx1ZTogXCIyXCIgfSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuSW5wdXQsXHJcblx0XHRcdH0sXHJcblx0XHRcdHR3b0ZpbGxlZFN0YXIsXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlR5cGUsIHZhbHVlOiBcInJhZGlvXCIgfSxcclxuXHRcdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTmFtZSwgdmFsdWU6IGlkIH0sXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlZhbHVlLCB2YWx1ZTogXCIzXCIgfSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuSW5wdXQsXHJcblx0XHRcdH0sXHJcblx0XHRcdHRocmVlRmlsbGVkU3RhcixcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGF0dHJpYnV0ZXM6IFtcclxuXHRcdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVHlwZSwgdmFsdWU6IFwicmFkaW9cIiB9LFxyXG5cdFx0XHRcdFx0eyBuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5OYW1lLCB2YWx1ZTogaWQgfSxcclxuXHRcdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuVmFsdWUsIHZhbHVlOiBcIjRcIiB9LFxyXG5cdFx0XHRcdF0sXHJcblx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5JbnB1dCxcclxuXHRcdFx0fSxcclxuXHRcdFx0Zm91ckZpbGxlZFN0YXIsXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlR5cGUsIHZhbHVlOiBcInJhZGlvXCIgfSxcclxuXHRcdFx0XHRcdHsgbmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuTmFtZSwgdmFsdWU6IGlkIH0sXHJcblx0XHRcdFx0XHR7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlZhbHVlLCB2YWx1ZTogXCI1XCIgfSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdHRhZzogQ29uc3RhbnRzLlRhZ3MuSW5wdXQsXHJcblx0XHRcdH0sXHJcblx0XHRcdGZpdmVGaWxsZWRTdGFyLFxyXG5cdFx0XSxcclxuXHRcdGNsYXNzZXM6IFtDb25zdGFudHMuQ2xhc3Nlcy5SYXRpbmddLFxyXG5cdFx0aWQ6IGlkLFxyXG5cdFx0dGFnOiBDb25zdGFudHMuVGFncy5TcGFuLFxyXG5cdH07XHJcbn1cclxuIiwi77u/LyoqXHJcbiAqIFJlbmRlcmVyLnRzXHJcbiAqXHJcbiAqIE1vZHVsZSBmb3IgcmVuZGVyaW5nIHRoZSBtYXJrdXBcclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBDb25zdGFudHMgZnJvbSBcIi4vLi4vQ29uc3RhbnRzXCI7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIGZvciBhbiBhdHRyaWJ1dGVcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUF0dHJpYnV0ZSB7XHJcblx0bmFtZTogc3RyaW5nO1xyXG5cdHZhbHVlOiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgZm9yIFVJKEhUTUwgbWFya3VwKSBhcyBqc29uXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIElVSUFzSnNvbiB7XHJcblx0aWQ/OiBzdHJpbmc7XHJcblx0dGFnPzogc3RyaW5nOyAvLyBkaXYgYnkgZGVmYXVsdFxyXG5cdGNsYXNzZXM/OiBzdHJpbmdbXTsgLy8gQ1NTIGNsYXNzXHJcblx0YXR0cmlidXRlcz86IElBdHRyaWJ1dGVbXTtcclxuXHRjaGlsZHJlbj86IElVSUFzSnNvbltdO1xyXG5cdGlubmVyVGV4dD86IHN0cmluZztcclxuXHRpbm5lckhUTUw/OiBzdHJpbmc7XHJcblx0YnJzPzogYW55OyAvLyBzaG91bGQgdGhlIGVsZW1lbnQgYW5kIGl0cyBjaGlsZHJlbiBiZSBjcmVhdGVkPyB0cnVlIGJ5IGRlZmF1bHRcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBET00gZWxlbWVudHMgZnJvbSBKc29uIHN0cnVjdHVyZVxyXG4gKiBAcGFyYW0ge1VpQXNKc29ufSBzY2hlbWEgVGhlIEpzb24gc3RydWN0dXJlXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gc3ZnIENyZWF0ZSBzdmcgZWxlbWVudCBpbnN0ZWFkIG9mIGh0bWw/XHJcbiAqIEByZXR1cm4ge0hUTUxFbGVtZW50fSBIVE1MIGVsZW1lbnRzIHdpdGggdHJlZSBzdHJ1Y3R1cmVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBlbGVtZW50RnJvbUpzb24oc2NoZW1hOiBJVUlBc0pzb24sIHN2Zz86IGJvb2xlYW4pOiBFbGVtZW50IHtcclxuXHRpZiAodHlwZW9mIHNjaGVtYS5icnMgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHNjaGVtYS5icnMgPSB0cnVlO1xyXG5cdH1cclxuXHJcblx0aWYgKCFzY2hlbWEuYnJzKSB7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblxyXG5cdGlmICghc2NoZW1hLnRhZykge1xyXG5cdFx0c2NoZW1hLnRhZyA9IENvbnN0YW50cy5UYWdzLkRpdjtcclxuXHR9XHJcblxyXG5cdGxldCBlbGVtZW50OiBFbGVtZW50O1xyXG5cclxuXHRpZiAoc2NoZW1hLnRhZyA9PT0gQ29uc3RhbnRzLlRhZ3MuU3ZnKSB7XHJcblx0XHRzdmcgPSB0cnVlO1xyXG5cdH1cclxuXHJcblx0aWYgKHN2Zykge1xyXG5cdFx0ZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIHNjaGVtYS50YWcpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChzY2hlbWEudGFnKTtcclxuXHR9XHJcblxyXG5cdGlmIChzY2hlbWEuYXR0cmlidXRlcykge1xyXG5cdFx0bGV0IGF0dHJpYnV0ZTogSUF0dHJpYnV0ZTtcclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgc2NoZW1hLmF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0YXR0cmlidXRlID0gc2NoZW1hLmF0dHJpYnV0ZXNbaV07XHJcblx0XHRcdGlmIChhdHRyaWJ1dGUubmFtZSA9PT0gQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUueGxpbmtIcmVmKSB7XHJcblx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGVOUyhcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiwgQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuSFJlZiwgYXR0cmlidXRlLnZhbHVlKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUubmFtZSwgYXR0cmlidXRlLnZhbHVlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aWYgKHNjaGVtYS5pZCkge1xyXG5cdFx0ZWxlbWVudC5pZCA9IHNjaGVtYS5pZDtcclxuXHR9XHJcblxyXG5cdGlmIChzY2hlbWEuY2xhc3Nlcykge1xyXG5cdFx0bGV0IGNvbmNhdENsYXNzZXM6IHN0cmluZyA9IHNjaGVtYS5jbGFzc2VzLmpvaW4oXCIgXCIpO1xyXG5cdFx0aWYgKHN2Zykge1xyXG5cdFx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShDb25zdGFudHMuQXR0cmlidXRlTmFtZS5DbGFzcywgY29uY2F0Q2xhc3Nlcyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRlbGVtZW50LmNsYXNzTmFtZSA9IGNvbmNhdENsYXNzZXM7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpZiAoc2NoZW1hLmlubmVyVGV4dCAmJiAhc3ZnKSB7XHJcblx0XHRlbGVtZW50LnRleHRDb250ZW50ID0gc2NoZW1hLmlubmVyVGV4dDtcclxuXHR9XHJcblxyXG5cdGlmIChzY2hlbWEuaW5uZXJIVE1MICYmICFzdmcpIHtcclxuXHRcdGVsZW1lbnQuaW5uZXJIVE1MID0gc2NoZW1hLmlubmVySFRNTDtcclxuXHR9XHJcblxyXG5cdGlmIChzY2hlbWEuY2hpbGRyZW4pIHtcclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgc2NoZW1hLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdC8vIFNvbWV0aW1lcyBJRSBtaXMtcmVwb3J0cyBsZW5ndGhcclxuXHRcdFx0bGV0IGN1cjogSVVJQXNKc29uID0gc2NoZW1hLmNoaWxkcmVuW2ldO1xyXG5cclxuXHRcdFx0aWYgKGN1cikge1xyXG5cdFx0XHRcdGxldCBjaGlsZDogRWxlbWVudCA9IGVsZW1lbnRGcm9tSnNvbihjdXIsIHN2Zyk7XHJcblxyXG5cdFx0XHRcdGlmIChjaGlsZCkge1xyXG5cdFx0XHRcdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChjaGlsZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gZWxlbWVudDtcclxufVxyXG4iLCLvu78vKipcclxuICogU3Bpbm5lci50c1xyXG4gKlxyXG4gKiBBIG1vZHVsZSBmb3IgYSBzcGlubmVyLlxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIENvbnN0YW50cyBmcm9tIFwiLi8uLi9Db25zdGFudHNcIjtcclxuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSBcIi4vVXRpbHNcIjtcclxuXHJcbmludGVyZmFjZSBJQ2lyY2xlT2JqZWN0IHtcclxuXHRlbGVtZW50OiBIVE1MRGl2RWxlbWVudDtcclxuXHRqOiBudW1iZXI7XHJcbn1cclxuXHJcbmNvbnN0IGFuaW1hdGlvblNwZWVkID0gOTA7XHJcbmNvbnN0IG51bUNpcmNsZXMgPSA4O1xyXG5jb25zdCBvZmZzZXRTaXplID0gMC4yO1xyXG5jb25zdCBwYXJlbnRTaXplID0gMzQ7XHJcbmNvbnN0IGZhZGVJbmNyZW1lbnQgPSAxIC8gbnVtQ2lyY2xlcztcclxuXHJcbmV4cG9ydCBjbGFzcyBTcGlubmVyIHtcclxuXHRwcml2YXRlIGNpcmNsZU9iamVjdHM6IElDaXJjbGVPYmplY3RbXSA9IFtdO1xyXG5cdHByaXZhdGUgaW50ZXJ2YWw6IE5vZGVKUy5UaW1lcjtcclxuXHRwcml2YXRlIHNwaW5uZXJJZDogc3RyaW5nO1xyXG5cdHByaXZhdGUgc3Bpbm5lcjogSFRNTEVsZW1lbnQ7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENvbnN0cnVjdG9yXHJcblx0ICogQHBhcmFtIGlkIGlkIG9mIHRoZSBlbGVtZW50IHRvIGF0dGFjaCB0aGUgc3Bpbm5lciB0b1xyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKGlkOiBzdHJpbmcpIHtcclxuXHRcdHRoaXMuc3Bpbm5lcklkID0gaWQ7XHJcblx0XHR0aGlzLnNwaW5uZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnNwaW5uZXJJZCk7XHJcblx0XHR0aGlzLmNyZWF0ZUNpcmNsZXNBbmRBcnJhbmdlKCk7XHJcblx0XHR0aGlzLmluaXRpYWxpemVPcGFjaXRpZXMoKTtcclxuXHRcdHRoaXMuc3RhcnQoKTtcclxuXHRcdFV0aWxzLnNldEVsZW1lbnRWaXNpYmlsaXR5KGlkLCB0cnVlKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIERlc3Ryb3lzIHRoZSBzcGlubmVyXHJcblx0ICovXHJcblx0cHVibGljIGRlc3Ryb3koKSB7XHJcblx0XHRVdGlscy5zZXRFbGVtZW50VmlzaWJpbGl0eSh0aGlzLnNwaW5uZXJJZCwgZmFsc2UpO1xyXG5cdFx0dGhpcy5zdG9wKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTdGFydHMgdGhlIGFuaW1hdGlvblxyXG5cdCAqL1xyXG5cdHByaXZhdGUgc3RhcnQoKSB7XHJcblx0XHR0aGlzLnN0b3AoKTtcclxuXHRcdHRoaXMuaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdFx0bGV0IGkgPSB0aGlzLmNpcmNsZU9iamVjdHMubGVuZ3RoO1xyXG5cdFx0XHRcdHdoaWxlIChpLS0pIHtcclxuXHRcdFx0XHRcdGZhZGUodGhpcy5jaXJjbGVPYmplY3RzW2ldKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHRcdGFuaW1hdGlvblNwZWVkKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFN0b3BzIHRoZSBhbmltYXRpb25cclxuXHQgKi9cclxuXHRwcml2YXRlIHN0b3AoKSB7XHJcblx0XHRjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBjcmVhdGVDaXJjbGVzQW5kQXJyYW5nZSgpIHtcclxuXHRcdGxldCBhbmdsZSA9IDA7XHJcblx0XHRsZXQgb2Zmc2V0ID0gcGFyZW50U2l6ZSAqIG9mZnNldFNpemU7XHJcblx0XHRsZXQgc3RlcCA9ICgyICogTWF0aC5QSSkgLyBudW1DaXJjbGVzO1xyXG5cdFx0bGV0IGkgPSBudW1DaXJjbGVzO1xyXG5cdFx0bGV0IGNpcmNsZU9iamVjdDogSUNpcmNsZU9iamVjdDtcclxuXHRcdGxldCByYWRpdXMgPSAocGFyZW50U2l6ZSAtIG9mZnNldCkgKiAwLjU7XHJcblxyXG5cdFx0d2hpbGUgKGktLSkge1xyXG5cdFx0XHRsZXQgY2lyY2xlOiBIVE1MRGl2RWxlbWVudCA9IGNyZWF0ZUNpcmNsZSgpO1xyXG5cdFx0XHRsZXQgeCA9IE1hdGgucm91bmQocGFyZW50U2l6ZSAqIDAuNSArIHJhZGl1cyAqIE1hdGguY29zKGFuZ2xlKSAtIGNpcmNsZS5jbGllbnRXaWR0aCAqIDAuNSkgLSBvZmZzZXQgKiAwLjU7XHJcblx0XHRcdGxldCB5ID0gTWF0aC5yb3VuZChwYXJlbnRTaXplICogMC41ICsgcmFkaXVzICogTWF0aC5zaW4oYW5nbGUpIC0gY2lyY2xlLmNsaWVudEhlaWdodCAqIDAuNSkgLSBvZmZzZXQgKiAwLjU7XHJcblx0XHRcdHRoaXMuc3Bpbm5lci5hcHBlbmRDaGlsZChjaXJjbGUpO1xyXG5cdFx0XHRjaXJjbGUuc3R5bGUubGVmdCA9IHggKyBcInB4XCI7XHJcblx0XHRcdGNpcmNsZS5zdHlsZS50b3AgPSB5ICsgXCJweFwiO1xyXG5cdFx0XHRhbmdsZSArPSBzdGVwO1xyXG5cdFx0XHRjaXJjbGVPYmplY3QgPSB7IGVsZW1lbnQ6IGNpcmNsZSwgajogaSB9O1xyXG5cdFx0XHR0aGlzLmNpcmNsZU9iamVjdHMucHVzaChjaXJjbGVPYmplY3QpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBpbml0aWFsaXplT3BhY2l0aWVzKCkge1xyXG5cdFx0bGV0IGkgPSAwO1xyXG5cdFx0bGV0IGogPSAxO1xyXG5cdFx0bGV0IG9wYWNpdHk6IG51bWJlcjtcclxuXHJcblx0XHRmb3IgKGk7IGkgPCBudW1DaXJjbGVzOyBpKyspIHtcclxuXHRcdFx0bGV0IGNpcmNsZU9iamVjdCA9IHRoaXMuY2lyY2xlT2JqZWN0c1tpXTtcclxuXHRcdFx0b3BhY2l0eSA9IChmYWRlSW5jcmVtZW50ICogaisrKTtcclxuXHRcdFx0c2V0T3BhY2l0eShjaXJjbGVPYmplY3QuZWxlbWVudCwgb3BhY2l0eSk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBmYWRlKGNpcmNsZU9iamVjdDogYW55KSB7XHJcblx0bGV0IG9wYWNpdHkgPSBnZXRPcGFjaXR5KGNpcmNsZU9iamVjdC5lbGVtZW50KSAtIGZhZGVJbmNyZW1lbnQ7XHJcblxyXG5cdGlmIChvcGFjaXR5IDw9IDApIHtcclxuXHRcdG9wYWNpdHkgPSAxO1xyXG5cdH1cclxuXHJcblx0c2V0T3BhY2l0eShjaXJjbGVPYmplY3QuZWxlbWVudCwgb3BhY2l0eSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldE9wYWNpdHkoZWxlbWVudDogSFRNTERpdkVsZW1lbnQpIHtcclxuXHRyZXR1cm4gcGFyc2VGbG9hdCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKFwib3BhY2l0eVwiKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldE9wYWNpdHkoZWxlbWVudDogSFRNTERpdkVsZW1lbnQsIG9wYWNpdHk6IG51bWJlcikge1xyXG5cdGVsZW1lbnQuc3R5bGUub3BhY2l0eSA9IG9wYWNpdHkudG9TdHJpbmcoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2lyY2xlKCk6IEhUTUxEaXZFbGVtZW50IHtcclxuXHRsZXQgY2lyY2xlOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcblx0Y2lyY2xlLmNsYXNzTGlzdC5hZGQoQ29uc3RhbnRzLkNsYXNzZXMuU3Bpbm5lckNpcmNsZSk7XHJcblx0Y2lyY2xlLnN0eWxlLndpZHRoID0gY2lyY2xlLnN0eWxlLmhlaWdodCA9IHBhcmVudFNpemUgKiBvZmZzZXRTaXplICsgXCJweFwiO1xyXG5cdHJldHVybiBjaXJjbGU7XHJcbn1cclxuIiwiLyoqXHJcbiAqIEV2ZW50cy50c1xyXG4gKlxyXG4gKiBBIG1vZHVsZSBmb3IgYWxsIEV2ZW50IGhhbmRsaW5nLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFRyYW5zcG9ydGVyIH0gZnJvbSBcIi4vLi4vLi4vVHJhbnNwb3J0L1RyYW5zcG9ydFwiO1xyXG5pbXBvcnQgeyBBdXRvRGlzbWlzc1ZhbHVlcywgSURzLCBLZXlzIH0gZnJvbSBcIi4vLi4vLi4vQ29uc3RhbnRzXCI7XHJcbmltcG9ydCAqIGFzIFVpVXRpbHMgZnJvbSBcIi4vLi4vVXRpbHNcIjtcclxuaW1wb3J0IHsgSU9uRGlzbWlzc0RlbGVnYXRlIH0gZnJvbSBcIi4vLi4vLi4vSU9uRGlzbWlzc0RlbGVnYXRlXCI7XHJcbmltcG9ydCB7IFNwaW5uZXIgfSBmcm9tIFwiLi8uLi9TcGlubmVyQ29udHJvbFwiO1xyXG5pbXBvcnQgKiBhcyBMb2dnaW5nIGZyb20gXCIuLy4uLy4uL0xvZ2dpbmcvTG9nZ2luZ1wiO1xyXG5pbXBvcnQgKiBhcyBDb25maWd1cmF0aW9uIGZyb20gXCIuLy4uLy4uL0NvbmZpZ3VyYXRpb24vQ29uZmlndXJhdGlvblwiO1xyXG5pbXBvcnQgKiBhcyBBcGkgZnJvbSBcIkBtcy1vZmIvb2ZmaWNlZmxvb2RnYXRlY29yZS9kaXN0L3NyYy9BcGkvQXBpXCI7XHJcblxyXG4vKipcclxuICogQ2FsbGJhY2sgZm9yIHdoZW4gdGhlIGZlZWRiYWNrIGRpYWxvZyBpcyBkaXNtaXNzZWRcclxuICovXHJcbmxldCBvbkRpc21pc3M6IElPbkRpc21pc3NEZWxlZ2F0ZTtcclxuXHJcbi8qKlxyXG4gKiBJcyB0aGUgcHJvbXB0IHVwXHJcbiAqL1xyXG5sZXQgaXNQcm9tcHRVcDogYm9vbGVhbjtcclxuXHJcbi8qKlxyXG4gKiBEaXNtaXNzIGFsbCwgaW5jbHVkaW5nIG5ldHdvcmtpbmcsIFVJLCBhbmQgZXZlbnRzXHJcbiAqIEBwYXJhbSBzdWJtaXR0ZWQgV2FzIHRoZSBjb250cm9sIHN1Ym1pdHRlZCAodHJ1ZSksIG9yIGNhbmNlbGxlZCAoZmFsc2UpP1xyXG4gKi9cclxuZnVuY3Rpb24gZGlzbWlzc0FsbChzdWJtaXR0ZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuXHR1bnJlZ2lzdGVyKCk7XHJcblx0b25EaXNtaXNzKHN1Ym1pdHRlZCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMaXN0ZW5lciB1bi1yZWdpc3RyYXRpb25cclxuICovXHJcbmZ1bmN0aW9uIHVucmVnaXN0ZXIoKTogdm9pZCB7XHJcblx0cmVtb3ZlTGlzdGVuZXJzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMaXN0IG9mIGxpc3RlbmVycyBhbmQgdGhlIGlkcyB0aGV5IGFyZSBhdHRhY2hlZCB0by4gVGhpcyBlbnN1cmVzIGFsbCBldmVudHMgYXJlIGNvcnJlY3RseSB1bnJlZ2lzdGVyZWQuXHJcbiAqL1xyXG5sZXQgbGlzdGVuZXJzTGlzdDogeyBpZDogc3RyaW5nLCBldmVudDogc3RyaW5nLCBsaXN0ZW5lcjogKGV2ZW50OiBFdmVudCkgPT4gdm9pZCB9W10gPSBbXTtcclxuXHJcbmZ1bmN0aW9uIGFkZExpc3RlbmVyKGlkOiBzdHJpbmcsIGV2ZW50OiBzdHJpbmcsIGxpc3RlbmVyOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkKTogdm9pZCB7XHJcblx0VWlVdGlscy5yZWdpc3Rlckxpc3RlbmVyKGlkLCBldmVudCwgbGlzdGVuZXIpO1xyXG5cdGxpc3RlbmVyc0xpc3QucHVzaCh7IGV2ZW50OiBldmVudCwgaWQ6IGlkLCBsaXN0ZW5lcjogbGlzdGVuZXIgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVycygpOiB2b2lkIHtcclxuXHRmb3IgKGxldCBsaXN0ZW5lciBvZiBsaXN0ZW5lcnNMaXN0KSB7XHJcblx0XHRVaVV0aWxzLnVucmVnaXN0ZXJMaXN0ZW5lcihsaXN0ZW5lci5pZCwgbGlzdGVuZXIuZXZlbnQsIGxpc3RlbmVyLmxpc3RlbmVyKTtcclxuXHR9XHJcblx0bGlzdGVuZXJzTGlzdCA9IFtdO1xyXG59XHJcblxyXG4vKipcclxuICogUmVnaXN0ZXIgZXZlbnRzIGZvciB0b2FzdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyKE9OX0RJU01JU1M6IElPbkRpc21pc3NEZWxlZ2F0ZSA9IGZ1bmN0aW9uIChzdWJtaXR0ZWQ6IGJvb2xlYW4pIHsgcmV0dXJuOyB9KSB7XHJcblx0b25EaXNtaXNzID0gT05fRElTTUlTUztcclxuXHRpc1Byb21wdFVwID0gdHJ1ZTtcclxuXHJcblx0YWRkTGlzdGVuZXIoSURzLlRvYXN0Q29udGFpbmVyLCBcImtleXVwXCIsIHRvYXN0S2V5RXZlbnRIYW5kbGVyKTtcclxuXHRhZGRMaXN0ZW5lcihJRHMuVG9hc3RDYW5jZWwsIFwiY2xpY2tcIiwgdG9hc3RDYW5jZWxIYW5kbGVyKTtcclxuXHRhZGRMaXN0ZW5lcihJRHMuVFByb21wdENvbnRhaW5lciwgXCJjbGlja1wiLCBwcm9tcHRDb250YWluZXJIYW5kbGVyKTtcclxuXHJcblx0YWRkTGlzdGVuZXIoSURzLlRGb3JtU3VibWl0QnV0dG9uLCBcImNsaWNrXCIsIHN1Ym1pdEJ1dHRvbkhhbmRsZXIpO1xyXG5cclxuXHRhZGRMaXN0ZW5lcihJRHMuVEZvcm1FbWFpbENoZWNrQm94LCBcImNsaWNrXCIsIGVtYWlsQ2hlY2tCb3hIYW5kbGVyKTtcclxuXHRlbWFpbENoZWNrQm94SGFuZGxlcihudWxsKTsgLy8gY2FsbCB0aGUgY2hlY2tib3ggaGFuZGxlciB0byBwcm9jZXNzIHRoZSBpbml0aWFsIHN0YXRlXHJcblxyXG5cdGxldCByYXRpbmdFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFtuYW1lPVxcXCJcIiArIElEcy5URm9ybVJhdGluZyArIFwiXFxcIl1cIik7XHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCByYXRpbmdFbGVtZW50cy5sZW5ndGg7ICsraSkge1xyXG5cdFx0VWlVdGlscy5yZWdpc3Rlckxpc3RlbmVyVG9FbGVtZW50KHJhdGluZ0VsZW1lbnRzW2ldIGFzIEhUTUxFbGVtZW50LCBcImNsaWNrXCIsIHJhdGluZ0lucHV0SGFuZGxlcik7XHJcblx0fVxyXG5cclxuXHRpZiAoIUNvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlU3VydmV5KCkuc2hvd1Byb21wdCkge1xyXG5cdFx0c2hvd1N1cnZleVNjcmVlbigpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRMb2dnaW5nLmdldExvZ2dlcigpLmxvZ0V2ZW50KExvZ2dpbmcuRXZlbnRJZHMuU3VydmV5LlVJLlByb21wdC5TaG93bi5WQUxVRSwge1xyXG5cdFx0XHRDYW1wYWlnbklkOiBDb25maWd1cmF0aW9uLmdldCgpLmdldEZsb29kZ2F0ZVN1cnZleSgpLmdldENhbXBhaWduSWQoKSxcclxuXHRcdFx0U3VydmV5SWQ6IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlU3VydmV5KCkuZ2V0SWQoKSxcclxuXHRcdFx0U3VydmV5VHlwZTogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRTdXJ2ZXlUeXBlKCksXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8vIEF1dG8gZGlzbWlzcyBpZiBuZWVkZWRcclxuXHRsZXQgYXV0b0RpbWlzcyA9IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlSW5pdE9wdGlvbnMoKS5hdXRvRGlzbWlzcztcclxuXHRpZiAoYXV0b0RpbWlzcyAhPT0gQXV0b0Rpc21pc3NWYWx1ZXMuTm9BdXRvRGlzbWlzcykge1xyXG5cdFx0bGV0IGF1dG9EaW1pc3NEdXJhdGlvbjogbnVtYmVyO1xyXG5cdFx0c3dpdGNoIChhdXRvRGltaXNzKSB7XHJcblx0XHRcdGNhc2UgKEF1dG9EaXNtaXNzVmFsdWVzLlNldmVuU2Vjb25kcyk6XHJcblx0XHRcdFx0YXV0b0RpbWlzc0R1cmF0aW9uID0gNzAwMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAoQXV0b0Rpc21pc3NWYWx1ZXMuRm91cnRlZW5TZWNvbmRzKTpcclxuXHRcdFx0XHRhdXRvRGltaXNzRHVyYXRpb24gPSAxNDAwMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAoQXV0b0Rpc21pc3NWYWx1ZXMuVHdlbnR5T25lU2Vjb25kcyk6XHJcblx0XHRcdFx0YXV0b0RpbWlzc0R1cmF0aW9uID0gMjEwMDA7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgKEF1dG9EaXNtaXNzVmFsdWVzLlR3ZW50eUVpZ2h0U2Vjb25kcyk6XHJcblx0XHRcdFx0YXV0b0RpbWlzc0R1cmF0aW9uID0gMjgwMDA7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGRlZmF1bHQ6XHJcblx0XHR9XHJcblx0XHRpZiAoYXV0b0RpbWlzc0R1cmF0aW9uICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0c2V0VGltZW91dChcclxuXHRcdFx0XHRmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHRpZiAoaXNQcm9tcHRVcCkgeyBkaXNtaXNzQWxsKGZhbHNlKTsgfVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0YXV0b0RpbWlzc0R1cmF0aW9uXHJcblx0XHRcdCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBlbWFpbENoZWNrQm94SGFuZGxlcihldmVudDogRXZlbnQpOiB2b2lkIHtcclxuXHQvLyBzaG93IGVtYWlsIGlmIGNoZWNrZWQgYW5kIHNob3cgZGVmYXVsdCBzdHJpbmcgaWYgdW5jaGVja2VkXHJcblx0bGV0IGVtYWlsQ2hlY2tCb3g6IEhUTUxJbnB1dEVsZW1lbnQgPSA8SFRNTElucHV0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSURzLlRGb3JtRW1haWxDaGVja0JveCk7XHJcblx0aWYgKGVtYWlsQ2hlY2tCb3gpIHtcclxuXHRcdGxldCBlbWFpbFRleHRCb3g6IEhUTUxJbnB1dEVsZW1lbnQgPSA8SFRNTElucHV0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSURzLlRGb3JtRW1haWxUZXh0Qm94KTtcclxuXHRcdGVtYWlsVGV4dEJveC52YWx1ZSA9IGVtYWlsQ2hlY2tCb3guY2hlY2tlZCA/IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS51c2VyRW1haWwgOiBudWxsO1xyXG5cdFx0ZW1haWxUZXh0Qm94LmRpc2FibGVkID0gIWVtYWlsQ2hlY2tCb3guY2hlY2tlZDtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvYXN0S2V5RXZlbnRIYW5kbGVyKGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG5cdC8vIGRpc21pc3MgdXBvbiBwcmVzc2luZyB0aGUgZXNjYXBlIGtleVxyXG5cdGlmICgoPEtleWJvYXJkRXZlbnQ+IGV2ZW50KS5rZXlDb2RlID09PSBLZXlzLkVzYykge1xyXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuXHRcdGRpc21pc3NBbGwoZmFsc2UpO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gdG9hc3RDYW5jZWxIYW5kbGVyKGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG5cdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdGRpc21pc3NBbGwoZmFsc2UpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwcm9tcHRDb250YWluZXJIYW5kbGVyKGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG5cdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdHNob3dTdXJ2ZXlTY3JlZW4oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd1N1cnZleVNjcmVlbigpOiB2b2lkIHtcclxuXHRpc1Byb21wdFVwID0gZmFsc2U7XHJcblxyXG5cdFVpVXRpbHMuc2V0RWxlbWVudFZpc2liaWxpdHkoSURzLlRQcm9tcHRDb250YWluZXIsIGZhbHNlKTtcclxuXHRVaVV0aWxzLnNldEVsZW1lbnRWaXNpYmlsaXR5KElEcy5URm9ybUNvbnRhaW5lciwgdHJ1ZSk7XHJcblxyXG5cdExvZ2dpbmcuZ2V0TG9nZ2VyKCkubG9nRXZlbnQoTG9nZ2luZy5FdmVudElkcy5TdXJ2ZXkuVUkuRm9ybS5TaG93bi5WQUxVRSwge1xyXG5cdFx0Q2FtcGFpZ25JZDogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRDYW1wYWlnbklkKCksXHJcblx0XHRTdXJ2ZXlJZDogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRJZCgpLFxyXG5cdFx0U3VydmV5VHlwZTogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRTdXJ2ZXlUeXBlKCksXHJcblx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJhdGluZ0lucHV0SGFuZGxlcihldmVudDogRXZlbnQpOiB2b2lkIHtcclxuXHQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSURzLlRGb3JtU3VibWl0QnV0dG9uKSBhcyBIVE1MQnV0dG9uRWxlbWVudCkuZGlzYWJsZWQgPSBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3VibWl0QnV0dG9uSGFuZGxlcihldmVudDogRXZlbnQpOiB2b2lkIHtcclxuXHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuXHRVaVV0aWxzLnNldEVsZW1lbnRWaXNpYmlsaXR5KElEcy5URm9ybVN1Ym1pdEJ1dHRvbiwgZmFsc2UpO1xyXG5cdGxldCBzcGlubmVyID0gbmV3IFNwaW5uZXIoSURzLlRGb3JtU3VibWl0QnV0dG9uU3Bpbm5lcik7XHJcblxyXG5cdGxldCB0cmFuc3BvcnRlcjogVHJhbnNwb3J0ZXIgPSBuZXcgVHJhbnNwb3J0ZXIoXHJcblx0XHRDb25maWd1cmF0aW9uLmdldCgpLmdldENvbW1vbkluaXRPcHRpb25zKCkuZW52aXJvbm1lbnQsXHJcblx0XHRBcGkuSVN1cnZleS5UeXBlW0NvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlU3VydmV5KCkuZ2V0U3VydmV5VHlwZSgpXSxcclxuXHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS5hcHBJZCxcclxuXHRcdFwiU3VydmV5XCIsXHJcblx0XHRDb25maWd1cmF0aW9uLmdldCgpLmdldENvbW1vbkluaXRPcHRpb25zKCkuYXBwbGljYXRpb25Hcm91cCxcclxuXHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS50ZWxlbWV0cnlHcm91cCxcclxuXHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Q29tbW9uSW5pdE9wdGlvbnMoKS53ZWJHcm91cCxcclxuXHQpO1xyXG5cclxuXHRsZXQgY29tbWVudEVsZW1lbnQ6IEhUTUxUZXh0QXJlYUVsZW1lbnQgPSA8SFRNTFRleHRBcmVhRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoSURzLlRGb3JtQ29tbWVudCk7XHJcblx0bGV0IGNvbW1lbnRFbnRlcmVkOiBib29sZWFuID0gKGNvbW1lbnRFbGVtZW50ICYmICEhY29tbWVudEVsZW1lbnQudmFsdWUpO1xyXG5cclxuXHRsZXQgc2VsZWN0ZWRSYXRpbmc6IEhUTUxJbnB1dEVsZW1lbnQgPVxyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImlucHV0W25hbWU9XFxcIlwiICsgSURzLlRGb3JtUmF0aW5nICsgXCJcXFwiXTpjaGVja2VkXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG5cdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlU3VydmV5KCkuc2V0VmFsdWVzKFxyXG5cdFx0TnVtYmVyKHNlbGVjdGVkUmF0aW5nLnZhbHVlKSxcclxuXHRcdGNvbW1lbnRFbnRlcmVkID8gY29tbWVudEVsZW1lbnQudmFsdWUgOiBcIlwiXHJcblx0KTtcclxuXHJcblx0Ly8gQWRkIHN1cnZleS1zcGVjaWZpYyBkYXRhIHRvIG1hbmlmZXN0XHJcblx0dHJhbnNwb3J0ZXIuc2V0TWFuaWZlc3RWYWx1ZXMoQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRKc29uRWxlbWVudHMoKSk7XHJcblxyXG5cdC8vIFNlbmQgZW1haWwgYWRkcmVzcyBpZiB1c2VyIGdpdmVzIGNvbnNlbnRcclxuXHRsZXQgZW1haWxDaGVja0JveDogSFRNTElucHV0RWxlbWVudCA9IDxIVE1MSW5wdXRFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChJRHMuVEZvcm1FbWFpbENoZWNrQm94KTtcclxuXHRsZXQgZW1haWxUZXh0Qm94OiBIVE1MSW5wdXRFbGVtZW50ID0gPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKElEcy5URm9ybUVtYWlsVGV4dEJveCk7XHJcblxyXG5cdGlmIChlbWFpbENoZWNrQm94ICYmIGVtYWlsQ2hlY2tCb3guY2hlY2tlZCAmJiBlbWFpbFRleHRCb3gudmFsdWUgIT09IFwiXCIpIHtcclxuXHRcdFx0dHJhbnNwb3J0ZXIuc2V0RW1haWwoZW1haWxUZXh0Qm94LnZhbHVlKTtcclxuXHRcdH1cclxuXHJcblx0dHJhbnNwb3J0ZXIuc3VibWl0KCk7XHJcblx0c3Bpbm5lci5kZXN0cm95KCk7XHJcblx0ZGlzbWlzc0FsbCh0cnVlKTtcclxuXHJcblx0TG9nZ2luZy5nZXRMb2dnZXIoKS5sb2dFdmVudChMb2dnaW5nLkV2ZW50SWRzLlN1cnZleS5VSS5Gb3JtLlN1Ym1pdC5WQUxVRSwge1xyXG5cdFx0Q2FtcGFpZ25JZDogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRDYW1wYWlnbklkKCksXHJcblx0XHRTdXJ2ZXlJZDogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRJZCgpLFxyXG5cdFx0U3VydmV5VHlwZTogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRTdXJ2ZXlUeXBlKCksXHJcblx0fSk7XHJcbn1cclxuIiwiLyoqXHJcbiAqIExheW91dC50c1xyXG4gKlxyXG4gKiBNb2R1bGUgZm9yIHRoZSBsYXlvdXRcclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBSZW5kZXJlciBmcm9tIFwiLi8uLi9SZW5kZXJlclwiO1xyXG5pbXBvcnQgKiBhcyBDaG9pY2VHcm91cENvbnRyb2wgZnJvbSBcIi4vLi4vQ2hvaWNlR3JvdXBDb250cm9sXCI7XHJcbmltcG9ydCAqIGFzIENvbmZpZ3VyYXRpb24gZnJvbSBcIi4vLi4vLi4vQ29uZmlndXJhdGlvbi9Db25maWd1cmF0aW9uXCI7XHJcbmltcG9ydCB7IElEcywgQ2xhc3NlcywgQXR0cmlidXRlTmFtZSwgQXR0cmlidXRlVmFsdWUsIFRhZ3MsIFVybHMgfSBmcm9tIFwiLi8uLi8uLi9Db25zdGFudHNcIjtcclxuaW1wb3J0ICogYXMgVUlTdHJpbmdzIGZyb20gXCIuLy4uLy4uL1VJU3RyaW5ncy9VSVN0cmluZ3NcIjtcclxuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSBcIi4vLi4vVXRpbHNcIjtcclxuaW1wb3J0ICogYXMgQ29uc3RhbnRzIGZyb20gXCIuLy4uLy4uL0NvbnN0YW50c1wiO1xyXG5cclxuLyoqXHJcbiAqIEdlbmVyYXRlcyB0aGUgdG9hc3RcclxuICpcclxuICogQHJldHVybnMge1JlbmRlcmVyLklVSUFzSnNvbn0gUmVuZGVyZXIuSVVJQXNKc29uIG9iamVjdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlKCk6IFJlbmRlcmVyLklVSUFzSnNvbiB7XHJcblx0bGV0IHNjaGVtYTogUmVuZGVyZXIuSVVJQXNKc29uID0ge1xyXG5cdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHR7IG5hbWU6IEF0dHJpYnV0ZU5hbWUuRGF0YUh0bWwyQ2FudmFzSWdub3JlLCB2YWx1ZTogQXR0cmlidXRlVmFsdWUuVHJ1ZSB9LFxyXG5cdFx0XHR7IG5hbWU6IEF0dHJpYnV0ZU5hbWUuUm9sZSwgdmFsdWU6IFwiZGlhbG9nXCIgfSxcclxuXHRcdFx0eyBuYW1lOiBcImFyaWEtbGFiZWxsZWRieVwiLCB2YWx1ZTogSURzLlRQcm9tcHRUaXRsZSB9LFxyXG5cdFx0XHR7IG5hbWU6IFwiYXJpYS1kZXNjcmliZWRieVwiLCB2YWx1ZTogSURzLlRQcm9tcHRUZXh0IH0sXHJcblx0XHRdLFxyXG5cdFx0Y2hpbGRyZW46IFtcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGF0dHJpYnV0ZXM6IFtcclxuXHRcdFx0XHRcdHsgbmFtZTogQXR0cmlidXRlTmFtZS5UeXBlLCB2YWx1ZTogQXR0cmlidXRlVmFsdWUuQnV0dG9uIH0sXHJcblx0XHRcdFx0XHR7IG5hbWU6IEF0dHJpYnV0ZU5hbWUuQXJpYUxhYmVsLCB2YWx1ZTogVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLkNsb3NlTGFiZWwgfSxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGlkOiBJRHMuVG9hc3RDYW5jZWwsXHJcblx0XHRcdFx0Ly8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxyXG5cdFx0XHRcdGlubmVySFRNTDogJzxzdmcgdmlld0JveD1cIjQgNCAxNiAxNlwiIHdpZHRoPVwiMTZweFwiIGhlaWdodD1cIjE2cHhcIiBmb2N1c2FibGU9XCJmYWxzZVwiPjxwYXRoIGQ9XCJNMTksNi40MUwxNy41OSw1IDEyLDEwLjU5IDYuNDEsNSA1LDYuNDEgMTAuNTksMTIgNSwxNy41OSA2LjQxLDE5IDEyLDEzLjQxIDE3LjU5LDE5IDE5LDE3LjU5IDEzLjQxLDEyelwiIGZpbGw9XCIjMDAwXCIvPjwvc3ZnPicsXHJcblx0XHRcdFx0dGFnOiBUYWdzLkJ1dHRvbixcclxuXHRcdFx0fSxcclxuXHRcdFx0Z2VuZXJhdGVQcm9tcHQoKSxcclxuXHRcdFx0Z2VuZXJhdGVGb3JtKCksXHJcblx0XHRdLFxyXG5cdFx0Y2xhc3NlczogW0NsYXNzZXMuVG9hc3QsIFV0aWxzLmlzUmlnaHRUb0xlZnQoKSA/IENsYXNzZXMuUnRsIDogXCJcIl0sXHJcblx0XHRpZDogSURzLlRvYXN0Q29udGFpbmVyLFxyXG5cdH07XHJcblx0cmV0dXJuIHNjaGVtYTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGVQcm9tcHQoKTogUmVuZGVyZXIuSVVJQXNKc29uIHtcclxuXHRsZXQgcHJvbXB0U2NoZW1hOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0XHRhdHRyaWJ1dGVzOiBbeyBuYW1lOiBcImFyaWEtbGFiZWxsZWRieVwiLCB2YWx1ZTogSURzLlRQcm9tcHRUaXRsZSB9XSxcclxuXHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjbGFzc2VzOiBbXHJcblx0XHRcdFx0XHRDbGFzc2VzLkZvbnRUZXh0LFxyXG5cdFx0XHRcdFx0Q2xhc3Nlcy5UZXh0QWxpZ25MZWZ0LFxyXG5cdFx0XHRcdF0sXHJcblx0XHRcdFx0aWQ6IElEcy5UUHJvbXB0VGl0bGUsXHJcblx0XHRcdFx0aW5uZXJUZXh0OiBDb25maWd1cmF0aW9uLmdldCgpLmdldEZsb29kZ2F0ZVN1cnZleSgpLmdldFRpdGxlKCksXHJcblx0XHRcdH0sXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjbGFzc2VzOiBbXHJcblx0XHRcdFx0XHRDbGFzc2VzLkZvbnRTdWJUZXh0LFxyXG5cdFx0XHRcdFx0Q2xhc3Nlcy5UZXh0QWxpZ25MZWZ0LFxyXG5cdFx0XHRcdF0sXHJcblx0XHRcdFx0aWQ6IElEcy5UUHJvbXB0VGV4dCxcclxuXHRcdFx0XHRpbm5lclRleHQ6IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlU3VydmV5KCkuZ2V0UHJvbXB0UXVlc3Rpb24oKSxcclxuXHRcdFx0fSxcclxuXHRcdF0sXHJcblx0XHRpZDogSURzLlRQcm9tcHRDb250YWluZXIsXHJcblx0XHR0YWc6IFRhZ3MuQnV0dG9uLFxyXG5cdH07XHJcblxyXG5cdHJldHVybiBwcm9tcHRTY2hlbWE7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVzZXJFbWFpbENvbnNlbnREZWZhdWx0KCk6IHN0cmluZyB7XHJcblx0bGV0IHVzZXJFbWFpbENvbnNlbnREZWZhdWx0ID0gQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRDb21tb25Jbml0T3B0aW9ucygpLnVzZXJFbWFpbENvbnNlbnREZWZhdWx0O1xyXG5cclxuXHRyZXR1cm4gdXNlckVtYWlsQ29uc2VudERlZmF1bHQgPyBDb25zdGFudHMuQXR0cmlidXRlVmFsdWUuQ2hlY2tlZCA6IENvbnN0YW50cy5BdHRyaWJ1dGVWYWx1ZS5VbmNoZWNrZWQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlRm9ybSgpOiBSZW5kZXJlci5JVUlBc0pzb24ge1xyXG5cdGxldCBmb3JtU2NoZW1hOiBSZW5kZXJlci5JVUlBc0pzb24gPSB7XHJcblx0XHRjaGlsZHJlbjogW1xyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y2xhc3NlczogW1xyXG5cdFx0XHRcdFx0Q2xhc3Nlcy5Gb250VGV4dCxcclxuXHRcdFx0XHRcdENsYXNzZXMuVGV4dEFsaWduTGVmdCxcclxuXHRcdFx0XHRdLFxyXG5cdFx0XHRcdGlkOiBJRHMuVEZvcm1UaXRsZSxcclxuXHRcdFx0XHRpbm5lclRleHQ6IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlU3VydmV5KCkuZ2V0VGl0bGUoKSxcclxuXHRcdFx0fSxcclxuXHRcdFx0Z2VuZXJhdGVSYXRpbmdDb250cm9sKCksXHJcblx0XHRcdHtcclxuXHRcdFx0XHRhdHRyaWJ1dGVzOiBbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdG5hbWU6IEF0dHJpYnV0ZU5hbWUuUGxhY2Vob2xkZXIsXHJcblx0XHRcdFx0XHRcdHZhbHVlOiBDb25maWd1cmF0aW9uLmdldCgpLmdldEZsb29kZ2F0ZVN1cnZleSgpLmdldENvbW1lbnRRdWVzdGlvbigpLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0bmFtZTogQXR0cmlidXRlTmFtZS5BcmlhTGFiZWwsXHJcblx0XHRcdFx0XHRcdHZhbHVlOiBDb25maWd1cmF0aW9uLmdldCgpLmdldEZsb29kZ2F0ZVN1cnZleSgpLmdldENvbW1lbnRRdWVzdGlvbigpLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0bmFtZTogQXR0cmlidXRlTmFtZS5NYXhMZW5ndGgsXHJcblx0XHRcdFx0XHRcdHZhbHVlOiBBdHRyaWJ1dGVWYWx1ZS5UZXh0QXJlYU1heExlbmd0aCxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0XHRjbGFzc2VzOiBbQ2xhc3Nlcy5Gb250U3ViVGV4dCwgQ2xhc3Nlcy5UZXh0SW5wdXRdLFxyXG5cdFx0XHRcdGlkOiBJRHMuVEZvcm1Db21tZW50LFxyXG5cdFx0XHRcdHRhZzogVGFncy5UZXh0QXJlYSxcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGJyczogQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5zaG93RW1haWxSZXF1ZXN0LFxyXG5cdFx0XHRcdGNoaWxkcmVuOiBbXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFtcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5UeXBlLFxyXG5cdFx0XHRcdFx0XHRcdFx0dmFsdWU6IENvbnN0YW50cy5BdHRyaWJ1dGVWYWx1ZS5DaGVja2JveCxcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdG5hbWU6IHVzZXJFbWFpbENvbnNlbnREZWZhdWx0KCksXHJcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogXCJcIixcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuVEZvcm1FbWFpbENoZWNrYm94LCBDb25zdGFudHMuQ2xhc3Nlcy5DaGVja0JveF0sXHJcblx0XHRcdFx0XHRcdGlkOiBDb25zdGFudHMuSURzLlRGb3JtRW1haWxDaGVja0JveCxcclxuXHRcdFx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5JbnB1dCxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGF0dHJpYnV0ZXM6IFt7IG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLkZvciwgdmFsdWU6IENvbnN0YW50cy5JRHMuVEZvcm1FbWFpbENoZWNrQm94IH1dLFxyXG5cdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHQsIENvbnN0YW50cy5DbGFzc2VzLlRleHRBbGlnbkxlZnQsIENvbnN0YW50cy5DbGFzc2VzLlRGb3JtRW1haWxMYWJlbF0sXHJcblx0XHRcdFx0XHRcdGlubmVyVGV4dDogVUlTdHJpbmdzLmdldFVJU3RyaW5ncygpLkZvcm0uRW1haWxDaGVja0JveExhYmVsLFxyXG5cdFx0XHRcdFx0XHR0YWc6IENvbnN0YW50cy5UYWdzLkxhYmVsLFxyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLlR5cGUsXHJcblx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogQ29uc3RhbnRzLkF0dHJpYnV0ZVZhbHVlLlRleHQsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5QbGFjZWhvbGRlcixcclxuXHRcdFx0XHRcdFx0XHRcdHZhbHVlOiBVSVN0cmluZ3MuZ2V0VUlTdHJpbmdzKCkuRm9ybS5FbWFpbFBsYWNlaG9sZGVyLFxyXG5cdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0bmFtZTogQ29uc3RhbnRzLkF0dHJpYnV0ZU5hbWUuQXJpYUxhYmVsLFxyXG5cdFx0XHRcdFx0XHRcdFx0dmFsdWU6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLkVtYWlsUGxhY2Vob2xkZXIsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5OYW1lLFxyXG5cdFx0XHRcdFx0XHRcdFx0dmFsdWU6IENvbnN0YW50cy5JRHMuQmFzaWNGb3JtRW1haWxJbnB1dCxcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdG5hbWU6IENvbnN0YW50cy5BdHRyaWJ1dGVOYW1lLk1heExlbmd0aCxcclxuXHRcdFx0XHRcdFx0XHRcdHZhbHVlOiBDb25zdGFudHMuQXR0cmlidXRlVmFsdWUuVGV4dEFyZWFNYXhMZW5ndGgsXHJcblx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRuYW1lOiBDb25zdGFudHMuQXR0cmlidXRlTmFtZS5WYWx1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdHZhbHVlOiBDb25maWd1cmF0aW9uLmdldCgpLmdldENvbW1vbkluaXRPcHRpb25zKCkudXNlckVtYWlsQ29uc2VudERlZmF1bHRcclxuXHRcdFx0XHRcdFx0XHRcdD8gQ29uZmlndXJhdGlvbi5nZXQoKS5nZXRDb21tb25Jbml0T3B0aW9ucygpLnVzZXJFbWFpbFxyXG5cdFx0XHRcdFx0XHRcdFx0OiAgXCJcIixcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ29uc3RhbnRzLkNsYXNzZXMuRm9udFN1YlRleHQsIENvbnN0YW50cy5DbGFzc2VzLkZvcm1FbWFpbElucHV0LCBDb25zdGFudHMuQ2xhc3Nlcy5UZXh0SW5wdXRdLFxyXG5cdFx0XHRcdFx0XHRpZDogQ29uc3RhbnRzLklEcy5URm9ybUVtYWlsVGV4dEJveCxcclxuXHRcdFx0XHRcdFx0dGFnOiBDb25zdGFudHMuVGFncy5JbnB1dCxcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XSxcclxuXHRcdFx0fSxcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGNoaWxkcmVuOlxyXG5cdFx0XHRcdFx0W1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0YXR0cmlidXRlczogW1xyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRuYW1lOiBBdHRyaWJ1dGVOYW1lLkhSZWYsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlOiBVcmxzLlByaXZhY3lTdGF0ZW1lbnRMaW5rLFxyXG5cdFx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0bmFtZTogQXR0cmlidXRlTmFtZS5UYXJnZXQsXHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbHVlOiBBdHRyaWJ1dGVWYWx1ZS5CbGFua1dpbmRvdyxcclxuXHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdG5hbWU6IEF0dHJpYnV0ZU5hbWUuUmVsLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWx1ZTogQXR0cmlidXRlVmFsdWUuTm9SZWZlcnJlcixcclxuXHRcdFx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRcdFx0XSxcclxuXHRcdFx0XHRcdFx0XHRjbGFzc2VzOiBbQ2xhc3Nlcy5MaW5rXSxcclxuXHRcdFx0XHRcdFx0XHRpbm5lclRleHQ6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Qcml2YWN5U3RhdGVtZW50LFxyXG5cdFx0XHRcdFx0XHRcdHRhZzogVGFncy5BbmNob3IsXHJcblx0XHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdGNsYXNzZXM6IFtDbGFzc2VzLkZvbnRTdWJTdWJUZXh0LCBDbGFzc2VzLlRleHRBbGlnbkxlZnQsIENsYXNzZXMuUHJpdmFjeVN0YXRlbWVudExpbmtEaXZdLFxyXG5cdFx0XHR9LFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y2hpbGRyZW46IFtcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0YXR0cmlidXRlczogW3sgbmFtZTogQXR0cmlidXRlTmFtZS5EaXNhYmxlZCwgdmFsdWU6IEF0dHJpYnV0ZVZhbHVlLlRydWUgfV0sXHJcblx0XHRcdFx0XHRcdGNsYXNzZXM6IFtcclxuXHRcdFx0XHRcdFx0XHRDbGFzc2VzLkZvbnRTdWJUZXh0LFxyXG5cdFx0XHRcdFx0XHRcdENsYXNzZXMuU3VibWl0QnV0dG9uLFxyXG5cdFx0XHRcdFx0XHRdLFxyXG5cdFx0XHRcdFx0XHRpZDogSURzLlRGb3JtU3VibWl0QnV0dG9uLFxyXG5cdFx0XHRcdFx0XHRpbm5lclRleHQ6IFVJU3RyaW5ncy5nZXRVSVN0cmluZ3MoKS5Gb3JtLlN1Ym1pdCxcclxuXHRcdFx0XHRcdFx0dGFnOiBUYWdzLkJ1dHRvbixcclxuXHRcdFx0XHRcdH0sXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGNsYXNzZXM6IFtDbGFzc2VzLlNwaW5uZXIsIENsYXNzZXMuSGlkZGVuXSxcclxuXHRcdFx0XHRcdFx0aWQ6IElEcy5URm9ybVN1Ym1pdEJ1dHRvblNwaW5uZXIsXHJcblx0XHRcdFx0XHRcdHRhZzogVGFncy5EaXYsXHJcblx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdF0sXHJcblx0XHRcdFx0aWQ6IElEcy5URm9ybVN1Ym1pdEJ1dHRvbkNvbnRhaW5lcixcclxuXHRcdFx0fSxcclxuXHRcdF0sXHJcblx0XHRjbGFzc2VzOiBbQ2xhc3Nlcy5IaWRkZW5dLFxyXG5cdFx0aWQ6IElEcy5URm9ybUNvbnRhaW5lcixcclxuXHR9O1xyXG5cclxuXHRyZXR1cm4gZm9ybVNjaGVtYTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGVSYXRpbmdDb250cm9sKCk6IFJlbmRlcmVyLklVSUFzSnNvbiB7XHJcblx0bGV0IGNob2ljZXM6IFtudW1iZXIsIHN0cmluZ11bXSA9IFtdO1xyXG5cclxuXHRsZXQgcmF0aW5nVmFsdWVzOiBzdHJpbmdbXSA9IENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlU3VydmV5KCkuZ2V0UmF0aW5nVmFsdWVzQXNjZW5kaW5nKCk7XHJcblx0bGV0IGluZGV4ID0gMDtcclxuXHJcblx0Zm9yIChsZXQgcmF0aW5nVmFsdWUgb2YgcmF0aW5nVmFsdWVzKSB7XHJcblx0XHRjaG9pY2VzLnB1c2goW2luZGV4LCByYXRpbmdWYWx1ZV0pO1xyXG5cdFx0aW5kZXgrKztcclxuXHR9XHJcblxyXG5cdC8vIFJhdGluZ3MgbmVlZCB0byBiZSBzaG93biBpbiBkZXNjZW5kaW5nIG9yZGVyXHJcblx0cmV0dXJuIENob2ljZUdyb3VwQ29udHJvbC5nZW5lcmF0ZVJhZGlvR3JvdXAoSURzLlRGb3JtUmF0aW5nLFxyXG5cdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRSYXRpbmdRdWVzdGlvbigpLCBjaG9pY2VzLnJldmVyc2UoKSk7XHJcbn1cclxuIiwiLyoqXHJcbiAqIFRvYXN0LnRzXHJcbiAqXHJcbiAqIE1vZHVsZSBmb3IgdGhlIFRvYXN0IFVJXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgSURzIH0gZnJvbSBcIi4vLi4vLi4vQ29uc3RhbnRzXCI7XHJcbmltcG9ydCAqIGFzIEV2ZW50cyBmcm9tIFwiLi9FdmVudHNcIjtcclxuaW1wb3J0ICogYXMgTGF5b3V0IGZyb20gXCIuL0xheW91dFwiO1xyXG5pbXBvcnQgKiBhcyBSZW5kZXJlciBmcm9tIFwiLi8uLi9SZW5kZXJlclwiO1xyXG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tIFwiLi8uLi9VdGlsc1wiO1xyXG5pbXBvcnQgKiBhcyBDb25maWd1cmF0aW9uIGZyb20gXCIuLy4uLy4uL0NvbmZpZ3VyYXRpb24vQ29uZmlndXJhdGlvblwiO1xyXG5cclxuLyoqXHJcbiAqIFVJIGluaXRpYWxpemF0aW9uIGZvciB0b2FzdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN1cnZleShvbkNsb3NlOiAoKSA9PiB2b2lkKSB7XHJcblx0Y3JlYXRlKFJlbmRlcmVyLmVsZW1lbnRGcm9tSnNvbihMYXlvdXQuZ2VuZXJhdGUoKSkpO1xyXG5cdEV2ZW50cy5yZWdpc3RlcihcclxuXHRcdGZ1bmN0aW9uIChzdWJtaXR0ZWQ6IGJvb2xlYW4pIHtcclxuXHRcdFx0VXRpbHMuc2V0RWxlbWVudFZpc2liaWxpdHkoSURzLlRvYXN0Q29udGFpbmVyLCBmYWxzZSk7XHJcblx0XHRcdFV0aWxzLmRlbGV0ZUVsZW1lbnRCeUlkKElEcy5Ub2FzdENvbnRhaW5lcik7XHJcblx0XHRcdENvbmZpZ3VyYXRpb24uZ2V0KCkuZ2V0Rmxvb2RnYXRlSW5pdE9wdGlvbnMoKS5vbkRpc21pc3MoXHJcblx0XHRcdFx0Q29uZmlndXJhdGlvbi5nZXQoKS5nZXRGbG9vZGdhdGVTdXJ2ZXkoKS5nZXRDYW1wYWlnbklkKCksXHJcblx0XHRcdFx0c3VibWl0dGVkXHJcblx0XHRcdCk7XHJcblx0XHRcdG9uQ2xvc2UoKTtcclxuXHRcdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGUodXNlckludGVyZmFjZTogRWxlbWVudCkge1xyXG5cdGRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKHVzZXJJbnRlcmZhY2UsIGRvY3VtZW50LmJvZHkuZmlyc3RDaGlsZCk7XHJcblxyXG5cdFV0aWxzLnNldEVsZW1lbnRWaXNpYmlsaXR5KElEcy5Ub2FzdENvbnRhaW5lciwgdHJ1ZSk7XHJcbn1cclxuIiwi77u/LyoqXHJcbiAqIFVJLnRzXHJcbiAqXHJcbiAqIE1vZHVsZSBmb3IgdGhlIFVJXHJcbiAqL1xyXG5cclxuZXhwb3J0IHtJVXNlclZvaWNlSW5pdE9wdGlvbnN9IGZyb20gXCIuL0JlbGx5YmFuZC9Gb3JtVGVtcGxhdGVzL1VzZXJWb2ljZUZvcm1UZW1wbGF0ZVwiO1xyXG5leHBvcnQge2NyZWF0ZU11bHRpIGFzIGNyZWF0ZUJlbGx5QmFuZE11bHRpfSBmcm9tIFwiLi9CZWxseUJhbmQvQmVsbHlCYW5kXCI7XHJcbmV4cG9ydCB7Y3JlYXRlU2luZ2xlIGFzIGNyZWF0ZUJlbGx5QmFuZFNpbmdsZX0gZnJvbSBcIi4vQmVsbHlCYW5kL0JlbGx5QmFuZFwiO1xyXG5leHBvcnQge2NyZWF0ZVN1cnZleSBhcyBjcmVhdGVTdXJ2ZXl9IGZyb20gXCIuL1RvYXN0L1RvYXN0XCI7XHJcbiIsIu+7vy8qKlxyXG4gKiBVdGlscy50c1xyXG4gKlxyXG4gKiBNb2R1bGUgZm9yIHV0aWxpdHkgZnVuY3Rpb25zXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgQ29uc3RhbnRzIGZyb20gXCIuLy4uL0NvbnN0YW50c1wiO1xyXG5cclxuLyoqXHJcbiAqIFNldCBIVE1MIGVsZW1lbnQgdmlzaWJpbGl0eVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElkIG9mIHRoZSBIVE1MIGVsZW1lbnRcclxuICogQHBhcmFtIHthbnl9IHZpcyBUaGUgdmlzaWJpbGl0eSB0byBiZSBzZXQgKHRydWUgb3IgZmFsc2UpXHJcbiAqIEByZXR1cm4ge3ZvaWR9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0RWxlbWVudFZpc2liaWxpdHkoaWQ6IHN0cmluZywgdmlzOiBib29sZWFuKTogdm9pZCB7XHJcblx0bGV0IG9sZENsYXNzTmFtZTogc3RyaW5nID0gdmlzID8gQ29uc3RhbnRzLkNsYXNzZXMuSGlkZGVuIDogQ29uc3RhbnRzLkNsYXNzZXMuVmlzaWJsZTtcclxuXHRsZXQgbmV3Q2xhc3NOYW1lOiBzdHJpbmcgPSB2aXMgPyBDb25zdGFudHMuQ2xhc3Nlcy5WaXNpYmxlIDogQ29uc3RhbnRzLkNsYXNzZXMuSGlkZGVuO1xyXG5cclxuXHRyZXBsYWNlQ2xhc3Nlc0J5SWQoaWQsIG9sZENsYXNzTmFtZSwgbmV3Q2xhc3NOYW1lKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIERlbGV0ZSBIVE1MIGVsZW1lbnQgYnkgSWRcclxuICogQHBhcmFtIHtzdHJpbmd9IGlkIFRoZSBJZCBvZiB0aGUgSFRNTCBlbGVtZW50XHJcbiAqIEByZXR1cm4ge3ZvaWR9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlRWxlbWVudEJ5SWQoaWQ6IHN0cmluZyk6IHZvaWQge1xyXG5cdGxldCBlbGVtZW50OiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuXHRpZiAoZWxlbWVudCAhPSBudWxsICYmIGVsZW1lbnQucGFyZW50Tm9kZSAhPSBudWxsKSB7XHJcblx0XHRlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQWRkIGEgQ1NTIGNsYXNzIHRvIGFuIEhUTUwgZWxlbWVudCBieSBJZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElkIG9mIHRoZSBIVE1MIGVsZW1lbnRcclxuICogQHBhcmFtIHtzdHJpbmd9IG5ld0NsYXNzTmFtZSBUaGUgbmFtZSBvZiBDU1MgY2xhc3MgdG8gYmUgYWRkZWRcclxuICogQHJldHVybiB7dm9pZH1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRDbGFzc0J5SWQoaWQ6IHN0cmluZywgbmV3Q2xhc3M6IHN0cmluZyk6IHZvaWQge1xyXG5cdGxldCBlbGVtZW50OiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcclxuXHJcblx0aWYgKCFlbGVtZW50KSB7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHQvLyBjaGVjayBpcyB0aGUgY2xhc3MgYWxyZWFkeSBleGlzdHMsIGlmIG5vdCBhZGQgaXRcclxuXHRpZiAoIWVsZW1lbnQuY2xhc3NOYW1lLm1hdGNoKG5ldyBSZWdFeHAoXCJcXFxcYlwiICsgbmV3Q2xhc3MgKyBcIlxcXFxiXCIpKSkge1xyXG5cdFx0Ly8gd2UgdXNlIGNsYXNzTmFtZSBpbnN0ZWFkIG9mIGNsYXNzTGlzdCB0byBzdXBwb3J0IElFOVxyXG5cdFx0ZWxlbWVudC5jbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZSArIFwiIFwiICsgbmV3Q2xhc3M7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogRGVsZXRlIGEgQ1NTIGNsYXNzIG9mIGFuIEhUTUwgZWxlbWVudCBieSBJZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWQgVGhlIElkIG9mIHRoZSBIVE1MIGVsZW1lbnRcclxuICogQHBhcmFtIHtzdHJpbmd9IG9sZENsYXNzTmFtZSBUaGUgbmFtZSBvZiBDU1MgY2xhc3MgdG8gYmUgZGVsZXRlZFxyXG4gKiBAcmV0dXJuIHt2b2lkfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUNsYXNzQnlJZChpZDogc3RyaW5nLCBvbGRDbGFzczogc3RyaW5nKTogdm9pZCB7XHJcblx0bGV0IGVsZW1lbnQ6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG5cclxuXHRpZiAoIWVsZW1lbnQpIHtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdC8vIHdlIHVzZSBjbGFzc05hbWUgaW5zdGVhZCBvZiBjbGFzc0xpc3QgdG8gc3VwcG9ydCBJRTlcclxuXHQvLyBnZXQgcmlkIG9mIGFueSBvY2N1cnJlbmNlcyBvZiB0aGUgY2xhc3Mgd2UgZG9uXCJ0IHdhbnRcclxuXHRlbGVtZW50LmNsYXNzTmFtZSA9IGVsZW1lbnQuY2xhc3NOYW1lLnNwbGl0KG5ldyBSZWdFeHAoXCJcXFxcYlwiICsgb2xkQ2xhc3MgKyBcIlxcXFxiXCIsIFwiaVwiKSkuam9pbihcIiBcIik7XHJcblxyXG5cdC8vIGdldCByaWQgb2YgZXh0cmEgd2hpdGVzcGFjZXNcclxuXHRlbGVtZW50LmNsYXNzTmFtZSA9IGVsZW1lbnQuY2xhc3NOYW1lLnNwbGl0KC9cXHMrLykuam9pbihcIiBcIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWxldGUgYW4gQ1NTIGNsYXNzIGFuZCAob3IpIGFkZCBhbiBDU1MgY2xhc3MgdG8gYW4gSFRNTCBlbGVtZW50IGJ5IElkXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSWQgb2YgdGhlIEhUTUwgZWxlbWVudFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gb2xkQ2xhc3NOYW1lIFRoZSBuYW1lIG9mIENTUyBjbGFzcyB0byBiZSBkZWxldGVkXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBuZXdDbGFzc05hbWUgVGhlIG5hbWUgb2YgQ1NTIGNsYXNzIHRvIGJlIGFkZGVkXHJcbiAqIEByZXR1cm4ge3ZvaWR9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZUNsYXNzZXNCeUlkKGlkOiBzdHJpbmcsIG9sZENsYXNzTmFtZT86IHN0cmluZywgbmV3Q2xhc3NOYW1lPzogc3RyaW5nKTogdm9pZCB7XHJcblx0ZGVsZXRlQ2xhc3NCeUlkKGlkLCBvbGRDbGFzc05hbWUpO1xyXG5cdGFkZENsYXNzQnlJZChpZCwgbmV3Q2xhc3NOYW1lKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBhdHRyaWJ1dGUgb24gYW4gSFRNTCBlbGVtZW50XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCBUaGUgSWQgb2YgdGhlIEhUTUwgZWxlbWVudFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0cmlOYW1lIFRoZSBhdHRyaWJ1dGUgbmFtZVxyXG4gKiBAcGFyYW0ge3N0cmluZ30gYXR0cmlWYWx1ZSBUaGUgYXR0cmlidXRlIHZhbHVlXHJcbiAqIEByZXR1cm4ge3ZvaWR9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0QXR0cmlidXRlT25IdG1sRWxlbWVudChpZDogc3RyaW5nLCBhdHRyaU5hbWU6IHN0cmluZywgYXR0cmlWYWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0bGV0IGh0bWxFbGVtZW50OiBIVE1MRWxlbWVudCA9IDxIVE1MRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG5cdGlmIChodG1sRWxlbWVudCkge1xyXG5cdFx0aHRtbEVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHJpTmFtZSwgYXR0cmlWYWx1ZSk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQWRkIGV2ZW50IGxpc3RlbmVyIGhlbHBlciBmdW5jdGlvbiAod3JhcHBlcikgdGhhdCBkZWFscyB3aXRoIElFIDggY29tcGF0YWJpbGl0eVxyXG4gKiBAcGFyYW0gb2JqZWN0IFRoZSBvYmplY3QgdG8gYWRkIGV2ZW50IGxpc3RlbmVyIHRvXHJcbiAqIEBwYXJhbSB0eXBlIFRoZSBldmVudCB0eXBlXHJcbiAqIEBwYXJhbSBsaXN0ZW5lciBUaGUgbGlzdGVuZXIgZnVuY3Rpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRFdmVudExpc3RlbmVySGVscGVyKG9iamVjdDogYW55LCB0eXBlOiBzdHJpbmcsIGxpc3RlbmVyOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkKTogdm9pZCB7XHJcblx0aWYgKG9iamVjdC5hZGRFdmVudExpc3RlbmVyKSB7XHJcblx0XHRvYmplY3QuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgZmFsc2UpO1xyXG5cdH0gZWxzZSBpZiAob2JqZWN0LmF0dGFjaEV2ZW50KSB7XHJcblx0XHRvYmplY3QuYXR0YWNoRXZlbnQoXCJvblwiICsgdHlwZSwgbGlzdGVuZXIpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZSBldmVudCBsaXN0ZW5lciBoZWxwZXIgZnVuY3Rpb24gKHdyYXBwZXIpIHRoYXQgZGVhbHMgd2l0aCBJRSA4IGNvbXBhdGFiaWxpdHlcclxuICogQHBhcmFtIG9iamVjdCBUaGUgb2JqZWN0IHRvIHJlbW92ZSBldmVudCBsaXN0ZW5lciBmcm9tXHJcbiAqIEBwYXJhbSB0eXBlIFRoZSBldmVudCB0eXBlXHJcbiAqIEBwYXJhbSBsaXN0ZW5lciBUaGUgbGlzdGVuZXIgZnVuY3Rpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVySGVscGVyKG9iamVjdDogYW55LCB0eXBlOiBzdHJpbmcsIGxpc3RlbmVyOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkKTogdm9pZCB7XHJcblx0aWYgKG9iamVjdC5yZW1vdmVFdmVudExpc3RlbmVyKSB7XHJcblx0XHRvYmplY3QucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgZmFsc2UpO1xyXG5cdH0gZWxzZSBpZiAob2JqZWN0LmRldGFjaEV2ZW50KSB7XHJcblx0XHRvYmplY3QuZGV0YWNoRXZlbnQoXCJvblwiICsgdHlwZSwgbGlzdGVuZXIpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyXHJcbiAqIEBwYXJhbSBpZCBUaGUgSWQgb2YgdGhlIEhUTUwgZWxlbWVudFxyXG4gKiBAcGFyYW0gdHlwZSBUaGUgZXZlbnQgdHlwZVxyXG4gKiBAcGFyYW0gbGlzdGVuZXIgVGhlIGxpc3RlbmVyIGZ1bmN0aW9uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJMaXN0ZW5lcihpZDogc3RyaW5nLCB0eXBlOiBzdHJpbmcsIGxpc3RlbmVyOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkKTogdm9pZCB7XHJcblx0bGV0IGVsZW1lbnQ6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xyXG5cdGlmIChlbGVtZW50KSB7XHJcblx0XHRhZGRFdmVudExpc3RlbmVySGVscGVyKGVsZW1lbnQsIHR5cGUsIGxpc3RlbmVyKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZWdpc3RlciBldmVudCBsaXN0ZW5lclxyXG4gKiBAcGFyYW0gZWxlbWVudCBUaGUgSFRNTCBlbGVtZW50XHJcbiAqIEBwYXJhbSB0eXBlIFRoZSBldmVudCB0eXBlXHJcbiAqIEBwYXJhbSBsaXN0ZW5lciBUaGUgbGlzdGVuZXIgZnVuY3Rpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3Rlckxpc3RlbmVyVG9FbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50LCB0eXBlOiBzdHJpbmcsIGxpc3RlbmVyOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkKTogdm9pZCB7XHJcblx0aWYgKGVsZW1lbnQpIHtcclxuXHRcdGFkZEV2ZW50TGlzdGVuZXJIZWxwZXIoZWxlbWVudCwgdHlwZSwgbGlzdGVuZXIpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFVuLXJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVyXHJcbiAqIEBwYXJhbSBpZCBUaGUgSWQgb2YgdGhlIEhUTUwgZWxlbWVudFxyXG4gKiBAcGFyYW0gdHlwZSBUaGUgZXZlbnQgdHlwZVxyXG4gKiBAcGFyYW0gbGlzdGVuZXIgVGhlIGxpc3RlbmVyIGZ1bmN0aW9uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdW5yZWdpc3Rlckxpc3RlbmVyKGlkOiBzdHJpbmcsIHR5cGU6IHN0cmluZywgbGlzdGVuZXI6IChldmVudDogRXZlbnQpID0+IHZvaWQpOiB2b2lkIHtcclxuXHRsZXQgZWxlbWVudDogSFRNTEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcblx0aWYgKGVsZW1lbnQpIHtcclxuXHRcdHJlbW92ZUV2ZW50TGlzdGVuZXJIZWxwZXIoZWxlbWVudCwgdHlwZSwgbGlzdGVuZXIpO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgdGhlIHZlcnNpb24gb2YgSW50ZXJuZXQgRXhwbG9yZXIgb3IgLTEgZm9yIG5vbi1JRSBicm93c2VyXHJcbiAqIEByZXR1cm4ge251bWJlcn0gVGhlIElFIHZlcnNpb25cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRJbnRlcm5ldEV4cGxvcmVyVmVyc2lvbigpOiBudW1iZXIge1xyXG5cdGxldCBydjogbnVtYmVyID0gLTE7XHJcblx0bGV0IHVhOiBzdHJpbmcgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudDtcclxuXHJcblx0Ly8gc2luY2UgSUUgMTEsICdNU0lFJyBpcyBub3QgYSBrZXl3b3JkIGluIGl0cyB1c2VyIGFnZW50IHN0cmluZyBhbnltb3JlXHJcblx0Ly8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGJyb3dzZXIgaXMgSUUgb3Igbm90LCBhbmQgdGhlIHZlcnNpb24gb2YgSUUgYmFzZWQgb24gVHJpZGVudCBrZXl3b3JkIGFuZCBpdHMgdmVyc2lvblxyXG5cdGlmICh1YS5pbmRleE9mKFwiVHJpZGVudFwiKSA+IC0xKSB7XHJcblx0XHRsZXQgcmU6IFJlZ0V4cCA9IG5ldyBSZWdFeHAoXCJUcmlkZW50LyhbMC05XXsxLH1bXFwuMC05XXswLH0pXCIpO1xyXG5cdFx0aWYgKHJlLmV4ZWModWEpICE9IG51bGwpIHtcclxuXHRcdFx0cnYgPSBwYXJzZUZsb2F0KFJlZ0V4cC4kMSk7XHJcblx0XHRcdHJ2ICs9IDQ7IC8vIHRyaWRlbnQgdmVyc2lvbiArIDQgaXMgdGhlIElFIHZlcnNpb25cclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIHJ2O1xyXG59XHJcblxyXG4vKipcclxuICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdGV4dCBkaXJlY3Rpb24gaXMgcmlnaHQgdG8gbGVmdFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzUmlnaHRUb0xlZnQoKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5kaXJlY3Rpb24gPT09IFwicnRsXCI7XHJcbn1cclxuIiwi77u/LypcclxuICogVXRpbHMudHNcclxuICpcclxuICogTW9kdWxlIGZvciB1dGlsaXR5IGZ1bmN0aW9uc1xyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBnaXZlbiB2YWx1ZSBpcyBhIG51bWJlclxyXG4gKiBAcGFyYW0ge2FueX0gdmFsdWUgdmFsdWVcclxuICovXHJcbmZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBnaXZlbiB2YWx1ZSBpcyBhbiBpbnRlZ2VyXHJcbiAqIEBwYXJhbSB7YW55fSB2YWx1ZSB2YWx1ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzSW50ZWdlcih2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiAmJlxyXG5cdFx0aXNGaW5pdGUodmFsdWUpICYmXHJcblx0XHRNYXRoLmZsb29yKHZhbHVlKSA9PT0gdmFsdWU7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiBnaXZlbiB2YWx1ZSBpcyBhIHN0cmluZ1xyXG4gKiBAcGFyYW0ge2FueX0gdmFsdWUgdmFsdWVcclxuICovXHJcbmZ1bmN0aW9uIGlzU3RyaW5nKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiB2YWx1ZSBpcyBhbiBvYmplY3RcclxuICogQHBhcmFtIHthbnl9IHZhbHVlIHZhbHVlXHJcbiAqL1xyXG5mdW5jdGlvbiBpc09iamVjdCh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0cmV0dXJuICghaXNOdWxsb3JVbmRlZmluZWQodmFsdWUpICYmIHR5cGVvZiAodmFsdWUpID09PSBcIm9iamVjdFwiKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHZhbHVlIGlzIGFuIG9iamVjdFxyXG4gKiBAcGFyYW0ge2FueX0gdmFsdWUgdmFsdWVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0Jvb2xlYW4odmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiB0eXBlb2YgKHZhbHVlKSA9PT0gXCJib29sZWFuXCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiB2YWx1ZSBpcyBcIm51bGxcIiBvciBcInVuZGVmaW5lZFwiXHJcbiAqIEBwYXJhbSB7YW55fSB2YWx1ZSB2YWx1ZVxyXG4gKi9cclxuZnVuY3Rpb24gaXNOdWxsb3JVbmRlZmluZWQodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiAodmFsdWUgPT0gbnVsbCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiB2YWx1ZSBpcyBhIHZhbGlkIGd1aWRcclxuICogQHBhcmFtIHthbnl9IHZhbHVlIHZhbHVlXHJcbiAqL1xyXG5mdW5jdGlvbiBpc0d1aWQodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiAoaXNTdHJpbmcodmFsdWUpICYmXHJcblx0XHQvXlswLTlhLWZBLUZdezh9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezEyfSQvLnRlc3QodmFsdWUpKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRocm93IGlmIG5vdCBvYmplY3RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHBlY3RPYmplY3QodmFsdWU6IGFueSwgbmFtZTogc3RyaW5nKTogdm9pZCB7XHJcblx0aWYgKCFpc09iamVjdCh2YWx1ZSkpIHtcclxuXHRcdHRocm93IG5hbWUgKyBcIiBpcyBub3QgYW4gb2JqZWN0OiBcIiArIHZhbHVlO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRocm93IGlmIG5vdCBudW1iZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHBlY3ROdW1iZXIodmFsdWU6IGFueSwgbmFtZTogc3RyaW5nKTogdm9pZCB7XHJcblx0aWYgKCFpc051bWJlcih2YWx1ZSkpIHtcclxuXHRcdHRocm93IG5hbWUgKyBcIiBpcyBub3QgYSBudW1iZXI6IFwiICsgdmFsdWU7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogVGhyb3cgaWYgbm90IHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4cGVjdFN0cmluZyh2YWx1ZTogYW55LCBuYW1lOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRpZiAoIWlzU3RyaW5nKHZhbHVlKSkge1xyXG5cdFx0dGhyb3cgbmFtZSArIFwiIGlzIG5vdCBhIHN0cmluZzogXCIgKyB2YWx1ZTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaHJvdyBpZiBub3QgYm9vbGVhblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4cGVjdEJvb2xlYW4odmFsdWU6IGFueSwgbmFtZTogc3RyaW5nKTogdm9pZCB7XHJcblx0aWYgKCFpc0Jvb2xlYW4odmFsdWUpKSB7XHJcblx0XHR0aHJvdyBuYW1lICsgXCIgaXMgbm90IGEgYm9vbGVhbjogXCIgKyB2YWx1ZTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaHJvdyBpZiBub3QgZ3VpZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGV4cGVjdEd1aWQodmFsdWU6IGFueSwgbmFtZTogc3RyaW5nKTogdm9pZCB7XHJcblx0aWYgKCFpc0d1aWQodmFsdWUpKSB7XHJcblx0XHR0aHJvdyBuYW1lICsgXCIgaXMgbm90IGEgZ3VpZDogXCIgKyB2YWx1ZTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUaHJvdyBpZiBub3QgYXJyYXlcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBleHBlY3RBcnJheSh2YWx1ZTogYW55LCBuYW1lOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcblx0XHR0aHJvdyBuYW1lICsgXCIgaXMgbm90IGFuIGFycmF5OiBcIiArIHZhbHVlO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBndWlkIHN0cmluZ1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGd1aWQoKTogc3RyaW5nIHtcclxuXHQvLyBTdGl0Y2ggaW4gJzQnIGluIHRoZSB0aGlyZCBncm91cFxyXG5cdHJldHVybiAocmFuZG9tSGV4NCgpICsgcmFuZG9tSGV4NCgpICsgXCItXCIgKyByYW5kb21IZXg0KCkgKyBcIi00XCIgKyByYW5kb21IZXg0KCkuc3Vic3RyKDAsIDMpICsgXCItXCIgKyByYW5kb21IZXg0KCkgKyBcIi1cIlxyXG5cdFx0KyByYW5kb21IZXg0KCkgKyByYW5kb21IZXg0KCkgKyByYW5kb21IZXg0KCkpLnRvTG93ZXJDYXNlKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmFuZG9tIEhleDQgc3RyaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiByYW5kb21IZXg0KCk6IHN0cmluZyB7XHJcblx0cmV0dXJuIChNYXRoLmZsb29yKCgoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCkpKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xyXG59XHJcblxyXG4vKipcclxuICogVGFrZXMgdHdvIG9iamVjdHMgKHNvdXJjZSwgdGFyZ2V0KSBhbmQgcmV0dXJucyB0aGUgdGFyZ2V0IG9iamVjdCB3aXRoIHZhbHVlcyBpbiB0aGUgc291cmNlIGFkZGVkIHRvIGl0LlxyXG4gKiBJdCBvdmVyd3JpdGVzIGFueSBzb3VyY2UgcHJvcGVydGllcyB3aGljaCBhbHJlYWR5IGV4aXN0IGluIHRhcmdldC5cclxuICogQHBhcmFtIHNvdXJjZU9iamVjdCB0aGUgc291cmNlXHJcbiAqIEBwYXJhbSB0YXJnZXRvYmplY3QgdGhlIHRhcmdldFxyXG4gKiBAcmV0dXJucyB0aGUgcmVzdWx0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gb3ZlcnJpZGVWYWx1ZXM8VD4oc291cmNlT2JqZWN0OiBULCB0YXJnZXRvYmplY3Q6IFQpOiBUIHtcclxuXHRpZiAoIXRhcmdldG9iamVjdCkge1xyXG5cdFx0cmV0dXJuIHRhcmdldG9iamVjdDtcclxuXHR9XHJcblxyXG5cdGxldCByZXN1bHQ6IFQgPSB0YXJnZXRvYmplY3Q7XHJcblxyXG5cdGlmIChzb3VyY2VPYmplY3QpIHtcclxuXHRcdGZvciAobGV0IGZpZWxkIGluIHNvdXJjZU9iamVjdCkge1xyXG5cdFx0XHRpZiAoc291cmNlT2JqZWN0Lmhhc093blByb3BlcnR5KGZpZWxkKSkge1xyXG5cdFx0XHRcdCg8YW55PiByZXN1bHQpW2ZpZWxkXSA9ICg8YW55PiBzb3VyY2VPYmplY3QpW2ZpZWxkXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmV0dXJuIHJlc3VsdDtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBcIjEuMi43XCI7IiwiLyoqXHJcbiAqIFdpbmRvd1Byb3BlcnRpZXMudHNcclxuICpcclxuICogTW9kdWxlIHRvIHRyYWNrIHdpbmRvdyBwcm9wZXJ0aWVzLlxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBJcyB0aGUgd2luZG93IG5hcnJvdz9cclxuICogQHJldHVybnMgVHJ1ZSBpZiBpdCBpcywgZmFsc2Ugb3RoZXJ3aXNlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNOYXJyb3coKTogYm9vbGVhbiB7XHJcblx0bGV0IG5hcnJvd1NjcmVlbkJvdW5kYXJ5OiBudW1iZXIgPSA4MDA7XHJcblxyXG5cdGlmICh3aW5kb3cuaW5uZXJXaWR0aCkge1xyXG5cdFx0cmV0dXJuIHdpbmRvdy5pbm5lcldpZHRoIDwgbmFycm93U2NyZWVuQm91bmRhcnk7XHJcblx0fVxyXG5cclxuXHQvLyBpZiB3ZSBjYW4ndCBmaW5kIHRoZSB3aWR0aDsgZ28gd2l0aCBuYXJyb3cuXHJcblx0cmV0dXJuIHRydWU7XHJcbn1cclxuIiwi77u/LyoqXHJcbiAqIFdpbmRvdy50c1xyXG4gKlxyXG4gKiBNb2R1bGUgd3JhcHBpbmcgYXJvdW5kIHRoZSBnbG9iYWwgd2luZG93IG9iamVjdFxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIENvbmZpZ3VyYXRpb24gZnJvbSBcIi4vLi4vQ29uZmlndXJhdGlvbi9Db25maWd1cmF0aW9uXCI7XHJcbmltcG9ydCB7IElMYXVuY2hPcHRpb25zSW5BcHBGZWVkYmFjayB9IGZyb20gXCIuLy4uL0NvbmZpZ3VyYXRpb24vSUxhdW5jaE9wdGlvbnNcIjtcclxuaW1wb3J0IElDdXN0b21TdXJ2ZXkgZnJvbSBcIi4vLi4vRmxvb2RnYXRlQ29yZS9JQ3VzdG9tU3VydmV5XCI7XHJcbmltcG9ydCBJVUlTdXJ2ZXkgZnJvbSBcIi4vLi4vRmxvb2RnYXRlQ29yZS9VSVN1cnZleS9JVUlTdXJ2ZXlcIjtcclxuaW1wb3J0IHsgRmxvb2RnYXRlRW5naW5lIH0gZnJvbSBcIkBtcy1vZmIvb2ZmaWNlZmxvb2RnYXRlY29yZVwiO1xyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgSVdpbmRvdyBvYmplY3RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXQoKTogSVdpbmRvdyB7IHJldHVybiA8YW55PiB3aW5kb3c7IH1cclxuXHJcbi8qKlxyXG4gKiBTZXQgdGhlIHNldFVpU3RyaW5ncygpIG1ldGhvZFxyXG4gKiBAcGFyYW0gc2V0VWlTdHJpbmdzIHRoZSBtZXRob2RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRTZXRVaVN0cmluZ3Moc2V0VWlTdHJpbmdzOiAoZGF0YTogYW55KSA9PiB2b2lkKSB7XHJcblx0KDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrID0gKDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrIHx8IHt9O1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5zZXRVaVN0cmluZ3MgPSBzZXRVaVN0cmluZ3M7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgdGhlIHNpbmdsZUZlZWRiYWNrKCkgbWV0aG9kXHJcbiAqIEBwYXJhbSBzaW5nbGVGZWVkYmFjayB0aGUgbWV0aG9kXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0U2luZ2xlRmVlZGJhY2soXHJcblx0c2luZ2xlRmVlZGJhY2s6IChmZWVkYmFja1R5cGU6IHN0cmluZywgbGF1bmNoT3B0aW9uczogSUxhdW5jaE9wdGlvbnNJbkFwcEZlZWRiYWNrKSA9PiBQcm9taXNlPGFueT4pIHtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2sgPSAoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2sgfHwge307XHJcblx0KDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLnNpbmdsZUZlZWRiYWNrID0gc2luZ2xlRmVlZGJhY2s7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgdGhlIG11bHRpRmVlZGJhY2soKSBtZXRob2RcclxuICogQHBhcmFtIG11bHRpRmVlZGJhY2sgdGhlIG1ldGhvZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNldE11bHRpRmVlZGJhY2soXHJcblx0bXVsdGlGZWVkYmFjazogKGxhdW5jaE9wdGlvbnM6IElMYXVuY2hPcHRpb25zSW5BcHBGZWVkYmFjaykgPT4gUHJvbWlzZTxhbnk+KSB7XHJcblx0KDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrID0gKDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrIHx8IHt9O1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5tdWx0aUZlZWRiYWNrID0gbXVsdGlGZWVkYmFjaztcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCB0aGUgZmxvb2RnYXRlIHNob3dTdXJ2ZXkoKSBtZXRob2RcclxuICogQHBhcmFtIGZsb29kZ2F0ZVNob3dTdXJ2ZXkgdGhlIG1ldGhvZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNldEZsb29kZ2F0ZVNob3dTdXJ2ZXkoZmxvb2RnYXRlU2hvd1N1cnZleTogKHN1cnZleTogSVVJU3VydmV5KSA9PiBQcm9taXNlPGFueT4pIHtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2sgPSAoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2sgfHwge307XHJcblx0KDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmZsb29kZ2F0ZSA9ICg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUgfHwge307XHJcblx0KDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmZsb29kZ2F0ZS5zaG93U3VydmV5ID0gZmxvb2RnYXRlU2hvd1N1cnZleTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCB0aGUgZmxvb2RnYXRlIHNob3dDdXN0b21TdXJ2ZXkoKSBtZXRob2RcclxuICogQHBhcmFtIGZsb29kZ2F0ZVNob3dTdXJ2ZXkgdGhlIG1ldGhvZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNldEZsb29kZ2F0ZVNob3dDdXN0b21TdXJ2ZXkoZmxvb2RnYXRlU2hvd0N1c3RvbVN1cnZleTogKHN1cnZleTogSUN1c3RvbVN1cnZleSkgPT4gUHJvbWlzZTxhbnk+KSB7XHJcblx0KDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrID0gKDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrIHx8IHt9O1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUgPSAoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlIHx8IHt9O1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUuc2hvd0N1c3RvbVN1cnZleSA9IGZsb29kZ2F0ZVNob3dDdXN0b21TdXJ2ZXk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgdGhlIGZsb29kZ2F0ZSBpbml0aWFsaXplKCkgbWV0aG9kXHJcbiAqIEBwYXJhbSBmbG9vZGdhdGVJbml0aWFsaXplIHRoZSBtZXRob2RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRGbG9vZGdhdGVJbml0aWFsaXplKGZsb29kZ2F0ZUluaXRpYWxpemU6ICgpID0+IFByb21pc2U8YW55Pikge1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjayA9ICg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjayB8fCB7fTtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlID0gKDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmZsb29kZ2F0ZSB8fCB7fTtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlLmluaXRpYWxpemUgPSBmbG9vZGdhdGVJbml0aWFsaXplO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IHRoZSBmbG9vZGdhdGUgc3RhcnQoKSBtZXRob2RcclxuICogQHBhcmFtIGZsb29kZ2F0ZVN0YXJ0IHRoZSBtZXRob2RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRGbG9vZGdhdGVTdGFydChmbG9vZGdhdGVTdGFydDogKCkgPT4gUHJvbWlzZTxhbnk+KSB7XHJcblx0KDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrID0gKDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrIHx8IHt9O1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUgPSAoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlIHx8IHt9O1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjay5mbG9vZGdhdGUuc3RhcnQgPSBmbG9vZGdhdGVTdGFydDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCB0aGUgZmxvb2RnYXRlIHN0b3AoKSBtZXRob2RcclxuICogQHBhcmFtIGZsb29kZ2F0ZVN0b3AgdGhlIG1ldGhvZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNldEZsb29kZ2F0ZVN0b3AoZmxvb2RnYXRlU3RvcDogKCkgPT4gdm9pZCkge1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjayA9ICg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjayB8fCB7fTtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlID0gKDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmZsb29kZ2F0ZSB8fCB7fTtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlLnN0b3AgPSBmbG9vZGdhdGVTdG9wO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IHRoZSBmbG9vZGdhdGUgZ2V0RW5naW5lKCkgbWV0aG9kXHJcbiAqIEBwYXJhbSBmbG9vZGdhdGVHZXRFbmdpbmUgdGhlIG1ldGhvZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNldEZsb29kZ2F0ZUdldEVuZ2luZShmbG9vZGdhdGVHZXRFbmdpbmU6ICgpID0+IEZsb29kZ2F0ZUVuZ2luZSkge1xyXG5cdCg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjayA9ICg8YW55PiB3aW5kb3cpLk9mZmljZUJyb3dzZXJGZWVkYmFjayB8fCB7fTtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlID0gKDxhbnk+IHdpbmRvdykuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmZsb29kZ2F0ZSB8fCB7fTtcclxuXHQoPGFueT4gd2luZG93KS5PZmZpY2VCcm93c2VyRmVlZGJhY2suZmxvb2RnYXRlLmdldEVuZ2luZSA9IGZsb29kZ2F0ZUdldEVuZ2luZTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJSW5pdE9wdGlvbnMgZXh0ZW5kcyBDb25maWd1cmF0aW9uLklJbml0T3B0aW9uc0NvbW1vbiwgQ29uZmlndXJhdGlvbi5JSW5pdE9wdGlvbnNJbkFwcEZlZWRiYWNrIHtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJRmxvb2RnYXRlIHtcclxuXHRpbml0T3B0aW9uczogQ29uZmlndXJhdGlvbi5JSW5pdE9wdGlvbnNGbG9vZGdhdGU7XHJcblx0c2hvd1N1cnZleTogKHN1cnZleTogSVVJU3VydmV5KSA9PiBQcm9taXNlPGFueT47XHJcblx0aW5pdGlhbGl6ZTogKCkgPT4gUHJvbWlzZTxhbnk+O1xyXG5cdHN0YXJ0OiAoKSA9PiBQcm9taXNlPGFueT47XHJcblx0c3RvcDogKCkgPT4gdm9pZDtcclxuXHRnZXRFbmdpbmU6ICgpID0+IEZsb29kZ2F0ZUVuZ2luZTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJV2luZG93IGV4dGVuZHMgV2luZG93TG9jYWxTdG9yYWdlIHtcclxuXHRPZmZpY2VCcm93c2VyRmVlZGJhY2s6IHtcclxuXHRcdGluaXRPcHRpb25zOiBJSW5pdE9wdGlvbnM7XHJcblx0XHRtdWx0aUZlZWRiYWNrOiAobGF1bmNoT3B0aW9uczogSUxhdW5jaE9wdGlvbnNJbkFwcEZlZWRiYWNrKSA9PiBQcm9taXNlPGFueT47XHJcblx0XHRzZGtWZXJzaW9uOiBzdHJpbmc7XHJcblx0XHRzaW5nbGVGZWVkYmFjazogKGZlZWRiYWNrVHlwZTogc3RyaW5nLCBsYXVuY2hPcHRpb25zOiBJTGF1bmNoT3B0aW9uc0luQXBwRmVlZGJhY2spID0+IFByb21pc2U8YW55PjtcclxuXHRcdHNldFVpU3RyaW5nczogKGRhdGE6IGFueSkgPT4gdm9pZDtcclxuXHRcdGh0bWwyY2FudmFzOiAoKSA9PiAoKGRvbTogYW55LCBvcHRpb25zOiBhbnkpID0+IFByb21pc2U8SFRNTENhbnZhc0VsZW1lbnQ+KTtcclxuXHRcdGZsb29kZ2F0ZTogSUZsb29kZ2F0ZTtcclxuXHR9O1xyXG59XHJcbiIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XHJcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxyXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XHJcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXHJcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xyXG5cdGVsc2Uge1xyXG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XHJcblx0XHRmb3IodmFyIGkgaW4gYSkgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyA/IGV4cG9ydHMgOiByb290KVtpXSA9IGFbaV07XHJcblx0fVxyXG59KSh0aGlzLCBmdW5jdGlvbigpIHtcclxucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcclxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXHJcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcclxuLyoqKioqKi9cclxuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxyXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcclxuLyoqKioqKi9cclxuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxyXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXHJcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xyXG4vKioqKioqL1xyXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcclxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcclxuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXHJcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcclxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxyXG4vKioqKioqLyBcdFx0fTtcclxuLyoqKioqKi9cclxuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxyXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XHJcbi8qKioqKiovXHJcbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXHJcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcclxuLyoqKioqKi9cclxuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXHJcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XHJcbi8qKioqKiovIFx0fVxyXG4vKioqKioqL1xyXG4vKioqKioqL1xyXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXHJcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcclxuLyoqKioqKi9cclxuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxyXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XHJcbi8qKioqKiovXHJcbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cclxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xyXG4vKioqKioqL1xyXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xyXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xyXG4vKioqKioqLyB9KVxyXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4vKioqKioqLyAoW1xyXG4vKiAwICovXHJcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xyXG5cclxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XHJcblxyXG5cclxuLyoqKi8gfSxcclxuLyogMSAqL1xyXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcclxuXHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0LyoqXHJcblx0KiBBcmlhU0RLLnRzXHJcblx0KiBBdXRob3I6IEFiaGlsYXNoIFBhbndhciAoYWJwYW53YXIpXHJcblx0KiBDb3B5cmlnaHQ6IE1pY3Jvc29mdCAyMDE2XHJcblx0Ki9cclxuXHR2YXIgRW51bXNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XHJcblx0ZXhwb3J0cy5BV1RQaWlLaW5kID0gRW51bXNfMS5BV1RQaWlLaW5kO1xyXG5cdHZhciBBV1RfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XHJcblx0ZXhwb3J0cy5BV1QgPSBBV1RfMS5kZWZhdWx0O1xyXG5cdGV4cG9ydHMuQVdUX0NPTExFQ1RPUl9VUkxfVU5JVEVEX1NUQVRFUyA9ICdodHRwczovL3VzLnBpcGUuYXJpYS5taWNyb3NvZnQuY29tL0NvbGxlY3Rvci8zLjAvJztcclxuXHRleHBvcnRzLkFXVF9DT0xMRUNUT1JfVVJMX0dFUk1BTlkgPSAnaHR0cHM6Ly9kZS5waXBlLmFyaWEubWljcm9zb2Z0LmNvbS9Db2xsZWN0b3IvMy4wLyc7XHJcblx0ZXhwb3J0cy5BV1RfQ09MTEVDVE9SX1VSTF9KQVBBTiA9ICdodHRwczovL2pwLnBpcGUuYXJpYS5taWNyb3NvZnQuY29tL0NvbGxlY3Rvci8zLjAvJztcclxuXHRleHBvcnRzLkFXVF9DT0xMRUNUT1JfVVJMX0FVU1RSQUxJQSA9ICdodHRwczovL2F1LnBpcGUuYXJpYS5taWNyb3NvZnQuY29tL0NvbGxlY3Rvci8zLjAvJztcclxuXHRleHBvcnRzLkFXVF9DT0xMRUNUT1JfVVJMX0VVUk9QRSA9ICdodHRwczovL2V1LnBpcGUuYXJpYS5taWNyb3NvZnQuY29tL0NvbGxlY3Rvci8zLjAvJztcclxuXHJcblxyXG4vKioqLyB9LFxyXG4vKiAyICovXHJcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xyXG5cclxuXHQvKipcclxuXHQqIEVudW1zLnRzXHJcblx0KiBBdXRob3I6IEFiaGlsYXNoIFBhbndhciAoYWJwYW53YXIpXHJcblx0KiBDb3B5cmlnaHQ6IE1pY3Jvc29mdCAyMDE2XHJcblx0KiBDb21tb24gZW51bSB2YWx1ZXMgdXNlZCBpbiB0aGUgU0RLLlxyXG5cdCovXHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIEFXVFBpaUtpbmQ7XHJcblx0KGZ1bmN0aW9uIChBV1RQaWlLaW5kKSB7XHJcblx0ICAgIEFXVFBpaUtpbmRbQVdUUGlpS2luZFtcIk5vdFNldFwiXSA9IDBdID0gXCJOb3RTZXRcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiRGlzdGluZ3Vpc2hlZE5hbWVcIl0gPSAxXSA9IFwiRGlzdGluZ3Vpc2hlZE5hbWVcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiR2VuZXJpY0RhdGFcIl0gPSAyXSA9IFwiR2VuZXJpY0RhdGFcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiSVBWNEFkZHJlc3NcIl0gPSAzXSA9IFwiSVBWNEFkZHJlc3NcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiSVB2NkFkZHJlc3NcIl0gPSA0XSA9IFwiSVB2NkFkZHJlc3NcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiTWFpbFN1YmplY3RcIl0gPSA1XSA9IFwiTWFpbFN1YmplY3RcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiUGhvbmVOdW1iZXJcIl0gPSA2XSA9IFwiUGhvbmVOdW1iZXJcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiUXVlcnlTdHJpbmdcIl0gPSA3XSA9IFwiUXVlcnlTdHJpbmdcIjtcclxuXHQgICAgQVdUUGlpS2luZFtBV1RQaWlLaW5kW1wiU2lwQWRkcmVzc1wiXSA9IDhdID0gXCJTaXBBZGRyZXNzXCI7XHJcblx0ICAgIEFXVFBpaUtpbmRbQVdUUGlpS2luZFtcIlNtdHBBZGRyZXNzXCJdID0gOV0gPSBcIlNtdHBBZGRyZXNzXCI7XHJcblx0ICAgIEFXVFBpaUtpbmRbQVdUUGlpS2luZFtcIklkZW50aXR5XCJdID0gMTBdID0gXCJJZGVudGl0eVwiO1xyXG5cdCAgICBBV1RQaWlLaW5kW0FXVFBpaUtpbmRbXCJVcmlcIl0gPSAxMV0gPSBcIlVyaVwiO1xyXG5cdCAgICBBV1RQaWlLaW5kW0FXVFBpaUtpbmRbXCJGcWRuXCJdID0gMTJdID0gXCJGcWRuXCI7XHJcblx0ICAgIC8vIFN1cHBvcnRzIHNjcnViYmluZyBvZiB0aGUgbGFzdCBvY3RldCBpbiBhIElQVjQgYWRkcmVzcy4gRS5nLiAxMC4xMjEuMjI3LjE0NyBiZWNvbWVzIDEwLjEyMS4yMjcuKlxyXG5cdCAgICBBV1RQaWlLaW5kW0FXVFBpaUtpbmRbXCJJUFY0QWRkcmVzc0xlZ2FjeVwiXSA9IDEzXSA9IFwiSVBWNEFkZHJlc3NMZWdhY3lcIjtcclxuXHR9KShBV1RQaWlLaW5kID0gZXhwb3J0cy5BV1RQaWlLaW5kIHx8IChleHBvcnRzLkFXVFBpaUtpbmQgPSB7fSkpO1xyXG5cclxuXHJcbi8qKiovIH0sXHJcbi8qIDMgKi9cclxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XHJcblxyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBFbnVtc18xID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcclxuXHR2YXIgQVdUVHJhbnNtaXNzaW9uTWFuYWdlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcclxuXHR2YXIgVXRpbHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTtcclxuXHR2YXIgVmVyc2lvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMTUpO1xyXG5cdHZhciBBbGxUb2tlbnMgPSAnYWxsVGtucyc7XHJcblx0dmFyIEV2ZW50TmFtZUFuZFR5cGVSZWdleCA9IC9eW2EtekEtWjAtOV0oW2EtekEtWjAtOV18Xyl7Miw5OH1bYS16QS1aMC05XSQvO1xyXG5cdHZhciBFdmVudE5hbWVEb3RSZWdleCA9IC9cXC4vZztcclxuXHR2YXIgUHJvcGVydHlOYW1lUmVnZXggPSAvXlthLXpBLVowLTldKChbYS16QS1aMC05fF98XFwuXSl7MCw5OH1bYS16QS1aMC05XSk/JC87XHJcblx0dmFyIEFXVCA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIEFXVCgpIHtcclxuXHQgICAgfVxyXG5cdCAgICBBV1QuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICh0ZW5hbnRUb2tlbiwgY29uZmlndXJhdGlvbikge1xyXG5cdCAgICAgICAgaWYgKGNvbmZpZ3VyYXRpb24gPT09IHZvaWQgMCkgeyBjb25maWd1cmF0aW9uID0ge307IH1cclxuXHQgICAgICAgIGlmICh0aGlzLl9pc0luaXRpYWxpemVkKSB7XHJcblx0ICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXHJcblx0ICAgICAgICAgICAgdGhyb3cgJ0FscmVhZHkgSW5pdGlhbGl6ZWQnO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdGhpcy5fZGVmYXVsdFRlbmFudFRva2VuID0gdGVuYW50VG9rZW47XHJcblx0ICAgICAgICB0aGlzLl9vdmVycmlkZVZhbHVlc0Zyb21Db25maWcoY29uZmlndXJhdGlvbik7XHJcblx0ICAgICAgICAvL0NyZWF0ZSBzZW5kZXJcclxuXHQgICAgICAgIEFXVFRyYW5zbWlzc2lvbk1hbmFnZXJfMS5kZWZhdWx0LmluaXRpYWxpemUodGhpcy5fY29uZmlnKTtcclxuXHQgICAgICAgIHRoaXMuX2lzSW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1QuZmx1c2ggPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcclxuXHQgICAgICAgIGlmICh0aGlzLl9pc0luaXRpYWxpemVkICYmICF0aGlzLl9pc0Rlc3Ryb3llZCkge1xyXG5cdCAgICAgICAgICAgIEFXVFRyYW5zbWlzc2lvbk1hbmFnZXJfMS5kZWZhdWx0LmZsdXNoKGNhbGxiYWNrKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgQVdULmZsdXNoQW5kVGVhcmRvd24gPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICBpZiAodGhpcy5faXNJbml0aWFsaXplZCAmJiAhdGhpcy5faXNEZXN0cm95ZWQpIHtcclxuXHQgICAgICAgICAgICB0aGlzLl9pc0Rlc3Ryb3llZCA9IHRydWU7XHJcblx0ICAgICAgICAgICAgQVdUVHJhbnNtaXNzaW9uTWFuYWdlcl8xLmRlZmF1bHQuZmx1c2hBbmRUZWFyZG93bigpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICBBV1Quc2V0Q29udGV4dCA9IGZ1bmN0aW9uIChuYW1lLCBwcm9wZXJ0eSwgdGVuYW50VG9rZW4pIHtcclxuXHQgICAgICAgIGlmICh0ZW5hbnRUb2tlbiA9PT0gdm9pZCAwKSB7IHRlbmFudFRva2VuID0gQWxsVG9rZW5zOyB9XHJcblx0ICAgICAgICBwcm9wZXJ0eSA9IHRoaXMuX3Nhbml0aXplUHJvcGVydHkobmFtZSwgcHJvcGVydHkpO1xyXG5cdCAgICAgICAgaWYgKHByb3BlcnR5ID09PSBudWxsKSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgaWYgKCF0aGlzLl9jb250ZXh0UHJvcGVydGllc1t0ZW5hbnRUb2tlbl0pIHtcclxuXHQgICAgICAgICAgICB0aGlzLl9jb250ZXh0UHJvcGVydGllc1t0ZW5hbnRUb2tlbl0gPSB7fTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHRoaXMuX2NvbnRleHRQcm9wZXJ0aWVzW3RlbmFudFRva2VuXVtuYW1lXSA9IHByb3BlcnR5O1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1QubG9nRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBpZiAodGhpcy5faXNJbml0aWFsaXplZCkge1xyXG5cdCAgICAgICAgICAgIGlmICghZXZlbnQubmFtZSB8fCAhZXZlbnQucHJvcGVydGllcykge1xyXG5cdCAgICAgICAgICAgICAgICByZXR1cm47XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGV2ZW50Lm5hbWUgPSBldmVudC5uYW1lLnRvTG93ZXJDYXNlKCk7XHJcblx0ICAgICAgICAgICAgZXZlbnQubmFtZS5yZXBsYWNlKEV2ZW50TmFtZURvdFJlZ2V4LCAnXycpO1xyXG5cdCAgICAgICAgICAgIHZhciB0eXBlUHJlZml4ID0gJyc7XHJcblx0ICAgICAgICAgICAgaWYgKCFldmVudC50eXBlKSB7XHJcblx0ICAgICAgICAgICAgICAgIGV2ZW50LnR5cGUgPSAnY3VzdG9tJztcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZWxzZSB7XHJcblx0ICAgICAgICAgICAgICAgIGV2ZW50LnR5cGUudG9Mb3dlckNhc2UoKTtcclxuXHQgICAgICAgICAgICAgICAgdHlwZVByZWZpeCA9ICdjdXN0b20uJztcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgaWYgKCFFdmVudE5hbWVBbmRUeXBlUmVnZXgudGVzdChldmVudC5uYW1lKSB8fCAhRXZlbnROYW1lQW5kVHlwZVJlZ2V4LnRlc3QoZXZlbnQudHlwZSkpIHtcclxuXHQgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBldmVudC50eXBlID0gdHlwZVByZWZpeCArIGV2ZW50LnR5cGU7XHJcblx0ICAgICAgICAgICAgaWYgKGlzTmFOKGV2ZW50LnRpbWVzdGFtcCkpIHtcclxuXHQgICAgICAgICAgICAgICAgZXZlbnQudGltZXN0YW1wID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgaWYgKCFldmVudC50ZW5hbnRUb2tlbikge1xyXG5cdCAgICAgICAgICAgICAgICBldmVudC50ZW5hbnRUb2tlbiA9IHRoaXMuX2RlZmF1bHRUZW5hbnRUb2tlbjtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZXZlbnQuaWQgPSBVdGlscy5uZXdHdWlkKCk7XHJcblx0ICAgICAgICAgICAgT2JqZWN0LmtleXMoZXZlbnQucHJvcGVydGllcykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xyXG5cdCAgICAgICAgICAgICAgICBldmVudC5wcm9wZXJ0aWVzW25hbWVdID0gX3RoaXMuX3Nhbml0aXplUHJvcGVydHkobmFtZSwgZXZlbnQucHJvcGVydGllc1tuYW1lXSk7XHJcblx0ICAgICAgICAgICAgICAgIGlmIChldmVudC5wcm9wZXJ0aWVzW25hbWVdID09PSBudWxsKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgICBkZWxldGUgZXZlbnQucHJvcGVydGllc1tuYW1lXTtcclxuXHQgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgICAgIHRoaXMuX2FkZENvbnRleHRJZkFic2VudChldmVudCwgZXZlbnQudGVuYW50VG9rZW4pO1xyXG5cdCAgICAgICAgICAgIHRoaXMuX2FkZENvbnRleHRJZkFic2VudChldmVudCwgQWxsVG9rZW5zKTtcclxuXHQgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoZXZlbnQucHJvcGVydGllcykubGVuZ3RoID09PSAwKSB7XHJcblx0ICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgdGhpcy5fc2V0RGVmYXVsdFByb3BlcnR5KGV2ZW50LCAnRXZlbnRJbmZvLkluaXRJZCcsIHRoaXMuX2dldEluaXRJZChldmVudC50ZW5hbnRUb2tlbikpO1xyXG5cdCAgICAgICAgICAgIHRoaXMuX3NldERlZmF1bHRQcm9wZXJ0eShldmVudCwgJ0V2ZW50SW5mby5TZXF1ZW5jZScsIHRoaXMuX2dldFNlcXVlbmNlSWQoZXZlbnQudGVuYW50VG9rZW4pKTtcclxuXHQgICAgICAgICAgICB0aGlzLl9zZXREZWZhdWx0UHJvcGVydHkoZXZlbnQsICdFdmVudEluZm8uU2RrVmVyc2lvbicsIFZlcnNpb24uRnVsbFZlcnNpb25TdHJpbmcpO1xyXG5cdCAgICAgICAgICAgIHRoaXMuX3NldERlZmF1bHRQcm9wZXJ0eShldmVudCwgJ0V2ZW50SW5mby5OYW1lJywgZXZlbnQubmFtZSk7XHJcblx0ICAgICAgICAgICAgdGhpcy5fc2V0RGVmYXVsdFByb3BlcnR5KGV2ZW50LCAnRXZlbnRJbmZvLlRpbWUnLCAobmV3IERhdGUoZXZlbnQudGltZXN0YW1wKSkudG9JU09TdHJpbmcoKSk7XHJcblx0ICAgICAgICAgICAgQVdUVHJhbnNtaXNzaW9uTWFuYWdlcl8xLmRlZmF1bHQuc2VuZEV2ZW50KGV2ZW50KTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgQVdULl9vdmVycmlkZVZhbHVlc0Zyb21Db25maWcgPSBmdW5jdGlvbiAoY29uZmlnKSB7XHJcblx0ICAgICAgICBpZiAoY29uZmlnLmNvbGxlY3RvclVybCkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5jb2xsZWN0b3JVcmwgPSBjb25maWcuY29sbGVjdG9yVXJsO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgaWYgKGNvbmZpZy5zZW5kaW5nVGltZXIgPiAxMDAwKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fY29uZmlnLnNlbmRpbmdUaW1lciA9IGNvbmZpZy5zZW5kaW5nVGltZXI7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIEFXVC5fZ2V0SW5pdElkID0gZnVuY3Rpb24gKHRlbmFudFRva2VuKSB7XHJcblx0ICAgICAgICBpZiAodGhpcy5faW5pdElkTWFwW3RlbmFudFRva2VuXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5faW5pdElkTWFwW3RlbmFudFRva2VuXSA9IFV0aWxzLm5ld0d1aWQoKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiB0aGlzLl9pbml0SWRNYXBbdGVuYW50VG9rZW5dO1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1QuX2dldFNlcXVlbmNlSWQgPSBmdW5jdGlvbiAodGVuYW50VG9rZW4pIHtcclxuXHQgICAgICAgIGlmICh0aGlzLl9zZXF1ZW5jZUlkTWFwW3RlbmFudFRva2VuXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fc2VxdWVuY2VJZE1hcFt0ZW5hbnRUb2tlbl0gPSAwO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuICgrK3RoaXMuX3NlcXVlbmNlSWRNYXBbdGVuYW50VG9rZW5dKS50b1N0cmluZygpO1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1QuX3NldERlZmF1bHRQcm9wZXJ0eSA9IGZ1bmN0aW9uIChldmVudCwgbmFtZSwgdmFsdWUpIHtcclxuXHQgICAgICAgIGV2ZW50LnByb3BlcnRpZXNbbmFtZV0gPSB7IHZhbHVlOiB2YWx1ZSwgcGlpOiBFbnVtc18xLkFXVFBpaUtpbmQuTm90U2V0IH07XHJcblx0ICAgIH07XHJcblx0ICAgIEFXVC5fYWRkQ29udGV4dElmQWJzZW50ID0gZnVuY3Rpb24gKGV2ZW50LCB0ZW5hbnRUb2tlbikge1xyXG5cdCAgICAgICAgaWYgKHRoaXMuX2NvbnRleHRQcm9wZXJ0aWVzW3RlbmFudFRva2VuXSkge1xyXG5cdCAgICAgICAgICAgIHZhciBjb250ZXh0XzEgPSB0aGlzLl9jb250ZXh0UHJvcGVydGllc1t0ZW5hbnRUb2tlbl07XHJcblx0ICAgICAgICAgICAgT2JqZWN0LmtleXMoY29udGV4dF8xKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XHJcblx0ICAgICAgICAgICAgICAgIGlmICghZXZlbnQucHJvcGVydGllc1tuYW1lXSkge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJvcGVydGllc1tuYW1lXSA9IGNvbnRleHRfMVtuYW1lXTtcclxuXHQgICAgICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICBBV1QuX3Nhbml0aXplUHJvcGVydHkgPSBmdW5jdGlvbiAobmFtZSwgcHJvcGVydHkpIHtcclxuXHQgICAgICAgIGlmICh0eXBlb2YgcHJvcGVydHkgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBwcm9wZXJ0eSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHByb3BlcnR5ID09PSAnYm9vbGVhbicpIHtcclxuXHQgICAgICAgICAgICBwcm9wZXJ0eSA9IHsgdmFsdWU6IHByb3BlcnR5IH07XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBpZiAoIVByb3BlcnR5TmFtZVJlZ2V4LnRlc3QobmFtZSkgfHwgcHJvcGVydHkgPT09IHVuZGVmaW5lZCB8fCBwcm9wZXJ0eSA9PT0gbnVsbFxyXG5cdCAgICAgICAgICAgIHx8IHByb3BlcnR5LnZhbHVlID09PSBudWxsIHx8IHByb3BlcnR5LnZhbHVlID09PSB1bmRlZmluZWQgfHwgcHJvcGVydHkudmFsdWUgPT09ICcnKSB7XHJcblx0ICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBpZiAodHlwZW9mIHByb3BlcnR5LnBpaSA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuXHQgICAgICAgICAgICBwcm9wZXJ0eS5waWkgPSBFbnVtc18xLkFXVFBpaUtpbmQuTm90U2V0O1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcHJvcGVydHkudmFsdWUgPSBwcm9wZXJ0eS52YWx1ZS50b1N0cmluZygpO1xyXG5cdCAgICAgICAgcmV0dXJuIFV0aWxzLmlzUGlpKHByb3BlcnR5LnBpaSkgPyBwcm9wZXJ0eSA6IG51bGw7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBBV1Q7XHJcblx0fSgpKTtcclxuXHRBV1QuX2lzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuXHRBV1QuX2lzRGVzdHJveWVkID0gZmFsc2U7XHJcblx0QVdULl9jb250ZXh0UHJvcGVydGllcyA9IHt9O1xyXG5cdEFXVC5fc2VxdWVuY2VJZE1hcCA9IHt9O1xyXG5cdEFXVC5faW5pdElkTWFwID0ge307XHJcblx0QVdULl9jb25maWcgPSB7XHJcblx0ICAgIGNvbGxlY3RvclVybDogJ2h0dHBzOi8vYnJvd3Nlci5waXBlLmFyaWEubWljcm9zb2Z0LmNvbS9Db2xsZWN0b3IvMy4wLycsXHJcblx0ICAgIHNlbmRpbmdUaW1lcjogMTAwMFxyXG5cdH07XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IEFXVDtcclxuXHJcblxyXG4vKioqLyB9LFxyXG4vKiA0ICovXHJcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xyXG5cclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgQVdUUmVjb3JkQmF0Y2hlcl8xID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcclxuXHR2YXIgQVdUQm9uZFNlcmlhbGl6ZXJfMSA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XHJcblx0dmFyIEFXVFJldHJ5UG9saWN5XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEzKTtcclxuXHR2YXIgQVdUS2lsbFN3aXRjaF8xID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7XHJcblx0dmFyIFZlcnNpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTtcclxuXHR2YXIgRmx1c2hDaGVja1RpbWVyID0gMjUwO1xyXG5cdHZhciBSZXF1ZXN0U2l6ZUxpbWl0Qnl0ZXMgPSAyOTM2MDEyOyAvL2FwcHJveCAyLjggTWJcclxuXHR2YXIgTWF4UmV0cmllcyA9IDQ7XHJcblx0dmFyIEFXVFRyYW5zbWlzc2lvbk1hbmFnZXIgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBBV1RUcmFuc21pc3Npb25NYW5hZ2VyKCkge1xyXG5cdCAgICB9XHJcblx0ICAgIEFXVFRyYW5zbWlzc2lvbk1hbmFnZXIuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuXHQgICAgICAgIHRoaXMuX2luYm91bmRRdWV1ZXMucHVzaChbXSk7XHJcblx0ICAgICAgICB0aGlzLl9yZWNvcmRCYXRjaGVyID0gbmV3IEFXVFJlY29yZEJhdGNoZXJfMS5kZWZhdWx0KFJlcXVlc3RTaXplTGltaXRCeXRlcywgdGhpcy5fb3V0Ym91bmRRdWV1ZSk7XHJcblx0ICAgICAgICB0aGlzLl9uZXdFdmVudHNBbGxvd2VkID0gdHJ1ZTtcclxuXHQgICAgICAgIGlmICh0eXBlb2YgVWludDhBcnJheSA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuXHQgICAgICAgICAgICB0aGlzLl91cmxTdHJpbmcgKz0gJyZjb250ZW50LWVuY29kaW5nPWJhc2U2NCc7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB0aGlzLl9zZW5kaW5nVGltZXIgPSBjb25maWcuc2VuZGluZ1RpbWVyO1xyXG5cdCAgICAgICAgdGhpcy5fdXJsU3RyaW5nID0gY29uZmlnLmNvbGxlY3RvclVybCArIHRoaXMuX3VybFN0cmluZyArICcmeC1hcGlrZXk9JztcclxuXHQgICAgfTtcclxuXHQgICAgLy9QdXNoIHRoZSBldmVudCBpbnRvIHRoZSBpbmJvdW5kIHF1ZXVlIGFuZCByZXR1cm5cclxuXHQgICAgQVdUVHJhbnNtaXNzaW9uTWFuYWdlci5zZW5kRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBpZiAodGhpcy5fbmV3RXZlbnRzQWxsb3dlZCkge1xyXG5cdCAgICAgICAgICAgIC8vQWRkIGV2ZW50IHRvIHRoZSBsYXN0IGluYm91bmQgcXVldWVcclxuXHQgICAgICAgICAgICB0aGlzLl9pbmJvdW5kUXVldWVzW3RoaXMuX2luYm91bmRRdWV1ZXMubGVuZ3RoIC0gMV0ucHVzaChldmVudCk7XHJcblx0ICAgICAgICAgICAgaWYgKCF0aGlzLl9ydW5uaW5nICYmIHRoaXMuX3RpbWVvdXQgPCAwICYmICF0aGlzLl9pc0N1cnJlbnRseUZsdXNoaW5nKSB7XHJcblx0ICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9iYXRjaEFuZFNlbmRFdmVudHMoZmFsc2UpOyB9LCB0aGlzLl9zZW5kaW5nVGltZXIpO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgQVdUVHJhbnNtaXNzaW9uTWFuYWdlci5mbHVzaEFuZFRlYXJkb3duID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgdGhpcy5fbmV3RXZlbnRzQWxsb3dlZCA9IGZhbHNlO1xyXG5cdCAgICAgICAgdGhpcy5fYmF0Y2hBbmRTZW5kRXZlbnRzKHRydWUpO1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RUcmFuc21pc3Npb25NYW5hZ2VyLmZsdXNoID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcblx0ICAgICAgICB0aGlzLl9pbmJvdW5kUXVldWVzLnB1c2goW10pO1xyXG5cdCAgICAgICAgaWYgKCF0aGlzLl9pc0N1cnJlbnRseUZsdXNoaW5nKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5faXNDdXJyZW50bHlGbHVzaGluZyA9IHRydWU7XHJcblx0ICAgICAgICAgICAgdGhpcy5fZmx1c2goY2FsbGJhY2spO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgZWxzZSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fZmx1c2hRdWV1ZS5wdXNoKGNhbGxiYWNrKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgQVdUVHJhbnNtaXNzaW9uTWFuYWdlci5fYmF0Y2hBbmRTZW5kRXZlbnRzID0gZnVuY3Rpb24gKGlzVGVhcmRvd24pIHtcclxuXHQgICAgICAgIHRoaXMuX3J1bm5pbmcgPSB0cnVlO1xyXG5cdCAgICAgICAgd2hpbGUgKHRoaXMuX2luYm91bmRRdWV1ZXNbMF0ubGVuZ3RoID4gMCAmJiB0aGlzLl9vdXRib3VuZFF1ZXVlLmxlbmd0aCA8IDEpIHtcclxuXHQgICAgICAgICAgICB0aGlzLl9yZWNvcmRCYXRjaGVyLmFkZEV2ZW50VG9CYXRjaCh0aGlzLl9pbmJvdW5kUXVldWVzWzBdLnBvcCgpKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGlmICh0aGlzLl9vdXRib3VuZFF1ZXVlLmxlbmd0aCA9PT0gMCkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuX3JlY29yZEJhdGNoZXIuZmx1c2hCYXRjaCgpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgdGhpcy5fc2VuZFJlcXVlc3QodGhpcy5fb3V0Ym91bmRRdWV1ZS5wb3AoKSwgMCwgaXNUZWFyZG93bik7XHJcblx0ICAgIH07XHJcblx0ICAgIEFXVFRyYW5zbWlzc2lvbk1hbmFnZXIuX3JldHJ5UmVxdWVzdElmTmVlZGVkID0gZnVuY3Rpb24gKGNvbm4sIHJlcXVlc3QsIHRva2VuQ291bnQsIGFwaWtleSwgcmV0cnlDb3VudCkge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIHZhciBzaG91bGRSZXRyeSA9IHRydWU7XHJcblx0ICAgICAgICBpZiAoY29ubiAmJiB0eXBlb2YgY29ubi5zdGF0dXMgIT09ICd1bmRlZmluZWQnKSB7XHJcblx0ICAgICAgICAgICAgdmFyIGtpbGxlZFRva2VucyA9IHRoaXMuX2tpbGxTd2l0Y2guc2V0S2lsbFN3aXRjaFRlbmFudHMoY29ubi5nZXRSZXNwb25zZUhlYWRlcigna2lsbC10b2tlbnMnKSwgY29ubi5nZXRSZXNwb25zZUhlYWRlcigna2lsbC1kdXJhdGlvbi1zZWNvbmRzJykpO1xyXG5cdCAgICAgICAgICAgIGtpbGxlZFRva2Vucy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuXHQgICAgICAgICAgICAgICAgZGVsZXRlIHJlcXVlc3Rba2V5XTtcclxuXHQgICAgICAgICAgICAgICAgdG9rZW5Db3VudC0tO1xyXG5cdCAgICAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgICAgIGlmICghQVdUUmV0cnlQb2xpY3lfMS5kZWZhdWx0LnNob3VsZFJldHJ5Rm9yU3RhdHVzKGNvbm4uc3RhdHVzKSB8fCB0b2tlbkNvdW50IDw9IDApIHtcclxuXHQgICAgICAgICAgICAgICAgc2hvdWxkUmV0cnkgPSBmYWxzZTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBpZiAoc2hvdWxkUmV0cnkgJiYgcmV0cnlDb3VudCA8IE1heFJldHJpZXMpIHtcclxuXHQgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9zZW5kUmVxdWVzdChyZXF1ZXN0LCByZXRyeUNvdW50ICsgMSwgZmFsc2UpOyB9LCBBV1RSZXRyeVBvbGljeV8xLmRlZmF1bHQuZ2V0TWlsbGlzVG9CYWNrb2ZmRm9yUmV0cnkocmV0cnlDb3VudCkpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgZWxzZSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5faGFuZGxlUmVxdWVzdEZpbmlzaGVkKG51bGwpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RUcmFuc21pc3Npb25NYW5hZ2VyLl9zZW5kUmVxdWVzdCA9IGZ1bmN0aW9uIChyZXF1ZXN0LCByZXRyeUNvdW50LCBpc1RlYXJkb3duKSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgdmFyIGNvbm4gPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuXHQgICAgICAgIHZhciB0b2tlbkNvdW50ID0gMDtcclxuXHQgICAgICAgIHZhciBhcGlrZXkgPSAnJztcclxuXHQgICAgICAgIE9iamVjdC5rZXlzKHJlcXVlc3QpLmZvckVhY2goZnVuY3Rpb24gKHRva2VuKSB7XHJcblx0ICAgICAgICAgICAgaWYgKCFfdGhpcy5fa2lsbFN3aXRjaC5pc1RlbmFudEtpbGxlZCh0b2tlbikpIHtcclxuXHQgICAgICAgICAgICAgICAgaWYgKGFwaWtleS5sZW5ndGggPiAwKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgICBhcGlrZXkgKz0gJywnO1xyXG5cdCAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgICAgIGFwaWtleSArPSB0b2tlbjtcclxuXHQgICAgICAgICAgICAgICAgdG9rZW5Db3VudCsrO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICAgICAgZGVsZXRlIHJlcXVlc3RbdG9rZW5dO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICAgICAgY29ubi5vcGVuKCdQT1NUJywgdGhpcy5fdXJsU3RyaW5nICsgYXBpa2V5LCAhaXNUZWFyZG93bik7XHJcblx0ICAgICAgICBpZiAoIWlzVGVhcmRvd24pIHtcclxuXHQgICAgICAgICAgICBjb25uLm9udGltZW91dCA9IGZ1bmN0aW9uICgpIHtcclxuXHQgICAgICAgICAgICAgICAgX3RoaXMuX3JldHJ5UmVxdWVzdElmTmVlZGVkKGNvbm4sIHJlcXVlc3QsIHRva2VuQ291bnQsIGFwaWtleSwgcmV0cnlDb3VudCk7XHJcblx0ICAgICAgICAgICAgfTtcclxuXHQgICAgICAgICAgICBjb25uLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgICAgIF90aGlzLl9yZXRyeVJlcXVlc3RJZk5lZWRlZChjb25uLCByZXF1ZXN0LCB0b2tlbkNvdW50LCBhcGlrZXksIHJldHJ5Q291bnQpO1xyXG5cdCAgICAgICAgICAgIH07XHJcblx0ICAgICAgICAgICAgY29ubi5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgICAgIF90aGlzLl9oYW5kbGVSZXF1ZXN0RmluaXNoZWQoY29ubik7XHJcblx0ICAgICAgICAgICAgfTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGlmICh0b2tlbkNvdW50ID4gMCkge1xyXG5cdCAgICAgICAgICAgIHZhciBibG9iID0gQVdUQm9uZFNlcmlhbGl6ZXJfMS5kZWZhdWx0LmdldFBheWxvYWRCbG9iKHJlcXVlc3QsIHRva2VuQ291bnQpO1xyXG5cdCAgICAgICAgICAgIGlmICh0eXBlb2YgVWludDhBcnJheSA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuXHQgICAgICAgICAgICAgICAgY29ubi5zZW5kKEFXVEJvbmRTZXJpYWxpemVyXzEuZGVmYXVsdC5iYXNlNjRFbmNvZGUoYmxvYikpO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICAgICAgY29ubi5zZW5kKG5ldyBVaW50OEFycmF5KGJsb2IpKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIGlmIChpc1RlYXJkb3duKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5faGFuZGxlUmVxdWVzdEZpbmlzaGVkKG51bGwpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RUcmFuc21pc3Npb25NYW5hZ2VyLl9oYW5kbGVSZXF1ZXN0RmluaXNoZWQgPSBmdW5jdGlvbiAoY29ubikge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIGlmIChjb25uKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fa2lsbFN3aXRjaC5zZXRLaWxsU3dpdGNoVGVuYW50cyhjb25uLmdldFJlc3BvbnNlSGVhZGVyKCdraWxsLXRva2VucycpLCBjb25uLmdldFJlc3BvbnNlSGVhZGVyKCdraWxsLWR1cmF0aW9uLXNlY29uZHMnKSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBpZiAodGhpcy5faW5ib3VuZFF1ZXVlc1swXS5sZW5ndGggPiAwKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2JhdGNoQW5kU2VuZEV2ZW50cyhmYWxzZSk7IH0sIHRoaXMuX3NlbmRpbmdUaW1lcik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICB0aGlzLl90aW1lb3V0ID0gLTE7XHJcblx0ICAgICAgICAgICAgdGhpcy5fcnVubmluZyA9IGZhbHNlO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RUcmFuc21pc3Npb25NYW5hZ2VyLl9mbHVzaCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG5cdCAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuXHQgICAgICAgIGlmICghdGhpcy5fcnVubmluZykge1xyXG5cdCAgICAgICAgICAgIGlmICh0aGlzLl90aW1lb3V0ID4gLTEpIHtcclxuXHQgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXQpO1xyXG5cdCAgICAgICAgICAgICAgICB0aGlzLl90aW1lb3V0ID0gLTE7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGlmICh0aGlzLl9pbmJvdW5kUXVldWVzWzBdLmxlbmd0aCA+IDApIHtcclxuXHQgICAgICAgICAgICAgICAgdGhpcy5fYmF0Y2hBbmRTZW5kRXZlbnRzKGZhbHNlKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICB0aGlzLl9jaGVja1ByaW1hcnlJbmJvdW5kUXVldWVFbXB0eShmdW5jdGlvbiAoKSB7XHJcblx0ICAgICAgICAgICAgLy9Nb3ZlIHRoZSBuZXh0IHF1ZXVlIHRvIGJlIHByaW1hcnlcclxuXHQgICAgICAgICAgICBfdGhpcy5faW5ib3VuZFF1ZXVlcy5zaGlmdCgpO1xyXG5cdCAgICAgICAgICAgIGlmIChjYWxsYmFjayAhPT0gbnVsbCAmJiBjYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XHJcblx0ICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGlmIChfdGhpcy5fZmx1c2hRdWV1ZS5sZW5ndGggPiAwKSB7XHJcblx0ICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2ZsdXNoKF90aGlzLl9mbHVzaFF1ZXVlLnNoaWZ0KCkpOyB9LCBfdGhpcy5fc2VuZGluZ1RpbWVyKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZWxzZSB7XHJcblx0ICAgICAgICAgICAgICAgIF90aGlzLl9pc0N1cnJlbnRseUZsdXNoaW5nID0gZmFsc2U7XHJcblx0ICAgICAgICAgICAgICAgIGlmIChfdGhpcy5faW5ib3VuZFF1ZXVlc1swXS5sZW5ndGggPiAwKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5fdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2JhdGNoQW5kU2VuZEV2ZW50cyhmYWxzZSk7IH0sIF90aGlzLl9zZW5kaW5nVGltZXIpO1xyXG5cdCAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfSk7XHJcblx0ICAgIH07XHJcblx0ICAgIEFXVFRyYW5zbWlzc2lvbk1hbmFnZXIuX2NoZWNrUHJpbWFyeUluYm91bmRRdWV1ZUVtcHR5ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgaWYgKHRoaXMuX2luYm91bmRRdWV1ZXNbMF0ubGVuZ3RoID09PSAwKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fY2hlY2tPdXRib3VuZFF1ZXVlRW1wdHlBbmRTZW50KGNhbGxiYWNrKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2NoZWNrUHJpbWFyeUluYm91bmRRdWV1ZUVtcHR5KGNhbGxiYWNrKTsgfSwgRmx1c2hDaGVja1RpbWVyKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfTtcclxuXHQgICAgQVdUVHJhbnNtaXNzaW9uTWFuYWdlci5fY2hlY2tPdXRib3VuZFF1ZXVlRW1wdHlBbmRTZW50ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XHJcblx0ICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cdCAgICAgICAgaWYgKCF0aGlzLl9ydW5uaW5nKSB7XHJcblx0ICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2NoZWNrT3V0Ym91bmRRdWV1ZUVtcHR5QW5kU2VudChjYWxsYmFjayk7IH0sIEZsdXNoQ2hlY2tUaW1lcik7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBBV1RUcmFuc21pc3Npb25NYW5hZ2VyO1xyXG5cdH0oKSk7XHJcblx0QVdUVHJhbnNtaXNzaW9uTWFuYWdlci5fb3V0Ym91bmRRdWV1ZSA9IFtdO1xyXG5cdEFXVFRyYW5zbWlzc2lvbk1hbmFnZXIuX2luYm91bmRRdWV1ZXMgPSBbXTtcclxuXHRBV1RUcmFuc21pc3Npb25NYW5hZ2VyLl9uZXdFdmVudHNBbGxvd2VkID0gZmFsc2U7XHJcblx0QVdUVHJhbnNtaXNzaW9uTWFuYWdlci5fa2lsbFN3aXRjaCA9IG5ldyBBV1RLaWxsU3dpdGNoXzEuZGVmYXVsdCgpO1xyXG5cdEFXVFRyYW5zbWlzc2lvbk1hbmFnZXIuX2lzQ3VycmVudGx5Rmx1c2hpbmcgPSBmYWxzZTtcclxuXHRBV1RUcmFuc21pc3Npb25NYW5hZ2VyLl9mbHVzaFF1ZXVlID0gW107XHJcblx0QVdUVHJhbnNtaXNzaW9uTWFuYWdlci5fcnVubmluZyA9IGZhbHNlO1xyXG5cdEFXVFRyYW5zbWlzc2lvbk1hbmFnZXIuX3RpbWVvdXQgPSAtMTtcclxuXHRBV1RUcmFuc21pc3Npb25NYW5hZ2VyLl91cmxTdHJpbmcgPSAnP3FzcD10cnVlJmNvbnRlbnQtdHlwZT1hcHBsaWNhdGlvbiUyRmJvbmQtY29tcGFjdC1iaW5hcnkmY2xpZW50LWlkPU5PX0FVVEgmc2RrLXZlcnNpb249J1xyXG5cdCAgICArIFZlcnNpb24uRnVsbFZlcnNpb25TdHJpbmc7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IEFXVFRyYW5zbWlzc2lvbk1hbmFnZXI7XHJcblxyXG5cclxuLyoqKi8gfSxcclxuLyogNSAqL1xyXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcclxuXHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIEFXVEJvbmRTZXJpYWxpemVyXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpO1xyXG5cdHZhciBBV1RSZWNvcmRCYXRjaGVyID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gQVdUUmVjb3JkQmF0Y2hlcihfbWF4UmVxdWVzdFNpemUsIF9vdXRib3VuZFF1ZXVlKSB7XHJcblx0ICAgICAgICB0aGlzLl9tYXhSZXF1ZXN0U2l6ZSA9IF9tYXhSZXF1ZXN0U2l6ZTtcclxuXHQgICAgICAgIHRoaXMuX291dGJvdW5kUXVldWUgPSBfb3V0Ym91bmRRdWV1ZTtcclxuXHQgICAgICAgIHRoaXMuX2N1cnJlbnRCYXRjaCA9IHt9O1xyXG5cdCAgICAgICAgdGhpcy5fY3VycmVudEJhdGNoU2l6ZSA9IDA7XHJcblx0ICAgIH1cclxuXHQgICAgQVdUUmVjb3JkQmF0Y2hlci5wcm90b3R5cGUuYWRkRXZlbnRUb0JhdGNoID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcblx0ICAgICAgICB2YXIgc2VyaWFsaXplZEV2ZW50ID0gQVdUQm9uZFNlcmlhbGl6ZXJfMS5kZWZhdWx0LmdldEV2ZW50QmxvYihldmVudCk7XHJcblx0ICAgICAgICBpZiAoc2VyaWFsaXplZEV2ZW50Lmxlbmd0aCA+IHRoaXMuX21heFJlcXVlc3RTaXplKSB7XHJcblx0ICAgICAgICAgICAgLy9zaW5nbGUgZXZlbnQgdG9vIGJpZ1xyXG5cdCAgICAgICAgICAgIHJldHVybjtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGlmICh0aGlzLl9jdXJyZW50QmF0Y2hTaXplICsgc2VyaWFsaXplZEV2ZW50Lmxlbmd0aCA+IHRoaXMuX21heFJlcXVlc3RTaXplKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5mbHVzaEJhdGNoKCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudEJhdGNoW2V2ZW50LnRlbmFudFRva2VuXSA9PT0gdW5kZWZpbmVkKSB7XHJcblx0ICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRCYXRjaFtldmVudC50ZW5hbnRUb2tlbl0gPSBbXTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgdGhpcy5fY3VycmVudEJhdGNoW2V2ZW50LnRlbmFudFRva2VuXS5wdXNoKHNlcmlhbGl6ZWRFdmVudCk7XHJcblx0ICAgICAgICAgICAgdGhpcy5fY3VycmVudEJhdGNoU2l6ZSArPSBzZXJpYWxpemVkRXZlbnQubGVuZ3RoO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RSZWNvcmRCYXRjaGVyLnByb3RvdHlwZS5mbHVzaEJhdGNoID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRCYXRjaFNpemUgPiAwKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fb3V0Ym91bmRRdWV1ZS5wdXNoKHRoaXMuX2N1cnJlbnRCYXRjaCk7XHJcblx0ICAgICAgICAgICAgdGhpcy5fY3VycmVudEJhdGNoID0ge307XHJcblx0ICAgICAgICAgICAgdGhpcy5fY3VycmVudEJhdGNoU2l6ZSA9IDA7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBBV1RSZWNvcmRCYXRjaGVyO1xyXG5cdH0oKSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IEFXVFJlY29yZEJhdGNoZXI7XHJcblxyXG5cclxuLyoqKi8gfSxcclxuLyogNiAqL1xyXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcclxuXHJcblx0LyoqXHJcblx0KiBBV1RCb25kU2VyaWFsaXplci50c1xyXG5cdCogQXV0aG9yOiBCcmVudCBFcmlja3NvbiAoYnJlcmlja3MpIGFuZCBBYmhpbGFzaCBQYW53YXIgKGFicGFud2FyKVxyXG5cdCogQ29weXJpZ2h0OiBNaWNyb3NvZnQgMjAxNlxyXG5cdCogQ2xhc3MgdG8gaGFuZGxlciBib25kIHNlcmlhbGl6YXRpb24uXHJcblx0Ki9cclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHR2YXIgQm9uZCA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XHJcblx0dmFyIEVudW1zXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xyXG5cdHZhciBVdGlscyA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpO1xyXG5cdHZhciBBV1RCb25kU2VyaWFsaXplciA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIEFXVEJvbmRTZXJpYWxpemVyKCkge1xyXG5cdCAgICB9XHJcblx0ICAgIEFXVEJvbmRTZXJpYWxpemVyLmdldFBheWxvYWRCbG9iID0gZnVuY3Rpb24gKHJlcXVlc3REaWN0aW9uYXJ5LCB0b2tlbkNvdW50KSB7XHJcblx0ICAgICAgICB2YXIgc3RyZWFtID0gbmV3IEJvbmQuSU8uTWVtb3J5U3RyZWFtKCk7XHJcblx0ICAgICAgICB2YXIgd3JpdGVyID0gbmV3IEJvbmQuQ29tcGFjdEJpbmFyeVByb3RvY29sV3JpdGVyKHN0cmVhbSk7XHJcblx0ICAgICAgICAvLyBCZWdpbiBDbGllbnRDb2xsZWN0b3IgcmVxdWVzdFxyXG5cdCAgICAgICAgLy9Xcml0ZSBUb2tlblRvRGF0YVBhY2thZ2VzTWFwXHJcblx0ICAgICAgICB3cml0ZXIuV3JpdGVGaWVsZEJlZ2luKEJvbmQuQm9uZERhdGFUeXBlLkJUX01BUCwgMyk7XHJcblx0ICAgICAgICB3cml0ZXIuV3JpdGVNYXBDb250YWluZXJCZWdpbih0b2tlbkNvdW50LCBCb25kLkJvbmREYXRhVHlwZS5CVF9TVFJJTkcsIEJvbmQuQm9uZERhdGFUeXBlLkJUX0xJU1QpO1xyXG5cdCAgICAgICAgT2JqZWN0LmtleXMocmVxdWVzdERpY3Rpb25hcnkpLmZvckVhY2goZnVuY3Rpb24gKHRva2VuKSB7XHJcblx0ICAgICAgICAgICAgLy93cml0ZSB0b2tlblxyXG5cdCAgICAgICAgICAgIHdyaXRlci5Xcml0ZVN0cmluZyh0b2tlbik7XHJcblx0ICAgICAgICAgICAgdmFyIGRhdGFQYWNrYWdlID0gcmVxdWVzdERpY3Rpb25hcnlbdG9rZW5dO1xyXG5cdCAgICAgICAgICAgIC8vIFdyaXRlIGxpc3Qgb2YgRGF0YVBhY2thZ2VzXHJcblx0ICAgICAgICAgICAgd3JpdGVyLldyaXRlQ29udGFpbmVyQmVnaW4oMSwgQm9uZC5Cb25kRGF0YVR5cGUuQlRfU1RSVUNUKTtcclxuXHQgICAgICAgICAgICAvLyBTb3VyY2VcclxuXHQgICAgICAgICAgICB3cml0ZXIuV3JpdGVGaWVsZEJlZ2luKEJvbmQuQm9uZERhdGFUeXBlLkJUX1NUUklORywgMik7XHJcblx0ICAgICAgICAgICAgd3JpdGVyLldyaXRlU3RyaW5nKCdhY3RfZGVmYXVsdF9zb3VyY2UnKTtcclxuXHQgICAgICAgICAgICAvLyBEYXRhUGFja2FnZUlkXHJcblx0ICAgICAgICAgICAgd3JpdGVyLldyaXRlRmllbGRCZWdpbihCb25kLkJvbmREYXRhVHlwZS5CVF9TVFJJTkcsIDUpO1xyXG5cdCAgICAgICAgICAgIHdyaXRlci5Xcml0ZVN0cmluZyhVdGlscy5uZXdHdWlkKCkpO1xyXG5cdCAgICAgICAgICAgIC8vIFRpbWVzdGFtcFxyXG5cdCAgICAgICAgICAgIHdyaXRlci5Xcml0ZUZpZWxkQmVnaW4oQm9uZC5Cb25kRGF0YVR5cGUuQlRfSU5UNjQsIDYpO1xyXG5cdCAgICAgICAgICAgIHdyaXRlci5Xcml0ZUludDY0KFV0aWxzLm51bWJlclRvQm9uZEludDY0KERhdGUubm93KCkpKTtcclxuXHQgICAgICAgICAgICAvLyBSZWNvcmRzXHJcblx0ICAgICAgICAgICAgd3JpdGVyLldyaXRlRmllbGRCZWdpbihCb25kLkJvbmREYXRhVHlwZS5CVF9MSVNULCA4KTtcclxuXHQgICAgICAgICAgICB3cml0ZXIuV3JpdGVDb250YWluZXJCZWdpbihkYXRhUGFja2FnZS5sZW5ndGgsIEJvbmQuQm9uZERhdGFUeXBlLkJUX1NUUlVDVCk7XHJcblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhUGFja2FnZS5sZW5ndGg7ICsraSkge1xyXG5cdCAgICAgICAgICAgICAgICB3cml0ZXIuV3JpdGVCbG9iKGRhdGFQYWNrYWdlW2ldKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgd3JpdGVyLldyaXRlU3RydWN0RW5kKGZhbHNlKTtcclxuXHQgICAgICAgIH0pO1xyXG5cdCAgICAgICAgLy8gRW5kIENsaWVudENvbGxlY3RvclxyXG5cdCAgICAgICAgd3JpdGVyLldyaXRlU3RydWN0RW5kKGZhbHNlKTtcclxuXHQgICAgICAgIHJldHVybiBzdHJlYW0uR2V0QnVmZmVyKCk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8vIEFzIHBlciBtYXBwaW5ncyBhdCBodHRwczovL3NreXBlLnZpc3VhbHN0dWRpby5jb20vU0NDL0YuUzRMLkZVTkRBTUVOVEFMUy9fZ2l0L2luZnJhc3RydWN0dXJlX2RhdGFfY2xpZW50dGVsZW1ldHJ5P1xyXG5cdCAgICAvLyBwYXRoPSUyRmNsaWVudHRlbGVtZXRyeSUyRnNyYyUyRmJvbmQlMkZEYXRhUGFja2FnZS5ib25kJnZlcnNpb249R0JkZXYyJl9hPWNvbnRlbnRzXHJcblx0ICAgIC8vIFJlcXVpcmVzIHRoYXQgdGhlIHZhbHVlcyBvZiBBV1RFdmVudERhdGEucHJvcGVydGllcyBtdXN0IGFsbCBiZSBBV1RFdmVudFByb3BlcnR5XHJcblx0ICAgIEFXVEJvbmRTZXJpYWxpemVyLmdldEV2ZW50QmxvYiA9IGZ1bmN0aW9uIChldmVudERhdGEpIHtcclxuXHQgICAgICAgIHZhciBzdHJlYW0gPSBuZXcgQm9uZC5JTy5NZW1vcnlTdHJlYW0oKTtcclxuXHQgICAgICAgIHZhciB3cml0ZXIgPSBuZXcgQm9uZC5Db21wYWN0QmluYXJ5UHJvdG9jb2xXcml0ZXIoc3RyZWFtKTtcclxuXHQgICAgICAgIC8vIElEXHJcblx0ICAgICAgICB3cml0ZXIuV3JpdGVGaWVsZEJlZ2luKEJvbmQuQm9uZERhdGFUeXBlLkJUX1NUUklORywgMSk7XHJcblx0ICAgICAgICB3cml0ZXIuV3JpdGVTdHJpbmcoZXZlbnREYXRhLmlkKTtcclxuXHQgICAgICAgIC8vIFRpbWVzdGFtcFxyXG5cdCAgICAgICAgd3JpdGVyLldyaXRlRmllbGRCZWdpbihCb25kLkJvbmREYXRhVHlwZS5CVF9JTlQ2NCwgMyk7XHJcblx0ICAgICAgICB3cml0ZXIuV3JpdGVJbnQ2NChVdGlscy5udW1iZXJUb0JvbmRJbnQ2NChldmVudERhdGEudGltZXN0YW1wKSk7XHJcblx0ICAgICAgICAvLyBUeXBlXHJcblx0ICAgICAgICB3cml0ZXIuV3JpdGVGaWVsZEJlZ2luKEJvbmQuQm9uZERhdGFUeXBlLkJUX1NUUklORywgNSk7XHJcblx0ICAgICAgICB3cml0ZXIuV3JpdGVTdHJpbmcoZXZlbnREYXRhLnR5cGUpO1xyXG5cdCAgICAgICAgLy8gRXZlbnQgVHlwZVxyXG5cdCAgICAgICAgd3JpdGVyLldyaXRlRmllbGRCZWdpbihCb25kLkJvbmREYXRhVHlwZS5CVF9TVFJJTkcsIDYpO1xyXG5cdCAgICAgICAgd3JpdGVyLldyaXRlU3RyaW5nKGV2ZW50RGF0YS5uYW1lKTtcclxuXHQgICAgICAgIHZhciBwcm9wc1N0cmluZyA9IFtdO1xyXG5cdCAgICAgICAgdmFyIHBpaVByb3BzID0gW107XHJcblx0ICAgICAgICAvLyBJdGVyYXRlIGFjcm9zcyBldmVudCBkYXRhIHByb3BlcnRpZXMgYW5kIHNlcGFyYXRlIGJhc2VkIG9uIHBpaVxyXG5cdCAgICAgICAgT2JqZWN0LmtleXMoZXZlbnREYXRhLnByb3BlcnRpZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xyXG5cdCAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IGV2ZW50RGF0YS5wcm9wZXJ0aWVzW2tleV07XHJcblx0ICAgICAgICAgICAgaWYgKHByb3BlcnR5LnBpaSA9PT0gRW51bXNfMS5BV1RQaWlLaW5kLk5vdFNldCkge1xyXG5cdCAgICAgICAgICAgICAgICBwcm9wc1N0cmluZy5wdXNoKGtleSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgICAgICBwaWlQcm9wcy5wdXNoKGtleSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfSk7XHJcblx0ICAgICAgICAvL0V4dGVuc2lvbiBtYXBcclxuXHQgICAgICAgIGlmIChwcm9wc1N0cmluZy5sZW5ndGgpIHtcclxuXHQgICAgICAgICAgICB3cml0ZXIuV3JpdGVGaWVsZEJlZ2luKEJvbmQuQm9uZERhdGFUeXBlLkJUX01BUCwgMTMpO1xyXG5cdCAgICAgICAgICAgIHdyaXRlci5Xcml0ZU1hcENvbnRhaW5lckJlZ2luKHByb3BzU3RyaW5nLmxlbmd0aCwgQm9uZC5Cb25kRGF0YVR5cGUuQlRfU1RSSU5HLCBCb25kLkJvbmREYXRhVHlwZS5CVF9TVFJJTkcpO1xyXG5cdCAgICAgICAgICAgIHByb3BzU3RyaW5nLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcclxuXHQgICAgICAgICAgICAgICAgd3JpdGVyLldyaXRlU3RyaW5nKG5hbWUpO1xyXG5cdCAgICAgICAgICAgICAgICB3cml0ZXIuV3JpdGVTdHJpbmcoZXZlbnREYXRhLnByb3BlcnRpZXNbbmFtZV0udmFsdWUpO1xyXG5cdCAgICAgICAgICAgIH0pO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgLy8gUGlpXHJcblx0ICAgICAgICBpZiAocGlpUHJvcHMubGVuZ3RoKSB7XHJcblx0ICAgICAgICAgICAgd3JpdGVyLldyaXRlRmllbGRCZWdpbihCb25kLkJvbmREYXRhVHlwZS5CVF9NQVAsIDMwKTtcclxuXHQgICAgICAgICAgICB3cml0ZXIuV3JpdGVNYXBDb250YWluZXJCZWdpbihwaWlQcm9wcy5sZW5ndGgsIEJvbmQuQm9uZERhdGFUeXBlLkJUX1NUUklORywgQm9uZC5Cb25kRGF0YVR5cGUuQlRfU1RSVUNUKTtcclxuXHQgICAgICAgICAgICBwaWlQcm9wcy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XHJcblx0ICAgICAgICAgICAgICAgIHdyaXRlci5Xcml0ZVN0cmluZyhuYW1lKTtcclxuXHQgICAgICAgICAgICAgICAgLy8gUElJIERhdGFcclxuXHQgICAgICAgICAgICAgICAgLy8gTzM2NSBzY3J1YmJlciB0eXBlXHJcblx0ICAgICAgICAgICAgICAgIHdyaXRlci5Xcml0ZUZpZWxkQmVnaW4oQm9uZC5Cb25kRGF0YVR5cGUuQlRfSU5UMzIsIDEpO1xyXG5cdCAgICAgICAgICAgICAgICB3cml0ZXIuV3JpdGVJbnQzMigxKTtcclxuXHQgICAgICAgICAgICAgICAgLy8gUElJIEtpbmRcclxuXHQgICAgICAgICAgICAgICAgd3JpdGVyLldyaXRlRmllbGRCZWdpbihCb25kLkJvbmREYXRhVHlwZS5CVF9JTlQzMiwgMik7XHJcblx0ICAgICAgICAgICAgICAgIHdyaXRlci5Xcml0ZUludDMyKGV2ZW50RGF0YS5wcm9wZXJ0aWVzW25hbWVdLnBpaSk7XHJcblx0ICAgICAgICAgICAgICAgIC8vIFZhbHVlXHJcblx0ICAgICAgICAgICAgICAgIHdyaXRlci5Xcml0ZUZpZWxkQmVnaW4oQm9uZC5Cb25kRGF0YVR5cGUuQlRfU1RSSU5HLCAzKTtcclxuXHQgICAgICAgICAgICAgICAgd3JpdGVyLldyaXRlU3RyaW5nKGV2ZW50RGF0YS5wcm9wZXJ0aWVzW25hbWVdLnZhbHVlKTtcclxuXHQgICAgICAgICAgICAgICAgd3JpdGVyLldyaXRlU3RydWN0RW5kKGZhbHNlKTtcclxuXHQgICAgICAgICAgICB9KTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHdyaXRlci5Xcml0ZVN0cnVjdEVuZChmYWxzZSk7XHJcblx0ICAgICAgICByZXR1cm4gc3RyZWFtLkdldEJ1ZmZlcigpO1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RCb25kU2VyaWFsaXplci5iYXNlNjRFbmNvZGUgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG5cdCAgICAgICAgcmV0dXJuIEJvbmQuRW5jb2RpbmcuQmFzZTY0LkdldFN0cmluZyhkYXRhKTtcclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIEFXVEJvbmRTZXJpYWxpemVyO1xyXG5cdH0oKSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IEFXVEJvbmRTZXJpYWxpemVyO1xyXG5cclxuXHJcbi8qKiovIH0sXHJcbi8qIDcgKi9cclxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XHJcblxyXG5cdC8qKlxyXG5cdCogbWljcm9zb2Z0LmJvbmQudHNcclxuXHQqIENvcHlyaWdodDogTWljcm9zb2Z0IDIwMTZcclxuXHQqL1xyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBib25kX2NvbnN0XzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xyXG5cdGV4cG9ydHMuQm9uZERhdGFUeXBlID0gYm9uZF9jb25zdF8xLkJvbmREYXRhVHlwZTtcclxuXHR2YXIgRW5jb2RpbmcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xyXG5cdGV4cG9ydHMuRW5jb2RpbmcgPSBFbmNvZGluZztcclxuXHR2YXIgSU8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKTtcclxuXHRleHBvcnRzLklPID0gSU87XHJcblx0dmFyIG1pY3Jvc29mdF9ib25kX3ByaW1pdGl2ZXNfMSA9IF9fd2VicGFja19yZXF1aXJlX18oMTApO1xyXG5cdGV4cG9ydHMuSW50NjQgPSBtaWNyb3NvZnRfYm9uZF9wcmltaXRpdmVzXzEuSW50NjQ7XHJcblx0ZXhwb3J0cy5VSW50NjQgPSBtaWNyb3NvZnRfYm9uZF9wcmltaXRpdmVzXzEuVUludDY0O1xyXG5cdGV4cG9ydHMuTnVtYmVyID0gbWljcm9zb2Z0X2JvbmRfcHJpbWl0aXZlc18xLk51bWJlcjtcclxuXHR2YXIgQ29tcGFjdEJpbmFyeVByb3RvY29sV3JpdGVyID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gQ29tcGFjdEJpbmFyeVByb3RvY29sV3JpdGVyKHN0cmVhbSkge1xyXG5cdCAgICAgICAgdGhpcy5fc3RyZWFtID0gc3RyZWFtO1xyXG5cdCAgICB9XHJcblx0ICAgIC8qb3ZlcnJpZGUqL1xyXG5cdCAgICBDb21wYWN0QmluYXJ5UHJvdG9jb2xXcml0ZXIucHJvdG90eXBlLldyaXRlQmxvYiA9IGZ1bmN0aW9uIChibG9iKSB7XHJcblx0ICAgICAgICB0aGlzLl9zdHJlYW0uV3JpdGUoYmxvYiwgMCwgYmxvYi5sZW5ndGgpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKm92ZXJyaWRlKi9cclxuXHQgICAgQ29tcGFjdEJpbmFyeVByb3RvY29sV3JpdGVyLnByb3RvdHlwZS5Xcml0ZUNvbnRhaW5lckJlZ2luID0gZnVuY3Rpb24gKHNpemUsIGVsZW1lbnRUeXBlKSB7XHJcblx0ICAgICAgICB0aGlzLldyaXRlVUludDgoZWxlbWVudFR5cGUpO1xyXG5cdCAgICAgICAgdGhpcy5Xcml0ZVVJbnQzMihzaXplKTtcclxuXHQgICAgfTtcclxuXHQgICAgLypvdmVycmlkZSovXHJcblx0ICAgIENvbXBhY3RCaW5hcnlQcm90b2NvbFdyaXRlci5wcm90b3R5cGUuV3JpdGVNYXBDb250YWluZXJCZWdpbiA9IGZ1bmN0aW9uIChzaXplLCBrZXlUeXBlLCB2YWx1ZVR5cGUpIHtcclxuXHQgICAgICAgIHRoaXMuV3JpdGVVSW50OChrZXlUeXBlKTtcclxuXHQgICAgICAgIHRoaXMuV3JpdGVVSW50OCh2YWx1ZVR5cGUpO1xyXG5cdCAgICAgICAgdGhpcy5Xcml0ZVVJbnQzMihzaXplKTtcclxuXHQgICAgfTtcclxuXHQgICAgLypvdmVycmlkZSovXHJcblx0ICAgIENvbXBhY3RCaW5hcnlQcm90b2NvbFdyaXRlci5wcm90b3R5cGUuV3JpdGVGaWVsZEJlZ2luID0gZnVuY3Rpb24gKHR5cGUsIGlkKSB7XHJcblx0ICAgICAgICBpZiAoaWQgPD0gNSkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuX3N0cmVhbS5Xcml0ZUJ5dGUodHlwZSB8IChpZCA8PCA1KSk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBlbHNlIGlmIChpZCA8PSAweGZmKSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fc3RyZWFtLldyaXRlQnl0ZSh0eXBlIHwgKDYgPDwgNSkpO1xyXG5cdCAgICAgICAgICAgIHRoaXMuX3N0cmVhbS5Xcml0ZUJ5dGUoaWQpO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgZWxzZSB7XHJcblx0ICAgICAgICAgICAgdGhpcy5fc3RyZWFtLldyaXRlQnl0ZSh0eXBlIHwgKDcgPDwgNSkpO1xyXG5cdCAgICAgICAgICAgIHRoaXMuX3N0cmVhbS5Xcml0ZUJ5dGUoaWQpO1xyXG5cdCAgICAgICAgICAgIHRoaXMuX3N0cmVhbS5Xcml0ZUJ5dGUoaWQgPj4gOCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIC8qb3ZlcnJpZGUqL1xyXG5cdCAgICBDb21wYWN0QmluYXJ5UHJvdG9jb2xXcml0ZXIucHJvdG90eXBlLldyaXRlSW50MzIgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHQgICAgICAgIHZhbHVlID0gRW5jb2RpbmcuWmlnemFnLkVuY29kZVppZ3phZzMyKHZhbHVlKTtcclxuXHQgICAgICAgIHRoaXMuV3JpdGVVSW50MzIodmFsdWUpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKm92ZXJyaWRlKi9cclxuXHQgICAgQ29tcGFjdEJpbmFyeVByb3RvY29sV3JpdGVyLnByb3RvdHlwZS5Xcml0ZUludDY0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcblx0ICAgICAgICB0aGlzLldyaXRlVUludDY0KEVuY29kaW5nLlppZ3phZy5FbmNvZGVaaWd6YWc2NCh2YWx1ZSkpO1xyXG5cdCAgICB9O1xyXG5cdCAgICAvKm92ZXJyaWRlKi9cclxuXHQgICAgQ29tcGFjdEJpbmFyeVByb3RvY29sV3JpdGVyLnByb3RvdHlwZS5Xcml0ZVN0cmluZyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdCAgICAgICAgaWYgKHZhbHVlID09PSAnJykge1xyXG5cdCAgICAgICAgICAgIHRoaXMuV3JpdGVVSW50MzIoMCAvKmxlbmd0aCovKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2Uge1xyXG5cdCAgICAgICAgICAgIHZhciBhcnJheSA9IEVuY29kaW5nLlV0ZjguR2V0Qnl0ZXModmFsdWUpO1xyXG5cdCAgICAgICAgICAgIHRoaXMuV3JpdGVVSW50MzIoYXJyYXkubGVuZ3RoKTtcclxuXHQgICAgICAgICAgICB0aGlzLl9zdHJlYW0uV3JpdGUoYXJyYXksIDAsIGFycmF5Lmxlbmd0aCk7XHJcblx0ICAgICAgICB9XHJcblx0ICAgIH07XHJcblx0ICAgIC8qb3ZlcnJpZGUqL1xyXG5cdCAgICBDb21wYWN0QmluYXJ5UHJvdG9jb2xXcml0ZXIucHJvdG90eXBlLldyaXRlU3RydWN0RW5kID0gZnVuY3Rpb24gKGlzQmFzZSkge1xyXG5cdCAgICAgICAgdGhpcy5Xcml0ZVVJbnQ4KGlzQmFzZSA/IGJvbmRfY29uc3RfMS5Cb25kRGF0YVR5cGUuQlRfU1RPUF9CQVNFIDogYm9uZF9jb25zdF8xLkJvbmREYXRhVHlwZS5CVF9TVE9QKTtcclxuXHQgICAgfTtcclxuXHQgICAgLypvdmVycmlkZSovXHJcblx0ICAgIENvbXBhY3RCaW5hcnlQcm90b2NvbFdyaXRlci5wcm90b3R5cGUuV3JpdGVVSW50MzIgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHQgICAgICAgIHZhciBhcnJheSA9IEVuY29kaW5nLlZhcmludC5HZXRCeXRlcyhtaWNyb3NvZnRfYm9uZF9wcmltaXRpdmVzXzEuTnVtYmVyLlRvVUludDMyKHZhbHVlKSk7XHJcblx0ICAgICAgICB0aGlzLl9zdHJlYW0uV3JpdGUoYXJyYXksIDAsIGFycmF5Lmxlbmd0aCk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qb3ZlcnJpZGUqL1xyXG5cdCAgICBDb21wYWN0QmluYXJ5UHJvdG9jb2xXcml0ZXIucHJvdG90eXBlLldyaXRlVUludDY0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcblx0ICAgICAgICB2YXIgYXJyYXkgPSBFbmNvZGluZy5WYXJpbnQ2NC5HZXRCeXRlcyh2YWx1ZSk7XHJcblx0ICAgICAgICB0aGlzLl9zdHJlYW0uV3JpdGUoYXJyYXksIDAsIGFycmF5Lmxlbmd0aCk7XHJcblx0ICAgIH07XHJcblx0ICAgIC8qb3ZlcnJpZGUqL1xyXG5cdCAgICBDb21wYWN0QmluYXJ5UHJvdG9jb2xXcml0ZXIucHJvdG90eXBlLldyaXRlVUludDggPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHQgICAgICAgIHRoaXMuX3N0cmVhbS5Xcml0ZUJ5dGUobWljcm9zb2Z0X2JvbmRfcHJpbWl0aXZlc18xLk51bWJlci5Ub1VJbnQ4KHZhbHVlKSk7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBDb21wYWN0QmluYXJ5UHJvdG9jb2xXcml0ZXI7XHJcblx0fSgpKTtcclxuXHRleHBvcnRzLkNvbXBhY3RCaW5hcnlQcm90b2NvbFdyaXRlciA9IENvbXBhY3RCaW5hcnlQcm90b2NvbFdyaXRlcjtcclxuXHJcblxyXG4vKioqLyB9LFxyXG4vKiA4ICovXHJcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xyXG5cclxuXHQvKipcclxuXHQqIGJvbmRfY29uc3QudHNcclxuXHQqIENvcHlyaWdodDogTWljcm9zb2Z0IDIwMTZcclxuXHQqL1xyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblx0Ly8gPGF1dG8tZ2VuZXJhdGVkPlxyXG5cdC8vICAgICBUaGlzIGNvZGUgd2FzIGdlbmVyYXRlZCBieSBhIHRvb2wuXHJcblx0Ly9cclxuXHQvLyAgICAgVG9vbCAgICAgOiBib25kYywgVmVyc2lvbj0zLjAuMSwgQnVpbGQ9Ym9uZC1naXQuZGVidWcubm90XHJcblx0Ly8gICAgIFRlbXBsYXRlIDogTWljcm9zb2Z0LkJvbmQuUnVsZXMuZGxsI1R5cGVTY3JpcHQudHRcclxuXHQvLyAgICAgRmlsZSAgICAgOiBib25kX2NvbnN0LnRzXHJcblx0Ly9cclxuXHQvLyAgICAgQ2hhbmdlcyB0byB0aGlzIGZpbGUgbWF5IGNhdXNlIGluY29ycmVjdCBiZWhhdmlvciBhbmQgd2lsbCBiZSBsb3N0IHdoZW5cclxuXHQvLyAgICAgdGhlIGNvZGUgaXMgcmVnZW5lcmF0ZWQuXHJcblx0Ly8gPC9hdXRvLWdlbmVyYXRlZD5cclxuXHQvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdHZhciBCb25kRGF0YVR5cGU7XHJcblx0KGZ1bmN0aW9uIChCb25kRGF0YVR5cGUpIHtcclxuXHQgICAgQm9uZERhdGFUeXBlW0JvbmREYXRhVHlwZVtcIkJUX1NUT1BcIl0gPSAwXSA9IFwiQlRfU1RPUFwiO1xyXG5cdCAgICBCb25kRGF0YVR5cGVbQm9uZERhdGFUeXBlW1wiQlRfU1RPUF9CQVNFXCJdID0gMV0gPSBcIkJUX1NUT1BfQkFTRVwiO1xyXG5cdCAgICBCb25kRGF0YVR5cGVbQm9uZERhdGFUeXBlW1wiQlRfVUlOVDhcIl0gPSAzXSA9IFwiQlRfVUlOVDhcIjtcclxuXHQgICAgQm9uZERhdGFUeXBlW0JvbmREYXRhVHlwZVtcIkJUX1VJTlQzMlwiXSA9IDVdID0gXCJCVF9VSU5UMzJcIjtcclxuXHQgICAgQm9uZERhdGFUeXBlW0JvbmREYXRhVHlwZVtcIkJUX1VJTlQ2NFwiXSA9IDZdID0gXCJCVF9VSU5UNjRcIjtcclxuXHQgICAgQm9uZERhdGFUeXBlW0JvbmREYXRhVHlwZVtcIkJUX1NUUklOR1wiXSA9IDldID0gXCJCVF9TVFJJTkdcIjtcclxuXHQgICAgQm9uZERhdGFUeXBlW0JvbmREYXRhVHlwZVtcIkJUX1NUUlVDVFwiXSA9IDEwXSA9IFwiQlRfU1RSVUNUXCI7XHJcblx0ICAgIEJvbmREYXRhVHlwZVtCb25kRGF0YVR5cGVbXCJCVF9MSVNUXCJdID0gMTFdID0gXCJCVF9MSVNUXCI7XHJcblx0ICAgIEJvbmREYXRhVHlwZVtCb25kRGF0YVR5cGVbXCJCVF9NQVBcIl0gPSAxM10gPSBcIkJUX01BUFwiO1xyXG5cdCAgICBCb25kRGF0YVR5cGVbQm9uZERhdGFUeXBlW1wiQlRfSU5UMzJcIl0gPSAxNl0gPSBcIkJUX0lOVDMyXCI7XHJcblx0ICAgIEJvbmREYXRhVHlwZVtCb25kRGF0YVR5cGVbXCJCVF9JTlQ2NFwiXSA9IDE3XSA9IFwiQlRfSU5UNjRcIjtcclxuXHQgICAgQm9uZERhdGFUeXBlW0JvbmREYXRhVHlwZVtcIkJUX1VOQVZBSUxBQkxFXCJdID0gMTI3XSA9IFwiQlRfVU5BVkFJTEFCTEVcIjtcclxuXHR9KShCb25kRGF0YVR5cGUgPSBleHBvcnRzLkJvbmREYXRhVHlwZSB8fCAoZXhwb3J0cy5Cb25kRGF0YVR5cGUgPSB7fSkpO1xyXG5cclxuXHJcbi8qKiovIH0sXHJcbi8qIDkgKi9cclxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XHJcblxyXG5cdC8qKlxyXG5cdCogbWljcm9zb2Z0LmJvbmQuZW5jb2RpbmcudHNcclxuXHQqIENvcHlyaWdodDogTWljcm9zb2Z0IDIwMTZcclxuXHQqL1xyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBtaWNyb3NvZnRfYm9uZF9wcmltaXRpdmVzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTtcclxuXHR2YXIgVXRmOCA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIFV0ZjgoKSB7XHJcblx0ICAgIH1cclxuXHQgICAgVXRmOC5HZXRCeXRlcyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdCAgICAgICAgdmFyIGFycmF5ID0gW107XHJcblx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgKytpKSB7XHJcblx0ICAgICAgICAgICAgdmFyIGNoYXIgPSB2YWx1ZS5jaGFyQ29kZUF0KGkpO1xyXG5cdCAgICAgICAgICAgIGlmIChjaGFyIDwgMHg4MCkge1xyXG5cdCAgICAgICAgICAgICAgICBhcnJheS5wdXNoKGNoYXIpO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBlbHNlIGlmIChjaGFyIDwgMHg4MDApIHtcclxuXHQgICAgICAgICAgICAgICAgYXJyYXkucHVzaCgweGMwIHwgKGNoYXIgPj4gNiksIDB4ODAgfCAoY2hhciAmIDB4M2YpKTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZWxzZSBpZiAoY2hhciA8IDB4ZDgwMCB8fCBjaGFyID49IDB4ZTAwMCkge1xyXG5cdCAgICAgICAgICAgICAgICBhcnJheS5wdXNoKDB4ZTAgfCAoY2hhciA+PiAxMiksIDB4ODAgfCAoKGNoYXIgPj4gNikgJiAweDNmKSwgMHg4MCB8IChjaGFyICYgMHgzZikpO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgICAgICBlbHNlIHtcclxuXHQgICAgICAgICAgICAgICAgY2hhciA9IDB4MTAwMDAgKyAoKChjaGFyICYgMHgzZmYpIDw8IDEwKSB8ICh2YWx1ZS5jaGFyQ29kZUF0KCsraSkgJiAweDNmZikpO1xyXG5cdCAgICAgICAgICAgICAgICBhcnJheS5wdXNoKDB4ZjAgfCAoY2hhciA+PiAxOCksIDB4ODAgfCAoKGNoYXIgPj4gMTIpICYgMHgzZiksIDB4ODAgfCAoKGNoYXIgPj4gNikgJiAweDNmKSwgMHg4MCB8IChjaGFyICYgMHgzZikpO1xyXG5cdCAgICAgICAgICAgIH1cclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHJldHVybiBhcnJheTtcclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIFV0Zjg7XHJcblx0fSgpKTtcclxuXHRleHBvcnRzLlV0ZjggPSBVdGY4O1xyXG5cdHZhciBCYXNlNjQgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBCYXNlNjQoKSB7XHJcblx0ICAgIH1cclxuXHQgICAgQmFzZTY0LkdldFN0cmluZyA9IGZ1bmN0aW9uIChpbkFycmF5KSB7XHJcblx0ICAgICAgICB2YXIgbG9va3VwID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nO1xyXG5cdCAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xyXG5cdCAgICAgICAgdmFyIHBhZGRpbmdCeXRlcyA9IGluQXJyYXkubGVuZ3RoICUgMztcclxuXHQgICAgICAgIHZhciB0b0Jhc2U2NCA9IGZ1bmN0aW9uIChudW0pIHtcclxuXHQgICAgICAgICAgICByZXR1cm4gW2xvb2t1cC5jaGFyQXQoKG51bSA+PiAxOCkgJiAweDNGKSxcclxuXHQgICAgICAgICAgICAgICAgbG9va3VwLmNoYXJBdCgobnVtID4+IDEyKSAmIDB4M0YpLFxyXG5cdCAgICAgICAgICAgICAgICBsb29rdXAuY2hhckF0KChudW0gPj4gNikgJiAweDNGKSxcclxuXHQgICAgICAgICAgICAgICAgbG9va3VwLmNoYXJBdChudW0gJiAweDNGKV0uam9pbignJyk7XHJcblx0ICAgICAgICB9O1xyXG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gaW5BcnJheS5sZW5ndGggLSBwYWRkaW5nQnl0ZXM7IGkgPCBsZW5ndGhfMTsgaSArPSAzKSB7XHJcblx0ICAgICAgICAgICAgdmFyIHRlbXAgPSAoaW5BcnJheVtpXSA8PCAxNikgKyAoaW5BcnJheVtpICsgMV0gPDwgOCkgKyAoaW5BcnJheVtpICsgMl0pO1xyXG5cdCAgICAgICAgICAgIG91dHB1dC5wdXNoKHRvQmFzZTY0KHRlbXApKTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHN3aXRjaCAocGFkZGluZ0J5dGVzKSB7XHJcblx0ICAgICAgICAgICAgY2FzZSAxOlxyXG5cdCAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGluQXJyYXlbaW5BcnJheS5sZW5ndGggLSAxXTtcclxuXHQgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gobG9va3VwLmNoYXJBdCh0ZW1wID4+IDIpKTtcclxuXHQgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gobG9va3VwLmNoYXJBdCgodGVtcCA8PCA0KSAmIDB4M0YpKTtcclxuXHQgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goJz09Jyk7XHJcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cdCAgICAgICAgICAgIGNhc2UgMjpcclxuXHQgICAgICAgICAgICAgICAgdmFyIHRlbXAyID0gKGluQXJyYXlbaW5BcnJheS5sZW5ndGggLSAyXSA8PCA4KSArIChpbkFycmF5W2luQXJyYXkubGVuZ3RoIC0gMV0pO1xyXG5cdCAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChsb29rdXAuY2hhckF0KHRlbXAyID4+IDEwKSk7XHJcblx0ICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKGxvb2t1cC5jaGFyQXQoKHRlbXAyID4+IDQpICYgMHgzRikpO1xyXG5cdCAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChsb29rdXAuY2hhckF0KCh0ZW1wMiA8PCAyKSAmIDB4M0YpKTtcclxuXHQgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goJz0nKTtcclxuXHQgICAgICAgICAgICAgICAgYnJlYWs7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICByZXR1cm4gb3V0cHV0LmpvaW4oJycpO1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gQmFzZTY0O1xyXG5cdH0oKSk7XHJcblx0ZXhwb3J0cy5CYXNlNjQgPSBCYXNlNjQ7XHJcblx0dmFyIFZhcmludCA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIFZhcmludCgpIHtcclxuXHQgICAgfVxyXG5cdCAgICBWYXJpbnQuR2V0Qnl0ZXMgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHQgICAgICAgIHZhciBhcnJheSA9IFtdO1xyXG5cdCAgICAgICAgd2hpbGUgKHZhbHVlICYgMHhmZmZmZmY4MCkge1xyXG5cdCAgICAgICAgICAgIGFycmF5LnB1c2goKHZhbHVlICYgMHg3ZikgfCAweDgwKTtcclxuXHQgICAgICAgICAgICB2YWx1ZSA+Pj49IDc7XHJcblx0ICAgICAgICB9XHJcblx0ICAgICAgICBhcnJheS5wdXNoKHZhbHVlICYgMHg3Zik7XHJcblx0ICAgICAgICByZXR1cm4gYXJyYXk7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBWYXJpbnQ7XHJcblx0fSgpKTtcclxuXHRleHBvcnRzLlZhcmludCA9IFZhcmludDtcclxuXHR2YXIgVmFyaW50NjQgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBWYXJpbnQ2NCgpIHtcclxuXHQgICAgfVxyXG5cdCAgICBWYXJpbnQ2NC5HZXRCeXRlcyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdCAgICAgICAgdmFyIGxvdyA9IHZhbHVlLmxvdztcclxuXHQgICAgICAgIHZhciBoaWdoID0gdmFsdWUuaGlnaDtcclxuXHQgICAgICAgIHZhciBhcnJheSA9IFtdO1xyXG5cdCAgICAgICAgd2hpbGUgKGhpZ2ggfHwgKDB4ZmZmZmZmODAgJiBsb3cpKSB7XHJcblx0ICAgICAgICAgICAgYXJyYXkucHVzaCgobG93ICYgMHg3ZikgfCAweDgwKTtcclxuXHQgICAgICAgICAgICBsb3cgPSAoKGhpZ2ggJiAweDdmKSA8PCAyNSkgfCAobG93ID4+PiA3KTtcclxuXHQgICAgICAgICAgICBoaWdoID4+Pj0gNztcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGFycmF5LnB1c2gobG93ICYgMHg3Zik7XHJcblx0ICAgICAgICByZXR1cm4gYXJyYXk7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBWYXJpbnQ2NDtcclxuXHR9KCkpO1xyXG5cdGV4cG9ydHMuVmFyaW50NjQgPSBWYXJpbnQ2NDtcclxuXHR2YXIgWmlnemFnID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gWmlnemFnKCkge1xyXG5cdCAgICB9XHJcblx0ICAgIFppZ3phZy5FbmNvZGVaaWd6YWczMiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdCAgICAgICAgdmFsdWUgPSBtaWNyb3NvZnRfYm9uZF9wcmltaXRpdmVzXzEuTnVtYmVyLlRvSW50MzIodmFsdWUpO1xyXG5cdCAgICAgICAgcmV0dXJuICgodmFsdWUgPDwgMSkgXiAodmFsdWUgPj4gKDQgLypzaXplb2YoaW50KSovICogOCAtIDEpKSk7XHJcblx0ICAgIH07XHJcblx0ICAgIFppZ3phZy5FbmNvZGVaaWd6YWc2NCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdCAgICAgICAgdmFyIGxvdyA9IHZhbHVlLmxvdztcclxuXHQgICAgICAgIHZhciBoaWdoID0gdmFsdWUuaGlnaDtcclxuXHQgICAgICAgIHZhciB0bXBIID0gKGhpZ2ggPDwgMSkgfCAobG93ID4+PiAzMSk7XHJcblx0ICAgICAgICB2YXIgdG1wTCA9IGxvdyA8PCAxO1xyXG5cdCAgICAgICAgaWYgKGhpZ2ggJiAweDgwMDAwMDAwKSB7XHJcblx0ICAgICAgICAgICAgdG1wSCA9IH50bXBIO1xyXG5cdCAgICAgICAgICAgIHRtcEwgPSB+dG1wTDtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIHZhciByZXMgPSBuZXcgbWljcm9zb2Z0X2JvbmRfcHJpbWl0aXZlc18xLlVJbnQ2NCgnMCcpO1xyXG5cdCAgICAgICAgcmVzLmxvdyA9IHRtcEw7XHJcblx0ICAgICAgICByZXMuaGlnaCA9IHRtcEg7XHJcblx0ICAgICAgICByZXR1cm4gcmVzO1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gWmlnemFnO1xyXG5cdH0oKSk7XHJcblx0ZXhwb3J0cy5aaWd6YWcgPSBaaWd6YWc7XHJcblxyXG5cclxuLyoqKi8gfSxcclxuLyogMTAgKi9cclxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XHJcblxyXG5cdC8qKlxyXG5cdCogbWljcm9zb2Z0LmJvbmQucHJpbWl0aXZlcy50c1xyXG5cdCogQ29weXJpZ2h0OiBNaWNyb3NvZnQgMjAxNlxyXG5cdCovXHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIEludDY0ID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgLy8gQlVHISE6IG5lZWQgaW1wbGVtZW50LCBjdXJyZW50bHksIGp1c3QgaGFuZGxlIDMyYml0cyBudW1iZXJcclxuXHQgICAgZnVuY3Rpb24gSW50NjQobnVtYmVyU3RyKSB7XHJcblx0ICAgICAgICB0aGlzLmxvdyA9IDA7XHJcblx0ICAgICAgICB0aGlzLmhpZ2ggPSAwO1xyXG5cdCAgICAgICAgdGhpcy5sb3cgPSBwYXJzZUludChudW1iZXJTdHIsIDEwKTtcclxuXHQgICAgICAgIGlmICh0aGlzLmxvdyA8IDApIHtcclxuXHQgICAgICAgICAgICB0aGlzLmhpZ2ggPSAtMTtcclxuXHQgICAgICAgIH1cclxuXHQgICAgfVxyXG5cdCAgICBJbnQ2NC5wcm90b3R5cGUuRXF1YWxzID0gZnVuY3Rpb24gKG51bWJlclN0cikge1xyXG5cdCAgICAgICAgdmFyIHRtcCA9IG5ldyBJbnQ2NChudW1iZXJTdHIpO1xyXG5cdCAgICAgICAgcmV0dXJuIHRoaXMubG93ID09PSB0bXAubG93ICYmIHRoaXMuaGlnaCA9PT0gdG1wLmhpZ2g7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBJbnQ2NDtcclxuXHR9KCkpO1xyXG5cdGV4cG9ydHMuSW50NjQgPSBJbnQ2NDtcclxuXHR2YXIgVUludDY0ID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgLy8gQlVHISE6IG5lZWQgaW1wbGVtZW50LCBjdXJyZW50bHksIGp1c3QgaGFuZGxlIDMyYml0cyBudW1iZXJcclxuXHQgICAgZnVuY3Rpb24gVUludDY0KG51bWJlclN0cikge1xyXG5cdCAgICAgICAgdGhpcy5sb3cgPSAwO1xyXG5cdCAgICAgICAgdGhpcy5oaWdoID0gMDtcclxuXHQgICAgICAgIHRoaXMubG93ID0gcGFyc2VJbnQobnVtYmVyU3RyLCAxMCk7XHJcblx0ICAgIH1cclxuXHQgICAgVUludDY0LnByb3RvdHlwZS5FcXVhbHMgPSBmdW5jdGlvbiAobnVtYmVyU3RyKSB7XHJcblx0ICAgICAgICB2YXIgdG1wID0gbmV3IFVJbnQ2NChudW1iZXJTdHIpO1xyXG5cdCAgICAgICAgcmV0dXJuIHRoaXMubG93ID09PSB0bXAubG93ICYmIHRoaXMuaGlnaCA9PT0gdG1wLmhpZ2g7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBVSW50NjQ7XHJcblx0fSgpKTtcclxuXHRleHBvcnRzLlVJbnQ2NCA9IFVJbnQ2NDtcclxuXHR2YXIgTnVtYmVyID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gTnVtYmVyKCkge1xyXG5cdCAgICB9XHJcblx0ICAgIE51bWJlci5Ub0J5dGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHQgICAgICAgIHJldHVybiB0aGlzLlRvVUludDgodmFsdWUpO1xyXG5cdCAgICB9O1xyXG5cdCAgICBOdW1iZXIuVG9JbnQxNiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdCAgICAgICAgdmFyIHNpZ25NYXNrID0gKHZhbHVlICYgMHg4MDAwKSA8PCAxNiA+PiAxNjtcclxuXHQgICAgICAgIHJldHVybiAodmFsdWUgJiAweDdmZmYpIHwgc2lnbk1hc2s7XHJcblx0ICAgIH07XHJcblx0ICAgIE51bWJlci5Ub0ludDMyID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcblx0ICAgICAgICB2YXIgc2lnbk1hc2sgPSAodmFsdWUgJiAweDgwMDAwMDAwKTtcclxuXHQgICAgICAgIHJldHVybiAodmFsdWUgJiAweDdmZmZmZmZmKSB8IHNpZ25NYXNrO1xyXG5cdCAgICB9O1xyXG5cdCAgICBOdW1iZXIuVG9VSW50OCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdCAgICAgICAgcmV0dXJuIHZhbHVlICYgMHhmZjtcclxuXHQgICAgfTtcclxuXHQgICAgTnVtYmVyLlRvVUludDMyID0gZnVuY3Rpb24gKHZhbHVlKSB7XHJcblx0ICAgICAgICByZXR1cm4gdmFsdWUgJiAweGZmZmZmZmZmO1xyXG5cdCAgICB9O1xyXG5cdCAgICByZXR1cm4gTnVtYmVyO1xyXG5cdH0oKSk7XHJcblx0ZXhwb3J0cy5OdW1iZXIgPSBOdW1iZXI7XHJcblxyXG5cclxuLyoqKi8gfSxcclxuLyogMTEgKi9cclxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XHJcblxyXG5cdC8qKlxyXG5cdCogbWljcm9zb2Z0LmJvbmQuaW8udHNcclxuXHQqIENvcHlyaWdodDogTWljcm9zb2Z0IDIwMTZcclxuXHQqL1xyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdHZhciBtaWNyb3NvZnRfYm9uZF9wcmltaXRpdmVzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTtcclxuXHR2YXIgTWVtb3J5U3RyZWFtID0gKGZ1bmN0aW9uICgpIHtcclxuXHQgICAgZnVuY3Rpb24gTWVtb3J5U3RyZWFtKCkge1xyXG5cdCAgICAgICAgdGhpcy5fYnVmZmVyID0gW107XHJcblx0ICAgIH1cclxuXHQgICAgLypvdmVycmlkZSovXHJcblx0ICAgIE1lbW9yeVN0cmVhbS5wcm90b3R5cGUuV3JpdGVCeXRlID0gZnVuY3Rpb24gKGJ5dGUpIHtcclxuXHQgICAgICAgIHRoaXMuX2J1ZmZlci5wdXNoKG1pY3Jvc29mdF9ib25kX3ByaW1pdGl2ZXNfMS5OdW1iZXIuVG9CeXRlKGJ5dGUpKTtcclxuXHQgICAgfTtcclxuXHQgICAgLypvdmVycmlkZSovXHJcblx0ICAgIE1lbW9yeVN0cmVhbS5wcm90b3R5cGUuV3JpdGUgPSBmdW5jdGlvbiAoYnVmZmVyLCBvZmZzZXQsIGNvdW50KSB7XHJcblx0ICAgICAgICB3aGlsZSAoY291bnQtLSkge1xyXG5cdCAgICAgICAgICAgIHRoaXMuV3JpdGVCeXRlKGJ1ZmZlcltvZmZzZXQrK10pO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9O1xyXG5cdCAgICAvKipcclxuXHQgICAgICogUmV0dXJucyB0aGUgYXJyYXkgb2YgdW5zaWduZWQgYnl0ZXMgZnJvbSB3aGljaCB0aGlzIHN0cmVhbSB3YXMgY3JlYXRlZC5cclxuXHQgICAgICovXHJcblx0ICAgIE1lbW9yeVN0cmVhbS5wcm90b3R5cGUuR2V0QnVmZmVyID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgICAgICAgcmV0dXJuIHRoaXMuX2J1ZmZlcjtcclxuXHQgICAgfTtcclxuXHQgICAgcmV0dXJuIE1lbW9yeVN0cmVhbTtcclxuXHR9KCkpO1xyXG5cdGV4cG9ydHMuTWVtb3J5U3RyZWFtID0gTWVtb3J5U3RyZWFtO1xyXG5cclxuXHJcbi8qKiovIH0sXHJcbi8qIDEyICovXHJcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xyXG5cclxuXHRcInVzZSBzdHJpY3RcIjtcclxuXHQvKipcclxuXHQqIFV0aWxzLnRzXHJcblx0KiBBdXRob3I6IEJyZW50IEVyaWNrc29uIChicmVyaWNrcykgYW5kIEFiaGlsYXNoIFBhbndhciAoYWJwYW53YXIpXHJcblx0KiBDb3B5cmlnaHQ6IE1pY3Jvc29mdCAyMDE2XHJcblx0KiBDb21tb24gZnVuY3Rpb25zIHVzZWQgaW4gdGhlIFNESy5cclxuXHQqL1xyXG5cdHZhciBtaWNyb3NvZnRfYm9uZF9wcmltaXRpdmVzXzEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTtcclxuXHR2YXIgR3VpZFJlZ2V4ID0gL1t4eV0vZztcclxuXHRmdW5jdGlvbiBudW1iZXJUb0JvbmRJbnQ2NCh2YWx1ZSkge1xyXG5cdCAgICAvLyBDb25zdHJ1Y3QgYm9uZCB0aW1lc3RhbXAgZm9yIGFyaWFcclxuXHQgICAgdmFyIGJvbmRfdmFsdWUgPSBuZXcgbWljcm9zb2Z0X2JvbmRfcHJpbWl0aXZlc18xLkludDY0KCcwJyk7XHJcblx0ICAgIGJvbmRfdmFsdWUubG93ID0gdmFsdWUgJiAweGZmZmZmZmZmO1xyXG5cdCAgICBib25kX3ZhbHVlLmhpZ2ggPSBNYXRoLmZsb29yKHZhbHVlIC8gMHgxMDAwMDAwMDApO1xyXG5cdCAgICByZXR1cm4gYm9uZF92YWx1ZTtcclxuXHR9XHJcblx0ZXhwb3J0cy5udW1iZXJUb0JvbmRJbnQ2NCA9IG51bWJlclRvQm9uZEludDY0O1xyXG5cdGZ1bmN0aW9uIG5ld0d1aWQoKSB7XHJcblx0ICAgIHJldHVybiAneHh4eHh4eHgteHh4eC00eHh4LXl4eHgteHh4eHh4eHh4eHh4Jy5yZXBsYWNlKEd1aWRSZWdleCwgZnVuY3Rpb24gKGMpIHtcclxuXHQgICAgICAgIHZhciByID0gKE1hdGgucmFuZG9tKCkgKiAxNiB8IDApLCB2ID0gKGMgPT09ICd4JyA/IHIgOiByICYgMHgzIHwgMHg4KTtcclxuXHQgICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcclxuXHQgICAgfSk7XHJcblx0fVxyXG5cdGV4cG9ydHMubmV3R3VpZCA9IG5ld0d1aWQ7XHJcblx0ZnVuY3Rpb24gaXNQaWkodmFsdWUpIHtcclxuXHQgICAgaWYgKCFpc05hTih2YWx1ZSkgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgPj0gMCAmJiB2YWx1ZSA8PSAxMykge1xyXG5cdCAgICAgICAgcmV0dXJuIHRydWU7XHJcblx0ICAgIH1cclxuXHQgICAgcmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHRleHBvcnRzLmlzUGlpID0gaXNQaWk7XHJcblxyXG5cclxuLyoqKi8gfSxcclxuLyogMTMgKi9cclxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XHJcblxyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdC8qKlxyXG5cdCogQVdUUmV0cnlQb2xpY3kudHNcclxuXHQqIEF1dGhvcjogQWJoaWxhc2ggUGFud2FyIChhYnBhbndhcilcclxuXHQqIENvcHlyaWdodDogTWljcm9zb2Z0IDIwMTZcclxuXHQqIENsYXNzIGZvciByZXRyeSBwb2xpY3kuXHJcblx0Ki9cclxuXHR2YXIgUmFuZG9taXphdGlvbkxvd2VyVGhyZXNob2xkID0gMC44O1xyXG5cdHZhciBSYW5kb21pemF0aW9uVXBwZXJUaHJlc2hvbGQgPSAxLjI7XHJcblx0dmFyIEJhc2VCYWNrb2ZmID0gMzAwMDtcclxuXHR2YXIgTWF4QmFja29mZiA9IDEyMDAwMDtcclxuXHR2YXIgQVdUUmV0cnlQb2xpY3kgPSAoZnVuY3Rpb24gKCkge1xyXG5cdCAgICBmdW5jdGlvbiBBV1RSZXRyeVBvbGljeSgpIHtcclxuXHQgICAgfVxyXG5cdCAgICBBV1RSZXRyeVBvbGljeS5zaG91bGRSZXRyeUZvclN0YXR1cyA9IGZ1bmN0aW9uIChodHRwU3RhdHVzQ29kZSkge1xyXG5cdCAgICAgICAgLyogVGhlIGJlbG93IGV4cHJlc3Npb24gcmVhZHMgdGhhdCB3ZSBzaG91bGQgb25seSByZXRyeSBmb3I6XHJcblx0ICAgICAgICAgICAgLSBIdHRwU3RhdHVzQ29kZXMgdGhhdCBhcmUgc21hbGxlciB0aGFuIDMwMC5cclxuXHQgICAgICAgICAgICAtIEh0dHBTdGF0dXNDb2RlcyBncmVhdGVyIG9yIGVxdWFsIHRvIDUwMCAoZXhjZXB0IGZvciA1MDEtTm90SW1wbGVtZW50XHJcblx0ICAgICAgICAgICAgICBhbmQgNTA1LUh0dHBWZXJzaW9uTm90U3VwcG9ydCkuXHJcblx0ICAgICAgICAgICAgLSBIdHRwU3RhdHVzQ29kZSA0MDgtUmVxdWVzdFRpbWVvdXQuXHJcblx0ICAgICAgICAgICBUaGlzIGlzIGJhc2VkIG9uIE1pY3Jvc29mdC5XaW5kb3dzQXp1cmUuU3RvcmFnZS5SZXRyeVBvbGljaWVzLkV4cG9uZW50aWFsUmV0cnkgY2xhc3MgKi9cclxuXHQgICAgICAgIHJldHVybiAhKChodHRwU3RhdHVzQ29kZSA+PSAzMDAgJiYgaHR0cFN0YXR1c0NvZGUgPCA1MDAgJiYgaHR0cFN0YXR1c0NvZGUgIT09IDQwOClcclxuXHQgICAgICAgICAgICB8fCAoaHR0cFN0YXR1c0NvZGUgPT09IDUwMSlcclxuXHQgICAgICAgICAgICB8fCAoaHR0cFN0YXR1c0NvZGUgPT09IDUwNSkpO1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RSZXRyeVBvbGljeS5nZXRNaWxsaXNUb0JhY2tvZmZGb3JSZXRyeSA9IGZ1bmN0aW9uIChyZXRyaWVzU29GYXIpIHtcclxuXHQgICAgICAgIHZhciB3YWl0RHVyYXRpb24gPSAwO1xyXG5cdCAgICAgICAgdmFyIG1pbkJhY2tvZmYgPSBCYXNlQmFja29mZiAqIFJhbmRvbWl6YXRpb25Mb3dlclRocmVzaG9sZDtcclxuXHQgICAgICAgIHZhciBtYXhCYWNrb2ZmID0gQmFzZUJhY2tvZmYgKiBSYW5kb21pemF0aW9uVXBwZXJUaHJlc2hvbGQ7XHJcblx0ICAgICAgICB2YXIgcmFuZG9tQmFja29mZiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXhCYWNrb2ZmIC0gbWluQmFja29mZikpICsgbWluQmFja29mZjtcclxuXHQgICAgICAgIHdhaXREdXJhdGlvbiA9IE1hdGgucG93KDQsIHJldHJpZXNTb0ZhcikgKiByYW5kb21CYWNrb2ZmO1xyXG5cdCAgICAgICAgcmV0dXJuIE1hdGgubWluKHdhaXREdXJhdGlvbiwgTWF4QmFja29mZik7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBBV1RSZXRyeVBvbGljeTtcclxuXHR9KCkpO1xyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuXHRleHBvcnRzLmRlZmF1bHQgPSBBV1RSZXRyeVBvbGljeTtcclxuXHJcblxyXG4vKioqLyB9LFxyXG4vKiAxNCAqL1xyXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcclxuXHJcblx0XCJ1c2Ugc3RyaWN0XCI7XHJcblx0dmFyIFNlY1RvTXNNdWx0aXBsaWVyID0gMTAwMDtcclxuXHR2YXIgQVdUS2lsbFN3aXRjaCA9IChmdW5jdGlvbiAoKSB7XHJcblx0ICAgIGZ1bmN0aW9uIEFXVEtpbGxTd2l0Y2goKSB7XHJcblx0ICAgICAgICB0aGlzLl9raWxsZWRUb2tlbkRpY3Rpb25hcnkgPSB7fTtcclxuXHQgICAgfVxyXG5cdCAgICBBV1RLaWxsU3dpdGNoLnByb3RvdHlwZS5zZXRLaWxsU3dpdGNoVGVuYW50cyA9IGZ1bmN0aW9uIChraWxsVG9rZW5zLCBraWxsRHVyYXRpb24pIHtcclxuXHQgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcblx0ICAgICAgICBpZiAoa2lsbFRva2VucyAmJiBraWxsRHVyYXRpb24pIHtcclxuXHQgICAgICAgICAgICB0cnkge1xyXG5cdCAgICAgICAgICAgICAgICB2YXIga2lsbGVkVG9rZW5zID0ga2lsbFRva2Vucy5zcGxpdCgnLCcpO1xyXG5cdCAgICAgICAgICAgICAgICBpZiAoa2lsbER1cmF0aW9uID09PSAndGhpcy1yZXF1ZXN0LW9ubHknKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgICByZXR1cm4ga2lsbGVkVG9rZW5zO1xyXG5cdCAgICAgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbk1zXzEgPSBwYXJzZUludChraWxsRHVyYXRpb24sIDEwKSAqIFNlY1RvTXNNdWx0aXBsaWVyO1xyXG5cdCAgICAgICAgICAgICAgICBraWxsZWRUb2tlbnMuZm9yRWFjaChmdW5jdGlvbiAodG9rZW4pIHtcclxuXHQgICAgICAgICAgICAgICAgICAgIF90aGlzLl9raWxsZWRUb2tlbkRpY3Rpb25hcnlbdG9rZW5dID0gRGF0ZS5ub3coKSArIGR1cmF0aW9uTXNfMTtcclxuXHQgICAgICAgICAgICAgICAgfSk7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGNhdGNoIChleCkge1xyXG5cdCAgICAgICAgICAgICAgICByZXR1cm4gW107XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgcmV0dXJuIFtdO1xyXG5cdCAgICB9O1xyXG5cdCAgICBBV1RLaWxsU3dpdGNoLnByb3RvdHlwZS5pc1RlbmFudEtpbGxlZCA9IGZ1bmN0aW9uICh0ZW5hbnRUb2tlbikge1xyXG5cdCAgICAgICAgaWYgKHRoaXMuX2tpbGxlZFRva2VuRGljdGlvbmFyeVt0ZW5hbnRUb2tlbl0gIT09IHVuZGVmaW5lZCAmJiB0aGlzLl9raWxsZWRUb2tlbkRpY3Rpb25hcnlbdGVuYW50VG9rZW5dID4gRGF0ZS5ub3coKSkge1xyXG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgZGVsZXRlIHRoaXMuX2tpbGxlZFRva2VuRGljdGlvbmFyeVt0ZW5hbnRUb2tlbl07XHJcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XHJcblx0ICAgIH07XHJcblx0ICAgIHJldHVybiBBV1RLaWxsU3dpdGNoO1xyXG5cdH0oKSk7XHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cdGV4cG9ydHMuZGVmYXVsdCA9IEFXVEtpbGxTd2l0Y2g7XHJcblxyXG5cclxuLyoqKi8gfSxcclxuLyogMTUgKi9cclxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XHJcblxyXG5cdFwidXNlIHN0cmljdFwiO1xyXG5cdC8qKlxyXG5cdCogVmVyc2lvbi50c1xyXG5cdCogQXV0aG9yOiBBYmhpbGFzaCBQYW53YXIgKGFicGFud2FyKVxyXG5cdCogQ29weXJpZ2h0OiBNaWNyb3NvZnQgMjAxNlxyXG5cdCogQ2xhc3MgZm9yIFNESyB2ZXJzaW9uLlxyXG5cdCovXHJcblx0ZXhwb3J0cy5WZXJzaW9uID0gJzEuMi4wJztcclxuXHRleHBvcnRzLkZ1bGxWZXJzaW9uU3RyaW5nID0gJ0FXVC1XZWItQ0pTLScgKyBleHBvcnRzLlZlcnNpb247XHJcblxyXG5cclxuLyoqKi8gfVxyXG4vKioqKioqLyBdKVxyXG59KTtcclxuO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcmlhLXdlYmpzLWNvbXBhY3Qtc2RrLTEuMi4wLmpzLm1hcCIsIi8qXHJcbiAgaHRtbDJjYW52YXMgMC41LjAtYmV0YTMgPGh0dHA6Ly9odG1sMmNhbnZhcy5oZXJ0emVuLmNvbT5cclxuICBDb3B5cmlnaHQgKGMpIDIwMTYgTmlrbGFzIHZvbiBIZXJ0emVuXHJcblxyXG4gIFJlbGVhc2VkIHVuZGVyICBMaWNlbnNlXHJcbiovXHJcbnZhciBQcm9taXNlID0gcmVxdWlyZSgnZXM2LXByb21pc2UnKS5Qcm9taXNlO1xyXG5cclxuIWZ1bmN0aW9uKGUpIHt3aW5kb3cuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmh0bWwyY2FudmFzID0gZX0oZnVuY3Rpb24gKCkge3ZhciBkZWZpbmUsIG1vZHVsZSwgZXhwb3J0cztyZXR1cm4gKGZ1bmN0aW9uIGUodCwgbiwgcikge2Z1bmN0aW9uIHMobywgdSkgeyBpZiAoIW5bb10pIHsgaWYgKCF0W29dKSB7IHZhciBhID0gdHlwZW9mIHJlcXVpcmUgPT0gXCJmdW5jdGlvblwiICYmIHJlcXVpcmU7IGlmICghdSAmJiBhKSByZXR1cm4gYShvLCAhMCk7IGlmIChpKSByZXR1cm4gaShvLCAhMCk7IHZhciBmID0gbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIiArIG8gKyBcIidcIik7IHRocm93IGYuY29kZSA9IFwiTU9EVUxFX05PVF9GT1VORFwiLCBmIH0gdmFyIGwgPSBuW29dID0geyBleHBvcnRzOiB7fSB9OyB0W29dWzBdLmNhbGwobC5leHBvcnRzLCBmdW5jdGlvbiAoZSkgeyB2YXIgbiA9IHRbb11bMV1bZV07IHJldHVybiBzKG4gPyBuIDogZSkgfSwgbCwgbC5leHBvcnRzLCBlLCB0LCBuLCByKSB9IHJldHVybiBuW29dLmV4cG9ydHMgfSB2YXIgaSA9IHR5cGVvZiByZXF1aXJlID09IFwiZnVuY3Rpb25cIiAmJiByZXF1aXJlOyBmb3IgKHZhciBvID0gMDsgbyA8IHIubGVuZ3RoOyBvKyspIHMocltvXSk7IHJldHVybiBzfSkoezE6IFtmdW5jdGlvbiAoX2RlcmVxXywgbW9kdWxlLCBleHBvcnRzKSB7XHJcbihmdW5jdGlvbiAoZ2xvYmFsKXtcclxuLyohIGh0dHA6Ly9tdGhzLmJlL3B1bnljb2RlIHYxLjIuNCBieSBAbWF0aGlhcyAqL1xyXG47KGZ1bmN0aW9uKHJvb3QpIHtcclxuXHJcbiAgICAvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGVzICovXHJcbiAgICB2YXIgZnJlZUV4cG9ydHMgPSB0eXBlb2YgZXhwb3J0cyA9PSAnb2JqZWN0JyAmJiBleHBvcnRzO1xyXG4gICAgdmFyIGZyZWVNb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJlxyXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID09IGZyZWVFeHBvcnRzICYmIG1vZHVsZTtcclxuICAgIHZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWw7XHJcbiAgICBpZiAoZnJlZUdsb2JhbC5nbG9iYWwgPT09IGZyZWVHbG9iYWwgfHwgZnJlZUdsb2JhbC53aW5kb3cgPT09IGZyZWVHbG9iYWwpIHtcclxuICAgICAgICByb290ID0gZnJlZUdsb2JhbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoZSBgcHVueWNvZGVgIG9iamVjdC5cclxuICAgICAqIEBuYW1lIHB1bnljb2RlXHJcbiAgICAgKiBAdHlwZSBPYmplY3RcclxuICAgICAqL1xyXG4gICAgdmFyIHB1bnljb2RlLFxyXG5cclxuICAgIC8qKiBIaWdoZXN0IHBvc2l0aXZlIHNpZ25lZCAzMi1iaXQgZmxvYXQgdmFsdWUgKi9cclxuICAgIG1heEludCA9IDIxNDc0ODM2NDcsIC8vIGFrYS4gMHg3RkZGRkZGRiBvciAyXjMxLTFcclxuXHJcbiAgICAvKiogQm9vdHN0cmluZyBwYXJhbWV0ZXJzICovXHJcbiAgICBiYXNlID0gMzYsXHJcbiAgICB0TWluID0gMSxcclxuICAgIHRNYXggPSAyNixcclxuICAgIHNrZXcgPSAzOCxcclxuICAgIGRhbXAgPSA3MDAsXHJcbiAgICBpbml0aWFsQmlhcyA9IDcyLFxyXG4gICAgaW5pdGlhbE4gPSAxMjgsIC8vIDB4ODBcclxuICAgIGRlbGltaXRlciA9ICctJywgLy8gJ1xceDJEJ1xyXG5cclxuICAgIC8qKiBSZWd1bGFyIGV4cHJlc3Npb25zICovXHJcbiAgICByZWdleFB1bnljb2RlID0gL154bi0tLyxcclxuICAgIHJlZ2V4Tm9uQVNDSUkgPSAvW14gLX5dLywgLy8gdW5wcmludGFibGUgQVNDSUkgY2hhcnMgKyBub24tQVNDSUkgY2hhcnNcclxuICAgIHJlZ2V4U2VwYXJhdG9ycyA9IC9cXHgyRXxcXHUzMDAyfFxcdUZGMEV8XFx1RkY2MS9nLCAvLyBSRkMgMzQ5MCBzZXBhcmF0b3JzXHJcblxyXG4gICAgLyoqIEVycm9yIG1lc3NhZ2VzICovXHJcbiAgICBlcnJvcnMgPSB7XHJcbiAgICAgICAgJ292ZXJmbG93JzogJ092ZXJmbG93OiBpbnB1dCBuZWVkcyB3aWRlciBpbnRlZ2VycyB0byBwcm9jZXNzJyxcclxuICAgICAgICAnbm90LWJhc2ljJzogJ0lsbGVnYWwgaW5wdXQgPj0gMHg4MCAobm90IGEgYmFzaWMgY29kZSBwb2ludCknLFxyXG4gICAgICAgICdpbnZhbGlkLWlucHV0JzogJ0ludmFsaWQgaW5wdXQnXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKiBDb252ZW5pZW5jZSBzaG9ydGN1dHMgKi9cclxuICAgIGJhc2VNaW51c1RNaW4gPSBiYXNlIC0gdE1pbixcclxuICAgIGZsb29yID0gTWF0aC5mbG9vcixcclxuICAgIHN0cmluZ0Zyb21DaGFyQ29kZSA9IFN0cmluZy5mcm9tQ2hhckNvZGUsXHJcblxyXG4gICAgLyoqIFRlbXBvcmFyeSB2YXJpYWJsZSAqL1xyXG4gICAga2V5O1xyXG5cclxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQSBnZW5lcmljIGVycm9yIHV0aWxpdHkgZnVuY3Rpb24uXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgVGhlIGVycm9yIHR5cGUuXHJcbiAgICAgKiBAcmV0dXJucyB7RXJyb3J9IFRocm93cyBhIGBSYW5nZUVycm9yYCB3aXRoIHRoZSBhcHBsaWNhYmxlIGVycm9yIG1lc3NhZ2UuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGVycm9yKHR5cGUpIHtcclxuICAgICAgICB0aHJvdyBSYW5nZUVycm9yKGVycm9yc1t0eXBlXSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBIGdlbmVyaWMgYEFycmF5I21hcGAgdXRpbGl0eSBmdW5jdGlvbi5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRoYXQgZ2V0cyBjYWxsZWQgZm9yIGV2ZXJ5IGFycmF5XHJcbiAgICAgKiBpdGVtLlxyXG4gICAgICogQHJldHVybnMge0FycmF5fSBBIG5ldyBhcnJheSBvZiB2YWx1ZXMgcmV0dXJuZWQgYnkgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBtYXAoYXJyYXksIGZuKSB7XHJcbiAgICAgICAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcclxuICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHtcclxuICAgICAgICAgICAgYXJyYXlbbGVuZ3RoXSA9IGZuKGFycmF5W2xlbmd0aF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXJyYXk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBIHNpbXBsZSBgQXJyYXkjbWFwYC1saWtlIHdyYXBwZXIgdG8gd29yayB3aXRoIGRvbWFpbiBuYW1lIHN0cmluZ3MuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGRvbWFpbiBUaGUgZG9tYWluIG5hbWUuXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBmb3IgZXZlcnlcclxuICAgICAqIGNoYXJhY3Rlci5cclxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gQSBuZXcgc3RyaW5nIG9mIGNoYXJhY3RlcnMgcmV0dXJuZWQgYnkgdGhlIGNhbGxiYWNrXHJcbiAgICAgKiBmdW5jdGlvbi5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbWFwRG9tYWluKHN0cmluZywgZm4pIHtcclxuICAgICAgICByZXR1cm4gbWFwKHN0cmluZy5zcGxpdChyZWdleFNlcGFyYXRvcnMpLCBmbikuam9pbignLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBjb250YWluaW5nIHRoZSBudW1lcmljIGNvZGUgcG9pbnRzIG9mIGVhY2ggVW5pY29kZVxyXG4gICAgICogY2hhcmFjdGVyIGluIHRoZSBzdHJpbmcuIFdoaWxlIEphdmFTY3JpcHQgdXNlcyBVQ1MtMiBpbnRlcm5hbGx5LFxyXG4gICAgICogdGhpcyBmdW5jdGlvbiB3aWxsIGNvbnZlcnQgYSBwYWlyIG9mIHN1cnJvZ2F0ZSBoYWx2ZXMgKGVhY2ggb2Ygd2hpY2hcclxuICAgICAqIFVDUy0yIGV4cG9zZXMgYXMgc2VwYXJhdGUgY2hhcmFjdGVycykgaW50byBhIHNpbmdsZSBjb2RlIHBvaW50LFxyXG4gICAgICogbWF0Y2hpbmcgVVRGLTE2LlxyXG4gICAgICogQHNlZSBgcHVueWNvZGUudWNzMi5lbmNvZGVgXHJcbiAgICAgKiBAc2VlIDxodHRwOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPlxyXG4gICAgICogQG1lbWJlck9mIHB1bnljb2RlLnVjczJcclxuICAgICAqIEBuYW1lIGRlY29kZVxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHN0cmluZyBUaGUgVW5pY29kZSBpbnB1dCBzdHJpbmcgKFVDUy0yKS5cclxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gVGhlIG5ldyBhcnJheSBvZiBjb2RlIHBvaW50cy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdWNzMmRlY29kZShzdHJpbmcpIHtcclxuICAgICAgICB2YXIgb3V0cHV0ID0gW10sXHJcbiAgICAgICAgICAgIGNvdW50ZXIgPSAwLFxyXG4gICAgICAgICAgICBsZW5ndGggPSBzdHJpbmcubGVuZ3RoLFxyXG4gICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgZXh0cmE7XHJcbiAgICAgICAgd2hpbGUgKGNvdW50ZXIgPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSBzdHJpbmcuY2hhckNvZGVBdChjb3VudGVyKyspO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUgPj0gMHhEODAwICYmIHZhbHVlIDw9IDB4REJGRiAmJiBjb3VudGVyIDwgbGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBoaWdoIHN1cnJvZ2F0ZSwgYW5kIHRoZXJlIGlzIGEgbmV4dCBjaGFyYWN0ZXJcclxuICAgICAgICAgICAgICAgIGV4dHJhID0gc3RyaW5nLmNoYXJDb2RlQXQoY291bnRlcisrKTtcclxuICAgICAgICAgICAgICAgIGlmICgoZXh0cmEgJiAweEZDMDApID09IDB4REMwMCkgeyAvLyBsb3cgc3Vycm9nYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goKCh2YWx1ZSAmIDB4M0ZGKSA8PCAxMCkgKyAoZXh0cmEgJiAweDNGRikgKyAweDEwMDAwKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdW5tYXRjaGVkIHN1cnJvZ2F0ZTsgb25seSBhcHBlbmQgdGhpcyBjb2RlIHVuaXQsIGluIGNhc2UgdGhlIG5leHRcclxuICAgICAgICAgICAgICAgICAgICAvLyBjb2RlIHVuaXQgaXMgdGhlIGhpZ2ggc3Vycm9nYXRlIG9mIGEgc3Vycm9nYXRlIHBhaXJcclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY291bnRlci0tO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgb3V0cHV0LnB1c2godmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvdXRwdXQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgc3RyaW5nIGJhc2VkIG9uIGFuIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuXHJcbiAgICAgKiBAc2VlIGBwdW55Y29kZS51Y3MyLmRlY29kZWBcclxuICAgICAqIEBtZW1iZXJPZiBwdW55Y29kZS51Y3MyXHJcbiAgICAgKiBAbmFtZSBlbmNvZGVcclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGNvZGVQb2ludHMgVGhlIGFycmF5IG9mIG51bWVyaWMgY29kZSBwb2ludHMuXHJcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgbmV3IFVuaWNvZGUgc3RyaW5nIChVQ1MtMikuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHVjczJlbmNvZGUoYXJyYXkpIHtcclxuICAgICAgICByZXR1cm4gbWFwKGFycmF5LCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gJyc7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA+IDB4RkZGRikge1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgLT0gMHgxMDAwMDtcclxuICAgICAgICAgICAgICAgIG91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUgPj4+IDEwICYgMHgzRkYgfCAweEQ4MDApO1xyXG4gICAgICAgICAgICAgICAgdmFsdWUgPSAweERDMDAgfCB2YWx1ZSAmIDB4M0ZGO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG91dHB1dCArPSBzdHJpbmdGcm9tQ2hhckNvZGUodmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xyXG4gICAgICAgIH0pLmpvaW4oJycpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBiYXNpYyBjb2RlIHBvaW50IGludG8gYSBkaWdpdC9pbnRlZ2VyLlxyXG4gICAgICogQHNlZSBgZGlnaXRUb0Jhc2ljKClgXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGNvZGVQb2ludCBUaGUgYmFzaWMgbnVtZXJpYyBjb2RlIHBvaW50IHZhbHVlLlxyXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhlIG51bWVyaWMgdmFsdWUgb2YgYSBiYXNpYyBjb2RlIHBvaW50IChmb3IgdXNlIGluXHJcbiAgICAgKiByZXByZXNlbnRpbmcgaW50ZWdlcnMpIGluIHRoZSByYW5nZSBgMGAgdG8gYGJhc2UgLSAxYCwgb3IgYGJhc2VgIGlmXHJcbiAgICAgKiB0aGUgY29kZSBwb2ludCBkb2VzIG5vdCByZXByZXNlbnQgYSB2YWx1ZS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gYmFzaWNUb0RpZ2l0KGNvZGVQb2ludCkge1xyXG4gICAgICAgIGlmIChjb2RlUG9pbnQgLSA0OCA8IDEwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb2RlUG9pbnQgLSAyMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNvZGVQb2ludCAtIDY1IDwgMjYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvZGVQb2ludCAtIDY1O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29kZVBvaW50IC0gOTcgPCAyNikge1xyXG4gICAgICAgICAgICByZXR1cm4gY29kZVBvaW50IC0gOTc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBiYXNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBkaWdpdC9pbnRlZ2VyIGludG8gYSBiYXNpYyBjb2RlIHBvaW50LlxyXG4gICAgICogQHNlZSBgYmFzaWNUb0RpZ2l0KClgXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRpZ2l0IFRoZSBudW1lcmljIHZhbHVlIG9mIGEgYmFzaWMgY29kZSBwb2ludC5cclxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBiYXNpYyBjb2RlIHBvaW50IHdob3NlIHZhbHVlICh3aGVuIHVzZWQgZm9yXHJcbiAgICAgKiByZXByZXNlbnRpbmcgaW50ZWdlcnMpIGlzIGBkaWdpdGAsIHdoaWNoIG5lZWRzIHRvIGJlIGluIHRoZSByYW5nZVxyXG4gICAgICogYDBgIHRvIGBiYXNlIC0gMWAuIElmIGBmbGFnYCBpcyBub24temVybywgdGhlIHVwcGVyY2FzZSBmb3JtIGlzXHJcbiAgICAgKiB1c2VkOyBlbHNlLCB0aGUgbG93ZXJjYXNlIGZvcm0gaXMgdXNlZC4gVGhlIGJlaGF2aW9yIGlzIHVuZGVmaW5lZFxyXG4gICAgICogaWYgYGZsYWdgIGlzIG5vbi16ZXJvIGFuZCBgZGlnaXRgIGhhcyBubyB1cHBlcmNhc2UgZm9ybS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZGlnaXRUb0Jhc2ljKGRpZ2l0LCBmbGFnKSB7XHJcbiAgICAgICAgLy8gIDAuLjI1IG1hcCB0byBBU0NJSSBhLi56IG9yIEEuLlpcclxuICAgICAgICAvLyAyNi4uMzUgbWFwIHRvIEFTQ0lJIDAuLjlcclxuICAgICAgICByZXR1cm4gZGlnaXQgKyAyMiArIDc1ICogKGRpZ2l0IDwgMjYpIC0gKChmbGFnICE9IDApIDw8IDUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQmlhcyBhZGFwdGF0aW9uIGZ1bmN0aW9uIGFzIHBlciBzZWN0aW9uIDMuNCBvZiBSRkMgMzQ5Mi5cclxuICAgICAqIGh0dHA6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzM0OTIjc2VjdGlvbi0zLjRcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGFkYXB0KGRlbHRhLCBudW1Qb2ludHMsIGZpcnN0VGltZSkge1xyXG4gICAgICAgIHZhciBrID0gMDtcclxuICAgICAgICBkZWx0YSA9IGZpcnN0VGltZSA/IGZsb29yKGRlbHRhIC8gZGFtcCkgOiBkZWx0YSA+PiAxO1xyXG4gICAgICAgIGRlbHRhICs9IGZsb29yKGRlbHRhIC8gbnVtUG9pbnRzKTtcclxuICAgICAgICBmb3IgKC8qIG5vIGluaXRpYWxpemF0aW9uICovOyBkZWx0YSA+IGJhc2VNaW51c1RNaW4gKiB0TWF4ID4+IDE7IGsgKz0gYmFzZSkge1xyXG4gICAgICAgICAgICBkZWx0YSA9IGZsb29yKGRlbHRhIC8gYmFzZU1pbnVzVE1pbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmbG9vcihrICsgKGJhc2VNaW51c1RNaW4gKyAxKSAqIGRlbHRhIC8gKGRlbHRhICsgc2tldykpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBQdW55Y29kZSBzdHJpbmcgb2YgQVNDSUktb25seSBzeW1ib2xzIHRvIGEgc3RyaW5nIG9mIFVuaWNvZGVcclxuICAgICAqIHN5bWJvbHMuXHJcbiAgICAgKiBAbWVtYmVyT2YgcHVueWNvZGVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZGVjb2RlKGlucHV0KSB7XHJcbiAgICAgICAgLy8gRG9uJ3QgdXNlIFVDUy0yXHJcbiAgICAgICAgdmFyIG91dHB1dCA9IFtdLFxyXG4gICAgICAgICAgICBpbnB1dExlbmd0aCA9IGlucHV0Lmxlbmd0aCxcclxuICAgICAgICAgICAgb3V0LFxyXG4gICAgICAgICAgICBpID0gMCxcclxuICAgICAgICAgICAgbiA9IGluaXRpYWxOLFxyXG4gICAgICAgICAgICBiaWFzID0gaW5pdGlhbEJpYXMsXHJcbiAgICAgICAgICAgIGJhc2ljLFxyXG4gICAgICAgICAgICBqLFxyXG4gICAgICAgICAgICBpbmRleCxcclxuICAgICAgICAgICAgb2xkaSxcclxuICAgICAgICAgICAgdyxcclxuICAgICAgICAgICAgayxcclxuICAgICAgICAgICAgZGlnaXQsXHJcbiAgICAgICAgICAgIHQsXHJcbiAgICAgICAgICAgIC8qKiBDYWNoZWQgY2FsY3VsYXRpb24gcmVzdWx0cyAqL1xyXG4gICAgICAgICAgICBiYXNlTWludXNUO1xyXG5cclxuICAgICAgICAvLyBIYW5kbGUgdGhlIGJhc2ljIGNvZGUgcG9pbnRzOiBsZXQgYGJhc2ljYCBiZSB0aGUgbnVtYmVyIG9mIGlucHV0IGNvZGVcclxuICAgICAgICAvLyBwb2ludHMgYmVmb3JlIHRoZSBsYXN0IGRlbGltaXRlciwgb3IgYDBgIGlmIHRoZXJlIGlzIG5vbmUsIHRoZW4gY29weVxyXG4gICAgICAgIC8vIHRoZSBmaXJzdCBiYXNpYyBjb2RlIHBvaW50cyB0byB0aGUgb3V0cHV0LlxyXG5cclxuICAgICAgICBiYXNpYyA9IGlucHV0Lmxhc3RJbmRleE9mKGRlbGltaXRlcik7XHJcbiAgICAgICAgaWYgKGJhc2ljIDwgMCkge1xyXG4gICAgICAgICAgICBiYXNpYyA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgYmFzaWM7ICsraikge1xyXG4gICAgICAgICAgICAvLyBpZiBpdCdzIG5vdCBhIGJhc2ljIGNvZGUgcG9pbnRcclxuICAgICAgICAgICAgaWYgKGlucHV0LmNoYXJDb2RlQXQoaikgPj0gMHg4MCkge1xyXG4gICAgICAgICAgICAgICAgZXJyb3IoJ25vdC1iYXNpYycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGlucHV0LmNoYXJDb2RlQXQoaikpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTWFpbiBkZWNvZGluZyBsb29wOiBzdGFydCBqdXN0IGFmdGVyIHRoZSBsYXN0IGRlbGltaXRlciBpZiBhbnkgYmFzaWMgY29kZVxyXG4gICAgICAgIC8vIHBvaW50cyB3ZXJlIGNvcGllZDsgc3RhcnQgYXQgdGhlIGJlZ2lubmluZyBvdGhlcndpc2UuXHJcblxyXG4gICAgICAgIGZvciAoaW5kZXggPSBiYXNpYyA+IDAgPyBiYXNpYyArIDEgOiAwOyBpbmRleCA8IGlucHV0TGVuZ3RoOyAvKiBubyBmaW5hbCBleHByZXNzaW9uICovKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBgaW5kZXhgIGlzIHRoZSBpbmRleCBvZiB0aGUgbmV4dCBjaGFyYWN0ZXIgdG8gYmUgY29uc3VtZWQuXHJcbiAgICAgICAgICAgIC8vIERlY29kZSBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyIGludG8gYGRlbHRhYCxcclxuICAgICAgICAgICAgLy8gd2hpY2ggZ2V0cyBhZGRlZCB0byBgaWAuIFRoZSBvdmVyZmxvdyBjaGVja2luZyBpcyBlYXNpZXJcclxuICAgICAgICAgICAgLy8gaWYgd2UgaW5jcmVhc2UgYGlgIGFzIHdlIGdvLCB0aGVuIHN1YnRyYWN0IG9mZiBpdHMgc3RhcnRpbmdcclxuICAgICAgICAgICAgLy8gdmFsdWUgYXQgdGhlIGVuZCB0byBvYnRhaW4gYGRlbHRhYC5cclxuICAgICAgICAgICAgZm9yIChvbGRpID0gaSwgdyA9IDEsIGsgPSBiYXNlOyAvKiBubyBjb25kaXRpb24gKi87IGsgKz0gYmFzZSkge1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpbmRleCA+PSBpbnB1dExlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yKCdpbnZhbGlkLWlucHV0Jyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZGlnaXQgPSBiYXNpY1RvRGlnaXQoaW5wdXQuY2hhckNvZGVBdChpbmRleCsrKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGRpZ2l0ID49IGJhc2UgfHwgZGlnaXQgPiBmbG9vcigobWF4SW50IC0gaSkgLyB3KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yKCdvdmVyZmxvdycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGkgKz0gZGlnaXQgKiB3O1xyXG4gICAgICAgICAgICAgICAgdCA9IGsgPD0gYmlhcyA/IHRNaW4gOiAoayA+PSBiaWFzICsgdE1heCA/IHRNYXggOiBrIC0gYmlhcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGRpZ2l0IDwgdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGJhc2VNaW51c1QgPSBiYXNlIC0gdDtcclxuICAgICAgICAgICAgICAgIGlmICh3ID4gZmxvb3IobWF4SW50IC8gYmFzZU1pbnVzVCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlcnJvcignb3ZlcmZsb3cnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB3ICo9IGJhc2VNaW51c1Q7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBvdXQgPSBvdXRwdXQubGVuZ3RoICsgMTtcclxuICAgICAgICAgICAgYmlhcyA9IGFkYXB0KGkgLSBvbGRpLCBvdXQsIG9sZGkgPT0gMCk7XHJcblxyXG4gICAgICAgICAgICAvLyBgaWAgd2FzIHN1cHBvc2VkIHRvIHdyYXAgYXJvdW5kIGZyb20gYG91dGAgdG8gYDBgLFxyXG4gICAgICAgICAgICAvLyBpbmNyZW1lbnRpbmcgYG5gIGVhY2ggdGltZSwgc28gd2UnbGwgZml4IHRoYXQgbm93OlxyXG4gICAgICAgICAgICBpZiAoZmxvb3IoaSAvIG91dCkgPiBtYXhJbnQgLSBuKSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvcignb3ZlcmZsb3cnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbiArPSBmbG9vcihpIC8gb3V0KTtcclxuICAgICAgICAgICAgaSAlPSBvdXQ7XHJcblxyXG4gICAgICAgICAgICAvLyBJbnNlcnQgYG5gIGF0IHBvc2l0aW9uIGBpYCBvZiB0aGUgb3V0cHV0XHJcbiAgICAgICAgICAgIG91dHB1dC5zcGxpY2UoaSsrLCAwLCBuKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdWNzMmVuY29kZShvdXRwdXQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBzdHJpbmcgb2YgVW5pY29kZSBzeW1ib2xzIHRvIGEgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHlcclxuICAgICAqIHN5bWJvbHMuXHJcbiAgICAgKiBAbWVtYmVyT2YgcHVueWNvZGVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpbnB1dCBUaGUgc3RyaW5nIG9mIFVuaWNvZGUgc3ltYm9scy5cclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSByZXN1bHRpbmcgUHVueWNvZGUgc3RyaW5nIG9mIEFTQ0lJLW9ubHkgc3ltYm9scy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gZW5jb2RlKGlucHV0KSB7XHJcbiAgICAgICAgdmFyIG4sXHJcbiAgICAgICAgICAgIGRlbHRhLFxyXG4gICAgICAgICAgICBoYW5kbGVkQ1BDb3VudCxcclxuICAgICAgICAgICAgYmFzaWNMZW5ndGgsXHJcbiAgICAgICAgICAgIGJpYXMsXHJcbiAgICAgICAgICAgIGosXHJcbiAgICAgICAgICAgIG0sXHJcbiAgICAgICAgICAgIHEsXHJcbiAgICAgICAgICAgIGssXHJcbiAgICAgICAgICAgIHQsXHJcbiAgICAgICAgICAgIGN1cnJlbnRWYWx1ZSxcclxuICAgICAgICAgICAgb3V0cHV0ID0gW10sXHJcbiAgICAgICAgICAgIC8qKiBgaW5wdXRMZW5ndGhgIHdpbGwgaG9sZCB0aGUgbnVtYmVyIG9mIGNvZGUgcG9pbnRzIGluIGBpbnB1dGAuICovXHJcbiAgICAgICAgICAgIGlucHV0TGVuZ3RoLFxyXG4gICAgICAgICAgICAvKiogQ2FjaGVkIGNhbGN1bGF0aW9uIHJlc3VsdHMgKi9cclxuICAgICAgICAgICAgaGFuZGxlZENQQ291bnRQbHVzT25lLFxyXG4gICAgICAgICAgICBiYXNlTWludXNULFxyXG4gICAgICAgICAgICBxTWludXNUO1xyXG5cclxuICAgICAgICAvLyBDb252ZXJ0IHRoZSBpbnB1dCBpbiBVQ1MtMiB0byBVbmljb2RlXHJcbiAgICAgICAgaW5wdXQgPSB1Y3MyZGVjb2RlKGlucHV0KTtcclxuXHJcbiAgICAgICAgLy8gQ2FjaGUgdGhlIGxlbmd0aFxyXG4gICAgICAgIGlucHV0TGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xyXG5cclxuICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBzdGF0ZVxyXG4gICAgICAgIG4gPSBpbml0aWFsTjtcclxuICAgICAgICBkZWx0YSA9IDA7XHJcbiAgICAgICAgYmlhcyA9IGluaXRpYWxCaWFzO1xyXG5cclxuICAgICAgICAvLyBIYW5kbGUgdGhlIGJhc2ljIGNvZGUgcG9pbnRzXHJcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IGlucHV0TGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgY3VycmVudFZhbHVlID0gaW5wdXRbal07XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPCAweDgwKSB7XHJcbiAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoY3VycmVudFZhbHVlKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGhhbmRsZWRDUENvdW50ID0gYmFzaWNMZW5ndGggPSBvdXRwdXQubGVuZ3RoO1xyXG5cclxuICAgICAgICAvLyBgaGFuZGxlZENQQ291bnRgIGlzIHRoZSBudW1iZXIgb2YgY29kZSBwb2ludHMgdGhhdCBoYXZlIGJlZW4gaGFuZGxlZDtcclxuICAgICAgICAvLyBgYmFzaWNMZW5ndGhgIGlzIHRoZSBudW1iZXIgb2YgYmFzaWMgY29kZSBwb2ludHMuXHJcblxyXG4gICAgICAgIC8vIEZpbmlzaCB0aGUgYmFzaWMgc3RyaW5nIC0gaWYgaXQgaXMgbm90IGVtcHR5IC0gd2l0aCBhIGRlbGltaXRlclxyXG4gICAgICAgIGlmIChiYXNpY0xlbmd0aCkge1xyXG4gICAgICAgICAgICBvdXRwdXQucHVzaChkZWxpbWl0ZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTWFpbiBlbmNvZGluZyBsb29wOlxyXG4gICAgICAgIHdoaWxlIChoYW5kbGVkQ1BDb3VudCA8IGlucHV0TGVuZ3RoKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBBbGwgbm9uLWJhc2ljIGNvZGUgcG9pbnRzIDwgbiBoYXZlIGJlZW4gaGFuZGxlZCBhbHJlYWR5LiBGaW5kIHRoZSBuZXh0XHJcbiAgICAgICAgICAgIC8vIGxhcmdlciBvbmU6XHJcbiAgICAgICAgICAgIGZvciAobSA9IG1heEludCwgaiA9IDA7IGogPCBpbnB1dExlbmd0aDsgKytqKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWUgPSBpbnB1dFtqXTtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPj0gbiAmJiBjdXJyZW50VmFsdWUgPCBtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbSA9IGN1cnJlbnRWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gSW5jcmVhc2UgYGRlbHRhYCBlbm91Z2ggdG8gYWR2YW5jZSB0aGUgZGVjb2RlcidzIDxuLGk+IHN0YXRlIHRvIDxtLDA+LFxyXG4gICAgICAgICAgICAvLyBidXQgZ3VhcmQgYWdhaW5zdCBvdmVyZmxvd1xyXG4gICAgICAgICAgICBoYW5kbGVkQ1BDb3VudFBsdXNPbmUgPSBoYW5kbGVkQ1BDb3VudCArIDE7XHJcbiAgICAgICAgICAgIGlmIChtIC0gbiA+IGZsb29yKChtYXhJbnQgLSBkZWx0YSkgLyBoYW5kbGVkQ1BDb3VudFBsdXNPbmUpKSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvcignb3ZlcmZsb3cnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZGVsdGEgKz0gKG0gLSBuKSAqIGhhbmRsZWRDUENvdW50UGx1c09uZTtcclxuICAgICAgICAgICAgbiA9IG07XHJcblxyXG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgaW5wdXRMZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlID0gaW5wdXRbal07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZSA8IG4gJiYgKytkZWx0YSA+IG1heEludCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yKCdvdmVyZmxvdycpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgPT0gbikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlcHJlc2VudCBkZWx0YSBhcyBhIGdlbmVyYWxpemVkIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChxID0gZGVsdGEsIGsgPSBiYXNlOyAvKiBubyBjb25kaXRpb24gKi87IGsgKz0gYmFzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gayA8PSBiaWFzID8gdE1pbiA6IChrID49IGJpYXMgKyB0TWF4ID8gdE1heCA6IGsgLSBiaWFzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHEgPCB0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxTWludXNUID0gcSAtIHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VNaW51c1QgPSBiYXNlIC0gdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHQgKyBxTWludXNUICUgYmFzZU1pbnVzVCwgMCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHEgPSBmbG9vcihxTWludXNUIC8gYmFzZU1pbnVzVCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChzdHJpbmdGcm9tQ2hhckNvZGUoZGlnaXRUb0Jhc2ljKHEsIDApKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYmlhcyA9IGFkYXB0KGRlbHRhLCBoYW5kbGVkQ1BDb3VudFBsdXNPbmUsIGhhbmRsZWRDUENvdW50ID09IGJhc2ljTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWx0YSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgKytoYW5kbGVkQ1BDb3VudDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgKytkZWx0YTtcclxuICAgICAgICAgICAgKytuO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnZlcnRzIGEgUHVueWNvZGUgc3RyaW5nIHJlcHJlc2VudGluZyBhIGRvbWFpbiBuYW1lIHRvIFVuaWNvZGUuIE9ubHkgdGhlXHJcbiAgICAgKiBQdW55Y29kZWQgcGFydHMgb2YgdGhlIGRvbWFpbiBuYW1lIHdpbGwgYmUgY29udmVydGVkLCBpLmUuIGl0IGRvZXNuJ3RcclxuICAgICAqIG1hdHRlciBpZiB5b3UgY2FsbCBpdCBvbiBhIHN0cmluZyB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gY29udmVydGVkIHRvXHJcbiAgICAgKiBVbmljb2RlLlxyXG4gICAgICogQG1lbWJlck9mIHB1bnljb2RlXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZG9tYWluIFRoZSBQdW55Y29kZSBkb21haW4gbmFtZSB0byBjb252ZXJ0IHRvIFVuaWNvZGUuXHJcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgVW5pY29kZSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gUHVueWNvZGVcclxuICAgICAqIHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdG9Vbmljb2RlKGRvbWFpbikge1xyXG4gICAgICAgIHJldHVybiBtYXBEb21haW4oZG9tYWluLCBmdW5jdGlvbihzdHJpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZ2V4UHVueWNvZGUudGVzdChzdHJpbmcpXHJcbiAgICAgICAgICAgICAgICA/IGRlY29kZShzdHJpbmcuc2xpY2UoNCkudG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgICAgICAgIDogc3RyaW5nO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ29udmVydHMgYSBVbmljb2RlIHN0cmluZyByZXByZXNlbnRpbmcgYSBkb21haW4gbmFtZSB0byBQdW55Y29kZS4gT25seSB0aGVcclxuICAgICAqIG5vbi1BU0NJSSBwYXJ0cyBvZiB0aGUgZG9tYWluIG5hbWUgd2lsbCBiZSBjb252ZXJ0ZWQsIGkuZS4gaXQgZG9lc24ndFxyXG4gICAgICogbWF0dGVyIGlmIHlvdSBjYWxsIGl0IHdpdGggYSBkb21haW4gdGhhdCdzIGFscmVhZHkgaW4gQVNDSUkuXHJcbiAgICAgKiBAbWVtYmVyT2YgcHVueWNvZGVcclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkb21haW4gVGhlIGRvbWFpbiBuYW1lIHRvIGNvbnZlcnQsIGFzIGEgVW5pY29kZSBzdHJpbmcuXHJcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgUHVueWNvZGUgcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIGRvbWFpbiBuYW1lLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiB0b0FTQ0lJKGRvbWFpbikge1xyXG4gICAgICAgIHJldHVybiBtYXBEb21haW4oZG9tYWluLCBmdW5jdGlvbihzdHJpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlZ2V4Tm9uQVNDSUkudGVzdChzdHJpbmcpXHJcbiAgICAgICAgICAgICAgICA/ICd4bi0tJyArIGVuY29kZShzdHJpbmcpXHJcbiAgICAgICAgICAgICAgICA6IHN0cmluZztcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cclxuXHJcbiAgICAvKiogRGVmaW5lIHRoZSBwdWJsaWMgQVBJICovXHJcbiAgICBwdW55Y29kZSA9IHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgUHVueWNvZGUuanMgdmVyc2lvbiBudW1iZXIuXHJcbiAgICAgICAgICogQG1lbWJlck9mIHB1bnljb2RlXHJcbiAgICAgICAgICogQHR5cGUgU3RyaW5nXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgJ3ZlcnNpb24nOiAnMS4yLjQnLFxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFuIG9iamVjdCBvZiBtZXRob2RzIHRvIGNvbnZlcnQgZnJvbSBKYXZhU2NyaXB0J3MgaW50ZXJuYWwgY2hhcmFjdGVyXHJcbiAgICAgICAgICogcmVwcmVzZW50YXRpb24gKFVDUy0yKSB0byBVbmljb2RlIGNvZGUgcG9pbnRzLCBhbmQgYmFjay5cclxuICAgICAgICAgKiBAc2VlIDxodHRwOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9qYXZhc2NyaXB0LWVuY29kaW5nPlxyXG4gICAgICAgICAqIEBtZW1iZXJPZiBwdW55Y29kZVxyXG4gICAgICAgICAqIEB0eXBlIE9iamVjdFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgICd1Y3MyJzoge1xyXG4gICAgICAgICAgICAnZGVjb2RlJzogdWNzMmRlY29kZSxcclxuICAgICAgICAgICAgJ2VuY29kZSc6IHVjczJlbmNvZGVcclxuICAgICAgICB9LFxyXG4gICAgICAgICdkZWNvZGUnOiBkZWNvZGUsXHJcbiAgICAgICAgJ2VuY29kZSc6IGVuY29kZSxcclxuICAgICAgICAndG9BU0NJSSc6IHRvQVNDSUksXHJcbiAgICAgICAgJ3RvVW5pY29kZSc6IHRvVW5pY29kZVxyXG4gICAgfTtcclxuXHJcbiAgICAvKiogRXhwb3NlIGBwdW55Y29kZWAgKi9cclxuICAgIC8vIFNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJuc1xyXG4gICAgLy8gbGlrZSB0aGUgZm9sbG93aW5nOlxyXG4gICAgaWYgKFxyXG4gICAgICAgIHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJlxyXG4gICAgICAgIHR5cGVvZiBkZWZpbmUuYW1kID09ICdvYmplY3QnICYmXHJcbiAgICAgICAgZGVmaW5lLmFtZFxyXG4gICAgKSB7XHJcbiAgICAgICAgZGVmaW5lKCdwdW55Y29kZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcHVueWNvZGU7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmICFmcmVlRXhwb3J0cy5ub2RlVHlwZSkge1xyXG4gICAgICAgIGlmIChmcmVlTW9kdWxlKSB7IC8vIGluIE5vZGUuanMgb3IgUmluZ29KUyB2MC44LjArXHJcbiAgICAgICAgICAgIGZyZWVNb2R1bGUuZXhwb3J0cyA9IHB1bnljb2RlO1xyXG4gICAgICAgIH0gZWxzZSB7IC8vIGluIE5hcndoYWwgb3IgUmluZ29KUyB2MC43LjAtXHJcbiAgICAgICAgICAgIGZvciAoa2V5IGluIHB1bnljb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBwdW55Y29kZS5oYXNPd25Qcm9wZXJ0eShrZXkpICYmIChmcmVlRXhwb3J0c1trZXldID0gcHVueWNvZGVba2V5XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgeyAvLyBpbiBSaGlubyBvciBhIHdlYiBicm93c2VyXHJcbiAgICAgICAgcm9vdC5wdW55Y29kZSA9IHB1bnljb2RlO1xyXG4gICAgfVxyXG5cclxufSh0aGlzKSk7XHJcblxyXG59KS5jYWxsKHRoaXMsdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSlcclxufSx7fV0sMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBsb2cgPSBfZGVyZXFfKCcuL2xvZycpO1xyXG5cclxuZnVuY3Rpb24gcmVzdG9yZU93bmVyU2Nyb2xsKG93bmVyRG9jdW1lbnQsIHgsIHkpIHtcclxuICAgIGlmIChvd25lckRvY3VtZW50LmRlZmF1bHRWaWV3ICYmICh4ICE9PSBvd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LnBhZ2VYT2Zmc2V0IHx8IHkgIT09IG93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcucGFnZVlPZmZzZXQpKSB7XHJcbiAgICAgICAgb3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5zY3JvbGxUbyh4LCB5KTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xvbmVDYW52YXNDb250ZW50cyhjYW52YXMsIGNsb25lZENhbnZhcykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBpZiAoY2xvbmVkQ2FudmFzKSB7XHJcbiAgICAgICAgICAgIGNsb25lZENhbnZhcy53aWR0aCA9IGNhbnZhcy53aWR0aDtcclxuICAgICAgICAgICAgY2xvbmVkQ2FudmFzLmhlaWdodCA9IGNhbnZhcy5oZWlnaHQ7XHJcbiAgICAgICAgICAgIGNsb25lZENhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikucHV0SW1hZ2VEYXRhKGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikuZ2V0SW1hZ2VEYXRhKDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCksIDAsIDApO1xyXG4gICAgICAgIH1cclxuICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgIGxvZyhcIlVuYWJsZSB0byBjb3B5IGNhbnZhcyBjb250ZW50IGZyb21cIiwgY2FudmFzLCBlKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY2xvbmVOb2RlKG5vZGUsIGphdmFzY3JpcHRFbmFibGVkKSB7XHJcbiAgICB2YXIgY2xvbmUgPSBub2RlLm5vZGVUeXBlID09PSAzID8gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUobm9kZS5ub2RlVmFsdWUpIDogbm9kZS5jbG9uZU5vZGUoZmFsc2UpO1xyXG5cclxuICAgIHZhciBjaGlsZCA9IG5vZGUuZmlyc3RDaGlsZDtcclxuICAgIHdoaWxlKGNoaWxkKSB7XHJcbiAgICAgICAgaWYgKGphdmFzY3JpcHRFbmFibGVkID09PSB0cnVlIHx8IGNoaWxkLm5vZGVUeXBlICE9PSAxIHx8IGNoaWxkLm5vZGVOYW1lICE9PSAnU0NSSVBUJykge1xyXG4gICAgICAgICAgICBjbG9uZS5hcHBlbmRDaGlsZChjbG9uZU5vZGUoY2hpbGQsIGphdmFzY3JpcHRFbmFibGVkKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNoaWxkID0gY2hpbGQubmV4dFNpYmxpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEpIHtcclxuICAgICAgICBjbG9uZS5fc2Nyb2xsVG9wID0gbm9kZS5zY3JvbGxUb3A7XHJcbiAgICAgICAgY2xvbmUuX3Njcm9sbExlZnQgPSBub2RlLnNjcm9sbExlZnQ7XHJcbiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IFwiQ0FOVkFTXCIpIHtcclxuICAgICAgICAgICAgY2xvbmVDYW52YXNDb250ZW50cyhub2RlLCBjbG9uZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChub2RlLm5vZGVOYW1lID09PSBcIlRFWFRBUkVBXCIgfHwgbm9kZS5ub2RlTmFtZSA9PT0gXCJTRUxFQ1RcIikge1xyXG4gICAgICAgICAgICBjbG9uZS52YWx1ZSA9IG5vZGUudmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjbG9uZTtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdE5vZGUobm9kZSkge1xyXG4gICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDEpIHtcclxuICAgICAgICBub2RlLnNjcm9sbFRvcCA9IG5vZGUuX3Njcm9sbFRvcDtcclxuICAgICAgICBub2RlLnNjcm9sbExlZnQgPSBub2RlLl9zY3JvbGxMZWZ0O1xyXG5cclxuICAgICAgICB2YXIgY2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7XHJcbiAgICAgICAgd2hpbGUoY2hpbGQpIHtcclxuICAgICAgICAgICAgaW5pdE5vZGUoY2hpbGQpO1xyXG4gICAgICAgICAgICBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvd25lckRvY3VtZW50LCBjb250YWluZXJEb2N1bWVudCwgd2lkdGgsIGhlaWdodCwgb3B0aW9ucywgeCAseSkge1xyXG4gICAgdmFyIGRvY3VtZW50RWxlbWVudCA9IGNsb25lTm9kZShvd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudCwgb3B0aW9ucy5qYXZhc2NyaXB0RW5hYmxlZCk7XHJcbiAgICB2YXIgY29udGFpbmVyID0gY29udGFpbmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcclxuXHJcbiAgICBjb250YWluZXIuY2xhc3NOYW1lID0gXCJodG1sMmNhbnZhcy1jb250YWluZXJcIjtcclxuICAgIGNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcclxuICAgIGNvbnRhaW5lci5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcclxuICAgIGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gXCItMTAwMDBweFwiO1xyXG4gICAgY29udGFpbmVyLnN0eWxlLnRvcCA9IFwiMHB4XCI7XHJcbiAgICBjb250YWluZXIuc3R5bGUuYm9yZGVyID0gXCIwXCI7XHJcbiAgICBjb250YWluZXIud2lkdGggPSB3aWR0aDtcclxuICAgIGNvbnRhaW5lci5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICBjb250YWluZXIuc2Nyb2xsaW5nID0gXCJub1wiOyAvLyBpb3Mgd29uJ3Qgc2Nyb2xsIHdpdGhvdXQgaXRcclxuICAgIGNvbnRhaW5lckRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xyXG4gICAgICAgIHZhciBkb2N1bWVudENsb25lID0gY29udGFpbmVyLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XHJcblxyXG4gICAgICAgIC8qIENocm9tZSBkb2Vzbid0IGRldGVjdCByZWxhdGl2ZSBiYWNrZ3JvdW5kLWltYWdlcyBhc3NpZ25lZCBpbiBpbmxpbmUgPHN0eWxlPiBzaGVldHMgd2hlbiBmZXRjaGVkIHRocm91Z2ggZ2V0Q29tcHV0ZWRTdHlsZVxyXG4gICAgICAgICBpZiB3aW5kb3cgdXJsIGlzIGFib3V0OmJsYW5rLCB3ZSBjYW4gYXNzaWduIHRoZSB1cmwgdG8gY3VycmVudCBieSB3cml0aW5nIG9udG8gdGhlIGRvY3VtZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29udGFpbmVyLmNvbnRlbnRXaW5kb3cub25sb2FkID0gY29udGFpbmVyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkb2N1bWVudENsb25lLmJvZHkuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdE5vZGUoZG9jdW1lbnRDbG9uZS5kb2N1bWVudEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnR5cGUgPT09IFwidmlld1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jb250ZW50V2luZG93LnNjcm9sbFRvKHgsIHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKC8oaVBhZHxpUGhvbmV8aVBvZCkvZykudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJiAoY29udGFpbmVyLmNvbnRlbnRXaW5kb3cuc2Nyb2xsWSAhPT0geSB8fCBjb250YWluZXIuY29udGVudFdpbmRvdy5zY3JvbGxYICE9PSB4KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRDbG9uZS5kb2N1bWVudEVsZW1lbnQuc3R5bGUudG9wID0gKC15KSArIFwicHhcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50Q2xvbmUuZG9jdW1lbnRFbGVtZW50LnN0eWxlLmxlZnQgPSAoLXgpICsgXCJweFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRDbG9uZS5kb2N1bWVudEVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgNTApO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGRvY3VtZW50Q2xvbmUub3BlbigpO1xyXG4gICAgICAgIGRvY3VtZW50Q2xvbmUud3JpdGUoXCI8IURPQ1RZUEUgaHRtbD48aHRtbD48L2h0bWw+XCIpO1xyXG4gICAgICAgIC8vIENocm9tZSBzY3JvbGxzIHRoZSBwYXJlbnQgZG9jdW1lbnQgZm9yIHNvbWUgcmVhc29uIGFmdGVyIHRoZSB3cml0ZSB0byB0aGUgY2xvbmVkIHdpbmRvdz8/P1xyXG4gICAgICAgIHJlc3RvcmVPd25lclNjcm9sbChvd25lckRvY3VtZW50LCB4LCB5KTtcclxuICAgICAgICBkb2N1bWVudENsb25lLnJlcGxhY2VDaGlsZChkb2N1bWVudENsb25lLmFkb3B0Tm9kZShkb2N1bWVudEVsZW1lbnQpLCBkb2N1bWVudENsb25lLmRvY3VtZW50RWxlbWVudCk7XHJcbiAgICAgICAgZG9jdW1lbnRDbG9uZS5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG59LHtcIi4vbG9nXCI6MTN9XSwzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxuLy8gaHR0cDovL2Rldi53My5vcmcvY3Nzd2cvY3NzLWNvbG9yL1xyXG5cclxuZnVuY3Rpb24gQ29sb3IodmFsdWUpIHtcclxuICAgIHRoaXMuciA9IDA7XHJcbiAgICB0aGlzLmcgPSAwO1xyXG4gICAgdGhpcy5iID0gMDtcclxuICAgIHRoaXMuYSA9IG51bGw7XHJcbiAgICB2YXIgcmVzdWx0ID0gdGhpcy5mcm9tQXJyYXkodmFsdWUpIHx8XHJcbiAgICAgICAgdGhpcy5uYW1lZENvbG9yKHZhbHVlKSB8fFxyXG4gICAgICAgIHRoaXMucmdiKHZhbHVlKSB8fFxyXG4gICAgICAgIHRoaXMucmdiYSh2YWx1ZSkgfHxcclxuICAgICAgICB0aGlzLmhleDYodmFsdWUpIHx8XHJcbiAgICAgICAgdGhpcy5oZXgzKHZhbHVlKTtcclxufVxyXG5cclxuQ29sb3IucHJvdG90eXBlLmRhcmtlbiA9IGZ1bmN0aW9uKGFtb3VudCkge1xyXG4gICAgdmFyIGEgPSAxIC0gYW1vdW50O1xyXG4gICAgcmV0dXJuICBuZXcgQ29sb3IoW1xyXG4gICAgICAgIE1hdGgucm91bmQodGhpcy5yICogYSksXHJcbiAgICAgICAgTWF0aC5yb3VuZCh0aGlzLmcgKiBhKSxcclxuICAgICAgICBNYXRoLnJvdW5kKHRoaXMuYiAqIGEpLFxyXG4gICAgICAgIHRoaXMuYVxyXG4gICAgXSk7XHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUuaXNUcmFuc3BhcmVudCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYSA9PT0gMDtcclxufTtcclxuXHJcbkNvbG9yLnByb3RvdHlwZS5pc0JsYWNrID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yID09PSAwICYmIHRoaXMuZyA9PT0gMCAmJiB0aGlzLmIgPT09IDA7XHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUuZnJvbUFycmF5ID0gZnVuY3Rpb24oYXJyYXkpIHtcclxuICAgIGlmIChBcnJheS5pc0FycmF5KGFycmF5KSkge1xyXG4gICAgICAgIHRoaXMuciA9IE1hdGgubWluKGFycmF5WzBdLCAyNTUpO1xyXG4gICAgICAgIHRoaXMuZyA9IE1hdGgubWluKGFycmF5WzFdLCAyNTUpO1xyXG4gICAgICAgIHRoaXMuYiA9IE1hdGgubWluKGFycmF5WzJdLCAyNTUpO1xyXG4gICAgICAgIGlmIChhcnJheS5sZW5ndGggPiAzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYSA9IGFycmF5WzNdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKEFycmF5LmlzQXJyYXkoYXJyYXkpKTtcclxufTtcclxuXHJcbnZhciBfaGV4MyA9IC9eIyhbYS1mMC05XXszfSkkL2k7XHJcblxyXG5Db2xvci5wcm90b3R5cGUuaGV4MyA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICB2YXIgbWF0Y2ggPSBudWxsO1xyXG4gICAgaWYgKChtYXRjaCA9IHZhbHVlLm1hdGNoKF9oZXgzKSkgIT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLnIgPSBwYXJzZUludChtYXRjaFsxXVswXSArIG1hdGNoWzFdWzBdLCAxNik7XHJcbiAgICAgICAgdGhpcy5nID0gcGFyc2VJbnQobWF0Y2hbMV1bMV0gKyBtYXRjaFsxXVsxXSwgMTYpO1xyXG4gICAgICAgIHRoaXMuYiA9IHBhcnNlSW50KG1hdGNoWzFdWzJdICsgbWF0Y2hbMV1bMl0sIDE2KTtcclxuICAgIH1cclxuICAgIHJldHVybiBtYXRjaCAhPT0gbnVsbDtcclxufTtcclxuXHJcbnZhciBfaGV4NiA9IC9eIyhbYS1mMC05XXs2fSkkL2k7XHJcblxyXG5Db2xvci5wcm90b3R5cGUuaGV4NiA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICB2YXIgbWF0Y2ggPSBudWxsO1xyXG4gICAgaWYgKChtYXRjaCA9IHZhbHVlLm1hdGNoKF9oZXg2KSkgIT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLnIgPSBwYXJzZUludChtYXRjaFsxXS5zdWJzdHJpbmcoMCwgMiksIDE2KTtcclxuICAgICAgICB0aGlzLmcgPSBwYXJzZUludChtYXRjaFsxXS5zdWJzdHJpbmcoMiwgNCksIDE2KTtcclxuICAgICAgICB0aGlzLmIgPSBwYXJzZUludChtYXRjaFsxXS5zdWJzdHJpbmcoNCwgNiksIDE2KTtcclxuICAgIH1cclxuICAgIHJldHVybiBtYXRjaCAhPT0gbnVsbDtcclxufTtcclxuXHJcblxyXG52YXIgX3JnYiA9IC9ecmdiXFwoXFxzKihcXGR7MSwzfSlcXHMqLFxccyooXFxkezEsM30pXFxzKixcXHMqKFxcZHsxLDN9KVxccypcXCkkLztcclxuXHJcbkNvbG9yLnByb3RvdHlwZS5yZ2IgPSBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgdmFyIG1hdGNoID0gbnVsbDtcclxuICAgIGlmICgobWF0Y2ggPSB2YWx1ZS5tYXRjaChfcmdiKSkgIT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLnIgPSBOdW1iZXIobWF0Y2hbMV0pO1xyXG4gICAgICAgIHRoaXMuZyA9IE51bWJlcihtYXRjaFsyXSk7XHJcbiAgICAgICAgdGhpcy5iID0gTnVtYmVyKG1hdGNoWzNdKTtcclxuICAgIH1cclxuICAgIHJldHVybiBtYXRjaCAhPT0gbnVsbDtcclxufTtcclxuXHJcbnZhciBfcmdiYSA9IC9ecmdiYVxcKFxccyooXFxkezEsM30pXFxzKixcXHMqKFxcZHsxLDN9KVxccyosXFxzKihcXGR7MSwzfSlcXHMqLFxccyooXFxkP1xcLj9cXGQrKVxccypcXCkkLztcclxuXHJcbkNvbG9yLnByb3RvdHlwZS5yZ2JhID0gZnVuY3Rpb24odmFsdWUpIHtcclxuICAgIHZhciBtYXRjaCA9IG51bGw7XHJcbiAgICBpZiAoKG1hdGNoID0gdmFsdWUubWF0Y2goX3JnYmEpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuciA9IE51bWJlcihtYXRjaFsxXSk7XHJcbiAgICAgICAgdGhpcy5nID0gTnVtYmVyKG1hdGNoWzJdKTtcclxuICAgICAgICB0aGlzLmIgPSBOdW1iZXIobWF0Y2hbM10pO1xyXG4gICAgICAgIHRoaXMuYSA9IE51bWJlcihtYXRjaFs0XSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWF0Y2ggIT09IG51bGw7XHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLmEgIT09IG51bGwgJiYgdGhpcy5hICE9PSAxID9cclxuICAgIFwicmdiYShcIiArIFt0aGlzLnIsIHRoaXMuZywgdGhpcy5iLCB0aGlzLmFdLmpvaW4oXCIsXCIpICsgXCIpXCIgOlxyXG4gICAgXCJyZ2IoXCIgKyBbdGhpcy5yLCB0aGlzLmcsIHRoaXMuYl0uam9pbihcIixcIikgKyBcIilcIjtcclxufTtcclxuXHJcbkNvbG9yLnByb3RvdHlwZS5uYW1lZENvbG9yID0gZnVuY3Rpb24odmFsdWUpIHtcclxuICAgIHZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcclxuICAgIHZhciBjb2xvciA9IGNvbG9yc1t2YWx1ZV07XHJcbiAgICBpZiAoY29sb3IpIHtcclxuICAgICAgICB0aGlzLnIgPSBjb2xvclswXTtcclxuICAgICAgICB0aGlzLmcgPSBjb2xvclsxXTtcclxuICAgICAgICB0aGlzLmIgPSBjb2xvclsyXTtcclxuICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IFwidHJhbnNwYXJlbnRcIikge1xyXG4gICAgICAgIHRoaXMuciA9IHRoaXMuZyA9IHRoaXMuYiA9IHRoaXMuYSA9IDA7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuICEhY29sb3I7XHJcbn07XHJcblxyXG5Db2xvci5wcm90b3R5cGUuaXNDb2xvciA9IHRydWU7XHJcblxyXG4vLyBKU09OLnN0cmluZ2lmeShbXS5zbGljZS5jYWxsKCQkKCcubmFtZWQtY29sb3ItdGFibGUgdHInKSwgMSkubWFwKGZ1bmN0aW9uKHJvdykgeyByZXR1cm4gW3Jvdy5jaGlsZE5vZGVzWzNdLnRleHRDb250ZW50LCByb3cuY2hpbGROb2Rlc1s1XS50ZXh0Q29udGVudC50cmltKCkuc3BsaXQoXCIsXCIpLm1hcChOdW1iZXIpXSB9KS5yZWR1Y2UoZnVuY3Rpb24oZGF0YSwgcm93KSB7ZGF0YVtyb3dbMF1dID0gcm93WzFdOyByZXR1cm4gZGF0YX0sIHt9KSlcclxudmFyIGNvbG9ycyA9IHtcclxuICAgIFwiYWxpY2VibHVlXCI6IFsyNDAsIDI0OCwgMjU1XSxcclxuICAgIFwiYW50aXF1ZXdoaXRlXCI6IFsyNTAsIDIzNSwgMjE1XSxcclxuICAgIFwiYXF1YVwiOiBbMCwgMjU1LCAyNTVdLFxyXG4gICAgXCJhcXVhbWFyaW5lXCI6IFsxMjcsIDI1NSwgMjEyXSxcclxuICAgIFwiYXp1cmVcIjogWzI0MCwgMjU1LCAyNTVdLFxyXG4gICAgXCJiZWlnZVwiOiBbMjQ1LCAyNDUsIDIyMF0sXHJcbiAgICBcImJpc3F1ZVwiOiBbMjU1LCAyMjgsIDE5Nl0sXHJcbiAgICBcImJsYWNrXCI6IFswLCAwLCAwXSxcclxuICAgIFwiYmxhbmNoZWRhbG1vbmRcIjogWzI1NSwgMjM1LCAyMDVdLFxyXG4gICAgXCJibHVlXCI6IFswLCAwLCAyNTVdLFxyXG4gICAgXCJibHVldmlvbGV0XCI6IFsxMzgsIDQzLCAyMjZdLFxyXG4gICAgXCJicm93blwiOiBbMTY1LCA0MiwgNDJdLFxyXG4gICAgXCJidXJseXdvb2RcIjogWzIyMiwgMTg0LCAxMzVdLFxyXG4gICAgXCJjYWRldGJsdWVcIjogWzk1LCAxNTgsIDE2MF0sXHJcbiAgICBcImNoYXJ0cmV1c2VcIjogWzEyNywgMjU1LCAwXSxcclxuICAgIFwiY2hvY29sYXRlXCI6IFsyMTAsIDEwNSwgMzBdLFxyXG4gICAgXCJjb3JhbFwiOiBbMjU1LCAxMjcsIDgwXSxcclxuICAgIFwiY29ybmZsb3dlcmJsdWVcIjogWzEwMCwgMTQ5LCAyMzddLFxyXG4gICAgXCJjb3Juc2lsa1wiOiBbMjU1LCAyNDgsIDIyMF0sXHJcbiAgICBcImNyaW1zb25cIjogWzIyMCwgMjAsIDYwXSxcclxuICAgIFwiY3lhblwiOiBbMCwgMjU1LCAyNTVdLFxyXG4gICAgXCJkYXJrYmx1ZVwiOiBbMCwgMCwgMTM5XSxcclxuICAgIFwiZGFya2N5YW5cIjogWzAsIDEzOSwgMTM5XSxcclxuICAgIFwiZGFya2dvbGRlbnJvZFwiOiBbMTg0LCAxMzQsIDExXSxcclxuICAgIFwiZGFya2dyYXlcIjogWzE2OSwgMTY5LCAxNjldLFxyXG4gICAgXCJkYXJrZ3JlZW5cIjogWzAsIDEwMCwgMF0sXHJcbiAgICBcImRhcmtncmV5XCI6IFsxNjksIDE2OSwgMTY5XSxcclxuICAgIFwiZGFya2toYWtpXCI6IFsxODksIDE4MywgMTA3XSxcclxuICAgIFwiZGFya21hZ2VudGFcIjogWzEzOSwgMCwgMTM5XSxcclxuICAgIFwiZGFya29saXZlZ3JlZW5cIjogWzg1LCAxMDcsIDQ3XSxcclxuICAgIFwiZGFya29yYW5nZVwiOiBbMjU1LCAxNDAsIDBdLFxyXG4gICAgXCJkYXJrb3JjaGlkXCI6IFsxNTMsIDUwLCAyMDRdLFxyXG4gICAgXCJkYXJrcmVkXCI6IFsxMzksIDAsIDBdLFxyXG4gICAgXCJkYXJrc2FsbW9uXCI6IFsyMzMsIDE1MCwgMTIyXSxcclxuICAgIFwiZGFya3NlYWdyZWVuXCI6IFsxNDMsIDE4OCwgMTQzXSxcclxuICAgIFwiZGFya3NsYXRlYmx1ZVwiOiBbNzIsIDYxLCAxMzldLFxyXG4gICAgXCJkYXJrc2xhdGVncmF5XCI6IFs0NywgNzksIDc5XSxcclxuICAgIFwiZGFya3NsYXRlZ3JleVwiOiBbNDcsIDc5LCA3OV0sXHJcbiAgICBcImRhcmt0dXJxdW9pc2VcIjogWzAsIDIwNiwgMjA5XSxcclxuICAgIFwiZGFya3Zpb2xldFwiOiBbMTQ4LCAwLCAyMTFdLFxyXG4gICAgXCJkZWVwcGlua1wiOiBbMjU1LCAyMCwgMTQ3XSxcclxuICAgIFwiZGVlcHNreWJsdWVcIjogWzAsIDE5MSwgMjU1XSxcclxuICAgIFwiZGltZ3JheVwiOiBbMTA1LCAxMDUsIDEwNV0sXHJcbiAgICBcImRpbWdyZXlcIjogWzEwNSwgMTA1LCAxMDVdLFxyXG4gICAgXCJkb2RnZXJibHVlXCI6IFszMCwgMTQ0LCAyNTVdLFxyXG4gICAgXCJmaXJlYnJpY2tcIjogWzE3OCwgMzQsIDM0XSxcclxuICAgIFwiZmxvcmFsd2hpdGVcIjogWzI1NSwgMjUwLCAyNDBdLFxyXG4gICAgXCJmb3Jlc3RncmVlblwiOiBbMzQsIDEzOSwgMzRdLFxyXG4gICAgXCJmdWNoc2lhXCI6IFsyNTUsIDAsIDI1NV0sXHJcbiAgICBcImdhaW5zYm9yb1wiOiBbMjIwLCAyMjAsIDIyMF0sXHJcbiAgICBcImdob3N0d2hpdGVcIjogWzI0OCwgMjQ4LCAyNTVdLFxyXG4gICAgXCJnb2xkXCI6IFsyNTUsIDIxNSwgMF0sXHJcbiAgICBcImdvbGRlbnJvZFwiOiBbMjE4LCAxNjUsIDMyXSxcclxuICAgIFwiZ3JheVwiOiBbMTI4LCAxMjgsIDEyOF0sXHJcbiAgICBcImdyZWVuXCI6IFswLCAxMjgsIDBdLFxyXG4gICAgXCJncmVlbnllbGxvd1wiOiBbMTczLCAyNTUsIDQ3XSxcclxuICAgIFwiZ3JleVwiOiBbMTI4LCAxMjgsIDEyOF0sXHJcbiAgICBcImhvbmV5ZGV3XCI6IFsyNDAsIDI1NSwgMjQwXSxcclxuICAgIFwiaG90cGlua1wiOiBbMjU1LCAxMDUsIDE4MF0sXHJcbiAgICBcImluZGlhbnJlZFwiOiBbMjA1LCA5MiwgOTJdLFxyXG4gICAgXCJpbmRpZ29cIjogWzc1LCAwLCAxMzBdLFxyXG4gICAgXCJpdm9yeVwiOiBbMjU1LCAyNTUsIDI0MF0sXHJcbiAgICBcImtoYWtpXCI6IFsyNDAsIDIzMCwgMTQwXSxcclxuICAgIFwibGF2ZW5kZXJcIjogWzIzMCwgMjMwLCAyNTBdLFxyXG4gICAgXCJsYXZlbmRlcmJsdXNoXCI6IFsyNTUsIDI0MCwgMjQ1XSxcclxuICAgIFwibGF3bmdyZWVuXCI6IFsxMjQsIDI1MiwgMF0sXHJcbiAgICBcImxlbW9uY2hpZmZvblwiOiBbMjU1LCAyNTAsIDIwNV0sXHJcbiAgICBcImxpZ2h0Ymx1ZVwiOiBbMTczLCAyMTYsIDIzMF0sXHJcbiAgICBcImxpZ2h0Y29yYWxcIjogWzI0MCwgMTI4LCAxMjhdLFxyXG4gICAgXCJsaWdodGN5YW5cIjogWzIyNCwgMjU1LCAyNTVdLFxyXG4gICAgXCJsaWdodGdvbGRlbnJvZHllbGxvd1wiOiBbMjUwLCAyNTAsIDIxMF0sXHJcbiAgICBcImxpZ2h0Z3JheVwiOiBbMjExLCAyMTEsIDIxMV0sXHJcbiAgICBcImxpZ2h0Z3JlZW5cIjogWzE0NCwgMjM4LCAxNDRdLFxyXG4gICAgXCJsaWdodGdyZXlcIjogWzIxMSwgMjExLCAyMTFdLFxyXG4gICAgXCJsaWdodHBpbmtcIjogWzI1NSwgMTgyLCAxOTNdLFxyXG4gICAgXCJsaWdodHNhbG1vblwiOiBbMjU1LCAxNjAsIDEyMl0sXHJcbiAgICBcImxpZ2h0c2VhZ3JlZW5cIjogWzMyLCAxNzgsIDE3MF0sXHJcbiAgICBcImxpZ2h0c2t5Ymx1ZVwiOiBbMTM1LCAyMDYsIDI1MF0sXHJcbiAgICBcImxpZ2h0c2xhdGVncmF5XCI6IFsxMTksIDEzNiwgMTUzXSxcclxuICAgIFwibGlnaHRzbGF0ZWdyZXlcIjogWzExOSwgMTM2LCAxNTNdLFxyXG4gICAgXCJsaWdodHN0ZWVsYmx1ZVwiOiBbMTc2LCAxOTYsIDIyMl0sXHJcbiAgICBcImxpZ2h0eWVsbG93XCI6IFsyNTUsIDI1NSwgMjI0XSxcclxuICAgIFwibGltZVwiOiBbMCwgMjU1LCAwXSxcclxuICAgIFwibGltZWdyZWVuXCI6IFs1MCwgMjA1LCA1MF0sXHJcbiAgICBcImxpbmVuXCI6IFsyNTAsIDI0MCwgMjMwXSxcclxuICAgIFwibWFnZW50YVwiOiBbMjU1LCAwLCAyNTVdLFxyXG4gICAgXCJtYXJvb25cIjogWzEyOCwgMCwgMF0sXHJcbiAgICBcIm1lZGl1bWFxdWFtYXJpbmVcIjogWzEwMiwgMjA1LCAxNzBdLFxyXG4gICAgXCJtZWRpdW1ibHVlXCI6IFswLCAwLCAyMDVdLFxyXG4gICAgXCJtZWRpdW1vcmNoaWRcIjogWzE4NiwgODUsIDIxMV0sXHJcbiAgICBcIm1lZGl1bXB1cnBsZVwiOiBbMTQ3LCAxMTIsIDIxOV0sXHJcbiAgICBcIm1lZGl1bXNlYWdyZWVuXCI6IFs2MCwgMTc5LCAxMTNdLFxyXG4gICAgXCJtZWRpdW1zbGF0ZWJsdWVcIjogWzEyMywgMTA0LCAyMzhdLFxyXG4gICAgXCJtZWRpdW1zcHJpbmdncmVlblwiOiBbMCwgMjUwLCAxNTRdLFxyXG4gICAgXCJtZWRpdW10dXJxdW9pc2VcIjogWzcyLCAyMDksIDIwNF0sXHJcbiAgICBcIm1lZGl1bXZpb2xldHJlZFwiOiBbMTk5LCAyMSwgMTMzXSxcclxuICAgIFwibWlkbmlnaHRibHVlXCI6IFsyNSwgMjUsIDExMl0sXHJcbiAgICBcIm1pbnRjcmVhbVwiOiBbMjQ1LCAyNTUsIDI1MF0sXHJcbiAgICBcIm1pc3R5cm9zZVwiOiBbMjU1LCAyMjgsIDIyNV0sXHJcbiAgICBcIm1vY2Nhc2luXCI6IFsyNTUsIDIyOCwgMTgxXSxcclxuICAgIFwibmF2YWpvd2hpdGVcIjogWzI1NSwgMjIyLCAxNzNdLFxyXG4gICAgXCJuYXZ5XCI6IFswLCAwLCAxMjhdLFxyXG4gICAgXCJvbGRsYWNlXCI6IFsyNTMsIDI0NSwgMjMwXSxcclxuICAgIFwib2xpdmVcIjogWzEyOCwgMTI4LCAwXSxcclxuICAgIFwib2xpdmVkcmFiXCI6IFsxMDcsIDE0MiwgMzVdLFxyXG4gICAgXCJvcmFuZ2VcIjogWzI1NSwgMTY1LCAwXSxcclxuICAgIFwib3JhbmdlcmVkXCI6IFsyNTUsIDY5LCAwXSxcclxuICAgIFwib3JjaGlkXCI6IFsyMTgsIDExMiwgMjE0XSxcclxuICAgIFwicGFsZWdvbGRlbnJvZFwiOiBbMjM4LCAyMzIsIDE3MF0sXHJcbiAgICBcInBhbGVncmVlblwiOiBbMTUyLCAyNTEsIDE1Ml0sXHJcbiAgICBcInBhbGV0dXJxdW9pc2VcIjogWzE3NSwgMjM4LCAyMzhdLFxyXG4gICAgXCJwYWxldmlvbGV0cmVkXCI6IFsyMTksIDExMiwgMTQ3XSxcclxuICAgIFwicGFwYXlhd2hpcFwiOiBbMjU1LCAyMzksIDIxM10sXHJcbiAgICBcInBlYWNocHVmZlwiOiBbMjU1LCAyMTgsIDE4NV0sXHJcbiAgICBcInBlcnVcIjogWzIwNSwgMTMzLCA2M10sXHJcbiAgICBcInBpbmtcIjogWzI1NSwgMTkyLCAyMDNdLFxyXG4gICAgXCJwbHVtXCI6IFsyMjEsIDE2MCwgMjIxXSxcclxuICAgIFwicG93ZGVyYmx1ZVwiOiBbMTc2LCAyMjQsIDIzMF0sXHJcbiAgICBcInB1cnBsZVwiOiBbMTI4LCAwLCAxMjhdLFxyXG4gICAgXCJyZWJlY2NhcHVycGxlXCI6IFsxMDIsIDUxLCAxNTNdLFxyXG4gICAgXCJyZWRcIjogWzI1NSwgMCwgMF0sXHJcbiAgICBcInJvc3licm93blwiOiBbMTg4LCAxNDMsIDE0M10sXHJcbiAgICBcInJveWFsYmx1ZVwiOiBbNjUsIDEwNSwgMjI1XSxcclxuICAgIFwic2FkZGxlYnJvd25cIjogWzEzOSwgNjksIDE5XSxcclxuICAgIFwic2FsbW9uXCI6IFsyNTAsIDEyOCwgMTE0XSxcclxuICAgIFwic2FuZHlicm93blwiOiBbMjQ0LCAxNjQsIDk2XSxcclxuICAgIFwic2VhZ3JlZW5cIjogWzQ2LCAxMzksIDg3XSxcclxuICAgIFwic2Vhc2hlbGxcIjogWzI1NSwgMjQ1LCAyMzhdLFxyXG4gICAgXCJzaWVubmFcIjogWzE2MCwgODIsIDQ1XSxcclxuICAgIFwic2lsdmVyXCI6IFsxOTIsIDE5MiwgMTkyXSxcclxuICAgIFwic2t5Ymx1ZVwiOiBbMTM1LCAyMDYsIDIzNV0sXHJcbiAgICBcInNsYXRlYmx1ZVwiOiBbMTA2LCA5MCwgMjA1XSxcclxuICAgIFwic2xhdGVncmF5XCI6IFsxMTIsIDEyOCwgMTQ0XSxcclxuICAgIFwic2xhdGVncmV5XCI6IFsxMTIsIDEyOCwgMTQ0XSxcclxuICAgIFwic25vd1wiOiBbMjU1LCAyNTAsIDI1MF0sXHJcbiAgICBcInNwcmluZ2dyZWVuXCI6IFswLCAyNTUsIDEyN10sXHJcbiAgICBcInN0ZWVsYmx1ZVwiOiBbNzAsIDEzMCwgMTgwXSxcclxuICAgIFwidGFuXCI6IFsyMTAsIDE4MCwgMTQwXSxcclxuICAgIFwidGVhbFwiOiBbMCwgMTI4LCAxMjhdLFxyXG4gICAgXCJ0aGlzdGxlXCI6IFsyMTYsIDE5MSwgMjE2XSxcclxuICAgIFwidG9tYXRvXCI6IFsyNTUsIDk5LCA3MV0sXHJcbiAgICBcInR1cnF1b2lzZVwiOiBbNjQsIDIyNCwgMjA4XSxcclxuICAgIFwidmlvbGV0XCI6IFsyMzgsIDEzMCwgMjM4XSxcclxuICAgIFwid2hlYXRcIjogWzI0NSwgMjIyLCAxNzldLFxyXG4gICAgXCJ3aGl0ZVwiOiBbMjU1LCAyNTUsIDI1NV0sXHJcbiAgICBcIndoaXRlc21va2VcIjogWzI0NSwgMjQ1LCAyNDVdLFxyXG4gICAgXCJ5ZWxsb3dcIjogWzI1NSwgMjU1LCAwXSxcclxuICAgIFwieWVsbG93Z3JlZW5cIjogWzE1NCwgMjA1LCA1MF1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQ29sb3I7XHJcblxyXG59LHt9XSw0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxudmFyIFN1cHBvcnQgPSBfZGVyZXFfKCcuL3N1cHBvcnQnKTtcclxudmFyIENhbnZhc1JlbmRlcmVyID0gX2RlcmVxXygnLi9yZW5kZXJlcnMvY2FudmFzJyk7XHJcbnZhciBJbWFnZUxvYWRlciA9IF9kZXJlcV8oJy4vaW1hZ2Vsb2FkZXInKTtcclxudmFyIE5vZGVQYXJzZXIgPSBfZGVyZXFfKCcuL25vZGVwYXJzZXInKTtcclxudmFyIE5vZGVDb250YWluZXIgPSBfZGVyZXFfKCcuL25vZGVjb250YWluZXInKTtcclxudmFyIGxvZyA9IF9kZXJlcV8oJy4vbG9nJyk7XHJcbnZhciB1dGlscyA9IF9kZXJlcV8oJy4vdXRpbHMnKTtcclxudmFyIGNyZWF0ZVdpbmRvd0Nsb25lID0gX2RlcmVxXygnLi9jbG9uZScpO1xyXG52YXIgbG9hZFVybERvY3VtZW50ID0gX2RlcmVxXygnLi9wcm94eScpLmxvYWRVcmxEb2N1bWVudDtcclxudmFyIGdldEJvdW5kcyA9IHV0aWxzLmdldEJvdW5kcztcclxuXHJcbnZhciBodG1sMmNhbnZhc05vZGVBdHRyaWJ1dGUgPSBcImRhdGEtaHRtbDJjYW52YXMtbm9kZVwiO1xyXG52YXIgaHRtbDJjYW52YXNDbG9uZUluZGV4ID0gMDtcclxuXHJcbmZ1bmN0aW9uIGh0bWwyY2FudmFzKG5vZGVMaXN0LCBvcHRpb25zKSB7XHJcbiAgICB2YXIgaW5kZXggPSBodG1sMmNhbnZhc0Nsb25lSW5kZXgrKztcclxuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgaWYgKG9wdGlvbnMubG9nZ2luZykge1xyXG4gICAgICAgIGxvZy5vcHRpb25zLmxvZ2dpbmcgPSB0cnVlO1xyXG4gICAgICAgIGxvZy5vcHRpb25zLnN0YXJ0ID0gRGF0ZS5ub3coKTtcclxuICAgIH1cclxuXHJcbiAgICBvcHRpb25zLmFzeW5jID0gdHlwZW9mKG9wdGlvbnMuYXN5bmMpID09PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IG9wdGlvbnMuYXN5bmM7XHJcbiAgICBvcHRpb25zLmFsbG93VGFpbnQgPSB0eXBlb2Yob3B0aW9ucy5hbGxvd1RhaW50KSA9PT0gXCJ1bmRlZmluZWRcIiA/IGZhbHNlIDogb3B0aW9ucy5hbGxvd1RhaW50O1xyXG4gICAgb3B0aW9ucy5yZW1vdmVDb250YWluZXIgPSB0eXBlb2Yob3B0aW9ucy5yZW1vdmVDb250YWluZXIpID09PSBcInVuZGVmaW5lZFwiID8gdHJ1ZSA6IG9wdGlvbnMucmVtb3ZlQ29udGFpbmVyO1xyXG4gICAgb3B0aW9ucy5qYXZhc2NyaXB0RW5hYmxlZCA9IHR5cGVvZihvcHRpb25zLmphdmFzY3JpcHRFbmFibGVkKSA9PT0gXCJ1bmRlZmluZWRcIiA/IGZhbHNlIDogb3B0aW9ucy5qYXZhc2NyaXB0RW5hYmxlZDtcclxuICAgIG9wdGlvbnMuaW1hZ2VUaW1lb3V0ID0gdHlwZW9mKG9wdGlvbnMuaW1hZ2VUaW1lb3V0KSA9PT0gXCJ1bmRlZmluZWRcIiA/IDEwMDAwIDogb3B0aW9ucy5pbWFnZVRpbWVvdXQ7XHJcbiAgICBvcHRpb25zLnJlbmRlcmVyID0gdHlwZW9mKG9wdGlvbnMucmVuZGVyZXIpID09PSBcImZ1bmN0aW9uXCIgPyBvcHRpb25zLnJlbmRlcmVyIDogQ2FudmFzUmVuZGVyZXI7XHJcbiAgICBvcHRpb25zLnN0cmljdCA9ICEhb3B0aW9ucy5zdHJpY3Q7XHJcblxyXG4gICAgaWYgKHR5cGVvZihub2RlTGlzdCkgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICBpZiAodHlwZW9mKG9wdGlvbnMucHJveHkpICE9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcIlByb3h5IG11c3QgYmUgdXNlZCB3aGVuIHJlbmRlcmluZyB1cmxcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB3aWR0aCA9IG9wdGlvbnMud2lkdGggIT0gbnVsbCA/IG9wdGlvbnMud2lkdGggOiB3aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQgIT0gbnVsbCA/IG9wdGlvbnMuaGVpZ2h0IDogd2luZG93LmlubmVySGVpZ2h0O1xyXG4gICAgICAgIHJldHVybiBsb2FkVXJsRG9jdW1lbnQoYWJzb2x1dGVVcmwobm9kZUxpc3QpLCBvcHRpb25zLnByb3h5LCBkb2N1bWVudCwgd2lkdGgsIGhlaWdodCwgb3B0aW9ucykudGhlbihmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcldpbmRvdyhjb250YWluZXIuY29udGVudFdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIGNvbnRhaW5lciwgb3B0aW9ucywgd2lkdGgsIGhlaWdodCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIG5vZGUgPSAoKG5vZGVMaXN0ID09PSB1bmRlZmluZWQpID8gW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudF0gOiAoKG5vZGVMaXN0Lmxlbmd0aCkgPyBub2RlTGlzdCA6IFtub2RlTGlzdF0pKVswXTtcclxuICAgIG5vZGUuc2V0QXR0cmlidXRlKGh0bWwyY2FudmFzTm9kZUF0dHJpYnV0ZSArIGluZGV4LCBpbmRleCk7XHJcbiAgICByZXR1cm4gcmVuZGVyRG9jdW1lbnQobm9kZS5vd25lckRvY3VtZW50LCBvcHRpb25zLCBub2RlLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcuaW5uZXJXaWR0aCwgbm9kZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmlubmVySGVpZ2h0LCBpbmRleCkudGhlbihmdW5jdGlvbihjYW52YXMpIHtcclxuICAgICAgICBpZiAodHlwZW9mKG9wdGlvbnMub25yZW5kZXJlZCkgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICBsb2coXCJvcHRpb25zLm9ucmVuZGVyZWQgaXMgZGVwcmVjYXRlZCwgaHRtbDJjYW52YXMgcmV0dXJucyBhIFByb21pc2UgY29udGFpbmluZyB0aGUgY2FudmFzXCIpO1xyXG4gICAgICAgICAgICBvcHRpb25zLm9ucmVuZGVyZWQoY2FudmFzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhbnZhcztcclxuICAgIH0pO1xyXG59XHJcblxyXG5odG1sMmNhbnZhcy5DYW52YXNSZW5kZXJlciA9IENhbnZhc1JlbmRlcmVyO1xyXG5odG1sMmNhbnZhcy5Ob2RlQ29udGFpbmVyID0gTm9kZUNvbnRhaW5lcjtcclxuaHRtbDJjYW52YXMubG9nID0gbG9nO1xyXG5odG1sMmNhbnZhcy51dGlscyA9IHV0aWxzO1xyXG5cclxudmFyIGh0bWwyY2FudmFzRXhwb3J0ID0gKHR5cGVvZihkb2N1bWVudCkgPT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mKE9iamVjdC5jcmVhdGUpICE9PSBcImZ1bmN0aW9uXCIgfHwgdHlwZW9mKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikuZ2V0Q29udGV4dCkgIT09IFwiZnVuY3Rpb25cIikgPyBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcIk5vIGNhbnZhcyBzdXBwb3J0XCIpO1xyXG59IDogaHRtbDJjYW52YXM7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGh0bWwyY2FudmFzRXhwb3J0O1xyXG5cclxuaWYgKHR5cGVvZihkZWZpbmUpID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcclxuICAgIGRlZmluZSgnaHRtbDJjYW52YXMnLCBbXSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGh0bWwyY2FudmFzRXhwb3J0O1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckRvY3VtZW50KGRvY3VtZW50LCBvcHRpb25zLCB3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0LCBodG1sMmNhbnZhc0luZGV4KSB7XHJcbiAgICByZXR1cm4gY3JlYXRlV2luZG93Q2xvbmUoZG9jdW1lbnQsIGRvY3VtZW50LCB3aW5kb3dXaWR0aCwgd2luZG93SGVpZ2h0LCBvcHRpb25zLCBkb2N1bWVudC5kZWZhdWx0Vmlldy5wYWdlWE9mZnNldCwgZG9jdW1lbnQuZGVmYXVsdFZpZXcucGFnZVlPZmZzZXQpLnRoZW4oZnVuY3Rpb24oY29udGFpbmVyKSB7XHJcbiAgICAgICAgbG9nKFwiRG9jdW1lbnQgY2xvbmVkXCIpO1xyXG4gICAgICAgIHZhciBhdHRyaWJ1dGVOYW1lID0gaHRtbDJjYW52YXNOb2RlQXR0cmlidXRlICsgaHRtbDJjYW52YXNJbmRleDtcclxuICAgICAgICB2YXIgc2VsZWN0b3IgPSBcIltcIiArIGF0dHJpYnV0ZU5hbWUgKyBcIj0nXCIgKyBodG1sMmNhbnZhc0luZGV4ICsgXCInXVwiO1xyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpLnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGVOYW1lKTtcclxuICAgICAgICB2YXIgY2xvbmVkV2luZG93ID0gY29udGFpbmVyLmNvbnRlbnRXaW5kb3c7XHJcbiAgICAgICAgdmFyIG5vZGUgPSBjbG9uZWRXaW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgICAgICAgdmFyIG9uY2xvbmVIYW5kbGVyID0gKHR5cGVvZihvcHRpb25zLm9uY2xvbmUpID09PSBcImZ1bmN0aW9uXCIpID8gUHJvbWlzZS5yZXNvbHZlKG9wdGlvbnMub25jbG9uZShjbG9uZWRXaW5kb3cuZG9jdW1lbnQpKSA6IFByb21pc2UucmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gb25jbG9uZUhhbmRsZXIudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcldpbmRvdyhub2RlLCBjb250YWluZXIsIG9wdGlvbnMsIHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlcldpbmRvdyhub2RlLCBjb250YWluZXIsIG9wdGlvbnMsIHdpbmRvd1dpZHRoLCB3aW5kb3dIZWlnaHQpIHtcclxuICAgIHZhciBjbG9uZWRXaW5kb3cgPSBjb250YWluZXIuY29udGVudFdpbmRvdztcclxuICAgIHZhciBzdXBwb3J0ID0gbmV3IFN1cHBvcnQoY2xvbmVkV2luZG93LmRvY3VtZW50KTtcclxuICAgIHZhciBpbWFnZUxvYWRlciA9IG5ldyBJbWFnZUxvYWRlcihvcHRpb25zLCBzdXBwb3J0KTtcclxuICAgIHZhciBib3VuZHMgPSBnZXRCb3VuZHMobm9kZSk7XHJcbiAgICB2YXIgd2lkdGggPSBvcHRpb25zLnR5cGUgPT09IFwidmlld1wiID8gd2luZG93V2lkdGggOiBkb2N1bWVudFdpZHRoKGNsb25lZFdpbmRvdy5kb2N1bWVudCk7XHJcbiAgICB2YXIgaGVpZ2h0ID0gb3B0aW9ucy50eXBlID09PSBcInZpZXdcIiA/IHdpbmRvd0hlaWdodCA6IGRvY3VtZW50SGVpZ2h0KGNsb25lZFdpbmRvdy5kb2N1bWVudCk7XHJcbiAgICB2YXIgcmVuZGVyZXIgPSBuZXcgb3B0aW9ucy5yZW5kZXJlcih3aWR0aCwgaGVpZ2h0LCBpbWFnZUxvYWRlciwgb3B0aW9ucywgZG9jdW1lbnQpO1xyXG4gICAgdmFyIHBhcnNlciA9IG5ldyBOb2RlUGFyc2VyKG5vZGUsIHJlbmRlcmVyLCBzdXBwb3J0LCBpbWFnZUxvYWRlciwgb3B0aW9ucyk7XHJcbiAgICByZXR1cm4gcGFyc2VyLnJlYWR5LnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbG9nKFwiRmluaXNoZWQgcmVuZGVyaW5nXCIpO1xyXG4gICAgICAgIHZhciBjYW52YXM7XHJcblxyXG4gICAgICAgIGlmIChvcHRpb25zLnR5cGUgPT09IFwidmlld1wiKSB7XHJcbiAgICAgICAgICAgIGNhbnZhcyA9IGNyb3AocmVuZGVyZXIuY2FudmFzLCB7d2lkdGg6IHJlbmRlcmVyLmNhbnZhcy53aWR0aCwgaGVpZ2h0OiByZW5kZXJlci5jYW52YXMuaGVpZ2h0LCB0b3A6IDAsIGxlZnQ6IDAsIHg6IDAsIHk6IDB9KTtcclxuICAgICAgICB9IGVsc2UgaWYgKG5vZGUgPT09IGNsb25lZFdpbmRvdy5kb2N1bWVudC5ib2R5IHx8IG5vZGUgPT09IGNsb25lZFdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgfHwgb3B0aW9ucy5jYW52YXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjYW52YXMgPSByZW5kZXJlci5jYW52YXM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2FudmFzID0gY3JvcChyZW5kZXJlci5jYW52YXMsIHt3aWR0aDogIG9wdGlvbnMud2lkdGggIT0gbnVsbCA/IG9wdGlvbnMud2lkdGggOiBib3VuZHMud2lkdGgsIGhlaWdodDogb3B0aW9ucy5oZWlnaHQgIT0gbnVsbCA/IG9wdGlvbnMuaGVpZ2h0IDogYm91bmRzLmhlaWdodCwgdG9wOiBib3VuZHMudG9wLCBsZWZ0OiBib3VuZHMubGVmdCwgeDogMCwgeTogMH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xlYW51cENvbnRhaW5lcihjb250YWluZXIsIG9wdGlvbnMpO1xyXG4gICAgICAgIHJldHVybiBjYW52YXM7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xlYW51cENvbnRhaW5lcihjb250YWluZXIsIG9wdGlvbnMpIHtcclxuICAgIGlmIChvcHRpb25zLnJlbW92ZUNvbnRhaW5lcikge1xyXG4gICAgICAgIGNvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7XHJcbiAgICAgICAgbG9nKFwiQ2xlYW5lZCB1cCBjb250YWluZXJcIik7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyb3AoY2FudmFzLCBib3VuZHMpIHtcclxuICAgIHZhciBjcm9wcGVkQ2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgIHZhciB4MSA9IE1hdGgubWluKGNhbnZhcy53aWR0aCAtIDEsIE1hdGgubWF4KDAsIGJvdW5kcy5sZWZ0KSk7XHJcbiAgICB2YXIgeDIgPSBNYXRoLm1pbihjYW52YXMud2lkdGgsIE1hdGgubWF4KDEsIGJvdW5kcy5sZWZ0ICsgYm91bmRzLndpZHRoKSk7XHJcbiAgICB2YXIgeTEgPSBNYXRoLm1pbihjYW52YXMuaGVpZ2h0IC0gMSwgTWF0aC5tYXgoMCwgYm91bmRzLnRvcCkpO1xyXG4gICAgdmFyIHkyID0gTWF0aC5taW4oY2FudmFzLmhlaWdodCwgTWF0aC5tYXgoMSwgYm91bmRzLnRvcCArIGJvdW5kcy5oZWlnaHQpKTtcclxuICAgIGNyb3BwZWRDYW52YXMud2lkdGggPSBib3VuZHMud2lkdGg7XHJcbiAgICBjcm9wcGVkQ2FudmFzLmhlaWdodCA9ICBib3VuZHMuaGVpZ2h0O1xyXG4gICAgdmFyIHdpZHRoID0geDIteDE7XHJcbiAgICB2YXIgaGVpZ2h0ID0geTIteTE7XHJcbiAgICBsb2coXCJDcm9wcGluZyBjYW52YXMgYXQ6XCIsIFwibGVmdDpcIiwgYm91bmRzLmxlZnQsIFwidG9wOlwiLCBib3VuZHMudG9wLCBcIndpZHRoOlwiLCB3aWR0aCwgXCJoZWlnaHQ6XCIsIGhlaWdodCk7XHJcbiAgICBsb2coXCJSZXN1bHRpbmcgY3JvcCB3aXRoIHdpZHRoXCIsIGJvdW5kcy53aWR0aCwgXCJhbmQgaGVpZ2h0XCIsIGJvdW5kcy5oZWlnaHQsIFwid2l0aCB4XCIsIHgxLCBcImFuZCB5XCIsIHkxKTtcclxuICAgIGNyb3BwZWRDYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpLmRyYXdJbWFnZShjYW52YXMsIHgxLCB5MSwgd2lkdGgsIGhlaWdodCwgYm91bmRzLngsIGJvdW5kcy55LCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgIHJldHVybiBjcm9wcGVkQ2FudmFzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkb2N1bWVudFdpZHRoIChkb2MpIHtcclxuICAgIHJldHVybiBNYXRoLm1heChcclxuICAgICAgICBNYXRoLm1heChkb2MuYm9keS5zY3JvbGxXaWR0aCwgZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxXaWR0aCksXHJcbiAgICAgICAgTWF0aC5tYXgoZG9jLmJvZHkub2Zmc2V0V2lkdGgsIGRvYy5kb2N1bWVudEVsZW1lbnQub2Zmc2V0V2lkdGgpLFxyXG4gICAgICAgIE1hdGgubWF4KGRvYy5ib2R5LmNsaWVudFdpZHRoLCBkb2MuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKVxyXG4gICAgKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZG9jdW1lbnRIZWlnaHQgKGRvYykge1xyXG4gICAgcmV0dXJuIE1hdGgubWF4KFxyXG4gICAgICAgIE1hdGgubWF4KGRvYy5ib2R5LnNjcm9sbEhlaWdodCwgZG9jLmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQpLFxyXG4gICAgICAgIE1hdGgubWF4KGRvYy5ib2R5Lm9mZnNldEhlaWdodCwgZG9jLmRvY3VtZW50RWxlbWVudC5vZmZzZXRIZWlnaHQpLFxyXG4gICAgICAgIE1hdGgubWF4KGRvYy5ib2R5LmNsaWVudEhlaWdodCwgZG9jLmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpXHJcbiAgICApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhYnNvbHV0ZVVybCh1cmwpIHtcclxuICAgIHZhciBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XHJcbiAgICBsaW5rLmhyZWYgPSB1cmw7XHJcbiAgICBsaW5rLmhyZWYgPSBsaW5rLmhyZWY7XHJcbiAgICByZXR1cm4gbGluaztcclxufVxyXG5cclxufSx7XCIuL2Nsb25lXCI6MixcIi4vaW1hZ2Vsb2FkZXJcIjoxMSxcIi4vbG9nXCI6MTMsXCIuL25vZGVjb250YWluZXJcIjoxNCxcIi4vbm9kZXBhcnNlclwiOjE1LFwiLi9wcm94eVwiOjE2LFwiLi9yZW5kZXJlcnMvY2FudmFzXCI6MjAsXCIuL3N1cHBvcnRcIjoyMixcIi4vdXRpbHNcIjoyNn1dLDU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xyXG52YXIgbG9nID0gX2RlcmVxXygnLi9sb2cnKTtcclxudmFyIHNtYWxsSW1hZ2UgPSBfZGVyZXFfKCcuL3V0aWxzJykuc21hbGxJbWFnZTtcclxuXHJcbmZ1bmN0aW9uIER1bW15SW1hZ2VDb250YWluZXIoc3JjKSB7XHJcbiAgICB0aGlzLnNyYyA9IHNyYztcclxuICAgIGxvZyhcIkR1bW15SW1hZ2VDb250YWluZXIgZm9yXCIsIHNyYyk7XHJcbiAgICBpZiAoIXRoaXMucHJvbWlzZSB8fCAhdGhpcy5pbWFnZSkge1xyXG4gICAgICAgIGxvZyhcIkluaXRpYXRpbmcgRHVtbXlJbWFnZUNvbnRhaW5lclwiKTtcclxuICAgICAgICBEdW1teUltYWdlQ29udGFpbmVyLnByb3RvdHlwZS5pbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7XHJcbiAgICAgICAgRHVtbXlJbWFnZUNvbnRhaW5lci5wcm90b3R5cGUucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBpbWFnZS5vbmxvYWQgPSByZXNvbHZlO1xyXG4gICAgICAgICAgICBpbWFnZS5vbmVycm9yID0gcmVqZWN0O1xyXG4gICAgICAgICAgICBpbWFnZS5zcmMgPSBzbWFsbEltYWdlKCk7XHJcbiAgICAgICAgICAgIGlmIChpbWFnZS5jb21wbGV0ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpbWFnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBEdW1teUltYWdlQ29udGFpbmVyO1xyXG5cclxufSx7XCIuL2xvZ1wiOjEzLFwiLi91dGlsc1wiOjI2fV0sNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBzbWFsbEltYWdlID0gX2RlcmVxXygnLi91dGlscycpLnNtYWxsSW1hZ2U7XHJcblxyXG5mdW5jdGlvbiBGb250KGZhbWlseSwgc2l6ZSkge1xyXG4gICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLFxyXG4gICAgICAgIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpLFxyXG4gICAgICAgIHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyksXHJcbiAgICAgICAgc2FtcGxlVGV4dCA9ICdIaWRkZW4gVGV4dCcsXHJcbiAgICAgICAgYmFzZWxpbmUsXHJcbiAgICAgICAgbWlkZGxlO1xyXG5cclxuICAgIGNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcclxuICAgIGNvbnRhaW5lci5zdHlsZS5mb250RmFtaWx5ID0gZmFtaWx5O1xyXG4gICAgY29udGFpbmVyLnN0eWxlLmZvbnRTaXplID0gc2l6ZTtcclxuICAgIGNvbnRhaW5lci5zdHlsZS5tYXJnaW4gPSAwO1xyXG4gICAgY29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAwO1xyXG5cclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcclxuXHJcbiAgICBpbWcuc3JjID0gc21hbGxJbWFnZSgpO1xyXG4gICAgaW1nLndpZHRoID0gMTtcclxuICAgIGltZy5oZWlnaHQgPSAxO1xyXG5cclxuICAgIGltZy5zdHlsZS5tYXJnaW4gPSAwO1xyXG4gICAgaW1nLnN0eWxlLnBhZGRpbmcgPSAwO1xyXG4gICAgaW1nLnN0eWxlLnZlcnRpY2FsQWxpZ24gPSBcImJhc2VsaW5lXCI7XHJcblxyXG4gICAgc3Bhbi5zdHlsZS5mb250RmFtaWx5ID0gZmFtaWx5O1xyXG4gICAgc3Bhbi5zdHlsZS5mb250U2l6ZSA9IHNpemU7XHJcbiAgICBzcGFuLnN0eWxlLm1hcmdpbiA9IDA7XHJcbiAgICBzcGFuLnN0eWxlLnBhZGRpbmcgPSAwO1xyXG5cclxuICAgIHNwYW4uYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoc2FtcGxlVGV4dCkpO1xyXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNwYW4pO1xyXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGltZyk7XHJcbiAgICBiYXNlbGluZSA9IChpbWcub2Zmc2V0VG9wIC0gc3Bhbi5vZmZzZXRUb3ApICsgMTtcclxuXHJcbiAgICBjb250YWluZXIucmVtb3ZlQ2hpbGQoc3Bhbik7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoc2FtcGxlVGV4dCkpO1xyXG5cclxuICAgIGNvbnRhaW5lci5zdHlsZS5saW5lSGVpZ2h0ID0gXCJub3JtYWxcIjtcclxuICAgIGltZy5zdHlsZS52ZXJ0aWNhbEFsaWduID0gXCJzdXBlclwiO1xyXG5cclxuICAgIG1pZGRsZSA9IChpbWcub2Zmc2V0VG9wLWNvbnRhaW5lci5vZmZzZXRUb3ApICsgMTtcclxuXHJcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGNvbnRhaW5lcik7XHJcblxyXG4gICAgdGhpcy5iYXNlbGluZSA9IGJhc2VsaW5lO1xyXG4gICAgdGhpcy5saW5lV2lkdGggPSAxO1xyXG4gICAgdGhpcy5taWRkbGUgPSBtaWRkbGU7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRm9udDtcclxuXHJcbn0se1wiLi91dGlsc1wiOjI2fV0sNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBGb250ID0gX2RlcmVxXygnLi9mb250Jyk7XHJcblxyXG5mdW5jdGlvbiBGb250TWV0cmljcygpIHtcclxuICAgIHRoaXMuZGF0YSA9IHt9O1xyXG59XHJcblxyXG5Gb250TWV0cmljcy5wcm90b3R5cGUuZ2V0TWV0cmljcyA9IGZ1bmN0aW9uKGZhbWlseSwgc2l6ZSkge1xyXG4gICAgaWYgKHRoaXMuZGF0YVtmYW1pbHkgKyBcIi1cIiArIHNpemVdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICB0aGlzLmRhdGFbZmFtaWx5ICsgXCItXCIgKyBzaXplXSA9IG5ldyBGb250KGZhbWlseSwgc2l6ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5kYXRhW2ZhbWlseSArIFwiLVwiICsgc2l6ZV07XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEZvbnRNZXRyaWNzO1xyXG5cclxufSx7XCIuL2ZvbnRcIjo2fV0sODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciB1dGlscyA9IF9kZXJlcV8oJy4vdXRpbHMnKTtcclxudmFyIGdldEJvdW5kcyA9IHV0aWxzLmdldEJvdW5kcztcclxudmFyIGxvYWRVcmxEb2N1bWVudCA9IF9kZXJlcV8oJy4vcHJveHknKS5sb2FkVXJsRG9jdW1lbnQ7XHJcblxyXG5mdW5jdGlvbiBGcmFtZUNvbnRhaW5lcihjb250YWluZXIsIHNhbWVPcmlnaW4sIG9wdGlvbnMpIHtcclxuICAgIHRoaXMuaW1hZ2UgPSBudWxsO1xyXG4gICAgdGhpcy5zcmMgPSBjb250YWluZXI7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgYm91bmRzID0gZ2V0Qm91bmRzKGNvbnRhaW5lcik7XHJcbiAgICB0aGlzLnByb21pc2UgPSAoIXNhbWVPcmlnaW4gPyB0aGlzLnByb3h5TG9hZChvcHRpb25zLnByb3h5LCBib3VuZHMsIG9wdGlvbnMpIDogbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xyXG4gICAgICAgIGlmIChjb250YWluZXIuY29udGVudFdpbmRvdy5kb2N1bWVudC5VUkwgPT09IFwiYWJvdXQ6YmxhbmtcIiB8fCBjb250YWluZXIuY29udGVudFdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb250YWluZXIuY29udGVudFdpbmRvdy5vbmxvYWQgPSBjb250YWluZXIub25sb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVzb2x2ZShjb250YWluZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH0pKS50aGVuKGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgICAgIHZhciBodG1sMmNhbnZhcyA9IF9kZXJlcV8oJy4vY29yZScpO1xyXG4gICAgICAgIHJldHVybiBodG1sMmNhbnZhcyhjb250YWluZXIuY29udGVudFdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHt0eXBlOiAndmlldycsIHdpZHRoOiBjb250YWluZXIud2lkdGgsIGhlaWdodDogY29udGFpbmVyLmhlaWdodCwgcHJveHk6IG9wdGlvbnMucHJveHksIGphdmFzY3JpcHRFbmFibGVkOiBvcHRpb25zLmphdmFzY3JpcHRFbmFibGVkLCByZW1vdmVDb250YWluZXI6IG9wdGlvbnMucmVtb3ZlQ29udGFpbmVyLCBhbGxvd1RhaW50OiBvcHRpb25zLmFsbG93VGFpbnQsIGltYWdlVGltZW91dDogb3B0aW9ucy5pbWFnZVRpbWVvdXQgLyAyfSk7XHJcbiAgICB9KS50aGVuKGZ1bmN0aW9uKGNhbnZhcykge1xyXG4gICAgICAgIHJldHVybiBzZWxmLmltYWdlID0gY2FudmFzO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbkZyYW1lQ29udGFpbmVyLnByb3RvdHlwZS5wcm94eUxvYWQgPSBmdW5jdGlvbihwcm94eSwgYm91bmRzLCBvcHRpb25zKSB7XHJcbiAgICB2YXIgY29udGFpbmVyID0gdGhpcy5zcmM7XHJcbiAgICByZXR1cm4gbG9hZFVybERvY3VtZW50KGNvbnRhaW5lci5zcmMsIHByb3h5LCBjb250YWluZXIub3duZXJEb2N1bWVudCwgYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0LCBvcHRpb25zKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRnJhbWVDb250YWluZXI7XHJcblxyXG59LHtcIi4vY29yZVwiOjQsXCIuL3Byb3h5XCI6MTYsXCIuL3V0aWxzXCI6MjZ9XSw5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxuZnVuY3Rpb24gR3JhZGllbnRDb250YWluZXIoaW1hZ2VEYXRhKSB7XHJcbiAgICB0aGlzLnNyYyA9IGltYWdlRGF0YS52YWx1ZTtcclxuICAgIHRoaXMuY29sb3JTdG9wcyA9IFtdO1xyXG4gICAgdGhpcy50eXBlID0gbnVsbDtcclxuICAgIHRoaXMueDAgPSAwLjU7XHJcbiAgICB0aGlzLnkwID0gMC41O1xyXG4gICAgdGhpcy54MSA9IDAuNTtcclxuICAgIHRoaXMueTEgPSAwLjU7XHJcbiAgICB0aGlzLnByb21pc2UgPSBQcm9taXNlLnJlc29sdmUodHJ1ZSk7XHJcbn1cclxuXHJcbkdyYWRpZW50Q29udGFpbmVyLlRZUEVTID0ge1xyXG4gICAgTElORUFSOiAxLFxyXG4gICAgUkFESUFMOiAyXHJcbn07XHJcblxyXG4vLyBUT0RPOiBzdXBwb3J0IGhzbFthXSwgbmVnYXRpdmUgJS9sZW5ndGggdmFsdWVzXHJcbi8vIFRPRE86IHN1cHBvcnQgPGFuZ2xlPiAoZS5nLiAtP1xcZHsxLDN9KD86XFwuXFxkKylkZWcsIGV0Yy4gOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9DU1MvYW5nbGUgKVxyXG5HcmFkaWVudENvbnRhaW5lci5SRUdFWFBfQ09MT1JTVE9QID0gL15cXHMqKHJnYmE/XFwoXFxzKlxcZHsxLDN9LFxccypcXGR7MSwzfSxcXHMqXFxkezEsM30oPzosXFxzKlswLTlcXC5dKyk/XFxzKlxcKXxbYS16XXszLDIwfXwjW2EtZjAtOV17Myw2fSkoPzpcXHMrKFxcZHsxLDN9KD86XFwuXFxkKyk/KSglfHB4KT8pPyg/Olxcc3wkKS9pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHcmFkaWVudENvbnRhaW5lcjtcclxuXHJcbn0se31dLDEwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxuZnVuY3Rpb24gSW1hZ2VDb250YWluZXIoc3JjLCBjb3JzKSB7XHJcbiAgICB0aGlzLnNyYyA9IHNyYztcclxuICAgIHRoaXMuaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHRoaXMudGFpbnRlZCA9IG51bGw7XHJcbiAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBzZWxmLmltYWdlLm9ubG9hZCA9IHJlc29sdmU7XHJcbiAgICAgICAgc2VsZi5pbWFnZS5vbmVycm9yID0gcmVqZWN0O1xyXG4gICAgICAgIGlmIChjb3JzKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW1hZ2UuY3Jvc3NPcmlnaW4gPSBcImFub255bW91c1wiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZWxmLmltYWdlLnNyYyA9IHNyYztcclxuICAgICAgICBpZiAoc2VsZi5pbWFnZS5jb21wbGV0ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHNlbGYuaW1hZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEltYWdlQ29udGFpbmVyO1xyXG5cclxufSx7fV0sMTE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xyXG52YXIgbG9nID0gX2RlcmVxXygnLi9sb2cnKTtcclxudmFyIEltYWdlQ29udGFpbmVyID0gX2RlcmVxXygnLi9pbWFnZWNvbnRhaW5lcicpO1xyXG52YXIgRHVtbXlJbWFnZUNvbnRhaW5lciA9IF9kZXJlcV8oJy4vZHVtbXlpbWFnZWNvbnRhaW5lcicpO1xyXG52YXIgUHJveHlJbWFnZUNvbnRhaW5lciA9IF9kZXJlcV8oJy4vcHJveHlpbWFnZWNvbnRhaW5lcicpO1xyXG52YXIgRnJhbWVDb250YWluZXIgPSBfZGVyZXFfKCcuL2ZyYW1lY29udGFpbmVyJyk7XHJcbnZhciBTVkdDb250YWluZXIgPSBfZGVyZXFfKCcuL3N2Z2NvbnRhaW5lcicpO1xyXG52YXIgU1ZHTm9kZUNvbnRhaW5lciA9IF9kZXJlcV8oJy4vc3Znbm9kZWNvbnRhaW5lcicpO1xyXG52YXIgTGluZWFyR3JhZGllbnRDb250YWluZXIgPSBfZGVyZXFfKCcuL2xpbmVhcmdyYWRpZW50Y29udGFpbmVyJyk7XHJcbnZhciBXZWJraXRHcmFkaWVudENvbnRhaW5lciA9IF9kZXJlcV8oJy4vd2Via2l0Z3JhZGllbnRjb250YWluZXInKTtcclxudmFyIGJpbmQgPSBfZGVyZXFfKCcuL3V0aWxzJykuYmluZDtcclxuXHJcbmZ1bmN0aW9uIEltYWdlTG9hZGVyKG9wdGlvbnMsIHN1cHBvcnQpIHtcclxuICAgIHRoaXMubGluayA9IG51bGw7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgdGhpcy5zdXBwb3J0ID0gc3VwcG9ydDtcclxuICAgIHRoaXMub3JpZ2luID0gdGhpcy5nZXRPcmlnaW4od2luZG93LmxvY2F0aW9uLmhyZWYpO1xyXG59XHJcblxyXG5JbWFnZUxvYWRlci5wcm90b3R5cGUuZmluZEltYWdlcyA9IGZ1bmN0aW9uKG5vZGVzKSB7XHJcbiAgICB2YXIgaW1hZ2VzID0gW107XHJcbiAgICBub2Rlcy5yZWR1Y2UoZnVuY3Rpb24oaW1hZ2VOb2RlcywgY29udGFpbmVyKSB7XHJcbiAgICAgICAgc3dpdGNoKGNvbnRhaW5lci5ub2RlLm5vZGVOYW1lKSB7XHJcbiAgICAgICAgY2FzZSBcIklNR1wiOlxyXG4gICAgICAgICAgICByZXR1cm4gaW1hZ2VOb2Rlcy5jb25jYXQoW3tcclxuICAgICAgICAgICAgICAgIGFyZ3M6IFtjb250YWluZXIubm9kZS5zcmNdLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcInVybFwiXHJcbiAgICAgICAgICAgIH1dKTtcclxuICAgICAgICBjYXNlIFwic3ZnXCI6XHJcbiAgICAgICAgY2FzZSBcIklGUkFNRVwiOlxyXG4gICAgICAgICAgICByZXR1cm4gaW1hZ2VOb2Rlcy5jb25jYXQoW3tcclxuICAgICAgICAgICAgICAgIGFyZ3M6IFtjb250YWluZXIubm9kZV0sXHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IGNvbnRhaW5lci5ub2RlLm5vZGVOYW1lXHJcbiAgICAgICAgICAgIH1dKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGltYWdlTm9kZXM7XHJcbiAgICB9LCBbXSkuZm9yRWFjaCh0aGlzLmFkZEltYWdlKGltYWdlcywgdGhpcy5sb2FkSW1hZ2UpLCB0aGlzKTtcclxuICAgIHJldHVybiBpbWFnZXM7XHJcbn07XHJcblxyXG5JbWFnZUxvYWRlci5wcm90b3R5cGUuZmluZEJhY2tncm91bmRJbWFnZSA9IGZ1bmN0aW9uKGltYWdlcywgY29udGFpbmVyKSB7XHJcbiAgICBjb250YWluZXIucGFyc2VCYWNrZ3JvdW5kSW1hZ2VzKCkuZmlsdGVyKHRoaXMuaGFzSW1hZ2VCYWNrZ3JvdW5kKS5mb3JFYWNoKHRoaXMuYWRkSW1hZ2UoaW1hZ2VzLCB0aGlzLmxvYWRJbWFnZSksIHRoaXMpO1xyXG4gICAgcmV0dXJuIGltYWdlcztcclxufTtcclxuXHJcbkltYWdlTG9hZGVyLnByb3RvdHlwZS5hZGRJbWFnZSA9IGZ1bmN0aW9uKGltYWdlcywgY2FsbGJhY2spIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihuZXdJbWFnZSkge1xyXG4gICAgICAgIG5ld0ltYWdlLmFyZ3MuZm9yRWFjaChmdW5jdGlvbihpbWFnZSkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuaW1hZ2VFeGlzdHMoaW1hZ2VzLCBpbWFnZSkpIHtcclxuICAgICAgICAgICAgICAgIGltYWdlcy5zcGxpY2UoMCwgMCwgY2FsbGJhY2suY2FsbCh0aGlzLCBuZXdJbWFnZSkpO1xyXG4gICAgICAgICAgICAgICAgbG9nKCdBZGRlZCBpbWFnZSAjJyArIChpbWFnZXMubGVuZ3RoKSwgdHlwZW9mKGltYWdlKSA9PT0gXCJzdHJpbmdcIiA/IGltYWdlLnN1YnN0cmluZygwLCAxMDApIDogaW1hZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcbiAgICB9O1xyXG59O1xyXG5cclxuSW1hZ2VMb2FkZXIucHJvdG90eXBlLmhhc0ltYWdlQmFja2dyb3VuZCA9IGZ1bmN0aW9uKGltYWdlRGF0YSkge1xyXG4gICAgcmV0dXJuIGltYWdlRGF0YS5tZXRob2QgIT09IFwibm9uZVwiO1xyXG59O1xyXG5cclxuSW1hZ2VMb2FkZXIucHJvdG90eXBlLmxvYWRJbWFnZSA9IGZ1bmN0aW9uKGltYWdlRGF0YSkge1xyXG4gICAgaWYgKGltYWdlRGF0YS5tZXRob2QgPT09IFwidXJsXCIpIHtcclxuICAgICAgICB2YXIgc3JjID0gaW1hZ2VEYXRhLmFyZ3NbMF07XHJcbiAgICAgICAgaWYgKHRoaXMuaXNTVkcoc3JjKSAmJiAhdGhpcy5zdXBwb3J0LnN2ZyAmJiAhdGhpcy5vcHRpb25zLmFsbG93VGFpbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTVkdDb250YWluZXIoc3JjKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHNyYy5tYXRjaCgvZGF0YTppbWFnZVxcLy4qO2Jhc2U2NCwvaSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbWFnZUNvbnRhaW5lcihzcmMucmVwbGFjZSgvdXJsXFwoWydcIl17MCx9fFsnXCJdezAsfVxcKSQvaWcsICcnKSwgZmFsc2UpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1NhbWVPcmlnaW4oc3JjKSB8fCB0aGlzLm9wdGlvbnMuYWxsb3dUYWludCA9PT0gdHJ1ZSB8fCB0aGlzLmlzU1ZHKHNyYykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbWFnZUNvbnRhaW5lcihzcmMsIGZhbHNlKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc3VwcG9ydC5jb3JzICYmICF0aGlzLm9wdGlvbnMuYWxsb3dUYWludCAmJiB0aGlzLm9wdGlvbnMudXNlQ09SUykge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IEltYWdlQ29udGFpbmVyKHNyYywgdHJ1ZSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMucHJveHkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm94eUltYWdlQ29udGFpbmVyKHNyYywgdGhpcy5vcHRpb25zLnByb3h5KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IER1bW15SW1hZ2VDb250YWluZXIoc3JjKTtcclxuICAgICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5tZXRob2QgPT09IFwibGluZWFyLWdyYWRpZW50XCIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IExpbmVhckdyYWRpZW50Q29udGFpbmVyKGltYWdlRGF0YSk7XHJcbiAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5tZXRob2QgPT09IFwiZ3JhZGllbnRcIikge1xyXG4gICAgICAgIHJldHVybiBuZXcgV2Via2l0R3JhZGllbnRDb250YWluZXIoaW1hZ2VEYXRhKTtcclxuICAgIH0gZWxzZSBpZiAoaW1hZ2VEYXRhLm1ldGhvZCA9PT0gXCJzdmdcIikge1xyXG4gICAgICAgIHJldHVybiBuZXcgU1ZHTm9kZUNvbnRhaW5lcihpbWFnZURhdGEuYXJnc1swXSwgdGhpcy5zdXBwb3J0LnN2Zyk7XHJcbiAgICB9IGVsc2UgaWYgKGltYWdlRGF0YS5tZXRob2QgPT09IFwiSUZSQU1FXCIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEZyYW1lQ29udGFpbmVyKGltYWdlRGF0YS5hcmdzWzBdLCB0aGlzLmlzU2FtZU9yaWdpbihpbWFnZURhdGEuYXJnc1swXS5zcmMpLCB0aGlzLm9wdGlvbnMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbmV3IER1bW15SW1hZ2VDb250YWluZXIoaW1hZ2VEYXRhKTtcclxuICAgIH1cclxufTtcclxuXHJcbkltYWdlTG9hZGVyLnByb3RvdHlwZS5pc1NWRyA9IGZ1bmN0aW9uKHNyYykge1xyXG4gICAgcmV0dXJuIHNyYy5zdWJzdHJpbmcoc3JjLmxlbmd0aCAtIDMpLnRvTG93ZXJDYXNlKCkgPT09IFwic3ZnXCIgfHwgU1ZHQ29udGFpbmVyLnByb3RvdHlwZS5pc0lubGluZShzcmMpO1xyXG59O1xyXG5cclxuSW1hZ2VMb2FkZXIucHJvdG90eXBlLmltYWdlRXhpc3RzID0gZnVuY3Rpb24oaW1hZ2VzLCBzcmMpIHtcclxuICAgIHJldHVybiBpbWFnZXMuc29tZShmdW5jdGlvbihpbWFnZSkge1xyXG4gICAgICAgIHJldHVybiBpbWFnZS5zcmMgPT09IHNyYztcclxuICAgIH0pO1xyXG59O1xyXG5cclxuSW1hZ2VMb2FkZXIucHJvdG90eXBlLmlzU2FtZU9yaWdpbiA9IGZ1bmN0aW9uKHVybCkge1xyXG4gICAgcmV0dXJuICh0aGlzLmdldE9yaWdpbih1cmwpID09PSB0aGlzLm9yaWdpbik7XHJcbn07XHJcblxyXG5JbWFnZUxvYWRlci5wcm90b3R5cGUuZ2V0T3JpZ2luID0gZnVuY3Rpb24odXJsKSB7XHJcbiAgICB2YXIgbGluayA9IHRoaXMubGluayB8fCAodGhpcy5saW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIikpO1xyXG4gICAgbGluay5ocmVmID0gdXJsO1xyXG4gICAgbGluay5ocmVmID0gbGluay5ocmVmOyAvLyBJRTksIExPTCEgLSBodHRwOi8vanNmaWRkbGUubmV0L25pa2xhc3ZoLzJlNDhiL1xyXG4gICAgcmV0dXJuIGxpbmsucHJvdG9jb2wgKyBsaW5rLmhvc3RuYW1lICsgbGluay5wb3J0O1xyXG59O1xyXG5cclxuSW1hZ2VMb2FkZXIucHJvdG90eXBlLmdldFByb21pc2UgPSBmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgIHJldHVybiB0aGlzLnRpbWVvdXQoY29udGFpbmVyLCB0aGlzLm9wdGlvbnMuaW1hZ2VUaW1lb3V0KVsnY2F0Y2gnXShmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgZHVtbXkgPSBuZXcgRHVtbXlJbWFnZUNvbnRhaW5lcihjb250YWluZXIuc3JjKTtcclxuICAgICAgICByZXR1cm4gZHVtbXkucHJvbWlzZS50aGVuKGZ1bmN0aW9uKGltYWdlKSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5pbWFnZSA9IGltYWdlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5JbWFnZUxvYWRlci5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24oc3JjKSB7XHJcbiAgICB2YXIgZm91bmQgPSBudWxsO1xyXG4gICAgcmV0dXJuIHRoaXMuaW1hZ2VzLnNvbWUoZnVuY3Rpb24oaW1nKSB7XHJcbiAgICAgICAgcmV0dXJuIChmb3VuZCA9IGltZykuc3JjID09PSBzcmM7XHJcbiAgICB9KSA/IGZvdW5kIDogbnVsbDtcclxufTtcclxuXHJcbkltYWdlTG9hZGVyLnByb3RvdHlwZS5mZXRjaCA9IGZ1bmN0aW9uKG5vZGVzKSB7XHJcbiAgICB0aGlzLmltYWdlcyA9IG5vZGVzLnJlZHVjZShiaW5kKHRoaXMuZmluZEJhY2tncm91bmRJbWFnZSwgdGhpcyksIHRoaXMuZmluZEltYWdlcyhub2RlcykpO1xyXG4gICAgdGhpcy5pbWFnZXMuZm9yRWFjaChmdW5jdGlvbihpbWFnZSwgaW5kZXgpIHtcclxuICAgICAgICBpbWFnZS5wcm9taXNlLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxvZyhcIlN1Y2Nlc2Z1bGx5IGxvYWRlZCBpbWFnZSAjXCIrIChpbmRleCsxKSwgaW1hZ2UpO1xyXG4gICAgICAgIH0sIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgbG9nKFwiRmFpbGVkIGxvYWRpbmcgaW1hZ2UgI1wiKyAoaW5kZXgrMSksIGltYWdlLCBlKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5yZWFkeSA9IFByb21pc2UuYWxsKHRoaXMuaW1hZ2VzLm1hcCh0aGlzLmdldFByb21pc2UsIHRoaXMpKTtcclxuICAgIGxvZyhcIkZpbmlzaGVkIHNlYXJjaGluZyBpbWFnZXNcIik7XHJcbiAgICByZXR1cm4gdGhpcztcclxufTtcclxuXHJcbkltYWdlTG9hZGVyLnByb3RvdHlwZS50aW1lb3V0ID0gZnVuY3Rpb24oY29udGFpbmVyLCB0aW1lb3V0KSB7XHJcbiAgICB2YXIgdGltZXI7XHJcbiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmFjZShbY29udGFpbmVyLnByb21pc2UsIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqZWN0KSB7XHJcbiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsb2coXCJUaW1lZCBvdXQgbG9hZGluZyBpbWFnZVwiLCBjb250YWluZXIpO1xyXG4gICAgICAgICAgICByZWplY3QoY29udGFpbmVyKTtcclxuICAgICAgICB9LCB0aW1lb3V0KTtcclxuICAgIH0pXSkudGhlbihmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xyXG4gICAgICAgIHJldHVybiBjb250YWluZXI7XHJcbiAgICB9KTtcclxuICAgIHByb21pc2VbJ2NhdGNoJ10oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHByb21pc2U7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEltYWdlTG9hZGVyO1xyXG5cclxufSx7XCIuL2R1bW15aW1hZ2Vjb250YWluZXJcIjo1LFwiLi9mcmFtZWNvbnRhaW5lclwiOjgsXCIuL2ltYWdlY29udGFpbmVyXCI6MTAsXCIuL2xpbmVhcmdyYWRpZW50Y29udGFpbmVyXCI6MTIsXCIuL2xvZ1wiOjEzLFwiLi9wcm94eWltYWdlY29udGFpbmVyXCI6MTcsXCIuL3N2Z2NvbnRhaW5lclwiOjIzLFwiLi9zdmdub2RlY29udGFpbmVyXCI6MjQsXCIuL3V0aWxzXCI6MjYsXCIuL3dlYmtpdGdyYWRpZW50Y29udGFpbmVyXCI6Mjd9XSwxMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBHcmFkaWVudENvbnRhaW5lciA9IF9kZXJlcV8oJy4vZ3JhZGllbnRjb250YWluZXInKTtcclxudmFyIENvbG9yID0gX2RlcmVxXygnLi9jb2xvcicpO1xyXG5cclxuZnVuY3Rpb24gTGluZWFyR3JhZGllbnRDb250YWluZXIoaW1hZ2VEYXRhKSB7XHJcbiAgICBHcmFkaWVudENvbnRhaW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgdGhpcy50eXBlID0gR3JhZGllbnRDb250YWluZXIuVFlQRVMuTElORUFSO1xyXG5cclxuICAgIHZhciBoYXNEaXJlY3Rpb24gPSBMaW5lYXJHcmFkaWVudENvbnRhaW5lci5SRUdFWFBfRElSRUNUSU9OLnRlc3QoIGltYWdlRGF0YS5hcmdzWzBdICkgfHxcclxuICAgICAgICAhR3JhZGllbnRDb250YWluZXIuUkVHRVhQX0NPTE9SU1RPUC50ZXN0KCBpbWFnZURhdGEuYXJnc1swXSApO1xyXG5cclxuICAgIGlmIChoYXNEaXJlY3Rpb24pIHtcclxuICAgICAgICBpbWFnZURhdGEuYXJnc1swXS5zcGxpdCgvXFxzKy8pLnJldmVyc2UoKS5mb3JFYWNoKGZ1bmN0aW9uKHBvc2l0aW9uLCBpbmRleCkge1xyXG4gICAgICAgICAgICBzd2l0Y2gocG9zaXRpb24pIHtcclxuICAgICAgICAgICAgY2FzZSBcImxlZnRcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMueDAgPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy54MSA9IDE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcInRvcFwiOlxyXG4gICAgICAgICAgICAgICAgdGhpcy55MCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnkxID0gMTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwicmlnaHRcIjpcclxuICAgICAgICAgICAgICAgIHRoaXMueDAgPSAxO1xyXG4gICAgICAgICAgICAgICAgdGhpcy54MSA9IDA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcImJvdHRvbVwiOlxyXG4gICAgICAgICAgICAgICAgdGhpcy55MCA9IDE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnkxID0gMDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwidG9cIjpcclxuICAgICAgICAgICAgICAgIHZhciB5MCA9IHRoaXMueTA7XHJcbiAgICAgICAgICAgICAgICB2YXIgeDAgPSB0aGlzLngwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy55MCA9IHRoaXMueTE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLngwID0gdGhpcy54MTtcclxuICAgICAgICAgICAgICAgIHRoaXMueDEgPSB4MDtcclxuICAgICAgICAgICAgICAgIHRoaXMueTEgPSB5MDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiY2VudGVyXCI6XHJcbiAgICAgICAgICAgICAgICBicmVhazsgLy8gY2VudGVyZWQgYnkgZGVmYXVsdFxyXG4gICAgICAgICAgICAvLyBGaXJlZm94IGludGVybmFsbHkgY29udmVydHMgcG9zaXRpb24ga2V5d29yZHMgdG8gcGVyY2VudGFnZXM6XHJcbiAgICAgICAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMTAvV0QtQ1NTMi0yMDEwMTIwNy9jb2xvcnMuaHRtbCNwcm9wZGVmLWJhY2tncm91bmQtcG9zaXRpb25cclxuICAgICAgICAgICAgZGVmYXVsdDogLy8gcGVyY2VudGFnZSBvciBhYnNvbHV0ZSBsZW5ndGhcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHN1cHBvcnQgYWJzb2x1dGUgc3RhcnQgcG9pbnQgcG9zaXRpb25zIChlLmcuLCB1c2UgYm91bmRzIHRvIGNvbnZlcnQgcHggdG8gYSByYXRpbylcclxuICAgICAgICAgICAgICAgIHZhciByYXRpbyA9IHBhcnNlRmxvYXQocG9zaXRpb24sIDEwKSAqIDFlLTI7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4ocmF0aW8pKSB7IC8vIGludmFsaWQgb3IgdW5oYW5kbGVkIHZhbHVlXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnkwID0gcmF0aW87XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy55MSA9IDEgLSB0aGlzLnkwO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLngwID0gcmF0aW87XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy54MSA9IDEgLSB0aGlzLngwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy55MCA9IDA7XHJcbiAgICAgICAgdGhpcy55MSA9IDE7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jb2xvclN0b3BzID0gaW1hZ2VEYXRhLmFyZ3Muc2xpY2UoaGFzRGlyZWN0aW9uID8gMSA6IDApLm1hcChmdW5jdGlvbihjb2xvclN0b3ApIHtcclxuICAgICAgICB2YXIgY29sb3JTdG9wTWF0Y2ggPSBjb2xvclN0b3AubWF0Y2goR3JhZGllbnRDb250YWluZXIuUkVHRVhQX0NPTE9SU1RPUCk7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gK2NvbG9yU3RvcE1hdGNoWzJdO1xyXG4gICAgICAgIHZhciB1bml0ID0gdmFsdWUgPT09IDAgPyBcIiVcIiA6IGNvbG9yU3RvcE1hdGNoWzNdOyAvLyB0cmVhdCBcIjBcIiBhcyBcIjAlXCJcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjb2xvcjogbmV3IENvbG9yKGNvbG9yU3RvcE1hdGNoWzFdKSxcclxuICAgICAgICAgICAgLy8gVE9ETzogc3VwcG9ydCBhYnNvbHV0ZSBzdG9wIHBvc2l0aW9ucyAoZS5nLiwgY29tcHV0ZSBncmFkaWVudCBsaW5lIGxlbmd0aCAmIGNvbnZlcnQgcHggdG8gcmF0aW8pXHJcbiAgICAgICAgICAgIHN0b3A6IHVuaXQgPT09IFwiJVwiID8gdmFsdWUgLyAxMDAgOiBudWxsXHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICh0aGlzLmNvbG9yU3RvcHNbMF0uc3RvcCA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuY29sb3JTdG9wc1swXS5zdG9wID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5jb2xvclN0b3BzW3RoaXMuY29sb3JTdG9wcy5sZW5ndGggLSAxXS5zdG9wID09PSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy5jb2xvclN0b3BzW3RoaXMuY29sb3JTdG9wcy5sZW5ndGggLSAxXS5zdG9wID0gMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBjYWxjdWxhdGVzIGFuZCBmaWxscy1pbiBleHBsaWNpdCBzdG9wIHBvc2l0aW9ucyB3aGVuIG9taXR0ZWQgZnJvbSBydWxlXHJcbiAgICB0aGlzLmNvbG9yU3RvcHMuZm9yRWFjaChmdW5jdGlvbihjb2xvclN0b3AsIGluZGV4KSB7XHJcbiAgICAgICAgaWYgKGNvbG9yU3RvcC5zdG9wID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29sb3JTdG9wcy5zbGljZShpbmRleCkuc29tZShmdW5jdGlvbihmaW5kLCBjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbmQuc3RvcCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yU3RvcC5zdG9wID0gKChmaW5kLnN0b3AgLSB0aGlzLmNvbG9yU3RvcHNbaW5kZXggLSAxXS5zdG9wKSAvIChjb3VudCArIDEpKSArIHRoaXMuY29sb3JTdG9wc1tpbmRleCAtIDFdLnN0b3A7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgdGhpcyk7XHJcbn1cclxuXHJcbkxpbmVhckdyYWRpZW50Q29udGFpbmVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoR3JhZGllbnRDb250YWluZXIucHJvdG90eXBlKTtcclxuXHJcbi8vIFRPRE86IHN1cHBvcnQgPGFuZ2xlPiAoZS5nLiAtP1xcZHsxLDN9KD86XFwuXFxkKylkZWcsIGV0Yy4gOiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9kb2NzL1dlYi9DU1MvYW5nbGUgKVxyXG5MaW5lYXJHcmFkaWVudENvbnRhaW5lci5SRUdFWFBfRElSRUNUSU9OID0gL15cXHMqKD86dG98bGVmdHxyaWdodHx0b3B8Ym90dG9tfGNlbnRlcnxcXGR7MSwzfSg/OlxcLlxcZCspPyU/KSg/Olxcc3wkKS9pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBMaW5lYXJHcmFkaWVudENvbnRhaW5lcjtcclxuXHJcbn0se1wiLi9jb2xvclwiOjMsXCIuL2dyYWRpZW50Y29udGFpbmVyXCI6OX1dLDEzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxudmFyIGxvZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKGxvZ2dlci5vcHRpb25zLmxvZ2dpbmcgJiYgd2luZG93LmNvbnNvbGUgJiYgd2luZG93LmNvbnNvbGUubG9nKSB7XHJcbiAgICAgICAgRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuY2FsbCh3aW5kb3cuY29uc29sZS5sb2csICh3aW5kb3cuY29uc29sZSkpLmFwcGx5KHdpbmRvdy5jb25zb2xlLCBbKERhdGUubm93KCkgLSBsb2dnZXIub3B0aW9ucy5zdGFydCkgKyBcIm1zXCIsIFwiaHRtbDJjYW52YXM6XCJdLmNvbmNhdChbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMCkpKTtcclxuICAgIH1cclxufTtcclxuXHJcbmxvZ2dlci5vcHRpb25zID0ge2xvZ2dpbmc6IGZhbHNlfTtcclxubW9kdWxlLmV4cG9ydHMgPSBsb2dnZXI7XHJcblxyXG59LHt9XSwxNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBDb2xvciA9IF9kZXJlcV8oJy4vY29sb3InKTtcclxudmFyIHV0aWxzID0gX2RlcmVxXygnLi91dGlscycpO1xyXG52YXIgZ2V0Qm91bmRzID0gdXRpbHMuZ2V0Qm91bmRzO1xyXG52YXIgcGFyc2VCYWNrZ3JvdW5kcyA9IHV0aWxzLnBhcnNlQmFja2dyb3VuZHM7XHJcbnZhciBvZmZzZXRCb3VuZHMgPSB1dGlscy5vZmZzZXRCb3VuZHM7XHJcblxyXG5mdW5jdGlvbiBOb2RlQ29udGFpbmVyKG5vZGUsIHBhcmVudCkge1xyXG4gICAgdGhpcy5ub2RlID0gbm9kZTtcclxuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgdGhpcy5zdGFjayA9IG51bGw7XHJcbiAgICB0aGlzLmJvdW5kcyA9IG51bGw7XHJcbiAgICB0aGlzLmJvcmRlcnMgPSBudWxsO1xyXG4gICAgdGhpcy5jbGlwID0gW107XHJcbiAgICB0aGlzLmJhY2tncm91bmRDbGlwID0gW107XHJcbiAgICB0aGlzLm9mZnNldEJvdW5kcyA9IG51bGw7XHJcbiAgICB0aGlzLnZpc2libGUgPSBudWxsO1xyXG4gICAgdGhpcy5jb21wdXRlZFN0eWxlcyA9IG51bGw7XHJcbiAgICB0aGlzLmNvbG9ycyA9IHt9O1xyXG4gICAgdGhpcy5zdHlsZXMgPSB7fTtcclxuICAgIHRoaXMuYmFja2dyb3VuZEltYWdlcyA9IG51bGw7XHJcbiAgICB0aGlzLnRyYW5zZm9ybURhdGEgPSBudWxsO1xyXG4gICAgdGhpcy50cmFuc2Zvcm1NYXRyaXggPSBudWxsO1xyXG4gICAgdGhpcy5pc1BzZXVkb0VsZW1lbnQgPSBmYWxzZTtcclxuICAgIHRoaXMub3BhY2l0eSA9IG51bGw7XHJcbn1cclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLmNsb25lVG8gPSBmdW5jdGlvbihzdGFjaykge1xyXG4gICAgc3RhY2sudmlzaWJsZSA9IHRoaXMudmlzaWJsZTtcclxuICAgIHN0YWNrLmJvcmRlcnMgPSB0aGlzLmJvcmRlcnM7XHJcbiAgICBzdGFjay5ib3VuZHMgPSB0aGlzLmJvdW5kcztcclxuICAgIHN0YWNrLmNsaXAgPSB0aGlzLmNsaXA7XHJcbiAgICBzdGFjay5iYWNrZ3JvdW5kQ2xpcCA9IHRoaXMuYmFja2dyb3VuZENsaXA7XHJcbiAgICBzdGFjay5jb21wdXRlZFN0eWxlcyA9IHRoaXMuY29tcHV0ZWRTdHlsZXM7XHJcbiAgICBzdGFjay5zdHlsZXMgPSB0aGlzLnN0eWxlcztcclxuICAgIHN0YWNrLmJhY2tncm91bmRJbWFnZXMgPSB0aGlzLmJhY2tncm91bmRJbWFnZXM7XHJcbiAgICBzdGFjay5vcGFjaXR5ID0gdGhpcy5vcGFjaXR5O1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUuZ2V0T3BhY2l0eSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMub3BhY2l0eSA9PT0gbnVsbCA/ICh0aGlzLm9wYWNpdHkgPSB0aGlzLmNzc0Zsb2F0KCdvcGFjaXR5JykpIDogdGhpcy5vcGFjaXR5O1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUuYXNzaWduU3RhY2sgPSBmdW5jdGlvbihzdGFjaykge1xyXG4gICAgdGhpcy5zdGFjayA9IHN0YWNrO1xyXG4gICAgc3RhY2suY2hpbGRyZW4ucHVzaCh0aGlzKTtcclxufTtcclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLmlzRWxlbWVudFZpc2libGUgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLm5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFID8gdGhpcy5wYXJlbnQudmlzaWJsZSA6IChcclxuICAgICAgICB0aGlzLmNzcygnZGlzcGxheScpICE9PSBcIm5vbmVcIiAmJlxyXG4gICAgICAgIHRoaXMuY3NzKCd2aXNpYmlsaXR5JykgIT09IFwiaGlkZGVuXCIgJiZcclxuICAgICAgICAhdGhpcy5ub2RlLmhhc0F0dHJpYnV0ZShcImRhdGEtaHRtbDJjYW52YXMtaWdub3JlXCIpICYmXHJcbiAgICAgICAgKHRoaXMubm9kZS5ub2RlTmFtZSAhPT0gXCJJTlBVVFwiIHx8IHRoaXMubm9kZS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpICE9PSBcImhpZGRlblwiKVxyXG4gICAgKTtcclxufTtcclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLmNzcyA9IGZ1bmN0aW9uKGF0dHJpYnV0ZSkge1xyXG4gICAgaWYgKCF0aGlzLmNvbXB1dGVkU3R5bGVzKSB7XHJcbiAgICAgICAgdGhpcy5jb21wdXRlZFN0eWxlcyA9IHRoaXMuaXNQc2V1ZG9FbGVtZW50ID8gdGhpcy5wYXJlbnQuY29tcHV0ZWRTdHlsZSh0aGlzLmJlZm9yZSA/IFwiOmJlZm9yZVwiIDogXCI6YWZ0ZXJcIikgOiB0aGlzLmNvbXB1dGVkU3R5bGUobnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuc3R5bGVzW2F0dHJpYnV0ZV0gfHwgKHRoaXMuc3R5bGVzW2F0dHJpYnV0ZV0gPSB0aGlzLmNvbXB1dGVkU3R5bGVzW2F0dHJpYnV0ZV0pO1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUucHJlZml4ZWRDc3MgPSBmdW5jdGlvbihhdHRyaWJ1dGUpIHtcclxuICAgIHZhciBwcmVmaXhlcyA9IFtcIndlYmtpdFwiLCBcIm1velwiLCBcIm1zXCIsIFwib1wiXTtcclxuICAgIHZhciB2YWx1ZSA9IHRoaXMuY3NzKGF0dHJpYnV0ZSk7XHJcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHByZWZpeGVzLnNvbWUoZnVuY3Rpb24ocHJlZml4KSB7XHJcbiAgICAgICAgICAgIHZhbHVlID0gdGhpcy5jc3MocHJlZml4ICsgYXR0cmlidXRlLnN1YnN0cigwLCAxKS50b1VwcGVyQ2FzZSgpICsgYXR0cmlidXRlLnN1YnN0cigxKSk7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0sIHRoaXMpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWU7XHJcbn07XHJcblxyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5jb21wdXRlZFN0eWxlID0gZnVuY3Rpb24odHlwZSkge1xyXG4gICAgcmV0dXJuIHRoaXMubm9kZS5vd25lckRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUodGhpcy5ub2RlLCB0eXBlKTtcclxufTtcclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLmNzc0ludCA9IGZ1bmN0aW9uKGF0dHJpYnV0ZSkge1xyXG4gICAgdmFyIHZhbHVlID0gcGFyc2VJbnQodGhpcy5jc3MoYXR0cmlidXRlKSwgMTApO1xyXG4gICAgcmV0dXJuIChpc05hTih2YWx1ZSkpID8gMCA6IHZhbHVlOyAvLyBib3JkZXJzIGluIG9sZCBJRSBhcmUgdGhyb3dpbmcgJ21lZGl1bScgZm9yIGRlbW8uaHRtbFxyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUuY29sb3IgPSBmdW5jdGlvbihhdHRyaWJ1dGUpIHtcclxuICAgIHJldHVybiB0aGlzLmNvbG9yc1thdHRyaWJ1dGVdIHx8ICh0aGlzLmNvbG9yc1thdHRyaWJ1dGVdID0gbmV3IENvbG9yKHRoaXMuY3NzKGF0dHJpYnV0ZSkpKTtcclxufTtcclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLmNzc0Zsb2F0ID0gZnVuY3Rpb24oYXR0cmlidXRlKSB7XHJcbiAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHRoaXMuY3NzKGF0dHJpYnV0ZSkpO1xyXG4gICAgcmV0dXJuIChpc05hTih2YWx1ZSkpID8gMCA6IHZhbHVlO1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUuZm9udFdlaWdodCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHdlaWdodCA9IHRoaXMuY3NzKFwiZm9udFdlaWdodFwiKTtcclxuICAgIHN3aXRjaChwYXJzZUludCh3ZWlnaHQsIDEwKSl7XHJcbiAgICBjYXNlIDQwMTpcclxuICAgICAgICB3ZWlnaHQgPSBcImJvbGRcIjtcclxuICAgICAgICBicmVhaztcclxuICAgIGNhc2UgNDAwOlxyXG4gICAgICAgIHdlaWdodCA9IFwibm9ybWFsXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gd2VpZ2h0O1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUucGFyc2VDbGlwID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbWF0Y2hlcyA9IHRoaXMuY3NzKCdjbGlwJykubWF0Y2godGhpcy5DTElQKTtcclxuICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdG9wOiBwYXJzZUludChtYXRjaGVzWzFdLCAxMCksXHJcbiAgICAgICAgICAgIHJpZ2h0OiBwYXJzZUludChtYXRjaGVzWzJdLCAxMCksXHJcbiAgICAgICAgICAgIGJvdHRvbTogcGFyc2VJbnQobWF0Y2hlc1szXSwgMTApLFxyXG4gICAgICAgICAgICBsZWZ0OiBwYXJzZUludChtYXRjaGVzWzRdLCAxMClcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5wYXJzZUJhY2tncm91bmRJbWFnZXMgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLmJhY2tncm91bmRJbWFnZXMgfHwgKHRoaXMuYmFja2dyb3VuZEltYWdlcyA9IHBhcnNlQmFja2dyb3VuZHModGhpcy5jc3MoXCJiYWNrZ3JvdW5kSW1hZ2VcIikpKTtcclxufTtcclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLmNzc0xpc3QgPSBmdW5jdGlvbihwcm9wZXJ0eSwgaW5kZXgpIHtcclxuICAgIHZhciB2YWx1ZSA9ICh0aGlzLmNzcyhwcm9wZXJ0eSkgfHwgJycpLnNwbGl0KCcsJyk7XHJcbiAgICB2YWx1ZSA9IHZhbHVlW2luZGV4IHx8IDBdIHx8IHZhbHVlWzBdIHx8ICdhdXRvJztcclxuICAgIHZhbHVlID0gdmFsdWUudHJpbSgpLnNwbGl0KCcgJyk7XHJcbiAgICBpZiAodmFsdWUubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgdmFsdWUgPSBbdmFsdWVbMF0sIGlzUGVyY2VudGFnZSh2YWx1ZVswXSkgPyAnYXV0bycgOiB2YWx1ZVswXV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn07XHJcblxyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5wYXJzZUJhY2tncm91bmRTaXplID0gZnVuY3Rpb24oYm91bmRzLCBpbWFnZSwgaW5kZXgpIHtcclxuICAgIHZhciBzaXplID0gdGhpcy5jc3NMaXN0KFwiYmFja2dyb3VuZFNpemVcIiwgaW5kZXgpO1xyXG4gICAgdmFyIHdpZHRoLCBoZWlnaHQ7XHJcblxyXG4gICAgaWYgKGlzUGVyY2VudGFnZShzaXplWzBdKSkge1xyXG4gICAgICAgIHdpZHRoID0gYm91bmRzLndpZHRoICogcGFyc2VGbG9hdChzaXplWzBdKSAvIDEwMDtcclxuICAgIH0gZWxzZSBpZiAoL2NvbnRhaW58Y292ZXIvLnRlc3Qoc2l6ZVswXSkpIHtcclxuICAgICAgICB2YXIgdGFyZ2V0UmF0aW8gPSBib3VuZHMud2lkdGggLyBib3VuZHMuaGVpZ2h0LCBjdXJyZW50UmF0aW8gPSBpbWFnZS53aWR0aCAvIGltYWdlLmhlaWdodDtcclxuICAgICAgICByZXR1cm4gKHRhcmdldFJhdGlvIDwgY3VycmVudFJhdGlvIF4gc2l6ZVswXSA9PT0gJ2NvbnRhaW4nKSA/ICB7d2lkdGg6IGJvdW5kcy5oZWlnaHQgKiBjdXJyZW50UmF0aW8sIGhlaWdodDogYm91bmRzLmhlaWdodH0gOiB7d2lkdGg6IGJvdW5kcy53aWR0aCwgaGVpZ2h0OiBib3VuZHMud2lkdGggLyBjdXJyZW50UmF0aW99O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB3aWR0aCA9IHBhcnNlSW50KHNpemVbMF0sIDEwKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc2l6ZVswXSA9PT0gJ2F1dG8nICYmIHNpemVbMV0gPT09ICdhdXRvJykge1xyXG4gICAgICAgIGhlaWdodCA9IGltYWdlLmhlaWdodDtcclxuICAgIH0gZWxzZSBpZiAoc2l6ZVsxXSA9PT0gJ2F1dG8nKSB7XHJcbiAgICAgICAgaGVpZ2h0ID0gd2lkdGggLyBpbWFnZS53aWR0aCAqIGltYWdlLmhlaWdodDtcclxuICAgIH0gZWxzZSBpZiAoaXNQZXJjZW50YWdlKHNpemVbMV0pKSB7XHJcbiAgICAgICAgaGVpZ2h0ID0gIGJvdW5kcy5oZWlnaHQgKiBwYXJzZUZsb2F0KHNpemVbMV0pIC8gMTAwO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBoZWlnaHQgPSBwYXJzZUludChzaXplWzFdLCAxMCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNpemVbMF0gPT09ICdhdXRvJykge1xyXG4gICAgICAgIHdpZHRoID0gaGVpZ2h0IC8gaW1hZ2UuaGVpZ2h0ICogaW1hZ2Uud2lkdGg7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHt3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0fTtcclxufTtcclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLnBhcnNlQmFja2dyb3VuZFBvc2l0aW9uID0gZnVuY3Rpb24oYm91bmRzLCBpbWFnZSwgaW5kZXgsIGJhY2tncm91bmRTaXplKSB7XHJcbiAgICB2YXIgcG9zaXRpb24gPSB0aGlzLmNzc0xpc3QoJ2JhY2tncm91bmRQb3NpdGlvbicsIGluZGV4KTtcclxuICAgIHZhciBsZWZ0LCB0b3A7XHJcblxyXG4gICAgaWYgKGlzUGVyY2VudGFnZShwb3NpdGlvblswXSkpe1xyXG4gICAgICAgIGxlZnQgPSAoYm91bmRzLndpZHRoIC0gKGJhY2tncm91bmRTaXplIHx8IGltYWdlKS53aWR0aCkgKiAocGFyc2VGbG9hdChwb3NpdGlvblswXSkgLyAxMDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBsZWZ0ID0gcGFyc2VJbnQocG9zaXRpb25bMF0sIDEwKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocG9zaXRpb25bMV0gPT09ICdhdXRvJykge1xyXG4gICAgICAgIHRvcCA9IGxlZnQgLyBpbWFnZS53aWR0aCAqIGltYWdlLmhlaWdodDtcclxuICAgIH0gZWxzZSBpZiAoaXNQZXJjZW50YWdlKHBvc2l0aW9uWzFdKSl7XHJcbiAgICAgICAgdG9wID0gIChib3VuZHMuaGVpZ2h0IC0gKGJhY2tncm91bmRTaXplIHx8IGltYWdlKS5oZWlnaHQpICogcGFyc2VGbG9hdChwb3NpdGlvblsxXSkgLyAxMDA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRvcCA9IHBhcnNlSW50KHBvc2l0aW9uWzFdLCAxMCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBvc2l0aW9uWzBdID09PSAnYXV0bycpIHtcclxuICAgICAgICBsZWZ0ID0gdG9wIC8gaW1hZ2UuaGVpZ2h0ICogaW1hZ2Uud2lkdGg7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtsZWZ0OiBsZWZ0LCB0b3A6IHRvcH07XHJcbn07XHJcblxyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5wYXJzZUJhY2tncm91bmRSZXBlYXQgPSBmdW5jdGlvbihpbmRleCkge1xyXG4gICAgcmV0dXJuIHRoaXMuY3NzTGlzdChcImJhY2tncm91bmRSZXBlYXRcIiwgaW5kZXgpWzBdO1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUucGFyc2VUZXh0U2hhZG93cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHRleHRTaGFkb3cgPSB0aGlzLmNzcyhcInRleHRTaGFkb3dcIik7XHJcbiAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG5cclxuICAgIGlmICh0ZXh0U2hhZG93ICYmIHRleHRTaGFkb3cgIT09ICdub25lJykge1xyXG4gICAgICAgIHZhciBzaGFkb3dzID0gdGV4dFNoYWRvdy5tYXRjaCh0aGlzLlRFWFRfU0hBRE9XX1BST1BFUlRZKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgc2hhZG93cyAmJiAoaSA8IHNoYWRvd3MubGVuZ3RoKTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBzID0gc2hhZG93c1tpXS5tYXRjaCh0aGlzLlRFWFRfU0hBRE9XX1ZBTFVFUyk7XHJcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBjb2xvcjogbmV3IENvbG9yKHNbMF0pLFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0WDogc1sxXSA/IHBhcnNlRmxvYXQoc1sxXS5yZXBsYWNlKCdweCcsICcnKSkgOiAwLFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0WTogc1syXSA/IHBhcnNlRmxvYXQoc1syXS5yZXBsYWNlKCdweCcsICcnKSkgOiAwLFxyXG4gICAgICAgICAgICAgICAgYmx1cjogc1szXSA/IHNbM10ucmVwbGFjZSgncHgnLCAnJykgOiAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiByZXN1bHRzO1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUucGFyc2VUcmFuc2Zvcm0gPSBmdW5jdGlvbigpIHtcclxuICAgIGlmICghdGhpcy50cmFuc2Zvcm1EYXRhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzVHJhbnNmb3JtKCkpIHtcclxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IHRoaXMucGFyc2VCb3VuZHMoKTtcclxuICAgICAgICAgICAgdmFyIG9yaWdpbiA9IHRoaXMucHJlZml4ZWRDc3MoXCJ0cmFuc2Zvcm1PcmlnaW5cIikuc3BsaXQoXCIgXCIpLm1hcChyZW1vdmVQeCkubWFwKGFzRmxvYXQpO1xyXG4gICAgICAgICAgICBvcmlnaW5bMF0gKz0gb2Zmc2V0LmxlZnQ7XHJcbiAgICAgICAgICAgIG9yaWdpblsxXSArPSBvZmZzZXQudG9wO1xyXG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybURhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW46IG9yaWdpbixcclxuICAgICAgICAgICAgICAgIG1hdHJpeDogdGhpcy5wYXJzZVRyYW5zZm9ybU1hdHJpeCgpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm1EYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgb3JpZ2luOiBbMCwgMF0sXHJcbiAgICAgICAgICAgICAgICBtYXRyaXg6IFsxLCAwLCAwLCAxLCAwLCAwXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLnRyYW5zZm9ybURhdGE7XHJcbn07XHJcblxyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5wYXJzZVRyYW5zZm9ybU1hdHJpeCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgaWYgKCF0aGlzLnRyYW5zZm9ybU1hdHJpeCkge1xyXG4gICAgICAgIHZhciB0cmFuc2Zvcm0gPSB0aGlzLnByZWZpeGVkQ3NzKFwidHJhbnNmb3JtXCIpO1xyXG4gICAgICAgIHZhciBtYXRyaXggPSB0cmFuc2Zvcm0gPyBwYXJzZU1hdHJpeCh0cmFuc2Zvcm0ubWF0Y2godGhpcy5NQVRSSVhfUFJPUEVSVFkpKSA6IG51bGw7XHJcbiAgICAgICAgdGhpcy50cmFuc2Zvcm1NYXRyaXggPSBtYXRyaXggPyBtYXRyaXggOiBbMSwgMCwgMCwgMSwgMCwgMF07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy50cmFuc2Zvcm1NYXRyaXg7XHJcbn07XHJcblxyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5wYXJzZUJvdW5kcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuYm91bmRzIHx8ICh0aGlzLmJvdW5kcyA9IHRoaXMuaGFzVHJhbnNmb3JtKCkgPyBvZmZzZXRCb3VuZHModGhpcy5ub2RlKSA6IGdldEJvdW5kcyh0aGlzLm5vZGUpKTtcclxufTtcclxuXHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLmhhc1RyYW5zZm9ybSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucGFyc2VUcmFuc2Zvcm1NYXRyaXgoKS5qb2luKFwiLFwiKSAhPT0gXCIxLDAsMCwxLDAsMFwiIHx8ICh0aGlzLnBhcmVudCAmJiB0aGlzLnBhcmVudC5oYXNUcmFuc2Zvcm0oKSk7XHJcbn07XHJcblxyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHZhbHVlID0gdGhpcy5ub2RlLnZhbHVlIHx8IFwiXCI7XHJcbiAgICBpZiAodGhpcy5ub2RlLnRhZ05hbWUgPT09IFwiU0VMRUNUXCIpIHtcclxuICAgICAgICB2YWx1ZSA9IHNlbGVjdGlvblZhbHVlKHRoaXMubm9kZSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMubm9kZS50eXBlID09PSBcInBhc3N3b3JkXCIpIHtcclxuICAgICAgICB2YWx1ZSA9IEFycmF5KHZhbHVlLmxlbmd0aCArIDEpLmpvaW4oJ1xcdTIwMjInKTsgLy8ganNoaW50IGlnbm9yZTpsaW5lXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsdWUubGVuZ3RoID09PSAwID8gKHRoaXMubm9kZS5wbGFjZWhvbGRlciB8fCBcIlwiKSA6IHZhbHVlO1xyXG59O1xyXG5cclxuTm9kZUNvbnRhaW5lci5wcm90b3R5cGUuTUFUUklYX1BST1BFUlRZID0gLyhtYXRyaXh8bWF0cml4M2QpXFwoKC4rKVxcKS87XHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLlRFWFRfU0hBRE9XX1BST1BFUlRZID0gLygocmdiYXxyZ2IpXFwoW15cXCldK1xcKShcXHMtP1xcZCtweCl7MCx9KS9nO1xyXG5Ob2RlQ29udGFpbmVyLnByb3RvdHlwZS5URVhUX1NIQURPV19WQUxVRVMgPSAvKC0/XFxkK3B4KXwoIy4rKXwocmdiXFwoLitcXCkpfChyZ2JhXFwoLitcXCkpL2c7XHJcbk5vZGVDb250YWluZXIucHJvdG90eXBlLkNMSVAgPSAvXnJlY3RcXCgoXFxkKylweCw/IChcXGQrKXB4LD8gKFxcZCspcHgsPyAoXFxkKylweFxcKSQvO1xyXG5cclxuZnVuY3Rpb24gc2VsZWN0aW9uVmFsdWUobm9kZSkge1xyXG4gICAgdmFyIG9wdGlvbiA9IG5vZGUub3B0aW9uc1tub2RlLnNlbGVjdGVkSW5kZXggfHwgMF07XHJcbiAgICByZXR1cm4gb3B0aW9uID8gKG9wdGlvbi50ZXh0IHx8IFwiXCIpIDogXCJcIjtcclxufVxyXG5cclxuZnVuY3Rpb24gcGFyc2VNYXRyaXgobWF0Y2gpIHtcclxuICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSA9PT0gXCJtYXRyaXhcIikge1xyXG4gICAgICAgIHJldHVybiBtYXRjaFsyXS5zcGxpdChcIixcIikubWFwKGZ1bmN0aW9uKHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQocy50cmltKCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmIChtYXRjaCAmJiBtYXRjaFsxXSA9PT0gXCJtYXRyaXgzZFwiKSB7XHJcbiAgICAgICAgdmFyIG1hdHJpeDNkID0gbWF0Y2hbMl0uc3BsaXQoXCIsXCIpLm1hcChmdW5jdGlvbihzKSB7XHJcbiAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChzLnRyaW0oKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFttYXRyaXgzZFswXSwgbWF0cml4M2RbMV0sIG1hdHJpeDNkWzRdLCBtYXRyaXgzZFs1XSwgbWF0cml4M2RbMTJdLCBtYXRyaXgzZFsxM11dO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpc1BlcmNlbnRhZ2UodmFsdWUpIHtcclxuICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpLmluZGV4T2YoXCIlXCIpICE9PSAtMTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlUHgoc3RyKSB7XHJcbiAgICByZXR1cm4gc3RyLnJlcGxhY2UoXCJweFwiLCBcIlwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYXNGbG9hdChzdHIpIHtcclxuICAgIHJldHVybiBwYXJzZUZsb2F0KHN0cik7XHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTm9kZUNvbnRhaW5lcjtcclxuXHJcbn0se1wiLi9jb2xvclwiOjMsXCIuL3V0aWxzXCI6MjZ9XSwxNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBsb2cgPSBfZGVyZXFfKCcuL2xvZycpO1xyXG52YXIgcHVueWNvZGUgPSBfZGVyZXFfKCdwdW55Y29kZScpO1xyXG52YXIgTm9kZUNvbnRhaW5lciA9IF9kZXJlcV8oJy4vbm9kZWNvbnRhaW5lcicpO1xyXG52YXIgVGV4dENvbnRhaW5lciA9IF9kZXJlcV8oJy4vdGV4dGNvbnRhaW5lcicpO1xyXG52YXIgUHNldWRvRWxlbWVudENvbnRhaW5lciA9IF9kZXJlcV8oJy4vcHNldWRvZWxlbWVudGNvbnRhaW5lcicpO1xyXG52YXIgRm9udE1ldHJpY3MgPSBfZGVyZXFfKCcuL2ZvbnRtZXRyaWNzJyk7XHJcbnZhciBDb2xvciA9IF9kZXJlcV8oJy4vY29sb3InKTtcclxudmFyIFN0YWNraW5nQ29udGV4dCA9IF9kZXJlcV8oJy4vc3RhY2tpbmdjb250ZXh0Jyk7XHJcbnZhciB1dGlscyA9IF9kZXJlcV8oJy4vdXRpbHMnKTtcclxudmFyIGJpbmQgPSB1dGlscy5iaW5kO1xyXG52YXIgZ2V0Qm91bmRzID0gdXRpbHMuZ2V0Qm91bmRzO1xyXG52YXIgcGFyc2VCYWNrZ3JvdW5kcyA9IHV0aWxzLnBhcnNlQmFja2dyb3VuZHM7XHJcbnZhciBvZmZzZXRCb3VuZHMgPSB1dGlscy5vZmZzZXRCb3VuZHM7XHJcblxyXG5mdW5jdGlvbiBOb2RlUGFyc2VyKGVsZW1lbnQsIHJlbmRlcmVyLCBzdXBwb3J0LCBpbWFnZUxvYWRlciwgb3B0aW9ucykge1xyXG4gICAgbG9nKFwiU3RhcnRpbmcgTm9kZVBhcnNlclwiKTtcclxuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XHJcbiAgICB0aGlzLnJhbmdlID0gbnVsbDtcclxuICAgIHRoaXMuc3VwcG9ydCA9IHN1cHBvcnQ7XHJcbiAgICB0aGlzLnJlbmRlclF1ZXVlID0gW107XHJcbiAgICB0aGlzLnN0YWNrID0gbmV3IFN0YWNraW5nQ29udGV4dCh0cnVlLCAxLCBlbGVtZW50Lm93bmVyRG9jdW1lbnQsIG51bGwpO1xyXG4gICAgdmFyIHBhcmVudCA9IG5ldyBOb2RlQ29udGFpbmVyKGVsZW1lbnQsIG51bGwpO1xyXG4gICAgaWYgKG9wdGlvbnMuYmFja2dyb3VuZCkge1xyXG4gICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSgwLCAwLCByZW5kZXJlci53aWR0aCwgcmVuZGVyZXIuaGVpZ2h0LCBuZXcgQ29sb3Iob3B0aW9ucy5iYWNrZ3JvdW5kKSk7XHJcbiAgICB9XHJcbiAgICBpZiAoZWxlbWVudCA9PT0gZWxlbWVudC5vd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkge1xyXG4gICAgICAgIC8vIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtYmFja2dyb3VuZC8jc3BlY2lhbC1iYWNrZ3JvdW5kc1xyXG4gICAgICAgIHZhciBjYW52YXNCYWNrZ3JvdW5kID0gbmV3IE5vZGVDb250YWluZXIocGFyZW50LmNvbG9yKCdiYWNrZ3JvdW5kQ29sb3InKS5pc1RyYW5zcGFyZW50KCkgPyBlbGVtZW50Lm93bmVyRG9jdW1lbnQuYm9keSA6IGVsZW1lbnQub3duZXJEb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIG51bGwpO1xyXG4gICAgICAgIHJlbmRlcmVyLnJlY3RhbmdsZSgwLCAwLCByZW5kZXJlci53aWR0aCwgcmVuZGVyZXIuaGVpZ2h0LCBjYW52YXNCYWNrZ3JvdW5kLmNvbG9yKCdiYWNrZ3JvdW5kQ29sb3InKSk7XHJcbiAgICB9XHJcbiAgICBwYXJlbnQudmlzaWJpbGUgPSBwYXJlbnQuaXNFbGVtZW50VmlzaWJsZSgpO1xyXG4gICAgdGhpcy5jcmVhdGVQc2V1ZG9IaWRlU3R5bGVzKGVsZW1lbnQub3duZXJEb2N1bWVudCk7XHJcbiAgICB0aGlzLmRpc2FibGVBbmltYXRpb25zKGVsZW1lbnQub3duZXJEb2N1bWVudCk7XHJcbiAgICB0aGlzLm5vZGVzID0gZmxhdHRlbihbcGFyZW50XS5jb25jYXQodGhpcy5nZXRDaGlsZHJlbihwYXJlbnQpKS5maWx0ZXIoZnVuY3Rpb24oY29udGFpbmVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5lci52aXNpYmxlID0gY29udGFpbmVyLmlzRWxlbWVudFZpc2libGUoKTtcclxuICAgIH0pLm1hcCh0aGlzLmdldFBzZXVkb0VsZW1lbnRzLCB0aGlzKSk7XHJcbiAgICB0aGlzLmZvbnRNZXRyaWNzID0gbmV3IEZvbnRNZXRyaWNzKCk7XHJcbiAgICBsb2coXCJGZXRjaGVkIG5vZGVzLCB0b3RhbDpcIiwgdGhpcy5ub2Rlcy5sZW5ndGgpO1xyXG4gICAgbG9nKFwiQ2FsY3VsYXRlIG92ZXJmbG93IGNsaXBzXCIpO1xyXG4gICAgdGhpcy5jYWxjdWxhdGVPdmVyZmxvd0NsaXBzKCk7XHJcbiAgICBsb2coXCJTdGFydCBmZXRjaGluZyBpbWFnZXNcIik7XHJcbiAgICB0aGlzLmltYWdlcyA9IGltYWdlTG9hZGVyLmZldGNoKHRoaXMubm9kZXMuZmlsdGVyKGlzRWxlbWVudCkpO1xyXG4gICAgdGhpcy5yZWFkeSA9IHRoaXMuaW1hZ2VzLnJlYWR5LnRoZW4oYmluZChmdW5jdGlvbigpIHtcclxuICAgICAgICBsb2coXCJJbWFnZXMgbG9hZGVkLCBzdGFydGluZyBwYXJzaW5nXCIpO1xyXG4gICAgICAgIGxvZyhcIkNyZWF0aW5nIHN0YWNraW5nIGNvbnRleHRzXCIpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlU3RhY2tpbmdDb250ZXh0cygpO1xyXG4gICAgICAgIGxvZyhcIlNvcnRpbmcgc3RhY2tpbmcgY29udGV4dHNcIik7XHJcbiAgICAgICAgdGhpcy5zb3J0U3RhY2tpbmdDb250ZXh0cyh0aGlzLnN0YWNrKTtcclxuICAgICAgICB0aGlzLnBhcnNlKHRoaXMuc3RhY2spO1xyXG4gICAgICAgIGxvZyhcIlJlbmRlciBxdWV1ZSBjcmVhdGVkIHdpdGggXCIgKyB0aGlzLnJlbmRlclF1ZXVlLmxlbmd0aCArIFwiIGl0ZW1zXCIpO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShiaW5kKGZ1bmN0aW9uKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgaWYgKCFvcHRpb25zLmFzeW5jKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclF1ZXVlLmZvckVhY2godGhpcy5wYWludCwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mKG9wdGlvbnMuYXN5bmMpID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMuYXN5bmMuY2FsbCh0aGlzLCB0aGlzLnJlbmRlclF1ZXVlLCByZXNvbHZlKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlbmRlclF1ZXVlLmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJJbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFzeW5jUmVuZGVyZXIodGhpcy5yZW5kZXJRdWV1ZSwgcmVzb2x2ZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB0aGlzKSk7XHJcbiAgICB9LCB0aGlzKSk7XHJcbn1cclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLmNhbGN1bGF0ZU92ZXJmbG93Q2xpcHMgPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMubm9kZXMuZm9yRWFjaChmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgICAgICBpZiAoaXNFbGVtZW50KGNvbnRhaW5lcikpIHtcclxuICAgICAgICAgICAgaWYgKGlzUHNldWRvRWxlbWVudChjb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuYXBwZW5kVG9ET00oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb250YWluZXIuYm9yZGVycyA9IHRoaXMucGFyc2VCb3JkZXJzKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIHZhciBjbGlwID0gKGNvbnRhaW5lci5jc3MoJ292ZXJmbG93JykgPT09IFwiaGlkZGVuXCIpID8gW2NvbnRhaW5lci5ib3JkZXJzLmNsaXBdIDogW107XHJcbiAgICAgICAgICAgIHZhciBjc3NDbGlwID0gY29udGFpbmVyLnBhcnNlQ2xpcCgpO1xyXG4gICAgICAgICAgICBpZiAoY3NzQ2xpcCAmJiBbXCJhYnNvbHV0ZVwiLCBcImZpeGVkXCJdLmluZGV4T2YoY29udGFpbmVyLmNzcygncG9zaXRpb24nKSkgIT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBjbGlwLnB1c2goW1tcInJlY3RcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmJvdW5kcy5sZWZ0ICsgY3NzQ2xpcC5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuYm91bmRzLnRvcCArIGNzc0NsaXAudG9wLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NDbGlwLnJpZ2h0IC0gY3NzQ2xpcC5sZWZ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjc3NDbGlwLmJvdHRvbSAtIGNzc0NsaXAudG9wXHJcbiAgICAgICAgICAgICAgICBdXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29udGFpbmVyLmNsaXAgPSBoYXNQYXJlbnRDbGlwKGNvbnRhaW5lcikgPyBjb250YWluZXIucGFyZW50LmNsaXAuY29uY2F0KGNsaXApIDogY2xpcDtcclxuICAgICAgICAgICAgY29udGFpbmVyLmJhY2tncm91bmRDbGlwID0gKGNvbnRhaW5lci5jc3MoJ292ZXJmbG93JykgIT09IFwiaGlkZGVuXCIpID8gY29udGFpbmVyLmNsaXAuY29uY2F0KFtjb250YWluZXIuYm9yZGVycy5jbGlwXSkgOiBjb250YWluZXIuY2xpcDtcclxuICAgICAgICAgICAgaWYgKGlzUHNldWRvRWxlbWVudChjb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIuY2xlYW5ET00oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoaXNUZXh0Tm9kZShjb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5jbGlwID0gaGFzUGFyZW50Q2xpcChjb250YWluZXIpID8gY29udGFpbmVyLnBhcmVudC5jbGlwIDogW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghaXNQc2V1ZG9FbGVtZW50KGNvbnRhaW5lcikpIHtcclxuICAgICAgICAgICAgY29udGFpbmVyLmJvdW5kcyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgdGhpcyk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBoYXNQYXJlbnRDbGlwKGNvbnRhaW5lcikge1xyXG4gICAgcmV0dXJuIGNvbnRhaW5lci5wYXJlbnQgJiYgY29udGFpbmVyLnBhcmVudC5jbGlwLmxlbmd0aDtcclxufVxyXG5cclxuTm9kZVBhcnNlci5wcm90b3R5cGUuYXN5bmNSZW5kZXJlciA9IGZ1bmN0aW9uKHF1ZXVlLCByZXNvbHZlLCBhc3luY1RpbWVyKSB7XHJcbiAgICBhc3luY1RpbWVyID0gYXN5bmNUaW1lciB8fCBEYXRlLm5vdygpO1xyXG4gICAgdGhpcy5wYWludChxdWV1ZVt0aGlzLnJlbmRlckluZGV4KytdKTtcclxuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IHRoaXMucmVuZGVySW5kZXgpIHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICB9IGVsc2UgaWYgKGFzeW5jVGltZXIgKyAyMCA+IERhdGUubm93KCkpIHtcclxuICAgICAgICB0aGlzLmFzeW5jUmVuZGVyZXIocXVldWUsIHJlc29sdmUsIGFzeW5jVGltZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzZXRUaW1lb3V0KGJpbmQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXN5bmNSZW5kZXJlcihxdWV1ZSwgcmVzb2x2ZSk7XHJcbiAgICAgICAgfSwgdGhpcyksIDApO1xyXG4gICAgfVxyXG59O1xyXG5cclxuTm9kZVBhcnNlci5wcm90b3R5cGUuY3JlYXRlUHNldWRvSGlkZVN0eWxlcyA9IGZ1bmN0aW9uKGRvY3VtZW50KSB7XHJcbiAgICB0aGlzLmNyZWF0ZVN0eWxlcyhkb2N1bWVudCwgJy4nICsgUHNldWRvRWxlbWVudENvbnRhaW5lci5wcm90b3R5cGUuUFNFVURPX0hJREVfRUxFTUVOVF9DTEFTU19CRUZPUkUgKyAnOmJlZm9yZSB7IGNvbnRlbnQ6IFwiXCIgIWltcG9ydGFudDsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB9JyArXHJcbiAgICAgICAgJy4nICsgUHNldWRvRWxlbWVudENvbnRhaW5lci5wcm90b3R5cGUuUFNFVURPX0hJREVfRUxFTUVOVF9DTEFTU19BRlRFUiArICc6YWZ0ZXIgeyBjb250ZW50OiBcIlwiICFpbXBvcnRhbnQ7IGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsgfScpO1xyXG59O1xyXG5cclxuTm9kZVBhcnNlci5wcm90b3R5cGUuZGlzYWJsZUFuaW1hdGlvbnMgPSBmdW5jdGlvbihkb2N1bWVudCkge1xyXG4gICAgdGhpcy5jcmVhdGVTdHlsZXMoZG9jdW1lbnQsICcqIHsgLXdlYmtpdC1hbmltYXRpb246IG5vbmUgIWltcG9ydGFudDsgLW1vei1hbmltYXRpb246IG5vbmUgIWltcG9ydGFudDsgLW8tYW5pbWF0aW9uOiBub25lICFpbXBvcnRhbnQ7IGFuaW1hdGlvbjogbm9uZSAhaW1wb3J0YW50OyAnICtcclxuICAgICAgICAnLXdlYmtpdC10cmFuc2l0aW9uOiBub25lICFpbXBvcnRhbnQ7IC1tb3otdHJhbnNpdGlvbjogbm9uZSAhaW1wb3J0YW50OyAtby10cmFuc2l0aW9uOiBub25lICFpbXBvcnRhbnQ7IHRyYW5zaXRpb246IG5vbmUgIWltcG9ydGFudDt9Jyk7XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5jcmVhdGVTdHlsZXMgPSBmdW5jdGlvbihkb2N1bWVudCwgc3R5bGVzKSB7XHJcbiAgICB2YXIgaGlkZVBzZXVkb0VsZW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcclxuICAgIGhpZGVQc2V1ZG9FbGVtZW50cy5pbm5lckhUTUwgPSBzdHlsZXM7XHJcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGhpZGVQc2V1ZG9FbGVtZW50cyk7XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5nZXRQc2V1ZG9FbGVtZW50cyA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgdmFyIG5vZGVzID0gW1tjb250YWluZXJdXTtcclxuICAgIGlmIChjb250YWluZXIubm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcclxuICAgICAgICB2YXIgYmVmb3JlID0gdGhpcy5nZXRQc2V1ZG9FbGVtZW50KGNvbnRhaW5lciwgXCI6YmVmb3JlXCIpO1xyXG4gICAgICAgIHZhciBhZnRlciA9IHRoaXMuZ2V0UHNldWRvRWxlbWVudChjb250YWluZXIsIFwiOmFmdGVyXCIpO1xyXG5cclxuICAgICAgICBpZiAoYmVmb3JlKSB7XHJcbiAgICAgICAgICAgIG5vZGVzLnB1c2goYmVmb3JlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChhZnRlcikge1xyXG4gICAgICAgICAgICBub2Rlcy5wdXNoKGFmdGVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmxhdHRlbihub2Rlcyk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiB0b0NhbWVsQ2FzZShzdHIpIHtcclxuICAgIHJldHVybiBzdHIucmVwbGFjZSgvKFxcLVthLXpdKS9nLCBmdW5jdGlvbihtYXRjaCl7XHJcbiAgICAgICAgcmV0dXJuIG1hdGNoLnRvVXBwZXJDYXNlKCkucmVwbGFjZSgnLScsJycpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLmdldFBzZXVkb0VsZW1lbnQgPSBmdW5jdGlvbihjb250YWluZXIsIHR5cGUpIHtcclxuICAgIHZhciBzdHlsZSA9IGNvbnRhaW5lci5jb21wdXRlZFN0eWxlKHR5cGUpO1xyXG4gICAgaWYoIXN0eWxlIHx8ICFzdHlsZS5jb250ZW50IHx8IHN0eWxlLmNvbnRlbnQgPT09IFwibm9uZVwiIHx8IHN0eWxlLmNvbnRlbnQgPT09IFwiLW1vei1hbHQtY29udGVudFwiIHx8IHN0eWxlLmRpc3BsYXkgPT09IFwibm9uZVwiKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGNvbnRlbnQgPSBzdHJpcFF1b3RlcyhzdHlsZS5jb250ZW50KTtcclxuICAgIHZhciBpc0ltYWdlID0gY29udGVudC5zdWJzdHIoMCwgMykgPT09ICd1cmwnO1xyXG4gICAgdmFyIHBzZXVkb05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGlzSW1hZ2UgPyAnaW1nJyA6ICdodG1sMmNhbnZhc3BzZXVkb2VsZW1lbnQnKTtcclxuICAgIHZhciBwc2V1ZG9Db250YWluZXIgPSBuZXcgUHNldWRvRWxlbWVudENvbnRhaW5lcihwc2V1ZG9Ob2RlLCBjb250YWluZXIsIHR5cGUpO1xyXG5cclxuICAgIGZvciAodmFyIGkgPSBzdHlsZS5sZW5ndGgtMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICB2YXIgcHJvcGVydHkgPSB0b0NhbWVsQ2FzZShzdHlsZS5pdGVtKGkpKTtcclxuICAgICAgICBwc2V1ZG9Ob2RlLnN0eWxlW3Byb3BlcnR5XSA9IHN0eWxlW3Byb3BlcnR5XTtcclxuICAgIH1cclxuXHJcbiAgICBwc2V1ZG9Ob2RlLmNsYXNzTmFtZSA9IFBzZXVkb0VsZW1lbnRDb250YWluZXIucHJvdG90eXBlLlBTRVVET19ISURFX0VMRU1FTlRfQ0xBU1NfQkVGT1JFICsgXCIgXCIgKyBQc2V1ZG9FbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZS5QU0VVRE9fSElERV9FTEVNRU5UX0NMQVNTX0FGVEVSO1xyXG5cclxuICAgIGlmIChpc0ltYWdlKSB7XHJcbiAgICAgICAgcHNldWRvTm9kZS5zcmMgPSBwYXJzZUJhY2tncm91bmRzKGNvbnRlbnQpWzBdLmFyZ3NbMF07XHJcbiAgICAgICAgcmV0dXJuIFtwc2V1ZG9Db250YWluZXJdO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB2YXIgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNvbnRlbnQpO1xyXG4gICAgICAgIHBzZXVkb05vZGUuYXBwZW5kQ2hpbGQodGV4dCk7XHJcbiAgICAgICAgcmV0dXJuIFtwc2V1ZG9Db250YWluZXIsIG5ldyBUZXh0Q29udGFpbmVyKHRleHQsIHBzZXVkb0NvbnRhaW5lcildO1xyXG4gICAgfVxyXG59O1xyXG5cclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLmdldENoaWxkcmVuID0gZnVuY3Rpb24ocGFyZW50Q29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gZmxhdHRlbihbXS5maWx0ZXIuY2FsbChwYXJlbnRDb250YWluZXIubm9kZS5jaGlsZE5vZGVzLCByZW5kZXJhYmxlTm9kZSkubWFwKGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgICAgICB2YXIgY29udGFpbmVyID0gW25vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFID8gbmV3IFRleHRDb250YWluZXIobm9kZSwgcGFyZW50Q29udGFpbmVyKSA6IG5ldyBOb2RlQ29udGFpbmVyKG5vZGUsIHBhcmVudENvbnRhaW5lcildLmZpbHRlcihub25JZ25vcmVkRWxlbWVudCk7XHJcbiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFICYmIGNvbnRhaW5lci5sZW5ndGggJiYgbm9kZS50YWdOYW1lICE9PSBcIlRFWFRBUkVBXCIgPyAoY29udGFpbmVyWzBdLmlzRWxlbWVudFZpc2libGUoKSA/IGNvbnRhaW5lci5jb25jYXQodGhpcy5nZXRDaGlsZHJlbihjb250YWluZXJbMF0pKSA6IFtdKSA6IGNvbnRhaW5lcjtcclxuICAgIH0sIHRoaXMpKTtcclxufTtcclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLm5ld1N0YWNraW5nQ29udGV4dCA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgaGFzT3duU3RhY2tpbmcpIHtcclxuICAgIHZhciBzdGFjayA9IG5ldyBTdGFja2luZ0NvbnRleHQoaGFzT3duU3RhY2tpbmcsIGNvbnRhaW5lci5nZXRPcGFjaXR5KCksIGNvbnRhaW5lci5ub2RlLCBjb250YWluZXIucGFyZW50KTtcclxuICAgIGNvbnRhaW5lci5jbG9uZVRvKHN0YWNrKTtcclxuICAgIHZhciBwYXJlbnRTdGFjayA9IGhhc093blN0YWNraW5nID8gc3RhY2suZ2V0UGFyZW50U3RhY2sodGhpcykgOiBzdGFjay5wYXJlbnQuc3RhY2s7XHJcbiAgICBwYXJlbnRTdGFjay5jb250ZXh0cy5wdXNoKHN0YWNrKTtcclxuICAgIGNvbnRhaW5lci5zdGFjayA9IHN0YWNrO1xyXG59O1xyXG5cclxuTm9kZVBhcnNlci5wcm90b3R5cGUuY3JlYXRlU3RhY2tpbmdDb250ZXh0cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5ub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgICAgIGlmIChpc0VsZW1lbnQoY29udGFpbmVyKSAmJiAodGhpcy5pc1Jvb3RFbGVtZW50KGNvbnRhaW5lcikgfHwgaGFzT3BhY2l0eShjb250YWluZXIpIHx8IGlzUG9zaXRpb25lZEZvclN0YWNraW5nKGNvbnRhaW5lcikgfHwgdGhpcy5pc0JvZHlXaXRoVHJhbnNwYXJlbnRSb290KGNvbnRhaW5lcikgfHwgY29udGFpbmVyLmhhc1RyYW5zZm9ybSgpKSkge1xyXG4gICAgICAgICAgICB0aGlzLm5ld1N0YWNraW5nQ29udGV4dChjb250YWluZXIsIHRydWUpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaXNFbGVtZW50KGNvbnRhaW5lcikgJiYgKChpc1Bvc2l0aW9uZWQoY29udGFpbmVyKSAmJiB6SW5kZXgwKGNvbnRhaW5lcikpIHx8IGlzSW5saW5lQmxvY2soY29udGFpbmVyKSB8fCBpc0Zsb2F0aW5nKGNvbnRhaW5lcikpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubmV3U3RhY2tpbmdDb250ZXh0KGNvbnRhaW5lciwgZmFsc2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lci5hc3NpZ25TdGFjayhjb250YWluZXIucGFyZW50LnN0YWNrKTtcclxuICAgICAgICB9XHJcbiAgICB9LCB0aGlzKTtcclxufTtcclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLmlzQm9keVdpdGhUcmFuc3BhcmVudFJvb3QgPSBmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgIHJldHVybiBjb250YWluZXIubm9kZS5ub2RlTmFtZSA9PT0gXCJCT0RZXCIgJiYgY29udGFpbmVyLnBhcmVudC5jb2xvcignYmFja2dyb3VuZENvbG9yJykuaXNUcmFuc3BhcmVudCgpO1xyXG59O1xyXG5cclxuTm9kZVBhcnNlci5wcm90b3R5cGUuaXNSb290RWxlbWVudCA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgcmV0dXJuIGNvbnRhaW5lci5wYXJlbnQgPT09IG51bGw7XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5zb3J0U3RhY2tpbmdDb250ZXh0cyA9IGZ1bmN0aW9uKHN0YWNrKSB7XHJcbiAgICBzdGFjay5jb250ZXh0cy5zb3J0KHpJbmRleFNvcnQoc3RhY2suY29udGV4dHMuc2xpY2UoMCkpKTtcclxuICAgIHN0YWNrLmNvbnRleHRzLmZvckVhY2godGhpcy5zb3J0U3RhY2tpbmdDb250ZXh0cywgdGhpcyk7XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5wYXJzZVRleHRCb3VuZHMgPSBmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbih0ZXh0LCBpbmRleCwgdGV4dExpc3QpIHtcclxuICAgICAgICBpZiAoY29udGFpbmVyLnBhcmVudC5jc3MoXCJ0ZXh0RGVjb3JhdGlvblwiKS5zdWJzdHIoMCwgNCkgIT09IFwibm9uZVwiIHx8IHRleHQudHJpbSgpLmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zdXBwb3J0LnJhbmdlQm91bmRzICYmICFjb250YWluZXIucGFyZW50Lmhhc1RyYW5zZm9ybSgpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gdGV4dExpc3Quc2xpY2UoMCwgaW5kZXgpLmpvaW4oXCJcIikubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmFuZ2VCb3VuZHMoY29udGFpbmVyLm5vZGUsIG9mZnNldCwgdGV4dC5sZW5ndGgpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRhaW5lci5ub2RlICYmIHR5cGVvZihjb250YWluZXIubm9kZS5kYXRhKSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcGxhY2VtZW50Tm9kZSA9IGNvbnRhaW5lci5ub2RlLnNwbGl0VGV4dCh0ZXh0Lmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYm91bmRzID0gdGhpcy5nZXRXcmFwcGVyQm91bmRzKGNvbnRhaW5lci5ub2RlLCBjb250YWluZXIucGFyZW50Lmhhc1RyYW5zZm9ybSgpKTtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5ub2RlID0gcmVwbGFjZW1lbnROb2RlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvdW5kcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZighdGhpcy5zdXBwb3J0LnJhbmdlQm91bmRzIHx8IGNvbnRhaW5lci5wYXJlbnQuaGFzVHJhbnNmb3JtKCkpe1xyXG4gICAgICAgICAgICBjb250YWluZXIubm9kZSA9IGNvbnRhaW5lci5ub2RlLnNwbGl0VGV4dCh0ZXh0Lmxlbmd0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB7fTtcclxuICAgIH07XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5nZXRXcmFwcGVyQm91bmRzID0gZnVuY3Rpb24obm9kZSwgdHJhbnNmb3JtKSB7XHJcbiAgICB2YXIgd3JhcHBlciA9IG5vZGUub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KCdodG1sMmNhbnZhc3dyYXBwZXInKTtcclxuICAgIHZhciBwYXJlbnQgPSBub2RlLnBhcmVudE5vZGUsXHJcbiAgICAgICAgYmFja3VwVGV4dCA9IG5vZGUuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQobm9kZS5jbG9uZU5vZGUodHJ1ZSkpO1xyXG4gICAgcGFyZW50LnJlcGxhY2VDaGlsZCh3cmFwcGVyLCBub2RlKTtcclxuICAgIHZhciBib3VuZHMgPSB0cmFuc2Zvcm0gPyBvZmZzZXRCb3VuZHMod3JhcHBlcikgOiBnZXRCb3VuZHMod3JhcHBlcik7XHJcbiAgICBwYXJlbnQucmVwbGFjZUNoaWxkKGJhY2t1cFRleHQsIHdyYXBwZXIpO1xyXG4gICAgcmV0dXJuIGJvdW5kcztcclxufTtcclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLmdldFJhbmdlQm91bmRzID0gZnVuY3Rpb24obm9kZSwgb2Zmc2V0LCBsZW5ndGgpIHtcclxuICAgIHZhciByYW5nZSA9IHRoaXMucmFuZ2UgfHwgKHRoaXMucmFuZ2UgPSBub2RlLm93bmVyRG9jdW1lbnQuY3JlYXRlUmFuZ2UoKSk7XHJcbiAgICByYW5nZS5zZXRTdGFydChub2RlLCBvZmZzZXQpO1xyXG4gICAgcmFuZ2Uuc2V0RW5kKG5vZGUsIG9mZnNldCArIGxlbmd0aCk7XHJcbiAgICByZXR1cm4gcmFuZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBDbGVhclRyYW5zZm9ybSgpIHt9XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHN0YWNrKSB7XHJcbiAgICAvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9DU1MyMS92aXN1cmVuLmh0bWwjei1pbmRleFxyXG4gICAgdmFyIG5lZ2F0aXZlWmluZGV4ID0gc3RhY2suY29udGV4dHMuZmlsdGVyKG5lZ2F0aXZlWkluZGV4KTsgLy8gMi4gdGhlIGNoaWxkIHN0YWNraW5nIGNvbnRleHRzIHdpdGggbmVnYXRpdmUgc3RhY2sgbGV2ZWxzIChtb3N0IG5lZ2F0aXZlIGZpcnN0KS5cclxuICAgIHZhciBkZXNjZW5kYW50RWxlbWVudHMgPSBzdGFjay5jaGlsZHJlbi5maWx0ZXIoaXNFbGVtZW50KTtcclxuICAgIHZhciBkZXNjZW5kYW50Tm9uRmxvYXRzID0gZGVzY2VuZGFudEVsZW1lbnRzLmZpbHRlcihub3QoaXNGbG9hdGluZykpO1xyXG4gICAgdmFyIG5vbklubGluZU5vblBvc2l0aW9uZWREZXNjZW5kYW50cyA9IGRlc2NlbmRhbnROb25GbG9hdHMuZmlsdGVyKG5vdChpc1Bvc2l0aW9uZWQpKS5maWx0ZXIobm90KGlubGluZUxldmVsKSk7IC8vIDMgdGhlIGluLWZsb3csIG5vbi1pbmxpbmUtbGV2ZWwsIG5vbi1wb3NpdGlvbmVkIGRlc2NlbmRhbnRzLlxyXG4gICAgdmFyIG5vblBvc2l0aW9uZWRGbG9hdHMgPSBkZXNjZW5kYW50RWxlbWVudHMuZmlsdGVyKG5vdChpc1Bvc2l0aW9uZWQpKS5maWx0ZXIoaXNGbG9hdGluZyk7IC8vIDQuIHRoZSBub24tcG9zaXRpb25lZCBmbG9hdHMuXHJcbiAgICB2YXIgaW5GbG93ID0gZGVzY2VuZGFudE5vbkZsb2F0cy5maWx0ZXIobm90KGlzUG9zaXRpb25lZCkpLmZpbHRlcihpbmxpbmVMZXZlbCk7IC8vIDUuIHRoZSBpbi1mbG93LCBpbmxpbmUtbGV2ZWwsIG5vbi1wb3NpdGlvbmVkIGRlc2NlbmRhbnRzLCBpbmNsdWRpbmcgaW5saW5lIHRhYmxlcyBhbmQgaW5saW5lIGJsb2Nrcy5cclxuICAgIHZhciBzdGFja0xldmVsMCA9IHN0YWNrLmNvbnRleHRzLmNvbmNhdChkZXNjZW5kYW50Tm9uRmxvYXRzLmZpbHRlcihpc1Bvc2l0aW9uZWQpKS5maWx0ZXIoekluZGV4MCk7IC8vIDYuIHRoZSBjaGlsZCBzdGFja2luZyBjb250ZXh0cyB3aXRoIHN0YWNrIGxldmVsIDAgYW5kIHRoZSBwb3NpdGlvbmVkIGRlc2NlbmRhbnRzIHdpdGggc3RhY2sgbGV2ZWwgMC5cclxuICAgIHZhciB0ZXh0ID0gc3RhY2suY2hpbGRyZW4uZmlsdGVyKGlzVGV4dE5vZGUpLmZpbHRlcihoYXNUZXh0KTtcclxuICAgIHZhciBwb3NpdGl2ZVppbmRleCA9IHN0YWNrLmNvbnRleHRzLmZpbHRlcihwb3NpdGl2ZVpJbmRleCk7IC8vIDcuIHRoZSBjaGlsZCBzdGFja2luZyBjb250ZXh0cyB3aXRoIHBvc2l0aXZlIHN0YWNrIGxldmVscyAobGVhc3QgcG9zaXRpdmUgZmlyc3QpLlxyXG4gICAgbmVnYXRpdmVaaW5kZXguY29uY2F0KG5vbklubGluZU5vblBvc2l0aW9uZWREZXNjZW5kYW50cykuY29uY2F0KG5vblBvc2l0aW9uZWRGbG9hdHMpXHJcbiAgICAgICAgLmNvbmNhdChpbkZsb3cpLmNvbmNhdChzdGFja0xldmVsMCkuY29uY2F0KHRleHQpLmNvbmNhdChwb3NpdGl2ZVppbmRleCkuZm9yRWFjaChmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJRdWV1ZS5wdXNoKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIGlmIChpc1N0YWNraW5nQ29udGV4dChjb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlKGNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclF1ZXVlLnB1c2gobmV3IENsZWFyVHJhbnNmb3JtKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5wYWludCA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBpZiAoY29udGFpbmVyIGluc3RhbmNlb2YgQ2xlYXJUcmFuc2Zvcm0pIHtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5jdHgucmVzdG9yZSgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaXNUZXh0Tm9kZShjb250YWluZXIpKSB7XHJcbiAgICAgICAgICAgIGlmIChpc1BzZXVkb0VsZW1lbnQoY29udGFpbmVyLnBhcmVudCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5wYXJlbnQuYXBwZW5kVG9ET00oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnBhaW50VGV4dChjb250YWluZXIpO1xyXG4gICAgICAgICAgICBpZiAoaXNQc2V1ZG9FbGVtZW50KGNvbnRhaW5lci5wYXJlbnQpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIucGFyZW50LmNsZWFuRE9NKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBhaW50Tm9kZShjb250YWluZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgIGxvZyhlKTtcclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLnN0cmljdCkge1xyXG4gICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLnBhaW50Tm9kZSA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgaWYgKGlzU3RhY2tpbmdDb250ZXh0KGNvbnRhaW5lcikpIHtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldE9wYWNpdHkoY29udGFpbmVyLm9wYWNpdHkpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuY3R4LnNhdmUoKTtcclxuICAgICAgICBpZiAoY29udGFpbmVyLmhhc1RyYW5zZm9ybSgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0VHJhbnNmb3JtKGNvbnRhaW5lci5wYXJzZVRyYW5zZm9ybSgpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNvbnRhaW5lci5ub2RlLm5vZGVOYW1lID09PSBcIklOUFVUXCIgJiYgY29udGFpbmVyLm5vZGUudHlwZSA9PT0gXCJjaGVja2JveFwiKSB7XHJcbiAgICAgICAgdGhpcy5wYWludENoZWNrYm94KGNvbnRhaW5lcik7XHJcbiAgICB9IGVsc2UgaWYgKGNvbnRhaW5lci5ub2RlLm5vZGVOYW1lID09PSBcIklOUFVUXCIgJiYgY29udGFpbmVyLm5vZGUudHlwZSA9PT0gXCJyYWRpb1wiKSB7XHJcbiAgICAgICAgdGhpcy5wYWludFJhZGlvKGNvbnRhaW5lcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMucGFpbnRFbGVtZW50KGNvbnRhaW5lcik7XHJcbiAgICB9XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5wYWludEVsZW1lbnQgPSBmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgIHZhciBib3VuZHMgPSBjb250YWluZXIucGFyc2VCb3VuZHMoKTtcclxuICAgIHRoaXMucmVuZGVyZXIuY2xpcChjb250YWluZXIuYmFja2dyb3VuZENsaXAsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyQmFja2dyb3VuZChjb250YWluZXIsIGJvdW5kcywgY29udGFpbmVyLmJvcmRlcnMuYm9yZGVycy5tYXAoZ2V0V2lkdGgpKTtcclxuICAgIH0sIHRoaXMpO1xyXG5cclxuICAgIHRoaXMucmVuZGVyZXIuY2xpcChjb250YWluZXIuY2xpcCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXJCb3JkZXJzKGNvbnRhaW5lci5ib3JkZXJzLmJvcmRlcnMpO1xyXG4gICAgfSwgdGhpcyk7XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5jbGlwKGNvbnRhaW5lci5iYWNrZ3JvdW5kQ2xpcCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc3dpdGNoIChjb250YWluZXIubm9kZS5ub2RlTmFtZSkge1xyXG4gICAgICAgIGNhc2UgXCJzdmdcIjpcclxuICAgICAgICBjYXNlIFwiSUZSQU1FXCI6XHJcbiAgICAgICAgICAgIHZhciBpbWdDb250YWluZXIgPSB0aGlzLmltYWdlcy5nZXQoY29udGFpbmVyLm5vZGUpO1xyXG4gICAgICAgICAgICBpZiAoaW1nQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlckltYWdlKGNvbnRhaW5lciwgYm91bmRzLCBjb250YWluZXIuYm9yZGVycywgaW1nQ29udGFpbmVyKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxvZyhcIkVycm9yIGxvYWRpbmcgPFwiICsgY29udGFpbmVyLm5vZGUubm9kZU5hbWUgKyBcIj5cIiwgY29udGFpbmVyLm5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJJTUdcIjpcclxuICAgICAgICAgICAgdmFyIGltYWdlQ29udGFpbmVyID0gdGhpcy5pbWFnZXMuZ2V0KGNvbnRhaW5lci5ub2RlLnNyYyk7XHJcbiAgICAgICAgICAgIGlmIChpbWFnZUNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXJJbWFnZShjb250YWluZXIsIGJvdW5kcywgY29udGFpbmVyLmJvcmRlcnMsIGltYWdlQ29udGFpbmVyKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxvZyhcIkVycm9yIGxvYWRpbmcgPGltZz5cIiwgY29udGFpbmVyLm5vZGUuc3JjKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiQ0FOVkFTXCI6XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVySW1hZ2UoY29udGFpbmVyLCBib3VuZHMsIGNvbnRhaW5lci5ib3JkZXJzLCB7aW1hZ2U6IGNvbnRhaW5lci5ub2RlfSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJTRUxFQ1RcIjpcclxuICAgICAgICBjYXNlIFwiSU5QVVRcIjpcclxuICAgICAgICBjYXNlIFwiVEVYVEFSRUFcIjpcclxuICAgICAgICAgICAgdGhpcy5wYWludEZvcm1WYWx1ZShjb250YWluZXIpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9LCB0aGlzKTtcclxufTtcclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLnBhaW50Q2hlY2tib3ggPSBmdW5jdGlvbihjb250YWluZXIpIHtcclxuICAgIHZhciBiID0gY29udGFpbmVyLnBhcnNlQm91bmRzKCk7XHJcblxyXG4gICAgdmFyIHNpemUgPSBNYXRoLm1pbihiLndpZHRoLCBiLmhlaWdodCk7XHJcbiAgICB2YXIgYm91bmRzID0ge3dpZHRoOiBzaXplIC0gMSwgaGVpZ2h0OiBzaXplIC0gMSwgdG9wOiBiLnRvcCwgbGVmdDogYi5sZWZ0fTtcclxuICAgIHZhciByID0gWzMsIDNdO1xyXG4gICAgdmFyIHJhZGl1cyA9IFtyLCByLCByLCByXTtcclxuICAgIHZhciBib3JkZXJzID0gWzEsMSwxLDFdLm1hcChmdW5jdGlvbih3KSB7XHJcbiAgICAgICAgcmV0dXJuIHtjb2xvcjogbmV3IENvbG9yKCcjQTVBNUE1JyksIHdpZHRoOiB3fTtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciBib3JkZXJQb2ludHMgPSBjYWxjdWxhdGVDdXJ2ZVBvaW50cyhib3VuZHMsIHJhZGl1cywgYm9yZGVycyk7XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5jbGlwKGNvbnRhaW5lci5iYWNrZ3JvdW5kQ2xpcCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZWN0YW5nbGUoYm91bmRzLmxlZnQgKyAxLCBib3VuZHMudG9wICsgMSwgYm91bmRzLndpZHRoIC0gMiwgYm91bmRzLmhlaWdodCAtIDIsIG5ldyBDb2xvcihcIiNERURFREVcIikpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyQm9yZGVycyhjYWxjdWxhdGVCb3JkZXJzKGJvcmRlcnMsIGJvdW5kcywgYm9yZGVyUG9pbnRzLCByYWRpdXMpKTtcclxuICAgICAgICBpZiAoY29udGFpbmVyLm5vZGUuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmZvbnQobmV3IENvbG9yKCcjNDI0MjQyJyksICdub3JtYWwnLCAnbm9ybWFsJywgJ2JvbGQnLCAoc2l6ZSAtIDMpICsgXCJweFwiLCAnYXJpYWwnKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJlci50ZXh0KFwiXFx1MjcxNFwiLCBib3VuZHMubGVmdCArIHNpemUgLyA2LCBib3VuZHMudG9wICsgc2l6ZSAtIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIHRoaXMpO1xyXG59O1xyXG5cclxuTm9kZVBhcnNlci5wcm90b3R5cGUucGFpbnRSYWRpbyA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgdmFyIGJvdW5kcyA9IGNvbnRhaW5lci5wYXJzZUJvdW5kcygpO1xyXG5cclxuICAgIHZhciBzaXplID0gTWF0aC5taW4oYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0KSAtIDI7XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5jbGlwKGNvbnRhaW5lci5iYWNrZ3JvdW5kQ2xpcCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5jaXJjbGVTdHJva2UoYm91bmRzLmxlZnQgKyAxLCBib3VuZHMudG9wICsgMSwgc2l6ZSwgbmV3IENvbG9yKCcjREVERURFJyksIDEsIG5ldyBDb2xvcignI0E1QTVBNScpKTtcclxuICAgICAgICBpZiAoY29udGFpbmVyLm5vZGUuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLmNpcmNsZShNYXRoLmNlaWwoYm91bmRzLmxlZnQgKyBzaXplIC8gNCkgKyAxLCBNYXRoLmNlaWwoYm91bmRzLnRvcCArIHNpemUgLyA0KSArIDEsIE1hdGguZmxvb3Ioc2l6ZSAvIDIpLCBuZXcgQ29sb3IoJyM0MjQyNDInKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSwgdGhpcyk7XHJcbn07XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5wYWludEZvcm1WYWx1ZSA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgdmFyIHZhbHVlID0gY29udGFpbmVyLmdldFZhbHVlKCk7XHJcbiAgICBpZiAodmFsdWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIHZhciBkb2N1bWVudCA9IGNvbnRhaW5lci5ub2RlLm93bmVyRG9jdW1lbnQ7XHJcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdodG1sMmNhbnZhc3dyYXBwZXInKTtcclxuICAgICAgICB2YXIgcHJvcGVydGllcyA9IFsnbGluZUhlaWdodCcsICd0ZXh0QWxpZ24nLCAnZm9udEZhbWlseScsICdmb250V2VpZ2h0JywgJ2ZvbnRTaXplJywgJ2NvbG9yJyxcclxuICAgICAgICAgICAgJ3BhZGRpbmdMZWZ0JywgJ3BhZGRpbmdUb3AnLCAncGFkZGluZ1JpZ2h0JywgJ3BhZGRpbmdCb3R0b20nLFxyXG4gICAgICAgICAgICAnd2lkdGgnLCAnaGVpZ2h0JywgJ2JvcmRlckxlZnRTdHlsZScsICdib3JkZXJUb3BTdHlsZScsICdib3JkZXJMZWZ0V2lkdGgnLCAnYm9yZGVyVG9wV2lkdGgnLFxyXG4gICAgICAgICAgICAnYm94U2l6aW5nJywgJ3doaXRlU3BhY2UnLCAnd29yZFdyYXAnXTtcclxuXHJcbiAgICAgICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICB3cmFwcGVyLnN0eWxlW3Byb3BlcnR5XSA9IGNvbnRhaW5lci5jc3MocHJvcGVydHkpO1xyXG4gICAgICAgICAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIE9sZGVyIElFIGhhcyBpc3N1ZXMgd2l0aCBcImJvcmRlclwiXHJcbiAgICAgICAgICAgICAgICBsb2coXCJodG1sMmNhbnZhczogUGFyc2U6IEV4Y2VwdGlvbiBjYXVnaHQgaW4gcmVuZGVyRm9ybVZhbHVlOiBcIiArIGUubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB2YXIgYm91bmRzID0gY29udGFpbmVyLnBhcnNlQm91bmRzKCk7XHJcbiAgICAgICAgd3JhcHBlci5zdHlsZS5wb3NpdGlvbiA9IFwiZml4ZWRcIjtcclxuICAgICAgICB3cmFwcGVyLnN0eWxlLmxlZnQgPSBib3VuZHMubGVmdCArIFwicHhcIjtcclxuICAgICAgICB3cmFwcGVyLnN0eWxlLnRvcCA9IGJvdW5kcy50b3AgKyBcInB4XCI7XHJcbiAgICAgICAgd3JhcHBlci50ZXh0Q29udGVudCA9IHZhbHVlO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQod3JhcHBlcik7XHJcbiAgICAgICAgdGhpcy5wYWludFRleHQobmV3IFRleHRDb250YWluZXIod3JhcHBlci5maXJzdENoaWxkLCBjb250YWluZXIpKTtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHdyYXBwZXIpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuTm9kZVBhcnNlci5wcm90b3R5cGUucGFpbnRUZXh0ID0gZnVuY3Rpb24oY29udGFpbmVyKSB7XHJcbiAgICBjb250YWluZXIuYXBwbHlUZXh0VHJhbnNmb3JtKCk7XHJcbiAgICB2YXIgY2hhcmFjdGVycyA9IHB1bnljb2RlLnVjczIuZGVjb2RlKGNvbnRhaW5lci5ub2RlLmRhdGEpO1xyXG4gICAgdmFyIHRleHRMaXN0ID0gKCF0aGlzLm9wdGlvbnMubGV0dGVyUmVuZGVyaW5nIHx8IG5vTGV0dGVyU3BhY2luZyhjb250YWluZXIpKSAmJiAhaGFzVW5pY29kZShjb250YWluZXIubm9kZS5kYXRhKSA/IGdldFdvcmRzKGNoYXJhY3RlcnMpIDogY2hhcmFjdGVycy5tYXAoZnVuY3Rpb24oY2hhcmFjdGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHB1bnljb2RlLnVjczIuZW5jb2RlKFtjaGFyYWN0ZXJdKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHZhciB3ZWlnaHQgPSBjb250YWluZXIucGFyZW50LmZvbnRXZWlnaHQoKTtcclxuICAgIHZhciBzaXplID0gY29udGFpbmVyLnBhcmVudC5jc3MoJ2ZvbnRTaXplJyk7XHJcbiAgICB2YXIgZmFtaWx5ID0gY29udGFpbmVyLnBhcmVudC5jc3MoJ2ZvbnRGYW1pbHknKTtcclxuICAgIHZhciBzaGFkb3dzID0gY29udGFpbmVyLnBhcmVudC5wYXJzZVRleHRTaGFkb3dzKCk7XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5mb250KGNvbnRhaW5lci5wYXJlbnQuY29sb3IoJ2NvbG9yJyksIGNvbnRhaW5lci5wYXJlbnQuY3NzKCdmb250U3R5bGUnKSwgY29udGFpbmVyLnBhcmVudC5jc3MoJ2ZvbnRWYXJpYW50JyksIHdlaWdodCwgc2l6ZSwgZmFtaWx5KTtcclxuICAgIGlmIChzaGFkb3dzLmxlbmd0aCkge1xyXG4gICAgICAgIC8vIFRPRE86IHN1cHBvcnQgbXVsdGlwbGUgdGV4dCBzaGFkb3dzXHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5mb250U2hhZG93KHNoYWRvd3NbMF0uY29sb3IsIHNoYWRvd3NbMF0ub2Zmc2V0WCwgc2hhZG93c1swXS5vZmZzZXRZLCBzaGFkb3dzWzBdLmJsdXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLmNsZWFyU2hhZG93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5yZW5kZXJlci5jbGlwKGNvbnRhaW5lci5wYXJlbnQuY2xpcCwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGV4dExpc3QubWFwKHRoaXMucGFyc2VUZXh0Qm91bmRzKGNvbnRhaW5lciksIHRoaXMpLmZvckVhY2goZnVuY3Rpb24oYm91bmRzLCBpbmRleCkge1xyXG4gICAgICAgICAgICBpZiAoYm91bmRzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnRleHQodGV4dExpc3RbaW5kZXhdLCBib3VuZHMubGVmdCwgYm91bmRzLmJvdHRvbSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclRleHREZWNvcmF0aW9uKGNvbnRhaW5lci5wYXJlbnQsIGJvdW5kcywgdGhpcy5mb250TWV0cmljcy5nZXRNZXRyaWNzKGZhbWlseSwgc2l6ZSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcbiAgICB9LCB0aGlzKTtcclxufTtcclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLnJlbmRlclRleHREZWNvcmF0aW9uID0gZnVuY3Rpb24oY29udGFpbmVyLCBib3VuZHMsIG1ldHJpY3MpIHtcclxuICAgIHN3aXRjaChjb250YWluZXIuY3NzKFwidGV4dERlY29yYXRpb25cIikuc3BsaXQoXCIgXCIpWzBdKSB7XHJcbiAgICBjYXNlIFwidW5kZXJsaW5lXCI6XHJcbiAgICAgICAgLy8gRHJhd3MgYSBsaW5lIGF0IHRoZSBiYXNlbGluZSBvZiB0aGUgZm9udFxyXG4gICAgICAgIC8vIFRPRE8gQXMgc29tZSBicm93c2VycyBkaXNwbGF5IHRoZSBsaW5lIGFzIG1vcmUgdGhhbiAxcHggaWYgdGhlIGZvbnQtc2l6ZSBpcyBiaWcsIG5lZWQgdG8gdGFrZSB0aGF0IGludG8gYWNjb3VudCBib3RoIGluIHBvc2l0aW9uIGFuZCBzaXplXHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZWN0YW5nbGUoYm91bmRzLmxlZnQsIE1hdGgucm91bmQoYm91bmRzLnRvcCArIG1ldHJpY3MuYmFzZWxpbmUgKyBtZXRyaWNzLmxpbmVXaWR0aCksIGJvdW5kcy53aWR0aCwgMSwgY29udGFpbmVyLmNvbG9yKFwiY29sb3JcIikpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSBcIm92ZXJsaW5lXCI6XHJcbiAgICAgICAgdGhpcy5yZW5kZXJlci5yZWN0YW5nbGUoYm91bmRzLmxlZnQsIE1hdGgucm91bmQoYm91bmRzLnRvcCksIGJvdW5kcy53aWR0aCwgMSwgY29udGFpbmVyLmNvbG9yKFwiY29sb3JcIikpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSBcImxpbmUtdGhyb3VnaFwiOlxyXG4gICAgICAgIC8vIFRPRE8gdHJ5IGFuZCBmaW5kIGV4YWN0IHBvc2l0aW9uIGZvciBsaW5lLXRocm91Z2hcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnJlY3RhbmdsZShib3VuZHMubGVmdCwgTWF0aC5jZWlsKGJvdW5kcy50b3AgKyBtZXRyaWNzLm1pZGRsZSArIG1ldHJpY3MubGluZVdpZHRoKSwgYm91bmRzLndpZHRoLCAxLCBjb250YWluZXIuY29sb3IoXCJjb2xvclwiKSk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbn07XHJcblxyXG52YXIgYm9yZGVyQ29sb3JUcmFuc2Zvcm1zID0ge1xyXG4gICAgaW5zZXQ6IFtcclxuICAgICAgICBbXCJkYXJrZW5cIiwgMC42MF0sXHJcbiAgICAgICAgW1wiZGFya2VuXCIsIDAuMTBdLFxyXG4gICAgICAgIFtcImRhcmtlblwiLCAwLjEwXSxcclxuICAgICAgICBbXCJkYXJrZW5cIiwgMC42MF1cclxuICAgIF1cclxufTtcclxuXHJcbk5vZGVQYXJzZXIucHJvdG90eXBlLnBhcnNlQm9yZGVycyA9IGZ1bmN0aW9uKGNvbnRhaW5lcikge1xyXG4gICAgdmFyIG5vZGVCb3VuZHMgPSBjb250YWluZXIucGFyc2VCb3VuZHMoKTtcclxuICAgIHZhciByYWRpdXMgPSBnZXRCb3JkZXJSYWRpdXNEYXRhKGNvbnRhaW5lcik7XHJcbiAgICB2YXIgYm9yZGVycyA9IFtcIlRvcFwiLCBcIlJpZ2h0XCIsIFwiQm90dG9tXCIsIFwiTGVmdFwiXS5tYXAoZnVuY3Rpb24oc2lkZSwgaW5kZXgpIHtcclxuICAgICAgICB2YXIgc3R5bGUgPSBjb250YWluZXIuY3NzKCdib3JkZXInICsgc2lkZSArICdTdHlsZScpO1xyXG4gICAgICAgIHZhciBjb2xvciA9IGNvbnRhaW5lci5jb2xvcignYm9yZGVyJyArIHNpZGUgKyAnQ29sb3InKTtcclxuICAgICAgICBpZiAoc3R5bGUgPT09IFwiaW5zZXRcIiAmJiBjb2xvci5pc0JsYWNrKCkpIHtcclxuICAgICAgICAgICAgY29sb3IgPSBuZXcgQ29sb3IoWzI1NSwgMjU1LCAyNTUsIGNvbG9yLmFdKTsgLy8gdGhpcyBpcyB3cm9uZywgYnV0XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb2xvclRyYW5zZm9ybSA9IGJvcmRlckNvbG9yVHJhbnNmb3Jtc1tzdHlsZV0gPyBib3JkZXJDb2xvclRyYW5zZm9ybXNbc3R5bGVdW2luZGV4XSA6IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgd2lkdGg6IGNvbnRhaW5lci5jc3NJbnQoJ2JvcmRlcicgKyBzaWRlICsgJ1dpZHRoJyksXHJcbiAgICAgICAgICAgIGNvbG9yOiBjb2xvclRyYW5zZm9ybSA/IGNvbG9yW2NvbG9yVHJhbnNmb3JtWzBdXShjb2xvclRyYW5zZm9ybVsxXSkgOiBjb2xvcixcclxuICAgICAgICAgICAgYXJnczogbnVsbFxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuICAgIHZhciBib3JkZXJQb2ludHMgPSBjYWxjdWxhdGVDdXJ2ZVBvaW50cyhub2RlQm91bmRzLCByYWRpdXMsIGJvcmRlcnMpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgY2xpcDogdGhpcy5wYXJzZUJhY2tncm91bmRDbGlwKGNvbnRhaW5lciwgYm9yZGVyUG9pbnRzLCBib3JkZXJzLCByYWRpdXMsIG5vZGVCb3VuZHMpLFxyXG4gICAgICAgIGJvcmRlcnM6IGNhbGN1bGF0ZUJvcmRlcnMoYm9yZGVycywgbm9kZUJvdW5kcywgYm9yZGVyUG9pbnRzLCByYWRpdXMpXHJcbiAgICB9O1xyXG59O1xyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlQm9yZGVycyhib3JkZXJzLCBub2RlQm91bmRzLCBib3JkZXJQb2ludHMsIHJhZGl1cykge1xyXG4gICAgcmV0dXJuIGJvcmRlcnMubWFwKGZ1bmN0aW9uKGJvcmRlciwgYm9yZGVyU2lkZSkge1xyXG4gICAgICAgIGlmIChib3JkZXIud2lkdGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBieCA9IG5vZGVCb3VuZHMubGVmdDtcclxuICAgICAgICAgICAgdmFyIGJ5ID0gbm9kZUJvdW5kcy50b3A7XHJcbiAgICAgICAgICAgIHZhciBidyA9IG5vZGVCb3VuZHMud2lkdGg7XHJcbiAgICAgICAgICAgIHZhciBiaCA9IG5vZGVCb3VuZHMuaGVpZ2h0IC0gKGJvcmRlcnNbMl0ud2lkdGgpO1xyXG5cclxuICAgICAgICAgICAgc3dpdGNoKGJvcmRlclNpZGUpIHtcclxuICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgLy8gdG9wIGJvcmRlclxyXG4gICAgICAgICAgICAgICAgYmggPSBib3JkZXJzWzBdLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYm9yZGVyLmFyZ3MgPSBkcmF3U2lkZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMxOiBbYngsIGJ5XSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYzI6IFtieCArIGJ3LCBieV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMzOiBbYnggKyBidyAtIGJvcmRlcnNbMV0ud2lkdGgsIGJ5ICsgYmhdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjNDogW2J4ICsgYm9yZGVyc1szXS53aWR0aCwgYnkgKyBiaF1cclxuICAgICAgICAgICAgICAgICAgICB9LCByYWRpdXNbMF0sIHJhZGl1c1sxXSxcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJQb2ludHMudG9wTGVmdE91dGVyLCBib3JkZXJQb2ludHMudG9wTGVmdElubmVyLCBib3JkZXJQb2ludHMudG9wUmlnaHRPdXRlciwgYm9yZGVyUG9pbnRzLnRvcFJpZ2h0SW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgIC8vIHJpZ2h0IGJvcmRlclxyXG4gICAgICAgICAgICAgICAgYnggPSBub2RlQm91bmRzLmxlZnQgKyBub2RlQm91bmRzLndpZHRoIC0gKGJvcmRlcnNbMV0ud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgYncgPSBib3JkZXJzWzFdLndpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgIGJvcmRlci5hcmdzID0gZHJhd1NpZGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjMTogW2J4ICsgYncsIGJ5XSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYzI6IFtieCArIGJ3LCBieSArIGJoICsgYm9yZGVyc1syXS53aWR0aF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMzOiBbYngsIGJ5ICsgYmhdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjNDogW2J4LCBieSArIGJvcmRlcnNbMF0ud2lkdGhdXHJcbiAgICAgICAgICAgICAgICAgICAgfSwgcmFkaXVzWzFdLCByYWRpdXNbMl0sXHJcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyUG9pbnRzLnRvcFJpZ2h0T3V0ZXIsIGJvcmRlclBvaW50cy50b3BSaWdodElubmVyLCBib3JkZXJQb2ludHMuYm90dG9tUmlnaHRPdXRlciwgYm9yZGVyUG9pbnRzLmJvdHRvbVJpZ2h0SW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgIC8vIGJvdHRvbSBib3JkZXJcclxuICAgICAgICAgICAgICAgIGJ5ID0gKGJ5ICsgbm9kZUJvdW5kcy5oZWlnaHQpIC0gKGJvcmRlcnNbMl0ud2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgYmggPSBib3JkZXJzWzJdLndpZHRoO1xyXG4gICAgICAgICAgICAgICAgYm9yZGVyLmFyZ3MgPSBkcmF3U2lkZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMxOiBbYnggKyBidywgYnkgKyBiaF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMyOiBbYngsIGJ5ICsgYmhdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjMzogW2J4ICsgYm9yZGVyc1szXS53aWR0aCwgYnldLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjNDogW2J4ICsgYncgLSBib3JkZXJzWzNdLndpZHRoLCBieV1cclxuICAgICAgICAgICAgICAgICAgICB9LCByYWRpdXNbMl0sIHJhZGl1c1szXSxcclxuICAgICAgICAgICAgICAgICAgICBib3JkZXJQb2ludHMuYm90dG9tUmlnaHRPdXRlciwgYm9yZGVyUG9pbnRzLmJvdHRvbVJpZ2h0SW5uZXIsIGJvcmRlclBvaW50cy5ib3R0b21MZWZ0T3V0ZXIsIGJvcmRlclBvaW50cy5ib3R0b21MZWZ0SW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgIC8vIGxlZnQgYm9yZGVyXHJcbiAgICAgICAgICAgICAgICBidyA9IGJvcmRlcnNbM10ud2lkdGg7XHJcbiAgICAgICAgICAgICAgICBib3JkZXIuYXJncyA9IGRyYXdTaWRlKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYzE6IFtieCwgYnkgKyBiaCArIGJvcmRlcnNbMl0ud2lkdGhdLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjMjogW2J4LCBieV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMzOiBbYnggKyBidywgYnkgKyBib3JkZXJzWzBdLndpZHRoXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYzQ6IFtieCArIGJ3LCBieSArIGJoXVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHJhZGl1c1szXSwgcmFkaXVzWzBdLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvcmRlclBvaW50cy5ib3R0b21MZWZ0T3V0ZXIsIGJvcmRlclBvaW50cy5ib3R0b21MZWZ0SW5uZXIsIGJvcmRlclBvaW50cy50b3BMZWZ0T3V0ZXIsIGJvcmRlclBvaW50cy50b3BMZWZ0SW5uZXIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJvcmRlcjtcclxuICAgIH0pO1xyXG59XHJcblxyXG5Ob2RlUGFyc2VyLnByb3RvdHlwZS5wYXJzZUJhY2tncm91bmRDbGlwID0gZnVuY3Rpb24oY29udGFpbmVyLCBib3JkZXJQb2ludHMsIGJvcmRlcnMsIHJhZGl1cywgYm91bmRzKSB7XHJcbiAgICB2YXIgYmFja2dyb3VuZENsaXAgPSBjb250YWluZXIuY3NzKCdiYWNrZ3JvdW5kQ2xpcCcpLFxyXG4gICAgICAgIGJvcmRlckFyZ3MgPSBbXTtcclxuXHJcbiAgICBzd2l0Y2goYmFja2dyb3VuZENsaXApIHtcclxuICAgIGNhc2UgXCJjb250ZW50LWJveFwiOlxyXG4gICAgY2FzZSBcInBhZGRpbmctYm94XCI6XHJcbiAgICAgICAgcGFyc2VDb3JuZXIoYm9yZGVyQXJncywgcmFkaXVzWzBdLCByYWRpdXNbMV0sIGJvcmRlclBvaW50cy50b3BMZWZ0SW5uZXIsIGJvcmRlclBvaW50cy50b3BSaWdodElubmVyLCBib3VuZHMubGVmdCArIGJvcmRlcnNbM10ud2lkdGgsIGJvdW5kcy50b3AgKyBib3JkZXJzWzBdLndpZHRoKTtcclxuICAgICAgICBwYXJzZUNvcm5lcihib3JkZXJBcmdzLCByYWRpdXNbMV0sIHJhZGl1c1syXSwgYm9yZGVyUG9pbnRzLnRvcFJpZ2h0SW5uZXIsIGJvcmRlclBvaW50cy5ib3R0b21SaWdodElubmVyLCBib3VuZHMubGVmdCArIGJvdW5kcy53aWR0aCAtIGJvcmRlcnNbMV0ud2lkdGgsIGJvdW5kcy50b3AgKyBib3JkZXJzWzBdLndpZHRoKTtcclxuICAgICAgICBwYXJzZUNvcm5lcihib3JkZXJBcmdzLCByYWRpdXNbMl0sIHJhZGl1c1szXSwgYm9yZGVyUG9pbnRzLmJvdHRvbVJpZ2h0SW5uZXIsIGJvcmRlclBvaW50cy5ib3R0b21MZWZ0SW5uZXIsIGJvdW5kcy5sZWZ0ICsgYm91bmRzLndpZHRoIC0gYm9yZGVyc1sxXS53aWR0aCwgYm91bmRzLnRvcCArIGJvdW5kcy5oZWlnaHQgLSBib3JkZXJzWzJdLndpZHRoKTtcclxuICAgICAgICBwYXJzZUNvcm5lcihib3JkZXJBcmdzLCByYWRpdXNbM10sIHJhZGl1c1swXSwgYm9yZGVyUG9pbnRzLmJvdHRvbUxlZnRJbm5lciwgYm9yZGVyUG9pbnRzLnRvcExlZnRJbm5lciwgYm91bmRzLmxlZnQgKyBib3JkZXJzWzNdLndpZHRoLCBib3VuZHMudG9wICsgYm91bmRzLmhlaWdodCAtIGJvcmRlcnNbMl0ud2lkdGgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcGFyc2VDb3JuZXIoYm9yZGVyQXJncywgcmFkaXVzWzBdLCByYWRpdXNbMV0sIGJvcmRlclBvaW50cy50b3BMZWZ0T3V0ZXIsIGJvcmRlclBvaW50cy50b3BSaWdodE91dGVyLCBib3VuZHMubGVmdCwgYm91bmRzLnRvcCk7XHJcbiAgICAgICAgcGFyc2VDb3JuZXIoYm9yZGVyQXJncywgcmFkaXVzWzFdLCByYWRpdXNbMl0sIGJvcmRlclBvaW50cy50b3BSaWdodE91dGVyLCBib3JkZXJQb2ludHMuYm90dG9tUmlnaHRPdXRlciwgYm91bmRzLmxlZnQgKyBib3VuZHMud2lkdGgsIGJvdW5kcy50b3ApO1xyXG4gICAgICAgIHBhcnNlQ29ybmVyKGJvcmRlckFyZ3MsIHJhZGl1c1syXSwgcmFkaXVzWzNdLCBib3JkZXJQb2ludHMuYm90dG9tUmlnaHRPdXRlciwgYm9yZGVyUG9pbnRzLmJvdHRvbUxlZnRPdXRlciwgYm91bmRzLmxlZnQgKyBib3VuZHMud2lkdGgsIGJvdW5kcy50b3AgKyBib3VuZHMuaGVpZ2h0KTtcclxuICAgICAgICBwYXJzZUNvcm5lcihib3JkZXJBcmdzLCByYWRpdXNbM10sIHJhZGl1c1swXSwgYm9yZGVyUG9pbnRzLmJvdHRvbUxlZnRPdXRlciwgYm9yZGVyUG9pbnRzLnRvcExlZnRPdXRlciwgYm91bmRzLmxlZnQsIGJvdW5kcy50b3AgKyBib3VuZHMuaGVpZ2h0KTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYm9yZGVyQXJncztcclxufTtcclxuXHJcbmZ1bmN0aW9uIGdldEN1cnZlUG9pbnRzKHgsIHksIHIxLCByMikge1xyXG4gICAgdmFyIGthcHBhID0gNCAqICgoTWF0aC5zcXJ0KDIpIC0gMSkgLyAzKTtcclxuICAgIHZhciBveCA9IChyMSkgKiBrYXBwYSwgLy8gY29udHJvbCBwb2ludCBvZmZzZXQgaG9yaXpvbnRhbFxyXG4gICAgICAgIG95ID0gKHIyKSAqIGthcHBhLCAvLyBjb250cm9sIHBvaW50IG9mZnNldCB2ZXJ0aWNhbFxyXG4gICAgICAgIHhtID0geCArIHIxLCAvLyB4LW1pZGRsZVxyXG4gICAgICAgIHltID0geSArIHIyOyAvLyB5LW1pZGRsZVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0b3BMZWZ0OiBiZXppZXJDdXJ2ZSh7eDogeCwgeTogeW19LCB7eDogeCwgeTogeW0gLSBveX0sIHt4OiB4bSAtIG94LCB5OiB5fSwge3g6IHhtLCB5OiB5fSksXHJcbiAgICAgICAgdG9wUmlnaHQ6IGJlemllckN1cnZlKHt4OiB4LCB5OiB5fSwge3g6IHggKyBveCx5OiB5fSwge3g6IHhtLCB5OiB5bSAtIG95fSwge3g6IHhtLCB5OiB5bX0pLFxyXG4gICAgICAgIGJvdHRvbVJpZ2h0OiBiZXppZXJDdXJ2ZSh7eDogeG0sIHk6IHl9LCB7eDogeG0sIHk6IHkgKyBveX0sIHt4OiB4ICsgb3gsIHk6IHltfSwge3g6IHgsIHk6IHltfSksXHJcbiAgICAgICAgYm90dG9tTGVmdDogYmV6aWVyQ3VydmUoe3g6IHhtLCB5OiB5bX0sIHt4OiB4bSAtIG94LCB5OiB5bX0sIHt4OiB4LCB5OiB5ICsgb3l9LCB7eDogeCwgeTp5fSlcclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNhbGN1bGF0ZUN1cnZlUG9pbnRzKGJvdW5kcywgYm9yZGVyUmFkaXVzLCBib3JkZXJzKSB7XHJcbiAgICB2YXIgeCA9IGJvdW5kcy5sZWZ0LFxyXG4gICAgICAgIHkgPSBib3VuZHMudG9wLFxyXG4gICAgICAgIHdpZHRoID0gYm91bmRzLndpZHRoLFxyXG4gICAgICAgIGhlaWdodCA9IGJvdW5kcy5oZWlnaHQsXHJcblxyXG4gICAgICAgIHRsaCA9IGJvcmRlclJhZGl1c1swXVswXSA8IHdpZHRoIC8gMiA/IGJvcmRlclJhZGl1c1swXVswXSA6IHdpZHRoIC8gMixcclxuICAgICAgICB0bHYgPSBib3JkZXJSYWRpdXNbMF1bMV0gPCBoZWlnaHQgLyAyID8gYm9yZGVyUmFkaXVzWzBdWzFdIDogaGVpZ2h0IC8gMixcclxuICAgICAgICB0cmggPSBib3JkZXJSYWRpdXNbMV1bMF0gPCB3aWR0aCAvIDIgPyBib3JkZXJSYWRpdXNbMV1bMF0gOiB3aWR0aCAvIDIsXHJcbiAgICAgICAgdHJ2ID0gYm9yZGVyUmFkaXVzWzFdWzFdIDwgaGVpZ2h0IC8gMiA/IGJvcmRlclJhZGl1c1sxXVsxXSA6IGhlaWdodCAvIDIsXHJcbiAgICAgICAgYnJoID0gYm9yZGVyUmFkaXVzWzJdWzBdIDwgd2lkdGggLyAyID8gYm9yZGVyUmFkaXVzWzJdWzBdIDogd2lkdGggLyAyLFxyXG4gICAgICAgIGJydiA9IGJvcmRlclJhZGl1c1syXVsxXSA8IGhlaWdodCAvIDIgPyBib3JkZXJSYWRpdXNbMl1bMV0gOiBoZWlnaHQgLyAyLFxyXG4gICAgICAgIGJsaCA9IGJvcmRlclJhZGl1c1szXVswXSA8IHdpZHRoIC8gMiA/IGJvcmRlclJhZGl1c1szXVswXSA6IHdpZHRoIC8gMixcclxuICAgICAgICBibHYgPSBib3JkZXJSYWRpdXNbM11bMV0gPCBoZWlnaHQgLyAyID8gYm9yZGVyUmFkaXVzWzNdWzFdIDogaGVpZ2h0IC8gMjtcclxuXHJcbiAgICB2YXIgdG9wV2lkdGggPSB3aWR0aCAtIHRyaCxcclxuICAgICAgICByaWdodEhlaWdodCA9IGhlaWdodCAtIGJydixcclxuICAgICAgICBib3R0b21XaWR0aCA9IHdpZHRoIC0gYnJoLFxyXG4gICAgICAgIGxlZnRIZWlnaHQgPSBoZWlnaHQgLSBibHY7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0b3BMZWZ0T3V0ZXI6IGdldEN1cnZlUG9pbnRzKHgsIHksIHRsaCwgdGx2KS50b3BMZWZ0LnN1YmRpdmlkZSgwLjUpLFxyXG4gICAgICAgIHRvcExlZnRJbm5lcjogZ2V0Q3VydmVQb2ludHMoeCArIGJvcmRlcnNbM10ud2lkdGgsIHkgKyBib3JkZXJzWzBdLndpZHRoLCBNYXRoLm1heCgwLCB0bGggLSBib3JkZXJzWzNdLndpZHRoKSwgTWF0aC5tYXgoMCwgdGx2IC0gYm9yZGVyc1swXS53aWR0aCkpLnRvcExlZnQuc3ViZGl2aWRlKDAuNSksXHJcbiAgICAgICAgdG9wUmlnaHRPdXRlcjogZ2V0Q3VydmVQb2ludHMoeCArIHRvcFdpZHRoLCB5LCB0cmgsIHRydikudG9wUmlnaHQuc3ViZGl2aWRlKDAuNSksXHJcbiAgICAgICAgdG9wUmlnaHRJbm5lcjogZ2V0Q3VydmVQb2ludHMoeCArIE1hdGgubWluKHRvcFdpZHRoLCB3aWR0aCArIGJvcmRlcnNbM10ud2lkdGgpLCB5ICsgYm9yZGVyc1swXS53aWR0aCwgKHRvcFdpZHRoID4gd2lkdGggKyBib3JkZXJzWzNdLndpZHRoKSA/IDAgOnRyaCAtIGJvcmRlcnNbM10ud2lkdGgsIHRydiAtIGJvcmRlcnNbMF0ud2lkdGgpLnRvcFJpZ2h0LnN1YmRpdmlkZSgwLjUpLFxyXG4gICAgICAgIGJvdHRvbVJpZ2h0T3V0ZXI6IGdldEN1cnZlUG9pbnRzKHggKyBib3R0b21XaWR0aCwgeSArIHJpZ2h0SGVpZ2h0LCBicmgsIGJydikuYm90dG9tUmlnaHQuc3ViZGl2aWRlKDAuNSksXHJcbiAgICAgICAgYm90dG9tUmlnaHRJbm5lcjogZ2V0Q3VydmVQb2ludHMoeCArIE1hdGgubWluKGJvdHRvbVdpZHRoLCB3aWR0aCAtIGJvcmRlcnNbM10ud2lkdGgpLCB5ICsgTWF0aC5taW4ocmlnaHRIZWlnaHQsIGhlaWdodCArIGJvcmRlcnNbMF0ud2lkdGgpLCBNYXRoLm1heCgwLCBicmggLSBib3JkZXJzWzFdLndpZHRoKSwgIGJydiAtIGJvcmRlcnNbMl0ud2lkdGgpLmJvdHRvbVJpZ2h0LnN1YmRpdmlkZSgwLjUpLFxyXG4gICAgICAgIGJvdHRvbUxlZnRPdXRlcjogZ2V0Q3VydmVQb2ludHMoeCwgeSArIGxlZnRIZWlnaHQsIGJsaCwgYmx2KS5ib3R0b21MZWZ0LnN1YmRpdmlkZSgwLjUpLFxyXG4gICAgICAgIGJvdHRvbUxlZnRJbm5lcjogZ2V0Q3VydmVQb2ludHMoeCArIGJvcmRlcnNbM10ud2lkdGgsIHkgKyBsZWZ0SGVpZ2h0LCBNYXRoLm1heCgwLCBibGggLSBib3JkZXJzWzNdLndpZHRoKSwgYmx2IC0gYm9yZGVyc1syXS53aWR0aCkuYm90dG9tTGVmdC5zdWJkaXZpZGUoMC41KVxyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gYmV6aWVyQ3VydmUoc3RhcnQsIHN0YXJ0Q29udHJvbCwgZW5kQ29udHJvbCwgZW5kKSB7XHJcbiAgICB2YXIgbGVycCA9IGZ1bmN0aW9uIChhLCBiLCB0KSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgeDogYS54ICsgKGIueCAtIGEueCkgKiB0LFxyXG4gICAgICAgICAgICB5OiBhLnkgKyAoYi55IC0gYS55KSAqIHRcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHN0YXJ0OiBzdGFydCxcclxuICAgICAgICBzdGFydENvbnRyb2w6IHN0YXJ0Q29udHJvbCxcclxuICAgICAgICBlbmRDb250cm9sOiBlbmRDb250cm9sLFxyXG4gICAgICAgIGVuZDogZW5kLFxyXG4gICAgICAgIHN1YmRpdmlkZTogZnVuY3Rpb24odCkge1xyXG4gICAgICAgICAgICB2YXIgYWIgPSBsZXJwKHN0YXJ0LCBzdGFydENvbnRyb2wsIHQpLFxyXG4gICAgICAgICAgICAgICAgYmMgPSBsZXJwKHN0YXJ0Q29udHJvbCwgZW5kQ29udHJvbCwgdCksXHJcbiAgICAgICAgICAgICAgICBjZCA9IGxlcnAoZW5kQ29udHJvbCwgZW5kLCB0KSxcclxuICAgICAgICAgICAgICAgIGFiYmMgPSBsZXJwKGFiLCBiYywgdCksXHJcbiAgICAgICAgICAgICAgICBiY2NkID0gbGVycChiYywgY2QsIHQpLFxyXG4gICAgICAgICAgICAgICAgZGVzdCA9IGxlcnAoYWJiYywgYmNjZCwgdCk7XHJcbiAgICAgICAgICAgIHJldHVybiBbYmV6aWVyQ3VydmUoc3RhcnQsIGFiLCBhYmJjLCBkZXN0KSwgYmV6aWVyQ3VydmUoZGVzdCwgYmNjZCwgY2QsIGVuZCldO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY3VydmVUbzogZnVuY3Rpb24oYm9yZGVyQXJncykge1xyXG4gICAgICAgICAgICBib3JkZXJBcmdzLnB1c2goW1wiYmV6aWVyQ3VydmVcIiwgc3RhcnRDb250cm9sLngsIHN0YXJ0Q29udHJvbC55LCBlbmRDb250cm9sLngsIGVuZENvbnRyb2wueSwgZW5kLngsIGVuZC55XSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBjdXJ2ZVRvUmV2ZXJzZWQ6IGZ1bmN0aW9uKGJvcmRlckFyZ3MpIHtcclxuICAgICAgICAgICAgYm9yZGVyQXJncy5wdXNoKFtcImJlemllckN1cnZlXCIsIGVuZENvbnRyb2wueCwgZW5kQ29udHJvbC55LCBzdGFydENvbnRyb2wueCwgc3RhcnRDb250cm9sLnksIHN0YXJ0LngsIHN0YXJ0LnldKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBkcmF3U2lkZShib3JkZXJEYXRhLCByYWRpdXMxLCByYWRpdXMyLCBvdXRlcjEsIGlubmVyMSwgb3V0ZXIyLCBpbm5lcjIpIHtcclxuICAgIHZhciBib3JkZXJBcmdzID0gW107XHJcblxyXG4gICAgaWYgKHJhZGl1czFbMF0gPiAwIHx8IHJhZGl1czFbMV0gPiAwKSB7XHJcbiAgICAgICAgYm9yZGVyQXJncy5wdXNoKFtcImxpbmVcIiwgb3V0ZXIxWzFdLnN0YXJ0LngsIG91dGVyMVsxXS5zdGFydC55XSk7XHJcbiAgICAgICAgb3V0ZXIxWzFdLmN1cnZlVG8oYm9yZGVyQXJncyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJvcmRlckFyZ3MucHVzaChbIFwibGluZVwiLCBib3JkZXJEYXRhLmMxWzBdLCBib3JkZXJEYXRhLmMxWzFdXSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJhZGl1czJbMF0gPiAwIHx8IHJhZGl1czJbMV0gPiAwKSB7XHJcbiAgICAgICAgYm9yZGVyQXJncy5wdXNoKFtcImxpbmVcIiwgb3V0ZXIyWzBdLnN0YXJ0LngsIG91dGVyMlswXS5zdGFydC55XSk7XHJcbiAgICAgICAgb3V0ZXIyWzBdLmN1cnZlVG8oYm9yZGVyQXJncyk7XHJcbiAgICAgICAgYm9yZGVyQXJncy5wdXNoKFtcImxpbmVcIiwgaW5uZXIyWzBdLmVuZC54LCBpbm5lcjJbMF0uZW5kLnldKTtcclxuICAgICAgICBpbm5lcjJbMF0uY3VydmVUb1JldmVyc2VkKGJvcmRlckFyZ3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBib3JkZXJBcmdzLnB1c2goW1wibGluZVwiLCBib3JkZXJEYXRhLmMyWzBdLCBib3JkZXJEYXRhLmMyWzFdXSk7XHJcbiAgICAgICAgYm9yZGVyQXJncy5wdXNoKFtcImxpbmVcIiwgYm9yZGVyRGF0YS5jM1swXSwgYm9yZGVyRGF0YS5jM1sxXV0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChyYWRpdXMxWzBdID4gMCB8fCByYWRpdXMxWzFdID4gMCkge1xyXG4gICAgICAgIGJvcmRlckFyZ3MucHVzaChbXCJsaW5lXCIsIGlubmVyMVsxXS5lbmQueCwgaW5uZXIxWzFdLmVuZC55XSk7XHJcbiAgICAgICAgaW5uZXIxWzFdLmN1cnZlVG9SZXZlcnNlZChib3JkZXJBcmdzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYm9yZGVyQXJncy5wdXNoKFtcImxpbmVcIiwgYm9yZGVyRGF0YS5jNFswXSwgYm9yZGVyRGF0YS5jNFsxXV0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBib3JkZXJBcmdzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwYXJzZUNvcm5lcihib3JkZXJBcmdzLCByYWRpdXMxLCByYWRpdXMyLCBjb3JuZXIxLCBjb3JuZXIyLCB4LCB5KSB7XHJcbiAgICBpZiAocmFkaXVzMVswXSA+IDAgfHwgcmFkaXVzMVsxXSA+IDApIHtcclxuICAgICAgICBib3JkZXJBcmdzLnB1c2goW1wibGluZVwiLCBjb3JuZXIxWzBdLnN0YXJ0LngsIGNvcm5lcjFbMF0uc3RhcnQueV0pO1xyXG4gICAgICAgIGNvcm5lcjFbMF0uY3VydmVUbyhib3JkZXJBcmdzKTtcclxuICAgICAgICBjb3JuZXIxWzFdLmN1cnZlVG8oYm9yZGVyQXJncyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJvcmRlckFyZ3MucHVzaChbXCJsaW5lXCIsIHgsIHldKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocmFkaXVzMlswXSA+IDAgfHwgcmFkaXVzMlsxXSA+IDApIHtcclxuICAgICAgICBib3JkZXJBcmdzLnB1c2goW1wibGluZVwiLCBjb3JuZXIyWzBdLnN0YXJ0LngsIGNvcm5lcjJbMF0uc3RhcnQueV0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBuZWdhdGl2ZVpJbmRleChjb250YWluZXIpIHtcclxuICAgIHJldHVybiBjb250YWluZXIuY3NzSW50KFwiekluZGV4XCIpIDwgMDtcclxufVxyXG5cclxuZnVuY3Rpb24gcG9zaXRpdmVaSW5kZXgoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gY29udGFpbmVyLmNzc0ludChcInpJbmRleFwiKSA+IDA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHpJbmRleDAoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gY29udGFpbmVyLmNzc0ludChcInpJbmRleFwiKSA9PT0gMDtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5saW5lTGV2ZWwoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gW1wiaW5saW5lXCIsIFwiaW5saW5lLWJsb2NrXCIsIFwiaW5saW5lLXRhYmxlXCJdLmluZGV4T2YoY29udGFpbmVyLmNzcyhcImRpc3BsYXlcIikpICE9PSAtMTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNTdGFja2luZ0NvbnRleHQoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gKGNvbnRhaW5lciBpbnN0YW5jZW9mIFN0YWNraW5nQ29udGV4dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhc1RleHQoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gY29udGFpbmVyLm5vZGUuZGF0YS50cmltKCkubGVuZ3RoID4gMDtcclxufVxyXG5cclxuZnVuY3Rpb24gbm9MZXR0ZXJTcGFjaW5nKGNvbnRhaW5lcikge1xyXG4gICAgcmV0dXJuICgvXihub3JtYWx8bm9uZXwwcHgpJC8udGVzdChjb250YWluZXIucGFyZW50LmNzcyhcImxldHRlclNwYWNpbmdcIikpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Qm9yZGVyUmFkaXVzRGF0YShjb250YWluZXIpIHtcclxuICAgIHJldHVybiBbXCJUb3BMZWZ0XCIsIFwiVG9wUmlnaHRcIiwgXCJCb3R0b21SaWdodFwiLCBcIkJvdHRvbUxlZnRcIl0ubWFwKGZ1bmN0aW9uKHNpZGUpIHtcclxuICAgICAgICB2YXIgdmFsdWUgPSBjb250YWluZXIuY3NzKCdib3JkZXInICsgc2lkZSArICdSYWRpdXMnKTtcclxuICAgICAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoXCIgXCIpO1xyXG4gICAgICAgIGlmIChhcnIubGVuZ3RoIDw9IDEpIHtcclxuICAgICAgICAgICAgYXJyWzFdID0gYXJyWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXJyLm1hcChhc0ludCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyYWJsZU5vZGUobm9kZSkge1xyXG4gICAgcmV0dXJuIChub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSB8fCBub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzUG9zaXRpb25lZEZvclN0YWNraW5nKGNvbnRhaW5lcikge1xyXG4gICAgdmFyIHBvc2l0aW9uID0gY29udGFpbmVyLmNzcyhcInBvc2l0aW9uXCIpO1xyXG4gICAgdmFyIHpJbmRleCA9IChbXCJhYnNvbHV0ZVwiLCBcInJlbGF0aXZlXCIsIFwiZml4ZWRcIl0uaW5kZXhPZihwb3NpdGlvbikgIT09IC0xKSA/IGNvbnRhaW5lci5jc3MoXCJ6SW5kZXhcIikgOiBcImF1dG9cIjtcclxuICAgIHJldHVybiB6SW5kZXggIT09IFwiYXV0b1wiO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1Bvc2l0aW9uZWQoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gY29udGFpbmVyLmNzcyhcInBvc2l0aW9uXCIpICE9PSBcInN0YXRpY1wiO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0Zsb2F0aW5nKGNvbnRhaW5lcikge1xyXG4gICAgcmV0dXJuIGNvbnRhaW5lci5jc3MoXCJmbG9hdFwiKSAhPT0gXCJub25lXCI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzSW5saW5lQmxvY2soY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gW1wiaW5saW5lLWJsb2NrXCIsIFwiaW5saW5lLXRhYmxlXCJdLmluZGV4T2YoY29udGFpbmVyLmNzcyhcImRpc3BsYXlcIikpICE9PSAtMTtcclxufVxyXG5cclxuZnVuY3Rpb24gbm90KGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgY29udGV4dCA9IHRoaXM7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICFjYWxsYmFjay5hcHBseShjb250ZXh0LCBhcmd1bWVudHMpO1xyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNFbGVtZW50KGNvbnRhaW5lcikge1xyXG4gICAgcmV0dXJuIGNvbnRhaW5lci5ub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNQc2V1ZG9FbGVtZW50KGNvbnRhaW5lcikge1xyXG4gICAgcmV0dXJuIGNvbnRhaW5lci5pc1BzZXVkb0VsZW1lbnQgPT09IHRydWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVGV4dE5vZGUoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gY29udGFpbmVyLm5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFO1xyXG59XHJcblxyXG5mdW5jdGlvbiB6SW5kZXhTb3J0KGNvbnRleHRzKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgIHJldHVybiAoYS5jc3NJbnQoXCJ6SW5kZXhcIikgKyAoY29udGV4dHMuaW5kZXhPZihhKSAvIGNvbnRleHRzLmxlbmd0aCkpIC0gKGIuY3NzSW50KFwiekluZGV4XCIpICsgKGNvbnRleHRzLmluZGV4T2YoYikgLyBjb250ZXh0cy5sZW5ndGgpKTtcclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhc09wYWNpdHkoY29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gY29udGFpbmVyLmdldE9wYWNpdHkoKSA8IDE7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFzSW50KHZhbHVlKSB7XHJcbiAgICByZXR1cm4gcGFyc2VJbnQodmFsdWUsIDEwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0V2lkdGgoYm9yZGVyKSB7XHJcbiAgICByZXR1cm4gYm9yZGVyLndpZHRoO1xyXG59XHJcblxyXG5mdW5jdGlvbiBub25JZ25vcmVkRWxlbWVudChub2RlQ29udGFpbmVyKSB7XHJcbiAgICByZXR1cm4gKG5vZGVDb250YWluZXIubm9kZS5ub2RlVHlwZSAhPT0gTm9kZS5FTEVNRU5UX05PREUgfHwgW1wiU0NSSVBUXCIsIFwiSEVBRFwiLCBcIlRJVExFXCIsIFwiT0JKRUNUXCIsIFwiQlJcIiwgXCJPUFRJT05cIl0uaW5kZXhPZihub2RlQ29udGFpbmVyLm5vZGUubm9kZU5hbWUpID09PSAtMSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZsYXR0ZW4oYXJyYXlzKSB7XHJcbiAgICByZXR1cm4gW10uY29uY2F0LmFwcGx5KFtdLCBhcnJheXMpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdHJpcFF1b3Rlcyhjb250ZW50KSB7XHJcbiAgICB2YXIgZmlyc3QgPSBjb250ZW50LnN1YnN0cigwLCAxKTtcclxuICAgIHJldHVybiAoZmlyc3QgPT09IGNvbnRlbnQuc3Vic3RyKGNvbnRlbnQubGVuZ3RoIC0gMSkgJiYgZmlyc3QubWF0Y2goLyd8XCIvKSkgPyBjb250ZW50LnN1YnN0cigxLCBjb250ZW50Lmxlbmd0aCAtIDIpIDogY29udGVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0V29yZHMoY2hhcmFjdGVycykge1xyXG4gICAgdmFyIHdvcmRzID0gW10sIGkgPSAwLCBvbldvcmRCb3VuZGFyeSA9IGZhbHNlLCB3b3JkO1xyXG4gICAgd2hpbGUoY2hhcmFjdGVycy5sZW5ndGgpIHtcclxuICAgICAgICBpZiAoaXNXb3JkQm91bmRhcnkoY2hhcmFjdGVyc1tpXSkgPT09IG9uV29yZEJvdW5kYXJ5KSB7XHJcbiAgICAgICAgICAgIHdvcmQgPSBjaGFyYWN0ZXJzLnNwbGljZSgwLCBpKTtcclxuICAgICAgICAgICAgaWYgKHdvcmQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICB3b3Jkcy5wdXNoKHB1bnljb2RlLnVjczIuZW5jb2RlKHdvcmQpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvbldvcmRCb3VuZGFyeSA9ISBvbldvcmRCb3VuZGFyeTtcclxuICAgICAgICAgICAgaSA9IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGkgPj0gY2hhcmFjdGVycy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgd29yZCA9IGNoYXJhY3RlcnMuc3BsaWNlKDAsIGkpO1xyXG4gICAgICAgICAgICBpZiAod29yZC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHdvcmRzLnB1c2gocHVueWNvZGUudWNzMi5lbmNvZGUod29yZCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHdvcmRzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1dvcmRCb3VuZGFyeShjaGFyYWN0ZXJDb2RlKSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICAgIDMyLCAvLyA8c3BhY2U+XHJcbiAgICAgICAgMTMsIC8vIFxcclxyXG4gICAgICAgIDEwLCAvLyBcXG5cclxuICAgICAgICA5LCAvLyBcXHRcclxuICAgICAgICA0NSAvLyAtXHJcbiAgICBdLmluZGV4T2YoY2hhcmFjdGVyQ29kZSkgIT09IC0xO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYXNVbmljb2RlKHN0cmluZykge1xyXG4gICAgcmV0dXJuICgvW15cXHUwMDAwLVxcdTAwZmZdLykudGVzdChzdHJpbmcpO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IE5vZGVQYXJzZXI7XHJcblxyXG59LHtcIi4vY29sb3JcIjozLFwiLi9mb250bWV0cmljc1wiOjcsXCIuL2xvZ1wiOjEzLFwiLi9ub2RlY29udGFpbmVyXCI6MTQsXCIuL3BzZXVkb2VsZW1lbnRjb250YWluZXJcIjoxOCxcIi4vc3RhY2tpbmdjb250ZXh0XCI6MjEsXCIuL3RleHRjb250YWluZXJcIjoyNSxcIi4vdXRpbHNcIjoyNixcInB1bnljb2RlXCI6MX1dLDE2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxudmFyIFhIUiA9IF9kZXJlcV8oJy4veGhyJyk7XHJcbnZhciB1dGlscyA9IF9kZXJlcV8oJy4vdXRpbHMnKTtcclxudmFyIGxvZyA9IF9kZXJlcV8oJy4vbG9nJyk7XHJcbnZhciBjcmVhdGVXaW5kb3dDbG9uZSA9IF9kZXJlcV8oJy4vY2xvbmUnKTtcclxudmFyIGRlY29kZTY0ID0gdXRpbHMuZGVjb2RlNjQ7XHJcblxyXG5mdW5jdGlvbiBQcm94eShzcmMsIHByb3h5VXJsLCBkb2N1bWVudCkge1xyXG4gICAgdmFyIHN1cHBvcnRzQ09SUyA9ICgnd2l0aENyZWRlbnRpYWxzJyBpbiBuZXcgWE1MSHR0cFJlcXVlc3QoKSk7XHJcbiAgICBpZiAoIXByb3h5VXJsKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiTm8gcHJveHkgY29uZmlndXJlZFwiKTtcclxuICAgIH1cclxuICAgIHZhciBjYWxsYmFjayA9IGNyZWF0ZUNhbGxiYWNrKHN1cHBvcnRzQ09SUyk7XHJcbiAgICB2YXIgdXJsID0gY3JlYXRlUHJveHlVcmwocHJveHlVcmwsIHNyYywgY2FsbGJhY2spO1xyXG5cclxuICAgIHJldHVybiBzdXBwb3J0c0NPUlMgPyBYSFIodXJsKSA6IChqc29ucChkb2N1bWVudCwgdXJsLCBjYWxsYmFjaykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHJldHVybiBkZWNvZGU2NChyZXNwb25zZS5jb250ZW50KTtcclxuICAgIH0pKTtcclxufVxyXG52YXIgcHJveHlDb3VudCA9IDA7XHJcblxyXG5mdW5jdGlvbiBQcm94eVVSTChzcmMsIHByb3h5VXJsLCBkb2N1bWVudCkge1xyXG4gICAgdmFyIHN1cHBvcnRzQ09SU0ltYWdlID0gKCdjcm9zc09yaWdpbicgaW4gbmV3IEltYWdlKCkpO1xyXG4gICAgdmFyIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soc3VwcG9ydHNDT1JTSW1hZ2UpO1xyXG4gICAgdmFyIHVybCA9IGNyZWF0ZVByb3h5VXJsKHByb3h5VXJsLCBzcmMsIGNhbGxiYWNrKTtcclxuICAgIHJldHVybiAoc3VwcG9ydHNDT1JTSW1hZ2UgPyBQcm9taXNlLnJlc29sdmUodXJsKSA6IGpzb25wKGRvY3VtZW50LCB1cmwsIGNhbGxiYWNrKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIFwiZGF0YTpcIiArIHJlc3BvbnNlLnR5cGUgKyBcIjtiYXNlNjQsXCIgKyByZXNwb25zZS5jb250ZW50O1xyXG4gICAgfSkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBqc29ucChkb2N1bWVudCwgdXJsLCBjYWxsYmFjaykge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIHZhciBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcclxuICAgICAgICB2YXIgY2xlYW51cCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBkZWxldGUgd2luZG93Lk9mZmljZUJyb3dzZXJGZWVkYmFjay5odG1sMmNhbnZhcy5wcm94eVtjYWxsYmFja107XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQocyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB3aW5kb3cuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmh0bWwyY2FudmFzLnByb3h5W2NhbGxiYWNrXSA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICBjbGVhbnVwKCk7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcy5zcmMgPSB1cmw7XHJcbiAgICAgICAgcy5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBjbGVhbnVwKCk7XHJcbiAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocyk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FsbGJhY2sodXNlQ09SUykge1xyXG4gICAgcmV0dXJuICF1c2VDT1JTID8gXCJodG1sMmNhbnZhc19cIiArIERhdGUubm93KCkgKyBcIl9cIiArICgrK3Byb3h5Q291bnQpICsgXCJfXCIgKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAxMDAwMDApIDogXCJcIjtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlUHJveHlVcmwocHJveHlVcmwsIHNyYywgY2FsbGJhY2spIHtcclxuICAgIHJldHVybiBwcm94eVVybCArIFwiP3VybD1cIiArIGVuY29kZVVSSUNvbXBvbmVudChzcmMpICsgKGNhbGxiYWNrLmxlbmd0aCA/IFwiJmNhbGxiYWNrPWh0bWwyY2FudmFzLnByb3h5LlwiICsgY2FsbGJhY2sgOiBcIlwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZG9jdW1lbnRGcm9tSFRNTChzcmMpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbihodG1sKSB7XHJcbiAgICAgICAgdmFyIHBhcnNlciA9IG5ldyBET01QYXJzZXIoKSwgZG9jO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaHRtbCwgXCJ0ZXh0L2h0bWxcIik7XHJcbiAgICAgICAgfSBjYXRjaChlKSB7XHJcbiAgICAgICAgICAgIGxvZyhcIkRPTVBhcnNlciBub3Qgc3VwcG9ydGVkLCBmYWxsaW5nIGJhY2sgdG8gY3JlYXRlSFRNTERvY3VtZW50XCIpO1xyXG4gICAgICAgICAgICBkb2MgPSBkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoXCJcIik7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBkb2Mub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgZG9jLndyaXRlKGh0bWwpO1xyXG4gICAgICAgICAgICAgICAgZG9jLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2goZWUpIHtcclxuICAgICAgICAgICAgICAgIGxvZyhcImNyZWF0ZUhUTUxEb2N1bWVudCB3cml0ZSBub3Qgc3VwcG9ydGVkLCBmYWxsaW5nIGJhY2sgdG8gZG9jdW1lbnQuYm9keS5pbm5lckhUTUxcIik7XHJcbiAgICAgICAgICAgICAgICBkb2MuYm9keS5pbm5lckhUTUwgPSBodG1sOyAvLyBpZTkgZG9lc250IHN1cHBvcnQgd3JpdGluZyB0byBkb2N1bWVudEVsZW1lbnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGIgPSBkb2MucXVlcnlTZWxlY3RvcihcImJhc2VcIik7XHJcbiAgICAgICAgaWYgKCFiIHx8ICFiLmhyZWYuaG9zdCkge1xyXG4gICAgICAgICAgICB2YXIgYmFzZSA9IGRvYy5jcmVhdGVFbGVtZW50KFwiYmFzZVwiKTtcclxuICAgICAgICAgICAgYmFzZS5ocmVmID0gc3JjO1xyXG4gICAgICAgICAgICBkb2MuaGVhZC5pbnNlcnRCZWZvcmUoYmFzZSwgZG9jLmhlYWQuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZG9jO1xyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gbG9hZFVybERvY3VtZW50KHNyYywgcHJveHksIGRvY3VtZW50LCB3aWR0aCwgaGVpZ2h0LCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb3h5KHNyYywgcHJveHksIHdpbmRvdy5kb2N1bWVudCkudGhlbihkb2N1bWVudEZyb21IVE1MKHNyYykpLnRoZW4oZnVuY3Rpb24oZG9jKSB7XHJcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVdpbmRvd0Nsb25lKGRvYywgZG9jdW1lbnQsIHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMsIDAsIDApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydHMuUHJveHkgPSBQcm94eTtcclxuZXhwb3J0cy5Qcm94eVVSTCA9IFByb3h5VVJMO1xyXG5leHBvcnRzLmxvYWRVcmxEb2N1bWVudCA9IGxvYWRVcmxEb2N1bWVudDtcclxuXHJcbn0se1wiLi9jbG9uZVwiOjIsXCIuL2xvZ1wiOjEzLFwiLi91dGlsc1wiOjI2LFwiLi94aHJcIjoyOH1dLDE3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxudmFyIFByb3h5VVJMID0gX2RlcmVxXygnLi9wcm94eScpLlByb3h5VVJMO1xyXG5cclxuZnVuY3Rpb24gUHJveHlJbWFnZUNvbnRhaW5lcihzcmMsIHByb3h5KSB7XHJcbiAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xyXG4gICAgbGluay5ocmVmID0gc3JjO1xyXG4gICAgc3JjID0gbGluay5ocmVmO1xyXG4gICAgdGhpcy5zcmMgPSBzcmM7XHJcbiAgICB0aGlzLmltYWdlID0gbmV3IEltYWdlKCk7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBzZWxmLmltYWdlLmNyb3NzT3JpZ2luID0gXCJBbm9ueW1vdXNcIjtcclxuICAgICAgICBzZWxmLmltYWdlLm9ubG9hZCA9IHJlc29sdmU7XHJcbiAgICAgICAgc2VsZi5pbWFnZS5vbmVycm9yID0gcmVqZWN0O1xyXG5cclxuICAgICAgICBuZXcgUHJveHlVUkwoc3JjLCBwcm94eSwgZG9jdW1lbnQpLnRoZW4oZnVuY3Rpb24odXJsKSB7XHJcbiAgICAgICAgICAgIHNlbGYuaW1hZ2Uuc3JjID0gdXJsO1xyXG4gICAgICAgIH0pWydjYXRjaCddKHJlamVjdCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQcm94eUltYWdlQ29udGFpbmVyO1xyXG5cclxufSx7XCIuL3Byb3h5XCI6MTZ9XSwxODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBOb2RlQ29udGFpbmVyID0gX2RlcmVxXygnLi9ub2RlY29udGFpbmVyJyk7XHJcblxyXG5mdW5jdGlvbiBQc2V1ZG9FbGVtZW50Q29udGFpbmVyKG5vZGUsIHBhcmVudCwgdHlwZSkge1xyXG4gICAgTm9kZUNvbnRhaW5lci5jYWxsKHRoaXMsIG5vZGUsIHBhcmVudCk7XHJcbiAgICB0aGlzLmlzUHNldWRvRWxlbWVudCA9IHRydWU7XHJcbiAgICB0aGlzLmJlZm9yZSA9IHR5cGUgPT09IFwiOmJlZm9yZVwiO1xyXG59XHJcblxyXG5Qc2V1ZG9FbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZS5jbG9uZVRvID0gZnVuY3Rpb24oc3RhY2spIHtcclxuICAgIFBzZXVkb0VsZW1lbnRDb250YWluZXIucHJvdG90eXBlLmNsb25lVG8uY2FsbCh0aGlzLCBzdGFjayk7XHJcbiAgICBzdGFjay5pc1BzZXVkb0VsZW1lbnQgPSB0cnVlO1xyXG4gICAgc3RhY2suYmVmb3JlID0gdGhpcy5iZWZvcmU7XHJcbn07XHJcblxyXG5Qc2V1ZG9FbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTm9kZUNvbnRhaW5lci5wcm90b3R5cGUpO1xyXG5cclxuUHNldWRvRWxlbWVudENvbnRhaW5lci5wcm90b3R5cGUuYXBwZW5kVG9ET00gPSBmdW5jdGlvbigpIHtcclxuICAgIGlmICh0aGlzLmJlZm9yZSkge1xyXG4gICAgICAgIHRoaXMucGFyZW50Lm5vZGUuaW5zZXJ0QmVmb3JlKHRoaXMubm9kZSwgdGhpcy5wYXJlbnQubm9kZS5maXJzdENoaWxkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQubm9kZS5hcHBlbmRDaGlsZCh0aGlzLm5vZGUpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5wYXJlbnQubm9kZS5jbGFzc05hbWUgKz0gXCIgXCIgKyB0aGlzLmdldEhpZGVDbGFzcygpO1xyXG59O1xyXG5cclxuUHNldWRvRWxlbWVudENvbnRhaW5lci5wcm90b3R5cGUuY2xlYW5ET00gPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMubm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMubm9kZSk7XHJcbiAgICB0aGlzLnBhcmVudC5ub2RlLmNsYXNzTmFtZSA9IHRoaXMucGFyZW50Lm5vZGUuY2xhc3NOYW1lLnJlcGxhY2UodGhpcy5nZXRIaWRlQ2xhc3MoKSwgXCJcIik7XHJcbn07XHJcblxyXG5Qc2V1ZG9FbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZS5nZXRIaWRlQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzW1wiUFNFVURPX0hJREVfRUxFTUVOVF9DTEFTU19cIiArICh0aGlzLmJlZm9yZSA/IFwiQkVGT1JFXCIgOiBcIkFGVEVSXCIpXTtcclxufTtcclxuXHJcblBzZXVkb0VsZW1lbnRDb250YWluZXIucHJvdG90eXBlLlBTRVVET19ISURFX0VMRU1FTlRfQ0xBU1NfQkVGT1JFID0gXCJfX19odG1sMmNhbnZhc19fX3BzZXVkb2VsZW1lbnRfYmVmb3JlXCI7XHJcblBzZXVkb0VsZW1lbnRDb250YWluZXIucHJvdG90eXBlLlBTRVVET19ISURFX0VMRU1FTlRfQ0xBU1NfQUZURVIgPSBcIl9fX2h0bWwyY2FudmFzX19fcHNldWRvZWxlbWVudF9hZnRlclwiO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQc2V1ZG9FbGVtZW50Q29udGFpbmVyO1xyXG5cclxufSx7XCIuL25vZGVjb250YWluZXJcIjoxNH1dLDE5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxudmFyIGxvZyA9IF9kZXJlcV8oJy4vbG9nJyk7XHJcblxyXG5mdW5jdGlvbiBSZW5kZXJlcih3aWR0aCwgaGVpZ2h0LCBpbWFnZXMsIG9wdGlvbnMsIGRvY3VtZW50KSB7XHJcbiAgICB0aGlzLndpZHRoID0gd2lkdGg7XHJcbiAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcclxuICAgIHRoaXMuaW1hZ2VzID0gaW1hZ2VzO1xyXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcclxuICAgIHRoaXMuZG9jdW1lbnQgPSBkb2N1bWVudDtcclxufVxyXG5cclxuUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlckltYWdlID0gZnVuY3Rpb24oY29udGFpbmVyLCBib3VuZHMsIGJvcmRlckRhdGEsIGltYWdlQ29udGFpbmVyKSB7XHJcbiAgICB2YXIgcGFkZGluZ0xlZnQgPSBjb250YWluZXIuY3NzSW50KCdwYWRkaW5nTGVmdCcpLFxyXG4gICAgICAgIHBhZGRpbmdUb3AgPSBjb250YWluZXIuY3NzSW50KCdwYWRkaW5nVG9wJyksXHJcbiAgICAgICAgcGFkZGluZ1JpZ2h0ID0gY29udGFpbmVyLmNzc0ludCgncGFkZGluZ1JpZ2h0JyksXHJcbiAgICAgICAgcGFkZGluZ0JvdHRvbSA9IGNvbnRhaW5lci5jc3NJbnQoJ3BhZGRpbmdCb3R0b20nKSxcclxuICAgICAgICBib3JkZXJzID0gYm9yZGVyRGF0YS5ib3JkZXJzO1xyXG5cclxuICAgIHZhciB3aWR0aCA9IGJvdW5kcy53aWR0aCAtIChib3JkZXJzWzFdLndpZHRoICsgYm9yZGVyc1szXS53aWR0aCArIHBhZGRpbmdMZWZ0ICsgcGFkZGluZ1JpZ2h0KTtcclxuICAgIHZhciBoZWlnaHQgPSBib3VuZHMuaGVpZ2h0IC0gKGJvcmRlcnNbMF0ud2lkdGggKyBib3JkZXJzWzJdLndpZHRoICsgcGFkZGluZ1RvcCArIHBhZGRpbmdCb3R0b20pO1xyXG4gICAgdGhpcy5kcmF3SW1hZ2UoXHJcbiAgICAgICAgaW1hZ2VDb250YWluZXIsXHJcbiAgICAgICAgMCxcclxuICAgICAgICAwLFxyXG4gICAgICAgIGltYWdlQ29udGFpbmVyLmltYWdlLndpZHRoIHx8IHdpZHRoLFxyXG4gICAgICAgIGltYWdlQ29udGFpbmVyLmltYWdlLmhlaWdodCB8fCBoZWlnaHQsXHJcbiAgICAgICAgYm91bmRzLmxlZnQgKyBwYWRkaW5nTGVmdCArIGJvcmRlcnNbM10ud2lkdGgsXHJcbiAgICAgICAgYm91bmRzLnRvcCArIHBhZGRpbmdUb3AgKyBib3JkZXJzWzBdLndpZHRoLFxyXG4gICAgICAgIHdpZHRoLFxyXG4gICAgICAgIGhlaWdodFxyXG4gICAgKTtcclxufTtcclxuXHJcblJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXJCYWNrZ3JvdW5kID0gZnVuY3Rpb24oY29udGFpbmVyLCBib3VuZHMsIGJvcmRlckRhdGEpIHtcclxuICAgIGlmIChib3VuZHMuaGVpZ2h0ID4gMCAmJiBib3VuZHMud2lkdGggPiAwKSB7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJCYWNrZ3JvdW5kQ29sb3IoY29udGFpbmVyLCBib3VuZHMpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQmFja2dyb3VuZEltYWdlKGNvbnRhaW5lciwgYm91bmRzLCBib3JkZXJEYXRhKTtcclxuICAgIH1cclxufTtcclxuXHJcblJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXJCYWNrZ3JvdW5kQ29sb3IgPSBmdW5jdGlvbihjb250YWluZXIsIGJvdW5kcykge1xyXG4gICAgdmFyIGNvbG9yID0gY29udGFpbmVyLmNvbG9yKFwiYmFja2dyb3VuZENvbG9yXCIpO1xyXG4gICAgaWYgKCFjb2xvci5pc1RyYW5zcGFyZW50KCkpIHtcclxuICAgICAgICB0aGlzLnJlY3RhbmdsZShib3VuZHMubGVmdCwgYm91bmRzLnRvcCwgYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0LCBjb2xvcik7XHJcbiAgICB9XHJcbn07XHJcblxyXG5SZW5kZXJlci5wcm90b3R5cGUucmVuZGVyQm9yZGVycyA9IGZ1bmN0aW9uKGJvcmRlcnMpIHtcclxuICAgIGJvcmRlcnMuZm9yRWFjaCh0aGlzLnJlbmRlckJvcmRlciwgdGhpcyk7XHJcbn07XHJcblxyXG5SZW5kZXJlci5wcm90b3R5cGUucmVuZGVyQm9yZGVyID0gZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgaWYgKCFkYXRhLmNvbG9yLmlzVHJhbnNwYXJlbnQoKSAmJiBkYXRhLmFyZ3MgIT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLmRyYXdTaGFwZShkYXRhLmFyZ3MsIGRhdGEuY29sb3IpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlckJhY2tncm91bmRJbWFnZSA9IGZ1bmN0aW9uKGNvbnRhaW5lciwgYm91bmRzLCBib3JkZXJEYXRhKSB7XHJcbiAgICB2YXIgYmFja2dyb3VuZEltYWdlcyA9IGNvbnRhaW5lci5wYXJzZUJhY2tncm91bmRJbWFnZXMoKTtcclxuICAgIGJhY2tncm91bmRJbWFnZXMucmV2ZXJzZSgpLmZvckVhY2goZnVuY3Rpb24oYmFja2dyb3VuZEltYWdlLCBpbmRleCwgYXJyKSB7XHJcbiAgICAgICAgc3dpdGNoKGJhY2tncm91bmRJbWFnZS5tZXRob2QpIHtcclxuICAgICAgICBjYXNlIFwidXJsXCI6XHJcbiAgICAgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2VzLmdldChiYWNrZ3JvdW5kSW1hZ2UuYXJnc1swXSk7XHJcbiAgICAgICAgICAgIGlmIChpbWFnZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJCYWNrZ3JvdW5kUmVwZWF0aW5nKGNvbnRhaW5lciwgYm91bmRzLCBpbWFnZSwgYXJyLmxlbmd0aCAtIChpbmRleCsxKSwgYm9yZGVyRGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsb2coXCJFcnJvciBsb2FkaW5nIGJhY2tncm91bmQtaW1hZ2VcIiwgYmFja2dyb3VuZEltYWdlLmFyZ3NbMF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJsaW5lYXItZ3JhZGllbnRcIjpcclxuICAgICAgICBjYXNlIFwiZ3JhZGllbnRcIjpcclxuICAgICAgICAgICAgdmFyIGdyYWRpZW50SW1hZ2UgPSB0aGlzLmltYWdlcy5nZXQoYmFja2dyb3VuZEltYWdlLnZhbHVlKTtcclxuICAgICAgICAgICAgaWYgKGdyYWRpZW50SW1hZ2UpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQmFja2dyb3VuZEdyYWRpZW50KGdyYWRpZW50SW1hZ2UsIGJvdW5kcywgYm9yZGVyRGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsb2coXCJFcnJvciBsb2FkaW5nIGJhY2tncm91bmQtaW1hZ2VcIiwgYmFja2dyb3VuZEltYWdlLmFyZ3NbMF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJub25lXCI6XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIGxvZyhcIlVua25vd24gYmFja2dyb3VuZC1pbWFnZSB0eXBlXCIsIGJhY2tncm91bmRJbWFnZS5hcmdzWzBdKTtcclxuICAgICAgICB9XHJcbiAgICB9LCB0aGlzKTtcclxufTtcclxuXHJcblJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXJCYWNrZ3JvdW5kUmVwZWF0aW5nID0gZnVuY3Rpb24oY29udGFpbmVyLCBib3VuZHMsIGltYWdlQ29udGFpbmVyLCBpbmRleCwgYm9yZGVyRGF0YSkge1xyXG4gICAgdmFyIHNpemUgPSBjb250YWluZXIucGFyc2VCYWNrZ3JvdW5kU2l6ZShib3VuZHMsIGltYWdlQ29udGFpbmVyLmltYWdlLCBpbmRleCk7XHJcbiAgICB2YXIgcG9zaXRpb24gPSBjb250YWluZXIucGFyc2VCYWNrZ3JvdW5kUG9zaXRpb24oYm91bmRzLCBpbWFnZUNvbnRhaW5lci5pbWFnZSwgaW5kZXgsIHNpemUpO1xyXG4gICAgdmFyIHJlcGVhdCA9IGNvbnRhaW5lci5wYXJzZUJhY2tncm91bmRSZXBlYXQoaW5kZXgpO1xyXG4gICAgc3dpdGNoIChyZXBlYXQpIHtcclxuICAgIGNhc2UgXCJyZXBlYXQteFwiOlxyXG4gICAgY2FzZSBcInJlcGVhdCBuby1yZXBlYXRcIjpcclxuICAgICAgICB0aGlzLmJhY2tncm91bmRSZXBlYXRTaGFwZShpbWFnZUNvbnRhaW5lciwgcG9zaXRpb24sIHNpemUsIGJvdW5kcywgYm91bmRzLmxlZnQgKyBib3JkZXJEYXRhWzNdLCBib3VuZHMudG9wICsgcG9zaXRpb24udG9wICsgYm9yZGVyRGF0YVswXSwgOTk5OTksIHNpemUuaGVpZ2h0LCBib3JkZXJEYXRhKTtcclxuICAgICAgICBicmVhaztcclxuICAgIGNhc2UgXCJyZXBlYXQteVwiOlxyXG4gICAgY2FzZSBcIm5vLXJlcGVhdCByZXBlYXRcIjpcclxuICAgICAgICB0aGlzLmJhY2tncm91bmRSZXBlYXRTaGFwZShpbWFnZUNvbnRhaW5lciwgcG9zaXRpb24sIHNpemUsIGJvdW5kcywgYm91bmRzLmxlZnQgKyBwb3NpdGlvbi5sZWZ0ICsgYm9yZGVyRGF0YVszXSwgYm91bmRzLnRvcCArIGJvcmRlckRhdGFbMF0sIHNpemUud2lkdGgsIDk5OTk5LCBib3JkZXJEYXRhKTtcclxuICAgICAgICBicmVhaztcclxuICAgIGNhc2UgXCJuby1yZXBlYXRcIjpcclxuICAgICAgICB0aGlzLmJhY2tncm91bmRSZXBlYXRTaGFwZShpbWFnZUNvbnRhaW5lciwgcG9zaXRpb24sIHNpemUsIGJvdW5kcywgYm91bmRzLmxlZnQgKyBwb3NpdGlvbi5sZWZ0ICsgYm9yZGVyRGF0YVszXSwgYm91bmRzLnRvcCArIHBvc2l0aW9uLnRvcCArIGJvcmRlckRhdGFbMF0sIHNpemUud2lkdGgsIHNpemUuaGVpZ2h0LCBib3JkZXJEYXRhKTtcclxuICAgICAgICBicmVhaztcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgdGhpcy5yZW5kZXJCYWNrZ3JvdW5kUmVwZWF0KGltYWdlQ29udGFpbmVyLCBwb3NpdGlvbiwgc2l6ZSwge3RvcDogYm91bmRzLnRvcCwgbGVmdDogYm91bmRzLmxlZnR9LCBib3JkZXJEYXRhWzNdLCBib3JkZXJEYXRhWzBdKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUmVuZGVyZXI7XHJcblxyXG59LHtcIi4vbG9nXCI6MTN9XSwyMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBSZW5kZXJlciA9IF9kZXJlcV8oJy4uL3JlbmRlcmVyJyk7XHJcbnZhciBMaW5lYXJHcmFkaWVudENvbnRhaW5lciA9IF9kZXJlcV8oJy4uL2xpbmVhcmdyYWRpZW50Y29udGFpbmVyJyk7XHJcbnZhciBsb2cgPSBfZGVyZXFfKCcuLi9sb2cnKTtcclxuXHJcbmZ1bmN0aW9uIENhbnZhc1JlbmRlcmVyKHdpZHRoLCBoZWlnaHQpIHtcclxuICAgIFJlbmRlcmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICB0aGlzLmNhbnZhcyA9IHRoaXMub3B0aW9ucy5jYW52YXMgfHwgdGhpcy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuY2FudmFzKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICB9XHJcbiAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICAgIHRoaXMudGFpbnRDdHggPSB0aGlzLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgdGhpcy5jdHgudGV4dEJhc2VsaW5lID0gXCJib3R0b21cIjtcclxuICAgIHRoaXMudmFyaWFibGVzID0ge307XHJcbiAgICBsb2coXCJJbml0aWFsaXplZCBDYW52YXNSZW5kZXJlciB3aXRoIHNpemVcIiwgd2lkdGgsIFwieFwiLCBoZWlnaHQpO1xyXG59XHJcblxyXG5DYW52YXNSZW5kZXJlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFJlbmRlcmVyLnByb3RvdHlwZSk7XHJcblxyXG5DYW52YXNSZW5kZXJlci5wcm90b3R5cGUuc2V0RmlsbFN0eWxlID0gZnVuY3Rpb24oZmlsbFN0eWxlKSB7XHJcbiAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSB0eXBlb2YoZmlsbFN0eWxlKSA9PT0gXCJvYmplY3RcIiAmJiAhIWZpbGxTdHlsZS5pc0NvbG9yID8gZmlsbFN0eWxlLnRvU3RyaW5nKCkgOiBmaWxsU3R5bGU7XHJcbiAgICByZXR1cm4gdGhpcy5jdHg7XHJcbn07XHJcblxyXG5DYW52YXNSZW5kZXJlci5wcm90b3R5cGUucmVjdGFuZ2xlID0gZnVuY3Rpb24obGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0LCBjb2xvcikge1xyXG4gICAgdGhpcy5zZXRGaWxsU3R5bGUoY29sb3IpLmZpbGxSZWN0KGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7XHJcbn07XHJcblxyXG5DYW52YXNSZW5kZXJlci5wcm90b3R5cGUuY2lyY2xlID0gZnVuY3Rpb24obGVmdCwgdG9wLCBzaXplLCBjb2xvcikge1xyXG4gICAgdGhpcy5zZXRGaWxsU3R5bGUoY29sb3IpO1xyXG4gICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XHJcbiAgICB0aGlzLmN0eC5hcmMobGVmdCArIHNpemUgLyAyLCB0b3AgKyBzaXplIC8gMiwgc2l6ZSAvIDIsIDAsIE1hdGguUEkqMiwgdHJ1ZSk7XHJcbiAgICB0aGlzLmN0eC5jbG9zZVBhdGgoKTtcclxuICAgIHRoaXMuY3R4LmZpbGwoKTtcclxufTtcclxuXHJcbkNhbnZhc1JlbmRlcmVyLnByb3RvdHlwZS5jaXJjbGVTdHJva2UgPSBmdW5jdGlvbihsZWZ0LCB0b3AsIHNpemUsIGNvbG9yLCBzdHJva2UsIHN0cm9rZUNvbG9yKSB7XHJcbiAgICB0aGlzLmNpcmNsZShsZWZ0LCB0b3AsIHNpemUsIGNvbG9yKTtcclxuICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gc3Ryb2tlQ29sb3IudG9TdHJpbmcoKTtcclxuICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xyXG59O1xyXG5cclxuQ2FudmFzUmVuZGVyZXIucHJvdG90eXBlLmRyYXdTaGFwZSA9IGZ1bmN0aW9uKHNoYXBlLCBjb2xvcikge1xyXG4gICAgdGhpcy5zaGFwZShzaGFwZSk7XHJcbiAgICB0aGlzLnNldEZpbGxTdHlsZShjb2xvcikuZmlsbCgpO1xyXG59O1xyXG5cclxuQ2FudmFzUmVuZGVyZXIucHJvdG90eXBlLnRhaW50cyA9IGZ1bmN0aW9uKGltYWdlQ29udGFpbmVyKSB7XHJcbiAgICBpZiAoaW1hZ2VDb250YWluZXIudGFpbnRlZCA9PT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMudGFpbnRDdHguZHJhd0ltYWdlKGltYWdlQ29udGFpbmVyLmltYWdlLCAwLCAwKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0aGlzLnRhaW50Q3R4LmdldEltYWdlRGF0YSgwLCAwLCAxLCAxKTtcclxuICAgICAgICAgICAgaW1hZ2VDb250YWluZXIudGFpbnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgICAgICB0aGlzLnRhaW50Q3R4ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKS5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICAgICAgICAgIGltYWdlQ29udGFpbmVyLnRhaW50ZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaW1hZ2VDb250YWluZXIudGFpbnRlZDtcclxufTtcclxuXHJcbkNhbnZhc1JlbmRlcmVyLnByb3RvdHlwZS5kcmF3SW1hZ2UgPSBmdW5jdGlvbihpbWFnZUNvbnRhaW5lciwgc3gsIHN5LCBzdywgc2gsIGR4LCBkeSwgZHcsIGRoKSB7XHJcbiAgICBpZiAoIXRoaXMudGFpbnRzKGltYWdlQ29udGFpbmVyKSB8fCB0aGlzLm9wdGlvbnMuYWxsb3dUYWludCkge1xyXG4gICAgICAgIHRoaXMuY3R4LmRyYXdJbWFnZShpbWFnZUNvbnRhaW5lci5pbWFnZSwgc3gsIHN5LCBzdywgc2gsIGR4LCBkeSwgZHcsIGRoKTtcclxuICAgIH1cclxufTtcclxuXHJcbkNhbnZhc1JlbmRlcmVyLnByb3RvdHlwZS5jbGlwID0gZnVuY3Rpb24oc2hhcGVzLCBjYWxsYmFjaywgY29udGV4dCkge1xyXG4gICAgdGhpcy5jdHguc2F2ZSgpO1xyXG4gICAgc2hhcGVzLmZpbHRlcihoYXNFbnRyaWVzKS5mb3JFYWNoKGZ1bmN0aW9uKHNoYXBlKSB7XHJcbiAgICAgICAgdGhpcy5zaGFwZShzaGFwZSkuY2xpcCgpO1xyXG4gICAgfSwgdGhpcyk7XHJcbiAgICBjYWxsYmFjay5jYWxsKGNvbnRleHQpO1xyXG4gICAgdGhpcy5jdHgucmVzdG9yZSgpO1xyXG59O1xyXG5cclxuQ2FudmFzUmVuZGVyZXIucHJvdG90eXBlLnNoYXBlID0gZnVuY3Rpb24oc2hhcGUpIHtcclxuICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpO1xyXG4gICAgc2hhcGUuZm9yRWFjaChmdW5jdGlvbihwb2ludCwgaW5kZXgpIHtcclxuICAgICAgICBpZiAocG9pbnRbMF0gPT09IFwicmVjdFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3R4LnJlY3QuYXBwbHkodGhpcy5jdHgsIHBvaW50LnNsaWNlKDEpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmN0eFsoaW5kZXggPT09IDApID8gXCJtb3ZlVG9cIiA6IHBvaW50WzBdICsgXCJUb1wiIF0uYXBwbHkodGhpcy5jdHgsIHBvaW50LnNsaWNlKDEpKTtcclxuICAgICAgICB9XHJcbiAgICB9LCB0aGlzKTtcclxuICAgIHRoaXMuY3R4LmNsb3NlUGF0aCgpO1xyXG4gICAgcmV0dXJuIHRoaXMuY3R4O1xyXG59O1xyXG5cclxuQ2FudmFzUmVuZGVyZXIucHJvdG90eXBlLmZvbnQgPSBmdW5jdGlvbihjb2xvciwgc3R5bGUsIHZhcmlhbnQsIHdlaWdodCwgc2l6ZSwgZmFtaWx5KSB7XHJcbiAgICB0aGlzLnNldEZpbGxTdHlsZShjb2xvcikuZm9udCA9IFtzdHlsZSwgdmFyaWFudCwgd2VpZ2h0LCBzaXplLCBmYW1pbHldLmpvaW4oXCIgXCIpLnNwbGl0KFwiLFwiKVswXTtcclxufTtcclxuXHJcbkNhbnZhc1JlbmRlcmVyLnByb3RvdHlwZS5mb250U2hhZG93ID0gZnVuY3Rpb24oY29sb3IsIG9mZnNldFgsIG9mZnNldFksIGJsdXIpIHtcclxuICAgIHRoaXMuc2V0VmFyaWFibGUoXCJzaGFkb3dDb2xvclwiLCBjb2xvci50b1N0cmluZygpKVxyXG4gICAgICAgIC5zZXRWYXJpYWJsZShcInNoYWRvd09mZnNldFlcIiwgb2Zmc2V0WClcclxuICAgICAgICAuc2V0VmFyaWFibGUoXCJzaGFkb3dPZmZzZXRYXCIsIG9mZnNldFkpXHJcbiAgICAgICAgLnNldFZhcmlhYmxlKFwic2hhZG93Qmx1clwiLCBibHVyKTtcclxufTtcclxuXHJcbkNhbnZhc1JlbmRlcmVyLnByb3RvdHlwZS5jbGVhclNoYWRvdyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdGhpcy5zZXRWYXJpYWJsZShcInNoYWRvd0NvbG9yXCIsIFwicmdiYSgwLDAsMCwwKVwiKTtcclxufTtcclxuXHJcbkNhbnZhc1JlbmRlcmVyLnByb3RvdHlwZS5zZXRPcGFjaXR5ID0gZnVuY3Rpb24ob3BhY2l0eSkge1xyXG4gICAgdGhpcy5jdHguZ2xvYmFsQWxwaGEgPSBvcGFjaXR5O1xyXG59O1xyXG5cclxuQ2FudmFzUmVuZGVyZXIucHJvdG90eXBlLnNldFRyYW5zZm9ybSA9IGZ1bmN0aW9uKHRyYW5zZm9ybSkge1xyXG4gICAgdGhpcy5jdHgudHJhbnNsYXRlKHRyYW5zZm9ybS5vcmlnaW5bMF0sIHRyYW5zZm9ybS5vcmlnaW5bMV0pO1xyXG4gICAgdGhpcy5jdHgudHJhbnNmb3JtLmFwcGx5KHRoaXMuY3R4LCB0cmFuc2Zvcm0ubWF0cml4KTtcclxuICAgIHRoaXMuY3R4LnRyYW5zbGF0ZSgtdHJhbnNmb3JtLm9yaWdpblswXSwgLXRyYW5zZm9ybS5vcmlnaW5bMV0pO1xyXG59O1xyXG5cclxuQ2FudmFzUmVuZGVyZXIucHJvdG90eXBlLnNldFZhcmlhYmxlID0gZnVuY3Rpb24ocHJvcGVydHksIHZhbHVlKSB7XHJcbiAgICBpZiAodGhpcy52YXJpYWJsZXNbcHJvcGVydHldICE9PSB2YWx1ZSkge1xyXG4gICAgICAgIHRoaXMudmFyaWFibGVzW3Byb3BlcnR5XSA9IHRoaXMuY3R4W3Byb3BlcnR5XSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuQ2FudmFzUmVuZGVyZXIucHJvdG90eXBlLnRleHQgPSBmdW5jdGlvbih0ZXh0LCBsZWZ0LCBib3R0b20pIHtcclxuICAgIHRoaXMuY3R4LmZpbGxUZXh0KHRleHQsIGxlZnQsIGJvdHRvbSk7XHJcbn07XHJcblxyXG5DYW52YXNSZW5kZXJlci5wcm90b3R5cGUuYmFja2dyb3VuZFJlcGVhdFNoYXBlID0gZnVuY3Rpb24oaW1hZ2VDb250YWluZXIsIGJhY2tncm91bmRQb3NpdGlvbiwgc2l6ZSwgYm91bmRzLCBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQsIGJvcmRlckRhdGEpIHtcclxuICAgIHZhciBzaGFwZSA9IFtcclxuICAgICAgICBbXCJsaW5lXCIsIE1hdGgucm91bmQobGVmdCksIE1hdGgucm91bmQodG9wKV0sXHJcbiAgICAgICAgW1wibGluZVwiLCBNYXRoLnJvdW5kKGxlZnQgKyB3aWR0aCksIE1hdGgucm91bmQodG9wKV0sXHJcbiAgICAgICAgW1wibGluZVwiLCBNYXRoLnJvdW5kKGxlZnQgKyB3aWR0aCksIE1hdGgucm91bmQoaGVpZ2h0ICsgdG9wKV0sXHJcbiAgICAgICAgW1wibGluZVwiLCBNYXRoLnJvdW5kKGxlZnQpLCBNYXRoLnJvdW5kKGhlaWdodCArIHRvcCldXHJcbiAgICBdO1xyXG4gICAgdGhpcy5jbGlwKFtzaGFwZV0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyQmFja2dyb3VuZFJlcGVhdChpbWFnZUNvbnRhaW5lciwgYmFja2dyb3VuZFBvc2l0aW9uLCBzaXplLCBib3VuZHMsIGJvcmRlckRhdGFbM10sIGJvcmRlckRhdGFbMF0pO1xyXG4gICAgfSwgdGhpcyk7XHJcbn07XHJcblxyXG5DYW52YXNSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyQmFja2dyb3VuZFJlcGVhdCA9IGZ1bmN0aW9uKGltYWdlQ29udGFpbmVyLCBiYWNrZ3JvdW5kUG9zaXRpb24sIHNpemUsIGJvdW5kcywgYm9yZGVyTGVmdCwgYm9yZGVyVG9wKSB7XHJcbiAgICB2YXIgb2Zmc2V0WCA9IE1hdGgucm91bmQoYm91bmRzLmxlZnQgKyBiYWNrZ3JvdW5kUG9zaXRpb24ubGVmdCArIGJvcmRlckxlZnQpLCBvZmZzZXRZID0gTWF0aC5yb3VuZChib3VuZHMudG9wICsgYmFja2dyb3VuZFBvc2l0aW9uLnRvcCArIGJvcmRlclRvcCk7XHJcbiAgICB0aGlzLnNldEZpbGxTdHlsZSh0aGlzLmN0eC5jcmVhdGVQYXR0ZXJuKHRoaXMucmVzaXplSW1hZ2UoaW1hZ2VDb250YWluZXIsIHNpemUpLCBcInJlcGVhdFwiKSk7XHJcbiAgICB0aGlzLmN0eC50cmFuc2xhdGUob2Zmc2V0WCwgb2Zmc2V0WSk7XHJcbiAgICB0aGlzLmN0eC5maWxsKCk7XHJcbiAgICB0aGlzLmN0eC50cmFuc2xhdGUoLW9mZnNldFgsIC1vZmZzZXRZKTtcclxufTtcclxuXHJcbkNhbnZhc1JlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXJCYWNrZ3JvdW5kR3JhZGllbnQgPSBmdW5jdGlvbihncmFkaWVudEltYWdlLCBib3VuZHMpIHtcclxuICAgIGlmIChncmFkaWVudEltYWdlIGluc3RhbmNlb2YgTGluZWFyR3JhZGllbnRDb250YWluZXIpIHtcclxuICAgICAgICB2YXIgZ3JhZGllbnQgPSB0aGlzLmN0eC5jcmVhdGVMaW5lYXJHcmFkaWVudChcclxuICAgICAgICAgICAgYm91bmRzLmxlZnQgKyBib3VuZHMud2lkdGggKiBncmFkaWVudEltYWdlLngwLFxyXG4gICAgICAgICAgICBib3VuZHMudG9wICsgYm91bmRzLmhlaWdodCAqIGdyYWRpZW50SW1hZ2UueTAsXHJcbiAgICAgICAgICAgIGJvdW5kcy5sZWZ0ICsgIGJvdW5kcy53aWR0aCAqIGdyYWRpZW50SW1hZ2UueDEsXHJcbiAgICAgICAgICAgIGJvdW5kcy50b3AgKyAgYm91bmRzLmhlaWdodCAqIGdyYWRpZW50SW1hZ2UueTEpO1xyXG4gICAgICAgIGdyYWRpZW50SW1hZ2UuY29sb3JTdG9wcy5mb3JFYWNoKGZ1bmN0aW9uKGNvbG9yU3RvcCkge1xyXG4gICAgICAgICAgICBncmFkaWVudC5hZGRDb2xvclN0b3AoY29sb3JTdG9wLnN0b3AsIGNvbG9yU3RvcC5jb2xvci50b1N0cmluZygpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnJlY3RhbmdsZShib3VuZHMubGVmdCwgYm91bmRzLnRvcCwgYm91bmRzLndpZHRoLCBib3VuZHMuaGVpZ2h0LCBncmFkaWVudCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5DYW52YXNSZW5kZXJlci5wcm90b3R5cGUucmVzaXplSW1hZ2UgPSBmdW5jdGlvbihpbWFnZUNvbnRhaW5lciwgc2l6ZSkge1xyXG4gICAgdmFyIGltYWdlID0gaW1hZ2VDb250YWluZXIuaW1hZ2U7XHJcbiAgICBpZihpbWFnZS53aWR0aCA9PT0gc2l6ZS53aWR0aCAmJiBpbWFnZS5oZWlnaHQgPT09IHNpemUuaGVpZ2h0KSB7XHJcbiAgICAgICAgcmV0dXJuIGltYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBjdHgsIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgY2FudmFzLndpZHRoID0gc2l6ZS53aWR0aDtcclxuICAgIGNhbnZhcy5oZWlnaHQgPSBzaXplLmhlaWdodDtcclxuICAgIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICBjdHguZHJhd0ltYWdlKGltYWdlLCAwLCAwLCBpbWFnZS53aWR0aCwgaW1hZ2UuaGVpZ2h0LCAwLCAwLCBzaXplLndpZHRoLCBzaXplLmhlaWdodCApO1xyXG4gICAgcmV0dXJuIGNhbnZhcztcclxufTtcclxuXHJcbmZ1bmN0aW9uIGhhc0VudHJpZXMoYXJyYXkpIHtcclxuICAgIHJldHVybiBhcnJheS5sZW5ndGggPiAwO1xyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IENhbnZhc1JlbmRlcmVyO1xyXG5cclxufSx7XCIuLi9saW5lYXJncmFkaWVudGNvbnRhaW5lclwiOjEyLFwiLi4vbG9nXCI6MTMsXCIuLi9yZW5kZXJlclwiOjE5fV0sMjE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xyXG52YXIgTm9kZUNvbnRhaW5lciA9IF9kZXJlcV8oJy4vbm9kZWNvbnRhaW5lcicpO1xyXG5cclxuZnVuY3Rpb24gU3RhY2tpbmdDb250ZXh0KGhhc093blN0YWNraW5nLCBvcGFjaXR5LCBlbGVtZW50LCBwYXJlbnQpIHtcclxuICAgIE5vZGVDb250YWluZXIuY2FsbCh0aGlzLCBlbGVtZW50LCBwYXJlbnQpO1xyXG4gICAgdGhpcy5vd25TdGFja2luZyA9IGhhc093blN0YWNraW5nO1xyXG4gICAgdGhpcy5jb250ZXh0cyA9IFtdO1xyXG4gICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xyXG4gICAgdGhpcy5vcGFjaXR5ID0gKHRoaXMucGFyZW50ID8gdGhpcy5wYXJlbnQuc3RhY2sub3BhY2l0eSA6IDEpICogb3BhY2l0eTtcclxufVxyXG5cclxuU3RhY2tpbmdDb250ZXh0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTm9kZUNvbnRhaW5lci5wcm90b3R5cGUpO1xyXG5cclxuU3RhY2tpbmdDb250ZXh0LnByb3RvdHlwZS5nZXRQYXJlbnRTdGFjayA9IGZ1bmN0aW9uKGNvbnRleHQpIHtcclxuICAgIHZhciBwYXJlbnRTdGFjayA9ICh0aGlzLnBhcmVudCkgPyB0aGlzLnBhcmVudC5zdGFjayA6IG51bGw7XHJcbiAgICByZXR1cm4gcGFyZW50U3RhY2sgPyAocGFyZW50U3RhY2sub3duU3RhY2tpbmcgPyBwYXJlbnRTdGFjayA6IHBhcmVudFN0YWNrLmdldFBhcmVudFN0YWNrKGNvbnRleHQpKSA6IGNvbnRleHQuc3RhY2s7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFN0YWNraW5nQ29udGV4dDtcclxuXHJcbn0se1wiLi9ub2RlY29udGFpbmVyXCI6MTR9XSwyMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbmZ1bmN0aW9uIFN1cHBvcnQoZG9jdW1lbnQpIHtcclxuICAgIHRoaXMucmFuZ2VCb3VuZHMgPSB0aGlzLnRlc3RSYW5nZUJvdW5kcyhkb2N1bWVudCk7XHJcbiAgICB0aGlzLmNvcnMgPSB0aGlzLnRlc3RDT1JTKCk7XHJcbiAgICB0aGlzLnN2ZyA9IHRoaXMudGVzdFNWRygpO1xyXG59XHJcblxyXG5TdXBwb3J0LnByb3RvdHlwZS50ZXN0UmFuZ2VCb3VuZHMgPSBmdW5jdGlvbihkb2N1bWVudCkge1xyXG4gICAgdmFyIHJhbmdlLCB0ZXN0RWxlbWVudCwgcmFuZ2VCb3VuZHMsIHJhbmdlSGVpZ2h0LCBzdXBwb3J0ID0gZmFsc2U7XHJcblxyXG4gICAgaWYgKGRvY3VtZW50LmNyZWF0ZVJhbmdlKSB7XHJcbiAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xyXG4gICAgICAgIGlmIChyYW5nZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QpIHtcclxuICAgICAgICAgICAgdGVzdEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdib3VuZHRlc3QnKTtcclxuICAgICAgICAgICAgdGVzdEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gXCIxMjNweFwiO1xyXG4gICAgICAgICAgICB0ZXN0RWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRlc3RFbGVtZW50KTtcclxuXHJcbiAgICAgICAgICAgIHJhbmdlLnNlbGVjdE5vZGUodGVzdEVsZW1lbnQpO1xyXG4gICAgICAgICAgICByYW5nZUJvdW5kcyA9IHJhbmdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgICAgICByYW5nZUhlaWdodCA9IHJhbmdlQm91bmRzLmhlaWdodDtcclxuXHJcbiAgICAgICAgICAgIGlmIChyYW5nZUhlaWdodCA9PT0gMTIzKSB7XHJcbiAgICAgICAgICAgICAgICBzdXBwb3J0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRlc3RFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHN1cHBvcnQ7XHJcbn07XHJcblxyXG5TdXBwb3J0LnByb3RvdHlwZS50ZXN0Q09SUyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHR5cGVvZigobmV3IEltYWdlKCkpLmNyb3NzT3JpZ2luKSAhPT0gXCJ1bmRlZmluZWRcIjtcclxufTtcclxuXHJcblN1cHBvcnQucHJvdG90eXBlLnRlc3RTVkcgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcclxuICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgdmFyIGN0eCA9ICBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xyXG4gICAgaW1nLnNyYyA9IFwiZGF0YTppbWFnZS9zdmcreG1sLDxzdmcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48L3N2Zz5cIjtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwKTtcclxuICAgICAgICBjYW52YXMudG9EYXRhVVJMKCk7XHJcbiAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gU3VwcG9ydDtcclxuXHJcbn0se31dLDIzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxudmFyIFhIUiA9IF9kZXJlcV8oJy4veGhyJyk7XHJcbnZhciBkZWNvZGU2NCA9IF9kZXJlcV8oJy4vdXRpbHMnKS5kZWNvZGU2NDtcclxuXHJcbmZ1bmN0aW9uIFNWR0NvbnRhaW5lcihzcmMpIHtcclxuICAgIHRoaXMuc3JjID0gc3JjO1xyXG4gICAgdGhpcy5pbWFnZSA9IG51bGw7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgdGhpcy5wcm9taXNlID0gdGhpcy5oYXNGYWJyaWMoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiAoc2VsZi5pc0lubGluZShzcmMpID8gUHJvbWlzZS5yZXNvbHZlKHNlbGYuaW5saW5lRm9ybWF0dGluZyhzcmMpKSA6IFhIUihzcmMpKTtcclxuICAgIH0pLnRoZW4oZnVuY3Rpb24oc3ZnKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcclxuICAgICAgICAgICAgd2luZG93Lk9mZmljZUJyb3dzZXJGZWVkYmFjay5odG1sMmNhbnZhcy5zdmcuZmFicmljLmxvYWRTVkdGcm9tU3RyaW5nKHN2Zywgc2VsZi5jcmVhdGVDYW52YXMuY2FsbChzZWxmLCByZXNvbHZlKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuU1ZHQ29udGFpbmVyLnByb3RvdHlwZS5oYXNGYWJyaWMgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiAhd2luZG93Lk9mZmljZUJyb3dzZXJGZWVkYmFjay5odG1sMmNhbnZhcy5zdmcgfHwgIXdpbmRvdy5PZmZpY2VCcm93c2VyRmVlZGJhY2suaHRtbDJjYW52YXMuc3ZnLmZhYnJpYyA/IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcImh0bWwyY2FudmFzLnN2Zy5qcyBpcyBub3QgbG9hZGVkLCBjYW5ub3QgcmVuZGVyIHN2Z1wiKSkgOiBQcm9taXNlLnJlc29sdmUoKTtcclxufTtcclxuXHJcblNWR0NvbnRhaW5lci5wcm90b3R5cGUuaW5saW5lRm9ybWF0dGluZyA9IGZ1bmN0aW9uKHNyYykge1xyXG4gICAgcmV0dXJuICgvXmRhdGE6aW1hZ2VcXC9zdmdcXCt4bWw7YmFzZTY0LC8udGVzdChzcmMpKSA/IHRoaXMuZGVjb2RlNjQodGhpcy5yZW1vdmVDb250ZW50VHlwZShzcmMpKSA6IHRoaXMucmVtb3ZlQ29udGVudFR5cGUoc3JjKTtcclxufTtcclxuXHJcblNWR0NvbnRhaW5lci5wcm90b3R5cGUucmVtb3ZlQ29udGVudFR5cGUgPSBmdW5jdGlvbihzcmMpIHtcclxuICAgIHJldHVybiBzcmMucmVwbGFjZSgvXmRhdGE6aW1hZ2VcXC9zdmdcXCt4bWwoO2Jhc2U2NCk/LC8sJycpO1xyXG59O1xyXG5cclxuU1ZHQ29udGFpbmVyLnByb3RvdHlwZS5pc0lubGluZSA9IGZ1bmN0aW9uKHNyYykge1xyXG4gICAgcmV0dXJuICgvXmRhdGE6aW1hZ2VcXC9zdmdcXCt4bWwvaS50ZXN0KHNyYykpO1xyXG59O1xyXG5cclxuU1ZHQ29udGFpbmVyLnByb3RvdHlwZS5jcmVhdGVDYW52YXMgPSBmdW5jdGlvbihyZXNvbHZlKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iamVjdHMsIG9wdGlvbnMpIHtcclxuICAgICAgICB2YXIgY2FudmFzID0gbmV3IHdpbmRvdy5PZmZpY2VCcm93c2VyRmVlZGJhY2suaHRtbDJjYW52YXMuc3ZnLmZhYnJpYy5TdGF0aWNDYW52YXMoJ2MnKTtcclxuICAgICAgICBzZWxmLmltYWdlID0gY2FudmFzLmxvd2VyQ2FudmFzRWw7XHJcbiAgICAgICAgY2FudmFzXHJcbiAgICAgICAgICAgIC5zZXRXaWR0aChvcHRpb25zLndpZHRoKVxyXG4gICAgICAgICAgICAuc2V0SGVpZ2h0KG9wdGlvbnMuaGVpZ2h0KVxyXG4gICAgICAgICAgICAuYWRkKHdpbmRvdy5PZmZpY2VCcm93c2VyRmVlZGJhY2suaHRtbDJjYW52YXMuc3ZnLmZhYnJpYy51dGlsLmdyb3VwU1ZHRWxlbWVudHMob2JqZWN0cywgb3B0aW9ucykpXHJcbiAgICAgICAgICAgIC5yZW5kZXJBbGwoKTtcclxuICAgICAgICByZXNvbHZlKGNhbnZhcy5sb3dlckNhbnZhc0VsKTtcclxuICAgIH07XHJcbn07XHJcblxyXG5TVkdDb250YWluZXIucHJvdG90eXBlLmRlY29kZTY0ID0gZnVuY3Rpb24oc3RyKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZih3aW5kb3cuYXRvYikgPT09IFwiZnVuY3Rpb25cIikgPyB3aW5kb3cuYXRvYihzdHIpIDogZGVjb2RlNjQoc3RyKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gU1ZHQ29udGFpbmVyO1xyXG5cclxufSx7XCIuL3V0aWxzXCI6MjYsXCIuL3hoclwiOjI4fV0sMjQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xyXG52YXIgU1ZHQ29udGFpbmVyID0gX2RlcmVxXygnLi9zdmdjb250YWluZXInKTtcclxuXHJcbmZ1bmN0aW9uIFNWR05vZGVDb250YWluZXIobm9kZSwgX25hdGl2ZSkge1xyXG4gICAgdGhpcy5zcmMgPSBub2RlO1xyXG4gICAgdGhpcy5pbWFnZSA9IG51bGw7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgdGhpcy5wcm9taXNlID0gX25hdGl2ZSA/IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIHNlbGYuaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuICAgICAgICBzZWxmLmltYWdlLm9ubG9hZCA9IHJlc29sdmU7XHJcbiAgICAgICAgc2VsZi5pbWFnZS5vbmVycm9yID0gcmVqZWN0O1xyXG4gICAgICAgIHNlbGYuaW1hZ2Uuc3JjID0gXCJkYXRhOmltYWdlL3N2Zyt4bWwsXCIgKyAobmV3IFhNTFNlcmlhbGl6ZXIoKSkuc2VyaWFsaXplVG9TdHJpbmcobm9kZSk7XHJcbiAgICAgICAgaWYgKHNlbGYuaW1hZ2UuY29tcGxldGUgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZShzZWxmLmltYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9KSA6IHRoaXMuaGFzRmFicmljKCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xyXG4gICAgICAgICAgICB3aW5kb3cuT2ZmaWNlQnJvd3NlckZlZWRiYWNrLmh0bWwyY2FudmFzLnN2Zy5mYWJyaWMucGFyc2VTVkdEb2N1bWVudChub2RlLCBzZWxmLmNyZWF0ZUNhbnZhcy5jYWxsKHNlbGYsIHJlc29sdmUpKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5TVkdOb2RlQ29udGFpbmVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoU1ZHQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFNWR05vZGVDb250YWluZXI7XHJcblxyXG59LHtcIi4vc3ZnY29udGFpbmVyXCI6MjN9XSwyNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBOb2RlQ29udGFpbmVyID0gX2RlcmVxXygnLi9ub2RlY29udGFpbmVyJyk7XHJcblxyXG5mdW5jdGlvbiBUZXh0Q29udGFpbmVyKG5vZGUsIHBhcmVudCkge1xyXG4gICAgTm9kZUNvbnRhaW5lci5jYWxsKHRoaXMsIG5vZGUsIHBhcmVudCk7XHJcbn1cclxuXHJcblRleHRDb250YWluZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShOb2RlQ29udGFpbmVyLnByb3RvdHlwZSk7XHJcblxyXG5UZXh0Q29udGFpbmVyLnByb3RvdHlwZS5hcHBseVRleHRUcmFuc2Zvcm0gPSBmdW5jdGlvbigpIHtcclxuICAgIHRoaXMubm9kZS5kYXRhID0gdGhpcy50cmFuc2Zvcm0odGhpcy5wYXJlbnQuY3NzKFwidGV4dFRyYW5zZm9ybVwiKSk7XHJcbn07XHJcblxyXG5UZXh0Q29udGFpbmVyLnByb3RvdHlwZS50cmFuc2Zvcm0gPSBmdW5jdGlvbih0cmFuc2Zvcm0pIHtcclxuICAgIHZhciB0ZXh0ID0gdGhpcy5ub2RlLmRhdGE7XHJcbiAgICBzd2l0Y2godHJhbnNmb3JtKXtcclxuICAgICAgICBjYXNlIFwibG93ZXJjYXNlXCI6XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0LnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgY2FzZSBcImNhcGl0YWxpemVcIjpcclxuICAgICAgICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgvKF58XFxzfDp8LXxcXCh8XFwpKShbYS16XSkvZywgY2FwaXRhbGl6ZSk7XHJcbiAgICAgICAgY2FzZSBcInVwcGVyY2FzZVwiOlxyXG4gICAgICAgICAgICByZXR1cm4gdGV4dC50b1VwcGVyQ2FzZSgpO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgfVxyXG59O1xyXG5cclxuZnVuY3Rpb24gY2FwaXRhbGl6ZShtLCBwMSwgcDIpIHtcclxuICAgIGlmIChtLmxlbmd0aCA+IDApIHtcclxuICAgICAgICByZXR1cm4gcDEgKyBwMi50b1VwcGVyQ2FzZSgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFRleHRDb250YWluZXI7XHJcblxyXG59LHtcIi4vbm9kZWNvbnRhaW5lclwiOjE0fV0sMjY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xyXG5leHBvcnRzLnNtYWxsSW1hZ2UgPSBmdW5jdGlvbiBzbWFsbEltYWdlKCkge1xyXG4gICAgcmV0dXJuIFwiZGF0YTppbWFnZS9naWY7YmFzZTY0LFIwbEdPRGxoQVFBQkFJQUFBQUFBQVAvLy95SDVCQUVBQUFBQUxBQUFBQUFCQUFFQUFBSUJSQUE3XCI7XHJcbn07XHJcblxyXG5leHBvcnRzLmJpbmQgPSBmdW5jdGlvbihjYWxsYmFjaywgY29udGV4dCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBjYWxsYmFjay5hcHBseShjb250ZXh0LCBhcmd1bWVudHMpO1xyXG4gICAgfTtcclxufTtcclxuXHJcbi8qXHJcbiAqIGJhc2U2NC1hcnJheWJ1ZmZlclxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbmlrbGFzdmgvYmFzZTY0LWFycmF5YnVmZmVyXHJcbiAqXHJcbiAqIENvcHlyaWdodCAoYykgMjAxMiBOaWtsYXMgdm9uIEhlcnR6ZW5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlLlxyXG4gKi9cclxuXHJcbmV4cG9ydHMuZGVjb2RlNjQgPSBmdW5jdGlvbihiYXNlNjQpIHtcclxuICAgIHZhciBjaGFycyA9IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrL1wiO1xyXG4gICAgdmFyIGxlbiA9IGJhc2U2NC5sZW5ndGgsIGksIGVuY29kZWQxLCBlbmNvZGVkMiwgZW5jb2RlZDMsIGVuY29kZWQ0LCBieXRlMSwgYnl0ZTIsIGJ5dGUzO1xyXG5cclxuICAgIHZhciBvdXRwdXQgPSBcIlwiO1xyXG5cclxuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrPTQpIHtcclxuICAgICAgICBlbmNvZGVkMSA9IGNoYXJzLmluZGV4T2YoYmFzZTY0W2ldKTtcclxuICAgICAgICBlbmNvZGVkMiA9IGNoYXJzLmluZGV4T2YoYmFzZTY0W2krMV0pO1xyXG4gICAgICAgIGVuY29kZWQzID0gY2hhcnMuaW5kZXhPZihiYXNlNjRbaSsyXSk7XHJcbiAgICAgICAgZW5jb2RlZDQgPSBjaGFycy5pbmRleE9mKGJhc2U2NFtpKzNdKTtcclxuXHJcbiAgICAgICAgYnl0ZTEgPSAoZW5jb2RlZDEgPDwgMikgfCAoZW5jb2RlZDIgPj4gNCk7XHJcbiAgICAgICAgYnl0ZTIgPSAoKGVuY29kZWQyICYgMTUpIDw8IDQpIHwgKGVuY29kZWQzID4+IDIpO1xyXG4gICAgICAgIGJ5dGUzID0gKChlbmNvZGVkMyAmIDMpIDw8IDYpIHwgZW5jb2RlZDQ7XHJcbiAgICAgICAgaWYgKGVuY29kZWQzID09PSA2NCkge1xyXG4gICAgICAgICAgICBvdXRwdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlMSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlbmNvZGVkNCA9PT0gNjQgfHwgZW5jb2RlZDQgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIG91dHB1dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGUxLCBieXRlMik7XHJcbiAgICAgICAgfSBlbHNle1xyXG4gICAgICAgICAgICBvdXRwdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShieXRlMSwgYnl0ZTIsIGJ5dGUzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG91dHB1dDtcclxufTtcclxuXHJcbmV4cG9ydHMuZ2V0Qm91bmRzID0gZnVuY3Rpb24obm9kZSkge1xyXG4gICAgaWYgKG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KSB7XHJcbiAgICAgICAgdmFyIGNsaWVudFJlY3QgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICAgIHZhciB3aWR0aCA9IG5vZGUub2Zmc2V0V2lkdGggPT0gbnVsbCA/IGNsaWVudFJlY3Qud2lkdGggOiBub2RlLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHRvcDogY2xpZW50UmVjdC50b3AsXHJcbiAgICAgICAgICAgIGJvdHRvbTogY2xpZW50UmVjdC5ib3R0b20gfHwgKGNsaWVudFJlY3QudG9wICsgY2xpZW50UmVjdC5oZWlnaHQpLFxyXG4gICAgICAgICAgICByaWdodDogY2xpZW50UmVjdC5sZWZ0ICsgd2lkdGgsXHJcbiAgICAgICAgICAgIGxlZnQ6IGNsaWVudFJlY3QubGVmdCxcclxuICAgICAgICAgICAgd2lkdGg6ICB3aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiBub2RlLm9mZnNldEhlaWdodCA9PSBudWxsID8gY2xpZW50UmVjdC5oZWlnaHQgOiBub2RlLm9mZnNldEhlaWdodFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICByZXR1cm4ge307XHJcbn07XHJcblxyXG5leHBvcnRzLm9mZnNldEJvdW5kcyA9IGZ1bmN0aW9uKG5vZGUpIHtcclxuICAgIHZhciBwYXJlbnQgPSBub2RlLm9mZnNldFBhcmVudCA/IGV4cG9ydHMub2Zmc2V0Qm91bmRzKG5vZGUub2Zmc2V0UGFyZW50KSA6IHt0b3A6IDAsIGxlZnQ6IDB9O1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdG9wOiBub2RlLm9mZnNldFRvcCArIHBhcmVudC50b3AsXHJcbiAgICAgICAgYm90dG9tOiBub2RlLm9mZnNldFRvcCArIG5vZGUub2Zmc2V0SGVpZ2h0ICsgcGFyZW50LnRvcCxcclxuICAgICAgICByaWdodDogbm9kZS5vZmZzZXRMZWZ0ICsgcGFyZW50LmxlZnQgKyBub2RlLm9mZnNldFdpZHRoLFxyXG4gICAgICAgIGxlZnQ6IG5vZGUub2Zmc2V0TGVmdCArIHBhcmVudC5sZWZ0LFxyXG4gICAgICAgIHdpZHRoOiBub2RlLm9mZnNldFdpZHRoLFxyXG4gICAgICAgIGhlaWdodDogbm9kZS5vZmZzZXRIZWlnaHRcclxuICAgIH07XHJcbn07XHJcblxyXG5leHBvcnRzLnBhcnNlQmFja2dyb3VuZHMgPSBmdW5jdGlvbihiYWNrZ3JvdW5kSW1hZ2UpIHtcclxuICAgIHZhciB3aGl0ZXNwYWNlID0gJyBcXHJcXG5cXHQnLFxyXG4gICAgICAgIG1ldGhvZCwgZGVmaW5pdGlvbiwgcHJlZml4LCBwcmVmaXhfaSwgYmxvY2ssIHJlc3VsdHMgPSBbXSxcclxuICAgICAgICBtb2RlID0gMCwgbnVtUGFyZW4gPSAwLCBxdW90ZSwgYXJncztcclxuICAgIHZhciBhcHBlbmRSZXN1bHQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZihtZXRob2QpIHtcclxuICAgICAgICAgICAgaWYgKGRlZmluaXRpb24uc3Vic3RyKDAsIDEpID09PSAnXCInKSB7XHJcbiAgICAgICAgICAgICAgICBkZWZpbml0aW9uID0gZGVmaW5pdGlvbi5zdWJzdHIoMSwgZGVmaW5pdGlvbi5sZW5ndGggLSAyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGVmaW5pdGlvbikge1xyXG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKGRlZmluaXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChtZXRob2Quc3Vic3RyKDAsIDEpID09PSAnLScgJiYgKHByZWZpeF9pID0gbWV0aG9kLmluZGV4T2YoJy0nLCAxICkgKyAxKSA+IDApIHtcclxuICAgICAgICAgICAgICAgIHByZWZpeCA9IG1ldGhvZC5zdWJzdHIoMCwgcHJlZml4X2kpO1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kID0gbWV0aG9kLnN1YnN0cihwcmVmaXhfaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHByZWZpeDogcHJlZml4LFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBtZXRob2QudG9Mb3dlckNhc2UoKSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBibG9jayxcclxuICAgICAgICAgICAgICAgIGFyZ3M6IGFyZ3MsXHJcbiAgICAgICAgICAgICAgICBpbWFnZTogbnVsbFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYXJncyA9IFtdO1xyXG4gICAgICAgIG1ldGhvZCA9IHByZWZpeCA9IGRlZmluaXRpb24gPSBibG9jayA9ICcnO1xyXG4gICAgfTtcclxuICAgIGFyZ3MgPSBbXTtcclxuICAgIG1ldGhvZCA9IHByZWZpeCA9IGRlZmluaXRpb24gPSBibG9jayA9ICcnO1xyXG4gICAgYmFja2dyb3VuZEltYWdlLnNwbGl0KFwiXCIpLmZvckVhY2goZnVuY3Rpb24oYykge1xyXG4gICAgICAgIGlmIChtb2RlID09PSAwICYmIHdoaXRlc3BhY2UuaW5kZXhPZihjKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoKGMpIHtcclxuICAgICAgICBjYXNlICdcIic6XHJcbiAgICAgICAgICAgIGlmKCFxdW90ZSkge1xyXG4gICAgICAgICAgICAgICAgcXVvdGUgPSBjO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYocXVvdGUgPT09IGMpIHtcclxuICAgICAgICAgICAgICAgIHF1b3RlID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICcoJzpcclxuICAgICAgICAgICAgaWYocXVvdGUpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYobW9kZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgbW9kZSA9IDE7XHJcbiAgICAgICAgICAgICAgICBibG9jayArPSBjO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbnVtUGFyZW4rKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICcpJzpcclxuICAgICAgICAgICAgaWYgKHF1b3RlKSB7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfSBlbHNlIGlmKG1vZGUgPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIGlmKG51bVBhcmVuID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZSA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgYmxvY2sgKz0gYztcclxuICAgICAgICAgICAgICAgICAgICBhcHBlbmRSZXN1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG51bVBhcmVuLS07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgJywnOlxyXG4gICAgICAgICAgICBpZiAocXVvdGUpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYobW9kZSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgYXBwZW5kUmVzdWx0KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG51bVBhcmVuID09PSAwICYmICFtZXRob2QubWF0Y2goL151cmwkL2kpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRlZmluaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmluaXRpb24gPSAnJztcclxuICAgICAgICAgICAgICAgICAgICBibG9jayArPSBjO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJsb2NrICs9IGM7XHJcbiAgICAgICAgaWYgKG1vZGUgPT09IDApIHtcclxuICAgICAgICAgICAgbWV0aG9kICs9IGM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZGVmaW5pdGlvbiArPSBjO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGFwcGVuZFJlc3VsdCgpO1xyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbn07XHJcblxyXG59LHt9XSwyNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XHJcbnZhciBHcmFkaWVudENvbnRhaW5lciA9IF9kZXJlcV8oJy4vZ3JhZGllbnRjb250YWluZXInKTtcclxuXHJcbmZ1bmN0aW9uIFdlYmtpdEdyYWRpZW50Q29udGFpbmVyKGltYWdlRGF0YSkge1xyXG4gICAgR3JhZGllbnRDb250YWluZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgIHRoaXMudHlwZSA9IGltYWdlRGF0YS5hcmdzWzBdID09PSBcImxpbmVhclwiID8gR3JhZGllbnRDb250YWluZXIuVFlQRVMuTElORUFSIDogR3JhZGllbnRDb250YWluZXIuVFlQRVMuUkFESUFMO1xyXG59XHJcblxyXG5XZWJraXRHcmFkaWVudENvbnRhaW5lci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEdyYWRpZW50Q29udGFpbmVyLnByb3RvdHlwZSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFdlYmtpdEdyYWRpZW50Q29udGFpbmVyO1xyXG5cclxufSx7XCIuL2dyYWRpZW50Y29udGFpbmVyXCI6OX1dLDI4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcclxuZnVuY3Rpb24gWEhSKHVybCkge1xyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB4aHIub3BlbignR0VUJywgdXJsKTtcclxuXHJcbiAgICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih4aHIuc3RhdHVzVGV4dCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihcIk5ldHdvcmsgRXJyb3JcIikpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHhoci5zZW5kKCk7XHJcbiAgICB9KTtcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBYSFI7XHJcblxyXG59LHt9XX0se30sWzRdKSg0KVxyXG59KTsiXX0=
