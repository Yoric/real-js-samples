function escapeRegExp(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function formatNumber(a,b){var c=a.toString();if(0>a)return c;if(b&&b>c.length)for(;b>c.length;)c="0"+c;return c}function extractDigits(a,b){b=b||a.length;var c=a.match(/^\d+/g),d=c&&c[0];return d?d.length<=b?d:d.substr(0,b):""}function removeQuatos(a){return stringDelimiter.test(a)?a.substr(1,a.length-2):a}function parseStringToDateLabels(a,b,c){var d={};if(null==a||null==b||null==c)return d;b.split(dateLabelsRegExp);return b.split(dateLabelsRegExp).forEach(function(b){var e;switch(b){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":e=2;case"yy":case"yyy":case"yyyy":e=e||4,d[b]=extractDigits(a,e),e=d[b].length;break;case"tt":e=0,a.toUpperCase().startsWith(c.DateTimeFormat.AMDesignator.toUpperCase())?e=c.DateTimeFormat.AMDesignator.length:a.toUpperCase().startsWith(c.DateTimeFormat.PMDesignator.toUpperCase())&&(e=c.DateTimeFormat.PMDesignator.length),d[b]=a.substr(0,e);break;default:e=0,b=removeQuatos(b),a.startsWith(b)&&(e=b.length)}a=a.slice(e)}),a.length>0?{}:d}function getTime(a,b){var c=parseInt(a.HH||a.H),d=parseInt(a.hh||a.h||a.time||12);if(isNaN(c)&&!isNaN(d)&&d>=1&&12>=d){if(null==a.tt)a.time||(c=0);else switch(a.tt.toUpperCase()){case b.DateTimeFormat.AMDesignator.toUpperCase():c=d;break;case b.DateTimeFormat.PMDesignator.toUpperCase():c=d%12+12}}var e=parseInt(a.mm||a.m||a.time||0),f=parseInt(a.ss||a.s||0);return isNaN(c)||isNaN(e)?NaN:1e3*(60*(60*c+e)+f)}var __extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__assign=this&&this.__assign||Object.assign||function(a){for(var b,c=1,d=arguments.length;d>c;c++){b=arguments[c];for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},OfficeForm;!function(a){function b(){return c||(c=new d)}var c;a.getUserRepository=b;var d=function(){function b(){this.userStateChangeCallbackManager=new a.Utilities.Process.CallbackManager,this.users={}}return b.prototype.registerUsersStateChange=function(a){this.userStateChangeCallbackManager.register(a)},b.prototype.unregisterUsersStateChange=function(a){this.userStateChangeCallbackManager.unregister(a)},b.prototype.getUser=function(a){return _.clone(this.users[a])},b.prototype.getAllUsers=function(){return _.values(a.Utilities.deepClone(this.users))},b.prototype.getUserCount=function(){return _.keys(this.users).length},b.prototype.addOrUpdateUser=function(a){if(b.isValidUser(a)){var c=this.users[a.userId];if(null!=c){if(b.isValidUser(c))return;_.extend(c,a)}else this.users[a.userId]=a;this.userStateChangeCallbackManager.trigger()}},b.prototype.removeUser=function(a){delete this.users[a.userId]&&this.userStateChangeCallbackManager.trigger()},b.prototype.removeAllUsers=function(){this.getUserCount()>0&&(this.users={},this.userStateChangeCallbackManager.trigger())},b.isValidUser=function(a){return a&&a.userId&&a.displayName&&a.firstName&&a.lastName&&a.email&&a.imageUri?!0:!1},b}();a.UserRepository=d}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(a){a[a.Aad=0]="Aad",a[a.Msa=1]="Msa"}(c=b.AuthProvider||(b.AuthProvider={}));var d=function(){function d(){return d._instance?d._instance:void(d._instance=this)}return d.getInstance=function(){return new d},d.prototype.redirectToSignIn=function(b){var c=encodeURIComponent(b||window.location.href),d=OfficeFormServerInfo.userInfo.IsMsa,e="Response"===a.EnvironmentConfig.getPageType(),f=OfficeFormServerInfo.signInLink;!d||e?f=a.Utilities.Html.updateUrlParam(f,"state",c):(f=OfficeFormServerInfo.signInLinkMsa,f=a.Utilities.Html.updateUrlParam(f,"redirecturl",c)),Forms.Common.replaceUrl(f)},d.prototype.redirectWithPatchedRedirectUrl=function(){var b=window.location.hash,c=a.Utilities.Html.getQueries().redirecturl;if(c&&-1===c.indexOf("#")&&b){window.location.hash="";var d=window.location.href;return d=a.Utilities.Html.updateUrlParam(d,"redirecturl",encodeURIComponent(c+b)),Forms.Common.redirectTo(d),!0}return!1},d.prototype.isUserLoggedIn=function(){return!!OfficeFormServerInfo.userInfo.UserId},d.prototype.isAuthTokenExpiredFailure=function(c){var e=c&&c.response&&c.response.statusCode;if(a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)&&e===b.ErrorCode.HttpStatusCode.Unauthorized){if(c&&c.response&&"Expired"===c.response.headers["X-FailureReason"])return!0;var f=d.parseInnerCodeFromError(c);if(f===b.ErrorCode.InnerCode.TokenExpired)return!0}return!1},d.prototype.isAntiForgeryTokenValidationFailure=function(c){var e=c&&c.response&&c.response.statusCode;if(a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)&&e===b.ErrorCode.HttpStatusCode.Forbidden){var f=d.parseInnerCodeFromError(c);if(f===b.ErrorCode.InnerCode.AntiForgeryTokenValidationError)return!0}return!1},d.prototype.refreshAuthToken=function(b,c){window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]);var e=function(a,d){!d&&a?b():c()};if(window.formsRefreshAuthTokenCallbacks.push(e),!window.formsRefreshAuthTokenCallback){var f=new a.Event.QosEventDeprecated(a.Event.QosEventNames.Auth.Auth.RefreshToken);f.start();var g=function(a,b){try{f.end({resultType:b?"ExpectedFailure":"Success",extraData:{loggedIn:a}}),$("#refreshAuthTokenFrame").remove();var c=window.formsRefreshAuthTokenCallbacks;if(b)c&&c.length>0&&c[0](a,b);else for(var d=0;d<c.length;++d)c[d](a,b)}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}},h=!!a.Utilities.getCookie("AADState.forms");if(this.isUserLoggedIn()||h){var i=null;this.isUserLoggedIn()?i=OfficeFormServerInfo.userInfo.IsMsa?d.signInLinkSilentMsa:d.signInLinkSilent:h&&(a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Auth.Auth.SilentSigninUsingAadState}),i=d.signInLinkSilent);var j=$("<iframe id='refreshAuthTokenFrame' style='display: none' src='"+i+"' />");j.on("load",null,null,function(a){window.setTimeout(function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)},5e3)}),window.formsRefreshAuthTokenCallback=g,$(document.body).append(j)}else g(!1,!0)}},d.prototype.detectUserLoggedIn=function(){var b=this;return a.EnvironmentConfig.isOsi()?this.detectUserLoggedInWithProvider(c.Aad).then(function(a){return a?c.Aad:b.detectUserLoggedInWithProvider(c.Msa).then(function(a){return a?c.Msa:$.Deferred().reject().promise()})}):$.Deferred().reject().promise()},d.prototype.detectUserLoggedInWithProvider=function(b){var e="detect-user-loggedIn-frame",f=$.Deferred();if(window.formsDetectUserLoggedInCallback)f.reject();else{var g=b===c.Msa?a.Event.QosEventNames.Auth.Auth.DetectUserLoggedInMSA:a.Event.QosEventNames.Auth.Auth.DetectUserLoggedInAAD,h=new a.Event.QosEventDeprecated(g);h.start();var i=function(a,b){window.formsDetectUserLoggedInCallback=void 0,h.end({resultType:b?"ExpectedFailure":"Success"}),$("#"+e).remove(),f.resolve(a)},j=b===c.Msa?d.signInLinkSilentMsa:d.signInLinkSilent,k=$("<iframe id='"+e+"' style='display: none' src='"+j+"' />");k.on("load",null,null,function(a){window.setTimeout(function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)},5e3)}),window.formsDetectUserLoggedInCallback=i,$(document.body).append(k)}return f.promise()},d.parseInnerCodeFromError=function(b){var c=b&&b.response&&a.Utilities.tryParseJson(b.response.body);return c.error&&parseInt(c.error.code)},d.signOutInIframe=function(){if(a.EnvironmentConfig.isOsi()){var b=new a.Event.QosEventDeprecated(a.Event.QosEventNames.Auth.Auth.SignOutInIframe);b.start();var c=$('<iframe style="display: none" src="'+OfficeFormServerInfo.signOutLink+'" />');c.on("load",null,null,function(a){b.end({resultType:"Success"})}),$(document.body).append(c)}},d.signInWithOtherAccount=function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Error.ErrorPage.SignInWithOtherAccount}),a.EnvironmentConfig.isOsi()&&d.getInstance().detectUserLoggedInWithProvider(c.Msa).then(function(b){if(b)a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Error.ErrorPage.SignOutInIframeInProgress}),Forms.Common.redirectTo(OfficeFormServerInfo.signOutLink);else{var c=window.location.origin+"#Login=True";Forms.Common.replaceUrl(c)}})},d.forceAadSignIn=function(){var b=window.location.href;b=a.Utilities.Html.updateUrlParam(b,a.EnvironmentSettings.AuthProviderParam,a.AuthProvider[a.AuthProvider.OrgId]),Forms.Common.replaceUrl(b)},d.signInLinkSilent=OfficeFormServerInfo.signInLinkSilent,d.signInLinkSilentMsa=OfficeFormServerInfo.signInLinkSilentMsa,d}();b.AuthTokenHelper=d}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){a[a.Succeeded=0]="Succeeded",a[a.Failed=1]="Failed"}(b=a.AsyncResultStatus||(a.AsyncResultStatus={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){}(b=a.Exports||(a.Exports={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){a[a.BackSpace=8]="BackSpace",a[a.Tab=9]="Tab",a[a.Enter=13]="Enter",a[a.Shift=16]="Shift",a[a.Esc=27]="Esc",a[a.Space=32]="Space",a[a.End=35]="End",a[a.Home=36]="Home",a[a.ArrowLeft=37]="ArrowLeft",a[a.ArrowUp=38]="ArrowUp",a[a.ArrowRight=39]="ArrowRight",a[a.ArrowDown=40]="ArrowDown",a[a.Delete=46]="Delete",a[a.Eight=56]="Eight",a[a.PlaceHolder=229]="PlaceHolder"}(b=a.KeyCode||(a.KeyCode={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){a[a.Unauthorized=401]="Unauthorized",a[a.Forbidden=403]="Forbidden",a[a.NotFound=404]="NotFound"}(b=a.HttpStatusCode||(a.HttpStatusCode={}));var c;!function(a){a[a.UpdateFormFailed=609]="UpdateFormFailed",a[a.GetFormFailed=612]="GetFormFailed",a[a.CDBColumnNotFound=621]="CDBColumnNotFound",a[a.CDBTopLevelError=631]="CDBTopLevelError",a[a.ExceedMaximumFormLimition=650]="ExceedMaximumFormLimition",a[a.CDBTableNotFound=674]="CDBTableNotFound",a[a.TableReadOnly=636]="TableReadOnly",a[a.CDBTableMoved=639]="CDBTableMoved",a[a.NoPermission=700]="NoPermission",a[a.RequireLogin=701]="RequireLogin",a[a.UserNotAllowed=702]="UserNotAllowed",a[a.DisabledByTenantAdmin=703]="DisabledByTenantAdmin",a[a.AntiForgeryTokenValidationError=704]="AntiForgeryTokenValidationError",a[a.UserNeedMultiFactorAuth=705]="UserNeedMultiFactorAuth",a[a.CDBUnauthorizedAccess=707]="CDBUnauthorizedAccess",a[a.NotAllowedBySetting=708]="NotAllowedBySetting",a[a.TokenExpired=711]="TokenExpired",a[a.NotRolloutMsaUser=712]="NotRolloutMsaUser",a[a.CoAuthNotAllowedForMsa=715]="CoAuthNotAllowedForMsa",a[a.NotAllowedByResponseOwnership=716]="NotAllowedByResponseOwnership",a[a.FailedToCheckUserLicense=750]="FailedToCheckUserLicense",a[a.LicenseNotFound=751]="LicenseNotFound",a[a.LicenseNotValid=752]="LicenseNotValid",a[a.AbusedForm=6100]="AbusedForm",a[a.ImageNotFound=805]="ImageNotFound",a[a.InvalidFormId=1001]="InvalidFormId",a[a.NotSupportComposeFormId=1002]="NotSupportComposeFormId",a[a.ResponseNotFound=1007]="ResponseNotFound",a[a.FormClosed=5e3]="FormClosed",a[a.MultiResponseNotAllowed=5001]="MultiResponseNotAllowed",a[a.FormNotStarted=5002]="FormNotStarted",a[a.FormEnded=5003]="FormEnded",a[a.FormSettingJSONParseError=5004]="FormSettingJSONParseError",a[a.NoODPermissionForOpenInExcel=5117]="NoODPermissionForOpenInExcel",a[a.FailedToCreatePermission=5501]="FailedToCreatePermission",a[a.FailedToDeletePermission=5503]="FailedToDeletePermission",a[a.CreateInfoNotCompletePermission=5504]="CreateInfoNotCompletePermission",a[a.DeleteNotExistPermission=5506]="DeleteNotExistPermission",a[a.CopyNotAllowed=5550]="CopyNotAllowed",a[a.FailedToTurnOnAllowCopy=5551]="FailedToTurnOnAllowCopy",a[a.FailedToTurnOffAllowCopy=5552]="FailedToTurnOffAllowCopy",a[a.IncorrectShareToken=5553]="IncorrectShareToken",a[a.ImageUploadFailed=5200]="ImageUploadFailed",a[a.ImageTypeConvertFailed=5201]="ImageTypeConvertFailed",a[a.ImageProviderGetCDBTokenFailed=5202]="ImageProviderGetCDBTokenFailed",a[a.CdbServiceUnavailable=6503]="CdbServiceUnavailable",a[a.OriginalOwnerIsEmpty=6700]="OriginalOwnerIsEmpty",a[a.OriginalOwnerNotFound=6701]="OriginalOwnerNotFound",a[a.CurrentSignedUserIsNotDelegator=6702]="CurrentSignedUserIsNotDelegator",a[a.EmbedFormNeedAuth=10001]="EmbedFormNeedAuth",a[a.WorkBookLostFocus=10100]="WorkBookLostFocus",a[a.GetTableDataFailed=10101]="GetTableDataFailed",a[a.InvalidWorkBookSchema=10102]="InvalidWorkBookSchema",a[a.DeleteFormFailed=10201]="DeleteFormFailed",a[a.DeleteFormSuccessed=10202]="DeleteFormSuccessed",a[a.DownloadExcelFileFailed=10203]="DownloadExcelFileFailed",a[a.DownloadExcelFileFailedOnIos=10204]="DownloadExcelFileFailedOnIos",a[a.ReexportToExcelFailed=10205]="ReexportToExcelFailed",a[a.DownloadExcelFileTimeout=10206]="DownloadExcelFileTimeout",a[a.FormCreationFromQTIFailed=10300]="FormCreationFromQTIFailed",a[a.FormCreationFromQTITimeout=10301]="FormCreationFromQTITimeout",a[a.NetworkIssue=15001]="NetworkIssue",a[a.GetGraphAPITokenFailed=15002]="GetGraphAPITokenFailed",a[a.LoginNotSupportInCurrentBrowser=15003]="LoginNotSupportInCurrentBrowser"}(c=a.InnerCode||(a.InnerCode={}))}(b=a.ErrorCode||(a.ErrorCode={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(b,c){if(!b&&!a.EnvironmentConfig.isProduction()&&!a.EnvironmentConfig.isProdAlternative()){var d=(new Error).stack;console.assert(b,c,d)}}function d(){return _.omit(L.getQueries(),"embed","oembedsso","themecolor","preview")}function e(){return!!L.getQueries().embed}function f(){return OfficeFormServerInfo.isOembedSPO}function g(){return!!L.getQueries().oembedsso&&!!L.getQueries().preview}function h(a){return void 0===a&&(a=!0),a&&(j()||i())?!0:!1}function i(){return a.EnvironmentSettings.IsTeamsIntegration&&a.EnvironmentConfig.isProduction()&&"Analyze"!==a.EnvironmentConfig.getPageType()?!0:!1}function j(){return a.EnvironmentSettings.IsAssignmentsIntegration}function k(a){return!!a}function l(){var a=navigator.userAgent.toLowerCase();return-1!==a.search("windows nt 10.")}function m(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("msie")||-1!==a.indexOf("trident/")}function n(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("edge/")}function o(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("firefox/")}function p(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}function q(){return $(window).width()<=768}function r(){return/ip(hone|od|ad)/.test(navigator.userAgent.toLowerCase())&&!window.MSStream}function s(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("mac os x")&&-1!==a.indexOf("version/9")&&-1!==a.indexOf("safari")}function t(){var a=navigator.userAgent;return!!a.match(/android/i)}function u(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("tbs/")}function v(){var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("micromessenger/")}function w(){var a,b;return a=document.createElement("div"),a.style.color="rgb(83,7,13)",document.body.appendChild(a),b=document.defaultView?document.defaultView.getComputedStyle(a,null).color:a.currentStyle.color,b=b.replace(/ /g,""),document.body.removeChild(a),"rgb(83,7,13)"!==b}function x(a){var b=_.clone(a);return _.each(b,function(a,c){_.isObject(a)&&(b[c]=x(a))}),b}function y(a){try{var b=JSON.parse(a);return b}catch(c){return a}}function z(a){return _.keys(a).filter($.isNumeric).map(function(a){return parseInt(a)})}function A(a){return _.keys(a).filter($.isNumeric).map(function(b){return a[b]})}function B(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(a=a.filter(function(a){return!!a}),!a.length)return $.Deferred().reject().promise();var c=$.Deferred(),d=a.length,e=function(a){0===--d&&c.reject(a)};return a.forEach(function(a){a.done(function(a){return c.resolve(a)}).fail(e)}),c.promise()}function C(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=a.map(function(a){var b=$.Deferred();return a.then(function(a){return a?b.reject(!0).promise():b.resolve(!1).promise()},function(a){return b.resolve(!1).promise()})});return $.when.apply($,c).then(function(a){return $.Deferred().resolve(!1).promise()},function(a){return $.Deferred().resolve(!0).promise()})}function D(a,b,c){var d=new Date;d.setTime(d.getTime()+c);var e="expires="+d.toUTCString(),f="path=/";document.cookie=a+"="+b+"; "+e+"; "+f}function E(a){a+="=";var b=document.cookie.split(";").filter(function(b){return b.indexOf(a)>=0});if(b.length>0){var c=b[0].trim();return c.substring(a.length,c.length)}return null}function F(a){D(a,null,(new Date).getTime()-9999)}function G(a){for(var b=0,c=0;c<a.length;c++)b=a.charCodeAt(c)+((b<<5)-b);return b}function H(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}function I(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}a.Exports.Utilities=b;var J;!function(a){function b(a){return null===a?void 0:a}function c(a){return void 0===a?null:a}a.nullToUndefined=b,a.undefinedToNull=c}(J=b.Conversion||(b.Conversion={}));var K=function(){function a(){}return a.isLocalDateEqual=function(a,b){return a&&b?a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate():void 0},a.compareLocalTime=function(a,b){if(a&&b){var c=1e3*(60*(60*a.getHours()+a.getMinutes())+a.getSeconds())+a.getMilliseconds(),d=1e3*(60*(60*b.getHours()+b.getMinutes())+b.getSeconds())+b.getMilliseconds();return c-d}return void 0},a.getTimeStamp=function(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())},a}();b.DateTime=K;var L;!function(b){function c(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=a.map(function(a){return a&&a.trim()}).filter(function(a){return!!a}).join(" ");return c||a.some(function(a){return""===a})||(c=void 0),c}function d(a){return f(a||window.location.search.substring(1))}function e(a){return f(a||window.location.hash.substring(1))}function f(a){var b={};return a&&a.trim().split("&").forEach(function(a){var c=a.split("="),d=c[0].trim();d&&(b[d]=decodeURIComponent(c[1]||"").trim())}),b}function g(a){var b=document.createElement("a");return b.href=a,b.href}function h(a){var b=document.createElement("a");return b.href=a,b.hostname}function i(a){var b=document.createElement("a");return b.href=a,b.search}function j(a,b){var c=a.indexOf("#"),d=-1===c?"":a.substr(c);a=-1===c?a:a.substr(0,c);var e=a.indexOf("?"),g=-1===e?"":a.substr(e);a=-1===e?a:a.substr(0,e);var h={};return g&&(h=f(g.substr(1))),_.extend(h,b),a+"?"+$.param(h)+d}function k(a,b,c){var d=a.indexOf("#"),e=-1===d?"":a.substr(d);a=-1===d?a:a.substr(0,d);var f=new RegExp("([?&])"+b+"=.*?(&|$)","i"),g=-1!==a.indexOf("?")?"&":"?";return a=a.match(f)?a.replace(f,"$1"+b+"="+c+"$2"):a+g+b+"="+c,a+e}function l(a,b,c,d,e){d=d||0,c=c||0;var f=b.height(),g=a.outerHeight();if(a.offset()&&b.offset()){var h=a.offset().top-b.offset().top;if(0>h)return void b.scrollTop(b.scrollTop()+h-(g+c>f?0:c));var i=Math.min(g,f),j=h+i-f;f>g+c+d?(i=g+d,j=h+i-f):f>g+c&&(i=g+c,j=h-c),j>0&&(e?b.animate({scrollTop:b.scrollTop()+j},"fast"):b.scrollTop(b.scrollTop()+j))}}function m(a,b){void 0===b&&(b=!0);var c=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return b&&(c=c.replace(/'/g,"&apos;")),c}function n(a,b){var d=_.extend({},a);for(var e in b)switch(e){case"className":case"aria-labelledby":case"aria-describedby":d[e]=c(d[e],b[e]);break;case"children":case"defaultValue":case"value":null!=b[e]&&(null!=d[e]?d[e]=[].concat(d[e],b[e]):d[e]=b[e]);break;case"style":null!=d[e]?_.extend(d[e],b[e]):d[e]=b[e];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":d[e]=o(d[e],b[e]);break;default:void 0!==b[e]&&(d[e]=b[e])}return d}function o(a,b){return function(c){a&&a(c),b&&b(c)}}function p(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return function(c){(0===b.length||b.indexOf(c.keyCode)>=0)&&a(c)}}function q(a){var b=a.nativeEvent.explicitOriginalTarget;return a.relatedTarget||b||document.activeElement}function r(){return window.innerWidth}function s(b,c,d,e){if(a.EnvironmentSettings.IsTeamsIntegration){var f=$("<a></a>");return f.attr("href",b),c||(c="_blank"),f.attr("target",c),f[0].click(),f.remove(),null}return c||d||e?d||e?e?window.open(b,c,d,e):window.open(b,c,d):window.open(b,c):window.open(b)}function t(a){var b="hiddeon-open-iframe",c=document.getElementById(b);c&&c.parentNode.removeChild(c),c=document.createElement("iframe"),c.id=b,c.name=b,c.hidden=!0,document.body.appendChild(c),c.contentWindow.location.href=a}function u(a){var b=v(a);return w(b)}function v(a){var b=["b"],c=_.map(b,function(a){return"<"+a+">"}),d=_.map(b,function(a){return"</"+a+">"}),e=_.map(b,function(a){return"&lt;"+a+"&gt;"}),f=_.map(b,function(a){return"&lt;/"+a+"&gt;"}),g=_.escape(a);return b.forEach(function(a,b){g=g.replaceAll(e[b],c[b]).replaceAll(f[b],d[b])}),g}function w(a){var b=document.createElement("span");return b.innerHTML=a,a=b.innerHTML}b.combineAttributes=c,b.getQueries=d,b.getHashes=e,b.getAbsoluteUrl=g,b.getHostName=h,b.getSearchString=i,b.updateUrlParams=j,b.updateUrlParam=k,b.scrollToShowSubelement=l,b.encodeHTML=m,b.mergeReactProps=n,b.wrapReactEvent=o,b.onKeyboardEvent=p,b.getTargetElementOfFocusEvent=q,b.getWindowWidth=r,b.safeOpen=s,b.hiddenOpen=t,b.sanitize=u}(L=b.Html||(b.Html={}));var M;!function(a){function b(a){return k.test(a)&&l.test(a)}function c(){return e()}function d(a){var b=/[0-9a-fA-F]*/g,c=a.match(b),d="";return _.map(c,function(a){return d+=a}),!a||/^[0-]*$/.test(a)}function e(){var a=f();return h(a)}function f(){var a=[g()+g(),g(),g(),g(),g()+g()+g()];return a.join("-")}function g(){var a=Math.floor(65536*Math.random()).toString(16);return j(a,4,"0")}function h(a){var b=parseInt(a.charAt(19),16);b=3&b|8;var c=b.toString(16);return a=i(a,14,"4"),a=i(a,19,c)}function i(a,b,c){return a.substring(0,b)+c+a.substring(b+1)}function j(a,b,c){for(var d=a.length,e=c.length;b>d;d+=e)a=c+a;return a}var k=/^[0-9a-fA-F\-]*$/,l=/^[^\-]{8}(\-[^\-]{4}){4}[^\-]{8}$/;a.isValidGuid=b,a.newGuid=c,a.isNullOrEmpty=d}(M=b.Guid||(b.Guid={}));var N;!function(a){function b(a){var b=(a||"").trim().replace(/[,]/g,"");return $.isNumeric(b)}function c(a){var b=(a||"").trim().replace(/[,]/g,"");return $.isNumeric(b)?parseFloat(b).toString():""}function d(a){return Math.floor(a)===a}a.isFormatedAsFloat=b,a.formatAsFloat=c,a.isInteger=d}(N=b.NumberValidation||(b.NumberValidation={}));var O;!function(a){function b(a){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(a)}a.isYouTubeUrl=b}(O=b.UrlValidation||(b.UrlValidation={}));var P;!function(a){var b=function(){function a(a,b){void 0===b&&(b=0),this.functionToCall=a,this.timeToWaitInMs=b}return a.prototype.callOnceLater=function(){var a=this;0!==this.timeToWaitInMs&&null!=this.handler&&this.clear(),null==this.handler&&(this.handler=setTimeout(function(){a.callImmediately()},this.timeToWaitInMs))},a.prototype.flush=function(){null!=this.handler&&(this.clear(),this.functionToCall())},a.prototype.callImmediately=function(){null!=this.handler&&this.clear(),this.functionToCall()},a.prototype.clear=function(){clearTimeout(this.handler),this.handler=void 0},a}();a.CallLater=b;var c=function(){function a(){this.callbacks=[]}return a.prototype.register=function(a){this.callbacks.push(a)},a.prototype.unregister=function(a){this.callbacks=_.without(this.callbacks,a)},a.prototype.trigger=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.callbacks.forEach(function(b){return b.apply(void 0,a)})},a.prototype.clear=function(){this.callbacks=[]},a}();a.CallbackManager=c;var d=function(){function a(){this.buffer=[]}return a.prototype.setFunctionToCall=function(a){var b=this;if(this.functionToCall!==a)if(this.functionToCall=a,a){var c=this.buffer;delete this.buffer,c&&c.length&&c.forEach(function(a){return b.functionToCall.apply(void 0,a)})}else this.buffer=this.buffer||[]},Object.defineProperty(a.prototype,"queue",{get:function(){return this.functionToCall?this.functionToCall:this.defaultQueue},enumerable:!0,configurable:!0}),a.prototype.defaultQueue=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.buffer.push(a)},a}();a.BufferForCall=d;var e=function(){function a(a){this.queue=[],this.jobCountLeft=a}return a.prototype.queueJob=function(a){a&&(this.queue.push(a),this.tryProcessQueuedJob())},a.prototype.stopProcessingNewJob=function(){this.jobCountLeft=-(1/0)},a.prototype.tryProcessQueuedJob=function(){for(var a=this;this.jobCountLeft>0&&this.queue.length;){--this.jobCountLeft;var b=this.queue.shift();b().always(function(){++a.jobCountLeft,a.tryProcessQueuedJob()})}},a}();a.Pool=e}(P=b.Process||(b.Process={}));var Q;!function(a){function b(a){var b=$.Deferred();return b.reject(a).promise()}function c(a){var b=$.Deferred();return b.resolve(a).promise()}function d(a){return a?a.then(null,function(){return c()}):c()}function e(a){var b=$.Deferred();return a.then(function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.resolve.apply(b,a)})["catch"](function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.reject.apply(b,a)}),b.promise()}a.getRejectedPromise=b,a.getResolvedPromise=c,a.always=d,a.fromJavaScriptPromise=e;var f=function(){function a(){}return Object.defineProperty(a,"Pending",{get:function(){return"pending"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Resolved",{get:function(){return"resolved"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Rejected",{get:function(){return"rejected"},enumerable:!0,configurable:!0}),a}();a.State=f}(Q=b.Promise||(b.Promise={}));var R;!function(c){function d(){return _.pick(L.getQueries(),["d"])}function e(){return p("debug")}function f(){return p("d")}function g(){return f()&&!a.EnvironmentConfig.isProduction()}function h(){return p("msa")}function i(){return p("oembedssotrial")&&a.EnvironmentConfig.isProduction()||p("oembedsso")}function j(){return f()&&!a.EnvironmentConfig.isProduction()}function k(){return p("standalone")&&!a.EnvironmentConfig.isProduction()}function l(){if(p("pptcontentsso")){var c=b.Html.getQueries().hostplatform;if("PC"===c&&a.Flighting.Flight.isEnabled(a.Flighting.Flights.PPTWin32ContentAddinSSO))return!0;if("OfficeOnline"===c&&a.Flighting.Flight.isEnabled(a.Flighting.Flights.PPTContentAddinSSO))return!0}return!1}function m(){return p("pptintegration")}function n(){return p("runtimeautorefresh")}function o(){return p("streamsso")}function p(a,b){void 0===b&&(b=!1);var c=L.getQueries()[a];return""===c?!0:c?(Array.isArray(c)&&(c=c[0]),b?"false"!==c.toLowerCase():"true"===c.toLowerCase()):b}c.getFlightQuery=d,c.isDebugMode=e,c.isDarkFunctionalitiesEnabled=f,c.isIvyChartEnabled=g,c.isMsaLoginEnabled=h,c.isOembedTrialSSOEnabled=i,c.isDebugOpenExcelInOneDrive=j,c.isStandalone=k,c.isPPTContentAddinSSOEnabled=l,c.isPPTIntegration=m,c.isRuntimePageAutoRefreshEnabled=n,c.isStreamSSOEnabled=o}(R=b.Flight||(b.Flight={}));var S;!function(a){function b(a){return"number"==typeof a}function c(a){return"string"==typeof a}a.isNumber=b,a.isString=c}(S=b.Type||(b.Type={}));var T;!function(a){function c(){if(OfficeFormServerInfo.isOembedSPO&&$(".office-form.office-form-theme-shadow").height()&&$(".office-form-footer-container").height()){var b=$(".office-form.office-form-theme-shadow").height()+$(".office-form-footer-container").height()+j;b+=$(".office-form-new-bottom-bar").height()?$(".office-form-new-bottom-bar").height():0;var c="ResponsePage";a.nofityPageHeightToParentWindow(c,b)}}function d(){if(OfficeFormServerInfo.isOembedSPO&&$(".analysis-page-content").height()){var b=$(".analysis-page-content").height()+i,c="AnalysisPage";a.nofityPageHeightToParentWindow(c,b)}}function e(b){OfficeFormServerInfo.isOembedSPO&&a.nofityPageHeightToParentWindow("ResponsePage",b)}function f(a,c){var d=b.Html.getQueries().hostId;if(d)parent.postMessage("FormsPageHeight:"+d+":"+c.toString(),"*");else{var e=b.Html.getQueries().id;parent.postMessage(a+"Height:"+e+":"+c.toString(),"*")}}function g(a){if(OfficeFormServerInfo.isOembedSPO){var c=a.Model.Title?a.Model.Title:"",d=a.Model.Description?a.Model.Description:"",e=b.Html.getQueries().hostId;parent.postMessage("FormsInfo:"+e+":"+encodeURIComponent(c)+":"+encodeURIComponent(d),"*")}}function h(a){if(OfficeFormServerInfo.isOembedSPO){var c=a&&(a.innerCode||a.message||""),d=b.Html.getQueries().hostId;parent.postMessage("FormsError:"+d+":"+encodeURIComponent(c),"*")}}var i=50,j=80;a.notifyResponsePageHeightToParentWindow=c,a.notifyAnalysisPageHeightToParentWindow=d,a.notifyResponsePageFixedHeightToParentWindow=e,a.nofityPageHeightToParentWindow=f,a.notifyFormInfoToParentWindow=g,
a.notifyFormErrorToParentWindow=h}(T=b.OEmbed||(b.OEmbed={})),b.assert=c,b.getNonEmbedQuery=d,b.isOEmbed=e,b.isOEmbedSPO=f,b.isOEmbedSPOPreview=g,b.enterSSO=h,b.applyTeamSSO=i,b.applyAssignmentsSSO=j,b.isPhishingForm=k,b.isWin10=l,b.isIE=m,b.isEdge=n,b.isFireFox=o,b.isMobile=p,b.isSmallScreen=q,b.isIOS=r,b.isSafari9=s,b.isAndroid=t,b.isTbsBrowser=u,b.isMicroMessenger=v,b.isHighContrastMode=w,b.deepClone=x,b.tryParseJson=y,b.getAllEnumValues=z,b.getAllEnumValueNames=A,b.some=B,b.anyTrue=C,b.setCookie=D,b.getCookie=E,b.clearCookie=F,b.hashCode=G,b.isRtl=H;var U;!function(a){a.mathSeparator="⁣"}(U=b.MathHelper||(b.MathHelper={}));var V;!function(a){a.waitingForExport="WaitingForExport"}(V=b.ExcelHelper||(b.ExcelHelper={})),b.regExpEscape=I}(b=a.Utilities||(a.Utilities={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return b.setLogHandler=function(a){this.buffer.setFunctionToCall(a)},b.logData=function(b){a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?Forms.Telemetry.log({eventName:b.errorName,eventType:"engagement_event",extraData:b.errorInfo}):this.buffer.queue(b)},b.buffer=new a.Utilities.Process.BufferForCall,b}();b.ErrorEventDeprecated=c}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(a){a[a.Start=0]="Start",a[a.End=1]="End",a[a.Log=2]="Log"}(c=b.QosEventType||(b.QosEventType={}));var d=function(){function b(b){this.qos=null,this.event={Name:b,Duration:0,CorrelationId:a.Utilities.Guid.newGuid(),Data:{}},a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)&&(this.qos=new Forms.Telemetry.QosEvent(b))}return b.setLogHandler=function(a){this.buffer.setFunctionToCall(a)},Object.defineProperty(b.prototype,"Name",{get:function(){return this.event.Name},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Duration",{get:function(){return this.event.Duration},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"CorrelationId",{get:function(){return a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?this.qos.CorrelationId:this.event.CorrelationId},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Data",{get:function(){return this.event.Data},enumerable:!0,configurable:!0}),b.prototype.start=function(){this.startTime=a.Utilities.DateTime.getTimeStamp(),a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?(this.qos.ExtraData=this.Data.extraData,this.qos.start()):b.buffer.queue(this.event,c.Start)},b.prototype.end=function(d){var e=this.prepareEvent(d);a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?this.qos.end({resultCode:e.Data.resultCode,resultType:e.Data.resultType,logLevel:"Info",extraData:e.Data.extraData}):b.buffer.queue(e,c.End)},b.prototype.log=function(d){var e=this.prepareEvent(d);a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?this.qos.log({resultCode:e.Data.resultCode,resultType:e.Data.resultType,logLevel:"Info",extraData:e.Data.extraData}):b.buffer.queue(e,c.Log)},b.prototype.prepareEvent=function(b){var c=_.clone(this.event);return _.extend(c.Data,b),null!=this.startTime?c.Duration=a.Utilities.DateTime.getTimeStamp()-this.startTime:c.Duration=-1,c},b.buffer=new a.Utilities.Process.BufferForCall,b}();b.QosEventDeprecated=d}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){var b=function(){function a(){}return a.AcquireToken="Auth.AcquireToken",a.DetectUserLoggedInAAD="Auth.DetectUserLoggedInAAD",a.GetToken="Auth.GetToken",a.RefreshToken="Auth.RefreshToken",a.DetectUserLoggedInMSA="Auth.DetectUserLoggedInMSA",a.SignOutInIframe="Auth.SignOutInIframe",a}();a.Auth=b}(c=b.Auth||(b.Auth={}));var d;!function(a){var b=function(){function a(){}return a.DataSync="AddinPage.SyncView.DataSync",a}();a.SyncView=b}(d=b.AddinPage||(b.AddinPage={}));var e;!function(a){var b=function(){function a(){}return a.InsertPoll="OutlookCreatePollPage.TaskPaneView.InsertPoll",a}();a.TaskPaneView=b}(e=b.OutlookCreatePollPage||(b.OutlookCreatePollPage={}));var f;!function(a){var b=function(){function a(){}return a.CreateExportFile="Action.CreateExportFile",a.CreateRespTable="Action.CreateRespTable",a.GetRespTable="Action.GetRespTable",a.OpenExcelInOneDrive="Action.OpenExcelInOneDrive",a.GetXlWorkbookId="Action.GetXlWorkbookId",a}();a.Action=b;var c=function(){function a(){}return a.ConnectToForms="Connection.ConnectToFormsSignalR",a.ConnectToCDB="Connection.ConnectToCDBSignalR",a.InvokeMethod="Connection.InvokeRemoteMethod",a}();a.Connection=c;var d=function(){function a(){}return a.BrowseImage="Decomposition.BrowseImage",a.SearchImage="Decomposition.SearchImage",a.GetCdbToken="Decomposition.GetCdbToken",a.GetOD4BToken="Decomposition.GetOD4BToken",a}();a.Decomposition=d;var e=function(){function a(){}return a.DuplicateFormForExcel="Excel.DuplicateFormForExcel",a}();a.Excel=e;var f=function(){function a(){}return a.GetGroups="Groups.Get",a.GetPhotoDefinition="Group.GetPhotoDefinition",a.GetPhotoValue="Group.GetPhotoValue",a.GetGroup="Group.Get",a.GetOwners="Group.GetOwners",a.GetMembers="Group.GetMembers",a.GetMemberPhotoDefinition="Group.GetMemberPhotoDefinition",a.GetMemberPhotoValue="Group.GetMemberPhotoValue",a}();a.Group=f;var g=function(){function a(){}return a.TurnOnFormSharing="FormDefinition.TurnOnFormSharing",a.TurnOffFormSharing="FormDefinition.TurnOffFormSharing",a.CreateForm="Form.Create",a.CreateImageFromUrl="FormImage.CreateFromUrl",a.DeleteForm="Form.Delete",a.GetForms="Forms.Get",a.SearchServerForms="Forms.SearchServer",a.SoftDeleted="Form.Updata.SoftDeleted",a.GetSharedWithMeForms="Forms.Get.SharedWithMe",a.GetDesignForm="DesignForm.Get",a.GetFormDefinition="FormDefinition.Get",a.GetRuntimeForm="ResponseForm.Get",a.GetRuntimeForm2="ResponseForm2.Get",a.GetAnalysisForm="AnalysisForm.Get",a.GetSharedForm="SharedForm.Get",a.SetFormDefinition="FormDefinition.Set",a.UpdateForm="Form.Update",a.CreateFormPermissionLink="FormDefinition.CreateFormPermissionLink",a.DeleteFormPermissionLink="FormDefinition.DeleteFormPermissionLink",a.GetFormPermissions="FormDefinition.GetFormPermissions",a.CreateFormPermissionToken="FormDefinition.CreateFormPermissionToken",a.DeleteFormPermissionToken="FormDefinition.DeleteFormPermissionToken",a.GetFormPermissionsToken="FormDefinition.GetFormPermissionsToken",a.CreateThemeImageFromUrl="ThemeImage.CreateFromUrl",a.GetIdentityProviderType="Form.GetIdentityProviderType",a.GetGroupId="Form.GetGroupId",a.GetTeamsInfo="Form.GetTeamsInfo",a.GetOrCreatePermissionToken="Form.GetOrCreatePermissionToken",a.GetInsights="Form.GetInsights",a.CreateOD4BSessionTempFolder="Form.CreateOD4BSessionTempFolder",a.PostShareAction="Form.PostShareAction",a}();a.Form=g;var h=function(){function a(){}return a.GetFormId="Function.GetFormId",a.GetUserInfo="Function.GetUserInfo",a.GetShellServiceInfo="Function.GetShellServiceInfo",a.GetConsumerShellServiceInfo="Function.GetConsumerShellServiceInfo",a.GetYouTubeVideoInfo="Function.GetYouTubeVideoInfo",a.DownloadExcelFileApi="Function.DownloadExcelFileApi",a.GetFormsTenantSettings="Function.GetFormsTenantSettings",a.GetRecentForms="Function.GetRecentForms",a.RemoveRecentForm="Function.RemoveRecentForm",a.MoveForm="Function.MoveForm",a.GetFormCreatorPhotoDefinition="Function.GetFormCreatorPhotoDefinition",a.GetFormCreatorPhotoValue="Function.GetFormCreatorPhotoValue",a.GetCurrentUserPhotoValue="Function.GetCurrentUserPhotoValue",a.GetMuid="Function.GetMuid",a.IsMemberOf="Function.IsMemberOf",a.GetPrivacySettings="Function.GetPrivacy",a}();a.Function=h;var i=function(){function a(){}return a.DeleteImage="Image.Delete",a.UploadImage="Image.Upload",a}();a.Image=i;var j=function(){function a(){}return a.SendMail="MSGraph.SendMail",a}();a.MSGraph=j;var k=function(){function a(){}return a.CreateFormFromQti="Qti.CreateForm",a}();a.Qti=k;var l=function(){function a(){}return a.CreateImageFromUrl="QuestionImage.CreateFromUrl",a.CreateQuestion="Question.Create",a.DeleteQuestion="Question.Delete",a.GetQuestion="Question.Get",a.GetQuestionCount="QuestionCount.Get",a.GetQuestions="Questions.Get",a.UpdateQuestion="Question.Update",a.TextAnalysis="Question.TextAnalysis",a.MathCalculation="Question.MathCalculation",a.MathQuestionGeneration="Question.MathQuestionGeneration",a}();a.Question=l;var m=function(){function a(){}return a.Create="DescriptiveElement.Create",a.Delete="DescriptiveElement.Delete",a.Get="DescriptiveElement.Get",a.Update="DescriptiveElements.Update",a}();a.DescriptiveElement=m;var n=function(){function a(){}return a.CreateChoice="Choice.Create",a.GetChoice="Choice.Get",a.UpdateChoice="Choice.Update",a.DeleteChoice="Choice.Delete",a}();a.Choice=n;var o=function(){function a(){}return a.DeleteResp="Response.Delete",a.DeleteResps="Responses.Delete",a.GetRespCount="ResponseCount.Get",a.GetResps="Responses.Get",a.GetRuntimeResps="RuntimeResponses.Get",a.GetRuntimeResponse="RuntimeResponse.Get",a.GetAnalysisTimeResponses="AnalysisTimeResponses.Get",a.GetRespFilter="Responses.Get.Filter",a.SubmitAnswer="Answer.Submit",a.SubmitResp="Response.Submit",a.AddComment="Comment.Add",a.SetReleaseDate="Response.Update",a}();a.Response=o;var p=function(){function a(){}return a.ReportAbuse="OnlineSafety.ReportAbuse",a}();a.OnlineSafety=p;var q=function(){function a(){}return a.AggregateSurveyData="Analysis.AggregateSurveyData",a.ResultSharingAggregateSurveyData="Analysis.ResultSharingAggregateSurveyData",a.AggregateQuizData="Analysis.AggregateQuizData",a.ResultSharingAggregateQuizData="Analysis.ResultSharingAggregateQuizData",a}();a.Analysis=q;var r=function(){function a(){}return a.MethodNameFormat="PageMethod.{0}",a}();a.PageMethod=r;var s=function(){function a(){}return a.GetUserSettings="UserSettings.Get",a.UpdateUserSettings="UserSettings.Update",a}();a.UserSettings=s;var t=function(){function a(){}return a.GetAllLocales="Locale.GetAll",a.GetLocale="Locale.Get",a.DeleteLocale="Locale.Delete",a.CreateLocaleItem="LocaleItem.Create",a.UpdateLocaleItem="LocaleItem.Update",a}();a.Multilingual=t}(f=b.ServiceEndpoints||(b.ServiceEndpoints={}));var g=function(){function a(){}return a.NPSLoad="OfficeNPS.load",a}();b.OfficeNPS=g,a.Exports.QosEventNames=b}(c=b.QosEventNames||(b.QosEventNames={}))}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function a(){}return Object.defineProperty(a,"DefaultStorage",{get:function(){return a.defaultStorage||(a.defaultStorage=a.LocalStorage,a.defaultStorage instanceof c&&(a.defaultStorage=a.SessionStorage)),a.defaultStorage},enumerable:!0,configurable:!0}),Object.defineProperty(a,"LocalStorage",{get:function(){return a.localStorage||(a.supportsLocalStorage()?a.localStorage=window.localStorage:a.localStorage=a.NoStorage),a.localStorage},enumerable:!0,configurable:!0}),Object.defineProperty(a,"SessionStorage",{get:function(){return a.sessionStorage||(a.supportsSessionStorage()?a.sessionStorage=window.sessionStorage:a.sessionStorage=a.NoStorage),a.sessionStorage},enumerable:!0,configurable:!0}),Object.defineProperty(a,"NoStorage",{get:function(){return a.noStorage||(a.noStorage=new c),a.noStorage},enumerable:!0,configurable:!0}),a.supportsLocalStorage=function(){if(null==a.localStorageSupported)try{var b="officeforms.__storage_test__";localStorage.setItem(b,b),localStorage.removeItem(b),a.localStorageSupported=!0}catch(c){a.localStorageSupported=!1}return a.localStorageSupported},a.supportsSessionStorage=function(){if(null==a.sessionStorageSupported)try{var b="officeforms.__storage_test__";sessionStorage.setItem(b,b),sessionStorage.removeItem(b),a.sessionStorageSupported=!0}catch(c){a.sessionStorageSupported=!1}return a.sessionStorageSupported},a}();a.SafeStorage=b,a.Exports.SafeStorage=b;var c=function(){function a(){}return a.prototype.clear=function(){},a.prototype.getItem=function(a){},a.prototype.key=function(a){return null},a.prototype.removeItem=function(a){},a.prototype.setItem=function(a,b){},a}()}(OfficeForm||(OfficeForm={})),String.prototype.format||(String.prototype.format=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return this.replace(/{(\d+)}/g,function(b,c){return void 0!==a[c]?a[c]:b})}),String.prototype.trimEnd=function(a){for(var b=this,c=b.length;--c>=0&&!(a.indexOf(b.charAt(c))<0););return b.substr(0,c+1)},String.prototype.startsWith=function(a){if(null==a||0===a.length)return!0;var b=this;return null==b||b.length<a.length?!1:a===b.substr(0,a.length)},String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(escapeRegExp(a),"g"),b)},"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var a=/function\s([^(]{1,})\(/,b=a.exec(this.toString());return b&&b.length>1?b[1].trim():""}});var stringDelimiter=/('[^']*'|"[^"]*")/g,dateLabelsRegExp=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;Date.prototype.toFormatString=function(a,b){var c=this;if(null==c||null==a||null==b)return null;var d=a.split(dateLabelsRegExp).map(function(a){switch(a){case"d":case"dd":return formatNumber(c.getDate(),a.length);case"ddd":return b.DateTimeFormat.AbbreviatedDayNames[c.getDay()];case"M":case"MM":return formatNumber(c.getMonth()+1,a.length);case"MMM":return b.DateTimeFormat.AbbreviatedMonthNames[c.getMonth()];case"yy":var d=c.getFullYear(),e=formatNumber(d,4);return d>b.Calendar.TwoDigitYearMax-100&&d<=b.Calendar.TwoDigitYearMax?e.slice(2):e;case"yyy":case"yyyy":case"yyyyy":return formatNumber(c.getFullYear(),a.length);case"H":case"HH":return formatNumber(c.getHours(),a.length);case"h":case"hh":return formatNumber((c.getHours()+11)%12+1,a.length);case"m":case"mm":return formatNumber(c.getMinutes(),a.length);case"s":case"ss":return formatNumber(c.getSeconds(),a.length);case"t":case"tt":var f=c.getHours()<12?b.DateTimeFormat.AMDesignator:b.DateTimeFormat.PMDesignator;return 1===a.length?f.charAt(0):f;default:return removeQuatos(a)}}).join("");return d},Date.prototype.toDateShortString=function(a){var b=this;return b.toFormatString(a.DateTimeFormat.ShortDatePattern,a)},Date.prototype.toTimeShortString=function(a){var b=this;return b.toFormatString(a.DateTimeFormat.ShortTimePattern,a)},Date.parseDate=function(a,b,c){var d=parseStringToDateLabels(a,b,c),e=parseInt(d.yyyy||d.yyy),f=parseInt(d.yy);if(isNaN(e)&&!isNaN(f))if(f>=100)e=f;else{var g=OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax%100;e=g>=f?OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax-g+f:OfficeFormServerInfo.cultureInfo.Calendar.TwoDigitYearMax-g-100+f}var h=parseInt(d.MM||d.M),i=d.MMM;isNaN(h)&&i&&(h=c.DateTimeFormat.AbbreviatedMonthNames.indexOf(i)+1);var j=parseInt(d.dd||d.d),k=getTime(d,c);if(!(isNaN(e)||isNaN(h)||isNaN(j)||isNaN(k))){var l=new Date(e,h-1,j,0,0,0,k);if(l.getFullYear()===e&&l.getMonth()+1===h&&l.getDate()===j)return l}return null},Date.parseTime=function(a,b,c){var d=parseStringToDateLabels(a,b,c);return d.time=!0,getTime(d,c)};var OfficeForm;!function(a){var b=function(){function b(){}return b.getEnvironmentType=function(){if(null==b.currentEnvironmentType){var a=b.getHostUrl(),c=OfficeFormServerInfo.deployment.toLocaleLowerCase();c.indexOf("usgovdodproduction")>=0?b.currentEnvironmentType="USDoDProd":c.indexOf("usgovproduction")>=0?b.currentEnvironmentType="USGovProd":c.indexOf("usgovgccproduction")>=0?b.currentEnvironmentType="USGovGccProd":a.indexOf("forms.office.com")>=0||a.indexOf("forms.osi.office.net")>=0?b.currentEnvironmentType="WWProd":a.indexOf("forms.officeppe.com")>=0?b.currentEnvironmentType="EDog":a.indexOf("forms.office-int.com")>=0||a.indexOf("forms.osi.office-int.net")>=0?b.currentEnvironmentType="Int":a.indexOf("formweekly")>=0?b.currentEnvironmentType="Weekly":a.indexOf("formhotfix")>=0?b.currentEnvironmentType="Hotfix":a.indexOf("formdaily")>=0?b.currentEnvironmentType="Daily":a.indexOf("formpilot")>=0?b.currentEnvironmentType="Pilot":a.indexOf("formtrial")>=0?b.currentEnvironmentType="Trial":a.indexOf("formdrill")>=0?b.currentEnvironmentType="Drill":a.indexOf("localhost")>=0&&(b.currentEnvironmentType="DevHost")}return b.currentEnvironmentType},b.getMuidHost=function(){switch(b.getEnvironmentType()){case"WWProd":return"https://c.office.com";case"EDog":return"https://c.officeppe.com";case"Int":return"https://c.office-int.com";default:return null}},b.getPageType=function(){var a=window.location.pathname.toLowerCase();switch(a){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";default:return"Unknown"}},b.isProdAlternative=function(){var a=b.getHostUrl();return a.indexOf(".forms.osi.office.net")>0},b.isProduction=function(){var a=b.getEnvironmentType();return"WWProd"===a||"USGovProd"===a||"USDoDProd"===a||"USGovGccProd"===a},b.isSovereignProd=function(){var a=b.getEnvironmentType();return"USGovProd"===a||"USDoDProd"===a||"USGovGccProd"===a},b.isUSGovGccProd=function(){return"USGovGccProd"===b.getEnvironmentType()},b.isMsftProduction=function(){return"72f988bf-86f1-41af-91ab-2d7cd011db47"===OfficeFormServerInfo.userInfo.TenantId},b.isOsi=function(){switch(b.getEnvironmentType()){case"Int":case"EDog":case"WWProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":return!0;default:return!1}},b.getAadInstance=function(){var a=Forms.AuthRelatedLocalStorage.UseLegacyLoginDomain;return b.isProduction()?a?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"},b.getMSGraphAPIHost=function(){return b.isProduction()?"https://graph.microsoft.com/":"https://graph.microsoft-ppe.com"},b.getAadClientId=function(){return"USGovProd"===b.getEnvironmentType()||"USDoDProd"===b.getEnvironmentType()?"032e56fd-dfe5-4a50-8017-89692bcbcb0e":"038ed4f5-da78-47bc-8176-9153c79e0edb"},b.getFormsResourceId=function(){return"USGovProd"===b.getEnvironmentType()||"USDoDProd"===b.getEnvironmentType()?"153a74ba-783f-4394-bc9a-a109ef69f5c2":"c9a559d2-7aab-4f13-a6ed-e7e9c52aec87"},b.getUserInfoUrl=function(){return"https://portal.{0}/account/#personalinfo".format(b.isProduction()?b.getOffice365Domain(b.getEnvironmentType(),!0):b.getOffice365Domain("EDog",!0))},b.getConsumerInfoUrl=function(){return"https://account.{0}".format(b.isProduction()?b.getOffice365ConsumerDomain(b.getEnvironmentType()):b.getOffice365ConsumerDomain("EDog"))},b.getHrdV2Url=function(){var a=b.getExplictLocale();return"https://{0}/odc/v2.1/hrd?{1}Ver=16&app=111&p=6&hm=0&fpEnabled=1".format(b.getHrdV2Domain(),null!=a?"rs={0}&".format(a):"")},b.getHrdV2Domain=function(){return b.isProduction()?"odc.officeapps.live.com":"odc.edog.officeapps.live.com"},b.getCollabDBResourceId=function(a){return"https://lists."+b.getOffice365Domain(a)},b.getLorPickerOrigin=function(){var a=b.getEnvironmentType();switch(a){case"DevHost":return"https://educationresources-int.microsoft.com";case"Trial":return"https://educationresources-int.microsoft.com";case"Weekly":return"https://educationresources-int.microsoft.com";case"Daily":return"https://educationresources-int.microsoft.com";case"Int":return"https://educationresources-int.microsoft.com";case"EDog":return"https://educationresources-ppe.microsoft.com";case"WWProd":return"https://educationresources.microsoft.com";default:return"https://educationresources-int.microsoft.com"}},b.getLorPickerUrl=function(a){var c=b.getLorPickerOrigin(),d=b.getLorPickerHostParameter();return c+"/?supportedFormat=QTI&supportedResourceType=Assessment&host="+d+"&correlationId="+a},b.getMsftTenantId=function(){var a=b.getEnvironmentType();switch(a){case"WWProd":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}},b.getMsaTenantId=function(){var a=b.getEnvironmentType();switch(a){case"WWProd":case"EDog":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}},b.getFastFoodTenantsId=function(){var a=b.getEnvironmentType();switch(a){case"WWProd":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}},b.getExplictLocale=function(){return a.Utilities.Html.getQueries().lang||null},b.getEnvironmentTypeForNonOSI=function(){var a=b.getDesiredProvider();if("int"===a)return"Int";if("edog"===a)return"EDog";switch(b.getEnvironmentType()){case"Trial":return"EDog";default:return"Int"}},b.getDesiredProvider=function(){var b=a.Utilities.Html.getQueries().dataprovider;switch(b){case"int":case"edog":return b;default:return null}},b.getOffice365Domain=function(a,c){switch(void 0===c&&(c=!1),null==a&&(a=b.getEnvironmentType()),a){case"USDoDProd":return c?"apps.mil":"osi.apps.mil";case"USGovProd":return c?"office365.us":"osi.office365.us";case"USGovGccProd":return c?"office.com":"gcc.osi.office365.us";case"WWProd":return"office.com";case"EDog":case"Trial":return"officeppe.com";default:return"office-int.com"}},b.getOffice365ConsumerDomain=function(a){switch(null==a&&(a=b.getEnvironmentType()),a){case"WWProd":return"microsoft.com";case"EDog":case"Trial":return"microsoft-ppe.com";default:return"microsoft-int.com"}},b.getHostUrl=function(){var a=window.location.host;return a.toLocaleLowerCase()},b.getLorPickerHostParameter=function(){var a=b.getEnvironmentType();switch(a){case"DevHost":return"msforms-dev";case"Trial":return"msforms-trial";case"Weekly":return"msforms-weekly";case"Daily":return"msforms-daily";case"Int":return"msforms-int";case"EDog":return"msforms-ppe";case"WWProd":return"msforms";default:return"msforms-trial"}},b}();a.EnvironmentConfig=b,a.Exports.EnvironmentConfig=b}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){a.Exports.Flighting=b;var c={},d={},e=function(){function b(){}return b.refreshFlights=function(){b.flights=OfficeFormServerInfo.flights&&OfficeFormServerInfo.flights.split(";")||b.flights},b.isEnabled=function(a){if(d[a]&&!d[a].every(b.isEnabled))return!1;var e=-1!==b.flightsOverride.indexOf("!"+g[a].toUpperCase());if(e)return!1;var f=-1!==b.flightsOverride.indexOf(g[a].toUpperCase());if(f)return!0;var h=-1!==b.flights.indexOf("!"+a)||-1!==b.flights.indexOf("!"+g[a]);if(h)return!1;var i=-1!==b.flights.indexOf(""+a)||-1!==b.flights.indexOf(g[a]);return i?!0:c[a]&&c[a].OnInCurrentEnvironment},b.foQuery=a.EnvironmentConfig.isProduction()&&!a.EnvironmentConfig.isProdAlternative()?"":a.Utilities.Html.getQueries().fo,b.flightsOverride=b.foQuery&&b.foQuery.split(";").map(function(a){return a.toUpperCase()})||[],b.flights=OfficeFormServerInfo.flights&&OfficeFormServerInfo.flights.split(";")||[],b}();b.Flight=e;var f;!function(a){a[a.OnDevBox=0]="OnDevBox",a[a.OnDevBoxAndDaily=1]="OnDevBoxAndDaily",a[a.AllOnNonOSI=2]="AllOnNonOSI",a[a.AllOnButEDogProd=3]="AllOnButEDogProd",a[a.AllOn=4]="AllOn",a[a.AllOff=5]="AllOff"}(f||(f={}));var g,h=function(){function b(a,b,c,d,e,g,h){if(null!=a)switch(a){case f.OnDevBox:this._onInDevhost=!0,this._onInDaily=!1,this._onInWeekly=!1,this._onInInt=!1,this._onInEDog=!1,this._onInProd=!1;break;case f.OnDevBoxAndDaily:this._onInDevhost=!0,this._onInDaily=!0,this._onInWeekly=!1,this._onInInt=!1,this._onInEDog=!1,this._onInProd=!1;break;case f.AllOnNonOSI:this._onInDevhost=!0,this._onInDaily=!0,this._onInWeekly=!0,this._onInInt=!1,this._onInEDog=!1,this._onInProd=!1;break;case f.AllOnButEDogProd:this._onInDevhost=!0,this._onInDaily=!0,this._onInWeekly=!0,this._onInInt=!0,this._onInEDog=!1,this._onInProd=!1;break;case f.AllOn:this._onInDevhost=!0,this._onInDaily=!0,this._onInWeekly=!0,this._onInInt=!0,this._onInEDog=!0,this._onInProd=!0;break;case f.AllOff:this._onInDevhost=!1,this._onInDaily=!1,this._onInWeekly=!1,this._onInInt=!1,this._onInEDog=!1,this._onInProd=!1}else this._onInDevhost=!!b,this._onInDaily=!!c,this._onInWeekly=!!d,this._onInInt=!!e,this._onInEDog=!!g,this._onInProd=!!h}return Object.defineProperty(b.prototype,"OnInCurrentEnvironment",{get:function(){var b=a.EnvironmentConfig.getEnvironmentType();switch(b){case"DevHost":return this._onInDevhost;case"Daily":case"Drill":case"Pilot":case"Trial":return this._onInDaily;case"Weekly":case"Hotfix":return this._onInWeekly;case"Int":return this._onInInt;case"EDog":return this._onInEDog;case"WWProd":case"USGovProd":case"USDoDProd":case"USGovGccProd":return this._onInProd}return!1},enumerable:!0,configurable:!0}),b}();!function(a){a[a.ResponseInApp=0]="ResponseInApp",a[a.ReExportToExcelButton=1]="ReExportToExcelButton",a[a.O365ConsumerWaffle=2]="O365ConsumerWaffle",a[a.EnableOnlineExcelForMSA=3]="EnableOnlineExcelForMSA",a[a.QRCodePlus=4]="QRCodePlus",a[a.ShareQuickSubmitPage=5]="ShareQuickSubmitPage",a[a.PageInitializationVerboseLogs=6]="PageInitializationVerboseLogs",a[a.FileUpload=7]="FileUpload",a[a.PartialPut=8]="PartialPut",a[a.FileUploadOnlyLargeFileAPI=9]="FileUploadOnlyLargeFileAPI",a[a.DropDown=10]="DropDown",a[a.CopyPasteForChoice=11]="CopyPasteForChoice",a[a.DisableOpenRedirection=12]="DisableOpenRedirection",a[a.PPTContentAddinSSO=13]="PPTContentAddinSSO",a[a.PreviewInfoBar=14]="PreviewInfoBar",a[a.RefreshServerInfoInFrame=15]="RefreshServerInfoInFrame",a[a.FileUploadTempFolder=16]="FileUploadTempFolder",a[a.MsaPreviewLabel=17]="MsaPreviewLabel",a[a.FormsBranding=18]="FormsBranding",a[a.EnableExperimentationClient=19]="EnableExperimentationClient",a[a.EmailHrdFallback=20]="EmailHrdFallback",a[a.PPTTaskpaneAddinSSO=21]="PPTTaskpaneAddinSSO",a[a.PPTWin32ContentAddinSSO=22]="PPTWin32ContentAddinSSO",a[a.AddCustomizeTheme=23]="AddCustomizeTheme",a[a.FormInsightFeedbackV2=24]="FormInsightFeedbackV2",a[a.NetPromoteScore=25]="NetPromoteScore",a[a.UseIdeas=26]="UseIdeas",a[a.WordCloudMultipleRatio=27]="WordCloudMultipleRatio",a[a.DisableBrandingForMSA=28]="DisableBrandingForMSA",a[a.RecordIdentityAdminSetting=29]="RecordIdentityAdminSetting",a[a.EnableMuidForAnonymousUsers=30]="EnableMuidForAnonymousUsers",a[a.IntelligenceTitleLogMetric=31]="IntelligenceTitleLogMetric",a[a.EnableNonAnonymousForMSA=32]="EnableNonAnonymousForMSA",a[a.OptionSuggestionFetchTimeout=33]="OptionSuggestionFetchTimeout",a[a.EmailReceipt=34]="EmailReceipt",a[a.MoveIntelligence=35]="MoveIntelligence",a[a.NpsForMSA=36]="NpsForMSA",a[a.PPTSlideShowNavigateButton=37]="PPTSlideShowNavigateButton",a[a.QuestionTagForIntelligence=38]="QuestionTagForIntelligence",a[a.MSASampleForm=39]="MSASampleForm",a[a.UserSettings=40]="UserSettings",a[a.UseRefactoredTelemetry=41]="UseRefactoredTelemetry",a[a.VerifyUserInResponsePage=42]="VerifyUserInResponsePage",a[a.MSATemplate=43]="MSATemplate",a[a.PPTWin32FirstPartySSOLegacyAPI=44]="PPTWin32FirstPartySSOLegacyAPI",a[a.CoGrading=45]="CoGrading",a[a.CoGradingPowertool=46]="CoGradingPowertool",a[a.QtiFormCreationTimeout=47]="QtiFormCreationTimeout",a[a.EnableLorForAllLocales=48]="EnableLorForAllLocales",a[a.PrintForm=49]="PrintForm",a[a.IsQtiFeatureEnabled=50]="IsQtiFeatureEnabled",a[a.IsStartTimeEndTimeManaged=51]="IsStartTimeEndTimeManaged",a[a.MathIncorrectAnswerSuggestions=52]="MathIncorrectAnswerSuggestions",a[a.MathQuestionGeneration=53]="MathQuestionGeneration",a[a.TextFieldMathAnswers=54]="TextFieldMathAnswers",a[a.CookieAuth=55]="CookieAuth",a[a.UseExternalCdn=56]="UseExternalCdn",a[a.CheckScriptLoading=57]="CheckScriptLoading",a[a.FormInsight=58]="FormInsight",a[a.EnableOptionSuggestsOption=59]="EnableOptionSuggestsOption",a[a.EnableTransferForm=60]="EnableTransferForm",a[a.SubmitTimeDistributionInsight=61]="SubmitTimeDistributionInsight",a[a.EnableNPSKeywordsInsight=62]="EnableNPSKeywordsInsight",a[a.EnablePartialOrderInsight=63]="EnablePartialOrderInsight",a[a.EnableResponseSentimentInsight=64]="EnableResponseSentimentInsight",a[a.EnableMsaContentValidation=65]="EnableMsaContentValidation",a[a.LogDownloadExcelErrorMessage=66]="LogDownloadExcelErrorMessage",a[a.StraightLineVizForCorrelationInsight=67]="StraightLineVizForCorrelationInsight",a[a.EnableFFUserGating=68]="EnableFFUserGating",a[a.SocialSharing=69]="SocialSharing",a[a.MSAIntroductionForResponder=70]="MSAIntroductionForResponder",a[a.Question200Limit=71]="Question200Limit",a[a.SectionMVP1=72]="SectionMVP1",a[a.MultiLingualMVP1=73]="MultiLingualMVP1",a[a.EnableFormsProRoute=74]="EnableFormsProRoute",a[a.UpgradeUxStateModel=75]="UpgradeUxStateModel"}(g=b.Flights||(b.Flights={})),c[g.CoGrading]=new h(f.OnDevBoxAndDaily),c[g.CoGradingPowertool]=new h(f.AllOff),c[g.QtiFormCreationTimeout]=new h(f.AllOn),c[g.EnableLorForAllLocales]=new h(f.AllOn),c[g.ResponseInApp]=new h(f.AllOnButEDogProd),c[g.MathIncorrectAnswerSuggestions]=new h(f.OnDevBoxAndDaily),c[g.MathQuestionGeneration]=new h(f.OnDevBoxAndDaily),c[g.TextFieldMathAnswers]=new h(f.OnDevBoxAndDaily),c[g.ReExportToExcelButton]=new h(f.AllOnButEDogProd),c[g.O365ConsumerWaffle]=new h(f.OnDevBox),c[g.EnableOnlineExcelForMSA]=new h(f.AllOff),c[g.QRCodePlus]=new h(f.AllOnButEDogProd),c[g.ShareQuickSubmitPage]=new h(f.AllOnButEDogProd),c[g.PageInitializationVerboseLogs]=new h(f.AllOnButEDogProd),c[g.FileUpload]=new h(f.AllOnButEDogProd),c[g.FormInsight]=new h(f.AllOnButEDogProd),c[g.PartialPut]=new h(f.OnDevBox),c[g.FileUploadOnlyLargeFileAPI]=new h(f.AllOnButEDogProd),c[g.DropDown]=new h(f.AllOnButEDogProd),c[g.CopyPasteForChoice]=new h(f.AllOnButEDogProd),c[g.DisableOpenRedirection]=new h(f.AllOnButEDogProd),c[g.PPTContentAddinSSO]=new h(f.AllOnButEDogProd),c[g.PPTWin32ContentAddinSSO]=new h(f.AllOnButEDogProd),c[g.PPTTaskpaneAddinSSO]=new h(f.AllOnButEDogProd),c[g.PreviewInfoBar]=new h(f.AllOnButEDogProd),c[g.RefreshServerInfoInFrame]=new h(f.AllOnButEDogProd),c[g.FileUploadTempFolder]=new h(f.AllOff),c[g.MsaPreviewLabel]=new h(f.AllOn),c[g.EnableOptionSuggestsOption]=new h(f.AllOnButEDogProd),c[g.PrintForm]=new h(f.OnDevBox),c[g.IsQtiFeatureEnabled]=new h(f.AllOn),c[g.IsStartTimeEndTimeManaged]=new h(f.AllOnButEDogProd),c[g.FormsBranding]=new h(f.OnDevBoxAndDaily),c[g.EnableExperimentationClient]=new h(f.AllOnButEDogProd),c[g.FormInsightFeedbackV2]=new h(f.AllOnButEDogProd),c[g.EmailHrdFallback]=new h(f.AllOnButEDogProd),c[g.UseIdeas]=new h(f.AllOnButEDogProd),c[g.AddCustomizeTheme]=new h(f.AllOnButEDogProd),c[g.NetPromoteScore]=new h(f.AllOnButEDogProd),c[g.WordCloudMultipleRatio]=new h(f.AllOnButEDogProd),c[g.LogDownloadExcelErrorMessage]=new h(f.AllOnButEDogProd),c[g.DisableBrandingForMSA]=new h(f.AllOff),c[g.RecordIdentityAdminSetting]=new h(f.AllOnButEDogProd),c[g.EnableMuidForAnonymousUsers]=new h(f.AllOnButEDogProd),c[g.IntelligenceTitleLogMetric]=new h(f.AllOnButEDogProd),c[g.EnableFFUserGating]=new h(f.AllOnButEDogProd),c[g.EnableNonAnonymousForMSA]=new h(f.AllOnButEDogProd),c[g.OptionSuggestionFetchTimeout]=new h(f.AllOnButEDogProd),c[g.EmailReceipt]=new h(f.AllOnButEDogProd),c[g.NpsForMSA]=new h(f.AllOnButEDogProd),c[g.MoveIntelligence]=new h(f.AllOnButEDogProd),c[g.PPTSlideShowNavigateButton]=new h(f.AllOnButEDogProd),c[g.SocialSharing]=new h(f.AllOnButEDogProd),c[g.MSAIntroductionForResponder]=new h(f.AllOnButEDogProd),c[g.QuestionTagForIntelligence]=new h(f.AllOff),c[g.MSASampleForm]=new h(f.AllOnButEDogProd),c[g.UserSettings]=new h(f.AllOnButEDogProd),c[g.Question200Limit]=new h(f.AllOnButEDogProd),c[g.UseRefactoredTelemetry]=new h(f.OnDevBoxAndDaily),c[g.VerifyUserInResponsePage]=new h(f.AllOnButEDogProd),c[g.SectionMVP1]=new h(f.AllOnButEDogProd),c[g.EnableFormsProRoute]=new h(f.AllOnButEDogProd),c[g.MSATemplate]=new h(f.AllOff),c[g.PPTWin32FirstPartySSOLegacyAPI]=new h(f.AllOnButEDogProd),c[g.UpgradeUxStateModel]=new h(f.AllOff),d[g.CoGradingPowertool]=[g.CoGrading]}(b=a.Flighting||(a.Flighting={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(){function b(){this.deferred=null,this.muid=null}return Object.defineProperty(b,"Instance",{get:function(){return null==b.instance&&(b.instance=new b),
b.instance},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Muid",{get:function(){return this.muid},enumerable:!0,configurable:!0}),b.prototype.ensureMuid=function(){var c=this;if(null==this.deferred)if(this.deferred=$.Deferred(),this.muid=b.readMuid(),null==this.muid){var d=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Function.GetMuid);d.start(),b.loadMuid(function(){c.muid=b.readMuid(),null!=c.muid?(c.deferred.resolve(c.muid),d.end({resultType:"Success"})):(c.deferred.reject(),d.end({resultType:navigator.cookieEnabled?"Failure":"ExpectedFailure"}))})}else this.deferred.resolve(this.muid);return this.deferred.promise()},b.loadMuid=function(b){var c=a.EnvironmentConfig.getMuidHost();if(c){var d=document.createElement("img");d.style.display="none",d.src=c+"/c.gif",d.hidden=!0,d["aria-hidden"]="true",d.onload=d.onerror=b}else b()},b.readMuid=function(){return a.Utilities.getCookie("MUID")},b.instance=null,b}();a.Muid=b,a.Exports.Muid=b}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return Object.defineProperty(b,"EVENTNAME_SESSION_START",{get:function(){return"session_start"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IntelligenceStatistic",{get:function(){return"IntelligenceStatistic"},enumerable:!0,configurable:!0}),b.setLogHandler=function(a){this.buffer.setFunctionToCall(a)},b.logData=function(b,c){(null==c||a.Flighting.Flight.isEnabled(c))&&(a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?Forms.Telemetry.log({eventName:b.name,eventType:"engagement_event",extraData:b.extraData}):this.buffer.queue(b))},b.logSessionStartEvent=function(){a.Flighting.Flight.isEnabled(a.Flighting.Flights.EnableMuidForAnonymousUsers)&&a.Muid.Instance.ensureMuid(),a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?Forms.Telemetry.log({eventName:b.EVENTNAME_SESSION_START,eventType:"session_start"}):b.logData({name:b.EVENTNAME_SESSION_START,extraData:{DbId:"",DeviceId:""}})},b.buffer=new a.Utilities.Process.BufferForCall,b}();b.EngagementEventDeprecated=c}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){a.FilteredOutForms="PortalPage.FilteredOutForms";var b=function(){function a(){}return a.MyFormsButton="DesignPage.Form.MyFormsButton",a.Duplicate="PortalPage.MyForms.Duplicate",a.CancelMoveToRecycleBin="PortalPage.MyForms.CancelMoveToRecycleBin",a.ConfirmMoveToRecycleBin="PortalPage.MyForms.ConfirmMoveToRecycleBin",a.MoveToRecycleBin="PortalPage.MyForms.MoveToRecycleBin",a.Load="PortalPage.MyForms.Load",a.Navigate="PortalPage.MyForms.Navigate",a.New="PortalPage.MyForms.New",a.OpenStoreButton="PortalPage.MyForms.OpenStoreButton",a.NewFormCopyAllDone="PortalPage.MyForms.NewFromCopy",a.NewFromCopyFailure="PortalPage.MyForms.NewFromCopy.Failure",a.AutoLoginSuccess="PortalPage.MyForms.AutoLoginSuccess",a.ReadyToCopyForm="PortalPage.MyForms.ReadyToCopyForm",a.NewFromCopyQuestionDone="PortalPage.MyForms.NewFromCopyQuestionDone",a.TryTemplate="PortalPage.MyForms.TryTemplate",a.CollapseTemplate="PortalPage.MyForms.CollapseTemplate",a.ExpandTemplate="PortalPage.MyForms.ExpandTemplate",a.NewForm="PortalPage.MyForms.NewForm",a.NewQuiz="PortalPage.MyForms.NewQuiz",a.FormCount="PortalPage.MyForms.FormCount",a.NewQuizFromLor="PortalPage.MyForms.NewQuizFromLor",a.Click="PortalPage.MyForms.Click",a.ExpandNewMenu="PortalPage.MyForms.ExpandNewMenu",a.ExceedFormQuota="PortalPage.MyForms.ExceedFormQuota",a}();a.MyForms=b;var c=function(){function a(){}return a.OtherFormsButton="DesignPage.Form.OtherFormsButton",a.Unpin="PortalPage.OtherForms.Unpin",a.Duplicate="PortalPage.OtherForms.Duplicate",a.FormCount="PortalPage.OtherForms.FormCount",a.Click="PortalPage.OtherForms.Click",a}();a.OtherForms=c;var d=function(){function a(){}return a.Click="PortalPage.SearchForms.Click",a}();a.SearchForms=d;var e=function(){function a(){}return a.Navigate="PortalPage.DelegateForms.Navigate",a}();a.DelegateForms=e;var f=function(){function a(){}return a.Navigate="PortalPage.FormIntroductionDialog.Navigate",a.CreatNewForm="PortalPage.FormIntroductionDialog.CreatNewForm",a.Close="PortalPage.FormIntroductionDialog.Close",a}();a.FormIntroductionDialog=f;var g=function(){function a(){}return a.GroupFormsButton="DesignPage.Form.GroupFormsButton",a}();a.GroupFormsPortal=g}(c=b.PortalPage||(b.PortalPage={}));var d;!function(a){var b=function(){function a(){}return a.StartGetResponses="AnalysisPage.Responses.StartGetResponses",a.Navigate="AnalysisPage.Analysis.Navigate",a}();a.Analysis=b}(d=b.AnalysisPage||(b.AnalysisPage={}));var e;!function(a){var b=function(){function a(){}return a.AddImage_Logo="DesignPage.Form.Logo.AddImage",a.SharedFormByOwner="DesignPage.Form.SharedFormByOwner",a.SharedOwnershipByOwner="DesignPage.Form.SharedOwnershipByOwner",a.Navigate="DesignPage.Form.Navigate",a.SuggestFormAdd="DesignPage.Form.SuggestFormAdd",a.SuggestFormTrigger="DesignPage.Form.SuggestFormTrigger",a}();a.Form=b;var c=function(){function a(){}return a.AddOption="DesignPage.Questions.AddOption",a.AddOtherOption="DesignPage.Questions.AddOtherOption",a.AnswerRequired="DesignPage.Questions.AnswerRequired",a.Create="DesignPage.Questions.Create",a.Delete="DesignPage.Questions.Delete",a.Duplicate="DesignPage.Questions.Duplicate",a.LongAnswer="DesignPage.Questions.LongAnswer",a.MoveDown="DesignPage.Questions.MoveDown",a.MoveUp="DesignPage.Questions.MoveUp",a.MultipleAnswers="DesignPage.Questions.MultipleAnswers",a.Navigate="DesignPage.Questions.Navigate",a.AddRankingOption="DesignPage.Questions.AddRankingOption",a.DeleteRankingOption="DesignPage.Questions.DeleteRankingOption",a.SortableInitialization="DesignPage.Questions.SortableInitialization",a.AddImage="DesignPage.Questions.AddImage",a.ToggleCorrectChoice="DesignPage.Questions.ToggleCorrectChoice",a.PasteChoiceOptions="DesignPage.Questions.PasteChoiceOptions",a.ShortTextAnswerAdded="DesignPage.Questions.ShortTextAnswerAdded",a.ShortTextAnswerDeleted="DesignPage.Questions.ShortTextAnswerDeleted",a.FirstShortTextAnswerAdded="DesignPage.Questions.FirstShortTextAnswerAdded",a.LastRemainingShortTextAnswerDeleted="DesignPage.Questions.LastRemainingShortTextAnswerDeleted",a.AddLikertSubquestion="DesignPage.Questions.AddLikertSubquestion",a.DeleteLikertSubquestion="DesignPage.Questions.DeleteLikertSubquestion",a.AddLikertOption="DesignPage.Questions.AddLikertOption",a.DeleteLikertOption="DesignPage.Questions.DeleteLikertOption",a.RatingLevelModified="DesignPage.Questions.RatingLevelModified",a.RatingValueOutOfBounds="DesignPage.Questions.RatingValueOutOfBounds",a}();a.Questions=c;var d=function(){function a(){}return a.MathOption="DesignPage.QuestionMenu.MathOption",a.Navigate="DesignPage.QuestionMenu.Navigate",a.Quiz="DesignPage.QuestionMenu.Quiz",a.RatingLabel="DesignPage.QuestionMenu.RatingLabel",a.ShuffleOptions="DesignPage.QuestionMenu.ShuffleOptions",a.Subtitle="DesignPage.QuestionMenu.Subtitle",a.Validation="DesignPage.QuestionMenu.Validation",a.DropDown="DesignPage.QuestionMenu.DropDown",a}();a.QuestionMenu=d;var e=function(){function a(){}return a.AnswerHint="DesignPage.Quiz.AnswerHint",a.Point="DesignPage.Quiz.Point",a.SwitchTextToMathInput="DesignPage.Quiz.SwitchTextToMathInput",a.SwitchMathToTextInput="DesignPage.Quiz.SwitchMathToTextInput",a.EditMathFormula="DesignPage.Quiz.EditMathFormula",a}();a.Quiz=e;var f=function(){function a(){}return a.DeleteAllResponses="DesignPage.Responses.DeleteAllResponses",a.DeleteSingleResponse="DesignPage.Responses.DeleteSingleResponse",a.DetialDialogPaging="DesignPage.Responses.DetailDialogPaging",a.DetailDialogQuestionNavigate="DesignPage.Responses.DetailDialogQuestionNavigate",a.DownloadExcelFile="DesignPage.Responses.DownloadExcelFile",a.DownloadExcelFileDecreaseFileSize="DesignPage.Responses.DownloadExcelFileDecreaseFileSize",a.DownloadExcelFileFailed="DesignPage.Responses.DownloadExcelFileFailed",a.DownloadExcelFileStart="DesignPage.Responses.DownloadExcelFileStart",a.DownloadExcelFileSuccess="DesignPage.Responses.DownloadExcelFileSuccess",a.DownloadMultipleExcelFiles="DesignPage.Responses.DownloadMultipleExcelFiles",a.DownloadOnePagingExcelFile="DesignPage.Responses.DownloadOnePagingExcelFile",a.GradeResults="DesignPage.Responses.GradeResults",a.GradeQtiResults="DesignPage.Responses.GradeQtiResults",a.IndividualPaging="DesignPage.Responses.IndividualPageing",a.IndividualPrint="DesignPage.Responses.IndividualPrint",a.MeetLegacyChoiceAnswer="DesignPage.Responses.MeetLegacyChoiceAnswer",a.Navigate="DesignPage.Responses.Navigate",a.OpenExcelInOneDrive="DesignPage.Responses.OpenExcelInOneDrive",a.OpenInExcel="DesignPage.Responses.OpenInExcel",a.PostQtiGrade="DesignPage.Responses.PostQtiGrade",a.PrintAnalyzeView="DesignPage.Responses.PrintAnalyzeView",a.ReExportToExcel="DesignPage.Responses.ReExportToExcel",a.GetSummaryResult="DesignPage.Responses.GetSummaryResult",a.ReleaseResults="DesignPage.Responses.ReleaseResults",a.ShowResponsesDetail="DesignPage.Responses.ShowResponsesDetail",a.SwitchView="DesignPage.Responses.SwitchView",a.SwitchIvyChartType="DesignPage.Responses.SwitchIvyChartType",a.SwitchResponder="DesignPage.Responses.SwitchResponder",a.ViewResults="DesignPage.Responses.ViewResults",a.ExportToOneDriveWithBigData="DesignPage.Responses.ExportToOneDriveWithBigData",a.CopySummaryLink="DesignPage.Responses.CopySummaryLink",a.StartGetResponses="DesignPage.Responses.StartGetResponses",a.OpenFileFolder="DesignPage.Responses.OpenFileFolder",a.PopupReExportToExcelDialog="DesignPage.Responses.PopupReExportToExcelDialog",a.ShowInsightEntryPoint="DesignPage.Responses.ShowInsightEntryPoint",a.ClickInsightEntryPoint="DesignPage.Responses.ClickInsightEntryPoint",a.ClickInsightPreviousButton="DesignPage.Responses.ClickInsightPreviousButton",a.ClickInsightNextButton="DesignPage.Responses.ClickInsightNextButton",a.ReleaseInsightView="DesignPage.Responses.ReleaseInsightView",a.ShowInsights="DesignPage.Responses.ShowInsights",a}();a.Analysis=f;var g=function(){function a(){}return a.Navigate="DesignPage.PreView.Navigate",a}();a.Preview=g;var h=function(){function a(){}return a.Navigate="DesignPage.Theme.Navigate",a.SwitchTheme="DesignPage.Theme.SwitchTheme",a.AddCustomizedTheme="DesignPage.Theme.AddCustomizedTheme",a.EditCustomizedTheme="DesignPage.Theme.EditCustomizedTheme",a.AddImage="DesignPage.Theme.AddImage",a.DeleteImage="DesignPage.Theme.DeleteImage",a.AddColor="DesignPage.Theme.AddColor",a.DeleteColor="DesignPage.Theme.DeleteColor",a.ColorTooLight="DesignPage.Theme.ColorTooLight",a}();a.Theme=h;var i=function(){function a(){}return a.AddImage="DesignPage.ImagePicker.AddImage",a.AddVideo="DesignPage.MediaPicker.AddVideo",a.AddVideoFailure="DesignPage.MediaPicker.AddVideoFailure",a.Back="DesignPage.MediaPicker.Back",a.BingSearch="DesignPage.ImagePicker.UploadBingSearch",a.BingSearchLicense="DesignPage.ImagePicker.BingSearchLicense",a.ChooseImage="DesignPage.MediaPicker.ChooseImage",a.ChooseVideo="DesignPage.MediaPicker.ChooseVideo",a.Local="DesignPage.ImagePicker.UploadLocal",a.Navigate="DesignPage.ImagePicker.Navigate",a.OD4B="DesignPage.ImagePicker.UploadOD4B",a.Search="DesignPage.ImagePicker.Search",a.URL="DesignPage.ImagePicker.URL",a}();a.MediaPicker=i;var j=function(){function a(){}return a.ImageSize="DesignPage.ImageLayout.ImageSize",a}();a.ImageLayout=j;var k=function(){function a(){}return a.AltText="DesignPage.ImageEditPane.AltText",a.Delete="DesignPage.ImageEditPane.Delete",a.Edit="DesignPage.ImageEditPane.Edit",a.Style="DesignPage.ImageEditPane.Style",a.Zoom="DesignPage.ImageEditPane.Zoom",a.ZoomIn="DesignPage.ImageEditPane.ZoomIn",a.ZoomOut="DesignPage.ImageEditPane.ZoomOut",a}();a.ImageEditPane=k;var l=function(){function a(){}return a.Delete="DesignPage.VideoEditPane.Delete",a}();a.VideoEditPane=l;var m=function(){function a(){}return a.AcceptResponse="DesignPage.Setting.AcceptResponse",a.AllowAnonymous="DesignPage.Setting.AllowAnonymous",a.ApplyDeadline="DesignPage.Setting.ApplyDeadline",a.ApplyStartTime="DesignPage.Setting.ApplyStartTime",a.EditCloseMessage="DesignPage.Setting.EditCloseMessage",a.Navigate="DesignPage.Setting.Navigate",a.RecordIdentity="DesignPage.Setting.RecrodIdentity",a.RequireUniqueResponse="DesignPage.Setting.RequireUniqueResponse",a.RespondInAppOnly="DesignPage.Setting.RespondInAppOnly",a.SetDeadline="DesignPage.Setting.SetDeadline",a.SetStartTime="DesignPage.Setting.SetStartTime",a.ShowGradedResults="DesignPage.Setting.ShowGradedResults",a.ShowGradedScores="DesignPage.Setting.ShowGradedScores",a.ShuffleOption="DesignPage.Setting.ShuffleOption",a.ShuffleQuestion="DesignPage.Setting.ShuffleQuestion",a.ShuffleAllQuestions="DesignPage.Setting.ShuffleAllQuestions",a.LockGivenQuestions="DesignPage.Setting.LockGivenQuestions",a.AutoReleaseGrade="DesignPage.Setting.AutoReleaseGrade",a.EmailNotification="DesignPage.Setting.EmailNotification",a.EmailReceipt="DesignPage.Setting.EmailReceipt",a.ThankYouMessage="DesignPage.Setting.ThankYouMessage",a}();a.Setting=m;var n=function(){function a(){}return a.Link="DesignPage.Send.Link",a.Email="DesignPage.Send.Email",a.Embed="DesignPage.Send.MoreOptions",a.Navigate="DesignPage.Send.Navigate",a.QRCode="DesignPage.Send.QRCode",a.Sharing="DesignPage.Send.Sharing",a.SocialShare="DesignPage.Send.Share",a.ActionFailed="DesignPage.Send.ActionFailed",a.ActionSuccess="DesignPage.Send.ActionSuccess",a.CopyEmbedCode="DesignPage.Send.CopyEmbedCode",a.CopyLink="DesignPage.Send.CopyLink",a.DownloadQRCode="DesignPage.Send.DownloadQRCode",a.SendEmails="DesignPage.Send.SendEmails",a.AllowCopyCheckBox="DesignPage.Send.AllowCopyCheckBox",a.ShareFormLink="DesignPage.Send.ShareFormLink",a}();a.Send=n;var o=function(){function a(){}return a.CopyShareAsTemplateLink="DesignPage.Share.CopyShareAsTemplateLink",a.CreateShareAsTemplateLink="DesignPage.Share.CreateShareAsTemplateLink",a.DeleteShareAsTemplateLink="DesignPage.Share.DeleteShareAsTemplateLink",a.CopyCollaborationLink="DesignPage.Share.CopyCollaborationLink",a.CreateCollaborationLink="DesignPage.Share.CreateCollaborationLink",a.DeleteCollaborationLink="DesignPage.Share.DeleteCollaborationLink",a.SwitchCollaborationLink="DesignPage.Share.SwitchCollaborationLink",a.CopyAnalysisResultLink="DesignPage.Share.CopyAnalysisResultLink",a.CreateAnalysisResulttLink="DesignPage.Share.CreateAnalysisResulttLink",a.DeleteAnalysisResultLink="DesignPage.Share.DeleteAnalysisResultLink",a.ChooseAllowAnonymous="DesignPage.Share.ChooseAllowAnonymous",a}();a.Share=o;var p=function(){function a(){}return a.Navigate="DesignPage.Feedback.Navigate",a.Suggestion="DesignPage.Feedback.Suggestion",a.Insights="DesignPage.Feedback.Insights",a}();a.Feedback=p;var q=function(){function a(){}return a.Navigate="DesignPage.Help.Navigate",a}();a.Help=q;var r=function(){function a(){}return a.Navigate="DesignPage.Menu.Navigate",a.SignOut="DesignPage.Menu.SignOut",a.UserInfo="DesignPage.Menu.UserInfo",a.PrintForm="DesignPage.Menu.PrintForm",a}();a.Menu=r;var s=function(){function a(){}return a.BranchChanged="DesignPage.Branch.BranchChanged",a.BranchDesignViewNavigate="DesignPage.Branch.BranchDesignViewNavigate",a}();a.Branch=s;var t=function(){function a(){}return a.GetShellServiceInfo="DesignPage.AppLauncher.GetShellServiceInfo",a.GetConsumerShellServiceInfo="DesignPage.AppLauncher.GetConsumerShellServiceInfo",a.LoadShellData="DesignPage.AppLauncher.LoadShellData",a.Navigate="DesignPage.AppLauncher.Navigate",a.RenderShellData="DesignPage.AppLauncher.RenderShellData",a.LoadError="DesignPage.AppLauncher.LoadShellData",a}();a.AppLauncher=t;var u=function(){function a(){}return a.Clipboard="DesignPage.ShortCut.Clipboard",a.UndoRedo="DesignPage.ShortCut.UndoRedo",a}();a.ShortCut=u;var v=function(){function a(){}return a.Navigate="DesignPage.MathKeyboard.Navigate",a}();a.MathKeyboard=v;var w=function(){function a(){}return a.ConnectionStarted="DesignPage.Notification.ConnectionStarted",a}();a.Notification=w;var x=function(){function a(){}return a.Navigate="DesignPage.QRCodePlus.Navigate",a.Download="DesignPage.QRCodePlus.Download",a.CopyUrlSuccess="DesignPage.QRCodePlus.Success",a.CopyUrlFail="DesignPage.QRCodePlus.Fail",a}();a.QRCodePlus=x}(e=b.DesignPage||(b.DesignPage={}));var f=function(){function a(){}return a.Navigate="DesignPage.RecycleBin.Navigate",a.formDelete="RecycleBin.MyForm.Delete",a.formRestore="RecycleBin.MyForm.Restore",a.groupBarClick="RecycleBin.GroupFormsRecycle.GroupBar.Click",a.groupFormDelete="RecycleBin.GroupForm.Delete",a.groupFormRestore="RecycleBin.GroupForm.Restore",a}();b.RecycleBin=f;var g;!function(a){var b=function(){function a(){}return a.Navigate="ResponsePage.Form.Navigate",a.QRCode="ResponsePage.Form.QRCode",a.Submit="ResponsePage.Form.Submit",a.SubmitQtiResponse="ResponsePage.Form.SubmitQtiResponse",a.OpenInTakeATest="ResponsePage.Form.OpenInTakeATest",a.TextQuestionInfoOfSubmit="ResponsePage.Form.TextQuestionInfoOfSubmit",a.SwitchTextToMathInput="ResponsePage.Form.SwitchTextToMathInput",a.SwitchMathToTextInput="ResponsePage.Form.SwitchMathToTextInput",a}();a.Form=b;var c=function(){function a(){}return a.LearnMoreForTakeATest="ResponsePage.ThanksView.LearnMoreForTakeATest",a.Navigate="ResponsePage.ThanksView.Navigate",a.NavigateToPortal="ResponsePage.ThanksView.NavigateToPortal",a.SubmitAnother="ResponsePage.ThanksView.SubmitAnother",a}();a.ThanksView=c;var d=function(){function a(){}return a.Navigate="ResponsePage.PollResultView.Navigate",a.NavigateToPortal="ResponsePage.PollResultView.NavigateToPortal",a.SubmitAnother="ResponsePage.PollResultView.SubmitAnother",a}();a.PollResultView=d;var e=function(){function a(){}return a.IsEmbeddedSession="ResponsePage.EmbedView.IsEmbeddedSession",a.BlockEmbed="ResponsePage.EmbedView.BlockEmbed",a.Navigate="ResponsePage.EmbedView.Navigate",a.NeedAuth="ResponsePage.EmbedView.NeedAuth",a.OpenInBrowser="ResponsePage.EmbedView.OpenInBrowser",a}();a.EmbedView=e;var f=function(){function a(){}return a.Navigate="ResponsePage.StudentView.Navigate",a}();a.StudentView=f;var g=function(){function a(){}return a.Navigate="ResponsePage.ViewResultView.Navigate",a}();a.ViewResultView=g;var h=function(){function a(){}return a.Error="ResponsePage.ErrorPage.Error",a.Information="ResponsePage.ErrorPage.Information",a}();a.ErrorPage=h;var i=function(){function a(){}return a.Failure="ResponsePage.LoadingScript.Failure",a.Start="ResponsePage.LoadingScript.Start",a.Success="ResponsePage.LoadingScript.Success",a}();a.LoadingScript=i}(g=b.ResponsePage||(b.ResponsePage={}));var h;!function(a){var b=function(){function a(){}return a.Navigate="ShareFormPage.Copy.Navigate",a.LoginToAutoCopy="ShareFormPage.Copy.LoginToAutoCopy",a.DuplicateButton="ShareFormPage.Copy.DuplicateButton",a}();a.Copy=b}(h=b.ShareFormPage||(b.ShareFormPage={}));var i;!function(a){a.Referrer="DefaultPage.Referrer";var b=function(){function a(){}return a.GetStarted="DefaultPage.LandingView.GetStarted",a.GetStartedHeaderBar="DefaultPage.LandingView.GetStartedHeaderBar",a.GetStartedWithForm="DefaultPage.LandingView.GetStartedWithForm",a.GetStartedSignIn="DefaultPage.LandingView.GetStartedSignIn",a.SignIn="DefaultPage.LandingView.SignIn",a.MsaSignIn="DefaultPage.LandingView.MsaSignIn",a.AadSignIn="DefaultPage.LandingView.AadSignIn",a.Navigate="DefaultPage.LandingView.Navigate",a.SignUp="DefaultPage.LandingView.SignUp",a.MsaSignUp="DefaultPage.LandingView.MsaSignUp",a.AadSignUp="DefaultPage.LandingView.AadSignUp",a.CloseSignDialog="DefaultPage.LandingView.CloseSignDialog",a.EmailHrdFailure="DefaultPage.LandingView.EmailHrdFailure",a.AccountNotInWhiteList="DefaultPage.LandingView.AccountNotInWhiteList",a.AccountTypeUnknown="DefaultPage.LandingView.AccountTypeUnknown",a.AccountTypeBoth="DefaultPage.LandingView.AccountTypeBoth",a.Office365="DefaultPage.LandingView.Office365",a.PowerApps="DefaultPage.LandingView.PowerApps",a}();a.LandingView=b;var c=function(){function a(){}return a.Loaded="DefaultPage.EmailHrd.Loaded",a.LoadFailed="DefaultPage.EmailHrd.LoadFailed",a.NextScreen="DefaultPage.EmailHrd.NextScreen",a}();a.EmailHrd=c}(i=b.DefaultPage||(b.DefaultPage={}));var j;!function(a){var b=function(){function a(){}return a.Success="Image.CanvasOnLoad.Success",a.Failure="Image.CanvasOnLoad.Failure",a}();a.CanvasOnLoad=b;var c=function(){function a(){}return a.Success="Image.CanvasRender.Success",a.Failure="Image.CanvasRender.Failure",a}();a.CanvasRender=c;var d=function(){function a(){}return a.Success="Image.ImageOnLoad.Success",a.Failure="Image.ImageOnLoad.Failure",a}();a.ImageOnLoad=d}(j=b.Image||(b.Image={}));var k;!function(a){var b=function(){function a(){}return a.GotoRegisterPage="Error.ErrorPage.GotoRegisterPage",a.Error="Error.ErrorPage.Error",a.Information="Error.ErrorPage.Information",a.OriginErrorJudgementNotMatch="Error.ErrorPage.OriginErrorJudgementNotMatch",a.ErrorOutOfOrigin="Error.ErrorPage.ErrorOutOfOrigin",a.SignInWithOtherAccount="Error.ErrorPage.SignInWithOtherAccount",a.SignOutInIframeInProgress="Error.ErrorPage.SignOutInIframeInProgress",a}();a.ErrorPage=b;var c=function(){function a(){}return a.Hide="Error.ErrorMessageBar.Hide",a.Show="Error.ErrorMessageBar.Show",a}();a.ErrorMessageBar=c;var d=function(){function a(){}return a.ShowAtSubmitResponse="Error.InlineError.ShowAtSubmitResponse",a}();a.InlineError=d;var e=function(){function a(){}return a.FailedToLoadCss="Error.CssLoadingError.FailedToLoadCss",a}();a.CssLoadingError=e;var f=function(){function a(){}return a.KatexFallbackToMathJax="Error.MathRendering.KatexFallbackToMathJax",a}();a.MathRendering=f;var g=function(){function a(){}return a.UniversalHeaderAndFooterError="Error.UHF.UniversalHeaderAndFooterError",a}();a.UHF=g}(k=b.Error||(b.Error={}));var l;!function(a){var b=function(){function a(){}return a.DisabledByTenantAdmin="Auth.DisabledByTenantAdmin",a.LocalStorageNotSupported="Auth.LocalStorageNotSupported",a.NotOnboardedTenant="Auth.NotOnboardedTenant",a.ThirdPartyCookieSupport="Auth.ThirdPartyCookieSupport",a.UserNeedMultiFactorAuth="Auth.UserNeedMultiFactorAuth",a.SilentSigninUsingAadState="Auth.SilentSigninUsingAadState",a.NoUserInfoForNonanonymousForm="Auth.NoUserInfoForNonanonymousForm",a}();a.Auth=b}(l=b.Auth||(b.Auth={}));var m;!function(a){a.AllScriptsLoadDone="JsLoad.AllScriptsLoadDone",a.SomeScriptsLoadFailed="JsLoad.SomeScriptsLoadFailed",a.ScriptLoadDone="JsLoad.ScriptLoadDone",a.ScriptLoadFailed="JsLoad.ScriptLoadFailed"}(m=b.JsLoad||(b.JsLoad={}));var n;!function(a){var b=function(){function a(){}return a.Close="AddinPage.App.Close",a.Initial="AddinPage.App.Initial",a}();a.App=b;var c=function(){function a(){}return a.DataSync="AddinPage.SyncView.DataSync",a}();a.SyncView=c;var d=function(){function a(){}return a.GetAddinUserInfoSuccess="AddinPage.GetAddinUserInfo.Success",a.GetAddinUserInfoFailed="AddinPage.GetAddinUserInfo.Failed",a.GetFlightsSuccess="AddinPage.GetFlights.Success",a.GetFlightsFailed="AddinPage.GetFlights.Failed",a}();a.PageMethod=d}(n=b.AddinPage||(b.AddinPage={}));var o;!function(a){var b=function(){function a(){}return a.Close="OneNoteAddinPage.App.Close",a.Initial="OneNoteAddinPage.App.Initial",a}();a.App=b;var c=function(){function a(){}return a.Navigate="OneNoteAddinPage.AuthView.Navigate",a.Click="OneNoteAddinPage.AuthView.Click",a.Succeed="OneNoteAddinPage.AuthView.Succeed",a.NotLoggedIn="OneNoteAddinPage.AuthView.NotLoggedIn",a}();a.AuthView=c;var d=function(){function a(){}return a.Navigate="OneNoteAddinPage.SyncView.Navigate",a.IsNewUser="OneNoteAddinPage.SyncView.IsNewUser",a.InsertForm="OneNoteAddinPage.SyncView.InsertForm",a.InsertSuccess="OneNoteAddinPage.SyncView.InsertSuccess",a.CreateForm="OneNoteAddinPage.SyncView.CreateForm",a.CreateSuccess="OneNoteAddinPage.SyncView.CreateSuccess",a.EditForm="OneNoteAddinPage.SyncView.EditForm",a}();a.SyncView=d}(o=b.OneNoteAddinPage||(b.OneNoteAddinPage={}));var p;!function(a){var b=function(){function a(){}return a.GetToken="PowerPointTaskpaneAddinPage.Initialize.GetToken",a.GetTokenCompleted="PowerPointTaskpaneAddinPage.Initialize.GetTokenCompleted",a}();a.Initialize=b;var c=function(){function a(){}return a.Close="PowerPointTaskpaneAddinPage.App.Close",a.Initial="PowerPointTaskpaneAddinPage.App.Initial",a}();a.App=c;var d=function(){function a(){}return a.Navigate="PowerPointTaskpaneAddinPage.AuthView.Navigate",a.Click="PowerPointTaskpaneAddinPage.AuthView.Click",a.Succeed="PowerPointTaskpaneAddinPage.AuthView.Succeed",a.NotLoggedIn="PowerPointTaskpaneAddinPage.AuthView.NotLoggedIn",a}();a.AuthView=d;var e=function(){function a(){}return a.Navigate="PowerPointTaskpaneAddinPage.SyncView.Navigate",a.IsNewUser="PowerPointTaskpaneAddinPage.SyncView.IsNewUser",a.InsertForm="PowerPointTaskpaneAddinPage.SyncView.InsertForm",a.InsertSuccess="PowerPointTaskpaneAddinPage.SyncView.InsertSuccess",a.CreateForm="PowerPointTaskpaneAddinPage.SyncView.CreateForm",a.CreateSuccess="PowerPointTaskpaneAddinPage.SyncView.CreateSuccess",a.EditForm="PowerPointTaskpaneAddinPage.SyncView.EditForm",a.FetchFormList="PowerPointTaskpaneAddinPage.SyncView.FetchFormList",a.FetchFormListSuccess="PowerPointTaskpaneAddinPage.SyncView.FetchFormListSuccess",a}();a.SyncView=e}(p=b.PowerPointTaskpaneAddinPage||(b.PowerPointTaskpaneAddinPage={}));var q;!function(a){var b=function(){function a(){}return a.PrepareAddinContext="PowerPointContentAddinPage.Initialize.PrepareAddinContext",a.PrepareAddinContextCompleted="PowerPointContentAddinPage.Initialize.PrepareAddinContextCompleted",a.GetToken="PowerPointContentAddinPage.Initialize.GetToken",a.GetTokenCompleted="PowerPointContentAddinPage.Initialize.GetTokenCompleted",a.GetTokenThirdPartySSONotSupported="PowerPointContentAddinPage.Initialize.GetTokenThirdPartySSONotSupported",a}();a.Initialize=b;var c=function(){function a(){}return a.Click="PowerPointContentAddinPage.AuthView.Click",a.Succeed="PowerPointContentAddinPage.AuthView.Succeed",a.NotLoggedIn="PowerPointContentAddinPage.AuthView.NotLoggedIn",a}();a.AuthView=c;var d=function(){function a(){}return a.Render="PowerPointContentAddinPage.RenderView.Render",a.RenderFormPage="PowerPointContentAddinPage.RenderView.RenderFormPage",a.RenderSuccess="PowerPointContentAddinPage.RenderView.RenderSuccess",a.GetPPTView="PowerPointContentAddinPage.RenderView.GetPPTView",a.GetPPTViewSuccess="PowerPointContentAddinPage.RenderView.GetPPTViewSuccess",a.GetPPTViewNotSupported="PowerPointContentAddinPage.RenderView.GetPPTViewNotSupported",a.GetFormId="PowerPointContentAddinPage.RenderView.GetFormId",a.GetFormIdCompleted="PowerPointContentAddinPage.RenderView.GetFormIdCompleted",a.SaveFileSettings="PowerPointContentAddinPage.RenderView.SaveFileSettings",a.SaveFileSettingsCompleted="PowerPointContentAddinPage.RenderView.SaveFileSettingsCompleted",a.GetFormTitle="PowerPointContentAddinPage.RenderView.GetFormTitle",a.GetFormTitleCompleted="PowerPointContentAddinPage.RenderView.GetFormTitleCompleted",a.CheckAnonymous="PowerPointContentAddinPage.RenderView.CheckAnonymous",a.CheckAnonymousCompleted="PowerPointContentAddinPage.RenderView.CheckAnonymousCompleted",a.CookieBypass="PowerPointContentAddinPage.RenderView.CookieBypass",a.SSOBypass="PowerPointContentAddinPage.RenderView.SSOBypass",a}();a.RenderView=d;var e=function(){function a(){}return a.Click="PowerPointContentAddinPage.StartView.Click",a}();a.StartView=e}(q=b.PowerPointContentAddinPage||(b.PowerPointContentAddinPage={}));var r;!function(a){var b=function(){function a(){}return a.Navigate="AssignmentsFrame.Auth.Navigate",a.Success="AssignmentsFrame.Auth.Success",a.SsoSuccess="AssignmentsFrame.Auth.SsoSuccess",a}();a.Auth=b;var c=function(){function a(){}return a.Save="AssignmentsFrame.ConfigView.Save",a}();a.ConfigView=c}(r=b.AssignmentsFrame||(b.AssignmentsFrame={}));var s;!function(a){var b=function(){function a(){}return a.Navigate="TeamsTab.Auth.Navigate",a.Success="TeamsTab.Auth.Success",a.SsoSuccess="TeamsTab.Auth.SsoSuccess",a.RefreshInfoFailed="TeamsTab.Auth.RefreshInfoFailed",a}();a.Auth=b;var c=function(){function a(){}return a.Save="TeamsTab.ConfigView.Save",a}();a.ConfigView=c}(s=b.TeamsTab||(b.TeamsTab={}));var t;!function(a){var b=function(){function a(){}return a.Close="AgaveAddinPage.Agave.Close",a.Initial="AgaveAddinPage.Agave.Initial",a}();a.Agave=b}(t=b.AgaveAddinPage||(b.AgaveAddinPage={}));var u;!function(a){var b=function(){function a(){}return a.Close="OutlookCreatePollPage.App.Close",a.Initial="OutlookCreatePollPage.App.Initial",a}();a.App=b;var c=function(){function a(){}return a.Navigate="OutlookCreatePollPage.AuthView.Navigate",a.Click="OutlookCreatePollPage.AuthView.Click",a.Succeed="OutlookCreatePollPage.AuthView.Succeed",a.NotLoggedIn="OutlookCreatePollPage.AuthView.NotLoggedIn",a}();a.AuthView=c;var d=function(){function a(){}return a.Navigate="OutlookCreatePollPage.PollView.Navigate",a.Insert="OutlookCreatePollPage.PollView.Insert",a.OpenForms="OutlookCreatePollPage.PollView.OpenForms",a}();a.PollView=d;var e=function(){function a(){}return a.MultipleAnswers="OutlookCreatePollPage.Questions.MultipleAnswers",a}();a.Questions=e}(u=b.OutlookCreatePollPage||(b.OutlookCreatePollPage={}));var v;!function(a){var b=function(){function a(){}return a.ConnectionDisconnected="DataProvider.RealtimeClient.Connection.Disconnected",a.ConnectionError="DataProvider.RealtimeClient.Connection.Error",a.ConnectionFailed="DataProvider.RealtimeClient.Connection.Failed",a.ConnectionReconnected="DataProvider.RealtimeClient.Connection.Reconnected",a.ConnectionReconnecting="DataProvider.RealtimeClient.Connection.Reconnecting",a.ConnectionSlow="DataProvider.RealtimeClient.Connection.Slow",a.ConnectionStarting="DataProvider.RealtimeClient.Connection.Starting",a.ConnectionSuccess="DataProvider.RealtimeClient.Connection.Success",a}();a.RealtimeClient=b}(v=b.DataProvider||(b.DataProvider={}));var w;!function(a){var b=function(){function a(){}return a.Navigate="QuickSubmitPage.QuickSubmit.Navigate",a.Submit="QuickSubmitPage.QuickSubmit.Submit",a}();a.QuickSubmit=b}(w=b.QuickSubmitPage||(b.QuickSubmitPage={}));var x;!function(a){var b=function(){function a(){}return a.Show="IntelligenceStatistic.ChoiceOptionSuggestion.Show",a.NoShow="IntelligenceStatistic.ChoiceOptionSuggestion.NoShow",a.Choose="IntelligenceStatistic.ChoiceOptionSuggestion.Choose",a}();a.ChoiceOptionSuggestion=b;var c=function(){function a(){}return a.Show="IntelligenceStatistic.LikertOptionSuggestion.Show",a.Choose="IntelligenceStatistic.LikertOptionSuggestion.Choose",a}();a.LikertOptionSuggestion=c;var d=function(){function a(){}return a.Show="IntelligenceStatistic.QuestionSuggestion.Show",a}();a.QuestionSuggestion=d;var e=function(){function a(){}return a.Failure="IntelligenceStatistic.Templates.Failure",a}();a.TemplateSuggestion=e}(x=b.IntelligenceStatistic||(b.IntelligenceStatistic={}));var y;!function(a){var b=function(){function a(){}return a.Show="Intelligence.ChoiceOptionSuggestion.Show",a.Choose="Intelligence.ChoiceOptionSuggestion.Choose",a}();a.ChoiceOptionSuggestion=b;var c=function(){function a(){}return a.Show="Intelligence.LikertOptionSuggestion.Show",a.Choose="Intelligence.LikertOptionSuggestion.Choose",a}();a.LikertOptionSuggestion=c;var d=function(){function a(){}return a.Show="Intelligence.QuestionSuggestion.Show",a}();a.QuestionSuggestion=d;var e=function(){function a(){}return a.TagFailure="Intelligence.QuestionTagForIntelligence.Tag.Failure",a}();a.QuestionTagForIntelligence=e}(y=b.Intelligence||(b.Intelligence={})),a.Exports.EngagementEventNames=b}(c=b.EngagementEventNames||(b.EngagementEventNames={}))}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b}(Error);a.AuthError=b;var c=function(b){function c(c){var d=b.call(this,c)||this;return d.name=a.Form.ClientErrorNames.AuthNoStorageError,d}return __extends(c,b),c}(b);a.AuthErrorNoStorage=c;var d=function(){
function b(){}return Object.defineProperty(b,"AuthContext",{get:function(){return b.authContext},enumerable:!0,configurable:!0}),b.hasUserLoggedIn=function(){return a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?a.DataProvider.AuthTokenHelper.getInstance().isUserLoggedIn():!!b.AuthContext.getCachedUser()},b.setUserAccountNameToStorage=function(c){a.SafeStorage.DefaultStorage.setItem(b.userAccountNameKey,JSON.stringify(c))},b.getUserAccountNameFromStorage=function(){var c=a.SafeStorage.DefaultStorage.getItem(b.userAccountNameKey);return c&&JSON.parse(c)},b.detectUserLoggedInAAD=function(a,c){var d=Forms.AuthRelatedLocalStorage;if(d.isSupported()){var e=!d.DetectAADInProgress;e&&b.initDetectUserLoggedInAAD();var f=setInterval(function(){d.DetectAADInProgress||(clearInterval(f),d.DetectAADResult?e?a():setTimeout(function(){return Forms.Common.reloadPage()},2e3):c())},100)}else c()},b.initDetectUserLoggedInAAD=function(){var c=Forms.AuthRelatedLocalStorage;c.DetectAADInProgress=!0,c.DetectAADResult=void 0;var d;d=a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?b.stateCookieAuthPrefix+a.Utilities.Guid.newGuid():b.statePrefix+a.Utilities.Guid.newGuid();var e={client_id:a.EnvironmentConfig.getAadClientId(),msafed:0,prompt:"none",redirect_uri:window.location.origin,resource:a.EnvironmentConfig.getFormsResourceId(),response_mode:"form_post",response_type:"token",state:d};a.SafeStorage.DefaultStorage.setItem(b.stateKey,d);var f=new a.Event.QosEventDeprecated(a.Event.QosEventNames.Auth.Auth.DetectUserLoggedInAAD);f.start(),window.formDetectUserLoggedInAADCallback=function(a){f.end({resultType:a?"ExpectedFailure":"Success"}),c.DetectAADInProgress=void 0,c.DetectAADResult=!a};var g=a.EnvironmentConfig.getAadInstance()+"common/oauth2/authorize?"+jQuery.param(e);$("body").append('<iframe id="detectAADAuthFrame" style="display:none;" src='+g+"><iframe>")},b.handleAuthForContentPage=function(c){return b.deferredHandleAuth||(b.deferredHandleAuth=$.Deferred(),a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?b.deferredHandleAuth.resolve():b.handleAuth().done(function(a){if(a.HasUserSignedIn||!c)b.populateUserInfo(),b.deferredHandleAuth.resolve();else{if(b.AuthContext.login(),!b.loginWithRedirectPromise)throw Error("Authenticator.redirectForAuthContextLogin not called.");b.loginWithRedirectPromise.done(function(){return b.deferredHandleAuth.resolve()}).fail(function(){return b.deferredHandleAuth.reject()})}}).fail(function(a){b.deferredHandleAuth.reject(a)})),b.deferredHandleAuth.promise()},b.handleAuthForAddinPage=function(){return b.deferredHandleAuth||(b.deferredHandleAuth=$.Deferred(),a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?b.deferredHandleAuth.resolve():b.handleAuth().done(function(a){a.HasUserSignedIn?(b.populateUserInfo(),b.deferredHandleAuth.resolve()):b.deferredHandleAuth.reject()})),b.deferredHandleAuth.promise()},b.registerSignInHandler=function(a){b.loginHandler=a},b.signIn=function(){return b.loginHandler?b.loginHandler():(b.redirectToLogin(),$.Deferred().promise())},b.signInThenRefresh=function(){b.signIn().then(function(){return Forms.Common.reloadPage(!0)})},b.redirectToLogin=function(){a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?a.DataProvider.AuthTokenHelper.getInstance().redirectToSignIn():a.Authenticator.AuthContext.login()},b.signOut=function(){a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?Forms.Common.redirectTo(OfficeFormServerInfo.signOutLink):(b.AuthContext.config.postLogoutRedirectUri=window.location.href,b.AuthContext.logOut())},b.handleAuth=function(){var d=a.SafeStorage.supportsLocalStorage(),e=a.SafeStorage.supportsSessionStorage();if(d||a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Auth.Auth.LocalStorageNotSupported,extraData:{supportsSessionStorage:e}}),!d&&!e)return $.Deferred().reject(new c("local storage or session storage can't be used")).promise();var f=a.SafeStorage.DefaultStorage.getItem(b.userAccountNameKey),g="response_mode=form_post&msafed=0";g=f?g+"&username="+f:g;var h=window.location.origin,i={cacheLocation:d?"localStorage":"sessionStorage",clientId:a.EnvironmentConfig.getAadClientId(),displayCall:b.redirectForAuthContextLogin,extraQueryParameter:g,instance:a.EnvironmentConfig.getAadInstance(),postLogoutRedirectUri:h,redirectUri:h,tenant:""},j=new AuthenticationContext(i),k=j.isCallback(window.location.hash);if(j.handleWindowCallback(),k)return $.Deferred().promise();if(b.authContext=j,!a.Authenticator.hasUserLoggedIn())return $.Deferred().resolve({HasUserSignedIn:!1,UserSignedInBefore:!1}).promise();var l=$.Deferred();return j.acquireToken(a.EnvironmentConfig.getAadClientId(),function(b,c){var d=!b&&!!c;if(d){var e=j.getCachedUser();"live.com"===e.profile.idp&&(j.clearCache(),d=!1,a.Event.ErrorEventDeprecated.logData({errorName:"UnexpectedLiveId"}))}else a.Authenticator.AuthContext.clearCache();l.resolve({HasUserSignedIn:d,UserSignedInBefore:!0})}),l.promise()},b.handleDetectUserLoggedInAADCallback=function(){return b.isDetectUserLoggedInAADCallback(window.location.hash)?(window.parent&&window.parent.formDetectUserLoggedInAADCallback&&window.parent.formDetectUserLoggedInAADCallback(b.isDetectUserLoggedInAADCallbackError(window.location.hash)),!0):!1},b.isDetectUserLoggedInAADCallback=function(a){return-1!==a.indexOf("state="+b.statePrefix)},b.isDetectUserLoggedInAADCallbackError=function(c){var d=!1,e=a.Utilities.Html.getQueries(c.substring(1).trim());return e.state&&a.SafeStorage.DefaultStorage.getItem(b.stateKey)===e.state&&(d=!0),!d||-1!==c.indexOf("error_description=")},b.populateUserInfo=function(){var a=b.AuthContext.getCachedUser();if(a){var c=a.profile.oid;OfficeFormServerInfo.userInfo={DisplayName:a.profile.name,GivenName:a.profile.given_name||a.profile.name&&a.profile.name.split(" ")[0],Email:a.profile.unique_name,UserId:c,TenantId:a.profile.tid,PUID:c.replace(/-/g,"").substring(16),IsMsa:!1}}},b.redirectForAuthContextLogin=function(a){if(b.loginWithRedirectPromise)throw Error("login in progress.");Forms.Common.replaceUrl(a);var c=$.Deferred();b.loginWithRedirectPromise=c.promise(),setTimeout(function(){return c.reject()},3e3)},b.stateKey="officeforms.auth.state",b.statePrefix="form.detectUserLoggedInAAD.",b.stateCookieAuthPrefix=b.statePrefix+"cookieAuth.",b.userAccountNameKey="officeforms.userAccountNameKey",b}();a.Authenticator=d,a.Exports.Authenticator=d}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a,b,d,e){var f={};return f[s]=e?u:t,c(a,b,d,f)}function c(a,b,c,d){var e=g(a),i=g(b);d&&0!==Object.keys(d).length&&Object.keys(d).forEach(function(a){c+=r+a+"="+d[a]});var j=p-(n+o+c.length)%p;j=p>j?j:0,c=f(c,c.length+j,q);var k=h(c),l=e.concat(i,k),m=window.btoa(String.fromCharCode.apply(String,l));return m.replace(/\//g,"_").replace(/\+/g,"-")}function d(a){var b=e(a),c=!1;return b.MoreInfo&&b.MoreInfo[s]===u&&(c=!0),{OrgId:b.OrgId,OwnerId:b.OwnerId,TableId:b.TableId,IsGroupOwner:c}}function e(a){try{a=a.replace(/_/g,"/").replace(/-/g,"+");var b=i(a),c=b.slice(0,n),d=j(c),e=b.slice(n,n+o),f=j(e),g=b.slice(n+o),h=m(k(g),q),l={},p=h.split(r);if(p.length>1){h=p[0];for(var s=1;s<p.length;s++){var t=p[s].split("=");t&&2===t.length&&(l[t[0]]=t[1])}}return{OrgId:d,OwnerId:f,TableId:h,MoreInfo:l}}catch(u){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}}function f(a,b,c){return a+Array(b-a.length+1).join(c||" ")}function g(a){var b=[];return a.split("-").forEach(function(a,c){var d=a.match(/.{2}/g);3>c&&(d=d.reverse()),d.forEach(function(a){b.push(parseInt(a,16))})}),b}function h(a){return a.split("").map(function(a){return a.charCodeAt(0)})}function i(a){return h(window.atob(a.replace(/ /g,"")))}function j(a){if(16!==a.length)return null;var b=[].concat(a.slice(0,4).reverse(),a.slice(4,6).reverse(),a.slice(6,8).reverse(),a.slice(8)),c=l(b);return c=c.slice(0,8)+"-"+c.slice(8,12)+"-"+c.slice(12,16)+"-"+c.slice(16,20)+"-"+c.slice(20)}function k(a){for(var b="",c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}function l(a){for(var b="",c="",d=0;d<a.length;d++)c=a[d].toString(16),c=1===c.length?"0"+c:c,b+=c;return b}function m(a,b){if(null===a||void 0===a||0===a.length)return a;for(var c=a.length;--c>=0&&!(b.indexOf(a.charAt(c))<0););return a.substr(0,c+1)}var n=16,o=16,p=3,q=".",r="$%@#",s="t",t="u",u="g";a.encodeFormId=b,a.decodeFormId=d}(b=a.FormId||(a.FormId={}))}(b=a.Utilities||(a.Utilities={}))}(OfficeForm||(OfficeForm={}));var Forms;!function(a){var b;!function(a){}(b=a.DesignPage||(a.DesignPage={}));var c;!function(a){}(c=a.Experimentation||(a.Experimentation={}));var d;!function(a){var b;!function(a){}(b=a.FormManager||(a.FormManager={}))}(d=a.Models||(a.Models={}));var e;!function(a){var b;!function(a){}(b=a.Utilities||(a.Utilities={}));var c;!function(a){}(c=a.Controls||(a.Controls={}));var d;!function(a){}(d=a.Analysis||(a.Analysis={}));var e;!function(a){}(e=a.FileUpload||(a.FileUpload={}));var f;!function(a){}(f=a.Intelligence||(a.Intelligence={}));var g;!function(a){}(g=a.RecycleBin||(a.RecycleBin={}));var h;!function(a){}(h=a.Renderer||(a.Renderer={}));var i;!function(a){}(i=a.Designer||(a.Designer={}));var j;!function(a){}(j=a.FlexPane||(a.FlexPane={}));var k;!function(a){}(k=a.FormDesignView||(a.FormDesignView={}));var l;!function(a){}(l=a.Addin||(a.Addin={}));var m;!function(a){}(m=a.PowerPoint||(a.PowerPoint={}))}(e=a.UX||(a.UX={})),function(a){var b;!function(a){}(b=a.FileUpload||(a.FileUpload={}))}(e=a.UX||(a.UX={}));var f;!function(a){}(f=a.Mru||(a.Mru={}));var g;!function(a){}(g=a.FileUploadProcess||(a.FileUploadProcess={}));var h;!function(a){}(h=a.Grading||(a.Grading={}));var i;!function(a){}(i=a.PrintTemplate||(a.PrintTemplate={}));var j;!function(a){}(j=a.Common||(a.Common={}));var k;!function(a){}(k=a.DataProvider||(a.DataProvider={}));var l;!function(a){}(l=a.Experiment||(a.Experiment={}));var m;!function(a){}(m=a.Templates||(a.Templates={}));var n;!function(a){}(n=a.Telemetry||(a.Telemetry={}));var o;!function(a){}(o=a.FormsProRelated||(a.FormsProRelated={}))}(Forms||(Forms={}));var OfficeForm;!function(a){var b;!function(b){a.Exports.DataProvider=b}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(a){a[a.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",a[a.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(c=b.EduLicenseName||(b.EduLicenseName={}));var d;!function(a){a[a.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",a[a.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",a[a.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",a[a.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(d=b.BusinessLicenseName||(b.BusinessLicenseName={}));var e;!function(a){a[a.FORMS_PRO=0]="FORMS_PRO"}(e||(e={}));var f=function(){function f(){}return f.isEduUser=function(){return f.getUserInfo().then(function(){return f.userHasEduLicense})},f.isBusinessUser=function(){return f.getUserInfo().then(function(){return f.userHasBusinessLicense})},f.isMsaFreeUser=function(){return f.getUserInfo().then(function(){return f.isMsaUser()&&!f.userHasMsaPaidLicense})},f.isMsaPaidUser=function(){return f.getUserInfo().then(function(){return f.isMsaUser()&&f.userHasMsaPaidLicense})},f.isMsaUser=function(){var b=OfficeFormServerInfo.userInfo.TenantId;return!(!b||b.toLowerCase()!==a.EnvironmentConfig.getMsaTenantId())},f.isMsftUser=function(){var b=OfficeFormServerInfo.userInfo.TenantId;return!(!b||b.toLowerCase()!==a.EnvironmentConfig.getMsftTenantId())},f.isFastFoodTenant=function(){var b=OfficeFormServerInfo.userInfo.TenantId;return b&&-1!==a.EnvironmentConfig.getFastFoodTenantsId().indexOf(b.toLowerCase())},f.isFastFoodUser=function(){return a.Utilities.anyTrue(f.checkFastFoodUser("226a6eec-ea8c-4fad-a271-a956d378dc05"),f.checkFastFoodUser("0152e40c-08b6-4c80-8237-1ed743bc1f61"),f.checkFastFoodUser("bec3c99a-0246-4948-afa5-0e625c24e8b0"),f.checkFastFoodUser("7dec8ae0-a475-4883-a38a-537e74b6c036"))},f.isFormsProUser=function(){return f.getUserInfo().then(function(){return f.userHasFormsProLicense})},f.getUserType=function(){return f.getUserInfo().then(function(){var a=b.Models.UserType.Unknown;return f.userHasEduLicense&&(a=b.Models.UserType.Edu),f.userHasBusinessLicense&&(a|=b.Models.UserType.Biz),f.isMsftUser()&&(a|=b.Models.UserType.MSIT),f.isMsaUser()&&(a|=f.userHasMsaPaidLicense?b.Models.UserType.MsaPaid:b.Models.UserType.MsaFree),a},function(){return b.Models.UserType.Unknown})},f.setUserEduLicenseState=function(a){for(var b in c)if(a.hasOwnProperty(c[b])){var d=a[c[b]];if(d&&d.length>0)return void(f.userHasEduLicense=!0)}f.userHasEduLicense=!1},f.setUserBusinessLicenseState=function(a){for(var b in d)if(a.hasOwnProperty(d[b])){var c=a[d[b]];if(c&&c.length>0)return void(f.userHasBusinessLicense=!0)}f.userHasBusinessLicense=!1},f.setUserMsaLicenseState=function(a){return f.isMsaUser()&&a?void(f.userHasMsaPaidLicense=!0):void(f.userHasMsaPaidLicense=!1)},f.setUserFormsProLicenseState=function(a){for(var b in e)if(a.hasOwnProperty(e[b])){var c=a[e[b]];if(c&&c.length>0)return void(f.userHasFormsProLicense=!0)}f.userHasFormsProLicense=!1},f.getUserInfo=function(){return f.licenseReady||(f.licenseReady=$.Deferred(),$(document).ready(function(){if(OfficeFormServerInfo.userInfo.UserId){var b=a.DataProvider.ProviderManager.getInstance().createDataProvider();try{b.getUserInfo().then(function(a){var b=_.object(a.licenses.map(function(a){var b=a.licenseName,c=a.skus;return[b,JSON.parse(c)]}));f.setUserEduLicenseState(b),f.setUserBusinessLicenseState(b),f.setUserMsaLicenseState(a.isPaidUser),f.setUserFormsProLicenseState(b),f.licenseReady.resolve(b)},function(a){return f.licenseReady.reject(a)})}catch(c){f.licenseReady.reject(c)}}else f.licenseReady.resolve({});f.licenseReady.fail(function(b){a.Event.ErrorEventDeprecated.logData({errorName:"UserInfoGetFailure",errorInfo:b})})})),f.licenseReady.promise()},f.checkFastFoodUser=function(b){if(!f.checkFastFoodPromises[b]){var c=a.DataProvider.ProviderManager.getInstance().createDataProvider();f.checkFastFoodPromises[b]=c.isMemberOf(b)}return f.checkFastFoodPromises[b]},f.checkFastFoodPromises={},f}();b.FeaturePlanProvider=f}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c,d=b.ErrorCode.InnerCode;!function(c){function e(){return m||(m="USGovGccProd"===a.EnvironmentConfig.getEnvironmentType()?$.Deferred().resolve("gcc").promise():b.FeaturePlanProvider.isMsaUser()||Forms.Common.isOwnerMsaUser()?$.Deferred().resolve("msa").promise():b.FeaturePlanProvider.isMsftUser()?a.Flighting.Flight.isEnabled(a.Flighting.Flights.EnableFFUserGating)?b.FeaturePlanProvider.isFastFoodUser().then(function(a){return a?"fastfood":"msft"}):$.Deferred().resolve("msft").promise():Forms.Common.isOwnerMsftUser()?$.Deferred().resolve("msft").promise():b.FeaturePlanProvider.isFastFoodTenant()||Forms.Common.isOwnerOnFastFoodTenant()?$.Deferred().resolve("fastfood").promise():$.Deferred().resolve("business").promise()),m}function f(){var b="ms-formweb";if(a.EnvironmentSettings.IsIntegration){var c=a.EnvironmentSettings.GetHostString();c&&a.HostApps[c]&&(b="ms-"+c.toLowerCase()),OfficeFormServerInfo.isOembedSPO&&(b="forms-webpart")}return b}function g(b,c){c=c||{};var d,g=$.Deferred();c.disableLog||(d=new a.Event.QosEventDeprecated(b.qosEventName),_.extend(d.Data,{extraData:_.clone(b.qosExtraData)}),d.start(),b.headers["X-CorrelationId"]=d.CorrelationId),c.disableXMsHeader||(b.headers["x-ms-form-request-source"]=f(),e().done(function(a){b.headers["x-ms-form-request-ring"]=a}));var j=-1,k=function(){j++,i(b,function(a){g.resolve(a)},function(a){if(j>=5)return void g.reject(a);var c,e=h(b,a),f=parseInt(e.statusCode),i=e.innerCode;if(0===f||502===f||503===f)c="Forms_Http_"+f.toString();else if(500===f&&6503===i)c="CDB_Http_"+i.toString();else{if(624!==i)return void g.reject(a);c="CDB_Http_"+i.toString()}d&&d.log({resultCode:c,extraData:{RetryCount:j,ServiceError:a}}),k()},c.skipExpiredTokenCheck)};return k(),d?g.promise().done(function(c){var e={};if(e.resultCode=c&&c.response?c.response.statusCode:"",e.resultType="Success",b.qosEventName===a.Event.QosEventNames.ServiceEndpoints.Form.CreateForm){var f=l.parseResponseDataValue(c);e.extraData={FormId:f.id,XLWorkbookId:f.xlWorkbookId||void 0,Origin:a.Telemetry.getOrigin()||void 0,RetryCount:j||void 0}}d.end(e)}).fail(function(a){var c=h(b,a),e=parseInt(c.statusCode);d.end({resultCode:a&&a.response?a.response.statusCode:"",resultType:""===c.statusCode||e>=500?"Failure":"ExpectedFailure",extraData:{ServiceError:c,RetryCount:j||void 0}})}):g.promise()}function h(a,b){var c=l.convertToResponseError(b);return{statusCode:b&&b.response?b.response.statusCode:"",sourceUrl:a.requestUri.toString(),correlationId:b&&b.response?b.response.headers["X-CorrelationId"]:"",statusText:b&&b.response?b.response.statusText:"",innerCode:c?c.innerCode:-1,innerMessage:c?c.innerMessage:"",failureReason:b&&b.response?b.response.headers["X-FailureReason"]:""}}function i(c,d,e,f){function g(f){b.AuthTokenHelper.getInstance().isAuthTokenExpiredFailure(f)?b.AuthTokenHelper.getInstance().refreshAuthToken(function(){a.Flighting.Flight.isEnabled(a.Flighting.Flights.RefreshServerInfoInFrame)?c.blobResponseType?j(c,d,e):odatajs.oData.request(c,d,e):a.PageMethods.refreshAntiForgeryToken(function(){c.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken,h().always(function(){return odatajs.oData.request(c,d,e)})},function(){return Forms.Common.reloadPage()})},function(){a.Authenticator.signInThenRefresh()}):e(f)}function h(){var b=$.Deferred();return OfficeFormServerInfo.userInfo.UserId?b.resolve().promise():(a.PageMethods.refreshUserInfo(function(){return b.resolve()},function(){return b.resolve()}),b.promise())}void 0===f&&(f=!1),c.blobResponseType?j(c,d,f?e:g):odatajs.oData.request(c,d,f?e:g)}function j(a,b,c){var d=new XMLHttpRequest,e=a.requestUri;if(d.onreadystatechange=function(){if(null!=d&&4===d.readyState){var f=d.status,g=d.statusText;1223===f&&(f=204,g="No Content");var h=d.response;if(f>=200&&299>=f)d=null,b(h);else{var i=k(d);d=null,c({message:"HTTP request failed",request:a,response:{requestUri:e,statusCode:f,statusText:g,headers:i,body:h}})}}},d.open(a.method||"GET",e,!0),d.responseType="blob",a.headers)for(var f in a.headers)d.setRequestHeader(f,a.headers[f]);d.send(a.body)}function k(a){for(var b={},c=0,d=a.getAllResponseHeaders().split(/\r?\n/);c<d.length;c++){var e=d[c];if(e){var f=e.split(": ");b[f[0]]=f[1]}}return b}var l=function(){function c(){}return c.parseAndTryHandleError=function(e){var f=c.convertToResponseError(e);if(f.statusCode!==b.ErrorCode.HttpStatusCode.Unauthorized||a.EnvironmentSettings.Host===a.HostApps.PowerPoint)return f;if(c.logNonRecoverableError(f),a.Utilities.Html.getQueries().embed)return f.innerCode=d.EmbedFormNeedAuth,f;if(f.innerCode!==d.NoPermission&&f.innerCode!==d.RequireLogin)return f;var g=!(a.Utilities.isTbsBrowser()&&a.Utilities.isMicroMessenger()&&a.Utilities.isAndroid());return g?(a.Authenticator.signInThenRefresh(),$.Deferred().promise()):(f.innerCode=d.LoginNotSupportInCurrentBrowser,f)},c.logNonRecoverableError=function(b){if(b){var c=void 0;switch(b.innerCode){case d.UserNotAllowed:c=a.Event.EngagementEventNames.Auth.Auth.NotOnboardedTenant;break;case d.DisabledByTenantAdmin:c=a.Event.EngagementEventNames.Auth.Auth.DisabledByTenantAdmin;break;case d.UserNeedMultiFactorAuth:c=a.Event.EngagementEventNames.Auth.Auth.UserNeedMultiFactorAuth;break;default:c="Undefined auth error in ResponseHandler"}a.Event.EngagementEventDeprecated.logData({name:c,extraData:{tenantId:OfficeFormServerInfo.userInfo.TenantId}})}},c.parseResponseDataValue=function(a){return c.convertToAsyncResult(a).value},c.convertToAsyncResult=function(c){var d={status:b.AsyncResultStatus.Succeeded};if(null==c)d.value=c;else{var e=c["@odata.count"]&&parseInt(c["@odata.count"]);isNaN(e)||(d.count=e),d.value=a.Utilities.tryParseJson(void 0===c.value?c:c.value)}return d},c.convertToResponseError=function(b){var c={statusCode:b&&b.response&&b.response.statusCode,statusText:b&&b.response&&b.response.statusText,headers:b&&b.response&&b.response.headers,correlationId:b&&b.response&&b.response.headers["X-CorrelationId"]},e=b&&b.response&&a.Utilities.tryParseJson(b.response.body),f=e.error&&parseInt(e.error.code);return isNaN(f)?c.innerCode=0===c.statusCode?d.NetworkIssue:void 0:c.innerCode=f,c.innerMessage=e.error&&e.error.message,c},c}();c.ResponseHandler=l;var m;c.getRequestTargetRing=e,c.getExtendedSource=f,c.send=g}(c=b.OData||(b.OData={})),a.Exports.DataProvider.OData=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function a(){}return a.AADAcquireTokenError="AADAcquireTokenError",a.AADAcquireTokenMfaCheckError="AADAcquireTokenMfaCheckError",a.LoginIECrossZoneError="LoginIECrossZoneError",a.ThirdPartyCookieBlockedError="ThirdPartyCookieBlockedError",a.AuthNoStorageError="AuthNoStorageError",a.TeamSiteNoGroupError="TeamSiteNoGroupError",a.VariationMismatachError="VariationMismatachError",a}();b.ClientErrorNames=c,a.Exports.ClientErrorNames=c}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return Object.defineProperty(b,"LocalizedStrings",{get:function(){return b.localizedStrings},enumerable:!0,configurable:!0}),Object.defineProperty(b,"UniversalHeaderAndFooter",{get:function(){return b.universalHeaderAndFooter},enumerable:!0,configurable:!0}),b.loadLocalizedStrings=function(){return b.deferredLocalizedStrings||(b.deferredLocalizedStrings=$.Deferred(),a.PageMethods.getResourceStrings(function(a){b.localizedStrings=a,b.deferredLocalizedStrings.resolve(a)},function(a){return b.deferredLocalizedStrings.reject(a)})),b.deferredLocalizedStrings.promise()},b.loadLanguageStrings=function(c){if(!c)return b.loadLocalizedStrings();var d=b.languageStrings[c];if(!d){var e=$.Deferred();d=e.then(function(a){return b.localizedStrings=a,a}),b.languageStrings[c]=d,a.PageMethods.getLocalizedResourceStrings(c,function(a){return e.resolve(a)},function(a){b.loadLocalizedStrings().done(function(a){return e.resolve(a)})})}return d},b.loadUniversalHeaderAndFooter=function(){var c=this;return b.deferredUniversalHeaderAndFooter||(b.deferredUniversalHeaderAndFooter=$.Deferred(),a.PageMethods.getUniversalHeaderAndFooter("headerId=OfficeFormsHeader&footerid=OfficeFormsFooter",function(a){c.universalHeaderAndFooter=a,b.deferredUniversalHeaderAndFooter.resolve(a)},function(a){return b.deferredUniversalHeaderAndFooter.reject(a)})),b.deferredUniversalHeaderAndFooter.promise()},b.languageStrings={},b}();b.Resources=c,a.Exports.Resources=c}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a,b){n("TryAcquireToken",void 0,void 0,a,b)}function d(a,b,c){var d="GetResourceStrings",e=void 0;a&&(e="lang="+a),n(d,e,void 0,b,c)}function e(b,c){var e=a.EnvironmentConfig.getExplictLocale();return d(e,b,c)}function f(a,b){n("GetRefreshedAntiForgeryToken",void 0,void 0,function(b){OfficeFormServerInfo.antiForgeryToken=b,a&&a()},b)}function g(a,b){n("GetUserInfo",void 0,void 0,function(b){OfficeFormServerInfo.userInfo=b,a&&a()},b)}function h(){return m("GetFormTemplates",void 0,void 0,void 0)}function i(){return m("GetMSATemplates",void 0,void 0,void 0)}function j(a){return m("GetUserInfo",void 0,void 0,l(a)).then(function(a){a&&(OfficeFormServerInfo.userInfo=a)})}function k(a){return m("GetFlights",void 0,void 0,l(a)).then(function(a){a&&(OfficeFormServerInfo.flights=a)})}function l(a){return{Accept:"application/json",Authorization:a?"Bearer "+a:""}}function m(b,c,d,e){var f;f="/"===window.location.pathname?"/Default.aspx/"+b:window.location.pathname+"/"+b,c&&(f+="?"+c);var g=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.PageMethod.MethodNameFormat.format(b));return g.start(),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:f,data:d||"{}",dataType:"json",headers:e}).then(function(a){return g.end({resultType:"Success"}),a.d},function(a,c,d){return g.end({resultType:"Failure",extraData:{url:f,message:d}}),{message:d,name:"PageMethod CallWebMethod Failure: "+b}})}function n(a,b,c,d,e){m(a,b,c,void 0).done(d).fail(e)}function o(b,c,d){var e=a.EnvironmentConfig.getExplictLocale()||navigator.language,f="https://uhf.microsoft.com/"+e+"/shell/xml/OfficeForms";b&&(f+="?"+b),$.ajax({type:"GET",url:f,dataType:"xml",success:function(a){c&&c(a)},error:function(b){d&&d(b),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.Error.UHF.UniversalHeaderAndFooterError,extraData:{error:b}})}})}a.Exports.PageMethods=b,b.tryAcquireToken=c,b.getLocalizedResourceStrings=d,b.getResourceStrings=e,b.refreshAntiForgeryToken=f,b.refreshUserInfo=g,b.getFormTemplates=h,b.getMSATemplates=i,b.refreshUserInfoWithToken=j,b.refreshFlightsWithToken=k,b.getUniversalHeaderAndFooter=o}(b=a.PageMethods||(a.PageMethods={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){a[a.Taskpane=1]="Taskpane",a[a.Content=2]="Content"}(b=a.AddinType||(a.AddinType={}));var c=function(){function a(){}return Object.defineProperty(a,"AddinType",{get:function(){return a._addinType},set:function(b){a._addinType=b},enumerable:!0,configurable:!0}),Object.defineProperty(a,"IsTaskpane",{get:function(){return a.AddinType===b.Taskpane},enumerable:!0,configurable:!0}),Object.defineProperty(a,"IsContentAgave",{get:function(){return a.AddinType===b.Content},enumerable:!0,configurable:!0}),Object.defineProperty(a,"HostPlatform",{get:function(){return Office.context.platform},enumerable:!0,configurable:!0}),a}();a.AddinSettings=c}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){a._instance=this}return a.getInstance=function(){return a._instance?a._instance:new a},Object.defineProperty(a.prototype,"HostEnvironment",{get:function(){return this.hostEnvironment},set:function(a){this.hostEnvironment=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"HostPlatform",{get:function(){return this.hostPlatform},set:function(a){this.hostPlatform=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"HostLocale",{get:function(){return this.hostLocale},set:function(a){this.hostLocale=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"AccessToken",{get:function(){return this.accessToken},set:function(a){this.accessToken=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsSSOAllowed",{get:function(){return this.isSSOAllowed},set:function(a){this.isSSOAllowed=a},enumerable:!0,configurable:!0}),a}();a.PowerPointContentAddinContext=b}(b=a.PowerPointContentAddin||(a.PowerPointContentAddin={}))}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return Object.defineProperty(b,"DeferredHandler",{get:function(){return b.deferredHandler||(b.deferredHandler=$.Deferred())},enumerable:!0,configurable:!0}),b.getPopupUrl=function(b,c,d){void 0===c&&(c=a.AuthProvider.Default),void 0===d&&(d=null);var e=a.Utilities.Html.getAbsoluteUrl("/Pages/PopupLoginPage.aspx?"+a.EnvironmentSettings.PopupNotifyTypeParam+"="+a.PopupNotifyType[b]);return null!=c&&c!==a.AuthProvider.Default&&(e+="&"+a.EnvironmentSettings.AuthProviderParam+"="+a.AuthProvider[c]),d&&(e+="&"+a.EnvironmentSettings.AuthUpnParam+"="+encodeURIComponent(d)),e},b.setDialogSignInSize=function(a,c){b.popupLoginPageWidth=a,b.popupLoginPageHeight=c},b.officeDialogSignIn=function(c){return Office.context.ui.displayDialogAsync(b.getPopupUrl(a.PopupNotifyType.OfficeAPI,a.AuthProvider.OrgId,c),{width:b.popupLoginPageWidth,height:b.popupLoginPageHeight,hideTitle:!0,promptBeforeOpen:!1},function(c){var d=c.value;null!=d&&d.addEventHandler(Office.EventType.DialogMessageReceived,function(c){if(d.close(),c&&c.message){var e=JSON.parse(c.message);OfficeFormServerInfo=e||OfficeFormServerInfo,a.Flighting.Flight.refreshFlights()}b.DeferredHandler.resolve()})}),b.DeferredHandler.promise()},b.getAddinAccessToken=function(){if(a.Utilities.applyAssignmentsSSO())return this.assignmentsSsoHandler();if(a.Utilities.applyTeamSSO())return this.teamSsoHandler();if(a.EnvironmentSettings.IsPPTIntegration){if(a.AddinSettings.IsTaskpane&&a.Flighting.Flight.isEnabled(a.Flighting.Flights.PPTTaskpaneAddinSSO))return this.pptFirstPartySsoHandler();if(a.AddinSettings.IsContentAgave){if(a.AddinSettings.HostPlatform===Office.PlatformType.PC&&a.Flighting.Flight.isEnabled(a.Flighting.Flights.PPTWin32ContentAddinSSO))return this.pptFirstPartySsoHandler();if(a.AddinSettings.HostPlatform===Office.PlatformType.OfficeOnline&&a.Flighting.Flight.isEnabled(a.Flighting.Flights.PPTContentAddinSSO))return this.pptThirdPartySsoHandler()}}else if(a.EnvironmentSettings.Host===a.HostApps.OneNoteUwp)return this.oneNoteUWPSsoHandler();return $.Deferred().reject("GetAddinAccessTokenFailed").promise()},b.teamSsoHandler=function(){var b=this,c=$.Deferred(),d={successCallback:function(d){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.TeamsTab.Auth.SsoSuccess}),b.refreshInfo(d).always(function(){return c.resolve(d)})},failureCallback:function(b){a.Event.ErrorEventDeprecated.logData({errorName:"TeamsTabSsoLoginFailure",errorInfo:b}),c.reject(b)},resources:["https://forms.office.com"]};return microsoftTeams.authentication.getAuthToken(d),c.promise()},b.assignmentsSsoHandler=function(){var a=this,b=$.Deferred(),c=function(d){if(d.data&&d.data.startsWith("GetAccessTokenFromAssignments:"))try{var e="GetAccessTokenFromAssignments:Bearer ",f=d.data.indexOf(e);if(-1!==f){var g=d.data.substring(f+e.length);a.refreshInfo(g).always(function(){return b.resolve(g)})}}finally{window.removeEventListener("message",c,!1)}};return window.addEventListener("message",c,!1),window.parent.postMessage("GetAccessTokenFromAssignments","*"),b.promise()},b.oneNoteUWPSsoHandler=function(){var b=this,c=$.Deferred();return OneNote.run(function(d){var e=d.application,f=e._GetServiceTokens("Form");return d.sync().then(function(){if(null!=f&&f.value.length>0){var d=f.value[0].headerValue;b.refreshInfo(d).always(function(){return c.resolve(d)})}else a.Event.ErrorEventDeprecated.logData({errorName:"OneNoteAddinGetTokenFromUWPHostFailure",errorInfo:"Fail to Get Access Token from UWP OneNote host"}),c.reject()})})["catch"](function(b){a.Event.ErrorEventDeprecated.logData({errorName:"OneNoteAddinGetTokenFromUWPHostFailure",errorInfo:b}),c.reject()}),c.promise()},b.pptFirstPartySsoHandler=function(){var b=this,c=$.Deferred();a.Event.EngagementEventDeprecated.logData({name:a.AddinSettings.IsTaskpane?a.Event.EngagementEventNames.PowerPointTaskpaneAddinPage.Initialize.GetToken:a.Event.EngagementEventNames.PowerPointContentAddinPage.Initialize.GetToken,extraData:{hostPlatform:a.AddinSettings.HostPlatform,isFirstParty:!0}});var d=function(d){a.Event.EngagementEventDeprecated.logData({name:a.AddinSettings.IsTaskpane?a.Event.EngagementEventNames.PowerPointTaskpaneAddinPage.Initialize.GetTokenCompleted:a.Event.EngagementEventNames.PowerPointContentAddinPage.Initialize.GetTokenCompleted,extraData:{hostPlatform:a.AddinSettings.HostPlatform,isFirstParty:!0,isGetAccessTokenSucceeded:!0}}),b.refreshInfo(d).always(function(){return c.resolve(d)})},e=function(b){a.Event.ErrorEventDeprecated.logData({errorName:a.AddinSettings.IsTaskpane?"PowerPointTaskpaneAddinGetTokenFailure":"PowerPointContentAddinGetTokenFailure",errorInfo:b}),c.reject(b)};if(a.Flighting.Flight.isEnabled(a.Flighting.Flights.PPTWin32FirstPartySSOLegacyAPI)){var f=new OfficeCore.RequestContext,g=f.firstParty.authentication.getAccessToken({resource:"https://forms.office.com"});f.sync().then(function(){var a=g.value.accessToken;d(a)})["catch"](function(a){e(a)})}else{var h=OfficeFirstPartyAuth.getAccessToken({
resource:"https://forms.office.com"});h.then(function(a){var b=a.accessToken;d(b)})["catch"](function(a){e(a)})}return c.promise()},b.pptThirdPartySsoHandler=function(){var b=this,c=$.Deferred();if(a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.PowerPointContentAddinPage.Initialize.GetToken,extraData:{isFirstParty:!1}}),Office.context.auth.getAccessTokenAsync)Office.context.auth.getAccessTokenAsync({forceConsent:!1,forceAddAccount:!1},function(d){if(d.status===Office.AsyncResultStatus.Succeeded){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.PowerPointContentAddinPage.Initialize.GetTokenCompleted,extraData:{isFirstParty:!1}});var e=d.value;b.refreshInfo(e).always(function(){return c.resolve(e)})}else a.Event.ErrorEventDeprecated.logData({errorName:"PowerPointContentAddinGetTokenFailure",errorInfo:d.error}),c.reject(d.error)});else{var d=a.Form.PowerPointContentAddin.PowerPointContentAddinContext.getInstance();a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.PowerPointContentAddinPage.Initialize.GetTokenThirdPartySSONotSupported,extraData:{hostEnvironment:d.HostEnvironment,hostPlatform:d.HostPlatform}}),c.reject("Third party SSO API is not supported.")}return c.promise()},b.teamsPopupSignIn=function(){return a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.TeamsTab.Auth.Navigate}),microsoftTeams.authentication.authenticate({url:b.getPopupUrl(a.PopupNotifyType.TeamsAPI,a.AuthProvider.OrgId),width:b.popupLoginPageWidth,height:b.popupLoginPageHeight,successCallback:function(c){if(c){var d=JSON.parse(c);OfficeFormServerInfo=d||OfficeFormServerInfo,a.Flighting.Flight.refreshFlights()}a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.TeamsTab.Auth.Success}),b.DeferredHandler.resolve()},failureCallback:function(c){a.Event.ErrorEventDeprecated.logData({errorName:"TeamsTabLoginFailure",errorInfo:c}),b.DeferredHandler.reject(c)}}),b.DeferredHandler.promise()},b.refreshInfo=function(b){try{return $.when(this.refreshUserInfo(b),this.refreshFlights(b))}catch(c){return a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.TeamsTab.Auth.RefreshInfoFailed}),$.Deferred().resolve().promise()}},b.refreshUserInfo=function(c){return b.userInfoPromise&&b.userInfoPromise.state()!==a.Utilities.Promise.State.Rejected||(b.userInfoPromise=a.PageMethods.refreshUserInfoWithToken(c).then(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.AddinPage.PageMethod.GetAddinUserInfoSuccess})},function(b){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.AddinPage.PageMethod.GetAddinUserInfoFailed,extraData:{error:b}})})),b.userInfoPromise},b.refreshFlights=function(c){return b.flightPromise&&b.flightPromise.state()!==a.Utilities.Promise.State.Rejected||(b.flightPromise=a.PageMethods.refreshFlightsWithToken(c).then(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.AddinPage.PageMethod.GetFlightsSuccess}),a.Flighting.Flight.refreshFlights()},function(b){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.AddinPage.PageMethod.GetFlightsFailed,extraData:{error:b}})})),b.flightPromise},b.popupLoginPageHeight=485,b.popupLoginPageWidth=770,b}();b.AddinAuth=c,a.Exports.AddinAuth=c}(b=a.Form||(a.Form={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function c(b,c){this.aadLauncherSesstionStorageKey="aadFormLauncher",this.msaLauncherSesstionStorageKey="msaFormLauncher",this.isAccessTokenFromHostReceived=!1,this.authContext=Forms.getPageContext().AuthContext,this.serviceUrl=b,this.ownerServiceUrl=c,this.partialUpdateHttpMethod=a.Flighting.Flight.isEnabled(a.Flighting.Flights.PartialPut)?"PUT":"PATCH"}return Object.defineProperty(c,"AnalysisFormEntityCollectionName",{get:function(){return"analysisForms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"FormEntityCollectionName",{get:function(){return"forms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RuntimeFormEntityCollectionName",{get:function(){return"runtimeForms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RuntimeFormEntityCollectionName2",{get:function(){return"runtimeForms2"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"QuestionEntityCollectionName",{get:function(){return"questions"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"DescriptiveElementEntityCollectionName",{get:function(){return"descriptiveQuestions"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"ChoiceEntityCollectionName",{get:function(){return"choices"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"ResponseEntityCollectionName",{get:function(){return"responses"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RuntimeResponseEntityCollectionName",{get:function(){return"runtimeresponses"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"CommentEntityCollectionName",{get:function(){return"comments"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetSharedForm",{get:function(){return"GetSharedForm"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"PermissionEntityCollectionName",{get:function(){return"permissions"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"PermissionTokenEntityCollectionName",{get:function(){return"permissionTokens"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"SharedWithMeFormEntityCollectionName",{get:function(){return"sharedWithMeForms"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetAggregateQuizDataFunctionName",{get:function(){return"GetAggregateQuizData"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetAggregateSurveyDataFunctionName",{get:function(){return"GetAggregateSurveyData"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"GetOrCreatePermissionTokenFunctionName",{get:function(){return"Microsoft.FormServices.GetOrCreatePermissionToken"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RemoveRecentFormFunctionName",{get:function(){return"RemoveFromRecent"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"CreateOneDriveSessionTempFolderFunctionName",{get:function(){return"Microsoft.FormServices.CreateOneDriveSessionTempFolder"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"MoveFormFunctionName",{get:function(){return"MoveForm"},enumerable:!0,configurable:!0}),Object.defineProperty(c,"LocaleResourceEntityCollectionName",{get:function(){return"localeResource"},enumerable:!0,configurable:!0}),c.addDefaultHeader=function(a,b){null===c.customizedHeaders&&(c.customizedHeaders={}),c.customizedHeaders[a]=b},c.prototype.getForms=function(b){var d=this.getSurveyWebOwnerServiceUrl()+"light/";return d+=c.FormEntityCollectionName+c.getQueryParameters("?",b),Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetForms})},c.prototype.getFormsSharedWithCurrentUser=function(){var b=this.getSurveyWebOwnerServiceUrl()+c.SharedWithMeFormEntityCollectionName;return this.sendRequest({requestUri:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetSharedWithMeForms})},c.prototype.getFormId=function(b,c,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"GetFormId(tenantid='{0}',userid='{1}',tableid='{2}')".format(b,c,d),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormId})},c.prototype.getDesignForm=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"light/";return e+=c.FormEntityCollectionName+"('"+b+"')",e+=c.getQueryParameters("?",d),Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequest({requestUri:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetDesignForm})},c.prototype.getRuntimeForm=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"light/"+c.RuntimeFormEntityCollectionName+"('"+b+"')";return e+=c.getQueryParameters("?",d),Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequest({requestUri:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetRuntimeForm})},c.prototype.getRuntimeFormV2=function(b,d){var e=this.getSurveyWebOwnerServiceUrl()+"light/"+c.RuntimeFormEntityCollectionName2+"('"+b+"')";return e+=c.getQueryParameters("?",d),Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequest({requestUri:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetRuntimeForm2})},c.prototype.getAnalysisTimeForm=function(b){var d="$expand="+c.QuestionEntityCollectionName+"($expand="+c.ChoiceEntityCollectionName+")",e=this.getSurveyWebOwnerServiceUrl()+"light/"+c.AnalysisFormEntityCollectionName+"('"+b+"')?"+d;return Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequest({requestUri:e,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetAnalysisForm})},c.prototype.getSharedForm=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.GetSharedForm+"(formid='"+b+"',token='"+a.Utilities.Html.getQueries().sharetoken+"')",method:"GET",headers:{"Content-Type":"application/json;odata.metadata=minimal"},body:'{"value" : "'+a.Utilities.Html.getQueries().sharetoken+'"}',qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetSharedForm})},c.prototype.createOD4BSessionTempFolder=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.RuntimeFormEntityCollectionName+"('"+b+"')/"+c.CreateOneDriveSessionTempFolderFunctionName,method:"POST",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateOD4BSessionTempFolder}).then(function(a){return a?a.itemId:$.Deferred().reject(new Error("Failed to create OneDriveForBusiness session temp folder.")).promise()})},c.prototype.changeSharingStatus=function(b,c){var d=c?"On":"Off";return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"/forms('"+b+"')/Microsoft.FormServices.Turn"+d+"AllowCopySetting",method:"POST",qosEventName:c?a.Event.QosEventNames.ServiceEndpoints.Form.TurnOnFormSharing:a.Event.QosEventNames.ServiceEndpoints.Form.TurnOffFormSharing})},c.prototype.createPermissionLink=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateFormPermissionLink})},c.prototype.deletePermissionLink=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.DeleteFormPermissionLink})},c.prototype.getFormPermissions=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionEntityCollectionName,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetFormPermissions})},c.prototype.createPermissionToken=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionTokenEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateFormPermissionToken})},c.prototype.getOrCreateFormPermissionToken=function(b,d,e){var f={};return a.EnvironmentSettings.IsTeamsIntegration&&(f["x-ms-form-request-source"]="ms-teams"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.GetOrCreatePermissionTokenFunctionName,method:"POST",headers:f,data:{type:d,name:e},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetOrCreatePermissionToken})},c.prototype.deletePermissionToken=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionTokenEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.DeleteFormPermissionToken})},c.prototype.getFormPermissionsTokens=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.PermissionTokenEntityCollectionName,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetFormPermissionsToken})},c.prototype.getIdentityProviderType=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"authinfo/idptype?username="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetIdentityProviderType}).then(function(a){return a.ProviderType})},c.prototype.createForm=function(b){var d={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName,method:"POST",data:b,headers:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateForm,qosExtraData:{FormType:this.getFormType(b)}})},c.prototype.updateForm=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')",method:this.partialUpdateHttpMethod,data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.UpdateForm,qosExtraData:{SoftDeleted:d.softDeleted}})},c.prototype.postFormShareAction=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+c.FormEntityCollectionName+"('"+b+"')/shareaction",method:"POST",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.PostShareAction})},c.prototype.createFormImageFromUrl=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+d,method:"POST",data:e,qosEventName:"logo"===d?a.Event.QosEventNames.ServiceEndpoints.Form.CreateImageFromUrl:a.Event.QosEventNames.ServiceEndpoints.Form.CreateThemeImageFromUrl,qosExtraData:{FormProperty:d}})},c.prototype.deleteForm=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.DeleteForm})},c.prototype.dupFormForExcel=function(b,d){var e={id:b,xlWorkbookId:d};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName,method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Excel.DuplicateFormForExcel})},c.prototype.moveForm=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+c.FormEntityCollectionName+"('"+b+"')/"+c.MoveFormFunctionName,method:"POST",data:{newOwnerId:d,isNewOwnerGroup:e},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.MoveForm})},c.prototype.getRecentForms=function(b,c,d){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetRecentForms(pinnedState='{0}',extension='{1}',knowledge='{2}',count=250)".format(b,c,d),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetRecentForms})},c.prototype.removeRecentForm=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.RemoveRecentFormFunctionName,method:"POST",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.RemoveRecentForm})},c.prototype.getFormsTenantSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetFormsTenantSettings",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormsTenantSettings})},c.prototype.getFormCreatorPhotoDefinition=function(b){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+("light/GetFormCreatorDefinition('"+b+"','')"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormCreatorPhotoDefinition})},c.prototype.getFormCreatorPhotoValue=function(b){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+("light/GetFormCreatorPhotoValue('"+b+"','')/$value"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormCreatorPhotoValue})},c.prototype.getCurrentUserPhotoValue=function(){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"GetCurrentUserPhotoValue",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetCurrentUserPhotoValue})},c.prototype.getPrivacySettings=function(b,c){var d={};return b&&(d.ownerTenantId=b),c&&(d.currentUserTenantId=c),this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"privacy?"+$.param(d),qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetPrivacySettings})},c.prototype.getFormQuestion=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')";return e&&(f=f+"?$select="+e.toString()),this.sendRequest({requestUri:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.GetQuestion})},c.prototype.getFormQuestionCount=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"/$count",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.GetQuestionCount})},c.prototype.createFormQuestion=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.CreateQuestion,qosExtraData:{IsQuiz:d.isQuiz,QuestionId:d.id,QuestionType:d.type}})},c.prototype.createQuestionImageFromUrl=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/image",method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.CreateImageFromUrl,qosExtraData:{QuestionId:d}})},c.prototype.updateFormQuestion=function(b,d,e,f){var g=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')";return this.sendRequest({requestUri:g,method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.UpdateQuestion,qosExtraData:{QuestionType:e}},{disableLog:!0})},c.prototype.deleteFormQuestion=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.DeleteQuestion,qosExtraData:{QuestionType:e}})},c.prototype.getFormDescriptiveElement=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName+"('"+d+"')";return e&&(f=f+"?$select="+e.toString()),this.sendRequest({requestUri:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Get})},c.prototype.createFormDescriptiveElement=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Create,qosExtraData:{QuestionId:d.id,QuestionType:d.type}})},c.prototype.updateFormDescriptiveElement=function(b,d,e,f){var g=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName+"('"+d+"')";return this.sendRequest({requestUri:g,method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Update,qosExtraData:{QuestionType:e}},{disableLog:!0})},c.prototype.deleteFormDescriptiveElement=function(b,d,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.DescriptiveElementEntityCollectionName+"('"+d+"')",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.DescriptiveElement.Delete,qosExtraData:{QuestionType:e}})},c.prototype.createQuestionChoice=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName;return this.sendRequest({requestUri:f,method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.CreateChoice})},c.prototype.getQuestionChoice=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName+"("+e+")";return this.sendRequest({requestUri:f,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.GetChoice})},c.prototype.updateQuestionChoice=function(b,d,e,f){var g=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName+"("+e+")";return this.sendRequest({requestUri:g,method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.UpdateChoice})},c.prototype.deleteQuestionChoice=function(b,d,e){var f=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.QuestionEntityCollectionName+"('"+d+"')/"+c.ChoiceEntityCollectionName+"("+e+")";return this.sendRequest({requestUri:f,method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Choice.DeleteChoice})},c.prototype.getFormResponses=function(b,d,e,f){var g=["$expand="+c.CommentEntityCollectionName];d&&g.push("$filter={0}+{1}+{2}".format(d.name,d.operator,d.value)),e>=0&&f>=0&&g.push("$top={0}&$skip={1}".format(e,f));var h=g.filter(function(a){return!!a}).join("&");h=h&&"?"+h;var i=this.getSurveyWebOwnerServiceUrl()+"light/";return this.sendRequest({requestUri:i+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+h,qosEventName:_.any(g,function(a){return-1===a.indexOf("$filter")})?a.Event.QosEventNames.ServiceEndpoints.Response.GetResps:a.Event.QosEventNames.ServiceEndpoints.Response.GetRespFilter})},c.prototype.getRuntimeResponses=function(b,d){var e="?$expand="+c.CommentEntityCollectionName,f=d?"&$filter=responder+eq+'"+encodeURIComponent(d.replace(/\'/g,"''"))+"'":"",g=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({requestUri:g+c.FormEntityCollectionName+"('"+b+"')/"+c.RuntimeResponseEntityCollectionName+e+f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetRuntimeResps})},c.prototype.getRuntimeResponse=function(b,d){var e="?$expand="+c.CommentEntityCollectionName,f=a.Utilities.Html.getQueries(),g={};return f.GetResponseToken&&(g={GetResponseToken:f.GetResponseToken}),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/"+c.FormEntityCollectionName+"('"+b+"')/"+c.RuntimeResponseEntityCollectionName+"("+d+")"+e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetRuntimeResponse,headers:g})},c.prototype.getAnalysisTimeResponses=function(b,d,e){var f="?$expand="+c.CommentEntityCollectionName,g=this.getSurveyWebOwnerServiceUrl()+c.AnalysisFormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+f;return d>=0&&e>=0&&(g+="&$top={0}&$skip={1}".format(d,e)),this.sendRequest({requestUri:g,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetAnalysisTimeResponses})},c.prototype.getFormsResponseCount=function(){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+"light/GetRespCounts()",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetFormCreatorPhotoDefinition})},c.prototype.getFormResponseCount=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"/$count",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.GetRespCount},{disableLog:!0})},c.prototype.submitFormResponse=function(b,d){var e=a.Utilities.FormId.decodeFormId(b),f="AAD";return null==e.OrgId?f="Unknown":e.OrgId.toLowerCase()===a.EnvironmentConfig.getMsaTenantId()&&(f="MSA"),Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName,method:"POST",data:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.SubmitResp,qosExtraData:{OwnerSource:f}})},c.prototype.deleteFormResponses=function(b){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName,method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.DeleteResps})},c.prototype.deleteFormResponse=function(b,d){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"("+d+")/",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.DeleteResp})},c.prototype.addFormResponseComment=function(b,d,e){var f={feedback:e.feedback,score:e.score,questionId:e.questionId};return e.id&&(f.id=e.id),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"("+d+")/"+c.CommentEntityCollectionName,method:"POST",data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.AddComment})},c.prototype.setResponseReleaseDate=function(b,d,e){var f={releaseDate:e};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.ResponseEntityCollectionName+"("+d+")",method:this.partialUpdateHttpMethod,data:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Response.SetReleaseDate})},c.prototype.createExportFile=function(a){var b=this;return this.getToken().then(function(d){var e,f="cdb-export-iframe",g=b.createHiddenIFrame(f);if(e=document.createElement("form"),e.style.display="none",e.method="POST",e.action=b.getSurveyWebServiceUrl()+c.FormEntityCollectionName+"('"+a+"')/Microsoft.FormServices.CreateExportFile",e.target=f,null!==d){var h=document.createElement("input");h.type="hidden",h.name="Authorization",h.value="Bearer "+d,e.appendChild(h)}if(null!==OfficeFormServerInfo.antiForgeryToken){var i=document.createElement("input");i.type="hidden",i.name="__RequestVerificationToken",i.value=OfficeFormServerInfo.antiForgeryToken,e.appendChild(i)}document.body.appendChild(g),$(g).ready(function(){g.contentDocument.body.appendChild(e)}),e.submit()})},c.prototype.downloadExcelFile=function(c,d,e){var f=this;return this.getToken().then(function(g){var h=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Function.DownloadExcelFileApi);h.start();var i=$.Deferred(),j="download-excel-iframe",k=f.createHiddenIFrame(j);return document.body.appendChild(k),$(k).ready(function(){var j="downloadCookie"+(new Date).getTime(),l=f.getDownloadExcelRequestUrlParameters(c,d,e,j,h.CorrelationId,g),m=f.getDownloadExcelRequestUrl(l),n={sourceUrl:m,innerCode:b.ErrorCode.InnerCode.DownloadExcelFileFailed,innerMessage:void 0},o=24,p=o,q=5e3,r=function(){var c=a.Utilities.getCookie(j);if("success"===c)return h.end({resultType:"Success"}),window.clearInterval(s),a.Utilities.clearCookie(j),void i.resolve();if(p--<0){k.onload=null,window.clearInterval(s);var d=_.clone(n);if(!a.EnvironmentConfig.isOsi())return h.end({resultType:"Success"}),void i.resolve();d.innerMessage="TimeOut",d.innerCode=b.ErrorCode.InnerCode.DownloadExcelFileTimeout,h.end({resultType:"Failure",extraData:{ServiceError:d}}),i.reject({innerCode:b.ErrorCode.InnerCode.DownloadExcelFileTimeout,innerMessage:d.innerMessage})}},s=window.setInterval(r,q),t=3,u=function(){p=o,s=window.setInterval(r,q),k.contentWindow.location.href=m};$(k).on("load",function(){var c="";if(a.Flighting.Flight.isEnabled(a.Flighting.Flights.LogDownloadExcelErrorMessage))try{c=k.contentDocument.body.innerText}catch(d){c="Cross-origin so doesn't get the error message."}if(window.clearInterval(s),t>0)t--,f.downloadExcelCheckAndHandleAuthFailure(c,u);else{var e=_.clone(n);e.innerMessage="Error",h.end({resultType:"Failure",extraData:{ServiceError:e,errorMessage:c}}),i.reject({innerCode:b.ErrorCode.InnerCode.DownloadExcelFileFailed,innerMessage:e.innerMessage})}}),k.contentWindow.location.href=m}),i.promise()})},c.prototype.getShellServiceInfo=function(b){var c=this,d=null,e=a.SafeStorage.SessionStorage;if(d=e.getItem(this.aadLauncherSesstionStorageKey)){var f=$.Deferred();return f.resolve(JSON.parse(d)).promise()}return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetShellServiceInfo}).then(function(a){return e.setItem(c.aadLauncherSesstionStorageKey,JSON.stringify(a)),a})},c.prototype.getConsumerShellServiceInfo=function(b){var c=this,d=null,e=a.SafeStorage.SessionStorage;if(d=e.getItem(this.msaLauncherSesstionStorageKey)){var f=$.Deferred();return f.resolve(JSON.parse(d)).promise()}return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetConsumerShellServiceInfo(culture='{0}')".format(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetConsumerShellServiceInfo}).then(function(a){return window.sessionStorage.setItem(c.msaLauncherSesstionStorageKey,JSON.stringify(a)),a})},c.prototype.getOrNewExcelInOneDrive=function(b,c){var d=this.getSurveyWebOwnerServiceUrl()+"GetOrNewExcelInOneDrive(formid='"+b+"',forcereexport='"+c+"')";return this.sendRequest({requestUri:d,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Action.OpenExcelInOneDrive})},c.prototype.getYoutubeVideoInfo=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"embed?youtubeurl="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetYouTubeVideoInfo})},c.prototype.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.GetUserInfo})},c.prototype.getXlWorkbookId=function(b){var c=this.getSurveyWebServiceUrl()+"GetXlWorkbookId(formid='"+b+"')";return this.sendRequest({requestUri:c,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Action.GetXlWorkbookId})},c.prototype.isMemberOf=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"light/IsMemberOf('"+b+"')",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Function.IsMemberOf},{disableXMsHeader:!0})},c.prototype.mathCalculation=function(b){if(!b||!b.Mathml){var c={Aria:"",Responses:[]};return $.Deferred().resolve(c).promise()}var d={Context:b.Context,Formulas:[b.Mathml],InputFormat:"MathML",Locale:navigator.language,Mode:1,OutputFormat:"latex",RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this.getSurveyWebServiceUrl()+"math/calculation?formId="+b.FormId+"&questionId="+b.QuestionId,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathCalculation})},c.prototype.mathQuestionGeneration=function(b){if(!b.Context){var c={Features:0,Results:[]};return $.Deferred().resolve(c).promise()}var d={Features:b.Features,Input:b.Context,InputFormat:"MathML",Locale:navigator.language,OutputFormat:"latex",RequiredQuestionsCount:b.QuestionCount,RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this.getSurveyWebServiceUrl()+"mathapi/questions?formId="+b.FormId+"&questionId="+b.QuestionId,
qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathQuestionGeneration})},c.prototype.browseImage=function(b,c,d){var e={resourceId:b,itemCount:c,skipToken:d};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/browseimage",method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.BrowseImage})},c.prototype.getToken=function(){return this.authContext.getFormApiToken()},c.prototype.searchImage=function(b,c,d,e,f){var g={query:b,itemCount:d,lcid:OfficeFormServerInfo.cultureInfo.Name.toLowerCase(),parameters:{license:c},skipToken:e.toString(),url:f};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/searchimage",method:"POST",data:g,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.SearchImage})},c.prototype.getCdbToken=function(){var b=$.Deferred();return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=CollabDB",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.GetCdbToken}).then(function(a){a?b.resolve(a):b.reject(new Error("Failed to get CDB token via GetTokenForResource"))},function(a){b.reject(a)}),b.promise()},c.prototype.getOD4BToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=MSGraph",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Decomposition.GetOD4BToken}).then(function(a){return a?"Bearer "+a:$.Deferred().reject(new Error("Failed to get OneDriveForBusiness token via GetTokenForResource")).promise()})},c.prototype.reportAbuse=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/report",method:"POST",data:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.OnlineSafety.ReportAbuse,qosExtraData:{Category:b.Category}})},c.prototype.getGroups=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetGroups})},c.prototype.getGroupId=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groupinfo/getgroupid?onedriveweburl="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetGroupId})},c.prototype.getGroup=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetGroup})},c.prototype.getGroupOwners=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/owners"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetOwners})},c.prototype.getGroupMembers=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/members"),qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetMembers})},c.prototype.getGroupPhotoDefinition=function(b){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/photo"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetPhotoDefinition})},c.prototype.getGroupPhotoValue=function(b){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/photo/$value"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetPhotoValue})},c.prototype.getGroupMemberPhotoDefinition=function(b,c){return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/members('"+c+"')/photo"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetMemberPhotoDefinition})},c.prototype.getGroupMemberPhotoValue=function(b,c){return this.sendRequestWithToken({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+("groups('"+b+"')/members('"+c+"')/photo/$value"),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Group.GetMemberPhotoValue})},c.prototype.getAnalysisSurveyData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.GetAggregateSurveyDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.AggregateSurveyData})},c.prototype.getAnalysisQuizData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+b+"')/"+c.GetAggregateQuizDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.AggregateQuizData})},c.prototype.getResultSharingAnalysisSurveyData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.AnalysisFormEntityCollectionName+"('"+b+"')/"+c.GetAggregateSurveyDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.ResultSharingAggregateSurveyData})},c.prototype.getResultSharingAnalysisQuizData=function(b){var d=this.getSurveyWebOwnerServiceUrl()+c.AnalysisFormEntityCollectionName+"('"+b+"')/"+c.GetAggregateQuizDataFunctionName;return this.sendRequest({requestUri:d,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Analysis.ResultSharingAggregateQuizData})},c.prototype.getInsights=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"insights/getinsights?formId="+encodeURIComponent(b),method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetInsights})},c.prototype.getFormsWithToken=function(b,d,e){void 0===b&&(b=!1);var f=this.getSurveyWebServiceUrl()+c.FormEntityCollectionName+c.getQueryParameters("?",d);return Forms.Common.logFlightStatus(a.Flighting.Flights.SocialSharing),this.sendRequestWithToken({requestUri:f,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.GetForms},{skipExpiredTokenCheck:!!e},e)},c.prototype.createFormWithToken=function(b,d){var e={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return this.sendRequestWithToken({requestUri:this.getSurveyWebServiceUrl()+c.FormEntityCollectionName,method:"POST",data:b,headers:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Form.CreateForm,qosExtraData:{FormType:this.getFormType(b)}},{},d)},c.prototype.checkAnonymousAccess=function(a){var d=this.getSurveyWebOwnerServiceUrl()+"light/"+c.RuntimeFormEntityCollectionName+"('"+a+"')";return b.OData.send({requestUri:d,headers:[]},{disableLog:!0,skipExpiredTokenCheck:!0}).then(function(){return!0},function(a){var c=b.OData.ResponseHandler.convertToResponseError(a);return c.statusCode===b.ErrorCode.HttpStatusCode.Unauthorized?$.Deferred().resolve(!1).promise():c})},c.prototype.experimentationGetVariations=function(){var a=this.getSurveyWebServiceUrl()+"experimentation/getvariations";return this.sendRequest({requestUri:a,method:"GET"})},c.prototype.experimentationActivate=function(a){var b=this.getSurveyWebServiceUrl()+"experimentation/activate?experimentKey="+a;return this.sendRequest({requestUri:b,method:"GET"})},c.prototype.experimentationTrack=function(a,b){var c=this.getSurveyWebServiceUrl()+"experimentation/track?experimentKey="+a+"&eventKey="+b;return this.sendRequest({requestUri:c,method:"GET"})},c.prototype.getDeletedUserByIdOrEmail=function(a){var b=this.getSurveyWebServiceUrl()+"deleteduserinfo/byidemail/"+encodeURIComponent(a);return this.sendRequest({requestUri:b,method:"GET"})},c.prototype.getUserSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.UserSettings.GetUserSettings})},c.prototype.updateUserSettings=function(b){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:this.partialUpdateHttpMethod,data:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.UserSettings.UpdateUserSettings})},c.prototype.getAllLocaleResources=function(b){var c=this.getMultilingualBaseUrl(b);return this.sendRequest({requestUri:c,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.GetAllLocales})},c.prototype.getLocaleResource=function(b,c){var d=this.getMultilingualBaseUrl(b)+"/'"+c+"'";return this.sendRequest({requestUri:d,method:"GET",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.GetLocale})},c.prototype.createLocaleItem=function(b,c){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(b),method:"POST",data:c,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.CreateLocaleItem})},c.prototype.updateLocaleItem=function(b,c){var d=this.getMultilingualBaseUrl(b)+"/'"+c.locale+"'/";return d+=c.questionId?"question/'"+c.questionId+"'/'":"form/'",d+=c.elementKey+"'",this.sendRequest({requestUri:d,method:this.partialUpdateHttpMethod,data:{ElementValue:c.elementValue},qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.UpdateLocaleItem})},c.prototype.deleteLocale=function(b,c){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(b)+"/'"+c+"'",method:"DELETE",qosEventName:a.Event.QosEventNames.ServiceEndpoints.Multilingual.DeleteLocale})},c.getQueryParameters=function(a,b){if(!b)return a+"$expand="+c.QuestionEntityCollectionName;b=_.union(["id"],b);var d="$select="+b.join(","),e={permissions:"permissions"};e[c.QuestionEntityCollectionName]=c.QuestionEntityCollectionName+"($expand="+c.ChoiceEntityCollectionName+")",e[c.PermissionTokenEntityCollectionName]="permissionTokens";var f=b.map(function(a){return e[a]}).filter(function(a){return a});return f.length&&(d+="&$expand="+f.join(",")),d&&a+d},c.prototype.sendRequestWithToken=function(a,c,d){var e=this;return $.when(d||this.getToken()).then(function(d){return a.headers=$.extend(!0,a.headers,e.getCommonHeaders(d)),b.OData.send(a,c).then(b.OData.ResponseHandler.parseResponseDataValue,b.OData.ResponseHandler.parseAndTryHandleError)})},c.prototype.getDownloadExcelRequestUrlParameters=function(b,c,d,e,f,g){var h=(new Date).getTimezoneOffset().toString(),i={formid:b,timezoneOffset:h,downloadCookie:e,minResponseId:c,maxResponseId:d,"X-CorrelationId":f};return a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)||(i.Authorization=g),i},c.prototype.getDownloadExcelRequestUrl=function(a){return this.getExcelServiceBaseUrl()+"formapi/DownloadExcelFile.ashx?"+$.param(a)},c.prototype.downloadExcelCheckAndHandleAuthFailure=function(c,d){var e=a.Utilities.tryParseJson(c),f=e&&(e.error&&parseInt(e.error.code)||parseInt(e.ErrorCode));f===b.ErrorCode.InnerCode.TokenExpired||f===b.ErrorCode.InnerCode.RequireLogin?b.AuthTokenHelper.getInstance().refreshAuthToken(function(){a.Flighting.Flight.isEnabled(a.Flighting.Flights.RefreshServerInfoInFrame)?d():a.PageMethods.refreshAntiForgeryToken(d,function(){return Forms.Common.reloadPage()})},function(){a.Authenticator.signInThenRefresh()}):d()},c.prototype.sendRequestInner=function(a,c,d){var e=this;return this.getToken().then(function(a){return c.headers=$.extend(!0,c.headers,e.getCommonHeaders(a)),b.OData.send(c,d).then(b.OData.ResponseHandler.convertToAsyncResult,b.OData.ResponseHandler.parseAndTryHandleError)}).then(a)},c.prototype.sendRequest=function(a,b){return this.sendRequestInner(function(a){return a&&a.value},a,b)},c.prototype.createHiddenIFrame=function(a){var b=document.getElementById(a);return b&&b.parentNode.removeChild(b),b=document.createElement("iframe"),b.id=a,b.name=a,b.hidden=!0,b},c.prototype.getCommonHeaders=function(b){var d={Accept:"application/json",Authorization:b?"Bearer "+b:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken,ShareInvitationKey:a.Utilities.Html.getHashes().Token,AnalyzerToken:a.Utilities.Html.getQueries().AnalyzerToken,ValidationToken:a.Utilities.Html.getQueries().vt};return d=_.extend({},d,c.customizedHeaders)},c.prototype.getSurveyWebServiceUrl=function(){return this.serviceUrl},c.prototype.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},c.prototype.getExcelServiceBaseUrl=function(){return this.serviceUrl.slice(0,-12)},c.prototype.getMultilingualBaseUrl=function(a){return this.getSurveyWebOwnerServiceUrl()+c.FormEntityCollectionName+"('"+a+"')/"+c.LocaleResourceEntityCollectionName},c.prototype.getFormType=function(a){var b=null;if(a&&a.settings){var c=null;try{c=JSON.parse(a.settings)}catch(d){}a.category&&a.category.split(" ").indexOf("Poll")>=0?b="Poll":c&&void 0!==c.IsQuizMode&&(b=c.IsQuizMode?"Quiz":"Form")}return b||void 0},c.customizedHeaders={},c}();b.FormApi=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b,c=a.ErrorCode.InnerCode;!function(a){function b(a){var b=new FileReader;b.readAsDataURL(a);var c=$.Deferred();return b.onload=function(){c.resolve(b.result).promise()},c.promise()}function d(a){var b=$.Deferred();try{for(var d=a.split(","),e=(d[0].match(/:(.*?);/)[1],window.atob(d[1])),f=e.length,g=new Uint8Array(f);f--;)g[f]=e.charCodeAt(f);b.resolve(new Blob([g]))}catch(h){b.reject({correlationId:null,statusCode:0,innerCode:c.ImageTypeConvertFailed,innerMessage:"Image Type Convert Error",statusText:"Image Converting from Base64 to Blob Error"})}return b.promise()}a.convertImageBlobToBase64=b,a.convertImageDataURLToBlob=d}(b=a.ImageProcessing||(a.ImageProcessing={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=b.ErrorCode.InnerCode,d=function(){function d(a){for(this.authContext=Forms.getPageContext().AuthContext,this.serviceUrl=a.trim();"/"===this.serviceUrl.charAt(this.serviceUrl.length-1);)this.serviceUrl=this.serviceUrl.substr(0,this.serviceUrl.length-1)}return d.prototype.deleteQuestionImage=function(a,b,c){var e=this,f=this.getToken();return f.then(function(f){return d.deleteImageInternal(f,e.getAbsoluteUrl(d.getQuestionImageUrl(a,b,c)))})},d.prototype.uploadQuestionImage=function(a,b,c,e){var f=this,g=this.getToken();return g.then(function(g){return d.uploadImageInternal(g,f.getAbsoluteUrl(d.getQuestionImageUrl(a,b,c)),c,e)})},d.prototype.deleteFormImage=function(a,b){var c=this,e=this.getToken();return e.then(function(e){return d.deleteImageInternal(e,c.getAbsoluteUrl(d.getFormImageUrl(a,b)))})},d.prototype.uploadFormImage=function(a,b,c){var e=this,f=this.getToken();return f.then(function(f){return d.uploadImageInternal(f,e.getAbsoluteUrl(d.getFormImageUrl(a,b)),b,c)})},d.getFormImageUrl=function(a,b){return d.formImageUrlPattern.format(a,b)},d.getQuestionImageUrl=function(a,b,c){return d.questionImageUrlPattern.format(a,b,c)},d.deleteImageInternal=function(b,c){var e=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Image.DeleteImage);e.start();var f={type:"DELETE",url:c,headers:{Authorization:b?"Bearer "+b:"","X-CorrelationId":e.CorrelationId}},g=function(){return e.end({resultType:"Success"})},h=function(a){var b={correlationId:e.CorrelationId,innerCode:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.code,statusCode:a.status,innerMessage:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.message,statusText:a.statusText};return e.end({resultType:"Failure",extraData:{imageUrl:c,error:b}}),b};return d.sendRequest(f,g,h)},d.uploadImageInternal=function(b,e,f,g){var h=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Image.UploadImage);h.start();var i={type:"PUT",url:e,headers:{Authorization:b?"Bearer "+b:"","Content-Type":g.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format(a.Utilities.Guid.newGuid(),g.ImageName),"X-CorrelationId":h.CorrelationId},processData:!1,data:g.ImageBlob},j=function(a){if(!a||!a.resourceId){var b={correlationId:h.CorrelationId,innerCode:c.ImageUploadFailed,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};return h.end({resultType:"Failure",extraData:{imageUrl:e,error:b,imageType:f}}),$.Deferred().reject(b).promise()}h.end({resultType:"Success",extraData:{imageType:f}});var d={};return d.altText=a.altText,d.contentType=a.contentType,d.fileIdentifier=a.fileIdentifier,d.originalFileName=a.originalFileName,d.resourceId=a.resourceId,d.resourceUrl=a.resourceUrl,d.height=a.height,d.width=a.width,d},k=function(a){var b={correlationId:h.CorrelationId,innerCode:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.code,statusCode:a.status,innerMessage:a.responseJSON&&a.responseJSON.error&&a.responseJSON.error.message,statusText:a.statusText};return h.end({resultType:"Failure",extraData:{imageUrl:i.url,error:b}}),b};return d.sendRequest(i,j,k)},d.sendRequest=function(c,d,e){a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)&&(c.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken);var f=$.ajax(c);return f.then(d,function(f){return b.AuthTokenHelper.getInstance().isAuthTokenExpiredFailure(f)?void b.AuthTokenHelper.getInstance().refreshAuthToken(function(){if(a.Flighting.Flight.isEnabled(a.Flighting.Flights.RefreshServerInfoInFrame)){c.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken;var b=$.ajax(c);return b.then(d,e)}a.PageMethods.refreshAntiForgeryToken(function(){c.headers.__RequestVerificationToken=OfficeFormServerInfo.antiForgeryToken;var a=$.ajax(c);return a.then(d,e)},function(){return Forms.Common.reloadPage()})},function(){a.Authenticator.signInThenRefresh()}):e(f)})},d.prototype.getToken=function(){return this.authContext.getFormApiToken()},d.prototype.getAbsoluteUrl=function(a){return this.serviceUrl+"/"+a},d.formImageUrlPattern="forms('{0}')/{1}",d.questionImageUrlPattern="forms('{0}')/questions('{1}')/{2}",d}();b.ImageProvider=d}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(b){var c;!function(a){a[a.None=0]="None",a[a.SpellChecker=1]="SpellChecker",a[a.AutoSuggest=2]="AutoSuggest",a[a.KeyPhrase=4]="KeyPhrase",a[a.ChoiceQuestionTypeSuggest=256]="ChoiceQuestionTypeSuggest",a[a.SuggestionForm=512]="SuggestionForm",a[a.SuggestionQuestion=2048]="SuggestionQuestion",a[a.OptionsSuggest=4096]="OptionsSuggest",a[a.LikertQuestionTypeSuggest=8192]="LikertQuestionTypeSuggest",a[a.AdoptKeyWord=16384]="AdoptKeyWord"}(c=b.TextAnalyzerFeatures||(b.TextAnalyzerFeatures={}));var d;!function(a){a[a.None=0]="None",a[a.SimilarMathQuestionSuggestions=1]="SimilarMathQuestionSuggestions"}(d=b.MathAnalyzerFeatures||(b.MathAnalyzerFeatures={}));var e;!function(a){a[a.Unknown=0]="Unknown",a[a.Edu=1]="Edu",a[a.Biz=2]="Biz",a[a.MsaFree=4]="MsaFree",a[a.MSIT=8]="MSIT",a[a.MsaPaid=16]="MsaPaid",a[a.FastFood=32]="FastFood"}(e=b.UserType||(b.UserType={})),a.Exports.DataProvider.TextAnalyzerFeatures=c,a.Exports.DataProvider.MathAnalyzerFeatures=d}(c=b.Models||(b.Models={}))}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function c(b,d){return c._instance?c._instance:(c._instance=this,this._serviceUrl=b,this._tokenRetriever=d,a.Utilities.assert(this._serviceUrl,"math service url is null"),void 0)}return c.getInstance=function(a,b){return new c(a,b)},c.prototype.mathFormulaCalculation=function(b){if(!b||!b.Mathml){var c={Aria:"",Responses:[]};return $.Deferred().resolve(c).promise()}var d={Context:b.Context,Formulas:[b.Mathml],InputFormat:"MathML",Locale:navigator.language,Mode:1,OutputFormat:"latex",RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this._serviceUrl+"mathapi/calculation?formId="+b.FormId+"&questionId="+b.QuestionId,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathCalculation})},c.prototype.mathQuestionGeneration=function(b){if(!b.Context){var c={Features:0,Results:[]};return $.Deferred().resolve(c).promise()}var d={Features:b.Features,Input:b.Context,InputFormat:"MathML",Locale:navigator.language,OutputFormat:"latex",RequiredQuestionsCount:b.QuestionCount,RequiredIncorrectAnswerCount:b.IncorrectAnswerCount};return this.sendRequest({data:d,method:"POST",requestUri:this._serviceUrl+"mathapi/questions?formId="+b.FormId+"&questionId="+b.QuestionId,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.MathQuestionGeneration})},c.prototype.textAnalyze=function(a){var c=b.Models.TextAnalyzerFeatures.ChoiceQuestionTypeSuggest;return this.textAnalyzeWithFeatures(c,a)},c.prototype.textAnalyzeWithFeatures=function(b,c){if(!c){var d={Features:0,Results:[]};return $.Deferred().resolve(d).promise()}var e={Features:b,Text:c};return this.sendRequest({requestUri:this._serviceUrl+"textanalysis2",method:"POST",data:e,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Question.TextAnalysis,qosExtraData:{Features:b}})},c.prototype.sendRequest=function(c){return this._tokenRetriever.getToken().then(function(d){return c.headers=$.extend(!0,c.headers,{Accept:"application/json",Authorization:d?"Bearer "+d:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken}),b.OData.send(c).then(function(c){a.Utilities.assert(c,"math calculation result is null");var d=b.OData.ResponseHandler.parseResponseDataValue(c);return a.Utilities.assert(d,"math calculation result parse failure"),d},b.OData.ResponseHandler.parseAndTryHandleError)})},c}();b.MathProvider=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(){return f.getInstance().createDataProvider()}function d(a){return f.getInstance().createDataProvider(e.Group,OfficeFormServerInfo.userInfo.TenantId,a)}var e;!function(a){a[a.Default=0]="Default",a[a.Personal=1]="Personal",a[a.Group=2]="Group",a[a.Me=3]="Me"}(e=b.DataProviderType||(b.DataProviderType={}));var f=function(){function c(){return c.instance?c.instance:(c.instance=this,void(this.environment=a.EnvironmentConfig.getEnvironmentType()))}return c.getInstance=function(){return new c},c.prototype.getOwnerServiceUrl=function(a,b,c){return a===e.Default?this.FormApiServiceUrl:a===e.Me?this.FormApiServiceUrl+"me/":b&&c?this.FormApiServiceUrl+b+(a===e.Group?"/groups/":"/users/")+c+"/":null},c.prototype.createDataProvider=function(a,c,d){if(void 0===a&&(a=e.Default),void 0===c&&(c=null),void 0===d&&(d=null),a===e.Default)return this.defaultDataProvider||(this.defaultDataProvider=new b.FormApi(this.FormApiServiceUrl,this.FormApiServiceUrl)),this.defaultDataProvider;var f=this.getOwnerServiceUrl(a,c,d);return f&&new b.FormApi(this.FormApiServiceUrl,f)},c.prototype.createImageProvider=function(a,c,d){if(void 0===a&&(a=e.Default),void 0===c&&(c=null),void 0===d&&(d=null),a===e.Default)return this.currentImageProvider||(this.currentImageProvider=new b.ImageProvider(this.FormApiServiceUrl)),this.currentImageProvider;var f=this.getOwnerServiceUrl(a,c,d);return f&&new b.ImageProvider(f)},c.prototype.createIntelligenceProvider=function(a,b,c){return new Forms.DataProvider.IntelligenceProvider(this.BaseServiceUrl,this.createDataProvider(),b,c,a===e.Group?"groups":"users")},Object.defineProperty(c.prototype,"CurrentNotificationProvider",{get:function(){return this.currentNotificationProvider||(this.currentNotificationProvider=new b.PushNotificationProvider),this.currentNotificationProvider},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"CurrentMathProvider",{get:function(){return this.currentMathProvider||(this.currentMathProvider=b.MathProvider.getInstance(this.FormMathServiceUrl,this.createDataProvider())),this.currentMathProvider},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"CurrentQtiProvider",{get:function(){return this.currentQtiProvider||(this.currentQtiProvider=b.QtiProvider.getInstance(this.QtiApiServiceUrl,this.createDataProvider())),this.currentQtiProvider},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"FormApiServiceUrl",{get:function(){return this.getServiceUrl(c.formApiEndpointPostfix)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"QtiApiServiceUrl",{get:function(){return this.getServiceUrl(c.qtiApiEndpointPostfix)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"FormMathServiceUrl",{get:function(){return this.getServiceUrl(c.formMathApiEndpointPostfix)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"CollabDBServiceUrl",{get:function(){var b;return b=a.EnvironmentConfig.isOsi()?a.EnvironmentConfig.getEnvironmentType():a.EnvironmentConfig.getEnvironmentTypeForNonOSI(),a.EnvironmentConfig.getCollabDBResourceId(b)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"BaseServiceUrl",{get:function(){if(!a.EnvironmentConfig.isOsi()){var b=a.EnvironmentConfig.getEnvironmentTypeForNonOSI();return"EDog"===b?c.apiEndpointEDog:c.apiEndpointInt}var d;switch(this.environment){case"USDoDProd":d=c.apiEndpointUSDoDProd;break;case"USGovProd":d=c.apiEndpointUSGovProd;break;case"USGovGccProd":d=c.apiEndpointProd;break;case"WWProd":d=c.apiEndpointProd;break;case"EDog":d=c.apiEndpointEDog;break;default:d="Int"===this.environment&&"edog"===a.EnvironmentConfig.getDesiredProvider()?c.apiEndpointEDog:"https://"+window.location.host+"/"}return d},enumerable:!0,configurable:!0}),c.prototype.getServiceUrl=function(a){return this.BaseServiceUrl+a},c.apiEndpointUSDoDProd="https://forms.osi.apps.mil/",c.apiEndpointUSGovProd="https://forms.osi.office365.us/",c.apiEndpointProd="https://forms.office.com/",c.apiEndpointEDog="https://forms.officeppe.com/",c.apiEndpointInt="https://forms.office-int.com/",c.formApiEndpointPostfix="formapi/api/",c.formMathApiEndpointPostfix="formmath/api/",c.qtiApiEndpointPostfix="eduqti/api/",c}();b.ProviderManager=f,b.createDataProvider=c,b.createGroupDataProvider=d}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function a(){this.clients={}}return a.prototype.close=function(a){this.clients[a]&&(this.clients[a].close(),delete this.clients[a])},a.prototype.open=function(a,c,d){if(this.close(a),null==d)throw new Error("PushNotificationProvider.open method: cdbTable should not be null.");return this.clients[a]=new e(b.ProviderManager.getInstance().CollabDBServiceUrl,d.OwnerTenantId,d.OwnerId,d.TableId,d.IsGroupTable),this.clients[a].open(c)},a}();b.PushNotificationProvider=c;var d=function(){function b(b){this.clientId=a.Utilities.Guid.newGuid(),this.clientName=b}return Object.defineProperty(b.prototype,"ClientId",{get:function(){return this.clientId},enumerable:!0,configurable:!0}),b.prototype.log=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];if(a.Utilities.Flight.isDebugMode()||!a.EnvironmentConfig.isOsi()){var e=new Date;console.log("[%s] %s[%s]: %s",e.toTimeString(),this.clientName,this.clientId,b.format.apply(b,c))}},b}(),e=function(c){function d(a,b,d,e,g){var h=c.call(this,"CdbSignalR")||this;return h.disposed=!0,h.hubConnection=null,h.reconnectingCount=0,h.remainingRetryCount=f.MaxRetryCount,h.rtcUrl=(g?f.CDBUrlForGroupsFormat:f.CDBUrlForUsersFormat).format(a.trimEnd("/"),b,d,e),h}return __extends(d,c),d.prototype.close=function(){var a=this;this.log("Closing connection"),this.disposed=!0;var b=function(){4!==a.hubConnection.state&&a.invokeHubMethod(f.UserHubName,f.Leave).always(function(){a.hubConnection.stop(!0,!0),a.log("Connection closed")})};null!=this.hubConnection&&(0===this.hubConnection.state||2===this.hubConnection.state?this.hubConnection.stateChanged(b):b())},d.prototype.open=function(c){var d=this;this.log("Creating connection"),this.createHubConnection(this.rtcUrl),this.log("Initializing connection"),c=_.clone(c),c.onFormUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.TableUpdated,function(a,b){c.onFormUpdated(g.toFormUpdatePayload(b),g.toUserPayload(b._modifiedBy))}),c.onFormElementAdded&&this.onHubEvent(f.TableDefinitionHubName,f.ColumnAdded,function(a,b){"Comments"!==a.propertyName&&"ReleaseDate"!==a.propertyName&&c.onFormElementAdded(g.toFormElementPayload(b),g.toUserPayload(b._modifiedBy))}),c.onFormElementDeleted&&this.onHubEvent(f.TableDefinitionHubName,f.ColumnDeleted,function(a,b){c.onFormElementDeleted(a.propertyName,g.toUserPayload(b._modifiedBy))}),c.onFormElementUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.ColumnUpdated,function(a,b){c.onFormElementUpdated(a.propertyName,g.toFormElementUpdatePayload(b),g.toUserPayload(b._modifiedBy))}),c.onChoiceAdded&&this.onHubEvent(f.TableDefinitionHubName,f.ChoiceAdded,function(a,b){c.onChoiceAdded(a.propertyName,g.toChoicePayload(a,b),g.toUserPayload(b._modifiedBy))}),c.onChoiceDeleted&&this.onHubEvent(f.TableDefinitionHubName,f.ChoiceDeleted,function(a,b){c.onChoiceDeleted(a.propertyName,a.choiceId,g.toUserPayload(b._modifiedBy))}),c.onChoiceUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.ChoiceUpdated,function(a,b){c.onChoiceUpdated(a.propertyName,a.choiceId,g.toChoicePayload(a,b),g.toUserPayload(b._modifiedBy))}),c.onResponseAdded&&this.onHubEvent(f.TableDataHubName,f.RowAdded,function(a,b){c.onResponseAdded(g.toResponsePayload(b))}),c.onResponseDeleted&&this.onHubEvent(f.TableDataHubName,f.RowDeleted,function(a,b){c.onResponseDeleted(Number(a._id),{modifiedBy:g.toUserPayload(b._modifiedBy),modifiedDateTime:new Date(b._modifiedBy.ModifiedDateTime)})}),c.onResponsesAllDeleted&&this.onHubEvent(f.TableDataHubName,f.RowsAllDeleted,function(a,b){c.onResponsesAllDeleted({modifiedBy:g.toUserPayload(b._modifiedBy),modifiedDateTime:new Date(b._modifiedBy.ModifiedDateTime)})}),c.onResponseUpdated&&this.onHubEvent(f.TableDataHubName,f.RowUpdated,function(a,b){c.onResponseUpdated(Number(a._id),g.toResponseUpdatePayload(b))}),c.onCommentAdded&&this.onHubEvent(f.TableDataHubName,f.RelatedRecordAdded,function(a,b,d){g.isCommentPayload(a)&&c.onCommentAdded(Number(a.rowId),g.toCommentPayload(d),{modifiedBy:g.toUserPayload(b.modifiedBy),modifiedDateTime:new Date(b.modifiedDateTime)})}),c.onCommentDeleted&&this.onHubEvent(f.TableDataHubName,f.RelatedRecordDeleted,function(a,b,d){g.isCommentPayload(a)&&c.onCommentDeleted(Number(a.rowId),Number(a.id),{modifiedBy:g.toUserPayload(b.modifiedBy),modifiedDateTime:new Date(b.modifiedDateTime)})}),c.onLocaleResourceAdded&&this.onHubEvent(f.TableDefinitionHubName,f.LocaleResourceAdded,function(a,b){c.onLocaleResourceAdded()}),c.onLocaleResourceUpdated&&this.onHubEvent(f.TableDefinitionHubName,f.LocaleResourceUpdated,function(a,b){c.onLocaleResourceUpdated()}),c.onLocaleResourceDeleted&&this.onHubEvent(f.TableDefinitionHubName,f.LocaleResourceDeleted,function(a,b){c.onLocaleResourceDeleted()}),c.onUserConnected&&this.onHubEvent(f.UserHubName,f.UserConnected,function(a,b){c.onUserConnected(g.toUserPayload(a))}),c.onUserDisconnected&&this.onHubEvent(f.UserHubName,f.UserDisconnected,function(a,b){c.onUserDisconnected(g.toUserPayload(a))});var e=void 0;return this.hubConnection.starting(function(){d.log("connection starting"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionStarting,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB}})}),this.hubConnection.connectionSlow(function(){d.log("connection slow"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionSlow,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB}}),c.onConnectionSlow&&c.onConnectionSlow()}),this.hubConnection.error(function(b){d.log("connection error: {0}",JSON.stringify(b)),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionError,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB,error:b}}),e={errorCause:f.ConnectionType_CDB,errorObject:b},c.onConnectionError&&c.onConnectionError(b)}),this.hubConnection.reconnecting(function(){d.log("connection reconnecting"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionReconnecting,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,
connectionType:f.ConnectionType_CDB}}),c.onConnectionReconnecting&&c.onConnectionReconnecting()}),this.hubConnection.reconnected(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionReconnected,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,connectionType:f.ConnectionType_CDB}}),d.log("connection reconnected"),c.onConnectionReconnected&&c.onConnectionReconnected(void 0)}),this.hubConnection.disconnected(function(){if(d.log("connection disconnected"),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionDisconnected,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,type:e&&e.errorCause,remainingRetryCount:d.remainingRetryCount,lastError:e&&e.errorObject}}),d.remainingRetryCount-->0){d.reconnectingCount++;var g={reconnectingCause:e&&e.errorCause,reconnectingCount:d.reconnectingCount,refreshToken:e&&e.errorObject&&e.errorObject.context&&e.errorObject.context.status===b.ErrorCode.HttpStatusCode.Unauthorized,retryCount:f.MaxRetryCount-d.remainingRetryCount,onSuccess:c.onConnectionReconnected,onError:c.onConnectionFailed};d.startConnection(g).done(function(){e=void 0}).fail(function(a){})}else a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionFailed,extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,errorCause:e&&e.errorCause,lastError:e&&e.errorObject}}),c.onConnectionDisconnected&&c.onConnectionDisconnected()}),(a.Utilities.Flight.isDebugMode()||!a.EnvironmentConfig.isOsi())&&(this.hubConnection.logging=!0,this.hubConnection.received(function(a){d.log("Received message: {0}",JSON.stringify(a))})),this.disposed=!1,this.startConnection({onSuccess:c.onConnectionStarted,onError:c.onConnectionFailed})},d.prototype.createHubConnection=function(a){this.hubConnection=$.hubConnection(a,{useDefaultPath:!1}),this.hubConnection.createHubProxy(f.TableDefinitionHubName),this.hubConnection.createHubProxy(f.TableDataHubName),this.hubConnection.createHubProxy(f.UserHubName)},d.prototype.getHubProxy=function(a){if(null==this.hubConnection)throw Error("Realtime connection has not been created yet.");var b=this.hubConnection.proxies[a.toLocaleLowerCase()];if(null==b)throw Error("Cannot find hub proxy {0}".format(a));return b},d.prototype.handleAuth=function(a){var c=this;return b.ProviderManager.getInstance().createDataProvider().getCdbToken().then(function(a){c.hubConnection.qs={Authorization:a}})},d.prototype.invokeHubMethod=function(b,c){for(var d=this,e=[],f=2;f<arguments.length;f++)e[f-2]=arguments[f];if(this.isHubConnected()){var g=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Connection.InvokeMethod);return g.start(),(h=this.getHubProxy(b)).invoke.apply(h,[c].concat(e)).then(function(a){return g.end({resultType:"Success",extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,methodName:c}}),a},function(a){return g.end({resultType:d.isHubConnected()?"Failure":"ExpectedFailure",extraData:{clientId:d.ClientId,connectionId:d.hubConnection.id,methodName:c,error:JSON.stringify(a,["message","description","source","context","data"])}}),a})}return a.Utilities.Promise.getRejectedPromise(Error("Realtime connection has not been established yet."));var h},d.prototype.isHubConnected=function(){return null!=this.hubConnection&&1===this.hubConnection.state},d.prototype.onHubEvent=function(a,b,c){c&&this.getHubProxy(a).on(b,c)},d.prototype.startConnection=function(b){var c=this;if(this.disposed)return a.Utilities.Promise.getRejectedPromise("Connection disposed");var d=$.Deferred();b.onSuccess&&d.done(function(a){return b.onSuccess(a)}),b.onError&&d.fail(function(a){return b.onError(a)});var e=new a.Event.QosEventDeprecated(a.Event.QosEventNames.ServiceEndpoints.Connection.ConnectToCDB),g=function(){e.end({resultType:"Success",extraData:{clientId:c.ClientId,connectionId:c.hubConnection.id,connectionType:f.ConnectionType_CDB,reconnectingCause:b.reconnectingCause,reconnectingCount:b.reconnectingCount,retryCount:b.retryCount}}),c.log("Realtime connection started"),c.remainingRetryCount=f.MaxRetryCount,c.invokeHubMethod(f.UserHubName,f.Join),c.invokeHubMethod(f.UserHubName,f.GetActiveUsers).then(function(a){d.resolve(a)},function(a){d.reject(a)})},h=function(a){e.end({resultType:"Failure",extraData:{clientId:c.ClientId,connectionId:c.hubConnection.id,connectionType:f.ConnectionType_CDB,reconnectingCause:b.reconnectingCause,reconnectingCount:b.reconnectingCount,retryCount:b.retryCount,connectionError:a.source?JSON.stringify(a,["message","description","source","context","transport"]):void 0,serviceError:a.source?void 0:JSON.stringify(a,["message","statusCode","statusText","innerCode"])}}),d.reject(a)};return e.start(),this.handleAuth(b.refreshToken).then(function(){return c.hubConnection.start().then(g,h)},function(b){h(b),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DataProvider.RealtimeClient.ConnectionFailed,extraData:{clientId:c.ClientId,connectionId:c.hubConnection.id,errorCause:f.ConnectionType_Client,lastError:b}})}),d.promise()},d}(d),f=function(){function a(){}return a.TableDefinitionHubName="TableDefinitionChangeHub",a.TableDataHubName="TableChangeHub",a.UserHubName="TableActivityHub",a.TableUpdated="tableDefinitionUpdated",a.ColumnAdded="columnDefinitionAdded",a.ColumnDeleted="columnDefinitionDeleted",a.ColumnUpdated="columnDefinitionUpdated",a.ChoiceAdded="choiceAdded",a.ChoiceUpdated="choiceUpdated",a.ChoiceDeleted="choiceDeleted",a.RowAdded="rowAdded",a.RowDeleted="rowDeleted",a.RowsAllDeleted="rowsAllDeleted",a.RowUpdated="rowUpdated",a.RelatedRecordAdded="relatedRecordAdded",a.RelatedRecordDeleted="relatedRecordDeleted",a.RelatedRecordUpdated="relatedRecordUpdated",a.LocaleResourceAdded="localeResourceAdded",a.LocaleResourceUpdated="localeResourceUpdated",a.LocaleResourceDeleted="localeResourceDeleted",a.UserConnected="userConnected",a.UserDisconnected="userDisconnected",a.GetActiveUsers="GetActiveUsers",a.Join="Join",a.Leave="Leave",a.MaxRetryCount=5,a.ConnectionType_Client="client",a.ConnectionType_Server="server",a.ConnectionType_CDB="CDB",a.FormsUrlFormat="{0}/forms/{1}/$notifications",a.CDBUrlForUsersFormat="{0}/realtime/beta/{1}/users/{2}/tables/{3}/$notifications",a.CDBUrlForGroupsFormat="{0}/realtime/beta/{1}/groups/{2}/tables/{3}/$notifications",a}(),g=function(){function b(){}return b.toFormUpdatePayload=function(a){return a&&b.normalize({id:void 0,tableId:a.id,title:a.displayName,createdBy:a.createBy,modifiedDate:a.dateTimeLastUpdated,description:a.description,settings:a.formSettings,otherInfo:a.otherInfo,questions:void 0,header:b.toImagePayload(a.header),logo:b.toImagePayload(a.logo),background:b.toImagePayload(a.background),thankYouMessage:a.thankYouMessage,version:a.version,xlWorkbookId:a.xlWorkbookId,xlExportingTag:a.xlExportingTag,xlFileUnSynced:a.xlFileUnSynced,permissionTokens:b.toPermissionTokenPayload(a.permissionTokens)})},b.toFormElementPayload=function(a){return a&&{id:a.propertyName,title:a.description||a.title||a.displayName,defaultValue:a.defaultValue,subtitle:a.subtitle,required:a.required,type:a.questionType,questionInfo:a.questionInfo,order:a.order,version:void 0,modifiedDate:a.questionModifiedDate,status:a.status,image:b.toImagePayload(a.image),isQuiz:a.isQuiz,choices:a.choices,groupId:a.columnGroupName,fileUploadFolderId:a.fileUploadFolderId,questionTagForIntelligence:a.questionTagForIntelligence,isFromSuggestion:a.isFromSuggestion}},b.toChoicePayload=function(a,c){return c&&b.normalize({id:a.choiceId,customProperties:c.customProperties,description:c.description,displayText:c.displayText,key:c.key,order:c.order})},b.toFormElementUpdatePayload=function(a){return b.normalize(b.toFormElementPayload(a))},b.toUserPayload=function(a){return{userId:a.Id||a.userId,displayName:a.DisplayName||a.displayName,firstName:a.FirstName||a.firstName,lastName:a.LastName||a.lastName,email:a.Email||a.email,imageUri:a.ImageUri||a.imageUri}},b.toImagePayload=function(b){return b?null!=b.ResourceId&&null==b.ResourceUrl?void a.Event.ErrorEventDeprecated.logData({errorName:"InvalidCdbImagePayload"}):{altText:b.AltText,contentType:b.ContentType,fileIdentifier:b.FileIdentifier,originalFileName:b.OriginalFileName,resourceId:b.ResourceId,resourceUrl:b.ResourceUrl}:b},b.toPermissionTokenPayload=function(a){if(a){var b=JSON.parse(a);return b.map(function(a){return{principalId:a.PrincipalId,name:a.Name,type:a.Type}})}return a},b.toResponsePayload=function(a){if(null==a)return a;var c=null==a._id?void 0:Number(a._id);return{id:c,startDate:a.StartDate,submitDate:a.SubmitDate,responder:a.Responder,responderName:a.ResponderName,answers:b.toAnswers(a),quizResult:void 0,releaseDate:a.ReleaseDate}},b.toAnswers=function(a){var b=["SubmitDate","ResponderName","Responder","StartDate","Comments_comments","Comments","ReleaseDate"],c=_.difference(Object.keys(a).filter(function(a){return"_"!==a[0]}),b);return JSON.stringify(c.map(function(b){return{questionId:b,answer1:a[b]}}))},b.toResponseUpdatePayload=function(a){var c=b.normalize(b.toResponsePayload(a));return delete c.answers,c},b.isCommentPayload=function(a){return a&&"Comments_comments"===a.propertyName},b.toCommentPayload=function(a){return a&&{id:a.id,feedback:a.text,score:a.number,questionId:a.columnReference,createdDateTime:a.createdDateTime,createdBy:b.toUserPayload(a.createdBy)}},b.normalize=function(a){var b=a;for(var c in b)void 0===b[c]&&delete b[c];return b},b}()}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function c(b,d){return c.instance?c.instance:(c.instance=this,this.qtiServiceUrl=b,this.tokenRetriever=d,a.Utilities.assert(this.qtiServiceUrl,"qti service url is null"),void 0)}return Object.defineProperty(c.prototype,"QtiServiceUrl",{get:function(){return this.qtiServiceUrl},enumerable:!0,configurable:!0}),c.getInstance=function(a,b){return new c(a,b)},c.prototype.generateFormFromQtiFile=function(b){return this.sendRequest({requestUri:this.QtiServiceUrl+"qti",method:"POST",data:b,qosEventName:a.Event.QosEventNames.ServiceEndpoints.Qti.CreateFormFromQti,qosExtraData:{LorCorrelationId:a.SafeStorage.SessionStorage.getItem("LorCorrelationId")}})},c.getCommonHeaders=function(b){return{Accept:"application/json",Authorization:b?"Bearer "+b:"",__RequestVerificationToken:OfficeFormServerInfo.antiForgeryToken,ShareInvitationKey:a.Utilities.Html.getHashes().Token}},c.prototype.sendRequest=function(a,d){return this.tokenRetriever.getToken().then(function(e){return a.headers=$.extend(!0,a.headers,c.getCommonHeaders(e)),b.OData.send(a,d).then(b.OData.ResponseHandler.parseResponseDataValue,b.OData.ResponseHandler.parseAndTryHandleError)})},c}();b.QtiProvider=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return b.getUserInfoInItem=function(b){return b?a.SafeStorage.DefaultStorage.getItem(b):null},b.setUserInfo=function(b,c){b&&a.SafeStorage.DefaultStorage.setItem(b,c)},b}();b.UserProfileProvider=c}(b=a.DataProvider||(a.DataProvider={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(b){return $.when.apply($,b.map(d)).done(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.JsLoad.AllScriptsLoadDone,extraData:{scripts:b}},a.Flighting.Flights.PageInitializationVerboseLogs)}).fail(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.JsLoad.SomeScriptsLoadFailed,extraData:{scripts:b}},a.Flighting.Flights.PageInitializationVerboseLogs)})}function d(a){return l[a]||(l[a]=c(k[a]||[]).then(function(){return e(a)}),"undefined"!=typeof Forms&&Forms.PerformanceAnalysis&&Forms.PerformanceAnalysis.requestWithPromise("script:"+a,l[a])),l[a]}function e(b){var c=$.Deferred(),d=j[b];if(!d)throw Error("No script path for "+b);var e=document.getElementsByTagName("head")[0];if(!e)return c.reject(Error("No head element found!")).promise();var f=document.createElement("script");return f.type="text/javascript",f.async=!0,f.src=d,f.onload=function(){c.resolve(),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.JsLoad.ScriptLoadFailed,extraData:{name:b}},a.Flighting.Flights.PageInitializationVerboseLogs)},f.onerror=function(g){e.removeChild(f),c.reject(Error("Failed to load javascript file: "+d)),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.JsLoad.ScriptLoadFailed,extraData:{name:b,url:d,message:g&&g.message}},a.Flighting.Flights.PageInitializationVerboseLogs)},e.appendChild(f),c.promise()}function f(){var b="//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML",c="../scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML";return a.EnvironmentConfig.isOsi()?c:b}function g(){var b="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.0/katex.min.js",c="../scripts/vendors/katex/katex.min.js";return a.EnvironmentConfig.isOsi()?c:b}function h(a,b){k[a]=b}a.Exports.JavaScriptLoader=b,b.loadJavaScripts=c,b.loadJavaScript=d;var i=OfficeFormServerInfo.scriptSuffix,j=("?v="+OfficeFormServerInfo.version,{"combined-design":"../Scripts/Vendors/combined/design_3fd6ce0.js","combined-response":"../Scripts/Vendors/combined/response_2e6ed61.js",BootStrap:a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseExternalCdn)?"//ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/bootstrap.min.js":"../Scripts/Vendors/bootstrap/3.3.5/bootstrap.min.js",DataTables:"../Scripts/Vendors/DataTables."+i,Chart:"../Scripts/Vendors/Chart-2.6."+i,Clipboard:"../Scripts/Vendors/clipboard-1.7.1.min.js",ColorThief:"../Scripts/Vendors/color-thief/color-thief.min.js",Cropper_Modified:"../Scripts/Vendors/cropper/cropper.modified."+i,D3:"../Scripts/Vendors/d3/d3."+i,FileSave:"../Scripts/Vendors/FileSaver.min.js",Heatmap:"../Scripts/Vendors/highcharts/heatmap.js",HighCharts:"../Scripts/Vendors/highcharts/highcharts.js",HighCharts_More:"../Scripts/Vendors/highcharts/highcharts-more.js",Ivy:"//edera.cloudapp.net/javascripts/api/ivy.js",OfficeBrowserFeedback:"../Scripts/Vendors/officebrowserfeedback/officebrowserfeedback_floodgate.js",JQuery_RateIt:"../Scripts/Vendors/rating-1.1.0/jquery.rateit."+i,JQuery_Picker:"../Scripts/Vendors/pickadate-3.5.6/picker."+i,JQuery_Picker_Date:"../Scripts/Vendors/pickadate-3.5.6/picker.date."+i,JQuery_Picker_Time:"../Scripts/Vendors/pickadate-3.5.6/picker.time."+i,JQuery_QRCode:"../Scripts/Vendors/jquery.qrcode.min.js",Katex:g(),Linkify:"../Scripts/Vendors/linkify/linkify.min.js",Linkify_JQuery:"../Scripts/Vendors/linkify/linkify-jquery.min.js",MathJax:f(),MathQuill:"../Scripts/Vendors/mathquill/mathquill."+i,Pattern_Fill:"../Scripts/Vendors/highcharts/pattern-fill.js",Mark:"../Scripts/Vendors/markjs-8.9.0/mark."+i,SignalR:"../Scripts/Vendors/SignalR/jquery.signalR-2.2.0.min.js",Sortable:"../Scripts/Vendors/sortablejs-1.5.1/Sortable.modified."+i,WordCloud:"../Scripts/Vendors/highcharts/wordcloud.js",Xlsx:"../Scripts/Vendors/xlsx.core.min.js"}),k={};h("JQuery_Picker_Date",["JQuery_Picker"]),h("JQuery_Picker_Time",["JQuery_Picker"]),h("Linkify_JQuery",["Linkify"]),h("WordCloud",["HighCharts"]),h("HighCharts_More",["HighCharts"]),h("Heatmap",["HighCharts"]),h("Pattern_Fill",["HighCharts"]);var l={}}(b=a.JavaScriptLoader||(a.JavaScriptLoader={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){a[a.Default=1]="Default",a[a.OfficeAPI=2]="OfficeAPI",a[a.TeamsAPI=3]="TeamsAPI"}(b=a.PopupNotifyType||(a.PopupNotifyType={}));var c;!function(a){a[a.Default=0]="Default",a[a.OrgId=1]="OrgId",a[a.WindowsLiveId=2]="WindowsLiveId"}(c=a.AuthProvider||(a.AuthProvider={}));var d;!function(a){a[a.OneNote=1]="OneNote",a[a.OneNoteUwp=2]="OneNoteUwp",a[a.Outlook=3]="Outlook",a[a.Teams=4]="Teams",a[a.Excel=5]="Excel",a[a.OneDrive=6]="OneDrive",a[a.Excel_Win32=7]="Excel_Win32",a[a.PowerPoint=8]="PowerPoint",a[a.Assignments=9]="Assignments",a[a.ProjectShimla=10]="ProjectShimla",a[a.Stream=11]="Stream",a[a.StreamMobile=12]="StreamMobile"}(d=a.HostApps||(a.HostApps={}));var e=function(){function b(){}return Object.defineProperty(b,"Host",{get:function(){return b._host||d[b.GetHostString()]},set:function(a){b._host=a},enumerable:!0,configurable:!0}),b.GetHostString=function(){return b._host&&d[b._host]||a.Utilities.Html.getQueries()[b.HostParam]||a.Utilities.Html.getHashes()[b.HostParam]},Object.defineProperty(b,"GroupId",{get:function(){return b._groupId||a.Utilities.Html.getQueries()[b.GroupParam]||a.Utilities.Html.getHashes()[b.GroupParam]},enumerable:!0,configurable:!0}),Object.defineProperty(b,"TenantId",{get:function(){return b._tenantId||a.Utilities.Html.getQueries()[b.TenantParam]||a.Utilities.Html.getHashes()[b.TenantParam]},enumerable:!0,configurable:!0}),b.setGroupInfo=function(a,c,d){void 0===a&&(a=!1),b._showGroupFormOnly=a,b._tenantId=c,b._groupId=d},Object.defineProperty(b,"IsIntegration",{get:function(){var a=b.GetHostString();return a&&d[a]?!0:OfficeFormServerInfo.isOembedSPO?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsTeamsIntegration",{get:function(){return b.Host===d.Teams&&"undefined"!=typeof microsoftTeams},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsTeamsLandingPage",{get:function(){return!!a.Utilities.Html.getQueries()[b.TeamsLandingParam]},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsMiniLandingView",{get:function(){return!!a.Utilities.Html.getQueries()[b.MiniLandingViewParam]},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsAssignmentsIntegration",{get:function(){return b.Host===d.Assignments},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsExternalIntegration",{get:function(){return this.IsTeamsIntegration||this.IsAssignmentsIntegration},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsPPTIntegration",{get:function(){return b.Host===d.PowerPoint},enumerable:!0,configurable:!0}),Object.defineProperty(b,"IsProjectShimlaIntegration",{get:function(){return b.Host===d.ProjectShimla},enumerable:!0,configurable:!0}),b.isDelegateMode=function(){if(null===b._isDelegateMode){var a=window.location.pathname.trimEnd("/").toLowerCase();b._isDelegateMode=a.lastIndexOf(b.DelegatePage)==a.length-b.DelegatePage.length}return b._isDelegateMode},b.setEnvironmentHostAppWithName=function(a){if(!(a in d))throw Error("hostAppName "+a+" doesn't exist.");b.Host=d[a]},b.PopupNotifyTypeParam="popupNotifyType",b.AuthProviderParam="auth_pvr",b.AuthUpnParam="auth_upn",b.ShareToCollabTokenParam="Token",b.HostParam="Host",b.TeamsLandingParam="TeamsLanding",b.MiniLandingViewParam="MiniLandingView",b.GroupParam="groupId",b.TenantParam="tid",b.DelegatePage="delegatepage.aspx",b._isDelegateMode=null,b}();a.EnvironmentSettings=e,a.Exports.EnvironmentSettings=e}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b=function(){function a(){}return a.ENGAGEMENT="engagement_event",a.ERROR="error_event",a.NAVPERF="nav_perf_event",a.QOS="qos_event",a}();a.EventTypes=b}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function b(){}return b.setLogHandler=function(a){this.buffer.setFunctionToCall(a)},b.logData=function(b,c){void 0===c&&(c=!0),a.Flighting.Flight.isEnabled(a.Flighting.Flights.UseRefactoredTelemetry)?Forms.Telemetry.log({eventName:b.name,eventType:"nav_perf_event",extraData:b.extraData}):this.buffer.queue(b,c)},b.buffer=new a.Utilities.Process.BufferForCall,b}();b.NavPerfEventDeprecated=c}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b=function(){function a(){this.Duration=0,this.TimeStamp=0,this.EventCorrelationId="",this.Properties=""}return a}();a.TelemetryProperties=b}(b=a.Telemetry||(a.Telemetry={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(){i.initialize()}function d(){return i&&i.SessionId}function e(){var a=$.Deferred();return i?i.flush(function(){return a.resolve()}):a.resolve(),a.promise()}function f(){var b=a.EnvironmentSettings.GetHostString();if(b)return b;var c=a.Utilities.Html.getQueries().origin;if(c)return c;var d=a.Utilities.Html.getQueries().oembedsso;return d?"Forms WebPart":a.Utilities.Flight.isPPTIntegration()?"PowerPoint":void 0}b.deprecatedInitializeTelemetry=c,b.getCurrentSessionId=d,b.flushLogs=e,b.getOrigin=f;var g;!function(a){a[a.Designer=0]="Designer",a[a.Responder=1]="Responder",a[a.Unknown=2]="Unknown",a[a.AnalyzeViewer=3]="AnalyzeViewer",a[a.TeamsConfigUser=4]="TeamsConfigUser"}(g||(g={}));var h=function(){function c(){this.sessionId=a.Utilities.Guid.newGuid(),this.sessionDbId="",this.sessionDeviceId="",this.initialized=!1}return Object.defineProperty(c.prototype,"SessionId",{get:function(){return this.sessionId},enumerable:!0,configurable:!0}),c.prototype.flush=function(a){this.initialized?AWTLogManager.flush(a):a()},c.prototype.initialize=function(){var b=this;this.msaTenantIdInUpperCase=a.EnvironmentConfig.getMsaTenantId().toUpperCase(),this.userRole=this.getSessionRole(),this.userType=a.DataProvider.Models.UserType.Unknown,a.EnvironmentConfig.isOsi()&&a.DataProvider.FeaturePlanProvider.getUserType().done(function(a){return b.userType=a}).always(function(){var c={disableCookiesUsage:!0};switch(a.EnvironmentConfig.getEnvironmentType()){case"USGovProd":c.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":c.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0"}var d=b.getCollectorToken();AWTLogManager.initialize(d,c),b.initialized=!0,b.logger=AWTLogManager.getLogger(d),a.Event.EngagementEventDeprecated.setLogHandler(b.handleEngagementEvent.bind(b)),a.Event.ErrorEventDeprecated.setLogHandler(b.handleErrorEvent.bind(b)),a.Event.NavPerfEventDeprecated.setLogHandler(b.handleNavPerfEvent.bind(b)),a.Event.QosEventDeprecated.setLogHandler(b.handleQosEvent.bind(b))})},c.prototype.handleEngagementEvent=function(c){var d=new b.TelemetryProperties;d.EventType=a.Event.EventTypes.ENGAGEMENT,d.EventName=(c&&c.name||"no_EngagementName").replace(" ",""),d.EventCorrelationId=a.Utilities.Guid.newGuid(),d.TimeStamp=a.Utilities.DateTime.getTimeStamp(),c&&(d.Properties=JSON.stringify(c.extraData)),this.logEvent(d)},c.prototype.handleErrorEvent=function(c){var d=new b.TelemetryProperties;d.EventType=a.Event.EventTypes.ERROR,d.EventName="no_ErrorName",c&&(d.EventName=c.errorName,d.Properties=JSON.stringify(c.errorInfo||{})),d.EventCorrelationId=a.Utilities.Guid.newGuid(),d.TimeStamp=a.Utilities.DateTime.getTimeStamp(),this.logEvent(d)},c.prototype.handleQosEvent=function(c,d){var e=new b.TelemetryProperties;if(e.EventType=a.Event.EventTypes.QOS,e.TimeStamp=a.Utilities.DateTime.getTimeStamp(),e.EventName="no_QosName",c)if(null!=c.Name&&(e.EventName=c.Name,e.EventName=e.EventName.replace(" ","")),null!=c.CorrelationId&&(e.EventCorrelationId=c.CorrelationId),c.Data&&c.Data.extraData&&(e.Properties=JSON.stringify(c.Data.extraData)),d===a.Event.QosEventType.Start)e.EventName+="."+a.Event.QosEventType[a.Event.QosEventType.Start];else if(d===a.Event.QosEventType.Log)e.EventName+="."+a.Event.QosEventType[a.Event.QosEventType.Log],c.Data.resultCode&&(e.EventName+="."+c.Data.resultCode);else if(d===a.Event.QosEventType.End)switch(c.Data.resultType){case"Success":case"Failure":case"ExpectedFailure":e.EventName+="."+c.Data.resultType}else e.EventName="no_eventData";d===a.Event.QosEventType.End&&(e.Duration=c.Duration),this.logEvent(e)},c.prototype.handleNavPerfEvent=function(c,d){var e=new b.TelemetryProperties;e.EventType=a.Event.EventTypes.NAVPERF,e.EventName=c&&c.name||"no_NavPerfName",e.EventCorrelationId=a.Utilities.Guid.newGuid(),e.TimeStamp=a.Utilities.DateTime.getTimeStamp(),c&&(d&&this.setCommonNavPerfExtraData(c),e.Properties=JSON.stringify(c.extraData)),this.logEvent(e)},c.prototype.enrichSessionInfo=function(b){if(b.Properties){var c=JSON.parse(b.Properties);c&&(this.sessionDbId=c.DbId,this.sessionDeviceId=c.DeviceId)}var d={};d.DbId=this.sessionDbId,d.DeviceId=this.sessionDeviceId,d.BuildVersion=this.getBuildVersion(),d.SessionRing=this.getSessionRing(),d.SessionUrlPath=window.location.origin+window.location.pathname,d.UserAgent=navigator.userAgent,d.IsMobile=a.Utilities.isMobile(),d.Origin=a.Telemetry.getOrigin(),d.JQueryLoaded=!!window.$;var e=a.Event.EngagementEventDeprecated.EVENTNAME_SESSION_START;b.EventType=e,b.EventName=e,b.Duration=0,b.Properties=JSON.stringify(d),b.TimeStamp=a.Utilities.DateTime.getTimeStamp()},c.prototype.logEvent=function(b){b.EventName===a.Event.EngagementEventDeprecated.EVENTNAME_SESSION_START&&this.enrichSessionInfo(b),this.logEventWorker(b)},c.prototype.logEventWorker=function(b){var d=new AWTEventProperties;d.setName(b.EventType),d.setProperty(c.EVENT_NAME_KEY,b.EventName),d.setProperty(c.EVENT_CORRELATION_ID_KEY,b.EventCorrelationId),d.setProperty(c.EVENT_DURATION_KEY,this.getNumberAsString(b.Duration)),d.setProperty(c.EVENT_TIMESTAMP_KEY,this.getNumberAsString(b.TimeStamp)),d.setProperty(c.EVENT_DATA_KEY,b.Properties),b.EventName&&b.EventName.indexOf(a.Event.EngagementEventDeprecated.IntelligenceStatistic)>=0?this.sendSingleTelemetryEventWithoutUserInfo(d):this.sendSingleTelemetryEvent(d)},c.prototype.sendSingleTelemetryEventWithoutUserInfo=function(b){a.Telemetry.getOrigin()!==a.HostApps[a.HostApps.OneNoteUwp]&&(b.setProperty(c.SOURCE_APP_KEY,c.APPLICATION_NAME),b.setProperty(c.USER_ROLE_ID,this.userRole),b.setProperty(c.USER_TYPE_KEY,this.userType),this.logger.logEvent(b))},c.prototype.sendSingleTelemetryEvent=function(b){if(a.Telemetry.getOrigin()!==a.HostApps[a.HostApps.OneNoteUwp]){var d=OfficeFormServerInfo.userInfo.UserId,e=OfficeFormServerInfo.userInfo.TenantId,f=Forms.Common.getCurrentFormId();if(b.setProperty(c.SOURCE_APP_KEY,c.APPLICATION_NAME),b.setProperty(c.USER_ID_KEY,d),b.setProperty(c.USER_TENANT_ID_KEY,e),b.setProperty(c.USER_ROLE_ID,this.userRole),b.setProperty(c.USER_TYPE_KEY,this.userType),b.setProperty(c.FORM_ID_KEY,f),b.setProperty(c.SESSION_ID_KEY,this.sessionId),e)if(e.toUpperCase()===this.msaTenantIdInUpperCase){var g=OfficeFormServerInfo.userInfo.PUID;b.setProperty(c.USERINFO_ID_KEY,g),b.setProperty(c.USERINFO_IDTYPE_KEY,"MSAPUID")}else b.setProperty(c.USERINFO_ID_KEY,d),b.setProperty(c.USERINFO_IDTYPE_KEY,"UserObjectId"),b.setProperty(c.USERINFO_OMSTENANTID_KEY,e);else!d&&a.Flighting.Flight.isEnabled(a.Flighting.Flights.EnableMuidForAnonymousUsers)&&b.setProperty(c.MUID_KEY,a.Muid.Instance.Muid);this.logger.logEvent(b)}},c.prototype.getCollectorToken=function(){var b=a.EnvironmentConfig.getEnvironmentType();switch(b){case"Int":return c.ARIA_INT_TOKEN;case"EDog":return c.ARIA_EDOG_TOKEN;case"WWProd":return a.DataProvider.FeaturePlanProvider.isMsaUser()||Forms.Common.isOwnerMsaUser()?c.ARIA_PROD_RING2_TOKEN:c.ARIA_PROD_TOKEN;case"USGovGccProd":return c.ARIA_GCC_TOKEN;case"USGovProd":return c.ARIA_GCCHigh_TOKEN;case"USDoDProd":return c.ARIA_DoD_TOKEN;default:return c.ARIA_SANDBOX_TOKEN}},c.prototype.getBuildVersion=function(){return OfficeFormServerInfo.version},c.prototype.getSessionRing=function(){var b=a.EnvironmentConfig.getEnvironmentType();switch(b){case"Int":return"Int";case"EDog":return"PreProd";case"WWProd":case"USGovProd":return"Prod";default:return"DevEnv"}},c.prototype.getNumberAsString=function(a){return isNaN(a)||void 0===a||null===a?"0":a.toString()},c.prototype.getSessionRole=function(){var b=a.EnvironmentConfig.getPageType();switch(b){case"Design":return g.Designer;case"Response":return g.Responder;case"Analyze":return g.AnalyzeViewer;case"TeamsConfig":return g.TeamsConfigUser;default:return g.Unknown}},c.prototype.setCommonNavPerfExtraData=function(a){if(a.extraData=a.extraData||{},window.performance){var b=window.performance.timing,c={navigationType:window.performance.navigation.type};c.navigationStart=b.navigationStart,c.unloadEventStart=b.unloadEventStart-b.navigationStart,c.unloadEventEnd=b.unloadEventEnd-b.navigationStart,c.redirectStart=0===b.redirectStart?0:b.redirectStart-b.navigationStart,c.redirectEnd=0===b.redirectEnd?0:b.redirectEnd-b.navigationStart,c.fetchStart=b.fetchStart-b.navigationStart,c.domainLookupStart=b.domainLookupStart-b.navigationStart,c.domainLookupEnd=b.domainLookupEnd-b.navigationStart,c.connectStart=b.connectStart-b.navigationStart,c.connectEnd=b.connectEnd-b.navigationStart,c.requestStart=b.requestStart-b.navigationStart,c.responseStart=b.responseStart-b.navigationStart,c.responseEnd=b.responseEnd-b.navigationStart,c.domLoading=b.domLoading-b.navigationStart,c.domInteractive=b.domInteractive-b.navigationStart,c.domContentLoadedEventStart=b.domContentLoadedEventStart-b.navigationStart,c.domContentLoadedEventEnd=b.domContentLoadedEventEnd-b.navigationStart,c.domComplete=b.domComplete-b.navigationStart,c.loadEventStart=b.loadEventStart-b.navigationStart,c.loadEventEnd=b.loadEventEnd-b.navigationStart,a.extraData.rawTiming=c}},c.APPLICATION_NAME="Office Forms BrowserApp",c.SOURCE_APP_KEY="source_application",c.SESSION_ID_KEY="session_id",c.USER_ID_KEY="user_id",c.USER_TENANT_ID_KEY="user_tenant_id",c.USER_ROLE_ID="user_role",c.USER_TYPE_KEY="user_type",c.FORM_ID_KEY="form_id",c.EVENT_NAME_KEY="event_name",c.EVENT_CORRELATION_ID_KEY="event_correlation_id",c.EVENT_TIMESTAMP_KEY="timestamp",c.EVENT_DURATION_KEY="duration",c.EVENT_DATA_KEY="properties",c.USERINFO_ID_KEY="UserInfo.Id",c.USERINFO_IDTYPE_KEY="UserInfo.IdType",c.USERINFO_OMSTENANTID_KEY="UserInfo.OMSTenantId",c.MUID_KEY="MUID",c.ARIA_SANDBOX_TOKEN="e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917",c.ARIA_INT_TOKEN="79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484",c.ARIA_EDOG_TOKEN="725da52713e94a7f8c04e11418b8378d-67b7892c-33c8-439c-a03e-bd0305e0bc8e-6732",c.ARIA_PROD_TOKEN="2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092",c.ARIA_PROD_RING2_TOKEN="5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406",c.ARIA_GCC_TOKEN="aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984",c.ARIA_GCCHigh_TOKEN="577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823",c.ARIA_DoD_TOKEN="291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725",c}(),i=new h;a.Exports.Telemetry=b}(b=a.Telemetry||(a.Telemetry={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.Referrer,extraData:{referrer:document.referrer&&a.Utilities.Html.getHostName(document.referrer)}});var c=Forms.PerformanceAnalysis;return c.onPageReadyToRender(),a.Utilities.Html.getHashes().Login?($("#hrdIframe")[0].setAttribute("src",a.EnvironmentConfig.getHrdV2Url()),l(),void(window.location.hash="")):void f().done(function(){function c(){e()||k()}function e(){if(!a.DataProvider.AuthTokenHelper.getInstance().redirectWithPatchedRedirectUrl()&&!f()){if(!m())return!1;d()}return!0}function f(){var b=a.Utilities.Html.getQueries()[a.EnvironmentSettings.AuthProviderParam],c=a.Utilities.Html.getQueries()[a.EnvironmentSettings.AuthUpnParam];if(b===a.AuthProvider[a.AuthProvider.OrgId])d(c);else if(b===a.AuthProvider[a.AuthProvider.WindowsLiveId])g(c);else{if(!c)return!1;d(c)}return!0}function k(){a.Event.EngagementEventDeprecated.logSessionStartEvent();var c=[a.Form.Resources.loadLanguageStrings(null),a.Form.Resources.loadUniversalHeaderAndFooter()];$.when.apply($,c).then(function(){for(var c,d,e=a.Form.Resources.UniversalHeaderAndFooter,f=e.getElementsByTagName("cssIncludes")[0].childNodes[1].nodeValue,g=/href=\"([^\"]*?)\"/gi,j=[];null!=(d=g.exec(f));)j.push(d[1]);for(var k,l=e.getElementsByTagName("javascriptIncludes")[0].childNodes[1].nodeValue,m=/src=\"([^\"]*?)\"/gi,n=[];null!=(k=m.exec(l));)n.push(k[1]);c=n.map(function(a){return h(a,"javascript");
}).concat(j.map(function(a){return h(a,"css")})),$.when.apply($,c).done(function(){$(document).ready(function(){$("#content-loading").hide();var c=a.Form.Resources.UniversalHeaderAndFooter,d=c.getElementsByTagName("headerHtml")[0].childNodes[1].nodeValue,e=c.getElementsByTagName("footerHtml")[0].childNodes[1].nodeValue;$("#content-root").before(d),$("#content-root").after(e),$("#meControl").attr({tabindex:0,role:"button"}),$("#meControl").bind("click",function(){return i()}),$("#meControl").bind("keydown",function(b){b.keyCode===a.KeyCode.Enter&&i()}),$("#content-root").show(),$("#landing-content").show(),$("#landing-content").css("background","none"),ReactDOM.render(b.createLandingPage({}),document.getElementById("landing-content")),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.LandingView.Navigate}),window.performance&&a.Event.NavPerfEventDeprecated.logData({name:a.Event.NavPerfEventNames.Scenario.Endpoints.DefaultPage,extraData:{timeToSpin:window.performance.timing.domInteractive-window.performance.timing.navigationStart,timeToContentReady:a.Utilities.DateTime.getTimeStamp()-window.performance.timing.navigationStart}})})})})}function l(){var b=a.Utilities.Html.getQueries().redirecturl;return b&&b.toLowerCase().indexOf("popuploginpage.aspx")>=0}function m(){var b=a.Utilities.Html.getQueries().redirecturl;if(b){var c=a.Utilities.Html.getQueries(a.Utilities.Html.getSearchString(b).substring(1)).fragment;return!!a.Utilities.Html.getQueries(c)[a.EnvironmentSettings.ShareToCollabTokenParam]}return!1}return a.EnvironmentSettings.IsProjectShimlaIntegration?void j():void(a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?a.EnvironmentConfig.isSovereignProd()?c():a.EnvironmentSettings.IsIntegration?a.Authenticator.detectUserLoggedInAAD(function(){l()?setTimeout(d):d()},c):f()||a.DataProvider.AuthTokenHelper.getInstance().detectUserLoggedIn().done(function(b){b===a.DataProvider.AuthProvider.Msa?g():j()}).fail(c):k())})}function d(b){void 0===b&&(b=null);var c=OfficeFormServerInfo.signInLink,d=a.Utilities.Html.getQueries().redirecturl;if(!d||a.Flighting.Flight.isEnabled(a.Flighting.Flights.DisableOpenRedirection)&&a.Utilities.Html.getHostName(d).toLowerCase()!==window.location.host.toLowerCase()||(d+=window.location.hash,c=a.Utilities.Html.updateUrlParam(c,"state",encodeURIComponent(d))),b)c=a.Utilities.Html.updateUrlParam(c,"login_hint",b);else{var e=a.Authenticator.getUserAccountNameFromStorage();e&&(c=a.Utilities.Html.updateUrlParam(c,"login_hint",e))}Forms.Common.redirectTo(c)}function e(){var a="/Pages/DesignPage.aspx"+window.location.search+window.location.hash;Forms.Common.redirectTo(a)}function f(){return a.Authenticator.handleDetectUserLoggedInAADCallback()?$.Deferred().promise():a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?$.Deferred().resolve().promise():a.Authenticator.handleAuth().then(function(b){if(b.HasUserSignedIn){var c=window.parent!==window&&window.parent.AuthenticationContext();return c||e(),$.Deferred().reject().promise()}if(b.UserSignedInBefore)return e(),$.Deferred().promise();var d=$.Deferred(),f=a.SafeStorage.DefaultStorage,g="officeforms.defaultpage.detectaadlogin";return a.Authenticator.detectUserLoggedInAAD(function(){f.setItem(g,"Success"),e()},function(){f.setItem(g,"Failure"),d.resolve()}),d.promise()})}function g(b){if(void 0===b&&(b=null),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.LandingView.MsaSignIn}),a.EnvironmentConfig.isOsi()){var c=OfficeFormServerInfo.signInLinkMsa;if(b)c=a.Utilities.Html.updateUrlParam(c,"username",b);else{var d=a.Authenticator.getUserAccountNameFromStorage();d&&(c=a.Utilities.Html.updateUrlParam(c,"username",d))}Forms.Common.redirectTo(c)}else{var e=window.location.href;e=a.Utilities.Html.updateUrlParam(e,"msa","true"),Forms.Common.redirectTo(e)}}function h(a,b){var c=$.Deferred(),d=document.getElementsByTagName("head")[0];if(!d)return c.reject(Error("No head element found!")).promise();var e;if("css"===b){var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.href=a,e=f}else if("javascript"===b){var g=document.createElement("script");g.type="text/javascript",g.async=!0,g.src=a,e=g}return e.onload=function(){c.resolve()},e.onerror=function(f){d.removeChild(e),c.reject(Error("Failed to load"+b+" file: "+a))},d.appendChild(e),c.promise()}function i(){return a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.LandingView.GetStartedSignIn}),a.EnvironmentSettings.IsTeamsLandingPage?void(microsoftTeams.initialize&&(microsoftTeams.initialize(),a.Form.AddinAuth.teamsPopupSignIn().done(function(){if(a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth))d();else{var b=a.Utilities.Html.getQueries().redirecturl;b&&Forms.Common.redirectTo(b)}}))):a.EnvironmentSettings.IsIntegration?void(a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?d():e()):($("#hrdIframe")[0].setAttribute("src",a.EnvironmentConfig.getHrdV2Url()),void l())}function j(b){void 0===b&&(b=null),a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?d(b):e()}function k(){if(a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.LandingView.MsaSignUp}),a.EnvironmentConfig.isOsi()){var b=OfficeFormServerInfo.signUpLinkMsa;a.Utilities.Html.updateUrlParam(b,"cp","2"),a.Utilities.Html.updateUrlParam(b,"lw","1"),a.Utilities.Html.updateUrlParam(b,"fl","easi2"),Forms.Common.redirectTo(b)}else{var c=window.location.href;c=a.Utilities.Html.updateUrlParam(c,"msa","true"),Forms.Common.redirectTo(c)}}function l(){var b=window.setTimeout(function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.EmailHrd.LoadFailed}),a.Flighting.Flight.isEnabled(a.Flighting.Flights.EmailHrdFallback)&&g()},5e3);window.addEventListener("message",function(c){if(c.origin==="https://"+a.EnvironmentConfig.getHrdV2Domain()){var d=JSON.parse(c.data);if(d)if("OnReady"===d.op)window.clearTimeout(b),$("#content-root").hide(),$("#headerArea").hide(),$("#footerArea").hide(),$("#hrdIframe").show(),a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.EmailHrd.Loaded});else if("ShowNext"===d.op){var e=d.nextScreen,f=d.emailAddress;a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.EmailHrd.NextScreen,extraData:{NextScreen:e}}),a.Authenticator.setUserAccountNameToStorage(encodeURIComponent(f)),"0"===e?k():"1"===e?g(f):"2"===e?j(f):(a.Event.ErrorEventDeprecated.logData({errorName:"EmailHrdUnexpectedNextScreen"}),j(f))}}})}a.Exports.DefaultPage=b,b.initializePage=c,b.redirectToCookieSignInLink=d,b.redirectToDesignPage=e,b.addHrdIframeListener=l}(b=a.DefaultPage||(a.DefaultPage={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){function b(a,b,c){c&&c.stack&&console.log(c.stack);try{if(window.onerror){var d=ReactDOM.findDOMNode(a),e=d&&d.getAttribute("data-reactId")||"",f="Exception in "+a.constructor.name+"["+e+"]:"+b+".";c.message&&(f+=" Message: "+c.message),window.onerror(f,"",0,0,c)}}catch(c){}}function c(a){e.forEach(function(c){var d=a[c];d&&(a[c]=function(){try{return d.apply(a,arguments)}catch(e){return b(a,c,e),null}})})}var d=function(a){function b(b){var d=a.call(this,b)||this;return d.state={},c(d),d}return __extends(b,a),b}(React.Component);a.ReactComponent=d;var e=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"]}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(f,__assign({},a))}function d(a){var b;b=_.clone(a)||{},b.children=a.Text;var d=b.HTMLAttributes&&b.HTMLAttributes.title;return!d&&a.Text&&(b.HTMLAttributes=_.clone(b.HTMLAttributes)||{},b.HTMLAttributes.title=a.Text),c(b)}var e;!function(a){a[a.None=0]="None",a[a.LightBackground=1]="LightBackground",a[a.DarkBackGround=2]="DarkBackGround"}(e=b.ButtonStyle||(b.ButtonStyle={})),b.createButton=c;var f=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.render=function(){var b=_.extend({},this.props.HTMLAttributes);switch(b.className=a.Utilities.Html.combineAttributes(b.className,"button-control"),b["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(b.className=a.Utilities.Html.combineAttributes(b.className,"active")),this.props.ButtonStyle){case e.LightBackground:case"LightBackground":b.className=a.Utilities.Html.combineAttributes(b.className,"light-background-button");break;case e.DarkBackGround:case"DarkBackGround":b.className=a.Utilities.Html.combineAttributes(b.className,"dark-background-button");break;case e.None:case"None":}return React.createElement("button",__assign({},b),React.createElement("div",{className:"button-content"},this.props.children))},c.prototype.focus=function(){var a=ReactDOM.findDOMNode(this);a.focus()},c.prototype.setTabIndex=function(a){var b=ReactDOM.findDOMNode(this);b.setAttribute("tabIndex",a.toString())},c}(a.ReactComponent);b.Button=f,b.createTextButton=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createFontIconControl=c;var d=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.render=function(){var b=_.clone(this.props.HTMLAttributes)||{};return b.className=a.Utilities.Html.combineAttributes("ms-Icon",this.props.IconName?"ms-Icon--"+this.props.IconName:"",b.className),this.props.Accessible||(b.role="presentation",b["aria-hidden"]="true"),React.createElement("i",__assign({},b))},c}(a.ReactComponent);b.FontIconControl=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}return __extends(c,b),c.prototype.render=function(){var b=_.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(b.className=a.Utilities.Html.combineAttributes(b.className,this.props.ValidationStyle)),this.props.Hidden&&(b.style=b.style||{},b.style.display="none"),(c=React.DOM).div.apply(c,[b].concat(this.createReactNodes()));var c},c.prototype.createReactNodes=function(){throw Error("to be overridden.")},c}(a.ReactComponent);b.ControlBase=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(c){var f=_.clone(c)||{};switch(f.HTMLAttributes=_.clone(f.HTMLAttributes)||{},c.GlyphButtonStyle){case d.Vertical:case"Vertical":f.HTMLAttributes.className=a.Utilities.Html.combineAttributes(f.HTMLAttributes.className,"glyph-button-control-vertical");break;case d.GlyphOnly:case"GlyphOnly":case d.Horizontal:case"Horizontal":default:f.HTMLAttributes.className=a.Utilities.Html.combineAttributes(f.HTMLAttributes.className,"glyph-button-control-horizontal")}!f.HTMLAttributes.title&&c.Text&&(f.HTMLAttributes.title=c.Text),!f.HTMLAttributes["aria-label"]&&c.Text&&(f.HTMLAttributes["aria-label"]=c.Text);var g;if(c.Icon){var h={HTMLAttributes:{className:c.IconClassName},IconName:c.Icon,key:"icon"};g=React.createElement(b.FontIconControl,__assign({},h))}f.ButtonStyle=c.ButtonStyle;var i;switch("GlyphOnly"!==c.GlyphButtonStyle&&c.GlyphButtonStyle!==d.GlyphOnly&&(i=React.DOM.span({className:c.TextClassName,key:"text"},c.Text)),c.GlyphLocation){case e.Right:f.children=[i,c.children,g];break;case e.Left:default:f.children=[g,i,c.children]}return b.createButton(f)}var d;!function(a){a[a.Horizontal=0]="Horizontal",a[a.Vertical=1]="Vertical",a[a.GlyphOnly=2]="GlyphOnly"}(d=b.GlyphButtonStyle||(b.GlyphButtonStyle={}));var e;!function(a){a[a.Left=0]="Left",a[a.Right=1]="Right"}(e=b.GlyphLocation||(b.GlyphLocation={})),b.createGlyphButton=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=function(){function a(){}return Object.defineProperty(a,"None",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Success",{get:function(){return"has-success"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Warning",{get:function(){return"has-warning"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"Error",{get:function(){return"has-error"},enumerable:!0,configurable:!0}),a}();b.ValidationStyles=c;var d=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return __extends(b,a),b.prototype.render=function(){return React.DOM.span({className:"required-star"})},b}(a.ReactComponent);b.RequiredStar=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){function b(a){var b=d(a);return e(b)}function c(a){return f.openingTags.forEach(function(b){a=a.replaceAll(b,"")}),f.closingTags.forEach(function(b){a=a.replaceAll(b,"")}),a}function d(a){var b=_.escape(a);return f.tagNames.forEach(function(a,c){b=b.replaceAll(f.encodedOpeningTags[c],f.openingTags[c]).replaceAll(f.encodedClosingTags[c],f.closingTags[c])}),b}function e(a){var b=document.createElement("span");return b.innerHTML=a,a=b.innerHTML}var f=function(){function a(){}return a.tagNames=["strong","em","u","sup","sub"],a.openingTags=_.map(a.tagNames,function(a){return"<"+a+">"}),a.closingTags=_.map(a.tagNames,function(a){return"</"+a+">"}),a.encodedOpeningTags=_.map(a.tagNames,function(a){return"&lt;"+a+"&gt;"}),a.encodedClosingTags=_.map(a.tagNames,function(a){return"&lt;/"+a+"&gt;"}),a}();a.SupportedTags=f,a.keepOnlyRichTextHtml=b,a.stripSupportedTagsButLeaveDangerousOnes=c,a.escapeHtmlWhilePreservingSupportedTags=d}(b=a.RichTextUtil||(a.RichTextUtil={}))}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(d,__assign({},a))}b.createRichTextControl=c;var d=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return __extends(c,a),c.prototype.render=function(){var a=this.props,c=b.RichTextUtil.keepOnlyRichTextHtml(a.Html);return React.createElement("span",{dangerouslySetInnerHTML:{__html:c}})},c}(a.ReactComponent);b.RichTextControl=d}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(e,__assign({},a))}var d;!function(a){a[a.PlainText=0]="PlainText",a[a.RichText=1]="RichText"}(d=b.UserTextRenderMode||(b.UserTextRenderMode={})),b.createUserTextRenderer=c;var e=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}return __extends(c,a),c.prototype.render=function(){var a=this.props.RenderMode||d.PlainText;return a===d.RichText?React.createElement(b.RichTextControl,{Html:this.props.Text}):React.createElement("span",null,this.props.Text)},c}(a.ReactComponent);b.UserTextRenderer=e}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){function b(a){return React.createElement(c,a)}a.createLabel=b;var c=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;return a.alerting=!1,a}return __extends(c,b),c.prototype.componentDidMount=function(){var a=this;this.alerting||window.setTimeout(function(){a.alerting=!0,a.forceUpdate()})},c.prototype.createReactNodes=function(){var b=this.props,c=b.ShowRequiredStar?React.createElement(a.RequiredStar):void 0,d=b.ShowOrdinal?React.DOM.span({className:"ordinal-number",key:"ordinalNumber"},this.props.Ordinal+"."):void 0;if(!b.Alert||this.alerting)var e=a.createUserTextRenderer({Text:b.Label,RenderMode:a.UserTextRenderMode.RichText});return b.Bold?[React.DOM.b(void 0,d,e,c),b.children]:[d,e,c,b.children]},c}(a.ControlBase);a.Label=c}(b=a.Control||(a.Control={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){function c(a){return React.createElement(f,a)}b.createLandingPage=c;var d;!function(a){a[a.Left=0]="Left",a[a.Right=1]="Right"}(d||(d={}));var e;!function(a){a[a.Small=0]="Small",a[a.Middle=1]="Middle",a[a.Large=2]="Large"}(e||(e={}));var f=function(c){function d(a){var b=c.call(this,a)||this;b.updateScreenSizeClassCallback=function(){return b.updateScreenSizeClass()},b.middleScreenSize=1088,b.smallScreenSize=684;var d=b.getScreenSize();return b.state={SlideIndex:0,ShowFormBrand:!1,ScreenSize:d},b}return __extends(d,c),d.prototype.componentWillMount=function(){if(a.EnvironmentSettings.IsTeamsLandingPage){var b=document.createElement("script");b.src="https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js",document.body.appendChild(b)}window.addEventListener("resize",this.updateScreenSizeClassCallback)},d.prototype.componentDidMount=function(){var a=this;$(window).bind("scroll",function(){a.changeBrand()})},d.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateScreenSizeClassCallback)},d.prototype.render=function(){var b="landing-page-container";return a.EnvironmentSettings.IsMiniLandingView?(b=a.Utilities.Html.combineAttributes(b,"trimmed-view"),React.DOM.div({className:b},this.createOverViewSection())):React.DOM.div({className:b},this.createHeadBar(),this.createOverViewSection(),this.createSlideSection(),this.createFeatureSection(),this.createOffice365Section(),this.createMoreAppsSection())},d.prototype.createHeadBar=function(){var b,c=this.state.ShowFormBrand;this.state.ScreenSize!==e.Small&&(b=a.Control.createButton({HTMLAttributes:{className:"landing-headbar-app-title",title:a.Form.Resources.LocalizedStrings.HeaderBar_AppTitle,onClick:function(){return Forms.Common.redirectTo("../")}},children:[a.Control.createFontIconControl({HTMLAttributes:{className:"headbar-icon forms-icon-size26x26",alt:a.Form.Resources.LocalizedStrings.HeaderBar_AppTitle},IconName:"OfficeFormsLogo",key:"icon"}),React.DOM.div({className:"headbar-text",key:"text"},a.Form.Resources.LocalizedStrings.HeaderBar_AppTitle)]}));var d=React.DOM.div({className:"landing-headbar-left-content"},b),f=React.DOM.div({className:"landing-headbar-right-content"},c?this.createGetStartedButton("landing-headbar-button",a.Form.Resources.LocalizedStrings.LandingPage_GetStartedWithForm_Button,a.Event.EngagementEventNames.DefaultPage.LandingView.GetStartedHeaderBar):void 0);return React.DOM.div({className:c?"landing-headbar-container border-bottom":"landing-headbar-container",role:c?"navigation":void 0},d,f)},d.prototype.createOverViewSection=function(){var b;return a.EnvironmentSettings.IsMiniLandingView||(b=a.Control.createGlyphButton({HTMLAttributes:{className:"landing-overview-scroll-down-button",onClick:function(){var a=$(".landing-overview-container").height()+$("#headerArea").height()-$(".landing-headbar-container").height();$("html,body").animate({scrollTop:a+"px"},500)}},Icon:"ChevronDown",IconClassName:"landing-scroll-down-icon forms-icon-size32x32",GlyphButtonStyle:a.Control.GlyphButtonStyle.GlyphOnly,Text:a.Form.Resources.LocalizedStrings.QuestionCategory_More})),React.DOM.div({className:"landing-overview-container"},React.DOM.div({className:"landing-overview-content"},React.DOM.div({className:"landing-overview-div"},React.DOM.div({className:"landing-overview-product-name"},a.Form.Resources.LocalizedStrings.Page_Title),React.DOM.div({className:"landing-overview-product-introduction"},a.Form.Resources.LocalizedStrings.LandingPage_Form_Introduction),React.DOM.div({className:"landing-overview-button-container"},this.createGetStartedButton("landing-overview-button",a.Form.Resources.LocalizedStrings.DefaultPage_GetStarted,a.Event.EngagementEventNames.DefaultPage.LandingView.GetStarted),a.Utilities.Flight.isMsaLoginEnabled()?this.createMSASignInButton():void 0)),b))},d.prototype.createSlideSection=function(){var b=React.DOM.div({className:"landing-slide-title"},React.DOM.div({className:"landing-slide-item-container"},this.createSlideTitle(a.Form.Resources.LocalizedStrings.LandingPage_Category_Home,"CoffeeScript",a.Form.Resources.LocalizedStrings.LandingPage_Category_Home_AltText,0,"forms-icon-size36x36"),this.createSlideTitle(a.Form.Resources.LocalizedStrings.LandingPage_Category_Education,"Education",a.Form.Resources.LocalizedStrings.LandingPage_Category_Education_AltText,1,"forms-icon-size40x40"),this.createSlideTitle(a.Form.Resources.LocalizedStrings.LandingPage_Category_Business,"Work",a.Form.Resources.LocalizedStrings.LandingPage_Category_Business_AltText,2,"forms-icon-size36x36")));return React.DOM.div({className:"landing-slide-container"},b)},d.prototype.createFeatureSection=function(){var b=this.createFeatureIntroduction(a.Form.Resources.LocalizedStrings.LandingPage_Function_Surveys,a.Form.Resources.LocalizedStrings.LandingPage_Function_Surveys_Description1,a.Form.Resources.LocalizedStrings.LandingPage_Function_Surveys_Description2,a.Form.Resources.LocalizedStrings.LandingPage_Function_Surveys_AltText,"../Images/Landing/Surveys.png",!0),c=this.createFeatureIntroduction(a.Form.Resources.LocalizedStrings.LandingPage_Function_Quizzes,a.Form.Resources.LocalizedStrings.LandingPage_Function_Quizzes_Description1,a.Form.Resources.LocalizedStrings.LandingPage_Function_Quizzes_Description2,a.Form.Resources.LocalizedStrings.LandingPage_Function_Quizzes_AltText,"../Images/Landing/Quizzes.png",!1),d=this.createFeatureIntroduction(a.Form.Resources.LocalizedStrings.LandingPage_Function_Polls,a.Form.Resources.LocalizedStrings.LandingPage_Function_Polls_Description1,a.Form.Resources.LocalizedStrings.LandingPage_Function_Polls_Description2,a.Form.Resources.LocalizedStrings.LandingPage_Function_Polls_AltText,"../Images/Landing/Polls.png",!0),e=this.createFeatureIntroduction(a.Form.Resources.LocalizedStrings.LandingPage_Function_Analysis,a.Form.Resources.LocalizedStrings.LandingPage_Function_Analysis_Description1,a.Form.Resources.LocalizedStrings.LandingPage_Function_Analysis_Description2,a.Form.Resources.LocalizedStrings.LandingPage_Function_Analysis_AltText,"../Images/Landing/Excel.png",!1);return React.DOM.div({className:"landing-feature-container"},b,c,d,e)},d.prototype.createOffice365Section=function(){var b=React.DOM.a({className:"landing-herf-link",href:"https://products.office.com/compare-all-microsoft-office-products?tab=1",target:"_blank",onClick:function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.LandingView.Office365})}},a.Form.Resources.LocalizedStrings.LandingPage_Office_365_Description2,a.Control.createFontIconControl({IconName:"ChevronRight"})),c=React.DOM.div({className:"landing-feature-subcontent text"},React.DOM.div({className:"landing-feature-description"},React.DOM.div({className:"landing-feature-title"},a.Form.Resources.LocalizedStrings.LandingPage_Office_365),React.DOM.div({className:"landing-feature-subtitle"},a.Form.Resources.LocalizedStrings.LandingPage_Office_365_Description1),b,this.createGetStartedButton("landing-headbar-button",a.Form.Resources.LocalizedStrings.LandingPage_GetStartedWithForm_Button,a.Event.EngagementEventNames.DefaultPage.LandingView.GetStartedWithForm)));return React.DOM.div({className:"landing-office-365"},React.DOM.div({className:"landing-feature-item"},c))},d.prototype.createMoreAppsSection=function(){var b=React.DOM.img({className:"landing-app-image",src:this.state.ScreenSize===e.Large?"../Images/Landing/app_builder_logos.png":"../Images/Landing/app_builder_logos_h69px.png",title:a.Form.Resources.LocalizedStrings.LandingPage_More_Apps_AltText,alt:a.Form.Resources.LocalizedStrings.LandingPage_More_Apps_AltText}),c=React.DOM.div({className:"landing-feature-subcontent"},React.DOM.div({className:"landing-app-builder-description"},React.DOM.div({className:"landing-feature-title"},a.Form.Resources.LocalizedStrings.LandingPage_More_Apps),React.DOM.div({className:"landing-feature-subtitle"},a.Form.Resources.LocalizedStrings.LandingPage_More_Apps_Description1),React.DOM.a({className:"landing-herf-link",href:"https://go.microsoft.com/fwlink/?linkid=851294",target:"_blank",onClick:function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.LandingView.PowerApps})}},a.Form.Resources.LocalizedStrings.LandingPage_More_Apps_Description2,a.Control.createFontIconControl({IconName:"ChevronRight"})),this.state.ScreenSize===e.Small?b:void 0));return React.DOM.div({className:"landing-app-builder"},React.DOM.div({className:"landing-app-builder-border"},this.state.ScreenSize===e.Small?void 0:React.DOM.div({className:"landing-feature-subcontent"},b),c))},d.prototype.createFeatureIntroduction=function(a,b,c,d,f,g){var h=React.DOM.div({className:"landing-feature-subcontent text"},React.DOM.div({className:"landing-feature-description"},React.DOM.div({className:"landing-feature-title"},a),React.DOM.div({className:"landing-feature-subtitle"},b),React.DOM.div({className:"landing-feature-subtitle"},c))),i=React.DOM.div({className:"landing-feature-subcontent image"},React.DOM.img({className:"landing-feature-image",src:f,title:d,alt:d}));return this.state.ScreenSize===e.Small?React.DOM.div({className:"landing-feature-item"},h,i):React.DOM.div({className:"landing-feature-item"},g?h:i,g?i:h)},d.prototype.createGetStartedButton=function(c,d,e){return a.Control.createTextButton({HTMLAttributes:{className:c,onClick:function(){return a.Event.EngagementEventDeprecated.logData({name:e}),a.EnvironmentSettings.IsTeamsLandingPage?void(microsoftTeams.initialize&&(microsoftTeams.initialize(),a.Form.AddinAuth.teamsPopupSignIn().done(function(){if(a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth))b.redirectToCookieSignInLink();else{var c=a.Utilities.Html.getQueries().redirecturl;c&&Forms.Common.redirectTo(c)}}))):a.EnvironmentSettings.IsIntegration?void(a.Flighting.Flight.isEnabled(a.Flighting.Flights.CookieAuth)?b.redirectToCookieSignInLink():b.redirectToDesignPage()):($("#hrdIframe")[0].setAttribute("src",a.EnvironmentConfig.getHrdV2Url()),void b.addHrdIframeListener())}},Text:d})},d.prototype.createMSASignInButton=function(){return a.EnvironmentConfig.isOsi()?a.Control.createTextButton({HTMLAttributes:{className:"landing-mas-button",onClick:function(){a.Event.EngagementEventDeprecated.logData({name:a.Event.EngagementEventNames.DefaultPage.LandingView.MsaSignIn});var b=OfficeFormServerInfo.signInLinkMsa,c=a.Authenticator.getUserAccountNameFromStorage();c&&(b=a.Utilities.Html.updateUrlParam(b,"username",c)),Forms.Common.redirectTo(b)}},Text:"MSA sign in"}):a.Control.createLabel({HTMLAttributes:{style:{color:"red"}},Label:"MSA sign in / sign up flow is not supported in current environment."})},d.prototype.createSlideTitle=function(b,c,d,e,f){var g=React.DOM.div({className:"landing-category-item"},a.Control.createFontIconControl({HTMLAttributes:{className:f,title:d,alt:d},IconName:c}),React.DOM.div({className:"landing-slide-category-text"},b));return React.DOM.div({className:"landing-slide-item"},g)},d.prototype.changeBrand=function(){var a=$(".landing-overview-container").height()+$("#headerArea").height()-$(".landing-headbar-container").height(),b=document.body.scrollTop||document.documentElement.scrollTop;b>=a?(this.setState({ShowFormBrand:!0}),this.state.ScreenSize===e.Small&&$(".landing-headbar-right-content").css("position","static")):this.setState({ShowFormBrand:!1})},d.prototype.updateScreenSizeClass=function(){var a=this.getScreenSize();a!==this.state.ScreenSize&&(this.setState({ScreenSize:a}),this.changeBrand(),this.state.ShowFormBrand&&this.state.ScreenSize===e.Small?$(".landing-headbar-right-content").css("position","static"):$(".landing-headbar-right-content").css("position","absolute"))},d.prototype.getScreenSize=function(){var a;return a=$(window).width()<=this.smallScreenSize?e.Small:$(window).width()<=this.middleScreenSize?e.Middle:e.Large},d}(a.ReactComponent)}(b=a.DefaultPage||(a.DefaultPage={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c;!function(a){a[a.Unknown=0]="Unknown",a[a.MSAccount=1]="MSAccount",a[a.MSAccountNonEmail=2]="MSAccountNonEmail",a[a.MSAccountNotInWhiteList=3]="MSAccountNotInWhiteList",a[a.OrgId=4]="OrgId",a[a.Both=5]="Both",a[a.Neither=6]="Neither"}(c=b.IdentityProviderType||(b.IdentityProviderType={}));var d=function(){function b(){}return b.getAccountProviderType=function(d){if(b.accountTypeDeferred)return b.accountTypeDeferred.promise();var e,f=b.accountTypeDeferred=$.Deferred(),g=function(h){if(0>=h)return b.accountTypeDeferred=null,f.reject().promise();var i=a.DataProvider.ProviderManager.getInstance().createDataProvider();return i.getIdentityProviderType(d).done(function(a){return b.accountTypeDeferred=null,f.resolve(c[a])}).fail(function(a){b.accountTypeDeferred=null,e=a,g(h-1)}),f.promise()};return g(3)},b}();b.SignHelper=d}(b=a.DefaultPage||(a.DefaultPage={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){var c=window.onerror;window.onerror=function(b,d,e,f,g){a.Utilities.OEmbed.notifyFormErrorToParentWindow(g),a.Event.ErrorEventDeprecated.logData({errorName:"UnhandleException",errorInfo:{message:b,fileName:d,lineNo:e,columnNo:f,stack:g&&g.stack}}),c&&c.apply(this,arguments)}}(b=a.Telemetry||(a.Telemetry={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(b){a.Exports.Event=b}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={}));var OfficeForm;!function(a){var b;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){}return a.DefaultPage="Endpoint.DefaultPage",a.DesignPagePortalView="Endpoint.DesignPagePortalView",a.ResponsePage="Endpoint.ResponsePage",a.SurveyAnalyzePage="Endpoint.SurveyAnalyzePage",a.ShareAnalysisPage="Endpoint.ShareAnalysisPage",a.OutlookCreatePollPage="Endpoint.OutlookCreatePollPage",a}();a.Endpoints=b}(b=a.Scenario||(a.Scenario={}))}(b=a.NavPerfEventNames||(a.NavPerfEventNames={}))}(b=a.Event||(a.Event={}))}(OfficeForm||(OfficeForm={})),function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=222)}({10:function(a,b,c){"use strict";function d(){return Forms.Common.getCurrentFormId()}function e(){var a=Forms.Common.getCurrentFormId();return a&&g.decodeFormId(a)}Object.defineProperty(b,"__esModule",{value:!0});var f=OfficeForm.Exports.EnvironmentConfig,g=OfficeForm.Exports.Utilities.FormId,h=null,i=null;Forms.Common.setFormIdGetter=function(a){return h=a},Forms.Common.getCurrentFormId=function(){return h&&h()},Forms.Common.setFormGetter=function(a){return i=a},Forms.Common.getCurrentForm=function(){return i&&i()},Forms.Common.isOwnerMsftUser=function(){var a=g.decodeFormId(Forms.Common.getCurrentFormId()||"");return!!a.OrgId&&a.OrgId.toLowerCase()===f.getMsftTenantId()},Forms.Common.isOwnerMsaUser=function(){var a=g.decodeFormId(Forms.Common.getCurrentFormId()||"");return!!a.OrgId&&a.OrgId.toLowerCase()===f.getMsaTenantId()},Forms.Common.isOwnerOnFastFoodTenant=function(){var a=g.decodeFormId(Forms.Common.getCurrentFormId()||"");return!!a.OrgId&&-1!==f.getFastFoodTenantsId().indexOf(a.OrgId.toLowerCase())},b.getCurrentFormId=d,b.getCurrentFormIdObj=e},11:function(a,b,c){"use strict";function d(){r.Flight.isEnabled(r.Flights.UseRefactoredTelemetry)?(W.initialize(),n.beforeLeavingPage(f)):(OfficeForm.Exports.Telemetry.deprecatedInitializeTelemetry(),n.beforeLeavingPage(OfficeForm.Exports.Telemetry.flushLogs))}function e(){return W&&W.SessionId}function f(){var a=$.Deferred();return W?W.flush(function(){return a.resolve()}):a.resolve(),a.promise()}function g(){var a=o.GetHostString();if(a)return a;var b="origin",c=q.Html.getQueries()[b];
if(c)return c;b="oembedsso";var d=q.Html.getQueries()[b];return d?"Forms WebPart":q.Flight.isPPTIntegration()?"PowerPoint":null}function h(){var a=p.getEnvironmentType();switch(a){case"Int":return"Int";case"EDog":return"PreProd";case"WWProd":case"USGovProd":return"Prod";default:return"DevEnv"}}function i(a){return isNaN(a)?"0":a.toString()}function j(){var a=p.getPageType();switch(a){case"Design":return U.Designer;case"Response":return U.Responder;case"Analyze":return U.AnalyzeViewer;case"TeamsConfig":return U.TeamsConfigUser;default:return U.Unknown}}function k(){var a=p.getEnvironmentType();switch(a){case"Int":return L;case"EDog":return M;case"WWProd":return t.FeaturePlanProvider.isMsaUser()||Forms.Common.isOwnerMsaUser()?O:N;case"USGovGccProd":return P;case"USGovProd":return Q;case"USDoDProd":return R;default:return K}}Object.defineProperty(b,"__esModule",{value:!0});var l,m=c(15),n=c(5),o=OfficeForm.Exports.EnvironmentSettings,p=OfficeForm.Exports.EnvironmentConfig,q=OfficeForm.Exports.Utilities,r=OfficeForm.Exports.Flighting,s=OfficeForm.Exports.Muid,t=OfficeForm.Exports.DataProvider,u="Office Forms BrowserApp",v="source_application",w="session_id",x="user_id",y="user_tenant_id",z="user_role",A="user_type",B="form_id",C="event_name",D="event_correlation_id",E="timestamp",F="duration",G="properties",H="UserInfo.Id",I="UserInfo.IdType",J="UserInfo.OMSTenantId",K="e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917",L="79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484",M="725da52713e94a7f8c04e11418b8378d-67b7892c-33c8-439c-a03e-bd0305e0bc8e-6732",N="2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092",O="5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406",P="aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984",Q="577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823",R="291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725",S="MUID",T="IntelligenceStatistic";!function(a){a[a.Unknown=0]="Unknown",a[a.Edu=1]="Edu",a[a.Biz=2]="Biz",a[a.MsaFree=4]="MsaFree",a[a.MSIT=8]="MSIT",a[a.MsaPaid=16]="MsaPaid",a[a.FastFood=32]="FastFood"}(l||(l={}));var U;!function(a){a[a.Designer=0]="Designer",a[a.Responder=1]="Responder",a[a.Unknown=2]="Unknown",a[a.AnalyzeViewer=3]="AnalyzeViewer",a[a.TeamsConfigUser=4]="TeamsConfigUser"}(U||(U={})),b.initializeTelemetry=d,b.getCurrentSessionId=e,b.flushLogs=f,b.getOrigin=g;var V=function(){function a(){this.sessionId=q.Guid.newGuid(),this.sessionDbId="",this.sessionDeviceId="",this.initialized=!1}return a.logData=function(b){a.BUFFER.queue(b)},Object.defineProperty(a.prototype,"SessionId",{get:function(){return this.sessionId},enumerable:!0,configurable:!0}),a.prototype.flush=function(a){this.initialized?AWTLogManager.flush(a):a()},a.prototype.initialize=function(){var b=this;r.Flight.isEnabled(r.Flights.UseRefactoredTelemetry)&&(r.Flight.isEnabled(r.Flights.EnableMuidForAnonymousUsers)&&s.Instance.ensureMuid(),this.msaTenantIdInUpperCase=p.getMsaTenantId().toUpperCase(),this.userRole=j(),this.userType=l.Unknown,p.isOsi()&&"OneNoteUwp"!==g()&&t.FeaturePlanProvider.getUserType().done(function(a){return b.userType=a}).always(function(){var c={disableCookiesUsage:!0};switch(p.getEnvironmentType()){case"USGovProd":c.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":c.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0"}var d=k();AWTLogManager.initialize(d,c),b.initialized=!0,b.logger=AWTLogManager.getLogger(d),a.BUFFER.setFunctionToCall(b.logEvent.bind(b))}))},a.prototype.logEvent=function(a){"session_start"===a.eventType&&this.enrichSessionInfo(a),this.logEventWorker(a)},a.prototype.enrichSessionInfo=function(a){if(a.properties){var b=JSON.parse(a.properties);b&&(this.sessionDbId=b.DbId,this.sessionDeviceId=b.DeviceId)}var c={BuildVersion:OfficeFormServerInfo.version,DbId:this.sessionDbId,DeviceId:this.sessionDeviceId,IsMobile:q.isMobile(),JQueryLoaded:!!window.$,SessionRing:h(),SessionUrlPath:window.location.origin+window.location.pathname,UserAgent:navigator.userAgent},d=g();d&&(c.Origin=d),a.eventName=a.eventType,a.duration=0,a.properties=JSON.stringify(c),a.timeStamp=q.DateTime.getTimeStamp()},a.prototype.logEventWorker=function(a){var b=new AWTEventProperties;b.setName(a.eventType),b.setProperty(C,a.eventName),b.setProperty(D,a.eventCorrelationId),b.setProperty(F,i(a.duration)),b.setProperty(E,i(a.timeStamp)),b.setProperty(G,a.properties),a.eventName&&a.eventName.indexOf(T)>=0?this.sendSingleTelemetryEventWithoutUserInfo(b):this.sendSingleTelemetryEvent(b)},a.prototype.sendSingleTelemetryEventWithoutUserInfo=function(a){a.setProperty(v,u),a.setProperty(z,this.userRole),a.setProperty(A,this.userType),this.logger.logEvent(a)},a.prototype.sendSingleTelemetryEvent=function(a){var b=OfficeFormServerInfo.userInfo.UserId,c=OfficeFormServerInfo.userInfo.TenantId,d=Forms.Common.getCurrentFormId();if(d&&a.setProperty(B,d),a.setProperty(v,u),a.setProperty(x,b),a.setProperty(y,c),a.setProperty(z,this.userRole),a.setProperty(A,this.userType),a.setProperty(w,this.sessionId),c)if(c.toUpperCase()===this.msaTenantIdInUpperCase){var e=OfficeFormServerInfo.userInfo.PUID;a.setProperty(H,e),a.setProperty(I,"MSAPUID")}else a.setProperty(H,b),a.setProperty(I,"UserObjectId"),a.setProperty(J,c);else!b&&r.Flight.isEnabled(r.Flights.EnableMuidForAnonymousUsers)&&a.setProperty(S,s.Instance.Muid);this.logger.logEvent(a)},a.BUFFER=new m.BufferForCall,a}();b.Telemetry=V;var W=new V},12:function(a,b,c){"use strict";function d(a){if(f)throw Error("PageContext has already been initialized.");f=new i(a)}function e(){return void 0===f&&d({authenticators:[]}),f}Object.defineProperty(b,"__esModule",{value:!0});var f,g=c(17),h=c(10);b.initializePageContext=d,b.getPageContext=e;var i=function(){function a(a){this.authProvider=new g.AuthProvider(a.authenticators)}return Object.defineProperty(a.prototype,"AuthContext",{get:function(){return this.authProvider},enumerable:!0,configurable:!0}),a.prototype.getPrivacyUrl=function(){var a=h.getCurrentFormIdObj();return OfficeForm.Exports.DataProvider.createDataProvider().getPrivacySettings(a&&a.OrgId,OfficeFormServerInfo.userInfo.TenantId).then(function(a){return a&&a.privacyUrl})},a}();Forms.getPageContext=e},14:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(3),e=c(2),f=OfficeForm.Exports.Utilities,g=OfficeForm.Exports.Flighting,h=OfficeForm.Exports.Event,i=function(){function a(a){g.Flight.isEnabled(g.Flights.UseRefactoredTelemetry)?(this.eventData={correlationId:f.Guid.newGuid(),duration:0,eventName:a,eventType:"qos_event",extraData:void 0},this.startTime=null):this.qos=new h.QosEventDeprecated(a)}return Object.defineProperty(a.prototype,"CorrelationId",{get:function(){return this.qos?this.qos.CorrelationId:this.eventData.correlationId},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ExtraData",{get:function(){return this.eventData.extraData},enumerable:!0,configurable:!0}),a.prototype.start=function(){if(this.qos)this.qos.start();else{this.startTime=f.DateTime.getTimeStamp();var a=this.prepareEvent(this.eventData,"Start");e.log(a)}},a.prototype.end=function(a){if(this.qos)this.qos.end({extraData:a.extraData,resultCode:a.resultCode,resultType:a.resultType});else{var b=this.prepareEvent(a,"End");e.log(b)}},a.prototype.log=function(a){var b=this.prepareEvent(a,"Log");e.log(b)},a.prototype.prepareEvent=function(a,b){var c=d.clone(this.eventData);switch(null!==this.startTime&&"Start"!==b&&(c.duration=f.DateTime.getTimeStamp()-this.startTime),a.logLevel&&(c.logLevel=a.logLevel),a.extraData&&(c.extraData=a.extraData),b){case"Start":c.eventName+="."+b;break;case"Log":c.eventName+="."+b,a.resultCode&&(c.eventName+="."+a.resultCode);break;case"End":a.resultType&&(c.eventName+="."+a.resultType)}return c},a}();b.QosEvent=i,Forms.Telemetry.QosEvent=i},15:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){this.buffer=[]}return a.prototype.setFunctionToCall=function(a){var b=this;if(this.functionToCall!==a)if(this.functionToCall=a,a){var c=this.buffer;delete this.buffer,c&&c.length&&c.forEach(function(a){return b.functionToCall.apply(void 0,a)})}else this.buffer=this.buffer||[]},Object.defineProperty(a.prototype,"queue",{get:function(){return this.functionToCall?this.functionToCall:this.defaultQueue},enumerable:!0,configurable:!0}),a.prototype.defaultQueue=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];this.buffer.push(a)},a}();b.BufferForCall=d},16:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(2),c(14)},17:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(3),e=c(18),f=function(){function a(a){this.validAuthenticator=null,this.userInfo=null,OfficeFormServerInfo.isAuthV2Enabled?this.authenticators=a.concat():this.authenticators=[new e.DeprecatedAuthenticator]}return a.prototype.ensureSignIn=function(){var a=this;return this.signInPromise||(this.signInPromise=$.when(this.signOutPromise).then(function(){var b=function(c){var e=a.authenticators[c];return e?e.signIn().then(function(b){return a.userInfo=d.clone(b||null),a.validAuthenticator=e,b},function(){return b(c+1)}):$.Deferred().reject(new Error("Sign in failed.")).promise()};return b(0)})),this.signInPromise},a.prototype.getCurrentUser=function(){return this.userInfo},a.prototype.getFormApiToken=function(){var a=this;return this.ensureSignIn().then(function(){return a.validAuthenticator&&a.validAuthenticator.getFormApiToken()})},a.prototype.getSignInState=function(){return this.signInPromise?this.signInPromise.state():"not started"},a.prototype.signOut=function(){if(this.signOutPromise)return this.signOutPromise;if(!this.signInPromise)return $.Deferred().resolve().promise();var a=this.signInPromise,b=this.validAuthenticator;return this.signInPromise=void 0,this.validAuthenticator=null,this.userInfo=null,this.signOutPromise=a.then(function(){return b.signOut()}),this.signOutPromise},a}();b.AuthProvider=f},18:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(19),e=function(){function a(){this.tokenGetter=new d.TokenGetter}return a.prototype.getFormApiToken=function(){var a=OfficeForm.Exports.Authenticator.AuthContext;return this.tokenGetter.getToken(a)},a.prototype.signIn=function(){return $.Deferred().resolve().promise()},a.prototype.signOut=function(){throw new Error("Method not implemented.")},a}();b.DeprecatedAuthenticator=e},19:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c(2),e=c(5),f=c(20),g=OfficeForm.Exports.Utilities,h=OfficeForm.Exports.Flighting,i=OfficeForm.Exports.AddinAuth,j=OfficeForm.Exports.EnvironmentConfig,k=function(){function a(){this.waitHostAccessTokenRetryCount=0}return a.prototype.getToken=function(b){var c=this;return g.Flight.isOembedTrialSSOEnabled()||g.Flight.isPPTContentAddinSSOEnabled()||g.Flight.isStreamSSOEnabled()?(a.getAccessTokenFromHostHandler||(a.getAccessTokenFromHostHandler=$.Deferred()),!a.shouldMemoryCachedTokenCheckBeSkipped()&&a.AccessTokenFromHost&&a.AccessTokenFromHost.isAccessTokenFromHostValid()?(a.getAccessTokenFromHostHandler.resolve(a.AccessTokenFromHost.AccessToken),a.getAccessTokenFromHostHandler.promise()):(("resolved"===a.getAccessTokenFromHostHandler.state()||"rejected"===a.getAccessTokenFromHostHandler.state())&&(a.getAccessTokenFromHostHandler=$.Deferred()),a.getAccessTokenFromHost(),this.waitHostAccessTokenRetryCount=0,this.waitForAccessToken(),a.getAccessTokenFromHostHandler.promise())):g.enterSSO()?i.getAddinAccessToken().then(null,function(a){return c.getTokenInternal(b)}):this.getTokenInternal(b)},a.shouldMemoryCachedTokenCheckBeSkipped=function(){return g.Flight.isPPTContentAddinSSOEnabled()||g.Flight.isStreamSSOEnabled()},a.getAccessTokenFromHost=function(){a.AccessTokenFromHost=null,window.addEventListener("message",a.receiveAccessToken,!1),window.parent.postMessage("GetAccessTokenFromHost","*")},a.receiveAccessToken=function(b){if(b.data.startsWith("FormsAccessTokenFromHost:"))try{var c="FormsAccessTokenFromHost:Bearer ",d=b.data.indexOf(c);if(-1!=d){var e=b.data.substring(d+c.length);a.AccessTokenFromHost=new l(e)}}finally{window.removeEventListener("message",a.receiveAccessToken,!1)}},a.prototype.getTokenInternal=function(b){var c=this,i=$.Deferred();if(h.Flight.isEnabled(h.Flights.CookieAuth))return i.resolve(null),i.promise();var k=b.getCachedUser();return k?(b.acquireToken(j.getFormsResourceId(),function(h,k){if(!h&&k)return c.lastAcquireTokenSuccessTime=new Date,void i.resolve(k);var l=b.getCachedToken(j.getAadClientId());if(!l){if(c.lastAcquireTokenSuccessTime){var m=(new Date).getTime()-c.lastAcquireTokenSuccessTime.getTime();d.log({eventName:"Auth.AcquireTokenIdleTime",eventType:"engagement_event",extraData:{error:h,idleTimeInMinutes:m/6e4}})}return b.clearCache(),void e.reloadPage()}if(b.clearCache(),h.match("^AADSTS50079:")){d.log({eventName:"AADAcquireTokenMfaCheckFailure",eventType:"error_event",extraData:h});var n=new Error;return n.name=OfficeForm.Exports.ClientErrorNames.AADAcquireTokenMfaCheckError,n.message=h,void i.reject(n)}if(!h.match("^AADSTS50058:")){d.log({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:h});var n=new Error;return n.name=OfficeForm.Exports.ClientErrorNames.AADAcquireTokenError,n.message=h,void i.reject(n)}if(g.isIE()||g.isEdge()){var o=f.AuthRelatedLocalStorage.UseLegacyLoginDomain;if(d.log({eventName:"LoginIECrossZone",eventType:"error_event",extraData:{useLegacyLoginDomain:!!o}}),f.AuthRelatedLocalStorage.UseLegacyLoginDomain)f.AuthRelatedLocalStorage.UseLegacyLoginDomain=!1;else if(f.AuthRelatedLocalStorage.isSupported())return f.AuthRelatedLocalStorage.UseLegacyLoginDomain=!0,void e.reloadPage()}else d.log({eventName:"AADAcquireTokenFailure",eventType:"error_event",extraData:h});a.getThirdPartyCookieError(h).done(function(a){return i.reject(a)})}),i.promise()):(i.resolve(null),i.promise())},a.getThirdPartyCookieError=function(b){var c=$.Deferred();return a.detectThirdPartyCookieSupport(function(a){d.log({eventName:"Auth.ThirdPartyCookieSupport",eventType:"engagement_event",extraData:{allow:a}});var e=new Error(b);a?e.name=OfficeForm.Exports.ClientErrorNames.LoginIECrossZoneError:e.name=OfficeForm.Exports.ClientErrorNames.ThirdPartyCookieBlockedError,c.resolve(e)}),c.promise()},a.detectThirdPartyCookieSupport=function(a){var b=function(c){"TPC:NotSupported"===c.data?(a(!1),window.removeEventListener("message",b)):"TPC:Supported"===c.data&&(a(!0),window.removeEventListener("message",b))};window.addEventListener("message",b,!1);var c="https://controls.officeppe.com/thirdpartycookie/check.html";$("body").append('<iframe id="detectThirdPartyCookieFrame" style="display:none;" src='+c+"><iframe>")},a.prototype.waitForAccessToken=function(){var b=this;if(null!=a.AccessTokenFromHost){var c=a.AccessTokenFromHost.AccessToken;i.refreshInfo(c).always(function(){return a.getAccessTokenFromHostHandler.resolve(c)})}else this.waitHostAccessTokenRetryCount<10?(this.waitHostAccessTokenRetryCount++,setTimeout(function(){return b.waitForAccessToken()},1e3)):(this.waitHostAccessTokenRetryCount=0,a.getAccessTokenFromHostHandler.resolve(null))},a.AccessTokenFromHost=null,a}();b.TokenGetter=k;var l=function(){function a(a){this.accessToken=a;var b=33e5;this.tokenExpireTime=(new Date).getTime()+b}return Object.defineProperty(a.prototype,"AccessToken",{get:function(){return this.accessToken},enumerable:!0,configurable:!0}),a.prototype.isAccessTokenFromHostValid=function(){return!!this.accessToken&&(new Date).getTime()<this.tokenExpireTime},a}()},2:function(a,b,c){"use strict";function d(a){if(l.Flight.isEnabled(l.Flights.UseRefactoredTelemetry)){var b=n[a.eventType];if(b)j.Telemetry.logData(b(a));else{var c={eventName:"no_ErrorName",eventType:"error_event",extraData:{initData:a,message:"Unsupported event"}};j.Telemetry.logData(e(c))}}else switch(a.eventType){case"engagement_event":k.EngagementEventDeprecated.logData({extraData:a.extraData,name:a.eventName});break;case"error_event":k.ErrorEventDeprecated.logData({errorInfo:a.extraData,type:a.eventName});break;case"session_start":k.EngagementEventDeprecated.logSessionStartEvent();break;case"nav_perf_event":k.NavPerfEventDeprecated.logData({extraData:a.extraData,name:a.eventName})}}function e(a){var b={duration:0,eventCorrelationId:m.Guid.newGuid(),eventName:(a.eventName||o[a.eventType]).replace(" ",""),eventType:a.eventType,properties:"",timeStamp:m.DateTime.getTimeStamp()};return a.extraData&&(b.properties=JSON.stringify(a.extraData)),b}function f(a){return a.extraData={DbId:"",DeviceId:""},e(a)}function g(a){var b={duration:a.duration,eventCorrelationId:a.correlationId,eventName:(a.eventName||o[a.eventType]).replace(" ",""),eventType:a.eventType,properties:"",timeStamp:m.DateTime.getTimeStamp()};return a.extraData&&(b.properties=JSON.stringify(a.extraData)),b}function h(a){var b=e(a);return a.extraData&&(a.ignoreRawTiming&&i(a),b.properties=JSON.stringify(a.extraData)),b}function i(a){if(window.performance){var b=window.performance.timing,c={navigationType:window.performance.navigation.type};c.navigationStart=b.navigationStart,c.unloadEventStart=b.unloadEventStart-b.navigationStart,c.unloadEventEnd=b.unloadEventEnd-b.navigationStart,c.redirectStart=0===b.redirectStart?0:b.redirectStart-b.navigationStart,c.redirectEnd=0===b.redirectEnd?0:b.redirectEnd-b.navigationStart,c.fetchStart=b.fetchStart-b.navigationStart,c.domainLookupStart=b.domainLookupStart-b.navigationStart,c.domainLookupEnd=b.domainLookupEnd-b.navigationStart,c.connectStart=b.connectStart-b.navigationStart,c.connectEnd=b.connectEnd-b.navigationStart,c.requestStart=b.requestStart-b.navigationStart,c.responseStart=b.responseStart-b.navigationStart,c.responseEnd=b.responseEnd-b.navigationStart,c.domLoading=b.domLoading-b.navigationStart,c.domInteractive=b.domInteractive-b.navigationStart,c.domContentLoadedEventStart=b.domContentLoadedEventStart-b.navigationStart,c.domContentLoadedEventEnd=b.domContentLoadedEventEnd-b.navigationStart,c.domComplete=b.domComplete-b.navigationStart,c.loadEventStart=b.loadEventStart-b.navigationStart,c.loadEventEnd=b.loadEventEnd-b.navigationStart,a.extraData=a.extraData||{};var d="rawTiming";a.extraData[d]=c}}Object.defineProperty(b,"__esModule",{value:!0});var j=c(11),k=OfficeForm.Exports.Event,l=OfficeForm.Exports.Flighting,m=OfficeForm.Exports.Utilities,n={engagement_event:e,error_event:e,nav_perf_event:h,qos_event:g,session_start:f},o={engagement_event:"no_EngagementName",error_event:"no_ErrorName",nav_perf_event:"no_NavPerfName",qos_event:"no_QosName",session_start:"session_start"};b.log=d,Forms.Telemetry.log=d},20:function(a,b,c){"use strict";function d(a){return h.LocalStorage.getItem(a)}function e(a,b){b?h.LocalStorage.setItem(a,b):h.LocalStorage.removeItem(i)}function f(a){var b=h.LocalStorage,c=a+n,d=b.getItem(c),e=d&&JSON.parse(d);if(!e||Date.now()>e)return b.removeItem(c),b.removeItem(a),null;var f=b.getItem(a);return f&&JSON.parse(f)}function g(a,b,c){var d=a+n,e=h.LocalStorage;b?(e.setItem(d,JSON.stringify(Date.now()+c)),e.setItem(a,JSON.stringify(b))):(e.removeItem(d),e.removeItem(a))}Object.defineProperty(b,"__esModule",{value:!0});var h=OfficeForm.Exports.SafeStorage,i="officeforms.uselegacylogindomain",j="officeforms.userAccountNameKey",k="officeforms.auth.detectAADInProgress",l="officeforms.auth.detectAADResult",m=function(){function a(){}return a.isSupported=function(){return h.supportsLocalStorage()},Object.defineProperty(a,"DetectAADInProgress",{get:function(){return f(k)},set:function(a){var b=5e3;g(k,a,b)},enumerable:!0,configurable:!0}),Object.defineProperty(a,"DetectAADResult",{get:function(){return"true"===d(l)},set:function(a){e(l,a?"true":null)},enumerable:!0,configurable:!0}),Object.defineProperty(a,"UseLegacyLoginDomain",{get:function(){return!!d(i)},set:function(a){e(i,a?"1":null)},enumerable:!0,configurable:!0}),Object.defineProperty(a,"UserAccountName",{get:function(){var a=d(j);return a&&JSON.parse(a)},set:function(a){e(j,a?JSON.stringify(a):null)},enumerable:!0,configurable:!0}),a}();b.AuthRelatedLocalStorage=m;var n=".timestamp";Forms.AuthRelatedLocalStorage=m},222:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(223)},223:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c(10),c(60);var d=c(11);c(16);var e=c(12);e.initializePageContext({authenticators:[]}),d.initializeTelemetry(),OfficeForm.Exports.DefaultPage.initializePage()},3:function(a,b){a.exports=_},5:function(a,b,c){"use strict";function d(a){return i().then(function(){window.location.assign(a)})}function e(a){return i().then(function(){window.location.reload(a)})}function f(a){return i().then(function(){window.location.replace(a)})}function g(a){return i().then(function(){window.location.pathname=a})}function h(a){j.push(a)}function i(){var a=j;j=[];var b=OfficeForm.Exports.Utilities.Promise.always,c=$.when.apply($,a.map(function(a){return b(a())}));return j.push(function(){return c}),c}Object.defineProperty(b,"__esModule",{value:!0}),b.redirectTo=d,b.reloadPage=e,b.replaceUrl=f,b.replacePathName=g,b.beforeLeavingPage=h;var j=[];Forms.Common.redirectTo=d,Forms.Common.reloadPage=e,Forms.Common.replaceUrl=f,Forms.Common.replacePathName=g,Forms.Common.beforeLeavingPage=h},60:function(a,b,c){"use strict";function d(a,b){var c=Date.now(),d={sa:c-i};return j[a]=d,b.done(function(){d.d=Date.now()-c}).fail(function(){d.d=Date.now()-c,d.f=1})}function e(a){k[a]=Date.now()-i}function f(){var a="Forms.PerformanceAnalysis";h.log({eventName:a,eventType:"engagement_event",extraData:{checkPoints:k,requests:j,requestsAll:Date.now()-i,scriptCached:l,scriptDownload:window.FormsPageStartTime&&i-window.FormsPageStartTime,version:1}})}function g(){try{var a="FormsVersion"+window.location.pathname,b=window.localStorage.getItem(a),c=OfficeFormServerInfo.version;return b!==c?(window.localStorage.setItem(a,c),!1):!0}catch(d){return!1}}Object.defineProperty(b,"__esModule",{value:!0});var h=c(2),i=Date.now(),j={},k={},l=g();b.requestWithPromise=d,b.addCheckPoint=e,b.onPageReadyToRender=f,Forms.PerformanceAnalysis={addCheckPoint:e,onPageReadyToRender:f,requestWithPromise:d}}});