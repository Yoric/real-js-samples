/*v51925: 2019-02-01T20:26:19*/
(function(f){function d(){}function v(F){c=[F]}function o(H,F,G){return H&&H.apply(F.context||F,G)}function n(F){return/\?/.test(F)?"&":"?"}var p="async",t="charset",r="",D="error",u="insertBefore",s="_jqjsp",A="on",g=A+"click",k=A+D,q=A+"load",y=A+"readystatechange",b="readyState",C="removeChild",j="<script>",z="success",B="timeout",e=window,a=f.Deferred,h=f("head")[0]||document.documentElement,x={},m=0,c,l={callback:s,url:location.href},w=e.opera,i=!!f("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;function E(K){K=f.extend({},l,K);var I=K.success,P=K.error,H=K.complete,Y=K.dataFilter,aa=K.callbackParameter,Q=K.callback,Z=K.cache,G=K.pageCache,J=K.charset,L=K.url,ac=K.data,S=K.timeout,O,W=0,U=d,R,N,F,ab,M,V;a&&a(function(ad){ad.done(I).fail(P);I=ad.resolve;P=ad.reject}).promise(K);K.abort=function(){!(W++)&&U()};if(o(K.beforeSend,K,[K])===!1||W){return K}L=L||r;ac=ac?((typeof ac)=="string"?ac:f.param(ac,K.traditional)):r;L+=ac?(n(L)+ac):r;aa&&(L+=n(L)+encodeURIComponent(aa)+"=?");!Z&&!G&&(L+=n(L)+"_"+(new Date()).getTime()+"=");L=L.replace(/=\?(&|$)/,"="+Q+"$1");function X(ad){if(!(W++)){U();G&&(x[L]={s:[ad]});Y&&(ad=Y.apply(K,[ad]));o(I,K,[ad,z,K]);o(H,K,[K,z])}}function T(ad){if(!(W++)){U();G&&ad!=B&&(x[L]=ad);o(P,K,[K,ad]);o(H,K,[K,ad])}}if(G&&(O=x[L])){O.s?X(O.s[0]):T(O)}else{e[Q]=v;ab=f(j)[0];ab.id=s+m++;if(J){ab[t]=J}w&&w.version()<11.6?((M=f(j)[0]).text="document.getElementById('"+ab.id+"')."+k+"()"):(ab[p]=p);if(i){ab.htmlFor=ab.id;ab.event=g}ab[q]=ab[k]=ab[y]=function(ad){if(!ab[b]||!/i/.test(ab[b])){try{ab[g]&&ab[g]()}catch(ae){}ad=c;c=0;ad?X(ad[0]):T(D)}};ab.src=L;U=function(ad){V&&clearTimeout(V);ab[y]=ab[q]=ab[k]=null;h[C](ab);M&&h[C](M)};h[u](ab,(F=h.firstChild));M&&h[u](M,F);V=S>0&&setTimeout(function(){T(B)},S)}return K}E.setup=function(F){f.extend(l,F)};f.jsonp=E})(jQuery);(function(b){
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
var a=(typeof module!=="undefined"&&module.exports)||{};(function(y){y.name="mustache.js";y.version="0.5.0-dev";y.tags=["{{","}}"];y.parse=o;y.compile=g;y.render=x;y.clearCache=w;y.to_html=function(C,A,B,D){var z=x(C,A,B);if(typeof D==="function"){D(z)}else{return z}};var u=Object.prototype.toString;var h=Array.isArray;var d=Array.prototype.forEach;var i=String.prototype.trim;var k;if(h){k=h}else{k=function(z){return u.call(z)==="[object Array]"}}var t;if(d){t=function(A,B,z){return d.call(A,B,z)}}else{t=function(C,D,B){for(var A=0,z=C.length;A<z;++A){D.call(B,C[A],A,C)}}}var m=/^\s*$/;function e(z){return m.test(z)}var r;if(i){r=function(z){return z==null?"":i.call(z)}}else{var p,j;if(e("\xA0")){p=/^\s+/;j=/\s+$/}else{p=/^[\s\xA0]+/;j=/[\s\xA0]+$/}r=function(z){return z==null?"":String(z).replace(p,"").replace(j,"")}}var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function q(z){return String(z).replace(/&(?!\w+;)|[<>"']/g,function(A){return f[A]||A})}function n(F,H,I,B){B=B||"<template>";var J=H.split("\n"),z=Math.max(I-3,0),C=Math.min(J.length,I+3),A=J.slice(z,C);var G;for(var D=0,E=A.length;D<E;++D){G=D+z+1;A[D]=(G===I?" >> ":"    ")+A[D]}F.template=H;F.line=I;F.file=B;F.message=[B+":"+I,A.join("\n"),"",F.message].join("\n");return F}function v(z,H,G){if(z==="."){return H[H.length-1]}var F=z.split(".");var D=F.length-1;var E=F[D];var I,A,C=H.length,B,J;while(C){J=H.slice(0);A=H[--C];B=0;while(B<D){A=A[F[B++]];if(A==null){break}J.push(A)}if(A&&E in A){I=A[E];break}}if(typeof I==="function"){I=I.call(J[J.length-1])}if(I==null){return G}return I}function l(C,z,G,B){var A="";var E=v(C,z);if(B){if(E==null||E===false||(k(E)&&E.length===0)){A+=G()}}else{if(k(E)){t(E,function(H){z.push(H);A+=G();z.pop()})}else{if(typeof E==="object"){z.push(E);A+=G();z.pop()}else{if(typeof E==="function"){var D=z[z.length-1];var F=function(H){return x(H,D)};A+=E.call(D,G(),F)||""}else{if(E){A+=G()}}}}}return A}function o(ab,D){D=D||{};var M=D.tags||y.tags,N=M[0],I=M[M.length-1];var A=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'];var H=[],ac=false,Z=false;var X=function(){if(ac&&!Z&&!D.space){while(H.length){A.splice(H.pop(),1)}}else{H=[]}ac=false;Z=false};var U=[],R,E,O;var W=function(ad){M=r(ad).split(/\s+/);E=M[0];O=M[M.length-1]};var L=function(ad){A.push('";',R,'\nvar partial = partials["'+r(ad)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')};var z=function(af,ad){var ae=r(af);if(ae===""){throw n(new Error("Section name may not be empty"),ab,K,D.file)}U.push({name:ae,inverted:ad});A.push('";',R,'\nvar name = "'+ae+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')};var G=function(ad){z(ad,true)};var V=function(ae){var ad=r(ae);var ag=U.length!=0&&U[U.length-1].name;if(!ag||ad!=ag){throw n(new Error('Section named "'+ad+'" was never opened'),ab,K,D.file)}var af=U.pop();A.push('";',"\n    return buffer;","\n  };","\n})();");if(af.inverted){A.push("\nbuffer += renderSection(name,stack,callback,true);")}else{A.push("\nbuffer += renderSection(name,stack,callback);")}A.push('\nbuffer += "')};var Y=function(ad){A.push('";',R,'\nbuffer += lookup("'+r(ad)+'",stack,"");','\nbuffer += "')};var B=function(ad){A.push('";',R,'\nbuffer += escapeHTML(lookup("'+r(ad)+'",stack,""));','\nbuffer += "')};var K=1,aa,F;for(var S=0,T=ab.length;S<T;++S){if(ab.slice(S,S+N.length)===N){S+=N.length;aa=ab.substr(S,1);R="\nline = "+K+";";E=N;O=I;ac=true;switch(aa){case"!":S++;F=null;break;case"=":S++;I="="+I;F=W;break;case">":S++;F=L;break;case"#":S++;F=z;break;case"^":S++;F=G;break;case"/":S++;F=V;break;case"{":I="}"+I;case"&":S++;Z=true;F=Y;break;default:Z=true;F=B}var C=ab.indexOf(I,S);if(C===-1){throw n(new Error('Tag "'+N+'" was not closed properly'),ab,K,D.file)}var Q=ab.substring(S,C);if(F){F(Q)}var P=0;while(~(P=Q.indexOf("\n",P))){K++;P++}S=C+I.length-1;N=E;I=O}else{aa=ab.substr(S,1);switch(aa){case'"':case"\\":Z=true;A.push("\\"+aa);break;case"\r":break;case"\n":H.push(A.length);A.push("\\n");X();K++;break;default:if(e(aa)){H.push(A.length)}else{Z=true}A.push(aa)}}}if(U.length!=0){throw n(new Error('Section "'+U[U.length-1].name+'" was not closed properly'),ab,K,D.file)}X();A.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var J=A.join("").replace(/buffer \+= "";\n/g,"");if(D.debug){if(typeof console!="undefined"&&console.log){console.log(J)}else{if(typeof print==="function"){print(J)}}}return J}function s(D,B){var A="view,partials,stack,lookup,escapeHTML,renderSection,render";var z=o(D,B);var C=new Function(A,z);return function(F,G){G=G||{};var E=[F];try{return C(F,G,E,v,q,l,x)}catch(H){throw n(H.error,D,H.line,B.file)}}}var c={};function w(){c={}}function g(A,z){z=z||{};if(z.cache!==false){if(!c[A]){c[A]=s(A,z)}return c[A]}return s(A,z)}function x(B,z,A){return g(B)(z,A)}})(a);b.mustache=function(e,c,d){return a.render(e,c,d)};b.pluralize=function(c){return{cnt:c,pl:function(){return function(e,d){if(this.cnt*1!=1){if(e.substring(e.length-1)=="y"){return d(e.substring(0,e.length-1)+"ies")}else{if(e=="person"){return"people"}else{if(e=="is"){return"are"}}}return d(e+"s")}else{return d(e)}}}}};b.fn.mustache=function(c,d){return b(this).map(function(f,h){var g=b(h).html().trim();var e=b.mustache(g,c,d);return b(e).get()})}})(jQuery);var $j={templates:{},get_root_namespace:function(){return"$j"},namespace:function(){var c=arguments,h=this,f=0,e,g,b;for(;f<c.length;f++){b=c[f];if(b.indexOf(".")){g=b.split(".");for(e=(g[0]==this.get_root_namespace())?1:0;e<g.length;e++){h[g[e]]=h[g[e]]||{};h=h[g[e]]}}else{h[b]=h[b]||{}}}return h}};(function(b){if(!b.browser){var a=function(d){d=d.toLowerCase();var c=/(chrome)[ \/]([\w.]+)/.exec(d)||/(webkit)[ \/]([\w.]+)/.exec(d)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(d)||/(msie) ([\w.]+)/.exec(d)||d.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(d)||[];return{browser:c[1]||"",version:c[2]||"0"}};matched=a(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=true;browser.version=matched.version}if(browser.chrome){browser.webkit=true}else{if(browser.webkit){browser.safari=true}}b.browser=browser}})(jQuery);(function(e){$j.namespace("$j.loader");var b=[];var d="http://i.newsvine.com";$j.loader=function(g,f){if(typeof g=="object"){f=g;g="init"}new a()[g](f)};$j.loader.defaults={js:[],css:[],img:[],name:null,cdn:false,timeout:20000,success:function(){},error:function(){},complete:function(){},each:function(){},context:this};var c=document.getElementsByTagName("head")[0];function a(){var o=this,q,k=[],m=[],l,f,h,g=[];this.init=function(r){if(!r){return}q=e.extend({},$j.loader.defaults,r);h={js:q.js,css:q.css,img:q.img};e.each(h,function(s,t){if(typeof t=="string"){t=t.split(",")}g=g.concat(t)});if(!g.length){j("error");return}if(q.timeout){l=setTimeout(function(){var s=k.concat(m);e.each(g,function(u,t){e.inArray(t,s)==-1&&m.push(t)});j("error")},q.timeout)}e.each(h,function(t,u){var s=q.cdn&&!vine.session.devMachine;if(e.isArray(u)){e.each(u,function(w,v){if(s&&v.substring(0,4)!="http"){v=vine.util.appendParamToURL(d+v,"r",vine.session.revision)}n(t,v)})}else{if(typeof u=="string"){if(s&&u.substring(0,4)!="http"){u=vine.util.appendParamToURL(d+u,"r",vine.session.revision)}n(t,u)}}})};this.js=function(w,x,t){var v=e('script[src*="'+w+'"]');if(v.length){v.attr("pending")?v.bind("scriptload",x):x();return}var u=document.createElement("script");u.setAttribute("type","text/javascript");u.setAttribute("src",w);u.setAttribute("id",t);u.setAttribute("pending",1);u.onerror=p;e(u).bind("scriptload",function(){e(this).removeAttr("pending");x();setTimeout(function(){e(u).unbind("scriptload")},10)});var r=false;u.onload=u.onreadystatechange=function(){if(!r&&(!this.readyState||/loaded|complete/.test(this.readyState))){r=true;u.onload=u.onreadystatechange=null;e(u).trigger("scriptload")}};c.appendChild(u)};this.css=function(s,w,t){if(e('link[href*="'+s+'"]').length){w();return}if(typeof s!=="string"){return}if(s.indexOf("//")===0){s=location.protocol+s}var u=e('<link rel="stylesheet" type="text/css" media="all" href="'+s+'" id="'+t+'"></link>')[0];if(e.browser.msie){if(e.browser.version<11){u.onreadystatechange=function(){if(u.readyState=="loaded"||u.readyState=="complete"){u.onreadystatechange=null;w()}}}else{u.onload=w}}else{if(e.browser.opera){u.onload=w}else{if(s.indexOf("//")===0){s="http:"+s}var r=location.hostname.replace("www.",""),v=/http:/.test(s)?/^(\w+:)?\/\/([^\/?#]+)/.exec(s)[2]:r;s.indexOf("https://")===0||(r!=v&&e.browser.mozilla)?w():(function(){try{u.sheet.cssRules}catch(x){f=setTimeout(arguments.callee,20);return}w()})()}}c.appendChild(u)};this.img=function(s,t){var r=document.createElement("img");r.onload=t;r.onerror=p;r.src=s;b.push(r)};this.disable=function(r){e("#lazy-loaded-"+r,c).attr("disabled","disabled")};this.enable=function(r){e("#lazy-loaded-"+r,c).removeAttr("disabled")};this.destroy=function(r){e("#lazy-loaded-"+r,c).remove()};function n(s,r){o[s](r,function(t){t=="error"?m.push(r):k.push(r)&&q.each(r);i()},"lazy-loaded-"+(q.name?q.name:new Date().getTime()))}function j(r){q.complete.call(q.context,r,k,m);q[r].call(q.context,(r=="error"?m:k));clearTimeout(l);clearTimeout(f)}function i(){if(k.length==g.length){j("success")}else{if(k.length+m.length==g.length){j("error")}}}function p(){m.push(this.src);i()}}})(jQuery);(function(g){var d=[];$j.moduleRegistry=function(){return{register:function(p){d.push(p)},registeredList:function(){return d.join()},isRegistered:function(p){return(g.inArray(p,d)!==-1)}}};var o="queued";var e="fail";var l="complete";var n=["campaignManager"];$j.ModuleLoader=function(p,q){if($j.moduleRegistry().isRegistered(p)){q&&q();return}this.moduleName=p;this.callback=q;this.status=o;this.loadCSS=(jQuery.inArray(p,n)===-1);this.loadJS=true;$j.log("new ModuleLoader: "+p);b.push(this);setTimeout(a,1)};$j.ModuleLoader.isDynamic=function(p){if(p.indexOf("msnbc_poll_")===0){return true}if(p.indexOf("j_")===0&&p!=="j_widget"){return true}return false};$j.ModuleLoader.autoload=function(q){q=q||g("body");var p=$j.uri(window.location);$j.session.hostReady(function(){k(q)})};var k=function(s){var r=g(s);var p=g('div[class*="j_"],span[class*="j_"],a[class*="j_"],a[class*="msnbc_poll_"]',r);var t=$j.moduleRegistry().isRegistered;var q=function(v,w){if(g(w).attr("class")){var u=g(w).attr("class").split(" ");if(u.length>0){for(var y=0;y<u.length;y++){var x=u[y];if(!t(x)&&$j.ModuleLoader.isDynamic(x)&&typeof g(w).pluginObj(x)!=="object"&&x.indexOf("__")<0){new $j.ModuleLoader(x,null)}}}}};p.andSelf().each(q)};var b=[];var c=null;var i=null;var h=function(){var q=[];for(var r=0;r<b.length;r++){var p=b[r];if(p.status==o){q.push(p)}}return q};var m=function(s,r){var p=[];for(var t=0;t<s.length;t++){var q=s[t];if(g.inArray(q.moduleName,p)===-1){if((typeof r==="undefined")||q["load"+r]){p.push(q.moduleName)}}}return p.join()};function j(){setTimeout(function(){var q=$j.moduleRegistry();for(var r=0;r<b.length;r++){var p=b[r];if(q.isRegistered(p.moduleName)&&(p.status==o)){p.callback&&p.callback();p.status=l}}f()},1)}function f(){i=c;c=null;setTimeout(a,1)}function a(){if(c){return}function q(r){$j.session.hostReady(function(){var t={};var v=$j.moduleRegistry().registeredList();var s=m(r,"CSS");var x=m(r,"JS");var u=$j.session.host.getCDNRoot()+"/_elliott/jengamod?css=1&module="+s+"&loaded="+v;var y=$j.session.host.getCDNRoot()+"/_elliott/jengamod?module="+x+"&loaded="+v;function w(){$j.log(name+" failed to load");for(var A=0;A<b.length;A++){var z=b[A];if(name==z.moduleName){z.status=e}}f()}s&&$j.loader({css:[u]});x&&$j.loader({js:[y],success:j,error:w})})}(function p(){for(var t=0;t<b.length;t++){var r=b[t];if(r.status==o){c=h();(function s(){if(c.length){if(!i||(m(c)!==m(i))){q(c)}else{$j.log("not loaded "+m(c));r.status=e;c=null}}})();return}}})()}})(jQuery);(function(c){var b=[];var a=function(d){return"__"+d+"__self__"};$j.pluginRegistry=b;$j.plugin=function(f,d,e){var g={autoload:false,reinit:false,loginCheck:false,defaultOptions:null};if(typeof f!=="string"){c.error("Jenga pluginName must be defined")}if(typeof d!=="function"){c.error("Jenga pluginFunction must be defined")}if(c.inArray(f,b)>=0){$j.log("***** DOUBLE JAVASCRIPT: "+f);return}if(typeof e==="object"){g=c.extend({},g,e)}b.push(f);c.fn[f]=function(){if(this.length==0){$j.log("invalid element for "+f);return}var k=arguments.length>=0?arguments[0]:null;var i=null;var j=this.length>1;if(!k||typeof k==="object"){k="init";var h=arguments;if(h.length==0){h=[{}]}i=h[0]}else{var h=Array.prototype.slice.call(arguments,1)}return this.each(function(q,n){var l=c(n);var o=l.pluginObj(f);if(o&&k=="init"){$j.log("double load "+f);return}else{if(!o&&k!=="init"){$j.log("****** warning: method call without plugin init "+f+"."+k)}}if(g.loginCheck&&!l.pluginObj("j_login_check")){h[0]["plugin"]=f;l.j_login_check(i);return}if(typeof o!=="object"){if(g.defaultOptions){i=c.extend(true,{},i,g.defaultOptions)}o=new d(n,i);o._pluginName=f;if(g.reinit){var r=l.clone();r.removeData();o.reinit=function(u){if(typeof o.pluginDestroy=="function"){o.pluginDestroy()}l.replaceWith(r);(r[f])(u)}}l.data(a(f),o)}if(k==="init"){var l=c(this);var p=l.data();var s=null;if(j){s=c.extend(true,{},i)}else{s=i}for(var t in p){if(t.startsWith("__")===false){s[t]=p[t]}}h[0]=s}if(typeof o[k]==="function"){o[k].apply(o,h)}else{if(k==="init"){}else{var m="JengaPlugin does not have a valid method to call ["+k+"]";if($j.session.host.isDev()){c.error(m)}else{$j.log(m)}}}})};if(g.autoload===true){setTimeout(function(){$j.plugin.autoload("."+f,f)},1)}c.fn[f].pluginSettings=g};$j.plugin.autoload=function(d,e){c(document).ready(function(){if(typeof c.fn[e]==="function"){c(d).each(function(g,h){try{if(!c(h).pluginObj(e)){c(h)[e]({})}}catch(f){$j.log("init error "+e);$j.log(f)}})}})};c.fn.pluginObj=function(d){return c(this).data(a(d))};c.fn.removePluginObj=function(d){c(this).removeData(a(d))};c.fn.jenga_loadPlugins=function(){var d=function(f,g){if(c(g).attr("class")){var e=c(g).attr("class").split(" ");if(e.length>0){for(var j=0;j<e.length;j++){var h=e[j];if(c.inArray(h,b)>-1&&typeof c(g).pluginObj(h)!=="object"){$j.plugin.autoload(c(g),h)}}}}};c(this).contents().andSelf().each(d);$j.ModuleLoader.autoload(c(this));return this};c.fn.jenga_reinitPlugins=function(){var d=function(f,g){if(c(g).attr("class")){var e=c(g).attr("class").split(" ");if(e.length>0){for(var k=0;k<e.length;k++){var h=e[k];var j=c(g).pluginObj(h);if(j&&c.inArray(h,b)>-1&&j.reinit){j.reinit({})}}}}};c(this).contents().andSelf().each(d);return this};c.fn.loadPlugins=function(){$j.log("deprecated $.loadplugins(). Use jenga_loadPlugins() instead");c.fn.jenga_loadPlugins.apply(this,arguments)}})(jQuery);(function(b){var a=false;$j.JengaWidget=function(d,c){this.$root=null;this.options={};this._className=null;this._instanceId=null;this._mxInits=[];this._isInitialized=false;this._isRendered=false;this._construct=function(f,e){this._instanceId=$j.util.uid();this._className=e;this._createRootNode(f)};this.isRendered=function(){return this._isRendered};this.init=function(e){this._setOptions(e);this._initRootNode();this._globalInit();for(var f=0;f<this._mxInits.length;f++){(this._mxInits[f]).call(this)}this._widgetInit();this._isInitialized=true;if(typeof e.explicitRender==="undefined"||!e.explicitRender){this.refresh()}};this._globalInit=function(){a=true};this._widgetInit=function(){};this.registerMixin=function(e,g){var h=this.init;delete this.init;e.call(this);if(this.init){var f=this.init;this._mxInits.push(function(){f.call(this,g)});delete this.init}else{}this.init=h};this.refresh=function(){var e=this;$j.session.ready(function(){e._render.call(e);e._isRendered=true;$j.trigger("j_widget_rendered",{className:e._className,id:e._instanceId,instance:e})})};this._render=function(){};this.empty=function(){this.$root.empty()};this.getInstanceId=function(){return this._instanceId};this.getWidgetId=function(){return this.getWidgetClass()+"_"+this.getInstanceId()};this.getWidgetClass=function(){return this._className};this.getAssetClass=function(e){return this._className};this.updateOptions=function(e){this._setOptions(e)};this._setOptions=function(e){if(e){if(typeof e.options!=="undefined"){delete e.options}this.options=b.extend(true,{},this.options,e)}};this._createRootNode=function(e){this.$root=b(e)};this._initRootNode=function(){this.$root.attr("id",this.getWidgetId());this.$root.addClass(this._getWidgetPackage());this.$root.addClass(this.getWidgetClass());if(this.options.edition){this.$root.addClass("j_edition_"+this.options.edition)}};this._getWidgetPackage=function(){return"j_widget"};this.getWidgetAssetURL=function(i){var f=$j.session.host.getPeacockRoot();var h=this.getAssetClass(i).replace(/\_/g,"/").replace("j/","jenga/widget/");var g=i?"."+i:"";var e="?v="+$j.session.host.peacockRevision;if($j.session.host.isDev()){e+="&rand="+Math.random()}return f+h+g+e};this.buildEventKey=function(f,e){var g=f+"."+this.getWidgetClass();if(e===true){g+="."+this.getInstanceId()}return g};this._construct(d,c)}})(jQuery);(function(b){var a={};$j.widget=function(d,c,e){$j.plugin(d,function(f){if(b.isFunction(c)){$j.JengaWidget.call(this,f,d);c.call(this);if(typeof a[d]!=="undefined"){for(var g=0;g<a[d].length;g++){a[d][g].call(this)}}}else{b.error("Jenga WidgetPlugin does not have a valid method to call")}},e)};$j.widget.extend=function(d,c){if(typeof a[d]==="undefined"){a[d]=[]}a[d].push(c)}})(jQuery);(function(c){var b=[];var a=false;$j.namespace("$j.mtmpl");$j.namespace("$j.mtmpl.alias");$j.MustacheMixin=function(){var d=null;this.init=function(e){var f={templateClass:this.getWidgetClass()};d=c.extend({},f,e);if(c.inArray(this.getWidgetClass(),b)>-1){return}b.push(this.getWidgetClass());this._loadTemplate()};this.refresh=function(){var e=this;if(!this._isInitialized){$j.log("widget not initialized"+e.getWidgetClass());return}$j.session.hostReady(function(){try{e._onTemplatesReady(function(){var g=e.templates();if(g){e._render(g);e._isRendered=true}else{$j.log("templates not available for "+e.getWidgetClass())}$j.trigger("j_widget_rendered",{className:e._className,id:e._instanceId,instance:e})})}catch(f){$j.log(f);$j.log(e._pluginName)}})};this._render=function(e){};this._onTemplatesReady=function(e){if(this.templates()){e()}else{$j.bind("$j.MustacheMixin.templatesReady."+d.templateClass,e)}};this.templates=function(f){try{if(f!==undefined){$j.mtmpl[this.getWidgetClass()]=f;if(d.templateClass!=this.getWidgetClass()){$j.mtmpl[d.templateClass]=f}}return $j.mtmpl[d.templateClass]}catch(e){$j.log("template error in: "+this.getWidgetClass());return""}};this.getTemplate=function(e){var f=this.templates();if(typeof f[e]=="undefined"){$j.log(e+" not found in "+d.templateClass);return""}return f[e]};this.resolveAlias=function(e){if($j.mtmpl.alias[e]){return $j.mtmpl.alias[e]}return e};this._loadTemplate=function(){var f=this;var h=this.resolveAlias(d.templateClass);if(h.startsWith("j_")){h=h.replace("j_","jenga_widget_")}else{if(h.startsWith("elliott_")){}else{h="chrome_"+h}}if($j.templates[h]){var j=this._getTemplatesFromObject(c($j.templates[h]));if(j){this.templates(j);$j.trigger("$j.MustacheMixin.templatesReady."+d.templateClass);return}}$j.log(">>>>> Did not pre-load templates for $j.templates["+h+"] ");if(this.templates()){return}try{var g=c("."+this.getWidgetClass()).find('script[type="text/html"]');j=this._getTemplatesFromObject(g)}catch(i){$j.log.warn("Could not load a template for "+this.getWidgetClass()+". error=",i)}if(j){this.templates(j);$j.trigger("$j.MustacheMixin.templatesReady."+d.templateClass)}else{$j.session.hostReady(function(){var e=f.getWidgetAssetURL("html");e=e.replace("cdn.lib.newsvine.com","lib.newsvine.com");$j.jsonpload(e,f,function(k){if(k.status!=="success"){$j.log.warn("Could not load a template for this template widget. resp=",k.status);return}var l=f._getTemplatesFromObject(c(k.data));if(l){f.templates(l);$j.trigger("$j.MustacheMixin.templatesReady."+d.templateClass)}},{cache:($j.session.host.isDev()===false)})},this)}};this.getAssetClass=function(f){$root=this.$root;if(f=="html"){var e=this.resolveAlias(d.templateClass);if(e!==d.templateClass){return e}}return d.templateClass};this._getTemplatesFromObject=function(e){var h=false;if(e.length>0){h={};for(var g=0;g<e.length;g++){$tmpl=c(e[g]);if($tmpl.attr("class")){var f=$tmpl.attr("class").replace("template_","");h[f]=$tmpl.html().trim()}}}return h};this.render_template=function(h,i,e,g){i=i||{};if(!i.options){i.options=this.options}if(!i.label){i.label=this.renderLabel}var f=c(c.mustache(h,i,g));if(e&&e.size()>0){e.html(f)}return f};this.render_template_partials=function(f,g,e){return this.render_template(f,g,null,e)};this.append_template=function(g,h,e,f){var i=this.render_template(g,h,null,f);e.append(i);return i};this.renderLabel=function(){return function(f,e){return e($j.session.host.label(f))}}}})(jQuery);(function(b){var a=/\w+\.\w+$/.exec(window.location.hostname);if(a!="today.com"||a!="newsvine.com"||a!="nbcnews.com"||a!="msnbc.com"){a="newsvine.com"}!function(h,j,f,g){if("undefined"==typeof h[g]){h[g]=function(){var i=[];return function(){return arguments.length>=1&&"getSaves"!=arguments[0]&&i.push(arguments),"getSaves"==arguments[0]?i:""}}();var d=j.createElement("script"),c=j.getElementsByTagName("script")[0];d.src=f,c.parentNode.insertBefore(d,c)}}(window,document,"//nvg."+a+"/trackingService/trackingService.min.js","$t")})(jQuery);$j.ts=function(a){if(typeof $t!="undefined"){return $t.apply($t,arguments)}else{return false}};(function(a,b){a.Spinner=b()}(this,function(){var e=["webkit","Moz","ms","O"],o={},n;function g(p,s){var q=document.createElement(p||"div"),r;for(r in s){q[r]=s[r]}return q}function h(q){for(var p=1,r=arguments.length;p<r;p++){q.appendChild(arguments[p])}return q}var i=(function(){var p=g("style",{type:"text/css"});h(document.getElementsByTagName("head")[0],p);return p.sheet||p.styleSheet}());function c(t,p,u,x){var q=["opacity",p,~~(t*100),u,x].join("-"),r=0.01+u/x*100,w=Math.max(1-(1-t)/p*(100-r),t),v=n.substring(0,n.indexOf("Animation")).toLowerCase(),s=v&&"-"+v+"-"||"";if(!o[q]){i.insertRule("@"+s+"keyframes "+q+"{0%{opacity:"+w+"}"+r+"%{opacity:"+t+"}"+(r+0.01)+"%{opacity:1}"+(r+p)%100+"%{opacity:"+t+"}100%{opacity:"+w+"}}",i.cssRules.length);o[q]=1}return q}function m(t,u){var r=t.style,p,q;if(r[u]!==undefined){return u}u=u.charAt(0).toUpperCase()+u.slice(1);for(q=0;q<e.length;q++){p=e[q]+u;if(r[p]!==undefined){return p}}}function f(p,r){for(var q in r){p.style[m(p,q)||q]=r[q]}return p}function k(r){for(var p=1;p<arguments.length;p++){var q=arguments[p];for(var s in q){if(r[s]===undefined){r[s]=q[s]}}}return r}function j(p){var q={x:p.offsetLeft,y:p.offsetTop};while((p=p.offsetParent)){q.x+=p.offsetLeft,q.y+=p.offsetTop}return q}var d={lines:10,length:5,width:4,radius:6,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2000000000,className:"spinner",top:"auto",left:"auto",position:"relative"};function b(p){if(typeof this=="undefined"){return new b(p)}this.opts=k(p||{},b.defaults,d)}b.defaults={};k(b.prototype,{spin:function(y){this.stop();var C=this,q=C.opts,r=C.el=f(g(0,{className:q.className}),{position:q.position,width:0,zIndex:q.zIndex}),B=q.radius+q.length+q.width,D,A;if(y){y.insertBefore(r,y.firstChild||null);A=j(y);D=j(r);f(r,{left:(q.left=="auto"?A.x-D.x+(y.offsetWidth>>1):parseInt(q.left,10)+B)+"px",top:(q.top=="auto"?A.y-D.y+(y.offsetHeight>>1):parseInt(q.top,10)+B)+"px"})}r.setAttribute("role","progressbar");C.lines(r,C.opts);if(!n){var v=0,p=(q.lines-1)*(1-q.direction)/2,u,s=q.fps,x=s/q.speed,w=(1-q.opacity)/(x*q.trail/100),z=x/q.lines;(function t(){v++;for(var E=0;E<q.lines;E++){u=Math.max(1-(v+(q.lines-E)*z)%x*w,q.opacity);C.opacity(r,E*q.direction+p,u,q)}C.timeout=C.el&&setTimeout(t,~~(1000/s))})()}return C},stop:function(){var p=this.el;if(p){clearTimeout(this.timeout);if(p.parentNode){p.parentNode.removeChild(p)}this.el=undefined}return this},lines:function(r,t){var q=0,u=(t.lines-1)*(1-t.direction)/2,p;function s(v,w){return f(g(),{position:"absolute",width:(t.length+t.width)+"px",height:t.width+"px",background:v,boxShadow:w,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*q+t.rotate)+"deg) translate("+t.radius+"px,0)",borderRadius:(t.corners*t.width>>1)+"px"})}for(;q<t.lines;q++){p=f(g(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&c(t.opacity,t.trail,u+q*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"});if(t.shadow){h(p,f(s("#000","0 0 4px #000"),{top:2+"px"}))}h(r,h(p,s(t.color,"0 0 1px rgba(0,0,0,.1)")))}return r},opacity:function(q,p,r){if(p<q.childNodes.length){q.childNodes[p].style.opacity=r}}});function l(){function p(r,q){return g("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',q)}i.addRule(".spin-vml","behavior:url(#default#VML)");b.prototype.lines=function(u,t){var q=t.length+t.width,A=2*q;function z(){return f(p("group",{coordsize:A+" "+A,coordorigin:-q+" "+-q}),{width:A,height:A})}var v=-(t.width+t.length)*2+"px",y=f(z(),{position:"absolute",top:v,left:v}),x;function w(s,r,B){h(y,h(f(z(),{rotation:360/t.lines*s+"deg",left:~~r}),h(f(p("roundrect",{arcsize:t.corners}),{width:q,height:t.width,left:t.radius,top:-t.width>>1,filter:B}),p("fill",{color:t.color,opacity:t.opacity}),p("stroke",{opacity:0}))))}if(t.shadow){for(x=1;x<=t.lines;x++){w(x,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(x=1;x<=t.lines;x++){w(x)}return h(u,y)};b.prototype.opacity=function(r,q,t,s){var u=r.firstChild;s=s.shadow&&s.lines||0;if(u&&q+s<u.childNodes.length){u=u.childNodes[q+s];u=u&&u.firstChild;u=u&&u.firstChild;if(u){u.opacity=t}}}}var a=f(g("group"),{behavior:"url(#default#VML)"});if(!m(a,"transform")&&a.adj){l()}else{n=m(a,"animation")}return b}));(function(a){(function(b){if(!window.Spinner){throw new Error("Spin.js not present")}b(window.jQuery,window.Spinner)}(function(c,b){c.fn.spin=function(e,d){return this.each(function(){var g=c(this),f=g.data();if(f.spinner){f.spinner.stop();delete f.spinner}if(e!==false){e=c.extend({color:d||g.css("color")},c.fn.spin.presets[e]||e);f.spinner=new b(e).spin(this)}})};c.fn.spinCycle=function(d){this.spin();setTimeout(d,10)};c.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}))})(jQuery);!function(c){var a;c(document).ready(function(){c.support.transition=(function(){var f=document.body||document.documentElement,g=f.style,e=g.transition!==undefined||g.WebkitTransition!==undefined||g.MozTransition!==undefined||g.MsTransition!==undefined||g.OTransition!==undefined;return e})();if(c.support.transition){a="TransitionEnd";if(c.browser.webkit){a="webkitTransitionEnd"}else{if(c.browser.mozilla){a="transitionend"}else{if(c.browser.opera){a="oTransitionEnd"}}}}});var d=function(f,e){this.$element=c(f);this.options=e;this.enabled=true;this.fixTitle()};d.prototype={show:function(){var j,f,i,e,h,g;if(this.hasContent()&&this.enabled){h=this.tip();this.setContent();if(this.options.animate){h.addClass("fade")}h.remove().css({top:0,left:0,display:"block"}).prependTo(document.body);j=c.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});f=h[0].offsetWidth;i=h[0].offsetHeight;e=b(this.options.placement,this,[h[0],this.$element[0]]);switch(e){case"below":case"bottom":e="below";g={top:j.top+j.height+this.options.offset,left:j.left+j.width/2-f/2};break;case"above":case"top":e="above";g={top:j.top-i-this.options.offset,left:j.left+j.width/2-f/2};break;case"left":g={top:j.top+j.height/2-i/2,left:j.left-f-this.options.offset};break;case"right":g={top:j.top+j.height/2-i/2,left:j.left+j.width+this.options.offset};break}h.css(g).addClass(e).addClass("in")}},setContent:function(){var e=this.tip();e.find(".twipsy-inner")[this.options.html?"html":"text"](this.getTitle());e[0].className="twipsy"},hide:function(){var f=this,g=this.tip();g.removeClass("in");function e(){g.remove()}c.support.transition&&this.$tip.hasClass("fade")?g.bind(a,e):e()},fixTitle:function(){var e=this.$element;if(e.attr("title")||typeof(e.attr("data-original-title"))!="string"){e.attr("data-original-title",e.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getTitle:function(){var g,e=this.$element,f=this.options;this.fixTitle();if(typeof f.title=="string"){g=e.attr(f.title=="title"?"data-original-title":f.title)}else{if(typeof f.title=="function"){g=f.title.call(e[0])}}g=(""+g).replace(/(^\s*|\s*$)/,"");return g||f.fallback},tip:function(){return this.$tip=this.$tip||c('<div class="twipsy" />').html(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};function b(g,e,f){return typeof g=="function"?g.apply(e,f):g}c.fn.twipsy=function(e){c.fn.twipsy.initWith.call(this,e,d,"twipsy");return this};c.fn.twipsy.initWith=function(n,j,e){var m,l,h,g;if(n===true){return this.data(e)}else{if(typeof n=="string"){m=this.data(e);if(m){m[n]()}return this}}n=c.extend({},c.fn[e].defaults,n);function f(p){var o=c.data(p,e);if(!o){o=new j(p,c.fn.twipsy.elementOptions(p,n));c.data(p,e,o)}return o}function i(){var o=f(this);o.hoverState="in";var p=o.options;if(p.delayIn==0){o.show()}else{o.fixTitle();setTimeout(function(){if(o.hoverState=="in"){o.show()}},p.delayIn)}}function k(){var o=f(this);o.hoverState="out";var p=o.options;if(p.delayOut==0){o.hide()}else{setTimeout(function(){if(o.hoverState=="out"){o.hide()}},p.delayOut)}}if(!n.live){this.each(function(){f(this)})}if(n.trigger!="manual"){l=n.live?"live":"bind";h=n.trigger=="hover"?"mouseenter":"focus";g=n.trigger=="hover"?"mouseleave":"blur";this[l](h,i)[l](g,k)}return this};c.fn.twipsy.Twipsy=d;c.fn.twipsy.defaults={animate:true,delayIn:500,delayOut:0,fallback:"",placement:"above",html:false,live:false,offset:0,title:"title",trigger:"hover",template:'<div class="twipsy-arrow"></div><div class="twipsy-inner"></div>'};c.fn.twipsy.rejectAttrOptions=["title"];c.fn.twipsy.elementOptions=function(j,f){var h=c(j).data(),e=c.fn.twipsy.rejectAttrOptions,g=e.length;while(g--){delete h[e[g]]}return c.extend({},f,h)}}(window.jQuery||window.ender);(function($){var a;$.throttle=a=function(c,d,h,g){var f,b=0;if(typeof d!=="boolean"){g=h;h=d;d=undefined}function e(){var m=this,k=+new Date()-b,l=arguments;function j(){b=+new Date();h.apply(m,l)}function i(){f=undefined}if(g&&!f){j()}f&&clearTimeout(f);if(g===undefined&&k>c){j()}else{if(d!==true){f=setTimeout(g?i:j,g===undefined?c-k:c)}}}if($.guid){e.guid=h.guid=h.guid||$.guid++}return e};$.debounce=function(b,c,d){return d===undefined?a(b,c,false):a(b,d,c!==false)}})(jQuery);(function(a){$j.cookie=function(e,f,c){if(arguments.length>1&&String(f)!=="[object Object]"){c=a.extend({},c);if(f===null||f===undefined){c.expires=-1}if(typeof c.expires==="number"){var h=c.expires,d=c.expires=new Date();d.setDate(d.getDate()+h)}f=String(f);return(document.cookie=[encodeURIComponent(e),"=",c.raw?f:encodeURIComponent(f),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join(""))}c=f||{};var b,g=c.raw?function(i){return i}:decodeURIComponent;return(b=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?g(b[1]):null};if(typeof a.cookie==="undefined"){a.cookie=$j.cookie}$j.cookie.decodeArray=function(j,m,f){var c=$j.cookie(j);var h=[];if(c){var b=c.split(",");for(var e=0;e<b.length;e++){var g=b[e].split(":");if(g.length==m.length){var l={};for(var d=0;d<m.length;d++){l[m[d]]=g[d]}if(f&&g[0]==f){return l}h.push(l)}else{$j.log("cookie field length mismatch")}}}if(f){return null}return h}})(jQuery);(function(a){$j.uri=function(b){return new function(){this.uri=null;this.anchor=null;this.domain=null;this.host=null;this.nodes=new Array();this.params=new Array();this.password=null;this.path=null;this.port=null;this.protocol=null;this.queryString=null;this.subDomain=this.username=null;if(b){this.uri=b;var e=/^((\w+):\/\/)?((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?([\w=\-&]*)/;var c=e.exec(b);this.protocol=c[2];this.username=c[4];this.password=c[5];this.host=c[6];this.port=c[7];this.path=c[8];this.queryString=c[9];this.anchor=c[10];this.nodes=this.host.split(".");if(this.nodes.length<=2){this.domain=this.host;this.subDomain=""}else{this.domain=this.nodes.slice(-2).join(".");if(this.nodes.length==3){this.subDomain=this.nodes[0]}else{this.subDomain=this.nodes.slice(0,this.nodes.length-3)}}if(this.queryString){var g=this.queryString.split("&");for(var d=0;d<g.length;d++){var f=g[d].split("=");if(f.length==1){this.params[f[0]]=null}else{this.params[f[0]]=f[1]}}}}this.isset=function(h){if(typeof(this.params[h])==="undefined"){return false}else{return true}};this.getParam=function(i,h){if(this.params[i]&&typeof this.params[i]!=="function"){if(typeof this.params[i]==="string"){return this.params[i].urldecode()}else{return this.params[i]}}else{return h?h:null}};this.setParam=function(h,i){h=typeof h==="string"?h.urlencode():h;i=typeof i==="string"?i.urlencode():i;h=h.replace("%5B%5D","[]");this.params[h]=i;return this};this.clearParam=function(h){if(this.isset(h)){delete this.params[h]}return this};this.getAnchorParam=function(j,h){if(this.anchor){var k=this.anchor.replace("#","").replace(/=/g,"").replace("&","-").split("-");if(k.length){for(var i=0;i<k.length;i++){if(k[i].substr(0,j.length)===j){return k[i].replace(j,"")}}}}return h||null};this.getAnchorParamIntVal=function(i,h){var j=this.getAnchorParam(i);if(j&&parseInt(j)!==NaN){return parseInt(j)}return h||null};this.getAnchor=function(){return this.anchor};this.setAnchor=function(h){this.anchor=h;return this};this.clearAnchors=function(){this.anchor=null;return this};this.make=function(j){var i=$j.uri(this.uri);if(typeof j==="object"){for(var h in j){i[h]=j[h]}}return i};this.assemble=function(){var k=this.protocol+"://"+(this.username?this.username+(this.password?":"+this.password:"")+"@":"")+this.host+(this.port?":"+this.port:"")+this.path;var h="";var j=false;for(var i in this.params){if(typeof this.params[i]=="function"){continue}if(this.params[i]==undefined){continue}h+=(j?"&":"?")+i;h+=this.params[i]?"="+this.params[i]:"";j=true}if(typeof(this.params.sort)==="string"){h+=(j?"&":"?")+"sort";h+=this.params.sort?"="+this.params.sort:""}if(j){k+=h}if(this.anchor){k+="#"+this.anchor}return k}}}})(jQuery);(function(a){$j.namespace("$j.log");$j.log.enabled=false;$j.log=function(){if($j.uri(window.location).getParam("jlog")||$j.cookie("jlog")){$j.log.enabled=true}$j.session.hostReady(function(){if($j.session.host.isDev()){$j.log.enabled=true}});$j.log.console("info",arguments)};$j.log.console=function(e,b){if(!$j.log.enabled){return}if(typeof console==="undefined"){return}else{if(a.isFunction(console[e])===true){console[e].apply(console,b)}else{if(typeof console[e]!=="undefined"){var d=[];for(var c=0;c<b.length;c++){d[c]=b[c]}console[e](d)}}}};$j.log.warn=function(){$j.log.console("warn",arguments)};$j.log.error=function(){$j.log.console("error",arguments)};$j.log.assert=function(){$j.log.console("assert",arguments)};$j.log.dir=function(){$j.log.console("dir",arguments)}})(jQuery);(function(a){$j.namespace("$j.util");String.prototype.trim=function(){return(this.replace(/^\s*|\s*$/g,""))};String.prototype.startsWith=function(b){return(this.substr(0,b.length)==b)};String.prototype.endsWith=function(b){return(this.substr(this.length-b.length)==b)};String.prototype.urlencode=function(){return encodeURIComponent(this)};String.prototype.urldecode=function(){return decodeURIComponent(this)};String.prototype.striptags=function(){return this.replace(/<\/?[^>]+>/gi,"")};String.prototype.truncate=function(b,d){if(this.length<1||this.maxLen<1){return""}if(!b){b=300}if(this.length>b){var e=this.substring(0,b);if(e){var f=e.split(" ");var c=f.splice(0,f.length-2).join(" ");return c+(d!==undefined?d:"...")}}return this};String.prototype.formatNumber=function(){return this.replace(/\B(?=(\d{3})+(?!\d))/g,",")};$j.util.formatToKs=function(b){if(b>=10000){return Math.round(b/1000)+"k"}else{return String(b).formatNumber()}};$j.util.uid=function(){var b=a(document.body).data("jenga_util_uid");if(typeof b==="undefined"){b=0}a(document.body).data("jenga_util_uid",++b);return b};$j.util.validate_email=function(b){if(b&&b.trim()&&b.match(/[\w\+\.]+[@][\w\-]+([.]([\w\-]+)){1,3}$/)){return true}else{return false}};$j.util.validate_phone=function(b){if(b&&b.trim()){b=b.replace(/[-\(\)]/g,"");if(b.match(/^\d{10}$/)){return true}else{return false}}return false};$j.util.validate_domain=function(b,c){var d=60;var c=typeof c==="undefined"?4:c;if(typeof b!=="string"){return false}b=b.trim();if(b.length>=c&&b.length<=d&&!b.match(/[^a-z0-9\-]/)){return true}else{return false}};$j.util.validate_display=function(c){var d=60;var b=4;if(typeof c!=="string"){return false}c=c.trim();if(c.length>=b&&c.length<=d){return true}else{return false}};$j.util.validate_password=function(b){if(b&&b.trim()&&b.trim().length>3){return true}else{return false}};$j.util.formData=function(b){var c={jsoncallback:1};jQuery.map(a(b).serializeArray(),function(e,d){c[e.name]=e.value});return c};$j.util.dumpObjectToHTML=function(g,b){var d="";var f={};var b=typeof b==="undefined"?true:b;if(g!==null&&typeof g==="object"){d+="<table>";for(var c in g){var e=g[c];if(e===null||typeof e==="string"||typeof e==="number"||typeof e==="boolean"){}else{if(typeof e==="object"){if(b===true){f[c]=$j.util.dumpObjectToHTML(e);c=false}else{e="object"}}else{c=false}}if(c!==false){d+="<tr><td><label>"+c+"</label></td><td>"+e+"</td></tr>"}}if(b===true){for(var c in f){d+="<tr><td><label>"+c+"</label></td><td>"+f[c]+"</td></tr>"}}d+="</table>"}return d};$j.util.toSimpleObject=function(g,b){var h={};var b=typeof b==="undefined"?true:b;if(g===null||typeof g==="undefined"){return null}else{if(typeof g==="function"){return"function"}else{if(typeof g!=="object"){return g}else{if(typeof g.jquery!=="undefined"||typeof g.nodeName!=="undefined"){return"object"}}}}for(var d in g){var f=g[d];if(typeof f==="string"||typeof f==="number"||typeof f==="boolean"){h[d]=f}else{if(typeof f==="object"&&b===true){var e=$j.util.toSimpleObject(f);if(e!=="object"){h[d]=e}}else{if(typeof f==="function"&&b===true){if(f.length===0&&(d.startsWith("is")||d.startsWith("has")||d.startsWith("get"))){var c=f.call(g);var e=$j.util.toSimpleObject(c);if(e!=="object"){h[d]=e}}}else{}}}}return h};a.fn.serializeObject=function(){var b,c;b=this.serializeArray();c={};a.each(b,function(){var d;if(this.value!=null){d=this.value}else{d=""}if(c[this.name]!=null){if(!c[this.name].push){c[this.name]=[c[this.name]]}c[this.name].push(d)}else{c[this.name]=d}});return c};$j.util.flashEnabled=function(){try{return !!(navigator.mimeTypes["application/x-shockwave-flash"]||window.ActiveXObject&&new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(b){}return false};$j.util.isSmallScreen=function(){return a(window).width()<769};$j.util.isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return($j.util.isMobile.Android()||$j.util.isMobile.BlackBerry()||$j.util.isMobile.iOS()||$j.util.isMobile.Opera()||$j.util.isMobile.Windows())}}})(jQuery);(function(a){$j.bind=function(b,d,c){b=b.replace(/\./g,"_").replace("$j","jenga");a(window).bind(b,function(f,e){d.call(c,e,f)})};$j.trigger=function(b,c){b=b.replace(/\./g,"_").replace("$j","jenga");a(window).trigger(b,c)};$j.unbind=function(b){b=b.replace(/\./g,"_").replace("$j","jenga");a(window).unbind(b)};$j.debounce=function(e,b,c){var f;return function d(){var i=this,h=arguments;function g(){if(!c){e.apply(i,h)}f=null}if(f){clearTimeout(f)}else{if(c){e.apply(i,h)}}f=setTimeout(g,b||100)}};$j.script=function(c,d,e,b){if(typeof d==="function"){b=e;e=d;d=null}if(typeof b!=="object"){b={}}if(typeof b.cache==="undefined"){b.cache=true}b.url=b.url?b.url:c;b.dataType="script";b.success=b.success?b.success:function(){if(e){e.apply(d,arguments)}};a.ajax(b)};$j.jsonp=function(c,d,e,b){if(typeof d==="function"){b=e;e=d;d=null}if(typeof b!=="object"){b={}}if(typeof b.cache==="undefined"){b.cache=true}if(b.cache===true){b.jsonpCallback=jenga_callbacks.registerCallback(d,c,e)}b.url=b.url?b.url:c;b.dataType="jsonp";b.crossDomain=true;b.success=b.success?b.success:function(){if(e){e.apply(d,arguments)}};b.callbackParameter="callback";a.jsonp(b)};$j.jsonpload=function(c,d,e,b){if($j.session.uri.protocol==="https"){var c=$j.session.host.getNewsvineRoot(true)+"_api/util/jsonpload?u="+c}else{var c=$j.session.host.getCDNRoot()+"/_api/util/jsonpload?u="+c}$j.jsonp(c,d,e,b)}})(jQuery);var jenga_callbacks={registerCallback:function(b,a,d){var c="id"+a.replace("https://","").replace("http://","").replace(/[^a-zA-Z0-9]+/g,"");jenga_callbacks[c]=function(){d.apply(b,arguments)};return"jenga_callbacks."+c}};(function(a,b){b.namespace("$j.session");b.session.HostConfig=function(){this.isDevMachine=false;this.webRoot=null;this.logoutUrl=null;this.resetPassUrl=null;this.useHTTPS=null;this.mediaPath=null;this.peacockPath=null;this.peacockRevision=null;this.domainName=null;this.displayName=null;this.domainRoot=null;this.regDomain=null;this.tinyMCERoot=null;this.jsonServer=null;this.amazonImageServer=null;this.routingNode=null;this.domainRootLabel=null;this.sharingVariable=null;this.tokens=null;this.labels=null;this.maxNations=0;this.ignoreStates="cirx";this.deviceType="desktop";this.msnbcServer=null;this.privacyLink=null;this.termsLink=null;this.rulesLink=null;this.resultsLabel=null;this.chatServer=null;this.socketKey=null;this.brandSocketKey=null;this.twitterAccount=null;this.brandLabel=null;this.bitlyCnx=false;this.discuss_hashtags=null;this.groupType=null;this.init=function(){};this.initFromKeyValues=function(d){for(var c in d){this[c]=d[c]}if(typeof this.webRoot==="string"){this.webRoot=this.webRoot.replace(/www.(polls|cdn|new).newsvine.com/,"www.newsvine.com")}this.init();return this};this.isDev=function(){return this.isDevMachine};this.hasRegDomain=function(){return this.regDomain&&(this.regDomain.indexOf(this.domainRoot)>-1)};this.getFacebookConfig=function(){return this.facebookConfig};this.getJsonServer=function(c){if(c){return this.jsonServer}return this.jsonServer.replace("polls.","")};this.getNJS=function(){return"//secure.msnbc.com/service/"};this.getPublishServer=function(f,c){var e;if(f==="photo_post"){e="photo"}else{if(f==="video_post"){e="video"}else{if(f==="seed_post"){e="seed"}else{if(f==="blog_post"){e="blog"}else{e="article"}}}}var d=this.webRoot+"/_tps/_publish/"+e;if(c===true){if(b.session.uri.subDomain+""!=="www"){d+="?domainName="+b.session.uri.subDomain}else{d+="?domainName=testblog"}}return d};this.getRoutingNode=function(c){c=typeof c==="undefined"?"":c;if(this.isDev()||typeof HOSTCONFIG_SERVER!=="undefined"){return b.session.uri.nodes[1]+c}else{return""}};this.getPeacockRoot=function(){return this.peacockPath};this.getMediaRoot=function(){return this.mediaPath};this.getCDNRoot=this.getMediaRoot;this.getTinyMCERoot=function(){return(this.tinyMCERoot?this.tinyMCERoot:this.regDomain)};this.getDomainRoot=function(){return this.domainRoot};this.buildServistaURL=function(d){d=a.extend({service:null,land:null,redirect:null,task:null,template:null,ssl:false,data:{}},d);var e=b.uri(this.getRegDomainRoot(d.ssl)+"_login/proxy");e.setParam("path","/servista/"+d.service);e.setParam("t",d.task);e.setParam("template",d.template);e.setParam("land",d.land);e.setParam("rd",d.redirect);if(d.data){for(var c in d.data){e.setParam(c,d.data[c])}}return e.assemble()};this.getRegAffiliate=function(){switch(this.domainName){case"business":case"politics":case"health":case"travel":case"world-news":case"technology-science":return"nbcnews.com";default:return this.getDomainRoot()}};this.getRegDomainRoot=function(d){var e=[];var c=b.cookie("rsvr");if(c){e=c.split("|");if(this.domainRoot==="newsvine.com"){return e[0]+"://www."+e[1]+"."+this.domainRoot+"/"}else{return e[0]+"://secure."+e[1]+"."+this.domainRoot+"/"}}if(d===false||this.useHTTPS!==true){if(this.domainRoot==="newsvine.com"){return"http://www."+this.domain+"/"}else{return"http://"+this.regDomain+"/"}}else{return"https://"+this.regDomain+"/"}};this.getNewsvineRoot=function(c){var d=this.webRoot+"/";if(c===true&&this.useHTTPS){d=d.replace("http://","https://")}return d};this.getAPIPath=function(d,c,f){var e=null;if(f===true){e=this.getCDNRoot()+"/"}else{e=this.getRegDomainRoot(window.location.protocol==="https:"||d)}if(c===true){e+="_nv/api/"}else{e+="_api/"}return e};this.getAccountSettingsPath=function(){return this.getRegDomainRoot(true)+"_tps/accounts/global/settings?multiDomainLogin=true"};this.getLogoutUrl=function(e,c){if(typeof e==="undefined"&&!c){e=location.href}if(e!==false){var d=b.uri(this.logoutUrl);d.setParam("redirect",e);return d.assemble()}else{return this.logoutUrl}};this.getResetPassUrl=function(c,f){var d=b.uri(this.resetPassUrl);d.setParam("email",c);if(f){var e=b.uri(f);e.protocol=d.protocol;d.setParam("rdRedirect",e.assemble())}return d.assemble()};this.getJSONPEndpoint=function(c){return this.getAPIPath(c,false)+"user/JSONPEndpoint"};this.crossDomainSupport=function(){return("withCredentials" in new XMLHttpRequest())};this.getUserDataUrl=function(c,e){c=typeof c==="undefined"?false:c;var d=this.getAPIPath(c,false)+"user/getUserData";if(e){if(this.crossDomainSupport()){d=d+"XHR"}else{d="/_api/user/getUserDataSO"}}if(this.domainName){d+="?domainName="+this.domainName}return d};this.label=function(g){if(b.session.host.labels){var e=b.session.host.labels[g.toLowerCase()];if(e){var d="";var f=g.charAt(0);var c=(g.length>1?g.charAt(1):"");if(e.length>1&&f.toLowerCase()!==f&&c.toLowerCase()===c){d=e.charAt(0).toUpperCase()+e.slice(1)}else{if(f.toLowerCase()!==f){d=e.toUpperCase()}}return d}}return g};this.getOptimizleyTest=function(c){if(typeof window.optimizely_drupal!=="undefined"&&window.optimizely_drupal[c]){return true}return false};this.getTestBucket=function(h){var e={faceBook:{schedual:{start:"2014/01/14 13:50:00",end:"2014/01/14 13:51:00"},a:50,b:50}};if(e[h]){var j=true;if(e[h].schedual){var c=e[h].schedual.start?new Date(e[h].schedual.start):false;var f=e[h].schedual.end?new Date(e[h].schedual.end):false;var d=new Date();if(c&&c<=d){if(f&&f<=d){j=false}}else{j=false}}if(j){var g=h.charCodeAt(0)*h.length;var k=a.cookie("vid");var m=0;if(k!==null){k=k.substr(k.length-6);m=(g^(parseInt(k,16)%100000000))%100;var i=0;for(var l in e[h]){if(l!=="schedual"){i+=e[h][l];if(m<=i){return l}}}}return m}else{return null}}else{return null}}}})(window.jQuery,window.$j);(function(b){$j.Meta=function(){var g=this;g.address=g.cleanAddress(a("nv:address"));g.tags=a("nv:tags");g.author=a("nv:author");g.pubDate=a("nv:date");g.ogDescription=a("og:description");g.title=a("nv:title");g.videoId=a("nv:videoId");g.contentType=a("nv:contentType");var i=a("nv:contentId");g.contentId=i&&(typeof(i*1)==="number")?i*1:null;g.legacyAddress=!g.contentId&&isNaN(a("nv:contentId"))?g.cleanAddress(a("nv:contentId")):null;if(g.address){if(g.address.indexOf("msnbc.com/now")==(g.address.length-13)){var h=new Date();h.setTime((new Date()).getTime()-9*60*60*1000);var e=h.toISOString();var f=e.split("T");var c=f[0].replace("-","/").replace("-","/");g.address=g.address+"/"+c}}};var a=function(d){var c=b('meta[property="'+d+'"]');if(c.length>0){return c.attr("content")}return null};$j.Meta.prototype.cleanAddress=function(c){if(c){if($j.session.host){c=c.replace("localhost:9001",$j.session.host.getDomainRoot())}var d=c.split("#");c=d[0];if($j.session.host){if(c.substring(0,4)!=="http"){if(c.substring(0,1)==="/"){c="http://"+window.location.hostname+c}else{c="http://"+window.location.hostname+"/"+c}}}}return c};$j.Meta.prototype.isPermalink=function(c){if(c.contentId&&this.contentId===c.contentId*1){return true}if(c.address){var d=$j.uri(window.location);if(d.path==$j.uri(c.address).path){return true}}return false}})(jQuery);(function(a){$j.namespace("$j.session");$j.session.Poke=function(){this.$img=false;this.pokeURL=false;this.init=function(c){this.pokeURL=c||"http://log.newsvine.com/poke.gif";if(location.protocol==="https:"){this.pokeURL=this.pokeURL.replace("http://","https://")}var b=this;a(document).ready(function(){b.$img=a("img#poke");if(!b.$img.get(0)){b.$img=a('<img id="poke" alt="Tracking Image" width="0" height="0" style="display:none;"/>').appendTo(a(document.body))}$j.trigger("$j.session.Poke.isReady")})};this.doPoke=function(e,h,f){var c=this.pokeURL+"?get="+e+"&x="+h;var g=f&&encodeURIComponent(decodeURIComponent(a.param(f)));if(g!=null){c+="&d="+g}c+="&jenga&rand="+Math.floor(Math.random()*1000000000);if(this.$img===false){var b=this;$j.bind("$j.session.Poke.isReady",function(){b.doPoke.call(b,e,h,f)})}else{this.$img.attr("src",c)}$j.trigger("jenga_poke",[[e,h,f]])}}})(jQuery);(function(a){$j.namespace("$j.session.UserPermissions");$j.session.GROUP_PUBLIC_DISCUSSION="_public_";$j.session.UserPermissions=function(){this.perms={};this.group_perms={};this.groups_delegated=null;this.init=function(d,c,b){this.perms=d;this.group_perms=c;this.groups_delegated=b};this.SCOPE_CONTENT="content";this.SCOPE_GROUP="groups";this.GROUP_PUBLIC_DISCUSSION=$j.session.GROUP_PUBLIC_DISCUSSION;this.canChangeMemberState=function(d,c,b){if(typeof b=="undefined"){b=""}if(!d){$j.log("canChangeMemberState: access denied, no group provided.");return false}groupType=d.groupTypeId%100;assignerState=$j.session.user.getGroupAss(d.domainName);if($j.session.user.isAdmin()){assignerState="s"}if(!assignerState){assignerState="x"}if(this.group_perms&&this.group_perms[groupType]&&this.group_perms[groupType][assignerState]&&this.group_perms[groupType][assignerState][b]){if((targets=this.group_perms[groupType][assignerState][b])!=null){return targets.indexOf(c)!=-1}}if(this.perms.groups&&(d.domainName!==$j.session.GROUP_PUBLIC_DISCUSSION)&&(assignerState=="x")&&(c=="x")&&this.perms.groups[d.domainName]&&this.perms.groups[d.domainName]["canComment"]){return true}return false};this.getPermission=function(d,c,b){if(!this.perms){return false}if(c&&!b){return false}if(this.perms[c]&&this.perms[c][b]&&(this.perms[c][b][d]!==undefined)){return this.perms[c][b][d]}return this._getDefaultPerm(d)};this.canEditContent=function(b){if(b.type=="group"){for(group in this.perms.groups){if(group==b.domainName&&$j.session.user.getGroupAss(group)=="a"){return true}}}else{if(b.type=="user"){if($j.session.user.domainName==b.domainName){return true}}}return false};this._getDefaultPerm=function(b){if(!this.perms){return false}if(this.perms.defaults&&this.perms.defaults[b]==1){return true}return false}}})(jQuery);(function(c){$j.namespace("$j.session");$j.ts("register",["nv_user_login","nv_user_logout"]);var b=false;var a=false;$j.session.User=function(){this.noES=null;this.loginState=-1;this.email=null;this.domainName=null;this.displayName=null;this.url=null;this.avatar=null;this.secure_avatar=null;this.affiliations=null;this.msnbc_sharing_optout=false;this.today_sharing_optout=false;this.sailor=true;this.lastSeen=null;this.memberSince=null;this.numArticles=0;this.numComments=0;this.numSeeds=0;this.vinacity="000000";this.isPotentialSpammer=false;this.geo={zip:null,city:null,country:null};this.wordFilters=null;this._last_fb_postId=null;this.$event_node=false;var h=-1;var g=1;var f=2;var d="Newsvine";var e="facebook:";this.init=function(){};this.initFromKeyValues=function(i,j){this.noES=i.noES?i.noES*1:0;this.email=i.email||null;this.domainName=i.domainName||null;this.displayName=i.displayName||null;this.firstName=i.firstName||null;this.lastName=i.lastName||null;this.avatar=i.avatar||null;this.avatar_secure=i.avatar_secure||null;this.loginState=i.loginState?i.loginState*1:-1;this.validated=i.isValidated?i.isValidated*1:0;this.registered=i.isRegistered?i.isRegistered*1:0;this.url=i.url||null;this.affiliations=i.affiliation||"";this.lastPub=i.lastPub||1;this.isPotentialSpammer=i.isPotentialSpammer;this.msnbc_sharing_optout=i.msnbc_sharing_optout===true?true:false;this.today_sharing_optout=i.today_sharing_optout===true?true:false;this.sailor=i.sailor;this.geo.zip=i.zip||null;this.geo.city=i.city||null;this.geo.country=i.country||null;this.gender=i.gender;this.birthdate=i.birthdate;this.phone=i.phone;this.needs_password=i.needs_password;this.beta=i.isBetaUser;if(i.assumedUser){c("body").addClass("c-assumed")}this.lastSeen=i.lastSeen&&$j.date.format("M, Y",i.lastSeen);this.memberSince=i.memberSince;if(this.loginState){this.numArticles=i.numArticles;this.numComments=i.numComments;this.numSeeds=i.numSeeds;this.vinacity=i.vinacity}if(i.access){this.access=i.access}this.init();if(!b){b=true;if(typeof j==="function"){j();$j.log("user init callback");j=null}}$j.session.PersLoader.init(this,j)};this.login=function(j,i){this.initFromKeyValues(j,function(){$j.ts("track","nv_user_login",{loginType:i,userObj:$j.session.user});$j.session.user.trigger("j_session_user_login",[i])})};this.onLogin=function(i,j){if(typeof i==="function"){j=i;i=null}this.bind("j_session_user_login",function(k,l){j.call(i,this,l)},this)};this.logout=function(i){$j.ts("track","nv_user_logout",{userObj:$j.session.user});$j.jsonp($j.session.host.getLogoutUrl($j.session.host.getJSONPEndpoint()),(typeof i==="function"?i():function(){}))};this.onSharingSet=function(i,j){if(typeof i==="function"){j=i;i=null}this.bind("j_session_user_sharing_set",function(){j.call(i,this)},this)};this.getEventNode=function(){return c(window)};this.bind=function(i,k,j){this.getEventNode().bind(i,function(){k.apply(j,arguments)})};this.trigger=function(i,j){this.getEventNode().trigger(i,j)};this.isPassiveLogin=function(){if(this.loginState===f){return true}else{return false}};this.isActiveLogin=function(){if(this.loginState===g&&this.isLoggedIn()){return true}else{return false}};this.isValidated=function(){return this.isLoggedIn()&&this.validated};this.isRegistered=function(){return this.isLoggedIn()&&this.validated&&this.registered};this.isLoggedIn=function(){if(this.loginState>h){return true}else{return false}};this.isEmployee=function(){return(this.access&&this.access.isEmployee?true:false)};this.isAdmin=function(){return(this.access&&this.access.isAdmin?true:false)};this.isFBS=function(){return true};this.getAffiliations=function(){if(typeof this.affiliations==="string"){return this.affiliations.split(",")}else{return[]}};this.getAffiliation=function(k){var j=this.getAffiliations();for(var i in j){if(j[i]===k||(typeof j[i]==="string"&&j[i].startsWith(k))){return j[i]}}return false};this.hasAffiliation=function(i){return this.getAffiliation(i)===false?false:true};this.hasFacebookAff=function(){return this.hasAffiliation(e)};this.isSharing=function(){var i=$j.session.host.sharingVariable;if(i===null){return false}if(this.isLoggedIn()===false){return $j.cookie("sharing_optout")==="true"?false:true}if(typeof this[i]==="undefined"){return false}else{return !(this[i])}};this.isFacebookSharing=function(){if(this.isSharing()&&this.hasFacebookAff()){return true}else{return false}};this.setSharing=function(l,i){if(typeof i==="undefined"){i=false}var n=$j.session.host.sharingVariable;if(n===null){return false}if(typeof this[n]==="undefined"||typeof $j.session.host.tokens[n]==="undefined"){return false}if(l===false){$j.cookie("sharing_optout",true,{expires:3650,path:"/",domain:$j.session.host.cookieDomain})}else{$j.cookie("sharing_optout",false,{expires:-1,path:"/",domain:$j.session.host.cookieDomain})}if(this.isLoggedIn()){this[n]=!l;var m=$j.session.host.tokens[n];var j=l===true?"0":"1";var k=$j.uri($j.session.host.getAPIPath(false,true)+"users/SetToken");k.setParam("set",j);k.setParam("tokenId",m);$j.jsonp(k.assemble(),this,function(o){},{cache:false})}if(i===false){this.trigger("j_session_user_sharing_set")}};this.share=function(i){var j=i.connected;c.extend(i,{connected:{scope:this,callback:function(m){if(m&&m.id&&isNaN(m.id*1)===false){this.set_last_postId(m.id)}else{if(m&&m.error&&m.error.type==="OAuthException"){var l=typeof m.error.message==="string"?m.error.message:"";if(l.startsWith("(#3501)")){var k=l.split(" ");if(k.length>0&&isNaN(k[k.length-1]*1)===false){this.set_last_postId(k[k.length-1])}}}}j.callback.call(j.scope,m)}}});if(this.isFacebookSharing()){$j.fb.share(i)}};this.set_last_postId=function(i){this._last_fb_postId=i};this.unshare=function(i){if(isNaN(this._last_fb_postId*1)===false){$j.fb.unshare(this._last_fb_postId,i)}};this.stripProfanityNode=function(i){if(this.sailor){return i}var j=[];c("a",i).each(function(){j.push(c(this).attr("href"))});c("*",i).andSelf().each(function(){if(this.nodeType==1&&c(this).text()){var k=c(this).html();var l=$j.session.user.stripProfanity(k);if(k!=l){c(this).html(l)}}});c("a",i).each(function(k){c(this).attr("href",j[k])})};this.stripProfanity=function(o){if(this.sailor){return o}if(this.wordFilters===null){var j=$j.session.host.wordFilters.regexpA;var i=$j.session.host.wordFilters.regexpL;var m=$j.session.host.wordFilters.regexpR;var n=$j.session.host.wordFilters.regexpE;this.wordFilters={reA:j?new RegExp(j,"gi"):null,reL:i?new RegExp("("+i+")(\\w*)","gi"):null,reR:m?new RegExp("(\\w*)("+m+")(\\s)","gi"):null,reE:n?new RegExp("(\\W)("+n+")(\\W)","gi"):null}}var k="@!$%#";if(this.wordFilters.reA){o=o.replace(this.wordFilters.reA,k)}if(this.wordFilters.reL){o=o.replace(this.wordFilters.reL,k+"$2")}if(this.wordFilters.reR){o=o.replace(this.wordFilters.reR,k+"$3")}if(this.wordFilters.reE){o=o.replace(this.wordFilters.reE,"$1"+k+"$3")}return o};this.getAvatar=function(i){if(!i){i=120}return this.avatar?$j.avatar.getSizedAvatarURL(window.location.protocol==="https:"?this.avatar_secure:this.avatar,i):$j.avatar.getDefaultAvatar(i)};this.getURL=function(){if(this.url){return this.url}else{var i="http://"+this.domainName+"."+$j.session.host.getRoutingNode(".")+"newsvine.com";return i}};this.buildLink=function(){var i=c('<a href="'+this.getURL()+'">'+this.displayName+"</a>");return i};this.getGeoLocation=function(j,k){if(typeof j==="function"){k=j;j=null}var i=this;if(this.geo.city===null){$j.session.UserLoader.getUserData(function(l){i.geo.city=l.city;i.geo.country=l.country;i.geo.zip=l.zip;k.call(j,i.geo)})}else{k.call(j,this.geo)}};this.addRecent=function(k,j){if(!j){j=1}var i={};i[k]={};i[k][j]=c.now();c.extend(this.latestThreads,i)};this.isRecentContent=function(l,k){if(!jQuery.isEmptyObject(this.latestThreads)){if(jQuery.makeArray(this.latestThreads).length&&this.latestThreads[l]){if(k&&this.latestThreads[l][k]){return this.latestThreads[l][k]}var j=0;for(var i in this.latestThreads[l]){if(this.latestThreads[l][i]>j){j=this.latestThreads[l][i]}}if(j){return j}}}return false};this.setVid=function(){var k=new Date();
var i=k.getTime();var j={expires:new Date(i+3600*1000*24*365*20),path:"/",domain:$j.session.host.cookieDomain};$j.jsonp($j.session.host.getNewsvineRoot(false)+"_api/user/anonymous",function(l){$j.cookie("vid",l.data.vid,j);$j.cookie("_nv",1,j);$j.session.UserLoader.triggerVidReady()})};this.getGroups=this.getGroup=this.getGroupAss=this.getAvailableNations=this.isFullMemberState=function(){$j.log("groups not ready; use $j.session.groupsReady");return null};this.get_underage_cookie=function(){return $j.cookie("nv-u13")};this.set_underage_cookie=function(j,k,i){if(k&&i){$j.cookie("nv-u13",(k)+"-"+i+"-"+j,{expires:1})}else{$j.cookie("nv-u13",j,{expires:1})}$j.cookie("P2",null)}};$j.session.UserLoader={isRegisteredUser:function(){if(c.cookie("vid")==null){return false}else{if(c.cookie("vid").charAt(0)!=="v"){return false}else{return true}}},getUserData:function(f){var e=$j.uri(window.location);var d=$j.session.host.crossDomainSupport();if(d||$j.session.host.domainRoot==="newsvine.com"){c.ajax({type:"GET",crossDomain:false,url:$j.session.host.getUserDataUrl(true,true),async:true,contentType:"text/plain",success:function(g){f.call(this,g.data)},error:function(h,i,g){$j.log(i);$j.log(g)},xhrFields:{withCredentials:true}})}else{$j.jsonp($j.session.host.getUserDataUrl(false,false),function(g){f.call(this,g.data)},{cache:false})}},init:function(d,f){var e={loginState:(d.loginState?d.loginState:-1)};if($j.session.UserLoader.isRegisteredUser()===true&&$j.cookie("_nv")==1){$j.session.UserLoader.triggerVidReady();$j.session.UserLoader.getUserData(function(g){d.initFromKeyValues(g,f)})}else{if(e){if(document.cookie.length>0&&(!$j.cookie("_nv")||!$j.cookie("vid"))){d.setVid();d.initFromKeyValues(e,f)}else{$j.session.UserLoader.triggerVidReady();d.initFromKeyValues(e,f)}}}},triggerVidReady:function(){a=true;$j.trigger("j_session_userLoader_vidReady")},onVidReady:function(e,f){if(typeof e==="function"){f=e;e=null}if(a){var d=$j.cookie("vid");f.call(e,this,d)}else{$j.bind("j_session_userLoader_vidReady",function(h){var g=$j.cookie("vid");f.call(e,this,g)},this)}}}})(jQuery);(function(b){$j.namespace("$j.session");var a=false;$j.session.Pers=function(c){c.tracker=null;c.watchlist=[];c.groups=[];c.latestThreads={};c.permissions={};c.getTrackerCount=function(){return c.tracker.count};c.getWatchlistItem=function(d){return c.watchlist[d]};c.isInWatchlist=function(d){if(c.getWatchlistItem(d)){return true}else{return false}};c.getGroups=function(f,e){var d=[];if(f){for(var h=0;h<c.groups.length;h++){if($j.group_actions.isInGroup(c.groups[h].ass)){d.push(c.groups[h])}}}else{d=c.groups}if(e===true){return d.slice(0,$j.session.host.maxNations)}else{return d}};c.getGroup=function(d){if(!c.isLoggedIn()){return null}if(c.permissions.groups_delegated&&c.permissions.groups_delegated[d]){d=c.permissions.groups_delegated[d]}for(var e=0;e<c.groups.length;e++){if(c.groups[e]&&(c.groups[e].domainName==d)){return c.groups[e]}}return null};c.getGroupAss=function(d){var e=$j.session.user.getGroup(d);return(e?e.ass:null)};c.getAvailableNations=function(){if(c.isLoggedIn()){var d=$j.session.host.maxNations;for(var e=0;e<c.groups.length;e++){if(c.groups[e]&&c.isFullMemberState(c.groups[e].ass)){d--}}}return d};c.isFullMemberState=function(d){if(!d){return false}return($j.session.host.ignoreStates.indexOf(d)===-1)}};$j.session.PersLoader={initFromKeyValues:function(c,d){$j.session.Pers(c);c.tracker=d.tracker||null;c.watchlist=d.watchlist||{};c.permissions=new $j.session.UserPermissions();if(d.permissions){c.permissions.init(d.permissions||null,d.group_permissions||null,d.groups_delegated||null)}if(d.groups){c.groups=d.groups}if(d.ignoreList){c.ignoreList=d.ignoreList}if(d.latestThreads){c.latestThreads=d.latestThreads}},init:function(e,d){var c=this;if(!$j.session.config.load_pers){if(typeof d==="function"){d()}return}if($j.session.UserLoader.isRegisteredUser()===true){$j.session.hostReady(function(g){var f=$j.uri(g.getAPIPath(false,false,false)+"user/getPersData");var h=new $j.Meta();f.setParam("domainName",$j.session.host.domainName);f.setParam("contentId",h.contentId);f.setParam("contentType",h.contentType);$j.jsonp(f.assemble(),function(i){c.initFromKeyValues(e,i.data);$j.session.pers=e;if(typeof d==="function"){d()}if(!a){$j.log("pers loaded");a=true;$j.trigger("$j.session.persIsReady")}},{cache:false})})}else{c.initFromKeyValues(e,{});$j.session.pers=e;if(typeof d==="function"){d()}$j.log("pers loaded not registered");$j.trigger("$j.session.persIsReady")}}}})(jQuery);(function(a){$j.namespace("$j.session");$j.ts("register",["nv_user_meta"]);a.extend($j.session,{uri:false,host:false,user:false,pers:false,poke:false,reportError:false,isReady:false,isWindowReady:false,config:{when_to_init:"after_dom_ready",load_pers:true},loadConfig:function(){try{var b=a.parseJSON(a('meta[name="jenga-session-config"]').attr("content"));if(b){$j.session.config=a.extend(true,{},$j.session.config,b)}}catch(c){$j.log.warn("Failed to load jenga session config.")}},ready:function(d,c){if($j.session.isReady===true){try{d.call(c,$j.session.user)}catch(b){$j.log(b)}}else{$j.bind("$j.session.isReady",function(){try{d.call(c,$j.session.user)}catch(e){$j.log(e);if(e["get stack"]){$j.log(e["get stack"]())}}})}},windowReady:function(c,b){if($j.session.isWindowReady===true){c.call(b)}else{a(window).load(function(){c.call(b)})}},hostReady:function(c,b){if($j.session.host===false){$j.bind("$j.session.hostIsReady",function(){c.call(b,$j.session.host)})}else{c.call(b,$j.session.host)}},persReady:function(c,b){if($j.session.pers===false){$j.bind("$j.session.persIsReady",function(){c.call(b,$j.session.pers)})}else{c.call(b,$j.session.pers)}},groupsReady:function(c,b){$j.session.persReady(c,b)},checkReady:function(){if($j.session.isReady===true){return true}else{if($j.session.host===false){return false}else{if($j.session.user===false){return false}else{$j.session.isReady=true;$j.trigger("$j.session.isReady");return true}}}},init_host:function(f){$j.session.uri=$j.uri(location.href);var e=$j.session.uri.host;if(typeof jenga_remote_host!=="undefined"){e=jenga_remote_host}else{if($j.session.uri.host==="file"){e="www.newsvine.com"}else{if(typeof REMOTE_HOST_OVERRIDE!=="undefined"){e=REMOTE_HOST_OVERRIDE}else{if(a('meta[property="og:site_name"]').length){var c=a('meta[property="og:site_name"]').attr("content");if(c==="TODAY.com"){e="today.com"}else{if(c==="NBC News"){e="nbcnews.com"}}}}}}if(typeof HOSTCONFIG_SERVER!=="undefined"){var b=HOSTCONFIG_SERVER}else{if($j.session.uri.protocol==="https"){var b="https://www.newsvine.com/"}else{var b="http://www.polls.newsvine.com/"}}function d(g){$j.session.host=(new $j.session.HostConfig()).initFromKeyValues(g);if(typeof f==="function"){f.call(this)}$j.trigger("$j.session.hostIsReady");$j.session.checkReady()}$j.jsonp(b+"_api/hostConfig?remoteHost="+e,d)},init_poke:function(){var b=new $j.session.Poke();b.init();$j.session.poke=function(){b.doPoke.apply(b,arguments)};$j.session.reportError=function(c){if($j.session.host&&$j.session.host.isDev()){$j.log("$j.session.reportError=",c)}};window.onerror=function(e,d,c){e=d+":"+c+":"+e;if(e.indexOf("xpopup")>-1){return}$j.session.reportError(e)}},init_elliott_tracking:function(){a(document).ready(function(){if(typeof a.fn.j_track!=="undefined"){a("body").j_track()}})},init_user:function(){var b=new $j.session.User();$j.session.UserLoader.init(b,function(){$j.session.user=b;$j.session.checkReady()})},refresh_user:function(c){var b=new $j.session.User();$j.session.UserLoader.init(b,function(){$j.session.user=b;if(c){c()}})},check_jquery_version:function(){var b=(a().jquery).split(".");if(b&&(b[0]*1<2)&&(b[1]*1<5)){$j.log("ALERT... jenga requires at least jQuery 1.5.1 or newer.")}},init:function(){if($j.session.isReady===true){return}$j.session.check_jquery_version();a(window).load(function(){$j.session.isWindowReady=true});$j.session.init_host($j.session.init_user);$j.session.init_poke();$j.session.init_elliott_tracking();$j.ModuleLoader.autoload()}});$j.session.loadConfig();$j.log("jQuery v",a().jquery,"; jenga v",3.622,$j.session.config.when_to_init);if($j.session.config.when_to_init==="asap"){$j.session.init()}else{if($j.session.config.when_to_init==="after_dom_ready"||document.readyState==="complete"){a(document).ready(function(){$j.session.init()})}else{if($j.session.config.when_to_init==="after_window_ready"){a(window).load(function(){$j.session.isWindowReady=true;$j.session.init()})}}}$j.session.ready(function(b){$j.log("$j.session.isReady",$j.session);var c=b.isLoggedIn();if(c){$j.log("Hello, "+b.displayName,b)}else{$j.log("User is not logged in",b)}$j.ts("track","nv_user_meta",{isLoggedIn:c,displayName:c&&b.displayName})})})(jQuery);(function(a){a(function(){$j.ts("register",["nv_regtracking_start","nv_regtracking_submit","nv_regtracking_validated","nv_regtracking_complete","nv_regtracking_submitclick"]);var d=function(k,h){var g=k.type;if(!$j.session.user.isLoggedIn()){var j="email";var i=h.product?h.product:"";var l="";var f="";if(g.indexOf("_click")!=-1){j="social";l=g.split("_nv_zinger2_")[1].split("_click")[0];f=h.register_state}$j.ts("track","nv_regtracking_start",{regType:j,socType:l,user:$j.session.user,product:i,regState:f},{persistent:true})}};var b=function(i,f){switch(f.eventType){case"nv_user_login":var j=f.eventData.userObj;var g=f.eventData.loginType;var l=$j.ts("eventLog").nv_regtracking_start&&$j.ts("eventLog").nv_regtracking_start.product?$j.ts("eventLog").nv_regtracking_start.product:"";var m=false;var k="";var n=false;g=(typeof g=="string")?g:"";if(g=="register"){m="email";if($j.ts("eventLog").nv_regtracking_start&&$j.ts("eventLog").nv_regtracking_start.regType=="social"){m="social";k=$j.ts("eventLog").nv_regtracking_start.socType}}if((Date.now()-(j.memberSince*1000))<300000){n=true}if(g.indexOf("_signup")!=-1||g.indexOf("_signin")!=-1&&n){m="social";k=g.split("_signup")[0].split("_signin")[0]}if(m){$j.ts("track","nv_regtracking_submit",{regType:m,socType:k,user:j,product:l});if(m=="social"&&j.isRegistered()){$j.ts("track","nv_regtracking_complete",{regType:"social",socType:k,user:j,product:l})}}break;case"_nv_accounts_register_submit":var l=f.eventData.product?f.eventData.product:"";$j.ts("track","nv_regtracking_submit",{regType:"email",user:null,product:l});break;case"nv_newsletter_subscribe":var l=f.eventData.product?f.eventData.product:"";var h=f.eventData.title?f.eventData.title:"";$j.session.ready(function(){if(!$j.session.user.email){$j.ts("track","nv_regtracking_submit",{regType:"newsletter",user:null,product:l,title:h})}});break}};$j.ts("bindTrack",b);$j.ts("on",["_nv_accounts_register_submit"],function(g,f){b.apply(this,[g,{eventType:"_nv_accounts_register_submit",eventData:f}])});$j.ts("on",["_nv_accounts_register_start","_nv_accounts_register_onsite_start","_nv_zinger2_register_start","_nv_zinger2_twitter_click","_nv_zinger2_facebook_click","_nv_zinger2_google_click"],d);$j.ts("on","_nv_zinger2_registerclick",function(g,f){$j.ts("track","nv_regtracking_submitclick")});$j.ts("bindTrack",function c(g,f){switch(f.eventType){case"nv_regtracking_start":case"nv_regtracking_submit":case"nv_regtracking_validated":case"nv_regtracking_complete":a(function(){var h=f.eventType+"_"+f.eventData.regType;if(f.eventData.regType=="social"){h+="_"+f.eventData.socType}if(f.eventData.product){h+="_"+f.eventData.product}var e=3;var i=setInterval(function(){e--;if(typeof ga!="undefined"){ga("send","event","nv_registration",h,$j.cookie("vid"));clearInterval(i)}else{if(e<=0){clearInterval(i)}}},1000)});break}})});a(function(){$j.session.ready(function(){var c="email";var b="";var d="";if($j.ts("eventLog").nv_regtracking_start){c=$j.ts("eventLog").nv_regtracking_start.regType;d=$j.ts("eventLog").nv_regtracking_start.socType?$j.ts("eventLog").nv_regtracking_start.socType:"";b=$j.ts("eventLog").nv_regtracking_start.product}if($j.cookie("usrRegComp")){$j.ts("track","nv_regtracking_complete",{regType:c,socType:d,user:$j.session.user,product:b});$j.cookie("usrRegComp",null,{path:"/",domain:$j.session.host.domainRoot})}if($j.cookie("jv")){$j.ts("track","nv_regtracking_validated",{regType:c,socType:d,user:$j.session.user,product:b});$j.cookie("jv",null,{path:"/",domain:$j.session.host.domainRoot})}})})})(jQuery);(function(f){$j.namespace("$j.session.ConversationLoader");var g=[];var h={};var e={};var c=new $j.Meta();var a=function(o,l){var k=new $j.Meta();var q=(o.contentId&&h[o.contentId]?h[o.contentId]:null);url=$j.session.ConversationLoader.getURL(o,"content/getUserArticle",q);url.setParam("unfiltered",1);if(o.address&&o.address==k.address){o.tags=o.tags||k.tags;o.nvauthor=o.nvauthor||k.author;o.nvdatepub=o.nvdatepub||k.pubDate;o.nvexcerpt=o.nvexcerpt||k.ogDescription;o.title=o.title||k.title}if(o.tags){url.setParam("t",o.tags)}if(o.nvauthor){url.setParam("a",o.nvauthor)}if(o.nvdatepub){url.setParam("d",o.nvdatepub)}if(o.nvexcerpt){url.setParam("e",o.nvexcerpt)}if(o.title){url.setParam("h",o.title)}if(f(".j_social_fivestar").length){url.setParam("opt",1471)}var n=url.assemble();var p=function(t){if(t.data){t=t.data}var s=t;if(s.threads==undefined){s.threads=[]}for(var m=0;m<s.threads.length;m++){if(!s.threads[m].group){s.threads[m].group={url:{},groupId:0,domainName:$j.session.GROUP_PUBLIC_DISCUSSION}}}b(n,o,s,a,l);j().conversationListen(s.contentId)};if(e[n]){p(e[n])}else{$j.jsonp(n,null,p)}};var d=function(o,k){if(!i.isReady&&(f(".j_troff_troff").length<1)&&(f(".j_troff_count").length>8||f(".j_social_set").length>8)){var l=false;if(o.useLoggedInFlag){l=true}else{f(".j_troff_count,.j_social_count").filter(function(){var s=f(this);if(s.attr("data-show-votes")||s.attr("data-vote-btn")){l=true}})}i.ready(o,l);return}var q=(o.contentId&&h[o.contentId]?h[o.contentId]:null);if($j.session.ConversationLoader.isRecentActivity(o.contentId)&&!q){h[o.contentId]=q=f.now()/10000}var n=$j.session.ConversationLoader.getURL(o,"remoteConversation",q);var m=n.assemble();var p=function(t){var s=t.data||t;j().socialSetListen(s.contentId);b(m,o,s,d,k)};if(e[m]){p(e[m])}else{$j.jsonp(m,null,p)}};var i={isReady:false,isLoading:false,pagedURL:null,contentIds:null,data:null,ready:function(m,l){if(!i.isLoading){i.load(l)}var k=function(){var n=(m.contentId?m.contentId:m.address);if(i.data&&(i.data[n]!==undefined)){if($j.session.ConversationLoader.isRecentActivity(i.data[n].contentId)){m.contentId=i.data[n].contentId;d(m,false)}else{b(i.uass+"-"+n,m,i.data[n],d,false)}}else{d(m,false)}};if(i.isReady===true){k()}else{$j.bind("indexLoader.isReady",function(){k()})}},load:function(k){$j.session.hostReady(function(){i.isLoading=true;url=$j.session.ConversationLoader.getURL({address:i.pagedURL},"comments/commentCountsByURL",k,true);if(i.contentIds){url.setParam("u",null);url.setParam("contentIds",i.contentIds)}i.uass=url.assemble();$j.jsonp(i.uass,null,null,{success:function(m){$j.log("bulk load success");i.data=m;for(var l in i.data){if(isNaN(l)&&i.data[l]&&i.data[l].contentId){i.data[i.data[l].contentId]=i.data[l]}}},error:function(){$j.log("bulk load failure")},complete:function(){i.isReady=true;$j.trigger("indexLoader.isReady")}})})}};var b=function(n,t,l,q,m){var p=c.cleanAddress(t.address);if(l.data){l=l.data}if(l.contentId){e[n]=l;if($j.uri(window.location).getParam("cldebug")){$j.log("*****  "+n)}for(var o=0;o<g.length;o++){if(g[o].options.address&&!g[o].options.contentId){if(c.cleanAddress(g[o].options.address)==p){g[o].options.contentId=l.contentId}}}var k=false;for(var o=0;o<g.length;o++){var s=g[o];if(s.callback&&s.options.contentId==l.contentId){if(m||!s.waitForSession){if(m){s.waitForSession=false}if(jQuery.inArray(n,s.handled)==-1){s.handled.push(n);if($j.uri(window.location).getParam("cldebug")){$j.log(s.options.contentId);if(s.callback.sig){$j.log(s.callback.sig)}}s.callback(l)}}else{if(!k){$j.session.persReady(function(){var u=$j.session.user.isRecentContent(l.contentId);if(u){h[l.contentId]=u}$j.log("load data after session ready "+l.contentId);q(t,true)});k=true}}}}}else{$j.log("data error for "+t.address)}};$j.session.ConversationLoader={ARTICLE:1,REMOTE:2,load:function(k,l){$j.session.hostReady(function(){if(l==$j.session.ConversationLoader.ARTICLE){a(k,false)}else{if(l==$j.session.ConversationLoader.REMOTE){d(k,false)}}})},isRecentActivity:function(l){if(typeof(l*1)!=="number"){return false}var k=($j.cookie("social_history")||"").split(",");if(f.inArray(l+"",k)>-1){if($j.uri(window.location).getParam("cldebug")){$j.log("recent = "+l)}return true}return false},setRecent:function(m){var l=($j.cookie("social_history")||"").split(",");l.push(m);var k=(new Date());k.setMinutes(k.getMinutes()+5);$j.cookie("social_history",l.join(","),{expires:k,path:"/",domain:$j.session.host.cookieDomain})},refresh:function(k,l){$j.session.ConversationLoader.setRecent(k.contentId);$j.session.ready(function(){if(k.contentId){$j.log("refresh "+k.contentId);h[k.contentId]=f.now()/10000|0}if(l==$j.session.ConversationLoader.ARTICLE){a(k,true)}else{if(l==$j.session.ConversationLoader.REMOTE){d(k)}}})},refreshIndexPage:function(k){if(k){i.isReady=false;i.isLoading=false;i.data=null;i.contentIds=null;i.pagedURL=k}f(".j_social_set").jenga_loadPlugins()},preloadContentPage:function(l){var k=[];l.each(function(){if(f(this).data("contentId")){k.push(f(this).data("contentId"))}});if(k.length){i.isReady=false;i.isLoading=false;i.data=null;i.pagedURL=null;i.contentIds=k.join("|")}l.jenga_loadPlugins()},bind:function(l,o,n){if(!l.contentId){for(var m in g){if(g[m].options&&!isNaN(g[m].options.contentId)){if(c.cleanAddress(g[m].options.address)==c.cleanAddress(l.address)){l.contentId=g[m].options.contentId;break}}}}var k={callback:o,waitForSession:(n?true:false),options:l,handled:[]};g.push(k)},getURL:function(v,s,o,m){var n=f("title").text();var p=(m?window.location.protocol+"//"+window.location.hostname+window.location.pathname:null);var q=null;if(!m){$j.session.ConversationLoader.fillOptionsFromMeta(v)}var l=$j.session.UserLoader.isRegisteredUser()&&(v.contentId||!v.address)&&(o||v.useLoggedInFlag);if($j.uri(window.location).getParam("admin")){l=true}var k=new $j.uri($j.session.host.getAPIPath(false,false,!l)+s);if(o||v.useLoggedInFlag){if($j.session.UserLoader.isRegisteredUser()){k.setParam("loggedIn","1")}if(v.contentId){k.setParam("no-cache",o)}}if(v.contentId&&isNaN(v.contentId)){v.legacyAddress=v.contentId;v.contentId=null}if(v.contentId){k.setParam("contentId",v.contentId)}else{if(v.address){p=(v.legacyAddress?v.legacyAddress:v.address);n=v.title;if(v.authorTag){k.setParam("t",v.authorTag)}}k.setParam("u",c.cleanAddress(p));k.setParam("h",n)}k.setParam("rh",window.location.hostname);return k},fillOptionsFromMeta:function(l){if(l.contentId){return}if(l.address){return}var k=new $j.Meta();if(!k.contentId&&!k.address&&!k.legacyAddress){return}l.title=k.title;l.videoId=k.videoId;if(k.address&&k.legacyAddress){l.address=k.address;l.legacyAddress=k.legacyAddress}else{if(k.address){l.address=k.address}if(k.contentId){l.contentId=k.contentId}}return l},getRemoteData:function(k){for(r in e){if(e[r].contentId&&e[r].contentId==k){if(typeof e[r].threads==="undefined"){return e[r]}}}return null},getArticleData:function(k){for(r in e){if(e[r].contentId&&e[r].contentId==k){if(e[r].threads){return e[r]}}}return null}};var j=function(){var k=$j.session.SocketManager;if((typeof $j.ConversationListener==="function")&&k){return $j.ConversationListener($j.session.ConversationLoader,k,g)}return{conversationListen:function(){},socialSetListen:function(){}}}})(jQuery);(function(b){$j.date=function(d,c){if(typeof d==="object"){c=d}var c=b.extend({},c);return new function(){this.options=c;this.date=new Date();if(d){this.date.setTime(d)}this.format=function(e){return a(e,this.date.getTime())}}};$j.date.get_month_days=function(d,c){return new Date(c,d,0).getDate()};$j.date.returnMonth=function(d){var c=["January","February","March","April","May","June","July","August","September","October","November","December"];return c[d-1]};$j.date.format=function(d,c){return $j.date(c).format(d)};$j.date.validateAge=function(i,d,g){var h=13;i=i-1;var f=new Date(g,i,d);var e=new Date();var c=true;var j=e.getFullYear()-f.getFullYear();if(j<h){c=false}else{if(j===h){if(e.getMonth()<f.getMonth()){c=false}else{if(e.getDate()<f.getDate()){c=false}}}}return c};$j.date.localLongFormat=function(d){var c=(new Date(d));var e=c.toLocaleTimeString();return c.toLocaleDateString()+" "+e};function a(l,j){var i=this,k,h,d=/\\?([a-z])/gi,c,e=function(m,f){if((m=m+"").length<f){return new Array((++f)-m.length).join("0")+m}return m},g=["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur","January","February","March","April","May","June","July","August","September","October","November","December"];c=function(f,m){return h[f]?h[f]():m};h={d:function(){return e(h.j(),2)},D:function(){return h.l().slice(0,3)},j:function(){return k.getDate()},l:function(){return g[h.w()]+"day"},N:function(){return h.w()||7},S:function(){var f=h.j();return f>4&&f<21?"th":{1:"st",2:"nd",3:"rd"}[f%10]||"th"},w:function(){return k.getDay()},z:function(){var m=new Date(h.Y(),h.n()-1,h.j()),f=new Date(h.Y(),0,1);return Math.round((m-f)/86400000)+1},W:function(){var m=new Date(h.Y(),h.n()-1,h.j()-h.N()+3),f=new Date(m.getFullYear(),0,4);return e(1+Math.round((m-f)/86400000/7),2)},F:function(){return g[6+h.n()]},m:function(){return e(h.n(),2)},M:function(){return h.F().slice(0,3)},n:function(){return k.getMonth()+1},t:function(){return(new Date(h.Y(),h.n(),0)).getDate()},L:function(){return new Date(h.Y(),1,29).getMonth()===1|0},o:function(){var o=h.n(),f=h.W(),m=h.Y();return m+(o===12&&f<9?-1:o===1&&f>9)},Y:function(){return k.getFullYear()},y:function(){return(h.Y()+"").slice(-2)},a:function(){return k.getHours()>11?"pm":"am"},A:function(){return h.a().toUpperCase()},B:function(){var m=k.getUTCHours()*3600,f=k.getUTCMinutes()*60,n=k.getUTCSeconds();return e(Math.floor((m+f+n+3600)/86.4)%1000,3)},g:function(){return h.G()%12||12},G:function(){return k.getHours()},h:function(){return e(h.g(),2)},H:function(){return e(h.G(),2)},i:function(){return e(k.getMinutes(),2)},s:function(){return e(k.getSeconds(),2)},u:function(){return e(k.getMilliseconds()*1000,6)},e:function(){throw"Not supported (see source code of date() for timezone on how to add support)"},I:function(){var m=new Date(h.Y(),0),o=Date.UTC(h.Y(),0),f=new Date(h.Y(),6),n=Date.UTC(h.Y(),6);return 0+((m-o)!==(f-n))},O:function(){var m=k.getTimezoneOffset(),f=Math.abs(m);return(m>0?"-":"+")+e(Math.floor(f/60)*100+f%60,4)},P:function(){var f=h.O();return(f.substr(0,3)+":"+f.substr(3,2))},T:function(){return"UTC"},Z:function(){return -k.getTimezoneOffset()*60},c:function(){return"Y-m-d\\Th:i:sP".replace(d,c)},r:function(){return"D, d M Y H:i:s O".replace(d,c)},U:function(){return k.getTime()/1000|0}};this.date=function(m,f){if(m==undefined){return}i=this;k=((typeof f==="undefined")?new Date():(f instanceof Date)?new Date(f):new Date(f*1000));return m.replace(d,c)};return this.date(l,j)}})(jQuery);(function(b){$j.namespace("$j.howl");$j.howl.defaults={position:"top",removebutton:true,time:5000,cssClass:"notify",disable:false};var a=false;$j.howl.show=function(d,e){var c=function(){var i=b.extend({},$j.howl.defaults,e);var g=b(document.createElement("span")).addClass("howl-content").append(i.message);var f;(e.position=="bottom")?f=b(document.createElement("div")).addClass("howl howl-bottom"):f=b(document.createElement("div")).addClass("howl howl-top");if(i.message==b(".howl-content").first().text()){return}if(e.removebutton){var j=b("<a>Close</a>").addClass("c-button");j.click(function(k){$j.howl.removebar(f)})}else{f.css({cursor:"pointer"});f.click(function(k){$j.howl.removebar(f)})}f.append(g).append(j).hide();f.addClass(e.cssClass);if(b(".howl").length>0){var h=b(".howl");f.prependTo(b("body")).fadeIn("fast");h.each(function(){var k=b(this);k.animate({top:"+="+f.height()},500)})}else{f.prependTo(b("body")).slideDown("slow")}if(i.timer){f.data("timeout",setTimeout(function(){$j.howl.removebar(f)},i.time))}};if(!$j.howl.defaults.disable){c()}};$j.howl.removebar=function(c){if(b(".howl").length){clearTimeout(c.data("timeout"));c.fadeOut("fast",function(){b(this).remove()})}};$j.howl.removeAll=function(){b(".howl").each(function(){$j.howl.removebar(b(this))})};$j.howl.notify=function(e,c){var d=b.extend({},{message:e,timer:true,removebutton:false,cssClass:"notify"},c);$j.howl.show("notify",d)};$j.howl.alert=function(e,c){var d=b.extend({},{message:e,timer:true,removebutton:false,cssClass:"alert"},c);$j.howl.show("alert",d)};$j.howl.disable=function(){$j.howl.defaults.disable=true}})(jQuery);(function(f){var b=Number.NEGATIVE_INFINITY;var d=Number.POSITIVE_INFINITY;var a="data-timestamp";f.fn.cuteTime=function(n){var m=new Date().getTime();var o;var p;if((typeof n=="object")||(n==undefined)){f.fn.cuteTime.c_settings=f.extend({},f.fn.cuteTime.settings,n);f.fn.cuteTime.the_selected=this;this.each(function(){p=f(this);o=j(p);p.html(c(m,o))});f.fn.cuteTime.start_cuteness()}return this};f.cuteTime=function(n,q){var m=new Date().getTime();var p;var r;var o=null;if(typeof n=="object"){f.fn.cuteTime.c_settings=f.extend({},f.fn.cuteTime.settings,n)}if(typeof n=="string"){o=n}else{if(typeof q=="string"){o=q}}if(o!=null){p=l(o);if(!isNaN(p)){return c(m,p)}else{return"INVALID_DATETIME_FORMAT"}}return this};f.fn.cuteTime.ABS_FORMAT="M j, Y";f.fn.cuteTime.settings={refresh:-1,time_ranges:[{bound:b,cuteness:"just now",unit_size:0},{bound:0,cuteness:"just now",unit_size:0},{bound:60*1000,cuteness:"1 minute ago",unit_size:0},{bound:60*1000*2,cuteness:" minutes ago",unit_size:60*1000},{bound:60*1000*60,cuteness:"an hour ago",unit_size:0},{bound:60*1000*60*2,cuteness:" hours ago",unit_size:60*1000*60},{bound:60*1000*60*24,cuteness:"yesterday",unit_size:0},{bound:60*1000*60*24*2,cuteness:" days ago",unit_size:60*1000*60*24},{bound:60*1000*60*24*30,cuteness:f.fn.cuteTime.ABS_FORMAT,unit_size:0},{bound:60*1000*60*24*30*2,cuteness:f.fn.cuteTime.ABS_FORMAT,unit_size:60*1000*60*24*30},{bound:60*1000*60*24*30*12,cuteness:f.fn.cuteTime.ABS_FORMAT,unit_size:0},{bound:60*1000*60*24*30*12*2,cuteness:f.fn.cuteTime.ABS_FORMAT,unit_size:60*1000*60*24*30*12},{bound:d,cuteness:"a blinkle ago",unit_size:0}]};f.fn.cuteTime.start_cuteness=function(){var m=f.fn.cuteTime.c_settings.refresh;if(f.fn.cuteTime.process_tracker==null){if(m>0){f.fn.cuteTime.process_tracker=setInterval("jQuery.fn.cuteTime.update_cuteness()",m)}}else{}return this};f.fn.cuteTime.update_cuteness=function(){var m=new Date().getTime();var o;var n;f.fn.cuteTime.the_selected.each(function(){o=f(this);n=j(o);o.html(c(m,n))})};f.fn.cuteTime.stop_cuteness=function(){if(f.fn.cuteTime.process_tracker!=null){clearInterval(f.fn.cuteTime.process_tracker);f.fn.cuteTime.process_tracker=null}else{}return this};function c(p,r){var o=f.fn.cuteTime.c_settings.time_ranges;var n,q;var m="";var s=p-r;jQuery.each(o,function(t,u){if(t<o.length-1){if((s>=u.bound)&&(s<o[t+1]["bound"])){if(u.cuteness==f.fn.cuteTime.ABS_FORMAT){m=$j.date.format(f.fn.cuteTime.ABS_FORMAT,r/1000)}else{if(u.cuteness){if(u.unit_size>0){q=Math.floor(s/u.unit_size)}else{q=""}n=u.cuteness.replace(/%CT%/,q);if(n==u.cuteness){m=q+u.cuteness}else{m=n}}}return false}}else{return false}});if(m==""){m="2 pookies ago"}return m}function l(n){var m;if((new_date=g(n))!=null){m=new_date.valueOf()}else{m=(new Date(n)).valueOf();if(isNaN(m)){m=new Date(n.replace(/-/g," "))}}return m}function g(q){var m=q.match(/^(\d{4})((-(\d{2})(-(\d{2})(T(\d{2}):(\d{2})(:(\d{2})(.(\d+))?)?(Z|(([+-])((\d{2}):(\d{2})))))?)?)?)$/);if(m!=null){var n=new Date();var p=0;var o=0;n.setUTCFullYear(m[1]);if(!e(m[4])){n.setUTCMonth(m[4]-1);if(!e(m[6])){n.setUTCDate(m[6]);if(!e(m[16])){p=m[18];o=m[19];if(m[16]=="-"){p*=-1;o*=-1}}if(!e(m[8])){n.setUTCHours(m[8]-p);n.setUTCMinutes(m[9]-o);if(!e(m[11])){n.setUTCSeconds(m[11]);if(!e(m[13])){n.setUTCMilliseconds(m[13]*1000)}}}}}return n}else{return null}}function e(m){if(null==m||""==m){return true}return false}function j(o){var n=Number.NaN;var m=h(o);if(m!=null){n=l(m)}if(isNaN(n)){m=i(o);if(m!=null){n=l(m)}}if(isNaN(n)){m=new Date().toString();n=l(m)}k(m,o);return n}function h(n){var m=n.attr(a);if(m!=undefined){return m}else{return null}}function k(m,n){n.attr(a,m)}function i(m){return m.text()}})(jQuery);(function(a){a.fn.toglr=function(b){this.each(function(){var g=a(this);if(g.data("toglr-on")){if(b.initState){g.data("toglr-on")()}else{g.data("toglr-off")()}return g}var f=g.attr("data-text");if(!f){return}var i=function(){g.removeClass("down");if(g.attr("data-text").length){g.html(g.attr("data-text").split("|")[0])}};var e=function(){g.addClass("down");if(g.attr("data-text").length){g.html(g.attr("data-text").split("|")[1])}};var c=function(){var j=g.data("togs");if(!j){j=0}g.data("togs",j+1);if(j>10){a("body").css({"-webkit-transform":"rotate(180deg)","-webkit-transition":"all 1s ease infinite 1s"})}};if(b.initState){e()}else{i()}var d=function(){e();b.callbackOn()};var h=function(){i();b.callbackOff()};g.click(function(j){j.preventDefault();c();if(g.hasClass("down")){h()}else{d()}});g.data("toglr-on",e);g.data("toglr-off",i);return g})}})(jQuery);(function(a){$j.namespace("$j.avatar");$j.avatar={getSizedAvatarURL:function(c,b){if(c.indexOf("/group.gif")>0){return c}if(!b){b=90}return c.replace(/\/\d+x\d+/,"/"+b+"x"+b).replace(/width=\d+/,"width="+b)},getDefaultAvatar:function(d){if(d!==30&&d!==60&&d!==120){d=90}var c=$j.session.host.mediaPath;c+="/_vine/images/av/"+d+"x"+d+"/";var b=$j.session.host.getDomainRoot();if(b==="newsvine.com"){c+="vine.jpg"}else{if(b==="today.com"){c+="today.svg"}else{c+="msnbc.jpg"}}return c},getDefaultGroupAvatar:function(d){if(d!==30&&d!==60&&d!==120){d=90}var c=$j.session.host.getCDNRoot();c+="/_vine/images/av/"+d+"x"+d+"/";var b=$j.session.host.getDomainRoot();if(b==="msnbc.com"){c+="group.gif"}return c},getFromDomain:function(c,b){if(!b){b=90}return $j.session.host.getAPIPath(false,false,true)+"section/avatar?domainName="+c+"&width="+b},isDefaultGroupAvatar:function(b){if(!b){return false}var c=null;if(typeof b=="string"){c=b}else{if(b.length&&b.attr("src")){c=b.attr("src")}}if(c&&(c.indexOf("group.gif")<0)&&(c.indexOf("/null")<0)){return false}return true},isDefaultUserAvatar:function(b){if(!b){return false}var c=null;if(typeof b=="string"){c=b}else{if(b.length&&b.attr("src")){c=b.attr("src")}}if(c&&c.indexOf("/vine.jpg")<0){return false}return true},getVineacitySrc:function(b){return $j.session.host.getMediaRoot()+"/_vine/images/_/vineacity_sm/vine"+b+".gif"},user_avatar:function(b){return{isDefault:$j.avatar.isDefaultUserAvatar(b),src:function(){return function(c,d){if(!b||$j.avatar.isDefaultUserAvatar(b)){b=$j.avatar.getDefaultAvatar(c)}else{b=$j.avatar.getSizedAvatarURL(b,c)}return d(b)}}}},group_avatar:function(b){return{isDefault:$j.avatar.isDefaultGroupAvatar(b),src:function(){return function(c,d){b=$j.avatar.getSizedAvatarURL(b,c);return d(b)}}}}}})(jQuery);(function(g){var d=[];var b=null;var e=0;var f=50;g.fn.stickyHeader=function(k){var l=g.extend({stickyClass:"header",afterSticky:null,afterStickyOff:null,showCondition:function(){return true}},k);var m=g.fn.stickyHeader.stickyProperties().top.replace("px","")*1;return g(this).each(function(){var o=g(this);var n=g("."+l.stickyClass,o);if(n.length==0){return}d.push(new c(o,n,l))})};g.fn.stickyHeader.stickyProperties=function(){return{position:"fixed",top:"0px"}};var c=function(m,k,l){this.$container=m;this.settings=l;this.isActive=true;this.originalHeaderStyle=k.attr("style")};var a=function(n,t){if(!n){return false}if(!n.isActive){return false}if(!n.settings.showCondition()){return false}var v=n.$container;var l=g("."+n.settings.stickyClass,v);var q=v.offset().top;var o=l.offset().top;var r=l.outerHeight(false);var w=v.outerHeight(false);var q=v.offset().top;var k=v.outerHeight(false);var p=w+q-r-e;var m=false;var u=v.parents(".has-off-canvas");if(u.length&&!u.hasClass("is-off-canvas")){m=true}var s=(n==b?true:false);if(m||(p<f)||(t<q&&!s)){return false}else{if(t>q&&t<p){return true}}return false};var h=function(n){var k=g("."+n.settings.stickyClass,n.$container);var q=n.$container.outerWidth(false);var p=n.$container.offset().left;var m=q+"px";var o=p+"px";var l=g.fn.stickyHeader.stickyProperties();k.attr("style","position: "+l.position+"; top: "+l.top+"; width: "+m+"; left: "+o+";");k.addClass("stuck");if(n.settings.afterSticky){n.settings.afterSticky()}};var i=function(l){var k=g("."+l.settings.stickyClass,l.$container);k.attr("style",(l.originalHeaderStyle?l.originalHeaderStyle:""));k.removeClass("stuck");if(l.settings.afterStickyOff){l.settings.afterStickyOff()}};var j=function(){var k=g(window).scrollTop()-e;if(a(b,k)){}else{if(b){i(b);b=null}g.each(d,function(l,m){if(!b){if(a(m,k)){h(m);b=m}}})}};g(window).scroll(g.throttle(300,false,j));g(window).resize(g.throttle(300,false,function(){if(b){i(b)}b=null;j()}));g.fn.stickyHeaderRecalc=function(){var m=g(this);var l=0;var k=function(){if(m.offset().left!==l){l=m.offset().left;setTimeout(k,100)}else{j()}};k()};g.fn.stickyHeaderOn=function(){g(this).each(function(){var k=g(this);g.each(d,function(l,m){if(k===m.$container){m.isActive=true}})})};g.fn.stickyHeaderOff=function(){g(this).each(function(){var k=g(this);g.each(d,function(l,m){if(k===m.$container){m.isActive=false}});if(b&&k===b.$container){i(b);b=null}})}})(jQuery);(function(a){var b=function(){if($j.cookie("disable_howl")!==null){return true}if($j.session.host.getRegAffiliate()==="newsvine.com"){if($j.session.uri.path.startsWith("/_tps/accounts/")===true||$j.session.uri.path.startsWith("/_tps/_accounts/")===true){return true}}else{if($j.session.host.getRegAffiliate()==="msnbc.com"){if($j.session.uri.path.indexOf("accounts/register")>-1||$j.session.uri.path.indexOf("accounts/global/")>-1||$j.session.uri.path.indexOf("accounts/validate")>-1||$j.session.uri.path.indexOf("hope-submit")>-1){return true}}else{if($j.session.host.getRegAffiliate()==="today.com"){if($j.session.uri.path.indexOf("/thanks")>-1){return true}}}}if($j.session.uri.host.indexOf("visit.today.com")>-1){return true}return false};$j.session.ready(function(){if($j.util.isMobile.any()){a.fn.twipsy=function(){}}if(typeof a.fn.live!=="undefined"){a('span[rel="twipsy"], a[rel="twipsy"], button[rel="twipsy"], li[rel="twipsy"]').twipsy({placement:"right",trigger:"hover",live:true})}if(typeof a.fn.cuteTime==="function"){a.fn.cuteTime.settings.refresh=60000}if(!b()){if($j.session.user.isLoggedIn()&&!$j.session.user.isValidated()&&$j.session.user.loginState>0){$j.howl.notify('Your account is not validated yet. Please check your email. If you did not receive a validation email, <a href="'+$j.session.host.getRegDomainRoot(true)+'_api/servista/requestInvite">click here to have it re-sent</a>.',{timer:false,removebutton:true})}else{if($j.session.user.isLoggedIn()&&!$j.session.user.isRegistered()&&$j.session.user.loginState>0){$j.howl.notify('Your account is not activated yet. In order to participate you need to <a href="'+$j.session.host.getRegDomainRoot(true)+'_tps/accounts/register">finish registering</a>.',{timer:false,removebutton:true})}}}});$j.dev=function(c){$j.session.ready(function(){new $j.ModuleLoader("j_core_dev",function(){c?$j.dev(c):$j.dev("log")})})}})(jQuery);(function(b){var a=true;$j.namespace("$j.ext");$j.ext.FacebookClient=new function(){this.config=null;this.isReady=false;this.isInitializing=false;this.resp=null;this.init=function(c){if(a!==true){return}if(this.isInitializing){return}else{this.isInitializing=true}$j.session.ready(function(){this.config=$j.session.host.getFacebookConfig();if(!this.config||!this.config.appId){return}if(typeof FB!=="undefined"){$j.ext.FacebookClient.check_FB()}else{var d="//connect.facebook.net/en_US/sdk.js";if(location.protocol==="file:"){d="http:"+d}$j.loader({js:d,success:function(){b(document).ready(function(){document.getElementsByTagName("html")[0].setAttribute("xmlns:fb","http://www.facebook.com/2008/fbml");if(b("div#fb-root").size()===0){b(document.body).append('<div id="fb-root"/>')}$j.ext.FacebookClient.check_FB()})}})}},this)};this.check_FB=function(){if(typeof FB!=="undefined"){$j.ext.FacebookClient.init_FB()}else{setTimeout($j.ext.FacebookClient.check_FB,10)}};this.init_FB=function(){var d="/_fb/channel.html";var c=$j.session.uri.host;if(c==="www.nbcnews.com"){d="/id/46419312"}else{if(c==="today.com"){d="/id/46419312"}else{if(c==="video.today.com"){d="/channel.html"}}}var e=$j.session.uri.make({path:d}).assemble();FB.init({appId:this.config.appId,status:true,xfbml:true,version:"v2.6"});if(typeof FB.getLoginStatus!=="undefined"){FB.getLoginStatus(function(f){$j.ext.FacebookClient.updateResponse(f);$j.ext.FacebookClient.isReady=true;$j.trigger("$j.ext.fb.isReady",$j.ext.FacebookClient.resp)})}};this.updateResponse=function(c){$j.ext.FacebookClient.resp=c};this.getPerms=function(){var c=$j.ext.FacebookClient.config.perms;if($j.session.user.isSharing()){c=this.addPublishActions(c)}return c};this.addPublishActions=function(c){if(typeof c==="string"&&c.indexOf("publish_actions")===-1){c+=", publish_actions"}return c};this.addPublishStream=function(c){if(typeof c==="string"&&c.indexOf("publish_stream")===-1){c+=", publish_stream"}return c};this.buildResponsePerms=function(f){var c="";if(typeof f==="object"&&f.data&&f.data.length>0){var e=f.data;for(var d in e){if(e[d].status=="granted"){c+=e[d].permission+","}}}return c};this.checkPerms=function(c,g){if(typeof c!=="string"||typeof g!=="string"){return false}var h=($j.ext.FacebookClient.config.perms).split(",");var d=g.split(",");$j.log("request_Perms===",c,h);$j.log("responsePerms===",g,d);for(var f=0;f<h.length;f++){for(var e=0;e<d.length;e++){$j.log(h[f].trim().length,h[f].trim(),d[e].trim(),h[f].trim().length===0||h[f].trim()===d[e].trim());if(h[f].trim().length===0||h[f].trim()===d[e].trim()){break}else{if(e===d.length-1){return false}}}}return true}};$j.fb=function(d,c){if(b('meta[property="nv:published"]').length){if(b('meta[property="nv:published"]').attr("content")=="0"){$j.log("no fb init");return}}if($j.ext.FacebookClient.isReady){if(d){d.call(c,$j.ext.FacebookClient.resp)}}else{if(d){$j.bind("$j.ext.fb.isReady",d,c)}$j.ext.FacebookClient.init()}};$j.fb.unshare=function(c,e){var d={connected:{scope:null,callback:function(f){}},not_connected:{scope:null,callback:function(f){}}};b.extend(d,e);$j.fb(function(f){if(f.status==="connected"){FB.api(c,"delete",function(g){d.connected.callback.call(d.connected.scope,g)})}else{d.not_connected.callback.call(d.not_connected.scope,f)}})};$j.fb.share=function(d){var c={connected:{scope:null,callback:function(f){}},not_connected:{scope:null,callback:function(f){}},data:null,path:null,type:null,action:null,url:null};b.extend(c,d);if(c.path===null&&c.type==="video"){c.path="/me/video.watches";c.data={video:c.url};c.action="watches"}else{if(c.path===null&&c.type==="article"){c.path="/me/news.reads";c.data={article:c.url};c.action="reads"}else{if(c.path===null){return false}}}$j.fb(function(f){if(f.status==="connected"){FB.api(c.path,"post",c.data,function(g){c.connected.callback.call(c.connected.scope,g);if(g&&!g.error){FB.api("/me",function(h){e(c.type,c.action,h.id,b.cookie("vid"),c.data.access_token,c.url)})}})}else{c.not_connected.callback.call(c.not_connected.scope,f)}});function e(l,i,q,g,j,k){var n="https://newscircle.msnbc.msn.com/fb/";var o="msnbc";var m=b('meta[property="og:url"]').attr("content");if(window.location.host.indexOf("today")!=-1){o="today"}var p=b.param({FbId:q,NvId:g,Token:j,url:m,app:o});var f=n+i+"/"+l+"?"+p;var h=new Image();h.src=f}};$j.fb.hasPerms=function(c,d,f,e){$j.fb(function(g){$j.log("checking hasPerms; resp.status===",g.status);if(g.status==="connected"){FB.api("/me/permissions",function(i){var h=$j.ext.FacebookClient.buildResponsePerms(i);if($j.ext.FacebookClient.checkPerms(c,h)){if(typeof d==="function"){d.call(e,g)}}else{if(typeof f==="function"){f.call(e,g)}}})}else{if(typeof f==="function"){f.call(e,g)}}})}})(jQuery);(function(a){$j.namespace("$j.ext");if(typeof twttr==="undefined"){twttr=false}$j.ext.TWITTER_CONFIG={"newsvine.com":{appId:"L7EvKunhgfP2ld36anC1g"},"today.com":{},"msn.com":{appId:"SqwqQUUf54JHcI3QPvUVtg"}};$j.ext.TwitterConfig=function(e){if(!e){for(var d in $j.ext.TWITTER_CONFIG){host=$j.session.uri.host;if(d===host.substr(host.length-d.length)){if(!e||d.length>e.length){e=d}}}}var b=$j.ext.TWITTER_CONFIG[e];if(!b){return}for(var c in b){this[c]=b[c]}};$j.ext.TwitterClient=new function(){this.config=null;this.isReady=false;this.isInitializing=false;this.T=null;this.init=function(b){if(this.isInitializing){return}else{this.isInitializing=true}this.config=new $j.ext.TwitterConfig(b);if(!this.config.appId){return}$j.loader({js:"//platform.twitter.com/anywhere.js?v=1&id="+this.config.appId,success:function(){$j.ext.TwitterClient.check_TW()}})};this.check_TW=function(){if(twttr){$j.ext.TwitterClient.init_TW()}else{setTimeout($j.ext.TwitterClient.check_TW,10)}};this.init_TW=function(){var b=$j.session.uri.make({path:"/_tw/channel.html"}).assemble();twttr.anywhere.config({callbackURL:b});twttr.anywhere(function(c){$j.ext.TwitterClient.T=c;$j.ext.TwitterClient.isReady=true;$j.trigger("$j.ext.tw.isReady",$j.ext.TwitterClient.T)})}};$j.tw=function(c,b){if($j.ext.TwitterClient.isReady){if(c){c.call(b,$j.ext.TwitterClient.T)}}else{if(c){$j.bind("$j.ext.tw.isReady",c,b)}$j.ext.TwitterClient.init()}}})(jQuery);(function(b){var a="j_clickaway";$j.plugin(a,function(c,d){var h={custom_event_key:a,clickaway_handle:function(i){g.hide()},safezone:null};var g=b(c);var d=b.extend(true,{},h,d);var f=d.custom_event_key+"_"+$j.util.uid();this.init=function(){this.bind(d)};this.bind=function(j){d=b.extend(true,{},h,j);g.addClass(f);b(document.body).bind("click."+f,function(k){if((b(k.target).closest("."+f).size()===0)&&(!d.safezone||b(k.target).closest(d.safezone()).size()===0)){e();d.clickaway_handle(b(k.target))}});var i=27;b(document.body).bind("keydown."+f,function(k){if(!k.altKey&&!k.ctrlKey&&!k.shiftKey&&(k.keyCode==i)){e();d.clickaway_handle(b(k.target))}})};this.unbind=function(){e()};var e=function(){b(document.body).unbind("click."+f);b(document.body).unbind("keydown."+f)}})})(jQuery);(function(b){$j.namespace("$j.popover");$j.popover.openedPopup=null;$j.popover.windowTopMargin=0;var c={id:"",addClass:null,openEvent:null,closeEvent:null,offsetX:0,offsetY:0,zindex:50,padding:0,preventLeft:false,preventRight:false,preventTop:false,preventBottom:false,forceBottom:false,hasTriangle:true,centerHorizontal:false,alignTriggerLeft:false,$popover:null,$triangle:null,swap:false,header:null,content:null,substituteContainer:null,hasCloseBox:false};var a={init:function(e){var f=b(this);if(!f.length){$j.log("popover called on empty element: "+f.selector);return this}f.data("pop-settings",b.extend({},c,e));f.addClass("popover-button");return f.each(function(){var g=b(this);g.bind("showPopover",function(){a.togglePopover.apply(g,[true]);return false});g.bind("hidePopover",function(){a.hidePopover.apply(g,[]);return false});g.bind("expand",function(h){a.expand.apply(g,[h]);return false})})},disable:function(){b(this).each(function(){b(this).data("pop-is-disabled",true)})},enable:function(){b(this).each(function(){b(this).data("pop-is-disabled",false)})},togglePopover:function(f){if($j.popover.openedPopup&&($j.popover.openedPopup.get(0)===this.get(0))){if(!f){a.hideOpenPopover()}return}var j=b(this).data("pop-settings");j.anchor=b(this);if(j.swap&&$j.popover.openedPopup){j.anchor=$j.popover.openedPopup.data("pop-settings").anchor}var k=b(this);if(k.data("pop-is-disabled")){return}if(j.substituteContainer){j.$popover=j.substituteContainer;b(".content",j.$popover).length||j.$popover.append('<div class="content"></div>')}else{j.$popover=b('<div class="popover">'+(j.hasCloseBox?'<a href="#" class="j-stifle c-stifle c-close" title="close card">&times;</a>':"")+(j.hasTriangle?'<div class="triangle"></div>':"")+'<div class="content"></div></div>');if(j.addClass){j.$popover.addClass(j.addClass)}if(j.id){j.$popover.attr("id",j.id)}j.$popover.appendTo("body")}var g=this;try{var e=false;var h=b(".content",j.$popover);setTimeout(function(){if(!e){if(b(".j-spinner",h)){b(".j-spinner",h).html("Could not fetch data. Please try again.")}else{b("div",h).last().html("Could not fetch data. Please try again.")}}},10000);if(typeof j.content=="function"){h.html(function(){var l=j.content();e==true;return l})}else{h.append(function(){var l=b(j.content).detach();e==true;return l})}j.$triangle=b(".triangle",j.$popover);j.$triangle.attr("style","");j.$popover.css("display","block");this.addClass("down");this.addClass("focus");k.j_clickaway("bind",{clickaway_handle:function(){b(".selektr .dropDown").hide();k.trigger("hidePopover")},safezone:function(){return b(".popover")}})}catch(i){$j.log(i)}a._positionPopover(this,a._calcPopoverPos(this));setTimeout(function(){j.$popover.addClass("active")},0);b(".twipsy").hide();k.twipsy("disable");$j.popover.openedPopup=this;this.addClass("popover-on");if(b.isFunction(j.openEvent)){j.openEvent(this)}if(this.attr("rel")=="twipsy"){this.attr("rel","twipsy-block")}b(document).trigger("popoverOpened")},hidePopover:function(){var e=b(this).data("pop-settings");if(!e){return}this.removeClass("popover-on");this.removeClass("down");this.removeClass("focus");b(this).j_clickaway("unbind");b(document).trigger("popoverClosed");if(e.substituteContainer){b(".content",e.$popover).empty()}else{if(e.$popover){e.$popover.detach()}}if(b.isFunction(e.closeEvent)){e.closeEvent(this)}if($j.popover.openedPopup&&$j.popover.openedPopup.get(0)===this.get(0)){$j.popover.openedPopup=null}if(this.attr("rel")=="twipsy-block"){this.attr("rel","twipsy")}},hideOpenPopover:function(){if($j.popover.openedPopup!=null){$j.popover.openedPopup.trigger("hidePopover")}},expand:function(f){var g=b(this).data("pop-settings");if($j.popover.openedPopup&&$j.popover.openedPopup.get(0)===this.get(0)){g.content=f;g.$popover=g.substituteContainer?g.substituteContainer:b(".popover");g.$triangle=b(".triangle",g.$popover);var e=b('<div class="content"></div>');e.append(g.content);b(".content",g.$popover).children().detach();b(".content",g.$popover).replaceWith(e);a._positionPopover(this,a._calcPopoverPos(this))}return false},repositionOpenPopover:function(){if($j.popover.openedPopup!=null){a._positionPopover($j.popover.openedPopup,a._calcPopoverPos($j.popover.openedPopup))}},_calcPopoverDirPossible:function(e,h){var f=e.data("pop-settings");var g={left:false,right:false,top:false,bottom:false};if(h.buttonOffset.top+h.buttonHeight+h.triangleSize+h.popoverHeight<=h.docHeight-f.padding){g.bottom=true}if(h.buttonOffset.top-h.triangleSize-h.popoverHeight>=f.padding){g.top=true}if(h.buttonOffset.left+h.buttonWidth+h.triangleSize+h.popoverWidth<=h.docWidth-f.padding){g.right=true}if(h.buttonOffset.left-h.triangleSize-h.popoverWidth>=f.padding){g.left=true}return g},_chooseDir:function(f,h){var g=f.data("pop-settings");if(g.forceBottom){return"bottom"}if(g.preventBottom){h.bottom=false}if(g.preventTop){h.top=false}if(g.preventLeft){h.left=false}if(g.preventRight){h.right=false}var e="right";if(g.preventRight){e="bottom"}if(g.preventBottom){e="top"}if(g.preventTop){e="left"}if(h.right){e="right"}else{if(h.bottom){e="bottom"}else{if(h.left){e="left"}else{if(h.top){e="top"}}}}return e},_calcPopoverPos:function(e){var f=e.data("pop-settings");var h={popoverDir:"bottom",popoverX:0,popoverY:0,deltaX:0,deltaY:0,triangleX:0,triangleY:0,triangleSize:(f.hasTriangle?20:0),docWidth:b(document).width(),docHeight:b(window).height()+b(document).scrollTop(),winWidth:b(window).width(),winHeight:b(window).height(),winTop:b(window).scrollTop()+$j.popover.windowTopMargin,popoverWidth:f.$popover.outerWidth(false),popoverHeight:f.$popover.outerHeight(false),buttonWidth:f.anchor.outerWidth(false),buttonHeight:f.anchor.outerHeight(false),buttonOffset:f.anchor.offset()};var g=a._calcPopoverDirPossible(e,h);h.popoverDir=a._chooseDir(e,g);if(h.popoverDir=="bottom"){h.popoverY=h.buttonOffset.top+h.buttonHeight+h.triangleSize}else{if(h.popoverDir=="top"){h.popoverY=h.buttonOffset.top-h.triangleSize-h.popoverHeight}else{h.popoverY=h.buttonOffset.top+(h.buttonHeight-h.popoverHeight)/2}}if((h.popoverDir=="bottom")||(h.popoverDir=="top")){h.popoverX=h.buttonOffset.left+(h.buttonWidth-h.popoverWidth)/2;if(f.alignTriggerLeft){h.popoverX=h.buttonOffset.left}if(h.popoverX<f.padding){h.deltaX=h.popoverX-f.padding}else{if(h.popoverX+h.popoverWidth>h.docWidth-f.padding){h.deltaX=h.popoverX+h.popoverWidth-h.docWidth+f.padding}}h.triangleX=h.popoverWidth/2-h.triangleSize+h.deltaX;h.triangleY=0}else{if(h.popoverDir=="right"){h.popoverX=h.buttonOffset.left+h.buttonWidth+h.triangleSize}else{h.popoverX=h.buttonOffset.left-h.triangleSize-h.popoverWidth}if(h.popoverY<(f.padding+h.winTop)){h.deltaY=h.winTop-h.popoverY+f.padding}else{if((h.popoverY+h.popoverHeight)>(h.winTop+h.winHeight-f.padding)){h.deltaY=(h.winTop+h.winHeight)+2*f.padding-h.popoverY-h.popoverHeight}}h.triangleX=0;h.triangleY=h.popoverHeight/2-h.triangleSize-h.deltaY}return h},_positionPopover:function(e,j){var f=e.data("pop-settings");if(f.substituteContainer){return}if(f.$triangle){f.$triangle.removeClass("left top right bottom");f.$triangle.addClass(j.popoverDir);if(j.triangleX>0){f.$triangle.css("left",j.triangleX-f.offsetX+"px")}if(j.triangleY>0){f.$triangle.css("top",j.triangleY-f.offsetY+"px")}}var h=j.popoverY+j.deltaY+f.offsetY+"px";var g=j.popoverX-j.deltaX+f.offsetX+"px";f.$popover.css({top:h,left:g});var i=0;if((typeof $j.j_modal!=="undefined")&&$j.j_modal.active()){i=$j.j_modal.active().css("z-index")*1}f.$popover.css("z-index",i+f.zindex).show()}};var d={togglePopover:function(m){if($j.popover.openedPopup&&($j.popover.openedPopup.get(0)===this.get(0))){if(m===false||this.hasClass("popover-on")){a.hideOpenPopover()}return}var h=b(this).data("pop-settings");h.anchor=b(this);if(h.swap&&$j.popover.openedPopup){h.anchor=$j.popover.openedPopup.data("pop-settings").anchor;b(".content",h.$popover).html(typeof h.content=="function"?h.content():h.content);return}var e=b(this);if(e.data("pop-is-disabled")){return}h.$popover=b('<div class="c-fillscreen"><a href="#" class="j-modal-close c-modal-close">&times;</a><div class="content"></div></div>');
if(h.addClass){h.$popover.addClass(h.addClass)}if(h.id){h.$popover.attr("id",h.id)}try{var f=false;b("body").append(h.$popover);h.$popover.j_modal({onClose:function(){d._hideContent.call(e)}});var i=200;var j=parseInt(h.$popover.css("top"));var k=h.$popover.height()+j;h.$popover.css({top:-k,opacity:0,visibility:"visible"});h.$popover.delay(i/2).animate({top:j+"px",opacity:1},i);b(".j-modal-close",h.$popover).click(function(n){n.preventDefault();n.stopPropagation();h.$popover.j_modal("hide")});var g=b(".content",h.$popover);setTimeout(function(){if(!f){if(b(".j-spinner",g)){b(".j-spinner",g).html("Could not fetch data. Please try again.")}else{b("div",g).last().html("Could not fetch data. Please try again.")}}},10000);if(typeof h.content=="function"){g.html(function(){var n=h.content();f==true;return n})}else{g.append(function(){var n=b(h.content).detach();f==true;return n})}this.addClass("down");this.addClass("focus")}catch(l){$j.log(l)}$j.popover.openedPopup=this;this.addClass("popover-on");b(".twipsy").hide();if(b.isFunction(h.openEvent)){h.openEvent(this)}if(this.attr("rel")=="twipsy"){this.attr("rel","twipsy-block")}b(document).trigger("popoverOpened")},hidePopover:function(){var f=b(this);var e=f.data("pop-settings");if(e&&e.$popover){e.$popover.j_modal("hide")}},_hideContent:function(){var f=b(this);var e=f.data("pop-settings");if(e&&e.$popover){f.removeClass("popover-on");f.removeClass("down");f.removeClass("focus");b(document).trigger("popoverClosed");if(b.isFunction(e.closeEvent)){e.closeEvent(f)}if($j.popover.openedPopup&&$j.popover.openedPopup.get(0)===f.get(0)){$j.popover.openedPopup=null}if(f.attr("rel")=="twipsy-block"){f.attr("rel","twipsy")}e.$popover&&e.$popover.remove();e.$popover=null}},expand:function(e){var g=b(this).data("pop-settings");if($j.popover.openedPopup&&$j.popover.openedPopup.get(0)===this.get(0)){var f=b(".content",g.$popover);f.html(e)}return false},repositionOpenPopover:function(){}};b(document).on("click touchstart",".popover-button",function(f){f.preventDefault();a.togglePopover.apply(b(this),[])});b(document).on("click",".popover .triangle",function(f){f.preventDefault();a.hideOpenPopover()});b(document).on("click",".popover .j-stifle",function(f){f.preventDefault();a.hideOpenPopover()});if(b(window).width()<769||$j.uri(window.location).getParam("mpop")){a=b.extend({},a,d)}b.fn.popover=function(e){if(this.length<1){return this}if(a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a.init.apply(this,arguments)}else{$j.log("Method "+e+" does not exist on jQuery.popover")}}}})(jQuery);(function(a){$j.namespace("$j.j_modal");$j.j_modal.active=function(){if(b.length){return b[b.length-1]}return null};var b=[];$j.plugin("j_modal",function(d,e){var g={esckey:true,overlay:true,clickaway:true,addClass:false,onClose:null};var f=0;this.$root=a(d);this.$overlay=false;this.options=a.extend({},g,e);var c=a(".j_modal_overlay").length;this.$root.addClass("j_modal");this.$root.addClass("c-modal");if(this.options.addClass){this.$root.addClass(this.options.addClass)}if(c){this.$root.css("z-index",this.$root.css("z-index")*1+c*10)}this.init=function(){this.toggle()};this.setoptions=function(h){this.options=a.extend({},g,h)};this.toggle=function(){if(this.$root.css("display")==="none"||this.$overlay===false){this.show()}else{this.hide()}};this.show=function(){if(this.options.esckey===true){this._keyup_bind()}if(this.options.overlay===true){this._overlay_show()}this.$root.css("display",this.$root.css("display"));this.$root.show();if(!c){f=a(window).scrollTop();a("body").css("overflow","hidden")}if(b[b.length-1]!==this.$root){b.push(this.$root);$j.log("push ");$j.log(this.$root)}if(typeof $j.popover!=="udefined"){if($j.popover.openedPopup&&!$j.popover.openedPopup.hasClass("j_modal")){a(document).popover("hideOpenPopover")}}};this.hide=function(){if(this.options.esckey===true){this._keyup_unbind()}if(this.options.overlay===true){this._overlay_hide()}this.$root.hide();$j.trigger("j_modal_hide",this.$root);if(this.options.onClose){this.options.onClose()}if(!c){a("body").css("overflow","auto");a(window).scrollTop(f)}var h=b.pop();$j.log("pop");$j.log(h);if(h!==this.$root){b.push(h);$j.log("nested modal stack messed up")}};this._keyup_bind=function(){a(document).bind("keyup.j_modal",this,function(h){h.data._keyup_handle(h.keyCode)})};this._keyup_unbind=function(){a(document).unbind("keyup.j_modal")};this._keyup_handle=function(h){var i=27;if(h===i){this.hide()}};this._overlay_show=function(){if(!this.$overlay){this.$overlay=a('<div class="j_modal_overlay" />').appendTo(document.body);this.$overlay.css("z-index",this.$root.css("z-index")*1-5);if(this.options.clickaway===true){this.$overlay.click(this,function(h){h.data.hide()})}}};this._overlay_hide=function(){if(this.$overlay){this.$overlay.unbind("click");this.$overlay.remove();this.$overlay=false}}});$j.plugin("j_modal_target",function(c,d){var e=a(c);e.bind("click",function(f){f.preventDefault();a(e.attr("href")).j_modal()})},{autoload:true})})(jQuery);(function(a){a.fn.j_modal_layout=function(c){var d=a(this);var b=d.pluginObj("j_modal_layout_inner");if(b){b.$layout.j_modal("show")}else{d.j_modal_layout_inner(c)}};$j.widget("j_modal_layout_inner",function(){this.registerMixin($j.MustacheMixin,{templateClass:"j_modal_layout"});this.options={title:"&nbsp;",subTitle:null,close:true,cancel:false,on_cancel:null,on_save:null,cancel_label:"Cancel",save_label:"Save changes",footer:null};this.$layout=null;this._render=function(){if(!this.$layout){var e=this.options;var b=this;e.showSave=(typeof e.save==="function");b.$layout=b.render_template(b.getTemplate("modal_layout"),e);if(e.title||e.close||e.subTitle){a(".c-modal-header",b.$layout).show()}if(e.footer||e.cancel||e.on_save){a(".c-modal-footer",b.$layout).show()}a(".j-modal-body",b.$layout).replaceWith(b.$root);b.$root.addClass("c-modal-body");function c(f){(typeof e.on_cancel==="function")&&e.on_cancel();f.preventDefault();b.$layout.j_modal("hide")}e.cancel&&a(".b-cancel",b.$layout).click(c).show();e.close&&a(".j-modal-close",b.$layout).click(c).show();function d(f){(typeof e.on_save==="function")&&e.on_save();f.preventDefault();b.$layout.j_modal("hide")}if(typeof e.on_save==="function"){a(".b-save",b.$layout).click(d).show()}a("body").append(b.$layout);b.$layout.j_modal(e)}else{b.show()}};this.hide=function(){if(this.$layout){this.$layout.pluginObj("j_modal").hide()}}},{autoload:false})})(jQuery);(function(a){$j.plugin("j_track",function(){var b={gaAccountId:"UA-547736-1",gaSampleRate:"100",siteName:"newsvine"};this.init=function(){if((a('meta[name="trackData"]').length>0)){try{if(typeof $e=="undefined"){$e={trackData:a.parseJSON(a('meta[name="trackData"]').attr("content"))}}this.send_pageload_event()}catch(c){$j.log("tracking data error")}}};this.set_standard_track_data=function(){var c=new Array();c.gaAccountId=b.gaAccountId;c.gaSampleRate=b.gaSampleRate;c.siteName=b.siteName;c.typeName=typeof $e!=="undefined"&&$e.trackData&&$e.trackData.typeName?$e.trackData.typeName:"";return c};this.send_custom_event=function(c){var d=this.set_standard_track_data();if(c.forceGAAccount){d.forceGAAccount=c.forceGAAccount}d.eventType="pageaction";d.featureName=c.featureName;d.eventName=c.eventName?c.eventName:"";d.eventLabel=c.eventLabel?c.eventLabel:"";d.eventValue=c.eventValue?c.eventValue:null;d.nonInteraction=c.nontInteraction?c.nontInteraction:"";d.deviceType=typeof $e!=="undefined"&&$e.trackData&&$e.trackData.deviceType;(typeof EventTracker!=="undefined")&&EventTracker().track(d)};this.send_pageload_event=function(){var c=this;$j.session.ready(function(){var d=c.set_standard_track_data();d.section=$e.trackData.section?$e.trackData.section:"";d.subSection=$e.trackData.subSection?$e.trackData.subSection:"";d.subSubSection=$e.trackData.subSubSection?$e.trackData.subSubSection:"";d.subSubSubSection=$e.trackData.subSubSubSection?$e.trackData.subSubSubSection:"";d.eventType="pageload";d.eventName="load";d.byline=$e.trackData.byline?$e.trackData.byline:"";d.elem="document";d.featureName=$j.session.host.domainRoot==="nbcnews.com"?"nbcnews_newsvinepage":"newsvinepage";d.siteName=$j.session.host.domainRoot==="nbcnews.com"?"nbcnews":d.siteName;d.sitePageId=$e.trackData.sitePageId;d.headline=$e.trackData.headline?$e.trackData.headline:document.title;d.source="";d.zipCode=$j.session.user.geo.zip?$j.session.user.geo.zip:"";d.pageSource="";d.deviceType=$e.trackData.deviceType;d.isOriginalContent="true";(typeof EventTracker!=="undefined")&&EventTracker().track(d)})}})})(jQuery);(function(a){$j.widget("j_zinger2_checkname",function(){this.registerMixin($j.MustacheMixin);this.options={labelFor:null,label:null,labelPlural:null,showLabel:true,placeholder:"",domainLabel:null,query:null,checkType:null,defaultVal:null,callback:null,sectionType:null,staticLabel:false,inputClass:null};this._render=function(){if(this._isRendered==false){this.set_values();if(this.options.inputClass){this.$root=a("."+this.options.inputClass);this.append_template(this.getTemplate("validation"),{},this.$root)}else{this.render_template(this.getTemplate("root"),{data:this.options},this.$root,this.templates());if(this.options.defaultVal){this.handle_search_input()}}this.init_search_input()}else{return}};this.set_values=function(){var d=this.options;if(d.checkType==="domain"){d.labelFor=d.labelFor||"domain-name";d.label="Domain name:";d.labelPlural="Domain names";d.domainLabel=d.domainLabel||"<strong>.newsvine.com</strong>";d.query="domainName"}else{if(d.checkType==="display"){d.labelFor=d.labelFor||"display-name";d.label=d.label||"Display name:";d.labelPlural="Display names";d.query="displayName"}}d.character_count_prompt=d.labelPlural+"  must be 4 to 35 characters."};var c=500;var b=false;this.init_search_input=function(){this.$root.find("input").bind("keyup paste",this,function(d){if(b===false){b=true;setTimeout(function(){b=false;d.data.handle_search_input()},c)}})};this.get_search_input=function(){return this.$root.find("input").val().trim()};this.remove_errors=function(){this.$root.find(".j-form-val").removeClass("showIcon error c-alert").html("");this.$root.find(".j-reason p").html(this.options.character_count_prompt)};this.handle_search_input=function(){var d=this.get_search_input();if(d.length<4){this.remove_errors();return}if(d===this.options.defaultVal){if(this.options.callback){this.options.callback(true)}}else{if(d!==this.search_value){this.search_value=d;this.search_users(d)}}};this.search_users=function(d){this.fetch_users(d,function(e){if(this.validate_fetch_user_response(e)){var f=e.data.users;if(f.length>0){this.render_users(f,$results)}else{this.render_results_message($results,"No users match that criteria.")}this.$loading.hide()}})};this.validate_fetch_user_response=function(f){if(this.options.callback){this.options.callback(f.data.isValid)}if(f.data.isValid===true){this.set_available()}else{this.set_not_available();this.set_errors(f)}if(f.status!=="success"){return false}var e=f.params;var d=e.query;$j.log("validating response....",(d===this.search_value)," query=",d,"this.search_value=",this.search_value);if(d===this.search_value){return true}else{return false}};this.fetch_users=function(d,f){var e=$j.uri($j.session.host.getNewsvineRoot()+"_action/section/checkName");e.setParam(this.options.query,d);if(this.options.sectionType){e.setParam("type",this.options.sectionType)}$j.log("uri",e.assemble());$j.jsonp(e.assemble(),this,f)};this.set_not_available=function(){this.$root.find(".j-form-val").addClass("showIcon").addClass("error").html("Not Available.")};this.set_available=function(){this.$root.find(".j-reason").removeClass("c-alert").html("<p>"+this.options.character_count_prompt+"</p>");this.$root.find(".j-form-val").addClass("showIcon").removeClass("error").html("Available")};this.set_errors=function(d){if(!this.options.staticLabel&&(this.$root.find(".j-form-val").html()).toLowerCase()!==(d.data.reason).toLowerCase()){this.$root.find(".j-reason").addClass("c-alert").html("<p>"+d.data.reason+"</p>")}}},{autoload:true})})(jQuery);(function(a){var b="j_zinger2_newsvine";a.fn.zinger_login=function(){return false};a.fn.zinger_disconnect=function(){return false};a.fn.zinger_collect_email=function(c){var i="zing";var n="menu";var m="msnbc";var d=a(this);var g=null;var k=null;if(d.parents(".j_zinger2_menu").length>0){d=d.parents(".j_zinger2_menu").find(".j_zinger2_zinger");g=n}else{if(d.parents(".j_zinger2_zinger").length>0){d=d.parents(".j_zinger2_zinger");g=i}}k=d.pluginObj("j_zinger2_zinger");k.pluginDestroy();if(d.parents(".msnbc_user_account").length>0){g=m}d.addClass("c-zinger-collect-email");d.html($j.mtmpl.j_zinger2_menu.collect_email);d.find("form").submit(function(q){q.preventDefault();d.find(".c-error").hide();var p=a(this).serializeArray();var o=p[0].value;if(!$j.util.validate_email(o)){d.find(".j-invalid-email").show()}else{$j.jsonp($j.session.host.getAPIPath(true)+"user/emailTaken?email="+o,function(s){if(s.data.emailTaken==true){d.find(".j-taken-login").show();d.find(".j-login").click(function(t){e(t,o)})}else{var r=$j.uri($j.session.host.getAPIPath(true,true)+"accounts/auth/"+c+"Login");r.setParam("email",o);r.setParam("rdResponse",$j.session.host.getJSONPEndpoint());$j.jsonp(r.assemble(),function(u){var t=$j.uri(window.location).getParam("redirect");if(t){window.location=t}j();$j.session.UserLoader.getUserData(function(v){$j.session.user.login(v,c+"_signup")});l()})}})}});var l=function(p){if(p==n){a("body").click();k&&k.render_profile_menu($j.session.user);k.set_default_title()}else{if(p==m){var o=d.parents(".msnbc_user_account").pluginObj("msnbc_user_account");o.on_login("register");o.close_menu()}else{if(p==i){if(typeof k.options.callback=="function"){k.options.callback.call()}}}}};var h=function(){d.html("<p>Please check your inbox to validate your e-mail address.</p>")};function e(r,p){r.preventDefault();d.find(".j-collect-email").hide();var q=a(".j-zinger-newsvine",d);if(!q.length){$signin_form=a('<span class="j-zinger-newsvine"></span>');var o={email:p,pw_land:$j.session.host.getRegDomainRoot(true)+"_tps/accounts/global/settings#social_connect",zingerWidget:k};$signin_form.appendTo(d);($signin_form[b])(o);$j.session.user.onLogin(function(){if(c==="facebook"){d.html('<div class="j_zinger2_facebook" data-button_label="Finish connecting"></div>');d.jenga_loadPlugins();f()}else{if(c==="twitter"){d.html('<div class="j_zinger2_twitter" data-button_label="Finish connecting"></div>');d.jenga_loadPlugins();f()}}})}else{q.show()}}var f=function(){$j.session.user.onLogin(function(o,p){if(p.indexOf("facebook")>=0||p.indexOf("twitter")>=0){j()}if(g==="j_zinger2_menu"){menu_callback()}if(g==="msnbc_user_account"){msnbc_menu_callback()}})};var j=function(){if(d.parents(".j_modal").length>0){a("body").zinger_modal.close()}}};a.oauthpopup=function(c){if(!c||!c.path){throw new Error("options.path must not be empty")}c=a.extend({windowName:"ConnectWithOAuth",windowOptions:"location=0,status=0,width=800,height=490",callback:function(){window.location.reload()}},c);var d=window.open(c.path,c.windowName,c.windowOptions);var e=window.setInterval(function(){if(d.closed){window.clearInterval(e);c.callback()}},1000)};a.fn.oauthpopup=function(c){$this=a(this);$this.click(a.oauthpopup.bind(this,c))};$j.widget("j_zinger2_zinger",function(){this.registerMixin($j.MustacheMixin,{templateClass:"j_zinger2_menu"});this.options={title:"Sign up or sign in",actionText:"",show_privacy:true,newsvine:true,fb:true,twitter:true,google:true,newsvine_options:{},spinnerColor:null,callback:null,mode:"inline",show_terms:false,switch_reg:false,destroyed:false,product:"site",collect_email:true,isModal:false};var e=null;var d=null;var c=null;var f=this;this._render=function(g){if(this._isRendered===false){this.render_login();this.bind_login()}};this.bind_login=function(){$j.session.ready(function(){$j.session.user.onLogin(function(g,h){if((f.options.destroyed==false)&&(h!=="register")){if($j.util.validate_email(g.email)){f.redirect_if_necessary()}if(e.parents(".j_modal").length>0){a("body").zinger_modal.close()}}else{f.clear_widgets({})}if(typeof f.options.callback==="function"){f.options.callback(h)}})})};this.redirect_if_necessary=function(){var l=location.search.substr(1);var k=l.split("&");var g={};for(var h=0;h<k.length;h++){var j=k[h].split("=");g[j[0]]=j[1]}if(g.redirect){$j.jsonp($j.session.host.getAPIPath(true)+"cleanseRedirect?url="+g.redirect,function(i){if(i&&i.data){window.location.href=decodeURIComponent(i.data)}})}};this.hasSocial=function(){var g=f.options;return g.twitter||g.google||g.fb};this.load_social=function(){};this.render_login=function(){var h=f.options;e=this.$root;if(e.parent(".c-zinger").length==0){e.addClass("c-zinger")}e.addClass("c-"+h.mode);if(f.hasSocial()){var g=f.render_template(f.getTemplate("social"),h);e.append(g);f.load_social=function j(){a(".j-zinger-twitter",g).j_zinger2_twitter({product:h.product,collect_email:h.collect_email});a(".j-zinger-google",g).j_zinger2_google({product:h.product,collect_email:h.collect_email});a(".j-zinger-fb",g).j_zinger2_facebook({product:h.product,collect_email:h.collect_email});f.load_social=function(){}};if(h.mode=="inline"){f.load_social()}}if(h.newsvine){(function i(){try{if(typeof a.fn.j_zinger2_signin==="function"){if(h.isModal){if($j.session.host.domainRoot=="today.com"){b="j_zinger2_signin"}}else{if($j.uri(window.location).getParam("z3")){b="j_zinger2_signin"}}}}catch(k){$j.log(k)}})();$j.log(b);a.extend(h.newsvine_options,{product:h.product});d=a('<span class="j-zinger-newsvine"></span>');h.newsvine_options.zingerWidget=f;d.appendTo(e);(d[b])(h.newsvine_options)}if(h.show_privacy||h.show_terms){this.append_template(this.getTemplate("privacy"),{show_privacy:h.show_privacy,show_terms:h.show_terms,show_regLink:h.switch_reg,terms_link:$j.session.host.termsLink,privacy_link:$j.session.host.privacyLink},e);if(h.switch_reg){if(h.newsvine_options.action=="register"){f.switch_register("register",e)}else{f.switch_register("login",e)}d&&d.bind(".j_zinger2_newsvine_login_form_load",function(){f.switch_register("login",e)});d&&d.bind(".j_zinger2_newsvine_register_form_load",function(){f.switch_register("register",e)});c=null}}$j.bind("j_zinger2_clear_widgets",function(k){f.clear_widgets(k)})};this.switch_register=function(g,h){if(!h){h=this.$root}if(c!=g){h.find(".j-footer-reg-link").unbind();if(g=="login"){h.find(".j-footer-reg-link").text("Don't have an account?").attr("title","Don't have an account?").click(function(j){j.preventDefault();d&&(d[b])("render_register_form",{})});h.find(".j_zinger2_twitter").j_zinger2_twitter("toggle_register");h.find(".j_zinger2_google").j_zinger2_google("toggle_register");h.find(".j_zinger2_facebook").j_zinger2_facebook("toggle_register")}else{if(g=="register"){h.find(".j-footer-reg-link").text("Already registered?").attr("title","Already registered?").click(function(j){j.preventDefault();d&&(d[b])("render_login",{});h.find(".j-underage-error").hide()});h.find(".j_zinger2_twitter").j_zinger2_twitter("toggle_register","register");h.find(".j_zinger2_google").j_zinger2_google("toggle_register","register");h.find(".j_zinger2_facebook").j_zinger2_facebook("toggle_register","register");h.find(".j-display-name input").attr("placeholder","display name")}}var i=function(){var j=document.createElement("input");return("placeholder" in j)};if(!i()){h.find("[placeholder]").focus(function(){var j=a(this);if(j.val()==j.attr("placeholder")){j.val("");j.removeClass("c-placeholder");if(j.hasClass("j-wasPass")){j.removeClass("j-wasPass");j[0].type="password"}}}).blur(function(j){j.stopPropagation();var k=a(this);if(k.val()==""||k.val()==k.attr("placeholder")){k.addClass("c-placeholder");k.val(k.attr("placeholder"));if(k.attr("type")=="password"){k.addClass("j-wasPass");k[0].type="text"}}}).blur()}c=g}};this.clear_widgets=function(g){if($j.session.user.email&&$j.util.validate_email($j.session.user.email)){if(!e){return}if(g){if(g.removeNewsvine){removeNewsvine=g.removeNewsvine;if(removeNewsvine===true&&f.options.newsvine){e.find(".j-zinger-newsvine").empty()
}}}e.find("em").remove();e.find(".j-footer-reg-link").remove();e.find(".c-social-login").remove();e.find(".c-menu-footer").remove()}};this.spin=function(g){var h=a(".j-spinner",e);if(!h.length){h=a('<span class="j-spinner c-overlay-spinner c-spin"></span>');e.prepend(h)}if(g){h.spin("small",this.options.spinnerColor).show()}else{h.spin(false).hide()}return h};this.set_title=function(g){if(f.options.isModal){a("body").zinger_modal.set_title(g);return}e&&a("h1",e).html(g?g:f.options.title+" "+f.options.actionText)};this.set_default_title=function(){f.set_title()};this.pluginDestroy=function(){f.options.destroyed=true}},{autoload:true})})(jQuery);(function(a){$j.ts("register",["_nv_zinger2_register_start","_nv_zinger2_registerclick","nv_user_loginclick","nv_user_forgotpasswordclick","nv_user_loginfork"],{allowDuplicate:true});$j.widget("j_zinger2_signin",function(){this.registerMixin($j.MustacheMixin);var f=this;var b="fork";var l="login";var o="register";var e="recovery";var i="finish";var j=b;this.options={email:null,displayValidity:false,display:null,validEmail:false,onNotFound:null,action:b,spinnerColor:null,render_callback:null,display_name:null,reg_override:null,land:null,pw_land:null,product:"site",zingerWidget:null};var n=null;var q=f.options;var k=f.$root;var h=q.email;f._render=function(){q=f.options;if(f._isRendered===false){q.action=q.action||b;var r=q.action;k.addClass("c-"+r+"-only");p(r);q.zingerWidget.$root.find("em").remove()}if(q.render_callback){q.render_callback()}};var d={};f.setModeAction=function(r,s){d[r]=s};function p(t){g(t);var s=d[t];var r=f["render_"+t+"_form"];if(s!==undefined){s(r)}else{r()}}function g(r){if(r){var s=f.options.zingerWidget;$parent=s.$root;$parent.removeClass("b-mode-"+j);$parent.addClass("b-mode-"+r);j=r;if(r==b){s.set_default_title()}else{s.set_title(f.render_template(f.getTemplate(r+"_msg"),{}))}}return j}f.render_finish_form=function(){var s=f.render_template_partials(f.getTemplate("finish"),{email:q.email},f.templates());var r=a(".j-z-menu",k);r.length?r.replaceWith(s):k.append(s);f.bind_start_over()};f.render_fork_form=function(){var s=f.render_template_partials(f.getTemplate("fork"),{email:q.email,hasStartEmail:h},f.templates());if(!f.options.zingerWidget.hasSocial()){a(".j-or",s).hide()}var r=a(".j-z-menu",k);r.length?r.replaceWith(s):k.append(s);f.bind_fork_submit()};f.render_login_form=function(){var s=f.render_template_partials(f.getTemplate("login"),{email:q.email,avatar:n},f.templates());var r=a(".j-z-menu",k);r.length?r.replaceWith(s):k.append(s);f.bind_start_over();f.bind_login_submit();f.bind_pw_recovery();f.attach_post_login();k.trigger("j_zinger2_newsvine_login_form_load");var t=s.find('input[name="password"]');t.focus()};f.attach_post_login=function(){$j.session.ready(function(r){r.onLogin(function(s,t){if(t=="register"){f.render_template(f.getTemplate("registration_confirmation"),{path:$j.session.host.getLogoutUrl(),email:q.email},k);f.bind_confirmation_clicks();$j.trigger("j_zinger2_clear_widgets")}else{k.find(".j-spinner").spin(false).hide()}k.find('input[name="email"]').val("");k.find('input[name="password"]').val("");$j.log("User is signed in",s)})})};f.bind_confirmation_clicks=function(){k.find(".j-resend").click(function(){k.find(".j-confirmation-container").hide();k.find(".j-email-container").show();f.request_invite()})};f.request_invite=function(){var r=$j.uri($j.session.host.getAPIPath(true)+"servista/requestInvite");r.setParam("email",q.email);r.setParam("redirect",$j.session.host.getJSONPEndpoint());if(q.reg_override){r.setParam("regOverride",q.reg_override)}$j.jsonp(r.assemble(),function(s){})};function c(){p(i);k.find(".j-unvalidated-email").show();f.render_resend_confirmation()}function m(){p(i);k.find(".j-missing-password").show();f.render_resend_confirmation()}f.bind_fork_submit=function(){var r=k.find(".j-signin-fork");r.submit(function(u){$j.ts("track","nv_user_loginfork");k.find(".j-error").hide();r.find("input").removeClass("c-error");u.preventDefault();u.stopPropagation();var t=r.find('input[name="email"]').val();if(!t){k.find('input[name="email"]').addClass("c-error").show();k.find(".j-empty-email.j-error").show();return}q.email=t;(function s(){if(!$j.util.validate_email(t)){k.find(".j-error").hide();f.show_invalid_email_error()}else{function w(x){k.find(".j-error").hide();if(x.validated===false){c()}else{if(x.hasPassword===false){m()}else{if(q.validEmail){p(l)}}}}function v(x){p(o)}f.check_email(t,w,v)}})()})};f.bind_login_submit=function(){var s=k.find(".j-login-form");var t=s.find('input[name="password"]');var r=s.find('input[name="email"]');s.submit(function(w){$j.ts("track","nv_user_loginclick");w.preventDefault();w.stopPropagation();k.find(".j-error").hide();s.find("input").removeClass("c-error");var v=r.val();if(!v){r.addClass("c-error").show();k.find(".j-empty-email.j-error").show();return}q.email=v;var u=t.val();if(!u){t.addClass("c-error").show();return}f.handle_login(v,u)})};f.handle_login=function(t,r){k.find(".j-spinner").spin("small",q.spinnerColor).show();var s=$j.uri($j.session.host.getAPIPath(true,true,false)+"accounts/login");s.setParam("responseType","json");s.setParam("email",t);s.setParam("password",r);s.setParam("redirect",$j.session.host.getJSONPEndpoint(true));$j.jsonp(s.assemble(),f,function(u){if(u.statusCode=="failure"){k.find(".j-spinner").spin(false).hide();if(u.data.errors.L3){location.reload()}else{if(u.data.errors.L5){if(typeof q.onNotFound==="function"){q.onNotFound()}k.find(".j-error.j-email").show()}else{if(u.data.errors.L6){k.find(".j-error.j-banned").show()}else{if(u.data.errors.L7){k.find(".j-error.j-locked").show()}else{k.find(".j-error.j-pw").show()}}}}}else{if(u.statusCode=="success"){$j.session.UserLoader.getUserData(function(v){$j.session.user.login(v,"newsvine_login")})}}})};f.bind_pw_recovery=function(){k.find(".j-pw-recovery").click(function(r){$j.ts("track","nv_user_forgotpasswordclick");r.stopPropagation();p(e)})};f.show_invalid_email_error=function(){k.find(".j-error.j-invalid").show()};f.render_recovery_form=function(){var t=f.render_template_partials(f.getTemplate("recover_pw"),{email:q.email},f.templates());var s=a(".j-z-menu",k);s.length?s.replaceWith(t):k.append(t);var r=t.find('input[name="email"]');r.focus();k.find(".j-recover-form").submit(function(u){u.preventDefault();k.find(".j-spinner").spin("tiny",q.spinnerColor);q.email=r.val();if($j.util.validate_email(q.email)){f.check_email(q.email,f.send_reset,f.render_recovery_form_error)}else{f.show_invalid_email_error()}k.find(".j-spinner").spin(false)});r.focus(function(){k.find(".j-error").hide()});f.bind_start_over();f.bind_register()};f.check_email=function(r,u,t){var s=$j.session.host.getAPIPath(true)+"user/emailTaken?email="+r.urlencode();$j.jsonp(s,f,function(v){if(v.data.emailTaken==true){q.validEmail=true;q.email=r;n=v.data.avatar;u(v)}else{t()}},{cache:false})};f.render_recovery_form_error=function(){k.find(".j-unregistered-email").show()};f.send_reset=function(){k.find(".j-spinner").spin("tiny",q.spinnerColor);var s=$j.uri($j.session.host.getResetPassUrl(q.email,$j.session.host.getJSONPEndpoint(true)));if(q.pw_land){s.setParam("land",q.pw_land)}var r=s.assemble();$j.jsonp($j.session.host.getLogoutUrl(r),function(t){f.reset_pass_callback(t)})};f.reset_pass_callback=function(r){if(r.status=="success"||r.statusCode=="success"){k.find(".j-spinner").spin(false);p(i);k.find(".j-success").show();setTimeout(function(){$j.trigger("j_zinger2_newsvine_reset_pass");$j.trigger("j_zinger2_close_menu");if(k.parents(".j_modal").length===0){k.find(".j-start-over").mousedown()}},4000)}};f.bind_start_over=function(){k.find(".j-start-over").mousedown(function(r){r.stopPropagation();r.preventDefault();if(k.parents(".j_zinger2_zinger").length>0){k.parents(".j_zinger2_zinger").find(".j-underage-error").hide()}p(b)})};f.bind_register=function(){k.find(".j-register").click(function(r){q.email=k.find('.j-login-form input[name="email"]').val();r.preventDefault();r.stopPropagation();p(o);$j.trigger("j_zinger2_newsvine_register_click",{target:r})})};f.render_register_form=function(){var s=f.render_template_partials(f.getTemplate("register"),{email:q.email},f.templates());var r=a(".j-z-menu",k);r.length?r.replaceWith(s):k.append(s);k.find(".j-register .j-check-name").j_zinger2_checkname({checkType:"display",placeholder:"Display name",callback:function(u){q.displayValidity=u},staticLabel:true,showLabel:false,defaultVal:q.display_name});var t=s.find('input[name="display-name"]');t.focus();f.bind_start_over();f.bind_email_check();f.bind_register_submit();f.attach_post_login();k.trigger("j_zinger2_newsvine_register_form_load");
$j.ts("track","_nv_zinger2_register_start",{product:q.product})};f.bind_email_check=function(){$emailInput=k.find('.j-register input[name="email"]');$emailInput.focus(function(){k.find(".j-error").hide();q.validEmail=false});var r=false;$emailInput.blur(function(t){t.preventDefault();t.stopPropagation();var s=$emailInput.val();if(s!=$emailInput.attr("placeholder")){f.validate_register_email(s,f.set_valid_email);r=true}});$emailInput.keyup(function(s){if(r){if($j.util.validate_email(k.find('.j-register input[name="email"]').val())){k.find(".j-error").hide();k.find(".j-error-container").empty()}else{if(k.find(".j-error.j-invalid:visible").length===0){f.show_invalid_email_error()}}}})};f.validate_register_email=function(s,r){if(s){if(!$j.util.validate_email(s)){k.find(".j-error").hide();f.show_invalid_email_error()}else{f.check_email(s,f.account_incomplete,r)}}};f.set_valid_email=function(){q.validEmail=true};f.bind_register_submit=function(){k.find(".j-register").submit(function(r){if($j.session.user.get_underage_cookie()){k.find(".j-underage-error").show();return false}$j.ts("track","_nv_zinger2_registerclick");r.preventDefault();q.email=a(r.target).find('input[name="email"]').val();q.display=a(r.target).find('input[name="display-name"]').val();if(q.display.length<4){k.find(".j-form-val").html("Your display name must be at least 4 characters").addClass("error")}else{if(q.display.length>35){k.find(".j-form-val").html("Your display name must be less than 35 characters")}else{if(q.displayValidity&&q.validEmail){f.send_quick_reg()}else{if(q.email.length===0){k.find(".j-error.j-empty-email").show()}else{if(q.displayValidity&&!q.validEmail){f.validate_register_email(q.email,f.send_quick_reg)}else{alert("Please fix errors before continuing")}}}}}})};f.render_resend_confirmation=function(){k.find(".j-resend-invite").click(function(){f.request_invite();p(i);k.find(".j-validate-prompt").show()})};f.account_incomplete=function(r){q.validEmail=false;k.find(".j-error").hide();if(r.validated===false){c()}else{if(r.hasPassword===false){m()}else{k.find(".j-registered-email.j-error").show();q.email=k.find('.j-register input[name="email"]').val();f.bind_pw_recovery()}}};f.send_quick_reg=function(){k.find(".j-spinner").spin("tiny",q.spinnerColor).show();$j.log("....... CALLING QUICK REG......");var s=$j.uri($j.session.host.getAPIPath(true,true)+"accounts/register");s.setParam("responseType","redirect");s.setParam("redirect",$j.session.host.getJSONPEndpoint(true));s.setParam("email",q.email);s.setParam("displayName",q.display);s.setParam("product",q.product);var r=location.href;if(q.land){r=q.land}s.setParam("land",r);if(q.reg_override){s.setParam("regOverride",q.reg_override)}$j.jsonp(s.assemble(),this,function(t){f.handle_quick_reg(t.statusCode,t.data)},{cache:false})};f.handle_quick_reg=function(u,v){if(u==="success"){$j.session.UserLoader.getUserData(function(w){$j.session.user.login(w,"register")})}else{var t=v.errors?"":"Registration was unsuccessful. Please try again.";for(var s in v.errors){var r=v.errors[s];if(r){t+="<div>"+r+"</div>"}}f.update_status(t,"error");f.$footer.showView({reset_password:false,register_new:false,contact_us:true,start_over:true})}k.find(".j-spinner").spin(false)}},{autoload:true})})(jQuery);(function(a){$j.ts("register",["_nv_zinger2_facebook_click"]);$j.widget("j_zinger2_facebook",function(){var c=this;var d=false;var h=this.$root;var g=a("button",h);var b=a(".j-underage-error",h);var f=g.text();var i=0;this.options={register_label:"Register with Facebook",perms:null,scope:null,connected_callback:null,disconnect_label:"Disconnect from Facebook",product:"site",collect_email:true,register_state:"login"};var e=this.options;this._render=function(){if(c._isRendered){return}$j.session.ready(function(l){if(l.isRegistered()){i=l.hasAffiliation("facebook")}var m=i?e.disconnect_label:f;g.html(m)});g.click(function k(m){g.parent().spin();$j.fb(function l(n){g.parent().spin(false);j(m)})});function j(m){m.preventDefault();var l=g.parents(".j_zinger2_zinger");if(l.find(".j_zinger2_newsvine .j-z-register-form").length>0&&$j.session.user.get_underage_cookie()){l.find(".j-underage-error").hide();b.show()}$j.trigger("j_zinger2_social_click",{parentElem:g.parents(".j_zinger2_zinger"),elem:g});if(i){c.facebook_disconnect()}else{c.facebook_connect()}}};this.facebook_disconnect=function(){if(confirm("Are you sure you want to disconnect your account from Facebook?")){a.ajax("/_nv/api/accounts/auth/facebookLogin?delete=1");g.html(f);i=0}};this.getPerms=function(){if(e.perms===null){$j.log("getting perms from FBClient=",$j.ext.FacebookClient.getPerms());return $j.ext.FacebookClient.getPerms()}else{$j.log("using defined perms=",e.perms);return e.perms}};this.toggle_to_disconnect=function(){g.html(e.disconnect_label);i=1};this.toggle_register=function(j){if(j=="register"){g.html(e.register_label);e.register_state="register"}else{g.html(f);e.register_state="login"}};this.facebook_connect=function(){$j.ts("track","_nv_zinger2_facebook_click",{product:e.product,register_state:e.register_state});var j=this.getPerms();FB.login(function(k){$j.log("getLoginStatus",k,k.status);$j.ext.FacebookClient.updateResponse(k);if(k.status==="connected"){$j.log("connected to FB");$j.fb.hasPerms(j,function(){this.newsvine_login_using_facebook(k);this.connected_callback(k)},function(){$j.log("cancelled request for permissions")},c)}else{$j.log("NOT connected to FB");FB.Event.subscribe("auth.login",function(n){try{var l="http://www.newsvine.com/_action/admin/debug?subj=fb-auth-login&msg=yes&url="+location.href.urlencode();$j.jsonp(l)}catch(m){}$j.ext.FacebookClient.updateResponse(n);$j.fb.hasPerms(j,function(){this.newsvine_login_using_facebook(n);this.connected_callback(n)},function(){$j.log("cancelled request for permissions")},c)})}},{scope:j})};this.connected_callback=function(j){if(a.isFunction(this.options.connected_callback)){var k=this.options.scope||this;this.options.connected_callback.call(k,j)}};this.newsvine_login_using_facebook=function(j){var k=$j.uri($j.session.host.getRegDomainRoot()+"_nv/api/accounts/auth/facebookLogin");k.setParam("multiDomainLogin",true);k.setParam("token",j.authResponse.accessToken);k.setParam("redirect","/_api/user/JSONPEndpoint");k.setParam("product",this.options.product);$j.jsonp(k.assemble(),function(l){$j.session.UserLoader.getUserData(function(n){var m="facebook_signin";if((Date.now()-(n.memberSince*1000))<86400000){m="facebook_signup"}window.location.hash=m;if(!$j.util.validate_email(n.email)&&e.collect_email){h.zinger_collect_email("facebook")}else{$j.session.user.login(n,m)}if(h.parents(".j_zinger2_zinger").length==0){c.toggle_to_disconnect()}})},{cache:false})}},{autoload:true})})(jQuery);(function(a){$j.ts("register",["_nv_zinger2_twitter_click"]);$j.widget("j_zinger2_twitter",function(){var c=this;var g=this.$root;var f=g.find("button");var b=g.find(".j-underage-error");var e=f.text();var h=0;this.options={register_label:"Register with Twitter",disconnect_label:"Disconnect from Twitter",product:"site",collect_email:true,register_state:"login"};var d=this.options;this._render=function(){if(this._isRendered){return}$j.session.ready(function(i){if($j.session.user.isRegistered()){h=i.hasAffiliation("twitter")}c.setup_button()})};this.setup_button=function(){var i=h?d.disconnect_label:e;f.html(i);f.click(this,function(k){var j=f.parents(".j_zinger2_zinger");if(j.find(".j_zinger2_newsvine .j-z-register-form").length>0&&$j.session.user.get_underage_cookie()){j.find(".j-underage-error").hide();b.show();return false}k.preventDefault();$j.trigger("j_zinger2_social_click",{parentElem:j,elem:f});if(h){k.data.handle_disconnect_click()}else{k.data.handle_twitter_button_click()}})};this.handle_disconnect_click=function(){if(confirm("Are you sure you want to disconnect your account from Twitter?")){a.ajax("/_nv/api/accounts/auth/twitterLogin?delete=1");f.html(e);h=0}};this.toggle_register=function(i){if(i=="register"){f.html(d.register_label);d.register_state="register"}else{f.html(e);d.register_state="login"}};this.handle_twitter_button_click=function(){$j.ts("track","_nv_zinger2_twitter_click",{product:d.product,register_state:d.register_state});var i=$j.uri($j.session.host.getAPIPath(true,true,false)+"accounts/auth/TwitterGetToken");i.setParam("domainRoot",$j.session.host.getDomainRoot());i.setParam("redirect",window.location.href);i.setParam("product",d.product);a.oauthpopup({path:i.assemble(),callback:function(){$j.session.UserLoader.getUserData(function(k){if(k.displayName){var j="twitter_signin";if((Date.now()-(k.memberSince*1000))<300000){j="twitter_signup"}window.location.hash=j;if(!$j.util.validate_email(k.email)&&d.collect_email){g.zinger_collect_email("twitter")}else{$j.session.user.login(k,j)}if(g.parents(".j_zinger2_zinger").length==0){h=1;f.html(d.disconnect_label)}}})}})}},{autoload:true})})(jQuery);(function(a){$j.ts("register",["_nv_zinger2_google_click"]);$j.widget("j_zinger2_google",function(){var c=this;var g=this.$root;var f=a("button",g);var b=g.find(".j-underage-error");var e=f.text();var h=0;this.options={register_label:"Register with Google",disconnect_label:"Disconnect from Google",product:"site",register_state:"login"};var d=this.options;this._render=function(){if(this._isRendered){return}$j.session.ready(function(i){if($j.session.user.isRegistered()){h=i.hasAffiliation("google")}c.setup_button()})};this.setup_button=function(){var j=h?d.disconnect_label:d.button_label;f.html(j);var i=a(this).parents(".j_zinger2_zinger");f.click(this,function(k){if(i.find(".j_zinger2_newsvine .j-z-register-form").length>0&&$j.session.user.get_underage_cookie()){i.find(".j-underage-error").hide();b.show();return false}k.preventDefault();$j.trigger("j_zinger2_social_click",{parentElem:i,elem:a(this)});if(h){c.google_disconnect()}else{c.google_connect()}})};this.google_disconnect=function(){if(confirm("Are you sure you want to disconnect your account from Google?")){a.ajax("/_nv/api/accounts/auth/googleLogin?delete=1");f.html(e);h=0}};this.toggle_to_disconnect=function(){f.html(d.disconnect_label)};this.toggle_register=function(i){if(i=="register"){f.html(d.register_label);d.register_state="register"}else{f.html(d.button_label);d.register_state="login"}};this.google_connect=function(){$j.ts("track","_nv_zinger2_google_click",{product:d.product,register_state:d.register_state});$j.session.ready(function(j){var i=$j.session.user.isLoggedIn();var k=$j.uri($j.session.host.getAPIPath(true,true,false)+"accounts/auth/googleLogin");k.setParam("redirect",window.location.href);k.setParam("product",d.product);a.oauthpopup({path:k.assemble(),callback:function(){$j.session.UserLoader.getUserData(function(m){if(m.displayName){var l="google_signin";if((Date.now()-(m.memberSince*1000))<300000){l="google_signup"}window.location.hash=l;$j.session.user.login(m,l);if(g.parents(".j_zinger2_zinger").length==0){h=1;c.toggle_to_disconnect()}}})}})})}},{autoload:true})})(jQuery);(function(a){$j.ts("register",["_nv_zinger2_register_start","_nv_zinger2_registerclick","nv_user_loginclick","nv_user_forgotpasswordclick"],{allowDuplicate:true});$j.widget("j_zinger2_newsvine",function(){var b=this;b.registerMixin($j.MustacheMixin);b.options={email:null,displayValidity:false,display:null,validEmail:false,onNotFound:null,action:null,registerTitle:"Sign up",render_callback:null,initial_render:false,display_name:null,reg_override:null,land:null,pw_land:null,product:"site",zingerWidget:null};b._render=function(){if(b._isRendered===false){if(b.options.action){b.$root.addClass("c-"+b.options.action+"-only")}if(!b.options.action||b.options.action=="login"||b.options.initial_render==true){b.render_template(b.getTemplate("login"),{email:b.options.email},b.$root,b.templates());b.bind_login();b.bind_pw_recovery();b.bind_register();b.attach_login();b.$root.trigger("j_zinger2_newsvine_login_form_load")}else{if(b.options.action=="register"){b.render_register_form()}}b.options.zingerWidget&&b.options.zingerWidget.set_default_title()}if(b.options.render_callback){b.options.render_callback()}else{return}};b.attach_login=function(){var c=b.options.zingerWidget;$j.session.ready(function(d){d.onLogin(function(e,f){if(f=="register"){b.render_template(b.getTemplate("registration_confirmation"),{path:$j.session.host.getLogoutUrl(),email:b.options.email},b.$root);b.bind_confirmation_clicks();$j.trigger("j_zinger2_clear_widgets")}else{c.spin(false)}b.$root.find('input[name="email"]').val("");b.$root.find('input[name="password"]').val("");$j.log("User is signed in",e)})})};b.bind_confirmation_clicks=function(){b.$root.find(".j-resend").click(function(){b.$root.find(".j-confirmation-container").hide();b.$root.find(".j-email-container").show();b.request_invite()})};b.request_invite=function(){var c=$j.uri($j.session.host.getAPIPath(true)+"servista/requestInvite");c.setParam("email",b.options.email);c.setParam("redirect",$j.session.host.getJSONPEndpoint());if(b.options.reg_override){c.setParam("regOverride",b.options.reg_override)}$j.jsonp(c.assemble(),function(d){})};b.bind_login=function(){b.$root.find(".j-login-form").submit(function(f){$j.ts("track","nv_user_loginclick");b.$root.find(".j-error").hide();a(f.target).find("input").removeClass("c-error");f.preventDefault();f.stopPropagation();var d=a(f.target).find('input[name="email"]').val();if(!d){a(f.target).find('input[name="email"]').addClass("c-error").show();b.$root.find(".j-empty-email.j-error").show();return}b.options.email=d;var c=a(f.target).find('input[name="password"]').val();if(!c){a(f.target).find('input[name="password"]').addClass("c-error").show();return}b.handle_login(d,c)})};b.handle_login=function(e,c){b.options.zingerWidget.spin(true);var d=$j.uri($j.session.host.getAPIPath(true,true,false)+"accounts/login");d.setParam("responseType","json");d.setParam("email",e);d.setParam("password",c);d.setParam("redirect",$j.session.host.getJSONPEndpoint(true));$j.jsonp(d.assemble(),b,function(f){if(f.statusCode=="failure"){b.options.zingerWidget.spin(false);if(f.data.errors.L3){location.reload()}else{if(f.data.errors.L5){if(typeof b.options.onNotFound==="function"){b.options.onNotFound()}b.$root.find(".j-error.j-email").show()}else{if(f.data.errors.L6){b.$root.find(".j-error.j-banned").show()}else{if(f.data.errors.L7){b.$root.find(".j-error.j-locked").show()}else{b.$root.find(".j-error.j-pw").show()}}}}}else{if(f.statusCode=="success"){$j.session.UserLoader.getUserData(function(g){$j.session.user.login(g,"newsvine_login")})}}})};b.bind_pw_recovery=function(){b.$root.find(".j-pw-recovery").click(function(c){$j.ts("track","nv_user_forgotpasswordclick");c.stopPropagation();b.render_recovery()})};b.show_invalid_email_error=function(){b.$root.find(".j-error.j-invalid").show()};b.render_recovery=function(){b.render_template(b.getTemplate("recover_pw"),{email:b.options.email},b.$root.find(".j-z-menu"),b.templates());b.$root.find('input[name="email"]').focus();b.$root.find(".j-recover-form").submit(function(c){c.preventDefault();b.$root.find(".j-spinner").spin("tiny",b.options.spinnerColor);b.options.email=a(c.target).find('input[name="email"]').val();if($j.util.validate_email(b.options.email)){b.check_email(b.options.email,b.send_reset,b.render_recovery_error)}else{b.show_invalid_email_error()}b.$root.find(".j-spinner").spin(false)});b.$root.find('.j-recover-form input[name="email"]').focus(function(){b.$root.find(".j-error").hide()});b.bind_start_over();b.bind_register()};b.check_email=function(c,f,e){var d=$j.session.host.getAPIPath(true)+"user/emailTaken?email="+c.urlencode();$j.jsonp(d,b,function(g){if(g.data.emailTaken==true){b.options.validEmail=true;b.options.email=c;f(g)}else{e()}},{cache:false})};b.render_recovery_error=function(){b.$root.find(".j-unregistered-email").show()};b.send_reset=function(){b.$root.find(".j-spinner").spin("tiny",b.options.spinnerColor);var d=$j.uri($j.session.host.getResetPassUrl(b.options.email,$j.session.host.getJSONPEndpoint(true)));if(b.options.pw_land){d.setParam("land",b.options.pw_land)}var c=d.assemble();$j.jsonp($j.session.host.getLogoutUrl(c),function(e){b.reset_pass_callback(e)})};b.reset_pass_callback=function(c){if(c.status=="success"||c.statusCode=="success"){b.$root.find(".j-spinner").spin(false);b.$root.find(".j-success").show();setTimeout(function(){$j.trigger("j_zinger2_newsvine_reset_pass");$j.trigger("j_zinger2_close_menu");if(b.$root.parents(".j_modal").length===0){b.$root.find(".j-start-over").mousedown()}},2500)}};b.bind_start_over=function(){b.$root.find(".j-start-over").mousedown(function(c){c.stopPropagation();c.preventDefault();if(b.$root.parents(".j_zinger2_zinger").length>0){b.$root.parents(".j_zinger2_zinger").find(".j-underage-error").hide()}b.render_login()})};b.render_login=function(){b._isRendered=false;b._render()};b.bind_register=function(){b.$root.find(".j-register").click(function(c){b.options.email=b.$root.find('.j-login-form input[name="email"]').val();c.preventDefault();c.stopPropagation();b.render_register_form();$j.trigger("j_zinger2_newsvine_register_click",{target:c})})};b.render_register_form=function(){if(b.options.action==="register"){b.options.initial_render=true}b.render_template(b.getTemplate("register"),{registerTitle:b.options.registerTitle,email:b.options.email},b.$root,b.templates());b.$root.find('input[name="email"]').focus();b.$root.find(".j-register .j-check-name").j_zinger2_checkname({checkType:"display",label:"Display name",callback:function(c){b.options.displayValidity=c},staticLabel:true,defaultVal:b.options.display_name});b.bind_start_over();b.bind_email_check();b.bind_register_submit();b.$root.trigger("j_zinger2_newsvine_register_form_load");$j.ts("track","_nv_zinger2_register_start",{product:b.options.product})};b.bind_email_check=function(){$emailInput=b.$root.find('.j-register input[name="email"]');$emailInput.focus(function(){b.$root.find(".j-error").hide();b.options.validEmail=false});var c=false;$emailInput.blur(function(f){f.preventDefault();f.stopPropagation();var d=$emailInput.val();if(d!=$emailInput.attr("placeholder")){b.validate_register_email(d,b.set_valid_email);c=true}});$emailInput.keyup(function(d){if(c){if($j.util.validate_email(b.$root.find('.j-register input[name="email"]').val())){b.$root.find(".j-error").hide();b.$root.find(".j-error-container").empty()}else{if(b.$root.find(".j-error.j-invalid:visible").length===0){b.show_invalid_email_error()}}}})};b.validate_register_email=function(d,c){if(d){if(!$j.util.validate_email(d)){b.$root.find(".j-error").hide();b.show_invalid_email_error()}else{b.check_email(d,b.email_registered_error,c)}}};b.set_valid_email=function(){b.options.validEmail=true};b.bind_register_submit=function(){b.$root.find(".j-register").submit(function(c){if($j.session.user.get_underage_cookie()){b.$root.find(".j-underage-error").show();return false}$j.ts("track","_nv_zinger2_registerclick");c.preventDefault();b.options.email=a(c.target).find('input[name="email"]').val();b.options.display=a(c.target).find('input[name="display-name"]').val();
if(b.options.displayValidity&&b.options.validEmail){b.send_quick_reg()}else{if(b.options.email.length===0){b.$root.find(".j-error.j-empty-email").show()}else{if(b.options.displayValidity&&!b.options.validEmail){b.validate_register_email(b.options.email,b.send_quick_reg)}else{if(b.options.display.length<4){b.$root.find(".j-form-val").html("Your display name must be at least 4 characters").addClass("error")}else{if(b.options.display.length>35){b.$root.find(".j-form-val").html("Your display name must be less than 35 characters")}else{alert("Please fix errors before continuing")}}}}}})};b.render_resend_confirmation=function(){b.$root.find(".j-resend-invite").click(function(){b.request_invite();b.$root.find(".j-z-menu").hide();b.$root.find(".j-validate-prompt").show()})};b.email_registered_error=function(c){b.options.validEmail=false;b.$root.find(".j-error").hide();if(c.validated===false){b.$root.find(".j-unvalidated-email").show();b.render_resend_confirmation()}else{if(c.hasPassword===false){b.$root.find(".j-missing-password").show();b.render_resend_confirmation()}else{b.$root.find(".j-registered-email.j-error").show();b.options.email=b.$root.find('.j-register input[name="email"]').val();b.bind_pw_recovery()}}};b.send_quick_reg=function(){b.$root.find(".j-spinner").spin("tiny",b.options.spinnerColor).show();$j.log("....... CALLING QUICK REG......");var d=$j.uri($j.session.host.getAPIPath(true,true)+"accounts/register");d.setParam("responseType","redirect");d.setParam("redirect",$j.session.host.getJSONPEndpoint(true));d.setParam("email",b.options.email);d.setParam("displayName",b.options.display);d.setParam("product",b.options.product);var c=location.href;if(b.options.land){c=b.options.land}d.setParam("land",c);if(b.options.reg_override){d.setParam("regOverride",b.options.reg_override)}$j.jsonp(d.assemble(),this,function(e){b.handle_quick_reg(e.statusCode,e.data)},{cache:false})};b.handle_quick_reg=function(f,g){if(f==="success"){$j.session.UserLoader.getUserData(function(h){$j.session.user.login(h,"register")})}else{var e=g.errors?"":"Registration was unsuccessful. Please try again.";for(var d in g.errors){var c=g.errors[d];if(c){e+="<div>"+c+"</div>"}}b.update_status(e,"error");b.$footer.showView({reset_password:false,register_new:false,contact_us:true,start_over:true})}b.$root.find(".j-spinner").spin(false)}},{autoload:true})})(jQuery);(function(d){var f=null;var a=null;var c=null;var e=null;d.fn.zinger_modal=function(g){$this=d(this);f=null;a=$this;var h={title:"Sign up or sign in",actionText:null,on_close:null,modal_class:null,lightbox_message:null};c=d.extend({},h,g);if(!f){if(typeof c.on_close==="function"){c.on_cancel=c.on_close}f=d("<div></div>");if(c.lightbox_message){f.append('<p class="j-modal-msg">'+c.lightbox_message+"</p>")}if(c.modal_class){f.addClass(c.modal_class)}c.isModal=true;f.j_zinger2_zinger(c);f.pluginObj("j_zinger2_zinger").load_social()}f.j_modal_layout(c);e=f.pluginObj("j_modal_layout_inner").$layout;e.addClass("j-zinger-container").addClass("c-zinger-container")};var b=function(h){if(e){var g=d("h1",e);if(h){g.html(h)}else{if(c.actionText){g.html(c.title+" "+c.actionText)}}}else{setTimeout(b,200)}};d.fn.zinger_modal.set_title=b;d.fn.zinger_modal.set_default_title=function(){setTimeout(b,1)};d.fn.zinger_modal.close=function(){f&&f.pluginObj("j_modal_layout_inner").hide();f=null}})(jQuery);(function(a){$j.widget("j_zinger2_menu",function(){var b=this;var f=b.$root;this.registerMixin($j.MustacheMixin);this.options={menu:{avatar_size:20,label_logged_in:null,label_logged_out:"Sign in"},profile:{avatar_size:60},zinger:{title:"Sign in or register below",show_privacy:true,newsvine:true,fb:true,twitter:true,google:true,newsvine_options:{action:null,registerTitle:"Register",reg_override:null,land:null},spinnerColor:null},effects:{target_open:{effect:"slideDown",duration:100},target_close:{effect:"slideUp",duration:100}},callback:null,destroyed:false};var d=this.options;this._render=function(){if(b._isRendered){return}f.addClass("c-zinger");$j.session.ready(function(){var g=$j.session.user;if(!g.isRegistered()){g.onLogin(c)}f.append(e($j.session.user))})};function e(g){var h=d.menu.label_logged_out;if(g.isRegistered()){h=(d.menu.label_logged_in?d.menu.label_logged_in:g.displayName)}var k={label:h,avatar:g.getAvatar(d.menu.avatar_size),avatar_size:d.menu.avatar_size};var j=b.render_template(b.getTemplate("target"),{data:k});function i(o){o.preventDefault();if(j.hasClass("c-focus")){b.close_menu();return}if(!a(".j-menu",f).length){if($j.session.user.isLoggedIn()){b.render_profile_menu($j.session.user)}else{b.render_zinger_menu()}}function m(){j.addClass("c-focus");f.j_clickaway("bind",{clickaway_handle:function(){b.close_menu()}});f.find('input[name="email"]').focus()}var l=a(".j-menu",f);var n=d.effects.target_open.duration||1;var p=d.effects.target_open.effect;l[p](n,"swing",function(){m()})}j.click(i);return j}function c(g,h){if(!f.find(".j-target").hasClass("c-focus")||(f.find(".j-target").hasClass("c-focus")&&$j.util.validate_email(g.email))){if(d.destroyed==true){return false}$j.trigger("j_zinger2_clear_widgets",{removeNewsvine:true});if(h!=="register"){b.append_template(b.getTemplate("login_success"),{},f.find(".j-zinger-login"))}setTimeout(function(){b.close_menu();setTimeout(function(){a(".j-menu",f).remove();var i=f.find(".j-target");$new=e(g);i.replaceWith($new)},d.effects.target_close.duration)},3000);if(d.callback){d.callback.call()}}}this.render_profile_menu=function(g){var i={url:g.url,avatar:g.getAvatar(d.profile.avatar_size),settings:$j.session.host.getAccountSettingsPath(),avatar_size:d.profile.avatar_size,username:g.displayName,logout:$j.session.host.getLogoutUrl(),show_privacy:d.zinger.show_privacy,show_links:true};if(g.loginState==0){i.show_links=false}var h=b.render_template(b.getTemplate("profile"),{data:i,privacy_link:$j.session.host.privacyLink});f.append(h);return h};this.render_zinger_menu=function(){var g=b.render_template(b.getTemplate("zinger"),{});f.append(g);d.zinger.mode="menu";g.j_zinger2_zinger(d.zinger);g.pluginObj("j_zinger2_zinger").load_social();return g};this.close_menu=function(){var g=a(".j-menu",f);function j(){f.find(".j-target").removeClass("c-focus");f.j_clickaway("unbind")}var h=d.effects.target_close.duration||1;var i=d.effects.target_close.effect;g[i](h,function(){j()})};this.pluginDestroy=function(){d.destroyed=true}},{autoload:true})})(jQuery);(function(a){$j.ts("register",["nv_newsletter_subscribe","nv_newsletter_unsubscribe","nv_newsletter_subscribe_click","nv_newsletter_unsubscribe_click"]);$j.namespace("$j.j_newsletter_subscribe");$j.j_newsletter_subscribe={isReady:false,ready:function(b){if($j.j_newsletter_subscribe.isReady===true){b()}else{$j.bind("$j.j_newsletter_subscribe.isReady",function(){b()})}},fetchUserSubs:function(){$j.session.ready(function(){if($j.session.UserLoader.isRegisteredUser()&&$j.session.user.isLoggedIn()&&$j.cookie("userSubs")===null){var b=$j.uri($j.session.host.getAPIPath()+"newsletters/GetUserSubs");b.setParam("guid",$j.cookie("vid"));$j.jsonp(b.assemble(),null,null,{success:function(){},complete:function(){$j.j_newsletter_subscribe.isReady=true;$j.trigger("$j.j_newsletter_subscribe.isReady")}})}else{$j.j_newsletter_subscribe.isReady=true;$j.trigger("$j.j_newsletter_subscribe.isReady")}})},requestSubscribeStatus:function(b,c){$j.j_newsletter_subscribe.ready(function(){var d=false;if($j.cookie("userSubs")!=null&&$j.cookie("userSubs")!="none"){var e=$j.cookie("userSubs").split(",");if(jQuery.inArray(String(b),e)!==-1){d=true}}if(typeof c==="function"){c(d)}})},doSilentSubscribe:function(f){try{var e=a('<div class="j_newsletter_subscribe" style="display: none;" data-show_prompt="false" data-nlid="'+f+'" data-howl_message=""></div>');a("body").append(e);e.jenga_loadPlugins();var c=$j.session.user.email;var b=e.find("form .j-email");if(c&&b.length){b.val(c);e.find("form").submit();$j.log("subscribe "+c+" to "+f)}}catch(d){$j.log(d)}}};$j.j_newsletter_subscribe.fetchUserSubs();$j.widget("j_newsletter_subscribe",function(){this.registerMixin($j.MustacheMixin);var b=this;var d=b.$root;var c="subscribe";var f="unsubscribe";this.options={title:null,img:null,show_prompt:true,prompt_text:"Subscribe to the newsletter",email:null,key:null,brand:null,button_label:"Sign Up",zinger_inline:false,content_node:null,confirm_howl:true,sub_email:null,privacy_link:null,show_privacy:true,type:"newsletter",howl_message:"Thanks. Look for your first issue to arrive soon.",helper_text:null,product:"",subscribed:null,allow_unsub:false,action:c,nlid:null,button_text:null,bypass:false,bypass_email:null,use_checkbox:false,spinner_color:"#000",refresh_on_login:false,placement:null,include_metadata:false,frequency:null,description:null,additional_nlid:null,additional_nl_text:null,additional_nl_appear:true,subs_link:null,intercept:false,cid:false,confirm_options:{}};var e=false;this._render=function(){var g=b.options;$j.session.ready(function h(){g.additional_nl_text=g.additional_nl_text||"Receive email with updates and special offers from "+$j.session.host.brandLabel+"."});if(this._isRendered===false){if(!b.$root.hasClass("newsletter-subscribe")){b.$root.addClass("newsletter-subscribe")}$j.bind("j_newsletter_subscribe_bypass",function(i){g.bypass_email=i.email;g.bypass=true;$j.unbind("j_newsletter_subscribe_bypass")});if(g.include_metadata&&g.nlid){b.fetch_metadata()}else{b.check_user_status()}}else{return}};b.fetch_metadata=function(){$j.session.ready(function(){var g=$j.uri($j.session.host.getAPIPath()+"newsletters/getNewsletterData");g.setParam("subId",b.options.nlid);$j.jsonp(g.assemble(),function(h){if(h.status=="success"&&h.newsletter){b.options.frequency=h.newsletter.frequency;b.options.description=h.newsletter.description;b.options.title=h.newsletter.title}b.check_user_status()})})};b.check_user_status=function(){if($j.session.UserLoader.isRegisteredUser()){$j.session.ready(function(g){b.options.email=g.email;if(g.email){b.options.helper_text='Please change your email in <a href="">account settings</a>.'}$j.j_newsletter_subscribe.requestSubscribeStatus(b.options.nlid,function(h){b.init_form(h)})})}else{b.init_form(false);b.bind_login()}};b.bind_login=function(){$j.session.ready(function(){$j.session.user.onLogin(function(g){b.$root.find(".j-subscribe .j-email").val(g.email);b.options.email=g.email})})};b.init_form=function(g){$j.session.ready(function(){b.options.button_text=b.options.button_label;if(b.options.allow_unsub&&b.options.subscribed){b.options.button_text=f;b.options.action=f}b.options.privacy_link=$j.session.host.privacyLink;b.options.subs_link=$j.session.host.getRegDomainRoot()+"_tps/accounts/newsletters";var h=$j.uri(window.location.href);b.options.prd=h.getParam("prd")?h.getParam("prd"):b.options.prd;b.options.cid=h.getParam("cid");if(!b.options.use_checkbox&&!b.options.allow_unsub){if(g){b.render_template(b.getTemplate("subscribe_widget_subscribed"),{data:b.options},b.$root)}else{b.render_template(b.getTemplate("subscribe_widget"),{data:b.options},b.$root)}}else{b.render_template(b.getTemplate("subscribe_widget"),{data:b.options},b.$root)}b.bind_subscribe();if(b.options.additional_nlid!==null&&b.options.additional_nl_appear){if(!a(".j-email").val()){d.find(".j-additional-subscribe").hide()}b.listen_for_symbol(64)}})};b.listen_for_symbol=function(g){d.find(".j-email").keyup(function(){var h=d.find(".j-email").val();h=h.substr(h.length-1);if(h===String.fromCharCode(g)){d.find(".j-additional-subscribe").fadeIn()}})};b.bind_subscribe=function(){if(b.options.use_checkbox==true){d.find(".j-chckbx-container").on("swipe click",function(g){g.preventDefault();if(d.find(".j-chckbx").attr("disabled")=="disabled"){return false}b.execute_subscribe()});return}d.find(".j-subscribe").submit(function(g){g.preventDefault();b.execute_subscribe()});if($j.session.user.email){d.find(".j-email").on("click",function(h){h.preventDefault();var g=d.find(".j-helper-text");if(g){g.show()}});d.find(".j-helper-text > a").on("click",function(j){j.preventDefault();var i=window.location.href,h=$j.session.host.getAccountSettingsPath(),g=h+"origin="+encodeURIComponent(i);window.location.href=g})}};b.execute_subscribe=function(){var g=d.find(".j-email").val();if(!$j.util.validate_email(g)){alert("Please enter a valid email address");return}if($j.session.user.isLoggedIn()||b.options.action=="unsubscribe"){b.continue_to_subscribe()}else{b.check_email(g,b.launch_login,b.continue_to_subscribe)}};b.error_howl=function(){if(b.options.confirm_howl){$j.howl.notify("An error occurred. Please refresh and try again")}};b.toggle_to_subscribe=function(){b.options.subscribed=false;b.toggle_btn(c)};b.use_howl=function(){return b.options.confirm_howl===true&&!d.hasClass("j-no-howl")};b.init_pending_state=function(){$j.trigger("j_newsletter_subscribe_action_init",{node:d});if(b.options.use_checkbox){d.find(".j-chckbx-label").addClass("c-hide-chckbx");d.find(".j-pending-spin").spin("tiny",b.options.spinner_color).removeClass("c-hide-spin");return}else{if(b.options.allow_unsub){d.find(".j-submit").val("waiting...")}else{d.find(".j-submit").val("Saving");d.find(".j-submit").css("opacity",0.8);d.find(".j-submit").prop("disabled",true)}}};b.fire_error=function(){if(b.use_howl()){b.error_howl()}if(b.options.intercept){b.render_template(b.getTemplate("subscribe_widget_error"),{data:{subs_link:b.options.subs_link}},b.$root)}var g=b.options.subscribed?f:c;b.toggle_btn(g);if(b.options.use_checkbox){$j.trigger("j_newsletter_subscribe_failure",{node:d})}};b.enable_all_widgets=function(){a("body").find(".j_newsletter_subscribe .j-submit").removeAttr("disabled");a("body").find(".j_newsletter_subscribe .j-chckbx").removeAttr("disabled")};b.disable_all_widgets=function(){a("body").find(".j_newsletter_subscribe .j-submit").attr("disabled","disabled");a("body").find(".j_newsletter_subscribe .j-chckbx").attr("disabled","disabled");d.find(".j-submit").removeAttr("disabled");d.find(".j-chckbx").removeAttr("disabled")};b.continue_to_subscribe=function(){b.init_pending_state();var h=null;var g=d.find('input[name="addlSub"]:checked').length>0;if(b.options.email||$j.session.user.email||b.options.action=="unsubscribe"){h=b.buildUrl()}else{b.disable_all_widgets();var i=$j.uri($j.session.host.getAPIPath(true,true)+"accounts/register");i.setParam("email",d.find(".j-subscribe .j-email").val());i.setParam("responseType","redirect");i.setParam("redirect",b.buildUrl($j.session.host.getJSONPEndpoint()));
h=i.assemble()}$j.jsonp(h,null,null,{error:function(){b.fire_error();if(!b.options.email){$j.session.user.logout()}return},success:function(){if(g){b.additional_subscribe()}else{b.finish()}}})};b.additional_subscribe=function(){var g=$j.uri($j.session.host.getAPIPath()+"newsletters/subscribe");g.setParam("subId",b.options.additional_nlid);if(b.options.cid){g.setParam("source",b.options.cid)}$j.jsonp(g.assemble(),null,null,{complete:function(){b.finish()}})};b.finish=function(){if(b.use_howl()){b.do_howl()}if(b.options.intercept){if(b.options.confirm_options.hide_class!=undefined){a("."+b.options.confirm_options.hide_class).hide()}b.render_template(b.getTemplate("subscribe_widget_success"),{data:b.options.confirm_options},b.$root)}var g=d.find('.j-subscribe input[name="action"]').val();if(g=="subscribe"){$j.trigger("j_newsletter_subscribe_bypass",{email:d.find(".j-email").val()})}$j.trigger("j_newsletter_subscribe_fired",{node:d,action:g,name:d.find('.j-subscribe input[name="title"]').val(),nlid:b.options.nlid?b.options.nlid:null});$j.ts("track","nv_newsletter_"+b.options.action,{userObj:$j.session.user,product:b.options.product,newsletterTitle:b.options.title,title:b.options.key,key:b.options.key,id:b.options.nlid,placement:b.options.placement});if(!b.options.email&&b.options.action!=="unsubscribe"){$j.session.user.logout();b.enable_all_widgets()}if(b.options.allow_unsub){if(b.options.subscribed){b.toggle_to_subscribe()}else{b.options.subscribed=true;b.toggle_btn(f)}}else{d.find(".j-submit").val("Saved");d.find(".j-submit").css("opacity",1)}$j.ts("track","nv_newsletter_"+b.options.action+"_click",{userObj:$j.session.user,product:b.options.product,newsletterTitle:b.options.title,title:b.options.key,key:b.options.key,id:b.options.nlid,placement:b.options.placement})};b.do_howl=function(){if(b.options.allow_unsub&&b.use_howl()){var g=d.find('.j-subscribe input[name="title"]').val();var h="subscribed to ";if(b.options.subscribed){h="unsubscribed from"}$j.howl.notify("You have been "+h+" the "+g+" newsletter")}else{if(b.use_howl()){$j.howl.notify(b.options.howl_message,{timer:1000})}}};b.toggle_btn=function(g){d.find(".j-subscribe").removeClass("c-pending").addClass("c-subscribe");if(b.options.use_checkbox){d.find(".j-pending-spin").addClass("c-hide-spin");d.find(".j-chckbx-label").removeClass("c-hide-chckbx");if(g=="subscribe"){d.find(".j-chckbx").removeAttr("checked")}else{d.find(".j-chckbx").attr("checked","checked")}}else{d.find(".j-submit").val(g)}d.find('input[name="action"]').val(g);b.options.action=g;if(g=="subscribe"){d.find(".j-subscribe-block").addClass("c-subscribe").removeClass("c-unsubscribe")}else{d.find(".j-subscribe-block").removeClass("c-subscribe").addClass("c-unsubscribe")}};b.on_modal_close=function(){a("body").find(".zinger_subscribe, .j-zinger-subscribe").remove()};b.launch_login=function(){if(b.options.zinger_inline==true){a("."+b.options.content_node).hide();a('<div class="inline_zinger"></div>').insertAfter("."+b.options.content_node);a(".inline_zinger").j_zinger2_menu({mode:"inline"});$j.session.user.onLogin(function(){a(".inline_zinger").remove();a("."+b.options.content_node).show();b.continue_to_subscribe()})}else{var i=(b.options.refresh_on_login?b.reload:b.continue_to_subscribe);var g=a('<div class="zinger_subscribe"/>').appendTo("body");var h={lightbox_message:"To subscribe, please sign in to your "+$j.session.host.domainRootLabel+" account.",title:"",newsvine_options:{email:d.find(".j-email").val()},callback:i,on_close:b.on_modal_close,modal_class:"j-zinger-subscribe",escape:false,clickaway:false};if(e){h.newsvine_options.validEmail=true;h.newsvine_options.action="login"}g.zinger_modal(h)}};b.reload=function(){location.reload()};b.buildUrl=function(l){var g=d.find(".j-subscribe");var j=g.find('input[name="action"]').val();var i=null;if(b.options.type=="newsletter"){var k=$j.session.host.getAPIPath();if(b.options.brand){k=k.replace($j.session.host.domainRoot,b.options.brand+".com")}if(j=="subscribe"){i=$j.uri(k+"newsletters/subscribe")}else{i=$j.uri(k+"newsletters/unsubscribe")}if(b.options.cid){i.setParam("source",b.options.cid)}var h=g.find(".j-email").val();i.setParam("prd",g.find('input[name="prd"]').val());i.setParam("email",h);i.setParam("subId",g.find('input[name="nlid"]').val());if(h==b.options.bypass_email&&b.options.bypass==true){i.setParam("bypass",b.options.bypass)}if(l){i.setParam("redirect",l)}}else{if(b.options.type=="petition"){i=$j.uri($j.session.host.getJSONPEndpoint())}}return i.assemble()};b.check_email=function(g,j,i){var h=$j.session.host.getAPIPath(true)+"user/emailTaken?email="+g.urlencode();$j.jsonp(h,b,function(k){if(k.data.emailTaken==true){if(k.data.hasPassword===true){e=true}if(b.options.sub_email===g){return false}j()}else{b.options.sub_email=g;i()}},{cache:false})}},{autoload:true,reinit:true})})(jQuery);$j.templates.jenga_widget_modal_layout="<script type=\"text/html\" class=\"template_modal_layout\"><div><div class=\"c-modal-header\" style=\"disply:none;\">{{#close}}<a href=\"#\" class=\"j-modal-close c-modal-close\">&times;</a>{{/close}}{{#title}}<h1 class=\"c-modal-title\">{{title}}</h1>{{/title}}{{#subTitle}}<p class=\"c-modal-sub-title\">{{subTitle}}</p>{{/subTitle}}</div><div class=\"j-modal-body\"></div><div class=\"c-modal-footer\" style=\"display:none;\">{{footer}}<button class=\"c-button b-save\" style=\"display: none;\">{{save_label}}</button><button class=\"c-button b-cancel\" style=\"display: none;\">{{cancel_label}}</button></div></div></script>";
$j.templates.jenga_widget_zinger2_checkname="<script type=\"text/html\" class=\"template_root\"><div class=\"c-form-group j-{{data.labelFor}} c-{{data.labelFor}} c-checkname\">{{#data.showLabel}}<label for=\"{{data.labelFor}}\">{{data.label}}</label>{{/data.showLabel}}<input name=\"{{data.labelFor}}\" type=\"text\" placeholder=\"{{data.placeholder}}\" value=\"{{#data.defaultVal}}{{data.defaultVal}}{{/data.defaultVal}}\" class=\"c-input-text\">{{#data.domainLabel}}{{{data.domainLabel}}}{{/data.domainLabel}}{{> validation }}</div></script><script type=\"text/html\" class=\"template_validation\"><span class=\"c-form-val j-form-val\"></span><span class=\"j-reason c-reason c-alert\"><p>{{data.labelPlural}} must be 4 to 35 characters.</p></span></script>";
$j.templates.jenga_widget_zinger2_signin="<script type=\"text/html\" class=\"template_fork\"><div class=\"j-z-menu c-signin c-fork\"><form class=\"j-signin-fork c-signin-fork\" autocomplete=\"off\"><label for=\"email\" class=\"c-title\"><span class=\"j-or\">Or use your email</span><input class=\"c-input-text c-email\" type=\"text\" name=\"email\" placeholder=\"you@site.com\" {{#email}}value=\"{{email}}\"{{/email}} {{#hasStartEmail}}disabled=\"disabled\"{{/hasStartEmail}} /></label><input type=\"submit\" class=\"c-button c-go\" name=\"go\" value=\"Go\" /></form>{{> empty_email }}{{> invalid_email }}</div></script><script type=\"text/html\" class=\"template_login\"><div class=\"j-z-menu c-signin c-login\">{{> incomplete }}{{> empty_email }}{{> invalid_email }}<form class=\"j-login-form c-login-form\" autocomplete=\"off\" method=\"post\"><!--<img src=\"{{avatar}}\" /> --><label for=\"email\"><span>Email Address</span><input type=\"text\" class=\"c-input-text c-email c-valid\" name=\"email\" placeholder=\"you@site.com\" {{#email}}value=\"{{email}}\"{{/email}} disabled /></label><p class=\"j-error j-email c-error\">Oops! Invalid Credentials.</p><div class=\"j-pwd c-pwd\"><label for=\"password\"><span>Password</span><input name=\"password\" class=\"c-input-text c-password\" type=\"password\" placeholder=\"Secret password\" /></label><p class=\"j-error j-pw c-error c-wrong\">Oops! Invalid Credentials.</p><p class=\"j-error j-locked c-error\">This account is locked for your security due to exceeding maximum failed login tries. Please try after sometime.</p><p class=\"j-error j-banned c-error c-invalid\">Oops! Invalid Credentials.</p><span class=\"j-pw-recovery c-pw-recovery\"><a href=\"#\" class=\"c-forgot-password\">Forgot password?</a></span></div><input type=\"submit\" class=\"c-button c-signin\" name=\"login\" value=\"Sign In\" />{{> cancel_btn }}</form></div></script><script type=\"text/html\" class=\"template_register\"><div class=\"j-z-menu j-z-register-form c-signin c-signup\"><form class=\"j-register\" autocomplete=\"off\" method=\"post\"><label for=\"email\"><span>Email Address</span><input type=\"text\" class=\"c-input-text c-email c-valid\" name=\"email\" placeholder=\"you@site.com\" {{#email}}value=\"{{email}}\"{{/email}} disabled /></label><p class=\"j-error j-registered-email c-error c-registered-email\">You are already a member. To sign in,<a href=\"#\" class=\"j-start-over\">click here</a>.For a new password,<a class=\"j-pw-recovery\" href=\"#\">click here</a>.</p>{{> empty_email }}{{> invalid_email }}<div class='j-check-name'></div><p class=\"j-underage-error c-error c-underage-error\">You must be 13 to register</p><input type=\"submit\" class=\"c-button c-register\" name=\"register\" value=\"Sign Up\" />{{> cancel_btn }}</form><p class='j-error j-registered c-hide c-success'>Success! You are registered!</p><span class=\"c-validation-required\">(Validation required)</span></div></script><script type=\"text/html\" class=\"template_finish\"><div class=\"j-z-menu c-signin c-finish\"><div class=\"c-message c-incomplete\"><p class=\"j-error j-unvalidated-email c-unvalidated-email\" style=\"display:none;\">Your email <span class=\"c-email\">{{email}}</span> is already in the system. To finish the sign-up process, <a class=\"j-resend-invite\" href=\"#\">click here</a>.</p><p class=\"j-error j-missing-password c-missing-password\" style=\"display:none;\">Your email <span class=\"c-email\">{{email}}</span> is already in the system. To set up your password, <a class=\"j-resend-invite\" href=\"#\">click here</a>.</p></div><div class=\"j-validate-prompt c-message c-validate-prompt\" style=\"display: none;\"><p class=\"c-title\">One more step:</p><p>Reply to the email we sent to your inbox. (Tip: check your spam folder.)</p></div><p class=\"j-success c-success\" style=\"display: none;\">Password email sent to <span class=\"c-email\">{{email}}</span>!</p></div></script><script type=\"text/html\" class=\"template_recover_pw\"><div class=\"j-z-menu c-signin c-recover\"><form class=\"j-recover-form c-recover-form\" autocomplete=\"off\" method=\"post\"><input type=\"text\" class=\"c-input-text c-email\" name=\"email\" placeholder=\"you@site.com\" {{#email}}value=\"{{email}}\"{{/email}}/>{{> invalid_email }}<p class=\"j-error j-unregistered-email c-error\">Oops! That email is not registered</p><input type=\"submit\" class=\"c-button c-submit\" name=\"resend\" value=\"Send\" />{{> cancel_btn }}</form></div></script><script type=\"text/html\" class=\"template_cancel_btn\"><button class=\"j-start-over c-button c-cancel\">Cancel</button></script><script type=\"text/html\" class=\"template_login_msg\"><span>Sign in to your account</span></script><script type=\"text/html\" class=\"template_register_msg\"><span>Create a new account</span></script><script type=\"text/html\" class=\"template_recovery_msg\"><span>Recover your password</span></script><script type=\"text/html\" class=\"template_finish_msg\"><span>Finish</span></script><script type=\"text/html\" class=\"template_invalid_email\"><p class=\"j-error j-invalid c-error c-invalid\">Oops! That is not an email.</p></script><script type=\"text/html\" class=\"template_empty_email\"><p class=\"j-error j-empty-email c-error c-empty-email\">Please enter your email</p></script><script type=\"text/html\" class=\"template_register_link\"></script><script type=\"text/html\" class=\"template_sign_in_text\"><span>Sign in to your account</span></script><script type=\"text/html\" class=\"template_register_text\"><span>Create a new acount</span></script><script type=\"text/html\" class=\"template_registration_confirmation\"><div class=\"j-email-container c-message c-email-container\" style=\"display:none\"><p class=\"c-title\">Success!</p><p>An e-mail has been sent to <span class=\"c-email\">{{email}}</span>. If you do not receive the email within 15 minutes, check your spam settings and junk folder or try using a different email address.</p><p>Need to change your email address?</p><p><a href=\"{{path}}\" class=\"c-button c-start-over\">Start Over</a></p></div><div class=\"j-confirmation-container c-message c-confirmation-container\"><p class=\"c-title\">Almost done!</p><p>A confirmation email is on the way. Click the link in the email to finish registering. Then return here and join in.</p><p>Didn&rsquo;t get a confirmation email?</p><p class=\"c-resend\">If you checked your inbox and do not see a confirmation email, <a class=\"j-resend\" href=\"#\">send it again</a>.</p></div></script>";
$j.templates.jenga_widget_zinger2_newsvine="<script type=\"text/html\" class=\"template_login\"><div class=\"j-z-menu c-z-menu c-z-login-form\"><div class=\"c-z-title c-login\">Sign In</div><div class=\"c-z-form\"><form class=\"j-login-form\" autocomplete=\"off\" method=\"post\"><label for=\"email\">Email Address</label><input type=\"text\" name=\"email\" placeholder=\"you@site.com\" {{#email}}value=\"{{email}}\"{{/email}} /><p class=\"j-error j-email c-error\">Oops! Invalid Credentials.</p>{{> empty_email }}<label for=\"password\">Password</label><input name=\"password\" type=\"password\" placeholder=\"secret password\" /><p class=\"j-error j-pw c-error\">Oops! Invalid Credentials.</p><p class=\"j-error j-locked c-error\">This account is locked for your security due to exceeding maximum failed login tries. Please try after sometime.</p><p class=\"j-error j-banned c-error\">Oops! Invalid Credentials.</p><span class=\"j-pw-recovery c-z-lost\"><a href=\"#\" class=\"c-button c-forgot\">Forgot password?</a></span><span class=\"j-spinner c-spin c-overlay-spinner\"></span><input type=\"submit\" class=\"c-button c-login\" name=\"login\" value=\"Sign In\" /></form></div></div>{{> register_link}}</script><script type=\"text/html\" class=\"template_cancel_btn\"><button class=\"j-start-over c-button c-cancel\">Cancel</button></script><script type=\"text/html\" class=\"template_recover_pw\"><div class=\"c-z-title\">Forgot Password</div><div class=\"c-z-form\"><form class=\"j-recover-form c-z-resend\" autocomplete=\"off\" method=\"post\"><label for=\"email\">Your email address</label><input type=\"text\" name=\"email\" placeholder=\"you@site.com\" {{#email}}value=\"{{email}}\"{{/email}}/>{{> invalid_email }}<p class=\"j-error j-unregistered-email c-error\">Oops! That email is not registered</p><span class=\"c-spin j-spinner\"></span><input type=\"submit\" class=\"c-button c-submit\" name=\"resend\" value=\"Send\" />{{> cancel_btn }}<p class=\"j-success c-success\">Password email sent!</p></form></div></script><script type=\"text/html\" class=\"template_invalid_email\"><p class=\"j-error j-invalid c-error\">Oops! That is not an email.</p></script><script type=\"text/html\" class=\"template_empty_email\"><p class=\"j-error c-error j-empty-email\">Please enter your email</p></script><script type=\"text/html\" class=\"template_register_link\"><p class=\"c-z-register\">Don&rsquo;t have an account? <a class=\"j-register c-register\" href=\"#\">Sign up</a></p></script><script type=\"text/html\" class=\"template_register\"><div class=\"j-z-menu c-z-menu c-z-register-form j-z-register-form\"><div class=\"c-z-title\">{{registerTitle}}</div><div class=\"c-z-form\"><form class=\"j-register c-z-register\" autocomplete=\"off\" method=\"post\"><label for=\"email\">Your email address</label><input type=\"text\" name=\"email\" placeholder=\"you@site.com\" {{#email}}value=\"{{email}}\"{{/email}}/><p class=\"j-error c-error j-registered-email\">You're already a member. To sign in, <a href=\"#\" class=\"j-start-over\">click here</a>. For a new password, <a class=\"j-pw-recovery\" href=\"#\">click here</a>.</p><p class=\"j-error c-error c-re-send j-unvalidated-email\">Your email is already in the system. To finish the sign-up process, <a class=\"j-resend-invite\" href=\"#\">click here</a>.</p><p class=\"j-error c-error c-re-send j-missing-password\">Your email is already in the system. To set up your password, <a class=\"j-resend-invite\" href=\"#\">click here</a>.</p>{{> empty_email }}{{> invalid_email }}<div class='j-check-name'></div><span class=\"j-spinner c-overlay-spinner c-spin\"></span><p class=\"c-error c-underage-error j-underage-error\">You must be 13 to register</p><input type=\"submit\" class=\"c-button c-submit\" name=\"register\" value=\"{{registerTitle}}\" />{{> cancel_btn }}</form></div><p class='c-hide c-success j-error j-registered'>Success! You are registered!</p></div><div class=\"c-message c-validate-prompt j-validate-prompt\"><h3>One more step:</h3><p>Reply to the email we sent to your inbox. (Can't find it? Check your spam folder.)</p></div></script><script type=\"text/html\" class=\"template_registration_confirmation\"><div class=\"j-email-container c-message\" style=\"display:none\"><h3>Success!</h3><p>An e-mail has been sent to <span>{{email}}</span>. If you do not receive the email within 15 minutes, check your spam settings and junk folder or try using a different email address.</p><p>Need to change your email address?</p><p><a href=\"{{path}}\" class=\"c-button\">Start Over</a></p></div><div class=\"j-confirmation-container c-message\"><h3>Almost done!</h3><p>A confirmation email is on the way. Click the link in the email to finish registering. Then return here and join in.</p><p>Didn&rsquo;t get a confirmation email?</p><p class=\"c-resend\">If you checked your inbox and didn't get a confirmation email, <a class=\"j-resend\" href=\"#\">click here</a>.</p></div></script>";
$j.templates.jenga_widget_zinger2_menu="<script type=\"text/html\" class=\"template_target\"><span class=\"j-target c-z-target\"><a href=\"#\" class=\"c-target\"><span class=\"c-avatar\"><img class=\"j-avatar\" alt=\"Author Avatar\" src=\"{{data.avatar}}\" height=\"{{data.avatar_size}}\" width=\"{{data.avatar_size}}\" /></span><span class=\"c-z-label j-label\">{{data.label}}</span><span class=\"c-touchhide\">&#9662;</span><!-- hide arrow on touch devices --></a></span></script><script type=\"text/html\" class=\"template_privacy\"><p class=\"c-menu-footer\">{{#show_regLink}}<a href=\"#\" class=\"c-register-link j-footer-reg-link\" title=\"Don't have an account?\">Don&quot;t have an account?</a>{{/show_regLink}}{{#show_terms}}<a href=\"{{terms_link}}\" class=\"c-terms-link\" title=\"Terms\">Terms</a>{{/show_terms}}{{#show_privacy}}<a href=\"{{privacy_link}}\" class=\"c-privacy-link\" title=\"Privacy Policy\">Privacy</a>{{/show_privacy}}</p></script><script type=\"text/html\" class=\"template_profile\"><div class=\"c-logged-in c-menu\"><div class=\"j-menu c-z-menu\"><h1 class=\"c-title\"></h1><p class=\"c-author\"><span class=\"c-avatar\"><img src=\"{{data.avatar}}\" height=\"{{avatar_size}}\" width=\"{{avatar_size}}\" alt=\"Author Avatar\" /></span>{{data.username}}</p>{{#data.show_links}}<p class=\"c-column\"><a href=\"{{data.url}}\">My Column</a></p><p class=\"c-settings\"><a href=\"{{data.settings}}\">Account Settings</a></p>{{/data.show_links}}{{#data.show_privacy}}{{> privacy}}{{/data.show_privacy}}<p class=\"c-logout\"><a href=\"{{data.logout}}\">Sign Out</a></p></div></div></script><script type=\"text/html\" class=\"template_zinger\"><div class=\"j-menu j-zinger-login\"><h1 class=\"c-title\">Sign up or sign in</h1></div></script><script type=\"text/html\" class=\"template_social\"><span class=\"c-social-login\">{{#twitter}}<span class=\"j-zinger-twitter\"><span class=\"j-connect-twitter c-z-connect c-twitter c-bk-img\"><button type=\"button\">Sign in with Twitter</button></span><p class=\"c-error c-underage-error j-underage-error\">You must be 13 to register</p></span>{{/twitter}}{{#google}}<span class=\"j-zinger-google\"><span class=\"j-connect-google c-z-connect c-google c-bk-img\"><button type=\"button\">Sign in with Google</button></span><p class=\"c-error c-underage-error j-underage-error\">You must be 13 to register</p></span>{{/google}}{{#fb}}<span class=\"j-zinger-fb\"><span class=\"c-z-connect j-connect-fb c-facebook c-bk-img\"><button type=\"button\">Sign in with Facebook</button></span><p class=\"c-error c-underage-error j-underage-error\">You must be 13 to register</p></span>{{/fb}}</span><em>or</em></script><script type=\"text/html\" class=\"template_login_success\"><p><strong>Success!</strong></p><p>You are now signed in to your account.</p></script><script type=\"text/html\" class=\"template_collect_email\"><div class=\"j-collect-email\"><p>Please provide your e-mail to complete your account.</p><form><input type=\"text\" name=\"email\" id=\"email\" /><p class=\"c-error c-hide j-invalid-email\">Please enter a valid e-mail.</p><p class=\"c-error c-hide j-taken-login\">An account with this email already exists. Please <a class=\"j-login\" href=\"#\">login</a> to link your accounts.</p><input class=\"c-button c-button-collect c-submit\" type=\"submit\" value=\"submit\" /></form></div></script>";
$j.templates.jenga_widget_newsletter_subscribe="<script type=\"text/html\" class=\"template_subscribe_widget\"><div class=\"j-subscribe-block c-subscribe-block {{#data.action}}c-{{data.action}}{{/data.action}}\">{{#data.img}}<img width=\"125\" height=\"110\" alt=\"{{data.title}}\" src=\"{{data.img}}\"/>{{/data.img}}<div class=\"j-caption c-caption\">{{#data.title}}<h2>{{data.title}}</h2>{{/data.title}}{{#data.show_prompt}}<p>{{data.prompt_text}}</p>{{/data.show_prompt}}{{#data.description}}<p>{{data.description}}</p>{{/data.description}}{{#data.frequency}}<p>{{data.frequency}}</p>{{/data.frequency}}<form class='j-subscribe c-form c-subscribe' method=\"post\"><input class=\"c-input-text j-email\" placeholder=\"Enter your email\" type=\"email\" {{#data.email}}readonly value=\"{{data.email}}\"{{/data.email}}/><input type=\"hidden\" name=\"title\" value=\"{{data.key}}\"/><input type=\"hidden\" name=\"nlid\" value=\"{{data.nlid}}\"/><input type=\"hidden\" name=\"prd\" value=\"{{data.prd}}\"/><input type=\"hidden\" name=\"action\" value=\"{{data.action}}\"/><input type=\"hidden\" name=\"brand\" value=\"{{data.brand}}\"/>{{#data.use_checkbox}}<div class=\"c-chckbx-container j-chckbx-container\"><input class=\"c-chckbx j-chckbx\" type=\"checkbox\" {{#data.subscribed}}checked=\"checked\"{{/data.subscribed}} value=\"\" id=\"{{data.nlid}}\" name=\"check\" /><label class=\"c-chckbx-label j-chckbx-label\" for=\"{{data.nlid}}\"></label><span class=\"j-pending-spin c-pending-spin c-hide-spin\"></span></div>{{/data.use_checkbox}}{{^data.use_checkbox}}<input class=\"j-submit c-button c-submit\" type=\"submit\" value=\"{{data.button_text}}\"/>{{/data.use_checkbox}}{{#data.additional_nlid}}<div class=\"j-additional-subscribe c-additional-subscribe\"><input type=\"checkbox\" name=\"addlSub\" value=\"\" checked=\"checked\" id=\"{{data.additional_nlid}}\"><label for=\"{{data.additional_nlid}}\">{{data.additional_nl_text}}</label></div>{{/data.additional_nlid}}</form>{{#data.helper_text}}<div class=\"c-error j-helper-text\" style=\"display: none\">{{{data.helper_text}}}</div>{{/data.helper_text}}</div>{{#data.show_privacy}}<p class=\"c-privacy-link\"><a href=\"{{data.privacy_link}}\">Privacy</a></p>{{/data.show_privacy}}</div></script><script type=\"text/html\" class=\"template_subscribe_widget_subscribed\"><div class=\"j-subscribe-block c-subscribe-block {{#data.action}}c-{{data.action}}{{/data.action}}\">{{#data.img}}<img width=\"125\" height=\"110\" alt=\"{{data.title}}\" src=\"{{data.img}}\"/>{{/data.img}}<div class=\"j-caption c-caption\">{{#data.title}}<h2>{{data.title}}</h2>{{/data.title}}{{#data.show_prompt}}<p>{{data.prompt_text}}</p>{{/data.show_prompt}}{{#data.description}}<p>{{data.description}}</p>{{/data.description}}{{#data.frequency}}<p>{{data.frequency}}</p>{{/data.frequency}}there are two<form class='j-subscribe c-form c-subscribe c-done'><h2 class='emailSuccessMessage'>You already receive this newsletter.</h2><p class=\"c-view-subs\"><a href=\"{{data.subs_link}}\">See all newsletters</a></p></form></div>{{#data.show_privacy}}<p class=\"c-privacy-link\"><a href=\"{{data.privacy_link}}\">Privacy</a></p>{{/data.show_privacy}}</div></script><script type=\"text/html\" class=\"template_subscribe_widget_success\"><div class=\"c-confirmation-message\">        <h1>{{data.title}}</h1>        <p>{{data.subtitle}}</p>    </div></script><script type=\"text/html\" class=\"template_subscribe_widget_error\"><div class=\"c-error-message\">        <h1>Oops! We encountered an error.</h1>        <p>Sorry about that, go <a href=\"{{data.subs_link}}\">here</a> to try again.</p>    </div></script>";
