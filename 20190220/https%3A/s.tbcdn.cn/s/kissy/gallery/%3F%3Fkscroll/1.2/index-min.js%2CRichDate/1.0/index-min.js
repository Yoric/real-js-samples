/*! kscroll - v1.2 - 2013-07-17 7:31:05 PM
* Copyright (c) 2013 satans17; Licensed  */
KISSY.add("gallery/kscroll/1.2/index",function(a,b,c){function d(a,b){var c=this;d.superclass.constructor.call(c,b),c._init(a)}var e=b.all,f=function(a){return 0>a?-a:a},g=function(a){return isNaN(parseInt(a))?0:parseInt(a)},h=function(a){return a.charAt(0).toUpperCase()+a.substring(1)},i='<div class="{prefix}scrollbar"><div class="{prefix}track" ><div class="{prefix}drag" ><div class="{prefix}dragtop"></div><div class="{prefix}dragbottom"></div><div class="{prefix}dragcenter"></div></div></div></div>',j='<div class="{prefix}arrow{type}"><a href="javascript:void(\'scroll {type}\')" >scroll {type}</a></div>';return a.extend(d,c,{_init:function(a){var b=this,c="."+b.get("prefix");a=b._wrap(e(a)),b.set("container",a),b.set("body",a.one(c+"body")),b.set("track",a.one(c+"track")),b.set("drag",this.get("track").one(c+"drag")),b.get("allowArrow")?(b.set("arrowUp",a.one(c+"arrowup")),b.arrowUpHeight=b.get("arrowUp").outerHeight(),b.set("arrowDown",a.one(c+"arrowdown")),b.arrowDownHeight=b.get("arrowDown").outerHeight()):b.arrowUpHeight=b.arrowDownHeight=0,b._bindEvt(),b._setSize()},destroy:function(){var a=this,b=a.get("container"),c=(a.get("track"),a.get("arrowUp")),d=a.get("arrowDown"),e=b.children().item(0);c&&c.remove(),d&&d.remove(),e.insertBefore(b),b.remove(),e.css(a.__backup),e.removeClass(a.get("prefix")+"body")},_wrap:function(b){var c=this,d=c.get("prefix"),f=e("<div></div>");6==a.UA.ie&&b.css({overflow:"auto"}),f.insertAfter(b).append(b),f.addClass(d+"container").css({position:"relative",overflow:"hidden",width:b.outerWidth(),height:b.outerHeight()}),f.append(a.substitute(i,{prefix:d}));var g=f.one("."+d+"scrollbar");c.set("scrollBar",g),c.get("allowArrow")&&(g.append(a.substitute(j,{type:"up",prefix:d})),g.append(a.substitute(j,{type:"down",prefix:d})));var h=b[0].style;return c.__backup={position:h.position,top:h.top,left:h.left,width:h.width,height:h.height,overflow:h.overflow},b.css({position:"absolute",top:0,left:0,width:"100%",height:"auto",overflow:"visible"}).addClass(d+"body"),f},_bindArrow:function(a){var b=this,c=h(a),d=0,e=null,f=b.get("prefix"),g=b.get("arrow"+c),i=function(){d+=1;var c=b.get("step"),f="up"==a?c:-c,g=300-25*d;b.scrollByDistance(f),30>=g&&(g=30),e=setTimeout(function(){i()},g)};g.on("click",function(){var c=b.get("step");b.scrollByDistance("up"==a?c:-c)}).on("mousedown",function(){g.addClass(f+"arrow"+a+"-active"),i()}).on("mouseup",function(){g.removeClass(f+"arrow"+a+"-active"),d=0,clearTimeout(e)}).on("mouseleave",function(){g.removeClass(f+"arrow"+a+"-active"),d=0,g.removeClass(f+"arrow"+a+"-hover"),clearTimeout(e)}).on("mouseover",function(){g.addClass(f+"arrow"+a+"-hover")})},_bindDrag:function(){var a,b=e(document),c=this,d=c.get("prefix"),f=0,g=c.get("drag"),h=c.get("track"),i=function(b){var d=h.outerHeight(),e=g.outerHeight(),i=d-e,j=f+(b.pageY-a);0>j&&(j=0),j>i&&(j=i),g.css("top",j),c.scrollByPercent(j/i,1)};g.on("mouseenter",function(){g.addClass(d+"drag-hover")}).on("mouseleave",function(){g.removeClass(d+"drag-hover")}).on("click",function(a){a.stopPropagation()}).on("mousedown",function(c){g.addClass(d+"drag-active"),f=parseInt(g.css("top"))||0,a=c.pageY,b.on("mousemove",i).on("mouseup",function(){g.removeClass(d+"drag-active"),b.detach("mousemove",i),b.detach("mouseup",arguments.callee),a=0})})},_bindHotkey:function(){var b=this,c=b.get("body"),d=b.get("container"),e=function(a){var b=g(c.css("top"));return a>0&&b>=0?!1:0>a&&b+c.outerHeight()<=d.outerHeight()?!1:!0};d.css("outline","none").attr("tabindex",a.guid()).on("keydown",function(a){var c=a.keyCode,d=b.get("step");if(!~"INPUT,TEXTAREA".indexOf(a.target.nodeName.toUpperCase())&&~"38,39,36,40,37,35".indexOf(c)){var f=~"38,39,36".indexOf(c)?d:-d;switch(e(f)&&a.halt(),c){case 38:case 39:b.scrollByDistance(d);break;case 40:case 37:b.scrollByDistance(-d);break;case 36:b.scrollByPercent(0);break;case 35:b.scrollByPercent(1)}}})},_bindTrack:function(){var a=this,b=a.get("prefix"),c=a.get("track");c.unselectable().on("click",function(b){a.scrollByPercent((b.pageY-c.offset().top)/c.outerHeight())}).on("mousedown",function(a){a.preventDefault()}).on("mouseenter",function(){c.addClass(b+"track-hover")}).on("mouseleave",function(){c.removeClass(b+"track-hover")})},_bindBodyDrag:function(){var a=this,b=e(document),c=a.get("body"),d=0,f=function(b){d>b.pageY?a.scrollByDistance(5):a.scrollByDistance(-5)};c.on("mousedown",function(a){d=a.pageY,b.on("mousemove",f).on("mouseup",function(){b.detach("mousemove",f),b.detach("mouseup",arguments.callee),d=0})})},_bindContainer:function(){var a=this,b=a.get("body"),c=a.get("container"),d=function(a){var d=g(b.css("top"));return a>0&&d>=0?!1:0>a&&d+b.outerHeight()<=c.outerHeight()?!1:!0};a.get("container").on("mousewheel",function(b){d(b.deltaY)&&b.halt();var c=a.get("step");a.scrollByDistance(b.deltaY>0?c:-c)})},_bindEvt:function(){var a=this;a._bindContainer(),a.get("allowArrow")&&(a._bindArrow("up"),a._bindArrow("down")),a._bindTrack(),a._bindDrag(),a.get("hotkey")===!0&&a._bindHotkey(),a.get("bodydrag")&&a._bindBodyDrag()},resize:function(a,b){var c=this;c.get("container").css({width:a,height:b}),c._setSize()},_setSize:function(){var a,b=this,c=b.get("body").outerHeight(),d=b.get("container").innerHeight(),e=(b.get("arrowUp"),b.get("arrowDown"),b.get("track")),f=b.get("drag"),g=b.arrowUpHeight+b.arrowDownHeight;return d>=c||g>d?(b.get("body").css({top:0}),b.get("scrollBar").hide(),void 0):(b.get("scrollBar").show(),a=(d-g)*d/c,20>a&&(a=20),b.get("step")||b.set("step",Math.max(a/6,10)),e.css({height:d-g,top:b.arrowUpHeight}),f.css({height:a}),void 0)},_scrollBodyToPosition:function(a){var b=this,c=b.get("container"),d=b.get("body"),e=d.outerHeight()-c.innerHeight();0>e||(a>0&&(a=0),f(a)>e&&(a=-e),d.css("top",a))},scrollByDistance:function(a,b){var c=this,d=parseInt(c.get("body").css("top"))+a;c._scrollBodyToPosition(d),b||c._updateBar()},scrollByPercent:function(a,b){var c=this;if(a=parseFloat(a,10),!(isNaN(a)||a>1||0>a)){var d=(c.get("body").outerHeight()-c.get("container").innerHeight())*-a;c._scrollBodyToPosition(d),b||c._updateBar()}},scrollToElement:function(a){if(a=e(a),a.length){var b=this,c=a.offset().top-b.get("body").offset().top;b._scrollBodyToPosition(-c),b._updateBar()}},_updateBar:function(){var a=this,b=a.get("drag"),c=a.get("track").innerHeight()-b.outerHeight(),d=a.get("body"),e=a.get("container"),g=f(parseInt(d.css("top")))/(d.outerHeight()-e.innerHeight());b.css("top",g*c)}},{ATTRS:{prefix:{value:"ks-"},duration:{value:.1},easing:{value:"easeNone"},container:{},body:{},track:{},drag:{},arrowUp:{},allowArrow:{value:!0},arrowDown:{},step:{},scrollBar:{}}}),d},{requires:["node","base"]});/*! RichDate - v1.0 - 2013-09-06 6:38:06 PM
* Copyright (c) 2013 hongshu; Licensed  */
KISSY.add("gallery/RichDate/1.0/index",function(a){function b(a){return{year:a.getFullYear(),month:a.getMonth()+1,date:a.getDate(),hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds()}}function c(a){return new Date(a.year,a.month-1,a.date,a.hour,a.minute,a.second)}function d(a){return 0==a%4&&0!=a%100||0==a%400?!0:!1}function e(b){var e=!0;b.isLeapYear=d(b.year);var f=31;return a.inArray(b.month,g)?f=30:2==b.month&&(f=b.isLeapYear?29:28),k.date[1]=f,a.each(k,function(a,c){return a[0]>b[c]||a[1]<b[c]?(e=!1,!1):void 0}),e&&c(b)}function f(d,e,f){var g=b(d),i=/^((\d)+[YMDhms]{1})+$/;if(a.isString(e)&&i.test(e)){for(var j,k=/(\d)+[YMDhms]{1}/g;null!=(j=k.exec(e));){var l=j[0],m=parseInt(l),n=l[l.length-1];f?g[h[n]]+=m:g[h[n]]-=m}return c(g)}a.error("invalid interval string, please set as '2Y','2M','2D','2h','2m','2s' with their combination!")}var g=[4,6,9,11],h={Y:"year",M:"month",D:"date",h:"hour",m:"minute",s:"second"},i=a.keys(h),j={year:0,month:0,date:0,hour:0,minute:0,second:0},k={year:[1,9999],month:[1,12],date:[1,31],hour:[0,60],minute:[0,60],second:[0,60]};a.mix(Date,{parseBy:function(b,c){b=a.trim(b),c=a.trim(c);var d=!0,f=!0,g="Date parse failed, please check and retry!";if(b&&c){for(var k=0,l=0,m=c.length;m>k&&d;k++,l++){var n=c.charAt(k),o=b.charAt(l);if(a.inArray(n,i))if("YYYY"==c.substr(k,4)){var p=parseInt(b.substr(l,4));if(!isNaN(p)){j.year=p,k+=3,l+=3;continue}d=!1}else if(n==c.charAt(k+1)){var q=parseInt(b.substr(l,2));if(!(isNaN(q)||0>q)){j[h[n]]=q,"0"==b[l]&&l++,k++;continue}d=!1}if(!d||n!=o)return a.log(g),!1}return f=e(j),f||a.log(g),f}return a.log(g),!1}}),a.mix(Date.prototype,{isLeapYear:function(){return d(this.getFullYear())},before:function(a){return f(this,a,!1)},after:function(a){return f(this,a,!0)},formatAs:function(c){var d=arguments[1]||!1,e=b(this),f="";if(a.isString(c))for(var g=0;g<c.length;g++){var j=c.charAt(g);if(a.inArray(j,i))if("YYYY"==c.substr(g,4))f+=e.year,g+=3;else if(j==c.charAt(g+1)){var k=e[h[j]];d&&10>k&&(k="0"+k),f+=k,g++}else f+=j;else f+=j}return f}})});