KISSY.config("modules",{datalazyload:{alias:["gallery/datalazyload/1.1/"]},switchable:{alias:["gallery/switchable/1.3.1/"]},template:{alias:["gallery/template/1.0/"]},suggest:{alias:["gallery/suggest/1.0/"]},"wangpu/init":{requires:["ajax","base","anim","dom","node","event","ua","json","cookie","overlay","datalazyload","switchable","xtemplate"]},"wangpu/decoration/init":{requires:["wangpu/decoration/compatible","wangpu/decoration/countdown","wangpu/decoration/isv","wangpu/decoration/shopmonitor"]},"wangpu/decoration/init-async":{requires:["wangpu/decoration/compatible","wangpu/decoration/countdown","wangpu/decoration/isv","wangpu/decoration/shopmonitor"]},"wangpu/mods/official/tmall-srch-list":{requires:["wangpu/mods/official/tmall-srch-list/util","wangpu/mods/official/tmall-srch-list/crumb","wangpu/mods/official/tmall-srch-list/attr","wangpu/mods/official/tmall-srch-list/filter","wangpu/mods/official/tmall-srch-list/item","wangpu/mods/official/tmall-srch-list/atp"]}});KISSY.add("wangpu/init",function(S){var isDaily=location.host.indexOf("daily.taobao.net")>=0||location.host.indexOf("itempre.")>=0,isLocal=location.host.indexOf("test.daily.taobao.net")>=0;var defaultInitConfig={assetsHost:"//g.alicdn.com",pageType:"wangpu",lazyContainers:"body",isvParams:{}},pageTypeMods={wangpu:["official/header","official/header-v2","official/nav","official/nav-ch","official/bulletin","official/custom-banner","official/friend-link","official/main-slide","official/item-cates","official/item-recommend","official/self-defined","official/srch-inshop","official/top-list","official/ww-hover","official/srch-list","official/coupon","other/customer-service","other/guanliantuijian","other/recharge-center","other/taoke-recharge","other/cainixihuan","official/lab","official/shopcookie","official/new-signboard","official/cross-shop","official/fans-price-activity","official/fans-price-list","other/xiamiplayer"],tmall:["official/custom-banner","official/friend-link","official/main-slide","official/item-cates","official/item-recommend","official/nav-ch","official/self-defined","official/srch-inshop","official/top-list","official/ww-hover","official/tmall-srch-list","official/tmall-vip-profile","other/customer-service","other/guanliantuijian","other/taoke-recharge","official/lab","other/xiamiplayer"],cdetail:["official/header-v2","official/nav","official/nav-ch","official/custom-banner","official/main-slide","official/friend-link","official/item-cates","official/top-list","official/item-recommend","official/srch-inshop","official/self-defined","official/coupon","official/ww-hover","other/customer-service","other/taoke-recharge","other/guanliantuijian","other/cainixihuan","official/new-signboard"],tmalldetail:["official/nav-ch","official/custom-banner","official/main-slide","official/friend-link","official/item-cates","official/top-list","official/item-recommend","other/guanliantuijian","official/srch-inshop","official/<self-defin></self-defin>ed","other/customer-service","other/taoke-recharge"],rate:["official/header","official/header-v2","official/nav","official/nav-ch","official/custom-banner"]};var Wangpu={init:function(config){S.log("wangpu init start");var start=(new Date).getTime();var initConfig=S.merge(defaultInitConfig,config),mods=[],comboMods=[];KISSY.config({combine:isDaily?false:true,debug:isDaily?true:false,packages:[{name:"wangpu",tag:"20140409",path:isLocal?"../../../scripts/":"//g.alicdn.com/shop/taesite/0.1.12/platinum/scripts/",charset:"utf-8"}]});mods=pageTypeMods[initConfig.pageType];comboMods.push("wangpu/base");for(var i=0;i<mods.length;i++){comboMods.push("wangpu/mods/"+mods[i])}comboMods.push("wangpu/decoration/init");KISSY.use(comboMods,function(S){var modsList=S.makeArray(arguments).slice(1);S.ready(function(S){var D=S.DOM,modContext={};S.each(modsList,function(mod){try{initMod(mod)}catch(err){S.log("初始化模块出错")}});function initMod(mod){if(mod.type=="base"){new mod({mod:D.get("body")})}else if(mod.type=="decoration"){modContext={pageType:initConfig.pageType,lazyContainers:initConfig.lazyContainers,isvParams:initConfig.isvParams,mod:D.get("#content")};if(initConfig.pageType=="wangpu"){if(window.shop_config){window.shop_config.decoration=new mod(modContext)}else{new mod(modContext)}}else{new mod(modContext)}}else if(mod.selector==".tshop-psm-shop-header"){new mod({mod:D.get(mod.selector)})}else if(mod.selector==".tshop-psm-shop-header2"){S.later(function(){new mod({mod:D.get(mod.selector)})},0)}else if(mod.selector==".tshop-psm-shop-ww-hover"){S.later(function(){new mod({mod:D.get(mod.selector)})},0)}else if(mod.type=="xiamiplayer"){S.later(function(){new mod},0)}else{S.each(D.query("#content "+mod.selector),function(modDomObj){new mod({mod:modDomObj})})}}S.log("wangpu  init end");var end=(new Date).getTime();S.log("wangpu  init spend time ms:"+(end-start))})})}};return Wangpu});(function(){if(window.shop_config){try{var d=document.domain.split(".");document.domain=d.slice(d.length-2).join(".")}catch(e){}KISSY.use("wangpu/init",function(S,Wangpu){Wangpu.init({assetsHost:window.g_config.assetsHost,pageType:window.g_config.pageType,lazyContainers:"body",isvParams:window.shop_config?window.shop_config.isvStat:{}})})}})();KISSY.add("wangpu/decoration/compatible",function(a){function b(d,e){var f={top:"auto",bottom:"auto",left:"auto",right:"auto"};f.top=c.css(d,"top"),f.bottom=c.css(d,"bottom"),"auto"!==f.bottom&&(f.top="auto"),f.left=c.css(d,"left"),f.right=c.css(d,"right"),e=e||{},e=a.merge(b.Config,e),this.offset=f,this.config=e,this.elem=a.get(d),this._init()}var c=a.DOM,d=a.Event,e=/px[;]{0,1}/g,f="//gdp.alicdn.com/tps/i4/T1VhujXXBkXXXXXXXX-1-1.gif",g=!0,h=/\w+\.png$/;return b.Config={fixed:!1,png:!1,png_bg:!1,png_tag:!1,png_method:"crop",maxWidth:!1,maxHeight:!1,minWidth:!1,minHeight:!1,maxWidthValue:0,maxHeightValue:0,minWidthValue:0,minHeightValue:0},a.augment(b,{_init:function(){var a=this,b=a.config;b.fixed&&a._fixIE6PositionFixed(),b.png&&a._fixIE6PngTransparent(),b.maxWidth&&a._isValidWidthValue()&&a._fixMaxWidth(),b.maxHeight&&a._isValidHeightValue()&&a._fixMaxHeight(),b.minWidth&&a._isValidWidthValue()&&a._fixMinWidth(),b.minHeight&&a._isValidHeightValue()&&a._fixMinHeight()},_fixIE6PositionFixed:function(){var a=this;c.css(a.elem,"position","absolute"),d.on(window,"scroll resize",function(){var b=a.offset.top&&"auto"!==a.offset.top?c.scrollTop()+parseInt(a.offset.top.toString().replace(e,""))+"px":"auto",d=a.offset.bottom&&"auto"!==a.offset.bottom&&"auto"===b?c.scrollTop()+c.viewportHeight()-parseInt(a.offset.bottom.toString().replace(e,""))-c.height(a.elem)+"px":"auto",f=a.offset.left||"auto",g=a.offset.right||"auto";"auto"==b?c.css(a.elem,"top",d):c.css(a.elem,"top",b),c.css(a.elem,"left",f),c.css(a.elem,"right",g),c.css(a.elem,"bottom",d)})},_fixIE6PngTransparent:function(){var a=this,b=a.config;1==b.png_bg&&a._bg_fnFixPng(a.elem,b),1==b.png_tag&&(a._el_fnFixPng(a.elem),!g||"A"!=a.elem.tagName&&"INPUT"!=a.elem.tagName||""!=a.elem.style.position||(a.elem.style.position="relative"),a._childrenFix(a.elem))},_bg_fnFixPng:function(a,b){var c=a.currentStyle.backgroundImage,d=c.substring(5,c.length-2);h.test(d)&&(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d+"', sizingMethod='"+b.png_method+"')",a.style.backgroundImage="url("+f+")")},_el_fnFixPng:function(a){var b=a.src;h.test(b)&&(a.style.width=a.width+"px",a.style.height=a.height+"px",a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"', sizingMethod='scale')",a.src=f)},_childrenFix:function(a){for(var b=["a","input","select","textarea","button"],c=b.length;c--;)for(var d=a.all.tags(b[c]),e=d.length;e--;)/relative|absolute/i.test(d[e].currentStyle.position)||(d[e].style.position="relative")},_isValidWidthValue:function(){var a=this,b=a.config;return b.maxWidth&&b.minWidth&&b.maxWidthValue<b.minWidthValue?!1:!0},_isValidHeightValue:function(){var a=this,b=a.config;return b.maxHeight&&b.minHeight&&b.maxHeightValue<b.minHeightValue?!1:!0},_fixMaxWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)>b.maxWidthValue&&c.css(a.elem,"width",b.maxWidthValue+"px")},_fixMaxHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)>b.maxHeightValue&&c.css(a.elem,"height",b.maxHeightValue+"px")},_fixMinHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)<b.minHeightValue&&c.css(a.elem,"height",b.minHeightValue+"px")},_fixMinWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)<b.minWidthValue&&c.css(a.elem,"width",b.minWidthValue+"px")}}),b}),KISSY.add("wangpu/decoration/countdown",function(a){function b(b,c){var d=this;cfg={timeBegin:0,collateurl:"",collateval:0},d.timeStart=new Date,d.config=a.merge(cfg,c||{}),d._countTime(b)}function c(b,d,e){var f={d:".ks-d",h:".ks-h",m:".ks-m",s:".ks-s",i:".ks-i"},g={interval:1e3,timeUnitCls:f,minDigit:2,timeRunCls:".ks-countdown-run",timeEndCls:".ks-countdown-end"},h=a.merge(g,e);h.run&&!a.isFunction(h.run)&&delete h.run,h.end&&!a.isFunction(h.end)&&delete h.end,h.interval=parseInt(h.interval),(isNaN(h.interval)||h.interval<200)&&(h.interval=200),c.superclass.constructor.call(this,d,h),this.counter(b)}function d(b,c){var d=function(b){a.isDate(b)||(b=new Date),a.isFunction(c)&&c(b)};a.io({url:b,type:"HEAD",success:function(a,b,c){d(new Date(c.getResponseHeader("date")))},error:function(){d(new Date)},cache:!1})}function d(b,c){function d(a,b){1e3>a?c(b):3>f?e():c(new Date(b.setMilliseconds(b.getMilliseconds()+a/2)))}function e(){var c=new Date;f++,a.io({url:b,type:"HEAD",success:function(a,b,e){d(new Date-c,new Date(e.getResponseHeader("date")))},error:function(){d()},cache:!1})}var f=0;e()}function e(b,c,e){b="."+(b||"J_TWidget");var g=function(d){a.query(b,c).each(function(b){var c=f.attr(b,"data-widget-type"),e=f.attr(b,"data-widget-config");"Countdown"===c&&(e=a.isNull(e)?{}:JSON.parse(e.replace(/'/g,'"')),d&&a.isDate(d)&&(e.timeBegin=d),new a.Countdown(b,e.endTime,e))})};e?d(e,g):g()}var f=a.DOM,g={d:864e5,h:36e5,m:6e4,s:1e3,i:1},h=["d","h","m","s","i"];return b.prototype={_countTime:function(b){var c=this,d=c.config,e=d.timeBegin,f=0;if(/^(\d{4})\-(\d{1,2})\-(\d{1,2})(\s+)(\d{1,2}):(\d{1,2}):(\d{1,2})$/gi.test(b.replace(/\./g,"-"))){var g=b.match(/\d+/g);b=new Date(g[0],g[1]-1,g[2],g[3],g[4],g[5])}else/^\d+&/.test(b)&&(b=parseInt(b));f=a.isNull(e)||isNaN(e)||0>=e?a.isDate(b)?b-new Date:parseInt(b):typeof e==typeof b?b-e:0,(!a.isNumber(f)||0>f)&&(f=0),c.timeRemain=f},getRemain:function(){var a=parseInt(this.timeRemain-(new Date-this.timeStart));return isNaN(a)||0>=a?0:a},format:function(b){var c=Array.prototype.slice.call(arguments,1),d=[];return a.each(c,function(a){if(g[a]){var c=Math.floor(b/g[a]);b-=c*g[a],d.push(c)}}),d},fetch:function(a,b,c){var d=this,e=setInterval(function(){var a=d.getRemain();a>0?b&&b.call(d,a):(b&&b.call(d,0),c&&c.call(d),clearInterval(e))},a)}},a.extend(c,b,{counter:function(b){var c=this,d=c.config,e=function(b){var e=[b].concat(l),f=c.format.apply(this,e);a.each(k,function(a,b){a.text(f[b])}),d.run&&d.run.call(c,e,f)},f=function(){i.hide(),j.show(),d.end&&d.end.call(c)},g=d.timeUnitCls,b=a.one(b),i=b.all(d.timeRunCls),j=b.all(d.timeEndCls),k=[],l=[];a.each(h,function(a){g[a]&&b.one(g[a])&&(k.push(b.one(g[a])),l.push(a))}),i.show(),j.hide(),c.fetch(d.interval,e,f)}}),c.autoRender=e,c.Core=b,c.getServerTime=d,a.Countdown=c,c}),KISSY.add("wangpu/decoration/isv",function(a){TB.namespace("ISV");var b=[{isvParam:"u_name/u_visitor/u_item_id/u_item_num_id/u_aload_id/u_session/u_preurl/u_curl/u_title/u_time",isvUrl:""}],a=KISSY,c=window,d=document,e=function(){var e={},f=/^https?\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?$/,g=function(a){return!0===e.debugMode&&alert(a),!1},h=function(a){if(0<d.cookie.length){var b=d.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null===b?"":b[2]}return""},i=function(){return Math.ceil(1e9*Math.random()).toString()},j=function(){return(+new Date).toString().substring(0,10)},k=function(){var a="";try{""!==d.referrer?a=d.referrer:null!==c.opener&&void 0!==c.opener?a=(c.opener.document||0).URL||"":null!==c.parent&&(a=c.parent.document.URL,a===d.URL&&(a=d.referrer))}catch(b){}return a},l=function(){var a=j(),b=[i(),"0",a];return b.join("_")},m=function(a){for(var b={u_name:e.nickName.toString(),u_item_id:e.itemId.toString(),u_item_num_id:e.itemNumId.toString(),u_template_name:e.templateName.toString(),u_template_id:e.templateId.toString(),u_visitor:h(e.cnaCookieName),u_session:l(a),u_preurl:encodeURIComponent(k()),u_curl:encodeURIComponent(d.URL),u_title:encodeURIComponent(d.title),u_aload_id:c.acookie_load_id||"",u_time:j()},i=[],m=0,n=a.length;n>m;m++){var o=a[m];if(String===o.isvUrl.constructor&&String===o.isvParam.constructor&&!0===f.test(o.isvUrl)&&!1!==o.isvParam.indexOf("_")){var p=o.isvParam.toLowerCase().replace(/\s+/g,"").split("/");if(0<p.length){for(var q="",r=0,s=p.length;s>r;r++){var t=p[r];void 0!==b[t]&&(q+="&"+t+"="+b[t])}""!==q&&(q=q.replace("&","?"),i[m]=new Image(1,1),i[m].src=o.isvUrl+q,i[m].onload=function(){return g("Send Successfully")})}}}},n=function(){if("-1"===e.shopStats||"-2"==e.shopStats||isNaN(e.shopStats))a.log(e.validatorUrl+"?nickName="+e.nickName.toString()+"&userId="+e.userId.toString()+"&itemNumId="+e.itemNumId.toString()+"&shopId="+e.shopId.toString()+"&siteId="+e.siteId.toString()+"&shopStats="+e.shopStats.toString()),a.getScript(e.validatorUrl+"?nickName="+e.nickName.toString()+"&userId="+e.userId.toString()+"&itemNumId="+e.itemNumId.toString()+"&shopId="+e.shopId.toString()+"&siteId="+e.siteId.toString()+"&shopStats="+e.shopStats.toString(),function(){if(void 0===TB.ISV.Data||Array!==TB.ISV.Data.constructor||0===TB.ISV.Data.length)return g("Cannot get the valid data");var a=TB.ISV.Data;delete TB.ISV.Data,m(a)});else if(e.shopStats>0){var c,d=[],f=parseInt(e.shopStats);for(c=0;c<b.length;c++)(f&Math.pow(2,c))>0&&d.push(b[c]);m(d)}};return{init:function(b){if(e=b||{},a.mix(e,{nickName:"",userId:"",shopId:"",templateName:"",templateId:"",itemId:"",itemNumId:"",siteId:"",shopStats:"-2",cnaCookieName:"cna",sessionLife:1400,validatorUrl:"//store.taobao.com/tadget/shop_stats.htm",debugMode:!1},!1),""===e.itemId&&-1!==d.URL.indexOf("?taomi=")){var c=$("J_FrmBid");null!==c&&c.elements.item_id&&(e.itemId=c.elements.item_id.value)}switch(!0){case""===e.nickName&&""===e.userId&&""===e.shopId:return g("nickName and userId and shopId are all null");case""===e.cnaCookieName:return g("cnaCookieName is null");case Number!==e.sessionLife.constructor:return g("sessionLife is not a number");case!1===f.test(e.validatorUrl):return g("validatorUrl is not a valid url")}n()}}}();return e}),KISSY.add("wangpu/decoration/shopmonitor",function(a){function b(){var b=this;try{a.later(function(){window.goldlog?b._init():a.later(arguments.callee,500)},500)}catch(c){a.log("\u5e97\u94fa\u9ec4\u91d1\u77ff\u5de5\u57cb\u70b9\u51fa\u9519")}}{var c=a.DOM,d=(a.Event,a.UA,window.g_hb_monitor_st||+new Date,!!c.get("#shop-head"));!d&&!c.get("#J_ShopSearchResult")}return a.augment(b,{_init:function(){var b=this;try{a.each(b._monitor_func_list,function(a){a.call(b)})}catch(c){window.goldlog.emit("shop_monitor_error",{error:c}),a.error(c)}},_monitor_func_list:[function(){KISSY&&KISSY.DOM&&window.screen&&!(Math.random()>.005)&&window.goldlog.emit("viewport-analysis2",{"viewport-w":KISSY.DOM.viewportWidth(),"viewport-h":KISSY.DOM.viewportHeight(),"screen-w":window.screen.width,"screen-h":window.screen.height,"avail-w":window.screen.availWidth,"avail-h":window.screen.availHeight,"browser-w":window.outerWidth||0,"browser-h":window.outerHeight||0})},function(){var a=Math.random();if(KISSY&&KISSY.IO&&!(a>.01)){var b,c,d=a*Math.pow(10,18),e="shop_onbeforeunload",f=window.onbeforeunload,g="//gm.mmstat.com/ued.1.1.2?type=9&_gm:id="+e+"&pageid="+d,h=new Image;switch(c=.002>a?"tmp_new_image":.004>a?"body_image":.006>a?"kissy_sync_ajax":.008>a?"goldminer":"kissy_jsonp",window.goldlog.emit(e,{pageid:d,stype:c,skey:1}),c){case"tmp_new_image":b=function(){h.src=g+"&stype=tmp_new_image"};break;case"body_image":h.style.cssText="display:none",document.body.appendChild(h),b=function(){h.src=g+"&stype=body_image"};break;case"kissy_sync_ajax":b=function(){KISSY.IO({url:g,data:{stype:"kissy_sync_ajax"},async:!1})};break;case"goldminer":b=function(){goldlog.emit(e,{stype:"goldminer"})};break;default:b=function(){KISSY.IO.jsonp(g,{stype:"kissy_jsonp"})}}window.onbeforeunload=function(){f&&f(),b()}}}]}),b}),KISSY.add("wangpu/decoration/init-async",function(a,b,c,d,e,f,g,h){function i(a){var b=this;b._mod=a.mod,b._wrap=a.wrap,b._context=a,b._mod&&(b._wrap?(b.initPicLazyload(),b.initWidget("J_TWidget"),b.initCartPlugin(b._wrap),("wangpu"==a.pageType||"cdetail"==a.pageType)&&b.initSNSForAsync(b._wrap)):b._init())}var j=a.DOM,k=a.Event;return a.augment(i,{_init:function(){var b=this;a.ready(function(){var c=(new Date).getTime();a.log("Decoration init start"),b.initPicLazyload(),b.initWidget("J_TWidget"),b.initCartPlugin(),b.initISV();var d=b._context.pageType;("wangpu"==d||"tmall"==d)&&(b.initBuriedStatistics(),b.handleDesignEntr()),("wangpu"==d||"cdetail"==d)&&b._initShare();var e=(new Date).getTime();a.log("Decoration init end"),a.log("Decoration init spend time ms:"+(e-c))})},initWidget:function(f){function g(){a.later(function(){if(0!==p.length){try{h(p.shift())}catch(b){a.log("\u521d\u59cb\u5316\u7ec4\u4ef6\u51fa\u9519")}g()}},0)}function h(c){var f,g=c.getAttribute("data-widget-type");if(g)try{switch(f=c.getAttribute("data-widget-config"),f&&(f=f.replace(/'/g,'"')),f=a.JSON.parse(f),!0){case n.switchable.indexOf(g)>-1:i(c,a.merge(b.Config,a.merge(b[g].Config,f))),"Carousel"!=g||j.get("."+f.prevBtnCls,c)&&j.get("."+f.nextBtnCls,c)?new b[g](c,a.merge(f,{lazyDataType:"img-src"})):new b(c,a.merge(f,{lazyDataType:"img-src"}));break;case n.overlay.indexOf(g)>-1:l(f,c);break;case n.compatible.indexOf(g)>-1:a.UA.ie&&a.UA.ie<7&&new d(c,f);break;case n.countdown.indexOf(g)>-1:new e(c,f.endTime,f);break;default:a.log("\u5728kissy\u5e93\u4e2d\u6ca1\u6709\u67e5\u627e\u5230\u4f60\u60f3\u8981\u521d\u59cb\u5316\u7684\u7ec4\u4ef6")}}catch(h){a.log("widget "+h,"warn")}}function i(b,c){var d=c.activeIndex;d>-1||"number"==typeof c.switchTo||(d=0);var e,f,g=".",h=c.steps,i=d*h,k=[];switch(c.markupType){case 0:e=j.get(g+c.contentCls,b),f=j.children(e);break;case 1:f=j.query(g+c.panelCls,b);break;case 2:f=c.panels}a.each(f,function(b,c){c>=i&&i+h>c?a.each(j.query("img",b),function(a){j.attr(a,"data-ks-lazyload")&&(j.attr(a,"src",j.attr(a,"data-ks-lazyload")),j.removeAttr(a,"data-ks-lazyload"))}):k=k.concat(j.query("img",b))}),a.each(k,function(a){j.attr(a,"data-ks-lazyload")&&(j.attr(a,"data-ks-lazyload-custom",j.attr(a,"data-ks-lazyload")),j.removeAttr(a,"data-ks-lazyload"))})}function l(b,d){if("type"in b||(b.type=b.content?"multi-one":"one-one"),b.triggerType||(b.triggerType="mouse"),(!b.zIndex||b.zIndex>1e8-100||b.zIndex<1e8-200)&&(b.zIndex=1e8-200),"one-one"==b.type)a.version.indexOf("1.4")>=0?(j.hide(d),j.html(d,'<div class="ks-popup-content">'+j.html(d)+"</div>"),j.addClass(d,"tb-shop-popup-show"),j.css(d,{display:"block",position:"absolute",left:"-9999px",top:"-9999px",zIndex:b.zIndex}),new c.Popup({trigger:j.get(b.trigger,m._mod),triggerType:b.triggerType,srcNode:d,align:b.align,zIndex:b.zIndex})):new c.Popup({trigger:j.get(b.trigger,m._mod),triggerType:b.triggerType,srcNode:d,elStyle:{display:"block",visibility:"hidden",position:"absolute",left:"-9999px",top:"-9999px"},align:b.align,zIndex:b.zIndex});else{var e=new c({effect:b.effect?b.effect:{},zIndex:b.zIndex}),f=j.get(b.container),g=j.query(b.trigger,f),h=j.query(b.content,f);a.each(g,function(c,d){var f,g;k.on(c,"mouseenter",function(){f&&f.cancel(),f=a.later(function(){h[d]&&(e.set("content",h[d].value),e.set("align",a.merge(b.align,{node:c})),e.show()),f.cancel()},100)}),k.on(c,"mouseleave",function(){g&&g.cancel(),g=a.later(function(){e.hide(),g.cancel()},100)})})}}var m=this;f="."+(f||"KS_Widget");var n={switchable:"Tabs Slide Carousel Accordion",overlay:"Popup",compatible:"Compatible",countdown:"Countdown"},o=m._wrap||"#content",p=a.query(f,o);g()},_initShare:function(){var b=this;!window.SNS&&j.get(".sns-widget",b._mod)&&a.getScript("//g.alicdn.com/tb/snsdk/0.0.12/core.min.js")},initSNSForAsync:function(b){var c,d;if(c=j.query(".sns-widget",b))if(window.SNS)for(d=0;d<c.length;d++)SNS.active(c[d]);else{a.getScript("//g.alicdn.com/tb/snsdk/0.0.12/core.min.js",function(){for(d=0;d<c.length;d++)SNS.active(c[d])})}},initCartPlugin:function(b){var c=this;b||(b="body"),j.get(".J_CartPluginTrigger",b)&&"undefined"==typeof CartPlugin&&a.getScript("//g.alicdn.com/shop/other-assets/0.0.5/taesite/cartplugin.js",function(){CartPlugin&&CartPlugin.init(c._mod,{preventAll:!0})})},preprocessImg:function(){var b=[],c=0,d=0;a.isArray(this._context.lazyContainers)?b=this._context.lazyContainers:b[0]=this._context.lazyContainers,a.each(b,function(b){a.each(j.query("img",b),function(a){var b=j.attr(a,"data-ks-lazyload");if(!a.offsetWidth&&b)j.attr(a,"src",b),j.removeAttr(a,"data-ks-lazyload"),d++;else if(window.WEBPSUPPORT&&b){var e=/img0(\d)\.taobaocdn\.com/gi;(b.match(e)||location.host.indexOf(".daily.")>0)&&!b.match(/(png|gif)$/gi)&&(b=b.replace(e,"gd$1.alicdn.com")+"_.webp",j.attr(a,"data-ks-lazyload",b))}c++})}),a.log("img nums:"+c),a.log("display none img nums:"+d)},initPicLazyload:function(){this.preprocessImg(),new f(this._context.lazyContainers,{mod:"manual",diff:{left:9999,right:9999,top:0,bottom:500}})},initBuriedStatistics:function(){a.getScript("//assets.alicdn.com/apps/lz/hc.js?v=5"),a.getScript("//assets.alicdn.com/s/tb-tracer-min.js?t=20110628"),new h},initISV:function(){g.init(this._context.isvParams)},handleDesignEntr:function(){window.shop_config&&window.login_config&&shop_config.userId==login_config.loginUserId&&(j.show(j.get("#J_DesignPage")),j.show(j.query("#copyright .J_TShowForSeller")))}}),i.selector="#content",i.type="decoration",i},{requires:["switchable","overlay","./compatible","./countdown","datalazyload","./isv","./shopmonitor"]});KISSY.add("wangpu/decoration/compatible",function(a){function b(d,e){var f={top:"auto",bottom:"auto",left:"auto",right:"auto"};f.top=c.css(d,"top"),f.bottom=c.css(d,"bottom"),"auto"!==f.bottom&&(f.top="auto"),f.left=c.css(d,"left"),f.right=c.css(d,"right"),e=e||{},e=a.merge(b.Config,e),this.offset=f,this.config=e,this.elem=a.get(d),this._init()}var c=a.DOM,d=a.Event,e=/px[;]{0,1}/g,f="//gdp.alicdn.com/tps/i4/T1VhujXXBkXXXXXXXX-1-1.gif",g=!0,h=/\w+\.png$/;return b.Config={fixed:!1,png:!1,png_bg:!1,png_tag:!1,png_method:"crop",maxWidth:!1,maxHeight:!1,minWidth:!1,minHeight:!1,maxWidthValue:0,maxHeightValue:0,minWidthValue:0,minHeightValue:0},a.augment(b,{_init:function(){var a=this,b=a.config;b.fixed&&a._fixIE6PositionFixed(),b.png&&a._fixIE6PngTransparent(),b.maxWidth&&a._isValidWidthValue()&&a._fixMaxWidth(),b.maxHeight&&a._isValidHeightValue()&&a._fixMaxHeight(),b.minWidth&&a._isValidWidthValue()&&a._fixMinWidth(),b.minHeight&&a._isValidHeightValue()&&a._fixMinHeight()},_fixIE6PositionFixed:function(){var a=this;c.css(a.elem,"position","absolute"),d.on(window,"scroll resize",function(){var b=a.offset.top&&"auto"!==a.offset.top?c.scrollTop()+parseInt(a.offset.top.toString().replace(e,""))+"px":"auto",d=a.offset.bottom&&"auto"!==a.offset.bottom&&"auto"===b?c.scrollTop()+c.viewportHeight()-parseInt(a.offset.bottom.toString().replace(e,""))-c.height(a.elem)+"px":"auto",f=a.offset.left||"auto",g=a.offset.right||"auto";"auto"==b?c.css(a.elem,"top",d):c.css(a.elem,"top",b),c.css(a.elem,"left",f),c.css(a.elem,"right",g),c.css(a.elem,"bottom",d)})},_fixIE6PngTransparent:function(){var a=this,b=a.config;1==b.png_bg&&a._bg_fnFixPng(a.elem,b),1==b.png_tag&&(a._el_fnFixPng(a.elem),!g||"A"!=a.elem.tagName&&"INPUT"!=a.elem.tagName||""!=a.elem.style.position||(a.elem.style.position="relative"),a._childrenFix(a.elem))},_bg_fnFixPng:function(a,b){var c=a.currentStyle.backgroundImage,d=c.substring(5,c.length-2);h.test(d)&&(a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+d+"', sizingMethod='"+b.png_method+"')",a.style.backgroundImage="url("+f+")")},_el_fnFixPng:function(a){var b=a.src;h.test(b)&&(a.style.width=a.width+"px",a.style.height=a.height+"px",a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b+"', sizingMethod='scale')",a.src=f)},_childrenFix:function(a){for(var b=["a","input","select","textarea","button"],c=b.length;c--;)for(var d=a.all.tags(b[c]),e=d.length;e--;)/relative|absolute/i.test(d[e].currentStyle.position)||(d[e].style.position="relative")},_isValidWidthValue:function(){var a=this,b=a.config;return b.maxWidth&&b.minWidth&&b.maxWidthValue<b.minWidthValue?!1:!0},_isValidHeightValue:function(){var a=this,b=a.config;return b.maxHeight&&b.minHeight&&b.maxHeightValue<b.minHeightValue?!1:!0},_fixMaxWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)>b.maxWidthValue&&c.css(a.elem,"width",b.maxWidthValue+"px")},_fixMaxHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)>b.maxHeightValue&&c.css(a.elem,"height",b.maxHeightValue+"px")},_fixMinHeight:function(){var a=this,b=a.config;a.elem&&c.height(a.elem)<b.minHeightValue&&c.css(a.elem,"height",b.minHeightValue+"px")},_fixMinWidth:function(){var a=this,b=a.config;a.elem&&c.width(a.elem)<b.minWidthValue&&c.css(a.elem,"width",b.minWidthValue+"px")}}),b}),KISSY.add("wangpu/mods/official/nav-ch",function(a,b,c){function d(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function e(b,c){a.each(b,function(a){f.delegate(c,"mouseenter",a.selector,function(b){g.addClass(b.currentTarget,a.hClass)}),f.delegate(c,"mouseleave",a.selector,function(b){g.removeClass(b.currentTarget,a.hClass)})})}var a=KISSY,f=a.Event,g=a.DOM;return a.augment(d,{_init:function(){a.log("TshopPbsmShopNavCh init start");var b=this;b._menuHighlight(),a.ready(function(){b._menuPopup(),b._bindEvt(),b._setInherentStyle(),b._fixMaxHeight(),e([{selector:".all-cats",hClass:"all-cats-hover"},{selector:".fst-cat",hClass:".cat-hd-hover"},{selector:".snd-cat-hd",hClass:".snd-cat-hd-hover"},{selector:".menu",hClass:".menu-hover"},{selector:".sub-cat",hClass:".sub-cat-hover"}],g.query(".tshop-pbsm-shop-nav-ch"))}),a.log("TshopPbsmShopNavCh init end")},_menuHighlight:function(){var b=g.get("#J_TSelectedMenuInfo");if(b){var c=a.JSON.parse(g.val(b)).selectedMenu,d=g.query(".menu",self._mod),e=g.get(".menu-selected",self._mod);if(e&&g.removeClass(e,"menu-selected"),""!=c.catId){for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-cat-id")==c.catId){g.addClass(d[f],"menu-selected");break}}else if(""!=c.pageId){for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-page-id")==c.pageId){g.addClass(d[f],"menu-selected");break}}else if(""!=c.linkId)for(var f=0;f<d.length;f++)if(g.attr(d[f],"data-link-id")==c.linkId){g.addClass(d[f],"menu-selected");break}}},_menuPopup:function(){function c(){a.later(function(){if(0!==i.length){try{d(i.shift())}catch(b){a.log("\u521d\u59cb\u5316\u7ec4\u4ef6\u51fa\u9519")}c()}},0)}function d(c){var d=c,e=g.next(d,".snd-pop");e&&(a.version.indexOf("1.4")>=0?(g.hide(e),g.html(e,'<div class="popup-content">'+g.html(e)+"</div>"),g.css(e,{position:"absolute",top:"-99999px",left:"-99999px"}),g.addClass(e,"tb-shop-popup-content"),g.show(e),new b.Popup({prefixCls:"",srcNode:e,trigger:d,triggerType:"mouse",align:{node:d,points:["tr","tl"],offset:[0,0]},zIndex:1e8})):new b.Popup({srcNode:e,trigger:d,triggerType:"mouse",align:{node:d,points:["tr","tl"],offset:[0,0]},zIndex:1e8}))}var e=g.create("<div class='skin-box-bd'></div>"),f=g.create("<div class='tshop-pbsm-shop-nav-ch'></div> ");g.append(e,f),g.append(f,"#content"),g.css(e,"width","0"),g.css(e,"height","0");var h=g.query(".popup-trigger",self._mod);a.each(h,function(c){var d=g.parent(c,".popup-container"),f=g.get(".popup-content",d);g.append(f,e);var h=f;a.version.indexOf("1.4")>=0?(g.hide(h),g.removeClass(h,"popup-content"),g.html(h,'<div class="popup-content">'+g.html(h)+"</div>"),g.addClass(h,"tb-shop-popup-content"),g.css(h,{position:"absolute",top:"-99999px",left:"-99999px",zIndex:1e8}),g.show(h),new b.Popup({prefixCls:"",srcNode:h,trigger:c,triggerType:"mouse",align:{node:d,points:["bl","tl"],offset:[0,0]},zIndex:1e8})):new b.Popup({prefixCls:"",srcNode:h,trigger:c,triggerType:"mouse",align:{node:d,points:["bl","tl"],offset:[0,0]},zIndex:1e8})});var i=g.query(".fst-cat-hd",e);c()},_bindEvt:function(){},_setInherentStyle:function(){var a=this;g.css(a._mod,"display","block"),g.css(a._mod,"visibility","visible")},_fixMaxHeight:function(){var a=this;new c(a._mod,{maxHeight:!0,maxHeightValue:150}),new c(g.get("#hd"),{maxHeight:!0,maxHeightValue:150}),g.css(".tshop-pbsm-shop-custom-banner","position","relative")}}),d.selector=".tshop-pbsm-shop-nav-ch",d},{requires:["overlay","../../decoration/compatible"]});KISSY.add("wangpu/mods/official/custom-banner",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}{var a=KISSY;a.Event,a.DOM}return a.augment(b,{_init:function(){a.log("TshopPbsmShopCustomBanner init start")}}),b.selector=".tshop-pbsm-shop-banner",b});KISSY.add("wangpu/mods/official/main-slide",function(a){function b(b){var c=this;if(c._mod=b.mod,c._mod){a.log("TshopPbsmShopMainSlide init start"),c._init(),c.prevBtn=d.get(".prev-btn",c._mod),c.nextBtn=d.get(".next-btn",c._mod);var e=c.getCurrentStyle(d.get(".slide-box",c._mod),"height"),f=(e-c.getCurrentStyle(d.get(".slide-triggers",c._mod),"height")-c.getCurrentStyle(c.prevBtn,"height"))/2;c.prevBtn.style.top=(f>0?parseInt(f,10):0)+"px",c.nextBtn.style.top=(f>0?parseInt(f,10):0)+"px",a.UA.ie&&6==a.UA.ie&&(d.get(".slide-box",c._mod).className=d.get(".slide-box",c._mod).className),a.log("TshopPbsmShopMainSlide init end")}}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){var a=this;a.disBtn()},disBtn:function(){var a=this,b=d.get(".slide-box",a._mod),e=d.get(".prev-btn",a._mod),f=d.get(".next-btn",a._mod);c.on(b,"mouseenter",function(){d.addClass(e,"play"),d.addClass(f,"play")}),c.on(b,"mouseleave",function(){d.removeClass(e,"play"),d.removeClass(f,"play")}),c.on(e,"mouseenter",function(){d.addClass(e,"hover-pre")}),c.on(e,"mouseleave",function(){d.removeClass(e,"hover-pre")}),c.on(f,"mouseenter",function(){d.addClass(f,"hover-next")}),c.on(f,"mouseleave",function(){d.removeClass(f,"hover-next")})},render:function(){},getCurrentStyle:function(a,b){var c=this,d="";return b=c.transToHump(b),d=window.getComputedStyle?window.getComputedStyle(a,null)[b]:a.currentStyle[b],parseInt(d,10)?parseInt(d,10):0},transToHump:function(a){return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})}}),b.selector=".tshop-pbsm-shop-main-slide",b});KISSY.add("wangpu/mods/official/friend-link",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,c=a.Event,d=a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopFriendLink init start");var b=this,e=d.query(".cat",b._mod);c.on(e,"mouseenter",function(a){var b=a.target;d.hasClass(a.target,"cat")||(b=d.parent(a.target,".cat")),d.addClass(b,"cat-hover")}),c.on(e,"mouseleave",function(a){var b=a.target;d.hasClass(a.target,"cat")||(b=d.parent(a.target,".cat")),d.removeClass(b,"cat-hover")}),a.log("TshopPbsmShopFriendLink init end")}}),b.selector=".tshop-pbsm-shop-friend-link",b});KISSY.add("wangpu/mods/official/item-cates",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}function c(b,c){var f=[],g=a.UA.ie;g&&6===g&&a.each(b,function(b){f=e.query(b.selector,c),a.each(f,function(a){d.on(a,"mouseenter",function(){e.addClass(this,b.hClass)}),d.on(a,"mouseleave",function(){e.removeClass(this,b.hClass)})})})}var a=KISSY,d=a.Event,e=a.DOM;return a.augment(b,{_init:function(){a.log("TshopPbsmShopItemCates init start");var b=this;b._catHighlight(),b._bindEvt(),c([{selector:".cat-hd",hClass:".cat-hd-hover"}],b._mod),a.log("TshopPbsmShopItemCates init end")},_catHighlight:function(){var b=e.get("#J_TSelectedMenuInfo");if(b){var c=a.JSON.parse(e.val(b)).selectedMenu,d=e.query(".cat-hd",self._mod),f=e.get(".cat-selected",self._mod);if(f&&e.removeClass(f,"cat-selected"),""==c.childCatId||""==c.catId)return;if(c.childCatId==c.catId){for(var g=0;g<d.length;g++)if(e.attr(d[g],"data-cat-id")==c.catId){e.addClass(d[g],"cat-selected");break}}else for(var g=0;g<d.length;g++)if(e.attr(d[g],"data-cat-id")==c.childCatId){e.addClass(d[g],"cat-selected");break}}},_bindEvt:function(){d.on(".cat-name","click",function(a){var b=e.get(a.currentTarget),c=e.parent(b,".cat-hd"),d=e.get(".cat-selected",self._mod);d&&e.removeClass(d,"cat-selected"),c&&!e.hasClass(c,"cat-selected")&&e.addClass(c,"cat-selected")})}}),b.selector=".tshop-pbsm-shop-item-cates",b});KISSY.add("wangpu/mods/official/top-list",function(a,b){function c(a){var b=this;b._mod=a.mod,b._mod&&(b.collectLoaded=!1,b.tabItems=[],b.tabItems[0]=e.parent(e.get(".J_CollectTab",b._mod),"li"),b.tabItems[1]=e.parent(e.get(".J_SaleTab",b._mod),"li"),b.panels=[],b.panels[0]=e.get("div.collection",b._mod),b.panels[1]=e.get("div.sale",b._mod),b.showMoreBtns=[],b.showMoreBtns[0]=e.get(".hotkeep_desc",b._mod),b.showMoreBtns[1]=e.get(".hotsell_desc",b._mod),b._init())}{var a=KISSY,d=a.Event,e=a.DOM;a.all}return a.augment(c,{_init:function(){a.log("TshopPbsmShopTopList init start");var b=this;b.topLists=e.query(c.selector),b.rIndex=a.indexOf(b._mod,b.topLists),b.idx=0,b._renderPanels(),b._bindEvent(),a.log("TshopPbsmShopTopList init end")},_renderPanels:function(){function b(){a.each(c.panels,function(a){e.addClass(a,"disappear")}),a.each(c.showMoreBtns,function(a){e.addClass(a,"disappear")})}var c=this,d=!1;a.each(c.tabItems,function(a,f){e.hasClass(a,"selected")&&(d=!0,b(),e.removeClass(c.panels[f],"disappear"),e.removeClass(c.showMoreBtns[f],"disappear"),c.idx=f,e.hasClass(a,"J_Collect")&&c._initCollectBox(e.attr(a,"data-geturl")))}),0==d&&(e.addClass(c.tabItems[0],"selected"),b(),e.removeClass(c.panels[0],"disappear"),e.removeClass(c.showMoreBtns[0],"disappear"),c.idx=0)},_initCollectBox:function(c){var d=this,c=c+"&jsoncallback=window.shop.rankCallback&index="+d.rIndex;e.html(d.panels[0],'<img class="loading-img" src="//gdp.alicdn.com/tps/i2/T16WJqXaXeXXXXXXXX-32-32.gif" />'),d.collectLoaded=!0,window.shop=window.shop||{},window.shop.rankCallback=function(c){if(void 0!=c.index){var f=d.topLists[c.index],g=e.get(".collection",f),h='<li class="{{odd_even}} {{is_first_last}}"><div class="ranking"><span>{{idx}}</span></div><div class="more"><a target="_blank" href="{{linkUrl}}"><img class="hover-show" src="{{imgUrl}}"></a></div><div class="img"><a href="javascript:void(0);"><img  class="hover-show" src="{{imgUrl}}" alt="\u5546\u54c1\u56fe\u7247"></a></div><div class="detail"><p class="desc"><a href="{{linkUrl}}" title="{{productName}}" target="_blank">{{productName}}</a></p><p class="price"><span class="symbol">&yen;</span><span >{{price}}</span></p><p class="sale">\u5df2\u6536\u85cf<span class="sale-count">{{sellOffCount}}</span>\u7b14</p></div></li>',i="<ul>";a.each(c.items,function(a,d){var e="";0==d?e="first":d==c.items.length-1&&(e+="last"),i+=b(h).render({odd_even:d%2==0?"even":"odd",idx:d+1,linkUrl:a.link,imgUrl:a.imageUrl,price:(parseInt(100*a.price)/100).toFixed(2),productName:a.title,sellOffCount:a.collectorCount,is_first_last:e})}),i+="</ul>",e.html(g,i)}},a.getScript(c)},_bindEvent:function(){var b=this;a.each(b.tabItems,function(a,c){d.on(a,"mouseover",function(){b.idx!=c&&(b.idx=c,e.toggleClass(b.tabItems[0],"selected"),e.toggleClass(b.tabItems[1],"selected"),e.toggleClass(b.panels[0],"disappear"),e.toggleClass(b.panels[1],"disappear"),e.toggleClass(b.showMoreBtns[1],"disappear"),e.toggleClass(b.showMoreBtns[1],"disappear"),e.hasClass(a,"J_Collect")&&b.collectLoaded===!1&&b._initCollectBox(e.attr(a,"data-geturl")))})});var c=setTimeout(function(){}),f=setTimeout(function(){}),g=10,h=100,i=null,j=setTimeout(function(){}),k=null;d.on(b._mod,"mouseover mouseout",function(a){var b=a.target;"mouseover"==a.type?("IMG"==b.tagName&&(clearTimeout(f),c=setTimeout(function(){var a=e.parent(b,"LI");e.removeClass(i,"show-more"),e.addClass(a,"show-more"),i=a},g)),("LI"==b.tagName||e.parent(b,"LI"))&&(clearTimeout(j),e.removeClass(k,"hover"),k="LI"==b.tagName?b:e.parent(b,"LI"),e.addClass(k,"hover"))):"mouseout"==a.type&&("IMG"==b.tagName&&(clearTimeout(c),f=setTimeout(function(){var a=e.parent(b,"LI");e.removeClass(a,"show-more")},h)),("LI"==b.tagName||e.parent(b,"LI"))&&(j=setTimeout(function(){e.removeClass(k,"hover")},50)))})}}),c.selector=".tshop-pbsm-shop-top-list",c},{requires:["template"]});KISSY.add('wangpu/decoration/compatible',function(S){var DOM=S.DOM,Event=S.Event,PX=/px[;]{0,1}/g,shim='//gdp.alicdn.com/tps/i4/T1VhujXXBkXXXXXXXX-1-1.gif',applyPositioning=true,PNG=/\w+\.png$/;function Compatible(elem,config){var offset={"top":"auto","bottom":"auto","left":"auto","right":"auto"};offset.top=DOM.css(elem,'top');offset.bottom=DOM.css(elem,'bottom');if(offset.bottom!=="auto"){offset.top="auto"}offset.left=DOM.css(elem,'left');offset.right=DOM.css(elem,'right');config=config||{};config=S.merge(Compatible.Config,config);this.offset=offset;this.config=config;this.elem=S.get(elem);this._init()}Compatible.Config={"fixed":false,"png":false,"png_bg":false,"png_tag":false,"png_method":"crop","maxWidth":false,"maxHeight":false,"minWidth":false,"minHeight":false,"maxWidthValue":0,"maxHeightValue":0,"minWidthValue":0,"minHeightValue":0};S.augment(Compatible,{_init:function(){var self=this,cfg=self.config;if(cfg.fixed){self._fixIE6PositionFixed()}if(cfg.png){self._fixIE6PngTransparent()}if(cfg.maxWidth&&self._isValidWidthValue()){self._fixMaxWidth()}if(cfg.maxHeight&&self._isValidHeightValue()){self._fixMaxHeight()}if(cfg.minWidth&&self._isValidWidthValue()){self._fixMinWidth()}if(cfg.minHeight&&self._isValidHeightValue()){self._fixMinHeight()}},_fixIE6PositionFixed:function(){var self=this;DOM.css(self.elem,'position','absolute');Event.on(window,'scroll resize',function(e){var top=self.offset.top&&self.offset.top!=="auto"?DOM.scrollTop()+parseInt(self.offset.top.toString().replace(PX,""))+"px":"auto",bottom=self.offset.bottom&&self.offset.bottom!=="auto"&&top==="auto"?DOM.scrollTop()+DOM.viewportHeight()-parseInt(self.offset.bottom.toString().replace(PX,""))-DOM.height(self.elem)+"px":"auto",left=self.offset.left||"auto",right=self.offset.right||"auto";if(top=="auto"){DOM.css(self.elem,'top',bottom)}else{DOM.css(self.elem,'top',top)}DOM.css(self.elem,'left',left);DOM.css(self.elem,'right',right);DOM.css(self.elem,'bottom',bottom)})},_fixIE6PngTransparent:function(){var self=this,cfg=self.config;if(cfg.png_bg==true){self._bg_fnFixPng(self.elem,cfg)}if(cfg.png_tag==true){self._el_fnFixPng(self.elem);if(applyPositioning&&(self.elem.tagName=='A'||self.elem.tagName=='INPUT')&&self.elem.style.position==''){self.elem.style.position='relative'}self._childrenFix(self.elem)}},_bg_fnFixPng:function(obj,cfg){var bg=obj.currentStyle.backgroundImage,src=bg.substring(5,bg.length-2);if(!PNG.test(src)){return}obj.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"', sizingMethod='"+cfg.png_method+"')";obj.style.backgroundImage='url('+shim+')'},_el_fnFixPng:function(img){var src=img.src;if(!PNG.test(src)){return}img.style.width=img.width+"px";img.style.height=img.height+"px";img.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+src+"', sizingMethod='scale')";img.src=shim},_childrenFix:function(elm){var tags=['a','input','select','textarea','button'],t=tags.length;while(t--){var pFix=elm.all.tags(tags[t]),e=pFix.length;while(e--){if(!(/relative|absolute/i).test(pFix[e].currentStyle.position)){pFix[e].style.position='relative'}}}},_isValidWidthValue:function(){var self=this,cfg=self.config;if(cfg.maxWidth&&cfg.minWidth){if(cfg.maxWidthValue<cfg.minWidthValue){return false}}return true},_isValidHeightValue:function(){var self=this,cfg=self.config;if(cfg.maxHeight&&cfg.minHeight){if(cfg.maxHeightValue<cfg.minHeightValue){return false}}return true},_fixMaxWidth:function(){var self=this,cfg=self.config;if(self.elem&&DOM.width(self.elem)>cfg.maxWidthValue){DOM.css(self.elem,"width",cfg.maxWidthValue+"px")}},_fixMaxHeight:function(){var self=this,cfg=self.config;if(self.elem&&DOM.height(self.elem)>cfg.maxHeightValue){DOM.css(self.elem,"height",cfg.maxHeightValue+"px")}},_fixMinHeight:function(){var self=this,cfg=self.config;if(self.elem&&DOM.height(self.elem)<cfg.minHeightValue){DOM.css(self.elem,"height",cfg.minHeightValue+"px")}},_fixMinWidth:function(){var self=this,cfg=self.config;if(self.elem&&DOM.width(self.elem)<cfg.minWidthValue){DOM.css(self.elem,"width",cfg.minWidthValue+"px")}}});return Compatible});KISSY.add('wangpu/mods/official/item-recommend',function(S,Compatible){var S=KISSY,E=S.Event,D=S.DOM;var DISAPPEAR='disappear',SUCCESS='success',WARN='warn',FAILURE='failure';var MINMAX_CONFIG={'grid-m':{'item3line1':[0,0,310,310],'item4line1':[0,0,230,230],'item5line1':[0,0,180,180],'item7line1':[0,0,130,130]},'grid-m0':{'item3line1':[0,0,310,310],'item4line1':[0,0,230,230],'item5line1':[0,0,180,180],'item7line1':[0,0,130,130]},'grid-s5m0':{'item3line1':[0,0,240,240],'item30line1':[0,0,248,248],'item4line1':[0,0,180,180]},'grid-m0s5':{'item3line1':[0,0,240,240],'item30line1':[0,0,248,248],'item4line1':[0,0,180,180]},'grid-s5m0e5':{'item3line1':[0,0,180,180],'item4line1':[0,0,130,130]},'grid-m0s5e5':{'item3line1':[0,0,180,180],'item4line1':[0,0,130,130]},'grid-s5e5m0':{'item3line1':[0,0,180,180],'item4line1':[0,0,130,130]},'grid-e5s5m0':{'item3line1':[0,0,180,180],'item4line1':[0,0,130,130]},'grid-e5m0s5':{'item3line1':[0,0,180,180],'item4line1':[0,0,130,130]},'grid-m0e5s5':{'item3line1':[0,0,180,180],'item4line1':[0,0,130,130]},'col-sub':{'item1line1':[0,0,180,180]},'col-extra':{'item1line1':[0,0,180,180]}};function Msg(elem){this.elem=elem}S.mix(Msg.prototype,{val:function(value,type,h){if(S.isString(value)){h=h===undefined?true:!!h;D.html(D.get('.text',this.elem),value);this.show(type);if(h)this.hide(h)}},loading:function(){return this.val('\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u540e...',1,false)},show:function(type){var elem=this.elem;D.css(elem,'opacity',1);D.removeClass(elem,SUCCESS);D.removeClass(elem,WARN);D.removeClass(elem,FAILURE);D.removeClass(elem,DISAPPEAR);if(type==1){D.addClass(elem,SUCCESS)}else if(type==2){D.addClass(elem,WARN)}else if(type==0){D.addClass(elem,FAILURE)}},hide:function(b){var self=this,elem=self.elem;if(true===b){if(self.timer){self.timer.cancel()}self.timer=S.later(function(){var p={opacity:0},a=new S.Anim(elem,p,0.5,'easeIn',function(){D.addClass(elem,DISAPPEAR);self.timer=null});a.run()},3000);return}D.addClass(elem,DISAPPEAR)}});function TshopPbsmShopItemRecommend(context){var self=this;self._mod=context.mod;if(!self._mod)return;self._init()}S.augment(TshopPbsmShopItemRecommend,{_init:function(){S.log("TshopPbsmShopItemRecommend init start");var self=this,callback;callback=function(){self._updateToken();self._bindEvt();self.fixHover([{selector:'.item-wrap',hClass:'item-wrap-hover'}]);self._initItemRates();self._fixMinMax();S.log("TshopPbsmShopItemRecommend init end")};self._ABTestRequest(callback)},_ABTestRequest:function(callback){var self=this,setting,settings,failCallback;failCallback=function(){callback();return false};if(!(setting=D.attr(self._mod,'data-ald-rcmd')))return failCallback();settings=JSON.parse(setting);if(!settings||!settings.url)return failCallback();S.io({url:settings.url,dataType:'jsonp',data:{refer:document.referrer||""},success:function(data){if(!data||!data.itemList||!data.itemList.length)return failCallback();var skinBox=D.get(".skin-box",self._mod),boxHeight=D.innerHeight(self._mod);D.css(self._mod,"height",boxHeight);D.css(skinBox,"display","none");var items=D.query('.item',self._mod);var rateInput;if(rateInput=D.get('.J_TItemRatesUrl')){var rateLink=D.val(rateInput);var ids=(function(){var arr=[];S.each(data,function(item){arr.push(item.id)});return arr.join(',')})();rateLink.replace(/itemIds=.*&/i,"itemIds="+ids+"&");D.val(rateInput,rateLink)}S.each(items,function(item,key){var newguy=data.itemList[key];var imgEl=D.get('img',item),picSize=settings.picSize?settings.picSize:'310',picStr='_'+picSize+'x'+picSize+'.jpg',newimg=newguy.img+picStr;if(D.attr(imgEl,'data-ks-lazyload')){D.attr(imgEl,'data-ks-lazyload',newimg)}else{D.attr(imgEl,'src',newimg)}D.attr(item,'data-id',newguy.id);D.attr(D.query('a',item),'href',newguy.url);D.text(D.get('.item-name',item),newguy.title);D.text(D.get('.c-price',item),(settings.showDiscount?newguy.price:newguy.marketPrice)||"");if(newguy.marketPrice){D.text(D.get('.s-price',item),newguy.marketPrice||'')}D.text(D.get('.sale-num',item),newguy.sellNum||0);D.text(D.get('.comment-num',item),newguy.commentNum||0)});new Image().src=data['acurl'];D.css(self._mod,"height","auto");D.css(skinBox,"display","block");failCallback()},error:failCallback})},_updateToken:function(){var self=this,tokenField=D.get("#J_TokenField");if(!tokenField){return}var REG_TOKEN=/_tb_token_=[^&].*/i,curToken="_tb_token_="+tokenField.value,collectItems=D.query(".J_TCollectItem",self._mod);S.each(collectItems,function(item){var curHref=D.attr(item,"data-href");if(REG_TOKEN.test(curHref)){D.attr(item,"data-href",curHref.replace(REG_TOKEN,curToken))}else{D.attr(item,"data-href",curHref+=(curHref.lastIndexOf("&")!==-1?"&":"?")+curToken)}})},_bindEvt:function(){var self=this;},fixHover:function(hSelectors){var self=this,elems=[];S.each(hSelectors,function(hSelector){elems=D.query(hSelector.selector,self._mod);S.each(elems,function(elem){E.on(elem,'mouseenter',function(e){S.one(this).addClass(hSelector.hClass)});E.on(elem,'mouseleave',function(e){S.one(this).removeClass(hSelector.hClass)})})})},_bindItemCollectEvt:function(){var self=this,itemList=D.get('.items',self._mod);E.on(itemList,'click',function(e){var t=e.target;if(D.hasClass(t,'J_TCollectItem')){var collectN=t;S.io({url:D.attr(collectN,'data-href'),data:{"itemSkuList":D.attr(collectN,'data-item-id')},dataType:'jsonp',success:function(resp){var msgText,type;if(resp.result.status){msgText='\u6536\u85cf\u6210\u529f';type=1}else{switch(resp.result.message.errorCode){case 7:case 8:case 11:type=2;break;default:type=0}msgText=resp.result.message.error}var msg=new Msg(D.get('.J_TMsg',D.parent(collectN)));msg.val(msgText,type)},error:function(resp){var msg=new Msg(D.get('.J_TMsg',D.parent(collectN)));msg.val('\u64cd\u4f5c\u8d85\u65f6',0)}})}})},_initItemRates:function(){var self=this,itemRatesUrlNode=D.get('.J_TItemRatesUrl',self._mod),top=D.offset(self._mod).top-D.viewportHeight();self.isSendRate=false;function sendUrl(){S.io({url:itemRatesUrlNode.value,dataType:'jsonp',jsonp:'jsoncallback',type:'post',success:function(resp){var rateList=resp.batchQueryRateList,items=D.query('.item',self._mod),itemId,itemRateNode;S.each(items,function(item){itemId=D.attr(item,'data-id');for(var i=0;i<rateList.length;i++){if(rateList[i].auctionNumId==itemId){itemRateNode=D.get('.J_TRate',item);if(rateList[i].rateContent==""){D.text(itemRateNode,"\u6682\u65e0\u8bc4\u8bba")}else{D.text(itemRateNode,filterValWithMaxLen(rateList[i].rateContent,72))}}}})},error:function(resp){S.log('\u67e5\u8be2\u5b9d\u8d1d\u8bc4\u8bba\u5931\u8d25')}})}function scrollHandler(){if(!self.isSendRate&&D.scrollTop(window)>=top){self.isSendRate=true;sendUrl();E.detach(window,'scroll',scrollHandler)}}if(itemRatesUrlNode&&itemRatesUrlNode.value!=''){E.on(window,'scroll',scrollHandler)}},_fixMinMax:function(){var self=this,layer1,layer2;var i;if(D.parent(self._mod,'.col-sub')!=null){layer1=MINMAX_CONFIG['col-sub']}else if(D.parent(self._mod,'.col-extra')!=null){layer1=MINMAX_CONFIG['col-extra']}else{var layout=D.parent(self._mod,'.layout'),layouts=['grid-m','grid-m0','grid-s5m0','grid-m0s5','grid-s5m0e5','grid-m0s5e5','grid-s5e5m0','grid-e5s5m0','grid-e5m0s5','grid-m0e5s5'];for(i=0,l=layouts.length;i<l;i++){if(D.hasClass(layout,layouts[i]))break}layer1=MINMAX_CONFIG[layouts[i]]}var lines=['item1line1','item3line1','item30line1','item4line1','item5line1','item7line1'];var itemLine=D.get('div',D.get('.skin-box-bd',self._mod));for(i=0,l=lines.length;i<l;i++){if(D.hasClass(itemLine,'.'+lines[i])){break}}layer2=layer1?layer1[lines[i]]:layer2;if(typeof layer2==='undefined'){return}var limit=layer2,elem=D.query('img',self._mod),config={},MAP=['minWidth','minHeight','maxWidth','maxHeight'];for(i=0,l=limit.length;i<l;i++){if(parseInt(limit[i])!==0){config[MAP[i]]=true;config[MAP[i]+'Value']=parseInt(limit[i])}}S.each(elem,function(item){new Compatible(item,config)})}});function filterValWithMaxLen(val,maxlength){var lenE=val.length,lenC=0,CJK=val.match(/[\u4E00-\u9FA5\uF900-\uFA2D]/g);if(CJK!=null)lenC+=CJK.length;var surplus=maxlength-lenE-lenC;if(surplus<0){var tmp=0,cut=val.substring(0,maxlength);for(var i=0;i<cut.length;i++){tmp+=/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(cut.charAt(i))?2:1;if(tmp>maxlength)break}return cut.substring(0,i)+"\u2026"}return val}TshopPbsmShopItemRecommend.selector='.tshop-pbsm-shop-item-recommend';return TshopPbsmShopItemRecommend},{requires:['../../decoration/compatible']});KISSY.add("wangpu/mods/other/guanliantuijian",function(S,Template){function TshopPbsmOtherGuanliantuijian(a){{var b=a.mod;a.document}b&&!S.get(".guanliantuijian-preview")&&(S.log("TshopPbsmOtherGuanliantuijian init start"),this.pageType=this.checkPageType(),"design"!==this.pageType&&(this.box=Node.one(b),this.con=Node.one(DOM.get(".J_guanliantuijian",b)),this.bd=Node.one(DOM.get(".J_bd",b)),this.moduleRegion=Node.one(DOM.parent(b,".tb-module")),this.bdGrid=Node.one(DOM.get(".J_blocks",b)),this.tpl=Template(Node.one(DOM.get("textarea",b)).val()),this.data=void 0,this.moduleConfig=this.getModuleConfig(),this.fetch(),S.log("TshopPbsmOtherGuanliantuijian init end")))}var S=KISSY,Event=S.Event,DOM=S.DOM,Node=S.Node,GCfg={pageType:{design:"design",detail:"detail",other:"other"},moduleTitle:{view:"\u5927\u5bb6<b>\u770b</b>\u4e86\u4e4b\u540e\u4f1a\u4e70",buy:"\u5927\u5bb6<b>\u4e70</b>\u4e86\u4e4b\u540e\u8fd8\u4f1a\u4e70",same:"\u540c\u7c7b\u70ed\u9500\u5b9d\u8d1d"},APITpl:"//{host}/api/item?from=shop_detail&p=i&f=jp&pid={itemId}&sid={shopId}&type={type}&style=h",APIHost:location.href.indexOf("daily")>-1?"tui.daily.taobao.net":"tui.taobao.com"};return TshopPbsmOtherGuanliantuijian.prototype={fetch:function(){var a=this;S.IO({type:"get",url:this.getUrl(),success:function(b){a.dataHandle(b),a.render()},dataType:"jsonp",jsonp:"jsonp"})},dataHandle:function(a){var b=a.list,c=a.listDesc.type.split(","),d=a.listDesc.count.split(","),e={blocks:[]},f=this.moduleConfig,g=this;return S.each(c,function(a,c){var f={type:a,title:GCfg.moduleTitle[a],list:b.splice(0,parseInt(d[c]))};e.blocks.push(f)}),S.each(e.blocks,function(a){var b,c,d,e=/_160x160\.jpg$/;if(b=a.list){for(d=0;b[d];d++)c=b[d].pic,c&&"string"==typeof c&&(c=c.replace(/\s*/g,""),e.test(c)||(b[d].pic=c+"_160x160.jpg"));g.itemSort(b,f.sort)}}),this.data=e,e},itemSort:function(a,b){var c;switch(b){case"default":return;case"price":c="price";break;case"sales":c="sellCount";break;default:return}a.sort(function(a,b){return a[c]-b[c]})},render:function(){var a=this.data,b=this.box,c=0;try{for(var d=0;d<a.blocks.length;d++)c+=a.blocks[d].list.length}catch(e){return void S.log("guanliantuijian data error","error")}c>0?(this.bdGrid.html(this.tpl.render(a)),this.con.show()):DOM.addClass(DOM.parent(b,".box"),"hidden")},getLayoutWidth:function(){return this.moduleRegion?this.moduleRegion.width():0},checkPageType:function(){var a=location.origin;return a="detail.taobao.com",a.indexOf("design.taobao")>=0||a.indexOf("design.daily.taobao")>=0?GCfg.pageType.design:a.indexOf("item.taobao")>=0||a.indexOf("item.daily.taobao")>=0?GCfg.pageType.detail:GCfg.pageType.other},getModuleConfig:function(){return eval("("+this.con.attr("data-config")+")")},getUrl:function(){var a=g_config.idata.item.id,b=(g_config.idata.seller.id,g_config.idata.shop.id);return this.url=S.substitute(GCfg.APITpl,{host:GCfg.APIHost,itemId:a,shopId:b,type:this.moduleConfig.type}),this.url}},TshopPbsmOtherGuanliantuijian.selector=".tshop-pbsm-other-guanliantuijian",TshopPbsmOtherGuanliantuijian},{requires:["template"]});KISSY.add("wangpu/mods/official/srch-inshop",function(a){function b(b){var e=d.get(b.mod);if(e){a.log("TshopPbsmShopSrchInshop init start");var f=d.get(".J_TKeyword",e),g=d.query(".J_TCheckPrice",e),h=d.query(".J_TSubmitBtn",e);c.on(f,"focus",function(a){var b=a.target;d.removeClass(b,"prompt"),d.val(b,"")}),c.on(g,"keyup",function(a){var b=/\D/g,c=a.target,e=d.val(c);d.val(c,e.replace(b,""))}),c.on(h,"click",function(a){var b=a.currentTarget,c=d.parent(b,"form");c.submit()}),a.log("TshopPbsmShopSrchInshop init end")}}var a=KISSY,c=a.Event,d=a.DOM;return b.selector=".tshop-pbsm-shop-srch-inshop",b});KISSY.add("wangpu/mods/official/self-defined",function(a){function b(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var a=KISSY,c=a.Event,d=a.DOM,e=document;return a.augment(b,{_init:function(){a.log("TshopPbsmShopSelfDefined init start");var b=this;b._initFilter(),b._initBanner(),a.log("TshopPbsmShopSelfDefined init end")},_initFilter:function(){var b,d,f=this,g="\u60a8\u9009\u4e2d\u7684\u5185\u5bb9\u53ef\u80fd\u6709\u5b89\u5168\u9690\u60a3,\u8bf7\u8c28\u614e\u4f7f\u7528! ",h=f._mod,i=e.createElement("div"),j="<.+(?:",k=").+>",l="\\s*",m=/[\r\n]+/g,n=[["display","none"],["visibility","hidden"],["width","0"],["text-indent","-\\d{3,}"]],o=[];a.each(n,function(a){o.push(a[0]+l+":"+l+a[1])}),b=j+o.join("|")+k,d=new RegExp(b,"mi"),c.on(h,"copy",function(a){var b,c;window.getSelection?b=window.getSelection():e.selection&&(b=e.selection.createRange()),c=b.htmlText||b.getRangeAt(0).cloneContents(),"string"!=typeof c&&(i.appendChild(c),c=i.innerHTML),c=c.replace(m,""),d.test(c)&&(alert(g),a.halt()),i.innerHTML=""})},_initBanner:function(){var b=d.get(".J_TBannerMaker",this._mod);if(b){var c=d.attr(b,"data-jsurl");c&&a.getScript(c,function(){BM&&BM.getURL(function(a){d.attr(b,"src",a)})})}}}),b.selector=".tshop-pbsm-shop-self-defined",b});KISSY.add("wangpu/mods/other/customer-service",function(S){function TshopPbsmOtherCustomerService(a){var b=this;b._mod=a.mod,b._mod&&b._init()}var S=KISSY,DOM=S.DOM,Node=S.Node;return S.augment(TshopPbsmOtherCustomerService,{_init:function(){S.log("TshopPbsmOtherCustomerService init start");var a=this;a._displayWWGroop(),S.log("TshopPbsmOtherCustomerService init end")},_displayWWGroop:function(){var self=this,tempwangwang,templi,tempdesc,api="//amos.alicdn.com/",config="groupid=0&v=2&site=cntaobao&s=1&charset=utf-8&uid=",uls=Node.all("ul.service-group",self._mod),node=uls.item(uls.length-1),url=node.attr("data-url"),nick=node.attr("data-nick"),gnick=node.attr("data-gnick"),groupIdFilter=node.attr("data-group-filter").split("@_@");node.children().innerHTML=null,""!=url&&S.getScript(url,function(){try{var groups=eval("("+groupMember+")").groups}catch(err){var groups=""}var showMainWW=function(){templi=DOM.create("<li>",{"data-wangwang":"mainwangwang"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,"\u5ba2\u670d\u4e2d\u5fc3"),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?"+config+nick+"&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"online.aw?"+config+nick,alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi)};if(""!=groups&&groups.group&&groups.group.length&&""!=groupIdFilter[0]){var groupMembers=groups.group,count=0;S.each(groupMembers,function(a,b){(S.inArray(groupMembers[b].groupId.toString(),groupIdFilter)||"all"==groupIdFilter[0])&&(templi=DOM.create("<li>",{"class":"group"}),tempdesc=DOM.create("<span>",{"class":"groupname"}),DOM.html(tempdesc,groupMembers[b].groupName),tempwangwang=DOM.create("<a>",{href:api+"getcid.aw?v=3&uid="+gnick+"&site=cntaobao&groupid="+groupMembers[b].groupId+"&s=1&charset=gbk&fromid=cntaobao"+(S.Cookie.get("_nk_")?S.fromUnicode(S.Cookie.get("_nk_")):""),target:"_blank"}),tempwangwang.appendChild(DOM.create("<img>",{src:api+"grponline.aw?v=3&uid="+gnick+"&site=cntaobao&gids="+groupMembers[b].groupId+"&s=1",alt:"\u70b9\u51fb\u8fd9\u91cc\u7ed9\u6211\u53d1\u6d88\u606f"})),templi.appendChild(tempdesc),DOM.insertAfter(tempwangwang,tempdesc),node.append(templi),count++)}),count||showMainWW()}else showMainWW()})}}),TshopPbsmOtherCustomerService.selector=".tshop-pbsm-other-customer-service",TshopPbsmOtherCustomerService});KISSY.add("wangpu/mods/other/taoke-recharge",function(a){function b(b){var h=this;if(h._mod=b.mod,h._mod&&d.attr("#J_AlimRechargeData","data-value")){var i=a.JSON.parse(d.attr("#J_AlimRechargeData","data-value")),j=i.taokeServer,k={phoneList:"/chongzhi/phone_list.do",phoneSearch:"/chongzhi/phone_search.do",phoneCard:"/chongzhi/phone_card.do"},l={qqList:"/chongzhi/qq_list.do",qqCard:"/chongzhi/qq_card.do"},m={cardList:"/chongzhi/dian_ka_list.do",cardBuy:"/chongzhi/dian_ka.do"},n={onlineList:"/chongzhi/hot_games.do",onlineBuy:"/chongzhi/game_goods_submit.do"},o="mm_"+i.taokepid+"_0_0",p={tel:"//s8.taobao.com/search?q=%B3%E4%D6%B5&ex_q=&filterFineness=&atype=&isprepay=1&promoted_service4=4&user_type=1&olu=yes&commend=all&sort=coefp&style=grid&viewIndex=7&p4p_str=lo1%3D0%26lo2%3D0%26nt%3D1&mode=86&${SearchString}&b=zhl347",card:"//s8.taobao.com/search?q=%B5%E3%BF%A8&${SearchString}&mode=86&rt=1323847099431",gold:"//s8.taobao.com/search?q=qq&{SearchString}&mode=86&rt=1323847137408",online:"//s8.taobao.com/search?q=%CD%F8%D3%CE&unid=0&mode=86&${SearchString}&p4p_str=lo1%3D0%26lo2%3D0%26nt%3D1&cat=50017708&from=compass&navlog=compass-3-c-50017708"},q="\u53f7\u7801\u6709\u8bef,\u8bf7\u91cd\u65b0\u8f93\u5165",r="\u53f7\u7801\u4e0d\u4e00\u81f4,\u8bf7\u91cd\u65b0\u8f93\u5165",s="\u8d27\u7269\u6682\u7f3a",t="\u83b7\u53d6\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5",u={create:function(){"undefined"!=typeof localStorage?c=localStorage:g&&(c=f.createElement("input"),c.type="hidden",f.body.appendChild(c),c.addBehavior("#default#userData"))},set:function(a,b){if("setItem"in c)c.setItem(a,b);else if(g)try{c.setAttribute(a,b),c.save("IELocalDataStore")}catch(d){}},get:function(a){if("getItem"in c)return c.getItem(a);if(g)try{return c.load("IELocalDataStore"),c.getAttribute(a)}catch(b){}}},v=function(a){this._gameSubbtn=d.get("#J_AlimGameSubmit",a),this._gameCatD=d.get("#J_AlimGameCatId",a),this._catOpts=this._gameCatD.options,this._gameCatNameD=d.get("#J_AlimGameCatName",a),this._parPriceLabelD=d.get("#J_AlimGameParPrice_label",a),this._parPriceD=d.get("#J_AlimGameParPrice",a),this._parPriceOpts=this._parPriceD.options,this._gameSalePriceEntry=d.get("#J_AlimGameSalePriceEntry",a),this._gameSalePriceLabelD=d.get("#J_AlimGameSalePriceLabel",a),this._gameSalePriceD=d.get("#J_AlimGameSalePrice",a),this._gameCardD=d.get("#J_AlimGameCard",a),this._gameGoldD=d.get("#J_AlimGameGold",a),this._gameOnlineD=d.get("#J_AlimGameOnline",a),this._gameMsgBox=d.get("#J_AlimGameMsgBox",a),this._gameMsgD=d.get("#J_AlimGameMsg",a),this._isGameLackItem=!1,this._currentGameType=null,this.GAME_TYPE={GOLD:"gold",CARD:"card",ONLINE:"online"},this._catIndex=0,this._parPriceIndex=0,this._gameCatsInfo=new Array,this._gameItemsInfo=null,this._searchMore=null;var b=this;window.setTimeout(function(){b.init()},200)};a.augment(v,{init:function(){this._initGameEvent();var a=i.showCard+i.showGold+i.showOnline;a>1?"card"==u.get("gameType")?(d.attr(this._gameCardD,"checked","checked"),this._displayCatName(this._gameCardD)):"gold"==u.get("gameType")?(d.attr(this._gameGoldD,"checked","checked"),this._displayCatName(this._gameGoldD)):"online"==u.get("gameType")?(d.attr(this._gameOnlineD,"checked","checked"),this._displayCatName(this._gameOnlineD)):d.attr(this._gameCardD,"checked")?this._displayCatName(this._gameCardD):d.attr(this._gameGoldD,"checked")?this._displayCatName(this._gameGoldD):d.attr(this._gameOnlineD,"checked")?this._displayCatName(this._gameOnlineD):(d.attr(this._gameCardD,"checked","checked"),this._displayCatName(this._gameCardD)):i.showCard?(this._currentGameType=this.GAME_TYPE.CARD,this._requestCardCatsInfo()):i.showGold?(this._currentGameType=this.GAME_TYPE.GOLD,this._requestQQCatsInfo()):i.showOnline&&(this._currentGameType=this.GAME_TYPE.ONLINE,this._togglePriceEntry("hidden"),this._requestOnlineCatsInfo())},_initGameEvent:function(){var b=this;a.each([b._gameCardD,b._gameGoldD,b._gameOnlineD],function(a){!!a&&e.on(a,"click",function(){b._msgToRecharge(),b._displayCatName(this)})},b),e.on(b._gameCatD,"change",function(){b._catIndex=this.selectedIndex,b._catChange()}),e.on(b._parPriceD,"change",function(){b._parPriceIndex=this.selectedIndex,b._parPriceChange()})},_clearDataCache:function(){this._gameCatsInfo=[],this._gameItemsInfo=null},_markGameLackItem:function(a){this._gameSalePriceLabelD.innerHTML="\u6682\u7f3a\uff1a",this._gameSalePriceD.innerHTML="<a href='"+p[a].replace(/\$\{SearchString\}/,"pid="+o)+"' target='_blank'>\u70b9\u6b64\u641c\u7d22</a>",d.hasClass(this._gameSubbtn,"hidden")||d.addClass(this._gameSubbtn,"hidden")},_displayCatName:function(a){switch(this._clearDataCache(),this._clearPrice(),d.attr(a,"id")){case"J_AlimGameGold":this._currentGameType=this.GAME_TYPE.GOLD,u.set("gameType","gold"),d.text(this._gameCatNameD,"\u79cd\u7c7b\uff1a"),d.text(this._parPriceLabelD,"\u9762\u503c\uff1a"),this._togglePriceEntry("show"),this._requestQQCatsInfo();break;case"J_AlimGameCard":this._currentGameType=this.GAME_TYPE.CARD,u.set("gameType","card"),d.text(this._gameCatNameD,"\u6e38\u620f\uff1a"),d.text(this._parPriceLabelD,"\u9762\u503c\uff1a"),this._togglePriceEntry("show"),this._requestCardCatsInfo();break;case"J_AlimGameOnline":this._currentGameType=this.GAME_TYPE.ONLINE,u.set("gameType","online"),d.text(this._gameCatNameD,"\u6e38\u620f\uff1a"),d.text(this._parPriceLabelD,"\u7269\u54c1\uff1a"),this._togglePriceEntry("hidden"),this._requestOnlineCatsInfo()}},_togglePriceEntry:function(a){"show"===a?d.removeClass(this._gameSalePriceEntry,"hidden"):"hidden"===a&&(d.hasClass(this._gameSalePriceEntry,"hidden")||d.addClass(this._gameSalePriceEntry,"hidden"))},_requestOnlineCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+n.onlineList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getOnlineCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getOnlineCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_requestCardCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+m.cardList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getCardCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getCardCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._gameCatsInfo.sort(function(a,b){return a.catData.name.localeCompare(b.catData.name)}),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_requestQQCatsInfo:function(){var b=this;a.io({dataType:"jsonp",url:j+l.qqList,success:function(a){return a.success?(b._isGameLackItem=!1,void b.getQQCats(a)):(b._isGameLackItem=!0,void b._rechargeToMsg(t,"warning"))}})},getQQCats:function(b){return b.data?(a.each(b.data,function(a,b){this._gameCatsInfo.push({catId:b,catData:a})},this),this._fillCatOpts(),void this._catChange()):void h._rechargeToMsg(t,"warning")},_fillCatOpts:function(){var b=this._catOpts;this._recoveryCatOpts(),this._recoveryPrice(),this._gameCatsInfo.length>0&&a.each(this._gameCatsInfo,function(a){b[b.length]=new Option(a.catData.name,a.catId)})},_recoveryCatOpts:function(){this._catOpts.length=0,this._catIndex=0},_recoveryPrice:function(){this._parPriceOpts.length=0,this._parPriceIndex=0,d.text(this._gameSalePriceD,"")},_catChange:function(){this._recoveryPrice(),this._clearPrice(),this._gameItemsInfo=this._gameCatsInfo[this._catIndex],this._fillParPriceOpts(),this._parPriceChange()},_fillParPriceOpts:function(){var b,c,d=this._parPriceOpts;this._currentGameType===this.GAME_TYPE.ONLINE?(b=this._gameItemsInfo?this._gameItemsInfo.catData.goods:[],c=b.length>0?this._gameItemsInfo.catData.pidvid:[]):(b=this._gameItemsInfo?this._gameItemsInfo.catData.price:[],c=b.length>0?this._gameItemsInfo.catData.price_vid:[]),this._msgToRecharge(),a.each(b,function(a,b){d[d.length]=new Option(a,c[b])})},_clearPrice:function(){d.text(this._gameSalePriceLabelD,"\u552e\u4ef7\uff1a"),d.text(this._gameSalePriceD,""),d.hasClass(this._gameSubbtn,"hidden")&&d.removeClass(this._gameSubbtn,"hidden")},_parPriceChange:function(){this._clearPrice();var b=this._parPriceIndex,c=this._gameItemsInfo;switch(this._currentGameType){case this.GAME_TYPE.GOLD:var d=c.catData,e=this;a.io({dataType:"jsonp",url:j+l.qqCard,data:{cat_id:c.catId,price_id:d.price_id,mm_id:o,price_vid:d.price_vid[b],service_id:d.service_id},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,void e._markGameLackItem("gold"))}});break;case this.GAME_TYPE.CARD:var d=c.catData,e=this;a.io({dataType:"jsonp",url:j+m.cardBuy,data:{cat_id:c.catId,price_id:d.price_id,mm_id:o,price_vid:d.price_vid[b],service_id:d.service_id},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,void e._markGameLackItem("card"))}});break;case this.GAME_TYPE.ONLINE:var d=c.catData,e=this;e._togglePriceEntry("hidden"),a.io({dataType:"jsonp",url:j+n.onlineBuy,data:{cat_id:c.catId,mm_id:o,pidvid:d.pidvid[b]},success:function(a){return a.success?(e._isGameLackItem=!1,void e._fillPriceAndEnableBuy({clickUrl:a.click_url,price:a.price})):(e._isGameLackItem=!0,e._togglePriceEntry("show"),void e._markGameLackItem("online"))}})}},_fillPriceAndEnableBuy:function(a){d.text(this._gameSalePriceD,a.price),d.attr(this._gameSubbtn,"href",a.clickUrl),this._msgToRecharge()},_rechargeToMsg:function(b,c){d.text(this._gameMsgD,b),d.hasClass(this._gameMsgBox,c)||("dealing"==c&&(d.hasClass(this._gameMsgBox,"warning")&&d.removeClass(this._gameMsgBox,"warning"),d.hasClass(this._gameSubbtn,"hidden")||d.addClass(this._gameSubbtn,"hidden")),d.addClass(this._gameMsgBox,c)),d.hasClass(this._gameMsgBox,"hidden")&&d.removeClass(this._gameMsgBox,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))},_msgToRecharge:function(){d.hasClass(this._gameMsgBox,"hidden")||d.addClass(this._gameMsgBox,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))}});var w=function(a){this._telBoxType=190==d.width(d.parent(a))?"vt":"hz",this._telPanel=d.get(".tel-panel",a),this._telSubbtn=d.get("#J_AlimTelSubmit",a),this._telMsgBoxD=d.get("#J_AlimTelMsgBox",a),this._telMsgD=d.get("#J_AlimTelMsg",a),this._telOperatorD=d.get("#J_AlimTelOperator",a),this._parPriceD=d.get("#J_AlimTelParPrice",a),this._parPriceOpts=this._parPriceD.options,this._telSalePriceLabelD=d.get("#J_AlimTelSalePriceLabel",a),this._telSalePriceD=d.get("#J_AlimTelSalePrice",a),this._telInputD=d.get("#J_AlimTelInput",a),this._telInputCfmD=d.get("#J_AlimTelInputCfm",a),this._telProvinceD=d.get("#J_AlimTelProvince",a),this._telCatNameD=d.get("#J_AlimTelCatName",a),this._isTelLackItem=!1,this._mobilesInfo=new Array,this._getPriceData={},this._getPriceData.mm_id=o,this._initTelEvent(),this._getPrice()};a.augment(w,{_initTelEvent:function(){var a=this;e.on(a._telInputD,"focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt")),d.attr(a._telInputCfmD,"disabled")&&d.removeAttr(a._telInputCfmD,"disabled"),a._msgToRecharge()}),e.on(a._telInputCfmD,"focus",function(){d.hasClass(this,"prompt")&&(d.val(this,""),d.removeClass(this,"prompt"))}),e.on(a._telInputD,"paste",function(){return!1}),e.on(a._telInputCfmD,"paste",function(){return!1}),e.on(a._telInputD,"contextmenu",function(){return!1}),e.on(a._telInputCfmD,"contextmenu",function(){return!1}),e.on(a._telInputD,"keyup",function(){var b=/\D/g,c=d.val(this);d.val(this,c.replace(b,"")),d.val(a._telInputCfmD)&&(d.val(a._telInputCfmD,"\u8bf7\u518d\u6b21\u8f93\u5165"),d.addClass(a._telInputCfmD,"prompt")),d.hasClass(a._telOperatorD,"hidden")||d.addClass(a._telOperatorD,"hidden"),a._clearPrice()}),e.on(a._telInputCfmD,"keyup",function(){var a=/\D/g,b=d.val(this);d.val(this,b.replace(a,""))}),e.on(a._telInputD,"blur",function(){("1"!==d.val(this).charAt(0)||d.val(this).length<11)&&(a._rechargeToMsg(q,"warning"),d.attr(a._telInputCfmD,"disabled","disabled"))}),e.on(a._telInputCfmD,"blur",function(){d.val(a._telInputD)!==d.val(a._telInputCfmD)?a._rechargeToMsg(r,"warning"):a._msgToRecharge()}),e.on(a._telInputCfmD,"keyup",function(){11===d.val(a._telInputCfmD).length&&(d.val(a._telInputD)!==d.val(a._telInputCfmD)?a._rechargeToMsg(r,"warning"):(a._msgToRecharge(),a._getOperators()))}),e.on(a._parPriceD,"change",function(){a._priceChange(this)}),e.on(a._telSubbtn,"click",function(b){"1"!==d.val(a._telInputD).charAt(0)||d.val(a._telInputD).length<11?(a._rechargeToMsg(q,"warning"),b.halt()):d.val(a._telInputD)!==d.val(a._telInputCfmD)?(a._rechargeToMsg(r,"warning"),b.halt()):0==a._parPriceOpts.length?(a._rechargeToMsg(s,"warning"),b.halt()):a._isTelLackItem&&b.halt()})},_isPhoneCheckOK:function(a){var b=d.val(this._telInputD),c=d.val(this._telInputCfmD);return"1"!==b.charAt(0)||11!==b.length?(a&&this._rechargeToMsg(q,"warning"),!1):b!==c?(a&&this._rechargeToMsg(r,"warning"),!1):!0},_priceChange:function(b){var c=this;c._clearPrice();var e=b.selectedIndex;c._getPriceData.price_id=c._mobilesInfo[e].id,c._getPriceData.phone=d.val(c._telInputD),c._isPhoneCheckOK()&&a.io({dataType:"jsonp",url:j+k.phoneCard,data:c._getPriceData,success:function(a){return a.success?(c._isTelLackItem=!1,d.text(c._telSalePriceD,a.price),d.attr(c._telSubbtn,"href",a.click_url),d.hasClass(this,"prompt")&&d.removeClass(this,"prompt"),void c._msgToRecharge()):(c._isTelLackItem=!0,void c._markLackItem())}})},_markLackItem:function(){this._telSalePriceLabelD.innerHTML="\u7f3a\u8d27\uff1a",this._telSalePriceD.innerHTML="<a href='"+p.tel.replace(/\$\{SearchString\}/,"pid="+o)+"' target='_blank'>\u70b9\u6b64\u641c\u7d22</a>",d.hasClass(this._telSubbtn,"hidden")||d.addClass(this._telSubbtn,"hidden")},_clearPrice:function(){this._telSalePriceLabelD.innerHTML="\u552e\u4ef7\uff1a",d.text(this._telSalePriceD,""),d.hasClass(this._telSubbtn,"hidden")&&d.removeClass(this._telSubbtn,"hidden")},_rechargeToMsg:function(b,c){var e=this;d.text(e._telMsgD,b),"warning"!=c||b!=q&&b!=r||(d.hasClass(e._telOperatorD,"hidden")||d.addClass(e._telOperatorD,"hidden"),d.hasClass(e._telOperatorD,"operator")&&d.removeClass(e._telOperatorD,"operator")),d.hasClass(e._telMsgBoxD,c)||("dealing"==c&&(d.hasClass(e._telMsgBoxD,"warning")&&d.removeClass(e._telMsgBoxD,"warning"),d.hasClass(e._telSubbtn,"hidden")||d.addClass(e._telSubbtn,"hidden")),d.addClass(e._telMsgBoxD,c)),d.hasClass(e._telMsgBoxD,"hidden")&&d.removeClass(e._telMsgBoxD,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(e._telSubbtn,"zoom",""),d.css(e._telSubbtn,"zoom","1"))},_msgToRecharge:function(){d.hasClass(this._telMsgBoxD,"hidden")||d.addClass(this._telMsgBoxD,"hidden"),a.UA.ie&&8>a.UA.ie&&(d.css(this._telSubbtn,"zoom",""),d.css(this._telSubbtn,"zoom","1"))},_getOperators:function(){var b=this;a.io({dataType:"jsonp",url:j+k.phoneSearch,data:{phone:d.val(b._telInputD)},success:function(a){return a.success?(b.displayOperators(a),void b._priceChange(b._parPriceD)):void b._rechargeToMsg(q,"warning")}})},displayOperators:function(a){var b=this;b._getPriceData.cat_id=a.cat_id,b._getPriceData.province_id=a.province_id;var c=a.cat_name.substr(2);d.text(b._telOperatorD,a.province_name+c),d.hasClass(b._telOperatorD,"hidden")&&d.removeClass(b._telOperatorD,"hidden"),d.hasClass(b._telOperatorD,"operator")||d.addClass(b._telOperatorD,"operator"),d.val(b._telProvinceD,a.province),d.val(b._telCatNameD,c)},_getPrice:function(){var b=this;a.io({dataType:"jsonp",url:j+k.phoneList,success:function(a){return a.success?void b.displayPrice(a):void b._rechargeToMsg(t,"warning")}})},displayPrice:function(b){var c=this._parPriceOpts;return b.denomination?(this._mobilesInfo=b.denomination,c.length>0&&(c.length=0),d.hasClass(this._parPriceD,"prompt")&&d.removeClass(this._parPriceD,"prompt"),d.text(this._telSalePriceD,""),void(this._mobilesInfo.length>0&&a.each(this._mobilesInfo,function(a){var b=new Option(a.name,a.id);"100\u5143"===a.name&&(b.selected=!0),c[c.length]=b}))):void this._rechargeToMsg(t,"warning")}}),h._init(u,i,w,v)}}var c,a=KISSY,d=a.DOM,e=a.Event,f=document,g=document.all;return a.augment(b,{_init:function(b,c,d,e){a.log("TshopPbsmOtherTaokeRecharge init start");var f=this;a.ready(function(){if(b.create(),c.showMobile){new d(f._mod)}if(c.showCard||c.showGold||c.showOnline){new e(f._mod)}}),a.log("TshopPbsmOtherTaokeRecharge init end")}}),b.selector=".tshop-pbsm-other-taoke-recharge",b});