KISSY.add("malldetail/sku/stock",function(e,t){function a(e,a,i,n,o){var r=typeof e,l=[];if(i&&i.restrictAmount){if("number"===r&&e<=i.amountCanBuy)return;i.restrictAmount==i.amountCanBuy||"undefined"==r?(l.push("\u6bcf\u4eba\u9650\u8d2d"+i.restrictAmount+"\u4ef6"),codeTrack("mod.amountRestrict.show.2","mod.stock.init")):i.amountCanBuy>0?(l.push("\u6bcf\u4eba\u9650\u8d2d"+i.restrictAmount+"\u4ef6\uff0c\u60a8\u8fd8\u53ef\u8d2d\u4e70"+i.amountCanBuy+"\u4ef6"),codeTrack("mod.amountRestrict.show.1","mod.stock.init")):(l.push("\u6bcf\u4eba\u9650\u8d2d"+i.restrictAmount+"\u4ef6\uff0c\u60a8\u5df2\u8d85\u8fc7\u9650\u8d2d\u6570"),codeTrack("mod.amountRestrict.show.0","mod.stock.init"))}a&&a.buyerAmountRestriction&&(!i||!i.restrictAmount||a.buyerAmountRestriction<i.restrictAmount)&&(l.push("\u8be5\u4f18\u60e0\u6bcf\u4eba\u9650\u8d2d"+a.buyerAmountRestriction+"\u4ef6"),codeTrack("mod.amountRestrict.show.4","mod.stock.init")),l.length&&t.html(n,"\uff08"+l.join(" ")+"\uff09"),i&&!i.restrictAmount&&i.moneyCanBuy&&(t.html(n,"\uff08\u6bcf\u4eba\u9650\u8d2d"+i.moneyCanBuy+"\u5143\uff09"),codeTrack("mod.amountRestrict.show.3","mod.stock.init"))}return{"init":function(e){codeTrack("mod.stock.init","trade.main.init");var i=e.product,n=t.get("#J_StockTips"),o=e.hideStock,r=e.el;i.onChange(["currentInventory","soldArea","currentPromotion","itemPrice","currentAmountRestrict","isAreaRestricted","model"],function(e,t,l,s,c,d,u){if(d)return void(r.innerHTML="");var m=!t||!t.cityData||t.cityData.allAreaSold;o||(r.innerHTML=2!=e.type||m?e&&e.inventoryInfo?e.inventoryInfo:u&&u.minisiteDO&&u.minisiteDO.validMlhItem&&e.quantity<6?'\u4ec5\u5269<span class="stock-only">'+e.quantity+"</span>\u4ef6":"\u5e93\u5b58"+e.quantity+"\u4ef6":"\u5e93\u5b58\u5145\u8db3"),codeTrack("mod.stock.show","mod.stock.init",{"group":e.type+(e.quantity?"1":"0")}),i.onLoad("model",function(t){t.switcherDO&&t.switcherDO.amountRestrictDisable||a(e.quantity,l,c,n,o)})}),i.onChange(["isAreaRestricted","tradeResult","currentInventory"],function(e,a,i){o||a&&"stock"==a.name||e||!i.quantity?t.hide(r):t.show(r)})}}},{"requires":["dom","event"]});KISSY.add("malldetail/sku/address",function(e,t,a,i){return{"init":function(n){var o=n.el,r=n.product;if(o){codeTrack("trade.address.init","mod.freight.init"),r.onLoad(["buyerLoc","misc","config","itemDO"],function(a,i,n,r){if(i&&a){r.isHotItem&&!i.cityId&&e.mix(i,{"city":"\u676d\u5dde","cityId":"330100","region":"\u4e0a\u57ce\u533a","regionId":"330102"});var l=n.detail.addressLevel||(3==t.attr(o,"combo-level")?3:2),s='<span role="button" tabindex="0" aria-haspopup="true" data-code="'+i.cityId+'" class="mui_addr_tri_1">'+i.city+'<i class="mui_addr_icon">&#xe62b;</i></span>';if(3==l){var c=i.cityId==i.regionId?"style='display:none'":"";s+='<span role="button" tabindex="0" aria-haspopup="true" data-code="'+i.regionId+'" class="mui_addr_tri_2" '+c+">"+i.region+'<i class="mui_addr_icon">&#xe62b;</i></span>'}else 4==l&&(s+='<span role="button" tabindex="0" aria-haspopup="true" class="mui_addr_tri_2" data-code="'+i.townId+'">'+(i.cityId==i.regionId?i.town:[i.region,i.town].join(" "))+'<i class="mui_addr_icon">&#xe62b;</i></span>');codeTrack("trade.address.show","trade.address.init"),t.html(o,s)}});var l=i.createLoader(function(a){e.use("malldetail/address/index",function(e,i){r.onLoad(["misc","config"],function(n,l){var s=l.detail.addressLevel||(3==t.attr(o,"combo-level")?3:2),c=new i({"product":r,"node":o,"level":s,"city":n.city,"cityId":n.cityId,"region":n.region,"regionId":n.regionId,"street":n.town,"streetId":n.townId,"suffix":'<span class="mui_addr_icon">&#xe62b;</span>',"getAreaStatus":function(e,t){r.canSoldArea(e,function(e){t({"disabled":!e})})}});c.on("areaChange",function(t){r.set("buyerLoc",t.areaId),g_config&&"chaoshi"===g_config.pageId&&e.use("cookie",function(e,a){a.set("sm4",t.areaId,30,"tmall.com")})}),a(c)})})});r.onLoad(["misc","soldArea","currentInventory","amountMultiple"],function(e,t,a,i){g_config&&"chaoshi"===g_config.pageId&&r.canBuy({},function(n){var o=!1;if(("stock"==n.name||"areaSold"==n.name||a.quantity>0&&i>0&&i>a.quantity)&&(o=!0),o&&e.regionId&&t.regionData&&t.regionData.soldAreas){var r=t.regionData.soldAreas,s=r.sort();l(function(t){setTimeout(function(){for(var a=0;a<s.length;a++)if(s[a]!==e.regionId)return void t.selectArea(s[a])},1e3)})}})}),a.on(o,"click",function(e){e.preventDefault();var a=e.target,i=!1;TShop.sendAtpanel("tmalldetail.11.1"),l(function(){i=!0},2),i||l(function(e){t.hasClass(a,"mui_addr_tri_2"),e.show(),codeTrack("trade.address.click","trade.address.show")})})}}}},{"requires":["dom","event","malldetail/common/util"]});KISSY.add("malldetail/sku/thumbViewer",function(e,t,a,i){function n(e,a){var i=new Image;i.onload=i.onerror=function(){a(i),i=null},d||t.prepend(d=t.create('<div style="position:relative;width:0;height:0;overflow:hidden;">'),document.body),d.appendChild(i),i.src=e}var o,r,l,s,c,d,u,m,p,f=100,h="tb-selected",g={},v=!1,b=0,y=i.createLoader(function(a){if("ontouchstart"in document)return void a(null);var i={"imageNode":o,"width":480,"height":360,"bigImageWidth":800,"bigImageHeight":800,"align":{"node":t.parent(o,"a"),"points":["tr","tl"],"offset":[10,-1]},"hasZoom":!("ontouchstart"in document),"preload":!1,"showIcon":!0};e.use("malldetail/common/imagezoom",function(e,n){var o=new n(i);o.on("show",function(){t.hide(m)}),o.on("hide",function(){t.show(m)}),a(o),codeTrack("mod.gallery.imagezoom","mod.gallery.init")})});return{"init":function(i){var n=this,d=i.product;if(e.mix(n,i),(o=t.get("#J_ImgBooth"))&&(r=t.get("#J_UlThumb"))){codeTrack("mod.gallery.init","view.metaLeft.init");var u=o.src;p=u.substr(u.lastIndexOf("_")),l=t.query("li",r),n.trgsLength=l.length,n.currentIndex=0,c=parseInt(o.getAttribute("data-hasZoom"),10),TShop.afterWinLoad(function(){d.onLoad("deviceType",function(e){n.deviceType=e,"pad"==e?n._gestureRecognition(o,function(e){var t=n.currentIndex+1;t>=n.trgsLength&&(t=0),n.switchTo(l[t])},function(e){var t=n.currentIndex-1;t<0&&(t=n.trgsLength-1),n.switchTo(l[t])}):n.slideEvent()}),a.on(r,"click",function(e){e.preventDefault()}),a.on(l,"mouseenter",function(t){s&&s.cancel(),s=e.later(function(){n.switchTo(t.target),TShop.sendAtpanel("tmalldetail.13.6",1e4),codeTrack("mod.gallery.switch","mod.gallery.init")},f)}),a.on(l,"mouseleave",function(){s&&s.cancel()}),n.switchTo(t.get("."+h,r),!0)}),d.onLoad("deviceType",function(e){if("pad"==e){var a=g_config.shopUrl,i=(t.attr(t.get("a",t.get(".slogo-extraicon","#shopExtra")),"href"),t.get(".slogo-extraicon","#shopExtra"));(function(e,a){if(!e)return void a(undefined);var i=arguments.callee,n=t.get("a",e);if(!n)return void setTimeout(function(){i(e,a)},500);a(t.attr(n,"href"))})(i,function(e){var i;if(e)i=t.create('<div class="pad-shop-href-box"><div class="shop-url"><a href="'+a+'"><i>&#xe623;</i>\u8fdb\u5165\u5e97\u94fa</a></div><div class="shop-ww"><a href="'+e+'"><i>&#xe624;</i>\u8054\u7cfb\u5356\u5bb6</a></div></div>'),t.insertAfter(i,r);else{if(!(128&g_config.bizTag))return;i=t.create('<div class="pad-shop-href-box"><div class="shop-icon"><s></s>\u8fd8\u6709<strong>1\u5143</strong>\u5546\u54c1\u7b49\u4f60\u6311</div><div class="shop-url"><a href="//chaoshi.tmall.com"><i>&#xe623;</i>\u8fdb\u5165\u8d85\u5e02</a></div></div>'),t.insertAfter(i,r)}})}})}},"reset":function(){var i=this;l=t.query("li",r),i.trgsLength=l.length,a.on(r,"click",function(e){e.preventDefault()}),a.on(l,"mouseenter",function(t){s&&s.cancel(),s=e.later(function(){i.switchTo(t.target),TShop.sendAtpanel("tmalldetail.13.6",1e4),codeTrack("mod.gallery.switch","mod.gallery.init")},f)}),a.on(l,"mouseleave",function(){s&&s.cancel()})},"switchTo":function(a,i){if(a){this.currentIndex=e.indexOf(a,l),"LI"!==a.tagName&&(a=t.parent(a,"li"));var n=a.getElementsByTagName("img")[0],o=n&&n.src;o&&(o=o.substring(0,o.lastIndexOf("_")),this.show(o,i),t.addClass(a,h))}},"show":function(e,a){var r=this;if(r.onSwitch&&r.onSwitch(e),t.removeClass(l,h),o.src=e+p,c){var s=g[e]||(g[e]={"src":e});s.onMidImg=s.onMidImg||i.createLoader(function(t){n(e+p,t)}),s.onBigImg=s.onBigImg||i.createLoader(function(t){n(e,t)}),!0===a&&(s.onQ30Img=s.onQ30Img||i.createLoader(function(t){n(e+"_q30.jpg",t)})),s.onHasZoom=s.onHasZoom||i.createLoader(function(e){s.onMidImg(function(t){var a=/(\d+)x(\d+)/.exec(p);t.width<a[1]&&t.height<a[2]&&e(!1),(s.onQ30Img||s.onBigImg)(function(t){e(t.width>=c)})})}),s.onHasZoom(function(e){"pad"!=r.deviceType&&r._setZoom(e?s:null)})}},"hideZoomer":function(){y(function(e){e.hide()},2)},"_setZoom":function(e){u&&a.remove(o,"mouseenter",u),y(function(e){e&&e.end()},2),m&&t.hide(m),e&&(m||(m=t.create("<span class='zoomIcon'>&#xf012c;</span>"),t.insertBefore(m,o)),t.show(m),a.on(o,"mouseenter",u=function(i){u&&(a.remove(o,"mouseenter",u),u=null),y(),e.onBigImg(function(a){y(function(n){n&&(m&&t.show(m),n.set("imageSrc",e.src+p),n.set("bigImageSrc",a.src),n.set("bigImageWidth",a.width),n.set("bigImageHeight",a.height),n.start(),n.show(i),codeTrack("mod.gallery.zoomshow","mod.gallery.init"))})})}))},"_gestureRecognition":function(e,t,i){var n=this;a.on(e,"touchstart",function(e){n.startX=e.changedTouches[0].clientX,n.startY=e.changedTouches[0].clientY,n.startTime=new Date-0}),a.on(e,"touchend",function(e){if(n.touching){var a=e.changedTouches[0].clientX,o=a<n.startX,r=new Date-n.startTime;o?i(r):t(r)}}),a.on(e,"touchmove",function(e){if(!(e.touches.length>1)){var t=e.changedTouches[0].clientX,a=t-n.startX,i=e.changedTouches[0].clientY;if(!(Math.abs(n.startY-i)>Math.abs(a))){e.preventDefault(),n.touching=!0}}})},"changeFrom":function(e,a){for(var i=this,n=t.get("#J_UlThumb"),o="",r=0,l=0;l<e.length;l++)o+='<li><a><img src="'+e[l]+'_60x60q90.jpg"></a></li>';t.html(n,o);var s=t.query("li",n);!a&&i.switchTo(s[r]),i.reset(),i.slideEvent("update")},"slideEvent":function(e){var i=t.get(".tb-thumb-warp #J_UlThumb"),n=t.get(".tb-thumb-warp .tb-thumb-left"),o=t.get(".tb-thumb-warp .tb-thumb-right"),r=t.get(".tb-thumb-warp.tb-thumb-btns-shown"),l=function(e){var a=t.children(i);if("left"===e)b--;else if("right"===e)b++;else{var r=t.index(a,t.get(".tb-selected",i));b=r+1-5>0?r+1-5:0}b<=0?(b=0,t.addClass(n,"disabled")):t.removeClass(n,"disabled"),b>0&&b>=a.length-5?(b=a.length-5,t.addClass(o,"disabled")):t.removeClass(o,"disabled"),t.style(i,{"left":-76*b})};if(r&&!v&&(v=!0,l("init"),a.on(n,"click",function(e){if(e.preventDefault(),t.hasClass(n,"disabled"))return!1;l("left")}),a.on(o,"click",function(e){if(e.preventDefault(),t.hasClass(o,"disabled"))return!1;l("right")})),e&&"update"===e){var i=t.get(".tb-thumb-warp #J_UlThumb");t.children(i).length>6?(t.addClass(t.get(".tb-thumb-warp"),"tb-thumb-btns-shown"),t.style(i,{"left":0}),b=0,l()):(t.removeClass(t.get(".tb-thumb-warp"),"tb-thumb-btns-shown"),t.style(i,{"left":0}),b=0,l())}}}},{"requires":["dom","event","malldetail/common/util"]});KISSY.add("malldetail/view/main",function(e){var t;return{"initView":function(t,a,i,n){var o=this;o.init(e.mix({"el":t},a)),n(o)},"onMainBody":function(){var a=arguments,i=this;i.onMainBody==i.onMainBody&&(i.onMainBody=TShop.createLoader(function(a){e.use("malldetail/other/mainBody",function(e,i){var n=t.product,o={"daily":g_config.isDaily,"list":{"scoreLoader":function(e){n.onChange("reviewCount",e)}},"width":t&&t.reviewWidth,"hasUserLink":!g_config.offlineShop};n.onLoad(["visitStat","samplingVisit"],function(t,r){function s(t){e.use("event",function(e,a){a.delegate(t,"click","img",function(a){var i=a.target;i.src&&e.use("dom",function(e,a){var n=a.parent(i,"a");if(n&&n.href){var o=a.parent(i,t);TShop.sendAtpanel("tmalldetail.49.2",{"loadedTime":0,"clickTime":e.now()-g_config.startTime,"imgTop":a.offset(i).top,"blockTop":a.offset(o).top,"blockId":o.id,"imgUrl":encodeURIComponent(i.src),"linkUrl":encodeURIComponent(n.href)})}})})})}i.init({"reviewConfig":o,"onDescReady":function(e){t&&(t.pageStatus=2|t.pageStatus),r%1e3==0&&s(e)},"onComboListReady":function(t){t||e.use("dom",function(e,t){var a=t.get("#page");a&&t.removeClass(a,"tm-style-detail")})},"product":n}),r%1e3==0&&(s("#J_DcTopRight"),s("#J_DcBottomRight")),a(i)})})}),i.onMainBody.apply(i,a))},"init":function(a){function i(){return 1===Math.ceil(100*Math.random())}function n(e){var t;return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0]}function o(t){for(var a=t.getEntries(),r=lastRecordIndex,s=a;r<s;r++)if(i()){var l=a[c];-1===e.indexOf(l.name,"performance.entry")&&codeTrack("performance.entry","performance.entries",{"group":n(l.name),"msg":l.name})}setTimeout(function(){o(t)},3e3)}codeTrack("view.main.init","app.init"),t=a=a||{};var r=this,s=a.product,l=l||g_config.assetsHost||"//assets.alicdn.com";s.onLoad("config",function(t){t.newSkuRight&&t.isTmallComboSupport&&t.detail.showRightRecommend&&!/standard=1/.test(window.location.search)&&e.use("dom",function(e,t){var a=t.get("#page");!!a&&!t.hasClass(a,"tm-style-detail")&&t.addClass(a,"tm-style-detail")})}),s.onLoad("itemDO",function(t){function a(){var t="cundingtian",a="#J_dingtian",i="ctlidi",n="#J_lidi";e.use("dom,ajax",function(e,o,r){o.height(a)>0&&new r({"url":"//fragment.tmall.com/act/"+t,"dataType":"jsonp","jsonpCallback":t,"data":{"wh_callback":!0},"success":function(e){e&&e.append&&o.html(a,e.append)},"error":function(){}}),o.height(n)>0&&new r({"url":"//fragment.tmall.com/act/"+i,"dataType":"jsonp","jsonpCallback":i,"data":{"wh_callback":!0},"success":function(e){e&&e.append&&o.html(n,e.append)},"error":function(){}})})}var i=e.unparam(window.location.search.substring(1));if(i&&i.tmc_channel&&"cuntao"==i.tmc_channel)return void a();e.use("dom,json",function(e,a,i){var n=a.get(".C_zhongting");if(n){var o=n.innerHTML;o=i.parse(o);for(var r=t.rootCatId,s=0,l=o.length;s<l;s++){var c=o[s];if(r==c.categoryId){var d="<a target='_blank' href='"+c.imgLink+"'><img width='790' height='120' src='"+c.imgUrl+"' /></a>";a.append(a.create(d),a.get("#mall-banner").children[0])}}}})});var c=0;e.ready(function(){var e=window.performance;i()&&e&&"function"==typeof e.getEntries&&(codeTrack("performance.entries"),o(e))}),e.use("malldetail/sku/main,malldetail/sku/metaLeft,dom",function(e,t,i,n){TShop.afterWinLoad(function(){TB&&TB.Global&&TB.Global.fire&&TB.Global.fire("mainReady"),s.onLoad("model",function(e){var t=e.doubleEleven2014;if(t){if(t.showAtmosphere){n.viewportWidth()>=1336&&n.addClass("#content","doubleEleven")}}})});var o=navigator.userAgent;/iPad/i.test(o)&&!/T-UA/i.test(o)&&e.ready(function(){var e=n.create('<div class="j-mdv" mdv-cls="malldetail/view/tmsBlock" mdv-cfg="{tmsId:\'rgn/main/2014/ipad/banner\',base:\'root\'}"></div>');n.insertBefore(e,n.get("#site-nav")),TShop.onMdv(function(t){t.addElement(e)})}),s.onLoad(["config","visitStat","serverStartTime","deviceType","internationalComponent"],function(o,c,d,u,m){o.isTripUser&&(o.isAliTripHK?n.addClass("html","detail-trip-hk"):n.addClass("html","detail-trip")),t.init({"onBuyEnable":function(){c&&(c.pageStatus=1|c.pageStatus)},"onReviewClick":n.get("#J_Reviews")&&function(){r.onMainBody(function(e){e.switchTab("J_Reviews")})},"onSellCountClick":n.get("#J_DealRecord")&&function(){r.onMainBody(function(e){e.switchTab("J_DealRecord")})},"config":o,"product":s}),TShop.onMdv(function(t){t.onModInit("shop/dc/global/",function(t){s.onLoad("itemDO",function(a){e.mix(t.cfg,{"dataUrl":o.api.fetchDcUrl,"isNew":64&g_config.bizTag,"isTwView":o.isTwView||o.isWorldView,"cdn75":o.detail.cdn75,"wangpuControl":TShop.afterWinLoad,"onRender":function(t){e.each(n.query(".J_WangWang",t),function(e){n.attr(e,{"data-item":a.itemId,"data-items":a.itemId})}),e.each(n.query("a",t),function(t){var i=t.href;if(/(getcid\.aw|www\.taobao\.com\/webww)/.test(i)){if(-1!==i.indexOf("www.taobao.com/webww")&&(i+="&itemId="+a.itemId),!/fromid=\w+/.test(i)){var n=i.split("?",2),o=e.unparam(n[1]);o.fromid||(o.fromid="cntaobao",s.onLoad(["userInfo"],function(e){e&&e.nicker&&(o.fromid+=e.nicker)})),i=n[0]+"?"+e.param(o)}t.href=i}}),e.use("malldetail/other/videox",function(e,t){t.replaceFlash()})},"onWangpuRender":function(t){e.mix(t,{"pageType":"tmalldetail","assetsHost":l,"isvParams":{"nickName":a.sellerNickName,"userId":a.userId,"shopId":"","itemId":"","itemNumId":a.itemId,"shopStats":a.feature,"validatorUrl":a.validatorUrl,"templateName":a.templateName,"templateId":a.templateId},"mod":n.get("#content")})}})})}),t.onModCallback("shop/dc/global/",function(e){e.onData(function(){s.onLoad("visitStat",function(e){e&&(e.pageStatus=4|e.pageStatus)}),s.onLoad("token",function(e){var t=n.get("#J_TokenField");t||(t=n.create('<input id="J_TokenField" type="hidden"/>'),t.value=e,(n.get("#J_FrmBid")||document.body).appendChild(t))})},0)})},0);var p=n.get("#J_DcHd")||n.get("#hd");p&&TShop.onMdv(function(e){e.addElement(p,"shop/dc/header/",{})}),i.init({"product":s}),TShop.afterWinLoad(function(){function t(){r.onMainBody()}!1!==a.loadDc&&o.api.fetchDcUrl?256&g_config.bizTag||512&g_config.bizTag?(codeTrack("external.brandsite.init","view.main.init"),e.use("malldetail/common/util",function(e,t){t.loadAssets("apps/tmall/brandsite/1.0/core.js?"+g_config.t,function(){codeTrack("external.brandsite.run","external.brandsite.init"),window.TBS&&window.TBS.initWidget(),codeTrack("external.brandsite.runSuccess","external.brandsite.run")})})):TShop.onMdv(function(t){t.addElement("#J_DcShopArchive","shop/dc/headArchive/",{"isShowEcityIcon":o.tag&&o.tag.isShowEcityIcon,"isShowHouseIcon":o.tag&&o.tag.isShowHouseIcon,"isShowYuanchuanIcon":o.tag&&o.tag.isShowYuanchuanIcon,"isShowRates":"Miao"!=o.detail.pageType,"internationalComponent":m,"certBrandList":o.certBrandList,"certShopList":o.certShopList,"onRates":function(e){s.onLoad("dsr",e)},"onRender":function(){e.use("malldetail/other/init",function(e,t){t.initFollow()})}}),t.addElement("#J_DcLeft","shop/dc/left/",{}),t.addElement("#J_DcTopRight","shop/dc/topRight/",{}),t.addElement("#J_DcBottomRight","shop/dc/bottomRight/",{}),t.addElement("#J_DcFt","shop/dc/footer/",{})}):(codeTrack("dc.not.init","view.main.init"),e.use("malldetail/other/init",function(e,t){t.initFollow()}),e.use("malldetail/other/updateDc",function(e,t){s.onLoad(["config"],function(e){e&&e.api&&e.api.validateDcReleaseTimeUrl&&t.init(e.api.validateDcReleaseTimeUrl,e.releaseTime,e.api.validateDcUrl)})})),!1===a.loadHead||o.detail.isVitual3C||o.detail.isHkDirectSale||TShop.onMdv(function(e){e.addElement("#header","shop/head/main/",{"itemId":g_config.itemId,"shopUrl":g_config.shopUrl,"isInitDialog":"tmall"==window.g_config.pageType,"shopId":g_config.shopId,"sellerId":g_config.sellerId,"wtId":g_config.wtId,"showQrcode":g_config.showShopQrcode&&!o.isTripUser&&!(o.detail&&"Miao"===o.detail.pageType),"suggestControl":TShop.afterWinLoad,"time":d,"onLogin":TShop.onLogin,"onToken":function(e){s.onLoad("token",e)},"onShopData":function(e){TShop.onProduct(function(t){t.onLoad(["shopDynamicRating","itemDO"],function(t,a){var i="SM_368_dsr-"+a.userId;if(t&&t[i]!==undefined)return e(t[i]);e(null)})})}})});var i=TShop.getUrlParams(),l=i.selected||(1==i.on_comment?"reviews":"");l&&r.onMainBody(function(e){e.switchTab(l)});var u=n.get("#detail");if(u){for(u=u.nextSibling;u;u=u.nextSibling)1==u.nodeType&&TShop.addLazyCallback(u,t);o.isWorldView&&e.use("malldetail/other/bannerNav",function(e,t){t.init()})}e.use("malldetail/other/init",function(e,t){t.init({"showBacktop":o.detail&&o.detail.showBacktop&&!(16384&g_config.bizTag),"loadDc":!1!==a.loadDc,"dialogTrigger":!1===a.loadDc||64&g_config.bizTag,"onDcSuccess":function(){c&&(c.pageStatus=4|c.pageStatus)},"config":o,"product":s})});var p={};o&&(p=o.detail)&&p.enableAliMedicalComponent&&(p.isPrescriptionDrug||p.isOtcDrug)&&(p.isRx2||-1!=location.href.indexOf("alijktest")?e.getScript("//g.alicdn.com/alijk/prescription-drug-cart/0.0.5/seed.js",function(){e.use("alijk/prescription-drug-cart/index",function(e,t){t.init("#J_LinkBuy")})}):e.getScript("//g.alicdn.com/alijk/prescription-drug-cart/0.0.3/seed.js",function(){e.use("alijk/prescription-drug-cart/index",function(e,t){t.init("#J_LinkBuy")})}))})})})}}},{"requires":[]});KISSY.add("malldetail/sku/padadapte",function(e,t,a){return{"init":function(i){var n=(i.product,i.config,this);n.skuEl=i.el;var o=t.query(".tm-sale-prop",n.skuEl);if(o&&o.length>0){var r="\u67e5\u770b";e.each(o,function(e,a){var i=r;if(i+=a<1?t.text(t.get(".tb-metatit",e)):"\u3001"+t.text(t.get(".tb-metatit",e)),i.length>7)return 0===a?r=i:r+="...",!1;r=i}),t.prepend(t.create('<div class="tm-prop-btn"> '+r+"<i>&#xe61a;</i></div>"),n.skuEl),n.propBtnEl=t.get(".tm-prop-btn",n.skuEl),a.on(n.propBtnEl,"tap click",function(e){e.halt(),t.hasClass(n.skuEl,"prop-unfold")?n.fold():n.unfold()})}n.serviceEl=t.get(".tm-ser","#detail"),t.insertAfter(n.serviceEl,t.get(".tm-ind-panel","#detail")),n.tmActionEl=t.get(".tm-action","#detail"),t.append(n.tmActionEl,n.skuEl)},"fold":function(){var e=this;t.removeClass(e.skuEl,"prop-unfold")},"unfold":function(){var e=this;t.addClass(e.skuEl,"prop-unfold")},"isAllSeceted":function(e){return!0}}},{"requires":["dom","event"]});KISSY.add("malldetail/recommend/skuRight",function(e,t,a,i){var n,o,r,l,c,s,d,u,m,p,f,h=12;return{"onData":function(t){e.use("ajax",function(e,a){n.onLoad(["config","itemDO","fasePushConfig","userInfo"],function(i,n,r,l){m=i.detail.isVitual3C||!1,f=i.detail.pageType,p="Miao"===f;var s=c.aldInterface?c.aldInterface:"//aldcdn.tmall.com/recommend.htm",d={};c.wfCode&&(d={"wfCode":c.wfCode});var u=e.merge({"itemId":n.itemId,"categoryId":n.categoryId,"sellerId":n.userId,"shopId":i.rstShopId,"brandId":n.brandId,"refer":document.referrer,"brandSiteId":n.brandSiteId||"","rn":TShop.getUrlParams("rn")||"","appId":o,"isVitual3C":m,"isMiao":p,"count":h},d);if(i.detail&&i.detail.site_en){var v=i.detail.site_en;u.currency=v,u.site=v}if("Miao"==f&&(u.tag="22978"),r&&l&&r.aldRule){var g=r.aldRule.min,b=r.aldRule.max,y=r.aldRule.mod?r.aldRule.mod:100,k=l.userId%y;k>=g&&k<=b&&(s="//ald.taobao.com/recommend.htm")}(i.isTwView||i.isWorldView)&&(u.filterTw=1),a({"url":s,"dataType":"jsonp","data":u,"cache":!0,"jsonpCallback":"jsonpAld"+o,"success":t})})})},"render":function(o){n.onLoad("config",function(n){function s(i){a.remove(g,"click",s),e.use("switchable",function(e,a){var n=new a.Carousel(t.get(".ald-carousel",u),{"contentCls":"ald-switchable-content","triggerCls":"ald-switchable-trigger","effect":"scrolly","circular":!0,"hasTriggers":!1,"prevBtnCls":"ald-switchable-prev-btn","nextBtnCls":"ald-switchable-next-btn","disableBtnCls":"ald-switchable-disable-btn","easing":"easeOutStrong","viewSize":[d.maxItemLen*(d.showTitle&&f?180:160)],"lazyDataType":"img-src","steps":d.maxItemLen});t.hasClass(i.target,"ald-switchable-prev-btn")?n.prev():n.next()})}var d=r[o],u=c.el,f=e.UA.ie&&6==e.UA.ie;if(d.index=o,c.brandSiteId)for(var h=0;h<d.list.length;h++)d.list[h].url=d.list[h].url.replace(/item\.htm/,"brand.htm")+"&brandSiteId="+c.params.brandSiteId;for(var h=0;h<d.list.length;h++)d.list[h].img&&!/^http:/.test(d.list[h].img)&&(d.list[h].img="//img-tmdetail.alicdn.com/bao/uploaded/"+d.list[h].img),d.list[h].price&&(d.list[h].price=Number(d.list[h].price).toFixed(2)),d.list[h].marketPrice&&(d.list[h].marketPrice=Number(d.list[h].marketPrice).toFixed(2));d.config=c,d.currency2=n.detail.currency||"\xa5";var v='<div class="ald-inner {{#if showTitle && !ie6}}ald-showTitle{{/if}}"> \t\t\t\t\t\t<div class="ald-hd {{#if config.isVitual3C}}tm-3c-recTitle{{/if}}">\t\t\t\t\t\t\t{{#if (names && names.length>1)}}\t\t\t\t\t\t\t\t{{#each names}}<span data-index="{{_ks_index}}" class="ald-tab{{#if (_ks_index==index)}} ald-tab-current{{/if}}">{{_ks_value}}</span>{{/each}}\t\t\t\t\t\t\t{{#elseif (configType=="def")}}\t\t\t\t\t\t\t\t<s></s><span>{{config.label||"\u770b\u4e86\u53c8\u770b"}}</span>\t\t\t\t\t\t\t{{#else}}\t\t\t\t\t\t\t\t\u76f8\u5173\u4ea7\u54c1\t\t\t\t\t\t\t{{/if}}</div>\t\t\t\t\t\t<div class="ald-carousel"><div class="wrapCon"><ul class="ald-switchable-content{{#if showTitle}} showTitle{{/if}}"> \t\t\t\t\t\t\t{{#each list}}<li> \t\t\t\t\t\t\t\t<div class="img">\t\t\t\t\t\t\t\t<a class="ALDCLS-act" tabindex="-1" title="{{#if _ks_value.spuTitle}}{{_ks_value.spuTitle}}{{#else}}{{_ks_value.title}}{{/if}}" href="{{#if _ks_value.entityType=="ACTIVITY"}}{{_ks_value.actUrl}}{{#else}}{{_ks_value.url||_ks_value.link||"javascript:void(0)"}}{{#if config.isVitual3C}}&refType=3c{{/if}}{{/if}}" target="_blank">\t\t\t\t\t\t\t\t<img {{#if _ks_index<maxItemLen}}src{{#else}}data-ks-lazyload-custom{{/if}}="{{#if _ks_value.entityType=="ACTIVITY"}}{{_ks_value.actImg}}{{#else}}{{_ks_value.img}}{{/if}}_{{#if configType=="def"}}160x160{{#else}}160x160{{/if}}q90.jpg"/>\t\t\t\t\t\t\t\t</a>\t\t\t\t\t\t\t\t{{#if _ks_value.propValue}}<p class="cover_mask">{{_ks_value.propValue}}</p>{{/if}}\t\t\t\t\t\t\t\t{{#if _ks_value.price||_ks_value.marketPrice}}                                    <p class="look_price">{{currency2}}{{_ks_value.price||_ks_value.marketPrice}}                                    {{#if _ks_value.activityTag}}\t\t\t\t\t\t\t\t\t<img class="act-tag" src="{{_ks_value.icon}}" />\t\t\t\t\t\t\t\t     {{/if}}                                    </p>                                {{/if}}\t\t\t\t\t\t\t\t{{#if _ks_value.activityTag}}\t\t\t\t\t\t\t\t{{#elseif _ks_value.isDacu}}\t\t\t\t\t\t\t\t\t<i class="green tm-tag"><b>\u5e74\u4e2d\u5927\u4fc3</b></i>\t\t\t\t\t\t\t\t{{#elseif _ks_value.isContract}}\t\t\t\t\t\t\t\t\t<i class="blue tm-tag"><b>\u9001<br/>\u8bdd\u8d39</b></i>\t\t\t\t\t\t\t\t{{#elseif _ks_value.isnew || _ks_value.isNew}}\t\t\t\t\t\t\t\t\t<i class="green tm-tag"><b class="single">NEW</b></i>\t\t\t\t\t\t\t\t{{/if}}                                {{#if showBuyCart}}<button class="j_AddCart ui-cart icon-detail-font" data-itemid="{{_ks_value.itemId}}" data-pic="{{_ks_value.img}}_40x40q50.jpg">&#xe613;</button>{{/if}}\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t{{#if showTitle}}<p class="look_title"><a class="ALDCLS-act" href="{{#if _ks_value.entityType=="ACTIVITY"}}{{_ks_value.actUrl}}{{#else}}{{_ks_value.url||_ks_value.link||"javascript:void(0)"}}{{/if}}" target="_blank">{{#if _ks_value.spuTitle}}{{_ks_value.spuTitle}}{{#else}}{{_ks_value.title}}{{/if}}</a></p>{{/if}}\t\t\t\t\t\t\t</li>{{/each}}\t\t\t\t\t\t\t</ul></div>\t\t\t\t\t\t\t{{#if (list && list.length>maxItemLen)}}<ul class="ald-switchable-trigger">\t\t\t\t\t\t\t\t<li class="ald-switchable-prev-btn">\u4e0a\u4e00\u4e2a</li>\t\t\t\t\t\t\t\t<li class="ald-switchable-next-btn">\u4e0b\u4e00\u4e2a</li>\t\t\t\t\t\t\t</ul>{{/if}}\t\t\t\t\t\t</div>{{config.footer}}</div>';e.mix(d,c),e.mix(d,{"names":l,"ie6":f}),m?(d.config.isVitual3C=!0,d.config.label="\u7535\u5668\u57ce\u63a8\u8350"):p&&(d.config.label="\u55b5\u9c9c\u751f\u63a8\u8350");var g;if(d.maxItemLen=3,!0===c.newSkuRight&&(d.maxItemLen=5),d.list&&d.list.length%d.maxItemLen!=0){var b=d.maxItemLen-d.list.length%d.maxItemLen;d.list=d.list.concat(d.list.slice(0,b))}var y=t.create(i(v).render(d));t.append(y,u),y=null,d.acurl&&(TShop.sendImg(d.acurl),delete d.acurl),g=t.get(".ald-switchable-trigger",u),a.on(g,"click",s)})},"renderCloseSlide":function(i){var n=t.create("<div class='ald-skuRight-btn'><s></s>"+(16384&g_config.bizTag?"\u55b5\u9c9c\u751f\u63a8\u8350":"\u770b\u4e86\u53c8\u770b")+"</div>"),o=this,r="ald-skuRight-open";t.append(n,i.el),a.on(i.el,"mouseenter",function(){u&&u.cancel(),u=e.later(function(){d||(t.addClass(i.el,r),o._onData()),d=!d},1e3)}),a.on(i.el,"mouseleave",function(){u&&u.cancel(),d&&(t.removeClass(i.el,r),d=!d)})},"_onData":function(){var i=this;s||(s=!0,i.onData(function(n){if(n){if(r=[],l=[],n.list&&n.list.length&&(r.push(n),n.acurl&&TShop.sendImg(n.acurl),l.push("")),n.list&&n.list.length<1){var o=t.get("html");!0!==g_config.isMarket&&(t.removeClass(o,"w1190"),t.addClass(o,"w990"))}n[0]&&n[0].list&&n[0].list.length&&(r.push(n[0]),n[1]&&n[1].acurl&&TShop.sendImg(n[1].acurl),l.push("")),n.a&&n.a.list&&n.a.list.length&&(r.push(n.a),l.push(n.a.name.replace("\u63a8\u8350",""))),n.b&&n.b.list&&n.b.list.length&&(r.push(n.b),l.push(n.b.name.replace("\u63a8\u8350",""))),r.length&&(e.each(r,function(e){TShop.aldPreprocess(e.list)}),i.render(0),codeTrack("recomm.skuRight.show","recomm.skuRight.init"),r.length>1&&a.delegate(c.el,"click",".ald-tab",function(e){i.render(t.attr(e.target,"data-index"))}))}}))},"init":function(e){c=e||{};var t=this;o=c.appId||"03054",c.pw=window.g_config.pw,n=c.product,codeTrack("recomm.skuRight.init","mod.other.init"),c.onData&&(t.onData=c.onData),n.onLoad("config",function(a){c.newSkuRight=a.newSkuRight&&a.isTmallComboSupport&&a.detail.showRightRecommend&&!/standard=1/.test(window.location.search),!0===c.newSkuRight&&(h=15),"990"==c.pw?t.renderCloseSlide(e):t._onData()})}}},{"requires":["dom","event","malldetail/common/template"]});KISSY.add("shop/dc/global/index",function(e,t){function a(e,t){var a=/(<img[^>]*)((src|data\-ks\-lazyload)\s*=\s*("[^"]*"|'[^']*'|[^ >]*))/g,n=t||"_q75.jpg";return e=e.replace(a,function(e){var t=e;if(/img0[1-4]\.taobaocdn\.com/.test(e)||/gdz0[1-4]\.md\.alicdn\.com/.test(e)){var a=/data\-ks\-lazyload/.test(e),i=/(src|data\-ks\-lazyload)\s*=\s*("[^"]*"|'[^']*')/g;t=e.replace(i,function(e,t,i){function r(){var e=o.length,t=o.substr(e-1);/\d+x\d+\./.test(i)?o=i.replace(/(\d+x\d+)/,"$1q75"):"'"==t||'"'==t?o=o.substr(0,e-1)+n+t:o+=n}var s=e,o=i;return a&&!/data\-ks\-lazyload/.test(e)||(r(),s=e.replace(i,o)),s})}return t})}var n;return{"init":function(a){n=a||{};var i=this;_CTKa87f(31,"dc.mod.init","app.init"),i.onData=i.createLoader(function(t){_CTKa87f(31,"mod.dc.data","dc.mod.init"),e.getScript((n.dataUrl||"//hdc1.alicdn.com/asyn.htm?userId="+n.userId)+(n.isTwView?"&_thwlang=zh_CN:TB-GBK":""),{"timeout":10,"success":function(){_CTKa87f(31,"mod.dc.dataSuccess","mod.dc.data"),t(window.SHOP_DC||null)},"error":function(){_CTKa87f(31,"mod.dc.dataError","mod.dc.data"),t(null)}})}),i.onWangpu=i.createLoader(function(t){var i=a.suggestControl||function(e){e()};i(function(){e.use("shop/dc/global/wangpu",function(e,a){a.init(n,t)})})}),i.onData(function(a){a.oldGlobalCssUrl&&(t.addStyleSheet("#shopExtra #shop-info {width: 132px;margin:0;}.w1190 #content #bd {width: 1190px!important;}"),e.getScript(a.oldGlobalCssUrl)),a.styleCode&&t.addStyleSheet(a.styleCode)},0)},"html":function(e,i,r){var s=this;if(i=i.replace(/_\.webp\b/gi,""),n.cdn75&&(i=a(i)),r){var o=t.create(i),l=t.parent(e);t.insertBefore(o,e,!0),t.remove(e),e=o.parentNode?o:t.get(".tb-shop",l)}else t.html(e,i);return s.render(e),e},"render":function(e){var t=this;n.onRender&&n.onRender(e),window.Light&&window.Light.light(e),t.onDatalazyload(function(t){t.addElements(e)}),t.onWangpu(function(t){t.initEl(e)})},"initView":function(e,t,a,n){var i=this;i.createLoader=a.createLoader,i.onDatalazyload=a.onDatalazyload,i.init(t),n(i)}}},{"requires":["dom","shop/dc/global/index.css"]});KISSY.add("shop/dc/header/index",function(e,t){return{"initView":function(a,n,i,r){var s=this;i.onModCallback("shop/dc/global/",function(n){return t.test(a,"#hd")?n.render(a):void n.onData(function(i){var r=i&&i.header;r?(_CTKa87f(31,"dc.header.init","dc.mod.init"),a=n.html(a,r,!0),e.each(t.query("img",a),function(e){var a=t.attr(e,"data-ks-lazyload");a&&(t.attr(e,"src",a),t.removeAttr(e,"data-ks-lazyload"))}),6==e.UA.ie&&t.height(a)>150&&t.height(a,150),_CTKa87f(31,"dc.header.show","dc.header.init")):t.hide(a)})}),r(s)}}},{"requires":["dom"]});