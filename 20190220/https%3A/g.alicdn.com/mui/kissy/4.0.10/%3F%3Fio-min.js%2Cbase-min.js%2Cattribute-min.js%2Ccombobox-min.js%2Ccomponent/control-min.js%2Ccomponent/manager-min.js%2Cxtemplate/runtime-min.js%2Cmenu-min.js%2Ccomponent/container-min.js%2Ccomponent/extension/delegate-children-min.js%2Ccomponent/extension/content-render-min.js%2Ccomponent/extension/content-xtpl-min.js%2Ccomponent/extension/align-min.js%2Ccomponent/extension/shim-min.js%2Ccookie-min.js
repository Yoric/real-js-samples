KISSY.add("io/form-serializer",["dom"],function(e,t){var n=t("dom");var r=/^(?:select|textarea)/i,i=/\r?\n/g,a,o=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;function s(e){return e.replace(i,"\r\n")}a={serialize:function(t,n){return e.param(a.getFormData(t),undefined,undefined,n||false)},getFormData:function(t){var i=[],a={};e.each(n.query(t),function(t){var n=t.elements?e.makeArray(t.elements):[t];i.push.apply(i,n)});i=e.filter(i,function(e){return e.name&&!e.disabled&&(e.checked||r.test(e.nodeName)||o.test(e.type))});e.each(i,function(t){var r=n.val(t),i;if(r===null){return}if(e.isArray(r)){r=e.map(r,s)}else{r=s(r)}i=a[t.name];if(i===undefined){a[t.name]=r;return}if(!e.isArray(i)){i=a[t.name]=[i]}i.push.apply(i,e.makeArray(r))});return a}};return a});KISSY.add("io/base",["event/custom","promise"],function(e,t){var n=t("event/custom"),r=t("promise");var i=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,a=/\s+/,o=function(e){return e},s=/^(?:GET|HEAD)$/,l=e.Env.host,u=l.location||{},d=new e.Uri(u.href),f=d&&i.test(d.getScheme()),c={},p={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:true,serializeArray:true,processData:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},converters:{text:{json:e.parseJson,html:o,text:o,xml:e.parseXML}},headers:{"X-Requested-With":"XMLHttpRequest"},contents:{xml:/xml/,html:/html/,json:/json/}};p.converters.html=p.converters.text;function h(t){var n=t.context;delete t.context;t=e.mix(e.clone(p),t,{deep:true});t.context=n||t;var r,i,o=t.type,l=t.dataType;i=t.uri=d.resolve(t.url);t.uri.setQuery("");if(!("crossDomain"in t)){t.crossDomain=!t.uri.isSameOriginAs(d)}o=t.type=o.toUpperCase();t.hasContent=!s.test(o);if(t.processData&&(r=t.data)&&typeof r!=="string"){t.data=e.param(r,undefined,undefined,t.serializeArray)}l=t.dataType=e.trim(l||"*").split(a);if(!("cache"in t)&&e.inArray(l[0],["script","jsonp"])){t.cache=false}if(!t.hasContent){if(t.data){i.query.add(e.unparam(t.data))}if(t.cache===false){i.query.set("_ksTS",e.now()+"_"+e.guid())}}return t}function m(t){var n=this;if(!(n instanceof m)){return new m(t)}r.call(n);t=h(t);e.mix(n,{responseData:null,config:t||{},timeoutTimer:null,responseText:null,responseXML:null,responseHeadersString:"",responseHeaders:null,requestHeaders:{},readyState:0,state:0,statusText:null,status:0,transport:null});r.Defer(n);var i,a;m.fire("start",{ajaxConfig:t,io:n});i=c[t.dataType[0]]||c["*"];a=new i(n);n.transport=a;if(t.contentType){n.setRequestHeader("Content-Type",t.contentType)}var o=t.dataType[0],s,l=t.timeout,u=t.context,d=t.headers,f=t.accepts;n.setRequestHeader("Accept",o&&f[o]?f[o]+(o==="*"?"":", */*; q=0.01"):f["*"]);for(s in d){n.setRequestHeader(s,d[s])}if(t.beforeSend&&t.beforeSend.call(u,n,t)===false){return n}n.readyState=1;m.fire("send",{ajaxConfig:t,io:n});if(t.async&&l>0){n.timeoutTimer=setTimeout(function(){n.abort("timeout")},l*1e3)}try{n.state=1;a.send()}catch(p){if(n.state<2){e.log(p.stack||p,"error");if(""){setTimeout(function(){throw p},0)}n._ioReady(-1,p.message||"send error")}else{e.error(p)}}return n}e.mix(m,n.Target);e.mix(m,{isLocal:f,setupConfig:function(t){e.mix(p,t,{deep:true})},setupTransport:function(e,t){c[e]=t},getTransport:function(e){return c[e]},getConfig:function(){return p}});return m});KISSY.add("io/xhr-transport-base",["./base"],function(e,t){var n=t("./base");var r=e.getLogger("s/io");var i=200,a=e.Env.host,o=e.UA.ieMode>7&&a.XDomainRequest,s=204,l=404,u=1223,d={proto:{}},f={},c={};n.__lastModifiedCached=f;n.__eTagCached=c;function p(e,t){try{return new(t||a).XMLHttpRequest}catch(n){}return undefined}function h(e,t){try{return new(t||a).ActiveXObject("Microsoft.XMLHTTP")}catch(n){}return undefined}d.nativeXhr=a.ActiveXObject?function(e,t){if(!m&&e&&o){return new o}return!n.isLocal&&p(e,t)||h(e,t)}:p;d.XDomainRequest_=o;var m=d.supportCORS="withCredentials"in d.nativeXhr();function g(e){return o&&e instanceof o}function v(e){var t=e.ifModified,n;if(t){n=e.uri;if(e.cache===false){n=n.clone();n.query.remove("_ksTS")}n=n.toString()}return n}e.mix(d.proto,{sendInternal:function(){var t=this,n=t.io,i=n.config,a=t.nativeXhr,o=i.files,s=o?"post":i.type,l=i.async,u,d=n.mimeType,p=n.requestHeaders||{},h=n._getUrlForSend(),b,T=v(i),_,N;if(T){if(_=f[T]){p["If-Modified-Since"]=_}if(_=c[T]){p["If-None-Match"]=_}}if(u=i.username){a.open(s,h,l,u,i.password)}else{a.open(s,h,l)}b=i.xhrFields||{};if("withCredentials"in b){if(!m){delete b.withCredentials}}for(N in b){try{a[N]=b[N]}catch(E){r.error(E)}}if(d&&a.overrideMimeType){a.overrideMimeType(d)}var y=p["X-Requested-With"];if(y===false){delete p["X-Requested-With"]}if(typeof a.setRequestHeader!=="undefined"){for(N in p){a.setRequestHeader(N,p[N])}}var S=i.hasContent&&i.data||null;if(o){var C=S,k={};if(C){k=e.unparam(C)}k=e.mix(k,o);S=new FormData;e.each(k,function(t,n){if(e.isArray(t)){e.each(t,function(e){S.append(n+(i.serializeArray?"[]":""),e)})}else{S.append(n,t)}})}a.send(S);if(!l||a.readyState===4){t._callback()}else{if(g(a)){a.onload=function(){a.readyState=4;a.status=200;t._callback()};a.onerror=function(){a.readyState=4;a.status=500;t._callback()}}else{a.onreadystatechange=function(){t._callback()}}}},abort:function(){this._callback(0,1)},_callback:function(t,a){var o=this,d=o.nativeXhr,p=o.io,h,m,b,T,_,N=p.config;try{if(a||d.readyState===4){if(g(d)){d.onerror=e.noop;d.onload=e.noop}else{d.onreadystatechange=e.noop}if(a){if(d.readyState!==4){d.abort()}}else{h=v(N);var E=d.status;if(!g(d)){p.responseHeadersString=d.getAllResponseHeaders()}if(h){m=d.getResponseHeader("Last-Modified");b=d.getResponseHeader("ETag");if(m){f[h]=m}if(b){c[b]=b}}_=d.responseXML;if(_&&_.documentElement){p.responseXML=_}var y=p.responseText=d.responseText;if(N.files&&y){var S,C;if((S=y.indexOf("<body>"))!==-1){C=y.lastIndexOf("</body>");if(C===-1){C=y.length}y=y.slice(S+6,C)}p.responseText=e.unEscapeHtml(y)}try{T=d.statusText}catch(k){r.error("xhr statusText error: ");r.error(k);T=""}if(!E&&n.isLocal&&!N.crossDomain){E=p.responseText?i:l}else{if(E===u){E=s}}p._ioReady(E,T)}}}catch(k){e.log(k.stack||k,"error");if(""){setTimeout(function(){throw k},0)}d.onreadystatechange=e.noop;if(!a){p._ioReady(-1,k.message||"process error")}}}});return d});KISSY.add("io/xdr-flash-transport",["./base","dom"],function(e,t){var n=t("./base"),r=t("dom");var i=e.getLogger("s/io");var a={},o="io_swf",s,l=e.Env.host.document,u=false;function d(e,t,n){if(u){return}u=true;var i='<object id="'+o+'" type="application/x-shockwave-flash" data="'+e+'" width="0" height="0">'+'<param name="movie" value="'+e+'" />'+'<param name="FlashVars" value="yid='+t+"&uid="+n+'&host=KISSY.IO" />'+'<param name="allowScriptAccess" value="always" />'+"</object>",a=l.createElement("div");r.prepend(a,l.body||l.documentElement);a.innerHTML=i}function f(e){i.info("use XdrFlashTransport for: "+e.config.url);this.io=e}e.augment(f,{send:function(){var t=this,n=t.io,r=n.config,i=r.xdr||{};d(i.src||e.Config.base+"io/assets/io.swf",1,1);if(!s){setTimeout(function(){t.send()},200);return}t._uid=e.guid();a[t._uid]=t;s.send(n._getUrlForSend(),{id:t._uid,uid:t._uid,method:r.type,data:r.hasContent&&r.data||{}})},abort:function(){s.abort(this._uid)},_xdrResponse:function(e,t){var n=this,r,i=t.id,o,s=t.c,l=n.io;if(s&&(o=s.responseText)){l.responseText=decodeURI(o)}switch(e){case"success":r={status:200,statusText:"success"};delete a[i];break;case"abort":delete a[i];break;case"timeout":;case"transport error":;case"failure":delete a[i];r={status:"status"in s?s.status:500,statusText:s.statusText||e};break}if(r){l._ioReady(r.status,r.statusText)}}});n.applyTo=function(t,r,i){var a=r.split(".").slice(1),o=n;e.each(a,function(e){o=o[e]});o.apply(null,i)};n.xdrReady=function(){s=l.getElementById(o)};n.xdrResponse=function(e,t){var n=a[t.uid];if(n){n._xdrResponse(e,t)}};return f});KISSY.add("io/sub-domain-transport",["event/dom","dom","./xhr-transport-base"],function(e,t){var n=t("event/dom"),r=t("dom"),i=t("./xhr-transport-base");var a=e.getLogger("s/io");var o="/sub_domain_proxy.html",s=e.Env.host.document,l={};function u(e){var t=this,n=e.config;t.io=e;n.crossDomain=false;a.info("use SubDomainTransport for: "+n.url)}e.augment(u,i.proto,{send:function(){var t=this,a=t.io.config,u=a.uri,f=u.getHostname(),c,p,h=l[f];var m=o;if(a.xdr&&a.xdr.subDomain&&a.xdr.subDomain.proxy){m=a.xdr.subDomain.proxy}if(h&&h.ready){t.nativeXhr=i.nativeXhr(0,h.iframe.contentWindow);if(t.nativeXhr){t.sendInternal()}else{e.error("document.domain not set correctly!")}return}if(!h){h=l[f]={};c=h.iframe=s.createElement("iframe");r.css(c,{position:"absolute",left:"-9999px",top:"-9999px"});r.prepend(c,s.body||s.documentElement);p=new e.Uri;p.setScheme(u.getScheme());p.setPort(u.getPort());p.setHostname(f);p.setPath(m);c.src=p.toString()}else{c=h.iframe}n.on(c,"load",d,t)}});function d(){var e=this,t=e.io.config,r=t.uri,i=r.getHostname(),a=l[i];a.ready=1;n.detach(a.iframe,"load",d,e);e.send()}return u});KISSY.add("io/xhr-transport",["./base","./xhr-transport-base","./xdr-flash-transport","./sub-domain-transport"],function(e,t){var n=t("./base"),r=t("./xhr-transport-base"),i=t("./xdr-flash-transport"),a=t("./sub-domain-transport");var o=e.getLogger("s/io");var s=e.Env.host,l=s.document,u=r.XDomainRequest_;function d(t){return l.domain&&e.endsWith(t,l.domain)}function f(e){var t=e.config,n=t.crossDomain,s=this,l,f=t.xdr||{},c=f.subDomain=f.subDomain||{};s.io=e;if(n&&!r.supportCORS){if(d(t.uri.getHostname())){if(c.proxy!==false){return new a(e)}}if(String(f.use)==="flash"||!u){return new i(e)}}l=s.nativeXhr=r.nativeXhr(n);var p="crossDomain: "+n+", use "+(u&&l instanceof u?"XDomainRequest":"XhrTransport")+" for: "+t.url;o.debug(p);return s}e.augment(f,r.proto,{send:function(){this.sendInternal()}});n.setupTransport("*",f);return n});KISSY.add("io/script-transport",["./base"],function(e,t){var n=t("./base");var r=e.getLogger("s/io");var i=200,a=500;n.setupConfig({accepts:{script:"text/javascript, "+"application/javascript, "+"application/ecmascript, "+"application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{text:{script:function(t){e.globalEval(t);return t}}}});function o(e){var t=e.config,i=this;if(!t.crossDomain){return new(n.getTransport("*"))(e)}i.io=e;r.info("use ScriptTransport for: "+t.url);return i}e.augment(o,{send:function(){var t=this,n=t.io,r=n.config;t.script=e.getScript(n._getUrlForSend(),{charset:r.scriptCharset,success:function(){t._callback("success")},error:function(){t._callback("error")}})},_callback:function(e,t){var n=this,r=n.script,o=n.io;if(!r){return}n.script=undefined;if(t){return}if(e!=="error"){o._ioReady(i,"success")}else{if(e==="error"){o._ioReady(a,"script error")}}},abort:function(){this._callback(0,1)}});n.setupTransport("script",o);return n});KISSY.add("io/jsonp",["./base"],function(e,t){var n=t("./base");var r=e.Env.host;n.setupConfig({jsonp:"callback",jsonpCallback:function(){return e.guid("jsonp")}});n.on("start",function(t){var n=t.io,i=n.config,a=i.dataType;if(a[0]==="jsonp"){delete i.contentType;var o,s=i.jsonpCallback,l,u=typeof s==="function"?s():s,d=r[u];i.uri.query.set(i.jsonp,u);r[u]=function(t){if(arguments.length>1){t=e.makeArray(arguments)}o=[t]};n.fin(function(){r[u]=d;if(d===undefined){try{delete r[u]}catch(e){}}else{if(o){d(o[0])}}});l=i.converters;l.script=l.script||{};l.script.json=function(){if(!o){throw new Error("not call jsonpCallback: "+u)}return o[0]};a.length=2;a[0]="script";a[1]="json"}});return n});KISSY.add("io/form",["./base","dom","./form-serializer"],function(e,t){var n=t("./base");var r=t("dom");var i=t("./form-serializer");var a=e.Env.host,o=Array.prototype.slice,s=a.FormData;n.on("start",function(t){var n=t.io,a,l,u,d,f,c=n.config,p=c.form;if(p){a=r.get(p);f=c.data;var h=false;var m={};var g=r.query("input",a);for(var v=0,b=g.length;v<b;v++){var T=g[v];if(T.type.toLowerCase()==="file"){h=true;if(!s){break}var _=o.call(T.files,0);m[r.attr(T,"name")]=_.length>1?_:_[0]||null}}if(h&&s){c.files=c.files||{};e.mix(c.files,m);delete c.contentType}if(!h||s){d=i.getFormData(a);if(c.hasContent){d=e.param(d,undefined,undefined,c.serializeArray);if(f){c.data+="&"+d}else{c.data=d}}else{c.uri.query.add(d)}}else{u=c.dataType;l=u[0];if(l==="*"){l="text"}u.length=2;u[0]="iframe";u[1]=l}}});return n});KISSY.add("io/iframe-transport",["dom","./base","event/dom"],function(e,t){var n=t("dom"),r=t("./base"),i=t("event/dom");var a=e.getLogger("s/io");var o=e.Env.host.document,s=200,l=500,u=30,d=e.clone(r.getConfig().converters.text);d.json=function(t){return e.parseJson(e.unEscapeHtml(t))};r.setupConfig({converters:{iframe:d,text:{iframe:function(e){return e}},xml:{iframe:function(e){return e}}}});function f(t){var r=e.guid("io-iframe"),i,a=n.getEmptyIframeSrc();i=t.iframe=n.create("<iframe "+(a?' src="'+a+'" ':"")+' id="'+r+'"'+' name="'+r+'"'+' style="position:absolute;left:-9999px;top:-9999px;"/>');n.prepend(i,o.body||o.documentElement);return i}function c(t,r,i){var a=[],s,l,u,d;e.each(t,function(t,f){s=e.isArray(t);l=e.makeArray(t);for(u=0;u<l.length;u++){d=o.createElement("input");d.type="hidden";d.name=f+(s&&i?"[]":"");d.value=l[u];n.append(d,r);a.push(d)}});return a}function p(e){n.remove(e)}function h(e){this.io=e;a.info("use IframeTransport for: "+e.config.url)}e.augment(h,{send:function(){var t=this,r=t.io,a=r.config,o,s,l,u=a.data,d=n.get(a.form);t.attrs={target:n.attr(d,"target")||"",action:n.attr(d,"action")||"",encoding:n.attr(d,"encoding"),enctype:n.attr(d,"enctype"),method:n.attr(d,"method")};t.form=d;s=f(r);n.attr(d,{target:s.id,action:r._getUrlForSend(),method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});if(u){l=e.unparam(u)}if(l){o=c(l,d,a.serializeArray)}t.fields=o;function p(){i.on(s,"load error",t._callback,t);d.submit()}if(e.UA.ie===6){setTimeout(p,0)}else{p()}},_callback:function(t){var r=this,a=r.form,o=r.io,d=t.type,f,c=o.iframe;if(!c){return}if(d==="abort"&&e.UA.ie===6){setTimeout(function(){n.attr(a,r.attrs)},0)}else{n.attr(a,r.attrs)}p(this.fields);i.detach(c);setTimeout(function(){n.remove(c)},u);o.iframe=null;if(d==="load"){try{f=c.contentWindow.document;if(f&&f.body){o.responseText=n.html(f.body);if(e.startsWith(o.responseText,"<?xml")){o.responseText=undefined}}if(f&&f.XMLDocument){o.responseXML=f.XMLDocument}else{o.responseXML=f}if(f){o._ioReady(s,"success")}else{o._ioReady(l,"parser error")}}catch(h){o._ioReady(l,"parser error")}}else{if(d==="error"){o._ioReady(l,"error")}}},abort:function(){this._callback({type:"abort"})}});r.setupTransport("iframe",h);return r});KISSY.add("io/methods",["promise","./base"],function(e,t){var n=t("promise"),r=t("./base");var i=200,a=300,o=304,s=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;function l(t){var n=t.responseText,r=t.responseXML,i=t.config,a=i.converters,o,s,l,u=i.contents,d=i.dataType;if(n||r){s=t.mimeType||t.getResponseHeader("Content-Type");while(d[0]==="*"){d.shift()}if(!d.length){for(o in u){if(u[o].test(s)){if(d[0]!==o){d.unshift(o)}break}}}d[0]=d[0]||"text";for(var f=0;f<d.length;f++){if(d[f]==="text"&&n!==undefined){l=n;break}else{if(d[f]==="xml"&&r!==undefined){l=r;break}}}if(!l){var c={text:n,xml:r};e.each(["text","xml"],function(e){var t=d[0],i=a[e]&&a[e][t];if(i&&c[e]){d.unshift(e);l=e==="text"?n:r;return false}return undefined})}}var p=d[0];for(var h=1;h<d.length;h++){o=d[h];var m=a[p]&&a[p][o];if(!m){throw new Error("no covert for "+p+" => "+o)}l=m(l);p=o}t.responseData=l}e.extend(r,n,{setRequestHeader:function(e,t){var n=this;n.requestHeaders[e]=t;return n},getAllResponseHeaders:function(){var e=this;return e.state===2?e.responseHeadersString:null},getResponseHeader:function(e){var t,n=this,r;e=e.toLowerCase();if(n.state===2){if(!(r=n.responseHeaders)){r=n.responseHeaders={};while(t=s.exec(n.responseHeadersString)){r[t[1].toLowerCase()]=t[2]}}t=r[e]}return t===undefined?null:t},overrideMimeType:function(e){var t=this;if(!t.state){t.mimeType=e}return t},abort:function(e){var t=this;e=e||"abort";if(t.transport){t.transport.abort(e)}t._ioReady(0,e);return t},getNativeXhr:function(){var e=this.transport;if(e){return e.nativeXhr}return null},_ioReady:function(t,n){var s=this;if(s.state===2){return}s.state=2;s.readyState=4;var u;if(t>=i&&t<a||t===o){if(t===o){n="not modified";u=true}else{try{l(s);n="success";u=true}catch(d){e.log(d.stack||d,"error");if(""){setTimeout(function(){throw d},0)}n=d.message||"parser error"}}}else{if(t<0){t=0}}s.status=t;s.statusText=n;var f=s.defer,c=s.config,p;if(p=s.timeoutTimer){clearTimeout(p);s.timeoutTimer=0}var h=u?"success":"error",m,g=[s.responseData,n,s],v=c.context,b={ajaxConfig:c,io:s};if(m=c[h]){m.apply(v,g)}if(m=c.complete){m.apply(v,g)}r.fire(h,b);r.fire("complete",b);f[u?"resolve":"reject"](g)},_getUrlForSend:function(){var t=this.config,n=t.uri,r=e.Uri.getComponents(t.url).query||"",i=n.toString.call(n,t.serializeArray);return i+(r?(n.query.has()?"&":"?")+r:r)}})});KISSY.add("io",["io/form-serializer","io/base","io/xhr-transport","io/script-transport","io/jsonp","io/form","io/iframe-transport","io/methods"],function(e,t){var n=t("io/form-serializer"),r=t("io/base");t("io/xhr-transport");t("io/script-transport");t("io/jsonp");t("io/form");t("io/iframe-transport");t("io/methods");function i(e,t,n,i,a){if(typeof t==="function"){i=n;n=t;t=undefined}return r({type:a||"get",url:e,data:t,success:n,dataType:i})}e.mix(r,{serialize:n.serialize,get:i,post:function(e,t,n,r){if(typeof t==="function"){r=n;n=t;t=undefined}return i(e,t,n,r,"post")},jsonp:function(e,t,n){if(typeof t==="function"){n=t;t=undefined}return i(e,t,n,"jsonp")},getScript:e.getScript,getJSON:function(e,t,n){if(typeof t==="function"){n=t;t=undefined}return i(e,t,n,"json")},upload:function(e,t,n,i,a){if(typeof n==="function"){a=i;i=n;n=undefined}return r({url:e,type:"post",dataType:a,form:t,data:n,success:i})}});e.mix(e,{Ajax:r,IO:r,ajax:r,io:r,jsonp:r.jsonp});return r});KISSY.add("base",["attribute"],function(e,t){var n=t("attribute");var r=e.ucfirst,i="_onSet",a=e.noop;function u(e,t){return function(n){return function r(){var r=this;if(t){n.apply(r,arguments)}else{r.callSuper.apply(r,arguments)}var i=arguments.callee.__owner__.__extensions__||[];if(t){i.reverse()}d(r,i,e,arguments);if(t){r.callSuper.apply(r,arguments)}else{n.apply(r,arguments)}}}}var s=n.extend({constructor:function(){var e=this;e.callSuper.apply(e,arguments);var t=e.get("listeners");for(var n in t){if(t.hasOwnProperty(n)){e.on(n,t[n])}}e.initializer();c(e);_.call(e,"pluginInitializer");e.bindInternal();e.syncInternal()},initializer:a,__getHook:u,__callPluginsMethod:_,bindInternal:function(){var e=this,t=e.getAttrs(),n,a;for(n in t){a=i+r(n);if(e[a]){e.on("after"+r(n)+"Change",l)}}},syncInternal:function(){var e=this,t=[],n,a=e.constructor,u=e.getAttrs();while(a){t.push(a);a=a.superclass&&a.superclass.constructor}t.reverse();for(n=0;n<t.length;n++){var s=t[n].ATTRS||{};for(var f in s){if(f in u){var o,l;var c=i+r(f);if((l=e[c])&&u[f].sync!==0&&(o=e.get(f))!==undefined){l.call(e,o)}}}}},plug:function(e){var t=this;if(typeof e==="function"){var n=e;e=new n}if(e.pluginInitializer){e.pluginInitializer(t)}t.get("plugins").push(e);return t},unplug:function(t){var n=[],r=this,i=typeof t==="string";e.each(r.get("plugins"),function(e){var a=0,u;if(t){if(i){u=e.get&&e.get("pluginId")||e.pluginId;if(u!==t){n.push(e);a=1}}else{if(e!==t){n.push(e);a=1}}}if(!a){e.pluginDestructor(r)}});r.setInternal("plugins",n);return r},getPlugin:function(t){var n=null;e.each(this.get("plugins"),function(e){var r=e.get&&e.get("pluginId")||e.pluginId;if(r===t){n=e;return false}return undefined});return n},destructor:e.noop,destroy:function(){var e=this;if(!e.get("destroyed")){_.call(e,"pluginDestructor");e.destructor();e.set("destroyed",true);e.fire("destroy");e.detach()}}});e.mix(s,{__hooks__:{initializer:u(),destructor:u("__destructor",true)},ATTRS:{plugins:{value:[]},destroyed:{value:false},listeners:{value:[]}},extend:function p(t,r,i){if(!e.isArray(t)){i=r;r=t;t=[]}i=i||{};r=r||{};var a=n.extend.call(this,r,i);a.__extensions__=t;o.call(a,{});if(t.length){var u={},s={};e.each(t.concat(a),function(t){if(t){e.each(t.ATTRS,function(t,n){var r=u[n]=u[n]||{};e.mix(r,t)});var n=t.prototype,r;for(r in n){if(n.hasOwnProperty(r)){s[r]=n[r]}}}});a.ATTRS=u;s.constructor=a;e.augment(a,s)}a.extend=i.extend||p;a.addMembers=o;return a}});var f=s.addMembers;function o(e){var t=this;var n=t.__extensions__,r=t.__hooks__,i=t.prototype;if(n.length&&r){for(var u in r){if(i.hasOwnProperty(u)&&!e.hasOwnProperty(u)){continue}e[u]=e[u]||a}}return f.call(t,e)}function l(e){var t=this,n;if(e.target===t){n=t[i+e.type.slice(5).slice(0,-6)];n.call(t,e.newVal,e)}}function c(t){var n=t.get("plugins"),r;e.each(n,function(e,t){if(typeof e==="function"){r=e;n[t]=new r}})}function _(e){var t,n=this,r=n.get("plugins");if(t=r.length){for(var i=0;i<t;i++){if(r[i][e]){r[i][e](n)}}}}function d(e,t,n,r){var i;if(i=t&&t.length){for(var a=0;a<i;a++){var u=t[a]&&(!n?t[a]:t[a].prototype[n]);if(u){u.apply(e,r||[])}}}}e.Base=s;return s});KISSY.add("attribute",["event/custom"],function(e,t,n,r){var i=/(?:^|-)([a-z])/gi;var a=t("event/custom");r.exports=x;var u=e.bind;function s(){return arguments[1].toUpperCase()}function f(e){return e.replace(i,s)}var o={};var l=false;function c(e,t){if(typeof t==="string"){return e[t]}return t}function _(e){return e.__attrVals||(e.__attrVals={})}function d(t,n){return t+e.ucfirst(n)+"Change"}function v(t,n,r,i,a,u,s,f){s=s||r;return t.fire(d(n,r),e.mix({attrName:s,subAttrName:u,prevVal:i,newVal:a},f))}function p(e,t,n){var r=e[t];if(!n&&!r){e[t]=r={}}return r||{}}function m(e,t){for(var n=0,r=t.length;e!==undefined&&n<r;n++){e=e[t[n]]}return e}function h(e,t,n){var r=t.length-1,i=e;if(r>=0){for(var a=0;a<r;a++){e=e[t[a]]}if(e!==undefined){e[t[a]]=n}else{i=undefined}}return i}function g(e){var t;if(e.indexOf(".")!==-1){t=e.split(".");e=t.shift()}return{path:t,name:e}}function A(t,n,r){var i=r;if(n){if(t===undefined){i={}}else{i=e.clone(t)}h(i,n,r)}return i}function w(e,t){var n=p(e,"__defaultBeforeFns");if(n[t]){return}n[t]=1;var r=d("before",t);e.publish(r,{defaultFn:y})}function b(t,n,r,i,a){var u,s,f,o=g(n),c=n;n=o.name;u=o.path;f=t.get(n);w(t,n);if(u){s=m(f,u)}if(!i.force){if(!u&&f===r){return undefined}else{if(u&&s===r){return undefined}}}r=A(f,u,r);var _=e.mix({attrName:n,subAttrName:c,prevVal:f,newVal:r,_opts:i,_attrs:a,target:t},i.data);if(i.silent){if(l===y.call(t,_)){return l}}else{if(l===t.fire(d("before",n),_)){return l}}return t}function y(e){if(e.target!==this){return undefined}var t=this,n=e.newVal,r=e.prevVal,i=e.attrName,a=e.subAttrName,u=e._attrs,s=e._opts;var f=t.setInternal(i,n);if(f===l){return f}if(!s.silent){n=_(t)[i];v(t,"after",i,r,n,a,null,s.data);if(u){u.push({prevVal:r,newVal:n,attrName:i,subAttrName:a})}else{v(t,"","*",[r],[n],[a],[i],s.data)}}return undefined}function x(e){var t=this,n=t.constructor;t.userConfig=e;while(n){N(t,n.ATTRS);n=n.superclass?n.superclass.constructor:null}O(t,e)}function V(t,n){var r=n.__hooks__||{};for(var i in r){if(i in t){t[i]=r[i](t[i])}}e.each(t,function(e,r){if(typeof e==="function"){var i=0;if(e.__owner__){var a=e.__owner__;delete e.__owner__;delete e.__name__;i=e.__wrapped__=1;var s=u(e);s.__owner__=a;s.__name__=r;a.prototype[r]=s}else{if(e.__wrapped__){i=1}}if(i){t[r]=e=u(e)}e.__owner__=n;e.__name__=r}})}function S(t){var n=this;V(t,n);e.mix(n.prototype,t)}x.extend=function T(t,n){var r,i=this;n=n||{};t=t||{};var a,u=n.__hooks__;if(a=i.__hooks__){u=n.__hooks__=n.__hooks__||{};e.mix(u,a,false)}var s=n.name||"AttributeDerived";if(t.hasOwnProperty("constructor")){r=t.constructor}else{if(""){r=new Function("return function "+f(s)+"(){ "+"this.callSuper.apply(this, arguments);"+"}")()}else{r=function(){this.callSuper.apply(this,arguments)}}}t.constructor=r;r.__hooks__=u;V(t,r);var o,l=n.inheritedStatics;if(o=i.inheritedStatics){l=n.inheritedStatics=n.inheritedStatics||{};e.mix(l,o,false)}e.extend(r,i,t,n);if(l){e.mix(r,l)}r.extend=n.extend||T;r.addMembers=S;return r};function N(e,t){if(t){for(var n in t){e.addAttr(n,t[n],false)}}}function O(e,t){if(t){for(var n in t){e.setInternal(n,t[n])}}}e.augment(x,a.Target,{INVALID:o,callSuper:function(){var e,t,n=this,r=arguments;if(typeof n==="function"&&n.__name__){e=n;t=r[0];r=Array.prototype.slice.call(r,1)}else{e=arguments.callee.caller;if(e.__wrapped__){e=e.caller}t=n}var i=e.__name__;if(!i){return undefined}var a=e.__owner__.superclass[i];if(!a){return undefined}return a.apply(t,r||[])},getAttrs:function(){return this.__attrs||(this.__attrs={})},getAttrVals:function(){var e=this,t={},n,r=e.getAttrs();for(n in r){t[n]=e.get(n)}return t},addAttr:function(t,n,r){var i=this,a=i.getAttrs(),u,s=e.clone(n);if(u=a[t]){e.mix(u,s,r)}else{a[t]=s}return i},addAttrs:function(t,n){var r=this;e.each(t,function(e,t){r.addAttr(t,e)});if(n){r.set(n)}return r},hasAttr:function(e){return this.getAttrs().hasOwnProperty(e)},removeAttr:function(e){var t=this;var n=_(t);var r=t.getAttrs();if(t.hasAttr(e)){delete r[e];delete n[e]}return t},set:function(t,n,r){var i=this,a;if(e.isPlainObject(t)){r=n;r=r||{};var u=Object(t),s=[],f=[];for(t in u){if((a=P(i,t,u[t],u))!==undefined){f.push(a)}}if(f.length){if(r.error){r.error(f)}return l}for(t in u){b(i,t,u[t],r,s)}var o=[],c=[],_=[],d=[];e.each(s,function(e){c.push(e.prevVal);_.push(e.newVal);o.push(e.attrName);d.push(e.subAttrName)});if(o.length){v(i,"","*",c,_,d,o,r.data)}return i}r=r||{};a=P(i,t,n);if(a!==undefined){if(r.error){r.error(a)}return l}return b(i,t,n,r)},setInternal:function(e,t){var n=this,r,i=p(n.getAttrs(),e),a=i.setter;if(a&&(a=c(n,a))){r=a.call(n,t,e)}if(r===o){return l}if(r!==undefined){t=r}_(n)[e]=t;return undefined},get:function(e){var t=this,n=".",r,i=_(t),a,u,s;if(e.indexOf(n)!==-1){r=e.split(n);e=r.shift()}a=p(t.getAttrs(),e,1);u=a.getter;s=e in i?i[e]:I(t,e);if(u&&(u=c(t,u))){s=u.call(t,s,e)}if(!(e in i)&&s!==undefined){i[e]=s}if(r){s=m(s,r)}return s},reset:function(e,t){var n=this;if(typeof e==="string"){if(n.hasAttr(e)){return n.set(e,I(n,e),t)}else{return n}}t=e;var r=n.getAttrs(),i={};for(e in r){i[e]=I(n,e)}n.set(i,t);return n}});function I(e,t){var n=e.getAttrs(),r=p(n,t,1),i=r.valueFn,a;if(i&&(i=c(e,i))){a=i.call(e);if(a!==undefined){r.value=a}delete r.valueFn;n[t]=r}return r.value}function P(e,t,n,r){var i,a,u;u=g(t);t=u.name;i=u.path;if(i){a=e.get(t);n=A(a,i,n)}var s=p(e.getAttrs(),t),f,o=s.validator;if(o&&(o=c(e,o))){f=o.call(e,n,t,r);if(f!==undefined&&f!==true){return f}}return undefined}});KISSY.add("combobox/combobox-xtpl",[],function(e,t,n,r){return function(e,t,n){var i="",a=this.config,o=this,s,u=a.utils;if(typeof r!=="undefined"&&r.kissy){s=r}var l=u.runBlockCommand,f=u.renderOutput,c=u.getProperty,d=u.runInlineCommand,h=u.getPropertyOrRunCommand;i+='<div id="ks-combobox-invalid-el-';var g=h(o,e,{},"id",0,1);i+=f(g,true);i+='"\n     class="';var v={};var p=[];p.push("invalid-el");v.params=p;var m=d(o,e,v,"getBaseCssClasses",2);i+=f(m,true);i+='">\n    <div class="';var b={};var _=[];_.push("invalid-inner");b.params=_;var x=d(o,e,b,"getBaseCssClasses",3);i+=f(x,true);i+='"></div>\n</div>\n\n';var S={};var y=[];var A=c(o,e,"hasTrigger",0,6);y.push(A);S.params=y;S.fn=function(e){var t="";t+='\n<div id="ks-combobox-trigger-';var n=h(o,e,{},"id",0,7);t+=f(n,true);t+='"\n     class="';var r={};var i=[];i.push("trigger");r.params=i;var a=d(o,e,r,"getBaseCssClasses",8);t+=f(a,true);t+='">\n    <div class="';var s={};var u=[];u.push("trigger-inner");s.params=u;var l=d(o,e,s,"getBaseCssClasses",9);t+=f(l,true);t+='">&#x25BC;</div>\n</div>\n';return t};i+=l(o,e,S,"if",6);i+='\n\n<div class="';var C={};var w=[];w.push("input-wrap");C.params=w;var I=d(o,e,C,"getBaseCssClasses",13);i+=f(I,true);i+='">\n\n    <input id="ks-combobox-input-';var k=h(o,e,{},"id",0,15);i+=f(k,true);i+='"\n           aria-haspopup="true"\n           aria-autocomplete="list"\n           aria-haspopup="true"\n           role="autocomplete"\n           aria-expanded="false"\n\n    ';var T={};var M=[];var V=c(o,e,"disabled",0,22);M.push(V);T.params=M;T.fn=function(e){var t="";t+="\n    disabled\n    ";return t};i+=l(o,e,T,"if",22);i+='\n\n    autocomplete="off"\n    class="';var R={};var D=[];D.push("input");R.params=D;var B=d(o,e,R,"getBaseCssClasses",27);i+=f(B,true);i+='"\n\n    value="';var F=h(o,e,{},"value",0,29);i+=f(F,true);i+='"\n    />\n\n\n    <label id="ks-combobox-placeholder-';var E=h(o,e,{},"id",0,33);i+=f(E,true);i+='"\n           for="ks-combobox-input-';var L=h(o,e,{},"id",0,34);i+=f(L,true);i+="\"\n            style='display:";var K={};var O=[];var P=c(o,e,"value",0,35);O.push(P);K.params=O;K.fn=function(e){var t="";t+="none";return t};K.inverse=function(e){var t="";t+="block";return t};i+=l(o,e,K,"if",35);i+=";'\n    class=\"";var N={};var H=[];H.push("placeholder");N.params=H;var W=d(o,e,N,"getBaseCssClasses",36);i+=f(W,true);i+='">\n    ';var Y=h(o,e,{},"placeholder",0,37);i+=f(Y,true);i+="\n    </label>\n</div>\n";return i}});KISSY.add("combobox/render",["component/control","./combobox-xtpl"],function(e,t){var n=t("component/control");var r=t("./combobox-xtpl");return n.getDefaultRender().extend({beforeCreateDom:function(t,n){e.mix(n,{input:"#ks-combobox-input-{id}",trigger:"#ks-combobox-trigger-{id}",invalidEl:"#ks-combobox-invalid-el-{id}",placeholderEl:"#ks-combobox-placeholder-{id}"})},getKeyEventTarget:function(){return this.control.get("input")},_onSetCollapsed:function(e){this.control.get("input").attr("aria-expanded",!e)},_onSetDisabled:function(e,t){this.callSuper(e,t);this.control.get("input").attr("disabled",e)}},{ATTRS:{contentTpl:{value:r}},HTML_PARSER:{value:function(e){return e.one("."+this.getBaseCssClass("input")).val()},input:function(e){return e.one("."+this.getBaseCssClass("input"))},trigger:function(e){return e.one("."+this.getBaseCssClass("trigger"))},invalidEl:function(e){return e.one("."+this.getBaseCssClass("invalid-el"))},placeholderEl:function(e){return e.one("."+this.getBaseCssClass("placeholder"))}}})});KISSY.add("combobox/control",["node","component/control","./render","menu"],function(e,t){var n=t("node");var r=t("component/control");var i=t("./render");t("menu");var a,o=n.KeyCode;a=r.extend([],{initializer:function(){this.publish("afterRenderData",{bubbles:false})},_savedValue:null,normalizeData:function(t){var n=this,r,i,a,o;if(t&&t.length){t=t.slice(0,n.get("maxItemCount"));if(n.get("format")){r=n.get("format").call(n,n.getValueForAutocomplete(),t)}else{r=[]}for(a=0;a<t.length;a++){i=t[a];o=r[a]=e.mix({content:i,textContent:i,value:i},r[a])}return r}return r},bindUI:function(){var e=this,t=e.get("input");t.on("valuechange",m,e);e.on("click",h,e);e.get("menu").onRendered(function(t){d(e,t)})},destructor:function(){this.get("menu").destroy()},getValueForAutocomplete:function(){return this.get("value")},setValueFromAutocomplete:function(e,t){this.set("value",e,t)},_onSetValue:function(e,t){var n=this,r;if(t.causedByTimer){r=n.getValueForAutocomplete();if(r===undefined){n.set("collapsed",true);return}n._savedValue=r;n.sendRequest(r)}else{n.get("input").val(e)}},handleFocusInternal:function(){var e=this,t;p(e);if(e.get("invalidEl")){g(e,false)}if(t=e.get("placeholderEl")){t.hide()}},handleBlurInternal:function(e){var t=this,n=t.get("placeholderEl");t.callSuper(e);v(t);if(t.get("invalidEl")){t.validate(function(e,n){if(e){if(!t.get("focused")&&n===t.get("value")){g(t,e)}}else{g(t,false)}})}if(n&&!t.get("value")){n.show()}},handleMouseDownInternal:function(e){var t=this,n,r;t.callSuper(e);n=e.target;r=t.get("trigger");if(r&&(r[0]===n||r.contains(n))){if(t.get("collapsed")){t.focus();t.sendRequest("")}else{t.set("collapsed",true)}e.preventDefault()}},handleKeyDownInternal:function(t){var n=this,r,i,a=t.keyCode,u,l,f=n.get("menu");i=n.get("input");r=n.get("updateInputOnDownUp");if(f.get("visible")){u=f.get("highlightedItem");if(r&&u){var c=f.get("children");if(a===o.DOWN&&u===s(c.concat().reverse())||a===o.UP&&u===s(c)){n.setValueFromAutocomplete(n._savedValue);u.set("highlighted",false);return true}}l=f.handleKeyDownInternal(t);u=f.get("highlightedItem");if(a===o.ESC){n.set("collapsed",true);if(r){n.setValueFromAutocomplete(n._savedValue)}return true}if(r&&e.inArray(a,[o.DOWN,o.UP])){n.setValueFromAutocomplete(u.get("textContent"))}if(a===o.TAB&&u){u.handleClickInternal(t);if(n.get("multiple")){return true}}return l}else{if(a===o.DOWN||a===o.UP){var d=n.getValueForAutocomplete();if(d!==undefined){n.sendRequest(d);return true}}}return undefined},validate:function(e){var t=this,n=t.get("validator"),r=t.getValueForAutocomplete();if(n){n(r,function(t){e(t,r)})}else{e(false,r)}},sendRequest:function(e){var t=this,n=t.get("dataSource");n.fetchData(e,b,t)},_onSetCollapsed:function(e){var t=this,n=t.$el,r=t.get("menu");if(e){r.hide()}else{p(t);if(!r.get("visible")){if(t.get("matchElWidth")){r.render();var i=r.get("el");var a=(parseInt(i.css("borderLeftWidth"))||0)+(parseInt(i.css("borderRightWidth"))||0);r.set("width",n[0].offsetWidth-a)}r.show()}}}},{ATTRS:{input:{},value:{value:"",sync:0,view:1},trigger:{},placeholder:{view:1},placeholderEl:{},validator:{},invalidEl:{},allowTextSelection:{value:true},hasTrigger:{value:true,view:1},menu:{value:{},getter:function(e){if(!e.isControl){e.xclass=e.xclass||"popupmenu";e=this.createComponent(e);this.setInternal("menu",e)}return e},setter:function(t){if(t.isControl){t.setInternal("parent",this);var n={node:this.$el,points:["bl","tl"],overflow:{adjustX:1,adjustY:1}};e.mix(t.get("align"),n,false)}}},collapsed:{view:1,value:true},dataSource:{},maxItemCount:{value:99999},matchElWidth:{value:true},format:{},updateInputOnDownUp:{value:true},autoHighlightFirst:{},highlightMatchItem:{value:true},xrender:{value:i}},xclass:"combobox"});function s(e){for(var t=0;t<e.length;t++){if(!e[t].get("disabled")){return e[t]}}return null}function u(){var e=this;v(e)}function l(){var e=this;setTimeout(function(){p(e)},0)}function f(){var e=this;e.focus();p(e)}function c(){var e=this;e.setValueFromAutocomplete(e.getValueForAutocomplete(),{force:1})}function d(e,t){var n;var r=e.get("input");var i=t.get("el");n=t.get("contentEl");r.attr("aria-owns",i.attr("id"));i.on("focusout",u,e);i.on("focusin",l,e);n.on("mouseover",f,e);n.on("mousedown",c,e)}function h(e){var t=e.target,n=this,r;if(t.isMenuItem){r=t.get("textContent");n.setValueFromAutocomplete(r);n._savedValue=r;n.set("collapsed",true)}}function g(e,t){var n=e.$el,r=e.view.getBaseCssClasses("invalid"),i=e.get("invalidEl");if(t){n.addClass(r);i.attr("title",t);i.show()}else{n.removeClass(r);i.hide()}}function v(e){if(e._focusoutDismissTimer){return}e._focusoutDismissTimer=setTimeout(function(){if(e._focusoutDismissTimer){e.set("collapsed",true)}},50)}function p(e){var t=e._focusoutDismissTimer;if(t){clearTimeout(t);e._focusoutDismissTimer=null}}function m(e){this.set("value",e.newVal,{data:{causedByTimer:1}})}function b(e){var t=this,n,r=[],i,a,o,s,u=t.get("menu");e=t.normalizeData(e);u.set("highlightedItem",null);u.removeChildren(true);if(o=u.get("highlightedItem")){o.set("highlighted",false)}if(e&&e.length){for(s=0;s<e.length;s++){n=e[s];u.addChild(n)}r=u.get("children");i=t.getValueForAutocomplete();if(t.get("highlightMatchItem")){for(s=0;s<r.length;s++){if(r[s].get("textContent")===i){r[s].set("highlighted",true);a=true;break}}}if(!a&&t.get("autoHighlightFirst")){for(s=0;s<r.length;s++){if(!r[s].get("disabled")){r[s].set("highlighted",true);break}}}t.set("collapsed",false);t.fire("afterRenderData")}else{t.set("collapsed",true)}}return a});KISSY.add("combobox/cursor",["node"],function(e,t){var n=t("node");var r=n.all,i='<div style="'+"z-index:-9999;"+"overflow:hidden;"+"position: fixed;"+"left:-9999px;"+"top:-9999px;"+"opacity:0;"+"white-space:pre-wrap;"+"word-wrap:break-word;"+'"></div>',a,o="<span>"+"x"+"</span>",s=["paddingLeft","paddingTop","paddingBottom","paddingRight","marginLeft","marginTop","marginBottom","marginRight","borderLeftStyle","borderTopStyle","borderBottomStyle","borderRightStyle","borderLeftWidth","borderTopWidth","borderBottomWidth","borderRightWidth","line-height","outline","height","fontFamily","fontSize","fontWeight","fontVariant","fontStyle"],u,l;function f(t){var n=a;if(!n){n=r(i)}if(String(t[0].type.toLowerCase())==="textarea"){n.css("width",t.css("width"))}else{n.css("width",9999)}e.each(s,function(e){n.css(e,t.css(e))});if(!a){n.insertBefore(t[0].ownerDocument.body.firstChild)}a=n;return n}l=function(){var t=document,n=r("<input>");n.css({width:1,position:"absolute",left:-9999,top:-9999});n.val("123456789");n.appendTo(t.body);n[0].focus();u=n[0].scrollLeft>0;n.remove();l=e.noop};u=false;return function(t){var n=r(t);t=n[0];var i=t.ownerDocument,a=r(i),s,l,c,d,h,g,v=t.scrollTop,p=t.scrollLeft;if(i.selection){l=i.selection.createRange();return{left:l.boundingLeft+p+a.scrollLeft(),top:l.boundingTop+v+l.boundingHeight+a.scrollTop()}}s=n.offset();if(!u&&t.type!=="textarea"){s.top+=t.offsetHeight;return s}c=f(n);d=t.selectionStart;c.html(e.escapeHtml(t.value.substring(0,d-1))+o);h=s;c.offset(h);g=c.last();h=g.offset();h.top+=g.height();if(d>0){h.left+=g.width()}h.top-=v;h.left-=p;return h}});KISSY.add("combobox/multi-value-combobox",["./cursor","./control"],function(e,t){var n="suffix",r=/\s|\xa0/;var i=t("./cursor");var a=t("./control");function o(e,t){return t&&e.indexOf(t)!==-1}function s(e){if(e.newVal&&e.target===this.get("menu")){this.alignWithCursor()}}return a.extend({syncUI:function(){var e=this,t;if(e.get("alignWithCursor")){t=e.get("menu");t.setInternal("align",null);t.on("beforeVisibleChange",s,this)}},getValueForAutocomplete:function(){var e=this,t=u(e),r=t.tokens,i=t.tokenIndex,a=e.get("separator"),s=e.get("separatorType"),l=r[i],f=l.length-1;if(s!==n){if(o(a,l.charAt(0))){l=l.slice(1)}else{return undefined}}else{if(s===n&&o(a,l.charAt(f))){l=l.slice(0,f)}}return l},setValueFromAutocomplete:function(e,t){var i=this,a=i.get("input"),s=u(i),l=s.tokens,f=Math.max(0,s.tokenIndex),c=i.get("separator"),d,h,g=i.get("separatorType"),v=l[f+1]||"",p=l[f];if(g!==n){l[f]=p.charAt(0)+e;if(e&&!(v&&r.test(v.charAt(0)))){l[f]+=" "}}else{l[f]=e;h=p.length-1;if(o(c,p.charAt(h))){l[f]+=p.charAt(h)}else{if(c.length===1){l[f]+=c}}}d=l.slice(0,f+1).join("").length;i.set("value",l.join(""),t);a.prop("selectionStart",d);a.prop("selectionEnd",d)},alignWithCursor:function(){var e=this;var t=e.get("menu"),n,r=e.get("input");n=i(r);t.move(n.left,n.top)}},{ATTRS:{separator:{value:",;"},separatorType:{value:n},literal:{value:'"'},alignWithCursor:{}},xclass:"multi-value-combobox"});function u(e){var t=e.get("input"),i=e.get("value"),a=[],s=[],u=e.get("literal"),l=e.get("separator"),f=e.get("separatorType"),c=false,d=f!==n,h=t.prop("selectionStart"),g,v,p=-1;for(g=0;g<i.length;g++){v=i.charAt(g);if(u){if(v===u){c=!c}}if(c){s.push(v);continue}if(g===h){p=a.length}if(d&&r.test(v)){if(s.length){a.push(s.join(""))}s=[];s.push(v)}else{if(o(l,v)){if(f===n){s.push(v);if(s.length){a.push(s.join(""))}s=[]}else{if(s.length){a.push(s.join(""))}s=[];s.push(v)}}else{s.push(v)}}}if(s.length){a.push(s.join(""))}if(!a.length){a.push("")}if(p===-1){if(f===n&&o(l,v)){a.push("")}p=a.length-1}return{tokens:a,cursorPosition:h,tokenIndex:p}}});KISSY.add("combobox/filter-select",["./control"],function(e,t,n,r){var i=t("./control");function a(e,t){var n=false;if(t){for(var r=0;r<t.length;r++){if(t[r].textContent===e){return t[r]}}}return n}r.exports=i.extend({validate:function(e){var t=this;t.callSuper(function(n,r){if(!n){t.get("dataSource").fetchData(r,function(n){var i=a(r,t.normalizeData(n));e(i?"":t.get("invalidMessage"),r,i)})}else{e(n,r)}})}},{ATTRS:{invalidMessage:{value:"invalid input"}}})});KISSY.add("combobox/local-data-source",["attribute"],function(e,t){var n=t("attribute");return n.extend({fetchData:function(e,t,n){var r=this.get("parse"),i=this.get("data");i=r(e,i);t.call(n,i)}},{ATTRS:{data:{value:[]},parse:{value:r}}});function r(t,n){var r=[],i=0;if(!t){return n}e.each(n,function(e){if(e.indexOf(t)!==-1){r.push(e)}i++});return r}});KISSY.add("combobox/remote-data-source",["io","attribute"],function(e,t){var n=t("io");var r=t("attribute");return r.extend({fetchData:function(e,t,r){var i=this,a,o=i.get("paramName"),s=i.get("parse"),u=i.get("cache"),l=i.get("allowEmpty");i.caches=i.caches||{};if(i.io){i.io.abort();i.io=null}if(!e&&l!==true){return t.call(r,[])}if(u){if(a=i.caches[e]){return t.call(r,a)}}var f=i.get("xhrCfg");f.data=f.data||{};f.data[o]=e;f.success=function(n){if(s){n=s(e,n)}i.setInternal("data",n);if(u){i.caches[e]=n}t.call(r,n)};i.io=n(f);return undefined}},{ATTRS:{paramName:{value:"q"},allowEmpty:{},cache:{},parse:{},xhrCfg:{value:{}}}})});KISSY.add("combobox",["combobox/control","combobox/multi-value-combobox","combobox/filter-select","combobox/local-data-source","combobox/remote-data-source"],function(e,t){var n=t("combobox/control");var r=t("combobox/multi-value-combobox");var i=t("combobox/filter-select");var a=t("combobox/local-data-source");var o=t("combobox/remote-data-source");n.LocalDataSource=a;n.RemoteDataSource=o;n.FilterSelect=i;n.MultiValueComboBox=r;return n});KISSY.add("component/control/process",["base","promise"],function(e,t){var n=t("base");var r=t("promise");var i=r.Defer,o=n.prototype.__getHook,a=e.noop;var s=n.extend({bindInternal:a,syncInternal:a,initializer:function(){this._renderedDefer=new i},renderUI:a,syncUI:a,bindUI:a,onRendered:function(e){return this._renderedDefer.promise.then(e)},create:function(){var e=this;if(!e.get("created")){e.fire("beforeCreateDom");e.createInternal();e.__callPluginsMethod("pluginCreateDom");e.fire("afterCreateDom");e.setInternal("created",true)}return e},createInternal:function(){this.createDom()},render:function(){var e=this;if(!e.get("rendered")){e.create();e.fire("beforeRenderUI");e.renderUI();e.__callPluginsMethod("pluginRenderUI");e.fire("afterRenderUI");e.fire("beforeBindUI");s.superclass.bindInternal.call(e);e.bindUI();e.__callPluginsMethod("pluginBindUI");e.fire("afterBindUI");s.superclass.syncInternal.call(e);u(e);e.setInternal("rendered",true)}return e},sync:function(){u(this)},plug:function(e){var t=this,n,r=t.get("plugins");t.callSuper(e);n=r[r.length-1];if(t.get("rendered")){if(n.pluginCreateDom){n.pluginCreateDom(t)}if(n.pluginRenderUI){n.pluginCreateDom(t)}if(n.pluginBindUI){n.pluginBindUI(t)}if(n.pluginSyncUI){n.pluginSyncUI(t)}}else{if(t.get("created")){if(n.pluginCreateDom){n.pluginCreateDom(t)}}}return t}},{__hooks__:{createDom:o("__createDom"),renderUI:o("__renderUI"),bindUI:o("__bindUI"),syncUI:o("__syncUI")},name:"ComponentProcess",ATTRS:{rendered:{value:false,setter:function(e){if(e){this._renderedDefer.resolve(this)}}},created:{value:false}}});function u(e){e.fire("beforeSyncUI");e.syncUI();e.__callPluginsMethod("pluginSyncUI");e.fire("afterSyncUI")}return s});KISSY.add("component/control/render-xtpl",[],function(e,t,n,r){return function(e,t,n){var i="",o=this.config,a=this,s,u=o.utils;if(typeof r!=="undefined"&&r.kissy){s=r}var l=u.runBlockCommand,c=u.renderOutput,f=u.getProperty,d=u.runInlineCommand,h=u.getPropertyOrRunCommand;i+='<div id="';var p=h(a,e,{},"id",0,1);i+=c(p,true);i+='"\n class="';var m={};var g=[];g.push("");m.params=g;var v=d(a,e,m,"getBaseCssClasses",2);i+=c(v,true);i+="\n";var b={};var y=[];var S=f(a,e,"elCls",0,3);y.push(S);b.params=y;b.fn=function(e){var t="";t+="\n ";var n=h(a,e,{},".",0,4);t+=c(n,true);t+="  \n";return t};i+=l(a,e,b,"each",3);i+='\n"\n\n';var T={};var C=[];var _=f(a,e,"elAttrs",0,8);C.push(_);T.params=C;T.fn=function(e){var t="";t+=" \n ";var n=h(a,e,{},"xindex",0,9);t+=c(n,true);t+='="';var r=h(a,e,{},".",0,9);t+=c(r,true);t+='"\n';return t};i+=l(a,e,T,"each",8);i+='\n\nstyle="\n';var x={};var E=[];var I=f(a,e,"elStyle",0,13);E.push(I);x.params=E;x.fn=function(e){var t="";t+=" \n ";var n=h(a,e,{},"xindex",0,14);t+=c(n,true);t+=":";var r=h(a,e,{},".",0,14);t+=c(r,true);t+=";\n";return t};i+=l(a,e,x,"each",13);i+='\n">';return i}});KISSY.add("component/control/render",["node","xtemplate/runtime","./process","./render-xtpl","component/manager"],function(e,t){var n=t("node");var r=t("xtemplate/runtime");var i=t("./process");var o=t("./render-xtpl");var a=t("component/manager");var s="_onSet",u=e.trim,l=n.all,c=e.UA,f=o,d="</div>",h=e.Env.host.document,p="HTML_PARSER";function m(e){if(typeof e==="number"){e+="px"}return e}function g(t,n,r){var i=this,o,a,s;for(o in n){a=n[o];if(typeof a==="function"){s=a.call(i,t);if(s!==undefined){r.setInternal(o,s)}}else{if(typeof a==="string"){r.setInternal(o,t.one(a))}else{if(e.isArray(a)&&a[0]){r.setInternal(o,t.all(a[0]))}}}}}function v(e){if(!e){e=[""]}if(typeof e==="string"){e=e.split(/\s+/)}return e}function b(e,t,n){var r="",i=0,o=n.length,a,s=e+t;for(;i<o;i++){a=n[i];a=a?"-"+a:a;r+=" "+s+a}return r}function y(e){var t=this,n;if(e.target===t.control){n=t[s+e.type.slice(5).slice(0,-6)];n.call(t,e.newVal,e)}}function S(){return this.config.view.getBaseCssClasses(arguments[1].params[0])}function T(){return this.config.view.getBaseCssClass(arguments[1].params[0])}function C(t,n){var r=t.split(/\s+/);var i=[];for(var o=0,a=r.length;o<a;o++){var s=e.trim(r[o]);if(s&&e.startsWith(s,n)){i.push(s.substring(n.length))}}return i.join(" ")}return i.extend({isRender:true,createInternal:function(){var e=this,t=e.control.get("srcNode");if(t){e.decorateDom(t)}else{e.callSuper()}},beforeCreateDom:function(e){var t=this,n=t.control,r,i,o,a=n.get("elAttrs"),s=n.get("elCls"),u,l=n.getAttrs(),f,d,h=n.get("elStyle"),p,g=n.get("elCls");for(f in l){d=l[f];if(d.view){e[f]=n.get(f)}}r=e.width;i=e.height;o=e.visible;p=e.zIndex;if(r){h.width=m(r)}if(i){h.height=m(i)}if(p){h["z-index"]=p}if(!o){g.push(t.getBaseCssClasses("hidden"))}if(u=n.get("disabled")){s.push(t.getBaseCssClasses("disabled"));a["aria-disabled"]="true"}if(n.get("highlighted")){s.push(t.getBaseCssClasses("hover"))}if(n.get("focusable")){if(c.ieMode<9){a.hideFocus="true"}a.tabindex=u?"-1":"0"}},createDom:function(){var e=this;e.beforeCreateDom(e.renderData={},e.childrenElSelectors={},e.renderCommands={getBaseCssClasses:S,getBaseCssClass:T});var t=e.control,n;n=e.renderTpl(f)+e.renderTpl(e.get("contentTpl"))+d;t.setInternal("el",e.$el=l(n));e.el=e.$el[0];e.fillChildrenElsBySelectors()},decorateDom:function(e){var t=this,n=t.control;if(!e.attr("id")){e.attr("id",n.get("id"))}g.call(t,e,t.constructor.HTML_PARSER,n);n.setInternal("el",t.$el=e);t.el=e[0]},renderUI:function(){var e=this,t=e.control,n=e.$el;if(!t.get("srcNode")){var r=t.get("render"),i=t.get("elBefore");if(i){n.insertBefore(i,undefined)}else{if(r){n.appendTo(r,undefined)}else{n.appendTo(h.body,undefined)}}}},bindUI:function(){var t=this;var n=t.control;var r=n.getAttrs();var i,o;for(i in r){o=r[i];var a=e.ucfirst(i);var u=t[s+a];if(o.view&&u){n.on("after"+a+"Change",y,t)}}},destructor:function(){if(this.$el){this.$el.remove()}},$:function(e){return this.$el.all(e)},fillChildrenElsBySelectors:function(t){var n=this,r=n.$el,i=n.control,o,a;t=t||n.childrenElSelectors;for(o in t){a=t[o];if(typeof a==="function"){i.setInternal(o,a(r))}else{i.setInternal(o,n.$(e.substitute(a,n.renderData)))}delete t[o]}},renderTpl:function(e,t,n){var r=this;t=t||r.renderData;n=n||r.renderCommands;var i=r.get("xtemplate");return new i(e,{control:r.control,view:r,commands:n}).render(t)},getComponentConstructorByNode:function(e,t){var n=t[0].className;if(n){var r=C(n,e);return a.getConstructorByXClass(r)}return null},getComponentCssClasses:function(){var e=this;if(e.componentCssClasses){return e.componentCssClasses}var t=e.control,n=t.constructor,r,i=[];while(n&&!n.prototype.hasOwnProperty("isControl")){r=n.xclass;if(r){i.push(r)}n=n.superclass&&n.superclass.constructor}e.componentCssClasses=i;return i},getBaseCssClasses:function(e){e=v(e);var t=this.getComponentCssClasses(),n=0,r=this.get("control"),i="",o=t.length,a=r.get("prefixCls");for(;n<o;n++){i+=b(a,t[n],e)}return u(i)},getBaseCssClass:function(e){return u(b(this.control.get("prefixCls"),this.getComponentCssClasses()[0],v(e)))},getKeyEventTarget:function(){return this.$el},_onSetWidth:function(e){this.$el.width(e)},_onSetHeight:function(e){this.$el.height(e)},_onSetContent:function(e){var t=this.$el;t.html(e);if(!this.get("allowTextSelection")){t.unselectable()}},_onSetVisible:function(e){var t=this,n=t.$el,r=t.getBaseCssClasses("hidden");if(e){n.removeClass(r)}else{n.addClass(r)}},_onSetHighlighted:function(e){var t=this,n=t.getBaseCssClasses("hover"),r=t.$el;r[e?"addClass":"removeClass"](n)},_onSetDisabled:function(e){var t=this,n=t.control,r=t.getBaseCssClasses("disabled"),i=t.$el;i[e?"addClass":"removeClass"](r).attr("aria-disabled",e);if(n.get("focusable")){t.getKeyEventTarget().attr("tabindex",e?-1:0)}},_onSetActive:function(e){var t=this,n=t.getBaseCssClasses("active");t.$el[e?"addClass":"removeClass"](n).attr("aria-pressed",!!e)},_onSetFocused:function(e){var t=this,n=t.$el,r=t.getBaseCssClasses("focused");n[e?"addClass":"removeClass"](r)},_onSetZIndex:function(e){this.$el.css("z-index",e)}},{__hooks__:{decorateDom:i.prototype.__getHook("__decorateDom"),beforeCreateDom:i.prototype.__getHook("__beforeCreateDom")},extend:function _(t,n,r){var o=this,a,s={};a=i.extend.apply(o,arguments);a[p]=a[p]||{};if(e.isArray(t)){e.each(t.concat(a),function(t){if(t){e.each(t.HTML_PARSER,function(e,t){s[t]=e})}});a[p]=s}e.mix(a[p],o[p],false);a.extend=_;return a},ATTRS:{control:{setter:function(e){this.control=e}},xtemplate:{value:r},contentTpl:{value:function(e){return e.get("content")||""}}},HTML_PARSER:{id:function(e){var t=e[0].id;return t?t:undefined},content:function(e){return e.html()},disabled:function(e){return e.hasClass(this.getBaseCssClass("disabled"))}},name:"render"})});KISSY.add("component/control",["node","./control/process","component/manager","./control/render"],function(e,t){var n=t("node");var r=t("./control/process");var i=t("component/manager");var o=t("./control/render");var a=e.UA.ieMode,s=e.Features,u=n.Gesture,l=s.isTouchGestureSupported();var c=r.extend({isControl:true,createDom:function(){var e=this,t=e.get("xrender"),n=e.get("view"),r=e.get("id"),o;if(n){n.set("control",e)}else{e.set("view",this.view=n=new t({control:e}))}n.create();o=n.getKeyEventTarget();if(!e.get("allowTextSelection")){o.unselectable()}i.addComponent(r,e)},renderUI:function(){this.view.render()},bindUI:function(){var e=this,t=e.view.getKeyEventTarget();if(e.get("focusable")){t.on("focus",e.handleFocus,e).on("blur",e.handleBlur,e).on("keydown",e.handleKeydown,e)}if(e.get("handleMouseEvents")){t=e.$el;t.on("mouseenter",e.handleMouseEnter,e).on("mouseleave",e.handleMouseLeave,e).on("contextmenu",e.handleContextMenu,e);t.on(u.start,e.handleMouseDown,e).on(u.end,e.handleMouseUp,e).on(u.tap,e.handleClick,e);if(u.cancel){t.on(u.cancel,e.handleMouseUp,e)}if(a<9){t.on("dblclick",e.handleDblClick,e)}}},sync:function(){var e=this;e.fire("beforeSyncUI");e.syncUI();e.view.sync();e.__callPluginsMethod("pluginSyncUI");e.fire("afterSyncUI")},createComponent:function(e,t){return i.createComponent(e,t||this)},_onSetFocused:function(e){var t=this.view.getKeyEventTarget()[0];if(e){t.focus()}else{if(t.ownerDocument.activeElement===t){t.ownerDocument.body.focus()}}},_onSetX:function(e){this.$el.offset({left:e})},_onSetY:function(e){this.$el.offset({top:e})},_onSetVisible:function(e){this.fire(e?"show":"hide")},show:function(){var e=this;e.render();e.set("visible",true);return e},hide:function(){var e=this;e.set("visible",false);return e},focus:function(){if(this.get("focusable")){this.set("focused",true)}},blur:function(){if(this.get("focusable")){this.set("focused",false)}},move:function(e,t){this.set({x:e,y:t})},handleDblClick:function(e){if(!this.get("disabled")){this.handleDblClickInternal(e)}},handleDblClickInternal:function(e){this.handleClickInternal(e)},handleMouseEnter:function(e){if(!this.get("disabled")){this.handleMouseEnterInternal(e)}},handleMouseEnterInternal:function(e){this.set("highlighted",!!e)},handleMouseLeave:function(e){if(!this.get("disabled")){this.handleMouseLeaveInternal(e)}},handleMouseLeaveInternal:function(e){var t=this;t.set("active",false);t.set("highlighted",!e)},handleMouseDown:function(e){if(!this.get("disabled")){this.handleMouseDownInternal(e)}},handleMouseDownInternal:function(e){var t=this,n,r=e.which===1;if(r||l){if(t.get("activeable")){t.set("active",true)}if(t.get("focusable")){t.focus()}var i=e.originalEvent.type.toLowerCase();if(!t.get("allowTextSelection")&&(i.indexOf("mouse")!==-1||i.indexOf("pointer")!==-1)){n=e.target.nodeName;n=n&&n.toLowerCase();if(n!=="input"&&n!=="textarea"&&n!=="button"){e.preventDefault()}}}},handleMouseUp:function(e){if(!this.get("disabled")){this.handleMouseUpInternal(e)}},handleMouseUpInternal:function(e){var t=this;if(t.get("active")&&(e.which===1||l)){t.set("active",false)}},handleContextMenu:function(e){if(!this.get("disabled")){this.handleContextMenuInternal(e)}},handleContextMenuInternal:function(){},handleFocus:function(){if(!this.get("disabled")){this.handleFocusInternal()}},handleFocusInternal:function(){this.focus();this.fire("focus")},handleBlur:function(){if(!this.get("disabled")){this.handleBlurInternal()}},handleBlurInternal:function(){this.blur();this.fire("blur")},handleKeydown:function(e){var t=this;if(!this.get("disabled")&&t.handleKeyDownInternal(e)){e.halt();return true}return undefined},handleKeyDownInternal:function(e){if(e.keyCode===n.KeyCode.ENTER){return this.handleClickInternal(e)}return undefined},handleClick:function(e){if(!this.get("disabled")){this.handleClickInternal(e)}},handleClickInternal:function(){var e=this;if(e.get("focusable")){e.focus()}},destructor:function(){var e=this;i.removeComponent(e.get("id"));if(e.view){e.view.destroy()}else{if(e.get("srcNode")){e.get("srcNode").remove()}}}},{name:"control",ATTRS:{id:{view:1,valueFn:function(){return e.guid("ks-component")}},content:{view:1,value:""},width:{view:1},height:{view:1},elCls:{view:1,value:[],setter:function(e){if(typeof e==="string"){e=e.split(/\s+/)}return e||[]}},elStyle:{view:1,value:{}},elAttrs:{view:1,value:{}},elBefore:{},el:{setter:function(e){this.$el=e;this.el=e[0]}},x:{},y:{},xy:{setter:function(t){var n=this,r=e.makeArray(t);if(r.length){if(r[0]!==undefined){n.set("x",r[0])}if(r[1]!==undefined){n.set("y",r[1])}}return t},getter:function(){return[this.get("x"),this.get("y")]}},zIndex:{view:1},render:{},visible:{sync:0,value:true,view:1},srcNode:{setter:function(e){return n.all(e)}},handleMouseEvents:{value:true},focusable:{value:true,view:1},allowTextSelection:{value:false},activeable:{value:true},focused:{view:1},active:{view:1,value:false},highlighted:{view:1,value:false},prefixCls:{view:1,value:e.config("component/prefixCls")||"ks-"},prefixXClass:{},parent:{setter:function(e,t){if(t=this.get("parent")){this.removeTarget(t)}if(e){this.addTarget(e)}}},disabled:{view:1,value:false},xrender:{value:o},view:{setter:function(e){this.view=e}}}});function f(){var e,t=this;do{e=t.ATTRS;t=t.superclass}while(!e||!e.xrender);return e.xrender.value}c.getDefaultRender=f;c.extend=function d(t,n,o){var a=e.makeArray(arguments),s=this,u,l,c=a.length,h=a[c-1];if(u=h.xclass){h.name=u}l=r.extend.apply(s,a);if(u){i.setConstructorByXClass(u,l)}l.extend=d;l.getDefaultRender=f;return l};return c});KISSY.add("component/manager",[],function(e){var t=0,n,r={},i={};n={__instances:i,addComponent:function(e,t){i[e]=t},removeComponent:function(e){delete i[e]},getComponent:function(e){return i[e]},createComponent:function(t,r){var i,o;if(t){if(!t.isControl&&r){if(!t.prefixCls){t.prefixCls=r.get("prefixCls")}if(!t.xclass&&t.prefixXClass){t.xclass=t.prefixXClass;if(t.xtype){t.xclass+="-"+t.xtype}}}if(!t.isControl&&(o=t.xclass)){i=n.getConstructorByXClass(o);if(!i){e.error("can not find class by xclass desc : "+o)}t=new i(t)}if(t.isControl&&r){t.setInternal("parent",r)}}return t},getConstructorByXClass:function(e){var t=e.split(/\s+/),n=-1,i,o,a,s=null;for(o=0;o<t.length;o++){a=r[t[o]];if(a&&(i=a.priority)>n){n=i;s=a.constructor}}return s},setConstructorByXClass:function(e,n){r[e]={constructor:n,priority:t++}}};return n});KISSY.add("xtemplate/runtime/scope",[],function(e){function t(e,t){this.data=e||{};this.affix=t;this.root=this}t.prototype={isScope:1,setParent:function(e){this.parent=e;this.root=e.root},getParent:function(){return this.parent},getRoot:function(){return this.root},set:function(e,t){if(!this.affix){this.affix={}}this.affix[e]=t},setData:function(e){this.data=e},getData:function(){return this.data},mix:function(t){if(!this.affix){this.affix={}}e.mix(this.affix,t)},has:function(e){var t=this.data;var n=this.affix;if(n&&e in n){return true}return typeof t==="object"&&e in t},get:function(e){var t=this.data;var n=this.affix;if(n&&e in n){return n[e]}if(typeof t==="object"&&e in t){return t[e]}return undefined},resolve:function(e,t){if(e==="."){e="this"}var n=e.split(".");var r=this,i,a,o,s,u;if(n[0]==="root"){n.shift();r=r.root}else{if(t){while(r&&t--){r=r.parent}}}var l=0;i=n.length;while(r){u=1;o=r;for(a=0;a<i;a++){s=n[a];if(s==="this"){l=1;continue}if(o===r){if(!r.has(s)){u=0;break}else{o=r.get(s);l=1}}else{if(o==null||typeof o!=="object"||!(s in o)){u=0;break}o=o[s]}}if(u){if(o&&o.isScope){o=o.data}if(typeof o==="function"){o=o.call(this.data)}return[o]}if(l){break}r=r.parent}return false}};return t});KISSY.add("xtemplate/runtime/commands",["path","./scope"],function(e,t){var n;var r=t("path");var i=t("./scope");n={"debugger":e.noop,each:function(t,n){var r=n.params;var a=r[0];var o=r[2]||"xindex";var s=r[1];var u="";var l;var f;var c;if(a){f=new i;if(e.isArray(a)){l=a.length;for(var d=0;d<l;d++){f.data=a[d];c=f.affix={xcount:l};c[o]=d;if(s){c[s]=a[d]}f.setParent(t);u+=n.fn(f)}}else{for(var p in a){f.data=a[p];c=f.affix={};c[o]=p;if(s){c[s]=a[p]}f.setParent(t);u+=n.fn(f)}}}else{if(n.inverse){u=n.inverse(t)}}return u},"with":function(e,t){var n=t.params;var r=n[0];var a="";if(r){var o=new i(r);o.setParent(e);a=t.fn(o)}else{if(t.inverse){a=t.inverse(e)}}return a},"if":function(e,t){var n=t.params;var r=n[0];var i="";if(r){if(t.fn){i=t.fn(e)}}else{if(t.inverse){i=t.inverse(e)}}return i},set:function(e,t){e.mix(t.hash);return""},include:function(t,n){var a=n.params;if(!a||a.length!==1){e.error("include must has one param");return""}if(n.hash){var o=new i(n.hash);o.setParent(t);t=o}var s=this.config.name;var u=a[0];if(u.charAt(0)==="."){if(s==="unspecified"){e.error("parent template does not have name"+" for relative sub tpl name: "+u);return""}u=r.resolve(s,"../",u)}var l=this.config.loader.call(this,u);n=e.merge(this.config);n.name=u;n.commands=this.config.commands;n.macros=this.config.macros;return this.invokeEngine(l,t,n)},macro:function(t,n){var r=n.params;var a=r[0];var o=r.slice(1);var s=this.config.macros;if(n.fn){if(!s[a]){s[a]={paramNames:o,fn:n.fn}}}else{var u={};var l=s[a];if(!l){e.error("can not find macro:"+name)}e.each(l.paramNames,function(e,t){u[e]=o[t]});var f=new i(u);return l.fn.call(this,f)}return""},parse:function(e,t){return n.include.call(this,new i,t)}};if(""){n["debugger"]=function(){e.globalEval("debugger")}}return n});KISSY.add("xtemplate/runtime",["./runtime/commands","./runtime/scope"],function(e,t){var n=t("./runtime/commands");var r=t("./runtime/scope");var i=e.escapeHtml;var a=e.getLogger("s/xtemplate");function o(e){a.info(e)}function s(e,t){var n=t.split(".");var r=e;var i=n.length;for(var a=0;a<i;a++){r=r[n[a]];if(!r){break}}return r}function u(t,n,r,i,a,o){var u;var l=t.config;var f=l.commands;var c=s(f,i);if(c){try{u=c.call(t,n,r)}catch(d){e.error(d.message+': "'+i+'" at line '+a)}return{find:true,value:u}}else{if(o){e.error("can not find command: "+i+'" at line '+a)}}return{find:false}}function l(t,n,r,i,a){var s;var u=t.config;var l=u.silent?o:e.error;var f=n.resolve(r,i);if(f===false){l('can not find property: "'+r+'" at line '+a,"warn")}else{s=f[0]}return s}var f={runBlockCommand:function(t,n,r,i,a){var u=t.config;var l=u.silent?o:e.error;var f=u.commands;var c=s(f,i);if(!c){if(!r.params&&!r.hash){var d=n.resolve(i);if(d===false){l('can not find property: "'+i+'" at line '+a);d=""}else{d=d[0]}c=f["if"];if(e.isArray(d)){c=f.each}else{if(typeof d==="object"){c=f["with"]}}r.params=[d]}else{e.error("can not find command: "+i+'" at line '+a);return""}}var p;try{p=c.call(t,n,r)}catch(h){e.error(h.message+': "'+i+'" at line '+a)}return p},renderOutput:function(e,t){if(e===undefined){e=""}return t&&e?i(e):e},getProperty:function(e,t,n,r,i){return l(e,t,n,r,i)},runInlineCommand:function(e,t,n,r,i){var a="",o;o=u(e,t,n,r,i);if(o.find){a=o.value}return a},getPropertyOrRunCommand:function(e,t,n,r,i,a){var o,s;var f=n.hash||n.params;s=u(e,t,n,r,a,f);if(s.find){o=s.value}else{if(!f){o=l(e,t,r,i,a)}}return o}},c={silent:true,name:"unspecified",loader:function(t){var n=e.require(t);if(!n){e.error('template "'+t+'" does not exist, '+"need to be required or used first!")}return n}};function d(t,r){var i=this;i.tpl=t;r=e.merge(c,r);r.commands=e.merge(r.commands,n);r.utils=f;r.macros=r.macros||{};this.config=r}e.mix(d,{commands:n,utils:f,addCommand:function(e,t){n[e]=t},removeCommand:function(e){delete n[e]}});d.prototype={constructor:d,invokeEngine:function(e,t,n){return new this.constructor(e,n).render(t,true)},removeCommand:function(e){delete this.config.commands[e]},addCommand:function(e,t){this.config.commands[e]=t},render:function(t){var n=t;if(!(n&&n.isScope)){n=new r(t)}return this.tpl(n,e)}};d.Scope=r;return d});KISSY.add("menu/menu-render",["component/container"],function(e,t){var n=t("component/container");return n.getDefaultRender().extend({beforeCreateDom:function(e){e.elAttrs.role="menu"},containsElement:function(e){var t=this.$el;return t&&(t[0]===e||t.contains(e))}})});KISSY.add("menu/control",["node","component/container","component/extension/delegate-children","./menu-render"],function(e,t){var n=t("node");var r=t("component/container");var i=t("component/extension/delegate-children");var o=t("./menu-render");var a=n.KeyCode;return r.extend([i],{isMenu:1,_onSetHighlightedItem:function(e,t){var n;if(e&&t&&(n=t.prevVal)){n.set("highlighted",false,{data:{byPassSetHighlightedItem:1}})}},_onSetVisible:function(e,t){this.callSuper(t);var n;if(!e&&(n=this.get("highlightedItem"))){n.set("highlighted",false)}},bindUI:function(){var e=this;e.on("afterHighlightedItemChange",s,e)},getRootMenu:function(){return this},handleMouseEnterInternal:function(e){this.callSuper(e);var t=this.getRootMenu();if(t&&t._popupAutoHideTimer){clearTimeout(t._popupAutoHideTimer);t._popupAutoHideTimer=null}},handleBlurInternal:function(e){this.callSuper(e);var t;if(t=this.get("highlightedItem")){t.set("highlighted",false)}},_getNextEnabledHighlighted:function(e,t){var n=this.get("children"),r=n.length,i=e;do{var o=n[e];if(!o.get("disabled")&&o.get("visible")!==false){return n[e]}e=(e+t+r)%r}while(e!==i);return undefined},handleKeyDownInternal:function(t){var n=this;var r=n.get("highlightedItem");if(r&&r.handleKeyDownInternal(t)){return true}var i=n.get("children"),o=i.length;if(o===0){return undefined}var s,u,l;switch(t.keyCode){case a.ESC:if(r=n.get("highlightedItem")){r.set("highlighted",false)}break;case a.HOME:l=n._getNextEnabledHighlighted(0,1);break;case a.END:l=n._getNextEnabledHighlighted(o-1,-1);break;case a.UP:if(!r){u=o-1}else{s=e.indexOf(r,i);u=(s-1+o)%o}l=n._getNextEnabledHighlighted(u,-1);break;case a.DOWN:if(!r){u=0}else{s=e.indexOf(r,i);u=(s+1+o)%o}l=n._getNextEnabledHighlighted(u,1);break}if(l){l.set("highlighted",true,{data:{fromKeyboard:1}});return true}else{return undefined}},containsElement:function(e){var t=this;if(!t.get("visible")||!t.$el){return false}if(t.view.containsElement(e)){return true}var n=t.get("children");for(var r=0,i=n.length;r<i;r++){var o=n[r];if(o.containsElement&&o.containsElement(e)){return true}}return false}},{ATTRS:{highlightedItem:{value:null},xrender:{value:o},defaultChildCfg:{value:{xclass:"menuitem"}}},xclass:"menu"});function s(e){if(e.target.isMenu){var t=this.el,n=e.newVal;t.setAttribute("aria-activedescendant",n&&n.el.id||"")}}});KISSY.add("menu/menuitem-render",["component/control"],function(e,t){var n=t("component/control");return n.getDefaultRender().extend({beforeCreateDom:function(e){e.elAttrs.role=e.selectable?"menuitemradio":"menuitem";if(e.selected){e.elCls.push(this.getBaseCssClasses("selected"))}},_onSetSelected:function(e){var t=this,n=t.getBaseCssClasses("selected");t.$el[e?"addClass":"removeClass"](n)},containsElement:function(e){var t=this.$el;return t&&(t[0]===e||t.contains(e))}},{HTML_PARSER:{selectable:function(e){return e.hasClass(this.getBaseCssClass("selectable"))}}})});KISSY.add("menu/menuitem",["component/control","./menuitem-render","node"],function(e,t){var n=t("component/control");var r=t("./menuitem-render");var i=t("node").all;return n.extend({isMenuItem:1,handleClickInternal:function(){var e=this;e.callSuper();if(e.get("selectable")){e.set("selected",true)}e.fire("click");return true},_onSetHighlighted:function(e,t){var n=this,r=n.get("parent");if(!(t&&t.byPassSetHighlightedItem)){if(n.get("rendered")){r.set("highlightedItem",e?n:null)}else{if(e){r.set("highlightedItem",n)}}}if(e){var o=n.$el,a=o.parent(function(e){return i(e).css("overflow")!=="visible"},r.get("el").parent());if(!a){return}o.scrollIntoView(a,{alignWithTop:true,allowHorizontalScroll:true,onlyScrollIfNeeded:true})}},containsElement:function(e){return this.view.containsElement(e)}},{ATTRS:{focusable:{value:false},handleMouseEvents:{value:false},selectable:{view:1},value:{},selected:{view:1},xrender:{value:r}},xclass:"menuitem"})});KISSY.add("menu/check-menuitem-xtpl",["component/extension/content-xtpl"],function(e,t,n,r){return function(e,n,i){var o="",a=this.config,s=this,u,l=a.utils;if(typeof r!=="undefined"&&r.kissy){u=r}var c=l.runBlockCommand,f=l.renderOutput,d=l.getProperty,p=l.runInlineCommand,h=l.getPropertyOrRunCommand;o+='<div class="';var m={};var g=[];g.push("checkbox");m.params=g;var v=p(s,e,m,"getBaseCssClasses",1);o+=f(v,true);o+='">\n</div>\n';var b={};var T=[];T.push("component/extension/content-xtpl");b.params=T;if(u){t("component/extension/content-xtpl");b.params[0]=u.resolveByName(b.params[0])}var y=p(s,e,b,"include",3);o+=f(y,false);return o}});KISSY.add("menu/check-menuitem-render",["./menuitem-render","component/extension/content-render","./check-menuitem-xtpl"],function(e,t){var n=t("./menuitem-render");var r=t("component/extension/content-render");var i=t("./check-menuitem-xtpl");return n.extend([r],{beforeCreateDom:function(e){if(e.checked){e.elCls.push(this.getBaseCssClasses("checked"))}},_onSetChecked:function(e){var t=this,n=t.getBaseCssClasses("checked");t.$el[e?"addClass":"removeClass"](n)}},{ATTRS:{contentTpl:{value:i}}})});KISSY.add("menu/check-menuitem",["./menuitem","./check-menuitem-render"],function(e,t){var n=t("./menuitem");var r=t("./check-menuitem-render");return n.extend({handleClickInternal:function(){var e=this;e.callSuper();e.set("checked",!e.get("checked"));e.fire("click");return true}},{ATTRS:{checked:{view:1},xrender:{value:r}},xclass:"check-menuitem"})});KISSY.add("menu/submenu-xtpl",[],function(e,t,n,r){return function(e,t,n){var i="",o=this.config,a=this,s,u=o.utils;if(typeof r!=="undefined"&&r.kissy){s=r}var l=u.runBlockCommand,c=u.renderOutput,f=u.getProperty,d=u.runInlineCommand,p=u.getPropertyOrRunCommand;i+='<div id="ks-content-';var h=p(a,e,{},"id",0,1);i+=c(h,true);i+='"\n     class="';var m={};var g=[];g.push("content");m.params=g;var v=d(a,e,m,"getBaseCssClasses",2);i+=c(v,true);i+='">';var b=p(a,e,{},"content",0,2);i+=c(b,false);i+='</div>\n<span class="';var T=p(a,e,{},"prefixCls",0,3);i+=c(T,true);i+='submenu-arrow">\u25ba</span>';return i}});KISSY.add("menu/submenu-render",["./submenu-xtpl","./menuitem-render","component/extension/content-render"],function(e,t){var n=t("./submenu-xtpl");var r=t("./menuitem-render");var i=t("component/extension/content-render");return r.extend([i],{decorateDom:function(e){var t=this.control,n=t.get("prefixCls");var r=e.one("."+n+"popupmenu");var i=r[0].ownerDocument.body;i.insertBefore(r[0],i.firstChild);var o=this.getComponentConstructorByNode(n,r);t.setInternal("menu",new o({srcNode:r,prefixCls:n}))}},{ATTRS:{contentTpl:{value:n}}})});KISSY.add("menu/submenu",["node","./menuitem","./submenu-render"],function(e,t){var n=t("node");var r=t("./menuitem");var i=t("./submenu-render");var o=n.KeyCode,a=.15;function s(e){var t=e.target,n=this;if(t!==n&&t.isMenuItem&&e.newVal){n.clearHidePopupMenuTimers();if(!n.get("highlighted")){n.set("highlighted",true);t.set("highlighted",false);t.set("highlighted",true)}}}return r.extend({isSubMenu:1,clearShowPopupMenuTimers:function(){var e;if(e=this._showTimer){e.cancel();this._showTimer=null}},clearHidePopupMenuTimers:function(){var e;if(e=this._dismissTimer){e.cancel();this._dismissTimer=null}},clearSubMenuTimers:function(){this.clearHidePopupMenuTimers();this.clearShowPopupMenuTimers()},bindUI:function(){var e=this;e.on("afterHighlightedChange",s,e)},handleMouseLeaveInternal:function(){var t=this;t.set("highlighted",false,{data:{fromMouse:1}});t.clearSubMenuTimers();var n=t.get("menu");if(n.get("visible")){t._dismissTimer=e.later(l,t.get("menuDelay")*1e3,false,t)}},handleMouseEnterInternal:function(){var t=this;t.set("highlighted",true,{data:{fromMouse:1}});t.clearSubMenuTimers();var n=t.get("menu");if(!n.get("visible")){t._showTimer=e.later(u,t.get("menuDelay")*1e3,false,t)}},_onSetHighlighted:function(e,t){var n=this;if(!t){return}n.callSuper(t);if(t.fromMouse){return}if(e&&!t.fromKeyboard){u.call(n)}else{if(!e){l.call(n)}}},handleClickInternal:function(){var e=this;u.call(e);e.callSuper()},handleKeyDownInternal:function(e){var t=this,n=t.get("menu"),r,i,a=n.get("visible"),s=e.keyCode;if(!a){if(s===o.RIGHT){u.call(t);r=n.get("children");if(i=r[0]){i.set("highlighted",true,{data:{fromKeyboard:1}})}}else{if(s===o.ENTER){return t.handleClickInternal(e)}else{return undefined}}}else{if(!n.handleKeyDownInternal(e)){if(s===o.LEFT){t.set("highlighted",false);t.set("highlighted",true,{data:{fromKeyboard:1}})}else{return undefined}}}return true},containsElement:function(e){return this.get("menu").containsElement(e)},destructor:function(){var e=this,t=e.get("menu");e.clearSubMenuTimers();t.destroy()}},{ATTRS:{menuDelay:{value:a},menu:{value:{},getter:function(e){if(!e.isControl){e.xclass=e.xclass||"popupmenu";e=this.createComponent(e);this.setInternal("menu",e)}return e},setter:function(e){if(e.isControl){e.setInternal("parent",this)}}},xrender:{value:i}},xclass:"submenu"});function u(){var t=this,n=t.get("menu");var r={node:this.$el,points:["tr","tl"],overflow:{adjustX:1,adjustY:1}};e.mix(n.get("align"),r,false);n.show();t.el.setAttribute("aria-haspopup",n.get("el").attr("id"))}function l(){this.get("menu").hide()}});KISSY.add("menu/popupmenu-render",["component/extension/content-render","./menu-render"],function(e,t){var n=t("component/extension/content-render");var r=t("./menu-render");return r.extend([n])});KISSY.add("menu/popupmenu",["component/extension/align","component/extension/shim","./control","./popupmenu-render"],function(e,t){var n=t("component/extension/align");var r=t("component/extension/shim");var i=t("./control");var o=t("./popupmenu-render");return i.extend([r,n],{getRootMenu:function(){var e=this,t;do{t=e;e=e.get("parent")}while(e&&(e.isMenuItem||e.isMenu));return t===this?null:t},handleMouseLeaveInternal:function(e){this.callSuper(e);if(this.get("autoHideOnMouseLeave")){var t=this.getRootMenu();if(t){clearTimeout(t._popupAutoHideTimer);t._popupAutoHideTimer=setTimeout(function(){var e;if(e=t.get("highlightedItem")){e.set("highlighted",false)}},this.get("parent").get("menuDelay")*1e3)}}},isPopupMenu:1,handleBlurInternal:function(e){var t=this;t.callSuper(e);t.hide()}},{ATTRS:{focusable:{value:false},autoHideOnMouseLeave:{},contentEl:{},visible:{value:false},xrender:{value:o}},xclass:"popupmenu"})});KISSY.add("menu",["menu/control","menu/menuitem","menu/check-menuitem","menu/submenu","menu/popupmenu"],function(e,t){var n=t("menu/control");var r=t("menu/menuitem");var i=t("menu/check-menuitem");var o=t("menu/submenu");var a=t("menu/popupmenu");n.Item=r;n.CheckItem=i;n.SubMenu=o;n.PopupMenu=a;return n});KISSY.add("component/container/render",["component/control","component/manager"],function(e,t){var n=t("component/control");var r=t("component/manager");return n.getDefaultRender().extend([],{decorateDom:function(){var t=this,n=t.getChildrenContainerEl(),i=t.control,o=i.get("defaultChildCfg"),a=o.prefixCls,s=o.xclass,u=[],l=n.children();l.each(function(n){var i=t.getComponentConstructorByNode(a,n)||s&&r.getConstructorByXClass(s);if(i){u.push(new i(e.merge(o,{srcNode:n})))}});i.set("children",u)},getChildrenContainerEl:function(){return this.$el}},{name:"ContainerRender"})});KISSY.add("component/container",["component/control","./container/render"],function(e,t){var n=t("component/control");var r=t("./container/render");function i(e){var t=this;if(e.target!==t){return}var n=e.component,r=t.get("children"),i=e.index;r.splice(i,0,n);r=t.get("children");n=r[i];n.setInternal("parent",t);if(t.get("rendered")){t.renderChild(i)}t.fire("afterAddChild",{component:n,index:i})}function o(e){var t=this;if(e.target!==t){return}var n=e.component,r,i,o=e.destroy,a=t.get("children"),s=e.index;if(s!==-1){a.splice(s,1)}n.setInternal("parent",null);if(o){if(n.destroy){n.destroy()}}else{if(n.get&&(i=n.el)){if(r=i.parentNode){r.removeChild(i)}}}t.fire("afterRemoveChild",{component:n,index:s})}return n.extend({isContainer:true,initializer:function(){var e=this,t=e.get("prefixCls"),n=e.get("defaultChildCfg");e.publish("beforeAddChild",{defaultFn:i});e.publish("beforeRemoveChild",{defaultFn:o});n.prefixCls=n.prefixCls||t},createDom:function(){this.createChildren()},renderUI:function(){this.renderChildren()},renderChildren:function(){var e,t=this,n=t.get("children");for(e=0;e<n.length;e++){t.renderChild(e)}},createChildren:function(){var e,t=this,n=t.get("children");for(e=0;e<n.length;e++){t.createChild(e)}},addChild:function(e,t){var n=this,r=n.get("children");if(t===undefined){t=r.length}n.fire("beforeAddChild",{component:e,index:t})},renderChild:function(e){var t=this,n=t.get("children");t.createChild(e).render();t.fire("afterRenderChild",{component:n[e],index:e})},createChild:function(e){var t=this,n,r,i,o=t.get("children"),a,s;n=o[e];s=t.view.getChildrenContainerEl();i=s[0];r=i.children[e]||null;if(n.get("rendered")){a=n.el;if(a.parentNode!==i){i.insertBefore(a,r)}}else{if(r){n.set("elBefore",r)}else{n.set("render",s)}n.create()}t.fire("afterCreateChild",{component:n,index:e});return n},removeChild:function(t,n){if(n===undefined){n=true}this.fire("beforeRemoveChild",{component:t,index:e.indexOf(t,this.get("children")),destroy:n})},removeChildren:function(e){var t=this,n,r=[].concat(t.get("children"));for(n=0;n<r.length;n++){t.removeChild(r[n],e)}return t},getChildAt:function(e){var t=this.get("children");return t[e]||null},destructor:function(){var e,t=this.get("children");for(e=0;e<t.length;e++){if(t[e].destroy){t[e].destroy()}}}},{ATTRS:{children:{value:[],getter:function(t){var n=null,r,i,o=this;for(r=0;r<t.length;r++){i=t[r];if(!i.isControl){n=n||o.get("defaultChildCfg");e.mix(i,n,false);t[r]=this.createComponent(i)}}return t},setter:function(e){var t,n;for(t=0;t<e.length;t++){n=e[t];if(n.isControl){n.setInternal("parent",this)}}}},defaultChildCfg:{value:{}},xrender:{value:r}},name:"container"})});KISSY.add("component/extension/delegate-children",["node","component/manager"],function(e,t){var n=t("node"),r=t("component/manager");var i=e.UA,a=i.ieMode,o=e.Features,s=n.Gesture,u=o.isTouchEventSupported();function l(e){if(e.target===this){var t=e.component,n=t.$el;n.addClass(this.__childClsTag)}}function f(e){if(e.target===this){var t=e.component,n=t.$el;if(n){n.removeClass(this.__childClsTag)}}}function c(){var t=this;t.__childClsTag=e.guid("ks-component-child");t.on("afterRenderChild",l,t).on("afterRemoveChild",f,t)}e.augment(c,{handleChildrenEvents:function(t){if(!this.get("disabled")){var n=this.getOwnerControl(t);if(n&&!n.get("disabled")){t.stopPropagation();switch(t.type){case s.start:n.handleMouseDown(t);break;case s.end:n.handleMouseUp(t);break;case s.tap:n.handleClick(t);break;case"mouseenter":n.handleMouseEnter(t);break;case"mouseleave":n.handleMouseLeave(t);break;case"contextmenu":n.handleContextMenu(t);break;case"dblclick":n.handleDblClick(t);break;default:e.error(t.type+" unhandled!")}}}},__bindUI:function(){var e=this,t=s.start+" "+s.end+" "+s.tap;if(s.cancel){t+=" "+s.cancel}t+=" mouseenter mouseleave contextmenu "+(a&&a<9?"dblclick ":"");e.$el.delegate(t,"."+e.__childClsTag,e.handleChildrenEvents,e)},getOwnerControl:function(e){return r.getComponent(e.currentTarget.id)}});return c});KISSY.add("component/extension/content-render",["component/extension/content-xtpl"],function(e,t){var n=t("component/extension/content-xtpl");function r(e){var t=e.control;var n=t.get("contentEl");e.$contentEl=t.$contentEl=n;e.contentEl=t.contentEl=n[0]}function i(){}i.prototype={__beforeCreateDom:function(t,n){e.mix(n,{contentEl:"#ks-content-{id}"})},__createDom:function(){r(this)},__decorateDom:function(){r(this)},getChildrenContainerEl:function(){return this.control.get("contentEl")},_onSetContent:function(e){var t=this.control,n=t.$contentEl;n.html(e);if(!t.get("allowTextSelection")){n.unselectable()}}};e.mix(i,{ATTRS:{contentTpl:{value:n}},HTML_PARSER:{content:function(e){return e.one("."+this.getBaseCssClass("content")).html()},contentEl:function(e){return e.one("."+this.getBaseCssClass("content"))}}});return i});KISSY.add("component/extension/content-xtpl",[],function(e,t,n,r){return function(e,t,n){var i="",a=this.config,o=this,s,u=a.utils;if(typeof r!=="undefined"&&r.kissy){s=r}var l=u.runBlockCommand,f=u.renderOutput,c=u.getProperty,d=u.runInlineCommand,h=u.getPropertyOrRunCommand;i+='<div id="ks-content-';var p=h(o,e,{},"id",0,1);i+=f(p,true);i+='"\n           class="';var v={};var m=[];m.push("content");v.params=m;var g=d(o,e,v,"getBaseCssClasses",2);i+=f(g,true);i+='">';var b=h(o,e,{},"content",0,2);i+=f(b,false);i+="</div>";return i}});KISSY.add("component/extension/align",["node"],function(e,t){var n=t("node");var r=e.Env.host,i=n.all,a=e.UA;function o(e){var t=e.ownerDocument,n=t.body,r,a=i(e).css("position"),o=a==="fixed"||a==="absolute";if(!o){return e.nodeName.toLowerCase()==="html"?null:e.parentNode}for(r=e.parentNode;r&&r!==n;r=r.parentNode){a=i(r).css("position");if(a!=="static"){return r}}return null}function s(e){var t={left:0,right:Infinity,top:0,bottom:Infinity},n,r,s,u,l=e.ownerDocument,f=i(l).getWindow(),c=l.body,d=l.documentElement;for(n=e;n=o(n);){if((!a.ie||n.clientWidth!==0)&&n!==c&&n!==d&&i(n).css("overflow")!=="visible"){var h=i(n).offset();h.left+=n.clientLeft;h.top+=n.clientTop;t.top=Math.max(t.top,h.top);t.right=Math.min(t.right,h.left+n.clientWidth);t.bottom=Math.min(t.bottom,h.top+n.clientHeight);t.left=Math.max(t.left,h.left)}}r=f.scrollLeft();s=f.scrollTop();t.left=Math.max(t.left,r);t.top=Math.max(t.top,s);u={width:f.width(),height:f.height()};t.right=Math.min(t.right,r+u.width);t.bottom=Math.min(t.bottom,s+u.height);return t.top>=0&&t.left>=0&&t.bottom>t.top&&t.right>t.left?t:null}function u(e,t,n,r){var i,a,o,s;i={left:e.left,top:e.top};o=m(t,n[0]);s=m(e,n[1]);a=[s.left-o.left,s.top-o.top];return{left:i.left-a[0]+ +r[0],top:i.top-a[1]+ +r[1]}}function l(e,t,n){return e.left<n.left||e.left+t.width>n.right}function f(e,t,n){return e.top<n.top||e.top+t.height>n.bottom}function c(t,n,r,i){var a=e.clone(t),o={width:n.width,height:n.height};if(i.adjustX&&a.left<r.left){a.left=r.left}if(i.resizeWidth&&a.left>=r.left&&a.left+o.width>r.right){o.width-=a.left+o.width-r.right}if(i.adjustX&&a.left+o.width>r.right){a.left=Math.max(r.right-o.width,r.left)}if(i.adjustY&&a.top<r.top){a.top=r.top}if(i.resizeHeight&&a.top>=r.top&&a.top+o.height>r.bottom){o.height-=a.top+o.height-r.bottom}if(i.adjustY&&a.top+o.height>r.bottom){a.top=Math.max(r.bottom-o.height,r.top)}return e.mix(a,o)}function d(t,n,r){var i=[];e.each(t,function(e){i.push(e.replace(n,function(e){return r[e]}))});return i}function h(e,t){e[t]=-e[t];return e}function p(){}p.__getOffsetParent=o;p.__getVisibleRectForElement=s;p.ATTRS={align:{value:{}}};function v(t){var n,r,a,o=t[0];if(!e.isWindow(o)){n=t.offset();r=t.outerWidth();a=t.outerHeight()}else{var s=i(o).getWindow();n={left:s.scrollLeft(),top:s.scrollTop()};r=s.width();a=s.height()}n.width=r;n.height=a;return n}function m(e,t){var n=t.charAt(0),r=t.charAt(1),i=e.width,a=e.height,o,s;o=e.left;s=e.top;if(n==="c"){s+=a/2}else{if(n==="b"){s+=a}}if(r==="c"){o+=i/2}else{if(r==="r"){o+=i}}return{left:o,top:s}}function g(e){if(e.target===this&&e.newVal){y.call(this)}}function b(){if(this.get("visible")){y.call(this)}}function y(){this._onSetAlign(this.get("align"))}p.prototype={__bindUI:function(){var e=this;e.on("beforeVisibleChange",g,e);e.$el.getWindow().on("resize",b,e)},_onSetAlign:function(e){if(e&&e.points){this.align(e.node,e.points,e.offset,e.overflow)}},align:function(t,i,a,o){t=n.one(t||r);a=a&&[].concat(a)||[0,0];o=o||{};var p=this,m=p.$el,g=0;var b=s(m[0]);var y=v(m);var S=v(t);var T=u(y,S,i,a);var x=e.merge(y,T);if(b&&(o.adjustX||o.adjustY)){if(l(T,y,b)){g=1;i=d(i,/[lr]/gi,{l:"r",r:"l"});a=h(a,0)}if(f(T,y,b)){g=1;i=d(i,/[tb]/gi,{t:"b",b:"t"});a=h(a,1)}if(g){T=u(y,S,i,a);e.mix(x,T)}var C={};C.adjustX=o.adjustX&&l(T,y,b);C.adjustY=o.adjustY&&f(T,y,b);if(C.adjustX||C.adjustY){x=c(T,y,b,C)}}p.set({x:x.left,y:x.top},{force:1});if(x.width!==y.width){p.set("width",m.width()+x.width-y.width)}if(x.height!==y.height){p.set("height",m.height()+x.height-y.height)}return p},center:function(e){var t=this;t.set("align",{node:e,points:["cc","cc"],offset:[0,0]});return t},__destructor:function(){var e=this;if(e.$el){e.$el.getWindow().detach("resize",b,e)}}};return p});KISSY.add("component/extension/shim",[],function(e){var t=e.UA.ie===6;var n="<"+'iframe style="position: absolute;'+"border: none;"+"width: "+(t?"expression(this.parentNode.clientWidth)":"100%")+";"+"top: 0;"+"opacity: 0;"+"filter: alpha(opacity=0);"+"left: 0;"+"z-index: -1;"+"height: "+(t?"expression(this.parentNode.clientHeight)":"100%")+";"+'"/>';function r(){}r.ATTRS={shim:{value:t}};r.prototype.__createDom=function(){if(this.get("shim")){this.get("el").prepend(n)}};return r});KISSY.add("cookie",[],function(e){var t=e.Env.host.document,n=24*60*60*1e3,r=encodeURIComponent,i=e.urlDecode;function a(e){return typeof e==="string"&&e!==""}e.Cookie={get:function(e){var n,r;if(a(e)){if(r=String(t.cookie).match(new RegExp("(?:^| )"+e+"(?:(?:=([^;]*))|;|$)"))){n=r[1]?i(r[1]):""}}return n},set:function(e,i,o,s,u,l){var f=String(r(i)),c=o;if(typeof c==="number"){c=new Date;c.setTime(c.getTime()+o*n)}if(c instanceof Date){f+="; expires="+c.toUTCString()}if(a(s)){f+="; domain="+s}if(a(u)){f+="; path="+u}if(l){f+="; secure"}t.cookie=e+"="+f},remove:function(e,t,n,r){this.set(e,"",-1,t,n,r)}};return e.Cookie});