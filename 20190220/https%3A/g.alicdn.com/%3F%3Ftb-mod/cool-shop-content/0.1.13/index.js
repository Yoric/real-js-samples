KISSY.add("tb-mod/cool-shop-content/0.1.13/shop-list-xtpl",function(a,e,o,t){var n=t.exports=function(a){function e(a,e,o){var t=a.data,n=a.affix;e.data+='\n            <img class="shop-logo" src="',u.line=10;var s=(d=n.banner)!==o?null!=d?X=d.shopLogoUrl:d:(d=t.banner)!==o?null!=d?X=d.shopLogoUrl:d:a.resolveLooseUp(["banner","shopLogoUrl"]);e=e.writeEscaped(s),e.data+='_40x40.jpg" width="40" height="40" alt="';var i=(d=n.banner)!==o?null!=d?X=d.shopName:d:(d=t.banner)!==o?null!=d?X=d.shopName:d:a.resolveLooseUp(["banner","shopName"]);return e=e.writeEscaped(i),e.data+='"/>\n            ',e}function o(a,e,o){var t=a.data,n=a.affix;e.data+='\n            <img class="shop-logo" src="//gtms03.alicdn.com/tps/i3/TB1yeWeIFXXXXX5XFXXuAZJYXXX-210-210.png_40x40.jpg" width="40" height="40" alt="',u.line=12;var s=(d=n.banner)!==o?null!=d?X=d.shopName:d:(d=t.banner)!==o?null!=d?X=d.shopName:d:a.resolveLooseUp(["banner","shopName"]);return e=e.writeEscaped(s),e.data+='"/>\n            ',e}function t(a,e,o){a.data,a.affix;return e.data+='\n                <img src="//img.alicdn.com/tps/TB1d0Q2LFXXXXaQXVXXXXXXXXXX-15-16.png" alt="\u91d1\u724c\u5356\u5bb6"/>\n                ',e}function n(a,e,o){var t=a.data,n=a.affix;e.data+='\n                <span class="five-shop">',u.line=24;var s=(d=n.shopBottom)!==o?null!=d?X=d.isFiveShop:d:(d=t.shopBottom)!==o?null!=d?X=d.isFiveShop:d:a.resolveLooseUp(["shopBottom","isFiveShop"]);return e=e.writeEscaped(s),e.data+="</span>\n                ",e}function s(a,e,o){var t=a.data,n=a.affix;e.data+='\n                <img src="',u.line=27;var s=(d=n.activityTagIcon)!==o?d:(d=t.activityTagIcon)!==o?d:a.resolveLooseUp(["activityTagIcon"]);return e=e.writeEscaped(s),e.data+='" class="activityTagIcon" />\n                ',e}function i(a,e,o){var t=a.data,n=a.affix;e.data+='\n          <img data-ks-lazyload="',u.line=41;var s=(d=n.itemLogoUrl)!==o?d:(d=t.itemLogoUrl)!==o?d:a.resolveLooseUp(["itemLogoUrl"]);e=e.writeEscaped(s),e.data+='_180x180xz.jpg" width="180" height="181" alt="';var i=(d=n.xindex)!==o?d:(d=t.xindex)!==o?d:a.resolveLooseUp(["xindex"]),r=i;return r=i+1,e=e.writeEscaped(r),e.data+='"/>\n          ',e}function r(a,e,o){var t=a.data,n=a.affix;e.data+='\n          <img data-ks-lazyload="',u.line=43;var s=(d=n.itemLogoUrl)!==o?d:(d=t.itemLogoUrl)!==o?d:a.resolveLooseUp(["itemLogoUrl"]);e=e.writeEscaped(s),e.data+='_90x90xz.jpg" width="90" height="90" alt="';var i=(d=n.xindex)!==o?d:(d=t.xindex)!==o?d:a.resolveLooseUp(["xindex"]),r=i;return r=i+1,e=e.writeEscaped(r),e.data+='"/>\n          ',e}function l(a,e,o){var t=a.data,n=a.affix;e.data+='\n        <a href="//item.taobao.com/item.htm?id=',u.line=39;var s=(d=n.itemId)!==o?d:(d=t.itemId)!==o?d:a.resolveLooseUp(["itemId"]);e=e.writeEscaped(s),e.data+='" class="img-wrap pic-';var l=(d=n.xindex)!==o?d:(d=t.xindex)!==o?d:a.resolveLooseUp(["xindex"]),p=l;p=l+1,e=e.writeEscaped(p),e.data+='" target="_blank">\n          ',u.line=40,u.line=40;var c=(d=n.xindex)!==o?d:(d=t.xindex)!==o?d:a.resolveLooseUp(["xindex"]),X=c;return X=0===c,e=x.call(m,a,{params:[X],fn:i,inverse:r},e),e.data+="\n        </a>\n        ",e}function p(a,i,r){var p=a.data,c=a.affix;i.data+='\n    <li class="shop">\n      <div class="info-wrap">\n        <a href="//shop',u.line=7;var g=(d=c.shopId)!==r?d:(d=p.shopId)!==r?d:a.resolveLooseUp(["shopId"]);i=i.writeEscaped(g),i.data+='.taobao.com" target="_blank">\n          <div class="header-wrap">\n            ',u.line=9,u.line=9;var h=(d=c.banner)!==r?null!=d?X=d.shopLogoUrl:d:(d=p.banner)!==r?null!=d?X=d.shopLogoUrl:d:a.resolveLooseUp(["banner","shopLogoUrl"]);i=x.call(m,a,{params:[h],fn:e,inverse:o},i),i.data+='\n            <div class="title-wrap">\n              <div class="title">\n                ',u.line=16;var v=(d=c.banner)!==r?null!=d?X=d.shopName:d:(d=p.banner)!==r?null!=d?X=d.shopName:d:a.resolveLooseUp(["banner","shopName"]);i=i.writeEscaped(v),i.data+="\n                ",u.line=17;var f=(d=c.banner)!==r?null!=d?X=d.isGoldShop:d:(d=p.banner)!==r?null!=d?X=d.isGoldShop:d:a.resolveLooseUp(["banner","isGoldShop"]),w=f;w="true"===f,i=x.call(m,a,{params:[w],fn:t},i),i.data+='\n              </div>\n              <div class="level">\n                <img src="',u.line=22;var L=(d=c.shopBottom)!==r?null!=d?X=d.shopLeveImg:d:(d=p.shopBottom)!==r?null!=d?X=d.shopLeveImg:d:a.resolveLooseUp(["shopBottom","shopLeveImg"]);i=i.writeEscaped(L),i.data+='" alt="';var y=(d=c.shopBottom)!==r?null!=d?X=d.shopLevel:d:(d=p.shopBottom)!==r?null!=d?X=d.shopLevel:d:a.resolveLooseUp(["shopBottom","shopLevel"]);i=i.writeEscaped(y),i.data+='"/>\n                ',u.line=23,u.line=23;var I=(d=c.shopBottom)!==r?null!=d?X=d.isFiveShop:d:(d=p.shopBottom)!==r?null!=d?X=d.isFiveShop:d:a.resolveLooseUp(["shopBottom","isFiveShop"]);i=x.call(m,a,{params:[I],fn:n},i),i.data+="\n                ",u.line=26,u.line=26;var U=(d=c.activityTagIcon)!==r?d:(d=p.activityTagIcon)!==r?d:a.resolveLooseUp(["activityTagIcon"]);i=x.call(m,a,{params:[U],fn:s},i),i.data+='\n              </div>\n            </div>\n          </div>\n          <div class="action-wrap">\n            <div class="action">\u8fdb\u5165\u597d\u5e97</div>\n          </div>\n        </a>\n      </div>\n      <div class="items-wrap">\n        ',u.line=38,u.line=38;var S=(d=c.shopItems)!==r?d:(d=p.shopItems)!==r?d:a.resolveLooseUp(["shopItems"]);i=b.call(m,a,{params:[S],fn:l},i),i.data+='\n      </div>\n      <div class="extra-wrap">\n        <div class="desc">',u.line=49;var B=(d=c.shopBottom)!==r?null!=d?X=d.recomandReason:d:(d=p.shopBottom)!==r?null!=d?X=d.recomandReason:d:a.resolveLooseUp(["shopBottom","recomandReason"]);i=i.writeEscaped(B),i.data+='</div>\n        <div class="more-wrap">\n          <a href="?preShopId=',u.line=51;var N=(d=c.shopId)!==r?d:(d=p.shopId)!==r?d:a.resolveLooseUp(["shopId"]);return i=i.writeEscaped(N),i.data+='" target="_blank" class="more">\u76f8\u4f3c\u597d\u5e97 &rsaquo;</a>\n        </div>\n      </div>\n    </li>\n    ',i}function c(a,e,o){var t=a.data,n=a.affix;e.data+="\n    ",u.line=4,u.line=4;var s=(d=n.subjectRecommend)!==o?d:(d=t.subjectRecommend)!==o?d:a.resolveLooseUp(["subjectRecommend"]);return e=x.call(m,a,{params:[!s],fn:p},e),e.data+="\n    ",e}{var d,X,m=this,g=m.root,h=m.buffer,v=m.scope,u=(m.runtime,m.name,m.pos),f=v.data,w=v.affix,L=g.nativeCommands,y=g.utils,b=(y.callFn,y.callDataFn,y.callCommand,L.range,L["void"],L.foreach,L.forin,L.each),x=(L["with"],L["if"]);L.set,L.include,L.parse,L.extend,L.block,L.macro,L["debugger"]}h.data+='<div class="section">\n  <ul>\n    ',u.line=3,u.line=3;var I=(d=w.shopRecommends)!==a?d:(d=f.shopRecommends)!==a?d:v.resolveLooseUp(["shopRecommends"]);return h=b.call(m,v,{params:[I],fn:c},h),h.data+="\n  </ul>\n</div>\n\n",h};n.TPL_NAME=t.id||t.name}),KISSY.add("tb-mod/cool-shop-content/0.1.13/tabs-xtpl",function(a,e,o,t){var n=t.exports=function(a){function e(a,e,t){var n=a.data,s=a.affix;e.data+='\n    <li class="category"\n        data-category-id="',r.line=5;var i=(o=s.categoryId)!==t?o:(o=n.categoryId)!==t?o:a.resolveLooseUp(["categoryId"]);e=e.writeEscaped(i),e.data+='">\n      <a href="?categoryId=',r.line=6;var l=(o=s.categoryId)!==t?o:(o=n.categoryId)!==t?o:a.resolveLooseUp(["categoryId"]);e=e.writeEscaped(l),e.data+='">\n        <div class="img-wrap">\n          <img class="icon" src="',r.line=8;var p=(o=s.categoryLogoUrl)!==t?o:(o=n.categoryLogoUrl)!==t?o:a.resolveLooseUp(["categoryLogoUrl"]);e=e.writeEscaped(p),e.data+='_40x40.jpg" width="36" height="36" alt="';var c=(o=s.categoryName)!==t?o:(o=n.categoryName)!==t?o:a.resolveLooseUp(["categoryName"]);e=e.writeEscaped(c),e.data+='">\n        </div>\n        <div class="title-wrap">\n          <em class="title">',r.line=11;var d=(o=s.categoryName)!==t?o:(o=n.categoryName)!==t?o:a.resolveLooseUp(["categoryName"]);return e=e.writeEscaped(d),e.data+="</em>\n        </div>\n      </a>\n    </li>\n    ",e}{var o,t=this,n=t.root,s=t.buffer,i=t.scope,r=(t.runtime,t.name,t.pos),l=i.data,p=i.affix,c=n.nativeCommands,d=n.utils,X=(d.callFn,d.callDataFn,d.callCommand,c.range,c["void"],c.foreach,c.forin,c.each);c["with"],c["if"],c.set,c.include,c.parse,c.extend,c.block,c.macro,c["debugger"]}s.data+='<div class="section">\n  <ul>\n    ',r.line=3,r.line=3;var m=(o=p.tabs)!==a?o:(o=l.tabs)!==a?o:i.resolveLooseUp(["tabs"]);return s=X.call(t,i,{params:[m],fn:e},s),s.data+="\n  </ul>\n</div>",s};n.TPL_NAME=t.id||t.name}),KISSY.add("tb-mod/cool-shop-content/0.1.13/index",["node","kg/mtop-desktop/1.0.0/","tms/xtemplate","kg/datalazyload/6.0.5/","./shop-list-xtpl","./tabs-xtpl"],function(a,e){function o(){this.init.apply(this,arguments)}var t=e("node"),n=e("kg/mtop-desktop/1.0.0/"),s=e("tms/xtemplate"),i=e("kg/datalazyload/6.0.5/"),r=e("./shop-list-xtpl"),l=e("./tabs-xtpl");r=new s(r),l=new s(l);var p=location.search?KISSY.unparam(location.search.substr(1)):{},c={categoryId:function(a){var e={0:1001,1:2101,2:2102,3:2003,4:3001,5:3102,6:2004};return e[a]||a}(p.categoryId),preShopId:p.preShopId,pageData:void 0,currentPage:0,pageSize:15,totalNum:void 0,pageNum:void 0};c.logic=c.preShopId?"similar-shops":"good-shops";var d,X={"shop-list":function(a){t("#cool-shop-shop-list").html(r.render(a)).removeClass("loading"),d=new i({container:"#cool-shop-shop-list"})},"more-shop-list":function(a){t("#cool-shop-shop-list").append(t(r.render(a))),d.destroy(),d=new i({container:"#cool-shop-shop-list"})},tabs:function(a){t("#cool-shop-tabs").html(l.render(a)).all("li").removeClass("current").filter(function(a){return t(a).attr("data-category-id")==c.categoryId}).addClass("current")}},m={1001:{name:"\u4eca\u65e5\u63a8\u8350",type:"category",icon:"//gw.alicdn.com/tps/TB1En7zLpXXXXabXFXXXXXXXXXX-80-80.png"},2101:{name:"\u5973\u795e\u306e\u5e97",type:"category",icon:"//gw.alicdn.com/tps/TB13OIwLpXXXXbkXFXXXXXXXXXX-80-80.png"},2102:{name:"\u7537\u4eba\u5e2e",type:"category",icon:"//gw.alicdn.com/tps/TB16jkcLpXXXXcAaXXXXXXXXXXX-80-80.png"},2003:{name:"\u751f\u6d3b\u5bb6",type:"category",icon:"//gw.alicdn.com/tps/TB1xaAxLpXXXXblXFXXXXXXXXXX-80-80.png"},3001:{name:"\u4e00\u95f4\u8001\u5e97",type:"category",icon:"//gw.alicdn.com/tps/TB1VeEmLpXXXXcIXVXXXXXXXXXX-80-80.png"},3102:{name:"\u6709\u8154\u8c03",type:"category",icon:"//gw.alicdn.com/tps/TB1OIcMLpXXXXazXXXXXXXXXXXX-80-80.png"},2004:{name:"\u718a\u5b69\u5b50",type:"category",icon:"//gw.alicdn.com/tps/TB1B_ILLpXXXXaBXXXXXXXXXXXX-80-80.png"},2014:{name:"\u914d\u9970\u5927\u5e08",type:"category",icon:"//gw.alicdn.com/tps/TB1aLQDLpXXXXaFXpXXXXXXXXXX-80-80.png"},2015:{name:"\u7231\u978b\u4eba",type:"category",icon:"//gw.alicdn.com/tps/TB15BwgLpXXXXbraXXXXXXXXXXX-80-80.png"},2016:{name:"\u5305\u5305\u63a7",type:"category",icon:"//gw.alicdn.com/tps/TB1fn.nLpXXXXbUXVXXXXXXXXXX-80-80.png"},2017:{name:"\u5403\u5403\u5403",type:"category",icon:"//gw.alicdn.com/tps/TB1mQwxLpXXXXXNXFXXXXXXXXXX-80-80.png"},2018:{name:"\u6709\u5174\u8da3",type:"category",icon:"//gw.alicdn.com/tps/TB1mG7dLpXXXXaXaXXXXXXXXXXX-80-80.png"}};return o.prototype={init:function(a,e){var o=this;o._node=t(a),this.loadData(function(a){switch(c.pageData=a.data,c.logic){case"similar-shops":t(".J_PreShopName").html(c.pageData.similarShopHitText.preShopName),o.render(c.pageData,"shop-list"),c.totalNum=a.data.similarShopHitText.totalNum;break;case"good-shops":default:c.pageData.tabs=KISSY.filter(c.pageData.tabs,function(a){return"rec"==a.type||"topic"!=a.type&&"section"!=a.type}),KISSY.each(c.pageData.tabs,function(a){a.categoryLogoUrl=m[a.categoryId].icon}),o.render(c.pageData,"shop-list"),o.render(c.pageData,"tabs"),c.totalNum=a.data.goodShopHitText.totalNum}c.pageNum=Math.ceil(c.totalNum/c.pageSize),o.handleHeaderAndTabs(),o.bindEvent()})},handleHeaderAndTabs:function(){this._node.addClass(c.logic)},loadData:function(a){function e(){switch(c.logic){case"similar-shops":window.lib.mtop.request({api:"mtop.polaris.shop.getSimilarShopRecommend",v:"2.0",data:{preShopId:c.preShopId,size:c.pageSize,page:c.currentPage,count:5},ecode:0},a);break;case"good-shops":default:window.lib.mtop.request({api:"mtop.polaris.shop.getGoodShopRecommend",v:"4.0",data:{cateId:c.categoryId,size:c.currentPage+1==c.pageNum?c.totalNum%c.pageSize:c.pageSize,position:c.currentPage*c.pageSize,count:5,needTabs:!0,algArgs:0===c.currentPage?p.algArgs||"":"",rpos:0===c.currentPage?p.rpos||"":""},ecode:0},a)}}window.lib&&window.lib.mtop?e():n.loadMtop(e)},bindEvent:function(){var a=this,e=KISSY.throttle(function(){c.currentPage+1<c.pageNum&&(c.currentPage++,a.loadData(function(e){a.render(e.data,"more-shop-list")}))},500);t(window).on("scroll",function(a){var o=t(document).height()-(t(window).scrollTop()+t(window).height());200>o&&e()})},render:function(a,e){e?X[e](a):KISSY.each(X,function(e,o){e(a)})}},o});