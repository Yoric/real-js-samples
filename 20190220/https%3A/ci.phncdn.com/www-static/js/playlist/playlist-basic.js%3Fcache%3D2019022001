function findAncestor(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e}function errorCallback(e,t,l){alert("something went wrong  "+e+" "+t+" "+l)}var currentTitle,currentDuration,currentRating,currentThumb,vKeyAddVideo,playlist=document.querySelectorAll(".wrap"),menu=document.querySelector(".add-to-playlist-menu"),menuRemove=document.querySelector(".remove-from-playlist-menu"),playlistMenu=document.querySelector(".playlist-option-menu"),playlist_menu_fading=!1,thumbScroll=0;if(playlist)for(var i=0;i<playlist.length;i++){var showOverlay=function(e){var t=e.target||e.srcElement,l=t.querySelector(".linkWrapper"),r=t.querySelector(".add-to-playlist-icon"),i=t.querySelector(".not-interested-wrapper");l&&(MG_Utils.addClass(l.querySelector(".borderLink"),"hoverPL"),l.querySelector(".playAllLink").style.display="block",l.querySelector(".viewPlaylistLink").style.display="block"),r&&!t.closest(".innerHeaderSubMenu")&&"false"==disablePlaylistPlusButon&&(r.style.display="block"),i&&(i.style.display="block")},hideOverlay=function(e){var t=e.target||e.srcElement,l=t.querySelector(".open-playlist-link"),r=t.querySelector(".linkWrapper"),i=t.querySelector(".not-interested-button");r&&(MG_Utils.removeClass(r.querySelector(".borderLink"),"hoverPL"),r.querySelector(".playAllLink").style.display="none",r.querySelector(".viewPlaylistLink").style.display="none"),l&&!t.closest(".innerHeaderSubMenu")&&(MG_Utils.hasClass(l,"active")?l.parentNode.style.display="block":l.parentNode.style.display="none"),i&&(MG_Utils.hasClass(i,"active")?i.parentNode.style.display="block":i.parentNode.style.display="none")},addToSubmenu=function(e){var t=e.target||e.srcElement;if(playlist_menu_fading=clearTimeout(playlist_menu_fading)&&!1,MG_Utils.hasClass(t,"open-playlist-link")&&(vKeyAddVideo=t.getAttribute("data-rel"),currentTitle=MG_Utils.nextElementSibling(t.parentNode).querySelector("a").innerHTML,currentDuration=t.parentNode.parentNode.querySelector(".marker-overlays").querySelector(".duration").innerHTML,currentRating=MG_Utils.nextElementSibling(t.parentNode).querySelector(".value")?parseInt(MG_Utils.nextElementSibling(t.parentNode).querySelector(".value").innerHTML)/20:"",currentThumb=MG_Utils.previousElementSibling(t.parentNode).querySelector("img")&&MG_Utils.previousElementSibling(t.parentNode).querySelector("img").getAttribute("data-smallthumb")?MG_Utils.previousElementSibling(t.parentNode).querySelector("img").getAttribute("data-smallthumb"):"",menu.querySelector(".custom-playlist")&&menu.querySelector(".custom-playlist").querySelectorAll("li").length&&(menu.querySelector("#scrollParent").style.borderBottom="1px solid #313131"),hideShowMenu(t,menu),MG_Utils.hasClass(menu,"fadeOut")&&MG_Utils.removeClass(menu,"fadeOut"),thumbScroll||(MG_Scroll.init({selector:document.querySelectorAll("#scrollThumbs"),height:"auto",color:"#7d7c7c",size:"7px",alwaysVisible:!0,railVisible:!0,railOpacity:1,railColor:"#222",distance:0,opacity:1,railClass:"track4",barClass:"handle4",wrapperClass:"wrapper4"}),thumbScroll=1)),MG_Utils.hasClass(t,"not-interested-button")){var l=t.getAttribute("data-url"),r={id:t.getAttribute("data-rel"),value:0,token:t.getAttribute("data-token"),type:t.getAttribute("data-type")};$j.ajax({type:"POST",url:l,data:r,success:function(t){successCallback(t,e)},error:errorCallback})}};MG_Utils.addEventHandler(playlist[i],"mouseenter",showOverlay),MG_Utils.addEventHandler(playlist[i],"mouseleave",hideOverlay),MG_Utils.addEventHandler(playlist[i],"click",addToSubmenu)}var hideShowMenu=function(e,t){e&&t&&(MG_Utils.hasClass(e,"active")?(MG_Utils.removeClass(e,"active"),t.style.display="none"):MG_Utils.hasClass(e,"active")||(activePlaylists(),MG_Utils.addClass(e,"active"),t.style.display="block",positionMenu(e,t)))},positionMenu=function(e,t){if(e&&t){t.style.top=MG_Utils.offset(e).top+27+"px",t.style.left=MG_Utils.offset(e).left+"px";var l=t.getBoundingClientRect(),r=window.innerWidth;l.x+l.width>r&&(t.style.top=MG_Utils.offset(e).top+27+"px",t.style.left=MG_Utils.offset(e).left-245+"px")}},playlist_menu_fadeout=function(){playlist_menu_fading&&(playlist_menu_fading=clearTimeout(playlist_menu_fading)&&!1),playlist_menu_fading=setTimeout(function(){MG_Utils.addClass(menu,"fadeOut"),activePlaylists()},2e3)},successCallback=function(e,t){if("OK"==e&&t.target){var l=findAncestor(t.target,"videoBox"),r=findAncestor(t.target,"wrap");if(l){var i=l.querySelector(".not-interested-overlay");l.style.pointerEvents="none"}if(r){var i=r.querySelector(".not-interested-overlay");r.style.pointerEvents="none"}i&&(i.style.display="block")}},hideSubmenu=function(e){var t=e.target||e.srcElement,l=document.querySelector(".zoom.active");MG_Utils.hasClass(t,"open-playlist-link")||menu&&"block"==menu.style.display&&(t.closest(".add-to-playlist-menu")?activePlaylists(!1):(activePlaylists(),menu.style.display="none",l&&MG_Utils.removeClass(l,"active"))),t&&!MG_Utils.hasClass(t,"not-interested-button")&&menuRemove&&"block"==menuRemove.style.display&&(activePlaylists(),menuRemove.style.display="none"),playlistMenu&&!t.closest(".playlist-option-menu")&&t.parentNode!=document.querySelector("#options")&&t!=document.querySelector("#options")&&(playlistMenu.style.display="none")};MG_Utils.addEventHandler(document,"mouseup",hideSubmenu);var activePlaylists=function(e){var t=document.querySelector(".open-playlist-link.active"),l=document.querySelector(".not-interested-button.active");if(void 0===e){if(menu.querySelector(".custom-playlist")&&menu.querySelector(".custom-playlist").querySelectorAll("li").length)for(var r=menu.querySelector(".custom-playlist").querySelectorAll("li.added"),i=0;i<r.length;i++)MG_Utils.removeClass(r[i],"added");menu.querySelector(".quicklick.added")&&MG_Utils.removeClass(menu.querySelector(".quicklick.added"),"added")}t&&(t.parentNode.style.display="none",MG_Utils.removeClass(t,"active")),l&&(l.parentNode.style.display="none",MG_Utils.removeClass(l,"active"))};window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,l=(this.document||this.ownerDocument).querySelectorAll(e),r=this;do{for(t=l.length;--t>=0&&l.item(t)!==r;);}while(t<0&&(r=r.parentElement));return r}),document.querySelector("#commentPlaylist")&&MG_Utils.addEventHandler(document.querySelector("#commentPlaylist"),"click",function(e){var t=(e.target||e.srcElement,document.querySelector("#videoPlaylist").querySelectorAll("li").length<=8?1e3:500);Velocity(document.body,"scroll",{offset:MG_Utils.offset(document.querySelector("#cmtPlaylist")).top},t)});var isMacLike=navigator.platform.match(/Mac/i);if(isMacLike){var htmlWrapper=document.querySelector("html");htmlWrapper&&MG_Utils.addClass(htmlWrapper,"macintosh")}