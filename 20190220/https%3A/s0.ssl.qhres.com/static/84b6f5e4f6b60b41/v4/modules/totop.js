/**
 * 页面返回顶部模块的js
 * @author: qiantianbing
 * @update: 2018-07-02 10:47:28
 * */(function(){var e={$signin:$("#j-signin"),$signinActive:$("#j-signin-active"),loading:!1,init:function(){this.renderStatus(),this.bindEvent()},renderStatus:function(){var e=this;if(!Userbridge.isLogin()){e._showSign();return}Userbridge.getUserInfo(function(t){t.is_sign==0?e._showSign():e._showSignActive()})},bindEvent:function(){this.$signin.on("click",this._handleSignin.bind(this))},_handleSignin:function(){var e=this;Userbridge.isLogin()?e._requestSignin():Userbridge.invokeLogin(function(){e._requestSignin()})},_requestSignin:function(){var e=this;if(e.loading)return;e.loading=!0,$.ajax({url:"//activity.btime.com/api/sign/signin",xhrFields:{withCredentials:!0}}).done(function(e){e.errno==0?layer.open({skin:"bt-alert",type:1,title:!1,area:"258px",closeBtn:0,content:$("#sign-tpl").html(),success:function(){$("#to-draw").on("click",function(){feb.monitor.view({bk:"签到成功去抽奖"}),window.open(App.config.lotteryData.url),layer.closeAll(),location.reload()}),$("#self-close").on("click",function(){layer.closeAll(),location.reload()}),$("#dowbload-btn").on("click",function(){window.open("https://app.btime.com/")})}}):layer.alert(e.errmsg,{skin:"bt-alert",icon:2},function(){layer.closeAll(),location.reload()})}).always(function(){e.loading=!1})},_showSign:function(){this.$signin.show(),this.$signinActive.hide()},_showSignActive:function(){this.$signin.hide(),this.$signinActive.show()}};$(function(){e.init()})})();