STK.register("v6.lib.kit.io.ajax",function(a){var b=function(b,c,d){c=c|0||1;d=d||"fail";var e=b.args;e.__rnd&&delete e.__rnd;(new Image).src="//weibolog.sinaapp.com/?t="+c+"&u="+encodeURIComponent(b.url)+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d;(new Image).src="//s1.sinaedge.com/whb.gif?t="+c+"&u="+encodeURIComponent(b.url)+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d};return function(c){var d={},e=[],f=null,g=!1,h=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0},c);h.onComplete=function(a){g=!1;c.onComplete(a,h.args);setTimeout(i,0)};h.onFail=function(a){g=!1;if(typeof c.onFail=="function")try{c.onFail(a,h.args)}catch(d){}setTimeout(i,0);try{b(h)}catch(d){}};h.onTimeout=function(a){try{b(h);c.onTimeout(a)}catch(d){}};var i=function(){if(!!e.length){if(g===!0)return;g=!0;h.args=e.shift();if(h.method.toLowerCase()=="post"){var b=a.core.util.URL(h.url);b.setParam("__rnd",+(new Date));h.url=b.toString()}f=a.ajax(h)}},j=function(a){while(e.length)e.shift();g=!1;if(f)try{f.abort()}catch(b){}f=null};d.request=function(a){a||(a={});c.noQueue&&j();if(!c.uniqueRequest||!f){e.push(a);a._t=0;i()}};d.abort=j;return d}});
STK.register("v6.lib.kit.io.jsonp",function(a){return function(b){var c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b),d=[],e={},f=!1,g=function(){if(!!d.length){if(f===!0)return;f=!0;e.args=d.shift();e.onComplete=function(a){f=!1;c.onComplete(a,e.args);setTimeout(g,0)};e.onFail=function(a){f=!1;c.onFail(a);setTimeout(g,0)};a.jsonp(a.core.json.merge(c,{args:e.args,onComplete:function(a){e.onComplete(a)},onFail:function(a){try{e.onFail(a)}catch(b){}}}))}},h={};h.request=function(a){a||(a={});d.push(a);a._t=1;g()};h.abort=function(a){while(d.length)d.shift();f=!1;e=null};return h}});
STK.register("v6.lib.kit.io.ijax",function(a){return function(b){var c=a.parseParam({url:"",timeout:3e4,isEncode:!0,abaurl:null,responseName:null,varkey:"callback",abakey:"callback"},b),d=[],e=null,f=!1;c.onComplete=function(a,d){f=!1;b.onComplete(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};c.onFail=function(a,d){f=!1;b.onFail(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};var g=function(){var b;if(!!d.length){if(f===!0)return;f=!0;b=d.shift();c.args=b.args;c.form=b.form;e=a.ijax(c)}},h=function(a){while(d.length)d.shift();f=!1;if(e)try{e.abort()}catch(b){}e=null},i={};i.request=function(c,e){if(!a.isNode(c))throw"[lib.kit.io.ijax.request] need a form as first parameter";e||(e={});b.noQueue&&h();d.push({form:c,args:e});g()};i.abort=h;return i}});
STK.register("v6.lib.kit.io.inter",function(a){var b=a.core.json.merge;return function(){var c={},d={},e={},f=function(a,b){return function(c,d){try{b.onComplete(c,d)}catch(f){}try{c.code==="100000"?b.onSuccess(c,d):b.onError(c,d)}catch(f){}for(var g in e[a])try{e[a][g](c,d)}catch(f){}}},g=function(a,b,c){return function(d){try{b.onComplete(d,c)}catch(f){}try{d.code==="100000"?b.onSuccess(d,c):b.onError(d,c)}catch(f){}for(var g in e[a])try{e[a][g](d,c)}catch(f){}}};c.register=function(a,b){if(typeof d[a]!="undefined")throw a+" registered";b.url&&(b.url+=b.url.indexOf("?")>=0?"&ajwvr=6":"?ajwvr=6");d[a]=b;e[a]={}};c.addHook=function(b,c){var d=a.core.util.getUniqueKey();e[b][d]=c;return d};c.rmHook=function(a,b){e[a]&&e[a][b]&&delete e[a][b]};c.getTrans=function(c,e){var g=b(d[c],e);g.onComplete=f(c,e);var h=d[c].requestMode,i="ajax";if(h==="jsonp"||h==="ijax")i=h;return a.v6.lib.kit.io[i](g)};c.request=function(c,e,f){var h=b(d[c],e);h.onComplete=g(c,e,f);h=a.core.obj.cut(h,["noqueue"]);h.args=f;var i=d[c].requestMode;return i==="jsonp"?a.jsonp(h):i==="ijax"?a.ijax(h):a.ajax(h)};return c}});
STK.register("v6.conf.trans.register",function(a){var b=a.v6.lib.kit.io.inter(),c=b.register;c("checkform",{url:"/signup/v5/formcheck",method:"get"});c("sendsmsjsonp",{url:"//weibo.com/signup/v5/formcheck"+($CONFIG.page?"?page="+$CONFIG.page:""),requestMode:"jsonp",method:"get"});c("get_pin_code",{url:"/signup/v5/getpincodev6",method:"get"});c("check_pin_code",{url:"/signup/v5/checkpincode",method:"post"});c("ug_seo_recommend",{url:"/a/aj/transform/loadinghotmore",method:"get"});c("ug_seo_all",{url:"/a/aj/transform/loadingmoreall",method:"get"});c("ug_seo_novelty",{url:"/a/aj/transform/loadingmorev2",method:"get"});c("unlogin_page_fetch_feed",{url:"/a/aj/transform/loadingmoreunlogin",method:"get"});c("unlogin_page_follow",{url:"/a/aj/unlogin/follow",method:"post"});c("unlogin_feed_showtips",{url:"/a/aj/transform/showtips",method:"post"});return b});
STK.register("v6.lib.kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b){var c=[].splice.call(arguments,1,arguments.length),d=[b,$LANG].concat(c),e=a.core.util.language.apply(this,d);return e}});
STK.register("v6.lib.getnewfeed.getMoreFeed_new",function(a){var b='您有未读内容，点击查看<em class="W_ficon ficon_close S_ficon"  action-type="close">X</em>';RECOMMAND_TIP_TEMPLE='<i class="W_loading"></i>推荐中...',SHORT_UNREAD_TIP_TEMPLE='<div action-type="short_unread_tip_temple" class="UG_tips" style="position:fixed; top:50px; display:none"><a class="txt" href="javascript:void(0);" action-type="read">您有未读内容，点击查看</a><a href="javascript:void(0);" class="W_ficon ficon_close S_ficon closed" action-type="close">X</a></div>',TIME_TIP_TEMPLE='<a class="u_refresh" action-type="refresh" >点击刷新<em class="W_ficon ficon_reload">ù</em></a>';var c=a.v6.conf.core.ui,d=a.core.dom.insertElement,e=a.core.dom.contains,f=a.core.dom.position,g=a.core.util.scrollPos,h=a.core.dom.insertHTML,i=a.core.dom.next,j;return function(c){var d=null,k=null,l=3,m,n={showTip:function(){c.style.display=""},hideTip:function(){c.style.display="none";c.innerHTML=b;n.setTipShow(l)},setRecommandTipTemple:function(){c.className="UG_tips";c.innerHTML=RECOMMAND_TIP_TEMPLE;n.showTip()},setUnreadTipTemple:function(){c.className=g().top>k.t?"UG_tips unlogin_notes_sm":"UG_tips";c.innerHTML=b;n.showTip()},setTipShow:function(a){j=setTimeout(function(){c.style.display!=""&&n.setUnreadTipTemple()},a*6e4)},hideTipAlways:function(){c.style.display="none";clearTimeout(j)},bindTimeTipEvt:function(b,c){var f=a.sizzle("[action-type=refresh]",b)[0],g=f.firstChild,i=1;h(f,TIME_TIP_TEMPLE,"beforeend");m&&clearInterval(m);m=setInterval(function(){if(!e(d,b))clearInterval(m);else switch(!0){case i<60:g.nodeValue=i++ +"分钟之前看到这里。";break;case i<1440:g.nodeValue=parseInt(i++/60)+"小时之前看到这里。";break;default:g.nodeValue="您上次阅读到这里。"}},6e4);return f}},o={setTipScroll:function(){if(g().top>k.t){c.className="UG_tips unlogin_notes_sm";c.style.left="39%";c.style.top="50px";c.style.position="fixed"}else{c.className="UG_tips";c.style.left="";c.style.top="";c.style.position=""}},destroy:function(){d=null;k=null},hideTip:n.hideTip,setRecommandTipTemple:n.setRecommandTipTemple,setUnreadTipTemple:n.setUnreadTipTemple,bindTimeTipEvt:n.bindTimeTipEvt,hideTipAlways:n.hideTipAlways},p=function(){d=i(c);k=f(d)},q=function(){p();n.setTipShow(l)};q();return o}});
STK.register("v6.lib.kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&a[b].length==1&&(a[b]=a[b][0]);return a}});
STK.register("v6.lib.kit.extra.merge",function(a){return function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}});
STK.register("v6.lib.kit.extra.setCssStyles",function(a){return function(a,b){for(var c in b)a.style[c]=b[c]}});
STK.register("v6.lib.slider.slider",function(a){return function(b,c){var d=a.v6.lib.kit.dom.parseDOM,e=a.v6.lib.kit.extra.merge,f=null,g={box:b,pagination:c.children,childrenLength:b.children.length,firstChild:b.firstElementChild.cloneNode(!0),lastChild:b.lastElementChild.cloneNode(!0),width:660,play_time:"",loop:!0,auto:!0,auto_wait_time:5e3,scroll_time:300,minleft:-660*(b.children.length-1),maxleft:0,now_left:0,move_left:!1,index:0,busy:!1,timer:null},h={init_loop:function(){if(g.loop){g.now_left=-g.width;g.minleft=-g.width*g.childrenLength;g.maxleft=-g.width;a.core.dom.insertElement(g.box,g.lastChild,"afterbegin");a.core.dom.insertElement(g.box,g.firstChild,"beforeend");a.v6.lib.kit.extra.setCssStyles(g.box,{width:g.width*(g.childrenLength+2)});a.v6.lib.kit.extra.setCssStyles(g.box,this.get_style(2))}else a.v6.lib.kit.extra.setCssStyles(g.box,{width:g.width*g.childrenLength})},auto_play:function(){var a=this;if(!!g.loop&&!!g.auto){clearTimeout(g.timer);g.timer=setTimeout(function(){a.go_index(g.index+1)},g.auto_wait_time)}},go_index:function(b){var c=this;if(!g.busy){clearTimeout(g.timer);g.busy=!0;if(g.loop){b=b<0?-1:b;b=b>g.childrenLength?g.childrenLength:b}else{b=b<0?0:b;b=b>=g.childrenLength?g.childrenLength-1:b}if(!g.loop&&g.now_left==-(g.width*b))this.complete(b);else if(g.loop&&g.now_left==-g.width*(b+1))this.complete(b);else{if(b==-1||b==g.childrenLength){g.index=b==-1?g.childrenLength-1:0;g.now_left=b==-1?0:-g.width*(g.childrenLength+1)}else{g.index=b;g.now_left=-(g.width*(g.index+(g.loop?1:0)))}a.v6.lib.kit.extra.setCssStyles(g.box,this.get_style(1));setTimeout(function(){c.complete(b)},g.scroll_time)}}},complete:function(b){g.busy=!1;b==-1?g.now_left=g.minleft:b==g.childrenLength&&(g.now_left=g.maxleft);a.v6.lib.kit.extra.setCssStyles(g.box,this.get_style(2));this.pagination(b);this.auto_play()},next:function(){g.busy||this.go_index(g.index+1)},prev:function(){g.busy||this.go_index(g.index-1)},pagination:function(b){a.foreach(g.pagination,function(b){a.core.dom.removeClassName(b,"current")});a.core.dom.addClassName(g.pagination[g.index],"current")},paginationToIndex:function(b){evt=b.evt;evt.preventDefault();a.foreach(g.pagination,function(a,c){a===b.el?h.go_index(c):""})},get_style:function(a){var b=g.now_left,c=a==1?g.scroll_time:0;return{"-webkit-transition":"-webkit-transform "+c+"ms","-webkit-transform":"translate3d("+b+"px,0,0)","-webkit-backface-visibility":"hidden",transition:"transform "+c+"ms",transform:"translate3d("+b+"px,0,0)"}},initPlugins:function(){this.init_loop();this.auto_play()}},i=function(){f.add("dot","click",h.paginationToIndex)},j=function(){f=STK.delegatedEvent(c);h.initPlugins();i()};j();var k={init:h.initPlugins,paginationToIndex:h.paginationToIndex,next:h.next,prev:h.prev,destroy:function(){f.remove("dot","click",h.paginationToIndex);g.timer&&clearInterval(g.timer);f&&f.destroy()}};return k}});
STK.register("v6.lib.kit.dom.firstChild",function(a){var b=a.core.dom.next;return function(a){var c=a.firstChild;c&&c.nodeType!=1&&(c=b(c));return c}});
STK.register("v6.lib.kit.dom.lastChild",function(a){var b=a.core.dom.prev;return function(a){var c=a.lastChild;c&&c.nodeType!=1&&(c=b(c));return c}});
STK.register("v6.lib.kit.dom.children",function(a){return function(b){if(!a.core.dom.isNode(b))throw"Parameter must be an HTMLEelement!";var c=[];for(var d=0,e=b.childNodes.length;d<e;d++)b.childNodes[d].nodeType==1&&c.push(b.childNodes[d]);return c}});
STK.register("v6.lib.kit.dom.parentAttr",function(a){return function(a,b,c){var d;if(a&&b){c=c||document.body;while(a&&a!=c&&!(d=a.getAttribute(b)))a=a.parentNode}return d}});
STK.register("v6.lib.kit.extra.parseURL",function(a){return function(){return STK.historyM&&STK.historyM.parseURL?STK.historyM.parseURL():a.core.str.parseURL(location.href)}});
STK.register("v6.lib.feed.API",function(a){function g(b,c){function g(){var b=!0;a.foreach(d,function(a){(a.naturalHeight||a.height)==0&&(b=!1)});b&&f()}function f(){clearTimeout(e);a.foreach(d,function(b){var c=b.onload;a.removeEvent(b,"load",g);b.onload=c});c&&c()}var d=a.sizzle("img",b),e;a.foreach(d,function(b){a.addEvent(b,"load",g)});e=setTimeout(f,2e3)}var b=a.v6.lib.kit.dom.firstChild,c=a.v6.lib.kit.dom.lastChild,d=a.v6.lib.kit.dom.children,e=a.core.dom.insertElement,f=a.v6.lib.kit.extra.language,h={getMid:function(a,b){var c=h.getFeedNode(a,b);return c?c.getAttribute("mid"):null},getFeedNode:function(b,c){return a.core.dom.dir(b,{expr:"[action-type=feed_list_item]",endpoint:c||document.body})[0]},getFeeds:function(b,c){return a.sizzle("["+c+"]",b)},preventDefault:function(b){a.preventDefault();return!1}},i=function(b){a.custEvent.fire(b,"clearTips","base")};return function(b,c){a.isNode(b)||a.log("baseFeedList : parameter node is not a document node!");b.getAttribute("node-type")!="feed_list"&&(b=a.sizzle('div[node-type="feed_list"]',b)[0]);var f={},i=a.queryToJson(FM.getURL().query),j=a.core.evt.delegatedEvent(b),k,l,m=Math.max(i.page|0,1),n=!1,o={},p=i.end_id,q,r=function(b){var c=a.sizzle("[node-type=feedsincemaxid]",b)[0];if(c){var d=a.queryToJson(c.getAttribute("action-data")||"");a.removeNode(c);return d.since_id||d.end_id}var e=a.sizzle("[action-type=feed_list_item]",b)[0];return e&&e.getAttribute("mid")},s=!0,t={extra:{},extraData:{},getNode:function(){return b},getRecommend:function(){return a.sizzle('[node-type="feed_list_recommend"]',b)},removeRecommend:function(){var b=t.getRecommend();if(b&&b.length>0)for(var c in b)a.core.dom.removeNode(b[c])},getNodeList:function(){var c=a.sizzle('div[action-type="feed_list_item"]',b);return c.length?c:!1},getDEvent:function(){return j},removeTopNode:function(){a.removeNode(k);k=null},setTopNode:function(a){k=a},removeBottomNode:function(){a.removeNode(l);l=null},setBottomNode:function(a){l=a},getEndId:function(){return p},getSinceId:function(){return q},isTopWaiting:function(){return n},getCurrentPage:function(){var b=a.lib.kit.extra.parseURL(),c=a.core.json.queryToJson(b.query);m=c.page||1;return m},setCurrentPage:function(a){m=a},getFeedCount:function(){return h.getFeeds(b,'action-type="feed_list_item"').length},setRequestAction:function(b,c){f[b]=a.parseParam({top:!1,center:!1,bottom:!1},c)},setRequestData:function(a,b){o[a]={data:b,time:0}},getExtraData:function(a){return t.extraData[a]},setExtraData:function(a,b){t.extraData[a]=b},setExtraFunction:function(a,b){t.extra[a]=b},regCustEvent:function(b,c){a.custEvent.define(t,b);a.custEvent.add(t,b,c)},getFirstFeed:function(){var c=a.sizzle("[action-type=feed_list_item]:not([feedtype])",b);return c[0]},getLastFeed:function(){var c=a.sizzle("[action-type=feed_list_item]:not([feedtype])",b);return c[c.length-1]},getFirstFeedId:function(){var c=a.sizzle("[action-type=feed_list_item]:not([feedtype])",b),d=c[0];return d?d.getAttribute("mid"):""},getLastFeedId:function(){var c=a.sizzle("[action-type=feed_list_item]:not([feedtype])",b),d=c[c.length-1];return d?d.getAttribute("mid"):""},getFirstFeedAttr:function(c){var d=a.sizzle("[action-type=feed_list_item]:not([feedtype])",b),e=d[0];return e?e.getAttribute(c):""},getLastFeedAttr:function(c){var d=a.sizzle("[action-type=feed_list_item]:not([feedtype])",b),e=d[d.length-1];return e?e.getAttribute(c):""},showZeroTip:function(){var c=a.sizzle('div[node-type="feed_list_zero"]',b)[0];c&&(c.style.display="")},hideZeroTip:function(){var c=a.sizzle('div[node-type="feed_list_zero"]',b)[0];c&&(c.style.display="none")},insertFakeFeed:function(c){setTimeout(function(){if(typeof c!="string")a.log("insertFakeFeed feedHtml is not String!");else{t.hideZeroTip();var d=a.C("div");d.innerHTML=c;var e=a.C("div"),f=a.sizzle('div[action-type="feed_list_item"]',d)[0],h;e.className="WB_feed_type_box_t";e.appendChild(f);var i=f&&f.getAttribute("mid");if(i&&i.length&&a.sizzle('div[action-type="feed_list_item"][mid='+i+"]",b).length>0)return;k&&a.contains(document.body,k)?a.core.dom.insertAfter(e,k):a.core.dom.insertElement(b,e,"afterbegin");h=e.offsetHeight;if(b.getBoundingClientRect().top-60>0){e.style.cssText+="height:0;opacity:0;-webkit-transition:height .15s ease-out;-moz-transition:height .15s ease-out;-o-transition:height .15s ease-out;transition:height .15s ease-out;";g(e,function(){setTimeout(function(){e.style.height=e.scrollHeight+"px"});setTimeout(function(){e.style.opacity=1;a.ui.effect(e,"fadeInDownSmall","fast",function(){setTimeout(function(){while(f=e.firstChild){a.insertBefore(f,e);f.setAttribute("feedtype","fake")}a.removeNode(e)})})},300)})}else{while(f=e.firstChild){a.insertBefore(f,e);f.setAttribute("feedtype","fake")}a.removeNode(e);document.body.scrollTop=document.documentElement.scrollTop=a.scrollPos().top+h+10}var j=a.sizzle('[node-type="empty_module"]',b);j&&j[0]&&(j[0].style.display="none");setTimeout(function(){if(a.IE){var b=a.sizzle(".WB_main_c")[0];b.style.visibility?b.style.visibility="":b.style.visibility="inherit"}})}},200)},updateFeed:function(c,f,h,i){if(c&&f){t.hideZeroTip();var j=a.C("div");j.innerHTML=c;var m=a.C("div");m.className="WB_feed_type_box_t";var o=a.sizzle("[action-type=feed_list_item], [node-type=feed_spread]",j)[0],p=r(j),s=o&&o.parentNode?d(o.parentNode):[j],u;while(u=s.shift())m.appendChild(u);function v(){p&&(q=p);n=!1;a.foreach(a.sizzle("[action-type=feed_list_item][feedtype=fake]",b),function(b){a.removeNode(b)});k&&a.contains(document.body,k)?a.core.dom.insertAfter(m,k):a.core.dom.insertElement(b,m,"afterbegin");m.offsetHeight;m.style.cssText+="height:0;opacity:0;-webkit-transition:height .15s ease-out;-moz-transition:height .15s ease-out;-o-transition:height .15s ease-out;transition:height .15s ease-out;";g(m,function(){setTimeout(function(){m.style.height=m.scrollHeight+"px"});setTimeout(function(){t.removeTopNode();m.style.opacity="1";a.ui.effect(m,"fadeInDownSmall","fast",function(){setTimeout(function(){while(u=m.firstChild)a.insertBefore(u,m);a.removeNode(m);a.custEvent.fire(t,"updateFeed",[h,c])})})},300)})}function w(){var d=l&&l.nextSibling;t.removeBottomNode();var f=a.sizzle('[node-type="feed_list_shieldKeyword"]',b)[0];f&&a.removeNode(f);d?e(d,m,"beforebegin"):e(b,m,"beforeend");a.ui.effect(m,"fadeInDown","normal",function(){while(u=m.firstChild)d?e(d,u,"beforebegin"):a.insertBefore(u,m);a.removeNode(m);a.custEvent.fire(t,"updateFeed",[h,c])})}function x(b){e(b,m,"beforebegin");a.ui.effect(m,"fadeInDown","normal",function(){while(u=m.firstChild)e(b,u,"beforebegin");a.removeNode(b);a.removeNode(m);a.custEvent.fire(t,"updateFeed",[h,c])})}switch(f){case"top":v();break;case"center":x(i);break;case"bottom":w()}setTimeout(function(){try{if(a.IE){var b=a.sizzle(".WB_main_c")[0];b.style.visibility?b.style.visibility="":b.style.visibility="inherit"}}catch(c){}})}},utils:h},u=function(){a.custEvent.define(t,["request","updateFeed","clearTips","updateEndId","inView","smartSort","showRecommendTip","stopRecommendTip","inter"]);p=p||r(b);q=p};u();t.destroy=function(){j.destroy();a.custEvent.undefine(t)};return t}});
STK.register("v6.conf.trans.feed.feed",function(a){var b=a.v6.lib.kit.io.inter(),c=b.register;c("playstatistics",{url:"/aj/video/playstatistics",method:"post"});c("playInteractLog",{url:"/aj/log/h5playlog",method:"post"});c("newVideoUrl",{url:"/aj/mblog/videourl",method:"get"});return b});
STK.register("v6.lib.feed.inter",function(a){var b=window.$CONFIG||{},c=a.core.json.merge,d=a.v6.lib.kit.extra.language,e=a.v6.conf.trans.feed.feed,f=function(b){var c=a.C("div");c.innerHTML=b;window.WBEXP&&window.WBEXP.start(c);c=null};return function(b,g){function o(b,d,e,f){if(arguments.length<3)throw new Error("[comp.content.homeFeed]:bindCustEvt()-custom event 'success' should supply enough arguments.");e=c(a.queryToJson(FM.getURL().query),e);switch(d){case"lazyload":l(e,f);break;case"insertCenter":m(e,f);break;case"newFeed":n(e)}}function n(a){var a=c({since_id:b.getSinceId()},a);e.request(i.loadFeedTransKey,{onSuccess:function(a){b.updateFeed(a.data,"top","newFeed");f(a.data)},onFail:function(a){b.showError("top","newFeed")},onError:function(a){a.code==100070?window.location.reload():b.showError("top","newFeed")}},a)}function m(a,c){function h(){var g=8e3,j=setTimeout(function(){c&&k(h,c,d("#L{请求超时}"))},g+200);e.request(i.loadFeedTransKey,{timeout:g,onSuccess:function(a){clearTimeout(j);b.updateFeed(a.data,"center","center",c);f(a.data)},onFail:function(a){clearTimeout(j);c&&k(h,c,d("#L{请求超时}"))},onError:function(a){if(a.code==100070)window.location.reload();else{clearTimeout(j);c&&k(h,c,a.msg||d("#L{请求失败}"))}}},a)}var g=j();g&&(a.filtered_min_id=g);h()}function l(a,g){function l(){var c=8e3,h=setTimeout(function(){g&&k(l,g,d("#L{请求超时}"))},c+200);e.request(i.loadFeedTransKey,{timeout:8e3,onSuccess:function(a){clearTimeout(h);b.updateFeed(a.data,"bottom","lazyload");f(a.data)},onFail:function(a){clearTimeout(h);g&&k(l,g,d("#L{请求超时}"))},onError:function(a){if(a.code==100070)window.location.reload();else{clearTimeout(h);g&&k(l,g,a.msg||d("#L{请求失败}"))}}},a)}var a=c({pre_page:b.getCurrentPage(),page:b.getCurrentPage(),end_id:b.getEndId(),min_id:b.getLastFeedId()},a),h=j();h&&(a.filtered_min_id=h);l()}function k(b,c,e){var f=c.innerHTML;e=e?e+", ":"";a.sizzle(".text",c)[0].innerHTML=e+d('<a href="javascript:void(0);">#L{点击重新载入}</a>');a.addEvent(c,"click",function g(){a.removeEvent(c,"click",g);c.innerHTML=f;b();window.SUDA&&window.SUDA.uaTrack&&window.SUDA.uaTrack("tblog_home_new","feed_click_loadagain")});window.SUDA&&window.SUDA.uaTrack&&window.SUDA.uaTrack("tblog_home_new","feed_expo_loadagain")}function j(){var b=a.sizzle("[filtered_min_id]",h)[0];return b&&b.getAttribute("filtered_min_id")}if(!b)return a.log("inter : need object of the baseFeedList Class");var h=b.getNode(),i=a.core.obj.parseParam({loadFeedTransKey:"getfeed",plNode:null},g);a.custEvent.define(b,"inter");a.custEvent.add(b,"request",o);return{destroy:function(){a.custEvent.remove(b,"request",o)}}}});
STK.register("v6.lib.feed.base",function(a){return function(b,c){a.isNode(b)||a.log("feed.base : parameter node is not a document node!");var d={},c=c||{},e=a.v6.lib.feed.API(b,c);for(var f in e)!d[f]&&(d[f]=e[f]);var g=a.v6.lib.feed.inter(d,c),h=function(){e.destroy&&e.destroy();g.destroy&&g.destroy()};d.destroy=h;return d}});
STK.register("v6.lib.kit.dom.fix",function(a){function f(c,e,f){if(!!d(c)){var g="fixed",h,i,j,k,l=c.offsetWidth,m=c.offsetHeight,n=a.core.util.winSize(),o=0,p=0,q=a.core.dom.cssText(c.style.cssText);if(!b){g="absolute";var r=a.core.util.scrollPos();o=h=r.top;p=i=r.left;switch(e){case"lt":h+=f[1];i+=f[0];break;case"lb":h+=n.height-m-f[1];i+=f[0];break;case"rt":h+=f[1];i+=n.width-l-f[0];break;case"rb":h+=n.height-m-f[1];i+=n.width-l-f[0];break;case"c":default:h+=(n.height-m)/2+f[1];i+=(n.width-l)/2+f[0]}j=k=""}else{h=k=f[1];i=j=f[0];switch(e){case"lt":k=j="";break;case"lb":h=j="";break;case"rt":i=k="";break;case"rb":h=i="";break;case"c":default:h=(n.height-m)/2+f[1];i=(n.width-l)/2+f[0];k=j=""}}if(e=="c"){h<o&&(h=o);i<p&&(i=p)}q.push("position",g).push("top",h+"px").push("left",i+"px").push("right",j+"px").push("bottom",k+"px");c.style.cssText=q.getCss()}}function e(b){b=a.core.arr.isArray(b)?b:[0,0];for(var c=0;c<2;c++)typeof b[c]!="number"&&(b[c]=0);return b}function d(b){return a.core.dom.getStyle(b,"display")!="none"}var b=!(a.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),c=/^(c)|(lt)|(lb)|(rt)|(rb)$/;return function(d,g,h){var i,j,k=!0,l;if(a.core.dom.isNode(d)&&c.test(g)){var m={getNode:function(){return d},isFixed:function(){return k},setFixed:function(a){(k=!!a)&&f(d,i,j);return this},setAlign:function(a,b){if(c.test(a)){i=a;j=e(b);k&&f(d,i,j)}return this},destroy:function(){b||b&&a.core.evt.removeEvent(window,"scroll",n);a.core.evt.removeEvent(window,"resize",n);a.core.evt.custEvent.undefine(l)}};l=a.core.evt.custEvent.define(m,"beforeFix");m.setAlign(g,h);function n(c){c=c||window.event;a.core.evt.custEvent.fire(l,"beforeFix",c.type);k&&(!b||i=="c")&&f(d,i,j)}b||a.core.evt.addEvent(window,"scroll",n);a.core.evt.addEvent(window,"resize",n);return m}}});
STK.register("widget.module.component",function(a){return function(){var b={};b.initParam=a.core.func.empty;b.initEvent=a.core.func.empty;b.destroyParam=a.core.func.empty;b.destroyEvent=a.core.func.empty;b.init=function(){b.initParam();b.initEvent()};b.destroy=function(){b.destroyEvent();b.destroyParam()};return b}});
STK.register("widget.parse",function(a){var b="//js.t.sinajs.cn/t5/home/js/",c="STK.",d=["destroy","part_destroy","part_flush"],e=1,f=typeof $CONFIG=="undefined"?e:$CONFIG.version;return function(e,g){var h=a.widget.module.component(),i=a.core.obj.sup(h,["init","destroy"]),j={},k,l;h.handler={getMethod:function(b){b=b.split(".");var c,d=a;while(c=b.shift())if(!(d=d[c]))break;return d},extract:function(a){var b=h.handler.getMethod(a.ns);if(b){j[a.uniqueID]={info:a,entity:b(a)};j[a.uniqueID].entity.init()}},getDomInfo:function(b){return{dom:b,top:h.entity.dom,ns:b.getAttribute("component"),uniqueID:a.core.dom.uniqueID(b),data:a.queryToJson(b.getAttribute("component-data")||""),param:a.queryToJson(b.getAttribute("component-param")||"")}},loadComponent:function(b){var c=h.handler.getDomInfo(b),d=[{url:[k.baseURL,c.ns.replace(/\./g,"/"),".js?version=",f].join(""),NS:k.baseNS+c.ns}];a.core.io.require(d,h.handler.extract,c)}};h.accept={partDestroy:function(b,c){var d=c.dom;for(var e in j)if(a.contains(d,j[e].info.dom)){j[e].entity.destroy();delete j[e].info;delete j[e].entity;delete j[e]}},partFlush:function(b,c){a.foreach(a.sizzle("[component]",c.dom),h.handler.loadComponent)}};h.initParam=function(){h.entity={dom:e};l=a.custEvent.define(h.entity.dom,d);k=a.parseParam({baseURL:b,baseNS:c},g);j={}};h.destroyParam=function(){k=null;j=null};h.initEvent=function(){a.custEvent.add(l,"part_destroy",h.accept.partDestroy);a.custEvent.add(l,"part_flush",h.accept.partFlush)};h.destroyEvent=function(){a.custEvent.remove(l,"part_destroy",h.accept.partDestroy);a.custEvent.remove(l,"part_flush",h.accept.partFlush)};h.destroy=function(){for(var a in j){j[a].entity.destroy();delete j[a].info;delete j[a].entity;delete j[a]}i.destroy()};h.init=function(){i.init();a.foreach(a.sizzle("[component]",h.entity.dom),h.handler.loadComponent)};return h}});
STK.register("v6.lib.feed.widget",function(a){var b={};return{add:function(c,d){if(!b[c]){b[c]=a.widget.parse(d);b[c].init()}},clear:function(a){if(b[a]){b[a].destroy();delete b[a]}},destroy:function(){for(var a in b){b[a].destroy();delete b[a]}}}});
STK.register("v6.lib.kit.extra.actionData",function(a){return function(b){return{set:function(c,d){if(!!a.isNode(b)){var e=a.queryToJson(b.getAttribute("action-data")||"")||{};e[c]=d;b.setAttribute("action-data",a.jsonToQuery(e))}},del:function(c){if(!!a.isNode(b)){var d=a.queryToJson(b.getAttribute("action-data")||"")||{};delete d[c];b.setAttribute("action-data",a.jsonToQuery(d))}},get:function(c){if(!a.isNode(b))return"";var d=a.queryToJson(b.getAttribute("action-data")||"")||{};return d[c]||""}}}});
STK.register("v6.lib.kit.extra.listener",function(a){var b={},c={};c.define=function(c,d){if(b[c]!=null)throw"common.listener.define: 频道已被占用";b[c]=d;var e={};e.register=function(d,e){if(b[c]==null)throw"common.listener.define: 频道未定义";a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null)throw"commonlistener.define: 频道未定义";a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("v6.conf.channel.feed",function(a){var b=["forward","publish","comment","delete","refresh","reply","feedTagUpdate","feedTagMoreUpdate","qfaceAdd","qfaceCount","timeFeedPublish"];return a.v6.lib.kit.extra.listener.define("conf.channel.feed",b)});
STK.register("v6.lib.kit.extra.sparkMD5",function(a){return function(a){"use strict";var b=function(a,b){return a+b&4294967295},c=function(a,c,d,e,f,g){c=b(b(c,a),b(e,g));return b(c<<f|c>>>32-f,d)},d=function(a,b,d,e,f,g,h){return c(b&d|~b&e,a,b,f,g,h)},e=function(a,b,d,e,f,g,h){return c(b&e|d&~e,a,b,f,g,h)},f=function(a,b,d,e,f,g,h){return c(b^d^e,a,b,f,g,h)},g=function(a,b,d,e,f,g,h){return c(d^(b|~e),a,b,f,g,h)},h=function(a,c){var h=a[0],i=a[1],j=a[2],k=a[3];h=d(h,i,j,k,c[0],7,-680876936);k=d(k,h,i,j,c[1],12,-389564586);j=d(j,k,h,i,c[2],17,606105819);i=d(i,j,k,h,c[3],22,-1044525330);h=d(h,i,j,k,c[4],7,-176418897);k=d(k,h,i,j,c[5],12,1200080426);j=d(j,k,h,i,c[6],17,-1473231341);i=d(i,j,k,h,c[7],22,-45705983);h=d(h,i,j,k,c[8],7,1770035416);k=d(k,h,i,j,c[9],12,-1958414417);j=d(j,k,h,i,c[10],17,-42063);i=d(i,j,k,h,c[11],22,-1990404162);h=d(h,i,j,k,c[12],7,1804603682);k=d(k,h,i,j,c[13],12,-40341101);j=d(j,k,h,i,c[14],17,-1502002290);i=d(i,j,k,h,c[15],22,1236535329);h=e(h,i,j,k,c[1],5,-165796510);k=e(k,h,i,j,c[6],9,-1069501632);j=e(j,k,h,i,c[11],14,643717713);i=e(i,j,k,h,c[0],20,-373897302);h=e(h,i,j,k,c[5],5,-701558691);k=e(k,h,i,j,c[10],9,38016083);j=e(j,k,h,i,c[15],14,-660478335);i=e(i,j,k,h,c[4],20,-405537848);h=e(h,i,j,k,c[9],5,568446438);k=e(k,h,i,j,c[14],9,-1019803690);j=e(j,k,h,i,c[3],14,-187363961);i=e(i,j,k,h,c[8],20,1163531501);h=e(h,i,j,k,c[13],5,-1444681467);k=e(k,h,i,j,c[2],9,-51403784);j=e(j,k,h,i,c[7],14,1735328473);i=e(i,j,k,h,c[12],20,-1926607734);h=f(h,i,j,k,c[5],4,-378558);k=f(k,h,i,j,c[8],11,-2022574463);j=f(j,k,h,i,c[11],16,1839030562);i=f(i,j,k,h,c[14],23,-35309556);h=f(h,i,j,k,c[1],4,-1530992060);k=f(k,h,i,j,c[4],11,1272893353);j=f(j,k,h,i,c[7],16,-155497632);i=f(i,j,k,h,c[10],23,-1094730640);h=f(h,i,j,k,c[13],4,681279174);k=f(k,h,i,j,c[0],11,-358537222);j=f(j,k,h,i,c[3],16,-722521979);i=f(i,j,k,h,c[6],23,76029189);h=f(h,i,j,k,c[9],4,-640364487);k=f(k,h,i,j,c[12],11,-421815835);j=f(j,k,h,i,c[15],16,530742520);i=f(i,j,k,h,c[2],23,-995338651);h=g(h,i,j,k,c[0],6,-198630844);k=g(k,h,i,j,c[7],10,1126891415);j=g(j,k,h,i,c[14],15,-1416354905);i=g(i,j,k,h,c[5],21,-57434055);h=g(h,i,j,k,c[12],6,1700485571);k=g(k,h,i,j,c[3],10,-1894986606);j=g(j,k,h,i,c[10],15,-1051523);i=g(i,j,k,h,c[1],21,-2054922799);h=g(h,i,j,k,c[8],6,1873313359);k=g(k,h,i,j,c[15],10,-30611744);j=g(j,k,h,i,c[6],15,-1560198380);i=g(i,j,k,h,c[13],21,1309151649);h=g(h,i,j,k,c[4],6,-145523070);k=g(k,h,i,j,c[11],10,-1120210379);j=g(j,k,h,i,c[2],15,718787259);i=g(i,j,k,h,c[9],21,-343485551);a[0]=b(h,a[0]);a[1]=b(i,a[1]);a[2]=b(j,a[2]);a[3]=b(k,a[3])},i=function(a){var b=[],c;for(c=0;c<64;c+=4)b[c>>2]=a.charCodeAt(c)+(a.charCodeAt(c+1)<<8)+(a.charCodeAt(c+2)<<16)+(a.charCodeAt(c+3)<<24);return b},j=function(a){var b=[],c;for(c=0;c<64;c+=4)b[c>>2]=a[c]+(a[c+1]<<8)+(a[c+2]<<16)+(a[c+3]<<24);return b},k=function(a){var b=a.length,c=[1732584193,-271733879,-1732584194,271733878],d,e,f,g,j,k;for(d=64;d<=b;d+=64)h(c,i(a.substring(d-64,d)));a=a.substring(d-64);e=a.length;f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<e;d+=1)f[d>>2]|=a.charCodeAt(d)<<(d%4<<3);f[d>>2]|=128<<(d%4<<3);if(d>55){h(c,f);for(d=0;d<16;d+=1)f[d]=0}g=b*8;g=g.toString(16).match(/(.*?)(.{0,8})$/);j=parseInt(g[2],16);k=parseInt(g[1],16)||0;f[14]=j;f[15]=k;h(c,f);return c},l=function(a){var b=a.length,c=[1732584193,-271733879,-1732584194,271733878],d,e,f,g,i,k;for(d=64;d<=b;d+=64)h(c,j(a.subarray(d-64,d)));a=d-64<b?a.subarray(d-64):new Uint8Array(0);e=a.length;f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<e;d+=1)f[d>>2]|=a[d]<<(d%4<<3);f[d>>2]|=128<<(d%4<<3);if(d>55){h(c,f);for(d=0;d<16;d+=1)f[d]=0}g=b*8;g=g.toString(16).match(/(.*?)(.{0,8})$/);i=parseInt(g[2],16);k=parseInt(g[1],16)||0;f[14]=i;f[15]=k;h(c,f);return c},m=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=function(a){var b="",c;for(c=0;c<4;c+=1)b+=m[a>>c*8+4&15]+m[a>>c*8&15];return b},o=function(a){var b;for(b=0;b<a.length;b+=1)a[b]=n(a[b]);return a.join("")},p=function(a){return o(k(a))},q=function(){this.reset()};p("hello")!=="5d41402abc4b2a76b9719d911017c592"&&(b=function(a,b){var c=(a&65535)+(b&65535),d=(a>>16)+(b>>16)+(c>>16);return d<<16|c&65535});q.prototype.append=function(a){/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a)));this.appendBinary(a);return this};q.prototype.appendBinary=function(a){this._buff+=a;this._length+=a.length;var b=this._buff.length,c;for(c=64;c<=b;c+=64)h(this._state,i(this._buff.substring(c-64,c)));this._buff=this._buff.substr(c-64);return this};q.prototype.end=function(a){var b=this._buff,c=b.length,d,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f;for(d=0;d<c;d+=1)e[d>>2]|=b.charCodeAt(d)<<(d%4<<3);this._finish(e,c);f=!a?o(this._state):this._state;this.reset();return f};q.prototype._finish=function(a,b){var c=b,d,e,f;a[c>>2]|=128<<(c%4<<3);if(c>55){h(this._state,a);for(c=0;c<16;c+=1)a[c]=0}d=this._length*8;d=d.toString(16).match(/(.*?)(.{0,8})$/);e=parseInt(d[2],16);f=parseInt(d[1],16)||0;a[14]=e;a[15]=f;h(this._state,a)};q.prototype.reset=function(){this._buff="";this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};q.prototype.destroy=function(){delete this._state;delete this._buff;delete this._length};q.hash=function(a,b){/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a)));var c=k(a);return!b?o(c):c};q.hashBinary=function(a,b){var c=k(a);return!b?o(c):c};q.ArrayBuffer=function(){this.reset()};q.ArrayBuffer.prototype.append=function(a){var b=this._concatArrayBuffer(this._buff,a),c=b.length,d;this._length+=a.byteLength;for(d=64;d<=c;d+=64)h(this._state,j(b.subarray(d-64,d)));this._buff=d-64<c?b.subarray(d-64):new Uint8Array(0);return this};q.ArrayBuffer.prototype.end=function(a){var b=this._buff,c=b.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e,f;for(e=0;e<c;e+=1)d[e>>2]|=b[e]<<(e%4<<3);this._finish(d,c);f=!a?o(this._state):this._state;this.reset();return f};q.ArrayBuffer.prototype._finish=q.prototype._finish;q.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};q.ArrayBuffer.prototype.destroy=q.prototype.destroy;q.ArrayBuffer.prototype._concatArrayBuffer=function(a,b){var c=a.length,d=new Uint8Array(c+b.byteLength);d.set(a);d.set(new Uint8Array(b),c);return d};q.ArrayBuffer.hash=function(a,b){var c=l(new Uint8Array(a));return!b?o(c):c};return q}()});
STK.register("v6.lib.kit.extra.HashTable",function(a){return function(){function a(){this.ObjArr={};this.Count=0;this.Add=function(a,b){if(this.ObjArr.hasOwnProperty(a))return!1;this.ObjArr[a]=b;this.Count++;return!0};this.Contains=function(a){return this.ObjArr.hasOwnProperty(a)};this.GetValue=function(a){if(this.Contains(a))return this.ObjArr[a];throw Error("Hashtable not cotains the key: "+String(a))};this.Remove=function(a){if(this.Contains(a)){delete this.ObjArr[a];this.Count--}};this.Clear=function(){this.ObjArr={};this.Count=0}}return new a}});
STK.register("v6.lib.kit.extra.getWantTime",function(a){return function(a,b){function c(a,b){var c={"M+":b.getMonth()+1,"d+":b.getDate(),"h+":b.getHours(),"m+":b.getMinutes(),"s+":b.getSeconds(),"q+":Math.floor((b.getMonth()+3)/3),S:b.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(b.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)(new RegExp("("+d+")")).test(a)&&(a=a.replace(RegExp.$1,RegExp.$1.length==1?c[d]:("00"+c[d]).substr((""+c[d]).length)));return a}if(!a&&isNaN(a))throw"differDay: differDay need a int number";if(b&&typeof b!="string")throw"formal: formal need a string like yyyy-MM-dd hh:mm:ss";a=parseInt(a)||0;var d={},e=864e5,f=new Date,g=new Date(f.getTime()+a*e);d.Today={time:f.getTime(),day:f.getDay(),year:f.getFullYear(),quarter:Math.floor((f.getMonth()+3)/3),month:f.getMonth()+1,date:f.getDate(),hour:f.getHours(),minute:f.getMinutes(),second:f.getSeconds(),MSecond:f.getMinutes(),Format:b&&c(b,f)||f.toLocaleString()};d.WantDay={time:g.getTime(),day:g.getDay(),year:g.getFullYear(),quarter:Math.floor((g.getMonth()+3)/3),month:g.getMonth()+1,date:g.getDate(),hour:g.getHours(),minute:g.getMinutes(),second:g.getSeconds(),MSecond:g.getMinutes(),Format:b&&c(b,g)||g.toLocaleString()};f.setHours(0);f.setMinutes(0);f.setSeconds(0);f.setMilliseconds(0);var h=new Date(f.getTime()+a*e);d.ZeroToday={time:f.getTime(),day:f.getDay(),year:f.getFullYear(),quarter:Math.floor((f.getMonth()+3)/3),month:f.getMonth()+1,date:f.getDate(),hour:f.getHours(),minute:f.getMinutes(),second:f.getSeconds(),MSecond:f.getMinutes(),Format:b&&c(b,f)||f.toLocaleString()};d.ZeroWantDay={time:h.getTime(),day:h.getDay(),year:h.getFullYear(),quarter:Math.floor((h.getMonth()+3)/3),month:h.getMonth()+1,date:h.getDate(),hour:h.getHours(),minute:h.getMinutes(),second:h.getSeconds(),MSecond:h.getMinutes(),Format:b&&c(b,h)||h.toLocaleString()};return d}});
STK.register("v6.lib.kit.extra.scrollMethod",function(a){var b={},c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){a()},d={debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null;c||a.apply(e,f)},h=c&&!d;clearTimeout(d);d=setTimeout(g,b);h&&a.apply(e,f)}},throttle:function(a,b,c){var d,e=new Date;return function(){var f=this,g=arguments,h=new Date;clearTimeout(d);if(h-e>=c){a.apply(f,g);e=h}else d=setTimeout(a,b)}},rAF:function(a){return function(){var b=!1;if(!b){c(a);b=!0}}}};b.debounce=d.debounce;b.throttle=d.throttle;b.rAF=d.rAF;return b});
STK.register("v6.conf.trans.storage",function(a){var b=a.v6.lib.kit.io.inter(),c=b.register;c("h5playlog",{url:"/aj/log/h5playlog",method:"post"});return b});
STK.register("v6.lib.kit.extra.storageLog",function(a){var b=a.v6.conf.trans.storage,c=a.v6.lib.kit.extra.sparkMD5,d={canStore:function(){return window.localStorage?!0:!1},count:0,getUniqueKey:function(){return Math.random().toString(36).substring(5,10)+"_"+ +(new Date)+Math.floor(Math.random()*1e4)+d.count++},resetID:function(a,b){return a+"_"+(b?b:d.getUniqueKey())},isString:function(a){return typeof a=="string"&&a.constructor==String},isJSON:function(a){var b=typeof a=="object"&&Object.prototype.toString.call(a).toLowerCase()=="[object object]"&&!a.length;return b},expTest:function(a,b){var c=new RegExp("^"+a+"_");return c.test(b)},md5Log:function(a,b,d){var e={};e.data=a;e.key=b;e.sig=a&&b&&d&&a+b+d;e.sig=c.hash(e.sig);return e},comLog:function(a,b){var c={};c.data=a;c.key=b;return c}},e={debug:!1,session:!1,str:"",uniqueID:"",resetID:!1,clear:!0,separator:"||",isEncode:!1,logLength:20,logTime:18e4,tabLength:30,trans:b,transKey:"",MD5:!0,MD5str:"encryptedString",params:{timeout:3e4,onComplete:function(){},onTimeout:function(){},onError:function(){}}};return function(b){b.debug&&console.log(b);if(!!b&&b instanceof Object){if(!b.str||!d.isString(b.str)){console.log("storageLog : need str in parameters object");return}if(!b.transKey||!d.isString(b.transKey)){console.log("storageLog : need transKey in parameters object");return}if(b.separator=="&"){console.log("storageLog : separator can not be &");return}var c,f,g,h,i,j,k,l,m,n,o,p,q;o={setFlagTimer:function(){m&&clearTimeout(m);m=null;m=setTimeout(function(){l=!1},0)},setLogTimer:function(){g||(g=setTimeout(function(){o.timeout()},c.logTime))},genValue:function(a){a=d.isJSON(a)?JSON.stringify(a):a;a=c.isEncode?encodeURIComponent(a):a;c.debug&&console.log(a+"........is generated");return a},reset:function(){g&&clearTimeout(g);g=null;l=!1;i=[];k="";c.clear?o.remove(j):h.setItem(j,k);j=c.resetID?d.resetID(c.str,c.uniqueID):j;c.debug&&console.log("reset........"+j);o.setFlagTimer();o.setLogTimer()},onComplete:function(){return function(a){o.reset();c.params.onComplete&&c.params.onComplete(a)}},request:function(){c.debug&&console.log(j+"in storage is"+h.hasOwnProperty(j));g&&clearTimeout(g);g=null;var a;if(!(!h.hasOwnProperty(j)&&i.length>1))if(k){a=c.MD5&&c.MD5str?d.md5Log(k,j,c.MD5str):d.comLog(k,j);c.debug&&console.log("send log is .........","\n",a);c.trans.request(c.transKey,{timeout:c.params.timeout||8e3,onComplete:o.onComplete(),onTimeout:c.params.onTimeout||function(){},onError:c.params.onError||function(){}},a)}else{c.debug&&console.log("logTimer is ......."+g);o.setLogTimer()}},timeout:function(){c.debug&&console.log("running logTimer");if(l){c.debug&&console.log("now is setting storage");o.timeout()}else o.request()},get:function(){return j&&h.getItem(j)},remove:function(){j&&h.removeItem(j)},set:function(a){l=!0;i.push(o.genValue(a));k=i.join(c.separator);if(i.length==c.logLength){c.debug&&console.log("arrValue.length is ....."+i.length);o.request()}else{h.setItem(j,k);o.setFlagTimer();o.setLogTimer()}},compOne:function(a){return function(b){h.removeItem(a);c.params.onComplete&&c.params.onComplete(b)}},clearOne:function(a,b){if(!!h.hasOwnProperty(a)){var e;if(b){e=c.MD5&&c.MD5str?d.md5Log(b,a,c.MD5str):d.comLog(b,a);c.debug&&console.log("send clearlog is .........","\n",e);c.trans.request(c.transKey,{timeout:c.params.timeout||8e3,onComplete:o.compOne(a),onTimeout:c.params.onTimeout||function(){},onError:c.params.onError||function(){}},e);c.debug&&console.log("clear send success")}else h.removeItem(a)}},clear:function(){c.debug&&console.log("clear start");var b=c.str&&h.getItem(c.str);if(!!b){b=b.split(c.separator);a.foreach(b,function(a){o.clearOne(a,h.getItem(a))});h.removeItem(c.str);c.debug&&console.log("clear end")}},unload:function(){var a=c.str&&h.getItem(c.str);a?h.setItem(c.str,a+c.separator+j):h.setItem(c.str,j);c.debug&&console.log("set key is...."+j)},destroy:function(){f=null;m&&clearTimeout(m);m=null;g&&clearTimeout(g);g=null;l=!1;i=null;j=null;k=null;h=null}};n=function(){c=a.parseParam(e,b);h=c.session?window.sessionStorage:window.localStorage;l=!1;m&&clearTimeout(m);m=null;g&&clearTimeout(g);g=null;i=[];f={};j=d.resetID(c.str,c.uniqueID);c.debug&&console.log("init key is ......."+j)};p=function(){f.get=o.get;f.set=o.set;f.remove=o.remove;f.clear=o.clear;f.destroy=o.destroy;o.clear();window.onbeforeunload=o.unload;g=setTimeout(function(){o.timeout()},c.logTime)};q=function(){if(d.canStore()){n();p();c.debug&&console.log("can storage")}else a.log("browser does not support storage")};q();return f}console.log("storageLog : need object of the spec Class");return}});
STK.register("v6.lib.kit.extra.arrayRemove",function(a){return function(b,c){if(!a.isArray(c))throw"aSource: need an array as second parameter";var d=a.arrIndexOf(b,c);if(d<0)throw"oElememt: array does not contain this element";return c.slice(0,d).concat(c.slice(d+1,c.length))}});
STK.register("v6.lib.feed.plugins.video.log",function(a){var b=a.v6.lib.kit.extra.parseURL,c={},d={play_time:"",uid:null,object_id:null,mid:null,mid_uid:null,rootmid:null,rootuid:null,duration:null,isautoplay:"0",playduration:"",firstframe_status:"",quit_status:"",firstframe_time:"",startplay_time:"",valid_play_duration:"",download_size:"",bitrate:"",encode_mode:null,extend:""},e={vf:"following",sid:0},f={profile:["100505","100306","100406","103505","100205","100605","100606","101106","100206","100106","230267","101806"],page:["100101","101515","100202","100404","100120","100707","100117","100135","100153"],topic:["100808"]},g={count:0,getUniqueKey:function(a){return(a||"H5_")+Math.random().toString(36).substring(5,10)+"_"+ +(new Date)+Math.floor(Math.random()*1e4)+g.count++},isString:function(a){return typeof a=="string"&&a.constructor==String},isJSON:function(a){var b=typeof a=="object"&&Object.prototype.toString.call(a).toLowerCase()=="[object object]"&&!a.length;return b},extendToJson:function(b,c){var d=a.core.str.trim(b).split(","),e={},f=function(a){return c?decodeURIComponent(a):a};for(var g=0,h=d.length;g<h;g++)if(d[g]){var i=d[g].split("=>"),j=i[0],k=i[1];if(i.length<2){k=j;j="$nullName"}if(!e[j])e[j]=f(k);else{a.core.arr.isArray(e[j])!=!0&&(e[j]=[e[j]]);e[j].push(f(k))}}return e},jsonToExtend:function(b,c){var d=function(b,c){b=b==null?"":b;b=a.core.str.trim(b.toString());return c?encodeURIComponent(b):b},e=[];if(typeof b=="object")for(var f in b){if(f==="$nullName"){e=e.concat(b[f]);continue}if(b[f]instanceof Array)for(var g=0,h=b[f].length;g<h;g++)e.push(f+"=>"+d(b[f][g],c));else typeof b[f]!="function"&&e.push(f+"=>"+d(b[f],c))}return e.length?e.join(","):""},changeVF:function(b){var c=b&&b.host,d=b&&b.path,e=window.$CONFIG&&window.$CONFIG.location;if(/s\.weibo\.com/.test(c))return"s";if(/d\.weibo\.com/.test(c))return"hot";if(/weibo\.com/.test(c)){if(/^v6_/.test(e))return/(friends|mygroups|fav|like)/.test(d)?"group":"following";if(/^page_/.test(e)){if(/_single_weibo/.test(e))return"detail";var g,h=/^page_(\d*)_/g.exec(e)[1];for(var i in f)if(a.inArray(h,f[i])){g=i;break}return g?g:"page"}}}},h={getVF:function(a){if(a&&!g.isString(a))throw"str : need string as a parameter";return a||g.changeVF(b())},getSid:function(a){if(a&&!g.isString(a))throw"str : need string as a parameter";return a||g.getUniqueKey()},setExtend:function(b,c){if(!b||!c||!g.isJSON(b)||!g.isJSON(c))throw"logObj || extend: need json as parameter";b.extend=g.jsonToExtend(a.core.json.merge(g.extendToJson(b.extend),c));return b}};return function(){c.vf=h.getVF;c.sid=h.getSid;c.Obj=h.setExtend(d,a.parseParam(e,{vf:h.getVF(),sid:h.getSid()}));c.setExtend=h.setExtend;c.destory=function(){c=null;d=null;e=null};return c}});
STK.register("v6.lib.feed.plugins.video.init",function(a){var b=a.v6.lib.kit.dom.parseDOM,c=a.v6.conf.trans.feed.feed,d=a.v6.lib.kit.extra.merge,e=a.v6.lib.kit.extra.language,f=a.v6.lib.kit.extra.sparkMD5,g=a.v6.lib.kit.extra.HashTable,h=a.v6.lib.kit.extra.getWantTime,i=a.v6.lib.kit.extra.storageLog,j=a.v6.lib.kit.extra.arrayRemove,k=document.documentElement,l=document.body,m={str:"Log_h5paly",transKey:"h5playlog"},n={count:0,getUniqueKey:function(){return"H5_"+Math.random().toString(36).substring(5,10)+"_"+ +(new Date)+Math.floor(Math.random()*1e4)+n.count++},getActionData:function(b){if(!!b){var c=b.getAttribute("action-data"),d=a.queryToJson(c);return d}}};return function(b,d){if(!b)a.log("media : need object of the baseFeedList Class");else{var e={},f,k,l,o,p,q=[],r,s,t=[],u,v,w,x=!1,y={},z,A,B=!1,C,D,E,F,G,H=function(){f=!1;k=b.getNode();l=b.getDEvent();o=b.utils;z=z&&z.Clear()||g();E=a.v6.lib.feed.plugins.video.log();F=E.Obj;G=i(m)},I={fullScreen:function(){x=!0},unFullScreen:function(){x=!1},loaded:function(a){if(typeof a!="object")throw"DataItemPicker need params object";if(a.uniqueKey!==p){var b=a.uniqueKey&&z.ObjArr[a.uniqueKey];if(!b)return}},playLog:function(a){if(typeof a!="object")throw"DataItemPicker need params object";var b=a.logObj;b.isautoplay=a.isAuto?"1":"0";b=E.setExtend(b,{vf:"ug"});if(a.logObj.valid_play_duration<0||a.logObj.valid_play_duration>=5*a.logObj.duration*1e3)b=E.setExtend(b,{illegal:!0});G.set(b)},reset:function(b){if(typeof b!="object")throw"DataItemPicker need params object";var d=b.uniqueKey&&z.ObjArr[b.uniqueKey].videoRoom,e=d&&n.getActionData(d),f=d&&o.getFeedNode(d,k),g=e.type==="feedvideo"||e.type==="feedlive",h=f&&f.getAttribute("mid"),i=e&&e.objectid,j=a.sizzle('[node-type="fl_h5_video_disp"]',d)[0],l=J.getInitData(d,j);l.uniqueKey=b.uniqueKey;c.request("newVideoUrl",{onComplete:function(d){if(d.code==="100000"&&d.data.video_src){l.videoUrl=decodeURIComponent(d.data.video_src);var i=new VideoPlayer(l);if(z.Contains(b.uniqueKey)){z.ObjArr[b.uniqueKey].action=i;i.expandPlay();z.ObjArr[b.uniqueKey].init=!0;g&&c.request("playstatistics",{},{uid:$CONFIG.uid,mid:h,keys:e.keys,type:e.type});f&&f.getAttribute("data-mark")&&c.request("adDeal",{},{mid:h,short_url:e.short_url,mark:a.queryToJson(f.getAttribute("data-mark")).mark})}}}},{object_id:i})},rePlay:function(b){if(typeof b!="object")throw"DataItemPicker need params object";var d=z.ObjArr[b.uniqueKey].videoRoom,e=n.getActionData(d),f=o.getFeedNode(d,k),g=e.type==="feedvideo"||e.type==="feedlive",h=f&&f.getAttribute("mid"),i=z.ObjArr[b.uniqueKey].logObj;i=E.setExtend(i,{sid:E.sid()});g&&c.request("playstatistics",{},{uid:$CONFIG.uid,mid:h,keys:e.keys,type:e.type});f&&f.getAttribute("data-mark")&&c.request("adDeal",{},{mid:h,short_url:e.short_url,mark:a.queryToJson(f.getAttribute("data-mark")).mark})},volPlay:function(a){if(typeof a!="object")throw"DataItemPicker need params object";var b=z.ObjArr[a.uniqueKey];!b},togglePlay:function(b){if(typeof b!="object")throw"DataItemPicker need params object";var c=b&&b.uniqueKey,d=c&&z.ObjArr[c];if(b.paused){c&&!a.inArray(c,t)&&t.push(c);d.action.toggleMute(!0)}else{c&&a.inArray(c,t)&&(t=j(c,t));d.action.toggleMute(!1);I.volPlay({uniqueKey:b.uniqueKey,muted:!1,paused:!1})}},destroy:function(){if(window.curVideoObj){if(window.curVideoObj.action.playStatus()&&window.curVideoObj.action.playStatus()=="nail")return;window.curVideoObj.action.thumbnail();window.curVideoObj.init=!1}},initPlugins:function(b,c){if(!b||typeof b!="string")a.log("type : need String of the function type");else switch(b){case"fullScreen":I.fullScreen();break;case"unFullScreen":I.unFullScreen();break;case"loaded":I.loaded(c);break;case"playLog":I.playLog(c);break;case"reset":I.reset(c);break;case"rePlay":I.rePlay(c);break;case"volPlay":I.volPlay(c);break;case"togglePlay":I.togglePlay(c);break;case"destroy":I.destroy()}}},J={getLogData:function(b,c,d){if(!!a.isNode(b)){var e=b&&o.getFeedNode(b,k),f=e&&e.getAttribute("tbinfo")&&a.queryToJson(e.getAttribute("tbinfo")),g=e&&e.getAttribute("minfo")&&a.queryToJson(e.getAttribute("minfo")),h=e&&e.getAttribute("mid");d.uid=$CONFIG&&$CONFIG.uid||"";d.mid=h?h:"";d.mid_uid=f&&f.ouid?f.ouid:"";d.rootuid=g&&g.ru||f&&f.ouid;d.rootmid=g&&g.rm&&g.rm||h&&h;d.object_id=c&&c.objectid;d.duration=c&&c.duration;d.encode_mode=c&&c.encode_mode;d.bitrate=c&&c.bitrate;d.isautoplay="1";return d}},getInitData:function(b,c){if(!!a.isNode(b)&&!!a.isNode(c)){var d=E.setExtend(F,{sid:E.sid()}),e=n.getActionData(b);d=J.getLogData(b,e,d);var g=e.type==="feedvideo"||e.type==="feedlive",h,i;if(e.video_src){i="video";h=decodeURIComponent(e.video_src)}else if(e.live_src){e.is_live==1?i="live_on":i="live_off";h=decodeURIComponent(e.live_src)}return{logObj:d,thumbnail:e.cover_img&&decodeURIComponent(e.cover_img),shortUrl:e.short_url&&decodeURIComponent(e.short_url),videoUrl:h,videoH:"184px",videoW:"326px",selfW:326,dom:c,playCount:e.play_count&&e.play_count,duration:e.duration&&e.duration,isAutoPlay:f?!0:!1}}},initOne:function(b,c,d){var e=n.getUniqueKey();q.push(e);r=e;b.setAttribute("unique-video",e);var f=a.sizzle('[node-type="fl_h5_video_pre"]',b)[0],g=a.sizzle('[node-type="fl_h5_video_disp"]',b)[0];f.style.display="none";g.style.display="";var h=J.getInitData(b,g);h.uniqueKey=e;var i=new VideoPlayer(h);i.thumbnail();var j={key:e,logObj:h.logObj,init:!1,videoRoom:b,top:c,domHeight:d,action:i};!y.hasOwnProperty(e)&&(y[e]=c);!z.Contains(e)&&z.Add(e,j)},pausePrev:function(a){if(s&&a!=s){var b=s&&z.ObjArr[s];J.outPlay(b)}s=a},expandPlay:function(b){var c=b.data,e=b.el,f=a.position(e).t,g=a.core.dom.getSize(e).height,i=e&&e.getAttribute("unique-video"),j=z.ObjArr[i];if(!i||!j||!j.init){J.initOne(e,f,g);i=r;window.curVideoObj=z.ObjArr[i]}J.pausePrev(i);if(e.getAttribute("node-type")!=="fl_h5_video"){d&&d(b);return o.preventDefault(b.evt)}var l=o.getMid(e,k),m=o.getFeedNode(e,k),n=c.type==="feedvideo"||c.type==="feedlive",p=i&&z.ObjArr[i],q=p&&p.logObj;q.play_time=h(0,"yyyy-MM-dd hh:mm:ss").Today.Format;if(!p.init){p.action.expandPlay();p.init=!0;return o.preventDefault(b.evt)}},autoLog:function(a,b,c){var d=o.getMid(a,k),e=o.getFeedNode(a,k),f=n.getActionData(a),g=f.type==="feedvideo"||f.type==="feedlive";b.play_time=h(0,"yyyy-MM-dd hh:mm:ss").Today.Format;!!c},outPlay:function(a){if(!a.action.playStatus()||a.action.playStatus()!="nail"){a.action.thumbnail();a.init=!1}}},K=function(){l.add("feed_list_third_rend","click",J.expandPlay);window.__WBH5VideoUtils__=I.initPlugins},L=function(){H();K()};L();e.destroy=function(){delete __WBH5VideoUtils__;z&&z.Clear();A&&A.Clear();t=null;p=null;s=null;l.remove("feed_list_third_rend","click",J.expandPlay);l&&l.destroy()};return e}}});
STK.register("v6.lib.kit.extra.supportVideo",function(a){return function(){var b=navigator.userAgent.toLowerCase(),c=function(){return b.indexOf("bidubrowser")>-1?!0:!1}(),d=function(){return b.indexOf("firefox")>-1?!0:!1}();if(a.core.util.browser.IE6||a.core.util.browser.IE7||a.core.util.browser.IE8||c)return!1;if(!document.createElement("video").canPlayType)return!1;var e=document.createElement("video"),f=e.canPlayType('video/ogg; codecs="theora, vorbis"');if(!f){var g=e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');return g?g=="probably"?!0:!1:!1}return f==="probably"?!0:!1}});
STK.register("v6.lib.feed.plugins.media",function(a){var b,c=a.v6.lib.kit.extra.supportVideo,d=!1;c()&&(d=!0);return function(c,e){if(!c)a.log("media : need object of the baseFeedList Class");else{var f=c.getNode(),g=c.getDEvent();b=c.utils;var h={},i=!0,j={dispContentNode:{},voteObj:{}},k=function(a){thirdExpand(a,f,j);return b.preventDefault(a.evt)},l=function(a){return a.tagName&&a.getAttribute?a.tagName.toUpperCase()==="A"||!!a.getAttribute("action-type"):!1};if(d)var m=a.v6.lib.feed.plugins.video.init(c,k);else g.add("feed_list_third_rend","click",function(b){a.preventDefault(b.evt);a.stopEvent(b.evt);var c=b.el,d=b.evt.target||b.evt.srcElement,e=c.getAttribute("href");if(!!e){var f=0,g=!1;while(d){if(f++>10)break;if(!a.contains(c,d))break;l(d)?g=!0:console.log(d);d=d.parentNode}g||window.open(e)}});h.destroy=function(){m&&m.destroy();f=g=undefined;a.v6.lib.feed.widget.destroy()};return h}}});
STK.register("v6.lib.feed.feedList",function(a){return function(b,c){var d=[],e=a.v6.lib.feed.base(b,{plNode:b});c=c||{};c.plNode=b;d.push(a.v6.lib.feed.plugins.media(e,c));var f=function(){for(var a in d)try{d[a].destroy&&d[a].destroy()}catch(b){}e=null};e.destroy=f;return e}});
STK.register("v6.pl.register.feed.source.init_ug",function(a){var b=a.v6.conf.trans.register,c=a.v6.lib.kit.extra.language,d=a.v6.lib.getnewfeed.getMoreFeed_new,e=a.v6.conf.core.ui,f=a.core.dom.insertElement,g=a.core.dom.contains,h=a.core.dom.position,i=a.core.util.scrollPos,j=a.core.dom.insertHTML,k=null,l={"热门":"微博-随时随地发现新鲜事 ","明星":"明星微博-微博红人-微博 ","搞笑":"搞笑段子-搞笑视频-微博 ","社会":"微博社会热点-最热时事新闻-微博 ","新鲜事":"微博新鲜事-微博","头条":"微博头条-最新头条文章-微博 ","情感":"情感故事-情感段子-微博 ","时尚":"流行时尚-时尚图片-微博 ","军事":"军事-最热军事新闻-微博 ","榜单":"微博榜单-实时榜单-微博"};return function(e){var m=null,n=null,o=null,p=null,q=null,r=null,s=null,t=null,u=null,o=null,v="0",w=!1,x=c('<a class="W_btn_b W_btn_b_disable btn_22px" href="javascript(0);">#L{已关注}</a>'),y=c('<div class="UG_tips" node-type="template_loading" action-type="loadingMore"> <div class="WB_empty" action-data="page_id=v6_content_home"> <div class="WB_innerwrap"> <div class="empty_con clearfix"> <p class="text"><i class="W_loading"></i>#L{正在加载中，请稍候...}</p> </div> </div> </div> </div>'),z=c("#L{暂时没有新内容，请稍后刷新}"),A=c('#L{查看更多未读微博}<em class="W_ficon ficon_arrow_down S_ficon">c</em>'),B=c('<i class="W_loading"></i>#L{正在加载中，请稍候...}'),C=c('<i class="W_icon icon_rederrorS"></i> #L{加载失败，请刷新页面}'),D={},E={isLoading:!1,loading:function(){if(!!g(u,o)&&!E.isLoading){var b=h(o),c=v,d=o;if(i().top+a.winSize().height>b.t){this.isLoading=!0;c=c=="99991"?this.getBillboardIndex().category:c;D[c]?D[c]++:D[c]=2;this.loadMoreFeed({category:c,page:D[c],lefnav:0,cursor:u.getAttribute("cursor")||""})}}},loadMoreFeed:function(b){var c=this,d=o;this.getNewFeed(b,function(e){var f=a.builder(e).list,g;if(!("feed_list"in f&&a.sizzle("[action-type=feed_list_item]",f.feed_list[0]).length)){D[b.category]=D[b.category]--;d.innerHTML=z}else{console.log(22);g=f.feed_list[0];var h=g.getAttribute("cursor")||"";u.setAttribute("cursor",h);j(u,g.innerHTML,"beforeend");d.innerHTML=B;u.removeChild(o);c.insertLoading();c.isLoading=!1}})},insertLoading:function(){g(u,o)||f(u,o,"beforeend")},getNewFeed:function(a,c){b.request("unlogin_page_fetch_feed",{onError:function(){w?loadingBarText.innerHTML=C:setTimeout(function(){E.isLoading=!1;E.loading();var a=o;w=!0},3e3)},onFail:function(){},onSuccess:function(a){a.code=="100000"?c(a.data):void 0}},a)},refresh:function(){this.insertLoading();"billboard"in m?a.addEvent(m.billboard[0],"click",F.processBillboard):E.loading()},searchNode:function(a,b,c){if(a==b)return null;var d=a.getAttribute(c);return d?{result:d,node:a}:arguments.callee(a.parentNode,b,c)},isAnchorElementOrHasActionType:function(a){return a.tagName&&a.getAttribute?a.tagName.toUpperCase()==="A"||!!a.getAttribute("action-type"):!1},setCurr:function(a,b){for(var c in b)b[c].className="S_bg2";a.className="cur"},getBillboardIndex:function(){var b=a.sizzle("[node-type=billboard]",q);if(!!b.length){var c=a.sizzle("li",b[0]),d=null;for(var e in c)if(c[e].className=="cur"){d={category:c[e].getAttribute("category_id"),node:c[e]};break}return d}},readLS:function(a){if(a=="99991"){var b=this.getBillboardIndex();a=b?b.category:a}var c=localStorage.getItem("unloginWBFeeds"+a);return c||""},writeLS:function(a,b){if(a=="99991"){var c=this.getBillboardIndex();a=c?c.category:a}localStorage.setItem("unloginWBFeeds"+a,b)}},F={lefNav:function(b){window.event?window.event.returnValue=!1:b.preventDefault();window.__WBH5VideoUtils__("destroy");var c=this,d=b.target||b.srcElement,e=d.innerHTML,h=a.E("time_tip"),i=E.searchNode(d,p,"category_id").result;if(i=="video")window.open("http://krcom.cn","_blank");else{e in l&&(document.title=l[e]);g(u,o)&&u.removeChild(o);h&&u.removeChild(h);E.writeLS(v,u.innerHTML);u.innerHTML="";v=i;var k=a.sizzle("[node-type=billboard]",q);if(v!="99991"&&k.length){a.removeEvent(k[0],"click",this.processBillboard);q.removeChild(k[0])}v=="novelty"&&(D[v]=1);if(v){E.isLoading=!1;o.innerHTML=B;var m=E.readLS(v);v=="novelty"&&(m="");var n=m==""?0:1;s.setRecommandTipTemple();var r=v=="0"&&m==""?{category:"0",lefnav:1}:{category:v,getrecommand:n,no_timetip:!1};E.getNewFeed(r,function(b){var b=a.builder(b),c=b.list;F.sliderDestory(b);if("feed_list"in c){u.innerHTML=m;if(v=="0"){var d=a.E("livetv"),e=a.E("recommendAD");d&&u.removeChild(d);e&&u.removeChild(e);e&&f(u,e,"afterbegin");d&&f(u,d,"afterbegin")}j(u,c.feed_list[0].innerHTML,"afterbegin");var g=a.E("time_tip");if(g){var h=g?s.bindTimeTipEvt(g,v):null;a.addEvent(h,"click",function(b){a.sizzle("[action-type=unread_feed_tip]",q)[0].click()})}}else u.innerHTML=m;if("billboard"in c&&v=="99991"&&k.length==0){var i=c.billboard[0];f(q,i,"afterbegin");a.addEvent(i,"click",F.processBillboard)}else if(v=="99991"&&k.length){var l=a.sizzle("[category_id]",k[0]);E.setCurr(l[0],l)}window.scrollTo(0,1);E.insertLoading();v=="novelty"?s.hideTipAlways():s.hideTip()})}}},processBillboard:function(b){var c=E.searchNode(b.target||b.srcElement,q,"category_id");E.getNewFeed({category:c.result},function(b){var d=a.sizzle("[node-type=billboard]",q)[0],e=a.sizzle("[category_id]",d);E.setCurr(c.node,e);var f=a.builder(b).list;"feed_list"in f&&(u.innerHTML=f.feed_list[0].innerHTML);E.insertLoading()})},winScroll:function(a){E.loading();v!="novelty"&&s.setTipScroll()},eachFeedClick:function(b){var c=b.el,d=b.evt.target||b.evt.srcElement,e=c.getAttribute("href");if(!!e){var f=0,g=!1;while(d){if(f++>10)break;if(!a.contains(c,d))break;E.isAnchorElementOrHasActionType(d)&&(g=!0);d=d.parentNode}g||window.open(e)}},feedTip:function(b){var c=b.target||b.srcElement,d=c.getAttribute("action-type"),e=v,g=a.E("time_tip");g&&u.removeChild(g);switch(d){case"unread_feed_tip":s.setRecommandTipTemple();if(e=="99991"){var h=E.getBillboardIndex();e=h.category}E.getNewFeed({category:e,getrecommand:1,no_timetip:!1},function(b){var b=a.builder(b),c=b.list;if("feed_list"in c){if(e=="0"){F.sliderDestory(b);var d=a.E("livetv"),h=a.E("recommendAD");d&&u.removeChild(d);h&&u.removeChild(h);j(u,c.feed_list[0].innerHTML,"afterbegin");h&&f(u,h,"afterbegin");d&&f(u,d,"afterbegin")}else j(u,c.feed_list[0].innerHTML,"afterbegin");g=a.E("time_tip");if(g){var i=g?s.bindTimeTipEvt(g,e):null;a.addEvent(i,"click",function(b){a.sizzle("[action-type=unread_feed_tip]",q)[0].click()})}}E.insertLoading();s.hideTip();window.scrollTo(0,1)});break;case"close":s.hideTip()}},sliderDestory:function(b){var c=a.sizzle("[node-type=header_slider]")[0],d=a.sizzle("[node-type=dot_box]")[0],e=a.sizzle(".UG_slider",q)[0];newHeaderSlider=b.list.header_slider?b.list.header_slider[0]:"";newDotBox=b.list.dot_box?b.list.dot_box[0]:"";try{c&&c.parentNode.removeChild(c);d&&d.parentNode.removeChild(d);k&&k.destroy()}catch(f){console.log(f)}if(v=="0"){e.appendChild(newHeaderSlider);e.appendChild(newDotBox);a.v6.lib.slider.slider(newHeaderSlider,newDotBox)}},scrollToTop:function(){setTimeout(function(){window.scrollTo(0,1)},0)},init:function(){sliderNode&&dotNode?k=a.v6.lib.slider.slider(sliderNode,dotNode):k=null;E.refresh()}},G=function(){m=a.builder(e).list;u=m.feed_list[0];o=a.builder(y).list.template_loading[0];n=a.delegatedEvent(e);q=a.E("pl_unlogin_home_feed");homeFeedNode=a.builder(q).list;sliderNode=a.sizzle("[node-type=header_slider]",q)[0];dotNode=a.sizzle("[node-type=dot_box]",q)[0];r=a.sizzle("[action-type=unread_feed_tip]",q)[0];s=d(r);lefnav=a.E("pl_unlogin_home_leftnav");v=a.URL(window.location).getParam("category")||"0";a.v6.lib.feed.feedList(u)},H=function(){a.addEvent(window,"scroll",F.winScroll);a.addEvent(r,"click",F.feedTip);n.add("feed_list_item","click",F.eachFeedClick);a.addEvent(window,"load",F.scrollToTop)},I=function(){a.removeEvent(window,"scroll",F.winScroll);a.removeEvent(r,"click",F.feedTip);n.remove("loadingMore","click",F.eachFeedClick);a.removeEvent(window,"load",F.scrollToTop)},J=function(){G();H();F.init()};J();var K={};K.destroy=I;return K}});
STK.pageletM.register("pl_unlogin_home_feed",function(a,b){return a.v6.pl.register.feed.source.init_ug(a.E(b))});
