/*! v0.3.31 built Mon Feb 18 2019 11:02:48 GMT+0300 (MSK) */
!function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};t[i].call(n.exports,n,n.exports,e);n.l=!0;return n.exports}var r={};e.m=t;e.c=r;e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})};e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};e.d(r,"a",r);return r};e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};e.p="";e(e.s=1231)}({10:function(t,e,r){"use strict";e.a={preview:1400,videoContainer:500,overlayContainer:1500,spinner:1450,playerLogo:3e3,editorButtons:3e3,swipeForward:3e3,blick:4e3,subtitles:1e3,play:1475,volume:1475,progress:1475,mobileTouchProgress:1500,copyright:7500,fullScreen:1475,settings:1475,mobilePanel:3050,videoMode:1475,splashControls:1250,unpublishedLabel:1500,timelineSprite:1475,emptySlot:7500,task:7500,recommendationPreview:4e3,contextMenu:9e3,advert:1e4,flyPlayer:2147483547}},100:function(t,e){t.exports='<svg width="100%" height="100%" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-miterlimit:1.41421;">\n    <g id="svg_1" transform="matrix(0.5,-2.31112e-34,0,0.5,-1,-1)">\n        <circle cx="32" cy="32" r="28" style="fill-opacity:0.301961;"/>\n    </g>\n</svg>\n'},101:function(t,e){t.exports='<svg width="100%" height="100%" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-miterlimit:1.41421;">\n    <g id="svg_1" transform="matrix(0.5,-2.31112e-34,0,0.5,-1,-1)">\n        <circle cx="32" cy="32" r="28" style="fill-opacity:0.501961;stroke:white;stroke-width:3px;"/>\n    </g>\n</svg>\n'},102:function(t,e,r){"use strict";r.d(e,"b",function(){return n});var i={UP:"up",OPACITY:"alpha"},n=i.OPACITY;e.a=i},112:function(t,e,r){"use strict";function i(t){return null==t?void 0===t?l:s:c&&c in Object(t)?Object(a.a)(t):Object(o.a)(t)}var n=r(69),a=r(115),o=r(116),s="[object Null]",l="[object Undefined]",c=n.a?n.a.toStringTag:void 0;e.a=i},113:function(t,e,r){"use strict";var i=r(114),n="object"==typeof self&&self&&self.Object===Object&&self;e.a=i.a||n||Function("return this")()},114:function(t,e,r){"use strict";(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.a=r}).call(e,r(23))},115:function(t,e,r){"use strict";function i(t){var e=o.call(t,l),r=t[l];try{t[l]=void 0;var i=!0}catch(t){}var n=s.call(t);i&&(e?t[l]=r:delete t[l]);return n}var n=r(69),a=Object.prototype,o=a.hasOwnProperty,s=a.toString,l=n.a?n.a.toStringTag:void 0;e.a=i},116:function(t,e,r){"use strict";function i(t){return a.call(t)}var n=Object.prototype,a=n.toString;e.a=i},117:function(t,e,r){"use strict";var i=r(118);e.a=Object(i.a)(Object.getPrototypeOf,Object)},118:function(t,e,r){"use strict";function i(t,e){return function(r){return t(e(r))}}e.a=i},119:function(t,e,r){"use strict";function i(t){return null!=t&&"object"==typeof t}e.a=i},12:function(t,e,r){"use strict";e.a=function(t,e,r){e.forEach(function(e){var i=e.getValues;t._state||(t._state=[]);t._state.push(i(r.getState()))});r.subscribe(function(){e.forEach(function(e,i){for(var n=e.getValues,a=e.onChange,o=n(r.getState()),s=t._state[i],l=Object.keys(o),c=0;c<l.length;c+=1)if(o[l[c]]!==s[l[c]]){t._state[i]=o;a();break}})})}},120:function(t,e,r){"use strict";(function(t,i){var n,a=r(122);n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:i;var o=Object(a.a)(n);e.a=o}).call(e,r(23),r(121)(t))},121:function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]);Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}});Object.defineProperty(e,"exports",{enumerable:!0});e.webpackPolyfill=1}return e}},122:function(t,e,r){"use strict";function i(t){var e,r=t.Symbol;if("function"==typeof r)if(r.observable)e=r.observable;else{e=r("observable");r.observable=e}else e="@@observable";return e}e.a=i},123:function(t,e,r){"use strict";function i(t,e){var r=e&&e.type;return"Given action "+(r&&'"'+r.toString()+'"'||"an action")+', reducer "'+t+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function n(t){Object.keys(t).forEach(function(e){var r=t[e];if(void 0===r(void 0,{type:o.a.INIT}))throw new Error('Reducer "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+o.a.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}function a(t){for(var e=Object.keys(t),r={},a=0;a<e.length;a++){var o=e[a];"function"==typeof t[o]&&(r[o]=t[o])}var s=Object.keys(r),l=void 0;try{n(r)}catch(t){l=t}return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];if(l)throw l;for(var n=!1,a={},o=0;o<s.length;o++){var c=s[o],u=r[c],d=t[c],h=u(d,e);if(void 0===h){var f=i(c,e);throw new Error(f)}a[c]=h;n=n||h!==d}return n?a:t}}e.a=a;var o=r(68);r(59),r(70)},1231:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(501);window.getVQPlayer=function(t){return new i.a(t)}},124:function(t,e,r){"use strict";function i(t,e){return function(){return e(t.apply(void 0,arguments))}}function n(t,e){if("function"==typeof t)return i(t,e);if("object"!=typeof t||null===t)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===t?"null":typeof t)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=Object.keys(t),n={},a=0;a<r.length;a++){var o=r[a],s=t[o];"function"==typeof s&&(n[o]=i(s,e))}return n}e.a=n},125:function(t,e,r){"use strict";function i(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){return function(r,i,o){var s=t(r,i,o),l=s.dispatch,c=[],u={getState:s.getState,dispatch:function(t){return l(t)}};c=e.map(function(t){return t(u)});l=n.a.apply(void 0,c)(s.dispatch);return a({},s,{dispatch:l})}}}e.a=i;var n=r(71),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}},13:function(t,e,r){"use strict";r.d(e,"f",function(){return i});r.d(e,"h",function(){return n});r.d(e,"g",function(){return a});r.d(e,"b",function(){return o});r.d(e,"c",function(){return s});r.d(e,"e",function(){return l});r.d(e,"d",function(){return c});r.d(e,"a",function(){return u});var i=function(t){return{type:"SHOW_OVERLAY",payload:t}},n=function(t,e){return{type:"TRIGGER_EVENT",payload:{name:t,options:e}}},a=function(){return{type:"START_OVERLAY_MODE"}},o=function(){return{type:"END_OVERLAY_MODE"}},s=function(t){return{type:"LOAD_OPTIONS",payload:t}},l=function(t){return{type:"SET_LANGUAGE",payload:t}},c=function(t){return{type:"LOG",payload:t}},u=function(t){return{type:"ADV_LOG",payload:t}}},14:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(68),n=r(123),a=r(124),o=r(125),s=r(71);r(70);r.d(e,"createStore",function(){return i.b});r.d(e,"combineReducers",function(){return n.a});r.d(e,"bindActionCreators",function(){return a.a});r.d(e,"applyMiddleware",function(){return o.a});r.d(e,"compose",function(){return s.a})},146:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(39),s=r(2),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this));a._options=r;a._filters=[];return a}a(e,t);e.prototype.init=function(t){this._store=t.store;this._options=l({},this._options,t)};e.prototype.start=function(){return new Promise(function(){})};e.prototype.play=function(){};e.prototype.pause=function(){};e.prototype.replay=function(){this.seek(0);this.play()};e.prototype.seek=function(t){};e.prototype.getCurrentTime=function(){};e.prototype.getDuration=function(){};e.prototype.setVolume=function(t){};e.prototype.destroy=function(){this.eventListeners={}};e.prototype.getThumbnail=function(){return""};e.prototype.setFilters=function(){this._filters=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]};e.prototype.getContainer=function(){};e.prototype.setQuality=function(t){};e.create=function(t){return null};e.prototype.requestFullScreen=function(t){};e.prototype.closeFullScreen=function(){};e.createVideoTag=function(){var t=document.createElement("video");t.playsInline=!0;t.muted=!0;Object(s.d)(t,{position:"absolute",top:"50%",left:"50%",webkitTransform:"translate(-50%, -50%)",transform:"translate(-50%, -50%)"});return t};e.prototype.setMaxBuffer=function(t){};return e}(o.a)},147:function(t,e,r){"use strict";e.a={BigPlay:"bigPlayButton"}},148:function(t,e,r){"use strict";r.d(e,"a",function(){return i});r.d(e,"b",function(){return n});var i=16,n=6},149:function(t,e,r){"use strict";var i=r(559);e.a={en:r(560).a,ru:i.a}},171:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">\n<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" fill="white"/>\n  <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n'},19:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=r(4),a={NONE:0,ERROR:1,WARN:2,LOG:3,TRACK:4,DEBUG:5,TRACE:6},o=/[?&]vq_debug\b(?:=(\d+))?/.exec(window.location.search),s=(o&&Math.max(a.NONE,Math.min(a.TRACE,o[1]||a.LOG)),function(){function t(){i(this,t);this._logs=[];this._logsTime={}}t.prototype.error=function(t){this._send(a.ERROR,t,"color: red; font-weight: bold")};t.prototype.warn=function(t){this._send(a.WARN,t,"color: red")};t.prototype.log=function(t){this._send(a.LOG,t,"")};t.prototype.track=function(t){this._send(a.TRACK,t,"color: darkblue")};t.prototype.debug=function(t){this._send(a.DEBUG,t,"color: darkgray")};t.prototype.trace=function(t){this._send(a.TRACE,t,"color: lightgray")};t.prototype.time=function(t){this._logsTime[t]=+new Date;this.log(""+t)};t.prototype._send=function(t,e,r){var i="VIQEO_LOG|%c["+(new Date).toISOString().slice(11,-1)+"] "+e;this._logs.push(i)};t.prototype.timeEnd=function(t){var e=this._logsTime[t];if(e){this.log(t+". Timer ended: "+(+new Date-e)/1e3+"sec")}else this.error("logger.timeEnd("+t+") Not found: "+t)};t.prototype.getLogs=function(){return this._logs};t.prototype.copy=function(){var t={logs:this._logs,playersState:[]},e=window.VIQEO;if(e){e.getPlayers().forEach(function(e){return t.playersState.push(e.store.getState())})}Object(n.f)(JSON.stringify(t));console.info("Лог скопировался")};return t}());window.vqLogger=window.vqLogger?window.vqLogger:new s;e.a=window.vqLogger},2:function(t,e,r){"use strict";r.d(e,"e",function(){return n});r.d(e,"n",function(){return a});r.d(e,"p",function(){return o});r.d(e,"o",function(){return s});r.d(e,"d",function(){return l});r.d(e,"c",function(){return c});r.d(e,"a",function(){return h});r.d(e,"b",function(){return p});r.d(e,"m",function(){return g});r.d(e,"l",function(){return y});r.d(e,"f",function(){return v});r.d(e,"i",function(){return m});r.d(e,"g",function(){return b});r.d(e,"k",function(){return E});r.d(e,"r",function(){return _});r.d(e,"j",function(){return T});r.d(e,"q",function(){return w});r.d(e,"h",function(){return O});r.d(e,"s",function(){return A});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(t){t.preventDefault();t.stopPropagation()},a=function(t,e){return t&&("object"===(void 0===t?"undefined":i(t))||"function"==typeof t)&&"string"==typeof t.innerHTML&&(!e||e.toUpperCase()===t.tagName)},o=function(t){t&&t.parentNode&&t.parentNode.removeChild(t);return null},s=function(t){return new Promise(function(e,r){var i=t.play();i?i.then(e,r):t.paused?r({message:"play() not returned promise and video paused"}):e()})},l=function(t,e){var r=[].concat(t);Object.keys(e).forEach(function(t){var i=e[t];void 0!==i&&r.forEach(function(e){e.style[t]=i})});return t},c=function(t,e,r,n,a){var o=document.createElement(e);switch(void 0===r?"undefined":i(r)){case"object":l(o,r);break;case"string":o.className=r}o.innerHTML=n||"";o.addEventListener("click",a);return t.appendChild(o)},u=function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})},d=function(t,e){var r=t.ownerDocument.createElement("style");r.type="text/css";r.styleSheet?r.styleSheet.cssText=e:r.appendChild(t.ownerDocument.createTextNode(e));t.appendChild(r)},h=function(t,e){var r=[];Object.keys(e).forEach(function(t){var i=e[t],n=[];Object.keys(i).forEach(function(t){var e=i[t],r=u(t);n.push(r+":"+e)});var a=t+"{"+n.join("")+"}";r.push(a)});var i=r.join("");d(t,i)},f=[],p=function(t,e,r){var i=f.find(function(e){return e.el===t});if(!i||!i.names.find(function(t){return t===e})){var n="@keyframes "+e,a=[];r.forEach(function(t){var e=t.css,r=t.percent,i=[];Object.keys(e).forEach(function(t){var r=e[t],n=u(t);i.push(n+":"+r+";")});var n=i.join(" ");a.push(r+" {"+n+"}")});d(t,n+" {"+a.join("")+"}");i?i.names.push(e):f.push({el:t,names:[e]})}},g=function(t){var e=t.clientWidth,r=getComputedStyle(t),i=r.paddingLeft,n=r.paddingRight;return e-parseFloat(i)-parseFloat(n)},y=function(t){var e=t.clientHeight,r=getComputedStyle(t),i=r.paddingTop,n=r.paddingBottom;return e-parseFloat(i)-parseFloat(n)},v=function(t,e){var r=t.contentWindow["on"+e];t.contentWindow["on"+e]=function(i){r&&r(i);var n=document.createEvent("MouseEvents"),a=t.getBoundingClientRect();n.initMouseEvent(""+e,!0,!1,window,i.detail,i.screenX,i.screenY,i.clientX+a.left,i.clientY+a.top,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,null);t.dispatchEvent(n)}},m=function(t){var e=t.getBoundingClientRect(),r=document.body,i=document.documentElement,n=window.pageXOffset||i.scrollLeft||r.scrollLeft,a=i.clientLeft||r.clientLeft||0;return Math.round(e.left+n-a)},b=function(t){var e=document.createElement("textarea");e.innerHTML=t;return e.value},E=function(t){t.style.display&&"block"!==t.style.display||l(t,{display:"none"})},_=function(t){t.style.display&&"none"!==t.style.display||l(t,{display:"block"})},S=function(t){var e=window,r=t,i=document.documentElement,n=e.offsetHeight||window.innerHeight,a=!isNaN(e.scrollTop)&&e.scrollTop||(window.pageYOffset||i.scrollTop)-(i.clientTop||0);return{viewportHeight:n,viewportTop:a,viewportBottom:a+n,moduleTop:r.getBoundingClientRect().top}},T=function(t){var e=t.offsetHeight,r=parseInt(e,10),i=S(t),n=i.viewportTop,a=i.viewportBottom,o=i.moduleTop,s=Math.max(n,n+o),l=Math.min(a,s+o+r),c=Math.max(0,Math.min(r,l-s));return r&&c/r},w=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window,function(t,e,r){var i="";if(r){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3);i="; expires="+n.toUTCString()}document.cookie=t+"="+(e||"")+i+"; path=/"}),O=function(t){for(var e=t+"=",r=document.cookie.split(";"),i=0;i<r.length;i+=1){for(var n=r[i];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return null},A=function(t){var e=c(t,"div",{height:0,width:"100%",paddingBottom:"100%",position:"relative"});return c(e,"div",{position:"absolute",top:0,left:0,right:0,bottom:0})}},22:function(t,e,r){"use strict";r.d(e,"f",function(){return s});r.d(e,"s",function(){return l});r.d(e,"N",function(){return c});r.d(e,"M",function(){return u});r.d(e,"J",function(){return d});r.d(e,"K",function(){return h});r.d(e,"O",function(){return f});r.d(e,"r",function(){return p});r.d(e,"q",function(){return g});r.d(e,"t",function(){return y});r.d(e,"k",function(){return v});r.d(e,"g",function(){return m});r.d(e,"b",function(){return b});r.d(e,"d",function(){return E});r.d(e,"p",function(){return _});r.d(e,"I",function(){return S});r.d(e,"z",function(){return T});r.d(e,"w",function(){return w});r.d(e,"e",function(){return O});r.d(e,"c",function(){return A});r.d(e,"G",function(){return C});r.d(e,"j",function(){return R});r.d(e,"L",function(){return L});r.d(e,"x",function(){return k});r.d(e,"y",function(){return D});r.d(e,"F",function(){return x});r.d(e,"i",function(){return P});r.d(e,"h",function(){return I});r.d(e,"n",function(){return j});r.d(e,"m",function(){return F});r.d(e,"o",function(){return M});r.d(e,"E",function(){return N});r.d(e,"a",function(){return U});r.d(e,"H",function(){return B});r.d(e,"D",function(){return V});r.d(e,"C",function(){return G});r.d(e,"B",function(){return H});r.d(e,"l",function(){return q});r.d(e,"A",function(){return W});r.d(e,"v",function(){return Y});r.d(e,"u",function(){return z});var i=r(94),n=r(13),a=r(25),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},s=function(t,e){return{type:"CHANGE_SIZE",payload:{width:Math.ceil(t),height:Math.ceil(e)}}},l=function(t,e){return{type:"PREVIEW_UPLOADED",payload:{width:t,height:e}}},c=function(t){return{type:"UPDATE_VQ_PLAYBACK",payload:t}},u=function(t){return{type:"UPDATE_VQ_CONTROLS",payload:t}},d=function(t,e){return{type:"UPDATE_CONTROL",payload:{id:t,options:e}}},h=function(t,e){return{type:"UPDATE_PLAYBACK",payload:{id:t,options:e}}},f=function(t){return{type:"VIDEO_LOADED",payload:t}},p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;if(!t)return{type:"START",payload:r};switch(t){case a.a.ENDED:return{type:"REPLAY",payload:r};case a.a.PAUSED:return{type:"RESUME",payload:r};default:return{type:"PLAY",payload:r}}},g=function(){return{type:"PAUSE",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}},y=function(){return{type:"REPLAY",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}},v=function(){return{type:"ENDED"}},m=function(t){return{type:"CHANGE_VISIBLE",payload:t}},b=function(t,e){return{type:"CHANGE_BROWSER_TAB",payload:{hidden:t,options:e}}},E=function(t){return{type:"CHANGE_HOVER",payload:t}},_=function(){return{type:"MUTE"}},S=function(){return{type:"UNMUTE"}},T=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t;t<0?r=0:t>1&&(r=1);return{type:"SET_VOLUME",payload:{volume:r,options:e}}},w=function(t){return{type:"SET_CURRENT_TIME",payload:t}},O=function(t){return{type:"CHANGE_REMAINING_TIME",payload:t}},A=function(t){return{type:"CHANGE_BUFFER",payload:t}},C=function(){return{type:"START_REWIND",payload:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}},R=function(){return{type:"END_REWIND"}},L=function(t,e){return{type:"UPDATE_SUBTITLES",payload:{dataXml:t,style:e}}},k=function(t){return{type:"SET_CUT",payload:t}},D=function(t){return{type:"SET_FILTERS",payload:t}},x=function(){return{type:"START_BUFFERED"}},P=function(){return{type:"END_BUFFERED"}},I=function(){return{type:"DISABLE_AUTOPLAY"}},j=function(t){return function(e){e({type:"LOAD_INIT",payload:t})}},F=function(t){return function(e){e({type:"INITIALIZED_PLAYER",payload:t});var r=t.options;r&&e(Object(n.c)(r))}},M=function(t,e){return function(r){r({type:"START_LOAD_RECOMMENDATION"});r(Object(n.d)("loadRecommendation("+t+", "+JSON.stringify(e)+")"));Object(i.b)(t,o({},e,{limit:1}),"nextvideo").then(function(t){r(Object(n.d)("loadRecommendation(). result: "+JSON.stringify(t)));r({type:"RECOMMENDATION_LOADED",payload:t})},function(){r({type:"ERROR_LOAD_RECOMMENDATION"})})}},N=function(){return{type:"SHOWING_CONTROLS"}},U=function(){return{type:"BLOCK"}},B=function(t){return{type:"UNBLOCK",payload:t}},V=function(){return{type:"SHOW_SPLASH_PLAY"}},G=function(){return{type:"SHOW_SPLASH_PAUSE"}},H=function(){return{type:"SHOW_SETTINGS_PANEL"}},q=function(){return{type:"HIDE_SETTINGS_PANEL"}},W=function(){return{type:"SHOW_QUALITY_SELECT"}},Y=function(){return{type:"REQUEST_FULL_SCREEN"}},z=function(){return{type:"REQUEST_CLOSE_FULL_SCREEN"}}},23:function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},25:function(t,e,r){"use strict";e.a={STARTED:"started",ENDED:"ended",PAUSED:"paused",REPLAYED:"replayed",PLAYED:"played"}},28:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.a=function(){function t(e){i(this,t);this.viqeo=e;this._functionSubscibes=[];this._eventsList=[]}t.prototype.subscribeTracking=function(t,e){this._functionSubscibes.push(t);this.viqeo.subscribeTracking(t,e)};t.prototype.addEvent=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._eventsList.push({el:t,name:e,callback:r});t.addEventListener(e,r,i)};t.prototype.destroy=function(){var t=this;this._functionSubscibes.forEach(function(e){return t.viqeo.unsubscribeTracking(e)});this._eventsList.forEach(function(t){t.el.removeEventListener(t.name,t.callback)})};return t}()},327:function(t,e,r){"use strict";r.d(e,"b",function(){return n});var i={lib:new Promise(function(){})},n=function(t){i.lib=t};e.a=i},328:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(){var t=this;this._store.dispatch(Object(l.d)(g+".applyFilters()"));var e=this.getContainer(!0);h.a.lib(this._canvas,e).then(function(e){t._lib=e;e.setFilters(t._filters);e.start()});this._options.parent.appendChild(this._canvas);this._filterAplled=!0;Object(u.d)(this.getContainer(!0),{opacity:0});this.trigger(f.a.RESIZED)}var s=r(5),l=r(13),c=r(22),u=r(2),d=r(87),h=r(327),f=r(66),p=r(146),g="BaseVideoContainer";e.a=function(t){function e(r){i(this,e);var a=n(this,t.call.apply(t,[this].concat(r)));a._filterAplled=!1;a._canvas=document.createElement("canvas");a._video=e.createVideoTag();return a}a(e,t);e.prototype.init=function(e){var r;(r=t.prototype.init).call.apply(r,[this].concat(e));if("connection"in navigator&&navigator.connection.saveData){this._store.dispatch(Object(l.d)(g+". Disable autoplay: saveData: true"));this._store.dispatch(Object(c.h)())}};e.prototype.getThumbnail=function(){var t=this.getContainer();if(t.readyState<2){this._store.dispatch(Object(l.d)(g+".getThumbnail(): Video not loaded"));return null}var e=document.createElement("canvas"),r=e.getContext("2d");e.width=t.videoWidth;e.height=t.videoHeight;r.drawImage(t,0,0,t.videoWidth,t.videoHeight);return e.toDataURL()};e.prototype.setFilters=function(e){this._store.dispatch(Object(l.d)(g+".setFilters("+JSON.stringify(e)+")"));if(0===e.length&&0===this._filters.length)return!1;this._lib?this._lib.setFilters(e):o.call(this);return t.prototype.setFilters.call(this,e)};e.prototype.createPreview=function(){var t=this;return new Promise(function(e,r){var i=document.createElement("canvas"),n=i.getContext("2d");i.width=t._options.slotWidth;i.height=t._options.slotHeight;n.drawImage(t._video,0,0,t._options.slotWidth,t._options.slotHeight);if(i.toBlob){var a=Date.now();i.toBlob(function(t){e(new File([t],a+".jpg",{type:"image/jpeg",lastModified:a}))},"image/jpeg",1)}else r()})};e.prototype.getContainer=function(t){return this._filterAplled&&!t?this._canvas:this._video};e.prototype.requestFullScreen=function(t){s.d?this.getContainer().webkitEnterFullscreen():Object(d.c)(t)};e.prototype.closeFullScreen=function(){Object(d.a)(document)};e.prototype.destroy=function(){t.prototype.destroy.call(this);Object(u.p)(this._canvas)};e.prototype.start=function(){this._store.dispatch(Object(l.d)(g+".start()"));return this._video.paused?Object(u.o)(this._video):new Promise(function(){})};return e}(p.a)},329:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){var r=this._options,i=r.disableCors,n=r.preload;t.muted=!0;t.defaultMuted=!0;t.playsInline=!0;t.volume=0;i||(t.crossOrigin="anonymous");n?t.setAttribute("preload","auto"):t.setAttribute("preload","metadata");t.src=e;n&&t.load()}function s(){this.trigger(b.a.ERROR_VIDEO_LOAD,{url:this._file.url})}function l(){this._store.dispatch(Object(m.d)(S+".onLoadedMetadata()"));var t=this._video.videoWidth||this._options.width,e=this._video.videoHeight||this._options.height,r=this._options.files,i=r.map(function(t){return{width:t.width,height:t.height}});this.trigger(b.a.META_DATA_LOADED,_({},this._file,{width:t,height:e,qualities:i,duration:this.getDuration()}));this._oldCurrentTime&&(this._video.currentTime=this._oldCurrentTime);this.trigger(b.a.QUALITY_UPDATED,e)}function c(){this.trigger(b.a.TIME_UPDATE,this.getCurrentTime())}function u(){var t=this._video.buffered;t.length>0&&this.trigger(b.a.BUFFER_PROGRESS,t.end(t.length-1))}function d(){this.trigger(b.a.VIDEO_ENDED)}function h(){this.trigger(b.a.EXIT_FULL_SCREEN)}function f(){this._hasSeeking=!1;if(this._seekingQueue.length){var t=this._seekingQueue.pop();this._seekingQueue=[];this.seek(t)}else this.trigger(b.a.END_SEEK)}function p(t){var e=this;if(this._video){this._oldCurrentTime=this._video.currentTime;Object(v.p)(this._video)}var r=this._options.parent,i=E.a.createVideoTag();i.addEventListener("canplay",function(){return e._store.dispatch(Object(m.d)(S+" canplay triggered"))});i.addEventListener("loadedmetadata",l.bind(this));i.addEventListener("play",c.bind(this));i.addEventListener("timeupdate",c.bind(this));i.addEventListener("error",s.bind(this));i.addEventListener("abort",s.bind(this));i.addEventListener("progress",u.bind(this));i.addEventListener("ended",d.bind(this));i.addEventListener("webkitendfullscreen",h.bind(this));i.addEventListener("seeked",f.bind(this));o.call(this,i,t);r.appendChild(i);return i}var g=r(42),y=r(5),v=r(2),m=r(13),b=r(66),E=r(328),_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},S="VIdeoContainer";e.a=function(t){function e(r){i(this,e);var a=n(this,t.call.apply(t,[this].concat(r)));a._hasSeeking=!1;a._seekingQueue=[];a._file=null;a._oldCurrentTime=null;return a}a(e,t);e.prototype.init=function(e){t.prototype.init.call(this,e);this._store.dispatch(Object(m.d)(S+".init()"));this._seekingQueue=[];var r=this._options,i=r.files,n=r.slotWidth,a=r.slotHeight,o=r.defaultQuality,s=void 0;if(o){var l=parseInt(o,10);s=i.find(function(t){return t.height===l})}s||(s=Object(g.a)(i,n,a));this._file=s;this._video=p.call(this,s.url);this.trigger(b.a.QUALITY_UPDATED,s.height)};e.prototype.setVolume=function(t){this._store.dispatch(Object(m.d)(S+".setVolume("+t+")"));this._video.volume=t;this._video.muted=0===t};e.prototype.play=function(){this._store.dispatch(Object(m.d)(S+".play()"));this._video.paused&&Object(v.o)(this._video)};e.prototype.pause=function(){this._store.dispatch(Object(m.d)(S+".pause()"));this._video.paused||this._video.pause()};e.prototype.getDuration=function(){return this._video.duration};e.prototype.getCurrentTime=function(){return this._video.currentTime};e.prototype.seek=function(t){this._store.dispatch(Object(m.d)(S+".seek("+t+")"));if(this._hasSeeking)this._seekingQueue.push(t);else{this.trigger(b.a.START_SEEK);this._video.currentTime=t}this._hasSeeking=!0};e.prototype.destroy=function(){this._store.dispatch(Object(m.d)(S+".destroy()"));t.prototype.destroy.call(this);Object(v.p)(this._video)};e.prototype.setQuality=function(t){this._store.dispatch(Object(m.d)(S+".setQuality("+t+")"));if(t){var e=this._options.files,r=e.find(function(e){return e.height===t}),i=r.url;if(i!==this._video.src){this._video=p.call(this,i);this.trigger(b.a.QUALITY_UPDATED,t)}}else this.setQuality(this._file.height)};e.create=function(t){var r=Object(g.b)(t,"application/x-mpegURL"),i=Object(g.b)(t,"video/mpeg"),n=Object(g.b)(t,"video/mp4"),a=void 0,o=void 0;if(y.a&&n.length||!i.length&&n.length||!i.length&&!n.length&&t.length||r.length&&y.d&&y.a){var s=n.length?n:t;if(r.length&&y.d){s=r;a=n[0]?n[0].width:1;o=n[0]?n[0].height:1}return new e({files:s,width:a,height:o})}return null};return e}(E.a)},330:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">\n  <path d="M0 0h24v24H0z" fill="none"/>\n  <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z" fill="white"/>\n</svg>\n'},331:function(t,e,r){t.exports=r.p+"empty-slot-background.jpg"},332:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 128 128"><path fill="none" stroke="url(#a)" stroke-width="2.77" d="M1252.52 595.235c-5.04 3.287-11.05 5.2-17.5 5.2-17.7 0-32.07-14.368-32.07-32.064 0-17.694 14.37-32.06 32.07-32.06 15.31 0 28.13 10.756 31.3 25.118" transform="translate(-2164.94 -961.788) scale(1.8048)"/><defs><radialGradient id="a" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="rotate(-3.67 9382.41 -18979.953) scale(36.57698)"><stop offset="0%" stop-color="#79669C" stop-opacity="0"/><stop offset="95%" stop-color="#79669C"/><stop offset="100%" stop-color="#fff"/></radialGradient></defs></svg>'},333:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(102),c=r(5),u=r(534),d=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(d.a)({},[{getValues:function(t){return{type:t.vqControls.appearance.type}},onChange:a.changeAppearance.bind(a)}],a.store);return a}a(e,t);e.prototype.render=function(){this.changeAppearance()};e.prototype.getAnimationType=function(){return this.store.getState().vqControls.appearance.type};e.prototype._getAnimationData=function(){var t=this.getAnimationType();return u.a[t]||u.a[l.b]};e.prototype.changeAppearance=function(){var t=this,e=this.store.getState(),r=e.options.hasOverlayMode,i=this._getAnimationData(),n={webkitTransition:i.name+" 500ms ease-in-out",transition:i.name+" 500ms ease-in-out"};Object(s.d)(this.container,n);this.applyStyle(c.f);if(r){this.timeout&&clearTimeout(this.timeout);this.timeout=setTimeout(function(){Object(s.d)(t.container,n);t.applyStyle(!0)},500)}};e.prototype.applyStyle=function(t){var e=this._getAnimationData();t?Object(s.d)(this.container,e.activeCss):Object(s.d)(this.container,e.inActiveCss)};return e}(o.a)},334:function(t,e,r){"use strict";r.d(e,"c",function(){return i});r.d(e,"d",function(){return n});r.d(e,"b",function(){return a});r.d(e,"a",function(){return o});var i=function(t){return{type:"API_INIT_ADVERT",payload:t}},n=function(){return{type:"API_START_ADVERT"}},a=function(){return{type:"ADVERT_STARTED"}},o=function(){return{type:"ADVERT_ENDED"}}},335:function(t,e,r){"use strict";r.d(e,"d",function(){return n});r.d(e,"b",function(){return a});r.d(e,"c",function(){return o});r.d(e,"a",function(){return s});var i=function(){return{type:"SPRITE_LOADED"}},n=function(t){return function(e){e({type:"SPRITE_LOAD"});var r=new Image;r.addEventListener("load",function(){return e(i())});r.src=t}},a=function(t){return{type:"TIME_LINE_MOUSE_ENTER",payload:t}},o=function(){return{type:"TIME_LINE_MOUSE_LEAVE"}},s=function(t){return{type:"UPDATE_TIME_LINE_TIME",payload:t}}},336:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path d="M0 0h24v24H0z" fill="none"/>\n  <path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM4 12h4v2H4v-2zm10 6H4v-2h10v2zm6 0h-4v-2h4v2zm0-4H10v-2h10v2z"/>\n</svg>\n'},337:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path d="M0 0h24v24H0z" fill="none"/><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>\n</svg>\n'},338:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(148),c=r(10),u=r(12),d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.iframe=r.iframe;a.mouseEvent={mouseOut:{height:"3px"},mouseIn:{height:"6px"}};Object(u.a)(a,[{getValues:function(t){return{vqControls:t.vqControls}},onChange:a.updateControl.bind(a)},{getValues:function(t){return{hasHover:t.player.hasHover}},onChange:a.updateHover.bind(a)},{getValues:function(t){return{buffer:t.player.buffer}},onChange:a.updateBuffer.bind(a)},{getValues:function(t){return{hidden:t.vqControls.progress.hidden}},onChange:a.updateVisible.bind(a)},{getValues:function(t){return{currentTime:t.player.currentTime}},onChange:a.updateCurrentTime.bind(a)}],a.store);return a}a(e,t);e.prototype.render=function(){var t=this.store.getState(),r=t.vqControls.progress,i=r.color,n=r.bgcolor;this.container=document.createElement("div");Object(s.d)(this.container,{position:"absolute",zIndex:c.a.progress,bottom:0,left:0,width:"100%",height:l.a+"px"});this.background=Object(s.c)(this.container,"div",{position:"absolute",zIndex:10,bottom:0,left:0,width:"100%",cursor:"pointer",background:n,transition:"height 1s"});this.progressBar=Object(s.c)(this.background,"div",d({position:"absolute",zIndex:30,bottom:0,left:0,width:"100%",height:"100%",cursor:"pointer",opacity:.8,background:i,transition:"height 1s"},e._getTransform(0)));this.bufferBar=Object(s.c)(this.background,"div",d({position:"absolute",width:"100%",height:"100%",opacity:.5,background:i},e._getTransform(0)));this.runner=Object(s.c)(this.background,"div",{position:"absolute",zIndex:30,left:0,cursor:"pointer",background:i,display:"none"});this.updateControl();this.updateVisible();this.updateBuffer();this.updateHover()};e.prototype.hasDisable=function(){return this.store.getState().vqControls.progress.hidden};e.prototype.updateControl=function(){var t=this.store.getState(),e=t.vqControls.progress,r=e.color,i=e.bgcolor;Object(s.d)([this.runner,this.bufferBar,this.progressBar],{background:r});Object(s.d)(this.background,{background:i})};e.prototype.updateHover=function(){var t=this.store.getState(),e=t.player.hasHover;Object(s.d)(this.background,e?this.mouseEvent.mouseIn:this.mouseEvent.mouseOut)};e._getTransform=function(t){var e="translate(-"+(100-t)+"%, 0)";return{msTransform:e,webkitTransform:e,transform:e}};e.prototype.updateCurrentTime=function(){var t=this.store.getState(),r=t.player,i=r.currentTime,n=r.duration;Object(s.d)(this.progressBar,d({},e._getTransform(i/n*100)))};e.prototype.updateBuffer=function(){var t=this.store.getState(),r=t.player,i=r.buffer,n=r.duration,a=void 0;a=i>n?100:i/n*100;Object(s.d)(this.bufferBar,d({},e._getTransform(a)))};e.prototype.updateVisible=function(){this.store.getState().vqControls.progress.hidden?this.hide():this.show()};return e}(o.a)},35:function(t,e){t.exports={editor:"vn_editor",stats:"vn_stats",player:"vn_player",starter:"vq_starter",playerInit:"vq_player_init",editorInit:"vq_editor_init",initExternalPlayer:"vq_init_external_player",initInternalPlayer:"vq_init_internal_player",wordpressPluginInit:"vq_wordpress_plugin_init",wordpressButton:"vq_wordpress_button",gallery:"vq_gallery"}},359:function(t,e,r){"use strict";var i=r(14).compose;e.__esModule=!0;e.composeWithDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?i:i.apply(null,arguments)};e.devToolsEnhancer="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(t){return t}}},39:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(){function t(){i(this,t);this.eventListeners={};this.listeners=[]}t.prototype.subscribe=function(t,e){this.eventListeners[e]=[].concat(this.eventListeners[e]||[],t)};t.prototype.subscribeAll=function(t){this.listeners.push(t)};t.prototype.subscribeOnce=function(t,e){var r=this;this.subscribe(function i(){t.apply(void 0,arguments);r.unsubscribe(i,e)},e)};t.prototype.unsubscribe=function(t,e){this.eventListeners[e]=[].concat(this.eventListeners[e]||[]).filter(function(e){return e!==t})};t.prototype.unsubscribeAll=function(){this.eventListeners={};this.listeners=[]};t.prototype.trigger=function(t){for(var e=this,r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];(this.eventListeners[t]||[]).forEach(function(t){return t.apply(e,i)});this.listeners.forEach(function(r){return r.apply(e,[n({type:t},i)])})};return t}()},4:function(t,e,r){"use strict";r.d(e,"q",function(){return c});r.d(e,"n",function(){return u});r.d(e,"w",function(){return d});r.d(e,"d",function(){return h});r.d(e,"v",function(){return f});r.d(e,"b",function(){return p});r.d(e,"B",function(){return g});r.d(e,"s",function(){return y});r.d(e,"y",function(){return v});r.d(e,"D",function(){return m});r.d(e,"u",function(){return b});r.d(e,"i",function(){return E});r.d(e,"z",function(){return _});r.d(e,"E",function(){return S});r.d(e,"g",function(){return T});r.d(e,"a",function(){return w});r.d(e,"c",function(){return O});r.d(e,"e",function(){return A});r.d(e,"o",function(){return C});r.d(e,"C",function(){return L});r.d(e,"m",function(){return k});r.d(e,"k",function(){return D});r.d(e,"h",function(){return x});r.d(e,"f",function(){return P});r.d(e,"r",function(){return I});r.d(e,"t",function(){return j});r.d(e,"j",function(){return F});r.d(e,"A",function(){return M});r.d(e,"l",function(){return N});r.d(e,"p",function(){return U});r.d(e,"x",function(){return B});var i=r(40),n=(r(2),r(5)),a=r(19),o=r(43),s=r.n(o),l=this,c=("function"==typeof Symbol&&Symbol,function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window.document;if(t){a.a.time("utils.loadScript("+t+")");var n=i.getElementsByTagName("head")[0],o=i.createElement("script");o.src=t;o.type="text/javascript";o.charset="UTF-8";o.addEventListener("load",function(){a.a.timeEnd("utils.loadScript("+t+")");e&&e()});o.addEventListener("error",function(){a.a.error("utils.loadScript("+t+") Failed load");r&&r()});n.appendChild(o)}}),u=function(t,e,r){var i=t&&e?t.querySelector(e):t,n=i&&i.textContent;return"string"==typeof n?n.trim():r},d=function(t,e){if(t){var r=new Image;r.src=t;e&&(r.onerror=e)}},h=function(t){return JSON.parse(JSON.stringify(t))},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t.split("?")[1]||"",r=e?e.split("&"):[];return Object.keys(r).reduce(function(t,e){var i=r[e],n=i.split("="),a=n[0]&&decodeURIComponent(n[0]),o=n[1]&&decodeURIComponent(n[1]);t[a]=o&&o.replace(/\+/g," ");return t},{})},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];Object.keys(e).forEach(function(t){var i=e[t],n=[encodeURIComponent(t)];if(Array.isArray(i)){var a=encodeURIComponent("[]");i.forEach(function(t){var e=encodeURIComponent(t);r.push(""+n+a+"="+e)})}else{null!==i&&void 0!==i&&n.push(encodeURIComponent(i));r.push(n.join("="))}});var i=t.indexOf("?")>-1?"&":"?";return r.length?t+i+r.join("&"):t},g=function(t){return"//"===t.substring(0,2)?document.location.protocol+t:"/"===t.substring(0,1)?document.location.protocol+"//"+document.location.hostname+t:t},y=function(t){if(t)if(n.d){var e=document.createElement("a");e.setAttribute("href",t);e.setAttribute("target","_blank");var r=document.createEvent("HTMLEvents");r.initEvent("click",!0,!0);e.dispatchEvent(r)}else window.open(t,"_blank");else a.a.warn("utils.openUrl("+t+") invalid url")},v=function(t,e,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"GET",a=arguments[5],o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!t)return null;var s=window.XDomainRequest?window.XDomainRequest:XMLHttpRequest,c=new s;i&&c.overrideMimeType&&c.overrideMimeType(i);e&&(c.onload=e.bind(l,c));r&&(c.onerror=r.bind(l,c));c.open(n,t,!0);c.withCredentials=o;var u=null;if(a){c.setRequestHeader("Content-type","application/json");u=JSON.stringify(a)}c.send(u);return c},m=function(t,e,r,i,n){var a=new XMLHttpRequest;a.withCredentials=!0;r&&a.addEventListener("load",r.bind(l,a));i&&a.addEventListener("error",i.bind(l,a));n&&a.upload.addEventListener("progress",n);a.open("POST",t,!0);a.send(e);return a},b=function(t){if("0"===t)return null;var e=/^\s*(?:(?:(\d+):)?(\d+):)?(\d+)(?:[.,](\d+))?\s*$/.exec(t);return e?(60*(+e[1]||0)*60*1e3+60*(+e[2]||0)*1e3+1e3*(+e[3]||0)+(+e[4]||0))/1e3:null},E=function(t){try{return JSON.parse(localStorage.getItem(t))||!1}catch(t){return!1}},_=function(t,e){try{return localStorage.setItem(t,e)}catch(t){return!1}},S=function(t){return t>9?t:"0"+t},T=function(t){return[t.getFullYear(),S(t.getMonth()+1),S(t.getDate())].join("-")},w=function(t){var e=performance.now(),r=function r(i){var n=(i-e)/t.duration;n>1&&(n=1);var a=t.timing(n);t.draw(a);n<1&&requestAnimationFrame(r)};requestAnimationFrame(r)},O=function(t,e,r,i,n){var a=Math.min;"crop"===n&&(a=Math.max);var o=a(r/t,i/e);return{width:t*o,height:e*o}},A=function(t){var e=Math.floor(t/60),r=t-60*e;return[S(e),S(r)].join(":")},C=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,e="",r=0;r<t;r+=1)e+=Math.random().toString(16).slice(-4);return e},R=function(t){var e=Math.round(1e3*t)-1e3*Math.floor(t),r=S(parseInt(Math.floor(t)%60,10)),i=S(parseInt(Math.floor(t)/60%60,10));return S(parseInt(Math.floor(t)/60/60%60,10))+":"+i+":"+r+"."+e},L=function(t){return t.parsedSubtitles.map(function(t,e){return e+1+"\n"+R(t.startTime)+" --\x3e "+R(t.endTime)+"\n"+t.text+"\n"}).join("\n")},k=function(t){var e=t.video,r=t.preview,n=t.subtitles,a=t.preset,o=t.editing,s=e.selectedVideoFile,l=e.prodVideoFile,c=e.prodDisableAdvert,u=e.selectedDisableAdvert,d=r.selectedPreviewFile,h=r.prodPreviewFile,f=n.selectedSubtitle,p=n.prodSubtitle,g=n.selectedSubtitlePreset,y=n.prodSelectedSubtitlePreset,v=n.selectedStyles,m=n.prodStyles,b=n.subtitlesList,E=n.prodSubtitlesList,_=o.appliedEffects,S=o.selectAppliedEffects,T=a.selectedItem,w=a.prodItem,O=a.prodSettings,A=a.currentSettings,C=[];c!==u&&C.push({type:"videoAdvert",selected:u,prod:c});s!==l&&C.push({type:"video",selected:s,prod:l});d!==h&&C.push({type:"preview",selected:d,prod:h});f.id!==p.id&&C.push({type:"subtitle",selected:f,prod:p});var R=Object(i.a)(b,E);if(R){var L=R[0].path[0];C.push({type:"subtitlesList",selected:b[L],prod:E[L]})}g!==y?C.push({type:"preset_subtitle",selected:{id:g}}):Object(i.a)(m,v)&&C.push({type:"subtitle_styles",selected:v});T&&T.id&&T.id!==w.id?C.push({type:"preset",selected:T}):Object(i.a)(O,A)&&C.push({type:"edit_preset",selected:A});Object(i.a)(_,S)&&C.push({type:"filters",selected:S,item:s});return C},D=function(t){var e=0;t&&t.cut&&(e=t.cut.from/1e3);return e},x=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=String(t).split("."),i=r[0],n=r[1];n&&n.length>e&&(n=n.slice(0,e));return parseFloat(i+"."+n)},P=function(t){var e=document.createElement("textarea");e.style.position="fixed";e.style.top=0;e.style.left=0;e.style.width="2em";e.style.height="2em";e.style.padding=0;e.style.border="none";e.style.outline="none";e.style.boxShadow="none";e.style.background="transparent";e.value=t;document.body.appendChild(e);e.select();try{document.execCommand("copy")}catch(t){}document.body.removeChild(e)},I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return 0===(""+t).length||/%|px/.test(""+t)?""+t:t+"px"},j=function(t){var e=void 0;try{e=JSON.parse(t)}catch(t){return!1}return e},F=function(){return window.navigator.language&&"ru"===window.navigator.language.substring(0,2)?"ru":"en"},M=function(t,e){var r=window,i=r.vqLogger,n=e.getState(),a=i?i.getLogs():["Not found logs"],o=C(4);v(t.baseUrl+"/debug",!1,!1,!1,"POST",{debug_info:JSON.stringify({logs:a,playerState:n}),hash:o});s()(o)},N=function(){var t=window.location;return t.origin?t.origin:t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")},U=function(t){return new RegExp(/^((https?:\/\/)|^(\/\/))([wW]{3}\.)?(([yY][oO][uU][tT][uU][bB][eE](-nocookie)?.com)|([yY][oO][uU][tT][uU]\.[bB][eE]))/).test(t)},B=function(t,e,r){return t.substr(0,e)+r+t.substr(e+r.length)}},40:function(t,e,r){"use strict";(function(t){function r(t,e){t.super_=e;t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}function i(t,e){Object.defineProperty(this,"kind",{value:t,enumerable:!0});e&&e.length&&Object.defineProperty(this,"path",{value:e,enumerable:!0})}function n(t,e,r){n.super_.call(this,"E",t);Object.defineProperty(this,"lhs",{value:e,enumerable:!0});Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function a(t,e){a.super_.call(this,"N",t);Object.defineProperty(this,"rhs",{value:e,enumerable:!0})}function o(t,e){o.super_.call(this,"D",t);Object.defineProperty(this,"lhs",{value:e,enumerable:!0})}function s(t,e,r){s.super_.call(this,"A",t);Object.defineProperty(this,"index",{value:e,enumerable:!0});Object.defineProperty(this,"item",{value:r,enumerable:!0})}function l(t,e,r){var i=t.slice((r||e)+1||t.length);t.length=e<0?t.length+e:e;t.push.apply(t,i);return t}function c(t){var e=typeof t;return"object"!==e?e:t===Math?"math":null===t?"null":Array.isArray(t)?"array":"[object Date]"===Object.prototype.toString.call(t)?"date":"function"==typeof t.toString&&/^\/.*\//.test(t.toString())?"regexp":"object"}function u(t,e,r,i,d,h,f){d=d||[];f=f||[];var p=d.slice(0);if(void 0!==h){if(i){if("function"==typeof i&&i(p,h))return;if("object"==typeof i){if(i.prefilter&&i.prefilter(p,h))return;if(i.normalize){var g=i.normalize(p,h,t,e);if(g){t=g[0];e=g[1]}}}}p.push(h)}if("regexp"===c(t)&&"regexp"===c(e)){t=t.toString();e=e.toString()}var y=typeof t,v=typeof e,m="undefined"!==y||f&&f[f.length-1].lhs&&f[f.length-1].lhs.hasOwnProperty(h),b="undefined"!==v||f&&f[f.length-1].rhs&&f[f.length-1].rhs.hasOwnProperty(h);if(!m&&b)r(new a(p,e));else if(!b&&m)r(new o(p,t));else if(c(t)!==c(e))r(new n(p,t,e));else if("date"===c(t)&&t-e!=0)r(new n(p,t,e));else if("object"===y&&null!==t&&null!==e)if(f.filter(function(e){return e.lhs===t}).length)t!==e&&r(new n(p,t,e));else{f.push({lhs:t,rhs:e});if(Array.isArray(t)){var E;for(E=0;E<t.length;E++)E>=e.length?r(new s(p,E,new o(void 0,t[E]))):u(t[E],e[E],r,i,p,E,f);for(;E<e.length;)r(new s(p,E,new a(void 0,e[E++])))}else{var _=Object.keys(t),S=Object.keys(e);_.forEach(function(n,a){var o=S.indexOf(n);if(o>=0){u(t[n],e[n],r,i,p,n,f);S=l(S,o)}else u(t[n],void 0,r,i,p,n,f)});S.forEach(function(t){u(void 0,e[t],r,i,p,t,f)})}f.length=f.length-1}else t!==e&&("number"===y&&isNaN(t)&&isNaN(e)||r(new n(p,t,e)))}function d(t,e,r,i){i=i||[];u(t,e,function(t){t&&i.push(t)},r);return i.length?i:void 0}function h(t,e,r){if(r.path&&r.path.length){var i,n=t[e],a=r.path.length-1;for(i=0;i<a;i++)n=n[r.path[i]];switch(r.kind){case"A":h(n[r.path[i]],r.index,r.item);break;case"D":delete n[r.path[i]];break;case"E":case"N":n[r.path[i]]=r.rhs}}else switch(r.kind){case"A":h(t[e],r.index,r.item);break;case"D":t=l(t,e);break;case"E":case"N":t[e]=r.rhs}return t}function f(t,e,r){if(t&&e&&r&&r.kind){for(var i=t,n=-1,a=r.path?r.path.length-1:0;++n<a;){void 0===i[r.path[n]]&&(i[r.path[n]]="number"==typeof r.path[n]?[]:{});i=i[r.path[n]]}switch(r.kind){case"A":h(r.path?i[r.path[n]]:i,r.index,r.item);break;case"D":delete i[r.path[n]];break;case"E":case"N":i[r.path[n]]=r.rhs}}}function p(t,e,r){if(r.path&&r.path.length){var i,n=t[e],a=r.path.length-1;for(i=0;i<a;i++)n=n[r.path[i]];switch(r.kind){case"A":p(n[r.path[i]],r.index,r.item);break;case"D":case"E":n[r.path[i]]=r.lhs;break;case"N":delete n[r.path[i]]}}else switch(r.kind){case"A":p(t[e],r.index,r.item);break;case"D":case"E":t[e]=r.lhs;break;case"N":t=l(t,e)}return t}function g(t,e,r){if(t&&e&&r&&r.kind){var i,n,a=t;n=r.path.length-1;for(i=0;i<n;i++){void 0===a[r.path[i]]&&(a[r.path[i]]={});a=a[r.path[i]]}switch(r.kind){case"A":p(a[r.path[i]],r.index,r.item);break;case"D":case"E":a[r.path[i]]=r.lhs;break;case"N":delete a[r.path[i]]}}}function y(t,e,r){if(t&&e){u(t,e,function(i){r&&!r(t,e,i)||f(t,e,i)})}}var v,m,b=[];v="object"==typeof t&&t?t:"undefined"!=typeof window?window:{};m=v.DeepDiff;m&&b.push(function(){if(void 0!==m&&v.DeepDiff===d){v.DeepDiff=m;m=void 0}});r(n,i);r(a,i);r(o,i);r(s,i);Object.defineProperties(d,{diff:{value:d,enumerable:!0},observableDiff:{value:u,enumerable:!0},applyDiff:{value:y,enumerable:!0},applyChange:{value:f,enumerable:!0},revertChange:{value:g,enumerable:!0},isConflict:{value:function(){return void 0!==m},enumerable:!0},noConflict:{value:function(){if(b){b.forEach(function(t){t()});b=null}return d},enumerable:!0}});e.a=d}).call(e,r(23))},42:function(t,e,r){"use strict";r.d(e,"b",function(){return n});r.d(e,"a",function(){return a});r.d(e,"d",function(){return o});r.d(e,"e",function(){return s});r.d(e,"c",function(){return u});r.d(e,"f",function(){return d});var i=r(4),n=function(t,e){var r=[];if(!t)return r;t.forEach(function(t){t.type===e&&r.push(t)});return r},a=function(t,e,r){var i=[];t.forEach(function(t){i.push(t.width*t.height)});for(var n=e*r,a=1/0,o=i.indexOf(Math.max.apply(Math,i)),s=0;s<i.length;s+=1){var l=i[s]-n;if(l<a&&l>=0){a=l;o=s}}return t[o]},o=function(t){var e=/(\d+)\n([\d:.,]+)\s*-->\s*([\d:.,]+)\n((?:.|\n)+)/m;return t.replace(/^[^\S\n]*(.+)[^\S\n]*$/gm,"$1").replace(/\r/g,"\n").split("\n\n").map(function(t){var r=e.exec(t);return!!r&&{id:r[1],startTime:Object(i.u)(r[2]),endTime:Object(i.u)(r[3]),text:r[4]}}).filter(Boolean)},s=function(t){var e=/(\d+)\n([\d:.,]+)\s*-->\s*([\d:.,]+)\n((?:.|\n)+)/m;return t.replace(/^[^\S\n]*(.+)[^\S\n]*$/gm,"$1").replace(/\r/g,"\n").split("\n\n").map(function(t){var r=e.exec(t);return!!r&&{id:r[1],startTime:Object(i.u)(r[2]),endTime:Object(i.u)(r[3]),text:r[4]}}).filter(Boolean)},l=function(t){if(!t)return[];var e=Object(i.n)(t);return s(e)},c=function(t){var e={};if(!t)return e;var r=Object(i.n)(t);return JSON.parse(r)},u=function(t){var e={data:[],settings:{}};if(!t)return e;var r=t.querySelector('Extension[type="vqSubtitles"]');if(!r)return e;e.data=l(r.querySelector("data"));e.settings=c(r.querySelector("settings"));return e},d=function(t){if(!t)return{};var e=t.thumb,r=t.width,i=t.height,n=e.match(/\d+/g),a=0,o=0;if(n&&n.length>=2){a=Number(n[0]);o=Number(n[1])}return{width:Number(r)||0,height:Number(i)||0,tileWidth:a,tileHeight:o}}},43:function(t,e){function r(t){if(navigator.clipboard)return navigator.clipboard.writeText(t);var e=document.createElement("span");e.textContent=t;e.style.whiteSpace="pre";var r=document.createElement("iframe");r.sandbox="allow-same-origin";document.body.appendChild(r);var i=r.contentWindow;i.document.body.appendChild(e);var n=i.getSelection();if(!n){i=window;n=i.getSelection();document.body.appendChild(e)}var a=i.document.createRange();n.removeAllRanges();a.selectNode(e);n.addRange(a);var o=!1;try{o=i.document.execCommand("copy")}catch(t){}n.removeAllRanges();i.document.body.removeChild(e);document.body.removeChild(r);return o?Promise.resolve():Promise.reject()}t.exports=r},44:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(35),s=r.n(o),l=r(45);e.a=new(function(t){function e(){i(this,e);var a=n(this,t.call(this)),o=r(46).version;a.baseUrl="//api.viqeo.tv/v1";a.statsUrl="//stats.viqeo.tv";a.staticUrl="//cdn.viqeo.tv/js";a.playerHomeUrl="https://viqeo.tv";a.personalUrl="https://viqeo.tv/personal/";a.statsScriptUrl=a.staticUrl+"/"+s.a.stats+".js?v="+o;a.editorScriptUrl=a.staticUrl+"/"+s.a.editor+".js?v="+o;a.playerScriptUrl=a.staticUrl+"/"+s.a.player+".js?v="+o;a.initInternalPlayerUrl=a.staticUrl+"/"+s.a.initInternalPlayer+".js";a.galleryScriptUrl=a.staticUrl+"/"+s.a.gallery+".js?v="+o;a.embedUrl="https://cdn.viqeo.tv";a.errorTrackerUrl="http://error.viqeo.tv";a.proxyUrl="//cdn.viqeo.tv/v1/proxy";a.ampAdvertUrl="https://amptracker.viqeo.tv";return a}a(e,t);return e}(l.a))},45:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.a=function t(){i(this,t);this.baseUrl="";this.statsUrl="";this.staticUrl="";this.playerHomeUrl="";this.personalUrl="";this.statsScriptUrl="";this.editorScriptUrl="";this.playerScriptUrl="";this.initInternalPlayerUrl="";this.galleryScriptUrl="";this.embedUrl="";this.errorTrackerUrl="";this.advertDataUrl="";this.advertModuleUrl="";this.proxyUrl="";this.ampAdvertUrl=""}},46:function(t,e){t.exports={name:"viqeo-player",version:"0.3.31",main:"lib/index.js",scripts:{"watch player":"./node_modules/.bin/cross-env SERVER=local NODE_ENV=development ./node_modules/.bin/webpack --watch --config ./internals/webpack.config.debug.js","build player":"NODE_ENV=production ./node_modules/.bin/webpack","watch plugin":"./node_modules/.bin/cross-env SERVER=plugin NODE_ENV=development ./node_modules/.bin/webpack --watch --config ./internals/webpack.config.plugin.js",eslint:"eslint --ext .jsx,js src",stylelint:"stylelint src/**/*.css","start manual server test":"node ./tests/manual/","test:single":"rm -rf tmp/ && ./node_modules/.bin/karma start karma.conf.js --single-run","test:watch":"karma start karma.conf.js"},"pre-commit":["eslint"],keywords:["videonow","viqeo","test2"],license:"UNLICENSED",private:!0,dependencies:{"babel-core":"6.25.0","babel-loader":"7.1.1","babel-plugin-transform-helper":"0.0.6","babel-plugin-transform-object-rest-spread":"6.23.0","babel-preset-latest":"6.24.1","babel-runtime":"6.25.0","chart.js":"^2.7.2","cross-env":"3.2.4",moment:"^2.23.0",pug:"^2.0.0-rc.4","raw-loader":"0.5.1","rc-slider":"^8.6.3","react-dropzone":"^4.1.2","react-redux-i18n":"^1.8.0","react-select":"^1.0.0-rc.5","strip-loader":"0.1.2",svgo:"0.7.2","svgo-loader":"1.2.1","throttle-debounce":"^1.0.1",webpack:"3.4.1","xml-js":"^1.5.1"},devDependencies:{autoprefixer:"^7.1.2","babel-plugin-add-module-exports":"^0.2.1","babel-preset-react":"^6.24.1","clipboard-copy":"^2.0.1","copy-webpack-plugin":"^4.0.1","css-loader":"^0.28.4",dashjs:"^2.9.2","deep-diff":"^0.3.8",eslint:"4.3.0","eslint-config-airbnb-base":"11.3.1","eslint-import-resolver-webpack":"0.8.3","eslint-plugin-import":"2.7.0","eslint-plugin-jasmine":"^2.10.1","eslint-plugin-jsx-a11y":"^6.0.2","eslint-plugin-react":"^7.0.1",express:"^4.15.3","file-loader":"^0.11.2","hls.js":"^0.12.2","jasmine-core":"^3.1.0",karma:"^2.0.2","karma-browserstack-launcher":"^1.3.0","karma-chrome-launcher":"^2.2.0","karma-jasmine":"^1.1.2","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-phantomjs-launcher":"^1.0.4","karma-webpack":"^3.0.0","material-ui":"^0.19.4",mocha:"^5.2.0","phantomjs-prebuilt":"^2.1.16","postcss-icss-values":"^2.0.1","postcss-loader":"^2.0.6","pre-commit":"^1.2.2","raw-loader":"^0.5.1",react:"^16.2.0","react-click-outside":"^2.3.1","react-color":"^2.13.8","react-dom":"^16.2.0","react-redux":"^5.0.5",redux:"^3.7.2","redux-devtools-extension":"^2.13.2","redux-thunk":"^2.2.0","style-loader":"^0.18.1",stylelint:"^8.0.0","stylelint-config-standard":"^17.0.0","svg-url-loader":"^2.1.1","viqeo-authorization":"git+ssh://git@bitbucket.org/videonow/viqeo-authorization.git#v0.0.7","viqeo-filters":"git+ssh://git@bitbucket.org/videonow/viqeo-image-filters.git#0.0.9","viqeo-front-common":"git+ssh://git@bitbucket.org/videonow/viqeo-front-common.git#v0.0.10","webpack-conditional-loader":"^1.0.12",ws:"2.2.1"},browserslist:["Chrome >= 20","Firefox >= 24","Edge >= 12","Explorer >= 10","iOS >= 5","Safari >= 5","Android >= 2.3","Opera >= 15"],engines:{node:"6",npm:"3"}}},5:function(t,e,r){"use strict";r.d(e,"e",function(){return f});r.d(e,"g",function(){return p});r.d(e,"b",function(){return y});r.d(e,"c",function(){return v});r.d(e,"d",function(){return _});r.d(e,"f",function(){return T});r.d(e,"a",function(){return O});r.d(e,"h",function(){return A});r.d(e,"i",function(){return C});var i=navigator,n=i.userAgent,a=i.vendor,o=i.plugins,s=i.appVersion,l=i.platform,c=window,u=c.opera,d=c.MSStream,h=n||a||u,f=!!window.MSInputMethodContext&&!!document.documentMode,p=/^((?!chrome|android).)*safari/i.test(h),g=function(){var t=h.match(/Chrom(e|ium)\/([0-9]+)\./);return!!t&&parseInt(t[2],10)}(),y=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),v=/Firefox/.test(h),m=/iPod/.test(h)&&!d,b=/iPhone/.test(h)&&!d,E=/iPad/.test(h)&&!d,_=m||b||E,S=/android/i.test(h),T=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(h)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(h.substr(0,4)),w=((void 0===o||0===o.length)&&("undefined"==typeof ActiveXObject||new ActiveXObject("ShockwaveFlash.ShockwaveFlash")),/Edge/.test(h),function(){if(!_)return!1;if("string"!=typeof s)return!1;var t=s.match(/OS (\d+)_(\d+)_?(\d+)?/);return!!t&&parseFloat(t[1]+"."+t[2])}()),O=!T||_&&w>10.2||S&&g&&g>=53||S&&v,A=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,e);window.removeEventListener("testPassive",null,e)}catch(e){t=!1}return t}(),C=("WebKitMediaSource"in window||window,!!l&&l.indexOf("Win")>-1)},50:function(t,e,r){"use strict";var i=r(2),n=r(5),a=r(100),o=r.n(a),s=r(101),l=r.n(s);e.a=function(t,e){var r=Object(i.c)(t,"div",{position:"absolute",width:"100%",height:"100%",bottom:0,left:0,zIndex:10},""+o.a+(e||l.a));r.firstElementChild.style.display="block";r.lastElementChild.style.display="none";if(!n.f){t.addEventListener("mouseenter",function(){r.lastElementChild.style.display="block"});t.addEventListener("mouseleave",function(){r.lastElementChild.style.display="none"})}Object(i.d)(r.firstElementChild,{position:"absolute",width:"100%",height:"100%",top:"0px",left:"0px"});Object(i.d)(r.lastElementChild,{position:"absolute",width:"100%",height:"100%",top:"0px",left:"0px"});return t}},501:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(39),s=r(5),l=r(2),c=r(7),u=r(93),d=r(327),h=r(502),f=r(507),p=r(581),g=r(582),y=r(25),v=r(599),m=r(22),b=r(13),E=r(334),_=r(12);e.a=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var a=n(this,t.call(this,r));a.options=r;a.store=Object(g.a)({name:r.data.npvid,actionsBlacklist:c.a.actionsBlacklistPlayer});a._eventLayout=new p.a({store:a.store,eventEmitter:a});a._trackerLayout=new v.a(a.store);a._trackersFn=[];r.trackerFn&&a._trackersFn.push(r.trackerFn);var o=r.slot,l=r.originalSlot;a.slot=o;a.store.dispatch(Object(m.m)(r));a.previewVideo=r.previewVideo;a.wrapper=document.createElement("div");a.slot.appendChild(a.wrapper);a.iframe=new f.a({parent:a.wrapper,store:a.store,player:a,callbacks:{onCreateVpaid:function(t){a.vpaid=t}}});var u=o;l&&(u=l.offsetWidth>0?l:o);a.vqPlaybacks={};Object.keys(h.a).forEach(function(t){a.vqPlaybacks[t.toLowerCase()]=new h.a[t]({slot:u,store:a.store,player:a})});a.iframe.render();a.onScrollMiddleLineFn=a.onScrollMiddleLine.bind(a);a.iframe.loaded.then(function(){var t=a.iframe.getContainer();if(s.f){window.addEventListener("scroll",a.onScrollMiddleLineFn,!0);a.onScrollMiddleLine()}else{t.addEventListener("mouseenter",function(){return a.store.dispatch(Object(m.d)(!0))});t.addEventListener("mouseleave",function(){return a.store.dispatch(Object(m.d)(!1))})}});a.visibilityChangeFn=function(){var t=a.store.getState(),e=a.store.getState(),r=e.player,i=r.hasFullScreen,n=r.hasRequestFullScreen,o=r.hasActiveTab,s=document.hidden;i||n||o===!s||a.store.dispatch(Object(m.b)(s,t.options))};document.addEventListener("visibilitychange",a.visibilityChangeFn);a.vpaid=null;a._firstVisible=!1;Object(_.a)(a,[{getValues:function(t){var e=t.player;return{width:e.width,height:e.height}},onChange:function(){a.store.dispatch(Object(b.h)("Resize"))}},{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:function(){a.store.getState().player.hasFullScreen?document.removeEventListener("visibilitychange",a.visibilityChangeFn):setTimeout(function(){document.addEventListener("visibilitychange",a.visibilityChangeFn)},100)}}],a.store);return a}a(e,t);e.prototype.onScrollMiddleLine=function(){var t=this.store.getState(),e=t.player,r=e.height,i=e.hasHover,n=u.a.getModuleDimensions(this),a=n.viewportHeight,o=n.moduleTop,s=a/2,l=o<=s&&o+r>=s;l!==i&&this.store.dispatch(Object(m.d)(l))};e.prototype.updatePlayback=function(t,e){this.store.dispatch(Object(m.K)(t,e))};e.prototype.updateVqPlayback=function(t){this.store.dispatch(Object(m.N)(t))};e.prototype.updateVqControls=function(t){this.store.dispatch(Object(m.M)(t))};e.prototype.updateControl=function(t,e){this.store.dispatch(Object(m.J)(t,e))};e.prototype.showingControls=function(){this.store.dispatch(Object(m.E)())};e.prototype.getPlayerStatus=function(){return this.store.getState().player.status};e.prototype.getDuration=function(){return this.store.getState().player.duration};e.prototype.getRemainingTime=function(){var t=this.store.getState(),e=t.player;return e.duration-e.currentTime};e.prototype.getCurrentTime=function(){if(!this.vpaid){return this.store.getState().player.currentTime}return this.vpaid.getCurrentTime()};e.prototype.getWrapper=function(){return this.wrapper};e.prototype.getContainer=function(){return this.iframe.getContainer()};e.prototype.getParent=function(){return this.slot};e.prototype.getPreview=function(){var t=this.store.getState(),e=t.player;return{src:e.previewImage,width:e.previewWidth,height:e.previewHeight}};e.prototype.getPlayback=function(t){return this.store.getState().vqPlayback[t]};e.prototype.getSlotId=function(){return this.store.getState().player.id};e.prototype.getVideoSlotAspect=function(){var t=this.store.getState(),e=t.vqPlayback.aspect,r=e.type,i=e.width,n=e.height,a=t.player,o=a.videoWidth,s=a.videoHeight,l=a.previewWidth,c=a.previewHeight,u=9/16;o&&s?u=s/o:l&&c&&(u=c/l);switch(r){case"square":return 1;case"custom":return i&&n?n/i:u;case"container":return u;case"16/9":return 9/16;case"9/16":return 16/9;case"4/3":return.75;case"video":default:return u}};e.prototype.getVolume=function(){return this.store.getState().player.volume};e.prototype.play=function(){var t=this.store.getState(),e=t.player.status;this.store.dispatch(Object(m.r)(e,{force:!0}))};e.prototype.splashPlay=function(){this.store.dispatch(Object(m.D)());this.play()};e.prototype.pause=function(){var t=this.store.getState();-1!==[y.a.REPLAYED,y.a.PLAYED,y.a.STARTED].indexOf(t.player.status)&&this.store.dispatch(Object(m.q)({force:!0}))};e.prototype.splashPause=function(){this.store.dispatch(Object(m.C)());this.pause()};e.prototype.resizeAd=function(t,e){this.store.dispatch(Object(m.f)(t,e))};e.prototype.startOverlay=function(){this.store.dispatch(Object(b.g)())};e.prototype.endOverlay=function(){this.store.dispatch(Object(b.b)())};e.prototype.startVideoGallery=function(){this.store.dispatch(Object(m.a)());this.store.dispatch(Object(b.h)("Tracker:galleryStarted"))};e.prototype.endVideoGallery=function(){this.store.dispatch(Object(m.H)());this.store.dispatch(Object(b.h)("Tracker:galleryClosed"))};e.prototype.setCurrentTime=function(t){this.store.dispatch(Object(m.w)(t))};e.prototype.updateSubtitles=function(t,e){this.store.dispatch(Object(m.L)(t,e))};e.prototype.startScrollTime=function(){this.store.dispatch(Object(m.G)({force:!0}))};e.prototype.endScrollTime=function(){this.store.dispatch(Object(m.j)())};e.prototype.setCut=function(t){var e=[parseFloat(t[0]),parseFloat(t[1])];this.store.dispatch(Object(m.x)(e))};e.prototype.setFilters=function(t){this.store.dispatch(Object(m.y)(t))};e.prototype.filtersUpdated=function(t){this.store.dispatch(Object(b.h)("filtersUpdated",t))};e.prototype.startPublish=function(){this.store.dispatch(Object(b.h)("startPublish"))};e.prototype.exportFragment=function(){this.store.dispatch(Object(b.h)("exportFragment"))};e.prototype.setVolume=function(t){this.store.dispatch(Object(m.z)(t))};e.prototype.createPreview=function(){var t=this.vpaid;return t?t.createPreview():""};e.prototype.getThumbnail=function(){var t=this.vpaid,e=this.store.getState(),r=e.player,i=r.hasLoaded,n=r.previewImage;if(!t||!i||s.g||s.d)return n;try{return t.getThumbnail()||n}catch(t){return n}};e.prototype.block=function(){this.store.dispatch(Object(m.a)())};e.prototype.unblock=function(){this.store.dispatch(Object(m.H)())};e.prototype.inStatus=function(t){var e=this.store.getState(),r=e.player.status,i=void 0;i=Array.isArray(t)?t:[t];return-1!==i.indexOf(r)};e.prototype.getProfileId=function(){return this.store.getState().player.profileId};e.prototype.setLanguage=function(t){this.store.dispatch(Object(b.e)(t))};e.prototype.getSourceFiles=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mp4media",e={mp4media:"video/mp4",mpgmedia:"video/mpeg"}[t]||"video/mp4";return this.store.getState().player.mediaFiles.filter(function(t){return t.type===e})};e.prototype.updateFiles=function(t){this.store.dispatch({type:"UPDATE_FILES",payload:t})};e.prototype.destroy=function(){var t=this;this.vpaid&&this.vpaid.destroy();this.iframe.destroy();this.store.dispatch(Object(b.h)("Tracker:destroyed"));Object.keys(this.vqPlaybacks).forEach(function(e){return t.vqPlaybacks[e].destroy()});document.removeEventListener("visibilitychange",this.visibilityChangeFn);Object(l.p)(this.options.mark);Object(l.p)(this.slot);s.f&&window.removeEventListener("scroll",this.onScrollMiddleLineFn);this.unsubscribeAll()};e.prototype.forceResize=function(){this.vqPlaybacks.aspect.resize()};e.prototype.loadInit=function(t){this.previewVideo=t.previewVideo;this.store.dispatch(Object(m.n)(t))};e.prototype.getSize=function(){var t=this.store.getState(),e=t.player;return{width:e.width,height:e.height}};e.prototype.subscribeTracker=function(t){this._trackersFn.push(t)};e.prototype.triggerTracker=function(t,e){var r=this;this._trackersFn.forEach(function(i){return i(t,e,r)})};e.prototype.hasVisible=function(){return this.store.getState().player.hasVisible};e.prototype.getVisible=function(){return this.store.getState().player.visiblePercent};e.prototype.toggleUnpublishedLabel=function(t){this.store.dispatch({type:"TOGGLE_UNPUBLISHED_LABEL",payload:t})};e.prototype.hasFlying=function(){return this.store.getState().player.hasFly};e.prototype.startFly=function(){this.store.dispatch({type:"START_FLY"})};e.prototype.endFly=function(){this.store.dispatch({type:"END_FLY"})};e.prototype.setTasks=function(t){this.store.dispatch({type:"SET_TASKS",payload:t})};e.prototype.setTask=function(t){var e=this,r=this.store.getState(),i=r.task,n=i.tag,a=i.status,o=i.timeUpdate,s=o?(+new Date-o)/1e3:1/0;n===t.tag||"done"===t.status&&"error"===t.status&&t.status||"done"===a&&"error"===a&&a?this.store.dispatch({type:"SET_TASK",payload:t}):s>3?this.store.dispatch({type:"SET_TASK",payload:t}):setTimeout(function(){return e.setTask(t)},1e3*(3-s))};e.prototype.init=function(t){this.store.dispatch(Object(m.m)(t))};e.prototype.inMode=function(t){var e=this.store.getState(),r=e.player,i=r.hasFullScreen,n=r.hasFly;switch(t){case"fullScreen":return i;case"flying":return n;default:return!1}};e.prototype.initAdvert=function(t){this.store.dispatch(Object(E.c)(t))};e.prototype.startAdvert=function(){this.store.dispatch(Object(E.d)())};e.prototype.setQuality=function(t){this.store.dispatch({type:"SELECT_QUALITY",payload:t})};e.prototype.showSettingsPanel=function(){this.store.dispatch(Object(m.B)())};e.prototype.hideSettingsPanel=function(){this.store.dispatch(Object(m.l)())};e.prototype.setVisiblePercent=function(t){var e=this.store.getState(),r=e.player,i=r.hasVisible,n=r.hasRequestFullScreen;if(t&&!this._firstVisible){this._firstVisible=!0;this.store.dispatch(Object(b.h)("Tracker:firstShowing"))}i!==t&&this.store.dispatch(Object(m.g)(t||n))};e.prototype.getModuleDimensions=function(){return u.a.getModuleDimensions(this)};e.prototype.hasReady=function(){return this.store.getState().player.hasReady};e.prototype.setFiltersLib=function(t){Object(d.b)(t)};return e}(o.a)},502:function(t,e,r){"use strict";e.a={Aspect:r(503).a,VideoStart:r(504).a,VideoFinished:r(505).a,Sound:r(506).a}},503:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(5),c=r(22),u=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.slot=r.slot;Object(u.a)(a,[{getValues:function(t){var e=t.vqPlayback.aspect,r=t.player;return{aspect:e,previewHeight:r.previewHeight,previewWidth:r.previewWidth,videoHeight:r.videoHeight,videoWidth:r.videoWidth,disableAspect:t.options.disableAspect}},onChange:a.changeType.bind(a)},{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:a._resizeFullScreen.bind(a)}],a.store);var o=void 0;a.addEvent(window,"orientationchange",function(){var t=void 0,e=void 0,r=void 0,i=void 0,n=void 0,s=function(r){var i=a.store.getState(),n=i.player.hasFullScreen;clearInterval(t);clearTimeout(e);t=null;e=null;r&&(n?a._resizeFullScreen():a.resize())};o&&o(!1);o=s;t=setInterval(function(){if(window.innerWidth===r&&window.innerHeight===i){n+=1;100===n&&s(!0)}else{r=window.innerWidth;i=window.innerHeight;n=0}});e=setTimeout(function(){s(!0)},2e3)});a.changeType();return a}a(e,t);e.prototype.changeType=function(){var t=this.store.getState(),e=t.vqPlayback.aspect,r=t.player,i=r.previewWidth,n=r.previewHeight,a=r.videoWidth,o=r.videoHeight,l=r.hasFullScreen,u=r.hasFly;if(!(t.options.disableAspect||l||u)){var d=9/16;a&&o?d=o/a:i&&n&&(d=n/i);var h=this.slot,f=Object(s.m)(h)||0,p=Object(s.l)(h)||0,g=void 0,y=void 0,v=e.type;if("smart"===v){v="video";d>.75&&window.innerWidth>window.innerHeight&&(v="4/3")}switch(v){case"square":g=f;y=1*g;break;case"custom":g=parseInt(e.width,10)||0;y=parseInt(e.height,10)||0;break;case"container":g=f;y=p||f*d;break;case"16/9":g=f;y=g*(9/16);break;case"9/16":g=f;y=g*(16/9);break;case"4/3":g=f;y=.75*g;break;case"video":default:g=f;y=f*d}this.store.dispatch(Object(c.f)(g,y))}};e.prototype._resizeFullScreen=function(){if(l.f||l.e){var t=window,e=t.screen,r=e.width,i=e.height;this.store.dispatch(Object(c.f)(r,i))}else{var n=this.options.player.getContainer(),a=n.offsetWidth,o=n.offsetHeight;this.store.dispatch(Object(c.f)(a,o))}};e.prototype.resize=function(){var t=this.store.getState(),e=t.player,r=e.hasFullScreen;e.hasRequestFullScreen||(r?this._resizeFullScreen():this.changeType())};return e}(o.a)},504:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(25),l=r(12),c=r(13),u=r(22);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.iframe=r.iframe;a.play=function(){var t=a.store.getState(),e=t.player.status;-1===[s.a.STARTED,s.a.PLAYED,s.a.REPLAYED,s.a.ENDED].indexOf(e)&&a.store.dispatch(Object(u.r)(e))};a.pause=function(){var t=a.store.getState(),e=t.player.status;e&&-1!==[s.a.PLAYED,s.a.STARTED,s.a.REPLAYED].indexOf(e)&&a.store.dispatch(Object(u.q)())};Object(l.a)(a,[{getValues:function(t){return{hasLoaded:t.player.hasLoaded}},onChange:a.changeType.bind(a)},{getValues:function(t){return{hasFly:t.player.hasFly,hasStart:t.advert.hasStart}},onChange:a._updateFly.bind(a)}],a.store);return a}a(e,t);e.prototype.visible=function(){var t=this.store.getState(),e=t.advert.hasStart,r=t.player,i=r.hasVisible,n=r.hasLoaded,a=r.hasRewind,o=r.disableAutoplay,s=r.hasActiveTab,l=r.hasFly,c=t.options,u=c.forcePause,d=c.forcePlay,h=c.disableVideoStart;h||(d?this.play():u?this.pause():!n||a||h||o||!s||l||e||(i?this.play():this.pause()))};e.prototype.always=function(){var t=this.store.getState(),e=t.player,r=e.hasLoaded,i=e.status,n=e.disableAutoplay,a=e.hasActiveTab,o=t.options,s=o.forcePause,l=o.disableVideoStart;i||!r||s||l||n||!a||this.play()};e.prototype.mouseover=function(){var t=this.store.getState(),e=t.player,r=e.hasHover,i=e.status,n=e.hasRewind,a=e.disableAutoplay,o=t.options,l=o.forcePause,c=o.disableVideoStart;i!==s.a.ENDED&&(l||n||c||a||(r?this.play():i&&this.pause()))};e.prototype.click=function(){var t=this.store.getState(),e=t.player,r=e.hasLoaded,i=e.status,n=e.disableAutoplay,a=t.application.overlay;n||!i&&r&&"start"!==a&&this.store.dispatch(Object(c.f)("start"))};e.prototype.changeType=function(){var t=this.store.getState(),e=t.vqPlayback.videostart;this.unsubscribe&&this.unsubscribe();var r=void 0;switch(e.type){case"always":r=this.always.bind(this);break;case"mouseover":r=this.mouseover.bind(this);break;case"click":r=this.click.bind(this);break;default:case"smartVisible":case"visible":r=this.visible.bind(this)}r();this.unsubscribe=this.store.subscribe(r)};e.prototype._updateFly=function(){var t=this.store.getState(),e=t.player.hasFly,r=t.advert.hasStart;e?r?this.pause():this.play():r&&this.pause()};return e}(o.a)},505:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(25),l=r(13),c=r(22),u=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(u.a)(a,[{getValues:function(t){return{videofinished:t.vqPlayback.videofinished,status:t.player.status}},onChange:a.changeType.bind(a)}],a.store);a.unsubscribe=null;a.changeType();return a}a(e,t);e.prototype.loop=function(){var t=this,e=this.store.getState(),r=e.player.status,i=e.options.disableVideoFinished;r!==s.a.ENDED||i||setTimeout(function(){return t.store.dispatch(Object(c.t)())},0)};e.prototype.end=function(){var t=this.store.getState(),e=t.player.status,r=t.options.disableVideoFinished,i=t.application.overlay;e!==s.a.ENDED||r||"replay"===i||this.store.dispatch(Object(l.f)("replay"))};e.prototype.nextVideo=function(){var t=this.store.getState(),e=t.player,r=e.status,i=e.currentTime,n=e.duration,a=e.profileId,o=e.hasLoaded,l=e.playerId,u=e.id,d=t.recommendation,h=d.requestedForVideo,f=d.item;if(!h&&o&&(n<=10||n-i<=10)&&a){var p={last_video:u};l&&(p.player_id=l);this.store.dispatch(Object(c.o)(a,p))}r===s.a.ENDED&&(f?this.store.dispatch(Object(c.m)(f)):this.end())};e.prototype.changeType=function(){var t=this.store.getState(),e=t.vqPlayback.videofinished;this.unsubscribe&&this.unsubscribe();var r=void 0;switch(e.type){case"nextvideo":r=this.nextVideo.bind(this);break;case"loop":r=this.loop.bind(this);break;case"lastframe":break;case"end":default:r=this.end.bind(this)}if(r){r();this.unsubscribe=this.store.subscribe(r)}};return e}(o.a)},506:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(5),l=r(4),c=r(22),u=r(25),d=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(d.a)(a,[{getValues:function(t){return{sound:t.vqPlayback.sound,status:t.player.status}},onChange:a.change.bind(a)}],a.store);a.change();return a}a(e,t);e.prototype.change=function(){var t=this.store.getState(),e=t.vqPlayback.sound,r=t.player.status,i=t.options.disableSound;if(r===u.a.STARTED&&!i)switch(e.type){case"asvideo":if(!s.f&&!s.g&&!s.b){var n=Object(l.i)("vq-volume")||.7;this.store.dispatch(Object(c.z)(n,{force:!0}))}}};return e}(o.a)},507:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(13),c=r(22),u=r(508),d=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(d.a)(a,[{getValues:function(t){var e=t.player;return{width:e.width,height:e.height}},onChange:a.updateSize.bind(a)},{getValues:function(t){return{isSettingsPanelSeen:t.player.isSettingsPanelSeen}},onChange:a.updateSettings.bind(a)}],a.store);a.listenDocumentClick=a.listenDocumentClick.bind(a);a.updateSettings();return a}a(e,t);e.prototype.render=function(){var t=this;this.container=document.createElement("iframe");Object(s.d)(this.container,{position:"relative",zIndex:1,width:0,height:0,padding:0,margin:0,border:"none",overflow:"hidden"});document.addEventListener("click",this.listenDocumentClick);this.container.style.setProperty("max-width","none","important");this.container.style.setProperty("max-height","none","important");this.loaded=new Promise(function(e){t.container.addEventListener("load",function(){Object(s.d)(t.container.contentDocument.documentElement,{minHeight:"100%"});var r=t.container.contentDocument.body;Object(s.d)(r,{minHeight:"100%",padding:0,margin:0,overflow:"hidden",fontFamily:"Roboto, Arial, Helvetica, sans-serif",fontSize:"14px",background:"#000",cursor:"pointer",userSelect:"none",webkitTapHighlightColor:"rgba(0,0,0,0)"});var i=new u.a({store:t.store,parent:r,iframe:t.container,callbacks:t.options.callbacks,player:t.options.player});i.render();t.container.contentWindow.document.addEventListener("keydown",function(e){return t.store.dispatch(Object(l.h)("keydown",e))});Object(s.f)(t.container,"mousemove");Object(s.f)(t.container,"mouseup");e(i)})});this.container.src="about:blank";this.parent.appendChild(this.container);this.updateSize()};e.prototype.listenDocumentClick=function(){this.isSettingsPanelSeen&&this.store.dispatch(Object(c.l)())};e.prototype.updateSettings=function(){this.isSettingsPanelSeen=this.store.getState().player.isSettingsPanelSeen};e.prototype.updateSize=function(){var t=this.store.getState(),e=t.player,r=e.width,i=e.height;if(this.container.offsetWidth!==Math.ceil(r)||this.container.offsetHeight!==Math.ceil(i)){this.container.style.setProperty("width",r+"px","important");this.container.style.setProperty("height",i+"px","important")}};e.prototype.destroy=function(){t.prototype.destroy.call(this);this.loaded.then(function(t){return t.destroy()});document.removeEventListener("click",this.listenDocumentClick)};return e}(o.a)},508:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(5),l=r(2),c=r(4),u=r(25),d=r(7),h=r(13),f=r(509),p=r(510),g=r(525),y=r(529),v=r(531),m=r(535),b=r(539),E=r(542),_=r(543),S=r(544),T=r(548),w=r(549),O=r(550),A=r(553),C=r(556),R=r(561),L=r(564),k=r(565),D=r(566),x=r(569),P=r(570),I=r(571),j=r(575),F=r(576),M=r(577),N=r(22),U=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.iframe=r.iframe;return a}a(e,t);e.prototype.onVideoClick=function(){this.store.dispatch(Object(h.h)("Tracker:userAction",{trackingParams:{name:"Video"}}));var t=this.store.getState(),e=t.vqPlayback,r=t.player.isSettingsPanelSeen,i=t.options.hasOverlayMode,n=this.options.player;if(r)this.store.dispatch(Object(N.l)());else if(["pause","viqeo"].includes(e.videoclick.type)){var a=n.getPlayerStatus();a||n.splashPlay();switch(a){case u.a.PAUSED:n.splashPlay();break;case u.a.STARTED:case u.a.PLAYED:case u.a.REPLAYED:n.splashPause()}}else i||this.store.dispatch(Object(h.h)("Modal:Gallery"));/[?&]viqeo_debug\b(?:=(\d+))?/.exec(window.location.search)&&Object(c.A)(d.a,this.store)};e.prototype.render=function(){var t=this;this.container=document.createElement("div");this.container.className+="l-wrapper";var e={store:this.store,parent:this.container,iframe:this.iframe,callbacks:this.options.callbacks,player:this.options.player};this.controls=[new f.a(U({hideInEmbed:!0},e)),new g.a(e),new y.a(U({hideInEmbed:!0},e)),new v.a(U({hideInEmbed:!0},e)),s.f?new P.a(U({hideInEmbed:!0},e)):new x.a(U({hideInEmbed:!0},e)),new m.a(e),new b.a(U({hideInEmbed:!0},e)),new E.a(e),new _.a(e),new S.a(e),new I.a(U({hideInEmbed:!0},e)),new T.a(e),new A.a(U({hideInEmbed:!0},e)),new k.a(U({hideInEmbed:!0},e)),new D.a(U({hideInEmbed:!0},e)),new O.a(U({hideInEmbed:!0},e)),s.f?new R.a(U({hideInEmbed:!0},e)):new C.a(U({hideInEmbed:!0},e)),new L.a(e),new j.a(e),new F.a(U({hideInEmbed:!0},e)),new M.a(U({hideInEmbed:!0},e)),new p.a(e)];s.f||this.controls.push(new w.a(e));this.controls.forEach(function(t){return t.render()});this.addClickEvent(this.container,function(){t.store.getState().player.hasRewind||t.onVideoClick()});this.container.addEventListener("contextmenu",function(e){t.store.dispatch({type:"OPEN_CONTEXT_MENU",payload:{x:e.pageX,y:e.pageY}});Object(l.e)(e)});this.parent.appendChild(this.container)};e.prototype.destroy=function(){this.controls.forEach(function(t){return t.destroy()});t.prototype.destroy.call(this)};return e}(o.a)},509:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(4),l=r(2),c=r(10),u=r(25),d=r(22),h=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(h.a)(a,[{getValues:function(t){var e=t.player;return{width:e.width,height:e.height}},onChange:a.updateSize.bind(a)}],a.store);return a}a(e,t);e.prototype.render=function(){var t=this,e=this.store.getState(),r=e.player.previewImage;this.container=document.createElement("div");Object(l.d)(this.container,{zIndex:c.a.preview,position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#000",opacity:1,transition:"opacity 1s"});this.img=new Image;this.img.addEventListener("load",function(e){var r=e.target,i=r.width,n=r.height;t.store.dispatch(Object(d.s)(i,n));Object(l.d)(t.img,{top:"50%",left:"50%",webkitTransform:"translate(-50%, -50%)",transform:"translate(-50%, -50%)",position:"absolute",display:"none"});t.container.appendChild(t.img);t.updateSize()});r?this.img.src=r:this.fadeOut();this.parent.appendChild(this.container);this.update()};e.prototype.fadeOut=function(){Object(l.d)(this.container,{opacity:0});setTimeout(this.hide.bind(this),1e3)};e.prototype.updateSize=function(){if(this.img.complete){var t=this.store.getState(),e=t.player,r=e.width,i=e.height,n=t.vqPlayback.aspect.framing,a=Object(s.c)(this.img.width,this.img.height,r,i,n);Object(l.d)(this.img,{width:a.width+"px",height:a.height+"px",display:"block"})}};e.prototype.changeStatus=function(){var t=this.store.getState(),e=t.player,r=e.status,i=e.currentTime,n=e.hasLoaded;if(r)switch(r){case u.a.STARTED:case u.a.REPLAYED:case u.a.ENDED:case u.a.PAUSED:case u.a.PLAYED:0!=+this.container.style.opacity&&0!==i&&n&&this.fadeOut()}else this.show()};e.prototype.update=function(){this.changeStatus();t.prototype.update.call(this)};return e}(o.a)},51:function(t,e,r){"use strict";r.d(e,"a",function(){return i});var i=(r(7),function(t){var e=t.status,r=t.message;return"error"===e&&(Array.isArray(r)?r.join("\n"):r)})},510:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(5),s=r(8),l=r(511),c=r(4),u=r(2),d=r(42),h=r(22),f=r(66),p=r(25),g=r(13),y=r(10),v=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a._spinnerTime=0;a.vpaid=null;a.currentTime=0;a._hasOnline=!0;a._needReload=!1;a._startPromise=null;a.addEvent(window,"online",a._onOnline.bind(a));a.addEvent(window,"offline",a._onOffline.bind(a));return a}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");Object(u.d)(this.container,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:y.a.videoContainer,overflow:"hidden"});Object(v.a)(this,[{getValues:function(t){return{status:t.player.status}},onChange:this.updateStatus.bind(this)},{getValues:function(t){var e=t.player;return{mediaFiles:e.mediaFiles,hasInitial:e.hasInitial}},onChange:this.createVideo.bind(this)},{getValues:function(t){var e=t.player;return{width:e.width,height:e.height,aspect:t.vqPlayback.aspect}},onChange:this.resizeVpaid.bind(this)},{getValues:function(t){return{volume:t.player.volume}},onChange:this.changeVolume.bind(this)},{getValues:function(t){var e=t.player;return{seekTime:e.seekTime,lastSeekTimeModify:e.lastSeekTimeModify}},onChange:this.seek.bind(this)},{getValues:function(t){return{filters:t.player.filters}},onChange:this.changeFilters.bind(this)},{getValues:function(t){var e=t.player;return{hasVisible:e.hasVisible,hasAfterScreen:e.hasAfterScreen}},onChange:this.updateVisible.bind(this)},{getValues:function(t){return{selectedQuality:t.player.selectedQuality}},onChange:this.selectQuality.bind(this)},{getValues:function(t){return{isSettingsPanelSeen:t.player.isSettingsPanelSeen}},onChange:this.settingsPanelVisibilityChanged.bind(this)},{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:this.onFullScreen.bind(this)},{getValues:function(t){return{hasRequestFullScreen:t.player.hasRequestFullScreen}},onChange:this.onRequestFullScreen.bind(this)}],this.store);this.parent.appendChild(this.container);this.createVideo();this._interval=setInterval(this.checkBuffered.bind(this),3e3)};e.prototype.resizeVpaid=function(){var t=this.store.getState(),e=t.player,r=e.width,i=e.height,n=e.videoWidth,a=e.videoHeight,o=t.vqPlayback.aspect.framing;if(this.vpaid){var s=Object(c.c)(n,a,r,i,o);Object(u.d)(this.vpaid.getContainer(),{position:"absolute",width:Math.round(s.width)+4+"px",height:Math.round(s.height)+4+"px",top:"50%",left:"50%",webkitTransform:"translate(-50%, -50%)",transform:"translate(-50%, -50%)"})}};e.prototype.updateStatus=function(){var t=this,e=this.store.getState(),r=e.player,i=r.status,n=r.hasLoaded;this.store.dispatch(Object(g.d)("VideoContainer. updateStatus(): "+i));if(this.vpaid&&!this._startPromise&&n)switch(i){case"started":case"played":this._startPromise=this.vpaid.start();this._startPromise.then(function(){t.store.dispatch(Object(g.d)("VideoContainer. Success autoplay. Request status: "+i));t._startPromise=null;t.store.getState().player.status!==i&&t.updateStatus();t.store.dispatch({type:"CHANGE_VIDEO_STATUS",payload:"played"})});this._startPromise.catch(function(e){try{t.store.dispatch(Object(g.d)("VideoContainer. Request status: "+i+". Disable autoplay: "+(e?e.message:e)))}catch(e){t.store.dispatch(Object(g.d)("VideoContainer. Request status: "+i+". Disable autoplay"))}t.store.dispatch(Object(h.h)());t._startPromise=null});break;case"paused":this.vpaid.pause();this.store.dispatch({type:"CHANGE_VIDEO_STATUS",payload:"paused"});break;case"replayed":this.vpaid.replay();this.store.dispatch({type:"CHANGE_VIDEO_STATUS",payload:"replayed"})}};e.prototype.createVideo=function(){var t=this,e=this.store.getState(),r=e.player,i=r.mediaFiles,n=r.width,a=r.height,o=r.hasInitial,s=e.options,c=e.vqPlayback;if(o){var d=void 0;l.a.some(function(t){d=t.create(i,s);return d});if(d){if(this.vpaid)try{this._endSeek();this.vpaid.destroy();this._startPromise=null}catch(t){this.store.dispatch(Object(g.d)("VideoContainer. Destroy error: "+t))}this.vpaid=d;d.subscribe(function(e){t.options.callbacks.onCreateVpaid(d);t.store.dispatch(Object(h.O)(e));t.store.dispatch(Object(g.h)("AdLoaded",e));t.changeVolume();t.resizeVpaid();t.updateStatus();t.seek();t.changeFilters();t.updateVisible()},f.a.META_DATA_LOADED);d.subscribe(function(){t.store.dispatch(Object(h.k)());t.store.dispatch(Object(g.h)("VideoEnded"))},f.a.VIDEO_ENDED);d.subscribe(this._startSeek.bind(this),f.a.START_SEEK);d.subscribe(this._endSeek.bind(this),f.a.END_SEEK);d.subscribe(function(){return t.updateStatus()},f.a.EXIT_FULL_SCREEN);d.subscribe(function(e){return t.store.dispatch(Object(h.c)(e))},f.a.BUFFER_PROGRESS);d.subscribe(function(e){return t.store.dispatch({type:"DURATION_UPDATE",payload:e})},f.a.DURATION_UPDATE);d.subscribe(function(e){var r=t.store.getState(),i=r.player.ranges;i&&(e<i[0]||e>i[1])&&t.vpaid.seek(i[0]);t.store.dispatch(Object(h.e)(e));t._onTimeUpdate()},f.a.TIME_UPDATE);d.subscribe(function(){return t.resizeVpaid()},f.a.RESIZED);d.subscribe(function(e){if(t._hasOnline)t.store.dispatch({type:"FAILED_LOAD_VIDEO",payload:e});else{t.store.dispatch({type:"DROPPED_NETWORK"});t._needReload=!0}},f.a.ERROR_VIDEO_LOAD);d.subscribe(function(e){Object(u.h)("viqeo-quality")||"quality"!==c.viewStrategy.type||t.store.dispatch({type:"SELECT_QUALITY",payload:e});t.store.dispatch({type:"QUALITY_UPDATED",payload:e})},f.a.QUALITY_UPDATED);var p=this.store.getState(),y=p.options,v=y.disableVideoCors,m=y.preload,b=null,E=Object(u.h)("viqeo-quality");E&&"auto"!==E&&(b=E);d.init({parent:this.container,disableCors:v,global:this.options.iframe.contentWindow,preload:m,slotWidth:n,slotHeight:a,viewStrategy:c.viewStrategy.type,defaultQuality:b,store:this.store})}}};e.prototype.changeVolume=function(){var t=this.store.getState(),e=t.player.volume;this.vpaid&&this.vpaid.setVolume(e)};e.prototype.seek=function(){var t=this.store.getState(),e=t.player.seekTime;this.vpaid&&e&&this.vpaid.seek(e)};e.prototype.changeFilters=function(){var t=this.store.getState(),e=t.player.filters;this.vpaid&&this.vpaid.setFilters(e)};e.prototype.checkBuffered=function(){var t=this.store.getState(),e=t.player,r=e.status,i=e.hasBuffered;if(this.vpaid){var n=this.vpaid.getCurrentTime();if(-1!==[p.a.STARTED,p.a.PLAYED,p.a.REPLAYED].indexOf(r)&&this.currentTime===n)i||this.store.dispatch(Object(h.F)());else if(i){this.store.dispatch(Object(h.i)());this._spinnerTime=0}this.currentTime=n}else if(i){this.store.dispatch(Object(h.i)());this._spinnerTime=0}};e.prototype._onTimeUpdate=function(){this.store.getState().player.hasBuffered&&this.vpaid&&this.vpaid.getCurrentTime()!==this.currentTime&&this.store.dispatch(Object(h.i)())};e.prototype.selectQuality=function(){var t=this.store.getState(),e=t.player,r=e.selectedQuality;e.qualities.filter(function(t){return t.height===r}).length&&this.vpaid.setQuality(r||null)};e.prototype.settingsPanelVisibilityChanged=function(){if(o.f){var t=this.store.getState(),e=t.player,r=e.isSettingsPanelSeen,i=e.status;if(r){this.savedPlayerStatus=i;this.store.dispatch(Object(h.q)({force:!0}))}else{[p.a.STARTED,p.a.PLAYED,p.a.REPLAYED].includes(this.savedPlayerStatus)&&this.store.dispatch(Object(h.r)(i));this.savedPlayerStatus=null}}};e.prototype.destroy=function(){this._startPromise=null;clearInterval(this._interval);clearTimeout(this._seekTimer)};e.prototype.updateVisible=function(){var t=this.store.getState(),e=t.player,r=e.hasVisible,i=e.hasAfterScreen;this.vpaid&&this.vpaid.setMaxBuffer(r?20:i?3:5)};e.prototype.onRequestFullScreen=function(){var t=this.options.iframe,e=this.store.getState(),r=e.player,i=r.hasRequestFullScreen,n=r.hasFullScreen;this.vpaid&&(i?this.vpaid.requestFullScreen(t):n&&this.vpaid.closeFullScreen())};e.prototype.onFullScreen=function(){var t=this.store.getState(),e=t.player,r=e.hasFullScreen,i=e.qualities,n=e.selectedQuality,a=t.vqPlayback.viewStrategy.type,o=window,s=o.screen,l=s.width,c=s.height;if(("speed"!==a||n)&&r){this.store.dispatch({type:"SELECT_QUALITY",payload:Object(d.a)(i,l,c).height})}};e.prototype._startSeek=function(){var t=this;this._seekTimer&&clearTimeout(this._seekTimer);this._seekTimer=setTimeout(function(){t.store.dispatch({type:"START_SEEK_BUFFERED"})},2e3)};e.prototype._endSeek=function(){this.store.dispatch({type:"END_SEEK_BUFFERED"});clearTimeout(this._seekTimer);this._seekTimer=null};e.prototype._onOnline=function(){this._hasOnline=!0;if(this._needReload){this._needReload=!1;this.createVideo()}};e.prototype._onOffline=function(){this._hasOnline=!1};return e}(s.a)},511:function(t,e,r){"use strict";e.a=[r(512).a,r(513).a,r(329).a,r(515).a]},512:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(){this.trigger(g.a.META_DATA_LOADED,{duration:this.getDuration(),width:16,height:9,qualities:[],frames:1,fps:1,hasExternalEmbed:!0});this._store.dispatch(Object(f.d)(v+".onCanPlay()"))}function s(t){var e=t.data;this._store.dispatch(Object(f.d)(v+".onError(): "+e))}function l(){var t=this;this._timer||setInterval(function(){t.trigger(g.a.DURATION_UPDATE,t.getDuration());t.trigger(g.a.TIME_UPDATE,t.getCurrentTime())},500)}function c(){this._timer=null;clearInterval(this._timer)}function u(t){switch(t.data){case 1:l.call(this);break;case 2:c.call(this)}}function d(t){var e=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,r=t.match(e);return!(!r||11!==r[7].length)&&r[7]}var h=r(146),f=r(13),p=r(4),g=r(66),y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},v="YoutubeContainer";e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a._player=null;a._timer=null;a._wrapper=null;return a}a(e,t);e.prototype.init=function(e){var r=this;t.prototype.init.call(this,e);var i=this._options,n=i.url,a=i.parent,l=i.global;this._store.dispatch(Object(f.d)(v+".init()"));var c=l.document.createElement("script");c.src="https://www.youtube.com/iframe_api";l.document.head.appendChild(c);var h=d(n);this._store.dispatch(Object(f.d)(v+".init() parser url: "+n+" to "+h+". origin: "+Object(p.l)()));l.onYouTubeIframeAPIReady=function(){r._player=new l.YT.Player("player",{height:"100%",width:"100%",videoId:h,playerVars:{origin:Object(p.l)(),playsinline:1},events:{onReady:o.bind(r),onStateChange:u.bind(r),onError:s.bind(r)}})};this._wrapper=document.createElement("div");this._wrapper.id="player";a.appendChild(this._wrapper)};e.prototype.getContainer=function(){return this._wrapper};e.prototype.getDuration=function(){return this._player?this._player.getDuration():0};e.prototype.getCurrentTime=function(){return this._player?this._player.getCurrentTime():0};e.prototype.seek=function(t){this._player&&this._player.seekTo(t)};e.prototype.pause=function(){this._player&&this._player.pauseVideo()};e.prototype.play=function(){this._player&&this._player.playVideo()};e.prototype.setVolume=function(t){this._player&&this._player.setVolume(parseInt(100*t,10))};e.prototype.destroy=function(){this._player&&this._player.destroy();c.call(this)};e.create=function(t,r){var i=r.disableEmbed,n=t.find(function(t){return-1!==(t.url||"").search(/youtube/)});return n&&!i?new e(y({},n)):null};return e}(h.a)},513:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(){this._store.dispatch(Object(y.d)(E+".onLoaded()"));var t=this._options,e=t.slotWidth,r=t.slotHeight,i=t.defaultQuality,n=t.viewStrategy,a=t.mp4item,o=a.width,s=a.height,l=a.fps,c=a.frames,u=this._player.levels,d=u.map(function(t){return{width:t.width,height:t.height}}),h=void 0;if(i){var f=parseInt(i,10);h=u.find(function(t){return f===t.height})}if(h)this._player.currentLevel=u.findIndex(function(t){return i===t.height});else if("quality"===n){h=Object(p.a)(u,e,r);this._player.currentLevel=u.findIndex(function(t){return h.height===t.height})}else h=this._player.currentLevel;this._file=h;this.trigger(v.a.META_DATA_LOADED,{duration:c/l,width:o,height:s,qualities:d,frames:c,fps:l})}function s(){this.trigger(v.a.TIME_UPDATE,this.getCurrentTime())}function l(t){t.length>0&&this.trigger(v.a.BUFFER_PROGRESS,t.end(t.length-1))}function c(){this.trigger(v.a.VIDEO_ENDED)}function u(){this._store.dispatch(Object(y.d)(E+".onSeeked()"));if(this._seekingQueue.length){this._store.dispatch(Object(y.d)(E+".onSeeked() seekingQueue: "+this._seekingQueue));var t=this._seekingQueue.pop();this._seekingQueue=[];this.seek(t)}else{this._store.dispatch(Object(y.d)(E+".onSeeked() endSeek"));this.trigger(v.a.END_SEEK)}}var d=r(514),h=r.n(d),f=r(5),p=r(42),g=r(2),y=r(13),v=r(66),m=r(328),b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},E="HLSContainer";e.a=function(t){function e(r){i(this,e);var a=n(this,t.call.apply(t,[this].concat(r)));a._seekingQueue=[];return a}a(e,t);e.prototype.init=function(e){var r=this;t.prototype.init.call(this,e);this._store.dispatch(Object(y.d)(E+".init()"));var i=this._options,n=i.url;i.parent.appendChild(this._video);this._player=new h.a({maxMaxBufferLength:5,startLevel:0});this._player.on(h.a.Events.MANIFEST_LOADING,function(t){r._store.dispatch(Object(y.d)(E+":HLS.Events."+t))});this._player.on(h.a.Events.MANIFEST_LOADED,function(t,e){var i=e.stats,n=e.url;r._store.dispatch(Object(y.d)(E+":HLS.Events."+t+". url: "+n+". stats: "+JSON.stringify(i)))});this._player.on(h.a.Events.LEVEL_LOADING,function(t,e){var i=e.url;r._store.dispatch(Object(y.d)(E+":HLS.Events."+t+". url: "+i))});this._player.on(h.a.Events.LEVEL_LOADED,function(t,e){var i=e.url,n=e.stats;r._store.dispatch(Object(y.d)(E+":HLS.Events."+t+". url: "+i+". stats: "+JSON.stringify(n)))});[h.a.Events.FRAG_LOADING,h.a.Events.AUDIO_TRACK_LOADING].forEach(function(t){r._player.on(t,function(t,e){var i=e.frag.relurl;r._store.dispatch(Object(y.d)(E+":HLS.Events."+t+". url: "+i))})});[h.a.Events.FRAG_LOADED,h.a.Events.AUDIO_TRACK_LOADED].forEach(function(t){r._player.on(t,function(t,e){var i=e.frag.relurl,n=e.stats;r._store.dispatch(Object(y.d)(E+":HLS.Events."+t+". url: "+i+". stats: "+JSON.stringify(n)))})});this._player.on(h.a.Events.MANIFEST_PARSED,o.bind(this));this._player.on(h.a.Events.LEVEL_SWITCHED,function(t,e){var i=e.level;r._store.dispatch(Object(y.d)(E+":HLS.Events.LEVEL_SWITCHED. level: "+i));r._file=r._player.levels[i];r.trigger(v.a.QUALITY_UPDATED,r._player.levels[i].height)});this._player.on(h.a.Events.BUFFER_APPENDED,function(t,e){l.call(r,e.timeRanges.video)});this._player.on(h.a.Events.ERROR,function(t,e){try{r._store.dispatch(Object(y.d)(E+":HLS.Events.ERROR("+t+", "+JSON.stringify(e)+")"))}catch(i){r._store.dispatch(Object(y.d)(E+":HLS.Events.ERROR("+t+", type: "+e.type+")"))}if(e.fatal)switch(e.type){case h.a.ErrorTypes.NETWORK_ERROR:r._player.startLoad();break;case h.a.ErrorTypes.MEDIA_ERROR:r._player.recoverMediaError();break;default:r.trigger(v.a.ERROR_VIDEO_LOAD,{url:r._options.url})}});this._player.loadSource(n);this._player.attachMedia(this._video);this._video.addEventListener("canplay",function(){return r._store.dispatch(Object(y.d)(E+" canplay triggered"))});this._video.addEventListener("loadedmetadata",function(){return r._store.dispatch(Object(y.d)(E+" loadedmetadata triggered"))});this._video.addEventListener("play",s.bind(this));this._video.addEventListener("timeupdate",s.bind(this));this._video.addEventListener("progress",l.bind(this));this._video.addEventListener("ended",c.bind(this));this._video.addEventListener("seeked",u.bind(this))};e.prototype.setVolume=function(t){this._store.dispatch(Object(y.d)(E+".setVolume("+t+")"));this._video.volume=t;this._video.muted=0===t};e.prototype.play=function(){Object(g.o)(this._video)};e.prototype.pause=function(){this._store.dispatch(Object(y.d)(E+".pause()"));this._video.paused||this._video.pause()};e.prototype.getDuration=function(){return this._video.duration};e.prototype.getCurrentTime=function(){return this._video.currentTime};e.prototype.seek=function(t){this._store.dispatch(Object(y.d)(E+".seek("+t+")"));if(t!==this.getCurrentTime()){if(Math.abs(this.getCurrentTime()-Math.floor(t))<.05){this.trigger(v.a.END_SEEK);this._store.dispatch(Object(y.d)(E+".seek("+t+") currentTime: "+this.getCurrentTime()))}else if(this._video.seeking){this._store.dispatch(Object(y.d)(E+".seek("+t+") push seekQueue"));this._seekingQueue.push(t)}else{this._store.dispatch(Object(y.d)(E+".seek("+t+") hasSeeking false"));this.trigger(v.a.START_SEEK);this._video.currentTime=t}}else this._store.dispatch(Object(y.d)(E+".seek("+t+"). currentTime: "+this.getCurrentTime()))};e.prototype.destroy=function(){this._player.destroy();Object(g.p)(this._video)};e.prototype.setQuality=function(t){this._player.currentLevel=this._player.levels.findIndex(function(e){return e.height===t})};e.prototype.setMaxBuffer=function(t){this._player.config.maxMaxBufferLength=t};e.create=function(t){var r=Object(p.b)(t,"application/x-mpegURL"),i=Object(p.b)(t,"video/mp4");return r.length&&f.a&&h.a.isSupported()&&!f.g?new e(b({},r[0],{mp4item:i[0]})):null};return e}(m.a)},514:function(t,e,r){"undefined"!=typeof window&&function(e,r){t.exports=r()}(0,function(){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};t[i].call(n.exports,n,n.exports,e);n.l=!0;return n.exports}var r={};e.m=t;e.c=r;e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:i})};e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});Object.defineProperty(t,"__esModule",{value:!0})};e.t=function(t,r){1&r&&(t=e(t));if(8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);e.r(i);Object.defineProperty(i,"default",{enumerable:!0,value:t});if(2&r&&"string"!=typeof t)for(var n in t)e.d(i,n,function(e){return t[e]}.bind(null,n));return i};e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};e.d(r,"a",r);return r};e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};e.p="/dist/";return e(e.s="./src/hls.js")}({"./node_modules/eventemitter3/index.js":function(t,e,r){"use strict";function i(){}function n(t,e,r){this.fn=t;this.context=e;this.once=r||!1}function a(t,e,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new n(r,i||t,a),s=c?c+e:e;t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],o]:t._events[s].push(o):(t._events[s]=o,t._eventsCount++);return t}function o(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i;this._eventsCount=0}var l=Object.prototype.hasOwnProperty,c="~";if(Object.create){i.prototype=Object.create(null);(new i).__proto__||(c=!1)}s.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)l.call(t,e)&&r.push(c?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r};s.prototype.listeners=function(t){var e=c?c+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,a=new Array(n);i<n;i++)a[i]=r[i].fn;return a};s.prototype.listenerCount=function(t){var e=c?c+t:t,r=this._events[e];return r?r.fn?1:r.length:0};s.prototype.emit=function(t,e,r,i,n,a){var o=c?c+t:t;if(!this._events[o])return!1;var s,l,u=this._events[o],d=arguments.length;if(u.fn){u.once&&this.removeListener(t,u.fn,void 0,!0);switch(d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,i),!0;case 5:return u.fn.call(u.context,e,r,i,n),!0;case 6:return u.fn.call(u.context,e,r,i,n,a),!0}for(l=1,s=new Array(d-1);l<d;l++)s[l-1]=arguments[l];u.fn.apply(u.context,s)}else{var h,f=u.length;for(l=0;l<f;l++){u[l].once&&this.removeListener(t,u[l].fn,void 0,!0);switch(d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,r);break;case 4:u[l].fn.call(u[l].context,e,r,i);break;default:if(!s)for(h=1,s=new Array(d-1);h<d;h++)s[h-1]=arguments[h];u[l].fn.apply(u[l].context,s)}}}return!0};s.prototype.on=function(t,e,r){return a(this,t,e,r,!1)};s.prototype.once=function(t,e,r){return a(this,t,e,r,!0)};s.prototype.removeListener=function(t,e,r,i){var n=c?c+t:t;if(!this._events[n])return this;if(!e){o(this,n);return this}var a=this._events[n];if(a.fn)a.fn!==e||i&&!a.once||r&&a.context!==r||o(this,n);else{for(var s=0,l=[],u=a.length;s<u;s++)(a[s].fn!==e||i&&!a[s].once||r&&a[s].context!==r)&&l.push(a[s]);l.length?this._events[n]=1===l.length?l[0]:l:o(this,n)}return this};s.prototype.removeAllListeners=function(t){var e;if(t){e=c?c+t:t;this._events[e]&&o(this,e)}else{this._events=new i;this._eventsCount=0}return this};s.prototype.off=s.prototype.removeListener;s.prototype.addListener=s.prototype.on;s.prefixed=c;s.EventEmitter=s;t.exports=s},"./node_modules/node-libs-browser/node_modules/events/events.js":function(t,e){function r(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function n(t){return"number"==typeof t}function a(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=r;r.EventEmitter=r;r.prototype._events=void 0;r.prototype._maxListeners=void 0;r.defaultMaxListeners=10;r.prototype.setMaxListeners=function(t){if(!n(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");this._maxListeners=t;return this};r.prototype.emit=function(t){var e,r,n,s,l,c;this._events||(this._events={});if("error"===t&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){e=arguments[1];if(e instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");u.context=e;throw u}r=this._events[t];if(o(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1);r.apply(this,s)}else if(a(r)){s=Array.prototype.slice.call(arguments,1);c=r.slice();n=c.length;for(l=0;l<n;l++)c[l].apply(this,s)}return!0};r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");this._events||(this._events={});this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e);this._events[t]?a(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e;if(a(this._events[t])&&!this._events[t].warned){n=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners;if(n&&n>0&&this._events[t].length>n){this._events[t].warned=!0;console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length);"function"==typeof console.trace&&console.trace()}}return this};r.prototype.on=r.prototype.addListener;r.prototype.once=function(t,e){function r(){this.removeListener(t,r);if(!n){n=!0;e.apply(this,arguments)}}if(!i(e))throw TypeError("listener must be a function");var n=!1;r.listener=e;this.on(t,r);return this};r.prototype.removeListener=function(t,e){var r,n,o,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;r=this._events[t];o=r.length;n=-1;if(r===e||i(r.listener)&&r.listener===e){delete this._events[t];this._events.removeListener&&this.emit("removeListener",t,e)}else if(a(r)){for(s=o;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){n=s;break}if(n<0)return this;if(1===r.length){r.length=0;delete this._events[t]}else r.splice(n,1);this._events.removeListener&&this.emit("removeListener",t,e)}return this};r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener){0===arguments.length?this._events={}:this._events[t]&&delete this._events[t];return this}if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);this.removeAllListeners("removeListener");this._events={};return this}r=this._events[t];if(i(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);delete this._events[t];return this};r.prototype.listeners=function(t){var e;e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[];return e};r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0};r.listenerCount=function(t,e){return t.listenerCount(e)}},"./node_modules/url-toolkit/src/url-toolkit.js":function(t,e,r){!function(e){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(t,e,r){r=r||{};t=t.trim();e=e.trim();if(!e){if(!r.alwaysNormalize)return t;var n=o.parseURL(t);if(!n)throw new Error("Error trying to parse base URL.");n.path=o.normalizePath(n.path);return o.buildURLFromParts(n)}var a=o.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme){if(!r.alwaysNormalize)return e;a.path=o.normalizePath(a.path);return o.buildURLFromParts(a)}var s=o.parseURL(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=i.exec(s.path);s.netLoc=l[1];s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var c={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc){c.netLoc=s.netLoc;if("/"!==a.path[0])if(a.path){var u=s.path,d=u.substring(0,u.lastIndexOf("/")+1)+a.path;c.path=o.normalizePath(d)}else{c.path=s.path;if(!a.params){c.params=s.params;a.query||(c.query=s.query)}}}null===c.path&&(c.path=r.alwaysNormalize?o.normalizePath(a.path):a.path);return o.buildURLFromParts(c)},parseURL:function(t){var e=r.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){t=t.split("").reverse().join("").replace(n,"");for(;t.length!==(t=t.replace(a,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}};t.exports=o}()},"./node_modules/webworkify-webpack/index.js":function(t,e,r){function i(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};t[i].call(n.exports,n,n.exports,e);n.l=!0;return n.exports}var r={};e.m=t;e.c=r;e.i=function(t){return t};e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})};e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})};e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};e.d(r,"a",r);return r};e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};e.p="/";e.oe=function(t){console.error(t);throw t};var i=e(e.s=ENTRY_MODULE);return i.default||i}function n(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(t){return!isNaN(1*t)}function o(t,e,i){var o={};o[i]=[];var s=e.toString(),l=s.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return o;for(var d,h=l[1],f=new RegExp("(\\\\n|\\W)"+n(h)+u,"g");d=f.exec(s);)"dll-reference"!==d[3]&&o[i].push(d[3]);f=new RegExp("\\("+n(h)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+u,"g");for(;d=f.exec(s);){if(!t[d[2]]){o[i].push(d[1]);t[d[2]]=r(d[1]).m}o[d[2]]=o[d[2]]||[];o[d[2]].push(d[4])}for(var p=Object.keys(o),g=0;g<p.length;g++)for(var y=0;y<o[p[g]].length;y++)a(o[p[g]][y])&&(o[p[g]][y]=1*o[p[g]][y]);return o}function s(t){return Object.keys(t).reduce(function(e,r){return e||t[r].length>0},!1)}function l(t,e){for(var r={main:[e]},i={main:[]},n={main:{}};s(r);)for(var a=Object.keys(r),l=0;l<a.length;l++){var c=a[l],u=r[c],d=u.pop();n[c]=n[c]||{};if(!n[c][d]&&t[c][d]){n[c][d]=!0;i[c]=i[c]||[];i[c].push(d);for(var h=o(t,t[c][d],c),f=Object.keys(h),p=0;p<f.length;p++){r[f[p]]=r[f[p]]||[];r[f[p]]=r[f[p]].concat(h[f[p]])}}}return i}var c="[\\.|\\-|\\+|\\w|/|@]+",u="\\((/\\*.*?\\*/)?s?.*?("+c+").*?\\)";t.exports=function(t,e){e=e||{};var n={main:r.m},a=e.all?{main:Object.keys(n.main)}:l(n,t),o="";Object.keys(a).filter(function(t){return"main"!==t}).forEach(function(t){for(var e=0;a[t][e];)e++;a[t].push(e);n[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";o=o+"var "+t+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[t].map(function(e){return JSON.stringify(e)+": "+n[t][e].toString()}).join(",")+"});\n"});o=o+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a.main.map(function(t){return JSON.stringify(t)+": "+n.main[t].toString()}).join(",")+"}))(self);";var s=new window.Blob([o],{type:"text/javascript"});if(e.bare)return s;var c=window.URL||window.webkitURL||window.mozURL||window.msURL,u=c.createObjectURL(s),d=new window.Worker(u);d.objectURL=u;return d}},"./src/config.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/controller/abr-controller.js"),n=r("./src/controller/buffer-controller.js"),a=r("./src/controller/cap-level-controller.js"),o=r("./src/controller/fps-controller.js"),s=r("./src/utils/xhr-loader.js"),l=r("./src/controller/audio-track-controller.js"),c=r("./src/controller/audio-stream-controller.js"),u=r("./src/utils/cues.js"),d=r("./src/controller/timeline-controller.js"),h=r("./src/controller/subtitle-track-controller.js"),f=r("./src/controller/subtitle-stream-controller.js"),p=r("./src/controller/eme-controller.js");e.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:s.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:i.default,bufferController:n.default,capLevelController:a.default,fpsController:o.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:r("./src/utils/mediakeys-helper.js").requestMediaKeySystemAccess};e.hlsDefaultConfig.subtitleStreamController=f.SubtitleStreamController;e.hlsDefaultConfig.subtitleTrackController=h.default;e.hlsDefaultConfig.timelineController=d.default;e.hlsDefaultConfig.cueHandler=u;e.hlsDefaultConfig.enableCEA708Captions=!0;e.hlsDefaultConfig.enableWebVTT=!0;e.hlsDefaultConfig.captionsTextTrack1Label="English";e.hlsDefaultConfig.captionsTextTrack1LanguageCode="en";e.hlsDefaultConfig.captionsTextTrack2Label="Spanish";e.hlsDefaultConfig.captionsTextTrack2LanguageCode="es";e.hlsDefaultConfig.audioStreamController=c.default;e.hlsDefaultConfig.audioTrackController=l.default;e.hlsDefaultConfig.emeController=p.default},"./src/controller/abr-controller.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/utils/buffer-helper.js"),s=r("./src/errors.js"),l=r("./src/utils/logger.js"),c=r("./src/utils/ewma-bandwidth-estimator.js"),u=window.performance,d=function(e){function r(t){var r=e.call(this,t,n.default.FRAG_LOADING,n.default.FRAG_LOADED,n.default.FRAG_BUFFERED,n.default.ERROR)||this;r.lastLoadedFragLevel=0;r._nextAutoLevel=-1;r.hls=t;r.timer=null;r._bwEstimator=null;r.onCheck=r._abandonRulesCheck.bind(r);return r}i(r,e);r.prototype.destroy=function(){this.clearTimer();a.default.prototype.destroy.call(this)};r.prototype.onFragLoading=function(t){var e=t.frag;if("main"===e.type){if(!this.timer){this.fragCurrent=e;this.timer=setInterval(this.onCheck,100)}if(!this._bwEstimator){var r=this.hls,i=r.config,n=e.level,a=r.levels[n].details.live,o=void 0,s=void 0;if(a){o=i.abrEwmaFastLive;s=i.abrEwmaSlowLive}else{o=i.abrEwmaFastVoD;s=i.abrEwmaSlowVoD}this._bwEstimator=new c.default(r,s,o,i.abrEwmaDefaultEstimate)}}};r.prototype._abandonRulesCheck=function(){var t=this.hls,e=t.media,r=this.fragCurrent;if(r){var i=r.loader,a=t.minAutoLevel;if(!i||i.stats&&i.stats.aborted){l.logger.warn("frag loader destroy or aborted, disarm abandonRules");this.clearTimer();this._nextAutoLevel=-1}else{var s=i.stats;if(e&&s&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&r.autoLevel&&r.level){var c=u.now()-s.trequest,d=Math.abs(e.playbackRate);if(c>500*r.duration/d){var h=t.levels,f=Math.max(1,s.bw?s.bw/8:1e3*s.loaded/c),p=h[r.level],g=p.realBitrate?Math.max(p.realBitrate,p.bitrate):p.bitrate,y=s.total?s.total:Math.max(s.loaded,Math.round(r.duration*g/8)),v=e.currentTime,m=(y-s.loaded)/f,b=(o.BufferHelper.bufferInfo(e,v,t.config.maxBufferHole).end-v)/d;if(b<2*r.duration/d&&m>b){var E=void 0,_=void 0;for(_=r.level-1;_>a;_--){E=r.duration*(h[_].realBitrate?Math.max(h[_].realBitrate,h[_].bitrate):h[_].bitrate)/(6.4*f);if(E<b)break}if(E<m){l.logger.warn("loading too slow, abort fragment loading and switch to level "+_+":fragLoadedDelay["+_+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+E.toFixed(1)+"<"+m.toFixed(1)+":"+b.toFixed(1));t.nextLoadLevel=_;this._bwEstimator.sample(c,s.loaded);i.abort();this.clearTimer();t.trigger(n.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:s})}}}}}}};r.prototype.onFragLoaded=function(e){var r=e.frag;if("main"===r.type&&t.isFinite(r.sn)){this.clearTimer();this.lastLoadedFragLevel=r.level;this._nextAutoLevel=-1;if(this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[r.level],n=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,a=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:n,duration:a};i.realBitrate=Math.round(8*n/a)}if(e.frag.bitrateTest){var o=e.stats;o.tparsed=o.tbuffered=o.tload;this.onFragBuffered(e)}}};r.prototype.onFragBuffered=function(e){var r=e.stats,i=e.frag;if(!0!==r.aborted&&"main"===i.type&&t.isFinite(i.sn)&&(!i.bitrateTest||r.tload===r.tbuffered)){var n=r.tparsed-r.trequest;l.logger.log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest)));this._bwEstimator.sample(n,r.loaded);r.bwEstimate=this._bwEstimator.getEstimate();this.bitrateTestDelay=i.bitrateTest?n/1e3:0}};r.prototype.onError=function(t){switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}};r.prototype.clearTimer=function(){clearInterval(this.timer);this.timer=null};Object.defineProperty(r.prototype,"nextAutoLevel",{get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;var r=this._nextABRAutoLevel;-1!==t&&(r=Math.min(t,r));return r},set:function(t){this._nextAutoLevel=t},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"_nextABRAutoLevel",{get:function(){var t=this.hls,e=t.maxAutoLevel,r=t.levels,i=t.config,n=t.minAutoLevel,a=t.media,s=this.lastLoadedFragLevel,c=this.fragCurrent?this.fragCurrent.duration:0,u=a?a.currentTime:0,d=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,h=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,f=(o.BufferHelper.bufferInfo(a,u,i.maxBufferHole).end-u)/d,p=this._findBestLevel(s,c,h,n,e,f,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(p>=0)return p;l.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var g=c?Math.min(c,i.maxStarvationDelay):i.maxStarvationDelay,y=i.abrBandWidthFactor,v=i.abrBandWidthUpFactor;if(0===f){var m=this.bitrateTestDelay;if(m){g=(c?Math.min(c,i.maxLoadingDelay):i.maxLoadingDelay)-m;l.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms");y=v=1}}p=this._findBestLevel(s,c,h,n,e,f+g,y,v,r);return Math.max(p,0)},enumerable:!0,configurable:!0});r.prototype._findBestLevel=function(t,e,r,i,n,a,o,s,c){for(var u=n;u>=i;u--){var d=c[u];if(d){var h=d.details,f=h?h.totalduration/h.fragments.length:e,p=!!h&&h.live,g=void 0;g=u<=t?o*r:s*r;var y=c[u].realBitrate?Math.max(c[u].realBitrate,c[u].bitrate):c[u].bitrate,v=y*f/g;l.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(g)+"/"+y+"/"+f+"/"+a+"/"+v);if(g>y&&(!v||p&&!this.bitrateTestDelay||v<a))return u}}return-1};return r}(a.default);e.default=d}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/audio-stream-controller.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/utils/binary-search.js"),a=r("./src/utils/buffer-helper.js"),o=r("./src/demux/demuxer.js"),s=r("./src/events.js"),l=r("./src/controller/level-helper.js"),c=r("./src/utils/time-ranges.js"),u=r("./src/errors.js"),d=r("./src/utils/logger.js"),h=r("./src/utils/discontinuities.js"),f=r("./src/controller/fragment-tracker.js"),p=r("./src/loader/fragment.js"),g=r("./src/controller/base-stream-controller.js"),y=window.performance,v=function(e){function r(t,r){var i=e.call(this,t,s.default.MEDIA_ATTACHED,s.default.MEDIA_DETACHING,s.default.AUDIO_TRACKS_UPDATED,s.default.AUDIO_TRACK_SWITCHING,s.default.AUDIO_TRACK_LOADED,s.default.KEY_LOADED,s.default.FRAG_LOADED,s.default.FRAG_PARSING_INIT_SEGMENT,s.default.FRAG_PARSING_DATA,s.default.FRAG_PARSED,s.default.ERROR,s.default.BUFFER_RESET,s.default.BUFFER_CREATED,s.default.BUFFER_APPENDED,s.default.BUFFER_FLUSHED,s.default.INIT_PTS_FOUND)||this;i.fragmentTracker=r;i.config=t.config;i.audioCodecSwap=!1;i._state=g.State.STOPPED;i.initPTS=[];i.waitingFragment=null;i.videoTrackCC=null;return i}i(r,e);r.prototype.onHandlerDestroying=function(){this.stopLoad();e.prototype.onHandlerDestroying.call(this)};r.prototype.onHandlerDestroyed=function(){this.state=g.State.STOPPED;this.fragmentTracker=null;e.prototype.onHandlerDestroyed.call(this)};r.prototype.onInitPtsFound=function(t){var e=t.id,r=t.frag.cc,i=t.initPTS;if("main"===e){this.initPTS[r]=i;this.videoTrackCC=r;d.logger.log("InitPTS for cc: "+r+" found from video track: "+i);this.state===g.State.WAITING_INIT_PTS&&this.tick()}};r.prototype.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad();this.setInterval(100);this.fragLoadError=0;if(e>0&&-1===t){d.logger.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3));this.state=g.State.IDLE}else{this.lastCurrentTime=this.startPosition?this.startPosition:t;this.state=g.State.STARTING}this.nextLoadPosition=this.startPosition=this.lastCurrentTime;this.tick()}else{this.startPosition=t;this.state=g.State.STOPPED}};r.prototype.stopLoad=function(){var t=this.fragCurrent;if(t){t.loader&&t.loader.abort();this.fragmentTracker.removeFragment(t);this.fragCurrent=null}this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.state=g.State.STOPPED};Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(t){if(this.state!==t){var e=this.state;this._state=t;d.logger.log("audio stream:"+e+"->"+t)}},enumerable:!0,configurable:!0});r.prototype.doTick=function(){var e,r,i,o=this.hls,l=o.config;switch(this.state){case g.State.ERROR:case g.State.PAUSED:case g.State.BUFFER_FLUSHING:break;case g.State.STARTING:this.state=g.State.WAITING_TRACK;this.loadedmetadata=!1;break;case g.State.IDLE:var c=this.tracks;if(!c)break;if(!this.media&&(this.startFragRequested||!l.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else{e=this.nextLoadPosition;if(void 0===e)break}var u=this.mediaBuffer?this.mediaBuffer:this.media,p=this.videoBuffer?this.videoBuffer:this.media,v=a.BufferHelper.bufferInfo(u,e,l.maxBufferHole),m=a.BufferHelper.bufferInfo(p,e,l.maxBufferHole),b=v.len,E=v.end,_=this.fragPrevious,S=Math.min(l.maxBufferLength,l.maxMaxBufferLength),T=Math.max(S,m.len),w=this.audioSwitch,O=this.trackId;if((b<T||w)&&O<c.length){i=c[O].details;if(void 0===i){this.state=g.State.WAITING_TRACK;break}if(!w&&this._streamEnded(v,i)){this.hls.trigger(s.default.BUFFER_EOS,{type:"audio"});this.state=g.State.ENDED;return}var A=i.fragments,C=A.length,R=A[0].start,L=A[C-1].start+A[C-1].duration,k=void 0;if(w)if(i.live&&!i.PTSKnown){d.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment");E=0}else{E=e;if(i.PTSKnown&&e<R){if(!(v.end>R||v.nextStart))return;d.logger.log("alt audio track ahead of main track, seek to start of alt audio track");this.media.currentTime=R+.05}}if(i.initSegment&&!i.initSegment.data)k=i.initSegment;else if(E<=R){k=A[0];null!==this.videoTrackCC&&k.cc!==this.videoTrackCC&&(k=h.findFragWithCC(A,this.videoTrackCC));if(i.live&&k.loadIdx&&k.loadIdx===this.fragLoadIdx){var D=v.nextStart?v.nextStart:R;d.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(D+.05));this.media.currentTime=D+.05;return}}else{var x=void 0,P=l.maxFragLookUpTolerance,I=_?A[_.sn-A[0].sn+1]:void 0,j=function(t){var e=Math.min(P,t.duration);return t.start+t.duration-e<=E?1:t.start-e>E&&t.start?-1:0};if(E<L){E>L-P&&(P=0);x=I&&!j(I)?I:n.default.search(A,j)}else x=A[C-1];if(x){k=x;R=x.start;if(_&&k.level===_.level&&k.sn===_.sn)if(k.sn<i.endSN){k=A[k.sn+1-i.startSN];d.logger.log("SN just loaded, load next one: "+k.sn)}else k=null}}if(k)if(k.encrypted){d.logger.log("Loading key for "+k.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+O);this.state=g.State.KEY_LOADING;o.trigger(s.default.KEY_LOADING,{frag:k})}else{d.logger.log("Loading "+k.sn+", cc: "+k.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+O+", currentTime:"+e+",bufferEnd:"+E.toFixed(3));this.fragCurrent=k;if(w||this.fragmentTracker.getState(k)===f.FragmentState.NOT_LOADED){this.startFragRequested=!0;t.isFinite(k.sn)&&(this.nextLoadPosition=k.start+k.duration);o.trigger(s.default.FRAG_LOADING,{frag:k});this.state=g.State.FRAG_LOADING}}}break;case g.State.WAITING_TRACK:r=this.tracks[this.trackId];r&&r.details&&(this.state=g.State.IDLE);break;case g.State.FRAG_LOADING_WAITING_RETRY:var F=y.now(),M=this.retryDate;u=this.media;var N=u&&u.seeking;if(!M||F>=M||N){d.logger.log("audioStreamController: retryDate reached, switch back to IDLE state");this.state=g.State.IDLE}break;case g.State.WAITING_INIT_PTS:var U=this.videoTrackCC;if(void 0===this.initPTS[U])break;var B=this.waitingFragment;if(B){var V=B.frag.cc;if(U!==V){r=this.tracks[this.trackId];if(r.details&&r.details.live){d.logger.warn("Waiting fragment CC ("+V+") does not match video track CC ("+U+")");this.waitingFragment=null;this.state=g.State.IDLE}}else{this.state=g.State.FRAG_LOADING;this.onFragLoaded(this.waitingFragment);this.waitingFragment=null}}else this.state=g.State.IDLE}};r.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);e.addEventListener("seeking",this.onvseeking);e.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)};r.prototype.onMediaDetaching=function(){var t=this.media;if(t&&t.ended){d.logger.log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.media=this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1;this.stopLoad()};r.prototype.onAudioTracksUpdated=function(t){d.logger.log("audio tracks updated");this.tracks=t.audioTracks};r.prototype.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id;this.fragCurrent=null;this.state=g.State.PAUSED;this.waitingFragment=null;if(e)this.setInterval(100);else if(this.demuxer){this.demuxer.destroy();this.demuxer=null}if(e){this.audioSwitch=!0;this.state=g.State.IDLE}this.tick()};r.prototype.onAudioTrackLoaded=function(e){var r=e.details,i=e.id,n=this.tracks[i],a=r.totalduration,o=0;d.logger.log("track "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+a);if(r.live){var s=n.details;if(s&&r.fragments.length>0){l.mergeDetails(s,r);o=r.fragments[0].start;d.logger.log(r.PTSKnown?"live audio playlist sliding:"+o.toFixed(3):"live audio playlist - outdated PTS, unknown sliding")}else{r.PTSKnown=!1;d.logger.log("live audio playlist - first load, unknown sliding")}}else r.PTSKnown=!1;n.details=r;if(!this.startFragRequested){if(-1===this.startPosition){var c=r.startTimeOffset;if(t.isFinite(c)){d.logger.log("start time offset found in playlist, adjust startPosition to "+c);this.startPosition=c}else this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===g.State.WAITING_TRACK&&(this.state=g.State.IDLE);this.tick()};r.prototype.onKeyLoaded=function(){if(this.state===g.State.KEY_LOADING){this.state=g.State.IDLE;this.tick()}};r.prototype.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag;if(this.state===g.State.FRAG_LOADING&&e&&"audio"===r.type&&r.level===e.level&&r.sn===e.sn){var i=this.tracks[this.trackId],n=i.details,a=n.totalduration,l=e.level,c=e.sn,u=e.cc,h=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",f=this.stats=t.stats;if("initSegment"===c){this.state=g.State.IDLE;f.tparsed=f.tbuffered=y.now();n.initSegment.data=t.payload;this.hls.trigger(s.default.FRAG_BUFFERED,{stats:f,frag:e,id:"audio"});this.tick()}else{this.state=g.State.PARSING;this.appended=!1;this.demuxer||(this.demuxer=new o.default(this.hls,"audio"));var p=this.initPTS[u],v=n.initSegment?n.initSegment.data:[];if(n.initSegment||void 0!==p){this.pendingBuffering=!0;d.logger.log("Demuxing "+c+" of ["+n.startSN+" ,"+n.endSN+"],track "+l);this.demuxer.push(t.payload,v,h,null,e,a,!1,p)}else{d.logger.log("unknown video PTS for continuity counter "+u+", waiting for video PTS before demuxing audio frag "+c+" of ["+n.startSN+" ,"+n.endSN+"],track "+l);this.waitingFragment=t;this.state=g.State.WAITING_INIT_PTS}}}this.fragLoadError=0};r.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===g.State.PARSING){var i=t.tracks,n=void 0;i.video&&delete i.video;n=i.audio;if(n){n.levelCodec=n.codec;n.id=t.id;this.hls.trigger(s.default.BUFFER_CODECS,i);d.logger.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var a=n.initSegment;if(a){var o={type:"audio",data:a,parent:"audio",content:"initSegment"};if(this.audioSwitch)this.pendingData=[o];else{this.appended=!0;this.pendingBuffering=!0;this.hls.trigger(s.default.BUFFER_APPENDING,o)}}this.tick()}}};r.prototype.onFragParsingData=function(e){var r=this,i=this.fragCurrent,n=e.frag;if(i&&"audio"===e.id&&"audio"===e.type&&n.sn===i.sn&&n.level===i.level&&this.state===g.State.PARSING){var a=this.trackId,o=this.tracks[a],c=this.hls;if(!t.isFinite(e.endPTS)){e.endPTS=e.startPTS+i.duration;e.endDTS=e.startDTS+i.duration}i.addElementaryStream(p.default.ElementaryStreamTypes.AUDIO);d.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb);l.updateFragPTSDTS(o.details,i,e.startPTS,e.endPTS);var h=this.audioSwitch,f=this.media,y=!1;if(h&&f)if(f.readyState){var v=f.currentTime;d.logger.log("switching audio track : currentTime:"+v);if(v>=e.startPTS){d.logger.log("switching audio track : flushing all audio");this.state=g.State.BUFFER_FLUSHING;c.trigger(s.default.BUFFER_FLUSHING,{startOffset:0,endOffset:t.POSITIVE_INFINITY,type:"audio"});y=!0;this.audioSwitch=!1;c.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:a})}}else{this.audioSwitch=!1;c.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:a})}var m=this.pendingData;if(!m){d.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront");c.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});return}if(!this.audioSwitch){[e.data1,e.data2].forEach(function(t){t&&t.length&&m.push({type:e.type,data:t,parent:"audio",content:"data"})});if(!y&&m.length){m.forEach(function(t){if(r.state===g.State.PARSING){r.pendingBuffering=!0;r.hls.trigger(s.default.BUFFER_APPENDING,t)}});this.pendingData=[];this.appended=!0}}this.tick()}};r.prototype.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===g.State.PARSING){this.stats.tparsed=y.now();this.state=g.State.PARSED;this._checkAppendedParsed()}};r.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1};r.prototype.onBufferCreated=function(t){var e=t.tracks.audio;if(e){this.mediaBuffer=e.buffer;this.loadedmetadata=!0}t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)};r.prototype.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;if(e===g.State.PARSING||e===g.State.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};r.prototype._checkAppendedParsed=function(){if(!(this.state!==g.State.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,r=this.hls;if(t){this.fragPrevious=t;e.tbuffered=y.now();r.trigger(s.default.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});d.logger.log("audio buffered : "+c.default.toString((this.mediaBuffer?this.mediaBuffer:this.media).buffered));if(this.audioSwitch&&this.appended){this.audioSwitch=!1;r.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})}this.state=g.State.IDLE}this.tick()}};r.prototype.onError=function(e){var r=e.frag;if(!r||"audio"===r.type)switch(e.details){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:var i=e.frag;if(i&&"audio"!==i.type)break;if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var o=this.config;if(n<=o.fragLoadingMaxRetry){this.fragLoadError=n;var l=Math.min(Math.pow(2,n-1)*o.fragLoadingRetryDelay,o.fragLoadingMaxRetryTimeout);d.logger.warn("AudioStreamController: frag loading failed, retry in "+l+" ms");this.retryDate=y.now()+l;this.state=g.State.FRAG_LOADING_WAITING_RETRY}else{d.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ...");e.fatal=!0;this.state=g.State.ERROR}}break;case u.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case u.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case u.ErrorDetails.KEY_LOAD_ERROR:case u.ErrorDetails.KEY_LOAD_TIMEOUT:if(this.state!==g.State.ERROR){this.state=e.fatal?g.State.ERROR:g.State.IDLE;d.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ...")}break;case u.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===g.State.PARSING||this.state===g.State.PARSED)){var c=this.mediaBuffer,h=this.media.currentTime;if(c&&a.BufferHelper.isBuffered(c,h)&&a.BufferHelper.isBuffered(c,h+.5)){var o=this.config;if(o.maxMaxBufferLength>=o.maxBufferLength){o.maxMaxBufferLength/=2;d.logger.warn("AudioStreamController: reduce max buffer length to "+o.maxMaxBufferLength+"s")}this.state=g.State.IDLE}else{d.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer");this.fragCurrent=null;this.state=g.State.BUFFER_FLUSHING;this.hls.trigger(s.default.BUFFER_FLUSHING,{startOffset:0,endOffset:t.POSITIVE_INFINITY,type:"audio"})}}}};r.prototype.onBufferFlushed=function(){var t=this,e=this.pendingData;if(e&&e.length){d.logger.log("AudioStreamController: appending pending audio data after buffer flushed");e.forEach(function(e){t.hls.trigger(s.default.BUFFER_APPENDING,e)});this.appended=!0;this.pendingData=[];this.state=g.State.PARSED}else{this.state=g.State.IDLE;this.fragPrevious=null;this.tick()}};return r}(g.default);e.default=v}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/audio-track-controller.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/task-loop.js"),o=r("./src/utils/logger.js"),s=r("./src/errors.js");e.default=function(t){function e(e){var r=t.call(this,e,n.default.MANIFEST_LOADING,n.default.MANIFEST_PARSED,n.default.AUDIO_TRACK_LOADED,n.default.AUDIO_TRACK_SWITCHED,n.default.LEVEL_LOADED,n.default.ERROR)||this;r._trackId=-1;r._selectDefaultTrack=!0;r.tracks=[];r.trackIdBlacklist=Object.create(null);r.audioGroupId=null;return r}i(e,t);e.prototype.onManifestLoading=function(){this.tracks=[];this._trackId=-1;this._selectDefaultTrack=!0};e.prototype.onManifestParsed=function(t){var e=this.tracks=t.audioTracks||[];this.hls.trigger(n.default.AUDIO_TRACKS_UPDATED,{audioTracks:e})};e.prototype.onAudioTrackLoaded=function(t){if(t.id>=this.tracks.length)o.logger.warn("Invalid audio track id:",t.id);else{o.logger.log("audioTrack "+t.id+" loaded");this.tracks[t.id].details=t.details;if(t.details.live&&!this.hasInterval()){this.setInterval(1e3*t.details.targetduration)}!t.details.live&&this.hasInterval()&&this.clearInterval()}};e.prototype.onAudioTrackSwitched=function(t){var e=this.tracks[t.id].groupId;e&&this.audioGroupId!==e&&(this.audioGroupId=e)};e.prototype.onLevelLoaded=function(t){var e=this.hls.levels[t.level];if(e.audioGroupIds){var r=e.audioGroupIds[e.urlId];if(this.audioGroupId!==r){this.audioGroupId=r;this._selectInitialAudioTrack()}}};e.prototype.onError=function(t){if(t.type===s.ErrorTypes.NETWORK_ERROR){t.fatal&&this.clearInterval();if(t.details===s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR){o.logger.warn("Network failure on audio-track id:",t.context.id);this._handleLoadError()}}};Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"audioTrack",{get:function(){return this._trackId},set:function(t){this._setAudioTrack(t);this._selectDefaultTrack=!1},enumerable:!0,configurable:!0});e.prototype._setAudioTrack=function(t){if(this._trackId===t&&this.tracks[this._trackId].details)o.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(t<0||t>=this.tracks.length)o.logger.warn("Invalid id passed to audio-track controller");else{var e=this.tracks[t];o.logger.log("Now switching to audio-track index "+t);this.clearInterval();this._trackId=t;var r=e.url,i=e.type,a=e.id;this.hls.trigger(n.default.AUDIO_TRACK_SWITCHING,{id:a,type:i,url:r});this._loadTrackDetailsIfNeeded(e)}};e.prototype.doTick=function(){this._updateTrack(this._trackId)};e.prototype._selectInitialAudioTrack=function(){var t=this,e=this.tracks;if(e.length){var r=this.tracks[this._trackId],i=null;r&&(i=r.name);if(this._selectDefaultTrack){var a=e.filter(function(t){return t.default});a.length?e=a:o.logger.warn("No default audio tracks defined")}var l=!1,c=function(){e.forEach(function(e){if(!l&&!(t.audioGroupId&&e.groupId!==t.audioGroupId||i&&i!==e.name)){t._setAudioTrack(e.id);l=!0}})};c();if(!l){i=null;c()}if(!l){o.logger.error("No track found for running audio group-ID: "+this.audioGroupId);this.hls.trigger(n.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0})}}};e.prototype._needsTrackLoading=function(t){var e=t.details,r=t.url;return!(e&&!e.live)&&!!r};e.prototype._loadTrackDetailsIfNeeded=function(t){if(this._needsTrackLoading(t)){var e=t.url,r=t.id;o.logger.log("loading audio-track playlist for id: "+r);this.hls.trigger(n.default.AUDIO_TRACK_LOADING,{url:e,id:r})}};e.prototype._updateTrack=function(t){if(!(t<0||t>=this.tracks.length)){this.clearInterval();this._trackId=t;o.logger.log("trying to update audio-track "+t);this._loadTrackDetailsIfNeeded(this.tracks[t])}};e.prototype._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var t=this._trackId,e=this.tracks[t],r=e.name,i=e.language;o.logger.warn("Loading failed on audio track id: "+t+", group-id: "+e.groupId+', name/language: "'+r+'" / "'+i+'"');for(var n=t,a=0;a<this.tracks.length;a++)if(!this.trackIdBlacklist[a]){var s=this.tracks[a];if(s.name===r){n=a;break}}if(n!==t){o.logger.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId);this._setAudioTrack(n)}else o.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')};return e}(a.default)},"./src/controller/base-stream-controller.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/task-loop.js"),a=r("./src/controller/fragment-tracker.js"),o=r("./src/utils/buffer-helper.js"),s=r("./src/utils/logger.js");e.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};var l=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}i(n,r);n.prototype.doTick=function(){};n.prototype._streamEnded=function(t,e){var r=this,i=r.fragCurrent,n=r.fragmentTracker;if(!e.live&&i&&!i.backtracked&&i.sn===e.endSN&&!t.nextStart){var o=n.getState(i);return o===a.FragmentState.PARTIAL||o===a.FragmentState.OK}return!1};n.prototype.onMediaSeeking=function(){var r=this,i=r.config,n=r.media,a=r.mediaBuffer,l=r.state,c=n?n.currentTime:null,u=o.BufferHelper.bufferInfo(a||n,c,this.config.maxBufferHole);t.isFinite(c)&&s.logger.log("media seeking to "+c.toFixed(3));if(l===e.State.FRAG_LOADING){var d=this.fragCurrent;if(0===u.len&&d){var h=i.maxFragLookUpTolerance,f=d.start-h,p=d.start+d.duration+h;if(c<f||c>p){if(d.loader){s.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load");d.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;this.state=e.State.IDLE}else s.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else if(l===e.State.ENDED){if(0===u.len){this.fragPrevious=null;this.fragCurrent=null}this.state=e.State.IDLE}n&&(this.lastCurrentTime=c);this.loadedmetadata||(this.nextLoadPosition=this.startPosition=c);this.tick()};n.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0};return n}(n.default);e.default=l}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/buffer-controller.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/utils/logger.js"),s=r("./src/errors.js"),l=r("./src/utils/mediasource-helper.js"),c=l.getMediaSource(),u=function(e){function r(t){var r=e.call(this,t,n.default.MEDIA_ATTACHING,n.default.MEDIA_DETACHING,n.default.MANIFEST_PARSED,n.default.BUFFER_RESET,n.default.BUFFER_APPENDING,n.default.BUFFER_CODECS,n.default.BUFFER_EOS,n.default.BUFFER_FLUSHING,n.default.LEVEL_PTS_UPDATED,n.default.LEVEL_UPDATED)||this;r._msDuration=null;r._levelDuration=null;r._levelTargetDuration=10;r._live=null;r._objectUrl=null;r.bufferCodecEventsExpected=0;r.onsbue=r.onSBUpdateEnd.bind(r);r.onsbe=r.onSBUpdateError.bind(r);r.pendingTracks={};r.tracks={};return r}i(r,e);r.prototype.destroy=function(){a.default.prototype.destroy.call(this)};r.prototype.onLevelPtsUpdated=function(t){var e=t.type,r=this.tracks.audio;if("audio"===e&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(Math.abs(i.timestampOffset-t.start)>.1){var n=i.updating;try{i.abort()}catch(t){o.logger.warn("can not abort audio buffer: "+t)}if(n)this.audioTimestampOffset=t.start;else{o.logger.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+t.start);i.timestampOffset=t.start}}}};r.prototype.onManifestParsed=function(t){this.bufferCodecEventsExpected=t.altAudio?2:1;o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")};r.prototype.onMediaAttaching=function(t){var e=this.media=t.media;if(e){var r=this.mediaSource=new c;this.onmso=this.onMediaSourceOpen.bind(this);this.onmse=this.onMediaSourceEnded.bind(this);this.onmsc=this.onMediaSourceClose.bind(this);r.addEventListener("sourceopen",this.onmso);r.addEventListener("sourceended",this.onmse);r.addEventListener("sourceclose",this.onmsc);e.src=window.URL.createObjectURL(r);this._objectUrl=e.src}};r.prototype.onMediaDetaching=function(){o.logger.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(t){o.logger.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this.onmso);t.removeEventListener("sourceended",this.onmse);t.removeEventListener("sourceclose",this.onmsc);if(this.media){window.URL.revokeObjectURL(this._objectUrl);if(this.media.src===this._objectUrl){this.media.removeAttribute("src");this.media.load()}else o.logger.warn("media.src was changed by a third party - skip cleanup")}this.mediaSource=null;this.media=null;this._objectUrl=null;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.onmso=this.onmse=this.onmsc=null;this.hls.trigger(n.default.MEDIA_DETACHED)};r.prototype.onMediaSourceOpen=function(){o.logger.log("media source opened");this.hls.trigger(n.default.MEDIA_ATTACHED,{media:this.media});var t=this.mediaSource;t&&t.removeEventListener("sourceopen",this.onmso);this.checkPendingTracks()};r.prototype.checkPendingTracks=function(){var t=this,e=t.bufferCodecEventsExpected,r=t.pendingTracks,i=Object.keys(r).length;if(i&&!e||2===i){this.createSourceBuffers(r);this.pendingTracks={};this.doAppending()}};r.prototype.onMediaSourceClose=function(){o.logger.log("media source closed")};r.prototype.onMediaSourceEnded=function(){o.logger.log("media source ended")};r.prototype.onSBUpdateEnd=function(){if(this.audioTimestampOffset){var t=this.sourceBuffer.audio;o.logger.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+this.audioTimestampOffset);t.timestampOffset=this.audioTimestampOffset;delete this.audioTimestampOffset}this._needsFlush&&this.doFlush();this._needsEos&&this.checkEos();this.appending=!1;var e=this.parent,r=this.segments.reduce(function(t,r){return r.parent===e?t+1:t},0),i={},a=this.sourceBuffer;for(var s in a)i[s]=a[s].buffered;this.hls.trigger(n.default.BUFFER_APPENDED,{parent:e,pending:r,timeRanges:i});this._needsFlush||this.doAppending();this.updateMediaElementDuration();0===r&&this.flushLiveBackBuffer()};r.prototype.onSBUpdateError=function(t){o.logger.error("sourceBuffer error:",t);this.hls.trigger(n.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})};r.prototype.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var r=t[e];try{this.mediaSource.removeSourceBuffer(r);r.removeEventListener("updateend",this.onsbue);r.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0};r.prototype.onBufferCodecs=function(t){var e=this;if(!Object.keys(this.sourceBuffer).length){Object.keys(t).forEach(function(r){e.pendingTracks[r]=t[r]});var r=this.mediaSource;this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0);r&&"open"===r.readyState&&this.checkPendingTracks()}};r.prototype.createSourceBuffers=function(t){var e=this.sourceBuffer,r=this.mediaSource;for(var i in t)if(!e[i]){var a=t[i],l=a.levelCodec||a.codec,c=a.container+";codecs="+l;o.logger.log("creating sourceBuffer("+c+")");try{var u=e[i]=r.addSourceBuffer(c);u.addEventListener("updateend",this.onsbue);u.addEventListener("error",this.onsbe);this.tracks[i]={codec:l,container:a.container};a.buffer=u}catch(t){o.logger.error("error while trying to add sourceBuffer:"+t.message);this.hls.trigger(n.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:t,mimeType:c})}}this.hls.trigger(n.default.BUFFER_CREATED,{tracks:t})};r.prototype.onBufferAppending=function(t){if(!this._needsFlush){this.segments?this.segments.push(t):this.segments=[t];this.doAppending()}};r.prototype.onBufferAppendFail=function(t){o.logger.error("sourceBuffer error:",t.event);this.hls.trigger(n.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})};r.prototype.onBufferEos=function(t){var e=this.sourceBuffer,r=t.type;for(var i in e)if(!(r&&i!==r||e[i].ended)){e[i].ended=!0;o.logger.log(i+" sourceBuffer now EOS")}this.checkEos()};r.prototype.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(e&&"open"===e.readyState){for(var r in t){var i=t[r];if(!i.ended)return;if(i.updating){this._needsEos=!0;return}}o.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(t){o.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1};r.prototype.onBufferFlushing=function(t){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type});this.flushBufferCounter=0;this.doFlush()};r.prototype.flushLiveBackBuffer=function(){if(this._live){var t=this.hls.config.liveBackBufferLength;if(isFinite(t)&&!(t<0))for(var e=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),n=e-Math.max(t,this._levelTargetDuration),a=i.length-1;a>=0;a--){var o=i[a],s=r[o].buffered;s.length>0&&n>s.start(0)&&this.removeBufferRange(o,r[o],0,n)}}};r.prototype.onLevelUpdated=function(t){var e=t.details;if(e.fragments.length>0){this._levelDuration=e.totalduration+e.fragments[0].start;this._levelTargetDuration=e.averagetargetduration||e.targetduration||10;this._live=e.live;this.updateMediaElementDuration()}};r.prototype.updateMediaElementDuration=function(){var e,r=this.hls.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;e=this.media.duration;null===this._msDuration&&(this._msDuration=this.mediaSource.duration);if(!0===this._live&&!0===r.liveDurationInfinity){o.logger.log("Media Source duration is set to Infinity");this._msDuration=this.mediaSource.duration=1/0}else if(this._levelDuration>this._msDuration&&this._levelDuration>e||!t.isFinite(e)){o.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3));this._msDuration=this.mediaSource.duration=this._levelDuration}}};r.prototype.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type)){this._needsFlush=!0;return}this.flushRange.shift();this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,r=this.sourceBuffer;try{for(var i in r)e+=r[i].buffered.length}catch(t){o.logger.error("error while accessing sourceBuffer.buffered")}this.appended=e;this.hls.trigger(n.default.BUFFER_FLUSHED)}};r.prototype.doAppending=function(){var t=this,e=t.hls,r=t.segments,i=t.sourceBuffer;if(Object.keys(i).length){if(this.media.error){this.segments=[];o.logger.error("trying to append although a media error occured, flush segment and abort");return}if(this.appending)return;if(r&&r.length){var a=r.shift();try{var l=a.type,c=i[l];if(c)if(c.updating)r.unshift(a);else{c.ended=!1;this.parent=a.parent;c.appendBuffer(a.data);this.appendError=0;this.appended++;this.appending=!0}else this.onSBUpdateEnd()}catch(t){o.logger.error("error while trying to append buffer:"+t.message);r.unshift(a);var u={type:s.ErrorTypes.MEDIA_ERROR,parent:a.parent};if(22!==t.code){this.appendError?this.appendError++:this.appendError=1;u.details=s.ErrorDetails.BUFFER_APPEND_ERROR;if(this.appendError>e.config.appendErrorMaxRetry){o.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer");this.segments=[];u.fatal=!0;e.trigger(n.default.ERROR,u)}else{u.fatal=!1;e.trigger(n.default.ERROR,u)}}else{this.segments=[];u.details=s.ErrorDetails.BUFFER_FULL_ERROR;u.fatal=!1;e.trigger(n.default.ERROR,u)}}}}};r.prototype.flushBuffer=function(t,e,r){var i,n=this.sourceBuffer;if(Object.keys(n).length){o.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+t+"/"+e);if(this.flushBufferCounter<this.appended){for(var a in n)if(!r||a===r){i=n[a];i.ended=!1;if(i.updating){o.logger.warn("cannot flush, sb updating in progress");return!1}if(this.removeBufferRange(a,i,t,e)){this.flushBufferCounter++;return!1}}}else o.logger.warn("abort flushing too many retries");o.logger.log("buffer flushed")}return!0};r.prototype.removeBufferRange=function(t,e,r,i){try{for(var n=0;n<e.buffered.length;n++){var a=e.buffered.start(n),s=e.buffered.end(n),l=Math.max(a,r),c=Math.min(s,i);if(Math.min(c,s)-l>.5){o.logger.log("sb remove "+t+" ["+l+","+c+"], of ["+a+","+s+"], pos:"+this.media.currentTime);e.remove(l,c);return!0}}}catch(t){o.logger.warn("removeBufferRange failed",t)}return!1};return r}(a.default);e.default=u}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/cap-level-controller.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=function(e){function r(r){var i=e.call(this,r,n.default.FPS_DROP_LEVEL_CAPPING,n.default.MEDIA_ATTACHING,n.default.MANIFEST_PARSED,n.default.BUFFER_CODECS,n.default.MEDIA_DETACHING)||this;i.autoLevelCapping=t.POSITIVE_INFINITY;i.firstLevel=null;i.levels=[];i.media=null;i.restrictedLevels=[];i.timer=null;return i}i(r,e);r.prototype.destroy=function(){if(this.hls.config.capLevelToPlayerSize){this.media=null;this._stopCapping()}};r.prototype.onFpsDropLevelCapping=function(t){r.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)};r.prototype.onMediaAttaching=function(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null};r.prototype.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[];this.levels=t.levels;this.firstLevel=t.firstLevel;e.config.capLevelToPlayerSize&&t.video&&this._startCapping()};r.prototype.onBufferCodecs=function(t){this.hls.config.capLevelToPlayerSize&&t.video&&this._startCapping()};r.prototype.onLevelsUpdated=function(t){this.levels=t.levels};r.prototype.onMediaDetaching=function(){this._stopCapping()};r.prototype.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1);e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch();this.autoLevelCapping=e.autoLevelCapping}}};r.prototype.getMaxLevel=function(t){var e=this;return this.levels?r.getMaxLevelByMediaSize(this.levels.filter(function(i,n){return r.isLevelAllowed(n,e.restrictedLevels)&&n<=t}),this.mediaWidth,this.mediaHeight):-1};r.prototype._startCapping=function(){if(!this.timer){this.autoLevelCapping=t.POSITIVE_INFINITY;this.hls.firstLevel=this.getMaxLevel(this.firstLevel);clearInterval(this.timer);this.timer=setInterval(this.detectPlayerSize.bind(this),1e3);this.detectPlayerSize()}};r.prototype._stopCapping=function(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=t.POSITIVE_INFINITY;if(this.timer){this.timer=clearInterval(this.timer);this.timer=null}};Object.defineProperty(r.prototype,"mediaWidth",{get:function(){var t,e=this.media;if(e){t=e.width||e.clientWidth||e.offsetWidth;t*=r.contentScaleFactor}return t},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"mediaHeight",{get:function(){var t,e=this.media;if(e){t=e.height||e.clientHeight||e.offsetHeight;t*=r.contentScaleFactor}return t},enumerable:!0,configurable:!0});Object.defineProperty(r,"contentScaleFactor",{get:function(){var t=1;try{t=window.devicePixelRatio}catch(t){}return t},enumerable:!0,configurable:!0});r.isLevelAllowed=function(t,e){void 0===e&&(e=[]);return-1===e.indexOf(t)};r.getMaxLevelByMediaSize=function(t,e,r){if(!t||t&&!t.length)return-1;for(var i=t.length-1,n=0;n<t.length;n+=1){var a=t[n];if((a.width>=e||a.height>=r)&&function(t,e){return!e||(t.width!==e.width||t.height!==e.height)}(a,t[n+1])){i=n;break}}return i};return r}(a.default);e.default=o}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/eme-controller.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/event-handler.js"),a=r("./src/events.js"),o=r("./src/errors.js"),s=r("./src/utils/logger.js"),l=window.XMLHttpRequest,c={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready"},u=function(t,e,r){var i={videoCapabilities:[]};e.forEach(function(t){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+t+'"'})});return[i]},d=function(t,e,r){switch(t){case c.WIDEVINE:return u(0,r);default:throw Error("Unknown key-system: "+t)}};e.default=function(t){function e(e){var r=t.call(this,e,a.default.MEDIA_ATTACHED,a.default.MANIFEST_PARSED)||this;r._widevineLicenseUrl=e.config.widevineLicenseUrl;r._licenseXhrSetup=e.config.licenseXhrSetup;r._emeEnabled=e.config.emeEnabled;r._requestMediaKeySystemAccess=e.config.requestMediaKeySystemAccessFunc;r._mediaKeysList=[];r._media=null;r._hasSetMediaKeys=!1;r._isMediaEncrypted=!1;r._requestLicenseFailureCount=0;return r}i(e,t);e.prototype.getLicenseServerUrl=function(t){var e;switch(t){case c.WIDEVINE:e=this._widevineLicenseUrl;break;default:e=null}if(!e){s.logger.error('No license server URL configured for key-system "'+t+'"');this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return e};e.prototype._attemptKeySystemAccess=function(t,e,r){var i=this,n=d(t,0,r);if(n){s.logger.log("Requesting encrypted media key-system access");this.requestMediaKeySystemAccess(t,n).then(function(e){i._onMediaKeySystemAccessObtained(t,e)}).catch(function(e){s.logger.error('Failed to obtain key-system "'+t+'" access:',e)})}else s.logger.warn("Can not create config for key-system (maybe because platform is not supported):",t)};Object.defineProperty(e.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0});e.prototype._onMediaKeySystemAccessObtained=function(t,e){var r=this;s.logger.log('Access for key-system "'+t+'" obtained');var i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(i);e.createMediaKeys().then(function(e){i.mediaKeys=e;s.logger.log('Media-keys created for key-system "'+t+'"');r._onMediaKeysCreated()}).catch(function(t){s.logger.error("Failed to create media-keys:",t)})};e.prototype._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){if(!e.mediaKeysSession){e.mediaKeysSession=e.mediaKeys.createSession();t._onNewMediaKeySession(e.mediaKeysSession)}})};e.prototype._onNewMediaKeySession=function(t){var e=this;s.logger.log("New key-system session "+t.sessionId);t.addEventListener("message",function(r){e._onKeySessionMessage(t,r.message)},!1)};e.prototype._onKeySessionMessage=function(t,e){s.logger.log("Got EME message event, creating license request");this._requestLicense(e,function(e){s.logger.log("Received license data, updating key-session");t.update(e)})};e.prototype._onMediaEncrypted=function(t,e){s.logger.log('Media is encrypted using "'+t+'" init data type');this._isMediaEncrypted=!0;this._mediaEncryptionInitDataType=t;this._mediaEncryptionInitData=e;this._attemptSetMediaKeys();this._generateRequestWithPreferredKeySession()};e.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys){s.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet");this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}s.logger.log("Setting keys for encrypted media");this._media.setMediaKeys(t.mediaKeys);this._hasSetMediaKeys=!0}};e.prototype._generateRequestWithPreferredKeySession=function(){var t=this,e=this._mediaKeysList[0];if(e)if(e.mediaKeysSessionInitialized)s.logger.warn("Key-Session already initialized but requested again");else{var r=e.mediaKeysSession;if(!r){s.logger.error("Fatal: Media is encrypted but no key-session existing");this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0})}var i=this._mediaEncryptionInitDataType,n=this._mediaEncryptionInitData;s.logger.log('Generating key-session request for "'+i+'" init data type');e.mediaKeysSessionInitialized=!0;r.generateRequest(i,n).then(function(){s.logger.debug("Key-session generation succeeded")}).catch(function(e){s.logger.error("Error generating key-session request:",e);t.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}else{s.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet");this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0})}};e.prototype._createLicenseXhr=function(t,e,r){var i=new l,n=this._licenseXhrSetup;try{if(n)try{n(i,t)}catch(e){i.open("POST",t,!0);n(i,t)}i.readyState||i.open("POST",t,!0)}catch(t){s.logger.error("Error setting up key-system license XHR",t);this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}i.responseType="arraybuffer";i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,t,e,r);return i};e.prototype._onLicenseRequestReadyStageChange=function(t,e,r,i){switch(t.readyState){case 4:if(200===t.status){this._requestLicenseFailureCount=0;s.logger.log("License request succeeded");i(t.response)}else{s.logger.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")");this._requestLicenseFailureCount++;if(this._requestLicenseFailureCount<=3){s.logger.warn("Retrying license request, "+(3-this._requestLicenseFailureCount+1)+" attempts left");this._requestLicense(r,i);return}this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}};e.prototype._generateLicenseRequestChallenge=function(t,e){var r;t.mediaKeySystemDomain===c.PLAYREADY?s.logger.error("PlayReady is not supported (yet)"):t.mediaKeySystemDomain===c.WIDEVINE?r=e:s.logger.error("Unsupported key-system:",t.mediaKeySystemDomain);return r};e.prototype._requestLicense=function(t,e){s.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(r){var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),n=this._createLicenseXhr(i,t,e);s.logger.log("Sending license request to URL: "+i);n.send(this._generateLicenseRequestChallenge(r,t))}else{s.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet");this.hls.trigger(a.default.ERROR,{type:o.ErrorTypes.KEY_SYSTEM_ERROR,details:o.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0})}};e.prototype.onMediaAttached=function(t){var e=this;if(this._emeEnabled){var r=t.media;this._media=r;r.addEventListener("encrypted",function(t){e._onMediaEncrypted(t.initDataType,t.initData)})}};e.prototype.onManifestParsed=function(t){if(this._emeEnabled){var e=t.levels.map(function(t){return t.audioCodec}),r=t.levels.map(function(t){return t.videoCodec});this._attemptKeySystemAccess(c.WIDEVINE,e,r)}};return e}(n.default)},"./src/controller/fps-controller.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/utils/logger.js"),s=window.performance;e.default=function(t){function e(e){return t.call(this,e,n.default.MEDIA_ATTACHING)||this}i(e,t);e.prototype.destroy=function(){this.timer&&clearInterval(this.timer);this.isVideoPlaybackQualityAvailable=!1};e.prototype.onMediaAttaching=function(t){var e=this.hls.config;if(e.capLevelOnFPSDrop){"function"==typeof(this.video=t.media instanceof window.HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0);clearInterval(this.timer);this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod)}};e.prototype.checkFPS=function(t,e,r){var i=s.now();if(e){if(this.lastTime){var a=i-this.lastTime,l=r-this.lastDroppedFrames,c=e-this.lastDecodedFrames,u=1e3*l/a,d=this.hls;d.trigger(n.default.FPS_DROP,{currentDropped:l,currentDecoded:c,totalDroppedFrames:r});if(u>0&&l>d.config.fpsDroppedMonitoringThreshold*c){var h=d.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h);if(h>0&&(-1===d.autoLevelCapping||d.autoLevelCapping>=h)){h-=1;d.trigger(n.default.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:d.currentLevel});d.autoLevelCapping=h;d.streamController.nextLevelSwitch()}}}this.lastTime=i;this.lastDroppedFrames=r;this.lastDecodedFrames=e}};e.prototype.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)};return e}(a.default)},"./src/controller/fragment-finders.js":function(t,e,r){"use strict";(function(t){function i(e,r,i){if(!Array.isArray(e)||!e.length||!t.isFinite(r))return null;if(r<e[0].programDateTime)return null;if(r>=e[e.length-1].endProgramDateTime)return null;i=i||0;for(var n=0;n<e.length;++n){var a=e[n];if(o(r,i,a))return a}return null}function n(t,e,r,i){void 0===r&&(r=0);void 0===i&&(i=0);var n=t?e[t.sn-e[0].sn+1]:null;return n&&!a(r,i,n)?n:s.default.search(e,a.bind(null,r,i))}function a(t,e,r){void 0===t&&(t=0);void 0===e&&(e=0);var i=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=t?1:r.start-i>t&&r.start?-1:0}function o(t,e,r){return r.endProgramDateTime-1e3*Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0))>t}Object.defineProperty(e,"__esModule",{value:!0});var s=r("./src/utils/binary-search.js");e.findFragmentByPDT=i;e.findFragmentByPTS=n;e.fragmentWithinToleranceTest=a;e.pdtWithinToleranceTest=o}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/fragment-tracker.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/event-handler.js"),a=r("./src/events.js");e.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var o=function(r){function o(t){var e=r.call(this,t,a.default.BUFFER_APPENDED,a.default.FRAG_BUFFERED,a.default.FRAG_LOADED)||this;e.bufferPadding=.2;e.fragments=Object.create(null);e.timeRanges=Object.create(null);e.config=t.config;return e}i(o,r);o.prototype.destroy=function(){this.fragments=null;this.timeRanges=null;this.config=null;n.default.prototype.destroy.call(this);r.prototype.destroy.call(this)};o.prototype.getBufferedFrag=function(t,e){var r=this.fragments,i=Object.keys(r).filter(function(i){var n=r[i];if(n.body.type!==e)return!1;if(!n.buffered)return!1;var a=n.body;return a.startPTS<=t&&t<=a.endPTS});if(0===i.length)return null;var n=i.pop();return r[n].body};o.prototype.detectEvictedFragments=function(t,e){var r,i,n=this;Object.keys(this.fragments).forEach(function(a){var o=n.fragments[a];if(!0===o.buffered){var s=o.range[t];if(s){r=s.time;for(var l=0;l<r.length;l++){i=r[l];if(!1===n.isTimeBuffered(i.startPTS,i.endPTS,e)){n.removeFragment(o.body);break}}}}})};o.prototype.detectPartialFragments=function(t){var e=this,r=this.getFragmentKey(t),i=this.fragments[r];if(i){i.buffered=!0;Object.keys(this.timeRanges).forEach(function(r){if(t.hasElementaryStream(r)){i.range[r]=e.getBufferedTimes(t.startPTS,t.endPTS,e.timeRanges[r])}})}};o.prototype.getBufferedTimes=function(t,e,r){for(var i,n,a=[],o=!1,s=0;s<r.length;s++){i=r.start(s)-this.bufferPadding;n=r.end(s)+this.bufferPadding;if(t>=i&&e<=n){a.push({startPTS:Math.max(t,r.start(s)),endPTS:Math.min(e,r.end(s))});break}if(t<n&&e>i){a.push({startPTS:Math.max(t,r.start(s)),endPTS:Math.min(e,r.end(s))});o=!0}else if(e<=i)break}return{time:a,partial:o}};o.prototype.getFragmentKey=function(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn};o.prototype.getPartialFragment=function(t){var e,r,i,n=this,a=null,o=0;Object.keys(this.fragments).forEach(function(s){var l=n.fragments[s];if(n.isPartial(l)){r=l.body.startPTS-n.bufferPadding;i=l.body.endPTS+n.bufferPadding;if(t>=r&&t<=i){e=Math.min(t-r,i-t);if(o<=e){a=l.body;o=e}}}});return a};o.prototype.getState=function(t){var r=this.getFragmentKey(t),i=this.fragments[r],n=e.FragmentState.NOT_LOADED;void 0!==i&&(n=i.buffered?!0===this.isPartial(i)?e.FragmentState.PARTIAL:e.FragmentState.OK:e.FragmentState.APPENDING);return n};o.prototype.isPartial=function(t){return!0===t.buffered&&(void 0!==t.range.video&&!0===t.range.video.partial||void 0!==t.range.audio&&!0===t.range.audio.partial)};o.prototype.isTimeBuffered=function(t,e,r){for(var i,n,a=0;a<r.length;a++){i=r.start(a)-this.bufferPadding;n=r.end(a)+this.bufferPadding;if(t>=i&&e<=n)return!0;if(e<=i)return!1}return!1};o.prototype.onFragLoaded=function(e){var r=e.frag;t.isFinite(r.sn)&&!r.bitrateTest&&(this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:!1})};o.prototype.onBufferAppended=function(t){var e=this;this.timeRanges=t.timeRanges;Object.keys(this.timeRanges).forEach(function(t){e.detectEvictedFragments(t,e.timeRanges[t])})};o.prototype.onFragBuffered=function(t){this.detectPartialFragments(t.frag)};o.prototype.hasFragment=function(t){return void 0!==this.fragments[this.getFragmentKey(t)]};o.prototype.removeFragment=function(t){delete this.fragments[this.getFragmentKey(t)]};o.prototype.removeAllFragments=function(){this.fragments=Object.create(null)};return o}(n.default);e.FragmentTracker=o}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/gap-controller.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/buffer-helper.js"),n=r("./src/errors.js"),a=r("./src/events.js"),o=r("./src/utils/logger.js");e.default=function(){function t(t,e,r,i){this.config=t;this.media=e;this.fragmentTracker=r;this.hls=i;this.stallReported=!1}t.prototype.poll=function(t,e){var r=this,n=r.config,a=r.media,s=a.currentTime,l=window.performance.now();if(s===t){if(!(a.ended||!a.buffered.length||a.readyState>2||a.seeking&&i.BufferHelper.isBuffered(a,s))){var c=l-this.stalled,u=i.BufferHelper.bufferInfo(a,s,n.maxBufferHole);if(this.stalled){c>=1e3&&this._reportStall(u.len);this._tryFixBufferStall(u,c)}else this.stalled=l}}else{if(this.stallReported){o.logger.warn("playback not stuck anymore @"+s+", after "+Math.round(l-this.stalled)+"ms");this.stallReported=!1}this.stalled=null;this.nudgeRetry=0}};t.prototype._tryFixBufferStall=function(t,e){var r=this,i=r.config,n=r.fragmentTracker,a=r.media,o=a.currentTime,s=n.getPartialFragment(o);s&&this._trySkipBufferHole(s);if(t.len>.5&&e>1e3*i.highBufferWatchdogPeriod){this.stalled=null;this._tryNudgeBuffer()}};t.prototype._reportStall=function(t){var e=this,r=e.hls,i=e.media;if(!e.stallReported){this.stallReported=!0;o.logger.warn("Playback stalling at @"+i.currentTime+" due to low buffer");r.trigger(a.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:t})}};t.prototype._trySkipBufferHole=function(t){for(var e=this,r=e.hls,i=e.media,s=i.currentTime,l=0,c=0;c<i.buffered.length;c++){var u=i.buffered.start(c);if(s>=l&&s<u){i.currentTime=Math.max(u,i.currentTime+.1);o.logger.warn("skipping hole, adjusting currentTime from "+s+" to "+i.currentTime);this.stalled=null;r.trigger(a.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+s+" to "+i.currentTime,frag:t});return}l=i.buffered.end(c)}};t.prototype._tryNudgeBuffer=function(){var t=this,e=t.config,r=t.hls,i=t.media,s=i.currentTime,l=(this.nudgeRetry||0)+1;this.nudgeRetry=l;if(l<e.nudgeMaxRetry){var c=s+l*e.nudgeOffset;o.logger.log("adjust currentTime from "+s+" to "+c);i.currentTime=c;r.trigger(a.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else{o.logger.error("still stuck in high buffer @"+s+" after "+e.nudgeMaxRetry+", raise fatal error");r.trigger(a.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}};return t}()},"./src/controller/id3-track-controller.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/demux/id3.js"),s=r("./src/utils/texttrack-utils.js");e.default=function(t){function e(e){var r=t.call(this,e,n.default.MEDIA_ATTACHED,n.default.MEDIA_DETACHING,n.default.FRAG_PARSING_METADATA)||this;r.id3Track=void 0;r.media=void 0;return r}i(e,t);e.prototype.destroy=function(){a.default.prototype.destroy.call(this)};e.prototype.onMediaAttached=function(t){this.media=t.media};e.prototype.onMediaDetaching=function(){s.clearCurrentCues(this.id3Track);this.id3Track=void 0;this.media=void 0};e.prototype.getID3Track=function(t){for(var e=0;e<t.length;e++){var r=t[e];if("metadata"===r.kind&&"id3"===r.label){s.sendAddTrackEvent(r,this.media);return r}}return this.media.addTextTrack("metadata","id3")};e.prototype.onFragParsingMetadata=function(t){var e=t.frag,r=t.samples;if(!this.id3Track){this.id3Track=this.getID3Track(this.media.textTracks);this.id3Track.mode="hidden"}for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<r.length;n++){var a=o.default.getID3Frames(r[n].data);if(a){var s=r[n].pts,l=n<r.length-1?r[n+1].pts:e.endPTS;s===l&&(l+=1e-4);for(var c=0;c<a.length;c++){var u=a[c];if(!o.default.isTimeStampFrame(u)){var d=new i(s,l,"");d.value=u;this.id3Track.addCue(d)}}}}};return e}(a.default)},"./src/controller/level-controller.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n,a=r("./src/events.js"),o=r("./src/event-handler.js"),s=r("./src/utils/logger.js"),l=r("./src/errors.js"),c=r("./src/utils/codecs.js"),u=r("./src/controller/level-helper.js"),d=window.performance;e.default=function(t){function e(e){var r=t.call(this,e,a.default.MANIFEST_LOADED,a.default.LEVEL_LOADED,a.default.AUDIO_TRACK_SWITCHED,a.default.FRAG_LOADED,a.default.ERROR)||this;r.canload=!1;r.currentLevelIndex=null;r.manualLevelIndex=-1;r.timer=null;n=/chrome|firefox/.test(navigator.userAgent.toLowerCase());return r}i(e,t);e.prototype.onHandlerDestroying=function(){this.clearTimer();this.manualLevelIndex=-1};e.prototype.clearTimer=function(){if(null!==this.timer){clearTimeout(this.timer);this.timer=null}};e.prototype.startLoad=function(){var t=this._levels;this.canload=!0;this.levelRetryCount=0;t&&t.forEach(function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)});null!==this.timer&&this.loadLevel()};e.prototype.stopLoad=function(){this.canload=!1};e.prototype.onManifestLoaded=function(t){var e,r=[],i=[],o={},d=null,h=!1,f=!1;t.levels.forEach(function(t){var e=t.attrs;t.loadError=0;t.fragmentError=!1;h=h||!!t.videoCodec;f=f||!!t.audioCodec;n&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0);d=o[t.bitrate];if(d)d.url.push(t.url);else{t.url=[t.url];t.urlId=0;o[t.bitrate]=t;r.push(t)}if(e){if(e.AUDIO){f=!0;u.addGroupId(d||t,"audio",e.AUDIO)}e.SUBTITLES&&u.addGroupId(d||t,"text",e.SUBTITLES)}});h&&f&&(r=r.filter(function(t){return!!t.videoCodec}));r=r.filter(function(t){var e=t.audioCodec,r=t.videoCodec;return(!e||c.isCodecSupportedInMp4(e,"audio"))&&(!r||c.isCodecSupportedInMp4(r,"video"))});if(t.audioTracks){i=t.audioTracks.filter(function(t){return!t.audioCodec||c.isCodecSupportedInMp4(t.audioCodec,"audio")});i.forEach(function(t,e){t.id=e})}if(r.length>0){e=r[0].bitrate;r.sort(function(t,e){return t.bitrate-e.bitrate});this._levels=r;for(var p=0;p<r.length;p++)if(r[p].bitrate===e){this._firstLevel=p;s.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+e);break}this.hls.trigger(a.default.MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:t.stats,audio:f,video:h,altAudio:i.some(function(t){return!!t.url})})}else this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})};Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(t){var e=this._levels;if(e){t=Math.min(t,e.length-1);this.currentLevelIndex===t&&e[t].details||this.setLevelInternal(t)}},enumerable:!0,configurable:!0});e.prototype.setLevelInternal=function(t){var e=this._levels,r=this.hls;if(t>=0&&t<e.length){this.clearTimer();if(this.currentLevelIndex!==t){s.logger.log("switching to level "+t);this.currentLevelIndex=t;var i=e[t];i.level=t;r.trigger(a.default.LEVEL_SWITCHING,i)}var n=e[t],o=n.details;if(!o||o.live){var c=n.urlId;r.trigger(a.default.LEVEL_LOADING,{url:n.url[c],level:t,id:c})}}else r.trigger(a.default.ERROR,{type:l.ErrorTypes.OTHER_ERROR,details:l.ErrorDetails.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})};Object.defineProperty(e.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t;void 0===this._startLevel&&(this._startLevel=t);-1!==t&&(this.level=t)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(t){this._firstLevel=t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"startLevel",{get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t},enumerable:!0,configurable:!0});e.prototype.onError=function(t){if(t.fatal)t.type===l.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var e,r=!1,i=!1;switch(t.details){case l.ErrorDetails.FRAG_LOAD_ERROR:case l.ErrorDetails.FRAG_LOAD_TIMEOUT:case l.ErrorDetails.KEY_LOAD_ERROR:case l.ErrorDetails.KEY_LOAD_TIMEOUT:e=t.frag.level;i=!0;break;case l.ErrorDetails.LEVEL_LOAD_ERROR:case l.ErrorDetails.LEVEL_LOAD_TIMEOUT:e=t.context.level;r=!0;break;case l.ErrorDetails.REMUX_ALLOC_ERROR:e=t.level;r=!0}void 0!==e&&this.recoverLevel(t,e,r,i)}};e.prototype.recoverLevel=function(t,e,r,i){var n,a,o,l=this,c=this.hls.config,u=t.details,d=this._levels[e];d.loadError++;d.fragmentError=i;if(r){if(!(this.levelRetryCount+1<=c.levelLoadingMaxRetry)){s.logger.error("level controller, cannot recover from "+u+" error");this.currentLevelIndex=null;this.clearTimer();t.fatal=!0;return}a=Math.min(Math.pow(2,this.levelRetryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout);this.timer=setTimeout(function(){return l.loadLevel()},a);t.levelRetry=!0;this.levelRetryCount++;s.logger.warn("level controller, "+u+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}if(r||i){n=d.url.length;if(n>1&&d.loadError<n){d.urlId=(d.urlId+1)%n;d.details=void 0;s.logger.warn("level controller, "+u+" for level "+e+": switching to redundant URL-id "+d.urlId)}else if(-1===this.manualLevelIndex){o=0===e?this._levels.length-1:e-1;s.logger.warn("level controller, "+u+": switch to "+o);this.hls.nextAutoLevel=this.currentLevelIndex=o}else if(i){s.logger.warn("level controller, "+u+": reload a fragment");this.currentLevelIndex=null}}};e.prototype.onFragLoaded=function(t){var e=t.frag;if(void 0!==e&&"main"===e.type){var r=this._levels[e.level];if(void 0!==r){r.fragmentError=!1;r.loadError=0;this.levelRetryCount=0}}};e.prototype.onLevelLoaded=function(t){var e=this,r=t.level;if(r===this.currentLevelIndex){var i=this._levels[r];if(!i.fragmentError){i.loadError=0;this.levelRetryCount=0}var n=t.details;if(n.live){var a=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),o=a,l=i.details;if(l&&n.endSN===l.endSN){o/=2;s.logger.log("same live playlist, reload twice faster")}o-=d.now()-t.stats.trequest;o=Math.max(a/2,Math.round(o));s.logger.log("live playlist, reload in "+Math.round(o)+" ms");this.timer=setTimeout(function(){return e.loadLevel()},o)}else this.clearTimer()}};e.prototype.onAudioTrackSwitched=function(t){var e=this.hls.audioTracks[t.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){var i=r.audioGroupIds.findIndex(function(t){return t===e});if(i!==r.urlId){r.urlId=i;this.startLoad()}}};e.prototype.loadLevel=function(){s.logger.debug("call to loadLevel");if(null!==this.currentLevelIndex&&this.canload){var t=this._levels[this.currentLevelIndex];if("object"==typeof t&&t.url.length>0){var e=this.currentLevelIndex,r=t.urlId,i=t.url[r];s.logger.log("Attempt loading level index "+e+" with URL-id "+r);this.hls.trigger(a.default.LEVEL_LOADING,{url:i,level:e,id:r})}}};Object.defineProperty(e.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t;-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)},enumerable:!0,configurable:!0});return e}(o.default)},"./src/controller/level-helper.js":function(t,e,r){"use strict";(function(t){function i(t,e,r){switch(e){case"audio":t.audioGroupIds||(t.audioGroupIds=[]);t.audioGroupIds.push(r);break;case"text":t.textGroupIds||(t.textGroupIds=[]);t.textGroupIds.push(r)}}function n(e,r,i){var n=e[r],a=e[i],o=a.startPTS;if(t.isFinite(o))if(i>r){n.duration=o-n.start;n.duration<0&&s.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")}else{a.duration=n.start-o;a.duration<0&&s.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")}else a.start=i>r?n.start+n.duration:Math.max(n.start-a.duration,0)}function a(e,r,i,a,o,s){var l=i;if(t.isFinite(r.startPTS)){var c=Math.abs(r.startPTS-i);r.deltaPTS=t.isFinite(r.deltaPTS)?Math.max(c,r.deltaPTS):c;l=Math.max(i,r.startPTS);i=Math.min(i,r.startPTS);a=Math.max(a,r.endPTS);o=Math.min(o,r.startDTS);s=Math.max(s,r.endDTS)}var u=i-r.start;r.start=r.startPTS=i;r.maxStartPTS=l;r.endPTS=a;r.startDTS=o;r.endDTS=s;r.duration=a-i;var d=r.sn;if(!e||d<e.startSN||d>e.endSN)return 0;var h,f,p;h=d-e.startSN;f=e.fragments;f[h]=r;for(p=h;p>0;p--)n(f,p,p-1);for(p=h;p<f.length-1;p++)n(f,p,p+1);e.PTSKnown=!0;return u}function o(e,r){var i,n=Math.max(e.startSN,r.startSN)-r.startSN,o=Math.min(e.endSN,r.endSN)-r.startSN,l=r.startSN-e.startSN,c=e.fragments,u=r.fragments,d=0;r.initSegment&&e.initSegment&&(r.initSegment=e.initSegment);if(o<n)r.PTSKnown=!1;else{for(var h=n;h<=o;h++){var f=c[l+h],p=u[h];if(p&&f){d=f.cc-p.cc;if(t.isFinite(f.startPTS)){p.start=p.startPTS=f.startPTS;p.endPTS=f.endPTS;p.duration=f.duration;p.backtracked=f.backtracked;p.dropped=f.dropped;i=p}}}if(d){s.logger.log("discontinuity sliding from playlist, take drift into account");for(h=0;h<u.length;h++)u[h].cc+=d}if(i)a(r,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS);else if(l>=0&&l<c.length){var g=c[l].start;for(h=0;h<u.length;h++)u[h].start+=g}r.PTSKnown=e.PTSKnown}}Object.defineProperty(e,"__esModule",{value:!0});var s=r("./src/utils/logger.js");e.addGroupId=i;e.updatePTS=n;e.updateFragPTSDTS=a;e.mergeDetails=o}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/stream-controller.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/utils/binary-search.js"),a=r("./src/utils/buffer-helper.js"),o=r("./src/demux/demuxer.js"),s=r("./src/events.js"),l=r("./src/controller/fragment-tracker.js"),c=r("./src/loader/fragment.js"),u=r("./src/loader/playlist-loader.js"),d=r("./src/controller/level-helper.js"),h=r("./src/utils/time-ranges.js"),f=r("./src/errors.js"),p=r("./src/utils/logger.js"),g=r("./src/utils/discontinuities.js"),y=r("./src/controller/fragment-finders.js"),v=r("./src/controller/gap-controller.js"),m=r("./src/controller/base-stream-controller.js"),b=function(e){function r(t,r){var i=e.call(this,t,s.default.MEDIA_ATTACHED,s.default.MEDIA_DETACHING,s.default.MANIFEST_LOADING,s.default.MANIFEST_PARSED,s.default.LEVEL_LOADED,s.default.KEY_LOADED,s.default.FRAG_LOADED,s.default.FRAG_LOAD_EMERGENCY_ABORTED,s.default.FRAG_PARSING_INIT_SEGMENT,s.default.FRAG_PARSING_DATA,s.default.FRAG_PARSED,s.default.ERROR,s.default.AUDIO_TRACK_SWITCHING,s.default.AUDIO_TRACK_SWITCHED,s.default.BUFFER_CREATED,s.default.BUFFER_APPENDED,s.default.BUFFER_FLUSHED)||this;i.fragmentTracker=r;i.config=t.config;i.audioCodecSwap=!1;i._state=m.State.STOPPED;i.stallReported=!1;i.gapController=null;return i}i(r,e);r.prototype.onHandlerDestroying=function(){this.stopLoad();e.prototype.onHandlerDestroying.call(this)};r.prototype.onHandlerDestroyed=function(){this.state=m.State.STOPPED;this.fragmentTracker=null;e.prototype.onHandlerDestroyed.call(this)};r.prototype.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,r=this.hls;this.stopLoad();this.setInterval(100);this.level=-1;this.fragLoadError=0;if(!this.startFragRequested){var i=r.startLevel;if(-1===i){i=0;this.bitrateTest=!0}this.level=r.nextLoadLevel=i;this.loadedmetadata=!1}if(e>0&&-1===t){p.logger.log("override startPosition with lastCurrentTime @"+e.toFixed(3));t=e}this.state=m.State.IDLE;this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t;this.tick()}else{this.forceStartLoad=!0;this.state=m.State.STOPPED}};r.prototype.stopLoad=function(){var t=this.fragCurrent;if(t){t.loader&&t.loader.abort();this.fragmentTracker.removeFragment(t);this.fragCurrent=null}this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.clearInterval();this.state=m.State.STOPPED;this.forceStartLoad=!1};r.prototype.doTick=function(){switch(this.state){case m.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case m.State.IDLE:this._doTickIdle();break;case m.State.WAITING_LEVEL:var t=this.levels[this.level];t&&t.details&&(this.state=m.State.IDLE);break;case m.State.FRAG_LOADING_WAITING_RETRY:var e=window.performance.now(),r=this.retryDate;if(!r||e>=r||this.media&&this.media.seeking){p.logger.log("mediaController: retryDate reached, switch back to IDLE state");this.state=m.State.IDLE}}this._checkBuffer();this._checkFragmentChanged()};r.prototype._doTickIdle=function(){var t=this.hls,e=t.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&e.startFragPrefetch)){var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var n=t.nextLoadLevel,o=this.levels[n];if(o){var l,c=o.bitrate;l=c?Math.max(8*e.maxBufferSize/c,e.maxBufferLength):e.maxBufferLength;l=Math.min(l,e.maxMaxBufferLength);var u=a.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,e.maxBufferHole),d=u.len;if(!(d>=l)){p.logger.trace("buffer length of "+d.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ...");this.level=t.nextLoadLevel=n;var h=o.details;if(!h||h.live&&this.levelLastLoaded!==n)this.state=m.State.WAITING_LEVEL;else if(this._streamEnded(u,h)){var f={};this.altAudio&&(f.type="video");this.hls.trigger(s.default.BUFFER_EOS,f);this.state=m.State.ENDED}else this._fetchPayloadOrEos(i,u,h)}}}};r.prototype._fetchPayloadOrEos=function(t,e,r){var i=this.fragPrevious,n=this.level,a=r.fragments,o=a.length;if(0!==o){var s,l=a[0].start,c=a[o-1].start+a[o-1].duration,u=e.end;if(r.initSegment&&!r.initSegment.data)s=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(o<d){p.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d);return}s=this._ensureFragmentAtLivePoint(r,u,l,c,i,a,o);if(null===s)return}else u<l&&(s=a[0]);s||(s=this._findFragment(l,i,o,a,u,c,r));if(s)if(s.encrypted){p.logger.log("Loading key for "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n);this._loadKey(s)}else{p.logger.log("Loading "+s.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+n+", currentTime:"+t.toFixed(3)+",bufferEnd:"+u.toFixed(3));this._loadFragment(s)}}};r.prototype._ensureFragmentAtLivePoint=function(t,e,r,i,a,o,s){var l,c=this.hls.config,u=this.media,d=void 0!==c.liveMaxLatencyDuration?c.liveMaxLatencyDuration:c.liveMaxLatencyDurationCount*t.targetduration;if(e<Math.max(r-c.maxFragLookUpTolerance,i-d)){var h=this.liveSyncPosition=this.computeLivePosition(r,t);p.logger.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3));e=h;u&&u.readyState&&u.duration>h&&(u.currentTime=h);this.nextLoadPosition=h}if(t.PTSKnown&&e>i&&u&&u.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(a)if(t.hasProgramDateTime){p.logger.log("live playlist, switching playlist, load frag with same PDT: "+a.programDateTime);l=y.findFragmentByPDT(o,a.endProgramDateTime,c.maxFragLookUpTolerance)}else{var f=a.sn+1;if(f>=t.startSN&&f<=t.endSN){var g=o[f-t.startSN];if(a.cc===g.cc){l=g;p.logger.log("live playlist, switching playlist, load frag with next SN: "+l.sn)}}if(!l){l=n.default.search(o,function(t){return a.cc-t.cc});l&&p.logger.log("live playlist, switching playlist, load frag with same CC: "+l.sn)}}if(!l){l=o[Math.min(s-1,Math.round(s/2))];p.logger.log("live playlist, switching playlist, unknown, load middle frag : "+l.sn)}}return l};r.prototype._findFragment=function(t,e,r,i,n,a,o){var s,l=this.hls.config;if(n<a){s=y.findFragmentByPTS(e,i,n,n>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance)}else s=i[r-1];if(s){var c=s.sn-o.startSN,u=e&&s.level===e.level,d=i[c-1],h=i[c+1];if(e&&s.sn===e.sn)if(u&&!s.backtracked)if(s.sn<o.endSN){var f=e.deltaPTS;if(f&&f>l.maxBufferHole&&e.dropped&&c){s=d;p.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")}else{s=h;p.logger.log("SN just loaded, load next one: "+s.sn,s)}}else s=null;else if(s.backtracked)if(h&&h.backtracked){p.logger.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+h.sn);s=h}else{p.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe");s.dropped=0;if(d){s=d;s.backtracked=!0}else c&&(s=null)}}return s};r.prototype._loadKey=function(t){this.state=m.State.KEY_LOADING;this.hls.trigger(s.default.KEY_LOADING,{frag:t})};r.prototype._loadFragment=function(e){var r=this.fragmentTracker.getState(e);this.fragCurrent=e;this.startFragRequested=!0;t.isFinite(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration);if(e.backtracked||r===l.FragmentState.NOT_LOADED||r===l.FragmentState.PARTIAL){e.autoLevel=this.hls.autoLevelEnabled;e.bitrateTest=this.bitrateTest;this.hls.trigger(s.default.FRAG_LOADING,{frag:e});this.demuxer||(this.demuxer=new o.default(this.hls,"main"));this.state=m.State.FRAG_LOADING}else r===l.FragmentState.APPENDING&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)};Object.defineProperty(r.prototype,"state",{get:function(){return this._state},set:function(t){if(this.state!==t){var e=this.state;this._state=t;p.logger.log("main stream:"+e+"->"+t);this.hls.trigger(s.default.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},enumerable:!0,configurable:!0});r.prototype.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,u.default.LevelType.MAIN)};Object.defineProperty(r.prototype,"currentLevel",{get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"nextBufferedFrag",{get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null},enumerable:!0,configurable:!0});r.prototype.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null};Object.defineProperty(r.prototype,"nextLevel",{get:function(){var t=this.nextBufferedFrag;return t?t.level:-1},enumerable:!0,configurable:!0});r.prototype._checkFragmentChanged=function(){var t,e,r=this.media;if(r&&r.readyState&&!1===r.seeking){e=r.currentTime;e>this.lastCurrentTime&&(this.lastCurrentTime=e);a.BufferHelper.isBuffered(r,e)?t=this.getBufferedFrag(e):a.BufferHelper.isBuffered(r,e+.1)&&(t=this.getBufferedFrag(e+.1));if(t){var i=t;if(i!==this.fragPlaying){this.hls.trigger(s.default.FRAG_CHANGED,{frag:i});var n=i.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(s.default.LEVEL_SWITCHED,{level:n});this.fragPlaying=i}}}};r.prototype.immediateLevelSwitch=function(){p.logger.log("immediateLevelSwitch");if(!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,r=void 0;if(e){r=e.paused;e.pause()}else r=!0;this.previouslyPaused=r}var i=this.fragCurrent;i&&i.loader&&i.loader.abort();this.fragCurrent=null;this.flushMainBuffer(0,t.POSITIVE_INFINITY)};r.prototype.immediateLevelSwitchEnd=function(){var t=this.media;if(t&&t.buffered.length){this.immediateSwitch=!1;a.BufferHelper.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4);this.previouslyPaused||t.play()}};r.prototype.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var r=void 0,i=void 0,n=void 0;i=this.getBufferedFrag(e.currentTime);i&&i.startPTS>1&&this.flushMainBuffer(0,i.startPTS-1);if(e.paused)r=0;else{var a=this.hls.nextLoadLevel,o=this.levels[a],s=this.fragLastKbps;r=s&&this.fragCurrent?this.fragCurrent.duration*o.bitrate/(1e3*s)+1:0}n=this.getBufferedFrag(e.currentTime+r);if(n){n=this.followingBufferedFrag(n);if(n){var l=this.fragCurrent;l&&l.loader&&l.loader.abort();this.fragCurrent=null;this.flushMainBuffer(n.maxStartPTS,t.POSITIVE_INFINITY)}}}};r.prototype.flushMainBuffer=function(t,e){this.state=m.State.BUFFER_FLUSHING;var r={startOffset:t,endOffset:e};this.altAudio&&(r.type="video");this.hls.trigger(s.default.BUFFER_FLUSHING,r)};r.prototype.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);e.addEventListener("seeking",this.onvseeking);e.addEventListener("seeked",this.onvseeked);e.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition);this.gapController=new v.default(r,e,this.fragmentTracker,this.hls)};r.prototype.onMediaDetaching=function(){var t=this.media;if(t&&t.ended){p.logger.log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}var e=this.levels;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.backtracked=void 0})});if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("seeked",this.onvseeked);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.stopLoad()};r.prototype.onMediaSeeked=function(){var e=this.media,r=e?e.currentTime:void 0;t.isFinite(r)&&p.logger.log("media seeked to "+r.toFixed(3));this.tick()};r.prototype.onManifestLoading=function(){p.logger.log("trigger BUFFER_RESET");this.hls.trigger(s.default.BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=!1;this.startPosition=this.lastCurrentTime=0};r.prototype.onManifestParsed=function(t){var e,r=!1,i=!1;t.levels.forEach(function(t){e=t.audioCodec;if(e){-1!==e.indexOf("mp4a.40.2")&&(r=!0);-1!==e.indexOf("mp4a.40.5")&&(i=!0)}});this.audioCodecSwitch=r&&i;this.audioCodecSwitch&&p.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.levels=t.levels;this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)};r.prototype.onLevelLoaded=function(e){var r=e.details,i=e.level,n=this.levels[this.levelLastLoaded],a=this.levels[i],o=r.totalduration,l=0;p.logger.log("level "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+o);if(r.live){var c=a.details;if(c&&r.fragments.length>0){d.mergeDetails(c,r);l=r.fragments[0].start;this.liveSyncPosition=this.computeLivePosition(l,c);if(r.PTSKnown&&t.isFinite(l))p.logger.log("live playlist sliding:"+l.toFixed(3));else{p.logger.log("live playlist - outdated PTS, unknown sliding");g.alignStream(this.fragPrevious,n,r)}}else{p.logger.log("live playlist - first load, unknown sliding");r.PTSKnown=!1;g.alignStream(this.fragPrevious,n,r)}}else r.PTSKnown=!1;a.details=r;this.levelLastLoaded=i;this.hls.trigger(s.default.LEVEL_UPDATED,{details:r,level:i});if(!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var u=r.startTimeOffset;if(t.isFinite(u)){if(u<0){p.logger.log("negative start time offset "+u+", count from end of last fragment");u=l+o+u}p.logger.log("start time offset found in playlist, adjust startPosition to "+u);this.startPosition=u}else if(r.live){this.startPosition=this.computeLivePosition(l,r);p.logger.log("configure startPosition to "+this.startPosition)}else this.startPosition=0;this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===m.State.WAITING_LEVEL&&(this.state=m.State.IDLE);this.tick()};r.prototype.onKeyLoaded=function(){if(this.state===m.State.KEY_LOADING){this.state=m.State.IDLE;this.tick()}};r.prototype.onFragLoaded=function(t){var e=this,r=e.fragCurrent,i=e.hls,n=e.levels,a=e.media,l=t.frag;if(this.state===m.State.FRAG_LOADING&&r&&"main"===l.type&&l.level===r.level&&l.sn===r.sn){var c=t.stats,u=n[r.level],d=u.details;this.bitrateTest=!1;this.stats=c;p.logger.log("Loaded "+r.sn+" of ["+d.startSN+" ,"+d.endSN+"],level "+r.level);if(l.bitrateTest&&i.nextLoadLevel){this.state=m.State.IDLE;this.startFragRequested=!1;c.tparsed=c.tbuffered=window.performance.now();i.trigger(s.default.FRAG_BUFFERED,{stats:c,frag:r,id:"main"});this.tick()}else if("initSegment"===l.sn){this.state=m.State.IDLE;c.tparsed=c.tbuffered=window.performance.now();d.initSegment.data=t.payload;i.trigger(s.default.FRAG_BUFFERED,{stats:c,frag:r,id:"main"});this.tick()}else{p.logger.log("Parsing "+r.sn+" of ["+d.startSN+" ,"+d.endSN+"],level "+r.level+", cc "+r.cc);this.state=m.State.PARSING;this.pendingBuffering=!0;this.appended=!1;if(l.bitrateTest){l.bitrateTest=!1;this.fragmentTracker.onFragLoaded({frag:l})}var h=!(a&&a.seeking)&&(d.PTSKnown||!d.live),f=d.initSegment?d.initSegment.data:[],g=this._getAudioCodec(u),y=this.demuxer=this.demuxer||new o.default(this.hls,"main");y.push(t.payload,f,g,u.videoCodec,r,d.totalduration,h)}}this.fragLoadError=0};r.prototype.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===m.State.PARSING){var i=t.tracks,n=void 0,a=void 0;i.audio&&this.altAudio&&delete i.audio;a=i.audio;if(a){var o=this.levels[this.level].audioCodec,l=navigator.userAgent.toLowerCase();if(o&&this.audioCodecSwap){p.logger.log("swapping playlist audio codec");o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"}this.audioCodecSwitch&&1!==a.metadata.channelCount&&-1===l.indexOf("firefox")&&(o="mp4a.40.5");if(-1!==l.indexOf("android")&&"audio/mpeg"!==a.container){o="mp4a.40.2";p.logger.log("Android: force audio codec to "+o)}a.levelCodec=o;a.id=t.id}a=i.video;if(a){a.levelCodec=this.levels[this.level].videoCodec;a.id=t.id}this.hls.trigger(s.default.BUFFER_CODECS,i);for(n in i){a=i[n];p.logger.log("main track:"+n+",container:"+a.container+",codecs[level/parsed]=["+a.levelCodec+"/"+a.codec+"]");var c=a.initSegment;if(c){this.appended=!0;this.pendingBuffering=!0;this.hls.trigger(s.default.BUFFER_APPENDING,{type:n,data:c,parent:"main",content:"initSegment"})}}this.tick()}};r.prototype.onFragParsingData=function(e){var r=this,i=this.fragCurrent,n=e.frag;if(i&&"main"===e.id&&n.sn===i.sn&&n.level===i.level&&("audio"!==e.type||!this.altAudio)&&this.state===m.State.PARSING){var a=this.levels[this.level],o=i;if(!t.isFinite(e.endPTS)){e.endPTS=e.startPTS+i.duration;e.endDTS=e.startDTS+i.duration}!0===e.hasAudio&&o.addElementaryStream(c.default.ElementaryStreamTypes.AUDIO);!0===e.hasVideo&&o.addElementaryStream(c.default.ElementaryStreamTypes.VIDEO);p.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0));if("video"===e.type){o.dropped=e.dropped;if(o.dropped)if(o.backtracked)p.logger.warn("Already backtracked on this fragment, appending with the gap",o.sn);else{var l=a.details;if(!l||o.sn!==l.startSN){p.logger.warn("missing video frame(s), backtracking fragment",o.sn);this.fragmentTracker.removeFragment(o);o.backtracked=!0;this.nextLoadPosition=e.startPTS;this.state=m.State.IDLE;this.fragPrevious=o;this.tick();return}p.logger.warn("missing video frame(s) on first frag, appending with gap",o.sn)}else o.backtracked=!1}var u=d.updateFragPTSDTS(a.details,o,e.startPTS,e.endPTS,e.startDTS,e.endDTS),h=this.hls;h.trigger(s.default.LEVEL_PTS_UPDATED,{details:a.details,level:this.level,drift:u,type:e.type,start:e.startPTS,end:e.endPTS});[e.data1,e.data2].forEach(function(t){if(t&&t.length&&r.state===m.State.PARSING){r.appended=!0;r.pendingBuffering=!0;h.trigger(s.default.BUFFER_APPENDING,{type:e.type,data:t,parent:"main",content:"data"})}});this.tick()}};r.prototype.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===m.State.PARSING){this.stats.tparsed=window.performance.now();this.state=m.State.PARSED;this._checkAppendedParsed()}};r.prototype.onAudioTrackSwitching=function(e){var r=!!e.url,i=e.id;if(!r){if(this.mediaBuffer!==this.media){p.logger.log("switching on main audio, use media.buffered to schedule main fragment loading");this.mediaBuffer=this.media;var n=this.fragCurrent;if(n.loader){p.logger.log("switching to main audio track, cancel main fragment load");n.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.state=m.State.IDLE}var a=this.hls;a.trigger(s.default.BUFFER_FLUSHING,{startOffset:0,endOffset:t.POSITIVE_INFINITY,type:"audio"});a.trigger(s.default.AUDIO_TRACK_SWITCHED,{id:i});this.altAudio=!1}};r.prototype.onAudioTrackSwitched=function(t){var e=t.id,r=!!this.hls.audioTracks[e].url;if(r){var i=this.videoBuffer;if(i&&this.mediaBuffer!==i){p.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading");this.mediaBuffer=i}}this.altAudio=r;this.tick()};r.prototype.onBufferCreated=function(t){var e,r,i=t.tracks,n=!1;for(var a in i){var o=i[a];if("main"===o.id){r=a;e=o;"video"===a&&(this.videoBuffer=i[a].buffer)}else n=!0}if(n&&e){p.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading");this.mediaBuffer=e.buffer}else this.mediaBuffer=this.media};r.prototype.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;if(e===m.State.PARSING||e===m.State.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};r.prototype._checkAppendedParsed=function(){if(!(this.state!==m.State.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;if(t){p.logger.log("main buffered : "+h.default.toString((this.mediaBuffer?this.mediaBuffer:this.media).buffered));this.fragPrevious=t;var e=this.stats;e.tbuffered=window.performance.now();this.fragLastKbps=Math.round(8*e.total/(e.tbuffered-e.tfirst));this.hls.trigger(s.default.FRAG_BUFFERED,{stats:e,frag:t,id:"main"});this.state=m.State.IDLE}this.tick()}};r.prototype.onError=function(e){var r=e.frag||this.fragCurrent;if(!r||"main"===r.type){var i=!!this.media&&a.BufferHelper.isBuffered(this.media,this.media.currentTime)&&a.BufferHelper.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:case f.ErrorDetails.KEY_LOAD_ERROR:case f.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);p.logger.warn("mediaController: frag loading failed, retry in "+n+" ms");this.retryDate=window.performance.now()+n;if(!this.loadedmetadata){this.startFragRequested=!1;this.nextLoadPosition=this.startPosition}this.fragLoadError++;this.state=m.State.FRAG_LOADING_WAITING_RETRY}else{p.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ...");e.fatal=!0;this.state=m.State.ERROR}break;case f.ErrorDetails.LEVEL_LOAD_ERROR:case f.ErrorDetails.LEVEL_LOAD_TIMEOUT:if(this.state!==m.State.ERROR)if(e.fatal){this.state=m.State.ERROR;p.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")}else e.levelRetry||this.state!==m.State.WAITING_LEVEL||(this.state=m.State.IDLE);break;case f.ErrorDetails.BUFFER_FULL_ERROR:if("main"===e.parent&&(this.state===m.State.PARSING||this.state===m.State.PARSED))if(i){this._reduceMaxBufferLength(this.config.maxBufferLength);this.state=m.State.IDLE}else{p.logger.warn("buffer full error also media.currentTime is not buffered, flush everything");this.fragCurrent=null;this.flushMainBuffer(0,t.POSITIVE_INFINITY)}}}};r.prototype._reduceMaxBufferLength=function(t){var e=this.config;if(e.maxMaxBufferLength>=t){e.maxMaxBufferLength/=2;p.logger.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s");return!0}return!1};r.prototype._checkBuffer=function(){var t=this.media;if(t&&0!==t.readyState){var e=this.mediaBuffer?this.mediaBuffer:t,r=e.buffered;if(!this.loadedmetadata&&r.length){this.loadedmetadata=!0;this._seekToStartPos()}else this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,r)}};r.prototype.onFragLoadEmergencyAborted=function(){this.state=m.State.IDLE;if(!this.loadedmetadata){this.startFragRequested=!1;this.nextLoadPosition=this.startPosition}this.tick()};r.prototype.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;t&&this.fragmentTracker.detectEvictedFragments(c.default.ElementaryStreamTypes.VIDEO,t.buffered);this.state=m.State.IDLE;this.fragPrevious=null};r.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap};r.prototype.computeLivePosition=function(t,e){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration;return t+Math.max(0,e.totalduration-r)};r.prototype._seekToStartPos=function(){var t=this.media,e=t.currentTime,r=t.seeking?e:this.startPosition;if(e!==r){p.logger.log("target start position not buffered, seek to buffered.start(0) "+r+" from current time "+e+" ");t.currentTime=r}};r.prototype._getAudioCodec=function(t){var e=this.config.defaultAudioCodec||t.audioCodec;if(this.audioCodecSwap){p.logger.log("swapping playlist audio codec");e&&(e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")}return e};Object.defineProperty(r.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t},enumerable:!0,configurable:!0});return r}(m.default);e.default=b}).call(this,r("./src/polyfills/number.js").Number)},"./src/controller/subtitle-stream-controller.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/utils/logger.js"),o=r("./src/crypt/decrypter.js"),s=r("./src/task-loop.js"),l=r("./src/utils/buffer-helper.js"),c=r("./src/controller/fragment-finders.js"),u=r("./src/controller/fragment-tracker.js"),d=window.performance;e.SubtitleStreamControllerState={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"};var h=e.SubtitleStreamControllerState;e.SubtitleStreamController=function(t){function e(e,r){var i=t.call(this,e,n.default.MEDIA_ATTACHED,n.default.MEDIA_DETACHING,n.default.ERROR,n.default.KEY_LOADED,n.default.FRAG_LOADED,n.default.SUBTITLE_TRACKS_UPDATED,n.default.SUBTITLE_TRACK_SWITCH,n.default.SUBTITLE_TRACK_LOADED,n.default.SUBTITLE_FRAG_PROCESSED)||this;i.fragmentTracker=r;i.config=e.config;i.state=h.STOPPED;i.tracks=[];i.tracksBuffered=[];i.currentTrackId=-1;i.decrypter=new o.default(e,e.config);return i}i(e,t);e.prototype.onHandlerDestroyed=function(){this.fragmentTracker=null;this.state=h.STOPPED;t.prototype.onHandlerDestroyed.call(this)};e.prototype.onSubtitleFragProcessed=function(t){this.state=h.IDLE;if(t.success){var e=this.tracksBuffered[this.currentTrackId],r=t.frag;this.fragPrevious=r;if(e){for(var i,n=0;n<e.length;n++)if(r.start>=e[n].start&&r.start<=e[n].end){i=e[n];break}i?i.end=r.start+r.duration:e.push({start:r.start,end:r.start+r.duration})}}};e.prototype.onMediaAttached=function(t){this.media=t.media;this.state=h.IDLE};e.prototype.onMediaDetaching=function(){this.media=null;this.state=h.STOPPED};e.prototype.onError=function(t){var e=t.frag;e&&"subtitle"===e.type&&(this.state=h.IDLE)};e.prototype.onSubtitleTracksUpdated=function(t){var e=this;a.logger.log("subtitle tracks updated");this.tracksBuffered=[];this.tracks=t.subtitleTracks;this.tracks.forEach(function(t){e.tracksBuffered[t.id]=[]})};e.prototype.onSubtitleTrackSwitch=function(t){this.currentTrackId=t.id;if(this.tracks&&-1!==this.currentTrackId){var e=this.tracks[this.currentTrackId];e&&e.details&&this.setInterval(500)}else this.clearInterval()};e.prototype.onSubtitleTrackLoaded=function(t){var e=t.id,r=t.details;if(this.tracks){if(this.tracks[e]){a.logger.log("Updating subtitle track details");this.tracks[e].details=r}this.setInterval(500)}else a.logger.warn("Can not update subtitle details, no tracks found")};e.prototype.onKeyLoaded=function(){this.state===h.KEY_LOADING&&(this.state=h.IDLE)};e.prototype.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag.decryptdata,i=t.frag,a=this.hls;if(this.state===h.FRAG_LOADING&&e&&"subtitle"===t.frag.type&&e.sn===t.frag.sn&&t.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var o=d.now();this.decrypter.decrypt(t.payload,r.key.buffer,r.iv.buffer,function(t){var e=d.now();a.trigger(n.default.FRAG_DECRYPTED,{frag:i,payload:t,stats:{tstart:o,tdecrypt:e}})})}};e.prototype.doTick=function(){if(this.media)switch(this.state){case h.IDLE:var t=this.tracks,e=this.currentTrackId;if(!t||!t[e]||!t[e].details)break;var r=t[e].details,i=this.config,o=i.maxBufferHole,s=Math.min(i.maxBufferLength,i.maxMaxBufferLength),d=i.maxFragLookUpTolerance,f=l.BufferHelper.bufferedInfo(this._getBuffered(),this.media.currentTime,o),p=f.end,g=f.len,y=r.fragments,v=y.length,m=y[v-1].start+y[v-1].duration,b=void 0;g<s&&p<m?b=c.findFragmentByPTS(this.fragPrevious,y,p,d):r.hasProgramDateTime&&this.fragPrevious&&(b=c.findFragmentByPDT(y,this.fragPrevious.endProgramDateTime,d));if(b&&b.encrypted){a.logger.log("Loading key for "+b.sn);this.state=h.KEY_LOADING;this.hls.trigger(n.default.KEY_LOADING,{frag:b})}else if(b&&this.fragmentTracker.getState(b)===u.FragmentState.NOT_LOADED){b.trackId=e;this.fragCurrent=b;this.state=h.FRAG_LOADING;this.hls.trigger(n.default.FRAG_LOADING,{frag:b})}}else this.state=h.IDLE};e.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]};return e}(s.default)},"./src/controller/subtitle-track-controller.js":function(t,e,r){"use strict";function i(t){for(var e=[],r=0;r<t.length;r++)"subtitles"===t[r].kind&&e.push(t[r]);return e}var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a=r("./src/events.js"),o=r("./src/event-handler.js"),s=r("./src/utils/logger.js");e.default=function(t){function e(e){var r=t.call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.MANIFEST_LOADING,a.default.MANIFEST_LOADED,a.default.SUBTITLE_TRACK_LOADED)||this;r.tracks=[];r.trackId=-1;r.media=null;r.subtitleDisplay=!0;return r}n(e,t);e.prototype._onTextTracksChanged=function(){if(this.media){for(var t=-1,e=i(this.media.textTracks),r=0;r<e.length;r++)if("hidden"===e[r].mode)t=r;else if("showing"===e[r].mode){t=r;break}this.subtitleTrack=t}};e.prototype.destroy=function(){o.default.prototype.destroy.call(this)};e.prototype.onMediaAttached=function(t){var e=this;this.media=t.media;if(this.media){if(this.queuedDefaultTrack){this.subtitleTrack=this.queuedDefaultTrack;delete this.queuedDefaultTrack}this.trackChangeListener=this._onTextTracksChanged.bind(this);this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks);this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){e.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener)}};e.prototype.onMediaDetaching=function(){if(this.media){this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener);this.media=null}};e.prototype.onManifestLoading=function(){this.tracks=[];this.trackId=-1};e.prototype.onManifestLoaded=function(t){var e=this,r=t.subtitles||[];this.tracks=r;this.trackId=-1;this.hls.trigger(a.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r});r.forEach(function(t){t.default&&(e.media?e.subtitleTrack=t.id:e.queuedDefaultTrack=t.id)})};e.prototype.onTick=function(){var t=this.trackId,e=this.tracks[t];if(e){var r=e.details;if(!r||r.live){s.logger.log("(re)loading playlist for subtitle track "+t);this.hls.trigger(a.default.SUBTITLE_TRACK_LOADING,{url:e.url,id:t})}}};e.prototype.onSubtitleTrackLoaded=function(t){var e=this;if(t.id<this.tracks.length){s.logger.log("subtitle track "+t.id+" loaded");this.tracks[t.id].details=t.details;t.details.live&&!this.timer&&(this.timer=setInterval(function(){e.onTick()},1e3*t.details.targetduration,this));!t.details.live&&this.timer&&this._stopTimer()}};Object.defineProperty(e.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(t){if(this.trackId!==t){this._toggleTrackModes(t);this.setSubtitleTrackInternal(t)}},enumerable:!0,configurable:!0});e.prototype.setSubtitleTrackInternal=function(t){var e=this,r=e.hls,i=e.tracks;if(!("number"!=typeof t||t<-1||t>=i.length)){this._stopTimer();this.trackId=t;s.logger.log("switching to subtitle track "+t);r.trigger(a.default.SUBTITLE_TRACK_SWITCH,{id:t});if(-1!==t){var n=i[t],o=n.details;if(!o||o.live){s.logger.log("(re)loading playlist for subtitle track "+t);r.trigger(a.default.SUBTITLE_TRACK_LOADING,{url:n.url,id:t})}}}};e.prototype._stopTimer=function(){if(this.timer){clearInterval(this.timer);this.timer=null}};e.prototype._toggleTrackModes=function(t){var e=this,r=e.media,n=e.subtitleDisplay,a=e.trackId;if(r){var o=i(r.textTracks);if(-1===t)[].slice.call(o).forEach(function(t){t.mode="disabled"});else{var s=o[a];s&&(s.mode="disabled")}var l=o[t];l&&(l.mode=n?"showing":"hidden")}};return e}(o.default)},"./src/controller/timeline-controller.js":function(t,e,r){"use strict";(function(t){function i(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}function n(t,e,r,i){return Math.min(e,i)-Math.max(t,r)}var a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r("./src/events.js"),s=r("./src/event-handler.js"),l=r("./src/utils/cea-608-parser.js"),c=r("./src/utils/output-filter.js"),u=r("./src/utils/webvtt-parser.js"),d=r("./src/utils/logger.js"),h=r("./src/utils/texttrack-utils.js"),f=function(e){function r(t){var r=e.call(this,t,o.default.MEDIA_ATTACHING,o.default.MEDIA_DETACHING,o.default.FRAG_PARSING_USERDATA,o.default.FRAG_DECRYPTED,o.default.MANIFEST_LOADING,o.default.MANIFEST_LOADED,o.default.FRAG_LOADED,o.default.LEVEL_SWITCHING,o.default.INIT_PTS_FOUND)||this;r.hls=t;r.config=t.config;r.enabled=!0;r.Cues=t.config.cueHandler;r.textTracks=[];r.tracks=[];r.unparsedVttFrags=[];r.initPTS=[];r.cueRanges=[];r.captionsTracks={};r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode}};if(r.config.enableCEA708Captions){var i=new c.default(r,"textTrack1"),n=new c.default(r,"textTrack2");r.cea608Parser=new l.default(0,i,n)}return r}a(r,e);r.prototype.addCues=function(t,e,r,i){for(var a=this.cueRanges,o=!1,s=a.length;s--;){var l=a[s],c=n(l[0],l[1],e,r);if(c>=0){l[0]=Math.min(l[0],e);l[1]=Math.max(l[1],r);o=!0;if(c/(r-e)>.5)return}}o||a.push([e,r]);this.Cues.newCue(this.captionsTracks[t],e,r,i)};r.prototype.onInitPtsFound=function(t){var e=this;"main"===t.id&&(this.initPTS[t.frag.cc]=t.initPTS);if(this.unparsedVttFrags.length){var r=this.unparsedVttFrags;this.unparsedVttFrags=[];r.forEach(function(t){e.onFragLoaded(t)})}};r.prototype.getExistingTrack=function(t){var e=this.media;if(e)for(var r=0;r<e.textTracks.length;r++){var i=e.textTracks[r];if(i[t])return i}return null};r.prototype.createCaptionsTrack=function(t){var e=this.captionsProperties[t],r=e.label,i=e.languageCode,n=this.captionsTracks;if(!n[t]){var a=this.getExistingTrack(t);if(a){n[t]=a;h.clearCurrentCues(n[t]);h.sendAddTrackEvent(n[t],this.media)}else{var o=this.createTextTrack("captions",r,i);if(o){o[t]=!0;n[t]=o}}}};r.prototype.createTextTrack=function(t,e,r){var i=this.media;if(i)return i.addTextTrack(t,e,r)};r.prototype.destroy=function(){s.default.prototype.destroy.call(this)};r.prototype.onMediaAttaching=function(t){this.media=t.media;this._cleanTracks()};r.prototype.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){h.clearCurrentCues(t[e]);delete t[e]})};r.prototype.onManifestLoading=function(){this.lastSn=-1;this.prevCC=-1;this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}};this._cleanTracks()};r.prototype._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var r=0;r<e.length;r++)h.clearCurrentCues(e[r])}};r.prototype.onManifestLoaded=function(t){var e=this;this.textTracks=[];this.unparsedVttFrags=this.unparsedVttFrags||[];this.initPTS=[];this.cueRanges=[];if(this.config.enableWebVTT){this.tracks=t.subtitles||[];var r=this.media?this.media.textTracks:[];this.tracks.forEach(function(t,n){var a;if(n<r.length){var o=[].slice.call(r).find(function(e){return i(e,t)});o&&(a=o)}a||(a=e.createTextTrack("subtitles",t.name,t.lang));a.mode=t.default?e.hls.subtitleDisplay?"showing":"hidden":"disabled";e.textTracks.push(a)})}};r.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions};r.prototype.onFragLoaded=function(e){var r=e.frag,i=e.payload;if("main"===r.type){var n=r.sn;if(n!==this.lastSn+1){var a=this.cea608Parser;a&&a.reset()}this.lastSn=n}else if("subtitle"===r.type)if(i.byteLength){if(!t.isFinite(this.initPTS[r.cc])){this.unparsedVttFrags.push(e);this.initPTS.length&&this.hls.trigger(o.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r});return}var s=r.decryptdata;null!=s&&null!=s.key&&"AES-128"===s.method||this._parseVTTs(r,i)}else this.hls.trigger(o.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r})};r.prototype._parseVTTs=function(t,e){var r=this.vttCCs;if(!r[t.cc]){r[t.cc]={start:t.start,prevCC:this.prevCC,new:!0};this.prevCC=t.cc}var i=this.textTracks,n=this.hls;u.default.parse(e,this.initPTS[t.cc],r,t.cc,function(e){var r=i[t.trackId];if("disabled"!==r.mode){e.forEach(function(t){if(!r.cues.getCueById(t.id))try{r.addCue(t)}catch(i){var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id;r.addCue(e)}});n.trigger(o.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})}else n.trigger(o.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},function(e){d.logger.log("Failed to parse VTT cue: "+e);n.trigger(o.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})};r.prototype.onFragDecrypted=function(e){var r=e.payload,i=e.frag;if("subtitle"===i.type){if(!t.isFinite(this.initPTS[i.cc])){this.unparsedVttFrags.push(e);return}this._parseVTTs(i,r)}};r.prototype.onFragParsingUserdata=function(t){if(this.enabled&&this.config.enableCEA708Captions)for(var e=0;e<t.samples.length;e++){var r=this.extractCea608Data(t.samples[e].bytes);this.cea608Parser.addData(t.samples[e].pts,r)}};r.prototype.extractCea608Data=function(t){for(var e,r,i,n,a,o=31&t[0],s=2,l=[],c=0;c<o;c++){e=t[s++];r=127&t[s++];i=127&t[s++];n=0!=(4&e);a=3&e;if((0!==r||0!==i)&&(n&&0===a)){l.push(r);l.push(i)}}return l};return r}(s.default);e.default=f}).call(this,r("./src/polyfills/number.js").Number)},"./src/crypt/aes-crypto.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){function t(t,e){this.subtle=t;this.aesIV=e}t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)};return t}()},"./src/crypt/aes-decryptor.js":function(t,e,r){"use strict";function i(t){var e=t.byteLength,r=e&&new DataView(t).getUint8(e-1);return r?t.slice(0,e-r):t}Object.defineProperty(e,"__esModule",{value:!0});e.removePadding=i;e.default=function(){function t(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}t.prototype.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),r=new Uint32Array(4),i=0;i<4;i++)r[i]=e.getUint32(4*i);return r};t.prototype.initTable=function(){var t=this.sBox,e=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],c=s[1],u=s[2],d=s[3],h=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)h[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var y=p^p<<1^p<<2^p<<3^p<<4;y=y>>>8^255&y^99;t[f]=y;e[y]=f;var v=h[f],m=h[v],b=h[m],E=257*h[y]^16843008*y;i[f]=E<<24|E>>>8;n[f]=E<<16|E>>>16;a[f]=E<<8|E>>>24;o[f]=E;E=16843009*b^65537*m^257*v^16843008*f;l[y]=E<<24|E>>>8;c[y]=E<<16|E>>>16;u[y]=E<<8|E>>>24;d[y]=E;if(f){f=v^h[h[h[b^v]]];p^=h[h[p]]}else f=p=1}};t.prototype.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),r=!0,i=0;i<e.length&&r;){r=e[i]===this.key[i];i++}if(!r){this.key=e;var n=this.keySize=e.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a,o,s,l,c=this.ksRows=4*(n+6+1),u=this.keySchedule=new Uint32Array(c),d=this.invKeySchedule=new Uint32Array(c),h=this.sBox,f=this.rcon,p=this.invSubMix,g=p[0],y=p[1],v=p[2],m=p[3];for(a=0;a<c;a++)if(a<n)s=u[a]=e[a];else{l=s;if(a%n==0){l=l<<8|l>>>24;l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l];l^=f[a/n|0]<<24}else n>6&&a%n==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]);u[a]=s=(u[a-n]^l)>>>0}for(o=0;o<c;o++){a=c-o;l=3&o?u[a]:u[a-4];d[o]=o<4||a<=4?l:g[h[l>>>24]]^y[h[l>>>16&255]]^v[h[l>>>8&255]]^m[h[255&l]];d[o]=d[o]>>>0}}};t.prototype.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24};t.prototype.decrypt=function(t,e,r,n){for(var a,o,s,l,c,u,d,h,f,p,g,y,v,m,b=this.keySize+6,E=this.invKeySchedule,_=this.invSBox,S=this.invSubMix,T=S[0],w=S[1],O=S[2],A=S[3],C=this.uint8ArrayToUint32Array_(r),R=C[0],L=C[1],k=C[2],D=C[3],x=new Int32Array(t),P=new Int32Array(x.length),I=this.networkToHostOrderSwap;e<x.length;){f=I(x[e]);p=I(x[e+1]);g=I(x[e+2]);y=I(x[e+3]);c=f^E[0];u=y^E[1];d=g^E[2];h=p^E[3];v=4;for(m=1;m<b;m++){a=T[c>>>24]^w[u>>16&255]^O[d>>8&255]^A[255&h]^E[v];o=T[u>>>24]^w[d>>16&255]^O[h>>8&255]^A[255&c]^E[v+1];s=T[d>>>24]^w[h>>16&255]^O[c>>8&255]^A[255&u]^E[v+2];l=T[h>>>24]^w[c>>16&255]^O[u>>8&255]^A[255&d]^E[v+3];c=a;u=o;d=s;h=l;v+=4}a=_[c>>>24]<<24^_[u>>16&255]<<16^_[d>>8&255]<<8^_[255&h]^E[v];o=_[u>>>24]<<24^_[d>>16&255]<<16^_[h>>8&255]<<8^_[255&c]^E[v+1];s=_[d>>>24]<<24^_[h>>16&255]<<16^_[c>>8&255]<<8^_[255&u]^E[v+2];l=_[h>>>24]<<24^_[c>>16&255]<<16^_[u>>8&255]<<8^_[255&d]^E[v+3];v+=3;P[e]=I(a^R);P[e+1]=I(l^L);P[e+2]=I(s^k);P[e+3]=I(o^D);R=f;L=p;k=g;D=y;e+=4}return n?i(P.buffer):P.buffer};t.prototype.destroy=function(){this.key=void 0;this.keySize=void 0;this.ksRows=void 0;this.sBox=void 0;this.invSBox=void 0;this.subMix=void 0;this.invSubMix=void 0;this.keySchedule=void 0;this.invKeySchedule=void 0;this.rcon=void 0};return t}()},"./src/crypt/decrypter.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/crypt/aes-crypto.js"),n=r("./src/crypt/fast-aes-key.js"),a=r("./src/crypt/aes-decryptor.js"),o=r("./src/errors.js"),s=r("./src/utils/logger.js"),l=r("./src/events.js"),c=r("./src/utils/get-self-scope.js"),u=c.getSelfScope();e.default=function(){function t(t,e,r){var i=(void 0===r?{}:r).removePKCS7Padding,n=void 0===i||i;this.logEnabled=!0;this.observer=t;this.config=e;this.removePKCS7Padding=n;if(n)try{var a=u.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(t){}this.disableWebCrypto=!this.subtle}t.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES};t.prototype.decrypt=function(t,e,r,o){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){if(this.logEnabled){s.logger.log("JS AES decrypt");this.logEnabled=!1}var c=this.decryptor;c||(this.decryptor=c=new a.default);c.expandKey(e);o(c.decrypt(t,0,r,this.removePKCS7Padding))}else{if(this.logEnabled){s.logger.log("WebCrypto AES decrypt");this.logEnabled=!1}var u=this.subtle;if(this.key!==e){this.key=e;this.fastAesKey=new n.default(u,e)}this.fastAesKey.expandKey().then(function(n){new i.default(u,r).decrypt(t,n).catch(function(i){l.onWebCryptoError(i,t,e,r,o)}).then(function(t){o(t)})}).catch(function(i){l.onWebCryptoError(i,t,e,r,o)})}};t.prototype.onWebCryptoError=function(t,e,r,i,n){if(this.config.enableSoftwareAES){s.logger.log("WebCrypto Error, disable WebCrypto API");this.disableWebCrypto=!0;this.logEnabled=!0;this.decrypt(e,r,i,n)}else{s.logger.error("decrypting error : "+t.message);this.observer.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message})}};t.prototype.destroy=function(){var t=this.decryptor;if(t){t.destroy();this.decryptor=void 0}};return t}()},"./src/crypt/fast-aes-key.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){function t(t,e){this.subtle=t;this.key=e}t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])};return t}()},"./src/demux/aacdemuxer.js":function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/demux/adts.js"),n=r("./src/utils/logger.js"),a=r("./src/demux/id3.js"),o=function(){function e(t,e,r){this.observer=t;this.config=r;this.remuxer=e}e.prototype.resetInitSegment=function(t,e,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:i,inputTimeScale:9e4}};e.prototype.resetTimeStamp=function(){};e.probe=function(t){if(!t)return!1;for(var e=a.default.getID3Data(t,0)||[],r=e.length,o=t.length;r<o;r++)if(i.probe(t,r)){n.logger.log("ADTS sync word found !");return!0}return!1};e.prototype.append=function(e,r,o,s){for(var l=this._audioTrack,c=a.default.getID3Data(e,0)||[],u=a.default.getTimeStamp(c),d=t.isFinite(u)?90*u:9e4*r,h=0,f=d,p=e.length,g=c.length,y=[{pts:f,dts:f,data:c}];g<p-1;)if(i.isHeader(e,g)&&g+5<p){i.initTrackConfig(l,this.observer,e,g,l.manifestCodec);var v=i.appendFrame(l,e,g,d,h);if(!v){n.logger.log("Unable to parse AAC frame");break}g+=v.length;f=v.sample.pts;h++}else if(a.default.isHeader(e,g)){c=a.default.getID3Data(e,g);y.push({pts:f,dts:f,data:c});g+=c.length}else g++;this.remuxer.remux(l,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},r,o,s)};e.prototype.destroy=function(){};return e}();e.default=o}).call(this,r("./src/polyfills/number.js").Number)},"./src/demux/adts.js":function(t,e,r){"use strict";function i(t,e,r,i){var n,a,o,s,l,c=navigator.userAgent.toLowerCase(),u=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];n=1+((192&e[r+2])>>>6);a=(60&e[r+2])>>>2;if(!(a>d.length-1)){s=(1&e[r+2])<<2;s|=(192&e[r+3])>>>6;f.logger.log("manifest codec:"+i+",ADTS data:type:"+n+",sampleingIndex:"+a+"["+d[a]+"Hz],channelConfig:"+s);if(/firefox/i.test(c))if(a>=6){n=5;l=new Array(4);o=a-3}else{n=2;l=new Array(2);o=a}else if(-1!==c.indexOf("android")){n=2;l=new Array(2);o=a}else{n=5;l=new Array(4);if(i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&a>=6)o=a-3;else{if(i&&-1!==i.indexOf("mp4a.40.2")&&(a>=6&&1===s||/vivaldi/i.test(c))||!i&&1===s){n=2;l=new Array(2)}o=a}}l[0]=n<<3;l[0]|=(14&a)>>1;l[1]|=(1&a)<<7;l[1]|=s<<3;if(5===n){l[1]|=(14&o)>>1;l[2]=(1&o)<<7;l[2]|=8;l[3]=0}return{config:l,samplerate:d[a],channelCount:s,codec:"mp4a.40."+n,manifestCodec:u}}t.trigger(g.default.ERROR,{type:p.ErrorTypes.MEDIA_ERROR,details:p.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+a})}function n(t,e){return 255===t[e]&&240==(246&t[e+1])}function a(t,e){return 1&t[e+1]?7:9}function o(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function s(t,e){return!!(e+1<t.length&&n(t,e))}function l(t,e){if(e+1<t.length&&n(t,e)){var r=a(t,e),i=r;e+5<t.length&&(i=o(t,e));var s=e+i;if(s===t.length||s+1<t.length&&n(t,s))return!0}return!1}function c(t,e,r,n,a){if(!t.samplerate){var o=i(e,r,n,a);t.config=o.config;t.samplerate=o.samplerate;t.channelCount=o.channelCount;t.codec=o.codec;t.manifestCodec=o.manifestCodec;f.logger.log("parsed codec:"+t.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}}function u(t){return 9216e4/t}function d(t,e,r,i,n){var s,l,c,u=t.length;s=a(t,e);l=o(t,e);l-=s;if(l>0&&e+s+l<=u){c=r+i*n;return{headerLength:s,frameLength:l,stamp:c}}}function h(t,e,r,i,n){var a=u(t.samplerate),o=d(e,r,i,n,a);if(o){var s=o.stamp,l=o.headerLength,c=o.frameLength,h={unit:e.subarray(r+l,r+l+c),pts:s,dts:s};t.samples.push(h);t.len+=c;return{sample:h,length:c+l}}}Object.defineProperty(e,"__esModule",{value:!0});var f=r("./src/utils/logger.js"),p=r("./src/errors.js"),g=r("./src/events.js");e.getAudioConfig=i;e.isHeaderPattern=n;e.getHeaderLength=a;e.getFullFrameLength=o;e.isHeader=s;e.probe=l;e.initTrackConfig=c;e.getFrameDuration=u;e.parseFrameHeader=d;e.appendFrame=h},"./src/demux/demuxer-inline.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=r("./src/events.js"),a=r("./src/errors.js"),o=r("./src/crypt/decrypter.js"),s=r("./src/demux/aacdemuxer.js"),l=r("./src/demux/mp4demuxer.js"),c=r("./src/demux/tsdemuxer.js"),u=r("./src/demux/mp3demuxer.js"),d=r("./src/remux/mp4-remuxer.js"),h=r("./src/remux/passthrough-remuxer.js"),f=r("./src/utils/get-self-scope.js"),p=r("./src/utils/logger.js"),g=f.getSelfScope();try{i=g.performance.now.bind(g.performance)}catch(t){p.logger.debug("Unable to use Performance API on this environment");i=g.Date.now}e.default=function(){function t(t,e,r,i){this.observer=t;this.typeSupported=e;this.config=r;this.vendor=i}t.prototype.destroy=function(){var t=this.demuxer;t&&t.destroy()};t.prototype.push=function(t,e,r,a,s,l,c,u,d,h,f,p){var g=this;if(t.byteLength>0&&null!=e&&null!=e.key&&"AES-128"===e.method){var y=this.decrypter;null==y&&(y=this.decrypter=new o.default(this.observer,this.config));var v=i();y.decrypt(t,e.key.buffer,e.iv.buffer,function(t){var o=i();g.observer.trigger(n.default.FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:o}});g.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),a,s,l,c,u,d,h,f,p)})}else this.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),a,s,l,c,u,d,h,f,p)};t.prototype.pushDecrypted=function(t,e,r,i,o,f,p,g,y,v,m,b){var E=this.demuxer;if(!E||(p||g)&&!this.probe(t)){for(var _=this.observer,S=this.typeSupported,T=this.config,w=[{demux:c.default,remux:d.default},{demux:l.default,remux:h.default},{demux:s.default,remux:d.default},{demux:u.default,remux:d.default}],O=0,A=w.length;O<A;O++){var C=w[O],R=C.demux.probe;if(R(t)){E=new C.demux(_,this.remuxer=new C.remux(_,T,S,this.vendor),T,S);this.probe=R;break}}if(!E){_.trigger(n.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});return}this.demuxer=E}var L=this.remuxer;if(p||g){E.resetInitSegment(r,i,o,v);L.resetInitSegment()}if(p){E.resetTimeStamp(b);L.resetTimeStamp(b)}"function"==typeof E.setDecryptData&&E.setDecryptData(e);E.append(t,f,y,m)};return t}()},"./src/demux/demuxer-worker.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/demux/demuxer-inline.js"),n=r("./src/events.js"),a=r("./src/utils/logger.js"),o=r("./node_modules/node-libs-browser/node_modules/events/events.js");e.default=function(t){var e=new o.EventEmitter;e.trigger=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];e.emit.apply(e,[t,t].concat(r))};e.off=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];e.removeListener.apply(e,[t].concat(r))};var r=function(e,r){t.postMessage({event:e,data:r})};t.addEventListener("message",function(n){var o=n.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);t.demuxer=new i.default(e,o.typeSupported,s,o.vendor);a.enableLogs(s.debug);r("init",null);break;case"demux":t.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}});e.on(n.default.FRAG_DECRYPTED,r);e.on(n.default.FRAG_PARSING_INIT_SEGMENT,r);e.on(n.default.FRAG_PARSED,r);e.on(n.default.ERROR,r);e.on(n.default.FRAG_PARSING_METADATA,r);e.on(n.default.FRAG_PARSING_USERDATA,r);e.on(n.default.INIT_PTS_FOUND,r);e.on(n.default.FRAG_PARSING_DATA,function(e,r){var i=[],n={event:e,data:r};if(r.data1){n.data1=r.data1.buffer;i.push(r.data1.buffer);delete r.data1}if(r.data2){n.data2=r.data2.buffer;i.push(r.data2.buffer);delete r.data2}t.postMessage(n,i)})}},"./src/demux/demuxer.js":function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=r("./node_modules/webworkify-webpack/index.js"),n=r("./src/events.js"),a=r("./src/demux/demuxer-inline.js"),o=r("./src/utils/logger.js"),s=r("./src/errors.js"),l=r("./src/utils/mediasource-helper.js"),c=r("./src/utils/get-self-scope.js"),u=r("./src/observer.js"),d=c.getSelfScope(),h=l.getMediaSource(),f=function(){function e(t,e){var r=this;this.hls=t;this.id=e;var l=this.observer=new u.Observer,c=t.config,f=function(e,i){i=i||{};i.frag=r.frag;i.id=r.id;t.trigger(e,i)};l.on(n.default.FRAG_DECRYPTED,f);l.on(n.default.FRAG_PARSING_INIT_SEGMENT,f);l.on(n.default.FRAG_PARSING_DATA,f);l.on(n.default.FRAG_PARSED,f);l.on(n.default.ERROR,f);l.on(n.default.FRAG_PARSING_METADATA,f);l.on(n.default.FRAG_PARSING_USERDATA,f);l.on(n.default.INIT_PTS_FOUND,f);var p={mp4:h.isTypeSupported("video/mp4"),mpeg:h.isTypeSupported("audio/mpeg"),mp3:h.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(c.enableWorker&&"undefined"!=typeof Worker){o.logger.log("demuxing in webworker");var y=void 0;try{y=this.w=i("./src/demux/demuxer-worker.js");this.onwmsg=this.onWorkerMessage.bind(this);y.addEventListener("message",this.onwmsg);y.onerror=function(e){t.trigger(n.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})};y.postMessage({cmd:"init",typeSupported:p,vendor:g,id:e,config:JSON.stringify(c)})}catch(t){o.logger.warn("Error in worker:",t);o.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline");y&&d.URL.revokeObjectURL(y.objectURL);this.demuxer=new a.default(l,p,c,g);this.w=void 0}}else this.demuxer=new a.default(l,p,c,g)}e.prototype.destroy=function(){var t=this.w;if(t){t.removeEventListener("message",this.onwmsg);t.terminate();this.w=null}else{var e=this.demuxer;if(e){e.destroy();this.demuxer=null}}var r=this.observer;if(r){r.removeAllListeners();this.observer=null}};e.prototype.push=function(e,r,i,n,a,s,l,c){var u=this.w,d=t.isFinite(a.startPTS)?a.startPTS:a.start,h=a.decryptdata,f=this.frag,p=!(f&&a.cc===f.cc),g=!(f&&a.level===f.level),y=f&&a.sn===f.sn+1,v=!g&&y;p&&o.logger.log(this.id+":discontinuity detected");g&&o.logger.log(this.id+":switch detected");this.frag=a;if(u)u.postMessage({cmd:"demux",data:e,decryptdata:h,initSegment:r,audioCodec:i,videoCodec:n,timeOffset:d,discontinuity:p,trackSwitch:g,contiguous:v,duration:s,accurateTimeOffset:l,defaultInitPTS:c},e instanceof ArrayBuffer?[e]:[]);else{var m=this.demuxer;m&&m.push(e,h,r,i,n,d,p,g,v,s,l,c)}};e.prototype.onWorkerMessage=function(t){var e=t.data,r=this.hls;switch(e.event){case"init":d.URL.revokeObjectURL(this.w.objectURL);break;case n.default.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1);e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{};e.data.frag=this.frag;e.data.id=this.id;r.trigger(e.event,e.data)}};return e}();e.default=f}).call(this,r("./src/polyfills/number.js").Number)},"./src/demux/exp-golomb.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/logger.js");e.default=function(){function t(t){this.data=t;this.bytesAvailable=t.byteLength;this.word=0;this.bitsAvailable=0}t.prototype.loadWord=function(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,i=new Uint8Array(4),n=Math.min(4,e);if(0===n)throw new Error("no bytes available");i.set(t.subarray(r,r+n));this.word=new DataView(i.buffer).getUint32(0);this.bitsAvailable=8*n;this.bytesAvailable-=n};t.prototype.skipBits=function(t){var e;if(this.bitsAvailable>t){this.word<<=t;this.bitsAvailable-=t}else{t-=this.bitsAvailable;e=t>>3;t-=e>>3;this.bytesAvailable-=e;this.loadWord();this.word<<=t;this.bitsAvailable-=t}};t.prototype.readBits=function(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;t>32&&i.logger.error("Cannot read more than 32 bits at a time");this.bitsAvailable-=e;this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord();e=t-e;return e>0&&this.bitsAvailable?r<<e|this.readBits(e):r};t.prototype.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t)){this.word<<=t;this.bitsAvailable-=t;return t}this.loadWord();return t+this.skipLZ()};t.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())};t.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())};t.prototype.readUEG=function(){return this.readBits(this.skipLZ()+1)-1};t.prototype.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)};t.prototype.readBoolean=function(){return 1===this.readBits(1)};t.prototype.readUByte=function(){return this.readBits(8)};t.prototype.readUShort=function(){return this.readBits(16)};t.prototype.readUInt=function(){return this.readBits(32)};t.prototype.skipScalingList=function(t){var e,r,i=8,n=8;for(e=0;e<t;e++){if(0!==n){r=this.readEG();n=(i+r+256)%256}i=0===n?i:n}};t.prototype.readSPS=function(){var t,e,r,i,n,a,o,s=0,l=0,c=0,u=0,d=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),y=this.skipEG.bind(this),v=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);d();t=d();h(5);g(3);d();v();if(100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t){var b=f();3===b&&g(1);v();v();g(1);if(p()){a=3!==b?8:12;for(o=0;o<a;o++)p()&&m(o<6?16:64)}}v();var E=f();if(0===E)f();else if(1===E){g(1);y();y();e=f();for(o=0;o<e;o++)y()}v();g(1);r=f();i=f();n=h(1);0===n&&g(1);g(1);if(p()){s=f();l=f();c=f();u=f()}var _=[1,1];if(p()&&p()){switch(d()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[d()<<8|d(),d()<<8|d()]}}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-n)*(i+1)*16-(n?2:4)*(c+u),pixelRatio:_}};t.prototype.readSliceType=function(){this.readUByte();this.readUEG();return this.readUEG()};return t}()},"./src/demux/id3.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}t.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128};t.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128};t.getID3Data=function(e,r){for(var i=r,n=0;t.isHeader(e,r);){n+=10;n+=t._readSize(e,r+6);t.isFooter(e,r+10)&&(n+=10);r+=n}if(n>0)return e.subarray(i,i+n)};t._readSize=function(t,e){var r=0;r=(127&t[e])<<21;r|=(127&t[e+1])<<14;r|=(127&t[e+2])<<7;r|=127&t[e+3];return r};t.getTimeStamp=function(e){for(var r=t.getID3Frames(e),i=0;i<r.length;i++){var n=r[i];if(t.isTimeStampFrame(n))return t._readTimeStamp(n)}};t.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info};t._getFrameData=function(e){var r=String.fromCharCode(e[0],e[1],e[2],e[3]),i=t._readSize(e,4);return{type:r,size:i,data:e.subarray(10,10+i)}};t.getID3Frames=function(e){for(var r=0,i=[];t.isHeader(e,r);){var n=t._readSize(e,r+6);r+=10;for(var a=r+n;r+8<a;){var o=t._getFrameData(e.subarray(r)),s=t._decodeFrame(o);s&&i.push(s);r+=o.size+10}t.isFooter(e,r)&&(r+=10)}return i};t._decodeFrame=function(e){return"PRIV"===e.type?t._decodePrivFrame(e):"T"===e.type[0]?t._decodeTextFrame(e):"W"===e.type[0]?t._decodeURLFrame(e):void 0};t._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),r=1&e[3],i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];i/=45;r&&(i+=47721858.84);return Math.round(i)}};t._decodePrivFrame=function(e){if(!(e.size<2)){var r=t._utf8ArrayToStr(e.data,!0);return{key:e.type,info:r,data:new Uint8Array(e.data.subarray(r.length+1)).buffer}}};t._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var r=1,i=t._utf8ArrayToStr(e.data.subarray(r));r+=i.length+1;return{key:e.type,info:i,data:t._utf8ArrayToStr(e.data.subarray(r))}}return{key:e.type,data:t._utf8ArrayToStr(e.data.subarray(1))}}};t._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var r=1,i=t._utf8ArrayToStr(e.data.subarray(r));r+=i.length+1;return{key:e.type,info:i,data:t._utf8ArrayToStr(e.data.subarray(r))}}return{key:e.type,data:t._utf8ArrayToStr(e.data)}};t._utf8ArrayToStr=function(t,e){void 0===e&&(e=!1);for(var r,i,n,a=t.length,o="",s=0;s<a;){r=t[s++];if(0===r&&e)return o;if(0!==r&&3!==r)switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:i=t[s++];o+=String.fromCharCode((31&r)<<6|63&i);break;case 14:i=t[s++];n=t[s++];o+=String.fromCharCode((15&r)<<12|(63&i)<<6|(63&n)<<0)}}return o};return t}();e.utf8ArrayToStr=i._utf8ArrayToStr;e.default=i},"./src/demux/mp3demuxer.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/demux/id3.js"),n=r("./src/utils/logger.js"),a=r("./src/demux/mpegaudio.js");e.default=function(){function t(t,e,r){this.observer=t;this.config=r;this.remuxer=e}t.prototype.resetInitSegment=function(t,e,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:i,inputTimeScale:9e4}};t.prototype.resetTimeStamp=function(){};t.probe=function(t){var e,r,o=i.default.getID3Data(t,0);if(o&&void 0!==i.default.getTimeStamp(o))for(e=o.length,r=Math.min(t.length-1,e+100);e<r;e++)if(a.default.probe(t,e)){n.logger.log("MPEG Audio sync word found !");return!0}return!1};t.prototype.append=function(t,e,r,n){for(var o=i.default.getID3Data(t,0),s=i.default.getTimeStamp(o),l=s?90*s:9e4*e,c=o.length,u=t.length,d=0,h=0,f=this._audioTrack,p=[{pts:l,dts:l,data:o}];c<u;)if(a.default.isHeader(t,c)){var g=a.default.appendFrame(f,t,c,l,d);if(!g)break;c+=g.length;h=g.sample.pts;d++}else if(i.default.isHeader(t,c)){o=i.default.getID3Data(t,c);p.push({pts:h,dts:h,data:o});c+=o.length}else c++;this.remuxer.remux(f,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},e,r,n)};t.prototype.destroy=function(){};return t}()},"./src/demux/mp4demuxer.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),n=r("./src/events.js"),a=Math.pow(2,32)-1;e.default=function(){function t(t,e){this.observer=t;this.remuxer=e}t.prototype.resetTimeStamp=function(t){this.initPTS=t};t.prototype.resetInitSegment=function(e,r,i,a){if(e&&e.byteLength){var o=this.initData=t.parseInitSegment(e);null==r&&(r="mp4a.40.5");null==i&&(i="avc1.42e01e");var s={};if(o.audio&&o.video)s.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:a?e:null};else{o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:a?e:null});o.video&&(s.video={container:"video/mp4",codec:i,initSegment:a?e:null})}this.observer.trigger(n.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else{r&&(this.audioCodec=r);i&&(this.videoCodec=i)}};t.probe=function(e){return t.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length>0};t.bin2str=function(t){return String.fromCharCode.apply(null,t)};t.readUint16=function(t,e){if(t.data){e+=t.start;t=t.data}var r=t[e]<<8|t[e+1];return r<0?65536+r:r};t.readUint32=function(t,e){if(t.data){e+=t.start;t=t.data}var r=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return r<0?4294967296+r:r};t.writeUint32=function(t,e,r){if(t.data){e+=t.start;t=t.data}t[e]=r>>24;t[e+1]=r>>16&255;t[e+2]=r>>8&255;t[e+3]=255&r};t.findBox=function(e,r){var i,n,a,o,s,l,c,u=[];if(e.data){l=e.start;o=e.end;e=e.data}else{l=0;o=e.byteLength}if(!r.length)return null;for(i=l;i<o;){n=t.readUint32(e,i);a=t.bin2str(e.subarray(i+4,i+8));c=n>1?i+n:o;if(a===r[0])if(1===r.length)u.push({data:e,start:i+8,end:c});else{s=t.findBox({data:e,start:i+8,end:c},r.slice(1));s.length&&(u=u.concat(s))}i=c}return u};t.parseSegmentIndex=function(e){var r,i=t.findBox(e,["moov"])[0],n=i?i.end:null,a=0,o=t.findBox(e,["sidx"]);if(!o||!o[0])return null;r=[];o=o[0];var s=o.data[0];a=0===s?8:16;var l=t.readUint32(o,a);a+=4;a+=0===s?8:16;a+=2;var c=o.end+0,u=t.readUint16(o,a);a+=2;for(var d=0;d<u;d++){var h=a,f=t.readUint32(o,h);h+=4;var p=2147483647&f;if(1===(2147483648&f)>>>31){console.warn("SIDX has hierarchical references (not supported)");return}var g=t.readUint32(o,h);h+=4;r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/l,start:c,end:c+p-1}});c+=p;h+=4;a=h}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:u,references:r,moovEndOffset:n}};t.parseInitSegment=function(e){var r=[];t.findBox(e,["moov","trak"]).forEach(function(e){var n=t.findBox(e,["tkhd"])[0];if(n){var a=n.data[n.start],o=0===a?12:20,s=t.readUint32(n,o),l=t.findBox(e,["mdia","mdhd"])[0];if(l){a=l.data[l.start];o=0===a?12:20;var c=t.readUint32(l,o),u=t.findBox(e,["mdia","hdlr"])[0];if(u){var d=t.bin2str(u.data.subarray(u.start+8,u.start+12)),h={soun:"audio",vide:"video"}[d];if(h){var f=t.findBox(e,["mdia","minf","stbl","stsd"]);if(f.length){f=f[0];var p=t.bin2str(f.data.subarray(f.start+12,f.start+16));i.logger.log("MP4Demuxer:"+h+":"+p+" found")}r[s]={timescale:c,type:h};r[h]={timescale:c,id:s}}}}}});return r};t.getStartDTS=function(e,r){var i,n,a;i=t.findBox(r,["moof","traf"]);n=[].concat.apply([],i.map(function(r){return t.findBox(r,["tfhd"]).map(function(i){var n,a,o;n=t.readUint32(i,4);a=e[n].timescale||9e4;o=t.findBox(r,["tfdt"]).map(function(e){var r,i;r=e.data[e.start];i=t.readUint32(e,4);if(1===r){i*=Math.pow(2,32);i+=t.readUint32(e,8)}return i})[0];return o/a})}));a=Math.min.apply(null,n);return isFinite(a)?a:0};t.offsetStartDTS=function(e,r,i){t.findBox(r,["moof","traf"]).map(function(r){return t.findBox(r,["tfhd"]).map(function(n){var o=t.readUint32(n,4),s=e[o].timescale||9e4;t.findBox(r,["tfdt"]).map(function(e){var r=e.data[e.start],n=t.readUint32(e,4);if(0===r)t.writeUint32(e,4,n-i*s);else{n*=Math.pow(2,32);n+=t.readUint32(e,8);n-=i*s;n=Math.max(n,0);var o=Math.floor(n/(a+1)),l=Math.floor(n%(a+1));t.writeUint32(e,4,o);t.writeUint32(e,8,l)}})})})};t.prototype.append=function(e,r,i,a){var o=this.initData;if(!o){this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1);o=this.initData}var s,l=this.initPTS;if(void 0===l){this.initPTS=l=t.getStartDTS(o,e)-r;this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:l})}t.offsetStartDTS(o,e,l);s=t.getStartDTS(o,e);this.remuxer.remux(o.audio,o.video,null,null,s,i,a,e)};t.prototype.destroy=function(){};return t}()},"./src/demux/mpegaudio.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(t,e,r,i,n){if(!(r+24>e.length)){var a=this.parseHeader(e,r);if(a&&r+a.frameLength<=e.length){var o=9e4*a.samplesPerFrame/a.sampleRate,s=i+n*o,l={unit:e.subarray(r,r+a.frameLength),pts:s,dts:s};t.config=[];t.channelCount=a.channelCount;t.samplerate=a.sampleRate;t.samples.push(l);t.len+=a.frameLength;return{sample:l,length:a.frameLength}}}},parseHeader:function(t,e){var r=t[e+1]>>3&3,n=t[e+1]>>1&3,a=t[e+2]>>4&15,o=t[e+2]>>2&3,s=t[e+2]>>1&1;if(1!==r&&0!==a&&15!==a&&3!==o){var l=3===r?3-n:3===n?3:4,c=1e3*i.BitratesMap[14*l+a-1],u=3===r?0:2===r?1:2,d=i.SamplingRateMap[3*u+o],h=t[e+3]>>6==3?1:2,f=i.SamplesCoefficients[r][n],p=i.BytesInSlot[n],g=8*f*p;return{sampleRate:d,channelCount:h,frameLength:parseInt(f*c/d+s,10)*p,samplesPerFrame:g}}},isHeaderPattern:function(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var r=this.parseHeader(t,e),i=4;r&&r.frameLength&&(i=r.frameLength);var n=e+i;if(n===t.length||n+1<t.length&&this.isHeaderPattern(t,n))return!0}return!1}};e.default=i},"./src/demux/sample-aes.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/crypt/decrypter.js");e.default=function(){function t(t,e,r,n){this.decryptdata=r;this.discardEPB=n;this.decrypter=new i.default(t,e,{removePKCS7Padding:!1})}t.prototype.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)};t.prototype.decryptAacSample=function(t,e,r,i){var n=t[e].unit,a=n.subarray(16,n.length-n.length%16),o=this;this.decryptBuffer(a.buffer.slice(a.byteOffset,a.byteOffset+a.length),function(a){a=new Uint8Array(a);n.set(a,16);i||o.decryptAacSamples(t,e+1,r)})};t.prototype.decryptAacSamples=function(t,e,r){for(;;e++){if(e>=t.length){r();return}if(!(t[e].unit.length<32)){var i=this.decrypter.isSync();this.decryptAacSample(t,e,r,i);if(!i)return}}};t.prototype.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,r=new Int8Array(e),i=0,n=32;n<=t.length-16;n+=160,i+=16)r.set(t.subarray(n,n+16),i);return r};t.prototype.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var r=0,i=32;i<=t.length-16;i+=160,r+=16)t.set(e.subarray(r,r+16),i);return t};t.prototype.decryptAvcSample=function(t,e,r,i,n,a){var o=this.discardEPB(n.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,function(s){n.data=l.getAvcDecryptedUnit(o,s);a||l.decryptAvcSamples(t,e,r+1,i)})};t.prototype.decryptAvcSamples=function(t,e,r,i){for(;;e++,r=0){if(e>=t.length){i();return}for(var n=t[e].units;!(r>=n.length);r++){var a=n[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();this.decryptAvcSample(t,e,r,i,a,o);if(!o)return}}}};return t}()},"./src/demux/tsdemuxer.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/demux/adts.js"),n=r("./src/demux/mpegaudio.js"),a=r("./src/events.js"),o=r("./src/demux/exp-golomb.js"),s=r("./src/demux/sample-aes.js"),l=r("./src/utils/logger.js"),c=r("./src/errors.js"),u={video:1,audio:2,id3:3,text:4};e.default=function(){function t(t,e,r,i){this.observer=t;this.config=r;this.typeSupported=i;this.remuxer=e;this.sampleAes=null}t.prototype.setDecryptData=function(t){this.sampleAes=null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?new s.default(this.observer,this.config,t,this.discardEPB):null};t.probe=function(e){var r=t._syncOffset(e);if(r<0)return!1;r&&l.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?");return!0};t._syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),r=0;r<e;){if(71===t[r]&&71===t[r+188]&&71===t[r+376])return r;r++}return-1};t.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:u[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===t?0:void 0,isAAC:"audio"===t||void 0,duration:"audio"===t?e:void 0}};t.prototype.resetInitSegment=function(e,r,i,n){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=t.createTrack("video",n);this._audioTrack=t.createTrack("audio",n);this._id3Track=t.createTrack("id3",n);this._txtTrack=t.createTrack("text",n);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=r;this.videoCodec=i;this._duration=n};t.prototype.resetTimeStamp=function(){};t.prototype.append=function(e,r,i,n){var o,s,u,d,h,f,p=e.length,g=!1;this.contiguous=i;var y=this.pmtParsed,v=this._avcTrack,m=this._audioTrack,b=this._id3Track,E=v.pid,_=m.pid,S=b.pid,T=this._pmtId,w=v.pesData,O=m.pesData,A=b.pesData,C=this._parsePAT,R=this._parsePMT,L=this._parsePES,k=this._parseAVCPES.bind(this),D=this._parseAACPES.bind(this),x=this._parseMPEGPES.bind(this),P=this._parseID3PES.bind(this),I=t._syncOffset(e);p-=(p+I)%188;for(o=I;o<p;o+=188)if(71===e[o]){s=!!(64&e[o+1]);u=((31&e[o+1])<<8)+e[o+2];d=(48&e[o+3])>>4;if(d>1){h=o+5+e[o+4];if(h===o+188)continue}else h=o+4;switch(u){case E:if(s){w&&(f=L(w))&&void 0!==f.pts&&k(f,!1);w={data:[],size:0}}if(w){w.data.push(e.subarray(h,o+188));w.size+=o+188-h}break;case _:if(s){O&&(f=L(O))&&void 0!==f.pts&&(m.isAAC?D(f):x(f));O={data:[],size:0}}if(O){O.data.push(e.subarray(h,o+188));O.size+=o+188-h}break;case S:if(s){A&&(f=L(A))&&void 0!==f.pts&&P(f);A={data:[],size:0}}if(A){A.data.push(e.subarray(h,o+188));A.size+=o+188-h}break;case 0:s&&(h+=e[h]+1);T=this._pmtId=C(e,h);break;case T:s&&(h+=e[h]+1);var j=R(e,h,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);E=j.avc;E>0&&(v.pid=E);_=j.audio;if(_>0){m.pid=_;m.isAAC=j.isAAC}S=j.id3;S>0&&(b.pid=S);if(g&&!y){l.logger.log("reparse from beginning");g=!1;o=I-188}y=this.pmtParsed=!0;break;case 17:case 8191:break;default:g=!0}}else this.observer.trigger(a.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});if(w&&(f=L(w))&&void 0!==f.pts){k(f,!0);v.pesData=null}else v.pesData=w;if(O&&(f=L(O))&&void 0!==f.pts){m.isAAC?D(f):x(f);m.pesData=null}else{O&&O.size&&l.logger.log("last AAC PES packet truncated,might overlap between fragments");m.pesData=O}if(A&&(f=L(A))&&void 0!==f.pts){P(f);b.pesData=null}else b.pesData=A;null==this.sampleAes?this.remuxer.remux(m,v,b,this._txtTrack,r,i,n):this.decryptAndRemux(m,v,b,this._txtTrack,r,i,n)};t.prototype.decryptAndRemux=function(t,e,r,i,n,a,o){if(t.samples&&t.isAAC){var s=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){s.decryptAndRemuxAvc(t,e,r,i,n,a,o)})}else this.decryptAndRemuxAvc(t,e,r,i,n,a,o)};t.prototype.decryptAndRemuxAvc=function(t,e,r,i,n,a,o){if(e.samples){var s=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,function(){s.remuxer.remux(t,e,r,i,n,a,o)})}else this.remuxer.remux(t,e,r,i,n,a,o)};t.prototype.destroy=function(){this._initPTS=this._initDTS=void 0;this._duration=0};t.prototype._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]};t.prototype._parsePMT=function(t,e,r,i){var n,a,o,s,c={audio:-1,avc:-1,id3:-1,isAAC:!0};n=(15&t[e+1])<<8|t[e+2];a=e+3+n-4;o=(15&t[e+10])<<8|t[e+11];e+=12+o;for(;e<a;){s=(31&t[e+1])<<8|t[e+2];switch(t[e]){case 207:if(!i){l.logger.log("unkown stream type:"+t[e]);break}case 15:-1===c.audio&&(c.audio=s);break;case 21:-1===c.id3&&(c.id3=s);break;case 219:if(!i){l.logger.log("unkown stream type:"+t[e]);break}case 27:-1===c.avc&&(c.avc=s);break;case 3:case 4:if(r){if(-1===c.audio){c.audio=s;c.isAAC=!1}}else l.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:l.logger.warn("HEVC stream type found, not supported for now");break;default:l.logger.log("unkown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return c};t.prototype._parsePES=function(t){var e,r,i,n,a,o,s,c,u,d=0,h=t.data;if(!t||0===t.size)return null;for(;h[0].length<19&&h.length>1;){var f=new Uint8Array(h[0].length+h[1].length);f.set(h[0]);f.set(h[1],h[0].length);h[0]=f;h.splice(1,1)}e=h[0];i=(e[0]<<16)+(e[1]<<8)+e[2];if(1===i){n=(e[4]<<8)+e[5];if(n&&n>t.size-6)return null;r=e[7];if(192&r){s=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2;s>4294967295&&(s-=8589934592);if(64&r){c=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2;c>4294967295&&(c-=8589934592);if(s-c>54e5){l.logger.warn(Math.round((s-c)/9e4)+"s delta between PTS and DTS, align them");s=c}}else c=s}a=e[8];u=a+9;t.size-=u;o=new Uint8Array(t.size);for(var p=0,g=h.length;p<g;p++){e=h[p];var y=e.byteLength;if(u){if(u>y){u-=y;continue}e=e.subarray(u);y-=u;u=0}o.set(e,d);d+=y}n&&(n-=a+3);return{data:o,pts:s,dts:c,len:n}}return null};t.prototype.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var r=e.samples,i=r.length;if(!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(i||this.contiguous)){t.id=i;r.push(t)}else e.dropped++}t.debug.length&&l.logger.log(t.pts+"/"+t.dts+":"+t.debug)};t.prototype._parseAVCPES=function(t,e){var r,i,n,a=this,s=this._avcTrack,l=this._parseAVCNALu(t.data),c=this.avcSample,u=!1,d=this.pushAccesUnit.bind(this),h=function(t,e,r,i){return{key:t,pts:e,dts:r,units:[],debug:i}};t.data=null;if(c&&l.length&&!s.audFound){d(c,s);c=this.avcSample=h(!1,t.pts,t.dts,"")}l.forEach(function(e){switch(e.type){case 1:i=!0;c||(c=a.avcSample=h(!0,t.pts,t.dts,""));c.frame=!0;var l=e.data;if(u&&l.length>4){var f=new o.default(l).readSliceType();2!==f&&4!==f&&7!==f&&9!==f||(c.key=!0)}break;case 5:i=!0;c||(c=a.avcSample=h(!0,t.pts,t.dts,""));c.key=!0;c.frame=!0;break;case 6:i=!0;r=new o.default(a.discardEPB(e.data));r.readUByte();for(var p=0,g=0,y=!1,v=0;!y&&r.bytesAvailable>1;){p=0;do{v=r.readUByte();p+=v}while(255===v);g=0;do{v=r.readUByte();g+=v}while(255===v);if(4===p&&0!==r.bytesAvailable){y=!0;if(181===r.readUByte()){if(49===r.readUShort()){if(1195456820===r.readUInt()){if(3===r.readUByte()){var m=r.readUByte(),b=r.readUByte(),E=31&m,_=[m,b];for(n=0;n<E;n++){_.push(r.readUByte());_.push(r.readUByte());_.push(r.readUByte())}a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:t.pts,bytes:_})}}}}}else if(g<r.bytesAvailable)for(n=0;n<g;n++)r.readUByte()}break;case 7:i=!0;u=!0;if(!s.sps){r=new o.default(e.data);var S=r.readSPS();s.width=S.width;s.height=S.height;s.pixelRatio=S.pixelRatio;s.sps=[e.data];s.duration=a._duration;var T=e.data.subarray(1,4),w="avc1.";for(n=0;n<3;n++){var O=T[n].toString(16);O.length<2&&(O="0"+O);w+=O}s.codec=w}break;case 8:i=!0;s.pps||(s.pps=[e.data]);break;case 9:i=!1;s.audFound=!0;c&&d(c,s);c=a.avcSample=h(!1,t.pts,t.dts,"");break;case 12:i=!1;break;default:i=!1;c&&(c.debug+="unknown NAL "+e.type+" ")}if(c&&i){c.units.push(e)}});if(e&&c){d(c,s);this.avcSample=null}};t.prototype._insertSampleInOrder=function(t,e){var r=t.length;if(r>0){if(e.pts>=t[r-1].pts)t.push(e);else for(var i=r-1;i>=0;i--)if(e.pts<t[i].pts){t.splice(i,0,e);break}}else t.push(e)};t.prototype._getLastNalUnit=function(){var t,e=this.avcSample;if(!e||0===e.units.length){var r=this._avcTrack,i=r.samples;e=i[i.length-1]}if(e){var n=e.units;t=n[n.length-1]}return t};t.prototype._parseAVCNALu=function(t){var e,r,i,n,a,o=0,s=t.byteLength,l=this._avcTrack,c=l.naluState||0,u=c,d=[],h=-1;if(-1===c){h=0;a=31&t[0];c=0;o=1}for(;o<s;){e=t[o++];if(c)if(1!==c)if(e)if(1===e){if(h>=0){i={data:t.subarray(h,o-c-1),type:a};d.push(i)}else{var f=this._getLastNalUnit();if(f){u&&o<=4-u&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-u));r=o-c-1;if(r>0){var p=new Uint8Array(f.data.byteLength+r);p.set(f.data,0);p.set(t.subarray(0,r),f.data.byteLength);f.data=p}}}if(o<s){n=31&t[o];h=o;a=n;c=0}else c=-1}else c=0;else c=3;else c=e?0:2;else c=e?0:1}if(h>=0&&c>=0){i={data:t.subarray(h,s),type:a,state:c};d.push(i)}if(0===d.length){var f=this._getLastNalUnit();if(f){var p=new Uint8Array(f.data.byteLength+t.byteLength);p.set(f.data,0);p.set(t,f.data.byteLength);f.data=p}}l.naluState=c;return d};t.prototype.discardEPB=function(t){for(var e,r,i=t.byteLength,n=[],a=1;a<i-2;)if(0===t[a]&&0===t[a+1]&&3===t[a+2]){n.push(a+2);a+=2}else a++;if(0===n.length)return t;e=i-n.length;r=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++){if(o===n[0]){o++;n.shift()}r[a]=t[o]}return r};t.prototype._parseAACPES=function(t){var e,r,n,o,s,u=this._audioTrack,d=t.data,h=t.pts,f=this.aacOverFlow,p=this.aacLastPTS;if(f){var g=new Uint8Array(f.byteLength+d.byteLength);g.set(f,0);g.set(d,f.byteLength);d=g}for(n=0,s=d.length;n<s-1&&!i.isHeader(d,n);n++);if(n){var y=void 0,v=void 0;if(n<s-1){y="AAC PES did not start with ADTS header,offset:"+n;v=!1}else{y="no ADTS header found in AAC PES";v=!0}l.logger.warn("parsing error:"+y);this.observer.trigger(a.default.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:v,reason:y});if(v)return}i.initTrackConfig(u,this.observer,d,n,this.audioCodec);r=0;e=i.getFrameDuration(u.samplerate);if(f&&p){var m=p+e;if(Math.abs(m-h)>1){l.logger.log("AAC: align PTS for overlapping frames by "+Math.round((m-h)/90));h=m}}for(;n<s;)if(i.isHeader(d,n)&&n+5<s){var b=i.appendFrame(u,d,n,h,r);if(!b)break;n+=b.length;o=b.sample.pts;r++}else n++;f=n<s?d.subarray(n,s):null;this.aacOverFlow=f;this.aacLastPTS=o};t.prototype._parseMPEGPES=function(t){for(var e=t.data,r=e.length,i=0,a=0,o=t.pts;a<r;)if(n.default.isHeader(e,a)){var s=n.default.appendFrame(this._audioTrack,e,a,o,i);if(!s)break;a+=s.length;i++}else a++};t.prototype._parseID3PES=function(t){this._id3Track.samples.push(t)};return t}()},"./src/errors.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"};e.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},"./src/event-handler.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),n=r("./src/errors.js"),a=r("./src/events.js"),o={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0};e.default=function(){function t(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.hls=t;this.onEvent=this.onEvent.bind(this);this.handledEvents=e;this.useGenericHandler=!0;this.registerListeners()}t.prototype.destroy=function(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()};t.prototype.onHandlerDestroying=function(){};t.prototype.onHandlerDestroyed=function(){};t.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent};t.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){if(o[t])throw new Error("Forbidden event-name: "+t);this.hls.on(t,this.onEvent)},this)};t.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){this.hls.off(t,this.onEvent)},this)};t.prototype.onEvent=function(t,e){this.onEventGeneric(t,e)};t.prototype.onEventGeneric=function(t,e){var r=function(t,e){var r="on"+t.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,e)};try{r.call(this,t,e).call()}catch(e){i.logger.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e);this.hls.trigger(a.default.ERROR,{type:n.ErrorTypes.OTHER_ERROR,details:n.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}};return t}()},"./src/events.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},"./src/hls.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./node_modules/url-toolkit/src/url-toolkit.js"),a=r("./src/errors.js"),o=r("./src/loader/playlist-loader.js"),s=r("./src/loader/fragment-loader.js"),l=r("./src/loader/key-loader.js"),c=r("./src/controller/fragment-tracker.js"),u=r("./src/controller/stream-controller.js"),d=r("./src/controller/level-controller.js"),h=r("./src/controller/id3-track-controller.js"),f=r("./src/is-supported.js"),p=r("./src/utils/logger.js"),g=r("./src/config.js"),y=r("./src/events.js"),v=r("./src/observer.js");e.default=function(t){function e(r){void 0===r&&(r={});var i=t.call(this)||this,n=e.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var a in n)a in r||(r[a]=n[a]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');p.enableLogs(r.debug);i.config=r;i._autoLevelCapping=-1;var f=i.abrController=new r.abrController(i),g=new r.bufferController(i),y=new r.capLevelController(i),v=new r.fpsController(i),m=new o.default(i),b=new s.default(i),E=new l.default(i),_=new h.default(i),S=i.levelController=new d.default(i),T=new c.FragmentTracker(i),w=i.streamController=new u.default(i,T),O=[S,w],A=r.audioStreamController;A&&O.push(new A(i,T));i.networkControllers=O;var C=[m,b,E,f,g,y,v,_,T];A=r.audioTrackController;if(A){var R=new A(i);i.audioTrackController=R;C.push(R)}A=r.subtitleTrackController;if(A){var L=new A(i);i.subtitleTrackController=L;C.push(L)}A=r.emeController;if(A){var k=new A(i);i.emeController=k;C.push(k)}A=r.subtitleStreamController;A&&C.push(new A(i,T));A=r.timelineController;A&&C.push(new A(i));i.coreComponents=C;return i}i(e,t);Object.defineProperty(e,"version",{get:function(){return"0.12.2"},enumerable:!0,configurable:!0});e.isSupported=function(){return f.isSupported()};Object.defineProperty(e,"Events",{get:function(){return y.default},enumerable:!0,configurable:!0});Object.defineProperty(e,"ErrorTypes",{get:function(){return a.ErrorTypes},enumerable:!0,configurable:!0});Object.defineProperty(e,"ErrorDetails",{get:function(){return a.ErrorDetails},enumerable:!0,configurable:!0});Object.defineProperty(e,"DefaultConfig",{get:function(){return e.defaultConfig?e.defaultConfig:g.hlsDefaultConfig},set:function(t){e.defaultConfig=t},enumerable:!0,configurable:!0});e.prototype.destroy=function(){p.logger.log("destroy");this.trigger(y.default.DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()});this.url=null;this.removeAllListeners();this._autoLevelCapping=-1};e.prototype.attachMedia=function(t){p.logger.log("attachMedia");this.media=t;this.trigger(y.default.MEDIA_ATTACHING,{media:t})};e.prototype.detachMedia=function(){p.logger.log("detachMedia");this.trigger(y.default.MEDIA_DETACHING);this.media=null};e.prototype.loadSource=function(t){t=n.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0});p.logger.log("loadSource:"+t);this.url=t;this.trigger(y.default.MANIFEST_LOADING,{url:t})};e.prototype.startLoad=function(t){void 0===t&&(t=-1);p.logger.log("startLoad("+t+")");this.networkControllers.forEach(function(e){e.startLoad(t)})};e.prototype.stopLoad=function(){p.logger.log("stopLoad");this.networkControllers.forEach(function(t){t.stopLoad()})};e.prototype.swapAudioCodec=function(){p.logger.log("swapAudioCodec");this.streamController.swapAudioCodec()};e.prototype.recoverMediaError=function(){p.logger.log("recoverMediaError");var t=this.media;this.detachMedia();this.attachMedia(t)};Object.defineProperty(e.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(t){p.logger.log("set currentLevel:"+t);this.loadLevel=t;this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(t){p.logger.log("set nextLevel:"+t);this.levelController.manualLevel=t;this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(t){p.logger.log("set loadLevel:"+t);this.levelController.manualLevel=t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){p.logger.log("set firstLevel:"+t);this.levelController.firstLevel=t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(t){p.logger.log("set startLevel:"+t);var e=this;-1!==t&&(t=Math.max(t,e.minAutoLevel));e.levelController.startLevel=t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(t){p.logger.log("set autoLevelCapping:"+t);this._autoLevelCapping=t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"minAutoLevel",{get:function(){for(var t=this,e=t.levels,r=t.config.minAutoBitrate,i=e?e.length:0,n=0;n<i;n++){if((e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate)>r)return n}return 0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"maxAutoLevel",{get:function(){var t,e=this,r=e.levels,i=e.autoLevelCapping;t=-1===i&&r&&r.length?r.length-1:i;return t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"nextAutoLevel",{get:function(){var t=this;return Math.min(Math.max(t.abrController.nextAutoLevel,t.minAutoLevel),t.maxAutoLevel)},set:function(t){var e=this;e.abrController.nextAutoLevel=Math.max(e.minAutoLevel,t)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"audioTracks",{get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"audioTrack",{get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"subtitleTracks",{get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"subtitleTrack",{get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"subtitleDisplay",{get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)},enumerable:!0,configurable:!0});return e}(v.Observer)},"./src/is-supported.js":function(t,e,r){"use strict";function i(){var t=n.getMediaSource(),e=window.SourceBuffer||window.WebKitSourceBuffer,r=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove;return!!r&&!!i}Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/utils/mediasource-helper.js");e.isSupported=i},"./src/loader/fragment-loader.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/errors.js"),s=r("./src/utils/logger.js"),l=function(e){function r(t){var r=e.call(this,t,n.default.FRAG_LOADING)||this;r.loaders={};return r}i(r,e);r.prototype.destroy=function(){var t=this.loaders;for(var r in t){var i=t[r];i&&i.destroy()}this.loaders={};e.prototype.destroy.call(this)};r.prototype.onFragLoading=function(e){var r=e.frag,i=r.type,n=this.loaders,a=this.hls.config,o=a.fLoader,l=a.loader;r.loaded=0;var c=n[i];if(c){s.logger.warn("abort previous fragment loader for type: "+i);c.abort()}c=n[i]=r.loader=a.fLoader?new o(a):new l(a);var u,d,h;u={url:r.url,frag:r,responseType:"arraybuffer",progressData:!1};var f=r.byteRangeStartOffset,p=r.byteRangeEndOffset;if(t.isFinite(f)&&t.isFinite(p)){u.rangeStart=f;u.rangeEnd=p}d={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:a.fragLoadingMaxRetryTimeout};h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};c.load(u,d,h)};r.prototype.loadsuccess=function(t,e,r,i){void 0===i&&(i=null);var a=t.data,o=r.frag;o.loader=void 0;this.loaders[o.type]=void 0;this.hls.trigger(n.default.FRAG_LOADED,{payload:a,frag:o,stats:e,networkDetails:i})};r.prototype.loaderror=function(t,e,r){void 0===r&&(r=null);var i=e.frag,a=i.loader;a&&a.abort();this.loaders[i.type]=void 0;this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:r})};r.prototype.loadtimeout=function(t,e,r){void 0===r&&(r=null);var i=e.frag,a=i.loader;a&&a.abort();this.loaders[i.type]=void 0;this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:r})};r.prototype.loadprogress=function(t,e,r,i){void 0===i&&(i=null);var a=e.frag;a.loaded=t.loaded;this.hls.trigger(n.default.FRAG_LOAD_PROGRESS,{frag:a,stats:t,networkDetails:i})};return r}(a.default);e.default=l}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/fragment.js":function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=r("./node_modules/url-toolkit/src/url-toolkit.js"),n=r("./src/loader/level-key.js"),a=function(){function e(){var t;this._url=null;this._byteRange=null;this._decryptdata=null;this.tagList=[];this.programDateTime=null;this.rawProgramDateTime=null;this._elementaryStreams=(t={},t[e.ElementaryStreamTypes.AUDIO]=!1,t[e.ElementaryStreamTypes.VIDEO]=!1,t)}Object.defineProperty(e,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"url",{get:function(){!this._url&&this.relurl&&(this._url=i.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0}));return this._url},set:function(t){this._url=t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"byteRange",{get:function(){if(!this._byteRange&&!this.rawByteRange)return[];if(this._byteRange)return this._byteRange;var t=[];if(this.rawByteRange){var e=this.rawByteRange.split("@",2);if(1===e.length){t[0]=this.lastByteRangeEndOffset||0}else t[0]=parseInt(e[1]);t[1]=parseInt(e[0])+t[0];this._byteRange=t}return t},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"decryptdata",{get:function(){this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn));return this._decryptdata},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"endProgramDateTime",{get:function(){return t.isFinite(this.programDateTime)?this.programDateTime+1e3*(t.isFinite(this.duration)?this.duration:0):null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0});e.prototype.addElementaryStream=function(t){this._elementaryStreams[t]=!0};e.prototype.hasElementaryStream=function(t){return!0===this._elementaryStreams[t]};e.prototype.createInitializationVector=function(t){for(var e=new Uint8Array(16),r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e};e.prototype.fragmentDecryptdataFromLevelkey=function(t,e){var r=t;if(t&&t.method&&t.uri&&!t.iv){r=new n.default;r.method=t.method;r.baseuri=t.baseuri;r.reluri=t.reluri;r.iv=this.createInitializationVector(e)}return r};return e}();e.default=a}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/key-loader.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/errors.js"),s=r("./src/utils/logger.js");e.default=function(t){function e(e){var r=t.call(this,e,n.default.KEY_LOADING)||this;r.loaders={};r.decryptkey=null;r.decrypturl=null;return r}i(e,t);e.prototype.destroy=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy()}this.loaders={};a.default.prototype.destroy.call(this)};e.prototype.onKeyLoading=function(t){var e=t.frag,r=e.type,i=this.loaders[r],a=e.decryptdata,o=a.uri;if(o!==this.decrypturl||null===this.decryptkey){var l=this.hls.config;if(i){s.logger.warn("abort previous key loader for type:"+r);i.abort()}e.loader=this.loaders[r]=new l.loader(l);this.decrypturl=o;this.decryptkey=null;var c=void 0,u=void 0,d=void 0;c={url:o,frag:e,responseType:"arraybuffer"};u={timeout:l.fragLoadingTimeOut,maxRetry:0,retryDelay:l.fragLoadingRetryDelay,maxRetryDelay:l.fragLoadingMaxRetryTimeout};d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};e.loader.load(c,u,d)}else if(this.decryptkey){a.key=this.decryptkey;this.hls.trigger(n.default.KEY_LOADED,{frag:e})}};e.prototype.loadsuccess=function(t,e,r){var i=r.frag;this.decryptkey=i.decryptdata.key=new Uint8Array(t.data);i.loader=void 0;this.loaders[i.type]=void 0;this.hls.trigger(n.default.KEY_LOADED,{frag:i})};e.prototype.loaderror=function(t,e){var r=e.frag,i=r.loader;i&&i.abort();this.loaders[e.type]=void 0;this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:t})};e.prototype.loadtimeout=function(t,e){var r=e.frag,i=r.loader;i&&i.abort();this.loaders[e.type]=void 0;this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})};return e}(a.default)},"./src/loader/level-key.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./node_modules/url-toolkit/src/url-toolkit.js");e.default=function(){function t(){this.method=null;this.key=null;this.iv=null;this._uri=null}Object.defineProperty(t.prototype,"uri",{get:function(){!this._uri&&this.reluri&&(this._uri=i.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0}));return this._uri},enumerable:!0,configurable:!0});return t}()},"./src/loader/level.js":function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function e(t){this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=!0;this.needSidxRanges=!1;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=t;this.version=null}Object.defineProperty(e.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!t.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0});return e}();e.default=r}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/m3u8-parser.js":function(t,e,r){"use strict";(function(t){function i(t,e){for(var r=t[e],i=e-1;i>=0;i--){var n=t[i];n.programDateTime=r.programDateTime-1e3*n.duration;r=n}}function n(e,r){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):r&&r.programDateTime&&(e.programDateTime=r.endProgramDateTime);if(!t.isFinite(e.programDateTime)){e.programDateTime=null;e.rawProgramDateTime=null}}Object.defineProperty(e,"__esModule",{value:!0});var a=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/loader/fragment.js"),s=r("./src/loader/level.js"),l=r("./src/loader/level-key.js"),c=r("./src/utils/attr-list.js"),u=r("./src/utils/logger.js"),d=r("./src/utils/codecs.js"),h=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,f=/#EXT-X-MEDIA:(.*)/g,p=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),g=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,y=/\.(mp4|m4s|m4v|m4a)$/i,v=function(){function e(){}e.findGroup=function(t,e){if(!t)return null;for(var r=null,i=0;i<t.length;i++){var n=t[i];n.id===e&&(r=n)}return r};e.convertAVC1ToAVCOTI=function(t){var e,r=t.split(".");if(r.length>2){e=r.shift()+".";e+=parseInt(r.shift()).toString(16);e+=("000"+parseInt(r.shift()).toString(16)).substr(-4)}else e=t;return e};e.resolve=function(t,e){return a.buildAbsoluteURL(e,t,{alwaysNormalize:!0})};e.parseMasterPlaylist=function(t,r){var i,n=[];h.lastIndex=0;for(;null!=(i=h.exec(t));){var a={},o=a.attrs=new c.default(i[1]);a.url=e.resolve(i[2],r);var s=o.decimalResolution("RESOLUTION");if(s){a.width=s.width;a.height=s.height}a.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH");a.name=o.NAME;!function(t,e){["video","audio"].forEach(function(r){var i=t.filter(function(t){return d.isCodecType(t,r)});if(i.length){var n=i.filter(function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)});e[r+"Codec"]=n.length>0?n[0]:i[0];t=t.filter(function(t){return-1===i.indexOf(t)})}});e.unknownCodecs=t}([].concat((o.CODECS||"").split(/[ ,]+/)),a);a.videoCodec&&-1!==a.videoCodec.indexOf("avc1")&&(a.videoCodec=e.convertAVC1ToAVCOTI(a.videoCodec));n.push(a)}return n};e.parseMasterPlaylistMedia=function(t,r,i,n){void 0===n&&(n=[]);var a,o=[],s=0;f.lastIndex=0;for(;null!==(a=f.exec(t));){var l={},u=new c.default(a[1]);if(u.TYPE===i){l.groupId=u["GROUP-ID"];l.name=u.NAME;l.type=i;l.default="YES"===u.DEFAULT;l.autoselect="YES"===u.AUTOSELECT;l.forced="YES"===u.FORCED;u.URI&&(l.url=e.resolve(u.URI,r));l.lang=u.LANGUAGE;l.name||(l.name=l.lang);if(n.length){var d=e.findGroup(n,l.groupId);l.audioCodec=d?d.codec:n[0].codec}l.id=s++;o.push(l)}}return o};e.parseLevelPlaylist=function(e,r,a,d,h){var f,v,m=0,b=0,E=new s.default(r),_=new l.default,S=0,T=null,w=new o.default,O=null;p.lastIndex=0;for(;null!==(f=p.exec(e));){var A=f[1];if(A){w.duration=parseFloat(A);var C=(" "+f[2]).slice(1);w.title=C||null;w.tagList.push(C?["INF",A,C]:["INF",A])}else if(f[3]){if(t.isFinite(w.duration)){var R=m++;w.type=d;w.start=b;w.levelkey=_;w.sn=R;w.level=a;w.cc=S;w.urlId=h;w.baseurl=r;w.relurl=(" "+f[3]).slice(1);n(w,T);E.fragments.push(w);T=w;b+=w.duration;w=new o.default}}else if(f[4]){w.rawByteRange=(" "+f[4]).slice(1);if(T){var L=T.byteRangeEndOffset;L&&(w.lastByteRangeEndOffset=L)}}else if(f[5]){w.rawProgramDateTime=(" "+f[5]).slice(1);w.tagList.push(["PROGRAM-DATE-TIME",w.rawProgramDateTime]);null===O&&(O=E.fragments.length)}else{f=f[0].match(g);for(v=1;v<f.length&&void 0===f[v];v++);var k=(" "+f[v+1]).slice(1),D=(" "+f[v+2]).slice(1);switch(f[v]){case"#":w.tagList.push(D?[k,D]:[k]);break;case"PLAYLIST-TYPE":E.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":m=E.startSN=parseInt(k);break;case"TARGETDURATION":E.targetduration=parseFloat(k);break;case"VERSION":E.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":E.live=!1;break;case"DIS":S++;w.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":S=parseInt(k);break;case"KEY":var x=k,P=new c.default(x),I=P.enumeratedString("METHOD"),j=P.URI,F=P.hexadecimalInteger("IV");if(I){_=new l.default;if(j&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(I)>=0){_.method=I;_.baseuri=r;_.reluri=j;_.key=null;_.iv=F}}break;case"START":var M=k,N=new c.default(M),U=N.decimalFloatingPoint("TIME-OFFSET");t.isFinite(U)&&(E.startTimeOffset=U);break;case"MAP":var B=new c.default(k);w.relurl=B.URI;w.rawByteRange=B.BYTERANGE;w.baseurl=r;w.level=a;w.type=d;w.sn="initSegment";E.initSegment=w;w=new o.default;w.rawProgramDateTime=E.initSegment.rawProgramDateTime;break;default:u.logger.warn("line parsed but not handled: "+f)}}}w=T;if(w&&!w.relurl){E.fragments.pop();b-=w.duration}E.totalduration=b;E.averagetargetduration=b/E.fragments.length;E.endSN=m-1;E.startCC=E.fragments[0]?E.fragments[0].cc:0;E.endCC=S;if(!E.initSegment&&E.fragments.length&&E.fragments.every(function(t){return y.test(t.relurl)})){u.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX");w=new o.default;w.relurl=E.fragments[0].relurl;w.baseurl=r;w.level=a;w.type=d;w.sn="initSegment";E.initSegment=w;E.needSidxRanges=!0}O&&i(E.fragments,O);return E};return e}();e.default=v}).call(this,r("./src/polyfills/number.js").Number)},"./src/loader/playlist-loader.js":function(t,e,r){"use strict";(function(t){var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/events.js"),a=r("./src/event-handler.js"),o=r("./src/errors.js"),s=r("./src/utils/logger.js"),l=r("./src/demux/mp4demuxer.js"),c=r("./src/loader/m3u8-parser.js"),u=window.performance,d={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},h={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},f=function(e){function r(t){var r=e.call(this,t,n.default.MANIFEST_LOADING,n.default.LEVEL_LOADING,n.default.AUDIO_TRACK_LOADING,n.default.SUBTITLE_TRACK_LOADING)||this;r.loaders={};return r}i(r,e);Object.defineProperty(r,"ContextType",{get:function(){return d},enumerable:!0,configurable:!0});Object.defineProperty(r,"LevelType",{get:function(){return h},enumerable:!0,configurable:!0});r.canHaveQualityLevels=function(t){return t!==d.AUDIO_TRACK&&t!==d.SUBTITLE_TRACK};r.mapContextToLevelType=function(t){switch(t.type){case d.AUDIO_TRACK:return h.AUDIO;case d.SUBTITLE_TRACK:return h.SUBTITLE;default:return h.MAIN}};r.getResponseUrl=function(t,e){var r=t.url;void 0!==r&&0!==r.indexOf("data:")||(r=e.url);return r};r.prototype.createInternalLoader=function(t){var e=this.hls.config,r=e.pLoader,i=e.loader,n=r||i,a=new n(e);t.loader=a;this.loaders[t.type]=a;return a};r.prototype.getInternalLoader=function(t){return this.loaders[t.type]};r.prototype.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]};r.prototype.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy();this.resetInternalLoader(t)}};r.prototype.destroy=function(){this.destroyInternalLoaders();e.prototype.destroy.call(this)};r.prototype.onManifestLoading=function(t){this.load(t.url,{type:d.MANIFEST,level:0,id:null})};r.prototype.onLevelLoading=function(t){this.load(t.url,{type:d.LEVEL,level:t.level,id:t.id})};r.prototype.onAudioTrackLoading=function(t){this.load(t.url,{type:d.AUDIO_TRACK,level:null,id:t.id})};r.prototype.onSubtitleTrackLoading=function(t){this.load(t.url,{type:d.SUBTITLE_TRACK,level:null,id:t.id})};r.prototype.load=function(t,e){var r=this.hls.config;s.logger.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var i=this.getInternalLoader(e);if(i){var n=i.context;if(n&&n.url===t){s.logger.trace("playlist request ongoing");return!1}s.logger.warn("aborting previous loader for type: "+e.type);i.abort()}var a,o,l,c;switch(e.type){case d.MANIFEST:a=r.manifestLoadingMaxRetry;o=r.manifestLoadingTimeOut;l=r.manifestLoadingRetryDelay;c=r.manifestLoadingMaxRetryTimeout;break;case d.LEVEL:a=0;o=r.levelLoadingTimeOut;break;default:a=r.levelLoadingMaxRetry;o=r.levelLoadingTimeOut;l=r.levelLoadingRetryDelay;c=r.levelLoadingMaxRetryTimeout}i=this.createInternalLoader(e);e.url=t;e.responseType=e.responseType||"";var u={timeout:o,maxRetry:a,retryDelay:l,maxRetryDelay:c},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};s.logger.debug("Calling internal loader delegate for URL: "+t);i.load(e,u,h);return!0};r.prototype.loadsuccess=function(t,e,r,i){void 0===i&&(i=null);if(r.isSidxRequest){this._handleSidxRequest(t,r);this._handlePlaylistLoaded(t,e,r,i)}else{this.resetInternalLoader(r.type);var n=t.data;e.tload=u.now();0===n.indexOf("#EXTM3U")?n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(t,e,r,i):this._handleMasterPlaylist(t,e,r,i):this._handleManifestParsingError(t,r,"no EXTM3U delimiter",i)}};r.prototype.loaderror=function(t,e,r){void 0===r&&(r=null);this._handleNetworkError(e,r,!1,t)};r.prototype.loadtimeout=function(t,e,r){void 0===r&&(r=null);this._handleNetworkError(e,r,!0)};r.prototype._handleMasterPlaylist=function(t,e,i,a){var o=this.hls,l=t.data,u=r.getResponseUrl(t,i),d=c.default.parseMasterPlaylist(l,u);if(d.length){var h=d.map(function(t){return{id:t.attrs.AUDIO,codec:t.audioCodec}}),f=c.default.parseMasterPlaylistMedia(l,u,"AUDIO",h),p=c.default.parseMasterPlaylistMedia(l,u,"SUBTITLES");if(f.length){var g=!1;f.forEach(function(t){t.url||(g=!0)});if(!1===g&&d[0].audioCodec&&!d[0].attrs.AUDIO){s.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one");f.unshift({type:"main",name:"main"})}}o.trigger(n.default.MANIFEST_LOADED,{levels:d,audioTracks:f,subtitles:p,url:u,stats:e,networkDetails:a})}else this._handleManifestParsingError(t,i,"no level found in manifest",a)};r.prototype._handleTrackOrLevelPlaylist=function(e,i,a,o){var s=this.hls,l=a.id,h=a.level,f=a.type,p=r.getResponseUrl(e,a),g=t.isFinite(l)?l:0,y=t.isFinite(h)?h:g,v=r.mapContextToLevelType(a),m=c.default.parseLevelPlaylist(e.data,p,y,v,g);m.tload=i.tload;if(f===d.MANIFEST){s.trigger(n.default.MANIFEST_LOADED,{levels:[{url:p,details:m}],audioTracks:[],url:p,stats:i,networkDetails:o})}i.tparsed=u.now();if(m.needSidxRanges){this.load(m.initSegment.url,{isSidxRequest:!0,type:f,level:h,levelDetails:m,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else{a.levelDetails=m;this._handlePlaylistLoaded(e,i,a,o)}};r.prototype._handleSidxRequest=function(t,e){var r=l.default.parseSegmentIndex(new Uint8Array(t.data));if(r){var i=r.references,n=e.levelDetails;i.forEach(function(t,e){var r=t.info,i=n.fragments[e];0===i.byteRange.length&&(i.rawByteRange=String(1+r.end-r.start)+"@"+String(r.start))});n.initSegment.rawByteRange=String(r.moovEndOffset)+"@0"}};r.prototype._handleManifestParsingError=function(t,e,r,i){this.hls.trigger(n.default.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:r,networkDetails:i})};r.prototype._handleNetworkError=function(t,e,r,i){void 0===r&&(r=!1);void 0===i&&(i=null);s.logger.info("A network error occured while loading a "+t.type+"-type playlist");var a,l,c=this.getInternalLoader(t);switch(t.type){case d.MANIFEST:a=r?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR;l=!0;break;case d.LEVEL:a=r?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR;l=!1;break;case d.AUDIO_TRACK:a=r?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR;l=!1;break;default:l=!1}if(c){c.abort();this.resetInternalLoader(t.type)}var u={type:o.ErrorTypes.NETWORK_ERROR,details:a,fatal:l,url:c.url,loader:c,context:t,networkDetails:e};i&&(u.response=i);this.hls.trigger(n.default.ERROR,u)};r.prototype._handlePlaylistLoaded=function(t,e,i,a){var o=i.type,s=i.level,l=i.id,c=i.levelDetails;if(c.targetduration){if(r.canHaveQualityLevels(i.type))this.hls.trigger(n.default.LEVEL_LOADED,{details:c,level:s||0,id:l||0,stats:e,networkDetails:a});else switch(o){case d.AUDIO_TRACK:this.hls.trigger(n.default.AUDIO_TRACK_LOADED,{details:c,id:l,stats:e,networkDetails:a});break;case d.SUBTITLE_TRACK:this.hls.trigger(n.default.SUBTITLE_TRACK_LOADED,{details:c,id:l,stats:e,networkDetails:a})}}else this._handleManifestParsingError(t,i,"invalid target duration",a)};return r}(a.default);e.default=f}).call(this,r("./src/polyfills/number.js").Number)},"./src/observer.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./node_modules/eventemitter3/index.js");e.Observer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}i(e,t);e.prototype.trigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.emit.apply(this,[t,t].concat(e))};return e}(n.EventEmitter)},"./src/polyfills/number.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/get-self-scope.js"),n=i.getSelfScope(),a=n.Number;e.Number=a;a.isFinite=a.isFinite||function(t){return"number"==typeof t&&isFinite(t)}},"./src/remux/aac-helper.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){function t(){}t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null};return t}()},"./src/remux/mp4-generator.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Math.pow(2,32)-1;e.default=function(){function t(){}t.init=function(){t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var e;for(e in t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);t.HDLR_TYPES={video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);t.STTS=t.STSC=t.STCO=new Uint8Array([0,0,0,0,0,0,0,0]);t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var i=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]);t.FTYP=t.box(t.types.ftyp,i,new Uint8Array([0,0,0,1]),i,n);t.DINF=t.box(t.types.dinf,t.box(t.types.dref,r))};t.box=function(t){for(var e,r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,a=n;n--;)i+=r[n].byteLength;e=new Uint8Array(i);e[0]=i>>24&255;e[1]=i>>16&255;e[2]=i>>8&255;e[3]=255&i;e.set(t,4);for(n=0,i=8;n<a;n++){e.set(r[n],i);i+=r[n].byteLength}return e};t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])};t.mdat=function(e){return t.box(t.types.mdat,e)};t.mdhd=function(e,r){r*=e;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))};t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))};t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))};t.minf=function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))};t.moof=function(e,r,i){return t.box(t.types.moof,t.mfhd(e),t.traf(i,r))};t.moov=function(e){for(var r=e.length,i=[];r--;)i[r]=t.trak(e[r]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(t.mvex(e)))};t.mvex=function(e){for(var r=e.length,i=[];r--;)i[r]=t.trex(e[r]);return t.box.apply(null,[t.types.mvex].concat(i))};t.mvhd=function(e,r){r*=e;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1));return t.box(t.types.mvhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))};t.sdtp=function(e){var r,i,n=e.samples||[],a=new Uint8Array(4+n.length);for(i=0;i<n.length;i++){r=n[i].flags;a[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy}return t.box(t.types.sdtp,a)};t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))};t.avc1=function(e){var r,i,n,a=[],o=[];for(r=0;r<e.sps.length;r++){i=e.sps[r];n=i.byteLength;a.push(n>>>8&255);a.push(255&n);a=a.concat(Array.prototype.slice.call(i))}for(r=0;r<e.pps.length;r++){i=e.pps[r];n=i.byteLength;o.push(n>>>8&255);o.push(255&n);o=o.concat(Array.prototype.slice.call(i))}var s=t.box(t.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(o))),l=e.width,c=e.height,u=e.pixelRatio[0],d=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,d>>24,d>>16&255,d>>8&255,255&d])))};t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))};t.mp4a=function(e){var r=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),t.box(t.types.esds,t.esds(e)))};t.mp3=function(e){var r=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))};t.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.mp3(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))};t.tkhd=function(e){var r=e.id,n=e.duration*e.timescale,a=e.width,o=e.height,s=Math.floor(n/(i+1)),l=Math.floor(n%(i+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,o>>8&255,255&o,0,0]))};t.traf=function(e,r){var n=t.sdtp(e),a=e.id,o=Math.floor(r/(i+1)),s=Math.floor(r%(i+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),t.trun(e,n.length+16+20+8+16+8+8),n)};t.trak=function(e){e.duration=e.duration||4294967295;return t.box(t.types.trak,t.tkhd(e),t.mdia(e))};t.trex=function(e){var r=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))};t.trun=function(e,r){var i,n,a,o,s,l,c=e.samples||[],u=c.length,d=12+16*u,h=new Uint8Array(d);r+=8+d;h.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0);for(i=0;i<u;i++){n=c[i];a=n.duration;o=n.size;s=n.flags;l=n.cts;h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i)}return t.box(t.types.trun,h)};t.initSegment=function(e){t.types||t.init();var r,i=t.moov(e);r=new Uint8Array(t.FTYP.byteLength+i.byteLength);r.set(t.FTYP);r.set(i,t.FTYP.byteLength);return r};return t}()},"./src/remux/mp4-remuxer.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/remux/aac-helper.js"),n=r("./src/remux/mp4-generator.js"),a=r("./src/events.js"),o=r("./src/errors.js"),s=r("./src/utils/logger.js");e.default=function(){function t(t,e,r,i){this.observer=t;this.config=e;this.typeSupported=r;var n=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&n&&!n.match("CriOS");this.ISGenerated=!1}t.prototype.destroy=function(){};t.prototype.resetTimeStamp=function(t){this._initPTS=this._initDTS=t};t.prototype.resetInitSegment=function(){this.ISGenerated=!1};t.prototype.remux=function(t,e,r,i,n,o,l){this.ISGenerated||this.generateIS(t,e,n);if(this.ISGenerated){var c=t.samples.length,u=e.samples.length,d=n,h=n;if(c&&u){var f=(t.samples[0].pts-e.samples[0].pts)/e.inputTimeScale;d+=Math.max(0,f);h+=Math.max(0,-f)}if(c){if(!t.timescale){s.logger.warn("regenerate InitSegment as audio detected");this.generateIS(t,e,n)}var p=this.remuxAudio(t,d,o,l);if(u){var g=void 0;p&&(g=p.endPTS-p.startPTS);if(!e.timescale){s.logger.warn("regenerate InitSegment as video detected");this.generateIS(t,e,n)}this.remuxVideo(e,h,o,g,l)}}else if(u){var y=this.remuxVideo(e,h,o,0,l);y&&t.codec&&this.remuxEmptyAudio(t,d,o,y)}}r.samples.length&&this.remuxID3(r,n);i.samples.length&&this.remuxText(i,n);this.observer.trigger(a.default.FRAG_PARSED)};t.prototype.generateIS=function(t,e,r){var i,l,c=this.observer,u=t.samples,d=e.samples,h=this.typeSupported,f="audio/mp4",p={},g={tracks:p},y=void 0===this._initPTS;y&&(i=l=1/0);if(t.config&&u.length){t.timescale=t.samplerate;s.logger.log("audio sampling rate : "+t.samplerate);if(!t.isAAC)if(h.mpeg){f="audio/mpeg";t.codec=""}else h.mp3&&(t.codec="mp3");p.audio={container:f,codec:t.codec,initSegment:!t.isAAC&&h.mpeg?new Uint8Array:n.default.initSegment([t]),metadata:{channelCount:t.channelCount}};y&&(i=l=u[0].pts-t.inputTimeScale*r)}if(e.sps&&e.pps&&d.length){var v=e.inputTimeScale;e.timescale=v;p.video={container:"video/mp4",codec:e.codec,initSegment:n.default.initSegment([e]),metadata:{width:e.width,height:e.height}};if(y){i=Math.min(i,d[0].pts-v*r);l=Math.min(l,d[0].dts-v*r);this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:i})}}if(Object.keys(p).length){c.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,g);this.ISGenerated=!0;if(y){this._initPTS=i;this._initDTS=l}}else c.trigger(a.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})};t.prototype.remuxVideo=function(t,e,r,i,l){var c,u,d,h,f,p,g,y=8,v=t.timescale,m=t.samples,b=[],E=m.length,_=this._PTSNormalize,S=this._initPTS,T=this.nextAvcDts,w=this.isSafari;if(0!==E){w&&(r|=m.length&&T&&(l&&Math.abs(e-T/v)<.1||Math.abs(m[0].pts-T-S)<v/5));r||(T=e*v);m.forEach(function(t){t.pts=_(t.pts-S,T);t.dts=_(t.dts-S,T)});m.sort(function(t,e){var r=t.dts-e.dts,i=t.pts-e.pts;return r||i||t.id-e.id});var O=m.reduce(function(t,e){return Math.max(Math.min(t,e.pts-e.dts),-18e3)},0);if(O<0){s.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(O/90)+" ms to overcome this issue");for(var A=0;A<m.length;A++)m[A].dts+=O}var C=m[0];f=Math.max(C.dts,0);h=Math.max(C.pts,0);var R=Math.round((f-T)/90);if(r&&R){R>1?s.logger.log("AVC:"+R+" ms hole between fragments detected,filling it"):R<-1&&s.logger.log("AVC:"+-R+" ms overlapping between fragments detected");f=T;m[0].dts=f;h=Math.max(h-R,T);m[0].pts=h;s.logger.log("Video/PTS/DTS adjusted: "+Math.round(h/90)+"/"+Math.round(f/90)+",delta:"+R+" ms")}C=m[m.length-1];g=Math.max(C.dts,0);p=Math.max(C.pts,0,g);w&&(c=Math.round((g-f)/(m.length-1)));for(var L=0,k=0,A=0;A<E;A++){for(var D=m[A],x=D.units,P=x.length,I=0,j=0;j<P;j++)I+=x[j].data.length;k+=I;L+=P;D.length=I;D.dts=w?f+A*c:Math.max(D.dts,f);D.pts=Math.max(D.pts,D.dts)}var F=k+4*L+8;try{u=new Uint8Array(F)}catch(t){this.observer.trigger(a.default.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating video mdat "+F});return}var M=new DataView(u.buffer);M.setUint32(0,F);u.set(n.default.types.mdat,4);for(var A=0;A<E;A++){for(var N=m[A],U=N.units,B=0,V=void 0,j=0,P=U.length;j<P;j++){var G=U[j],H=G.data,q=G.data.byteLength;M.setUint32(y,q);y+=4;u.set(H,y);y+=q;B+=4+q}if(w)V=Math.max(0,c*Math.round((N.pts-N.dts)/c));else{if(A<E-1)c=m[A+1].dts-N.dts;else{var W=this.config,Y=N.dts-m[A>0?A-1:A].dts;if(W.stretchShortVideoTrack){var z=W.maxBufferHole,K=Math.floor(z*v),Q=(i?h+i*v:this.nextAudioPts)-N.pts;if(Q>K){c=Q-Y;c<0&&(c=Y);s.logger.log("It is approximately "+Q/90+" ms to the next segment; using duration "+c/90+" ms for the last video frame.")}else c=Y}else c=Y}V=Math.round(N.pts-N.dts)}b.push({size:B,duration:c,cts:V,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:N.key?2:1,isNonSync:N.key?0:1}})}this.nextAvcDts=g+c;var X=t.dropped;t.len=0;t.nbNalu=0;t.dropped=0;if(b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var Z=b[0].flags;Z.dependsOn=2;Z.isNonSync=0}t.samples=b;d=n.default.moof(t.sequenceNumber++,f,t);t.samples=[];var J={data1:d,data2:u,startPTS:h/v,endPTS:(p+c)/v,startDTS:f/v,endDTS:this.nextAvcDts/v,type:"video",hasAudio:!1,hasVideo:!0,nb:b.length,dropped:X};this.observer.trigger(a.default.FRAG_PARSING_DATA,J);return J}};t.prototype.remuxAudio=function(t,e,r,l){var c,u,d,h,f,p,g,y=t.inputTimeScale,v=t.timescale,m=y/v,b=t.isAAC?1024:1152,E=b*m,_=this._PTSNormalize,S=this._initPTS,T=!t.isAAC&&this.typeSupported.mpeg,w=t.samples,O=[],A=this.nextAudioPts;r|=w.length&&A&&(l&&Math.abs(e-A/y)<.1||Math.abs(w[0].pts-A-S)<20*E);w.forEach(function(t){t.pts=t.dts=_(t.pts-S,e*y)});w=w.filter(function(t){return t.pts>=0});if(0!==w.length){r||(A=l?e*y:w[0].pts);if(t.isAAC)for(var C=this.config.maxAudioFramesDrift,R=0,L=A;R<w.length;){var k,D=w[R],x=D.pts;k=x-L;var P=Math.abs(1e3*k/y);if(k<=-C*E){s.logger.warn("Dropping 1 audio frame @ "+(L/y).toFixed(3)+"s due to "+Math.round(P)+" ms overlap.");w.splice(R,1);t.len-=D.unit.length}else if(k>=C*E&&P<1e4&&L){var I=Math.round(k/E);s.logger.warn("Injecting "+I+" audio frame @ "+(L/y).toFixed(3)+"s due to "+Math.round(1e3*k/y)+" ms gap.");for(var j=0;j<I;j++){var F=Math.max(L,0);d=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!d){s.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead.");d=D.unit.subarray()}w.splice(R,0,{unit:d,pts:F,dts:F});t.len+=d.length;L+=E;R++}D.pts=D.dts=L;L+=E;R++}else{Math.abs(k);D.pts=D.dts=L;L+=E;R++}}for(var j=0,M=w.length;j<M;j++){var N=w[j],U=N.unit,x=N.pts;if(void 0!==g)u.duration=Math.round((x-g)/m);else{var B=Math.round(1e3*(x-A)/y),V=0;if(r&&t.isAAC&&B){if(B>0&&B<1e4){V=Math.round((x-A)/E);s.logger.log(B+" ms hole between AAC samples detected,filling it");if(V>0){d=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);d||(d=U.subarray());t.len+=V*d.length}}else if(B<-12){s.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(A/y).toFixed(3)+"s/"+(x/y).toFixed(3)+"s/"+-B+"ms");t.len-=U.byteLength;continue}x=A}p=x;if(!(t.len>0))return;var G=T?t.len:t.len+8;c=T?0:8;try{h=new Uint8Array(G)}catch(t){this.observer.trigger(a.default.ERROR,{type:o.ErrorTypes.MUX_ERROR,details:o.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:G,reason:"fail allocating audio mdat "+G});return}if(!T){new DataView(h.buffer).setUint32(0,G);h.set(n.default.types.mdat,4)}for(var R=0;R<V;R++){d=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!d){s.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead.");d=U.subarray()}h.set(d,c);c+=d.byteLength;u={size:d.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};O.push(u)}}h.set(U,c);var H=U.byteLength;c+=H;u={size:H,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};O.push(u);g=x}var q=0,W=O.length;if(W>=2){q=O[W-2].duration;u.duration=q}if(W){this.nextAudioPts=A=g+m*q;t.len=0;t.samples=O;f=T?new Uint8Array:n.default.moof(t.sequenceNumber++,p/m,t);t.samples=[];var Y=p/y,z=A/y,K={data1:f,data2:h,startPTS:Y,endPTS:z,startDTS:Y,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:W};this.observer.trigger(a.default.FRAG_PARSING_DATA,K);return K}return null}};t.prototype.remuxEmptyAudio=function(t,e,r,n){var a=t.inputTimeScale,o=t.samplerate?t.samplerate:a,l=a/o,c=this.nextAudioPts,u=(void 0!==c?c:n.startDTS*a)+this._initDTS,d=n.endDTS*a+this._initDTS,h=1024*l,f=Math.ceil((d-u)/h),p=i.default.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);s.logger.warn("remux empty Audio");if(p){for(var g=[],y=0;y<f;y++){var v=u+y*h;g.push({unit:p,pts:v,dts:v});t.len+=p.length}t.samples=g;this.remuxAudio(t,e,r)}else s.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")};t.prototype.remuxID3=function(t){var e,r=t.samples.length,i=t.inputTimeScale,n=this._initPTS,o=this._initDTS;if(r){for(var s=0;s<r;s++){e=t.samples[s];e.pts=(e.pts-n)/i;e.dts=(e.dts-o)/i}this.observer.trigger(a.default.FRAG_PARSING_METADATA,{samples:t.samples})}t.samples=[]};t.prototype.remuxText=function(t){t.samples.sort(function(t,e){return t.pts-e.pts});var e,r=t.samples.length,i=t.inputTimeScale,n=this._initPTS;if(r){for(var o=0;o<r;o++){e=t.samples[o];e.pts=(e.pts-n)/i}this.observer.trigger(a.default.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[]};t.prototype._PTSNormalize=function(t,e){var r;if(void 0===e)return t;r=e<t?-8589934592:8589934592;for(;Math.abs(t-e)>4294967296;)t+=r;return t};return t}()},"./src/remux/passthrough-remuxer.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/events.js");e.default=function(){function t(t){this.observer=t}t.prototype.destroy=function(){};t.prototype.resetTimeStamp=function(){};t.prototype.resetInitSegment=function(){};t.prototype.remux=function(t,e,r,n,a,o,s,l){var c=this.observer,u="";t&&(u+="audio");e&&(u+="video");c.trigger(i.default.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:u,hasAudio:!!t,hasVideo:!!e,nb:1,dropped:0});c.trigger(i.default.FRAG_PARSED)};return t}()},"./src/task-loop.js":function(t,e,r){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function i(){this.constructor=e}t(e,r);e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/event-handler.js");e.default=function(t){function e(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var n=t.apply(this,[e].concat(r))||this;n._tickInterval=null;n._tickTimer=null;n._tickCallCount=0;n._boundTick=n.tick.bind(n);return n}i(e,t);e.prototype.onHandlerDestroying=function(){this.clearNextTick();this.clearInterval()};e.prototype.hasInterval=function(){return!!this._tickInterval};e.prototype.hasNextTick=function(){return!!this._tickTimer};e.prototype.setInterval=function(t){if(!this._tickInterval){this._tickInterval=setInterval(this._boundTick,t);return!0}return!1};e.prototype.clearInterval=function(){if(this._tickInterval){clearInterval(this._tickInterval);this._tickInterval=null;return!0}return!1};e.prototype.clearNextTick=function(){if(this._tickTimer){clearTimeout(this._tickTimer);this._tickTimer=null;return!0}return!1};e.prototype.tick=function(){this._tickCallCount++;if(1===this._tickCallCount){this.doTick();if(this._tickCallCount>1){this.clearNextTick();this._tickTimer=setTimeout(this._boundTick,0)}this._tickCallCount=0}};e.prototype.doTick=function(){};return e}(n.default)},"./src/utils/attr-list.js":function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,n=function(){function e(t){"string"==typeof t&&(t=e.parseAttrList(t));for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r])}e.prototype.decimalInteger=function(e){var r=parseInt(this[e],10);return r>t.MAX_SAFE_INTEGER?1/0:r};e.prototype.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var r=new Uint8Array(e.length/2),i=0;i<e.length/2;i++)r[i]=parseInt(e.slice(2*i,2*i+2),16);return r}return null};e.prototype.hexadecimalIntegerAsNumber=function(e){var r=parseInt(this[e],16);return r>t.MAX_SAFE_INTEGER?1/0:r};e.prototype.decimalFloatingPoint=function(t){return parseFloat(this[t])};e.prototype.enumeratedString=function(t){return this[t]};e.prototype.decimalResolution=function(t){var e=r.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}};e.parseAttrList=function(t){var e,r={};i.lastIndex=0;for(;null!==(e=i.exec(t));){var n=e[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1));r[e[1]]=n}return r};return e}();e.default=n}).call(this,r("./src/polyfills/number.js").Number)},"./src/utils/binary-search.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={search:function(t,e){for(var r=0,i=t.length-1,n=null,a=null;r<=i;){n=(r+i)/2|0;a=t[n];var o=e(a);if(o>0)r=n+1;else{if(!(o<0))return a;i=n-1}}return null}}},"./src/utils/buffer-helper.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.BufferHelper=function(){function t(){}t.isBuffered=function(t,e){try{if(t)for(var r=t.buffered,i=0;i<r.length;i++)if(e>=r.start(i)&&e<=r.end(i))return!0}catch(t){}return!1};t.bufferInfo=function(t,e,r){try{if(t){var i=t.buffered,n=[],a=void 0;for(a=0;a<i.length;a++)n.push({start:i.start(a),end:i.end(a)});return this.bufferedInfo(n,e,r)}}catch(t){}return{len:0,start:e,end:e,nextStart:void 0}};t.bufferedInfo=function(t,e,r){var i,n,a,o,s,l=[];t.sort(function(t,e){var r=t.start-e.start;return r||e.end-t.end});for(s=0;s<t.length;s++){var c=l.length;if(c){var u=l[c-1].end;t[s].start-u<r?t[s].end>u&&(l[c-1].end=t[s].end):l.push(t[s])}else l.push(t[s])}for(s=0,i=0,n=a=e;s<l.length;s++){var d=l[s].start,h=l[s].end;if(e+r>=d&&e<h){n=d;a=h;i=a-e}else if(e+r<d){o=d;break}}return{len:i,start:n,end:a,nextStart:o}};return t}()},"./src/utils/cea-608-parser.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(t){var e=t;i.hasOwnProperty(t)&&(e=i[t]);return String.fromCharCode(e)},a=15,o=100,s={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},l={17:2,18:4,21:6,22:8,23:10,19:13,20:15},c={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},d=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(t){this.time=t},log:function(t,e){}},f=function(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r].toString(16));return e},p=function(){function t(t,e,r,i,n){this.foreground=t||"white";this.underline=e||!1;this.italics=r||!1;this.background=i||"black";this.flash=n||!1}t.prototype.reset=function(){this.foreground="white";this.underline=!1;this.italics=!1;this.background="black";this.flash=!1};t.prototype.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],r=0;r<e.length;r++){var i=e[r];t.hasOwnProperty(i)&&(this[i]=t[i])}};t.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash};t.prototype.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash};t.prototype.copy=function(t){this.foreground=t.foreground;this.underline=t.underline;this.italics=t.italics;this.background=t.background;this.flash=t.flash};t.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash};return t}(),g=function(){function t(t,e,r,i,n,a){this.uchar=t||" ";this.penState=new p(e,r,i,n,a)}t.prototype.reset=function(){this.uchar=" ";this.penState.reset()};t.prototype.setChar=function(t,e){this.uchar=t;this.penState.copy(e)};t.prototype.setPenState=function(t){this.penState.copy(t)};t.prototype.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)};t.prototype.copy=function(t){this.uchar=t.uchar;this.penState.copy(t.penState)};t.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()};return t}(),y=function(){function t(){this.chars=[];for(var t=0;t<o;t++)this.chars.push(new g);this.pos=0;this.currPenState=new p}t.prototype.equals=function(t){for(var e=!0,r=0;r<o;r++)if(!this.chars[r].equals(t.chars[r])){e=!1;break}return e};t.prototype.copy=function(t){for(var e=0;e<o;e++)this.chars[e].copy(t.chars[e])};t.prototype.isEmpty=function(){for(var t=!0,e=0;e<o;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t};t.prototype.setCursor=function(t){this.pos!==t&&(this.pos=t);if(this.pos<0){h.log("ERROR","Negative cursor position "+this.pos);this.pos=0}else if(this.pos>o){h.log("ERROR","Too large cursor position "+this.pos);this.pos=o}};t.prototype.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var r=this.pos+1;r<e+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(e)};t.prototype.backSpace=function(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)};t.prototype.insertChar=function(t){t>=144&&this.backSpace();var e=n(t);if(this.pos>=o)h.log("ERROR","Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!");else{this.chars[this.pos].setChar(e,this.currPenState);this.moveCursor(1)}};t.prototype.clearFromPos=function(t){var e;for(e=t;e<o;e++)this.chars[e].reset()};t.prototype.clear=function(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()};t.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)};t.prototype.getTextString=function(){for(var t=[],e=!0,r=0;r<o;r++){var i=this.chars[r].uchar;" "!==i&&(e=!1);t.push(i)}return e?"":t.join("")};t.prototype.setPenStyles=function(t){this.currPenState.setStyles(t);this.chars[this.pos].setPenState(this.currPenState)};return t}(),v=function(){function t(){this.rows=[];for(var t=0;t<a;t++)this.rows.push(new y);this.currRow=a-1;this.nrRollUpRows=null;this.reset()}t.prototype.reset=function(){for(var t=0;t<a;t++)this.rows[t].clear();this.currRow=a-1};t.prototype.equals=function(t){for(var e=!0,r=0;r<a;r++)if(!this.rows[r].equals(t.rows[r])){e=!1;break}return e};t.prototype.copy=function(t){for(var e=0;e<a;e++)this.rows[e].copy(t.rows[e])};t.prototype.isEmpty=function(){for(var t=!0,e=0;e<a;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t};t.prototype.backSpace=function(){this.rows[this.currRow].backSpace()};t.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()};t.prototype.insertChar=function(t){this.rows[this.currRow].insertChar(t)};t.prototype.setPen=function(t){this.rows[this.currRow].setPenStyles(t)};t.prototype.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)};t.prototype.setCursor=function(t){h.log("INFO","setCursor: "+t);this.rows[this.currRow].setCursor(t)};t.prototype.setPAC=function(t){h.log("INFO","pacData = "+JSON.stringify(t));var e=t.row-1;this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1);if(this.nrRollUpRows&&this.currRow!==e){for(var r=0;r<a;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var o=n.rows[i].cueStartTime;if(o&&o<h.time)for(var r=0;r<this.nrRollUpRows;r++)this.rows[e-this.nrRollUpRows+r+1].copy(n.rows[i+r])}}this.currRow=e;var s=this.rows[this.currRow];if(null!==t.indent){var l=t.indent,c=Math.max(l-1,0);s.setCursor(t.indent);t.color=s.chars[c].penState.foreground}this.setPen({foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1})};t.prototype.setBkgData=function(t){h.log("INFO","bkgData = "+JSON.stringify(t));this.backSpace();this.setPen(t);this.insertChar(32)};t.prototype.setRollUpRows=function(t){this.nrRollUpRows=t};t.prototype.rollUp=function(){if(null!==this.nrRollUpRows){h.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear();this.rows.splice(this.currRow,0,e);h.log("INFO","Rolling up")}else h.log("DEBUG","roll_up but nrRollUpRows not set yet")};t.prototype.getDisplayText=function(t){t=t||!1;for(var e=[],r="",i=-1,n=0;n<a;n++){var o=this.rows[n].getTextString();if(o){i=n+1;e.push(t?"Row "+i+": '"+o+"'":o.trim())}}e.length>0&&(r=t?"["+e.join(" | ")+"]":e.join("\n"));return r};t.prototype.getTextAndFormat=function(){return this.rows};return t}(),m=function(){function t(t,e){this.chNr=t;this.outputFilter=e;this.mode=null;this.verbose=0;this.displayedMemory=new v;this.nonDisplayedMemory=new v;this.lastOutputScreen=new v;this.currRollUpRow=this.displayedMemory.rows[a-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null}t.prototype.reset=function(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.currRollUpRow=this.displayedMemory.rows[a-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null;this.lastCueEndTime=null};t.prototype.getHandler=function(){return this.outputFilter};t.prototype.setHandler=function(t){this.outputFilter=t};t.prototype.setPAC=function(t){this.writeScreen.setPAC(t)};t.prototype.setBkgData=function(t){this.writeScreen.setBkgData(t)};t.prototype.setMode=function(t){if(t!==this.mode){this.mode=t;h.log("INFO","MODE="+t);if("MODE_POP-ON"===this.mode)this.writeScreen=this.nonDisplayedMemory;else{this.writeScreen=this.displayedMemory;this.writeScreen.reset()}if("MODE_ROLL-UP"!==this.mode){this.displayedMemory.nrRollUpRows=null;this.nonDisplayedMemory.nrRollUpRows=null}this.mode=t}};t.prototype.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);h.log("INFO",(this.writeScreen===this.displayedMemory?"DISP":"NON_DISP")+": "+this.writeScreen.getDisplayText(!0));if("MODE_PAINT-ON"===this.mode||"MODE_ROLL-UP"===this.mode){h.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0));this.outputDataUpdate()}};t.prototype.ccRCL=function(){h.log("INFO","RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")};t.prototype.ccBS=function(){h.log("INFO","BS - BackSpace");if("MODE_TEXT"!==this.mode){this.writeScreen.backSpace();this.writeScreen===this.displayedMemory&&this.outputDataUpdate()}};t.prototype.ccAOF=function(){};t.prototype.ccAON=function(){};t.prototype.ccDER=function(){h.log("INFO","DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()};t.prototype.ccRU=function(t){h.log("INFO","RU("+t+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(t)};t.prototype.ccFON=function(){h.log("INFO","FON - Flash On");this.writeScreen.setPen({flash:!0})};t.prototype.ccRDC=function(){h.log("INFO","RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")};t.prototype.ccTR=function(){h.log("INFO","TR");this.setMode("MODE_TEXT")};t.prototype.ccRTD=function(){h.log("INFO","RTD");this.setMode("MODE_TEXT")};t.prototype.ccEDM=function(){h.log("INFO","EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(!0)};t.prototype.ccCR=function(){h.log("CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(!0)};t.prototype.ccENM=function(){h.log("INFO","ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()};t.prototype.ccEOC=function(){h.log("INFO","EOC - End Of Caption");if("MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.nonDisplayedMemory=t;this.writeScreen=this.nonDisplayedMemory;h.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)};t.prototype.ccTO=function(t){h.log("INFO","TO("+t+") - Tab Offset");this.writeScreen.moveCursor(t)};t.prototype.ccMIDROW=function(t){var e={flash:!1};e.underline=t%2==1;e.italics=t>=46;if(e.italics)e.foreground="white";else{e.foreground=["white","green","blue","cyan","red","yellow","magenta"][Math.floor(t/2)-16]}h.log("INFO","MIDROW: "+JSON.stringify(e));this.writeScreen.setPen(e)};t.prototype.outputDataUpdate=function(t){void 0===t&&(t=!1);var e=h.time;if(null!==e&&this.outputFilter){if(null!==this.cueStartTime||this.displayedMemory.isEmpty()){if(!this.displayedMemory.equals(this.lastOutputScreen)){if(this.outputFilter.newCue){this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen);!0===t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()}this.cueStartTime=this.displayedMemory.isEmpty()?null:e}}else this.cueStartTime=e;this.lastOutputScreen.copy(this.displayedMemory)}};t.prototype.cueSplitAtTime=function(t){if(this.outputFilter&&!this.displayedMemory.isEmpty()){this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory);this.cueStartTime=t}};return t}();e.default=function(){function t(t,e,r){this.field=t||1;this.outputs=[e,r];this.channels=[new m(1,e),new m(2,r)];this.currChNr=-1;this.lastCmdA=null;this.lastCmdB=null;this.bufferedData=[];this.startTime=null;this.lastTime=null;this.dataCounters={padding:0,char:0,cmd:0,other:0}}t.prototype.getHandler=function(t){return this.channels[t].getHandler()};t.prototype.setHandler=function(t,e){this.channels[t].setHandler(e)};t.prototype.addData=function(t,e){var r,i,n,a=!1;this.lastTime=t;h.setTime(t);for(var o=0;o<e.length;o+=2){i=127&e[o];n=127&e[o+1];if(0!==i||0!==n){h.log("DATA","["+f([e[o],e[o+1]])+"] -> ("+f([i,n])+")");r=this.parseCmd(i,n);r||(r=this.parseMidrow(i,n));r||(r=this.parsePAC(i,n));r||(r=this.parseBackgroundAttributes(i,n));if(!r){a=this.parseChars(i,n);if(a)if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else h.log("WARNING","No channel found yet. TEXT-MODE?")}if(r)this.dataCounters.cmd+=2;else if(a)this.dataCounters.char+=2;else{this.dataCounters.other+=2;h.log("WARNING","Couldn't parse cleaned data "+f([i,n])+" orig: "+f([e[o],e[o+1]]))}}else this.dataCounters.padding+=2}};t.prototype.parseCmd=function(t,e){var r=null,i=(20===t||28===t)&&e>=32&&e<=47,n=(23===t||31===t)&&e>=33&&e<=35;if(!i&&!n)return!1;if(t===this.lastCmdA&&e===this.lastCmdB){this.lastCmdA=null;this.lastCmdB=null;h.log("DEBUG","Repeated command ("+f([t,e])+") is dropped");return!0}r=20===t||23===t?1:2;var a=this.channels[r-1];20===t||28===t?32===e?a.ccRCL():33===e?a.ccBS():34===e?a.ccAOF():35===e?a.ccAON():36===e?a.ccDER():37===e?a.ccRU(2):38===e?a.ccRU(3):39===e?a.ccRU(4):40===e?a.ccFON():41===e?a.ccRDC():42===e?a.ccTR():43===e?a.ccRTD():44===e?a.ccEDM():45===e?a.ccCR():46===e?a.ccENM():47===e&&a.ccEOC():a.ccTO(e-32);this.lastCmdA=t;this.lastCmdB=e;this.currChNr=r;return!0};t.prototype.parseMidrow=function(t,e){var r=null;if((17===t||25===t)&&e>=32&&e<=47){r=17===t?1:2;if(r!==this.currChNr){h.log("ERROR","Mismatch channel in midrow parsing");return!1}this.channels[r-1].ccMIDROW(e);h.log("DEBUG","MIDROW ("+f([t,e])+")");return!0}return!1};t.prototype.parsePAC=function(t,e){var r=null,i=null,n=(t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127,a=(16===t||24===t)&&e>=64&&e<=95;if(!n&&!a)return!1;if(t===this.lastCmdA&&e===this.lastCmdB){this.lastCmdA=null;this.lastCmdB=null;return!0}r=t<=23?1:2;i=e>=64&&e<=95?1===r?s[t]:c[t]:1===r?l[t]:u[t];this.channels[r-1].setPAC(this.interpretPAC(i,e));this.lastCmdA=t;this.lastCmdB=e;this.currChNr=r;return!0};t.prototype.interpretPAC=function(t,e){var r=e,i={color:null,italics:!1,indent:null,underline:!1,row:t};r=e>95?e-96:e-64;i.underline=1==(1&r);if(r<=13)i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)];else if(r<=15){i.italics=!0;i.color="white"}else i.indent=4*Math.floor((r-16)/2);return i};t.prototype.parseChars=function(t,e){var r=null,i=null,a=null;if(t>=25){r=2;a=t-8}else{r=1;a=t}if(a>=17&&a<=19){var o=e;o=17===a?e+80:18===a?e+112:e+144;h.log("INFO","Special char '"+n(o)+"' in channel "+r);i=[o]}else t>=32&&t<=127&&(i=0===e?[t]:[t,e]);if(i){var s=f(i);h.log("DEBUG","Char codes =  "+s.join(","));this.lastCmdA=null;this.lastCmdB=null}return i};t.prototype.parseBackgroundAttributes=function(t,e){var r,i,n,a,o=(16===t||24===t)&&e>=32&&e<=47,s=(23===t||31===t)&&e>=45&&e<=47;if(!o&&!s)return!1;r={};if(16===t||24===t){i=Math.floor((e-32)/2);r.background=d[i];e%2==1&&(r.background=r.background+"_semi")}else if(45===e)r.background="transparent";else{r.foreground="black";47===e&&(r.underline=!0)}n=t<24?1:2;a=this.channels[n-1];a.setBkgData(r);this.lastCmdA=null;this.lastCmdB=null;return!0};t.prototype.reset=function(){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].reset();this.lastCmdA=null;this.lastCmdB=null};t.prototype.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].cueSplitAtTime(t)};return t}()},"./src/utils/codecs.js":function(t,e,r){"use strict";function i(t,e){var r=a[e];return!!r&&!0===r[t.slice(0,4)]}function n(t,e){return window.MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}Object.defineProperty(e,"__esModule",{value:!0});var a={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};e.isCodecType=i;e.isCodecSupportedInMp4=n},"./src/utils/cues.js":function(t,e,r){"use strict";function i(t,e,r,i){for(var a,o,s,l,c,u=window.VTTCue||window.TextTrackCue,d=0;d<i.rows.length;d++){a=i.rows[d];s=!0;l=0;c="";if(!a.isEmpty()){for(var h=0;h<a.chars.length;h++)if(a.chars[h].uchar.match(/\s/)&&s)l++;else{c+=a.chars[h].uchar;s=!1}a.cueStartTime=e;e===r&&(r+=1e-4);o=new u(e,r,n.fixLineBreaks(c.trim()));l>=16?l--:l++;o.line=navigator.userAgent.match(/Firefox\//)?d+1:d>7?d-2:d+1;o.align="left";o.position=Math.max(0,Math.min(100,l/32*100+(navigator.userAgent.match(/Firefox\//)?50:0)));t.addCue(o)}}}Object.defineProperty(e,"__esModule",{value:!0});var n=r("./src/utils/vttparser.js");e.newCue=i},"./src/utils/discontinuities.js":function(t,e,r){"use strict";(function(t){function i(t,e){for(var r=null,i=0;i<t.length;i+=1){var n=t[i];if(n&&n.cc===e){r=n;break}}return r}function n(t,e){return d.default.search(t,function(t){return t.cc<e?1:t.cc>e?-1:0})}function a(t,e,r){var i=!1;e&&e.details&&r&&(r.endCC>r.startCC||t&&t.cc<r.startCC)&&(i=!0);return i}function o(t,e){var r=t.fragments,n=e.fragments;if(n.length&&r.length){var a=i(r,n[0].cc);if(a&&(!a||a.startPTS))return a;h.logger.log("No frag in previous level to align on")}else h.logger.log("No fragments to align")}function s(t,e){e.fragments.forEach(function(e){if(e){var r=e.start+t;e.start=e.startPTS=r;e.endPTS=r+e.duration}});e.PTSKnown=!0}function l(t,e,r){c(t,r,e);!r.PTSKnown&&e&&u(r,e.details)}function c(t,e,r){if(a(t,r,e)){var i=o(r.details,e);if(i){h.logger.log("Adjusting PTS using last level due to CC increase within current level");s(i.start,e)}}}function u(e,r){if(r&&r.fragments.length){if(!e.hasProgramDateTime||!r.hasProgramDateTime)return;var i=r.fragments[0].programDateTime,n=e.fragments[0].programDateTime,a=(n-i)/1e3+r.fragments[0].start;if(t.isFinite(a)){h.logger.log("adjusting PTS using programDateTime delta, sliding:"+a.toFixed(3));s(a,e)}}}Object.defineProperty(e,"__esModule",{value:!0});var d=r("./src/utils/binary-search.js"),h=r("./src/utils/logger.js");e.findFirstFragWithCC=i;e.findFragWithCC=n;e.shouldAlignOnDiscontinuities=a;e.findDiscontinuousReferenceFrag=o;e.adjustPts=s;e.alignStream=l;e.alignDiscontinuities=c;e.alignPDT=u}).call(this,r("./src/polyfills/number.js").Number)},"./src/utils/ewma-bandwidth-estimator.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/ewma.js");e.default=function(){function t(t,e,r,n){this.hls=t;this.defaultEstimate_=n;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new i.default(e);this.fast_=new i.default(r)}t.prototype.sample=function(t,e){t=Math.max(t,this.minDelayMs_);var r=8e3*e/t,i=t/1e3;this.fast_.sample(i,r);this.slow_.sample(i,r)};t.prototype.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_};t.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_};t.prototype.destroy=function(){};return t}()},"./src/utils/ewma.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){function t(t){this.alpha_=t?Math.exp(Math.log(.5)/t):0;this.estimate_=0;this.totalWeight_=0}t.prototype.sample=function(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_;this.totalWeight_+=t};t.prototype.getTotalWeight=function(){return this.totalWeight_};t.prototype.getEstimate=function(){if(this.alpha_){return this.estimate_/(1-Math.pow(this.alpha_,this.totalWeight_))}return this.estimate_};return t}()},"./src/utils/get-self-scope.js":function(t,e,r){"use strict";function i(){return"undefined"==typeof window?self:window}Object.defineProperty(e,"__esModule",{value:!0});e.getSelfScope=i},"./src/utils/logger.js":function(t,e,r){"use strict";function i(){}function n(t,e){e="["+t+"] > "+e;return e}function a(t){var e=u.console[t];return e?function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];r[0]&&(r[0]=n(t,r[0]));e.apply(u.console,r)}:i}function o(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];e.forEach(function(e){c[e]=t[e]?t[e].bind(t):a(e)})}Object.defineProperty(e,"__esModule",{value:!0});var s=r("./src/utils/get-self-scope.js"),l={trace:i,debug:i,log:i,warn:i,info:i,error:i},c=l,u=s.getSelfScope();e.enableLogs=function(t){if(!0===t||"object"==typeof t){o(t,"debug","log","info","warn","error");try{c.log()}catch(t){c=l}}else c=l};e.logger=c},"./src/utils/mediakeys-helper.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.requestMediaKeySystemAccess=function(){return"undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null}()},"./src/utils/mediasource-helper.js":function(t,e,r){"use strict";function i(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}Object.defineProperty(e,"__esModule",{value:!0});e.getMediaSource=i},"./src/utils/output-filter.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){function t(t,e){this.timelineController=t;this.trackName=e;this.startTime=null;this.endTime=null;this.screen=null}t.prototype.dispatchCue=function(){if(null!==this.startTime){this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen);this.startTime=null}};t.prototype.newCue=function(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t);this.endTime=e;this.screen=r;this.timelineController.createCaptionsTrack(this.trackName)};return t}()},"./src/utils/texttrack-utils.js":function(t,e,r){"use strict";function i(t,e){var r=null;try{r=new window.Event("addtrack")}catch(t){r=document.createEvent("Event");r.initEvent("addtrack",!1,!1)}r.track=t;e.dispatchEvent(r)}function n(t){if(t&&t.cues)for(;t.cues.length>0;)t.removeCue(t.cues[0])}Object.defineProperty(e,"__esModule",{value:!0});e.sendAddTrackEvent=i;e.clearCurrentCues=n},"./src/utils/time-ranges.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={toString:function(t){for(var e="",r=t.length,i=0;i<r;i++)e+="["+t.start(i).toFixed(3)+","+t.end(i).toFixed(3)+"]";return e}}},"./src/utils/vttcue.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(){function t(t){return"string"==typeof t&&(!!a[t.toLowerCase()]&&t.toLowerCase())}function e(t){return"string"==typeof t&&(!!o[t.toLowerCase()]&&t.toLowerCase())}function r(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t}function i(i,a,o){var s=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),c={};l?s=document.createElement("custom"):c.enumerable=!0;s.hasBeenReset=!1;var u="",d=!1,h=i,f=a,p=o,g=null,y="",v=!0,m="auto",b="start",E=50,_="middle",S=50,T="middle";Object.defineProperty(s,"id",r({},c,{get:function(){return u},set:function(t){u=""+t}}));Object.defineProperty(s,"pauseOnExit",r({},c,{get:function(){return d},set:function(t){d=!!t}}));Object.defineProperty(s,"startTime",r({},c,{get:function(){return h},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");h=t;this.hasBeenReset=!0}}));Object.defineProperty(s,"endTime",r({},c,{get:function(){return f},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");f=t;this.hasBeenReset=!0}}));Object.defineProperty(s,"text",r({},c,{get:function(){return p},set:function(t){p=""+t;this.hasBeenReset=!0}}));Object.defineProperty(s,"region",r({},c,{get:function(){return g},set:function(t){g=t;this.hasBeenReset=!0}}));Object.defineProperty(s,"vertical",r({},c,{get:function(){return y},set:function(e){var r=t(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");y=r;this.hasBeenReset=!0}}));Object.defineProperty(s,"snapToLines",r({},c,{get:function(){return v},set:function(t){v=!!t;this.hasBeenReset=!0}}));Object.defineProperty(s,"line",r({},c,{get:function(){return m},set:function(t){if("number"!=typeof t&&t!==n)throw new SyntaxError("An invalid number or illegal string was specified.");m=t;this.hasBeenReset=!0}}));Object.defineProperty(s,"lineAlign",r({},c,{get:function(){return b},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");b=r;this.hasBeenReset=!0}}));Object.defineProperty(s,"position",r({},c,{get:function(){return E},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");E=t;this.hasBeenReset=!0}}));Object.defineProperty(s,"positionAlign",r({},c,{get:function(){return _},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");_=r;this.hasBeenReset=!0}}));Object.defineProperty(s,"size",r({},c,{get:function(){return S},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");S=t;this.hasBeenReset=!0}}));Object.defineProperty(s,"align",r({},c,{get:function(){return T},set:function(t){var r=e(t);if(!r)throw new SyntaxError("An invalid or illegal string was specified.");T=r;this.hasBeenReset=!0}}));s.displayState=void 0;if(l)return s}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var n="auto",a={"":!0,lr:!0,rl:!0},o={start:!0,middle:!0,end:!0,left:!0,right:!0};i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)};return i}()},"./src/utils/vttparser.js":function(t,e,r){"use strict";function i(){this.window=window;this.state="INITIAL";this.buffer="";this.decoder=new u;this.regionList=[]}function n(t){function e(t,e,r,i){return 3600*(0|t)+60*(0|e)+(0|r)+(0|i)/1e3}var r=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?e(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?e(r[1],r[2],0,r[4]):e(0,r[1],r[2],r[4]):null}function a(){this.values=Object.create(null)}function o(t,e,r,i){var n=i?t.split(i):[t];for(var a in n)if("string"==typeof n[a]){var o=n[a].split(r);if(2===o.length){var s=o[0],l=o[1];e(s,l)}}}function s(t,e,r){function i(){var e=n(t);if(null===e)throw new Error("Malformed timestamp: "+l);t=t.replace(/^[^\sa-zA-Z-]+/,"");return e}function s(){t=t.replace(/^\s+/,"")}var l=t;s();e.startTime=i();s();if("--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+l);t=t.substr(3);s();e.endTime=i();s();!function(t,e){var i=new a;o(t,function(t,e){switch(t){case"region":for(var n=r.length-1;n>=0;n--)if(r[n].id===e){i.set(t,r[n].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var a=e.split(","),o=a[0];i.integer(t,o);i.percent(t,o)&&i.set("snapToLines",!1);i.alt(t,o,["auto"]);2===a.length&&i.alt("lineAlign",a[1],["start",h,"end"]);break;case"position":a=e.split(",");i.percent(t,a[0]);2===a.length&&i.alt("positionAlign",a[1],["start",h,"end","line-left","line-right","auto"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start",h,"end","left","right"])}},/:/,/\s/);e.region=i.get("region",null);e.vertical=i.get("vertical","");var n=i.get("line","auto");"auto"===n&&-1===d.line&&(n=-1);e.line=n;e.lineAlign=i.get("lineAlign","start");e.snapToLines=i.get("snapToLines",!0);e.size=i.get("size",100);e.align=i.get("align",h);var s=i.get("position","auto");"auto"===s&&50===d.position&&(s="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50);e.position=s}(t,e)}function l(t){return t.replace(/<br(?: \/)?>/gi,"\n")}Object.defineProperty(e,"__esModule",{value:!0});var c=r("./src/utils/vttcue.js"),u=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};a.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,r){for(var i=0;i<r.length;++i)if(e===r[i]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){if(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)){e=parseFloat(e);if(e>=0&&e<=100){this.set(t,e);return!0}}return!1}};var d=new c.default(0,0,0),h="middle"===d.align?"middle":"center";e.fixLineBreaks=l;i.prototype={parse:function(t){function e(){var t=r.buffer,e=0;t=l(t);for(;e<t.length&&"\r"!==t[e]&&"\n"!==t[e];)++e;var i=t.substr(0,e);"\r"===t[e]&&++e;"\n"===t[e]&&++e;r.buffer=t.substr(e);return i}var r=this;t&&(r.buffer+=r.decoder.decode(t,{stream:!0}));try{var i=void 0;if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;i=e();var n=i.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");r.state="HEADER"}for(var a=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;a?a=!1:i=e();switch(r.state){case"HEADER":/:/.test(i)?function(t){o(t,function(t,e){},/:/)}(i):i||(r.state="ID");continue;case"NOTE":i||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){r.state="NOTE";break}if(!i)continue;r.cue=new c.default(0,0,"");r.state="CUE";if(-1===i.indexOf("--\x3e")){r.cue.id=i;continue}case"CUE":try{s(i,r.cue,r.regionList)}catch(t){r.cue=null;r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var u=-1!==i.indexOf("--\x3e");if(!i||u&&(a=!0)){r.oncue&&r.oncue(r.cue);r.cue=null;r.state="ID";continue}r.cue.text&&(r.cue.text+="\n");r.cue.text+=i;continue;case"BADCUE":i||(r.state="ID");continue}}}catch(t){"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue);r.cue=null;r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{t.buffer+=t.decoder.decode();if(t.cue||"HEADER"===t.state){t.buffer+="\n\n";t.parse()}if("INITIAL"===t.state)throw new Error("Malformed WebVTT signature.")}catch(t){throw t}t.onflush&&t.onflush();return this}};e.default=i},"./src/utils/webvtt-parser.js":function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/vttparser.js"),n=r("./src/demux/id3.js"),a=function(t,e,r){return t.substr(r||0,e.length)===e},o=function(e){var r=parseInt(e.substr(-3)),i=parseInt(e.substr(-6,2)),n=parseInt(e.substr(-9,2)),a=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(t.isFinite(r)&&t.isFinite(i)&&t.isFinite(n)&&t.isFinite(a)))return-1;r+=1e3*i;r+=6e4*n;r+=36e5*a;return r},s=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()},l=function(t,e,r){var i=t[e],n=t[i.prevCC];if(!n||!n.new&&i.new){t.ccOffset=t.presentationOffset=i.start;i.new=!1}else{for(;n&&n.new;){t.ccOffset+=i.start-n.start;i.new=!1;i=n;n=t[i.prevCC]}t.presentationOffset=r}};e.default={parse:function(t,e,r,c,u,d){var h,f=/\r\n|\n\r|\n|\r/g,p=n.utf8ArrayToStr(new Uint8Array(t)).trim().replace(f,"\n").split("\n"),g="00:00.000",y=0,v=0,m=0,b=[],E=!0,_=new i.default;_.oncue=function(t){var e=r[c],i=r.ccOffset;e&&e.new&&(void 0!==v?i=r.ccOffset=e.start:l(r,c,m));m&&(i=m-r.presentationOffset);t.startTime+=i-v;t.endTime+=i-v;t.id=s(t.startTime.toString())+s(t.endTime.toString())+s(t.text);t.text=decodeURIComponent(encodeURIComponent(t.text));t.endTime>0&&b.push(t)};_.onparsingerror=function(t){h=t};_.onflush=function(){h&&d?d(h):u(b)};p.forEach(function(t){if(E){if(a(t,"X-TIMESTAMP-MAP=")){E=!1;t.substr(16).split(",").forEach(function(t){a(t,"LOCAL:")?g=t.substr(6):a(t,"MPEGTS:")&&(y=parseInt(t.substr(7)))});try{e+(9e4*r[c].start||0)<0&&(e+=8589934592);y-=e;v=o(g)/1e3;m=y/9e4;-1===v&&(h=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(e){h=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(E=!1)}_.parse(t+"\n")});_.flush()}}}).call(this,r("./src/polyfills/number.js").Number)},"./src/utils/xhr-loader.js":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r("./src/utils/logger.js"),n=window.performance,a=window.XMLHttpRequest;e.default=function(){function t(t){t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}t.prototype.destroy=function(){this.abort();this.loader=null};t.prototype.abort=function(){var t=this.loader;if(t&&4!==t.readyState){this.stats.aborted=!0;t.abort()}window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null};t.prototype.load=function(t,e,r){this.context=t;this.config=e;this.callbacks=r;this.stats={trequest:n.now(),retry:0};this.retryDelay=e.retryDelay;this.loadInternal()};t.prototype.loadInternal=function(){var t,e=this.context;t=this.loader=new a;var r=this.stats;r.tfirst=0;r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(t,e.url)}catch(r){t.open("GET",e.url,!0);i(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(r){this.callbacks.onError({code:t.status,text:r.message},e,t);return}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1));t.onreadystatechange=this.readystatechange.bind(this);t.onprogress=this.loadprogress.bind(this);t.responseType=e.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);t.send()};t.prototype.readystatechange=function(t){var e=t.currentTarget,r=e.readyState,a=this.stats,o=this.context,s=this.config;if(!a.aborted&&r>=2){window.clearTimeout(this.requestTimeout);0===a.tfirst&&(a.tfirst=Math.max(n.now(),a.trequest));if(4===r){var l=e.status;if(l>=200&&l<300){a.tload=Math.max(a.tfirst,n.now());var c=void 0,u=void 0;if("arraybuffer"===o.responseType){c=e.response;u=c.byteLength}else{c=e.responseText;u=c.length}a.loaded=a.total=u;this.callbacks.onSuccess({url:e.responseURL,data:c},a,o,e)}else if(a.retry>=s.maxRetry||l>=400&&l<499){i.logger.error(l+" while loading "+o.url);this.callbacks.onError({code:l,text:e.statusText},o,e)}else{i.logger.warn(l+" while loading "+o.url+", retrying in "+this.retryDelay+"...");this.destroy();this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay);this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay);a.retry++}}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)}};t.prototype.loadtimeout=function(){i.logger.warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)};t.prototype.loadprogress=function(t){var e=t.currentTarget,r=this.stats;r.loaded=t.loaded;t.lengthComputable&&(r.total=t.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,e)};return t}()}}).default})},515:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(){var t=this._options.mpgmedia,e=this._player,r=e.width,i=e.height,n=e.duration,a=t.map(function(t){return{width:t.width,height:t.height}});this.trigger(g.a.META_DATA_LOADED,m({},this._file,{width:r,height:i,duration:n,qualities:a}))}function s(){this.trigger(g.a.TIME_UPDATE,this.getCurrentTime())}function l(){this.trigger(g.a.BUFFER_PROGRESS,this._player.data.length/this._player.bitrate)}function c(){this.trigger(g.a.VIDEO_ENDED)}function u(t,e){this._player&&this._player.destroy();var r=new f.a(e);r.subscribe(o.bind(this),"loadedmetadata");r.subscribe(c.bind(this),"ended");r.subscribe(l.bind(this),"progress");r.subscribe(s.bind(this),"timeupdate");r.init(t);return r}var d=r(42),h=r(2),f=r(516),p=r(13),g=r(66),y=r(329),v=r(146),m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.init=function(e){t.prototype.init.call(this,e);this._store.dispatch(Object(p.d)("CanvasContainer.init()"));var r=this._options,i=r.mpgmedia,n=r.parent,a=r.slotWidth,o=r.slotHeight,s=r.defaultQuality,l=void 0;if(s){var c=parseInt(s,10);l=i.find(function(t){return t.height===c})}l||(l=Object(d.a)(i,a,o));this._file=l;this._canvas=document.createElement("canvas");n.appendChild(this._canvas);this._videoContainer=null;this._player=u.call(this,this._file.url,{canvas:this._canvas})};e.prototype.getContainer=function(){return this._videoContainer?this._videoContainer.getContainer():this._canvas};e.prototype.setVolume=function(t){!this._videoContainer&&t&&(this._videoContainer=this._createVideoContainer());this._videoContainer&&this._videoContainer.setVolume(t)};e.prototype.start=function(){var t=this;return this._videoContainer?this._videoContainer.play():new Promise(function(e){t._player.play();e()})};e.prototype.play=function(){this._videoContainer?this._videoContainer.play():this._player.play()};e.prototype.pause=function(){this._videoContainer?this._videoContainer.pause():this._player.pause()};e.prototype.getDuration=function(){return this._videoContainer?this._videoContainer.getDuration():this._player.duration};e.prototype.getCurrentTime=function(){return this._videoContainer?this._videoContainer.getCurrentTime():this._player.currentTime};e.prototype.seek=function(t){if(this._videoContainer)this._videoContainer.seek(t);else{this._player.seek(t);this.trigger(g.a.TIME_UPDATE,t)}};e.prototype.destroy=function(){t.prototype.destroy.call(this);if(this._videoContainer)this._videoContainer.destroy();else{this._player.destroy();Object(h.p)(this._canvas)}};e.prototype.setQuality=function(t){if(this._videoContainer)this._videoContainer.setQuality(t);else{if(!t){this.setQuality(this._file.height);return}var e=this._options.mpgmedia.find(function(e){return e.height===t}),r=e.url;if(this._player.src!==r){this._player=u.call(this,r,{canvas:this._canvas});this.trigger(g.a.QUALITY_UPDATED,t)}}};e.prototype.requestFullScreen=function(t){this._videoContainer||(this._videoContainer=this._createVideoContainer());this._videoContainer.requestFullScreen(t)};e.prototype.closeFullScreen=function(){this._videoContainer&&this._videoContainer.closeFullScreen()};e.prototype.getThumbnail=function(){return this._videoContainer?this._videoContainer.getThumbnail():this._canvas.toDataURL()};e.prototype._createVideoContainer=function(){var t=this,e=new y.a(m({},this._options,{files:this._options.mp4media}));e.subscribeAll(function(e){return t.trigger(e.type,e[0])});e.init(this._options);e.seek(this._player.currentTime);this._player.destroy();Object(h.p)(this._canvas);return e};e.prototype.createPreview=function(){var t=this;return new Promise(function(e,r){var i=t._canvas;if(i.toBlob){var n=Date.now();i.toBlob(function(t){e(new File([t],n+".jpg",{type:"image/jpeg",lastModified:n}))},"image/jpeg",1)}else r()})};e.create=function(t){var r=Object(d.b)(t,"video/mpeg"),i=Object(d.b)(t,"video/mp4");return r.length?new e({mpgmedia:r,mp4media:i}):null};return e}(v.a)},516:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(39),s=r(19),l=r(517),c=r(518),u=r(524);e.a=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var a=n(this,t.call(this));a.canvas=r.canvas;a.data=[];a.hasSeekToTime=null;a.currentRenderFrame=0;a.hasStop=!0;a.hasPlaying=!1;a.timeoutId=null;a.debouncingSeek=[];a.currentTime=0;a.messageData=[];a.subscribe(function(){a.hasSeekToTime=!1;a.currentRenderFrame=0;a.currentTime=0},"ended");a.hasDestroyed=!1;return a}a(e,t);e.prototype.decodeMessage=function(){var t=this.messageData.shift();this.decodeFrames(new l.a(t));this.trigger("progress")};e.prototype.createSocket=function(t){var e=this,r=new WebSocket(t);r.binaryType="arraybuffer";var i=function(t){e.messageData.push(t.data);setTimeout(e.decodeMessage.bind(e),0)};r.addEventListener("message",function t(n){var a=new l.a(n.data);e.decodeInitPackage(a);e.initRender();r.removeEventListener("message",t);r.addEventListener("message",i);e.needLoadFrames()});return r};e.prototype.init=function(t){var e=this;!function r(){if(!e.hasDestroyed)try{e.client=e.createSocket(t);e.client.addEventListener("error",function(){setTimeout(r,5e3);e.clearRequested()});e.client.addEventListener("close",function(){setTimeout(r,5e3);e.clearRequested()});e.client.addEventListener("open",function(){e.hasSeekToTime&&e.seek(e.hasSeekToTime/1e3)})}catch(t){s.a.error("jsmpeg "+t);setTimeout(r,5e3)}}()};e.prototype.decodeInitPackage=function(t){this.format=t.getBits(32);this.width=t.getBits(16);this.height=t.getBits(16);this.bitrate=t.getBits(8);this.totalframes=t.getBits(32);this.duration=this.totalframes/this.bitrate;this.canvas.width=this.width;this.canvas.height=this.height;this.trigger("loadedmetadata")};e.prototype.decodeFrames=function(t){var e=t.getBits(32),r=t.getBits(32),i=new c.a(t,this.width,this.height,this.canvas,{supportWebGL:!!this.gl,gl:this.gl,texture:{Y:this.YTexture,CB:this.CBTexture,CR:this.CRTexture}}),n=this.data[r-1]&&this.data[r-1].frame;this.data[r]={frame:i};n&&i.setPrevFrame(n);if(this.hasSeekToTime&&this.hasSeekToTime===e){i.decodePicture();i.render();this.hasSeekToTime=null;this.currentRenderFrame=r;if(this.debouncingSeek.length>1){var a=this.debouncingSeek[this.debouncingSeek.length-1];this.debouncingSeek=[];this.seek(a/1e3)}}if(this.hasStop&&0===r){i.decodePicture();i.render()}};e.prototype.loadFrames=function(t,e){if(1===this.client.readyState){this.client.send(t===e?"load("+t+")":"load("+t+","+e+")");for(var r=t;r<e;r+=1)this.data[r]||(this.data[r]={requested:!0})}};e.prototype.play=function(){if(!this.hasPlaying){this.currentRenderFrame>=this.totalframes&&(this.currentRenderFrame=0);this.hasStop=!1;this.hasPlaying=!0;this.startAnimation()}};e.prototype.hasBufferedAudio=function(){return!!this.audioSlot&&(!this.audioSlot.paused&&4!==this.audioSlot.readyState)};e.prototype.pause=function(){this.hasStop=!0;this.hasPlaying=!1;this.timeoutId&&window.clearTimeout(this.timeoutId)};e.prototype.stop=function(){this.hasStop=!0;this.hasPlaying=!1;this.timeoutId&&window.clearTimeout(this.timeoutId)};e.prototype.needLoadFrames=function(){for(var t=0,e=this.currentRenderFrame;e<this.currentRenderFrame+50;e+=1){var r=this.data[e]&&this.data[e].frame,i=this.data[e]&&this.data[e].requested;if(r||i)break;t+=1}if(t>0){this.loadFrames(this.currentRenderFrame,this.currentRenderFrame+t);return!0}for(var n=this.currentRenderFrame;n<this.currentRenderFrame+50;n+=1){var a=this.data[n]&&this.data[n].frame,o=this.data[n]&&this.data[n].requested;if(!a&&!o){this.loadFrames(n,n+10);return!1}}return!1};e.prototype.startAnimation=function(){if(!this.hasStop&&!this.hasDestroyed)if(this.currentRenderFrame>=this.totalframes){this.currentRenderFrame=0;this.hasStop=!0;this.hasPlaying=!1;this.trigger("ended")}else{this.timeoutId=setTimeout(this.startAnimation.bind(this),1e3/this.bitrate);if(!this.hasSeekToTime&&!this.hasBufferedAudio()){var t=this.needLoadFrames();if(!t){var e=this.data[this.currentRenderFrame].frame;if(e&&e.decodePicture){e.decodePicture();e.render();this.currentTime=this.currentRenderFrame/this.totalframes*this.duration;this.trigger("timeupdate",{target:{currentTime:this.currentTime,duration:this.duration}});this.currentRenderFrame+=1}}}}};e.prototype.seek=function(t){var e=Math.ceil(this.totalframes*(t/this.duration)),r=void 0;if(e>=this.totalframes){e=this.totalframes;r=parseInt(1e3*this.duration,10);this.trigger("end")}else r=Math.ceil(1e3*t);var i=this.data[e]&&this.data[e].frame;if(void 0===i){if(this.hasSeekToTime){this.debouncingSeek.push(r);return}this.hasSeekToTime=r;1===this.client.readyState&&this.client.send("seek("+r+")");this.trigger("timeupdate",{target:{currentTime:t,duration:this.duration}})}else{var n=void 0;for(n=e;n>0;n-=1)if(this.data[n]&&this.data[n].frame&&1===this.data[n].frame.pictureCodingType){i=this.data[n].frame;break}for(var a=n;a<e;a+=1){this.data[n].frame.decodePicture();this.data[n].frame.render()}this.currentRenderFrame=e;i.decodePicture();i.render();this.trigger("timeupdate",{target:{currentTime:t,duration:this.duration}})}};e.prototype.clearRequested=function(){var t=this;this.data.forEach(function(e,r){e.requested&&(t.data[r].requested=!1)})};e.prototype.initRender=function(){if(this.initWebGL()){this.gl.useProgram(this.program);this.gl.viewport(0,0,this.width,this.height)}};e.prototype.initWebGL=function(){var t=void 0;try{t=this.gl=this.canvas.getContext("webgl",{preserveDrawingBuffer:!0})||this.canvas.getContext("experimental-webgl",{preserveDrawingBuffer:!0})}catch(t){return!1}if(!t)return!1;this.glbuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.glbuffer);t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),t.STATIC_DRAW);this.program=t.createProgram();t.attachShader(this.program,this.compileShader(t.VERTEX_SHADER,u.a.SHADER_VERTEX_IDENTITY));t.attachShader(this.program,this.compileShader(t.FRAGMENT_SHADER,u.a.SHADER_FRAGMENT_YCBCRTORGBA));t.linkProgram(this.program);if(!t.getProgramParameter(this.program,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(this.program));t.useProgram(this.program);this.YTexture=this.createTexture(0,"YTexture");this.CBTexture=this.createTexture(1,"CBTexture");this.CRTexture=this.createTexture(2,"CRTexture");var e=t.getAttribLocation(this.program,"vertex");t.enableVertexAttribArray(e);t.vertexAttribPointer(e,2,t.FLOAT,!1,0,0);this.loadingProgram=t.createProgram();t.attachShader(this.loadingProgram,this.compileShader(t.VERTEX_SHADER,u.a.SHADER_VERTEX_IDENTITY));t.attachShader(this.loadingProgram,this.compileShader(t.FRAGMENT_SHADER,u.a.SHADER_FRAGMENT_LOADING));t.linkProgram(this.loadingProgram);t.useProgram(this.loadingProgram);e=t.getAttribLocation(this.loadingProgram,"vertex");t.enableVertexAttribArray(e);t.vertexAttribPointer(e,2,t.FLOAT,!1,0,0);return!0};e.prototype.compileShader=function(t,e){var r=this.gl,i=r.createShader(t);r.shaderSource(i,e);r.compileShader(i);if(!r.getShaderParameter(i,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(i));return i};e.prototype.createTexture=function(t,e){var r=this.gl,i=r.createTexture();r.bindTexture(r.TEXTURE_2D,i);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);r.uniform1i(r.getUniformLocation(this.program,e),t);return i};e.prototype.destroy=function(){this.hasDestroyed=!0;this.eventListeners={};window.clearTimeout(this.timeoutId);this.client&&this.client.close()};return e}(o.a)},517:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.a=function(){function t(e){i(this,t);this.bytes=new Uint8Array(e);this.length=this.bytes.length;this.writePos=this.bytes.length;this.index=0}t.prototype.nextBits=function(t){var e=this.index>>3,r=8-this.index%8;if(r>=t)return this.bytes[e]>>r-t&255>>8-t;var i=(this.index+t)%8,n=this.index+t-1>>3,a=this.bytes[e]&255>>8-r;for(e+=1;e<n;e+=1){a<<=8;a|=this.bytes[e]}if(i>0){a<<=i;a|=this.bytes[e]>>8-i}else{a<<=8;a|=this.bytes[e]}return a};t.prototype.getBits=function(t){var e=this.nextBits(t);this.index+=t;return e};t.prototype.findNextMPEGStartCode=function(){for(var e=this.index+7>>3;e<this.writePos;e+=1)if(0===this.bytes[e]&&0===this.bytes[e+1]&&1===this.bytes[e+2]){this.index=e+4<<3;return this.bytes[e+3]}this.index=this.writePos<<3;return t.NOT_FOUND};t.prototype.advance=function(t){return this.index+=t};t.prototype.nextBytesAreStartCode=function(){var t=this.index+7>>3;return t>=this.writePos||0===this.bytes[t]&&0===this.bytes[t+1]&&1===this.bytes[t+2]};return t}()},518:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=r(5),a=r(519),o=r(520),s=r(521),l=r(522),c=r(523);e.a=function(){function t(e,r,n,a,o){i(this,t);this.hasDecoded=!1;this.hasDecodeColor=!1;this.buffer=e;this.width=r;this.height=n;this.customIntraQuantMatrix=new Uint8Array(64);this.customNonIntraQuantMatrix=new Uint8Array(64);this.blockData=new Int32Array(64);this.zeroBlockData=new Int32Array(64);this.intraQuantMatrix=s.a.DEFAULT_INTRA_QUANT;this.nonIntraQuantMatrix=s.a.DEFAULT_NON_INTRA_QUANT;this.mbWidth=this.width+15>>4;this.mbHeight=this.height+15>>4;this.mbSize=this.mbWidth*this.mbHeight;this.codedWidth=this.mbWidth<<4;this.codedHeight=this.mbHeight<<4;this.codedSize=this.codedWidth*this.codedHeight;this.halfWidth=this.mbWidth<<3;this.halfHeight=this.mbHeight<<3;this.quarterSize=this.codedSize>>2;var l=window.Uint8ClampedArray||window.Uint8Array;if(!window.Uint8ClampedArray){this.copyBlockToDestination=this.copyBlockToDestinationClamp;this.addBlockToDestination=this.addBlockToDestinationClamp}this.currentY=new l(this.codedSize);this.currentY32=new Uint32Array(this.currentY.buffer);this.currentCr=new l(this.codedSize>>2);this.currentCr32=new Uint32Array(this.currentCr.buffer);this.currentCb=new l(this.codedSize>>2);this.currentCb32=new Uint32Array(this.currentCb.buffer);this.forwardY=new l(this.codedSize);this.forwardY32=new Uint32Array(this.forwardY.buffer);this.forwardCr=new l(this.codedSize>>2);this.forwardCr32=new Uint32Array(this.forwardCr.buffer);this.forwardCb=new l(this.codedSize>>2);this.forwardCb32=new Uint32Array(this.forwardCb.buffer);this.quantizerScale=0;this.sliceBegin=!1;this.macroblockAddress=0;this.mbRow=0;this.mbCol=0;this.macroblockType=0;this.macroblockIntra=!1;this.macroblockMotFw=!1;this.motionFwH=0;this.motionFwV=0;this.motionFwHPrev=0;this.motionFwVPrev=0;this.canvas=a;if(o.supportWebGL)this.render=this.renderFrameGL.bind(this,o);else{this.canvasCtx=a.getContext("2d");this.currentRGBA=document.createElement("canvas").getContext("2d").getImageData(0,0,this.width,this.height);this.render=this.renderFrame2D.bind(this,o)}}t.prototype.setPrevFrame=function(t){this.forwardY=t.currentY;this.forwardY32=t.currentY32;this.forwardCr=t.currentCr;this.forwardCr32=t.currentCr32;this.forwardCb=t.currentCb;this.forwardCb32=t.currentCb32;this.currentY=t.forwardY;this.currentY32=t.forwardY32;this.currentCr=t.forwardCr;this.currentCr32=t.forwardCr32;this.currentCb=t.forwardCb;this.currentCb32=t.forwardCb32};t.prototype.renderFrame2D=function(){this.hasDecodeColor||this.YCbCrToRGBA();if(n.c&&n.i){var t=document.createElement("canvas");t.setAttribute("width",this.width);t.setAttribute("height",this.height);t.getContext("2d").putImageData(this.currentRGBA,0,0);this.canvasCtx.drawImage(t,0,0)}else this.canvasCtx.putImageData(this.currentRGBA,0,0)};t.prototype.renderFrameGL=function(t){var e=t.texture,r=t.gl,i=new Uint8Array(this.currentY.buffer),n=new Uint8Array(this.currentCr.buffer),a=new Uint8Array(this.currentCb.buffer);r.activeTexture(r.TEXTURE0);r.bindTexture(r.TEXTURE_2D,e.Y);r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,this.codedWidth,this.height,0,r.LUMINANCE,r.UNSIGNED_BYTE,i);r.activeTexture(r.TEXTURE1);r.bindTexture(r.TEXTURE_2D,e.CB);r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,this.halfWidth,this.height/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,n);r.activeTexture(r.TEXTURE2);r.bindTexture(r.TEXTURE_2D,e.CR);r.texImage2D(r.TEXTURE_2D,0,r.LUMINANCE,this.halfWidth,this.height/2,0,r.LUMINANCE,r.UNSIGNED_BYTE,a);r.drawArrays(r.TRIANGLE_STRIP,0,4)};t.prototype.decodePicture=function(){var t=0;this.buffer.index=255;for(;;){t=this.buffer.findNextMPEGStartCode();if(-1===t)return!1;if(t===a.a.PICTURE)break}this.buffer.advance(10);this.pictureCodingType=this.buffer.getBits(3);this.buffer.advance(16);if(this.pictureCodingType<=0||this.pictureCodingType>=o.a.B)return!1;if(this.pictureCodingType===o.a.P){this.fullPelForward=this.buffer.getBits(1);this.forwardFCode=this.buffer.getBits(3);if(0===this.forwardFCode)return!1;this.forwardRSize=this.forwardFCode-1;this.forwardF=1<<this.forwardRSize}do{t=this.buffer.findNextMPEGStartCode()}while(t===a.a.EXTENSION||t===a.a.USER_DATA);for(;t>=a.a.SLICE_FIRST&&t<=a.a.SLICE_LAST;){this.decodeSlice(255&t);t=this.buffer.findNextMPEGStartCode()}this.hasDecoded=!0;return!0};t.prototype.decodeSlice=function(t){this.sliceBegin=!0;this.macroblockAddress=(t-1)*this.mbWidth-1;this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0;this.dcPredictorY=128;this.dcPredictorCr=128;this.dcPredictorCb=128;this.quantizerScale=this.buffer.getBits(5);for(;this.buffer.getBits(1);)this.buffer.advance(8);do{this.decodeMacroblock()}while(!this.buffer.nextBytesAreStartCode())};t.prototype.decodeMacroblock=function(){for(var t=0,e=this.readCode(l.a.ADDRESS_INCREMENT);34===e;)e=this.readCode(l.a.ADDRESS_INCREMENT);for(;35===e;){t+=33;e=this.readCode(l.a.ADDRESS_INCREMENT)}t+=e;if(this.sliceBegin){this.sliceBegin=!1;this.macroblockAddress+=t}else{if(this.macroblockAddress+t>=this.mbSize)return!1;if(t>1){this.dcPredictorY=128;this.dcPredictorCr=128;this.dcPredictorCb=128;if(this.pictureCodingType===o.a.P){this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0}}for(;t>1;){this.macroblockAddress+=1;this.mbRow=this.macroblockAddress/this.mbWidth|0;this.mbCol=this.macroblockAddress%this.mbWidth;this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb);t-=1}this.macroblockAddress+=1}this.mbRow=this.macroblockAddress/this.mbWidth|0;this.mbCol=this.macroblockAddress%this.mbWidth;this.macroblockType=this.readCode(l.a.TYPE_TABLE[this.pictureCodingType]);this.macroblockIntra=1&this.macroblockType;this.macroblockMotFw=8&this.macroblockType;0!=(16&this.macroblockType)&&(this.quantizerScale=this.buffer.getBits(5));if(this.macroblockIntra){this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0}else{this.dcPredictorY=128;this.dcPredictorCr=128;this.dcPredictorCb=128;this.decodeMotionVectors();this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb)}for(var r=0!=(2&this.macroblockType)?this.readCode(c.a.CODE_BLOCK_PATTERN):this.macroblockIntra?63:0,i=0,n=32;i<6;i++){0!=(r&n)&&this.decodeBlock(i);n>>=1}};t.prototype.readCode=function(t){var e=0;do{e=t[e+this.buffer.getBits(1)]}while(e>=0&&0!==t[e]);return t[e+2]};t.prototype.copyMacroblock=function(t,e,r,i,n){var a=void 0,o=void 0,s=void 0,l=void 0,c=void 0,u=void 0,d=void 0,h=void 0,f=void 0,p=this.currentY32,g=this.currentCb32,y=this.currentCr32;a=this.codedWidth;o=a-16;s=t>>1;l=e>>1;c=1==(1&t);u=1==(1&e);d=((this.mbRow<<4)+l)*a+(this.mbCol<<4)+s;h=this.mbRow*a+this.mbCol<<2;f=h+(a<<2);var v,m,b,E;if(c)if(u)for(;h<f;){m=r[d]+r[d+a];d++;for(v=0;v<4;v++){b=r[d]+r[d+a];d++;E=m+b+2>>2&255;m=r[d]+r[d+a];d++;E|=m+b+2<<6&65280;b=r[d]+r[d+a];d++;E|=m+b+2<<14&16711680;m=r[d]+r[d+a];d++;E|=m+b+2<<22&4278190080;p[h++]=E}h+=o>>2;d+=o-1}else for(;h<f;){m=r[d++];for(v=0;v<4;v++){b=r[d++];E=m+b+1>>1&255;m=r[d++];E|=m+b+1<<7&65280;b=r[d++];E|=m+b+1<<15&16711680;m=r[d++];E|=m+b+1<<23&4278190080;p[h++]=E}h+=o>>2;d+=o-1}else if(u)for(;h<f;){for(v=0;v<4;v++){E=r[d]+r[d+a]+1>>1&255;d++;E|=r[d]+r[d+a]+1<<7&65280;d++;E|=r[d]+r[d+a]+1<<15&16711680;d++;E|=r[d]+r[d+a]+1<<23&4278190080;d++;p[h++]=E}h+=o>>2;d+=o}else for(;h<f;){for(v=0;v<4;v++){E=r[d];d++;E|=r[d]<<8;d++;E|=r[d]<<16;d++;E|=r[d]<<24;d++;p[h++]=E}h+=o>>2;d+=o}a=this.halfWidth;o=a-8;s=t/2>>1;l=e/2>>1;c=1==(t/2&1);u=1==(e/2&1);d=((this.mbRow<<3)+l)*a+(this.mbCol<<3)+s;h=this.mbRow*a+this.mbCol<<1;f=h+(a<<1);var _,S,T,w,O,A;if(c)if(u)for(;h<f;){_=i[d]+i[d+a];w=n[d]+n[d+a];d++;for(v=0;v<2;v++){S=i[d]+i[d+a];O=n[d]+n[d+a];d++;T=_+S+2>>2&255;A=w+O+2>>2&255;_=i[d]+i[d+a];w=n[d]+n[d+a];d++;T|=_+S+2<<6&65280;A|=w+O+2<<6&65280;S=i[d]+i[d+a];O=n[d]+n[d+a];d++;T|=_+S+2<<14&16711680;A|=w+O+2<<14&16711680;_=i[d]+i[d+a];w=n[d]+n[d+a];d++;T|=_+S+2<<22&4278190080;A|=w+O+2<<22&4278190080;y[h]=T;g[h]=A;h++}h+=o>>2;d+=o-1}else for(;h<f;){_=i[d];w=n[d];d++;for(v=0;v<2;v++){S=i[d];O=n[d++];T=_+S+1>>1&255;A=w+O+1>>1&255;_=i[d];w=n[d++];T|=_+S+1<<7&65280;A|=w+O+1<<7&65280;S=i[d];O=n[d++];T|=_+S+1<<15&16711680;A|=w+O+1<<15&16711680;_=i[d];w=n[d++];T|=_+S+1<<23&4278190080;A|=w+O+1<<23&4278190080;y[h]=T;g[h]=A;h++}h+=o>>2;d+=o-1}else if(u)for(;h<f;){for(v=0;v<2;v++){T=i[d]+i[d+a]+1>>1&255;A=n[d]+n[d+a]+1>>1&255;d++;T|=i[d]+i[d+a]+1<<7&65280;A|=n[d]+n[d+a]+1<<7&65280;d++;T|=i[d]+i[d+a]+1<<15&16711680;A|=n[d]+n[d+a]+1<<15&16711680;d++;T|=i[d]+i[d+a]+1<<23&4278190080;A|=n[d]+n[d+a]+1<<23&4278190080;d++;y[h]=T;g[h]=A;h++}h+=o>>2;d+=o}else for(;h<f;){for(v=0;v<2;v++){T=i[d];A=n[d];d++;T|=i[d]<<8;A|=n[d]<<8;d++;T|=i[d]<<16;A|=n[d]<<16;d++;T|=i[d]<<24;A|=n[d]<<24;d++;y[h]=T;g[h]=A;h++}h+=o>>2;d+=o}};t.prototype.decodeMotionVectors=function(){var t,e,r=0;if(this.macroblockMotFw){t=this.readCode(c.a.MOTION);if(0!==t&&1!==this.forwardF){r=this.buffer.getBits(this.forwardRSize);e=(Math.abs(t)-1<<this.forwardRSize)+r+1;t<0&&(e=-e)}else e=t;this.motionFwHPrev+=e;this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5);this.motionFwH=this.motionFwHPrev;this.fullPelForward&&(this.motionFwH<<=1);t=this.readCode(c.a.MOTION);if(0!==t&&1!==this.forwardF){r=this.buffer.getBits(this.forwardRSize);e=(Math.abs(t)-1<<this.forwardRSize)+r+1;t<0&&(e=-e)}else e=t;this.motionFwVPrev+=e;this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5);this.motionFwV=this.motionFwVPrev;this.fullPelForward&&(this.motionFwV<<=1)}else if(this.pictureCodingType===o.a.P){this.motionFwH=this.motionFwHPrev=0;this.motionFwV=this.motionFwVPrev=0}};t.prototype.decodeBlock=function(t){var e,r=0;if(this.macroblockIntra){var i,n;if(t<4){i=this.dcPredictorY;n=this.readCode(c.a.DCT_DC_SIZE_LUMINANCE)}else{i=4===t?this.dcPredictorCr:this.dcPredictorCb;n=this.readCode(c.a.DCT_DC_SIZE_CHROMINANCE)}if(n>0){var a=this.buffer.getBits(n);this.blockData[0]=0!=(a&1<<n-1)?i+a:i+(-1<<n|a+1)}else this.blockData[0]=i;t<4?this.dcPredictorY=this.blockData[0]:4===t?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0];this.blockData[0]<<=8;e=this.intraQuantMatrix;r=1}else e=this.nonIntraQuantMatrix;for(var o=0;;){var s=0,l=this.readCode(c.a.DCT_COEFF);if(1===l&&r>0&&0===this.buffer.getBits(1))break;if(65535===l){s=this.buffer.getBits(6);o=this.buffer.getBits(8);0===o?o=this.buffer.getBits(8):128===o?o=this.buffer.getBits(8)-256:o>128&&(o-=256)}else{s=l>>8;o=255&l;this.buffer.getBits(1)&&(o=-o)}r+=s;var u=c.a.ZIG_ZAG[r];r++;o<<=1;this.macroblockIntra||(o+=o<0?-1:1);o=o*this.quantizerScale*e[u]>>4;0==(1&o)&&(o-=o>0?1:-1);o>2047?o=2047:o<-2048&&(o=-2048);this.blockData[u]=o*c.a.PREMULTIPLIER_MATRIX[u]}var d,h,f;if(t<4){d=this.currentY;f=this.codedWidth-8;h=this.mbRow*this.codedWidth+this.mbCol<<4;0!=(1&t)&&(h+=8);0!=(2&t)&&(h+=this.codedWidth<<3)}else{d=4===t?this.currentCb:this.currentCr;f=(this.codedWidth>>1)-8;h=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)}if(this.macroblockIntra)if(1===r){this.copyValueToDestination(this.blockData[0]+128>>8,d,h,f);this.blockData[0]=0}else{this.IDCT();this.copyBlockToDestination(this.blockData,d,h,f);this.blockData.set(this.zeroBlockData)}else if(1===r){this.addValueToDestination(this.blockData[0]+128>>8,d,h,f);this.blockData[0]=0}else{this.IDCT();this.addBlockToDestination(this.blockData,d,h,f);this.blockData.set(this.zeroBlockData)}r=0};t.prototype.IDCT=function(){var t,e,r,i,n,a,o,s,l,c,u,d,h,f,p,g,y,v,m,b=this.blockData;for(m=0;m<8;++m){t=b[32+m];e=b[16+m]+b[48+m];r=b[40+m]-b[24+m];a=b[8+m]+b[56+m];o=b[24+m]+b[40+m];i=b[8+m]-b[56+m];n=a+o;s=b[0+m];h=(473*i-196*r+128>>8)-n;l=h-(362*(a-o)+128>>8);c=s-t;u=(362*(b[16+m]-b[48+m])+128>>8)-e;d=s+t;f=c+u;p=d+e;g=c-u;y=d-e;v=-l-(473*r+196*i+128>>8);b[0+m]=n+p;b[8+m]=h+f;b[16+m]=g-l;b[24+m]=y-v;b[32+m]=y+v;b[40+m]=l+g;b[48+m]=f-h;b[56+m]=p-n}for(m=0;m<64;m+=8){t=b[4+m];e=b[2+m]+b[6+m];r=b[5+m]-b[3+m];a=b[1+m]+b[7+m];o=b[3+m]+b[5+m];i=b[1+m]-b[7+m];n=a+o;s=b[0+m];h=(473*i-196*r+128>>8)-n;l=h-(362*(a-o)+128>>8);c=s-t;u=(362*(b[2+m]-b[6+m])+128>>8)-e;d=s+t;f=c+u;p=d+e;g=c-u;y=d-e;v=-l-(473*r+196*i+128>>8);b[0+m]=n+p+128>>8;b[1+m]=h+f+128>>8;b[2+m]=g-l+128>>8;b[3+m]=y-v+128>>8;b[4+m]=y+v+128>>8;b[5+m]=l+g+128>>8;b[6+m]=f-h+128>>8;b[7+m]=p-n+128>>8}};t.prototype.copyBlockToDestination=function(t,e,r,i){for(var n=0;n<64;n+=8,r+=i+8){e[r+0]=t[n+0];e[r+1]=t[n+1];e[r+2]=t[n+2];e[r+3]=t[n+3];e[r+4]=t[n+4];e[r+5]=t[n+5];e[r+6]=t[n+6];e[r+7]=t[n+7]}};t.prototype.addBlockToDestination=function(t,e,r,i){for(var n=0;n<64;n+=8,r+=i+8){e[r+0]+=t[n+0];e[r+1]+=t[n+1];e[r+2]+=t[n+2];e[r+3]+=t[n+3];e[r+4]+=t[n+4];e[r+5]+=t[n+5];e[r+6]+=t[n+6];e[r+7]+=t[n+7]}};t.prototype.copyValueToDestination=function(t,e,r,i){for(var n=0;n<64;n+=8,r+=i+8){e[r+0]=t;e[r+1]=t;e[r+2]=t;e[r+3]=t;e[r+4]=t;e[r+5]=t;e[r+6]=t;e[r+7]=t}};t.prototype.addValueToDestination=function(t,e,r,i){for(var n=0;n<64;n+=8,r+=i+8){e[r+0]+=t;e[r+1]+=t;e[r+2]+=t;e[r+3]+=t;e[r+4]+=t;e[r+5]+=t;e[r+6]+=t;e[r+7]+=t}};t.prototype.copyBlockToDestinationClamp=function(t,e,r,i){for(var n=0,a=0;a<8;a++){for(var o=0;o<8;o++){var s=t[n++];e[r++]=s>255?255:s<0?0:s}r+=i}};t.prototype.addBlockToDestinationClamp=function(t,e,r,i){for(var n=0,a=0;a<8;a++){for(var o=0;o<8;o++){var s=t[n++]+e[r];e[r++]=s>255?255:s<0?0:s}r+=i}};t.prototype.YCbCrToRGBA=function(){for(var t,e,r,i,n,a=this.currentY,o=this.currentCb,s=this.currentCr,l=this.currentRGBA.data,c=0,u=this.codedWidth,d=this.codedWidth+(this.codedWidth-this.width),h=0,f=this.halfWidth-(this.width>>1),p=0,g=4*this.width,y=4*this.width,v=this.width>>1,m=this.height>>1,b=0;b<m;b++){for(var E=0;E<v;E++){t=o[h];e=s[h];h++;r=e+(103*e>>8)-179;i=(88*t>>8)-44+(183*e>>8)-91;n=t+(198*t>>8)-227;var _=a[c++],S=a[c++];l[p]=_+r;l[p+1]=_-i;l[p+2]=_+n;l[p+3]=255;l[p+4]=S+r;l[p+5]=S-i;l[p+6]=S+n;l[p+7]=255;p+=8;var T=a[u++],w=a[u++];l[g]=T+r;l[g+1]=T-i;l[g+2]=T+n;l[g+3]=255;l[g+4]=w+r;l[g+5]=w-i;l[g+6]=w+n;l[g+7]=255;g+=8}c+=d;u+=d;p+=y;g+=y;h+=f}this.hasDecodeColor=!0};t.prototype.fillArray=function(t,e){for(var r=0,i=t.length;r<i;r++)t[r]=e};return t}()},519:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function t(){i(this,t)};e.a=n;n.SEQUENCE=179;n.SLICE_FIRST=1;n.SLICE_LAST=175;n.PICTURE=0;n.EXTENSION=181;n.USER_DATA=178},520:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function t(){i(this,t)};e.a=n;n.I=1;n.P=2;n.B=3},521:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function t(){i(this,t)};e.a=n;n.DEFAULT_INTRA_QUANT=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]);n.DEFAULT_NON_INTRA_QUANT=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16])},522:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function t(){i(this,t)};e.a=n;n.I=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]);n.P=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]);n.B=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]);n.TYPE_TABLE=[null,n.I,n.P,n.B];n.ADDRESS_INCREMENT=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22])},523:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function t(){i(this,t)};e.a=n;n.PREMULTIPLIER_MATRIX=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]);n.ZIG_ZAG=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);n.DCT_COEFF=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]);n.DCT_DC_SIZE_CHROMINANCE=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]);n.DCT_DC_SIZE_LUMINANCE=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]);n.MOTION=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]);n.CODE_BLOCK_PATTERN=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31])},524:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function t(){i(this,t)};e.a=n;n.SHADER_FRAGMENT_YCBCRTORGBA=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n");n.SHADER_FRAGMENT_LOADING=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n");n.SHADER_VERTEX_IDENTITY=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n")},525:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(526),c=r(527),u=r(528),d=r(10);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){var t=this;Object(s.d)(this.container,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:d.a.overlayContainer});var e={store:this.store,parent:this.container};this.controls={start:new l.a(e),replay:new c.a(e),formLoader:new u.a(e)};Object.keys(this.controls).forEach(function(e){t.controls[e].hide();t.controls[e].render()});this.parent.appendChild(this.container);this.updateVisible()};e.prototype.updateVisible=function(){var t=this;this.overlay=this.store.getState().application.overlay;Object.keys(this.controls).forEach(function(e){return t.controls[e].hide()});if(this.overlay){this.controls[this.overlay].show();this.show()}else this.hide()};e.prototype.update=function(){this.overlay!==this.store.getState().application.overlay&&this.updateVisible()};return e}(o.a)},526:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(88),c=r.n(l),u=r(76),d=r(4),h=r(147),f=r(22),p=r(13);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");Object(s.d)(this.container,{display:"block",width:"100%",height:"100%",cursor:"pointer"});this.addClickEvent(Object(u.a)(c.a,Object(s.c)(this.container,"div",{position:"absolute",zIndex:20,padding:10,width:"100px",height:"100px",left:"50%",top:"50%",transform:"translate(-50%, -50%)"})),this.onClick.bind(this));this.parent.appendChild(this.container);this.addClickEvent(this.container,this.onClick.bind(this))};e.prototype.onClick=function(t){Object(s.e)(t);var e=this.store.getState(),r=e.player.status,i=e.vqPlayback.sound.type;this.store.dispatch(Object(p.h)("Tracker:userAction",{trackingParams:{name:h.a.BigPlay,disablePing:!0}}));this.store.dispatch(Object(f.r)(r,{force:!0}));if("asvideo"===i){var n=Object(d.i)("vq-volume")||.7;this.store.dispatch(Object(f.z)(n,{force:!0}))}};return e}(o.a)},527:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(330),c=r.n(l),u=r(76),d=r(22);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");Object(s.d)(this.container,{display:"block",width:"100%",height:"100%",cursor:"pointer"});Object(s.c)(this.container,"div",{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:10,background:"rgba(0, 0, 0, .7)"});this.addClickEvent(Object(u.a)(c.a,Object(s.c)(this.container,"div",{position:"absolute",zIndex:20,padding:10,width:"100px",height:"100px",left:"50%",top:"50%",transform:"translate(-50%, -50%)"})),this.onClick.bind(this));this.parent.appendChild(this.container);this.addClickEvent(this.container,this.onClick.bind(this))};e.prototype.onClick=function(t){Object(s.e)(t);this.store.dispatch(Object(d.t)())};return e}(o.a)},528:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(7),s=r(8),l=r(2),c=o.a.staticUrl+"/"+r(331);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");Object(l.d)(this.container,{display:"block",width:"100%",height:"100%"});Object(l.c)(this.container,"div",{width:"100%",height:"100%",top:0,left:0,position:"absolute",background:"url('"+c+"') no-repeat",backgroundSize:"100% auto"});this.parent.appendChild(this.container)};return e}(s.a)},529:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(530),c=r(10);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){Object(s.d)(this.container,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:c.a.spinner});Object(l.a)(this.container,this.container);this.parent.appendChild(this.container);this.updateVisible()};e.prototype.updateVisible=function(){var t=this.store.getState(),e=t.player,r=e.hasLoaded,i=e.hasBuffered,n=e.mediaFiles,a=e.hasSeekBuffered;t.application.overlay?this.hide():!r||i||a||!n.length?this.show():this.hide()};e.prototype.update=function(){this.updateVisible();t.prototype.update.call(this)};return e}(o.a)},530:function(t,e,r){"use strict";var i=r(2),n=r(332),a=r.n(n);e.a=function(t,e){Object(i.b)(t,"videonow-spin",[{percent:"0%",css:{webkitTransform:"translate(-50%, -50%) rotate(0deg)",transform:"translate(-50%, -50%) rotate(0deg)"}},{percent:"100%",css:{webkitTransform:"translate(-50%, -50%) rotate(360deg)",transform:"translate(-50%, -50%) rotate(360deg)"}}]);return Object(i.c)(e,"div",{position:"absolute",zIndex:3,animation:"videonow-spin 1s linear infinite",top:"50%",left:"50%",width:"50px",height:"50px",lineHeight:0,background:"url('data:image/svg+xml;utf8,"+a.a+"')"})}},531:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(4),l=r(532),c=r.n(l),u=r(5),d=r(533),h=r.n(d),f=r(7),p=r(10),g=r(102),y=r(333);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.getAnimationType=function(){var e=t.prototype.getAnimationType.call(this);return e===g.a.UP?"bottom":e};e.prototype.render=function(){var e=Object(s.b)(f.a.playerHomeUrl,{utm_source:location.href,utm_campaign:"logoclick"});this.container=document.createElement("div");this.logo=Object(o.d)(this.container,{position:"absolute",zIndex:p.a.playerLogo,top:"15px",right:"10px",cursor:"pointer",maxWidth:"80px",maxHeight:"30px",width:"8%",height:"5%",display:"inline-block"});this.container.innerHTML=""+c.a+h.a;this.addClickEvent(this.container,function(t){Object(o.e)(t);Object(s.s)(e)});var r=this.logo,i=r.firstElementChild,n=r.lastElementChild;Object(o.d)([i,n],{position:"absolute",top:0,left:0});Object(o.d)(n,{display:"none"});this.container.addEventListener("mouseenter",function(){i.style.display="none";n.style.display=""});this.container.addEventListener("mouseleave",function(){i.style.display="";n.style.display="none"});this.parent.appendChild(this.container);this.update();t.prototype.render.call(this)};e.prototype.update=function(){var e=this.store.getState(),r=e.player,i=r.hasHover,n=r.canSeeStats,a=r.canEdit,o=e.options,s=o.hasOverlayMode,l=o.forceHideEditorControls,c=n||a;this.applyStyle(l||s||i&&!c||u.f&&!c);t.prototype.update.call(this)};return e}(y.a)},532:function(t,e){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg width="100%" height="100%" viewBox="0 0 120 39" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;opacity:0.5;">\n    <g transform="matrix(1,0,0,1,-4.67089,-15.5028)">\n        <g transform="matrix(1.07016,0,0,1.07016,-247.784,-110.449)">\n            <g id="Layer1">\n                <g>\n                    <g id="LOGO-platform" transform="matrix(0.908,0,0,0.908,230.326,99.8573)">\n                        <path d="M14.611,27.07L19.706,37.994L24.823,27.07L33.246,27.07L22.161,48.367L17.135,48.367L6.143,27.07L14.611,27.07Z" style="fill:white;fill-rule:nonzero;"/>\n                        <rect x="35.793" y="27.07" width="7.527" height="21.297" style="fill:white;fill-rule:nonzero;"/>\n                        <path d="M64.961,59.016L64.961,46.279C64.151,47.12 63.363,47.725 62.598,48.092C61.267,48.734 59.844,49.056 58.329,49.056C55.208,49.056 52.584,47.878 50.458,45.521C48.576,43.441 47.635,40.855 47.635,37.765C47.635,34.169 48.866,31.285 51.33,29.113C53.395,27.292 55.751,26.382 58.398,26.382C61.152,26.382 63.34,27.392 64.961,29.411L64.961,27.07L72.489,27.07L72.489,59.016L64.961,59.016ZM60.326,32.876C58.964,32.876 57.817,33.351 56.883,34.299C55.935,35.248 55.46,36.372 55.46,37.673C55.46,39.035 55.935,40.197 56.883,41.161C57.817,42.11 58.964,42.584 60.326,42.584C61.672,42.584 62.82,42.11 63.768,41.161C64.717,40.213 65.191,39.065 65.191,37.719C65.191,36.372 64.72,35.233 63.78,34.299C62.839,33.366 61.687,32.892 60.326,32.876Z" style="fill:white;fill-rule:nonzero;"/>\n                        <path d="M100.211,39.096L84.376,39.096C84.422,42.293 85.952,43.892 88.966,43.892C89.869,43.892 90.592,43.743 91.135,43.445C91.678,43.146 92.187,42.622 92.661,41.873L99.913,41.873C99.439,43.464 98.804,44.726 98.008,45.659C96.999,46.837 95.721,47.717 94.176,48.298C92.508,48.91 90.756,49.216 88.92,49.216C84.682,49.216 81.454,47.885 79.236,45.223C77.584,43.234 76.757,40.802 76.757,37.925C76.757,35.615 77.293,33.511 78.364,31.614C80.307,28.187 83.726,26.474 88.622,26.474C91.988,26.474 94.665,27.369 96.654,29.159C97.924,30.306 98.834,31.656 99.385,33.209C99.936,34.762 100.211,36.724 100.211,39.096ZM93.212,34.735C92.952,33.68 92.435,32.85 91.663,32.245C90.89,31.641 89.945,31.339 88.829,31.339C87.681,31.339 86.736,31.637 85.994,32.234C85.252,32.831 84.782,33.664 84.583,34.735L93.212,34.735Z" style="fill:white;fill-rule:nonzero;"/>\n                        <path d="M116.482,26.29C120.705,26.29 124.002,27.575 126.374,30.146C128.332,32.257 129.311,34.781 129.311,37.719C129.311,41.176 128.026,44.007 125.456,46.21C123.161,48.184 120.131,49.17 116.368,49.17C113.981,49.17 111.747,48.658 109.667,47.633C107.723,46.669 106.201,45.2 105.1,43.227C104.151,41.559 103.677,39.662 103.677,37.535C103.677,34.246 104.962,31.484 107.532,29.25C109.751,27.338 112.734,26.351 116.482,26.29ZM116.482,32.785C115.136,32.785 113.996,33.259 113.063,34.208C112.114,35.171 111.64,36.304 111.64,37.604C111.64,38.996 112.114,40.174 113.063,41.138C113.996,42.087 115.144,42.561 116.505,42.561C117.836,42.561 118.976,42.087 119.925,41.138C120.873,40.174 121.348,39.019 121.348,37.673C121.348,36.311 120.881,35.16 119.948,34.219C119.014,33.278 117.859,32.8 116.482,32.785Z" style="fill:white;fill-rule:nonzero;"/>\n                    </g>\n                    <g transform="matrix(0.771434,0,0,0.267539,195.915,-82.2031)">\n                        <path d="M132.078,751.026C132.078,748.898 131.479,747.171 130.741,747.171L103.311,747.171C102.573,747.171 101.973,748.898 101.973,751.026C101.973,753.154 102.573,754.881 103.311,754.881L130.741,754.881C131.479,754.881 132.078,753.154 132.078,751.026Z" style="fill:white;"/>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>\n'},533:function(t,e){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg width="100%" height="100%" viewBox="0 0 120 39" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">\n    <g transform="matrix(1,0,0,1,-4.67089,-15.5028)">\n        <g transform="matrix(1.07016,0,0,1.07016,-247.784,-110.449)">\n            <g id="Layer1">\n                <g>\n                    <g id="LOGO-platform" transform="matrix(0.908,0,0,0.908,230.326,99.8573)">\n                        <path d="M14.611,27.07L19.706,37.994L24.823,27.07L33.246,27.07L22.161,48.367L17.135,48.367L6.143,27.07L14.611,27.07Z" style="fill:url(#gradient);fill-rule:nonzero;"/>\n                        <rect x="35.793" y="27.07" width="7.527" height="21.297" style="fill:url(#gradient);fill-rule:nonzero;"/>\n                        <path d="M64.961,59.016L64.961,46.279C64.151,47.12 63.363,47.725 62.598,48.092C61.267,48.734 59.844,49.056 58.329,49.056C55.208,49.056 52.584,47.878 50.458,45.521C48.576,43.441 47.635,40.855 47.635,37.765C47.635,34.169 48.866,31.285 51.33,29.113C53.395,27.292 55.751,26.382 58.398,26.382C61.152,26.382 63.34,27.392 64.961,29.411L64.961,27.07L72.489,27.07L72.489,59.016L64.961,59.016ZM60.326,32.876C58.964,32.876 57.817,33.351 56.883,34.299C55.935,35.248 55.46,36.372 55.46,37.673C55.46,39.035 55.935,40.197 56.883,41.161C57.817,42.11 58.964,42.584 60.326,42.584C61.672,42.584 62.82,42.11 63.768,41.161C64.717,40.213 65.191,39.065 65.191,37.719C65.191,36.372 64.72,35.233 63.78,34.299C62.839,33.366 61.687,32.892 60.326,32.876Z" style="fill:url(#gradient);fill-rule:nonzero;"/>\n                        <path d="M100.211,39.096L84.376,39.096C84.422,42.293 85.952,43.892 88.966,43.892C89.869,43.892 90.592,43.743 91.135,43.445C91.678,43.146 92.187,42.622 92.661,41.873L99.913,41.873C99.439,43.464 98.804,44.726 98.008,45.659C96.999,46.837 95.721,47.717 94.176,48.298C92.508,48.91 90.756,49.216 88.92,49.216C84.682,49.216 81.454,47.885 79.236,45.223C77.584,43.234 76.757,40.802 76.757,37.925C76.757,35.615 77.293,33.511 78.364,31.614C80.307,28.187 83.726,26.474 88.622,26.474C91.988,26.474 94.665,27.369 96.654,29.159C97.924,30.306 98.834,31.656 99.385,33.209C99.936,34.762 100.211,36.724 100.211,39.096ZM93.212,34.735C92.952,33.68 92.435,32.85 91.663,32.245C90.89,31.641 89.945,31.339 88.829,31.339C87.681,31.339 86.736,31.637 85.994,32.234C85.252,32.831 84.782,33.664 84.583,34.735L93.212,34.735Z" style="fill:url(#gradient);fill-rule:nonzero;"/>\n                        <path d="M116.482,26.29C120.705,26.29 124.002,27.575 126.374,30.146C128.332,32.257 129.311,34.781 129.311,37.719C129.311,41.176 128.026,44.007 125.456,46.21C123.161,48.184 120.131,49.17 116.368,49.17C113.981,49.17 111.747,48.658 109.667,47.633C107.723,46.669 106.201,45.2 105.1,43.227C104.151,41.559 103.677,39.662 103.677,37.535C103.677,34.246 104.962,31.484 107.532,29.25C109.751,27.338 112.734,26.351 116.482,26.29ZM116.482,32.785C115.136,32.785 113.996,33.259 113.063,34.208C112.114,35.171 111.64,36.304 111.64,37.604C111.64,38.996 112.114,40.174 113.063,41.138C113.996,42.087 115.144,42.561 116.505,42.561C117.836,42.561 118.976,42.087 119.925,41.138C120.873,40.174 121.348,39.019 121.348,37.673C121.348,36.311 120.881,35.16 119.948,34.219C119.014,33.278 117.859,32.8 116.482,32.785Z" style="fill:url(#gradient);fill-rule:nonzero;"/>\n                    </g>\n                    <g transform="matrix(0.771434,0,0,0.267539,195.915,-82.2031)">\n                        <path d="M132.078,751.026C132.078,748.898 131.479,747.171 130.741,747.171L103.311,747.171C102.573,747.171 101.973,748.898 101.973,751.026C101.973,753.154 102.573,754.881 103.311,754.881L130.741,754.881C131.479,754.881 132.078,753.154 132.078,751.026Z" style="fill:url(#gradient);"/>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n    <defs>\n        <linearGradient id="gradient" x1="0" y1="0" x2="1" y2="0" gradientUnits="userSpaceOnUse" gradientTransform="matrix(96.7807,0,0,96.7807,21.3907,35.4158)"><stop offset="0%" style="stop-color:rgb(249,124,0);stop-opacity:1"/><stop offset="100%" style="stop-color:rgb(201,74,0);stop-opacity:1"/></linearGradient>\n    </defs>\n</svg>\n'},534:function(t,e,r){"use strict";e.a={up:{name:"bottom",activeCss:{bottom:"10px",opacity:1},inActiveCss:{bottom:"-30px",opacity:1}},bottom:{name:"top",activeCss:{top:"5px",opacity:1},inActiveCss:{top:"-64px",opacity:1}},alpha:{name:"opacity",activeCss:{bottom:"10px",opacity:1},inActiveCss:{bottom:"10px",opacity:0}},visible:{name:"bottom",activeCss:{bottom:"10px",opacity:1},inActiveCss:{bottom:"10px",opacity:1}}}},535:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(5),c=r(76),u=r(536),d=r.n(u),h=r(537),f=r.n(h),p=r(538),g=r.n(p),y=r(13),v=r(10);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){var t=this;this.container=document.createElement("div");Object(s.d)(this.container,{position:"absolute",zIndex:v.a.editorButtons,width:"100px",height:"30px",top:"5px",right:"5px",cursor:"pointer",display:"flex",justifyContent:"flex-end",alignItems:"center"});this.staticsButton=Object(s.c)(this.container,"div",{display:"none",vertcalAlign:"top",width:"30px",height:"30px",cursor:"pointer",marginRight:"10px"});this.addClickEvent(this.staticsButton,function(e){Object(s.e)(e);t.store.dispatch(Object(y.h)("Modal:stats"))});this.editorButton=Object(s.c)(this.container,"div",{display:"none",vertcalAlign:"top",width:"30px",height:"30px",cursor:"pointer",marginRight:"10px"});this.addClickEvent(this.editorButton,function(e){Object(s.e)(e);t.store.dispatch(Object(y.h)("Modal:editor"))});var e=Object(c.a)(f.a,this.staticsButton,null,g.a),r=Object(c.a)(d.a,this.editorButton,null,g.a);e.classList.add("t-viqeo-stats-button");r.classList.add("t-viqeo-edit-button");Object(s.d)(r.firstChild,{width:"75%",height:"75%",top:"3px",left:"3px"});this.parent.appendChild(this.container)};e.prototype.update=function(){var t=this.store.getState(),e=t.player,r=e.hasHover,i=e.canSeeStats,n=e.canEdit,a=t.options,o=a.hasOverlayMode,c=a.forceHideEditorControls,u=a.hideEditor;if(!l.f&&!r||o||c){Object(s.d)(this.container,{display:"none"});Object(s.d)(this.staticsButton,{display:"none"});Object(s.d)(this.editorButton,{display:"none"})}else{Object(s.d)(this.staticsButton,{display:i?"inline-block":"none"});Object(s.d)(this.editorButton,{display:n?"inline-block":"none"});(i||n)&&Object(s.d)(this.container,{display:"block"})}u&&Object(s.d)(this.editorButton,{display:"none"})};return e}(o.a)},536:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">\n  <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="#F97C22"/>\n  <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n'},537:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 30 30">\n  <g transform="matrix(0.290847,0,0,0.290847,-211.455,-99.1088)">\n        <g transform="matrix(1,0,0,1,0,360.418)">\n            <rect x="747.703" y="24.888" width="18.09" height="31.416" style="fill:#F97C22;fill-rule:nonzero;"/>\n        </g>\n        <g transform="matrix(1,0,0,1,0,360.418)">\n            <rect x="769.562" y="7.526" width="18.091" height="48.778" style="fill:#F97C22;fill-rule:nonzero;"/>\n        </g>\n        <g transform="matrix(1,0,0,1,0,360.418)">\n            <rect x="791.421" y="31.915" width="18.091" height="24.389" style="fill:#F97C22;fill-rule:nonzero;"/>\n        </g>\n    </g>\n</svg>\n'},538:function(t,e){t.exports='<svg width="100%" height="100%" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-miterlimit:1.41421;">\n    <g id="svg_1" transform="matrix(0.5,-2.31112e-34,0,0.5,-1,-1)">\n        <circle cx="32" cy="32" r="28" style="fill-opacity:0.501961;stroke:#F97C22;stroke-width:3px;"/>\n    </g>\n</svg>\n'},539:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(4),l=r(2),c=r(5),u=r(540),d=r.n(u),h=r(541),f=r.n(h),p=r(10),g=r(12),y=r(25);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(g.a)(a,[{getValues:function(t){return{status:t.player.status}},onChange:a.changeStatus.bind(a)}],a.store);return a}a(e,t);e.prototype.startAnimation=function(){Object(s.z)("vq_swipe",!0);this.show();setTimeout(this.hide.bind(this),3500)};e.prototype.changeStatus=function(){var t=this.store.getState(),e=t.player.status,r=t.vqControls.progress.hidden,i=Object(s.i)("vq_swipe");!c.f||i||r||e!==y.a.STARTED||this.startAnimation()};e.prototype.render=function(){this.container=document.createElement("div");Object(l.d)(this.container,{display:"none",zIndex:p.a.swipeForward,position:"absolute",top:0,left:0,width:"100%",height:"100%"});var t=this.store.getState(),e=t.player,r=e.width,i=e.height,n=r/i,a=n>1?.5:1/3;this.svgContainer=Object(l.c)(this.container,"div",{position:"absolute",zIndex:0,transform:"translate(-50%, 0)",webkitTransform:"translate(-50%, 0)",bottom:0,left:"50%",height:100*a+"%",width:"80%",pointerEvents:"none"});Object(l.c)(this.svgContainer,"div",{},f.a);var o=Object(l.c)(this.svgContainer,"div",{position:"absolute",height:"100%",width:"100px",top:0,left:"50%",webkitTransform:"translateX(-50%)",transform:"translateX(-50%)"},d.a);Object(l.b)(o,"videonow_swipe",[{percent:"0%",css:{left:"40%"}},{percent:"50%",css:{left:"60%"}},{percent:"100%",css:{left:"40%"}}]);Object(l.d)(o,{animation:"videonow_swipe 3s ease infinite "});this.parent.appendChild(this.container)};return e}(o.a)},540:function(t,e){t.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg width="100%" height="100%" viewBox="0 0 340 376" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;">\n    <g transform="matrix(1,0,0,1,42.4123,42.4528)">\n        <g transform="matrix(1,-0,-0,1,-42.4123,-42.4528)">\n            <use xlink:href="#vq_hand" x="40" y="44" width="267.628px" height="297.224px" transform="matrix(0.998613,0,0,0.997395,0,0)"/>\n        </g>\n        <g transform="matrix(-6.38027,0,0,6.38027,1055.55,-453.08)">\n            <path d="M156.242,90.677C155.393,89.994 152.898,89.951 150.898,92.61C149.922,93.907 149.005,92.429 148.998,90.865C148.99,89.3 148.671,81.141 148.671,81.141C148.733,80.377 148.122,79.709 147.305,79.649C146.5,79.598 145.775,80.163 145.711,80.928L144.788,88.73C143.916,88.188 142.444,88.601 142.158,89.356C140.657,88.743 139.124,89.386 138.611,90.18C136.577,89.821 135.356,91.058 135.259,92.214C135.194,92.986 135.058,99.321 136.368,100.491C137.677,101.661 137.271,104.912 137.271,104.912C139.463,107.123 145.304,107.479 147.587,105.445C147.888,102.687 150.981,101.469 152.193,99.985C153.406,98.5 154.359,94.995 156.182,92.659C156.893,91.89 157.088,91.36 156.242,90.677Z" style="fill:white;fill-rule:nonzero;stroke:rgb(204,204,204);stroke-width:0.29px;"/>\n        </g>\n    </g>\n    <defs>\n        <image id="vq_hand" width="268px" height="298px" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQwAAAEqCAYAAADgeW64AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAgAElEQVR4nO1d7ZbcOgp0svv+r5z9sdt3Ox5JQFEgZFPnzBkboY+2pVKBepJfV+Nk/Ero409CH41D8Hv3ABowMsii0fgLPelq4eT30UrkBWiFUQcnk0XjJehJugdveu6tPB6EVhj5eBNZNB6Gnrw56Of8E608DkQrjHg0WTQeg57MXPTzxNGK4wC0wuChyaLxePQk56CfIx+tOAqiFYYfTRaN16AnO4Z+bnlopVEIrTDsaLJovBY9+W3o57UfrTg2ohWGHk0WjdejF8Ea1Z5PhfFU2eGrjONVaIUxR4XF+Y1q42m8ED0Jx9j1XE5+H7t2/FYaiWiF8RNNFo3GBD1J/0b283jD889WAK04AtEK4/9osmg0BPSk/S+ynkM/7zwF0EojAK0wmiwaDTXePomjP//bn68G0UqglQYRb1YYTRaNhhFvndRPJwtr/xV24VYaB+CNCqPJYlxn97gbB+BtkyTq8z6dhO7I2K2j+mil4cCbFEaTBQ8Vx9RIwJtefMRnZbd5+vuI2L3ZbbbCcOBNCoONJoufeMJnaCzwlhdcdXE//fkzd/NWGgXwBoXRZLEPb/iMr8LTX+jTySLj/VVTCa00NuLJhPFUstj5zios+CaMjXgqYVQjC7T+Ce8HWXDVVAuznUfjiTmMJotcIN8SPeWzNW544otjfqZssnjC+9ilOFppJOCJCoOFJgsMrTgejKe9qN2JyaoLZdRPxX/5qpVGcTyJMN5OFhHvckdyssopShPGAE8hjFPIYvc4GfAsJGvdzL6i23kEnkAYuxdhFllUfFfoYsoIU5owAlBxElrB+AxVyeKk9xN5OtJKowhOmpAzVP+eROXcRoV/pCaaNJowiDidMJosfPW0iF6srTQOwcmE8RSy2K1AEETlIDS+rTQ2osLkQ7GDMHaSRdV3FaEOJN9WGptQdRJqUPWbmLsVyE4wFUIUaTRhOHDSZPzGyWTB8qkM1mKPzG00cQA4cWKeShbeci2Y7zT6W5dMQsj8UlhEO0fgNMJosvDV8SIqDGARws4w5RXEcRJhNFlg/pFg7uqn5zaaMIrBM9aoHdxDBjuTnr+uvf+HyMzvdNJgtVEWbyCMqHpo+YlfJ4/ID3jVRlXSaMIogGrqIpIsTjhuzVIC0eXseuw2yuEEwqiWu4giixOI4o4M4jiVNJowNqDJwuazG1GL+1TSYLVRBpUn4dvJosK/nxGx0HapjVYaBDyVME4gC8YJCurvAeNvQqKUhsZv17dCH0EcTySMt5BFhXcXfYzqIQ52mNJK46ox6UZ4I1lE5jGQeplHqagiyM5tvF5pVCSMp5LFE05PIk9F3kIaTRhEZOUtTiCL6icnO05EKp2ivPKP1yoRRtapQHWyiPhDNW297FORzBClmtJgt5OCpxAGS11kkEVkMjTyfUYmOK11WmlswhMIg5W7qEoWUYqDgQz1kB2itNJYoAphvJksovIb2YhUCZlhjaacVSezPQoqTLzdZIGWRZEF+5ufnnfM3G0tRFAhRNmlNKLao2A3YTRZ4PW1bbIRkcvYqTY89Vh1MttzYSdhVCALqTyLADxEUTWHsfJ5Mmk0YRTrN+v7FpXJYgeZRJxARBHHbtLw1otuC8YOwjjh+xa7yCLiyDcC7IV3t1dNiL7+2PU0wsj4vkUGWWQduWaAtfg8CoR5VIu0J+ExSuMkwth5hBqtIljf5VgBqceK3z3KYleIUpU0XkUYTRa68VT+EpfnlIRNHJHJU0a51z+rLTUyCeMpZDGyR5JFBZJYgZVD0NgiciAru6b8Vd8MfRphnEwWrLyG1UcL9Ah1VYaQRKXvd2jLvf5ZbYl4EmHsSHJGkcUpCVDGTo4qi2ohyiuURvQkq3CEWoUsPERRiSRmyEh47g5R2EoDrRPZzhKRE64CWazKPScTDGWRRRYVwpLKpKHtl1HG8I9uZ4kowsgiC8m3Alkwj1qrJUCjEp4s4ogIW7xlzDqR7QwRMcEyyWLlnxWKZJCFN/lp8RuBnfCsSBpWX08Zwz+6nSGqEcabyCIip6EtZ4CxK+8kjoqkgdaJbOcvVCKMDLIYlUeQhXS/OwGq8bVMuOzwQ+NzKmm8ijCy1MVusrjbVmTASH56SIL9jpGTgizieAppoHUi27muizuZKpyKMEIRD1lI9yyyYB6zftdhTmwWcWSQhsWG2KUyhn90O9d18QijwqnIbrKIDlEsNks5AjZJjGzR91ofi5+1HQ1KEQdjMlU/FUF36CxlwTpJkeyRqEoKFUOUo5VG9mL3tpFFFtb7iLLRvcU2A/LOtJMNIQ5vufX+rUpjO2FkhzM7Q5EKZGEligylYdlhK92/UWlsJYwmi7wyTbmmDPH7QDPZ0F05kwgYIYzFz9qOBluJw5tVz+ibdSqSmeTMDFFWdqnMC88ubFn4WXU19yv745XGLsLIPhU5nSxOTHrO7KzFXiFEeZ3S2EEYVU5F0NAjmhCiEp8MIkGTnx7iiFIbLEJ4ldJgLd7s/naRxaoM8fOqit1Jz+vyJT7vtojFX01poGUMf3ddRmgQVX9XKBJJEN/3EbkMqUxTroF1l2SphJNIY2Zb2aUyhr+rXlXCOClv4VUWkUnPnSojMvEZEc4wkqE7lEZqaFKRMJDdEwlFIpKcVoLxkgWSy0D80dyF1oYQQDbZaMo19TR2qQzxo9RnLOKsvqonOaOUhTeXoSlHsTt/UTHnoWlDsmvLUV+4nmYisSZbFmFo/CKTnExlEZnLsPgxFQaLOLJUCEtpROczHkUYlcliVZ5JFpG5DKkMhUeWsxdzZlgj+VpsiN3rC9fPIIwoshiVZYQiFcmCkctggJEY9JBAFtFo7i02xI76uepHx76W+hHqYnfeIjuXMbNZyrWwSulMhREVuiDhiTY0WZWVCU0iJay1fjRhaMnjBLKIyGV44El+ViGKTKURSRqvIIwT1AUacniIo3ouwyO5EeLQ2D3kUIE0EDLx+qrrVSAML1lobFGhSDWy2JnLQGJ4lESk/MVTSeOxhOFVF6eRxcyeQRwWm6V8BWkyWhdPdCjiUSzavqQyyd9j9/qq60UQBiN34SEMRijCzFtE9Dez7cploGHI3cZa2ChpeBWI1IamPmpH/Uz1kBhYQlTuoslCfy/ZpTIJ3qQdkr+wXkeShqbN2b3WB7F7fUX/iJh3Z+4CWWQe+4ok0Pqra6lsZlvZGUAVRmYoEqk0PJ9zZUPsqJ/Kn00YXrKYlVVUFyzFYSWsUZnFpinTwDKR0QXFDkUs5OC5lsokf48d9VPVYxIGIxSZlTEJY1coghKQVCb5r2xMMInCc60tP500mjAMdoa6yAhFvGSRSRQaP3SSVgtFENKwqh2pTHOP2lE/sc4OwkBibDTcWJUxFIiGJJhhDnqvLUPBzmFkhiJM9bIaI3qP2lG/pf8JhLFLXXhCkSiVYSnT2K0+1yVPPM3ERmS8J/xAbJby1bWlbHSP2lG/pf9vYyOnQZL0K7u2jRkJaWxWotKWrey/Jj9aSHVXYxn5SJ9rdX1vZ1SO2q6JDQkfPWpRsqfCImUt7Vj9TlUXkZMVmZgWWxQ8yc8doUiUuqimMughSTRZrHwZhKEtY4UdI5u1zFK+up7ZVu+GQSLW8CQi2RlFGowkaCXSeHxIwlI/mjY0SmRWZ7VwtfKWIXlnkn/kx1Icq9BEMy4ppNBcs4ke6VdTT0K0CrS+96F/psLYFY5ETES0DLGtrqWymW1lt8Ky41l334xTEVZiVONrKRvdr+wpyc+qCsOqLjT+6I6AynoWgYyupTLJxtzNZm1KttHnuV/PfFg2b1szMDZiK1L6qUoYHmhelpWAvm2WybiqL9lW40H8NZ9Z+6NpY9X3nTg09vs1w+Ylm9U4Z9CqxVV7WST0A7sJA/3gLAb37iRSPZRAVuXShJMW670MURwaEtESx8z3bmeqitkYLLCQtqZ/je927CaMSEgLEWmLqSQs/Y3qSkSyWsQjX8/PrG3N2CzXWarC2vY1sTEUgqWNcLLxEoZ1ASC+jIcr+a4evnd38k7s0bW27Ns2IwkGtGpCM27JnqUqVj4IUVRREq737iEM7wdG61vrsQgnm0BGY1pNOk1dzWTRKgqp7nWN/VflGvsllK38rT53ILs6ojiqkMsPnB6SWCWftHtL9aW2WD7axT/zlxbt3c+qODT1NMSBXGeqCo+q2akgwpBBGFkPLkLxILsPy2fmb9mNVgvZQiIaUpmVS4pi9hktqmBVhvrM6iDQbGyIykgnpWoKgy3NEMbfqS4sZCEtvtXCHdk9CmNWPrOtFqV1N48icWsdrcrYpTxQ/PVOqhGGBRrWlsrRxSz5oj6acY3KpZ1qZmNN3hmBzPoelUnXFqXAVhWRKmPlg86VMFL6EEY267H787Znqe9RDtadUlo4d7tmsUrj1v6sII1lpjZWdsnGIHjvPNCqDLTP7fh9HTZgA7I+F7L7WIhk1bZ24q8WOao2NCSyUhHf9zM/FmkwVAVTZaBtbF+rlUMSzQ5hbQuZlNb+PBNNqzJW7Uoq49uuIRGPstCMyUKGyLOU3oNnnnnHOOrHM/cs9aB2KxPGHTvYVdqFPG2u2tISh0QWoza8SgNRFiPb7POwVMX92lJXW08L7Tuu0NYS0YSBsmxGf7O6yA7EkK1MFSQt1rvd++xn7Ui22fXd/5qUzXw8u7S1rvWdS4qqNHYoDPaDCZFejnqjNhBiiZS0FpLQKAqp7ZltNkZJaSBEiqoKqZ0RNGpn1YaH8Bj1pkAJozobSi8HUQLoREPanrUnTUTNpJcmuoYcNH4SSdzvJaUxan/U5qwvC6JVRgRS+kYIwyu9vKgq6aQdSbJLPgyymPVlURwzaIkDVRqaZ8L6LY2V+Q4RbJvrVZOeLElm7S+yX4noLLvq6npUplUA9zLNj7bd++KXPstKbVkXKnI/azcLuzfAIaoSxm7sVDGSkpj5j+6RBW39jLN6q36014iqWPVnuUfbRZ7frM1Vf1tQhTCiHga6S0ntREvhVV8rfw1ZjGys568lDq1S+rZZnpH2OSOKklFHW68Sfl3X9asKYTBx2ov4hmVxaK9nNiZRjPqyLE4pJPEQraYM3RCs7UrjsmALCZ1OGJEPKFP1IHUsYZNlV/wF/EhtacbhJQ1JRaAhwwqWd+Bts0R7pxNGJVjlrneX1PppycKjODTEoRmPljQ0/Uj+aNii6XfVj6U+MpZQvIUwPC/UOpHQl2yZWNpQRCuRmTJ51p5lnJp+Rr+l9i0qAyH4E2H6PG8hDAuYuxgDqMrwxtPekMRKGisfhoJa1fWoCo9yPI58mjBygUjm+71Foq/8mKGJRlWMbJbrHapCslt9Iuuz2xmiCaMWWOpFIpWo0GTUxswmXUv9WO5HZZlhibXeLj8RTRgxsE5ozwK4l6NkwYSmD62imNks95XDA2sIvGMM/6AJ41wgEymDLCx9SSFAFJGt2kcUCEuJlMfv6+d/ed+wwxP7evvRqguELH4pf6T6Gmh3WutvL6LJK6seBa0w3gsp6WmZmBrimPWLhFCasrsPOyzJVGtlgBBGK5I5PBMOSdyx22YkPVl+SLiAtmvB40lhhVYYz0GViYwsZm8ug51DiAhDLEqnLJow8oDuiuwJlpFv8ez0WYsmKtfBAlOt0dCEcQ52J8m0ic5Vv9b8xapdz2mG9ZloTlW0dsS3jPKIJIzOc9SDdXKvCAJJjq76svrM6uwOQyy5qONQRWE8hVwqfA7WAmbskIyxRB1rehBFLiyEPasqhPEGzMikAskwEJGj8aAi0RyP0wlDu9iiF+VTFr0X0ceq97LIMKSJZoAdhFFt8e5a7Pd+m3Ri4U14Nq54wkAXAWsxWer9uf32oGpbu+ANS6yLPXuRP72/f3BiSJKdCzhNCVQf3we7v4fRAHAiYXih3bGZCw9p65SFXwlVTy0eAw9hsCd09QUyUxpVxl1lHI0Hw6swMnILFdtHMSMZa9iDklXV59I4BN+EUe2vULWLKOJo1RNCWBZ/xvPODL0aOdj2zk7NYVjIQ7NgpR0bSXwy8xZWRdEk0AhBBmGcPHmZJyRRic/I06G3hTynj/+DsM9RTWFk5URYD3SmUBgLHSnXKCSrCtPibeTySuwkDO+EYcfmkd+3WC1YiWwQMrL4Sf5/vn7QvrLyKFW+tftYZBFGlW98jhYumlxFVETUUbR1LGgCeUQc0cTdWCP1eVULSRiI/n4I4/sYrOPVVdtSfW8+RpPj8J5s3f2flvTVfq7oz6NufzdhMONpbVuWUxPPODzHq8hpCUNBaH2YYJGKth8r6bRC+sKIMKzZ8Wz2y0qMavrOCkuY+QMtsUTlmBiqB83rSO0w63mUZ1mwFEZ0GGD1Y+8i1rAEmVDaNhCVgS5ShDgYZMMAQy3uRMlxZ4Ykux6Ad/dgjJvRJjMfgSQuGeGMNfT6vmbG+REqVTu+kkSgxJ/sHAaas0Am2qrcMyG1CkCDnSoDDa9WP1Jdb/8aZIcn2di68e5OejLgDUtYYIQp1j5mZR7SiHhu6O6/IkTL8/Q+e6a62wHaGCsTRsQk07Zv3fnR3Vpzb+kbIc/Zs4nc8ZGQiI1WFED7TMLI/mBoTK3ZtVAgKsPyuTShifRZRmQwIwgPcazanN1b1cXMzlIU1vqed4nAuhG6wVYYbMkXISG1flYVgYw1UsHc/TRtWEhm1SdL6Uh1ELA2hUgFVhYrwqgQzzLa1Up37USICCUssKoWhDQk4lj9rOqN7DN/DSwKxrI5oPU9Y1jVL4NdOQxUSjF2dQu8KsPymSwEo5mQHtJY2a3QtG+5ZqgwL0FEIHsjhVA56emFREqrRcZSGbN2pX60O5T2M46uV/d3u3XSaRTH6Hrmw4K3zewNS+o/HdUIwyIxR/cRk2+HyhjV1ZKQ9lpzfy/T/khtWPv3PntUbUh1JNvjEEEY2geX8YBPUhmI1GaRhkZteDBqU0uO0mfT3I/KPES+KmOSlKYNrT8FUQojYsJp73eqDNZvbburOtrrVTsM8tD2tfIf+aLPztL2DpRWKhrCiNhxpP6i24tSGSwgu5OVKGa7/ux53X+kcm37GvJDFIQGGWRiURzlsTuHgbxcTXmmysj+bfUZXWvUhuZ5azeTFRHNxmFRU6gqmY3F0nYWSowjkjCiP6CXbFgqwwJpp9TK61Xbfy7bYrvXuftYiGFWd1Ymjc36PjTEILWHqA2p3+h5NYNlk1X5/cvQOfr/TqL/c7fWvrqXrhk29u/PNdK3ZEPvmUBJ826zLlbPQkUXt4V8vH1G+f/lZ1EYyC6jbddiZ/bDUBnaCYruSqtxS2MeXc/6GikO1jsYtTdqf/Z5ZuO3vBdpfNI4Zm0iCkU7Dq8fHbtzGB94w4tZOUpG1kUqteklkRkJzMYz8ltdj+rdbcgONquneb6rdrV1UZLW9O+pm4GQviwhyQeIXNXUGfmww5Lve3a4wg5FkLqra8szkuwINOQtXa9sWmL0KkItLApxVj67l/zDcNr/SzKzr+6tE3VVjighzy6HKA6pjZnPSnF4FYZGzVjUoEXNzeowFhlzoWrbylQpP5ClMLT1slXG97V2h/aojM+1N5HpUUn3a809EyjZW1QGGoJY1YhkX7V1JKoRxszvyaGJ10eyaXxHfhq7BRqlYFmQaKiwal97r23fqo4YfYcCIYwPrJNoN2Hc71kLboeKYJHG/fpS2KVyJN7W5Byi1IZVjbBzHJa628OWUwjDYq8Ymlh8UEUzs2nso7KZHwopRxERmjBQLdeR2fYPZBKGpZ6FNDTxt2fXjQpNUB+tv/Z6dD+zaXw0Ezgjj7EqY6mLETThiDbBG0UGcLtVCWPmV0VlSL4nkMboXuuDQrMgkDzGqi+P+tCGV56FzSYFJCRUw0MYHyATCt29UMK425ihycjGCjM8/Wrss/uZTeODTlhJVcyu0dCEpT5WbWrraYAkUOnYRRiaepawZGRHVUdUaIKWecawutbc34G8a8+pgOb6btOUMZWBJ9m5spc6HfmgMmGsfHaEJjO7xRatNGblK//R/czGgma39CiLkY2Z6xjBGjJpyq1+bPzotzphrPx2kAYjTImqZx3z6N5iswLZWdE8BiNJiSY2V/5MRJPIsH0GYXyATCoPaaCEcbd5Fp11t48Ia6zj09xLdg9QSY6eZFhzHBqSkupYbKs+rQhNeF7XfsLQ1tutMmbXiK83rGGMRXt/B/KOPTmM+720CFFVYAlBLGSzGlN2mEHp762EcbdZQ5OZHVUcLBtyPbNFqIsPGDmM2bVWUVjCCiuBMIhN21YqTiGMlV+l0MRSj00aHrtk05RJsOy0KFlo+pP8kbDF0g/aVlY7SzAJ4wNkUu0iDU84orneHXYwwhG20mAmP7+vtcoDOSXR9GO1jeyoumCTxbS9KoRhqVc1nzG7rkQayP0IlnfMzGF836Nhyqx/z6KrnLuwYjm+CML4wEocFn+LlI7IZ8yuvXkOL0GgZDi6l+weWHMY93sNKXhPSaz5Eak9K6LbgvAkwrDYGaThyR9E5CoQ0hvdz2yW8m9EnpKw1AYjqTmqs7Jrwg8N0LFAqEQYlnpewhjZkNAlkzSsY7CWoXYL0MTn/R691qoNbZiCKA4NyoYtpxLGym9Vn0ES9/so0rCUa6+15ZoyqZyxC0v3LLKQxuUlk9X4NG1pfcIRSRgfIMQRRRqIHLeGAzMfTd37NYukRmWS/wzoRpARmnxfewnEohgYiVOpD68vBVUJw1KvQj5j5YeSBlNVWIlDsrPgTX5+31vyBt7kpTXsiMhdbEEGYXxwstLIII2Z3UIglrLR/cxmKV+BlcO43zNDE/TUw6JEZkDrWduD/asThqXe20gDGYP2/o4IpcHIYdzvWXmMVVursUjj09TXgn06ovJvwljbLPdZpIH0O7vX+oyg8dNO2sjQxEIWFsXBUBQaX4vKCccbCGNVVok0NNe7QpGdCuNuiwhNVvbVuKSxreoflbv4IJMwPqiUyxiVeUkkmjS0fUhlK9vKri2/Lt9xoWaBRZOFZF/ZLIlOdu7CCnU/pxCGpd4ppIHUQQhIcz+zacqssMbebMXBJIsdKoHdp6m9HYTxQSuN3Dqj+5ltZY+ANk5nhSP3ey9ZZKkLT06IgtMIw1LvVNLQtuEhCuuz2akwRjYvcXzfZ5JFBkL7fDJhrHw9SdCRLZM0PGWSv8bOhneH9SxwZLe3JDal8t25CzOeThgr/9OUBtrm6N5is5RrwFAYd5v3FMXiJ41LU7ZCaRLJjFNneIvSuN/vUBTezxsB5jEmuwzNRSBh1cy2sqN+qP9WhfHBm5TG/T6LGFhhSLTCsJSxFjNDWbBCEQ/CyeK6ahDGB8hkZKiMVRlLadxtrIQlIxTJIIkZdh2xattmtHN83uIbpxOGpR66MHaEJ1J51KkIS7WNgMpqNBHJWuSWU48KyiEUTyAMS11EZczK2EpDukfyE5bcxK48hieH4b1n5iXQvAViR/3ceAphWOqfTBpIe9p6Gru2fIWIU5KRjak6LAlKbbmEcmRxXbUI44M3Ko2Me8tYtPU8QBccspMzVQjS3sy2skcC7vNphGGp/0TSsNgQO+LH2CnR8ETjE3E8KtXZCddYKhLGB9FJUMmXQRoju5U4WGQ0s2nKNOVWeCR9NFGgbWp9pLKS4ch1NWFI/tZFFEUaaB1LXW1ZFFi5jZGdfXxrHY+mT2sbW1TLjolhxZuUhsaPTRwrO+q3AuMLRkxbJFlUOxVxk0wThs4/U2lo/Lzte8qigSwm9PiyycKIyiHJHacpjZmdqUqyQpBIAok8LZnZWQTjHYdkL4cmDJs/srCi1YalrmTXllv8GSGIVM48grX2gfodiTcQBlI/Q2nM7JWIA/XVIDJB6Dm9YOdMNGVabA1HruuMHMYHmYQh+aM7NFttWGzesmyg8p35JSpGOOQpQ/xY9YY4SWF84JnUTNKQyjPVhrU+q5wJ5vcyLLZIX08Z4heOtxEGUn83aVjtnvCD/WxGYC6SqIQjiyxWOI4srutMwvjgFKUxK2d9v4Pl7/FjwLuAIo9jZ2XME54I0Pt5K2Eg9aPkfQYRZJ6KSMg4NZHqZRyFPo4srutswvjgdKUh1WOTQKW8xQxRi5FFCllkUSocua4mDKQ+Y8FlEQeLHHZ+cUvrhyQX2XU89bz+Kaiwm7BwktKQ/HaFHdXmg4ckVuURROGt6/Fn15+i2gTxIFtpaOpEqQ2p/ARlcUeG0pDKmywEPIkwPjiROKIWf8Y3OS31dh1BRi545rc7S5PFdTVhMOvvVBus+qg/E1mnKFJ5pJJh+LPrq/CEpOcMJyoNjR8rF5GhKGaIXhweRcFo/xEJzhGaMPj1mYs1SnGgfjvBWqTRZPBYsriuMyaKFxWVBtMvihROCEssiy1alWjb8PhHtyOiCSOufsRC3n36ETFfohdZFWXi9Y9uR4U3EMYHjM8apTZ2fQ/EWycLyKLIIgpLW6h/dDtqVJ4kbLA+a4XchtZ/l7ryoMpff0b9NemxZHFd7yKMD3YpDUu9qHxDxPvO+B4Go01mvgNpE/GPbseMJoz8diK/THVSYhPFKTkPVr2odiCcOGFYeDJxIHUqz4UIdYDUeTVZXFftSRKN3YSB1M8+3XhiDgOt93qyuK53E8YHzGeQ9RezFZOZqzZ35i4YdZss/ocmDP4zOEFxRLWTgay/uajytx1lyOK6nv3VcCuqKA20jWrj94K5UB75h2A70ITxf1RTGp52ohZ8hW96RrX7SEXARoWdpBp2f1eB3cab3vGuXEMV0gvHmyaTFtV356zE6il4akKyHFlc1zMnEBtVQxVWW6fNAcZCqkoWJUniG6dNlh2oTBhRbVaaF29Z3OXJ4rpqTYzqOGGhR7UZ2e51nSPrTxlnGJow9DhxIb7x/Z62qI8hi+t654Ty4vQF/sR3fupiPoosruuZkyca0c8s852c+P6zFlmTxQAnTphqeBKBVOj3G9mL6ilkFIZ/7x5AoyxGk/qkb3pa0eBGLpwAAADbSURBVGShQIVd5CnoUOI8NEkY8Xv3ABoQHjMBN6LJAkDvVHHY8Wz7fY6xa9E+iiyuqxXG0/C4CUpAkwURvSPlocKzrjCGCFRZnFXGEYZWGO/CEyd0lc9UZRyheOqOcwJOePa7xnjK4jtlnDS0wmissGNBnLIITxknFSfscm9Bv4v6eCVJfKMVRqOhw+vJ4rp6VzsB/Y72oUnihlYYjcYYTRYD9O51Lvrd8dDkoEQrjMbb0WRhQO9Sz0O/059oUiChFUbj6WiyIKJ3o8aJc6BJYBNaYTROQ5PFRvwHgAI5F5sYvEcAAAAASUVORK5CYII="/>\n    </defs>\n</svg>\n'},541:function(t,e){t.exports='<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" id="swipe_svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t width="100%" height="100%" viewBox="0 0 300 116"  preserveAspectRatio="none" xml:space="preserve">\n  <g opacity="1">\n    <g id="vq_arrow" opacity="0.8">\n      <line fill="none" id="vq_arrow_line" stroke="#FFFFFF" stroke-width="2" x1="80" y1="9" x2="220" y2="9"/>\n      <polyline id="vq_arrow_left" fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" points="85,15 79,9 85,3"/>\n      <polyline id="vq_arrow_right" fill="none" stroke="#FFFFFF" stroke-width="2" troke-miterlimit="10" points="215,15 221,9 215,3"/>\n    </g>\n  </g>\n</svg>\n\n'},542:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(5),s=r(8),l=r(4),c=r(2),u=r(10),d=r(12),h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(d.a)(a,[{getValues:function(t){var e=t.player;return{currentTime:e.currentTime,data:t.vqSubtitles.data,isSubtitlesEnabled:e.isSubtitlesEnabled}},onChange:a.updateText.bind(a)},{getValues:function(t){var e=t.vqSubtitles.settings,r=t.player;return{settings:e,width:r.width,height:r.height}},onChange:a.updateStyles.bind(a)},{getValues:function(t){return{url:t.vqSubtitles.url}},onChange:a.loadFile.bind(a)}],a.store);a.loadFile();return a}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");Object(c.d)(this.container,{position:"absolute",left:"50%",transform:"translateX(-50%)",WebkitTransform:"translateX(-50%)",padding:"5px 0",width:o.f?"65%":"80%",borderRadius:"3px",color:"white",background:"rgba(0, 0, 0, 0.3)",fontSize:"10pt",lineHeight:1.3,textAlign:"center",whiteSpace:"pre-wrap",pointerEvents:"none",zIndex:u.a.subtitles,display:"none"});this.parent.appendChild(this.container);this.updateStyles()};e.prototype.loadFile=function(){var t=this,e=this.store.getState(),r=e.vqSubtitles.url;r&&Object(l.y)(r,function(e){t.store.dispatch({type:"LOAD_SUBTITLES",payload:e.responseText})},!1,!1,"GET",!1,!1)};e.prototype.updateText=function(){var t=this.store.getState(),e=t.vqSubtitles.data,r=t.vqEffects.startCut,i=t.player,n=i.currentTime;if(i.isSubtitlesEnabled){var a=0;r&&(a=r/1e3);var o=n+a,s=e.find(function(t){var e=t.startTime,r=t.endTime;return e<=o&&o<r});if(s){this.show();this.container.innerHTML=s.text}else{this.hide();this.container.innerHTML=""}}else{this.hide();this.container.innerHTML=""}};e.prototype.updateStyles=function(){var t=this.store.getState(),e=t.vqSubtitles.settings,r=t.player,i=r.width,n=r.height,a=n/i<=1?"15%":"25%";Object(c.d)(this.container,h({},e,{bottom:a}))};return e}(s.a)},543:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(7),s=r(8),l=r(2),c=r(77),u=r(10),d=o.a.staticUrl+"/"+r(331);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){var t=this.store.getState(),e=t.player.previewImage;this.container=document.createElement("div");Object(l.d)(this.container,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:u.a.emptySlot,color:"#fff",display:"none"});this.background=Object(l.c)(this.container,"div",{width:"100%",height:"100%",position:"absolute",background:"url('"+(e||d)+"') no-repeat",backgroundSize:e?"contain":"cover",cursor:"default",backgroundPositionX:"center"});this.parent.appendChild(this.container)};e.prototype.update=function(){var t=this.store.getState(),e=t.player,r=e.mediaFiles,i=e.role;r.length||i!==c.a.EDITOR?this.hide():this.show()};return e}(s.a)},544:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(12),c=r(332),u=r.n(c),d=r(545),h=r(10);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(l.a)(a,[{getValues:function(t){return{tasks:t.tasks,hasOverlayMode:t.options.hasOverlayMode}},onChange:a._updateTask.bind(a)},{getValues:function(t){return{unpublishedLabelVisible:t.application.unpublishedLabelVisible}},onChange:a._setTopOffset.bind(a)}],a.store);return a}a(e,t);e.prototype.render=function(){var t=this;this.editInfoWrapper=document.createElement("div");Object(s.d)(this.editInfoWrapper,{position:"absolute",display:"none",zIndex:h.a.task,left:"50%",top:"50%",webkitTransform:"translate(-50%, -50%)",transform:"translate(-50%, -50%)",color:"#fff",background:"rgba(68, 68, 76, 0.8)",borderRadius:"3px",cursor:"default",width:"100%",maxWidth:"400px",padding:"20px 0",textAlign:"center",height:"250px",maxHeight:"100%",overflow:"auto",flexDirection:"column",alignItems:"center",justifyContent:"center"});Object(s.c)(this.editInfoWrapper,"div",{display:"inline-block",verticalAlign:"top",fontSize:"26px",border:"2px solid",borderRadius:"50%",width:"30px",height:"30px",textAlign:"center",fontWeight:"400",marginBottom:"20px"},"!");this.editBlockInfoText=Object(s.c)(this.editInfoWrapper,"div",{margin:"0 auto",maxWidth:"300px",fontSize:"16px",fontWeight:"100"});Object(s.b)(this.editInfoWrapper,"viqeo-rotation",[{percent:"0%",css:{webkitTransform:"rotate(0deg)",transform:"rotate(0deg)"}},{percent:"100%",css:{webkitTransform:"rotate(360deg)",transform:"rotate(360deg)"}}]);this.progressWrapper=Object(s.c)(this.editInfoWrapper,"div",{position:"relative",width:"60px",height:"60px",lineHeight:"60px",margin:"30px auto 0 auto"});this.progressWrapperText=Object(s.c)(this.progressWrapper,"div");Object(s.c)(this.progressWrapper,"div",{animation:"viqeo-rotation 1s linear infinite",width:"60px",height:"100%",position:"absolute",top:0,left:0,right:0,margin:"auto"},u.a);this.editorInfoTitle=Object(s.c)(this.editInfoWrapper,"div",{marginTop:"5px",fontSize:"16px",fontWeight:"100"});this.tasksWrapper=document.createElement("div");Object(s.d)(this.tasksWrapper,{position:"absolute",display:"none",zIndex:h.a.task,left:"10px",color:"#000",background:"rgba(255, 255, 255, 0.8)",borderRadius:"3px",cursor:"default"});this._setTopOffset();this.tasksWrapper.addEventListener("click",function(t){t.stopPropagation()});this.wrapper=Object(s.c)(this.tasksWrapper,"div",{width:"100%",zIndex:50,display:"inline-block",verticalAlign:"top",padding:"5px 7px"});Object(s.c)(this.wrapper,"div",{display:"inline-block",verticalAlign:"top",fontSize:"17px",border:"2px solid",borderRadius:"50%",width:"20px",height:"20px",textAlign:"center",fontWeight:"bold",marginRight:"5px"},"!");this.tasksTitle=Object(s.c)(this.wrapper,"div",{display:"inline-block",verticalAlign:"top",marginTop:"5px",fontSize:"13px",cursor:"pointer"},"!");this.tasksTitle.addEventListener("click",function(e){e.stopPropagation();var r=t.store.getState(),i=r.tasks,n="none"!==t.tasksContainer.style.display;Object(s.d)(t.tasksContainer,{display:i.length<=1||n?"none":"block"})});this.tasksContainer=Object(s.c)(this.wrapper,"div",{display:"none",fontSize:"13px",paddingLeft:"28px"});this.parent.appendChild(this.tasksWrapper);this.parent.appendChild(this.editInfoWrapper)};e.prototype._updateTask=function(){var t=this.store.getState(),e=t.tasks,r=t.options.hasOverlayMode;Object(s.d)(this.tasksWrapper,{display:"none"});Object(s.d)(this.editInfoWrapper,{display:"none"});var i=e.filter(function(t){return"extract_subtitles"===t.tag}).pop();!r||1===e.length&&i?this._renderTasks():this._renderEditInfo()};e.prototype._renderTasks=function(){var t=this,e=this.store.getState(),r=e.application.language,i=e.tasks;this.tasksContainer.innerHTML="";this.tasksTitle.innerHTML="";var n=i.sort(function(t,e){return t.tag<e.tag?-1:t.tag>e.tag?1:0});n.length&&Object(s.d)(this.tasksWrapper,{display:"block"});if(1===n.length){this.tasksContainer.style.display="none";this.tasksTitle.style.borderBottom="none";var a=Object(s.c)(this.tasksTitle,"div",{}),o=n[0].tag,l=n[0].progress,c=o+"_title";Object(s.c)(a,"span",{},d.a[r][c]+":");Object(s.c)(a,"span",{}," "+(l||0)+"%")}else{this.tasksTitle.style.borderBottom="1px solid";var u=Object(s.c)(this.tasksTitle,"div",{});Object(s.c)(u,"span",{},d.a[r].video_processing)}n.forEach(function(e){var i=e.tag,n=e.progress,a=Object(s.c)(t.tasksContainer,"div",{margin:"7px"});Object(s.c)(a,"span",{},d.a[r][i]+":");Object(s.c)(a,"span",{}," "+(n||0)+"%")});n.length?this.show():this.hide()};e.prototype._renderEditInfo=function(){var t=this.store.getState(),e=t.application.language,r=t.tasks,i=r.filter(function(t){return["convert_video","applying_filters"].includes(t.tag)}).pop();if(i){Object(s.d)(this.editInfoWrapper,{display:"flex"});this.progressWrapperText.innerText=(i.progress||0)+"%";this.editBlockInfoText.innerText=d.a[e].convert_edit_wait;this.editorInfoTitle.innerText=d.a[e].convert_edit_process}};e.prototype._setTopOffset=function(){var t=this.store.getState(),e=t.application.unpublishedLabelVisible,r=t.vqControls.copyright,i=r.link,n=r.url,a=r.text,o=r.type,l="10px";(e||o&&"hide"!==o&&a&&"url"===i&&n)&&(l="45px");Object(s.d)(this.tasksWrapper,{top:l})};return e}(o.a)},545:function(t,e,r){"use strict";var i=r(546);e.a={en:r(547).a,ru:i.a}},546:function(t,e,r){"use strict";e.a={textUploadedVideo:"Загрузите видео",convert_video:"Конвертация",convert_video_another_formats:"Подготовка видео",convert_video_extract_hd:"Подготовка видео",applying_filters:"Публикация",extract_subtitles:"Создание субтитров",video_processing:"Видео обрабатывается",applying_filters_title:"Видео публикуется",extract_subtitles_title:"Субтитры создаются",convert_video_title:"Видео конвертируется",convert_video_another_formats_title:"Видео конвертируется",convert_video_extract_hd_title:"Видео конвертируется",convert_edit_wait:"Для редактирования дождитесь окончания обработки видео",convert_edit_process:"Обработка видео"}},547:function(t,e,r){"use strict";e.a={textUploadedVideo:"Upload video",convert_video:"Transcoding",convert_video_another_formats:"Format transcoding",convert_video_extract_hd:"Format transcoding",applying_filters:"Publishing",extract_subtitles:"Subtitles creation",video_processing:"Preparation in process",applying_filters_title:"Publishing video",extract_subtitles_title:"Creating subtitles",convert_video_title:"Transcoding video",convert_video_another_formats_title:"Transcoding video",convert_video_extract_hd_title:"Transcoding video",convert_edit_wait:"Wait until video processing is finished",convert_edit_process:"Preparation in process"}},548:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(13),c=r(22),u=r(334),d=r(25),h=r(12),f=r(10),p="AdvertContainer";e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.options=r;a._vpaid=null;Object(h.a)(a,[{getValues:function(t){return{dataUrl:t.advert.dataUrl}},onChange:a._createVpaid.bind(a)},{getValues:function(t){var e=t.player;return{width:e.width,height:e.height}},onChange:a._updateSize.bind(a)},{getValues:function(t){return{needStart:t.advert.needStart}},onChange:a._needStart.bind(a)}],a.store);return a}a(e,t);e.prototype._createVpaid=function(){var t=this.store.getState(),e=t.player,r=e.width,i=e.height,n=t.advert,a=n.dataUrl,o=n.format;try{this._vpaid=window.createVPAIDAd()}catch(t){this.store.dispatch(Object(l.d)(p+"._createVpaid(): error window.createVPAIDAd()"))}this._saveCall("subscribe",[this._adLoaded.bind(this),"AdLoaded"]);this._saveCall("subscribe",[this._adStarted.bind(this),"AdVideoStart"]);this._saveCall("subscribe",[this._adStopped.bind(this),"AdStopped"]);this._saveCall("subscribe",[this._videoComplete.bind(this),"AdVideoComplete"]);this._saveCall("subscribe",[this._adError.bind(this),"AdError"]);this._saveCall("subscribe",[this._adSkipped.bind(this),"AdSkipped"]);this._saveCall("subscribe",[this._adLog.bind(this),"AdLog"]);this._saveCall("initAd",[r,i,"normal",0,{dataUrl:a},{vqPlayer:this.options.player,slot:this.wrapper,format:o}])};e.prototype._adLog=function(t){this.store.dispatch(Object(l.a)(t))};e.prototype._needStart=function(){this._saveCall("startAd")};e.prototype.render=function(){Object(s.d)(this.container,{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"none",zIndex:f.a.advert});this.wrapper=Object(s.c)(this.container,"div",{position:"absolute",top:0,left:0,width:"100%",height:"100%"});this.parent.appendChild(this.container)};e.prototype._updateSize=function(){var t=this.store.getState(),e=t.player,r=e.width,i=e.height;Object(s.d)(this.container,{width:r+"px",height:i+"px"});this._saveCall("resizeAd",[r,i])};e.prototype._adLoaded=function(){this._updateSize();this.store.dispatch(Object(l.h)("Tracker:advLoaded"))};e.prototype._adVolumeChange=function(){var t=this;this._saveCall("getAdVolume",[],function(e){e>0&&t.store.dispatch(Object(c.z)(e))})};e.prototype._destroyed=function(){this._endAdvert()};e.prototype._endAdvert=function(){this.hide();this.store.dispatch(Object(u.a)())};e.prototype._videoComplete=function(){this._endAdvert();this.store.dispatch(Object(l.h)("Tracker:advEnded"))};e.prototype._adError=function(){this._endAdvert()};e.prototype._adSkipped=function(){this._endAdvert();this.store.dispatch(Object(l.h)("Tracker:advEnded"))};e.prototype._adStarted=function(){var t=this.store.getState(),e=t.player,r=e.status,i=e.volume;this._saveCall("setAdVolume",[i]);i||this._saveCall("subscribe",[this._adVolumeChange.bind(this),"AdVolumeChange"]);r===d.a.ENDED&&this._saveCall("stopAd");Object(s.d)(this.container,{display:"block"});this.store.dispatch(Object(u.b)());this.store.dispatch(Object(l.h)("Tracker:advStarted"));this._updateSize()};e.prototype._adStopped=function(){this._endAdvert()};e.prototype._saveCall=function(t,e,r){try{this.store.dispatch(Object(l.d)(p+"._saveCall("+t+", "+e+")"))}catch(r){this.store.dispatch(Object(l.d)(p+"._saveCall("+t+", "+e+") error logs"))}var i=this._vpaid;if(i)try{i[t]?r?r(i[t].apply(i,e)):i[t].apply(i,e):this.store.dispatch(Object(l.d)("Not found method VPAID."+t+"("+e+")"))}catch(r){this.store.dispatch(Object(l.d)("Error called VPAID."+t+"("+e+") - "+r))}else this.store.dispatch(Object(l.d)(p+"._saveCall("+t+", "+e+"): not created vpaid"))};return e}(o.a)},549:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(4),c=r(148),u=r(335),d=r(12),h=r(10);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(d.a)(a,[{getValues:function(t){return{hasVisible:t.timeline.hasVisible}},onChange:a._updateVisible.bind(a)},{getValues:function(t){return{currentTimePosition:t.timeline.currentTimePosition}},onChange:a._updateTime.bind(a)},{getValues:function(t){return{hasLoadedImage:t.timeline.hasLoadedImage}},onChange:a._spriteLoaded.bind(a)},{getValues:function(t){return{src:t.timeline.src}},onChange:a._updateImage.bind(a)}],a.store);return a}a(e,t);e.prototype.render=function(){Object(s.d)(this.container,{position:"absolute",bottom:c.a+"px",left:0,display:"none",zIndex:h.a.timelineSprite,webkitBoxSizing:"border-box",boxSizing:"border-box"});this._sprite=Object(s.c)(this.container,"div");this._time=Object(s.c)(this.container,"div",{position:"absolute",bottom:0,left:0,width:"100%",height:"30px",lineHeight:"30px",color:"#fff",fontSize:"10px",textAlign:"center"});this._value=Object(s.c)(this._time,"span",{background:"rgba(0, 0, 0, 0.3)",padding:"2px"});this.parent.appendChild(this.container)};e.prototype._spriteLoaded=function(){var t=this.store.getState(),e=t.timeline,r=e.src,i=e.tileWidth,n=e.tileHeight,a="0px 0px 10px 2px rgba(0,0,0,0.75)";Object(s.d)(this.container,{border:"1px solid #000",webkitBoxShadow:a,mozBoxShadow:a,boxShadow:a});Object(s.d)(this._sprite,{width:i+"px",height:n+"px",background:"url("+r+") no-repeat"});this._updateTime()};e.prototype._updateVisible=function(){var t=this.store.getState(),e=t.timeline,r=e.hasVisible,i=e.hasRequestedImage,n=e.src;r?this.show():this.hide();!i&&n&&this.store.dispatch(Object(u.d)(n));this._updateTime()};e.prototype._updateTime=function(){var t=this.store.getState(),e=t.player,r=e.duration,i=e.width,n=t.timeline,a=n.tileWidth,o=n.tileHeight,u=n.widthCountTiles,d=n.heightCountTiles,h=n.maxCountTiles,f=n.currentTimePosition;if(n.hasVisible){var p=f/r*h,g=Math.floor(p/u),y=Math.round(p-g*u),v=g;y>=u&&(y=u-1);v>=d&&(v=d-1);Object(s.d)(this._sprite,{backgroundPosition:"-"+a*y+"px -"+o*v+"px"});this._value.innerHTML=Object(l.e)(Math.round(f));var m=this.container.offsetWidth||this._value.offsetWidth,b=f/r*i-(m/2-c.b/2);b<0?b=0:b>i-m&&(b=i-m);Object(s.d)(this.container,{left:b+"px"})}};e.prototype._updateImage=function(){if(!this.store.getState().timeline.src){Object(s.d)(this._sprite,{width:"",height:"",background:"none"});Object(s.d)(this.container,{border:"none"})}};return e}(o.a)},550:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(5),s=r(2),l=r(50),c=r(87),u=r(551),d=r.n(u),h=r(552),f=r.n(h),p=r(22),g=r(95),y=r(10),v=r(12),m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(v.a)({},[{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:a._changeFullScreen.bind(a)}],a.store);Object(c.d)(a.options.iframe,function(){a.store.dispatch(Object(c.b)()&&Object(c.b)()===a.options.player.getContainer()?{type:"START_FULL_SCREEN"}:{type:"END_FULL_SCREEN"})});return a}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");this.content=Object(s.s)(this.container);Object(s.d)(this.container,{position:"absolute",zIndex:y.a.fullScreen,bottom:"10px",right:"50px",width:o.f?"8%":"30px",maxWidth:"50px",cursor:"pointer",display:"none"});Object(l.a)(this.content);var e={position:"absolute",width:"80%",height:"80%",left:"10%",top:"10%",zIndex:100};this.inFullScreen=document.createElement("div");this.inFullScreen.innerHTML=d.a;Object(s.d)(this.inFullScreen,m({},e,{display:"block"}));this.content.appendChild(this.inFullScreen);this.outFullScreen=document.createElement("div");this.outFullScreen.innerHTML=f.a;Object(s.d)(this.outFullScreen,m({},e,{display:"none"}));this.content.appendChild(this.outFullScreen);this.parent.appendChild(this.container);this.addClickEvent(this.container,this._handleClick.bind(this));t.prototype.render.call(this)};e.prototype._handleClick=function(t){this.store.dispatch(this.store.getState().player.hasFullScreen?Object(p.u)():Object(p.v)());Object(s.e)(t)};e.prototype._changeFullScreen=function(){var t=this.store.getState(),e=t.player.hasFullScreen;[this.inFullScreen,this.outFullScreen].forEach(function(t){return Object(s.d)(t,{display:"none"})});e?Object(s.d)(this.outFullScreen,{display:"block"}):Object(s.d)(this.inFullScreen,{display:"block"})};e.prototype.update=function(){var e=this.store.getState(),r=e.player.hasFullScreen,i=this.store.getState(),n=i.options.videoGalleryMode,a=i.vqControls,l=i.vqPlayback,c=l.videoclick,u=l.videoclick_allow_fullscreen,d=a.fullscreen,h=a.volume,f=c.type,p=u.type,g=d.value,y=!1;y="viqeo"===f?"true"===g:"true"===g&&("pause"===f&&"true"===p&&n||"pause"===f&&"false"===p||"videomode"===f&&n);o.f&&!r&&(y=!1);var v=y?"block":"none",m=h.hidden?"10px":"50px";Object(s.d)(this.container,{display:v,right:m,paddingTop:o.f?"50px":0,paddingLeft:o.f?"50px":0});t.prototype.update.call(this)};return e}(g.a)},551:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">\n<path d="M0 0h24v24H0z" fill="none"/>\n  <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z" fill="white"/>\n</svg>\n'},552:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">\n<path d="M0 0h24v24H0z" fill="none"/>\n  <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z" fill="white"/>\n</svg>\n'},553:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(50),l=r(5),c=r(554),u=r.n(c),d=r(555),h=r.n(d),f=r(336),p=r.n(f),g=r(337),y=r.n(g),v=r(95),m=r(10),b=r(12),E=r(22),_=r(13);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.options=r;Object(b.a)({},[{getValues:function(t){return{isSettingsPanelSeen:t.player.isSettingsPanelSeen}},onChange:a._rotateIcon.bind(a)},{getValues:function(t){return{visiblePercent:t.player.visiblePercent}},onChange:a._onVisibilityChanged.bind(a)},{getValues:function(t){var e=t.vqControls,r=t.player;return{isSubtitlesEnabled:r.isSubtitlesEnabled,vqControls:e,qualities:r.qualities,hasFullScreen:r.hasFullScreen}},onChange:a._updateControls.bind(a)}],a.store);a._updateControls();return a}a(e,t);e.prototype.render=function(){var e=this;this.container=document.createElement("div");this.content=Object(o.s)(this.container);Object(o.d)(this.container,{position:"absolute",zIndex:m.a.settings,bottom:"10px",right:this._getRightOffset(),left:l.f?"10px":"auto",width:this._getContainerWidth(),maxWidth:"50px",cursor:"pointer",opacity:1,touchAction:"manipulation",userSelect:"none !important","-webkit-touch-callout":"none",paddingRight:l.f?"50px":0,paddingTop:l.f?"50px":0});this.content.addEventListener("mouseleave",function(t){if(e.isSettingsPanelSeen){t.stopImmediatePropagation();Object(o.e)(t)}});Object(s.a)(this.content);this.iconWrapper=document.createElement("div");Object(o.d)(this.iconWrapper,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:m.a.settings});this.content.appendChild(this.iconWrapper);this.parent.appendChild(this.container);this.addClickEvent(this.container,this._handleClick.bind(this));t.prototype.render.call(this);this._renderIcon()};e.prototype._renderIcon=function(){var t=u.a,e="#ffffff";if(l.f){var r=[this.hasFullScreenControl,this.hasSubtitles,this.hasQuality],i=r.filter(function(t){return Boolean(t)}).length;if(1===i){this.hasFullScreenControl&&(t=y.a);if(this.hasSubtitles){var n=this.store.getState(),a=n.player.isSubtitlesEnabled;t=p.a;e=a?"#7fcc4e":"#ffffff"}this.hasQuality&&(t=h.a)}else 0===i&&this.hide()}else this.hasQuality&&!this.hasSubtitles?t=h.a:this.hasSubtitles&&!this.hasQuality&&(t=p.a);this.iconWrapper.innerHTML=t;this.icon=this.iconWrapper.firstElementChild;Object(o.d)(this.icon,{width:"100%",height:"100%",zIndex:m.a.settings,display:"block",transition:"transform 0.1s linear",boxSizing:"border-box",padding:l.f?"15%":"5px",fill:e});this._rotateIcon()};e.prototype.updateHover=function(){var t=this.store.getState(),e=t.player.hasHover,r=t.application.overlay,i=t.options.hasOverlayMode,n=t.player.isSettingsPanelSeen;this.applyStyle((e||l.f)&&!r||i||n)};e.prototype._handleClick=function(t){Object(o.e)(t);if(1===[this.hasFullScreenControl,this.hasSubtitles,this.hasQuality].filter(function(t){return Boolean(t)}).length){this.hasQuality&&(l.f?this.store.dispatch(Object(E.A)()):this._toggleSettingsVisibility());if(this.hasSubtitles)if(l.f){var e=this.store.getState(),r=e.player.isSubtitlesEnabled;this.store.dispatch(r?{type:"SUBTITLES_DISABLE"}:{type:"SUBTITLES_ENABLE"})}else this._toggleSettingsVisibility();this.hasFullScreenControl&&this.store.dispatch(Object(E.v)())}else this._toggleSettingsVisibility();this.store.dispatch(Object(_.h)("Tracker:settingsPanelOpened"))};e.prototype._toggleSettingsVisibility=function(){this.store.dispatch(this.store.getState().player.isSettingsPanelSeen?Object(E.l)():Object(E.B)())};e.prototype._rotateIcon=function(){if(!l.f){var t=this.store.getState(),e=t.player.isSettingsPanelSeen;this.isSettingsPanelSeen=e;if(this.hasQuality&&this.hasSubtitles){var r=e?"rotate(30deg)":"rotate(0deg)";Object(o.d)(this.icon,{transform:r})}this.updateHover();var i=e?"mouseenter":"mouseleave",n=document.createEvent("MouseEvents");n.initMouseEvent(""+i,!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,this.content,null);this.content.dispatchEvent(n)}};e.prototype._getRightOffset=function(){var t=this.store.getState(),e=t.vqControls,r=e.fullscreen,i=e.volume,n="10px";if(l.f)n="auto";else{"true"!==r.value&&i.hidden||(n="50px");"true"!==r.value||i.hidden||(n="90px")}return n};e.prototype._getContainerWidth=function(){var t=this.store.getState(),e=t.player.hasFullScreen;return l.f&&!e?"8%":"30px"};e.prototype._onVisibilityChanged=function(){var t=this.store.getState(),e=t.player,r=e.visiblePercent;if(e.isSettingsPanelSeen&&r<=0){this.store.dispatch(Object(E.l)());this.updateHover()}};e.prototype._updateControls=function(){if(this.iconWrapper){var t=this.store.getState(),e=t.player,r=e.qualities,i=e.hasFullScreen,n=t.vqSubtitles,a=t.vqControls,o=a.quality.value,s=a.subtitles.value,c=a.fullscreen.value,u=n.data;this.hasQuality="true"===o&&r&&r.length>1;this.hasSubtitles="true"===s&&u.length;this.hasFullScreenControl=!("true"!==c||l.f&&i);this._renderIcon()}};e.prototype.update=function(){t.prototype.update.call(this);var e=this._getRightOffset();Object(o.d)(this.container,{right:e,width:this._getContainerWidth()});var r=this.store.getState(),i=r.player,n=i.isSettingsPanelSeen,a=i.hasFullScreen,s=i.qualities,c=r.vqSubtitles,u=r.vqControls,d=c.data,h=u.quality.value,f=u.subtitles.value,p=u.fullscreen.value,g="true"===h&&s&&s.length>1,y="true"===f&&d&&d.length,v="true"===p;if(l.f){n?this.hide():this.show();a?y||g?this.show():this.hide():g||y||v||this.hide()}else y||g?this.show():this.hide()};return e}(v.a)},554:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <path fill="none" d="M0 0h20v20H0V0z"/>\n  <path d="M15.95 10.78c.03-.25.05-.51.05-.78s-.02-.53-.06-.78l1.69-1.32c.15-.12.19-.34.1-.51l-1.6-2.77c-.1-.18-.31-.24-.49-.18l-1.99.8c-.42-.32-.86-.58-1.35-.78L12 2.34c-.03-.2-.2-.34-.4-.34H8.4c-.2 0-.36.14-.39.34l-.3 2.12c-.49.2-.94.47-1.35.78l-1.99-.8c-.18-.07-.39 0-.49.18l-1.6 2.77c-.1.18-.06.39.1.51l1.69 1.32c-.04.25-.07.52-.07.78s.02.53.06.78L2.37 12.1c-.15.12-.19.34-.1.51l1.6 2.77c.1.18.31.24.49.18l1.99-.8c.42.32.86.58 1.35.78l.3 2.12c.04.2.2.34.4.34h3.2c.2 0 .37-.14.39-.34l.3-2.12c.49-.2.94-.47 1.35-.78l1.99.8c.18.07.39 0 .49-.18l1.6-2.77c.1-.18.06-.39-.1-.51l-1.67-1.32zM10 13c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3z"/>\n</svg>\n'},555:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 11H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm7-1c0 .55-.45 1-1 1h-.75v1.5h-1.5V15H14c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v4zm-3.5-.5h2v-3h-2v3z"/>\n</svg>\n'},556:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(8),l=r(557),c=r.n(l),u=r(10),d=r(12),h=r(558),f=r(149),p=r(13),g=function t(e,r){return!(!e.getAttribute||!e.getAttribute(r))||e.parentNode&&t(e.parentNode,r)};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(d.a)({},[{getValues:function(t){return{data:t.vqSubtitles.data}},onChange:a._renderSettingsOptions.bind(a)},{getValues:function(t){return{selectedQuality:t.player.selectedQuality}},onChange:a._updateSelectedQuality.bind(a)},{getValues:function(t){return{vqControls:t.vqControls,qualities:t.player.qualities}},onChange:function(){a._renderSettingsOptions();a._updateQualities()}},{getValues:function(t){return{language:t.application.language}},onChange:a.updateLanguage.bind(a)}],a.store);a.iframe=r.iframe;a.isQualitySelectOpened=!1;a.qualities=[];return a}a(e,t);e.prototype.render=function(){var e=this,r=document.createElement("link");r.setAttribute("rel","stylesheet");r.setAttribute("type","text/css");r.setAttribute("href","https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i&subset=cyrillic,cyrillic-ext");this.iframe.contentDocument.head.appendChild(r);Object(o.a)(this.iframe.contentDocument.head,{".settingsHover:hover":{background:"rgba(255, 255, 255, 0.3);"}});this.container=document.createElement("div");Object(o.d)(this.container,{maxWidth:"100%",maxHeight:"calc(100% - 45px)",margin:"auto",display:"none",position:"absolute",bottom:"45px",boxSizing:"border-box",right:"0px",zIndex:u.a.settings,background:"rgba(0, 0, 0, 0.6)",cursor:"default",fontWeight:"300",fontSize:"10pt",fontFamily:"Roboto, sans-serif",transition:"all 0.2s linear"});this._resizeContainer();this.menuContainer=document.createElement("div");this.container.appendChild(this.menuContainer);this.menuContainer.addEventListener("click",function(t){if(g(t.target,"quality-select")){e.store.getState().player.qualities.length>1&&e._toggleQualitySelect(!0)}});this.selectQualityContainer=document.createElement("div");Object(o.d)(this.selectQualityContainer,{display:"none"});this.selectQualityContainer.addEventListener("click",function(t){if(g(t.target,"data-quality")){e.store.getState().player.qualities.length>1&&e._selectQuality(t.target.getAttribute("data-quality"))}g(t.target,"menu-back")&&e._toggleQualitySelect(!1)});this.container.appendChild(this.selectQualityContainer);this._renderQualities();this._renderSettingsOptions();this._updateSelectedQuality();this.parent.appendChild(this.container);this.addClickEvent(this.container,function(t){Object(o.e)(t)});t.prototype.render.call(this)};e.prototype._selectQuality=function(t){if(t){this._toggleQualitySelect(!1);var e=JSON.parse(t);Object(o.q)("viqeo-quality",e?e.height:"auto");var r=e?e.height:null;this.store.dispatch({type:"SELECT_QUALITY",payload:r});this.store.dispatch(Object(p.h)("Tracker:qualitySelected",{trackingParams:{quality:r}}))}};e.prototype._renderSettingsOptions=function(){var t=this;this.menuContainer.innerHTML="";var e=this.store.getState(),r=e.player,i=r.qualities,n=r.isSubtitlesEnabled,a=e.vqSubtitles,s=e.vqControls,l=a.data,u=s.quality.value,d=s.subtitles.value;this.hasQuality="true"===u&&i&&i.length>1;this.hasSubtitles="true"===d&&l.length;var p=[];this.hasQuality&&p.push({content:function(){var e=document.createElement("div");Object(o.d)(e,{width:"100%"});var r=Object(o.c)(e,"div",{marginBottom:"3px"});Object(o.c)(r,"span",{verticalAlign:"middle"}).textContent=f.a[t.language].quality;var i=document.createElement("div");i.innerHTML=c.a;var n=i.firstElementChild;Object(o.d)(i,{width:"16px",height:"15px",display:"inline-block",transform:"rotate(90deg)",verticalAlign:"middle",position:"relative"});Object(o.d)(n,{width:"100%",height:"100%",fill:"#fff",position:"absolute",top:"0",left:"0"});r.appendChild(i);t.selectedValue=document.createElement("div");t.selectedValue.setAttribute("quality-select",!0);e.appendChild(t.selectedValue);return e},dataAttr:"quality-select"});this.hasSubtitles&&p.push({content:function(){var e=document.createElement("div");Object(o.d)(e,{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"});Object(o.c)(e,"div").textContent=f.a[t.language].subtitles;var r=document.createElement("div");r.appendChild(new h.a({iframe:t.iframe,stylesContainer:t.iframe.contentDocument.head,color:"#7fcc4e",checked:n,callback:function(e){t.store.dispatch(e?{type:"SUBTITLES_ENABLE"}:{type:"SUBTITLES_DISABLE"})}}));e.appendChild(r);return e}});p.forEach(function(e,r){t._getSettingsItem(e,p.length!==r+1)});this._updateSelectedQuality()};e.prototype._renderQualities=function(){var t=this,e=this.store.getState(),r=e.player,i=r.qualities,n=r.selectedQuality;this.selectQualityContainer.innerHTML="";var a=Object(o.c)(this.selectQualityContainer,"div",{color:"#fff",borderBottom:"1px solid",padding:"5px 0",textIndent:"10px",cursor:"pointer"});a.classList.add("settingsHover");a.setAttribute("menu-back",!0);var s=document.createElement("div");s.innerHTML=c.a;var l=s.firstElementChild;Object(o.d)(s,{width:"16px",height:"15px",display:"inline-block",transform:"rotate(-90deg)",verticalAlign:"middle",position:"relative",marginLeft:"-5px"});Object(o.d)(l,{width:"100%",height:"100%",fill:"#fff",position:"absolute",top:"0",left:"0"});a.appendChild(s);var u=document.createElement("span");Object(o.d)(u,{verticalAlign:"middle"});u.textContent=f.a[this.language].qualityBack;a.appendChild(u);i.slice().sort(function(t,e){return t.height>e.height?-1:1}).forEach(function(e){var r=t._getQualityItem(e);r.setAttribute("data-quality",JSON.stringify(e));n&&e.height===n&&Object(o.d)(r,{color:"#7fcc4e"});t.selectQualityContainer.appendChild(r)});var d=this._getQualityItem(null);d.setAttribute("data-quality",JSON.stringify(null));null===n&&Object(o.d)(d,{color:"#7fcc4e"});this.selectQualityContainer.appendChild(d)};e.prototype._updateQualities=function(){this._renderQualities();this._updateSelectedQuality()};e.prototype._updateSelectedQuality=function(){var t=this.store.getState(),e=t.player.selectedQuality,r="";if(this.selectedValue){r=e?e+"p":f.a[this.language].autoQuality;this.selectedValue.innerHTML="";var i=document.createElement("span");i.textContent=r;Object(o.d)(i,{color:"#7fcc4e"});this.selectedValue.appendChild(i)}this._renderQualities()};e.prototype._toggleQualitySelect=function(t){var e=void 0===t?!this.isQualitySelectOpened:Boolean(t);if(e){Object(o.d)(this.menuContainer,{display:"none"});Object(o.d)(this.selectQualityContainer,{display:"block"})}else{Object(o.d)(this.menuContainer,{display:"block"});Object(o.d)(this.selectQualityContainer,{display:"none"})}this.isQualitySelectOpened=e;this._resizeContainer()};e.prototype._resizeContainer=function(){var t=this._getMenuSizes(),e=t.width,r=t.height,i=this.store.getState(),n=i.player.height;Object(o.d)(this.container,{width:e+"px",height:r+"px",overflow:n-40>=r?"hidden":"auto"})};e.prototype._getMenuSizes=function(){var t=void 0;t=this.hasQuality&&!this.hasSubtitles?43:this.hasSubtitles&&!this.hasQuality?29:87;this.isQualitySelectOpened&&(t=this.selectQualityContainer.clientHeight);return{width:135,height:t}};e.prototype._getSettingsItem=function(t){var e=t.content,r=t.dataAttr,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Object(o.c)(this.menuContainer,"div",{color:"#ffffff",cursor:"pointer",padding:"5px 10px",marginBottom:i?"15px":0,display:"flex",justifyContent:"space-between",alignItems:"center"});r&&n.setAttribute(r,!0);n.appendChild(e());n.classList.add("settingsHover");return n};e.prototype._getQualityItem=function(t){var e=t?t.height+"p":f.a[this.language].autoQuality,r=document.createElement("div");Object(o.d)(r,{color:"#ffffff",cursor:"pointer",padding:"5px 10px",marginBottom:t?"5px":0});r.textContent=e;r.classList.add("settingsHover");return r};e.prototype.update=function(){var t=this.store.getState(),e=t.player.isSettingsPanelSeen,r=e?"block":"none";Object(o.d)(this.container,{display:r});e||this._toggleQualitySelect(!1)};e.prototype.updateLanguage=function(){this.language=this.store.getState().application.language;this._updateQualities();this._renderSettingsOptions()};return e}(s.a)},557:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>\n  <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n'},558:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=r(2);e.a=function(){function t(e){i(this,t);this.stylesContainer=e.stylesContainer;this.color=e.color||"#7fcc4e";this.checked=Boolean(e.checked);this.callback=e.callback;return this.render()}t.prototype.render=function(){this.stylesContainer&&Object(n.a)(this.stylesContainer,t._getSwitchStyles(this.color));this.container=document.createElement("label");this.container.classList.add("viqeo-switch");this.checkbox=document.createElement("input");this.checkbox.type="checkbox";this.checkbox.checked=this.checked;this.container.appendChild(this.checkbox);this.slider=document.createElement("span");this.slider.classList.add("switch-slider");this.container.appendChild(this.slider);this.container.addEventListener("click",this._handleClick.bind(this));return this.container};t.prototype.toggle=function(t){var e=void 0!==t?Boolean(t):!this.checked;this.checkbox.checked=e;this.checked=e;this._handleCallback()};t.prototype.getValue=function(){return this.checkbox.checked};t.prototype._handleClick=function(){this.toggle(!this.checkbox.checked)};t.prototype._handleCallback=function(){this.callback&&"function"==typeof this.callback&&this.callback(this.checked)};t._getSwitchStyles=function(t){return{".viqeo-switch":{position:"relative;",display:"inline-block;",width:"40px;",height:"19px;"},".viqeo-switch input":{display:"none;"},".viqeo-switch .switch-slider":{position:"absolute;",cursor:"pointer;",top:"0;",left:"0;",right:"0;",bottom:"0;","background-color":"#ccc;","-webkit-transition":".4s;",transition:".4s;","border-radius":"34px;"},".viqeo-switch .switch-slider:before":{position:"absolute;",content:'"";',height:"15px;",width:"15px;",left:"4px;",bottom:"2px;","background-color":"#ffffff;","-webkit-transition":".4s;",transition:".4s;","border-radius":"50%;"},".viqeo-switch input:checked + .switch-slider":{"background-color":t+";"},".viqeo-switch input:focus + .switch-slider":{"box-shadow":"0 0 1px "+t+";"},".viqeo-switch input:checked + .switch-slider:before":{"-webkit-transform":"translateX(18px);","-ms-transform":"translateX(18px);",transform:"translateX(18px);"}}};return t}()},559:function(t,e,r){"use strict";e.a={unpublished:"Не опубликовано",quality:"Качество",autoQuality:"Автоматически",subtitles:"Субтитры",qualityBack:"Качество"}},560:function(t,e,r){"use strict";e.a={unpublished:"Not published",quality:"Quality",autoQuality:"Auto",subtitles:"Subtitles",qualityBack:"Quality"}},561:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(87),s=r(2),l=r(8),c=r(337),u=r.n(c),d=r(562),h=r.n(d),f=r(563),p=r.n(f),g=r(336),y=r.n(g),v=r(10),m=r(12),b=r(149),E=r(22),_=r(13),S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},T=function t(e,r){return!(!e.getAttribute||!e.getAttribute(r))||e.parentNode&&t(e.parentNode,r)};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(m.a)({},[{getValues:function(t){return{data:t.vqSubtitles.data}},onChange:a._renderSettingsOptions.bind(a)},{getValues:function(t){return{isSubtitlesEnabled:t.player.isSubtitlesEnabled}},onChange:a._updateSubtitlesEnable.bind(a)},{getValues:function(t){return{selectedQuality:t.player.selectedQuality}},onChange:a._updateSelectedQuality.bind(a)},{getValues:function(t){return{qualities:t.player.qualities,vqControls:t.vqControls}},onChange:function(){a._renderSettingsOptions();a._updateQualities()}},{getValues:function(t){return{language:t.application.language}},onChange:a.updateLanguage.bind(a)},{getValues:function(t){return{volume:t.player.volume}},onChange:a._updateVolume.bind(a)},{getValues:function(t){return{vqControls:t.vqControls}},onChange:function(){a._updateControls.bind(a)}},{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:a._updateFullscreen.bind(a)},{getValues:function(t){var e=t.player;return{width:e.width,height:e.height}},onChange:a._resizePlayer.bind(a)}],a.store);Object(o.d)(a.options.iframe,function(){a.store.dispatch(Object(o.b)()&&Object(o.b)()===a.options.player.getContainer()?{type:"START_FULL_SCREEN"}:{type:"END_FULL_SCREEN"})});a.iframe=r.iframe;a.isQualitySelectOpened=!1;a.qualities=[];return a}a(e,t);e.prototype.render=function(){var e=this,r=document.createElement("link");r.setAttribute("rel","stylesheet");r.setAttribute("type","text/css");r.setAttribute("href","https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i&subset=cyrillic,cyrillic-ext");this.iframe.contentDocument.head.appendChild(r);Object(s.a)(this.iframe.contentDocument.head,{".settingsHover:hover":{background:"rgba(255, 255, 255, 0.3) !important;"},".iconHover:hover":{border:"1px solid #ffffff !important;"}});this.container=document.createElement("div");Object(s.d)(this.container,{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%",margin:"auto",display:"none",position:"absolute",top:"0px",left:"0px",bottom:"0px",right:"0px",boxSizing:"border-box",zIndex:v.a.mobilePanel,background:"rgba(0, 0, 0, 0.5)",cursor:"default",fontWeight:"300",fontSize:"10pt",fontFamily:"Roboto, sans-serif",transition:"all 0.2s linear",overflow:"auto",touchAction:"manipulation",userSelect:"none"});this.menuContainer=document.createElement("div");Object(s.d)(this.menuContainer,{height:"100%",position:"relative"});this.addClickEvent(this.menuContainer,function(t){if(T(t.target,"close-settings")){e._toggleQualitySelect(!1);e.store.dispatch(Object(E.l)())}if(T(t.target,"quality-select")){Object(s.e)(t);e.store.getState().player.qualities.length>1&&e._toggleQualitySelect(!0)}if(T(t.target,"toggle-fullscreen")){var r=e.store.getState();e.store.dispatch(r.player.hasFullScreen?Object(E.u)():Object(E.v)());e._toggleQualitySelect(!1);e.store.dispatch(Object(E.l)())}if(T(t.target,"toggle-subtitles")){var i=e.store.getState();e.store.dispatch(i.player.isSubtitlesEnabled?{type:"SUBTITLES_DISABLE"}:{type:"SUBTITLES_ENABLE"})}if(T(t.target,"toggle-sound")){if(e.store.getState().player.volume){e.store.dispatch(Object(E.p)());e.store.dispatch(Object(_.h)("Tracker:userAction",{trackingParams:{name:"Mute"}}))}else{e.store.dispatch(Object(E.I)());e.store.dispatch(Object(_.h)("Tracker:userAction",{trackingParams:{name:"Unmute"}}))}}});this.container.appendChild(this.menuContainer);this.selectQualityContainer=document.createElement("div");Object(s.d)(this.selectQualityContainer,{display:"none",fontSize:"25pt"});this.addClickEvent(this.selectQualityContainer,function(t){var r=t.target.getAttribute("data-quality");r&&e._selectQuality(r);(t.target.getAttribute("menu-back")||t.target.parentNode&&t.target.parentNode.getAttribute("menu-back"))&&e._toggleQualitySelect(!1)});this.container.appendChild(this.selectQualityContainer);this._renderQualities();this._renderSettingsOptions();this._updateSelectedQuality();this.parent.appendChild(this.container);this.addClickEvent(this.container,function(t){Object(s.e)(t);e._toggleQualitySelect(!1);e.store.dispatch(Object(E.l)())});t.prototype.render.call(this)};e.prototype._selectQuality=function(t){if(t){var e=JSON.parse(t),r=e?e.height:null;this.store.dispatch({type:"SELECT_QUALITY",payload:r});this._toggleQualitySelect(!1);Object(s.q)("viqeo-quality",e?e.height:"auto");this.store.dispatch(Object(_.h)("Tracker:qualitySelected",{trackingParams:{quality:r}}))}};e.prototype._renderSettingsOptions=function(){var t=this,r=this.store.getState(),i=r.player,n=i.qualities,a=i.selectedQuality,o=i.hasFullScreen,l=r.vqControls,c=r.vqSubtitles,d=c.data,f=l.quality.value,g=l.subtitles.value;this.hasQuality="true"===f&&n&&n.length>1;this.hasSubtitles="true"===g&&d.length;this.settingsContainer=document.createElement("div");Object(s.d)(this.settingsContainer,{display:"flex",height:"100%",maxHeight:"90%",flexDirection:"column",justifyContent:"space-around",position:"absolute",top:"50%",left:0,width:"100%",transform:"translateY(-50%)"});var v=[],m=[],b={fill:"#fff",width:"100%",height:"100%",boxSizing:"border-box",padding:"15%",borderRadius:"50%",border:"2px solid #fff",background:"rgba(255, 255, 255, 0.2)"};this.hasQuality&&v.push({content:function(){var t=document.createElement("div");t.innerHTML=p.a;var e=t.firstElementChild;e.lastElementChild.textContent=a||"auto";Object(s.d)(e,b);e.setAttribute("quality-select",!0);return t}});var E=this.store.getState(),_=E.options.videoGalleryMode,T=E.vqPlayback,w=T.videoclick,O=T.videoclick_allow_fullscreen,A=l.fullscreen,C=w.type,R=O.type,L=A.value,k=!1;k="viqeo"===C?"true"===L:"true"===L&&("pause"===C&&"true"===R&&_||"pause"===C&&"false"===R||"videomode"===C&&_);k&&!o&&v.push({content:function(){var t=document.createElement("div");t.innerHTML=o?h.a:u.a;var e=t.firstElementChild;Object(s.d)(e,b);e.setAttribute("toggle-fullscreen",!0);return e}});var D=this.store.getState(),x=D.player.isSubtitlesEnabled;this.hasSubtitles&&v.push({content:function(){var t=document.createElement("div");t.innerHTML=y.a;var e=t.firstElementChild;e.setAttribute("toggle-subtitles",!0);Object(s.d)(e,S({},b,{padding:"15%"}));Object(s.d)(e,{fill:x?"#7fcc4e":"#fff",borderColor:x?"#7fcc4e":"#fff"});return e}});if(v.length<=3){m.push([]);v.forEach(function(t){m[0].push(t)})}else m=v.reduce(function(t,e,r){var i=Math.floor(r/2);t[i]||(t[i]=[]);t[i].push(e);return t},[]);m.forEach(function(r){var i=Object(s.c)(t.settingsContainer,"div",{display:"flex",justifyContent:"space-around",width:"100%",maxWidth:m.length>1?"70%":"90%",margin:"0 auto"});r.forEach(function(t){e._getSettingsItem(t,i)})});this.menuContainer.innerHTML="";this.menuContainer.appendChild(this.settingsContainer)};e.prototype._renderQualities=function(){var t=this,e=this.store.getState(),r=e.player,i=r.qualities,n=r.selectedQuality,a=r.width,o=r.height;this.selectQualityContainer.innerHTML="";var l=Object(s.c)(this.selectQualityContainer,"div",{display:"flex",height:"100%",justifyContent:"space-around",alignItems:"center",textAlign:"right",fontSize:"1.5em",fontWeight:"400",maxWidth:"90%",margin:"0 auto"}),c=o>a,u=Object(s.c)(l,"div",{display:c?"block":"flex",textAlign:c?"center":"inherit",width:"100%",justifyContent:"space-around",alignItems:"flex-end"}),d=i.slice().sort(function(t,e){return parseInt(t.height,10)>parseInt(e.height,10)?-1:1});d.push(null);d.reduce(function(t,e,r){var i=Math.floor(r/Math.ceil(d.length/2));t[i]||(t[i]=[]);t[i].push(e);return t},[]).forEach(function(e){var r=Object(s.c)(u,"div");e.forEach(function(e){var i=t._getQualityItem(e);i.setAttribute("data-quality",JSON.stringify(e));e?n&&e.height===n&&Object(s.d)(i,{color:"#7fcc4e"}):e===n&&Object(s.d)(i,{color:"#7fcc4e"});r.appendChild(i)})})};e.prototype._toggleQualitySelect=function(t){var e=void 0===t?!this.isQualitySelectOpened:Boolean(t);if(e){Object(s.d)(this.menuContainer,{display:"none"});Object(s.d)(this.selectQualityContainer,{display:"block"})}else{Object(s.d)(this.menuContainer,{display:"block"});Object(s.d)(this.selectQualityContainer,{display:"none"})}this.isQualitySelectOpened=e};e._getSettingsItem=function(t,e){var r=t.content,i=t.callback,n=Object(s.c)(e,"div",{color:"#ffffff",cursor:"pointer",width:"100%",maxWidth:"25%"});Object(s.s)(n).appendChild(r());n.addEventListener("click",i);return n};e.prototype._getQualityItem=function(t){var e=this.store.getState(),r=e.player,i=r.width,n=r.height,a=t?t.height+"p":b.a[this.language].autoQuality,o=document.createElement("div");Object(s.d)(o,{color:"#ffffff",cursor:"pointer",padding:"5px 10px",height:n>i?"6vh":"15vh",fontSize:"4.5vw",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"});o.textContent=a;return o};e.prototype._updateSelectedQuality=function(){this._renderSettingsOptions();this._renderQualities()};e.prototype._updateQualities=function(){this._renderQualities()};e.prototype._updateSubtitlesEnable=function(){this._renderSettingsOptions()};e.prototype._updateVolume=function(){this._renderSettingsOptions()};e.prototype._updateFullscreen=function(){this._renderSettingsOptions();this._renderQualities()};e.prototype._updateControls=function(){this._renderSettingsOptions()};e.prototype._resizePlayer=function(){this._renderQualities()};e.prototype.update=function(){var t=this.store.getState(),e=t.player,r=e.isSettingsPanelSeen,i=e.isQualitySelectOpened,n=r?"block":"none";Object(s.d)(this.container,{display:n});r?i&&this._toggleQualitySelect(!0):this._toggleQualitySelect(!1)};e.prototype.updateLanguage=function(){this.language=this.store.getState().application.language;this._renderSettingsOptions();this._renderQualities()};return e}(l.a)},562:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n  <path d="M0 0h24v24H0z" fill="none"/>\n  <path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>\n</svg>\n'},563:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="30" viewBox="0 0 24 30">\n  <path d="M0 0h24v24H0z" fill="none"/>\n  <path d="M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 11H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm7-1c0 .55-.45 1-1 1h-.75v1.5h-1.5V15H14c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v4zm-3.5-.5h2v-3h-2v3z"/>\n  <text x="12" y="26" font-size="6" font-weight="400" text-anchor="middle" alignment-baseline="central" />\n</svg>\n'},564:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(50),l=r(13),c=r(95),u=r(10);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");Object(o.d)(this.container,{position:"absolute",zIndex:u.a.videoMode,bottom:"10px",right:"50px",width:"30px",height:"30px",cursor:"pointer",display:"none"});Object(s.a)(this.container);this.icon=document.createElement("div");Object(o.d)(this.icon,{width:"12px",height:"9px",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)",border:"1.5px solid #fff",zIndex:100});this.container.appendChild(this.icon);this.parent.appendChild(this.container);this.container.addEventListener("click",this._handleClick.bind(this));t.prototype.render.call(this)};e.prototype._handleClick=function(t){this.store.dispatch(Object(l.h)("Modal:Gallery"));Object(o.e)(t)};e.prototype.update=function(){var t=this.store.getState(),e=t.options,r=e.videoGalleryMode,i=e.hasOverlayMode,n=t.vqPlayback,a=t.vqControls.volume,s=n.videoclick,l=n.videoclick_allow_fullscreen,c=s.type,u=l.type,d=!i&&"viqeo"!==c&&"pause"===c&&"true"===u,h=!r&&d?"block":"none",f=a.hidden?"10px":"50px";Object(o.d)(this.container,{display:h,right:f})};return e}(c.a)},565:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(50),l=r(171),c=r.n(l),u=r(88),d=r.n(u),h=r(330),f=r.n(h),p=r(5),g=r(95),y=r(25),v=r(22),m=r(10),b=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.playState={};Object(b.a)(a.playState,[{getValues:function(t){return{status:t.player.status}},onChange:a.updateStatus.bind(a)},{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:a.updateFullscreen.bind(a)}],a.store);return a}a(e,t);e.prototype.render=function(){var e=this;this.container=document.createElement("div");Object(o.d)(this.container,{position:"absolute",width:"30px",height:"30px",bottom:"10px",left:"10px",cursor:"pointer",zIndex:m.a.play});this.play=Object(o.c)(this.container,"div",{position:"absolute",width:"80%",height:"80%",left:"10%",top:"10%",zIndex:20,display:"block"},d.a);this.play.className+="b-play";this.addClickEvent(this.play,function(t){Object(o.e)(t);var r=e.store.getState(),i=r.player.status;e.store.dispatch(Object(v.r)(i,{force:!0}))});this.pause=Object(o.c)(this.container,"div",{position:"absolute",width:"80%",height:"80%",left:"10%",top:"10%",zIndex:20,display:"none"},c.a);this.pause.className+="b-pause";this.addClickEvent(this.pause,function(t){Object(o.e)(t);e.store.dispatch(Object(v.q)({force:!0}))});this.replay=Object(o.c)(this.container,"div",{position:"absolute",width:"80%",height:"80%",left:"10%",top:"10%",zIndex:20,display:"none"},f.a);this.replay.className+="b-replay";this.addClickEvent(this.replay,function(t){Object(o.e)(t);e.store.dispatch(Object(v.t)({force:!0}))});Object(s.a)(this.container);this.parent.appendChild(this.container);this.update();t.prototype.render.call(this)};e.prototype.updateStatus=function(){[this.pause,this.play,this.replay].forEach(function(t){return Object(o.k)(t)});switch(this.store.getState().player.status){case y.a.ENDED:Object(o.r)(this.replay);break;case y.a.LOADED:case y.a.PAUSED:Object(o.r)(this.play);break;case y.a.PLAYED:case y.a.REPLAYED:case y.a.STARTED:Object(o.r)(this.pause);break;default:Object(o.r)(this.play)}};e.prototype.updateFullscreen=function(){this.updateVisibility()};e.prototype.updateVisibility=function(){this.store.getState().vqControls.play.hidden?this.hide():p.f?this.hide():this.show()};e.prototype.update=function(){this.updateVisibility();t.prototype.update.call(this)};return e}(g.a)},566:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(5),l=r(50),c=r(8),u=r(13),d=r(567),h=r.n(d),f=r(568),p=r.n(f),g=r(22),y=r(10),v=r(12);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.volumeState={};a._hasVisibleRange=!!a.store.getState().player.volume;Object(v.a)(a.volumeState,[{getValues:function(t){return{volume:t.player.volume}},onChange:a._updateVolume.bind(a)},{getValues:function(t){return{vqControls:t.vqControls}},onChange:a._updateControl.bind(a)},{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:a.updateFullscreen.bind(a)}],a.store);a._rangeHeight=55;return a}a(e,t);e.prototype.render=function(){var e=this;this.container=document.createElement("div");this.content=Object(o.s)(this.container);Object(o.d)(this.container,{position:"absolute",zIndex:y.a.volume,bottom:"10px",right:"10px",display:"inline-block",width:s.f?"8%":"30px",maxWidth:"50px"});this.range=this._getRange();this.iconWrapper=Object(o.c)(this.content,"div",{width:"100%",height:"100%",position:"relative",zIndex:200});this.container.addEventListener("mouseover",function(){return e._showRange()});this.container.addEventListener("mouseout",function(){return Object(o.d)(e.range,{display:"none"})});this.container.addEventListener("click",function(t){return Object(o.e)(t)});var r="DOMMouseScroll";"onwheel"in HTMLDivElement.prototype?r="wheel":void 0!==document.onmousewheel&&(r="mousewheel");this.container.addEventListener(r,this._onMouseWheel.bind(this),!!s.h&&{passive:!1});this.addClickEvent(s.f?this.container:this.iconWrapper,function(t){Object(o.e)(t);var r=e.store.getState(),i=r.player,n=i.volume,a=i.volumeForced;if(n){e.store.dispatch(Object(g.p)());e.store.dispatch(Object(u.h)("Tracker:userAction",{trackingParams:{name:"Mute"}}))}else{e._hasVisibleRange=!0;e._showRange();e.store.dispatch(a?Object(g.z)(a):Object(g.I)());e.store.dispatch(Object(u.h)("Tracker:userAction",{trackingParams:{name:"Unmute"}}))}});this.volume=Object(o.c)(this.iconWrapper,"div",{position:"absolute",zIndex:20,width:"80%",height:"80%",left:"10%",top:"10%"});Object(l.a)(this.content);this.parent.appendChild(this.container);this._updateVolume();t.prototype.render.call(this)};e.prototype._showRange=function(){!s.f&&this._hasVisibleRange&&Object(o.d)(this.range,{display:"block"})};e.prototype._getRange=function(){var t=this.store.getState(),e=t.vqControls.progress.color,r=Object(o.c)(this.container,"div",{width:"26px",height:this._rangeHeight+"px",margin:"auto",display:"none",position:"absolute",bottom:"29px",padding:"10px 0 0 0",boxSizing:"border-box",borderRadius:"3px 3px 0 0 ",left:"0px",right:"0px",zIndex:5}),i=Object(o.c)(r,"div",{width:"100%",height:"100%",position:"relative"});Object(o.c)(r,"div",{width:"100%",height:"100%",background:"#000",opacity:.3,position:"absolute",top:"0px"});Object(o.c)(r,"div",{position:"absolute",top:"55px",height:"10px",width:"100%",backgroundColor:"rgba(254, 254, 254, 0)",backgroundImage:"radial-gradient(ellipse farthest-side at center bottom,rgba(255, 255, 255, 0) 99.5%,rgba(253, 253, 253, 0) 99.5%,rgba(0, 0, 0, 0.3) 100%)"});var n=Object(o.c)(i,"div",{width:"100%",height:"100%",position:"absolute",zIndex:200});n.addEventListener("mousedown",this._onMouseDown.bind(this));n.addEventListener("mouseup",this._onMouseUpContainer.bind(this));document.addEventListener("mouseup",this._onMouseUpDocument.bind(this));document.addEventListener("mousemove",this._onMouseMove.bind(this));var a=Object(o.c)(i,"div",{width:"100%",height:"100%",position:"absolute",zIndex:100});Object(o.c)(a,"div",{width:"5px",height:"100%",background:"#fff",position:"absolute",top:"0px",left:"0px",right:"0px",margin:"0 auto"});this._fillLine=Object(o.c)(a,"div",{width:"5px",height:"100%",background:e,position:"absolute",left:"0px",right:"0px",margin:"0 auto",bottom:"0px"});var s=Object(o.c)(a,"div",{width:"100%",height:"100%",paddingBottom:"11px",boxSizing:"border-box"});this._rangeLine=Object(o.c)(s,"div",{width:"100%",height:"100%",position:"relative"});this._controlSlider=Object(o.c)(this._rangeLine,"div",{top:"0%",width:"11px",height:"11px",background:"#fff",borderRadius:"20px",position:"absolute",left:"0px",right:"0px",margin:"0 auto"});this._roundControl=Object(o.c)(this._controlSlider,"div",{width:"5px",height:"5px",background:e,margin:"auto",borderRadius:"20px",position:"relative",top:"3px"});return r};e.prototype._onMouseDown=function(t){var e=t.offsetY,r=this._rangeLine.offsetHeight-e;this.options.player.getContainer().classList.add("rewind");var i=(r+this._controlSlider.offsetHeight/2)/this._rangeLine.offsetHeight;r||(i=0);this.store.dispatch(Object(g.z)(i,{force:!0}));Object(o.e)(t);this._hasDown=!0};e.prototype._onMouseUpContainer=function(t){this._hasDown=!1;Object(o.e)(t);var e=this.options.player.getContainer();setTimeout(function(){return e.classList.remove("rewind")},100)};e.prototype._onMouseUpDocument=function(t){if(this._hasDown){Object(o.e)(t);var e=this.options.player.getContainer();setTimeout(function(){return e.classList.remove("rewind")},100);this._hasDown=!1}};e.prototype._onMouseMove=function(t){if(this._hasDown&&"none"!==this.range.style.display){var e=this.store.getState(),r=e.player.volume,i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,n=this.options.iframe.getBoundingClientRect().top+i+this._rangeLine.getBoundingClientRect().top,a=n+this._rangeLine.offsetHeight+this._controlSlider.offsetHeight,o=void 0;n<t.pageY&&a>t.pageY?o=1-(t.pageY-n-this._controlSlider.offsetHeight/2)/this._rangeLine.offsetHeight:t.pageY>=a?o=0:t.pageY<=n&&(o=1);r!==o&&this.store.dispatch(Object(g.z)(o,{force:!0}))}};e.prototype._onMouseWheel=function(t){if("block"===this.range.style.display){var e=t.deltaY||t.detail||t.wheelDelta,r=this.store.getState(),i=r.player.volume,n=i;n=e>0?i-.2:i+.2;this.store.dispatch(Object(g.z)(n,{force:!0}));Object(o.e)(t)}};e.prototype._updateVolume=function(){var t=this.store.getState(),e=t.player,r=e.volume;this.volume.innerHTML=e.emptyAudioTrack?p.a:r>0?h.a:p.a;var i=100-100*r;0===i&&(i=-1);Object(o.d)(this._controlSlider,{top:i+"%"});Object(o.d)(this._fillLine,{height:100*r+"%"})};e.prototype.updateFullscreen=function(){this.updateVisibility()};e.prototype.updateVisibility=function(){this.store.getState().vqControls.volume.hidden?Object(o.d)(this.container,{display:"none"}):Object(o.d)(this.container,{display:"inline-block"})};e.prototype.update=function(){var e=this.store.getState(),r=e.player.hasFullScreen;this.updateVisibility();Object(o.d)(this.container,{paddingTop:s.f?"50px":0,paddingLeft:s.f&&!r?"50px":0});t.prototype.update.call(this)};e.prototype._updateControl=function(){var t=this.store.getState(),e=t.vqControls.progress.color;Object(o.d)([this._fillLine,this._roundControl],{background:e})};return e}(c.a)},567:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">\n<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z" fill="white"/>\n  <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n'},568:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24">\n<path d="M7 9v6h4l5 5V4l-5 5H7z" fill="white"/>\n  <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n'},569:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(13),l=r(22),c=r(148),u=r(335),d=r(338);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){var e=this;t.prototype.render.call(this);this.runnerWidth=c.b;Object(o.d)(this.runner,{height:parseInt(this.mouseEvent.mouseIn.height,10)+6+"px",width:"6px",bottom:"-3px"});this.addEvent(this.container,"mouseenter",function(t){Object(o.d)(e.runner,{display:"block"});var r=e._getTimePosition(t);e.store.dispatch(Object(u.b)(r))});this.addEvent(this.container,"mouseleave",function(){e.store.dispatch(Object(u.c)());e.store.getState().player.hasRewind||Object(o.d)(e.runner,{display:"none"})});this.addClickEvent(this.container,this.onClick.bind(this));this.addEvent(this.container,"mousedown",this.onStart.bind(this));this.addEvent(this.container,"mouseup",this.onMouseUpContainer.bind(this));this.addEvent(document,"mouseup",this.onMouseUpDocument.bind(this));this.addEvent(document,"mousemove",this.onMove.bind(this));this.parent.appendChild(this.container);this.update()};e.prototype.onStart=function(){this.hasDisable()||(this.hasStart=!0)};e.prototype.onClick=function(t){var e=this.runner.offsetLeft;if(!this.hasDisable()){var r=this.store.getState(),i=r.player,n=i.width,a=i.duration;this.store.dispatch(Object(l.w)(e/n*a));this.store.dispatch(Object(s.h)("Tracker:rewind"))}Object(o.e)(t)};e.prototype._getTimePosition=function(t){var e=this.store.getState(),r=e.player,i=r.width,n=r.duration,a=Object(o.i)(this.iframe),s=Math.floor(this.runnerWidth/2),l=i,c=t.pageX-a,u=c+s+1,d=c-s,h=void 0;h=d<0?0:u>l?l-this.runnerWidth:c-s;Object(o.d)(this.runner,{left:h+"px"});u>=l&&(h=l);return h/i*n};e.prototype.onMove=function(t){if(!this.hasDisable()){var e=this.store.getState(),r=e.player.hasRewind,i=r;if(this.hasStart&&!r){this.store.dispatch(Object(l.G)());this.store.dispatch(Object(s.h)("Tracker:rewind"));i=!0}var n=this._getTimePosition(t);this.store.dispatch(i?Object(l.w)(n):Object(u.a)(n))}};e.prototype.onMouseUpContainer=function(){var t=this;if(!this.hasDisable()){this.store.getState().player.hasRewind&&setTimeout(function(){return t.store.dispatch(Object(l.j)())},100);this.hasStart=!1}};e.prototype.onMouseUpDocument=function(){if(!this.hasDisable()){this.store.getState().player.hasRewind&&Object(o.d)(this.runner,{display:"none"});this.onMouseUpContainer()}};return e}(d.a)},570:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(2),s=r(13),l=r(22),c=r(10),u=r(338);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a.started=!1;a.detecting=!1;a.hasShowBlick=!1;a.touch=null;a.runnerWidth=parseInt(a.mouseEvent.mouseOut.height,10);a.touchArea=document.createElement("div");Object(o.d)(a.touchArea,{height:"10px",width:"100%",position:"absolute",bottom:0,left:0,zIndex:c.a.mobileTouchProgress});a.touchArea.classList.add("test");a.parent.appendChild(a.touchArea);return a}a(e,t);e.prototype.render=function(){t.prototype.render.call(this);Object(o.b)(this.container,"blick",[{percent:"0%",css:{opacity:"0"}},{percent:"60%",css:{opacity:".5"}},{percent:"100%",css:{opacity:"0"}}]);Object(o.d)(this.runner,{width:this.runnerWidth+"px",bottom:"0px"});this.touchArea.addEventListener("touchstart",this.onTouchArea.bind(this));this.touchArea.addEventListener("touchstart",this.onStart.bind(this));this.touchArea.addEventListener("touchend",this.onTouchEndContainer.bind(this));this.parent.addEventListener("touchstart",this.onStart.bind(this));this.parent.addEventListener("touchend",this.onTouchEndContainer.bind(this),!0);document.addEventListener("touchend",this.onTouchEndDocument.bind(this));this.parent.addEventListener("touchmove",this.onMove.bind(this));this.parent.appendChild(this.container);this.update()};e.prototype.detect=function(t){var e=this.touch.pageX,r=this.touch.pageY,i=t.changedTouches[0].pageX,n=t.changedTouches[0].pageY,a=Math.abs(e-i),o=Math.abs(r-n);a>=o?this.started=!0:o>0&&(this.block=!0);this.detecting=!1};e.prototype.onTouchArea=function(t){Object(o.e)(t);this.moveRunner(t,!1)};e.prototype.onTouchEndContainer=function(t){this.onTouchEndDocument(t)};e.prototype.onTouchEndDocument=function(t){if(this.store.getState().player.hasRewind){this.store.dispatch(Object(l.j)());Object(o.e)(t)}else this.block&&Object(o.e)(t);this.started=!1;this.detecting=!1;this.hasShowBlick=!1;this.block=!1;Object(o.d)(this.runner,{display:"none"})};e.prototype.onStart=function(t){if(1===t.touches.length&&!this.started){this.detecting=!0;this.touch=t.changedTouches[0]}};e.prototype.moveRunner=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.store.getState(),i=r.player,n=i.width,a=i.hasRewind,c=i.duration,u=a;if(!a){this.store.dispatch(Object(l.G)());this.store.dispatch(Object(s.h)("Tracker:rewind"));u=!0}var d=Object(o.i)(this.iframe),h=Math.floor(this.runnerWidth/2),f=n,p=t.targetTouches[0].pageX-d,g=p+h+1,y=p-h,v=void 0;v=y<0?0:g>f?f-this.runnerWidth:p-h;Object(o.d)(this.runner,{left:v+"px"});if(u){g>=f&&(v=f);this.store.dispatch(Object(l.w)(v/n*c));e&&Object(o.d)(this.runner,{display:"block"})}};e.prototype.onMove=function(t){if(this.started||this.detecting){this.detecting&&this.detect(t);this.started&&(this.hasDisable()?this.hasShowBlick||this.showBlick():this.moveRunner(t))}};e.prototype.showBlick=function(){this.hasShowBlick=!0;var t=Object(o.c)(this.parent,"div",{position:"absolute",width:"100%",height:"100%",top:"0",left:"0",background:"#fff",opacity:"0",animation:"blick 250ms linear 1",zIndex:c.a.blick});t.addEventListener("animationend",function(){Object(o.p)(t)})};e.prototype.update=function(){var e=this.store.getState(),r=e.player.height;Object(o.d)(this.runner,{height:r+"px"});t.prototype.update.call(this)};return e}(u.a)},571:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(5),s=r(88),l=r.n(s),c=r(2),u=r(4),d=r(8),h=r(10),f=r(572),p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},g={position:"absolute",top:"10px",left:"10px",zIndex:h.a.copyright,color:"#ffffff",opacity:"0.5",webkitTransition:"opacity 500ms ease-in-out",transition:"opacity 500ms ease-in-out",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:o.f?"40%":"85%",fontSize:"12px",fontWeight:"300",borderRadius:"1px",padding:"6px"};e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){var t=this;this.container=document.createElement("a");this.container.target="_blank";this.addClickEvent(this.container,function(e){if(t.container.href){Object(c.e)(e);Object(u.s)(t.container.href)}});Object(c.d)(this.container,p({},g,{display:"none"}));this.copyrightIcon=document.createElement("div");this.copyrightIcon.innerHTML="&copy;";Object(c.d)(this.copyrightIcon,{marginRight:"5px",marginTop:"1px",fontSize:"18px",lineHeight:"12px"});this.useIcon=null;this.icon=Object(c.c)(this.container,"div",{display:"inline-block",verticalAlign:"middle"});this.text=Object(c.c)(this.container,"span",{verticalAlign:"middle"});if(!o.f){this.container.addEventListener("mouseenter",function(){Object(c.d)(t.container,{opacity:"1"})});this.container.addEventListener("mouseleave",function(){Object(c.d)(t.container,{opacity:"0.5"})})}this.parent.appendChild(this.container);this.update()};e.prototype.update=function(){var e=this.store.getState(),r=e.application,i=r.language,n=r.unpublishedLabelVisible,a=e.vqControls.copyright.type,s=e.copyright,d=s.link,h=s.url,p=s.text,y=s.logo,v=s.logocolor;this.language=i;if(a&&"hide"!==a&&p&&"url"===d&&h&&!n){this.show();var m=Object(u.p)(h),b=o.f?f.a[this.language].sourceShort:f.a[this.language].watchSource;"author"===a?b=o.f?f.a[this.language].authorShort:Object(c.g)(p):"button"===a&&m&&(b=o.f?f.a[this.language].youTubeShort:f.a[this.language].watchYoutube);this.text.textContent=b;this.icon.style.color=v||"#ffffff";this.container.href=h;if("button"===a){Object(c.d)(this.container,{top:"7.5px",textDecoration:"none",background:m?"#ec0202":"#d6d6d6",color:m?"#fff":"#000"});Object(c.d)(this.text,{position:"relative",top:"1px"})}else{Object(c.d)(this.container,g);Object(c.d)(this.text,{top:"0"})}var E=this.copyrightIcon;if("play"===y||"button"===a){E=document.createElement("div");E.innerHTML=l.a;var _=E.firstElementChild;Object(c.d)(_,{width:"15px",height:"15px",marginRight:"1px",fill:m?"#fff":"#000"})}if(this.useIcon!==E){this.icon.innerHTML="";this.icon.appendChild(E);this.useIcon=E}}else this.hide();t.prototype.update.call(this)};return e}(d.a)},572:function(t,e,r){"use strict";var i=r(573);e.a={en:r(574).a,ru:i.a}},573:function(t,e,r){"use strict";e.a={watchSource:"Смотреть оригинал",watchYoutube:"Смотреть на YouTube",sourceShort:"Оригинал",authorShort:"Автор",youTubeShort:"На YouTube"}},574:function(t,e,r){"use strict";e.a={watchSource:"Watch source",watchYoutube:"Watch on YouTube",sourceShort:"Source",authorShort:"Author",youTubeShort:"On YouTube"}},575:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(10),c=r(12),u=r(149);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(c.a)(a,[{getValues:function(t){return{unpublishedLabelVisible:t.application.unpublishedLabelVisible}},onChange:a.updateVisibility.bind(a)},{getValues:function(t){return{language:t.application.language}},onChange:a.updateLanguage.bind(a)}],a.store);return a}a(e,t);e.prototype.render=function(){this.container=document.createElement("div");this.container.textContent=u.a[this.language].unpublished;Object(s.d)(this.container,{background:"#F97C22",position:"absolute",top:"15px",left:"15px",textTransform:"upperCase",borderRadius:"3px",color:"#ffffff",fontSize:"8pt",padding:"5px",textAlign:"center",pointerEvents:"none",zIndex:l.a.unpublishedLabel,display:"none",maxWidth:"85%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"});this.parent.appendChild(this.container)};e.prototype.updateLanguage=function(){this.language=this.store.getState().application.language;this.container.textContent=u.a[this.language].unpublished};e.prototype.updateVisibility=function(){var t=this.store.getState(),e=t.application.unpublishedLabelVisible;Object(s.d)(this.container,{display:e?"block":"none"})};return e}(o.a)},576:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(171),c=r.n(l),u=r(88),d=r.n(u),h=r(10);e.a=function(t){function e(){i(this,e);return n(this,t.apply(this,arguments))}a(e,t);e.prototype.render=function(){Object(s.d)(this.container,{position:"absolute",left:"50%",top:"50%",transform:"translateX(-50%) translateY(-50%) scale(1)",overflow:"hidden",width:"100%",height:"100%",zIndex:h.a.splashControls,display:"none",pointerEvents:"none",alignItems:"center",justifyContent:"center"});this.parent.appendChild(this.container);this.isSplashPlaySeen=!1;this.isSplashPauseSeen=!1;Object(s.b)(this.container,"vqFadeOut",[{percent:"0%",css:{opacity:1}},{percent:"100%",css:{opacity:0,transform:"scale(2)"}}]);this.play=Object(s.c)(this.container,"div",{transform:"scale(1)",zIndex:h.a.splashControls,display:"none",animation:"vqFadeOut .5s linear 1 normal forwards",transformOrigin:"center"},d.a);Object(s.d)(this.play.firstChild,{width:"100px",height:"100px"});this.pause=Object(s.c)(this.container,"div",{transform:"scale(1)",zIndex:h.a.splashControls,display:"none",animation:"vqFadeOut .5s linear 1 normal forwards",transformOrigin:"center"},c.a);Object(s.d)(this.pause.firstChild,{width:"100px",height:"100px"})};e.prototype.showPlay=function(){var t=this;this.hidePause();this.isSplashPlaySeen=!0;Object(s.r)(this.play);this.container.style.display="flex";setTimeout(function(){t.store.dispatch({type:"HIDE_SPLASH_PLAY"})},500)};e.prototype.hidePlay=function(){Object(s.k)(this.play);Object(s.k)(this.container);this.isSplashPlaySeen=!1};e.prototype.showPause=function(){var t=this;this.hidePlay();this.isSplashPauseSeen=!0;Object(s.r)(this.pause);this.container.style.display="flex";setTimeout(function(){t.store.dispatch({type:"HIDE_SPLASH_PAUSE"})},500)};e.prototype.hidePause=function(){Object(s.k)(this.pause);Object(s.k)(this.container);this.isSplashPauseSeen=!1};e.prototype.update=function(){var t=this.store.getState(),e=t.player,r=e.isSplashPlaySeen,i=e.isSplashPauseSeen;r!==this.isSplashPlaySeen&&(r?this.showPlay():this.hidePlay());i!==this.isSplashPauseSeen&&(i?this.showPause():this.hidePause())};return e}(o.a)},577:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(8),s=r(2),l=r(4),c=r(42),u=r(7),d=r(77),h=r(578),f=r(12),p=r(10),g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));Object(f.a)(a,[{getValues:function(t){return{opened:t.contextMenu.opened}},onChange:a._updateVisible.bind(a)},{getValues:function(t){var e=t.contextMenu;return{x:e.x,y:e.y,role:t.player.role}},onChange:a._updatePosition.bind(a)},{getValues:function(t){return{language:t.application.language}},onChange:a._updateLanguage.bind(a)},{getValues:function(t){return{role:t.player.role}},onChange:a._updateRole.bind(a)}],a.store);a._menuWidth=200;a._itemHeight=30;return a}a(e,t);e.prototype.render=function(){var t=this,e=this.store.getState(),r=e.application.language,i=h.a[r],n=Object(l.b)(u.a.playerHomeUrl,{utm_source:location.href,utm_campaign:"contextmenuclick"});this.container=document.createElement("div");Object(s.d)(this.container,{position:"absolute",background:"#f0f0f0",zIndex:p.a.contextMenu,width:this._menuWidth+"px",webkitBoxShadow:"0px 0px 5px 1px rgba(0,0,0,0.75)",mozBoxShadow:"0px 0px 5px 1px rgba(0,0,0,0.75)",boxShadow:"0px 0px 5px 1px rgba(0,0,0,0.75)"});this._copyUrlButton=this._createButton(i.copyUrlButton,function(){var e=t.store.getState(),r=e.player,i=r.mediaFiles,n=r.activeQuality,a=Object(c.b)(i,"video/mp4").find(function(t){return n===t.height});a&&Object(l.s)(a.url)});this._copyDebugUrl=this._createButton("Debug",function(){return Object(l.A)(u.a,t.store)});this._openUrlButton=this._createButton(i.openUrlButton,function(){return Object(l.s)(n)});this._buttons=[this._copyUrlButton,this._openUrlButton,this._copyDebugUrl];this._buttons.forEach(function(e){return t.container.appendChild(e)});this.parent.appendChild(this.container);document.body.addEventListener("click",function(){t.store.dispatch({type:"CLOSE_CONTEXT_MENU"})});this._updateVisible();this._updateRole()};e.prototype._createButton=function(t,e){var r=this,i=document.createElement("div"),n={color:"#000",background:"none"},a={color:"#fff",background:"#4a9bfe"};Object(s.d)(i,g({display:"block",lineHeight:this._itemHeight+"px",paddingLeft:"5px"},n));i.addEventListener("mouseout",function(){return Object(s.d)(i,n)});i.addEventListener("mouseover",function(){return Object(s.d)(i,a)});i.addEventListener("click",function(t){e(t);r.store.dispatch({type:"CLOSE_CONTEXT_MENU"});Object(s.e)(t)});i.innerHTML=t;return i};e.prototype._updateVisible=function(){this.store.getState().contextMenu.opened?this.show():this.hide()};e.prototype._updatePosition=function(){var t=this.store.getState(),e=t.contextMenu,r=e.x,i=e.y,n=t.player,a=n.width,o=n.height,l=n.role,c=i+10,u=r+10;this._menuWidth+r>a&&(u=a-this._menuWidth);(this._buttons.length-(d.a.USER===l?1:0))*this._itemHeight+i>o&&(c=o-this._buttons.length*this._itemHeight);Object(s.d)(this.container,{top:c+"px",left:u+"px"})};e.prototype._updateLanguage=function(){var t=this.store.getState(),e=t.application.language,r=h.a[e];this._copyUrlButton.innerHTML=r.copyUrlButton;this._openUrlButton.innerHTML=r.openUrlButton};e.prototype._updateRole=function(){var t=this.store.getState();d.a.USER===t.player.role?Object(s.d)(this._copyUrlButton,{display:"none"}):Object(s.d)(this._copyUrlButton,{display:"block"})};return e}(o.a)},578:function(t,e,r){"use strict";e.a={ru:r(579).a,en:r(580).a}},579:function(t,e,r){"use strict";e.a={openUrlButton:"О Viqeo",copyUrlButton:"URL видео"}},580:function(t,e,r){"use strict";e.a={openUrlButton:"About Viqeo",copyUrlButton:"Video URL"}},581:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=r(12);e.a=function(){function t(e){var r=e.eventEmitter,a=e.store;i(this,t);this.store=a;this.eventEmitter=r;Object(n.a)(this,[{getValues:function(t){return{event:t.application.event}},onChange:this.trigger.bind(this)}],this.store)}t.prototype.trigger=function(){var t=this.store.getState(),e=t.application.event,r=e.name,i=e.options;if(-1!==r.indexOf("Tracker")){this.eventEmitter.triggerTracker(r.split(":")[1],i)}else this.eventEmitter.trigger(r,i)};return t}()},582:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(o.composeWithDevTools)(t);return Object(n.createStore)(s.a,e,r(Object(n.applyMiddleware)(a.a)))}e.a=i;var n=r(14),a=r(83),o=r(359),s=(r.n(o),r(583))},583:function(t,e,r){"use strict";var i=r(14),n=r(584),a=r(585),o=r(586),s=r(587),l=r(588),c=r(589),u=r(590),d=r(591),h=r(592),f=r(593),p=r(594),g=r(595),y=r(596),v=r(597),m=r(598);e.a=Object(i.combineReducers)({vqControls:n.a,vqPlayback:a.a,vqSubtitles:l.a,player:o.a,application:s.a,options:c.a,task:u.a,tasks:d.a,recommendation:h.a,advert:f.a,timeline:p.a,disable:g.a,vqEffects:y.a,contextMenu:v.a,copyright:m.a})},584:function(t,e,r){"use strict";var i=r(4),n=r(102),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},o=function(){return{disableVastParser:!1,progress:{hidden:!0,color:"#7FCC4E",bgcolor:"#000"},play:{hidden:!0},volume:{hidden:!0,type:"minimal"},background:{hidden:!0},copyright:{hidden:!0,type:"hide"},appearance:{type:n.b},fullscreen:{value:"false"},quality:{value:"false"},subtitles:{value:"false"}}},s=o();e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,e=arguments[1];switch(e.type){case"START_LOAD_RECOMMENDATION":return a({},t,{disableVastParser:!0});case"INITIALIZED_PLAYER":var r=e.payload.data,n=r.vqControls||[],l=o();n.forEach(function(t){var e=t.control;l[e.id]=a({},l[e.id],e);l[e.id].hidden=!1});return l;case"UPDATE_CONTROL":var c=e.payload,u=c.id;t[u]=a({},t[u],c.options);return a({},t);case"UPDATE_VQ_CONTROLS":var d=e.payload,h=o();d.forEach(function(t){var e=t.control.id;h[e]=a({},h[e],t.control);h[e].hidden=!1});return h;case"SHOWING_CONTROLS":var f=Object(i.d)(t);["play","volume","progress"].forEach(function(t){f[t].hidden=!1});return f;default:return t}}},585:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,e=arguments[1];switch(e.type){case"START_LOAD_RECOMMENDATION":return a({},t,{disableVastParser:!0});case"UPDATE_PLAYBACK":var r=e.payload;t[r.id]=l(a({},r.options));return a({},t);case"UPDATE_VQ_PLAYBACK":var i=e.payload,n=o();i.forEach(function(t){n[t.option.id]=l(a({},t.option))});return n;case"INITIALIZED_PLAYER":if(t.disableVastParser)return t;var c=e.payload.data,u=c.vqPlayback||[],d=o();u.forEach(function(t){var e=t.option;d[e.id]=l(a({},e))});return d;default:return t}}e.a=i;var n=r(5),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},o=function(){return{disableVastParser:!1,aspect:{type:"video"},videostart:{type:"visible"},videofinished:{type:"end"},sound:{type:"off"},videoclick:{type:"viqeo"},videoclick_allow_fullscreen:{type:"false"},viewStrategy:{type:"optimal"}}},s=o(),l=function(t){switch(t.id){case"viewStrategy":return"optimal"===t.type?a({},t,{type:n.f?"speed":"quality"}):t;default:return t}}},586:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":var r=e.payload,i=r.data,o=i.mediaFiles,c=i.npvid,u=i.duration,f=void 0===u?0:u,p=r.role,g=r.profileId,y=r.width,v=r.height,m=r.playerId,b=r.canSeeStats,E=r.canEdit,_=Object(n.b)(o,"image/jpeg"),S=void 0,T=void 0,w=void 0;if(_&&_.length){S=parseInt(_[0].width,10)||0;T=parseInt(_[0].height,10)||0;w=_[0].url}return l({},t,{previewWidth:S,previewHeight:T,previewImage:w,id:c,role:t.role||p||"user",canSeeStats:t.canSeeStats||b,canEdit:t.canEdit||E,profileId:g||t.profileId,width:t.width||y,height:t.height||v,status:"",videoStatus:"",hasLoaded:!1,hasSeekBuffered:!1,seekTime:null,duration:f,playerId:m||t.playerId,mediaFiles:o.filter(function(t){return"image/jpeg"!==t.type||"audio/mpeg"!==t.type})});case"DURATION_UPDATE":return l({},t,{duration:e.payload});case"UPDATE_FILES":return l({},t,{mediaFiles:e.payload});case"LOAD_INIT":var O=e.payload;return l({},t,{role:O.role,canSeeStats:O.canSeeStats,canEdit:O.canEdit});case"CHANGE_SIZE":var A=e.payload;return l({},t,{width:A.width,height:A.height});case"PREVIEW_UPLOADED":var C=e.payload;return l({},t,{previewWidth:C.width,previewHeight:C.height,previewHasLoaded:!0,hasReady:!0});case"ENDED":return t.hasRewind?t:l({},t,{status:"ended",videoStatus:"ended"});case"START":return l({},t,{status:"started"});case"VIDEO_LOADED":var R=e.payload,L=R.width,k=R.height,D=R.duration,x=R.fps,P=R.qualities,I=R.hasExternalEmbed,j=t.ranges,F=P.filter(function(e){return e.height===t.selectedQuality}).length?t.selectedQuality:null;return l({},t,{videoWidth:L,videoHeight:k,hasLoaded:!0,duration:j?j[1]-j[0]:D,framerate:x,fullDuration:D,currentTime:0,qualities:P,selectedQuality:F,hasExternalEmbed:I,hasReady:!0});case"CHANGE_BUFFER":return l({},t,{buffer:e.payload});case"CHANGE_REMAINING_TIME":var M=e.payload;t.ranges&&(M-=t.ranges[0]);return l({},t,{currentTime:M});case"END_REWIND":var N=h(t.saveStatus);t.duration===t.currentTime&&(N="ended");return l({},t,{hasRewind:!1,status:N});case"START_REWIND":return l({},t,{hasRewind:!0,saveStatus:t.status,status:"paused"});case"PAUSE":return l({},t,{status:"paused"});case"RESUME":case"PLAY":return l({},t,{status:"played"});case"REPLAY":return l({},t,{status:"replayed"});case"CHANGE_VISIBLE":return l({},t,{hasVisible:e.payload});case"CHANGE_HOVER":return l({},t,{hasHover:e.payload});case"MUTE":return l({},t,{volume:0});case"UNMUTE":return l({},t,{volume:1});case"SET_CURRENT_TIME":var U=e.payload,B=e.payload;t.ranges&&(U=(1e3*U+1e3*t.ranges[0])/1e3);return l({},t,{seekTime:U,lastSeekTimeModify:+new Date,currentTime:B});case"SET_FILTERS":return l({},t,{filters:e.payload});case"SET_CUT":var V=e.payload,G=V[1]-V[0],H=t.status;0===G&&(H="paused");return l({},t,{ranges:V,duration:G,status:H});case"UNBLOCK":var q=h(t.saveStatus)||t.status;return l({},t,{status:q});case"BLOCK":return l({},t,{saveStatus:t.status,status:"paused"});case"END_BUFFERED":return l({},t,{hasBuffered:!1});case"START_BUFFERED":return l({},t,{hasBuffered:!0});case"SET_VOLUME":var W=e.payload,Y=W.volume,z=W.options.force,K=Object(a.i)("vq-volume")||t.volumeForced;if(z){K=Y;Object(a.z)("vq-volume",Y)}return l({},t,{volume:Y,volumeForced:K});case"DISABLE_AUTOPLAY":var Q=t.status;"started"===Q&&(Q="paused");return l({},t,{disableAutoplay:!0,status:Q,hasReady:!0});case"CHANGE_BROWSER_TAB":var X=e.payload,Z=X.hidden,J=X.options.forcePause,$=!Z;if(J)return l({},t,{hasActiveTab:$});var tt=h(t.saveStatus)||"",et=t.saveStatus;if(Z&&t.status){et=t.status;tt=s.a.PAUSED}return l({},t,{hasActiveTab:$,status:tt,saveStatus:et});case"REQUEST_CLOSE_FULL_SCREEN":return l({},t,{hasRequestFullScreen:!1});case"REQUEST_FULL_SCREEN":return l({},t,{hasRequestFullScreen:!0});case"START_FULL_SCREEN":return l({},t,{hasFullScreen:!0});case"END_FULL_SCREEN":return l({},t,{hasFullScreen:!1,hasRequestFullScreen:!1});case"SHOW_SPLASH_PLAY":return l({},t,{isSplashPlaySeen:!0});case"HIDE_SPLASH_PLAY":return l({},t,{isSplashPlaySeen:!1});case"SHOW_SPLASH_PAUSE":return l({},t,{isSplashPauseSeen:!0});case"HIDE_SPLASH_PAUSE":return l({},t,{isSplashPauseSeen:!1});case"SHOW_SETTINGS_PANEL":return l({},t,{isSettingsPanelSeen:!0,isQualitySelectOpened:!1});case"HIDE_SETTINGS_PANEL":return l({},t,{isSettingsPanelSeen:!1,isQualitySelectOpened:!1});case"SHOW_QUALITY_SELECT":return l({},t,{isSettingsPanelSeen:!0,isQualitySelectOpened:!0});case"FAILED_LOAD_VIDEO":var rt=e.payload.url;return l({},t,{mediaFiles:t.mediaFiles.filter(function(t){return t.url!==rt})});case"CHANGE_VISIBLE_PERCENT":return l({},t,{visiblePercent:e.payload});case"START_FLY":return l({},t,{hasFly:!0,hasVisible:!0});case"END_FLY":return l({},t,{hasFly:!1});case"ADVERT_STARTED":return l({},t,{savedAdvertStatus:t.status});case"ADVERT_ENDED":var it=h(t.savedAdvertStatus)||t.status;return l({},t,{status:it});case"QUALITY_UPDATED":return l({},t,{activeQuality:e.payload});case"SELECT_QUALITY":return l({},t,{selectedQuality:e.payload});case"SUBTITLES_ENABLE":return l({},t,{isSubtitlesEnabled:!0});case"SUBTITLES_DISABLE":return l({},t,{isSubtitlesEnabled:!1});case"PLAYER_NEED_REQUESTED_VIDEO":return l({},t,{hasInitial:!0});case"CHANGE_AFTER_SCREEN":return l({},t,{hasAfterScreen:e.payload});case"START_SEEK_BUFFERED":return l({},t,{hasSeekBuffered:!0});case"END_SEEK_BUFFERED":return l({},t,{hasSeekBuffered:!1});case"DROPPED_NETWORK":return l({},t,{seekTime:t.currentTime});case"CHANGE_VIDEO_STATUS":var nt=e.payload,at=t.videoStatus;at="played"===nt?at?"played":"started":nt;return l({},t,{videoStatus:at});default:return t}}e.a=i;var n=r(42),a=r(4),o=r(2),s=r(25),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},c=Object(o.h)("viqeo-quality"),u=c&&"auto"!==c?Number(c):null,d={width:null,height:null,previewImage:"",role:null,previewWidth:null,previewHeight:null,videoWidth:null,videoHeight:null,status:"",videoStatus:"",hasVisible:!1,hasAfterScreen:!1,hasHover:!1,volume:0,volumeForced:Object(a.i)("vq-volume"),hasLoaded:!1,hasInitial:!1,previewHasLoaded:!1,duration:"",fullDuration:"",seekTime:null,lastSeekTimeModify:null,currentTime:0,buffer:null,ranges:null,filters:[],id:null,playerId:null,hasBuffered:!1,disableAutoplay:!1,hasActiveTab:!0,profileId:null,hasFullScreen:!1,hasRequestFullScreen:!1,isSplashPlaySeen:!1,isSplashPauseSeen:!1,isSettingsPanelSeen:!1,isQualitySelectOpened:!1,visiblePercent:0,hasFly:!1,mediaFiles:[],qualities:[],activeQuality:"",selectedQuality:u,isSubtitlesEnabled:!0,canSeeStats:!1,canEdit:!1,hasExternalEmbed:!1,hasReady:!1},h=function(t){return t===s.a.STARTED||t===s.a.REPLAYED?s.a.PLAYED:t}},587:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":var r=e.payload.language,i=t.language;r&&(i=r);return a({},t,{language:i});case"TRIGGER_EVENT":return a({},t,{event:e.payload});case"REPLAY":case"RESUME":case"START":return a({},t,{overlay:""});case"SHOW_OVERLAY":return a({},t,{overlay:e.payload});case"DISABLE_AUTOPLAY":return a({},t,{overlay:"start"});case"SET_LANGUAGE":return a({},t,{language:e.payload});case"TOGGLE_UNPUBLISHED_LABEL":return a({},t,{unpublishedLabelVisible:e.payload});case"ADV_LOG":return a({},t,{advLogs:[].concat(t.advLogs,[e.payload])});case"LOG":return a({},t,{logs:[].concat(t.logs,[e.payload])});case"DASH_LOG":return a({},t,{dashLogs:[].concat(t.dashLogs,[e.payload])});default:return t}}e.a=i;var n=r(4),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},o={language:Object(n.j)(),overlay:"",event:null,unpublishedLabelVisible:!1,logs:[],dashLogs:[],advLogs:[]}},588:function(t,e,r){"use strict";var i=r(42),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a={data:[],settings:{},url:""};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":var r=e.payload.data,o=r.vqSubtitles||{};return n({},t,{url:o.data,settings:o.settings,data:[]});case"LOAD_SUBTITLES":var s=Object(i.d)(e.payload);return n({},t,{data:s});case"UPDATE_SUBTITLES":var l=e.payload,c=l.dataXml,u=l.style,d=void 0;d=Array.isArray(c)?c:Object(i.c)(c).data;var h=u;u||(h=t.settings);return n({},t,{data:d,settings:h});default:return t}}},589:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1];switch(e.type){case"CHANGE_VISIBLE_PERCENT":var r=t.forcePlay,i=t.forcePause;if(!e.payload){i=!1;r=!1}return n({},t,{forcePlay:r,forcePause:i});case"LOAD_OPTIONS":return n({},t,e.payload);case"REPLAY":case"RESUME":case"START":case"PLAY":var o=e.payload.force,s=t.forcePause,l=t.forcePlay;if(o){s=!1;l=!0}return n({},t,{forcePause:s,forcePlay:l});case"PAUSE":var c=e.payload.force,u=t.forcePause,d=t.forcePlay;if(c){u=!0;d=!1}return n({},t,{forcePause:u,forcePlay:d});case"UNBLOCK":return n({},t,{disableVideoStart:!1},e.payload);case"BLOCK":return n({},t,{disableVideoStart:!0});case"START_OVERLAY_MODE":return n({},t,{hasOverlayMode:!0,disableAspect:!0,disableVideoStart:!0});case"END_OVERLAY_MODE":return n({},t,{hasOverlayMode:!1,disableAspect:!1,disableVideoStart:!0});default:return t}}e.a=i;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a={disableVideoStart:!1,disableAspect:!1,disableSound:!1,hasOverlayMode:!1,disableVideoFinished:!1,forcePause:!1,forcePlay:!1,disableVideoCors:!1,preload:!0,videoGalleryMode:!1,forceHideEditorControls:!1,disableEmbed:!1}},59:function(t,e,r){"use strict";function i(t){if(!Object(o.a)(t)||Object(n.a)(t)!=s)return!1;var e=Object(a.a)(t);if(null===e)return!0;var r=d.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&u.call(r)==h}var n=r(112),a=r(117),o=r(119),s="[object Object]",l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,h=u.call(Object);e.a=i},590:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1];switch(e.type){case"SET_TASK":return n({},t,e.payload,{timeUpdate:+new Date});default:return t}}e.a=i;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a={tag:"",status:"",progress:""}},591:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1];switch(e.type){case"SET_TASKS":return e.payload;default:return t}}e.a=i},592:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":return n({},t,{item:null,requestedForVideo:!1});case"RECOMMENDATION_LOADED":var r=e.payload.items,i=null;r&&r.length&&(i=r[0]);return n({},t,{item:i});case"START_LOAD_RECOMMENDATION":return n({},t,{requestedForVideo:!0,item:null});default:return t}}e.a=i;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a={requestedForVideo:!1,item:null}},593:function(t,e,r){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},n={dataUrl:"",format:"",needStart:!1,hasStart:!1};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=arguments[1];switch(e.type){case"API_INIT_ADVERT":return i({},t,e.payload);case"API_START_ADVERT":return i({},t,{needStart:!0});case"ADVERT_STARTED":return i({},t,{hasStart:!0});case"ADVERT_ENDED":return i({},t,{hasStart:!1});default:return t}}},594:function(t,e,r){"use strict";var i=r(42),n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a={src:"",tileWidth:0,tileHeight:0,width:0,height:0,widthCountTiles:0,heightCountTiles:0,maxCountTiles:0,currentX:0,currentY:0,hasLoadedImage:!1,hasMouseEnter:!1,hasRequestedImage:!1,currentTimePosition:0,hasVisible:!1};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":var r=e.payload.data.vqSprite,o=Object(i.f)(r),s=o.width/o.tileWidth,l=o.height/o.tileHeight;return n({},t,o,{src:r?r.url:"",widthCountTiles:s,heightCountTiles:l,maxCountTiles:s*l,hasRequestedImage:!1,hasLoadedImage:!1});case"SPRITE_LOAD":return n({},t,{hasRequestedImage:!0});case"SPRITE_LOADED":return n({},t,{hasLoadedImage:!0});case"START_REWIND":var c=e.payload.force,u=!0,d=!0;if(c){u=!1;d=!1}return n({},t,{hasRewind:u,hasVisible:d});case"TIME_LINE_MOUSE_ENTER":return n({},t,{hasMouseEnter:!0,hasVisible:!0,currentTimePosition:e.payload});case"END_REWIND":return n({},t,{hasRewind:!1,hasVisible:t.hasMouseEnter});case"TIME_LINE_MOUSE_LEAVE":return n({},t,{hasMouseEnter:!1,hasVisible:t.hasRewind});case"UPDATE_TIME_LINE_TIME":case"SET_CURRENT_TIME":return n({},t,{currentTimePosition:e.payload});default:return t}}},595:function(t,e,r){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},n={advert:!1,tracker:!1};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":return i({},t,e.payload.disable);default:return t}}},596:function(t,e,r){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},n={startCut:0};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":var r=e.payload.data.vqSubtitles||{},a=Number(r.cut&&r.cut.from);return i({},t,{startCut:a});case"SET_CUT":var o=e.payload,s=t.startCut;o&&o.length&&(s=1e3*o[0]);return i({},t,{startCut:s});default:return t}}},597:function(t,e,r){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},n={opened:!1,x:0,y:0};e.a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=arguments[1];switch(e.type){case"OPEN_CONTEXT_MENU":return i({},t,{opened:!0},e.payload);case"CLICKED_UI_ELEMENT":case"CLOSE_CONTEXT_MENU":return i({},t,{opened:!1});default:return t}}},598:function(t,e,r){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments[1];switch(e.type){case"INITIALIZED_PLAYER":return n({},t,o(e.payload.data.vqControls||[]));case"UPDATE_CONTROL":var r=e.payload,i=r.id,s=r.options;return"copyright"===i?n({},t,s):n({},t);case"UPDATE_VQ_CONTROLS":return n({},t,o(e.payload));default:return t}}e.a=i;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},a={},o=function(t){var e={},r=t.find(function(t){return"copyright"===t.control.id});r&&(e=r.control);return e}},599:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=r(13),a=r(12);e.a=function(){function t(e){var r=this;i(this,t);this.store=e;Object(a.a)(this,[{getValues:function(t){return{status:t.player.status}},onChange:this._changeStatus.bind(this)},{getValues:function(t){return{visiblePercent:t.player.visiblePercent}},onChange:this._changeVisible.bind(this)},{getValues:function(t){return{hasFly:t.player.hasFly}},onChange:this._changeFly.bind(this)},{getValues:function(t){var e=t.player;return{width:e.width,height:e.height}},onChange:this._changedSize.bind(this)},{getValues:function(t){return{id:t.player.id}},onChange:this._videoIdUpdated.bind(this)},{getValues:function(t){return{currentTime:t.player.currentTime}},onChange:this._currentTimeUpdated.bind(this)},{getValues:function(t){return{tasks:t.tasks}},onChange:this._changeTasks.bind(this)},{getValues:function(t){return{hasLoaded:t.player.hasLoaded}},onChange:function(){return r.store.dispatch(Object(n.h)("Tracker:videoLoaded"))}},{getValues:function(t){return{previewHasLoaded:t.player.previewHasLoaded}},onChange:function(){return r.store.dispatch(Object(n.h)("Tracker:previewLoaded"))}},{getValues:function(t){return{forcePause:t.options.forcePause}},onChange:function(){r.store.getState().options.forcePause&&r.store.dispatch(Object(n.h)("Tracker:forcePause"))}},{getValues:function(t){return{hasFullScreen:t.player.hasFullScreen}},onChange:function(){var t=r.store.getState();r.store.dispatch(t.player.hasFullScreen?Object(n.h)("Tracker:fullscreenStarted"):Object(n.h)("Tracker:fullscreenEnded"))}},{getValues:function(t){return{hasRequestFullScreen:t.player.hasRequestFullScreen}},onChange:function(){r.store.getState().player.hasRequestFullScreen&&r.store.dispatch(Object(n.h)("Tracker:requestFullscreen"))}},{getValues:function(t){return{hasReady:t.player.hasReady}},onChange:function(){r.store.getState().player.hasReady&&r.store.dispatch(Object(n.h)("Ready"))}},{getValues:function(t){return{videoStatus:t.player.videoStatus}},onChange:function(){var t=r.store.getState(),e=t.player.videoStatus,i=e.charAt(0).toUpperCase()+e.slice(1);e&&r.store.dispatch(Object(n.h)("Tracker:video"+i))}}],this.store)}t.prototype._changeTasks=function(){var t=this.store.getState(),e=t.tasks;this.store.dispatch(Object(n.h)("tasksUpdate",{tasks:e}))};t.prototype._changeStatus=function(){var t=this.store.getState(),e=t.player.status;this.store.dispatch(Object(n.h)("StatusUpdate",{status:e}));this.store.dispatch(Object(n.h)("Tracker:"+e))};t.prototype._changeVisible=function(){var t=this.store.getState(),e=t.player.visiblePercent;this.store.dispatch(Object(n.h)("Tracker:visibilityChanged",{visiblePercent:e}))};t.prototype._changeFly=function(){this.store.dispatch(this.store.getState().player.hasFly?Object(n.h)("Tracker:flyingStarted"):Object(n.h)("Tracker:flyingEnded"))};t.prototype._changedSize=function(){var t=this.store.getState(),e=t.player,r=e.width,i=e.height;r&&i&&this.store.dispatch(Object(n.h)("Tracker:changedSize",{width:r,height:i}))};t.prototype._videoIdUpdated=function(){this.store.dispatch(Object(n.h)("Tracker:slotIdUpdated"))};t.prototype._currentTimeUpdated=function(){this.store.dispatch(Object(n.h)("TimeUpdate"));this.store.dispatch(Object(n.h)("Tracker:currentTimeUpdated"))};return t}()},66:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.a=new function t(){i(this,t);this.VIDEO_ENDED="AdEnded";this.META_DATA_LOADED="AdLoaded";this.BUFFER_PROGRESS="AdBuffered";this.TIME_UPDATE="TimeUpdate";this.RESIZED="resize";this.ERROR_VIDEO_LOAD="FailedLoadVideo";this.EXIT_FULL_SCREEN="ExitFullScreen";this.QUALITY_UPDATED="QuilityUpdated";this.START_SEEK="Seek";this.END_SEEK="Seeked";this.DURATION_UPDATE="DurationUpdate"}},68:function(t,e,r){"use strict";function i(t,e,r){function s(){v===y&&(v=y.slice())}function l(){return g}function c(t){if("function"!=typeof t)throw new Error("Expected listener to be a function.");var e=!0;s();v.push(t);return function(){if(e){e=!1;s();var r=v.indexOf(t);v.splice(r,1)}}}function u(t){if(!Object(n.a)(t))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===t.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(m)throw new Error("Reducers may not dispatch actions.");try{m=!0;g=p(g,t)}finally{m=!1}for(var e=y=v,r=0;r<e.length;r++){(0,e[r])()}return t}function d(t){if("function"!=typeof t)throw new Error("Expected the nextReducer to be a function.");p=t;u({type:o.INIT})}function h(){var t,e=c;return t={subscribe:function(t){function r(){t.next&&t.next(l())}if("object"!=typeof t)throw new TypeError("Expected the observer to be an object.");r();return{unsubscribe:e(r)}}},t[a.a]=function(){return this},t}var f;if("function"==typeof e&&void 0===r){r=e;e=void 0}if(void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(i)(t,e)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var p=t,g=e,y=[],v=y,m=!1;u({type:o.INIT});return f={dispatch:u,subscribe:c,getState:l,replaceReducer:d},f[a.a]=h,f}r.d(e,"a",function(){return o});e.b=i;var n=r(59),a=r(120),o={INIT:"@@redux/INIT"}},69:function(t,e,r){"use strict";e.a=r(113).a.Symbol},7:function(t,e,r){"use strict";var i=r(4),n=r(44);e.a=(Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t})({},n.a,Object(i.i)("viqeo-config"))},70:function(t,e,r){"use strict"},71:function(t,e,r){"use strict";function i(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce(function(t,e){return function(){return t(e.apply(void 0,arguments))}})}e.a=i},76:function(t,e,r){"use strict";var i=r(2),n=r(50),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t};e.a=function(t,e,r,o){var s=Object(i.c)(e,"div",{width:"100%",height:"100%",position:"relative",cursor:"pointer",zIndex:100});r&&s.addEventListener("click",function(t){r(t)});var l={position:"absolute",top:0,left:0,width:"100%",height:"100%"},c=Object(i.c)(s,"div",a({},l,{zIndex:20}),t);Object(i.d)(c.firstElementChild,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});Object(n.a)(s,o);return s}},77:function(t,e,r){"use strict";e.a={EDITOR:"editor",USER:"user"}},8:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=r(2),a=r(5);e.a=function(){function t(e){i(this,t);this._options=e;var r=e.parent,n=e.store;this.container=document.createElement("div");this.options=e;this.parent=r;this.store=n;this.translateTable=[];this._eventsList=[];this.language=n.getState().application.language;this.updateUnsubscribe=this.store.subscribe(this.update.bind(this));this.languageUnsubscribe=this.store.subscribe(this.checkLanguage.bind(this));this.addEvent(window,"resize",this.resize.bind(this))}t.prototype.getContainer=function(){return this.container};t.prototype.loadDictionary=function(t){this.i18n=t};t.prototype.checkLanguage=function(){var t=this.store.getState(),e=t.application.language;if(this.language!==e){this.language=e;this.updateTranslate()}};t.prototype.updateTranslate=function(){var t=this;Object.keys(this.translateTable).forEach(function(e){t.translateTable[e].forEach(function(r){return t.changeTranslate(r,e)})})};t.prototype.changeTranslate=function(t,e){t.innerHTML=this.i18n[this.store.getState().application.language][e]};t.prototype.observeLanguage=function(t,e){this.translateTable[e]||(this.translateTable[e]=[]);this.translateTable[e].push(t);this.changeTranslate(t,e)};t.prototype.show=function(){this.container.style.display&&"none"!==this.container.style.display||Object(n.d)(this.container,{display:"block"})};t.prototype.hide=function(){this.container.style.display&&"block"!==this.container.style.display&&"inline-block"!==this.container.style.display||Object(n.d)(this.container,{display:"none"})};t.prototype.destroy=function(){this._eventsList.forEach(function(t){t.el.removeEventListener(t.name,t.callback)});this.updateUnsubscribe();this.languageUnsubscribe();Object(n.p)(this.container)};t.prototype.addEvent=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._eventsList.push({el:t,name:e,callback:r});t.addEventListener(e,function(t){r(t)},i)};t.prototype.addClickEvent=function(t,e){var r=this;this.addEvent(t,a.f?"touchend":"click",function(t){e(t);r.store.dispatch({type:"CLICKED_UI_ELEMENT"})})};t.prototype.update=function(){var t=this.store.getState(),e=t.player.hasExternalEmbed;this._options.hideInEmbed&&e&&this.hide()};t.prototype.render=function(){};t.prototype.resize=function(){};return t}()},83:function(t,e,r){"use strict";function i(t){return function(e){var r=e.dispatch,i=e.getState;return function(e){return function(n){return"function"==typeof n?n(r,i,t):e(n)}}}}var n=i();n.withExtraArgument=i;e.a=n},87:function(t,e,r){"use strict";r.d(e,"b",function(){return i});r.d(e,"c",function(){return n});r.d(e,"a",function(){return a});r.d(e,"d",function(){return o});var i=(r(5),function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}),n=function(t){["requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen"].forEach(function(e){t[e]&&t[e]()})},a=function(t){var e=[t.exitFullscreen,t.mozCancelFullScreen,t.webkitExitFullscreen,t.msExitFullscreen].find(Boolean);"function"==typeof e&&e.call(t)},o=function(t,e){["webkitfullscreenchange","fullscreenchange","MSFullscreenChange","mozfullscreenchange"].forEach(function(t){return document.addEventListener(t,e)})}},88:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" style="fill: white;">\n<path d="M8 5v14l11-7z"/>\n  <path d="M0 0h24v24H0z" fill="none"/>\n</svg>\n'},93:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(28);e.a=function(t){function e(r){i(this,e);var a=n(this,t.call(this,r));a._players=[];a.subscribeTracking(a._playerAdded.bind(a),"Player:added");a.subscribeTracking(a._checkConfig.bind(a),"ConfigUpdated");a.subscribeTracking(a.updateVisible.bind(a),"Player:changedSize");a.subscribeTracking(function(){a.updateVisible(a);setTimeout(function(){return a.updateVisible()},100)},"Player:videoLoaded");a.subscribeTracking(a.updateVisible.bind(a),"Player:forcePause");a.addEvent(window,"scroll",a.updateVisible.bind(a),!0);return a}a(e,t);e.prototype._checkConfig=function(t){t.options.amp&&this.destroy()};e.prototype._playerAdded=function(t){this._players.push({player:t.player});this.updateVisible()};e.getModuleDimensions=function(t){var e=t.slot,r=t.options.mark,i=window,n=t.hasReady()||!r?e:r,a=document.documentElement,o=i.offsetHeight||window.innerHeight,s=!isNaN(i.scrollTop)&&i.scrollTop||(window.pageYOffset||a.scrollTop)-(a.clientTop||0);return{viewportHeight:o,viewportTop:s,viewportBottom:s+o,moduleTop:n.getBoundingClientRect().top}};e.checkVisible=function(t){var r=t.store.getState(),i=r.player,n=i.height,a=i.hasVisible,o=i.hasFullScreen,s=i.hasFly;if(!n)return!1;var l=parseInt(n,10),c=e.getModuleDimensions(t),u=c.viewportTop,d=c.viewportBottom,h=c.moduleTop,f=Math.max(u,u+h),p=Math.min(d,f+h+l),g=Math.max(0,Math.min(l,p-f)),y=l&&g/l,v=a,m=window,b=m.innerHeight,E=n/b;if(E<=.5)y<=.9?v=!1:y>=.9&&(v=!0);else if(E>=1)y<=.5?v=!1:y>=.5&&(v=!0);else{var _=1.5-E;y<=_?v=!1:y>=_&&(v=!0)}(o||s)&&(v=!0);t.store.getState().player.visiblePercent!==y&&t.store.dispatch({type:"CHANGE_VISIBLE_PERCENT",payload:y});var S=t.store.getState(),T=S.player,w=T.hasAfterScreen,O=T.hasInitial,A=Math.abs(Math.abs(h)-n)>b;A!==w&&t.store.dispatch({type:"CHANGE_AFTER_SCREEN",payload:A});(!O&&v||!O&&Math.abs(h)<=2*b)&&t.store.dispatch({type:"PLAYER_NEED_REQUESTED_VIDEO"});t.store.dispatch({type:"SCROLLED"});return v};e.getActivePlayer=function(t){var e=function(t,e){var r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},r=[],i={x:0,y:window.innerHeight/2};t.forEach(function(t){var n=t.slot.getBoundingClientRect(),a=n.x,o=n.y,s=n.height,l={x:a,y:o},c={x:a,y:o+s};r.push(Math.min(e(l,i),e(c,i)))});return t[r.indexOf(Math.min.apply(Math,r))]};e.prototype.updateVisible=function(){var t=[],r=this._players.find(function(t){return"smartVisible"===t.player.getPlayback("videostart").type});this._players.forEach(function(i){var n=i.player,a=e.checkVisible(n),o=n.store.getState().options.forcePause;a&&r&&!o?t.push(n):n.setVisiblePercent(a)});if(1===t.length)t[0].setVisiblePercent(!0);else if(t.length>1){var i=e.getActivePlayer(t);i.setVisiblePercent(!0);t.forEach(function(t){t!==i&&t.setVisiblePercent(!1)})}};return e}(o.a)},94:function(t,e,r){"use strict";r.d(e,"b",function(){return s});r.d(e,"a",function(){return l});var i=r(51),n=r(7),a=r(4),o=n.a.baseUrl,s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"popular";return new Promise(function(n,s){Object(a.y)(Object(a.b)(o+"/profile/"+t+"/"+r,e),function(t){try{var e=JSON.parse(t.responseText),r=Object(i.a)(e);if(r){s(r);return}n(e)}catch(t){s("Failed to response recommendation: "+t)}},function(){s("Failed to response reccomendation")})})},l=function(t){return new Promise(function(e,r){Object(a.y)(o+"/data/"+t+"/metadata",function(t){try{var n=JSON.parse(t.responseText),a=Object(i.a)(n);if(a){r(a);return}e(n)}catch(t){r("Failed to response recommendation: "+t)}},function(){r("Failed to resonse getMetaData")})})}},95:function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}});e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var o=r(5),s=r(333),l=r(12);e.a=function(t){function e(){i(this,e);for(var r=arguments.length,a=Array(r),o=0;o<r;o++)a[o]=arguments[o];var s=n(this,t.call.apply(t,[this].concat(a)));Object(l.a)({},[{getValues:function(t){return{hasHover:t.player.hasHover,overlay:t.application.overlay,hasOverlayMode:t.options.hasOverlayMode}},onChange:s.updateHover.bind(s)}],s.store);return s}a(e,t);e.prototype.updateHover=function(){var t=this.store.getState(),e=t.player.hasHover,r=t.application.overlay,i=t.options.hasOverlayMode;this.applyStyle((e||o.f)&&!r||i)};return e}(s.a)}});