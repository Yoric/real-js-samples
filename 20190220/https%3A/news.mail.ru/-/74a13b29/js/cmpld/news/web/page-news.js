!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}("undefined"!=typeof self?self:this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/js/cmpld/",e(e.s=444)}({0:function(t,e,n){"use strict";function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new l(t)}function o(t,e){return void 0===e&&(e=[]),a?(n=Function.prototype.bind).call.apply(n,[console[t],console].concat(e)):function(){};var n}function s(t,e){if(a){console.groupCollapsed(i(t).str());for(var n=0,o=Object.keys(e);n<o.length;n++){var s=o[n];console.groupCollapsed(s),console.log.apply(console,e[s]),console.groupEnd()}console.groupEnd()}}function r(t){return(t>9?"":"0")+t}Object.defineProperty(e,"__esModule",{value:!0});var a=console&&console.groupCollapsed&&console.groupEnd&&console.log&&!1,l=function(){function t(t){var e=new Date;this.state={messages:t,prefix:"["+e.getHours()+":"+r(e.getMinutes())+":"+r(e.getSeconds())+"]",icon:"ü§ñ"}}return t.prototype.toArray=function(){var t=this.state;return[t.icon,t.prefix].concat(t.messages)},t.prototype.str=function(){return this.toArray().join(" ")},t.prototype.prefix=function(t){return this.state.prefix=t,this},t.prototype.log=function(){return this.state.icon="ü§ñ",this},t.prototype.info=function(){return this.state.icon="üíÅ‚Äç‚ôÇÔ∏è",this},t.prototype.error=function(){return this.state.icon="üí©",this},t.prototype.warn=function(){return this.state.icon="üò¢",this},t.prototype.icon=function(t){return this.state.icon=t,this},t}();e.FormatDescriptor=l,e.format=i,e.print={log:o("log",i().log().toArray()),info:o("info",i().info().toArray()),warn:o("warn",i().warn().toArray()),error:o("error",i().error().toArray()),groups:s}},1:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COMPONENT_DELIMITER=",",e.COMPONENT_EVENT_DELIMITER=":",e.COMPONENT_NS_DELIMITER=".",e.COMPONENT_EL_DELIMITER=".",e.COMPONENT_DATA_BIND_DEF_DELIMITER="|",e.COMPONENT_DATA_BIND_EQ="=",e.COMPONENT_DATA_BIND_PROP_DELIMITER=";"},167:function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(168)),i(n(185))},168:function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},s=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(r,a)}l((i=i.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(r=2&n[0]?s.return:n[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,n[1])).done)return r;switch(s=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,s=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){l.label=n[1];break}if(6===n[0]&&l.label<r[1]){l.label=r[1],r=n;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(n);break}r[2]&&l.ops.pop(),l.trys.pop();continue}n=e.call(t,l)}catch(t){n=[6,t],s=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,s,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},a=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},l=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,s=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r};Object.defineProperty(e,"__esModule",{value:!0});var c=n(19),u=n(169),h=n(48),p=n(171),d=n(174),f=n(30),m=n(59),_=n(177),g=n(179),v=n(180),y=n(184),P=n(30),w=n(60),b=n(61),T={sels:{answer:"js-survey__answer",answerInput:"js-survey__answer-input"},attrs:{exclude:"data-exclude",withInput:"data-with-input"}},L=-1,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._events={"submit:form":function(t){e.handleSubmit(t)},"click:button-reset":function(t){t.preventDefault(),e.reset()},"click:button-next":function(t){t.preventDefault();var n=e.getState(),i=n.currentIndex,s=n.survey,r=n.payload,a=i+1,l=s.questions[a];if(!l)return void e.vote(r);e.setState(function(t){return o({},t,{currentAnswer:null,currentIndex:a,currentQuestion:l,currentType:"question",hasUserInteractedWithSurvey:!0})})},"change:input":function(t){t.preventDefault();var n=T.attrs,i=t.target,o=i.getAttribute(n.exclude),s=i.getAttribute(n.withInput);if("checkbox"===i.type&&i.checked&&e.getElements("input").forEach(function(t){var e=t.getAttribute(n.exclude);(o&&!e||!o&&e)&&(t.checked=!1)}),s&&i.checked){var r=e.getElements("input-custom")[0];r&&r.focus()}},"click:input-custom":function(t){var e,n,i=T.sels,o=t.target,s=o.parentNode;if(null!==s){for(;"DIV"!==s.tagName||!s.classList.contains(i.answer);)s=s.parentNode;if(s){var r=s.getElementsByClassName(i.answerInput),l=Array.prototype.slice.call(r);try{for(var c=a(l),u=c.next();!u.done;u=c.next()){u.value.checked=!0}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}}o.focus()}}},e}return i(e,t),e.processDataBeforePost=function(t){return Object.keys(t).reduce(function(e,n){var i=t[n];if(Array.isArray(i)){var o=i.length;0!==o&&(e[n]=1===o?i[0]:i)}else(i||"number"==typeof i)&&(e[n]=i);return e},{})},e.prototype.handleQuizStepForm=function(t){var e=this.getState().survey,n=h.serializeObject(t),i=_.findAnswersIds(n),s=n.question[0],r=m.findItem(s,e.questions);if(r){if(0===Object.keys(i).length)return void this.setState(function(t){var e;return o({},t,{errors:(e={},e[s]=[f.errorRequired()],e),hasUserInteractedWithSurvey:!0})});var a=l(m.findItems(i,r.answers),1),c=a[0];if(c){var u=c.right?r.correct:r.incorrect;this.setState(function(t){return o({},t,{currentAnswer:u,currentType:"answer",errors:{},hasUserInteractedWithSurvey:!0,payload:o({},t.payload,_.packPayload(r,i))})})}}},e.prototype.handleSubmit=function(t){t.preventDefault&&t.preventDefault();var e=t.target,n=this.options.layout.type,i=this.type;if("step"!==n&&"sidebar"!==n||"poll"!==i&&"exam"!==i&&"survey"!==i){if("all"===n&&"poll"===i||"exam"===i||"survey"===i)throw new Error("not implemented");"quiz"===i&&this.handleQuizStepForm(e)}else this.handleSurveyStepForm(e)},e.prototype.handleSurveyStepForm=function(t){var e=this.getState(),n=e.currentIndex,i=e.payload,s=e.survey,r=s.questions,a=s.questionsById,l=h.serializeObject(t),c=l.question[0],u=a[c],p=_.findAnswersIds(l),f=(l.answer_custom||[]).filter(function(t){return t});if(u){var g=u.answers,v=u.options,y=!g||0===g.length,P=m.findItems(p,g),b=y?[]:d.validateAnswers(v,P,f);if(b.length)return void this.setState(function(t){var e,n;return o({},t,{errors:(e={},e[c]=b,e),formState:(n={},n[c]=_.saveQuestionState(p,f),n),hasUserInteractedWithSurvey:!0})});var T=o({},i,_.packPayload(u,p,f)),L=w.findNextQuestion(n,r,T);if(!L)return void this.vote(T);this.setState(function(t){return o({},t,{currentQuestion:L,currentIndex:m.itemIndex(L.id,r),errors:{},formState:{},hasUserInteractedWithSurvey:!0,payload:T})})}},Object.defineProperty(e.prototype,"type",{get:function(){var t=this.getState().survey;return t?t.type||"poll":"poll"},enumerable:!0,configurable:!0}),e.prototype.vote=function(t){return s(this,void 0,void 0,function(){var n,i,s,a;return r(this,function(r){switch(r.label){case 0:n=this.options.url,this.setState(function(e){return o({},e,{errors:{},formState:{},hasUserInteractedWithSurvey:!0,isBusy:!0,payload:t})}),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(n,{credentials:"include",method:"POST",body:JSON.stringify(e.processDataBeforePost(t)),headers:{Accept:"application/json, application/xml, text/plain, text/html, *.*","Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}})];case 2:return i=r.sent(),[4,i.json()];case 3:return s=r.sent(),this.setState(function(t){var e=t.survey;if(s.error)return o({},t,{currentState:"ready",errors:{server:[s.message]},isBusy:!1});if((e.max_votes||0)>0){var n=g.readVotesCount(e.id);g.saveVotesCount(e.id,n+1)}return o({},t,{currentQuestion:null,currentState:"done",errors:{},isBusy:!1,survey:s,voteAttempts:g.getVoteAttempts(e.id,e.max_votes||0)})}),[3,5];case 4:return a=r.sent(),this.setState(function(t){return o({},t,{currentState:"ready",isBusy:!1,errors:{server:[P.errorServer500()]}})}),[3,5];case 5:return[2]}})})},e.prototype.scrollUp=function(){var t=this.getElements("scroll-anchor")[0],e=this.options.style.offsetTop;if(t)return void p.scrollTo(t.offsetTop+e);var n=this.$;p.scrollTo(n.offsetTop+e)},e.prototype.fetchSurvey=function(){return s(this,void 0,void 0,function(){var t,e,n,i,s,a;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,7,,8]),t=this.options.url,[4,fetch(t,{credentials:"include"})];case 1:return e=r.sent(),[4,e.json()];case 2:n=r.sent(),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,v.getAuth()];case 4:return i=r.sent(),[3,6];case 5:return s=r.sent(),console.error(s),i=null,[3,6];case 6:return this.setState(function(t){if(n.error)return o({},t,{currentState:"error",errors:{server:[n.message]}});var e=t.layout,s=u.parse(n.stop_date.rfc3339)||0,r=s>new Date,a=g.getVoteAttempts(n.id,n.max_votes);y.preload(n);var l=n.questions;return n.questionsById=w.mapToDictById(l),o({},t,{layout:o({},e,{showCounter:"survey"!==n.type}),authorized:!!i,currentQuestion:l[t.currentIndex],currentState:_.resolveSurveyInitialStateByType(n.type,r,a),isActive:r,survey:n,type:n.type,voteAttempts:a})}),[2,n];case 7:return a=r.sent(),console.error(a),this.setState(function(t){return o({},t,{currentState:"error",errors:{server:[a.message]}})}),[3,8];case 8:return[2]}})})},e.prototype.render=function(e,n){var i=this,o=this.options.style.allowScrollUp;if(t.prototype.render.call(this,e,n),n&&("done"===n.currentState&&this.options.onFinish(n,this.$),-1===["error","loading"].indexOf(n.currentState))){o&&n.hasUserInteractedWithSurvey&&-1!==["done","step","ready"].indexOf(n.currentState)&&this.scrollUp();var s=n.currentQuestion;!s||s.id===L||s.answers&&0!==s.answers.length||(L=s.id,setTimeout(function(){var t=i.$elements.form;t&&t[0]&&(b.log("–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–±–º–∏—Ç –≤–æ–ø—Ä–æ—Å–∞"),i.handleSubmit({target:t[0]}))},50))}},e.prototype.reset=function(){t.prototype.reset.call(this),this.setState(function(t){return o({},t,{hasUserInteractedWithSurvey:!0})})},e.prototype.init=function(){this.fetchSurvey()},e.prototype.getDefaultOptions=function(){return{onFinish:function(t,e){},style:{offsetTop:0,allowScrollUp:!0},layout:{type:"step",allowRepeat:!0,showIndex:!1,showResultIndex:!0,showCounter:!0,showHeader:!0,showResults:!0}}},e.prototype.getInitialState=function(){return{layout:this.options.layout,authorized:!1,voteAttempts:0,currentIndex:0,currentState:"loading",currentType:"question",errors:{},formState:{},isBusy:!1,hasUserInteractedWithSurvey:!1,payload:{json:1},survey:{}}},e.registryName="SurveyComponent",e}(c.TemplateComponent);e.SurveyComponent=S,c.registerComponent(S)},169:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(170))},170:function(t,e,n){"use strict";function i(t,n,i){void 0===i&&(i=1);var o=e.DATE_METHOD_MAP[n],s=o[0],r=o[1],a=Date.prototype[s],l=Date.prototype[r],c=new Date(t.getTime()),u=a.call(c);return l.call(c,u+i),c}function o(t){var e=Date.parse(t);if(NaN!==e)return new Date(e);for(var n=0,i=h;n<i.length;n++){var o=i[n],s=o.expr,r=o.pass;if(s.test(t))return r(s,t)}}function s(t){return 32-new Date(t.getFullYear(),t.getMonth(),32).getDate()}function r(t){var e=t.getDay()-1;return e<0?6:e}function a(t){var e=t.getDay();return 6===e||0===e}function l(t,e){return void 0===e&&(e=new Date),e.getTime()>t.getTime()}function c(t){return t%4==0&&t%100!=0||t%400==0}function u(t,e){var n=t.getDate()===e.getDate(),i=t.getMonth()===e.getMonth();return t.getFullYear()===e.getFullYear()&&i&&n}Object.defineProperty(e,"__esModule",{value:!0}),e.DATE_METHOD_MAP={date:["getDate","setDate"],year:["getFullYear","setFullYear"],hours:["getHours","setHours"],milliseconds:["getMilliseconds","setMilliseconds"],minutes:["getMinutes","setMinutes"],month:["getMonth","setMonth"],seconds:["getSeconds","setSeconds"],time:["getTime","setTime"]},e.shift=i;var h=[{expr:/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})([+-]\d{2}):(\d{2})$/,pass:function(t,e){var n=t.exec(e);if(null!==n){var i=n.slice(1).map(function(t){return parseInt(t,10)}),o=i[0],s=i[1],r=i[2],a=i[3],l=i[4],c=i[5],u=i[6],h=i[7],p=(new Date).getTimezoneOffset()+60*u+h;return new Date(o,s-1,r,a,l-p,c)}}}];e.parse=o,e.daysInMonth=s,e.getDayOfWeek=r,e.isWeekend=a,e.isPast=l,e.isLeapYear=c,e.daysEq=u},171:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(172))},172:function(t,e,n){"use strict";function i(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n="easeOutSine");var i=o[n],a=window.scrollY,l=0;!function e(){l+=r;var n=l/.5,o=i(n);n<1?(s(e),window.scrollTo(0,a+(t-a)*o)):window.scrollTo(0,t)}()}Object.defineProperty(e,"__esModule",{value:!0});var o=n(173),s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},r=1/60;e.scrollTo=i},173:function(t,e,n){"use strict";function i(t){return function(e){return Math.pow(e,t)}}function o(t){return function(e){return 1-Math.abs(Math.pow(e-1,t))}}function s(t){var e=i(t),n=o(t);return function(t){return t<.5?e(2*t)/2:n(2*t-1)/2+.5}}function r(t){return Math.sin(t*l)}function a(t){return-.5*(Math.cos(Math.PI*t)-1)}Object.defineProperty(e,"__esModule",{value:!0});var l=Math.PI/2;e.linear=s(1),e.easeInQuad=i(2),e.easeOutQuad=o(2),e.easeInOutQuad=s(2),e.easeInCubic=i(3),e.easeOutCubic=o(3),e.easeInOutCubic=s(3),e.easeInQuart=i(4),e.easeOutQuart=o(4),e.easeInOutQuart=s(4),e.easeInQuint=i(5),e.easeOutQuint=o(5),e.easeInOutQuint=s(5),e.easeOutSine=r,e.easeInOutSine=a},174:function(t,e,n){"use strict";function i(t,e,n){if(!t)return[];var i=t.answer_required,r=t.min_answers,a=t.max_answers,l=t.user_input_min_length,c=t.user_input_max_length,u=e.length,h=r!==a;return[function(){return i&&h&&(u<r||u>a)?s.errorRange(r,a):null},function(){return i&&h&&u<r&&!a?s.errorAtLeastOne(r):null},function(){return i&&!h&&0===u?s.errorRequired():null},function(e){var r,a;try{for(var u=o(e),h=u.next();!h.done;h=u.next()){if(!h.value.id&&t.user_input_allowed){var p=n[0]||"";if(i&&0===p.length)return s.errorRequired();if(l>0){if(0===p.length||p.length<l)return s.errorMinLength(l);if(p.length>c)return s.errorMaxLength(c)}switch(t.user_input_allowed){case 1:var d=/(^[a-z–∞-—è\s]+$)/i;if(!d.test(p))return s.errorLettersOnly();break;case 2:var d=/(^[0-9]+$)/i;if(!d.test(p))return s.errorDigitsOnly()}}}}catch(t){r={error:t}}finally{try{h&&!h.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}return null}].reduce(function(t,n){var i=n(e);return null!==i?t.concat(i):t},[])}var o=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(30);e.validateAnswers=i},175:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(176))},176:function(t,e,n){"use strict";function i(t,e){var n=e[0],i=e[1],o=e[2],s=Math.abs(t);return(s%=100)>=5&&s<=20?o:(s%=10,1===s?n:s>=2&&s<=4?i:o)}function o(t,e,n){return void 0===e&&(e=140),void 0===n&&(n=""),t.length<e?t:""+t.slice(0,e-n.length)+n}function s(t){return t.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(t,e){return 0==+t?"":0===e?t.toLowerCase():t.toUpperCase()}).replace(/[\-\.]/g,"")}function r(t){return t.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(t,e){return 0==+t?"":t.toUpperCase()}).replace(/[\-\.]/g,"")}Object.defineProperty(e,"__esModule",{value:!0}),e.plural=i,e.trunc=o,e.toCamelCase=s,e.toPascalCase=r},177:function(t,e,n){"use strict";function i(t,e,n){var i,o={},s=t.id,r=t.options;return r&&r.answer_range?(i=Object.assign({},e),delete i[0]):i=Object.keys(e).filter(function(t){return"0"!==t}),i&&(o[c.createQuestionKey(s)]=i),n&&(o[c.createQuestionKey(s,!0)]=n),o}function o(t,e){var n={};return Object.keys(t).forEach(function(i){i&&(n[i]={checked:!0},"string"==typeof t[i]&&(n[i].value=t[i]),"0"===i&&(n[i].value=e[0]))}),n}function s(t,e,n){var i=e&&n>0?"ready":"done",o=n>0?"ready":"done";return"poll"===t?i:"exam"===t||"survey"===t||"quiz"===t?e?o:"hidden":i}function r(t){return void 0===t&&(t={}),Object.keys(t).reduce(function(e,n){return"answer"===n?Object.assign(e,a.mapToDict(t[n],!0)):0===n.indexOf(l.prefixRangeAnswer)&&(e[n.replace(l.prefixRangeAnswer,"")]=t[n][0]),e},{})}Object.defineProperty(e,"__esModule",{value:!0});var a=n(59),l=n(30),c=n(60);e.packPayload=i,e.saveQuestionState=o,e.resolveSurveyInitialStateByType=s,e.findAnswersIds=r},178:function(t,e,n){"use strict";function i(t,e){s.log("–ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å "+t.id+"...");var n=t.answers;if(!n||0===n.length)return s.log(">>> –≤–æ–ø—Ä–æ—Å –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤ (–≤–æ–ø—Ä–æ—Å-—Å—Å—ã–ª–∫–∞) ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å."),!0;if(c(n,e))return s.log(">>> –≤—Å–µ –æ—Ç–≤–µ—Ç—ã —Å–∫—Ä—ã—Ç—ã ‚Äî –ù–ï–õ–¨–ó–Ø –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å."),!1;if(!t.options)return s.log(">>> –Ω–µ—Ç —É—Å–ª–æ–≤–∏–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),!0;var i=t.options.show_condition;if(!i||!i.question)return s.log(">>> –Ω–µ—Ç —É—Å–ª–æ–≤–∏–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),!0;var r=i.question,a=o.createQuestionKey(r),u=e[a];return u?l.every(function(t){return t(i,u)}):(s.log(">>> –Ω–∞ –≤–æ–ø—Ä–æ—Å "+r+", —è–≤–ª—è—é—â–∏–π—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî","–ù–ï–õ–¨–ó–Ø –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),!1)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(60),s=n(61),r=function(t){return Array.isArray(t)?t.length:Object.keys(t).length},a=function(t,e){return!!e&&(Array.isArray(e)?-1!==e.indexOf(""+t):!!e[t]&&"0"!==e[t])},l=[function(t,e){var n=t.min_answers;if(!n)return!0;if(!e)return!1;var i=r(e),o=i>=(n||0);return s.log(">>> –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —á–∏—Å–ª–æ –æ—Ç–≤–µ—Ç–æ–≤ "+n+",","–ø–æ–ª—É—á–µ–Ω–æ "+i+" ‚Äî",(o?"–º–æ–∂–Ω–æ":"–ù–ï–õ–¨–ó–Ø")+" –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),o},function(t,e){if(!e)return!0;var n=t.max_answers;if(!n)return!0;var i=r(e),o=i<=(n||Number.POSITIVE_INFINITY);return s.log(">>> –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç–≤–µ—Ç–æ–≤ "+n+",","–ø–æ–ª—É—á–µ–Ω–æ "+i+" ‚Äî",(o?"–º–æ–∂–Ω–æ":"–ù–ï–õ–¨–ó–Ø")+" –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),o},function(t,e){if(!e)return!1;var n=t.checked_answer,i=!n||a(n,e);return s.log(">>> "+(i?"":"–Ω–µ ")+"–≤—ã–±—Ä–∞–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç —Å id "+n+" ‚Äî",(i?"–º–æ–∂–Ω–æ":"–ù–ï–õ–¨–ó–Ø")+" –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),i}],c=function(t,e){var n=0;return t.every(function(t){if(t.disable_multiple)return 0===n&&(n++,!0);var i=t.show_condition;if(!i)return!1;var s=i.checked_answer,r=i.question;return!(!s||!r)&&!a(s,e[o.createQuestionKey(r)])})};e.checkIfCanShowQuestion=i},179:function(t,e,n){"use strict";function i(t,e){var n=a(t);localStorage.setItem(n,""+e)}function o(t){var e=a(t),n=localStorage.getItem(e);if(!n)return 0;var i=parseInt(n,10);return isNaN(i)?0:i}function s(t,e){return 0===e?1:e-o(t)}function r(t,e){if(0===e)return!0;var n=o(t);return 0===n||!(n>=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){return"Survey:"+t};e.saveVotesCount=i,e.readVotesCount=o,e.getVoteAttempts=s,e.checkVotesCount=r},18:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},180:function(t,e,n){"use strict";function i(){return o(this,void 0,void 0,function(){return s(this,function(t){return null===a&&(a=r.getActiveUser()),[2,a]})})}var o=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(r,a)}l((i=i.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(r=2&n[0]?s.return:n[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,n[1])).done)return r;switch(s=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,s=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){l.label=n[1];break}if(6===n[0]&&l.label<r[1]){l.label=r[1],r=n;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(n);break}r[2]&&l.ops.pop(),l.trys.pop();continue}n=e.call(t,l)}catch(t){n=[6,t],s=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,s,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(181),a=null;e.getAuth=i},181:function(t,e,n){"use strict";function i(t){return p?Object(h.d)(t):Object(h.c)(t)}function o(){return p?Object(h.a)().then(function(t){var e=t.status,n=t.accounts;d=n||[],f=p.activeUser()||"",m=e||""}).catch(function(t){return t}):Object(h.b)().then(function(t){var e=t.status,n=t.data;d=n&&n.list?n.list:[],f=n&&n.email?n.email:"",m=e||""}).catch(function(t){return t})}function s(){return o().then(function(){return d}).catch(function(t){return t})}function r(){return s().then(function(t){return t.filter(function(t){return t.active})[0]})}function a(){return o().then(function(){return!!f&&!0}).catch(function(t){return t})}function l(){return o().then(function(){return m}).catch(function(t){return t})}function c(t){return o().then(function(){if("function"!=typeof t||!f)throw new TypeError("First argument must be a function or the user is not allowed.");t(f)}).catch(function(t){return t})}function u(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,o="function"==typeof t;return new Promise(function(s){c(function(r){r&&o?s(t()):e&&o?i(n):s(r)})})}Object.defineProperty(e,"__esModule",{value:!0}),e.getAccountsList=s,e.getActiveUser=r,e.isAuth=a,e.getStatus=l,e.onGetStatus=c,e.applyAuth=u;var h=n(182),p="undefined"!=typeof window?window.__PH:global.__PH,d=[],f="",m=""},182:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a}),n.d(e,"d",function(){return l}),n.d(e,"c",function(){return c});var i=n(183),o=n.n(i),s="undefined"!=typeof window?window.__PH:global.__PH,r=function(){var t="mail.ru"!==document.domain.split(".").slice(-2).join(".")?"https://portal.devmail.ru/NaviData":"https://portal.mail.ru/NaviData",e={data:{mac:1,ldata:1},timeout:3e3,jsonpCallback:"callback"};return o()(t,e).then(function(t){return t.json()})},a=function(){return new Promise(function(t,e){return s.loadAccountsList(function(n){return n?t(n):e()})})},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.authForm.show(t)},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.successPage?t.successPage:window.location;window.location="https://touch.mail.ru/cgi-bin/login?page=".concat(e)}},183:function(t,e,n){(function(t){!function(n,i){if("function"==typeof define&&define.amd)define(["exports","module"],i);else{i(e,t)}}(0,function(t,e){"use strict";function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function i(t){try{delete window[t]}catch(e){window[t]=void 0}}function o(t){var e=document.getElementById(t);e&&document.getElementsByTagName("head")[0].removeChild(e)}function s(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=t,a=e.timeout||r.timeout,l=e.jsonpCallback||r.jsonpCallback,c=void 0;return new Promise(function(r,u){var h=e.jsonpCallbackFunction||n(),p=l+"_"+h;window[h]=function(t){r({ok:!0,json:function(){return Promise.resolve(t)}}),c&&clearTimeout(c),o(p),i(h)},s+=-1===s.indexOf("?")?"?":"&";var d=document.createElement("script");d.setAttribute("src",""+s+l+"="+h),e.charset&&d.setAttribute("charset",e.charset),d.id=p,document.getElementsByTagName("head")[0].appendChild(d),c=setTimeout(function(){u(new Error("JSONP request to "+t+" timed out")),i(h),o(p),window[h]=function(){i(h)}},a),d.onerror=function(){u(new Error("JSONP request to "+t+" failed")),i(h),o(p),c&&clearTimeout(c)}})}var r={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};e.exports=s})}).call(e,n(18)(t))},184:function(t,e,n){"use strict";function i(t){return r(this,void 0,void 0,function(){return a(this,function(e){return[2,new Promise(function(e){var n=new Image;n.onload=function(){e()},n.src=t})]})})}function o(t){if(t&&t.img&&t.img.src)return t.img.src}function s(t){return r(this,void 0,void 0,function(){var e,n,s,r,c,u,h,p,d;return a(this,function(a){s=[],r=t.questions;try{for(c=l(r),u=c.next();!u.done;u=c.next())h=u.value,s=s.concat(o(h)||[]),"quiz"===t.type&&(p=h.correct,d=h.incorrect,s=s.concat(o(p)||[]),s=s.concat(o(d)||[]))}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(e)throw e.error}}return[2,Promise.all(s.map(i))]})})}var r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,s){function r(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(r,a)}l((i=i.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(r=2&n[0]?s.return:n[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,n[1])).done)return r;switch(s=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,s=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){l.label=n[1];break}if(6===n[0]&&l.label<r[1]){l.label=r[1],r=n;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(n);break}r[2]&&l.ops.pop(),l.trys.pop();continue}n=e.call(t,l)}catch(t){n=[6,t],s=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,s,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},l=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0}),e.preload=s},185:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version="3.2.4"},188:function(t,e,n){!function(t,e,n){"use strict";function i(){var e=this._elems,n=this._opts,i=n.attrs,o=n.cssClss,s=n.articleId,r=!1;Array.prototype.forEach.call(e.items,function(e,n){var a=t(e);a.attr(i.newsId)==s?(a.addClass(o.hidden),r=!0):r&&a.removeClass(2==n?o.hideLast:3==n?o.hidden:"")})}var o=n.Basic,s=o.getView,r=o.moduleOpts.setParams,a={cssSels:{Main:{items:".js-story-news__item"}},cssClss:{hidden:"hidden_all",hideLast:"hidden_small"},attrs:{articleId:"data-article-id",newsId:"data-news-id"},visibleCount:3};s(function(){return{_Init:function(){this._opts.articleId&&i.call(this)}}}(),a,null,"StorySection"),r("StorySection",{paramAttrs:{articleId:"data-article-id"}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},189:function(t,e,n){"use strict";var i=n(33),o=(n.n(i),n(34)),s=(n.n(o),n(92)),r=(n.n(s),n(190));n.n(r)},19:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(35);e.init=i.init;var o=n(7);e.setConfig=o.setConfig;var s=n(21);e.registerComponent=s.registerComponent;var r=n(20);e.initAllComponents=r.initAllComponents,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(42))},190:function(t,e){!function(t,e,n){"use strict";(0,n.Basic.moduleOpts.setParams)("Slider.EmbedList",{options:{_plugins:["EmbedList"],cssClss:{animatedControl:"control_animated"},embedTypesToWatch:["vk_post","facebook"]}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},199:function(t,e){!function(t,e,n){"use strict";var i=n.Tools,o=n.Mixins,s=i.applyAuthForce,r={cssSels:{count:".js-like__count",wrap:".js-like__cont",control:".js-like__control"},cssClss:{showCount:"like_count",control:{like:"like_liked",dislike:"like_disliked"},count:{positive:"like_positive",negative:"like_negative"}},urls:{like:null,dislike:null},attrs:{likeUrl:"data-like-url",dislikeUrl:"data-dislike-url",likeType:"data-like-type",likeId:"data-like-id",likeCount:"data-like-count"},transport:null,transportType:"POST",prefix:"+",prepareRequest:null,prepareResponse:null};n.Basic.Constructors.getView(function(){function e(t,e){var n=this._opts.cssClss;t.length&&e&&Object.keys(n.control).forEach(function(i){var o=n.control[i];t.toggleClass(o,o==e)})}function n(t,e){var n=this._opts,i=n.attrs;return n.urls.like&&n.urls.dislike&&e?n.urls:{like:t.attr(i.likeUrl),dislike:t.attr(i.dislikeUrl)}}function i(t){var e=this._opts,n=t.closest(e.cssSels.wrap);return n.length?n:this._elems.parent}function r(t){var e={};return t&&(e={like_id:t}),"function"==typeof this._opts.prepareRequest&&(e=this._opts.prepareRequest.call(this,e)),e}function a(t,e,n){var i=this._opts,o=i.cssClss,s=i.attrs,r=n.find(i.cssSels.count);if(isNaN(parseInt(t))){t=+n.attr(s.likeCount);var a=n.hasClass(o.control.like)?-2:n.hasClass(o.control.dislike)?2:0;t=a?t+a:"like"==e?++t:--t}void 0!==t&&r&&(r.text(t>0?(i.prefix||"")+t:t<0?t:""),n.toggleClass(o.showCount,0!==t).removeClass(o.count.positive).removeClass(o.count.negative).addClass(t>0?o.count.positive:t<0?o.count.negative:"").attr(s.likeCount,t))}function l(t){var o=this._opts,s=o.cssClss,l=o.attrs,c=i.call(this,t),u=t.attr(l.likeId)||c.attr(l.likeId),h=t.attr(l.likeType),p=c.hasClass(s.control.like)?"like":c.hasClass(s.control.dislike)?"dislike":null,d=o.transport||this.transport;if(h!=p){var f=n.call(this,t,u),m=r.call(this,u),_=s.control[h];d({type:o.transportType,url:f[h],data:m}).then(function(n){if(n.status){var i=n.data||{};"function"==typeof o.prepareResponse&&(i=o.prepareResponse.call(this,i,u)),a.call(this,null,h,c),e.call(this,c,_),this._trigger("vote",{type:h,info:i,target:t})}else this._trigger("error",n)}.bind(this))}}function c(e){e.preventDefault();var n=t(e.currentTarget);s(l.bind(this,n))}return{_mixins:[o.transport],_Events:["vote","error"],_Handlers:{dom:{"click:control":c}}}}(),r,null,"Likes")}(window.jQuery||window.$,window,window.ru.mail.cpf)},2:function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(36)),i(n(37))},20:function(t,e,n){"use strict";function i(t){var e=t.getAttribute(p.DOM_DATA_COMPONENT_STATE_ATTR)||"{}";try{return JSON.parse(e)||{}}catch(t){return d.print.warn('Unable to parse data "'+e+'"'),{}}}function o(t){var e=i(t);try{t.removeAttribute(p.DOM_DATA_COMPONENT_STATE_ATTR)}catch(t){d.print.warn('Unable to remove "'+p.DOM_DATA_COMPONENT_STATE_ATTR+'" attribute from node')}return e}function s(t){var e=/^([\w\.]+)\s+as\s+(\w+)$/gm,n=e.exec(t);return null!==n?{name:n[1].trim(),alias:n[2].trim()}:{name:t.trim(),alias:null}}function r(t,e){var n=s(e),i=n.name.split(h.COMPONENT_NS_DELIMITER),r=i[0],a=i.slice(1),l=f.getConfigCollapsed(n.name),p=u.getComponent(r);if(void 0===p)return d.print.warn("Component '"+r+"' was not found"),null;var m=o(t),_=m[r]||{},g=c.deepMerge({},l.initialState,_.state),v=c.deepMerge({},l.options,_.options);return new p(a.join(h.COMPONENT_NS_DELIMITER),v,g).mount(t).dispatch(n.alias||r)}function a(t){var e=t.getAttribute(p.DOM_DATA_COMPONENT_NAME_ATTR);if(!e)return[];for(var n=e.split(h.COMPONENT_DELIMITER),i=[],o=0,s=n;o<s.length;o++){var a=s[o],l=r(t,a);null!==l&&i.push(l)}return i}function l(t){if(!t)throw new Error("$root element not found");var e=t.querySelectorAll(p.DOM_DATA_COMPONENT_SEL),n=Array.prototype.slice.call(e);t.getAttribute(p.DOM_DATA_COMPONENT_NAME_ATTR)&&n.unshift(t);for(var i=[],o=0,s=n;o<s.length;o++){var r=s[o],l=a(r);i=i.concat(l)}return i}Object.defineProperty(e,"__esModule",{value:!0});var c=n(2),u=n(21),h=n(1),p=n(6),d=n(0),f=n(7);e.initComponents=a,e.initAllComponents=l},200:function(t,e){!function(t,e,n){"use strict";var i=n.Mixins,o=n.Basic,s=o.getModel,r=o.Extend,a=n.Tools.PubSub,l="ru.mail.news.comments.likes.",c=e.localStorage,u={keys:{infoLikes:l+"data",countLikes:l+"count"},urls:{currentUserLikes:null}};s(function(){function t(t,e){if(!t)return null;var n=c.getItem(t);return e?JSON.parse(n):n}function e(t,e,n){if(!t||!e)return null;c.setItem(t,n?JSON.stringify(e):e)}function n(n){var i=this._opts,o=i.urls.currentUserLikes,s=n.rating_cnt,r={};return new Promise(function(n,a){var l=t(i.keys.countLikes);s===+l?(r=t(i.keys.infoLikes,!0),n(r)):this.transport({url:o}).then(function(t){t.status&&(r=t.data,e(i.keys.infoLikes,t.data,!0),e(i.keys.countLikes,s),n(r))})}.bind(this))}function o(t){this._trigger("userInfo",t),n.call(this,t).then(function(t){this._trigger("update",t)}.bind(this))}return{_mixins:[i.transport],_Events:["update","userInfo"],_Handlers:{pubsub:{"comments.payment.status":function(t){t.data&&a.publish("comments.payment.get-user-data")},"comments.payment.user-data":function(t){o.call(this,t.data)}}},_Init:function(){this._state={}},addLike:function(n,i){if(n&&i){var o=this._opts,s=o.keys.infoLikes,r=o.keys.countLikes,a=t(s,!0)||{},l=t(r)||0;a[n]||(a[n]=[]),-1===a[n].indexOf(i)&&(a[n].push(i),e(s,a,!0),e(r,l+1))}},getLikes:function(){return t(this._opts.keys.infoLikes,!0)||{}},getState:function(){return r(!0,{},this._state)}}}(),u,null,"CommentsLikesModel")}(window.jQuery||window.$,window,window.ru.mail.cpf)},201:function(t,e,n){!function(t,e,n){"use strict";var i=n.Basic,o=i.getView,s=n.Tools.initModule,r={cssSels:{comment:".js-comments-likes",like:".js-like__cont"},cssClss:{userCommentHide:"comment__like_disabled",liked:"like_liked",processed:"comment__like_processed"},attrs:{author:"data-author-email",likeId:"data-like-id"},pageId:null,likesParam:{ext:"Comments",options:{urls:{like:null,dislike:null}}}};o(function(){function e(t){var e=this._opts,n=this._state,i=t.info||{};n.isInit&&"like"===t.type&&i.likeId&&this._model.addLike(e.pageId,+i.likeId)}function n(){var t=this._elems,n=this._opts,i=t.parent,o=n.likesParam;(this._Likes=s(["Likes",o.ext],i,o.options)).on("vote",e.bind(this))}function i(){var e=this._opts,n=this._state,i=e.attrs,o=e.cssSels,s=e.cssClss,r=this._model.getState(),a=this._elems.parent.find(o.comment),l=n.infoLikes,c=o.like.slice(1);[].forEach.call(a,function(e){var n=t(e);if(!n.hasClass(s.processed)){n.addClass(s.processed);var a=n.attr(i.author);if(r.email==a)return void n.addClass(s.userCommentHide);var u=n.hasClass(c)?n:n.find(o.like);if((u||{}).length){var h=u.attr(i.likeId);-1!==l.indexOf(+h)&&u.addClass(s.liked)}}})}function o(t){var e=this._opts,n=this._state;n.isInit&&(t=t||this._model.getLikes(),n.infoLikes=t[e.pageId]||[],i.call(this))}function r(t){o.call(this,t)}function a(){o.call(this)}return{_Handlers:{pubsub:{"comments.page.change":a},model:{update:r}},_Init:function(){var t=this._opts,e=this._state={isInit:!0};if(n.call(this),!t.pageId)return void(e.isInit=!1)}}}(),r,null,"CommentsLikesView"),i.moduleOpts.setParams("CommentsLikesView",{acceptTypes:"CommentsLikesModel"})}(window.jQuery||window.$,window,window.ru.mail.cpf)},202:function(t,e){!function(t,e){"use strict";function n(e){var n=e.error||{},i=n.err_msg,o=s("ct-popup-alert.xml");if(o&&i){var r=t(o({text:i}));this._alertPopup=new a(null,r),this._alertPopup.show()}}var i=e.Tools,o=e.Basic.moduleOpts.setParams,s=i.getTemplate,r=i.PubSub,a=e.Basic.Constructors._repo.get("Popup");o("Likes.Comments",{options:{_Handlers:{error:n},prepareResponse:function(t,e){return t=t||{},e&&(t.likeId=e),t},transport:function(t){return t.secure=!0,i.transport(t)}}}),o("CommentsLikesModel",{options:{_Handlers:{userInfo:function(t){var e=(t.user||{}).src||null;r.publish("avatar.update",e)}}}}),o("CommentsLikesView.Touch",{options:{cssClss:{userCommentHide:"comment_like_disabled",liked:"comment_like_liked",processed:"comment_like_processed"},likesParam:{ext:"Comments.Touch"}}}),o("Likes.Comments.Touch",{options:{prefix:!1,cssClss:{control:{like:"comment_like_liked"}}}})}(window.jQuery||window.$,window.ru.mail.cpf)},203:function(t,e,n){!function(t,e,n){"use strict";var i=e.localStorage||{},o=n.Basic,s=o.Extend,r=n.Tools.Auth,a=n.Tools.getTemplate,l={cssSels:{wrapper:".js-notice__wrapper",block:".js-notice",close:".js-notice__close"},cssClss:{show:"tooltip_shown"},storage:{root:"ru.mail.news.notice.comment",keys:{close:"lockTo",unique:"viewedTo",view:"viewed",list:"ids"}},timeouts:{lock:864e5,unique:864e5,hide:1e4,show:0},limits:{skip:1,views:2},autoHide:!0,canShowOnInit:null,template:a("ct-notifications-new-comment.xml")},c=o.getView(function(){function e(){var t=this._opts,e=this._state,n=t.storage,o=n.keys,s=e.storage={},r=i.getItem(n.root);r=r?JSON.parse(r):{},s[o.close]=r[o.close]||0,s[o.unique]=r[o.unique]||0,s[o.view]=r[o.view]||0,s[o.list]=r[o.list]||[]}function n(t,e){var n=this._opts,i=this._state,s=n.storage,r=n.timeouts,a=i.storage,l=s.keys[t];switch(t){case"close":e=i.timestamp+r.lock;break;case"unique":e=(new Date).getTime()+r.unique;break;case"view":e=void 0!==e?e:a[l]+1;break;case"list":e=void 0!==e?e:a[l].concat([i.id])}a[l]=e,o.call(this)}function o(){var t=this._state,e=this._opts.storage,n=t.storage;i.setItem(e.root,JSON.stringify(s(!0,{},n)))}function a(){var e=this._elems,n=this._opts,i=this._state,o=n.cssSels,s=n.template,r=i.data,a=t(s(r));(a||{}).length&&(e.block=a.is(o.block)?a:a.find(o.block),(e.block||{}).length||(e.block=a),a.appendTo((e.wrapper=t(o.wrapper)||{}).length?e.wrapper:document.body),a.on("click",o.close,p.bind(this)),i.rendered=!0)}function l(){var t=this._opts,e=this._state,n=t.timeouts,i=parseInt(n.show)||0,o=parseInt(n.hide)||0,s=h.bind(this,!0);e.rendered&&!e.started&&(i>0?setTimeout(s,i):s(),t.autoHide&&o&&(isNaN(parseInt(o))||setTimeout(h.bind(this,!1),o+i)),e.started=!0)}function c(){var t=this._opts,e=this._state,i=e.storage,o=t.storage.keys,s=e.timestamp,r=!1;return s<i[o.close]?r=!0:s<i[o.unique]?(n.call(this,"view",0),r=!0):i[o.list].indexOf(e.id)>-1?r=!0:i[o.view]>=t.limits.views&&(r=!0),r}function u(){var t=this._opts,e=this._state,n=e.storage,i=t.storage.keys,o=n[i.list].length,s=t.limits.skip;return!(0===s||o>1)||o%(1+s)==1}function h(t){var e=this._elems.block,n=this._opts.cssClss.show;(e||{}).length&&(e.toggleClass(n,t),this._trigger(t?"show":"hide"))}function p(t){t.preventDefault(),d.call(this)}function d(){h.call(this,!1),n.call(this,"close"),this._trigger("hide")}return{_Events:["show","hide","close"],_Init:function(t){if(t&&t.topicId){var i=this._opts,o=i.canShowOnInit,s=this._state={data:t,id:t.topicId,timestamp:(new Date).getTime()};if(e.call(this),c.call(this))return void(-1===s.storage[i.storage.keys.list].indexOf(s.id)&&n.call(this,"list"));"function"==typeof o&&o.call(this)||(n.call(this,"list"),u.call(this)&&r.onGetStatus(function(t){t!==s.data.author.email&&(a.call(this),n.call(this,"view"),s.storage[i.storage.keys.view]>=i.limits.views&&(n.call(this,"unique"),n.call(this,"list",[])),l.call(this))}.bind(this)))}}}}(),l,null,"Notice");s(!0,n,{Modules:{Notice:c}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},208:function(t,e,n){"use strict";var i=n(91);n.n(i)},21:function(t,e,n){"use strict";function i(t){return(t.toString().match(/function (\w*)/)||[])[1]}function o(t){var e=t.registryName;if(!e){var n=i(t);throw new Error(r.format('Static property "registryName" is not defined for component "'+n+'"').error().str())}if(e in a)throw new Error(r.format("Component with name '"+e+"' is already registered").error().str());r.print.log('Registering "'+e+'"'),a[e]=t}function s(t){return a[t]}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),a={};e.registerComponent=o,e.getComponent=s},22:function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(23),s={templatesExt:".xml.js",templatesPath:"/bem",templatesNS:"fest"},r=function(){function t(){this._store=new o.Store("MPF_GLOBAL",s,this.dispatchStore.bind(this)),this._store.dispatch()}return t.prototype.dispatchStore=function(){},t.prototype.getState=function(){return this._store.read()},t.prototype.update=function(t){this._store.put(function(e){return i({},e,t)}),this._store.dispatch()},t}();e.ApplicationSettings=r,e.applicationSettings=new r},23:function(t,e,n){"use strict";function i(t){for(var e={},n={},i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];"@"===s.charAt(0)?e[s]=t[s]:n[s]=t[s]}return{component:n,shared:e}}var o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),r=n(38),a=n(40),l=!1,c={},u=new r.Emitter,h=new a.DevToolsExtension,p=function(){function t(t,e,n){var r=this;this._id=t,this._events=[],this._EVENT_CHANGE="CHANGE:"+t,this._EVENT_INIT="INIT:"+t;var a=i(e).component;if(c[t])return void s.print.warn("'"+t+"' is already connected");this.bind(n),c[t]=a,u.emit(this._EVENT_INIT,c[t]),l&&(s.print.groups("Store ("+this._EVENT_INIT+")",{initial:[a]}),h.subscribe(this._id,function(t){var e=r.read(),n=JSON.parse(t.state)[r._id];u.emit(r._EVENT_CHANGE,n,e),c[r._id]=n}),h.send(this._EVENT_INIT,o({},c)))}return t.hasEntity=function(t){return t in c},t.prototype.destroy=function(){var t=this;this._events.forEach(function(e){u.removeListener(t._EVENT_CHANGE,e)}),l&&h.remove(this._id),delete c[this._id]},t.prototype.dispatch=function(){u.emit(this._EVENT_CHANGE,c[this._id])},t.prototype.put=function(t){var e=this.read(),n=t(this.read()),r=i(e).component,a=i(n).component,p=Object.keys(r),d=Object.keys(a);0===p.length&&0===d.length||(c[this._id]=a,u.emit(this._EVENT_CHANGE,a,e),l&&(s.print.groups("Store ("+this._EVENT_CHANGE+")",{prev:[e],next:[a]}),h.send(this._EVENT_CHANGE,o({},c))))},t.prototype.read=function(){var t=c[this._id];return o({},t)},t.prototype.bind=function(t){this._events.push(t),u.on(this._EVENT_CHANGE,t)},t}();e.Store=p},24:function(t,e,n){"use strict";function i(t){return"["+d.DOM_DATA_COMPONENT_EL_ATTR+'*="'+t+p.COMPONENT_EL_DELIMITER+'"]'}function o(t){return"["+d.DOM_DATA_COMPONENT_BIND_ATTR+'*="'+t+p.COMPONENT_DATA_BIND_DEF_DELIMITER+'"]'}function s(t){return function(t,e,n){}}function r(t,e,n){}var a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var l=n(43),c=n(44),u=n(25),h=n(0),p=n(1),d=n(6);e.DOMEvent=s,e.DOMBind=r;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._events={},e}return a(e,t),Object.defineProperty(e.prototype,"$",{get:function(){if(!this._$root)throw new Error(h.format('Component "'+this.identity+'" not mounted').error().str());return this._$root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"$elements",{get:function(){return this._collector.group(this.$,this.alias)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){null!==this._unbindEvents&&(this._unbindEvents(),this._unbindEvents=null),t.prototype.reset.call(this)},e.prototype.getElements=function(t){return this._collector.elements(this.$,t,this.alias)},e.prototype.mount=function(t){return this._$root||(this._$root=t),this},e.prototype.preDispatch=function(){var t=this;this._collector=new u.Collector(i(this.alias),d.DOM_DATA_COMPONENT_EL_ATTR);var e=c.eventsBinder(this.$,function(e){return t._collector.elements(t.$,e,t.alias)});this._unbindEvents=e(this._events),c.dataBinder(o(this.alias),d.DOM_DATA_COMPONENT_BIND_ATTR)(this,this._store.bind.bind(this._store),this.getState.bind(this))},e.prototype.postDispatch=function(){h.print.groups("Component ("+this.identity+")",{$:[this.$,this.$elements],options:[this.options],state:[this.getState()]})},e}(l.Component);e.DOMComponent=f},25:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=function(){function t(t,e){this.elSel=t,this.attrSel=e}return t.prototype.getName=function(t,e){var n=t.getAttribute(this.attrSel);return"string"==typeof n&&e?n.replace(""+e+i.COMPONENT_EL_DELIMITER,""):n},t.prototype.group=function(t,e){for(var n={},i=t.querySelectorAll(this.elSel),o=Array.prototype.slice.call(i),s=0,r=o;s<r.length;s++){var a=r[s],l=this.getName(a,e);null!==l&&(n[l]||(n[l]=[]),n[l]=n[l].concat(a))}return n},t.prototype.elements=function(t,e,n){var i=this,o=t.querySelectorAll(this.elSel);return Array.prototype.slice.call(o).filter(function(t){return i.getName(t,n)===e})},t}();e.Collector=o},26:function(t,e,n){"use strict";function i(t){var e,n=t.nodeName.toLowerCase(),i=a[n];return i&&void 0!==(e=i.getVal(t))?e:(e=t.value,"string"==typeof e?e.replace(/\r/g,""):null===e?void 0:e)}function o(t){throw new Error("to be done")}Object.defineProperty(e,"__esModule",{value:!0});var s=n(51),r=n(27),a={option:{getVal:function(t){var e=t.getAttribute("value");return null!==e?e:r.stripAndCollapse(r.getText(t))}},select:{getVal:function(t){for(var e=[],n=t.selectedIndex,o="select-one"===t.type,r=o?n+1:t.options.length,a=n<0?r:o?n:0;a<r;a++){var l=t.options[a],c=l.selected||a===n,u=l.disabled,h=l.parentNode,p=h.disabled,d=s.isNodeName(h,"optgroup");if(c&&!u&&(!p||!d)){var f=i(l);if(o)return f;e.push(f)}}return e},setVal:function(t,e){for(var n,i=[e],o=t.options.length;o--;){var s=t.options[o];(s.selected=-1!==i.indexOf(a.option.getVal(s)))&&(n=!0)}return n||(t.selectedIndex=-1),i}}};e.getValue=i,e.setValue=o},27:function(t,e,n){"use strict";function i(t){var e,n=t.nodeType,o="",s=0;if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)o+=i(t)}else if(3===n||4===n)return t.nodeValue}else for(;e=t[s++];)o+=i(e);return o}function o(t){return(t.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")}Object.defineProperty(e,"__esModule",{value:!0}),e.getText=i,e.stripAndCollapse=o},294:function(t,e,n){"use strict";var i=n(69);n.n(i)},295:function(t,e,n){"use strict";var i=n(296),o=(n.n(i),n(297)),s=(n.n(o),n(298)),r=(n.n(s),n(299)),a=(n.n(r),n(199)),l=(n.n(a),n(200)),c=(n.n(l),n(201)),u=(n.n(c),n(202)),h=(n.n(u),n(300)),p=(n.n(h),n(301)),d=(n.n(p),n(302));n.n(d);window.ru.mail.asyncTemplates.prefetch("/bem/news/web/web.bundles/ct-comment/ct-comment.xml.js")},296:function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e,i,o){"use strict";var s=i.Basic,r=s.typeOf,a=s.Extend,l=i.Tools,c=i.Comp.jQuery,u=l.Auth,h=c.Elems.jWindow,p=o&&o.csstransforms&&o.csstransitions;if(p)var d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"}[o.prefixed("transition")];var f=s.getConstructor(function(){function o(){var n=this,o=this._Elems,a=this._Opts,c=a.cssSels,u=c.Main,p=a.cssClss,d=this._Model,f=this._State,_=p.sending,g=o.jSubmit;d.bind("formrequest",P.bind(this)),d.bind("errorsend",function(){g.removeClass(_)}),d.bind("beforegetpage",function(t){t.isNext||o.jWanderForm.detach()}),d.bind("commentpost",function(){o.jSubmit.removeClass(_),o.jParent.find(u.textarea).val("").trigger("change"),o.jWanderForm.detach()}),a.handleScroll&&(d.bind("pageresize",function(t){var e=t.message;e&&!1===e.pagerFixationChanged||(f.wrapHeight=o.jWrap.outerHeight(),f.bFixForm=!0,v.call(n))}),d.bind("scrollchange",function(t){var e=t.scrollExcessBottom||0;f.scrollLimitTop=t.scrollLimitTop||0,f.scrollExcessBottom!=e&&(f.scrollExcessBottom=e,o.jFixedForm.css("bottom",e))}),i.Comp.jQuery.Tools.winHndlrs.attach(function(t,e,i){var s,r,l,c=o.jParent,u=!1;"resize"==i&&(l=c.offset(),r=o.jWrap,f.wrapWidth=c.parent().width(),f.wrapHeight=r.outerHeight(),f.wrapTop=r.offset().top,f.formLeft=l.left,u=!0),a.handleScroll&&!f.isFixed&&(s=(l||c.offset()).top-t.top-f.scrollLimitTop,d.reportEvent("scrollchange",{scrollExcessTop:s>0?0:s})),v.call(n,t,e,u)}),(h||t(e)).on("load",m.bind(n)),o.jFixedForm.on("mouseup",m.bind(n))),g.on("click",function(e){e.preventDefault();var n=this._Opts.cssSels,i=t(e.currentTarget),o=i.parents(n.form),l=a.beforeSubmit;i.hasClass(_)||Promise.resolve(r(l,"function")?l.call(this,o):null).then(function(t){if(!1!==t){var e=o.find(u.textarea),n=e.val(),r=n.length;r>=a.minLength?(i.addClass(_),a.showInlineError&&(o.removeClass(a.cssClss.formError),this._getElement("errorTextEmpty").hide()),r>a.maxLength&&e.val(n.substr(0,a.maxLength)),d.postComment(s(o))):a.showInlineError?(o.addClass(a.cssClss.formError),this._getElement("errorTextEmpty").show()):d.reportError(a.errorEmptyComment)}}.bind(this))}.bind(this)),o.jParent.on("click",c.authLink,function(t){var n,i=this.getAttribute("data-"+a.redirectDataAttr);i&&(n={returnPage:i,failPage:e.location.href}),l.jQuery.showLoginPopup(n||{}),t.preventDefault()}).on("click",c.rulesLink,function(e){var i=a.handleRulesLink;i?i.call(n,e,"form"):(e.preventDefault(),t(c.rulesPopup).Popup(null,"Show"))}),o.jTextarea.on("keydown",function(e){(e.ctrlKey||e.metaKey)&&13==e.which&&t(this).parents(c.form).find(c.Main.submit).trigger("click")});var w=o.jFixedForm.find(u.textarea);if(p.formShort){var b=y.bind(this,n);w.on("keyup change",function(){var e;return function(){var n=!t.trim(w.val());n!=e&&(e=n,b())}}())}}function s(t){var e={};return t.find(":input").each(function(t,n){n.name&&(e[n.name]=n.value)}),e}function m(){var t=this._State,n=this._Elems,i=n.jFixedForm.height();t.formHeight=i,this._Model.reportEvent("scrollchange",{scrollLimitBottom:i}),t.isFixed&&(n.jWrap[0].style[this._Opts.parentSizeProp]=i+"px");var o=document.createEvent("HTMLEvents");o.initEvent("resize",!0,!0),e.dispatchEvent(o)}function _(){return{width:h.width(),height:h.height()}}function g(){return{top:h.scrollTop(),left:h.scrollLeft()}}function v(t,e,n){n=n||!1;var i,o,s,r,a=this._State,l=this._Elems,c=this._Opts,u=l.jFixedForm,h=u.data("width"),p=a.formLeft;a.bFixForm&&(t||(t=g()),e||(e=_()),r=t.left,i=e.width,o=t.top<=a.wrapHeight+a.wrapTop-e.height+c.scrollCorrection,s=o?a.wrapWidth:"100%",s!=h&&(u.width(s).data("width",s),a.formHeight=u.height()),(a.isFixed!=o||n)&&(a.isFixed=o,a.winScrollLeft=r,u.toggleClass(c.cssClss.formFixed,o),u.css("left",o?p-r:0),l.jWrap[0].style[c.parentSizeProp]=o?a.formHeight+"px":0),a.winScrollLeft==r&&a.winWidth==i||(a.winScrollLeft=r,a.winWidth=i,u.css("left",o?p-r:0)))}function y(){var e=this._Opts.cssClss,n=e.Avatar,i=this._Opts.cssSels,o=this._Elems.jFixedForm,s=o.find(i.Main.textarea),r=o.find(i.Main.avatar),a=t.trim(s.val()),l=!a;e.formShort&&(o.toggleClass(e.formShort,l),p?o.one(d,m.bind(this)):m.call(this),l?r.removeClass(n.large).addClass(n.small):r.removeClass(n.small).addClass(n.large))}function P(t){var e=this._Opts,n=e.cssSels,i=e.beforeAddForm,o=e.afterAddForm;Promise.resolve(!r(i,"function")||i.call(this)).then(function(i){if(i){var s=this._Elems.jWanderForm,a=s.find(n.Main.textarea).val("").trigger("change");s.find(n.commentId).val(t.commentId),s.find(n.form).removeClass(e.cssClss.formError),t.formWrap.append(s),r(o,"function")&&o.call(this),setTimeout(function(){a.focus()},100),this._Model.reportEvent("addform",{activeComment:t.comment})}}.bind(this))}function w(t){function e(t){i.css({"background-image":"url("+t+")"})}var i=this._Elems.jAvatar,o=this._Opts.handleAvatarUrl,s="//cp-filin.mail.ru/pic?"+encodeURI("width=90&height=90&email="+t);if(t&&i&&i.length)if("function"==typeof o){var r=o.call(this,t);void 0===r||null===r?e(s):"string"==typeof r?e(r):"object"===n(r)&&("then"in r?r.then(function(t){e("string"==typeof t?t:s)}):e(s))}else e(s)}var b=c.Tools.getElements,T={cssSels:{Main:{fixedForm:".js-comments_form_fixed",wanderForm:".js-comments_form_wander",submit:".js-comments_form_submit",textarea:".js-comments_form_text",avatar:".js-avatar"},form:".js-comments_form",commentId:".js-comment_id",wrap:".js-comments",authLink:".js-comments_auth",rulesLink:".js-comments_rules",rulesPopup:"#box-notice",errorTextEmpty:".js-error-text_empty"},cssClss:{sending:"",formFixed:"",formShort:"",formError:"comment-form_error",Avatar:{small:"avatar_size_45",large:"avatar_size_90"}},redirectDataAttr:"redirect",parentSizeProp:"paddingBottom",minLength:2,maxLength:5e3,errorEmptyComment:"emptyComment",handleScroll:!0,scrollCorrection:0,beforeSubmit:null,beforeAddForm:null,afterAddForm:null,handleRulesLink:null};return{_Init:function(t,e,n){var i,s,r,l,c,h=t.data("_commentForm"),p=w.bind(this);if(h instanceof f)return h;t.data("_commentForm",this),this._Model=e,this._Opts=i=a(!0,{},T,n),this._Elems=s=b(i.cssSels.Main,t,{jParent:t,jWrap:t.find(i.cssSels.wrap).add(t.closest(i.cssSels.wrap)).eq(0)}),c=e.getState(),r=s.jWrap,this._State={bFixForm:!!i.commentsCount,wrapTop:r.offset().top,wrapHeight:r.outerHeight(),wrapWidth:t.parent().width(),formLeft:t.offset().left,formHeight:s.jFixedForm.height(),scrollLimitTop:c.scrollLimitTop||0,scrollExcessBottom:0},u.onGetStatus(p),u.on("authChange",p),o.call(this),y.call(this),!0===c.reply&&(l=s.jFixedForm.find(i.cssSels.Main.textarea),setTimeout(function(){l.focus()},500))}}}());t.fn.commentForm=function(e,n){return this.each(function(){new f(t(this),e,n)})},e.getNameSpace("Comp.jQuery.Comments",i).commentForm=f}(window.jQuery,window,window.ru.mail.cpf,window.Modernizr)},297:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o=i.Extend,s=i.typeOf,r=n.Tools,a=r.Auth,l=n.Comp.jQuery,c=l.Elems,u=r.jQuery.showLoginPopup,h=i.getConstructor(function(){function n(t){return t instanceof e.jQuery?t.is(":visible"):!(0===t.offsetWidth&&0===t.offsetHeight)}function i(){var e=this,i=this._Opts,o=this._Elems,r=o.jParent,a=o.jContainer,c=o.jLoading,h=this._Model,_=this._State,g=i.cssSels,v=i.cssClss,y=i.scrollBottom,P=g.comment,w=i.prepareComments;h.bind("getpage",m.bind(e)),h.bind("addform",function(n){var i=n.activeComment;i.addClass(v.showForm),d.call(e,i,!0),_.replyTo&&(_.replyTo=!1,t(p.bind(e,i))),e._Model.reportEvent("pageresize")}),c&&c.length&&h.bind("load",function(t){c.toggle(t)}),i.handleScroll&&(h.bind("statechange",function(t){var n=t.winHeightDelta;isNaN(n)||(e._State.winHeightDelta=n)}),h.bind("scrollchange",function(t){var e=t.scrollLimitBottom||0;_.scrollLimitBottom!=e&&(_.scrollLimitBottom=e)}),l.Tools.winHndlrs.attach(function(t,i,s){var l,c,u,p,d,f=t.top,m=e._Pages,v=m.length;if(n(a))if("scroll"==s){for(u=0;u<v&&null!==(l=m[u]);u++){if(c=l.data(),0===u&&(p=parseInt(c.page,10)),!(c.top<=f)){u==v-1&&f>_.top+_.height-i.height&&(p=parseInt(c.page,10));break}p=parseInt(c.page,10)}_.currentPage!=p&&(_.currentPage=p,h.reportEvent("pagechange",{currentPage:p})),!e._isPageRequested&&f>_.top+_.height-i.height-y&&(e._isPageRequested=!0,h.getNextPage(r.find(g.comment).last().data("id")))}else if(e._isPageRequested=!1,d=_.winHeightDelta||0,_.top=o.jContainer.offset().top,l)for(u=0;u<v;u++)l=m[u],l.data("top",l.offset().top-d)})),i.useNewApi&&h.bind("commentpost",function(n){var r,a=n.comment,l=e._State,c=i.prepareComments,u=i.commentTemplate;a&&(l.newComment=a.id),i.appendNewComment&&a?Promise.resolve(u).then(function(){r=t(u(a)),s(c,"function")&&c.call(e,r),i.insertToBegin?o.jContainer.prepend(r):o.jContainer.append(r),p.call(e,a.id)}):n.page&&h.getPage(n.page)}),r.on("click",g.replyBtn,function(e){e.preventDefault();var n=t(this),i=n.parents(P).eq(0);_.user?h.getForm({commentId:i.data("id"),formWrap:i.find(g.formContainer).last(),comment:i}):u({returnPage:n.attr("href")})}).on("click",g.parent,function(n){n.preventDefault(),d.call(e,f.call(e,t(this).parents(P),v.showParent))}).on("click",g.history,function(n){n.preventDefault();var o=t(this),r=o.parents(P),a=r.find(g.historyCont),l=o.data("threadLoaded"),c=v.showHistory;l?(f.call(e,r,c,!a.is(":visible")),d.call(e,r)):h.getHistory(r.data("id"),function(t){o.data("threadLoaded",!0),a.html(t);var n=a.find(g.comment).data("included",!0);s(w,"function")&&w.call(e,n),f.call(e,r,c,!0),d.call(e,r,!0)},i.commentTemplate)}).on("click",g.showMore,function(e){e.preventDefault(),t(this).parents(g.comment).addClass(v.showMore)}).on("click",g.rulesLink,function(n){var o=i.handleRulesLink;o?o.call(e,n,"list"):(n.preventDefault(),t(g.rulesPopup).Popup(null,"Show"))})}function r(t){return this._Elems.jContainer.find("#"+this._Opts.commentIdPrefix+t)}function p(t,e){isNaN(t)||(t=r.call(this,t)),t.length&&(!0===e&&d.call(this,t,e),this._Elems.jScrollBlock.animate({scrollTop:t.offset().top+this._Opts.scrollDeltaTop-(this._State.winHeightDelta||0)}))}function d(e,n){var i,o,r,a,l,u,h,p=this._Opts,d=this._Elems,f=p.cssClss,m=p.cssSels,_=f.active,g=f.showForm,v=e.data("included"),y=v?g:_+" "+g+" "+f.showHistory+" "+f.showParent,P=!1;s(n,"undefined")?e.find(m.parentCont+","+m.historyCont+",form").each(function(){if(t(this).is(":visible"))return P=!0,!1}):P=n,P&&d.jContainer.find("."+_+", ."+g).not(e).removeClass(y),v||e.toggleClass(_,P),P&&(a=c.jWindow,l=a.scrollTop(),i=e.offset().top,o=i+p.scrollDeltaTop,r=l+a.height()-this._State.scrollLimitBottom,u=e.outerHeight(),i+u>r&&(h=!0,a.scrollTop(l-r+i+u)),o<(h?a.scrollTop():l)&&a.scrollTop(o)),p.handleScroll&&this._Model.reportEvent("pageresize",{pageHeight:d.jParent.outerHeight()})}function f(t,e,n){var i=this._Opts.cssClss,o=i.showParent;return t.toggleClass(e,n).removeClass(e==o?i.showHistory:o)}function m(e){var n,i,o,r,a,l,u=this._Elems,h=this._Opts,p=u.jContainer,d=u.jCommentsCount,f=e.commentsList,m=u.jPagesContainer,_=u.jParent,g=c.jWindow,v=e.reply,y=u.jScrollBlock,P=h.prepareComments,w=h.commentTemplate;return!v&&this._State.newComment&&(v=this._State.newComment,delete this._State.newComment),e.topicId&&(this._State.topicId=e.topicId),Promise.resolve(w).then(function(){if(s(w,"function")&&(f=f.map(w)),a=t(t.trim(f.join(""))),l=a.eq(0).data("page",e.currentPage),s(P,"function")&&P.call(this,a),e.isNext)p.append(a),this._Pages.push(l.data("top",l.offset().top));else{p.empty().append(a),this._Pages=[l.data("top",l.offset().top)];var c=a.filter("[data-id="+v+"]");n=c.length?c.offset().top+c.outerHeight()-g.height()+h.scrollCorrectBottom:e.isLast||v?_.offset().top+_.outerHeight()-g.height()+h.scrollCorrectBottom:u.jPagesContainer.offset().top+h.scrollCorrectTop-(this._State.winHeightDelta||0),y.animate({scrollTop:n})}m.data("visible")||(m.data("visible",!0).show(),this._Model.reportEvent("pagechange",e)),v&&(o=h.cssClss.active,i=a.filter("#"+h.commentIdPrefix+v).addClass(o),setTimeout(function(){i.removeClass(o)},h.newCommentActiveTime)),h.handleScroll&&(this._Model.reportEvent("pageresize",{pageHeight:_.outerHeight(!0)}),g.trigger("scroll")),d&&(r=e.commentsCount,d.text(r),0===h.commentsCount&&(h.commentsCount=r,d.parents(h.cssSels.commentsCountWrap).show())),this._isPageRequested=!1,this._State.height=p.height()}.bind(this))}function _(n){var i,o=this._Opts,s=this._State,a=this._Model,l=s.replyToId;s.user=n,n?(this._Elems.jParent.addClass(o.cssClss.authorized),isNaN(l)||(s.replyToId=null,i=r.call(this,l),i.length&&(s.replyTo=!0,a.getForm({commentId:l,formWrap:i.find(o.cssSels.formContainer),comment:i})))):t(function(){if(l){s.replyToId=null;var t=e.location,n=a._Opts.urlParams,i=isNaN(l)?n.addComment:n.replyToComment+l,o=t.pathname+t.search+"#"+i;u({returnPage:o})}})}var g={cssSels:{Main:{container:".js-comments_list",commentsCount:".js-comments-cnt",pagesContainer:".js-comments_pages",loading:".js-comments_loading"},commentsCountWrap:".js-comments_cnt_wrp",comment:".js-comments_comment",history:".js-comments_history",parent:".js-comments_parent",historyCont:".js-comments_history_cont",parentCont:".js-comments_parent_cont",replyBtn:".js-comments_reply",formContainer:".js-comments_form_cont",rulesLink:".js-comments_rules",rulesPopup:"#box-notice",showMore:".js-comments_toggle"},cssClss:{loading:"",active:"",showHistory:"",showParent:"",showForm:"",authorized:"",showMore:""},prepareComments:null,newCommentActiveTime:3e3,commentIdPrefix:"comment_",currentPage:null,commentsCount:null,handleScroll:!0,scrollBottom:300,scrollDeltaTop:0,scrollCorrectTop:-1,scrollCorrectBottom:1,useNewApi:!1,appendNewComment:!1,insertToBegin:!1,handleRulesLink:null};return{_Init:function(e,n,r){var c,u,d,f,m,v,y,P,w,b=e.data("_commentsList"),T=this,L=n.getState(),S=_.bind(this);if(b instanceof h)return b;e.data("_commentsList",this),this._Model=n,this._Opts=c=o(!0,{},g,r),u=c.cssSels,this._Elems=d=l.Tools.getElements(u.Main,e,{jParent:e}),d.jScrollBlock=t("html, body"),f=d.jContainer,m=d.jPagesContainer,m.data("visible",m.is(":visible")),v=f.find(u.comment),y=v.eq(0),P=c.currentPage,this._State={top:f.offset().top,height:f.height(),currentPage:P,scrollLimitBottom:L.scrollLimitBottom||0,replyToId:L.reply},this._Pages=[y.length?y.data({top:y.offset().top,page:P}):null],w=c.prepareComments,s(w,"function")&&w.call(this,v),i.call(this),L.comment&&t(p.bind(T,L.comment,!0)),a.onGetStatus(S),a.on("authChange",S)}}}());t.fn.commentsList=function(e,n){return this.each(function(){new h(t(this),e,n)})},e.getNameSpace("Comments",l).commentsList=h}(window.jQuery,window,window.ru.mail.cpf)},298:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o=n.Comp,s=n.Tools,r=i.Extend,a=i.typeOf,l=o.Methods.initCallbacks,c=s.Auth.onGetStatus,u=n.Types.String.Url,h=u.addParams,p=u.getParams,d=n.Instances.stateObject,f=s.Cookie||t.cookie,m=function(){},_=i.getConstructor(function(){function n(t,e){var n=this._Opts.urlParams,i=n.extraParams&&n.extraParams.comments,o=n.lastParam,s=this._State,a={};return a[n.topicParam]=s.topicId,t==o?a[o]=1:a[n.pageParam]=e?Math.min(s.currentPage+1,s.totalPages):t,i&&r(a,i),h(a,n.commentsUrl)}function i(t){var n,i=parseInt(t.currentPage,10),o=this._Opts.urlParams.pageParam,s=e.location.href.replace(/[?#].*$/,""),a=p(s)||{};1!==i?a[o]=i:delete a[o],n={__location:{url:h(a,s,!0)}},r(!0,n,a),d.pushToState(n,!1,!0)}function u(t){t?this._AuthDeferred.resolve():(s.jQuery.showLoginPopup(),this._AuthDeferred.reject())}function _(t,e){var n=t?"errorRequest":"errorSend";this.reportError(this._Opts[n],e&&e.message),this._fire(n.toLowerCase(),[e||null])}function g(t){var e=this,n=this._Opts,i=n.preparePostCommentResponse,o=n.useNewApi&&a(f,"function")?{"X-CSRFToken":f("Mpop")}:{},s=function(t){if(n.useNewApi)t.topicId&&(e._State.topicId=t.topicId),t.status?e._fire("commentpost",[t]):_.call(e,!1,{message:t.msg,data:t});else{a(i,"function")&&(t=i(t));var o=t.comments;!t.error&&o.commentsList&&o.commentsList.length?(o.reply=t.reply,t.comments.topicId&&(e._State.topicId=t.comments.topicId),e._fire("commentpost",[o]),v.call(e,o)):_.call(e,!1,t.error)}};n.transport({url:n.urlParams.postUrl,data:t,dataType:"json",type:"POST",headers:o}).then(s,_.bind(e,!1))}function v(t,e){var n=this,i=this._State,o=parseInt(t.currentPage,10),s=parseInt(t.totalPages,10);i.currentPage=o,i.totalPages=s,i.totalComments=t.commentsCount,this._fire("beforegetpage",[t]),this._fire("getpage",[t]),t.isNext||this._fire("pagechange",[t]),a(e,"function")&&e.call(null,t),o==s&&(this.noRequest=!0,this.ignoreTimeout=setTimeout(function(){n.noRequest=!1},this._Opts.newRequestDelay))}var y={cssSels:{errorDescr:null},urlParams:{postUrl:null,commentsUrl:null,historyUrl:null,extraParams:{post:null,comments:null,history:null},topicParam:"tid",pageParam:"page",commentParam:"comment_id",lastParam:"last",lastPageVal:"last",replyToComment:"reply_",addComment:"add_comment",targetComment:"comment_"},transport:function(){return Promise.resolve(t.ajax.apply(null,arguments))},allowSetPage:!0,texts:null,commentsPerPage:25,newRequestDelay:6e4,currentPage:null,totalPages:null,topicId:null,onBeforeGetPage:null,onGetPage:null,onPageChange:null,onPageResize:null,onPost:null,onFormRequest:null,onAddForm:null,onStateChange:null,onScrollChange:null,errorSend:"sendError",errorRequest:"requestError",preparePageResponse:null,prepareHistoryResponse:null,useNewApi:!1};return{_Init:function(t){var n,o,s,a,c,u=d.State();this._Opts=n=r(!0,{},y,t),o=n.urlParams,c=parseInt(n.currentPage,10),this._State=s={currentPage:c,totalPages:parseInt(n.totalPages,10),totalComments:parseInt(n.totalComments,10),topicId:n.topicId,reply:o.addComment in u,comment:u[o.targetComment]},l.call(this,{Types:{beforegetpage:n.onBeforeGetPage,getpage:n.onGetPage,pagechange:n.onPageChange,pageresize:n.onPageResize,commentpost:n.onPost,formrequest:n.onFormRequest,addform:n.onAddForm,statechange:n.onStateChange,scrollchange:n.onScrollChange,errorsend:null,errorrequest:null,load:null}}),n.allowSetPage&&this.bind("pagechange",i),u[o.pageParam]&&this.getPage(u[o.pageParam]),isNaN(c)&&this.getPage(1),u[o.replyToComment]&&(s.reply=u[o.replyToComment]),s.reply&&(a=e.location,d.pushToState({__location:{url:a.pathname+a.search}},!1,!0))},getState:function(){return r({},this._State)},getPage:function(t,e,i){var o=this,s=this._Opts,r=s.preparePageResponse,l=function(n){var l=s.urlParams;if(a(r,"function")&&(n=r(n)),!n.currentPage||!parseInt(n.currentPage,10))return void _.call(o,!0);n.isNext=e,t!=l.lastParam&&t!=l.lastPageVal||(n.isLast=!0),o._fire("load",[!1]),v.call(o,n,i)};this._fire("load",[!0]),s.transport({url:n.call(this,t,e)}).then(l,_.bind(this))},getNextPage:function(t,e){var n=this._State;n.currentPage!=n.totalPages&&this.getPage(t,!0,e)},reportEvent:function(t,e){r(this._State,e),this._fire(t,[this.getState()]),delete this._State.message},reportError:function(t,e){var n,i=this._Opts,s=i.texts,r=i.cssSels.errorDescr;t in s&&(n=s[t],r&&e&&(n.extraElems={},n.extraElems[r]=e),o.jQuery.Tools.Notify(n))},getHistory:function(e,n,i){var o=this._Opts,s=o.urlParams,r=o.prepareHistoryResponse,l=_.bind(this),c={};c[s.topicParam]=this._State.topicId,c[s.commentParam]=e;var u=function(e){a(r,"function")&&(e=r(e));var o=e.commentsList;if(!o||!o.length)return void l(!0);Promise.resolve(i).then(function(){a(i,"function")&&(o=o.map(i)),a(n,"function")&&n.call(null,t.trim(o.join("")))})};o.transport({url:h(c,s.historyUrl)}).then(u,l)},postComment:function(t){a(t,"string")&&-1!==t.indexOf("&")&&(t=t.split("&").reduce(function(t,e){return e=e.split("="),e.length>1?t[e.shift()]=e.join("="):t[e[0]]="",t},{})),new Promise(function(t,e){this._AuthDeferred={resolve:t,reject:e}}.bind(this)).then(g.bind(this,t),m),c(u.bind(this))},getForm:function(t){new Promise(function(t,e){this._AuthDeferred={resolve:t,reject:e}}.bind(this)).then(this._fire.bind(this,"formrequest",[t]),m),c(u.bind(this))}}}());e.getNameSpace("Comp.jQuery.Comments",n).commentsManager=_}(window.jQuery,window,window.ru.mail.cpf)},299:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o=i.Extend,s=i.getConstructor(function(){function i(){var e,n=this,i=this._Model,o=this._Opts,s=this._Elems,a=this._State,c=s.jWrap,u=s.jWindow;i.bind("pagechange",function(t){var e=t.totalPages;a.currentPage=t.currentPage,a.totalPages=e,a.isHidden=1==e,h.call(n,t)}),i.bind("scrollchange",function(t){var e=t.scrollExcessTop||0;a.scrollLimitBottom=t.scrollLimitBottom||0,a.scrollExcessTop!=e&&(a.scrollExcessTop=e,s.jParent.css("top",e+(a.winHeightDelta||0)))}),i.bind("statechange",function(t){var e=t.winHeightDelta;isNaN(e)||(a.winHeightDelta=e,p.call(n,r(u),!0))}),m.winHndlrs.attach(function(t,o,s){var r,u;"scroll"==s?p.call(n,t):(e=c.offset(),a.wrapTop=e.top,a.wrapLeft=e.left,p.call(n,t,!0),r=d,l.call(n),r!=d&&h.call(n,a)),a.isFixed||(u=t.top+o.height-a.scrollLimitBottom-a.wrapHeight-a.wrapTop,i.reportEvent("scrollchange",{scrollExcessBottom:u>0?0:u}))}),s.jParent.on("click",o.cssSels.button,function(e){e.preventDefault();var i=t(this).data(),s=o.dataPropName;1!=i.disabled&&n._Model.getPage(i[s]||this.getAttribute("data-"+s))}),u.on("load",function(){a.wrapTop=c.offset().top})}function r(t){return{left:t.scrollLeft(),top:t.scrollTop()}}function a(t,e){var n=this._Opts,i=n.button,o=n.cssClss,s=i.tagName,r=document.createElement(s);return r.appendChild(document.createTextNode(t)),r.title=i.title+t,r.className=(e?i.className+" "+o.activePage:i.className)+" "+o.button,r.setAttribute("data-"+n.dataPropName,t),e&&r.setAttribute("data-disabled","1"),"a"==s&&(r.href="#"),r}function l(){var t=this._Elems;d=t.jBtnWrap.width()-t.jPrev.outerWidth(!0)-t.jNext.outerWidth(!0)-10}function c(e){var n,i=t("<div />").css({position:"absolute",visibility:"hidden"});return this._Elems.jContainer.append(i.append(a.call(this,e))),n=i.width(),i.remove(),n}function u(t,e,n){var i,o,s,r=[];e>=n?(i=1,o=n):e<3?1==n?i=o=1:t!=n?(i=t,o=t+1):(i=n-1,o=n):(s=(e-1)/2,t-s>0&&t+s<=n?(i=t-s,o=t+s):t-s<=0?(i=1,o=e):(i=n-e+1,o=n));for(var a=i;a<=o;a++)r.push(a);return r}function h(t){var e,n,i,o,s,l,h,f=this._Opts,m=this._Elems,_=m.jParent,g=m.jContainer,v=f.cssSels,y=document.createDocumentFragment(),P=parseInt(t.currentPage,10),w=parseInt(t.totalPages,10),b=P==w,T=1==P,L=f.dataPropName,S=f.cssClss,x=S.disabledStepBtn,E=S.disabledEndBtn;if(w<=1)return this._State.isHidden=!0,void(f.hiddenByClass&&_.addClass(f.cssClss.hidden)||_.hide());e=Math.min(Math.floor(d/c.call(this,Math.ceil(P+f.buttonsMax/2))),f.buttonsMax),e>3&&e%2==0&&e--,n=u(P,e,w),h=n.length;for(var C=0;C<h;C++)i=n[C],y.appendChild(a.call(this,i,i==P));g.empty().append(y),m.jNext.data(L,P+1).data("disabled",b?"1":"").toggleClass(x,b),m.jPrev.data(L,P-1).data("disabled",T?"1":"").toggleClass(x,T),o=m.jLast,o.data("disabled",b?"1":"").toggleClass(E,b),l=S.disabledEndNavBtn,l&&(s=v.navButton,o.find(s).toggleClass(l,b)),p.call(this,r(m.jWindow),!0),this._State.isHidden||_.is(":visible")||f.hiddenByClass&&_.removeClass(f.cssClss.hidden)||_.show()}function p(t,e){var n,i,o,s,r,a,l,c=this._State,u=c.winHeightDelta||0,h=c.wrapHeight+u,p=t.top,d=t.left,f=p>c.wrapTop-u,m=f!==c.isFixed,_=this._Elems,g=_.jParent,v=c.wrapLeft,y=c.scrollExcessTop||0;(!c.isHidden&&m||e)&&(_=this._Elems,n=this._Opts,i=n.cssClss,o=_.jWrap,c.winScrollLeft=d,r=f?{width:o.width(),top:u+y,left:v-d}:{width:"100%",top:0,left:0},g.toggleClass(i.fixed,f).css(r),o[0].style[n.parentSizeProp]=f&&g.is(":visible")?g.outerHeight(!0)+"px":0,c.isFixed=f,l=!(parseInt(c.currentPage,10)>1)&&!f,s=_.jFirst.data("disabled",l?"1":"").toggleClass(i.disabledEndBtn,l),a=i.disabledEndNavBtn,a&&s.find(n.cssSels.navButton).toggleClass(a,l),this._Model.reportEvent("pageresize",{message:{pagerFixationChanged:m}})),d!=c.winScrollLeft&&(c.winScrollLeft=d,g.css("left",f?v-d:0)),c.scrollLimitTop!=h&&(c.scrollLimitTop=h,this._Model.reportEvent("scrollchange",{scrollLimitTop:h}))}var d,f=n.Comp.jQuery,m=f.Tools,_={cssSels:{Main:{First:".js-first",Prev:".js-prev",Next:".js-next",Last:".js-last",Container:".js-comments_page_btn_cont",btnWrap:".js-comments_btnwrap"},button:".js-comments_paging_btn",navButton:".js-nav-button"},cssClss:{disabledEndBtn:"comment-nav__to__link_disabled",disabledEndNavBtn:null,disabledStepBtn:"comment-nav__pages__arr_off",activePage:"comment-nav__pages__link_on",fixed:"comment-controls_fixed",hidden:"hidden_all"},button:{tagName:"a",className:"",title:"–°—Ç—Ä–∞–Ω–∏—Ü–∞ "},parentSizeProp:"height",currentPage:null,totalPages:null,hiddenByClass:!1,dataPropName:"page",buttonsMax:9};return{_Init:function(n,r,a){var c,u,p,d,g,v,y=n.data("_commentsPaging");if(y instanceof s)return y;n.data("_commentsPaging",this),this._Model=r,this._Opts=c=o(!0,{},_,a),this._Elems=u=m.getElements(c.cssSels.Main,n,{jParent:n,jWindow:f.Elems.jWindow||t(e)}),u.jWrap=d=n.parent(),v=c.totalPages,g=d.offset(),this._State=p={wrapTop:g.top,wrapLeft:g.left,wrapHeight:n.outerHeight(),currentPage:c.currentPage,totalPages:v,isHidden:1==v,isFixed:!1,scrollLimitBottom:r.getState().scrollLimitBottom||0,scrollExcessTop:0,winHeightDelta:0},c.cssClss.button=c.cssSels.button.substr(1),1==v&&(c.hiddenByClass&&n.addClass(c.cssClss.hidden)||n.hide()),l.call(this),h.call(this,p),n.css("visibility","visible"),i.call(this)}}}());t.fn.commentsPaging=function(e,n){return this.each(function(){new s(t(this),e,n)})},e.getNameSpace("Comp.jQuery.Comments",n).commentsPaging=s}(window.jQuery,window,window.ru.mail.cpf)},30:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(175);e.DEBUG=!1,e.prefixRangeAnswer="range_",e.errorRequired=function(){return"–í–æ–ø—Ä–æ—Å —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –¥–ª—è –æ—Ç–≤–µ—Ç–∞"},e.errorRange=function(t,e){return"–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç "+t+" –¥–æ "+e+" "+i.plural(e,["–≤–∞—Ä–∏–∞–Ω—Ç","–≤–∞—Ä–∏–∞–Ω—Ç–∞","–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤"])+" –æ—Ç–≤–µ—Ç–∞"},e.errorAtLeastOne=function(t){return"–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã "+t+" "+i.plural(t,["–≤–∞—Ä–∏–∞–Ω—Ç","–≤–∞—Ä–∏–∞–Ω—Ç–∞","–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤"])+" –æ—Ç–≤–µ—Ç–∞"},e.errorMinLength=function(t){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –º–∏–Ω–∏–º—É–º –∏–∑ "+t+" "+i.plural(t,["—Å–∏–º–≤–æ–ª–∞","—Å–∏–º–≤–æ–ª–æ–≤","—Å–∏–º–≤–æ–ª–æ–≤"])},e.errorMaxLength=function(t){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –º–∞–∫—Å–∏–º—É–º –∏–∑ "+t+" "+i.plural(t,["—Å–∏–º–≤–æ–ª–∞","—Å–∏–º–≤–æ–ª–æ–≤","—Å–∏–º–≤–æ–ª–æ–≤"])},e.errorLettersOnly=function(){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã"},e.errorDigitsOnly=function(){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã"},e.errorServer500=function(){return"–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –∏ –º—ã –¥–µ–ª–∞–µ–º –≤—Å—ë –≤–æ–∑–º–æ–∂–Ω–æ–µ –¥–ª—è –µ—ë –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É"}},300:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o=i.Extend,s=i.typeOf,r=n.Tools,a=r.Cookie||t.cookie,l=i.getConstructor(function(){var n=r.Auth,c=i.moduleOpts,u={cssSels:{Items:null,complainBtn:null,complainBtnText:null},cssClss:{Button:{Complained:null,Avalible:null,Pending:null,Error:null}},uiTexts:{Button:{Complained:null,Avalible:null,Pending:null,Error:null}},forumParams:{topicId:null,forumId:null},cookieStoreParams:{path:null},itemIdAttr:"data-id",onComplain:null,onResponse:null,reqUrl:null,useConfirm:!1,confirmMessage:"",oneInstance:!0,useContainer:!0,storePrefix:"comm"},h=function(){var n,i,o,r=!1;try{r="localStorage"in e&&null!==(n=e.localStorage)}catch(t){}return r||(i=t.cookie,o=function(e,n,o,s){var r=t.extend({expires:e?7:-1},s);i(n,o,r)},n={getItem:function(t){return i(t)},setItem:o.bind(null,!0),removeItem:o.bind(null,!1)}),function(t,e){var i=this._Opts.cookieStoreParams;if(null===e)n.removeItem(t,e,i);else{if(s(e,"undefined"))return n.getItem(t);n.setItem(t,e,i)}}}(),p=function(t,e,n){var i=!s(n,"boolean"),o=[this._Opts.storePrefix+t,e.topicId].join("/");if(i)return 1==h.call(this,o);h.call(this,o,n?1:null)},d=function(){var e=function(e,n,i){var o=this._Params,s=null;null!=i&&(s=t.extend({userId:i},o,n)),e.call(this,s)};return function(t,i){n.onGetStatus(e.bind(this,t,i))}}(),f=function(t,e,n){var i=this._Opts,o=e.promise,r=i.onResponse;s(r,"function")&&r.call(this,n),n.status?(p.call(this,t,e,!0),o.resolve({commentId:t,oParams:e})):o.reject("BAD_RESPONSE")},m=function(t,e){var n={rid:t,tid:e.topicId};return e.requestData&&o(n,e.requestData),r.transport({url:this._Opts.reqUrl,type:"POST",dataType:"json",secure:!0,data:n,headers:{"X-CSRFToken":a("Mpop")}}).then(f.bind(this,t,e))},_=function(t,e){var n,i,o,s=this._Opts,r=s.cssClss.Button,a=s.uiTexts.Button;if(t&&t.length){t.data("disabled","avalible"!=e);for(var l in r)r.hasOwnProperty(l)&&(i=e==l.toLowerCase(),t.toggleClass(r[l],i),i&&(n=l));n&&(o=a[n])&&t.find(s.cssSels.complainBtnText).text(o)}},g=function(e,n){return new Promise(function(i,o){n=t.extend({promise:{resolve:i,reject:o}},n),d.call(this,function(t){null!==t?e&&!p.call(this,e,t)?(_.call(this,n.jBtn,"pending"),m.call(this,e,t).then(null,function(){o("HTTP_ERROR")})):o("WRONG_OBJECT"):o("NO_AUTH")},n)}.bind(this))},v=function(){var e=this,n=this._Opts,i=this._Elems.jList,o=n.cssSels,s=n.itemIdAttr;d.call(this,function(r){var a=n.useContainer?i.find(o.Items):i;null!=r&&a.each(function(){var n=t(this),i=n.attr(s),a=p.call(e,i,r);i&&_.call(e,n.find(o.complainBtn),a?"complained":"avalible")})})},y=function(n){var i=this,o=t(n.currentTarget),r=this._Opts,a=o.parents(r.cssSels.Items),l=a.attr(r.itemIdAttr);if(l&&!o.data("disabled")){if(n.preventDefault(),r.useConfirm&&!e.confirm(r.confirmMessage))return;g.call(this,l,{jBtn:o,jItem:a}).then(function(){var t=r.onComplain;s(t,"function")&&t.call(i),_.call(i,o,"complained")}).catch(function(t){"WRONG_OBJECT"!=t&&"NO_AUTH"!=t&&_.call(this,o,"error")}.bind(this))}},P=function(){var t=this._Opts.cssSels;this._Elems.jList.on("click",t.complainBtn,y.bind(this))};return{_Init:function(e,n){var i,o;if(n=t.extend(!0,{},n,c.get("Complain")),i=t.extend(!0,{},u,n),i.oneInstance){if((o=e.data("_complainObj"))instanceof l)return o;e.data("_complainObj",this)}this._Elems={jList:e},this._Opts=i,this._Params=i.forumParams,v.call(this),P.call(this)}}}());t.fn.initComplain=function(t){return l(this,t),this}}(window.jQuery,window,window.ru.mail.cpf)},301:function(t,e){!function(t,e,n){var i,o,s,r=n.Basic,a=r.Extend,l=r.typeOf,c={complainOpts:{cssSels:{Items:".js-comments_comment",complainBtn:".js-comments_complaint",complainBtnText:".js-comments_complaint_text"},cssClss:{Button:{Complained:"comment__action_complaint_done",Avalible:"comment__action_complaint_active",Pending:"comment__action_complaint_loading",Error:"comment__action_complaint_error"}},uiTexts:{Button:{Complained:"–ñ–∞–ª–æ–±–∞ –ø—Ä–∏–Ω—è—Ç–∞. –°–ø–∞—Å–∏–±–æ!",Error:"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏"}},forumParams:{topicId:null},cookieStoreParams:{path:null},itemIdAttr:"data-id",reqUrl:null,useContainer:!1,oneInstance:!1},deleteOpts:{cssSels:{complainBtn:".js-comments_delete"},cssClss:{Button:{Complained:"comment__action_delete_done",Avalible:"comment__action_delete_active",Pending:"comment__action_delete_loading",Error:"comment__action_delete_error"}},uiTexts:{Button:{Complained:"–°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ",Error:"–î–µ–π—Å—Ç–≤–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ"}},onComplain:function(){},storePrefix:"delete",useConfirm:!0,confirmMessage:"–£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?"},adminDeleteOpts:{cssSels:{complainBtn:".js-comments_admin_delete"},forumParams:{topicId:null,requestData:{action:"hide_reply_by_moderator"}}}},u=function(t){var e=this._Model._State.topicId;i&&e&&(i.forumParams.topicId=o.forumParams.topicId=s.forumParams.topicId=e),t.initComplain(i),t.initComplain(o),t.initComplain(s)},h=function(t){var e=t.pager;return{currentPage:"last"===e.currentPage?e.totalPages:e.currentPage,totalPages:e.totalPages,totalComments:e.commentsCount,commentsList:t.list}},p=function(t){var e=t.comments&&t.comments.list;return{commentsList:e&&e.length?e.map(function(t){return t.avatarSize=32,t}):[]}},d=function(t){var e=t.errors;if(e)if(e.form&&e.form.length)t.error={message:e.form[0]};else if(e.fields){var n=e.fields;for(var i in n)if(n.hasOwnProperty(i)&&n[i].length){t.error={message:n[i][0]};break}}else l(e,"string")&&(t.error={message:e});return t},f=r.getConstructor(function(){return{_Init:function(t){var e=a(!0,{},c,t);i=e.complainOpts,o=a(!0,{},i,e.deleteOpts,{reqUrl:e.deleteUrl}),s=a(!0,{},o,e.adminDeleteOpts,{reqUrl:e.adminUrl})},prepareComments:u,preparePageResponse:h,prepareHistoryResponse:p,preparePostCommentResponse:d}}());e.getNameSpace("Comp.jQuery.Comments",n).prepareComments=f}(window.jQuery,window,window.ru.mail.cpf)},302:function(t,e){!function(t,e,n,i,o){"use strict";function s(e){var n=(((e||{}).data||{}).error||{}).err_msg,i=d.alert;if(i&&n){var o=t(i({text:n}));this._alertPopup=new u(null,o),this._alertPopup.show()}}var r=n.Tools,a=n.Tools.getTemplate,l=r.PubSub,c=n.Instances.Ago,u=n.Basic.Constructors._repo.get("Popup"),h=n.Comp.jQuery.Comments,p=t(".js-comments"),d={comment:a("ct-comment.xml"),alert:a("ct-popup-alert.xml")};if(0!==p.length){var f,m,_=n.Tools.initModules,g=n.Basic.getOptions(p[0]),v=g.currentPage,y=g.totalPages,P=g.topicId,w=g.commentsCount,b=!!g.handleScroll;m=h.prepareComments({complainOpts:{onResponse:function(t){s.call(this,{data:t})},forumParams:{topicId:P},reqUrl:g.complainUrl},useContainer:!1,deleteUrl:g.deleteUrl,adminUrl:g.adminUrl});var T=h.commentsManager({cssSels:{errorDescr:".js-alert__text_1"},onPageChange:function(){c&&c.update(),l.publish("comments.page.change")},urlParams:{postUrl:g.postUrl,commentsUrl:g.commentsUrl+"?",historyUrl:g.historyUrl+"?",topicParam:"tid",commentParam:"rid",lastParam:null,replyToComment:"reply-",targetComment:"comment-"},transport:function(t){return t.secure=!0,r.transport(t)},commentsPerPage:g.perPage,currentPage:v,totalPages:y,topicId:P,texts:g.texts,preparePageResponse:m.preparePageResponse,prepareHistoryResponse:m.prepareHistoryResponse,preparePostCommentResponse:m.preparePostCommentResponse,useNewApi:!0});T.bind("errorsend",s),T.bind("errorrequest",s),t(".js-comments_add").commentForm(T,{cssSels:{Main:{textarea:"textarea"},form:"form",rulesPopup:"#box-comment-rules",rulesLink:".some-never-exists-class"},cssClss:{sending:"button_disabled",formFixed:b?"comment-form_state_fixed":null,formShort:b?"comment-form_state_short":null},attrs:{avatarUrl:"data-user-avatar"},handleScroll:b,handleAvatarUrl:function(){return l.publish("comments.payment.get-status"),new Promise(function(t,e){l.subscribe("avatar.update",function(e){t(e.data)})})},beforeAddForm:function(){return l.publish("comments.payment.get-status"),new Promise(function(t,e){l.subscribe("comments.payment.status",function(e){var n=e.data;n||l.publish("comments.payment.check"),t(n)})})},commentsCount:w,scrollCorrection:0}),p.commentsList(T,{cssSels:{rulesPopup:"#box-comment-rules",rulesLink:".some-never-exists-class"},cssClss:{active:"comment_active",showHistory:"comment_tree",showParent:"comment_parent",showForm:"comment_form",authorized:"comments_authorized"},prepareComments:function(t){m.prepareComments.apply(this,arguments),_(t),t.length&&c&&c.update({future:"—Ç–æ–ª—å–∫–æ —á—Ç–æ",elems:t.get()})},commentTemplate:d.comment,commentIdPrefix:"comment-",commentsCount:w,currentPage:v,handleScroll:b,scrollDeltaTop:-81,scrollCorrectTop:-30,useNewApi:!0,appendNewComment:g.appendNewComment||!1}),f=t(".js-comments_paging"),f.commentsPaging(T,{currentPage:v,totalPages:y,cssClss:{disabledEndBtn:"comments-paging__end_disabled",disabledStepBtn:"comments-paging__nav_disabled",activePage:"comments-paging__item_active",fixed:"comments-paging_fixed"},button:{tagName:"a",className:"comments-paging__item",title:"–°—Ç—Ä–∞–Ω–∏—Ü–∞ "},parentSizeProp:"paddingTop",hiddenByClass:!0}),n.Tools.checkDeviceType().then(function(t){T.reportEvent("statechange",{winHeightDelta:"laptop"===t?40:0})})}}(window.jQuery||window.$,window,window.ru.mail.cpf,window.Modernizr,window.__PM)},303:function(t,e,n){"use strict";var i=n(62),o=(n.n(i),n(88)),s=(n.n(o),n(89)),r=(n.n(s),n(90)),a=(n.n(r),n(304));n.n(a)},304:function(t,e){!function(t,e,n,i){"use strict";var o=n.Basic.moduleOpts.setParams;o("MapView",{options:{}}),o("MapLeafletView",{options:{getGeoObjectParams:function(t){return t.type_event?this._opts.types["type"+t.type_event]:{}},geoObjectDefaults:{weight:3,color:"#f58c70",lineCap:"round",opacity:1},types:{type1:{icon:{iconUrl:"/img/map/1x/map-marker-burst.png",iconRetinaUrl:"/img/map/2x/map-marker-burst.png?@2X=2014.03.06",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type2:{icon:{iconUrl:"/img/map/1x/map-marker-airplane.png",iconRetinaUrl:"/img/map/2x/map-marker-airplane.png?@21X=2014.04.02",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type3:{icon:{iconUrl:"/img/map/1x/map-marker-flood.png",iconRetinaUrl:"/img/map/2x/map-marker-flood.png",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type4:{icon:{iconUrl:"/img/map/1x/map-marker-event-small.png",iconRetinaUrl:"/img/map/2x/map-marker-event-small.png",iconSize:[10,10],iconAnchor:[5,5],popupAnchor:[0,-3]}},type5:{icon:{iconUrl:"/img/map/1x/map-marker-event-mid.png",iconRetinaUrl:"/img/map/2x/map-marker-event-mid.png",iconSize:[26,26],iconAnchor:[13,13],popupAnchor:[0,-8]}},type6:{icon:{iconUrl:"/img/map/1x/map-marker-event-big.png",iconRetinaUrl:"/img/map/2x/map-marker-event-big.png",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type7:{color:"#f58c70"},type8:{color:"#ffbc00"},type9:{color:"#6bbedd"},type10:{color:"#f06eaa"},type11:{color:"#f58c70",dashArray:"5 15"}}}})}(window.jQuery||window.$,window,window.ru.mail.cpf,window.Terraformer)},33:function(t,e,n){!function(t,e,n){"use strict";function i(t){if(t&&t.length){var n=h.trigger.bind(h,"resize");t.forEach(function(t){t in m&&m[t]()}),e.requestAnimationFrame(n),setTimeout(n,2e3)}}function o(t){var e;t=t.split("?")[0],-1===p.indexOf(t)&&(p.push(t),e=document.createElement("script"),e.type="text/javascript",e.setAttribute("defer","defer"),e.src=t+"?"+(Math.random()+"").split(".")[1],u.appendChild(e))}function s(t){return!(!t||!t.length)&&(!!t.is("iframe")||!!t.find("iframe").length)}function r(e,n,i){return new Promise(function(o,r){var a=i.closestParent?e.closest(i.closestParent):t(e.get(0).parentNode);setTimeout(function(){var t=_[n]||s,e={element:a.get(0),type:n};t(a)?o(e):r(e)},i.loadTimeout)})}function a(){var t=n.Basic.moduleOpts.get("ActivateEmbeds")||{};t.initializers&&(m=n.Basic.Extend(m,t.initializers))}function l(n,s){d||(a(),d=!0);var l=[],u=[],h=c(!0,{},f,s||{}),p=h.checkRawItems||{};return n.each(function(n,i){var s=i.getAttribute("data-type");if(!p[s]||!1!==p[s](i,s)){var a=t(),c=i.value.replace(/__text_area__/g,"textarea"),d=t(i),f=[];t(c).each(function(e,n){var i;"SCRIPT"===n.tagName?n.src?o(n.src):(i=document.createElement("script"),i.type="text/javascript","textContent"in i?i.textContent=n.textContent:i=['<script type="text/javascript">',t(n).html(),"<\/script>"].join(""),f.push(i)):a=a.add(n)}),-1===l.indexOf(s)&&l.push(s),u.push(r(d,s,h).catch(function(t){})),d.replaceWith(a),f.length&&f.forEach(function(t){document.head.appendChild(t)}),e.requestAnimationFrame(a.trigger.bind(a,"documentHeightChange"))}}),e.requestAnimationFrame(i.bind(this,l)),u}var c=n.Basic.Extend,u=t("head")[0],h=t(e),p=[],d=!1,f={loadTimeout:5e3,closestParent:null,checkRawItems:function(){var t=function(t){var n=e.Modernizr;return!n||("boolean"!=typeof n[t]||n[t])},n=function(e){var n=t("webaudio");return n||e.parentNode.removeChild(e),n};return{soundcloud:n,rutube:n}}()},m={instagram:function(t){e.instgrm&&e.instgrm.Embeds&&e.instgrm.Embeds.process(t)},facebook:function(t){e.FB&&e.FB.XFBML&&e.FB.XFBML.parse(t)},twitter:function(t){e.twttr&&e.twttr.widgets&&e.twttr.widgets.load(t)}},_={various:function(){return!0}};e.getNameSpace("Tools",n,!0).activateEmbeds=l}(window.jQuery||window.$,window,window.ru.mail.cpf)},34:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o=i.throttle,s=n.Tools.activateEmbeds,r=t(e),a=/iphone|ipod/i.test(navigator.userAgent),l={SCROLL:"scroll",CUSTOM_SCROLL:"touchend"},c=l.SCROLL,u={cssSels:{item:".js-wysiwyg__embedcode"},scrollLimit:400,loadTimeout:5e3,failHandler:null,checkRawItems:{}},h=function(){if(t(this._Elems.Parent).is(":visible")){var e,n=this._state.winSizes.height+this._Opts.scrollLimit;this._state.items.forEach(function(i){i.getBoundingClientRect().top<n&&(e=(e||t()).add(i))}),e&&this.initItemsCode(e)}},p=function(){this._state.winSize=d(),e.requestAnimationFrame(h.bind(this))},d=function(){var t=e.document.documentElement;return{height:t.clientHeight,width:t.clientWidth}},f=function(t){var e,n=this._state;n.areListernersActive!==t&&(n.areListernersActive=t,t?(e="on",n.handlers={resize:o(p.bind(this),100),scroll:o(h.bind(this),100)}):e="off",r[e]("resize",n.handlers.resize),r[e](c,n.handlers.scroll))},m=function(t){var e=this._state.items;t.each(function(t,n){var i=e.indexOf(n);-1!==i&&e.splice(i,1)})},_=function(){return{loadTimeout:this._Opts.loadTimeout,checkRawItems:this._Opts.checkRawItems||{}}},g=i.Constructors.getView({_Init:function(){this._state={items:[],winSizes:d(),handlers:{}},a&&"ru.mail.media.parallaxSlot"in e&&(c=l.CUSTOM_SCROLL),this.processItems(),this._state.items.length&&r.on("load",o(p.bind(this),100))},processItems:function(t){var e=this._state,n=t||this._Elems.Parent,i=this._Opts.cssSels.item,o=n.find(i).removeClass(i.slice(1));e.items=e.items.concat(Array.prototype.slice.call(o)),e.items.length&&(f.call(this,!0),h.call(this))},initItemsCode:function(t){var e=this._Opts.failHandler,n=s(t,_.call(this));m.call(this,t),this._state.items.length||f.call(this,!1),"function"==typeof e&&(e=e.bind(this),n.forEach(function(t){t.then(null,e)}))}},u,null,"MediaEmbeds");e.getNameSpace("Modules",n).MediaEmbeds=g}(window.jQuery||window.$,window,window.ru.mail.cpf)},35:function(t,e,n){"use strict";function i(t){return new Promise(function(e,n){return l?(s.print.warn("MPF is already started"),e()):(t&&a.applicationSettings.update(t),l=!0,r.resolveConfigSetters().then(function(t){var n=function(){s.print.info("MPF init. Env: production"),o.initAllComponents(document.body),e()};"loading"!==document.readyState?n():document.addEventListener("DOMContentLoaded",n)}))})}Object.defineProperty(e,"__esModule",{value:!0});var o=n(20),s=n(0),r=n(7),a=n(22),l=!1;e.init=i},36:function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n={},r=0,a=t;r<a.length;r++){var l=a[r];if("object"===i(l)&&null!==l)for(var c=Object.keys(l),u=0,h=c;u<h.length;u++){var p=h[u],d=l[p];if(d instanceof Date){var f=new Date;f.setTime(d.getTime()),n[p]=f}else d instanceof RegExp?n[p]=new RegExp(d):Array.isArray(d)?n[p]=Array.prototype.concat.call([],d):s(d)?n[p]=o(n[p],d):n[p]=d}}return n}Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){return null!==t&&void 0!==t&&"object"===i(t)&&!(t instanceof Promise)};e.deepMerge=o},37:function(t,e,n){"use strict";function i(t,e){return function e(n,i){if(0===i.length)return n!==t?n:null;var o=n[i[0]];return null===o||void 0===o?null:e(o,i.slice(1))}(t,e)}function o(t,e,n){return function t(e,n,i){return 1===n.length?(e[n[0]]=i,e[n[0]]):(null!==e[n[0]]&&void 0!==e[n[0]]||(e[n[0]]=e[n[0]]||{}),t(e[n[0]],n.slice(1),i))}(t,e,n),t}Object.defineProperty(e,"__esModule",{value:!0}),e.getIn=i,e.setIn=o},38:function(t,e,n){"use strict";var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(39),s=function(t){function e(){var e=t.call(this)||this;return e.emit("ready"),e}return i(e,t),e}(o.EventEmitter);e.Emitter=s},39:function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function r(t){return void 0===t}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,o,a,l,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}if(n=this._events[t],r(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(s(n))for(a=Array.prototype.slice.call(arguments,1),c=n.slice(),o=c.length,l=0;l<o;l++)c[l].apply(this,a);return!0},n.prototype.addListener=function(t,e){var o;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned&&(o=r(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[t].length>o&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),o||(o=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var o=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,o,r,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],r=n.length,o=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=r;a-- >0;)if(n[a]===e||n[a].listener&&n[a].listener===e){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},n.listenerCount=function(t,e){return t.listenerCount(e)}},40:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(41))},41:function(t,e,n){"use strict";function i(){return __REDUX_DEVTOOLS_EXTENSION__.connect()}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof __REDUX_DEVTOOLS_EXTENSION__,s=function(){function t(){var t=this;this.subscriptions={},o&&(this.devTools=i(),this.devTools.subscribe(function(e){if("DISPATCH"===e.type&&"JUMP_TO_STATE"===e.payload.type)for(var n=0,i=Object.keys(t.subscriptions);n<i.length;n++){var o=i[n];t.subscriptions[o](e)}}))}return t.prototype.subscribe=function(t,e){var n="handler_"+t;this.subscriptions[n]||(this.subscriptions[n]=e)},t.prototype.send=function(t,e){o&&this.devTools&&this.devTools.send(t,e)},t.prototype.remove=function(t){delete this.subscriptions["handler_"+t]},t}();e.DevToolsExtension=s},42:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(24);e.DOMComponent=i.DOMComponent,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(47))},43:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=n(1),s=n(23),r=0,a=function(){function t(t,e,n){void 0===e&&(e={}),void 0===n&&(n={}),this._ns=t,this._id=++r,this._options=i.deepMerge({},this.getDefaultOptions(),e),this._initialState=i.deepMerge({},this.getInitialState(),n)}return t.prototype.init=function(){},t.prototype.getDefaultOptions=function(){return{}},t.prototype.getInitialState=function(){return{}},Object.defineProperty(t.prototype,"alias",{get:function(){var t=this.constructor;return this._alias||t.registryName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this._ns?""+this.alias+o.COMPONENT_NS_DELIMITER+this._ns:this.alias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identity",{get:function(){return""+this.ns+o.COMPONENT_NS_DELIMITER+this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.getState()},enumerable:!0,configurable:!0}),t.prototype.setState=function(t){return this._store.put(t)},t.prototype.getState=function(){return this._store.read()},t.prototype.update=function(t,e){},t.prototype.canDispatch=function(){return!s.Store.hasEntity(this.identity)},t.prototype.dispatchStore=function(t,e){this.shouldUpdate(t,e)&&this.update(t,e)},t.prototype.shouldUpdate=function(t,e){return!0},t.prototype.reset=function(){this._store.destroy(),this.dispatch(this._alias)},t.prototype.preDispatch=function(){},t.prototype.postDispatch=function(){},t.prototype.dispatch=function(t){return this.canDispatch()&&(this._alias=t,this._store=new s.Store(this.identity,this._initialState,this.dispatchStore.bind(this)),this.preDispatch(),this._store.dispatch(),this.postDispatch(),this.init()),this},t}();e.Component=a},44:function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(45)),i(n(46))},444:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(n(208),n(93),n(295),n(303),n(189),n(294),n(445),n(95)),o=(n.n(i),n(188)),s=(n.n(o),n(203)),r=(n.n(s),n(447)),a=(n.n(r),n(448)),l=(n.n(a),n(449)),c=(n.n(l),n(450));n.n(c);window.ru.mail.asyncTemplates.prefetch("/bem/news/web/web.bundles/ct-notifications-new-comment/ct-notifications-new-comment.xml.js")},445:function(t,e,n){"use strict";n(446)},446:function(t,e,n){"use strict";function i(t){(new Image).src=t+"?r="+Math.round(1e11*Math.random())}var o=n(19),s=(n.n(o),n(167)),r=(n.n(s),window),a=r.Modernizr,l=window.ru.mail.cpf,c=window,u=c.$,h=a.csstransforms3d&&!navigator.userAgent.match(/iPad/i)?-40:0;Object(o.setConfig)("SurveyComponent",{options:{style:{offsetTop:h},template:o.TemplateComponent.getTemplate(l.Tools.getTemplate("ct-survey.xml")),onFinish:function(t,e){l.Tools.initModules(u(e));var n=e.getAttribute("data-finish-pixel-url");"done"==t.currentState&&n&&i(n)}}}),Object(o.init)({templatesNS:"fest"})},447:function(t,e,n){!function(t,e,n){"use strict";var i=n.Tools,o=i.getTemplate,s=i.initModules,r=n.Tools.PubSub,a={template:o("ct-comments-list-short.xml"),prepareTemplateData:null};n.Basic.Constructors.getView(function(){function e(){var e=this._opts,n=this._state;if(!n.inited){var i=this._elems.parent,o=n.templateDate;e.template;"function"==typeof e.prepareTemplateData&&(o=e.prepareResponse.call(this,o)),e.template.asyncRender(o).then(function(e){var o=t(e);i.html(o),s(o),n.inited=!0,this._trigger("render")}.bind(this))}}return{_Events:["render"],_Handlers:{render:function(){r.publish("comments.payment.get-user-info-redraw")}},_Init:function(t){t=t||{},this._opts.template&&(this._state={inited:!1,templateDate:t},e.call(this))}}}(),a,null,"AsyncRender")}(window.jQuery||window.$,window,window.ru.mail.cpf)},448:function(t,e){!function(t,e,n){"use strict";function i(){function i(e,n){var i=l("ct-popup-alert.xml"),o={};if("string"==typeof e?(o.title=e,o.text=n):o.text=n||h("data.error.err_msg",e),i){var s=t(i(o));this._alertPopup=new p(null,s),this._alertPopup.show()}}var o=this._elems,f=this._opts,m=o.commentsList,_=o.form,g=o.pager,v=c(m[0]),y=v.currentPage,P=v.totalPages,w=v.topicId,b=v.commentsCount,T=!!v.handleScroll,L=n.Instances.Ago,S=d.prepareComments(r(!0,f.prepareComments,{complainOpts:{onResponse:function(t){i.call(this,{data:t})},forumParams:{topicId:w},reqUrl:v.complainUrl},deleteUrl:v.deleteUrl,adminUrl:v.adminUrl})),x=d.commentsManager(r(!0,f.commentsManager,{onPageChange:function(){L&&L.update(),a.publish("comments.page.change")},urlParams:{postUrl:v.postUrl,commentsUrl:v.commentsUrl+"?",historyUrl:v.historyUrl+"?"},commentsPerPage:v.perPage,currentPage:y,totalPages:P,topicId:w,texts:v.texts,preparePageResponse:S.preparePageResponse,prepareHistoryResponse:S.prepareHistoryResponse,preparePostCommentResponse:S.preparePostCommentResponse}));x.bind("errorsend",i),x.bind("errorrequest",i);var E=r(f.commentForm,{cssClss:{formFixed:T?"comment-form_state_fixed":null,formShort:T?"comment-form_state_short":null},handleScroll:T,handleAvatarUrl:function(){return a.publish("comments.payment.get-status"),new Promise(function(t,e){a.subscribe("avatar.update",function(e){t(e.data)})})},commentsCount:b});_.commentForm(x,E),m.commentsList(x,r(!0,f.commentsList,{prepareComments:function(t){S.prepareComments.apply(this,arguments),u(t),t.length&&L&&L.update({future:"—Ç–æ–ª—å–∫–æ —á—Ç–æ",elems:t.get()})},commentsCount:b,currentPage:y,handleScroll:T,appendNewComment:v.appendNewComment||!1})),(g||{}).length&&g.commentsPaging(x,r(!0,f.commentsPaging,{currentPage:y,totalPages:P})),L&&L.update(),t(e).trigger("resize"),s.checkDeviceType().then(function(t){x.reportEvent("statechange",{winHeightDelta:"laptop"===t?40:0})})}var o=n.Basic,s=n.Tools,r=o.Extend,a=s.PubSub,l=s.getTemplate,c=o.getOptions,u=s.initModules,h=o.getByPath,p=o.Constructors._repo.get("Popup"),d=n.Comp.jQuery.Comments,f={cssSels:{Main:{commentsList:".js-comments",form:".js-comments_add",pager:".js-comments_paging"}},prepareComments:{useContainer:!1},commentsManager:{cssSels:{errorDescr:".js-alert__text_1"},urlParams:{topicParam:"tid",commentParam:"rid",lastParam:null,replyToComment:"reply-",targetComment:"comment-"},useNewApi:!0,transport:function(t){return t.secure=!0,s.transport(t)}},commentForm:{cssSels:{Main:{textarea:"textarea"},form:"form",rulesPopup:"#box-comment-rules",rulesLink:".some-never-exists-class"},cssClss:{sending:"button_disabled"},attrs:{avatarUrl:"data-user-avatar"},scrollCorrection:0},commentsList:{cssSels:{rulesPopup:"#box-comment-rules",rulesLink:".some-never-exists-class"},cssClss:{active:"comment_active",showHistory:"comment_tree",showParent:"comment_parent",showForm:"comment_form",authorized:"comments_authorized"},commentTemplate:l("ct-comment.xml"),commentIdPrefix:"comment-",scrollDeltaTop:-75,scrollCorrectTop:-30,useNewApi:!0},commentsPaging:{cssClss:{disabledEndBtn:"comments-paging__end_disabled",disabledStepBtn:"comments-paging__nav_disabled",activePage:"comments-paging__item_active",fixed:"comments-paging_fixed"},button:{tagName:"a",className:"comments-paging__item",title:"–°—Ç—Ä–∞–Ω–∏—Ü–∞ "},parentSizeProp:"paddingTop",hiddenByClass:!0}};o.Constructors.getView(function(){return{_Init:function(){0!==this._elems.commentsList.length&&i.call(this)}}}(),f,null,"CommentsInit")}(window.jQuery||window.$,window,window.ru.mail.cpf)},449:function(t,e){!function(t,e){"use strict";var n=e.Basic.moduleOpts.setParams,i=e.Tools.PubSub;n("PhotoStories.Article",{options:{useBanner:!1,_Handlers:{slide:function(){i.publish("fixedPanel_update_slot")}}}})}(window,window.ru.mail.cpf)},45:function(t,e,n){"use strict";function i(t,e){return t.split(e).map(function(t){return t.trim()})}function o(t,e){var n=new RegExp(e+"\\"+c.COMPONENT_DATA_BIND_DEF_DELIMITER,"g");return t.replace(n,"")}function s(t,e){return function(n){if(t in u.DOM_ELEMENT_PROPERTIES)n[t]=e;else if(t in u.DOM_ELEMENT_ATTRIBUTES)switch(u.DOM_ELEMENT_ATTRIBUTES[t]){case u.MPFAttributeType.BOOLEAN:e?n.setAttribute(t,t):n.removeAttribute(t);break;case u.MPFAttributeType.STRING:n.setAttribute(t,e)}else n.setAttribute(t,e)}}function r(t,e){var n=new a.Collector(t,e);return function(t,e,r){e(function(){for(var e=n.group(t.$,t.alias),a=Object.keys(e),u=0,h=a;u<h.length;u++)for(var p=h[u],d=o(p,t.alias),f=i(d,c.COMPONENT_DATA_BIND_PROP_DELIMITER),m=0,_=f;m<_.length;m++){var g=_[m],v=i(g,c.COMPONENT_DATA_BIND_EQ),y=v[0],P=v[1];if("function"!=typeof t[P])l.print.warn("Method '"+P+"' not found in '"+t.alias+"' for key '"+p+"'");else{var w=e[p],b=t[P].bind(t),T=r(),L=b(T);w.forEach(s(y,L))}}})}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(25),l=n(0),c=n(1),u=n(6);e.dataBinder=r},450:function(t,e){!function(t,e,n){"use strict";var i=n.Basic.moduleOpts.setParams;n.Tools.PubSub;i("FixedPanelView.PhotoStories",{options:{cssSels:{Main:{banner:".js-fixed-panel__banner"}},bannerViewName:"SlotView",_Handlers:{pubsub:{fixedPanel_update_slot:function(t){this._elems.banner.data(this._opts.bannerViewName).reload(!0)}}}}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},46:function(t,e,n){"use strict";function i(t){for(var e=Object.keys(t),n={},i=0,o=e;i<o.length;i++){var r=o[i],a=r.split(s.COMPONENT_EVENT_DELIMITER),l=a[0],c=a[1];n[l]||(n[l]=[]);var u={name:c,handler:t[r]};n[l]=n[l].concat(u)}return n}function o(t,e){var n={};return function(o){for(var s=i(o),a=Object.keys(s),l=0,c=a;l<c.length;l++){var u=c[l];!function(i){var o=function(n){for(var o=0,r=s[i];o<r.length;o++){var a=r[o],l=a.name,c=a.handler,u=n.target;if(null===u)return;for(var h=e(l);u!==t;){if(-1!==h.indexOf(u))return void c(n);u=u.parentNode}}},a=-1!==r.indexOf(i);t.addEventListener(i,o,a),n[i]={unbind:function(){t.removeEventListener(i,o)}}}(u)}return function(){for(var t=Object.keys(n),e=0,i=t;e<i.length;e++){var o=i[e];n[o].unbind(),delete n[o]}}}}Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),r=["focus","blur"];e.eventsBinder=o},47:function(t,e,n){"use strict";function i(t){return window[t]}function o(t){return Promise.resolve(t)}function s(t,e){var n=e||{},o=c.applicationSettings.getState(),s=o.templatesPath,r=o.templatesNS,a=o.templatesExt;if(!s)throw new Error(l.format('Invalid application settings: "templatesPath"').error().str());if(!r)throw new Error(l.format('Invalid application settings: "templatesNS"').error().str());var p=n.getName,d=n.getPath,f="function"==typeof p?p(t):h.getName(t),m="function"==typeof d?d(s,t,a):h.getPath(s,t,a);if(u[m])return u[m];var _=new Promise(function(t,e){var n=i(r);if(n&&n[f])return t(n[f]);var o=document.createElement("script");o.async=!0,o.type="text/javascript",o.src=m,o.addEventListener("load",function(){n&&n[f]?t(n[f]):e(new Error(l.format('Unable to read template "'+f+'"').error().str()))}),o.addEventListener("error",function(){e(new Error(l.format('Unable to load template from "'+f+'"').error().str()))}),document.head.appendChild(o)});return u[m]=_,_.then(function(t){return delete u[m],t})}var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(24),l=n(0),c=n(22),u={},h={getPath:function(t,e,n){return t+"/"+e+"/"+e+n},getName:function(t){return t+".xml"}};e.resolveTemplate=function(t,e){return function(){return"function"==typeof t?o(t):"string"==typeof t?s(t,e):Promise.reject(new Error(l.format("Invalid template").error().str()))}};var p=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return r(n,t),n.prototype.update=function(e,n){var i=this;t.prototype.update.call(this,e,n),(0,this.options.template)().then(function(t){var e=i.getState();i.render(t,e)}).catch(function(t){l.print.warn(t.message)})},n.prototype.render=function(t,e){var n=t(e);this.$.innerHTML=n},n.getTemplate=e.resolveTemplate,n}(a.DOMComponent);e.TemplateComponent=p},48:function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n(49)),i(n(50)),i(n(26)),i(n(27)),i(n(52))},49:function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],s=0,r=t;s<r.length;s++){var a=r[s];if(a){var l=i(a);if("string"===l||"number"===l)n.push(""+a);else if(Array.isArray(a))n=n.concat(o.apply(void 0,a));else for(var c=0,u=Object.keys(a);c<u.length;c++){var h=u[c],p=a[h];p&&n.push(""+h)}}}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.classNames=o},50:function(t,e,n){"use strict";function i(t){return Array.from(t.elements).reduce(function(t,e){var n=e,i=n.name,o=n.nodeName,s=n.type,a=n.checked,l=null!==e.getAttribute("disabled"),c=/^(?:input|select|textarea|keygen)/i.test(o),u=/^(?:submit|button|image|reset|file)$/i.test(s),h=a||!/^(?:checkbox|radio)$/i.test(s);if(i&&!l&&c&&!u&&h){var p=r.getValue(e);if(null===p)return t;if(Array.isArray(p)){var d=p.map(function(t){return{name:i,value:t.replace(/\r?\n/g,"\r\n")}});return t.concat(d)}return t.concat({name:i,value:(p||"").replace(/\r?\n/g,"\r\n")})}return t},[])}function o(t){for(var e=i(t),n={},o=0,s=e;o<s.length;o++){var r=s[o];n[r.name]||(n[r.name]=[]),n[r.name]=n[r.name].concat(r.value)}return n}function s(t){return i(t).map(function(t){var e=t.name,n=t.value;return encodeURIComponent(e)+"="+encodeURIComponent(null===n?"":n)}).join("&")}Object.defineProperty(e,"__esModule",{value:!0});var r=n(26);e.serializeArray=i,e.serializeObject=o,e.serializeStr=s},51:function(t,e,n){"use strict";function i(t,e){return!!t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeName=i},52:function(t,e,n){"use strict";function i(t,e,n){void 0===n&&(n={}),n=Object.assign({},o,n);var i;try{i=new Event(t,n)}catch(e){var s=n.bubbles,r=n.cancelable;i=document.createEvent("Event"),i.initEvent(t,s,r)}e.dispatchEvent(i)}Object.defineProperty(e,"__esModule",{value:!0});var o={bubbles:!1,cancelable:!1,composed:!1};e.triggerCustomEvent=i},59:function(t,e,n){"use strict";function i(t,e){return e.filter(function(e){return""+e.id==""+t})[0]}function o(t,e){return e.filter(function(e){return e.id in t&&"0"!==t[e.id]})}function s(t,e){var n=-1;return(t||[]).some(function(t,i){var o=e(t);return o&&(n=i),o}),n}function r(t,e){var n=""+t;return s(e,function(t){return""+t.id===n})}function a(t,e){return(t||[]).reduce(function(t,n){return t[n]=e,t},{})}Object.defineProperty(e,"__esModule",{value:!0}),e.findItem=i,e.findItems=o,e.findIndex=s,e.itemIndex=r,e.mapToDict=a},6:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DOM_DATA_COMPONENT_SEL="[data-mp]",e.DOM_DATA_COMPONENT_NAME_ATTR="data-mp",e.DOM_DATA_COMPONENT_EL_ATTR="data-mp-el",e.DOM_DATA_COMPONENT_STATE_ATTR="data-mp-state",e.DOM_DATA_COMPONENT_BIND_ATTR="data-mp-bind";var i;!function(t){t[t.STRING=0]="STRING",t[t.BOOLEAN=1]="BOOLEAN",t[t.NUMERIC=2]="NUMERIC"}(i=e.MPFProperty||(e.MPFProperty={}));var o;!function(t){t[t.STRING=0]="STRING",t[t.BOOLEAN=1]="BOOLEAN"}(o=e.MPFAttributeType||(e.MPFAttributeType={})),e.DOM_ELEMENT_ATTRIBUTES={required:o.BOOLEAN,checked:o.BOOLEAN,disabled:o.BOOLEAN,selected:o.BOOLEAN},e.DOM_ELEMENT_PROPERTIES={alt:i.STRING,id:i.STRING,name:i.STRING,innerHTML:i.STRING,src:i.STRING,style:i.STRING,textContent:i.STRING,title:i.STRING,for:i.STRING,value:i.STRING,colspan:i.NUMERIC,height:i.NUMERIC,maxlength:i.NUMERIC,rowspan:i.NUMERIC,width:i.NUMERIC}},60:function(t,e,n){"use strict";function i(t,e){return"q_"+t+(e?"_":"")}function o(t,e,n){var i=u(t,e,n);if(!i)return l.log("–Ω–µ –Ω–∞—à–ª–∏ nextId"),null;var s=r.findItem(i,e);return s?a.checkIfCanShowQuestion(s,n)?s:o(r.itemIndex(s.id,e),e,n):(l.log("–Ω–µ –Ω–∞—à–ª–∏ –≤–æ–ø—Ä–æ—Å —Å id "+i),null)}function s(t){return t.reduce(function(t,e){return e.answers&&(e.answersById=s(e.answers)),t[e.id]=e,t},{})}Object.defineProperty(e,"__esModule",{value:!0});var r=n(59),a=n(178),l=n(61),c=function(t){return!!t&&(!Array.isArray(t)||0!==t.length)},u=function(t,e,n){if(e.length===t+1)return"";var o=e[t],s=o.answers,r=o.id,a=o.options;if(a){var u=a.next;if(u&&c(n[i(r,!0)]))return l.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–ª —Å–≤–æ–π –æ—Ç–≤–µ—Ç, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ—Ö–æ–¥–∏–º —Å—é–¥–∞:",u),u}var h=n[i(r)];if(h){var p,d=Array.isArray(h);if(s.some(function(t){var e=t.next,n=t.id,i=d?-1!==h.indexOf(""+n):!(!e||!h[n]);return i&&(p=e),i}),p)return l.log("–ù–∞—à–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π id –≤ –æ–ø—Ü–∏—è—Ö –æ—Ç–≤–µ—Ç–æ–≤:",p),p}var f=e[t+1].id;return l.log("–ë–µ—Ä–µ–º —Å–ª–µ–¥—É—é—â–∏–π –ø–æ –ø–æ—Ä—è–¥–∫—É –≤–æ–ø—Ä–æ—Å:",f),f};e.createQuestionKey=i,e.findNextQuestion=o,e.mapToDictById=s},61:function(t,e,n){"use strict";function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.DEBUG&&console.log.apply(console,s([">>>"],t))}var o=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,s=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(30);e.log=i},62:function(t,e,n){(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}/*! Terraformer JS - 1.0.4 - 2014-05-22
*   https://github.com/esri/Terraformer
*   Copyright (c) 2014 Environmental Systems Research Institute, Inc.
*   Licensed MIT */
!function(i,o){"object"==n(t)&&"object"==n(t.exports)&&(e=t.exports=o()),"object"==("undefined"==typeof window?"undefined":n(window))&&(i.Terraformer=o())}(window,function(){function t(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(){var t=Array.prototype.slice.apply(arguments);void 0!==("undefined"==typeof console?"undefined":n(console))&&console.warn&&console.warn.apply(console,t)}function i(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function o(t){if(t.type)switch(t.type){case"Point":return[t.coordinates[0],t.coordinates[1],t.coordinates[0],t.coordinates[1]];case"MultiPoint":case"LineString":return a(t.coordinates);case"MultiLineString":case"Polygon":return s(t.coordinates);case"MultiPolygon":return r(t.coordinates);case"Feature":return t.geometry?o(t.geometry):null;case"FeatureCollection":return l(t);case"GeometryCollection":return c(t);default:throw new Error("Unknown type: "+t.type)}return null}function s(t){for(var e=null,n=null,i=null,o=null,s=0;s<t.length;s++)for(var r=t[s],a=0;a<r.length;a++){var l=r[a],c=l[0],u=l[1];null===e?e=c:e>c&&(e=c),null===n?n=c:c>n&&(n=c),null===i?i=u:i>u&&(i=u),null===o?o=u:u>o&&(o=u)}return[e,i,n,o]}function r(t){for(var e=null,n=null,i=null,o=null,s=0;s<t.length;s++)for(var r=t[s],a=0;a<r.length;a++)for(var l=r[a],c=0;c<l.length;c++){var u=l[c],h=u[0],p=u[1];null===e?e=h:e>h&&(e=h),null===n?n=h:h>n&&(n=h),null===i?i=p:i>p&&(i=p),null===o?o=p:p>o&&(o=p)}return[e,i,n,o]}function a(t){for(var e=null,n=null,i=null,o=null,s=0;s<t.length;s++){var r=t[s],a=r[0],l=r[1];null===e?e=a:e>a&&(e=a),null===n?n=a:a>n&&(n=a),null===i?i=l:i>l&&(i=l),null===o?o=l:l>o&&(o=l)}return[e,i,n,o]}function l(t){for(var e,n=[],i=t.features.length-1;i>=0;i--)e=o(t.features[i].geometry),n.push([e[0],e[1]]),n.push([e[2],e[3]]);return a(n)}function c(t){for(var e,n=[],i=t.geometries.length-1;i>=0;i--)e=o(t.geometries[i]),n.push([e[0],e[1]]),n.push([e[2],e[3]]);return a(n)}function u(t){var e=o(t);return{x:e[0],y:e[1],w:Math.abs(e[0]-e[2]),h:Math.abs(e[1]-e[3])}}function h(t){return t*G}function p(t){return t*q}function d(t,e){for(var i=0;i<t.length;i++)"number"==typeof t[i][0]&&(t[i]=e(t[i])),"object"==n(t[i])&&(t[i]=d(t[i],e));return t}function f(t){var e=t[0],n=t[1];return[h(e/W)-360*Math.floor((h(e/W)+180)/360),h(Math.PI/2-2*Math.atan(Math.exp(-1*n/W)))]}function m(t){var e=t[0],n=Math.max(Math.min(t[1],89.99999),-89.99999);return[p(e)*W,W/2*Math.log((1+Math.sin(p(n)))/(1-Math.sin(p(n))))]}function _(t,e,n){if("Point"===t.type)t.coordinates=e(t.coordinates);else if("Feature"===t.type)t.geometry=_(t.geometry,e,!0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)t.features[i]=_(t.features[i],e,!0);else if("GeometryCollection"===t.type)for(var o=0;o<t.geometries.length;o++)t.geometries[o]=_(t.geometries[o],e,!0);else t.coordinates=d(t.coordinates,e);return n||e===m&&(t.crs=$),e===f&&delete t.crs,t}function g(t){return _(t,m)}function v(t){return _(t,f)}function y(t,e){return t[0]>e[0]?-1:t[0]<e[0]?1:t[1]>e[1]?-1:t[1]<e[1]?1:0}function P(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function w(t){var e,n,i=0,o=[];for(t=t.sort(y),e=0;e<t.length;++e){for(;i>=2&&P(o[i-2],o[i-1],t[e])<=0;)--i;o[i++]=t[e]}for(e=t.length-2,n=i+1;e>=0;--e){for(;i>=n&&P(o[i-2],o[i-1],t[e])<=0;)--i;o[i++]=t[e]}return o}function b(t){for(var e,n=0;n<t.length-3;n++){var i=t[n],o=t[n+1],s=t[n+2],r=[o[0]-i[0],o[1]-i[1]],a=s[0]*r[1]-s[1]*r[0]+r[0]*i[1]-r[1]*i[0];if(0===n)e=0>a;else if(e&&a>0||!e&&0>a)return!1}return!0}function T(t,e){for(var n=!1,i=-1,o=t.length,s=o-1;++i<o;s=i)(t[i][1]<=e[1]&&e[1]<t[s][1]||t[s][1]<=e[1]&&e[1]<t[i][1])&&e[0]<(t[s][0]-t[i][0])*(e[1]-t[i][1])/(t[s][1]-t[i][1])+t[i][0]&&(n=!n);return n}function L(t,e){if(t&&t.length){if(1===t.length)return T(t[0],e);if(T(t[0],e)){for(var n=1;n<t.length;n++)if(T(t[n],e))return!1;return!0}return!1}return!1}function S(t,e,n,i){var o=(i[0]-n[0])*(t[1]-n[1])-(i[1]-n[1])*(t[0]-n[0]),s=(e[0]-t[0])*(t[1]-n[1])-(e[1]-t[1])*(t[0]-n[0]),r=(i[1]-n[1])*(e[0]-t[0])-(i[0]-n[0])*(e[1]-t[1]);if(0!==r){var a=o/r,l=s/r;if(a>=0&&1>=a&&l>=0&&1>=l)return!0}return!1}function x(t){return!isNaN(parseFloat(t))&&isFinite(t)}function E(t,e){if(x(t[0][0])){if(x(e[0][0])){for(var n=0;n<t.length-1;n++)for(var i=0;i<e.length-1;i++)if(S(t[n],t[n+1],e[i],e[i+1]))return!0}else for(var o=0;o<e.length;o++)if(E(t,e[o]))return!0}else for(var s=0;s<t.length;s++)if(E(t[s],e))return!0;return!1}function C(t){for(var e=[],n=0;n<t.length;n++){var i=t[n].slice();!1===M(i[0],i[i.length-1])&&i.push(i[0]),e.push(i)}return e}function M(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function O(t,e){if(t.length!==e.length)return!1;for(var n=t.slice().sort(y),i=e.slice().sort(y),o=0;o<n.length;o++){if(n[o].length!==i[o].length)return!1;for(var s=0;s<n.length;s++)if(n[o][s]!==i[o][s])return!1}return!0}function D(t){if(t)switch(t.type){case"Point":return new k(t);case"MultiPoint":return new I(t);case"LineString":return new N(t);case"MultiLineString":return new A(t);case"Polygon":return new B(t);case"MultiPolygon":return new U(t);case"Feature":return new z(t);case"FeatureCollection":return new R(t);case"GeometryCollection":return new F(t);default:throw new Error("Unknown type: "+t.type)}}function k(e){var n=Array.prototype.slice.call(arguments);if(e&&"Point"===e.type&&e.coordinates)i(this,e);else if(e&&t(e))this.coordinates=e;else{if(!(n.length>=2))throw"Terraformer: invalid input for Terraformer.Point";this.coordinates=n}this.type="Point"}function I(e){if(e&&"MultiPoint"===e.type&&e.coordinates)i(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.MultiPoint";this.coordinates=e}this.type="MultiPoint"}function N(e){if(e&&"LineString"===e.type&&e.coordinates)i(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.LineString";this.coordinates=e}this.type="LineString"}function A(e){if(e&&"MultiLineString"===e.type&&e.coordinates)i(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.MultiLineString";this.coordinates=e}this.type="MultiLineString"}function B(e){if(e&&"Polygon"===e.type&&e.coordinates)i(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.Polygon";this.coordinates=e}this.type="Polygon"}function U(e){if(e&&"MultiPolygon"===e.type&&e.coordinates)i(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.MultiPolygon";this.coordinates=e}this.type="MultiPolygon"}function z(t){if(t&&"Feature"===t.type)i(this,t);else{if(!(t&&t.type&&t.coordinates))throw"Terraformer: invalid input for Terraformer.Feature";this.geometry=t}this.type="Feature"}function R(e){if(e&&"FeatureCollection"===e.type&&e.features)i(this,e);else{if(!t(e))throw"Terraformer: invalid input for Terraformer.FeatureCollection";this.features=e}this.type="FeatureCollection"}function F(e){if(e&&"GeometryCollection"===e.type&&e.geometries)i(this,e);else if(t(e))this.geometries=e;else{if(!e.coordinates||!e.type)throw"Terraformer: invalid input for Terraformer.GeometryCollection";this.type="GeometryCollection",this.geometries=[e]}this.type="GeometryCollection"}function H(t,e,n){for(var i=m(t),o=n||64,s={type:"Polygon",coordinates:[[]]},r=1;o>=r;r++){var a=r*(360/o)*Math.PI/180;s.coordinates[0].push([i[0]+e*Math.cos(a),i[1]+e*Math.sin(a)])}return s.coordinates=C(s.coordinates),v(s)}function Z(t,e,n){var o=n||64,s=e||250;if(!t||t.length<2||!s||!o)throw new Error("Terraformer: missing parameter for Terraformer.Circle");i(this,new z({type:"Feature",geometry:H(t,s,o),properties:{radius:s,center:t,steps:o}}))}var V={},W=6378137,G=57.29577951308232,q=.017453292519943,$={type:"link",properties:{href:"http://spatialreference.org/ref/sr-org/6928/ogcwkt/",type:"ogcwkt"}},J={type:"link",properties:{href:"http://spatialreference.org/ref/epsg/4326/ogcwkt/",type:"ogcwkt"}},Q=["length"];return D.prototype.toMercator=function(){return g(this)},D.prototype.toGeographic=function(){return v(this)},D.prototype.envelope=function(){return u(this)},D.prototype.bbox=function(){return o(this)},D.prototype.convexHull=function(){var t,e,n=[];if("Point"===this.type)return null;if("LineString"===this.type||"MultiPoint"===this.type){if(!(this.coordinates&&this.coordinates.length>=3))return null;n=this.coordinates}else if("Polygon"===this.type||"MultiLineString"===this.type){if(!(this.coordinates&&this.coordinates.length>0))return null;for(t=0;t<this.coordinates.length;t++)n=n.concat(this.coordinates[t]);if(n.length<3)return null}else if("MultiPolygon"===this.type){if(!(this.coordinates&&this.coordinates.length>0))return null;for(t=0;t<this.coordinates.length;t++)for(e=0;e<this.coordinates[t].length;e++)n=n.concat(this.coordinates[t][e]);if(n.length<3)return null}else if("Feature"===this.type){var i=new D(this.geometry);return i.convexHull()}return new B({type:"Polygon",coordinates:C([w(n)])})},D.prototype.toJSON=function(){var t={};for(var e in this)this.hasOwnProperty(e)&&-1===Q.indexOf(e)&&(t[e]=this[e]);return t.bbox=o(this),t},D.prototype.contains=function(t){return new D(t).within(this)},D.prototype.within=function(t){var e,n,i;if("Point"===t.type&&"Point"===this.type)return M(this.coordinates,t.coordinates);if("MultiLineString"===t.type&&"Point"===this.type)for(n=0;n<t.coordinates.length;n++){var o={type:"LineString",coordinates:t.coordinates[n]};if(this.within(o))return!0}if(("LineString"===t.type||"MultiPoint"===t.type)&&"Point"===this.type)for(n=0;n<t.coordinates.length;n++){if(this.coordinates.length!==t.coordinates[n].length)return!1;if(M(this.coordinates,t.coordinates[n]))return!0}if("Polygon"===t.type){if("Polygon"===this.type){if(t.coordinates.length===this.coordinates.length)for(n=0;n<this.coordinates.length;n++)if(O(this.coordinates[n],t.coordinates[n]))return!0;return!(!this.coordinates.length||!L(t.coordinates,this.coordinates[0][0]))&&!E(C(this.coordinates),C(t.coordinates))}if("Point"===this.type)return L(t.coordinates,this.coordinates);if("LineString"===this.type||"MultiPoint"===this.type){if(!this.coordinates||0===this.coordinates.length)return!1;for(n=0;n<this.coordinates.length;n++)if(!1===L(t.coordinates,this.coordinates[n]))return!1;return!0}if("MultiLineString"===this.type){for(n=0;n<this.coordinates.length;n++){if(!1===new N(this.coordinates[n]).within(t))return i++,!1}return!0}if("MultiPolygon"===this.type){for(n=0;n<this.coordinates.length;n++){if(!1===new D({type:"Polygon",coordinates:this.coordinates[n]}).within(t))return!1}return!0}}if("MultiPolygon"===t.type){if("Point"===this.type){if(t.coordinates.length)for(n=0;n<t.coordinates.length;n++)if(e=t.coordinates[n],L(e,this.coordinates)&&!1===E([this.coordinates],t.coordinates))return!0;return!1}if("Polygon"===this.type){for(n=0;n<this.coordinates.length;n++)if(t.coordinates[n].length===this.coordinates.length)for(j=0;j<this.coordinates.length;j++)if(O(this.coordinates[j],t.coordinates[n][j]))return!0;if(!1===E(this.coordinates,t.coordinates)&&t.coordinates.length){for(n=0;n<t.coordinates.length;n++)e=t.coordinates[n],i=!1!==L(e,this.coordinates[0][0]);return i}}else if("LineString"===this.type||"MultiPoint"===this.type)for(n=0;n<t.coordinates.length;n++){var s={type:"Polygon",coordinates:t.coordinates[n]};return!!this.within(s)}else{if("MultiLineString"===this.type){for(n=0;n<this.coordinates.length;n++){var r=new N(this.coordinates[n]);if(!1===r.within(t))return!1}return!0}if("MultiPolygon"===this.type){for(n=0;n<t.coordinates.length;n++){var a={type:"Polygon",coordinates:t.coordinates[n]};if(!1===this.within(a))return!1}return!0}}}return!1},D.prototype.intersects=function(t){"Feature"===t.type&&(t=t.geometry);var n=new D(t);if(this.within(t)||n.within(this))return!0;if("Point"!==this.type&&"MultiPoint"!==this.type&&"Point"!==t.type&&"MultiPoint"!==t.type)return E(this.coordinates,t.coordinates);if("Feature"===this.type){return new D(this.geometry).intersects(t)}return e("Type "+this.type+" to "+t.type+" intersection is not supported by intersects"),!1},k.prototype=new D,k.prototype.constructor=k,I.prototype=new D,I.prototype.constructor=I,I.prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates]);return this},I.prototype.addPoint=function(t){return this.coordinates.push(t),this},I.prototype.insertPoint=function(t,e){return this.coordinates.splice(e,0,t),this},I.prototype.removePoint=function(t){return"number"==typeof t?this.coordinates.splice(t,1):this.coordinates.splice(this.coordinates.indexOf(t),1),this},I.prototype.get=function(t){return new k(this.coordinates[t])},N.prototype=new D,N.prototype.constructor=N,N.prototype.addVertex=function(t){return this.coordinates.push(t),this},N.prototype.insertVertex=function(t,e){return this.coordinates.splice(e,0,t),this},N.prototype.removeVertex=function(t){return this.coordinates.splice(t,1),this},A.prototype=new D,A.prototype.constructor=A,A.prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates])},A.prototype.get=function(t){return new N(this.coordinates[t])},B.prototype=new D,B.prototype.constructor=B,B.prototype.addVertex=function(t){return this.coordinates[0].push(t),this},B.prototype.insertVertex=function(t,e){return this.coordinates[0].splice(e,0,t),this},B.prototype.removeVertex=function(t){return this.coordinates[0].splice(t,1),this},B.prototype.close=function(){this.coordinates=C(this.coordinates)},U.prototype=new D,U.prototype.constructor=U,U.prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates])},U.prototype.get=function(t){return new B(this.coordinates[t])},U.prototype.close=function(){var t=[];return this.forEach(function(e){t.push(C(e))}),this.coordinates=t,this},z.prototype=new D,z.prototype.constructor=z,R.prototype=new D,R.prototype.constructor=R,R.prototype.forEach=function(t){for(var e=0;e<this.features.length;e++)t.apply(this,[this.features[e],e,this.features])},R.prototype.get=function(t){var e;return this.forEach(function(n){n.id===t&&(e=n)}),new z(e)},F.prototype=new D,F.prototype.constructor=F,F.prototype.forEach=function(t){for(var e=0;e<this.geometries.length;e++)t.apply(this,[this.geometries[e],e,this.geometries])},F.prototype.get=function(t){return new D(this.geometries[t])},Z.prototype=new D,Z.prototype.constructor=Z,Z.prototype.recalculate=function(){return this.geometry=H(this.properties.center,this.properties.radius,this.properties.steps),this},Z.prototype.center=function(t){return t&&(this.properties.center=t,this.recalculate()),this.properties.center},Z.prototype.radius=function(t){return t&&(this.properties.radius=t,this.recalculate()),this.properties.radius},Z.prototype.steps=function(t){return t&&(this.properties.steps=t,this.recalculate()),this.properties.steps},Z.prototype.toJSON=function(){return D.prototype.toJSON.call(this)},V.Primitive=D,V.Point=k,V.MultiPoint=I,V.LineString=N,V.MultiLineString=A,V.Polygon=B,V.MultiPolygon=U,V.Feature=z,V.FeatureCollection=R,V.GeometryCollection=F,V.Circle=Z,V.toMercator=g,V.toGeographic=v,V.Tools={},V.Tools.positionToMercator=m,V.Tools.positionToGeographic=f,V.Tools.applyConverter=_,V.Tools.toMercator=g,V.Tools.toGeographic=v,V.Tools.createCircle=H,V.Tools.calculateBounds=o,V.Tools.calculateEnvelope=u,V.Tools.coordinatesContainPoint=T,V.Tools.polygonContainsPoint=L,V.Tools.arraysIntersectArrays=E,V.Tools.coordinatesContainPoint=T,V.Tools.coordinatesEqual=O,V.Tools.convexHull=w,V.Tools.isConvex=b,V.MercatorCRS=$,V.GeographicCRS=J,V})}).call(e,n(18)(t))},69:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o={cssSels:{Main:{slider:".js-compare__separator",compareRegion:".js-compare__item",compareContent:".js-compare__size",sliding:".js-compare__sliding"}},cssClss:{animated:"compare__item_animated"},startOffset:"50",isVertical:!1},s=function(){function t(t,e){t.removeClass(e),this._state.animated=!1,this._swipe.pause(!1)}function i(t){return{x:t.pageX||t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.body.scrollTop+document.documentElement.scrollTop}}function o(t){if(!this._state.animated){if(!this._state.click)return void(this._state.click=!0);var e=this._elems.compareRegion.eq(0),n=this._opts.cssClss.animated;n&&(e.addClass(n).one(u,this.onAnimationEnd),this._swipe.pause(!0),this._state.animated=!0),r.call(this,i(t.originalEvent||t)[this._opts.isVertical?"y":"x"])}}function s(t,e){this._elems.sliding[t](e+"%")}function r(t){var n,i,o,r=!this._opts.isVertical,a=this._elems.parent,l=this.getOffset();r?(n="width",l=l.left):(n="height",l=l.top),i=a[n](),o=Math.min((t-l)/i*100,100),o==this._state.offset&&e.requestAnimationFrame(this.onAnimationEnd),this._state.offset=o,s.call(this,n,o)}function a(){this._elems.compareContent.css({width:"",height:""}),this._elems.parent.height(""),this._elems.sliding[this._opts.isVertical?"height":"width"]("")}function l(){a.call(this);for(var t,e,n,i,o=!this._opts.isVertical,s=this._elems.compareRegion.get(0).getBoundingClientRect(),r=this._elems.compareRegion.get(1).getBoundingClientRect(),l=this._elems.parent,c=["width","height"],u=0;u<c.length;u++)i=0===u,e=c[u],t=i===o,n=Math[t?"min":"max"](r[e],s[e],l[e]()),!i&&o?l[e](n):this._elems.compareContent[e](n)}function c(){var t=this._opts.isVertical?1:0;this._swipe=n.Tools.initModule("Swipe",this._elems.parent,{targetAxis:this._opts.isVertical?"y":"x",resetDelta:!0,_Handlers:{start:function(e,n){this._state.startFrom=n.from[t]}.bind(this),move:function(e){r.call(this,this._state.startFrom+e[t])}.bind(this),end:function(){this._state.startFrom=null,this._state.click=!1}.bind(this)}})}var u="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend";return{_Handlers:{dom:{"resize:window":function(){this.fixSizes()},click:o}},_Init:function(){var n=this._elems.compareRegion,i=this._opts.cssClss.animated;2!==n.length&&e.console.error("Wrong compare elems count"),i&&(this.onAnimationEnd=t.bind(this,n.eq(0),i)),this._state={animated:!1,startFrom:null,click:!0,offset:this._opts.startOffset};var o=n.find("img");o.length?Promise.all(o.toArray().map(function(t){return!0===t.complete?Promise.resolve():new Promise(function(e,n){t.onload=e,t.onerror=n})})).then(this.fixSizes.bind(this)):this.fixSizes.call(this),c.call(this)},getOffset:function(){var t=this._elems.parent.get(0).getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},fixSizes:function(){l.call(this),s.call(this,this._opts.isVertical?"height":"width",this._state.offset)}}}(),r=i.getView(s,o,null,"CompareSlider");n.Basic.moduleOpts.setParams("CompareSlider",{paramAttrs:{startOffset:"data-startfrom",isVertical:"data-vertical"}}),i.Extend(e.getNameSpace("Modules",n),{CompareSlider:r})}(window.jQuery||window.$,window,window.ru.mail.cpf)},7:function(t,e,n){"use strict";function i(){return new Promise(function(t){for(var e=0,n=h;e<n.length;e++){(0,n[e])()}t(a({},u))})}function o(t){return a({},u[t])}function s(t,e){var n=function(){u[t]=a({},e)};return h.push(n),n}function r(t){for(var e=t.split(c.COMPONENT_NS_DELIMITER),n=e[0],i=e.slice(1),s={},r=0,a=i;r<a.length;r++){var u=a[r];s=l.deepMerge({},s,o(n)),n=""+n+c.COMPONENT_NS_DELIMITER+u}return l.deepMerge({},s,o(n))}var a=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var l=n(2),c=n(1),u={},h=[];e.resolveConfigSetters=i,e.getConfig=o,e.setConfig=s,e.getConfigCollapsed=r},70:function(t,e){!function(t,e,n){var i,o=n.Basic,s=o.typeOf,r=n.Comp,a=r.Methods.initCallbacks,l=o.getConstructor(function(){function n(){var t=this._Opts;this._Elems.jBar.on(P.mousedown,t.cssSels.scrollThumbBody,o.bind(this)).on("click",u.bind(this))}function o(e){var n=e.originalEvent.changedTouches;if(!(n&&n.length>1)){var o=this._Opts.cssSels,s=y[!0===this._Opts.Vertical?1:0],a=s.position,l=t(e.target),u=l.parents(o.scrollThumb),h=u.offset(),p=l.position(),d=n?n[0]:e,m=d[s.cursorPos]-h[a]-p[s.position];f.call(this),this._dragEnd=!1,i.on(P.mousemove+".scrollBar",r.bind(this,{jElem:u,jBody:l,iPosDiff:m,Dimensions:s,Index:u.index()})).on(P.mouseup+".scrollBar",c.bind(this)),e.preventDefault()}}function r(t,e){var n=e.originalEvent.changedTouches,i=n?n[0]:e,o=this._Sizes,r=this._Timers,a=this._Opts.onBeforeMove,l=t.Index,c=t.Dimensions,u=t.jBody,p=u.position(),f=t.iPosDiff+p[c.position],m=i[c.cursorPos]-o.barOffset-f;m=_(m,o.barSize),s(a,"function")&&(m=a.call(this,m,t)),r.setPosition||(r.setPosition=setTimeout(function(){r.setPosition=null,h(t,c,m)},1)),e.preventDefault(),this._Positions[l]=m,this._fire("drag",[d.call(this)])}function c(e){i.off(".scrollBar"),this._fire("change",[d.call(this)]),t(e.target).closest(this._Elems.jBar).length>0&&(this._dragEnd=!0)}function u(e){var n=this._Opts,i=n.cssSels,o=i.scrollThumbBody,r=this._Opts.onBeforeMove;if(t(e.target).closest(i.scrollThumbBody).length>0||this._dragEnd)return void(this._dragEnd=!1);var a,l,c,u,h=this._Positions,m=y[!0===n.Vertical?1:0],g=null,v=null;f.call(this),a=this._Sizes,l=_(e[m.cursorPos]-a.barOffset,a.barSize),s(r,"function")&&(l=r.call(this,l,null));for(var P=h.length;P--;)c=Math.abs(h[P]-l),(null===g||c<g)&&(g=c,v=P);null!==v&&g>0&&(u=this._Elems.jBar.find(i.scrollThumb).eq(v),p.call(this,{jElem:u,jBody:u.find(o),Index:v},m,l),this._fire("change",[d.call(this)]))}function h(t,e,n){t.jElem.get(0).style[e.position]=n+"%",t.jBody.get(0).style[e.position]=-n+"%"}function p(t,e,n){this._Positions[t.Index]=n,h(t,e,n)}function d(){var t=this._Positions,e=[].concat(t);return 1==e.length?e[0]:e}function f(){var t=this._Sizes,e=this._Elems.jBar,n=y[!0===this._Opts.Vertical?1:0],i=e.offset();t.barOffset=i[n.position],t.barSize=e[n.size]()}function m(){var e=this._Sizes,n=this._Elems.jBar,i=this._Positions,o=y[!0===this._Opts.Vertical?1:0];n.find(this._Opts.cssSels.scrollThumb).each(function(n){var s=t(this);i[n]=_(s.position()[o.position],e.barSize)}),this._fire("change",[d.call(this)])}function _(t,e){return 0===e?0:(t=Math.floor(t/e*1e4)/100,Math.max(0,Math.min(100,t)))}function g(){for(var t in P)P.hasOwnProperty(t)&&(P[t]=t)}function v(){return"ontouchstart"in e||"ontouchend"in document||"createTouch"in document}var y=[{size:"width",cursorPos:"pageX",margin:"marginLeft",position:"left"},{size:"height",cursorPos:"pageY",margin:"marginTop",position:"top"}],P={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"," ":" touchcancel"},w={cssSels:{scrollThumb:null,scrollThumbBody:null},Vertical:!1,onChange:null,onDrag:null,onBeforeMove:null};return{_Init:function(o,s){var r,c=o.data("_scrollBar");if(i=t(e.document.body),c instanceof l)return c;o.data("_scrollBar",this),this._Opts=r=t.extend(!0,{},w,s),this._Elems={jBar:o},this._Sizes={},this._Positions=[],this._Timers={},this._bTouch=v(),this._dragEnd=!1,f.call(this),a.call(this,{Types:{change:r.onChange,drag:r.onDrag}}),m.call(this),this._bTouch||g(),n.call(this)},setPositionVals:function(t){var e,n,i,o=this._Opts,r=this._Positions,a=o.cssSels,l=o.onBeforeMove,c=this._Elems.jBar.find(a.scrollThumb),u=y[!0===o.Vertical?1:0];s(t,"number")&&(t=[t]);for(var h=0;h<t.length;h++)e=t[h],s(e,"number")&&(e=Math.max(0,Math.min(100,Math.round(100*e)/100)),n=c.eq(h),i={jElem:n,jBody:n.find(a.scrollThumbBody),Index:h},s(l,"function")&&(e=l.call(this,e,null)),r[h]!==e&&(p.call(this,i,u,e),this._fire("change",[d.call(this)])))},getPositionVals:d,getBarElement:function(){return this._Elems.jBar},getThumbElement:function(){return this._Elems.jBar.find(this._Opts.cssSels.scrollThumb)}}}());o.Extend(e.getNameSpace("Comp.jQuery.Modules",n),{scrollBar:l}),t.fn.scrollBar=function(e){return this.each(function(){l(t(this),e)})}}(window.jQuery,window,window.ru.mail.cpf)},71:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o=i.typeOf,s=n.Comp.jQuery,r=s.Tools,a=r.winHndlrs.attach,l=s.Modules.scrollBar,c={cssSels:{Main:{scrollBar:null,scrollView:null},scrollBar:{scrollThumb:null,scrollThumbBody:null},scrollThumbSize:null},overflow:"auto",Attrs:{Orientation:"data-type"},disabledScrollBody:{mouse:!1,touch:!1}},u=i.Constructors.getView(function(){function n(){var t=this._elems.scrollBar,e=this._Opts,n=this._scrollBars,o=e.cssSels.scrollBar,s=e.Attrs.Orientation;t.each(function(e){var r=t.eq(e),a="vertical"==r.attr(s)||r.width()<r.height(),c=i.bind(this,a),u=l(r,{cssSels:o,Vertical:a,onDrag:c,onChange:c});n[a?1:0]=u}.bind(this))}function i(t,e){s.call(this,t,e)}function s(t,e){var n,i=t?1:0,s=g[i].scroll,a=this._Sizes[i],l=this._State;o(a,"undefined")||(n=Math.round(a.scrollDiff*e/100),l[t?"scrollY":"scrollX"]=n,this._elems.scrollView[s](n),r.call(this))}function r(){var t=this._State;this._trigger("scroll",{type:"scroll",scrollX:t.scrollX,scrollY:t.scrollY,scrollMaxX:t.scrollMaxX,scrollMaxY:t.scrollMaxY})}function c(){for(var t,e,n,i,o,s,r=this._Sizes,a=this._scrollBars,l=this._elems.scrollView,c=g.length;c--;){t=g[c],e=a[c],e&&(n=e.getBarElement()),(i=r[c])||(i=r[c]={});for(var u in t)if(t.hasOwnProperty(u)){if(o=t[u],/cursorPos|axisName/.test(u))continue;"size"==u?n&&n.length&&(s=n[o]()):s="scrollSize"==u?l.prop(o):l[o](),i[u]=s}i.scrollDiff=i.scrollSize-i.innerSize,this._State["scrollMax"+t.axisName.toUpperCase()]=i.scrollDiff}}function u(e,n){var i="scroll"!=this._Opts.overflow?e.getBarElement():e.getThumbElement();i.toggle(o(n,"boolean")?n:!t(i).is(":visible"))}function h(){for(var t,e,n,i,o,s,r=this._scrollBars,a=this._Sizes,l=this._Opts.cssSels.scrollThumbSize,c=a.length;c--;)(n=r[c])&&(e=n.getBarElement(),t=a[c],i=t.scrollDiff,o=i>0,u.call(this,n,o),s=Math.round(t.size*(1-i/t.scrollSize)*100)/100,e.find(l)[g[c].size](s))}function p(t,e,n,i,o){var s,r,a,l,c,u,h;n.scrollDiff>0&&(s=t.originalEvent,o?c=s.wheelDelta||t.wheelDelta||-s.deltaY:(l=this._State,h=g[i].cursorPos,u=s.changedTouches[0][h],c=u-l[h],l[h]=u),r=e.getPositionVals(),a=c/n.scrollSize*100,(0===r?a<0:100!==r||a>0)&&(e.setPositionVals(r-a),t.preventDefault()))}function d(t){var e=this._scrollBars[1];e&&p.call(this,t,e,this._Sizes[1],1,!0),this._opts.disabledScrollBody.mouse&&(event.returnValue=!1)}function f(t){if(!this._preventScroll){var e,n,i,o,s,r=t.originalEvent.changedTouches;if(!(r&&r.length>1)){for(n=this._Sizes,e=this._scrollBars,o=0,s=e.length;o<s;o++)(i=e[o])&&p.call(this,t,i,n[o],o);this._opts.disabledScrollBody.touch&&(event.returnValue=!1)}}}function m(){var n,i=this,o=this.Resize.bind(this),s=this._elems,r=s.scrollView;a(null,o),r.on("mousewheel wheel DOMMouseScroll",d.bind(this)),("ontouchstart"in e||"ontouchend"in document||"createTouch"in document)&&(s.body=n=t(e.document.body),r.on("touchstart",function(e){var o,s,r=e.originalEvent.changedTouches;r&&r.length>1||(o=r[0],s=i._State,s.pageX=o.pageX,s.pageY=o.pageY,n.on("touchmove",f.bind(i)).on("touchend",function(){t(this).off("touchmove")}))})),s.parent.on("documentHeightChange",o),s.parent.on("scrollChange",o)}function _(){for(var t,e,n,i,o,s=this._scrollBars,r=this._Sizes,a=this._elems.scrollView,l=r.length;l--;)(n=s[l])&&(t=g[l],e=r[l],i=e.scrollDiff,o=0===i?e.scrollDiff:a[t.scroll]()/e.scrollDiff*100,o=n.setPositionVals(o))}var g=[{size:"width",scroll:"scrollLeft",scrollSize:"scrollWidth",innerSize:"innerWidth",cursorPos:"pageX",axisName:"x"},{size:"height",scroll:"scrollTop",scrollSize:"scrollHeight",innerSize:"innerHeight",cursorPos:"pageY",axisName:"y"}];return{_Events:["scroll"],_Init:function(){this._scrollBars=[],this._Sizes=[],this._State={scrollX:0,scrollY:0,scrollMaxX:0,scrollMaxY:0},n.call(this),c.call(this),h.call(this),_.call(this),m.call(this),this._elems.parent.data("_customScroll",this)},Resize:function(){c.call(this),h.call(this),_.call(this)},setScrollsPos:function(t,e){for(var n,i,o=this._scrollBars,s=this._Sizes,r=o.length;r--;)(n=o[r])&&(i=Array.isArray(t)?t[r]:t,!0===e&&(i=i/s[r].scrollDiff*100),n.setPositionVals(i))},toggleScroll:function(t){var e="boolean"==typeof t?t:this._preventScroll;this._preventScroll=!e}}}(),c,null,"CustomScroll");e.getNameSpace("Modules",n).CustomScroll=u,t.fn.customScroll=function(e){return this.each(function(){var i=t(this),o=i.data(),s=o.CustomScroll||o._customScroll;if(s instanceof u)return s;i.data("_customScroll",n.Tools.initModule("CustomScroll",i,e))})}}(window.jQuery,window,window.ru.mail.cpf)},88:function(t,e,n){(function(t){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(o,s){if("object"==i(t)&&"object"==i(t.exports)&&(e=t.exports=s(n(62))),"object"==("undefined"==typeof navigator?"undefined":i(navigator))){if(!o.Terraformer)throw new Error("Terraformer.WKT requires the core Terraformer library. http://github.com/esri/terraformer");o.Terraformer.WKT=s(o.Terraformer)}}(window,function(t){function e(t){this.data=[t],this.type="PointArray"}function n(t){this.data=t,this.type="Ring"}function i(t){this.data=[t],this.type="RingList"}function o(t){this.data=[t],this.type="PolygonList"}function s(e){var n;try{n=m.parse(e)}catch(t){throw Error("Unable to parse",t)}return t.Primitive(n)}function r(t){for(var e=[],n="",i=0;i<t.length;i++)e.push(t[i].join(" "));return n+="("+e.join(", ")+")"}function a(t){var e="POINT ";return void 0===t.coordinates||0===t.coordinates.length?e+="EMPTY":(3===t.coordinates.length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates.length&&(e+="ZM "),e+="("+t.coordinates.join(" ")+")")}function l(t){var e="LINESTRING ";return void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length?e+="EMPTY":(3===t.coordinates[0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0].length&&(e+="ZM "),e+=r(t.coordinates))}function c(t){var e="POLYGON ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+="EMPTY";3===t.coordinates[0][0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++)n.push(r(t.coordinates[i]));return e+=n.join(", "),e+=")"}function u(t){var e="MULTIPOINT ";return void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length?e+="EMPTY":(3===t.coordinates[0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0].length&&(e+="ZM "),e+=r(t.coordinates))}function h(t){var e="MULTILINESTRING ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+="EMPTY";3===t.coordinates[0][0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++)n.push(r(t.coordinates[i]));return e+=n.join(", "),e+=")"}function p(t){var e="MULTIPOLYGON ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+="EMPTY";3===t.coordinates[0][0][0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0][0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++){for(var o="(",s=[],a=0;a<t.coordinates[i].length;a++)s.push(r(t.coordinates[i][a]));o+=s.join(", "),o+=")",n.push(o)}return e+=n.join(", "),e+=")"}function d(t){switch(t.type){case"Point":return a(t);case"LineString":return l(t);case"Polygon":return c(t);case"MultiPoint":return u(t);case"MultiLineString":return h(t);case"MultiPolygon":return p(t);default:throw Error("Unknown Type: "+t.type)}}var f={},m=function(){function t(){this.yy={}}var s={trace:function(){},yy:{},symbols_:{error:2,expressions:3,point:4,EOF:5,linestring:6,polygon:7,multipoint:8,multilinestring:9,multipolygon:10,coordinate:11,DOUBLE_TOK:12,ptarray:13,COMMA:14,ring_list:15,ring:16,"(":17,")":18,POINT:19,Z:20,ZM:21,M:22,EMPTY:23,point_untagged:24,polygon_list:25,polygon_untagged:26,point_list:27,LINESTRING:28,POLYGON:29,MULTIPOINT:30,MULTILINESTRING:31,MULTIPOLYGON:32,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"DOUBLE_TOK",14:"COMMA",17:"(",18:")",19:"POINT",20:"Z",21:"ZM",22:"M",23:"EMPTY",28:"LINESTRING",29:"POLYGON",30:"MULTIPOINT",31:"MULTILINESTRING",32:"MULTIPOLYGON"},productions_:[0,[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[11,2],[11,3],[11,4],[13,3],[13,1],[15,3],[15,1],[16,3],[4,4],[4,5],[4,5],[4,5],[4,2],[24,1],[24,3],[25,3],[25,1],[26,3],[27,3],[27,1],[6,4],[6,5],[6,5],[6,5],[6,2],[7,4],[7,5],[7,5],[7,5],[7,2],[8,4],[8,5],[8,5],[8,5],[8,2],[9,4],[9,5],[9,5],[9,5],[9,2],[10,4],[10,5],[10,5],[10,5],[10,2]],performAction:function(t,s,r,a,l,c){var u=c.length-1;switch(l){case 1:case 2:case 3:case 4:case 5:case 6:return c[u-1];case 7:this.$=new e([Number(c[u-1]),Number(c[u])]);break;case 8:this.$=new e([Number(c[u-2]),Number(c[u-1]),Number(c[u])]);break;case 9:this.$=new e([Number(c[u-3]),Number(c[u-2]),Number(c[u-1]),Number(c[u])]);break;case 10:this.$=c[u-2].addPoint(c[u]);break;case 11:this.$=c[u];break;case 12:this.$=c[u-2].addRing(c[u]);break;case 13:this.$=new i(c[u]);break;case 14:this.$=new n(c[u-1]);break;case 15:this.$={type:"Point",coordinates:c[u-1].data[0]};break;case 16:this.$={type:"Point",coordinates:c[u-1].data[0],properties:{z:!0}};break;case 17:this.$={type:"Point",coordinates:c[u-1].data[0],properties:{z:!0,m:!0}};break;case 18:this.$={type:"Point",coordinates:c[u-1].data[0],properties:{m:!0}};break;case 19:this.$={type:"Point",coordinates:[]};break;case 20:this.$=c[u];break;case 21:this.$=c[u-1];break;case 22:this.$=c[u-2].addPolygon(c[u]);break;case 23:this.$=new o(c[u]);break;case 24:this.$=c[u-1];break;case 25:this.$=c[u-2].addPoint(c[u]);break;case 26:this.$=c[u];break;case 27:this.$={type:"LineString",coordinates:c[u-1].data};break;case 28:this.$={type:"LineString",coordinates:c[u-1].data,properties:{z:!0}};break;case 29:this.$={type:"LineString",coordinates:c[u-1].data,properties:{m:!0}};break;case 30:this.$={type:"LineString",coordinates:c[u-1].data,properties:{z:!0,m:!0}};break;case 31:this.$={type:"LineString",coordinates:[]};break;case 32:this.$={type:"Polygon",coordinates:c[u-1].toJSON()};break;case 33:this.$={type:"Polygon",coordinates:c[u-1].toJSON(),properties:{z:!0}};break;case 34:this.$={type:"Polygon",coordinates:c[u-1].toJSON(),properties:{m:!0}};break;case 35:this.$={type:"Polygon",coordinates:c[u-1].toJSON(),properties:{z:!0,m:!0}};break;case 36:this.$={type:"Polygon",coordinates:[]};break;case 37:this.$={type:"MultiPoint",coordinates:c[u-1].data};break;case 38:this.$={type:"MultiPoint",coordinates:c[u-1].data,properties:{z:!0}};break;case 39:this.$={type:"MultiPoint",coordinates:c[u-1].data,properties:{m:!0}};break;case 40:this.$={type:"MultiPoint",coordinates:c[u-1].data,properties:{z:!0,m:!0}};break;case 41:this.$={type:"MultiPoint",coordinates:[]};break;case 42:this.$={type:"MultiLineString",coordinates:c[u-1].toJSON()};break;case 43:this.$={type:"MultiLineString",coordinates:c[u-1].toJSON(),properties:{z:!0}};break;case 44:this.$={type:"MultiLineString",coordinates:c[u-1].toJSON(),properties:{m:!0}};break;case 45:this.$={type:"MultiLineString",coordinates:c[u-1].toJSON(),properties:{z:!0,m:!0}};break;case 46:this.$={type:"MultiLineString",coordinates:[]};break;case 47:this.$={type:"MultiPolygon",coordinates:c[u-1].toJSON()};break;case 48:this.$={type:"MultiPolygon",coordinates:c[u-1].toJSON(),properties:{z:!0}};break;case 49:this.$={type:"MultiPolygon",coordinates:c[u-1].toJSON(),properties:{m:!0}};break;case 50:this.$={type:"MultiPolygon",coordinates:c[u-1].toJSON(),properties:{z:!0,m:!0}};break;case 51:this.$={type:"MultiPolygon",coordinates:[]}}},table:[{3:1,4:2,6:3,7:4,8:5,9:6,10:7,19:[1,8],28:[1,9],29:[1,10],30:[1,11],31:[1,12],32:[1,13]},{1:[3]},{5:[1,14]},{5:[1,15]},{5:[1,16]},{5:[1,17]},{5:[1,18]},{5:[1,19]},{17:[1,20],20:[1,21],21:[1,22],22:[1,23],23:[1,24]},{17:[1,25],20:[1,26],21:[1,28],22:[1,27],23:[1,29]},{17:[1,30],20:[1,31],21:[1,33],22:[1,32],23:[1,34]},{17:[1,35],20:[1,36],21:[1,38],22:[1,37],23:[1,39]},{17:[1,40],20:[1,41],21:[1,43],22:[1,42],23:[1,44]},{17:[1,45],20:[1,46],21:[1,48],22:[1,47],23:[1,49]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{1:[2,4]},{1:[2,5]},{1:[2,6]},{11:51,12:[1,52],13:50},{17:[1,53]},{17:[1,54]},{17:[1,55]},{5:[2,19]},{11:58,12:[1,52],17:[1,59],24:57,27:56},{17:[1,60]},{17:[1,61]},{17:[1,62]},{5:[2,31]},{15:63,16:64,17:[1,65]},{17:[1,66]},{17:[1,67]},{17:[1,68]},{5:[2,36]},{11:58,12:[1,52],17:[1,59],24:57,27:69},{17:[1,70]},{17:[1,71]},{17:[1,72]},{5:[2,41]},{15:73,16:64,17:[1,65]},{17:[1,74]},{17:[1,75]},{17:[1,76]},{5:[2,46]},{17:[1,79],25:77,26:78},{17:[1,80]},{17:[1,81]},{17:[1,82]},{5:[2,51]},{14:[1,84],18:[1,83]},{14:[2,11],18:[2,11]},{12:[1,85]},{11:51,12:[1,52],13:86},{11:51,12:[1,52],13:87},{11:51,12:[1,52],13:88},{14:[1,90],18:[1,89]},{14:[2,26],18:[2,26]},{14:[2,20],18:[2,20]},{11:91,12:[1,52]},{11:58,12:[1,52],17:[1,59],24:57,27:92},{11:58,12:[1,52],17:[1,59],24:57,27:93},{11:58,12:[1,52],17:[1,59],24:57,27:94},{14:[1,96],18:[1,95]},{14:[2,13],18:[2,13]},{11:51,12:[1,52],13:97},{15:98,16:64,17:[1,65]},{15:99,16:64,17:[1,65]},{15:100,16:64,17:[1,65]},{14:[1,90],18:[1,101]},{11:58,12:[1,52],17:[1,59],24:57,27:102},{11:58,12:[1,52],17:[1,59],24:57,27:103},{11:58,12:[1,52],17:[1,59],24:57,27:104},{14:[1,96],18:[1,105]},{15:106,16:64,17:[1,65]},{15:107,16:64,17:[1,65]},{15:108,16:64,17:[1,65]},{14:[1,110],18:[1,109]},{14:[2,23],18:[2,23]},{15:111,16:64,17:[1,65]},{17:[1,79],25:112,26:78},{17:[1,79],25:113,26:78},{17:[1,79],25:114,26:78},{5:[2,15]},{11:115,12:[1,52]},{12:[1,116],14:[2,7],18:[2,7]},{14:[1,84],18:[1,117]},{14:[1,84],18:[1,118]},{14:[1,84],18:[1,119]},{5:[2,27]},{11:58,12:[1,52],17:[1,59],24:120},{18:[1,121]},{14:[1,90],18:[1,122]},{14:[1,90],18:[1,123]},{14:[1,90],18:[1,124]},{5:[2,32]},{16:125,17:[1,65]},{14:[1,84],18:[1,126]},{14:[1,96],18:[1,127]},{14:[1,96],18:[1,128]},{14:[1,96],18:[1,129]},{5:[2,37]},{14:[1,90],18:[1,130]},{14:[1,90],18:[1,131]},{14:[1,90],18:[1,132]},{5:[2,42]},{14:[1,96],18:[1,133]},{14:[1,96],18:[1,134]},{14:[1,96],18:[1,135]},{5:[2,47]},{17:[1,79],26:136},{14:[1,96],18:[1,137]},{14:[1,110],18:[1,138]},{14:[1,110],18:[1,139]},{14:[1,110],18:[1,140]},{14:[2,10],18:[2,10]},{12:[1,141],14:[2,8],18:[2,8]},{5:[2,16]},{5:[2,17]},{5:[2,18]},{14:[2,25],18:[2,25]},{14:[2,21],18:[2,21]},{5:[2,28]},{5:[2,29]},{5:[2,30]},{14:[2,12],18:[2,12]},{14:[2,14],18:[2,14]},{5:[2,33]},{5:[2,34]},{5:[2,35]},{5:[2,38]},{5:[2,39]},{5:[2,40]},{5:[2,43]},{5:[2,44]},{5:[2,45]},{14:[2,22],18:[2,22]},{14:[2,24],18:[2,24]},{5:[2,48]},{5:[2,49]},{5:[2,50]},{14:[2,9],18:[2,9]}],defaultActions:{14:[2,1],15:[2,2],16:[2,3],17:[2,4],18:[2,5],19:[2,6],24:[2,19],29:[2,31],34:[2,36],39:[2,41],44:[2,46],49:[2,51],83:[2,15],89:[2,27],95:[2,32],101:[2,37],105:[2,42],109:[2,47],117:[2,16],118:[2,17],119:[2,18],122:[2,28],123:[2,29],124:[2,30],127:[2,33],128:[2,34],129:[2,35],130:[2,38],131:[2,39],132:[2,40],133:[2,43],134:[2,44],135:[2,45],138:[2,48],139:[2,49],140:[2,50]},parseError:function(t){throw new Error(t)},parse:function(t){var e=this,n=[0],i=[null],o=[],s=this.table,r="",a=0,l=0,c=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;o.push(u);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,d,f,m,_,g,v,y,P,w={};;){if(f=n[n.length-1],this.defaultActions[f]?m=this.defaultActions[f]:((null===p||void 0===p)&&(p=function(){var t;return t=e.lexer.lex()||1,"number"!=typeof t&&(t=e.symbols_[t]||t),t}()),m=s[f]&&s[f][p]),void 0===m||!m.length||!m[0]){var b="";if(!c){P=[];for(g in s[f])this.terminals_[g]&&g>2&&P.push("'"+this.terminals_[g]+"'");b=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+P.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(b,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:u,expected:P})}}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+f+", token: "+p);switch(m[0]){case 1:n.push(p),i.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(m[1]),p=null,d?(p=d,d=null):(l=this.lexer.yyleng,r=this.lexer.yytext,a=this.lexer.yylineno,u=this.lexer.yylloc,c>0&&c--);break;case 2:if(v=this.productions_[m[1]][1],w.$=i[i.length-v],w._$={first_line:o[o.length-(v||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(v||1)].first_column,last_column:o[o.length-1].last_column},h&&(w._$.range=[o[o.length-(v||1)].range[0],o[o.length-1].range[1]]),void 0!==(_=this.performAction.call(w,r,l,a,this.yy,m[1],i,o)))return _;v&&(n=n.slice(0,-2*v),i=i.slice(0,-1*v),o=o.slice(0,-1*v)),n.push(this.productions_[m[1]][0]),i.push(w.$),o.push(w._$),y=s[n[n.length-2]][n[n.length-1]],n.push(y);break;case 3:return!0}}return!0}},r=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,n,i,o;this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),r=0;r<s.length&&(!(n=this._input.match(this.rules[s[r]]))||e&&!(n[0].length>e[0].length)||(e=n,i=r,this.options.flex));r++);return e?(o=e[0].match(/(?:\r\n?|\n).*/g),o&&(this.yylineno+=o.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-o[o.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,s[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return t.options={},t.performAction=function(t,e,n,i){switch(n){case 0:break;case 1:return 17;case 2:return 18;case 3:return 12;case 4:return 19;case 5:return 28;case 6:return 29;case 7:return 30;case 8:return 31;case 9:return 32;case 10:return 14;case 11:return 23;case 12:return 22;case 13:return 20;case 14:return 21;case 15:return 5;case 16:return"INVALID"}},t.rules=[/^(?:\s+)/,/^(?:\()/,/^(?:\))/,/^(?:-?[0-9]+(\.[0-9]+)?)/,/^(?:POINT\b)/,/^(?:LINESTRING\b)/,/^(?:POLYGON\b)/,/^(?:MULTIPOINT\b)/,/^(?:MULTILINESTRING\b)/,/^(?:MULTIPOLYGON\b)/,/^(?:,)/,/^(?:EMPTY\b)/,/^(?:M\b)/,/^(?:Z\b)/,/^(?:ZM\b)/,/^(?:$)/,/^(?:.)/],t.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],inclusive:!0}},t}();return s.lexer=r,t.prototype=s,s.Parser=t,new t}();return e.prototype.addPoint=function(t){return"PointArray"===t.type?this.data=this.data.concat(t.data):this.data.push(t),this},e.prototype.toJSON=function(){return this.data},n.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.data.length;e++)t.push(this.data.data[e]);return t},i.prototype.addRing=function(t){return this.data.push(t),this},i.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.length;e++)t.push(this.data[e].toJSON());return t.length,t},o.prototype.addPolygon=function(t){return this.data.push(t),this},o.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.length;e++)t=t.concat([this.data[e].toJSON()]);return t},f.parser=m,f.Parser=m.Parser,f.parse=s,f.convert=d,f})}).call(e,n(18)(t))},89:function(t,e,n){(function(t){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(n,i,o){var s=n.L,r={};r.version="0.7.7","object"==e(t)&&"object"==e(t.exports)?t.exports=r:"function"==typeof define&&define.amd&&define(r),r.noConflict=function(){return n.L=s,this},n.L=r,r.Util={extend:function(t){var e,n,i,o,s=Array.prototype.slice.call(arguments,1);for(n=0,i=s.length;i>n;n++){o=s[n]||{};for(e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}return t},bind:function(t,e){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,n||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(n){return n[e]=n[e]||++t,n[e]}}(),invokeEach:function(t,n,i){var o,s;if("object"==e(t)){s=Array.prototype.slice.call(arguments,3);for(o in t)n.apply(i,[o,t[o]].concat(s));return!0}return!1},limitExecByInterval:function(t,e,n){var i,o;return function s(){var r=arguments;return i?void(o=!0):(i=!0,setTimeout(function(){i=!1,o&&(s.apply(n,r),o=!1)},e),void t.apply(n,r))}},falseFn:function(){return!1},formatNum:function(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return r.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=r.extend({},t.options,e),t.options},getParamString:function(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var i=e[n];if(i===o)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var e,i,o=["webkit","moz","o","ms"];for(e=0;e<o.length&&!i;e++)i=n[o[e]+t];return i}function e(t){var e=+new Date,o=Math.max(0,16-(e-i));return i=e+o,n.setTimeout(t,o)}var i=0,o=n.requestAnimationFrame||t("RequestAnimationFrame")||e,s=n.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){n.clearTimeout(t)};r.Util.requestAnimFrame=function(t,i,s,a){return t=r.bind(t,i),s&&o===e?void t():o.call(n,t,a)},r.Util.cancelAnimFrame=function(t){t&&s.call(n,t)}}(),r.extend=r.Util.extend,r.bind=r.Util.bind,r.stamp=r.Util.stamp,r.setOptions=r.Util.setOptions,r.Class=function(){},r.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;i.constructor=e,e.prototype=i;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);t.statics&&(r.extend(e,t.statics),delete t.statics),t.includes&&(r.Util.extend.apply(null,[i].concat(t.includes)),delete t.includes),t.options&&i.options&&(t.options=r.extend({},i.options,t.options)),r.extend(i,t),i._initHooks=[];var s=this;return e.__super__=s.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){s.prototype.callInitHooks&&s.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;e>t;t++)i._initHooks[t].call(this)}},e},r.Class.include=function(t){r.extend(this.prototype,t)},r.Class.mergeOptions=function(t){r.extend(this.prototype.options,t)},r.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var a="_leaflet_events";r.Mixin={},r.Mixin.Events={addEventListener:function(t,e,n){if(r.Util.invokeEach(t,this.addEventListener,this,e,n))return this;var i,o,s,l,c,u,h,p=this[a]=this[a]||{},d=n&&n!==this&&r.stamp(n);for(t=r.Util.splitWords(t),i=0,o=t.length;o>i;i++)s={action:e,context:n||this},l=t[i],d?(c=l+"_idx",u=c+"_len",h=p[c]=p[c]||{},h[d]||(h[d]=[],p[u]=(p[u]||0)+1),h[d].push(s)):(p[l]=p[l]||[],p[l].push(s));return this},hasEventListeners:function(t){var e=this[a];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,n){if(!this[a])return this;if(!t)return this.clearAllEventListeners();if(r.Util.invokeEach(t,this.removeEventListener,this,e,n))return this;var i,o,s,l,c,u,h,p,d,f=this[a],m=n&&n!==this&&r.stamp(n);for(t=r.Util.splitWords(t),i=0,o=t.length;o>i;i++)if(s=t[i],u=s+"_idx",h=u+"_len",p=f[u],e){if(l=m&&p?p[m]:f[s]){for(c=l.length-1;c>=0;c--)l[c].action!==e||n&&l[c].context!==n||(d=l.splice(c,1),d[0].action=r.Util.falseFn);n&&p&&0===l.length&&(delete p[m],f[h]--)}}else delete f[s],delete f[u],delete f[h];return this},clearAllEventListeners:function(){return delete this[a],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var n,i,o,s,l,c=r.Util.extend({},e,{type:t,target:this}),u=this[a];if(u[t])for(n=u[t].slice(),i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,c);s=u[t+"_idx"];for(l in s)if(n=s[l].slice())for(i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,c);return this},addOneTimeEventListener:function(t,e,n){if(r.Util.invokeEach(t,this.addOneTimeEventListener,this,e,n))return this;var i=r.bind(function(){this.removeEventListener(t,e,n).removeEventListener(t,i,n)},this);return this.addEventListener(t,e,n).addEventListener(t,i,n)}},r.Mixin.Events.on=r.Mixin.Events.addEventListener,r.Mixin.Events.off=r.Mixin.Events.removeEventListener,r.Mixin.Events.once=r.Mixin.Events.addOneTimeEventListener,r.Mixin.Events.fire=r.Mixin.Events.fireEvent,function(){var t="ActiveXObject"in n,s=t&&!i.addEventListener,a=navigator.userAgent.toLowerCase(),l=-1!==a.indexOf("webkit"),c=-1!==a.indexOf("chrome"),u=-1!==a.indexOf("phantom"),h=-1!==a.indexOf("android"),p=-1!==a.search("android [23]"),d=-1!==a.indexOf("gecko"),f=("undefined"==typeof orientation?"undefined":e(orientation))!=o+"",m=!n.PointerEvent&&n.MSPointerEvent,_=n.PointerEvent&&n.navigator.pointerEnabled||m,g="devicePixelRatio"in n&&n.devicePixelRatio>1||"matchMedia"in n&&n.matchMedia("(min-resolution:144dpi)")&&n.matchMedia("(min-resolution:144dpi)").matches,v=i.documentElement,y=t&&"transition"in v.style,P="WebKitCSSMatrix"in n&&"m11"in new n.WebKitCSSMatrix&&!p,w="MozPerspective"in v.style,b="OTransition"in v.style,T=!n.L_DISABLE_3D&&(y||P||w||b)&&!u,L=!n.L_NO_TOUCH&&!u&&(_||"ontouchstart"in n||n.DocumentTouch&&i instanceof n.DocumentTouch);r.Browser={ie:t,ielt9:s,webkit:l,gecko:d&&!l&&!n.opera&&!t,android:h,android23:p,chrome:c,ie3d:y,webkit3d:P,gecko3d:w,opera3d:b,any3d:T,mobile:f,mobileWebkit:f&&l,mobileWebkit3d:f&&P,mobileOpera:f&&n.opera,touch:L,msPointer:m,pointer:_,retina:g}}(),r.Point=function(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e},r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(t){return this.clone()._add(r.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(r.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=r.point(t);var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return t=r.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=r.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Util.formatNum(this.x)+", "+r.Util.formatNum(this.y)+")"}},r.point=function(t,e,n){return t instanceof r.Point?t:r.Util.isArray(t)?new r.Point(t[0],t[1]):t===o||null===t?t:new r.Point(t,e,n)},r.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},r.Bounds.prototype={extend:function(t){return t=r.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new r.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new r.Point(this.min.x,this.max.y)},getTopRight:function(){return new r.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return t="number"==typeof t[0]||t instanceof r.Point?r.point(t):r.bounds(t),t instanceof r.Bounds?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=r.bounds(t);var e=this.min,n=this.max,i=t.min,o=t.max,s=o.x>=e.x&&i.x<=n.x,a=o.y>=e.y&&i.y<=n.y;return s&&a},isValid:function(){return!(!this.min||!this.max)}},r.bounds=function(t,e){return!t||t instanceof r.Bounds?t:new r.Bounds(t,e)},r.Transformation=function(t,e,n,i){this._a=t,this._b=e,this._c=n,this._d=i},r.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new r.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},r.DomUtil={get:function(t){return"string"==typeof t?i.getElementById(t):t},getStyle:function(t,e){var n=t.style[e];if(!n&&t.currentStyle&&(n=t.currentStyle[e]),(!n||"auto"===n)&&i.defaultView){var o=i.defaultView.getComputedStyle(t,null);n=o?o[e]:null}return"auto"===n?null:n},getViewportOffset:function(t){var e,n=0,o=0,s=t,a=i.body,l=i.documentElement;do{if(n+=s.offsetTop||0,o+=s.offsetLeft||0,n+=parseInt(r.DomUtil.getStyle(s,"borderTopWidth"),10)||0,o+=parseInt(r.DomUtil.getStyle(s,"borderLeftWidth"),10)||0,e=r.DomUtil.getStyle(s,"position"),s.offsetParent===a&&"absolute"===e)break;if("fixed"===e){n+=a.scrollTop||l.scrollTop||0,o+=a.scrollLeft||l.scrollLeft||0;break}if("relative"===e&&!s.offsetLeft){var c=r.DomUtil.getStyle(s,"width"),u=r.DomUtil.getStyle(s,"max-width"),h=s.getBoundingClientRect();("none"!==c||"none"!==u)&&(o+=h.left+s.clientLeft),n+=h.top+(a.scrollTop||l.scrollTop||0);break}s=s.offsetParent}while(s);s=t;do{if(s===a)break;n-=s.scrollTop||0,o-=s.scrollLeft||0,s=s.parentNode}while(s);return new r.Point(o,n)},documentIsLtr:function(){return r.DomUtil._docIsLtrCached||(r.DomUtil._docIsLtrCached=!0,r.DomUtil._docIsLtr="ltr"===r.DomUtil.getStyle(i.body,"direction")),r.DomUtil._docIsLtr},create:function(t,e,n){var o=i.createElement(t);return o.className=e,n&&n.appendChild(o),o},hasClass:function(t,e){if(t.classList!==o)return t.classList.contains(e);var n=r.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==o)for(var n=r.Util.splitWords(e),i=0,s=n.length;s>i;i++)t.classList.add(n[i]);else if(!r.DomUtil.hasClass(t,e)){var a=r.DomUtil._getClass(t);r.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==o?t.classList.remove(e):r.DomUtil._setClass(t,r.Util.trim((" "+r.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===o?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===o?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}},testProp:function(t){for(var e=i.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1},getTranslateString:function(t){var e=r.Browser.webkit3d,n="translate"+(e?"3d":"")+"(",i=(e?",0":"")+")";return n+t.x+"px,"+t.y+"px"+i},getScaleString:function(t,e){return r.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t)))+" scale("+t+") "},setPosition:function(t,e,n){t._leaflet_pos=e,!n&&r.Browser.any3d?t.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),r.DomUtil.TRANSITION=r.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),r.DomUtil.TRANSITION_END="webkitTransition"===r.DomUtil.TRANSITION||"OTransition"===r.DomUtil.TRANSITION?r.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in i)r.extend(r.DomUtil,{disableTextSelection:function(){r.DomEvent.on(n,"selectstart",r.DomEvent.preventDefault)},enableTextSelection:function(){r.DomEvent.off(n,"selectstart",r.DomEvent.preventDefault)}});else{var t=r.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);r.extend(r.DomUtil,{disableTextSelection:function(){if(t){var e=i.documentElement.style;this._userSelect=e[t],e[t]="none"}},enableTextSelection:function(){t&&(i.documentElement.style[t]=this._userSelect,delete this._userSelect)}})}r.extend(r.DomUtil,{disableImageDrag:function(){r.DomEvent.on(n,"dragstart",r.DomEvent.preventDefault)},enableImageDrag:function(){r.DomEvent.off(n,"dragstart",r.DomEvent.preventDefault)}})}(),r.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==o&&(this.alt=parseFloat(n))},r.extend(r.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),r.LatLng.prototype={equals:function(t){return!!t&&(t=r.latLng(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=r.LatLng.MAX_MARGIN)},toString:function(t){return"LatLng("+r.Util.formatNum(this.lat,t)+", "+r.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=r.latLng(t);var e=r.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*e,i=(t.lng-this.lng)*e,o=this.lat*e,s=t.lat*e,a=Math.sin(n/2),l=Math.sin(i/2),c=a*a+l*l*Math.cos(o)*Math.cos(s);return 12756274*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))},wrap:function(t,e){var n=this.lng;return t=t||-180,e=e||180,n=(n+e)%(e-t)+(t>n||n===e?e:t),new r.LatLng(this.lat,n)}},r.latLng=function(t,n){return t instanceof r.LatLng?t:r.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new r.LatLng(t[0],t[1],t[2]):null:t===o||null===t?t:"object"==e(t)&&"lat"in t?new r.LatLng(t.lat,"lng"in t?t.lng:t.lon):n===o?null:new r.LatLng(t,n)},r.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},r.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=r.latLng(t);return t=null!==e?e:r.latLngBounds(t),t instanceof r.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new r.LatLng(t.lat,t.lng),this._northEast=new r.LatLng(t.lat,t.lng)):t instanceof r.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new r.LatLngBounds(new r.LatLng(e.lat-i,e.lng-o),new r.LatLng(n.lat+i,n.lng+o))},getCenter:function(){return new r.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof r.LatLng?r.latLng(t):r.latLngBounds(t);var e,n,i=this._southWest,o=this._northEast;return t instanceof r.LatLngBounds?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=o.lat&&e.lng>=i.lng&&n.lng<=o.lng},intersects:function(t){t=r.latLngBounds(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),s=o.lat>=e.lat&&i.lat<=n.lat,a=o.lng>=e.lng&&i.lng<=n.lng;return s&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=r.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},r.latLngBounds=function(t,e){return!t||t instanceof r.LatLngBounds?t:new r.LatLngBounds(t,e)},r.Projection={},r.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=r.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=t.lng*e,s=i*e;return s=Math.log(Math.tan(Math.PI/4+s/2)),new r.Point(o,s)},unproject:function(t){var e=r.LatLng.RAD_TO_DEG,n=t.x*e,i=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new r.LatLng(i,n)}},r.Projection.LonLat={project:function(t){return new r.Point(t.lng,t.lat)},unproject:function(t){return new r.LatLng(t.y,t.x)}},r.CRS={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return r.point(e,e)}},r.CRS.Simple=r.extend({},r.CRS,{projection:r.Projection.LonLat,transformation:new r.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),r.CRS.EPSG3857=r.extend({},r.CRS,{code:"EPSG:3857",projection:r.Projection.SphericalMercator,transformation:new r.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){return this.projection.project(t).multiplyBy(6378137)}}),r.CRS.EPSG900913=r.extend({},r.CRS.EPSG3857,{code:"EPSG:900913"}),r.CRS.EPSG4326=r.extend({},r.CRS,{code:"EPSG:4326",projection:r.Projection.LonLat,transformation:new r.Transformation(1/360,.5,-1/360,.5)}),r.Map=r.Class.extend({includes:r.Mixin.Events,options:{crs:r.CRS.EPSG3857,fadeAnimation:r.DomUtil.TRANSITION&&!r.Browser.android23,trackResize:!0,markerZoomAnimation:r.DomUtil.TRANSITION&&r.Browser.any3d},initialize:function(t,e){e=r.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=r.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==o&&this.setView(r.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===o?this.getZoom():e,this._resetView(r.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),s=t instanceof r.Point?t:this.latLngToContainerPoint(t),a=s.subtract(o).multiplyBy(1-1/i),l=this.containerPointToLatLng(o.add(a));return this.setView(l,e,{zoom:n})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():r.latLngBounds(t);var n=r.point(e.paddingTopLeft||e.padding||[0,0]),i=r.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i));o=e.maxZoom?Math.min(e.maxZoom,o):o;var s=i.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),o),l=this.project(t.getNorthEast(),o),c=this.unproject(a.add(l).divideBy(2).add(s),o);return this.setView(c,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(r.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=r.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,t);return n.equals(i)?this:this.panTo(i,e)},addLayer:function(t){var e=r.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&t instanceof r.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=r.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&r.TileLayer&&t instanceof r.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return!!t&&r.stamp(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=r.extend({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),o=n.divideBy(2).round(),s=i.subtract(o);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=o}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new r.LatLngBounds(e,n)},getMinZoom:function(){return this.options.minZoom===o?this._layersMinZoom===o?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===o?this._layersMaxZoom===o?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=r.latLngBounds(t);var i,o=this.getMinZoom()-(e?1:0),s=this.getMaxZoom(),a=this.getSize(),l=t.getNorthWest(),c=t.getSouthEast(),u=!0;n=r.point(n||[0,0]);do{o++,i=this.project(c,o).subtract(this.project(l,o)).add(n),u=e?i.x<a.x||i.y<a.y:a.contains(i)}while(u&&s>=o);return u&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new r.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new r.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===o?this._zoom:e,this.options.crs.latLngToPoint(r.latLng(t),e)},unproject:function(t,e){return e=e===o?this._zoom:e,this.options.crs.pointToLatLng(r.point(t),e)},layerPointToLatLng:function(t){var e=r.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(r.latLng(t))._round()._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return r.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return r.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(r.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(r.latLng(t)))},mouseEventToContainerPoint:function(t){return r.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=r.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;r.DomUtil.addClass(t,"leaflet-container"+(r.Browser.touch?" leaflet-touch":"")+(r.Browser.retina?" leaflet-retina":"")+(r.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=r.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(r.DomUtil.addClass(t.markerPane,e),r.DomUtil.addClass(t.shadowPane,e),r.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return r.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?r.Util.isArray(t)?t:[t]:[];for(var e=0,n=t.length;n>e;e++)this.addLayer(t[e])},_resetView:function(t,e,n,i){var o=this._zoom!==e;i||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),n?this._initialTopLeftPoint._add(this._getMapPanePos()):r.DomUtil.setPosition(this._mapPane,new r.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var s=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),s&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(o||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(t){r.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,i=this._getZoomSpan();for(t in this._zoomBoundLayers){var s=this._zoomBoundLayers[t];isNaN(s.options.minZoom)||(e=Math.min(e,s.options.minZoom)),isNaN(s.options.maxZoom)||(n=Math.max(n,s.options.maxZoom))}t===o?this._layersMaxZoom=this._layersMinZoom=o:(this._layersMaxZoom=n,this._layersMinZoom=e),i!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(r.DomEvent){t=t||"on",r.DomEvent[t](this._container,"click",this._onMouseClick,this);var e,i,o=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(e=0,i=o.length;i>e;e++)r.DomEvent[t](this._container,o[e],this._fireMouseEvent,this);this.options.trackResize&&r.DomEvent[t](n,"resize",this._onResize,this)}},_onResize:function(){r.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=r.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||r.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!r.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&r.DomEvent.preventDefault(t);var n=this.mouseEventToContainerPoint(t),i=this.containerPointToLayerPoint(n),o=this.layerPointToLatLng(i);this.fire(e,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return r.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewTopLeftPoint(n,e).add(this._getMapPanePos());return this.project(t,e)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),s=new r.Bounds(i.subtract(o),i.add(o)),a=this._getBoundsOffset(s,n,e);return this.unproject(i.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new r.Bounds(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=this.project(e.getNorthWest(),n).subtract(t.min),o=this.project(e.getSouthEast(),n).subtract(t.max),s=this._rebound(i.x,-o.x),a=this._rebound(i.y,-o.y);return new r.Point(s,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom();return Math.max(e,Math.min(n,t))}}),r.map=function(t,e){return new r.Map(t,e)},r.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=r.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=this.R_MAJOR,s=this.R_MINOR,a=t.lng*e*o,l=i*e,c=s/o,u=Math.sqrt(1-c*c),h=u*Math.sin(l);h=Math.pow((1-h)/(1+h),.5*u);var p=Math.tan(.5*(.5*Math.PI-l))/h;return l=-o*Math.log(p),new r.Point(a,l)},unproject:function(t){for(var e,n=r.LatLng.RAD_TO_DEG,i=this.R_MAJOR,o=this.R_MINOR,s=t.x*n/i,a=o/i,l=Math.sqrt(1-a*a),c=Math.exp(-t.y/i),u=Math.PI/2-2*Math.atan(c),h=15,p=.1;Math.abs(p)>1e-7&&--h>0;)e=l*Math.sin(u),p=Math.PI/2-2*Math.atan(c*Math.pow((1-e)/(1+e),.5*l))-u,u+=p;return new r.LatLng(u*n,s)}},r.CRS.EPSG3395=r.extend({},r.CRS,{code:"EPSG:3395",projection:r.Projection.Mercator,transformation:function(){var t=r.Projection.Mercator,e=t.R_MAJOR,n=.5/(Math.PI*e);return new r.Transformation(n,.5,-n,.5)}()}),r.TileLayer=r.Class.extend({includes:r.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:r.Browser.mobile,updateWhenIdle:r.Browser.mobile},initialize:function(t,e){e=r.setOptions(this,e),e.detectRetina&&r.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=r.latLngBounds(e.bounds)),this._url=t;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=r.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==o&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var n,i,o,s=t.children,r=-e(1/0,-1/0);for(i=0,o=s.length;o>i;i++)s[i]!==this._container&&(n=parseInt(s[i].style.zIndex,10),isNaN(n)||(r=e(r,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(r)?r:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(r.Browser.ielt9)for(t in e)r.DomUtil.setOpacity(e[t],this.options.opacity);else r.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=r.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=r.DomUtil.create("div",e,this._container),this._tileContainer=r.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&e>n&&(i=Math.round(t.getZoomScale(e)/t.getZoomScale(n)*i)),i},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),n=t.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var o=r.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(t){var e,n,o,s=[],a=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(n=t.min.x;n<=t.max.x;n++)o=new r.Point(n,e),this._tileShouldBeLoaded(o)&&s.push(o);var l=s.length;if(0!==l){s.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var c=i.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=l,n=0;l>n;n++)this._addTile(s[n],c);this._tileContainer.appendChild(c)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var n=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=n.x)||t.y<0||t.y>=n.y)return!1}if(e.bounds){var i=this._getTileSize(),o=t.multiplyBy(i),s=o.add([i,i]),r=this._map.unproject(o),a=this._map.unproject(s);if(e.continuousWorld||e.noWrap||(r=r.wrap(),a=a.wrap()),!e.bounds.intersects([r,a]))return!1}return!0},_removeOtherTiles:function(t){var e,n,i,o;for(o in this._tiles)e=o.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),(n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(r.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),r.Browser.android||(e.onload=null,e.src=r.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var n=this._getTilePos(t),i=this._getTile();r.DomUtil.setPosition(i,n,r.Browser.chrome),this._tiles[t.x+":"+t.y]=i,this._loadTile(i,t),i.parentNode!==this._tileContainer&&e.appendChild(i)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),n=this._getTileSize();return t.multiplyBy(n).subtract(e)},getTileUrl:function(t){return r.Util.template(this._url,r.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=r.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=r.Util.falseFn,r.Browser.ielt9&&this.options.opacity!==o&&r.DomUtil.setOpacity(t,this.options.opacity),r.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&r.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(r.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==r.Util.emptyImageUrl&&(r.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),r.tileLayer=function(t,e){return new r.TileLayer(t,e)},r.TileLayer.WMS=r.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var n=r.extend({},this.defaultWmsParams),i=e.tileSize||this.options.tileSize;e.detectRetina&&r.Browser.retina?n.width=n.height=2*i:n.width=n.height=i;for(var o in e)this.options.hasOwnProperty(o)||"crs"===o||(n[o]=e[o]);this.wmsParams=n,r.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,r.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,n=this.options.tileSize,i=t.multiplyBy(n),o=i.add([n,n]),s=this._crs.project(e.unproject(i,t.z)),a=this._crs.project(e.unproject(o,t.z)),l=this._wmsVersion>=1.3&&this._crs===r.CRS.EPSG4326?[a.y,s.x,s.y,a.x].join(","):[s.x,a.y,a.x,s.y].join(","),c=r.Util.template(this._url,{s:this._getSubdomain(t)});return c+r.Util.getParamString(this.wmsParams,c,!0)+"&BBOX="+l},setParams:function(t,e){return r.extend(this.wmsParams,t),e||this.redraw(),this}}),r.tileLayer.wms=function(t,e){return new r.TileLayer.WMS(t,e)},r.TileLayer.Canvas=r.TileLayer.extend({options:{async:!1},initialize:function(t){r.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=r.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=r.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),r.tileLayer.canvas=function(t){return new r.TileLayer.Canvas(t)},r.ImageOverlay=r.Class.extend({includes:r.Mixin.Events,options:{opacity:1},initialize:function(t,e,n){this._url=t,this._bounds=r.latLngBounds(e),r.setOptions(this,n)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&r.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=r.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&r.Browser.any3d?r.DomUtil.addClass(this._image,"leaflet-zoom-animated"):r.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),r.extend(this._image,{galleryimg:"no",onselectstart:r.Util.falseFn,onmousemove:r.Util.falseFn,onload:r.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,n=this._image,i=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),s=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(o,t.zoom,t.center),l=e._latLngToNewLayerPoint(s,t.zoom,t.center)._subtract(a),c=a._add(l._multiplyBy(.5*(1-1/i)));n.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(c)+" scale("+i+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);r.DomUtil.setPosition(t,e),t.style.width=n.x+"px",t.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){r.DomUtil.setOpacity(this._image,this.options.opacity)}}),r.imageOverlay=function(t,e,n){return new r.ImageOverlay(t,e,n)},r.Icon=r.Class.extend({options:{className:""},initialize:function(t){r.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i;return i=e&&"IMG"===e.tagName?this._createImg(n,e):this._createImg(n),this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n,i=this.options,o=r.point(i[e+"Size"]);n="shadow"===e?r.point(i.shadowAnchor||i.iconAnchor):r.point(i.iconAnchor),!n&&o&&(n=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+i.className,n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return e=e||i.createElement("img"),e.src=t,e},_getIconUrl:function(t){return r.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),r.icon=function(t){return new r.Icon(t)},r.Icon.Default=r.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];r.Browser.retina&&"icon"===t&&(t+="-2x");var n=r.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+".png"}}),r.Icon.Default.imagePath=function(){var t,e,n,o,s=i.getElementsByTagName("script"),r=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=s.length;e>t;t++)if(n=s[t].src,n.match(r))return o=n.split(r)[0],(o?o+"/":"")+"images"}(),r.Marker=r.Class.extend({includes:r.Mixin.Events,options:{icon:new r.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){r.setOptions(this,e),this._latlng=r.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=r.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation,i=n?"leaflet-zoom-animated":"leaflet-zoom-hide",o=t.icon.createIcon(this._icon),s=!1;o!==this._icon&&(this._icon&&this._removeIcon(),s=!0,t.title&&(o.title=t.title),t.alt&&(o.alt=t.alt)),r.DomUtil.addClass(o,i),t.keyboard&&(o.tabIndex="0"),this._icon=o,this._initInteraction(),t.riseOnHover&&r.DomEvent.on(o,"mouseover",this._bringToFront,this).on(o,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),l=!1;a!==this._shadow&&(this._removeShadow(),l=!0),a&&r.DomUtil.addClass(a,i),this._shadow=a,t.opacity<1&&this._updateOpacity();var c=this._map._panes;s&&c.markerPane.appendChild(this._icon),a&&l&&c.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&r.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){r.DomUtil.setPosition(this._icon,t),this._shadow&&r.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];r.DomUtil.addClass(t,"leaflet-clickable"),r.DomEvent.on(t,"click",this._onMouseClick,this),r.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)r.DomEvent.on(t,e[n],this._fireMouseEvent,this);r.Handler.MarkerDrag&&(this.dragging=new r.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&r.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&r.DomEvent.preventDefault(t),"mousedown"!==t.type?r.DomEvent.stopPropagation(t):r.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){r.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&r.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),r.marker=function(t,e){return new r.Marker(t,e)},r.DivIcon=r.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:i.createElement("div"),n=this.options;return!1!==n.html?e.innerHTML=n.html:e.innerHTML="",n.bgPos&&(e.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),r.divIcon=function(t){return new r.DivIcon(t)},r.Map.mergeOptions({closePopupOnClick:!0}),r.Popup=r.Class.extend({includes:r.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){r.setOptions(this,t),this._source=e,this._animated=r.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&r.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&r.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),r.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&r.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=r.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",n=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=r.DomUtil.create("div",n);this.options.closeButton&&(t=this._closeButton=r.DomUtil.create("a",e+"-close-button",i),t.href="#close",t.innerHTML="&#215;",r.DomEvent.disableClickPropagation(t),r.DomEvent.on(t,"click",this._onCloseButtonClick,this));var o=this._wrapper=r.DomUtil.create("div",e+"-content-wrapper",i);r.DomEvent.disableClickPropagation(o),this._contentNode=r.DomUtil.create("div",e+"-content",o),r.DomEvent.disableScrollPropagation(this._contentNode),r.DomEvent.on(o,"contextmenu",r.DomEvent.stopPropagation),this._tipContainer=r.DomUtil.create("div",e+"-tip-container",i),this._tip=r.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,s="leaflet-popup-scrolled";o&&i>o?(e.height=o+"px",r.DomUtil.addClass(t,s)):r.DomUtil.removeClass(t,s),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=r.point(this.options.offset);e&&r.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);r.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,n=this._containerWidth,i=new r.Point(this._containerLeft,-e-this._containerBottom);this._animated&&i._add(r.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(i),s=r.point(this.options.autoPanPadding),a=r.point(this.options.autoPanPaddingTopLeft||s),l=r.point(this.options.autoPanPaddingBottomRight||s),c=t.getSize(),u=0,h=0;o.x+n+l.x>c.x&&(u=o.x+n-c.x+l.x),o.x-u-a.x<0&&(u=o.x-a.x),o.y+e+l.y>c.y&&(h=o.y+e-c.y+l.y),o.y-h-a.y<0&&(h=o.y-a.y),(u||h)&&t.fire("autopanstart").panBy([u,h])}},_onCloseButtonClick:function(t){this._close(),r.DomEvent.stop(t)}}),r.popup=function(t,e){return new r.Popup(t,e)},r.Map.include({openPopup:function(t,e,n){if(this.closePopup(),!(t instanceof r.Popup)){var i=t;t=new r.Popup(n).setLatLng(e).setContent(i)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),r.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var n=r.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(r.Popup.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=r.extend({offset:n},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof r.Popup?(r.setOptions(t,e),this._popup=t,t._source=this):this._popup=new r.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),r.LayerGroup=r.Class.extend({initialize:function(t){this._layers={};var e,n;if(t)for(e=0,n=t.length;n>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)n=this._layers[e],n[t]&&n[t].apply(n,i);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r.stamp(t)}}),r.layerGroup=function(t){return new r.LayerGroup(t)},r.FeatureGroup=r.LayerGroup.extend({includes:r.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(r.FeatureGroup.EVENTS,this._propagateEvent,this),r.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(r.FeatureGroup.EVENTS,this._propagateEvent,this),r.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new r.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof r.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=r.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),r.featureGroup=function(t){return new r.FeatureGroup(t)},r.Path=r.Class.extend({includes:[r.Mixin.Events],statics:{CLIP_PADDING:function(){var t=r.Browser.mobile?1280:2e3,e=(t/Math.max(n.outerWidth,n.outerHeight)-1)/2;return Math.max(0,Math.min(.5,e))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){r.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,r.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return r.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),r.Map.include({_updatePathViewport:function(){var t=r.Path.CLIP_PADDING,e=this.getSize(),n=r.DomUtil.getPosition(this._mapPane),i=n.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),o=i.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new r.Bounds(i,o)}}),r.Path.SVG_NS="http://www.w3.org/2000/svg",r.Browser.svg=!(!i.createElementNS||!i.createElementNS(r.Path.SVG_NS,"svg").createSVGRect),r.Path=r.Path.extend({statics:{SVG:r.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,n=t.firstChild;return e&&n!==e&&t.insertBefore(e,n),this},getPathString:function(){},_createElement:function(t){return i.createElementNS(r.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&r.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(r.Browser.svg||!r.Browser.vml)&&r.DomUtil.addClass(this._path,"leaflet-clickable"),r.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)r.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,n=e.mouseEventToContainerPoint(t),i=e.containerPointToLayerPoint(n),o=e.layerPointToLatLng(i);this.fire(t.type,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t}),"contextmenu"===t.type&&r.DomEvent.preventDefault(t),"mousemove"!==t.type&&r.DomEvent.stopPropagation(t)}}}),r.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=r.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&r.Browser.any3d?(r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):r.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),n=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[r.DomUtil.TRANSFORM]=r.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max,i=n.x-e.x,o=n.y-e.y,s=this._pathRoot,a=this._panes.overlayPane;r.Browser.mobileWebkit&&a.removeChild(s),r.DomUtil.setPosition(s,e),s.setAttribute("width",i),s.setAttribute("height",o),s.setAttribute("viewBox",[e.x,e.y,i,o].join(" ")),r.Browser.mobileWebkit&&a.appendChild(s)}}}),r.Path.include({bindPopup:function(t,e){return t instanceof r.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new r.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),r.Browser.vml=!r.Browser.svg&&function(){try{var t=i.createElement("div");t.innerHTML='<v:shape adj="1"/>';var n=t.firstChild;return n.style.behavior="url(#default#VML)",n&&"object"==e(n.adj)}catch(t){return!1}}(),r.Path=r.Browser.svg||!r.Browser.vml?r.Path:r.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return i.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return i.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return i.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");r.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&r.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",i.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,n.dashArray?t.dashStyle=r.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):t.dashStyle="",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(i.removeChild(t),this._stroke=null),n.fill?(e||(e=this._fill=this._createElement("fill"),i.appendChild(e)),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(i.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),r.Map.include(r.Browser.svg||!r.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=i.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),r.Browser.canvas=function(){return!!i.createElement("canvas").getContext}(),r.Path=r.Path.SVG&&!n.L_PREFER_CANVAS||!r.Browser.canvas?r.Path:r.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return r.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!r.Path._updateRequest&&(r.Path._updateRequest=r.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){r.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,n,i,o,s;for(this._ctx.beginPath(),t=0,n=this._parts.length;n>t;t++){for(e=0,i=this._parts[t].length;i>e;e++)o=this._parts[t][e],s=(0===e?"move":"line")+"To",this._ctx[s](o.x,o.y);this instanceof r.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),r.Map.include(r.Path.SVG&&!n.L_PREFER_CANVAS||!r.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||(e=this._pathRoot=i.createElement("canvas"),e.style.position="absolute",t=this._canvasCtx=e.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max.subtract(e),i=this._pathRoot;r.DomUtil.setPosition(i,e),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-e.x,-e.y)}}}),r.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),t=this._simplifyDP(t,n)},pointToSegmentDistance:function(t,e,n){return Math.sqrt(this._sqClosestPointOnSegment(t,e,n,!0))},closestPointOnSegment:function(t,e,n){return this._sqClosestPointOnSegment(t,e,n)},_simplifyDP:function(t,n){var i=t.length,s=("undefined"==typeof Uint8Array?"undefined":e(Uint8Array))!=o+""?Uint8Array:Array,r=new s(i);r[0]=r[i-1]=1,this._simplifyDPStep(t,r,n,0,i-1);var a,l=[];for(a=0;i>a;a++)r[a]&&l.push(t[a]);return l},_simplifyDPStep:function(t,e,n,i,o){var s,r,a,l=0;for(r=i+1;o-1>=r;r++)(a=this._sqClosestPointOnSegment(t[r],t[i],t[o],!0))>l&&(s=r,l=a);l>n&&(e[s]=1,this._simplifyDPStep(t,e,n,i,s),this._simplifyDPStep(t,e,n,s,o))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,o=0,s=t.length;s>i;i++)this._sqDist(t[i],t[o])>e&&(n.push(t[i]),o=i);return s-1>o&&n.push(t[s-1]),n},clipSegment:function(t,e,n,i){var o,s,r,a=i?this._lastCode:this._getBitCode(t,n),l=this._getBitCode(e,n);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;o=a||l,s=this._getEdgeIntersection(t,e,o,n),r=this._getBitCode(s,n),o===a?(t=s,a=r):(e=s,l=r)}},_getEdgeIntersection:function(t,e,n,i){var o=e.x-t.x,s=e.y-t.y,a=i.min,l=i.max;return 8&n?new r.Point(t.x+o*(l.y-t.y)/s,l.y):4&n?new r.Point(t.x+o*(a.y-t.y)/s,a.y):2&n?new r.Point(l.x,t.y+s*(l.x-t.x)/o):1&n?new r.Point(a.x,t.y+s*(a.x-t.x)/o):void 0},_getBitCode:function(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_sqClosestPointOnSegment:function(t,e,n,i){var o,s=e.x,a=e.y,l=n.x-s,c=n.y-a,u=l*l+c*c;return u>0&&(o=((t.x-s)*l+(t.y-a)*c)/u,o>1?(s=n.x,a=n.y):o>0&&(s+=l*o,a+=c*o)),l=t.x-s,c=t.y-a,i?l*l+c*c:new r.Point(s,a)}},r.Polyline=r.Path.extend({initialize:function(t,e){r.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,n="";e>t;t++)n+=this._getPathPartStr(this._parts[t]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(r.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,n,i=1/0,o=this._parts,s=null,a=0,l=o.length;l>a;a++)for(var c=o[a],u=1,h=c.length;h>u;u++){e=c[u-1],n=c[u];var p=r.LineUtil._sqClosestPointOnSegment(t,e,n,!0);i>p&&(i=p,s=r.LineUtil._sqClosestPointOnSegment(t,e,n))}return s&&(s.distance=Math.sqrt(i)),s},getBounds:function(){return new r.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var n,i,o=e?t:[];for(n=0,i=t.length;i>n;n++){if(r.Util.isArray(t[n])&&"number"!=typeof t[n][0])return;o[n]=r.latLng(t[n])}return o},_initEvents:function(){r.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,n=r.Path.VML,i=0,o=t.length,s="";o>i;i++)e=t[i],n&&e._round(),s+=(i?"L":"M")+e.x+" "+e.y;return s},_clipPoints:function(){var t,e,n,i=this._originalPoints,o=i.length;if(this.options.noClip)return void(this._parts=[i]);this._parts=[];var s=this._parts,a=this._map._pathViewport,l=r.LineUtil;for(t=0,e=0;o-1>t;t++)(n=l.clipSegment(i[t],i[t+1],a,t))&&(s[e]=s[e]||[],s[e].push(n[0]),(n[1]!==i[t+1]||t===o-2)&&(s[e].push(n[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=r.LineUtil,n=0,i=t.length;i>n;n++)t[n]=e.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),r.Path.prototype._updatePath.call(this))}}),r.polyline=function(t,e){return new r.Polyline(t,e)},r.PolyUtil={},r.PolyUtil.clipPolygon=function(t,e){var n,i,o,s,a,l,c,u,h,p=[1,4,2,8],d=r.LineUtil;for(i=0,c=t.length;c>i;i++)t[i]._code=d._getBitCode(t[i],e);for(s=0;4>s;s++){for(u=p[s],n=[],i=0,c=t.length,o=c-1;c>i;o=i++)a=t[i],l=t[o],a._code&u?l._code&u||(h=d._getEdgeIntersection(l,a,u,e),h._code=d._getBitCode(h,e),n.push(h)):(l._code&u&&(h=d._getEdgeIntersection(l,a,u,e),h._code=d._getBitCode(h,e),n.push(h)),n.push(a));t=n}return t},r.Polygon=r.Polyline.extend({options:{fill:!0},initialize:function(t,e){r.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,n,i;if(t&&r.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,n=this._holes.length;n>e;e++)i=this._holes[e]=this._convertLatLngs(this._holes[e]),i[0].equals(i[i.length-1])&&i.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(r.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,n,i;for(t=0,n=this._holes.length;n>t;t++)for(this._holePoints[t]=[],e=0,i=this._holes[t].length;i>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&r.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):r.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;i>n;n++){var o=r.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){return r.Polyline.prototype._getPathPartStr.call(this,t)+(r.Browser.svg?"z":"x")}}),r.polygon=function(t,e){return new r.Polygon(t,e)},function(){function t(t){return r.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var n=0,i=e.length;for(this.eachLayer(function(t){i>n?t.setLatLngs(e[n++]):this.removeLayer(t)},this);i>n;)this.addLayer(new t(e[n++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}r.MultiPolyline=t(r.Polyline),r.MultiPolygon=t(r.Polygon),r.multiPolyline=function(t,e){return new r.MultiPolyline(t,e)},r.multiPolygon=function(t,e){return new r.MultiPolygon(t,e)}}(),r.Rectangle=r.Polygon.extend({initialize:function(t,e){r.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=r.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),r.rectangle=function(t,e){return new r.Rectangle(t,e)},r.Circle=r.Path.extend({initialize:function(t,e,n){r.Path.prototype.initialize.call(this,n),this._latlng=r.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=r.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,n=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,n=this._latlng;return new r.LatLngBounds([n.lat-e,n.lng-t],[n.lat+e,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":r.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(r.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,n=this._point;return n.x-e>t.max.x||n.y-e>t.max.y||n.x+e<t.min.x||n.y+e<t.min.y}}),r.circle=function(t,e,n){return new r.Circle(t,e,n)},r.CircleMarker=r.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){r.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){r.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return r.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),r.circleMarker=function(t,e){return new r.CircleMarker(t,e)},r.Polyline.include(r.Path.CANVAS?{_containsPoint:function(t,e){var n,i,o,s,a,l,c,u=this.options.weight/2;for(r.Browser.touch&&(u+=10),n=0,s=this._parts.length;s>n;n++)for(c=this._parts[n],i=0,a=c.length,o=a-1;a>i;o=i++)if((e||0!==i)&&(l=r.LineUtil.pointToSegmentDistance(t,c[o],c[i]),u>=l))return!0;return!1}}:{}),r.Polygon.include(r.Path.CANVAS?{_containsPoint:function(t){var e,n,i,o,s,a,l,c,u=!1;if(r.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,l=this._parts.length;l>o;o++)for(e=this._parts[o],s=0,c=e.length,a=c-1;c>s;a=s++)n=e[s],i=e[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(u=!u);return u}}:{}),r.Circle.include(r.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,n=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+n}}:{}),r.CircleMarker.include(r.Path.CANVAS?{_updateStyle:function(){r.Path.prototype._updateStyle.call(this)}}:{}),r.GeoJSON=r.FeatureGroup.extend({initialize:function(t,e){r.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,o=r.Util.isArray(t)?t:t.features;if(o){for(e=0,n=o.length;n>e;e++)i=o[e],(i.geometries||i.geometry||i.features||i.coordinates)&&this.addData(o[e]);return this}var s=this.options;if(!s.filter||s.filter(t)){var a=r.GeoJSON.geometryToLayer(t,s.pointToLayer,s.coordsToLatLng,s);return a.feature=r.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),s.onEachFeature&&s.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(r.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),r.extend(r.GeoJSON,{geometryToLayer:function(t,e,n,i){var o,s,a,l,c="Feature"===t.type?t.geometry:t,u=c.coordinates,h=[];switch(n=n||this.coordsToLatLng,c.type){case"Point":return o=n(u),e?e(t,o):new r.Marker(o);case"MultiPoint":for(a=0,l=u.length;l>a;a++)o=n(u[a]),h.push(e?e(t,o):new r.Marker(o));return new r.FeatureGroup(h);case"LineString":return s=this.coordsToLatLngs(u,0,n),new r.Polyline(s,i);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return s=this.coordsToLatLngs(u,1,n),new r.Polygon(s,i);case"MultiLineString":return s=this.coordsToLatLngs(u,1,n),new r.MultiPolyline(s,i);case"MultiPolygon":return s=this.coordsToLatLngs(u,2,n),new r.MultiPolygon(s,i);case"GeometryCollection":for(a=0,l=c.geometries.length;l>a;a++)h.push(this.geometryToLayer({geometry:c.geometries[a],type:"Feature",properties:t.properties},e,n,i));return new r.FeatureGroup(h);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new r.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,n){var i,o,s,r=[];for(o=0,s=t.length;s>o;o++)i=e?this.coordsToLatLngs(t[o],e-1,n):(n||this.coordsToLatLng)(t[o]),r.push(i);return r},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==o&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push(r.GeoJSON.latLngToCoords(t[n]));return e},getFeature:function(t,e){return t.feature?r.extend({},t.feature,{geometry:e}):r.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var l={toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"Point",coordinates:r.GeoJSON.latLngToCoords(this.getLatLng())})}};r.Marker.include(l),r.Circle.include(l),r.CircleMarker.include(l),r.Polyline.include({toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"LineString",coordinates:r.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),r.Polygon.include({toGeoJSON:function(){var t,e,n,i=[r.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)n=r.GeoJSON.latLngsToCoords(this._holes[t]),n.push(n[0]),i.push(n);return r.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),r.GeoJSON.getFeature(this,{type:t,coordinates:e})}}r.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),r.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),r.LayerGroup.include({toGeoJSON:function(){var e,n=this.feature&&this.feature.geometry,i=[];if(n&&"MultiPoint"===n.type)return t("MultiPoint").call(this);var o=n&&"GeometryCollection"===n.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),i.push(o?e.geometry:r.GeoJSON.asFeature(e)))}),o?r.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),r.geoJson=function(t,e){return new r.GeoJSON(t,e)},r.DomEvent={addListener:function(t,e,n,i){var o,s,a,l=r.stamp(n),c="_leaflet_"+e+l;return t[c]?this:(o=function(e){return n.call(i||t,e||r.DomEvent._getEvent())},r.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,o,l):(r.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,o,l),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",o,!1),t.addEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?(s=o,a="mouseenter"===e?"mouseover":"mouseout",o=function(e){return r.DomEvent._checkMouse(t,e)?s(e):void 0},t.addEventListener(a,o,!1)):"click"===e&&r.Browser.android?(s=o,o=function(t){return r.DomEvent._filterClick(t,s)},t.addEventListener(e,o,!1)):t.addEventListener(e,o,!1):"attachEvent"in t&&t.attachEvent("on"+e,o),t[c]=o,this))},removeListener:function(t,e,n){var i=r.stamp(n),o="_leaflet_"+e+i,s=t[o];return s?(r.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,i):r.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,i):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):t.removeEventListener(e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,r.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=r.DomEvent.stopPropagation;return r.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=r.DomEvent.stopPropagation,n=r.Draggable.START.length-1;n>=0;n--)r.DomEvent.on(t,r.Draggable.START[n],e);return r.DomEvent.on(t,"click",r.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return r.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new r.Point(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new r.Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){r.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t},_getEvent:function(){var t=n.event;if(!t)for(var e=arguments.callee.caller;e&&(!(t=e.arguments[0])||n.Event!==t.constructor);)e=e.caller;return t},_filterClick:function(t,e){var n=t.timeStamp||t.originalEvent.timeStamp,i=r.DomEvent._lastClick&&n-r.DomEvent._lastClick;return i&&i>100&&500>i||t.target._simulatedClick&&!t._simulated?void r.DomEvent.stop(t):(r.DomEvent._lastClick=n,e(t))}},r.DomEvent.on=r.DomEvent.addListener,r.DomEvent.off=r.DomEvent.removeListener,r.Draggable=r.Class.extend({includes:r.Mixin.Events,statics:{START:r.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=r.Draggable.START.length-1;t>=0;t--)r.DomEvent.on(this._dragStartTarget,r.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=r.Draggable.START.length-1;t>=0;t--)r.DomEvent.off(this._dragStartTarget,r.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(r.DomEvent.stopPropagation(t),!r.Draggable._disabled&&(r.DomUtil.disableImageDrag(),r.DomUtil.disableTextSelection(),!this._moving))){var e=t.touches?t.touches[0]:t;this._startPoint=new r.Point(e.clientX,e.clientY),this._startPos=this._newPos=r.DomUtil.getPosition(this._element),r.DomEvent.on(i,r.Draggable.MOVE[t.type],this._onMove,this).on(i,r.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new r.Point(e.clientX,e.clientY),o=n.subtract(this._startPoint);(o.x||o.y)&&(r.Browser.touch&&Math.abs(o.x)+Math.abs(o.y)<3||(r.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=r.DomUtil.getPosition(this._element).subtract(o),r.DomUtil.addClass(i.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,r.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(o),this._moving=!0,r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),r.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){r.DomUtil.removeClass(i.body,"leaflet-dragging"),this._lastTarget&&(r.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in r.Draggable.MOVE)r.DomEvent.off(i,r.Draggable.MOVE[t],this._onMove).off(i,r.Draggable.END[t],this._onUp);r.DomUtil.enableImageDrag(),r.DomUtil.enableTextSelection(),this._moved&&this._moving&&(r.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),r.Handler=r.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),r.Map.mergeOptions({dragging:!0,inertia:!r.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:r.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),r.Map.Drag=r.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new r.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,s=(i+e+n)%t-e-n,r=Math.abs(o+n)<Math.abs(s+n)?o:s;this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,n=e.options,i=+new Date-this._lastTime,o=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var s=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+i-this._times[0])/1e3,l=n.easeLinearity,c=s.multiplyBy(l/a),u=c.distanceTo([0,0]),h=Math.min(n.inertiaMaxSpeed,u),p=c.multiplyBy(h/u),d=h/(n.inertiaDeceleration*l),f=p.multiplyBy(-d/2).round();f.x&&f.y?(f=e._limitOffset(f,e.options.maxBounds),r.Util.requestAnimFrame(function(){e.panBy(f,{duration:d,easeLinearity:l,noMoveStart:!0})})):e.fire("moveend")}}}),r.Map.addInitHook("addHandler","dragging",r.Map.Drag),r.Map.mergeOptions({doubleClickZoom:!0}),r.Map.DoubleClickZoom=r.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),r.Map.addInitHook("addHandler","doubleClickZoom",r.Map.DoubleClickZoom),r.Map.mergeOptions({scrollWheelZoom:!0}),r.Map.ScrollWheelZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),r.DomEvent.on(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault),this._delta=0},removeHooks:function(){r.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),r.DomEvent.off(this._map._container,"MozMousePixelScroll",r.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=r.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r.bind(this._performZoom,this),n),r.DomEvent.preventDefault(t),r.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,n=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(n+e)-n,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(n+e):t.setZoomAround(this._lastMousePos,n+e))}}),r.Map.addInitHook("addHandler","scrollWheelZoom",r.Map.ScrollWheelZoom),r.extend(r.DomEvent,{_touchstart:r.Browser.msPointer?"MSPointerDown":r.Browser.pointer?"pointerdown":"touchstart",_touchend:r.Browser.msPointer?"MSPointerUp":r.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,n){function o(t){var e;if(r.Browser.pointer?(f.push(t.pointerId),e=f.length):e=t.touches.length,!(e>1)){var n=Date.now(),i=n-(a||n);l=t.touches?t.touches[0]:t,c=i>0&&u>=i,a=n}}function s(t){if(r.Browser.pointer){var n=f.indexOf(t.pointerId);if(-1===n)return;f.splice(n,1)}if(c){if(r.Browser.pointer){var i,o={};for(var s in l)i=l[s],o[s]="function"==typeof i?i.bind(l):i;l=o}l.type="dblclick",e(l),a=null}}var a,l,c=!1,u=250,h="_leaflet_",p=this._touchstart,d=this._touchend,f=[];t[h+p+n]=o,t[h+d+n]=s;var m=r.Browser.pointer?i.documentElement:t;return t.addEventListener(p,o,!1),m.addEventListener(d,s,!1),r.Browser.pointer&&m.addEventListener(r.DomEvent.POINTER_CANCEL,s,!1),this},removeDoubleTapListener:function(t,e){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+e],!1),(r.Browser.pointer?i.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+e],!1),r.Browser.pointer&&i.documentElement.removeEventListener(r.DomEvent.POINTER_CANCEL,t[n+this._touchend+e],!1),this}}),r.extend(r.DomEvent,{POINTER_DOWN:r.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:r.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:r.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:r.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,n,i){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,n,i);case"touchend":return this.addPointerListenerEnd(t,e,n,i);case"touchmove":return this.addPointerListenerMove(t,e,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,e,n,o){var s=this._pointers,a=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&r.DomEvent.preventDefault(t);for(var e=!1,i=0;i<s.length;i++)if(s[i].pointerId===t.pointerId){e=!0;break}e||s.push(t),t.touches=s.slice(),t.changedTouches=[t],n(t)};if(t["_leaflet_touchstart"+o]=a,t.addEventListener(this.POINTER_DOWN,a,!1),!this._pointerDocumentListener){var l=function(t){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s.splice(e,1);break}};i.documentElement.addEventListener(this.POINTER_UP,l,!1),i.documentElement.addEventListener(this.POINTER_CANCEL,l,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,n,i){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s[e]=t;break}t.touches=s.slice(),t.changedTouches=[t],n(t)}}var s=this._pointers;return t["_leaflet_touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,n,i){var o=this._pointers,s=function(t){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o.splice(e,1);break}t.touches=o.slice(),t.changedTouches=[t],n(t)};return t["_leaflet_touchend"+i]=s,t.addEventListener(this.POINTER_UP,s,!1),t.addEventListener(this.POINTER_CANCEL,s,!1),this},removePointerListener:function(t,e,n){var i=t["_leaflet_"+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,i,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,i,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,i,!1),t.removeEventListener(this.POINTER_CANCEL,i,!1)}return this}}),r.Map.mergeOptions({touchZoom:r.Browser.touch&&!r.Browser.android23,bounceAtZoomLimits:!0}),r.Map.TouchZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),o=e.mouseEventToLayerPoint(t.touches[1]),s=e._getCenterLayerPoint();this._startCenter=n.add(o)._divideBy(2),this._startDist=n.distanceTo(o),this._moved=!1,this._zooming=!0,this._centerOffset=s.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),r.DomEvent.on(i,"touchmove",this._onTouchMove,this).on(i,"touchend",this._onTouchEnd,this),r.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(r.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),r.Util.cancelAnimFrame(this._animRequest),this._animRequest=r.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),r.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getScaleZoom(this._scale);t._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,r.DomUtil.removeClass(t._mapPane,"leaflet-touching"),r.Util.cancelAnimFrame(this._animRequest),r.DomEvent.off(i,"touchmove",this._onTouchMove).off(i,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),o=t.getZoom(),s=t.getScaleZoom(this._scale)-o,a=s>0?Math.ceil(s):Math.floor(s),l=t._limitZoom(o+a),c=t.getZoomScale(l)/this._scale;t._animateZoom(n,l,e,c)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),r.Map.addInitHook("addHandler","touchZoom",r.Map.TouchZoom),r.Map.mergeOptions({tap:!0,tapTolerance:15}),r.Map.Tap=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(r.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new r.Point(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&r.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(r.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),r.DomEvent.on(i,"touchmove",this._onMove,this).on(i,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),r.DomEvent.off(i,"touchmove",this._onMove,this).off(i,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&r.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new r.Point(e.clientX,e.clientY)},_simulateEvent:function(t,e){var o=i.createEvent("MouseEvents");o._simulated=!0,e.target._simulatedClick=!0,o.initMouseEvent(t,!0,!0,n,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(o)}}),r.Browser.touch&&!r.Browser.pointer&&r.Map.addInitHook("addHandler","tap",r.Map.Tap),r.Map.mergeOptions({boxZoom:!0}),r.Map.BoxZoom=r.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){r.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){r.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!(!t.shiftKey||1!==t.which&&1!==t.button)&&(r.DomUtil.disableTextSelection(),r.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void r.DomEvent.on(i,"mousemove",this._onMouseMove,this).on(i,"mouseup",this._onMouseUp,this).on(i,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=r.DomUtil.create("div","leaflet-zoom-box",this._pane),r.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(t),o=i.subtract(e),s=new r.Point(Math.min(i.x,e.x),Math.min(i.y,e.y));r.DomUtil.setPosition(n,s),this._moved=!0,n.style.width=Math.max(0,Math.abs(o.x)-4)+"px",n.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),r.DomUtil.enableTextSelection(),r.DomUtil.enableImageDrag(),r.DomEvent.off(i,"mousemove",this._onMouseMove).off(i,"mouseup",this._onMouseUp).off(i,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,n=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(n)){var i=new r.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(n));e.fitBounds(i),e.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),r.Map.addInitHook("addHandler","boxZoom",r.Map.BoxZoom),r.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),r.Map.Keyboard=r.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),r.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;r.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var t=i.body,e=i.documentElement,o=t.scrollTop||e.scrollTop,s=t.scrollLeft||e.scrollLeft;this._map._container.focus(),n.scrollTo(s,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;n>e;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;n>e;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;n>e;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;n>e;e++)i[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;n>e;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;n>e;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){r.DomEvent.on(i,"keydown",this._onKeyDown,this)},_removeHooks:function(){r.DomEvent.off(i,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[e]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(e in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[e])}r.DomEvent.stop(t)}}),r.Map.addInitHook("addHandler","keyboard",r.Map.Keyboard),r.Handler.MarkerDrag=r.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new r.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),r.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),r.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,n=r.DomUtil.getPosition(t._icon),i=t._map.layerPointToLatLng(n);e&&r.DomUtil.setPosition(e,n),t._latlng=i,t.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),r.Control=r.Class.extend({options:{position:"topright"},initialize:function(t){r.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return r.DomUtil.addClass(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},removeFrom:function(t){var e=this.getPosition();return t._controlCorners[e].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),r.control=function(t){return new r.Control(t)},r.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,o){var s=n+t+" "+n+o;e[t+o]=r.DomUtil.create("div",s,i)}var e=this._controlCorners={},n="leaflet-",i=this._controlContainer=r.DomUtil.create("div",n+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),r.Control.Zoom=r.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=r.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,n,i,o,s){var a=r.DomUtil.create("a",n,i);a.innerHTML=t,a.href="#",a.title=e;var l=r.DomEvent.stopPropagation;return r.DomEvent.on(a,"click",l).on(a,"mousedown",l).on(a,"dblclick",l).on(a,"click",r.DomEvent.preventDefault).on(a,"click",o,s).on(a,"click",this._refocusOnMap,s),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";r.DomUtil.removeClass(this._zoomInButton,e),r.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&r.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&r.DomUtil.addClass(this._zoomInButton,e)}}),r.Map.mergeOptions({zoomControl:!0}),r.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new r.Control.Zoom,this.addControl(this.zoomControl))}),r.control.zoom=function(t){return new r.Control.Zoom(t)},r.Control.Attribution=r.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){r.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=r.DomUtil.create("div","leaflet-control-attribution"),r.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),r.Map.mergeOptions({attributionControl:!0}),r.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new r.Control.Attribution).addTo(this))}),r.control.attribution=function(t){return new r.Control.Attribution(t)},r.Control.Scale=r.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",n=r.DomUtil.create("div",e),i=this.options;return this._addScales(i,e,n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=r.DomUtil.create("div",e+"-line",n)),t.imperial&&(this._iScale=r.DomUtil.create("div",e+"-line",n))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180),i=n*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize(),s=this.options,r=0;o.x>0&&(r=i*(s.maxWidth/o.x)),this._updateScales(s,r)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,n,i,o=3.2808399*t,s=this._iScale;o>5280?(e=o/5280,n=this._getRoundNum(e),s.style.width=this._getScaleWidth(n/e)+"px",s.innerHTML=n+" mi"):(i=this._getRoundNum(o),s.style.width=this._getScaleWidth(i/o)+"px",s.innerHTML=i+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}}),r.control.scale=function(t){return new r.Control.Scale(t)},r.Control.Layers=r.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,n){r.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var i in t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=r.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=r.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),r.Browser.touch?r.DomEvent.on(e,"click",r.DomEvent.stopPropagation):r.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var n=this._form=r.DomUtil.create("form",t+"-list");if(this.options.collapsed){r.Browser.android||r.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var i=this._layersLink=r.DomUtil.create("a",t+"-toggle",e);i.href="#",i.title="Layers",r.Browser.touch?r.DomEvent.on(i,"click",r.DomEvent.stop).on(i,"click",this._expand,this):r.DomEvent.on(i,"focus",this._expand,this),r.DomEvent.on(n,"click",function(){setTimeout(r.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=r.DomUtil.create("div",t+"-base",n),this._separator=r.DomUtil.create("div",t+"-separator",n),this._overlaysList=r.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_addLayer:function(t,e,n){var i=r.stamp(t);this._layers[i]={layer:t,name:e,overlay:n},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,n=!1,i=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),i=i||e.overlay,n=n||!e.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(t){var e=this._layers[r.stamp(t.layer)];if(e){this._handlingClick||this._update();var n=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)}},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(n+=' checked="checked"'),n+="/>";var o=i.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var e,n=i.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?(e=i.createElement("input"),e.type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=o):e=this._createRadioElement("leaflet-base-layers",o),e.layerId=r.stamp(t.layer),r.DomEvent.on(e,"click",this._onInputClick,this);var s=i.createElement("span");return s.innerHTML=" "+t.name,n.appendChild(e),n.appendChild(s),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),n},_onInputClick:function(){var t,e,n,i=this._form.getElementsByTagName("input"),o=i.length;for(this._handlingClick=!0,t=0;o>t;t++)e=i[t],n=this._layers[e.layerId],e.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!e.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){r.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),r.control.layers=function(t,e,n){return new r.Control.Layers(t,e,n)},r.PosAnimation=r.Class.extend({includes:r.Mixin.Events,run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[r.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",r.DomEvent.on(t,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this),r.DomUtil.setPosition(t,e),r.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(r.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(r.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),r.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,e,i,o=this._el,s=n.getComputedStyle(o);if(r.Browser.any3d){if(!(i=s[r.DomUtil.TRANSFORM].match(this._transformRe)))return;t=parseFloat(i[1]),e=parseFloat(i[2])}else t=parseFloat(s.left),e=parseFloat(s.top);return new r.Point(t,e,!0)},_onTransitionEnd:function(){r.DomEvent.off(this._el,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[r.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),r.Map.include({setView:function(t,e,n){if(e=e===o?this._zoom:this._limitZoom(e),t=this._limitCenter(r.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&!0!==n){n.animate!==o&&(n.zoom=r.extend({animate:n.animate},n.zoom),n.pan=r.extend({animate:n.animate},n.pan));if(this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan))return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=r.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new r.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){r.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){r.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n))&&(this.panBy(n,e),!0)}}),r.PosAnimation=r.DomUtil.TRANSITION?r.PosAnimation:r.PosAnimation.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=r.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=r.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));r.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){r.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),r.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),r.DomUtil.TRANSITION&&r.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&r.DomUtil.TRANSITION&&r.Browser.any3d&&!r.Browser.android23&&!r.Browser.mobileOpera,this._zoomAnimated&&r.DomEvent.on(this._mapPane,r.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),r.Map.include(r.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i),s=this._getCenterLayerPoint()._add(o);return!(!0!==n.animate&&!this.getSize().contains(o))&&(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,s,i,null,!0),!0)},_animateZoom:function(t,e,n,i,o,s,a){a||(this._animatingZoom=!0),r.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,r.Draggable&&(r.Draggable._disabled=!0),r.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:n,scale:i,delta:o,backwards:s}),setTimeout(r.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,r.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),r.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),r.Draggable&&(r.Draggable._disabled=!1)},this))}}:{}),r.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,n=r.DomUtil.TRANSFORM,i=t.delta?r.DomUtil.getTranslateString(t.delta):e.style[n],o=r.DomUtil.getScaleString(t.scale,t.origin);e.style[n]=t.backwards?o+" "+i:i+" "+o},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),r.Util.falseFn(e.offsetWidth);var n=this._map.getZoom();(n>this.options.maxZoom||n<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[r.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,n=this._getLoadedTilesPercentage(e),i=this._getLoadedTilesPercentage(t);return e&&n>.5&&.5>i?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[r.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,n,i=t.getElementsByTagName("img"),o=0;for(e=0,n=i.length;n>e;e++)i[e].complete&&o++;return o/n},_stopLoadingImages:function(t){var e,n,i,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,n=o.length;n>e;e++)i=o[e],i.complete||(i.onload=r.Util.falseFn,i.onerror=r.Util.falseFn,i.src=r.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),r.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=r.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=r.bind(this._handleGeolocationResponse,this),n=r.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,n=t.coords.longitude,i=new r.LatLng(e,n),o=180*t.coords.accuracy/40075017,s=o/Math.cos(r.LatLng.DEG_TO_RAD*e),a=r.latLngBounds([e-o,n-s],[e+o,n+s]),l=this._locateOptions;if(l.setView){var c=Math.min(this.getBoundsZoom(a),l.maxZoom);this.setView(i,c)}var u={latlng:i,bounds:a,timestamp:t.timestamp};for(var h in t.coords)"number"==typeof t.coords[h]&&(u[h]=t.coords[h]);this.fire("locationfound",u)}})}(window,document)}).call(e,n(18)(t))},90:function(t,e){!function(t,e,n,i){"use strict";var o=i.WKT,s=n.Basic.Extend,r=n.Basic.getView,a=n.Tools.FuncTools.multi,l={geoObjectDefaults:{},types:{},getGeoObjectParams:function(){return{}},events:{attributionControl:!1,scrollWheelZoom:!1},map:{bounds:{},center:[55.75297,37.62456],zoom:9,minZoom:0,maxZoom:18,scrollWheelZoom:!1,server:"https://c.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:[['<a href="http://leafletjs.com/" target="_blank">Leaflet</a>'," | ",'&copy; <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a>'].join("")]}};r(function(){function t(t){var e=L.control.attribution({prefix:""});return t.forEach(function(t){e.addAttribution(t)}),e}function e(t){return L.latLngBounds(L.latLng(+t.south,+t.west),L.latLng(+t.north,+t.east))}function n(t){return 4===Object.keys(t).filter(function(e){return null!==t[e]&&void 0!==t[e]}).length}var i=function(t){return function(e){e.addTo(t)}},r=a(function(t){return void 0===t||null===t?"default":t.icon?"icon":"basic"}).method("default",function(t){return this._opts.geoObjectDefaults}).method("basic",function(t){return s(!0,{},this._opts.geoObjectDefaults,t)}).method("icon",function(t){return s(!0,{},this._opts.geoObjectDefaults,{pointToLayer:function(e,n){return L.marker(n,{icon:L.icon(t.icon)})}})}),l=function(){var t=this._elems.parent.get(0),i=this._opts.events,o=L.map(t,i);return o.setView(this._opts.map.center,this._opts.map.zoom),n(this._opts.map.bounds)&&o.setMaxBounds(e(this._opts.map.bounds)),o},c=function(t){return t.map(function(t){var e=o.parse(t.geo),n=this._opts.getGeoObjectParams.call(this,t),i=r.call(this,n),s=L.geoJson(e,i),a=t.desc||t.title||t.subtitle;return a&&(s.bindPopup(a),t.active&&setTimeout(function(){s.openPopup()})),s}.bind(this))};return{_Init:function(e){this._map=l.call(this),[t(this._opts.map.attribution),L.tileLayer(this._opts.map.server,{minZoom:Math.max(0,this._opts.map.minZoom||0),maxZoom:Math.min(18,this._opts.map.maxZoom||18)})].concat(c.call(this,e.objects||[])).forEach(i(this._map))}}}(),l,null,"MapLeafletView")}(window.jQuery||window.$,window,window.ru.mail.cpf,window.Terraformer)},91:function(t,e){!function(t,e,n){"use strict";var i=n.Basic,o=n.Tools,s=n.Mixins,r=i.getView,a=i.Extend,l=(o.initModule,o.Auth.getAccountsList),c=n.Types.String.supplant,u=n.Tools.PubSub,h="mail.ru"!==document.domain.split(".").slice(-2).join(".")?"https://portal.devmail.ru/NaviData":"https://portal.mail.ru/NaviData",p={api:{tsPropName:"news_ts"},popupExt:"Comments.Payment.Success",transport:null,interval:1500};r(function(){function t(){var t=this._opts.transport||this.transport,n=[t({url:h,dataType:"jsonp",data:{News:1}}),l()];return this._trigger("dataFetching"),Promise.all(n).then(e.bind(this))}function e(t){var e=this._opts.api.tsPropName,i=t[0].data[e]||Math.floor(Date.now()/1e3),s=t[1];if(this._trigger("dataReceived"),"ok"==t[0].status){var r={user:o(s),initialTs:i};p.call(this,r),this._trigger("initialDataUpdated",r),n.call(this)}else this._trigger("initialDataFailed")}function n(){i.call(this),this._checker=setInterval(i.bind(this),this._opts.interval)}function i(){var t=this._opts,e=t.api,n=t.transport||this.transport,i=this._state.user;n({url:h,dataType:"jsonp",data:{News:1}}).then(function(t){var n=t.data;n.email===i.email&&n[e.tsPropName]>this._state.initialTs&&(clearInterval(this._checker),this._trigger("paymentTsUpdated"),u.publish("comments.payment.update"))}.bind(this))}function o(t){return t.reduce(function(t,e){return e.active&&(t.email=e.email,t.name=r(e)),t},{})}function r(t){return c("${firstName} ${lastName}",{firstName:t.firstName||"",lastName:t.lastName||""})}function p(t){this._state=a({},this._state,t),this._trigger("stateUpdated")}return{_mixins:[s.transport],_Events:["stateUpdated","dataFetching","dataReceived","dataFailed","initialDataUpdated","initialDataFailed","paymentTsUpdated"],_Init:function(){this._checker=null,t.call(this)},getState:function(){return a(!0,{},this._state)}}}(),p,null,"CommentsPayment")}(window.jQuery||window.$,window,window.ru.mail.cpf)},92:function(t,e,n){!function(t,e,n){"use strict";function i(t){t&&((new Image).src="//rs.mail.ru/sb"+t+".gif?r="+Math.round(1e11*Math.random()))}var o=n.Basic,s={cssSels:{lazyEmbed:".js-slider__lazyembed"},cssClss:{animatedControl:"animated"},attrs:{activated:"data-embed-activated",type:"data-type",clickCounter:"data-first-click",resizable:"data-embed-resizable"},embedTypesToWatch:["vk_post"],preloadDepth:1,checkHightTimeout:500,minItemHeight:300},r=function e(i){var o=this._Opts,s=o.attrs,r=i.filter(function(t,e){return!e.getAttribute(s.activated)});if(r.length){r.attr(s.activated,"1");var a=r.find(this._Opts.cssSels.lazyEmbed);a.length&&(a.each(function(t,e){-1!==o.embedTypesToWatch.indexOf(e.getAttribute(s.type))&&r.eq(t).attr(s.resizable,1)}),h.call(this,a.eq(0).parent()),n.Tools.activateEmbeds(a,{closestParent:".js-slider__item"}).forEach(function(n){n.then(function(){this.update()}.bind(this),function(n){t(n.element).remove(),this.update(!0).then(function(){e.call(this,d.call(this,this.getPageNo()))}.bind(this))}.bind(this))}.bind(this)))}},a=function(){var t=0,e=p.call(this);e.length&&e.each(function(e,n){t=Math.max(t,n.offsetHeight)}),t&&this._Elems.content.height(t)},l=function(t){var e=0;return t.each(function(t,n){e=Math.max(e,n.offsetHeight)}),e},c=function(t){return l.call(this,p.call(this,t))||0},u=function t(e){var n=this._State;if(clearTimeout(n.watchTimeoutId),e&&e.length&&e.parent().length){var i=l(e);n.frameHeight!==i&&(n.frameHeight=i,a.call(this)),n.watchTimeoutId=setTimeout(t.bind(this,e),this._Opts.checkHightTimeout)}},h=function(t,e){e||(e=[1e3,1500,2e3,3e3,5e3,1e4]);var n=c.bind(this),i=n(),o=t.trigger.bind(t,"documentHeightChange"),s=this.update.bind(this);e.forEach(function(t){setTimeout(function(){var t=n();t!==i&&(s(),o(),i=t)},t)})},p=function(e,n){isNaN(e)&&(e=this.getPageNo());var i=this.getPages(),o=t(i[e]&&i[e].frames),s=this._Opts.attrs.resizable;return n&&(o=o.filter(function(t,e){return!!e.getAttribute(s)})),o},d=function(e,n){e=e||0,n=n||2;for(var i=t(),o=p.bind(this),s=e+n,r=Math.max(0,e-n);r<=s;r++)i=i.add(o(r));return i},f=function(t){var e,n=this._Elems,i=this._State,o=Math.max(c.call(this,t),this._Opts.minItemHeight),s=!1,r=!1,a=(i.frameHeight||0)/2,l=i.controlHeight,u=this._Opts.cssClss.animatedControl;"buttonsTopShift"in i||(a<5&&(a=this._Elems.container.height()/2),n.shiftedButtons=n.controlNext.add(n.controlPrev),n.shiftedButtons.removeClass(u),i.buttonsTopShift=n.shiftedButtons.get(0).offsetTop+l/2,s=r=!0),o&&a>o-l&&(e=Math.max(o,l)/2)<i.buttonsTopShift&&(i.buttonsTopShift=e,s=!0),i.buttonsTopShift<l/2&&(i.buttonsTopShift=l/2),s&&(n.shiftedButtons.css({top:i.buttonsTopShift}),r&&n.shiftedButtons.addClass(u))};o.Constructors.addPlugin("Slider",{_Handlers:{beforeSlide:function(t,e){var n=this._Elems;n.shiftedButtons||(n.shiftedButtons=n.controlNext.add(n.controlPrev),this._State.controlHeight=l(n.shiftedButtons)),f.call(this,e),this._State.firstClick||(this._State.firstClick=!0,i(n.Parent.attr(this._Opts.attrs.clickCounter)))},slide:function(e,n){for(var i=[n],o=t(),s=1;s<=this._Opts.preloadDepth;s++)i.push(n+s),n-s>=0&&i.push(n-s);i.forEach(function(t){o=o.add(p.call(this,t))},this);var l=p.call(this,n,!0);o&&o.length&&r.call(this,o),clearTimeout(this._State.watchTimeoutId),l&&l.length?u.call(this,l):this._State.frameHeight=c.call(this,n),a.call(this),this.update()}},_Init:function(){this._State||(this._State={}),r.call(this,d.call(this)),u.call(this,p.call(this,0)),this._Elems.content.on("documentHeightChange",a.bind(this))}},s,"EmbedList")}(window.jQuery||window.$,window,window.ru.mail.cpf)},93:function(t,e,n){"use strict";var i=n(70),o=(n.n(i),n(71)),s=(n.n(o),n(94));n.n(s)},94:function(t,e){!function(t,e,n){"use strict";var i=n.Basic.moduleOpts.setParams;i("CustomScroll",{options:{cssSels:{Main:{scrollBar:".js-scrollbar",scrollView:".js-scrollable__view"},scrollBar:{scrollThumb:".js-scrollbar__track",scrollThumbBody:".js-scrollbar__track__drag"},scrollThumbSize:".js-scrollbar__track__drag__point"},disabledScrollBody:{mouse:!0,touch:!0}}}),i("CustomScroll.Popup",{options:{_Handlers:{init:function(){setTimeout(this.Resize.bind(this),100)}}}})}(window.jQuery,window,window.ru.mail.cpf)},95:function(t,e){!function(t,e,n){var i,o,s,r,a=n.Basic,l=a.moduleOpts,c=n.Tools,u=c.initModule,h=c.PubSub,p=c.Images.preloadImage,d=c.Counters.hitCntrsBlck,f=a.typeOf,m=n.Modules.Slider,_=l.setParams,g=e.getNameSpace("Modules",n),v={cssSels:{Main:{container:".js-photo-stories__container",viewport:".js-photo-stories__viewport",content:".js-photo-stories__content",frames:".js-photo-stories__items",startFrame:".js-photo-stories__item-start",controlNext:".js-photo-stories__next",controlPrev:".js-photo-stories__prev",controlPage:".js-photo-stories__preview",controlPagesList:".js-photo-stories__previews",previewsSlider:".js-photo-stories__list",banner:".js-photo-stories__banner"},frame:".js-photo-stories__item"},cssClss:{currentPage:"m-photo-stories__preview_active",currentPageFrame:"m-photo-stories__item_active",animatedCont:"m-photo-stories__items_animated",disabledControl:"hidden",img:"js-photo-item"},loop:!0,pageSize:1,align:"center",scrollTo:!0,scrollToDelta:-8,hitVirtualPhoto:!0,useBanner:!0,bannerViewName:"SlotView",usePreviews:!0,preloadDepth:2,previewsSliderOpts:{cssSels:{Main:{container:".js-photo-stories__list-wrap",content:".js-photo-stories__previews"},frame:".js-photo-stories__preview"},cssClss:{animatedCont:"m-photo-stories__items_animated",disabledControl:"hidden"},pageSize:"auto",align:"left"}},y=function(t){return new Promise(function(e,n){setTimeout(function(){if(t.complete)return void e();var i=function n(){clearTimeout(o),t.removeEventListener("load",n),e()},o=setTimeout(function(){t.removeEventListener("load",i),n(new Error("Timeout expired"))},1e3);t.addEventListener("load",i)},0)})},P=a.Constructors.getView(function(){return{_Handlers:{beforeSlide:function(){this._opts.useBanner&&this.reloadBanner();var t=this.getStoryShareUrl();this.setStoryShareUrl(t),this.pushStateUrl(t)},slide:function(t){var e=this._opts;e.usePreviews&&this._previewsSlider.goToFrame(t,!0),e.scrollTo&&!this.isTouch&&this.scrollTop(),e.hitVirtualPhoto&&this.hitVirtualPhoto(),this.preloadLazyPhotos(t)},swipeStart:function(){var t=this._State;i=t.isSwipingForward,o=t.position,r=o-s},swipeEnd:function(){var t=this._State;i!==t.isSwipingForward||(s=t.position);var e=o-s;Number.isNaN(r)||Number.isNaN(e)||r!==e&&this.scrollTop()}},_Init:function(){var e=this;this.isTouch=!!t.zepto,this._initialUpdate.then(function(){setTimeout(function(){e.setStoryShareUrl(e.getStoryShareUrl())},600),e.startLazyLoad(),e._opts.usePreviews&&(e._previewsSlider=null,e.initPreviews())})},initPreviews:function(){var t=this._elems.previewsSlider,e=this.getFrameNo();this._previewsSlider||(this._previewsSlider=u("Slider",t,this._opts.previewsSliderOpts),this._previewsSlider.goToFrame(e,!0))},startLazyLoad:function(){var t=new Array(this._State.$frames.length||0);t.fill(!1),this.photosLoaded=t;var e=this.getFrameNo();this.preloadLazyPhotos(e)},preloadLazyPhotos:function(t){var e=this,n=this._State.$frames.length,i=this._opts.preloadDepth,o=this.photosLoaded,s=[t],r=[];if(i>0){var a=i;for(a;a>0;a--){var l=t-a,c=t+a;l<0&&(l+=n),c>=n&&(c-=n),s.push(l,c)}}return s.forEach(function(t){o[t]||(r.push(e.initLazyPhoto(t)),o[t]=!0)}),Promise.all(r).then(function(t){return t.length?e.update(!0).then(function(){return t}):Promise.resolve(t)})},initLazyPhoto:function(t){var n=this._State.$frames,i=n.length,o=".".concat(this._opts.cssClss.img),s=t;s<0&&(s+=i),s>=i&&(s-=i);var r=n.eq(s).find(o).get(0),a=r.getAttribute("data-src");return p(a).then(function(t){return r.src=a,r.complete?t:y(r).then(function(){return t})}).catch(function(t){e.console.error(t)})},initAllLazyPhotos:function(){var t=this,e=this._State.$frames,n=[];return Object.keys(e).forEach(function(e){n.push(t.initLazyPhoto(e))}),Promise.all(n).then(function(e){return e.length?t.update(!0).then(function(){return e}):Promise.resolve(e)})},getStoryShareUrl:function(){return this.getCurrentFrame().attr("data-href")},setStoryShareUrl:function(t){h.publish("setStoryShareUrl",t)},pushStateUrl:function(t){t&&e.history.replaceState({},"",t)},reloadBanner:function(){this._elems.banner.data(this._opts.bannerViewName).reload(!0)},hitVirtualPhoto:function(){var t=this.getStoryShareUrl();t&&d({url:t})},scrollTop:function(){var n=this._opts,i=n.scrollTo,o=n.scrollToDelta,s=e.pageYOffset;if(i){var r=this._elems.parent;"string"===f(i)&&t(i).length&&(r=t(i));var a=r.offset(),l=a.top;l+=o;var c=s-l,u=c<1400?Math.round(c/2):1e3;c>0&&(this.isTouch?e.scrollTo(0,l):t("html, body").animate({scrollTop:l},u))}}}}(),v,m,"PhotoStories");_("".concat("PhotoStories",".Touch"),{options:{align:"left",scrollToDelta:0,useBanner:!1,usePreviews:!1}}),g.PhotoStories=P}(window.$,window,window.ru.mail.cpf)}})});
//# sourceMappingURL=page-news.js.map