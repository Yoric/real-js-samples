(function(g){var f=window.AmazonUIPageJS||window.P,k=f._namespace||f.attributeErrors,a=k?k("CSHelpVideoPlayerJS"):f;a.guardFatal?a.guardFatal(g)(a,window):a.execute(function(){g(a,window)})})(function(g,f,k){g.when("jQuery").register("microfiche",function(a){f.Microfiche=function(a){this.initialize(a);return this};Microfiche.VERSION="1.8.0";a.extend(Microfiche.prototype,{options:{autoplay:!1,autopause:!1,buttons:!0,bullets:!0,cyclic:!1,keyboard:!1,swipe:!0,clickToAdvance:!1,minDuration:250,duration:500,
maxDuration:500,dragThreshold:25,elasticity:.5,swipeThreshold:.125,refreshOnResize:!1,prevButtonLabel:"&larr;",nextButtonLabel:"&rarr;",noScrollAlign:"left"},x:0,initialize:function(b){this.options=a.extend({},this.options,b);this.el=a(b.el);this.initialContents=this.el.contents();this.el.data("microfiche",this);this.createFilm();this.createScreen();this.calibrate();this.film.width()<=this.screen.width()?(this.noScrollAlign(this.options.noScrollAlign),this.refreshOnResize(this.options.refreshOnResize)):
(this.createControls(),this.enableTouch(),this.enableKeyboard(),this.enableClick(),this.prepareCyclic(),this.run(this.options))},createFilm:function(){this.film=a('<div class="microfiche-film">').css({position:"absolute"});this.el.children().appendTo(this.film).css({"float":"left"});this.prepareFilm&&this.prepareFilm()},createScreen:function(){this.screen=a('<div class="microfiche-screen">').css({position:"relative",overflow:"hidden"}).appendTo(this.el).append(this.film)},prepareCyclic:function(){if(this.options.cyclic){var a=
this.film.clone(),d=this.film.clone(),c=this.film.width();a.prependTo(this.film).css({position:"absolute",left:-c+"px"});d.appendTo(this.film).css({position:"absolute",left:c+"px"})}},calibrate:function(){this.screen.width(1E5);var a=this.film.width(),d=this.film.height();this.film.width(a).height(d);this.screen.width("auto").height(d)},createControls:function(){var b=this;this.controls=a('<span class="microfiche-controls" />').appendTo(this.el);this.controls.delegate("a, button","click",function(a){b.didClickControl(a)});
this.options.bullets&&this.createBullets();this.options.buttons&&this.createButtons();this.updateControls()},createBullets:function(){for(var b=a('<span class="microfiche-bullets" />').appendTo(this.controls),d=0;d<this.totalPageCount();d++)a("<button>").addClass("microfiche-bullet").attr("data-microfiche-page",d).data("action","slideToPage").data("arguments",[d]).html(d+1).appendTo(b)},createButtons:function(){a("<button>").addClass("microfiche-button microfiche-prev-button").attr("rel","prev").data("action",
"prev").data("arguments",[]).html(this.options.prevButtonLabel).prependTo(this.controls);a("<button>").addClass("microfiche-button microfiche-next-button").attr("rel","next").data("action","next").data("arguments",[]).html(this.options.nextButtonLabel).appendTo(this.controls)},enableTouch:function(){if(this.options.swipe){var a=this,d=this.touchstart,c=this.touchmove,f=this.touchend;this.touchstart=function(){d.apply(a,arguments)};this.touchmove=function(){c.apply(a,arguments)};this.touchend=function(){f.apply(a,
arguments)};this.film.delegate("microfiche-film","touchstart",this.touchstart)}},enableKeyboard:function(){if(this.options.keyboard){var b=this;this.screen.attr("data-microfiche-keyboard",!0);var d=this.onkeydown;this.onkeydown=function(){d.apply(b,arguments)};a(document).delegate("body","keydown",this.onkeydown)}},enableClick:function(){if(this.options.clickToAdvance){var a=this,d=this.onmousedown;this.onmousedown=function(){d.apply(a,arguments)};this.film.delegate("microfiche-film","mousedown",
this.onmousedown)}},didClickControl:function(b){b.preventDefault();var d=a(b.target);b=d.data("action");d=d.data("arguments");this[b].apply(this,d)},touchstart:function(b){!(b=b.originalEvent.targetTouches)||1<b.length||(this.touchState={then:new Date,ox:b[0].pageX,oy:b[0].pageY,isDrag:!1},a(document).delegate("body","touchmove",this.touchmove).delegate("body","touchend",this.touchend))},touchmove:function(a){var d=a.originalEvent.targetTouches[0],c=d.pageX-this.touchState.ox,f=d.pageY-this.touchState.oy;
if(!this.touchState.isDrag){if(Math.abs(f)>=this.options.dragThreshold){this.touchend();return}Math.abs(c)>=this.options.dragThreshold&&(this.touchState.isDrag=!0)}this.touchState.isDrag&&(a.preventDefault(),a=new Date,d=a-this.touchState.then,this.touchState.vx=(c-this.touchState.dx)/d,this.touchState.vy=(f-this.touchState.dy)/d,this.touchState.dx=c,this.touchState.dy=f,this.touchState.then=a,this.touchState.cx=this.x-c,this.options.cyclic||(this.touchState.cx<this.min()&&(d=this.min()-this.touchState.cx,
d*=this.options.elasticity,this.touchState.cx=this.min()-d),this.touchState.cx>this.max()&&(d=this.touchState.cx-this.max(),d*=this.options.elasticity,this.touchState.cx=this.max()+d)),this.film.css({WebkitTransition:"none",WebkitTransform:"translate3d("+-this.touchState.cx+"px, 0px, 0px)"}))},touchend:function(b){a(document).undelegate("touchmove",this.touchmove).undelegate("touchend",this.touchend);if(this.touchState.isDrag){b=this.touchState.dx;var d=this.screenWidth(),c=this.touchState.vx,f=this.options.swipeThreshold;
b<=-d*f?this.slideByPages(1,c):b>=d*f?this.slideByPages(-1,c):this.slideByPages(0)}},onkeydown:function(a){37!==a.keyCode&&39!==a.keyCode||!this.isCentral("[data-microfiche-keyboard]")||(37===a.keyCode?this.slideByPages(-1):39===a.keyCode&&this.slideByPages(1))},onmousedown:function(a){this.slideByPages(1)},updateControls:function(){this.options.bullets&&this.updateBullets();this.options.buttons&&this.updateButtons()},updateBullets:function(){this.controls.find(".microfiche-bullet").removeClass("selected");
this.controls.find('[data-microfiche-page="'+this.currentPageIndex()+'"]').addClass("selected")},updateButtons:function(){this.options.cyclic||(this.controls.find('[rel="prev"]').attr("disabled",this.x<=this.min()),this.controls.find('[rel="next"]').attr("disabled",this.x>=this.max()))},round:function(a){var d=this.screenWidth();return Math.round(a/d)*d},constrain:function(a,d,c){d===k&&(d=this.min());c===k&&(c=this.max());return Math.max(d,Math.min(a,c))},roundAndConstrain:function(a,d,c){return this.constrain(this.round(a),
d,c)},withinBounds:function(a){return this.min()<=a&&a<=this.max()},min:function(){return 0},max:function(){return this.film.width()-this.screenWidth()},currentPageIndex:function(){return Math.round(this.x/this.screenWidth())},totalPageCount:function(){return Math.ceil(this.film.width()/this.screenWidth())},screenWidth:function(){return this.el.width()},isCentral:function(b){return a(a(b||".microfiche-screen").sort(function(b,c){return Math.abs(1-(a(f).scrollTop()+a(f).height()/2-a(b).height()/2)/
a(b).offset().top)-Math.abs(1-(a(f).scrollTop()+a(f).height()/2-a(c).height()/2)/a(c).offset().top)})[0]).parent().data("microfiche")===this},jump:function(){this.el.trigger("microfiche:willMove");this.performJump();this.updateControls();this.el.trigger("microfiche:didMove")},performJump:function(){this.film.css({left:-this.x})},transition:function(a){var d=this;this.options.cyclic&&this.handleWrappingTransition();null==a&&(a=this.options.duration);var c=function(){d.afterTransition()};this.el.trigger("microfiche:willMove");
setTimeout(function(){d.performTransition(a,c)})},handleWrappingTransition:function(){this.x>this.max()?(this.x=this.min()-this.screenWidth(),this.touchState&&this.touchState.dx&&(this.x-=this.touchState.dx),this.jump(),this.x=this.min(),this.updateControls()):this.x<this.min()&&(this.x=this.max()+this.screenWidth(),this.touchState&&this.touchState.dx&&(this.x-=this.touchState.dx),this.jump(),this.x=this.max(),this.updateControls())},performTransition:function(a,d){this.film.stop().animate({left:-this.x+
"px"},a,d)},afterTransition:function(){delete this.touchState;this.el.trigger("microfiche:didMove")},slideByPages:function(a,d){var c=this.x,f=this.screenWidth();this.x=this.constrain((Math.round(this.x/f)+a)*f);this.options.cyclic&&this.x==c&&(this.x+=a*f);c=d?this.constrain(Math.abs((this.x-c)/d),this.options.minDuration,this.options.maxDuration):this.options.duration;this.updateControls();this.transition(c)},slideToPage:function(a){this.x=this.constrain(a*this.screenWidth());this.updateControls();
this.transition()},slideToPoint:function(a){this.x=this.roundAndConstrain(a);this.updateControls();this.transition()},jumpToPage:function(a){this.x=this.constrain(a*this.screenWidth());this.updateControls();this.jump()},jumpToPoint:function(a){this.x=this.roundAndConstrain(a);this.updateControls();this.jump()},prev:function(){this.slideByPages(-1)},next:function(){this.slideByPages(1)},autoplay:function(a){this.autoplayTimeout&&(clearInterval(this.autoplayTimeout),delete this.autoplayTimeout);a=+a;
if(!(isNaN(a)||0>=a)){var d=this;this.autoplayTimeout=setInterval(function(){d.pause||d.next()},1E3*a)}},autopause:function(){var a=this;this.el.hover(function(){a.pause=!0},function(){a.pause=!1})},destroy:function(){this.el.empty();this.el.undelegate();this.clearResizeHandler();this.el.removeData("microfiche")},refresh:function(){var b=this.el.data("microfiche").options,d=this.getContents();this.destroy();this.el.append(d);new Microfiche(a.extend({el:this.el},b));return this.el},getContents:function(){return this.contentsChanged()?
this.el.html():this.el.data("microfiche").initialContents},contentsChanged:function(){return 0===this.el.find(".microfiche-screen").length},refreshOnResize:function(b){this.options.refreshOnResize=b;this.resizeHandler&&this.clearResizeHandler();if(!1!==b){!0===b&&(b=250);var d=this,c;d.resizeHandler=function(){c&&clearTimeout(c);c=setTimeout(function(){d.refresh()},b)};a(f).resize(d.resizeHandler)}},clearResizeHandler:function(){a(f).unbind("resize",this.resizeHandler)},noScrollAlign:function(a){if(!(this.film.width()>
this.screen.width()))switch(a){case "center":this.film.css({left:"50%",marginLeft:this.film.width()/2*-1+"px",right:"auto"});break;case "right":this.film.css({left:"auto",marginLeft:"auto",right:0});break;default:this.film.css({left:0,marginLeft:"auto",right:"auto"})}},run:function(b){for(var d in b){var c=this[d];a.isFunction(c)&&c.call(this,b[d])}}});"WebKitCSSMatrix"in f&&"m11"in new WebKitCSSMatrix&&a.extend(Microfiche.prototype,{prepareFilm:function(){this.film.css({WebkitTransform:"translate3d(0px, 0px, 0px)"})},
performTransition:function(a,d){this.film.one("webkitTransitionEnd",d).css({WebkitTransition:"-webkit-transform "+a+"ms",WebkitTransform:"translate3d("+-this.x+"px, 0px, 0px)"})},performJump:function(){this.film.css({WebkitTransition:"-webkit-transform 0ms",WebkitTransform:"translate3d("+-this.x+"px, 0px, 0px)"})}});a.fn.microfiche=function(b){return this.each(function(){var d=a(this).data("microfiche");d?d.run(b):new Microfiche(a.extend({el:this},b))})}});g.when("jQuery","viddler-video-playlist").execute("video-player-display",
function(a){var b=a(".playlist-initial-video");a=a(".playlist-video-embed");if(b.length){var d=b.first().data("initial-video-id");d&&a.data("initial-video-id",d);(b=b.first().data("autoplay"))&&a.data("autoplay",b)}a.playlistEmbed()});g.when("jQuery","microfiche").register("viddler-video-playlist",function(a){function b(b,c){return a.ajax({url:"//api.viddler.com/api/v2/viddler.playlists.getDetails.jsonp",data:{key:"1jdn52tb3h1d9bjub21a",playlist_id:b,per_page:100},dataType:"jsonp",success:c})}
function d(b,c){c||(c={});var d="//www.viddler.com/embed/"+b+"/";c.autoplay&&(d+="?autoplay=1");return a("<iframe>",{src:d,height:"372",frameborder:"0",allowfullscreen:!0,id:"video-iframe"})}function c(b){var c=a("<div>",{"class":"thumbs-container"}),d=a("<ul>");a.each(b,function(b,c){var e=a("<a>",{"data-video-id":c.id}),f=a("<img>",{src:c.thumbnail_url.replace("http:",""),alt:c.title});e.append(f);e.append(a("<span>").text(c.title));e=a("<li>").append(e);d.append(e)});c.append(d);return c}function g(){a(document).delegate(".thumbs-container a",
"click",function(){a("html,body").animate({scrollTop:a("body").offset().top},"slow");var b=d(a(this).data("video-id"),{autoplay:!0});a("#video-iframe").replaceWith(b)})}a.fn.playlistEmbed=function(){g();this.each(function(){var e=[],g=[],h=a(this),k=h.data("playlist-ids").split(" ");a.each(k,function(d,k){g.push(b(k,function(b){b=b.list_result.video_list;var d=c(b);h.append(d);var g=function(){var a=2;768<=h.width()?a=6:480<=h.width()&&(a=4);a=h.width()/a-14;a=parseInt(a,10);d.find("li, img").css({width:a});
a=parseInt(.5625*a,10);d.find("img").css({height:a});h.find(".thumbs-container").css("height",a+54+"px")};g();d.microfiche({bullets:!1,prevButtonLabel:"&lt;",nextButtonLabel:"&gt;",refreshOnResize:!0});a(f).resize(g);a.each(b,function(a,b){e.push(b.id)})}))});a.when.apply(a,g).then(function(){var b=e[0];h.data("initial-video-id")&&0<=a.inArray(h.data("initial-video-id"),e)&&(b=h.data("initial-video-id"));b=d(b,{autoplay:h.data("autoplay")});h.prepend(b)})})}})});