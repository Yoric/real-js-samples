this.MeControl=this.MeControl||{},this.MeControl.WebInline=function(t){"use strict";var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},n=window;var e=n.requestAnimationFrame?function(e){return n.requestAnimationFrame(e)}:function(e){return setTimeout(e)},r="mectrl",o="_",a=new RegExp("^"+r,"i");function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.join(o);return a.test(n)||(n=r+o+n),n}var s="MeControlError::";function d(e,t){void 0===t&&(t=!1);var n=new Error(""+s+e);return n.mcIsTimeout=t,n}var u=function(){function e(e,t){this.type=e,this.detail=t,this._defaultPrevented=!1}return Object.defineProperty(e.prototype,"defaultPrevented",{get:function(){return this._defaultPrevented},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){this._defaultPrevented=!0},e}(),l=function(){function e(){this._listeners={}}return e.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]),this._listeners[e].push(t)},e.prototype.removeEventListener=function(e,t){if(e in this._listeners){var n=this._listeners[e].indexOf(t);-1!==n&&this._listeners[e].splice(n,1)}},e.prototype.dispatchEvent=function(e){if(!(e.type in this._listeners))return!0;for(var t=this._listeners[e.type],n=new u(e.type,e.detail),r=0,o=t.length;r<o;r++)t[r].call(this,n);return!n.defaultPrevented},e}(),m=n.MeControl=n.MeControl||{};function f(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var p,v=Object.assign||i;function g(){return p}function h(e){p=e}var y,C={};function w(e,t){C[e]=C[e]||{},v(C[e],t)}var b=Date.now?function(){return Date.now()}:function(){return+new Date},I=n.performance&&n.performance.now?function(){return performance.now()}:b,N=function(){return n.performance&&n.performance.getEntries?window.performance.getEntries():[]};function A(){var i,a=[],c=0;function s(e){var t=e.name;i&&f(i,t)&&i[t].apply(i,e.params)}return{setComponent:function(e){i=e;var t=a;a=[];for(var n=0;n<t.length;n++)s(t[n])},handleCall:function(r,o){return void 0===o&&(o=!1),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={name:r,params:e};i?s(n):a.splice(o?c++:a.length,0,n)}}}}var S="msameid",E=A();t.id=U();try{var P=n.sessionStorage;P&&(t.id=P.getItem(S)||U(),P.setItem(S,t.id))}catch(e){}function T(e){var t,n;if("PageView"===(n=e).eventType&&"Initial Collapsed"===n.pageName||"PageAction"===(t=e).eventType&&t.content&&("Sign Out"==t.content.id||"View Account"==t.content.id)){var r=g();if(r){var o=new u("telemetry",{data:{event:e}});r.syntheticEventTarget.dispatchEvent(o)}}E.handleCall("fireEvent")(e)}function _(e){E.setComponent(e)}function U(){return(e()+e()+"-"+e()+"-4"+e().substr(0,3)+"-"+e()+"-"+e()+e()+e()).toLowerCase();function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}}function M(){var t=I();N().filter(function(e){return function(e){var t=document.createElement("a");t.href=e;var n=t.hostname;return O.test(n)}(e.name)}).forEach(function(e){return T({eventType:"OutgoingRequest",serviceOperation:"LoadResource",service:"MeControl",url:e.name,success:!0,duration:t-e.startTime})})}var O=/mem\.gfx\.ms|controls\.account\.microsoft/i;var L=setTimeout;function x(){}function k(e){if(!(this instanceof k))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],B(e,this)}function D(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,k._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void j(r.promise,e)}F(r.promise,t)}else(1===n._state?F:j)(r.promise,n._value)})):n._deferreds.push(r)}function F(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof k)return t._state=3,t._value=e,void R(t);if("function"==typeof n)return void B((r=n,o=e,function(){r.apply(o,arguments)}),t)}t._state=1,t._value=e,R(t)}catch(e){j(t,e)}var r,o}function j(e,t){e._state=2,e._value=t,R(e)}function R(e){2===e._state&&0===e._deferreds.length&&k._immediateFn(function(){e._handled||k._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)D(e,e._deferreds[t]);e._deferreds=null}function V(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function B(e,t){var n=!1;try{e(function(e){n||(n=!0,F(t,e))},function(e){n||(n=!0,j(t,e))})}catch(e){if(n)return;n=!0,j(t,e)}}function X(r,o){return new k(function(e,t){var n=setTimeout(function(){t(d("Promise timed out after "+o+"ms.",!0))},o);r.then(e,t).finally(function(){clearTimeout(n)})})}k.prototype.catch=function(e){return this.then(null,e)},k.prototype.then=function(e,t){var n=new this.constructor(x);return D(this,new V(e,t,n)),n},k.prototype.finally=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},k.all=function(t){return new k(function(r,o){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return r([]);var a=i.length;function c(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){c(t,e)},o)}i[t]=e,0==--a&&r(i)}catch(e){o(e)}}for(var e=0;e<i.length;e++)c(e,i[e])})},k.resolve=function(t){return t&&"object"==typeof t&&t.constructor===k?t:new k(function(e){e(t)})},k.reject=function(n){return new k(function(e,t){t(n)})},k.race=function(o){return new k(function(e,t){for(var n=0,r=o.length;n<r;n++)o[n].then(e,t)})},k._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){L(e,0)},k._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},void 0!==n.Promise&&-1!==n.Promise.toString().indexOf("[native code]")&&(k._immediateFn=function(e){return n.Promise.resolve().then(e)}),k._unhandledRejectionFn=function(e){T({eventType:"ClientError",name:e.message,type:"UnhandledPromiseRejection",details:e.stack,displayed:!1})};var q=[];var H={};function J(e){return H[e]}function G(e,t,n){H[e]={id:e,bundlePromise:t,exports:n}}var W={"@mecontrol/web-inline":"meInline","@mecontrol/web-boot":"meBoot","@mecontrol/web-core":"meCore"},z="Bundle download timed out",K="Bundle failed to load",Q=1e4;function Y(e){try{e in W&&(e=W[e]),Z();var t=J(e);if(t)return t.bundlePromise;var n=(f=e,new k(function(i,a){var e,t,c=I(),s=(e=f,(t=m.Config).gfx+"/MeControl/"+t.ver+"/"+t.mkt+"/"+e+(t.dbg?"":".min")+".js"),n=document.getElementsByTagName("head")[0],u=document.createElement("script");u.async=!0,u.type="text/javascript",u.charset="UTF-8",u.src=s;var l=setTimeout(function(){return r("timeout")},Q);function r(e){clearTimeout(l),u&&(u.onerror=u.onload=void 0,u=void 0);var n=I()-c;Z();var t=J(f),r=t&&t.exports;if(r)X(r,Q).then(function(e){$(f,n,s,!1),i(e)}).catch(function(e){var t=e.mcIsTimeout?z:K;$(f,n,s,!0,t),a(d(t+": "+f+" ("+s+"). Inner error: "+e.message))});else{var o="timeout"===e?z:K;$(f,n,s,!0,o),a(d(o+": "+f+" ("+s+")"))}}u.onerror=u.onload=r,n.appendChild(u)}));return G(e,n),n}catch(e){return k.reject(e)}var f}function Z(){for(var e=function(){var t=q.pop();if(t){var n={},e=k.all(t.deps.map(function(e){return"exports"===e?n:Y(e)})).then(function(e){t.factory.apply(t,e)}).then(function(){return n}),r=J(t.id);r?r.exports=e:G(t.id,e,e)}};q.length;)e()}function $(e,t,n,r,o){T({eventType:"OutgoingRequest",serviceOperation:"DownloadScript",service:"MeControl",url:n,success:!r,duration:t,message:o})}var ee=A(),te=ee.setComponent,ne=function(){return te},re={setActiveAccount:oe("setActiveAccount"),setCommands:oe("setCommands"),setAccountPicture:oe("setAccountPicture"),setProfilePicture:oe("setProfilePicture"),refreshProfilePicture:oe("refreshProfilePicture"),setTheme:oe("setTheme"),setDisplayMode:oe("setDisplayMode"),addEventListener:oe("addEventListener"),removeEventListener:oe("removeEventListener")};function oe(n){var r=ee.handleCall(n);return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];T({eventType:"PartnerApiCall",method:n,params:e.slice()}),r.apply(void 0,e)}}var ie="white-space: nowrap; text-overflow: ellipsis; overflow: hidden; max-width: 160px; display: inline-block; line-height: 48px; font-family: 'Segoe UI'; font-size: 12.4px; color: rgb(80,80,80); padding: 0 10px;",ae=0;function ce(t,n){return ae=I(),Y(m.Config.main).then(function(e){return e.init(t,ne(),n)}).catch(function(e){throw se(t),e})}function se(e){if(!e)throw d("No options object given before showHeaderNoJs was called");var t=function(e){var t,n=e.currentAccount&&"signedIn"==e.currentAccount.authenticatedState,r=n?e.primaryUXConfig.signOutStr:e.primaryUXConfig.signInStr,o=null,i=e.authProviderConfig;switch(i.type){case"partnerManaged":o=n?function(){return i.signOutFromApp({currentAccount:e.currentAccount})}:function(){return i.signIn({signInType:i.signInExperienceTypes})};break;case"adalJsWithMsaFed":case"adalJsAadOnly":o=n?function(){return i.signOutFromApp({currentAccount:e.currentAccount})}:function(){return i.signIn({signInType:4})};break;case"v1BackCompat":var a=i.rpData,c=n?"signOutUrl":"signInUrl",s=a.aadInfo&&a.aadInfo[c],u=a.msaInfo&&a.msaInfo[c];"aad"===a.preferredIdp&&s?t=s:"msa"===a.preferredIdp&&u?t=u:s?t=s:u&&(t=u);break;default:var l=n?i.appSignOutUrl:i.appSignInUrl;t="function"==typeof l?l({currentAccount:e.currentAccount}):l}return{str:r,href:t,onClick:o}}(e),n=document.createTextNode(t.str||""),r=document.createElement("a");r.href=t.href||"#",r.style.cssText=ie,r.onclick=t.onClick,r.appendChild(n);var o=document.createElement("div");o.className="msame_Header",o.appendChild(r);var i=document.createElement("div");i.appendChild(o);var a=document.getElementById(e.containerId);a&&(a.innerHTML="",a.appendChild(i))}function ue(e){if(!e)throw d("Options must be an object. Received "+typeof e+".");if(!(e=i({},e)).authProviderConfig)throw d("options.authProviderConfig not correctly defined. Received "+e.authProviderConfig+".");var t=m.Config=m.Config||{},n=e.primaryUXConfig=e.primaryUXConfig||{};e.events=e.events||{},e.primaryUXConfig.signInStr=n.signInStr||"Sign in",e.primaryUXConfig.signOutStr=n.signOutStr||"Sign out";var r=["compressed"];e.primaryUXConfig.displayModes=n.displayModes&&n.displayModes.filter(function(e){return-1!=r.indexOf(e.type)})||[],e.market=e.market||t.mkt,e.urlBase=e.urlBase||t.gfx,e.debug=e.debug||t.dbg,m.Version=m.Version||e.version||t.ver,e.appContextConfig&&e.appContextConfig.commands&&(e.appContextConfig.commands=e.appContextConfig.commands.slice(0,5));var o=e;return o.syntheticEventTarget=new l,function(e){var t;if(e&&e.events)for(t in e.events)if(f(e.events,t)){var n=e.events[t];n&&e.syntheticEventTarget.addEventListener(t.toLowerCase(),n)}}(o),h(o),o}function le(e,t,n){var r,o,i,a,c;o="function"==typeof t?(r=[],t):(r=t,n),i=e,a=r,c=o,q.push({id:i,deps:a,factory:c})}function fe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return v.apply(void 0,[m].concat(e))}function de(e){return{apiGeneration:"GEN2",containerId:e.containerId,appContextConfig:{commands:me(e.extensibleLinks)},currentAccount:e.userData?ge(e.userData):void 0,events:e.events?pe(e.events):void 0,authProviderConfig:(t=e.rpData,{type:"v1BackCompat",rpData:t})};var t}function me(e){return e?e.map(function(t,e){return{type:"link",id:t.id?t.id:c("command_id_",e),text:t.label?t.label:t.string?t.string:"Label "+e,ariaLabel:void 0,url:t.url,openInNewTab:!!t.openInNewTab,onClick:t.onClick?function(e){t.onClick()&&e.preventDefault()}:void 0}}):[]}function pe(n){if(n){var e={};return n.onSignIn&&(e.beforeSignIn=function(e){e.preventDefault(),n.onSignIn()}),n.onBeforeSignOut&&(e.beforeSignOutFromApp=function(e){var t;n.onBeforeSignOut({idp:function(e){switch(e){case"msa":return"msa";case"aad":return"aad";case"msaFed":return"msaFed"}}((t=e.detail.currentAccount).type),authenticatedState:function(e){switch(e){case"notSignedIn":return"3";case"signedIn":return"1";case"signedInIDPOnly":return"2"}}(t.authenticatedState),firstName:t.firstName,lastName:t.lastName,memberName:t.memberName,nickName:t.memberName,tileUrl:t.pictureUrl})}),n.onEventLog&&(e.controlExpanded=function(){n.onEventLog("DropdownOpen",{type:"bici",ts:b(),uaid:t.id})},e.afterSignOutAndForgetFromIdp=function(e){n.onEventLog("RemoveUser",{userCount:0,idp:e.detail.account.type,currentUser:e.detail.account.memberName})},e.beforeSignIn=function(){n.onEventLog("SignIn",{userCount:0,idp:"",currentUser:""})},e.beforeSwitch=function(e){n.onEventLog("SwitchUser",{userCount:1,idp:1===e.detail.signInType?"Converged":4===e.detail.signInType?"Aad":"Msa",currentUser:e.detail.currentAccount.memberName})},e.afterGetRememberedAccounts=function(e){n.onEventLog("AccountListReady",{duration:0,count:e.detail.rememberedAccounts.length})},e.telemetry=function(e){if(e.detail.data&&e.detail.data.event)if(e.detail.data.event.content)try{"View Account"==e.detail.data.event.content.id&&n.onEventLog("ViewAccount",{userCount:1,currentUser:"",idp:""}),"Sign Out"==e.detail.data.event.content.id&&n.onEventLog("SignOutAll",{userCount:0,currentUser:""})}catch(e){}else e.detail.data.event.pageName&&"Initial Collapsed"==e.detail.data.event.pageName&&(n.onEventLog("HeaderReady",{duration:0}),n.onEventLog("DropdownReady",{duration:0}))}),e}}function ve(e){if(!e||!e.idp)return!1;switch(e.idp){case"aad":return(n=e)&&null!=n.memberName&&0<n.memberName.length;case"msa":case"msaFed":return(t=e)&&null!=t.memberName&&0<t.memberName.length}var t,n}function ge(e){var t,n,r;if(ve(e))switch(e.idp){case"aad":return{type:"aad",authenticatedState:he((r=e).authenticatedState),displayName:r.displayName,firstName:r.firstName,lastName:r.lastName,memberName:r.memberName,orgName:r.orgName,orgLogoUrl:r.orgLogoUrl,pictureUrl:r.tileUrl,roleName:r.roleName,sessionId:r.sessionId,profile:ye(r)};case"msa":return{type:"msa",authenticatedState:he((n=e).authenticatedState),firstName:n.firstName,lastName:n.lastName,memberName:n.memberName,pictureUrl:n.tileUrl,cid:n.cid,profile:ye(n)};case"msaFed":return{type:"msaFed",authenticatedState:he((t=e).authenticatedState),displayName:t.displayName,firstName:t.firstName,lastName:t.lastName,memberName:t.memberName,orgName:t.orgName,orgLogoUrl:t.orgLogoUrl,pictureUrl:t.tileUrl,roleName:t.roleName,sessionId:t.sessionId,profile:ye(t)}}}function he(e){switch(e.toString()){case"3":return"notSignedIn";case"1":return"signedIn";case"2":return"signedInIDPOnly";default:return"notSignedIn"}}function ye(e){return e.nickName&&""!==e.nickName.trim()?{profileName:e.nickName||"",profilePictureUrl:e.tileUrl||""}:void 0}n.MSA=n.MSA||{};var Ce=n.MSA.MeControl=n.MSA.MeControl||{};var we=A(),be=ne();var Ie,Ne,Ae,Se={setActiveUser:Ee("setActiveUser"),setExtensibleLinks:Ee("setExtensibleLinks"),refreshUserPicture:Ee("refreshUserPicture"),setUserPicture:Ee("setUserPicture"),setMobileState:Ee("setMobileState"),openCloseDropdown:Ee("openCloseDropdown")};function Ee(n){var r=we.handleCall(n);return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];T({eventType:"PartnerApiCall",method:"V1:"+n,params:e.slice()}),r.apply(void 0,e)}}te=function(e){be(e);var n,t=(n=e,{setActiveUser:function(e){var t=ge(e);t&&n.setActiveAccount(t)},setExtensibleLinks:function(e){n.setCommands(me(e))},refreshUserPicture:function(){n.refreshProfilePicture()},setUserPicture:function(e){n.setProfilePicture(e)},setMobileState:function(e){var t;switch(e){case-1:t="auto";break;case 0:case 2:t="standard";break;case 1:t="compressed";break;default:t="auto"}n.setDisplayMode(t)},openCloseDropdown:function(e){}});we.setComponent(t)},Ie=re,Ne=function(e){M(),T({eventType:"PartnerApiCall",method:"load",params:e});try{ce(ue(e),_)}catch(e){return!1}return!0},Ae=function(n){return new k(function(e,t){M(),T({eventType:"PartnerApiCall",method:"loadAsync",params:n}),e(ce(ue(n),_))})},n.MeControlDefine=le,n.MeControlImport=Y,fe({API:Ie,Loader:{load:Ne,loadAsync:Ae},Config:m.Config||{}},{Strings:{addStrings:w}}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v.apply(void 0,[Ce].concat(e))}({API:Se,Loader:{load:function(e){if(M(),T({eventType:"PartnerApiCall",method:"loadV1",params:e}),!e)return!1;if(!e.rpData)return!1;try{ce(ue(de(e)),_)}catch(e){return!1}return!0}},IDP:{AAD:"aad",MSA:"msa"},AccountType:{AAD:"aad",MSA:"msa",MSA_FED:"msaFed"},AuthState:{SignedIn:1,SignedInIdp:2,NotSignedIn:3},Config:Ce});var Pe=n.onMeControlReadyToLoad;return setTimeout(function(){return Pe&&Pe()},0),t.meImport=Y,t.getStartTime=function(){return ae},t.showHeaderNoJs=se,t.guid=U,t.logTelemetryEvent=T,t.setTelemetryCv=function(e){E.handleCall("setCv",!0)(e)},t.extendMe=fe,t.Promise=k,t.timeout=X,t.w=n,t.getPageLocation=function(){return n.location},t.loadCss=function(e){var t=document,n=t.head||t.getElementsByTagName("head")[0],r=t.createElement("style");r.type="text/css",n.appendChild(r),r.appendChild(document.createTextNode(e))},t.requestAnimationFrame=e,t.createId=c,t.createError=d,t.toJsonable=function(e){var t={},n=e;return Object.getOwnPropertyNames(e).forEach(function(e){return t[e]=n[e]}),t},t.SyntheticEvent=u,t.SyntheticEventTarget=l,t.ME=m,t.assertNever=function(e,t){throw d("Never assertion failed: "+t)},t.hasOwn=f,t.assign=v,t.getOptions=g,t.setOptions=h,t.setCurrentLang=function(e){y=e},t.addStrings=w,t.getString=function(e){var t=y||m.Config.mkt||"en-US";return C[t]&&C[t][e]||"ERROR: "+e},t.getTime=b,t.perfNow=I,t.getPerfEntries=N,t.MEV1=Ce,t.mapV1ConfigToV2Config=de,t.mapV1ExtensibleLinksToV2Commands=me,t.mapV1EventsToV2Events=pe,t.v1UserDataIsUseable=ve,t.mapV1UserDataToV2Account=ge,t}({}),MeControlDefine("meInline",["exports"],function(e){var t=MeControl.WebInline;t.assign(e,t)});
//# sourceMappingURL=meInlineBackCompat.min.js.map
;window.MSA=window.MSA||{};window.MSA.MeControl=window.MSA.MeControl||{};window.MSA.MeControl.Config={"ver":"10.19023.0","mkt":"fr-FR","ptn":"mshomepage","gfx":"https://mem.gfx.ms/me","dbg":false,"aad":false,"int":false,"pxy":false,"msTxt":false,"rwd":true,"telEvs":"PageAction, PageView, ContentUpdate, OutgoingRequest, ClientError, PartnerApiCall","remAcc":true,"main":"meBoot","wreply":null};window.MeControl=window.MeControl||{};window.MeControl.Config={"ver":"10.19023.0","mkt":"fr-FR","ptn":"mshomepage","gfx":"https://mem.gfx.ms/me","dbg":false,"aad":false,"int":false,"pxy":false,"msTxt":false,"rwd":true,"telEvs":"PageAction, PageView, ContentUpdate, OutgoingRequest, ClientError, PartnerApiCall","remAcc":true,"main":"meBoot","wreply":null};