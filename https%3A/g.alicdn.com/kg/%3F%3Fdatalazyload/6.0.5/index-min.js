define("kg/datalazyload/6.0.5/index",["dom","event","base"],function(t,e,n){var o,a,r=t("dom"),i=t("event"),c=t("base");o=function(t){"use strict";function e(t){var e=window.localStorage&&window.localStorage.getItem("webpsupport");return null!==e?void t("true"===e):void n(function(e){window.localStorage&&window.localStorage.setItem("webpsupport",e),t(e)})}function n(t){var e,n=new Image;n.onload=n.onerror=function(){e||(e=!0,t(2===n.width&&2===n.height))},setTimeout(function(){e||(e=!0,t(!1))},16),n.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}function o(){var t=window;if("object"==typeof localStorage){var e="test",n=window.sessionStorage;try{return n.setItem(e,"1"),n.removeItem(e),t.__isLocalStorageNameSupported__=1,!0}catch(o){return t.__isLocalStorageNameSupported__=-1,!1}}}var a=window.WebP={};return a.isSupport=function(t){var n=window;if(t)if(!n.__isLocalStorageNameSupported__&&o(),-1===n.__isLocalStorageNameSupported__)t(!1);else if(1===n.__isLocalStorageNameSupported__){if(void 0===a._isSupport)return void e(function(e){t(a._isSupport=e)});t(a._isSupport)}else t(!1)},t=a}(),a=function(t){"use strict";function e(t){var e=!!~t.indexOf(".alicdn.com"),n=t.indexOf(".jpg")||t.indexOf(".png");return e&&n&&(t+="_.webp"),t}function n(t){var e,n,o,a=[];return function(r,i){return 0===i||i||(i=1),1&i&&!n&&(n=!0,t(function(t){for(e=t;o=a.shift();)try{o&&o.apply(null,[e])}catch(n){setTimeout(function(){throw n},0)}})),e?(r&&r.apply(null,[e]),e):(2&i||r&&a.push(r),e)}}function a(t,e,n){function o(){a&&(a.cancel(),a=0),r=_.now(),t.apply(n||this,arguments),i=_.now()}var a,r=0,i=0,e=e||150;return _.mix(function(){!r||i>=r&&_.now()-i>e||r>i&&_.now()-r>8*e?o():(a&&a.cancel(),a=_.later(o,e,0,null,arguments))},{stop:function(){a&&(a.cancel(),a=0)}})}function l(t,e,n){t.style.display=I,t.className="";var o=p.create("<div>");t.parentNode.insertBefore(o,t);var a=t.value;if(_.isFunction(n)){var r=n({type:"textarea",elem:t,value:a});r&&(a=r)}return p.html(o,a,e),o}function s(t){return t._ks_lazy_width?t._ks_lazy_width:t._ks_lazy_width=p.outerWidth(t)}function u(t){return t._ks_lazy_height?t._ks_lazy_height:t._ks_lazy_height=p.outerHeight(t)}function f(t,e,n){if(!t.offsetWidth)return!1;var o,a=p.offset(t),r=!0,i=a.left,c=a.top,l={left:i,top:c,right:i+s(t),bottom:c+u(t)};return o=g(e,l),o&&n&&(r=g(n,l)),r&&o}function d(t,e){var n=this;if(!(n instanceof d))return new d(t,e);var o=t;_.isPlainObject(o)||(o=e||{},t&&(o.container=t)),d.superclass.constructor.call(n,o),n._callbacks={},n._containerIsNotDocument=9!=n.get("container").nodeType,_.isArray(o.container)&&(n._backCompact=1),n._initLoadEvent(),o.container&&n.addElements(o.container),n._loadFn(),_.ready(function(){n._loadFn()}),n.resume()}function g(t,e){var n={};return n.top=Math.max(t.top,e.top),n.bottom=Math.min(t.bottom,e.bottom),n.left=Math.max(t.left,e.left),n.right=Math.min(t.right,e.right),n.bottom>=n.top&&n.right>=n.left}function m(t,e,n,o){"img-src"===e&&(e="img"),_.isArray(t)||(t=[p.get(t)]);var a=new d(w,{});a.set("imgFlag",n||b+S),a.set("areaFlag",n||k+S),a.set("onStart",o),a.set("force",!0),a.addElements(t,e)}var _=KISSY,p=r,h=i,v=c,y=_.Env.host,w=y.document,b="data-ks-lazyload",k="ks-datalazyload",S="-custom",A="default",I="none",x="scroll",F="touchmove",H="resize",N=100,z=0,C=function(t,n,a,r,i){n=n||b;var c=t.getAttribute(n),l={type:"img",elem:t,src:c},s=!_.isFunction(a)||a(l)!==!1,u=o;s&&l.src&&!function(){var o=function(e){t.src!=e&&(t.src=e),t.removeAttribute(n)};_.isFunction(r)?u.isSupport(function(t){o(t?r(l.src):l.src)}):i?u.isSupport(function(t){o(t?e(l.src):l.src)}):o(l.src)}()};return d.ATTRS={diff:{value:A},placeholder:{value:"//g.alicdn.com/s.gif"},execScript:{value:!0},container:{setter:function(t){return t=t||w,_.isWindow(t)?t=t.document:(t=p.get(t),"body"==p.nodeName(t)&&(t=t.ownerDocument)),t},valueFn:function(){return w}},autoDestroy:{value:!0},onStart:{value:null}},_.extend(d,v,{_initLoadEvent:function(){var t=this,e=t.get("autoDestroy");t.imgHandle=function(){C(this,t.get("imgFlag"),t.get("onStart"),t.get("webpReplacer"),t.get("webp"))},t.textareaHandle=function(){t.addElements(l(this,t.get("execScript"),t.get("onStart")))},t._loadFn=a(function(){e&&0==t._counter&&_.isEmptyObject(t._callbacks)&&t.destroy(),t._loadItems()},N,t)},refresh:function(){this._loadFn()},_loadItems:function(){var t=this,e=t.get("container");(!t._containerIsNotDocument||e.offsetWidth)&&(t._windowRegion=t._getBoundingRect(),!t._backCompact&&t._containerIsNotDocument&&(t._containerRegion=t._getBoundingRect(t.get("container"))),_.each(t._callbacks,function(e,n){e&&t._loadItem(n,e)}))},_loadItem:function(t,e){var n=this,e=e||n._callbacks[t];if(!e)return!0;var o=e.el,a=!1,r=e.fn;if(n.get("force")||f(o,n._windowRegion,n._containerRegion))try{a=r.call(o)}catch(i){setTimeout(function(){throw i},0)}return a!==!1&&delete n._callbacks[t],a},addCallback:function(t,e){t=p.get(t);var n=this,o=n._callbacks,a={el:t||document,fn:e||_.noop},r=++z;o[r]=a,n._windowRegion?n._loadItem(r,a):n.refresh()},removeCallback:function(t,e){t=p.get(t);var n=this._callbacks;_.each(n,function(o,a){o.el==t&&(e?o.fn==e:1)&&delete n[a]})},getElements:function(){var t=this,e=[],n=[],o=t._callbacks;return _.each(o,function(o){o.fn==t.imgHandle&&e.push(o.el),o.fn==t.textareaHandle&&n.push(o.el)}),{images:this._images,textareas:this._textareas}},addElements:function(t,e){"string"==typeof t?t=p.query(t):_.isArray(t)||(t=[t]);var o=this;o._counter=o._counter||0,_.each(t,function(t){e&&"img"!==e||_.each(_.filter([t].concat(p.query("img",t)),function(t){return t.getAttribute&&t.getAttribute(o.get("imgFlag")||b)},o),function(t){o.onPlaceHolder=o.onPlaceHolder||n(function(t){var e=new Image,n=o.get("placeholder");e.src=n,e.onload=e.onerror=function(){t(n)}}),t.offsetWidth?o.addCallback(t,o.imgHandle):(o._counter++,t.onload=function(){o._counter--,o.addCallback(t,o.imgHandle)},t.src||o.onPlaceHolder(function(e){t.src||(t.src=e)}))}),e&&"textarea"!==e||_.each(p.query("textarea."+(o.get("areaFlag")||k),t),function(t){o.addCallback(t,o.textareaHandle)})})},removeElements:function(t){"string"==typeof t?t=p.query(t):_.isArray(t)||(t=[t]);var e=this,n=e._callbacks;_.each(n,function(e,o){_.inArray(e.el,t)&&delete n[o]})},_getBoundingRect:function(t){var e,n,o,a;if(void 0!==t){e=p.outerHeight(t),n=p.outerWidth(t);var r=p.offset(t);o=r.left,a=r.top}else e=p.viewportHeight(),n=p.viewportWidth(),o=p.scrollLeft(),a=p.scrollTop();var i=this.get("diff"),c=i===A?n:i,l=0,s=c,u=i===A?e:i,f=0,d=u,g=o+n,m=a+e;return _.isObject(i)&&(l=i.left||0,s=i.right||0,f=i.top||0,d=i.bottom||0),o-=l,g+=s,a-=f,m+=d,{left:o,top:a,right:g,bottom:m}},pause:function(){var t=this,e=t._loadFn;if(!t._destroyed&&(h.remove(y,x,e),h.remove(y,F,e),h.remove(y,H,e),e.stop(),t._containerIsNotDocument)){var n=t.get("container");h.remove(n,x,e),h.remove(n,F,e)}},resume:function(){var t=this,e=t._loadFn;if(!t._destroyed&&(h.on(y,x,e),h.on(y,F,e),h.on(y,H,e),t._containerIsNotDocument)){var n=t.get("container");h.on(n,x,e),h.on(n,F,e)}},destroy:function(){var t=this;t.pause(),t._callbacks={},t.fire("destroy"),t._destroyed=1}}),d.loadCustomLazyData=m,_.DataLazyload=d,t=d}(),n.exports=a});