KISSY.add("mui/mdv/index",function(S){var defIns;function preload(e){var i;e(function(e){i=i?i(e):e});return function(e){i=i?e(i):e}}function createLoader(e){var i,t,n=[],d;return function(a,l){if(l!==0&&!l){l=1}if(l&1&&!t){t=true;e(function(e){i=e;while(d=n.shift()){d&&d.apply(null,[i])}})}if(i!==undefined){a&&a.apply(null,[i]);return i}if(!(l&2)){a&&n.push(a)}return i}}function addLis(e,i){var t;while(t=e.shift()){i.apply(null,t)}}function detectCss(e){try{var i=document.createElement("div");i.className="mdv1-"+e.replace(/\.css$/,"").replace(/\W+/g,"_");i.style.visibility="hidden";i.style.position="absolute";var t=document.body;if(!t){return}t.insertBefore(i,t.firstChild);if(Math.round(i.offsetHeight/7)==1){S.add(e,function(){return 1})}var n=window.getComputedStyle(i,":before").content;if(n){S.each(n.split(","),function(e){S.add(e+".css",function(){return 1})})}t.removeChild(i)}catch(d){}}function Mdv(){this._mods={}}S.mix(Mdv,{instance:function(){return defIns||(defIns=new Mdv)}});S.augment(Mdv,{preload:preload,createLoader:createLoader,detectCss:detectCss,onDatalazyload:createLoader(function(e){S.use("mui/datalazyload/",function(i,t){var n=t.instance&&t.instance()||new t(document.body,{autoDestroy:false,diff:{top:0,bottom:10}});e(n)})}),onModInit:function(e,i,t){if(!e||!i){return}var n=S.isObject(e)?e:this._mods[e];if(!n){n=this._mods[e]={}}if(n._mdvInit){return n._mdvInit(i,t)}if(!n._mdvInitLis){n._mdvInitLis=[]}n._mdvInitLis.push([i,t])},onModCallback:function(e,i,t){if(!e||!i){return}var n=S.isObject(e)?e:this._mods[e];if(!n){n=this._mods[e]={}}if(n._mdvCallback){return n._mdvCallback(i,t)}if(!n._mdvCallbackLis){n._mdvCallbackLis=[]}n._mdvCallbackLis.push([i,t]);if(t!==0&&!t){t=1}if(typeof e=="string"&&t&1){this.addModule(e)}},addAlias:function(e,i){var t=this;var n=t._mods[e],d=t._mods[e]=S.isObject(i)?i:t._mods[i];if(n&&n._mdvCallback){setTimeout(function(){throw new Error("mdv:duplicate add:"+e)},0);return}if(n&&n._mdvInitLis){addLis(n._mdvInitLis,d._mdvInit)}if(n&&n._mdvCallbackLis){addLis(n._mdvCallbackLis,d._mdvCallback)}return d},addModule:function(e,i,t){var n=this,d={_mdvInit:createLoader(function(n){n({name:e,cfg:t||{},loader:i})}),_mdvCallback:createLoader(function(e){d._mdvInit(function(i){var t=i.loader||function(e,i){var t=e.name.replace(/index(?:\.js)?$/,"");detectCss(t+"index.css");S.use(t,function(t,d){if(d.initView){return d.initView(null,e.cfg,n,i)}if(d.init){d.init(e.cfg)}i(d)})};t(i,e)})})};var a=this._mods[e];if(a&&a._mdvCallback){setTimeout(function(){throw new Error("mdv:duplicate add:"+e)},0);return}if(a&&a._mdvInitLis){addLis(a._mdvInitLis,d._mdvInit);a._mdvInitLis=0}if(a&&a._mdvCallbackLis){addLis(a._mdvCallbackLis,d._mdvCallback);a._mdvCallbackLis=0}return this._mods[e]=d},addElement:function(ele,cls,cfg){var self=this;function each(e,i){if(S.isArray(e)){return S.each(e,i)}if(typeof e==="string"){S.use("dom",function(t,n){t.each(n.query(e),i)});return}return i(e)}each(ele,function(el){if(!el._mdvCallback){var modCls=cls||el.getAttribute("mdv-cls");if(modCls){el._mdvInit=createLoader(function(callback){S.use("dom",function(S,DOM){if(!/\s+t(m|b)-\S+/.test(DOM.attr(el,"class"))&&DOM.parent(el,".tb-shop")){return}var modCfg=DOM.attr(el,"mdv-cfg");DOM.removeAttr(el,"mdv-cls");DOM.removeAttr(el,"mdv-cfg");try{if(/^mdv/.test(modCfg)){modCfg=window[modCfg]||{}}else{modCfg=modCfg?eval("("+modCfg+")"):{}}}catch(err){modCfg={};setTimeout(function(){throw err},0)}S.mix(modCfg,cfg);callback({el:el,cls:modCls,cfg:modCfg})})});el._mdvCallback=createLoader(function(e){el._mdvInit(function(i){var t=i.cfg,n=i.cls.replace(/index(?:\.js)?$/,"");S.each(t,function(e){var i=e&&e.mdvPrep;if(!i){return}switch(i){case"loadJsonp":e.preload=preload(function(i){var t=window,n=e.callback||S.guid("jsonp"),d=n;while(d.indexOf(".")>0){var a=d.substring(0,d.indexOf("."));t=t[a]||(t[a]={});d=d.substring(d.indexOf(".")+1)}t[d]=i;var l=["callback="+n,"t="+ +new Date];S.each(e.param,function(e,i){l.push(i+"="+encodeURIComponent(e))});S.getScript(e.url+l.join("&"),{error:i})})}});detectCss(n+"index.css");S.use(n,function(i,n){n.initView(el,t,self,e)})})});if(el._mdvInitLis){addLis(el._mdvInitLis,el._mdvInit);el._mdvInitLis=0}if(el._mdvCallbackLis){addLis(el._mdvCallbackLis,el._mdvCallback);el._mdvInitLis=0}if(!self._mods[modCls]||!self._mods[modCls]._mdvCallback){self.addAlias(modCls,el)}}}if(el._mdvCallback){self.onDatalazyload(function(e){e.addCallback(el,function(){S.use("dom",function(e,i){if(i.css(el,"display")=="none"){return false}el._mdvCallback()})})})}})}});return Mdv},{requires:["mui/datalazyload/"]});