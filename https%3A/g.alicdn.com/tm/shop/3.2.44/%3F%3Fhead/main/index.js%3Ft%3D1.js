KISSY.add("shop/head/main/index",function(e,a,t){return{"initView":function(e,t,r,i){var n=this;codeTrack("head.main.init"),t=t||{};var s=a.get("#mallSearch");s&&r.addElement(s,"shop/head/search/",t);var o=a.get("#shop-info");if(o&&r.addElement(o,"shop/head/shopinfo/",{"isInitDialog":t.isInitDialog,"onLogin":t.onLogin,"onToken":t.onToken,"onData":t.onShopData}),!1!==t.showQrcode&&(t.wtId||t.shopId||t.sellerId)){var l=a.create('<div class="shopwt"></div>'),d=a.get("#shopExtra")||a.get("#mallLogo")||a.get(".tbsSiteInfo");d&&(a.insertAfter(l,d),r.addElement(l,"shop/head/qrcode/",{"shopId":t.shopId,"sellerId":t.sellerId,"wtId":t.wtId}))}i(n)}}},{"requires":["dom","event","shop/head/search/","shop/head/shopinfo/","shop/head/qrcode/","shop/head/main/index.css"]});
KISSY.add("shop/head/search/index",function(e,a,t,r,i){var n,s,o,l;return{"init":function(e){var t,r=this;codeTrack("head.search.init"),l=e,n=l.el,s=a.get("#mq",n),o=s.form,(l.suggestControl||function(e){e()})(function(){(t=r.getNID())&&i.build({"node":"#mq","inShopAction":r.getShopUrl()||"","inShopBtn":"#J_CurrShopBtn","autoFocus":!0,"nid":t,"time":e.time})})},"getShopUrl":function(){return l.shopUrl||a.get("#J_ShopSearchUrl")&&a.get("#J_ShopSearchUrl").value},"getNID":function(){return l.itemId?l.itemId:l.shop_config&&l.shop_config.isvStat?l.shop_config.isvStat.userId:""},"initView":function(a,t,r,i){var n=this;n.init(e.mix({"el":a},t)),i(n)}}},{"requires":["dom","event","ajax","mui/searchbar/instance/detail"]});
KISSY.add("shop/head/shopinfo/index",function(e,a,t,r,i,n){function s(a){var r="SM_368_dsr-"+t.val("#dsr-userid");e.io({"url":t.val("#dsr-url"),"dataType":"jsonp","data":{"keys":r},"cache":"false","complete":function(e){a(e&&e[r])}})}var o,l=-1==e.version.indexOf("1.3"),d=function(a,r){var n=document;return function(){var s=a.get("#popupPanel"),d=-1!==location.hostname.indexOf("tmall.com")||-1!==location.hostname.indexOf("tmall.net");s||(s=a.create('<div id="popupPanel"></div>'),l&&(t.addClass(s,"ks-dialog-focused"),t.addClass(s,"ks-overlay-focused"),s.innerHTML='<div class="ks-dialog-content"><div class="ks-dialog-header" style="display: none"></div><div class="ks-dialog-body"></div></div></div>'),n.body.appendChild(s));var c=a.get(".J_TDialogTrigger",o),p=c.getAttribute("data-width"),u=c.getAttribute("data-height"),m=new i.Dialog({"srcNode":s,"width":p,"height":u,"closable":!1,"elStyle":{"display":"block","visibility":"hidden","position":"absolute","left":"-9999px","top":"-9999px"},"zIndex":1e8});r.on(c,"click",function(e){e.preventDefault(),t.show(s),m.hide(),m.show(),t.show(s)}),m.on("show",function(){var i=this,n=c.href+(d?"&isTmall=1":"")+"&t="+ +new Date,o='<a class="close-btn" href="javascript:void(0)"style="position: absolute; top: 5px; right: 4px; outline: none;display: block; width: 15px; height: 15px; background: url(//assets.alicdn.com/app/tc/img/close_btn.png) no-repeat; text-decoration: none; text-indent: -99999px">X</a><iframe src="'+n+'" width="'+p+'" height="'+u+'" name="popupIframe" frameborder="0" scrolling="no"></iframe>';i.set("width",p),i.set("height",u),-1==e.version.indexOf("1.3")?i.set("bodyContent",o):s.innerHTML=o,m.center(),r.on(a.get(".close-btn",s),"click",function(){t.hide(s),m.hide()}),a.hasClass(c,"collection")&&((new Image).src="//www.atpanel.com/jsclick?cache="+ +new Date+"&auc_detail=b_collect_item"),a.removeClass("#shop-info","expanded")})}}(t,r);return{"onData":s,"init":function(n){function l(e){if(n.isTwView)return e(null);(n.onData||s)(function(a){if(null===a&&n.onData!=s)return s(e);e(a)})}function c(e){var a=t.get("textarea.ks-datalazyload",o);if(!a)return e();p.onDatalazyload(function(t){t.textareaHandle.apply(a),e()})}var p=this;codeTrack("head.shopinfo.init"),n=n||{},o=n.isTwView?t.get("#J_HdShopInfo"):t.get("#shop-info");var u,m=function(r){var n=t.get(".extra-info",o);if(-1==e.version.indexOf("1.3")){var s=t.create('<div class="ks-popup-content"></div>'),l=[];e.each(n.childNodes,function(e){l.push(e)}),e.each(l,function(e){s.appendChild(e)}),n.appendChild(s)}var d=t.get("#shopExtra"),c=t.get("#j_ExtraInfoHd",n)?430:t.width(d);new i.Popup({"srcNode":n,"trigger":d,"triggerType":"mouse","width":c,"zIndex":1e5,"align":{"node":d,"points":["bc","tc"],"offset":[0,1]}}).show(),t.css(n,{"width":c,"zIndex":1e5});var p=t.get("#J_DrugCert");if(!p)return r(null);var u=t.attr(p,"data-url");a({"url":u,"type":"get","dataType":"jsonp","success":function(e){if(!e)return r(null);e.hasDrugSupply&&t.show(t.get(".J_DrugSupply",p)),e.hasDrugQualityManage&&t.show(t.get(".J_DrugQualityManage",p)),e.hasDrugInfoService&&t.show(t.get(".J_DrugInfoService",p)),t.show(p),r(null)}})},v=p.createLoader(function(a){c(function(){t.get(".j_CollectBrand",o)&&(codeTrack("head.shopinfo.brandshow","head.shopinfo.init"),KISSY.config({"packages":{"mui/brandbar":{"debug":!0,"ignorePackageNameInUri":!0,"version":"3.0.7","path":"//g.alicdn.com/mui/brandbar/3.0.7/"},"mui/tbuser":{"debug":!0,"ignorePackageNameInUri":!0,"version":"3.0.4","path":"//g.alicdn.com/mui/tbuser/3.0.4/"}}}),e.use("mui/brandbar/brandbar",function(e,a){a.bindEl(".tm-collectBtn",{"onLogin":n.onLogin,"onToken":n.onToken,"success":function(){codeTrack("head.shopinfo.brandsuccess","head.shopinfo.brandclick")},"error":function(){codeTrack("head.shopinfo.branderror","head.shopinfo.brandclick")}})})),window.Light&&window.Light.light(o),l(function(r){return r&&e.isObject(r)?(e.use("shop/head/shopinfo/index.tpl,shop/head/shopinfo/dsr.tpl",function(e,a,i){var n=[{"rate":(Math.floor(10*r.m)/10).toFixed(1),"rate_title":r.m,"rate_UFB":r.m_UFB,"rate_g":r.m_g},{"rate":(Math.floor(10*r.s)/10).toFixed(1),"rate_title":r.s,"rate_UFB":r.s_UFB,"rate_g":r.s_g},{"rate":(Math.floor(10*r.c)/10).toFixed(1),"rate_title":r.c,"rate_UFB":r.c_UFB,"rate_g":r.c_g}];codeTrack("head.shopinfo.tpl","head.shopinfo.init"),t.html(t.get(".main-info",o),a({"rates":n})),t.html(t.get(".shop-rate",o),i({"rate_link":t.val("#dsr-ratelink"),"rates":n,"isInternational":window.g_config.isInternational}))}),m(a)):m(a)})})});r.on(o,"mouseenter",function(){u&&clearTimeout(u),u=setTimeout(function(){v(function(){t.addClass(o,"expanded")})},100)}),r.on(o,"mouseleave",function(){u&&clearTimeout(u),u=setTimeout(function(){v(function(){t.removeClass(o,"expanded")},0)},100)}),!1!==n.isInitDialog&&v(function(){d()},0)},"initView":function(a,t,r,i){var n=this;n.createLoader=r.createLoader,n.onDatalazyload=r.onDatalazyload,n.init(e.mix({"el":a},t)),i(n)}}},{"requires":["io","dom","event","overlay","shop/head/shopinfo/index.css","shop/head/shopinfo/index.tpl","shop/head/shopinfo/dsr.tpl"]});
KISSY.add("shop/head/qrcode/index",function(e,a,t,r){return{"init":function(e){codeTrack("head.qrcode.init");var i,n=e.el,s=e.shopId,o=!1;if(s&&n){a.html(n,r());var l=n,d=a.get(".tm-qrcode-hpic",n);t.on(l,"mouseover",function(){i&&clearTimeout(i),i=setTimeout(function(){if(a.show(d),a.addClass(n,"expanded"),!o){o=!0;var e=encodeURIComponent("http://m.laiwang.com/market/laiwang/tmall/app-download.php?&type=shop&biz=tmall&iframe=1&mmstat=shop_head&key="+s),t="//gcodex.alicdn.com/qrcode.do?biz_code=tmallpc&content="+e+"&size=175&margin=0&logo_url="+encodeURIComponent("https://img.alicdn.com/tfs/TB1prMSRXXXXXcCXFXXXXXXXXXX-198-198.png")+"&channel_id=2703";a.get("img",d).src=t,codeTrack("head.qrcode.load")}},100)}),t.on(l,"mouseout",function(){i&&clearTimeout(i),i=setTimeout(function(){a.hide(d),a.removeClass(n,"expanded")},100)})}},"initView":function(a,t,r,i){var n=this;n.init(e.mix({"el":a},t)),i(n)}}},{"requires":["dom","event","shop/head/qrcode/index.tpl","shop/head/qrcode/index.css"]});
KISSY.add("shop/head/qrcode/index.tpl",function(a,e){var t,s=function(a){var e=this,t=e.root,s=e.buffer,r=e.scope,i=(e.runtime,e.name,e.pos,r.data,r.affix,t.nativeCommands),l=t.utils;l.callFn,l.callDataFn,l.callCommand,i.range,i["void"],i.foreach,i.forin,i.each,i["with"],i["if"],i.set,i.include,i.parse,i.extend,i.block,i.macro,i["debugger"];return s.data+='<div class="shopwt-desc"><div class="shopwt-title">\u624b\u673a\u901b</div><i class="shopwt-qr">&#xe602;</i></div><a class="slogo-triangle"><i class="icon-triangle"></i></a><div class="tm-qrcode-hpic"><img width="140"><p class="J_QrcodeHeadText">\u626b\u4e00\u626b\uff0c\u624b\u673a\u901b\u8d77\u6765</p></div>',s};return function(a){return(t=t||new e(s))&&t.render(a)||""}},{"requires":["kg/xtemplate/4.3.0/runtime"]});
KISSY.add("shop/head/shopinfo/index.tpl",function(a,e){var t,r=function(a){function e(a,e,t){a.data,a.affix;return e.data+="\u63cf \u8ff0",e}function t(a,e,t){a.data,a.affix;return e.data+="\u670d \u52a1",e}function r(a,e,t){a.data,a.affix;return e.data+="\u7269 \u6d41",e}function s(a,e,s){var n=a.data,i=a.affix;e.data+="";var l=(f=i.xindex)!==s?f:(f=n.xindex)!==s?f:a.resolveLooseUp(["xindex"]),o=l;return o=1===l,e=_.call(m,a,{"params":[o],"fn":t,"inverse":r},e),e.data+="",e}function n(a,e,t){a.data,a.affix;return e.data+="shopdsr-score-up-ctrl",e}function i(a,e,t){a.data,a.affix;return e.data+="shopdsr-score-down-ctrl",e}function l(a,e,t){a.data,a.affix;return e.data+="shopdsr-score-equal-ctrl",e}function o(a,e,t){var r=a.data,s=a.affix;e.data+="";var n=(f=s.rate_UFB)!==t?f:(f=r.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),o=n;return o=2===n,e=_.call(m,a,{"params":[o],"fn":i,"inverse":l},e),e.data+="",e}function d(a,e,t){a.data,a.affix;return e.data+='<s class="shopdsr-score-up"></s>',e}function c(a,e,t){a.data,a.affix;return e.data+='<s class="shopdsr-score-down"></s>',e}function p(a,e,t){a.data,a.affix;return e.data+='<s class="shopdsr-score-equal"></s>',e}function v(a,e,t){var r=a.data,s=a.affix;e.data+="";var n=(f=s.rate_UFB)!==t?f:(f=r.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),i=n;return i=2===n,e=_.call(m,a,{"params":[i],"fn":c,"inverse":p},e),e.data+="",e}function u(a,t,r){var i=a.data,l=a.affix;t.data+=' <div class="shopdsr-item"><div class="shopdsr-title"> ';var c=(f=l.xindex)!==r?f:(f=i.xindex)!==r?f:a.resolveLooseUp(["xindex"]),p=c;p=0===c,t=_.call(m,a,{"params":[p],"fn":e,"inverse":s},t),t.data+=' </div><div class="shopdsr-score ';var u=(f=l.rate_UFB)!==r?f:(f=i.rate_UFB)!==r?f:a.resolveLooseUp(["rate_UFB"]),h=u;h=0===u,t=_.call(m,a,{"params":[h],"fn":n,"inverse":o},t),t.data+='"><span class="shopdsr-score-con">';var g=(f=l.rate)!==r?f:(f=i.rate)!==r?f:a.resolveLooseUp(["rate"]);t=t.writeEscaped(g),t.data+="</span> ";var x=(f=l.rate_UFB)!==r?f:(f=i.rate_UFB)!==r?f:a.resolveLooseUp(["rate_UFB"]),b=x;return b=0===x,t=_.call(m,a,{"params":[b],"fn":d,"inverse":v},t),t.data+=" </div></div> ",t}var f,m=this,h=m.root,g=m.buffer,x=m.scope,b=(m.runtime,m.name,m.pos,x.data),w=x.affix,U=h.nativeCommands,L=h.utils,y=(L.callFn,L.callDataFn,L.callCommand,U.range,U["void"],U.foreach,U.forin,U.each),_=(U["with"],U["if"]);U.set,U.include,U.parse,U.extend,U.block,U.macro,U["debugger"];g.data+="";var E=(f=w.rates)!==a?f:(f=b.rates)!==a?f:x.resolveLooseUp(["rates"]);return g=y.call(m,x,{"params":[E],"fn":u},g),g.data+=' <a class="slogo-triangle"><i class="icon-triangle"></i></a>',g};return function(a){return(t=t||new e(r))&&t.render(a)||""}},{"requires":["kg/xtemplate/4.3.0/runtime"]});
KISSY.add("shop/head/shopinfo/dsr.tpl",function(a,e){var t,s=function(a){function e(a,e,t){a.data,a.affix;return e.data+="\u63cf\u8ff0\u76f8\u7b26\uff1a",e}function t(a,e,t){a.data,a.affix;return e.data+="\u670d\u52a1\u6001\u5ea6\uff1a",e}function s(a,e,t){a.data,a.affix;return e.data+="\u7269\u6d41\u670d\u52a1\uff1a",e}function r(a,e,t){var s=a.data,r=a.affix;return(f=r.isInternational)!==t?f:(f=s.isInternational)!==t?f:a.resolveLooseUp(["isInternational"])}function i(a,e,t){a.data,a.affix;return e.data+="\u8de8\u5883\u7269\u6d41\uff1a",e}function n(a,e,n){var l=a.data,o=a.affix;e.data+="";var d=(f=o.xindex)!==n?f:(f=l.xindex)!==n?f:a.resolveLooseUp(["xindex"]),c=d;return c=1===d,e=E.call(m,a,{"params":[c],"fn":t,"inverse":s,"elseIfs":[{"test":r,"fn":i}]},e),e.data+="",e}function l(a,e,t){a.data,a.affix;return e.data+=' <span class="no-rate" title="\u5c1a\u672a\u6536\u5230\u8bc4\u4ef7">--</span> ',e}function o(a,e,t){var s=a.data,r=a.affix;e.data+=' <span class="rateinfo" title="\u8ba1\u7b97\u89c4\u5219:(\u5e97\u94fa\u5f97\u5206-\u540c\u884c\u4e1a\u5e73\u5747\u5206)/(\u540c\u884c\u4e1a\u5e97\u94fa\u6700\u9ad8\u5f97\u5206-\u540c\u884c\u4e1a\u5e73\u5747\u5206)"><b></b> <i>\u9ad8\u4e8e</i> <em>';var i=(f=r.rate_g)!==t?f:(f=s.rate_g)!==t?f:a.resolveLooseUp(["rate_g"]);return e=e.writeEscaped(i),e.data+="%</em> </span> ",e}function d(a,e,t){var s=a.data,r=a.affix;e.data+=' <span class="rateinfo" title="\u8ba1\u7b97\u89c4\u5219:(\u540c\u884c\u4e1a\u5e73\u5747\u5206-\u5e97\u94fa\u5f97\u5206)/(\u540c\u884c\u4e1a\u5e73\u5747\u5206-\u540c\u884c\u4e1a\u5e97\u94fa\u6700\u4f4e\u5f97\u5206)"><b class="lower"></b> <i>\u4f4e\u4e8e</i> <em class="lower">';var i=(f=r.rate_g)!==t?f:(f=s.rate_g)!==t?f:a.resolveLooseUp(["rate_g"]);return e=e.writeEscaped(i),e.data+="%</em> </span> ",e}function c(a,e,t){a.data,a.affix;return e.data+=' <span class="rateinfo"><b class="fair"></b> <i>\u6301\u5e73</i> <em>--------</em> </span> ',e}function p(a,e,t){var s=a.data,r=a.affix;e.data+=" ";var i=(f=r.rate_UFB)!==t?f:(f=s.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),n=i;return n=2===i,e=E.call(m,a,{"params":[n],"fn":d,"inverse":c},e),e.data+=" ",e}function v(a,e,t){var s=a.data,r=a.affix;e.data+=' <em class="count" title="';var i=(f=r.rate_title)!==t?f:(f=s.rate_title)!==t?f:a.resolveLooseUp(["rate_title"]);e=e.writeEscaped(i),e.data+='">';var n=(f=r.rate)!==t?f:(f=s.rate)!==t?f:a.resolveLooseUp(["rate"]);e=e.writeEscaped(n),e.data+="</em> ";var l=(f=r.rate_UFB)!==t?f:(f=s.rate_UFB)!==t?f:a.resolveLooseUp(["rate_UFB"]),d=l;return d=0===l,e=E.call(m,a,{"params":[d],"fn":o,"inverse":p},e),e.data+=" ",e}function u(a,t,s){var r=a.data,i=a.affix;t.data+=" <li> ";var o=(f=i.xindex)!==s?f:(f=r.xindex)!==s?f:a.resolveLooseUp(["xindex"]),d=o;d=0===o,t=E.call(m,a,{"params":[d],"fn":e,"inverse":n},t),t.data+=' <a target="_blank" href="';var c=a.resolveLoose(["rate_link"],1);t=t.writeEscaped(c),t.data+='"> ';var p=(f=i.rate)!==s?f:(f=r.rate)!==s?f:a.resolveLooseUp(["rate"]),u=p;return u=0===p,t=E.call(m,a,{"params":[u],"fn":l,"inverse":v},t),t.data+=" </a></li> ",t}var f,m=this,h=m.root,g=m.buffer,x=m.scope,b=(m.runtime,m.name,m.pos,x.data),w=x.affix,L=h.nativeCommands,U=h.utils,y=(U.callFn,U.callDataFn,U.callCommand,L.range,L["void"],L.foreach,L.forin,L.each),E=(L["with"],L["if"]);L.set,L.include,L.parse,L.extend,L.block,L.macro,L["debugger"];g.data+='<h4>\u5e97\u94fa\u52a8\u6001\u8bc4\u5206<span class="compare">\u4e0e\u540c\u884c\u4e1a\u76f8\u6bd4</span></h4><ul class="render-byjs"> ';var k=(f=w.rates)!==a?f:(f=b.rates)!==a?f:x.resolveLooseUp(["rates"]);return g=y.call(m,x,{"params":[k],"fn":u},g),g.data+=" </ul>",g};return function(a){return(t=t||new e(s))&&t.render(a)||""}},{"requires":["kg/xtemplate/4.3.0/runtime"]});