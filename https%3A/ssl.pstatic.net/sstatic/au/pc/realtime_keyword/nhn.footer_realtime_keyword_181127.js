/* release date : 2018-11-26 */
nhn=window.nhn||{},nhn.FooterRealtimeKeyword=$Class({_TOTAL_ROLLING_COUNT:20,$init:function(e,t,n,i){this._sSection=t,this._sApi=n,this._nCount=0,this._bRun=!0,this._setElement(e),this._attachEvent(),new nhn.FooterKeywordTab(this._elTabChart),this._oRolling=new jindo.Rolling(this._elRolling,{nDuration:500,sDirection:"vertical",fEffect:jindo.Effect.easeInOut});var s=this;window.setInterval(function(){s._oRolling.getIndex()==s._TOTAL_ROLLING_COUNT&&(s._elRolling.scrollTop=0),s._oRolling.moveBy(1)},2e3)},start:function(){this._oTimer&&(clearTimeout(this._oTimer),this._oTimer=null),this._oTimer=setTimeout(this._fRequest,this._getDelay())},stop:function(){this._oTimer&&(clearTimeout(this._oTimer),this._oTimer=null)},response:function(e){this._bRun&&(this._oTimer=setTimeout(this._fRequest,this._getDelay()));for(var t=0;t<e.length;t++){var n=e[t],i=this._aRollingItem[t];this._updateData(i,n),0==t&&(i=this._aRollingItem[this._TOTAL_ROLLING_COUNT],this._updateData(i,n));var s=this._aTabRealTimeItem[t];this._updateData(s,n)}},responseTime:function(e){this._elTime.innerHTML=e},_updateData:function(e,t){if(e){$$.getSingle("._text",e).innerHTML=t.K;var n=$$.getSingle("._status",e),i=$Element(n),s=$$.getSingle("._stext",n),a=$$.getSingle("._step",n);"+"==t.S?(i.removeClass("down equal new").addClass("up"),s.innerHTML="상승",a.innerHTML=t.V):"-"==t.S?(i.removeClass("up equal new").addClass("down"),s.innerHTML="하락",a.innerHTML=t.V):"new"==t.S?(i.removeClass("up down equal").addClass("new"),s.innerHTML="",a.innerHTML="NEW"):"."==t.S&&(i.removeClass("up down new").addClass("equal"),s.innerHTML="동일",a.innerHTML=t.V);$$.getSingle("._link",e).href=nhn.FooterRealtimeKeyword.createUrl(t.K,this._sSection)}},_setElement:function(e){this._el=e,this._elRolling=$$.getSingle("._roling_realtime",e),this._aRollingItem=$$("ol li",this._elRolling),this._elTabChart=$$.getSingle("._tab_chart",e),this._welTabChart=$Element(this._elTabChart),this._elTabRealTime=$$.getSingle("._tabRealtime",e),this._aTabRealTimeItem=$$("ol li",this._elTabRealTime),this._elTime=$$.getSingle("._time",this._elTabRealTime)},_attachEvent:function(){$Fn(this._onMouseoverOnRollingChart,this).attach(this._elRolling,"mouseover"),$Fn(this._onMouseoutOnRollingChart,this).attach(this._elRolling,"mouseout"),$Fn(this._onMouseoutOnTabChart,this).attach(this._elTabChart,"mouseout")},_onMouseoverOnRollingChart:function(e){var t=this;this._oTimer=window.setTimeout(function(){t._oTimer=null,t._welTabChart.addClass("over")},300)},_onMouseoutOnRollingChart:function(e){this._oTimer&&(window.clearTimeout(this._oTimer),this._oTimer=null)},_onMouseoutOnTabChart:function(e){if(e.relatedElement){$Element(e.relatedElement).isChildOf(this._el)||this._welTabChart.hasClass("over")&&this._welTabChart.removeClass("over")}},_request:function(){var e=document.getElementsByTagName("head")[0];this._elScript&&e.removeChild(this._elScript);var t=this._sApi+"/"+this._sSection+"_utf8_v2.js?sm=tab_lve&callcntdummy="+(this._nCount+1)*parseInt(1e5*Math.random())+"&dummy="+parseInt(1e5*Math.random())+parseInt(1e5*Math.random()),n=document.createElement("script");n.type="text/javascript",n.src=t,n.charset="utf-8",e.appendChild(n),this._elScript=n,this._nCount++},_getDelay:function(){var e=this._nCount;return e<1?3e3:e<4?3e4:e<7?3e4:e<9?45e3:e<10?6e4:e<11?75e3:e<12?9e4:9e5}}),nhn.FooterRealtimeKeyword.createUrl=function(e,t){var n="",i="";return"nexearch"==t?(n=g_site.length>0?urlexpand("?where=nexearch&site="+g_site):g_D?urlexpand("?where=nexearch"):"http://search.naver.com/search.naver?where=nexearch",i="tab_lvf"):(n=g_site.length>0?urlexpand("?where="+g_stab+"&site="+g_site):urlexpand("?where="+g_stab),i="tab_tlv"),n+="&query="+encodeURIComponent(e)+"&ie=utf8&sm="+i},nhn.FooterKeywordTab=$Class({$init:function(e){this._setElement(e),this._attachEvent(e),this._nCurrentIndex=0,this._nRealtimeCurrentIndex=0,this._nNewsCurrentIndex=0},select:function(e){$Element(this._aTab[e]);this._aTabArea.length>e&&this._aTabArea.length>e&&($ElementList(this._aTab).removeClass("selected"),$ElementList(this._aTabArea).hide(),$Element(this._aTab[e]).addClass("selected"),$Element(this._aTabArea[e]).show(),this._nCurrentIndex=e)},selectRealtime:function(e){var t=$Element(this._aRealtimeTab[e]);this._aRealtimeTabArea.length>e&&this._aRealtimeTabArea.length>e&&($ElementList(this._aRealtimeTab).removeClass("selected"),$ElementList(this._aRealtimeTabArea).hide(),$Element(this._aRealtimeTab[e]).addClass("selected"),$Element(this._aRealtimeTabArea[e]).show(),$Element(this._elBlindRealtime).html(t.attr("data-blind-text")),this._nRealtimeCurrentIndex=e)},selectNews:function(e){var t=$Element(this._aNewsTab[e]);this._aNewsTabArea.length>e&&this._aNewsTabArea.length>e&&($ElementList(this._aNewsTab).removeClass("selected"),$ElementList(this._aNewsTabArea).hide(),$Element(this._aNewsTab[e]).addClass("selected"),$Element(this._aNewsTabArea[e]).show(),$Element(this._elBlindNews).html(t.attr("data-blind-text")),this._nNewsCurrentIndex=e)},_setElement:function(e){this._el=e,this._aTab=$$("._tab li",e),this._aTabArea=$$("._tab_area",e),this._nCurrentIndex=parseInt($Element($$.getSingle("._tab li.selected",e)).attr("data-index"),10),this._aRealtimeTab=$$("._realtime_tab li",e),this._aRealtimeTabArea=$$("._realtime_tab_area",e),this._nRealtimeCurrentIndex=parseInt($Element($$.getSingle("._realtime_tab li.selected",e)).attr("data-index"),10),this._aNewsTab=$$("._news_tab li",e),this._aNewsTabArea=$$("._news_tab_area",e),this._nNewsCurrentIndex=parseInt($Element($$.getSingle("._news_tab li.selected",e)).attr("data-index"),10),this._elBlindRealtime=$$.getSingle("._blind_realtime",e),this._elBlindNews=$$.getSingle("._blind_news",e)},_attachEvent:function(e){$Fn(this._onClickTab,this).attach(this._aTab,"click"),this._aRealtimeTab.length>0&&$Fn(this._onClickRealtimeTab,this).attach(this._aRealtimeTab,"click"),this._aNewsTab.length>0&&$Fn(this._onClickNewsTab,this).attach(this._aNewsTab,"click")},_onClickTab:function(e){var t=e.currentElement,n=parseInt(t.getAttribute("data-index"));this.select(n)},_onClickRealtimeTab:function(e){var t=e.currentElement,n=parseInt(t.getAttribute("data-index"));this.selectRealtime(n)},_onClickNewsTab:function(e){var t=e.currentElement,n=parseInt(t.getAttribute("data-index"));this.selectNews(n)}});