var AttachPath=new Array(10);var AttachName=new Array(10);var AttachSize=new Array(10);var AttachNumber=new Array(10);var AttachSequence=new Array(10);var MailFileList=[];function fileChange(){var a=document.fileForm;a.file.value=a.filename.value}function fileInit(){var a=document.fileForm;a.Attach_Finish.value="YES";fileDeleteAll()}function fileAddOption(a,k,c,b,l,j,h){var g=document.fileForm;var f=l;var d=Math.ceil(b/1024);g.fileList.options[f].text=c+" ("+d+" KB)";g.fileList.options[f].value=a+"/"+k;AttachPath[f]=a+"/"+k;AttachName[f]=c;AttachSize[f]=b;AttachNumber[f]=j;AttachSequence[f]=h;for(var e=0;e<f;e++){g.fileList.options[e].selected=false}g.fileList.options[f].selected=true;g.Attach_Finish.value="YES";g.attachFileNo.value=j;if(g.file){g.file.value=""}}function fileDelete(){var d=document.fileForm;if(d.fileList.selectedIndex<0||d.fileList.selectedIndex==null){alert("삭제할 파일을 선택하십시오.");return}d.Attach_Finish.value="NO";d.fileList.options[d.fileList.selectedIndex].text=d.fileList.options[d.fileList.selectedIndex].text+"을 삭제중입니다.";var c=_fileLinkDelete;var b="&fileNo="+AttachNumber[d.fileList.selectedIndex]+"&sequence="+AttachSequence[d.fileList.selectedIndex]+"&selectedIndex="+d.fileList.selectedIndex;var a="/support/fileInfo/deleteFile.help";if(d.fileDeleteUrl){a=d.fileDeleteUrl.value}sendRequest(_fileLinkDelete,b,"POST",a,true);fileDeleteOption(d.fileList.selectedIndex,"");if(d.fileTotalSize){d.fileTotalSize.value=parent.fileTotalSize()}}function _fileLinkDelete(a){}function fileDeleteOption(c,d){var e=document.fileForm;if(d.length>0){alert(d)}if(typeof c=="string"){c=parseInt(c,10)}e.fileList.options[c]=null;AttachPath[c]=null;AttachName[c]=null;AttachSize[c]=null;AttachNumber[c]=null;AttachSequence[c]=null;for(var b=c;b<9;b++){if(AttachPath[b+1]!=null){AttachPath[b]=AttachPath[b+1];AttachPath[b+1]=null}if(AttachName[b+1]!=null){AttachName[b]=AttachName[b+1];AttachName[b+1]=null}if(AttachSize[b+1]!=null){AttachSize[b]=AttachSize[b+1];AttachSize[b+1]=null}if(AttachNumber[b+1]!=null){AttachNumber[b]=AttachNumber[b+1];AttachNumber[b+1]=null}if(AttachSequence[b+1]!=null){AttachSequence[b]=AttachSequence[b+1];AttachSequence[b+1]=null}}var a=e.fileList.length;if(a!=0){e.fileList.options[0].selected=true}e.Attach_Finish.value="YES"}function fileDeleteAll(){var c=document.fileForm;var a=c.fileList.length;for(var b=a;b>0;b--){c.Attach_Finish.value="NO";fileDeleteOption(b-1,"")}}function fileTotalSize(){var a=0;for(var b=0;b<10;b++){if(AttachSize[b]==null){break}a+=parseInt(AttachSize[b])}return a}function getFileId(c,a,b){a=(a||"");b=(b||"");c="#"+c;a=(a!="")?"_"+a:"";b=(b!="")?"_"+b:"";return[c,a,b].join("")}function ShowAttachWin(d,c){var a=jQuery("#attachFileNo").val();var g=jQuery("#categoryNo").val();if(typeof exceptSearchYn=="undefined"){exceptSearchYn="false"}var b=parseInt(jQuery(getFileId("attachMaxCount",c)).val(),10);var f=parseInt(jQuery(getFileId("attachCount",c)).val(),10);if(b<=f){alert("파일을 "+b+"개까지 정상 첨부 가능합니다");return}var e="/support/fileInfo/file.help?fileId="+c+"&fileNo="+a+"&categoryNo="+g+"&exceptSearchYn="+exceptSearchYn;var h="width=400,height=300,left="+((screen.width-410)/2)+",top="+((screen.height-50)/4)+",resizable=no,scrollbars=no,status=no";window.open(e,"fileSelect",h)}function successFileUpload(c){for(var b=0,a=c.length;b<a;b++){createFileUpload(c[b])}}function addAttachCount(f,d){var h=f.fileId;var b=f.fileType;var g=jQuery(getFileId("attachFileCount"));var e=jQuery(getFileId("attachCount",h));e.val(parseInt(e.val())+d);g.val(parseInt(g.val())+d);var a=parseInt(jQuery(getFileId("attachMaxCount",h)).val(),10);var c=parseInt(e.val(),10);if(c==0){jQuery(getFileId("attachList",h)).hide()}else{jQuery(getFileId("attachList",h)).show()}}function deleteAttachFile(d){var b=jQuery("<form></form>",{target:"proc",method:"POST",action:"/support/fileInfo/deleteFile.help"});b.append(jQuery("<input/>",{type:"hidden",name:"fileId",value:d.fileId}));b.append(jQuery("<input/>",{type:"hidden",name:"fileType",value:d.fileType}));b.append(jQuery("<input/>",{type:"hidden",name:"attachFileNo",value:d.attachFileNo}));b.append(jQuery("<input/>",{type:"hidden",name:"sequence",value:d.sequence}));b.append(jQuery("<input/>",{type:"hidden",name:"formToken",value:jQuery("#formToken").val()}));jQuery("body").append(b);b.submit();b.remove();var a=[];for(var c=0;c<MailFileList.length;c++){if(MailFileList[c].sequence==parseInt(""+d.sequence,10)){continue}a.push(MailFileList[c])}MailFileList=a}function deleteAttachFileAll(){jQuery.each(jQuery("a[id^='attachDelete_']"),function(b,a){a.click()})}function createFileUpload(g){var d=g;jQuery("#attachFileNo").val(g.attachFileNo);var c=getFileId("attachDiv",g.fileId,g.sequence);jQuery(c).remove();var h=jQuery('<span class="blind">삭제</span>').data("fileData",{fileId:d.fileId,fileType:d.fileType,attachFileNo:d.attachFileNo,sequence:d.sequence});var b=jQuery("<a />").click(function(j){var i=jQuery(j.target).find("span:first-child").data("fileData");deleteAttachFile(i);jQuery(getFileId("attachDiv",i.fileId,i.sequence)).remove()}).attr("id","attachDelete_"+d.fileId+"_"+d.sequence).attr("href","#attachDelete").addClass("btn_del").addClass("ic_frm").append(h);var f=jQuery('<span class="file_size" />').append(Math.ceil(d.fileSize/1024)+" KB").append(b);var a=jQuery("<li />").attr("id","attachDiv_"+d.fileId+"_"+d.sequence).append('<span class="ic_file ic_frm"></span>').append('<span class="file_name">'+d.cutFileName+"</span>").append(f);var e=jQuery(getFileId("attachList",d.fileId));if(e.children().size()%2==1){a.addClass("even")}e.append(a);MailFileList.push({sequence:d.sequence,realFileName:d.realFileName,cutFileName:d.cutFileName});jQuery(getFileId("attachFileName",d.fileId)).val(d.realFileName);addAttachCount(d,1)};