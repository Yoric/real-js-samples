define("OK/AjaxNavigationLog",["OK/logger"],function(j){var d="ajaxrequestdatatime.send.time";var c;var g;var i;var f;var e=false;function l(n,o,m){g=o;i=m;c=JSON.parse(n);e=true;}function k(p){var n=100,m=2000,o;if(p<n){return 1;}if(p>m){p=m;}o=~~(p/n);return n*o;}function b(n,m){if(e){var p=a(m);if(p.length>0){j.duration(d,n,i+"_"+p,g);var o=k(n);if(o){j.success("ad","ajax_"+i+"_"+p,o);}}}}function a(n){var m=h("st.cmd",n),r=h("cmd",n);for(var q=0;q<c.length;q++){var t=c[q];if(t.indexOf("_")>-1){var p=t.split("_");var o=p[0];var s=p[1];if("*"===o&&r===s){return s;}if(m===o&&r===s){return m+"_"+r;}}else{if(m===t){return t;}}}return"";}function h(r,m){var q=m.substring(Math.max(0,m.indexOf("?")+1)).split("&");for(var n=0;n<q.length;n++){var p=q[n];var o=p.indexOf(r+"=");if(o===0){return p.substr(r.length+1);}}return"";}return{log:b,activate:function(m){if(f){return;}l(m.textContent,m.getAttribute("data-region"),m.getAttribute("data-countrycode"));f=true;},deactivate:function(){c.length=0;g="";i="";f=false;}};});define("OK/utils/utils",["jquery","OK/logger","OK/AjaxNavigationLog"],function(e,l,b){var j=document.getElementById("hook_Cfg_GwtExperimentsCfg");var c=j?OK.util.parseJSON(j.innerHTML):{};var d="data-";function f(p,n,o){var m=p.split(OK.navigation.SPLITER);m.forEach(function(q,r){if(o[r]){OK.hookModel.setHookContent(o[r],q);}});}function i(p,n,o,m){var r=Date.now();var q=e.ajax(p);m.xhr=q;m.fail(function(){q.abort();});q.done(function(u,w,v){b.log(Date.now()-r,p.url);if(u&&v.responseText&&u.length===0&&v.responseText.length!==0&&v.responseText!="[]"){l.error("ajax",w);l.clob("ajax",JSON.stringify({requestData:p,response:v.responseText}));}var t=v.getResponseHeader("TKN");if(t){OK.tkn.set(t);}var s=v.getResponseHeader("Redirect-Location");if(s){n(s);m.reject(v,w,"Redirect");return;}m.resolve(u,w,v);});q.fail(function(s,u,t){if(o>0){if(u=="timeout"||!p.timeout){i(p,n,--o,m);}else{setTimeout(function(){i(p,n,--o,m);},p.timeout);}}else{m.reject(s,u,t);}});return m;}function a(o,m,p){var n=p.getResponseHeader(OK.navigation.HEADER);if(n){return n.split(",");}return null;}function k(p,n){if(typeof p==="string"){p=document.getElementById(p);}var q={};for(var o=0;o<p.attributes.length;o++){var m=p.attributes[o];if(m.name.indexOf(d)==0){q[m.name.substring(d.length)]=m.value;}}if(n){p.parentNode.removeChild(p);}return q;}function g(n,m){var p={};var o=Array.prototype.slice.call(n.elements);if(m){o=o.filter(m);}o.forEach(function(r){var q=r.name;if(q){if(r.type==="checkbox"){p[q]=r.checked?"on":"off";}else{p[q]=r.value;}}});return p;}function h(n){var m=n?n.replace(/<!--/ig,"").replace(/-->/ig,""):null;return m?JSON.parse(m):null;}return{ajax:function(n,m,p){if(arguments.length>1){if(typeof arguments[1]!=="function"){p=m;m=undefined;}}p=p||0;m=m||function(r){if(OK.navigation.redirect){OK.navigation.redirect(r);}else{document.location.href=decodeURIComponent(r);}};var q=n.data||{};var o=n.beforeSend;n.type=n.type||"POST";if(n.type==="POST"&&n.contentType&&n.contentType.indexOf("application/json")!=-1){if(typeof q!=="string"){q=JSON.stringify(q);}}else{q["gwt.requested"]=window.pageCtx.gwtHash;}n.data=q;n.beforeSend=function(s,r){s.setRequestHeader("TKN",OK.tkn.get());if(o){o.apply(this,arguments);}};return i(n,m,p,e.Deferred());},getBlockIds:a,updateBlockModelCallback:function(o,m,p){var n=a(o,m,p);if(n){f(o,m,n);}},updateBlocks:f,gwtExperimentsCfg:c,removeTags:function(m){return typeof m==="string"?m.replace(/<[^>]*>/g,""):m;},isElementInViewport:function(m){var n=m.getBoundingClientRect();if(n.top<0||n.left<0||n.bottom>window.innerHeight||n.right>window.innerWidth){return false;}return(m.contains(document.elementFromPoint(n.left,n.top))||m.contains(document.elementFromPoint(n.right,n.top))||m.contains(document.elementFromPoint(n.right,n.bottom))||m.contains(document.elementFromPoint(n.left,n.bottom)));},isElementPartiallyInViewport:function(q,n){if(!n){return this.isElementInViewport(q);}var r=q.getBoundingClientRect(),m=Math.min(r.bottom,window.innerHeight)-Math.max(0,r.top),o=Math.min(r.right,window.innerWidth)-Math.max(0,r.left),p=q.offsetHeight,s=q.offsetWidth;return p*n<=m&&s*n<=o;},extendDeep:function(m){m=m||{};for(var o=1;o<arguments.length;o++){var p=arguments[o];if(!p){continue;}for(var n in p){if(p.hasOwnProperty(n)){if(typeof p[n]==="object"&&!Array.isArray(p[n])){m[n]=this.extendDeep(m[n],p[n]);}else{m[n]=p[n];}}}}return m;},urlBase64ToUint8Array:function(s){var q=p("=",(4-s.length%4)%4);var m=(s+q).replace(/\-/g,"+").replace(/_/g,"/");var r=window.atob(m);var o=new Uint8Array(r.length);for(var n=0;n<r.length;++n){o[n]=r.charCodeAt(n);}return o;function p(u,v){var t="";while(v-->0){t+=u;}return t;}},deferred:function(){var n,m;return{promise:new Promise(function(p,o){n=p;m=o;}),resolve:n,reject:m};},getAttributesFromElement:k,getFormData:g,parseJson:h};});define("OK/utils/dom",[],function(){function f(i,k){if(i){if(i.nodeType==11){var h=[];for(var l=0;l<i.childNodes.length;l++){var j=i.childNodes[l];if(j.getElementsByClassName){h=h.concat(Array.prototype.slice.call(j.getElementsByClassName(k)));}}return h;}return Array.prototype.slice.call(i.getElementsByClassName(k));}return[];}function g(h,i){var j=f(h,i);return j.length?j[0]:null;}function d(h,i,k,j){if(!j){h=h.parentElement;}while(h){if(!i||!h.classList||h.classList.contains(i)){return h;}if(k&&(k===h)){return null;}h=h.parentElement;}return h;}function b(i,j,l,k){if(!k){i=i.parentElement;}while(i){var h=j(i);if(h){return i;}if(l&&(l===i)){return null;}i=i.parentElement;}return i;}function e(i,h,l){var k=function(m){return m.getAttribute(h);},j=b(i,k,l,true);return j?k(j):null;}function a(i){if(!Array.isArray(i)){i=[i];}var h;i.forEach(function(j){h=j.parentNode;if(h){h.removeChild(j);}});}function c(h){var i=h.cloneNode(true);h.parentNode.replaceChild(i,h);return i;}return{byClass:f,firstByClass:g,parent:d,traverseParents:b,getParentsAttrValue:e,forEach:function(i,h){Array.prototype.slice.call(i).forEach(h);return i;},innerHeight:function(h){try{return window.getComputedStyle(h,null).getPropertyValue("height");}catch(i){return h.currentStyle.height;}},outerSize:function(k,l,i){var h=l?k.offsetWidth:k.offsetHeight;if(h!==null){if(i){var j=window.getComputedStyle?window.getComputedStyle(k,null):k.currentStyle;h+=l?parseInt(j.marginLeft,10)+parseInt(j.marginRight,10):parseInt(j.marginTop,10)+parseInt(j.marginBottom,10);}return h;}return 0;},remove:a,one:function(j,i,k){j.addEventListener(i,function h(l){l.target.removeEventListener(l.type,h);return k.call(this,l);});},removeAllListeners:c};});define("OK/registration/StatesManager",[],function(){var b={relogin:{login:function(c){var d=c.getElementsByClassName("js-login-form")[0];if(d){d.elements["st.redirect"].value=null;}}}};function a(c){this.root=c;this.states=[];this.activeStateId=null;var g=this.root.getElementsByClassName("js-login-state");var f=null;for(var e=0;e<g.length;e++){var d=g[e];var h=d.getAttribute("data-state-id");this.states.push({stateId:h,stateBlock:d,stateLink:c.getElementsByClassName("js-login-"+h)[0]});if(!d.classList.contains("invisible")){f=h;}}this.switchToState(f);}a.prototype.executeStateToStateAction=function(d){var e=b[this.activeStateId];if(e){var c=e[d];if(typeof c==="function"){c(this.root);}}};a.prototype.switchToState=function(e){if(e!==this.activeStateId){for(var d=0;d<this.states.length;d++){var c=this.states[d];c.stateBlock.classList.toggle("invisible",e!==c.stateId);if(c.stateLink){c.stateLink.classList.toggle("__active",e===c.stateId);}}this.executeStateToStateAction(e);this.activeStateId=e;}};return a;});define("OK/registration/Registration",["OK/utils/utils","OK/utils/dom","OK/registration/StatesManager"],function(c,e,b){var a="js-login-nav";function d(){}d.prototype.formHandler=function(j){j.preventDefault();var h={};for(var f=0;f<this.form.elements.length;f++){var g=this.form.elements[f];h[g.name]=g.value;}c.ajax({url:this.form.action,data:h}).done(c.updateBlockModelCallback);};d.prototype.navigationHandler=function(h){h.preventDefault();var f=e.parent(h.target,a,false,true);var g=f.getAttribute("href");if(g){this.statesManager.switchToState(f.id.split("-")[0]);if(OK.historyManager.getState()!==g){OK.historyManager.pushState(g);}this.fixHeight();}};d.prototype.fixHeight=function(){if(this.heightHolder){var f=this.heightHolder.clientHeight<320?320:this.heightHolder.clientHeight;this.heightHolder.style.minHeight=f+"px";}};d.prototype.activate=function(f){this.loginNavigation=e.byClass(f,a);this.form=e.firstByClass(f,"js-login-form");this.statesManager=new b(f);this.boundNavigationHandler=this.navigationHandler.bind(this);this.boundFormHandler=null;var h=f.getAttribute("data-modal")==="true";e.firstByClass(f,"js-st.field_fJS").value="on";e.firstByClass(f,"js-field_st.screenSize").value=screen.width+" x "+screen.height;e.firstByClass(f,"js-field_st.browserSize").value=window.innerHeight;e.firstByClass(f,"js-field_st.flashVer").value=(okFlashVersion||[]).join(".");if(h){this.boundFormHandler=this.formHandler.bind(this);this.form.addEventListener("submit",this.boundFormHandler);OK.loader.use(["OKCustomJs"],function(){OK.Layers.register("registration",function(){OK.hookModel.setHookContent("PopLayer","");},null,false,null,null);});}else{this.heightHolder=e.parent(f,"anonym_login_w");this.fixHeight();}for(var g=0;g<this.loginNavigation.length;g++){this.loginNavigation[g].addEventListener("click",this.boundNavigationHandler);}};d.prototype.deactivate=function(){if(this.boundFormHandler){this.form.removeEventListener("submit",this.boundFormHandler);}for(var f=0;f<this.loginNavigation.length;f++){this.loginNavigation[f].removeEventListener("click",this.boundNavigationHandler);}};return d;});define("OK/registration/Utils",["OK/utils/utils"],function(b){var a=document.getElementById("generalErrorHook"),c=null,d={registration:{prefix:"st.r.",state:"anonymMain",cmd:"AnonymRegistration"},password:{prefix:"st.",state:"anonymPasswordRecoveryNew",cmd:"AnonymPasswordRecoveryNew"},account:{prefix:"st.",state:"anonymAccountRecoveryFlow",cmd:"AnonymAccountRecoveryFlow"}};if(a){c=a.getAttribute("data-general");a.parentNode.removeChild(a);}return{lastSmsTimeCookieName:"_lastSmsForCodeTime_",addSubmitHook:function(e,f){e.addEventListener("keyup",function(g){if(g.keyCode==13){f();}});},getAttributesFromHook:b.getAttributesFromElement,proceed:function(k,e,g,h){var j={};for(var f in k){j[d[h].prefix+f]=k[f];}var i={data:j,url:"/dk"};i.data["st.cmd"]=d[h].state;i.data.cmd=d[h].cmd;b.ajax(i).done(b.updateBlockModelCallback).fail(function(l,n,m){if(m!="Redirect"&&g&&c){g.classList.remove("invisible");g.textContent=c;}});},toggleClass:function(f,e,g){if(g){f.classList.add(e);}else{f.classList.remove(e);}},hideFieldError:function(e,f){if(e){e.classList.remove("form_i__error");}if(f){f.classList.remove("invisible");}},showFieldError:function(g,h,f,e){if(f){f.textContent=e;}if(g){g.classList.add("form_i__error");}if(h){h.classList.add("invisible");}},getInputValue:function(e){return e?e.value:"";},getValueForLog:function(e){if(e>=100){e=100;}else{if(e>=50){e=50;}else{if(e>=25){e=25;}else{if(e>=10){e=10;}}}}return e;},getActionByType:function(e){if("account"==e){return"accountAction";}else{return"registrationAction";}}};});define("OK/utils/vanilla",["OK/AjaxNavigationLog"],function(d){function m(p){var n=[],r=function(s,t){n.push(encodeURIComponent(s)+"="+encodeURIComponent(t));};for(var o in p){if(p.hasOwnProperty(o)){var q=p[o];if(Array.isArray(q)){q.forEach(r.bind(null,o));}else{r(o,p[o]);}}}return n.join("&");}function l(n){var r=[],p=n&&n.indexOf("?");if(p>-1){var q=n.substr(p+1),o=q.split("&");o.forEach(function(t){if(t.indexOf("=")>-1){var s=t.split("="),u=s[0],v=s[1];v=decodeURIComponent(v.replace(/\+/g,"%20"));r[u]=v;}});}return r;}function k(s,n){var w=s.type||"POST",u=s.data||{},p=s.url||"",o=/^(https?:)?\/\//.test(p),v={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},r=s.headers||{},q={},x=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,z=s.beforeOpen,y=new XMLHttpRequest();if(!n){n=function(B){if(OK.navigation.redirect){OK.navigation.redirect(B);}else{document.location.href=decodeURIComponent(B);}};}if((w==="POST")&&(typeof u!=="string")){if(s.isFileUpload){r["Content-Type"]="application/octet-stream";var t=(u.name||"1.jpg").replace(/[^\u0000-\u007F]+/gi,"_").substring(0,255);r["Content-Disposition"]='attachment; filename="'+t+'"';}else{r["Content-Type"]="application/x-www-form-urlencoded";if(window.pageCtx.gwtHash){u["gwt.requested"]=window.pageCtx.gwtHash;}u=m(u);}}if(s.contentType&&v.hasOwnProperty(s.contentType)&&!r.hasOwnProperty("Content-Type")){r["Content-Type"]=v[s.contentType];}if(s.dataType&&v.hasOwnProperty(s.dataType)&&!r.hasOwnProperty("Accept")){r.Accept=s.dataType==="*"?v[s.dataType]:v[s.dataType]+", */*; q=0.01";}if(!o&&!r.hasOwnProperty("TKN")){r.TKN=OK.tkn.get();}var A=new Promise(function(D,C){var B=Date.now();if(z){z({xhr:y});}y.open(w,p,true);for(var E in r){if(r.hasOwnProperty(E)){y.setRequestHeader(E,r[E]);}}y.onreadystatechange=function(){if(y.readyState===XMLHttpRequest.HEADERS_RECEIVED){var I=y.getAllResponseHeaders(),G;while(G=x.exec(I)){q[G[1].toLowerCase()]=G[2];}if(!o&&q["redirect-location"]){n(q["redirect-location"]);C(y,y.statusText,"Redirect");return;}}if(y.readyState!==XMLHttpRequest.DONE){return;}if(y.status>=200&&y.status<300||y.status===304){d.log(Date.now()-B,p);var F=y.responseText,J=F;if(s.dataType==="json"){try{J=JSON.parse(F);}catch(H){C(H);}}if(!o&&q.tkn){OK.tkn.set(q.tkn);}D({response:J,xhr:y});}else{C(y);}};y.onerror=function(){C(y);};y.send(u);});A.xhr=y;return A;}function i(n,o){return k({type:"GET",dataType:"json",url:n,data:o});}function e(o,n,p){if(!o||o.nodeType===3||o.nodeType===8){return;}var q=document.createEvent("CustomEvent");q.initCustomEvent(n,true,true,p);o.dispatchEvent(q);}function c(o){var n=document.createElement("div");n.innerText=o;return n.innerHTML;}function a(o){var n=o.getResponseHeader(OK.navigation.HEADER);if(n){return n.split(",");}return null;}function h(p,o){var n=p.split(OK.navigation.SPLITER);n.forEach(function(q,r){if(o[r]){OK.hookModel.setHookContent(o[r],q);}});}function g(n){return n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'");}function b(o){return o.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");}function f(o){var n=a(o.xhr);if(n){h(o.response,n);}}function j(n){return Array.prototype.slice.apply(n.getElementsByTagName("input")).reduce(function(p,o){if(o.name){p[o.name]=o.type==="checkbox"?(o.checked?"on":"off"):o.value;}return p;},{});}return{ajax:k,getJSON:i,trigger:e,encodeHtml:c,extractParams:l,getBlockIds:a,updateBlocks:h,updateBlockModelCallback:f,getFormData:j,unescapeXml:g,formatNumber:b};});define("OK/PhoneForm",["OK/utils/vanilla","OK/utils/dom","OK/logger"],function(y,d,w){var p="data-",c=400,I=5,G="phoneValidationError",C,D,t,J,A,B,r,u,k,z,m,q,a,e,n;function b(O,L){if(typeof O==="string"){O=document.getElementById(O);}var Q={};for(var N=0;N<O.attributes.length;N++){var K=O.attributes[N];if(K.name.indexOf(p)===0){var P=K.value;var M=K.name.substring(p.length);if(P==="false"){Q[M]=false;}else{if(P==="true"){Q[M]=true;}else{Q[M]=K.value;}}}}if(L){O.parentNode.removeChild(O);}return Q;}function v(){clearTimeout(a);if(e){e.abort();e=undefined;}}function g(K){D.classList.add("form_i__error");J.textContent=K;}function l(){D.classList.remove("form_i__error");J.textContent="";}function s(N,L,K){v();if(F().length<I){if(L){L();}g(B["error-wrong-number"]);i("tooShort");return;}else{if(!B.enabled){l();if(N){N();}return;}}e=y.ajax({type:"GET",url:B.url+"&phone="+encodeURIComponent(t.value),dataType:"json"}).then(function M(P){var S=P.response;var W=false;if(S.typing_check){var O=S.typing_check;z(O.modified_phone_number,O.modified_prefix);if(S.status==="OK"){var Q=function(X){if(X){for(var Y=0;Y<X.length;Y++){if(X[Y]==="mobile"){return true;}}}i("notMobile");return false;};if(B.checkMobile){W=Q(O.prefix_state);}else{W=true;}}else{i("status"+S.status);}}if(W){l();if(N){N();}}else{if(L){L();}var U=function(X){return X.charAt(0).toUpperCase()+X.slice(1)+".";};var T=S.printable;if(T&&T.length>0){var V=U(T[0]);if(T.length>1){for(var R=1;R<T.length;R++){V+=" "+U(T[R]);}}g(V);}else{g(B["error-wrong-number"]);}}},K).xhr;}function o(O,M,L){v();if(F().length<I){if(M){M();}g(r["error-wrong-number"]);i("tooShort");return;}var K=t.value;e=y.ajax({type:"GET",url:"/web-api/phoneinfo?phone="+encodeURIComponent(K)+"&service_name=odkl_registration&location=srv.check_phone_reg",dataType:"json"}).then(function N(S){if(K!=t.value){return;}var R=S.response;if(R.modified_phone||R.modified_prefix){z(R.modified_phone,R.modified_prefix);}if(R.ok){l();if(O){O();}}else{if(M){M();}var P=function(V){return V.charAt(0).toUpperCase()+V.slice(1)+".";};var U=R.printable;if(U&&U.length>0){var T=P(U[0]);if(U.length>1){for(var Q=1;Q<U.length;Q++){T+=" "+P(U[Q]);}}g(T);}else{g(B["error-wrong-number"]);}}},L).xhr;}function f(){return t;}function x(){return t.value.replace("+","");}function h(){return C.options[C.selectedIndex].getAttribute("data-id");}function i(N){var L=t.value;var M={phone:L,error:N};var K=JSON.stringify(M);w.success(G,K);}function j(){return C.value.replace("+","");}function E(){if(B.enabled){return"";}else{return j();}}function F(){if(B.enabled){return x();}else{return j()+x();}}function H(O){C=d.firstByClass(O,"js-country");D=d.firstByClass(O,"js-phone-form");t=d.firstByClass(O,"js-phone");J=d.firstByClass(O,"js-ph-vl-hint");var R=d.firstByClass(O,"js-hook-serverside-phone-correction");var M=d.firstByClass(O,"js-hook-phone-correction");if(R){r=b(R,true);}if(M){B=b(M,true);}else{B={enabled:false};}if(r.enabled){A={};for(var L=0;L<C.options.length;L++){var K=C.options[L].value.replace("+","");if(typeof A[K]==="undefined"){A[K]=L;}}z=function(S,T){if(S){t.value=S;u=S;}if(k!==T){k=T;C.selectedIndex=A[k.replace("+","")];}};q=function(S){if(!n){S=S.replace("+","");for(var T=S.length;T>0;T--){var U=S.substring(0,T);if(typeof A[U]!=="undefined"){if(U!==k.replace("+","")){C.selectedIndex=A[U];k=C[C.selectedIndex].value;C.dispatchEvent(new CustomEvent("prefixChange"));}break;}}}};k=C.value;}else{if(B.enabled){A={};for(var L=0;L<C.options.length;L++){var K=C.options[L].value.replace("+","");if(typeof A[K]==="undefined"){A[K]=L;}}z=function(S,T){t.value=S;u=S;if(k!==T){k=T;C.selectedIndex=A[k.replace("+","")];}};q=function(S){if(!n){S=S.replace("+","");for(var T=S.length;T>0;T--){var U=S.substring(0,T);if(typeof A[U]!=="undefined"){if(U!==k.replace("+","")){C.selectedIndex=A[U];k=C[C.selectedIndex].value;C.dispatchEvent(new CustomEvent("prefixChange"));}break;}}}};k=C.value;}else{m=d.firstByClass(O,"js-phone-code");m.addEventListener("click",t.focus);}}u=t.value;var N=function(){clearTimeout(a);var S;if(B.enabled){S=t.value.replace(/([^0-9+])/g,"").replace(/(^\+)|(\+)/g,"$1");}else{S=t.value.replace(/([^0-9])/g,"");}if(S!==t.value){t.value=S;}if(t.value===u){return;}else{u=t.value;if(B.enabled){q(t.value);}}if(B.enabled){var T=t.value.replace("+","");if(T.length>=I){v();a=setTimeout(s,c);}else{l();}}else{l();}};var Q=function(){clearTimeout(a);var S=t.value.replace(/([^0-9+])/g,"").replace(/(^\+)|(\+)/g,"$1");if(S!==t.value){t.value=S;}if(t.value===u){return;}else{u=t.value;q(t.value);}var T=t.value.replace("+","");if(T.length>=I){v();a=setTimeout(o,c);}else{l();}};var P=function(S){if(r.enabled){t.value=C.value+t.value.replace("+","").substring(k.length-1,t.value.length);k=C.value;n=!S;Q();}else{if(B.enabled){t.value=C.value+t.value.replace("+","").substring(k.length-1,t.value.length);k=C.value;n=!S;N();}else{m.textContent=C.value;}}};C.addEventListener("countryChange",function(){P(true);});C.addEventListener("change",P);C.addEventListener("input",P);if(r.enabled){t.addEventListener("input",Q);}else{t.addEventListener("input",N);}}return{init:H,getCountryId:h,getCountryCodeIfNotInNumber:E,getPhoneNumber:x,getPhoneInput:f,validatePhoneNumber:s};});define("OK/cookie",[],function(){return{setCookie:function(c,d,a,e){var f="",b;if(a){a=a*1000*60*60*24;b=new Date();b.setTime(b.getTime()+(a));f=";expires="+b.toUTCString();}document.cookie=c+"="+encodeURIComponent(d)+f+((e)?";path="+e:"");},readCookie:function(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length);}if(f.indexOf(e)==0){return f.substring(e.length,f.length);}}return null;},clearCookie:function(a,b){this.setCookie(a,"",0,b);}};});define("OK/registration/enterPhone",["OK/registration/Utils","OK/PhoneForm","OK/utils/dom","OK/cookie"],function(c,b,d,a){return{activate:function(i){var e=i.parentNode,m=d.firstByClass(e,"js-general-error"),f=d.firstByClass(i,"js-proceed-registration"),k=d.firstByClass(i,"js-captcha"),l=i.getAttribute("data-type"),g=c.getActionByType(l),h=function(){var n={countryId:b.getCountryId(),countryCode:b.getCountryCodeIfNotInNumber(),phone:b.getPhoneNumber(),ccode:c.getInputValue(k)};n[g]="ValidatePhoneNumber";a.clearCookie(c.lastSmsTimeCookieName+l,"/");c.proceed(n,e,m,l);},j=function(){b.validatePhoneNumber(h,null,h);};b.init(d.firstByClass(i,"js-phone-form"));f.addEventListener("click",j);c.addSubmitHook(b.getPhoneInput(),j);}};});define("OK/registration/enterCode",["OK/registration/Utils","OK/utils/dom","OK/cookie"],function(c,d,b){return{activate:function(f){var n=f.parentNode,s=d.firstByClass(n,"js-general-error"),j=d.firstByClass(f,"js-back-to-enter-phone"),o=d.firstByClass(f,"js-proceed-registration"),v=d.firstByClass(f,"js-proceed-registration-container"),e=d.firstByClass(f,"js-resend-sms-code"),u=d.firstByClass(f,"js-resend-sms-code-disabled"),r=d.firstByClass(f,"js-resend-sms-code-container"),h=d.firstByClass(f,"js-sms-code"),k=u.value||u.innerHTML,i=f.getAttribute("data-type"),w=c.getActionByType(i),y=f.hasAttribute("data-code-expired"),x=c.lastSmsTimeCookieName+i,l=parseInt(f.getAttribute("data-resend-timeout"))||20,g=f.getAttribute("data-format-seconds")?a:function(z){return z;},p=function(){if(h.value){var z={smsCode:h.value};z[w]="ValidateCode";c.proceed(z,n,s,i);}},m=function(){var A=parseInt(b.readCookie(x),10),B=Date.now(),C,z;if(!A){A=B;b.setCookie(x,A,1,"/");}C=Math.round((B-A)/1000);u.value=u.innerHTML=k.replace("%d",g(l-C));if(C<=l){u.classList.remove("invisible");e.classList.add("invisible");z=setInterval(function(){B=Date.now();C=Math.round((B-A)/1000);if(C<=l){u.value=u.innerHTML=k.replace("%d",g(l-C));}else{clearInterval(z);u.classList.add("invisible");e.classList.remove("invisible");e.classList.remove("__disabled");}},300);}else{u.classList.add("invisible");e.classList.remove("invisible");e.classList.remove("__disabled");}};e.addEventListener("click",t);j&&j.addEventListener("click",function(){var z={registrationAction:"BackToEnterPhone"};c.proceed(z,n,s,i);});if(y){c.toggleClass(o,"__disabled",true);u.classList.add("invisible");e.classList.remove("invisible");}else{o.addEventListener("click",p);c.addSubmitHook(h,p);h.addEventListener("keyup",q);h.addEventListener("input",q);h.addEventListener("cut",function(){setTimeout(q,0);});h.addEventListener("propertychange",function(z){if(z.propertyName=="value"){q();}});q();m();}function t(){var z={};z[w]="ResendCode";c.proceed(z,n,s,i);b.clearCookie(x,"/");m();}function q(){var z=h.value==="";if(v){c.toggleClass(v,"invisible",z);}if(r){c.toggleClass(r,"invisible",!z);}c.toggleClass(o,"__disabled",z);}}};function a(h){var e=parseInt(h/3600)%24,f=parseInt(h/60)%60,g=h%60;return(e>0?(e+":"):"")+(f<10?"0"+f:f)+":"+(g<10?"0"+g:g);}});define("OK/registration/chooseUser",["OK/registration/Utils"],function(a){return{activate:function(e){var b=e.parentNode,m=b.getElementsByClassName("js-general-error")[0],l=e.getElementsByClassName("js-its-not-me-button")[0],h=b.getElementsByClassName("chooseUserButton"),d=a.getAttributesFromHook(e.getElementsByClassName("js-action-hook")[0],true)["action"],j=e.getAttribute("data-type"),f,c,k=function(o){var n=o.target.getAttribute("data-value"),i={userId:n,registrationAction:"RecoverUser"};a.proceed(i,b,m,j);},g=function(){var i={registrationAction:d};a.proceed(i,b,m,j);};if(h){for(f=0,c=h.length;f<c;f++){h[f].addEventListener("click",k);}}l.addEventListener("click",g);}};});define("OK/registration/authorize",["OK/registration/Utils","OK/logger","OK/utils/dom"],function(b,a,c){return{activate:function(n){var J=n.parentNode,r=c.firstByClass(J,"js-general-error"),O=c.firstByClass(n,"js-proceed"),A=c.firstByClass(n,"js-enter-password"),C=c.firstByClass(n,"js-enter-login"),q=c.firstByClass(n,"js-support-link"),Q=n.getAttribute("data-type"),d=b.getActionByType(Q),H=n.getAttribute("data-enabled-log-timer"),P=n.getAttribute("data-validate-password-in-js")||true,D=0,E=300000;if(C){var G=b.getAttributesFromHook(c.firstByClass(n,"js-login-restrictions-hook"),true),N=new RegExp(G["allowed-symbols-pattern"]),K=G["min-length"],o=c.firstByClass(n,"js-login-hint"),v=c.firstByClass(n,"js-login-form"),g=c.firstByClass(n,"js-login-error"),L=b.getAttributesFromHook(c.firstByClass(n,"js-hook-login-msg"),true);var p=function(R){var S=C.value;if(!N.test(S)){b.showFieldError(v,o,g,L["invalid-characters"]);}else{if(!R){if(S==""){b.showFieldError(v,o,g,L.empty);}else{if(S.length<K){b.showFieldError(v,o,g,L["short"]);}else{b.hideFieldError(v,o);return true;}}}else{b.hideFieldError(v,o);return true;}}return false;};C.addEventListener("keyup",function(){p(true);});}var w;var k=c.firstByClass(n,"js-password-restrictions-hook");if(k){var m=b.getAttributesFromHook(k,true);var z=m["min-length"];var F=new RegExp(m["allowed-symbols-pattern"]);var I=new RegExp(m["must-contain-pattern"]);var y=m["split-must-contain-pattern"];var l=/[a-zA-Z]+/;var s=/[0-9]+/;var u=c.firstByClass(n,"js-password-error");var j=c.firstByClass(n,"js-password-form");var x=c.firstByClass(n,"js-password-indicator-container");var h=c.firstByClass(n,"js-password-rate");var B=h.getElementsByClassName("progress-rate_bar");var e=c.firstByClass(n,"js-password-indicator-hint");var M=b.getAttributesFromHook(c.firstByClass(n,"js-hook-pwd-msg"),true);var i=function(U,T,S){h.className="progress-rate mt-2x "+U;if(T>0){for(var R=0;R<T;R++){B[R].classList.add("__full");}}if(T<3){for(R=T;R<B.length;R++){B[R].classList.remove("__full");}}b.toggleClass(j,"form_i__error",S);b.toggleClass(e,"reg_error_txt",S);};w=function(R,S,T){if(u&&T){return;}if(u){b.toggleClass(j,"form_i__error",true);b.toggleClass(x,"invisible",false);u.parentNode.removeChild(u);u=null;}if(R==""){e.textContent=M.empty;i("",0,S);}else{if(!F.test(R)){i("__weak",3,true);e.textContent=M.invalid;}else{if(R.length<z||!I.test(R)){if(R.length<z&&!I.test(R)){i("__weak",1,true);}else{i("__normal",2,true);}if(R.length<z){e.textContent=M["short"];}else{e.textContent=M["must-contain"];if(y=="true"){if(l.test(R)){e.textContent=M["only-letters"];}else{if(s.test(R)){e.textContent=M["only-numbers"];}}}}}else{e.textContent=M.ok;i("__strong",3,false);return true;}}}return false;};}else{w=function(R,S,T){if(u&&T){return;}return true;};}A.addEventListener("keyup",function(){w(A.value,true);});var t=function(){var S=true;if(C){S=p();}if((!w(A.value,true)||!S)&&("true"==P)){return;}var R={password:A.value,};R[d]="Authorize";if(C){R.login=C.value;}if(q){R.splnk="on";}b.proceed(R,J,r,Q);};O.addEventListener("click",t);b.addSubmitHook(A,t);w(A.value,false,true);var f=function(){D+=1;a.success("recovery","ppot",b.getValueForLog(D));setTimeout(f,E);};if("recovery"==Q&&"true"==H){setTimeout(f,5);}}};});define("OK/registration/socialAuthHandler",[],function(){var a,c;function b(e,d){if(a&&c&&c==d){a(e);}window.socialAuthCallback=a=c=undefined;}return{openWindow:function(d,e){window.socialAuthCallback=b;a=e;c=window.open(d,"","width=600, height=600");}};});define("OK/registration/socialSignIn",["OK/utils/utils","OK/utils/dom","OK/registration/socialAuthHandler"],function(a,f,e){var d={url:"/dk",data:{cmd:"SocialSignIn"}};function c(g,i){function h(k,j){d.data["s.sign.error"]=j;d.data["s.sign.code"]=k;d.data["s.sign.socialProvider"]=g;a.ajax(d).done(i.done).fail(i.fail);}return function(j){if(j.error=="access_denied"){return;}h(j.code||"",j.error||"");};}function b(g,h){return{done:function(i){g.innerHTML=i;},fail:function(i,k,j){if(j!="Redirect"){g.innerHTML=h;}}};}return{activate:function(k){var i=k.getAttribute("data-url");var h=k.getAttribute("data-provider");var l=k.getAttribute("data-error-field");var j=k.getAttribute("data-network-error");var g=f.firstByClass(document,l);k.addEventListener("click",function(m){g.innerHTML="";e.openWindow(i,c(h,b(g,j)));m.preventDefault();});}};});define("OK/registration/cancelSocialReg",["OK/registration/Utils","OK/utils/dom","OK/cookie"],function(b,c,a){return{activate:function(g){var e=g,f,h=g.getAttribute("data-type"),i=b.getActionByType(h),d=function(k){var j={};j[i]="CancelSocialRegistration";a.clearCookie(b.lastSmsTimeCookieName+h,"/");b.proceed(j,e,f,h);k.preventDefault();};while(e.parentNode&&!e.parentNode.classList.contains("js-page-cnt")){e=e.parentNode;}e=e.parentNode;f=c.firstByClass(e,"js-general-error");g.addEventListener("click",d);}};});define("OK/registration/acceptPP",["OK/registration/Utils"],function(a){return{activate:function(f){var b=f.parentNode,e=b.getElementsByClassName("js-general-error")[0],h=f.getElementsByClassName("js-accept-pp-button")[0],j=a.getAttributesFromHook(f.getElementsByClassName("js-action-hook")[0],true)["action"],g=f.getAttribute("data-type"),d,c=function(){var i={registrationAction:j};a.proceed(i,b,e,g);};h.addEventListener("click",c);}};});define("OK/registration/enterPhoneNew",["OK/PhoneForm","OK/utils/dom"],function(a,b){return{activate:function(c){a.init(b.firstByClass(c,"js-phone-form"));}};});define("OK/registration/enterCodeNew",["OK/utils/dom"],function(a){return{activate:function(h){var c=h.parentNode;var b=a.firstByClass(c,"js-resend-sms-code-disabled");var g=a.firstByClass(c,"js-resend-sms-code");var d=a.firstByClass(c,"js-resend-sms-code_tx");var o=h.getAttribute("data-sms-wait-text");var l=parseInt(h.getAttribute("data-timer"));var i=performance&&performance.timing;var m=function(){b.classList.remove("invisible");g.classList.add("invisible");};var e=function(){b.classList.add("invisible");g.classList.remove("invisible");};var k=function(){var p=o.replace("%d",n);d.textContent=p;};if(l>0){var j=0;if(i){j=(Date.now()-i.navigationStart);}var n=Math.round((l-j)/1000);k();m();var f=setInterval(function(){if(n<=1){clearInterval(f);e();}n--;k();},1000);}else{}}};});define("OK/registration/translit",[],function(){var b={" ":[" "],"-":["-"],"а":["a"],"б":["b"],"в":["v"],"г":["g"],"д":["d"],"е":["e","ye"],"ё":["yo","jo","e","ye"],"ж":["zh"],"з":["z"],"и":["i","yi"],"й":["j","jj","y","i"],"к":["k"],"л":["l"],"м":["m"],"н":["n"],"о":["o"],"п":["p"],"р":["r"],"с":["s"],"т":["t"],"у":["u"],"ф":["f"],"х":["x","kh","h","ch"],"ц":["cz","c","ts","tc"],"ч":["ch"],"ш":["sh"],"щ":["shh","shch"],"ъ":["''","'","ie"],"ы":["y'","y"],"ь":["'"],"э":["e'","eh","e"],"ю":["yu","ju","iu"],"я":["ya","ja","ia"]};var a={" ":[" "],"-":["-"],"а":["f"],"б":[","],"в":["d"],"г":["u"],"д":["l"],"е":["t"],"ё":["§"],"ж":[";"],"з":["p"],"и":["b"],"й":["q"],"к":["r"],"л":["k"],"м":["v"],"н":["y"],"о":["j"],"п":["g"],"р":["h"],"с":["c"],"т":["n"],"у":["e"],"ф":["a"],"х":["["],"ц":["w"],"ч":["x"],"ш":["i"],"щ":["o"],"ъ":["]"],"ы":["s"],"ь":["m"],"э":["'"],"ю":["."],"я":["z"]};var c=[b,a];return{getCyrToLatTransliteration:function(e){var d=[];c.forEach(function(g){var j=[];var k,f;for(var l=0;l<e.length;l++){var n=e.charAt(l).toLowerCase();var m=g[n];if(Array.isArray(m)){if(l){var i=j.slice();j=[];for(var h=0;h<i.length;h++){for(k=0;k<m.length;k++){f=m[k];j.push(i[h]+f);}}}else{j=m.slice();}}}d=d.concat(j);});return d;}};});define("OK/registration/countryDropdown",["doT","OK/utils/dom","OK/registration/translit","OK/utils/debounce"],function(n,c,B,h){var y={};var b={};var v;var H;var C;var e;var m;var z;var j;var G=true;var g=false;var D=n.compile('{{? it.popularCountries.length || it.otherCountries.length}}{{?it.popularCountries.length}}{{?!it.filtered}}<div class="country-select_h">{{=it.locale.popularTitle}}</div>{{?}}{{~it.popularCountries : country}}<div class="country-select_i" data-name="{{=country.countryName}}"><div class="country-select_title ellip">{{=country.countryName}}</div>{{?country.countryCode}}<div class="country-select_code">{{=country.countryCode}}</div>{{?}}</div>{{~}}{{?}}{{?it.popularCountries.length && it.otherCountries.length && !it.filtered}}<div class="country-select_hr"></div>{{?}}{{?it.otherCountries.length}}{{?!it.filtered}}<div class="country-select_h">{{=it.locale.otherTitle}}</div>{{?}}{{~it.otherCountries : country}}<div class="country-select_i" data-name="{{=country.countryName}}"><div class="country-select_title ellip">{{=country.countryName}}</div>{{?country.countryCode}}<div class="country-select_code">{{=country.countryCode}}</div>{{?}}</div>{{~}}{{?}}{{?}}');function l(K){if(y.popularCountries){y.popularCountries.forEach(function(L){L.synonyms=[L.countryName.toLowerCase()];if(K==="ru"){L.synonyms=L.synonyms.concat(B.getCyrToLatTransliteration(L.countryName));}});}if(y.otherCountries){y.otherCountries.forEach(function(L){L.synonyms=[L.countryName.toLowerCase()];if(K==="ru"){L.synonyms=L.synonyms.concat(B.getCyrToLatTransliteration(L.countryName));}});}}function o(O){var Q=O&&O.toLowerCase();var K=null;var M=null;var P=[];var L=[];var N;if(y.popularCountries){y.popularCountries.forEach(function(R){for(N=0;N<R.synonyms.length;N++){if(!O||R.synonyms[N].indexOf(Q)!==-1){if(K===null||R.countryName===b.lastHighlighted){K=P.length;M=R.countryName;}P.push(R);break;}}});}if(y.otherCountries){y.otherCountries.forEach(function(R){for(N=0;N<R.synonyms.length;N++){if(!O||R.synonyms[N].indexOf(Q)!==-1){if(K===null||R.countryName===b.lastHighlighted){K=P.length+L.length;M=R.countryName;}L.push(R);break;}}});}if(K===null){M=b.lastHighlighted;}b={activeElementIndex:K,popularCountries:P,otherCountries:L,filtered:!!O,lastHighlighted:M,locale:{popularTitle:z,otherTitle:j}};}function A(){var Q=D(b);H.innerHTML=Q;v.classList.toggle("form_i__error",!Q);var K=H.getElementsByClassName("country-select_i");if(!K.length||b.activeElementIndex===null){return;}var O=K[b.activeElementIndex];O.classList.add("__active");b.lastHighlighted=O.getAttribute("data-name");var M=O.offsetTop;var N=O.clientHeight;var P=H.scrollTop;var L=H.clientHeight;if(P>M){H.scrollTop=M;}if(M>P+L-N){H.scrollTop=M-L+N;}v.offsetHeight;v.className=v.className;}function r(N,L){if(N===m){return;}m=N;C.value=N;var M;for(M=0;M<e.options.length;M++){if(e.options[M].text===N){e.selectedIndex=M;e.dispatchEvent(new CustomEvent("countryChange"));break;}}if(b){var K=b.popularCountries.length;for(M=0;M<K;M++){if(b.popularCountries[M].countryName===N){b.activeElementIndex=M;break;}}for(M=0;M<b.otherCountries.length;M++){if(b.otherCountries[M].countryName===N){b.activeElementIndex=K+M;break;}}A();}}function q(){return H.classList.contains("__active");}function J(){C.value=m;H.classList.remove("__active");}function F(){H.classList.add("__active");}function a(M){var K=c.parent(M.target,"country-select_i",false,true);if(K){var L=K.getAttribute("data-name");r(L,true);J();C.focus();}}var w=h(100,function(){o(C.value);F();A();});function p(){J();b.lastHighlighted=m;v.classList.remove("form_i__error");}function s(){if(document.activeElement===H){g=true;C.focus();return;}g=false;v.classList.remove("__focus");p();}function f(){v.classList.add("__focus");if(g){return;}o();if(G){F();A();}G=true;}function x(){F();A();}function E(){G=false;}function i(M){switch(M.key){case"Enter":if(q()){M.stopPropagation();M.preventDefault();var L=b.popularCountries.length;var K=b.otherCountries.length;if(b.activeElementIndex!==null&&(L||K)){if(b.activeElementIndex<L){r(b.popularCountries[b.activeElementIndex].countryName,true);}else{r(b.otherCountries[b.activeElementIndex-L].countryName,true);}b.lastHighlighted=m;o();}J();}break;case"Escape":case"Esc":p();break;case"ArrowDown":case"Down":M.preventDefault();M.stopPropagation();if(q()){if(b.activeElementIndex===null){b.activeElementIndex=0;}else{b.activeElementIndex=(b.activeElementIndex+1)%(b.popularCountries.length+b.otherCountries.length);}}else{F();}A();break;case"ArrowUp":case"Up":M.preventDefault();M.stopPropagation();if(q()){if(b.activeElementIndex===null){b.activeElementIndex=b.popularCountries.length+b.otherCountries.length-1;}else{b.activeElementIndex=b.activeElementIndex<1?b.popularCountries.length+b.otherCountries.length-1:b.activeElementIndex-1;}}else{F();}A();break;}}function t(){var M=50;var L=window.pageYOffset+C.getBoundingClientRect().bottom;var K=document.documentElement.scrollHeight-L-M;H.style.maxHeight=K+"px";}function u(){r(e.selectedOptions[0].textContent,false);}function I(K){K.preventDefault();K.stopPropagation();}function k(K){v=K;C=c.firstByClass(K,"js-country-input");e=c.firstByClass(K,"js-country");m=C.value;z=C.getAttribute("data-popular-locale");j=C.getAttribute("data-other-locale");try{y=JSON.parse(C.getAttribute("data-countries"));}catch(L){}l(K.getAttribute("data-locale"));H=document.createElement("div");H.classList.add("country-select");C.parentNode.insertBefore(H,null);t();o();A();C.addEventListener("input",w);C.addEventListener("keydown",i);C.addEventListener("blur",s);C.addEventListener("focus",f);C.addEventListener("click",x);H.addEventListener("click",a);H.addEventListener("mousedown",I);e.addEventListener("prefixChange",u);window.addEventListener("resize",t);window.addEventListener("focus",E);}function d(){C.removeEventListener("input",w);C.removeEventListener("keydown",i);C.removeEventListener("blur",s);C.removeEventListener("focus",f);C.removeEventListener("click",x);H.removeEventListener("click",a);H.removeEventListener("mousedown",I);e.removeEventListener("prefixChange",u);window.removeEventListener("resize",t);window.removeEventListener("focus",E);}return{activate:k,deactivate:d};});define("OK/registration/backhandler",[],function(){function a(b){if(window.history){var c=b.getAttribute("data-stateid");history.pushState(c,null);window.addEventListener("load",function(){setTimeout(function(){window.addEventListener("popstate",function(d){if(d.state!==c){window.location.href="/dk?st.cmd=anonymBackHandler&st.returnState="+c;}});},0);});}}return{activate:function(b){a(b);}};});define("OK/registration/ChangedFieldValidator",[],function(){var b="form_i__error";function c(){}function a(d){return d.type==="radio"?d.checked.toString():d.value;}c.prototype.onChange=function(f){var d=f.target;this.element.classList.toggle(b,a(d)===d.getAttribute("data-initial-value"));};c.prototype.activate=function(e){this.element=e;this.isErrorState=e.classList.contains(b);if(this.isErrorState){var d=Array.prototype.slice.call(e.getElementsByTagName("input"));d.forEach(function(f){f.setAttribute("data-initial-value",a(f));});this.boundOnChange=this.onChange.bind(this);e.addEventListener("input",this.boundOnChange);e.addEventListener("change",this.boundOnChange);}};c.prototype.deactivate=function(d){if(this.isErrorState){d.removeEventListener("input",this.boundOnChange);d.removeEventListener("change",this.boundOnChange);}};return c;});define("b/registration",["OK/registration/Registration","OK/registration/Utils","OK/registration/enterPhone","OK/registration/enterCode","OK/registration/chooseUser","OK/registration/authorize","OK/registration/socialSignIn","OK/registration/socialAuthHandler","OK/registration/cancelSocialReg","OK/registration/acceptPP","OK/registration/enterPhoneNew","OK/registration/enterCodeNew","OK/registration/StatesManager","OK/registration/countryDropdown","OK/registration/translit","OK/registration/backhandler","OK/registration/ChangedFieldValidator"],{});