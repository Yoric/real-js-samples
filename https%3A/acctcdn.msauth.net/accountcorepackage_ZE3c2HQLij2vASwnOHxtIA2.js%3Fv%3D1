!function(){function e(){}function n(n){var t=u.Animations;return!t||e.$forcejQuery||n?!1:t.Enabled||!1}function t(e,n,t){if($B.IE){try{e[0].style.removeAttribute("filter")}catch(i){}}o(e,n,t)}function o(e,n,t){e&&(n?(e.show(),e.css("opacity","1")):(e.css("opacity","0"),e.hide())),t&&t()}function i(e,n,t){setTimeout(function(){o(e,n,t)},0)}function r(){var e=jQuery("#identityBanner");return e&&e.length>0?e:null}function a(){var e,n=document.createElement("div"),t={"animation":"animationend","OAnimation":"oAnimationEnd","MozAnimation":"animationend","WebkitAnimation":"webkitAnimationEnd"};
for(var o in t){if(void 0!==n.style[o]){return e=t[o],t[o]}}return""}function l(n,t){var o=jQuery("#inner");if(o.length>0){if(!n){return void o.removeClass("zero-opacity")}o.hasClass("zero-opacity")?(o.one(e.animationEndEventName,function(){o.removeClass("zero-opacity"),t&&t()}),o.addClass("fade-in-lightbox")):t&&t()}}function s(){var e=!1,n=["Webkit","Moz","O"],t=document.createElement("div");if(e=void 0!==t.style.animationName,!e){for(var o=n.length,i=0;o>i;i++){if(void 0!==t.style[n[i]+"AnimationName"]){e=!0;
break}}}return e}var c=window,u=c.wLive,d=c.$Config.WLXAccount;registerNamespace("wLive.Account"),u.Account.AnimationHelper=e,e.$forcejQuery=!1,e.enabled=!(d.isXbox||d.isWin10||d.isHolo||d.disableAnimations),e.isCSSAnimationSupported=s(),e.convergedAnimationEnabled=d.Animation.showConvergedAnimation&&e.isCSSAnimationSupported,e.animationEndEventName=a(),e.fadeIn=function(r,a,l){e.enabled?n(l)?u.Animations.fadeIn(r).then(function(){o(r,!0,a)}):r.fadeIn(100,function(){t(r,!0,a)}):i(r,!0,a)},e.fadeOut=function(r,a,l){e.enabled?n(l)?u.Animations.fadeOut(r).then(function(){o(r,!1,a)
}):r.fadeOut(100,function(){t(r,!1,a)}):i(r,!1,a)},e.enterContentOnNext=function(n,t,i){if(!e.convergedAnimationEnabled){return d.Animation.showConvergedAnimation&&!e.isCSSAnimationSupported&&l(!1),void e.enterContent(n,t)}var a=null,s=i.animate,c=i.show;n.css("opacity",0),s&&c&&(a=r(),a&&a.css("opacity",0)),n.addClass(c?"pagination-view has-identity-banner":"pagination-view");var u=function(){n.one(e.animationEndEventName,function(){s&&c&&a&&(a.css("opacity",1),a.removeClass("animate slide-in-next")),o(n,!0,t),n.removeClass("animate slide-in-next")
}),setTimeout(function(){s&&c&&a&&a.addClass("animate slide-in-next"),n.addClass("animate slide-in-next")},0)};l(!0,u)},e.enterContentOnBack=function(n,t,i){if(!e.convergedAnimationEnabled){return void e.enterContent(n,t)}var a=null,l=i.animate,s=i.show;n.css("opacity",0),l&&s&&(a=r(),a&&a.css("opacity",0)),n.addClass(s?"pagination-view has-identity-banner":"pagination-view"),n.one(e.animationEndEventName,function(){l&&s&&a&&(a.css("opacity",1),a.removeClass("animate slide-in-back")),o(n,!0,t),n.removeClass("animate slide-in-back")
}),setTimeout(function(){l&&s&&a&&a.addClass("animate slide-in-back"),n.addClass("animate slide-in-back")},0)},e.enterContent=function(r,a,l){if(e.enabled){if(n(l)){u.Animations.enterContent(r).then(function(){o(r,!0,a)})}else{var s="left",c=40;$B&&$B.rtl&&(s="right",c=-40);var d=(r.position(),""),f=r.prop("style");f&&(d=f[s]),r.css(s,"+="+c+"px"),r.css("opacity","0.0");var p={"opacity":"1.0"};p[s]="-="+c+"px",r.animate(p,170,function(){r.css(s,d),t(r,!0,a)})}}else{i(r,!0,a)}},e.exitContentOnBack=function(n,t,i){if(!e.convergedAnimationEnabled){return void e.exitContent(n,t)
}var a=i.animate,l=i.show;if(n.addClass(l?"pagination-view has-identity-banner":"pagination-view"),n.one(e.animationEndEventName,function(){if(a&&l){var e=r();e&&e.removeClass("animate slide-out-back")}o(n,!1,t),n.removeClass("animate slide-out-back")}),a&&l){var s=r();s&&s.addClass("animate slide-out-back")}n.addClass("animate slide-out-back")},e.exitContentOnNext=function(n,t,i){if(!e.convergedAnimationEnabled){return void e.exitContent(n,t)}var a=i.animate,l=i.show;if(n.addClass(l?"pagination-view has-identity-banner":"pagination-view"),n.one(e.animationEndEventName,function(){if(a&&l){var e=r();
e&&e.removeClass("animate slide-out-next")}o(n,!1,t),n.removeClass("animate slide-out-next")}),a&&l){var s=r();s&&s.addClass("animate slide-out-next")}n.addClass("animate slide-out-next")},e.exitContent=function(r,a,l){if($B.IE&&11==$B.V&&(l=!0),e.enabled){if(n(l)){u.Animations.exitContent(r).then(function(){o(r,!1,a)})}else{var s="left",c="-=10px";$B&&$B.rtl&&(s="right",c="+=10px");var d=(r.position(),""),f=r.prop("style");f&&(d=f[s]);var p={"opacity":"0.0"};p[s]=c,r.animate(p,80,function(){r.css(s,d),t(r,!1,a)
})}}else{i(r,!1,a)}},e.addToList=function(r,a,l){e.enabled?n(l)?(r.show(),u.Animations.addToList(r).then(function(){o(r,!0,a)})):r.slideDown(100,function(){t(r,!0,a)}):i(r,!0,a)},e.deleteFromList=function(r,a,l){e.enabled?n(l)?u.Animations.deleteFromList(r).then(function(){o(r,!1,a)}):r.slideUp(100,function(){t(r,!1,a)}):i(r,!1,a)},e.deleteFromListFast=function(r,a,l){e.enabled?n(l)?u.Animations.deleteFromListFast(r).then(function(){o(r,!1,a)}):r.slideUp(50,function(){t(r,!1,a)}):i(r,!1,a)},e.expand=function(r,a,l){e.enabled?n(l)?(r.show(),u.Animations.expand(r).then(function(){o(r,!0,a)
})):r.slideDown(100,function(){t(r,!0,a)}):i(r,!0,a)},e.collapse=function(r,a,l){e.enabled?n(l)?u.Animations.collapse(r).then(function(){o(r,!0,a)}):r.slideUp(100,function(){t(r,!0,a)}):i(r,!0,a)}}(),function(){function e(e,n){if(e){if("undefined"!=typeof n&&n[e]){return GetString("live.accounts.strings."+n[e])}if(k[e]){return GetString("live.accounts.strings."+k[e])}}var t=GetString("live.accounts.strings.error_"+e);return t||(t=GetString("live.accounts.strings."+e)),t||(t=GetString("live.accounts.strings."+w)),t
}function n(e){return"string"==typeof e}function t(e,t,o){return n(e)&&n(t)?o?e.toLowerCase()===t.toLowerCase():e===t:!1}function o(e,n){if(e=(e||"").trim(),n&&""===e){return y}if(e.length>113){return x}var t=new RegExp(m.AltEmailRegEx);return e.match(t)?null:x}function i(e,n){var t=e>=97&&122>=e,o=e>=65&&90>=e;return t&&n||o&&!n}function r(e,n,t){return e=(e||"").trim(),n&&""===e?y:e.length>(t?t:10)?A:null}function a(e,n){return e=(e||"").trim(),n&&""===e?y:e.length>30||e.length<1?A:null}function l(e,n){n&&(e?n.css("opacity",1):n.css("opacity",0))
}function s(e,n){if(e){if(e.indexOf("@")>=0){var t=e.split("@");if(2===t.length){for(var o=t[1].toLowerCase(),i=0,r=n.length;r>i;i++){if(n[i].toLowerCase()===o){return H.Live}}return H.EASI}return H.Unknown}return H.Phone}return H.Unknown}function c(e,n){var t=!1;if(e&&n&&e.indexOf("@")>=0){var o=e.split("@");if(2===o.length){var i=o[1].toLowerCase();n.toLowerCase()===i&&(t=!0)}}return t}function u(e,n){if(e){var t=new RegExp(m.PhoneNumberFormat);if(!e.match(t)){return A}}else{if(n){return y}}return null}function d(){if(h&&h.url&&("undefined"==typeof f.HIPAMFE&&(HIPAMFE={"holder":"hipContent","scriptHolder":"hipScript","done":!1,"showMenu":!0,"showAddAccountOption":!1,"inputWidth":$B.IE&&$B.major<9?200:"100%","cssSet":{"cssCdHIPInput":"form-control input-max-width","cssCdHIPList":"form-control","cssCdHIPError":"alert alert-error","cssCdHIPErrorImg":"hide","cssCdHIPButton":"btn btn-default","cssCdHIPLabel":"text-base"},"createObservable":function(){var e=f.HIPAMFE;
return e.observable={},p.extend(e.observable,g.viewModelHandle),e.observable.hip.suppressMessages(!0),e.observable.hip(""),e.observable},"updateTitle":function(){var e=f.HIPAMFE,n=p("#HipPane");e.type&&("sms"===e.type?(p(".forVisualHip",n).addClass("hide"),p(".forSmsHip",n).removeClass("hide")):(p(".forVisualHip",n).removeClass("hide"),p(".forSmsHip",n).addClass("hide")))},"postLoad":function(){function e(e){return p("label",e).addClass("text-base text-body"),m.isWin10?(p("select",e).addClass("win-dropdown").parent().addClass("template-input inputType_large"),p("input[type=text]",e).addClass("win-textbox").parent().addClass("template-input inputType_large")):m.isWin10InclusiveOOBE?(p("select",e).removeClass().addClass("win-dropdown").parent().addClass("template-input"),p("input[type=text]",e).removeClass().addClass("win-textbox").parent().addClass("template-input")):(p("select",e).addClass("input-max-width").parent().addClass(n).removeAttr("style"),p("input[type=text]",e).removeClass("hiddenHipInputText").addClass("input-max-width").parent().addClass(n).removeAttr("style")),"#hipContent #wlspispHipControlButtonsContainer"===e.selector&&(p("body").hasClass("cb")?p("a",e).addClass("btn btn-block").parent().addClass(n).removeAttr("style"):p("a",e).addClass("btn btn-primary btn-block").parent().addClass(n).removeAttr("style")),e
}var n="form-group col-xs-24 template-input",t="col-xs-12",o=!1;p(".col-md-24").length>0?(n="form-group col-md-24 template-input",t="col-md-12",o=!1):p(".col-xs-18").length>0&&(n="form-group col-xs-18 template-input",t="col-xs-9",o=!0);var i=f.HIPAMFE,r=p("#hipDesc"),a=p("#hipTemplateContainer"),l=(p("#HipPane"),p("#"+i.holder));if(r.length>0&&r.addClass("text-body"),("undefined"===C||0===C)&&a.addClass("text-body"),b&&b.hideContentProgress(),i.updateTitle(),ko.cleanNode(a[0]),"sms"===i.type){var s=p("#pageControlHost input[type=submit]:visible");
g.ftrViewModelHandle?g.ftrViewModelHandle.buttons.nextButton.disabled(!0):s.length>0&&s.attr("disabled","disabled"),o&&p("#hipSection div.col-xs-18").addClass("alert alert-error");var c=e(p("#wlspispHIPErrorContainer",l).removeAttr("style").addClass(n)).detach().attr("data-bind","visible: !hip.suppressMessages() && !hip.isValid()"),u=e(p("#wlspispHipChallengeContainer",l).removeAttr("style")).detach(),d=e(p("#wlspispHipControlButtonsContainer",l).removeAttr("style")).detach().on("click",function(){i&&i.observable&&i.observable.hip.suppressMessages(!0)
}),v=e(p("#wlspispHipSolutionContainer",l)).hide().detach();p(".form-control",v).attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }"),a.html("").append(u).append(d).append(v).append(c),i.createObservable(),i.observable.hip.suppressMessages(!0),ko.applyBindings(i.observable,a[0]);try{var h=g.viewModelHandle;h.phoneNumber&&h.phoneCountry&&i.setPhoneNumber(h.phoneCountry(),h.phoneNumber())}catch(w){}var y=i.getHipDataResponse;i.getHipDataResponse=function(e){y(e),e||(g.ftrViewModelHandle?g.ftrViewModelHandle.buttons.nextButton.disabled(!1):s.length>0&&s.removeAttr("disabled"))
},p('[id^="wlspispHIPPhoneInput"]',u).first().focus()}else{var d=p("<div></div>").addClass("text-body btn-group").addClass(t).append(p("a",l).addClass("btn btn-block captchaHIPLinks").attr("role","button").removeAttr("style").detach()),u=p("<div></div>").addClass(t);if(i.type===E){u.append(p(".cssWLSPHIPAudio",d).parent().detach().removeClass("btn btn-block"))}else{var A=p("img",l).filter(function(){return this.src.indexOf("GetHIPData")>-1}).css("height","auto").css("width","100%").css("max-width","200px");o||A.addClass("text-body"),u.append(A.detach())
}var v=p("<div></div>").addClass("form-group template-input").addClass(n),x=p(".form-control",l);x.attr("name",x.attr("id")),i.type!==E&&0!==$Config.isPlaceholderSupported&&p("body").hasClass("cb")?v.append(x.removeAttr("style").attr("placeholder",HIPAMFE.getInstruction()).attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }").detach()):(v.append(p("<label></label>").addClass("text-base").text(HIPAMFE.getInstruction())),v.append(x.removeAttr("style").attr("data-bind","value: hip, setFocus: hip.focused, css: { 'has-error': !hip.suppressMessages() && !hip.isValid() }").detach()),i.type===E&&setTimeout(function(){x.focus()
},0));var c=p("<div></div>").addClass(n).append(p(".alert-error",l).detach().addClass("floatLeft"));a.html("").append(u).append(d).append(v).append(c),i.createObservable(),ko.applyBindingsWithValidation(i.observable,a[0])}i.observable.hip.serverError&&(i.error=1,i.setError(),i.observable.hip.serverError=null,p.each(p(".alert-error",a),function(e,n){var t=p(n);return"inline"===t.css("display")?(t.css("display","block"),!1):void 0}))}}),f.HIPAMFE&&!f.HIPAMFE.done)){b&&b.showContentProgress();var e=p("#hipScript")[0],n=p("#hipScript script")[0];
if(n){n.src=h.url}else{var t=document.createElement("script");t.type="text/javascript",t.src=h.url,e.appendChild(t)}}}var f=window,p=f.jQuery,v=f.wLive,g=v.Account,m=(v.Core.DataRequest,f.$Config.WLXAccount),h=m.hip,C=m.isConvergedUX,b=g.Util&&g.Util.MarchingAnts,w="error_500",y="errorFieldRequired",A="errorInvalidFormat",x="errorEmailInvalidFormat",H={"EASI":"EASI","Live":"Live","Phone":"Phone","Unknown":"Unknown"},k={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"},E="audio";
registerNamespace("wLive.Account.FieldHelper"),v.Account.FieldHelper.verifyEmailAddress=o,v.Account.FieldHelper.verifyOttCode=r,v.Account.FieldHelper.verifyRecoveryCode=a,v.Account.FieldHelper.strEquals=t,v.Account.FieldHelper.isCapsLockOn=i,v.Account.FieldHelper.toggleInlineLabel=l,v.Account.FieldHelper.getMemberNameType=s,v.Account.FieldHelper.doesDomainMatch=c,v.Account.FieldHelper.verifyPhoneNumber=u,v.Account.FieldHelper.getErrorString=e,v.Account.FieldHelper.loadHip=d,v.Account.FieldHelper.memberNameTypes=H,v.Account.FieldHelper.errors={"required":y,"invalidFormat":A,"emailInvalidFormat":x}
}(),function(){function e(e){if(!e){return o}if("string"!=typeof e||e.length<5||":"!=e.charAt(1)){return f}var n=e.charAt(0);return p[n]?p[n]:o}var n=window,t=n.wLive,o=0,i=1,r=2,a=3,l=4,s=5,c=6,u=7,d=8,f=-1,p={"-":o,"e":i,"a":a,"h":s,"r":r,"v":l,"s":c,"i":u,"c":d};registerNamespace("wLive.Account.TokenHelper"),t.Account.TokenHelper.getTokenType=e,t.Account.TokenHelper.Types={"none":o,"hip":s,"email":i,"reset":r,"authz":a,"recover":l,"acsrInit":u,"acsrSubmit":d,"invalid":f}}(),function(){function e(e,n){var t="&"+n.toLowerCase()+"=",o=e.toLowerCase().indexOf(t);
if(-1==o&&(t="?"+n.toLowerCase()+"=",o=e.toLowerCase().indexOf(t),-1==o)){return null}var i=e.indexOf("&",o+1);return-1==i&&(i=e.length),e.substring(o+t.length,i)}function n(e,n,t){if(!e){return""}var o="&"+n.toLowerCase()+"=",i=e.toLowerCase().indexOf(o);if(-1==i&&(o="?"+n.toLowerCase()+"=",i=e.toLowerCase().indexOf(o),-1==i)){var r="&";return-1==e.indexOf("?")&&(r="?"),e+r+n+"="+t}var a=e.indexOf("&",i+1);return-1==a&&(a=e.length),e.substring(0,i)+o+t+e.substring(a)}function t(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)
})}var o=window,i=o.wLive;registerNamespace("wLive.Account.UrlHelper"),i.Account.UrlHelper.SetQSValue=n,i.Account.UrlHelper.GetQSValue=e,i.Account.UrlHelper.FixedEncodeURIComponent=t}(),function(){function e(){function e(){a.on("unload"+o,function(){i()})}function i(){r.$.triggerHandler(t),a.off(o),a=null,r=null}var r=this,a=jQuery(n);r.$=jQuery(r),e()}var n=window,t="dispose",o=".pageEvents";e.prototype={"next":"onNext","back":"onBack","dispose":t,"setFocus":"setFocus"},registerNamespace("wLive.Account"),wLive.Account.PageEvents=new e
}(),function(){function e(e){function t(){r++}function a(e,n,t,o){function i(){v[e]=setTimeout(function(){t(),delete v[e],o&&g[e]&&(t=g[e],delete g[e],i())},n)}return o&&v[e]?void(g[e]=t):(v[e]&&(clearTimeout(v[e]),delete v[e]),void i())}function l(e){v[e]&&(clearTimeout(v[e]),delete v[e])}var s=this,c=null,u=e,d=o.isXbox,f=!1,p=n.WIZARDUI,v={},g={};s.dispose=function(){f||(c&&(c.empty(),c=null),f=!0)},s.showLoading=function(){a("LoadingIndicatorControl$loading#"+r,500,function(){f||(d?p&&p.notReady&&p.notReady():u&&(u.show(),i&&(c||(c=jQuery(i.createLoading(0,i.loadingType.spinning,"25px","25px")),jQuery(".loadingSpinner",u).append(c)),i.showLoading(c))))
})},s.hideLoading=function(e){l("LoadingIndicatorControl$loading#"+r),f||(d?p&&p.ready&&p.ready({"fKeyboardEnabled":e}):u&&(u.hide(),i&&c&&i.hideLoading(c)))},t()}var n=window,t=n.wLive,o=n.$Config.WLXAccount,i=n.$f,r=0;e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.LoadingIndicatorControl=e}(),function(){function e(e,w,y){function A(){}function x(){var e=Z&&Z.pageTitle;e&&(document.title=e,an&&pn&&pn.setHeaderText&&pn.setHeaderText(e))}function H(){var e=jQuery("#bannerBackButton");
if(e.length>0){var n=Z&&Z.showBannerBackButton;n?(e.show(),k(!0)):(e.hide(),k(!1))}}function k(e){var n=jQuery("#bannerBackButton");n.length>0&&(e?n.removeAttr("disabled"):n.attr("disabled","disabled"))}function E(){var e=Z&&Z.removeLeftNav;e&&(jQuery(".LeftNav").hide(),jQuery("body").removeClass("am_fxlnav"))}function L(){var e=Z.sectionId,n=Z.annotations;if(e&&n){for(var t=jQuery("#"+e,K),o=0,i=n.length;i>o;o++){var r=n[o][0],a=n[o][1];r&&a&&t.attr("data-"+r,a)}}}function I(e){return en&&en[e]?on[e]?on[e]:("string"==typeof en[e]?(on[e]=jQuery("#"+en[e],J),s.trace("PageDialogControl.getButton ["+e+"(#"+en[e]+")] = "+on[e].length)):on[e]=en[e]instanceof jQuery?en[e]:jQuery(),on[e]):jQuery()
}function S(e){k(e),e?(I("action").removeAttr("disabled"),I("alternate").removeAttr("disabled"),I("cancel").removeAttr("disabled")):(I("action").attr("disabled","disabled"),I("alternate").attr("disabled","disabled"),I("cancel").attr("disabled","disabled")),nn=e}function F(e){var n="action",t=jQuery(e.currentTarget).attr("id");if(t==C+ln||t==C+ln+b){for(var o=jQuery(".default:visible",sn),i=o.length,r=0;i>r;r++){var a=jQuery(o[r]).attr("id");if(a==en.action){n="action";break}if(a==en.alternate){n="alternate";
break}if(a==en.cancel){n="cancel";break}if(a==en.skip){n="skip";break}}return T(e,n)}}function T(e,n){if(s.trace("PageDialogControl.buttonClick ["+n+"] enabled:["+nn+"]"),nn){var t=I(n);if(t.length>0&&"disabled"==t.attr("disabled")){return!1}var o=!1;"action"==n&&un&&un.onExternalConfirm?o=un.onExternalConfirm():"cancel"==n&&un&&un.onExternalClose&&(o=un.onExternalClose()),o||q.triggerHandler(c,{"actionName":n,"control":X,"viewModel":un})}return e&&(e.preventDefault(),e.stopPropagation()),!1}function P(e){if(en&&en[e]){var n=I(e);
n.length>0&&(s.trace("PageDialogControl.on(Click) ["+e+"]"),n.on("click"+h+ln,function(n){return T(n,e)}))}r&&$Config.WLXAccount.isWin10InclusiveOOBE&&"cancel"===e&&(y.hasCancel?(r.showBackButton(!0),r.handleBackButton(function(){return T(null,e)})):r.showBackButton(!1))}function N(e){on[e]&&(s.trace("PageDialogControl.clearButton ["+e+"(#"+en[e]+")]"),on[e].off("click"+h+ln),delete on[e])}function B(e){if(on[e]&&on[e].length>0&&"string"==typeof en[e]){var n=jQuery("#"+en[e],J);s.assert(0!=n.length,"Html has been modified and removed the linked ["+e+"] button -- hook the onCreateContent event to alter the HTML"),s.assert(n[0]===on[e][0],"Html has been modified and has replaced the linked ["+e+"] button -- hook the onCreateContent event to alter the HTML")
}}function M(){if(P("action"),P("alternate"),P("revert"),P("cancel"),P("skip"),i&&i.$&&(i.$.on(i.next+h+ln,function(){var e="action";if(Z&&Z.pageNextAction&&(e=Z.pageNextAction),un&&un.wizardUIOnNext){return void un.wizardUIOnNext()}var n=I(e);if(n.length>0){if("disabled"==n.attr("disabled")){return}T(null,e)}else{Z&&Z.pageNextAction&&T(null,e)}}),i.$.on(i.back+h+ln,function(){var e="cancel";if(Z&&Z.pageBackAction&&(e=Z.pageBackAction),un&&un.wizardUIOnBack){return void un.wizardUIOnBack()}var n=I(e);if(n.length>0){if("disabled"==n.attr("disabled")){return
}T(null,e)}else{Z&&Z.pageBackAction&&T(null,e)}})),t.Account.DialogManager){var e=t.Account.DialogManager;e.$.on("action"+h+ln,function(){var e=Z.pageNextAction||"action";T(null,e)}),e.$.on("cancel"+h+ln,function(){var e=!1;un&&un.onExternalClose&&(e=un.onExternalClose()),e||X.dispose()})}sn&&sn.on("submit"+h+ln,F),cn&&cn.on("click"+h+ln,F);var n=Z.viewModel,r=t.Account.ViewModels;if(r&&n&&dn){var a,l={"trigger":function(e){q.triggerHandler(c,{"actionName":e,"control":X,"viewModel":un})}};a="function"==typeof n?n:r[n],un=new a(Y,Z.viewModelOptions,l),t.Account.viewModelHandle=un,o.applyBindingsWithValidation(un,jQuery("#"+dn,K)[0],{"insertMessages":!1,"messagesOnModified":!0})
}q.triggerHandler(f,{"content":J,"control":X,"viewModel":un})}function $(){i&&i.$&&i.$.off(h+ln),t.Account.DialogManager&&t.Account.DialogManager.$.off(h+ln),q.triggerHandler(p,{"content":J,"control":X}),N("action"),N("alternate"),N("revert"),N("cancel"),N("skip"),sn&&sn.off("submit"+h+ln),cn&&cn.off("click"+h+ln)}function j(){if(B("action"),B("alternate"),B("revert"),B("cancel"),B("skip"),sn&&sn.length>0){var e=J;J!==sn&&(e=jQuery("#"+C+ln,J)),s.assert(0!=e.length,"AutoForm has been removed -- hook the onCreateContent event to alter the HTML"),s.assert(sn[0]===e[0],"AutoForm has been modified and has replaced -- hook the onCreateContent event to alter the HTML")
}if(cn&&cn.length>0){var n=jQuery("input[type=submit]",J);s.assert(0!=n.length,"AutoFormSubmit button has been removed -- hook the onCreateContent event to alter the HTML"),s.assert(cn[0]===n[0],"AutoFormSubmit button has been modified and has replaced -- hook the onCreateContent event to alter the HTML")}}function Q(e,n){for(var t=n.split("."),o=t.length,i=0;o>i&&null!==e&&void 0!==e;){e=e[t[i++]]}return e}function O(e,n,t){return e.indexOf(n)>-1&&(e=e.replace(n,t)),e}function D(e){return Z.getViewContextTokenValue?Z.getViewContextTokenValue(Y,e):Q(Y,e)
}function U(e){if(!tn){return!1}var n=jQuery("form",e);if(n.length>0){return!1}var t=jQuery(":input",e);return 0==t.length?!1:!0}function W(e){if(U(e)){if(sn=jQuery("<form id='"+C+ln+"' action='#' onsubmit='return false;' novalidate='novalidate' "+R()+"></form>"),sn.append(e),0==jQuery("input[type=submit]",e).length){var n=jQuery("<input aria-hidden='true' id='"+C+ln+b+"' type='submit' tabindex='-1' style='position: absolute; height: 0px; width: 0px; border: none; padding: 0px; min-width: 0px; min-height: 0px;' />");
sn.append(n)}return cn=jQuery("input[type=submit]",e),sn}return e}function R(){var e="";return a.supportsUnifiedHeader&&(e=Z&&Z.pageTitle?"aria-label='"+Z.pageTitle+"'":"aria-labelledby='iPageTitle DialogUserTitle'"),e}function V(){var e=jQuery(Z.viewTemplate).clone(),n=Z.viewContextTokens;if(n&&n.length>0){for(var t=e.html(),o=0;o<n.length;o++){var i=n[o],a=D(i);void 0!==a&&null!==a&&(t=O(t,"{"+i+"}",jQuery("<span />").text(a).html()))}e.html(t)}return r&&($Config.WLXAccount.isWin10||$Config.WLXAccount.isHolo)&&r.getContext(function(n){var t=n.host?n.host.toUpperCase():"",o=t===r.Hosts.OOBE||t===r.Hosts.NthUserFirstLogon||t===r.Hosts.SSCRPINReset;
jQuery(".icon-win-easeOfAccess",e).toggle(o)}),q.triggerHandler(v,{"content":e,"control":X}),W(e)}function _(){Z.focusFirstButton?setTimeout(function(){J.find(":button").first().focus()},10):Z.focusFirstInput?setTimeout(function(){var e=jQuery("input,select",J).not(":hidden").first();0==e.length&&(e=jQuery("a,button,input[type=button]",J).not(":hidden").first()),e.focus()},fn?255:10):Z.focusSubmit?setTimeout(function(){J.find("input[type=submit]").not(":hidden").first().focus()},10):Z.focusFirstElemId?setTimeout(function(){jQuery("#"+Z.focusElemId,J).first().focus()
},10):Z.disableAutoFocus||setTimeout(function(){var e=jQuery("[autofocus],[autofocus=autofocus],[autofocus=true]",J).first();0==e.length&&(e=jQuery("input,button,a,select,textarea",J).first()),e.focus()},fn?255:10)}var X=this,q=X.$=jQuery(X),z=!1,G=!1,K=e,Z=y,J=null,Y=w,en=y.buttons,nn=!0,tn=y.autoForm!==!1&&0!==y.autoForm&&"False"!==y.autoForm,on={},rn=a.isWinWab,an=a.isWinWiz,ln=(a.isXbox,a.isWPBlue,m++),sn=null,cn=null,un=null,dn=y.sectionId,fn=l.convergedAnimationEnabled,pn=n.WIZARDUI;X.notifyVisible=function(){un&&un.onNotifyVisible&&un.onNotifyVisible()
},X.content=function(){return J},X.show=function(){s.trace("PageDialogControl.show()"),J||(J=V()),G||(K.append(J),G=!0),L(),x(),H(),M(),J.show(),rn&&(jQuery("form").parents("div").css("height","100%"),"undefined"!=typeof setContentWidth&&setContentWidth()),q.triggerHandler(u,{"content":J,"control":X}),_(),E(),j(),s.trace("PageDialogControl.~show()")},X.hide=function(){s.trace("PageDialogControl.hide()"),J.hide(),q.triggerHandler(d,{"content":J,"control":X}),$(),J.detach(),G=!1},X.setEnabled=function(e){s.trace("PageDialogControl.setEnabled("+e+")"),S(e)
},X.getButton=I,X.dispose=function(){s.trace("PageDialogControl.dispose()"),z||(q.triggerHandler(g,{"control":X}),$(),J.empty(),G&&J.remove(),J=null,z=!0,X.$=null),X=null,q=null,en=null,on=null,K=null,Z=null,w=null,y=null},A()}var n=window,t=n.wLive,o=n.ko,i=t.Account.PageEvents,r=n.MSA&&n.MSA.CXH,a=n.$Config.WLXAccount,l=t.Account.AnimationHelper,s=n.$Debug,c="onAction",u="onShow",d="onHide",f="onSetupEvents",p="onRemoveEvents",v="onCreateContent",g="onDispose",m=0,h=".pagedialog",C="pageDialogForm_",b="_submit";
e.prototype.events={"action":c,"createContent":v,"show":u,"hide":d,"setupEvents":f,"removeEvents":p,"dispose":g},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.PageDialogControl=e}(),function(){function e(e,t,w){function y(){}function A(e){var n,t=X[e];return n=o(t.template?t.template:w.defaultTemplate?w.defaultTemplate:"<div></div>"),n.hide(),n}function x(e,n){var t,o=X[n];return new(t="function"==typeof o.control?o.control:r[o.control])(e,_,o.options)}function H(e,n){l.trace("FlowController.notifyVisible ["+n+"]"),!Q&&e&&e[C]&&e[C](),E(e,!0),j.triggerHandler(c,{"controller":$,"control":e,"state":n,"viewContext":_})
}function k(e,n,t,i){if(i[h]&&!i[h](e)){return null}if(o.isFunction(t)){return t()}if(z[b]){var r=z[b](n,t,_,e);if(r){if(o.isArray(t)){for(var a=0;a<t.length;a++){if(t[a]===r){return r}}}else{if(r===t){return r}}}return null}return t}function E(e,n){e&&e[m]&&e[m](n)}function L(e,t,r,a,s,c,u){if(!Q&&U===e){O.append(e),R=o(t),l.trace("Hooking control events for ["+r+"]");var d=t.events;for(var f in d){var p=d[f];R.on(p,{"eventName":p,"state":r,"control":t},B)}R.on(t.events.action,{"state":r,"control":t},M),V=e,e.show(),t.show();
var g=function(){if(e.show(),W===t&&H(t,r),a.pageId){var o={"pageId":a.pageId,"userAction":a.userAction};if($ReportEvent.SetCustomPageLoadCompletedTime((new Date).getTime()),$ReportEvent.PageLoadCompleted(),$ReportEvent.Fire(o),"undefined"!=typeof UserTracker&&"function"==typeof UserTracker.notifyDOMUpdate){try{UserTracker.notifyDOMUpdate()}catch(i){}}n.$Config.hpgid=a.pageId}};if(s){var m=a.options&&1===a.options.showIdentityBanner,h={"animate":u,"show":m};c?i.enterContentOnBack(e,g,h):i.enterContentOnNext(e,g,h)
}else{g()}j.triggerHandler(v,{"controller":$,"activeState":r,"control":t,"container":e,"viewContext":_})}}function I(){G=[]}function S(e,n){if(!e.skipBackStack){if(G.length>0&&G[0]!=n){for(var t=0;t<G.length;t++){if(G[t]==n){G=G.slice(0,t);break}}}G.push(n)}}function F(e){if(G.length>0){for(var n=G.length-1;n>=0;n--){if(G[n]==e){G=G.slice(0,n);break}}}}function T(e,n){if(G.length>0){l.trace("FlowController.getBackState("+e+", "+n+") -- "+G);for(var t=G.length-1;t>=0;t--){var i=G[t];if(i!=e&&i){if(o.isArray(n)){for(var r=0;r<n.length;r++){if(n[r]==i){return i
}}}else{if(i==n){return i}}}}}return null}function P(e,n,t){if(!Q){if(l.trace("FlowController.showControl("+e+")"),D!=e&&X[e]){l.trace("New State ["+e+"] from ["+D+"]"),j.triggerHandler(p,{"control":$,"activeState":D,"newState":e,"viewContext":_});var r=X[e],s=r.url,c=r.target,d=r.cancelUrl,v=r.triggerAction;if(s){return l.trace("Navigate to ["+s+"]"),j.triggerHandler(f,{"control":$,"url":s,"viewContext":_}),void(d?((K||Z)&&a?a.openExternalWebBrowser(s):c&&$Utility.navigateTo(s,c),$Utility.navigateTo(d)):$Utility.navigateTo(s))
}if(v){return l.trace("Trigger action ["+v+"]"),void j.triggerHandler(u,{"actionName":v,"control":$})}var g=U,m=W,h=R,C=D,b=A(e),w=x(b,e);if(U=b,W=w,R=null,h&&(l.trace("Clearing action event for ["+C+"]"),h.off(m.events.action,M)),m&&m.prepareDispose&&m.prepareDispose(),D=e,r.clearBackStack&&I(),S(r,D),g&&V===g){var y=X[C].options.showIdentityBanner!==r.options.showIdentityBanner,H=function(){if(g.hide(),m){m.hide&&m.hide(),l.trace("Clearing control hooked events ["+C+"]");var n=o(m);for(var i in w.events){n.off(i,B)
}n=null,m.dispose(),delete m}g.empty(),g.remove(),g=null,delete g,L(b,w,e,r,!0,t,y)},k=X[C].options&&1===X[C].options.showIdentityBanner,F={"animate":y,"show":k};t?i.exitContentOnBack(g,H,F):i.exitContentOnNext(g,H,F)}else{var T=!0;n&&q.animateInitial===!1&&(T=!1),L(b,w,e,r,T,t,n)}}else{l.assert(X[e],"Undefined state ["+e+"] -- re-enabling existing control"),D==e&&l.trace("Same state re-enabling the control ["+e+"]"),E(W,!0)}}}function N(e,n){return{"controller":$,"state":e.state,"control":e.control,"controlData":n,"viewContext":_}
}function B(e,n){var t=e.data;l.trace("FlowController.handleControlEvent ["+t.eventName+"] for ["+t.state+"]");var o=N(t,n);return j.triggerHandler(t.eventName+"$Control",o),!0}function M(e,n){var t=n.actionName,i=n.control,r=e.data,a=r.state,s=X[a].actions,c=s[t],u=!1;if(("cancel"==t||"backStack"==t)&&(u=!0),l.trace("FlowController.processActionEvent["+t+"] for ["+a+"]"),l.assert(a==D,"processAction state mismatch ev:["+a+"] act:["+D+"]"),a==D){var d=!1;if("backStack"==t){var f=T(a,c);f&&(c=f,d=!0)}c=k(t,a,c,i);
var p=c;if(c&&o.isArray(c)&&(p=c[0]),l.trace("FlowController.processActionEvent newState ["+p+"]"),p){if(X[p]){return d&&F(p),E(i,!1),P(p,!1,u),!0}l.fail("Invalid State ["+p+"] from ["+a+"] action ["+t+"]")}}return P(D,!1,u),!1}var $=this,j=$.$=o($),Q=!1,O=o(e),D=s,U=null,W=null,R=null,V=null,_=t,X=w.viewDefs,q=w,z=w.callbacks||{},G=[],K=n.$Config.WLXAccount.isWin10,Z=n.$Config.WLXAccount.isHolo;$.show=function(e){P(e,!0),j.triggerHandler(d,{"control":$,"viewContext":_})},$.setStateChangeFunc=function(e){z[b]=e
},$.dispose=function(){if(!Q){if(D=s,W){if(null!=R){l.trace("Clearing control events ["+D+"]"),R.off(W.events.action,M);for(var e in W.events){R.off(e,B)}R=null}W.dispose()}W=null,U&&U.empty(),U=null,j.triggerHandler(g,{"control":$,"viewContext":_}),Q=!0,$.$=null}j=null,$=null,Q=!0,O&&O.empty(),O=null,_=null,X=null,q=null},y()}var n=window,t=n.wLive,o=n.jQuery,i=t.Account.AnimationHelper,r=t.Account.Controls,a=n.MSA&&n.MSA.CXH,l=n.$Debug,s="none",c="onControlVisible",u="onAction",d="onShow",f="onNavigate",p="onStateChanging",v="onStateChanged",g="onDispose",m="setEnabled",h="validate",C="notifyVisible",b="validateStateChange";
e.prototype.events={"action":u,"show":d,"stateChanged":v,"stateChanging":p,"controlVisible":c,"dispose":g},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.FlowController=e}(),function(){function e(e,l){function s(){if(g&&m&&m.length>0){if(g.hasClass(n)){var e=t+w;g.on("input"+e,p).on("keypress"+e,p).on("keyup"+e,p).on("paste"+e,f).on("contextmenu"+e,p),m.on("click"+e,d)}p()}}function c(){if(!b){var e=t+w;m&&m.off(e),g&&g.off(e),g=null,m=null,h=null,C=null,v=null,b=!0}}function u(e){!b&&m&&m.length>0&&(null==C||C!=e)&&(C=e,e?m.show():m.hide(),h[i]&&h[i](e,h.context))
}function d(e){b||(3==e.which?u(!1):setTimeout(function(){!b&&g&&(g.focus(),h[r]&&h[r](g,h.context))},0))}function f(e){b||setTimeout(function(){b||p(e),e=null},0)}function p(){!b&&g&&u(!g.val())}var v=this,g=jQuery(e),m=g.next(o),h=l||{},C=null,b=!1,w=a++;v.update=u,v.dispose=c,s()}var n="placeholder",t=".placeholder",o=".placeholder",i="onVisible",r="onFocus",a=0;registerNamespace("wLive.Account.Field"),wLive.Account.Field.PlaceholderControl=e}(),function(){function e(e,n,t){function r(e){for(var n=0;n<i.length;n++){if(e==i[n]){return!0
}}return!1}function a(e){var n=c.val(),t=n.length;if(t>s&&(c.value=n.substring(0,s)),t>=s&&!r(e.which)&&e.preventDefault(),u){var o=Math.max(s-c.val().length,0);u.text(o)}}var l=this,s=e,c=n,u=t;s>0&&(c.attr("maxlength",s),c.bind("keypress"+o,a),c.bind("keydown"+o,a),c.bind("keyup"+o,a)),l.dispose=function(){c.unbind(o),c=null,u=null}}var n=window,t=n.wLive,o=".enforceMaxLength",i=[8,9,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,91,92,93,144,145,112,113,114,115,116,117,118,119,120,121,122,123];registerNamespace("wLive.Account.Field"),t.Account.Field.MaxLengthEnforcer=e
}(),function(){function e(e,n,t){function o(){}var i=this,r=(i.$=jQuery(i),t),a=n,l=a.data,s=r.params;i.show=function(){for(var n=jQuery(r.viewTemplate).clone(),t=r.formId,o=jQuery("#"+t,n),i=0,a=s.length;a>i;i++){var c=s[i];jQuery("#"+c,o).val(l[c])}e.append(n),document.forms[t].submit()},o()}var n=window,t=n.wLive,o="onShow";e.prototype.events={"show":o},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.RedirectionControl=e}(),function(){function e(e,n,t){function r(){}function c(e){if(e&&A[e]){return GetString("live.accounts.strings."+A[e])
}var n=GetString(b+e);return n||(n=GetString("live.accounts.strings."+e)),n||(n=GetString("live.accounts.strings."+w)),n}function x(){return{"control":T,"viewContext":M,"pollAttempts":q,"numErrors":X}}function H(e){if(!N){G&&(clearTimeout(G),G=null);var n=(new Date).getTime();if(X>=$||n>z){_&&_.hideLoading(),P.triggerHandler(p,x())}else{if(e){var t=x();t.sendPollingRequest=!0,P.triggerHandler(u,t),t.sendPollingRequest&&(G=setTimeout(L,O))}else{Q?G=setTimeout(L,O):(_&&_.hideLoading(),P.triggerHandler(f,x()))}}}}function k(){if(!N){var e=0,n=0;
null!=Z&&(e=Z.height(),n=Z.width()),2==e?(_&&_.hideLoading(),1==n?P.triggerHandler(v,x()):P.triggerHandler(g,x())):(1!=n&&X++,H(!1)),null!=Z&&(Z.empty(),Z.remove(),Z=null)}}function E(){N||(X++,H(!1),null!=Z&&(Z.empty(),Z.remove(),Z=null))}function L(){if(!N){G=null;var e=(new Date).getTime();null!=Z&&(Z.empty(),Z=null),Z=i("<img />").attr({"id":"iSessionPollingImg","style":"display: none"}),Z.load(k),Z.error(E);var n="?slk";D.indexOf("?")>-1&&(n="&slk="),Z.attr("src",D+n+encodeURIComponent(K)+"&pa="+encodeURIComponent(e)),i("body").append(Z),q++,P.triggerHandler(d,x())
}}function I(e){N||(K=e.sessionLookupKey,M&&(M.sessionLookupKey=K),P.triggerHandler(m,x()),H(!0))}function S(e){if(!N){if(K=null,M&&delete M.sessionLookupKey,e.error&&e.error.code==y){return void P.triggerHandler(v,x())}M.pollingError=errorMessage=c(String(e.error.code)),P.triggerHandler(h,x()),W&&H(!0)}}function F(){if(!N){var n=(new Date).getTime();if(z=n+j,X=0,q=0,R){var t=i(".loadingArea",e);0==t.length&&(t=i(".waitingArea",e)),_=new s.LoadingIndicatorControl(t),_.showLoading()}if(V){var r={"channel":"PushNotifications","purpose":U},a=new o.DataRequest(null,l.sendOtt,r,I,S,1e4);
a.start()}else{H(!0)}}}var T=this,P=T.$=i(T),N=!1,B=t,M=n||{},$=B.maxErrors||a.polling.maxErrors,j=B.timeout||a.polling.timeout,Q=void 0!==a.polling.enabled?a.polling.enabled:!0,O=Q?B.pollInterval||a.polling.interval:0,D=B.approvalUrl||a.url,U=B.ottPurpose||a.ottPurpose,W=void 0!==B.pollOnSendError?B.pollOnSendError:!0,R=void 0!==B.showLoading?B.showLoading:!0,V=void 0!==B.sendNotification?B.sendNotification:!0,_=null,X=0,q=0,z=null,G=null,K=a.lookupKey,Z=null;T.forcePollRequest=function(){H(!0)},T.show=function(){F()
},T.dispose=function(){if(!N){if(P.triggerHandler(C,x()),G&&(clearTimeout(G),G=null),_&&_.dispose(),_=null,null!=Z&&(Z.empty(),Z.remove(),Z=null),T&&T.$){for(var e in T.events){T.$.off(e)}P=T.$=null}T=null,B=null,M=null,$=null,j=null,Q=null,O=null,D=null,U=null,W=!1,R=!1,z=null,K=null,N=!0}},r()}var n=window,t=n.wLive,o=t.Core,i=n.jQuery,r=n.$Config.WLXAccount,a=r.sessionApproval,l=r.urls.dataRequest,s=t.Account.Controls,c="onShow",u="onStartPolling",d="onPolling",f="onPending",p="onTimeout",v="onApproved",g="onDenied",m="onSendSuccess",h="onSendError",C="onDisposing",b="live.accounts.strings.error_",w="pollingdefaulterror",y="1306",A={"errorFieldRequired":"error_1018","errorEmailInvalidFormat":"error_1035","errorEmailExists":"error_1287"};
e.prototype.events={"show":c,"startPolling":u,"polling":d,"pending":f,"timeout":p,"approved":v,"denied":g,"sendSuccess":m,"sendError":h,"disposing":C},e.__class=!0,registerNamespace("wLive.Account.Controls"),t.Account.Controls.SessionPolling=e}(),function(e){var n;!function(e){var n;!function(e){e.ActionNames={"Action":"action","Back":"back","Cancel":"cancel","Alternate":"alternate"},e.ErrorCodes={"Default":"Error_1086","IncorrectPassword":"1002"}}(n=e.Constants||(e.Constants={}))}(n=e.Account||(e.Account={}))
}(wLive||(wLive={}));