/*! Team:2014-03-17 8:20:15 PM */
!function(e){function t(e){e=c({},e||{},this.config),e.isAuto=!1;var t,r;try{if((r=e.globalParam)&&d(r))for(var n in r)if(t=r[n],"string"==typeof t)t in b&&(r[n]=b[t]()),/\s*cookie-(\w+)\s*/gi.test(t)&&(r[n]=a(RegExp.$1||""));else{if(s(t))continue;f(t)&&(r[n]=t[0])}this.delegateHref(e.pingback_container,e)}catch(i){}}function r(t,r){var n=this,i=function(t){t=o.getEvent(t);var i,a,c=o.getTarget(t),u=!1,s=r.type,p=l[s];try{if("string"==typeof r.delegatePattern){for(;c&&!(u="a"===c.nodeName.toLowerCase()&&c.getAttribute&&(a=c.getAttribute(r.delegatePattern)));)c=c.parentNode;if(!u)return;r.urlTempl=a,i=n.processHrefUrl(r,c);for(var f=0;f<i.length;f++)p(i[f])}}catch(d){e.console&&console.log(d.stack)}};if(t)o.addEventListener(t,r.actionType,i);else var a=setInterval(function(){return document.body?(clearInterval(a),o.addEventListener(document.body,r.actionType,i),void 0):!1},25);return r}function n(e,t){for(var r,n,i,o,c,u=e.urlTempl.split("$$"),p=[],d=[],l=e.customParam,m=0,g=u.length;g>m;m++){if(e.customParam){if(u[m]in l&&(c=[],i=l[u[m]],r=i.url)){for(var v in i)"url"!=v&&(o=i[v],"string"==typeof o?(o in b&&c.push(v+"="+b[o]()),/\s*cookie-(\w+)\s*/gi.test(o)&&c.push(v+"="+a(RegExp.$1||""))):s(o)?c.push(v+"="+o(e,t)):f(o)&&c.push(v+"="+o[0]));r+="?"+c.join("&")}}else if(r=u[m].replace(/\{[^\}]+\}/g,function(r){var n=r.replace(/(^\{\s*)|(\s*\}$)/g,"");return n in b?b[n]():/\s*cookie-(\w+)\s*/gi.test(n)?a(RegExp.$1||""):n in e.processFunc?e.processFunc[n](e,t):""}),n=e.globalParam){var o;for(var h in n)s(o=n[h])?d.push(h+"="+o(e,t)):d.push(h+"="+o);r+=-1===r.indexOf("?")?"?":"&",r+=d.join("&")}p.push(r)}return p}function i(e){e=c({tag:"a",plus:"pb-plus",minus:"pb-minus"},e||{},this.config);var t=this,r=function(r){function n(){for(var t=a,r=!1;t&&!(r=(t.nodeName.toLowerCase()===e.tag||t.getAttributeNode&&t.getAttributeNode(e.plus))&&!(t.getAttributeNode&&t.getAttributeNode(e.minus)));)t=t.parentNode;return r?t:void 0}r=o.getEvent(r);var i,a=o.getTarget(r),c=!1,u=e.type,s=l[u];if(a=n()){for(var p;a&&!(c=a.getAttribute&&(p=a.getAttribute(e.delegatePattern)));)a=a.parentNode;if(!c)return;e.urlTempl=p;try{i=t.processHrefUrl(e,a)}catch(f){}for(var d=0;d<i.length;d++)s(i[d])}},n=setInterval(function(){return document.body?(clearInterval(n),o.addEventListener(document.body,e.actionType,r),void 0):!1},25);return e}var o={addEventListener:function(e,t,r){e&&t&&r&&(e.addEventListener?e.addEventListener(t,r):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r)},removeEventListener:function(e,t,r){e&&t&&r&&(e.removeEventListener?e.removeEventListener(t,r):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=null)},getEvent:function(t){return t?t:e.event},getTarget:function(e){return e.target||e.srcElement}},a=function(e,t,r){if("undefined"==typeof t){var n=new RegExp("(?:^|; )"+e+"=([^;]*)").exec(document.cookie);return n?n[1]||"":""}r=r||{},null===t&&(t="",r.expires=-1);var i="";if(r.expires&&("number"==typeof r.expires||r.expires.toUTCString)){var o;"number"==typeof r.expires?(o=new Date,o.setTime(o.getTime()+24*r.expires*60*60*1e3)):o=r.expires,i="; expires="+o.toUTCString()}var a=r.path?"; path="+r.path:"",c=r.domain?"; domain="+r.domain:"",u=r.secure?"; secure":"";document.cookie=[e,"=",t,i,a,c,u].join("")},c=function(e,t,r){if(r&&c(e,r),e&&t)for(var n in t)e[n]=t[n];return e},u=Object.prototype.toString,s=function(e){return e&&"[object Function]"===u.call(e)},p=function(e){return e&&"[object String]"===u.call(e)},f=function(e){return e&&"[object Array]"===u.call(e)},d=function(e){return e&&"[object Object]"===u.call(e)},l={iframe:function(e){var t=document.createElement("iframe");t.src=e,t.width=1,t.height=1,t.style.display="none",document.getElementsByTagName("body")[0].appendChild(t)},img:function(e){var t=new Image;t.onload=t.onerror=t.onabort=function(){t=null},t.src=e}},m={replaceStamp:function(e){return(e||"").replace(/({\s*stamp\s*})/gi,function(){return(new Date).getTime()})},replaceRandom:function(e){return(e||"").replace(/({\s*random\s*})/gi,function(){return 1e13*Math.random()})},replaceLocation:function(t){return(t||"").replace(/({\s*location\s*})/gi,function(){return escape(e.location.href)})},replaceCookie:function(e){return(e||"").replace(/({\s*cookie-(\w+)\s*})/gi,function(e,t,r){return a(r||"")})},replaceRefer:function(e){return(e||"").replace(/({\s*refer\s*})/gi,function(){return escape(document.referrer)})}},g={url:function(){return escape(location.href)},refer:function(){return escape(document.referrer)},fuid:function(){return a("fuid")},yyid:function(){return a("YYID")},sid:function(){return a("SUV")},idBridge:function(e,t,r,n){var i=n[n.attr][t.index];if(!t.pingbackTime)return this["ref"+e]();switch(e){case"vid":return i.id;case"pid":return i.playlistId;case"cid":return i.cid}},vid:function(e,t,r){return this.idBridge("vid",e,t,r)},pid:function(e,t,r){return this.idBridge("pid",e,t,r)},cid:function(e,t,r){return this.idBridge("cid",e,t,r)},refvid:function(){return e.vid},refpid:function(){return e.playlistId},refcid:function(){return e.cid},msg:function(e){return e.pingbackTime?"click":"impression"},formwork:function(e){return e.formTypeMap[e.formType]},rec:function(e,t,r){return r.callback},alg:function(e,t,r){return r[r.attr][e.index].r},ab:function(e,t,r){var n=r[r.attr][e.index];return e.pingbackTime?n.ab:r.pingback_ab},index:function(e){return e.index},uuid:function(){var t;return t=e.pingback_uuid?e.pingback_uuid:e.pingback_uuid=(new Date).getTime()},passport:function(){return sohuHD&&sohuHD.passport?sohuHD.passport.getPassport():void 0},Lb:function(){return a("pagelianbo")},type:function(e,t,r){return e.pageTypeMap[r.pingback_type]},v:function(){return"maybelike_"+e.cid+"_v20130829"},checkForm:function(e){if(e.checkForm)return e.checkForm;for(var t,r,n=e;e&&"ul"!=e.nodeName.toLowerCase();)e=e.parentNode;for(e=e.parentNode.previousSibling;e&&1!=e.nodeType;)e=e.previousSibling;return t=e.innerHTML,t.indexOf("\u4f60\u6216\u8bb8\u559c\u6b22")>0?r=20:t.indexOf("\u76f8\u5173\u63a8\u8350")>0?r=21:t.indexOf("\u731c\u4f60\u559c\u6b22")>0&&(r=22),n.checkForm=r,r}},v={},h={dataMap:{},config:{pageTypeMap:{play:100,album:200,base:300},formTypeMap:{a:20,b:21,c:22,h:100},pingbackTime:0,isAuto:!0,clickParamMap:{url:1,refer:1,fuid:1,yyid:1,passport:1,sid:1,vid:1,pid:1,cid:1,refvid:1,refpid:1,refcid:1,msg:1,formwork:1,alg:1,ab:1,Lb:1,v:1,index:1,uuid:1,type:1},impressParamMap:{url:1,refer:1,fuid:1,yyid:1,passport:1,sid:1,vid:1,pid:1,cid:1,msg:1,formwork:1,rec:1,ab:1,Lb:1,v:1,uuid:1,type:1},targetUrl:["http://click.hd.sohu.com.cn/r.gif","http://ctr.hd.sohu.com/ctr.gif"],type:"img",delegatePattern:"pb-url",actionType:"click",processUrl:function(e,t,r){e=e||"";for(var n in m)s(m[n])&&(e=m[n](e,t,r));return e},newProcessUrl:function(e,t,r){var n,i,o=[],a=[],c=(new Date).getTime();if(e.pingbackTime){for(var u in e.clickParamMap)"function"==typeof e.clickParamMap[u]?n=e.clickParamMap[u](e,t,r):(i=g[u])&&(n=i.call(g,e,t,r),"undefined"==typeof n&&(n="")),o.push(u+"="+n);for(var s=0;s<e.targetUrl.length;s++)a.push(e.targetUrl[s]+"?"+o.join("&")+"&_="+c)}else{for(var u in e.impressParamMap)"function"==typeof e.impressParamMap[u]?n=e.impressParamMap[u](e,t,r):(i=g[u])&&(n=i.call(g,e,t,r),"undefined"==typeof n&&(n="")),o.push(u+"="+n);for(var s=0;s<e.targetUrl.length;s++)a.push(e.targetUrl[s]+"?"+o.join("&")+"&_="+c)}return a}},init:function(e,t,r){v=c({},r||{},this.config),"undefined"!=typeof r&&r.overwrite_url_map&&("undefined"!=typeof r.common_map&&(c(v.clickParamMap,r.common_map),c(v.impressParamMap,r.common_map)),"undefined"!=typeof r.click_map&&c(v.clickParamMap,r.click_map),"undefined"!=typeof v.impress_map&&c(v.impressParamMap,r.impress_map));var n=l[v.type];v.pingbackTime=0,v.formType=e,this.dataMap[e]=t,this.delegate(t.pingback_container,v,t);try{urls=v.newProcessUrl(v,null,t);for(var i=0;i<urls.length;i++)n(urls[i])}catch(o){}},pushProcessURLFn:function(){var e=[].slice.call(arguments);2==e.length&&p(e[0])?m[e[0]]=e[1]:"1"==e.length&&"object"==typeof e[0]&&c(m,e[0])},checkIndex:function(e){if(e.checkIndex)return e.checkIndex;for(var t=0,r=e;e&&"li"!=e.nodeName.toLowerCase();)e=e.parentNode;for(;e&&e.previousSibling;)e=e.previousSibling,t++;return r.checkIndex=t,t},delegate:function(e,t,r){var n=this,i=function(e){e=o.getEvent(e);var i,a=o.getTarget(e),c=!1,u=t.type,s=l[u];try{for(;a&&!(c="a"==a.nodeName.toLowerCase());)a=a.parentNode;if(!c||a.getAttribute("disable-pingback"))return;t.pingbackTime=1,t.index=a.getAttribute("index")||n.checkIndex(a),i=t.newProcessUrl(t,a,r);for(var p=0;p<i.length;p++)s(i[p])}catch(f){console&&console.log(f.stack)}};return o.addEventListener(e,t.actionType,i),t},removeDelegate:function(e){e=e||{},e.container&&e.actionType&&e.handler&&o.removeEventListener(e.container,e.actionType,e.handler)},switchPbType:function(e){e=e||"impress",v.pingbackTime="impress"==e?0:1},ping:function(){for(var e=v.newProcessUrl(v,null,this.dataMap[v.formType]),t=0;t<e.length;t++)l[v.type](e[t])}};e.pingbackBundle=h;var b={stamp:function(){return(new Date).getTime()},staticstamp:function(){if(this.stampNum)return this.stampNum;var e=this.stampNum=(new Date).getTime();return e},url:function(){return escape(location.href)},refer:function(){return escape(document.referrer)},passport:function(){return sohuHD&&sohuHD.passport?sohuHD.passport.getPassport():void 0},random:function(){return 1e13*Math.random()}};h.initHref=t,h.delegateHref=r,h.processHrefUrl=n,h.initBlock=i}(window);