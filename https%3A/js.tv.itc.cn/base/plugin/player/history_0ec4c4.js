/* sohutv 2018-09-10 10:28:11 */
window.getVrsPlayerHistory=function(e,t,i,s,n){function a(e,t,i){t=parseInt(t);var s={vid:e,sid:t,t:parseInt(i)},n=[];try{n=JSON.parse(localStorage.getItem("_player_sh_player_list"))}catch(a){}for(n||(n=[]),n=n.filter(function(e){return e.sid!==t}),n.push(s);n.length>20;)n.shift();localStorage.setItem("_player_sh_player_list",JSON.stringify(n))}sohuHD.play.videoInfo.thistime=s;var r=sohuHD.play.videoInfo,o=r.totalcount,l=r.thisurl,u=r.nexturl,c=r.thistitle;c=c||n;var p=new Date;p.setTime(p.getTime()+6048e5);var h=p.toGMTString(),f=null,d=1,v="",I=function(e){var t=new RegExp("(?:^|; )"+e+"=([^;]*)").exec(document.cookie);return t?t[1]||"":""};v=I("savehistory").split("%2C"),1==parseInt(I("isJump"))&&(d=3),"#true"==location.hash&&(d=3),void 0===i&&(i=0),void 0!==s&&0!==i||(s=0);var g=new RegExp("[-|\u7b2c|\u4e4b|:|\u2014|\uff1a]","i"),m="",x=c;if(null!==c.match(g)){var w=new RegExp("(.*)([-|\u7b2c|:|\u2014|\uff1a|\u4e4b])","i").exec(c);for(x=w[1],m=w[2];null!==x.match(g);){var O=new RegExp("(.*)([-|\u7b2c|:|\u2014|\uff1a|\u4e4b])","i").exec(x);x=O[1],m=O[2]}}var y=location.href;if(""!==location.hash&&null!==location.hash&&"#true"!=location.hash)f={success:5,order:0,lastTime:parseInt(location.hash.substring(1)),title:"",url:y,nexturl:""};else if(v.length)for(var b=v.length-1;b>=0;b--){var M,_=v[b].split("^"),T=null;v[b-1]&&(T=v[b-1].split("^"));var D=unescape(_[6]);if(""!==m&&-1!=D.indexOf(m)&&(D=D.substring(0,D.indexOf(m))),parseInt(_[0])==t&&parseInt(_[3])>30&&o>1){M=_[5];var H=0;if(_[1]==e){var k,J,S,j;null!==T?t!=T[0]?(H=d,k=_[2],J=Math.ceil(_[3]),S=unescape(_[6]),j=_[5]):0==parseInt(T[2])+1&&parseInt(T[9])-180<=parseInt(T[3])||(H=2,e!=T[1]||"#true"!=location.href&&3!=d||(H=3),k=T[2],J=Math.ceil(T[3]),S=unescape(T[6]),j=T[5]):(H=d,k=_[2],J=Math.ceil(_[3]),S=unescape(_[6]),j=_[5]),2==H&&-1!=j.indexOf("#")&&(j=j.substring(0,j.indexOf("#"))+"#true"),f={success:H,order:k,lastTime:J,title:S,url:j}}else D==x?0==parseInt(_[2])+1&&parseInt(_[9])-180<=parseInt(_[3])||(H=2,_[1]==e&&(H=3),-1!=_[5].indexOf("#")&&(M=_[5].substring(0,_[5].indexOf("#"))+"#true"),f={success:H,order:_[2],lastTime:Math.ceil(_[3]),title:unescape(_[6]),url:M}):0==t&&(0==parseInt(_[2])+1&&parseInt(_[9])-180<=parseInt(_[3])||(H=2,-1!=_[5].indexOf("#")&&(M=_[5].substring(0,_[5].indexOf("#"))+"#true"),f={success:H,order:_[2],lastTime:Math.ceil(_[3]),title:unescape(_[6]),url:M}));2==H&&(document.cookie="isJump=1; expires="+h+"; path=/; domain=tv.sohu.com;");break}parseInt(_[0])==t&&parseInt(_[3])>30&&1==o&&(M="",-1!=_[5].indexOf("#")&&(M=_[5].substring(0,_[5].indexOf("#"))+"#true"),f={success:1,order:_[2],lastTime:Math.ceil(_[3]),title:unescape(_[6]),url:M})}return function(){if(!(Math.ceil(i)<30)){var n=I("savehistory");n=n?n.split("%2C"):[];var r=(new Date).getTime(),o=-1!=l.indexOf("#")?l.substring(0,l.indexOf("#")):l,p="";window.sohuHD&&window.sohuHD.baseInfo&&window.sohuHD.baseInfo.pic170110?p=window.sohuHD.baseInfo.pic170110:window._videoInfo&&window._videoInfo.cover170&&(p=window._videoInfo.cover170);for(var f,d=[],v=0,g=n.length;v<g;v++)if(n[v]){var w=n[v].split("^"),O=unescape(w[6]),y=(r-parseInt(w[7]))/1e3;if(y=y<1?1:Math.floor(y),m&&-1!=O.indexOf(m)&&(O=O.substring(0,O.indexOf(m))),w[0]==t&&x==O){var b=Math.ceil(i);o=o+"#"+b,f=[t,e,0,b,y,o,escape(c),r,u,s,p].join("^"),document.cookie="isJump=0; expires="+h+"; path=/; domain=tv.sohu.com;"}else w[4]=y,d.push(w.join("^"))}if(f?d.push(f):d.push([t,e,0,Math.ceil(i),0,o+"#"+Math.ceil(i),escape(c),r,u,s,p].join("^")),d.length){for(;d.length>6;)d.shift();document.cookie="savehistory="+d.join(escape(","))+"; expires="+h+"; path=/; domain=tv.sohu.com;",a(e,window.playlistId,i)}}}(),f};