define(function(a,b){b.callback=function(){"use strict";define("libs/petrovich_bundle-part",[],function(){function a(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1}function b(a,b,d,f){for(var g=h[f],i=b.split("-"),j=[],k=0;k<i.length;k++){var l=i[k],m=0===k&&i.size>1,n=c(a,l,g,{first_word:m});n?j.push(e(l,d,n)):j.push(l)}return j.join("-")}function c(a,b,c,e){e||(e={});var f=[];for(var g in e)e.hasOwnProperty(g)&&f.push(g);if(c.exceptions){var h=d(a,b,c.exceptions,!0,f);if(h)return h}return d(a,b,c.suffixes,!1,f)}function d(b,c,d,e,f){for(var g=0;g<d.length;g++){var h=d[g];if(h.tags){for(var i=[],j=0;j<h.tags.length;j++){var k=h.tags[j];a(f,k)||i.push(k)}if(!i.length)continue}if("androgynous"===h.gender||b===h.gender){c=c.toLowerCase();for(var j=0;j<h.test.length;j++){var l=h.test[j],m=e?c:c.substr(c.length-l.length);if(m===l)return h}}}return!1}function e(a,b,c){var d;if("nominative"===b)d=".";else for(var e=0;e<f.cases.length;e++)if(b===f.cases[e]){d=c.mods[e-1];break}for(var e=0;e<d.length;e++){var g=d[e];switch(g){case".":break;case"-":a=a.substr(0,a.length-1);break;default:a+=g}}return a}var f={genders:["male","female","androgynous"],nametypes:["first","middle","last"],cases:["nominative","genitive","dative","accusative","instrumental","prepositional"]},g=function(c,d){var e={};if(null!=c.gender){if(!a(f.genders,c.gender))throw new Error("Invalid gender: "+c.gender);e.gender=c.gender}else{if(null==c.middle)throw new Error("Unknown gender");e.gender=g.detect_gender(c.middle)}if(!a(f.cases,d))throw new Error("Invalid case: "+d);for(var h=0;h<f.nametypes.length;h++){var i=f.nametypes[h];null!=c[i]&&(e[i]=b(e.gender,c[i],d,i+"name"))}return e};if(g.detect_gender=function(a){var b=a.toLowerCase().substr(a.length-2);return"ич"===b?"male":"на"===b?"female":"androgynous"},function(){for(var a=0;a<f.genders.length;a++){var c=f.genders[a];g[c]||(g[c]={});for(var d=0;d<f.nametypes.length;d++){var e=f.nametypes[d];g[c][e]||(g[c][e]={});for(var h=0;h<f.cases.length;h++){var i=f.cases[h];g[c][e][i]=function(a,c,d){return function(e){return b(a,e,d,c+"name")}}(c,e,i)}}}}(),"undefined"!=typeof module&&module.exports)module.exports=g;else{if(!window)throw new Error("Unknown environment");window.petrovich=g}var h={lastname:{exceptions:[{gender:"androgynous",test:["бонч","абдул","белиц","гасан","дюссар","дюмон","книппер","корвин","ван","шолом","тер","призван","мелик","вар","фон","балк"],mods:[".",".",".",".","."],tags:["first_word"]},{gender:"androgynous",test:["дюма","тома","дега","люка","ферма","гамарра","петипа","шандра","скаля","каруана","сан"],mods:[".",".",".",".","."]},{gender:"androgynous",test:["гусь","ремень","камень","онук","богода","нечипас","долгопалец","маненок","рева","кива"],mods:[".",".",".",".","."]},{gender:"androgynous",test:["вий","сой","цой","хой","кий"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"androgynous",test:["я"],mods:[".",".",".",".","."]},{gender:"male",test:["заяц"],mods:["--йца","--йцу","--йца","--йцем","--йце"]},{gender:"male",test:["швец"],mods:["а","у","а","ом","е"]}],suffixes:[{gender:"female",test:["б","в","г","д","ж","з","й","к","л","м","н","п","р","с","т","ф","х","ц","ч","ш","щ","ъ","ь"],mods:[".",".",".",".","."]},{gender:"androgynous",test:["гава","орота"],mods:[".",".",".",".","."]},{gender:"female",test:["ска","цка"],mods:["-ой","-ой","-ую","-ой","-ой"]},{gender:"female",test:["цкая","ская","ная","ая"],mods:["--ой","--ой","--ую","--ой","--ой"]},{gender:"female",test:["яя"],mods:["--ей","--ей","--юю","--ей","--ей"]},{gender:"female",test:["на"],mods:["-ой","-ой","-у","-ой","-ой"]},{gender:"male",test:["иной"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"male",test:["уй"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"androgynous",test:["ца"],mods:["-ы","-е","-у","-ей","-е"]},{gender:"male",test:["рих"],mods:["а","у","а","ом","е"]},{gender:"androgynous",test:["ия"],mods:[".",".",".",".","."]},{gender:"androgynous",test:["иа","аа","оа","уа","ыа","еа","юа","эа"],mods:[".",".",".",".","."]},{gender:"male",test:["их","ых"],mods:[".",".",".",".","."]},{gender:"androgynous",test:["о","е","э","и","ы","у","ю"],mods:[".",".",".",".","."]},{gender:"female",test:["ова","ева"],mods:["-ой","-ой","-у","-ой","-ой"]},{gender:"androgynous",test:["га","ка","ха","ча","ща","жа"],mods:["-и","-е","-у","-ой","-е"]},{gender:"androgynous",test:["а"],mods:["-ы","-е","-у","-ой","-е"]},{gender:"male",test:["ь"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"androgynous",test:["ия"],mods:["-и","-и","-ю","-ей","-и"]},{gender:"androgynous",test:["я"],mods:["-и","-е","-ю","-ей","-е"]},{gender:"male",test:["ей"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"male",test:["ян","ан","йн"],mods:["а","у","а","ом","е"]},{gender:"male",test:["лынец"],mods:["--ца","--цу","--ца","--цом","--це"]},{gender:"male",test:["ынец","обец"],mods:["--ца","--цу","--ца","--цем","--це"]},{gender:"male",test:["онец","овец"],mods:["--ца","--цу","--ца","--цом","--це"]},{gender:"male",test:["ай"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"male",test:["кой"],mods:["-го","-му","-го","--им","-м"]},{gender:"male",test:["гой"],mods:["-го","-му","-го","--им","-м"]},{gender:"male",test:["ой"],mods:["-го","-му","-го","--ым","-м"]},{gender:"male",test:["ах","ив"],mods:["а","у","а","ом","е"]},{gender:"male",test:["ший","щий","жий","ний"],mods:["--его","--ему","--его","-м","--ем"]},{gender:"male",test:["ый"],mods:["--ого","--ому","--ого","-м","--ом"]},{gender:"male",test:["кий"],mods:["--ого","--ому","--ого","-м","--ом"]},{gender:"male",test:["ий"],mods:["-я","-ю","-я","-ем","-и"]},{gender:"male",test:["ок"],mods:["--ка","--ку","--ка","--ком","--ке"]},{gender:"male",test:["ец"],mods:["--ца","--цу","--ца","--цом","--це"]},{gender:"male",test:["ц","ч","ш","щ"],mods:["а","у","а","ем","е"]},{gender:"male",test:["ен","нн","он","ун"],mods:["а","у","а","ом","е"]},{gender:"male",test:["в","тин"],mods:["а","у","а","ым","е"]},{gender:"male",test:["н"],mods:["а","у","а","ом","е"]},{gender:"male",test:["дж"],mods:["а","у","а","ем","е"]},{gender:"male",test:["б","г","д","ж","з","к","л","м","п","р","с","т","ф","х"],mods:["а","у","а","ом","е"]}]},firstname:{exceptions:[{gender:"male",test:["лев"],mods:["--ьва","--ьву","--ьва","--ьвом","--ьве"]},{gender:"male",test:["пётр"],mods:["---етра","---етру","---етра","---етром","---етре"]},{gender:"male",test:["павел"],mods:["--ла","--лу","--ла","--лом","--ле"]},{gender:"male",test:["шота"],mods:[".",".",".",".","."]},{gender:"female",test:["рашель","нинель","николь","габриэль","даниэль"],mods:[".",".",".",".","."]}],suffixes:[{gender:"androgynous",test:["е","ё","и","о","у","ы","э","ю"],mods:[".",".",".",".","."]},{gender:"female",test:["б","в","г","д","ж","з","й","к","л","м","н","п","р","с","т","ф","х","ц","ч","ш","щ","ъ"],mods:[".",".",".",".","."]},{gender:"female",test:["ь"],mods:["-и","-и",".","ю","-и"]},{gender:"male",test:["ь"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"androgynous",test:["га","ка","ха","ча","ща"],mods:["-и","-е","-у","-ой","-е"]},{gender:"male",test:["жа"],mods:["-и","-е","-у","-ей","-е"]},{gender:"androgynous",test:["ша"],mods:["-и","-е","-у","-ей","-е"]},{gender:"androgynous",test:["а"],mods:["-ы","-е","-у","-ой","-е"]},{gender:"female",test:["ия"],mods:["-и","-и","-ю","-ей","-и"]},{gender:"female",test:["а"],mods:["-ы","-е","-у","-ой","-е"]},{gender:"female",test:["я"],mods:["-и","-е","-ю","-ей","-е"]},{gender:"male",test:["ия"],mods:["-и","-и","-ю","-ей","-и"]},{gender:"male",test:["я"],mods:["-и","-е","-ю","-ей","-е"]},{gender:"male",test:["ей"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"male",test:["ий"],mods:["-я","-ю","-я","-ем","-и"]},{gender:"male",test:["ый"],mods:["--ого","--ому","--ого","--ым","--ом"]},{gender:"male",test:["й"],mods:["-я","-ю","-я","-ем","-е"]},{gender:"male",test:["ец"],mods:["--ца","--цу","--ца","--цом","--це"]},{gender:"male",test:["ек","ёк"],mods:["--ька","--ьку","--ька","--ьком","--ьке"]},{gender:"male",test:["б","в","г","д","ж","з","к","л","м","н","п","р","с","т","ф","х","ц","ч"],mods:["а","у","а","ом","е"]},{gender:"androgynous",test:["ния","рия","вия"],mods:["-и","-и","-ю","-ем","-ем"]}]},middlename:{suffixes:[{gender:"male",test:["ич"],mods:["а","у","а","ем","е"]},{gender:"female",test:["на"],mods:["-ы","-е","-у","-ой","-е"]}]}};return g}),define("util/css-manager_bundle-part",["jquery","util/helpers","util/promise","util/dom-heap_bundle-part"],function(a,b,c,d){var e,f,g={};return e={init:function(a){this.links=a},isSimpleName:function(a){return a.indexOf("/")===-1},require:function(a,e,f){var h=g[a],i=this.isSimpleName(a)?this.links[a]:a,j=document.createElement("img");return new c(function(c){b.isFunction(e)&&(f=e,e=null),!h||e?(h=g[a]={link:this._createLink(i),isReady:!1,callbacks:[]},d.getContainerAsync().then(function(a){a.append(h.link),j.onerror=function(){b.isFunction(f)&&f(),c(),h.isReady=!0,h.callbacks.forEach(function(a){a()})},j.src=i})):h.isReady?(b.isFunction(f)&&f(),c()):(b.isFunction(f)&&h.callbacks.push(f),h.callbacks.push(c))}.bind(this))},remove:function(b){var c=this.isSimpleName(b)?this.links[b]:b;a(document.head).find('link[rel="stylesheet"][href^="'+c+'"]').remove(),a(d.getContainer()).find('link[rel="stylesheet"][href^="'+c+'"]').remove()},_createLink:function(a){var b;return document.createStyleSheet?b=document.createStyleSheet(a):(b=document.createElement("link"),b.rel="stylesheet",b.href=a),b}},{require:function(a,b,c){return this.createInstance(),f.require(a,b,c)},remove:function(a){return this.createInstance(),f.remove(a)},createInstance:function(){var b,c=a(".b-css-manager-config");c.size()||(c=a('[data-mru-fragment="util/css-manager"]'));try{b=JSON.parse(c.html().replace(/\r|\n|\t|\s{2,}/g,""))}catch(a){b={}}f||(f=Object.create(e),f.init(b))},getInstance:function(){return f||(f=Object.create(e),f.init()),f}}}),define("util/date-format_bundle-part",["jquery","util/helpers"],function(a,b){var c={dateToString:function(a,c,d){var e,f,g,h,i,j,k=this,l="",m=c.replace(/[^Y]+/g,"").length,n=function(a){var b=a||0;return Number(b)>9?b:"0"+b},o=b.isString(a),p=b.isDate(a),q=a.getMyFullYear,r=a.getMyMonth,s=a.getMyDate,t=a.getMyHours,u=a.getMyMinutes,v=a.getMySeconds;return p||o?(o&&(a=k.stringToDate(a,d)),c?(j=a.getMySeconds?v.call(a):n(a.getSeconds()),i=a.getMyMinutes?u.call(a):n(a.getMinutes()),h=a.getMyHours?t.call(a):n(a.getHours()),g=a.getMyDate?s.call(a):n(a.getDate()),f=a.getMyMonth?r.call(a):n(a.getMonth()+1),e=a.getMyFullYear?q.call(a,m):a.getFullYear().toString().slice(m-4),l=c.replace(/Y+/,e).replace(/M+/,f).replace(/D+/,g).replace(/h+/,h).replace(/m+/,i).replace(/s+/,j)):l=a.toLocaleDateString(),l):""},stringToDate:function(a,c){var d,e=a||"",f=c.replace(/[^Y]+/g,"").length,g=b.isString(e),h=b.isDate(e),i=function(a){var b=a||0;return Number(b)>9?b:"0"+b},j=0,k=g&&c?c.length:0,l="",m="",n="",o="",p="",q="";if(h)return e;if(k){for(j=0;j<k;j+=1)d=c.charAt(j),"Y"===d?l+=e.charAt(j):"M"===d?m+=e.charAt(j):"D"===d?n+=e.charAt(j):"h"===d?o+=e.charAt(j):"m"===d?p+=e.charAt(j):"s"===d&&(q+=e.charAt(j));l=Number(l.slice(f-4)),m=Number(i(m)),n=Number(i(n)),o=Number(i(o)),p=Number(i(p)),q=Number(i(q))}return e=new Date(l,m-1,n,o,p,q)},secondToStr:function(b,c){b=Number(b),isNaN(b)&&(b=0);var d=a.extend({},{showHour:!1,showMin:!0,showSec:!0,padHour:!1,padMin:!0,padSec:!0,sepHour:":",sepMin:":",sepSec:""},c),e=new Date(1e3*b),f=e.getUTCHours(),g=d.showHour?e.getUTCMinutes():e.getUTCMinutes()+60*f,h=d.showMin?e.getUTCSeconds():e.getUTCSeconds()+60*g,i=d.padHour&&f<10?"0"+f:f,j=d.padMin&&g<10?"0"+g:g,k=d.padSec&&h<10?"0"+h:h,l="";return i&&(l+=d.showHour?i+d.sepHour:""),l+=d.showMin?j+d.sepMin:"",l+=d.showSec?k+d.sepSec:""}};return c}),define("util/date-time_bundle-part",["jquery","base/view","util/helpers","util/num-end"],function(a,b,c,d){var e=b.extend({autoInit:!0,public:{init:function(){var b=a(".b-date-time-options");return b&&b.size()&&c.extend(this.options,JSON.parse(b.html())),this},getTimeLeft:function(a){var b,e,f,g,h,i,j,k,l=new Date,m="",n=this.options.locales;return c.isDate(a)||(a=new Date(Number(a))),b=a.getFullYear(),e=a.getMonth(),f=a.getDate(),g=a.getHours(),h=a.getMinutes(),i=Math.round((l.getTime()-a.getTime())/1e3),j=Math.round(i/60),k=Math.round(j/60),m=i<5?n.left.now:i<60?this.getTimeUnity(i)+d.getText(i,n.left.seconds.five,n.left.seconds.one,n.left.seconds.two)+" "+n.left.ago:i<3600?this.getTimeUnity(j)+d.getText(j,n.left.minutes.five,n.left.minutes.one,n.left.minutes.two)+" "+n.left.ago:i<10800?this.getTimeUnity(k)+d.getText(k,n.left.hours.five,n.left.hours.one,n.left.hours.two)+" "+n.left.ago:i<86400&&f===l.getDate()?n.left.today+" "+n.left.in+" "+this.getTimeFormated(g,h):i<172800&&f===l.getDate()-1?n.left.yesterday+" "+n.left.in+" "+this.getTimeFormated(g,h):b===l.getFullYear()?f+" "+n.left.months[a.getMonth()]:b===l.getFullYear()-1&&(e>l.getMonth()||e===l.getMonth()&&f>l.getDate())?f+" "+n.left.months[a.getMonth()]:f+" "+n.left.months[a.getMonth()]+" "+b}},protected:{getTimeUnity:function(a){return a>1?a+" ":""},getTimeFormated:function(a,b){var c=a<10?"0"+a:a,d=b<10?"0"+b:b;return c+":"+d}},static:{instance:null,getTimeLeft:function(a){return this.instance||(this.instance=new this),this.instance.getTimeLeft(a)},getMonths:function(){return this.instance||(this.instance=new this),this.instance.options.locales.months},getMonthsLeft:function(){return this.instance||(this.instance=new this),this.instance.options.locales.left.months},getDaysCountByMonth:function(a){var b=[31,29,31,30,31,30,31,31,30,31,30,31];return b[a]}}});return e}),define("util/dom-heap_bundle-part",["jquery"],function(a){var b=null;return a(function(){b&&b.size()||(b=a(".b-global-heap"))}),{insert:function(a){return this._initHeap(),a.appendTo(b)},clear:function(){this._initHeap(),b.empty()},getContainer:function(){return this._initHeap(),b},getContainerAsync:function(a){return a=a||0,this._initHeap(),new Promise(function(c,d){b&&b.size()?c(b):a<50?setTimeout(function(){this.getContainerAsync(++a).then(c)}.bind(this),50):d()}.bind(this))},_initHeap:function(){b&&b.length||(b=a(".b-global-heap"))}}}),define("util/drag-and-drop_bundle-part",["jquery","util/helpers"],function(a,b){var c={defaultOptions:{timeoutLeave:100},init:function(b){return this.options=a.extend({},this.defaultOptions,b),this.callbacks=[],this.id=0,a(document.body).on("dragover",this.onDragEnter.bind(this)).on("dragleave",this.onDragLeave.bind(this)).on("drop",this.onDrop.bind(this)),this},on:function(a,c){var d;return d=b.isjQueryObject(a)?a.get(0):a,b.isNode(d)?(this.callbacks.push({id:++this.id,element:d,over:c.over,out:c.out,drop:c.drop}),this.id):this},off:function(a,c){var d;return d=b.isjQueryObject(a)?a.get(0):a,this.callbacks.forEach(function(a,b){a.element!==d||c&&c!==a.id||this.callbacks.splice(b)}.bind(this)),this},onDragEnter:function(c){c.preventDefault(),this.callbacks.forEach(function(d){a(c.target).closest(d.element).size()&&!d.isOver&&(b.isFunction(d.over)&&(clearTimeout(d.timerOut),d.over(c)),d.isOver=!0)}.bind(this))},onDragLeave:function(c){c.preventDefault(),this.callbacks.forEach(function(d){a(c.target).closest(d.element).size()&&d.isOver&&(b.isFunction(d.out)&&(d.timerOut=setTimeout(function(){d.out(c)},this.options.timeoutLeave)),d.isOver=!1)}.bind(this))},onDrop:function(c){c.preventDefault(),this.callbacks.forEach(function(d){a(c.target).closest(d.element).size()&&b.isFunction(d.drop)&&d.drop(c)}.bind(this))}};return Object.create(c).init()}),define("util/find-event-target_bundle-part",["jquery"],function(a){return function(b,c){var d=a(b.target);return d.is(c)?d:(d=d.parents(c),d.length>0?a(d.get(0)):null)}}),define("util/hosts_bundle-part",["util/helpers"],function(a){var b={defaultOptions:{hosts:{alpha:"myalpha.imgsmail.ru",beta:"mybeta.imgsmail.ru",psi:"psi.imgsmail.ru",live:"my1.imgsmail.ru",avt:"avt.foto.mail.ru",content:{live:"foto.my.mail.ru",alpha:"foto.my.myalpha4.i.mail.ru",psi:"foto.my.myalpha6.i.mail.ru"},photo:{live:"foto.mail.ru",alpha:"foto.myalpha4.i.mail.ru",psi:"foto.myalpha6.i.mail.ru"},avatar:{live:"foto.mail.ru",alpha:"avt.myalpha4.i.mail.ru",psi:"avt.myalpha6.i.mail.ru"},audio:"music.my.mail.ru"},staticUrl:"/mail/ru/images",imagesUrl:"/my/compass/static"},init:function(){var b=document.getElementById("js-require-data");return b?this.options=a.extend(!0,{},this.defaultOptions,JSON.parse(b.innerHTML)):this.options=a.extend(!0,{},this.defaultOptions),this},getCookieDomain:function(){var a;return a=this.options.isPsi||this.options.isTestServer?".i.mail.ru":".my.mail.ru"},getHost:function(){var a;return a=this.options.isPsi?this.options.hosts.psi:this.options.isTestServer?this.options.hosts.alpha:this.options.isBeta?this.options.hosts.beta:this.options.hosts.live,this.options.isTestServer&&this.options.branch&&(a=this.options.branch+"."+a),a},url:function(a){return 0!==a.indexOf("//")&&(a="//"+a),a+"/"},getStaticHost:function(){return this.url(this.getHost()+this.options.staticUrl)},getImagesHost:function(){return this.url(this.getHost()+this.options.staticUrl+this.options.imagesUrl)},getGiftsHost:function(){var a;return a=this.options.isTestServer||this.options.isPsi?this.options.hosts.psi:this.options.isBeta?this.options.hosts.beta:this.options.hosts.live,this.url(a+this.options.staticUrl+"/my/gifts/")},getAvtHost:function(){return this.url(this.options.host.avt)},getContentHost:function(a){var b;return this.options.contentHost?b=this.url(this.options.contentHost):(b=this.options.isPsi?this.options.hosts.content.psi:this.options.isTestServer?this.options.hosts.content.alpha:this.options.hosts.content.live,b=this.url("content-"+(a||Math.ceil(30*Math.random()))+"."+b)),b},getAvatarHost:function(a){var b;return b=this.options.isPsi?this.options.hosts.avatar.psi:this.options.isTestServer?this.options.hosts.avatar.alpha:this.options.hosts.avatar.live,this.url("avt-"+(a||Math.ceil(30*Math.random()))+"."+b)},getPhotoHost:function(){var a;return this.options.isPsi?a=this.options.hosts.photo.psi:this.options.isTestServer?(a=this.options.hosts.photo.alpha,this.options.branch&&(a=this.options.branch+"."+a)):a=this.options.hosts.photo.live,this.url(a)},getAudioHost:function(){return this.url(this.options.hosts.audio)},getUploadUrl:function(a,b){var c=a,d=document.createElement("textarea");return d.innerHTML=c,c=d.value,c=b&&b!==-1?c.replace(/##n##/,Math.ceil(Math.random()*b)):c.replace(/-##n##/,"")}};return Object.create(b).init()}),define("util/htmlescape_bundle-part",[],function(){return{escape:function(a){return String(a).replace(/&/g,"&amp;").replace(/#/g,"&#35;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescape:function(a){return String(a).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#037;/g,"%").replace(/&#39;/g,"'").replace(/&#039;/g,"'").replace(/&#92;/g,"\\").replace(/&#092;/g,"\\").replace(/&#x3D;/g,"=").replace(/&#x3d;/g,"=").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#35;/g,"#")}}}),define("util/icons-manager_bundle-part",["jquery","base/event","util/helpers"],function(a,b,c){var d=b.extend({static:{parseOptions:function(){var b;return this.options||(this.options=c.parseJsonFromSrc(a(".b-sprites-options").html())),b=this.options},isSvgSupport:function(){return document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},isLocalStorageSupport:function(){return!!window.localStorage},loadSprite:function(a){var b,c;if(this.parseOptions(),b=this.options[a],this.spritesLoaded||(this.spritesLoaded={}),!this.spritesLoaded[a]&&b){if(this.isSvgSupport())if(this.isLocalStorageSupport()&&localStorage.getItem(b.revision.key)===b.revision.value)this.insert(localStorage.getItem(b.data.key));else try{c=new XMLHttpRequest,c.open("GET",b.url,!0),c.onload=function(){c.status>=200&&c.status<300&&(this.insert(c.responseText),this.isLocalStorageSupport()&&(localStorage.setItem(b.data.key,c.responseText),localStorage.setItem(b.revision.key,b.revision.value)))}.bind(this),c.send()}catch(a){}this.spritesLoaded[a]=!0}},insert:function(a){a&&(document.body?document.body.insertAdjacentHTML("afterbegin",a):document.addEventListener("DOMContentLoaded",function(){document.body.insertAdjacentHTML("afterbegin",a)}))},getHtml:function(a,b){return b=b||"icon",'<svg class="svg-sprite-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#'+b+"-"+a+'"></use></svg>'}}});return d}),define("util/infinite-scroll_bundle-part",["jquery"],function(a){var b={interval:500,delta:0,container:window,direction:"ttb"},c=function(a){a.data.context.scrolled=!0},d=function(a,b,c){var d,e=a.offsetParent(),f=b.get(0)===window;return d=f?a.offset().top:c?a.position().top:a.get(0).offsetTop-e.offset().top},e={run:function(){var b=this;return b.stop(),a(b.container).on("scroll",{context:b},c),b.scrolled=!0,b.tid=setInterval(function(){var b=a(this.container),c=a(this.marker);if(b.get(0)&&c.get(0)){var e,f,g="btt"===this.direction,h=b.scrollTop(),i=d(c,b,g),j=b.height();f=g?h-this.delta<=0:i-h-this.delta<=j,e=this.scrolled&&c.is(":visible"),e&&f&&(this.scrolled=!1,this.stop(),this.callback(this,this.count),this.count+=1)}}.bind(b),b.interval),b},stop:function(){var b=this;return clearInterval(b.tid),a(b.container).off("scroll",c),b},reset:function(){return this.count=0,this},setMarker:function(a){return this.marker=a,this}};return{create:function(c){var d=Object.create(e);return a.extend(d,b,c),d.count=0,d.interval=Math.max(d.interval,b.interval),d.autoRun!==!1&&d.run(),d}}}),define("util/inflect-name_bundle-part",["libs/petrovich_bundle-part"],function(a){return{get:function(b,c){return a({gender:b&&b.isFemale?"female":"male",first:b&&b.name&&b.name.first,last:b&&b.name&&b.name.last},c)},getStr:function(a,b,c){var d,e=this.get(a,b);return c=c||"%first% %last%",d=c,d=d.replace(/%first%/g,e.first||""),d=d.replace(/%last%/g,e.last||"")}}}),define("util/is-ctrl_bundle-part",["exports","jquery"],function(a,b){var c=!1,d=navigator.platform.indexOf("Mac")>-1,e=function(a){return c=!!(!d&&a.ctrlKey||d&&a.metaKey)},f=function(a){e(a)},g=function(a){e(a)};b(document).on("keydown",f).on("keyup",g),a.isCtrlPressed=function(){return c},a.isCtrlPressedByEvent=function(a){return e(a)}}),define("util/page-visibility_bundle-part",["util/event2"],function(a){function b(a){var b="visible",e="hidden",f={focus:b,focusin:b,pageshow:b,blur:e,focusout:e,pagehide:e};a=a||window.event,f.hasOwnProperty(a.type)?d.trigger(f[a.type]):this&&this[c]?d.trigger(e):d.trigger(b)}var c="hidden",d=a.create();return document.hasOwnProperty?document.hasOwnProperty("hidden")?document.addEventListener("visibilitychange",b):document.hasOwnProperty("mozHidden")?(c="mozHidden",document.addEventListener("mozvisibilitychange",b)):document.hasOwnProperty("webkitHidden")?(c="webkitHidden",document.addEventListener("webkitvisibilitychange",b)):document.hasOwnProperty("msHidden")?(c="msHidden",document.addEventListener("msvisibilitychange",b)):document.hasOwnProperty("onfocusin")?document.onfocusin=document.onfocusout=b:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=b:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=b,void 0!==document[c]&&b({type:document[c]?"blur":"focus"}),{on:function(){return d.on.apply(d,arguments),this},off:function(){return d.off.apply(d,arguments),this}}}),define("util/resize_bundle-part",["jquery","base/view","util/helpers"],function(a,b,c){var d=b.extend({autoInit:!0,props:{defaultOptions:{skip:5}},public:{init:function(){return this.lastSize={width:0,height:0},this.constructor.addInstance(this),this},destroy:function(){return this.constructor.removeInstance(this),d.__super__.destroy.call(this),this},subscribe:function(a){return this.on("resize",a),this},unsubscribe:function(a){return this.off("resize",a),this},emit:function(a){return this.trigger("resize",a),this}},protected:{onResize:function(a,b){var c=Math.abs(a.width-this.lastSize.width)>this.options.skip,d=Math.abs(a.height-this.lastSize.height)>this.options.skip;(c||d)&&(this.trigger("resize",{size:a,event:b}),this.lastSize=a)}},static:{instances:[],defaultInstance:null,addInstance:function(a){return this.instances.push(a),this},removeInstance:function(a){this.instances.every(function(b,c){return a!==b||(this.instances.splice(c,1),!1)}.bind(this))},onResize:function(b){var c={width:a(window).width(),height:a(window).height()};this.instances.forEach(function(a){a.onResize(c,b)})},on:function(a){this.defaultInstance||(this.defaultInstance=new this),this.defaultInstance.subscribe(a)},off:function(a){this.defaultInstance&&this.defaultInstance.unsubscribe(a)},trigger:function(a){this.defaultInstance&&this.defaultInstance.emit(a)}}});return a(window).on("resize",d.onResize.bind(d)),d}),define("util/scroll_bundle-part",["jquery","factory","base/view","util/helpers"],function(a,b,c,d){var e=c.extend({autoInit:!0,props:{defaultOptions:{skip:5}},public:{init:function(){return this.lastScrollTop=0,this.constructor.addInstance(this),this},destroy:function(){return this.constructor.removeInstance(this),e.__super__.destroy.call(this),this},subscribe:function(a,b){return b=b||{},b.mousewheel?this.on("mousewheel",a):this.on("scroll",a),this},unsubscribe:function(a){return this.off("scroll",a),this.off("mousewheel",a),this},emit:function(a){return a||(a={scrollTop:0}),this.trigger("scroll",a),this.trigger("mousewheel",a),this}},protected:{onScroll:function(a,b){(Math.abs(a-this.lastScrollTop)>=this.options.skip||0===a)&&(this.trigger("scroll",{scrollTop:a,delta:a-this.lastScrollTop,event:b}),this.lastScrollTop=a)},onMouseWheel:function(a,b){this.trigger("mousewheel",{scrollTop:a,event:b})}},static:{instances:[],defaultInstance:null,addInstance:function(a){return this.instances.push(a),this},removeInstance:function(a){this.instances.every(function(b,c){return a!==b||(this.instances.splice(c,1),!1)}.bind(this))},onScroll:function(b){var c=a(window).scrollTop()||document.documentElement.scrollTop;this.instances.forEach(function(a){a.onScroll(c,b)})},onMouseWheel:function(b){var c=a(window).scrollTop()||document.documentElement.scrollTop;this.instances.forEach(function(a){a.onMouseWheel(c,b)})},on:function(a,b){this.defaultInstance||(this.defaultInstance=new this),this.defaultInstance.subscribe(a,b)},off:function(a){this.defaultInstance&&this.defaultInstance.unsubscribe(a)},trigger:function(a){this.defaultInstance&&this.defaultInstance.emit(a)},scrollTo:function(a,b,c){var f,g,h=window.pageYOffset||document.documentElement.scrollTop,i=a-h;b=b||1,f=i/b*10,b<0||setTimeout(function(){return g=h+f,window.scrollTo(0,g),g===a?void(d.isFunction(c)&&c()):void e.scrollTo(a,b-10,c)},10)}}});return a(window).on("scroll",e.onScroll.bind(e)),a.browser.mozilla?b("jquery.mousewheel",function(){a(window).on("mousewheel",e.onMouseWheel.bind(e))}):a(window).on("mousewheel",e.onMouseWheel.bind(e)),e}),define("util/scrollbar-width_bundle-part",["jquery"],function(a){function b(){if(!c){var b,d;b=a('<div style="width:50px; height:50px; overflow:auto; position: absolute; top: 10px; left: -1000px;"><div></div></div>').appendTo("body"),d=b.children(),c=d.innerWidth()-d.height(99).innerWidth(),b.remove()}return c}var c;return a(function(){b()}),b}),define("util/storage_bundle-part",["util/event2","util/helpers","util/schedule"],function(a,b,c){var d={init:function(a,c){var d;if(!a)throw"no context. fail!";if(a.localStorage&&a.localStorage.setItem)try{a.localStorage.setItem("test","1"),d=a.localStorage}catch(a){d=window.localStorage}return void 0===d&&a.globalStorage&&(d=a.globalStorage(a.document.domain)),d&&!b.os.isIpad()?(this.Storage=d,this.normalStorage=!0):(this.Storage=a.document,this.normalStorage=!1),this.maxLength=c||100,this},getCookie:function(){var a={};return this.Storage.cookie.split(";").forEach(function(b){b=b.split("="),a[b[0].replace(/\s/g,"")]=b[1]}),a},setCookie:function(a,b){this.Storage.cookie=a+"="+window.escape(b)+";expires="+new Date(+new Date+864e5).toGMTString()+";"},load:function(a){var b;if(this.normalStorage===!0)try{b=this.Storage&&this.Storage.getItem(a)}catch(a){}else this.normalStorage===!1&&(b=window.unescape(this.getCookie()[a]));return b},save:function(a,b){var d,e=!1;return b.length<this.maxLength&&this.Storage&&(this.normalStorage===!0?this.Storage.setItem(a,b):this.normalStorage===!1&&this.setCookie(a,b),e=!0),b&&""!==b&&(d=new c(this.event.trigger.bind(this.event,d),10)),e},event:a.create()};return{create:function(){return Object.create(d)}}}),define("util/uri_bundle-part",function(){function a(b,c,d){if("string"==typeof c)return a(b,!1,c);var e,f=new RegExp("&?"+d+"((=)([^&]+))?"),g=f.exec(b);return g?(e=g[3]||"",c?e:unescape(e)):""}var b,c=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,d=["source",null,"protocol",null,"host","path",null,"query",null,"fragment"];return b={attr:function(a,b){var c;if(2===arguments.length&&"boolean"==typeof a){if(c=this.data[b]||"",!a)try{c=decodeURIComponent(c)}catch(a){}return c}return 1===arguments.length?this.attr(!1,a):""},param:function(b,c){return a(this.attr(!0,"query"),b,c)},fparam:function(b,c){return a(this.attr(!0,"fragment"),b,c)}},function(a){a=a||location.href;var e,f=Object.create(b);return f.data={},e=c.exec(a),e?(e.forEach(function(a,b){var c=d[b];c&&(f.data[c]=a||"")}),f):null}})},b.modules=["libs/petrovich","util/css-manager","util/date-format","util/date-time","util/dom-heap","util/drag-and-drop","util/find-event-target","util/hosts","util/htmlescape","util/icons-manager","util/infinite-scroll","util/inflect-name","util/is-ctrl","util/page-visibility","util/resize","util/scroll","util/scrollbar-width","util/storage","util/uri"]});