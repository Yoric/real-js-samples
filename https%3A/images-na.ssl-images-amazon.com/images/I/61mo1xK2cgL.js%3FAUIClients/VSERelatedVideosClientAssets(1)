(function(z){var w=window.AmazonUIPageJS||window.P,l=w._namespace||w.attributeErrors,B=l?l("VSERelatedVideosClientAssets",""):w;B.guardFatal?B.guardFatal(z)(B,window):B.execute(function(){z(B,window)})})(function(z,w,l){(function(){function B(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})}function Jb(a,b,c){void 0===c&&(c="airyContainer");return'\x3cbody style\x3d"width:100%; height:100%; margin:0px;"\x3e\n    \x3cdiv id\x3d"'+
c+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e\n    \x3cscript crossorigin\x3d"anonymous"  src\x3d"'+a+'" onload\x3d"parent[\''+b+"'].resolve(Airy)\" onerror\x3d\"parent['"+b+"'].reject(event)\"\x3e\x3c/script\x3e\n    \x3c/body\x3e"}function Kb(a,b,c,d){void 0===d&&(d="airyContainer");return'\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+b+'" /\x3e\n    \x3cbody style\x3d"width:100%; height:100%; margin:0px;"\x3e\n    \x3cdiv id\x3d"'+d+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e\n    \x3cscript crossorigin\x3d"anonymous"  src\x3d"'+
a+'" onload\x3d"parent[\''+c+"'].resolve(Airy);\" onerror\x3d\"parent['"+c+"'].reject(event)\"\x3e\x3c/script\x3e\n    \x3c/body\x3e"}function Ca(){var a=document.createElement("iframe");a.className="vse-airy-container-frame";a.setAttribute("frameborder","0");a.setAttribute("scrolling","0");a.setAttribute("allowfullscreen","true");a.setAttribute("mozallowfullscreen","true");a.setAttribute("webkitallowfullscreen","true");return a}function Lb(a,b){b={contentId:""+a.initialVideo.contentId,customerId:a.customerId,
foresterMetadataParams:{client:a.requestMetadata.clientId,marketplaceId:a.requestMetadata.marketplaceId,method:a.requestMetadata.method,requestId:a.requestMetadata.requestId,session:a.requestMetadata.sessionId},mediaSourceInfo:[""+a.initialVideo.videoUrl],posterSource:a.initialVideo.imageUrl,pageAsin:a.requestMetadata.pageAsin,parentId:b,vendorCode:a.initialVideo.vendorCode,videoAds:a.videoAds,shouldStartMuted:a.shouldStartMuted,shouldAutoplay:a.shouldAutoplay,shouldDisableControls:a.shouldDisableControls,
twitchCore:a.twitchCore,useCarousel:a.useCarousel,useBuyBox:a.useBuyBox,languagePreferenceStrings:a.languagePreferenceStrings,sushiEndpoint:a.sushiEndpoint,universalSushiParams:{weblabIds:a.universalSushiParams.weblabIds,isInternal:a.universalSushiParams.isInternal,isRobot:a.universalSushiParams.isRobot}};a.eventTimestamp&&(b.eventTimestamp=a.eventTimestamp);return b}function Mb(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|
8).toString(16)})}function Da(a,b){for(var c=-1,d=null==a?0:a.length,g=Array(d);++c<d;)g[c]=b(a[c],c,a);return g}function Ea(a,b){return a===b||a!==a&&b!==b}function Y(a,b){for(var c=a.length;c--;)if(Ea(a[c][0],b))return c;return-1}function D(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function N(a){if(null==a)return a===l?"[object Undefined]":"[object Null]";if(Fa&&Fa in Object(a)){var b=Nb.call(a,R),c=a[R];try{a[R]=l;var d=!0}catch(f){}var g=Ob.call(a);
d&&(b?a[R]=c:delete a[R]);a=g}else a=Pb.call(a);return a}function F(a){var b=typeof a;return null!=a&&("object"==b||"function"==b)}function Ga(a){if(!F(a))return!1;a=N(a);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a}function I(a){if(null!=a){try{return Qb.call(a)}catch(b){}return a+""}return""}function J(a,b){a=null==a?l:a[b];b=!F(a)||Ha&&Ha in a?!1:(Ga(a)?Rb:Sb).test(I(a));return b?a:l}function K(a){var b=-1,c=null==a?0:a.length;
for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Z(a,b){a=a.__data__;var c=typeof b;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function E(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function G(a){this.size=(this.__data__=new D(a)).size}function aa(a){var b=-1,c=null==a?0:a.length;for(this.__data__=new E;++b<c;)this.add(a[b])}function Tb(a,b){for(var c=
-1,d=null==a?0:a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function Ia(a,b,c,d,g,f){var k=c&1,h=a.length,t=b.length;if(h!=t&&!(k&&t>h))return!1;if((t=f.get(a))&&f.get(b))return t==b;var t=-1,e=!0,m=c&2?new aa:l;f.set(a,b);for(f.set(b,a);++t<h;){var y=a[t],u=b[t];if(d)var p=k?d(u,y,t,b,a,f):d(y,u,t,a,b,f);if(p!==l){if(p)continue;e=!1;break}if(m){if(!Tb(b,function(b,a){if(!m.has(a)&&(y===b||g(y,b,c,d,f)))return m.push(a)})){e=!1;break}}else if(y!==u&&!g(y,u,c,d,f)){e=!1;break}}f["delete"](a);f["delete"](b);
return e}function Vb(a){var b=-1,c=Array(a.size);a.forEach(function(a,g){c[++b]=[g,a]});return c}function Wb(a){var b=-1,c=Array(a.size);a.forEach(function(a){c[++b]=a});return c}function Xb(a,b,c,d,g,f,k){switch(c){case "[object DataView]":if(a.byteLength!=b.byteLength||a.byteOffset!=b.byteOffset)break;a=a.buffer;b=b.buffer;case "[object ArrayBuffer]":if(a.byteLength!=b.byteLength||!f(new Ja(a),new Ja(b)))break;return!0;case "[object Boolean]":case "[object Date]":case "[object Number]":return Ea(+a,
+b);case "[object Error]":return a.name==b.name&&a.message==b.message;case "[object RegExp]":case "[object String]":return a==b+"";case "[object Map]":var h=Vb;case "[object Set]":h||(h=Wb);if(a.size!=b.size&&!(d&1))break;if(c=k.get(a))return c==b;d|=2;k.set(a,b);b=Ia(h(a),h(b),d,g,f,k);k["delete"](a);return b;case "[object Symbol]":if(ja)return ja.call(a)==ja.call(b)}return!1}function Ka(a,b,c){b=b(a);if(!A(a)){a=c(a);c=-1;for(var d=a.length,g=b.length;++c<d;)b[g+c]=a[c]}return b}function Yb(a,b){for(var c=
-1,d=null==a?0:a.length,g=0,f=[];++c<d;){var k=a[c];b(k,c,a)&&(f[g++]=k)}return f}function Zb(){return[]}function L(a){return null!=a&&"object"==typeof a}function La(a){return L(a)&&"[object Arguments]"==N(a)}function $b(){return!1}function ka(a,b){b=null==b?9007199254740991:b;return!!b&&("number"==typeof a||ac.test(a))&&-1<a&&0==a%1&&a<b}function la(a){return"number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a}function bc(a){return L(a)&&la(a.length)&&!!v[N(a)]}function cc(a){return function(b){return a(b)}}
function ma(a){return null!=a&&la(a.length)&&!Ga(a)}function ba(a){if(ma(a)){var b=A(a),c=!b&&Ma(a),d=!b&&!c&&na(a),g=!b&&!c&&!d&&Na(a);if(b=b||c||d||g){for(var c=a.length,f=String,k=-1,h=Array(c);++k<c;)h[k]=f(k);c=h}else c=[];var f=c.length,e;for(e in a)!dc.call(a,e)||b&&("length"==e||d&&("offset"==e||"parent"==e)||g&&("buffer"==e||"byteLength"==e||"byteOffset"==e)||ka(e,f))||c.push(e);a=c}else if(e=a&&a.constructor,a===("function"==typeof e&&e.prototype||ec)){e=[];for(d in Object(a))fc.call(a,
d)&&"constructor"!=d&&e.push(d);a=e}else a=gc(a);return a}function O(a,b,c,d,g){if(a===b)return!0;if(null==a||null==b||!L(a)&&!L(b))return a!==a&&b!==b;a:{var f=A(a),k=A(b),h=f?"[object Array]":Oa(a),e=k?"[object Array]":Oa(b),h="[object Arguments]"==h?"[object Object]":h,e="[object Arguments]"==e?"[object Object]":e,q="[object Object]"==h,k="[object Object]"==e;if((e=h==e)&&na(a)){if(!na(b)){b=!1;break a}f=!0;q=!1}if(e&&!q)g||(g=new G),b=f||Na(a)?Ia(a,b,c,d,O,g):Xb(a,b,h,c,d,O,g);else{if(!(c&1)&&
(f=q&&Pa.call(a,"__wrapped__"),h=k&&Pa.call(b,"__wrapped__"),f||h)){a=f?a.value():a;b=h?b.value():b;g||(g=new G);b=O(a,b,c,d,g);break a}if(e)b:if(g||(g=new G),f=c&1,h=Ka(a,ba,Qa),k=h.length,e=Ka(b,ba,Qa).length,k==e||f){for(q=k;q--;){var m=h[q];if(!(f?m in b:hc.call(b,m))){b=!1;break b}}if((e=g.get(a))&&g.get(b))b=e==b;else{e=!0;g.set(a,b);g.set(b,a);for(var y=f;++q<k;){var m=h[q],u=a[m],p=b[m];if(d)var r=f?d(p,u,m,b,a,g):d(u,p,m,a,b,g);if(r===l?u!==p&&!O(u,p,c,d,g):!r){e=!1;break}y||(y="constructor"==
m)}e&&!y&&(c=a.constructor,d=b.constructor,c!=d&&"constructor"in a&&"constructor"in b&&!("function"==typeof c&&c instanceof c&&"function"==typeof d&&d instanceof d)&&(e=!1));g["delete"](a);g["delete"](b);b=e}}else b=!1;else b=!1}}return b}function ic(a,b,c,d){var g=c.length,f=g,k=!d;if(null==a)return!f;for(a=Object(a);g--;){var h=c[g];if(k&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++g<f;){var h=c[g],e=h[0],q=a[e],m=h[1];if(k&&h[2]){if(q===l&&!(e in a))return!1}else{h=new G;if(d)var y=d(q,m,e,
a,b,h);if(y===l?!O(m,q,3,d,h):!y)return!1}}return!0}function jc(a){for(var b=ba(a),c=b.length;c--;){var d=b[c],g=a[d];b[c]=[d,g,g===g&&!F(g)]}return b}function Ra(a,b){return function(c){return null==c?!1:c[a]===b&&(b!==l||a in Object(c))}}function kc(a){var b=jc(a);return 1==b.length&&b[0][2]?Ra(b[0][0],b[0][1]):function(c){return c===a||ic(c,a,b)}}function ca(a){return"symbol"==typeof a||L(a)&&"[object Symbol]"==N(a)}function oa(a,b){if(A(a))return!1;var c=typeof a;return"number"==c||"symbol"==
c||"boolean"==c||null==a||ca(a)?!0:lc.test(a)||!mc.test(a)||null!=b&&a in Object(b)}function pa(a,b){if("function"!=typeof a||null!=b&&"function"!=typeof b)throw new TypeError("Expected a function");var c=function(){var d=arguments,g=b?b.apply(this,d):d[0],f=c.cache;if(f.has(g))return f.get(g);d=a.apply(this,d);c.cache=f.set(g,d)||f;return d};c.cache=new (pa.Cache||E);return c}function Sa(a){if("string"==typeof a)return a;if(A(a))return Da(a,Sa)+"";if(ca(a))return Ta?Ta.call(a):"";var b=a+"";return"0"==
b&&1/a==-nc?"-0":b}function Ua(a,b){return A(a)?a:oa(a,b)?[a]:oc(null==a?"":Sa(a))}function da(a){if("string"==typeof a||ca(a))return a;var b=a+"";return"0"==b&&1/a==-pc?"-0":b}function Va(a,b){b=Ua(b,a);for(var c=0,d=b.length;null!=a&&c<d;)a=a[da(b[c++])];return c&&c==d?a:l}function qc(a,b){return oa(a)&&b===b&&!F(b)?Ra(da(a),b):function(c){var d;d=null==c?l:Va(c,a);d=d===l?void 0:d;var g;if(d===l&&d===b){if(d=null!=c){d=a;d=Ua(d,c);for(var f=-1,k=d.length,h=!1;++f<k;){g=da(d[f]);if(!(h=null!=c&&
null!=c&&g in Object(c)))break;c=c[g]}h||++f!=k?d=h:(k=null==c?0:c.length,d=!!k&&la(k)&&ka(g,k)&&(A(c)||Ma(c)))}g=d}else g=O(b,d,3);return g}}function ea(a){return a}function rc(a){return function(b){return null==b?l:b[a]}}function sc(a){return function(b){return Va(b,a)}}function Wa(a){return"function"==typeof a?a:null==a?ea:"object"==typeof a?A(a)?qc(a[0],a[1]):kc(a):oa(a)?rc(da(a)):sc(a)}function tc(a,b){var c=-1,d=ma(a)?Array(a.length):[];Xa(a,function(a,f,k){d[++c]=b(a,f,k)});return d}function uc(a,
b){return(A(a)?Da:tc)(a,Wa(b,3))}function qa(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function vc(a,b,c){b=Ya(b===l?a.length-1:b,0);return function(){for(var d=arguments,g=-1,f=Ya(d.length-b,0),k=Array(f);++g<f;)k[g]=d[b+g];g=-1;for(f=Array(b+1);++g<b;)f[g]=d[g];f[b]=c(k);return qa(a,this,f)}}function wc(a){return function(){return a}}function Za(a){var b=0,c=0;return function(){var d=
xc(),g=16-(d-c);c=d;if(0<g){if(800<=++b)return arguments[0]}else b=0;return a.apply(l,arguments)}}function S(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=ra(a.prototype),b=a.apply(c,
b);return F(b)?b:c}}function yc(a,b,c){function d(){return(this&&this!==C&&this instanceof d?f:a).apply(g?c:this,arguments)}var g=b&1,f=S(a);return d}function $a(a,b,c,d){var g=-1,f=a.length,k=c.length,h=-1,e=b.length,q=zc(f-k,0),m=Array(e+q);for(d=!d;++h<e;)m[h]=b[h];for(;++g<k;)if(d||g<f)m[c[g]]=a[g];for(;q--;)m[h++]=a[g++];return m}function ab(a,b,c,d){var g=-1,f=a.length,k=-1,h=c.length,e=-1,q=b.length,m=Ac(f-h,0),y=Array(m+q);for(d=!d;++g<m;)y[g]=a[g];for(m=g;++e<q;)y[m+e]=b[e];for(;++k<h;)if(d||
g<f)y[m+c[k]]=a[g++];return y}function sa(){}function P(a){this.__wrapped__=a;this.__actions__=[];this.__dir__=1;this.__filtered__=!1;this.__iteratees__=[];this.__takeCount__=4294967295;this.__views__=[]}function Bc(){}function Q(a,b){this.__wrapped__=a;this.__actions__=[];this.__chain__=!!b;this.__index__=0;this.__values__=l}function bb(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function fa(a){if(L(a)&&!A(a)&&!(a instanceof P)){if(a instanceof Q)return a;if(Cc.call(a,
"__wrapped__")){if(a instanceof P)a=a.clone();else{var b=new Q(a.__wrapped__,a.__chain__);b.__actions__=bb(a.__actions__);b.__index__=a.__index__;b.__values__=a.__values__;a=b}return a}}return new Q(a)}function Dc(a,b){for(var c=-1,d=null==a?0:a.length;++c<d&&!1!==b(a[c],c,a););return a}function Ec(a,b){Dc(Fc,function(c){var d="_."+c[0];if(c=b&c[1]){if(c=null==a?0:a.length){if(d===d)a:{c=-1;for(var g=a.length;++c<g;)if(a[c]===d)break a;c=-1}else a:{c=a.length;for(g=-1;++g<c;){var f=a[g];if(f!==f){c=
g;break a}}c=-1}c=-1<c}c=!c}c&&a.push(d)});return a.sort()}function cb(a,b,c){b+="";var d;d=(d=b.match(Gc))?d[1].split(Hc):[];c=Ec(d,c);if(d=c.length){var g=d-1;c[g]=(1<d?"\x26 ":"")+c[g];c=c.join(2<d?", ":" ");b=b.replace(Ic,"{\n/* [wrapped with "+c+"] */\n")}return db(a,b)}function eb(a,b,c,d,g,f,k,h,e,q){var m=b&8,y=m?k:l;k=m?l:k;var u=m?f:l;f=m?l:f;b=(b|(m?32:64))&~(m?64:32);b&4||(b&=-4);g=[a,b,g,u,y,f,k,h,e,q];c=c.apply(l,g);b:for(h=a.name+"",e=fb[h],q=Jc.call(fb,h)?e.length:0;q--;)if(m=e[q],
y=m.func,null==y||y==a){h=m.name;break b}e=fa[h];"function"==typeof e&&h in P.prototype?a===e?h=!0:(h=gb(e),h=!!h&&a===h[0]):h=!1;h&&hb(c,g);c.placeholder=d;return cb(c,a,b)}function T(a,b){for(var c=-1,d=a.length,g=0,f=[];++c<d;){var k=a[c];if(k===b||"__lodash_placeholder__"===k)a[c]="__lodash_placeholder__",f[g++]=c}return f}function ta(a,b,c,d,g,f,k,h,e,q){function m(){for(var v=arguments.length,n=Array(v),x=v;x--;)n[x]=arguments[x];if(r){var z=m.placeholder,A,x=n.length;for(A=0;x--;)n[x]===z&&
++A}d&&(n=$a(n,d,g,r));f&&(n=ab(n,f,k,r));v-=A;if(r&&v<q)return z=T(n,z),eb(a,b,ta,m.placeholder,c,n,z,h,e,q-v);z=u?c:this;x=p?z[a]:a;v=n.length;if(h){A=n.length;for(var B=Kc(h.length,A),D=bb(n);B--;){var E=h[B];n[B]=ka(E,A)?D[E]:l}}else Ub&&1<v&&n.reverse();y&&e<v&&(n.length=e);this&&this!==C&&this instanceof m&&(x=w||S(x));return x.apply(z,n)}var y=b&128,u=b&1,p=b&2,r=b&24,Ub=b&512,w=p?l:S(a);return m}function Lc(a,b,c){function d(){for(var f=arguments.length,k=Array(f),e=f,t=d.placeholder;e--;)k[e]=
arguments[e];e=3>f&&k[0]!==t&&k[f-1]!==t?[]:T(k,t);f-=e.length;return f<c?eb(a,b,ta,d.placeholder,l,k,e,l,l,c-f):qa(this&&this!==C&&this instanceof d?g:a,this,k)}var g=S(a);return d}function Mc(a,b,c,d){function g(){for(var b=-1,e=arguments.length,q=-1,m=d.length,y=Array(m+e),l=this&&this!==C&&this instanceof g?k:a;++q<m;)y[q]=d[q];for(;e--;)y[q++]=arguments[++b];return qa(l,f?c:this,y)}var f=b&1,k=S(a);return g}function Nc(a){if("number"==typeof a)return a;if(ca(a))return ib;F(a)&&(a="function"==
typeof a.valueOf?a.valueOf():a,a=F(a)?a+"":a);if("string"!=typeof a)return 0===a?a:+a;a=a.replace(Oc,"");var b=Pc.test(a);return b||Qc.test(a)?Rc(a.slice(2),b?2:8):Sc.test(a)?ib:+a}function jb(a){a?(a=Nc(a),a=a===kb||a===-kb?1.7976931348623157E308*(0>a?-1:1):a===a?a:0):a=0===a?a:0;var b=a%1;return a===a?b?a-b:a:0}function Tc(a,b,c,d){for(var g=-1,f=null==a?0:a.length;++g<f;){var k=a[g];b(d,k,c(k),a)}return d}function Uc(a,b,c,d){Xa(a,function(a,f,k){b(d,a,c(a),k)});return d}var lb={queueComplete:!0},
ua=function(){function a(b,a,d){var g=this;this.player=b;this.frame=a;this.assets=[];this.currentIndex=0;this.eventEmitter=new d.EventEmitter;this.player.on("playbackComplete",function(){g.currentIndex++;g.doPlay()})}a.prototype.play=function(b){b?this.player.play(b):this.player.play();return this};a.prototype.getCurrentTime=function(){return this.player.getCurrentTime()};a.prototype.setCurrentTime=function(b){this.player.setCurrentTime(b)};a.prototype.mute=function(){this.player.mute()};a.prototype.unmute=
function(){this.player.unmute()};a.prototype.isMuted=function(){return this.player.isMuted()};a.prototype.resume=function(b){this.player.resume(b);return this};a.prototype.pause=function(){this.player.pause();return this};a.prototype.next=function(){this.player.stop();this.doPlay();return this};a.prototype.previous=function(){this.player.stop();this.currentIndex--;this.doPlay();return this};a.prototype.seek=function(b){this.player.seek(b);return this};a.prototype.enqueue=function(b,a){void 0===a&&
(a=this.assets.length);b instanceof Array?(b=b.slice(),b.splice(0,0,this.assets),Array.prototype.splice.apply(this.assets,b)):this.assets.splice(a,0,b);return this};a.prototype.dequeue=function(b){var a=this,d;if("number"===typeof b)d=[b];else if(b instanceof Array){var g=b.map(function(b){return b.contentId});d=this.assets.map(function(b){return g.indexOf(b.contentId)}).filter(function(b){-1!=b})}else d=[this.assets.map(function(b,a){return a}).filter(function(d){a.assets[d].contentId==b.contentId})[0]];
for(var f=0,k=d.length;f<k;f++)this.assets.splice(d[f],1);return this};a.prototype.on=function(b,a){if(lb.hasOwnProperty(b))this.eventEmitter.on(b,a);else this.player.on(b,a);return this};a.prototype.off=function(b,a){lb.hasOwnProperty(b)?this.eventEmitter.off(b,a):this.player.off(b,a);return this};a.prototype.onTime=function(b,a,d){this.player.onTime(b,a,d);return this};a.prototype.offTime=function(b,a,d){this.player.offTime(b,a,d);return this};a.prototype.onAd=function(b,a){this.player.onAd(b,a);
return this};a.prototype.offAd=function(b,a){this.player.offAd(b,a);return this};a.prototype.show=function(){return this};a.prototype.hide=function(){return this};a.prototype.getAssets=function(){return this.assets};a.prototype.getCurrentAssetIndex=function(){return this.currentIndex-1};a.prototype.getPosition=function(){return this.player.getPosition()};a.prototype.isPlaying=function(){return this.player.isPlaying()};a.prototype.isPaused=function(){return this.player.isPaused()};a.prototype.getVersion=
function(){return this.player.getVersion()};a.prototype.getFlashVersion=function(){return this.player.getFlashVersion()};a.prototype.getRendererType=function(){return this.player.getRendererType()};a.prototype.destroy=function(){var b=this;this.player.destroy();this.frame.style.display="none";setTimeout(function(){b.frame.parentNode.removeChild(b.frame)},500)};a.prototype.doPlay=function(){var b=this.player.getCurrent();b?this.assets[this.currentIndex].contentId==b.contentId?this.player.play():this.player.play(this.assets[this.currentIndex]):
this.assets[this.currentIndex]&&this.player.play(this.assets[this.currentIndex])};return a}(),va=function(){function a(b,a){var d=this;this.libs=a;this.commands=[];b.then(function(b){d.playerInstance=b;d.executeCommands()})}a.prototype.executeCommands=function(){for(var b=0;b<this.commands.length;b++)this.commands[b](this.playerInstance)};a.prototype.play=function(b){this.playerInstance?this._play(b,this.playerInstance):this.commands.push(this.libs._partial(this._play,b));return this};a.prototype.mute=
function(){this.playerInstance?this._mute(this.playerInstance):this.commands.push(this.libs._partial(this._mute))};a.prototype.unmute=function(){this.playerInstance?this._unmute(this.playerInstance):this.commands.push(this.libs._partial(this._unmute))};a.prototype.isMuted=function(){if(this.playerInstance)return this._isMuted(this.playerInstance);this.commands.push(this.libs._partial(this._isMuted));return!0};a.prototype.getCurrentTime=function(){if(this.playerInstance)return this._getCurrentTime(this.playerInstance);
this.commands.push(this.libs._partial(this._getCurrentTime));return 0};a.prototype.setCurrentTime=function(b){this.playerInstance?this._setCurrentTime(b,this.playerInstance):this.commands.push(this.libs._partial(this._setCurrentTime,b))};a.prototype.pause=function(){this.playerInstance?this._pause(this.playerInstance):this.commands.push(this._pause);return this};a.prototype.resume=function(b){this.playerInstance?this._resume(this.playerInstance,b):this.commands.push(this.libs._partial(this.pause,
b));return this};a.prototype.stop=function(){this.playerInstance?this._stop(this.playerInstance):this.commands.push(this._stop);return this};a.prototype.seek=function(b){this.playerInstance?this._seek(b,this.playerInstance):this.commands.push(this.libs._partial(this._seek,b));return this};a.prototype.on=function(b,a){this.playerInstance?this._on(b,a,this.playerInstance):this.commands.push(this.libs._partial(this._on,b,a));return this};a.prototype.off=function(b,a){this.playerInstance?this._off(b,
a,this.playerInstance):this.commands.push(this.libs._partial(this._off,b,a));return this};a.prototype.onTime=function(b,a,d){this.playerInstance?this._onTime(b,a,d,this.playerInstance):this.commands.push(this.libs._partial(this._onTime,b,a,d));return this};a.prototype.offTime=function(b,a,d){this.playerInstance?this._offTime(b,a,d,this.playerInstance):this.commands.push(this.libs._partial(this._offTime,b,a,d));return this};a.prototype.onAd=function(b,a){this.playerInstance?this._onAd(b,a,this.playerInstance):
this.commands.push(this.libs._partial(this._onAd,b,a));return this};a.prototype.offAd=function(b,a){this.playerInstance?this._offAd(b,a,this.playerInstance):this.commands.push(this.libs._partial(this._offAd,b,a));return this};a.prototype.getCurrent=function(){if(this.playerInstance)return this.playerInstance.getCurrent()};a.prototype.getPosition=function(){return this.playerInstance?this.playerInstance.getPosition():0};a.prototype.isPlaying=function(){return this.playerInstance?this.playerInstance.isPlaying():
!1};a.prototype.isPaused=function(){return this.playerInstance?this.playerInstance.isPaused():!1};a.prototype.getVersion=function(){return this.playerInstance?this.playerInstance.getVersion():""};a.prototype.getFlashVersion=function(){return this.playerInstance?this.playerInstance.getFlashVersion():""};a.prototype.getRendererType=function(){return this.playerInstance?this.playerInstance.getRendererType():""};a.prototype.destroy=function(){this.playerInstance&&this.playerInstance.destroy();this.playerInstance=
null};a.prototype._play=function(b,a){b?a.play(b):a.play()};a.prototype._mute=function(b){b.mute()};a.prototype._unmute=function(b){b.unmute()};a.prototype._isMuted=function(b){return b.isMuted()};a.prototype._getCurrentTime=function(b){return b.getCurrentTime()};a.prototype._setCurrentTime=function(b,a){a.setCurrentTime(b)};a.prototype._pause=function(b){b.pause()};a.prototype._stop=function(b){b.stop()};a.prototype._resume=function(b,a){b.resume(a)};a.prototype._seek=function(b,a){a.seek(b)};a.prototype._on=
function(b,a,d){d.on(b,a)};a.prototype._off=function(b,a,d){d.off(b,a)};a.prototype._onTime=function(b,a,d,g){g.onTime(b,a,d)};a.prototype._offTime=function(b,a,d,g){g.offTime(b,a,d)};a.prototype._onAd=function(b,a,d){d.onAd(b,a)};a.prototype._offAd=function(b,a,d){d.offAd(b,a)};a.prototype._destroy=function(b){b.destroy()};return a}(),Vc=function(){function a(b,a,d,g){var f=this;this.libs=g;this.isFullScreen=!1;this.eventEmitter=new g.EventEmitter;this.currentAsset=d;this.initHandlers();a.bindings=
{ended:function(){return f.eventHandlers.onPlaybackComplete()},playing:function(){return f.eventHandlers.onPlaybackStart()},screenchange:function(){return f.eventHandlers.onScreenChange()},fullscreen:function(){return f.eventHandlers.onFullScreen()}};this.airy=b.embed(a);this.eventEmitter.emit("playerLoaded")}a.prototype.play=function(b){!b||this.currentAsset&&b.contentId==this.currentAsset.contentId||(b.eventTimestamp||(b.eventTimestamp=Date.now()),this.airy.loadMedia({mediaSourceInfo:[b.videoUrl],
contentId:b.contentId,vendorCode:b.vendorCode,eventTimestamp:b.eventTimestamp,slateImages:{preloadSlate:b.imageUrl?b.imageUrl:""}}),this.currentAsset=b);b?this.airy.play({eventTimestamp:b.eventTimestamp,isAsync:!0,contentId:b.contentId}):this.airy.play({isAsync:!0,contentId:this.currentAsset.contentId});return this};a.prototype.pause=function(){this.airy.pause();return this};a.prototype.resume=function(b){b?this.airy.play({eventTimestamp:b,isAsync:!0}):this.airy.play({isAsync:!0});return this};a.prototype.stop=
function(){this.airy.pause();this.currentAsset=l;return this};a.prototype.seek=function(b){this.airy.seek(b);return this};a.prototype.on=function(b,a){this.eventEmitter.on(b,a);return this};a.prototype.off=function(b,a){return this};a.prototype.onTime=function(b,a,d){return this};a.prototype.offTime=function(b,a,d){return this};a.prototype.onAd=function(b,a){return this};a.prototype.offAd=function(b,a){return this};a.prototype.getCurrent=function(){return this.currentAsset};a.prototype.getPosition=
function(){return 0};a.prototype.isPlaying=function(){return this.airy.isPlaying()};a.prototype.isPaused=function(){return!this.airy.isPlaying()};a.prototype.getVersion=function(){return"2"};a.prototype.getFlashVersion=function(){return""};a.prototype.getRendererType=function(){return this.airy.getRendererType()};a.prototype.mute=function(){};a.prototype.unmute=function(){};a.prototype.isMuted=function(){return!1};a.prototype.getCurrentTime=function(){return 0};a.prototype.setCurrentTime=function(b){};
a.prototype.destroy=function(){this.airy.detach();this.airy.unbind("ended",this.eventHandlers.onPlaybackComplete);this.airy.unbind("playing",this.eventHandlers.onPlaybackStart);this.airy.unbind("screenchange",this.eventHandlers.onScreenChange);this.airy.unbind("fullscreen",this.eventHandlers.onFullScreen);this.airy=null};a.prototype.initHandlers=function(){var b=this;this.eventHandlers={onPlaybackComplete:function(){return b.player_onPlaybackComplete()},onPlaybackStart:function(){return b.player_onPlaybackStart()},
onScreenChange:function(){return b.player_onScreenChange()},onFullScreen:function(){return b.player_onFullScreen()}}};a.prototype.player_onPlaybackComplete=function(){var b=this.currentAsset;this.currentAsset=l;b&&(b.eventTimestamp=Date.now());this.eventEmitter.emit("playbackComplete",b)};a.prototype.player_onPlaybackStart=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};a.prototype.player_onScreenChange=function(){this.eventEmitter.emit("playerFullScreen",
this.isFullScreen);this.isFullScreen=!1};a.prototype.player_onFullScreen=function(){this.isFullScreen=!0};a.prototype.player_onPlaybackPause=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackPause",this.currentAsset)};return a}(),mb=function(){function a(){}a.prototype.createAiry2Frame=function(b){var a=Ca();b.container.appendChild(a);a.onload=function(){a.onload=null;a.contentWindow.document.open();a.contentWindow.document.write(Kb(b.airyScriptUrl,
b.airyStyleUrl,b.promiseName,"airyContainer"));a.contentWindow.document.close()};setTimeout(function(){if(a.onload)a.onload()});return a};a.prototype.createAiry3Frame=function(b){var a=Ca();b.container.appendChild(a);a.onload=function(){a.onload=null;a.contentWindow.document.open();a.contentWindow.document.write(Jb(b.airyScriptUrl,b.promiseName,"airyContainer"));a.contentWindow.document.close()};setTimeout(function(){if(a.onload)a.onload()});return a};return a}(),Wc=function(){function a(b){this.deps=
b;this.loader=new mb}a.prototype.create=function(b){var a=this,d="https://images-na.ssl-images-amazon.com/images/G/01/vap/video/airy2/prod/"+b.airy2Version+"/js/airy.ads."+(b.airyDebug?"debug.":"")+"js",g="https://images-na.ssl-images-amazon.com/images/G/01/vap/video/airy2/prod/"+b.airy2Version+"/css/beacon.css",f="https://images-na.ssl-images-amazon.com/images/G/01/vap/video/airy2/prod/"+b.airy2Version+"/css/aries._TTW_.css",k=B(),e=new this.deps.promise(function(b,a){w[k]={resolve:b,reject:a}}),
d=this.loader.createAiry2Frame({airyScriptUrl:d,airyStyleUrl:b.usePseudoFullscreen?f:g,container:b.container||document.getElementById(b.containerId),promiseName:k}),e=e.then(function(d){var f="https://images-na.ssl-images-amazon.com/images/G/01/vap/video/airy2/prod/"+b.airy2Version+"/skins/aries._TTW_.js",g=b.videoAds;g.isEngineEnabled=b.videoAds.isEngineEnabled;f={contentId:""+b.initialVideo.contentId,customerId:b.customerId,desiredMode:b.desiredMode||"hybrid",disabledViewIds:b.disabledViewIds,foresterMetadataParams:{client:b.requestMetadata.clientId,
marketplaceId:b.requestMetadata.marketplaceId,method:b.requestMetadata.method,requestId:b.requestMetadata.requestId,session:b.requestMetadata.sessionId},mediaRequiresUserAction:b.mediaRequiresUserAction,mediaSourceInfo:[""+b.initialVideo.videoUrl],pageAsin:b.requestMetadata.pageAsin,parentId:"airyContainer",persistControlsDuringAdUX:b.persistControlsDuringAdUX,skinUrl:b.usePseudoFullscreen?f:"",usePseudoFullscreen:b.usePseudoFullscreen,vendorCode:b.initialVideo.vendorCode,videoAds:g};b.initialVideo.imageUrl&&
(f.slateImages={preloadSlate:b.initialVideo.imageUrl});b.supportsInlinePlayback&&(f.supportsInlinePlayback=b.supportsInlinePlayback);b.eventTimestamp&&(f.eventTimestamp=b.eventTimestamp);b.requestMetadata.instance&&(f.foresterMetadataParams.instance=b.requestMetadata.instance);return new Vc(d,f,b.initialVideo,a.deps)});return new ua(new va(e,this.deps),d,this.deps)};return a}(),Xc=function(){function a(b,a,d,g){var f=this;this.libs=g;this.eventEmitter=new g.EventEmitter;this.currentAsset=d;this.initHandlers();
a.bindings={ended:function(){return f.eventHandlers.onPlaybackComplete()},playing:function(){return f.eventHandlers.onPlaybackStart()}};this.airy=b.embed(a);this.eventEmitter.emit("playerLoaded")}a.prototype.play=function(b){!b||this.currentAsset&&b.contentId==this.currentAsset.contentId||(this.airy.loadMedia({contentId:b.contentId,vendorCode:b.vendorCode}),this.currentAsset=b);b&&b.eventTimestamp?this.airy.play({contentId:b.contentId,eventTimestamp:b.eventTimestamp}):this.airy.play();return this};
a.prototype.pause=function(){return this};a.prototype.resume=function(b){return this};a.prototype.stop=function(){this.pause();this.currentAsset=l;return this};a.prototype.seek=function(b){return this};a.prototype.on=function(b,a){this.eventEmitter.on(b,a);return this};a.prototype.off=function(b,a){this.eventEmitter.off(b,a);return this};a.prototype.onTime=function(b,a,d){return this};a.prototype.offTime=function(b,a,d){return this};a.prototype.onAd=function(b,a){return this};a.prototype.offAd=function(b,
a){return this};a.prototype.mute=function(){};a.prototype.unmute=function(){};a.prototype.isMuted=function(){return!1};a.prototype.getCurrentTime=function(){return 0};a.prototype.setCurrentTime=function(b){};a.prototype.getCurrent=function(){return this.currentAsset};a.prototype.getPosition=function(){return 0};a.prototype.isPlaying=function(){return!0};a.prototype.isPaused=function(){return!1};a.prototype.getVersion=function(){return"3"};a.prototype.getFlashVersion=function(){return""};a.prototype.getRendererType=
function(){return""};a.prototype.destroy=function(){this.airy.unbind("ended",this.eventHandlers.onPlaybackComplete);this.airy.unbind("playing",this.eventHandlers.onPlaybackStart);this.airy.detach()};a.prototype.initHandlers=function(){var b=this;this.eventHandlers={onPlaybackComplete:function(){return b.player_onPlaybackComplete()},onPlaybackStart:function(){return b.player_onPlaybackStart()}}};a.prototype.player_onPlaybackComplete=function(){var b=this.currentAsset;this.currentAsset=l;b&&(b.eventTimestamp=
Date.now());this.eventEmitter.emit("playbackComplete",b)};a.prototype.player_onPlaybackStart=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};a.prototype.player_onPlaybackPause=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackPause",this.currentAsset)};return a}(),Yc=function(){function a(b){this.deps=b;this.loader=new mb}a.prototype.create=function(b){var a=
this,d=B(),g=new this.deps.promise(function(b,a){w[d]={resolve:b,reject:a}}),f=this.loader.createAiry3Frame({airyScriptUrl:b.airy3ScriptUrl||"https://d2tz3plrpnfrv0.cloudfront.net/airy/prod/latest/airy.min.js",container:b.container||document.getElementById(b.containerId),promiseName:d}),g=g.then(function(d){var f=b.videoAds;f.isEngineEnabled=b.videoAds.isEngineEnabled;f={disabledViewIds:b.disabledViewIds,parentId:"airyContainer",foresterMetadataParams:{client:b.requestMetadata.clientId,marketplaceId:b.requestMetadata.marketplaceId,
method:b.requestMetadata.method,requestId:b.requestMetadata.requestId,session:b.requestMetadata.sessionId},videoAds:f,bindings:{},contentId:""+b.initialVideo.contentId,pageAsin:b.requestMetadata.pageAsin,avPlayerAssetUrl:"https://avodassets-a.akamaihd.net/playback/web_player/webplayer.js"};b.customerId&&"0"!=b.customerId&&(f.customerId=b.customerId);return new Xc(d,f,b.initialVideo,a.deps)});return new ua(new va(g,this.deps),f,this.deps)};return a}(),Zc=function(){function a(b,a,d,g){this.libs=g;
this.eventEmitter=new g.EventEmitter;this.currentAsset=d;this.initHandlers();d=document.getElementById(a.parentId);g=document.createElement("video");var f=a.parentId+"-element";g.id=f;g.className="video-js";g.setAttribute("playsinline","true");a.shouldDisableControls||g.setAttribute("controls","true");a.shouldAutoplay&&g.setAttribute("autoplay","true");a.shouldStartMuted&&g.setAttribute("muted","true");d.appendChild(g);var e=this;b.embedPromise(f,a,{player:{techOrder:a.twitchCore?["TwitchWhiteLabel",
"html5"]:["html5"]}}).then(function(d){e.videoJS=d;document.getElementById(f).setAttribute("style","width:100%; height:100%;");e.videoJS.poster(a.posterSource);e.videoJS.src(a.mediaSourceInfo[0]);e.vseMetrics=b.metrics(e.videoJS);a.videoAds&&a.videoAds.isEngineEnabled&&(e.vseAds=b.ads(e.videoJS));e.videoJS.on("ended",function(){e.eventHandlers.onPlaybackComplete()});e.videoJS.on("playing",function(){e.eventHandlers.onPlaybackStart()});e.eventEmitter.emit("playerLoaded")})}a.prototype.play=function(a){!a||
this.currentAsset&&a.contentId==this.currentAsset.contentId||(this.videoJS.poster(a.imageUrl),this.videoJS.posterImage.show(),this.vseMetrics.setContentId(a.contentId),this.vseAds&&(this.vseAds.setContentId(a.contentId),this.vseAds.setVendorCode(a.vendorCode)),this.videoJS.src(a.videoUrl),this.currentAsset=a);a=a&&a.eventTimestamp?a.eventTimestamp:Date.now();this.vseMetrics.setPageLoadStartTimestamp(a);return this.videoJS.play()};a.prototype.muted=function(a){return this.videoJS.muted(a)};a.prototype.mute=
function(){this.videoJS.muted(!0)};a.prototype.unmute=function(){this.videoJS.muted(!1)};a.prototype.isMuted=function(){return this.videoJS.muted()};a.prototype.getCurrentTime=function(){return this.videoJS.currentTime()};a.prototype.setCurrentTime=function(a){this.videoJS.currentTime(a)};a.prototype.pause=function(){this.videoJS.pause();return this};a.prototype.resume=function(a){this.videoJS.play();return this};a.prototype.seek=function(a){this.videoJS.currentTime(a);return this};a.prototype.stop=
function(){this.videoJS.pause();this.currentAsset=l;return this};a.prototype.on=function(a,c){this.eventEmitter.on(a,c);return this};a.prototype.off=function(a,c){return this};a.prototype.onTime=function(a,c,d){return this};a.prototype.offTime=function(a,c,d){return this};a.prototype.onAd=function(a,c){return this};a.prototype.offAd=function(a,c){return this};a.prototype.getCurrent=function(){return this.currentAsset};a.prototype.getPosition=function(){return this.videoJS.currentTime()};a.prototype.isPlaying=
function(){return!this.videoJS.paused()};a.prototype.isPaused=function(){return this.videoJS.paused()};a.prototype.getVersion=function(){return"VJS"};a.prototype.getFlashVersion=function(){return""};a.prototype.getRendererType=function(){return""};a.prototype.destroy=function(){this.vseMetrics.publishBeforeDispose();this.videoJS.off("ended",this.eventHandlers.onPlaybackComplete);this.videoJS.dispose();this.videoJS=null};a.prototype.initHandlers=function(){var a=this;this.eventHandlers={onPlaybackComplete:function(){return a.player_onPlaybackComplete()},
onPlaybackStart:function(){return a.player_onPlaybackStart()}}};a.prototype.player_onPlaybackComplete=function(){if(!this.vseAds||!this.vseAds.isAdPlaying()){var a=this.currentAsset;this.currentAsset=l;a&&(a.eventTimestamp=Date.now());this.eventEmitter.emit("playbackComplete",a)}};a.prototype.player_onPlaybackStart=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};return a}(),$c=function(){function a(a){this.deps=
a}a.prototype.create=function(a){var c=this,d=B(),g=new this.deps.promise(function(a,b){w[d]={resolve:a,reject:b}});z.when("brila").execute("construct-player",function(a){w[d].resolve(a)});var f=document.getElementById(a.containerId),e=a.containerId+"-container";f.innerHTML='\x3cdiv id\x3d"'+e+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e';f=(new this.deps.promise(function(d,f){g.then(function(f){var g=new Zc(f,Lb(a,e),a.initialVideo,c.deps);g.on("playerLoaded",function(){d(g)})})})).then(function(a){return a});
return new ua(new va(f,this.deps),document.getElementById(e),this.deps)};return a}(),ad=function(){function a(a){this.deps=a;this.a2factory=new Wc(a);this.a3factory=new Yc(a);this.brilafactory=new $c(a)}a.prototype.create=function(a){switch(a.airyVersion){default:a=this.a2factory.create(a);break;case "3":a=this.a3factory.create(a);break;case "VideoJS":a=this.brilafactory.create(a)}return a};return a}(),bd=function(){function a(a,c){void 0===c&&(c={refTagRecorderEndPoint:"/gp/mobile/tag/",retryLimit:3});
this.A=a;this.config=c}a.prototype.emitRefTag=function(a,c,d){void 0===d&&(d=0);if(!(d>=this.config.retryLimit)){var g=this;this.A.post(this.config.refTagRecorderEndPoint+"ref\x3d"+a+(c.enableAssociateTag?"?tag\x3dospatk-20\x26linkCode\x3dvse\x26creativeASIN\x3d"+c.productAsin+"\x26ascsubtag\x3d"+c.contentId:""),{error:function(){g.emitRefTag(a,c,++d)}})}};return a}(),p=function(){function a(){}a.POSITIVE_VOTE="positive";a.NEGATIVE_VOTE="negative";a.NONE_VOTE="none";a.EMPTY_VOTE="";return a}(),nb=
function(){function a(a,c){this.element=a;this.videoVoteConfig=c;this.positiveVoteCount=0;this.showPositiveVotes=!1;this.negativeVoteCount=0;this.showNegativeVotes=!1;this.prompt=a.find(".vse-vote-helpful-text");this.positiveVoteText=a.find(".vse-vote-positive");this.positiveVoteIcon=a.find(".vse-vote-positive-icon");this.negativeVoteText=a.find(".vse-vote-negative");this.negativeVoteIcon=a.find(".vse-vote-negative-icon");this.previousVote=p.EMPTY_VOTE}a.prototype.getVoteCount=function(a){return a===
p.POSITIVE_VOTE?this.positiveVoteCount:a===p.NEGATIVE_VOTE?this.negativeVoteCount:0};a.prototype.setVoteCount=function(a,c){0>c&&(c=0);a===p.POSITIVE_VOTE?(this.positiveVoteCount=c,this.positiveVoteText.html(String(c))):a===p.NEGATIVE_VOTE&&(this.negativeVoteCount=c,this.negativeVoteText.html(String(c)))};a.prototype.getPreviousVote=function(){return this.previousVote};a.prototype.setPreviousVote=function(a){if(a===p.POSITIVE_VOTE)this.positiveVoteIcon.addClass("hasvoted"),this.negativeVoteIcon.removeClass("hasvoted"),
0>=this.getVoteCount(p.POSITIVE_VOTE)&&this.setVoteCount(p.POSITIVE_VOTE,1);else if(a===p.NEGATIVE_VOTE)this.negativeVoteIcon.addClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(p.NEGATIVE_VOTE)&&this.setVoteCount(p.NEGATIVE_VOTE,1);else if(a===p.NONE_VOTE)this.negativeVoteIcon.removeClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted");else return;this.previousVote=a};a.prototype.setContentId=function(a){this.contentId=a};a.prototype.getContentId=function(){return this.contentId};
a.prototype.showOrHide=function(a,c,d,g){this.showPositiveVotes=a;this.showNegativeVotes=c;this.showPrompt=d;a?(this.positiveVoteText.addClass("show"),this.positiveVoteIcon.addClass("show")):(this.positiveVoteText.removeClass("show"),this.positiveVoteIcon.removeClass("show"));c?(this.negativeVoteText.addClass("show"),this.negativeVoteIcon.addClass("show")):(this.negativeVoteText.removeClass("show"),this.negativeVoteIcon.removeClass("show"));d?this.prompt.addClass("show"):this.prompt.removeClass("show");
g?this.element.addClass("show"):this.element.removeClass("show")};a.prototype.updateWithNewVote=function(a){if(a===p.POSITIVE_VOTE||a===p.NEGATIVE_VOTE){var c=a==p.POSITIVE_VOTE?p.NEGATIVE_VOTE:p.POSITIVE_VOTE,d=this.getVoteCount(a),g=this.getVoteCount(c);a===this.getPreviousVote()?(this.setPreviousVote(p.NONE_VOTE),this.setVoteCount(a,d-1)):this.getPreviousVote()!==p.EMPTY_VOTE&&this.getPreviousVote()!==p.NONE_VOTE?(this.setVoteCount(c,g-1),this.setVoteCount(a,d+1),this.setPreviousVote(a)):(this.setPreviousVote(a),
this.setVoteCount(a,d+1))}};return a}(),cd=function(){return function(a,b,c){this.contentId=a;this.positiveVoteCount=b;this.negativeVoteCount=c}}(),ob=function(){return function(a){this.name="InvalidArugmentsException";this.message=a}}();w.vseFeatures=w.vseFeatures||{};var pb=w.gatedP||{register:function(a,b,c,d,g){void 0===g&&(g=w.vseFeatures);z.now(a).execute(a+"-prereg",function(f){f||g[b]||(g[b]=!0,d.resolve(c(d)).then(function(){z.now(a).execute(a+"-reg",function(c){c||(z.log("Gated registration failed to register module!",
"ERROR",a),g[b]=!1)})}))})},declare:function(a,b,c,d){void 0===d&&(d=w.vseFeatures);z.now(a).execute(a+"-prereg",function(g){g||d[b]||(d[b]=!0,z.declare(a,c))})}},n={count:function(a,b){var c=w.ue;c&&c.count("vse:csm:"+a,b)},emitSushiMetric:function(a,b,c){var d=this;b=b||"https://unagi-na.amazon.com/1/events/com.amazon.eel.vse.metricstest.nexus";c=c||0;if(!(3<=c)){var g=JSON.stringify(a).replace(/\\\\/g,""),f={params:g,paramsFormat:"json",contentType:"application/json; charset\x3dutf-8",error:function(){d.emitSushiMetric(a,
b,++c)}},e=navigator.userAgent.match(/iPhone/i),h=!1;z.now("mash").execute("vse-detect-mshop",function(){h=!0});var t=null!==e&&h;z.when("A").execute("Emit-VSE-Metrics",function(a){navigator&&navigator.sendBeacon&&!t?navigator.sendBeacon(b,g):a.post(b,f)})}}},x=function(){function a(){}a.INSTANCE="vse-featured-products";a.PLACEMENT="rvp:videolightbox";a.PREFIX=a.INSTANCE+":"+a.PLACEMENT;a.TIME=a.PREFIX+":totalTime";a.SUCCESS_TIME=a.PREFIX+":success:totalTime";a.ERROR_TIME=a.PREFIX+":error:totalTime";
a.REQUEST=a.PREFIX+":request";a.SUCCESS=a.PREFIX+":success";a.ERROR=a.PREFIX+":error";a.TIMEOUT=a.PREFIX+":timeout";a.IMPRESSION=a.PREFIX+":impression";a.CLICK=a.PREFIX+":click";a.SIZE=a.PREFIX+":size";a.TOGGLE_UP=a.PREFIX+":toggleUp";a.TOGGLE_DOWN=a.PREFIX+":toggleDown";a.TIMEOUT_STATUS="timeout";return a}(),qb={makeApplicationSushiPayloadBuilder:function(a,b){return function(c){var d={eventSource:b.eventSource,requestId:b.requestId,sessionId:b.sessionId,placementContext:b.placementContext,marketplaceId:b.marketplaceId,
weblabIds:b.weblabIds,isInternal:b.isInternal.toString(),isRobot:b.isRobot.toString(),pageAsin:b.pageAsin,customerId:b.customerId,sessionType:b.sessionType||1,refMarkers:b.refMarkers,eventId:Mb(),timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:0,videoAsin:0};return{events:[{data:a.$.extend(d,c)}]}}}},U={fetchLatestPageState:function(a,b){a.state.replace(b,JSON.parse(a.$("script[type\x3d'a-state'][data-a-state*\x3d"+b+"]").html()));return a.state(b)}},rb=function(){function a(a,
c){this.A=a;this.videoVoteConfig=c}a.prototype.createFromContent=function(a,c){a=this.A.$("#"+a).find("[.vse-video-votes][data-contentid\x3d"+c+"]");return new nb(a,this.videoVoteConfig)};a.prototype.createFromSelector=function(a){var c=this.A.$(""+a);if(!c)throw new ob("VideoVoteContainerFactory can not find selector by the name of "+a+".");return new nb(c,this.videoVoteConfig)};a.prototype.sendVoteToRemote=function(a,c,d){var g=this,f={contentId:d,placement:this.videoVoteConfig.placementContext,
positive:a,negative:c,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page};return new this.videoVoteConfig.dependencies.promise(function(a,b){g.A.ajax("/vap/ew/subcomponent/votes/writing",{params:f,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(b){a(b)},error:function(a){n.count("votecast:failed",1);b(a)}})})};a.prototype.fetchVoteHistory=function(a){var c=this,d={contentId:a,placement:this.videoVoteConfig.placementContext,
requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page};return new this.videoVoteConfig.dependencies.promise(function(a,b){c.A.ajax("/vap/ew/subcomponent/votes/status",{params:d,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(b){a(b)},error:function(a){n.count("votehistory:failed",1);b(a)}})})};a.prototype.convertPayloadToVoteData=function(a){var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(new cd(d,
a[d].positive,a[d].negative));return c};a.prototype.fetchVoteCounts=function(a){var c=this,d={contentIds:a,placement:this.videoVoteConfig.placementContext,requestId:this.videoVoteConfig.requestId,sessionId:this.videoVoteConfig.sessionId,page:this.videoVoteConfig.page};return new this.videoVoteConfig.dependencies.promise(function(a,b){c.A.ajax("/vap/ew/subcomponent/votes",{params:d,paramsFormat:"json",crossDomain:!0,method:"POST",contentType:"application/json",success:function(d){d=c.convertPayloadToVoteData(d);
0<d.length&&a(d);b(d)},error:function(a){n.count("votegetcounts:failed",1);b(a)}})})};return a}(),dd=function(){function a(a,c,d,e,f){var k=this;this.carouselFramework=c;this.A=d;this.contentCarouselConfig=e;this.deps=f;this.vseAssets=[];this.voteContainerIndex={};this.carouselPageSize=0;this.carouselPageNumber=1;var h=d.$;this.activeCard=h([]);var t=this;this.auiCarousel=a;this.refTagRecorder=new bd(d);h("#"+e.carouselName).find(".a-carousel-heading").after(h("#"+e.carouselName).find(".vse-upload-link").removeClass("aok-hidden"));
h("#"+e.carouselName+" .vse-video-item").each(function(){t.vseAssets.push(t.getAssetSpec(h(this)))});this.vseAssetIndex=this.deps._keyBy(this.vseAssets,"contentId");e.videoVoteConfig&&(this.videoVoteContainerFactory=new rb(d,e.videoVoteConfig),d.each(this.vseAssetIndex,function(a){k.voteContainerIndex[a.contentId]=k.videoVoteContainerFactory.createFromContent(k.contentCarouselConfig.carouselName,a.contentId);a.videoVoteContainer=k.voteContainerIndex[a.contentId]}));e.showAdPlacement||h("#"+e.carouselName).delegate(".a-carousel-card a",
"click",function(a){if(h(this).closest("li").hasClass("active"))a.preventDefault();else{var b=t.vseAssetIndex[h(this).closest("li").find(".vse-video-item").data("asin")];t.markPlaying(b);b.eventTimestamp=Date.now();d.trigger("vse:contentCarousel:"+e.carouselName+":click",b);var c=t.findIndex(b);t.emitRefTag(c,t.contentCarouselConfig.refTagPrefix,b);e.isPreventDefault&&a.preventDefault()}});h("#"+e.carouselName+" .vse-carousel-item").each(function(a){var b=h(this);if(e.showAdPlacement){b.attr("href",
b.data("redirect-url")+"?ref\x3ddp_vse_rva1_pc");var c=b.parent().data("asin");b.parent().delegate(".vse-carousel-item","click",function(a){d.trigger("vse:rva:carousel:"+e.carouselName+":productClick",{relatedProductAsin:c,name:"vse.related_video_advertising.productClick"})})}else b.attr("href",b.data("redirect-url")+"?ref\x3d"+t.contentCarouselConfig.refTagPrefix+a)});d.off("a:carousel:"+e.carouselName+":change:pageSize");d.off("a:carousel:"+e.carouselName+":change:pageNumber");d.on("a:carousel:"+
e.carouselName+":change:pageSize",function(){k.carouselPageSize=k.auiCarousel.getAttr("pageSize");k.activeAsset&&k.rotateTo(k.activeAsset)});d.trigger("a:carousel:"+e.carouselName+":change:pageSize");d.on("a:carousel:"+e.carouselName+":change:pageNumber",function(){k.carouselPageNumber=k.auiCarousel.getAttr("pageNumber");d.trigger("a:carousel:"+e.carouselName+":scrollCarousel",k.carouselPageNumber,k.carouselPageSize)});d.trigger("a:carousel:"+e.carouselName+":updatePageIndex",this.carouselPageNumber,
this.carouselPageSize)}a.prototype.getplaylist=function(){return this.vseAssets.slice()};a.prototype.getActiveAsset=function(){return this.activeAsset};a.prototype.scrollTo=function(){this.A.$("#"+this.contentCarouselConfig.carouselName).animate({scrollTop:this.activeCard.offset().top-this.A.$("#"+this.contentCarouselConfig.carouselName).offset().top+this.A.$("#"+this.contentCarouselConfig.carouselName).scrollTop()})};a.prototype.rotateTo=function(a){this.markPlaying(a);this.contentCarouselConfig.isVerticalScroll&&
this.scrollTo();0!==this.carouselPageSize&&(a=this.findIndex(a),-1!==a&&(a=Math.floor(a/this.carouselPageSize)+1,this.carouselPageNumber!=a&&this.auiCarousel.gotoPage(a)))};a.prototype.changeStartingCardTo=function(a){var c=this;this.listOffset=this.findIndex(a);if(!this.contentCarouselConfig.isVerticalScroll){this.carouselFramework.initializeAll();this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(){c.rotateTo(a)});var d=this;this.A.$("#"+this.contentCarouselConfig.carouselName+
" .vse-carousel-item").each(function(a){var b=d.A.$(this);a=(a-d.listOffset+d.vseAssets.length)%d.vseAssets.length;b.attr("href",b.data("redirect-url")+"?ref\x3d"+d.contentCarouselConfig.refTagPrefix+a)})}};a.prototype.markPlaying=function(a){this.activeAsset=a;this.activeCard.removeClass("active");this.activeCard=this.vseAssetIndex[a.contentId].$el.closest("li").addClass("active")};a.prototype.findIndex=function(a){return this.vseAssets.indexOf(this.vseAssetIndex[a.contentId])};a.prototype.emitRefTag=
function(a,c,d){0<this.listOffset&&(a=(a-this.listOffset+this.vseAssets.length)%this.vseAssets.length);this.refTagRecorder.emitRefTag(c+a,d)};a.prototype.destroy=function(){this.A.$("#"+this.contentCarouselConfig.carouselName+" .a-carousel-card.active").removeClass("active")};a.prototype.updateVotingElements=function(a,c){var d=this;this.A.each(a,function(a){var b=d.vseAssetIndex[a.contentId].videoVoteContainer;b.setVoteCount(p.POSITIVE_VOTE,a.positiveVoteCount);b.setVoteCount(p.NEGATIVE_VOTE,a.negativeVoteCount);
b.showOrHide(c,c,!1,c)})};a.prototype.getAssetSpec=function(a){var c=a.data(),d=a.find(".vse-video-image").data("img"),d=d.replace("SR160,90_BG0,0,0_PKvse-overlay-play2","").replace("SR320,180_BG0,0,0_PKvse-overlay-play2","");return{contentId:c.asin,title:c.title,vendorName:c.vendorName,vendorCode:c.vendorCode,referenceUrl:c.referenceUrl,referenceLinkTitle:c.referenceTitle,videoUrl:c.videoUrl,$el:a,duration:c.duration,imageUrl:d,sponsored:c.sponsored,enableAssociateTag:c.enableAssociateTag,videoVoteContainer:this.voteContainerIndex[c.asin],
productAsin:c.productAsin}};return a}(),ed=function(){function a(a,c,d){this.carouselFramework=a;this.A=c;this.deps=d}a.prototype.create=function(a){var c=this.carouselFramework.getCarousel(this.A.$("#"+a.carouselName));if(!c)throw new ob("Carousel framework can not find carousel by the name of "+a.carouselName+".");return new dd(c,this.carouselFramework,this.A,a,this.deps)};return a}(),fd=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a){function b(){}function c(a,b,c){this.fn=
a;this.context=b;this.once=c||!1}function d(){this._events=new b;this._eventsCount=0}var e=Object.prototype.hasOwnProperty,f="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(f=!1));d.prototype.eventNames=function(){var a=[],b,c;if(0===this._eventsCount)return a;for(c in b=this._events)e.call(b,c)&&a.push(f?c.slice(1):c);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(b)):a};d.prototype.listeners=function(a,b){a=this._events[f?f+a:a];if(b)return!!a;
if(!a)return[];if(a.fn)return[a.fn];b=0;for(var c=a.length,d=Array(c);b<c;b++)d[b]=a[b].fn;return d};d.prototype.emit=function(a,b,c,d,e,g){var u=f?f+a:a;if(!this._events[u])return!1;var u=this._events[u],p=arguments.length,r,n;if(u.fn){u.once&&this.removeListener(a,u.fn,l,!0);switch(p){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,b),!0;case 3:return u.fn.call(u.context,b,c),!0;case 4:return u.fn.call(u.context,b,c,d),!0;case 5:return u.fn.call(u.context,b,c,d,e),!0;case 6:return u.fn.call(u.context,
b,c,d,e,g),!0}n=1;for(r=Array(p-1);n<p;n++)r[n-1]=arguments[n];u.fn.apply(u.context,r)}else{var v=u.length,w;for(n=0;n<v;n++)switch(u[n].once&&this.removeListener(a,u[n].fn,l,!0),p){case 1:u[n].fn.call(u[n].context);break;case 2:u[n].fn.call(u[n].context,b);break;case 3:u[n].fn.call(u[n].context,b,c);break;case 4:u[n].fn.call(u[n].context,b,c,d);break;default:if(!r)for(w=1,r=Array(p-1);w<p;w++)r[w-1]=arguments[w];u[n].fn.apply(u[n].context,r)}}return!0};d.prototype.on=function(a,b,d){b=new c(b,d||
this);a=f?f+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],b]:this._events[a].push(b):(this._events[a]=b,this._eventsCount++);return this};d.prototype.once=function(a,b,d){b=new c(b,d||this,!0);a=f?f+a:a;this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],b]:this._events[a].push(b):(this._events[a]=b,this._eventsCount++);return this};d.prototype.removeListener=function(a,c,d,e){a=f?f+a:a;if(!this._events[a])return this;if(!c)return 0===--this._eventsCount?
this._events=new b:delete this._events[a],this;var g=this._events[a];if(g.fn)g.fn!==c||e&&!g.once||d&&g.context!==d||(0===--this._eventsCount?this._events=new b:delete this._events[a]);else{for(var l=0,n=[],p=g.length;l<p;l++)(g[l].fn!==c||e&&!g[l].once||d&&g[l].context!==d)&&n.push(g[l]);n.length?this._events[a]=1===n.length?n[0]:n:0===--this._eventsCount?this._events=new b:delete this._events[a]}return this};d.prototype.removeAllListeners=function(a){a?(a=f?f+a:a,this._events[a]&&(0===--this._eventsCount?
this._events=new b:delete this._events[a])):(this._events=new b,this._eventsCount=0);return this};d.prototype.off=d.prototype.removeListener;d.prototype.addListener=d.prototype.on;d.prototype.setMaxListeners=function(){return this};d.prefixed=f;d.EventEmitter=d;"undefined"!==typeof a&&(a.exports=d)}).EventEmitter,gd=function(){function a(a,c,d,e,f,k,h,t,q){var m=this;this.wrapper=a;this.useSecondaryView=c;this.$=d;this.A=e;this.productCarouselId=f;this.showProductCarousel=k;this.customerReviewPrefix=
h;this.useVerticalLayout=t;this.videoVoteContainerFactory=q;this.prefixes=["","Customer Review: "];this.videoVoteFailure=!1;this.title=this.wrapper.find(".vse-content-title");this.titlePrefix=this.wrapper.find(".vse-content-title-prefix");this.referenceLink=this.wrapper.find("#vse-customer-review-link");this.activeVideoTitle=this.wrapper.find(".vse-active-video-heading");this.activeVideoTitlePrefix=this.wrapper.find("#vse-activevideo-crv-prefix");this.activeVideoReferenceLink=this.wrapper.find("#vse-activevideo-crv-link");
this.activeVideoVendorName=this.wrapper.find(".vse-active-video-vendorName");this.activeVideoSponsored=this.wrapper.find(".vse-active-video-sponsored");this.lbVideoCarousel=this.wrapper.find(".vse-related-videos-container");this.playerAndActiveVideoContainer=this.wrapper.find(".vse-fixedLayout");this.prefixes[1]=h+": ";k&&f!==l&&(this.productFeaturedCarousel=this.wrapper.find("#"+f));this.activeVideoCustomerProfile=this.wrapper.find("#vse-active-video-customer-profile");this.feedbackTrigger=this.wrapper.find(".vse-feedback-trigger");
this.videoVoteContainerFactory&&this.videoVoteContainerFactory.videoVoteConfig&&(this.activeVideoVoteContainer=this.videoVoteContainerFactory.createFromSelector("#vse-video-votes-lb-details"));this.lbContainer=this.wrapper.find(".vse-lb-container");this.lbLeftColumnn=this.wrapper.find(".vse-lb-left");this.lbRightColumnn=this.wrapper.find(".related-videos-section");this.lbCCHeader=this.wrapper.find(".vse-cc-header");this.lbTabContainer=this.wrapper.find(".vse-lightbox-tab");this.videoAuthor=this.wrapper.find(".vse-video-author span");
e.on("resize",function(){c&&m.updateVerticalScrollHeight();t&&m.resizeLB()});q&&q.videoVoteConfig&&(this.A.on(q.videoVoteConfig.actionPrefix+"-hide-votes",function(){m.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);m.videoVoteFailure=!0}),this.A.declarative(q.videoVoteConfig.actionPrefix+"-vote-positive","click",function(){m.castVote(p.POSITIVE_VOTE)}),this.A.declarative(q.videoVoteConfig.actionPrefix+"-vote-negative","click",function(){m.castVote(p.NEGATIVE_VOTE)}))}a.prototype.castVote=function(a){var c=
this;if(this.videoVoteContainerFactory&&this.videoVoteContainerFactory.videoVoteConfig){var d=this.activeVideoVoteContainer.getPreviousVote(),e=a===p.POSITIVE_VOTE&&d!=p.POSITIVE_VOTE,d=a===p.NEGATIVE_VOTE&&d!=p.NEGATIVE_VOTE;this.activeVideoVoteContainer.updateWithNewVote(a);this.videoVoteContainerFactory.sendVoteToRemote(e,d,this.activeVideoVoteContainer.getContentId()).then(function(d){c.videoVoteContainerFactory&&c.videoVoteContainerFactory.videoVoteConfig&&c.A.trigger(c.videoVoteContainerFactory.videoVoteConfig.actionPrefix+
"-vote-cast",a)},function(d){console.error("Failed to send vote to remote server; reverting vote in UI");c.activeVideoVoteContainer.updateWithNewVote(a)})}};a.prototype.updateProductCarouselDOM=function(a){return"undefined"!=typeof this.showProductCarousel&&this.showProductCarousel&&"undefined"!=typeof a&&""!==a?this.productFeaturedCarousel?(this.productFeaturedCarousel.css({opacity:"0"}).html(a).animate({opacity:"1"},650),0<this.productFeaturedCarousel.has("ol").has("li").length):!1:!1};a.prototype.getProductCarouselSize=
function(){return"undefined"!=typeof this.showProductCarousel&&this.showProductCarousel?this.productFeaturedCarousel.find("ol").children().length:0};a.prototype.update=function(a,c){this.updateActiveVideo(a);this.updateTitle(a,c)};a.prototype.updateActiveVideo=function(a){var c=this,d=this._isCustomerReviewVideo(a);this.activeVideoTitle.text(a.title);this.activeVideoVendorName.text(a.vendorName);a.sponsored?this.activeVideoSponsored.removeClass("vse-invisible"):this.activeVideoSponsored.addClass("vse-invisible");
var e=this.lbVideoCarousel.find("[data-asin\x3d"+a.contentId+"]").find(".vse-video-customer-profile");0<e.length?(this.activeVideoCustomerProfile.html(e.clone().removeClass("vse-hidden").html()),this.activeVideoVendorName.addClass("vse-hidden"),this.productFeaturedCarousel||this.feedbackTrigger.addClass("vse-profile-height")):(this.activeVideoCustomerProfile.html(""),this.activeVideoVendorName.removeClass("vse-hidden"),this.feedbackTrigger.removeClass("vse-profile-height"));this.useSecondaryView&&
(this.adjustLBPosition(),this.updateVerticalScrollHeight());this.activeVideoTitlePrefix.text(this.prefixes[+d]);this.activeVideoReferenceLink.attr("href",a.referenceUrl||"");this.activeVideoReferenceLink.text(a.title);d?(this.activeVideoReferenceLink.text("Customer Review: "+a.title),this.activeVideoTitle.addClass("vse-invisible"),this.activeVideoReferenceLink.removeClass("vse-invisible")):(this.activeVideoTitle.removeClass("vse-invisible"),this.activeVideoReferenceLink.addClass("vse-invisible"));
this.videoVoteContainerFactory&&this.videoVoteContainerFactory.videoVoteConfig&&!this.videoVoteFailure&&(this.updateActiveVideoContainer(a.contentId,a.videoVoteContainer.getVoteCount(p.POSITIVE_VOTE),a.videoVoteContainer.getVoteCount(p.NEGATIVE_VOTE)),a.videoVoteContainer.getPreviousVote()!==p.EMPTY_VOTE?this.activeVideoVoteContainer.setPreviousVote(a.videoVoteContainer.getPreviousVote()):this.videoVoteContainerFactory.fetchVoteHistory(a.contentId).then(function(a){c.videoVoteContainerFactory===l||
a!==p.POSITIVE_VOTE&&a!==p.NEGATIVE_VOTE&&a!==p.NONE_VOTE||(c.activeVideoVoteContainer.setPreviousVote(a),c.A.trigger(c.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-history-set",a))},function(a){console.error("Failed to retrieve video vote history for customer")}),this.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0))};a.prototype.updateActiveVideoContainer=function(a,c,d){this.activeVideoVoteContainer.setContentId(a);this.activeVideoVoteContainer.setVoteCount(p.POSITIVE_VOTE,c);this.activeVideoVoteContainer.setVoteCount(p.NEGATIVE_VOTE,
d)};a.prototype.updateTitle=function(a,c){this.title=this.$(".vse-content-title");this.useSecondaryView?this.title.text(c):(this.title.text(a.title),this.useVerticalLayout&&this.videoAuthor.text(a.vendorName),this.title.attr("title",a.title));this.useSecondaryView||(this.titlePrefix=this.$(".vse-content-title-prefix"),this.titlePrefix.text(this.prefixes[+this._isCustomerReviewVideo(a)]));c=this._isCustomerReviewVideo(a);this.referenceLink.attr("href",a.referenceUrl||"");this.referenceLink.text(a.referenceLinkTitle||
"");c?(this.referenceLink.removeClass("vse-invisible"),this.referenceLink.closest(".vse-video-title").removeClass("vse-no-cr")):(this.referenceLink.addClass("vse-invisible"),this.referenceLink.closest(".vse-video-title").addClass("vse-no-cr"));this.useVerticalLayout&&this.resizeLB()};a.prototype.resizeLB=function(){var a=this.lbLeftColumnn.outerHeight(!0),c=a-this.lbCCHeader.outerHeight(!0);this.lbContainer.height(a+this.lbTabContainer.outerHeight(!0));this.lbRightColumnn.find(".vse-vertical-scroll").css({"max-height":c})};
a.prototype.adjustLBPosition=function(){this.lbHeaderElement=this.$(".vse-lightbox-header").closest(".a-popover-header-secondary");var a=this.lbHeaderElement.height(),c=this.playerAndActiveVideoContainer.height();this.playerAndActiveVideoContainer.css("top",a);this.lbVideoCarousel.css("top",a+c)};a.prototype._isCustomerReviewVideo=function(a){return"AOD60"==a.vendorCode};a.prototype.updateVerticalScrollHeight=function(){this.lbVideoCarousel.css({"max-height":this.$(w).height()-(this.playerAndActiveVideoContainer.height()+
this.$(".vse-lightbox-wrapper .a-popover-header-secondary").height())})};a.prototype.hideShareIcons=function(a){this.useVerticalLayout||this.$("#"+a+"-popover").slideUp(200)};a.prototype.showShareIcons=function(a){this.useVerticalLayout||this.$("#"+a+"-popover").slideDown(200)};return a}(),hd=function(){function a(a){var c=this;this.config=a;this._errorCallback=function(a){c.config.A.trigger("vse:feedback:"+c.config.feedbackId+"-submit:failed",a)};this._successCallback=function(a){c.config.A.trigger("vse:feedback:"+
c.config.feedbackId+"-submit:succeeded",a)};this.config.bottomSheetFactory&&this._getAndSetBottomSheetInstance();this.feedbackInstance=a.feedback;a.feedbackId&&(a.A.on("vse:feedback:"+a.feedbackId+":showSection",function(){c._changeHeight(525)}),a.A.on("vse:feedback:"+a.feedbackId+":reset",function(){c._changeHeight(300)}),a.useVerticalLayout||a.A.declarative(a.feedbackId+"-show-options","click",function(c){c.$target.hasClass("active")?a.A.trigger("vse:feedback:"+a.feedbackId+"-show-options:close"):
a.A.trigger("vse:feedback:"+a.feedbackId+"-show-options:show");c.$target.toggleClass("active")}))}a.prototype.show=function(){this._getAndSetBottomSheetInstance()?this.bottomSheetInstance.show():this._slide("DOWN");return this};a.prototype.hide=function(){var a=this;this._getAndSetBottomSheetInstance()?setTimeout(function(){a.bottomSheetInstance.hide()},350):this._slide("UP");return this};a.prototype.reset=function(){this.feedbackInstance&&this.feedbackInstance.reset();return this};a.prototype.submit=
function(a){this.config.feedbackEndpoint?this.config.A.$.ajax({url:this.config.feedbackEndpoint,data:JSON.stringify({events:[{data:{feedback:a}}]}),type:"POST",contentType:"application/json; charset\x3dutf-8",error:this._errorCallback,success:this._successCallback}):this.config.A.post("/vap/videoFeedback",{params:a,error:this._errorCallback,success:this._successCallback});this.hide();return this};a.prototype._slide=function(a){this.config.useVerticalLayout||("UP"===a?this.config.A.$("#"+this.config.feedbackId+
"-popover").toggleClass("show-form").slideUp(200):this.config.A.$("#"+this.config.feedbackId+"-popover").toggleClass("show-form").slideDown(200))};a.prototype._changeHeight=function(a){this._getAndSetBottomSheetInstance()&&this.bottomSheetInstance.changeHeight({duration:.2,height:a})};a.prototype._getAndSetBottomSheetInstance=function(){return this.config.bottomSheetFactory?this.bottomSheetInstance?this.bottomSheetInstance:this.bottomSheetInstance=this.config.bottomSheetFactory.get(this.config.feedbackId+
"-sheet"):l};return a}(),id=function(){function a(a){var c=this;this.config=a;this.playbackCompleteHandler=function(a){return c.onPlaybackComplete(a)};this.playerFullScreenHandler=function(a){return c.onPlayerFullScreen(a)};this.firstFrameHandler=function(a){return c.onFirstFrame(a)};this.playerLoadedHandler=function(){return c.config.popover.updatePosition()};this.isContinousPlayFinished=this.socialShareIsOpen=this.feedbackIsOpen=this.lightboxPausedVideo=!1;this.lightBoxPopoverClass="vse-lightbox-wrapper";
this.productCarouselHtmlList=[];this.productCarouselInitList=[];this.productCarouselShown=[];this.isToggledToCollapse=this.doRecordProductMetrics=this.isSingleVideoCarousel=!1;this.shouldSeekVideo=!0;this.seekTime=0;var d=a.customerReview,e=a.videoVoteContainerFactory?a.videoVoteContainerFactory:l;this.dom=new gd(a.$("#"+a.popoverName+"-wrapper"),!!a.useSecondaryView,a.$,a.A,a.productCarouselId,a.showProductCarousel,d,a.useVerticalLayout,e);this.feedback=new hd(a);a.mShop&&a.mShopFactory&&(a.mShopFactory.addEventListener("appPause",
function(){c.pauseVideoIfNeeded()}),a.mShopFactory.addEventListener("appResume",function(){c.resumeVideoIfNeeded()}));a.$(".vse-scrolltotop ").click(function(){a.$(".vse-vertical-scroll").animate({scrollTop:0},300)});a.$(".vse-vertical-scroll").scroll(function(){var d=a.$(".vse-vertical-scroll").scrollTop(),e=a.A.now();if(.25<=(d-c.lastScrollTop)/(e-c.lastTimeScroll))c._collapseProductCarouselSection();else if(0==d){var g=c.activeVideoAsset?a.contentCarousel.findIndex(c.activeVideoAsset):-1;c.isToggledToCollapse&&
-1<g&&c.productCarouselInitList[g]&&c.productCarouselShown[g]&&c._expandProductCarouselSection()}c.lastScrollTop=d;c.lastTimeScroll=e});a.$(document).delegate("#"+a.popoverTriggerId,"click",function(a){return a.preventDefault()});a.A.on("a:popover:beforeHide:"+a.popoverName,function(d){c.config.mShop&&c.config.mShopFactory&&!c.config.showHeaderBar&&(c.config.mShopFactory.cancelFullscreen(),c.config.mShopFactory.dispatchEvent({type:"appOverlays.Show"}));c.feedbackIsOpen&&c.config.A.$("#"+c.config.feedbackId+
"-trigger").removeClass("active");c.feedback.hide();a.A.trigger("vse:feedback:"+a.feedbackId+"-show-options:close");c.config.showShareWidget&&(c.socialShareIsOpen&&c.config.A.$("#"+c.config.socialShareId+"-trigger").removeClass("active"),c.dom.hideShareIcons(a.socialShareId),a.A.trigger("vse:socialShare:"+a.socialShareId+"-show-icons:close"));c.hide()});a.A.on("a:popover:afterShow:"+a.popoverName,function(d){c.config.A.$(d.popover.$popover).addClass("vse-lightbox-wrapper "+a.A.$("#"+a.popoverName+
"-wrapper").data("cssClass"));c.config.A.$(d.popover.$popover).find(".a-popover-header h4.a-popover-header-content").append(c.config.A.$(d.popover.$popover).find(".a-popover-inner .vse-lightbox-header-row-marker").addClass("vse-lightbox-header").removeClass("aok-hidden"));c.config.A.$(d.popover.$popover).find(".a-popover-header-secondary h4").text("").append(c.config.A.$(d.popover.$popover).find(".a-popover-inner .vse-lightbox-header-row-marker").clone().addClass("vse-lightbox-header").removeClass("aok-hidden"));
c.config.mShop&&c.config.$(d.popover.$popover).addClass("vse-lb-mshop");c.config.useSecondaryView&&c.dom.adjustLBPosition();c.config.mShop&&c.config.mShopFactory&&!c.config.showHeaderBar?(d={successCallback:function(){c.config.A.trigger("resize",{},{width:w.innerWidth,height:w.innerHeight});c.config.mShopFactory.dispatchEvent({type:"appOverlays.Hide"})}},d.failCallback=c.handleFailFullScreen,c.config.mShopFactory.requestFullscreen(d)):c.config.A.trigger("resize",{},{width:w.innerWidth,height:w.innerHeight});
c.lastScrollTop=a.$(".vse-vertical-scroll").scrollTop();c.lastTimeScroll=a.A.now()});this.config.mShop&&!this.config.showHeaderBar&&this.config.A.$(".vse-video-metadata").delegate("#vse-activevideo-crv-link","click",function(a){a.preventDefault();var b="";a.srcElement&&(b=a.srcElement.getAttribute("href"));a={successCallback:function(){c.config.A.trigger("resize",{},{width:w.innerWidth,height:w.innerHeight});w.location.href=b}};a.failCallback=c.handleFailFullScreen;c.config.mShopFactory.cancelFullscreen(a);
c.config.mShopFactory.dispatchEvent({type:"appOverlays.Show"})});a.showProductCarousel&&(d=w.location.hostname,this.doRecordProductMetrics=a.recordProductMetrics||!1,-1!==d.indexOf("corp.amazon.com")?this.productCarouselAJAXEndpoint="https://development.amazon.com/vap/ew/":this.productCarouselAJAXEndpoint="/vap/ew/",this.productCarouselHtmlList=Array(this.config.contentCarousel.getplaylist().length),this.productCarouselInitList=Array(this.config.contentCarousel.getplaylist().length),this.productCarouselShown=
Array(this.config.contentCarousel.getplaylist().length),a.$(".vse-toggle-product-section").click(function(){return c._toggleProductCarouselSection()}),a.A.on("vse:productCarousel:"+a.productCarouselId+":click",function(d){c.pauseVideoIfNeeded();c.doRecordProductMetrics&&(n.count(x.CLICK,1),d=c._buildProductClickMetrics(d,c.activeASIN||"",c.config.playerConfig),a.A.trigger("vse:productCarousel:"+a.productCarouselId+":productClickMetrics",d))}));this.config.showShareWidget&&(a.A.declarative(""+a.socialShareActionName,
"click",function(c){c.$target.hasClass("active")?a.A.trigger("vse:socialShare:"+a.socialShareId+"-show-icons:close"):a.A.trigger("vse:socialShare:"+a.socialShareId+"-show-icons:show");c.$target.toggleClass("active")}),this.registerSocialShare(a));this.registerFeedback(a);if(a.displayCarousel)a.A.on("vse:contentCarousel:"+a.carouselConfig.carouselName+":click",function(d){a.showShareWidget&&c.config.A.state.replace("vse-social-share",{pageLevelData:{clientRef:"lb",deviceTypeRef:c.config.isMobile?"mb":
"dt"},url:"https://www.amazon.com/gp/product/"+d.contentId,image:d.imageUrl,title:d.title,description:d.title});c.getPlayer(d).play(d);c.show(d);a.showProductCarousel&&(c._updateProductCarousel(d),c._adjustLightbox())})}a.prototype.onFirstFrame=function(a){this.shouldSeekVideo&&(this.getPlayer(a).setCurrentTime(this.seekTime),this.shouldSeekVideo=!1)};a.prototype.startPlaying=function(a,c){this.isContinousPlayFinished=!1;this.getPlayer(a);this.config.popover.show();this.show(a);this.config.autoplay?
(this.seekTime=c,this.getPlayer(a).unmute(),this.getPlayer(a).play(a)):!this.config.mShop&&this.config.useSecondaryView||this.getPlayer(a).play(a);this.config.contentCarousel.changeStartingCardTo(a);this.config.showProductCarousel&&(this.config.carouselConfig||0!=this.productCarouselHtmlList.length||0!=this.productCarouselInitList.length||(this.isSingleVideoCarousel=!0),this._updateProductCarousel(a),this._adjustLightbox());return this};a.prototype.show=function(a){this.activeASIN=a.contentId;this.activeVideoAsset=
a;this.config.contentCarousel.rotateTo(a);this.dom.update(a,this.config.contentTitle);return this};a.prototype.createPlaylist=function(a){this.playlist=a;return this};a.prototype.getCarousel=function(){return this.config.contentCarousel};a.prototype.hide=function(){this.destroyPlayer();this.config.popover.hide();return this};a.prototype.handleFailFullScreen=function(){};a.prototype.hideIfPossible=function(){0==this.feedbackIsOpen&&1==this.isContinousPlayFinished&&this.hide()};a.prototype.updateVotingElements=
function(a,c){this.config.contentCarousel.updateVotingElements(a,c);c=this.activeASIN;for(var d,e=0;e<a.length;e++)if(a[e].contentId===c){d=a[e].positiveVoteCount;a=a[e].negativeVoteCount;this.dom.updateActiveVideoContainer(c,d,a);break}return this};a.prototype.getNextAsset=function(a){for(var c=0;c<this.playlist.length&&this.playlist[c].contentId!=a.contentId;c++);if(c!=this.playlist.length)return this.playlist[c+1]};a.prototype.pauseVideoIfNeeded=function(){this.player&&this.player.isPlaying()&&
(this.player.pause(),this.lightboxPausedVideo=!0)};a.prototype.resumeVideoIfNeeded=function(){this.player&&!this.player.isPlaying()&&!this.isContinousPlayFinished&&this.lightboxPausedVideo&&this.player.resume(Date.now());this.lightboxPausedVideo=!1};a.prototype.getPlayer=function(a){this.player||(this.config.autoplay&&(this.config.playerConfig.shouldStartMuted=!0),a.eventTimestamp&&(this.config.playerConfig.eventTimestamp=a.eventTimestamp),this.config.playerConfig.initialVideo=a,this.player=this.config.awaFactory.create(this.config.playerConfig),
this.player.on("playbackComplete",this.playbackCompleteHandler),this.player.on("playerLoaded",this.playerLoadedHandler),this.player.on("playerFullScreen",this.playerFullScreenHandler),this.player.on("playbackStart",this.firstFrameHandler));return this.player};a.prototype.destroyPlayer=function(){if(this.player){var a=this.player;this.player=null;a.off("playbackComplete",this.playbackCompleteHandler);a.off("playerLoaded",this.playerLoadedHandler);a.off("playerFullScreen",this.playerFullScreenHandler);
a.off("playbackStart",this.firstFrameHandler);this.shouldSeekVideo=!0;a.destroy();null==this.player}};a.prototype.onPlaybackComplete=function(a){var c=this.getNextAsset(a);c?(this.config.showShareWidget&&this.config.A.state.replace("vse-social-share",{pageLevelData:{clientRef:"lb",deviceTypeRef:this.config.isMobile?"mb":"dt"},url:"https://www.amazon.com/gp/product/"+c.contentId,image:c.imageUrl,title:c.title,description:c.title}),a.eventTimestamp&&(c.eventTimestamp=a.eventTimestamp),this.player.play(c),
this.show(c),this.config.showProductCarousel&&(this._updateProductCarousel(c),this._adjustLightbox())):(this.isContinousPlayFinished=!0,this.hideIfPossible())};a.prototype.onPlayerFullScreen=function(a){var c=this.config.$("#"+this.config.popoverName+"-wrapper"),d=this.config.$("."+this.lightBoxPopoverClass);c&&(a?(c.addClass("vse-player-fullscreen"),d.addClass("vse-lb-fullscreen")):(c.removeClass("vse-player-fullscreen"),d.removeClass("vse-lb-fullscreen")))};a.prototype.deRegisterFeedback=function(a){a.A.off("vse:feedback:"+
a.feedbackId+"-show-options:show");a.A.off("vse:feedback:"+a.feedbackId+"-show-options:close");a.A.off("a:sheet:beforeShow:"+a.feedbackId+"-sheet");a.A.off("a:sheet:beforeHide:"+a.feedbackId+"-sheet");a.A.off("a:sheet:afterHide:"+a.feedbackId+"-sheet");a.A.off("vse:feedback:"+a.feedbackId+":submit")};a.prototype.registerFeedback=function(a){var c=this;this.deRegisterFeedback(a);a.A.on("vse:feedback:"+a.feedbackId+"-show-options:show",function(){c.feedbackIsOpen=!0;c.config.showShareWidget&&c.socialShareIsOpen&&
(c.socialShareIsOpen=!1,c.dom.hideShareIcons(a.socialShareId),c.config.A.$("#"+c.config.socialShareId+"-trigger").removeClass("active"));c.pauseVideoIfNeeded();c.feedback.show()});a.A.on("vse:feedback:"+a.feedbackId+"-show-options:close",function(){c.feedbackIsOpen=!1;c.feedback.hide();c.hideIfPossible();c.resumeVideoIfNeeded()});a.A.on("a:sheet:beforeShow:"+a.feedbackId+"-sheet",function(){c.feedbackIsOpen=!0;c.pauseVideoIfNeeded()});a.A.on("a:sheet:beforeHide:"+a.feedbackId+"-sheet",function(){c.feedbackIsOpen=
!1;c.feedback.reset();c.hideIfPossible();c.resumeVideoIfNeeded()});a.A.on("a:sheet:afterHide:"+a.feedbackId+"-sheet",function(){a.mShop&&a.mShopFactory&&!a.showHeaderBar&&a.A.delay(function(){a.mShopFactory.dispatchEvent({type:"appOverlays.Hide"})},500)});a.A.on("vse:feedback:"+a.feedbackId+":submit",function(d){a.$(a.feedbackId+"-trigger").toggleClass("active");c.feedbackIsOpen=!1;c.hideIfPossible();c.resumeVideoIfNeeded();c.feedback.submit({additionalComments:d.additionalComments,airyVersion:c.player?
c.player.getVersion():"[Airy is not loaded.]",asin:c.config.playerConfig.requestMetadata.pageAsin,videoId:c.activeASIN?c.activeASIN:"",category:d.feedbackArea,rating:d.rating,url:document.location.href,userAgent:w.navigator.userAgent,feedbackTime:Date.now(),customerId:c.config.playerConfig.customerId})})};a.prototype.deRegisterSocialShare=function(a){a.A.off("vse:socialShare:"+a.socialShareId+"-show-icons:show");a.A.off("vse:socialShare:"+a.socialShareId+"-show-icons:close")};a.prototype.registerSocialShare=
function(a){var c=this;this.deRegisterSocialShare(a);a.A.on("vse:socialShare:"+a.socialShareId+"-show-icons:show",function(){c.feedbackIsOpen&&(c.feedbackIsOpen=!1,c.feedback.hide(),c.config.A.$("#"+c.config.feedbackId+"-trigger").removeClass("active"),c.resumeVideoIfNeeded());c.socialShareIsOpen=!0;c.dom.showShareIcons(a.socialShareId)});a.A.on("vse:socialShare:"+a.socialShareId+"-show-icons:close",function(){c.socialShareIsOpen=!1;c.dom.hideShareIcons(a.socialShareId)})};a.prototype._updateProductCarousel=
function(a){var c=this,d=this.config.playerConfig.customerId,e=this.config.playerConfig.requestMetadata.requestId,f=this.config.playerConfig.requestMetadata.sessionId,k=this.config.playerConfig.requestMetadata.marketplaceId,h="#"+this.config.productCarouselId,t=this.config.contentCarousel.findIndex(a);if(this.config.mShop||this.config.useSecondaryView)this.config.$(h).addClass("aok-hidden"),this.config.$("#vseProductSize").addClass("aok-hidden"),this.config.$("#vseSectionToggleIcon").addClass("aok-hidden"),
this.initProductCarousel(a,d,f,e,k,!0).then(function(a){c.dom.updateProductCarouselDOM(a)?(-1<t&&(c.productCarouselShown[t]=!0),c.config.$(h).removeClass("aok-hidden"),c.config.$("#vseToggleProductSection").removeClass("aok-hidden"),c.config.$("#vseSectionToggleIcon").removeClass("aok-hidden"),c._adjustLightbox(),a=c.dom.getProductCarouselSize(),1===a?(c.config.$("#vseProductLabelPlural").addClass("aok-hidden"),c.config.$("#vseProductSize").addClass("aok-hidden"),c.config.$("#vseProductLabelSingular").removeClass("aok-hidden")):
(c.config.$("#vseProductLabelPlural").removeClass("aok-hidden"),c.config.$("#vseProductSize").removeClass("aok-hidden"),c.config.$("#vseProductSize").html(a.toString()),c.config.$("#vseProductLabelSingular").addClass("aok-hidden")),c.isToggledToCollapse||c.config.$(".vse-product-collapsible-section").slideDown(250,function(){return c._adjustLightbox()})):(-1<t&&(c.productCarouselShown[t]=!1),c.config.$("#vseToggleProductSection").addClass("aok-hidden"),c.config.$(".vse-product-collapsible-section").slideUp(250,
function(){return c._adjustLightbox()}))})};a.prototype.initProductCarousel=function(a,c,d,e,f,k){var h=this,t=this,q=k?"Mobile":"Desktop";return new Promise(function(k){var l=t.config.contentCarousel.findIndex(a);if(-1===l)if(t.isSingleVideoCarousel)l=0,0===h.productCarouselHtmlList.length&&(h.productCarouselHtmlList=Array(1),h.productCarouselInitList=Array(1));else{k("");return}a.sponsored&&!t.isSingleVideoCarousel&&(t.productCarouselInitList[l]=!0,k(""));var p={page:"RVP",placement:"VideoLightbox",
device:q,customerId:c,sessionId:d,requestId:e,marketplaceID:f,video:{contentID:a.contentId,contentIDType:"ASIN"}};if(t.productCarouselInitList[l])k(t.productCarouselHtmlList[l]);else{h.config.$(".vse-product-collapsible-section").slideUp(250,function(){return h._adjustLightbox()});h.doRecordProductMetrics&&n.count(x.REQUEST,1);var r=t.config.A.now();t.config.$.ajax({url:h.productCarouselAJAXEndpoint+"componentbuilder",data:JSON.stringify(p),crossDomain:!0,type:"POST",contentType:"application/json; charset\x3dutf-8",
timeout:5E3}).done(function(a){if(h.doRecordProductMetrics){var b=t.config.A.now()-r;n.count(x.TIME,b);n.count(x.SUCCESS_TIME,b);n.count(x.SUCCESS,1);a&&(b=h.dom.getProductCarouselSize(),0<b&&n.count(x.SIZE,b))}t.productCarouselInitList[l]=!0;t.productCarouselHtmlList[l]=a;k(t.productCarouselHtmlList[l])}).fail(function(a,b){h.doRecordProductMetrics&&(a=t.config.A.now()-r,n.count(x.TIME,a),n.count(x.ERROR_TIME,a),n.count(x.ERROR,1),b===x.TIMEOUT_STATUS&&n.count(x.TIMEOUT,1));t.productCarouselInitList[l]=
!0;k("")})}})};a.prototype._toggleProductCarouselSection=function(){var a=this.activeVideoAsset?this.config.contentCarousel.findIndex(this.activeVideoAsset):-1;-1<a&&this.productCarouselInitList[a]&&(this.isToggledToCollapse?(this._expandProductCarouselSection(),n.count(x.TOGGLE_DOWN,1)):(this._collapseProductCarouselSection(),n.count(x.TOGGLE_UP,1)))};a.prototype._expandProductCarouselSection=function(){var a=this;this.config.$(".vse-product-collapsible-section").slideDown(250,function(){return a._adjustLightbox()});
this.config.$("#vseSectionToggleIcon").removeClass("a-icon-section-expand");this.config.$("#vseSectionToggleIcon").addClass("a-icon-section-collapse");this.isToggledToCollapse=!1;this._buildAndEmitProductImpressionMetric();this._updateProductCarousel(this.config.contentCarousel.getActiveAsset())};a.prototype._collapseProductCarouselSection=function(){var a=this;this.config.$(".vse-product-collapsible-section").slideUp(250,function(){return a._adjustLightbox()});this.config.$("#vseSectionToggleIcon").addClass("a-icon-section-expand");
this.config.$("#vseSectionToggleIcon").removeClass("a-icon-section-collapse");this.isToggledToCollapse=!0};a.prototype._adjustLightbox=function(){this.dom.adjustLBPosition();this.dom.updateVerticalScrollHeight()};a.prototype._buildAndEmitProductImpressionMetric=function(){if(this.doRecordProductMetrics){n.count(x.IMPRESSION,1);var a=this._buildProductImpressionMetrics(this.activeASIN||"",this.config.playerConfig);this.config.A.trigger("vse:productCarousel:"+this.config.productCarouselId+":productImpressionMetrics",
a)}};a.prototype._buildProductClickMetrics=function(a,c,d){return{events:[{data:{timestamp:new Date,videoWatchedAsin:c,originalPageAsin:d.requestMetadata.pageAsin,productClickedIndex:a.index,productClickedAsin:a.contentId,productClickedPrice:a.price,productClickedRating:a.rating,productClickedReviews:a.reviews,productClickedPrimeEligibility:a.primeEligibility,widgetPosition:x.PLACEMENT,widgetid:this.config.productCarouselId,marketplaceid:d.requestMetadata.marketplaceId,sessionid:d.requestMetadata.sessionId,
requestid:d.requestMetadata.requestId}}]}};a.prototype._buildProductImpressionMetrics=function(a,c){return{events:[{data:{timestamp:new Date,videoWatchedAsin:a,originalPageAsin:c.requestMetadata.pageAsin,impression:1,widgetPosition:x.PLACEMENT,widgetid:this.config.productCarouselId,marketplaceid:c.requestMetadata.marketplaceId,sessionid:c.requestMetadata.sessionId,requestid:c.requestMetadata.requestId}}]}};return a}(),jd=function(){function a(){}a.prototype.markPlaying=function(a){};a.prototype.rotateTo=
function(a){};a.prototype.changeStartingCardTo=function(a){};a.prototype.getplaylist=function(){return[]};a.prototype.getActiveAsset=function(){return{}};a.prototype.findIndex=function(a){return-1};a.prototype.destroy=function(){};a.prototype.emitRefTag=function(a,c){};a.prototype.updateVotingElements=function(a,c){};return a}(),sb=null;z.when("mash").execute(function(a){sb=a});var kd={getMash:function(){return sb}},ld=function(){return function(a){this.name="InvalidArugmentsException";this.message=
a}}(),md=function(){function a(a){this.constructorConfig=a}a.prototype.create=function(a){var c=this.constructorConfig.modalFactory.get(this.constructorConfig.$("#"+a.popoverTriggerId)),d=a.useSecondaryView?this.constructorConfig.bottomSheetFactory:null,e=a.mShop?kd.getMash():null,f=this.constructorConfig.feedbackFactory.create(a.feedbackId||""),k=this.constructorConfig.videoVoteContainerFactory?this.constructorConfig.videoVoteContainerFactory:l;if(!c)throw new ld("Cannot create popover using name "+
a.popoverName);var h=a.displayCarousel?this.constructorConfig.contentCarouselFactory.create(a.carouselConfig):new jd;return new id({popoverName:a.popoverName,popoverTriggerId:a.popoverTriggerId,playerConfig:a.playerConfig,displayCarousel:a.displayCarousel,carouselConfig:a.carouselConfig,contentTitle:a.contentTitle,useSecondaryView:a.useSecondaryView,displayActiveVideoDetails:a.displayActiveVideoDetails,popover:c,$:this.constructorConfig.$,contentCarousel:h,bottomSheetFactory:d,mShopFactory:e,feedback:f,
feedbackId:a.feedbackId,productCarouselId:a.productCarouselId,awaFactory:this.constructorConfig.awaFactory,mShop:a.mShop,A:this.constructorConfig.A,feedbackEndpoint:a.feedbackEndpoint,showHeaderBar:a.showHeaderBar,showProductCarousel:a.showProductCarousel,recordProductMetrics:a.recordProductMetrics,featProductsUrl:a.featProductsUrl,showShareWidget:a.showShareWidget,socialShareId:a.socialShareId,socialShareActionName:a.socialShareActionName,isMobile:a.isMobile,autoplay:a.autoplay,customerReview:a.customerReview,
useVerticalLayout:a.useVerticalLayout,videoVoteContainerFactory:k})};return a}(),nd=Array.prototype.splice;D.prototype.clear=function(){this.__data__=[];this.size=0};D.prototype["delete"]=function(a){var b=this.__data__;a=Y(b,a);if(0>a)return!1;a==b.length-1?b.pop():nd.call(b,a,1);--this.size;return!0};D.prototype.get=function(a){var b=this.__data__;a=Y(b,a);return 0>a?l:b[a][1]};D.prototype.has=function(a){return-1<Y(this.__data__,a)};D.prototype.set=function(a,b){var c=this.__data__,d=Y(c,a);0>
d?(++this.size,c.push([a,b])):c[d][1]=b;return this};var tb="object"==typeof global&&global&&global.Object===Object&&global,od="object"==typeof self&&self&&self.Object===Object&&self,C=tb||od||Function("return this")(),H=C.Symbol,ub=Object.prototype,Nb=ub.hasOwnProperty,Ob=ub.toString,R=H?H.toStringTag:l,Pb=Object.prototype.toString,Fa=H?H.toStringTag:l,wa=C["__core-js_shared__"],Ha=function(){var a=/[^.]+$/.exec(wa&&wa.keys&&wa.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Qb=Function.prototype.toString,
Sb=/^\[object .+?Constructor\]$/,Rb=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$\x26").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=J(C,"Map"),W=J(Object,"create"),pd=Object.prototype.hasOwnProperty,qd=Object.prototype.hasOwnProperty;K.prototype.clear=function(){this.__data__=W?W(null):{};this.size=0};K.prototype["delete"]=function(a){a=this.has(a)&&delete this.__data__[a];this.size-=a?1:0;return a};
K.prototype.get=function(a){var b=this.__data__;return W?(a=b[a],"__lodash_hash_undefined__"===a?l:a):pd.call(b,a)?b[a]:l};K.prototype.has=function(a){var b=this.__data__;return W?b[a]!==l:qd.call(b,a)};K.prototype.set=function(a,b){var c=this.__data__;this.size+=this.has(a)?0:1;c[a]=W&&b===l?"__lodash_hash_undefined__":b;return this};E.prototype.clear=function(){this.size=0;this.__data__={hash:new K,map:new (V||D),string:new K}};E.prototype["delete"]=function(a){a=Z(this,a)["delete"](a);this.size-=
a?1:0;return a};E.prototype.get=function(a){return Z(this,a).get(a)};E.prototype.has=function(a){return Z(this,a).has(a)};E.prototype.set=function(a,b){var c=Z(this,a),d=c.size;c.set(a,b);this.size+=c.size==d?0:1;return this};G.prototype.clear=function(){this.__data__=new D;this.size=0};G.prototype["delete"]=function(a){var b=this.__data__;a=b["delete"](a);this.size=b.size;return a};G.prototype.get=function(a){return this.__data__.get(a)};G.prototype.has=function(a){return this.__data__.has(a)};G.prototype.set=
function(a,b){var c=this.__data__;if(c instanceof D){var d=c.__data__;if(!V||199>d.length)return d.push([a,b]),this.size=++c.size,this;c=this.__data__=new E(d)}c.set(a,b);this.size=c.size;return this};aa.prototype.add=aa.prototype.push=function(a){this.__data__.set(a,"__lodash_hash_undefined__");return this};aa.prototype.has=function(a){return this.__data__.has(a)};var Ja=C.Uint8Array,vb=H?H.prototype:l,ja=vb?vb.valueOf:l,A=Array.isArray,rd=Object.prototype.propertyIsEnumerable,wb=Object.getOwnPropertySymbols,
Qa=wb?function(a){if(null==a)return[];a=Object(a);return Yb(wb(a),function(b){return rd.call(a,b)})}:Zb,xb=Object.prototype,sd=xb.hasOwnProperty,td=xb.propertyIsEnumerable,Ma=La(function(){return arguments}())?La:function(a){return L(a)&&sd.call(a,"callee")&&!td.call(a,"callee")},yb="object"==typeof exports&&exports&&!exports.nodeType&&exports,zb=yb&&"object"==typeof module&&module&&!module.nodeType&&module,Ab=zb&&zb.exports===yb?C.Buffer:l,na=(Ab?Ab.isBuffer:l)||$b,ac=/^(?:0|[1-9]\d*)$/,v={};v["[object Float32Array]"]=
v["[object Float64Array]"]=v["[object Int8Array]"]=v["[object Int16Array]"]=v["[object Int32Array]"]=v["[object Uint8Array]"]=v["[object Uint8ClampedArray]"]=v["[object Uint16Array]"]=v["[object Uint32Array]"]=!0;v["[object Arguments]"]=v["[object Array]"]=v["[object ArrayBuffer]"]=v["[object Boolean]"]=v["[object DataView]"]=v["[object Date]"]=v["[object Error]"]=v["[object Function]"]=v["[object Map]"]=v["[object Number]"]=v["[object Object]"]=v["[object RegExp]"]=v["[object Set]"]=v["[object String]"]=
v["[object WeakMap]"]=!1;var Bb="object"==typeof exports&&exports&&!exports.nodeType&&exports,Cb=Bb&&"object"==typeof module&&module&&!module.nodeType&&module,xa=Cb&&Cb.exports===Bb&&tb.process,ga;a:{try{ga=xa&&xa.binding&&xa.binding("util");break a}catch(a){}ga=void 0}var Db=ga&&ga.isTypedArray,Na=Db?cc(Db):bc,dc=Object.prototype.hasOwnProperty,ec=Object.prototype,gc=function(a,b){return function(c){return a(b(c))}}(Object.keys,Object),fc=Object.prototype.hasOwnProperty,hc=Object.prototype.hasOwnProperty,
ya=J(C,"DataView"),za=J(C,"Promise"),Aa=J(C,"Set"),X=J(C,"WeakMap"),ud=I(ya),vd=I(V),wd=I(za),xd=I(Aa),yd=I(X),M=N;if(ya&&"[object DataView]"!=M(new ya(new ArrayBuffer(1)))||V&&"[object Map]"!=M(new V)||za&&"[object Promise]"!=M(za.resolve())||Aa&&"[object Set]"!=M(new Aa)||X&&"[object WeakMap]"!=M(new X))M=function(a){var b=N(a);if(a=(a="[object Object]"==b?a.constructor:l)?I(a):"")switch(a){case ud:return"[object DataView]";case vd:return"[object Map]";case wd:return"[object Promise]";case xd:return"[object Set]";
case yd:return"[object WeakMap]"}return b};var Oa=M,Pa=Object.prototype.hasOwnProperty,mc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,lc=/^\w*$/;pa.Cache=E;var zd=/^\./,Ad=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bd=/\\(\\)?/g,oc=function(a){a=pa(a,function(a){500===b.size&&b.clear();return a});var b=a.cache;return a}(function(a){var b=[];zd.test(a)&&b.push("");a.replace(Ad,function(a,d,e,f){b.push(e?f.replace(Bd,"$1"):d||a)});return b}),
nc=1/0,Eb=H?H.prototype:l,Ta=Eb?Eb.toString:l,pc=1/0,Cd=function(a){return function(b,c,d){var e=-1,f=Object(b);d=d(b);for(var k=d.length;k--;){var h=d[a?k:++e];if(!1===c(f[h],h,f))break}return b}}(),Xa=function(a,b){return function(c,d){if(null==c)return c;if(!ma(c))return a(c,d);for(var e=c.length,f=b?e:-1,k=Object(c);(b?f--:++f<e)&&!1!==d(k[f],f,k););return c}}(function(a,b){return a&&Cd(a,b,ba)}),Dd=function(){function a(a,c){var d=this;this.sectionId=c;a.A.declarative(a.id+"-"+c+"-choose","click",
function(e){e.$event.stopPropagation();d.selected=e.$target;d.buttons.enable();d.selected.closest(".a-radio").hasClass(a.id+"-"+c+"-choose-other")?d.freeText.show():e.$target.parent().hasClass(a.id+"-"+c+"-text")||(d.freeText.val(""),d.freeText.hide())});this.buttons=a.buttonApi("#"+a.id+"-"+c+"-button-primary");this.choices=a.buttonApi(a.id+"-"+c);this.freeText=a.A.$("#"+a.id+"-"+c+"-content textarea")}a.prototype.reset=function(){this.selected.prop("checked",!1);this.buttons.disable();this.freeText.val("")};
a.prototype.show=function(){return this};a.prototype.hide=function(){this.reset();return this};return a}(),Ed=function(){function a(a){var c=this;this.config=a;this.payload={};this.registered=!1;this.ratingMap={"The video content is inappropriate":"inappropriate content","The video content is misleading":"misleading content","Other content-related feedback":"content other","The ad is too long":"ads are too long","The ad does not play":"ad did not play","The ad does not inform my purchase":"ad did not inform purchase",
"Other ad-related feedback":"ad other","The video does not play":"unplayable video","There is too much buffering":"too much buffering","The audio is poor or missing":"poor audio","Other technical issue":"technical other","Video is unrelated to the product":"inaccurate related items appear","Other product-related feedback":"product other"};this.A=a.A;this.id=a.id;this.endpoint=a.feedbackEndpoint;var d=this,e=""+this.id;uc(this.A.$("input[name\x3d"+e+"-options]:not(:checked)"),function(c){new Dd(a,
d.A.$(c).attr("value"))});this.buttonApi=a.buttonApi;this.registered||(this.A.declarative(e+"-options-choose","click",function(a){(a=a.$target.prop("value"))&&c.showSection(a)}),this.A.declarative(this.id+"-cancel","click",function(){return c.reset()}),this.A.declarative(this.id+"-submit","click",function(){return c.submitFeedback()}),this.registered=!0)}a.prototype.showSection=function(a){this.A.trigger("vse:feedback:"+this.id+":showSection");this.activeSection&&this.A.$(this.activeSection).attr("id")!==
this.id+"-"+a+"-content"&&this.clearForm();this.activeButtons=this.buttonApi("#"+this.id+"-"+a+"-button-primary");this.activeSection=this.A.$("#"+this.id+"-"+a+"-content").slideDown("fast");this.activeButtonSection=this.A.$("#"+this.id+"-"+a+"-buttons").removeClass("aok-hidden");this.activeText=this.A.$("#"+this.id+"-"+a+"-content textarea")};a.prototype.submitFeedback=function(){var a=this.activeSection?this.activeSection.find('input[type\x3d"radio"]:checked').siblings(".a-radio-label").text():"",
a=this.ratingMap[a]||"";this.A.trigger("vse:feedback:"+this.id+":submit",{additionalComments:this.activeText?this.activeText.val():"",feedbackArea:this.activeSection?this.activeSection.prev("[data-a-input-name\x3d"+this.id+"-options]").data("feedback-field-value"):"",rating:a});this.clearForm()};a.prototype.reset=function(){this.clearForm();this.A.trigger("vse:feedback:"+this.id+":reset");return this};a.prototype.clearForm=function(){this.activeButtonSection&&this.activeButtonSection.addClass("aok-hidden");
this.activeButtons&&this.activeButtons.disable();this.activeText&&(this.activeText.val(""),this.activeText.hide());this.activeSection&&(this.activeSection.slideUp(),this.activeSection.find('input[type\x3d"radio"]:checked').each(function(a,c){this.checked=!1}),this.activeSection.prev().find('input[type\x3d"radio"]:checked').each(function(a,c){this.checked=!1}));return this};a.prototype.hide=function(){return this};return a}(),Fd=function(){function a(a){this.config=a;this.feedbackWidgets={}}a.prototype.create=
function(a){var c=this.feedbackWidgets[a]||new Ed(this.createFeedbackConfig(a));return this.feedbackWidgets[a]=c};a.prototype.get=function(a){return this.feedbackWidgets[a]};a.prototype.createFeedbackConfig=function(a){return{A:this.config.A,dropdownApi:this.config.dropdownApi,buttonApi:this.config.buttonApi,feedbackEndpoint:this.config.feedbackEndpoint,id:a}};return a}(),Ya=Math.max,ha=function(){try{var a=J(Object,"defineProperty");a({},"",{});return a}catch(b){}}(),xc=Date.now,db=Za(ha?function(a,
b){return ha(a,"toString",{configurable:!0,enumerable:!1,value:wc(b),writable:!0})}:ea),ia=X&&new X,Fb=ia?function(a,b){ia.set(a,b);return a}:ea,Gb=Object.create,ra=function(){function a(){}return function(b){if(!F(b))return{};if(Gb)return Gb(b);a.prototype=b;b=new a;a.prototype=l;return b}}(),zc=Math.max,Ac=Math.max;P.prototype=ra(sa.prototype);P.prototype.constructor=P;var gb=ia?function(a){return ia.get(a)}:Bc,fb={},Jc=Object.prototype.hasOwnProperty;Q.prototype=ra(sa.prototype);Q.prototype.constructor=
Q;var Cc=Object.prototype.hasOwnProperty;fa.prototype=sa.prototype;fa.prototype.constructor=fa;var hb=Za(Fb),Gc=/\{\n\/\* \[wrapped with (.+)\] \*/,Hc=/,? & /,Ic=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Fc=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Kc=Math.min,Gd=Math.min,ib=0/0,Oc=/^\s+|\s+$/g,Sc=/^[-+]0x[0-9a-f]+$/i,Pc=/^0b[01]+$/i,Qc=/^0o[0-7]+$/i,Rc=parseInt,kb=1/0,Hb=Math.max,Ba=function(a,b){return db(vc(a,
b,ea),a+"")}(function(a,b){var c=T(b,Ba.placeholder),d=a,e=32,f=l,k=b,h=c,t=void 0,q=void 0;b=e&2;if(!b&&"function"!=typeof d)throw new TypeError("Expected a function");a=k?k.length:0;a||(e&=-97,k=h=l);t=t===l?t:Hb(jb(t),0);q=q===l?q:jb(q);a-=h?h.length:0;if(e&64)var m=k,n=h,k=h=l;c=b?l:gb(d);m=[d,e,f,k,h,m,n,void 0,t,q];if(c&&(f=m[1],d=c[1],e=f|d,n=128==d&&8==f||128==d&&256==f&&m[7].length<=c[8]||384==d&&c[7].length<=c[8]&&8==f,131>e||n)){d&1&&(m[2]=c[2],e|=f&1?0:4);if(f=c[3])n=m[3],m[3]=n?$a(n,
f,c[4]):f,m[4]=n?T(m[3],"__lodash_placeholder__"):c[4];if(f=c[5])n=m[5],m[5]=n?ab(n,f,c[6]):f,m[6]=n?T(m[5],"__lodash_placeholder__"):c[6];(f=c[7])&&(m[7]=f);d&128&&(m[8]=null==m[8]?c[8]:Gd(m[8],c[8]));null==m[9]&&(m[9]=c[9]);m[0]=c[0];m[1]=e}d=m[0];e=m[1];f=m[2];k=m[3];h=m[4];q=m[9]=m[9]===l?b?0:d.length:Hb(m[9]-a,0);!q&&e&24&&(e&=-25);b=e&&1!=e?8==e||16==e?Lc(d,e,q):32!=e&&33!=e||h.length?ta.apply(l,m):Mc(d,e,f,k):yc(d,e,f);return cb((c?Fb:hb)(b,m),d,e)});Ba.placeholder={};var Hd=function(a,b){return function(c,
d){var e=A(c)?Tc:Uc,f=b?b():{};return e(c,a,Wa(d,2),f)}}(function(a,b,c){"__proto__"==c&&ha?ha(a,c,{configurable:!0,enumerable:!0,value:b,writable:!0}):a[c]=b}),r=function(){function a(){}a.INSTANCE="vse:rvs";a.METRIC_TIME_TO_REGISTERED="vse:csm:vse-rel-videos-carousel:loadedAndRegistered:time";a.METRIC_TIME_TO_NOT_REGISTERED="vse:csm:vse-rel-videos-carousel:loadedNotRegistered:time";a.METRIC_INIT_CLIENT=a.INSTANCE+":init-client";a.METRIC_INIT_CLIENT_WAITING=a.INSTANCE+":init-client:waiting";a.METRIC_INIT_CLIENT_PLAYERS=
a.INSTANCE+":init-client:players";a.METRIC_PAGE_VIEW=a.INSTANCE+":page:view";a.METRIC_WIDGET_CLICK=a.INSTANCE+":widget:click";a.VIEWABLE_SECONDS=2;a.METRIC_PAGE_VIEW_MA=a.INSTANCE+":ma:page:view";a.METRIC_WIDGET_CLICK_MA=a.INSTANCE+":ma:widget:click";a.METRIC_VIDEO_VIEWABLE=a.INSTANCE+":ma:viewable";a.METRIC_VIDEO_VIEWABLE_X=a.INSTANCE+":ma:viewable:x";a.METRIC_WIDGET_VIEW=a.INSTANCE+":ma:widget:view";a.METRIC_WIDGET_SWIPE=a.INSTANCE+":ma:widget:swipe";a.METRIC_SCROLL_PTFF=a.INSTANCE+":ma:scroll:ptff";
a.METRIC_SWIPE_PTFF=a.INSTANCE+":ma:swipe:ptff";a.SLOT_NUMBERS=["one","two","three","four"];a.METRIC_PLAYER_ASYNCHRONOUS_ERROR=a.INSTANCE+":ma:error";a.PLAYER_CONTAINER_ID_PREFIX="vse-rvs-ingress-player-";a.muteButtonSrc="https://m.media-amazon.com/images/G/01/vse/Discovery/mute._CB474746454_.png";a.unmuteButtonSrc="https://m.media-amazon.com/images/G/01/vse/Discovery/unmute._CB474746442_.png";a.EMPTY_STRING="";return a}(),e={variables:{A:{},lightbox:null,ingressCarousel:null,RVA_SUSHI_URL:r.EMPTY_STRING,
buildMetricPayload:{},buildUniversalSushiPayload:{},sushiMetricsConfig:null,isVerticalScroll:!0,playHeadPosition:-1,playList:[],playStartTime:-1,rvaVideoViewRecorded:!1,rvaViewTimeoutId:-1,shouldMute:!0,universalSushiEndpoint:r.EMPTY_STRING,vsePlayerList:[],vsePlayerState:[],wasCarouselInView:!1,videoVoteContainerFactory:null,voteCountsFetched:!1},makeApplicationSushiPayloadBuilder:qb.makeApplicationSushiPayloadBuilder,emitMetric:function(a,b){if(w.ue)try{w.ue.count(a,b)}catch(c){e.logError(c,"vse-related-video-shorts-metrics",
"Failed to log CSM level metric.")}},emitSushiMetric:function(a,b){a=e.variables.buildUniversalSushiPayload({eventName:a,stringPayload:r.EMPTY_STRING,intPayload:b});n.emitSushiMetric(a,e.variables.universalSushiEndpoint)},emitViewableView:function(a){if(!(0>e.variables.playHeadPosition)){var b=e.variables.vsePlayerList[a].getPosition()-e.variables.playHeadPosition;e.variables.playHeadPosition=-1;b>=r.VIEWABLE_SECONDS&&(e.emitMetric(r.METRIC_VIDEO_VIEWABLE,1),0<=a&&a<r.SLOT_NUMBERS.length?e.emitMetric(r.METRIC_VIDEO_VIEWABLE+
":"+r.SLOT_NUMBERS[a],1):e.emitMetric(r.METRIC_VIDEO_VIEWABLE_X,1))}},findContentId:function(a,b){var c=null;e.variables.A.each(a,function(a){a.contentId===b&&(c=a)});return c},isDefined:function(a){return"undefined"!==typeof a&&null!==a},mutedPause:function(a){if(!e.variables.vsePlayerState[a])return e.variables;try{e.variables.vsePlayerList[a].pause(),e.variables.vsePlayerState[a]=!1,e.emitViewableView(a)}catch(b){e.emitMetric(r.METRIC_PLAYER_ASYNCHRONOUS_ERROR,1)}},mutedPlay:function(a){if(e.variables.vsePlayerState[a])return e.variables;
var b=e.variables.vsePlayerList[a];e.variables.vsePlayerState[a]=!0;e.variables.playHeadPosition=b.getPosition();e.variables.playStartTime=Date.now();b.play()},setPlayerState:function(a){e.variables.vsePlayerState[a]=!1},isScrolledIntoView:function(a,b){var c=a.$(w);a=c.scrollTop();var c=a+c.height(),d=b.offset().top+.4*b.height();return b.offset().top+.6*b.height()<=c&&d>=a},makeMetricPayloadBuilder:function(a){return function(b){b.sessionId=a.sessionId;b.requestId=a.requestId;b.customerId=a.customerId;
b.marketplaceId=a.marketplaceId;b.pageAsin=a.pageAsin;b.timestamp=new Date;return{events:[{data:b}]}}},registerClientEventOnce:function(a,b,c,d,g,f){f.clickHandle&&(a.off(f.clickHandle),e.voteCountsFetched=!1);f.closeHandle&&a.off(f.closeHandle);f.videoVoteCastHandle&&a.off(f.videoVoteCastHandle);f.videoVoteHistoryHandle&&a.off(f.videoVoteHistoryHandle);f.closeHandle=a.on("a:popover:beforeHide:"+c.popoverName,function(a){g.destroy()});f.clickHandle=a.on("vse:contentCarousel:"+b.carouselName+":click",
function(f){for(var g=d.getCarousel().getplaylist(),l=0,q=0;q<g.length;q++){if(g[0].contentId===f.contentId){b.autoplay&&"undefined"!==typeof e.variables.vsePlayerList[q]&&(e.mutedPause(q),e.variables.wasCarouselInView=!1,l=e.variables.vsePlayerList[q].getCurrentTime());break}g.push(g.shift())}q=qb.makeApplicationSushiPayloadBuilder(e.variables.A,e.variables.sushiMetricsConfig);c.showShareWidget&&a.state.replace("vse-social-share",{pageLevelData:{clientRef:"lb",deviceTypeRef:c.isMobile?"mb":"dt"},
url:"https://www.amazon.com/gp/product/"+f.contentId,image:f.imageUrl,title:f.title,description:f.title});e.emitMetric(r.METRIC_WIDGET_CLICK,1);e.variables.universalSushiEndpoint!==r.EMPTY_STRING&&(q=q({eventName:"rvs.widgetClick",stringPayload:r.EMPTY_STRING,intPayload:1}),n.emitSushiMetric(q,e.variables.universalSushiEndpoint));b.autoplayTriggered&&e.emitMetric(r.METRIC_WIDGET_CLICK_MA,1);d.createPlaylist(g);d.startPlaying(f,l);if(e.videoVoteContainerFactory&&c.videoVoteConfig&&!e.voteCountsFetched){f=
[];for(g=0;g<e.ingressCarousel.getplaylist().length;g++)f.push(e.ingressCarousel.getplaylist()[g].contentId);e.videoVoteContainerFactory.fetchVoteCounts(f).then(function(a){e.ingressCarousel.updateVotingElements(a,!1);e.lightbox.updateVotingElements(a,!1);e.voteCountsFetched=!0},function(a){console.error("Failed to fetch vote counts");e.variables.A.trigger(e.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes")})}});f.productClickHandle=a.on("vse:productCarousel:"+c.productCarouselId+
":productClickMetrics",function(a){n.emitSushiMetric(a,c.featProductsUrl)});f.productImpressionHandle=a.on("vse:productCarousel:"+c.productCarouselId+":productImpressionMetrics",function(a){n.emitSushiMetric(a,c.featProductsUrl)});e.videoVoteContainerFactory&&e.videoVoteContainerFactory.videoVoteConfig&&(f.videoVoteCastHandle=a.on(e.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",function(a){var b=a===p.POSITIVE_VOTE?p.NEGATIVE_VOTE:p.POSITIVE_VOTE,c=d.getCarousel().getActiveAsset().contentId,
f=e.findContentId(e.ingressCarousel.getplaylist(),c),c=e.findContentId(d.getCarousel().getplaylist(),c),b=c.videoVoteContainer.getPreviousVote()===a?"cancel:"+a:c.videoVoteContainer.getPreviousVote()===p.POSITIVE_VOTE||c.videoVoteContainer.getPreviousVote()===p.NEGATIVE_VOTE?"switch-"+b+"-to-"+a:a;null!==f&&f.videoVoteContainer.updateWithNewVote(a);null!==c&&c.videoVoteContainer.updateWithNewVote(a);e.variables.universalSushiEndpoint!==r.EMPTY_STRING&&(a=e.variables.buildUniversalSushiPayload({eventName:"rvs.videovote.castvote:"+
b,stringPayload:r.EMPTY_STRING,intPayload:1,videoAsin:c.contentId}),n.emitSushiMetric(a,e.variables.universalSushiEndpoint))}),f.videoVoteHistoryHandle=a.on(e.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-history-set",function(a){var b=d.getCarousel().getActiveAsset().contentId,c=e.findContentId(e.ingressCarousel.getplaylist(),b),b=e.findContentId(d.getCarousel().getplaylist(),b);c&&c.videoVoteContainer.setPreviousVote(a);b&&b.videoVoteContainer.setPreviousVote(a)}));return f},beginTrackingRvaViewTimer:function(){var a=
e.variables.vsePlayerList[0].getPosition();a>=r.VIEWABLE_SECONDS?(e.variables.sushiMetricsConfig&&e.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&(a=e.variables.buildMetricPayload({videoAsin:e.variables.playList[0].contentId,name:"vse.related_video_advertising.videoView"}),n.emitSushiMetric(a,e.variables.RVA_SUSHI_URL)),e.variables.rvaViewTimeoutId=-1,e.variables.rvaVideoViewRecorded=!0):e.variables.rvaViewTimeoutId=e.variables.A.delay(e.beginTrackingRvaViewTimer,1E3*(r.VIEWABLE_SECONDS-
a))},verticalScrollHandler:function(a,b,c){"undefined"!==typeof b&&(e.isScrolledIntoView(a,b)?(e.variables.wasCarouselInView||e.emitMetric(r.METRIC_WIDGET_VIEW,1),e.variables.wasCarouselInView=!0,e.variables.isVerticalScroll=!0,e.mutedPlay(c),-1!==e.variables.rvaViewTimeoutId||e.variables.rvaVideoViewRecorded||(e.variables.rvaViewTimeoutId=a.delay(e.beginTrackingRvaViewTimer,1E3*(r.VIEWABLE_SECONDS-e.variables.vsePlayerList[0].getPosition())))):(e.variables.wasCarouselInView=!1,e.mutedPause(c),-1!==
e.variables.rvaViewTimeoutId&&(clearTimeout(e.variables.rvaViewTimeoutId),e.variables.rvaViewTimeoutId=-1)))},firstFrameHandler:function(){if(!(0>e.variables.playStartTime)){var a=e.variables.isVerticalScroll?r.METRIC_SCROLL_PTFF:r.METRIC_SWIPE_PTFF,b=Date.now()-e.variables.playStartTime;e.emitMetric(a,b);e.variables.isVerticalScroll=!1;e.variables.playStartTime=-1}},createPlayer:function(a,b,c,d,g){var f=a.$.extend({},d),k=e.variables.shouldMute?r.muteButtonSrc:r.unmuteButtonSrc;d=a.$.extend({},
d.videoAds);var h=b[c];b=r.PLAYER_CONTAINER_ID_PREFIX+(c+1);var l=e.makeMetricPayloadBuilder(e.variables.sushiMetricsConfig);f.requestMetadata.method=f.requestMetadata.method.replace("vse_lb","vse_rva");f.initialVideo=h;f.containerId=b;f.shouldStartMuted=e.variables.shouldMute;f.shouldDisableControls=!0;f.airyVersion="VideoJS";f.videoAds=d;f.videoAds.isEngineEnabled=!1;a.$("#"+b).find("img").hide();a.$("#"+b).find("p").hide();e.variables.vsePlayerList[c]=g.create(f);e.variables.vsePlayerList[c].on("playbackStart",
e.firstFrameHandler);e.variables.vsePlayerList[c].on("playbackComplete",function(a){e.setPlayerState(c)});a.$("#"+b+"-container").wrap('\x3cdiv class\x3d"vse-rvs-autoplay-container"\x3e\x3c/div\x3e');a.$("#"+b+"-container").after("\x3cdiv class \x3d 'vse-rvp-overlap-player'\x3e\x3c/div\x3e\x3cimg class\x3d'vse-rvp-mutebutton' src\x3d"+k+" /\x3e");a.$("#"+b).find(".vse-rvp-overlap-player").bind("click",function(a){e.variables.sushiMetricsConfig&&e.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&
(a=l({videoAsin:h.contentId,name:"vse.related_video_advertising.videoClick"}),n.emitSushiMetric(a,e.variables.RVA_SUSHI_URL))});a.$("#"+b).find(".vse-rvp-mutebutton").bind("click",function(b){b.stopPropagation();b.preventDefault();b=0;for(var c=e.variables.vsePlayerList;b<c.length;b++){var d=c[b];if("undefined"===typeof d)break;d.isMuted()?(e.variables.shouldMute=!1,a.$(".vse-rvp-mutebutton").attr("src",r.unmuteButtonSrc),d.unmute(),e.variables.sushiMetricsConfig&&e.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&
(d=l({name:"vse.related_video_advertising.unmuteClick",videoAsin:h.contentId}),n.emitSushiMetric(d,e.variables.RVA_SUSHI_URL))):(e.variables.shouldMute=!0,a.$(".vse-rvp-mutebutton").attr("src",r.muteButtonSrc),d.mute())}})},AutoPlayInitialization:function(a,b,c,d){for(var g=a.now(),f=0;f<Math.min(2,e.variables.playList.length);f++)e.createPlayer(a,e.variables.playList,f,c,d);e.variables.vsePlayerList[0].on("playbackComplete",function(b){e.mutedPlay(0);e.variables.rvaVideoViewRecorded=!1;a.delay(e.beginTrackingRvaViewTimer,
r.VIEWABLE_SECONDS)});var k=0,h=0;a.on("a:carousel:"+b.carouselName+":updatePageIndex",function(a,b){k=h;h=(a-1)*b});a.$(w).unload(function(){e.emitViewableView(h)});var l=a.$("#vse-rvs-ingress-player-1");a.on("a:carousel:"+b.carouselName+":scrollCarousel",function(b,f){k=h;h=(b-1)*f;if(e.isScrolledIntoView(a,l)){e.mutedPause(k);if(h>k)for(b=0;2>=b;b++)f=h+b,f<e.variables.playList.length&&"undefined"===typeof e.variables.vsePlayerList[f]&&e.createPlayer(a,e.variables.playList,f,c,d);e.emitMetric(r.METRIC_WIDGET_SWIPE,
1);e.mutedPlay(h)}});a.on("vse:rva:carousel:"+b.carouselName+":productClick",function(a){e.variables.sushiMetricsConfig&&e.variables.sushiMetricsConfig.hasOwnProperty("endpoint")&&(a=e.variables.buildMetricPayload(a),n.emitSushiMetric(a,e.variables.RVA_SUSHI_URL))});e.variables.vsePlayerList[h].on("playerLoaded",function(b){e.verticalScrollHandler(a,l,h)});e.verticalScrollHandler(a,l,h);a.on.scroll(function(){e.verticalScrollHandler(a,l,h)});e.emitMetric(r.METRIC_INIT_CLIENT_PLAYERS,a.now()-g)},log:function(a,
b,c,d){w.ueLogError&&w.ueLogError(b,{logLevel:a,attribution:c,message:d})},logFatal:function(a,b,c){e.log("FATAL",a,b,c)},logError:function(a,b,c){e.log("ERROR",a,b,c)}},Ib=1,Id=function(a){return new a(function(a,c){z.when("A").register("VSE-RVS-client",function(c){var g={clickHandle:null,closeHandle:null,productClickHandle:null,productImpressionHandle:null,videoVoteCastHandle:null,videoVoteHistoryHandle:null};e.variables.A=c;return{initializeClient:function(a,b,c,d,l,m,n,p){try{var w=a.now();a.$("#va-related-videos-widget_feature_div").removeClass("aok-hidden");
a.$("#vse-spinner").removeClass("aok-hidden");var v=U.fetchLatestPageState(a,"vse-dp-rv-config"),x=U.fetchLatestPageState(a,"vse-dp-vl-config"),z=U.fetchLatestPageState(a,"vse-dp-rvs-config"),A=U.fetchLatestPageState(a,"vse-dp-rvs-ad-metrics-url");e.variables.sushiMetricsConfig=U.fetchLatestPageState(a,"vse-dp-rvs-sushimetricsconfig");A&&A.url&&(e.variables.RVA_SUSHI_URL=A.url);if(v&&0!==v.length&&(v.showAdPlacement||x&&0!==x.length)){e.variables.sushiMetricsConfig&&e.variables.sushiMetricsConfig.hasOwnProperty("endpoint")?
e.variables.universalSushiEndpoint=e.variables.sushiMetricsConfig.endpoint:e.variables.universalSushiEndpoint="";e.variables.buildMetricPayload=e.makeMetricPayloadBuilder(e.variables.sushiMetricsConfig);e.variables.buildUniversalSushiPayload=e.makeApplicationSushiPayloadBuilder(a,e.variables.sushiMetricsConfig);m={gatedP:pb,_partial:Ba,_keyBy:Hd,EventEmitter:fd,promise:m};var B=new ed(b,a,m),C=new ad(m),E=new Fd({A:a,dropdownApi:d,buttonApi:l,feedbackEndpoint:""}),D=a.$.extend({},x.videoVoteConfig);
D.hasOwnProperty("placementContext")&&(D.dependencies=m,e.videoVoteContainerFactory=new rb(a,D));var G=new md({modalFactory:c,contentCarouselFactory:B,$:a.$,A:a,feedbackFactory:E,awaFactory:C,bottomSheetFactory:n,videoVoteContainerFactory:e.videoVoteContainerFactory});e.ingressCarousel=B.create(v);e.variables.playList=e.ingressCarousel.getplaylist();1<=e.variables.playList.length&&v.autoplay&&e.AutoPlayInitialization(a,v,z,C);v.showAdPlacement||(e.lightbox=G.create(x),g=e.registerClientEventOnce(a,
v,x,e.lightbox,e.ingressCarousel,g));b=Ib-p;var F=a.now();c=F-p;e.emitMetric(r.METRIC_TIME_TO_NOT_REGISTERED,b);e.emitMetric(r.METRIC_TIME_TO_REGISTERED,c);e.emitMetric(r.METRIC_INIT_CLIENT,F-w);e.emitMetric(r.METRIC_INIT_CLIENT_WAITING,w-p);""!==e.variables.universalSushiEndpoint&&(e.emitSushiMetric("rvs.requestToLoadDuration",b),e.emitSushiMetric("rvs.requestToReadyDuration",c),e.emitSushiMetric("rvs.initToReadyDuration",F-w),e.emitSushiMetric("rvs.requestToInitDuration",w-p));a.$("#vse-spinner").addClass("aok-hidden");
e.emitMetric(r.METRIC_PAGE_VIEW,1);""!==e.variables.universalSushiEndpoint&&e.emitSushiMetric("rvs.pageView",1);v.autoplayTriggered&&e.emitMetric(r.METRIC_PAGE_VIEW_MA,1)}}catch(H){a.$("#va-related-videos-widget_feature_div").addClass("aok-hidden"),e.logFatal(H,"vse-related-video-shorts","Failed to create the video light-box experience.")}},Utils:e,_noneFeature:a()}})})};z.when("A","3p-promise").execute("VSE-gatedP-register-client",function(a,b){Ib=a.now();pb.register("VSE-RVS-client","VSE-RVS-client-registered",
Id,b)})})()});