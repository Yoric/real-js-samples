// Портальная шапка 0.3.1. Требует jQuery и Modernizer
(function(){function a(a){a=a||{};for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a}function b(a){return document.getElementById(a)}function c(a){return a.bind.apply(a,G.call(arguments,1))}function d(a,b,c){function d(){a(),f||(e=D(d,b))}var e,f;return c&&a(),e=D(d,b),function(){f=!0,E(e)}}function e(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,a.preventDefault?a.preventDefault():a.returnValue=!1}function f(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function g(a,b,c,d){b&&(b.addEventListener?b[a?"addEventListener":"removeEventListener"](c,d,!1):b[a?"attachEvent":"detachEvent"]("on"+c,d))}function h(a){return a&&1==a.nodeType}function i(a,b){var c=[],d=0;if("string"==typeof a)c.push([a,b]),d+=b;else for(var e in a)a.hasOwnProperty(e)&&(c.push([e,a[e]]),d+=a[e]);for(var f=0,g=c.length;g>f;f++)c[f]=c[f].join(":")}function j(a){function b(a){var b,c,d=parseInt(1e9*Math.random(),10);(b=a.match(/^(?:cl([bn])|([adgin]))(\d+)(?:sz(\d+))?/))&&(b[1]?c="s"+b[1]:"n"==b[2]?c="nc":"i"==b[2]?(d=null,c=b[2]):c=b[2],c+=b[3]+".gif?",b[4]&&(c+="sz="+b[4]),d&&(c+="&rnd="+d),(new Image).src="//r.my.com/"+c)}for(var c=a.split(","),d=c.length;d--;)b(c[d])}function k(a){g(1,a,"mousedown",function(a){a||(a=window.event);for(var b=a.target||a.srcElement;b;)b.getAttribute&&b.getAttribute("xname")&&j(b.getAttribute("xname")),b=b.parentNode})}function l(a,b){var c;c=h(b)?function(a,b){return a==b}:function(a,b){return n(a,b)};for(var d=a.parentNode;d;){if(c(d,b))return d;d=d.parentNode}return!1}function m(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function n(a,b){return h(a)&&H?a.classList.contains(b):!!~(" "+a.className+" ").indexOf(" "+b+" ")}function o(a,b){h(a)&&(H?a.classList.add(b):!n(a,b)&&(a.className+=" "+b))}function p(a,b){h(a)&&(H?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(\\s|$)","g"),"$1"))}function q(a,b){return h(a)?H?a.classList.toggle(b):n(a,b)?(p(a,b),!1):(o(a,b),!0):void 0}function r(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&!Object.prototype.hasOwnProperty.call(a,c)&&(a[c]=b[c]);return a}function s(a,b,c){function d(e){(c&&e.propertyName===c||!c)&&(g(0,a,B.Modernizr.transitionend,d),b())}var e;return c&&(c=B.Modernizr.prefixedCss(c)),B.Modernizr.csstransitions?g(1,a,B.Modernizr.transitionend,d):e=B.setTimeout(function(){b()},0),{prop:c,callback:b,node:a,cancel:function(){e?clearTimeout(e):g(0,a,B.Modernizr.transitionend,d)}}}function t(a){return a||(a={}),"function"!=typeof a.fn?!1:a}function u(a,b,c){function d(b){if(k&&(b.propertyName||b.originalEvent.propertyName)===k||!k){if(h)return;h=!0,clearTimeout(f),B.$(a).unbind(B.Modernizr.transitionend,d),j.fn()}}function e(){n||(clearTimeout(g),clearTimeout(f),B.$(a).unbind(B.Modernizr.transitionend,d),n=!0)}c||(c={});var f,g,h,i=c.before&&(c.before=t(c.before)),j=c.after&&(c.after=t(c.after)),k=j&&j.prop&&B.Modernizr.prefixedCss(j.prop),l=B.Modernizr.prefixed("transitionDuration"),m=l&&B.$(a).css(l);m&&(m=m.indexOf("ms")>-1?parseFloat(m):1e3*parseFloat(m)),i&&i.fn(),g=setTimeout(function(){b()},B.Modernizr.csstransitions?20:0),j&&(B.Modernizr.csstransitions?(B.$(a).bind(B.Modernizr.transitionend,d),m&&(f=setTimeout(function(){d(k?{propertyName:k}:void 0)},m))):f=setTimeout(function(){j.fn()},0));var n=!1;return{cancel:e}}function v(){this._invocations=[],this._fn=null,this._context=null}function w(){}function x(){var a=[],b=0;this.getLength=function(){return a.length-b},this.isEmpty=function(){return 0==a.length},this.enqueue=function(b){a.push(b)},this.dequeue=function(){if(0==a.length)return void 0;var c=a[b];return 2*++b>=a.length&&(a=a.slice(b),b=0),c},this.peek=function(){return a.length>0?a[b]:void 0}}var y=window.__PH&&__PH.cookie&&"1"===__PH.cookie.s.getGlobal("s_debug"),z=y&&window.console||{};if(z.log=y&&z.log||function(){},z.time=y&&z.time||function(){},z.timeEnd=y&&z.timeEnd||function(){},z.time("portal-menu.full.js"),function(){var a=Function("return this")();a.fest||(a.fest={}),a.fest["pm-templates.xml"]=function(a){"use strict";function b(a){n(a+'\nin block "'+w+'" at line: '+v+"\nfile: "+u)}function c(a){return E[a]}function d(a,b,c){if(c)for(var d in b)"function"==typeof b[d]&&b[d].param&&(b[d]=b[d]());return a.call(o,b)}function e(a){if("string"==typeof a){if(y.test(a))return a.replace(x,c)}else if("undefined"==typeof a)return"";return a}var f,g,h,i,j,k,l,m,n,o=this,p="",q=[],r=[],s="",t={},u="",v="",w="",x=/[&<>"]/g,y=/[&<>"]/,C={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,wbr:!0},D=[],E={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};n="undefined"==typeof __fest_error?"undefined"!=typeof z&&z.error?function(){return Function.prototype.apply.call(z.error,z,arguments)}:function(){}:__fest_error;if(function(a){t["ph-meta"]=function(){var a="";return a}}(a),function(a){t["ph-overlay"]=function(a){var c="";try{r[0]=e(this._getClass("overlay","",a.mods))}catch(d){r[0]="",b(d.message)}return c+='<div class="'+r[0]+'"></div>'}}(a),function(a){t["ph-toolbar__button"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__button",a.mods);var f=[],j=[];a.content?f.push("_content"):(a.text?this._addMod("toolbar__button",a.mods,"icon","_text"):f.push("_notext"),a.iconCls||f.push("_noicon"),a.dropdown&&f.push("_dropdown"),a.current&&f.push("_current"),a.buttonType&&f.push("_"+a.buttonType)),a.hidden&&j.push("_hidden"),a.alwaysVisible&&j.push("_always-visible"),a.disabled&&f.push("_disabled"),a.submenu&&f.push("_submenu"),this._addMod("toolbar__button",a.mods,"*",f.join(" ")),this._addMod("toolbar__button",a.mods,"",j.join(" "));var n=["href","title","id","rel","target"],o={},p={};if(a.attrs)for(var q in a.attrs)a.attrs.hasOwnProperty(q)&&(-1!==n.indexOf(q)?p[q]=a.attrs[q]:o[q]=a.attrs[q]);a.iconBg&&(a.iconBg=a.iconBg.replace(/[()'"'']/g,""))}catch(s){b(s.message)}try{r[0]=e(this._getClass("toolbar__button","",a.mods))}catch(s){r[0]="",b(s.message)}try{r[1]=e(this._setConfig(a))}catch(s){r[1]="",b(s.message)}c+='<span class="js-button '+r[0]+'" data-config-id="'+r[1]+'"';var q,u;try{u=o||{}}catch(s){i={},b(s.message)}for(q in u){try{g=q}catch(s){g="",b(s.message)}if(""!==g){c+=" "+g+'="';try{c+=e(o[q])}catch(s){b(s.message+"80")}c+='"'}}c+=">";try{h=a.content}catch(s){h=!1,b(s.message)}if(h){try{r[0]=e(this._getClass("toolbar__button","content",a.mods))}catch(s){r[0]="",b(s.message)}try{r[1]=e(a.content.width)}catch(s){r[1]="",b(s.message)}c+='<span class="'+r[0]+'" style="width: '+r[1]+'">';try{c+=a.content.html}catch(s){b(s.message+"87")}c+="</span>"}else{try{m=a.href?"a":"span","string"!=typeof m&&(b("Element name must be a string"),m="div")}catch(s){m="div",b(s.message)}D.push(m),c+="<"+m,c+=' class="';try{c+=e(a.cls?a.cls+" ":"")}catch(s){b(s.message+"94")}c+="js-link ";try{c+=e(this._getClass("toolbar__button","inner",a.mods))}catch(s){b(s.message+"97")}c+='"';var q,v;try{v=p||{}}catch(s){i={},b(s.message)}for(q in v){try{g=q}catch(s){g="",b(s.message)}if(""!==g){c+=" "+g+'="';try{c+=e(p[q])}catch(s){b(s.message+"102")}c+='"'}}c+=' tabIndex="';try{c+=e(null!==a.tabIndex?a.tabIndex||0:void 0)}catch(s){b(s.message+"108")}c+='"',m=D[D.length-1],c+=m in C?"/>":">";try{r[0]=e(this._getClass("toolbar__button","numbers",a.mods,a.numbers?"_visible":void 0))}catch(s){r[0]="",b(s.message)}c+='<span class="js-numbers '+r[0]+'">';try{c+=e(a.numbers||0)}catch(s){b(s.message+"113")}c+="</span>";try{h=a.iconCls}catch(s){h=!1,b(s.message)}if(h){try{r[0]=e(this._getClass("toolbar__button","icon",a.mods))}catch(s){r[0]="",b(s.message)}try{r[1]=e(a.iconCls)}catch(s){r[1]="",b(s.message)}try{r[2]=e(a.iconNum)}catch(s){r[2]="",b(s.message)}c+='<span class="js-icon '+r[0]+'" data-icon="'+r[1]+'" data-icon-num="'+r[2]+'">';try{r[0]=e(this._getClass("toolbar__button","icon__img",a.mods))}catch(s){r[0]="",b(s.message)}try{r[1]=e(a.iconCls)}catch(s){r[1]="",b(s.message)}c+='<span class="'+r[0]+" "+r[1]+'"';try{h=a.iconBg}catch(s){h=!1,b(s.message)}if(h){c+=" style=\"background-image: url('";try{c+=e(a.iconBg)}catch(s){b(s.message+"123")}c+="');\""}c+=">";try{r[0]=e(this._getClass("toolbar__button","icon__num",a.mods))}catch(s){r[0]="",b(s.message)}try{r[1]=e(this._getClass("icon__num"))}catch(s){r[1]="",b(s.message)}c+='<span class="'+r[0]+" "+r[1]+'"></span></span></span>';try{h=a.dropdown}catch(s){h=!1,b(s.message)}if(h){try{r[0]=e(this._getClass("toolbar__button","icon",a.mods,"_inverted"))}catch(s){r[0]="",b(s.message)}try{r[1]=e(a.iconClsInverted||a.iconCls)}catch(s){r[1]="",b(s.message)}try{r[2]=e(a.iconNum)}catch(s){r[2]="",b(s.message)}c+='<span class="js-icon-inverted '+r[0]+'" data-icon="'+r[1]+'" data-icon-num="'+r[2]+'">';try{r[0]=e(this._getClass("toolbar__button","icon__wrap",a.mods,"_inverted"))}catch(s){r[0]="",b(s.message)}c+='<span class="'+r[0]+'">';try{r[0]=e(this._getClass("toolbar__button","icon__img",a.mods,"_inverted"))}catch(s){r[0]="",b(s.message)}try{r[1]=e(a.iconClsInverted||a.iconCls)}catch(s){r[1]="",b(s.message)}c+='<span class="'+r[0]+" "+r[1]+'"';try{h=a.iconBg}catch(s){h=!1,b(s.message)}if(h){c+=' style="background-image: url(';try{c+=e(a.iconBg)}catch(s){b(s.message+"139")}c+=');"'}c+=">";try{r[0]=e(this._getClass("toolbar__button","icon__num",a.mods,"_inverted"))}catch(s){r[0]="",b(s.message)}try{r[1]=e(this._getClass("icon__num"))}catch(s){r[1]="",b(s.message)}c+='<span class="'+r[0]+" "+r[1]+'"></span></span></span></span>'}}try{h=a.text}catch(s){h=!1,b(s.message)}if(h){try{r[0]=e(this._getClass("toolbar","button__text",a.mods))}catch(s){r[0]="",b(s.message)}c+='<span class="js-text '+r[0]+'">';try{r[0]=e(this._getClass("toolbar","button__text__inner",a.mods))}catch(s){r[0]="",b(s.message)}c+='<span class="js-text-inner '+r[0]+'">';try{c+=e(a.text.length>25?a.text.substr(0,25)+"…":a.text)}catch(s){b(s.message+"154")}c+="</span></span>"}m=D[D.length-1],m in C||(c+="</"+m+">"),D.pop()}try{h="object"==typeof a.dropdown}catch(s){h=!1,b(s.message)}if(h){g="ph-toolbar__dropdown",l={};try{l=a.dropdown}catch(s){b(s.message)}k=t[g],k&&(c+=d(k,l,!1))}return c+="</span>"}}(a),function(a){t["ph-toolbar__dropdown"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__dropdown",a.mods);var d=[],f=[];a.submenu&&d.push("_submenu"),this._addMod("toolbar__dropdown",a.mods,"*",d.join(" ")),this._addMod("toolbar__dropdown",a.mods,"",f.join(" "))}catch(j){b(j.message)}try{r[0]=e(this._getClass("toolbar__dropdown","",a.mods))}catch(j){r[0]="",b(j.message)}try{r[1]=e(A.settings.cssPrefix)}catch(j){r[1]="",b(j.message)}try{r[2]=e(this._setConfig(a))}catch(j){r[2]="",b(j.message)}c+='<span class="js-dropdown '+r[0]+'" data-class="'+r[1]+'-dropdown" data-config-id="'+r[2]+'"';try{h=a.id}catch(j){h=!1,b(j.message)}if(h){c+=' id="';try{c+=e(a.id)}catch(j){b(j.message+"21")}c+='"'}c+=">";try{h="string"==typeof a.items}catch(j){h=!1,b(j.message)}if(h){try{r[0]=e(this._getClass("toolbar__dropdown","col",a.mods))}catch(j){r[0]="",b(j.message)}c+='<span class="'+r[0]+'">';try{c+=a.items}catch(j){b(j.message+"29")}c+="</span>"}else{var k,l,n;try{n=a.items||[],l=n.length}catch(j){n=[],l=0,b(j.message)}for(k=0;l>k;k++){try{var o=a.items[k]}catch(j){b(j.message)}try{r[0]=e(this._getClass("toolbar__dropdown","col",a.mods,o.mods))}catch(j){r[0]="",b(j.message)}c+='<span class="'+r[0]+'"';var p,q;try{q=o.attrs||{}}catch(j){i={},b(j.message)}for(p in q){try{g=p}catch(j){g="",b(j.message)}if(""!==g){c+=" "+g+'="';try{c+=e(o.attrs[p])}catch(j){b(j.message+"41")}c+='"'}}c+=' style="';try{h=o.maxWidth}catch(j){h=!1,b(j.message)}if(h){c+="max-width:";try{c+=e(o.maxWidth)}catch(j){b(j.message+"46")}c+="px;"}c+='">';try{h="string"==typeof o.items}catch(j){h=!1,b(j.message)}if(h)try{c+=o.items}catch(j){b(j.message+"52")}else{var s,t,u;try{u=o.items||[],t=u.length}catch(j){u=[],t=0,b(j.message)}for(s=0;t>s;s++){try{var v=o.items[s],w=["href","title","id","rel","target"],x={},y={};if("string"!=typeof v&&(v.mods||(v.mods=""),v.separator&&(v.mods+=" _sep"),v.disabled&&(v.mods+=" _disabled"),v.current&&(v.mods+=" _current"),v.attrs))for(var p in v.attrs)v.attrs.hasOwnProperty(p)&&(-1!==w.indexOf(p)?y[p]=v.attrs[p]:x[p]=v.attrs[p])}catch(j){b(j.message)}try{h="string"==typeof v}catch(j){h=!1,b(j.message)}if(h)try{c+=v}catch(j){b(j.message+"95")}else{try{r[0]=e(this._getClass("toolbar__dropdown","item",a.mods,v.mods))}catch(j){r[0]="",b(j.message)}c+='<span class="js-item '+r[0]+'"';var p,z;try{z=x||{}}catch(j){i={},b(j.message)}for(p in z){try{g=p}catch(j){g="",b(j.message)}if(""!==g){c+=" "+g+'="';try{c+=e(x[p])}catch(j){b(j.message+"102")}c+='"'}}c+=">";try{m=v.href?"a":"span","string"!=typeof m&&(b("Element name must be a string"),m="div")}catch(j){m="div",b(j.message)}D.push(m),c+="<"+m,c+=' class="';try{c+=e(v.cls?v.cls+" ":"")}catch(j){b(j.message+"109")}c+="js-link ";try{c+=e(this._getClass("toolbar__dropdown","item__inner",a.mods,v.mods))}catch(j){b(j.message+"111")}c+='"';var p,B;try{B=y||{}}catch(j){i={},b(j.message)}for(p in B){try{g=p}catch(j){g="",b(j.message)}if(""!==g){c+=" "+g+'="';try{c+=e(y[p])}catch(j){b(j.message+"116")}c+='"'}}m=D[D.length-1],c+=m in C?"/>":">";try{h="string"==typeof v.html}catch(j){h=!1,b(j.message)}if(h)try{c+=v.html}catch(j){b(j.message+"123")}else{try{r[0]=e(this._getClass("toolbar__dropdown","item__text",a.mods))}catch(j){r[0]="",b(j.message)}c+='<span class="js-text '+r[0]+'">';try{c+=v.text||v.title}catch(j){b(j.message+"127")}c+="</span>"}m=D[D.length-1],m in C||(c+="</"+m+">"),D.pop(),c+="</span>"}}}c+="</span>"}}return c+="</span>"}}(a),function(a){t["ph-toolbar__separator"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__separator",a.mods);var d=[];a.hidden&&d.push("_hidden"),a.alwaysVisible&&d.push("_always-visible"),this._addMod("toolbar__separator",a.mods,"",d.join(" "))}catch(f){b(f.message)}try{r[0]=e(this._getClass("toolbar","separator",a.mods))}catch(f){r[0]="",b(f.message)}try{r[1]=e(this._setConfig(a))}catch(f){r[1]="",b(f.message)}c+='<span class="js-separator '+r[0]+'" data-config-id="'+r[1]+'">';try{r[0]=e(this._getClass("toolbar","separator__bg",a.mods))}catch(f){r[0]="",b(f.message)}return c+='<span class="'+r[0]+'"> </span></span>'}}(a),function(a){t["ph-toolbar__group"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__group",a.mods);var f=[];a.submenu&&f.push("_submenu"),this._addMod("toolbar__group",a.mods,"",f.join(" "))}catch(j){b(j.message)}try{r[0]=e(this._getClass("toolbar__group","",a.mods))}catch(j){r[0]="",b(j.message)}try{r[1]=e(this._setConfig(a))}catch(j){r[1]="",b(j.message)}c+='<span class="js-group '+r[0]+'" data-config-id="'+r[1]+'"';var m,n;try{n=a.attrs||{}}catch(j){i={},b(j.message)}for(m in n){try{g=m}catch(j){g="",b(j.message)}if(""!==g){c+=" "+g+'="';try{c+=e(a.attrs[m])}catch(j){b(j.message+"18")}c+='"'}}c+=">";var o,p,q,s;try{s=a.items||[],q=s.length}catch(j){s=[],q=0,b(j.message)}for(o=0;q>o;o++){p=s[o];try{h=p}catch(j){h=!1,b(j.message)}if(h){try{p.mods=this._prepareMods("toolbar__"+p.type,p.mods),0==o&&this._addMod("toolbar__"+p.type,p.mods,"","_first"),p.submenu&&this._addMod("toolbar__"+p.type,p.mods,"*","_submenu")}catch(j){b(j.message)}try{g="ph-toolbar__"+(p.type||"button")}catch(j){g="",b(j.message)}l={};try{l=p}catch(j){b(j.message)}k=t[g],k&&(c+=d(k,l,!1))}}return c+="</span>"}}(a),function(a){t["ph-toolbar__spacer"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__spacer",a.mods);var d=[];a.hidden&&d.push("_hidden"),a.alwaysVisible&&d.push("_always-visible"),this._addMod("toolbar__spacer",a.mods,"",d.join(" "))}catch(f){b(f.message)}try{r[0]=e(this._getClass("toolbar","spacer",a.mods))}catch(f){r[0]="",b(f.message)}try{r[1]=e(a.width?"width: "+a.width+"px":"")}catch(f){r[1]="",b(f.message)}try{r[2]=e(this._setConfig(a))}catch(f){r[2]="",b(f.message)}return c+='<span class="js-spacer '+r[0]+'" style="'+r[1]+'" data-config-id="'+r[2]+'"> </span>'}}(a),function(a){t["ph-toolbar__suggests-list"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__suggests",a.mods);var d=[];this._addMod("toolbar__suggests",a.mods,"*",d.join(" "));var f=a.searchText&&new RegExp("("+a.searchText.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\##source##")+")","gi"),j=/[<>"]/g,k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},l=function(a){return a.replace(j,function(a){return k[a]})}}catch(m){b(m.message)}try{r[0]=e(this._getClass("toolbar__suggests-list","",a.mods))}catch(m){r[0]="",b(m.message)}try{r[1]=e(this._setConfig(a))}catch(m){r[1]="",b(m.message)}c+='<span class="'+r[0]+'" data-config-id="'+r[1]+'">';var n,o,p;try{p=a.items||[],o=p.length}catch(m){p=[],o=0,b(m.message)}for(n=0;o>n;n++){try{var q=a.items[n],s="";0==n?s+=" _first":n==a.items.length-1&&(s+=" _last")}catch(m){b(m.message)}try{r[0]=e(this._getClass("toolbar__suggests","group",a.mods,s||void 0))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{h=q.title}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__suggests","group__title",s||void 0))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{c+=e(q.title)}catch(m){b(m.message+"44")}c+="</span>"}var t,u,v;try{v=q.items||[],u=v.length}catch(m){v=[],u=0,b(m.message)}for(t=0;u>t;t++){try{var w=q.items[t],x="";w.caption||(w.pic=void 0),w.pic&&(x+=" _with-pic"),w.caption&&(x+=" _with-caption")}catch(m){b(m.message)}try{r[0]=e(this._getClass("toolbar__suggests","group__item",a.mods,(w.mods||"")+x))}catch(m){r[0]="",b(m.message)}try{r[1]=e(this._setConfig(w))}catch(m){r[1]="",b(m.message)}c+='<span class="'+r[0]+'" data-config-id="'+r[1]+'"';try{h=w.attrs}catch(m){h=!1,b(m.message)}if(h){var y,z;try{z=w.attrs||{}}catch(m){i={},b(m.message)}for(y in z){try{g=y}catch(m){g="",b(m.message)}if(""!==g){c+=" "+g+'="';try{c+=e(w.attrs[y])}catch(m){b(m.message+"72")}c+='"'}}}c+=">";try{h="string"==typeof w.html}catch(m){h=!1,b(m.message)}if(h)try{c+=w.html}catch(m){b(m.message+"80")}else{var A=function(){var a="";try{a+=l(w.text||"")}catch(c){b(c.message+"84")}return a}(),B=function(){var a="";try{a+=l(w.caption||"")}catch(c){b(c.message+"87")}return a}();try{h=w.pic}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__suggests","group__item__pic",a.mods))}catch(m){r[0]="",b(m.message)}try{r[1]=e(w.pic)}catch(m){r[1]="",b(m.message)}c+='<span class="'+r[0]+'" style="background-image: url('+r[1]+')"></span>'}try{r[0]=e(this._getClass("toolbar__suggests","group__item__info",a.mods,x))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{r[0]=e(this._getClass("toolbar__suggests","group__item__text",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{c+=f?A.replace(f,'<span class="'+this._getClass("toolbar__suggests","group__item__text__searchtext",a.mods)+'" >$1</span>'):A}catch(m){b(m.message+"97")}c+="</span>";try{h=B}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__suggests","group__item__caption",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{c+=f?B.replace(f,'<span class="'+this._getClass("toolbar__suggests","group__item__caption__searchtext",a.mods)+'" >$1</span>'):B}catch(m){b(m.message+"103")}c+="</span>"}c+="</span>"}c+="</span>"}c+="</span>"}try{h=a.searchInternet}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__suggests","searchin",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{r[0]=e(this._getClass("toolbar__suggests","searchin__wrapper",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{r[0]=e(encodeURIComponent(a.searchText))}catch(m){r[0]="",b(m.message)}try{r[1]=e(this._getClass("toolbar__suggests","searchin__link",a.mods))}catch(m){r[1]="",b(m.message)}c+='<a href="http://go.mail.ru/search?q='+r[0]+'" class="'+r[1]+'">Найти &laquo;';try{c+=e(a.searchText)}catch(m){b(m.message+"117")}c+="&raquo; в интернете</a></span></span>"}return c+="</span>"}}(a),function(a){t["ph-toolbar__suggests"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__suggests",a.mods);var f=[],i=[];this._addMod("toolbar__suggests",a.mods,"*",f.join(" ")),this._addMod("toolbar__suggests",a.mods,"",i.join(" "))}catch(j){b(j.message)}try{r[0]=e(this._getClass("toolbar__suggests","",a.mods))}catch(j){r[0]="",b(j.message)}try{r[1]=e(this._setConfig(a))}catch(j){r[1]="",b(j.message)}c+='<span tabIndex="0" class="'+r[0]+'" data-config-id="'+r[1]+'">';try{h=a.items}catch(j){h=!1,b(j.message)}if(h){g="ph-toolbar__suggests-list",l={};try{l=a.items}catch(j){b(j.message)}k=t[g],k&&(c+=d(k,l,!1))}return c+="</span>"}}(a),function(a){t["ph-toolbar__search"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar__button",a.mods);var f=[],j=[];a.searchType&&f.push("_"+a.searchType),a.alwaysVisible&&j.push("_always-visible"),a.highlighted&&f.push("_highlighted"),f.push(a.expandable?"_expandable":"_not-expandable"),f.push(a.adaptive?"_adaptive":"_not-adaptive"),this._addMod("toolbar__search",a.mods,"*",f.join(" ")),this._addMod("toolbar__search",a.mods,"",j.join(" "))}catch(m){b(m.message)}try{r[0]=e(this._getClass("toolbar__search","",a.mods))}catch(m){r[0]="",b(m.message)}try{r[1]=e(this._setConfig(a))}catch(m){r[1]="",b(m.message)}c+='<span class="js-search '+r[0]+'" data-config-id="'+r[1]+'">';try{h=a.expandButton}catch(m){h=!1,b(m.message)}if(h){g="ph-toolbar__button",l={};try{l=a.expandButton}catch(m){b(m.message)}k=t[g],k&&(c+=d(k,l,!1))}try{r[0]=e(this._getClass("toolbar__search","container",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{h=a.expandable}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__search","fade",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'"></span>'}try{r[0]=e(a.target)}catch(m){r[0]="",b(m.message)}try{r[1]=e(a.formName)}catch(m){r[1]="",b(m.message)}try{r[2]=e(a.searchUrl)}catch(m){r[2]="",b(m.message)}try{r[3]=e(a.method)}catch(m){r[3]="",b(m.message)}try{r[4]=e(this._getClass("toolbar__search","form",a.mods))}catch(m){r[4]="",b(m.message)}c+='<form target="'+r[0]+'" name="'+r[1]+'" action="'+r[2]+'" method="'+r[3]+'" class="js-search '+r[4]+'">';try{h=a.inputs}catch(m){h=!1,b(m.message)}if(h){var n,o,p;try{p=a.inputs||{}}catch(m){i={},b(m.message)}for(n in p){o=p[n];try{r[0]=e(n)}catch(m){r[0]="",b(m.message)}try{r[1]=e(o)}catch(m){r[1]="",b(m.message)}c+='<input type="hidden" name="'+r[0]+'" value="'+r[1]+'"/>'}}try{r[0]=e(this._getClass("toolbar__search","label",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="js-label '+r[0]+'">';try{r[0]=e(this._getClass("toolbar__search","label__wrapper",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="js-label '+r[0]+'">';try{r[0]=e(a.inputName)}catch(m){r[0]="",b(m.message)}try{r[1]=e(this._getClass("toolbar__search","input",a.mods))}catch(m){r[1]="",b(m.message)}try{r[2]=e(a.value)}catch(m){r[2]="",b(m.message)}c+='<input type="text" tabIndex="0" name="'+r[0]+'" class="js-input '+r[1]+'" value="'+r[2]+'"/></span>';try{h=a.placeholder}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__search","placeholder",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="js-placeholder '+r[0]+'">';try{c+=e(a.placeholder)}catch(m){b(m.message+"58")}c+="</span>"}c+="</span>";try{h=a.clearButton}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__search","clear-button",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+'">';try{r[0]=e(this._getClass("toolbar__search","clear-button__icon",a.mods,"_rest"))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+' pm-uh-erase-field-rest"></span>';try{r[0]=e(this._getClass("toolbar__search","clear-button__icon",a.mods,"_hover"))}catch(m){r[0]="",b(m.message)}c+='<span class="'+r[0]+' pm-uh-erase-field-hover"></span></span>'}try{h=a.params}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__search","params",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="js-dropdown-button '+r[0]+'">';try{h=a.params.list}catch(m){h=!1,b(m.message)}if(h)try{for(var q,s=0,u=a.params.list.length;u>s;s++){var v=a.params.list[s];if(v.icon||v.icon_x2){q=!0;break}}q&&(a.mods.toolbar__search__params__text="_icon",a.mods.toolbar__search__params__dropdown__item="_icon")}catch(m){b(m.message)}try{r[0]=e(this._getClass("toolbar__search","params__text",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span tabIndex="0" class="'+r[0]+'"></span>';try{h=a.params.list}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__search","params__dropdown",a.mods))}catch(m){r[0]="",b(m.message)}c+='<span class="js-dropdown '+r[0]+'">';var s,w,x;try{x=a.params.list||[],w=x.length}catch(m){x=[],w=0,b(m.message)}for(s=0;w>s;s++){try{var y=a.params.list[s],z=[];y.icon&&(Array.isArray(y.icon)?z=y.icon:z.push(y.icon)),y.icon_x2&&B.Modernizr.retina&&z.push(y.icon_x2)}catch(m){b(m.message)}try{r[0]=e(this._getClass("toolbar__search","params__dropdown__item",a.mods,y.mods||void 0))}catch(m){r[0]="",b(m.message)}try{r[1]=e(y.searchUrl)}catch(m){r[1]="",b(m.message)}try{r[2]=e(y.suggestUrl)}catch(m){r[2]="",b(m.message)}try{r[3]=e(y.inputName)}catch(m){r[3]="",b(m.message)}try{r[4]=e(y.selected||!1)}catch(m){r[4]="",b(m.message)}c+='<span tabIndex="0" class="js-dropdown-item '+r[0]+'" data-search-url="'+r[1]+'" data-suggest-url="'+r[2]+'" data-input-name="'+r[3]+'" data-selected="'+r[4]+'">';try{h=z.length}catch(m){h=!1,b(m.message)}if(h){try{r[0]=e(this._getClass("toolbar__search","params__dropdown__item__icon"))}catch(m){r[0]="",b(m.message)}c+='<i class="'+r[0]+'" role="icon" style="';var A,C,D;try{D=z||[],C=D.length}catch(m){D=[],C=0,b(m.message)}for(A=0;C>A;A++){c+="background-image: url(";try{c+=z[A]}catch(m){b(m.message+"115")}c+=");"}c+='"></i>'}try{c+=e(y.text)}catch(m){b(m.message+"121")}try{h=y.inputs}catch(m){h=!1,b(m.message)}if(h){var n,o,E;try{E=y.inputs||{}}catch(m){i={},b(m.message)}for(n in E){o=E[n];try{r[0]=e(this._getClass("toolbar__search","params__dropdown__item__input"))}catch(m){r[0]="",b(m.message)}try{r[1]=e(n)}catch(m){r[1]="",b(m.message)}try{r[2]=e(o)}catch(m){r[2]="",b(m.message)}c+='<span style="display: none;" class="'+r[0]+'" data-name="'+r[1]+'" data-value="'+r[2]+'"></span>'}}c+="</span>"}c+="</span>"}c+="</span>"}try{r[0]=e(this._getClass("toolbar__search","button",a.mods,a.autofocus?"_highlight":void 0))}catch(m){r[0]="",b(m.message)}c+='<span class="js-submit '+r[0]+'"';try{h=a.buttonAttrs}catch(m){h=!1,b(m.message)}if(h){var n,F;try{F=a.buttonAttrs||{}}catch(m){i={},b(m.message)}for(n in F){try{g=n}catch(m){g="",b(m.message)}if(""!==g){c+=" "+g+'="';try{c+=e(a.buttonAttrs[n])}catch(m){b(m.message+"138")}c+='"'}}}c+=">";try{r[0]=e(a.buttonName)}catch(m){r[0]="",b(m.message)}try{r[1]=e(this._getClass("toolbar__search","button__input",a.mods))}catch(m){r[1]="",b(m.message)}c+='<button name="'+r[0]+'" type="submit" tabIndex="0" class="js-submit-button '+r[1]+'"></button>';try{r[0]=e(this._getClass("toolbar__search","button__icon",a.mods,"_rest"))}catch(m){r[0]="",b(m.message)}c+='<i class="'+r[0]+' pm-uh-search-field-rest"></i>';try{r[0]=e(this._getClass("toolbar__search","button__icon",a.mods,"_hover"))}catch(m){r[0]="",b(m.message)}c+='<i class="'+r[0]+' pm-uh-search-field-hover"></i>';try{r[0]=e(this._getClass("toolbar__search","button__icon",a.mods,"_active"))}catch(m){r[0]="",b(m.message)}c+='<i class="'+r[0]+' pm-uh-search-field-active"></i></span>';try{h=a.suggests}catch(m){h=!1,b(m.message)}if(h){g="ph-toolbar__suggests",l={};try{l=a.suggests}catch(m){b(m.message)}k=t[g],k&&(c+=d(k,l,!1))}return c+="</form></span></span>"}}(a),function(a){t["ph-toolbar__banner"]=function(a){var c="";try{h=a.reload}catch(f){h=!1,b(f.message)}if(h){g="ph-toolbar__banner__content",l={};try{l=a}catch(f){b(f.message)}k=t[g],k&&(c+=d(k,l,!1))}else{try{a.mods=this._prepareMods("toolbar__button",a.mods);var j=[];a.alwaysVisible&&j.push("_always-visible"),a.hidden&&j.push("_hidden"),this._addMod("toolbar__banner",a.mods,"",j.join(" "))}catch(f){b(f.message)}try{r[0]=e(this._getClass("toolbar__banner","",a.mods))}catch(f){r[0]="",b(f.message)}try{r[1]=e(this._setConfig(a))}catch(f){r[1]="",b(f.message)}c+='<span class="js-banner '+r[0]+'" data-config-id="'+r[1]+'"';var m,n;try{n=a.attrs||{}}catch(f){i={},b(f.message)}for(m in n){try{g=m}catch(f){g="",b(f.message)}if(""!==g){c+=" "+g+'="';try{c+=e(a.attrs[m])}catch(f){b(f.message+"27")}c+='"'}}c+=">",g="ph-toolbar__banner__content",l={};try{l=a}catch(f){b(f.message)}k=t[g],k&&(c+=d(k,l,!1)),c+="</span>"}return c},t["ph-toolbar__banner__content"]=function(a){var c,d,f,g="";try{f=a.slot||[],d=f.length}catch(h){f=[],d=0,b(h.message)}for(c=0;d>c;c++){try{var i=a.slot[c]}catch(h){b(h.message)}try{g+=i}catch(h){b(h.message+"43")}}try{r[0]=e(this._getClass("toolbar__banner","leg",a.mods))}catch(h){r[0]="",b(h.message)}return g+='<i class="'+r[0]+'">&nbsp;</i>'},t["ph-toolbar__banner__banner"]=function(a){var c="";try{h=4==a.type}catch(d){h=!1,b(d.message)}if(h){try{r[0]=e(a.id)}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.title)}catch(d){r[1]="",b(d.message)}try{r[2]=e(a.href)}catch(d){r[2]="",b(d.message)}try{r[3]=e(this._getClass("toolbar__banner","content",a.mods,"_img"))}catch(d){r[3]="",b(d.message)}c+='<a id="'+r[0]+'" title="'+r[1]+'" target="_blank" href="'+r[2]+'" class="'+r[3]+'">';try{r[0]=e(a.img)}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.imgWidth)}catch(d){r[1]="",b(d.message)}try{r[2]=e(a.imgHeight)}catch(d){r[2]="",b(d.message)}try{r[3]=e(this._getClass("toolbar__banner","content__image",a.mods))}catch(d){r[3]="",b(d.message)}c+='<img src="'+r[0]+'" width="'+r[1]+'" height="'+r[2]+'" alt="" title="" class="'+r[3]+'"/></a>'}else{try{r[0]=e(a.id)}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.title)}catch(d){r[1]="",b(d.message)}try{r[2]=e(a.href)}catch(d){r[2]="",b(d.message)}try{r[3]=e(this._getClass("toolbar__banner","content",a.mods,"_"+a.color+" _"+a.color+a.colorVariant+" _text"))}catch(d){r[3]="",b(d.message)}c+='<a id="'+r[0]+'" title="'+r[1]+'" target="_blank" href="'+r[2]+'" class="'+r[3]+'">';try{h="sber"==a.color}catch(d){h=!1,b(d.message)}if(h){try{r[0]=e(this._getClass("toolbar__banner","content__icon",a.mods,"_sber"))}catch(d){r[0]="",b(d.message)}c+='<i class="'+r[0]+'"></i>'}try{r[0]=e(this._getClass("toolbar__banner","content__text",a.mods))}catch(d){r[0]="",b(d.message)}c+='<span class="'+r[0]+'">';try{c+=e(a.text)}catch(d){b(d.message+"78")}c+="</span></a>"}return c}}(a),function(a){t["ph-toolbar"]=function(a){var c="";try{a.mods=this._prepareMods("toolbar",a.mods);var f=[];a.submenu&&f.push("_submenu"),this._addMod("toolbar",a.mods,"",f.join(" "))}catch(i){b(i.message)}try{r[0]=e(this._getClass("toolbar","",a.mods))}catch(i){r[0]="",b(i.message)}try{r[1]=e(this._setConfig(a))}catch(i){r[1]="",b(i.message)}c+='<span class="'+r[0]+'" data-config-id="'+r[1]+'"';try{h=a.id}catch(i){h=!1,b(i.message)}if(h){c+=' id="';try{c+=e(a.id)}catch(i){b(i.message+"18")}c+='"'}c+=">";var j,m,n;try{n=a.items||[],m=n.length}catch(i){n=[],m=0,b(i.message)}for(j=0;m>j;j++){try{h=a.items[j]}catch(i){h=!1,b(i.message)}if(h){try{var o=a.items[j]}catch(i){b(i.message)}g="ph-toolbar__group",l={};try{l=o}catch(i){b(i.message)}k=t[g],k&&(c+=d(k,l,!1))}}return c+="</span>"}}(a),function(a){t["ph-logo"]=function(a){var c="";try{r[0]=e(this._getClass("logo","",a.mods))}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.marginLeft)}catch(d){r[1]="",b(d.message)}try{r[2]=e(a.marginRight)}catch(d){r[2]="",b(d.message)}try{r[3]=e(this._setConfig(a))}catch(d){r[3]="",b(d.message)}c+='<div class="'+r[0]+'" style="padding-left: '+r[1]+"px; padding-right: "+r[2]+'px;" data-config-id="'+r[3]+'">';try{r[0]=e(this._getClass("logo","link",a.mods))}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.href)}catch(d){r[1]="",b(d.message)}c+='<a class="'+r[0]+'" href="'+r[1]+'"';var f,j;try{j=a.attrs||{}}catch(d){i={},b(d.message)}for(f in j){try{g=f}catch(d){g="",b(d.message)}if(""!==g){c+=" "+g+'="';try{c+=e(a.attrs[f])}catch(d){b(d.message+"8")}c+='"'}}try{h=a.width}catch(d){h=!1,b(d.message)}if(h){c+=' style="width:';
            try{c+=e(a.width)}catch(d){b(d.message+"13")}c+='px"'}c+=">";try{r[0]=e(this._getClass("logo","link__pic",a.mods))}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.src)}catch(d){r[1]="",b(d.message)}try{r[2]=e(a.title||"")}catch(d){r[2]="",b(d.message)}try{r[3]=e(a.title||"")}catch(d){r[3]="",b(d.message)}c+='<img class="'+r[0]+'" src="'+r[1]+'" alt="'+r[2]+'" title="'+r[3]+'"';try{h=a.width}catch(d){h=!1,b(d.message)}if(h){c+=' width="';try{c+=e(a.width)}catch(d){b(d.message+"22")}c+='"'}try{h=a.height}catch(d){h=!1,b(d.message)}if(h){c+=' height="';try{c+=e(a.height)}catch(d){b(d.message+"27")}c+='"'}return c+="/></a></div>"}}(a),function(a){t["ph-input"]=function(a){var c="";try{a.type||(a.type="text"),a.mods=this._addMod("input",a.mods,"*","_type_"+a.type)}catch(d){b(d.message)}try{r[0]=e(this._getClass("input","",a.mods))}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.id)}catch(d){r[1]="",b(d.message)}c+='<label class="js-input-el '+r[0]+'" for="'+r[1]+'">';try{r[0]=e(this._getClass("w-input","",a.mods))}catch(d){r[0]="",b(d.message)}c+='<span class="js-wrapper '+r[0]+'">';try{h=a.placeholder}catch(d){h=!1,b(d.message)}if(h){try{r[0]=e(this._getClass("input","placeholder",a.mods))}catch(d){r[0]="",b(d.message)}c+='<span class="js-placeholder '+r[0]+'"></span>'}try{r[0]=e(a.autocomplete)}catch(d){r[0]="",b(d.message)}try{r[1]=e(this._getClass("input","text",a.mods))}catch(d){r[1]="",b(d.message)}try{r[2]=e(a.type)}catch(d){r[2]="",b(d.message)}try{r[3]=e(a.name)}catch(d){r[3]="",b(d.message)}try{r[4]=e(a.placeholder)}catch(d){r[4]="",b(d.message)}try{r[5]=e(a.id)}catch(d){r[5]="",b(d.message)}try{r[6]=e(a.value)}catch(d){r[6]="",b(d.message)}try{r[7]=e(a.checked)}catch(d){r[7]="",b(d.message)}c+='<input autocomplete="'+r[0]+'" class="js-input '+r[1]+'" type="'+r[2]+'" name="'+r[3]+'" placeholder="'+r[4]+'" id="'+r[5]+'" value="'+r[6]+'" checked="'+r[7]+'"/></span>';try{h=a.label}catch(d){h=!1,b(d.message)}if(h){try{r[0]=e(this._getClass("input","label",a.mods))}catch(d){r[0]="",b(d.message)}c+='<span class="js-label '+r[0]+'">';try{c+=a.label}catch(d){b(d.message+"17")}c+="</span>"}return c+="</label>"}}(a),function(a){t["ph-button"]=function(a){var c="";c+='<span tabindex="0" class="js-button ';try{c+=e(this._getClass("button","",a.mods,a.iconCls?"_with-icon":void 0))}catch(d){b(d.message+"8")}c+='">';try{h=a.inputName}catch(d){h=!1,b(d.message)}if(h){try{r[0]=e(this._getClass("button","input",a.mods))}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.inputName)}catch(d){r[1]="",b(d.message)}try{r[2]=e(a.text)}catch(d){r[2]="",b(d.message)}try{r[3]=e(a.onclick)}catch(d){r[3]="",b(d.message)}c+='<input class="js-input '+r[0]+'" name="'+r[1]+'" type="button" value="'+r[2]+'" onclick="'+r[3]+'"/>'}try{r[0]=e(this._getClass("button","fake",a.mods))}catch(d){r[0]="",b(d.message)}c+='<span class="js-fake '+r[0]+'">';try{h=a.iconCls}catch(d){h=!1,b(d.message)}if(h){try{r[0]=e(this._getClass("button","fake__icon",a.mods))}catch(d){r[0]="",b(d.message)}try{r[1]=e(a.iconCls)}catch(d){r[1]="",b(d.message)}c+='<span class="js-icon '+r[0]+" "+r[1]+'"></span>'}try{r[0]=e(this._getClass("button","fake__text",a.mods))}catch(d){r[0]="",b(d.message)}c+='<span class="js-text '+r[0]+'">';try{c+=a.text}catch(d){b(d.message+"20")}return c+="</span></span></span>"}}(a),function(a){t["ph-popup"]=function(a){var c="";try{r[0]=e(this._getClass("w-popup","",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="'+r[0]+'">';try{r[0]=e(this._getClass("w-popup","layout",a.mods))}catch(f){r[0]="",b(f.message)}c+='<table class="'+r[0]+'"><tr>';try{r[0]=e(this._getClass("w-popup","layout__valign",a.mods))}catch(f){r[0]="",b(f.message)}c+='<td class="'+r[0]+'">';try{r[0]=e(this._getClass("popup","",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="'+r[0]+'" id="regional-popup">';try{r[0]=e(this._getClass("w-popup","title",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="'+r[0]+'">';try{r[0]=e(this._getClass("popup","title",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="'+r[0]+'">';try{c+=a.title}catch(f){b(f.message+"10")}c+="</div></div>";try{r[0]=e(this._getClass("popup","content",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="'+r[0]+'">';try{h="string"==typeof a.content}catch(f){h=!1,b(f.message)}if(h)try{c+=a.content}catch(f){b(f.message+"16")}c+="</div>";try{r[0]=e(this._getClass("popup","footer",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="'+r[0]+'">';try{r[0]=e(this._getClass("popup","footer__controls",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="js-controls '+r[0]+'">';var i,j,m,n;try{n=a.controls||[],m=n.length}catch(f){n=[],m=0,b(f.message)}for(i=0;m>i;i++){j=n[i];try{h="string"==typeof j.content}catch(f){h=!1,b(f.message)}if(h){try{r[0]=e(j.action)}catch(f){r[0]="",b(f.message)}try{r[1]=e(this._getClass("popup","footer__controls__item",a.mods))}catch(f){r[1]="",b(f.message)}c+='<span data-action="'+r[0]+'" class="js-control '+r[1]+'">';try{c+=j.content}catch(f){b(f.message+"26")}c+="</span>"}else{try{h="link"==j.type}catch(f){h=!1,b(f.message)}if(h){try{r[0]=e(j.action)}catch(f){r[0]="",b(f.message)}try{r[1]=e(this._getClass("popup","footer__controls__item",a.mods,"_link"))}catch(f){r[1]="",b(f.message)}c+='<span data-action="'+r[0]+'" class="js-control '+r[1]+'" tabindex="0">';try{c+=j.text}catch(f){b(f.message+"31")}c+="</span>"}else{try{h="button"==j.type}catch(f){h=!1,b(f.message)}if(h){try{r[0]=e(j.action)}catch(f){r[0]="",b(f.message)}try{r[1]=e(this._getClass("popup","footer__controls__item",a.mods))}catch(f){r[1]="",b(f.message)}c+='<span data-action="'+r[0]+'" class="js-control '+r[1]+'" tabindex="0">',g="ph-button",l={};try{l=j}catch(f){b(f.message)}k=t[g],k&&(c+=d(k,l,!1)),c+="</span>"}}}}c+="</div></div>";try{r[0]=e(this._getClass("popup","close",a.mods))}catch(f){r[0]="",b(f.message)}c+='<div class="js-close '+r[0]+'">';try{r[0]=e(this._getClass("popup","close__icon",a.mods))}catch(f){r[0]="",b(f.message)}return c+='<div class="'+r[0]+'">&times;</div></div></div></td></tr></table></div>'}}(a),function(a){t["ph-region"]=function(){var a="";a+='<div class="portal-region" id="portal-region"><form class="js-region-form portal-region__form"><div class="w-portal-region__form_row w-portal-region__form_row_first">',g="ph-input",l={};try{l={id:"regionAutoDetectInput",type:"radio",name:"regionDetection",checked:"checked",value:"1",label:'<span class="js-auto-city portal-region__auto-detected-city"></span> (Автоматически)'}}catch(c){b(c.message)}k=t[g],k&&(a+=d(k,l,!1)),a+='</div><div class="w-portal-region__form_row">',g="ph-input",l={};try{l={id:"regionManualInput",type:"radio",name:"regionDetection",checked:"checked",value:"0",label:"Выбрать город вручную"}}catch(c){b(c.message)}k=t[g],k&&(a+=d(k,l,!1)),a+='</div><div class="w-portal-region__form_row">',g="ph-input",l={};try{l={id:"regionSearchInput",placeholder:"Введите название города",autocomplete:"off",name:"regionSearch",mods:{input:"portal-region__input","w-input":"w-portal-region__input",__placeholder:"portal-region__input__placeholder",__text:"portal-region__input__text"}}}catch(c){b(c.message)}return k=t[g],k&&(a+=d(k,l,!1)),a+='<div class="w-portal-region__suggests"><div class="portal-region__suggests" tabindex="0"><div class="js-current-regions portal-region__suggests__group"><div class="portal-region__suggests__group__title">Ближайшие города</div><div class="js-region-items"></div></div><div class="js-russia-regions portal-region__suggests__group"><div class="portal-region__suggests__group__title">Россия</div><div class="js-region-items"></div></div><div class="js-other-regions portal-region__suggests__group"><div class="portal-region__suggests__group__title">Другие города</div><div class="js-region-items"></div></div><div class="portal-region__suggests__loader"><div class="portal-region__suggests__loader__text"><i class="portal-region__suggests__loader__text__icon"></i> Загрузка</div></div><div class="js-message-empty portal-region__suggests__message portal-region__suggests__message_empty"><div class="portal-region__suggests__message__text">Город с таким названием не найден. <span class="js-message-all portal-region__suggests__message__text__link">Все города</span></div></div><div class="js-message-error portal-region__suggests__message portal-region__suggests__message_error"><div class="portal-region__suggests__message__text">При загрузке произошла ошибка. <span class="js-message-reload portal-region__suggests__message__text__link">Повторить</span></div></div></div></div></div><div class="w-portal-region__form_row" style="display: none;"><label class="w-portal-region__form__label" for="regionNoSuggest"><input class="portal-region__form__input portal-region__form__input_checkbox" type="checkbox" name="regionNoSuggest" value="1" id="regionNoNotification"/><span class="portal-region__form__label">Не показывать оповещения о смене региона</span></label></div></form></div>'}}(a),function(a){var c=a;try{h="meta"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-meta",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar__button"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar__button",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar__dropdown"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar__dropdown",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar__search"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar__search",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar__banner"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar__banner",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar__banner__banner"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar__banner__banner",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar__suggests"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar__suggests",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="toolbar__suggests-list"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-toolbar__suggests-list",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="overlay"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-overlay",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="logo"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-logo",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="region"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-region",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="popup"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-popup",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="input"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-input",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}else{try{h="button"==c.block}catch(d){h=!1,b(d.message)}if(h){g="ph-button",l={};try{l=c.params}catch(d){b(d.message)}q.push(p,{name:g,params:l,cp:!1}),p=""}}}}}}}}}}}}}}}}(a),j=q.length){for(i=0;j>i;i++)f=q[i],"string"==typeof f?s+=f:(k=t[f.name],k&&(s+=d(k,f.params,f.cp)));return s+p}return p}}(),!window.__PM){var A=window.__PM={},B={};B.Modernizr=window.Modernizr,A.settings=window.__PMS||{},A.settings.staticDir="//img.imgsmail.ru/p/pm/d/0.3.1/",A.settings.noCss=!0,A.settings.rootClass="portal-menu",A.settings.cssPrefix="pm",A._=B;var C="{{ project }}",D=window.setTimeout,E=window.clearTimeout,F=b(A.settings.rootClass);Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});var G=Array.prototype.slice;void 0===Function.prototype.bind&&(Function.prototype.bind=function(a){var b=G.call(arguments,1),c=this;return function(){return c.apply(a,b.concat(G.call(arguments,0)))}});var H=B.Modernizr.classlist;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=this,c=0,d=b.length;d>c;c++)if(b[c]==a)return c;return-1}),a(B,{extend:a,animate:u,project:C,setTimeout:function(a,b){return D(a,b)},clearTimeout:function(a){return E(a)},rootNode:F,byId:b,bind:c,radar:i,setIntervalByTimeout:d,eventCancel:e,eventPreventDefault:f,event:g,isNode:h,emptyNode:m,count:j,countEl:k,hasParent:l,hasClass:n,removeClass:p,addClass:o,toggleClass:q,animateEnd:s,append:r}),B.Modernizr.prefixedCss=function(){var a=B.Modernizr.prefixed.apply(this,arguments);return a&&a.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()}).replace(/^ms-/,"-ms-")},B.Modernizr.addTest("transitionend",function(){var a,b=document.createElement("fakeelement"),c={OTransition:"otransitionend",MSTransition:"msTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"};for(a in c)if(void 0!==b.style[a])return b=null,c[a]}),B.Modernizr.addTest("dpr",function(){return window.devicePixelRatio}),B.Modernizr.addTest("retina",function(){return B.Modernizr.dpr>1&&B.Modernizr.backgroundsize}),B.Modernizr.addTest("ie",function(){return navigator.userAgent.indexOf("MSIE")>0}),B.Modernizr.addTest("requestAnimationFrame",function(){return B.Modernizr.prefixed("requestAnimationFrame",window)}),B.extend(B,{}),B.SCookie=window.__PH&&window.__PH.cookie&&window.__PH.cookie.s,v.prototype={getQuery:function(){var a=B.bind(this.invoke,this);return a.replace=B.bind(this.replace,this),a},invoke:function(){this._fn?this._fn.apply(this._context,arguments):this._invocations.push(arguments)},replace:function(a,b){if(!this._fn){b=b||window;for(var c=0,d=this._invocations.length;d>c;c++)a.apply(b,this._invocations[c]);delete this._invocations,this._fn=a,this._context=b}}},B.DeferredQuery=v,w.prototype={emit:function(a,b,c){function d(){--g||c&&c()}void 0==b&&(b={});var e=this.listeners(a);if(!e)return void(c&&c());e=e.slice();for(var f=new w.Event(a,b),g=e.length,h=0,i=g;i>h;h++){var j=e[h];if("function"==typeof j)try{j.call(this,f,d)}catch(k){d()}}},listeners:function(a){return this._events&&this._events[a]&&this._events[a].length&&this._events[a]},addListener:function(a,b){if("function"!=typeof b)throw new Error("invalid argument");return this._events||(this._events={}),this._events[a]||(this._events[a]=[]),this._events[a].push(b),this.emit("newlistener",{type:a,listener:b}),this},once:function(a,b){function c(){this.removeListener(a,c),b.apply(this,arguments)}if("function"!=typeof b)throw new Error("invalid argument");return this.on(a,c),this},removeListener:function(a,b){if("function"!=typeof b)throw new Error("invalid argument");if(!this._events[a])return this;var c=this._events[a],d=c.indexOf(b);return 0>d?this:(c.splice(d,1),0===c.length&&delete this._events[a],this)}},w.prototype.on=w.prototype.addListener,w.Event=function(a,b){this.type=a,this.data=b},w.relay=function(a,b,c){for(var d=0,e=a.length;e>d;d++){var f=a[d];b.on(f,function(a){return function(){c.emit(a)}}(f))}},B.EventEmitter=w,B.extend(A,B.EventEmitter.prototype,{}),A.isLoaded=function(){return A._loaded||!1},A.whenLoaded=function(a){A.isLoaded()?a():A.on("load",a)},B.SCookie=window.__PH&&window.__PH.cookie&&window.__PH.cookie.s,A.regionSelector=new B.EventEmitter,B.extend(A.regionSelector,{show:(new B.DeferredQuery).getQuery(),hide:(new B.DeferredQuery).getQuery(),enabled:function(){return A.settings.regionsSelectorEnabled}}),A.draw=(new B.DeferredQuery).getQuery(),A.getItems=(new B.DeferredQuery).getQuery(),A.batchActions=(new B.DeferredQuery).getQuery(),B.initInline=function(){B.SCookie=window.__PH&&window.__PH.cookie&&window.__PH.cookie.s,B.addClass(B.rootNode,A.settings.rootClass+"_boxshadow-"+(B.Modernizr.boxshadow?"yes":"no")),A.settings.regionsSelectorEnabled=!!window.__PortalRegions,B.SCookie||(A.settings.regionsSelectorEnabled=!1),A.settings.submenu&&(document.getElementById(A.settings.rootClass+"__submenu").style.display="",document.getElementById("w-"+A.settings.cssPrefix+"-menu__shadow").style.display="none"),B.rootNode.className=B.rootNode.className},B.rootNode?B.initInline():A.init=(new B.DeferredQuery).getQuery(),function(a,b,c,d){"use strict";function e(a,b){var c,e;if(b===d&&(b={}),b.hasOwnProperty("constructor")?(c=b.constructor,delete b.constructor):c=a?function(){a.prototype.constructor.apply(this,arguments)}:function(){},c=function(a){return function(){return k.apply(this,arguments),a.apply(this,arguments)}}(c),a){var f=function(){};f.prototype=a.prototype,c.prototype=new f,c.prototype.constructor=c,c.superclass=a;for(e in b)b.hasOwnProperty(e)&&(c.prototype[e]=b[e])}else for(e in b)b.hasOwnProperty(e)&&(c.prototype[e]=b[e]);return c}function f(a,b,i,j){if(1==a.nodeType)return g(a);"string"!=typeof b&&(j=i,i=b,b=d);var k=f.constructors[b]||r;"function"==typeof i&&(i=i(k.prototype)),"function"==typeof j&&(j=j(k));var l=f.constructors[a]=e(k,i);if(l.prototype.hasOwnProperty("onMod")){var m=k.prototype.onMod,n=l.prototype.onMod;for(var q in m)!n.hasOwnProperty(q)&&m.hasOwnProperty(q)&&(n[q]=m[q])}j&&j.abstract!==!0&&(j.abstract=!1),j=c.extend({},k._statics||{},j||{}),c.extend(l,{"abstract":!1,className:"."+a,mods:k.mods,forced:k.forced,delegate:k.delegate,_statics:j},j),l.__super=k,l.abstract||(o||(A.settings.regionsSelectorEnabled?p:c(B.rootNode)).on(f.activationEvents,h),o++)}function g(a){if(a){if(1==a.nodeType){var b=a.getAttribute(f.idAttr);if(b)return f.nodes[b]}var c=a.className&&a.className.match&&a.className.match(m);if(c)for(var d=c.length;d--;){var e=f.constructors[c[d]];if(e)return i(e,a)}}}function h(a){for(var d=a.target;b!==d&&null!==d;){var e=d.className&&d.className.match&&d.className.match(m);if(e)for(var g=e.length;g--;){var j=e[g];if(j in f.constructors){var k=f.constructors[j];k.active||k.abstract||(o--,i(k,d,a))}}d=d.parentNode}o||(A.settings.regionsSelectorEnabled?p:c(B.rootNode)).off(f.activationEvents,h)}function i(a,b,d){if(!a.active){a.active=!0;var e=[],g={};a.mods&&c.each(a.mods.split(n),function(a,b){b in f.autoMods&&e.push(f.autoMods[b])}),a.delegate&&c.each(a.delegate,function(a,b){for(var c=a.trim().toLowerCase().split(n),d=c.length;d--;)a=c[d],g[a]=b,-1===e.indexOf(a)&&e.push(a)}),a.eventHandler=g,(A.settings.regionsSelectorEnabled?p:c(B.rootNode)).on(e.join(" "),a.className,j)}if(b&&!b.getAttribute(f.idAttr)){var h=new a(b);return d&&h.onEvent(d),h}}function j(a){g(a.currentTarget).onEvent(a)}function k(a){this.name=this.constructor.className.slice(1),this.$el=c(a),this.el=a,this.id=++f.id,this.mods={},f.nodes[this.id]=this;var b={};b[f.idAttr]=this.id,this.role&&(b.role=this.role),this.$el.attr(b)}String.prototype.trim===d&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var l=Array.prototype.slice,m=/\b([a-zA-Z0-9\-]+(?:__[a-zA-Z0-9\-]+)*)\b/g,n=/\s+/g,o=0,p=c(b),q=function(a,b){for(var c,d=[];c=a.exec(b);)d.push(c);return d};c.extend(f,{emptyFn:function(){},constructors:{},nodes:{},idAttr:"bem-id",autoMods:{focus:"focusin focusout"},eventMod:{focusin:["focus",!0],focusout:["focus",!1]},timeoutMods:{focus:!0},activationEvents:"",autoGC:!0,id:0});var r=e(d,{constructor:function(){var a=q(RegExp("\\b"+this.name+"_([a-zA-Z0-9-]+)(_[a-zA-Z0-9-]+)?\\b","g"),this.el.className);if(a){this.silent=!0;for(var b=a.length;b--;){var c=a[b][1],d=a[b][2];this.mods[c]=d?d.slice(1):!0,this.triggerMod(c,this.mods[c])}this.silent=!1}if(this.events)for(var e in this.events)this.on(e,this.events[e])},onMod:{"*":f.emptyFn},triggerMod:function(a,b,c){var e=this.onMod,f=c||e["*"].call(this,a,b),g="string"==typeof b?b:"";if(f!==!1){var h=e[a];if(h===!1)f=!1;else if(h){var i=typeof h;"string"===i?f=this[h](b,a):"object"===i?(h["*"]!==d&&(f=h["*"].call(this,b,a)),f!==!1&&h[g]!==d&&(f=h[g].call(this,b,a))):f=h.call(this,b,a)}f!==!1&&c!==!0&&g&&this.triggerMod(a+"_"+g,b,!0)===!1&&(f=!1)}return f},onEvent:function(a){function b(){j!==d&&(c="string"==typeof j?this[j](a):j.call(this,a)),c!==!1&&h!==d&&-1!=i.mods.indexOf(h[0])&&this.mod(h[0],h[1])}var c,e,g=a.type,h=f.eventMod[g],i=this.constructor,j=i.eventHandler[g],k=!(void 0!==h&&f.timeoutMods[h[0]]===!0);if(h&&g.indexOf("key")>-1)if("press"==h[0]){if(13!=a.which)return}else"focus"==h[0]&&(k=!0);if(k||void 0===h||(this._timeMode||(this._timeMode={}),e=this._timeMode[h[0]]||(this._timeMode[h[0]]={})),void 0===h)b.call(this);else if(k){for(var l in this._timeMode)if(this._timeMode.hasOwnProperty(l)){var m=this._timeMode[l];m._setTimeout&&(clearTimeout(m._setTimeout),m._setTimeout=null,m._setTimeoutFn()),m._unsetTimeout&&(clearTimeout(m._unsetTimeout),m._unsetTimeout=null,m._unsetTimeoutFn())}b.call(this)}else clearTimeout(e._setTimeout),clearTimeout(e._unsetTimeout),e._setTimeout=e._unsetTimeout=null,e["_"+(h[1]?"":"un")+"setTimeoutFn"]=function(){this.destroyed||(clearTimeout(e._setTimeout),clearTimeout(e._unsetTimeout),e._setTimeout=e._unsetTimeout=null,b.call(this))}.bind(this),e["_"+(h[1]?"":"un")+"setTimeout"]=setTimeout(e["_"+(h[1]?"":"un")+"setTimeoutFn"],50)},s:function(a){return"string"==typeof a&&"__"==a.slice(0,2)?"."+this.name+a:a},$:function(a){var b=this.$el;return a!==d&&(b=b.find(this.s(a))),b},eventNS:function(a){return(a?a.split(n).join("."+this.id+" "):"")+"."+this.id},on:function(a,b,c){return c===d&&(c=b,b=d),this.$el.on(this.eventNS(a),this.s(b),c.bind(this)),this},off:function(a,b){return this.$el.off(this.eventNS(a),this.s(b)),this},onOutside:function(a,b){return p.on(this.eventNS(a),function(a){c(a.target).closest(this.el).length||b.apply(this,arguments)}.bind(this)),this},offOutside:function(a){return p.off(this.eventNS(a)),this},trigger:function(a,b){return this.silent||this.$el.trigger(a,b),this},getClassNameFor:function(a,b){return this.name+"_"+a+("string"==typeof b?"_"+b:"")},mod:function(a,b){if(b===d)return this.mods[a];var c=this.mods[a];if(c===d&&(c=!1),c!==b&&this.triggerMod(a,b)!==!1){var e=this.getClassNameFor(a,c);e=(" "+this.el.className+" ").replace(" "+e+" "," "),this.mods[a]=b,b&&(e+=this.getClassNameFor(a,b)+" "),this.el.className=e.trim(),this.$el.triggerHandler("mod:"+a,b)}return this},hasMod:function(a,b){var c=this.mods[a];return b===d?!!c:c==b},addMod:function(a,b){return this.mod(a,b?b:!0)},delMod:function(a,b){return(b===d||this.hasMod(a,b))&&this.mod(a,!1),this},toggleMod:function(a,b){return this.mod(a,b===d?!this.hasMod(a):b)},elem:function(a){var b=this.s("__"+a);return g(this.$(b)[0])},debounce:function(a,b){var c,d,e=this;return"string"==typeof a&&(a=this[a]),function(){d=arguments,clearTimeout(c),c=setTimeout(function(){a.apply(e,d)},b)}},throttle:function(a,b){var c,d,e=this;return"string"==typeof a&&(a=this[a]),function f(){d=!0,c||(d?(a.apply(e,arguments),d=!1,c=setTimeout(f,b)):c=null)}},delegate:function(a,b){return p.on(this.eventNS(a),b.bind(this)),this},undelegate:function(a){return p.off(this.eventNS(a)),this},one:function(a,b,c){return c===d&&(c=b,b=d),this.$el.one(this.eventNS(a),this.s(b),c.bind(this)),this},isDisabled:function(){return this.mod("disabled")},inDOM:function(){var a=this.el;return a&&(a=a.parentNode)&&a.nodeType>0},destroy:function(a){this.destroy=f.emptyFn,delete f.nodes[this.id],this.off(),this.$el.removeAttr(f.idAttr).find("["+f.idAttr+"]").bem("destory"),p.off("."+this.id),a&&this.$el.remove();for(var b in this)this.hasOwnProperty(b)&&delete this[b];this.destroyed=!0}});if(c.extend(r,{mods:null,forced:!1,delegate:null}),c.bem=f,c.fn.bem=function(a,b){var c;return a===d?g(this[0]):("init"===a?f.init(this):"dispose"===a?this.find("["+f.idAttr+"]").add(this).each(function(a,b){var c=f.nodes[b.getAttribute(f.idAttr)];c&&c.destroy()}):this.each(function(){var d=g(this);d&&(c=a in d?d[a].apply(d,l.call(arguments,1)):d.mod(a,b))}),c===d?this:c)},f.init=function(a){c.each(f.constructors,function(b,c){if(c.forced)for(var d="."+b,e=a.find(d).add(a.filter(d)),f=e.length;f--;)i(c,e[f])})},f.gc=function(a){a=a||f.emptyFn;var b,c;for(b in f.nodes)f.nodes.hasOwnProperty(b)&&(c=f.nodes[b],c.inDOM()||a(c,b)===!1||c.destroy())},f.autoGC){var s=a.MutationObserver||a.WebKitMutationObserver||a.MozMutationObserver;if(s){var t=new s(function(a){a.forEach(function(a){if("childList"===a.type){var b,d;for(d in a.addedNodes)1===(b=a.addedNodes[d]).nodeType&&c(b).bem("init");for(d in a.removedNodes)1===(b=a.removedNodes[d]).nodeType&&c(b).bem("dispose")}})});t.observe(b,{childList:!0,subtree:!0})}else f.autoGC=!1}c(function(){f.init(A.settings.regionsSelectorEnabled?p:c(B.rootNode))}),f.$=c;var u=a.BEM;a.BEM=f,f.noConflict=function(){var b=a.BEM;return a.BEM=u,b}}(window,document,window.jQuery),function(a,b,c){b.extend(a.autoMods,{press:"mousedown mouseup keydown keyup",hover:"mouseenter mouseleave mouseover",focus:"blur focus"}),b.extend(a.eventMod,{mousedown:["press",!0],mouseup:["press",!1],mouseenter:["hover",!0],mouseover:["hover",!0],mouseleave:["hover",!1],focus:["focus",!0],blur:["focus",!1],keydown:["press",!0],keyup:["press",!1]}),b.extend(a.timeoutMods,{focus:!0,hover:!0,press:!1}),a.activationEvents+=" mouseover mousedown click focusin",a("bemjs__control",function(d){return{constructor:function(){d.constructor.apply(this,arguments),this._getConfig()},_getConfig:function(){var c=a.helpers.getConfig(this.el);if(this.blockname&&!c)for(var d=this.$el.parent()[0],e=new RegExp("\\b"+this.blockname,"g");e&&d.className.match(e)&&!(c=a.helpers.getConfig(d));)d=b(d).parent()[0];this._config=c},onMod:{disabled:function(a){var b={disabled:a,"aria-disabled":a};a&&(this._href=this.$el.prop("href"),this._tabIndex=this.$el.prop("tabIndex")),this.$el.attr(b).attr("href",a?null:this._href).attr("tabIndex",a?null:this._tabIndex),this.$("button, select, input, textarea").attr(b),a&&this.delMod("focus press")},hover:function(a){a||setTimeout(function(){this.mod("press",!1)}.bind(this),0)},press:function(a){a?this.trigger("press"):this.hasMod("hover")&&this.trigger("release")},"*":function(a,b){return b&&this.isDisabled()?!~"press focus checked".indexOf(a):void 0}},href:function(a){return a!==c?(this._href=a,this.isDisabled()||this.$el.attr("href",a),this):this.$el.attr("href")||this._href},getAPI:function(){if(this.api)return this.api;var a=new B.APIProxy({api:{},context:this,target:this._targetEl});return this.api=a,a}}},{"abstract":!0,mods:"press focus",getConfig:function(a){return this.configs&&"function"==typeof this.configs[a[a.type+"Type"]]&&(a=this.configs[a[a.type+"Type"]](a)),a._config=b.extend(!0,{},a),a.collapsePriority||(a.collapsePriority=1),a.adaptive&&("button"!=a.type||a.iconCls&&a.text&&!a.submenu&&!a.alwaysCollapsed||(a.adaptive=void 0)),a},create:function(a){var b=this.getEls(a);return b[0].config=a,b.bem()},fn:function(){},getEls:function(a){return a=this.getConfig(a),B.$(B.tmpl({block:this.className.replace("."+A.settings.cssPrefix+"-",""),params:a}))}})}(window.BEM,window.BEM.$),function(a,b){b.prepareMods=function(a,b){if(b){if(Array.isArray(b)||"string"==typeof b){var c={};c[a]=b,b=c}for(var d in b)b.hasOwnProperty(d)&&"__"==d.substr(0,2)&&(b[a+d]=b[d],delete b[d])}return b||{}},b.getClass=function(a,c,d,e){var f,g,h=[];return c&&(g="__"==c.substr(0,2)?a+c:a+"__"+c),d=b.prepareMods(a,d),g?(e&&h.push(b.getelFullNameClass(g,e)),d["*"]&&h.push(b.getelFullNameClass(g,d["*"])),d[g]&&h.push(b.getelFullNameClass(g,d[g]))):(e&&h.push(b.getelFullNameClass(a,e)),d["*"]&&h.push(b.getelFullNameClass(a,d["*"])),d[a]&&h.push(b.getelFullNameClass(a,d[a]))),h.length&&h.unshift(" "),f=A.settings.cssPrefix+"-"+(g||a)+h.join(" ")},b.getelFullNameClass=function(b,c){var d=[];"string"==typeof c&&(c=a.$.trim(c).split(" "));for(var e=0,f=c.length;f>e;e++){var g=c[e];d.push("_"==g.substr(0,1)?A.settings.cssPrefix+"-"+b+g:g)}return d.join(" ")},b.addMod=function(a,c,d,e){var f;return c=b.prepareMods(a,c||{}),f=d===a||""===d?a:"*"!=d?"__"==d.substr(0,2)?a+d:a+"__"+d:d,c[f]?c[f]+=" "+e:c[f]=e,c};var c={},d=0;b.setConfig=function(a){var b=d;return d++,c[b]=a,b},b.getConfig=function(a){return c[a.getAttribute("data-config-id")]};var e={};for(var f in b)b.hasOwnProperty(f)&&(e["_"+f]=b[f]);b.tmpl=function(){return fest[A.settings.cssPrefix+"-templates.xml"].apply(e,arguments)}}(window.BEM,window.BEM.helpers||(window.BEM.helpers={}));var A=window.__PM,B=A._;if(!A._loaded){var I={projects:{config:{mail:{href:"https://mail.my.com/"},games:{href:"https://games.my.com/"}}}};"undefined"==typeof window&&"function"==typeof require&&"undefined"!=typeof module&&(module.exports=I);var J,K=B.BEM=window.BEM.noConflict();J=B.$="function"==typeof jQuery?jQuery:window.jQuery;{B.tmpl=K.helpers.tmpl}if("undefined"!=typeof externalCss){var L=document.createElement("style"),M=externalCss;L.type="text/css",L.styleSheet?L.styleSheet.cssText=M:L.appendChild(document.createTextNode(M)),B.rootNode.insertBefore(L,B.rootNode.firstChild)}!function(a){function b(a){a||(a={});var c=a.context,d=this;a.api.off=function(b,e){return(a.target||c).off.call(a.target||c,b,e.bind(d))},a.api.on=function(b,e){return(a.target||c).on.call(a.target||c,b,e.bind(d))},b.extend(this,c,a.api)}J.extend(b,{extend:function(a,b,c){for(var d in c)if(c.hasOwnProperty(d)){var e=c[d];a[d]="function"==typeof e?e.bind(b):e}}}),a.APIProxy=b}(B),function(a){var b=function(a,c){if(a.length<=1)return a;for(var d=Array(),e=Array(),f=Math.floor(a.length/2),g=a.splice(f,1)[0],h=0;h<a.length;h++)!c&&(a[h]<g||a[h]==g&&f>h)||c&&(a[h][c]<g[c]||a[h][c]==g[c]&&f>h)?d.push(a[h]):e.push(a[h]);return b(d,c).concat([g],b(e,c))};a.qsort=b}(B),B.Queue=x,function(a,b){a(A.settings.cssPrefix+"-overlay","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this.on("click",function(){}),this._els=0,this.onResize=this.onResize.bind(this)},show:function(){this._els++,this.addMod("visible")},hide:function(){this._els--,this.delMod("visible")},onResize:function(){this.$el.outerHeight(b(document).outerHeight())},onMod:{visible:function(a){if(a)this.addMod("show"),b(window).on("resize",this.onResize),this.onResize();else{if(this._els)return!1;this.delMod("show"),b(window).off("resize",this.onResize)}}}}},{mods:"visible ready show"})}(B.BEM,B.BEM.$),function(a){a(A.settings.cssPrefix+"-toolbar__item","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._targetEl=this;var b=this;if(this._config&&this._config.events)for(var c in this._config.events)this._config.events.hasOwnProperty(c)&&this.on(c,function(a){return function(){return a.apply(b.getAPI&&b.getAPI()||b,arguments)}}(this._config.events[c]));this._config&&(this.adaptive=this._config.adaptive,this.alwaysCollapsed=this._config.alwaysCollapsed),this.collapsePriority=this._config&&this._config.collapsePriority||1},onMod:{hidden:function(a){this.el.style.display=a?"none":""}},collapse:function(){return 0},getAPI:function(){this.toolbar=this.toolbar||this.$el.closest("."+A.settings.cssPrefix+"-toolbar").bem();var b=a.getAPI.call(this),c={show:function(){this.toolbar.enqueue(function(){this.delMod("hidden")}.bind(this)),this.toolbar.updateGroups()},hide:function(){this.toolbar.enqueue(function(){this.addMod("hidden")}.bind(this)),this.toolbar.updateGroups()},el:this.el};if(this._items){c.items=[],c.itemsByName={};for(var d=0,e=this._items.length;e>d;d++){var f=this._items[d];f.hasMod("more")||(c.items.push(f.getAPI()),f._config.name&&(c.itemsByName[f._config.name]?(Array.isArray(c.itemsByName[f._config.name])||(c.itemsByName[f._config.name]=[c.itemsByName[f._config.name]]),c.itemsByName[f._config.name].push(f.getAPI())):c.itemsByName[f._config.name]=f.getAPI()))}}return B.APIProxy.extend(b,this,c),b}}},{})}(B.BEM,B.BEM.$),function(a){var b,c=null;a(A.settings.cssPrefix+"-toolbar__button",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){this._inner=this.$("__inner").bem(),this._targetEl=this._inner,a.constructor.apply(this,arguments),this._numbers=this.$("__numbers").bem(),this.type="button",this._dropdown=this.$el.children(".js-dropdown").bem(),this.showDropdownOnClick=this._dropdown&&this._dropdown._config.showOnClick,this.hideDropdownByInnerClick=this._dropdown&&this._dropdown._config.hideByInnerClick,this.updateFullWidth(),this.on("click",function(){}),this._dropdown&&this.showDropdownOnClick&&(this.onOutside("click",function(){this.delMod("open")
}.bind(this)),this._dropdown.on("click",function(){this.hideDropdownByInnerClick&&this.delMod("open")}.bind(this)))},collapse:function(a){return this.adaptive?(this[a?"addMod":"delMod"]("notext"),a?0:this.adaptiveWidth):0},updateFullWidth:function(){this.adaptive&&(this.fullWidth=this.$el.width(),this.collapse(!0),this.collapsedWidth=this.$el.width(),this.adaptiveWidth=this.fullWidth-this.collapsedWidth)},onMod:{notext:function(a){this._inner.mod("notext",a),this._inner.mod("text",!a)},hover:function(a){this.showDropdownOnClick||this[a?"addMod":"delMod"]("open")},focus:function(a){},disabled:function(a){this._inner&&this._inner.toggleMod("disabled",a)},current:function(a){function b(){this.toolbar=this.toolbar||this.$el.closest("."+A.settings.cssPrefix+"-toolbar").bem(),this.toolbar.currentButton&&this.toolbar.currentButton!==this&&!this.toolbar.currentButton.destroyed&&this.toolbar.currentButton.delMod("current"),this.toolbar.currentButton=this}a&&(this.toolbar?b.call(this):setTimeout(b.bind(this),0)),this._inner&&this._inner.mod("current",!!a)},open:function(a){return this._dropdown?(this._inner.mod("open",a),this._dropdown.mod("visible",a),a&&(b&&b!=this&&!b.destroyed&&b.delMod("open"),b=this),void 0):!1},"*":function(a){return-1!=["open","press","hover"].indexOf(a)&&this.hasMod("disabled")?!1:void 0}},setIcon:function(a,b){a&&this._config.iconCls&&(this._inner._icon._img.removeClass(this._config.iconCls),this._config.iconCls=a,this._inner._icon._img.addClass(this._config.iconCls),this._inner._icon.change(a)),b&&this._config.iconClsInverted&&(this._inner._iconInverted._img.removeClass(this._config.iconClsInverted),this._config.iconClsInverted=b,this._inner._iconInverted._img.addClass(this._config.iconClsInverted),this._inner._iconInverted.change(b))},getAPI:function(){var b=a.getAPI.call(this);this.toolbar=this.toolbar||this.$el.closest("."+A.settings.cssPrefix+"-toolbar").bem();var c={disable:function(){this.addMod("disabled")},enable:function(){this.delMod("disabled")},setNumber:function(a){this._numbers.setNumber(a)},setCurrent:function(a){this.mod("current",!!a)},setText:function(a){this.toolbar.enqueue(function(){this._inner._textInner&&this._inner._textInner.html(a),this.width=void 0}.bind(this)),this.toolbar.updateGroups()},setIcon:this.setIcon,linkEl:this._inner.el};return this._dropdown&&(c.dropdown=this._dropdown.getAPI(),c.isOpened=function(){return this._dropdown&&this._inner.hasMod("open")&&this._dropdown.mod("visible")}),B.APIProxy.extend(b,this,c),b}}},function(b){return{mods:"open hover focus",configs:{more:function(a){return a.mods="_more",a.text||(a.text="Ещё"),a},avatar:function(a){if(a.avatar)a.iconBg=a.avatar;else if(a.login){var b=B.Modernizr.retina?90:32;a.iconBg="//filin.mail.ru/pic?email="+a.login+"&width="+b+"&height="+b+"&name="+encodeURIComponent(a.userName||a.login)}else a.hidden=!0;return a.iconCls=A.settings.cssPrefix+"-toolbar__button__avatar",a.iconClsInverted=A.settings.cssPrefix+"-toolbar__button__avatar_inverted",a.alwaysVisible=!0,a}},getConfig:function(c){c=b.getConfig.call(this,c);for(var d=c.attrs||{},e=["href","title","id","rel","target"],f=0,g=e.length;g>f;f++){var h=e[f];c[h]&&(d[h]=c[h])}return c.attrs=d,c.dropdown&&"string"!=typeof c.dropdown&&(c.dropdown.submenu=c.submenu,c.dropdown=a.constructors[A.settings.cssPrefix+"-toolbar__dropdown"].getConfig(c.dropdown)),c.dropdown&&!c.iconClsInverted&&(c.iconClsInverted=c.iconCls+"-i"),c.submenu&&(c.buttonType&&"more"!=c.buttonType||!c.text?c=void 0:c.banner!==!0),c}}}),a(A.settings.cssPrefix+"-toolbar__button__inner","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._button=this.$el.closest(".js-button").bem(),this._icon=this.$el.find(".js-icon").bem(),this._iconInverted=this.$el.find(".js-icon-inverted").bem(),this._text=this.$el.find(".js-text").bem(),this._text&&(this._textInner=this._text.$el.find(".js-text-inner")),this._icon&&this._icon.change(this._icon.$el.data("icon"),this._icon.$el.data("icon-num")),this._iconInverted&&this._iconInverted.change(this._icon.$el.data("icon"),this._icon.$el.data("icon-num")),this.onClick=this.onClick.bind(this),this.on("click",this.onClick)},role:"button",onMod:{notext:function(a){this._icon&&this._icon.mod("notext",a),this._iconInverted&&this._iconInverted.mod("notext",a),this._icon&&this._icon.mod("text",!a),this._iconInverted&&this._iconInverted.mod("text",!a),this._text&&this._text.mod("notext",a)},press:function(a){this._button&&!a&&this._button.showDropdownOnClick&&this._button.toggleMod("open"),this._text&&this._text.toggleMod("press",a),this._icon&&this._icon.toggleMod("press",a),this._iconInverted&&this._iconInverted.toggleMod("press",a)},open:function(a){this.hasMod("dropdown")&&(this._iconInverted&&this._iconInverted.toggleMod("open",a),this._icon&&this._icon.toggleMod("open",a))},"*":function(a,b){if(-1!=["open","press","hover"].indexOf(a)&&this.hasMod("disabled"))return!1;if("disabled"==a&&b&&(this.delMod("hover"),this.delMod("focus"),this.delMod("press")),-1!=["hover","focus"].indexOf(a)){if("hover"==a&&c&&!c.destroyed){c.delMod("focus");try{c.el.blur()}catch(d){}}b&&(c=this)}}},onClick:function(a){this._button._dropdown&&this._button.showDropdownOnClick&&a.preventDefault()}}},{mods:"press focus hover open",delegate:{}}),a(A.settings.cssPrefix+"-toolbar__button__numbers","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this.setNumber(parseInt(this.$el.html(),10))},setNumber:function(a){this._number=parseInt(a,10),isNaN(this._number)&&(this._number=0);var b=!!this._number,c=1==(""+this._number).length;a=this._number,a>99&&(a="99+"),this.$el.html(a),this.toggleMod("one-digit",c),this.toggleMod("visible",b)},getNumber:function(){return this._number}}},{mods:""}),a(A.settings.cssPrefix+"-toolbar__button__icon","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._img=this.$("__img"),this._num=this.$("__num"),this._img.css({left:(this.$el.width()-this._img.width())/2,top:(this.$el.height()-this._img.height())/2})},change:function(a,b){function c(){this._num&&this._num.html((new Date).getDate()),this._setNumTimeout=setTimeout(c.bind(this),6e4)}a==A.settings.cssPrefix+"-uh-calendar"||a==A.settings.cssPrefix+"-uh-calendar"||"calendar"==b?(this._numMod="calendar-num",this.addMod(this._numMod),c.call(this)):(this.delMod(this._numMod),this._numMod=null,clearTimeout(this._setNumTimeout),this._num.html(""))}}},{mods:"open"}),a(A.settings.cssPrefix+"-toolbar__button__text","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}},{mods:"press"})}(B.BEM,B.BEM.$),function(a,b){var c=a.constructors[A.settings.cssPrefix+"-toolbar__button"];b.extend(c.configs,{region:function(a){return a.alwaysVisible=!0,a.mods||(a.mods=[]),a.mods.push("active"),delete a.dropdown,delete a.items,delete a.iconCls,a.text="null"!=window.__PortalRegions.effRegion.name&&window.__PortalRegions.effRegion.name?window.__PortalRegions.effRegion.name:"Москва",a}})}(B.BEM,B.BEM.$),function(a,b){a(A.settings.cssPrefix+"-toolbar__dropdown",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){function c(a,b){b&&(clearTimeout(g._openTimeout),g._openTimeout=setTimeout(function(){var a=!1;g.openedItem&&(g.openedItem._inner.mod("open",!1),g.openedItem.col.mod("visible",!1),a=!0),this.col?(this._inner.mod("open",!0),this.col.mod("visible",!0),g.cols[0].addMod("open"),g.openedItem=this,a=!0):g.cols[0].hasMod("open")&&(g.cols[0].delMod("open"),a=!0),a&&g.updateCols()}.bind(this),50))}a.constructor.apply(this,arguments);var d=this.$el.children("."+A.settings.cssPrefix+"-toolbar__dropdown__col");this.cols=[];for(var e=0,f=d.length;f>e;e++)this.cols.push(d.eq(e).bem());for(var g=this,h=this.cols[0].$el.children("."+A.settings.cssPrefix+"-toolbar__dropdown__item"),e=0,f=h.length;f>e;e++){var i=h.eq(e).bem(),j=this.$el.children('[data-order="'+i.$el.data("submenu-order")+'"]');j&&j.length&&(i.col=j.bem()),i.on("mod:hover",c)}this._config.maxWidth&&this.$el.css("maxWidth",this._config.maxWidth),b(window).on("resize",this.resize.bind(this))},resize:function(){!this.destroyed&&this.hasMod("visible")&&(this.reset(),this.updateCols())},reset:function(){this.delMod("left"),this.delMod("right"),this._opened=void 0},updateCols:function(){var a=0,b=0,c=this.el.parentNode,d=c.clientWidth,e=0,f=0,g=this.cols[1]&&this.cols[1].hasMod("level",2);c.style.overflow="hidden",this.el.style.width="";for(var h=0,i=this.cols.length;i>h;h++)this.cols[h].el.style.width="",this.cols[h].el.style.left="",this.cols[h].el.style.right="",this._opened||0==h||(this.cols[h].el.style.display="block",g?f=Math.max(f,this.cols[h].el.clientWidth):f+=this.cols[h].el.clientWidth,this.cols[h].el.style.display="");if(this._opened||(e=this.cols[0].el.clientWidth+f),1==this.cols.length){var j=this.cols[0];j.el._left="0px",a=j.el.clientWidth,b=j.el.clientHeight,d>=a&&(j.el._width=d)}else for(var h=0,i=this.cols.length;i>h;h++){var k,j=this.cols[h],l=j.el.clientWidth,m=j.el.clientHeight;l?(k=d>=l?l=d:0,j.el._left=a+"px",a+=l,j.el._width=k):(j.el._left=0,j.el._width=0),b=Math.max(m,b)}if(a=Math.max(a,d),this.el.style.width=a+"px",this.el.style.height=b+"px",!this._opened){var n,o=this.$el.parent(),p=o.offset().left,q=B.rootNode.clientWidth,r=q-p;r>=e?this.direction="right":(n=p+o.outerWidth(!0),this.direction=r>n?"right":"left"),this.redirection="left"==this.direction?"right":"left"}this.delMod(this.redirection),this.addMod(this.direction);for(var h=0,i=this.cols.length;i>h;h++){var j=this.cols[h];g?(j.el.style[this.redirection]=j.el._left,0==h?(j.addMod(this.redirection),j.delMod(this.direction)):(j.addMod(this.direction),j.delMod(this.redirection))):j.el.style.left=j.el._left,j.el.style.width=j.el._width?j.el._width+"px":""}this._opened=!0,c.style.overflow=""},onMod:{visible:function(a){this._ton&&this._ton.cancel(),this._toff&&this._toff.cancel(),a?this._ton=B.animate(null,function(){this.addMod("show")}.bind(this),{before:{fn:function(){this.addMod("ready"),this.updateCols()}.bind(this)}}):this._toff=B.animate(this.el,function(){this.delMod("show")}.bind(this),{after:{prop:"opacity",fn:function(){this.delMod("ready"),this.reset(),this.openedItem&&(this.openedItem._inner.mod("open",!1),this.openedItem.col.mod("visible",!1))}.bind(this)}})}},getAPI:function(){var b=a.getAPI.call(this),c={resize:this.resize,hide:function(){this._ton()}.bind(this),show:function(){this._toff()}.bind(this)};return B.APIProxy.extend(b,this,c),b}}},{mods:"visible right left show ready",getConfig:function(a,b){if(a=this._setAttrs(a),b=b||1,void 0===a.type&&1==b&&a.items&&a.items.length&&(a.items=[{items:a.items}]),"string"==typeof a.html)a.items=a.html;else{if(!a.items||!a.items.length)return void 0;for(var c=0,d=0;d<a.items.length;d++){var e=a.items[d];if("string"!=typeof e)if(this._setAttrs(e),e.mods="_level_"+(e.level||1),"order"in e&&(e.attrs["data-order"]=e.order),"string"==typeof e.html)e.items=e.html;else for(var f=0,g=e.items.length;g>f;f++){var h=e.items[f];if("string"!=typeof h)if(this._setAttrs(h),"string"==typeof h.html);else{if(h.dropdown&&h.dropdown.items&&h.dropdown.items.length&&"cols"!==a.type&&!e.level){var i=h.dropdown.items;if("cols"==h.dropdown.type)for(var j={items:[],level:2,order:c},k=0,l=i.length;l>k;k++){var m=i[k];if("string"!=typeof m.html)for(var n=0,o=m.items.length;o>n;n++)j.items.push(m.items[n])}else var j={items:i,level:2,order:c};h.submenuOrder=c,c++,a.items.push(j)}"submenuOrder"in h&&(h.attrs["data-submenu-order"]=h.submenuOrder)}}}}return a.showOnClick=a.showOnClick||!1,a.hideByInnerClick="hideByInnerClick"in a?a.hideByInnerClick:!0,a},_setAttrs:function(a){for(var b=a.attrs||{},c=["href","title","id","rel","target"],d=0,e=c.length;e>d;d++){var f=c[d];a[f]&&(b[f]=a[f])}return a.attrs=b,a}}),a(A.settings.cssPrefix+"-toolbar__dropdown__col","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)},onMod:{show:function(){}}}},{}),a(A.settings.cssPrefix+"-toolbar__dropdown__item","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._inner=this.$("__inner").bem()},onMod:{hidden:function(){},disabled:function(a){this._inner&&this._inner.mod("disabled",a)},hover:function(){},current:function(a){this._inner&&this._inner.mod("current",!!a)}},role:"button"}},{mods:"press hover focus"}),a(A.settings.cssPrefix+"-toolbar__dropdown__item__inner","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)},role:"button"}},{mods:"press hover open focus"})}(B.BEM,B.BEM.$),function(a){a(A.settings.cssPrefix+"-toolbar__separator",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this.type="separator"}}})}(B.BEM,B.BEM.$),function(a,b){a(A.settings.cssPrefix+"-toolbar__group",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this.collapsible="true"===this.$el.attr("data-collapsible"),this.$el.is(":first-child")&&(this.first=!0),this.$el.is(":last-child")&&(this.last=!0)},expand:function(a){if(a>=0)for(var b=0,c=this._collapsibleItems.length;c>b;b++){var d=this._collapsibleItems[b];("spacer"!=d.type||d.fixed)&&(d.hasMod("more")&&!this._hasAlwaysCollapsed?d.$el.hide():(d.$el.show(),d._double&&d._double.$el.hide()))}else for(var e=0,b=0,c=this._collapsibleItems.length-1;c>=b;c--){var d=this._collapsibleItems[c],f=d.$el.prev().bem();"separator"!=d.type&&"spacer"!=d.type&&(d.hasMod("more")?d.$el.show():e>=a?(d.$el.hide(),d._double&&d._double.$el.show(),e-=d.width,!f||"spacer"!=f.type&&"separator"!=f.type||f.hasMod("always-visible")||(f.$el.hide(),f._double&&f._double.$el.show(),e-=f.width)):(d.$el.show(),d._double&&d._double.$el.hide(),!f||"spacer"!=f.type&&"separator"!=f.type||f.hasMod("hidden")||(f.$el.show(),f._double&&f._double.$el.hide())))}return this.setLast(),e},setLast:function(){for(var a,b,c,d,e=this._items.length;e--;){var f=this._items[e];"none"!==f.el.style.display&&(a||(a=f),b=f),f.hasMod("first")&&(d=f),f.hasMod("last")&&(c=f)}c&&c!=a&&(c.delMod("last-in-group"),c.delMod("last")),d&&d!=b&&(d.delMod("first-in-group"),d.delMod("first")),a&&a!=c&&(a.addMod("last-in-group"),this.last&&a.addMod("last")),b&&b!=d&&(b.addMod("first-in-group"),this.first&&b.addMod("first"))},updateItems:function(){this._flexible=[],this._collapsibleItems=[],this._adaptive=[],this._hasAlwaysCollapsed=!1,this._items=this.$el.children(),this._moreItem=this._items.filter("."+A.settings.cssPrefix+"-toolbar__button_more").bem();for(var a=100,b=[],c=0,d=this._items.length;d>c;c++){var e=this._items.eq(c).bem();if(e.el&&(e.el.style.zIndex="search"!==e.type?a--:101),b.push(e),e.hasMod("flexible")&&!e.hasMod("hidden")&&this._flexible.push(e),e.alwaysCollapsed&&(this._hasAlwaysCollapsed=e.hidden=!0,e.addMod("hidden")),e.adaptive&&!e.hasMod("hidden")&&this._adaptive.push(e),!e.hasMod("always-visible")&&(e.hasMod("hidden")||e.hasMod("spacer")||e.hasMod("separator")||this._collapsibleItems.push(e),!e._double)){var f=e.$el.attr("data-button-id");f&&(e._double=this._moreItem.$el.find("[data-button-id="+f+"]").bem(),e._double&&(e.on("mod:disabled",function(a,b){this._double.mod("disabled",b)}.bind(e)),e.on("mod:current",function(a,b){this._double.mod("current",b)}.bind(e)),e.on("mod:hidden",function(a,b){this._double.mod("hidden",b)}.bind(e))))}}this._items=b,this._collapsibleItems=B.qsort(this._collapsibleItems,"collapsePriority"),this.updateFullWidth(),this.setLast()},updateFullWidth:function(){for(var a=0,b=0,c=0,d=0,e=this._items.length;e>d;d++){var f=this._items[d];if(!(f.hasMod("more")&&!this._hasAlwaysCollapsed||f.hasMod("hidden"))){var g=f.width||f.el.clientWidth;f.hasMod("always-visible")||f.hasMod("more")||(b+=g),f.width=g,a+=g,f.adaptive&&(c+=f.adaptiveWidth)}}this._moreItem&&!this._hasAlwaysCollapsed?this._moreItem.width=this.moreItemWidth=this._moreItem.width||this._moreItem.el.clientWidth:this.moreItemWidth=0,this.collapsibleWidth=b,this.adaptiveWidth=c,this.fullWidth=a}}},{getConfig:function(c){var d,e={},f=[];Array.isArray(c)&&(c={items:c,type:"group"});for(var g=0,h=c.items.length;h>g;g++){var i=c.items[g];if(i){var j=i.type;j||(j=i.type="button"),c.submenu&&-1==["button","spacer","banner","separator"].indexOf(j)||(i.submenu=c.submenu,i&&i.buttonType&&"more"==i.buttonType?c.collapsible?d=i:i=void 0:i=a.constructors[A.settings.cssPrefix+"-toolbar__"+j].getConfig(i),i&&f.push(i))}}if(c.items=f,c.attrs=e,e["data-collapsible"]=!!c.collapsible,c.collapsible){for(var k=[],g=0,h=c.items.length;h>g;g++){var i=c.items[g];if(i){var j=i.type;"button"!=j||!i.text||i.hidden||i.alwaysVisible||"more"==i.buttonType||(i.attrs||(i.attrs={}),i.attrs["data-button-id"]="js-double-"+g,i=i._config,i.attrs||(i.attrs={}),i.attrs["data-button-id"]="js-double-"+g,i.type=void 0,k.push(b.extend({},i)))}}if(k.length){d?(d.dropdown||(d.dropdown={}),b.extend(d.dropdown,{items:k}),b.extend(d,{type:"button",buttonType:"more",submenu:c.submenu})):(d={type:"button",buttonType:"more",submenu:c.submenu,dropdown:{items:k}},"separator"==c.items[c.items.length-1].type||"spacer"==c.items[c.items.length-1].type?c.items.splice(c.items.length-1,0,d):c.items.push(d));for(var g=0,h=c.items.length;h>g;g++){var i=c.items[g];if("more"==i.buttonType){c.items[g]=a.constructors[A.settings.cssPrefix+"-toolbar__button"].getConfig(i);break}}}}return c}})}(B.BEM,B.BEM.$),function(a){a(A.settings.cssPrefix+"-toolbar__spacer",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this.type="spacer",this.addMod(this.el.style.width?"fixed":"flexible")}}},function(a){return{getConfig:function(b){return b=a.getConfig.call(this,b)}}})}(B.BEM,B.BEM.$),function(a){A.settings.noSuggests||a(A.settings.cssPrefix+"-toolbar__suggests-list","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)},onMod:{}}},{})}(B.BEM,B.BEM.$),function(a){A.settings.noSuggests||(a(A.settings.cssPrefix+"-toolbar__suggests","bemjs__control",function(b){return{constructor:function(){b.constructor.apply(this,arguments),this.items=this.list=this.selectedItem=null,this.addMod("nohover"),this.searchInternet=this._config.searchInternet,this.width=this._config.width,-1==["content"].indexOf(this.width)&&(this.width="auto"),this.addMod("width",this.width)},onMod:{},disable:function(){this.addMod("disabled")},enable:function(){this.delMod("disabled")},show:function(){!this.hasMod("disabled")&&this.list&&(this.addMod("open"),!this.input.$el.is(":focus")&&this.input.clientWidth&&this.input.focus())},hide:function(){this.selectItem(),this.delMod("open")},init:function(a){this.input=a.input,this.form=a.form,this.params=a.params,this.button=a.button;var b=this.input.$el.val();this.input.on("keydown",function(a){this.hasMod("disabled")||(38==a.which&&this.hasMod("open")||40==a.which)&&a.preventDefault()}.bind(this)),this.input.on("keyup",function(a){var c=this.input.$el.val();b=c,this.list&&(this.hasMod("disabled")||(40==a.which?this.hasMod("open")?this.selectItemByArrow(!0):this.show():38==a.which&&this.hasMod("open")?this.selectItemByArrow(!1):27==a.which&&this.hasMod("open")&&this.hide()))}.bind(this)),this.form.on("mod:focus",function(a,b){b||this.hide()}.bind(this)),this.params&&this.params.on("mod:focus",function(a,b){b&&this.hide()}.bind(this)),this.button.on("mod:focus",function(a,b){b&&this.hide()}.bind(this)),this.$el.on("click",function(){this.input.focus()}.bind(this)),this.input.on("keypress",function(a){this.hasMod("disabled")||this.hasMod("open")&&13==a.which&&null!==this.selectedItem&&(this.choose(),this.hide())}.bind(this))},choose:function(){null!==this.selectedItem&&(this.trigger("select",this.items[this.selectedItem]._config),this.selectItem())},selectItem:function(a){null!==this.selectedItem&&this.items[this.selectedItem].delMod("selected"),a?(this.selectedItem=this.items.indexOf(a),this.items[this.selectedItem].addMod("selected")):this.selectedItem=null},selectItemByArrow:function(a){var b;null===this.selectedItem?b=a?0:this.items.length-1:(b=a?this.selectedItem+1:this.selectedItem-1,0>b?b=this.items.length-1:b>this.items.length-1&&(b=0)),this.selectItem(this.items[b])},clear:function(){this.makeList()},makeList:function(b){if(this.$el.html(""),b){!b.searchText,b.searchInternet=this.searchInternet&&b.searchText,this.list=a.constructors[A.settings.cssPrefix+"-toolbar__suggests-list"].getEls(b),this.$el.append(this.list),this.items=this.$("__group__item");for(var c=[],d=0,e=this.items.length;e>d;d++){var f=this.items.eq(d).bem();f.on("mod:hover",function(a){return function(b,c){c?this.selectItem(a):this.selectItem()}}.call(this,f).bind(this)),f.on("click",function(){this.choose(),this.hide()}.bind(this)),c.push(f)}this.items=c,this.show()}else this.items=this.list=this.selectedItem=null,this.hide()},getAPI:function(){var a=b.getAPI.call(this);return B.APIProxy.extend(a,this,{show:this.show.bind(this),hide:this.hide.bind(this),list:this.makeList.bind(this)}),a}}},{mods:"open"}),a(A.settings.cssPrefix+"-toolbar__suggests__group__item","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)},onMod:{"*":function(a,b){-1!=["focus","hover"].indexOf(a)&&this.mod("selected",b)}}}},{mods:"hover press focus"}))}(B.BEM,B.BEM.$),function(a,b){a(A.settings.cssPrefix+"-toolbar__search",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._config._search=this,this.type="search",this.container=this.$("__container").bem(),this.form=this.$("__form").bem(),this.input=this.$("__input").bem(),this.button=this.$("__button").bem(),this.params=this.$("__params").bem(),this.label=this.$("__label").bem(),this.placeholder=this.$("__placeholder").bem(),this.suggests=this._config.suggests&&this.$el.find("."+A.settings.cssPrefix+"-toolbar__suggests").bem(),this.suggests&&this.suggests.init(this),(this._config.expandable||this.adaptive)&&(this.triggerButton=this.$el.children("."+A.settings.cssPrefix+"-toolbar__button").bem(),this.triggerButton._inner.on("mod:press",this.onFormPress.bind(this)),this.form.on("mod:focus",this.onFormFocus.bind(this))),this.placeholder&&this.placeholder.init(this.input,{placeholderOnSubmit:!!this._config.placeholderOnSubmit}),this._config.autofocus&&setTimeout(function(){this.input.focus()}.bind(this),10),this._config.width&&!this._config.flexible?this.$el.width(this._config.width):this._config.expandable||this.adaptive?(this.container.$el.css({width:this._config.baseWidth}),this.adaptive&&this.$el.css({width:this._config.baseWidth})):this._config.flexible&&(this.$el.css({width:this._config.baseWidth}),this.addMod("flexible")),this._config.clearButton&&(this.clearButton=this.$("__clear-button").bem()),this._config.expandable&&!this.adaptive&&this.expand("visible"===this._config.expandable),this.adaptive&&this.updateFullWidth(),this.resize(!0)},onMod:{"*":function(a,b){-1!==["last","last-in-group","first","first-in-group"].indexOf(a)&&(this.container?this.container.mod(a,b):(this._containerMod||(this._containerMod={}),this._containerMod[a]=b))},last:function(){this._setLast=!0,this.resize(!0),this._setLast=!1}},setParams:function(a){if(null===a.suggestUrl?this.suggests&&this.suggests.disable():this.suggests&&this.suggests.enable(),this.form.$el.attr({action:a.searchUrl||this._config.searchUrl}),this.input.$el.attr({name:a.inputName||this._config.inputName}),!a.inputs&&this._config.inputs&&(a.inputs=this._config.inputs||null),this.$("input[type=hidden]").remove(),a.inputs)for(var c in a.inputs)a.inputs.hasOwnProperty(c)&&b("<input>",{name:c,value:a.inputs[c],type:"hidden"}).prependTo(this.form.el)},onFormPress:function(a,b){(this._config.expandable||this.adaptive)&&(a.preventDefault(),b||(this.expand(!0),this.input.focus()))},onFormFocus:function(a,b){b||!this._config.expandable&&!this.adaptive||this.expand(!1)},expand:function(a){a?(this.triggerButton._inner.addMod("disabled"),this.container.delMod("expandable_hidden"),this.container.addMod("expandable_visible"),this.button.addMod("highlight"),this.resize(!0)):(this.triggerButton._inner.delMod("disabled"),this.container.delMod("expandable_visible"),this.container.addMod("expandable_hidden"),this.triggerButton.setIcon(this.input.el.value?"pm-uh-search-query":"pm-uh-search"))},collapse:function(a){return this.adaptive?(this.expand(!1),this.collapsed=a,a?(this.container.delMod("adaptive_not-collapsed"),this.delMod("adaptive_not-collapsed"),this.container.addMod("adaptive_collapsed"),this.addMod("adaptive_collapsed"),this.el.style.width=""):(this.container.delMod("adaptive_collapsed"),this.delMod("adaptive_collapsed"),this.container.addMod("adaptive_not-collapsed"),this.addMod("adaptive_not-collapsed"),this.el.style.width=this._config.baseWidth+"px",this.resize(!0)),a?0:this.adaptiveWidth):0},updateFullWidth:function(){this.adaptive&&(this.fullWidth=this.$el.width(),this.collapse(!0),this.collapsedWidth=this.$el.width(),this.adaptiveWidth=this.fullWidth-this.collapsedWidth)},resize:function(a){var b,c,d;if(!this._config.expandable||this.adaptive&&!this.collapsed){if(b=this.el.clientWidth,c=b-(this._setLast||this.hasMod("last")?10:20),0>c&&(c=0),a){if(this._animateNextReflow&&B.Modernizr.csstransitions){var e=c>this.container.el.clientWidth;this.container.addMod("animatable"),clearTimeout(this._animateTimeout),clearTimeout(this._endAnimateTimeout),e&&(this.el.style.overflow="hidden"),this._animateTimeout=setTimeout(function(){this.container.el.style.width=c+"px"}.bind(this),0),this._endAnimateTimeout=setTimeout(function(){this.el.style.overflow="",this.container.delMod("animatable")}.bind(this),220)}else this.container.el.style.width=c+"px";this._animateNextReflow=!1}d=c-this.button.width,this.params&&(d-=this.params.width)}else b=this._config.baseWidth,c=b,d=c-this.button.el.clientWidth,this.params&&(d-=this.params.el.clientWidth),this.container.el.style.width=c+"px";this.clearButton&&this.clearButton.isVisible()&&(d-=27,this.clearButton.el.style.left=d-3+"px"),0>d&&(d=0),this.label.el.style.width=d+"px"},setBaseWidth:function(a){a!=this._config.baseWidth&&(this.toolbar.enqueue(function(){this._config.baseWidth=a,this.width=void 0}.bind(this)),this.toolbar.updateGroups())},getAPI:function(){this.toolbar=this.toolbar||this.$el.closest("."+A.settings.cssPrefix+"-toolbar").bem();var b=a.getAPI.call(this);return this._config.manualFocus&&B.APIProxy.extend(b,this,{focus:function(a){this.manualFocus=!0,this.form.mod("focus",a),this.manualFocus=!1}}),B.APIProxy.extend(b,this,{form:this.form&&this.form.getAPI(),input:this.input&&this.input.getAPI(),button:this.button&&this.button.getAPI(),params:this.params&&this.params.getAPI()}),this.suggests&&B.APIProxy.extend(b,this,{suggests:this.suggests.getAPI()}),(this._config.expandable||this._config.flexible)&&B.APIProxy.extend(b,this,{setWidth:this.setBaseWidth.bind(this)}),this._config.flexible&&B.APIProxy.extend(b,this,{animateNextReflow:function(){this._animateNextReflow=!0}.bind(this)}),b}}},function(b){return{mods:"",getConfig:function(c){return c=b.getConfig.call(this,c),c.alwaysVisible=!0,c.name||(c.name="search"),c.method=c.method||"get",c.width||(c.width=300),c.adaptive&&(c.expandable=!0),c.expandable&&(c.flexible=!1,c.baseWidth=c.width,c.width=null,c.reinforced=!1,c.autofocus="visible"==c.expandable?!0:!1,c.expandButton=a.constructors[A.settings.cssPrefix+"-toolbar__button"].getConfig({iconCls:c.value?"pm-uh-search-query":"pm-uh-search"})),c.flexible&&(c.baseWidth=c.width,c.width=null,c.expandable=null),c.reinforced&&(c.autofocus="autofocus"in c?c.autofocus:!0,c.highlighted=!0),c.params&&(c.params=a.constructors[A.settings.cssPrefix+"-toolbar__search__params"].getConfig(c.params)),A.settings.noSuggests&&(c.suggests=void 0),c.suggests&&(c.autocomplete="off",c.suggests=a.constructors[A.settings.cssPrefix+"-toolbar__suggests"].getConfig(c.suggests)),c}}}),a(A.settings.cssPrefix+"-toolbar__search__container","bemjs__control",function(a){return{constructor:function(){if(this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments),this._config._container=this,this._config._search._containerMod)for(var b in this._config._search._containerMod)this._config._search._containerMod.hasOwnProperty(b)&&this.mod(b,this._config._search._containerMod[b])}}},{mods:"hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__form","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments),this._config._form=this,A.settings.noSuggests||this.on("submit",this.onSubmit.bind(this))},onSubmit:function(a){this._config._search.input.el.value||(a.preventDefault(),this._config._search.input.focus(),this._config.placeholderOnSubmit&&(this._config._search.placeholder.hideOnValue=!0,this._config._search.placeholder._togglePlaceholder(!0)))},onMod:{focus:function(a){if(this._config.manualFocus){if(!this._config._search.manualFocus)return!1}else if(!a&&this._config._search.input.hasMod("focus"))return!1}},getAPI:function(){var b=a.getAPI.call(this);return B.APIProxy.extend(b,this,{el:this.el}),b}}},{mods:"hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__label","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments)}}},{mods:"hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__placeholder","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments)},init:function(a,b){this.input=a,this.placeholderOnSubmit=b.placeholderOnSubmit,this.placeholderOnSubmit?(a.on("keydown",this._hideOnSubmit.bind(this)),a.on("keyup",this._hideOnSubmit.bind(this)),a.on("paste",this._hideOnSubmit.bind(this)),a.on("input",this._hideOnSubmit.bind(this))):(a.on("keydown",this._placeHolderKeys.bind(this)),a.on("keyup",this._placeHolderKeys.bind(this)),a.on("paste",this._togglePlaceholder.bind(this)),a.on("cut",this._togglePlaceholder.bind(this)),a.on("input",this._togglePlaceholder.bind(this)),this._togglePlaceholder(!this.input.el.value))},_hideOnSubmit:function(){this.input.el.value&&this.hideOnValue&&(this._togglePlaceholder(!1),this.hideOnValue=!1)},_placeHolderKeys:function(a){"keydown"===a.type?91==a.keyCode||92==a.keyCode?this.__commandKey=!0:[8,46].indexOf(a.keyCode)>-1&&1==this.input.el.value.length?this._togglePlaceholder(!0):48<=a.keyCode&&a.keyCode<=90&&!a.altKey&&!a.ctrlKey&&!this.__commandKey&&this._togglePlaceholder(!1):"keyup"===a.type&&(91==a.keyCode||92==a.keyCode?this.__commandKey=!1:this._togglePlaceholder())},_togglePlaceholder:function(a){this.el.style.display=a===!0||a===!1?a?"block":"none":this.input.el.value?"none":"block"},onMod:{press:function(a){a||this.input.focus()}}}},{mods:"hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__clear-button","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments),this.input=this._config._search.input,this.input.addMod("noclear"),this.toggle=this.toggle.bind(this),this.input.on("keydown",this.toggle),this.input.on("keyup",this.toggle),this.input.on("paste",this.toggle),this.input.on("cut",this.toggle),this.input.on("input",this.toggle),this.on("click",function(){this.input.value(""),this.input.focus()}.bind(this));var b=this._config._search._config.clearButton;if(b.events)for(var c in b.events)this.on(c,b.events[c]);this.toggle()},toggle:function(){this._visible=!!this.input.el.value,this[this.input.el.value?"addMod":"delMod"]("visible")},isVisible:function(){return this._visible},onMod:{visible:function(){this._config._search.resize()}}}},{mods:"hover"}),a(A.settings.cssPrefix+"-toolbar__search__input","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments),"autocomplete"in this._config&&this.$el.attr("autocomplete",this._config.autocomplete)
},focus:function(){if((!this._config.expandable&&!this.adaptive||this.el.clientHeight)&&(this.el.focus(),this.addMod("focus"),this.el.value))if(this.el.setSelectionRange)this.el.setSelectionRange(this.el.value.length,this.el.value.length);else if(this.el.createTextRange){var a=this.el.createTextRange();a.collapse(!0),a.moveEnd("character",this.el.value.length),a.moveStart("character",this.el.value.length),a.select()}},value:function(a){return void 0!==a&&(this.el.value=a,(!this._config.placeholderOnSubmit||a)&&this._config._search.placeholder&&this._config._search.placeholder._togglePlaceholder(),this._config._search.clearButton&&this._config._search.clearButton.toggle(),this.el.value||this.trigger("clear")),this.el.value},onMod:{},getAPI:function(){var b=a.getAPI.call(this);return B.APIProxy.extend(b,this,{el:this.el,value:this.value}),b}}},{mods:"hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__button","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments),this.input=this.$("__input").bem(),this._targetEl=this.input,this.highlighted=this._config.highlighted,this.highlighted&&this.addMod("highlighted"),this._config._search.form.on("mod:focus",this.onFormFocus.bind(this)),this.width=this.$el.outerWidth()},onFormFocus:function(a,b){this.toggleMod("highlight",b)},onMod:{highlight:function(a){return this.highlighted&&!a?!1:void 0},"*":function(){}},getAPI:function(){var b=a.getAPI.call(this);return B.APIProxy.extend(b,this,{el:this.el}),b}}},{mods:"hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__button__input","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments)},onMod:{}}},{mods:"hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__params","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments),this._config._params=this,this.text=this.$("__text").bem(),this.dropdown=this.$("__dropdown").bem(),this.dropdown&&this.dropdown._selected&&this.setParams(this.dropdown._selected),this.width=this.el.clientWidth},setParams:function(a){var b=a.getAPIConfig();return this._config._search.setParams(b),b},onSelect:function(a){var b=this.setParams(a);this.width=this.el.clientWidth,this._config._search.resize(),(this.dropdown&&this.dropdown.hasMod("open")||!this.dropdown)&&this._config._search.input.focus(),this.trigger("select",b)},resize:function(){this.dropdown&&this.dropdown.resize()},getAPI:function(){var b=a.getAPI.call(this),c=[];if(this.dropdown){for(var d=0,e=this.dropdown.items.length;e>d;d++){var f=this.dropdown.items[d];c.push(f.getAPI())}B.APIProxy.extend(b,this,{items:c})}return b},onMod:{focus:function(a){a||this.toggleMod("open",!1)},open:function(a){this.dropdown&&this.dropdown.toggleMod("open",a),a&&this.resize()}}}},function(a){return{mods:"open hover focus press",getConfig:function(b){return b=a.getConfig.call(this,b),b.list&&("searchAll"in b&&!b.searchAll||b.list.unshift({text:b.searchAll&&b.searchAll.text||"Искать везде"}),b.searchInternet&&b.list.push({searchUrl:"http://go.mail.ru/search",inputName:"q",suggestUrl:null,text:"В интернете",mods:"_searchinternet"})),b}}}),a(A.settings.cssPrefix+"-toolbar__search__params__text","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments)},onMod:{press:function(a){a||this._config._params.toggleMod("open")}}}},{mods:"open hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__params__dropdown","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments),this.params=this.$el.closest("."+A.settings.cssPrefix+"-toolbar__search__params").bem(),this.items=[];for(var b=this.$("__item"),c=0,d=b.length;d>c;c++){var e=b.eq(c).bem();this.items.push(e);var f=e.$el.data("selected");f&&this.onSelect(e),0==c?e.addMod("first"):c==d-1&&e.addMod("last")}!this._selected&&this.items.length&&this.onSelect(this.items[0])},onSelect:function(a){this._selected&&this._selected.delMod("selected"),a.addMod("selected"),this._selected=a,this.params.text.$el.html(a.$el.html());var b=this.params.text.$el.find("."+A.settings.cssPrefix+"-toolbar__search__params__dropdown__item__icon");b.length&&b.addClass(A.settings.cssPrefix+"-toolbar__search__params__dropdown__item__icon_in-text")},resize:function(){if(this.hasMod("open")){var a=this._config._search.button.$el.outerWidth();this.$el.css({marginRight:-a,minWidth:a+this._config._search.params.$el.outerWidth()})}},onMod:{open:function(a){this.$el[a?"show":"hide"]()}}}},{mods:"open hover focus press"}),a(A.settings.cssPrefix+"-toolbar__search__params__dropdown__item","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-toolbar__search",a.constructor.apply(this,arguments);var b=this.$("__input");if(b.length){this.inputs={};for(var c=0,d=b.length;d>c;c++){var e=b.eq(c);this.inputs[e.data("name")]=e.data("value")}}else this.inputs=void 0},getAPI:function(){var b=a.getAPI.call(this);return B.APIProxy.extend(b,this,{isSelected:function(){return this.hasMod("selected")},getData:this.getAPIConfig,select:this.select}),b},getAPIConfig:function(){var a={searchUrl:this.$el.data("search-url"),inputName:this.$el.data("input-name"),suggestUrl:this.$el.data("suggest-url"),inputs:this.hasMod("searchinternet")?{}:this.inputs};return a},select:function(){this.hasMod("selected")||(this._config._search.params.manualSelect=!0,this._config._search.params.dropdown.onSelect(this),this._config._search.params.onSelect(this),this._config._search.params.manualSelect=!1)},onMod:{press:function(a){a||this.select()}}}},{mods:"hover focus press selected"})}(B.BEM,B.BEM.$),function(a,b){a(A.settings.cssPrefix+"-toolbar__banner",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this.init()},init:function(){for(var a=this.$("."+A.settings.cssPrefix+"-toolbar__button"),b=0,c=a.length;c>b;b++)a.eq(b).bem();var d=this.$("__content");d.eq(0).css("margin-left",0);var e=this.$("__content__image");if(e.length)for(var f=this.el.clientHeight,b=0,c=e.length;c>b;b++){var g=e[b];g.style.marginTop=(f-g.height)/2+"px"}},onMod:{last:function(){this.width=void 0}},getAPI:function(){var b=a.getAPI.call(this);return this.toolbar=this.toolbar||this.$el.closest("."+A.settings.cssPrefix+"-toolbar").bem(),B.APIProxy.extend(b,this,{reload:function(a){this._config=this.constructor.getConfig(this._config,a);var b=B.tmpl({block:"toolbar__banner",params:this._config});this.toolbar.enqueue(function(){this.$el.html(b),this._config.slot.length?(this.addMod("always-visible"),this.delMod("hidden"),this.init()):(this.delMod("always-visible"),this.addMod("hidden")),this.width=void 0}.bind(this)),this.toolbar.updateGroups()},el:this.el}),b}}},function(c){return{_slotConfigRegexp:/<a data-id=.+?<\/a>/i,getConfig:function(d,e){if(d=c.getConfig.call(this,d),d._slot&&(d.slot=d._slot,d.reload=!0),void 0!==e&&(d.slot=e),d.slot||(d.slot=[]),d.slot){Array.isArray(d.slot)||(d.slot=[d.slot]);for(var f=[],g=0,h=d.slot.length;h>g;g++){var i,j=d.slot[g],k=j.match(this._slotConfigRegexp),l=k&&k[0];if(l){l=b(l);var m=l.data("type");if(i=3==m?{type:1,title:l.data("title"),id:l.data("id"),text:"Сбербанк",href:"http://r.mail.ru/n60427948",submenu:d.submenu,banner:!0,color:"sber",colorVariant:"sber"}:4==m?{title:l.data("title"),id:l.data("id"),type:m,href:l.attr("href"),submenu:d.submenu,banner:!0,img:l.data("img-src"),imgWidth:l.data("width"),imgHeight:l.data("height")}:{title:l.data("title"),id:l.data("id"),type:m,text:l.html(),href:l.attr("href"),submenu:d.submenu,banner:!0,color:l.data("color"),colorVariant:l.data("color-variant")},2==m){var n=l.data(B.Modernizr.retina?"icon-retina":"icon")||l.data("icon");n&&(i.iconCls=A.settings.cssPrefix+"-toolbar__banner__icon",i.iconBg=n),i.target="_blank",i.mods={__text__inner:"_"+i.color+" _"+i.color+i.colorVariant},i=a.constructors[A.settings.cssPrefix+"-toolbar__button"].getConfig(i)}((1==m||3==m||4==m)&&!d.submenu||2==m&&d.submenu)&&f.push(j.replace(this._slotConfigRegexp,B.tmpl({block:2==m?"toolbar__button":"toolbar__banner__banner",params:i})))}}d._slot=d.slot,d.slot=f}return d.slot.length?(d.alwaysVisible=!0,d.hidden=!1):(d.alwaysVisible=!1,d.hidden=!0),d}}})}(B.BEM,B.BEM.$),function(a,b){a(A.settings.cssPrefix+"-toolbar",A.settings.cssPrefix+"-toolbar__item",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._parent=this.el.parentNode,this._parent.style.overflow="hidden",this.onResize=this.onResize.bind(this),this._queue=new B.Queue,this._updateGroups(!0),b(window).on("resize",this.onResize),setTimeout(function(){this.onResize()}.bind(this),1e3),setTimeout(function(){this.onResize()}.bind(this),5e3)},enqueue:function(a){"function"==typeof a&&this._queue.enqueue(a)},dequeue:function(){for(;!this._queue.isEmpty();)this._queue.dequeue()()},resize:function(a){this.onResize.call(this,a,!1)},onResize:function(a,b){function c(){this.prevParentWidth=this.parentWidth,this.parentWidth=this._parent.clientWidth,(b===!1||this.prevParentWidth!==this.parentWidth)&&this.expand()}this.destroyed||(clearTimeout(this._expandTimeout),a?c.call(this):this._expandTimeout=setTimeout(function(){c.call(this)}.bind(this),0))},updateGroups:function(a){this.destroyed||(clearTimeout(this._updateGroupsTimeout),clearTimeout(this._expandTimeout),a?this._updateGroups():this._updateGroupsTimeout=setTimeout(function(){this._updateGroups()}.bind(this),0))},_updateGroups:function(){z.time("toolbar update groups"),clearTimeout(this._updateGroupsTimeout),this._updateGroupsTimeout=null,this.dequeue(),this.expandAdaptive(),this.expandFlexible(!1),this._unexpanded=!0,this._items=this.$el.children(".js-group"),this._collapsibleGroups=[],this._groupsWithFlexible=[],this._flexible=[],this._flexibleFull=0,this._adaptive=[],this._hasAlwaysCollapsed=!1;for(var a=[],b=0,c=this._items.length;c>b;b++){var d=this._items.eq(b).bem();d.updateItems(),d.collapsible&&this._collapsibleGroups.push(d),d._hasAlwaysCollapsed&&(this._hasAlwaysCollapsed=!0),d._flexible.length&&this._groupsWithFlexible.push(d),this._adaptive=this._adaptive.concat(d._adaptive),a.push(d)}for(var b=0,c=this._groupsWithFlexible.length;c>b;b++)for(var d=this._groupsWithFlexible[b],e=0,f=d._flexible.length;f>e;e++){var g=d._flexible[e];this._flexible.push(g),this._flexibleFull+=g._config.flex||1}this._items=a,a=d=null,this.updateFullWidth(),this._collapsibleGroups.length&&this._collapsibleGroups.sort(function(a,b){return a.fullWidth<b.fullWidth?1:-1}),this._groupsWithFlexible=null,z.timeEnd("toolbar update groups"),this.expand()},updateFullWidth:function(){z.time("toolbar update full width");for(var a=0,b=0,c=0,d=0,e=0,f=this._items.length;f>e;e++){var g=this._items[e];g.collapsible&&(b+=g.moreItemWidth,c+=g.collapsibleWidth),a+=g.fullWidth,d+=g.adaptiveWidth}this.moreButtonsWidth=b,this.fullWidth=a,this.collapsibleFullWidth=c,this.adaptiveWidth=d,z.timeEnd("toolbar update full width")},expand:function(){z.time("toolbar reflow"),clearTimeout(this._expandTimeout),this._expandTimeout=null,this._parent.style.overflow="hidden",this._unexpanded||(this.expandAdaptive(),this.expandFlexible(!1)),this._unexpanded=!1,this.parentWidth||(this.parentWidth=this._parent.clientWidth);var a=this.parentWidth>=this.fullWidth,b=this.parentWidth-this.fullWidth,c=0;(!this._hasAlwaysCollapsed&&!a||this._hasAlwaysCollapsed)&&(b-=this.moreButtonsWidth);for(var d=0,e=this._collapsibleGroups.length;e>d;d++){var f=this._collapsibleGroups[d];if(a)f.expand(0);else{var g=Math.round(b*f.collapsibleWidth/this.collapsibleFullWidth),h=f.expand(g+c);c=g-h}}var i=this.el.clientWidth,j=this.expandAdaptive(this.parentWidth-i);this.expandFlexible(this.parentWidth-i-j),this._parent.style.overflow="",this._parent.style.visibility="visible",z.timeEnd("toolbar reflow")},expandAdaptive:function(a){if(!this._adaptive||!this._adaptive.length)return 0;var b=0;(void 0!==a&&0>a||void 0===a)&&(a=0);for(var c=0,d=this._adaptive.length;d>c;c++){var e=this._adaptive[c];b+=e.collapse(0===a||a<this.adaptiveWidth)}return b},expandFlexible:function(a){if(this._flexible&&this._flexible.length){var b=a!==!1;(a===!1||0>a)&&(a=0);for(var c=0,d=0,e=0,f=this._flexible.length;f>e;e++){var g=this._flexible[e];if(Math.round(a)){var h=(g._config.flex||1)*a/this._flexibleFull+c,i=Math.round(h),j=(g._config.baseWidth||0)+i;c+=h-i,d+=g._config.flex||1,g.el.style.width=j+"px",g.el.style.display="",g.resize&&g.resize(b)}else g.el.style.width=(g._config.baseWidth||0)+"px",g._config.baseWidth?g.resize&&g.resize(b):g.el.style.display="none"}}},getAPI:function(){var b=a.getAPI.call(this);return B.APIProxy.extend(b,this,{resize:this.onResize}),b},onMod:{}}},function(){return{getConfig:function(b){var c=[],d={items:[]};b.items||(b.items=[]);for(var e=0,f=b.items.length;f>e;e++){var g=b.items[e];if(g){var h=g.type;h||(h=g.type="button"),"group"==h?(0!=e&&d.items.length&&c.push(d),c.push(g),d={items:[]}):d.items.push(g)}}d.items.length&&c.push(d);for(var e=0,f=c.length;f>e;e++)d=c[e],d.submenu=b.submenu,d=a.constructors[A.settings.cssPrefix+"-toolbar__group"].getConfig(c[e]);return b.items=c,b}}})}(B.BEM,B.BEM.$),function(a){a(A.settings.cssPrefix+"-logo","bemjs__control",function(a){return{constructor:function(){this.blockname=A.settings.cssPrefix+"-logo",a.constructor.apply(this,arguments),this.link=this.$("__link"),this.img=this.$("__link__pic"),this.img.css({marginTop:(52-this._config.height)/2+"px"})},onMod:{}}},{getConfig:function(a){return a||(a={}),a.retina=B.Modernizr.retina,a.image||(a.width=111,a.height=36),a.height||(a.height=36),a.marginLeft=a.marginLeft||0,a.marginRight=a.marginRight||0,a.image_x2=a.image_x2||a.image||A.settings.staticDir+"blocks/ph-logo/img/logotype-mail.ru@2x.png",a.image=a.image||A.settings.staticDir+"blocks/ph-logo/img/logotype-mail.ru.png",a.title=a.title||"",a.href=a.href||"//mail.ru",a.src=a.retina?a.image_x2:a.image,a}})}(B.BEM,B.BEM.$),function(a){a(A.settings.cssPrefix+"-input","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._placeholder=this.$el.find(".js-placeholder").bem(),this._input=this.$el.find(".js-input").bem(),this._label=this.$el.find(".js-label").bem(),this._wrapper=this.$el.find(".js-wrapper").bem()},role:"button",onMod:{disabled:function(a){this._input&&(this._input.disabled=a)},focus:function(){},"*":function(a,b){this._placeholder&&this._placeholder.toggleMod(a,b),this._input&&this._input.toggleMod(a,b),this._label&&this._label.toggleMod(a,b),this._wrapper&&this._wrapper.toggleMod(a,b)}}}},{mods:"press focus hover disabled"}),a(A.settings.cssPrefix+"-w-input","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}}),a(A.settings.cssPrefix+"-input__placeholder","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}}),a(A.settings.cssPrefix+"-input__text","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}}),a(A.settings.cssPrefix+"-input__label","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}})}(B.BEM,B.BEM.$),function(a){a(A.settings.cssPrefix+"-button","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._input=this.$el.find("input")[0],this._fake=this.$el.find(".js-fake").bem(),this._text=this.$el.find(".js-text").bem(),this._icon=this.$el.find(".js-icon").bem()},role:"button",onMod:{disabled:function(a){this._input&&(this._input.disabled=a)},focus:function(){},"*":function(a,b){this._fake&&this._fake.toggleMod(a,b),this._text&&this._text.toggleMod(a,b),this._icon&&this._icon.toggleMod(a,b)}}}},{mods:"press focus hover"}),a(A.settings.cssPrefix+"-button__fake","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}}),a(A.settings.cssPrefix+"-button__fake__text","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}}),a(A.settings.cssPrefix+"-button__fake__icon","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)}}})}(B.BEM,B.BEM.$),function(a,b,c){a(A.settings.cssPrefix+"-popup","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._wrapper=this.$el.closest("."+A.settings.cssPrefix+"-w-popup").bem(),this._closeButton=this.$el.find(".js-close"),this.hasMod("overlay-enabled")&&(this._overlay=B.$(B.tmpl({block:"overlay",params:{mods:["_black"]}})),this._overlay.insertBefore(B.rootNode),this._overlay=this._overlay.bem()),this._closeButton&&this._closeButton.on("click",this.hide.bind(this)),this._controls=this.$el.find(".js-controls"),this._controls.length&&this._controls.on("click",this._controlsHandler.bind(this)),this.setPosition=this.setPosition.bind(this),this._setPosition=this._setPosition.bind(this),this._wrapper&&this._wrapper.on("click",function(){})},setPosition:function(a){clearTimeout(this._pTime),a===!0?this._setPosition():this._pTime=setTimeout(this._setPosition,100)},_setPosition:function(){var a=window.pageYOffset!==c?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,d=b(window).outerHeight(),e=b(document).outerHeight();a+d>e?a=e-d:0>a&&(a=0),this._wrapper.$el.css({height:d,top:a})},isVisible:function(){return this.hasMod("visible")},show:function(){this.addMod("visible")},hide:function(){this.delMod("visible")},role:"popup",onMod:{visible:function(a){a?(this.trigger("beforeShow"),this._overlay&&this._overlay.show(),this.hasMod("hideByClick-enabled")&&(clearTimeout(this._t),this._t=setTimeout(function(){this.onOutside("click",this.onOutsideClick)}.bind(this),50)),this._wrapper&&this._wrapper.addMod("visible"),this.hasMod("hideByEsc-enabled")&&B.$(document).on("keyup",this._hideByEsc||(this._hideByEsc=B.bind(this.hideByEsc,this))),b(window).on("resize",this.setPosition),b(window).on("scroll",this.setPosition),this.setPosition(!0),this._wrapper.addMod("anim"),this.trigger("show")):(this.trigger("beforeHide"),this._overlay&&this._overlay.hide(),this.hasMod("hideByClick-enabled")&&(clearTimeout(this._t),this.offOutside("click")),this._wrapper&&this._wrapper.delMod("visible"),this.hasMod("hideByEsc-enabled")&&this._hideByEsc&&B.$(document).off("keyup",this._hideByEsc),b(window).off("resize",this.setPosition),b(window).off("scroll",this.setPosition),this._wrapper.delMod("anim"),this._wrapper.$el.css({top:0}),this.trigger("hide"))}},hideByEsc:function(a){27==a.keyCode&&this.hide()},onOutsideClick:function(a){0===b(a.target).closest(this.el).length&&this.mod("visible",!1)},_controlsHandler:function(a){var c,d=b(a.target),e=d.closest(".js-control");!e.length&&d.hasClass("js-control")&&(e=d),e&&(c=e.attr("data-action")),c&&(this.trigger("action"+c.substr(0,1).toUpperCase()+c.substr(1)),a.preventDefault())}}},{mods:"visible"}),a(A.settings.cssPrefix+"-w-popup","bemjs__control",function(a){return{constructor:function(){a.constructor.apply(this,arguments)},onMod:{visible:function(){}}}},{mods:"visible"})}(B.BEM,B.BEM.$),void function(){function a(a){if(!a||!B.isNode(a.node))throw new Error("Invalid arguments");this.__settings=B.extend({},b,a),this.__baseClass=A.settings.cssPrefix+"-popup",this.__wBaseClass="w-"+this.__baseClass,this.__node=this.__settings.node,this.__wNode=B.hasParent(this.__node,this.__wBaseClass),this.__visible=!1,this.__settings.overlay&&(this.__overlay=new B.PortalOverlay,this.__overlay.on("hide",B.bind(this.hide,this))),this.__wNode&&B.$(this.__wNode).on("click",B.bind(this.__wHide,this)),this.__closeButton=B.$(".js-close",this.__node),this.__closeButton&&B.$(this.__closeButton).on("click",B.bind(this.__closeButtonHide,this)),this.__controls=B.$(".js-controls",this.__node)[0],this.__controls&&B.$(this.__controls).on("click",B.bind(this.__controlsHandler,this))}var b={overlay:!0,node:null};a.prototype=new B.EventEmitter,B.extend(a.prototype,{__init:function(){this.__inited||(this.__inited=!0)},isVisible:function(){return this.__visible},show:function(){this.__visible||(this.__visible=!0,this.__init(),this.__overlay&&this.__overlay.show(),this.emit("beforeShow"),this.__wNode&&B.addClass(this.__wNode,this.__wBaseClass+"_visible"),B.addClass(this.__node,this.__baseClass+"_visible"),window.scrollTo(0,0),this.emit("show"))},hide:function(){this.__visible&&(this.__visible=!1,this.__overlay&&this.__overlay.hide(),this.emit("beforeHide"),this.__wNode&&B.removeClass(this.__wNode,this.__wBaseClass+"_visible"),B.removeClass(this.__node,this.__baseClass+"_visible"),this.emit("hide"))},__wHide:function(a){var b=a.target;B.hasParent(b,this.__node)||this.hide()},__closeButtonHide:function(a){a.preventDefault(),this.hide()},__controlsHandler:function(a){var b,c=a.target,d=B.hasParent(c,"js-control");!d&&B.hasClass(c,"js-control")&&(d=c),d&&(b=d.getAttribute("data-action")),b&&(this.emit("action"+b.substr(0,1).toUpperCase()+b.substr(1)),a.preventDefault())}}),B.PortalPopup=a}(),void function(){function a(c){return this instanceof a?(this.__settings=B.extend({},b,c),this.__baseClass="portal-overlay",void(this.__visible=!1)):new a(c)}var b={hideByClick:!0};a.prototype=new B.EventEmitter,B.extend(a.prototype,{show:function(){this.__visible||(this.__visible=!0,this.__init(),this.emit("beforeShow"),B.$(document).on("keyup",this.____hideByEsc||(this.____hideByEsc=B.bind(this.__hideByEsc,this))),B.addClass(this.__node,this.__baseClass+"_visible"),this.emit("show"))},hide:function(){this.__visible&&(this.__visible=!1,this.__init(),this.emit("beforeHide"),this.____hideByEsc&&B.$(document).off("keyup",this.____hideByEsc),B.removeClass(this.__node,this.__baseClass+"_visible"),this.emit("hide"))},__hideByEsc:function(a){27==a.keyCode&&this.hide()},__init:function(){this.__node||(this.__node=document.createElement("div"),this.__node.className=this.__baseClass,this.__settings.hideByClick&&B.$(this.__node).on("click",B.bind(this.hide,this)),document.body.appendChild(this.__node))}}),B.PortalOverlay=a}(),void function(){function a(d){if(!(this instanceof a))return new a(d);if(b)return b;if(b=this,this.__settings=B.extend({},c,d),this.__node=B.byId("portal-region"),this.__form=B.$(".js-region-form",this.__node)[0],this.__autoCheckbox=B.byId("regionAutoDetectInput"),this.__autoCheckboxCity=B.$(".js-auto-city",this.__node)[0],this.__manualCheckbox=B.byId("regionManualInput"),this.__regionSearchInput=B.$("#regionSearchInput").closest(".js-input-el").bem(),this.__regionSearchPlaceholderBaseClass="js-placeholder",this.__regionSearchPlaceholder=B.$("."+this.__regionSearchPlaceholderBaseClass,this.__node)[0],this.__regionSuggestsBaseClass="portal-region__suggests",this.__regionSuggests=B.$("."+this.__regionSuggestsBaseClass,this.__node)[0],this.__regionSuggestsGroups={current:B.$(".js-current-regions",this.__regionSuggests)[0],russia:B.$(".js-russia-regions",this.__regionSuggests)[0],other:B.$(".js-other-regions",this.__regionSuggests)[0]},this.__regionSuggestsGroupLists={current:B.$(".js-region-items",this.__regionSuggestsGroups.current)[0],russia:B.$(".js-region-items",this.__regionSuggestsGroups.russia)[0],other:B.$(".js-region-items",this.__regionSuggestsGroups.other)[0]},this.__regionSuggestsGroupBaseClass="portal-region__suggests__group",this.__regionSuggestsGroupItemBaseClass="portal-region__suggests__group__item",this.__autoCheckboxCity.innerHTML=this.__settings.cityName||"",B.$(this.__autoCheckbox).on("click",B.bind(this.__switchToAuto,this)),B.$(this.__manualCheckbox).on("click",B.bind(function(){this.__switchToManual(),this.__regionSearchInput._input.el.focus()},this)),this.__regionSearchInput._input.on("click",B.bind(this.__searchInputKeys,this)),this.__regionSearchInput.on("mod:press",function(a,b){!b&&this.__regionSearchInput.hasMod("disabled")&&this.__manualCheckbox.click()}.bind(this)),this.__regionSearchInput._input.on("keydown",B.bind(this.__searchInputKeys,this)),this.__regionSearchInput._input.on("keyup",B.bind(this.__searchInputKeys,this)),this.__regionSearchInput._input.on("paste",B.bind(this.__searchInputKeys,this)),this.__regionSearchInput._input.on("cut",B.bind(this.__searchInputKeys,this)),this.__regionSearchInput._input.on("input",B.bind(function(){this.__validate()},this)),this.__regionSearchInput._input.on("paste",B.bind(function(){this.__validate()},this)),this.__regionSearchInput._input.on("cut",B.bind(function(){this.__validate()},this)),B.$(this.__regionSuggests).on("click",B.bind(this.__searchInputKeys,this)),B.$(this.__regionSuggests).on("keydown",B.bind(this.__searchInputKeys,this)),B.$(this.__regionSuggests).on("scroll",B.bind(this.__onScroll,this)),this.__placeholderEmulation=!("placeholder"in document.createElement("input")),this.__placeholderEmulation){var e=this.__regionSearchInput._input.el.getAttribute("placeholder");e&&(this.__regionSearchPlaceholder.innerHTML=e),this.__regionSearchInput._input.on("keydown",B.bind(this.__placeHolderKeys,this)),this.__regionSearchInput._input.on("keyup",B.bind(this.__placeHolderKeys,this)),this.__regionSearchInput._input.on("paste",B.bind(this.__togglePlaceholder,this)),this.__regionSearchInput._input.on("cut",B.bind(this.__togglePlaceholder,this)),this.__regionSearchInput._input.on("input",B.bind(this.__togglePlaceholder,this))}else this.__regionSearchPlaceholder.style.display="none";B.$(".js-message-all",this.__regionSuggests).on("click",B.bind(function(){this.__reset(),this.__regionSearchInput._input.el.focus()},this)),B.$(".js-message-reload",this.__regionSuggests).on("click",B.bind(this.__reload,this)),this.__popup=B.$("."+A.settings.cssPrefix+"-popup").bem(),this.__popup.on("actionCancel",B.bind(function(){this.__actionCancel=!0,this.__popup.hide()},this)),this.__popup.on("hide",B.bind(function(){!this.__actionCancel,this.__actionCancel=!1},this)),this.__popup.on("actionSave",B.bind(function(){this.__save()},this)),B.$(this.__form).on("submit",B.bind(function(a){a&&a.preventDefault(),this.__save()},this)),this.on("beforeShow",this.__init),this.on("show",function(){this.__regionSuggestsOffsetHeight=this.__regionSuggests.offsetHeight,this.__regionSuggestsScrollHeight=this.__regionSuggests.scrollHeight}),this.__q="",this.__autocompletedValue="",this.__cacheQ={},this.__cacheNoQ=void 0,this.__regionsCache={}}var b,c={startRegion:null,auto:!0,notification:!1,cityName:"",pageSize:50,inputTimeout:400,lastItemsToLoad:15,preloaderPause:200,region:null,effRegion:null};a.prototype=new B.EventEmitter,B.extend(a.prototype,{__init:function(){this.__settings.auto?(this.__autoCheckbox.checked=!0,this.__manualCheckbox.checked=!1,this.__switchToAuto(),this.once("show",B.bind(function(){this.__manualCheckbox.focus()},this))):(this.__autoCheckbox.checked=!1,this.__manualCheckbox.checked=!0,this.__switchToManual(),this.once("show",B.bind(function(){this.__regionSearchInput._input.el.focus()},this))),this.__page=0,this.once("show",B.bind(function(){this.__regionSuggests.scrollTop=0},this)),this.__selectCity(),this.__loadRegions(0)},__reload:function(){this.__loadRegions(this.__page)},__reset:function(){this.__regionSuggests.scrollTop=0,this.__setQ(""),this.__loadRegions(0)},__getEvent:function(a){var b={};return b.effRegion=__PortalRegions.effRegion,b.ipRegion=__PortalRegions.ipRegion,b.newRegionAuto=!!this.__autoCheckbox.checked,b.oldRegionAuto=!!this.__settings.auto,b.newRegionAuto?(b.newRegionId=null,b.newRegionName=null,b.newTimezone=null):(b.newRegionId=a.id,b.newRegionName=a.cityName,b.newTimezone=a.timezone),b.oldRegionAuto?(b.oldRegionId=null,b.oldRegionName=null):(b.oldRegionId=b.effRegion.id,b.oldRegionName=b.effRegion.name),b},__save:function(){function a(){b!==B.SCookie.getGlobal("geo")&&setTimeout(function(){var a=window.location.toString();a=a.replace("#region",""),setTimeout(function(){try{window.location.replace(a)}catch(b){}setTimeout(function(){try{window.location.replace(a)}catch(b){}setTimeout(function(){try{window.location.reload()}catch(a){}},10)},10)},10)},50)}{var b=B.SCookie.getGlobal("geo");B.SCookie.getGlobal("georb")}if((new Image).src="//rs.mail.ru/f?new="+(this.__selectedCity?this.__selectedCity.getAttribute("data-id"):"auto")+"&old="+this.__settings.effRegion.id+"&ipR="+this.__settings.region.id+"&ipLevel2="+this.__settings.region.level2+"&effLevel2="+this.__settings.effRegion.level2+"&ipLevel1="+this.__settings.region.level1+"&effLevel1="+this.__settings.effRegion.level1+"&geod="+B.SCookie.getGlobal("geod")+"&georb="+B.SCookie.getGlobal("georb")+"&geol1="+B.SCookie.getGlobal("geol1")+"&geo="+B.SCookie.getGlobal("geo"),this.__autoCheckbox.checked)B.SCookie.removeGlobal("geo"),B.SCookie.removeGlobal("georb"),B.SCookie.removeGlobal("geol1"),B.SCookie.removeGlobal("geod");else{if(!this.__selectedCity)return void this.__setError(!0);this.__selectedCity.parentNode===this.__regionSuggestsGroupLists.current,B.SCookie.setGlobal("geo",this.__selectedCity.getAttribute("data-id")),B.SCookie[this.__settings.region.level2?"setGlobal":"removeGlobal"]("georb",this.__settings.region.level2),B.SCookie[this.__settings.region.level1?"setGlobal":"removeGlobal"]("geol1",this.__settings.region.level1),B.SCookie.removeGlobal("geod")}var c=this.__getEvent(this.__selectedCity&&this.__selectedCity.regionData);this.__popup.hide(),A.regionSelector.listeners("change")?A.regionSelector.emit("change",c,a.bind(this)):a.call(this)},__cache:function(a,b,c){var d,e,f=c&&c.regionsCount&&Math.ceil(c.regionsCount/this.__settings.pageSize);return a=this.__getNormalizedQ(a),a?(d=this.__cacheQ[a],!d&&f?d=this.__cacheQ[a]=new Array(f):d||f||!c||(d=this.__cacheQ[a]=!1)):(d=this.__cacheNoQ,!d&&f&&(d=this.__cacheNoQ=new Array(f))),d?f&&b>f-1?null:(e=d[b],c&&(e||(d[b]=e={current:[],russia:[],other:[]}),e.current=c.current,e.russia=c.russia,e.other=c.other,d.regionsCount=c.regionsCount,B.append(this.__regionsCache,c.regions)),e):d},__inCache:function(a,b){var c=this.__cache(a,b);return c},__pages:function(a){a=this.__getNormalizedQ(a);var b=""==a?this.__cacheNoQ:this.__cacheQ[a];return b?b.length:void 0},__scrollToCity:function(a,b){var c=this.__items.index(a),d=a.offsetTop,e=a.offsetHeight,f=this.__regionSuggests.scrollTop,g=this.__regionSuggestsOffsetHeight;if(0===c)return void(this.__regionSuggests.scrollTop=0);if(c===this.__items.length-1)return void(this.__regionSuggests.scrollTop=this.__regionSuggestsScrollHeight-g);var h=(b?e:0)+d-f;h>g?this.__regionSuggests.scrollTop=d+e-g:0>=h&&(this.__regionSuggests.scrollTop=d)},__onScroll:function(){if(this.__items.length){var a=this.__items[0].offsetHeight,b=this.__regionSuggests.scrollTop,c=this.__regionSuggestsScrollHeight,d=this.__regionSuggestsOffsetHeight;b+d>c-a*this.__settings.lastItemsToLoad&&this.__loadRegions(this.__page+1)}},__selectCity:function(a,b){a||(this.__selectedCity=null,B.removeClass(this.__selectedCity,"portal-region__suggests__group__item_selected")),this.__selectedCity&&B.removeClass(this.__selectedCity,"portal-region__suggests__group__item_selected"),a&&(this.__selectedCity=a,b||this.__setQ(this.__getQ(),this.__regionsCache[a.getAttribute("data-id")].cityName),B.addClass(this.__selectedCity,"portal-region__suggests__group__item_selected"))},__searchInputKeys:function(a){if("click"!==a.type||a.target!==this.__regionSuggests&&!B.hasParent(a.target,this.__regionSuggests)){if("keydown"===a.type)switch(a.keyCode){case 13:if(this.__autoCheckbox.checked)return void a.preventDefault();a.target===this.__regionSuggests&&(this.__save(),this.__hasError()&&setTimeout(B.bind(function(){this.__regionSearchInput._input.el.focus()},this),10));break;case 40:case 38:if(this.__autoCheckbox.checked||!this.__items.length)return void a.preventDefault();var b;if(40==a.keyCode)if(this.__selectedCity){if(b=this.__items.index(this.__selectedCity)+1,b>=this.__items.length){if(this.__loading)return;
    b=0}b=this.__items[b]}else b=this.__items[0];else this.__selectedCity?(b=this.__items.index(this.__selectedCity)-1,0>b&&(b=this.__items.length-1),b=this.__items[b]):b=this.__items[this.__items.length-1];this.__selectCity(b),this.__scrollToCity(this.__selectedCity,40==a.keyCode),a.preventDefault()}else if("keyup"===a.type||("paste"===a.type||"cut"===a.type)&&a.target===this.__regionSearchInput._input.el||"click"===a.type&&(a.target===this.__regionSearchInput._input.el||B.hasParent(a.target,this.__regionSearchInput._input.el))){if(clearTimeout(this.__qEntertimeout),"cut"===a.type||"paste"===a.type)return void(this.__qEntertimeout=setTimeout(B.bind(function(){this.__searchInputKeys({type:"keyup"})},this),0));if(13===a.keyCode)return;if(!this.__validate(this.__regionSearchInput._input.el.value))return;var c=this.__getSelection(),d=c?this.__regionSearchInput._input.el.value.substr(0,this.__regionSearchInput._input.el.value.toLowerCase().indexOf(c)):this.__regionSearchInput._input.el.value;if(d=d.toLowerCase(),d===this.__getNormalizedQ()||c===this.__regionSearchInput._input.el.value.toLowerCase()&&""!==this.__regionSearchInput._input.el.value)return;this.__qEntertimeout=setTimeout(B.bind(function(){this.__q=this.__regionSearchInput._input.el.value,this.__autocompletedValue="",this.__getNormalizedQ()!==this.__getQLoaded()&&this.__loadRegions(0)},this),this.__settings.inputTimeout)}}else{if(this.__autoCheckbox.checked)return void a.preventDefault();var e=B.hasParent(a.target,"portal-region__suggests__group__item")||B.hasClass(a.target,"portal-region__suggests__group__item")&&a.target;e&&this.__selectCity(e)}},__placeHolderKeys:function(a){this.__placeholderEmulation&&("keydown"===a.type?91==a.keyCode||92==a.keyCode?this.__commandKey=!0:[8,46].indexOf(a.keyCode)>-1&&1==this.__getQ().length?this.__togglePlaceholder(!0):48<=a.keyCode&&a.keyCode<=90&&!a.altKey&&!a.ctrlKey&&!this.__commandKey&&this.__togglePlaceholder(!1):"keyup"===a.type&&(91==a.keyCode||92==a.keyCode?this.__commandKey=!1:this.__togglePlaceholder()))},__togglePlaceholder:function(a){this.__placeholderEmulation&&(this.__regionSearchPlaceholder.style.display=a===!0||a===!1?a?"block":"none":this.__regionSearchInput._input.el.value?"none":"block")},__validate:function(a){a=void 0===a?this.__regionSearchInput._input.el.value:a;var b=""===a||/^[a-zA-Zа-яА-Яё() \-]+$/i.test(a);return b?this.__removeError(!0):this.__setError(),b},__getQ:function(){return this.__q},__setQ:function(a,b){this.__autocompletedValue=b||"",this.__q=a,this.__regionSearchInput._input.el.value=this.__autocompletedValue?this.__autocompletedValue:this.__q;var c=this.__getNormalizedQ(this.__q).length,d=this.__autocompletedValue.length;if(this.__popup.isVisible())if(this.__regionSearchInput._input.el.setSelectionRange)this.__regionSearchInput._input.el.setSelectionRange(c,d);else if(this.__regionSearchInput._input.el.createTextRange){var e=this.__regionSearchInput._input.el.createTextRange();e.collapse(!0),e.moveEnd("character",d),e.moveStart("character",c),e.select()}this.__togglePlaceholder()},__getNormalizedQ:function(a){return a=void 0!==a?a:this.__getQ(),a.toLowerCase()},__getSelection:function(){var a=this.__getNormalizedQ(this.__q).length;return this.__autocompletedValue&&-1!==this.__regionSearchInput._input.el.value.toLowerCase().indexOf(this.__autocompletedValue.toLowerCase())?this.__autocompletedValue.substr(a).toLowerCase():""},__getQLoaded:function(){return this.__qLoaded},__setQLoaded:function(a){this.__qLoaded=a.toLowerCase()},__hasError:function(){return this.__regionSearchInput.hasMod("error")},__setError:function(a){clearTimeout(this.__hightlightTimeout),this.__regionSearchInput.addMod("error"),a?(this.__hightlightTimeout=setTimeout(B.bind(function(){this.__validate()},this),1e3),B.addClass(this.__regionSuggests.parentNode,"w-"+this.__regionSuggestsBaseClass+"_highlight")):this.__removeError(!0,!0)},__removeError:function(a,b){b||this.__regionSearchInput.delMod("error"),a&&this.__regionSearchInput.delMod("highlight")},__switchToAuto:function(){this.__reset(),this.__regionSearchInput.addMod("disabled"),B.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_disabled")},__switchToManual:function(){this.__reset(),this.__regionSearchInput.delMod("disabled"),B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_disabled")},__url:"//portal.mail.ru/RegionSuggest",__loadRegions:function(a){if(!this.__loading||this.__getQLoaded()!==this.__getNormalizedQ()){var b=this.__getParams(a),c=b.q;if(!(a>this.__pages(c)-1)){this.__setQLoaded(c),this.__page=a;var d=this.__inCache(c,a);if(void 0===d){for(var e,f=c;(f=f.substr(0,f.length-1)).length>=2&&void 0===(e=this.__inCache(f,a)););if(e===!1)return void this.__updateList()}else if(d===!1)return void this.__updateList();if(d)return void this.__updateList(d,a);clearTimeout(this.__loaderTimeout),a||(this.__loaderTimeout=setTimeout(B.bind(function(){B.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_loading")},this),this.__settings.preloaderPause)),this.__loading=!0,b.q||delete b.q,B.$.ajax({cache:!1,data:b,dataType:"jsonp",error:B.bind(function(b,c,d){clearTimeout(this.__loaderTimeout),B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_loading"),this.__loading=!1,this.__getNormalizedQ()===this.__getQLoaded()&&this.__page===a&&this.__message(null,d)},this),jsonp:"callback",success:B.bind(function(b){clearTimeout(this.__loaderTimeout),B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_loading"),this.__loading=!1;var d=this.__cache(c,a,b);this.__getNormalizedQ()===this.__getQLoaded()&&this.__page===a&&this.__updateList(d,a)},this),timeout:6e4,url:this.__url})}}},__message:function(a,b){b?(this.__scrollTop=this.__regionSuggests.scrollTop,B.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_message"),B.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_error"),B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_empty")):a?(B.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_message"),B.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_empty"),B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_error")):(B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_message"),B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_empty"),B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_error")),!b&&this.__scrollTop&&(this.__regionSuggests.scrollTop=this.__scrollTop,this.__scrollTop=null)},__updateList:function(a,b){0!==b&&a||(this.__selectCity(),this.__regionSuggests.scrollTop=0,B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_hasMore"),this.__regionSuggestsGroupLists.current.innerHTML="",this.__regionSuggestsGroupLists.russia.innerHTML="",this.__regionSuggestsGroupLists.other.innerHTML=""),this.__message(!a),a&&(a.current.length&&this.__regionSuggestsGroupLists.current.appendChild(this.__groupHTML(this.__regionsCache,a.current)),a.russia.length&&this.__regionSuggestsGroupLists.russia.appendChild(this.__groupHTML(this.__regionsCache,a.russia)),a.other.length&&this.__regionSuggestsGroupLists.other.appendChild(this.__groupHTML(this.__regionsCache,a.other)),void 0!==b&&b!==this.__pages(this.__getNormalizedQ())-1?B.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_hasMore"):B.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_hasMore"),(this.__regionSuggestsGroupLists.current.childNodes.length?B.removeClass:B.addClass)(this.__regionSuggestsGroups.current,this.__regionSuggestsGroupBaseClass+"_empty"),(this.__regionSuggestsGroupLists.russia.childNodes.length?B.removeClass:B.addClass)(this.__regionSuggestsGroups.russia,this.__regionSuggestsGroupBaseClass+"_empty"),(this.__regionSuggestsGroupLists.other.childNodes.length?B.removeClass:B.addClass)(this.__regionSuggestsGroups.other,this.__regionSuggestsGroupBaseClass+"_empty"));var c=this.__items;this.__items=B.$("."+this.__regionSuggestsGroupItemBaseClass,this.__regionSuggests),1===this.__items.length&&this.__selectCity(this.__items[0],1==c.length&&c[0].getAttribute("data-id")===this.__items[0].getAttribute("data-id")),c=null,this.__regionSuggestsScrollHeight=this.__regionSuggests.scrollHeight},__groupHTML:function(a,b){if(!b||!b.length)return"";for(var c=document.createDocumentFragment(),d=0,e=b.length;e>d;d++){var f=b[d],g=a[f],h=g.parentId&&a[g.parentId],i=h&&h.parentId&&a[h.parentId],j=document.createElement("div"),k=document.createElement("span"),l=document.createElement("span");j.setAttribute("data-id",f),j.regionData=g,j.className="portal-region__suggests__group__item",k.className="portal-region__suggests__group__item__name",l.className="portal-region__suggests__group__item__info",k.innerHTML=g.cityName;var m="";h&&h.regionName&&(m+=h.regionName),i&&i.regionName&&(m&&(m+=", "),m+=i.regionName),j.appendChild(k),m&&(l.innerHTML="("+m+")",j.appendChild(l)),c.appendChild(j)}return c},__getParams:function(a){var b={q:this.__getNormalizedQ()},c=this.__getNormalizedQ();c&&(b.q=c);var d=this.__settings.pageSize*a,e=this.__settings.pageSize;return this.__settings.startRegion&&(b.rId=this.__settings.startRegion),void 0!==d&&(b.M=d),void 0!==e&&(b.N=e),b},show:function(){function a(){this.__popup.show(),this.emit("show")}this.__popup.isVisible()||(this.emit("beforeShow"),this.__inCache(this.__getNormalizedQ(),this.__page)?a.call(this):setTimeout(B.bind(a,this),this.__settings.preloaderPause))},hide:function(){this.__popup.isVisible()&&(this.emit("beforeHide"),this.__popup.hide(),this.emit("hide"))}}),B.PortalRegion=a}(),function(a){function c(){!a.regionalSelector&&a.SCookie&&(a.$(document.body).append(a.tmpl({block:"popup",params:{mods:"_overlay-enabled _hideByEsc-enabled _hideByClick-enabled",title:"Выберите город",controls:[{type:"button",action:"save",text:"Сохранить",mods:{"*":"_action"}},{type:"link",action:"cancel",text:"Отменить"}],content:a.tmpl({block:"region",params:{}})}})),a.regionalSelector=new a.PortalRegion({effRegion:window.__PortalRegions.effRegion,region:window.__PortalRegions.ipRegion,auto:!a.SCookie.getGlobal("geo"),notification:!1,cityName:"null"!=window.__PortalRegions.ipRegion.name&&window.__PortalRegions.ipRegion.name?window.__PortalRegions.ipRegion.name:"Москва",startRegion:window.__PortalRegions.ipRegion.level2}))}a.initExternal=function(){function b(a){if(a){var b={resize:function(){b.toolbar&&b.toolbar.resize(),b.submenu&&b.submenu.resize()},toolbar:g?g.getAPI():null,submenu:h?h.getAPI():null};a&&a(b)}}function d(){q=!!p.clientHeight,q?e():i=setTimeout(d,0)}function e(){f()}function f(){A.draw.replace(function(d,e){if(z.time("toolbar draw"),d||(d={}),A._conf=d,o){var f=a.$(a.BEM.constructors[A.settings.cssPrefix+"-logo"].getEls(d.logo));k.append(f),f.bem()}else if("logo"in d){var f=a.$(a.BEM.constructors[A.settings.cssPrefix+"-logo"].getEls(d.logo));k.html(""),k.append(f),f.bem()}if("toolbar"in d)if(null!==d.toolbar){var i;i=a.$(a.BEM.constructors[A.settings.cssPrefix+"-toolbar"].getEls(d.toolbar)),g?g.$el.replaceWith(i):j.append(i),g=i.bem()}else g&&g.destroy(!0),g=null;if("submenu"in d)if(null!==d.submenu){var p;d.submenu.submenu=!0,p=a.$(a.BEM.constructors[A.settings.cssPrefix+"-toolbar"].getEls(d.submenu)),h?h.$el.replaceWith(p):l.append(p),m.show(),n.hide(),h=p.bem()}else h&&h.destroy(!0),h=null,m.hide(),n.show();if(a.rootNode.style.height="",a.rootNode.style.height=a.rootNode.clientHeight+"px",A.settings.regionsSelectorEnabled){var q=a.$(a.rootNode).find("."+A.settings.cssPrefix+"-toolbar__button_region").bem();q&&(a.$(a.rootNode).find("."+A.settings.cssPrefix+"-toolbar__button_region").bem().getAPI().on("click",function(a){a.preventDefault(),A.regionSelector.show()}),A.regionSelector.show.replace(function(){c(),a.regionalSelector.show.apply(a.regionalSelector,arguments)}),A.regionSelector.hide.replace(function(){c(),a.regionalSelector.hide.apply(a.regionalSelector,arguments)}))}o=!1,z.timeEnd("toolbar draw"),e&&b(e)}),A.getItems.replace(b),A.batchActions.replace(function(a){"function"==typeof a&&(a(),g&&(null!==g._updateGroupsTimeout&&void 0!==g._updateGroupsTimeout?g.updateGroups(!0):null!==g._expandTimeout&&void 0!==g._expandTimeout&&g.resize(!0)),h&&(null!==h._updateGroupsTimeout&&void 0!==h._updateGroupsTimeout?h.updateGroups(!0):null!==h._expandTimeout&&void 0!==h._expandTimeout&&h.resize(!0)))}),A._loaded=!0,A.emit("load")}var g,h,i,j=a.$("."+A.settings.cssPrefix+"-menu__center__inner",a.rootNode).eq(0),k=a.$("."+A.settings.cssPrefix+"-menu__left__inner",a.rootNode),l=a.$("."+A.settings.cssPrefix+"-menu__center__inner_submenu",a.rootNode),m=a.$("#"+A.settings.rootClass+"__submenu",a.rootNode),n=a.$("#w-"+A.settings.cssPrefix+"-menu__shadow",a.rootNode),o=!0,p=a.byId("pm-css-checker"),q=!1;d(),setTimeout(function(){clearTimeout(i),q||e()},1e3)},a.rootNode?a.initExternal():A.init.replace(function(){a.rootNode=b(A.settings.rootClass),a.initInline(),a.initExternal()})}(B),z.timeEnd("portal-menu.full.js")}}}).call(window);