YAHOO.JP.news.tpc=YAHOO.JP.news.tpc||{},YAHOO.JP.news.tpc.comment=function(){var e,t,s=!1,n=Backbone.Model.extend({urlRoot:"/pickup/user",defaults:{isntDisplay:!1,displayTab:""}}),a=Backbone.View.extend({events:{"change .chbx":"setUserState"},initialize:function(e){_.bindAll(this,"render","setUserState"),this.model.bind("change",this.render),this.model.set({isntDisplay:this._getIsntDisplay()}),this.render()},render:function(){var e=this.el,t=this.model.get("isntDisplay");$(".chbx",e).prop("checked",this._getCheckboxState()),t?($("#yComments, #fbComments, .news-comment-plugin",e).attr("style","display :none;"),"fb"==this._getDisplayTab()||""==this._getDisplayTab()&&"fb"==this._getStandbyTab()?($("#ycTab",e).removeClass("standby"),$("#fbTab",e).addClass("standby")):($("#ycTab",e).addClass("standby"),$("#fbTab",e).removeClass("standby")),$("#ycTab, #fbTab",e).removeClass("current")):("fb"==this._getDisplayTab()||"fb"==this._getStandbyTab()?(s||(s=!0,$("#fbComments",e).append($($("#fb-comment-template",e).text()))),$("#fbComments",e).removeAttr("style"),$("#ycTab",e).removeClass("current"),$("#fbTab",e).addClass("current"),$("#fbTab",e).removeClass("standby")):(YAHOO.JP.News.comment.show(),$("#loadingComment",e).show(),$("#yComments, .news-comment-plugin",e).removeAttr("style"),$("#ycTab",e).addClass("current"),$("#ycTab",e).removeClass("standby"),$("#fbTab",e).removeClass("current")),FB.XFBML.parse(this.el))},setUserState:function(){this.model.save({isntDisplay:this._getIsntDisplay()}),sendBeacon("comment","cmt_disp","comment","cmt_disp",t,e)},_getIsntDisplay:function(){return $(".chbx",this.el).prop("checked")},_getCheckboxState:function(){return this.model.get("isntDisplay")},_getDisplayTab:function(){var e=this.el,t=$(".tabmenu.current",e);return"undefined"!=typeof t&&t.attr("id")?t.attr("id").replace(/Tab/g,""):this.model.get("displayTab")},_getStandbyTab:function(){var e=this.el,t=$(".tabmenu.standby",e);return t.attr("id")?t.attr("id").replace(/Tab/g,""):void 0}}),i=Backbone.View.extend({events:{"click #ycTab":"showYComments","click #fbTab":"showFBComments"},initialize:function(e){_.bindAll(this,"showYComments","showFBComments","setUserState"),this.model.set({displayTab:this._getDisplayTab()})},showYComments:function(){var s=this.model.get("isntDisplay");s&&($(".chbx",n).prop("checked",!1),this.model.set({isntDisplay:!1}),this.model.save({isntDisplay:!1}));var n=this.el;YAHOO.JP.News.comment.show(),$("#loadingComment").show(),$("#fbComments",n).attr("style","display :none;"),$("#ycTab",n).addClass("current"),$("#fbTab",n).removeClass("current"),this.model.set({displayTab:"yc"}),this.model.save({displayTab:"yc"}),sendBeacon("comment","cmt_y","comment","cmt_y",t,e)},showFBComments:function(){var n=this.model.get("isntDisplay");n&&($(".chbx",a).prop("checked",!1),this.model.set({isntDisplay:!1}),this.model.save({isntDisplay:!1}));var a=this.el;s||(s=!0,$("#fbComments",a).append($($("#fb-comment-template",a).text()))),$("#yComments, .news-comment-plugin",a).attr("style","display :none;"),$("#fbComments",a).removeAttr("style"),$("#ycTab",a).removeClass("current"),$("#fbTab",a).addClass("current"),this.model.set({displayTab:"fb"}),this.model.save({displayTab:"fb"}),sendBeacon("comment","cmt_f","comment","cmt_f",t,e)},setUserState:function(){this.model.save({displayTab:this._getDisplayTab()})},_getDisplayTab:function(){var e=this.el,t=$(".tabmenu.current",e);return t.attr("id")?t.attr("id").replace(/Tab/g,""):this.model.get("displayTab")}}),o=Backbone.View.extend({events:{"click #cmtView":"clickCmtView"},initialize:function(e){_.bindAll(this,"clickCmtView")},clickCmtView:function(){sendBeacon("comment","cmt_view","comment","cmt_view",t,e)}}),c=function(s,c,m,l){e=l,t=s,window.fbAsyncInit=function(){FB.init({appId:"276725822409153",channelUrl:"//news.yahoo.co.jp/pickup/channel.php",status:!0,cookie:!0,xfbml:!0,version:"v2.0"});var e=0;FB.Event.subscribe("edge.create",function(t){var n=[{mod:{name:"facebook"},links:[{name:"like_log",params:{sec:"facebook",slk:"like_log",pos:"1"}}]}],a=YAHOO.i13n.Beaconer({beacon_server:"ybx.yahoo.co.jp",keys:{rpdprop:"facebook"},link_data:n,spaceid:s});0==e&&(a.doClickBeacon(n[0].links[0].params),e=1)});{var t=new n;new a({el:c,model:t}),new i({el:c,model:t}),new o({el:m,model:t})}}};return{initialize:c,UserStatus:n,CommentSwitch:a,CommentView:o,CommentTab:i}}(),!function(e){var t,s="facebook-jssdk",n=e.getElementsByTagName("script")[0];e.getElementById(s)||(t=e.createElement("script"),t.id=s,t.async=!0,t.src="//connect.facebook.net/ja_JP/sdk.js",n.parentNode.insertBefore(t,n))}(document);