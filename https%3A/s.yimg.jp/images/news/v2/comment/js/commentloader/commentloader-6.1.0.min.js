/* commentloader-6.1.0.min.js 2017-11-02 16:37:38 */
!function(t){t("util",[],function(){"use strict";var t={extend:function(t){for(var e=[].slice.call(arguments,1),n=0;n<e.length;n++)for(var r in e[n])t[r]=e[n][r];return t}};return t.extend(t,{reduce:function(t,e,n){for(var r=n,o=0;o<t.length;o++)r=e(r,t[o],o,t);return r},map:function(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r,t));return n},range:function(e,n){t.isUndefined(n)&&(n=e,e=0);for(var r=[],o=e;n>o;o++)r.push(o);return r},keys:function(t){var e=[];for(var n in t)e.push(n);return e},isArray:function(t){return t instanceof Array},isUndefined:function(t){return"undefined"==typeof t},isObject:function(t){return"object"==typeof t},each:function(t,e){for(var n=0;n<t.length;n++)e(t[n],n,t)},filter:function(t,e){for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},makeNameSpace:function(e,n){var r=t.isArray(n)?n:n.split(".");return t.reduce(r,function(t,e){return t[e]||(t[e]={}),t[e]},e)},buildQuery:function(e){return t.map(t.keys(e),function(t){return t+"="+encodeURIComponent(e[t])}).join("&")},parseGetParam:function(e){var n={},r=e?e.split("&"):[];return t.each(r,function(e){var r=e.split("="),o=t.trim(r[0]),i=t.isUndefined(r[1])?"":t.trim(decodeURIComponent(r[1]));n[o]=i}),function(e,r,o){switch(arguments.length){case 3:return!t.isUndefined(n[e])&&r.test(n[e])?n[e]:o;case 1:return n[e];default:throw"Invalid argument"}}},getOrigin:function(t){return t.split("/").slice(0,3).join("/")}}),t}),t("global",[],function(){"use strict";return Function("return this")()}),t("jquery",["global"],function(t){"use strict";return t.jQuery}),t("location",[],function(){"use strict";return location}),t("eventemitter",["util"],function(t){"use strict";var e="*",n=function(t,e,n,r){var o=t.__events||(t.__events=[]);o.push({type:e,listener:n,options:r||{}})};return{on:function(e,r,o){if(t.isObject(arguments[0])){var i=arguments[0],a=this;t.each(t.keys(i),function(t){n(a,t,i[t],{})})}else n(this,e,r,o)},once:function(e,r){var o={once:!0};if(t.isObject(arguments[0])){var i=arguments[0],a=this;t.each(t.keys(i),function(t){n(a,t,i[t],o)})}else n(this,e,r,o)},trigger:function(n,r){var o=this.__events||(this.__events=[]),i=t.filter(o,function(t){var r=!t.options.once||t.options.once&&!t.executed;return(t.type===e||t.type===n)&&r}),a=this;t.each(i,function(t){t.type===e?t.listener.call(a,n,r):t.listener.call(a,r),t.executed=!0})}}}),t("iframecommunicator_parent",["global","jquery","location","util","eventemitter"],function(t,e,n,r,o){"use strict";function i(n){var i=r.extend({iframe:null,childOrigin:"*",forceIframe:!1,messageFilter:function(){return!0},messageParser:function(t){return{event:"message",data:t}},messageMaker:function(t){return t}},n),a=e(i.iframe),s=r.extend({},o);if(0===a.length)throw"No iframe";var f=a.get(0).contentWindow,d=function(){return!i.forceIframe&&c?function(t){f.postMessage(t,i.childOrigin)}:function(t){var e=u(a.attr("src"),t);a.attr("src",e)}}(),p=function(t){var e=i.messageParser(t);i.messageFilter(e)&&s.trigger(e.event,e.data)};return l(i.callback,p),e(t).on("message",function(t){i.childOrigin===t.originalEvent.origin&&p(t.originalEvent.data)}),{send:function(){d(i.messageMaker.apply(null,arguments))},receiver:s}}function a(e){var o=n.hash.slice(1),i=r.reduce(e.callback.split("."),function(t,e){return t[e]},t.parent.parent);i(o)}var c=!!t.postMessage,u=function(t,e){return t.split("#")[0]+"#"+e},s=function(t){return t&&t.trigger&&t.on},l=function(e,n){e=r.isArray(e)?e:e.split(".");var i=e.slice(-1)[0],a=r.makeNameSpace(t,e.slice(0,-1));s(a[i])||(a[i]=r.extend(function(t){a[i].trigger("*",t)},o)),a[i].on("*",function(t,e){n(e)})};return{Parent:i,GrandChild:a}}),t("navigator_util",["global","util"],function(t,e){"use strict";function n(t){var n=t.toLowerCase(),r=function(t){return-1!==n.indexOf(t)},o={msie:!r("opera")&&(r("msie")||r("trident")),android:r("android"),chrome:r("safari")&&r("chrome"),safari:r("safari")&&!r("chrome")&&!r("android"),firefox:r("firefox"),opera:r("opera")};return o.currentBrowser=e.reduce(e.keys(o),function(t,e){return t||o[e]&&e},null),o}function r(t,e){var n=function(t,e){return function(n){var r=n.match(t);return r&&r[e]||null}},r={msie:n(/(msie\s|rv:)([\d+\.\d+]+)/,2),firefox:n(/firefox\/(\d+\.\d+)/,1),chrome:n(/chrome\/(\d+\.\d+)/,1),safari:n(/version\/(\d+\.\d+)/,1),opera:function(t){var e=-1!==t.indexOf("version/"),r=-1===t.indexOf("opera/");return e?n(/version\/(\d+\.\d+)/,1)(t):r?n(/opera (\d+\.\d+)/,1)(t):n(/opera\/(\d+\.\d+)/,1)(t)},android:n(/android (\d+\.\d+)/,1)}[t];return r?parseFloat(r(e.toLowerCase())):0}return function(t){var o=n(t),i=r(o.currentBrowser,t),a=function(t){return t>=i};return e.extend({version:i,upto:a},o)}}),t("elm-visibility",["util","navigator_util"],function(t,e){"use strict";function n(t,e){return!t.parentNode||t.parentNode===document.documentElement&&t!==e?!1:t===e||n(t.parentNode,e)}function r(){var t="CSS1Compat"===document.compatMode;return{width:t&&document.documentElement.clientWidth||document.body.clientWidth,height:t&&document.documentElement.clientHeight||document.body.clientHeight}}function o(t,e,n){return e>0&&n>0&&t.width>e&&t.height>n}function i(t){return Math.min(Math.max(t,0),1)}function a(t,e){return e.top<0?1:i(1-(e.top-t.height)/e.top)}function c(t,e){var n=e.bottom-e.top,r=(t.height-e.top)/n;return i(r)}function u(t){return t.left+Math.round((t.right-t.left)/2)}function s(t,e){for(var n=10,r=u(e),i=(e.bottom-e.top)/n,a=0,c=e.top;n>a;a++,c+=i)if(o(t,r,c))return c;return!1}function l(t){var e=t.getBoundingClientRect(),o=r(),i=s(o,e),l=d(u(e),i+1),f=i!==!1&&l&&n(l,t);return{isVisible:f,scrollDegree:a(o,e),visiblePartRate:c(o,e)}}var f=window.navigator.userAgent,d=function(){var t=e(f),n=t.opera&&t.upto(10.1)||t.safari&&t.upto(4),r=function(t,e){return{left:t,top:e}},o=function(t,e){return r(t+document.body.scrollLeft,e+document.body.scrollTop)},i=n?o:r;return function(t,e){var n=i(t,e);return document.elementFromPoint(n.left,n.top)}}();return{getVisibility:l}}),t("interval",[],function(){"use strict";var t=function(t,e){var n=setInterval(t,e);return function(){clearInterval(n)}};return t}),t("timeout",[],function(){"use strict";var t=function(t,e){var n=setTimeout(t,e);return function(){clearTimeout(n)}};return t}),t("watcher",["util","interval","timeout"],function(t,e,n){"use strict";return function(r){var o,i=t.extend({interval:50,watch:function(){},onChange:function(){},compare:function(t,e){return t===e},startDelay:0,autoStart:!0},r),a=t.isUndefined(i.initialValue)?i.watch():i.initialValue,c=function(){var t=i.watch();i.compare(a,t)||(i.onChange(a,t),a=t)},u=function(){o&&o()},s=function(){u(),o=e(c,i.interval)};return i.autoStart&&n(s,i.startDelay),{stop:u,start:s}}}),t("../commentloader",["global","jquery","location","util","iframecommunicator_parent","elm-visibility","watcher","timeout","eventemitter"],function(t,e,n,r,o,i,a,c,u){var s="YAHOO.JP.News.comment",l=s+".callback",f="https://news.yahoo.co.jp/comment/plugin/v1/full/",d="https://news.yahoo.co.jp/comment/plugin/v1/short/",p=r.getOrigin(n.href),m=1e4,h=".news-comment-plugin",v="news-comment-plguin-iframe",g={pc:"pc",smartphone:"smartphone"},y={full:"full","short":"short"},b={sort:"s",order:"o",page:"p",type:"t"},w={sort:"lost_points",order:"desc",page:1,type:""},_=r.parseGetParam(n.search.slice(1)),k=function(){var n=function(t,n){var r=e(e("body").scrollTop()>=e("html").scrollTop()?"body":"html");r.animate({scrollTop:t.offset().top+n},"slow","swing")},c=function(t,n,r){return e("<iframe>").addClass(v).css({width:"100%",height:0,border:"none"}).attr({scrolling:"no",frameborder:0,src:n+"?"+e.param(r)}).appendTo(t)},s=function(t){var n="コメントを取得出来ませんでした<br>しばらく時間をおいてからもう一度お試しください。",r='"メイリオ", "ヒラギノ角ゴ Pro W3", "MS PGothic", "MS UI Gothic", Helvetica, Arial, sans-serif',o=e(t).empty();e("<div>").css({textAlign:"center",padding:"30px",lineHeight:"2em",fontFamily:r}).html(n).appendTo(o)},h=function(t){e("> *",t).not("."+v).remove()},k=function(t){return{sort:_(t.sort,/^[a-z_]+$/,w.sort),order:_(t.order,/^(desc|asc)$/,w.order),page:_(t.page,/^[0-9]+$/,w.page),type:_(t.type,/^[a-z_]+$/,b.type)}};return function(w,x){var j=x.deviceType===g.smartphone,C=w===y.full,O=C?f:d,P=C?k(x.page_keys||b):{},T=r.isUndefined(_("expand_form"))?{}:{expand_form:""},M=e.extend({origin:p},P,x.params,T);C||(M.device=x.deviceType),M.ua=navigator.userAgent;var N=c(x.target,O,M),A=new o.Parent({iframe:"."+v,callback:l,childOrigin:r.getOrigin(O),messageParser:function(t){t="#"===t.charAt(0)?t.substr(1):t;var e=t.split("-");return{event:e[0],data:e[1]}}}),S=t.setTimeout(function(){s(x.target)},m),U=!1;A.receiver.on({dispform:function(t){n(N,~~t)},postcomment:function(r){r=j?r-1*e(t).height()/3:.9*r,n(N,r)},adjustheight:function(t){e(N).is(":visible")&&(0==U?setTimeout(function(){U=!0},10):N.height(t))},init:function(e){t.clearTimeout(S),h(x.target),A.receiver.trigger("adjustheight",~~e)}}),x.onload&&A.receiver.once("init",x.onload),x.onOpenModule&&A.receiver.on("openmodule",x.onOpenModule),x.onCloseModule&&A.receiver.on("closemodule",x.onCloseModule);var I=r.extend({},u);I.once({top:function(){A.send("view-top")},bottom:function(){A.send("view-bottom")}});var V=new a({interval:50,autoStart:!1,watch:function(){return i.getVisibility(N.get(0))},compare:function(t,e){return e.isVisible?t.visiblePartRate===e.visiblePartRate?!0:!1:!0},onChange:function(t,e){e.visiblePartRate>0&&I.trigger("top"),1===e.visiblePartRate&&I.trigger("bottom")}});A.receiver.once("init",function(){V.start()})}}(),x=function(){var t=new e.Deferred,n=new e.Deferred,o=function(n){var r=e(n.target),o=new a({initialValue:!1,watch:function(){var t=i.getVisibility(r.get(0));return t.isVisible||t.scrollDegree>n.autoload_on},onChange:function(){t.resolve(),o.stop()}})},c=function(e,i){var a=r.extend({autoload:!0,autoload_on:.7},i);t.then(function(){k(e,a)}),n.then(function(){a.autoload?o(a):t.resolve()})};return e(function(){var t=e(h);if(t.length){var o="full"===t.attr("data-page-type"),i="pc"===t.attr("data-device-type"),a=!r.isUndefined(t.attr("data-defer")),u=!!r.isUndefined(t.attr("data-autoload")),s={deviceType:i?g.pc:g.smartphone,target:h,params:{keys:t.attr("data-keys"),full_page_url:t.attr("data-full-page-url"),comment_num:t.attr("data-comment-num"),iframe_path:t.attr("data-iframe-path"),ref:t.attr("data-ref")||"",bkt:t.attr("data-bkt")||"",flt:t.attr("data-flt")||"",grp:t.attr("data-grp")||"",opttype:t.attr("data-opttype")||"",disable_total_count:t.attr("data-disable-total-count")||"",compact:t.attr("data-compact")||"",compact_initial_view:t.attr("data-compact-initial-view")||"",display_author_banner:t.attr("data-display-author-banner")||"off"}};a&&(s.defer=a),u&&(s.autoload=u),c(o?y.full:y.short,s),!s.defer&&n.resolve()}}),{show:function(){n.resolve()},showFull:function(t){c(y.full,t),!t.defer&&n.resolve()},showShort:function(t){c(y.short,t),!t.defer&&n.resolve()}}}(),j=r.makeNameSpace(t,s);r.extend(j,x)}),t("../commentcount",["global","jquery","location","util"],function(t,e,n,r){var o="YAHOO.JP.News.comment",i="https://news.yahoo.co.jp/comment/plugin/v1/count/",a=function(){var t=function(t){var n="design"in t?"?type="+t.design:"",r=i+t.property_id+"/"+t.topic_id+"/"+n,o=new Image;o.onload=function(){e(t.placeholder).html(o)},o.src=r,"height"in t&&(o.style.height=t.height),u(t)},n=function(t){var n=i+t.property_id+"/"+t.topic_id+"/?output=json&callback=?";e.ajax({url:n,type:"GET",dataType:"jsonp",cache:!0,jsonpCallback:"commentcount",timeout:1e3}).done(function(e){var n=parseInt(e.count,"10");isNaN(n)&&(n=0),t.count=n,r(t),u(t)}).fail(function(){t.count=0,r(t),u(t)})},r=function(t){var n=0===t.count?"txt":"count",r=0===t.count?"コメント":t.count,o='<a href="javascript:void(0);"><span class="'+n+'">'+r+"</span></a>";e(t.placeholder).children().animate({opacity:0},function(){e("a",t.placeholder).remove(),e(t.placeholder).append(o)})},o=function(t){var n="https://s.yimg.jp/images/jpnews/cre/common/all/images/loading24_w_2x.gif";e(t.placeholder).html('<a href="javascript:void(0);"><span><img src="'+n+'" style="width:24px;height:24px;">').addClass("ycCountBtn")},a=function(t){var e="cmtmod_count",n="cid"in t?{cid:t.cid,rpdprop:"news"}:{rpdprop:"news"};"bkt"in t&&(n.vtestid=t.bkt),"flt"in t&&(n.v_pkjp=t.flt),n.count=0===t.count?0:"Num";var r="pos"in t?[{mod:{name:e},links:[{params:{sec:e,slk:t.slk,pos:t.pos}}]}]:[{mod:{name:e},links:[{params:{sec:e,slk:t.slk}}]}];return{pageParam:n,linkParam:r,sid:t.space_id,params:r[0].links[0].params}},c=function(t){return YAHOO.i13n.Beaconer({beacon_server:"ybx.yahoo.co.jp",https:!0,keys:t.pageParam,link_data:t.linkParam,spaceid:t.sid})},u=function(t){var n=a(t),r=c(n);r.doViewBeacon(0),e(t.placeholder).on("click",function(){r.doClickBeacon(n.params)})},s=function(t){"scroll_to"in t&&e(t.placeholder).on("click",function(){var n=e(t.scroll_to).offset().top;e("body,html").animate({scrollTop:n},300,"swing")})};return{showCommentCount:function(r){if(r.property_id&&r.topic_id){var i="html",a={html:"html",img:"img"};"type"in r&&r.type in a==!1||(r=e.extend({type:r.type||i,slk:a[r.type||i]},r),s(r),"html"===r.type?(o(r),e(function(){n(r)})):"img"===r.type&&e(function(){t(r)}))}}}}(),c=r.makeNameSpace(t,o);r.extend(c,a)}),t("../index",["util","../commentloader","../commentcount"],function(t){var e=[].slice.call(arguments,1),n={};return t.each(e,function(e){t.extend(n,e)}),n})}(function(){var t={},e=function(t,e){for(var n=[],r=0;r<t.length;r++)n[r]=e(t[r]);return n};return function(n,r,o){switch(arguments.length){case 3:r=arguments[1],o=arguments[2];break;case 2:r=[],o=arguments[1];break;default:throw"Unknown style of define function"}t[n]=function(){return"object"==typeof o?o:o.apply(null,e(r,function(e){return t[e]}))}()}}());