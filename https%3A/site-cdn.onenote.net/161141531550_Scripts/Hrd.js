var OfficeBrowserFeedback;(function(n){var t;(function(n){var t;(function(n){n[n.Error=0]="Error";n[n.Warning=1]="Warning";n[n.Info=2]="Info";n[n.Verbose=3]="Verbose";n[n.Spam=4]="Spam"})(t=n.LogLevel||(n.LogLevel={}));n.NetworkingMgr=null})(t=n.Networking||(n.Networking={}))})(OfficeBrowserFeedback||(OfficeBrowserFeedback={})),function(n){var t;(function(n){var t=function(){function t(){this.UlsLevelMap={}}return t.prototype.Init=function(t,i){this.telemetryCatID=t;this.feedbackDataCatID=i;this.UlsLevelMap[n.LogLevel.Info]=Diag.ULSTraceLevel.info;this.UlsLevelMap[n.LogLevel.Warning]=Diag.ULSTraceLevel.warning;this.UlsLevelMap[n.LogLevel.Error]=Diag.ULSTraceLevel.error;this.UlsLevelMap[n.LogLevel.Verbose]=Diag.ULSTraceLevel.verbose;this.UlsLevelMap[n.LogLevel.Spam]=Diag.ULSTraceLevel.spam},t.prototype.Dismiss=function(){},t.prototype.SendTrace=function(n,t){Diag.ULS.sendTraceTag(4477014,this.telemetryCatID,this.UlsLevelMap[n],"{0}",t)},t.prototype.LogFeedbackData=function(n){Diag.ULS.sendTraceTag(4477015,this.feedbackDataCatID,Diag.ULSTraceLevel.info,"{0}",n)},t}();n.DefaultNetworkingMgr=t;n.NetworkingMgr=new n.DefaultNetworkingMgr})(t=n.Networking||(n.Networking={}))}(OfficeBrowserFeedback||(OfficeBrowserFeedback={})),function(n){function h(t,i,f,o,h,c,l,a){n.Networking.NetworkingMgr.Init(o,h);u.Init(l);r.Init(t,i,c,a);e.Init();s=f;n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,{OFeedback:"Office browser feedback UI opened"})}function f(t){e.Dismiss();r.Dismiss();n.Networking.NetworkingMgr.Dismiss();s(t)}var o,t,i,r,e,u,s;(function(n){function t(){return window.innerWidth?window.innerWidth<800:!0}n.IsNarrow=t})(o=n.WindowProperties||(n.WindowProperties={})),function(n){var t,i,r,u,f,e,o,s,h,c,l;n.UseNarrowScreenLayout=!1,function(n){n.AriaDescribedBy="aria-describedby";n.AriaExpanded="aria-expanded";n.AriaHasPopup="aria-haspopup";n.AriaLabelledBy="aria-labelledby";n.AriaLive="aria-live";n.AriaHidden="aria-hidden";n.AriaPressed="aria-pressed";n.AriaSelected="aria-Selected";n.AriaLevel="aria-level";n.Form="form";n.HRef="href";n.MaxLength="maxlength";n.Name="name";n.Placeholder="placeholder";n.Role="role";n.Source="src";n.TabIndex="tabindex";n.Target="target";n.Type="type";n.Value="value";n.Rel="rel"}(t=n.AttributeName||(n.AttributeName={})),function(n){n.BlankWindow="_blank";n.Button="button";n.Checkbox="checkbox";n.Checked="checked";n.Dialog="dialog";n.False="false";n.FeedbackOverall="feedbackOverall";n.Heading="heading";n.NoReferrer="noreferrer";n.One="1";n.Polite="polite";n.Submit="submit";n.Text="text";n.TextAreaMaxLength="1000";n.True="true";n.Two="2";n.Three="3";n.Unchecked="unchecked"}(i=n.AttributeValue||(n.AttributeValue={})),function(n){n.CLCID="CLCID"}(r=n.UrlParameters||(n.UrlParameters={})),function(n){n.Screenshot=!1}(u=n.Brs||(n.Brs={})),function(n){n.BackgroundBlue="officeBrowserFeedbackBackgroundBLue";n.BackgroundGrey="officeBrowserFeedbackBackgroundGrey";n.FeedbackFormContainer="officeBrowserFeedbackFormContainer";n.FeedbackFormComment="officeBrowserFeedbackComment";n.FeedbackFormSubmitButtonContainer="officeBrowserFeedbackSubmitButtonContainer";n.FeedbackFormSubmitButton="officeBrowserFeedbackSubmitButton";n.FeedbackQuestionMiddleText="officeBrowserFeedbackQuestionMiddleText";n.FeedbackOverallAnchor="officeBrowserFeedbackOverallAnchor";n.FeedbackOverallImage="officeBrowserFeedbackOverallImage";n.FeedbackOverallText="officeBrowserFeedbackOverallText";n.FontSubtitle="officeBrowserFeedbackFontSubtitle";n.FontText="officeBrowserFeedbackFontText";n.FontTitle="officeBrowserFeedbackFontTitle";n.FormContainer="officeBrowserFeedbackFormContainer";n.FullWidth20pxHeight="officeBrowserFeedbackFullWidth20pxHeight";n.OverlayMinWidth="officeBrowserFeedbackOverlayMinWidth";n.Hidden="officeBrowserFeedbackHidden";n.MarginLeft36px="officeBrowserFeedbackMarginLeft36px";n.Narrow="officeBrowserFeedbackNarrowLayout";n.LineHeight="officeBrowserFeedbackLineHeight";n.PadLeft36px="officeBrowserFeedbackPadLeft36px";n.ShowRightBorder="officeBrowserFeedbackShowRightBorder";n.SlideLeft="slideLeft";n.TextAlignLeft="officeBrowserFeedbackTextAlignLeft";n.Visible="officeBrowserFeedbackVisible";n.LinkDiv="officeBrowserFeedbackLinkDiv";n.Link="officeBrowserFeedbackLink";n.TextAlginLeft="officeBrowserFeedbackTextAlginLeft"}(f=n.Classes||(n.Classes={})),function(n){n.ColumnSeparatorDiv="officeBrowserFeedbackColumnSeparatorDiv";n.FeedbackFormsWrapper="officeBrowserFeedbackFormsWrapper";n.FeedbackOverallDontLikeDiv="officeBrowserFeedbackOverallDontLikeDiv";n.FeedbackOverallDontLikeImage="officeBrowserFeedbackOverallDontLikeImage";n.FeedbackOverallDontLikeText="officeBrowserFeedbackOverallDontLikeText";n.FeedbackOverallLikeDiv="officeBrowserFeedbackOverallLikeDiv";n.FeedbackOverallLikeImage="officeBrowserFeedbackOverallLikeImage";n.FeedbackOverallLikeText="officeBrowserFeedbackOverallLikeText";n.FeedbackOverallSuggestionDiv="officeBrowserFeedbackOverallSuggestDiv";n.FeedbackOverallSuggestionImage="officeBrowserFeedbackOverallSuggestImage";n.FeedbackOverallSuggestionText="officeBrowserFeedbackOverallSuggestText";n.FeedbackQuestionLeftText="officeBrowserFeedbackQuestionLeftText";n.FeedbackTitle="officeBrowserFeedbackTitle";n.LeftFormContainer="officeBrowserFeedbackLeftFormContainer";n.MainContainer="officeBrowserFeedbackMainContainer";n.MainContentHolder="officeBrowserFeedbackMainContentHolder";n.MiddleFormContainer="officeBrowserFeedbackMiddleFormContainer";n.OverlayBackground="officeBrowserFeedbackOverlayBackground";n.PlaceHolderDiv1="officeBrowserFeedbackPlaceHolderDiv1";n.PlaceHolderDiv2="officeBrowserFeedbackPlaceHolderDiv2";n.PrivacyStatementLink="officeBrowserFeedbackPrivacyStatementLink";n.PrivacyStatementLinkDiv="officeBrowserFeedbackPrivacyStatementLinkDiv";n.RightFormContainer="officeBrowserFeedbackRightFormContainer";n.SimpleFeedbackFormContainer="officeBrowserFeedbackContainer";n.SimpleFeedbackFormQuestionMiddleText="officeBrowserFeedbackQuestionMiddleText";n.SimpleFeedbackFormComment="officeBrowserFeedbackComment";n.SimpleFeedbackFormScreenshotContainer="officeBrowserFeedbackScreenshotContainer";n.SimpleFeedbackFormScreenshotCheckboxText="officeBrowserFeedbackScreenshotCheckboxText";n.SimpleFeedbackFormScreenshotCheckbox="officeBrowserFeedbackScreenshotCheckbox";n.SimpleFeedbackFormScreenshotText="officeBrowserFeedbackScreenshotText";n.SimpleFeedbackFormSubmitButtonContainer="officeBrowserFeedbackSubmitButtonContainer";n.SimpleFeedbackFormSubmitButton="officeBrowserFeedbackSubmitButton";n.ContactInfoFormContainer="officeBrowserFeedbackContactInfoContainer";n.ContactInfoFormQuestionMiddleText="officeBrowserFeedbackContactInfoQuestionMiddleText";n.ContactInfoFormComment="officeBrowserFeedbackContactInfoComment";n.ContactInfoFormEmailText="officeBrowserFeedbackContactInfoEmailText";n.ContactInfoFormEmailInput="officeBrowserFeedbackContactInfoEmailInput";n.ContactInfoFormSubmitButtonContainer="officeBrowserFeedbackContactInfoSubmitButtonContainer";n.ContactInfoFormSubmitButton="officeBrowserFeedbackContactInfoSubmitButton";n.UservoiceLinkFormContainer="officeBrowserFeedbackUservoiceLinkFormContainer";n.UservoiceLinkFormQuestionMiddleText="officeBrowserFeedbackUservoiceLinkFormQuestionMiddleText";n.UservoiceLinkFormMiddleText="officeBrowserFeedbackUservoiceLinkFormMiddleText";n.UservoiceLinkFormAnchorContainer="officeBrowserFeedbackUservoiceLinkFormAnchorContainer";n.UservoiceLinkFormAnchor="officeBrowserFeedbackUservoiceLinkFormAnchor";n.UservoiceLinkFormCloseButtonContainer="officeBrowserFeedbackUservoiceLinkFormCloseButtonContainer";n.UservoiceLinkFormCloseButton="officeBrowserFeedbackUservoiceLinkFormCloseButton";n.FeedbackQuestionMiddleText="officeBrowserFeedbackQuestionMiddleText";n.FeedbackComment="officeBrowserFeedbackComment";n.SubmitButton="officeBrowserFeedbackSubmitButton";n.SubmitButtonContainer="officeBrowserFeedbackSubmitButtonContainer"}(e=n.IDs||(n.IDs={})),function(n){n.Enter=13;n.Esc=27;n.Space=32}(o=n.Keys||(n.Keys={})),function(n){n.Pause=100}(s=n.Numbers||(n.Numbers={})),function(n){n.Dislike="dislike";n.Like="like";n.Idea="idea"}(h=n.FeedbackType||(n.FeedbackType={})),function(n){n.Anchor="A";n.Div="DIV";n.Form="FORM";n.Img="IMG";n.Input="INPUT";n.TextArea="TEXTAREA"}(c=n.Tags||(n.Tags={})),function(n){function t(n,t,i){var r=t+n;return i&&(r+=i),r}n.PrivacyStatementLink="https://go.microsoft.com/fwlink/?LinkID=521839";n.CreateURL=t;var i;(function(n){var t=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");n.Extension=t?".svg":".png"})(i=n.Images||(n.Images={}))}(l=n.Urls||(n.Urls={}))}(t=n.Constants||(n.Constants={})),function(n){function e(n,i){var r=i?t.Classes.Hidden:t.Classes.Visible,u=i?t.Classes.Visible:t.Classes.Hidden;f(n,r,u)}function o(n){var t=document.getElementById(n);t!=null&&t.parentNode!=null&&t.parentNode.removeChild(t)}function i(n,t){var i=document.getElementById(n);i&&i.className.indexOf(t)==-1&&(i.className=i.className+" "+t)}function r(n,t){var i=document.getElementById(n);i&&(i.className=i.className.split(new RegExp("\\b"+t+"\\b","i")).join(" "),i.className=i.className.split(/\s+/).join(" "))}function f(n,t,u){r(n,t);i(n,u)}function s(n){for(var i,r=n.length,t=0;t<r;t++)i=new Image,i.src=n[t],typeof officeBrowserFeedbackCachedImages=="undefined"&&(window.officeBrowserFeedbackCachedImages=[]),window.officeBrowserFeedbackCachedImages.push(i)}function h(n,t,i){var r=document.getElementById(n);r&&r.setAttribute(t,i)}function c(){var n=-1,t=window.navigator.userAgent,i;return t.indexOf("Trident")>-1&&(i=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})"),i.exec(t)!=null&&(n=parseFloat(RegExp.$1)+4)),n}function l(n){var i=t.Urls.PrivacyStatementLink;return n&&n>0&&(i=i+"&"+t.UrlParameters.CLCID+"=0x"+n.toString(16)),i}function a(n){var t=u.GetData(),i=t.UservoiceUrl;return n&&u.RemoveData("UservoiceUrl"),i}function v(n){var t=u.GetData(),i=t.UservoicePrivacyStatementUrl;return n&&u.RemoveData("UservoicePrivacyStatementUrl"),i}n.SetElementVisibility=e;n.DeleteElementById=o;n.AddClassById=i;n.DeleteClassById=r;n.DeleteAndAddClassesById=f;n.CacheImages=s;n.SetAttributeOnHtmlElement=h;n.GetInternetExplorerVersion=c;n.GetPrivacyUrl=l;n.GetUservoiceUrl=a;n.GetUservoicePrivacyStatementUrl=v}(i=n.Utils||(n.Utils={})),function(r){function f(n){var r,u,i,s,e,o;if(typeof n.brs=="undefined"&&(n.brs=!0),!n.brs)return null;if(n.tag||(n.tag=t.Tags.Div),r=document.createElement(n.tag),n.attributes)for(i=0;i<n.attributes.length;i++)u=n.attributes[i],r.setAttribute(u.name,u.value);if(n.id&&(r.id=n.id),n.classes&&(s=n.classes.join(" "),r.className=s),n.innerText&&(r.innerHTML=n.innerText),n.children)for(i=0;i<n.children.length;i++)e=n.children[i],e&&(o=f(e),o&&r.appendChild(o));return r}function e(n){i.SetElementVisibility(u.GetFormContainerIdFromFormTemplate(u.ActiveFormTemplates[t.FeedbackType.Dislike]),!1);i.SetElementVisibility(u.GetFormContainerIdFromFormTemplate(u.ActiveFormTemplates[t.FeedbackType.Like]),!1);i.SetElementVisibility(u.GetFormContainerIdFromFormTemplate(u.ActiveFormTemplates[t.FeedbackType.Idea]),!1);t.UseNarrowScreenLayout?(i.SetElementVisibility(t.IDs.LeftFormContainer,!1),i.SetElementVisibility(t.IDs.MiddleFormContainer,!0),i.SetElementVisibility(n,!0)):(i.AddClassById(t.IDs.ColumnSeparatorDiv,t.Classes.ShowRightBorder),i.SetElementVisibility(t.IDs.MiddleFormContainer,!0),i.SetElementVisibility(n,!0),i.AddClassById(t.IDs.LeftFormContainer,t.Classes.SlideLeft),i.AddClassById(t.IDs.MiddleFormContainer,t.Classes.SlideLeft))}function s(n,e,s,h){var c,l;r.Strings=e;h?u.ActiveFormTemplates=h:(u.ActiveFormTemplates={},u.ActiveFormTemplates[t.FeedbackType.Dislike]=u.FeedbackFormTemplate.SimpleFeedbackForm,u.ActiveFormTemplates[t.FeedbackType.Like]=u.FeedbackFormTemplate.SimpleFeedbackForm,u.ActiveFormTemplates[t.FeedbackType.Idea]=u.FeedbackFormTemplate.SimpleFeedbackForm);t.UseNarrowScreenLayout=o.IsNarrow();c=f(u.GenerateSchema(s));document.body.insertBefore(c,document.body.firstChild);t.Urls.Images.FrownIcon=t.Urls.CreateURL("feedback_frown",n,t.Urls.Images.Extension);t.Urls.Images.LightBulbIcon=t.Urls.CreateURL("feedback_lightbulb",n,t.Urls.Images.Extension);t.Urls.Images.SmileIcon=t.Urls.CreateURL("feedback_smile",n,t.Urls.Images.Extension);l=[t.Urls.Images.FrownIcon,t.Urls.Images.LightBulbIcon,t.Urls.Images.SmileIcon];i.CacheImages(l);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallDontLikeImage,t.AttributeName.Source,t.Urls.Images.FrownIcon);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallLikeImage,t.AttributeName.Source,t.Urls.Images.SmileIcon);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallSuggestionImage,t.AttributeName.Source,t.Urls.Images.LightBulbIcon);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallDontLikeImage,t.AttributeName.AriaHidden,t.AttributeValue.True);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallLikeImage,t.AttributeName.AriaHidden,t.AttributeValue.True);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallSuggestionImage,t.AttributeName.AriaHidden,t.AttributeValue.True);i.SetElementVisibility(t.IDs.OverlayBackground,!0);i.GetInternetExplorerVersion()>9||i.GetInternetExplorerVersion()==-1?setTimeout(function(){i.SetElementVisibility(t.IDs.MainContentHolder,!0)},t.Numbers.Pause*8):i.SetElementVisibility(t.IDs.MainContentHolder,!0);t.UseNarrowScreenLayout&&i.AddClassById(t.IDs.OverlayBackground,t.Classes.Narrow)}function h(){i.SetElementVisibility(t.IDs.OverlayBackground,!1);i.DeleteElementById(t.IDs.OverlayBackground)}var u;(function(u){function e(n){switch(n){case f.SimpleFeedbackForm:return t.IDs.SimpleFeedbackFormContainer;case f.ContactInfoFeedbackForm:return t.IDs.ContactInfoFormContainer;case f.UservoiceLinkFeedbackForm:return t.IDs.UservoiceLinkFormContainer;default:return t.IDs.SimpleFeedbackFormContainer}}function o(n){switch(n){case f.SimpleFeedbackForm:return t.IDs.SimpleFeedbackFormQuestionMiddleText;case f.ContactInfoFeedbackForm:return t.IDs.ContactInfoFormQuestionMiddleText;case f.UservoiceLinkFeedbackForm:return t.IDs.UservoiceLinkFormQuestionMiddleText;default:return t.IDs.SimpleFeedbackFormQuestionMiddleText}}function a(n){switch(n){case r.Strings.l_DontLike:return o(u.ActiveFormTemplates[t.FeedbackType.Dislike]);case r.Strings.l_Like:return o(u.ActiveFormTemplates[t.FeedbackType.Like]);case r.Strings.l_Suggestion:return o(u.ActiveFormTemplates[t.FeedbackType.Idea]);default:return o(f.SimpleFeedbackForm)}}function v(n){switch(n){case r.Strings.l_DontLike:return e(u.ActiveFormTemplates[t.FeedbackType.Dislike]);case r.Strings.l_Like:return e(u.ActiveFormTemplates[t.FeedbackType.Like]);case r.Strings.l_Suggestion:return e(u.ActiveFormTemplates[t.FeedbackType.Idea]);default:return e(f.SimpleFeedbackForm)}}function y(u){return{id:t.IDs.OverlayBackground,classes:[n.Constants.Classes.OverlayMinWidth],children:[{id:t.IDs.MainContainer,children:[{id:t.IDs.MainContentHolder,tag:t.Tags.Form,classes:[t.Classes.Hidden],attributes:[{name:t.AttributeName.Role,value:t.AttributeValue.Dialog},{name:t.AttributeName.AriaLabelledBy,value:t.IDs.FeedbackTitle},{name:t.AttributeName.AriaDescribedBy,value:t.IDs.FeedbackQuestionLeftText}],children:[{id:t.IDs.LeftFormContainer,classes:[t.Classes.FormContainer],children:[{id:t.IDs.FeedbackTitle,classes:[t.Classes.FontTitle,t.Classes.TextAlignLeft,t.Classes.LineHeight],attributes:[{name:t.AttributeName.Role,value:t.AttributeValue.Heading},{name:t.AttributeName.AriaLevel,value:t.AttributeValue.One}],innerText:r.Strings.l_FeedbackTitle},{id:t.IDs.ColumnSeparatorDiv,children:[{id:t.IDs.FeedbackQuestionLeftText,classes:[t.Classes.FontSubtitle,t.Classes.TextAlignLeft,t.Classes.LineHeight],attributes:[{name:t.AttributeName.Role,value:t.AttributeValue.Heading},{name:t.AttributeName.AriaLevel,value:t.AttributeValue.Two}],innerText:r.Strings.l_FeedbackOverall},{id:t.IDs.FeedbackOverallLikeDiv,classes:[t.Classes.FeedbackOverallAnchor,t.Classes.BackgroundGrey],tag:t.Tags.Div,attributes:[{name:t.AttributeName.Value,value:r.Strings.l_Like},{name:t.AttributeName.Role,value:t.AttributeValue.Button},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.AriaHasPopup,value:t.AttributeValue.True},{name:t.AttributeName.AriaPressed,value:t.AttributeValue.False}],children:[{id:t.IDs.FeedbackOverallLikeImage,classes:[t.Classes.FeedbackOverallImage],tag:t.Tags.Img},{id:t.IDs.FeedbackOverallLikeText,classes:[t.Classes.FontText,t.Classes.FeedbackOverallText,t.Classes.LineHeight],innerText:r.Strings.l_Like}]},{id:t.IDs.PlaceHolderDiv1,classes:[t.Classes.FullWidth20pxHeight]},{id:t.IDs.FeedbackOverallDontLikeDiv,classes:[t.Classes.FeedbackOverallAnchor,t.Classes.BackgroundGrey],tag:t.Tags.Div,attributes:[{name:t.AttributeName.Value,value:r.Strings.l_DontLike},{name:t.AttributeName.Role,value:t.AttributeValue.Button},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.AriaHasPopup,value:t.AttributeValue.True},{name:t.AttributeName.AriaPressed,value:t.AttributeValue.False}],children:[{id:t.IDs.FeedbackOverallDontLikeImage,classes:[t.Classes.FeedbackOverallImage],tag:t.Tags.Img},{id:t.IDs.FeedbackOverallDontLikeText,classes:[t.Classes.FontText,t.Classes.FeedbackOverallText,t.Classes.LineHeight],innerText:r.Strings.l_DontLike}]},{id:t.IDs.PlaceHolderDiv2,classes:[t.Classes.FullWidth20pxHeight]},{id:t.IDs.FeedbackOverallSuggestionDiv,classes:[t.Classes.FeedbackOverallAnchor,t.Classes.BackgroundGrey],tag:t.Tags.Div,attributes:[{name:t.AttributeName.Value,value:r.Strings.l_Suggestion},{name:t.AttributeName.Role,value:t.AttributeValue.Button},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.AriaHasPopup,value:t.AttributeValue.True},{name:t.AttributeName.AriaPressed,value:t.AttributeValue.False}],children:[{id:t.IDs.FeedbackOverallSuggestionImage,classes:[t.Classes.FeedbackOverallImage],tag:t.Tags.Img},{id:t.IDs.FeedbackOverallSuggestionText,classes:[t.Classes.FontText,t.Classes.FeedbackOverallText,t.Classes.LineHeight],innerText:r.Strings.l_Suggestion}]}]},{id:t.IDs.PrivacyStatementLinkDiv,classes:[t.Classes.FontText,t.Classes.LineHeight,t.Classes.TextAlignLeft],children:[{id:t.IDs.PrivacyStatementLink,tag:t.Tags.Anchor,innerText:r.Strings.l_PrivacyStatement,attributes:[{name:t.AttributeName.HRef,value:i.GetPrivacyUrl(u)},{name:t.AttributeName.Target,value:t.AttributeValue.BlankWindow},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.Rel,value:t.AttributeValue.NoReferrer}]}]}]},{id:t.IDs.MiddleFormContainer,classes:[t.Classes.FormContainer,t.Classes.Hidden],children:s().children}]}]}]}}function s(){var n=[],i;return n[u.ActiveFormTemplates[t.FeedbackType.Like]]=!0,n[u.ActiveFormTemplates[t.FeedbackType.Dislike]]=!0,n[u.ActiveFormTemplates[t.FeedbackType.Idea]]=!0,i={id:t.IDs.FeedbackFormsWrapper,children:[]},n[f.SimpleFeedbackForm]&&i.children.push(h()),n[f.ContactInfoFeedbackForm]&&i.children.push(c()),n[f.UservoiceLinkFeedbackForm]&&i.children.push(l()),i}function h(){return{id:t.IDs.SimpleFeedbackFormContainer,classes:[t.Classes.Hidden,t.Classes.FeedbackFormContainer],children:[{id:t.IDs.SimpleFeedbackFormQuestionMiddleText,classes:[t.Classes.FeedbackQuestionMiddleText,t.Classes.FontSubtitle,t.Classes.MarginLeft36px,t.Classes.LineHeight,t.Classes.TextAlignLeft],attributes:[{name:t.AttributeName.AriaLive,value:t.AttributeValue.Polite}]},{id:t.IDs.SimpleFeedbackFormComment,classes:[t.Classes.FeedbackFormComment,t.Classes.FontText,t.Classes.MarginLeft36px],tag:t.Tags.TextArea,attributes:[{name:t.AttributeName.Name,value:t.IDs.SimpleFeedbackFormComment},{name:t.AttributeName.Placeholder,value:r.Strings.l_CommentPlaceholder},{name:t.AttributeName.MaxLength,value:t.AttributeValue.TextAreaMaxLength},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]},{id:t.IDs.SimpleFeedbackFormScreenshotContainer,classes:[t.Classes.MarginLeft36px],children:[{id:t.IDs.SimpleFeedbackFormScreenshotCheckboxText,brs:t.Brs.Screenshot,children:[{id:t.IDs.SimpleFeedbackFormScreenshotCheckbox,tag:t.Tags.Input,attributes:[{name:t.AttributeName.Name,value:t.IDs.SimpleFeedbackFormScreenshotCheckbox},{name:t.AttributeName.Type,value:t.AttributeValue.Checkbox},{name:t.AttributeName.Value,value:t.AttributeValue.Unchecked},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]},{id:t.IDs.SimpleFeedbackFormScreenshotText,classes:[t.Classes.FontText,t.Classes.TextAlignLeft,t.Classes.LineHeight],innerText:r.Strings.l_IncludeScreenshot}]}]},{id:t.IDs.SimpleFeedbackFormSubmitButtonContainer,classes:[t.Classes.FeedbackFormSubmitButtonContainer,t.Classes.MarginLeft36px],children:[{id:t.IDs.SimpleFeedbackFormSubmitButton,classes:[t.Classes.FeedbackFormSubmitButton,t.Classes.FontText,t.Classes.LineHeight],tag:t.Tags.Input,attributes:[{name:t.AttributeName.Type,value:t.AttributeValue.Submit},{name:t.AttributeName.Value,value:r.Strings.l_Submit},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]}]}}function c(){return{id:t.IDs.ContactInfoFormContainer,classes:[t.Classes.Hidden,t.Classes.FeedbackFormContainer],children:[{id:t.IDs.ContactInfoFormQuestionMiddleText,classes:[t.Classes.FeedbackQuestionMiddleText,t.Classes.FontSubtitle,t.Classes.MarginLeft36px,t.Classes.LineHeight,t.Classes.TextAlignLeft],attributes:[{name:t.AttributeName.AriaLive,value:t.AttributeValue.Polite},{name:t.AttributeName.Role,value:t.AttributeValue.Heading},{name:t.AttributeName.AriaLevel,value:t.AttributeValue.Three}]},{id:t.IDs.ContactInfoFormComment,classes:[t.Classes.FeedbackFormComment,t.Classes.FontText,t.Classes.MarginLeft36px],tag:t.Tags.TextArea,attributes:[{name:t.AttributeName.Name,value:t.IDs.SimpleFeedbackFormComment},{name:t.AttributeName.Placeholder,value:r.Strings.l_CommentPlaceholder},{name:t.AttributeName.MaxLength,value:t.AttributeValue.TextAreaMaxLength},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.AriaLabelledBy,value:t.IDs.ContactInfoFormQuestionMiddleText}]},{id:t.IDs.ContactInfoFormEmailText,classes:[t.Classes.FontText,t.Classes.MarginLeft36px,t.Classes.LineHeight,t.Classes.TextAlignLeft],innerText:r.Strings.l_EmailRequest,attributes:[{name:t.AttributeName.AriaLive,value:t.AttributeValue.Polite},{name:t.AttributeName.Role,value:t.AttributeValue.Heading},{name:t.AttributeName.AriaLevel,value:t.AttributeValue.Three}]},{id:t.IDs.ContactInfoFormEmailInput,classes:[t.Classes.FeedbackFormComment,t.Classes.FontText,t.Classes.MarginLeft36px],tag:t.Tags.Input,attributes:[{name:t.AttributeName.Type,value:t.AttributeValue.Text},{name:t.AttributeName.Name,value:t.IDs.ContactInfoFormEmailInput},{name:t.AttributeName.MaxLength,value:t.AttributeValue.TextAreaMaxLength},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.AriaLabelledBy,value:t.IDs.ContactInfoFormEmailText}]},{id:t.IDs.ContactInfoFormSubmitButtonContainer,classes:[t.Classes.FeedbackFormSubmitButtonContainer,t.Classes.MarginLeft36px],children:[{id:t.IDs.ContactInfoFormSubmitButton,classes:[t.Classes.FeedbackFormSubmitButton,t.Classes.FontText,t.Classes.LineHeight],tag:t.Tags.Input,attributes:[{name:t.AttributeName.Type,value:t.AttributeValue.Submit},{name:t.AttributeName.Value,value:r.Strings.l_Submit},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One}]}]}]}}function l(){return{id:t.IDs.UservoiceLinkFormContainer,classes:[t.Classes.Hidden,t.Classes.FeedbackFormContainer],children:[{id:t.IDs.UservoiceLinkFormQuestionMiddleText,classes:[t.Classes.FeedbackQuestionMiddleText,t.Classes.FontSubtitle,t.Classes.MarginLeft36px,t.Classes.LineHeight,t.Classes.TextAlignLeft],attributes:[{name:t.AttributeName.AriaLive,value:t.AttributeValue.Polite}]},{id:t.IDs.UservoiceLinkFormMiddleText,classes:[t.Classes.FontText,t.Classes.MarginLeft36px,t.Classes.LineHeight,t.Classes.TextAlignLeft],innerText:r.Strings.l_UservoiceInformation,attributes:[{name:t.AttributeName.AriaLive,value:t.AttributeValue.Polite}]},{id:t.IDs.UservoiceLinkFormAnchorContainer,classes:[t.Classes.LinkDiv,t.Classes.MarginLeft36px,t.Classes.FontText,t.Classes.LineHeight,t.Classes.TextAlignLeft],children:[{id:t.IDs.UservoiceLinkFormAnchor,classes:[t.Classes.Link],tag:t.Tags.Anchor,innerText:r.Strings.l_UservoicePrivacyStatement,attributes:[{name:t.AttributeName.HRef,value:i.GetUservoicePrivacyStatementUrl(!1)},{name:t.AttributeName.Target,value:t.AttributeValue.BlankWindow},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.Rel,value:t.AttributeValue.NoReferrer},{name:t.AttributeName.AriaDescribedBy,value:t.IDs.UservoiceLinkFormQuestionMiddleText+" "+t.IDs.UservoiceLinkFormMiddleText}]}]},{id:t.IDs.UservoiceLinkFormCloseButtonContainer,classes:[t.Classes.FeedbackFormSubmitButtonContainer,t.Classes.MarginLeft36px],children:[{id:t.IDs.UservoiceLinkFormCloseButton,classes:[t.Classes.FeedbackFormSubmitButton,t.Classes.FontText,t.Classes.LineHeight],tag:t.Tags.Input,attributes:[{name:t.AttributeName.Type,value:t.AttributeValue.Submit},{name:t.AttributeName.Value,value:r.Strings.l_UservoiceGoToForum},{name:t.AttributeName.TabIndex,value:t.AttributeValue.One},{name:t.AttributeName.Source,value:i.GetUservoiceUrl(!0)},{name:t.AttributeName.Role,value:"link"}]}]}]}}var f;(function(n){n[n.SimpleFeedbackForm=0]="SimpleFeedbackForm";n[n.ContactInfoFeedbackForm=1]="ContactInfoFeedbackForm";n[n.UservoiceLinkFeedbackForm=2]="UservoiceLinkFeedbackForm"})(f=u.FeedbackFormTemplate||(u.FeedbackFormTemplate={}));u.GetFormContainerIdFromFormTemplate=e;u.GetMiddleTextIdFromFormTemplate=o;u.GetMiddleTextIdFromOptionString=a;u.GetFormContainerIdFromOptionString=v;u.GenerateSchema=y;u.GenerateForms=s;u.GenerateSimpleFeedbackForm=h;u.GenerateContactInfoFeedbackForm=c;u.GenerateUservoiceLinkFeedbackForm=l})(u=r.Layout||(r.Layout={}));r.HtmlElementFromJson=f;r.MainContentHolderSlideLeft=e;r.Init=s;r.Dismiss=h}(r=n.UI||(n.UI={})),function(e){function it(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)}function rt(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)}function h(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}function c(n){n.preventDefault?n.preventDefault():n.returnValue=!1}function o(n,t,i){var r=document.getElementById(n);r&&it(r,t,i)}function s(n,t,i){var r=document.getElementById(n);r&&rt(r,t,i)}function ut(){var n=document.getElementById(t.IDs.OverlayBackground);n&&n.focus();it(window,"keyup",v);o(t.IDs.FeedbackOverallLikeDiv,"click",l);o(t.IDs.FeedbackOverallDontLikeDiv,"click",l);o(t.IDs.FeedbackOverallSuggestionDiv,"click",l);o(t.IDs.FeedbackOverallLikeDiv,"keydown",a);o(t.IDs.FeedbackOverallDontLikeDiv,"keydown",a);o(t.IDs.FeedbackOverallSuggestionDiv,"keydown",a);o(t.IDs.OverlayBackground,"click",y);o(t.IDs.MainContainer,"click",p);o(t.IDs.SimpleFeedbackFormScreenshotCheckbox,"click",b);o(t.IDs.SimpleFeedbackFormSubmitButton,"click",k);o(t.IDs.ContactInfoFormSubmitButton,"click",d);o(t.IDs.UservoiceLinkFormAnchor,"click",nt);o(t.IDs.UservoiceLinkFormCloseButton,"click",g)}function ft(){rt(window,"keyup",v);s(t.IDs.FeedbackOverallLikeDiv,"click",l);s(t.IDs.FeedbackOverallDontLikeDiv,"click",l);s(t.IDs.FeedbackOverallSuggestionDiv,"click",l);s(t.IDs.FeedbackOverallLikeDiv,"keydown",a);s(t.IDs.FeedbackOverallDontLikeDiv,"keydown",a);s(t.IDs.FeedbackOverallSuggestionDiv,"keydown",a);s(t.IDs.OverlayBackground,"click",y);s(t.IDs.MainContainer,"click",p);s(t.IDs.SimpleFeedbackFormScreenshotCheckbox,"click",b);s(t.IDs.SimpleFeedbackFormSubmitButton,"click",k);s(t.IDs.ContactInfoFormSubmitButton,"click",d);s(t.IDs.UservoiceLinkFormAnchor,"click",nt);s(t.IDs.UservoiceLinkFormCloseButton,"click",g)}function v(i){i.keyCode==t.Keys.Esc&&(c(i),h(i),n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,{Keyboard:"Escape key pressed, Office browser feedback UI dismissed"}),f(!1))}function y(t){c(t);h(t);n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,{Mouse:"Mouse click on the background area, Office browser feedback UI dismissed"});f(!1)}function p(n){h(n)}function w(n){var e,f;i.DeleteAndAddClassesById(t.IDs.FeedbackOverallLikeDiv,t.Classes.BackgroundBlue,t.Classes.BackgroundGrey);i.DeleteAndAddClassesById(t.IDs.FeedbackOverallDontLikeDiv,t.Classes.BackgroundBlue,t.Classes.BackgroundGrey);i.DeleteAndAddClassesById(t.IDs.FeedbackOverallSuggestionDiv,t.Classes.BackgroundBlue,t.Classes.BackgroundGrey);i.DeleteAndAddClassesById(n,t.Classes.BackgroundGrey,t.Classes.BackgroundBlue);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallLikeDiv,t.AttributeName.AriaPressed,t.AttributeValue.False);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallDontLikeDiv,t.AttributeName.AriaPressed,t.AttributeValue.False);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallSuggestionDiv,t.AttributeName.AriaPressed,t.AttributeValue.False);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallLikeDiv,t.AttributeName.AriaExpanded,t.AttributeValue.False);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallDontLikeDiv,t.AttributeName.AriaExpanded,t.AttributeValue.False);i.SetAttributeOnHtmlElement(t.IDs.FeedbackOverallSuggestionDiv,t.AttributeName.AriaExpanded,t.AttributeValue.False);i.SetAttributeOnHtmlElement(n,t.AttributeName.AriaPressed,t.AttributeValue.True);i.SetAttributeOnHtmlElement(n,t.AttributeName.AriaExpanded,t.AttributeValue.True);var o=document.getElementById(n),h=r.Layout.GetMiddleTextIdFromOptionString(o.getAttribute(t.AttributeName.Value)),s=document.getElementById(h);if(o&&s){switch(o.getAttribute(t.AttributeName.Value)){case r.Strings.l_DontLike:e=t.FeedbackType.Dislike;s.innerHTML=r.Strings.l_WhatDontLike;break;case r.Strings.l_Suggestion:e=t.FeedbackType.Idea;s.innerHTML=r.Strings.l_WhatSuggest;break;default:e=t.FeedbackType.Like;s.innerHTML=r.Strings.l_WhatLike}u.AddData(t.AttributeValue.FeedbackOverall,e);r.MainContentHolderSlideLeft(r.Layout.GetFormContainerIdFromOptionString(o.getAttribute(t.AttributeName.Value)));f=document.getElementById(t.IDs.SimpleFeedbackFormComment)||document.getElementById(t.IDs.ContactInfoFormComment);f&&f.focus();n===t.IDs.FeedbackOverallSuggestionDiv&&(f=document.getElementById(t.IDs.UservoiceLinkFormAnchor),f&&f.focus())}}function l(n){var t,i;c(n);h(n);t=n.target||n.srcElement;t&&t.parentNode&&(i=t.parentNode,w(i.id))}function a(n){if(n.keyCode==t.Keys.Space||n.keyCode==t.Keys.Enter){c(n);h(n);var i=n.target||n.srcElement;i&&w(i.id)}}function b(n){h(n);var i=document.getElementById(t.IDs.SimpleFeedbackFormScreenshotCheckbox);i&&(i.getAttribute(t.AttributeName.Value)==t.AttributeValue.Checked?i.setAttribute(t.AttributeName.Value,t.AttributeValue.Unchecked):i.setAttribute(t.AttributeName.Value,t.AttributeValue.Checked))}function k(n){c(n);h(n);tt(t.IDs.SimpleFeedbackFormContainer)}function d(n){c(n);h(n);tt(t.IDs.ContactInfoFormContainer)}function g(i){c(i);h(i);n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User clicked link to UserVoice.");window.open(document.getElementById(t.IDs.UservoiceLinkFormCloseButton).getAttribute(t.AttributeName.Source));f(!1)}function nt(t){h(t);n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Info,"User clicked link to UserVoice Privacy Statement.")}function tt(i){var r=document.getElementById(i),s,e,o;if(r||(r=document.getElementById(t.IDs.MainContentHolder)),r){for(s=r.querySelectorAll(t.Tags.Input+", "+t.Tags.TextArea),e=0;e<s.length;e++){o=s[e];switch(o.getAttribute(t.AttributeName.Type)){case t.AttributeValue.Submit:break;default:u.AddData(o.getAttribute(t.AttributeName.Name),o.value)}}u.AddData("PageUrl",window.location.href);u.AddData("BrowserUserAgent",window.navigator.userAgent);n.Networking.NetworkingMgr.LogFeedbackData(u.GetData());f(!0)}else n.Networking.NetworkingMgr.SendTrace(n.Networking.LogLevel.Error,"Specified DOM element or MainContentHolder not found"),f(!1)}e.Init=ut;e.Dismiss=ft;e.FeedbackKeyHandler=v;e.FeedbackOverlayBackgroundHandler=y;e.FeedbackMainContainerHandler=p;e.HandleFeedbackOverall=w;e.FeedbackOverallClickHandler=l;e.FeedbackOverallKeyHandler=a;e.SimpleFeedbackFormScreenshotCheckboxHandler=b;e.SimpleFeedbackFormSubmitButtonHandler=k;e.ContactInfoFormSubmitButtonHandler=d;e.UservoiceLinkFormCloseButtonHandler=g;e.UservoiceLinkFormLinkHandler=nt;e.LogFeedbackDataFromElementById=tt}(e=n.Events||(n.Events={})),function(n){function i(t){if(t!=null)for(var i in t)n.AddData(i,t[i])}function r(n,i){t[n]=i}function u(n){delete t[n]}function f(){return t}var t={};n.Init=i;n.AddData=r;n.RemoveData=u;n.GetData=f}(u=n.FeedbackData||(n.FeedbackData={}));n.InitAll=h;n.DismissAll=f}(OfficeBrowserFeedback||(OfficeBrowserFeedback={}));function GetOSPlatform(){return _osPlatform?_osPlatform:_osPlatform=$("body").hasClass(OSPlatform.IPHONE)?OSPlatform.IPHONE:$("body").hasClass(OSPlatform.IPOD)?OSPlatform.IPOD:$("body").hasClass(OSPlatform.IPAD)?OSPlatform.IPAD:$("body").hasClass(OSPlatform.ANDROID)?OSPlatform.ANDROID:$("body").hasClass(OSPlatform.WINDOWSPHONE10)?OSPlatform.WINDOWSPHONE10:$("body").hasClass(OSPlatform.WINDOWSPHONE8)?OSPlatform.WINDOWSPHONE8:$("body").hasClass(OSPlatform.WINDOWSPHONE7)?OSPlatform.WINDOWSPHONE7:$("body").hasClass(OSPlatform.WINDOWS10)?OSPlatform.WINDOWS10:$("body").hasClass(OSPlatform.WINDOWS8)?OSPlatform.WINDOWS8:$("body").hasClass(OSPlatform.WINDOWS7)?OSPlatform.WINDOWS7:$("body").hasClass(OSPlatform.WINDOWSVISTAANDBELOW)?OSPlatform.WINDOWSVISTAANDBELOW:$("body").hasClass(OSPlatform.MAC)?OSPlatform.MAC:$("body").hasClass(OSPlatform.CHROMEBOOK)?OSPlatform.CHROMEBOOK:OSPlatform.UNSUPPORTED}function InitializeUls(n){var t=!1;return n||(n=400,t=!0),TheUlsHost=new Diag.ConsoleUlsHost(n),Diag.ULS.setUlsHost(TheUlsHost),t&&Diag.ULS.sendTraceTag(6160855,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.error,"Unknown uls category passed to InitializeUls: {0}",ulsCategoryStringSetInCshtml),Diag.ULS.sendTraceTag(6160856,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnLoad"),Diag.ULS.sendTraceTag(6160857,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"UserAgent: {0}",window.navigator.userAgent),Diag.ULS.sendTraceTag(6160858,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"Detected OS Platform: {0}",GetOSPlatform()),typeof PageLoadTime!="undefined"&&RecordPageLoadTime(),!t}function InstrumentLinks(n){for(var t,r=0,i=0;i<n.length;i++)t=n[i],t.id||(t.id="un_"+r,r++),t.onclick=GenerateInstrumentationLink(t.id,t.onclick),t.ondragstart=GenerateDragInstrumentationLink(t.id,t.ondrag),t.oncontextmenu=GenerateContextMenuInstrumentationLink(t.id,t.oncontextmenu)}function LogUserViewPortInfo(){var t=$(window).width(),n=$(window).height(),i=screen.width,r=screen.height,u=$(document).height(),f=n/u*100;Diag.ULS.sendTraceTag(6436628,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User ViewPort Info;windowWidth={0};windowHeight={1};screenWidth={2};screenHeight={3};percentageOfPageVisible={4};",t,n,i,r,f.toFixed(3))}function UpdateFurthestScrollDepth(){var t=$(window).scrollTop(),i=$(window).height(),r=t+i,u=$(document).height(),n=r/u*100;n>furthestScrollDepthPercentage&&(furthestScrollDepthPercentage=n)}function LogElapsedTimeOnPage(){var n=(new Date).getTime(),t=(n-PageStartLoadTime)/1e3;Diag.ULS.sendTraceTag(6436629,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User time on page ;secondsSpentOnPage={0};",t.toFixed(3))}function InsertAdditionalBeforeUnloadFunction(n){additionalBeforeUnloadFunctions.push(n)}function OnUnloadingPage(){for(var n=0;n<additionalBeforeUnloadFunctions.length;n++)typeof additionalBeforeUnloadFunctions[n]=="function"&&additionalBeforeUnloadFunctions[n]();additionalBeforeUnloadFunctions=[];TheUlsHost&&(Diag.ULS.sendTraceTag(6436630,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"The furthest scrollDepth was ;PercentOfPageViewed={0};",furthestScrollDepthPercentage.toFixed(3)),LogElapsedTimeOnPage(),FlushBrowserUls())}function FlushBrowserUls(){var n=TheUlsHost.DefaultCategory();TheUlsHost.dispose();InitializeUls(n)}function FlushUlsAsynchronous(){TheUlsHost&&TheUlsHost.flushAsynchronous()}function GenerateInstrumentationLink(n,t){return function(i){var r="";if(i!=null)switch(i.which){case 1:r="Left";break;case 2:r="Middle";break;case 3:r="Right";break;default:r="Unknown"}return(Diag.ULS.sendTraceTag(6160863,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User clicked on: {0}, ButtonPressed: {1}",n,r),FlushUlsAsynchronous(),t)?t(i):!0}}function GenerateContextMenuInstrumentationLink(n,t){return function(i){return(Diag.ULS.sendTraceTag(6160864,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User right-clicked on: {0}",n),t)?t(i):!0}}function GenerateDragInstrumentationLink(n,t){return function(i){return(Diag.ULS.sendTraceTag(6160865,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User dragged on: {0}",n),t)?t(i):!0}}function SaveOrigRefThenShowSignInControl(){Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue);ShowSignInControl()}var Utils,OSPlatform,_osPlatform,ClipperIndexURL,NotebooksIndexURL,OrigRefCookieName,OrigRefCookieValue,ShowSignInControl,onSignInDialogKeyUp,Common,__extends,TelemetryClickableClass,Diag,TheUlsHost,furthestScrollDepthPercentage,RecordPageLoadTime,PageStartLoadTime,ulsCategoryStringSetInCshtml,additionalBeforeUnloadFunctions,_onBeforePageUnloadCalled,Feedback,HideSignInControl;(function(n){(function(n){n[n.OneNoteSite=400]="OneNoteSite";n[n.OneNoteAugmentationProvider_DomEnhancer=411]="OneNoteAugmentationProvider_DomEnhancer";n[n.OneNoteAugmentationProvider_UrlEnhancer=410]="OneNoteAugmentationProvider_UrlEnhancer";n[n.OneNoteAugmentationService_Entitization=412]="OneNoteAugmentationService_Entitization";n[n.OneNoteAugmentationService_BizcardExtractor=415]="OneNoteAugmentationService_BizcardExtractor";n[n.OneNoteAugmentationService=409]="OneNoteAugmentationService";n[n.OneNoteClipperInstall=402]="OneNoteClipperInstall";n[n.OneNoteClipperTooltip=413]="OneNoteClipperTooltip";n[n.OneNoteClipperUsage=403]="OneNoteClipperUsage";n[n.OneNoteUnitTests=401]="OneNoteUnitTests";n[n.OneNoteSiteEmailSettings=404]="OneNoteSiteEmailSettings";n[n.OneNoteSiteFeedbackPage=408]="OneNoteSiteFeedbackPage";n[n.OneNoteSiteNotebooks=405]="OneNoteSiteNotebooks";n[n.OneNoteSiteDevSite=406]="OneNoteSiteDevSite";n[n.OneNoteSiteFeaturedApps=407]="OneNoteSiteFeaturedApps";n[n.OneNoteSiteStudents=414]="OneNoteSiteStudents";n[n.OneNoteNotebookCreator=416]="OneNoteNotebookCreator";n[n.OneNoteSiteSendToOneNote=417]="OneNoteSiteSendToOneNote";n[n.OneNoteLearningTools_ReaderBrowser=2100]="OneNoteLearningTools_ReaderBrowser"})(n.ULSCat||(n.ULSCat={}));var t=n.ULSCat})(Diag||(Diag={})),function(n){function u(n){n===void 0&&(n=document);var t=n.getElementsByTagName("html")[0].getAttribute("lang");return t?t:window.navigator.userLanguage||window.navigator.language}function t(n,t,i){i===void 0&&(i=null);var r=n+"="+t;i&&(r+=";expires="+i.toUTCString());r+=";secure";document.cookie=r}function f(n){t(n,"",new Date("2000-01-01"))}function e(n){var t=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)");return t?t[2]:null}function o(n){return n.preventDefault(),n.stopPropagation(),!1}function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})}function h(n,t,i){var r=document.createElement("link"),u;r.rel="stylesheet";r.type="text/css";r.href=n;r.className=t;document.head.appendChild(r);i&&(u=new Image,u.onerror=i,u.src=n)}function c(n,t){return n?window.getComputedStyle?window.getComputedStyle(n).getPropertyValue(t):n.currentStyle[t]:""}function l(n,t,i){var u=[t],r;for(t[0]==="-"&&(u=["-ms"+t,"-moz"+t,"-webkit"+t,"-o"+t,t.substr(1)]),r=0;r<u.length;r++)n.style.setProperty?n.style.setProperty(u[r],i):n.style.setAttribute(u[r],i)}function a(n,t,i){var r=n;return r+=-1===r.indexOf("?")?"?":"&",r+(t+"="+i)}function i(n,t,i){var r=new XMLHttpRequest;r.open("GET","https://"+n+"/count/"+t+"?"+i);r.send()}function v(n,t,i){i===void 0&&(i="");var u=r(n,t);return u[t]==null||u[t]===""?i:u[t]}function r(n,t){try{var r=new XMLHttpRequest;return r.open("GET","https://"+n+"/Strings?ids="+t,!1),r.send(),JSON.parse(r.responseText)}catch(u){return i(n,"StringsUtil","error="+u),{}}}function y(n){var t=!1;try{typeof Storage!="undefined"&&(t=localStorage.getItem("EnableConsoleLogging")==="true")}catch(i){}t&&console.log(n)}n.GetLocale=u;n.SetCookie=t;n.ExpireCookie=f;n.GetCookie=e;n.DisableClick=o;n.GenerateGuid=s;n.LoadCSS=h;n.GetCssAttribute=c;n.SetCssAttribute=l;n.AddUrlQueryValue=a;n.SendDataToCountEndpoint=i;n.GetLocalizedStringFromServer=v;n.GetLocalizedStringsFromServer=r;n.LogToConsole=y}(Utils||(Utils={}));OSPlatform={IPHONE:"iPhone",IPOD:"iPod",IPAD:"iPad",ANDROID:"Android",WINDOWSPHONE10:"WP10",WINDOWSPHONE8:"WP8",WINDOWSPHONE7:"WP7",WINDOWS10:"Win10",WINDOWS8:"Win8",WINDOWS7:"Win7",WINDOWSVISTAANDBELOW:"WinVistaAndBelow",MAC:"Mac",CHROMEBOOK:"Chromebook",UNSUPPORTED:"unsupported"};_osPlatform=undefined;$(window).on("load",function(){$("a.ChromeDownload").on("click",function(n){var t=$(n.currentTarget),i=t.attr("href");Common.RedirectToChromeStore(i)});document.getElementById("h_sign")&&Common.EnableOrigRefCookieSetOnAuth()});(function(n){function i(n){Utils.DisableClick(event);Diag.ULS.sendTraceTag(7894217,400,Diag.ULSTraceLevel.info,"Installing Chrome App "+n);window.location.href=n}function t(n){n.which===27&&(Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue,new Date("1970-01-01")),onSignInDialogKeyUp(n),$(document).off("keyup",t))}function r(){var n=$("#h_overlay")[0].onclick;$("#h_overlay")[0].onclick=function(){Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue,new Date("1970-01-01"));n(null);$(document).off("keyup",t)};$(document).off("keyup",onSignInDialogKeyUp);$(document).off("keyup",t).keyup(t)}function u(){$("#h_sign")[0].onclick=null;$("#h_sign").click(function(n){$("#h_overlay").is(":visible")?(Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue,new Date("1970-01-01")),ShowSignInControl()):(Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue),ShowSignInControl(),r());GenerateInstrumentationLink("h_sign",null)(n)})}function f(n,t,i){return n+(n.split("?")[1]?"&":"?")+t+"="+i}n.RedirectToChromeStore=i;n.EnableOrigRefCookieSetOnAuth=u;n.AddParameterToURL=f})(Common||(Common={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};TelemetryClickableClass=".onclickable",function(n){var t=function(){function n(){}return n.prototype.isEnabled=function(){var n=!1;try{typeof Storage!="undefined"&&(n=localStorage.getItem("EnableConsoleLogging")==="true")}catch(t){}return n&&window.console&&window.console.log},n.prototype.error=function(n){window.console.error(n)},n.prototype.warning=function(n){window.console.warn(n)},n.prototype.info=function(n){window.console.info(n)},n.prototype.log=function(n){window.console.log(n)},n}(),i=function(i){function r(r,u,f){u===void 0&&(u=new t);i.call(this,SessionId,"/"+n.UploadingUlsHost.defaultRemoteUlsUrl);this._defaultCategory=r;this._console=u;this._suppressBubbling=f}return __extends(r,i),r.prototype.DefaultCategory=function(){return this._defaultCategory},r.prototype.handleTrace=function(t){if(this._console.isEnabled()){var r="("+t.timestamp+"):\t"+t.message;switch(t.level){case n.ULSTraceLevel.error:this._console.error(r);break;case n.ULSTraceLevel.warning:this._console.warning(r);break;case n.ULSTraceLevel.info:this._console.info(r);break;default:this._console.log(r)}}this._suppressBubbling||i.prototype.handleTrace.call(this,t)},r}(n.UploadingUlsHost);n.ConsoleUlsHost=i}(Diag||(Diag={}));furthestScrollDepthPercentage=0;RecordPageLoadTime=function(){Diag.ULS.sendTraceTag(8206356,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"PageLoadTime: {0}",PageLoadTime)};$(window).on("load",function(){InitializeUls(Diag.ULSCat[ulsCategoryStringSetInCshtml]);InstrumentLinks(document.links);InstrumentLinks(document.querySelectorAll(TelemetryClickableClass));LogUserViewPortInfo();UpdateFurthestScrollDepth();PageStartLoadTime=(new Date).getTime()});additionalBeforeUnloadFunctions=[];$(window).on("beforeunload",function(){TheUlsHost&&Diag.ULS.sendTraceTag(6160859,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnBeforeUnload");OnUnloadingPage();_onBeforePageUnloadCalled=!0});$(window).on("unload",function(){TheUlsHost&&Diag.ULS.sendTraceTag(6160860,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnUnload");_onBeforePageUnloadCalled||OnUnloadingPage();_onBeforePageUnloadCalled=!1});$(window).on("pageshow",function(){TheUlsHost&&Diag.ULS.sendTraceTag(6160861,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnPageShow")});$(window).on("pagehide",function(){TheUlsHost&&(Diag.ULS.sendTraceTag(6160862,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnPageHide"),_onBeforePageUnloadCalled||FlushBrowserUls())});$(window).on("scroll",function(){UpdateFurthestScrollDepth()});(function(n){function f(u,f){var o,s,e;t=document.activeElement;o=400;u&&(o=Diag.ULSCat[u]);s=new n.LocalizedStrings;OfficeBrowserFeedback.InitAll(r.Urls.ImageRoot,s,n.OnDismiss,o,o,f);e=$("#officeBrowserFeedbackMainContainer");e.attr("role","dialog");e.attr("aria-labelledby","officeBrowserFeedbackTitle");e.attr("tabindex",-1);e.focus();i||(document.addEventListener("focus",function(n){var t=document.getElementById("officeBrowserFeedbackMainContainer");t&&!t.contains(n.target)&&(n.stopPropagation(),t.focus())},!0),i=!0)}function e(){t.focus()}var r,u,t,i;(function(n){var t,i;(function(){})(t=n.Urls||(n.Urls={})),function(){}(i=n.Strings||(n.Strings={}))})(r=n.Constants||(n.Constants={}));u=function(){function t(){this.l_Close=n.Constants.Strings.Close;this.l_CommentPlaceholder=n.Constants.Strings.CommentPlaceholder;this.l_DontLike=n.Constants.Strings.DontLike;this.l_DocumentPermission=n.Constants.Strings.DocumentPermission;this.l_EmailRequest=n.Constants.Strings.EmailRequest;this.l_FeedbackOverall=n.Constants.Strings.FeedbackOverall;this.l_FeedbackTitle=n.Constants.Strings.FeedbackTitle;this.l_IncludeScreenshot=n.Constants.Strings.IncludeScreenshot;this.l_Like=n.Constants.Strings.Like;this.l_Optional=n.Constants.Strings.Optional;this.l_PrivacyStatement=n.Constants.Strings.PrivacyStatement;this.l_Submit=n.Constants.Strings.Submit;this.l_Suggestion=n.Constants.Strings.Suggestion;this.l_UservoiceGoToForum=n.Constants.Strings.UservoiceGoToForum;this.l_UservoiceInformation=n.Constants.Strings.UservoiceInformation;this.l_UservoicePrivacyStatement=n.Constants.Strings.UservoicePrivacyStatement;this.l_WhatLike=n.Constants.Strings.WhatLike;this.l_WhatDontLike=n.Constants.Strings.WhatDontLike;this.l_WhatSuggest=n.Constants.Strings.WhatSuggest}return t}();n.LocalizedStrings=u;t=null;i=!1;n.ShowTool=f;n.OnDismiss=e})(Feedback||(Feedback={}));$(window).on("load",SaveOrigRefThenShowSignInControl);HideSignInControl=function(){return};