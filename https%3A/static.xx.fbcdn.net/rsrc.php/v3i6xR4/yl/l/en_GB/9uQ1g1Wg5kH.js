if (self.CavalryLogger) { CavalryLogger.start_js(["KMWU4"]); }

__d("TextDelightInComposerGating",["TextDelightConfig","TextDelightSurface","gkx"],(function(a,b,c,d,e,f){"use strict";var g=b("TextDelightConfig").composerOptions;a={checkGKForSurface:function(a){return a===b("TextDelightSurface").POST?b("gkx")("678313"):b("gkx")("678314")},isEnabled:function(a){return this.checkGKForSurface(a)&&g.enabled},isHighlightEnabled:function(a){return this.checkGKForSurface(a)&&g.enabled&&g.highlightEnabled},isBackspaceEnabled:function(a){return this.checkGKForSurface(a)&&g.enabled&&g.backspaceEnabled},isXbuttonEnabled:function(a){return this.checkGKForSurface(a)&&g.enabled&&g.xbuttonEnabled}};e.exports=a}),null);
__d("TextDelightInComposerLogger",["FunnelLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="TEXT_DELIGHTS_COMPOSER_FUNNEL",h="regex_matched",i="opt_out_tapped",j="opt_out_backspace",k="range_tapped";function l(a){var b=0;for(var c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return b}a={startFunnelInstance:function(a,c){a=l(a);if(b("FunnelLogger").getFunnelInstance(g,a))return;b("FunnelLogger").startFunnel(g,a);b("FunnelLogger").addFunnelTag(g,a,c)},_appendAction:function(a,c,d,e,f){this.startFunnelInstance(a,f),b("FunnelLogger").appendActionWithPayload(g,l(a),c,{campaign_id:d,keyword:e})},regexMatched:function(a,b,c,d){this._appendAction(a,h,b,c,d)},optOutTapped:function(a,b,c,d){this._appendAction(a,i,b,c,d)},optOutBackspace:function(a,b,c,d){this._appendAction(a,j,b,c,d)},rangeTapped:function(a,b,c,d){this._appendAction(a,k,b,c,d)},endFunnel:function(a){b("FunnelLogger").endFunnel(g,l(a))}};e.exports=a}),null);
__d("FileHasher",["WebWorker","emptyFunction","fileSliceName","FileHashWorkerResource"],(function(a,b,c,d,e,f){__p&&__p();a.isSupported=function(){"use strict";return b("WebWorker").isSupported()};function a(){"use strict";var a=b("FileHashWorkerResource");b("WebWorker").prepareResource(a);this.$1=new(b("WebWorker"))(a).setMessageHandler(function(a){this.$2(a)}.bind(this)).execute()}a.prototype.hash=function(a,c){"use strict";this.$2=c;this.$1.postMessage({file:a,fileSliceName:b("fileSliceName")});return this};a.prototype.destroy=function(){"use strict";this.$2=b("emptyFunction"),this.$1.terminate()};e.exports=a}),null);
__d("ErrorDialog",["Dialog","emptyFunction"],(function(a,b,c,d,e,f){var g={showAsyncError:function(a){try{return g.show(a.getErrorSummary(),a.getErrorDescription())}catch(b){alert(a)}},show:function(a,c,d,e){return new(b("Dialog"))().setTitle(a).setBody(c).setButtons([b("Dialog").OK]).setStackable(!0).setModal(!0).setHandler(d||b("emptyFunction")).setButtonsMessage(e||"").show()}};e.exports=g}),null);
__d("PagesComposerActionsTypes",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({BACKDATE:null,SET_DRAFT:null,SCHEDULE:null,SET_ADS_POST:null,SET_BOOSTED_POST:null,SHOW_OFFER_UPSELL:null,ABANDON_OFFER_UPSELL:null,INSTAGRAM_CROSS_POSTING:null,SET_IS_REVIEWABLE_BRANDED_CONTENT:null,CLEAR_COMPOSER_DATA:null,PUBLISH_NOW:null,DID_SHOW_POST_CONFIRMATION:null,SET_CURRENT_LOCALE:null,SET_INTERCEPTION_CONFIG:null,SET_COMPOSER_TYPE:null,SET_PAGES_COMPOSER_CONFIG:null,SET_PAGES_COMPOSER_CONTEXT_CONFIG:null,SET_IS_ON_STORY_ENTRY_FOCUS:null});e.exports=a}),null);
__d("PagesComposerBoostedPostsStore",["PagesComposerActionsTypes","ReactComposerStoreBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h={boostedPostConfig:null};c=babelHelpers.inherits(a,b("ReactComposerStoreBase"));g=c&&c.prototype;function a(){__p&&__p();var a;g.constructor.call(this,function(){return Object.assign({},h)},function(c){switch(c.type){case b("PagesComposerActionsTypes").SET_BOOSTED_POST:if(a){var d=a.getComposerData(c.composerID);d.boostedPostConfig=c.data;a.emitChange(c.composerID)}break}});a=this}a.prototype.getConfig=function(a){return this.getComposerData(a).boostedPostConfig};a.prototype.isBoostedPostSet=function(a){return this.getComposerData(a).boostedPostConfig!==null};e.exports=new a()}),null);
__d("PagesComposerActions",["PagesComposerActionsTypes","ReactComposerDispatcher","PagesComposerBoostedPostsStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("PagesComposerBoostedPostsStore");a={setDraft:function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").SET_DRAFT})},didShowPostConfirmation:function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").DID_SHOW_POST_CONFIRMATION})},schedule:function(a,c,d){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").SCHEDULE,scheduleDate:c,stopFeedDistributionDate:d})},backdate:function(a,c,d,e,f){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").BACKDATE,year:c,month:d,day:e,hideFromNewsFeed:f})},setAdsPost:function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").SET_ADS_POST})},setBoostedPost:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").SET_BOOSTED_POST,data:c})},showOfferUpsell:function(a,c){a&&b("ReactComposerDispatcher").dispatch({composerID:a,config:c,type:b("PagesComposerActionsTypes").SHOW_OFFER_UPSELL})},abandonOfferUpsell:function(a){a&&b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").ABANDON_OFFER_UPSELL})},setCurrentLocale:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,currentLocale:c,type:b("PagesComposerActionsTypes").SET_CURRENT_LOCALE})},setInterceptionConfig:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,interceptionConfig:c,type:b("PagesComposerActionsTypes").SET_INTERCEPTION_CONFIG})},setComposerType:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,composerType:c,type:b("PagesComposerActionsTypes").SET_COMPOSER_TYPE})},setPagesComposerConfig:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,pagesComposerConfig:c,type:b("PagesComposerActionsTypes").SET_PAGES_COMPOSER_CONFIG})},setPagesComposerContextConfig:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,pagesComposerContextConfig:c,type:b("PagesComposerActionsTypes").SET_PAGES_COMPOSER_CONTEXT_CONFIG})},setInstagramCrossPosting:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,enabled:c,type:b("PagesComposerActionsTypes").INSTAGRAM_CROSS_POSTING})},setIsReviewableBrandedContent:function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").SET_IS_REVIEWABLE_BRANDED_CONTENT})},clearComposerData:function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").CLEAR_COMPOSER_DATA})},setPublishNow:function(a){b("ReactComposerDispatcher").dispatch({composerID:a,type:b("PagesComposerActionsTypes").PUBLISH_NOW})},setIsOnStoryEntryFocus:function(a,c){b("ReactComposerDispatcher").dispatch({composerID:a,isOnStoryEntryFocus:c,type:b("PagesComposerActionsTypes").SET_IS_ON_STORY_ENTRY_FOCUS})}};e.exports=a}),null);
__d("ResumableUploadServiceState.enum",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({CANCEL:"upload-cancel",FAIL:"upload-fail",FILE_TOO_LARGE:"upload-too-large",NOT_STARTED:"upload-not-started",PROGRESS:"upload-progress",START:"upload-start",SUCCESS:"upload-success",TRANSPORT_FAILURE:"upload-transport-fail"});e.exports=a}),null);
__d("ResumableUploadAsyncService",["regeneratorRuntime","Promise","AsyncRequest","EventEmitter","ResumableUploadServiceState.enum","URI","uuid"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h="rupload.facebook.com";c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(a,c,d,e,f,h,i,j){g.constructor.call(this),this.consumer=a,this.accessToken=c,this.sessionKey=d||b("uuid")(),this.contentKey=e||"",this.contentValue=f||"",this.serviceNameOverride=h||"",this.receiveParameters=i,this.flowCaptureHeaderValue=j}a.prototype.resume=function(a){__p&&__p();var c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:e.prev=0;e.next=3;return b("regeneratorRuntime").awrap(this.sendOffsetRequest(a));case 3:c=e.sent;this.emit(b("ResumableUploadServiceState.enum").START,{offset:c.offset});e.next=7;return b("regeneratorRuntime").awrap(this.sendUploadRequest(a,c));case 7:d=e.sent;this.emit(b("ResumableUploadServiceState.enum").SUCCESS,d.h);e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),this.emit(b("ResumableUploadServiceState.enum").FAIL,e.t0);case 14:this.abortUpload=void 0;case 15:case"end":return e.stop()}},null,this,[[0,11]])};a.prototype.cancel=function(){this.abortUpload&&this.abortUpload(),this.emit(b("ResumableUploadServiceState.enum").CANCEL)};a.prototype.decorateRequestFlowCaptureHeader=function(a){this.flowCaptureHeaderValue&&a.setRequestHeader("X-Fb-Flow-Capture",String(this.flowCaptureHeaderValue))};a.prototype.sendOffsetRequest=function(a){return new(b("Promise"))(function(a,c){var d=new(b("AsyncRequest"))().disableInteractionServerTracing().setAllowCrossOrigin(!0).setAllowCredentials(!0).setMethod("GET").setURI(this.getUploadUri()).setReadOnly(!0).setRequestHeader("Authorization","OAuth "+this.accessToken).setHandler(function(b){return a(JSON.parse(b.payload.response))}).setErrorHandler(c).setOption("suppressEvaluation",!0).setTransportErrorHandler(function(a){this.emit(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,a)}.bind(this));this.decorateRequestFlowCaptureHeader(d);this.abortUpload=function(){return d.abort()};d.send()}.bind(this))};a.prototype.sendUploadRequest=function(a,c){__p&&__p();c=c||{};var d=c.offset;c=c.duplicate;var e=c?"":a.slice(d);return new(b("Promise"))(function(c,f){__p&&__p();var g=new(b("AsyncRequest"))().disableInteractionServerTracing().setAllowCrossOrigin(!0).setAllowCredentials(!0).setURI(this.getUploadUri()).setRawData(e).setHandler(function(a){return c(JSON.parse(a.payload.response))}).setErrorHandler(f).setRequestHeader("Authorization","OAuth "+this.accessToken).setRequestHeader("X-Entity-Name",encodeURIComponent(a.name)).setRequestHeader("X-Entity-Type",a.type).setRequestHeader("X-Entity-Length",String(a.size)).setRequestHeader("Offset",String(d)).setOption("suppressEvaluation",!0).setUploadProgressHandler(function(c){c=new ProgressEvent("upload-service",{total:a.size,loaded:c.loaded+Number(d)});this.emit(b("ResumableUploadServiceState.enum").PROGRESS,c)}.bind(this)).setTransportErrorHandler(function(a){this.emit(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,a)}.bind(this));this.decorateRequestFlowCaptureHeader(g);this.abortUpload=function(){return g.abort()};f=this.receiveParameters;f&&(g.setRequestHeader("start_offset",String(f.start_offset)).setRequestHeader("end_offset",String(f.end_offset)).setRequestHeader("composer_session_id",String(f.composer_session_id)).setRequestHeader("id",String(f.upload_session_id)),f.fb_region&&g.setRequestHeader("X-FB-Region",String(f.fb_region)));g.send()}.bind(this))};a.prototype.getUploadUri=function(){var a=this.serviceNameOverride!=""?this.serviceNameOverride:h;a=new(b("URI"))("https://"+a+"/"+this.consumer+"/"+this.sessionKey);this.contentKey&&this.contentValue&&(a=a.addQueryData(this.contentKey,this.contentValue));return a};e.exports=a}),null);
__d("ResumableUploadService",["Promise","AsyncRequest","EventEmitter","ResumableUploadServiceState.enum","URI","uuid"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h="rupload.facebook.com";c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(a,c,d,e,f,h,i,j){g.constructor.call(this),this.consumer=a,this.accessToken=c,this.sessionKey=d||b("uuid")(),this.contentKey=e||"",this.contentValue=f||"",this.serviceNameOverride=h||"",this.receiveParameters=i,this.flowCaptureHeaderValue=j}a.prototype.resume=function(a){__p&&__p();var c=this.serviceNameOverride!=""?this.serviceNameOverride:h,d=new(b("URI"))("https://"+c+"/"+this.consumer+"/"+this.sessionKey);this.contentKey&&this.contentValue&&(d=d.addQueryData(this.contentKey,this.contentValue));c=function(){return new(b("Promise"))(function(a,c){a=new(b("AsyncRequest"))().disableInteractionServerTracing().setAllowCrossOrigin(!0).setAllowCredentials(!0).setMethod("GET").setURI(d).setReadOnly(!0).setHandler(a).setErrorHandler(c).setOption("suppressEvaluation",!0).setTransportErrorHandler(function(a){this.emit(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,a)}.bind(this));this.decorateRequestFlowCaptureHeader(a);a.send()}.bind(this))}.bind(this);var e=function(c){__p&&__p();return new(b("Promise"))(function(e,f){__p&&__p();var g=JSON.parse(c.payload.response),h=g.offset;this.emit(b("ResumableUploadServiceState.enum").START,{offset:h});this.uploadAsyncRequest=new(b("AsyncRequest"))().disableInteractionServerTracing().setAllowCrossOrigin(!0).setAllowCredentials(!0).setURI(d).setRawData(a.slice(h)).setHandler(e).setErrorHandler(f).setRequestHeader("X-Entity-Name",encodeURIComponent(a.name)).setRequestHeader("X-Entity-Type",a.type).setRequestHeader("X-Entity-Length",String(a.size)).setRequestHeader("Offset",String(h)).setOption("suppressEvaluation",!0).setUploadProgressHandler(function(c){c=new ProgressEvent("upload-service",{total:a.size,loaded:c.loaded+Number(h)});this.emit(b("ResumableUploadServiceState.enum").PROGRESS,c)}.bind(this)).setTransportErrorHandler(function(a){this.emit(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,a)}.bind(this));this.decorateRequestFlowCaptureHeader(this.uploadAsyncRequest);if(this.receiveParameters){g=this.receiveParameters;this.uploadAsyncRequest.setRequestHeader("start_offset",String(g.start_offset));this.uploadAsyncRequest.setRequestHeader("end_offset",String(g.end_offset));this.uploadAsyncRequest.setRequestHeader("composer_session_id",String(g.composer_session_id));this.uploadAsyncRequest.setRequestHeader("id",String(g.upload_session_id));g.fb_region&&this.uploadAsyncRequest.setRequestHeader("X-FB-Region",String(g.fb_region))}this.uploadAsyncRequest.send()}.bind(this))}.bind(this),f=function(a){if(a!=null){a=JSON.parse(a.payload.response);this.emit(b("ResumableUploadServiceState.enum").SUCCESS,a.h)}else this.emit(b("ResumableUploadServiceState.enum").FAIL,"uploading failed")}.bind(this),g=function(a){return this.emit(b("ResumableUploadServiceState.enum").FAIL,a)}.bind(this);return c().then(e,g).then(f,g)};a.prototype.cancel=function(){this.uploadAsyncRequest&&this.uploadAsyncRequest.abort(),this.emit(b("ResumableUploadServiceState.enum").CANCEL)};a.prototype.decorateRequestFlowCaptureHeader=function(a){this.flowCaptureHeaderValue&&a.setRequestHeader("X-Fb-Flow-Capture",String(this.flowCaptureHeaderValue))};e.exports=a}),null);
__d("VideoUploadLogger",["Banzai"],(function(a,b,c,d,e,f){__p&&__p();function g(a){this._source=a.source,this._composerDialogVersion=a.composer_dialog_version,this._waterfallID=a.waterfall_id,this._targetID=a.target_id,this._delay=a.delay,this._times=[],this._isChunkedUpload=a.is_chunked_upload,this._actorID=a.actor_id,this._composerEntryPointRef=a.composer_entry_point_ref,this._isRemoteUpload=a.is_remote_upload,this._containerType=a.container_type,this._hasFileBeenReplaced=a.has_file_been_replaced}a={BANZAI_GK:"videos",BANZAI_ROUTE:"video_waterfall",SOURCE_SIMPLE:"simple",SOURCE_COMPOSER:"composer",EVENT_STARTED_GENERATE_THUMBNAILS:"upload.client.started_generate_thumbnails",EVENT_FINISHED_GENERATE_THUMBNAILS:"upload.client.finished_generate_thumbnails",EVENT_SELECTED_CUSTOM_THUMBNAIL:"upload.client.selected_custom_thumbnail",EVENT_VIDEO_DIMENSIONS_UNREADABLE:"upload.client.video_dimensions_unreadable",EVENT_REPLACE_VIDEO:"upload.client.replace_video",EVENT_STARTED_FLOW:"upload.client.started_flow",EVENT_FINISHED_FLOW:"upload.client.finished_flow",EVENT_FAILED_FLOW:"upload.client.failed_flow",EVENT_CANCELED_FLOW:"upload.client.canceled_flow",EVENT_RESIGNED_FLOW:"upload.client.resigned_flow",EVENT_REQUESTED_UPLOADING:"upload.client.requested_uploading",EVENT_INVALIDATED_UPLOADING:"upload.client.invalidated_uploading",EVENT_STARTED_UPLOADING:"upload.client.started_uploading",EVENT_PROGRESS_UPLOADING_START_REQUEST:"upload.client.progress_uploading_start_request",EVENT_FINISHED_UPLOADING:"upload.client.finished_uploading",EVENT_CANCELED_UPLOADING:"upload.client.canceled_uploading",EVENT_ABANDONED_UPLOADING:"upload.client.abandoned_uploading",EVENT_FAILED_UPLOADING:"upload.client.failed_uploading",EVENT_STARTED_SENDING_BYTES:"upload.client.started_sending_bytes",EVENT_FINISHED_SENDING_BYTES:"upload.client.finished_sending_bytes",EVENT_CANCELED_SENDING_BYTES:"upload.client.canceled_sending_bytes",EVENT_FAILED_SENDING_BYTES:"upload.client.failed_sending_bytes",EVENT_STARTED_START_REQUEST:"upload.client.started_sending_start_request",EVENT_FINISHED_START_REQUEST:"upload.client.finished_sending_start_request",EVENT_FAILED_START_REQUEST:"upload.client.failed_sending_start_request",EVENT_STARTED_POST_REQUEST:"upload.client.started_sending_post_request",EVENT_FINISHED_POST_REQUEST:"upload.client.finished_sending_post_request",EVENT_FAILED_POST_REQUEST:"upload.client.failed_sending_post_request",EVENT_HANDLING_SERVER_FAILURE_RESPONSE:"upload.client.handling_server_failure_response",EVENT_HANDLING_TRANSPORT_FAILURE_RESPONSE:"upload.client.handling_transport_failure_response",EVENT_DUPLICATE_POST_REQUEST:"upload.client.duplicate_post_request",EVENT_STARTED_SENDING_CHUNK_BYTES:"upload.client.started_sending_chunk_bytes",EVENT_FINISHED_SENDING_CHUNK_BYTES:"upload.client.finished_sending_chunk_bytes",EVENT_CANCELED_SENDING_CHUNK_BYTES:"upload.client.canceled_sending_chunk_bytes",EVENT_FAILED_SENDING_CHUNK_BYTES:"upload.client.failed_sending_chunk_bytes",EVENT_TIMEOUT_SENDING_CHUNK_BYTES:"upload.client.timeout_sending_chunk_bytes",EVENT_RESUMABLE_CALLED:"upload.client.resumable_called",EVENT_RESUMABLE_STARTED:"upload.client.resumable_started",EVENT_RESUMABLE_SUCCESS:"upload.client.resumable_success",EVENT_RESUMABLE_FAILED:"upload.client.resumable_failed",EVENT_ENCODING_START_OBSERVED:"encode.client.encoding_start_observed",EVENT_ENCODING_SUCCESS_OBSERVED:"encode.client.encoding_success_observed",EVENT_ENCODING_FAIL_OBSERVED:"encode.client.encoding_fail_observed",EVENT_RECEIVED_RESPONSE:"upload.client.received_response",EVENT_STARTED_FLOW_EXP1:"upload.client.started_flow_exp1",EVENT_FINISHED_FLOW_EXP1:"upload.client.finished_flow_exp1",EVENT_CANCELED_FLOW_EXP1:"upload.client.canceled_flow_exp1",EVENT_MEASURE_FREE_LOCAL_STORAGE:"upload.client.free_local_storage"};Object.assign(g,a);Object.assign(g.prototype,{logEvent:function(a,c){__p&&__p();c=babelHelpers["extends"]({},c);c.elapsed_time==null&&(a.indexOf("started")!==-1?this._times[a]=Date.now():a.indexOf("finished")!==-1?c.elapsed_time=this._computeElapsedTime(a,"finished"):a.indexOf("canceled")!==-1?c.elapsed_time=this._computeElapsedTime(a,"canceled"):a.indexOf("failed")!==-1&&(c.elapsed_time=this._computeElapsedTime(a,"failed")));c.event=a;c.source=this._source;c.composer_dialog_version=c.composer_dialog_version||this._composerDialogVersion;c.waterfall_id=this._waterfallID;c.target_id=this._targetID;c.is_chunked_upload=this._isChunkedUpload;c.actor_id=this._actorID;c.composer_entry_point_ref=this._composerEntryPointRef;c.is_remote_upload=this._isRemoteUpload;c.container_type=this._containerType;c.has_file_been_replaced=this._hasFileBeenReplaced;b("Banzai").post(g.BANZAI_ROUTE,c,{delay:this._delay,retry:!0})},getWaterfallID:function(){return this._waterfallID},_computeElapsedTime:function(a,b){a=a.replace(b,"started");b=this._times[a];return b?Date.now()-b:null}});e.exports=g}),null);
__d("VideoUploadCrashMonitor",["Bandicoot","VideoUploadLogger"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("Bandicoot"));g=c&&c.prototype;function a(a,b,c,d,e,f,h,i){"use strict";g.constructor.call(this,"VideoUploadSession"),this.$VideoUploadCrashMonitor1={waterfallID:a,actorID:b,source:c,targetID:d,loggingDelay:e,supportsChunking:f,composerEntryPointRef:h,flowStarted:i}}a.prototype.flowStarted=function(){"use strict";this.$VideoUploadCrashMonitor1.flowStarted=!0};a.prototype.getCrashTimeData=function(){"use strict";return this.$VideoUploadCrashMonitor1};a.prototype.logCrash=function(a,c,d){"use strict";if(!c.waterfallID)return;a=new(b("VideoUploadLogger"))({actor_id:c.actorID,source:c.source,waterfall_id:c.waterfallID,target_id:c.targetID,delay:c.loggingDelay,is_chunked_upload:c.supportsChunking,composer_entry_point_ref:c.composerEntryPointRef});d={error:"Crash Detected",error_description:"Detected video upload did not complete due to a crash"};a.logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,d);c.flowStarted&&a.logEvent(b("VideoUploadLogger").EVENT_RESIGNED_FLOW,{})};e.exports=a}),null);
__d("VideoUploadFileValidator",["errorCode","fbt","ErrorDialog","ImageExtensions","Link.react","React"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=[1363019,1363020,1363021,1363022,1363023,1363024,1363025,1363026,1363027,1363030,1363031,1363032,1363033,1363038,1363039,1363040,1363048],j=["VIDEO__INVALID_GUIDE_DATA"];function a(a){"use strict";this.$1=a}a.prototype.validate=function(a,c){"use strict";return this.$2(a)&&this.$3(a)&&this.$4(a.getExtension()===b("ImageExtensions").GIF,c)};a.prototype.getValidationErrorMessage=function(a,c){"use strict";return this.$5(a)||this.$6(a)||this.$7(a.getExtension()===b("ImageExtensions").GIF,c)};a.canReplaceVideoForError=function(a){"use strict";if(!a)return!0;if(j.indexOf(a)>-1)return!1;return i.indexOf(a)>-1?!0:!1};a.prototype.$2=function(a){"use strict";a=this.$5(a);if(a){b("ErrorDialog").show(a.summary,a.description);return!1}else return!0};a.prototype.$5=function(a){"use strict";if(this.$1.extensions[a.getExtension()])return;a="http://www.facebook.com/help/?faq=218673814818907#What-formats-of-video-files-can-I-upload?";a=b("React").createElement(b("Link.react"),{target:"_blank",href:a},h._("recommended formats"));return{summary:h._("Unsupported File Format"),description:h._("Sorry, the file you selected is in a format that we don't support. Please use one of our {link} for video files.",[h._param("link",a)])}};a.prototype.$3=function(a){"use strict";a=this.$6(a);if(a){b("ErrorDialog").show(a.summary,a.description);return!1}else return!0};a.prototype.$6=function(a){"use strict";var b;if(a.getSize()===null)return;a.getSize()<this.$1.minSize&&(b=this.$8());a.getSize()>this.$1.maxSize&&(b=this.$9());return b};a.prototype.$8=function(){"use strict";var a=Math.round(this.$1.minSize/1024);return{summary:h._("Video File Too Small"),description:h._("The video file you tried to upload is too small. The minimum size for a video file is {min-size} KB. Please try again with a larger file.",[h._param("min-size",a)])}};a.prototype.$9=function(){"use strict";var a=Math.floor(this.$1.maxSize/1024/1024);return{summary:h._("Video File Too Large"),description:h._("The video file you tried to upload is too large. The maximum size for a video file is {max-size} MB. Please try again with a smaller file.",[h._param("max-size",a)])}};a.prototype.$4=function(a,c){"use strict";a=this.$7(a,c);if(a){b("ErrorDialog").show(a.summary,a.description);return!1}else return!0};a.prototype.$7=function(a,b){"use strict";__p&&__p();var c;if(!b)return;var d=b.format.duration;d&&(d>this.$1.maxLength&&(c=this.$10()),d<this.$1.minLength&&!a&&(c=this.$11()));if(!b.streams||!b.streams.primaryVideo)return;d=b.streams.primaryVideo.width;a=b.streams.primaryVideo.height;var e=0,f=0;b.videoPlayerData!==null&&(e=b.videoPlayerData.height,f=b.videoPlayerData.width);this.$1.acceptDimensionsFromPlayer&&f!==0&&e!==0&&(d=f,a=e);!b.streams.primaryVideo&&b.streams.primaryAudio&&(c=this.$12());d<this.$1.minWidth&&(c=this.$13());a<this.$1.minHeight&&(c=this.$14());f=d/a;this.$1.require16to9AspectRatio&&((f>2||f<1.6)&&(c=this.$15()));this.$1.minAspectRatio&&(f<this.$1.minAspectRatio&&(c=this.$16()));this.$1.maxAspectRatio&&(f>this.$1.maxAspectRatio&&(c=this.$17()));return c};a.prototype.$10=function(){"use strict";if(this.$1.source==="profile_video")return{summary:h._("Profile video duration too long"),description:h._("The maximum length is {max-length} seconds. Please upload a shorter video.",[h._param("max-length",this.$1.maxLength)])};else return{summary:h._("Video duration too long"),description:h._("The duration of the video you tried to upload is too long. The maximum duration for a video is {max-length} minutes. Please upload a shorter video.",[h._param("max-length",Math.round(this.$1.maxLength/60))])}};a.prototype.$11=function(){"use strict";return{summary:h._("Video file too short"),description:h._({"second":"The duration of the video that you tried to upload is too short. The minimum length for a video is {min-length} second. Please upload a longer video.","seconds":"The duration of the video that you tried to upload is too short. The minimum length for a video is {min-length} seconds. Please upload a longer video."},[h._param("min-length",this.$1.minLength),h._enum(this.$1.minLength===1?"second":"seconds",{second:"second",seconds:"seconds"})])}};a.prototype.$12=function(){"use strict";var a="http://www.facebook.com/help/?faq=218673814818907#What-formats-of-video-files-can-I-upload?";a=b("React").createElement(b("Link.react"),{href:a},h._("supported video format"));return{summary:h._("No video detected"),description:h._("It looks like you're trying to upload a file that isn't a video. Please try uploading a {supported-video-format link}",[h._param("supported-video-format link",a)])}};a.prototype.$13=function(){"use strict";return{summary:h._("Video width too narrow"),description:h._("The width of the video you tried to upload is too short. The minimum width for a video is {min-width}. Please upload a wider video.",[h._param("min-width",this.$1.minWidth)])}};a.prototype.$15=function(){"use strict";return{summary:h._("Problem with uploading video"),description:h._("Videos look best when they have a 16:9 aspect ratio. Please edit your video and upload it again.")}};a.prototype.$14=function(){"use strict";return{summary:h._("Video height too short"),description:h._("The height of the video you tried to upload is too short. The minimum height for a video is {min-height}. Please upload a taller video.",[h._param("min-height",this.$1.minHeight)])}};a.prototype.$17=function(){"use strict";return{summary:h._("Video too wide"),description:h._("The video you selected is too wide. Aspect ratios for videos need to be between {max_aspect_ratio} and {min_aspect_ratio}. Please record and upload a taller video.",[h._param("max_aspect_ratio",this.$1.maxAspectRatio+":1"),h._param("min_aspect_ratio",this.$1.minAspectRatio+":1")])}};a.prototype.$16=function(){"use strict";return{summary:h._("Video too tall"),description:h._("The video you selected is too tall. Aspect ratios for videos need to be between {max_aspect_ratio} and {min_aspect_ratio}. Please record and upload a narrower video.",[h._param("max_aspect_ratio",this.$1.maxAspectRatio+":1"),h._param("min_aspect_ratio",this.$1.minAspectRatio+":1")])}};e.exports=a}),null);
__d("VideoUploadProgressBar",["cx","CSS","VideoUploadFeatureDetector"],(function(a,b,c,d,e,f,g){__p&&__p();function h(a){"use strict";this.$1=a.progress_bar,this.$2=a.throbber,this.$3=a.uploader,this.$4=a.start_margin,this.$5=a.start_delay,this.$6=a.end_margin,this.$7=a.end_delay,this.$8=a.progress_bar_label,this.$9()}h.prototype.reset=function(){"use strict";this.$1.setPosition(0)};h.prototype.getRoot=function(){"use strict";return this.$1.getRoot()};h.computeProgress=function(a,b,c,d,e){"use strict";a=Math.min(a+b,c);return a/c*(100-d-e)+d};h.prototype.$9=function(){"use strict";b("VideoUploadFeatureDetector").supportsFileAPI()?(this.$3.subscribe("upload-requested",this.$10.bind(this)),this.$3.subscribe("upload-progressed",this.$11.bind(this)),this.$3.subscribe("online",this.$12.bind(this)),this.$3.subscribe("offline",this.$13.bind(this))):this.$3.subscribe("upload-requested",this.$14.bind(this))};h.prototype.$10=function(a){"use strict";b("CSS").show(this.$1.getRoot()),b("CSS").removeClass(this.$1.getRoot(),"_5r5a"),this.$1.setTarget(this.$4,this.$5),this.$15(0)};h.prototype.$15=function(a){"use strict";this.$8&&this.$1.changeLabel(""+a.toFixed(1)+"%")};h.prototype.$11=function(a,c){"use strict";b("CSS").removeClass(this.$1.getRoot(),"_5r5a");a=h.computeProgress(c.start_offset,c.sent_bytes,c.file_size,this.$4,this.$6);this.$1.setPosition(a);this.$15(a);a>=100-this.$6&&(this.$1.setTarget(100,this.$7),this.$15(100))};h.prototype.$12=function(a){"use strict";b("CSS").removeClass(this.$1.getRoot(),"_5r5a")};h.prototype.$13=function(a){"use strict";b("CSS").addClass(this.$1.getRoot(),"_5r5a")};h.prototype.$14=function(a){"use strict";b("CSS").show(this.$2)};e.exports=h}),null);
__d("VideoUploadRequest",["AsyncRequest","DOM","DTSG","FileForm","Form","VideoUploadFeatureDetector","emptyFunction","flattenPHPQueryData","submitForm"],(function(a,b,c,d,e,f){__p&&__p();var g="video";function a(a){"use strict";this.$1=a,this.$2=null,this.$3=!1,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=b("emptyFunction"),this.$9=b("emptyFunction"),this.$10=b("emptyFunction"),this.$11=b("emptyFunction"),this.$12=null}a.prototype.setAllowCrossOrigin=function(a){"use strict";this.$3=a;return this};a.prototype.setData=function(a){"use strict";this.$4=a;return this};a.prototype.setWaterfallID=function(a){"use strict";this.$6=a;return this};a.prototype.setSuccessHandler=function(a){"use strict";this.$8=a;return this};a.prototype.setErrorHandler=function(a){"use strict";this.$9=a;return this};a.prototype.setTransportErrorHandler=function(a){"use strict";this.$10=a;return this};a.prototype.setUploadProgressHandler=function(a){"use strict";this.$11=a;return this};a.prototype.setTimeoutHandler=function(a,b){"use strict";this.$7=a;this.$12=b;return this};a.prototype.setThumbnail=function(a){"use strict";this.$13=a;return this};a.prototype.setCustomProfileImage=function(a){"use strict";this.$14=a;return this};a.prototype.setCustomBackgroundImage=function(a){"use strict";this.$15=a;return this};a.prototype.setFeedBackgroundImage=function(a){"use strict";this.$16=a;return this};a.prototype.setHandle=function(a){"use strict";this.$5=a;return this};a.prototype.setCaptions=function(a){"use strict";this.$17=a;return this};a.prototype.setPollOptionImages=function(a){"use strict";this.$18=a;return this};a.prototype.send=function(){"use strict";__p&&__p();if(this.$2)throw new Error("An upload request is already in progress.");if(b("VideoUploadFeatureDetector").supportsXHR()){this.$2=this.$19();if(this.$13||this.$17||this.$14||this.$15||this.$16||this.$18){var a=new FormData();this.$13&&a.append("thumb",this.$13);this.$14&&a.append("schedule_custom_profile_image",this.$14);this.$15&&a.append("schedule_custom_background_image",this.$15);this.$16&&a.append("schedule_feed_background_image",this.$16);this.$17&&this.$17.forEach(function(b,c){c=b.getIsDefault()?"captions_default":"captions_file"+c;a.append(c,b.getFile())});if(this.$18){var c=this.$18;Object.keys(c).forEach(function(b){a.append(b,c[b])})}if(this.$4){var d=b("flattenPHPQueryData")(this.$4);Object.keys(d).forEach(function(b){a.append(b,d[b])})}this.$2.setRawData(a)}this.$2.send()}else this.$2=this.$20(),this.$21(this.$2)};a.prototype.sendChunk=function(a){"use strict";if(this.$2)throw new Error("An upload request is already in progress.");var b=new FormData();this.$5?b.append("fbuploader_video_file_chunk",this.$5):b.append("video_file_chunk",a);this.$2=this.$19();this.$2.setRawData(b);this.$2.send()};a.prototype.sendFile=function(a){"use strict";__p&&__p();if(this.$2)throw new Error("An upload request is already in progress.");this.$2=this.$20();var c=a.cloneNode(!1);a.name=g;b("DOM").replace(a,c);b("DOM").appendContent(this.$2.getRoot(),a);this.$21(this.$2);a.name=c.name;b("DOM").replace(c,a)};a.prototype.abort=function(){"use strict";if(!this.$2)return;this.$2.abort();this.$2=null};a.prototype.$19=function(){"use strict";var a=this.__getAsyncRequest().setAllowCrossOrigin(this.$3).setURI(this.$1).setData(this.$4).setRequestHeader("X_FB_VIDEO_WATERFALL_ID",this.$6).setHandler(this.$8).setErrorHandler(this.$9).setTransportErrorHandler(this.$10).setUploadProgressHandler(this.$11);this.$12&&a.setTimeoutHandler(this.$7,this.$12);return a};a.prototype.__getAsyncRequest=function(){"use strict";return new(b("AsyncRequest"))()};a.prototype.$20=function(){"use strict";var a=b("DOM").create("form",{action:this.$1,method:"POST"});b("Form").createHiddenInputs(babelHelpers["extends"]({fb_dtsg:b("DTSG").getToken()},this.$4),a);a=new(b("FileForm"))(a,null,{allowCrossOrigin:this.$3});a.subscribe("success",this.$22.bind(this));a.subscribe("failure",this.$23.bind(this));a.subscribe("progress",this.$24.bind(this));return a};a.prototype.$21=function(a){"use strict";b("DOM").appendContent(document.body,a.getRoot()),b("submitForm")(a.getRoot())};a.prototype.$22=function(a,b){"use strict";this.$8(b.response)};a.prototype.$23=function(a,b){"use strict";this.$9(b.response)};a.prototype.$24=function(a,b){"use strict";this.$11(b.event)};e.exports=a}),null);
__d("VideoUploadRequestContext",[],(function(a,b,c,d,e,f){__p&&__p();function a(){"use strict";this.reset()}a.prototype.setFile=function(a){"use strict";this.$1=a;return this};a.prototype.getFile=function(){"use strict";return this.$1};a.prototype.setMetadata=function(a){"use strict";this.$2=a;return this};a.prototype.getMetadata=function(){"use strict";return this.$2};a.prototype.setVideoID=function(a){"use strict";this.$3=a;return this};a.prototype.getVideoID=function(){"use strict";return this.$3};a.prototype.setUploadSessionID=function(a){"use strict";this.$4=a;return this};a.prototype.getUploadSessionID=function(){"use strict";return this.$4};a.prototype.setFbRegion=function(a){"use strict";this.$5=a;return this};a.prototype.getFbRegion=function(){"use strict";return this.$5};a.prototype.setStartOffset=function(a){"use strict";this.$6=a;return this};a.prototype.getStartOffset=function(){"use strict";return this.$6};a.prototype.setEndOffset=function(a){"use strict";this.$7=a;return this};a.prototype.getEndOffset=function(){"use strict";return this.$7};a.prototype.setPartitionStartOffset=function(a){"use strict";this.$8=a;return this};a.prototype.getPartitionStartOffset=function(){"use strict";return this.$8};a.prototype.setPartitionEndOffset=function(a){"use strict";this.$9=a;return this};a.prototype.getPartitionEndOffset=function(){"use strict";return this.$9};a.prototype.setTargetID=function(a){"use strict";this.$10=a;return this};a.prototype.getTargetID=function(){"use strict";return this.$10};a.prototype.setSource=function(a){"use strict";this.$11=a;return this};a.prototype.setComposerDialogVersion=function(a){"use strict";this.$12=a;return this};a.prototype.getComposerDialogVersion=function(){"use strict";return this.$12};a.prototype.getSource=function(){"use strict";return this.$11};a.prototype.setWaterfallID=function(a){"use strict";this.$13=a;return this};a.prototype.getWaterfallID=function(){"use strict";return this.$13};a.prototype.setComposerEntryPointRef=function(a){"use strict";this.$14=a};a.prototype.getComposerEntryPointRef=function(){"use strict";return this.$14};a.prototype.setHasFileBeenReplaced=function(a){"use strict";this.$15=a;return this};a.prototype.getHasFileBeenReplaced=function(){"use strict";return this.$15};a.prototype.setSupportsChunking=function(a){"use strict";this.$16=a;return this};a.prototype.getSupportsChunking=function(){"use strict";return this.$16};a.prototype.setSupportsFileAPI=function(a){"use strict";this.$17=a;return this};a.prototype.getSupportsFileAPI=function(){"use strict";return this.$17};a.prototype.setCreatorProduct=function(a){"use strict";this.$18=a;return this};a.prototype.getCreatorProduct=function(){"use strict";return this.$18};a.prototype.setLastKnownUploadSpeed=function(a){"use strict";this.$19=a};a.prototype.getLastKnownUploadSpeed=function(){"use strict";return this.$19||0};a.prototype.setUseParallelChunks=function(a){"use strict";this.$20=a};a.prototype.getUseParallelChunks=function(){"use strict";return this.$20};a.prototype.setIsSphericalVideo=function(a){"use strict";this.$21=a};a.prototype.getIsSphericalVideo=function(){"use strict";return this.$21};a.prototype.setSphericalMetadata=function(a){"use strict";this.$22=a};a.prototype.getSphericalMetadata=function(){"use strict";return this.$22};a.prototype.setEnableOmnistab=function(a){"use strict";this.$23=a};a.prototype.getEnableOmnistab=function(){"use strict";return this.$23};a.prototype.setClientChunkSize=function(a){"use strict";this.$24=a};a.prototype.getClientChunkSize=function(){"use strict";return this.$24};a.prototype.reset=function(){"use strict";this.$1=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$10=null,this.$11=null,this.$12=null,this.$13=null,this.$14=null,this.$15=!1,this.$16=null,this.$17=null,this.$8=null,this.$9=null,this.$18=null,this.$19=0,this.$20=!1,this.$21=!1,this.$2={},this.$22={},this.$23=!1,this.$24=null};e.exports=a}),null);
__d("VideoUploadPostRequestManager",["ArbiterMixin","VideoUploadLogger","VideoUploadRequest","clearTimeout","mixin","setTimeout"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;function a(a,b,c,d,e){"use strict";g.constructor.call(this),this.$VideoUploadPostRequestManager2=a,this.$VideoUploadPostRequestManager3=b,this.$VideoUploadPostRequestManager4=c,this.$VideoUploadPostRequestManager5=0,this.$VideoUploadPostRequestManager6=d,this.$VideoUploadPostRequestManager7=e,this.$VideoUploadPostRequestManager8=0}a.prototype.$VideoUploadPostRequestManager9=function(){"use strict";return this.$VideoUploadPostRequestManager1?new(b("VideoUploadLogger"))({source:this.$VideoUploadPostRequestManager1.getSource(),waterfall_id:this.$VideoUploadPostRequestManager1.getWaterfallID(),target_id:this.$VideoUploadPostRequestManager1.getTargetID(),composer_entry_point_ref:this.$VideoUploadPostRequestManager1.getComposerEntryPointRef&&this.$VideoUploadPostRequestManager1.getComposerEntryPointRef()}):null};a.prototype.getRequest=function(){"use strict";return this.$VideoUploadPostRequestManager10};a.prototype.sendRequest=function(a){"use strict";__p&&__p();this.$VideoUploadPostRequestManager1=a;if(this.$VideoUploadPostRequestManager10){var c=this.$VideoUploadPostRequestManager9();c&&c.logEvent(b("VideoUploadLogger").EVENT_DUPLICATE_POST_REQUEST);return}this.$VideoUploadPostRequestManager11=babelHelpers["extends"]({},a.getMetadata(),this.__createRequestData(a));this.$VideoUploadPostRequestManager12=this.$VideoUploadPostRequestManager11.thumb;this.$VideoUploadPostRequestManager13=this.$VideoUploadPostRequestManager11.schedule_custom_profile_image;this.$VideoUploadPostRequestManager14=this.$VideoUploadPostRequestManager11.schedule_custom_background_image;this.$VideoUploadPostRequestManager15=this.$VideoUploadPostRequestManager11.schedule_feed_background_image;delete this.$VideoUploadPostRequestManager11.thumb;this.$VideoUploadPostRequestManager16=this.$VideoUploadPostRequestManager11.captions;delete this.$VideoUploadPostRequestManager11.captions;this.$VideoUploadPostRequestManager17=a.getWaterfallID();this.$VideoUploadPostRequestManager18=this.$VideoUploadPostRequestManager11.pollImages;this.$VideoUploadPostRequestManager19();this.inform("request-started")};a.prototype.$VideoUploadPostRequestManager19=function(){"use strict";b("clearTimeout")(this.$VideoUploadPostRequestManager20),this.$VideoUploadPostRequestManager20=null,this.$VideoUploadPostRequestManager10=this.__getVideoUploadRequest(this.$VideoUploadPostRequestManager2).setAllowCrossOrigin(!0).setData(this.$VideoUploadPostRequestManager11).setThumbnail(this.$VideoUploadPostRequestManager12).setCustomProfileImage(this.$VideoUploadPostRequestManager13).setCustomBackgroundImage(this.$VideoUploadPostRequestManager14).setFeedBackgroundImage(this.$VideoUploadPostRequestManager15).setCaptions(this.$VideoUploadPostRequestManager16).setWaterfallID(this.$VideoUploadPostRequestManager17).setPollOptionImages(this.$VideoUploadPostRequestManager18).setSuccessHandler(this.$VideoUploadPostRequestManager21.bind(this)).setErrorHandler(this.$VideoUploadPostRequestManager22.bind(this)).setTransportErrorHandler(this.$VideoUploadPostRequestManager23.bind(this)),this.$VideoUploadPostRequestManager10.send()};a.prototype.__createRequestData=function(a){"use strict";return{video_id:a.getVideoID(),target_id:a.getTargetID(),source:a.getSource(),waterfall_id:a.getWaterfallID(),creator_product:a.getCreatorProduct(),composer_entry_point_ref:a.getComposerEntryPointRef&&a.getComposerEntryPointRef(),composer_dialog_version:a.getComposerDialogVersion(),has_file_been_replaced:a.getHasFileBeenReplaced(),supports_chunking:a.getSupportsChunking()}};a.prototype.__getVideoUploadRequest=function(a){"use strict";return new(b("VideoUploadRequest"))(a)};a.prototype.clearRequest=function(){"use strict";this.$VideoUploadPostRequestManager10=null,this.$VideoUploadPostRequestManager8=0,this.$VideoUploadPostRequestManager5=0};a.prototype.isInProgress=function(){"use strict";return!!this.$VideoUploadPostRequestManager10};a.prototype.$VideoUploadPostRequestManager24=function(a){"use strict";b("clearTimeout")(this.$VideoUploadPostRequestManager20),this.$VideoUploadPostRequestManager20=b("setTimeout")(this.$VideoUploadPostRequestManager19.bind(this),a)};a.prototype.$VideoUploadPostRequestManager25=function(a,b){"use strict";return Math.pow(a,b)*1e3};a.prototype.$VideoUploadPostRequestManager21=function(a){"use strict";a=a.getPayload();this.inform("request-finished",{video_id:a.video_id,video_asset_id:a.video_asset_id,container_type:a.container_type,transport_retries:this.$VideoUploadPostRequestManager5,server_retries:this.$VideoUploadPostRequestManager8,premiere_destination_video_id:a.premiere_destination_video_id});this.clearRequest()};a.prototype.$VideoUploadPostRequestManager26=function(a){"use strict";this.inform("request-failed",{error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),transport_retries:this.$VideoUploadPostRequestManager5,server_retries:this.$VideoUploadPostRequestManager8,error_is_transient:a.isTransient()}),this.clearRequest()};a.prototype.$VideoUploadPostRequestManager22=function(a){"use strict";this.$VideoUploadPostRequestManager10=null;this.$VideoUploadPostRequestManager5=0;var c=this.$VideoUploadPostRequestManager9();if(c){var d={server_retries:this.$VideoUploadPostRequestManager8,extra_data:{failure_is_transient:a.isTransient()}};c.logEvent(b("VideoUploadLogger").EVENT_HANDLING_SERVER_FAILURE_RESPONSE,d)}a.isTransient()&&this.$VideoUploadPostRequestManager8<this.$VideoUploadPostRequestManager6?(this.$VideoUploadPostRequestManager8++,this.$VideoUploadPostRequestManager24(this.$VideoUploadPostRequestManager25(this.$VideoUploadPostRequestManager7,this.$VideoUploadPostRequestManager8))):this.$VideoUploadPostRequestManager26(a)};a.prototype.$VideoUploadPostRequestManager23=function(a){"use strict";var c=this.$VideoUploadPostRequestManager9();if(c){var d={extra_data:{transport_retries:this.$VideoUploadPostRequestManager5}};c.logEvent(b("VideoUploadLogger").EVENT_HANDLING_TRANSPORT_FAILURE_RESPONSE,d)}this.$VideoUploadPostRequestManager3===0||this.$VideoUploadPostRequestManager5>=this.$VideoUploadPostRequestManager3?this.$VideoUploadPostRequestManager26(a):(this.$VideoUploadPostRequestManager5++,this.$VideoUploadPostRequestManager10=null,this.$VideoUploadPostRequestManager24(this.$VideoUploadPostRequestManager25(this.$VideoUploadPostRequestManager4,this.$VideoUploadPostRequestManager5)))};e.exports=a}),null);
__d("VideoUploadConnectionMonitor",["ArbiterMixin","Network","VideoUploadFeatureDetector","debounce","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;function a(){"use strict";g.constructor.call(this),this.$VideoUploadConnectionMonitor1=!1,this.$VideoUploadConnectionMonitor2=[],this.$VideoUploadConnectionMonitor3=!1,this.$VideoUploadConnectionMonitor4=!0,this.$VideoUploadConnectionMonitor5=b("debounce")(function(){this.$VideoUploadConnectionMonitor6(!1)}.bind(this),2e3)}a.prototype.notifyStart=function(){"use strict";if(this.$VideoUploadConnectionMonitor3)return;this.$VideoUploadConnectionMonitor2.length===0&&(this.$VideoUploadConnectionMonitor2.push(b("Network").addListener("online",function(){this.$VideoUploadConnectionMonitor6(!0)}.bind(this))),this.$VideoUploadConnectionMonitor2.push(b("Network").addListener("offline",function(){this.$VideoUploadConnectionMonitor1?this.$VideoUploadConnectionMonitor5():(this.$VideoUploadConnectionMonitor5.reset(),setTimeout(this.$VideoUploadConnectionMonitor5,2e3))}.bind(this))));this.$VideoUploadConnectionMonitor3=!0};a.prototype.notifyProgress=function(a){"use strict";if(!this.$VideoUploadConnectionMonitor3)return;if(!a)return;b("VideoUploadFeatureDetector").supportsFullProgress()&&(this.$VideoUploadConnectionMonitor1=!0,a.total&&a.loaded===a.total?this.$VideoUploadConnectionMonitor5.reset():this.$VideoUploadConnectionMonitor5())};a.prototype.notifySuccess=function(){"use strict";if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(!0)};a.prototype.notifyTransportError=function(){"use strict";if(!this.$VideoUploadConnectionMonitor3)return;this.$VideoUploadConnectionMonitor3=!1;this.$VideoUploadConnectionMonitor6(!1)};a.prototype.notifyError=function(){"use strict";if(!this.$VideoUploadConnectionMonitor3)return;this.reset();this.$VideoUploadConnectionMonitor6(!0)};a.prototype.isOnline=function(){"use strict";return this.$VideoUploadConnectionMonitor4};a.prototype.reset=function(){"use strict";while(this.$VideoUploadConnectionMonitor2.length)this.$VideoUploadConnectionMonitor2.pop().remove();this.$VideoUploadConnectionMonitor5.reset();this.$VideoUploadConnectionMonitor3=!1};a.prototype.$VideoUploadConnectionMonitor6=function(a){"use strict";this.$VideoUploadConnectionMonitor5.reset(),this.$VideoUploadConnectionMonitor4!==a&&(this.$VideoUploadConnectionMonitor4=a,this.$VideoUploadConnectionMonitor4?this.inform("online"):this.inform("offline"))};e.exports=a}),null);
__d("VideoUploadReceiveRequestManager",["fbt","ArbiterMixin","ResumableUploadAsyncService","ResumableUploadService","ResumableUploadServiceState.enum","VideoUploadConnectionMonitor","VideoUploadRequest","md5","mixin"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=1363037;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));h=c&&c.prototype;function a(a,c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u){m===void 0&&(m=""),n===void 0&&(n=!1),o===void 0&&(o=!1),p===void 0&&(p=null),q===void 0&&(q=null),r===void 0&&(r=0),s===void 0&&(s=!1),t===void 0&&(t=!1),u===void 0&&(u=!1),h.constructor.call(this),this.$VideoUploadReceiveRequestManager1=a,this.$VideoUploadReceiveRequestManager2=c,this.$VideoUploadReceiveRequestManager3=d!=null?d:0,this.$VideoUploadReceiveRequestManager4=e,this.$VideoUploadReceiveRequestManager5=f,this.$VideoUploadReceiveRequestManager6=g,this.$VideoUploadReceiveRequestManager7=i,this.$VideoUploadReceiveRequestManager8=j,this.$VideoUploadReceiveRequestManager9=k,this.$VideoUploadReceiveRequestManager10=l,this.$VideoUploadReceiveRequestManager11=0,this.$VideoUploadReceiveRequestManager12=0,this.$VideoUploadReceiveRequestManager13=0,this.$VideoUploadReceiveRequestManager14=null,this.$VideoUploadReceiveRequestManager15=null,this.$VideoUploadReceiveRequestManager16=0,this.$VideoUploadReceiveRequestManager17="constructed",this.$VideoUploadReceiveRequestManager18=null,this.$VideoUploadReceiveRequestManager19=m,this.$VideoUploadReceiveRequestManager20=o,this.$VideoUploadReceiveRequestManager21=n,this.$VideoUploadReceiveRequestManager22=p,this.$VideoUploadReceiveRequestManager23=!1,this.$VideoUploadReceiveRequestManager24=s,this.$VideoUploadReceiveRequestManager25=r,this.$VideoUploadReceiveRequestManager26=t,this.$VideoUploadReceiveRequestManager27=q,this.$VideoUploadReceiveRequestManager28=u,this.$VideoUploadReceiveRequestManager29=null,this.$VideoUploadReceiveRequestManager30=null,this.$VideoUploadReceiveRequestManager31=!1,this.$VideoUploadReceiveRequestManager32=new(b("VideoUploadConnectionMonitor"))(),this.$VideoUploadReceiveRequestManager32.subscribe("online",this.$VideoUploadReceiveRequestManager33.bind(this)),this.$VideoUploadReceiveRequestManager32.subscribe("offline",this.$VideoUploadReceiveRequestManager34.bind(this))}a.prototype.updateVideoID=function(a){"use strict";if(this.$VideoUploadReceiveRequestManager35.getVideoID())return;this.$VideoUploadReceiveRequestManager35.setVideoID(a);this.$VideoUploadReceiveRequestManager36&&this.$VideoUploadReceiveRequestManager36.setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager35));this.$VideoUploadReceiveRequestManager37()};a.prototype.isResumabilityEnabled=function(){"use strict";return this.$VideoUploadReceiveRequestManager21};a.prototype.isResumableServiceProxyReceiveEnabled=function(){"use strict";return this.$VideoUploadReceiveRequestManager24};a.prototype.sendRequest=function(a){"use strict";this.$VideoUploadReceiveRequestManager17="sending request";if(this.$VideoUploadReceiveRequestManager36){this.$VideoUploadReceiveRequestManager17="request already in progress";return}this.$VideoUploadReceiveRequestManager16=a.getEndOffset()-a.getStartOffset();this.$VideoUploadReceiveRequestManager35=a;this.$VideoUploadReceiveRequestManager38()};a.prototype.cancelRequest=function(){"use strict";if(!this.$VideoUploadReceiveRequestManager36)return;this.$VideoUploadReceiveRequestManager36.abort();this.$VideoUploadReceiveRequestManager18!==null&&this.$VideoUploadReceiveRequestManager18.cancel();this.$VideoUploadReceiveRequestManager39()};a.prototype.appendStateLogData=function(a,b){"use strict";a[b+"request_manager_state"]=this.$VideoUploadReceiveRequestManager17,a[b+"upload_speed"]=this.$VideoUploadReceiveRequestManager15,a[b+"transport_retries"]=this.$VideoUploadReceiveRequestManager11,a[b+"server_retries"]=this.$VideoUploadReceiveRequestManager12,a[b+"timeout_retries"]=this.$VideoUploadReceiveRequestManager13,a[b+"last_timeout_value"]=this.$VideoUploadReceiveRequestManager40,a[b+"last_request_start_time"]=this.$VideoUploadReceiveRequestManager14,a[b+"pending_request"]=this.$VideoUploadReceiveRequestManager36!=null,a[b+"pending_timer"]=this.$VideoUploadReceiveRequestManager41!=null,a[b+"cached_chunk"]=this.$VideoUploadReceiveRequestManager42!=null,a[b+"early_receive_start"]=this.$VideoUploadReceiveRequestManager31,this.$VideoUploadReceiveRequestManager35!=null&&(a[b+"start_offset"]=this.$VideoUploadReceiveRequestManager35.getStartOffset(),a[b+"end_offset"]=this.$VideoUploadReceiveRequestManager35.getEndOffset(),a[b+"partition_start_offset"]=this.$VideoUploadReceiveRequestManager35.getPartitionStartOffset(),a[b+"partition_end_offset"]=this.$VideoUploadReceiveRequestManager35.getPartitionEndOffset()),this.$VideoUploadReceiveRequestManager32!=null&&(a[b+"connection_monitor_online"]=this.$VideoUploadReceiveRequestManager32.isOnline())};a.prototype.$VideoUploadReceiveRequestManager39=function(){"use strict";this.$VideoUploadReceiveRequestManager36=null,this.$VideoUploadReceiveRequestManager42=null,this.$VideoUploadReceiveRequestManager11=0,this.$VideoUploadReceiveRequestManager12=0,this.$VideoUploadReceiveRequestManager13=0,this.$VideoUploadReceiveRequestManager14=null,this.$VideoUploadReceiveRequestManager15=null,this.$VideoUploadReceiveRequestManager16=0,this.$VideoUploadReceiveRequestManager29=null,this.$VideoUploadReceiveRequestManager30=null,this.$VideoUploadReceiveRequestManager31=!1,this.$VideoUploadReceiveRequestManager23=!1,this.$VideoUploadReceiveRequestManager35.reset(),this.$VideoUploadReceiveRequestManager32.reset(),clearTimeout(this.$VideoUploadReceiveRequestManager41),this.$VideoUploadReceiveRequestManager41=null};a.prototype.$VideoUploadReceiveRequestManager38=function(a){"use strict";__p&&__p();clearTimeout(this.$VideoUploadReceiveRequestManager41);this.$VideoUploadReceiveRequestManager41=null;if(this.$VideoUploadReceiveRequestManager35.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager35.getStartOffset()>=this.$VideoUploadReceiveRequestManager35.getPartitionEndOffset()){!a?(this.inform("request-finished",{start_offset:this.$VideoUploadReceiveRequestManager35.getEndOffset()-1,end_offset:this.$VideoUploadReceiveRequestManager35.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager12,upload_speed:this.$VideoUploadReceiveRequestManager15,request_manager_state:this.$VideoUploadReceiveRequestManager17}),this.$VideoUploadReceiveRequestManager17="request finished - notified"):this.$VideoUploadReceiveRequestManager17="request finished - not notified";return}this.$VideoUploadReceiveRequestManager36=this.__getVideoUploadRequest(this.$VideoUploadReceiveRequestManager1).setAllowCrossOrigin(!0).setData(this.__createRequestData(this.$VideoUploadReceiveRequestManager35)).setWaterfallID(this.$VideoUploadReceiveRequestManager35.getWaterfallID()).setSuccessHandler(this.__handleSuccessResponse.bind(this)).setErrorHandler(this.__handleServerFailureResponse.bind(this)).setTransportErrorHandler(this.$VideoUploadReceiveRequestManager43.bind(this));this.$VideoUploadReceiveRequestManager21||this.$VideoUploadReceiveRequestManager36.setUploadProgressHandler(this.$VideoUploadReceiveRequestManager44.bind(this));this.$VideoUploadReceiveRequestManager14=Date.now();if(this.$VideoUploadReceiveRequestManager35.getSupportsChunking()){if(this.$VideoUploadReceiveRequestManager5){a=this.$VideoUploadReceiveRequestManager45(this.$VideoUploadReceiveRequestManager35.getEndOffset()-this.$VideoUploadReceiveRequestManager35.getStartOffset(),this.$VideoUploadReceiveRequestManager15);this.$VideoUploadReceiveRequestManager36.setTimeoutHandler(a,this.__handleResponseTimeout.bind(this));this.$VideoUploadReceiveRequestManager17="sending chunk with timeout = "+a;this.$VideoUploadReceiveRequestManager40=a}else this.$VideoUploadReceiveRequestManager17="sending chunk without timeout";a=this.$VideoUploadReceiveRequestManager46();this.$VideoUploadReceiveRequestManager21&&this.$VideoUploadReceiveRequestManager25<this.$VideoUploadReceiveRequestManager35.getFile().getSize()?this.$VideoUploadReceiveRequestManager47(a):this.$VideoUploadReceiveRequestManager36.sendChunk(a)}else this.$VideoUploadReceiveRequestManager17="sending file",this.$VideoUploadReceiveRequestManager36.sendFile(this.$VideoUploadReceiveRequestManager35.getFile().getFileInput());this.$VideoUploadReceiveRequestManager32.notifyStart();this.inform("request-started",{start_offset:this.$VideoUploadReceiveRequestManager35.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager35.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager12,upload_speed:this.$VideoUploadReceiveRequestManager15,request_manager_state:this.$VideoUploadReceiveRequestManager17})};a.prototype.$VideoUploadReceiveRequestManager48=function(a,b){"use strict";!this.$VideoUploadReceiveRequestManager35.getVideoID()?(this.$VideoUploadReceiveRequestManager29=a,this.$VideoUploadReceiveRequestManager30=b):a(b)};a.prototype.$VideoUploadReceiveRequestManager37=function(){"use strict";this.$VideoUploadReceiveRequestManager29&&(this.$VideoUploadReceiveRequestManager29(this.$VideoUploadReceiveRequestManager30),this.$VideoUploadReceiveRequestManager29=null,this.$VideoUploadReceiveRequestManager30=null)};a.prototype.$VideoUploadReceiveRequestManager47=function(a){"use strict";__p&&__p();var c=this.$VideoUploadReceiveRequestManager35.getFile();c=c.getFile().lastModified+c.getFile().name+c.getFile().type+this.$VideoUploadReceiveRequestManager49();c=b("md5")(c)+"-"+this.$VideoUploadReceiveRequestManager35.getStartOffset()+"-"+this.$VideoUploadReceiveRequestManager35.getEndOffset();this.isResumabilityEnabled()&&this.$VideoUploadReceiveRequestManager22&&this.$VideoUploadReceiveRequestManager11>this.$VideoUploadReceiveRequestManager2/3&&(this.$VideoUploadReceiveRequestManager23=!0);var d="fb_video",e=null;if(this.$VideoUploadReceiveRequestManager24){d="fb_video2";var f={start_offset:this.$VideoUploadReceiveRequestManager35.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager35.getEndOffset(),composer_session_id:this.$VideoUploadReceiveRequestManager35.getWaterfallID(),upload_session_id:this.$VideoUploadReceiveRequestManager35.getUploadSessionID(),fb_region:this.$VideoUploadReceiveRequestManager35.getFbRegion()};e=f}f=this.$VideoUploadReceiveRequestManager20?b("ResumableUploadAsyncService"):b("ResumableUploadService");this.$VideoUploadReceiveRequestManager18=new f(d,this.$VideoUploadReceiveRequestManager19,c,null,null,this.$VideoUploadReceiveRequestManager23?null:this.$VideoUploadReceiveRequestManager22,e,this.$VideoUploadReceiveRequestManager28?this.$VideoUploadReceiveRequestManager35.getWaterfallID():null);this.$VideoUploadReceiveRequestManager50();this.$VideoUploadReceiveRequestManager18.resume(a);this.inform("resumable-called")};a.prototype.$VideoUploadReceiveRequestManager50=function(){"use strict";__p&&__p();this.$VideoUploadReceiveRequestManager35.getVideoID()||(this.$VideoUploadReceiveRequestManager31=!0),this.$VideoUploadReceiveRequestManager18.addListener(b("ResumableUploadServiceState.enum").START,function(a){this.inform("resumable-started",{resume_from_offset:a.offset})}.bind(this)),this.$VideoUploadReceiveRequestManager51=function(a){this.inform("resumable-failed",{error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),error_is_transient:a.isTransient()}),this.__handleServerFailureResponse(a)}.bind(this),this.$VideoUploadReceiveRequestManager18.addListener(b("ResumableUploadServiceState.enum").FAIL,function(a){this.$VideoUploadReceiveRequestManager48(this.$VideoUploadReceiveRequestManager51,a)}.bind(this)),this.$VideoUploadReceiveRequestManager52=function(a){!this.$VideoUploadReceiveRequestManager24?(this.$VideoUploadReceiveRequestManager36.setHandle(a),this.$VideoUploadReceiveRequestManager36.sendChunk(null)):this.__handleSuccessResponsePayload({start_offset:this.$VideoUploadReceiveRequestManager35.getEndOffset(),end_offset:this.$VideoUploadReceiveRequestManager35.getPartitionEndOffset()}),this.inform("resumable-success",{everstore_handle:a})}.bind(this),this.$VideoUploadReceiveRequestManager18.addListener(b("ResumableUploadServiceState.enum").SUCCESS,function(a){this.$VideoUploadReceiveRequestManager48(this.$VideoUploadReceiveRequestManager52,a)}.bind(this)),this.$VideoUploadReceiveRequestManager53=function(a){this.inform("resumable-failed",{error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),error_is_transient:a.isTransient()}),this.$VideoUploadReceiveRequestManager43(a)}.bind(this),this.$VideoUploadReceiveRequestManager18.addListener(b("ResumableUploadServiceState.enum").TRANSPORT_FAILURE,function(a){this.$VideoUploadReceiveRequestManager48(this.$VideoUploadReceiveRequestManager53,a)}.bind(this)),this.$VideoUploadReceiveRequestManager18.addListener(b("ResumableUploadServiceState.enum").PROGRESS,function(a){this.$VideoUploadReceiveRequestManager26&&(this.$VideoUploadReceiveRequestManager11=0),this.$VideoUploadReceiveRequestManager44(a)}.bind(this))};a.prototype.__getVideoUploadRequest=function(a){"use strict";return new(b("VideoUploadRequest"))(a)};a.prototype.$VideoUploadReceiveRequestManager54=function(a){"use strict";this.$VideoUploadReceiveRequestManager17="setting request to send after"+a,clearTimeout(this.$VideoUploadReceiveRequestManager41),this.$VideoUploadReceiveRequestManager41=setTimeout(this.$VideoUploadReceiveRequestManager38.bind(this),a)};a.prototype.$VideoUploadReceiveRequestManager46=function(){"use strict";if(this.$VideoUploadReceiveRequestManager42)return this.$VideoUploadReceiveRequestManager42;this.$VideoUploadReceiveRequestManager21?this.$VideoUploadReceiveRequestManager42=this.$VideoUploadReceiveRequestManager35.getFile().getFile().slice(this.$VideoUploadReceiveRequestManager35.getStartOffset(),this.$VideoUploadReceiveRequestManager35.getEndOffset(),"application/octet-stream"):this.$VideoUploadReceiveRequestManager42=this.$VideoUploadReceiveRequestManager35.getFile().getChunk(this.$VideoUploadReceiveRequestManager35.getStartOffset(),this.$VideoUploadReceiveRequestManager35.getEndOffset());return this.$VideoUploadReceiveRequestManager42};a.prototype.__createRequestData=function(a){"use strict";return{video_id:a.getVideoID(),start_offset:a.getStartOffset(),end_offset:a.getEndOffset(),source:a.getSource(),target_id:a.getTargetID(),waterfall_id:a.getWaterfallID(),composer_entry_point_ref:a.getComposerEntryPointRef&&a.getComposerEntryPointRef(),composer_dialog_version:a.getComposerDialogVersion(),has_file_been_replaced:a.getHasFileBeenReplaced(),supports_chunking:a.getSupportsChunking(),upload_speed:this.$VideoUploadReceiveRequestManager15,partition_start_offset:a.getPartitionStartOffset(),partition_end_offset:a.getPartitionEndOffset()}};a.prototype.__handleSuccessResponse=function(a){"use strict";a=a.getPayload();this.__handleSuccessResponsePayload(a)};a.prototype.__handleSuccessResponsePayload=function(a){"use strict";__p&&__p();this.$VideoUploadReceiveRequestManager17="success response received";var b=Date.now()-this.$VideoUploadReceiveRequestManager14;b=b===0?1:b;if(a.start_offset===this.$VideoUploadReceiveRequestManager35.getEndOffset()){var c=this.$VideoUploadReceiveRequestManager35.getEndOffset()-this.$VideoUploadReceiveRequestManager35.getStartOffset();this.$VideoUploadReceiveRequestManager15=Math.floor(c/b)}else this.$VideoUploadReceiveRequestManager15=null;this.$VideoUploadReceiveRequestManager32.notifySuccess();this.inform("request-finished",{start_offset:this.$VideoUploadReceiveRequestManager35.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager35.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager12,upload_speed:this.$VideoUploadReceiveRequestManager15,request_manager_state:this.$VideoUploadReceiveRequestManager17});this.$VideoUploadReceiveRequestManager35.setStartOffset(a.start_offset);c=a.end_offset;this.$VideoUploadReceiveRequestManager35.getClientChunkSize()&&(c=a.start_offset+Math.min(this.$VideoUploadReceiveRequestManager35.getPartitionEndOffset()-a.start_offset,this.$VideoUploadReceiveRequestManager35.getClientChunkSize()));this.$VideoUploadReceiveRequestManager35.setEndOffset(c);this.$VideoUploadReceiveRequestManager35.setLastKnownUploadSpeed(this.$VideoUploadReceiveRequestManager15);this.$VideoUploadReceiveRequestManager36=null;this.$VideoUploadReceiveRequestManager42=null;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager12=0;this.$VideoUploadReceiveRequestManager13=0;this.$VideoUploadReceiveRequestManager35.getSupportsChunking()&&this.$VideoUploadReceiveRequestManager38(!0)};a.prototype.__handleServerFailureResponse=function(a){"use strict";__p&&__p();this.$VideoUploadReceiveRequestManager17="failure response received";this.$VideoUploadReceiveRequestManager36=null;this.$VideoUploadReceiveRequestManager11=0;this.$VideoUploadReceiveRequestManager15=null;this.$VideoUploadReceiveRequestManager13=0;this.$VideoUploadReceiveRequestManager32.notifyError();if(this.__hasInvalidStartOffsetAndHasRetries(a.getError())){this.$VideoUploadReceiveRequestManager12++;var b=a.getPayload();this.$VideoUploadReceiveRequestManager17="invalid offset response received start="+b.start_offset+" end="+b.end_offset;(this.$VideoUploadReceiveRequestManager35.getStartOffset()!=b.start_offset||this.$VideoUploadReceiveRequestManager35.getEndOffset()!=b.end_offset)&&(this.$VideoUploadReceiveRequestManager35.setStartOffset(b.start_offset),this.$VideoUploadReceiveRequestManager35.setEndOffset(b.end_offset),this.$VideoUploadReceiveRequestManager42=null);this.$VideoUploadReceiveRequestManager38()}else(a.isTransient()||this.$VideoUploadReceiveRequestManager10)&&this.$VideoUploadReceiveRequestManager12<this.$VideoUploadReceiveRequestManager4?(this.$VideoUploadReceiveRequestManager17="transient server error",this.$VideoUploadReceiveRequestManager12++,this.$VideoUploadReceiveRequestManager54(this.$VideoUploadReceiveRequestManager55(this.$VideoUploadReceiveRequestManager9,this.$VideoUploadReceiveRequestManager12,0))):this.$VideoUploadReceiveRequestManager56(a)};a.prototype.__handleResponseTimeout=function(a){"use strict";__p&&__p();this.inform("request-timeout",{start_offset:this.$VideoUploadReceiveRequestManager35.getStartOffset(),end_offset:this.$VideoUploadReceiveRequestManager35.getEndOffset(),transport_retries:this.$VideoUploadReceiveRequestManager11,server_retries:this.$VideoUploadReceiveRequestManager12,timeout_retries:this.$VideoUploadReceiveRequestManager13,upload_speed:this.$VideoUploadReceiveRequestManager15,request_manager_state:this.$VideoUploadReceiveRequestManager17});this.$VideoUploadReceiveRequestManager36.abort();this.$VideoUploadReceiveRequestManager36=null;this.$VideoUploadReceiveRequestManager15=null;this.$VideoUploadReceiveRequestManager32.notifyTransportError();if(++this.$VideoUploadReceiveRequestManager13<=this.$VideoUploadReceiveRequestManager6){a=this.$VideoUploadReceiveRequestManager35.getEndOffset()-this.$VideoUploadReceiveRequestManager35.getStartOffset();a=Math.floor(a/2);a=Math.max(a,this.$VideoUploadReceiveRequestManager16);var b=this.$VideoUploadReceiveRequestManager35.getEndOffset();b=Math.min(b,this.$VideoUploadReceiveRequestManager35.getStartOffset()+a);this.$VideoUploadReceiveRequestManager35.setEndOffset(b);this.$VideoUploadReceiveRequestManager42=null;this.$VideoUploadReceiveRequestManager17="resending after timeout with chunksize="+a;this.$VideoUploadReceiveRequestManager38()}else this.$VideoUploadReceiveRequestManager57({error_code:1006,error_description:g._("Your browser appears to be offline. Please check your internet connection and try again."),error_summary:g._("No network connection"),error_is_transient:!0})};a.prototype.__hasInvalidStartOffsetAndHasRetries=function(a){"use strict";return a===i&&this.$VideoUploadReceiveRequestManager12<this.$VideoUploadReceiveRequestManager4};a.prototype.$VideoUploadReceiveRequestManager43=function(a){"use strict";this.$VideoUploadReceiveRequestManager32.notifyTransportError(),this.$VideoUploadReceiveRequestManager15=null,this.$VideoUploadReceiveRequestManager13=0,this.$VideoUploadReceiveRequestManager11<this.$VideoUploadReceiveRequestManager2?(this.$VideoUploadReceiveRequestManager17="resending after transport failure",this.$VideoUploadReceiveRequestManager11++,this.$VideoUploadReceiveRequestManager36=null,this.$VideoUploadReceiveRequestManager54(this.$VideoUploadReceiveRequestManager55(this.$VideoUploadReceiveRequestManager8,this.$VideoUploadReceiveRequestManager11,this.$VideoUploadReceiveRequestManager3))):this.$VideoUploadReceiveRequestManager56(a)};a.prototype.$VideoUploadReceiveRequestManager56=function(a){"use strict";this.$VideoUploadReceiveRequestManager57({error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),error_is_transient:a.isTransient()})};a.prototype.$VideoUploadReceiveRequestManager57=function(a){"use strict";this.$VideoUploadReceiveRequestManager17="handling failure error",this.inform("request-failed",a),this.$VideoUploadReceiveRequestManager39()};a.prototype.$VideoUploadReceiveRequestManager44=function(a){"use strict";this.$VideoUploadReceiveRequestManager32.notifyProgress(a),this.$VideoUploadReceiveRequestManager35&&this.$VideoUploadReceiveRequestManager35.getFile()&&this.inform("request-progressed",{file_size:this.$VideoUploadReceiveRequestManager35.getFile().getSize(),start_offset:this.$VideoUploadReceiveRequestManager35.getStartOffset(),sent_bytes:a.loaded,transport_retries:this.$VideoUploadReceiveRequestManager11})};a.prototype.$VideoUploadReceiveRequestManager33=function(a){"use strict";this.inform("online"),this.$VideoUploadReceiveRequestManager11=0,this.$VideoUploadReceiveRequestManager13=0,this.$VideoUploadReceiveRequestManager41&&this.$VideoUploadReceiveRequestManager38()};a.prototype.$VideoUploadReceiveRequestManager34=function(a){"use strict";this.inform("offline")};a.prototype.$VideoUploadReceiveRequestManager55=function(a,b,c){"use strict";var d;this.$VideoUploadReceiveRequestManager21?d=Math.min(Math.pow(a,b),8)*1e3:d=Math.pow(a,b)*1e3;c>0&&(d=Math.min(d,c));return d};a.prototype.$VideoUploadReceiveRequestManager45=function(a,b){"use strict";b>0?b=b:b=10;a=Math.floor(a/b*this.$VideoUploadReceiveRequestManager7/100);return Math.max(a,3e4)};a.prototype.$VideoUploadReceiveRequestManager49=function(){"use strict";return this.$VideoUploadReceiveRequestManager27?this.$VideoUploadReceiveRequestManager27:this.$VideoUploadReceiveRequestManager35.getWaterfallID()};e.exports=a}),null);
__d("VideoUploadStartRequestManager",["ArbiterMixin","Assert","FileHasher","VideoUploadRequest","mixin","performanceNow"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;function a(a,b,c,d,e,f,h,i){"use strict";g.constructor.call(this),this.$VideoUploadStartRequestManager1=a,this.$VideoUploadStartRequestManager2=b,this.$VideoUploadStartRequestManager3=c,this.$VideoUploadStartRequestManager4=d,this.$VideoUploadStartRequestManager5=0,this.$VideoUploadStartRequestManager6=e,this.$VideoUploadStartRequestManager7=f,this.$VideoUploadStartRequestManager8=h,this.$VideoUploadStartRequestManager9=i,this.$VideoUploadStartRequestManager10=0}a.prototype.getRequest=function(){"use strict";return this.$VideoUploadStartRequestManager11};a.prototype.sendRequest=function(a){"use strict";if(this.$VideoUploadStartRequestManager12||this.$VideoUploadStartRequestManager11)return;this.$VideoUploadStartRequestManager13=a;this.$VideoUploadStartRequestManager6&&this.$VideoUploadStartRequestManager13.getFile().getFile()&&this.$VideoUploadStartRequestManager13.getFile().getFile().size<this.$VideoUploadStartRequestManager7&&b("FileHasher").isSupported()?(this.$VideoUploadStartRequestManager14=b("performanceNow")(),this.$VideoUploadStartRequestManager12=new(b("FileHasher"))(),this.$VideoUploadStartRequestManager12.hash(this.$VideoUploadStartRequestManager13.getFile().getFile(),function(a){this.$VideoUploadStartRequestManager14=b("performanceNow")()-this.$VideoUploadStartRequestManager14,this.$VideoUploadStartRequestManager15=a.hash,this.$VideoUploadStartRequestManager12.destroy(),this.$VideoUploadStartRequestManager12=null,a.hash||(this.$VideoUploadStartRequestManager16=a.exception),this.$VideoUploadStartRequestManager17()}.bind(this))):this.$VideoUploadStartRequestManager17()};a.prototype.$VideoUploadStartRequestManager17=function(){"use strict";this.$VideoUploadStartRequestManager18(),this.inform("request-started",{hash_time:this.$VideoUploadStartRequestManager14,hash_exception:this.$VideoUploadStartRequestManager16})};a.prototype.$VideoUploadStartRequestManager18=function(){"use strict";clearTimeout(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=null,this.$VideoUploadStartRequestManager11=this.__getVideoUploadRequest(this.$VideoUploadStartRequestManager1).setAllowCrossOrigin(!0).setData(this.__getDataToSend(this.$VideoUploadStartRequestManager13,this.$VideoUploadStartRequestManager15)).setWaterfallID(this.$VideoUploadStartRequestManager13.getWaterfallID()).setSuccessHandler(this.$VideoUploadStartRequestManager20.bind(this)).setErrorHandler(this.$VideoUploadStartRequestManager21.bind(this)).setTransportErrorHandler(this.$VideoUploadStartRequestManager22.bind(this)),this.$VideoUploadStartRequestManager11.send()};a.prototype.__getVideoUploadRequest=function(a){"use strict";return new(b("VideoUploadRequest"))(a)};a.prototype.__getDataToSend=function(a,b){"use strict";return{file_size:a.getFile().getSize(),file_extension:a.getFile().getExtension(),target_id:a.getTargetID(),source:a.getSource(),composer_dialog_version:a.getComposerDialogVersion(),waterfall_id:a.getWaterfallID(),composer_entry_point_ref:a.getComposerEntryPointRef&&a.getComposerEntryPointRef(),has_file_been_replaced:a.getHasFileBeenReplaced(),supports_chunking:a.getSupportsChunking(),supports_file_api:a.getSupportsFileAPI(),partition_start_offset:a.getPartitionStartOffset(),partition_end_offset:a.getPartitionEndOffset(),creator_product:a.getCreatorProduct(),original_file_hash:b,spherical:a.getIsSphericalVideo(),spherical_metadata:a.getSphericalMetadata()}};a.prototype.cancelRequest=function(){"use strict";this.$VideoUploadStartRequestManager23()};a.prototype.$VideoUploadStartRequestManager24=function(a){"use strict";clearTimeout(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=setTimeout(this.$VideoUploadStartRequestManager18.bind(this),a)};a.prototype.$VideoUploadStartRequestManager23=function(){"use strict";this.$VideoUploadStartRequestManager12&&(this.$VideoUploadStartRequestManager12.destroy(),this.$VideoUploadStartRequestManager12=null),this.$VideoUploadStartRequestManager11&&(this.$VideoUploadStartRequestManager11.abort(),this.$VideoUploadStartRequestManager11=null),this.$VideoUploadStartRequestManager10=0,this.$VideoUploadStartRequestManager5=0,this.$VideoUploadStartRequestManager13=null,clearTimeout(this.$VideoUploadStartRequestManager19),this.$VideoUploadStartRequestManager19=null};a.prototype.$VideoUploadStartRequestManager25=function(a,b,c){"use strict";a=Math.pow(a,b)*1e3;c>0&&(a=Math.min(a,c));return a};a.prototype.$VideoUploadStartRequestManager20=function(a){"use strict";a=a.getPayload();this.inform("request-finished",this.__getSuccessInformData(a));this.$VideoUploadStartRequestManager11=null;b("Assert").isTrue(this.$VideoUploadStartRequestManager12==null,"Unexpected: if file hasher is not null, clean up is required.")};a.prototype.__getSuccessInformData=function(a){"use strict";return{video_id:a.video_id,upload_session_id:a.upload_session_id,fb_region:a.region_hint,start_offset:a.start_offset,end_offset:a.end_offset,transport_retries:this.$VideoUploadStartRequestManager5,server_retries:this.$VideoUploadStartRequestManager10,skip_upload:a.skip_upload,hash_time:this.$VideoUploadStartRequestManager14}};a.prototype.$VideoUploadStartRequestManager26=function(a){"use strict";this.inform("request-failed",this.$VideoUploadStartRequestManager27(a)),this.$VideoUploadStartRequestManager11=null,b("Assert").isTrue(this.$VideoUploadStartRequestManager12==null,"Unexpected: if file hasher is not null, clean up is required.")};a.prototype.$VideoUploadStartRequestManager21=function(a){"use strict";this.$VideoUploadStartRequestManager11=null,this.$VideoUploadStartRequestManager5=0,a.isTransient()&&this.$VideoUploadStartRequestManager10<this.$VideoUploadStartRequestManager8?(this.$VideoUploadStartRequestManager10++,this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager25(this.$VideoUploadStartRequestManager9,this.$VideoUploadStartRequestManager10))):this.$VideoUploadStartRequestManager26(a)};a.prototype.$VideoUploadStartRequestManager22=function(a){"use strict";this.$VideoUploadStartRequestManager2===0||this.$VideoUploadStartRequestManager5>=this.$VideoUploadStartRequestManager2?this.$VideoUploadStartRequestManager26(a):(this.$VideoUploadStartRequestManager5++,this.$VideoUploadStartRequestManager11=null,this.$VideoUploadStartRequestManager24(this.$VideoUploadStartRequestManager25(this.$VideoUploadStartRequestManager3,this.$VideoUploadStartRequestManager5,this.$VideoUploadStartRequestManager4)))};a.prototype.$VideoUploadStartRequestManager27=function(a){"use strict";return{error_code:a.getError(),error_description:a.getErrorDescription(),error_summary:a.getErrorSummary(),transport_retries:this.$VideoUploadStartRequestManager5,server_retries:this.$VideoUploadStartRequestManager10,error_is_transient:a.isTransient()}};e.exports=a}),null);
__d("VideoUploadSession",["ArbiterMixin","AsyncRequest","VideoUploadCrashMonitor","VideoUploadFeatureDetector","VideoUploadFileValidator","VideoUploadLogger","VideoUploadMetadataParser","VideoUploadPostRequestManager","VideoUploadReceiveRequestManager","VideoUploadRequestContext","VideoUploadStartRequestManager","WaterfallIDGenerator","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g;a=babelHelpers.inherits(h,b("mixin")(b("ArbiterMixin")));g=a&&a.prototype;function h(a){"use strict";__p&&__p();g.constructor.call(this);this.$VideoUploadSession1=a.source;this.$VideoUploadSession2=a.composer_dialog_version;this.$VideoUploadSession3=a.target_id;this.$VideoUploadSession4=a.logging_delay;this.$VideoUploadSession5=a.silent_file_validation;this.$VideoUploadSession6=a.background_upload;this.$VideoUploadSession7=a.actor_id;this.$VideoUploadSession8=a.composer_entry_point_ref;this.$VideoUploadSession9=a.monitor_crashes;this.$VideoUploadSession10=a.isMultiMediaPost;this.$VideoUploadSession11=a.container_type;this.$VideoUploadSession12=a.number_of_partitions;this.$VideoUploadSession13=a.multi_partitioning_enabled;this.$VideoUploadSession14=a.change_default_chunk_size;this.$VideoUploadSession15=a.has_file_been_replaced?a.has_file_been_replaced:!1;this.$VideoUploadSession14&&(this.$VideoUploadSession16=a.client_chunk_size);this.$VideoUploadSession17=a.early_receive;this.$VideoUploadSession18=!1;this.$VideoUploadSession19=a.accept_dimensions_from_player;this.$VideoUploadSession20=new(b("VideoUploadFileValidator"))({minSize:a.min_size,maxSize:a.max_size,minLength:a.min_length,maxLength:a.max_length,minWidth:a.min_width,minHeight:a.min_height,extensions:a.extensions,source:a.source,require16to9AspectRatio:a.require_16to9_aspect_ratio,minAspectRatio:a.min_aspect_ratio,maxAspectRatio:a.max_aspect_ratio,acceptDimensionsFromPlayer:a.accept_dimensions_from_player});this.$VideoUploadSession21=b("VideoUploadFeatureDetector").supportsChunking();this.$VideoUploadSession22=b("VideoUploadFeatureDetector").supportsFileAPI();this.$VideoUploadSession21?(this.$VideoUploadSession23=a.parallel_chunk_uploads,this.$VideoUploadSession23&&(this.$VideoUploadSession24=a.parallel_chunk_upload_filesize,this.$VideoUploadSession25=a.default_chunk_size)):this.$VideoUploadSession23=!1;this.$VideoUploadSession26=this.$VideoUploadSession27(a);this.$VideoUploadSession28=this.$VideoUploadSession29(a);if(this.$VideoUploadSession23)if(this.$VideoUploadSession13){var c=0;this.$VideoUploadSession30=[];for(c=0;c<this.$VideoUploadSession12-1;c++)this.$VideoUploadSession30[c]=this.$VideoUploadSession29(a)}else this.$VideoUploadSession30=this.$VideoUploadSession29(a);this.$VideoUploadSession31=this.$VideoUploadSession32(a);this.$VideoUploadSession33=a.log_free_local_storage}h.prototype.$VideoUploadSession34=function(){"use strict";this.$VideoUploadSession35=[];this.$VideoUploadSession36=[];this.$VideoUploadSession37=[];this.$VideoUploadSession38=[];this.$VideoUploadSession39=[];var a=0;for(a=0;a<this.$VideoUploadSession40-1;a++)this.$VideoUploadSession35.push(!1)};h.prototype.$VideoUploadSession41=function(){"use strict";this.$VideoUploadSession42=b("WaterfallIDGenerator").generate(),this.$VideoUploadSession43=new(b("VideoUploadLogger"))({actor_id:this.$VideoUploadSession7,source:this.$VideoUploadSession1,composer_dialog_version:this.$VideoUploadSession2,waterfall_id:this.$VideoUploadSession42,target_id:this.$VideoUploadSession3,delay:this.$VideoUploadSession4,is_chunked_upload:this.$VideoUploadSession21,composer_entry_point_ref:this.$VideoUploadSession8,container_type:this.$VideoUploadSession11,has_file_been_replaced:this.$VideoUploadSession15}),this.inform("set-waterfall-id",{waterfallID:this.$VideoUploadSession42})};h.prototype.createTestLogger=function(){"use strict";this.$VideoUploadSession41()};h.prototype.getLogger=function(){"use strict";return!this.$VideoUploadSession43?null:this.$VideoUploadSession43};h.prototype.start=function(a){"use strict";__p&&__p();this.$VideoUploadSession44=null;this.$VideoUploadSession45=null;this.$VideoUploadSession46=null;this.$VideoUploadSession47=!1;this.$VideoUploadSession48=!1;this.$VideoUploadSession49=a;this.$VideoUploadSession50=0;this.$VideoUploadSession51=!1;this.$VideoUploadSession52={sphericalMetadataXml:null,fbSpatialAudioMetadataXml:null,ytSa3dMetadataJson:null};this.$VideoUploadSession53=!1;this.$VideoUploadSession41();this.$VideoUploadSession13&&(this.$VideoUploadSession40=Math.min(this.$VideoUploadSession12,Math.ceil(this.$VideoUploadSession49.getSize()/this.$VideoUploadSession24)));this.__logEvent(b("VideoUploadLogger").EVENT_REQUESTED_UPLOADING);this.inform("upload-requested");a=new(b("VideoUploadMetadataParser"))(this.$VideoUploadSession49,this.$VideoUploadSession54.bind(this),this.$VideoUploadSession19);a.parse();this.$VideoUploadSession33&&navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota(function(a,c){this.__logEvent(b("VideoUploadLogger").EVENT_MEASURE_FREE_LOCAL_STORAGE,{free_space_in_device:c})}.bind(this))};h.prototype.setTargetID=function(a){"use strict";this.$VideoUploadSession3=a};h.prototype.post=function(a){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_POST_REQUEST);this.inform("post-started",a);var c=this.__createPostRequestContext(a);this.$VideoUploadSession31.sendRequest(c);this.$VideoUploadSession55=a};h.prototype.__createPostRequestContext=function(a){"use strict";var c=new(b("VideoUploadRequestContext"))();this.__setupPostRequestContext(c,a);return c};h.prototype.__setupPostRequestContext=function(a,b){"use strict";a.setMetadata(b).setVideoID(this.$VideoUploadSession44).setTargetID(this.$VideoUploadSession3).setSource(this.$VideoUploadSession1).setComposerDialogVersion(this.$VideoUploadSession2).setWaterfallID(this.$VideoUploadSession42).setSupportsChunking(this.$VideoUploadSession21).setCreatorProduct(this.$VideoUploadSession49.getCreatorProduct()).setFile(this.$VideoUploadSession49).setHasFileBeenReplaced(this.$VideoUploadSession15),b&&(b.spherical&&(this.$VideoUploadSession51=!0,a.setIsSphericalVideo(this.$VideoUploadSession51)),b.enable_omnistab&&(this.$VideoUploadSession53=!0,a.setEnableOmnistab(this.$VideoUploadSession53))),a.setComposerEntryPointRef&&a.setComposerEntryPointRef(this.$VideoUploadSession8)};h.prototype.cancel=function(a){a===void 0&&(a=!1);if(this.$VideoUploadSession47){var c=this.__fetchReceiveRequestManagerStateLogData();this.$VideoUploadSession56();this.$VideoUploadSession6?(this.$VideoUploadSession48||this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_UPLOADING),this.$VideoUploadSession57&&(this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,c),this.$VideoUploadSession57=!1)):(this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_UPLOADING),this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,c))}else a&&this.$VideoUploadSession44&&h.deleteVideo(this.$VideoUploadSession44)};h.prototype.abandon=function(a){a===void 0&&(a=!1);if(this.$VideoUploadSession47){var c=this.__fetchReceiveRequestManagerStateLogData();this.$VideoUploadSession56();this.$VideoUploadSession6?(this.$VideoUploadSession48||this.__logEvent(b("VideoUploadLogger").EVENT_ABANDONED_UPLOADING),this.$VideoUploadSession57&&(this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,c),this.$VideoUploadSession57=!1)):(this.__logEvent(b("VideoUploadLogger").EVENT_ABANDONED_UPLOADING),this.__logEvent(b("VideoUploadLogger").EVENT_CANCELED_FLOW,c))}else a&&this.$VideoUploadSession44&&h.deleteVideo(this.$VideoUploadSession44)};h.prototype.isPostInProgress=function(){"use strict";return this.$VideoUploadSession31.isInProgress()};h.prototype.isInProgress=function(){"use strict";return this.$VideoUploadSession47};h.prototype.getHasUploadFinished=function(){"use strict";return this.$VideoUploadSession48};h.prototype.getVideoID=function(){"use strict";return this.$VideoUploadSession44};h.prototype.getUploadTime=function(){"use strict";return this.$VideoUploadSession58};h.prototype.getExPartitionNumber=function(a){"use strict";var b;for(b=0;b<this.$VideoUploadSession40-1;b++)if(a>=this.$VideoUploadSession36[b]&&a<this.$VideoUploadSession37[b])break;return b===this.$VideoUploadSession40?-1:b};h.prototype.startFlow=function(){"use strict";if(!this.$VideoUploadSession6||this.$VideoUploadSession57)return;this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_FLOW,{is_spherical:this.$VideoUploadSession51?"true":null});this.$VideoUploadSession57=!0;this.$VideoUploadSession59&&this.$VideoUploadSession59.flowStarted()};h.prototype.$VideoUploadSession54=function(a){"use strict";__p&&__p();var c;if(this.$VideoUploadSession5){var d=this.$VideoUploadSession20.getValidationErrorMessage(this.$VideoUploadSession49,a);d?(c={error_summary:d.summary,error_description:d.description},d=!1):d=!0}else d=this.$VideoUploadSession20.validate(this.$VideoUploadSession49,a);if(!d){this.__logEvent(b("VideoUploadLogger").EVENT_INVALIDATED_UPLOADING);this.inform("upload-failed",c);return}a&&a.format&&(this.$VideoUploadSession51=a.format.isSpherical,a.metadata&&(this.$VideoUploadSession52.sphericalMetadataXml=a.metadata.sphericalMetadataXml,this.$VideoUploadSession52.fbSpatialAudioMetadataXml=a.metadata.fbSpatialAudioMetadataXml,this.$VideoUploadSession52.ytSa3dMetadataJson=a.metadata.ytSa3dMetadataJson));this.$VideoUploadSession6||this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_FLOW,{is_spherical:this.$VideoUploadSession51?"true":null});this.$VideoUploadSession60=this.$VideoUploadSession23&&this.$VideoUploadSession49.getSize()>=this.$VideoUploadSession24;this.$VideoUploadSession61=!1;this.$VideoUploadSession62=0;this.$VideoUploadSession63=this.$VideoUploadSession62;this.$VideoUploadSession64=0;this.$VideoUploadSession13?this.$VideoUploadSession34():this.$VideoUploadSession35=!1;if(this.$VideoUploadSession60)if(this.$VideoUploadSession13){d=0;this.$VideoUploadSession65=Math.ceil(this.$VideoUploadSession49.getSize()/this.$VideoUploadSession40);var e=this.$VideoUploadSession65,f=this.$VideoUploadSession65;for(d=0;d<this.$VideoUploadSession40-1;d++)this.$VideoUploadSession36[d]=e,e=Math.min(this.$VideoUploadSession36[d]+f,this.$VideoUploadSession49.getSize()),this.$VideoUploadSession37[d]=e,this.$VideoUploadSession38[d]=this.$VideoUploadSession36[d],this.$VideoUploadSession39[d]=0}else this.$VideoUploadSession65=Math.floor(this.$VideoUploadSession49.getSize()/2),this.$VideoUploadSession36=this.$VideoUploadSession65,this.$VideoUploadSession38=this.$VideoUploadSession36,this.$VideoUploadSession39=0,this.$VideoUploadSession37=this.$VideoUploadSession49.getSize();else this.$VideoUploadSession65=this.$VideoUploadSession49.getSize();d=new(b("VideoUploadRequestContext"))().setFile(this.$VideoUploadSession49).setTargetID(this.$VideoUploadSession3).setSource(this.$VideoUploadSession1).setComposerDialogVersion(this.$VideoUploadSession2).setWaterfallID(this.$VideoUploadSession42).setHasFileBeenReplaced(this.$VideoUploadSession15).setSupportsChunking(this.$VideoUploadSession21).setSupportsFileAPI(this.$VideoUploadSession22).setCreatorProduct(this.$VideoUploadSession49.getCreatorProduct()).setPartitionStartOffset(this.$VideoUploadSession62).setPartitionEndOffset(this.$VideoUploadSession65);this.$VideoUploadSession23&&d.setUseParallelChunks(this.$VideoUploadSession23);this.$VideoUploadSession51&&(d.setIsSphericalVideo(this.$VideoUploadSession51),d.setSphericalMetadata(this.$VideoUploadSession52));d.setComposerEntryPointRef&&d.setComposerEntryPointRef(this.$VideoUploadSession8);this.$VideoUploadSession66();this.$VideoUploadSession26.sendRequest(d);this.$VideoUploadSession17&&this.$VideoUploadSession14&&this.$VideoUploadSession28.isResumabilityEnabled()&&!this.$VideoUploadSession28.isResumableServiceProxyReceiveEnabled()&&this.$VideoUploadSession67();this.inform("metadata-parsed",a)};h.prototype.$VideoUploadSession27=function(a){"use strict";var b=this.$VideoUploadSession21?a.chunk_start_uri:a.start_uri;b=this.__getVideoUploadStartRequestManager(b,a.start_max_transport_retries,a.start_transport_retry_interval_base,a.start_max_transport_retry_timeout,a.skip_upload_enabled,a.skip_upload_file_size_limit,a.start_max_server_retries,a.start_server_retry_interval_base);b.subscribe("request-started",this.$VideoUploadSession68.bind(this));b.subscribe("request-finished",this.$VideoUploadSession69.bind(this));b.subscribe("request-failed",this.$VideoUploadSession70.bind(this));return b};h.prototype.$VideoUploadSession29=function(a){"use strict";__p&&__p();var b=this.$VideoUploadSession21?a.chunk_receive_uri:a.receive_uri;b=this.__getVideoUploadReceiveRequestManager(b,a);b.subscribe("request-started",this.$VideoUploadSession71.bind(this));b.subscribe("request-progressed",this.$VideoUploadSession72.bind(this));b.subscribe("request-finished",this.$VideoUploadSession73.bind(this));b.subscribe("request-failed",this.$VideoUploadSession74.bind(this));b.subscribe("request-timeout",this.$VideoUploadSession75.bind(this));b.subscribe("online",this.$VideoUploadSession76.bind(this));b.subscribe("offline",this.$VideoUploadSession77.bind(this));b.subscribe("resumable-called",this.$VideoUploadSession78.bind(this));b.subscribe("resumable-started",this.$VideoUploadSession79.bind(this));b.subscribe("resumable-success",this.$VideoUploadSession80.bind(this));b.subscribe("resumable-failed",this.$VideoUploadSession81.bind(this));return b};h.prototype.$VideoUploadSession32=function(a){"use strict";var b=this.$VideoUploadSession21?a.chunk_post_uri:a.post_uri;b=this.__getVideoUploadPostRequestManager(b,a);b.subscribe("request-finished",this.__handlePostRequestFinished.bind(this));b.subscribe("request-failed",this.$VideoUploadSession82.bind(this));return b};h.prototype.$VideoUploadSession68=function(a,c){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_UPLOADING,{hash_time:c.hash_time,hash_exception:c.hash_exception}),this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_START_REQUEST),this.$VideoUploadSession83=Date.now(),this.inform("upload-started")};h.prototype.$VideoUploadSession67=function(a){"use strict";__p&&__p();if(!this.$VideoUploadSession18){this.$VideoUploadSession18=!0;a||(a={video_id:null});var b;b=this.__createReceiveRequestContext(a,!1);this.$VideoUploadSession28.sendRequest(b);if(this.$VideoUploadSession60)if(this.$VideoUploadSession13){var c=0;for(c=0;c<this.$VideoUploadSession40-1;c++)b=this.__createReceiveRequestContext(a,!0,c),this.$VideoUploadSession30[c].sendRequest(b)}else b=this.__createReceiveRequestContext(a,!0),this.$VideoUploadSession30.sendRequest(b)}else this.$VideoUploadSession84()};h.prototype.$VideoUploadSession84=function(){"use strict";this.$VideoUploadSession28.updateVideoID(this.$VideoUploadSession44);if(this.$VideoUploadSession60)if(this.$VideoUploadSession13){var a=0;for(a=0;a<this.$VideoUploadSession40-1;a++)this.$VideoUploadSession30[a].updateVideoID(this.$VideoUploadSession44)}else this.$VideoUploadSession30.updateVideoID(this.$VideoUploadSession44)};h.prototype.$VideoUploadSession69=function(a,c){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_PROGRESS_UPLOADING_START_REQUEST,{transport_retries:c.transport_retries,hash_time:c.hash_time,skip_upload:c.skip_upload?1:null}),this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_START_REQUEST),this.$VideoUploadSession44=c.video_id,this.$VideoUploadSession45=c.upload_session_id,this.$VideoUploadSession46=c.fb_region,this.$VideoUploadSession85=c.skip_upload,!c.skip_upload?this.$VideoUploadSession67(c):(this.$VideoUploadSession86(),this.inform("upload-progressed",{start_offset:0,end_offset:this.$VideoUploadSession49.getSize(),file_size:this.$VideoUploadSession49.getSize(),sent_bytes:this.$VideoUploadSession49.getSize(),video_id:c.video_id,skip_upload:c.skip_upload}),this.$VideoUploadSession6&&this.__logFinishedUploading(),this.inform("upload-finished",{start_offset:0,end_offset:this.$VideoUploadSession49.getSize(),video_id:c.video_id,is_spherical_video:this.$VideoUploadSession51}))};h.prototype.__fetchReceiveRequestManagerStateLogData=function(){"use strict";__p&&__p();var a={};this.$VideoUploadSession28!=null&&(this.$VideoUploadSession28.appendStateLogData(a,"requestManager_"),a.request_manager_state=a.requestManager_last_log_state);if(this.$VideoUploadSession13){var b=0;for(b=0;b<this.$VideoUploadSession40-1;b++)this.$VideoUploadSession30[b]!=null&&this.$VideoUploadSession30[b].appendStateLogData(a,"requestManagerEx_"+b.toString())}else this.$VideoUploadSession30!=null&&this.$VideoUploadSession30.appendStateLogData(a,"requestManagerEx_");return a};h.prototype.__createReceiveRequestContext=function(a,c,d){"use strict";c||(c=!1);var e=new(b("VideoUploadRequestContext"))();this.$VideoUploadSession13?this.__setupReceiveRequestContext(e,a,c,d):this.__setupReceiveRequestContext(e,a,c);return e};h.prototype.__setupReceiveRequestContext=function(a,b,c,d){"use strict";var e,f,g;!c?(c=this.$VideoUploadSession62,e=this.$VideoUploadSession65,this.$VideoUploadSession14?(f=this.$VideoUploadSession62,g=this.$VideoUploadSession16?Math.min(this.$VideoUploadSession16,this.$VideoUploadSession65):this.$VideoUploadSession65):(f=b.start_offset,g=b.end_offset)):this.$VideoUploadSession13?(this.$VideoUploadSession14&&(this.$VideoUploadSession25=this.$VideoUploadSession37[d]-this.$VideoUploadSession36[d],this.$VideoUploadSession25=this.$VideoUploadSession16?Math.min(this.$VideoUploadSession16,this.$VideoUploadSession25):this.$VideoUploadSession25),c=this.$VideoUploadSession36[d],e=this.$VideoUploadSession37[d],f=this.$VideoUploadSession36[d],g=this.$VideoUploadSession36[d]+this.$VideoUploadSession25>=this.$VideoUploadSession37[d]?this.$VideoUploadSession37[d]:this.$VideoUploadSession36[d]+this.$VideoUploadSession25):(this.$VideoUploadSession14&&(this.$VideoUploadSession25=this.$VideoUploadSession37-this.$VideoUploadSession36,this.$VideoUploadSession25=this.$VideoUploadSession16?Math.min(this.$VideoUploadSession16,this.$VideoUploadSession25):this.$VideoUploadSession25),c=this.$VideoUploadSession36,e=this.$VideoUploadSession37,f=this.$VideoUploadSession36,g=this.$VideoUploadSession36+this.$VideoUploadSession25>=this.$VideoUploadSession37?this.$VideoUploadSession37:this.$VideoUploadSession36+this.$VideoUploadSession25);a.setFile(this.$VideoUploadSession49).setVideoID(b.video_id).setUploadSessionID(b.upload_session_id).setFbRegion(b.fb_region).setStartOffset(f).setEndOffset(g).setPartitionStartOffset(c).setPartitionEndOffset(e).setTargetID(this.$VideoUploadSession3).setSource(this.$VideoUploadSession1).setComposerDialogVersion(this.$VideoUploadSession2).setWaterfallID(this.$VideoUploadSession42).setSupportsChunking(this.$VideoUploadSession21).setHasFileBeenReplaced(this.$VideoUploadSession15);this.$VideoUploadSession23&&a.setUseParallelChunks(this.$VideoUploadSession23);a.setComposerEntryPointRef&&a.setComposerEntryPointRef(this.$VideoUploadSession8);this.$VideoUploadSession16&&a.setClientChunkSize(this.$VideoUploadSession16)};h.prototype.$VideoUploadSession70=function(a,c){"use strict";a=this.__getLogErrorData(c);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_START_REQUEST,a);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,a);a=c.error_is_transient?b("VideoUploadLogger").EVENT_RESIGNED_FLOW:b("VideoUploadLogger").EVENT_FAILED_FLOW;this.$VideoUploadSession6?this.$VideoUploadSession57&&(this.__logEvent(a),this.$VideoUploadSession57=!1):this.__logEvent(a);this.$VideoUploadSession86();this.$VideoUploadSession87();this.inform("upload-failed",c)};h.prototype.$VideoUploadSession71=function(a,c){"use strict";!c.start_offset&&!c.transport_retries&&!c.server_retries&&this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_SENDING_BYTES,{total_bytes:this.$VideoUploadSession49.getSize()}),this.$VideoUploadSession21&&this.__logEvent(b("VideoUploadLogger").EVENT_STARTED_SENDING_CHUNK_BYTES,{start_offset:c.start_offset,total_bytes:c.end_offset-c.start_offset,transport_retries:c.transport_retries,server_retries:c.server_retries,upload_speed:c.upload_speed,request_manager_state:c.request_manager_state})};h.prototype.$VideoUploadSession72=function(a,b){"use strict";__p&&__p();if(b.start_offset<this.$VideoUploadSession65)this.$VideoUploadSession63=b.start_offset,this.$VideoUploadSession64=b.sent_bytes;else if(this.$VideoUploadSession13){a=this.getExPartitionNumber(b.start_offset);a>-1&&(this.$VideoUploadSession38[a]=b.start_offset,this.$VideoUploadSession39[a]=b.sent_bytes)}else this.$VideoUploadSession38=b.start_offset,this.$VideoUploadSession39=b.sent_bytes;b.start_offset=this.$VideoUploadSession63;b.sent_bytes=this.$VideoUploadSession64;if(this.$VideoUploadSession60)if(this.$VideoUploadSession13)for(a=0;a<this.$VideoUploadSession40-1;a++)b.start_offset+=this.$VideoUploadSession38[a]-this.$VideoUploadSession36[a],b.sent_bytes+=this.$VideoUploadSession39[a];else b.start_offset+=this.$VideoUploadSession38-this.$VideoUploadSession36,b.sent_bytes+=this.$VideoUploadSession39;a=Math.min(b.start_offset+b.sent_bytes,b.file_size);a>this.$VideoUploadSession50&&(this.$VideoUploadSession50=a,this.inform("upload-progressed",b))};h.prototype.$VideoUploadSession73=function(a,c){"use strict";__p&&__p();this.$VideoUploadSession21&&this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_SENDING_CHUNK_BYTES,{start_offset:c.start_offset,sent_bytes:c.end_offset-c.start_offset,transport_retries:c.transport_retries,server_retries:c.server_retries,upload_speed:c.upload_speed,request_manager_state:c.request_manager_state});a=!1;if(c.start_offset<this.$VideoUploadSession65)this.$VideoUploadSession61=c.end_offset>=this.$VideoUploadSession65;else if(this.$VideoUploadSession13){var d;d=this.getExPartitionNumber(c.start_offset);if(d===-1){var e={error_summary:"Invalid offset",error_description:"Offset doesn't fall in any exPartition range."};this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING);this.inform("upload-failed",e);return}this.$VideoUploadSession35[d]=c.end_offset>=this.$VideoUploadSession37[d]}else this.$VideoUploadSession35=c.end_offset>=this.$VideoUploadSession37;if(this.$VideoUploadSession13)for(d=0;d<this.$VideoUploadSession40-1;d++)if(this.$VideoUploadSession35[d]===!1){a=!1;break}else a=!0;else a=this.$VideoUploadSession35;(!this.$VideoUploadSession22||this.$VideoUploadSession61&&(!this.$VideoUploadSession60||a))&&(this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_SENDING_BYTES,{sent_bytes:this.$VideoUploadSession49.getSize()}),this.$VideoUploadSession58=Date.now()-this.$VideoUploadSession83,this.$VideoUploadSession6&&this.__logFinishedUploading(),c.video_id=this.$VideoUploadSession44,c.is_spherical_video=this.$VideoUploadSession51,this.inform("upload-finished",c),this.$VideoUploadSession10&&(this.$VideoUploadSession6||this.__logFinishedUploading(),this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_FLOW,c),this.$VideoUploadSession57=!1,this.$VideoUploadSession87(),this.inform("multimedia-upload-finished",c)))};h.prototype.$VideoUploadSession74=function(a,c){"use strict";a=this.__getLogErrorData(c);this.$VideoUploadSession21&&this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_SENDING_CHUNK_BYTES,a);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,a);var d=c.error_is_transient?b("VideoUploadLogger").EVENT_RESIGNED_FLOW:b("VideoUploadLogger").EVENT_FAILED_FLOW;this.$VideoUploadSession6?this.$VideoUploadSession57&&(this.__logEvent(d,a),this.$VideoUploadSession57=!1):this.__logEvent(d,a);this.$VideoUploadSession87();this.inform("upload-failed",c)};h.prototype.$VideoUploadSession75=function(a,c){"use strict";a={start_offset:c.start_offset,sent_bytes:c.end_offset-c.start_offset,transport_retries:c.transport_retries,server_retries:c.server_retries,timeout_retries:c.timeout_retries,upload_speed:c.upload_speed,request_manager_state:c.request_manager_state};this.__logEvent(b("VideoUploadLogger").EVENT_TIMEOUT_SENDING_CHUNK_BYTES,a)};h.prototype.$VideoUploadSession76=function(a,b){"use strict";this.inform("online",b)};h.prototype.$VideoUploadSession77=function(a,b){"use strict";this.inform("offline",b)};h.prototype.$VideoUploadSession78=function(a,c){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_CALLED,c)};h.prototype.$VideoUploadSession79=function(a,c){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_STARTED,c)};h.prototype.$VideoUploadSession80=function(a,c){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_SUCCESS,c)};h.prototype.$VideoUploadSession81=function(a,c){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_RESUMABLE_FAILED,c)};h.prototype.__handlePostRequestFinished=function(a,c){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_POST_REQUEST);c.video_id||(c.video_id=this.$VideoUploadSession44);this.$VideoUploadSession6||this.__logFinishedUploading();this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_FLOW);this.$VideoUploadSession57=!1;this.$VideoUploadSession87();a=babelHelpers["extends"]({},c,this.$VideoUploadSession55);this.inform("post-finished",a)};h.prototype.__logFinishedUploading=function(){"use strict";this.__logEvent(b("VideoUploadLogger").EVENT_FINISHED_UPLOADING,{elapsed_time:this.$VideoUploadSession58,skip_upload:this.$VideoUploadSession85?1:null}),this.$VideoUploadSession48=!0};h.prototype.$VideoUploadSession82=function(a,c){"use strict";__p&&__p();a=this.__getLogErrorData(c);this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_POST_REQUEST,a);if(this.$VideoUploadSession47){this.__logEvent(b("VideoUploadLogger").EVENT_FAILED_UPLOADING,a);var d=c.error_is_transient?b("VideoUploadLogger").EVENT_RESIGNED_FLOW:b("VideoUploadLogger").EVENT_FAILED_FLOW;this.__logEvent(d,a)}this.$VideoUploadSession87();this.inform("post-failed",c)};h.prototype.$VideoUploadSession86=function(){"use strict";__p&&__p();this.$VideoUploadSession28.cancelRequest();if(this.$VideoUploadSession60)if(this.$VideoUploadSession13){var a=0;for(a=0;a<this.$VideoUploadSession40-1;a++)this.$VideoUploadSession30[a].cancelRequest()}else this.$VideoUploadSession30.cancelRequest();this.$VideoUploadSession18=!1};h.prototype.$VideoUploadSession56=function(){"use strict";this.$VideoUploadSession26.cancelRequest(),this.$VideoUploadSession86(),this.$VideoUploadSession87(),this.$VideoUploadSession44&&(h.deleteVideo(this.$VideoUploadSession44),this.$VideoUploadSession44=null,this.$VideoUploadSession45=null,this.$VideoUploadSession46=null)};h.prototype.$VideoUploadSession66=function(){"use strict";this.$VideoUploadSession47=!0,this.$VideoUploadSession9&&(this.$VideoUploadSession59=new(b("VideoUploadCrashMonitor"))(this.$VideoUploadSession42,this.$VideoUploadSession7,this.$VideoUploadSession1,this.$VideoUploadSession3,this.$VideoUploadSession4,this.$VideoUploadSession21,this.$VideoUploadSession8,!this.$VideoUploadSession6||this.$VideoUploadSession57),this.$VideoUploadSession59.startSession())};h.prototype.$VideoUploadSession87=function(){"use strict";this.$VideoUploadSession47=!1,this.$VideoUploadSession59&&(this.$VideoUploadSession59.endSession(),this.$VideoUploadSession59=null)};h.prototype.__getLogErrorData=function(a){"use strict";return{error:a.error_summary,error_code:a.error_code,error_description:a.error_description,transport_retries:a.transport_retries,server_retries:a.server_retries,request_manager_state:a.request_manager_state}};h.prototype.__logEvent=function(a,b){"use strict";var c=this.getLogger();b=b||{};this.$VideoUploadSession49&&(b.file_size=this.$VideoUploadSession49.getSize(),b.file_extension=this.$VideoUploadSession49.getExtension(),b.sent_bytes=this.$VideoUploadSession50);c.logEvent(a,b)};h.prototype.__getVideoUploadStartRequestManager=function(a,c,d,e,f,g,h,i){"use strict";return new(b("VideoUploadStartRequestManager"))(a,c,d,e,f,g,h,i)};h.prototype.__getVideoUploadReceiveRequestManager=function(a,c){"use strict";return new(b("VideoUploadReceiveRequestManager"))(a,c.max_transport_retries,c.max_transport_retry_timeout,c.max_server_retries,c.response_timeout_enabled,c.max_response_timeout_retries,c.response_timeout_speed_variation_factor_ppt,c.transport_retry_interval_base,c.server_retry_interval_base,c.receive_errors_force_retry,c.access_token,c.resumability_enabled,c.resumability_async_enabled,c.resumable_service_override,c.datr,c.resumability_min_file_size,c.resumable_service_proxy_receive,c.resumable_reset_transport_retries_on_progress,c.add_flow_capture_header)};h.prototype.__getVideoUploadPostRequestManager=function(a,c){"use strict";return new(b("VideoUploadPostRequestManager"))(a,c.post_max_transport_retries,c.post_transport_retry_interval_base,c.post_max_server_retries,c.post_server_retry_interval_base)};h.deleteVideo=function(a){"use strict";a=new(b("AsyncRequest"))("/ajax/video/actions/delete").setData({fbid:a,redirect:!1});a.setErrorHandler(function(){});a.send()};e.exports=h}),null);
__d("VideoUploader",["ArbiterMixin","VideoUploadCrashMonitor","VideoUploadSession","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this),this.$VideoUploader1=a,this.$VideoUploader2=null,this.$VideoUploader3=null,a.monitor_crashes&&(this.$VideoUploader4=new(b("VideoUploadCrashMonitor"))(),this.$VideoUploader4.logKnownCrashes())}a.prototype.getLogger=function(){"use strict";if(!this.$VideoUploader2)return;if(this.$VideoUploader2.getLogger)return this.$VideoUploader2.getLogger()};a.prototype.upload=function(a){"use strict";if(this.$VideoUploader2)return;var b=this.__getVideoUploadSession(this.$VideoUploader1);b.subscribe(this.__getEventsWhichShouldListenFromSession(),function(a,b){return this.$VideoUploader5(a,b)}.bind(this));b.start(a);this.$VideoUploader2=b};a.prototype.__getVideoUploadSession=function(a){"use strict";return new(b("VideoUploadSession"))(a)};a.prototype.__getEventsWhichShouldListenFromSession=function(){"use strict";return["upload-requested","upload-started","upload-progressed","upload-finished","upload-failed","post-started","post-finished","post-failed","online","offline","metadata-parsed","set-waterfall-id"]};a.prototype.postUserRequest=function(){"use strict";if(!this.$VideoUploader2)return;this.$VideoUploader2.startFlow&&this.$VideoUploader2.startFlow()};a.prototype.setTargetID=function(a){"use strict";if(this.$VideoUploader2==null)return;this.$VideoUploader2.setTargetID(a)};a.prototype.setHasFileBeenReplaced=function(a){"use strict";this.$VideoUploader1.has_file_been_replaced=a};a.prototype.post=function(a){"use strict";if(!this.$VideoUploader2)return;this.$VideoUploader2.post(a)};a.prototype.getVideoID=function(){"use strict";this.$VideoUploader2&&(this.$VideoUploader3=this.$VideoUploader2.getVideoID());return this.$VideoUploader3};a.prototype.cancel=function(a){a===void 0&&(a=!1);var c=this.getVideoID();this.$VideoUploader2?this.$VideoUploader2.cancel(a):a&&c&&b("VideoUploadSession").deleteVideo(c);this.reset()};a.prototype.abandon=function(a){a===void 0&&(a=!1);var c=this.getVideoID();this.$VideoUploader2?this.$VideoUploader2.abandon(a):a&&c&&b("VideoUploadSession").deleteVideo(c);this.reset()};a.prototype.reset=function(){"use strict";this.$VideoUploader2&&(this.$VideoUploader3=this.getVideoID()),this.$VideoUploader2=null};a.prototype.getUploadSession=function(){"use strict";return this.$VideoUploader2};a.prototype.getLoggerData=function(){"use strict";return{waterfall_id:this.$VideoUploader2?this.$VideoUploader2.$VideoUploader6:null,actor_id:this.$VideoUploader1.actor_id,target_id:this.$VideoUploader1.target_id,target_type:this.$VideoUploader1.target_type,composer_entry_point_ref:this.$VideoUploader1.composer_entry_point_ref}};a.prototype.isPostInProgress=function(){"use strict";return!!this.$VideoUploader2&&this.$VideoUploader2.isPostInProgress()};a.prototype.isSessionInProgress=function(){"use strict";return!!this.$VideoUploader2&&this.$VideoUploader2.isInProgress()};a.prototype.getUploadParameters=function(){"use strict";return this.$VideoUploader1};a.prototype.__getSession=function(){"use strict";return this.$VideoUploader2};a.prototype.__getEventsForWhichSessionShouldBeSetToNull=function(){"use strict";return["upload-failed","post-finished","multimedia-upload-finished"]};a.prototype.$VideoUploader5=function(a,b){"use strict";this.__getEventsForWhichSessionShouldBeSetToNull().includes(a)&&this.reset(),this.__delegateEvent(a,b)};a.prototype.__delegateEvent=function(a,b){"use strict";this.inform(a,b)};e.exports=a}),null);
__d("BlockMapBuilder",["immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("immutable").OrderedMap;a={createFromArray:function(a){return g(a.map(function(a){return[a.getKey(),a]}))}};e.exports=a}),null);
__d("CharacterMetadata",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").Map;a=b("immutable").OrderedSet;c=b("immutable").Record;var i=a();d={style:i,entity:null};f=c(d);g=babelHelpers.inherits(j,f);g&&g.prototype;j.prototype.getStyle=function(){return this.get("style")};j.prototype.getEntity=function(){return this.get("entity")};j.prototype.hasStyle=function(a){return this.getStyle().includes(a)};j.applyStyle=function(a,b){a=a.set("style",a.getStyle().add(b));return j.create(a)};j.removeStyle=function(a,b){a=a.set("style",a.getStyle().remove(b));return j.create(a)};j.applyEntity=function(a,b){a=a.getEntity()===b?a:a.set("entity",b);return j.create(a)};j.create=function(a){__p&&__p();if(!a)return k;var b={style:i,entity:null};b=h(b).merge(a);a=l.get(b);if(a)return a;a=new j(b);l=l.set(b,a);return a};function j(){g.apply(this,arguments)}var k=new j(),l=h([[h(d),k]]);j.EMPTY=k;e.exports=j}),null);
__d("findRangesImmutable",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b,c,d){if(!a.size)return;var e=0;a.reduce(function(a,f,g){b(a,f)||(c(a)&&d(e,g),e=g);return f});c(a.last())&&d(e,a.count())}e.exports=a}),null);
__d("ContentBlock",["CharacterMetadata","immutable","findRangesImmutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").List;c=b("immutable").Map;d=b("immutable").OrderedSet;f=b("immutable").Record;var i=b("immutable").Repeat,j=d();d={key:"",type:"unstyled",text:"",characterList:h(),depth:0,data:c()};c=f(d);var k=function(a){if(!a)return a;var c=a.characterList,d=a.text;d&&!c&&(a.characterList=h(i(b("CharacterMetadata").EMPTY,d.length)));return a};f=babelHelpers.inherits(a,c);g=f&&f.prototype;function a(a){g.constructor.call(this,k(a))}a.prototype.getKey=function(){return this.get("key")};a.prototype.getType=function(){return this.get("type")};a.prototype.getText=function(){return this.get("text")};a.prototype.getCharacterList=function(){return this.get("characterList")};a.prototype.getLength=function(){return this.getText().length};a.prototype.getDepth=function(){return this.get("depth")};a.prototype.getData=function(){return this.get("data")};a.prototype.getInlineStyleAt=function(a){a=this.getCharacterList().get(a);return a?a.getStyle():j};a.prototype.getEntityAt=function(a){a=this.getCharacterList().get(a);return a?a.getEntity():null};a.prototype.findStyleRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),l,a,c)};a.prototype.findEntityRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),m,a,c)};function l(a,b){return a.getStyle()===b.getStyle()}function m(a,b){return a.getEntity()===b.getEntity()}e.exports=a}),null);
__d("ContentBlockNode",["CharacterMetadata","immutable","findRangesImmutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").List;c=b("immutable").Map;d=b("immutable").OrderedSet;f=b("immutable").Record;var i=b("immutable").Repeat,j=d(),k={parent:null,characterList:h(),data:c(),depth:0,key:"",text:"",type:"unstyled",children:h(),prevSibling:null,nextSibling:null},l=function(a,b){return a.getStyle()===b.getStyle()},m=function(a,b){return a.getEntity()===b.getEntity()},n=function(a){if(!a)return a;var c=a.characterList,d=a.text;d&&!c&&(a.characterList=h(i(b("CharacterMetadata").EMPTY,d.length)));return a};d=babelHelpers.inherits(a,f(k));g=d&&d.prototype;function a(a){a===void 0&&(a=k),g.constructor.call(this,n(a))}a.prototype.getKey=function(){return this.get("key")};a.prototype.getType=function(){return this.get("type")};a.prototype.getText=function(){return this.get("text")};a.prototype.getCharacterList=function(){return this.get("characterList")};a.prototype.getLength=function(){return this.getText().length};a.prototype.getDepth=function(){return this.get("depth")};a.prototype.getData=function(){return this.get("data")};a.prototype.getInlineStyleAt=function(a){a=this.getCharacterList().get(a);return a?a.getStyle():j};a.prototype.getEntityAt=function(a){a=this.getCharacterList().get(a);return a?a.getEntity():null};a.prototype.getChildKeys=function(){return this.get("children")};a.prototype.getParentKey=function(){return this.get("parent")};a.prototype.getPrevSiblingKey=function(){return this.get("prevSibling")};a.prototype.getNextSiblingKey=function(){return this.get("nextSibling")};a.prototype.findStyleRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),l,a,c)};a.prototype.findEntityRanges=function(a,c){b("findRangesImmutable")(this.getCharacterList(),m,a,c)};e.exports=a}),null);
__d("DraftEntityInstance",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("immutable").Record;d=c({type:"TOKEN",mutability:"IMMUTABLE",data:Object});g=babelHelpers.inherits(a,d);g&&g.prototype;a.prototype.getType=function(){return this.get("type")};a.prototype.getMutability=function(){return this.get("mutability")};a.prototype.getData=function(){return this.get("data")};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("DraftEntity",["invariant","DraftEntityInstance","immutable"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Map;var h=a(),i=0;function j(a,b){}var k={getLastCreatedEntityKey:function(){j("DraftEntity.getLastCreatedEntityKey","contentState.getLastCreatedEntityKey");return k.__getLastCreatedEntityKey()},create:function(a,b,c){j("DraftEntity.create","contentState.createEntity");return k.__create(a,b,c)},add:function(a){j("DraftEntity.add","contentState.addEntity");return k.__add(a)},get:function(a){j("DraftEntity.get","contentState.getEntity");return k.__get(a)},mergeData:function(a,b){j("DraftEntity.mergeData","contentState.mergeEntityData");return k.__mergeData(a,b)},replaceData:function(a,b){j("DraftEntity.replaceData","contentState.replaceEntityData");return k.__replaceData(a,b)},__getLastCreatedEntityKey:function(){return""+i},__create:function(a,c,d){return k.__add(new(b("DraftEntityInstance"))({type:a,mutability:c,data:d||{}}))},__add:function(a){var b=""+ ++i;h=h.set(b,a);return b},__get:function(a){var b=h.get(a);!b&&g(0,2105,a);return b},__mergeData:function(a,b){var c=k.__get(a);b=babelHelpers["extends"]({},c.getData(),b);c=c.set("data",b);h=h.set(a,c);return c},__replaceData:function(a,b){var c=k.__get(a);c=c.set("data",b);h=h.set(a,c);return c}};e.exports=k}),null);
__d("SelectionState",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=b("immutable").Record;c={anchorKey:"",anchorOffset:0,focusKey:"",focusOffset:0,isBackward:!1,hasFocus:!1};d=a(c);g=babelHelpers.inherits(h,d);g&&g.prototype;h.prototype.serialize=function(){return"Anchor: "+this.getAnchorKey()+":"+this.getAnchorOffset()+", Focus: "+this.getFocusKey()+":"+this.getFocusOffset()+", Is Backward: "+String(this.getIsBackward())+", Has Focus: "+String(this.getHasFocus())};h.prototype.getAnchorKey=function(){return this.get("anchorKey")};h.prototype.getAnchorOffset=function(){return this.get("anchorOffset")};h.prototype.getFocusKey=function(){return this.get("focusKey")};h.prototype.getFocusOffset=function(){return this.get("focusOffset")};h.prototype.getIsBackward=function(){return this.get("isBackward")};h.prototype.getHasFocus=function(){return this.get("hasFocus")};h.prototype.hasEdgeWithin=function(a,b,c){var d=this.getAnchorKey(),e=this.getFocusKey();if(d===e&&d===a){var f=this.getStartOffset(),g=this.getEndOffset();return b<=f&&f<=c||b<=g&&g<=c}if(a!==d&&a!==e)return!1;f=a===d?this.getAnchorOffset():this.getFocusOffset();return b<=f&&c>=f};h.prototype.isCollapsed=function(){return this.getAnchorKey()===this.getFocusKey()&&this.getAnchorOffset()===this.getFocusOffset()};h.prototype.getStartKey=function(){return this.getIsBackward()?this.getFocusKey():this.getAnchorKey()};h.prototype.getStartOffset=function(){return this.getIsBackward()?this.getFocusOffset():this.getAnchorOffset()};h.prototype.getEndKey=function(){return this.getIsBackward()?this.getAnchorKey():this.getFocusKey()};h.prototype.getEndOffset=function(){return this.getIsBackward()?this.getAnchorOffset():this.getFocusOffset()};h.createEmpty=function(a){return new h({anchorKey:a,anchorOffset:0,focusKey:a,focusOffset:0,isBackward:!1,hasFocus:!1})};function h(){g.apply(this,arguments)}e.exports=h}),null);
__d("generateRandomKey",[],(function(a,b,c,d,e,f){"use strict";var g={},h=Math.pow(2,24);function a(){var a;while(a===void 0||Object.prototype.hasOwnProperty.call(g,a)||!isNaN(+a))a=Math.floor(Math.random()*h).toString(32);g[a]=!0;return a}e.exports=a}),null);
__d("sanitizeDraftText",[],(function(a,b,c,d,e,f){"use strict";var g=new RegExp("\r","g");function a(a){return a.replace(g,"")}e.exports=a}),null);
__d("ContentState",["BlockMapBuilder","CharacterMetadata","ContentBlock","ContentBlockNode","DraftEntity","immutable","SelectionState","generateRandomKey","gkx","sanitizeDraftText"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").List;a=b("immutable").Record;var i=b("immutable").Repeat;c={entityMap:null,blockMap:null,selectionBefore:null,selectionAfter:null};d=a(c);g=babelHelpers.inherits(j,d);g&&g.prototype;j.prototype.getEntityMap=function(){return b("DraftEntity")};j.prototype.getBlockMap=function(){return this.get("blockMap")};j.prototype.getSelectionBefore=function(){return this.get("selectionBefore")};j.prototype.getSelectionAfter=function(){return this.get("selectionAfter")};j.prototype.getBlockForKey=function(a){a=this.getBlockMap().get(a);return a};j.prototype.getKeyBefore=function(a){return this.getBlockMap().reverse().keySeq().skipUntil(function(b){return b===a}).skip(1).first()};j.prototype.getKeyAfter=function(a){return this.getBlockMap().keySeq().skipUntil(function(b){return b===a}).skip(1).first()};j.prototype.getBlockAfter=function(a){return this.getBlockMap().skipUntil(function(b,c){return c===a}).skip(1).first()};j.prototype.getBlockBefore=function(a){return this.getBlockMap().reverse().skipUntil(function(b,c){return c===a}).skip(1).first()};j.prototype.getBlocksAsArray=function(){return this.getBlockMap().toArray()};j.prototype.getFirstBlock=function(){return this.getBlockMap().first()};j.prototype.getLastBlock=function(){return this.getBlockMap().last()};j.prototype.getPlainText=function(a){return this.getBlockMap().map(function(a){return a?a.getText():""}).join(a||"\n")};j.prototype.getLastCreatedEntityKey=function(){return b("DraftEntity").__getLastCreatedEntityKey()};j.prototype.hasText=function(){var a=this.getBlockMap();return a.size>1||a.first().getLength()>0};j.prototype.createEntity=function(a,c,d){b("DraftEntity").__create(a,c,d);return this};j.prototype.mergeEntityData=function(a,c){b("DraftEntity").__mergeData(a,c);return this};j.prototype.replaceEntityData=function(a,c){b("DraftEntity").__replaceData(a,c);return this};j.prototype.addEntity=function(a){b("DraftEntity").__add(a);return this};j.prototype.getEntity=function(a){return b("DraftEntity").__get(a)};j.createFromBlockArray=function(a,c){a=Array.isArray(a)?a:a.contentBlocks;a=b("BlockMapBuilder").createFromArray(a);var d=a.isEmpty()?new(b("SelectionState"))():b("SelectionState").createEmpty(a.first().getKey());return new j({blockMap:a,entityMap:c||b("DraftEntity"),selectionBefore:d,selectionAfter:d})};j.createFromText=function(a,c){c===void 0&&(c=/\r\n?|\n/g);a=a.split(c);c=a.map(function(a){a=b("sanitizeDraftText")(a);var c=b("gkx")("676842")?b("ContentBlockNode"):b("ContentBlock");return new c({key:b("generateRandomKey")(),text:a,type:"unstyled",characterList:h(i(b("CharacterMetadata").EMPTY,a.length))})});return j.createFromBlockArray(c)};function j(){g.apply(this,arguments)}e.exports=j}),null);
__d("ContentStateInlineStyle",["CharacterMetadata","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").Map;a={add:function(a,b,c){return h(a,b,c,!0)},remove:function(a,b,c){return h(a,b,c,!1)}};function h(a,c,d,e){__p&&__p();var f=a.getBlockMap(),h=c.getStartKey(),i=c.getStartOffset(),j=c.getEndKey(),k=c.getEndOffset(),l=f.skipUntil(function(a,b){return b===h}).takeUntil(function(a,b){return b===j}).concat(g([[j,f.get(j)]])).map(function(a,c){var f,g;h===j?(f=i,g=k):(f=c===h?i:0,g=c===j?k:a.getLength());c=a.getCharacterList();var l;while(f<g)l=c.get(f),c=c.set(f,e?b("CharacterMetadata").applyStyle(l,d):b("CharacterMetadata").removeStyle(l,d)),f++;return a.set("characterList",c)});return a.merge({blockMap:f.merge(l),selectionBefore:c,selectionAfter:c})}e.exports=a}),null);
__d("applyEntityToContentBlock",["CharacterMetadata"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e){var f=a.getCharacterList();while(c<d)f=f.set(c,b("CharacterMetadata").applyEntity(f.get(c),e)),c++;return a.set("characterList",f)}e.exports=a}),null);
__d("applyEntityToContentState",["immutable","applyEntityToContentBlock"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d){var e=a.getBlockMap(),f=c.getStartKey(),g=c.getStartOffset(),h=c.getEndKey(),i=c.getEndOffset(),j=e.skipUntil(function(a,b){return b===f}).takeUntil(function(a,b){return b===h}).toOrderedMap().merge(b("immutable").OrderedMap([[h,e.get(h)]])).map(function(a,c){var e=c===f?g:0;c=c===h?i:a.getLength();return b("applyEntityToContentBlock")(a,e,c,d)});return a.merge({blockMap:e.merge(j),selectionBefore:c,selectionAfter:c})}e.exports=a}),null);
__d("DraftEntitySegments",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={getRemovalRange:function(a,b,c,d,e){__p&&__p();var f=c.split(" ");f=f.map(function(a,b){if(e==="forward"){if(b>0)return" "+a}else if(b<f.length-1)return a+" ";return a});var g=d,h,i=null,j=null;for(var k=0;k<f.length;k++){h=f[k];h=g+h.length;if(a<h&&g<b)i!==null?j=h:(i=g,j=h);else if(i!==null)break;g=h}h=d+c.length;k=i===d;g=j===h;(!k&&g||k&&!g)&&(e==="forward"?j!==h&&j++:i!==d&&i--);return{start:i,end:j}}};e.exports=a}),null);
__d("getRangesForDraftEntity",["invariant"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var c=[];a.findEntityRanges(function(a){return a.getEntity()===b},function(a,b){c.push({start:a,end:b})});!c.length&&g(0,1817);return c}e.exports=a}),null);
__d("getCharacterRemovalRange",["invariant","DraftEntitySegments","getRangesForDraftEntity"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a,b,c,d,e){__p&&__p();var f=d.getStartOffset(),g=d.getEndOffset();f=b.getEntityAt(f);g=c.getEntityAt(g-1);if(!f&&!g)return d;d=d;if(f&&f===g)d=h(a,b,d,e,f,!0,!0);else if(f&&g){var i=h(a,b,d,e,f,!1,!0),j=h(a,c,d,e,g,!1,!1);d=d.merge({anchorOffset:i.getAnchorOffset(),focusOffset:j.getFocusOffset(),isBackward:!1})}else if(f){i=h(a,b,d,e,f,!1,!0);d=d.merge({anchorOffset:i.getStartOffset(),isBackward:!1})}else if(g){j=h(a,c,d,e,g,!1,!1);d=d.merge({focusOffset:j.getEndOffset(),isBackward:!1})}return d}function h(a,c,d,e,f,h,i){__p&&__p();var j=d.getStartOffset(),k=d.getEndOffset();a=a.__get(f);a=a.getMutability();var l=i?j:k;if(a==="MUTABLE")return d;f=b("getRangesForDraftEntity")(c,f).filter(function(a){return l<=a.end&&l>=a.start});f.length==1||g(0,5779);f=f[0];if(a==="IMMUTABLE")return d.merge({anchorOffset:f.start,focusOffset:f.end,isBackward:!1});h||(i?k=f.end:j=f.start);a=b("DraftEntitySegments").getRemovalRange(j,k,c.getText().slice(f.start,f.end),f.start,e);return d.merge({anchorOffset:a.start,focusOffset:a.end,isBackward:!1})}e.exports=a}),null);
__d("randomizeBlockMapKeys",["ContentBlockNode","immutable","generateRandomKey"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").OrderedMap,h=function(a){__p&&__p();var c={},d;return g(a.withMutations(function(a){__p&&__p();a.forEach(function(e,f){__p&&__p();var g=e.getKey();f=e.getNextSiblingKey();var h=e.getPrevSiblingKey(),i=e.getChildKeys(),j=e.getParentKey(),k=b("generateRandomKey")();c[g]=k;if(f){var l=a.get(f);l?a.setIn([f,"prevSibling"],k):a.setIn([g,"nextSibling"],null)}if(h){l=a.get(h);l?a.setIn([h,"nextSibling"],k):a.setIn([g,"prevSibling"],null)}if(j&&a.get(j)){f=a.get(j);l=f.getChildKeys();a.setIn([j,"children"],l.set(l.indexOf(e.getKey()),k))}else a.setIn([g,"parent"],null),d&&(a.setIn([d.getKey(),"nextSibling"],k),a.setIn([g,"prevSibling"],c[d.getKey()])),d=a.get(g);i.forEach(function(b){var c=a.get(b);c?a.setIn([b,"parent"],k):a.setIn([g,"children"],e.getChildKeys().filter(function(a){return a!==b}))})})}).toArray().map(function(a){return[c[a.getKey()],a.set("key",c[a.getKey()])]}))},i=function(a){return g(a.toArray().map(function(a){var c=b("generateRandomKey")();return[c,a.set("key",c)]}))};a=function(a){var c=a.first()instanceof b("ContentBlockNode");return!c?i(a):h(a)};e.exports=a}),null);
__d("removeEntitiesAtEdges",["invariant","CharacterMetadata","findRangesImmutable"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a,b){var c=a.getBlockMap(),d=a.getEntityMap(),e={},f=b.getStartKey(),g=b.getStartOffset(),h=c.get(f);g=i(d,h,g);g!==h&&(e[f]=g);h=b.getEndKey();var j=b.getEndOffset(),k=c.get(h);f===h&&(k=g);f=i(d,k,j);f!==k&&(e[h]=f);return!Object.keys(e).length?a.set("selectionAfter",b):a.merge({blockMap:c.merge(e),selectionAfter:b})}function h(a,c,d){var e;b("findRangesImmutable")(a,function(a,b){return a.getEntity()===b.getEntity()},function(a){return a.getEntity()===c},function(a,b){a<=d&&b>=d&&(e={start:a,end:b})});typeof e==="object"||g(0,6015);return e}function i(a,c,d){__p&&__p();var e=c.getCharacterList(),f=d>0?e.get(d-1):void 0,g=d<e.count()?e.get(d):void 0;f=f?f.getEntity():void 0;g=g?g.getEntity():void 0;if(g&&g===f){f=a.__get(g);if(f.getMutability()!=="MUTABLE"){a=h(e,g,d);f=a.start;g=a.end;while(f<g)d=e.get(f),e=e.set(f,b("CharacterMetadata").applyEntity(d,null)),f++;return c.set("characterList",e)}}return c}e.exports=a}),null);
__d("getContentStateFragment",["randomizeBlockMapKeys","removeEntitiesAtEdges"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a,c){__p&&__p();var d=c.getStartKey(),e=c.getStartOffset(),f=c.getEndKey(),g=c.getEndOffset();a=b("removeEntitiesAtEdges")(a,c);c=a.getBlockMap();a=c.keySeq();var h=a.indexOf(d);a=a.indexOf(f)+1;return b("randomizeBlockMapKeys")(c.slice(h,a).map(function(a,b){var c=a.getText(),h=a.getCharacterList();if(d===f)return a.merge({text:c.slice(e,g),characterList:h.slice(e,g)});if(b===d)return a.merge({text:c.slice(e),characterList:h.slice(e)});return b===f?a.merge({text:c.slice(0,g),characterList:h.slice(0,g)}):a}))};e.exports=a}),null);
__d("insertIntoList",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b,c){__p&&__p();if(c===a.count())b.forEach(function(b){a=a.push(b)});else if(c===0)b.reverse().forEach(function(b){a=a.unshift(b)});else{var d=a.slice(0,c);c=a.slice(c);a=d.concat(b,c).toList()}return a}e.exports=a}),null);
__d("insertFragmentIntoContentState",["invariant","BlockMapBuilder","ContentBlockNode","immutable","insertIntoList","randomizeBlockMapKeys"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("immutable").List,i=function(a,c,d,e,f,g){var h=d.get(f),i=h.getText(),j=h.getCharacterList(),k=f,l=g+e.getText().length;h=h.merge({text:i.slice(0,g)+e.getText()+i.slice(g),characterList:b("insertIntoList")(j,e.getCharacterList(),g),data:e.getData()});return a.merge({blockMap:d.set(f,h),selectionBefore:c,selectionAfter:c.merge({anchorKey:k,anchorOffset:l,focusKey:k,focusOffset:l,isBackward:!1})})},j=function(a,b,c){var d=a.getText(),e=a.getCharacterList();d=d.slice(0,b);e=e.slice(0,b);b=c.first();return a.merge({text:d+b.getText(),characterList:e.concat(b.getCharacterList()),type:d?a.getType():b.getType(),data:b.getData()})},k=function(a,b,c){var d=a.getText();a=a.getCharacterList();var e=d.length;d=d.slice(b,e);a=a.slice(b,e);b=c.last();return b.merge({text:b.getText()+d,characterList:b.getCharacterList().concat(a),data:b.getData()})},l=function(a,b){__p&&__p();var c=a.getKey();a=a;var d=[];b.get(c)&&d.push(c);while(a&&a.getNextSiblingKey()){c=a.getNextSiblingKey();if(!c)break;d.push(c);a=b.get(c)}return d},m=function(a,b,c,d){__p&&__p();return a.withMutations(function(b){__p&&__p();var e=c.getKey(),f=d.getKey(),g=c.getNextSiblingKey(),i=c.getParentKey(),j=l(d,a),k=j[j.length-1];b.get(f)?(b.setIn([e,"nextSibling"],f),b.setIn([f,"prevSibling"],e)):(b.setIn([e,"nextSibling"],d.getNextSiblingKey()),b.setIn([d.getNextSiblingKey(),"prevSibling"],e));b.setIn([k,"nextSibling"],g);g&&b.setIn([g,"prevSibling"],k);j.forEach(function(a){return b.setIn([a,"parent"],i)});if(i){f=a.get(i);g=f.getChildKeys();k=g.indexOf(e);f=k+1;e=g.toArray();e.splice.apply(e,[f,0].concat(j));b.setIn([i,"children"],h(e))}})},n=function(a,c,d,e,f,g){__p&&__p();var h=d.first()instanceof b("ContentBlockNode"),i=[],l=e.size,n=d.get(f),o=e.first(),p=e.last(),q=p.getLength();p=p.getKey();var r=h&&(!n.getChildKeys().isEmpty()||!o.getChildKeys().isEmpty());d.forEach(function(a,b){if(b!==f){i.push(a);return}r?i.push(a):i.push(j(a,g,e));e.slice(r?0:1,l-1).forEach(function(a){return i.push(a)});i.push(k(a,g,e))});var s=b("BlockMapBuilder").createFromArray(i);h&&(s=m(s,d,n,o));return a.merge({blockMap:s,selectionBefore:c,selectionAfter:c.merge({anchorKey:p,anchorOffset:q,focusKey:p,focusOffset:q,isBackward:!1})})};a=function(a,c,d){c.isCollapsed()||g(0,1903);var e=a.getBlockMap();d=b("randomizeBlockMapKeys")(d);var f=c.getStartKey(),h=c.getStartOffset(),j=e.get(f);j instanceof b("ContentBlockNode")&&(j.getChildKeys().isEmpty()||g(0,1904));return d.size===1?i(a,c,e,d.first(),f,h):n(a,c,e,d,f,h)};e.exports=a}),null);
__d("insertTextIntoContentState",["invariant","immutable","insertIntoList"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("immutable").Repeat;function a(a,c,d,e){c.isCollapsed()||g(0,2659);var f=d.length;if(!f)return a;var i=a.getBlockMap(),j=c.getStartKey(),k=c.getStartOffset(),l=i.get(j),m=l.getText();d=l.merge({text:m.slice(0,k)+d+m.slice(k,l.getLength()),characterList:b("insertIntoList")(l.getCharacterList(),h(e,f).toList(),k)});m=k+f;return a.merge({blockMap:i.set(j,d),selectionAfter:c.merge({anchorOffset:m,focusOffset:m})})}e.exports=a}),null);
__d("modifyBlockForContentState",["immutable"],(function(a,b,c,d,e,f){"use strict";var g=b("immutable").Map;function a(a,b,c){var d=b.getStartKey(),e=b.getEndKey(),f=a.getBlockMap();c=f.toSeq().skipUntil(function(a,b){return b===d}).takeUntil(function(a,b){return b===e}).concat(g([[e,f.get(e)]])).map(c);return a.merge({blockMap:f.merge(c),selectionBefore:b,selectionAfter:b})}e.exports=a}),null);
__d("getNextDelimiterBlockKey",["ContentBlockNode"],(function(a,b,c,d,e,f){__p&&__p();a=function(a,c){__p&&__p();var d=a instanceof b("ContentBlockNode");if(!d)return null;d=a.getNextSiblingKey();if(d)return d;d=a.getParentKey();if(!d)return null;a=c.get(d);while(a&&!a.getNextSiblingKey()){d=a.getParentKey();a=d?c.get(d):null}return!a?null:a.getNextSiblingKey()};e.exports=a}),null);
__d("removeRangeFromContentState",["ContentBlockNode","getNextDelimiterBlockKey","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("immutable").List;var g=b("immutable").Map,h=function(a,b,c){if(!a)return;var d=b.get(a);if(!d)return;b.set(a,c(d))},i=function(a,b){__p&&__p();var c=[];if(!a)return c;a=b.get(a);while(a&&a.getParentKey()){var d=a.getParentKey();d&&c.push(d);a=d?b.get(d):null}return c},j=function(a,c){__p&&__p();var d=[];if(!a)return d;a=b("getNextDelimiterBlockKey")(a,c);while(a&&c.get(a)){var e=c.get(a);d.push(a);a=e.getParentKey()?b("getNextDelimiterBlockKey")(e,c):null}return d},k=function(a,b,c){if(!a)return null;a=c.get(a.getKey()).getNextSiblingKey();while(a&&!b.get(a))a=c.get(a).getNextSiblingKey()||null;return a},l=function(a,b,c){if(!a)return null;a=c.get(a.getKey()).getPrevSiblingKey();while(a&&!b.get(a))a=c.get(a).getPrevSiblingKey()||null;return a},m=function(a,b,c,d){__p&&__p();return a.withMutations(function(e){__p&&__p();h(b.getKey(),e,function(a){return a.merge({nextSibling:k(a,e,d),prevSibling:l(a,e,d)})});h(c.getKey(),e,function(a){return a.merge({nextSibling:k(a,e,d),prevSibling:l(a,e,d)})});i(b.getKey(),d).forEach(function(a){return h(a,e,function(a){return a.merge({children:a.getChildKeys().filter(function(a){return e.get(a)}),nextSibling:k(a,e,d),prevSibling:l(a,e,d)})})});h(b.getNextSiblingKey(),e,function(a){return a.merge({prevSibling:b.getPrevSiblingKey()})});h(b.getPrevSiblingKey(),e,function(a){return a.merge({nextSibling:k(a,e,d)})});h(c.getNextSiblingKey(),e,function(a){return a.merge({prevSibling:l(a,e,d)})});h(c.getPrevSiblingKey(),e,function(a){return a.merge({nextSibling:c.getNextSiblingKey()})});i(c.getKey(),d).forEach(function(a){h(a,e,function(a){return a.merge({children:a.getChildKeys().filter(function(a){return e.get(a)}),nextSibling:k(a,e,d),prevSibling:l(a,e,d)})})});j(c,d).forEach(function(a){return h(a,e,function(a){return a.merge({nextSibling:k(a,e,d),prevSibling:l(a,e,d)})})});if(a.get(b.getKey())==null&&a.get(c.getKey())!=null&&c.getParentKey()===b.getKey()&&c.getPrevSiblingKey()==null){var f=b.getPrevSiblingKey();h(c.getKey(),e,function(a){return a.merge({prevSibling:f})});h(f,e,function(a){return a.merge({nextSibling:c.getKey()})});var g=f?a.get(f):null,m=g?g.getParentKey():null;b.getChildKeys().forEach(function(a){h(a,e,function(a){return a.merge({parent:m})})});if(m!=null){var n=a.get(m);h(m,e,function(a){return a.merge({children:n.getChildKeys().concat(b.getChildKeys())})})}h(b.getChildKeys().find(function(b){b=a.get(b);return b.getNextSiblingKey()===null}),e,function(a){return a.merge({nextSibling:b.getNextSiblingKey()})})}})};a=function(a,c){__p&&__p();if(c.isCollapsed())return a;var d=a.getBlockMap(),e=c.getStartKey(),f=c.getStartOffset(),h=c.getEndKey(),j=c.getEndOffset(),k=d.get(e),l=d.get(h),o=k instanceof b("ContentBlockNode"),p=[];if(o){var q=l.getChildKeys(),r=i(h,d);l.getNextSiblingKey()&&(p=p.concat(r));q.isEmpty()||(p=p.concat(r.concat([h])));p=p.concat(i(b("getNextDelimiterBlockKey")(l,d),d))}k===l?q=n(k.getCharacterList(),f,j):q=k.getCharacterList().slice(0,f).concat(l.getCharacterList().slice(j));var s=k.merge({text:k.getText().slice(0,f)+l.getText().slice(j),characterList:q});r=o&&f===0&&j===0&&l.getParentKey()===e&&l.getPrevSiblingKey()==null;q=r?g([[e,null]]):d.toSeq().skipUntil(function(a,b){return b===e}).takeUntil(function(a,b){return b===h}).filter(function(a,b){return p.indexOf(b)===-1}).concat(g([[h,null]])).map(function(a,b){return b===e?s:null});j=d.merge(q).filter(function(a){return!!a});o&&k!==l&&(j=m(j,k,l,d));return a.merge({blockMap:j,selectionBefore:c,selectionAfter:c.merge({anchorKey:e,anchorOffset:f,focusKey:e,focusOffset:f,isBackward:!1})})};var n=function(a,b,c){__p&&__p();if(b===0)while(b<c)a=a.shift(),b++;else if(c===a.count())while(c>b)a=a.pop(),c--;else{b=a.slice(0,b);c=a.slice(c);a=b.concat(c).toList()}return a};e.exports=a}),null);
__d("splitBlockInContentState",["invariant","ContentBlockNode","generateRandomKey","immutable","modifyBlockForContentState"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("immutable").List,i=b("immutable").Map,j=function(a,b,c){if(!a)return;var d=b.get(a);if(!d)return;b.set(a,c(d))},k=function(a,b,c){__p&&__p();return a.withMutations(function(a){__p&&__p();var d=b.getKey(),e=c.getKey();j(b.getParentKey(),a,function(a){var b=a.getChildKeys(),c=b.indexOf(d)+1;b=b.toArray();b.splice(c,0,e);return a.merge({children:h(b)})});j(b.getNextSiblingKey(),a,function(a){return a.merge({prevSibling:e})});j(d,a,function(a){return a.merge({nextSibling:e})});j(e,a,function(a){return a.merge({prevSibling:d})})})};a=function(a,c){__p&&__p();c.isCollapsed()||g(0,5004);var d=c.getAnchorKey(),e=a.getBlockMap(),f=e.get(d),h=f.getText();if(!h){var j=f.getType();if(j==="unordered-list-item"||j==="ordered-list-item")return b("modifyBlockForContentState")(a,c,function(a){return a.merge({type:"unstyled",depth:0})})}j=c.getAnchorOffset();var l=f.getCharacterList(),m=b("generateRandomKey")(),n=f instanceof b("ContentBlockNode"),o=f.merge({text:h.slice(0,j),characterList:l.slice(0,j)});h=o.merge({key:m,text:h.slice(j),characterList:l.slice(j),data:i()});l=e.toSeq().takeUntil(function(a){return a===f});j=e.toSeq().skipUntil(function(a){return a===f}).rest();e=l.concat([[d,o],[m,h]],j).toOrderedMap();n&&(f.getChildKeys().isEmpty()||g(0,5005),e=k(e,o,h));return a.merge({blockMap:e,selectionBefore:c,selectionAfter:c.merge({anchorKey:m,anchorOffset:0,focusKey:m,focusOffset:0,isBackward:!1})})};e.exports=a}),null);
__d("DraftModifier",["invariant","CharacterMetadata","ContentStateInlineStyle","immutable","applyEntityToContentState","getCharacterRemovalRange","getContentStateFragment","gkx","insertFragmentIntoContentState","insertTextIntoContentState","modifyBlockForContentState","removeEntitiesAtEdges","removeRangeFromContentState","splitBlockInContentState"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("immutable").OrderedSet,i={replaceText:function(a,c,d,e,f){a=b("removeEntitiesAtEdges")(a,c);a=b("removeRangeFromContentState")(a,c);c=b("CharacterMetadata").create({style:e||h(),entity:f||null});return b("insertTextIntoContentState")(a,a.getSelectionAfter(),d,c)},insertText:function(a,b,c,d,e){b.isCollapsed()||g(0,4661);return i.replaceText(a,b,c,d,e)},moveText:function(a,c,d){var e=b("getContentStateFragment")(a,c);a=i.removeRange(a,c,"backward");return i.replaceWithFragment(a,d,e)},replaceWithFragment:function(a,c,d){a=b("removeEntitiesAtEdges")(a,c);a=b("removeRangeFromContentState")(a,c);return b("insertFragmentIntoContentState")(a,a.getSelectionAfter(),d)},removeRange:function(a,c,d){__p&&__p();var e,f,g,h;c.getIsBackward()&&(c=c.merge({anchorKey:c.getFocusKey(),anchorOffset:c.getFocusOffset(),focusKey:c.getAnchorKey(),focusOffset:c.getAnchorOffset(),isBackward:!1}));e=c.getAnchorKey();f=c.getFocusKey();g=a.getBlockForKey(e);h=a.getBlockForKey(f);var i=c.getStartOffset(),j=c.getEndOffset();i=g.getEntityAt(i);j=h.getEntityAt(j-1);if(e===f&&(i&&i===j)){e=b("getCharacterRemovalRange")(a.getEntityMap(),g,h,c,d);return b("removeRangeFromContentState")(a,e)}f=c;b("gkx")("676849")&&(f=b("getCharacterRemovalRange")(a.getEntityMap(),g,h,c,d));i=b("removeEntitiesAtEdges")(a,f);return b("removeRangeFromContentState")(i,f)},splitBlock:function(a,c){a=b("removeEntitiesAtEdges")(a,c);a=b("removeRangeFromContentState")(a,c);return b("splitBlockInContentState")(a,a.getSelectionAfter())},applyInlineStyle:function(a,c,d){return b("ContentStateInlineStyle").add(a,c,d)},removeInlineStyle:function(a,c,d){return b("ContentStateInlineStyle").remove(a,c,d)},setBlockType:function(a,c,d){return b("modifyBlockForContentState")(a,c,function(a){return a.merge({type:d,depth:0})})},setBlockData:function(a,c,d){return b("modifyBlockForContentState")(a,c,function(a){return a.merge({data:d})})},mergeBlockData:function(a,c,d){return b("modifyBlockForContentState")(a,c,function(a){return a.merge({data:a.getData().merge(d)})})},applyEntity:function(a,c,d){a=b("removeEntitiesAtEdges")(a,c);return b("applyEntityToContentState")(a,c,d)}};e.exports=i}),null);
__d("BlockTree",["immutable","emptyFunction","findRangesImmutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").List,h=b("immutable").Repeat;a=b("immutable").Record;var i=b("emptyFunction").thatReturnsTrue;c={start:null,end:null};var j=a(c);d={start:null,end:null,decoratorKey:null,leaves:null};var k=a(d);f={generate:function(a,c,d){var e=c.getLength();if(!e)return g.of(new k({start:0,end:0,decoratorKey:null,leaves:g.of(new j({start:0,end:0}))}));var f=[],n=d?d.getDecorations(c,a):g(h(null,e)),o=c.getCharacterList();b("findRangesImmutable")(n,m,i,function(a,b){f.push(new k({start:a,end:b,decoratorKey:n.get(a),leaves:l(o.slice(a,b).toList(),a)}))});return g(f)}};function l(a,c){var d=[];a=a.map(function(a){return a.getStyle()}).toList();b("findRangesImmutable")(a,m,i,function(a,b){d.push(new j({start:a+c,end:b+c}))});return g(d)}function m(a,b){return a===b}e.exports=f}),null);
__d("EditorBidiService",["immutable","UnicodeBidiService","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").OrderedMap,h;a={getDirectionMap:function(a,c){!h?h=new(b("UnicodeBidiService"))():h.reset();a=a.getBlockMap();var d=a.valueSeq().map(function(a){return b("nullthrows")(h).getDirection(a.getText())});a=g(a.keySeq().zip(d));return c!=null&&b("immutable").is(c,a)?c:a}};e.exports=a}),null);
__d("EditorState",["BlockTree","ContentState","EditorBidiService","SelectionState","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").OrderedSet;a=b("immutable").Record;var h=b("immutable").Stack;c={allowUndo:!0,currentContent:null,decorator:null,directionMap:null,forceSelection:!1,inCompositionMode:!1,inlineStyleOverride:null,lastChangeType:null,nativelyRenderedContent:null,redoStack:h(),selection:null,treeMap:null,undoStack:h()};var i=a(c);j.createEmpty=function(a){return j.createWithContent(b("ContentState").createFromText(""),a)};j.createWithContent=function(a,c){var d=a.getBlockMap().first().getKey();return j.create({currentContent:a,undoStack:h(),redoStack:h(),decorator:c||null,selection:b("SelectionState").createEmpty(d)})};j.create=function(a){var c=a.currentContent,d=a.decorator;a=babelHelpers["extends"]({},a,{treeMap:l(c,d),directionMap:b("EditorBidiService").getDirectionMap(c)});return new j(new i(a))};j.set=function(a,b){__p&&__p();var c=a.getImmutable().withMutations(function(c){__p&&__p();var d=c.get("decorator"),e=d;b.decorator===null?e=null:b.decorator&&(e=b.decorator);var f=b.currentContent||a.getCurrentContent();if(e!==d){var g=c.get("treeMap");e&&d?g=n(f,f.getBlockMap(),g,e,d):g=l(f,e);c.merge({decorator:e,treeMap:g,nativelyRenderedContent:null});return}d=a.getCurrentContent();f!==d&&c.set("treeMap",m(a,f.getBlockMap(),f.getEntityMap(),e));c.merge(b)});return new j(c)};j.prototype.toJS=function(){return this.getImmutable().toJS()};j.prototype.getAllowUndo=function(){return this.getImmutable().get("allowUndo")};j.prototype.getCurrentContent=function(){return this.getImmutable().get("currentContent")};j.prototype.getUndoStack=function(){return this.getImmutable().get("undoStack")};j.prototype.getRedoStack=function(){return this.getImmutable().get("redoStack")};j.prototype.getSelection=function(){return this.getImmutable().get("selection")};j.prototype.getDecorator=function(){return this.getImmutable().get("decorator")};j.prototype.isInCompositionMode=function(){return this.getImmutable().get("inCompositionMode")};j.prototype.mustForceSelection=function(){return this.getImmutable().get("forceSelection")};j.prototype.getNativelyRenderedContent=function(){return this.getImmutable().get("nativelyRenderedContent")};j.prototype.getLastChangeType=function(){return this.getImmutable().get("lastChangeType")};j.prototype.getInlineStyleOverride=function(){return this.getImmutable().get("inlineStyleOverride")};j.setInlineStyleOverride=function(a,b){return j.set(a,{inlineStyleOverride:b})};j.prototype.getCurrentInlineStyle=function(){var a=this.getInlineStyleOverride();if(a!=null)return a;a=this.getCurrentContent();var b=this.getSelection();return b.isCollapsed()?p(a,b):q(a,b)};j.prototype.getBlockTree=function(a){return this.getImmutable().getIn(["treeMap",a])};j.prototype.isSelectionAtStartOfContent=function(){var a=this.getCurrentContent().getBlockMap().first().getKey();return this.getSelection().hasEdgeWithin(a,0,0)};j.prototype.isSelectionAtEndOfContent=function(){var a=this.getCurrentContent();a=a.getBlockMap();a=a.last();var b=a.getLength();return this.getSelection().hasEdgeWithin(a.getKey(),b,b)};j.prototype.getDirectionMap=function(){return this.getImmutable().get("directionMap")};j.acceptSelection=function(a,b){return k(a,b,!1)};j.forceSelection=function(a,b){b.getHasFocus()||(b=b.set("hasFocus",!0));return k(a,b,!0)};j.moveSelectionToEnd=function(a){var c=a.getCurrentContent();c=c.getLastBlock();var d=c.getKey();c=c.getLength();return j.acceptSelection(a,new(b("SelectionState"))({anchorKey:d,anchorOffset:c,focusKey:d,focusOffset:c,isBackward:!1}))};j.moveFocusToEnd=function(a){a=j.moveSelectionToEnd(a);return j.forceSelection(a,a.getSelection())};j.push=function(a,c,d,e){__p&&__p();e===void 0&&(e=!0);if(a.getCurrentContent()===c)return a;var f=b("EditorBidiService").getDirectionMap(c,a.getDirectionMap());if(!a.getAllowUndo())return j.set(a,{currentContent:c,directionMap:f,lastChangeType:d,selection:c.getSelectionAfter(),forceSelection:e,inlineStyleOverride:null});var g=a.getSelection(),i=a.getCurrentContent(),k=a.getUndoStack(),l=c;g!==i.getSelectionAfter()||o(a,d)?(k=k.push(i),l=l.set("selectionBefore",g)):(d==="insert-characters"||d==="backspace-character"||d==="delete-character")&&(l=l.set("selectionBefore",i.getSelectionBefore()));g=a.getInlineStyleOverride();i=["adjust-depth","change-block-type","split-block"];i.indexOf(d)===-1&&(g=null);i={currentContent:l,directionMap:f,undoStack:k,redoStack:h(),lastChangeType:d,selection:c.getSelectionAfter(),forceSelection:e,inlineStyleOverride:g};return j.set(a,i)};j.undo=function(a){if(!a.getAllowUndo())return a;var c=a.getUndoStack(),d=c.peek();if(!d)return a;var e=a.getCurrentContent(),f=b("EditorBidiService").getDirectionMap(d,a.getDirectionMap());return j.set(a,{currentContent:d,directionMap:f,undoStack:c.shift(),redoStack:a.getRedoStack().push(e),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"undo",nativelyRenderedContent:null,selection:e.getSelectionBefore()})};j.redo=function(a){if(!a.getAllowUndo())return a;var c=a.getRedoStack(),d=c.peek();if(!d)return a;var e=a.getCurrentContent(),f=b("EditorBidiService").getDirectionMap(d,a.getDirectionMap());return j.set(a,{currentContent:d,directionMap:f,undoStack:a.getUndoStack().push(e),redoStack:c.shift(),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"redo",nativelyRenderedContent:null,selection:d.getSelectionAfter()})};function j(a){this.$1=a}j.prototype.getImmutable=function(){return this.$1};function k(a,b,c){return j.set(a,{selection:b,forceSelection:c,nativelyRenderedContent:null,inlineStyleOverride:null})}function l(a,c){return a.getBlockMap().map(function(d){return b("BlockTree").generate(a,d,c)}).toOrderedMap()}function m(a,c,d,e){var f=a.getCurrentContent().set("entityMap",d),g=f.getBlockMap();d=a.getImmutable().get("treeMap");return d.merge(c.toSeq().filter(function(a,b){return a!==g.get(b)}).map(function(a){return b("BlockTree").generate(f,a,e)}))}function n(a,c,d,e,f){return d.merge(c.toSeq().filter(function(b){return e.getDecorations(b,a)!==f.getDecorations(b,a)}).map(function(c){return b("BlockTree").generate(a,c,e)}))}function o(a,b){a=a.getLastChangeType();return b!==a||b!=="insert-characters"&&b!=="backspace-character"&&b!=="delete-character"}function p(a,b){var c=b.getStartKey();b=b.getStartOffset();var d=a.getBlockForKey(c);if(b>0)return d.getInlineStyleAt(b-1);return d.getLength()?d.getInlineStyleAt(0):r(a,c)}function q(a,b){var c=b.getStartKey();b=b.getStartOffset();var d=a.getBlockForKey(c);if(b<d.getLength())return d.getInlineStyleAt(b);return b>0?d.getInlineStyleAt(b-1):r(a,c)}function r(a,b){a=a.getBlockMap().reverse().skipUntil(function(a,c){return c===b}).skip(1).skipUntil(function(a,b){return a.getLength()}).first();return a?a.getInlineStyleAt(a.getLength()-1):g()}e.exports=j}),null);
__d("createPlainBlocksFromText",["CharacterMetadata","ContentBlock","immutable","generateRandomKey","sanitizeDraftText"],(function(a,b,c,d,e,f){"use strict";var g=b("immutable").List,h=b("immutable").Repeat,i=b("CharacterMetadata").EMPTY;function a(a){return a.map(function(a){a=b("sanitizeDraftText")(a);var c=a.length;return new(b("ContentBlock"))({key:b("generateRandomKey")(),text:a,type:"unstyled",characterList:g(h(i,c))})})}e.exports=a}),null);
__d("createEditorStateWithRanges",["invariant","ContentState","DraftModifier","EditorState","SelectionState","UnicodeUtils","createPlainBlocksFromText"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a){__p&&__p();var c=a.addEntityToContentStateFn,d=a.allowUndo,e=a.decorator,f=a.splitIntoBlocks,h=a.text;a=a.ranges;f===void 0&&(f=!0);h||(h="");var i=[],j=[];f=f?h.split(/(\r\n?|\n)/g):[h];var k=0;f.forEach(function(a,c){c%2===0&&(i.push(a),j.push(k)),k+=b("UnicodeUtils").strlen(a)});var l=b("createPlainBlocksFromText")(i);h=b("ContentState").createFromBlockArray(l);if(a&&a.length&&c){var m=c;h=a.reduce(function(a,c,d){__p&&__p();d=m(c,a);a=d.getLastCreatedEntityKey();var e=c.offset;c=e+c.length;var f,h,i,k;for(var n=0;n<j.length;n++){var o=j[n],p=j[n+1],q=p===void 0;(q||e>=o&&e<p)&&(f=l[n],h=e-o);if(q||c>=o&&c<p){i=l[n];k=c-o;break}}f&&i||g(0,1022);q=b("UnicodeUtils").substr(f.getText(),0,h);p=q.length;o=b("UnicodeUtils").substr(i.getText(),0,k);c=o.length;e=new(b("SelectionState"))({anchorKey:f.getKey(),anchorOffset:p,focusKey:i.getKey(),focusOffset:c,isBackward:!1,hasFocus:!1});n=b("DraftModifier").applyEntity(d,e,a);return n},h)}f=b("EditorState").createWithContent(h,e);d===!1&&(f=b("EditorState").set(f,{allowUndo:!1}));return f}e.exports=a}),null);
__d("getEntityMatcher",[],(function(a,b,c,d,e,f){function g(a,b){return b.getEntity(a)}function a(a,b){return function(c,d,e){var f=b||g;c.findEntityRanges(function(b){b=b.getEntity();return typeof b==="string"&&a(f(b,e))},d)}}e.exports=a}),null);
__d("getChunkForContentState",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b,c){if(b){c=c.getEntity(b);if(c.getType()==="EMOTICON")return c.getData().originalEmoticon;else if(c.getType()==="EMOJI")return c.getData().emoji.join("")}return a.replace("@[","@ [")}e.exports=a}),null);
__d("getMentionsTextForContentState",["emptyFunction","getChunkForContentState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("emptyFunction").thatReturnsTrue,h=/[\\\]:]/g;function a(a,b){b===void 0&&(b="");var c=a.getBlockMap().map(function(b){var c=b.getText(),d=[];b.findEntityRanges(g,function(e,f){d.push(i(c.slice(e,f),b.getEntityAt(e),a))});return d.join("")});return c.join("\n"+b)}function i(a,c,d){__p&&__p();if(c){var e=d.getEntity(c);if(e.getType()==="MENTION"){a=a.replace(h,function(a){return"\\"+a});e=e.getData().id;if(/^\d+$/.test(e))return"@["+e+":"+a+"]"}}return b("getChunkForContentState")(a,c,d)}e.exports=a}),null);
__d("replaceSelectionWithMention",["DraftModifier","EditorState"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f){e=e(c.getCurrentContent(),a);var g=e.getLastCreatedEntityKey();f=f?f(a):a.getTitle();a=b("DraftModifier").replaceText(e,d,f,c.getCurrentInlineStyle(),g);return b("EditorState").push(c,a,"insert-fragment")}e.exports=a}),null);
__d("splitTextIntoTextBlocks",[],(function(a,b,c,d,e,f){"use strict";var g=/\r\n?|\n/g;function a(a){return a.split(g)}e.exports=a}),null);
__d("CompositeDraftDecorator",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").List,h=".";function a(a){this.$1=a.slice()}a.prototype.getDecorations=function(a,b){var c=Array(a.getText().length).fill(null);this.$1.forEach(function(d,e){var f=0;d=d.strategy;var g=function(a,b){i(c,a,b)&&(j(c,a,b,e+h+f),f++)};d(a,g,b)});return g(c)};a.prototype.getComponentForKey=function(a){a=parseInt(a.split(h)[0],10);return this.$1[a].component};a.prototype.getPropsForKey=function(a){a=parseInt(a.split(h)[0],10);return this.$1[a].props};function i(a,b,c){for(var b=b;b<c;b++)if(a[b]!=null)return!1;return!0}function j(a,b,c,d){for(var b=b;b<c;b++)a[b]=d}e.exports=a}),null);
__d("DraftStringKey",[],(function(a,b,c,d,e,f){"use strict";a={stringify:function(a){return"_"+String(a)},unstringify:function(a){return a.slice(1)}};e.exports=a}),null);
__d("encodeEntityRanges",["DraftStringKey","UnicodeUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("UnicodeUtils").strlen;function a(a,c){var d=[];a.findEntityRanges(function(a){return!!a.getEntity()},function(e,f){var h=a.getText(),i=a.getEntityAt(e);d.push({offset:g(h.slice(0,e)),length:g(h.slice(e,f)),key:Number(c[b("DraftStringKey").stringify(i)])})});return d}e.exports=a}),null);
__d("encodeInlineStyleRanges",["UnicodeUtils","findRangesImmutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=function(a,b){return a===b},h=function(a){return!!a},i=[];function j(a,c,d){var e=[];c=c.map(function(a){return a.has(d)}).toList();b("findRangesImmutable")(c,g,h,function(c,f){var g=a.getText();e.push({offset:b("UnicodeUtils").strlen(g.slice(0,c)),length:b("UnicodeUtils").strlen(g.slice(c,f)),style:d})});return e}function a(a){var b=a.getCharacterList().map(function(a){return a.getStyle()}).toList(),c=b.flatten().toSet().map(function(c){return j(a,b,c)});return Array.prototype.concat.apply(i,c.toJS())}e.exports=a}),null);
__d("convertFromDraftStateToRaw",["invariant","ContentBlock","ContentBlockNode","DraftStringKey","encodeEntityRanges","encodeInlineStyleRanges"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=function(a,c){return{key:a.getKey(),text:a.getText(),type:a.getType(),depth:a.getDepth(),inlineStyleRanges:b("encodeInlineStyleRanges")(a),entityRanges:b("encodeEntityRanges")(a,c),data:a.getData().toObject()}},i=function(a,c,d,e){__p&&__p();if(a instanceof b("ContentBlock")){d.push(h(a,c));return}a instanceof b("ContentBlockNode")||g(0,5797);var f=a.getParentKey();a=e[a.getKey()]=babelHelpers["extends"]({},h(a,c),{children:[]});if(f){e[f].children.push(a);return}d.push(a)},j=function(a,c){__p&&__p();var d=c.entityMap,e=[],f={},g={},h=0;a.getBlockMap().forEach(function(a){a.findEntityRanges(function(a){return a.getEntity()!==null},function(c){c=a.getEntityAt(c);var e=b("DraftStringKey").stringify(c);if(g[e])return;g[e]=c;d[e]=""+h;h++}),i(a,d,e,f)});return{blocks:e,entityMap:d}},k=function(a,c){var d=c.blocks;c=c.entityMap;var e={};Object.keys(c).forEach(function(c,d){c=a.getEntity(b("DraftStringKey").unstringify(c));e[d]={type:c.getType(),mutability:c.getMutability(),data:c.getData()}});return{blocks:d,entityMap:e}};a=function(a){var b={entityMap:{},blocks:[]};b=j(a,b);b=k(a,b);return b};e.exports=a}),null);
__d("XVideoEditDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/edit/dialog/",{video_id:{type:"Int"},source:{type:"Enum",enumType:1},story_dom_id:{type:"String"},timeline_identifier:{type:"String"},post_id:{type:"String"},video_asset_id:{type:"Int"},entry_point:{type:"Enum",enumType:1},tab:{type:"Enum",enumType:1},__asyncDialog:{type:"Int"}})}),null);