var tryItem=function(){return $(".trycontent").html(""),$.post("/freetry/report_jingpin?item_id={%$item_id%}",function(t){0==t.errno?($(".gotry").show(),$("#tryContent").show(),$("#tryContent .gTit .vmore").html('<a href="/try?season='+t.data.reports[0].season+'" data-monitor="goodsdetails_try_more">\u67e5\u770b\u66f4\u591a</a>'),$(".trycontent").html(template("tpl_try",t.data)),$(".trybox dt img").lazyload({effect:"fadeIn"})):($(".gotry").hide(),$(".c a[name=gTry]").remove(),$("#tryContent").remove())},"json")},shopItem=function(){var t={cartTip:function(t){var i=['<div class="dialog-addtocart">','<div class="dialog-bar">',"\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66",'<a href="#" onclick="return false;" class="dialog-close" title="\u5173\u95ed"></a>',"</div>",'<div class="dialog-content">','<p><span class="ico"></span>\u5546\u54c1\u5df2\u6210\u529f\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66</p>','<div class="dialog-console">','<a class="console-btn-continue" href="#" onclick="return false;" title="\u7ee7\u7eed\u8d2d\u7269">\u7ee7\u7eed\u8d2d\u7269</a>','<a class="console-btn-gocart" href="#" onclick="return false;" title="\u53bb\u8d2d\u7269\u8f66\u7ed3\u7b97">\u53bb\u8d2d\u7269\u8f66\u7ed3\u7b97<span></span></a>',"</div>","</div>","</div>"].join(""),r=$(i).appendTo("body"),a=r.filter(".dialog-addtocart"),n=($(window).width()-368)/2,o=$(window).scrollTop()+200;a.css("left",n),a.css("top",o),r.filter(".dialog-bg").css("height",$(document).height()),r.find("a.console-btn-continue,a.dialog-close").click(function(){window.location.reload()}),r.find("a.console-btn-gocart").click(function(){location.href="/shop/shopcart"})},warTip:function(t){$(".mask").show();var i=['<div class="dialog-war">','<div class="dialog-bar">',"\u63d0\u793a",'<a href="#" onclick="return false;" class="dialog-close" title="\u5173\u95ed"></a>',"</div>",'<div class="dialog-content">',"<p>"+t+"</p>",'<div class="dialog-console">','<a class="console-btn-confirm" href="#" onclick="return false;" title="\u786e\u5b9a">\u786e\u5b9a</a>',"</div>","</div>","</div>"].join(""),r=$(i).appendTo("body"),a=r.filter(".dialog-war"),n=($(window).width()-a.width())/2;a.css("left",n),a.css("top","200px"),r.filter(".dialog-bg").css("height",$(document).height()),r.find("a.dialog-close,a.console-btn-confirm").click(function(){$(".dialog-war").remove(),$(".mask").hide()})}};return{init:function(t){var a,n,o,i,r;n=$(".c .gTab").offset().top+100,o=$("#gInfoBar .links a").filter(function(t,i){return"#"===$(i).attr("href").substr(0,1)}).map(function(t,i){return $(".c a[name="+$(i).attr("href").substr(1)+"]")}),$(window).scroll(function(){var t=$(document).scrollTop();t<n&&$("#gInfoBar").css({top:"-70px"}),clearTimeout(a),a=setTimeout(function(){n<t?$("#gInfoBar").animate({top:"0"},300):$("#gInfoBar").animate({top:"-70px"},300)},500);var i=$.map(o,function(t){var i=parseInt(t.css("margin"),10),r=parseInt(t.css("top"),10);return i=isNaN(i)?0:i,r=isNaN(r)?0:r,t.offset().top+i+r});try{if(top[0]>t)return}catch(t){}$("#gInfoBar .links a.cur").index();for(var r=0;r<i.length-1;++r)if(i[r]<t&&i[r+1]>=t)return $("#gInfoBar .links a").removeClass("cur"),void $("#gInfoBar .links a").eq(r).addClass("cur");$("#gInfoBar .links a").removeClass("cur"),$("#gInfoBar .links a").eq(i.length-1).addClass("cur")}),$("#glist").delegate("li","click",function(t){if("cur"==$(this).attr("class"))return!1}),(i={})[$(".gift").data("itemid")]=1,$.get("/shop/getbuyfreeinfo",{itemid:JSON.stringify(i)},function(t){t&&0==t.errno&&t.data&&$.each(t.data,function(t,i){var r=i.buyfree,n=['<ul class="gift-list gift-collapse">'];$.each(r,function(t,i){var r;if($.each(i.data,function(t,i){0!=i.item_status||r||(r=i)}),!r&&i.data.length&&(r=i.data.pop()),r){var a=r;n.push('<li><a class="gift-name" href="/shop/item?item_id='+a.item_id+'" target="_blank">\u9001'),n.push(a.iteminfo.title),n.push("</a>"),n.push('<i class="gift-count">'),a.count>a.item_amount?n.push("\uff08\u5df2\u552e\u5b8c\uff09"):n.push("x"+a.item_num),n.push("</i></li>")}}),n.push("</ul>"),$(".gift").append(n.join("")),1<$(".gift-list li").length&&($(".gift").append('<i class="gift-arrow gift-arrowup"></i>'),$(".gift-arrow").on("click",function(){if($(".gift-arrowdown")&&0<$(".gift-arrowdown").length){(a=$(".gift-arrowdown")).addClass("gift-arrowup").removeClass("gift-arrowdown"),a.addClass("gift-arrowup").removeClass("gift-arrowdown");var t=$(".gift-list"),i=t.height(),r=t.css("height","auto").height();t.height(i).animate({height:r})}else if($(".gift-arrowup")&&0<$(".gift-arrowup").length){var a;(a=$(".gift-arrowup")).addClass("gift-arrowdown").removeClass("gift-arrowup"),a.addClass("gift-arrowdown").removeClass("gift-arrowup"),$(".gift-list").animate({height:"28px"})}})),$(".gift").show()})},"json"),r=t,$(".favorite").on("click",function(){if(r){var i=$(this);i.data("lock")||QHPass.getUserInfo(function(){i.data("lock",1),i.hasClass("nofav")?$.post("/favo/add",{item_id:r},function(t){i.data("lock",""),0!=t.errno&&"15002"!=t.errno||i.removeClass("nofav"),t.errmsg&&qikoo.dialog.alert(t.errmsg)},"json"):$.post("/favo/del",{item_id:r},function(t){i.data("lock",""),0==t.errno&&i.addClass("nofav"),t.errmsg&&qikoo.dialog.alert(t.errmsg)},"json")},function(){QHPass.signIn()})}})},cartTip:t.cartTip,warTip:t.warTip}}();$(function(){$(".consult").find("dd i").remove(),$(".consult").find("dd").prepend($("<i></i>"))}),$(function(){var r;null!=window.template&&($(".dp_prd_wrap").length<1||($(".dp_prd_wrap").width(215*$(".dp_prd").length+5),4<$(".dp_prd").length&&$(".scroll_wrap").width(660),$.getJSON("/shop/getChoiedList",{item_id:qikoo.getUrlParam("item_id")},function(t){var r=[];$.each(t.data,function(t,i){$.each(i.childs,function(t,i){r.push(i)})}),0<r.length&&$(".dp_wrap,.dp_wrap_title").show(),$(".dp_prd_wrap").html(template("tpl_dapei",{list:r})),setTimeout(function(){$(".dp_prd_wrap").width(210*$(".dp_prd").length+5),4<$(".dp_prd").length&&($(".scroll_wrap").width(640),$(".scroll_wrap").css({"overflow-x":"scroll"}))}),$(".dp_wrap_pimg_ori img").attr("src",$(".scroll-items img").eq(0).attr("src"))}),r=[],$("body").on("click",".dp_prd_wrap",function(){r=[];var t=0;$(this).find("input[type=checkbox]:checked").each(function(){r.push($(this).data("item")),t+=parseFloat($(this).data("price"))}),$(".dq_price span").html("\uffe5"+(prd.price+t)),$(".dp_num").html("\u5df2\u9009\u62e9"+$(this).find("input[type=checkbox]:checked").length+"\u4e2a\u914d\u4ef6")}),$("body").on("click",".dq_addcart",function(){var i=this;QHPass.when.signIn(function(){1!=$(i).data("running")&&$(i).data("running",!0),$.getJSON("/shop/addtocartMulti",{item_id:qikoo.getUrlParam("item_id"),num:$(".goodsCount").val(),ids:r},function(t){$(i).data("running",!0),0==t.errno?location.href="/shop/shopcart":qikoo.dialog.alert(t.errmsg)})})})))}),$(function(){!function(){$(".picbox").delegate(".tinypic","mouseenter",function(){return $(".picbox .tinypic").removeClass("cur"),$(".bigImg img").attr("src",$(this).find("img").attr("src")),$(this).addClass("cur"),!1});var r=function(){return parseInt($(".pic-selector .scroll .scroll-items").css("left"),10)},a=function(){var t=r();0==t?$(".picbox .pic-selector .left").addClass("leftdisabled"):$(".picbox .pic-selector .left").removeClass("leftdisabled"),t<=106*($(".picbox .pic-selector .tinypic").length-5)*-1?$(".picbox .pic-selector .right").addClass("rightdisabled"):$(".picbox .pic-selector .right").removeClass("rightdisabled")};$(".picbox .pic-selector .right").click(function(){if($(this).hasClass("rightdisabled")||$(this).hasClass("locked"))return!1;var t=this;$(t).addClass("locked");var i=r();$(".pic-selector .scroll .scroll-items").animate({left:i-106+"px"},"fast",function(){$(t).removeClass("locked"),a()})}),$(".picbox .pic-selector .left").click(function(){if($(this).hasClass("leftdisabled")||$(this).hasClass("locked"))return!1;var t=this;$(t).addClass("locked");var i=r();$(".pic-selector .scroll .scroll-items").animate({left:i+106+"px"},"fast",function(){$(t).removeClass("locked"),a()})}),a()}()}),$(function(){if(0<$(".handbuy").length)if(-1==remain)$(".handbuy").hide();else{var t=parseInt(remain/86400);hour=parseInt((remain-86400*t)/3600),min=parseInt((remain-86400*t-3600*hour)/60),sec=parseInt(remain%60),secString=hourString=minString=dayString="";var i=setInterval(function(){sec--,-1==sec&&(0<min?(min--,sec=59):0==min&&(0<hour?(hour--,min=59,sec=59):0==hour&&0<t&&(t--,hour=23,min=59,sec=59))),sec<10?secString="0"+sec:secString=sec.toString(),min<10?minString="0"+min:minString=min.toString(),hour<10?hourString="0"+hour:hourString=hour.toString(),dayString=t<10?"0"+t:t.toString(),$(".day1").html(dayString.substring(0,1)),$(".day2").html(dayString.substring(1,2)),$(".hour1").html(hourString.substring(0,1)),$(".hour2").html(hourString.substring(1,2)),$(".min1").html(minString.substring(0,1)),$(".min2").html(minString.substring(1,2)),$(".sec1").html(secString.substring(0,1)),$(".sec2").html(secString.substring(1,2)),0==t&&0==hour&&0==min&&0==sec?(clearInterval(i),$("#itemshow").hide()):$("#itemshow").show()},1e3)}}());