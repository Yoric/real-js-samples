window._.Module.define({path:"encourage-tbguess/widget/mixin",requires:["encourage-payment/widget/base_user_data","tbui/widget/login_dialog"],sub:{initial:function(e){this.opt=e,this.Dialog=$.dialog,this.pageData=window.PageData||{},!window.EncourageData&&(window.EncourageData={}),this.encourageData=window.EncourageData,this.encourageData.userScore=this.encourageData.userScore||{},this.userData=this.requireInstance("encourage-payment/widget/base_user_data"),this.userInfo=$.extend({},this.pageData.user,this.userData.getSimpleUserData()),this.time=new Date,this.resource={drawFlag:"//tb2.bdstatic.com/tb/img/icon-draw_334a356.png"},this.apis={genBuyBeanOrder:{url:"tbmall/submit/guess/buyGuessDou",method:"POST"},submitGuess:{url:"/tbguess/submit/european/addGuessOrder",method:"POST"},submitExchange:{url:"/tbguess/submit/european/exchangeOrder",method:"POST"},applyTbKey:{url:"/tbguess/submit/european/acquireTcode",method:"POST"},getNormalKey:{url:"/tbguess/european/getOrdinaryKey",method:"GET"},setUserInfo:{url:"/tbguess/submit/european/addExchangeInfo",method:"POST"},getPayInfo:{url:"/tbmall/open/getBuyForm",method:"POST"},payGoods:{url:"/tbmall/submit/open/pay",method:"POST"}},this.dataApis={userInfo:{url:"/tbmall/mall/getIncomeOrder?pn=1&c=1",field:"user"}},this.dataPool={}},getData:function(e){var t;return this.dataPool[e]instanceof $.Deferred?this.dataPool[e]:(t=new $.Deferred,this.dataPool.hasOwnProperty(e)?this.dataPool[e]?t.resolveWith(null,[this.dataPool[e]]):t.reject():(this.dataPool[e]=t.promise(),this.submit(this.dataApis[e],{},!1).then($.proxy(function(i){this.dataPool[e]=this.dataApis[e].field?$.getPageData(this.dataApis[e].field,null,i):i,t.resolveWith(null,[this.dataPool[e]])},this),$.proxy(function(){this.dataPool[e]=null,t.reject()},this))),t.promise())},bindData:function(e){$.extend(this,e),this.mineGuessInfo=this.mineGuessInfo||{cup:0,bean:0,count:0},this.mineAwardMap=this.mineAwardMap||{},this.homeForum=this.homeForum||"\u7ade\u6280\u4f53\u80b2"},clipboard:function(e,t,i){var a=this;i=i||new $.Deferred;var o=function(){o.binded||t.on("click",function(){a.alert("\u590d\u5236\u5931\u8d25, \u8bf7\u624b\u52a8\u590d\u5236","error")}),o.binded=!0};if(!window.ZeroClipboard)return this.clipboardLoading===!1?(o(),i.rejectWith(null,["load"]),i.promise()):(this.clipboardLoading?this.clipboardLoading.done($.proxy(this.clipboard,this,e,t,i)):(this.clipboardLoading=new $.Deferred,this.clipboardLoading.done($.proxy(this.clipboard,this,e,t,i)),$.JsLoadManager.loadUrl("//tb1.bdstatic.com/tb/static-encourage-tbguess/dep/ZeroClipboard_825bbc3.js",$.proxy(function(){this.clipboardLoading.resolve(),this.clipboardLoading=!!window.ZeroClipboard},this))),i.promise());t.tbattr("data-clipboard-text",e);var n=new window.ZeroClipboard(t);return n.on("load",$.proxy(function(e){e.on("complete",$.proxy(this.alert,this,"\u590d\u5236\u6210\u529f","success",void 0))},this)),n.on("noFlash wrongFlash",o),i.resolveWith(null,n),i.promise()},exchange:function(e,t,i){this.mineAwardMap[e.id]=t,"exchange"===i&&this.bean(-e.price),this.trigger("exchange:add",e,i)},bean:function(e){this.mineGuessInfo.bean+=e,this.trigger("bean:change",e,this.mineGuessInfo.bean)},guess:function(e,t,i){this.mineGuessInfo.count+=1,this.bean(-i),this.trigger("guess:add",e,t,i)},formatNumber:function(e){return e=+e||0,e>=1e4?e>=1e7?Math.floor(e/1e7)+"KW":Math.floor(e/1e4)+"W":e},buildDialog:function(e,t,i){var a=new this.Dialog({title:e,html:t,width:"exchange"===i?520:660,showShadow:!1});return a.elementWrapper.addClass("guess-dialog "+i),a.setPosition(),a},alert:function(e,t,i){t=t||"error",i=void 0===i?1e3:i;var a=new this.Dialog({width:"auto",title:e,modal:!1,closeable:!1,showShadow:!1});a.elementWrapper.addClass("guess-dialog tips "+t),a.setPosition(),a.elementWrapper.on("click",$.proxy(a.close,a));var o=a.close;return a.close=function(){a.element.animate({opacity:0},700,function(){o.call(a)})},i&&setTimeout(function(){a.close()},i),a},submit:function(e,t,i){"POST"===e.method&&(t=t||{},t.tbs=t.tbs||this.pageData.tbs);var a=$.ajax({url:e.url,type:e.method||"GET",dataType:"json",context:this,data:t}).pipe(function(e){return 0===e.no?e.data:(new $.Deferred).rejectWith(this,[e])},function(){return{no:-1,error:"\u7f51\u7edc\u9519\u8bef"}});return i?a.pipe(null,$.proxy(function(e){return this.alert("\u7cfb\u7edf\u7e41\u5fd9, \u8bf7\u7a0d\u5019\u518d\u8bd5~"),e},this)):a},checkLogin:function(e,t){return t||!this.pageData.user.is_login?(e&&this.requireInstance("tbui/widget/login_dialog"),!1):!0},trackFn:function(e,t){return function(i,a){a="string"==typeof a&&a?a:"click",$.stats.track(i,e,t,a)}}}});window._.Module.define({path:"encourage-tbguess/widget/bean",requires:["encourage-tbguess/widget/mixin"],sub:{initial:function(i){this.opt=i;var s=window.baidu.template;this.template={bean:s('<div class="bean">\n    <div class="field good">\n        <div class="label">\u8d2d\u4e70\u5546\u54c1:</div>\n        <ul class="body">\n            <li class="item bean active" style="display: block">\n                <div class="body">\n                    <i class="guess-icon bean-12"></i>\n                    <span>\u7ade\u731c\u8c46</span>\n                </div>\n                <div class="intro">10000\u7ade\u731c\u8c46\uff1d10000T\u8c46</div>\n            </li>\n        </ul>\n    </div>\n    <div class="field num">\n        <div class="label">\u8d2d\u4e70\u6570\u91cf:</div>\n        <div class="body">\n            <ul class="templates">\n                <% for(var i = 0; i < numTpls.length; i++) { %>\n                <li class="num-radio">\n                    <span class="value"><%- numTpls[i] %></span>\n                    <span>\u4e2a</span>\n                </li>\n                <% } %>\n            </ul>\n            <div class="manual">\n                <div class="input">\n                    <input maxlength="10" type="text" class="num-input" placeholder="\u8bf7\u8f93\u5165\u8981\u8d2d\u4e70\u7684\u4e2a\u6570"/>\n                </div>\n                <div class="tail">\u4e2a\u7ade\u731c\u8c46</div>\n                <div class="error">\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4e2a\u6570</div>\n            </div>\n        </div>\n    </div>\n    <div class="field result">\n        <div class="label">\u6240\u9700T\u8c46:</div>\n        <div class="body">\n            <div class="result">\n                <i class="icon-tbean"></i>\n                <span class="value"></span>\n            </div>\n            <div class="error">\u60a8\u7684T\u8c46\u4f59\u989d\u4e0d\u8db3, \u8bf7\u5148\u83b7\u53d6T\u8c46.</div>\n        </div>\n    </div>\n    <div class="action">\n        <div class="guess-btn exchange submit">\u7acb\u5373\u5151\u6362</div>\n        <div class="guess-btn exchange buy">\u83b7\u53d6T\u8c46</div>\n    </div>\n</div>\n')},this.mixin=this.getInstance("encourage-tbguess/widget/mixin"),this.icons=this.requireInstance("user/widget/icons"),this.userApi=this.requireInstance("user/widget/user_api"),this.numTpls=[5e3,1e4,2e4,5e4,1e5],this.defaultNumIndex=1,this.dialog=null,this.track=this.mixin.trackFn("\u8d34\u5427\u7ade\u731c\u83b7\u53d6\u7ade\u731c\u8c46\u90e8\u5206","\u5176\u4ed6\u9875\u9762"),this.bind("ui:main:create",this.clear,this)},buy:function(i){return this.mixin.submit(this.mixin.apis.genBuyBeanOrder,{score:i}).pipe($.proxy(function(s){var n=new $.Deferred;return s.from="\u8d34\u5427\u7ade\u731c",s.notShowSucTips=!0,s.goods_image=s.goods_image||"//tb2.bdstatic.com/tb/img/bean-18_b96503a.png",this.requireInstance("encourage-payment/widget/tdou_view_pay",$.proxy(function(s){s=s||{},s.data=s.data||{},"encourage_paid"===s.command?"success"===s.data.error?(n.resolveWith(this,[s.data.data||{}]),this.mixin.bean(i)):n.rejectWith(this,[s]):"ui:main:create"===s.command&&this.trigger("ui:main:create",s.data)},this)).createMain(s),n.promise()},this))},submit:function(){this.buy(this.num).then($.proxy(function(){this.clear(),this.mixin.alert("\u8d2d\u4e70\u6210\u529f!","success")},this),$.proxy(function(){this.$submitBtn.removeClass("disabled").html("\u7acb\u5373\u5151\u6362"),this.mixin.alert("\u8d2d\u4e70\u5931\u8d25","error")},this))},setNum:function(i){var s;return/^[1-9]\d*$/.test(String(i))?(i=parseInt(i,10),this.mixin.userData.getUserTdou()<i?this.disable("tbean"):this.disable(),this.num=i,this.$resultValue.html(i),!!s):this.disable("format")},disable:function(i){return this.$limitError.hide(),this.$beanError.hide(),this.$buyBtn.hide(),this.$submitBtn.removeClass("disabled"),"format"===i&&(this.$limitError.show(),this.$submitBtn.addClass("disabled")),"tbean"===i&&(this.$beanError.show(),this.$submitBtn.addClass("disabled"),this.$buyBtn.show()),!1},clear:function(){this.dialog&&this.dialog.elementWrapper.off()&&this.dialog.close(),this.$resultValue=this.$limitError=this.$beanError=this.$numInput=this.$submitBtn=this.$buyBtn=void 0},buildDialog:function(){var i=this;i.clear(),i.dialog=i.mixin.buildDialog("\u83b7\u53d6\u7ade\u731c\u8c46",i.template.bean(i),"buy");var s=i.dialog.elementWrapper;i.$resultValue=s.find(".result>.value"),i.$limitError=s.find(".manual>.error"),i.$beanError=s.find(".result>.body>.error"),i.$numInput=s.find(".num-input"),i.$submitBtn=s.find(".guess-btn.submit"),i.$buyBtn=s.find(".guess-btn.buy"),s.on("click",".num-radio:not(.active)",function(){var s=$(this);s.addClass("active").siblings(".active").removeClass("active"),i.$numInput.val(""),i.setNum(s.find(".value").html())}).on("keydown",".num-input",function(i){i.keyCode>47&&i.keyCode<58||8===i.keyCode||i.preventDefault()}).on("keyup",".num-input",function(){s.find(".num-radio.active").removeClass("active"),i.setNum(i.$numInput.val())}).on("click",".guess-btn.submit:not(.disabled)",function(){i.$submitBtn.html("T\u8c46\u5151\u6362\u4e2d...").addClass("disabled"),i.submit()}).on("click",".guess-btn.buy",function(){var s={};s.consumption_path=130,i.clear(),i.requireInstance("encourage-payment/widget/tcharge_dialog",s)}),s.find(".num-radio").eq(i.defaultNumIndex).trigger("click");var n=i.userApi.checkUniversalMembershipOf(i.mixin.userInfo);s.find(".dialogJtitle").append($('<div class="right-item bean"></div>').html('<span class="label">T\u8c46\u4f59\u989d:</span><i class="icon-tbean"></i><span class="value">'+i.mixin.userData.getUserTdou()+"</span>")).append($('<div class="right-item username">').html('<span class="label">\u8d26\u53f7:</span>'+i.icons.getPreIconHtml(i.mixin.userInfo.mParr_props,i.mixin.userInfo,!0)+'<span class="value '+(n?"red":"")+'">'+i.mixin.pageData.user.name+"</span>")),s.on("click",".username>.value",$.proxy(this.track,this,"\u83b7\u53d6\u7ade\u731c\u8c46\u5f39\u5c42-\u7528\u6237\u540d\u79f0")).on("click",".username>i",$.proxy(this.track,this,"\u83b7\u53d6\u7ade\u731c\u8c46\u5f39\u5c42-\u4f1a\u5458ICON")).on("click",".num-radio",function(){i.track("\u83b7\u53d6\u7ade\u731c\u8c46\u5f39\u5c42-\u8d2d\u4e70\u6570\u91cf"+$(this).find(".value").html())}).on("focus",".num-input",$.proxy(this.track,this,"\u83b7\u53d6\u7ade\u731c\u8c46\u5f39\u5c42-\u8d2d\u4e70\u6570\u91cf\u6587\u672c\u6846")).on("click",".guess-btn.submit",$.proxy(this.track,this,"\u83b7\u53d6\u7ade\u731c\u8c46\u5f39\u5c42-\u7acb\u5373\u5151\u6362")).on("click",".guess-btn.buy",$.proxy(this.track,this,"\u83b7\u53d6\u7ade\u731c\u8c46\u5f39\u5c42-\u83b7\u53d6T\u8c46"))}}});window._.Module.define({path:"encourage-tbguess/widget/guess",requires:["encourage-tbguess/widget/mixin","encourage-tbguess/widget/bean"],sub:{initial:function(s){this.opt=s;var i=window.baidu.template;this.mixin=this.getInstance("encourage-tbguess/widget/mixin"),this.bean=this.getInstance("encourage-tbguess/widget/bean"),this.userApi=this.requireInstance("user/widget/user_api"),this.icons=this.requireInstance("user/widget/icons"),this.safeAjax=this.requireInstance("encourage-payment/widget/tbean_safe_ajax"),this.template={guess:i('<div class="guess">\n    <div class="base">\n        <div class="flag">\n            <img src="<%- team.type === \'draw\' ? mixin.resource.drawFlag : team.flag %>"/>\n        </div>\n        <div class="name">\n            <% if(team.type === \'draw\') { %>\n            <span class="team"><%= game.homeTeamName %></span>\n            <span class="vs">vs</span>\n            <span class="team"><%= game.awayTeamName %></span>\n            <% } else { %>\n            <span class="team"><%= team.name %></span>\n            <% } %>\n        </div>\n    </div>\n    <div class="field num">\n        <div class="label">\u52a9\u653b\u6570\u91cf:</div>\n        <div class="body">\n            <ul class="templates">\n                <% for(var i = 0; i < numTpls.length; i++) { %>\n                <li class="num-radio">\n                    <span class="value"><%- numTpls[i] %></span>\n                    <span>\u4e2a</span>\n                </li>\n                <% } %>\n            </ul>\n            <div class="manual">\n                <div class="input">\n                    <input maxlength="9" type="text" class="num-input" placeholder="\u8bf7\u8f93\u5165\u8981\u52a9\u653b\u7684\u4e2a\u6570"/>\n                </div>\n                <div class="tail">\u4e2a\u7ade\u731c\u8c46</div>\n                <div class="error">\u6bcf\u6b21\u6295\u6ce8\u6700\u4f4e\u4e0d\u5f97\u5c11\u4e8e300\u7ade\u731c\u8c46</div>\n            </div>\n        </div>\n    </div>\n    <div class="field result">\n        <div class="label">\u6240\u9700\u7ade\u731c\u8c46:</div>\n        <div class="body">\n            <div class="result">\n                <i class="guess-icon bean-18"></i>\n                <span class="value"></span>\n                <span class="guess">\n                    <span>\u9884\u8ba1\u6536\u76ca</span>\n                    <span class="value"></span>\n                    <span>\u4e2a\u7ade\u731c\u8c46</span>\n                </span>\n            </div>\n            <div class="error">\u60a8\u7684\u7ade\u731c\u8c46\u4f59\u989d\u4e0d\u8db3, \u8bf7\u5148\u83b7\u53d6\u7ade\u731c\u8c46.</div>\n        </div>\n    </div>\n    <div class="action">\n        <div class="guess-btn exchange guess">\u7acb\u5373\u52a9\u653b</div>\n        <div class="guess-btn exchange buy">\u83b7\u53d6\u7ade\u731c\u8c46</div>\n    </div>\n</div>')},this.dialog=null,this.game=null,this.team=null,this.num=null,this.defaultNumIndex=2,this.numTpls=[300,500,1e3,2e3,5e3],this.track=this.mixin.trackFn("\u8d34\u5427\u7ade\u731c-\u9875\u9762\u70b9\u51fb\u7edf\u8ba1","\u9996\u9875")},getExpect:function(){var s=this.game.guessHome+this.game.guessAway+this.num;return 1===this.game.type&&(s+=this.game.guessDraw),Math.round(.95*s*this.num/(this.team.guessNum+this.num))},guess:function(s,i,e){return this.mixin.submit(this.mixin.apis.submitGuess,{matchId:s.id,type:i.type,score:e},!1).pipe($.proxy(function(s){return s.from="\u8d34\u5427\u7ade\u731c",s.goods_image=s.goods_image||"//tb2.bdstatic.com/tb/img/bean-18_b96503a.png",this.mixin.submit(this.mixin.apis.getPayInfo,s,!1)},this)).pipe($.proxy(function(s){var i=s.order_info,e={};return e.order_id=i.order_id,e.open_id=i.open_id,e.scene_id=i.scene_id,e.pay_type=i.pay_type,e.tbs=this.mixin.pageData.tbs,this.safeAjax.ajax({url:this.mixin.apis.payGoods.url,data:e,type:"POST",cache:!1,dataType:"json"}).pipe(function(s){var i=new $.Deferred;return s&&0===+s.no?i.resolveWith(null,[s.data]):i.rejectWith(null,[s||{no:-2,error:"\u6570\u636e\u89e3\u6790\u9519\u8bef"}]),i})},this)).done($.proxy(function(){this.mixin.guess(s,i,e)},this))},submit:function(){this.guess(this.game,this.team,this.num).then($.proxy(function(){console.log.apply(console,[].slice.call(arguments)),this.clear(),this.mixin.alert("\u7ade\u731c\u6210\u529f!","success")},this),$.proxy(function(){this.$guessBtn.removeClass("disabled").html("\u7acb\u5373\u52a9\u653b"),this.mixin.alert("\u7ade\u731c\u5931\u8d25!","error")},this))},setNum:function(s){var i={};return/^\d+$/.test(String(s))?(s=parseInt(s,10),300>s?(i.limit="\u6bcf\u6b21\u6295\u6ce8\u6700\u4f4e\u4e0d\u5f97\u5c11\u4e8e300\u7ade\u731c\u8c46",this.disable(i)):(this.mixin.mineGuessInfo.bean<s?(i.bean="\u60a8\u7684\u7ade\u731c\u8c46\u4e0d\u8db3\uff0c\u8bf7\u5148\u83b7\u53d6\u7ade\u731c\u8c46\u3002",this.disable(i)):this.disable(i),this.num=s,this.$resultValue.html(s),this.$guessValue.html(this.getExpect()),!!i.bean)):(i.limit="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6570\u503c",this.disable(i))},disable:function(s){return this.$limitError.hide(),this.$beanError.hide(),this.$buyBtn.hide(),this.$guessBtn.removeClass("disabled"),s.limit&&(this.$limitError.html(s.limit).show(),this.$guessBtn.addClass("disabled"),this.$guessValue.html("0"),this.$resultValue.html("0")),s.bean&&(this.$beanError.show(),this.$guessBtn.addClass("disabled"),this.$buyBtn.show()),!1},clear:function(s,i){this.dialog&&this.dialog.elementWrapper.off()&&this.dialog.close(),this.game=s,this.team=i,this.$resultValue=this.$guessValue=this.$limitError=this.$beanError=this.$numInput=this.$guessBtn=this.$buyBtn=void 0},buildDialog:function(s,i){var e=this;e.clear(s,i),e.dialog=e.mixin.buildDialog("\u52a9\u653b\u7403\u961f",e.template.guess(e),"buy");var n=e.dialog.elementWrapper;e.$resultValue=n.find(".result>.value"),e.$guessValue=n.find(".result>.guess>.value"),e.$limitError=n.find(".manual>.error"),e.$beanError=n.find(".result>.body>.error"),e.$numInput=n.find(".num-input"),e.$guessBtn=n.find(".guess-btn.guess"),e.$buyBtn=n.find(".guess-btn.buy"),n.on("click",".num-radio:not(.active)",function(){var s=$(this);s.addClass("active").siblings(".active").removeClass("active"),e.$numInput.val(""),e.setNum(s.find(".value").html())}).on("keydown",".num-input",function(s){s.keyCode>47&&s.keyCode<58||8===s.keyCode||s.preventDefault()}).on("keyup",".num-input",function(){n.find(".num-radio.active").removeClass("active"),e.setNum(e.$numInput.val())}).on("click",".guess-btn.guess:not(.disabled)",function(){e.$guessBtn.addClass("disabled").html("\u6295\u6ce8\u4e2d..."),e.submit()}).on("click",".guess-btn.buy",function(){e.clear(),e.bean.buildDialog()}),n.find(".num-radio").eq(e.defaultNumIndex).trigger("click"),n.find(".num-radio").eq(e.defaultNumIndex).trigger("click");var t=e.userApi.checkUniversalMembershipOf(e.mixin.userInfo);n.find(".dialogJtitle").append($('<div class="right-item bean"></div>').html('<span class="label">\u7ade\u731c\u8c46\u4f59\u989d:</span><i class="guess-icon bean-14"></i><span class="value margin-left">'+e.mixin.mineGuessInfo.bean+"</span>")).append($('<div class="right-item username">').html('<span class="label">\u8d26\u53f7:</span>'+e.icons.getPreIconHtml(e.mixin.userInfo.mParr_props,e.mixin.userInfo,!0)+'<span class="value '+(t?"red":"")+'">'+e.mixin.pageData.user.name+"</span>")),n.on("click",".username>.value",$.proxy(this.track,this,"\u52a9\u653b\u5f39\u5c42-\u7528\u6237\u540d\u79f0")).on("click",".username>i",$.proxy(this.track,this,"\u52a9\u653b\u5f39\u5c42-\u4f1a\u5458ICON")).on("click",".num-radio",function(){e.track("\u52a9\u653b\u5f39\u5c42-\u8d2d\u4e70\u6570\u91cf"+$(this).find(".value").html())}).on("focus",".num-input",$.proxy(this.track,this,"\u52a9\u653b\u5f39\u5c42-\u8d2d\u4e70\u6570\u91cf\u6587\u672c\u6846")).on("click",".guess-btn.guess",$.proxy(this.track,this,"\u52a9\u653b\u5f39\u5c42-\u7acb\u5373\u52a9\u653b\u6309\u94ae")).on("click",".guess-btn.buy",$.proxy(this.track,this,"\u52a9\u653b\u5f39\u5c42-\u83b7\u53d6\u7ade\u731c\u8c46\u6309\u94ae"))}}});window._.Module.define({path:"encourage-tbguess/widget/sidebar",requires:["encourage-tbguess/widget/mixin","encourage-tbguess/widget/guess"],sub:{initial:function(t){this.opt=$.extend({},t),this.$root=$(".guess-sidebar-container"),this.$football=this.$root.find(".body>.football"),this.$footballList=this.$football.children(),this.$footballItems=this.$football.find(".item"),this.footballItemWidth=this.$footballItems.width(),this.footballOffset=0,this.guess=this.getInstance("encourage-tbguess/widget/guess"),this.mixin=this.getInstance("encourage-tbguess/widget/mixin"),this.track=this.mixin.trackFn("\u8d34\u5427\u7ade\u731c-PC\u53f3\u4fa7\u8fb9\u680f",""),this.initUi(),this.initCountdown(),this.initEvent(),this.initTrack()},initUi:function(){var t=this.$footballList.find(".item").length;2>t&&this.$footballItems.find(".guess-footer>.action").remove(),1>t&&this.$root.remove()},initTrack:function(){this.track("PC\u53f3\u4fa7\u8db3\u7403\u7ade\u731cTAB\u8bbf\u95ee","view"),this.$root.on("click",".title>.football",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u8db3\u7403\u7ade\u731cTAB")).on("click",".title>.more",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u66f4\u591a")),this.$football.on("click","a.flag",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u8db3\u7403\u7ade\u731cICON")).on("click","a.flag",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u8db3\u7403\u7ade\u731cICON")).on("click",".home .sidebar-support",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u8db3\u7403\u7ade\u731c\u652f\u6301A\u961f")).on("click",".draw .sidebar-support",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u8db3\u7403\u7ade\u731c\u652f\u6301\u5e73\u5c40")).on("click",".away .sidebar-support",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u8db3\u7403\u7ade\u731c\u652f\u6301B\u961f")).on("click",".guess-footer>.action",$.proxy(this.track,this,"PC\u53f3\u4fa7-\u8db3\u7403\u7ade\u731c\u6362\u4e00\u573a"))},stopCountdown:function(t){t.remove(),this.initUi()},startCountdown:function(t,i){var e="00\u5929<br/>00:00:00";t.html("").css("visibility","visible");var s=setInterval($.proxy(function(){var a=i-new Date;if(0>=a)return this.stopCountdown(t.parents("li.item")),clearInterval(s),void 0;var n=[Math.floor(a/864e5),Math.floor(a%864e5/36e5),Math.floor(a%36e5/6e4),Math.floor(a%6e4/1e3)];t.html(e.replace(/\d+/g,function(){var t=n.shift();return 10>t?"0"+t:t.toString(10)}))},this),500)},initCountdown:function(){var t=this;this.$footballItems.each(function(){var i=$(this),e=i.find(".j-count-down"),s=new Date(1e3*e.html());t.startCountdown(e,s)})},initEvent:function(){var t=this;t.$footballItems.length>1&&t.$football.on("click",".guess-footer>.action",function(){t.footballOffset=(t.footballOffset+1)%t.$footballItems.length,t.$footballList.animate({marginLeft:-t.footballOffset*t.footballItemWidth},500)}),t.$football.on("click",".guess-btn.sidebar-support",function(){if(t.mixin.checkLogin(!0)){var i=$(this).parent().parent(),e=i.parents("li.item"),s=$.extend(e.data("data"),{homeTeamName:e.find(".home>.name").html(),awayTeamName:e.find(".away>.name").html(),guessHome:+e.find(".home>.percentage>.value").tbattr("title")||0,guessDraw:+e.find(".draw>.percentage>.value").tbattr("title")||0,guessAway:+e.find(".away>.percentage>.value").tbattr("title")||0}),a={type:i.data("role"),flag:i.find(".flag>img").tbattr("src"),name:i.find(".name").html(),mineGuessNum:+i.data("mine")||0,guessNum:+i.find(".percentage>.value").tbattr("title")||0};t.guess.buildDialog(s,a)}}),t.mixin.bind("guess:add",function(i,e,s,a){var n=e.guessHome+e.guessDraw+e.guessAway+a,o=Math.round(100*e.guessHome/n),r=Math.round(100*e.guessDraw/n),l=Math.round(100*e.guessAway/n),h=Math.round(100*(s.guessNum+a)/n),f=t.$root.find(".guess-"+e.id);f.find(".home>.percentage>.value").html(o+"%").next().find("span").css("width",o+"%"),f.find(".draw>.percentage>.value").html(r+"%").next().find("span").css("width",r+"%"),f.find(".away>.percentage>.value").html(l+"%").next().find("span").css("width",l+"%"),f.find("."+s.type+">.percentage>.value").html(h+"%").next().find("span").css("width",h+"%"),f.find("."+s.type).data("mine",s.mineGuessNum+a),f.find(".guess-footer .value").html(t.mixin.formatNumber(n))})}}});