if(window.Ya&&Ya.Rum){Ya.Rum.sendTimeMark("2095.2154");}function getcss(t){setTimeout(function(){var e=document.createElement("link");e.setAttribute("type","text/css"),e.setAttribute("rel","stylesheet"),e.setAttribute("href",t),document.getElementsByTagName("head").item(0).appendChild(e)},0)}function MordaRT(){this.listRE={}}function CoversAPI(){this.current=null,this.currentStatus=0,this.area=null,this.shareInstance=null,this.fadeTimeout=600}function cp(t,e,i){var n="clck/lid="+t;Lego.params.statRoot&&(n+="/sid="+Lego.params.msid);try{if((i=i||{}).host=Lego.params?Lego.params["click-host"]:null,home&&home.getData&&home.getData("i-counter.useBeacon")){var s=t.indexOf("news")>-1;if(function(t){if(!("sendBeacon"in navigator))return!1;for(var e,i,n=t.split("."),s=0;s<n.length;++s){var o={ctag:n[s]};i?i.children=[o]:e=[o],i=o}var r="/dtype=clck/session_id="+Lego.params.msid+'/events=[{"event":"click","parent-path":"'+Lego.params.statRoot+'","blocks":'+JSON.stringify(e)+"}]/*";return navigator.sendBeacon(home.getData("i-counter.clckBase")+"counter",r)}(t.replace(Lego.params.statRoot+".","")+(s?".beacon":"")))return!0;s&&(n=n.replace(t,t+".redir"))}Lego.c(n,e,i)}catch(t){}}function cpr(t,e,i){try{Lego.cred(t,e,i)}catch(t){}}function cpt(t,e){cp(t+=(document.getElementById("form").text.value?".full":".empty")+"/u="+(new Date).getTime(),e)}function c0(t){try{Lego.c(t)}catch(t){}}function csh(t,e){try{cp(t,e)}catch(t){}}function csh_ifmsid(t,e){Lego.params.statRoot&&csh(t,e)}function cpa(t){return t&&void 0!==Lego.params.msid?"onmousedown=\"Lego.cp('132','71946','"+t+"',this)\"":""}function statRedirect(t,e,i){var n,s,o=e&&Lego.params.statRoot;if(o&&(t=BEM.blocks["i-global"].param("click-href")+"redir/dtype=clck/lid="+e+"/sid="+Lego.params.msid+"/rnd="+((new Date).getTime()+Math.round(100*Math.random()))+"/*data="+encodeURIComponent("url="+encodeURIComponent(t.match(/^http/)?t:location.protocol+"//"+location.host+(t.match("^/")?t:"/"+t)))),"_blank"===i)return n=$("<form />"),s=function(){var e,i,s,r;if(o)return t;if((e=t.match(/((?:https?:)?(?:\/)?\/[^?]+)\?([^#]+)?(#\S+)?/))&&e[2])for(s=(i=e[2].split("&")).length;s--;)r=i[s].split("="),n.append($("<input/>").attr({type:"hidden",name:r[0],value:r[1]}));return e?e[1]:t}(),void n.attr({action:s,target:i}).appendTo($("body"))[0].submit();location.href=t}window.home=window.home||{},home.bundles=home.bundles||{},home.bundles.staticURL=home.bundles.staticURL||{},home.bundles.staticURL.stream={js:"//yastatic.net/www/_/n/q/YEf77BLdN0o-mDnQqsyGt6Wgg.js",css:"//yastatic.net/www/_/F/Z/VbPzjEGvwdzXc2X1DAA5sKeSY.css","css.webp":"//yastatic.net/www/_/9/T/FdWRgAXdbig4StlrXxVi-iK7w.css","js.gen":"//yastatic.net/www/_/9/T/D7iXxaLfhUADdNrjaD_EVr-Dg.js","css.gen":"//yastatic.net/www/_/7/K/Ypo7zxPlm6x0nEPkCflHU_s0g.css","css.gen.webp":"//yastatic.net/www/_/a/z/b46adRtn5Kg7C8BCKVNJa4RS0.css"},home.bundles.staticURL["stream-adblock"]={js:"//yastatic.net/www/_/A/K/PXj6JUhmckvNOnZcC736GwbsQ.js",css:"//yastatic.net/www/_/F/Z/VbPzjEGvwdzXc2X1DAA5sKeSY.css","css.webp":"//yastatic.net/www/_/9/T/FdWRgAXdbig4StlrXxVi-iK7w.css","js.gen":"//yastatic.net/www/_/V/Z/pU9rColCsf-Hf38pEIIjj04ZE.js","css.gen":"//yastatic.net/www/_/7/K/Ypo7zxPlm6x0nEPkCflHU_s0g.css","css.gen.webp":"//yastatic.net/www/_/a/z/b46adRtn5Kg7C8BCKVNJa4RS0.css"},home.bundles.staticURL["stream-adblock-etalon"]={js:"//yastatic.net/www/_/G/j/2WGQR4l6186By_Z1mEWKdyz7o.js",css:"//yastatic.net/www/_/F/Z/VbPzjEGvwdzXc2X1DAA5sKeSY.css","css.webp":"//yastatic.net/www/_/9/T/FdWRgAXdbig4StlrXxVi-iK7w.css","js.gen":"//yastatic.net/www/_/5/z/uVzzYbxnyhUmeJNDa44W6UpOM.js","css.gen":"//yastatic.net/www/_/7/K/Ypo7zxPlm6x0nEPkCflHU_s0g.css","css.gen.webp":"//yastatic.net/www/_/a/z/b46adRtn5Kg7C8BCKVNJa4RS0.css"},home.bundles.staticURL["user-points"]={js:"//yastatic.net/www/_/O/e/gJi24KdRviJ6F9GmnlGx1qeZ0.js",css:"//yastatic.net/www/_/I/I/kLm3OcaR9EJkfgdTXtoYCJ67A.css","css.webp":"//yastatic.net/www/_/p/L/4Ma6dQVIHu8wF9hJrRDObryog.css","js.gen":"//yastatic.net/www/_/n/A/KkFQWm7ZrY_wadfqf-QD6FvB4.js","css.gen":"//yastatic.net/www/_/I/I/kLm3OcaR9EJkfgdTXtoYCJ67A.css","css.gen.webp":"//yastatic.net/www/_/p/L/4Ma6dQVIHu8wF9hJrRDObryog.css"},home.bundles.staticURL.keyboard={js:"//yastatic.net/www/_/M/e/wBR6LQUDZga9ua-N9CF1KSLTI.js",css:"//yastatic.net/www/_/2/6/VLfyzbbc03LwkjH35cmrtOANw.css","css.webp":"//yastatic.net/www/_/f/G/K6eOW__jc3G9hBGl7R6YPU1OI.css","js.gen":"//yastatic.net/www/_/4/j/_duTBGVaytEwGvmlCixkdF1o.js","css.gen":"//yastatic.net/www/_/2/6/VLfyzbbc03LwkjH35cmrtOANw.css","css.gen.webp":"//yastatic.net/www/_/f/G/K6eOW__jc3G9hBGl7R6YPU1OI.css"},home.bundles.staticURL["direct-tgo1"]={js:"//yastatic.net/www/_/P/u/2GryrLqgxC7cmj1zYJ6Ddp8rU.js",css:"//yastatic.net/www/_/4/I/tpaFbqtw32BdMaMEK3hafDakw.css","css.webp":"//yastatic.net/www/_/4/I/tpaFbqtw32BdMaMEK3hafDakw.css","js.gen":"//yastatic.net/www/_/i/j/pBgMRY7PsFa_iGq8-g-igajDo.js","css.gen":"//yastatic.net/www/_/I/-/MqHR20yKHcSXHmhfFUdJgxug.css","css.gen.webp":"//yastatic.net/www/_/I/-/MqHR20yKHcSXHmhfFUdJgxug.css"},home.bundles.staticURL["direct-tgo2"]={js:"//yastatic.net/www/_/y/Z/cRXVs7OEwfJ_MW87YPNZSbTg8.js",css:"//yastatic.net/www/_/O/M/FY99W_KcLowdgUoqYFM-c1ruA.css","css.webp":"//yastatic.net/www/_/i/m/hygmQh6mb8hS0nUmojnX7zaOE.css","js.gen":"//yastatic.net/www/_/X/r/GNZqAo60mBkUnir5ch3lPLuck.js","css.gen":"//yastatic.net/www/_/G/I/waT0JbYsgabRpSeOlUTANJh28.css","css.gen.webp":"//yastatic.net/www/_/W/R/Xmtq3LElrDTfpr-CF10nvo8HU.css"},home.bundles.staticURL["direct-invertion"]={js:"//yastatic.net/www/_/4/u/tmygC9jttAQr21JPcvFtYqH1E.js",css:"//yastatic.net/www/_/X/g/Z2KtnfhN-JI247lOZnD-Yqi6g.css","css.webp":"//yastatic.net/www/_/b/I/gDIQcaivPevsyw_SHZLqGwXH0.css","js.gen":"//yastatic.net/www/_/D/Q/QePN7v9frTmaBAKS775iMPsGY.js","css.gen":"//yastatic.net/www/_/b/w/VOR8336cfxnUqdKf08AFxytnE.css","css.gen.webp":"//yastatic.net/www/_/N/A/8Nld2j75pMVsd9cUU_L6RXtYM.css"},function(t){var e=function(){return"_"}.toString().indexOf("_")>-1,i=function(){},n=Object.create||function(t){var e=function(){};return e.prototype=t,new e},s=Object.keys,o=t.extend,r=Array.isArray,a=t.isFunction,c=!0,l={toString:""};for(var h in l)l.hasOwnProperty(h)&&(c=!1);var u=c?["toString","valueOf"]:null;function d(i,n,o){for(var r,l,h=function(t){var e=s(t);if(c)for(var i,n=0;i=u[n++];)t.hasOwnProperty(i)&&e.push(i);return e}(o),d=0,m=h.length;d<m;)"__self"!==(r=h[d++])&&(l=o[r],a(l)&&(!e||l.toString().indexOf(".__base")>-1)?n[r]=function(e,s){var o=function(){var t=this.__base;this.__base=o.__base;var e=s.apply(this,arguments);return this.__base=t,e};return o.__base=i[e]||("__constructor"===e?n.__self.__parent:t.noop),o}(r,l):n[r]=l)}function m(e,i){for(var n,s=1;n=e[s++];)i?a(n)?t.inheritSelf(i,n.prototype,n):t.inheritSelf(i,n):i=a(n)?t.inherit(e[0],n.prototype,n):t.inherit(e[0],n);return i||e[0]}t.inherit=function(){var t=arguments,e=r(t[0]),s=e||a(t[0]),c=s?e?m(t[0]):t[0]:i,l=t[s?1:0]||{},h=t[s?2:1],u=l.__constructor||s&&c.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:s?function(){return c.apply(this,arguments)}:function(){};if(!s)return u.prototype=l,u.prototype.__self=u.prototype.constructor=u,o(u,h);o(u,c),u.__parent=c;var p=c.prototype,f=u.prototype=n(p);return f.__self=f.constructor=u,l&&d(p,f,l),h&&d(c,u,h),u},t.inheritSelf=function(){var t=arguments,e=r(t[0])?m(t[0],t[0][0]):t[0],i=t[1],n=t[2],s=e.prototype;return i&&d(s,s,i),n&&d(e,e,n),e},t.inherit.self=t.inheritSelf}(jQuery),function(t){var e=0,i="__"+Number(new Date),n=function(){return"uniq"+ ++e};t.identify=function(t,e){if(!t)return n();var s="uniqueID"in t?"uniqueID":i;return e||s in t?t[s]:t[s]=n()}}(jQuery),function(t){var e="__"+Number(new Date)+"storage",i=function(e,i){return t.identify(e)+(i?t.identify(i):"")},n={buildEventName:function(t){return t},on:function(n,s,o,r,a){if("string"==typeof n){t.isFunction(s)&&(r=o,o=s,s=void 0);for(var c,l=i(o,r),h=this[e]||(this[e]={}),u=n.split(" "),d=0;n=u[d++];)if(!(l in(c=h[n=this.buildEventName(n)]||(h[n]={ids:{},list:{}})).ids)){var m=c.list,p={fn:o,data:s,ctx:r,special:a};m.last?(m.last.next=p,p.prev=m.last):m.first=p,c.ids[l]=m.last=p}}else{var f=this;t.each(n,function(t,e){f.on(t,e,s,a)})}return this},onFirst:function(t,e,i,n){return this.on(t,e,i,n,{one:!0})},un:function(n,s,o){if("string"==typeof n||void 0===n){var r=this[e];if(r)if(n){for(var a,c=n.split(" "),l=0;n=c[l++];)if(a=r[n=this.buildEventName(n)])if(s){var h=i(s,o),u=a.ids;if(h in u){var d=a.list,m=u[h],p=m.prev,f=m.next;p?p.next=f:m===d.first&&(d.first=f),f?f.prev=p:m===d.last&&(d.last=p),delete u[h]}}else delete this[e][n]}else delete this[e]}else{var _=this;o=s,t.each(n,function(t,e){_.un(t,e,o)})}return this},trigger:function(i,n){var s=this[e],o="string"==typeof i,r=o?i:i.type,a=this.buildEventName(r);if(o||(i.type=a,i.target||(i.target=this)),s&&(s=s[a])){var c,l=s.list.first;for(l&&o&&((i=t.Event(a)).target=this);l;)i.data=l.data,void 0!==(c=l.fn.call(l.ctx||this,i,n))&&(i.result=c,!1===c&&(i.preventDefault(),i.stopPropagation())),l.special&&l.special.one&&this.un(r,l.fn,l.ctx),l=l.next}return this}};t.observable=t.inherit(n,n)}(jQuery),function(){var t=Array.prototype.slice;Function.prototype.bind||(Function.prototype.bind=function(e){var i=this,n=t.call(arguments,1);return function(){return i.apply(e,n.concat(t.call(arguments)))}})}(),function(t,e){var i=[],n=t.inherit,s=t.isFunction,o=Function.prototype.call.bind(Object.prototype.hasOwnProperty),r={},a={};function c(t,e,i){return(t?"__elem_"+t:"")+"__mod"+(e?"_"+e:"")+(i?"_"+i:"")}function l(t,e,i){var n,r,a;if(s(t))e[c(i,"*","*")]=t;else for(n in t)if(o(t,n))if(a=t[n],s(a))e[c(i,n,"*")]=a;else for(r in a)o(a,r)&&(e[c(i,n,r)]=a[r])}function h(t){var e;if(t.onSetMod&&(l(t.onSetMod,t),delete t.onSetMod),t.onElemSetMod){for(e in t.onElemSetMod)o(t.onElemSetMod,e)&&l(t.onElemSetMod[e],t,e);delete t.onElemSetMod}}this.BEM=n(t.observable,{__constructor:function(t,e,i){var n=this;n._modCache=t||{},n._processingMods={},n._params=e,n.params=null,!1!==i?n._init():n.afterCurrentEvent(function(){n._init()})},_init:function(){return this._initing||this.hasMod("js","inited")||(this._initing=!0,this.params||(this.params=t.extend(this.getDefaultParams(),this._params),delete this._params),this.setMod("js","inited"),delete this._initing,this.hasMod("js","inited")&&this.trigger("init")),this},changeThis:function(t,e){return t.bind(e||this)},afterCurrentEvent:function(t,e){this.__self.afterCurrentEvent(t.bind(e||this))},on:function(e,i,n,s){return"object"==typeof e&&(t.isFunction(i)||t.isFunction(n))&&(e=this.__self._buildModEventName(e)),this.__base.apply(this,arguments)},un:function(e,i,n){return"object"==typeof e&&t.isFunction(i)&&(e=this.__self._buildModEventName(e)),this.__base.apply(this,arguments)},trigger:function(e,i){var n=!0;return"object"!=typeof e||e instanceof t.Event||(n="js"===e.modName||this.hasMod("js"),e=this.__self._buildModEventName(e)),n&&(this.__base(e=this.buildEvent(e),i),this._trigger(e,i)),this},_trigger:function(t,e){this.__self.trigger(t,e)},buildEvent:function(e){return"string"==typeof e&&(e=t.Event(e)),e.block=this,e},hasMod:function(t,e,i){var n=arguments.length,s=!1;1==n?(i="",e=t,t=void 0,s=!0):2==n&&("string"==typeof t?(i=e,e=t,t=void 0):(i="",s=!0));var o=this.getMod(t,e)===i;return s?!o:o},getMod:function(t,e){var i=typeof t;if("string"===i||"undefined"===i){e=t||e;var n=this._modCache;return e in n?n[e]:n[e]=this._extractModVal(e)}return this._getElemMod(e,t)},_getElemMod:function(t,e,i){return this._extractModVal(t,e,i)},getMods:function(t){var e=t&&"string"!=typeof t,i=this._modCache,n=[].slice.call(arguments,e?1:0);return n.length?n.reduce(function(t,e){return e in i&&(t[e]=i[e]),t},{}):i},setMod:function(e,i,n){void 0===n&&("string"==typeof e?(n=void 0===i||i,i=e,e=void 0):n=!0);var s=this;if(!e||e[0]){!1===n||null===n?n="":!0!==n&&(n=n.toString());var o=(e&&e[0]?t.identify(e[0]):"")+"_"+i;if(this._processingMods[o])return s;var r,a=e?s._getElemMod(i,e,r=s.__self._extractElemNameFrom(e)):s.getMod(i);if(a===n)return s;this._processingMods[o]=!0;var c=!0,l=[i,n,a];e&&l.unshift(e),[["*","*"],[i,"*"],[i,n]].forEach(function(t){c=!1!==s._callModFn(r,t[0],t[1],l)&&c}),!e&&c&&(s._modCache[i]=n),c&&s._afterSetMod(i,n,a,e,r),delete this._processingMods[o]}return s},_afterSetMod:function(t,e,i,n,s){var o={modName:t,modVal:e,oldModVal:i};n&&(o.elem=n),this.trigger({modName:t,modVal:"*",elem:s},o).trigger({modName:t,modVal:e,elem:s},o)},toggleMod:function(t,e,i,n,s){"string"==typeof t&&(s=n,n=i,i=e,e=t,t=void 0),void 0===n?n="":"boolean"==typeof n&&(s=n,n="");var o=this.getMod(t,e);return(o==i||o==n)&&this.setMod(t,e,"boolean"==typeof s?s?i:n:this.hasMod(t,e,i)?n:i),this},delMod:function(t,e){return e||(e=t,t=void 0),this.setMod(t,e,"")},_callModFn:function(t,e,i,n){var s=c(t,e,i);return this[s]?this[s].apply(this,n):void 0},_extractModVal:function(t,e){return""},channel:function(t,e){return this.__self.channel(t,e)},getDefaultParams:function(){return{}},del:function(t){var e=[].slice.call(arguments);return"string"==typeof t&&e.unshift(this),this.__self.del.apply(this.__self,e),this},destruct:function(){var t={modName:"js",modVal:"",oldModVal:"inited"};this.trigger({modName:t.modName,modVal:t.modVal},t)}},t.extend(this.BEM,{_name:"i-bem",blocks:r,decl:function(e,i,o){"string"==typeof e?e={block:e}:e.name&&(e.block=e.name),h(i||(i={}));var a,c,l=r[e.baseBlock||e.block]||this;if(e.modName){var u=(a=e.modName,(c=e.modVal)?Array.isArray(c)?function(t){for(var e=0,i=c.length;e<i;)if(t.hasMod(a,c[e++]))return!0;return!1}:function(t){return t.hasMod(a,c)}:function(t){return t.hasMod(a)});t.each(i,function(t,e){s(e)&&(i[t]=function(){var n;if(u(this))n=e;else{var s=l.prototype[t];s&&s!==i[t]&&(n=this.__base)}return n?n.apply(this,arguments):void 0})})}if(o&&"boolean"==typeof o.live){var d=o.live;o.live=function(){return d}}var m,p=l;return e.baseMix&&(p=[p],e.baseMix.forEach(function(t){p.push(r[t])})),e.block==l._name?(m=n.self(p,i,o))._processLive(!0):((m=r[e.block]=n(p,i,o))._name=e.block,delete m._liveInitable),m},declMix:function(t,e,i){return h(e||(e={})),t=r[t]=n(e,i)},_processLive:function(t){return!1},create:function(t,e){return"string"==typeof t&&(t={block:t}),new r[t.block](t.mods,e)},getName:function(){return this._name},on:function(e,i,n,s){return"object"==typeof e&&(t.isFunction(i)||t.isFunction(n))&&(e=this._buildModEventName(e)),this.__base.apply(this,arguments)},un:function(e,i,n){return"object"==typeof e&&t.isFunction(i)&&(e=this._buildModEventName(e)),this.__base.apply(this,arguments)},_buildModEventName:function(t){var e="_"+t.modName+"_"+(!1===t.modVal?"":t.modVal);return t.elem&&(e="__"+t.elem+e),e},_extractElemNameFrom:function(t){},afterCurrentEvent:function(t,e){1==i.push({fn:t,ctx:e})&&setTimeout(this._runAfterCurrentEventFns,0)},_runAfterCurrentEventFns:function(){var t=i.length;t&&i.splice(0,t).forEach(function(t){t.fn.call(t.ctx||this)},this)},changeThis:function(t,e){return t.bind(e||this)},del:function(t){var e="string"==typeof t,i=e?0:1,n=arguments.length;for(e&&(t=this);i<n;)delete t[arguments[i++]];return this},channel:function(e,i){if("boolean"==typeof e&&(i=e,e=void 0),e||(e="default"),!i)return a[e]||(a[e]=new t.observable);a[e]&&(a[e].un(),delete a[e])}}))}(jQuery),function(t,e,i){var n,s="_",o="__";function r(t){var e=typeof t;return"string"===e||"number"===e||"boolean"===e}function a(t,e,i){null!=e&&!1!==e&&(i.push(s,t),!0!==e&&i.push(s,e))}function c(t,e,i,n){n.push(t),a(e,i,n)}function l(t,e,i,s,r){c(t,n,n,r),r.push(o,e),a(i,s,r)}t.INTERNAL={NAME_PATTERN:"[a-zA-Z0-9-]+",MOD_DELIM:s,ELEM_DELIM:o,buildModPostfix:function(t,e,i){var n=i||[];return a(t,e,n),i?n:n.join("")},buildClass:function(t,e,i,s,o){if(r(i)?r(s)||(o=s,s=i,i=e,e=n):void 0!==i?(o=i,i=n):e&&"string"!=typeof e&&(o=e,e=n),!e&&void 0===i&&!o)return t;var a=o||[];return e?l(t,e,i,s,a):c(t,i,s,a),o?a:a.join("")},buildClasses:function(t,i,n,s){i&&"string"!=typeof i&&(s=n,n=i,i=void 0);var o=s||[];return i?l(t,i,void 0,void 0,o):c(t,void 0,void 0,o),n&&e.each(n,function(e,n){n&&(o.push(" "),i?l(t,i,e,n,o):c(t,e,n,o))}),s?o:o.join("")}}}(BEM,jQuery),BEM.decl("framebuster",{onSetMod:{js:{inited:function(){var t=this._getWindow();if(t.top.location!==t.location){var e=this.matchDomain(t.document.referrer);e&&!this.isInWhitelist(e)&&(t.top.location=t.location)}}}},matchDomain:function(t){if(!t)return null;var e=t.match(/^https?:\/\/([^:\/\s]+)\/?.*/);return e&&e[1]},isInWhitelist:function(t){return!t||this.defaultWhitelist().concat(this.params.whitelist||[]).some(function(e){return"string"==typeof e?e===t||-1!==t.indexOf(e,t.length-e.length):!!e.test(t)})},defaultWhitelist:function(){return[]},_getWindow:function(){return window}}),function(t,e,i){var n=e(window),s=e(document),o={},r={},a={},c={},l={},h=t.blocks,u=t.INTERNAL,d=u.NAME_PATTERN,m=u.MOD_DELIM,p=u.ELEM_DELIM,f=RegExp("[^"+m+"]"+m+"("+d+")(?:"+m+"("+d+"))?$"),_=u.buildModPostfix,g=u.buildClass,v=Array.prototype.slice,b=Array.prototype.reverse;function y(t,n,s,a,c){"boolean"==typeof s&&(c=a,a=s,s=i);var l=n[0];if(l.dataset===i||"react"!==l.dataset.lego){var u=(s=w(s||E(l)[t],l,t)).uniqId;if(r[u])return r[u]._init();o[u]=o[u]?o[u].add(n):n;var d=l.parentNode;d&&11!==d.nodeType||e.unique(o[u]);var m=h[t]||S.decl(t,{},{live:!0});if(!(m._liveInitable=Boolean(m._processLive()))||a||!1===s.live){a&&n.addClass("i-bem");var p=new m(o[u],s,Boolean(a));return delete o[u],c&&c.apply(p,v.call(arguments,4)),p}}}function w(t,i,n,s){(t||(t={})).uniqId||(t.uniqId=(t.id?n+"-id-"+t.id:e.identify())+(s||e.identify()));var o=e.identify(i),r=a[o]||(a[o]={});return r[n]||(r[n]=t),t}function k(t,e,i){var n=t.find(e);return i?n:n.add(t.filter(e))}function E(t){var i=e.identify(t);return a[i]||(a[i]=M(t))}function M(t){var e,i=t.getAttribute("data-bem");return i?JSON.parse(i):e?e():{}}function x(t){delete a[e.identify(t)]}function T(t,e){1===t.domElem.length?t.destruct(!0):t.domElem=t.domElem.not(e)}e.fn.bem=function(t,e){return y(t,this,e,!0)};var S=t.DOM=t.decl("i-bem__dom",{__constructor:function(t,i,n){this.domElem=t,this._eventNameCache={},this._elemCache={},this._blockInsideCache={},r[this._uniqId=i.uniqId||e.identify(this)]=this,this._needSpecialUnbind=!1,this.__base(null,i,n)},findBlocksInside:function(t,e){return this._findBlocks("find",t,e)},findBlockInside:function(t,e){var i=this._buildBlockCacheKey(t,e),n=this._findBlocks("find",t,e,!0);return this._blockInsideCache[i]=n,n},blockInside:function(t,e){var i=this._buildBlockCacheKey(t,e),n=this._blockInsideCache[i];return n||(n=this.findBlockInside(t,e)),n},dropBlockInsideCache:function(t,e){t||e?this._blockInsideCache[this._buildBlockCacheKey(t,e)]=null:this._blockInsideCache={}},_buildBlockCacheKey:function(t,e){e||(e=t,t="");var i="string"==typeof e?e:g(e.block,e.modName,e.modVal);return("string"==typeof t?t:t.__bemElemName)+":"+i},findBlocksOutside:function(t,e){return this._findBlocks("parents",t,e)},findBlockOutside:function(t,e){return this._findBlocks("closest",t,e)[0]||null},findBlocksOn:function(t,e){return this._findBlocks("",t,e)},findBlockOn:function(t,e){return this._findBlocks("",t,e,!0)},_findBlocks:function(t,n,s,o){if(!this.domElem)return o?null:[];s||(s=n,n=i);var r=n?"string"==typeof n?this.findElem(n):n:this.domElem,a="string"==typeof s,c=a?s:s.block||s.blockName,l="."+(a?c:g(c,s.modName,s.modVal))+(o?":first":""),h=r.filter(l);if(t&&(h=h.add(r[t](l))),o)return h[0]?y(c,h.eq(0),!0):null;var u=[],d={};return e.each(h,function(t,i){var n=y(c,e(i),!0);d[n._uniqId]||(d[n._uniqId]=!0,u.push(n))}),u},bindToDomElem:function(t,n,s,o){e.isFunction(s)&&(o=s,s=i);var r=this,a=function(t){return(t.data||(t.data={})).domElem=e(this),o.apply(r,arguments)};return o?t.bind(r._buildEventName(n),s,(a.guid=o.guid=o.guid||e.guid++,a)):e.each(n,function(e,i){r.bindToDomElem(t,e,s,i)}),r},bindToDoc:function(t,e,i){return this._needSpecialUnbind=!0,this.bindToDomElem(s,t,e,i)},bindToWin:function(t,s,o){return e.isFunction(s)&&(o=s,s=i),this._needSpecialUnbind=!0,this.bindToDomElem(n,t,s,o)},bindTo:function(t,i,n,s){switch(arguments.length){case 3:e.isFunction(n)&&(s=n,"object"==typeof i&&(n=i,i=t,t=this.domElem));break;case 2:e.isFunction(i)?(s=i,i=t,t=this.domElem):"string"==typeof t||t instanceof e||(n=i,i=t,t=this.domElem);break;case 1:i=t,t=this.domElem}return"string"==typeof t&&(t=this.elem(t)),this.bindToDomElem(t,i,n,s)},unbindFromDomElem:function(t,e,i){return t.unbind(this._buildEventName(e),i),this},unbindFromDoc:function(t,e){return this.unbindFromDomElem(s,t,e)},unbindFromWin:function(t,e){return this.unbindFromDomElem(n,t,e)},unbindFrom:function(t,i,n){var s=arguments.length;return 1===s?(i=t,t=this.domElem):2===s&&e.isFunction(i)?(n=i,i=t,t=this.domElem):"string"==typeof t&&(t=this.elem(t)),this.unbindFromDomElem(t,i,n)},_buildEventName:function(t){var e=this;return t.indexOf(" ")>1?t.split(" ").map(function(t){return e._buildOneEventName(t)}).join(" "):e._buildOneEventName(t)},_buildOneEventName:function(t){var e=this._eventNameCache;if(t in e)return e[t];var i="."+this._uniqId;if(-1===t.indexOf("."))return e[t]=t+i,e[t];var n=".bem_"+this.__self._name;return e[t]=t.split(".").map(function(t,e){return 0===e?t+n:n+"_"+t}).join("")+i,e[t]},_trigger:function(t,e){this.__base.apply(this,arguments),this._ctxTrigger(t,e)},_ctxTrigger:function(t,i){var n=this,s=c[n.__self._buildCtxEventName(t.type)],o={};s&&n.domElem.each(function(){for(var r=this,a=s.counter;r&&a;){var c=e.identify(r,!0);if(c){if(o[c])break;var l=s.ctxs[c];l&&(e.each(l,function(e,s){s.fn.call(s.ctx||n,t,i)}),a--),o[c]=!0}r=r.parentNode}})},getMods:function(t){var e=t&&"string"!=typeof t,n=this._modCache,s=[].slice.call(arguments,e?1:0),o=this._extractMods(s,e?t:i);return e||(s.length?s.forEach(function(t){n[t]=o[t]}):n=o),o},setMod:function(t,i,n){if(t&&void 0!==n&&t.length>1){var s=this;return t.each(function(){var o=e(this);o.__bemElemName=t.__bemElemName,s.setMod(o,i,n)}),s}return this.__base(t,i,n)},_extractModVal:function(t,e,i){var n,s=(e||this.domElem)[0];return s&&(n=s.getAttribute("class").match(this.__self._buildModValRE(t,i||e))),n?n[2]||!0:""},_extractMods:function(t,e){var i={},n=!t.length,s=0;return((e||this.domElem).eq(0).attr("class").match(this.__self._buildModValRE("("+(n?d:t.join("|"))+")",e,"g"))||[]).forEach(function(t){var e=t.match(f);i[e[1]]=e[2]||!0,++s}),s<t.length&&t.forEach(function(t){t in i||(i[t]="")}),i},_afterSetMod:function(t,i,n,s,o){if(this._isDestructing)return this.__base.apply(this,arguments);var r=this.__self,a=r._buildModClassPrefix(t,o),c=r._buildModValRE(t,o,"g"),l=""===i||!1===i;(s||this.domElem).each(function(){var t=e(this),s=t.attr("class"),o=a;!0!==i&&(o+=m+i),(!0===n?c.test(s):(" "+s).indexOf(" "+a+m)>-1)?t.attr("class",s.replace(c,l?"":"$1"+o)):l||t.addClass(o)}),o&&this.dropElemCache(o,t,n).dropElemCache(o,t,i),this.__base.apply(this,arguments)},findElem:function(t,e,i,n){arguments.length%2?(n=i,i=e,e=t,t=this.domElem):"string"==typeof t&&(t=this.findElem(t)),e=e.split(" ");var s=this.__self.getName(),o=_(i,n),r=[],a=e.map(function(t){return r.push("."+g(s,t,i,n)),t+o}),c=1===a.length,l=k(t,r.join(","));return t===this.domElem&&r.forEach(function(t,i){(this._elemCache[a[i]]=c?l:l.filter(t)).__bemElemName=e[i]},this),l},_elem:function(t,e,i){return this._elemCache[t+_(e,i)]||this.findElem(t,e,i)},elem:function(t,i,n){if(2===arguments.length&&(n=!0),i&&"string"!=typeof i)return i.__bemElemName=t,i;if(t.indexOf(" ")<0)return this._elem(t,i,n);var s=e([]);return t.split(" ").forEach(function(t){s=s.add(this._elem(t,i,n))},this),s},dropElemCache:function(t,e,i){if(t){var n=_(e,i);t.indexOf(" ")<0?delete this._elemCache[t+n]:t.split(" ").forEach(function(t){delete this._elemCache[t+n]},this)}else this._elemCache={};return this},elemParams:function(t){var e;return"string"==typeof t?(e=t,t=this.elem(t)):e=this.__self._extractElemNameFrom(t),M(t[0])[g(this.__self.getName(),e)]||{}},elemify:function(t,i){return(t=e(t)).__bemElemName=i,t},containsDomElem:function(t){var e=!1;return this.domElem.each(function(){return!(e=t.parents().andSelf().index(this)>-1)}),e},buildSelector:function(t,e,i){return this.__self.buildSelector(t,e,i)},destruct:function(t){var i=this.__self;this._isDestructing||(this._isDestructing=!0,this._needSpecialUnbind&&i.doc.add(i.win).unbind("."+this._uniqId),this.dropElemCache().domElem.each(function(t,i){var n=E(i);e.each(n,function(t,e){var n=r[e.uniqId];n?n._isDestructing||T(n,i):delete o[e.uniqId]}),x(i)}),t||this.domElem.remove(),this.__base(),delete r[this.un()._uniqId],delete this.domElem,delete this._elemCache)}},{scope:null,doc:s,win:n,html:e(document.documentElement),_processLive:function(t){var e=this._liveInitable;if("live"in this&&void 0===e^t){e=!1!==this.live();var i=this.getName(),n=this.live;this.live=function(){return this.getName()===i?e:n.apply(this,arguments)}}return e},init:function(t,i,n){!t||e.isFunction(t)?(n=i,i=t,t=s):"string"==typeof t&&(t=e(t));var o=e.identify();return k(t,".i-bem").each(function(){!function(t,i){var n=t[0];e.each(E(n),function(s,o){w(o,n,s,i);var a=r[o.uniqId];a?a.domElem.index(n)<0&&(a.domElem=a.domElem.add(t),e.extend(a._params,o)):y(s,t,o)})}(e(this),o)}),i&&this.afterCurrentEvent(function(){i.call(n||this,t)}),this._runAfterCurrentEventFns(),t},destruct:function(t,n,s){"boolean"!=typeof t&&(s=n,n=t,t=i),n&&(b.call(k(n,".i-bem",s)).each(function(t,i){var n=E(this);e.each(n,function(t,e){if(e.uniqId){var n=r[e.uniqId];n?T(n,i):delete o[e.uniqId]}}),x(this)}),t||(s?n.empty():n.remove()))},update:function(t,e,i,n){return this.destruct(t,!0),this.init(t.html(e),i,n)},replace:function(t,i){return this.destruct(!0,t),this.init(e(i).replaceAll(t))},append:function(t,i){return this.init(e(i).appendTo(t))},prepend:function(t,i){return this.init(e(i).prependTo(t))},before:function(t,i){return this.init(e(i).insertBefore(t))},after:function(t,i){return this.init(e(i).insertAfter(t))},_buildCtxEventName:function(t){return this._name+":"+t},_liveClassBind:function(t,i,n,o){var r=this;if(i.indexOf(" ")>-1)i.split(" ").forEach(function(e){r._liveClassBind(t,e,n,o)});else{var a=l[i],c=e.identify(n);a||(a=l[i]={},s.bind(i,r._liveClassTrigger.bind(r))),c in(a=a[t]||(a[t]={uniqIds:{},fns:[]})).uniqIds||(a.fns.push({uniqId:c,fn:r._buildLiveEventFn(n,o)}),a.uniqIds[c]=a.fns.length-1)}return this},_liveClassUnbind:function(t,i,n){var s=l[i];if(s)if(n){if(s=s[t]){var o=e.identify(n);if(o in s.uniqIds){var r=s.uniqIds[o],a=s.fns.length-1;for(s.fns.splice(r,1);r<a;)s.uniqIds[s.fns[r++].uniqId]=r-1;delete s.uniqIds[o]}}}else delete s[t];return this},_liveClassTrigger:function(t){var i=l[t.type];if(i){var n=t.target,s=Object.keys(i);do{for(var o,r=" "+n.className+" ",a=0;o=s[a++];)if(-1!==r.indexOf(" "+o+" ")){for(var c=!1,h=i[o].fns,u=0;u<h.length;u++)!1===h[u].fn.apply(e(n),arguments)&&(c=!0);if(c&&t.preventDefault(),c||t.isPropagationStopped())return;s.splice(--a,1)}}while(s.length&&(n=n.parentNode))}},_buildLiveEventFn:function(t,i){var n=this;return function(s){var o=[n._name,((s.data||(s.data={})).domElem=e(this)).closest(n.buildSelector()),!0],r=y.apply(null,i?o.concat([t,s]):o);if(r&&!i&&t)return t.apply(r,arguments)}},liveInitOnEvent:function(t,e,i){return this.liveBindTo(t,e,i,!0)},liveBindTo:function(t,n,s,o){n&&!e.isFunction(n)||(s=n,n=t,t=i),t&&"string"!=typeof t||(t={elem:t}),t.elemName&&(t.elem=t.elemName);var r=this;return t.elem&&t.elem.indexOf(" ")>0?(t.elem.split(" ").forEach(function(e){r._liveClassBind(g(r._name,e,t.modName,t.modVal),n,s,o)}),r):r._liveClassBind(g(r._name,t.elem,t.modName,t.modVal),n,s,o)},liveUnbindFrom:function(t,n,s){n&&!e.isFunction(n)||(s=n,n=t,t=i);var o=this;return t&&t.indexOf(" ")>1?(t.split(" ").forEach(function(t){o._liveClassUnbind(g(o._name,t),n,s)}),o):o._liveClassUnbind(g(o._name,t),n,s)},_liveInitOnBlockEvent:function(t,e,i,n){var s=this._name;return h[e].on(t,function(t){if(t.block.domElem){var e=arguments,o=t.block[n](s);i&&o.forEach(function(t){i.apply(t,e)})}}),this},liveInitOnBlockEvent:function(t,e,i){return this._liveInitOnBlockEvent(t,e,i,"findBlocksOn")},liveInitOnBlockInsideEvent:function(t,e,i){return this._liveInitOnBlockEvent(t,e,i,"findBlocksOutside")},on:function(t,e,i,n,s){return t.jquery?this._liveCtxBind(t,e,i,n,s):this.__base(t,e,i,n,s)},un:function(t,e,i,n){return t.jquery?this._liveCtxUnbind(t,e,i,n):this.__base(t,e,i)},liveCtxBind:function(t,e,i,n,s){return this._liveCtxBind(t,e,i,n,s)},_liveCtxBind:function(t,n,s,o,r){var a=this;if("object"==typeof n&&(e.isFunction(s)||e.isFunction(o))&&(n=this._buildModEventName(n)),"string"==typeof n)if(e.isFunction(s)&&(r=o,o=s,s=i),n.indexOf(" ")>-1)n.split(" ").forEach(function(e){a._liveCtxBind(t,e,s,o,r)});else{var l=a._buildCtxEventName(n),h=c[l]||(c[l]={counter:0,ctxs:{}});t.each(function(){var t=e.identify(this),i=h.ctxs[t];i||(i=h.ctxs[t]={},++h.counter),i[e.identify(o)+(r?e.identify(r):"")]={fn:o,data:s,ctx:r}})}else e.each(n,function(e,i){a._liveCtxBind(t,e,i,s)});return a},liveCtxUnbind:function(t,e,i,n){return this._liveCtxUnbind(t,e,i,n)},_liveCtxUnbind:function(t,i,n,s){"object"==typeof i&&e.isFunction(n)&&(i=this._buildModEventName(i));var o=c[i=this._buildCtxEventName(i)];return o&&(t.each(function(){var t,i=e.identify(this,!0);i&&(t=o.ctxs[i])&&(n&&delete t[e.identify(n)+(s?e.identify(s):"")],n&&!e.isEmptyObject(t)||(o.counter--,delete o.ctxs[i]))}),o.counter||delete c[i]),this},_extractElemNameFrom:function(t){if(t.__bemElemName)return t.__bemElemName;var e=t.eq(0).attr("class").match(this._buildElemNameRE());return e?e[1]:i},extractParams:M,_buildModClassPrefix:function(t,e){return this._name+(e?p+("string"==typeof e?e:this._extractElemNameFrom(e)):"")+m+t},_buildModValRE:function(t,e,i){return new RegExp("(\\s|^)"+this._buildModClassPrefix(t,e)+"(?:"+m+"("+d+"))?(?=\\s|$)",i)},_buildElemNameRE:function(){return new RegExp(this._name+p+"("+d+")(?:\\s|$)")},buildSelector:function(t,e,i){return"."+g(this._name,t,e,i)},getBlockByUniqId:function(t){return r[t]},getWindowSize:function(){return{width:n.width(),height:n.height()}}});e(function(){t.DOM.scope=e("body")})}(BEM,jQuery),function(t){var e=t(window),i=s(),n=o();function s(){return window.innerHeight|0+e.outerHeight()}function o(){return window.innerWidth|0+e.outerWidth()}(t.event.special.resize||(t.event.special.resize={})).preDispatch=function(t){var e=s(),r=o();if(n===r&&i===e)return!1;i=e,n=r}}(jQuery),function(t){BEM.decl("i-visibilitychange",{init:function(){var e=t.document,i=this.changeThis(this.normalize);this.hiddenProp="hidden",this.hiddenProp in e?e.addEventListener("visibilitychange",this.changeThis(function(){this.change(e.hidden)})):(this.hiddenProp="mozHidden")in e?e.addEventListener("mozvisibilitychange",i):(this.hiddenProp="webkitHidden")in e?e.addEventListener("webkitvisibilitychange",i):(this.hiddenProp="msHidden")in e?e.addEventListener("msvisibilitychange",i):"onfocusin"in e?e.onfocusin=e.onfocusout=i:t.onpageshow=t.onpagehide=t.onfocus=t.onblur=i},normalize:function(e){var i,n=t.document,s={focus:!1,focusin:!1,pageshow:!1,blur:!0,focusout:!0,pagehide:!0};i=(e=e||t.event).type in s?s[e.type]:n[this.hiddenProp],n.hidden=i,$(t).trigger("visibilitychange"),this.change(i)},change:function(t){this.channel("sys").trigger("visibilitychange",{hidden:t}),this.channel("sys").trigger(t?"hidden":"visible")}}),BEM.create("i-visibilitychange").init()}(window),function(t){var e,i;try{e=t.localStorage,i="ya_ls_test",e.setItem(i,"1"),"1"!==e.getItem(i)?e=null:e.removeItem(i)}catch(t){e=null}var n=t.home||(t.home={}),s=t.console&&function(t){console.log(t)}||function(){},o=function(t){s("localStorage is disabled. "+(t||""))},r=function(t){try{return t()}catch(t){o(t)}};e?n.localStorage={setItem:function(t,i){return r(function(){return e.setItem(t,i)})},getItem:function(t){return r(function(){return e.getItem(t)})},removeItem:function(t){return r(function(){return e.removeItem(t)})},clear:function(){return r(function(){return e.clear()})},key:function(t){return r(function(){return e.key(t)})}}:(n.localStorage={removeItem:o,setItem:o,getItem:o,clear:o},n.disabledLS=!0)}(window),function(t){"use strict";for(var e,i=["ms","moz","webkit","o"],n={},s=[],o=0;o<i.length&&!t.requestAnimationFrame;++o)t.requestAnimationFrame=t[i[o]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[i[o]+"CancelAnimationFrame"]||t[i[o]+"CancelRequestAnimationFrame"];if(void 0===t.requestAnimationFrame){var r=+new Date,a=0,c=function(){var t=s,i=n;s=[],n={},a=+new Date,e=0;for(var o=0,c=t.length;o<c;o++)i[t[o].requestid]||t[o].callback(a-r)};t.requestAnimationFrame=function(i){var n=Date.now()+Math.round(1e4*Math.random());if(s.push({requestid:n,callback:i}),!e){var o=+new Date,r=Math.max(0,16-(o-a));e=t.setTimeout(c,r)}return n},t.requestAnimationFrame.fallback=!0}void 0===t.cancelAnimationFrame&&(t.cancelAnimationFrame=function(t){t&&!n[t]&&(n[t]=1)})}(this),home.getTouchEvents=function(t){var e=t.originalEvent;return e.touches&&e.touches.length?e.touches:e.changedTouches},home.getTouchEvent=function(t){var e,i=home.getTouchEvents(t);return{x:(e=i&&i.length?i[0]:t.originalEvent).pageX||e.clientX,y:e.pageY||e.clientY}},window.home=window.home||{},home.l10n=function(t){for(var e=t.split("."),i=home.lang,n=0;n<e.length;++n){if(!i||!i[e[n]])return"";i=i[e[n]]}return i},function(t,e,i){var n={bubbles:!1,cancelable:!1,view:null,detail:null,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null,buttons:0,pointerId:0,width:0,height:0,pressure:0,tiltX:0,tiltY:0,pointerType:"",hwTimestamp:0,isPrimary:!1,target:null,currentTarget:null,which:0,pageX:0,pageY:0,timeStamp:0},s=Object.keys(n),o=s.map(function(t){return n[t]}),r=s.length,a=!1,c=[0,1,4,2];try{a=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}function l(t,e){var i={},n=t.originalEvent||{};e||(e={});for(var l,h=0;h<r;h++)i[l=s[h]]=e[l]||t[l]||n[l]||o[h];return i.x=i.clientX,i.y=i.clientY,i.pressure=i.pressure||(i.buttons?.5:0),i.buttons||a||(i.buttons=c[i.which]||0),i.originalEvent=t.originalEvent||null,e.preventDefault?i.preventDefault=function(){e.preventDefault(),t.preventDefault()}:(i.preventDefault=function(){t.preventDefault()},i._preventScroll=function(){}),i}var h=t.Map&&t.Map.prototype.forEach?new t.Map:{array:[],size:0,set:function(t,e){if(void 0===e)return this.delete(t);this.has(t)||this.size++,this.array[t]=e},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach(function(i,n){t.call(e,i,n,this)},this)}},u={eventMap:{},captureInfo:{},eventSourceList:[],registerSource:function(t,e){var i=e.events;i&&(i.forEach(function(t){e[t]&&(this.eventMap[t]=e[t].bind(e))},this),this.eventSourceList.push(e))},register:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.register.call(e,t)},unregister:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.unregister.call(e,t)},contains:function(t,e){return!!t.contains&&t.contains(e)},getCommonAncestor:function(t,i){for(;t&&t!==e.documentElement;){if(t.contains&&t.contains(i))return t;t=t.parentNode}return null},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){var e=[],i=t.target,n=this.getCommonAncestor(i,t.relatedTarget);for(t.bubbles=!1;i&&i!==n;)e.push(i),i=i.parentNode;for(;e.length;)t.target=e.pop(),this.fireEvent("pointerenter",t)},leave:function(t){var e=[],i=t.target,n=this.getCommonAncestor(i,t.relatedTarget);for(t.bubbles=!1;i&&i!==n;)e.push(i),i=i.parentNode;for(;e.length;)t.target=e.shift(),this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.contains(t.target,t.relatedTarget)||this.leave(t)},enterOver:function(t){this.over(t),this.contains(t.target,t.relatedTarget)||this.enter(t)},listen:function(t,e){e.forEach(function(e){this.addEvent(t,e)},this)},unlisten:function(t,e){e.forEach(function(e){this.removeEvent(t,e)},this)},addEvent:function(t,e){i(t).on(e,this.boundHandler)},removeEvent:function(t,e){i(t).off(e,this.boundHandler)},eventHandler:function(t){var e=this.eventMap[t.type];e&&e(t,t.originalEvent)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var n=function(t,e){var n=i.Event(t),s=e.preventDefault,o=n.preventDefault.bind(n);return jQuery.extend(n,e),n.preventDefault=function(){s(),o()},n}(t,e);return n._target=n._target||e.target,n},fireEvent:function(t,e){var i=this.makeEvent(t,e);return this.dispatchEvent(i)},getTarget:function(t){return this.captureInfo[t.pointerId]||t._target},setCapture:function(t,n){this.captureInfo[t]&&this.releaseCapture(t),this.captureInfo[t]=n,this.implicitRelease=this.releaseCapture.bind(this,t),i(e).on("pointerup pointercancel",this.implicitRelease),this.asyncDispatchEvent(i.Event("gotpointercapture",{bubbles:!0,cancelable:!1,pointerId:t,_target:n}))},releaseCapture:function(t){var n=this.captureInfo[t];n&&(this.captureInfo[t]=void 0,i(e).off("pointerup pointercancel",this.implicitRelease),this.asyncDispatchEvent(i.Event("lostpointercapture",{bubbles:!0,cancelable:!1,pointerId:t,_target:n})))},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return i.event.trigger(t,null,e,!t.bubbles)},asyncDispatchEvent:function(e){(t.requestAnimationFrame||setTimeout)(this.dispatchEvent.bind(this,e))}};u.boundHandler=u.eventHandler.bind(u);var d,m,p={POINTER_ID:1,POINTER_TYPE:"mouse",DEDUP_DIST:25,events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(t){u.listen(t,this.events)},unregister:function(t){u.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,i=this.lastTouches,n=t.clientX,s=t.clientY,o=0,r=i.length;o<r&&(e=i[o]);o++){var a=Math.abs(n-e.x),c=Math.abs(s-e.y);if(a<=this.DEDUP_DIST&&c<=this.DEDUP_DIST)return!0}},prepareEvent:function(t){return l(t,{pointerId:this.POINTER_ID,isPrimary:!0,pointerType:this.POINTER_TYPE})},mousedown:function(t){this.isEventSimulatedFromTouch(t)||(h.has(this.POINTER_ID)&&this.cancel(t),h.set(this.POINTER_ID,t),u.down(this.prepareEvent(t)))},mousemove:function(t){this.isEventSimulatedFromTouch(t)||u.move(this.prepareEvent(t))},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=h.get(this.POINTER_ID);e&&e.button===t.button&&(u.up(this.prepareEvent(t)),this.cleanupMouse())}},mouseover:function(t){this.isEventSimulatedFromTouch(t)||u.enterOver(this.prepareEvent(t))},mouseout:function(t){this.isEventSimulatedFromTouch(t)||u.leaveOut(this.prepareEvent(t))},cancel:function(t){u.cancel(this.prepareEvent(t)),this.cleanupMouse()},cleanupMouse:function(){h.delete(this.POINTER_ID)}},f={POINTER_TYPE:"touch",DEDUP_TIMEOUT:2500,CLICK_COUNT_TIMEOUT:200,events:["touchstart","touchmove","touchend","touchcancel"],register:function(t){u.listen(t,this.events)},unregister:function(t){u.unlisten(t,this.events)},firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===h.size||1===h.size&&h.has(1))&&(this.firstTouch=t.identifier,this.firstTouchTarget=t.target,this.scrolling=!1,this.firstXY={X:t.clientX,Y:t.clientY},this.cancelResetClickCount())},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstTouchTarget=null,this.firstXY=null,this.shouldScrollCache=void 0,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var t=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(t,this.CLICK_COUNT_TIMEOUT)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(t){return"touchstart"===t||"touchmove"===t?1:0},findTarget:function(t){return e.elementFromPoint(t.clientX,t.clientY)},touchToPointer:function(t){var e=this,n=this.currentTouchEvent,s=t.identifier+2;return l(n,i.extend({},t,{pointerId:s,target:u.captureInfo[s]||this.findTarget(t),bubbles:!0,cancelable:!0,detail:this.clickCount,button:0,buttons:this.typeToButtons(n.type),width:t.webkitRadiusX||t.radiusX||0,height:t.webkitRadiusY||t.radiusY||0,pressure:t.webkitForce||t.force||.5,isPrimary:this.isPrimaryTouch(t),pointerType:this.POINTER_TYPE,preventDefault:function(){e.scrolling=!1,e.shouldScrollCache=!1,e.firstXY=null}}))},processTouches:function(t,e){var i=t.originalEvent.changedTouches;this.currentTouchEvent=t;for(var n,s=0;s<i.length;s++)n=i[s],e.call(this,this.touchToPointer(n))},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(t){var e,i=this.scrollTypes;return t===i.EMITTER?e="none":t===i.XSCROLLER?e="X":t===i.YSCROLLER?e="Y":i.SCROLLER.exec(t)&&(e="XY"),e},shouldScroll:function(t){if(void 0!==this.shouldScrollCache)return this.shouldScrollCache;if(!this.firstXY)return!0;var e,i,n=this.firstTouchTarget;do{if(null!==(e=n.getAttribute("touch-action")))break;n=n.parentNode}while(n!==document);var s=this.touchActionToScrollType(e);if("none"===s)i=!1;else if("XY"===s||void 0===s)i=!0;else{var o=t.originalEvent.changedTouches[0],r=s,a="Y"===s?"X":"Y";i=Math.abs(o["client"+r]-this.firstXY[r])>=Math.abs(o["client"+a]-this.firstXY[a])}return this.shouldScrollCache=i,this.firstXY=null,this.firstTouchTarget=null,this.shouldScrollCache},findTouch:function(t,e){for(var i,n=0,s=t.length;n<s&&(i=t[n]);n++)if(i.identifier===e)return!0},vacuumTouches:function(t){var e=t.originalEvent.touches;if(h.size>=e.length){var i=[];h.forEach(function(t,n){if(1!==n&&!this.findTouch(e,n-2)){var s=t.out;i.push(s)}},this),i.forEach(this.cancelOut,this)}},touchstart:function(t){var e=t.originalEvent.changedTouches[0];this.vacuumTouches(t),this.setPrimaryTouch(e),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(t,this.overDown))},overDown:function(t){h.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),u.over(t),u.enter(t),u.down(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):(t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=h.get(t.pointerId);if(e){var i=e.out,n=e.outTarget;u.move(t),i&&n!==t.target&&(i.relatedTarget=t.target,t.relatedTarget=n,i.target=n,t.target?(u.leaveOut(i),u.enterOver(t)):(t.target=n,t.relatedTarget=null,this.cancelOut(t))),e.out=t,e.outTarget=t.target}},touchend:function(t){this.dedupSynthMouse(t.originalEvent.changedTouches[0]),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(u.up(t),u.out(t),u.leave(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){u.cancel(t),u.out(t),u.leave(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){h.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=p.lastTouches;if(this.isPrimaryTouch(t)){var i={x:t.clientX,y:t.clientY};e.push(i);var n=function(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}.bind(null,e,i);setTimeout(n,this.DEDUP_TIMEOUT)}}},_={POINTER_TYPES:["","unavailable","touch","pen","mouse"],HAS_BITMAP_TYPE:t.MSPointerEvent&&"number"==typeof t.MSPointerEvent.MSPOINTER_TYPE_MOUSE,events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){u.listen(t,this.events)},unregister:function(t){u.unlisten(t,this.events)},prepareEvent:function(t){var e=l(t);return this.HAS_BITMAP_TYPE&&(e.pointerType=this.POINTER_TYPES[e.pointerType]),e},cleanup:function(t){h.delete(t)},MSPointerDown:function(t){h.set(t.originalEvent.pointerId,t),u.down(this.prepareEvent(t))},MSPointerMove:function(t){u.move(this.prepareEvent(t))},MSPointerUp:function(t){u.up(this.prepareEvent(t)),this.cleanup(t.originalEvent.pointerId)},MSPointerOut:function(t){u.leaveOut(this.prepareEvent(t))},MSPointerOver:function(t){u.enterOver(this.prepareEvent(t))},MSPointerCancel:function(t){u.cancel(this.prepareEvent(t)),this.cleanup(t.originalEvent.pointerId)},MSGotPointerCapture:function(t){u.fireEvent("gotpointercapture",this.prepareEvent(t))},MSLostPointerCapture:function(t){u.fireEvent("lostpointercapture",this.prepareEvent(t))}},g=function(t){if(!h.has(t))throw new Error("InvalidPointerId")};t.Element&&Element.prototype.setPointerCapture?(d=function(t,e){t.setPointerCapture(e)},m=function(t,e){t.releasePointerCapture(e)}):t.navigator.msPointerEnabled?(d=function(t,e){g(e),t.msSetPointerCapture(e)},m=function(t,e){g(e),t.msReleasePointerCapture(e)}):(d=function(t,e){g(e),u.setCapture(e,t)},m=function(t,e){g(e),u.releaseCapture(e,t)}),i.fn.extend({setPointerCapture:function(t){d(this[0],t)},releasePointerCapture:function(t){m(this[0],t)}}),t._pointerPolyfillInited||(t._pointerPolyfillInited=!0,t.PointerEvent?["move","down","up","over","out","enter","leave","cancel"].forEach(function(t){var e=jQuery.event.fixHooks,i="pointer"+t;e[i]||(e[i]={}),e[i].props=s.concat(e[i].props||[])}):(delete i.event.special.pointerenter,delete i.event.special.pointerleave,t.navigator.msPointerEnabled?u.registerSource("ms",_):(u.registerSource("mouse",p),void 0!==t.ontouchstart&&u.registerSource("touch",f)),u.register(document)))}(window,document,jQuery),function(t){t.event.special.pointerpress||t.each({pointerpress:"pointerdown",pointerrelease:"pointerup pointercancel"},function(e,i){function n(i){var n,s=i.type;return"mouse"===i.pointerType&&1!==i.which||(i.type=e,n=t.event.dispatch.apply(this,arguments),i.type=s),n}t.event.special[e]={setup:function(){t(this).on(i,n)},teardown:function(){t(this).off(i,n)}}})}(jQuery),$.extend({util:{}}),function(){var t=Object.prototype.toString;function e(e){return"[object Object]"===t.call(e)}function i(t,n,s){var o,r;for(o in t=Object(t),n=Object(n))void 0!==(r=s&&s(t[o],n[o],o))?t[o]=r:e(t[o])&&e(n[o])?t[o]=i(t[o],n[o],s):t[o]=n[o];return t}$.extend($.util,{merge:i,mergeBemjson:function(t,e){return i(t,e,function(t,e,i){if("mix"===i)return[].concat(t,e)})}})}(),jQuery.cookie=function(t,e,i){if(void 0===e){var n=null;if(document.cookie&&""!=document.cookie)for(var s=document.cookie.split(";"),o=0;o<s.length;o++){var r=jQuery.trim(s[o]);if(r.substring(0,t.length+1)==t+"="){n=decodeURIComponent(r.substring(t.length+1));break}}return n}i=i||{},null===e&&(e="",i.expires=-1);var a,c="";i.expires&&("number"==typeof i.expires||i.expires.toUTCString)&&("number"==typeof i.expires?(a=new Date).setTime(a.getTime()+24*i.expires*60*60*1e3):a=i.expires,c="; expires="+a.toUTCString());var l=i.path?"; path="+i.path:"",h=i.domain?"; domain="+i.domain:"",u=i.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(e),c,l,h,u].join("")},function(t){var e={"%D0":"%D0%A0","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DA":"%D0%AA","%DB":"%D0%AB","%DC":"%D0%AC","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF","%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FA":"%D1%8A","%FB":"%D1%8B","%FC":"%D1%8C","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F"};function i(t,i){var n="";try{n=t(i)}catch(s){try{n=t(function(t){return t.replace(/%.{2}/g,function(t){return e[t]||t})}(i))}catch(t){n=i}}return n}jQuery.extend({decodeURI:function(t){return i(decodeURI,t)},decodeURIComponent:function(t){return i(decodeURIComponent,t)}})}(),BEM.DOM.decl("i-global",{onSetMod:{js:{inited:function(){this.del(this.__self._params=$.extend({},this.params),"uniqId","name");var t=this.__self._params;t["passport-msg"]||(t["passport-msg"]=t.id),void 0===t["show-counters"]&&(t["show-counters"]=Math.round(100*Math.random())<=t["show-counters-percent"]),t.locale=t.lang,window.BEMHTML&&BEMHTML.apply({block:"i-global",params:t})}}},getDefaultParams:function(){return{id:"",login:Lego.isSessionValid()&&$.cookie("yandex_login")||"",yandexuid:$.cookie("yandexuid"),lang:"ru",tld:"ru",retpath:encodeURI($.decodeURI(location.href)),"passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","lego-path":"/lego","show-counters-percent":100}}},{param:function(t,e){if(void 0===e)return(this._params||{})[t];this._params&&(this._params[t]=e)}}),function(t){t||(t=window.Lego={}),t.getCookie=function(t){var e=document.cookie;if(e.length<1)return!1;var i=e.indexOf(t+"=");if(-1===i)return!1;i+=t.length+1;var n=e.indexOf(";",i);return decodeURIComponent(-1===n?e.substring(i):e.substring(i,n))}}(window.Lego),function(t,e){e||(e=window.Lego={}),e.init||(e.init=function(i){return(i=e.params=t.extend({id:"",login:e.isSessionValid()&&e.getCookie("yandex_login")||"",yandexuid:e.getCookie("yandexuid"),locale:"ru",retpath:window.location.toString(),"passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","passport-msg":i.id,"social-host":"https://social.yandex.ru","lego-path":"/lego","show-counters-percent":100},i,e.params))["show-counters"]=Math.round(100*Math.random())<=i["show-counters-percent"],BEM.blocks["i-global"]._params||t.extend(BEM.blocks["i-global"]._params={},i),i}),e.block||(e.block={}),e.blockInit||(e.blockInit=function(i,n){i=i||document,n=n||".g-js",t(i).find(n).each(function(){var i=t(this),n=i.data("bem")||(this.onclick?this.onclick():{}),s=n.name||"",o=e.block[s];o&&!i.data(s)&&(o.call(i,n),i.data(s,!0).addClass(s+"_js_inited"))})}),e.blockInitBinded||(e.blockInitBinded=Boolean(t(document).ready(function(){e.blockInit()})))}(jQuery,window.Lego),function(t){t||(t=window.Lego={}),t.isSessionValid=function(){return Boolean(t.getCookie("yandex_login"))}}(window.Lego),function(t,e){var i={};/msie|trident/i.test(e)?i.ie=parseInt(e.split(/msie|rv:/i)[1],10):-1!==e.indexOf("Opera")&&(i.opera=parseInt(e.split(/Version\//i)[1],10));var n,s={},o={};(n=e.match(/Windows\sPhone[^\d]*\s([\d.]+)/))?s.wp=n[1]:(n=e.match(/Android\s+([\d.]+)/))?s.android=n[1]:e.match(/\sHTC[\s_].*AppleWebKit/)?s.android="2.3":(n=e.match(/iPhone\sOS\s([\d_]+)/))?(s.ios=n[1].replace(/_/g,"."),o.iphone=!0):(n=e.match(/iPad.*OS\s([\d_]+)/))?(s.ios=n[1].replace(/_/g,"."),o.ipad=!0):(n=e.match(/Bada\/([\d.]+)/))?s.bada=n[1]:(n=e.match(/MSIE\s9/))?s.wp="7.5":s.other=!0,BEM.DOM.decl("i-ua",{onSetMod:{js:{inited:function(){var t=this.__self,e="other";["ios","android","bada","wp","opera"].some(function(i){return t[i]&&(e=i)}),this.setMod("platform",e)}}},setVersion:function(){var t=this.parseVersion();t&&(this.setMod(t.platform,t.major),this.setMod(t.platform+"-subversion",t.subversion))},parseVersion:function(){if(this.__self.ios||this.__self.android){var t=(this.__self.ios||this.__self.android).split("."),e=t.shift(),i=t.join("-");return{platform:this.getMod("platform"),major:e,subversion:i}}}},{ios:s.ios,iphone:o.iphone,ipad:o.ipad,android:s.android,bada:s.bada,wp:s.wp,other:s.other,ua:e,ie:i.ie,opera:i.opera})}(window,navigator.userAgent),BEM.KEYS={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,HOME:36,END:35},function(){var t={};for(var e in BEM.KEYS)BEM.KEYS.hasOwnProperty(e)&&(t[BEM.KEYS[e]]=e);var i={CTRL:"ctrlKey",ALT:"altKey",SHIFT:"shiftKey",META:"metaKey"},n=function(e){var n=t[e.which]||"";for(var s in i)i.hasOwnProperty(s)&&e[i[s]]&&(n=s+"+"+n);return n},s=function(t){var e={};return t.split(" ").forEach(function(t){t.split("+").forEach(function(e){var n=e.toUpperCase();if(!(n in i||n in BEM.KEYS))throw"i-keys.js: Unknown key "+t}),e[t.toUpperCase()]=!0}),e};BEM.DOM.liveBindKey=function(t,e,i){var o;return $.isFunction(e)&&(i=e,e=t,t=void 0),o=s(e),this.liveBindTo(t,"keydown",function(t){n(t)in o&&!1===i.call(this,t)&&t.preventDefault()})},BEM.DOM.prototype.bindKeyTo=function(t,e,i){var o;return $.isFunction(e)&&(i=e,e=t,t=void 0),o=s(e),t===document?this.bindToDoc("keydown",r):t===window?this.bindToWin("keydown",r):this.bindTo(t,"keydown",r);function r(t){n(t)in o&&!1===i.call(this,t)&&t.preventDefault()}}}(),BEM.DOM.decl("control",{onSetMod:{focused:{yes:function(){if(this.hasMod("disabled"))return!1;this._focused||(this._focus(),this.trigger("focus"))},"":function(){this._focused&&(this._blur(),this.trigger("blur"))}},disabled:{"*":function(t,e){var i=this._getControl();i.prop("disabled",Boolean(e)).attr("aria-disabled",Boolean(e)),i.attr("tabindex",e?null:this.params._tabindex)},yes:function(){this.delMod("focused")}}},_focus:function(){this._getControl().focus()},_blur:function(){this._getControl().blur()},_getControl:function(){var t=this.elem("control");return t.length>0?t:this.domElem},_onFocusin:function(){this._focused=!0,this.trigger("focus").setMod("focused","yes").bindTo("focusout",this._onFocusout)},_onFocusout:function(){this._focused=!1,this.trigger("blur").delMod("focused").unbindFrom("focusout")},getDefaultParams:function(){return{_tabindex:this._getControl().attr("tabindex")}}},{live:function(){this.liveBindTo("focusin",function(t){this._onFocusin(t)}),parseInt(BEM.blocks["i-ua"].ios,10)>=8&&this.liveBindTo("control","focusin",function(t){t.preventDefault()})}}),BEM.DOM.decl({block:"link",baseBlock:"control"},{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},disabled:{"":function(){this.__base.apply(this,arguments),this.domElem.attr("tabindex",this.params._tabindex).attr("href",this._url||this.params._url)},yes:function(){this.__base.apply(this,arguments),this._url=this.domElem.attr("href")||this.params._url,void 0!==this._url&&this.domElem.attr("tabindex",-1),this.domElem.removeAttr("href"),this.delMod("pressed")}}},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")}},{live:function(){return this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}),this.__base()}}),BEM.DOM.decl("link",{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered")}}},_onPointerenter:function(t){this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.hasMod("disabled")||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}),this.__base.apply(this,arguments)}}),function(t,e){if(!e.event.special.pointerclick){var i,n=void 0!==t.ontouchstart||navigator.msMaxTouchPoints>0,s=10,o=25,r=900,a=[],c=[],l=null,h=null,u="touchAction"in document.documentElement.style?function(t){return function t(e){return!(!e||e===document.documentElement)&&("manipulation"===getComputedStyle(e)["touch-action"]||t(e.parentElement))}(t)}:function(){return!1};n?(i={click:function(t){var e=Object(t.originalEvent)._sourcePoint;if(!e)return d.apply(this,arguments);e.isDefaultPrevented()&&t.preventDefault()},"pointerdown pointermove pointerleave pointercancel pointerup":function(t){var e,i,n=t.type;if("mouse"!==t.pointerType&&("pointerdown"!==n&&"pointerup"!==n||!u(t.target)))if("pointerdown"===n)h=t;else if("pointermove"===n&&h&&(h.target!==t.target||(e=h,i=t,Math.abs(e.clientX-i.clientX)>s||Math.abs(e.clientY-i.clientY)>s)))h=null;else if("pointerleave"===n||"pointercancel"===n)h=null;else if("pointerup"===n){if(function(t){if(!t.isPrimary)return;a.push(t),setTimeout(Array.prototype.shift.bind(a),r)}(t),!h)return;if(!(t.timeStamp-h.timeStamp>250))return l||(l=setTimeout(function(){l=h=null})),d.apply(this,arguments);h=null}}},["mousedown","click"].forEach(function(e){t.addEventListener(e,function(t){!function(t){var e=t.clientX,i=t.clientY,n="_compat"+t.type;if(t._sourcePoint)return;for(var s=0;s<a.length;s++){var l=a[s],h=l.target===t.target;if(!l[n]&&((h||!(Math.abs(e-l.clientX)>o||Math.abs(i-l.clientY)>o))&&(h||document.elementFromPoint(l.clientX,l.clientY)!==l.target))){t._sourcePoint=l,l[n]=t;break}}c.push(t),setTimeout(Array.prototype.shift.bind(c),r)}(t),function(t){var e=function(t){for(var e=0;e<c.length;e++)if(c[e]===t)return c[e]._sourcePoint}(t);return Boolean(e)&&e.target!==t.target}(t)&&(t.preventDefault(),t.stopPropagation())},!0)})):i={click:function(t){return d.apply(this,arguments)}},e.event.special.pointerclick={setup:function(){e(this).on(i)},teardown:function(){e(this).off(i)}}}function d(t){var i,n=t.type;return t.button||(t.type="pointerclick",i=e.event.dispatch.apply(this,arguments),t.type=n),i}}(window,jQuery),BEM.DOM.decl({block:"link",modName:"pseudo",modVal:"yes"},{_onClick:function(t){t.preventDefault(),this.hasMod("disabled")||this.trigger("click",this._buildClickEventData(t))},_onKeydown:function(t){BEM.blocks.keycodes.is(t.keyCode,"ENTER","SPACE")&&(BEM.blocks.keycodes.is(t.keyCode,"SPACE")&&t.preventDefault(),this.setMod("pressed","yes"))},_onKeyup:function(t){BEM.blocks.keycodes.is(t.keyCode,"ENTER","SPACE")&&(BEM.blocks.keycodes.is(t.keyCode,"SPACE")&&this.trigger("click"),this.delMod("pressed"))},_buildClickEventData:function(t){return{domEvent:t,isModKey:t.ctrlKey||t.altKey||t.metaKey||t.shiftKey}}},{live:function(){return this.liveBindTo({modName:"pseudo",modVal:"yes"},"pointerclick",function(t){this._onClick(t)}).liveBindTo({modName:"pseudo",modVal:"yes"},"keydown",function(t){this.hasMod("disabled")||this._onKeydown(t)}).liveBindTo({modName:"pseudo",modVal:"yes"},"keyup",function(t){this.hasMod("disabled")||this._onKeyup(t)}),this.__base()}}),BEM.decl("keycodes",{},{BACKSPACE:8,TAB:9,ENTER:13,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,is:function(t,e){return(Array.isArray(e)?e:Array.prototype.slice.call(arguments,1)).some(function(e){return this[e]===t},this)}}),function(){var t=$(window),e=$(document.documentElement),i=0,n=!1;function s(){e.hasClass("pointerfocus")&&(n=!0,setTimeout(function(){n=!1}))}document.documentMode<=11?e.on("focusin",function(t){var e=t.originalEvent;!e||e.fromElement||e.relatedTarget||s()}):t.on("blur",function(){t.one("focus",s)}),e.addClass("utilityfocus").on({focusin:function(){e.toggleClass("pointerfocus",n).toggleClass("utilityfocus",!n)},keydown:function(){clearTimeout(i),n=!1},"pointerdown pointerup click":function(t){n=!0,clearTimeout(i),i=setTimeout(function(){n=!1},600)}})}(),function(t){t.getData=function(e,i){var n,s,o,r="export",a=e.split("."),c=a.length;if(c>1){for(n=t[r]||{},s=0;s<c;s++)if(void 0===(n=n[a[s]]))return void 0===n?i:n;return void 0===n?i:n}return r="export",void 0===(o=t&&t[r]&&t[r][e])?i:o},t.dataCallbacks=t.dataCallbacks||[],t.subscribeData=function(e){t.export?e():t.dataCallbacks.push(e)}}(home),function(){var t,e={isAuthenticated:!1,isFeedbackReceived:!1,isRequestSent:!1},i=function(){};BEM.decl("i-mda-auth",{},{authenticate:function(n){if(""===(t=Lego.params["mda-auth-url"]||home.getData("i-mda-auth.url")||""))return!1;var s=Lego.params["mda-auth-delay"]||10;i=n||function(){},setTimeout(function(){var i=document.createElement("iframe");i.style.visibility="hidden",i.style.position="absolute",i.setAttribute("src",t),i.name="i-mda-auth"+(Math.random()+"").substr(3,7),i.style.top=i.style.left=i.style.width=i.style.height=0,document.getElementsByTagName("body")[0].appendChild(i),e.isRequestSent=!0},s)},isRequestSent:function(){return e.isRequestSent},isFeedbackReceived:function(){return e.isFeedbackReceived},isAuthenticated:function(){return e.isAuthenticated},getUrl:function(){return t},registerFeedback:function(t){var n="success"===t;e.isFeedbackReceived=!0,e.isAuthenticated=n,i(n)}})}(),window.Ya&&Ya.Rum&&(function(t){if(!t)throw new Error("Rum: interface is not included");if(!t.enabled)return t.getSetting=function(){return""},t.getVarsList=function(){return[]},void(t.getResourceTimings=t.pushConnectionTypeTo=t.pushTimingTo=t.normalize=t.sendCounter=t.sendDelta=t.sendTimeMark=t.sendResTiming=t.sendTTI=t.makeSubPage=t.sendFirstPaint=t.sendHeroElement=function(){});t.getSetting=function(e){var i=t._settings[e];return null===i?null:i||""},t.getVarsList=function(){var e=t._vars;return Object.keys(e).map(function(t){return t+"="+e[t]})},t.setVars=function(e){Object.keys(e).forEach(function(i){t._vars[i]=e[i]}),I(),P()};var e,i,n="690.1033",s="690.2096.207",o="690.2096.2877",r="690.2096.2044",a="690.2096.2748",c="690.2096.2335.1822",l=10,h=3e3,u=2e4,d={connectEnd:2116,connectStart:2114,decodedBodySize:2886,domComplete:2124,domContentLoadedEventEnd:2131,domContentLoadedEventStart:2123,domInteractive:2770,domLoading:2769,domainLookupEnd:2113,domainLookupStart:2112,duration:2136,encodedBodySize:2887,entryType:2888,fetchStart:2111,initiatorType:2889,loadEventEnd:2126,loadEventStart:2125,nextHopProtocol:2890,redirectCount:1385,redirectEnd:2110,redirectStart:2109,requestStart:2117,responseEnd:2120,responseStart:2119,secureConnectionStart:2115,startTime:2322,transferSize:2323,type:76,unloadEventEnd:2128,unloadEventStart:2127,workerStart:2137},m={visible:1,hidden:2,prerender:3},p={bluetooth:2064,cellular:2065,ethernet:2066,none:1229,wifi:2067,wimax:2068,other:861,unknown:836,0:836,1:2066,2:2067,3:2070,4:2071,5:2768},f={"first-paint":2793,"first-contentful-paint":2794},_=Object.keys(f).length,g=t.getTime,v=window.performance||{},b=v.timing||{},y=v.navigation||{},w=navigator.connection,k={},E=t._deltaMarks,M=document.createElement("link"),x="function"==typeof v.getEntriesByType,T=b.navigationStart,S=b.responseStart-T,C=b.domainLookupStart-T;if(I(),P(),t.ajaxStart=0,t.ajaxComplete=0,window.PerformanceObserver)try{new PerformanceObserver(function(t,i){var n=t.getEntriesByType("navigation")[0];if(n){i.disconnect();var s=[];V(s,n),z(s),K("690.2096.2892",e.concat(s))}}).observe({entryTypes:["navigation"]})}catch(t){}function I(){e=t.getVarsList().concat("1042="+encodeURIComponent(navigator.userAgent))}function P(){i=e.concat(["143.2129="+T,"143.2112="+C,"143.2119="+S])}function B(){removeEventListener("DOMContentLoaded",B),removeEventListener("load",B),T&&setTimeout(function(){t.sendTimeMark=R,t.sendResTiming=N,t.timeEnd=L;for(var i=t._defRes;i.length;){var n=i.shift();N(n[0],n[1])}for(var s=t._defTimes;s.length;){var o=s.shift();R(o[0],o[1],!1,o[2])}Object.keys(E).forEach(function(t){F(t)}),D(),function e(){if(!x||t.isVisibilityChanged())return;var i=v.getEntriesByType("paint");for(var n=0;n<i.length;n++){var s=i[n],o=f[s.name];o&&!O[s.name]&&(O[s.name]=!0,A++,R("1926."+o,s.startTime))}if(t.getSetting("enablePaintPerformanceObserver")&&A<_)try{new PerformanceObserver(function(t,i){e(),i.disconnect()}).observe({entryTypes:["paint"]})}catch(t){}}(),t.getSetting("sendStaticLocation")&&function(){var i=document.createElement("script"),n=t.getSetting("crossOrigin");i.src="https://yastatic.net/nearest.js",i.async=!0,null!==n&&(i.crossOrigin=n);i.onload=function(){var t=window.YaStaticRegion;t&&K(c,e.concat("1822="+t))},document.head.appendChild(i)}(),H(),x&&("complete"===document.readyState?$():addEventListener("load",$))},0)}function D(){var i=b.domContentLoadedEventStart,s=b.domContentLoadedEventEnd;if(0!==i||0!==s){var o=function(){if(t.isVisibilityChanged())return;if(window.chrome&&"function"==typeof window.chrome.loadTimes)return 1e3*window.chrome.loadTimes().firstPaintTime;if(b.msFirstPaint)return b.msFirstPaint}(),r=e.concat(["2129="+T,"1036="+(b.domainLookupStart-T),"1037="+(b.domainLookupEnd-b.domainLookupStart),"1038="+(b.connectEnd-b.connectStart),b.secureConnectionStart&&"1383="+(b.connectEnd-b.secureConnectionStart),"1039="+(b.responseStart-b.connectEnd),"1040="+(b.responseEnd-b.responseStart),"1040.906="+(b.responseEnd-b.domainLookupStart),"1310.2084="+(b.domLoading-b.responseStart),"1310.2085="+(b.domInteractive-b.responseStart),"1310.1309="+(s-i),"1310.1007="+(i-b.responseStart),"2299="+history.length,navigator.deviceMemory&&"3140="+navigator.deviceMemory,navigator.hardwareConcurrency&&"3141="+navigator.hardwareConcurrency]);t.mark("1039 ttfb",b.responseStart-b.connectEnd),t.mark("1310.1007 dom.loaded",b.domContentLoadedEventStart-b.responseStart),o&&(r.push("2130="+(o-T),"1041="+(o-b.responseStart),"1041.906="+(o-b.domainLookupStart)),t.mark("1041.906 ttfp",o-b.domainLookupStart)),Object.keys(d).forEach(function(t){t in b&&b[t]&&r.push(d[t]+"="+q(b[t],T))}),t.vsStart?(r.push("1484="+(m[t.vsStart]||2771)),t.vsChanged&&r.push("1484.719=1")):r.push("1484="+m.visible),y&&(y.redirectCount&&r.push("1384.1385="+y.redirectCount),1!==y.type&&2!==y.type||r.push("770.76="+y.type)),z(r),K(n,r,["dtype=stred","pid=1","cid=72202"])}else setTimeout(D,50)}"loading"===document.readyState?(addEventListener("DOMContentLoaded",B),addEventListener("load",B)):B();var O={},A=0;function R(e,i,n,o){void 0===i&&(i=g()),void 0!==n&&!0!==n||t.mark(e,i);var r=U(e);r.push("207="+q(i)),j(r,o)&&(K(s,r),k[e]=k[e]||[],k[e].push(i))}function j(t,e){if(e){if(e.isCanceled&&e.isCanceled())return!1;Object.keys(e).forEach(function(i){"function"!=typeof e[i]&&t.push(i+"="+e[i])})}return!0}function L(t){var e=E[t];e&&0!==e.length&&(e.push(g()),F(t))}function F(e,i,n){var s,r,a=E[e];if(void 0!==i?s=(r=t.getTime())-i:a&&(s=a[0],r=a[1]),void 0!==s&&void 0!==r){var c=U(e);c.push("207.2154="+q(s),"207.1428="+q(r),"2877="+q(r-s)),j(c,n)&&(K(o,c),delete E[e])}}function N(t,e){W(e,function(i){if(i){var n=U(t);n.push("13="+encodeURIComponent(e)),V(n,i[0]),K(r,n)}})}function $(){if(removeEventListener("load",$),x){var t=v.getEntriesByType("resource").reduce(function(t,e){var i,n=e.name.match(/^https?:\/\/([^\/?#]+)(?:[\/?#]|$)/i);return n&&((i=n[1])in t||(t[i]={count:0,size:0}),t[i].count++,e.transferSize&&(t[i].size+=e.transferSize)),t},{}),i="2748=";Object.keys(t).forEach(function(e){i+=e+"!"+t[e].count+"!"+(t[e].size||"")+";"}),K(a,e.concat(i))}}function H(e,i,n){if(t._tti){var s=g(),o=function(t,e,o){var r={2796.2797:function(t,e){return t=t||[],e=e||0,t.filter(function(t){return t.startTime-e>=-50}).map(function(t){var e=t.name?t.name.split("-").map(function(t){return t[0]}).join(""):"u",i=Math.floor(t.startTime);return e+"-"+i+"-"+Math.floor(i+t.duration)}).join(".")}(o,i),689.2322:q(s)};n&&Object.keys(n).forEach(function(t){r[t]=n[t]}),R(t||"2795",e,!0,r)},r=function(){var n,a=i||s,c=g(),l=t._tti.events||[],d=l.length;0!==d&&(n=l[d-1],a=Math.max(a,Math.floor(n.startTime+n.duration))),c-a>=h?o(e,a,l):c-a>=u?o(e,(i||s)+u,l):setTimeout(r,1e3)};r()}}function z(t){w&&t.push("2437="+(p[w.type]||2771),w.downlinkMax&&"2439="+w.downlinkMax,w.effectiveType&&"2870="+w.effectiveType)}function W(t,e){if(!x)return e(null);M.href=t;var i=M.href,n=0,s=100;setTimeout(function t(){var o=v.getEntriesByName(i);if(o.length)return e(o);n++<l?(setTimeout(t,s),s+=s):e(null)},0)}function U(e){return i.concat(["1701="+e,t.ajaxStart&&"1201.2154="+q(t.ajaxStart),t.ajaxComplete&&"1201.2052="+q(t.ajaxComplete)])}function V(t,e){Object.keys(d).forEach(function(i){if(i in e){var n=e[i];(n||0===n)&&t.push(d[i]+"="+q(n))}})}function q(t,e){return"string"==typeof t?encodeURIComponent(t):Math.round(1e3*(t-(e||0)))/1e3}function K(e,i,n,s){var o=i.filter(Boolean).join(","),r=s?{href:s}:null;t.send(r,e,o,null,null,null,n)}t.getTimeMarks=function(){return k},t.sendTTI=H,t.sendFirstPaint=function(t){window.requestAnimationFrame?requestAnimationFrame(function(){R("2130",t)}):R("2130",t)},t.sendHeroElement=function(t){R("2876",t)},t._subpages={},t.makeSubPage=function(e,i){var n=t._subpages[e];t._subpages[e]=void 0===n?n=0:++n;var s=!1;return{689.2322:q(void 0!==i?i:Ya.Rum.getTime()),2924:e,2925:n,isCanceled:function(){return s},cancel:function(){s=!0}}},t.getResourceTimings=W,t.pushConnectionTypeTo=z,t.pushTimingTo=V,t.normalize=q,t.sendCounter=K,t.sendDelta=F}(Ya.Rum),Ya.Rum.enabled&&addEventListener("load",function t(){removeEventListener("load",t),Ya.Rum.sendTimeMark("1724");for(var e=document.querySelectorAll("script[data-rCid], div[data-rCid]"),i=0,n=e.length;i<n;i++){var s=e[i],o=s.src;if(!o){var r=getComputedStyle(s).backgroundImage;if(r){var a=r.match(/^url\(["']?(.*?)["']?\)$/);a&&(o=a[1])}}o&&Ya.Rum.sendResTiming(s.getAttribute("data-rCid"),o)}}),function(){"use strict";var t,e=[];function i(){var i=Ya.Rum.getSetting("clck"),n=e.join("\r\n");if((e=[],t=null,i)&&!(navigator.sendBeacon&&Ya.Rum.getSetting("beacon")&&navigator.sendBeacon(i,n))){var s=new XMLHttpRequest;s.open("POST",i),s.send(n)}}Ya.Rum.send=function(n,s,o,r,a,c,l){clearTimeout(t);var h=function(t,e,i,n,s,o){var r=Ya.Rum.getSetting("slots");return[o?"/"+o.join("/"):"","/path="+e,r?"/slots="+r.join(";"):"",i?"/vars="+i:"","/cts="+(new Date).getTime(),"/*"]}(0,s,o,0,0,l);e.push("/reqid="+Ya.Rum.getSetting("reqid")+h.join("")),e.length<42?t=setTimeout(i,15):i()}}()),window.Ya&&Ya.Rum&&Ya.Rum.enabled&&window.BEM&&BEM.channel("i-bem").onFirst("start-init",function(){Ya.Rum.sendTimeMark("2418")}).onFirst("init",function(){Ya.Rum.sendTimeMark("2295")}),function(t,e){var i,n,s,o,r,a,c=4,l=4,h=4;function u(t){var i=n.call(e,"span");return i.innerText=String.fromCharCode(t),i}function d(t,e){return Math.round(t.offsetWidth*e)-1}t.Ya=t.Ya||{},t.Ya.F=t.Ya.F||{},t.Ya.F.calibrate=function(t,m){if(a=null,t){i=e.body,n=e.createElement,s=e.createDocumentFragment,o=i.appendChild,r=i.removeChild;var p=function(t){var i=n.call(e,"div"),s='position:absolute;left:0;top:0;width:1px;height:1px;opacity:0;overflow:hidden;font:1000px "'+t+'", serif;';i.setAttribute("style",s),i.setAttribute("aria-hidden","true");for(var r=0;r<c;r++)o.call(i,u(57344+r));return i}(t);o.call(i,p);var f=p.children,_=16/f[0].offsetWidth,g=d(f[1],_);if(1==g){var v=d(f[2],_),b=d(f[3],_),y=v+(b<<l);if(y<h)P(m,a);else{for(var w=s.apply(e),k=g+v+b,E=0;E<2*y+1;E++)o.call(w,u(57348+E));o.call(p,w);for(var M=[],x=c;x<c+2*y;x+=2){var T=d(f[x],_),S=d(f[x+1],_);M.push(T+(S<<l)),k+=T+S}if(d(f[x],_)==(15&k)){for(var C=0,I=0;I<M.length;I++)C+=M[I]*(1<<8*I);P(m,C)}else P(m,a)}}else P(m,a)}else P(m,a);function P(t,e){p&&(r.call(i,p),p=a),setTimeout(function(){t(e)},0)}}}(window,document),function(){"use strict";$(function(){var t=home&&home.getData&&home.getData("fingerprint.data");t&&t.enabled&&setTimeout(function(){var e=t.zmblt;try{window.Ya.F.calibrate("Yandex-UI-Icons-Private",function(i){null!==i&&Number(i)!==Number(e)&&((new Image).src=t.cookieUrl+"&zmblt="+i)})}catch(t){}},0)})}(),window.ya=window.ya||{},ya.history=window.history&&history.pushState?{navigate:function(t){(t=t||{}).url&&(t.title||(t.title=""),t.data||(t.data=""),t.replace?history.replaceState(t.data,t.title,t.url):history.pushState(t.data,t.title,t.url))},onchange:function(t){$(window).on("popstate",function(e){t.call(this,e.originalEvent)})}}:null,function(){"use strict";function t(){var t=home&&home.getData&&home.getData("i-change-url.data");if(t){var e,i=t.url;try{e=history.state}catch(t){}i&&ya.history&&ya.history.navigate({data:e||null,url:i,replace:!0})}}var e=+new Date;!function i(){window.defaultMetrikaCounter?t():+new Date-e>5e3?t():setTimeout(i,100)}()}(),$(document).ready(function(){var t=home&&home.getData&&home.getData("time-count.data");if(t){var e=null,i=t.timeout,n=3e5,s=+new Date+n,o=[];document.hidden||function t(s){o.push(s),r(),e=s<=n?setTimeout(function(){t(s+i)},i):null}(0),BEM.channel("sys").on("hidden",function t(){e&&(clearTimeout(e),e=null),BEM.channel("sys").un("hidden",t)})}function r(){if(window.defaultMetrikaCounter)for(;o.length;){var e=o.pop(),i={};i["time-"+t.content]={},i["time-"+t.content][t.type]={},i["time-"+t.content][t.type][e]=1,window.defaultMetrikaCounter.params(i)}else+new Date<s&&setTimeout(r,100)}}),BEM.DOM.decl("xiva-notif",{onSetMod:{js:function(){window.WebSocket&&this.params.url&&(this.isConnected=!1,this.isPageClosed=!1,this.last={},this.connectAttempts=0,this.connectAttemptsTimer=null,this.reconnectTimer=null,this._connect(),this.bindToWin("beforeunload",this._disconnect))}},_update:function(t){this._isFreshMessage(t)&&("insert"!==t.operation&&"update labels"!==t.operation||this.channel("mail").trigger("update",{uid:t.uid,value:t.newCount}))},_isFreshMessage:function(t){var e=t.uid;return!!e&&(e in this.last||(this.last[e]=0),this.last[e]<=t.lcn?(this.last[e]=t.lcn,!0):void 0)},_connect:function(){this.last={},this.connectAttempts=0,this.ws=new WebSocket(this.params.url),this.ws.onopen=this._onSocketOpen.bind(this),this.ws.onmessage=this._onSocketMessage.bind(this),this.ws.onclose=this._onSocketClose.bind(this)},_onSocketOpen:function(){this.isConnected=!0,clearTimeout(this.connectAttemptsTimer),this.connectAttemptsTimer=setTimeout(function(){this.isConnected&&(this.connectAttempts=0)}.bind(this),5e3)},_onSocketMessage:function(t){try{var e=JSON.parse(t.data);e.raw_data&&this._update(JSON.parse(e.raw_data))}catch(t){}},_onSocketClose:function(t){if(clearTimeout(this.connectAttemptsTimer),!this.isPageClosed){this.connectAttempts+=1;var e=6e4;this.isConnected=!1,this.connectAttempts<=5?e=3e3:this.connectAttempts<=15&&(e=1e4),4e3===t.code&&(e=3e5),4401!==t.code&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(this._connect.bind(this),e))}},_disconnect:function(){this.isPageClosed=!0,this.ws&&this.ws.close&&this.ws.close(1e3,"unload")}}),MordaRT.prototype.siteInDomainList=function(t,e){for(var i,n=0,s=t.length;n<s;n++)if(i=t[n],this.listRE[i]||(this.listRE[i]=new RegExp("^"+i.replace(/\./g,"\\.").replace(/\*/g,"[^.]+")+"$")),e.match(this.listRE[i]))return!0;return!1},MordaRT.prototype.getHostname=function(t){0!==t.indexOf("http")&&0!==t.indexOf("//")&&(t="//"+t);var e=document.createElement("a");return e.href=t,e.hostname},MordaRT.prototype.getEntries=function(t,e){if(!window.performance||!window.performance.getEntries)return{resources:{},resourcesCount:0};try{var i,n,s=window.performance.getEntries("resources"),o={},r=0;if(s&&s.length)for(var a=0,c=s.length;a<c;a++)if(i=s[a].initiatorType||"unknown",-1!==(n=this.getHostname(s[a].name)).indexOf(".")&&!this.siteInDomainList(t,n)){o[i]||(o[i]={});var l=e?this.quote(s[a].name):n;o[i][l]?o[i][l]++:o[i][l]=1,r++}return{resources:o,resourcesCount:r}}catch(t){return{resources:{},resourcesCount:0}}},MordaRT.prototype.quote=function(t){return t.replace(/"|%22/g,"&quot;")},$(document).ready(function(){var t=home&&home.getData&&home.getData("consistency.data"),e=new MordaRT;if(t){var i=["*.*.yandex.*","*.yandex.*","yandex.*","yastatic.net"];setTimeout(function(){n()},t.timeout)}function n(){var n,a,c,l,h,u=null;"flash"===t.type?t.custom.flashV&&(new CAWBrowser).flash>=t.custom.flashV?(a=$("#banner > object:eq(0)").attr("classid"),c=$("#banner > #bc > noscript").length,l=$("#banner").children().length,h=$("#banner > #bc").children().length,u=a&&"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"===a&&1===c&&2===l&&1===h?null:{horizontal:{flash:1}}):u=s():"img"===t.type?u=s():"hdpi_img"===t.type?u=null:"iframe"===t.type?u=function(){var t=$(".banner-iframe").attr("src"),e=$("#banner > #bc > noscript").length,i=$("#banner").children().length,n=$("#banner > #bc").children().length,s=$(".banner__expand_inner").length+$(".banner__expand_innerclick").length;return o(t)&&1===e&&(2===i||4===i&&2===s)&&1===n?null:{horizontal:{iframe:1}}}():"html"!==t.type&&(u=(n=$(".b-line_adv")).length&&0===n.children().length?null:3===$(".main").children().length?null:{horizontal:{none:1}});var d=function(){var t=[],e=!1,i={};if($("img").each(function(){var e=$(this).parents("a");this.src&&e.length&&t.push({src:this.src,link:e.attr("href")})}),t.length)for(var n=0,s=t.length;n<s;n++)o(t[n].link)||o(t[n].src)||(e=!0,i[t[n].link]={},i[t[n].link][t[n].src]=1);return e?{image:1,links:i,ignore:1}:null}(),m=$("html")[0].style.cssText?{html:1}:null;d&&u?$.extend(u,d):d&&(u=d),m&&u?$.extend(u,m):m&&(u=m),function(){var t,e,n=home.bnCounts;if(n&&n.length)for(var s=0,o=n.length;s<o;s++)(t=document.createElement("a")).href=n[s],e=t.host,i.push(e)}(),function(n){n&&!n.ignore?r("1"):"1"===t.csc&&r("2");n&&n.ignore&&delete n.ignore;var s=null,o=e.getEntries(i),a=e.getEntries(i,!0);n&&((s=s||{})["consistency-"+t.content]=n);o.resourcesCount&&((s=s||{})["resources-consistency-"+t.content]=o.resources);a.resourcesCount&&o.resources.script&&((s=s||{})["resources-src-consistency-"+t.content]=a.resources.script);s&&window.defaultMetrikaCounter&&window.defaultMetrikaCounter.params(s)}(u)}function s(){var e=$("#banner > #bc > noscript").length,i=$("#banner > #bc").children().length,n="",s="";return t.custom.gif?n=$("#banner > img").attr("src"):(s=$("#banner > a").attr("href"),n=$("#banner > a > img").attr("src")),n!==t.custom.img||!t.custom.gif&&s!==t.custom.href||1!==e||1!==i?t.custom.img?{horizontal:{img:1}}:{horizontal:{none:1}}:null}function o(t){if(!t||"#"===t||0===$.trim(t).indexOf("javascript"))return!0;var n=e.getHostname(t);return e.siteInDomainList(i,n)}function r(e){var i=$('<iframe class="a11y-hidden"></iframe>');$("body").append(i),i.attr("name","consistency"+(Math.random()+"").substr(3,7)),i.attr("src",t.url+"&csc="+e)}}),$(function(){var t=home&&home.getData&&home.getData("consistencyPopup.data");t&&(t.zIndex=1e5+Math.floor(1e3*Math.random()),setTimeout(function(){var e=$(home.view("consistency-popup__html",t));$("a:last",e).click(function(){return(new Image).src=t.closeLink,e.remove(),!1}),$(".button_theme_cpopup__close",e).click(function(){return(new Image).src=t.closeLink,e.remove(),!1}),$("body").append(e),(new Image).src=t.pixel},t.timeout))}),BEM.decl("custom-protocol-detect",{},{protocolCheck:function(t,e,i){var n=this._checkBrowser();return n.isMsLaunchUri?this._openUriWithMsLaunchUri(t,e,i):n.isFirefox?this._openUriUsingFirefox(t,e,i):n.isWebkit?this._openUriWithHiddenFrame(t,e,i):n.isIE?this._openUriUsingIEInOlderWindows(t,e,i):void(i&&i())},_openUriWithHiddenFrame:function(t,e,i){this._blurWindowHack(e,i),this._getHiddenIframe().contentWindow.location.href=t},_openUriUsingFirefox:function(t,e,i){var n=this._getHiddenIframe();try{n.contentWindow.location.href=t,e&&e()}catch(t){i()}},_openUriUsingIEInOlderWindows:function(t,e,i){this[{9:"openUriWithHiddenFrame",10:"openUriUsingIe10InWindows7",11:"openUriWithHiddenFrame"}[home.getData("custom-protocol-detect.ieVersion")]||"_openUriInNewWindowHack"](t,e,i)},_openUriUsingIe10InWindows7:function(t,e,i){var n=this._getHiddenIframe(),s=i?setTimeout(i,1e3):null;BEM.DOM.win.on("blur",function(){s&&clearTimeout(s),e&&e()});try{n.contentWindow.location.href=t}catch(t){i&&i(),clearTimeout(s)}},_openUriInNewWindowHack:function(t,e,i){var n=window.open("","","width=0,height=0");n.document.write("<iframe src='"+t+"'></iframe>"),setTimeout(function(){try{n.location.href=t,n.setTimeout(function(){n.close()},1e3),e&&e()}catch(t){n.close(),i&&i()}},1e3)},_openUriWithMsLaunchUri:function(t,e,i){navigator.msLaunchUri(t,e,i)},_checkBrowser:function(){return{isMsLaunchUri:Boolean(navigator.msLaunchUri),isFirefox:"undefined"!=typeof InstallTrigger,isWebkit:Boolean(window.chrome||window.opr||window.safari),isIE:home.getData("custom-protocol-detect.isMSIE")}},_getHiddenIframe:function(){if(!this.iframe){var t=document.createElement("iframe");t.src="about:blank",t.style.display="none",t.name="custom-protocol-detect",document.body.appendChild(t),this.iframe=t}return this.iframe},_blurWindowHack:function(t,e){var i=setTimeout(function(){BEM.DOM.win.off("blur",n),e&&e()},1e3);function n(){clearTimeout(i),BEM.DOM.win.off("blur",n),t&&t()}BEM.DOM.win.on("blur",n)}}),function(){"use strict";var t,e=!1,i=[];home.pseudoReady=function(n){e?setTimeout(n,0):(i.push(n),t||(t=setTimeout(function t(){if(document.body&&home.export){e=!0;for(var n=0;n<i.length;++n)setTimeout(i[n],0)}else setTimeout(t,100)},100)))}}(),function(){var t=null,e=!1,i=!1,n=document.createElement("div"),s=function(t){return n.innerHTML=t,n.firstChild};function o(n,o){if(o&&o.id){t||(t=s('<iframe style="display:none" src="'+n+'" name="ga"></iframe>'));var r=function(){t.contentWindow.postMessage&&t.contentWindow.postMessage({id:o.id,type:"params",params:o.params,labels:o.labels,remarketingOnly:o.remarketingOnly},"*")};i?r():t.onload=function(){i=!0,r()},e||(document.body.appendChild(t),e=!0)}}var r,a=null,c=!1;function l(t){return window.home&&home.getData&&home.getData("ga-counter."+t)}window.home=window.home||{},window.home.gaCounter={track:function(t){var e,i=l("morda");i&&i.customLabels&&i.customLabels[t]&&(e={id:i.id,params:null,labels:i.customLabels[t],remarketingOnly:i.remarketingOnly},o(i.iframeSrc,e))},trackEther:function(){var t=l("ether");t&&t.customLabels&&t.customLabels.ether&&(r=setTimeout(function(){var e={id:t.id,params:null,labels:t.customLabels.ether,remarketingOnly:t.remarketingOnly};o(t.iframeSrc,e)},t.timeout))},stopTrackEther:function(){clearTimeout(r)},trackCancel:function(){this.track("cancel")},trackCancelPopup:function(){this.track("cancelPopup")}},home.pseudoReady(function(){var t=l("morda");function e(){if(t.iframeSrcEx)i=t.iframeSrcEx+function(){for(var t=[],e=0,i=arguments.length;e<i;e++)arguments[e]&&t.push(arguments[e]);return t.length?"?"+t.join("&"):""}(function(){var e=window.performance&&performance.timing&&performance.timing.responseEnd&&performance.timing.responseStart?performance.timing.responseEnd-performance.timing.responseStart:null;if(t.statDownloadTime&&e){if(e>Number(t.statDownloadTime[1]))return"slow=2";if(e>Number(t.statDownloadTime[0]))return"slow=1"}return""}(),t.csc?"csc="+t.csc:"",t.refg?"refg=1":"",t.swb?"swb=1":""),a||(a=s('<iframe style="display:none" src="'+i+'" name="ga-ex"></iframe>')),c||(document.body.appendChild(a),c=!0);else if(t.iframeSrc){var e={id:t.id,params:t.params,labels:t.labels,remarketingOnly:t.remarketingOnly};o(t.iframeSrc,e)}var i}t&&function(){if(t.swb)return!0;var e;try{e=localStorage.getItem("gaCounterShowTime")}catch(t){}return!e||Number(e)<t.ignoreLSBefore||+new Date-Number(e)>t.showTimeout}()&&setTimeout(function(){e(),function(){try{localStorage.setItem("gaCounterShowTime",+new Date)}catch(t){}}()},t.timeout)})}(),$(document).ready(function(){var t=home&&home.getData&&home.getData("yandcache.data");t&&window.setTimeout(function(){var e=document.createElement("script");e.src=t.url,document.getElementsByTagName("head")[0].appendChild(e)},t.timeout)}),function(t){var e,i,n=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(t.event.fixHooks)for(var r=n.length;r;)t.event.fixHooks[n[--r]]=t.event.mouseHooks;var a=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=s.length;e;)this.addEventListener(s[--e],c,!1);else this.onmousewheel=c;t.data(this,"mousewheel-line-height",a.getLineHeight(this)),t.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=s.length;e;)this.removeEventListener(s[--e],c,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e),n=i["offsetParent"in t.fn?"offsetParent":"parent"]();return n.length||(n=t("body")),parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function c(n){var s=n||window.event,r=o.call(arguments,1),c=0,u=0,d=0,m=0,p=0,f=0;if((n=t.event.fix(s)).type="mousewheel","detail"in s&&(d=-1*s.detail),"wheelDelta"in s&&(d=s.wheelDelta),"wheelDeltaY"in s&&(d=s.wheelDeltaY),"wheelDeltaX"in s&&(u=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(u=-1*d,d=0),c=0===d?u:d,"deltaY"in s&&(d=-1*s.deltaY,c=d),"deltaX"in s&&(u=s.deltaX,0===d&&(c=-1*u)),0!==d||0!==u){if(1===s.deltaMode){var _=t.data(this,"mousewheel-line-height");c*=_,d*=_,u*=_}else if(2===s.deltaMode){var g=t.data(this,"mousewheel-page-height");c*=g,d*=g,u*=g}if(m=Math.max(Math.abs(d),Math.abs(u)),(!i||m<i)&&(i=m,h(s,m)&&(i/=40)),h(s,m)&&(c/=40,u/=40,d/=40),c=Math[c>=1?"floor":"ceil"](c/i),u=Math[u>=1?"floor":"ceil"](u/i),d=Math[d>=1?"floor":"ceil"](d/i),a.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();p=n.clientX-v.left,f=n.clientY-v.top}return n.deltaX=u,n.deltaY=d,n.deltaFactor=i,n.offsetX=p,n.offsetY=f,n.deltaMode=0,r.unshift(n,c,u,d),e&&clearTimeout(e),e=setTimeout(l,200),(t.event.dispatch||t.event.handle).apply(this,r)}}function l(){i=null}function h(t,e){return a.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}(jQuery),BEM.DOM.decl("button",{onSetMod:{js:{inited:function(){var t=this.isDisabled(),e=this.domElem;(this._href=e.attr("href"))&&t&&e.removeAttr("href")}},disabled:function(t,e){var i=this.domElem;e&&this.delMod("hovered"),this._href&&(e?i.removeAttr("href"):i.attr("href",this._href)),this.afterCurrentEvent(function(){i&&i.prop("disabled",e)})},pressed:function(t,e){if(this.hasMod("disabled"))return!1;this.trigger(e?"press":"release")}},isDisabled:function(){return this.hasMod("disabled","yes")},url:function(t){return void 0===t?this._href:(this._href=t,this.isDisabled()||this.domElem.attr("href",t),this)},getUrl:function(){return this.url()},setUrl:function(t){return this.url(t)},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onClick:function(t){this.isDisabled()?t.preventDefault():this.afterCurrentEvent(function(){this.domElem&&this.trigger("click")})}},{live:function(){this.liveBindTo("pointerclick",function(t){this._onClick(t)}).liveBindTo("pointerpress",function(t){this.isDisabled()||this._onPointerpress(t)})}}),BEM.DOM.decl("button",{onSetMod:{focused:{yes:function(){if(this.isDisabled())return!1;this.bindToWin("unload",function(){this.delMod("focused")}).bindTo("keydown",this._onKeyDown),this._isControlFocused()||this._getControl().focus(),this.trigger("focus")},"":function(){var t=BEM.blocks["i-ua"].opera<13;this.unbindFromWin("unload").unbindFrom("keydown"),(t||document.hasFocus())&&this._isControlFocused()&&this._getControl().blur(),this.trigger("blur")}},disabled:function(t,e){this.__base.apply(this,arguments),e&&(this.delMod("focused"),this.domElem.keyup())},hovered:function(t,e){if(this.isDisabled())return!1;!e&&this.delMod("pressed")},pressed:function(){return this.isDisabled()||this.setMod("focused","yes"),this.__base.apply(this,arguments)}},_getControl:function(){return this.elem("control").length&&this.elem("control")||this.domElem},_isControlFocused:function(){return this.containsDomElem($.dom.getActiveElement())},_onKeyDown:function(t){var e=BEM.blocks.keycodes,i=t.keyCode;!this._keyDowned&&e.is(i,"ENTER","SPACE")&&(this._keyDowned=!0,this.setMod("pressed","yes").bindTo("keyup",function(){this.delMod("pressed").unbindFrom("keyup"),delete this._keyDowned,i===e.SPACE&&this.domElem.attr("href")&&(document.location=this.domElem.attr("href"))}))},destruct:function(){this.delMod("focused"),this.__base.apply(this,arguments)}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.isDisabled()||this.domElem[0].contains(t.relatedTarget)||this.toggleMod("hovered","yes","pointerover"===t.type)}).liveBindTo("focusin focusout",function(t){this.toggleMod("focused","yes","focusin"===t.type)}),8===BEM.blocks["i-ua"].ie&&this.liveBindTo("mouseup mouseout",function(t){this.domElem.height()}),this.__base()}}),function(t){t.dom={getActiveElement:function(){try{return t(document.activeElement)}catch(e){return t()}}},t.fn.isFocused=function(){return this.is(t.dom.getActiveElement())}}(jQuery),BEM.DOM.decl({block:"button",modName:"type",modVal:"check"},{onSetMod:{checked:{yes:function(){this.trigger("check").domElem.attr("aria-pressed","true")},"":function(){this.trigger("uncheck").domElem.attr("aria-pressed","false")}}},_onClick:function(){this.__base.apply(this,arguments),this.toggleMod("checked","yes")}}),function(){"use strict";BEM.DOM.decl("b-themes-catalog",{onSetMod:{js:{inited:function(){this._vars={scrollItemsCount:5,scrollSpeed:300,tabsScrollWidth:100,themeItemWidth:this.elem("theme-item").outerWidth(!0),leftGapWidth:this.elem("theme-item-gap").outerWidth(!0),rightGapWidth:this.elem("theme-item-gap").outerWidth(!0),bodyWidth:0,visibleThemesCount:0,buttonsWidth:0,categoriesTabsWidth:0,categoriesScrollWidth:0,notLoadThemes:this.elem("theme-img").toArray()};var t=this.getLocationHash(),e=this.elem("theme-item","id",this.params.activeTheme).position().left-this._vars.leftGapWidth,i=t.group||t.tab;this.updateResize(),this.setMod("active-theme",this.params.activeTheme),i&&this.elem("tab","name",i).length?this.setMod("current-group",i):this.setMod("current-group","all"),"groups_scroll_position"in t&&this.elem("tabs-scroll").scrollLeft(parseInt(t.groups_scroll_position)||0),"themes_scroll_position"in t&&(e=parseInt(t.themes_scroll_position||0)),this.elem("body").scrollLeft(e),this.updateView(),this.bindToWin("resize",$.throttle(function(){this.updateResize(),this.updateView(),this.loadImgPreview()}),100),this.bindTo("tab","click",function(t){this.setMod("current-group",this.getMod($(t.target),"name"))}),this.bindTo(this.elem("arrow","scroll","left"),"click",function(){var t=this._vars.themeItemWidth*this._vars.scrollItemsCount+this.elem("body").scrollLeft()%this._vars.themeItemWidth;this.elem("body").stop(),this.elem("body").animate({scrollLeft:"-="+t},this._vars.scrollSpeed)}),this.bindTo(this.elem("arrow","scroll","right"),"click",function(){var t=this._vars.themeItemWidth*this._vars.scrollItemsCount-this.elem("body").scrollLeft()%this._vars.themeItemWidth;this.elem("body").stop(),this.elem("body").animate({scrollLeft:"+="+t},this._vars.scrollSpeed)}),this.bindTo(this.elem("arrow","scroll-tab","left"),"click",function(){this.elem("tabs-scroll").stop(),this.elem("tabs-scroll").animate({scrollLeft:"-="+this._vars.tabsScrollWidth},"fast")}),this.bindTo(this.elem("arrow","scroll-tab","right"),"click",function(){this.elem("tabs-scroll").stop(),this.elem("tabs-scroll").animate({scrollLeft:"+="+this._vars.tabsScrollWidth},"fast")}),this.bindTo("body","mousewheel",function(t){var e=t.deltaFactor*(t.deltaY-t.deltaX);return e=this.params.isWinOperaPresto?t.originalEvent.wheelDelta/2:e,this.elem("body").scrollLeft(this.elem("body").scrollLeft()-e),!1}),this.bindTo("body","scroll",this.updateView),this.bindTo("body","scroll",this.loadImgPreview),this.bindTo("tabs-scroll","scroll",this.updateView),this.bindTo("tabs-scroll","mousewheel",function(t){var e=t.deltaFactor*(t.deltaY-t.deltaX);return e=this.params.isWinOperaPresto?t.originalEvent.wheelDelta/2:e,this.elem("tabs-scroll").scrollLeft(this.elem("tabs-scroll").scrollLeft()-e),!1}),this.bindTo("theme-item","click",function(t){var e=t.data.domElem;if(!e.hasClass("b-themes-catalog__theme-item_active_true"))return this.addHashToLink(e,{group:this.getMod("current-group"),groups_scroll_position:this.elem("tabs-scroll").scrollLeft(),themes_scroll_position:this.elem("body").scrollLeft()}),home.stat.redirect(e[0],e.data("statlog"))}),this.setMod(this.elem("bg"),"hidden","true"),this.loadImgPreview(),window.Ya&&window.Ya.share2||$.getScript("//yastatic.net/share2/share.js",function(){this.setMod(this.elem("theme-item-share"),"enable","true")}.bind(this))}},"current-group":function(t,e){var i=this.elem("tab"),n=this.elem("tab","name",e),s=this.elem("theme-item"),o=this.elem("theme-item","group-"+e,"true");this.setMod(i,"active","false"),this.setMod(n,"active","true"),this.setMod(s,"hidden","yes"),this.delMod(o,"hidden"),this._vars.visibleThemesCount=o.length,this.elem("body").scrollLeft(0),this.updateView(),this.loadImgPreview()},"active-theme":function(t,e){this.setMod(this.elem("theme-item"),"active","false"),this.setMod(this.elem("theme-item","id",e),"active","true")}},updateResize:function(){this._vars.bodyWidth=this.elem("body").width(),this._vars.buttonsWidth=0,this.elem("button").each(function(t,e){this._vars.buttonsWidth+=$(e).outerWidth(!0)}.bind(this)),this._vars.categoriesTabsWidth=this.elem("categories-general").outerWidth(!0)+this.elem("categories-other").outerWidth(!0),this._vars.categoriesScrollWidth=this._vars.bodyWidth-this._vars.buttonsWidth},updateView:function(){var t=this._vars.visibleThemesCount*this._vars.themeItemWidth+this._vars.leftGapWidth+this._vars.rightGapWidth;this.setMod(this.elem("arrow","scroll","left"),"hidden",(this.elem("body").scrollLeft()<=0).toString()),this.setMod(this.elem("arrow","scroll","right"),"hidden",(this.elem("body").scrollLeft()+this._vars.bodyWidth===t||this._vars.bodyWidth>t).toString()),this.elem("tabs-scroll").css({width:this._vars.categoriesScrollWidth+"px"}),this.setMod(this.elem("arrow","scroll-tab","left"),"hidden",(this.elem("tabs-scroll").scrollLeft()<=0).toString()),this.setMod(this.elem("arrow","scroll-tab","right"),"hidden",(this.elem("tabs-scroll").width()>this._vars.categoriesTabsWidth||this.elem("tabs-scroll").scrollLeft()+this._vars.categoriesScrollWidth>=this._vars.categoriesTabsWidth).toString())},loadImgPreview:function(){this._vars.notLoadThemes.length&&(this._vars.notLoadThemes=this._vars.notLoadThemes.filter(function(t){var e=$(t),i=e.offset().left;return!(!e.closest(".b-themes-catalog__theme-item_hidden_yes").length&&i+this._vars.themeItemWidth>0&&i<this._vars.bodyWidth)||(e.prepend($("<img />",{class:"b-themes-catalog__theme-async-img",src:e.data("preview_url")})),!1)},this))},getLocationHash:function(){for(var t,e=window.location.hash?window.location.hash.substr(1).split("&"):[],i={},n=0;n<e.length;n++)i[(t=e[n].split("="))[0]]=void 0!==t[1]?t[1]:null;return i},addHashToLink:function(t,e){var i=[],n=t.attr("href");for(var s in e)e.hasOwnProperty(s)&&i.push(s+"="+e[s]);i.length&&(n+=(-1!==n.indexOf("#")?"":"#")+i.join("&")),t.attr("href",n)}})}(),home.pseudoReady(function(){var t=window.home&&home.getData&&home.getData("szm.data");if(t){setTimeout(function(){var e,i=window.devicePixelRatio||1,n=screen.width,s=screen.height,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=home.getData("szm.data.szm",null),c=home.getData("szm.data.swap")||!1;i=String(i).replace(".","_"),c&&n<s&&(e=n,n=s,s=e),a&&function(t,e){for(var i in e)if(e.hasOwnProperty(i)&&(!t[i]||Math.abs(parseFloat(t[i])-parseFloat(e[i]))>.01))return!1;return!0}(a,{dpr:i,screenX:n,screenY:s,viewportX:o,viewportY:r})||((new Image).src=t.url+(i+":")+n+"x"+s+":"+o+"x"+r)},t.timeout)}}),$(document).ready(function(){var t=home&&home.getData&&home.getData("network-information.data");if(t){var e=navigator&&navigator.connection&&navigator.connection.type?navigator.connection.type:"";e&&setTimeout(function(){i()},t.timeout)}function i(){if(window.defaultMetrikaCounter){var n={"connection-type":{}};n["connection-type"][t.content]={},n["connection-type"][t.content][e]=1,window.defaultMetrikaCounter.params(n)}else setTimeout(i,500)}}),home.pseudoReady(function(){var t=home&&home.getData&&home.getData("referers.data");if(t){var e=location.hash?location.hash.replace(/^#/,""):"",i=e&&e.match(/^[1-578]$/),n=home.getData("timing.reqid")||"";i&&t.referer&&((new Image).src="/instant/log?type=clckerror&showid="+n+"&message="+[i[0],t.content,t.page,t.referer].join("_"))}}),$(function(){window.performance&&performance.navigation&&1===performance.navigation.type&&home.stat.logPath("tech","refresh")}),function(){"use strict";var t,e,i={},n={},s=/([^.(]+)(?:\(([^)]*)\))?\.?/g,o=/^([^=]+)=(.+)$/,r={show:!0};home.stat={},home.stat.attr="data-statlog",home.stat.brfix=1,home.stat.getCustomPageParams=function(){var t=home&&home.getData&&home.getData("redir-stats.data")||"",e="",i="";window.Ya&&Ya.Rum&&(e+="/timefs="+Math.floor(Ya.Rum.getTime()));var n=home.getData?home.getData("timing.vars"):"";return n&&(n[1964]?i="/mexp=0":n[1965]&&(i="/mexp=1")),t+e+i};home.stat._sendPost=function(e,i,n){var s;if("XDomainRequest"in window?s=new XDomainRequest:"XMLHttpRequest"in window&&(s=new XMLHttpRequest),s){s.open("post",n||t,!0),s.withCredentials=!0;try{s.setRequestHeader("Accept","text/plain, */*; q=0.01"),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")}catch(t){}i&&("onreadystatechange"in s?s.onreadystatechange=function(){4===s.readyState&&i()}:s.onload=s.onerror=i),s.send(e)}};var a,c=function(t){return"/dtype=clck"+home.stat.getCustomPageParams()+"/session_id="+i.showId+"/events="+encodeURIComponent(JSON.stringify(t.map(function(t){return{event:t.type,url:t.url,"parent-path":i.statRoot,blocks:t.array}})))+"/*"},l=function(n){if(clearTimeout(a),e){var s=c(e);!function(e){if(i.useBeacon&&"sendBeacon"in navigator)return navigator.sendBeacon(t,e)}(s)?home.stat._sendPost(s,n):n&&n(),e=null}};home.stat.flushQueue=l;var h=function(t,e){var i=e,n=[];t.replace(s,function(t,e,i){n.push({key:e,params:i?i.split(";"):[]})});for(var r=0;r<n.length;++r){var a,c=n[r].params,l=n[r].key;!i.some(function(t){if(t.ctag===l)return a=t,!0})&&(a={ctag:l},i.push(a)),c.length&&c.forEach(function(t){var e=t.match(o);a[e[1]]=decodeURIComponent(e[2])}),r+1<n.length&&(i=a.children=a.children||[])}return e};home.stat.logPath=function(t,s,o){var c,u,d;if(o&&"clean"===o.mode&&function(t){t&&e&&e.length&&0===(e=e.filter(function(e){return e.type!==t})).length&&(e=null)}(t),o&&o.customParams&&(s+=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+"="+encodeURIComponent(t[i]));return e.length?"("+e.join(";")+")":""}(o.customParams)),i.enabled&&t&&s){if(e||(e=[]),"show"===t){if(s in n)return;n[s]=!0}r[t]&&(d=function(t){if(!r[t])throw new Error(t+" is not mergeable type");for(var i=0;i<e.length;++i)if(e[i].type===t)return e[i]}(t)),d=d||(e[e.length]={type:t,url:o&&o.url,array:[]}),h(s,d.array),o&&o.callback?(l(c=function(){u||(u=!0,o.callback())}),void 0!==o.callbackTimeout&&setTimeout(c,o.callbackTimeout)):(clearTimeout(a),a=setTimeout(l,0))}else o&&o.callback&&setTimeout(o.callback,0)},home.stat.redirect=function(e,n){if(!i.enabled||!n)return!0;var s,o,r=e.href;if(i.useBeacon&&"sendBeacon"in navigator&&(o=c([{type:"click",url:r,array:h(n,[])}]),navigator.sendBeacon(t,o)))return!0;if(void 0!==i.delayedSend)return home.stat.logPath("click",n,{url:r,callbackTimeout:i.delayedSend,callback:function(){location.href=r}}),!1;if("_blank"===e.target)return o=c([{type:"click",url:r,array:h(n,[])}]),home.stat._sendPost(o),!0;if(!e.getAttribute("data-statlog-timeout")&&-1===r.indexOf("/lid="+i.statRoot)){if(s=e.getAttribute("data-statlog-url"))e.href=s;else{var a=function(t){var e=[];return{counter:t.replace(/\(([^)]+)\)/g,function(t,i){return e.push(i.replace(/;/g,",")),""}),vars:e=e.length?"/vars="+e.join(","):""}}(n);e.href=i.redirHost+"redir/dtype=clck"+home.stat.getCustomPageParams()+"/lid="+i.statRoot+"."+a.counter+"/sid="+i.showId+a.vars+"/rnd="+((new Date).getTime()+Math.round(100*Math.random()))+"/*data="+encodeURIComponent("url="+encodeURIComponent(r.match(/^http/)?r:location.protocol+"//"+location.host+(r.match("^/")?r:"/"+r)))}e.setAttribute("data-statlog-orig-href",r),e.setAttribute("data-statlog-timeout",setTimeout(function(){e.href=r,e.removeAttribute("data-statlog-timeout"),e.removeAttribute("data-statlog-orig-href")},500))}return!0};var u=function(t){var e;if(!t.getAttribute&&"length"in t){e=new Array(t.length);for(var i=0;i<t.length;++i)e[i]=t[i];return e}return[t]};home.stat.collectShows=function(t,e){var i=[],s=[];return u(t).forEach(function(t){i=i.concat(u(t.querySelectorAll("["+home.stat.attr+"]"))),t.getAttribute(home.stat.attr)&&i.push(t)}),i.forEach(function(t){var i=t.getAttribute(home.stat.attr),o=t.getAttribute("data-statlog-showed")||i in n;if(i&&!o){if(!(e&&!1===e.visibilityCheck||function(t){return t&&(0!==t.offsetWidth||0!==t.offsetHeight)}(t)))return;s.push(i)}}),s},home.stat.logDOMShow=function(t,e){i.enabled&&home.stat.collectShows(t,e).forEach(function(t){home.stat.logPath("show",t)})},home.stat._countShows=function(t){i.enabled&&t.forEach(function(t){n[t]=!0})},home.stat.clearShows=function(){i.enabled&&(n={})},home.stat.getRoot=function(){return i.enabled&&i.statRoot||""},home.stat.setCounter=function(t,e){u(t).forEach(function(t){t.setAttribute(home.stat.attr,e)})};var d=function(t){var e,i=t.target||t.srcElement;if((t.which||t.button)<2){for(;i&&i!==document&&!(e=i.getAttribute(home.stat.attr));)i=i.parentNode;if(e&&i)"0"!==i.getAttribute("data-statlog-redir")&&i.href?i.href&&"click"===t.type&&!t.defaultPrevented&&!1!==t.returnValue&&(home.stat.redirect(i,e)||("preventDefault"in t?t.preventDefault():t.returnValue=!1)):"mousedown"===t.type&&home.stat.logPath("click",e)}},m=function(t,e){"addEventListener"in document?document.addEventListener(t,e,!1):document.attachEvent("on"+t,e)},p=function(){i.enabled&&(m("mousedown",d),m("click",d))};home.subscribeData(function(){i=home.getData("statlog.config",{}),t=i.clckDemonHost+"counter","querySelectorAll"in document||(i.enabled=!1),p()}),home.stat._processClicks=d,home.stat._setConfig=function(e){t=(i=e).clckDemonHost+"counter",n={},p()}}(),$(document).ready(function(){var t=home&&home.getData&&home.getData("search-provider.data");t&&function e(){if(window.defaultMetrikaCounter)try{var i,n="yandex."+t.zone,s={"search-provider":{}};window.external&&external.IsSearchProviderInstalled&&(i=external.IsSearchProviderInstalled(n)),void 0!==i&&(s["search-provider"][n]=i,window.defaultMetrikaCounter.params(s))}catch(t){return!1}else setTimeout(e,300)}()}),window.home=window.home||{},home.rtstats={inited:!1,init:function(){return this.requestId=home.getData("statlog.config.showId"),this.host=home.getData("statlog.config.redirHost"),this.requestId&&(this.host+="/click",this.inited=!0),this.inited},sendOld:function(t,e){if(this.inited||this.init()){var i=["143="+t,"287=213"];for(var n in e)e.hasOwnProperty(n)&&i.push(n+"="+e[n]);var s=["/dtype=stred","/pid=1","/cid=72202","/reqid="+this.requestId,"/path=690.1033","/vars="+i.join(","),"/slots="+(home.getData("timing.exp")||""),"/*"].join(""),o=!1;"sendBeacon"in navigator&&(o=navigator.sendBeacon(this.host,s)),o||((new Image).src=this.host+s)}}},$(document).ready(function(){var t=home&&home.getData&&home.getData("adb.data");if(t){var e,i=2,n=!1,s=1,o=t.timeout,r=!1,a={};t.desktopKubr&&(l("28.15.1132.1671"),setTimeout(function(){l("28.15.1132.1671.791")},5e3)),setTimeout(function(){c()},o),home._cbCheck=c()}function c(){if(!n){n=s===i,s++;var a,l=function(){var t=$('<div class="b-spec-adv" aria-hidden="true"></div>');$("body").append(t);var e=0===document.getElementsByClassName("b-spec-adv")[0].offsetWidth;return t.remove(),e}(),h=!!t.desktopKubr&&!$(".media-grid").is(":visible"),u=!1,d={"content-blocking":{}},m={},p=!1;if(t.desktopKubr){var f=home.getData("rtb.vis");window.AwapsJsonAPI&&!f?u=AwapsJsonAPI.Json.prototype.bannerIsInvisible():window.RtbAPI&&f&&(u=RtbAPI.prototype.bannerIsInvisible())}l?(m[1]=1,d["content-blocking"].easylist=1,p=!0):(a=t.adg).str&&a.check&&(r||(r=$('<div aria-hidden="true">'+a.str+"</div>"),$("body").append(r)),0===$(a.check,r)[0].offsetWidth)&&(m[5]=1,d["content-blocking"].adguard=1,p=!0),h&&(m[3]=1,d["content-blocking"].mediafooter=1,p=!0),home._cbsc&&(m[4]=home._cbsc,d["content-blocking"].styles=home._cbsc,p=!0),u&&(m[2]=u,d["content-blocking"].blocked=u,p=!0),p?(n=!0,function(){var e=new Date;e.setTime(e.getTime()+12096e5);var i="; expires="+e.toUTCString(),n=home.getData("adb.data.domain")||"ru";document.cookie="bltsr=1"+i+";domain=.yandex."+n+"; path=/",t.cookie&&(document.cookie=t.cookie+"=1"+i+";domain=.yandex."+n+"; path=/")}(),t.adb||home.stat.logPath("show","adb.new"),e=+new Date,function t(i){window.defaultMetrikaCounter?window.defaultMetrikaCounter.params(i):new Date-e<5e3&&setTimeout(function(){t(i)},300)}(d)):(o*=2,setTimeout(function(){c(),r&&r.remove()},o))}}function l(e){var i,n={1036:".widgets__col_td_1",1037:".home-arrow",1038:".widgets__col_td_3",1039:".b-widget-data iframe"},s={1038:function(){return!$(".widgets__col_td_3").children().length&&!$(".widgets__col_td_4").children().length}},o={},r=!1;for(var c in n){if(n.hasOwnProperty(c))i=$(n[c]).length&&!$(n[c]).is(":visible"),!!s[c]&&s[c]()&&(i=!1),i&&!a[c]&&(a[c]=!0,r=!0,o[c]=1)}r&&(!function(e){$(".i-ua_browser_firefox").length?e[1040]=1:e[1041]=1,t.skin&&(e[1051]=t.skin)}(o),home.rtstats.sendOld(e,o))}}),function(){"use strict";var t=/^(?:(.*?):)?\/\/([^/?#\s]+)(\/?.*)$/,e=/^(\/?[^?#\s]*)(?:\?([^#]+))?(?:#(.*))?$/;function i(t){var e=[];if(!t)return"";for(var i in t)if(t.hasOwnProperty(i)&&void 0!==t[i]&&null!==t[i]){var n=t[i];"object"!=typeof n&&(n=[n]);for(var s=0;s<n.length;++s)e.push(encodeURIComponent(i)+(""!==n[s]?"="+encodeURIComponent(n[s]):""))}return e.length?"?"+e.join("&"):""}home.parseSearch=function(t,e){return t.split("&").reduce(function(t,i){if(!i)return{};var n,s,o=i.match(/([^=]*)=(.*)/);return o?(n=decodeURIComponent(o[1]),s=decodeURIComponent(o[2])):(n=decodeURIComponent(i),s=""),n in t&&e?("string"==typeof t[n]&&(t[n]=[t[n]]),t[n].push(s)):t[n]=s,t},{})},home.parseUrl=function(i,n){var s,o=i.match(t);if(o?s=o[3].match(e):(o=[],s=i.match(e)),!o&&!s)throw new TypeError('Invalid url "'+i+'"');var r={scheme:o[1]||"",host:o[2]||"",path:s&&s[1]||"",search:s&&s[2]||"",hash:s&&s[3]||"",query:{}};return r.query=home.parseSearch(r.search,n&&n.multi),r},home.makeUrl=function(t){var e="";return!t.scheme||!t.host&&t.path||(e+=t.scheme+"://"),t.host&&(t.scheme||(e+="//"),e+=t.host),e&&(t.path&&0!==t.path.indexOf("/")||!t.path)&&"/"!==e.charAt(e.length-1)&&(e+="/"),e+=t.path||"",e+=i(t.query),t.hash&&(e+="#"+t.hash),e},home.addQueryToUrl=function(t,n){return t.replace(e,function(t,e,s,o){var r=s?home.parseSearch(s):{};for(var a in n)n.hasOwnProperty(a)&&(r[a]=n[a]);return e+i(r)+(o?"#"+o:"")})}}(),function(){"use strict";home.ltgtFilter=function(t){return String(t).replace(/</g,"&lt;").replace(/>/g,"&gt;")},home.jsonFilter=function(t){return String(t).replace(/[<>&\u2028\u2029]/g,function(t){switch(t){case"<":return"\\u003c";case">":return"\\u003e";case"&":return"\\u0026";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029"}return""})},home.capitalize=function(t){return t?t[0].toUpperCase()+t.substr(1):""},home.isXivaSupported=function(t){return!t.EditMode&&t.XivaUrl&&!t.isOldIE&&!t.isMSIE9},home.encodeParams=function(t){return JSON.stringify(t).replace(/"/g,"'")},home.getJPathValue=function(t,e){for(var i=t,n=e.split("."),s=0;i&&void 0!==i[n[s]];)i=i[n[s++]];return i instanceof Object?"":i},home.formatNumber=function(t,e,i){if(isNaN(t))return t;t+="",e=e||",",i=i||"&nbsp;";var n=t.lastIndexOf("."),s=[],o="",r=0,a="";for(-1!==n?o=e+t.substr(n+1):n=t.length;--n>-1;)a=t[n]+a,3===++r&&(s.push(a),a="",r=0);return a&&s.push(a),s.reverse().join(i)+o},home.deepExtend=function(t,e){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];Array.isArray(n)?(t[i]=t[i]instanceof Array?t[i]:[],home.deepExtend(t[i],n)):n instanceof Date||"object"!=typeof n||null===n?t[i]=n:(t[i]=t[i]instanceof Object?t[i]:{},home.deepExtend(t[i],n))}return t},home.rnd=function(){return String(Math.random()).substr(2)},home.randomInteger=function(t,e){var i=t+Math.random()*(e+1-t);return Math.floor(i)},home.intersectionArrays=function(t,e){return t&&e?t.filter(function(t){return-1!==e.indexOf(t)}):[]}}(),function(){var t={},e={log:function(e){e.meta=e.meta||{},e.meta.morda=home.getData("request.mordaContent"),t[e.message]||(t[e.message]=!0,setTimeout(function(){delete t[e.message];var i=this._prepareLogMessage(e);this._sendErrorMessage(i,e)}.bind(this),0))},logError:function(t,e){this._rumLogError(t,e),e=this._createError(t,e),this.log(e)},logAjaxError:function(t,e,i,n){var s;n=this._createError(t,n),t.url&&(s=home.parseUrl(t.url),n.url=s.host+s.path),n.sourceType="network","timeout"===i?n.timeout=1:e.status&&(n.status=e.status),this._rumLogAjaxError(t,e,i,n),this.log(n)},_prepareLogMessage:function(t){var e=t.message;if(e+=t.sourceType?",source_type:"+t.sourceType:"",e+=t.source?",source:"+t.source:"",e+=t.page?",page:"+t.page:"","network"===t.sourceType&&(e+=(t.timeout?",timeout:"+t.timeout:"")+(t.status?",status:"+t.status:"")+(t.url?",url:"+t.url:"")),t.meta)try{e+=",meta:"+JSON.stringify(t.meta)}catch(t){}return e},_createError:function(t,e){var i;return t=t||{},(e=e||{})instanceof Error?i=e:((i=new Error).name="blockerror",i.justCreated=!0,i.meta=e.meta),i.message=[t.message,e.message].filter(function(t){return t}).join("->"),t.sourceType&&(i.sourceType=t.sourceType),t.block&&(i.block=t.block.replace(/-/g,"_")),t.page&&(i.page=t.page),t.source&&(i.source=t.source),t.meta&&(i.meta=t.meta),t.timeout&&(i.timeout=t.timeout),i.forceStack=t.forceStack,i},_sendErrorMessage:function(t,e){var i,n="",s="blockerror"===e.name;s&&!e.forceStack||!e.stack||(i=e.justCreated?2:0,n="&trace="+encodeURIComponent(e.stack.split("\n").slice(1+i,7+i).join("->").replace(/\s+/g," ").replace(/https:\/\/([^.]+\.)?yastatic.net\/www/,"$1"))),this._awaitData().then(function(){var i=home.getData("request.Requestid"),o=home.getData("request.devInstance"),r=home.getData("request.hermione"),a=home.getData("request.blockErrorEnabled"),c=home.getData("request.clientErrorPath");a&&this._shouldReport()&&((new Image).src=(c+"?type=blockerror&showid=%reqid%&subtype=%block%&message=%message%"+n).replace("%reqid%",i).replace("%message%",encodeURIComponent(t)).replace("%block%",e.block||"unknown").replace(/\s+/g," ")),!o||s&&r||(console.error(e),e.meta&&console.log(e.meta))}.bind(this))},_awaitData:function(){return this._awaitDataPromise||(this._awaitDataPromise=new Promise(function(t){home.subscribeData(t)})),this._awaitDataPromise},_shouldReport:function(){var t=+new Date;return!this._ts||t-this._ts>1e4?(this._ts=t,this._counter=1,!0):this._counter++<10||void 0},setProject:function(t){this._checkRumErrorCounter()&&Ya.Rum.updateErrors({project:t})},restoreDefaultProject:function(){if(this._checkRumErrorCounter()){for(var t,e=Ya.Rum.getVarsList(),i=0;i<e.length&&(t=e[i].split("="))&&"-project"!==t[0];)i++;"-project"===t[0]&&t[1]&&this.setProject(t[1])}},_rumLogError:function(t,e){this._checkRumErrorCounter()&&Ya.Rum.logError(this._prepareRumOptions(t),e)},_rumLogAjaxError:function(t,e,i,n){this._checkRumErrorCounter()&&Ya.Rum.logAjaxError(this._prepareRumOptions(t),e,i,n)},_prepareRumOptions:function(t){var e={};return t.message&&(e.message=t.message),t.block&&(e.block=t.block),t.sourceType&&(e.type=t.sourceType),t.source&&(e.source=t.source),t.meta&&(e.additional=t.meta),t.url&&(e.additional=e.additional||{},e.additional.url=t.url),e},_checkRumErrorCounter:function(){return!!window.Ya&&window.Ya.Rum&&window.Ya.Rum.logError}};home.error=function(t){e.logError.bind(e)({message:t})},home.deepExtend(home.error,e)}(),"undefined"!=typeof home&&home.loadManager&&home.loadManager.trigger("js"),function(){function t(t){for(var e=[];t&&t!==document.body&&t.isConnected;){var i=t.nodeName;t!==document.body&&(t.className&&(i+="."+t.className.split(" ").slice(0,2).join(".")),t.src&&(i+="["+t.src.slice(0,50)+"]")),e.push(i),t=t.parentNode}return e.reverse().join(" ")}if("addEventListener"in document){var e=Math.random();document.addEventListener("securitypolicyviolation",function(i){var n=home.getData("csp.ratio")||0;if(!(e>n)){var s=(i.blockedURI.match(/(?:https?:)\/\/([^/]+)/)||[])[1]||"";if(-1!==s.indexOf("yandex.")||-1!==s.indexOf("yastatic.net")){var o=(i.violatedDirective.match(/([\w-]+)/)||[])[1]||"";if("child-src"===o||"frame-src"===o||"default-src"===o){var r=document.querySelectorAll("iframe"),a=Array.prototype.map.call(r,t),c=new Error("csp violation");c.block="csp",c.meta={blocked:i.blockedURI,violated:o,frames:a,from:home.getData("csp.page"),ua:navigator.userAgent},home.error.log(c)}}}})}}(),function(t){var e=setTimeout;function i(){}function n(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function s(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,n._immediateFn(function(){var i=1===t._state?e.onFulfilled:e.onRejected;if(null!==i){var n;try{n=i(t._value)}catch(t){return void r(e.promise,t)}o(e.promise,n)}else(1===t._state?o:r)(e.promise,t._value)})):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof n)return t._state=3,t._value=e,void a(t);if("function"==typeof i)return void c(i.bind(e),t)}t._state=1,t._value=e,a(t)}catch(e){r(t,e)}}function r(t,e){t._state=2,t._value=e,a(t)}function a(t){2===t._state&&0===t._deferreds.length&&n._immediateFn(function(){t._handled||n._unhandledRejectionFn(t._value)});for(var e=0,i=t._deferreds.length;e<i;e++)s(t,t._deferreds[e]);t._deferreds=null}function c(t,e){var i=!1;try{t(function(t){i||(i=!0,o(e,t))},function(t){i||(i=!0,r(e,t))})}catch(t){if(i)return;i=!0,r(e,t)}}n.prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(t,e){var n=new this.constructor(i);return s(this,new function(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}(t,e,n)),n},n.all=function(t){var e=Array.prototype.slice.call(t);return new n(function(t,i){if(0===e.length)return t([]);var n=e.length;function s(o,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var a=r.then;if("function"==typeof a)return void a.call(r,function(t){s(o,t)},i)}e[o]=r,0==--n&&t(e)}catch(t){i(t)}}for(var o=0;o<e.length;o++)s(o,e[o])})},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n(function(e){e(t)})},n.reject=function(t){return new n(function(e,i){i(t)})},n.race=function(t){return new n(function(e,i){for(var n=0,s=t.length;n<s;n++)t[n].then(e,i)})},n._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){e(t,0)},n._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},t.Promise||(t.Promise=n)}(this),function(){"use strict";var t={},e={};home.bundles=home.bundles||{},home.bundles.load=function(i,n){if(t[i])return t[i];var s=home.getData("bundles.data");if(home.getData("bundles.placed",[]).indexOf(i)>-1)return t[i]=new Promise(function(t){e[i]=t}),t[i];n=n||{};var o=home.bundles.staticURL&&home.bundles.staticURL[i];return t[i]=Promise.race([new Promise(function(t,e){setTimeout(e,n.timeout||1e4)}),Promise.all([new Promise(function(t){var e=s.root+"/"+s.page+"__"+i+"/_"+s.page+"__"+i+(s.cssSuffix||"")+".css";o&&o["css"+(s.cssSuffix||"")]&&(e=o["css"+(s.cssSuffix||"")]),home.loadCss(e,{callback:t,noFlash:!0})}),new Promise(function(t,n){var r=document.createElement("script");e[i]=t,r.onerror=function(){n(new Error("Failed to load js from bundle "+i))};var a=s.root+"/"+s.page+"__"+i+"/_"+s.page+"__"+i+"."+s.locale+(s.jsSuffix||"")+".js";o&&o["js"+(s.jsSuffix||"")]&&(a=o["js"+(s.jsSuffix||"")]),r.src=a,document.getElementsByTagName("head")[0].appendChild(r)})])]).catch(function(e){throw t[i]=null,e})},home.bundles.notify=function(i){t[i]?e[i]&&e[i]():t[i]=Promise.resolve(),t[i].then(function(){home.bundles.initBlocks()})}}(),function(t){home.loadCss=function(e,i){var n=i||{},s=function(e,i,n,s){var o,r=t.document,a=r.createElement("link");if(i)o=i;else{var c=(r.body||r.getElementsByTagName("head")[0]).childNodes;o=c[c.length-1]}var l=r.styleSheets;a.rel="stylesheet",a.href=e,a.media=s?n||"all":"only x",function t(e){if(r.body)return e();setTimeout(function(){t(e)})}(function(){o.parentNode.insertBefore(a,i?o:o.nextSibling)});var h=function(t){for(var e=a.href,i=l.length;i--;)if(l[i].href===e)return t();setTimeout(function(){h(t)})};function u(){a.addEventListener&&a.removeEventListener("load",u),s||(a.media=n||"all")}return a.addEventListener&&a.addEventListener("load",u),a.onloadcssdefined=h,h(u),a}(e,n.before,n.media,n.noFlash);n.callback&&function(t,e){var i;function n(){!i&&e&&(i=!0,e.call(t))}t.addEventListener&&t.addEventListener("load",n),t.attachEvent&&t.attachEvent("onload",n),"isApplicationInstalled"in navigator&&"onloadcssdefined"in t&&t.onloadcssdefined(n)}(s,n.callback)}}("undefined"!=typeof global?global:this),home.bundles.initBlocks=function(){$(".i-bundle-bem").each(function(){var t=$(this),e=t.data("bem"),i=!0;for(var n in e)if(e.hasOwnProperty(n)&&!(n in BEM.blocks)){i=!1;break}i&&(t.removeClass("i-bundle-bem").addClass("i-bem"),BEM.DOM.init(t))})},BEM.decl("i-inline-install",{init:function(){if(!this.params||!this.params.url)throw new Error("Inline installation requires url of extension");this.message=null,this.agreement=null,this.inited=null,this.visitParams=this.__self._constructVisitParams(this.params.metrikaParams),this.counters=this.__self._getCounters(this.params.statPath),this.requestDeferred=null,this.reqStart=null;var t=this.params.metrikaParams||{};return t.goals&&t.id&&(this.metrika=BEM.blocks["i-metrika"].add({id:t.id,triggerEvent:!0})),this.curtain=BEM.blocks["promo-curtain"].get(this.params.curtainOpts,this),this.__self._appendInlineUrlToHead(this.params.url),this.inited=!0,this},request:function(){if(this.inited||this.init(),this.requestDeferred&&"pending"===this.requestDeferred.state())return this.requestDeferred.promise();if(this.requestDeferred=$.Deferred(),this.reqStart=Date.now(),!this._checkApi())return home.stat.logPath("tech",this.counters.bad_ua),this.requestDeferred.reject().promise();try{this.trigger("request"),this._requestApi(this.params.url,this._onSuccess.bind(this),this._onFailure.bind(this)),["yes","no","bad_ua","bad_ext_url","fast_reject","install_error","error"].forEach(function(t){home.stat.logPath("show",this.counters[t])},this)}catch(t){this.requestDeferred.reject(),this.trigger("error"),"string"==typeof t&&0===t.indexOf("Invalid")?home.stat.logPath("tech",this.counters.bad_ext_url):(home.stat.logPath("tech",this.counters.error),this.__self._blockError([t&&t.message?"message:"+t.message:"",this.params.statPath?"stat:"+this.params.statPath:""].filter(Boolean).join(", ")))}return this.requestDeferred.promise()},_onSuccess:function(){this.requestDeferred.resolve(),home.stat.logPath("click",this.counters.yes),this._reachGoal("yes"),this._fireExternalCallback("yes"),this.trigger("success"),this.__self._saveToYsCookie(this.params.bannerid)},_onFailure:function(t,e){if(this.trigger("cancel"),e&&"userCancelled"!==e)return this.requestDeferred.reject(),void home.stat.logPath("tech",this.counters.install_error);this.requestDeferred.resolve(),home.stat.logPath("click",this.counters.no),this._reachGoal("no"),this._fireExternalCallback("no"),Date.now()-this.reqStart<1e3&&home.stat.logPath("tech",this.counters.fast_reject),window.home.gaCounter.trackCancel()},_fireExternalCallback:function(t){var e=this.params.callbacks||{};e[t]&&e[t]()},_checkApi:function(){},_requestApi:function(){return!1},_reachGoal:function(t){var e=this,i=this.params.metrikaParams;i&&i.goals&&i.goals[t]&&this.metrika.done(function(n){n.reachGoal(i.goals[t],e.visitParams)})}},{_constructVisitParams:function(t){if(t&&t.channel&&t.bannerid){var e={channel:{}};return e.channel[t.channel]={banner_id:t.bannerid},e}},_saveToYsCookie:function(t){t&&BEM.blocks["i-bannerid"].save(t)},_getCounters:function(t){return t?{yes:t+".yes",no:t+".no",error:t+".error",fast_reject:t+".fast_reject",bad_ua:t+".bad_ua",bad_ext_url:t+".bad_ext_url",install_error:t+".install_error"}:{}},_appendInlineUrlToHead:function(t){return $("head").append($("<link />",{rel:"chrome-webstore-item",href:t}))},_blockError:function(t){home.getData("i-inline-install.logDisabled")||home.error.logError({block:"i-inline-install",message:t})}}),$(function(){"use strict";var t=home.getData("i-bannerid.csl");BEM.decl("i-bannerid",{},{save:function(e){if(!t)throw new Error("i-bannerid: Cookie set link wasn't passed");if(!e)throw new Error("i-bannerid: Bannerid wasn't passed");var i=$(".i-bannerid"),n=home.stringf(t,e);i.length||(i=$('<iframe class="i-bannerid" name="i-bannerid" style="display:none"/>'),$(document.body).append(i)),i.attr("src")!==n&&i.attr("src",n)}})}),home.stringf=function(t){var e=Array.prototype.slice.call(arguments,1);return t.replace(/%s/g,function(){return e.shift()||""})},BEM.decl("i-metrika",{},{add:function(t){var e=(t=t||{}).id;if(!e)throw new Error("i-metrika: Counter id wasn't passed");var i=$.Deferred();try{window["yaCounter"+e]?i.resolve(window["yaCounter"+e]):(window["yaCounter"+e]=new window.Ya.Metrika(t),$(document).one("yacounter"+e+"inited",function(){i.resolve(window["yaCounter"+e])}))}catch(t){i.reject()}return i.promise()}}),BEM.DOM.decl("promo-curtain",{onSetMod:{js:function(){this.params.langs=this.params.langs||home.getData("promo-curtain.langs"),this.params.offset={top:this.params.offset&&this.params.offset.top||this._getMessageOffsetTop(this.params.gap),left:this.__self.MESSAGE_OFFSET_LEFT},$(home.view("promo-curtain__message",this.params)).appendTo(this.domElem),this.params.owner&&this.params.owner.on({request:this.show,"success cancel error":this.hide},this)}},show:function(){this.afterCurrentEvent(function(){this.setMod("active","yes")}),BEM.DOM.scope.addClass("b-page_overflow_hidden")},hide:function(){this.delMod("active"),BEM.DOM.scope.removeClass("b-page_overflow_hidden")},_getMessageOffsetTop:function(t){var e=this.__self.MESSAGE_OFFSET_TOP,i=this.__self["tr"===navigator.language?"GAP_TOP_OFFSET_COMTR":"GAP_TOP_OFFSET"][t];return i&&(e+=i),e}},{get:function(t,e){if(t&&t.theme){var i={};return e&&(i.owner=e),$(home.view("promo-curtain__layout",{mods:{theme:t.theme}})).appendTo("body").bem("promo-curtain",$.extend(t,i))}},GAP_TOP_OFFSET:{s:20,m:40,l:60},GAP_TOP_OFFSET_COMTR:{s:20,m:70,l:110},SHOW_MESSAGE_TIMEOUT:500,MESSAGE_OFFSET_TOP:335,MESSAGE_OFFSET_LEFT:175}),home.htmlFilter=function(t){var e=String(t);return e.indexOf("&")>-1&&(e=e.replace(/&/g,"&amp;")),e.indexOf("<")>-1&&(e=e.replace(/</g,"&lt;")),e.indexOf(">")>-1&&(e=e.replace(/>/g,"&gt;")),e.indexOf('"')>-1&&(e=e.replace(/"/g,"&quot;")),e},home.getBEMParams=function(t){return home.htmlFilter(JSON.stringify(t))},home.getBEMClassname=function(t,e){var i=e.mods,n=t,s=i?home.getBEMMods(t,i):"";return e.mix&&("object"==typeof e.mix?(Array.isArray(e.mix)||(e.mix=[e.mix]),n+=" "+e.mix.map(function(e){var i=e.block||t,n=e.mods;return"string"==typeof e?e:(e.elem&&(i+="__"+e.elem,n=e.elemMods),n&&(i+=" "+home.getBEMMods(i,n)),i)}).join(" ")):n+=" "+e.mix),s&&(n+=" "+s),n},home.getBEMMods=function(t,e){var i,n=[];for(i in e)e.hasOwnProperty(i)&&(e[i]||0===e[i])&&n.push(t+"_"+i+"_"+e[i]);return n.join(" ")},home.emptyAttr={},home.getAttributes=function(t){if(!t)return"";var e,i="";for(e in t)if(t.hasOwnProperty(e)){var n=t[e];(n||0===n)&&(n===home.emptyAttr?i+=" "+e:((n=n.toString()).indexOf('"')>-1&&(n=n.replace(/"/g,"&quot;")),i+=" "+e+'="'+n+'"'))}return i},BEM.DOM.decl("i-geolocation",{},{get:function(t,e){if(1===arguments.length&&(e=t,t={}),(t=$.extend({enableHighAccuracy:!0,timeout:15,cacheTime:15},t)).timeout*=1e3,t.maximumAge=1e3*t.cacheTime*60,delete t.cacheTime,"geolocation"in navigator){var i=!1,n=setTimeout(function(){i=!0,e({error:4})},t.timeout+300);navigator.geolocation.getCurrentPosition(function(t){i||(clearTimeout(n),e(t))},function(t){i||(clearTimeout(n),e({error:t.code}))},t)}else e({error:0})}}),function(){"use strict";var t={1:"denied",2:"unavailable",3:"timeout"};BEM.decl("i-geolocation",{},{_firstLocation:!0,locate:function(t){return t=t||{},this._wrapRequest(t,function(){return this._locate(t)})},_wrapRequest:function(t,e){var i;return this._promise?this._promise:(this._triggerEvent("start",t),this._promise=i=this._wrapEnd(t,e.call(this)),this._promise.always(this.changeThis(function(){this._promise=void 0})),i)},_wrapEnd:function(t,e){var i=this;return e&&e.then||(e=$.Deferred().resolve(e)),e.fail(function(e){i._triggerEvent("fail",t,e)}).always(function(){i._triggerEvent("end",t)})},_triggerEvent:function(t,e,i){var n=$.Event(t);for(var s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);return this.channel("i-geolocation").trigger(n,i),this},_locate:function(t){var e,i=this,n=$.Deferred(),s=home.getData("geo."+(t.background?"background-":"")+"counters",{});try{navigator.geolocation&&navigator.geolocation.getCurrentPosition&&(home.stat.logPath("tech",s.request),e=new Date,navigator.geolocation.getCurrentPosition(function(o){i._saveLocation(o,new Date-e,t).then(function(e){i._triggerEvent("gpsave",t,{id:e.region_id,locale:e.locale,name:e.region_name,address:e.address,address_short:e.address_short}),home.stat.logPath("tech",s.success),n.resolve()},function(t){n.reject(t)})},function(s){s.type="locate",i._saveError(s,new Date-e,t).always(function(){n.reject(s)})},{timeout:1e3*(t.timeout?t.timeout:15),maximumAge:i._firstLocation?3e5:0,enableHighAccuracy:!1}),i._firstLocation=!1)}catch(t){n.reject(t)}return n.promise()},_saveLocation:function(t,e,i){return home.localStorage.setItem("gpallowed","1"),this._location=t.coords,this._saveAjax($.extend(this._extractCoords(t.coords),{persistent:1,timing:e}),i)},_saveError:function(e,i,n){var s;return 1===e.code?home.localStorage.setItem("gpforbidden","1"):home.localStorage.setItem("gpallowed","1"),s=home.getData("geo."+(n.background?"background-":"")+"counters.error",{}),home.stat.logPath("tech",s[t[e.code]]),this._saveAjax($.extend({status:e.code,timing:i},e.data||{}))},_extractCoords:function(t){return{lon:t.longitude,lat:t.latitude,precision:t.accuracy}},_saveAjax:function(t){var e;return t.sk=home.getData("geo.sk"),t.device=0,t.laas=home.getData("geo.laas")||0,e={url:home.getData("geo.gpsaveUrl"),dataType:"json",data:t},$.ajax(e)}}),$(function(){"permissions"in navigator&&!home.getData("geo.gpauto")&&setTimeout(function(){navigator.permissions.query({name:"geolocation"}).then(function(t){"granted"===(t.state||t.status)&&BEM.blocks["i-geolocation"].locate({background:!0})},function(){})},5e3)})}(),$(function(){var t=home.getData("tech-counters"),e=window.Modernizr;t&&(home.stat.logPath("tech","tech.svg."+Number(detector.isSVGSupported())),home.stat.logPath("tech","tech.localStorage."+Number(!home.disabledLS)),e&&Object.keys(e).forEach(function(t){home.stat.logPath("tech","tech.flex."+t+"."+Number(e[t]))}))}),BEM.decl("sup-manager",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._storage=BEM.create("sup-storage"),this.supported()&&(this.params.unregister?this._unregisterSW():this.params.disableInit||(this._updateDeviceTagOnStart(),this._checkSW()))}}},supported:function(){if(void 0!==this._supported)return this._supported;var t,e,i="serviceWorker"in navigator&&"PushManager"in window&&PushSubscription.prototype.hasOwnProperty("getKey")&&"Notification"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&"fetch"in window&&"indexedDB"in window,n="Notification"in window&&"granted"===Notification.permission;try{t=!!window.top}catch(e){t=!1}try{e=t&&window.top.location.domain===location.domain}catch(t){e=!1}var s=navigator.userAgent.indexOf("Firefox/")>-1;return this._supported=i&&(n||!t||e||s),this._supported},requestPermission:function(){var t=Date.now();return new Promise(function(t,e){var i=Notification.requestPermission(function(e){t(e)});i&&i.then(t,e)}).then(function(e){return"granted"!==e&&home.stat.logPath("tech","sup.denied"),{permission:e,delay:Date.now()-t}})},getTags:function(t){return this._storage.getTags(t)},getAllTags:function(){return this._storage.getAllTags()},getPermission:function(){return Notification.permission},subscribe:function(t){var e=this;return t=this._prepareTags("add",t),this._getSubscription().then(function(i){return i?e._updateTags(t):e._subscribe(t)}).then(function(){return e._storage.changeTags(t)}).then(function(){e.trigger("updateTags",t)})},unsubscribe:function(t){return t=this._prepareTags("remove",t),this._updateTags(t).then(function(){return this._storage.changeTags(t)}.bind(this)).then(function(){this.trigger("updateTags",t)}.bind(this))},sync:function(t,e){var i=this;if(Date.now()<i.__self._getSessionParameter(i.__self.SS_SYNC_TTL_KEY+t))return this._syncPromise||Promise.resolve();var n=Date.now()+6e5;return i.__self._setSessionParameter(i.__self.SS_SYNC_TTL_KEY+t,n),this._syncPromise=fetch(this.params.supUrl+"/v2/tags/web/"+this.params.id+"/"+t).then(function(t){return t.json()}).then(function(n){if(t===n.name&&n.value&&n.value.length){var s=i._convertTag(n,e);return i._storage.clearTag(t).then(function(){i._storage.changeTags(s)}).then(function(){i.trigger("updateTags",s)})}return i._storage.clearTag(t)}).catch(function(t){home.error.logError({block:"sup-manager"},t)}),this._syncPromise},_subscribe:function(t){return Promise.all([this._registerSW().then(this._getActiveRegistration.bind(this)),this._getVapid()]).then(function(t){var e=t[0],i=t[1];return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:i})}).then(function(e){this._sendRegistration(e,t)}.bind(this))},_getVapid:function(){return fetch(this.params.supUrl+"/registrations/web/vapid").then(function(t){return t.text()}).then(function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/")+"=".repeat((4-t.length%4)%4),t=atob(t),new Uint8Array(t.length).map(function(e,i){return t.charCodeAt(i)})})},_registerSW:function(){var t=this;return navigator.serviceWorker.register("/portal/service-worker/white/_notifications.js",{scope:this.__self.SCOPE_WORKER}).then(function(e){return home.localStorage.setItem(t.__self.LS_SW_KEY,(new Date).getTime()),e},function(t){throw home.stat.logPath("tech","sup.register_error"),t})},_unregisterSW:function(){navigator.serviceWorker.getRegistration(this.__self.SCOPE_WORKER).then(function(t){if(t)return t.unregister()}).catch(function(t){home.error.logError({block:"sup-manager"},t)})},_getActiveSW:function(){return navigator.serviceWorker.getRegistration(this.__self.SCOPE_WORKER)},_getSubscription:function(){return this._getActiveSW().then(function(t){if(t)return t.pushManager.getSubscription()})},_updateDeviceTagOnStart:function(){var t=this;this._getSubscription().then(function(e){if(e)return t._storage.getParams(["subscriptionEndpoint","userAgent"]).then(function(i){var n=i[0],s=i[1];if(n!==e.endpoint||s!==navigator.userAgent)return t._sendRegistration(e)})})},_sendRegistration:function(t,e){var i=this.params.supUrl+"/registrations/web",n={id:this.params.id,webDomain:location.hostname,deviceType:this.params.deviceType,subscription:t,tags:e};return this._post(i,n).then(this._storage.setParams.bind(this._storage,{subscriptionEndpoint:t.endpoint,userAgent:navigator.userAgent}))},_checkSW:function(){var t=home.localStorage.getItem(this.__self.LS_SW_KEY);t&&this._getActiveSW().then(function(e){e||(home.stat.logPath("tech","sup.sw_missing(days="+Math.floor((new Date-t)/864e5)+")"),home.localStorage.removeItem(this.__self.LS_SW_KEY))}.bind(this))},_post:function(t,e){return fetch(t,{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}).then(function(t){return t.ok&&t.status>=200&&t.status<300?t:Promise.reject(new Error(t.status+": "+t.statusText))})},_updateTags:function(t){var e=this.params.supUrl+"/v2/tags/"+this.params.id+"/"+this.params.id;return this._post(e,t)},_getActiveRegistration:function(){return this._getActiveSW().then(function(t){return t.active?t:new Promise(function(e){(t.installing||t.waiting).addEventListener("statechange",function i(){t.active&&(this.removeEventListener("statechange",i),e(t))})})})},_prepareTags:function(t,e){return e.map(function(e){return{name:e.name,value:e.value,expiryDate:e.expiryDate,op:t}})},_convertTag:function(t,e){var i=t.name;return t.value.map(function(t){return{name:i,value:t,expiryDate:e,op:"add"}})}},{SCOPE_WORKER:"/notifications/",LS_SW_KEY:"home:notifications-sw",SS_SYNC_TTL_KEY:"home:sync-ttl-tag_",_instance:null,getInstance:function(){return this._instance||(this._instance=BEM.create({block:this.getName()},home.getData("sup-manager.params"))),this._instance},_setSessionParameter:function(t,e){try{window.sessionStorage.setItem(t,e)}catch(t){}},_getSessionParameter:function(t){try{return window.sessionStorage.getItem(t)}catch(t){return null}}}),function(){function t(t){return function(){var e=this,i=arguments;return new Promise(function(n,s){var o=t.apply(e,i);o.onsuccess=function(){n(this.result)},o.onerror=function(){s(this.error)}})}}var e=t(function(t,e){var i=indexedDB.open(t,e);return i.onupgradeneeded=function(){var t=this.result;t.createObjectStore("tags",{keyPath:["name","value"]}).createIndex("expiryDate","expiryDate"),t.createObjectStore("params")},i}),i=function(t,e,i){return t.transaction(e,i).objectStore(e)},n=t(function(t,e){return t.get(e)}),s=t(function(t){return t.getAll()}),o=t(function(t,e,i){return t.put(e,i)}),r=t(function(t,e){return t.delete(e)});BEM.decl("sup-storage",{_openStorage:function(){return this._storage||(this._storage=e(this.__self.STORAGE_NAME,this.__self.STORAGE_VERSION).then(function(t){return t.onclose=function(){delete this._storage}.bind(this),t}.bind(this)).catch(function(t){throw delete this._storage,t}.bind(this))),this._storage},getParams:function(t){return this._openStorage().then(function(e){var s=i(e,"params");return Promise.all([].concat(t).map(function(t){return n(s,t)}))})},setParams:function(t){return this._openStorage().then(function(e){var n=i(e,"params","readwrite");return Promise.all(Object.keys(t).map(function(e){var i=t[e];return o(n,i,e)}))})},changeTags:function(t){return this._openStorage().then(function(e){var n=i(e,"tags","readwrite");return Promise.all(t.map(function(t){return"remove"===t.op?r(n,[t.name,t.value]):o(n,{name:t.name,value:t.value,expiryDate:new Date(t.expiryDate)})}))})},getTags:function(t){return this._openStorage().then(function(e){var s=i(e,"tags");return Promise.all(t.map(function(t){return n(s,[t.name,t.value])}))})},getAllTags:function(){return this._openStorage().then(function(t){var e=i(t,"tags");return s(e)})},clearTag:function(t){return this.getAllTags().then(function(e){return this.changeTags(function(t,e){return t.filter(function(t){return t.name===e}).map(function(t){return{name:t.name,value:t.value,expiryDate:t.expiryDate,op:"remove"}})}(e,t))}.bind(this))}},{STORAGE_NAME:"notifications",STORAGE_VERSION:1})}(),$(function(){var t=home.getData("media-event-promo.data");if(t&&t.type){var e=t.type,i=".media-event";if("media"!==e&&(i=".media-grid"),$(i).length)if("CSS"in window&&CSS.supports&&(CSS.supports("position","sticky")||CSS.supports("position","-webkit-sticky"))){var n=$(".media-grid").bem("media-grid");if(function(){var t=$(i).offset().top,e=$(window).scrollTop(),n=window.innerHeight;return a()||e+n<t+30}()){var s=$(home.view("media-event-promo__layout",{mods:{type:e,dark:t.darkSkinEnabled?"yes":""},title:t.title,width:t.width,height:t.height,logo:t.logo}));s.insertAfter(".gap_side_bottom").on("click",function(){a()&&n.delMod("collapsed"),home.stat.logPath("click","media-event.promo."+e),"hockey"===e?BEM.blocks.hockey.highlight():$("html,body").stop().animate({scrollTop:$(i).offset().top},"slow")}),home.stat.logPath("show","media-event.promo."+e);var o=$(i).offset().top,r=!0;BEM.channel("i-scroll-event").on("scroll",function(){var t=window.innerHeight,e=$(window).scrollTop()+t*(r?.5:.66)<o;a()||e===r||(r=e,s.toggleClass("media-event-promo__fade-out",!e))})}}}function a(){return n.hasMod("collapsed","yes")}}),function(){var t;t=function(){var t=document,e=window,i={},n=function(){};n.prototype.addEventListener=function(t,e){this._listeners||(this._listeners={}),t in this._listeners||(this._listeners[t]=[]);var n=this._listeners[t];-1===i.arrIndexOf(n,e)&&n.push(e)},n.prototype.removeEventListener=function(t,e){if(this._listeners&&t in this._listeners){var n=this._listeners[t],s=i.arrIndexOf(n,e);-1===s||(n.length>1?this._listeners[t]=n.slice(0,s).concat(n.slice(s+1)):delete this._listeners[t])}},n.prototype.dispatchEvent=function(t){var e=t.type,i=Array.prototype.slice.call(arguments,0);if(this["on"+e]&&this["on"+e].apply(this,i),this._listeners&&e in this._listeners)for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].apply(this,i)};var s=function(t,e){if(this.type=t,void 0!==e)for(var i in e)e.hasOwnProperty(i)&&(this[i]=e[i])};s.prototype.toString=function(){var t=[];for(var e in this)if(this.hasOwnProperty(e)){var i=this[e];"function"==typeof i&&(i="[function]"),t.push(e+"="+i)}return"SimpleEvent("+t.join(", ")+")"};var o=function(t){this._events=t||[],this._listeners={}};o.prototype.emit=function(t){if(this._verifyType(t),!this._nuked){var e=Array.prototype.slice.call(arguments,1);if(this["on"+t]&&this["on"+t].apply(this,e),t in this._listeners)for(var i=0;i<this._listeners[t].length;i++)this._listeners[t][i].apply(this,e)}},o.prototype.on=function(t,e){this._verifyType(t),this._nuked||(t in this._listeners||(this._listeners[t]=[]),this._listeners[t].push(e))},o.prototype._verifyType=function(t){-1===i.arrIndexOf(this._events,t)&&i.log("Event "+JSON.stringify(t)+" not listed "+JSON.stringify(this._events)+" in "+this)},o.prototype.nuke=function(){this._nuked=!0;for(var t=0;t<this._events.length;t++)delete this[this._events[t]];this._listeners={}};i.random_string=function(t,e){e=e||"abcdefghijklmnopqrstuvwxyz0123456789_".length;var i,n=[];for(i=0;i<t;i++)n.push("abcdefghijklmnopqrstuvwxyz0123456789_".substr(Math.floor(Math.random()*e),1));return n.join("")},i.random_number=function(t){return Math.floor(Math.random()*t)},i.random_number_string=function(t){var e=(""+(t-1)).length;return(Array(e+1).join("0")+i.random_number(t)).slice(-e)},i.getOrigin=function(t){return(t+="/").split("/").slice(0,3).join("/")},i.isSameOriginUrl=function(t,i){return i||(i=e.location.href),t.split("/").slice(0,3).join("/")===i.split("/").slice(0,3).join("/")},i.getParentDomain=function(t){return/^[0-9.]*$/.test(t)?t:/^\[/.test(t)?t:/[.]/.test(t)?t.split(".").slice(1).join("."):t},i.objectExtend=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t};i.polluteGlobalNamespace=function(){"_jp"in e||(e._jp={})},i.closeFrame=function(t,e){return"c"+JSON.stringify([t,e])},i.userSetCode=function(t){return 1e3===t||t>=3e3&&t<=4999},i.countRTO=function(t){return t>100?3*t:t+200},i.log=function(){e.console&&console.log&&console.log.apply&&console.log.apply(console,arguments)},i.bind=function(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}},i.flatUrl=function(t){return-1===t.indexOf("?")&&-1===t.indexOf("#")},i.amendUrl=function(e){var n=t.location;if(!e)throw new Error("Wrong url for SockJS");if(!i.flatUrl(e))throw new Error("Only basic urls are supported in SockJS");return 0===e.indexOf("//")&&(e=n.protocol+e),0===e.indexOf("/")&&(e=n.protocol+"//"+n.host+e),e=e.replace(/[/]+$/,"")},i.arrIndexOf=function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},i.arrSkip=function(t,e){var n=i.arrIndexOf(t,e);return-1===n?t.slice():t.slice(0,n).concat(t.slice(n+1))},i.isArray=Array.isArray||function(t){return{}.toString.call(t).indexOf("Array")>=0},i.delay=function(t,e){return"function"==typeof t&&(e=t,t=0),setTimeout(e,t)};var r,a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\0":"\\u0000","":"\\u0001","":"\\u0002","":"\\u0003","":"\\u0004","":"\\u0005","":"\\u0006","":"\\u0007","\b":"\\b","\t":"\\t","\n":"\\n","\v":"\\u000b","\f":"\\f","\r":"\\r","":"\\u000e","":"\\u000f","":"\\u0010","":"\\u0011","":"\\u0012","":"\\u0013","":"\\u0014","":"\\u0015","":"\\u0016","":"\\u0017","":"\\u0018","":"\\u0019","":"\\u001a","":"\\u001b","":"\\u001c","":"\\u001d","":"\\u001e","":"\\u001f",'"':'\\"',"\\":"\\\\","":"\\u007f","":"\\u0080","":"\\u0081","":"\\u0082","":"\\u0083","":"\\u0084","":"\\u0085","":"\\u0086","":"\\u0087","":"\\u0088","":"\\u0089","":"\\u008a","":"\\u008b","":"\\u008c","":"\\u008d","":"\\u008e","":"\\u008f","":"\\u0090","":"\\u0091","":"\\u0092","":"\\u0093","":"\\u0094","":"\\u0095","":"\\u0096","":"\\u0097","":"\\u0098","":"\\u0099","":"\\u009a","":"\\u009b","":"\\u009c","":"\\u009d","":"\\u009e","":"\\u009f","":"\\u00ad","":"\\u0600","":"\\u0601","":"\\u0602","":"\\u0603","":"\\u0604","":"\\u070f","":"\\u17b4","":"\\u17b5","":"\\u200c","":"\\u200d","":"\\u200e","":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","":"\\u202a","":"\\u202b","":"\\u202c","":"\\u202d","":"\\u202e","":"\\u202f","":"\\u2060","":"\\u2061","":"\\u2062","":"\\u2063","":"\\u2064","":"\\u2065","":"\\u2066","":"\\u2067","":"\\u2068","":"\\u2069","":"\\u206a","":"\\u206b","":"\\u206c","":"\\u206d","":"\\u206e","":"\\u206f","\ufeff":"\\ufeff","":"\\ufff0","":"\\ufff1","":"\\ufff2","":"\\ufff3","":"\\ufff4","":"\\ufff5","":"\\ufff6","":"\\ufff7","":"\\ufff8","":"\\ufff9","":"\\ufffa","":"\\ufffb","":"\\ufffc","":"\\ufffd","":"\\ufffe","":"\\uffff"},l=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,h=JSON&&JSON.stringify||function(t){return a.lastIndex=0,a.test(t)&&(t=t.replace(a,function(t){return c[t]})),'"'+t+'"'};i.quote=function(t){var e=h(t);return l.lastIndex=0,l.test(e)?(r||(r=function(t){var e,i={},n=[];for(e=0;e<65536;e++)n.push(String.fromCharCode(e));return t.lastIndex=0,n.join("").replace(t,function(t){return i[t]="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,i}(l)),e.replace(l,function(t){return r[t]})):e};var u=["websocket","xdr-streaming","xhr-streaming","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"];i.probeProtocols=function(){for(var t={},e=0;e<u.length;e++){var i=u[e];t[i]=v[i]&&v[i].enabled()}return t},i.detectProtocols=function(t,e,i){var n={},s=[];e||(e=u);for(var o=0;o<e.length;o++){var r=e[o];n[r]=t[r]}var a=function(t){var e=t.shift();n[e]?s.push(e):t.length>0&&a(t)};return!1!==i.websocket&&a(["websocket"]),n["xhr-streaming"]&&!i.null_origin?s.push("xhr-streaming"):!n["xdr-streaming"]||i.cookie_needed||i.null_origin?a(["iframe-eventsource","iframe-htmlfile"]):s.push("xdr-streaming"),n["xhr-polling"]&&!i.null_origin?s.push("xhr-polling"):!n["xdr-polling"]||i.cookie_needed||i.null_origin?a(["iframe-xhr-polling","jsonp-polling"]):s.push("xdr-polling"),s};var d="_sockjs_global";i.createHook=function(){var t="a"+i.random_string(8);if(!(d in e)){var n={};e[d]=function(t){return t in n||(n[t]={id:t,del:function(){delete n[t]}}),n[t]}}return e[d](t)},i.attachMessage=function(t){i.attachEvent("message",t)},i.attachEvent=function(i,n){void 0!==e.addEventListener?e.addEventListener(i,n,!1):(t.attachEvent("on"+i,n),e.attachEvent("on"+i,n))},i.detachMessage=function(t){i.detachEvent("message",t)},i.detachEvent=function(i,n){void 0!==e.addEventListener?e.removeEventListener(i,n,!1):(t.detachEvent("on"+i,n),e.detachEvent("on"+i,n))};var m={},p=!1,f=function(){for(var t in m)m[t](),delete m[t]};i.attachEvent("unload",function(){p||(p=!0,f())}),i.unload_add=function(t){var e=i.random_string(8);return m[e]=t,p&&i.delay(f),e},i.unload_del=function(t){t in m&&delete m[t]},i.createIframe=function(e,n){var s,o,r=t.createElement("iframe"),a=function(){clearTimeout(s);try{r.onload=null}catch(t){}r.onerror=null},c=function(){r&&(a(),setTimeout(function(){r&&r.parentNode.removeChild(r),r=null},0),i.unload_del(o))},l=function(t){r&&(c(),n(t))};return r.src=e,r.style.display="none",r.style.position="absolute",r.onerror=function(){l("onerror")},r.onload=function(){clearTimeout(s),s=setTimeout(function(){l("onload timeout")},2e3)},t.body.appendChild(r),s=setTimeout(function(){l("timeout")},15e3),o=i.unload_add(c),{post:function(t,e){try{r&&r.contentWindow&&r.contentWindow.postMessage(t,e)}catch(t){}},cleanup:c,loaded:a}},i.createHtmlfile=function(t,n){var s,o,r,a=new ActiveXObject("htmlfile"),c=function(){clearTimeout(s)},l=function(){a&&(c(),i.unload_del(o),r.parentNode.removeChild(r),r=a=null,CollectGarbage())};a.open(),a.write('<html><script>document.domain="'+document.domain+'";<\/script></html>'),a.close(),a.parentWindow._jp=e._jp;var h=a.createElement("div");return a.body.appendChild(h),r=a.createElement("iframe"),h.appendChild(r),r.src=t,s=setTimeout(function(){var t;t="timeout",a&&(l(),n(t))},15e3),o=i.unload_add(l),{post:function(t,e){try{r&&r.contentWindow&&r.contentWindow.postMessage(t,e)}catch(t){}},cleanup:l,loaded:c}};var _=function(){};(_.prototype=new o(["chunk","finish"]))._start=function(t,n,s,o){var r=this;try{r.xhr=new XMLHttpRequest}catch(t){}if(!r.xhr)try{r.xhr=new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}(e.ActiveXObject||e.XDomainRequest)&&(n+=(-1===n.indexOf("?")?"?":"&")+"t="+ +new Date),r.unload_ref=i.unload_add(function(){r._cleanup(!0)});try{r.xhr.open(t,n,!0)}catch(t){return r.emit("finish",0,""),void r._cleanup()}if(o&&o.no_credentials||(r.xhr.withCredentials="true"),o&&o.headers)for(var a in o.headers)r.xhr.setRequestHeader(a,o.headers[a]);r.xhr.onreadystatechange=function(){if(r.xhr){var t=r.xhr;switch(t.readyState){case 3:try{var e=t.status,i=t.responseText}catch(t){}1223===e&&(e=204),i&&i.length>0&&r.emit("chunk",e,i);break;case 4:1223===(e=t.status)&&(e=204),r.emit("finish",e,t.responseText),r._cleanup(!1)}}},r.xhr.send(s)},_.prototype._cleanup=function(t){if(this.xhr){if(i.unload_del(this.unload_ref),this.xhr.onreadystatechange=function(){},t)try{this.xhr.abort()}catch(t){}this.unload_ref=this.xhr=null}},_.prototype.close=function(){this.nuke(),this._cleanup(!0)},(i.XHRCorsObject=function(){var t=this,e=arguments;i.delay(function(){t._start.apply(t,e)})}).prototype=new _,(i.XHRLocalObject=function(t,e,n){var s=this;i.delay(function(){s._start(t,e,n,{no_credentials:!0})})}).prototype=new _;var g=i.XDRObject=function(t,e,n){var s=this;i.delay(function(){s._start(t,e,n)})};g.prototype=new o(["chunk","finish"]),g.prototype._start=function(t,e,n){var s=this,o=new XDomainRequest;e+=(-1===e.indexOf("?")?"?":"&")+"t="+ +new Date;var r=o.ontimeout=o.onerror=function(){s.emit("finish",0,""),s._cleanup(!1)};o.onprogress=function(){s.emit("chunk",200,o.responseText)},o.onload=function(){s.emit("finish",200,o.responseText),s._cleanup(!1)},s.xdr=o,s.unload_ref=i.unload_add(function(){s._cleanup(!0)});try{s.xdr.open(t,e),s.xdr.send(n)}catch(t){r()}},g.prototype._cleanup=function(t){if(this.xdr){if(i.unload_del(this.unload_ref),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,t)try{this.xdr.abort()}catch(t){}this.unload_ref=this.xdr=null}},g.prototype.close=function(){this.nuke(),this._cleanup(!0)},i.isXHRCorsCapable=function(){return e.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?1:e.XDomainRequest&&t.domain?2:B.enabled()?3:4};var v=function(t,n,s){if(this===e)return new v(t,n,s);var o,r=this;r._options={devel:!1,debug:!1,protocols_whitelist:[],info:void 0,rtt:void 0},s&&i.objectExtend(r._options,s),r._base_url=i.amendUrl(t),r._server=r._options.server||i.random_number_string(1e3),r._options.protocols_whitelist&&r._options.protocols_whitelist.length?o=r._options.protocols_whitelist:(o="string"==typeof n&&n.length>0?[n]:i.isArray(n)?n:null)&&r._debug('Deprecated API: Use "protocols_whitelist" option instead of supplying protocol list as a second parameter to SockJS constructor.'),r._protocols=[],r.protocol=null,r.readyState=v.CONNECTING,r._ir=L(r._base_url),r._ir.onfinish=function(t,e){r._ir=null,t?(r._options.info&&(t=i.objectExtend(t,r._options.info)),r._options.rtt&&(e=r._options.rtt),r._applyInfo(t,e,o),r._didClose()):r._didClose(1002,"Can't connect to server",!0)}};v.prototype=new n,v.version="0.3.4",v.CONNECTING=0,v.OPEN=1,v.CLOSING=2,v.CLOSED=3,v.prototype._debug=function(){this._options.debug&&i.log.apply(i,arguments)},v.prototype._dispatchOpen=function(){this.readyState===v.CONNECTING?(this._transport_tref&&(clearTimeout(this._transport_tref),this._transport_tref=null),this.readyState=v.OPEN,this.dispatchEvent(new s("open"))):this._didClose(1006,"Server lost session")},v.prototype._dispatchMessage=function(t){this.readyState===v.OPEN&&this.dispatchEvent(new s("message",{data:t}))},v.prototype._dispatchHeartbeat=function(t){this.readyState===v.OPEN&&this.dispatchEvent(new s("heartbeat",{}))},v.prototype._didClose=function(t,e,n){var o=this;if(o.readyState!==v.CONNECTING&&o.readyState!==v.OPEN&&o.readyState!==v.CLOSING)throw new Error("INVALID_STATE_ERR");o._ir&&(o._ir.nuke(),o._ir=null),o._transport&&(o._transport.doCleanup(),o._transport=null);var r=new s("close",{code:t,reason:e,wasClean:i.userSetCode(t)});if(!i.userSetCode(t)&&o.readyState===v.CONNECTING&&!n){if(o._try_next_protocol(r))return;r=new s("close",{code:2e3,reason:"All transports failed",wasClean:!1,last_event:r})}o.readyState=v.CLOSED,i.delay(function(){o.dispatchEvent(r)})},v.prototype._didMessage=function(t){switch(t.slice(0,1)){case"o":this._dispatchOpen();break;case"a":for(var e=JSON.parse(t.slice(1)||"[]"),i=0;i<e.length;i++)this._dispatchMessage(e[i]);break;case"m":e=JSON.parse(t.slice(1)||"null");this._dispatchMessage(e);break;case"c":e=JSON.parse(t.slice(1)||"[]");this._didClose(e[0],e[1]);break;case"h":this._dispatchHeartbeat()}},v.prototype._try_next_protocol=function(e){var n=this;for(n.protocol&&(n._debug("Closed transport:",n.protocol,""+e),n.protocol=null),n._transport_tref&&(clearTimeout(n._transport_tref),n._transport_tref=null);;){var s=n.protocol=n._protocols.shift();if(!s)return!1;if(v[s]&&!0===v[s].need_body&&(!t.body||void 0!==t.readyState&&"complete"!==t.readyState))return n._protocols.unshift(s),n.protocol="waiting-for-load",i.attachEvent("load",function(){n._try_next_protocol()}),!0;if(v[s]&&v[s].enabled(n._options)){var o=v[s].roundTrips||1,r=(n._options.rto||0)*o||5e3;n._transport_tref=i.delay(r,function(){n.readyState===v.CONNECTING&&n._didClose(2007,"Transport timeouted")});var a=i.random_string(8),c=n._base_url+"/"+n._server+"/"+a;return n._debug("Opening transport:",s," url:"+c," RTO:"+n._options.rto),n._transport=new v[s](n,c,n._base_url),!0}n._debug("Skipping transport:",s)}},v.prototype.close=function(t,e){if(t&&!i.userSetCode(t))throw new Error("INVALID_ACCESS_ERR");return(this.readyState===v.CONNECTING||this.readyState===v.OPEN)&&(this.readyState=v.CLOSING,this._didClose(t||1e3,e||"Normal closure"),!0)},v.prototype.send=function(t){if(this.readyState===v.CONNECTING)throw new Error("INVALID_STATE_ERR");return this.readyState===v.OPEN&&this._transport.doSend(i.quote(""+t)),!0},v.prototype._applyInfo=function(e,n,s){this._options.info=e,this._options.rtt=n,this._options.rto=i.countRTO(n),this._options.info.null_origin=!t.domain;var o=i.probeProtocols();this._protocols=i.detectProtocols(o,s,e)};var b=v.websocket=function(t,n){var s=this,o=n+"/websocket";o="https"===o.slice(0,5)?"wss"+o.slice(5):"ws"+o.slice(4),s.ri=t,s.url=o;var r=e.WebSocket||e.MozWebSocket;s.ws=new r(s.url),s.ws.onmessage=function(t){s.ri._didMessage(t.data)},s.unload_ref=i.unload_add(function(){s.ws.close()}),s.ws.onclose=function(){s.ri._didMessage(i.closeFrame(1006,"WebSocket connection broken"))}};b.prototype.doSend=function(t){this.ws.send("["+t+"]")},b.prototype.doCleanup=function(){var t=this.ws;t&&(t.onmessage=t.onclose=null,t.close(),i.unload_del(this.unload_ref),this.unload_ref=this.ri=this.ws=null)},b.enabled=function(){return!(!e.WebSocket&&!e.MozWebSocket)},b.roundTrips=2;var y=function(){};y.prototype.send_constructor=function(t){this.send_buffer=[],this.sender=t},y.prototype.doSend=function(t){this.send_buffer.push(t),this.send_stop||this.send_schedule()},y.prototype.send_schedule_wait=function(){var t,e=this;e.send_stop=function(){e.send_stop=null,clearTimeout(t)},t=i.delay(25,function(){e.send_stop=null,e.send_schedule()})},y.prototype.send_schedule=function(){var t=this;if(t.send_buffer.length>0){var e="["+t.send_buffer.join(",")+"]";t.send_stop=t.sender(t.trans_url,e,function(e,i){t.send_stop=null,!1===e?t.ri._didClose(1006,"Sending error "+i):t.send_schedule_wait()}),t.send_buffer=[]}},y.prototype.send_destructor=function(){this._send_stop&&this._send_stop(),this._send_stop=null};var w=function(e,n,s){if(!("_send_form"in this)){var o=this._send_form=t.createElement("form");(a=this._send_area=t.createElement("textarea")).name="d",o.style.display="none",o.style.position="absolute",o.method="POST",o.enctype="application/x-www-form-urlencoded",o.acceptCharset="UTF-8",o.appendChild(a),t.body.appendChild(o)}o=this._send_form;var r,a=this._send_area,c="a"+i.random_string(8);o.target=c,o.action=e+"/jsonp_send?i="+c;try{r=t.createElement('<iframe name="'+c+'">')}catch(e){(r=t.createElement("iframe")).name=c}r.id=c,o.appendChild(r),r.style.display="none";try{a.value=n}catch(t){i.log("Your browser is seriously broken. Go home! "+t.message)}o.submit();var l=function(t){r.onerror&&(r.onreadystatechange=r.onerror=r.onload=null,i.delay(500,function(){r.parentNode.removeChild(r),r=null}),a.value="",s(!0))};return r.onerror=r.onload=l,r.onreadystatechange=function(t){"complete"==r.readyState&&l()},l},k=function(e,n){var s,o,r=t.createElement("script"),a=function(t){o&&(o.parentNode.removeChild(o),o=null),r&&(clearTimeout(s),r.parentNode.removeChild(r),r.onreadystatechange=r.onerror=r.onload=r.onclick=null,r=null,n(t),n=null)},c=!1,l=null;if(r.id="a"+i.random_string(8),r.src=e,r.type="text/javascript",r.charset="UTF-8",r.onerror=function(t){l||(l=setTimeout(function(){c||a(i.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))},1e3))},r.onload=function(t){a(i.closeFrame(1006,"JSONP script loaded abnormally (onload)"))},r.onreadystatechange=function(t){if(/loaded|closed/.test(r.readyState)){if(r&&r.htmlFor&&r.onclick){c=!0;try{r.onclick()}catch(t){}}r&&a(i.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}},void 0===r.async&&t.attachEvent)if(/opera/i.test(navigator.userAgent))(o=t.createElement("script")).text="try{var a = document.getElementById('"+r.id+"'); if(a)a.onerror();}catch(x){};",r.async=o.async=!1;else{try{r.htmlFor=r.id,r.event="onclick"}catch(t){}r.async=!0}void 0!==r.async&&(r.async=!0),s=setTimeout(function(){a(i.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35e3);var h=t.getElementsByTagName("head")[0];return h.insertBefore(r,h.firstChild),o&&h.insertBefore(o,h.firstChild),a},E=v["jsonp-polling"]=function(t,e){i.polluteGlobalNamespace();this.ri=t,this.trans_url=e,this.send_constructor(w),this._schedule_recv()};E.prototype=new y,E.prototype._schedule_recv=function(){var t=this;t._recv_stop=M(t.trans_url+"/jsonp",k,function(e){t._recv_stop=null,e&&(t._is_closing||t.ri._didMessage(e)),t._is_closing||t._schedule_recv()})},E.enabled=function(){return!0},E.need_body=!0,E.prototype.doCleanup=function(){this._is_closing=!0,this._recv_stop&&this._recv_stop(),this.ri=this._recv_stop=null,this.send_destructor()};var M=function(t,n,s){var o="a"+i.random_string(6),r=0,a=n(t+"?c="+escape("_jp."+o),function(t){switch(r){case 0:delete e._jp[o],s(t);break;case 1:s(t),r=2;break;case 2:delete e._jp[o]}});e._jp[o]=a;return function(){e._jp[o]&&(r=1,e._jp[o](i.closeFrame(1e3,"JSONP user aborted read")))}},x=function(){};(x.prototype=new y).run=function(t,e,i,n,s){this.ri=t,this.trans_url=e,this.send_constructor(function(t){return function(e,i,n){return new t("POST",e+"/xhr_send",i).onfinish=function(t,e){n(200===t||204===t,"http status "+t)},function(t){n(!1,t)}}}(s)),this.poll=new H(t,n,e+i,s)},x.prototype.doCleanup=function(){this.poll&&(this.poll.abort(),this.poll=null)};var T=v["xhr-streaming"]=function(t,e){this.run(t,e,"/xhr_streaming",V,i.XHRCorsObject)};T.prototype=new x,T.enabled=function(){return e.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&!/opera/i.test(navigator.userAgent)},T.roundTrips=2,T.need_body=!0;var S=v["xdr-streaming"]=function(t,e){this.run(t,e,"/xhr_streaming",V,i.XDRObject)};S.prototype=new x,S.enabled=function(){return!!e.XDomainRequest},S.roundTrips=2;var C=v["xhr-polling"]=function(t,e){this.run(t,e,"/xhr",V,i.XHRCorsObject)};C.prototype=new x,C.enabled=T.enabled,C.roundTrips=2;var I=v["xdr-polling"]=function(t,e){this.run(t,e,"/xhr",V,i.XDRObject)};I.prototype=new x,I.enabled=S.enabled,I.roundTrips=2;var P,B=function(){};B.prototype.i_constructor=function(t,e,n){var s=this;s.ri=t,s.origin=i.getOrigin(n),s.base_url=n,s.trans_url=e;var o=n+"/iframe.html";s.ri._options.devel&&(o+="?t="+ +new Date),s.window_id=i.random_string(8),o+="#"+s.window_id,s.iframeObj=i.createIframe(o,function(t){s.ri._didClose(1006,"Unable to load an iframe ("+t+")")}),s.onmessage_cb=i.bind(s.onmessage,s),i.attachMessage(s.onmessage_cb)},B.prototype.doCleanup=function(){if(this.iframeObj){i.detachMessage(this.onmessage_cb);try{this.iframeObj.iframe.contentWindow&&this.postMessage("c")}catch(t){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessage_cb=this.iframeObj=null}},B.prototype.onmessage=function(t){if(t.origin===this.origin){var e=t.data.slice(0,8),i=t.data.slice(8,9),n=t.data.slice(9);if(e===this.window_id)switch(i){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([v.version,this.protocol,this.trans_url,this.base_url]));break;case"t":this.ri._didMessage(n)}}},B.prototype.postMessage=function(t,e){this.iframeObj.post(this.window_id+t+(e||""),this.origin)},B.prototype.doSend=function(t){this.postMessage("m",t)},B.enabled=function(){var t=navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Konqueror");return("function"==typeof e.postMessage||"object"==typeof e.postMessage)&&!t};var D=function(t,n){parent!==e?parent.postMessage(P+t+(n||""),"*"):i.log("Can't postMessage, no parent window.",t,n)},O=function(){};O.prototype._didClose=function(t,e){D("t",i.closeFrame(t,e))},O.prototype._didMessage=function(t){D("t",t)},O.prototype._doSend=function(t){this._transport.doSend(t)},O.prototype._doCleanup=function(){this._transport.doCleanup()},i.parent_origin=void 0,v.bootstrap_iframe=function(){var n;P=t.location.hash.slice(1);i.attachMessage(function(t){if(t.source===parent&&(void 0===i.parent_origin&&(i.parent_origin=t.origin),t.origin===i.parent_origin)){var s=t.data.slice(0,8),o=t.data.slice(8,9),r=t.data.slice(9);if(s===P)switch(o){case"s":var a=JSON.parse(r),c=a[0],l=a[1],h=a[2],u=a[3];if(c!==v.version&&i.log('Incompatibile SockJS! Main site uses: "'+c+'", the iframe: "'+v.version+'".'),!i.flatUrl(h)||!i.flatUrl(u))return void i.log("Only basic urls are supported in SockJS");if(!i.isSameOriginUrl(h)||!i.isSameOriginUrl(u))return void i.log("Can't connect to different domain from within an iframe. ("+JSON.stringify([e.location.href,h,u])+")");(n=new O)._transport=new O[l](n,h,u);break;case"m":n._doSend(r);break;case"c":n&&n._doCleanup(),n=null}}}),D("s")};var A=function(t,e){var n=this;i.delay(function(){n.doXhr(t,e)})};(A.prototype=new o(["finish"])).doXhr=function(t,e){var n=this,s=(new Date).getTime(),o=new e("GET",t+"/info"),r=i.delay(8e3,function(){o.ontimeout()});o.onfinish=function(t,e){if(clearTimeout(r),r=null,200===t){var i=(new Date).getTime()-s,o=JSON.parse(e);"object"!=typeof o&&(o={}),n.emit("finish",o,i)}else n.emit("finish")},o.ontimeout=function(){o.close(),n.emit("finish")}};var R=function(e){var n=this,s=function(){var t=new B;t.protocol="w-iframe-info-receiver";var i=function(e){if("string"==typeof e&&"m"===e.substr(0,1)){var i=JSON.parse(e.substr(1)),s=i[0],o=i[1];n.emit("finish",s,o)}else n.emit("finish");t.doCleanup(),t=null},s={_options:{},_didClose:i,_didMessage:i};t.i_constructor(s,e,e)};t.body?s():i.attachEvent("load",s)};R.prototype=new o(["finish"]);var j=function(){var t=this;i.delay(function(){t.emit("finish",{},2e3)})};j.prototype=new o(["finish"]);var L=function(t){if(i.isSameOriginUrl(t))return new A(t,i.XHRLocalObject);switch(i.isXHRCorsCapable()){case 1:return new A(t,i.XHRLocalObject);case 2:return new A(t,i.XDRObject);case 3:return new R(t);default:return new j}};(O["w-iframe-info-receiver"]=function(t,e,n){new A(n,i.XHRLocalObject).onfinish=function(e,i){t._didMessage("m"+JSON.stringify([e,i])),t._didClose()}}).prototype.doCleanup=function(){};var F=v["iframe-eventsource"]=function(){this.protocol="w-iframe-eventsource",this.i_constructor.apply(this,arguments)};F.prototype=new B,F.enabled=function(){return"EventSource"in e&&B.enabled()},F.need_body=!0,F.roundTrips=3,(O["w-iframe-eventsource"]=function(t,e){this.run(t,e,"/eventsource",W,i.XHRLocalObject)}).prototype=new x;var N=v["iframe-xhr-polling"]=function(){this.protocol="w-iframe-xhr-polling",this.i_constructor.apply(this,arguments)};N.prototype=new B,N.enabled=function(){return e.XMLHttpRequest&&B.enabled()},N.need_body=!0,N.roundTrips=3,(O["w-iframe-xhr-polling"]=function(t,e){this.run(t,e,"/xhr",V,i.XHRLocalObject)}).prototype=new x;var $=v["iframe-htmlfile"]=function(){this.protocol="w-iframe-htmlfile",this.i_constructor.apply(this,arguments)};$.prototype=new B,$.enabled=function(){return B.enabled()},$.need_body=!0,$.roundTrips=3,(O["w-iframe-htmlfile"]=function(t,e){this.run(t,e,"/htmlfile",U,i.XHRLocalObject)}).prototype=new x;var H=function(t,e,i,n){this.ri=t,this.Receiver=e,this.recv_url=i,this.AjaxObject=n,this._scheduleRecv()};H.prototype._scheduleRecv=function(){var t=this,e=t.poll=new t.Receiver(t.recv_url,t.AjaxObject);e.onmessage=function(e){1,t.ri._didMessage(e.data)},e.onclose=function(i){t.poll=e=e.onmessage=e.onclose=null,t.poll_is_closing||("permanent"===i.reason?t.ri._didClose(1006,"Polling error ("+i.reason+")"):t._scheduleRecv())}},H.prototype.abort=function(){this.poll_is_closing=!0,this.poll&&this.poll.abort()};var z,W=function(t){var e=this,n=new EventSource(t);n.onmessage=function(t){e.dispatchEvent(new s("message",{data:unescape(t.data)}))},e.es_close=n.onerror=function(t,o){var r=o?"user":2!==n.readyState?"network":"permanent";e.es_close=n.onmessage=n.onerror=null,n.close(),n=null,i.delay(200,function(){e.dispatchEvent(new s("close",{reason:r}))})}};W.prototype=new n,W.prototype.abort=function(){this.es_close&&this.es_close({},!0)};var U=function(t){var n=this;i.polluteGlobalNamespace(),n.id="a"+i.random_string(6,26),t+=(-1===t.indexOf("?")?"?":"&")+"c="+escape("_jp."+n.id);var o,r=function(){if(void 0===z)if("ActiveXObject"in e)try{z=!!new ActiveXObject("htmlfile")}catch(t){}else z=!1;return z}()?i.createHtmlfile:i.createIframe;e._jp[n.id]={start:function(){o.loaded()},message:function(t){n.dispatchEvent(new s("message",{data:t}))},stop:function(){n.iframe_close({},"network")}},n.iframe_close=function(t,i){o.cleanup(),n.iframe_close=o=null,delete e._jp[n.id],n.dispatchEvent(new s("close",{reason:i}))},o=r(t,function(t){n.iframe_close({},"permanent")})};U.prototype=new n,U.prototype.abort=function(){this.iframe_close&&this.iframe_close({},"user")};var V=function(t,e){var i=this,n=0;i.xo=new e("POST",t,null),i.xo.onchunk=function(t,e){if(200===t)for(;;){var o=e.slice(n),r=o.indexOf("\n");if(-1===r)break;n+=r+1;var a=o.slice(0,r);i.dispatchEvent(new s("message",{data:a}))}},i.xo.onfinish=function(t,e){i.xo.onchunk(t,e),i.xo=null;var n=200===t?"network":"permanent";i.dispatchEvent(new s("close",{reason:n}))}};return V.prototype=new n,V.prototype.abort=function(){this.xo&&(this.xo.close(),this.dispatchEvent(new s("close",{reason:"user"})),this.xo=null)},v.getUtils=function(){return i},v.getIframeTransport=function(){return B},v}(),"_sockjs_onload"in window&&setTimeout(_sockjs_onload,1),"function"==typeof define&&define.amd&&define("sockjs",[],function(){return t}),function(){"use strict";var e,i,n,s={},o=!1,r=0,a=!0,c=[],l=!0;BEM.decl("i-xiva",{},{listen:function(t,e,i,n){var o=!s[t],r=n&&n.force;o&&(s[t]={handlers:[]}),s[t].ignoreFilterByTime=n&&n.ignoreFilterByTime,s[t].ignoreBlurEvent=n&&n.ignoreBlurEvent,s[t].ts=e,s[t].handlers.push(i),this._init(r),o&&this._updateSubscription()},stopListen:function(t,e){s[t]&&(s[t].handlers=s[t].handlers.filter(function(t){return t!==e}),s[t].handlers.length||(delete s[t],this._updateSubscription()))},send:function(t){var e;this._hasXivaSupport()&&t&&t.ch&&(this._connected||this._init(!0),e=JSON.stringify(t),this._sendQueue.push(e),this._sendDelayed())},_sendQueue:[],_sendDelayed:function(){var t;if(this._connected)for(;this._sendQueue.length;)t=this._sendQueue.pop(),e.send(t)},connect:function(){a=!0,this._connect()},disconnect:function(t){a=t,e&&e.close&&e.close(1e3,"unload")},_deliverReceived:function(){var t,e;for(t=0,e=c.length;t<e;++t)(0,c[t].handler)(c[t].data,!0);c=[]},_toggleFocus:function(t){(l=t)&&this._deliverReceived()},_initFocusEvents:function(){var t=this;$.browser&&$.browser.msie?$(document).bind("focusout",function(){t._toggleFocus(!1)}).bind("focusin",function(){t._toggleFocus(!0)}):$(window).focus(function(){t._toggleFocus(!0)}).blur(function(){document.activeElement&&"IFRAME"===document.activeElement.tagName||t._toggleFocus(!1)})},_bindOnUnload:function(){var t=this;$(window).on("beforeunload",function(){t.disconnect(!1)})},_init:function(t){o&&!t||this._connected||(o=!0,this._initFocusEvents(),this._bindOnUnload(),this._connect=this._connect.bind(this),clearTimeout(this._connectTimeout),t?this._connect():this._connectTimeout=setTimeout(function(){this._connect()}.bind(this),6e4))},_hasXivaSupport:function(){return!!window.WebSocket},_connect:function(){var i=home.getData("i-xiva.url");this._hasXivaSupport()&&i&&(e||((e=new t("//"+i+"/xiva",null,{protocols_whitelist:["websocket"]})).onopen=function(){this._connected=!0,this._updateSubscription(),this._checkConnection(),this._sendDelayed()}.bind(this),e.onmessage=this._onMessage.bind(this),e.onclose=function(){this._connected=!1,e=null,this._reconnect()}.bind(this)))},_reconnect:function(){this._stopConnectionTimer(),a&&(++r<=5?setTimeout(this._connect,3e3):r<=15?setTimeout(this._connect,1e4):setTimeout(this._connect,6e4))},_stopConnectionTimer:function(){i&&(clearTimeout(i),i=null)},_checkConnection:function(){this._stopConnectionTimer(),i=setTimeout(function(){0},5e3)},_updateSubscription:function(){n&&clearTimeout(n),n=setTimeout(function(){this._subscribeSend()}.bind(this),100)},_subscribeSend:function(){var t;if(this._connected){for(var i in t={subscribe:{}},s)s.hasOwnProperty(i)&&(t.subscribe[i]=s[i].ts);e.send(JSON.stringify(t))}},_onMessage:function(t){var e,i,n,o,r=$.trim(t.data);try{if(n=(e=JSON.parse(r)).ch+"_"+e.key,e.mts&&(this._timeDelta=+new Date-e.mts),s[n]&&(i=parseInt(e.ts),s[n].ts<i||s[n].ignoreFilterByTime)){s[n].ts=i;for(var a=0,h=(o=s[n].handlers).length;a<h;++a)l||s[n].ignoreBlurEvent?o[a](e):c.push({handler:o[a],data:e})}}catch(t){}},getTimeDelta:function(){return this._timeDelta}})}()}(),$(function(){if(home.getData("yac-promo.enabled")&&("CSS"in window&&CSS.supports&&(CSS.supports("position","sticky")||CSS.supports("position","-webkit-sticky")))){var t=$(".media-grid").bem("media-grid");if(function(){var t=$(".media-broadcast").offset().top,e=$(window).scrollTop(),i=window.innerHeight;return o()||e+i<t+30}()){var e=$(home.view("yac-promo__layout",{title:home.l10n("media.broadcast.yac2018.title")}));e.insertBefore(".rows__row_last").on("click",function(){BEM.blocks["media-broadcast"].scrollToBlock(),home.stat.logPath("click","yac.promo")}),home.stat.logPath("show","yac.promo");var i=$(".media-broadcast"),n=i.offset().top,s=i.height();BEM.channel("i-scroll-event").on("scroll",function t(){var i=window.innerHeight,r=$(window).scrollTop();!o()&&r+i>n+.33*s&&(e.addClass("yac-promo_fade-out"),setTimeout(function(t){t.remove()}.bind(this,e),300),BEM.channel("i-scroll-event").un("scroll",t))})}}function o(){return t.hasMod("collapsed","yes")}}),function(){var t=home.getData("i-prefetch-stat.data");("PerformanceObserver"in window&&window.Ya&&Ya.Rum&&window.performance&&performance.getEntriesByName&&function(){var t=new PerformanceObserver(function(e){var i=e.getEntries().find(function(t){return"yndxPreloadedPageSubmit"===t.name});i&&(Ya.Rum.sendTimeMark("3106.143.297",i.startTime,!1),t.disconnect())});t.observe({entryTypes:["mark"]})}(),t)&&(e()||document.addEventListener("visibilitychange",function t(){e()&&document.removeEventListener("visibilitychange",t)}),"PerformanceObserver"in window&&"PerformancePaintTiming"in window&&new window.PerformanceObserver(function(t){t.getEntries().forEach(function(t){"first-paint"===t.name&&Ya.Rum.sendTimeMark("1088.2793")})}).observe({entryTypes:["paint"]}));function e(){if("visible"===document.visibilityState)return $.ajax({url:"/instant/stlog?msid="+t.showId+"&rnd="+Date.now(),method:"POST",data:"r="+t.root+"&b="+[["search",Object.keys(t.params).map(function(e){return e+"="+encodeURIComponent(t.params[e])}).join(":")].join(":"),"ROOT:k="+t.k].concat(t.shows||[]).join("#"),xhrFields:{withCredentials:!0}}),Ya.Rum.sendTimeMark("1088.487"),!0}}(),BEM.DOM.decl({block:"button2",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments)}},pressed:{yes:function(){if(this.hasMod("disabled"))return!1;this.trigger("press")},"":function(){this.trigger("release")}},checked:{yes:function(){this.trigger("check").domElem.attr("aria-pressed","true")},"":function(){this.trigger("uncheck").domElem.attr("aria-pressed","false")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("pressed")}},focused:{"":function(){this.__base.apply(this,arguments),this.delMod("pressed")}},progress:{yes:function(){this.setMod("disabled","yes")},"":function(){this.delMod("disabled")}}},getText:function(){return this.elem("text").text()},setText:function(t){return this.elem("text").text(t),this},_onClick:function(t){(!this._preventClick||t.detail>0)&&this.trigger("click",this._buildClickEventData(t)),this._preventClick=!1},_processClick:function(t){this.trigger("click",this._buildClickEventData(t))},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onKeydown:function(t){var e=t.keyCode,i=BEM.blocks.keycodes;i.is(e,this.params.pressKeys)&&(this.setMod("pressed","yes"),i.is(e,this.params.prvntKeys)&&t.preventDefault())},_onKeyup:function(t){var e=t.keyCode,i=BEM.blocks.keycodes;i.is(e,this.params.prvntKeys)&&t.preventDefault(),i.is(e,this.params.pressKeys)&&(this.delMod("pressed"),i.is(e,this.params.clickKeys)&&(this._preventClick=!0,this._processClick(t)))},_buildClickEventData:function(t){return{domEvent:t,isModKey:t.ctrlKey||t.altKey||t.metaKey||t.shiftKey}},getDefaultParams:function(){return $.extend(this.__base(),{pressKeys:["SPACE","ENTER"],prvntKeys:[],clickKeys:[]})}},{live:function(){return this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("pointerclick",function(t){this.hasMod("disabled")||this._onClick(t)}).liveBindTo("keydown",function(t){this._onKeydown(t)}).liveBindTo("keyup",function(t){this._onKeyup(t)}),this.__base()}}),BEM.DOM.decl("button2",{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered")}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")},_onClick:function(){this.__base.apply(this,arguments),this._isDestructing||this.setMod("focused","yes")}},{live:function(){return 8===BEM.blocks["i-ua"].ie&&this.liveBindTo("dblclick",function(t){this.hasMod("disabled")||this._onClick(t)}),this.liveBindTo("pointerover pointerout",function(t){this.hasMod("disabled")||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("mousedown",function(t){t.preventDefault()}),this.__base()}}),BEM.DOM.decl("popup2",{onSetMod:{js:{inited:function(){this._parentPopup=void 0,this._zIndex=null,this._zIndexGroupLevel=null,this._scope=BEM.DOM.scope,this._isAttachedToScope=!1}},visible:{yes:function(){this.trigger("beforeOpen"),this._isAttachedToScope||(this._scope.append(this.domElem),this._isAttachedToScope=!0),this._captureZIndex()._bindToParentPopup().bindTo("pointerdown pointerclick",this._setPreventHideByClick)},"":function(){this.trigger("beforeClose")._releaseZIndex()._unbindFromParentPopup().unbindFrom("pointerdown pointerclick")}}},destruct:function(){this.delMod("visible"),this.__base.apply(this,arguments)},setScope:function(t){return this._scope=t,this._isAttachedToScope=!1,this},setContent:function(t){return BEM.DOM.update(this.domElem,t),this},_calcZIndexGroupLevel:function(){var t=this.params.zIndexGroupLevel,e=this._getParentPopup();return e&&(t+=e._zIndexGroupLevel),t},_setPreventHideByClick:function(){var t=this;do{t._preventHideByClick=!0,t=t._getParentPopup()}while(t)},_bindToParentPopup:function(){var t=this._getParentPopup();return t&&(t.on("beforeClose",this._onParentPopupClose,this),t.addChild&&t.addChild(this)),this},_unbindFromParentPopup:function(){return this._parentPopup&&this._parentPopup.un("beforeClose",this._onParentPopupClose,this),this._parentPopup=void 0,this},_onParentPopupClose:function(){this.delMod("visible")},_getParentPopup:function(){return this._parentPopup},_captureZIndex:function(){null===this._zIndexGroupLevel&&(this._zIndexGroupLevel=this._calcZIndexGroupLevel());var t=this.__self._visiblePopupsZIndexes,e=this._zIndexGroupLevel,i=t[e],n=this._zIndex;return i||(i=t[e]=[(e+1)*this.__self.ZINDEX_FACTOR]),this._zIndex=i[i.length-1]+1,i.push(this._zIndex),this._zIndex!==n&&this.domElem.css("z-index",this._zIndex),this},_releaseZIndex:function(){var t=this.__self._visiblePopupsZIndexes[this._zIndexGroupLevel];return t&&t.splice(t.indexOf(this._zIndex),1),this},_recaptureZIndex:function(){return this._releaseZIndex(),this._zIndexGroupLevel=null,this._captureZIndex()},getDefaultParams:function(){return{zIndexGroupLevel:0}}},{live:!0,_visiblePopupsZIndexes:(BEM.blocks.popup||{})._visiblePopupsZIndexes||{},ZINDEX_FACTOR:1e3}),BEM.DOM.decl("popup2",{attachToScope:function(t){return t&&(this._scope=t),this._scope.append(this.domElem),this._isAttachedToScope=!0,this}}),BEM.DOM.decl("popup2",{onSetMod:{visible:{yes:function(){this.__base.apply(this,arguments),this._bindFocusEvents()},"":function(){this.__base.apply(this,arguments),this._unbindFocusEvents(),this._returnFocus()}}},setParams:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.params[e]=t[e])},_bindFocusEvents:function(){this._lastFocused=$($.dom.getActiveElement()[0]||this._scope);var t=this._getFocusable(this.domElem);this._firstFocusable=t.first(),this._lastFocusable=t.last(),this._skipReturnFocus=!1,0!==this._firstFocusable.length?this.bindTo(this._lastFocused,"keydown",this._onLastFocusedKeyDown).bindTo(this._firstFocusable,"keydown",this._onFirstFocusableKeyDown).bindTo(this._lastFocusable,"keydown",this._onLastFocusableKeyDown):this._skipReturnFocus=!0},_unbindFocusEvents:function(){this.unbindFrom(this._firstFocusable,"keydown"),this.unbindFrom(this._lastFocusable,"keydown"),this.unbindFrom(this._lastFocused,"keydown")},_getFocusable:function(t){var e=$.identify(),i="a[href], link, ";return $.data(t,"popup-getFocusable-id",e),BEM.blocks["i-ua"].opera<13&&(i=""),t.find(i+'*[tabindex], button, input:not([type="hidden"]), textarea, select, menuitem').filter(function(){var t=!0;return!(parseInt($(this).prop("tabindex"),10)<0)&&($(this).parentsUntil('*[data-popup-getFocusable-id="'+e+'"]').each(function(){if("none"===$(this).css("display"))return t=!1}),t)})},_returnFocus:function(){(this._parent||{})._skipReturnFocus||this._skipReturnFocus||this._lastFocused.focus()},_onLastFocusedKeyDown:function(t){this._lastFocused.is(this._scope)&&!this._lastFocused.is(t.target)||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this[t.shiftKey?"_lastFocusable":"_firstFocusable"].focus())},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())}},{}),BEM.DOM.decl({block:"popup2",modName:"target"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._lastPopupDrawingCss={left:void 0,top:void 0,zIndex:void 0,display:void 0},this._lastTailDrawingCss={left:void 0,top:void 0},this._initialVisible=this.hasMod("visible")}},visible:{yes:function(){this.__base.apply(this,arguments),this.bindToWin("scroll resize",this._onWinScollAndResize).redraw(!0)},"":function(){this.__base.apply(this,arguments),this.unbindFromWin("scroll resize")}}},setContent:function(){return this.__base.apply(this,arguments).redraw()},_draw:function(){var t=this._calcBestDrawingParams();return this.setMod("direction",t.direction),e(this._lastPopupDrawingCss,this._calcDrawingCss(t))&&this.domElem.css(this._lastPopupDrawingCss),e(this._lastTailDrawingCss,this._calcTailDrawingCss(t))&&this.elem("tail").css(this._lastTailDrawingCss),this;function e(t,e){var i=!1;return Object.keys(e).forEach(function(n){var s=e[n];t[n]!==s&&(t[n]=s,i=!0)}),i}},redraw:function(t){return this.hasMod("visible","yes")||t?(this.setMod("outside","yes")._draw().delMod("outside"),this):this},_calcDrawingCss:function(t){var e,i=this._scope;return i.is(BEM.DOM.scope)||(e=i.offset(),t.top-=e.top,t.left-=e.left),{left:t.left,top:t.top}},_calcTailDrawingCss:function(t){return t.tail},calcPossibleDrawingParams:function(){var t=this._calcTargetDimensions(),e=this._calcViewportDimensions(),i=this._calcOffsets();return this.params.directions.map(function(n){var s={direction:n,width:0,height:0,left:0,top:0};return this._checkMainDirection(n,"bottom")?(s.top=t.top+t.height+i.main,s.height=e.bottom-s.top-i.viewport):this._checkMainDirection(n,"top")?(s.height=t.top-e.top-i.main-i.viewport,s.top=t.top-s.height-i.main):(this._checkSecondaryDirection(n,"center")?(s.height=e.bottom-e.top-2*i.viewport,s.top=t.top+(t.height-s.height)/2):this._checkSecondaryDirection(n,"bottom")?(s.height=t.top+t.height-e.top-i.secondary-i.viewport,s.top=t.top+t.height-s.height-i.secondary):this._checkSecondaryDirection(n,"top")&&(s.top=t.top+i.secondary,s.height=e.bottom-s.top-i.viewport),this._checkMainDirection(n,"left")?(s.width=t.left-e.left-i.main-i.viewport,s.left=t.left-s.width-i.main):(s.left=t.left+t.width+i.main,s.width=e.right-s.left-i.viewport)),this._checkSecondaryDirection(n,"right")?(s.width=t.left+t.width-e.left-i.secondary-i.viewport,s.left=t.left+t.width-s.width-i.secondary):this._checkSecondaryDirection(n,"left")?(s.left=t.left+i.secondary,s.width=e.right-s.left-i.viewport):this._checkSecondaryDirection(n,"center")&&this._checkMainDirection(n,"top","bottom")&&(s.width=e.right-e.left-2*i.viewport,s.left=t.left+t.width/2-s.width/2),s},this)},_calcBestDrawingParams:function(){for(var t,e,i,n,s,o,r=this._calcPopupDimensions(),a=this._calcTargetDimensions(),c=this._calcViewportDimensions(),l=this.params.directions,h=l.length,u=0;u<h&&(t=l[u],e=this._calcPos(t,a,r),i=this._calcViewportFactor(e,c,r),(0===u||i>o||!o&&this.hasMod("direction",t))&&(n=t,o=i,s=e),!(o>this.__self.VIEWPORT_ACCURACY_FACTOR));u++);return{direction:n,left:s.left,top:s.top,tail:this._calcTailPos(n,a,r,s)}},_calcPopupDimensions:function(){var t=this.domElem.outerWidth(),e=this.domElem.outerHeight();return{width:t,height:e,innerWidth:this.domElem.innerWidth(),innerHeight:this.domElem.innerHeight(),area:t*e}},_calcTailDimension:function(){var t=this.elem("tail"),e=this.params.tailSize||t.outerWidth();return t.length>0&&"none"!==t.css("display")?e:0},_calcTargetDimensions:function(){},_calcViewportDimensions:function(){var t=BEM.DOM.win,e=t.scrollTop(),i=t.scrollLeft(),n=t.width();return{top:e,left:i,bottom:e+t.height(),right:i+n}},_calcPos:function(t,e,i){var n={},s=this._calcOffsets();return this._checkMainDirection(t,"bottom")?n.top=e.top+e.height+s.main:this._checkMainDirection(t,"top")?n.top=e.top-i.height-s.main:this._checkMainDirection(t,"left")?n.left=e.left-i.width-s.main:this._checkMainDirection(t,"right")&&(n.left=e.left+e.width+s.main),this._checkSecondaryDirection(t,"right")?n.left=e.left+e.width-i.width-s.secondary:this._checkSecondaryDirection(t,"left")?n.left=e.left+s.secondary:this._checkSecondaryDirection(t,"bottom")?n.top=e.top+e.height-i.height-s.secondary:this._checkSecondaryDirection(t,"top")?n.top=e.top+s.secondary:this._checkSecondaryDirection(t,"center")&&(this._checkMainDirection(t,"top","bottom")?n.left=e.left+e.width/2-i.width/2:this._checkMainDirection(t,"left","right")&&(n.top=e.top+e.height/2-i.height/2)),n},_calcTailPos:function(t,e,i,n){var s={},o=this._calcTailDimension()/2,r=this.params.tailOffset,a=this.params.tailSize;return this._checkMainDirection(t,"bottom")?s.top=-o:this._checkMainDirection(t,"top")?s.top=Math.floor(i.innerHeight-o):this._checkMainDirection(t,"left")?s.left=Math.floor(i.innerWidth-o):this._checkMainDirection(t,"right")&&(s.left=-o),this._checkSecondaryDirection(t,"right")?s.left=i.innerWidth-Math.ceil(Math.min(i.innerWidth,e.width)/2)-o-r:this._checkSecondaryDirection(t,"left")?s.left=Math.ceil(Math.min(i.innerWidth,e.width)/2)-o+r:this._checkSecondaryDirection(t,"bottom")?s.top=i.innerHeight-Math.ceil(Math.min(i.innerHeight,e.height)/2)-o-r:this._checkSecondaryDirection(t,"top")?s.top=Math.ceil(Math.min(i.innerHeight,e.height)/2)-o+r:this._checkSecondaryDirection(t,"center")&&(this._checkMainDirection(t,"top","bottom")?s.left=Math.ceil(i.innerWidth/2)-o+r:s.top=Math.ceil(i.innerHeight/2)-o+r),{top:s.top,left:s.left,width:a,height:a}},_calcViewportFactor:function(t,e,i){var n=this.params.viewportOffset,s=Math.max(t.left,e.left+n),o=Math.min(t.left+i.width,e.right-n),r=Math.max(t.top,e.top+n),a=Math.min(t.top+i.height,e.bottom-n);return s<o&&r<a?(o-s)*(a-r)/i.area:0},_calcOffsets:function(){var t=this.params,e=this._calcTailDimension();return{main:e>0?Math.max(t.mainOffset,Math.round(e*Math.SQRT1_2)):t.mainOffset,secondary:t.secondaryOffset,viewport:t.viewportOffset}},_checkMainDirection:function(t,e,i){return 0===t.indexOf(e)||i&&0===t.indexOf(i)},_checkSecondaryDirection:function(t,e){return t.indexOf("-"+e)>0},_checkDirection:function(t,e){return t.indexOf(e)>=0},_onWinScollAndResize:function(t){this.hasMod("visible","yes")&&this._draw()},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{mainOffset:0,secondaryOffset:0,viewportOffset:0,tailOffset:0,directions:this.__self.AVAILABLE_DIRECTIONS})},_setVisible:function(){this._initialVisible&&(this._initialVisible=!1,this.delMod("visible").setMod("visible","yes"))}},{VIEWPORT_ACCURACY_FACTOR:.99,AVAILABLE_DIRECTIONS:["bottom-left","bottom-center","bottom-right","top-left","top-center","top-right","right-top","right-center","right-bottom","left-top","left-center","left-bottom"]}),function(t){BEM.DOM.decl({block:"popup2",modName:"target",modVal:"anchor"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._anchor=null,this._destructor=null,this._fixedAnchor=void 0}},visible:{yes:function(){this.bindToDoc("documentchange",this._onWinScollAndResize),this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments),this.unbindFromDoc("documentchange")}}},destruct:function(){this._unbindFromDestructor(),this.__base.apply(this,arguments)},setAnchor:function(t){var e,i;return this._unbindFromDestructor()._unbindFromParentPopup(),this._anchor=t instanceof BEM.DOM?t.domElem:t,this._destructor=(e=this._anchor,i="_"+this.__self.getName()+"-destructor",e.addClass("i-bem "+i).bem(i)),this._fixedAnchor=void 0,this._bindToDestructor(),this._setVisible(),this.hasMod("visible")?this._recaptureZIndex()._bindToParentPopup().redraw():this._zIndexGroupLevel=null,this},_calcTargetDimensions:function(){var t=this._anchor,e=this._getOffsetOf(t);return{left:e.left,top:e.top,width:t.outerWidth(),height:t.outerHeight()}},_getOffsetOf:function(t){var e=t.offset();return"pageYOffset"in window&&(e.top-=window.pageYOffset-(document.documentElement.scrollTop||document.body.scrollTop),e.left-=window.pageXOffset-(document.documentElement.scrollLeft||document.body.scrollLeft)),e},_calcDrawingCss:function(e){var i=this.__base.apply(this,arguments);if(void 0===this._fixedAnchor&&(this._fixedAnchor=this._getFirstFixedParent(this._anchor)),this._fixedAnchor){var n=0,s=0,o=this._getFirstFixedParent(this._scope);if(o){var r=o.offset();n=r.left,s=r.top}i.left-=t(window).scrollLeft()-n,i.top-=t(window).scrollTop()-s}return t.extend(i,{position:this._fixedAnchor?"fixed":""})},_getFirstFixedParent:function(e){for(e=e[0];e;){if(1===e.nodeType&&"fixed"===t(e).css("position"))return t(e);e=e.parentNode}return null},_calcZIndexGroupLevel:function(){var t=this.__base.apply(this,arguments);return this._destructor.findBlocksOutside("z-index-group").reduce(function(t,e){return t+Number(e.getMod("level"))},t)},_bindToDestructor:function(){return this._destructor.on("destruct",this._onPopupAnchorDestruct,this),this},_unbindFromDestructor:function(){return this._destructor&&this._destructor.un("destruct",this._onPopupAnchorDestruct,this),this},_onPopupAnchorDestruct:function(){this.domElem&&BEM.DOM.destruct(this.domElem)},_getParentPopup:function(){if(void 0===this._parentPopup){var t=this._anchor.closest(".popup, .popup2");this._parentPopup=this.findBlockOn(t,this.__self.getName())||this.findBlockOn(t,"popup")}return this._parentPopup}}),BEM.DOM.decl("_popup2-destructor",{destruct:function(){this.trigger("destruct"),this.__base.apply(this,arguments)}})}(jQuery),$.extend({debounce:function(t,e,i,n){var s,o=function(){var o=arguments;n=n||this,i&&!s&&t.apply(n,o),clearTimeout(s),s=setTimeout(function(){i||t.apply(n,o),s=null},e)};return 3===arguments.length&&"boolean"!=typeof i&&(n=i,i=!1),o.stop=function(){clearTimeout(s),s=null},o},throttle:function(t,e,i){var n,s,o,r=function(){s=arguments,o=!0,i=i||this,n||function(){o?(t.apply(i,s),o=!1,n=setTimeout(arguments.callee,e)):n=null}()};return r.stop=function(){clearTimeout(n),n=null},r}}),BEM.DOM.decl({block:"popup2",modName:"hiding",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._anchorParents=null,this._isAnchorVisible=void 0,this._updateIsAnchorVisible=$.throttle(this._updateIsAnchorVisible,this.__self.UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL,this)}},visible:{yes:function(){this._anchorParents=this._getAnchorParents(),this._bindToAnchorParents(),this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments),this._updateIsAnchorVisible.stop(),this._unbindFromAnchorParents(),this._anchorParents=null,this._isAnchorVisible=void 0}}},_getAnchorParents:function(){for(var t,e=this;e&&e._anchor;)t=e,e=e._getParentPopup();return $(t._anchor).parents()},setAnchor:function(t){return this.__base.apply(this,arguments),this._unbindFromAnchorParents(),this._isAnchorVisible=void 0,this.hasMod("visible")?(this._anchorParents=this._getAnchorParents(),this._bindToAnchorParents()):this._anchorParents=null,this},_unbindFromDestructor:function(){return this._updateIsAnchorVisible.stop&&this._updateIsAnchorVisible.stop(),this.__base.apply(this,arguments)},_calcDrawingCss:function(t){var e=this.__base.apply(this,arguments);return void 0===this._isAnchorVisible&&(this._isAnchorVisible=this._calcIsAnchorVisible()),$.extend(e,{display:this._isAnchorVisible?"":"none"})},_calcIsAnchorVisible:function(){var t=this._anchor,e=this._getOffsetOf(t),i=e.left,n=e.top,s=i+t.outerWidth(),o=n+t.outerHeight(),r=this.getMod("direction"),a=Math.floor(this._checkDirection(r,"top")?n:o),c=Math.floor(this._checkDirection(r,"left")?i:s),l=!0;return this._anchorParents.each(function(t,e){if("BODY"===e.tagName)return!1;e=$(e);var i=/scroll|hidden|auto/,n=i.test(e.css("overflow-y")),s=i.test(e.css("overflow-x"));if(n||s){var o=this._getOffsetOf(e),r=Math.floor(o.top);if(a<r||r+e.outerHeight()<a)return l=!1;var h=Math.floor(o.left);return l=c>=h&&h+e.outerWidth()>=c}}.bind(this)),l},_bindToAnchorParents:function(){return this.bindTo(this._anchorParents,"scroll",this._onAnchorParentsScroll)},_unbindFromAnchorParents:function(){return this._updateIsAnchorVisible.stop(),this._anchorParents&&this.unbindFrom(this._anchorParents,"scroll"),this},_onAnchorParentsScroll:function(){this.redraw()._updateIsAnchorVisible()},_onWinScollAndResize:function(){this.hasMod("visible")&&(this.__base.apply(this,arguments),this._updateIsAnchorVisible())},_updateIsAnchorVisible:function(){if(this.domElem){var t=this._calcIsAnchorVisible();t!==this._isAnchorVisible&&(this._isAnchorVisible=t,this.redraw())}}},{UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL:100}),BEM.DOM.decl({block:"popup2",modName:"autoclosable",modVal:"yes"},{onSetMod:{visible:{yes:function(){this.__self._visiblePopupsStack.unshift(this),this.afterCurrentEvent(function(){this.domElem&&this.hasMod("visible")&&this.bindToDoc("pointerclick",this._onDocClick)}),this.__base.apply(this,arguments)},"":function(){var t=this.__self._visiblePopupsStack;t.splice(t.indexOf(this),1),this.unbindFromDoc("pointerclick").__base.apply(this,arguments)}}},_onDocClick:function(t){this.hasMod("target","anchor")&&(this._anchor[0]===t.target||this._anchor.find(t.target).length>0)||(this._preventHideByClick?this._preventHideByClick=null:this.delMod("visible"))}},{live:function(){return BEM.DOM.doc.on("keydown",this._onDocKeyPress.bind(this)),this.__base()},_visiblePopupsStack:(BEM.blocks.popup||{})._visiblePopupsStack||[],_onDocKeyPress:function(t){BEM.blocks.keycodes.is(t.keyCode,"ESC")&&this._visiblePopupsStack.length&&this._visiblePopupsStack[0].__self.getName()===this.getName()&&this._visiblePopupsStack[0].delMod("visible")}}),BEM.DOM.decl({block:"popup2",modName:"theme",modVal:"normal"},{getDefaultParams:function(){return $.extend(this.__base(),{mainOffset:5,viewportOffset:5})}}),BEM.DOM.decl("notifier",{onSetMod:{js:{inited:function(){this._popup=this.getPopup(),this._spin=this.getSpin(),this.win=window,this._popup.on("beforeOpen beforeClose",function(){var t=this._popup.hasMod("visible","yes");this.toggleMod("opened","yes",!t),t?this._firstOpen=!1:(this.delMod("has-unread"),this._firstOpen=void 0===this._firstOpen||void 0),this._hasLoaded||this._spin.setMod("progress","yes")}.bind(this)),this._fetchCounter()}}},_fetchCounter:function(){return $.ajax({url:this._getCounterUrl(),dataType:"json",type:"GET",xhrFields:{withCredentials:!0}}).promise().then(function(t){if(t&&t.records.items.length)return t.records.items.reduce(function(t,e){var i=0;return e.fields.forEach(function(t){"unviewed_count"===t.field_id&&(i=t.value.integer)}),t+i},0)}).then(this.onUpdateCounter.bind(this))},_getCounterUrl:function(){return this.params.counterHandle||this.params.apiHost+"v1/data/app/databases/.ext.notifier@notifications_disk/snapshot?collection_id=meta"},_getIframeUrl:function(t){return this.params.iframeUrl||this.params.baseUrl+"/yandex-notifications/"+this.params.iframeVersion+"/iframe/index."+t+".html"},_getLoaderUrl:function(){return this.params.loaderUrl||this.params.baseUrl+"/iframe-loader/"+this.params.loaderVersion+"/index.min.js"},_insertLoaderScript:function(t){var e=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],i=document.createElement("script");i.setAttribute("src",this._getLoaderUrl()),e.insertBefore(i,e.lastChild),i.onload=t},_loadIframe:function(){var t={iframeUrl:this._getIframeUrl(this.params.lang),container:this.findElem(this._popup.domElem,"content").get(0)};this._atom=new window.LegoIframeLoader(t),this._rpcBridge=this._atom.getRPCBridge(this),this._atom.on("init",function(t,e){this._onIframeLoad(e)}.bind(this)),this._atom.init()},getPopup:function(){return this._popup||this.findBlockOn("popup","popup2")},getSpin:function(){return this._spin||this.getPopup().findBlockInside("spin2")},init:function(){if(this._rpcBridge)return this;window.LegoIframeLoader?this._loadIframe():this._insertLoaderScript(this._loadIframe.bind(this))},onIconClick:function(t){this._rpcBridge||this.init(),!this._popup.hasMod("visible","yes")&&this._rpcBridge&&this._hasLoaded&&this._rpcBridge.invokeMethod("resetUnviewed",{}),this._popup.toggleMod("visible","yes")},onDataLoad:function(t){this.setMod(this._popup.domElem,"loaded","yes"),this._spin.delMod("progress"),this._hasLoaded=!0,this._popup.hasMod("visible","yes")&&this._rpcBridge.invokeMethod("resetUnviewed",{})},onUpdateCounter:function(t){this.toggleMod("has-unread","yes",!this._firstOpen&&Boolean(t)),this._firstOpen&&(this._firstOpen=!1)},updateCounterWithParams:function(t,e){void 0!==this._rpcBridge&&void 0!==this._rpcBridge.contrAgent.win&&this._rpcBridge.invokeMethod("updateCounterWithParams",{counterParams:t,referrer:e})},_onIframeLoad:function(t){this._rpcBridge.contrAgent.win=t.iframeWin,this._rpcBridge.invokeMethod("onIframeLoad",{source:this.params.source,serviceDatabaseId:this.params.serviceDatabaseId,services:this.params.services,domain:this.params.domain||this.params.tld,counterParams:this.params.counterParams,referrer:this.params.referrer,apiHost:this.params.apiHost})},onInit:function(t){},getDefaultParams:function(){return{baseUrl:"https://gcn.yandex-team.ru",loaderVersion:"stable",iframeVersion:"stable",lang:"ru",referrer:location.href}}},{live:function(){this.liveBindTo("click",function(t){this.onIconClick(t)})}}),BEM.DOM.decl("notifier",{_fetchCounter:function(){if(this.__self._fetchPromise)return this.__self._fetchPromise.then(this.onUpdateCounter.bind(this));var t=this.__base.apply(this,arguments);return this.__self._fetchPromise=t,t.fail(function(t){var e=t&&t.responseJSON&&t.responseJSON.error;"DataNotFoundError"!==e&&home.error.logError({block:"notifier",message:"Cannot load counter: "+(e||t&&t.status||"unknown"),sourceType:"network"})})},onUpdateCounter:function(t){return this.__base.apply(this,arguments),t}},{hide:function(){$(".notifier").each(function(){var t=$(this);if(t.hasClass("notifier_js_inited")){var e=t.bem("notifier");e&&e.getPopup().delMod("visible")}})}}),BEM.DOM.decl("notifier",{onSetMod:{opened:{yes:function(){this.__base.apply(this),this.domElem.attr("aria-expanded","true"),home.stat.logPath("click",this.params.from+".notifier.popup.show")},"":function(){this.__base.apply(this),this.domElem.attr("aria-expanded","false"),home.stat.logPath("resize",this.params.from+".notifier.popup.close")}}}},{live:function(){this.__base.apply(this),this.liveBindKey("enter space",function(t){t.preventDefault(),this.domElem[0].click()})}}),BEM.DOM.decl("notifier",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._popup.attachToScope(),this._popup.setAnchor(this.elem("box"))}}}}),BEM.DOM.decl("usermenu-link",{_createPopup:function(){if(this.__self._popup&&this.updatePopup(),!this._inited){if(this._inited=!0,!this.__self._popup){var t=home.getData("usermenu-link.data");if(!t)return;var e=$(home.view("popup2",{mods:{view:"default",theme:"normal",target:"anchor",autoclosable:"yes","alt-shadow":"yes"},content:home.view("usermenu",t)})).appendTo("body");home.stat.logDOMShow(e,{visibilityCheck:!1}),BEM.DOM.init(e),this.__self._popup=this.findBlockInside(e,"popup2"),this.updatePopup()}this.__self._popup.on({beforeOpen:function(){this._toggleSwitcherAttrs(!0)},beforeClose:function(){this._toggleSwitcherAttrs(!1)}},this)}},updatePopup:function(){var t=this.params.popup||{};this.setAnchor(),t.mainOffset=t.mainOffset||0,t.secondaryOffset=t.secondaryOffset||0,t.directions=t.directions||["bottom-right"],this.__self._popup.setParams(t)},setAnchor:function(){var t=this.domElem;if(this.params.anchor){var e=this.findBlockInside(this.params.anchor);e&&(t=e)}this.__self._popup.setAnchor(t)},_onSwitcherClick:function(){this._createPopup(),this.__self._popup&&this.__self._popup.toggleMod("visible","yes")},_toggleSwitcherAttrs:function(t){this.domElem.attr("aria-expanded",t?"true":"false")}},{hide:function(){this._popup&&this._popup.setMod("visible","")},live:function(){this.liveBindTo("control","pointerclick",function(){return this._onSwitcherClick(),!1}),this.liveBindKey("control","space enter",function(){return this._onSwitcherClick(),!1})}}),BEM.DOM.decl({block:"menu",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.elem("item").attr("id",function(t,e){return e||$.identify()}),this._val=this.getVal()}},disabled:function(t,e){this.__base.apply(this,arguments),this.setMod(this.elem("item"),t,e)}},onElemSetMod:{item:{hovered:{yes:function(t){if(this.hasMod(t,"disabled"))return!1;this.delMod(this.elem("item","hovered","yes"),"hovered"),this.domElem.attr("aria-activedescendant",t.attr("id")),this.trigger("item-hover",{item:t})},"":function(){this.domElem.removeAttr("aria-activedescendant"),this.trigger("item-hover",{})}},checked:function(t,e,i){this.domElem.attr("aria-selected",Boolean(i))},disabled:{yes:function(){this.delMod("hovered"),this.domElem.attr("aria-disabled",!0)},"":function(){this.domElem.attr("aria-disabled",!1)}}}},_onChange:function(){var t=this._val,e=this.getVal();return t!==e&&(this._val=e,this.trigger("change",{prevVal:t,currVal:e})),this},getItems:function(t,e){return this.elem("item",t,e).get().map(function(t){return $(t)})},setContent:function(t){return BEM.DOM.update(this.domElem,t),this.reset(),this},getVal:function(){},reset:function(){this.dropElemCache()},_onItemEnter:function(t,e){this.setMod(t,"hovered","yes")},_onItemLeave:function(t,e){this.delMod(t,"hovered")},_onItemFocusin:function(t,e){this.setMod(t,"hovered","yes")},_onFocusout:function(t){this.__base.apply(this,arguments),this.delMod(this.elem("item","hovered","yes"),"hovered")},_onItemClick:function(t,e,i){this.trigger("click",{item:t,source:i.source})}},{live:function(){return this.liveBindTo("item","pointerover pointerout",function(t){var e=t.data.domElem;this.hasMod(e,"disabled","yes")||e[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onItemEnter(e,t):this._onItemLeave(e,t))}).liveBindTo("item","pointerclick",function(t){var e=t.data.domElem;this.hasMod(e,"disabled")||this._onItemClick(e,t,{source:"pointer"})}).liveBindTo("item","focusin",function(t){var e=t.data.domElem;this.hasMod(e,"disabled")||this._onItemFocusin(e,t)}).liveBindTo("focusout",function(t){this._onFocusout(t)}),this.__base()}}),BEM.DOM.decl("menu",{onSetMod:{focused:{yes:function(){if(this.__base.apply(this,arguments),this.hasMod("type","navigation"))return!1;this.elem("item","hovered","yes").length||(this.setMod(this.elem("item").eq(0),"hovered","yes"),this._scrollToItem(this.elem("item").eq(0))),this.bindToDoc("keydown",this._onKeydown).bindToDoc("keyup",this._onKeyup).bindToDoc("keypress",this._onKeypress)},"":function(){this.__base.apply(this,arguments),this.unbindFromDoc("keydown keyup keypress").delMod(this.elem("item","hovered","yes"),"hovered")}}},hoverNext:function(t){for(var e,i,n=t?this.getItems().reverse():this.getItems(),s=0,o=!1;i=n[s];s++)if(!this.hasMod(i,"disabled"))if(this.hasMod(i,"hovered"))o=!0;else{if(o){e=i;break}e||(e=i)}e&&(this.setMod(e,"hovered","yes"),this._scrollToItem(e))},hoverText:function(t,e){for(var i,n=this.getItems(),s=n.length,o=this._normalizeText(t),r=e||0;r<s;){if(i=n[r],!this.hasMod(i,"disabled")&&0===this._normalizeText(i.text()).indexOf(o))return this.setMod(i,"hovered","yes"),void this._scrollToItem(i);++r===n.length&&(r=0,s=e)}},_normalizeText:function(t){return t.toLowerCase().replace(//,"")},reset:function(){this.__base.apply(this,arguments),this._dropSearchCache()},_dropSearchCache:function(){this._lastTime=this._lastChar=this._searchTerm=void 0},_scrollToItem:function(t){var e=this.domElem.offset().top,i=t.offset().top,n=0;i<e?n=i-e:(n=i+t.outerHeight()-e-this.domElem.outerHeight())<0&&(n=0),this.domElem.scrollTop(this.domElem.scrollTop()+n)},_onKeydown:function(t,e){var i=BEM.blocks.keycodes,n=t.keyCode;t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||((i.is(n,"UP","DOWN")||!e&&n===i.SPACE)&&t.preventDefault(),i.is(n,"UP","DOWN")&&(this.hoverNext(i.is(n,"UP")),this._dropSearchCache()))},_onKeyup:function(t){var e=BEM.blocks.keycodes,i=t.keyCode;t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||e.is(i,"ENTER","SPACE")&&this._onItemClick(this.elem("item","hovered","yes"),t,{source:"keyboard"})},_onKeypress:function(t){var e,i,n=Number(new Date),s=t.charCode,o=String.fromCharCode(s).toLowerCase(),r=o===this._lastChar&&1===this._searchTerm.length,a=this.getItems();s<=BEM.blocks.keycodes.SPACE||t.ctrlKey||t.altKey||t.metaKey?this._lastTime=n:(n-this._lastTime>this.SEARCH_TIMEOUT||r?this._searchTerm=o:this._searchTerm=(this._searchTerm||"")+o,this._lastChar=o,this._lastTime=n,e=this.elem("item","hovered","yes"),i=(i=$($.map(a,function(t){return t.get()})).index(e))>=0?i:0,r&&0===this._normalizeText(e.text()).indexOf(this._searchTerm)&&(i=i>=a.length-1?0:i+1),this.hoverText(this._searchTerm,i))},SEARCH_TIMEOUT:1500}),BEM.DOM.decl("menu",{},{live:function(){var t=this.__base.apply(this,arguments);return this.liveBindKey("item","enter space",function(t){this.getMod("type","navigation")&&!t.data.domElem.attr("href")&&(this._onItemClick(t.data.domElem,t,{source:"keyboard"}),home.stat.logPath("click",t.data.domElem.attr(home.stat.attr)))}),t}}),BEM.DOM.decl("usermenu",{_getEmbeddedAuth:function(){return this.auth?this.auth:this.auth=BEM.create("i-embeddedauth",this.params.auth)},_selectUser:function(t){var e=t.closest(".usermenu__user").data("uid");if(e)return this._getEmbeddedAuth().setData({uid:e},this.changeThis(this._switchResponse)).submit(),!1},_logoutUser:function(t){var e=t.closest(".usermenu__user-exit"),i=e.parent(),n=e.data("uid");if(n)return this._$userWrapper=i,this._getEmbeddedAuth().setData({uid:n,action:"logout"},this.changeThis(this._logoutResponse)).submit(),!1},_switchResponse:function(t){switch(t.status){case"ok":case"action-not-required":return void window.location.reload();default:window.location.href=this.params.passport}},_logoutResponse:function(t){var e=this._$userWrapper;switch(this._$userWrapper=null,t.status){case"ok":case"action-not-required":return void(e&&e.hide());default:window.location.href=this.params.passport}}},{live:function(){var t=function(t){return this._selectUser($(t.target))},e=function(t){return this._logoutUser($(t.target))};this.liveBindTo({elem:"user",modName:"clickable",modVal:"yes"},"pointerclick",t),this.liveBindKey({elem:"user",modName:"clickable",modVal:"yes"},"enter",t),this.liveBindTo("user-exit","pointerclick",e),this.liveBindKey("user-exit","enter",e)}}),BEM.decl("i-embeddedauth",{addCallback:function(t){var e="cb"+Math.random();return this.callbacks||(this.callbacks={}),this.callbacks[e]=t,e},addQueryParam:function(t,e){var i=t.split("?"),n=i[1]?i[1].split("&"):[];return n.push(e),i[1]=n.join("&"),i.join("?")},bindCallback:function(){var t=this;window.mordaAuth={onResponse:function(e){if(e){for(var i=e.split("?")[1].split("&"),n={},s=0,o=i.length;s<o;s++){var r=i[s].split("=");n[r.shift()]=decodeURIComponent(r.join("="))}t.processResponse(n)}else t.processResponse()}}},submit:function(){this.getForm().trigger("submit")},setData:function(t,e){if(t=$.extend({},this.params.params||{},t),this.idkey&&(t.idkey=this.idkey),e){var i=this.addCallback(e);t.retpath=this.addQueryParam(t.retpath,"from="+i)}return this.getForm().html(this.stringifyParams(t)),this},setDomain:function(){var t=document.domain.match(/([^.]+(?:\.com?)?\.)?[^.]+$/)[0];try{document.domain=t}catch(t){}},stringifyParams:function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e+=this.getInputHtml(i,t[i]));return e},getInputHtml:function(t,e){return'<input name="'+t+'" value="'+e+'"/>'},getForm:function(){if(this.form)return this.form;this.setDomain(),this.bindCallback();var t="embeddedauthframe"+parseInt(1e4*Math.random(),10);return this.form=$('<form style="display:none" target="'+t+'" method="'+(this.params.method||"post")+'" action="'+this.params.action+'"></form>'),this.frame=$('<iframe style="display:none" name="'+t+'"></iframe>'),$("body").append(this.form,this.frame),this.form},processResponse:function(t){var e=function(){};if(t)switch(t.from&&this.callbacks[t.from]&&(e=this.callbacks[t.from],this.callbacks[t.from]=!1),this.idkey=t.idkey,t.status){case"login-empty":case"password-empty":case"account-not-found":case"password-invalid":case"action-not-required":case"ok":case"uid-empty":case"sessionid-invalid":case"session-no-uid":case"yu-empty":case"yu-invalid":case"captcha-invalid":case"captcha-required":return e(t),void this.trigger("data-received",t);case"internal-exception":return this.idkey="",this._interr?(e(t),void this.trigger("data-received",t)):(this._interr=!0,t.from&&(this.callbacks[t.from]=e),void this.submit());default:t.url?window.location=t.url:(e(t),this.trigger("data-received",t))}else this.trigger("no-data")}}),function(){"use strict";home.cleverString={};var t;t=function(t,e){var i=t.charCodeAt(),n=e.charCodeAt();return i>=55296&&i<=56319&&n>=56320&&n<=57343},home.cleverString.length=function(e){if(void 0===e||null===e)return 0;for(var i=0,n=e.length,s=0;i<n;)++i<n&&t(e[i-1],e[i])&&++i,++s;return s},home.cleverString.substring=function(e,i,n){if("string"!=typeof e)return e;"number"!=typeof i&&(i=0),n||0===n||(n=1/0);for(var s,o=[],r=i+n,a=0,c=e.split(""),l=c.length,h=0;a<=l;)s=1,a+1<l&&t(e[a],e[a+1])&&(s=2),h>=i&&h<r&&o.push(c.slice(a,a+s).join("")),a+=s,++h;return o.join("")},home.cleverString.cutMiddleOfString=function(t,e,i){var n=home.cleverString.length(t);return"string"!=typeof t||n<3||"number"!=typeof e||"number"!=typeof i?t:-1===e||-1===i?"":n>e+1+i?home.cleverString.substring(t,0,e)+""+home.cleverString.substring(t,n-i):t},home.cleverString.cutEndOfString=function(t,e){return home.cleverString.cutMiddleOfString(t,e-1,0)},home.cleverString.cutStartOfString=function(t,e){return home.cleverString.cutMiddleOfString(t,0,e-1)}}(),function(){var t=function(){var t=home.getData("delayed-reporter"),e=function(t){void 0!==t.timeout?setTimeout(function(){i(t)},1e3*t.timeout):i(t)},i=function(t){t.url?(new Image).src=t.url:t.stat&&t.stat.type&&t.stat.name&&home.stat.logPath(t.stat.type,t.stat.name)},n=function(t){t&&(t="string"==typeof t?{url:t}:t,home.getData("common.reportVisibilityCheck")&&document.visibilityState&&"visible"!==document.visibilityState?document.addEventListener("visibilitychange",function i(){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",i),e(t))}):e(t))};if(t)for(var s in t)if(t.hasOwnProperty(s)){var o=t[s];o instanceof Array||(o=[o]),o.forEach(n)}};window.$?$(t):"addEventListener"in document&&document.addEventListener("DOMContentLoaded",t,!1)}(),BEM.DOM.decl("header",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.bindToWin("resize",$.throttle(this._onResize,150)),this._collapseUserIfNeeded()}}},_onResize:function(){this._collapseUserIfNeeded()},_onUserUpdatesName:function(){this._collapseBreakpoint=null,this._collapseUserIfNeeded()},_collapseUserIfNeeded:function(){var t=this._getUser();t&&t.toggleCollapsed(this._getCollapseBreakpoint()>=this.elem("nav").width())},_getCollapseBreakpoint:function(){return this._collapseBreakpoint||(this._collapseBreakpoint=this._getNavItemsWidth()+this.__self.NAV_ITEMS_GAP),this._collapseBreakpoint},_getNavItemsWidth:function(){var t=0;return this.elem("nav").children().each(function(){t+=$(this).outerWidth(!0)}),t},_getUser:function(){return this._user?this._user._isDestructing&&(this._collapseBreakpoint=null,this._user=this.findBlockInside("user")):(this._user=this.findBlockInside("user"),this._user&&this._user.on("update-name",this._onUserUpdatesName,this)),this._user}},{NAV_ITEMS_GAP:10,live:!1}),BEM.DOM.decl("b-errormsg",{onSetMod:{js:{inited:function(){this.bindTo("close","pointerclick",function(){home.stat.logPath("click","errormsg.close"),this.setMod("hidden","yes")})}}}}),BEM.DOM.decl("b-time-banner",{onSetMod:{js:function(){this.now=Math.round((new Date).getTime()/1e3),this.params.type&&BEM.blocks["i-message-locker"].acquireLock("b-time-banner").then(this.show.bind(this))}},show:function(){var t=this.params,e=t.type,i=t.typeData;(new Image).src=i.show_url,this.domElem.appendTo($(".b-time-banner__place")),this.setMod("type",e),this.bindTo("close","click",this.close),this.elem("inner").html(home.view("b-time-banner__inner",{type:e,text:i.text,helpUrl:t.helpUrl,helpQuery:t.helpQuery,now:this._convertTimestampToString(1e3*t.now),timestamp:this._convertTimestampToString(home.now())})),this.elem("close").attr("data-statlog","wrong_date."+e+".close"),this.setMod("shown","yes"),this.domElem.parents(".b-stripe-wrapper").show()},close:function(){this.setMod("shown","no"),(new Image).src=this.params.typeData.close_url},getDefaultParams:function(){var t=Math.round((new Date).getTime()/1e3),e=this._params,i=e.alert||{},n=!(!i.show||!(i.till_ts>t||i.from_ts&&i.from_ts<t))&&"alert";return{now:t,type:n,typeData:e[n]}},_convertTimestampToString:function(t){var e=new Date(t);return(Math.abs(this.params.now-this.params.timestamp)<15379200?home.l10n("time-alert.date_format_short"):home.l10n("time-alert.date_format_long")).replace("%day",e.getDate()).replace("%month",home.l10n("spok_yes.month_accus."+(e.getMonth()+1))).replace("%year",e.getFullYear())}}),BEM.DOM.decl("win10-stripe",{onSetMod:{js:function(){this.bindToWin("scroll",this.fixScroll);var t=BEM.blocks["media-infinity-footer"];t&&t.on("toggleFooter",function(t,e){this.toggleMod("collapsed","yes","",e)},this)}},fixScroll:function(){var t;t=window.pageXOffset,this.domElem.css({marginLeft:"-"+t+"px"})}}),$(function(){BEM.afterCurrentEvent(function(){BEM.DOM.init()})}),BEM.DOM.decl("content-tabs",{onClick:function(t,e){var i=e.closest(".content-tabs__head-item");this.hasMod(i,"active","true")||(this.switchTo(i),t.preventDefault())},toggleTab:function(t,e,i){var n=t.data("stat"),s=t.find(".content-tabs__link");this.toggleMod(t,"active","true","false",e),s.attr("aria-selected",e?"true":"false"),s.attr("tabindex",e?"0":"-1"),this.saveTab(t),n&&e&&!1!==i&&home.stat.logPath("click",n)},togglePanel:function(t,e){this.toggleMod(t,"active","true","false",e),t.attr("aria-hidden",e?"false":"true")},switchTo:function(t,e){e=e||{};var i=t.attr("id"),n=!1!==e.focus;this.toggleTab(this.elem("head-item","active","true"),!1),this.toggleTab(t,!0,e.stat),this.togglePanel(this.elem("items","active","true"),!1),this.togglePanel(this.domElem.find("#"+i+"c"),!0),n&&t.find(".content-tabs__link").focus(),this.trigger("switch",i),!1!==e.stat&&(home.stat.logDOMShow(this.domElem),BEM.blocks["tabs-stat"].sendTabStat(t))},getFrame:function(){var t=this.elem("frame");return t&&t.length||(t=$('<iframe style="display:none" class="content-tabs__frame" name="content-tabs__frame"></frame>'),this.domElem.append(t),this.dropElemCache("frame")),t},saveTab:function(t){var e=t.data("save-url");e&&this.getFrame().attr("src",e)},selectRelative:function(t){var e=this.elem("head-item"),i=this.elem("head-item","active","true"),n=$.inArray(i[0],e)+t;return n>=e.length?n=0:n<0&&(n=e.length-1),this.switchTo(e.eq(n)),!1},selectFirstTab:function(t){var e=this.elem("head-item");return this.switchTo(e.eq(0),{stat:t}),!1},selectLastTab:function(){var t=this.elem("head-item");return this.switchTo(t.eq(t.length-1)),!1}},{_selectedTabs:{},live:function(){$("body").on("click",".content-tabs__link",function(t){var e=$(t.target);e.closest(".content-tabs").bem("content-tabs").onClick(t,e)}),this.liveBindKey("link","left",function(){return this.selectRelative(-1)}),this.liveBindKey("link","right",function(){return this.selectRelative(1)}),this.liveBindKey("link","home",function(){return this.selectFirstTab()}),this.liveBindKey("link","end",function(){return this.selectLastTab()})}}),BEM.DOM.decl("content-tabs",{onSetMod:{js:{inited:function(){var t,e=this.params.storeClientTabs,i=this.__self._selectedTabs;e&&(e in i&&(t=$("#"+i[this.params.storeClientTabs],this.domElem)).length&&this.switchTo(t,{focus:!1}),this.on("switch",function(t,n){i[e]=n}))}}},brfix:1}),function(){"use strict";BEM.decl("tabs-stat",{},{sendTabStat:function(t){if(!t.attr("data-tabs-stat-sent")){var e=t.attr("data-tabs-stat"),i="/portal/log/json/?type=morda-topnews",n=!1;if(e&&e.length){if("sendBeacon"in navigator&&"FormData"in window){var s=new FormData;s.append("data",e),n=navigator.sendBeacon(i,s)}n||$.ajax({url:i,type:"POST",data:{data:e}}),t.attr("data-tabs-stat-sent","1")}}}})}(),BEM.DOM.decl("datetime",{onSetMod:{js:{inited:function(){var t=this;this._initDate(),this._prevDay=null,this._settedHour="",this._settedMin="",this._serverDate&&"Invalid Date"!==this._serverDate.toString()&&!isNaN(this._serverDate)&&(this.afterCurrentEvent(this._iterate),this._interval=setInterval(function(){t._iterate(),t._blink()},1e3))}}},destruct:function(){clearInterval(this._interval),this.__base.apply(this,arguments)},_initDate:function(){this._serverDate=this.params.timestamp?new Date(this.params.timestamp+" GMT+0000"):null,this._loadDate=new Date},_iterate:function(){var t=new Date,e=new Date(this._serverDate.getTime()+(t.getTime()-this._loadDate.getTime()));this._proceedNewDate(e,t)},_proceedNewDate:function(t){var e,i;0===t.getUTCHours()&&0===t.getUTCMinutes()&&this._proceedNextDay(t),e=this._format(t.getUTCHours()),i=this._format(t.getUTCMinutes()),e===this._settedHour&&i===this._settedMin||(this._settedHour=e,this._settedMin=i,this.elem("hour").text(e),this.elem("min").text(i))},_proceedNextDay:function(t){var e=t.getDay();this._prevDay===e||this.hasMod("time-only","yes")||(this._drawNextDay(t,e),this._prevDay=e)},_drawNextDay:function(t,e){var i=this.findElem("date"),n=home.getData("datetime.data",{}),s=this.hasMod("short","yes")?n.monthShortArr:n.monthArr;i.length&&s&&i.replaceWith(home.view("datetime__date",{day:t.getDate(),month:s[t.getMonth()],wday:n.weekArr[e]}))},_format:function(t){return t>9?""+t:"0"+t},_blink:function(){this.toggleMod("time-hidden","yes")}}),BEM.DOM.decl({block:"news",modName:"animation",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=this.findBlockOutside("widgets"),e=t&&t.params.editMode,i=this.findBlockOutside("widget"),n=i&&i.getInstance(),s=!n||n.getValue("autoreload");!e&&s&&"false"!==s&&this.initAnimation()}}},destruct:function(){this.deinitAnimation()},_onTabSwitch:function(){this._stopRotation(),this._startRotation()},_onVisibilityChange:function(t,e){e.hidden?this._stopRotation():this._startRotation()},initAnimation:function(){var t=this.domElem.find(".news__animation-list .list__item-content");this._timeout=setTimeout(this.changeThis(function(){this._rotate(),this._startRotation()}),this.params.firstInterval),this.findBlockInside("content-tabs").on("switch",this._onTabSwitch,this),this.channel("sys").on("visibilitychange",this._onVisibilityChange,this),this.bindTo(t,"pointerenter",this._stopRotation),this.bindTo(t,"pointerleave",this._startRotation)},deinitAnimation:function(){this.findBlockInside("content-tabs").un("switch",this._onTabSwitch,this),this.channel("sys").un("visibilitychange",this._onVisibilityChange,this),this._stopRotation(),this.__base.apply(this,arguments)},_startRotation:function(){this._interval||(this._interval=setInterval(this._rotate.bind(this),this.params.interval))},_stopRotation:function(){this._interval&&(clearInterval(this._interval),this._interval=null),this._timeout&&(clearTimeout(this._timeout),this._timeout=null)},_rotate:function(){var t=this.findElem(this.domElem.find(".content-tabs__items_active_true"),"animation-list");if(t.length){var e=t.find(".list__item"),i=e.filter(".list__item_fade_in"),n=i.next();n.length||(n=e.eq(0)),n.addClass("list__item_fade_in"),i.removeClass("list__item_fade_in").addClass("list__item_fade_out"),setTimeout(function(t){t.removeClass("list__item_fade_out")}.bind(this,i),this.__self.ANIMATION_DURATION)}}},{ANIMATION_DURATION:400}),BEM.DOM.decl("inline-stocks",{onSetMod:{js:function(){this.bindMouseEvents(),this.xivainitTimer=setTimeout(this.changeThis(this.initXiva),6e4)}},bindMouseEvents:function(){if(!window.device){var t={name:"hint",val:"visible",elem:".inline-stocks__item"};this.bindTo("item","mouseenter",this.getOnmouseenter(t)),this.bindTo("item","mouseleave",this.getOnmouseleave(t))}},getOnmouseenter:function(t){return function(e){var i=this;t.countdown||(t.countdown=setTimeout(function(){if(t.countdown=null,t.elem){var n=$(e.target).closest(t.elem);i.setMod(n,t.name,t.val)}else i.setMod(t.name,t.val)},t.delay||250))}},getOnmouseleave:function(t){return function(e){if(clearTimeout(t.countdown),t.countdown=null,t.elem){var i=$(e.target).closest(t.elem);this.delMod(i,t.name)}else this.delMod(t.name)}},initXiva:function(){var t=this;(home.getData("inline-stocks.xivas")||[]).forEach(function(e){BEM.blocks["i-xiva"].listen(e.ch,e.ts,function(e){t.updateFunc(e.dt)})})},updateFunc:function(t){if(t&&t.id){var e=t.id,i=this.elem("item","id",e),n=home.getData("inline-stocks.deltaExps",{}),s={up:"up",down:"down"};if(i.length){(t=t.data&&t.data[0]).inverse_color&&(n.ratesInverse||n.ratesInverseLimit)&&(s.up="down",s.down="up"),$(".inline-stocks__value_inner",i).html(t.value);var o=this.findElem(i,"cell","type","delta"),r=this.findElem(i,"cell","type","delta-label");if(t.delta){var a=Number((t.delta||"").replace("","-").replace(/[+%]/g,"").replace(",","."));this.delMod(o,"hidden"),o.html(t.delta),r.html(t.delta.replace("","-")),this.setMod(o,"delta",t.is_hot&&!n.ratesInverseLimit?"hot":"small"),a>0?this.setMod(o,"change",s.up):a<0?this.setMod(o,"change",s.down):this.delMod(o,"change")}else this.setMod(o,"hidden","yes"),r.html("");var c=home.getData("inline-stocks.alts")||{};c[e]&&$(".inline-stocks__item__baloon_inner",i).html(c[e].replace("%d",t.date).replace("%t",t.time))}}}}),BEM.DOM.decl({block:"inline-stocks",modName:"new",modVal:"yes"},{onSetMod:{js:function(){this.__base(),this.bindTo("more","pointerclick",this.toggleMore),this.bindKeyTo("more","space enter",this.toggleMore),this.__self.popup&&this.__self.popup.domElem||this.createPopup(),this.__self.popup.setAnchor(this.domElem),this.__self.reloaded&&(this.toggleMore(),this.__self.reloaded=!1)}},toggleMore:function(){this.__self.popup.getMod("visible")||this.__self.reloaded||this.onShow(this.__self.popup),this.__self.popup.toggleMod("visible","yes")},onShow:function(t){var e=this;if(!this.data||this.data&&this.datats&&Number(new Date-this.datats)>6e4)return e.toggleState("load"),$.ajax({url:this.params.stocksUrl,dataType:"json",success:function(i){i&&i.Stocks?(e.needTopNewsUpdate&&(e.needTopNewsUpdate=!1,e.updateTopNews()),e.datats=Number(new Date),e.data=i,e.createTable(i,t),e.onShow(t)):e.toggleState("error")},error:function(){e.toggleState("error")}});this.toggleState("tables"),home.stat.logDOMShow(t.domElem,{visibilityCheck:!1}),this.__self.popup._unbindFocusEvents(),this.__self.popup._bindFocusEvents()},createPopup:function(){var t=this,e=-25,i=this.domElem.offset().left,n=$(document.body).width();i>n/2&&(e=Math.floor(n/3)-i);var s=this.params.editShow,o=$(BEMHTML.apply({block:"popup2",mods:{view:"default",theme:"normal",autoclosable:"yes","alt-shadow":"yes",target:"anchor"},mix:"inline-stocks__popup-wrap",js:{directions:["bottom-left"],mainOffset:0,secondaryOffset:e},content:[{block:"inline-stocks",elem:"tune",tag:"a",cls:"b-widget__control"+(s?"":" inline-stocks__tune_hidden"),content:'<i class="b-ico widget__icon_prefs"></i>',attrs:{href:"?edit=1#open=_stocks","data-statlog":"news_rates_manual.popup.tune"}},{block:"inline-stocks",elem:"popup-close",tag:"span",attrs:{role:"button",tabindex:0}}]}));return this.__self.popupContent=this.elem("popup"),(o=this.findBlockInside(o,"popup2")).domElem.append(this.__self.popupContent),this.__self.popup=o,this.getInstance()&&this.bindTo(this.findElem(o.domElem,"tune"),"click",this.showForm),this.bindTo(this.findElem(o.domElem,"popup-close"),"click",this.toggleMore),this.bindKeyTo(this.findElem(o.domElem,"popup-close"),"space enter",this.toggleMore),o.on("beforeOpen beforeClose",function(){t._elemCache&&t.elem("more").attr("aria-expanded",this.getMod("visible")?"false":"true")}),o},templates:{val:function(t){return'<td><i class="inline-stocks__cell">'+t.value+"</i></td>"},delta:function(t,e){var i,n=home.getData("inline-stocks.alts");return e&&n&&(i=n.bigdiff.replace(/%d%(%)/,e+"$1")),t.delta?'<td><i class="inline-stocks__cell inline-stocks__cell_type_delta inline-stocks__cell_delta_'+(t.is_hot?"hot":"small")+'"'+(i&&t.is_hot?' title="'+i+'"':"")+' aria-hidden="true">'+t.delta+'</i><span class="a11y-hidden">'+String(t.delta).replace("","-")+"</span></td>":""},date:function(t){var e=t.datetime||t.time||t.date;return e?'<td><i class="inline-stocks__cell_datetime">'+e+"</i></td>":""}},rowsByType:{cash:function(t){return t.map(this.templates.val).join("")},currency:function(t,e){return t.map(function(t,i){return(i?this.templates.delta(t,e):"")+this.templates.val(t)},this).join("")},indexes:function(t,e){var i=t[0];return this.templates.date(i)+this.templates.delta(i,e)+this.templates.val(i)}},createTable:function(t){var e=this,i=home.view("inline-stocks__tables",t.Stocks),n=this.findElem(this.__self.popupContent,"tables");n.html(i),this.findElem(n,"table").each(function(){e.toggleTommorrowTitleVisibility($(this))})},toggleTommorrowTitleVisibility:function(t){var e=this.getMod(t,"type");if("indexes"!==e){var i=0;t.find("tr:not(.inline-stocks__head)").each(function(){var t=$(this).find("td").length;i<t&&(i=t)});var n="hide";(i>3&&"currency"===e||i>2&&"cash"===e)&&(n="show"),t.find(".inline-stocks__head .inline-stocks__cell:last")[n]()}},updateFunc:function(t){this.__base(t)},replaceCaps:function(t){return t.replace(/<(\w)>([^<]+)<\/\1>/g,function(t,e,i){switch(e){case"c":return'<span class="b-stocks__caps">'+i+"</span>";case"d":return'<span class="b-stocks__numbers">'+i+"</span>";default:return t}})},toggleState:function(t){this.setMod(this.__self.popupContent,"state",t)},getId:function(){return"_stocks-1"},getInstance:function(){return window.Widget&&Widget.Framework.get("_stocks-1")},showForm:function(t){var e=this;t.preventDefault(),this.toggleMore(),$(".b-wdgt-preferences").bem("b-wdgt-preferences").show($("#wd-wrapper-"+this.getId()).bem("widget"),function(){e.needTopNewsUpdate=!0,e.data=null,e.__self.reloaded=!0,e.onShow(e.__self.popup),e.__self.popup.setAnchor($(document.body))})},updateTopNews:function(){$("#wd-wrapper-_topnews-1").bem("widget").getInstance().reload(!1,!1,!0)}}),function(t,e,i){var n=t.INTERNAL,s=n.ELEM_DELIM,o={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1},r=n.buildClass,a=n.buildClasses,c={};function l(t,e,i){(t[e]||(t[e]=[])).unshift(i)}function h(t,e){return e.modName?function(i){(i._curBlock.mods||{})[e.modName]===e.modVal&&t(i)}:t}function u(t,i){var n,s=e.isArray(i);return e.isArray(t)?s?n=t.concat(i):(n=t).push(i):s?(n=i).unshift(t):n=[t,i],n}var d={'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;"},m=/["&<>]/g;t.HTML={decl:function(t,i){"string"==typeof t&&(t={block:t}),t.name&&(t.block=t.name);var n=c[t.block]||(c[t.block]={});i.onBlock&&l(n,"_block",h(i.onBlock,t)),i.onElem&&(e.isFunction(i.onElem)?l(n,"_elem",h(i.onElem,t)):e.each(i.onElem,function(e,i){l(n,"_elem"+("*"===e?"":s+e),h(i,t))}))},build:function(t){var e=new this.Ctx(t);return e._buildAll(),e._flush()},Ctx:e.inherit({__constructor:function(t){this._buffer=[],this._params=t,this._tParams=null,this._tParamsChanges=null,this._curBlock=void 0},pos:function(){return this._params._pos},isFirst:function(){return 1===this._params._pos},isLast:function(){var t=this._params;return t._pos===t._siblingsCount},params:function(t){return void 0===t?this._params:(this._params=t,this)},param:function(t,i,n,s){var o=this._params;return void 0===i?o[t]:(!n&&t in o?s&&(o[t]=e.extend(i,o[t])):o[t]=i,this)},attrs:function(t,e){return this.param("attrs",t,e,!0)},attr:function(t,e,i){if(void 0===e)return(this._params.attrs||{})[t];var n=this._params.attrs;return n?(i||!(t in n))&&(n[t]=e):(this._params.attrs={})[t]=e,this},tag:function(t,e){return this.param("tag",t,e)},cls:function(t,e){return this.param("cls",t,e)},mods:function(t,e){return this.param("mods",t,e,!0)},mod:function(t,e,i){if(void 0===e)return(this._params.mods||{})[t];var n=this._params.mods;return n?(i||!(t in n))&&(n[t]=e):(this._params.mods={})[t]=e,this},mix:function(t,e){var i=this._params;return void 0===t?i.mix:(i.mix=!e&&"mix"in i?i.mix.concat(t):t,this)},js:function(t){return this.param("js",t)},content:function(t,e){return this.param("content",t,e)},wrapContent:function(t){var e=this._params;return t.content=e.content,e.content=t,this},beforeContent:function(t){var e=this._params;return e.content=u(t,e.content),this},afterContent:function(t){var e=this._params;return e.content=u(e.content,t),this},wrap:function(t){var e=this._params;return t.block||(t._curBlock=this._curBlock),t.content=e._wrapper?e._wrapper:e,e._wrapper=t,this},tParam:function(t,e){var i=this._tParams||(this._tParams={});if(void 0===e)return i[t];var n=this._tParamsChanges||(this._tParamsChanges={});return t in n||(n[t]=i[t]),i[t]=e,this},generateId:function(){return e.identify()},stop:function(){this._params._isStopped=!0},_buildAll:function(){var t=this._buffer,i=this._params,n=typeof i;if("string"===n||"number"===n)t.push(i);else if(e.isArray(i))for(var s,o,r=0,a=i.length;r<a;)this._params=s=i[r++],"string"===(o=typeof s)||"number"===o?t.push(s):s&&(s._pos=r,s._siblingsCount=a,this._buildByDecl());else i&&(this._params._pos=this._params._siblingsCount=1,this._buildByDecl())},_build:function(){var t,i=this._buffer,n=this._params,s=n.tag||"div",c=n.block||n.elem,l=c&&(n.block||this._curBlock.block),h=!1;n.js&&((t={})[r(l,n.elem)]=!0===n.js?{}:n.js,h=!n.elem),i.push("<",s),(c||n.cls)&&(i.push(' class="'),c&&(a(l,n.elem,n.mods,i),n.mix&&e.each(n.mix,function(e,n){n&&(i.push(" "),a(n.block,n.elem,n.mods,i),n.js&&((t||(t={}))[r(n.block,n.elem)]=!0===n.js?{}:n.js,h||(h=!n.elem)))})),n.cls&&i.push(c?" ":"",n.cls),h&&i.push(" i-bem"),i.push('"')),t&&i.push(' onclick="return ',JSON.stringify(t).replace(m,function(t){return d[t]}),'"'),n.attrs&&e.each(n.attrs,function(t,e){void 0!==e&&null!==e&&!1!==e&&i.push(" ",t,'="',e.toString().replace(/"/g,"&quot;"),'"')}),o[s]?i.push("/>"):(i.push(">"),void 0!==n.content&&(this._params=n.content,this._buildAll()),i.push("</",s,">"))},_flush:function(){var t=this._buffer.join("");return delete this._buffer,t},_buildByDecl:function(){var t=this._curBlock,i=this._params;if(i._curBlock&&(this._curBlock=i._curBlock),i.block&&(this._curBlock=i),!i._wrapper){if(i.block||i.elem){var n,o=c[this._curBlock.block];if(o)if(i.elem?(n=o["_elem"+s+i.elem],o._elem&&(n=n?n.concat(o._elem):o._elem)):n=o._block,n)for(var r,a=0;(r=n[a++])&&(r(this),!i._isStopped););}if(i._wrapper)return i._curBlock=this._curBlock,this._params=i._wrapper,this._buildAll()}var l=this._tParamsChanges;if(this._tParamsChanges=null,this._build(),this._curBlock=t,l){var h=this._tParams;e.each(l,function(t,e){void 0===e?delete h[t]:h[t]=e})}}})}}(BEM,jQuery),BEM.DOM.decl("widget",{onSetMod:{js:function(){this.tuned=!1,this.altWidgets=home.getData("widgets.alt"),this._initWidget(),this.listenToXiva(),this.altWidgets?(this.hasMod("collapsed","yes")&&this.createControl(),this.bindTo("mouseenter focusin",function(){this.createControl()})):this.createControl(),this.channel("widget").on("hidePreferences",this.onHidePreferences,this),this.channel("widget").on("reload",this.onReload,this)},drag:{on:function(){this.createDrag(),this.getInstance().stopAutoReload()},"":function(){this.getInstance().queueAutoReload()}},removed:function(t,e){var i=this.getInstance(),n="yes"===e;i&&(i.params.removed=n),this.altWidgets&&this.setMod("alt-removed","yes"),this.channel("widget").trigger("commit",{type:n?"remove":"recover",id:this.getId(),widget:this}),n?this.getInstance().stopAutoReload():this.getInstance().queueAutoReload()},state:{add:function(){this.getSaveButtons().appendTo(this.domElem),this.setMod("drag","on"),this.getInstance().stopAutoReload(),this.bindToWin("widgetLoaded",function(t){t.id===this.getId()&&(this.elem("buttons").height(41).height(40),this.elem("accept").focus())})},remove:function(){var t=this.__self.getRmPopup(),e=this.changeThis(function(){this.setMod("removed","yes")}),i=this.changeThis(function(){this.delMod("state")});t.show(this,e,i)},"":function(){this.elem("buttons").detach(),this.getInstance().queueAutoReload(),this.unbindFromWin("widgetLoaded")}}},_initWidget:function(){var t=this.params.initParams;t&&(this._instance=Widget.Bind(this.params.id,t.params))},destruct:function(){this.channel("widget").un("hidePreferences",this.onHidePreferences,this),this.__base.apply(this,arguments)},onHidePreferences:function(t,e){this===e.elem&&this.hasMod("state","add")&&!this.tuned&&this.abortAdd()},onReload:function(t,e){this.control2&&this.domElem.is(e.widget.$().parent())&&(this.control2=null,this.altWidgets&&this.hasMod("collapsed","yes")&&this.createControl())},createControl:function(){if(!this.control2&&!this.control){var t=this.getId(),e=this.altWidgets;if(!(e&&t.indexOf("_teaser")>-1)){var i,n,s,o=this.getInstance(),r={};o?(r=o.params,s=$(".widget[id*="+r.intclassid+"]:visible").length>1,i=!r.is_default||r.default_removable||s,n=r.havePrefsFrom&&r.isWidgetWorkNormal):(n=-1===["_afisha","_teaser","_geo","_stream_now"].indexOf(t),r.prefsUrl=e?"/?widget_edit=1#open="+this.params.id:"/?edit=1#open="+this.params.id,("_services"===t&&home.getData("widgets.disable_services_prefs")||"_weather"===t&&home.getData("widgets.disable_weather_prefs"))&&(n=null)),e?(this.control2=BEM.blocks["widget-control"].create(this.domElem,{name:this.params.id.replace(/^_/,"").replace(/-.+$/,""),statName:this.params.isWidgetList?"custom_widget":void 0,hidden:this.hasMod("collapsed","yes"),items:{hide:!this.params.isWidgetList,settings:n,settingsHref:r.prefsUrl,remove:this.params.isWidgetList},customItems:this._getMenuCustomItems()}),this.control2.on({settings:this.showPrefs,remove:this.remove,hide:this._toggle.bind(this,!1),show:this._toggle.bind(this,!0)},this)):(this.control=$(BEMHTML.apply({block:"widget",elem:"control",content:[n?{elem:"control-icon",href:r.prefsUrl,icon:"prefs",cls:"widget__prefs",attrs:{title:home.l10n("widgetcontrol.setup")}}:"",{elem:"control-icon",icon:"rm",cls:"widget__remove"+(i?"":" widget__remove-shy"),attrs:{title:home.l10n("widgetcontrol.delete")}}]})),this.domElem.append(this.control))}}},_getMenuCustomItems:function(){return[]},createDrag:function(){return this.elem("drag").length||(this.domElem.append('<div class="widget__drag"></div>'),this.dropElemCache("drag")),this.elem("drag")},getInstance:function(){return this._instance},getId:function(){return this.params.id||this.getInstance().id},markChanged:function(t,e){var i=this.getInstance();i&&i.markChanged(t,e),e&&(this.tuned=!0,this.channel("widget").trigger("tuned",{type:"tuned",elem:this}))},remove:function(){this.hasMod("drag","on")?this.setMod("removed","yes"):this.setMod("state","remove"),this.channel("widget").trigger("remove",{id:this.getId(),widget:this})},showPrefs:function(){if(!this.hasMod("mode","plain"))return this.__self.queryPrefs(this),!1},accept:function(){this.channel("widget").trigger("commit",{type:"add",id:this.getId()}),this.delMod("state")},getSaveButtons:function(){var t=this.elem("buttons");return t.length||(this.dropElemCache("buttons"),t=$(BEMHTML.apply({block:"widget",elem:"buttons",content:[{cls:"buttons-line",content:[{block:"button",mods:{theme:"pseudo-sharp",size:"line"},cls:"widget__reject",content:home.l10n("widgetbaloon.cancel")},{block:"button",mods:{theme:"action-sharp",size:"line"},cls:"widget__accept",content:home.l10n("widgetbaloon.keep")}]},this.hasMod("yandex")?"":{elem:"warn",content:home.l10n("securityMessages.noYandexWidgetAddedA")}]}))),t},abortAdd:function(){var t=this.getInstance();t&&(t.params.removed=!0),this.channel("widget").trigger("abort-add",{elem:this}),this.destruct()},listenToXiva:function(){var t=this.getInstance();this.params.xivas&&t&&t.params.rebind&&this.params.xivas.forEach(function(t){BEM.blocks["i-xiva"].listen(t.ch,t.ts,this.changeThis(function(){this.reloading||(this.reloading=!0,this.getInstance().iReload(this.changeThis(function(){this.reloading=!1})))}))},this)},reload:function(){this.getInstance().reload()},_toggle:function(t){this.toggleMod("collapsed","yes",!t),BEM.blocks["i-reposition-event"].trigger()}},{live:function(){return this.liveBindTo("force-remove","pointerclick",function(){this.setMod("removed","yes")}),this.liveBindTo("accept","pointerclick",function(){this.accept()}),this.liveBindTo("reject","pointerclick",function(){this.abortAdd()}),this.liveBindTo("remove","pointerclick",function(){this.remove()}),this.liveBindTo("prefs","pointerclick",function(){this.showPrefs()}),!1},queryPrefs:function(t){this.getPrefsPopup().show(t,function(){this.reload(),BEM.channel("widget").trigger("settingsSaved")})},getRmPopup:function(){return this.rmPopup||(this.rmPopup=$(".b-wdgt-remove").bem("b-wdgt-remove")),this.rmPopup},getPrefsPopup:function(){return this.prefsPopup||(this.prefsPopup=$(".b-wdgt-preferences").bem("b-wdgt-preferences")),this.prefsPopup}}),BEM.DOM.decl({name:"widget",modName:"name",modVal:"stocks"},{reload:function(){"_stocks-1"===this.params.id?this.reloadTopNews():this.__base.apply(this)},reloadTopNews:function(){$("#wd-wrapper-_topnews-1").bem("widget").getInstance().reload(!1,!1,!0)}}),BEM.DOM.decl({name:"widget",modName:"name",modVal:"topnews"},{onSetMod:{collapsed:function(t,e){this.__base.apply(this,arguments),this.channel("topnews").trigger("collapse",{collapse:"yes"===e})}}}),BEM.DOM.decl({name:"widget",modName:"name",modVal:"teaser"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.channel("topnews").on("collapse",function(t,e){this.toggleMod("mini","yes",e.collapse)},this)}}}}),BEM.DOM.decl({name:"widget",modName:"name",modVal:"geo"},{_getMenuCustomItems:function(){return[{id:"geo",icon:"geo",text:home.l10n("head.region"),href:home.getData("region.tuneUrl")}]}}),BEM.DOM.decl("widget-control",{onSetMod:{js:{inited:function(){this._statName=this.params.statName||home.view("widget-control__stat-map")[this.params.name]||this.params.name,this.bindTo("menu","pointerclick",this._createAndShowDropdown),this.bindKeyTo("menu","enter space",this._createAndShowDropdown)}},collapsed:function(t,e){var i=home.getData("media-grid."+("yes"===e?"blocks_fold_url":"blocks_unfold_url"));i&&((new Image).src=i+this.params.name)}},setRoot:function(t){this._$root=t},_updatePosition:function(){this._$root&&this.__self._findTitle(this._$root).append(this.domElem)},_createAndShowDropdown:function(t){if(t.preventDefault(),!this._popupInited){this._popupInited=!0;var e,i=this.elem("menu"),n=this.params.items,s=[];this.params.customItems&&this.params.customItems.forEach(function(t){s.push({text:t.text,icon:{mods:{glyph:t.icon}},elemMods:{type:"link"},href:t.href,attrs:{"data-type":t.id}})}),n.settings&&s.push({text:home.l10n("widgetcontrol.setup"),icon:{mods:{glyph:"settings"}},elemMods:{type:"link"},href:n.settingsHref,attrs:{"data-type":"settings"}}),n.hide&&s.push({text:home.l10n("widgetcontrol.hide"),icon:{mods:{glyph:"hide"}},elemMods:{type:"link"},attrs:{"data-type":"hide"}}),n.remove&&s.push({text:home.l10n("widgetcontrol.delete"),icon:{mods:{glyph:"delete"}},elemMods:{type:"link"},attrs:{"data-type":"remove"}}),s.forEach(function(t){t.attrs[home.stat.attr]=this._statName+".widget_control."+t.attrs["data-type"],t.href||(t.attrs.tabindex=0)},this),e=$(home.view("popup2",{mods:{view:"default",theme:"normal",target:"anchor",autoclosable:"yes","alt-shadow":"yes"},mix:"dropdown2__popup",attrs:{role:"menu"},directions:["bottom-left","top-left","left-left"],hasTail:!1,mainOffset:6,secondaryOffset:-10,content:home.view("menu",{mods:{type:"navigation",theme:"normal",view:"default",tone:"default",size:"m2"},items:[{items:s}]})})),i.append(e),BEM.DOM.init(e);var o=e.bem("popup2");o.onFirst("beforeOpen",function(){home.stat.logDOMShow(this.domElem)}),e.find(".menu").bem("menu").on("click",function(t,e){o.delMod("visible");var i=e.item.data("type");this.trigger(i),"hide"===i&&(this.setMod("collapsed","yes"),this._updatePosition(),home.stat.logPath("show",this._statName+".widget_control.show"))},this)}}},{_findTitle:function(t){for(var e=[".content-tabs__head",".weather__geo",".streamnow__tabs","h1:not(.a11y-hidden)","h2"],i=0;i<e.length;++i){var n=t.find(e[i]).filter(":visible");if(n.length)return n.eq(0)}return $()},create:function(t,e){var i=$(home.view("widget-control",{mods:{collapsed:e.hidden?"yes":void 0,"expanded-only":e.removeOnHide?"yes":"no"},params:e})),n=this._findTitle(t);setTimeout(function(){i.addClass("widget-control_animated_yes")},50),n.append(i),BEM.DOM.init(i);var s=i.bem("widget-control");return s.setRoot(t),s},live:function(){function t(t){this.trigger("show"),this.delMod("collapsed"),this._updatePosition(),t.preventDefault(),home.stat.logPath("click",this._statName+".widget_control.show")}this.liveBindTo("show","pointerclick",t),this.liveBindKey("show","enter space",t)}}),BEM.DOM.decl("dropdown2",{onSetMod:{js:{inited:function(){this._switcher=null,this._popup=null}},opened:{yes:function(){if(this.hasMod("disabled"))return!1;this.trigger("beforeOpen").getPopup().setAnchor(this.getSwitcher()).setMod("visible","yes").on("beforeClose",this._onPopupBeforeClose,this)},"":function(){this.trigger("beforeClose").getPopup().delMod("visible").un("beforeClose",this._onPopupBeforeClose,this)}},disabled:{"*":function(t,e){this.getSwitcher().setMod(t,e)},yes:function(){this.delMod("opened")}}},getPopup:function(){return this._popup||(this._popup=this.findBlockInside("popup2")),this._popup},getSwitcher:function(){return this._switcher||(this._switcher=this.findBlockInside(this.getMod("switcher"))),this._switcher},_onPopupBeforeClose:function(){this.delMod("opened")},_onSwitcherClick:function(t){this._switcher||(this._switcher=t.block),this.toggleMod("opened","yes")}},{live:!0}),BEM.DOM.decl("dropdown2",{_onSwitcherClick:function(){if(this.__base.apply(this,arguments),this._switcher){var t=this.getMod("opened")?"true":"false";(this._switcher.domElem||this._switcher).attr("aria-expanded",t)}}}),BEM.DOM.decl({block:"dropdown2",modName:"switcher",modVal:"elem"},{getSwitcher:function(){return this._switcher||(this._switcher=this.findElem("switcher")),this._switcher}},{live:function(){return this.liveBindTo("switcher","pointerclick",function(t){this._onSwitcherClick(t),t.preventDefault()}),this.liveBindKey("switcher","space enter",function(t){var e=this.elem("switcher").prop("tagName").toLowerCase();"button"!==e&&("a"!==e&&t.which===BEM.blocks.keycodes.ENTER||t.which===BEM.blocks.keycodes.SPACE)&&(this._onSwitcherClick(t),t.preventDefault())}),this.__base()}}),function(){var t=BEM.channel("i-reposition-event");BEM.channel("i-scroll-event").on("scroll",function(e,i){t.trigger("reposition",i)}),BEM.decl("i-reposition-event",{},{trigger:function(){t.trigger("reposition",$(window).scrollTop())}})}(),function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}BEM.DOM.decl("i-ua",{},{passiveEvents:t})}(),home.throttle=function(t,e,i){var n,s,o,r=null,a=0;i||(i={});var c=function(){a=!1===i.leading?0:(new Date).getTime(),r=null,o=t.apply(n,s),r||(n=s=null)};return function(){var l=(new Date).getTime();a||!1!==i.leading||(a=l);var h=e-(l-a);return n=this,s=arguments,h<=0||h>e?(r&&(clearTimeout(r),r=null),a=l,o=t.apply(n,s),r||(n=s=null)):r||!1===i.trailing||(r=setTimeout(c,h)),o}},function(){"use strict";BEM.decl("i-scroll-event",{},{init:function(){var t=BEM.channel("i-scroll-event"),e=home.throttle(function(){var e=$(n).scrollTop();t.trigger("scroll",e)},100),i=!!BEM.blocks["i-ua"].passiveEvents&&{passive:!0},n=this.getScrollElem(),s=function(t){var s="scroll"===t?n:window;"addEventListener"in window?s.addEventListener(t,e,i):s.attachEvent("on"+t,e)};s("scroll"),s("resize"),s("orientationchange")},getScrollElem:function(){return window}}),setTimeout(function(){BEM.blocks["i-scroll-event"].init()},0)}(),BEM.DOM.decl("teaser",{_install:function(){return this.params.yaCounterId&&(BEM.blocks["i-metrika"].add({id:this.params.yaCounterId,triggerEvent:!0}),this.params.bannerid&&BEM.blocks["i-bannerid"].save(this.params.bannerid)),!0}},{live:function(){return this.liveBindTo("link","pointerclick",function(){return this._install()}),!0}}),BEM.DOM.decl({block:"teaser",modName:"install",modVal:"inline"},{_install:function(){var t=this.params,e=t.counters||{};return this._inlineInstall||(this._inlineInstall=BEM.create({block:"i-inline-install",mods:{api:t.api}},$.extend(t,{callbacks:{yes:function(){e.install&&((new Image).src=e.install)},no:function(){e.cancel&&((new Image).src=e.cancel)}}}))),this._inlineInstall.request().fail(function(){window.location=t.url}),e.click&&((new Image).src=e.click),!1}}),BEM.decl({block:"i-inline-install",modName:"api",modVal:"chrome"},{_checkApi:function(){return!!window.chrome&&window.chrome.webstore&&window.chrome.webstore.install},_requestApi:function(t,e,i){window.chrome.webstore.install(t,e,i)}}),BEM.decl({block:"i-inline-install",modName:"api",modVal:"opera"},{_checkApi:function(){return!!window.opr&&window.opr.addons&&window.opr.addons.installExtension},_requestApi:function(t,e,i){window.opr.addons.installExtension(t,e,i)}}),BEM.DOM.decl({block:"teaser",modName:"install",modVal:"download"},{_install:function(){return this.__base.apply(this),this._downloadInstance||(this._downloadInstance=BEM.create("i-install-download",this.params)),this._downloadInstance.download(),!1}}),BEM.decl("i-install-download",{init:function(){var t=home.view("popup",{mods:{type:"download",position:"fixed","has-close":"yes"},mix:"i-install-download__popup i-bem",attrs:{"bem-js":home.getBEMParams({popup:{}})},content:home.view("i-install-download__content",this.params)});this._popup=BEM.DOM.append(BEM.DOM.scope,t).bem("popup"),this._popup.on("show",function(){$("body").addClass("b-page_overflow_hidden")}),this._popup.on("hide",function(){$("body").removeClass("b-page_overflow_hidden")}),this.inited=!0},download:function(){return this.inited||this.init(),this._download(),setTimeout(function(){this._popup.show({top:0})}.bind(this),500),this},_countDownload:function(){this.params.counters.click&&((new Image).src=this.params.counters.click)},_download:function(){var t=document.createElement("iframe");$(t).addClass("i-install-download__frame-hidden").attr("aria-hidden",!0).attr("name","install").attr("src",this.params.url).appendTo(BEM.DOM.scope),this._countDownload()}}),BEM.DOM.decl({block:"teaser",modName:"install",modVal:"zombie"},{_install:function(){var t=this.params.counters||{};return BEM.blocks["custom-protocol-detect"].protocolCheck(this.params.urlYabro,this._onProtocolDetectSuccess.bind(this),this._onProtocolDetectFail.bind(this)),t.click&&((new Image).src=t.click),!1},_onProtocolDetectSuccess:function(){this.trigger("request")},_onProtocolDetectFail:function(){window.location.href=this.elem("link").attr("href")}}),BEM.DOM.decl({block:"teaser",modName:"install",modVal:"stream"},{_install:function(){var t=this.params,e=t.counters||{};return BEM.blocks["stream-control"].process(t.stream),e.open&&home.stat.logPath("click",e.open),e.click&&((new Image).src=e.click),!1}}),CoversAPI.prototype._init=function(){var t=this;this.params=home.getData("coversAPI.data"),(this.params.forced||this.params.settings.autoload)&&$(function(){t.load({autostart:!0}),t.sendStats("forced.show")}),$(".covers-logo").click(function(){0===t.currentStatus?(t.load({autostart:!0}),t.sendStats("logo.show")):4===t.currentStatus&&(t.stop({fromEvent:!0}),t.sendStats("logo.hide"))});var e=this.getSearchForm(),i=!1;e.on("submit",function(){t.getSearchInput().bem("input").val()!==t.params.text||i||(i=!0,e.append('<input type="hidden" name="aoff" value="1"><input type="hidden" name="promo" value="supercover">'))})},CoversAPI.prototype.getSearchInput=function(){return $(".search2 .suggest2-form__input")},CoversAPI.prototype.getSearchForm=function(){return $(".search2")},CoversAPI.prototype._changeInputVal=function(t){this.getSearchInput().bem("input").val(t,{suggest:!1})},CoversAPI.prototype.submitForm=function(t){t||(t=this.params.text),this._changeInputVal(t),setTimeout(function(){this.getSearchForm().bem("suggest2-form").submit({prevent:!1})}.bind(this),200)},CoversAPI.prototype._setParams=function(t){this.params=t},CoversAPI.prototype._set=function(t){this.current&&this.stop(),home.covers[t.name]&&(this.current=t.name,this.currentStatus=0)},CoversAPI.prototype._getShare=function(t){var e=this;t&&!e.shareInstance&&($("body").append('<div id="covers-share"></div>'),$.getScript("//yastatic.net/share2/share.js").done(function(){e.shareInstance=new Ya.share2("covers-share",t)}))},CoversAPI.prototype.load=function(t){if(this.current&&0===this.currentStatus){if(!this.area&&!this.close){this.area=$('<div class="covers-parent"></div>');var e=!1;this.params.settings&&"white"===this.params.settings.close&&(e=!0),this.close=$('<a title="'+this.params.closeTitle+'" class="covers-close '+(e?"covers-close_white":"")+'"></a>'),$("body").append(this.area,this.close),this.close.on("click",$.proxy(function(){this.stop(),this.sendStats("close.hide")},this))}this._getShare(this.params.shareParams),$("body").addClass("covers-fade"),this.params.parent=this.area,this.currentStatus=1;var i=this;home.covers[this.current].load(this.params,function(e){i._loadHandler(e,t)})}},CoversAPI.prototype._loadHandler=function(t,e){t.status>0?(this.currentStatus=2,e.autostart&&this.start(e)):this.currentStatus=0},CoversAPI.prototype.start=function(t){if(2===this.currentStatus){this.currentStatus=3;var e=this;this.params.settings.noHide||($(".i-ua_browser_touch").length?$(".rows").css({overflowX:"hidden"}):$("body").addClass("covers-overflow"),$("body").addClass("covers-fade-on"),$(".covers-search").addClass("covers-search_hidden_yes")),this.params.settings.noSearchPhrase||this._changeInputVal(this.params.text),home.covers[e.current].start(e.params,function(i){e._startHandler(i,t)})}},CoversAPI.prototype._startHandler=function(t){t.status>0?this.currentStatus=4:this.currentStatus=0},CoversAPI.prototype.stop=function(t){if(4===this.currentStatus){this.currentStatus=5;var e=this;home.covers[this.current].stop(this.params,function(i){e.stopHandler(i,t)})}},CoversAPI.prototype.stopHandler=function(){this.area.remove(),this.close.remove(),this.area=null,this.close=null,$(".i-ua_browser_touch").length?$(".rows").css({overflowX:"visible"}):$("body").removeClass("covers-overflow"),$(".covers-search").removeClass("covers-search_hidden_yes"),$("body").removeClass("covers-fade covers-white_close covers-fade-on"),this.currentStatus=0},CoversAPI.prototype.sendStats=function(t){this.params.stat&&home.stat.logPath("click",this.params.stat+"."+t)},home.coversAPI=new CoversAPI,home.covers={},BEM.decl("videoplayer",{init:function(){return this.scope=BEM.DOM.scope,this.win=BEM.DOM.win,this.lastProgress=null,this.isTouch=$(".i-ua_browser_touch").length,this.$html=$(BEMHTML.apply({cls:"videoplayer__wrapper",content:{tag:"iframe",cls:"videoplayer__video",attrs:$.extend({name:"videoplayer"+(Math.random()+"").substr(3,7)},this.params)}})),this},show:function(){return this.scope.append(this.$html),this.isTouch&&(this.$html.get(0).scrollIntoView?this.$html.get(0).scrollIntoView():this.win.scrollTop(0)),$("html").addClass("videoplayer_active_yes"),this.scope.on("click",".videoplayer__wrapper",function(){home.stat.logPath("click","videoplayer.paranja"),this.hide()}.bind(this)),this.win.on("keydown",this.changeThis(this._escHandler)),this._addCheckEndHandler(),home.stat.logPath("show","videoplayer.paranja"),home.stat.logPath("click","videoplayer.actions.show"),this},hide:function(){return this.$html.detach(),$("html").removeClass("videoplayer_active_yes"),this.scope.off("click",".videoplayer__wrapper"),this.win.off("keydown",this.changeThis(this._escHandler)),this.lastProgress=null,this._removeCheckEndHandler(),home.stat.logPath("click","videoplayer.actions.hide"),this},_addCheckEndHandler:function(){window.addEventListener&&window.addEventListener("message",this.changeThis(this._checkEndHandler))},_removeCheckEndHandler:function(){window.removeEventListener&&window.removeEventListener("message",this.changeThis(this._checkEndHandler))},_checkEndHandler:function(t){var e=t.data;if(e&&"status"===e.action){if(0===e.progress&&this.lastProgress>95)return home.stat.logPath("click","videoplayer.events.end"),void this.hide();this.lastProgress=e.progress}},_escHandler:function(t){27===(t.keyCode||t.which)&&(home.stat.logPath("click","videoplayer.events.esc"),this.hide())}}),function(t,e){var i="function"==typeof window.navigator.sendBeacon;t||(t=window.Lego={}),!t.params&&(t.params={}),t.c=function(t,e,n){var s,o=function(t){return t.replace(/^(?:https?:)?\/\//,"")}((n=n||{}).host||BEM.blocks["i-global"].param("click-host")||"clck.yandex.ru"),r=function(t,e,i,n){return(e=e.replace("'","%27")).indexOf("/dtype=")>-1?e:location.protocol+"//"+o+"/"+i+"/dtype="+t+"/rnd="+((new Date).getTime()+Math.round(100*Math.random()))+(n?"/*"+(e.match(/^http/)?e:location.protocol+"//"+location.host+(e.match("^/")?e:"/"+e)):"/*data="+encodeURIComponent("url="+encodeURIComponent(e.match(/^http/)?e:location.protocol+"//"+location.host+(e.match("^/")?e:"/"+e))))},a=function(){return r(t,n.useLinkHref&&Object(e).href?e.href:location.href,"jclck")},c=function(){a();var t,e,n=!1;i&&(n=navigator.sendBeacon(a()," ")),n||(t=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],(e=document.createElement("script")).setAttribute("src",a()),t.insertBefore(e,t.firstChild))};if(e)if(!0===n.noRedirect||e.className.indexOf("link_pseudo_yes")>-1||e.href&&0===e.href.indexOf("mailto:"))c();else if(e.href)s=e.href,e.href=r(t,s,"redir"),setTimeout(function(){e.href=s},500);else if(e.form)e.type.match(/submit|button|image/)?(s=e.form.action,e.form.action=r(t,s,"redir",!0),setTimeout(function(){e.form.action=s},500)):c();else{if(!e.action)throw"counter.js: not link and not form!";e.action=r(t,e.action,"redir",!0)}else c()},t.cp=function(e,i,n,s,o,r){"string"==typeof s||(r=o,o=s,s=void 0),t.c("stred/pid="+e+"/cid="+i+(n?"/path="+n+(s?"/vars="+s:""):""),o,r)}}(window.Lego),window.Lego.cred=function(t,e,i){var n,s=function(){var e=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],i=document.createElement("script");i.setAttribute("src",t),e.insertBefore(i,e.firstChild)};if(e)if("A"===e.tagname&&!e.href||e.href&&e.href.match(/^mailto:/)||i&&!0===i.noRedirect)s();else if(e.href)n=e.href,e.href=t,setTimeout(function(){e.href=n},500);else if(e.form)e.type.match(/submit|button|image/)?(n=e.form.action,e.form.action=t,setTimeout(function(){e.form.action=n},500)):s();else{if(!e.action)throw"counter.js: not link and not form!";e.action=t}else s()},window.csh_ifgsid=csh_ifmsid,BEM.DOM.decl("home-tabs",{onSetMod:{js:function(){var t=this;this._searchInput=this.findBlockOutside($(".search2 .suggest2-form__input"),"input"),this._$elems=this.elem("search"),this._searchInput.on("change",$.debounce(function(){t._updateUrls(this.val())},300)),this.bindTo("more-switcher","click",this._createAndShowDropdown),this.bindKeyTo("more-switcher","space",this._createAndShowDropdown)}},_updateUrls:function(t){var e=this.params[t?"search":"href"],i=encodeURIComponent(t);this._$elems.each(function(t,n){$(n).attr("href",home.stringf(e[$(n).data("id")],i))})},_createAndShowDropdown:function(){if(!this._popupInited){this._popupInited=!0;var t,e=this.elem("more-switcher"),i=home.getData("home-tabs.additionalTabs");t=$(home.view("popup2",{mods:{view:"default",theme:"normal",target:"anchor",autoclosable:"yes","alt-shadow":"yes"},mix:"dropdown2__popup",attrs:{role:"menu"},directions:["bottom-center","top-center","left-center"],hasTail:!0,mainOffset:10,content:home.view("home-tabs__more",{top:home.view("home-tabs__more-tabs-top",i),bottom:home.view("home-tabs__more-tabs-bottom",i)})})),e.append(t),t.bem("popup2").onFirst("beforeOpen",function(){home.stat.logDOMShow(this.domElem)}),this._$elems=this._$elems.add(this.findElem(t,"search")),this._updateUrls(this._searchInput.val())}}}),function(){"use strict";var t=function(){$("[data-statlog-autoshow]").each(function(){var t=$(this),e=t.data("statlog");t.is(":visible")&&home.stat.logPath("show",e)})},e=function(e){e.enabled&&(t(),$(window).on("resize",$.debounce(t,150)))};$(function(){var t=home.getData("statlog.config",{});e(t)});var i=home.stat._setConfig;home.stat._setConfig=function(t){i(t),e(t)}}(),BEM.DOM.decl("search2",{onSetMod:{js:function(){var t=this;this.input=this.findBlockInside("input"),this.arrow=this.findBlockOutside("home-arrow"),this.arrow&&this.arrow.on("sample-click",function(){var e=t.domElem.find("input[name='nl']");t.params.nl&&!e.length&&$('<input type="hidden" name="nl" value="1"/>').insertAfter(t.input.domElem);var i=t.domElem.find("input[name='example_source']");t.params.serpArg&&!i.length&&$('<input type="hidden" name="example_source" value="'+t.params.serpArg+'"/>').insertAfter(t.input.domElem),$("body").hasClass("edit-mode")||$("body").hasClass("b-page_skins-calatog")||setTimeout(function(){t.domElem.submit()},500)})}}}),BEM.decl("i-common__string",{},{cleverSubstring:function(t,e,i){return t.length>e+i?t.substring(0,e-1)+"":t},escapeHTML:function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"};return function(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return t[e]||e})}}(),escapeRegExp:function(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this._val=this.elem("control").val()}},disabled:{"*":function(t,e){this.elem("control").prop("disabled",e)},yes:function(){this.delMod("focused")}},focused:function(t,e){if(this.hasMod("disabled"))return!1;e?this._focused||this._focus():this._focused&&this._blur(),this.afterCurrentEvent(function(){this.domElem&&this.trigger(e?"focus":"blur")})}},isDisabled:function(){return this.hasMod("disabled","yes")},val:function(t,e){var i=void 0!==t,n=this.elem("control");return t=i?null===t?"":t.toString():n.val(),this._val!==t&&(this._val=t,n.val()!==t&&n.val(t),this.trigger("change",e)),i?this:t},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},getSelectionEnd:function(){var t=this.elem("control")[0],e=0;if("number"==typeof t.selectionEnd)e=t.selectionEnd;else{var i=document.selection.createRange();if(i&&i.parentElement()===t){var n=t.value.length,s=t.createTextRange();s.moveToBookmark(i.getBookmark());var o=t.createTextRange();o.collapse(!1),e=s.compareEndPoints("EndToEnd",o)>-1?n:-s.moveEnd("character",-n)}}return e},_onFocus:function(){if(parseInt(BEM.blocks["i-ua"].ios,10)>=8&&!this.hasMod("type","textarea")){var t=this.elem("control")[0];t.selectionStart===t.value.length&&(t.scrollLeft=t.scrollWidth)}return this._focused=!0,this.setMod("focused","yes")},_onBlur:function(){return this._returnFocus?(this.afterCurrentEvent(function(){this.domElem&&this._focus()}),this):this.hasMod(this.elem("clear"),"pressed")?this:(this._focused=!1,this.delMod("focused"))},_focus:function(){if(this.hasMod("disabled","yes"))return!1;this.elem("control").focus()},_blur:function(){this._returnFocus=!1,this.elem("control").blur()},_updateVal:function(){this.val(this.elem("control").val())},destruct:function(){this._blur(),this.__base.apply(this,arguments)}},{live:function(){this.liveBindTo("control","focusin focusout",function(t){this["focusin"===t.type?"_onFocus":"_onBlur"](t)}),this.liveBindTo("control","input",function(){this._updateVal()}),9===document.documentMode&&(this.liveBindTo("control","focusin",function(){this.bindToDoc("selectionchange",this._updateVal)}),this.liveBindTo("control","focusout",function(){this.unbindFromDoc("selectionchange")}))}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=this.elem("control"),e=$.dom.getActiveElement(),i=this.params.autoFocus&&!e.is("input, textarea");(e[0]===t[0]||i)&&(this.setMod("focused","yes")._focused=!0),this.params.shortcut&&this.bindToDoc("keydown",function(t){t.ctrlKey&&t.which===BEM.blocks.keycodes.UP&&!$(t.target).is("input, textarea")&&this.setMod("focused","yes")})}}},_focus:function(){if(!1===this.__base())return!1;var t=this.elem("control")[0];if(t.createTextRange&&!t.selectionStart){var e=t.createTextRange();e.move("character",t.value.length),e.select()}},destruct:function(){this.params.shortcut&&this.unbindFromDoc("keydown"),this.__base.apply(this,arguments)},_onPointerenter:function(t){this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")},_updateValNextTick:function(){this.afterCurrentEvent(function(){this.domElem&&this._updateVal()})}},{live:function(){return this.liveBindTo("box","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("box")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}),this.liveBindTo("control","dragenter"),this.liveBindTo("control","dragend",function(){this._updateValNextTick()}),"documentMode"in document&&document.documentMode<=8&&(this.liveBindTo("control","focusin",function(){this.bindTo("control","propertychange keyup",this._updateVal),this.bindTo("control","cut paste",function(){this._updateValNextTick()})}),this.liveBindTo("control","focusout",function(){this.unbindFrom("control","cut paste"),this.unbindFrom("control","propertychange keyup"),this._updateValNextTick()})),this.__base()}}),BEM.DOM.decl("input",{_onIOSTouchStart:function(){}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("clear","pointerclick",function(t){t.preventDefault()})}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.on("change",this._updateClear)._updateClear()}}},_onClearClick:function(){return this.trigger("clear"),this.removeInsets&&this.removeInsets(),this.clearInput({source:"clear"})._focus()},clearInput:function(t){return this.val("",t),this},_updateClear:function(){return this.toggleMod(this.elem("clear"),"visibility","visible",Boolean(this._val))}},{live:function(){return this.liveBindTo("clear","pointerpress",function(t){this.setMod(this.elem("clear"),"pressed","yes")}).liveBindTo("clear","pointerover",function(t){this.setMod(this.elem("clear"),"hovered","yes")}).liveBindTo("clear","pointerout",function(t){this.delMod(this.elem("clear"),"hovered")}).liveBindTo("clear","pointerclick",function(){this.delMod(this.elem("clear"),"pressed"),this._onClearClick()}).liveBindTo("control","paste",function(){this.setMod(this.elem("clear"),"visibility","visible")}),this.__base()}}),function(){var t=/^[a-z-]$/i,e=/^[0-9]$/;BEM.DOM.decl({name:"input",modName:"autofocus",modVal:"capture"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.bindToDoc("keydown",this._autoFocusBind)},autofocus:{yes:function(){this.bindToDoc("keydown",this._autoFocusBind)},"":function(){this.unbindFromDoc("keydown")}},listen:{yes:function(){this.bindToDoc("keydown",this._autoFocusBind)},no:function(){this.unbindFromDoc("keydown")}}},_autoFocusBind:function(i){var n;if(!$(".popup_visibility_visible").filter(":not(.b-topbar__popup, .suggest2)").length&&(!(n=$(".v_sform_bg")).length||"none"===n.css("display"))&&!$(".left-banner-opened").length&&!$(".stream_visibility_visible").length&&this.domElem.is(":visible")){var s,o;try{s=document.activeElement.tagName.toLowerCase(),o=document.activeElement.getAttribute("contenteditable")}catch(t){}if(function(i){if(i.originalEvent&&!("altKey"in i.originalEvent))return!1;var n,s,o=i.charCode||i.keyCode||i.which||0,r=i.ctrlKey||i.altKey||i.metaKey;return i.originalEvent&&i.originalEvent.key?(s=t.test(i.originalEvent.key),n=e.test(i.originalEvent.key)):(s=[o>=65&&o<=90,o>=1025&&o<=1071,0===o,231===o,186===o,188===o,190===o,String.fromCharCode(o).toLowerCase()!==String.fromCharCode(o).toUpperCase()].some(Boolean),n=o>=48&&o<=57||o>=96&&o<=105),!r&&(n||s)}(i)&&"input"!==s&&"textarea"!==s&&!o){this.trigger("beforeFocus");var r=this.elem("control")[0],a=this.val();if(a.length>0&&" "!==a.slice(-1)&&(a+=" ",this.val(a)),r.createTextRange){var c=r.createTextRange();c.collapse(!1),c.select()}else r.selectionStart&&(r.focus(),r.setSelectionRange(a.length,a.length));this.setMod("focused","yes")}}}})}(),BEM.DOM.decl({name:"input",modName:"ahead",modVal:"yes"},{onSetMod:{js:function(){var t=$.browser&&$.browser.opera&&$.browser.version<12.1?"keypress":"keydown";this.__base(),this._leftPadding=parseInt(this.elem("input").css("border-left-width"),10),this._buildAhead(),this._intent=!1,this._preventAhead=!1,this._lastBackspace=0,this.on("change",this._onTextChange).bindTo("click",this._onClickOver).bindTo(t,this._onKeyDown)}},_onClickOver:function(t){var e=this;if(!this._preventAhead&&this.elem("input").is(t.target)){var i=t.pageX-this.domElem.offset().left-this._leftPadding,n=this.elem("ahead-filler").width(),s=this.elem("ahead-hintholder").width();i>n&&i<s&&(this.trigger("ahead-click"),setTimeout(function(){e._fill({usage:"mouse"})},0))}},_onKeyDown:function(t){switch(this.__base.apply(this,arguments),new Date-this._lastBackspace>this.params.backspaceDelay&&(this._preventAhead=!1),t.which){case 8:if(!this.params.hideOnBackspace)break;this._preventAhead=!0,this._lastBackspace=new Date,this._intent=this._clearAhead();break;case 9:this.hasMod("focused","yes")&&this._intent&&!t.ctrlKey&&!t.altKey&&(t.preventDefault(),this._fill({usage:"tab"}));break;case 39:this.val().length===this.getSelectionEnd()&&this._fill({usage:"arrow"})&&t.preventDefault()}},setAhead:function(t){var e;return!this._preventAhead&&(e=this.val(),0!==t.indexOf(e)?this._clearAhead():void(this._intent=this._setAhead(e,t.slice(e.length))))},unsetAhead:function(){this._clearAhead(),this._intent=!1},_onTextChange:function(){var t=this.val().length;this.shiftAhead(t),this._intent&&0!==this._intent.indexOf(this.val())&&this._clearAhead()},_fill:function(t){var e=this.val(),i=$.extend(t,{chars:this._intent.length-e.length});if("string"==typeof this._intent&&i.chars>0&&0===this._intent.indexOf(e)){try{var n=document.createEvent("TextEvent");n.initTextEvent("textInput",!0,!0,null,this._intent.slice(this.val().length),9),this._input.selectionEnd=this._input.selectionStart=this._intent.length,this._input.dispatchEvent(n)}catch(t){var s=this.elem("control").get(0);if(this.val(this._intent),s.createTextRange){var o=s.createTextRange();o.moveEnd("character",this._intent.length),o.collapse(!1),o.select()}else try{s.selectionEnd=s.selectionStart=this._intent.length}catch(t){}}this.trigger("ahead-fill",i),home.stat.logPath("tech","suggest.ahead."+t.usage)}return i.chars>0},getSelectionEnd:function(){var t=this.elem("control")[0],e=0;if("number"==typeof t.selectionEnd)e=t.selectionEnd;else{var i=document.selection.createRange();if(i&&i.parentElement()===t){var n=t.value.length,s=t.createTextRange();s.moveToBookmark(i.getBookmark());var o=t.createTextRange();o.collapse(!1),e=s.compareEndPoints("EndToEnd",o)>-1?n:-s.moveEnd("character",-n)}}return e},getDefaultParams:function(){return $.extend(this.__base(),{backspaceDelay:100,hideOnBackspace:!0})},_buildAhead:function(){this._ahead=$(home.view("input__ahead")),BEM.DOM.before(this.elem("control"),this._ahead)},_setAhead:function(t,e){var i=this.elem("ahead-filler");return this._preventAhead?(t="",e=""):(t=t||"",e=e||""),i.text(t),this.elem("ahead-hintholder").text(t+e),this.elem("ahead-hint").val(t+e),this.elem("ahead").css("clip","rect(auto auto auto "+(i.width()+this._leftPadding)+"px)"),t+e},_clearAhead:function(){return this._setAhead("",""),!1},shiftAhead:function(t){if(this._intent){var e=this._intent.slice(0,t),i=this._intent.slice(t);this._setAhead(e,i)}}}),BEM.DOM.decl({block:"input",modName:"keyboard",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),$(window).bind("keyboardOpened.lego",this.changeThis(function(){this.setMod("focused","yes")._focused=!0}))}},onElemSetMod:{clear:{visibility:function(t,e,i){this.__base.apply(this,arguments),this.hasMod("clear","yes")&&this.toggleMod("keyboard-visibility","hidden","visible"===i)}}}}),BEM.DOM.decl("keyboard-loader",{onSetMod:{js:function(){var t=this;Lego.block["keyboard-loader"].call(this.domElem,this.params),$(window).on("keyboardOpened.lego",function(){home.stat.logPath("click",t.params.statOpen),t.getVkbd().removeAttr("disabled")}).on("keyboardClosed.lego",function(e){"lego"===e.namespace&&home.stat.logPath("click",t.params.statClose),t.getVkbd().attr("disabled","disabled")})}},getVkbd:function(){return this._vkbd?this._vkbd:this._vkbd=$('<input type="hidden" name="vkbd" value="1"/>').appendTo(this.domElem)}}),function(t,e){e||(e=window.Lego={}),e.block||(e.block={}),e.block["keyboard-loader"]=function(i){var n=t(document.body),s=t(window),o=this,r=t(".b-topbar__popup.popup_behavior_snap"),a=r.length?r.bem("popup"):null;function c(i){t("body").removeClass("b-page_keyboard");var o=i?"addClass":"toggleClass",r=n.find(".keyboard-popup");if(r.length){if(n.find(".keyboard-popup__gap")[o]("keyboard-popup__gap_hidden_yes"),n.find(".keyboard-popup")[o]("keyboard-popup_hidden_yes").hasClass("keyboard-popup_hidden_yes")){s.trigger("keyboardClosed"),t(document).trigger("popupsClose.lego");var a=e.block.keyboard._lastFocusedIn;void 0!==a&&a.focus()}else s.trigger("keyboardOpened.lego");r.data("isHidden",!1)}}o.click(function(o){o.preventDefault(),a&&a._unbindFromResize();var r=(this.className.match(/keyboard-loader_lang_(\w+)/)||["",""])[1];n.find(".keyboard")[0]?(c(),a&&a._bindToResize()):home.bundles.load("keyboard").then(function(){e.block["keyboard-popup"]({lang:r,for:i.for}),n.append('<div class="keyboard i-bem" data-bem=\'{&quot;keyboard&quot;: { &quot;lang&quot;:&quot;'+r+"&quot;}}'></div>"),BEM.DOM.init(t(".keyboard")),s.trigger("keyboardOpened.lego",{afterLoad:!0}),t(".keyboard").on("click",".keyboard__key",function(){var e,i=t("*:focus").offset();i&&(e=i.top,t(".keyboard-popup").offset().top<e+30&&window.scrollTo(0,e-20))})}).catch(function(t){home.error.logError({block:"keyboard-loader",message:"_downloadResources: fail"},t)})}),s.bind("keyboardOpen.lego",function(){o.click()}).bind("keyboardClose.lego",c),i.for&&s.bind("keyboardOpened.lego",function(e,n){!(n&&n.afterLoad&&i.autoLoad)&&t(i.for).focus()}),s.bind("keyboardLangChanged.lego keyboardSetLang.lego",function(t,e){var i=o.find(".keyboard-loader__flag");i[0]&&("tt"===e&&(e="ru"),i.attr("src",i.attr("src").replace(/[a-z]+\.png$/,e+".png")))}),i.storeState=!1!==i.storeState,i.storeState&&s.bind("keyboardOpened.lego",function(){d("keyboard_state","open");var e=h("keyboard_lang");e&&t(window).trigger("keyboardSetLang.lego",e)}).bind("keyboardClosed.lego",function(){t("body").removeClass("b-page_keyboard"),d("keyboard_state","close")}).bind("keyboardLangChanged.lego",function(t,e){d("keyboard_lang",e)});var l="#kb"===window.location.hash;function h(t){return u()[t]}function u(){var e={};return t.each(window.name.split("&"),function(){if(this.toString()){var t=this.split("=");e[t[0]]=t[1]}}),e}function d(e,i){var n=u(),s=[];n[e]=i,t.each(n,function(t,e){s.push(t+"="+e)}),window.name=s.join("&")}(i.autoLoad||i.storeState&&"open"===h("keyboard_state")||l)&&o.click(),s.bind("keyboardOpened.lego",function(){t("input:focus").focus(),t("body").addClass("b-page_keyboard")})}}(jQuery,window.Lego),BEM.DOM.decl("popup",{getDefaultParams:function(){return{zIndexGroupLevel:0,directions:[{to:"bottom",axis:"center",tail:{axis:"center"}},{to:"top",axis:"center",tail:{axis:"center"}},{to:"right",axis:"middle",tail:{axis:"middle"}},{to:"left",axis:"middle",tail:{axis:"middle"}}],tail:{width:24.04,height:12.02,offset:{left:15,right:15,top:15,bottom:15}},duration:150}},onSetMod:{js:{inited:function(){this._cache={},this._viewport=BEM.DOM.win,this._scope=BEM.DOM.scope,this._channel=BEM.channel("popups"),this._inContainer=!1,this._isParentFixed=!1,this._owner=null,this._destructor=null,this._userPosition=null,this._parent=null,this._childs=[],this._isShown=!1,this._isHiding=!1,this._positions={},this._currPos={},this._visibilityFactor=null,this._direction=!1,this._directions={};var t=this.getDefaultParams(),e=this.params,i=this._repackDirParams(t.directions),n=e.generateDirections?this._generateDirections:e.directions,s=this._repackDirParams(n);e.tail&&(this.params.tail=this._mergeParams(t.tail,e.tail)),this._order=s.keys.map(function(t){var e=s.directions[t],n=i.directions[t];return n||(n=i.directions[e.to]),this._directions[t]=this._mergeParams(n,e,{tail:this._tailParamsHook}),t},this),this._zIndex=null,this._zIndexGroupLevel=null}},visibility:{visible:function(){this._onShown()},"":function(){this._onHidden()}}},show:function(t){var e;if(t instanceof BEM)e=t.domElem.eq(0);else if(t instanceof $)e=t;else if(!t)return;if(e){if(this._owner&&e[0]!==this._owner[0]&&this.delMod("visibility"),this._owner=e,e.length){var i="_"+this.__self.getName()+"-destructor";this._destructor=e.addClass("i-bem "+i).bem(i)}var n=this._findParent(e);n&&this.setParent(n)}else this._userPosition=t;return this.setMod("visibility","outside").repaint()},hide:function(t){if(this._isHiding)return this;if(this._isShown){var e=$.Event("before-hide");if(this.trigger(e,t),e.isDefaultPrevented())return this;if(this._isHiding=!0,this._childs.forEach(function(t){t.hide&&t.hide(),t.delMod("visible")}),this.hasMod("animate","yes")&&!this.hasMod("fade-out","no")){var i=this;return this.beforeHide(function(){i.domElem&&i.delMod("visibility")}),this}}return this.delMod("visibility")},toggle:function(t,e){return this._isShown&&!this._isHiding?this.hide(e):this.show(t||this._owner)},repaint:function(){this._moveToContainer();var t=this._pickDirection();return this.setMod("to",t.to)._show(this._positions[t.key],this._tailPos&&this._tailPos[t.key]),this},getCurrPos:function(){return this._currPos},getCurrDirection:function(){return this._direction},setScope:function(t){return this._scope=t,this._inContainer=!1,this},setContent:function(t){return BEM.DOM.update(this.elem("content"),t),this._resetDefault(),this._isShown&&this.repaint(),this},isShown:function(){return this._isShown},setParent:function(t){return this._parent=t,this._isParentFixed=t.hasMod("position","fixed"),t.addChild&&t.addChild(this),this},addChild:function(t){for(var e=this._childs,i=e.length,n=0;n<i;n++)if(e[n]._uniqId===t._uniqId)return;t.on("hide",function(){this.removeChild(t)},this),t.on("beforeClose",function(){this.afterCurrentEvent(function(){this.removeChild(t)})},this),e.push(t)},_getParentPopup:function(){return this._parent},removeChild:function(t){for(var e=this._childs,i=e.length,n=0;n<i;n++)if(e[n]._uniqId===t._uniqId)return void e.splice(n,1)},setSize:function(t){return t&&(this._resetDefault(),this.domElem.css(t),this._isShown&&!this._isHiding&&this.repaint()),this},_show:function(t,e){return this._currPos=t,e&&this.elem("tail").removeAttr("style").css(e),this.domElem.css(t),(!this._isShown||this._isHiding)&&this.hasMod("animate","yes")&&!this.hasMod("fade-in","no")&&this.afterShow(),this._isHiding=!1,this.setMod("visibility","visible"),this},_onShown:function(){this._isShown||this._bindCompatibility(),this.bindToDoc("keydown",function(t){t.which===BEM.blocks.keycodes.ESC&&0===this._childs.length&&this.hide({source:"esc-key"})}),this._attachRepaintOnResize(),this._bindFocusEvents(),this._attachUnder(),this._isShown=!0,this.hasMod("autoclosable","yes")&&this.afterCurrentEvent(function(){this.domElem&&this._enableAutoclosable()}),this.hasMod("adaptive","yes")&&this._enableAdaptive(),this._channel.on("hide",this.hide,this),this.trigger("show")},_bindCompatibility:function(){this._captureZIndex(),this.__self._visiblePopupsStack.unshift(this),this.trigger("beforeOpen")},_unbindCompatibility:function(){this.trigger("beforeClose");var t=this.__self._visiblePopupsStack;t.splice(t.indexOf(this),1),this._releaseZIndex()},_onHidden:function(){this._isShown&&this._unbindCompatibility(),this.unbindFromDoc("keydown"),this._detachRepaintOnResize(),this._unbindFocusEvents(),this.hasMod("autoclosable","yes")&&this._disableAutoclosable(),this.hasMod("adaptive","yes")&&this._disableAdaptive(),this._detachUnder(),this._cache={},this._isShown=!1,this._isHiding=!1,this._channel.un("hide"),this._returnFocus(),this.trigger("hide")},_attachRepaintOnResize:function(){window.attachEvent&&this.domElem[0].attachEvent("onresize",this.__self._enforcePageRepaint)},_detachRepaintOnResize:function(){window.detachEvent&&this.domElem[0].detachEvent("onresize",this.__self._enforcePageRepaint)},_bindFocusEvents:function(){this._lastFocused=$($.dom.getActiveElement()[0]||this._scope);var t=this.__self._getFocusable(this.elem("content"));this._firstFocusable=t.first(),this._lastFocusable=t.last(),this._skipReturnFocus=!1,0!==this._firstFocusable.length?this.bindTo(this._lastFocused,"keydown",this._onLastFocusedKeyDown).bindTo(this._firstFocusable,"keydown",this._onFirstFocusableKeyDown).bindTo(this._lastFocusable,"keydown",this._onLastFocusableKeyDown):this._skipReturnFocus=!0},_unbindFocusEvents:function(){this.unbindFrom(this._firstFocusable,"keydown"),this.unbindFrom(this._lastFocusable,"keydown"),this.unbindFrom(this._lastFocused,"keydown")},_onLastFocusedKeyDown:function(t){this._lastFocused.is(this._scope)&&!this._lastFocused.is(t.target)||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this[t.shiftKey?"_lastFocusable":"_firstFocusable"].focus())},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_returnFocus:function(){(this._parent||{})._skipReturnFocus||this._skipReturnFocus||this._lastFocused.focus()},_mergeParams:function(t,e,i){var n={},s=Object.prototype.hasOwnProperty;return i||(i={}),t&&"object"==typeof t&&Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(o){var r=s.call(i,o)?i[o].call(this,t[o],e[o]):e[o];!r||"object"!=typeof r||Array.isArray(r)?n[o]=r:t[o]?n[o]=this._mergeParams(t[o],r,i):n[o]=r},this),n},_tailParamsHook:function(t,e){return e.offset||(e.offset=this.params.tail.offset),"number"==typeof e.offset?{offset:{left:e.offset,top:e.offset}}:e},_generateDirections:function(){if(this.__self._generateDirectionsCache)return this.__self._generateDirectionsCache;for(var t=[["bottom","top"],["left","right"]],e=[["center","left","right"],["middle","top","bottom"]],i=e,n=t.length,s=[],o=0;o<n;o++)for(var r=t[o],a=r.length,c=0;c<a;c++)for(var l=e[o],h=l.length,u=0;u<h;u++)for(var d=i[o],m=d.length,p=0;p<m;p++)s.push({direction:r[c],axis:l[u],tail:{axis:d[p]}});return this.__self._generateDirectionsCache=s,s},_repackDirParams:function(t){var e,i={};return("string"==typeof t||$.isPlainObject(t))&&(t=[t]),e=t.map(function(t){if("string"==typeof t){var e=t.split("-");t={to:e[0],tail:{}},e[1]&&(t.axis=e[1]),e[2]&&(t.tail.axis=e[2])}var n=t.to;return i[n]||(i[n]=t),t.axis&&(n+="-"+t.axis),t.key=n,i[n]=t,n},this),{directions:i,keys:e}},setViewport:function(t){return this._viewport=t,this},_pickDirection:function(){var t,e=this._order,i=this.hasMod("adaptive","yes")?e.length:1;for(this._visibilityFactor=0,t=0;t<i;t++){var n=e[t],s=this._directions[n];this._resetPos(n)._pushPos(n,this._calcPos(s))._pushPos(n,this._calcOffsets(s)),this._hasTail()&&this._resetTailPos(n)._pushTailPos(n,this._calcTailPos(s))._pushTailPos(n,this._calcTailOffset(s))._pushPos(n,this._calcOffsetByTail(s)),this._pushPos(n,this._getParentOffset());var o=this._calcVisibilityFactor(s);if((o>this._visibilityFactor||!this._direction)&&(this._visibilityFactor=o,this._direction=this._directions[n],this.size=this.getPlacingSize(),100===o))break}return this._direction},_getParentOffset:function(){var t=this.domElem.offsetParent().offset();return t.left*=-1,t.top*=-1,t},_calcPos:function(t){this._calcPlacingSize(t);var e=this.getOwnerPos(),i=this.getOwnerSize(),n=this.getPlacingSize(),s=t.axis,o=this.params.position||{},r={},a=Object.prototype.hasOwnProperty;switch(t.to){case"bottom":r={top:a.call(o,"top")?o.top:e.top+i.height,left:a.call(o,"left")?o.left:this._calcLeft(s)};break;case"top":r={top:a.call(o,"top")?o.top:e.top-n.height,left:a.call(o,"left")?o.left:this._calcLeft(s)};break;case"left":r={top:a.call(o,"top")?o.top:this._calcTop(s),left:a.call(o,"left")?o.left:e.left-n.width};break;case"right":r={top:a.call(o,"top")?o.top:this._calcTop(s),left:a.call(o,"left")?o.left:e.left+i.width}}return r},_calcTop:function(t){var e=0,i=this.getPlacingSize(),n=this.getOwnerPos(),s=this.getOwnerSize();return"top"===t?e+=n.top:"middle"===t?e+=n.top+s.height/2-i.height/2:"bottom"===t&&(e+=n.top+s.height-i.height),e},_calcLeft:function(t){var e=0,i=this.getPlacingSize(),n=this.getOwnerPos(),s=this.getOwnerSize();return"left"===t?e+=n.left:"center"===t?e+=n.left+s.width/2-i.width/2:"right"===t&&(e+=n.left+s.width-i.width),e},getPlacingSize:function(){return this.getPopupSize()},_calcOffsets:function(t){var e,i=this._cache.offset||(this._cache.offset={}),n=t.key,s=t.offset;if(i[n])return i[n];if(!s)return!1;if(e={left:0,top:0},"number"==typeof s)switch(n){case"left":e.left+=s;break;case"right":e.left-=s;break;case"top":e.top+=s;break;case"bottom":e.top-=s}else s.left&&(e.left+=s.left),s.right&&(e.left-=s.right),s.top&&(e.top+=s.top),s.bottom&&(e.top-=s.bottom);return i[n]=e,e},_hasTail:function(){return 0!==this.elem("tail").length},_moveToContainer:function(t){if(t)this._inContainer=!1;else{if(this._isShown)return;t=this._parent?this._parent.domElem:this._scope}this.domElem.appendTo(t),this._inContainer=!0},_resetPos:function(t){return t?this._positions[t]=null:this._positions={},this},_pushPosTo:function(t,e,i){!1!==i&&("string"==typeof e?this._sum(t[e]||(t[e]={}),i):(i=e,Object.keys(t).forEach(function(e){this._sum(t[e],i)},this)))},_pushPos:function(t,e){return this._pushPosTo(this._positions,t,e),this},_sum:function(t,e){Object.keys(e).forEach(function(i){t[i]=(t[i]||0)+e[i]})},_getSizeOf:function(t){return{height:t.outerHeight(),width:t.outerWidth()}},getOwnerSize:function(){return this._owner?this._cache.ownerSize||(this._cache.ownerSize=this._getSizeOf(this._owner)):{height:0,width:0}},getPopupSize:function(){return this._getSizeOf(this.domElem)},_getPosOf:function(t){return t.offset()||{left:0,top:0}},getOwnerPos:function(){var t;return this._owner&&(t=this._getPosOf(this._owner),"pageYOffset"in window&&(t.top-=window.pageYOffset-(document.documentElement.scrollTop||document.body.scrollTop),t.left-=window.pageXOffset-(document.documentElement.scrollLeft||document.body.scrollLeft))),t||this._userPosition},_calcVisibilityFactor:function(t){var e,i,n=this._viewport,s=this._getSizeOf(n),o=this.getPopupSize(),r=this._positions[t.key],a=this._parent&&this._isParentFixed?this._parent.domElem.offset():{top:0,left:0},c=this.hasMod("position","fixed")?{top:0,left:0}:{top:n.scrollTop(),left:n.scrollLeft()},l=r.top+a.top-c.top,h=r.left+a.left-c.left,u=h+o.width-s.width,d=l+o.height-s.height,m={height:o.height,width:o.width},p=100;return d>0&&(m.height-=d),l<0&&(m.height+=l),h<0&&(m.width+=h),u>0&&(m.width-=u),m.height<0||m.width<0?p=0:(i=Math.abs(m.height*m.width),(e=o.height*o.width)!==i&&(p=i/e*100)),p},_findParent:function(t){var e=t.closest(".popup, .popup2");return this.findBlockOn(e,"popup")||this.findBlockOn(e,"popup2")},destruct:function(){return this._childs.forEach(function(t){t.domElem&&BEM.DOM.destruct(t.domElem)}),this.setMod("fade-out","no"),this.hide(),this._isShown&&this._unbindCompatibility(),this.__base.apply(this,arguments)},_calcZIndexGroupLevel:function(){var t=this.params.zIndexGroupLevel,e=this._getParentPopup();return e&&(t+=e._zIndexGroupLevel),this._destructor?this._destructor.findBlocksOutside("z-index-group").reduce(function(t,e){return t+Number(e.getMod("level"))},t):t},_captureZIndex:function(){null===this._zIndexGroupLevel&&(this._zIndexGroupLevel=this._calcZIndexGroupLevel());var t=this.__self._visiblePopupsZIndexes,e=this._zIndexGroupLevel,i=t[e],n=this._zIndex;return i||(i=t[e]=[(e+1)*this.__self.ZINDEX_FACTOR]),this._zIndex=i[i.length-1]+1,i.push(this._zIndex),this._zIndex!==n&&this.domElem.css("z-index",this._zIndex),this},_releaseZIndex:function(){var t=this.__self._visiblePopupsZIndexes[this._zIndexGroupLevel];return t.splice(t.indexOf(this._zIndex),1),this},_resetDefault:function(){},_calcPlacingSize:function(){}},{live:function(){this.liveBindTo("close","pointerclick",function(){this.hide({source:"close-click"})})},_visiblePopupsStack:(BEM.blocks.popup2||{})._visiblePopupsStack||[],_visiblePopupsZIndexes:(BEM.blocks.popup2||{})._visiblePopupsZIndexes||{},ZINDEX_FACTOR:1e3,_getFocusable:function(t){var e=$.data(t,"popup-getFocusable-id");e||(e=$.identify(),$.data(t,"popup-getFocusable-id",e)),e='*[data-popup-getFocusable-id="'+e+'"]';var i="a[href], link, ";return BEM.blocks["i-ua"].opera<13&&(i=""),t.find(i+'*[tabindex], button, input:not([type="hidden"]), textarea, select, menuitem').filter(function(){var t=$(this),i=!0;return!(parseInt(t.prop("tabindex"),10)<0||"hidden"===t.css("visibility"))&&($(this).parentsUntil(e).each(function(){if("none"===$(this).css("display"))return i=!1}),i)})},_enforcePageRepaint:function(){document.body.className+=""},_generateDirectionsCache:null}),BEM.DOM.decl("popup",{_getPosOf:function(t){var e,i=t.offset();return i?(this._getPosOfTmpElem||(this._getPosOfTmpElem=$('<div class="popup__getposoffix" style="position:absolute;left:0;top:0">').appendTo("body")),e=this._getPosOfTmpElem.offset(),i.left-=e.left,i.top-=e.top,i):{left:0,top:0}}}),BEM.DOM.decl("popup",{onSetMod:{js:{inited:function(){this.__base.call(this);var t=this.findElem("under").first();this._underClassAttr=t.attr("class"),this.isDivEnough()?this._under=t:(t.remove(),this._under=null),this._underInPool=!1}}},isDivEnough:function(){return!0},_createUnder:function(){return $('<iframe frameBorder="0" tabindex="-1" src="about:blank"/>')},_getUnder:function(){if(this._under)return this._under;var t=this.__self._underPool.pop();return t&&(this._underInPool=!1),this._under=t,t||this._createUnder()},_attachUnder:function(){var t=this._under=this._getUnder();t.attr("class",this._underClassAttr),this.hasMod(t,"type","paranja")?t.detach().insertBefore(this.domElem).css("z-index",this._zIndex):t.prependTo(this.domElem)},_detachUnder:function(){var t=this._under;t.removeAttr("style"),this.__self._underPool.push(t.detach()),this._under=null,this._underInPool=!0},destruct:function(){var t=this.__base.apply(this,arguments);return this._underInPool&&this.__self._underPool.pop(),this._under&&this._under.remove(),t}},{_underPool:[]}),BEM.DOM.decl("popup",{onSetMod:{autoclosable:{yes:function(){this._enableAutoclosable()},"":function(){this._disableAutoclosable()}}},_enableAutoclosable:function(){if(this.domElem){var t=this._under;this.hasMod(t,"type","paranja")&&(t.is("iframe")&&(t=$([t[0].contentWindow,t[0].contentWindow.document])),this.bindTo(t,"pointerclick",function(t){t.stopPropagation(),this.hide({source:"outside-click"})}),this.bindTo(t,"pointerdown",function(){this._skipReturnFocus=!0})),this.bindTo("pointerdown pointerclick",function(){var t=this;do{t._preventHideByClick=!0,t=t._getParentPopup()}while(t)}),this.bindToDoc("pointerclick",function(t){if(this._preventHideByClick)this._preventHideByClick=null;else if(!this._isRelatedNode($(t.target))){var e=$.Event("outside-click");this.trigger(e,t),e.isDefaultPrevented()||this.hide({source:"outside-click"})}}),this.bindToDoc("pointerdown",function(){this._skipReturnFocus=!0})}},_disableAutoclosable:function(){var t=this._under;this.hasMod(t,"type","paranja")&&(t.is("iframe")&&(t=$([t[0].contentWindow,t[0].contentWindow.document])),this.unbindFrom(t,"pointerclick pointerdown")),this.unbindFromDoc("pointerclick pointerdown")},_isRelatedNode:function(t){var e=this.containsDomElem(t);if(e||(e=Boolean(this._owner)&&this.containsDomElem.call({domElem:this._owner},t)),e)return!0;var i,n=this._childs.length;for(i=0;i<n;i++)if(this.containsDomElem.call({domElem:this._childs[i].domElem},t))return!0;return!1}}),BEM.DOM.decl({block:"popup",modName:"adaptive",modVal:"yes"},{onSetMod:{adaptive:{yes:function(){this._enableAdaptive()},no:function(){this._disableAdaptive()}},"watch-scroll":{yes:function(){this._watchScroll()},no:function(){this._unwatchScroll()}}},_enableAdaptive:function(){this.afterCurrentEvent(function(){this.domElem&&this.bindToWin("resize",this.onResize)}),this._watchScroll()},_disableAdaptive:function(){this.unbindFromWin("resize")._unwatchScroll()},getScrollEvents:function(){return["scroll"]},_watchScroll:function(){this._owner&&!this.hasMod("watch-scroll","no")&&this.bindTo(this._owner.parents().add(this._viewport),this.getScrollEvents().join(" "),this.onScroll,this)},_unwatchScroll:function(){this._owner&&this.unbindFromDomElem(this._owner.parents().add(this._viewport),this.getScrollEvents().join(" "))},onResize:function(t){this._cache={},this._isShown&&!this._isHiding&&this.repaint()},onScroll:function(t){this._cache={},this._isShown&&!this._isHiding&&this.repaint()},destruct:function(){this._disableAdaptive(),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"popup",modName:"animate",modVal:"yes"},{afterShow:function(){var t=this.getCurrDirection();if(t){var e=t.to,i=this.getCurrPos(),n={opacity:1,top:i.top,left:i.left},s={opacity:0,top:i.top,left:i.left};"bottom"===e?s.top+=10:"top"===e?s.top-=10:"left"===e?s.left-=10:"right"===e&&(s.left+=10),this.domElem.stop(!0).css(s).animate(n,this.params.duration)}},beforeHide:function(t){var e=this.getCurrDirection();if(!e)return t();var i=e.to,n=this.getCurrPos(),s=this.domElem,o={top:n.top,left:n.left,opacity:0};return"bottom"===i?o.top+=10:"top"===i?o.top-=10:"left"===i?o.left-=10:"right"===i&&(o.left+=10),s.stop(!0,!0).animate(o,this.params.duration,function(){t(),s.css("opacity","")})}}),BEM.DOM.decl("suggest2",{onSetMod:{js:{inited:function(){this.params.form||this.findBlockOutside("suggest2-form"),this._lastSubmitTime=0,this._lastBlurTime=0,this._clear()}}},_bodyHandler:function(t){if(!this._isDestructing){var e=$(t.target);this.containsDomElem(e)||this.params.form.containsDomElem(e)||(this._freezeInputFocus=!1)}},getDefaultParams:function(){return{submitBySelect:!1,updateOnEnterByKeyboard:!0,onFocus:"request",requestOnEmptyInput:!1,abortQueries:!1,sequentialQueriesTimeout:!1}},destruct:function(){this.unbindAllEvents(),this.__base.apply(this,arguments)},init:function(){var t=this;t.params.form.on("submit",function(e,i){t._lastSubmitTime=(new Date).getTime(),t._isActualSearchCGIParams?t._isActualSearchCGIParams=!1:"suggest2-counter"!==i.data.block&&!1!==i.data.prevent&&this.removeHiddenInputs(),t._clear(),t._model.reset(),t._popup.hide()}),t._input=t.params["suggest2-input"],t._popup=t.params["suggest2-popup"],t._inputValue=t._input.val(),t._model=t.initModel(),t._view=t.initView(),t._counter=t.initCounter(),t._model.on({response:this.setItems,reject:function(e,i){2===i.code&&(t._popup.hide(),t._clear())}},t),t.bindToDoc("pointerclick",t._bodyHandler),t.bindEvents(),this._input.isFocused()&&this._doRequest();var e=BEM.blocks["i-ua"]&&BEM.blocks["i-ua"].ua.toLowerCase();return e&&e.indexOf("mozilla/5.0")>-1&&e.indexOf("android ")>-1&&e.indexOf("applewebkit")>-1&&!(e.indexOf("chrome")>-1)&&t.setMod("old-flex",!0),t},initModel:function(){return BEM.create("suggest2-model",this.params)},getModel:function(){return this._model},initView:function(t,e){var i=this.getMod("type");return t=$.extend(t,this.params.viewMods||{}),"simple"!==i&&"all"!==i||(t.simple="yes"),"advanced"!==i&&"all"!==i||(t.advanced="yes"),BEM.create({block:"suggest2-view",mods:t||{}},e||{})},getView:function(){return this._view},initCounter:function(){return this.params.counter?this.params.counter.initValues().bindEvents():void 0},getCounter:function(){return this._counter},setDataConverter:function(t){return this.getModel().getProvider().convert=t,this},setRequestData:function(t){return this.getModel().getProvider().getRequestData=t,this},setRequestUrl:function(t){return this.getModel().getProvider().getRequestUrl=t,this},setOwner:function(t){return this._popup.owner(t),this},bindEvents:function(){var t=this;return t._input.bindEvents({change:t._onChange,focus:t._onFocus,blur:t._onBlur},t),t._popup.on({preshow:function(){t.trigger("preshow")},show:function(){t._onShow()},hide:function(e,i){t._onHide(i)}}),t.params.form&&t.params.form.on("button-press",t._onSearchButtonMousedown,t),BEM.blocks["suggest2-item"].on(t.domElem,{"link-click":function(e,i){t._counter&&"_self"===$(i.domEvent.target).attr("target")&&i.domEvent.preventDefault()}}),t},_onShow:function(){this.trigger("show")},_onHide:function(t){this.trigger("hide",t)},_onSearchButtonMousedown:function(){this._input.realVal(this._input.val()),this._popup.hide()},unbindAllEvents:function(){return this.unbindFromDoc("pointerclick"),this._input.unbindAllEvents(),this.params.form.un("submit"),this._model.un("response").un("reject"),this._popup.un("preshow").un("show").un("hide"),this.params.form&&this.params.form.un("button-press",this._onSearchButtonMousedown,this),this},setItems:function(t,e){var i=e.data.items||[];return this._isFormSubmitDurinQuery()||!i.length?(this._popup.hide(),this._clear()):this.params.sequentialQueriesTimeout||this._input.val()===e.val?(this._text=e.val,this._pos=e.pos,this._meta=e.data.meta||{},this._popup.show(this._view.html(i,this._meta)).width(this.getPopupWidth()),this._items=this.findBlocksInside("suggest2-item"),this._clearItems().trigger("update",{val:this._text,pos:this._pos,items:this._items}),this):this._clear()},getItems:function(){return this._items||[]},isBlur:function(){return this._isBlur&&!this._isMouseDown},getPopupWidth:function(){},getInputWidth:function(){return 0},isNeedSubmitFormOnSelectItem:function(t){return this.params.submitBySelect&&"link"!==t.getMod("interact")},_isFormSubmitDurinQuery:function(){return!!this._lastSubmitTime&&(this._model.filterRequestsByVal(this._input.realVal()),this._model.isTimeInRequestInterval(this._lastSubmitTime))},_onChange:function(t,e){this._inputValue!==this._input.val()&&(this._inputValue=this._input.val(),this._doRequest(e))},_doRequest:function(t){var e=this.getCounter();this._model.request(this._input.realVal(this._input.val()),this._input.getCaretPosition(),t,e&&e.getCurrentReqId())},_onFocus:function(){!this._popup.isShown()&&this._isBlur&&this.params.onFocus&&this._isLastBlurTimeLater(50)&&(this.getItems().length&&this._input.val()===this._text?(this._clearItems(),this._popup.show()):this._isMouseDown||"request"!==this.params.onFocus||this._doRequest())},_onBlur:function(){this._isBlur?(this._clear(),this._popup.hide()):this._freezeInputFocus?(this._clear(),this._input.focus()):this._isMouseDown&&this._input.focus(),this._lastBlurTime=(new Date).getTime(),this._isBlur=!0},_getItemIndex:function(t){return this.getItems().indexOf(t)},_clear:function(){return this._isBlur=!0,this._freezeInputFocus=!1,this._clearItems()},_clearItems:function(){return this._isMouseDown=!1,this._enterItemIndex=-1,this._unselectItems()},_isLastBlurTimeLater:function(t){return(new Date).getTime()-this._lastBlurTime>t},_unselectItems:function(t){return(t?[].slice.call(arguments):this.getItems()).forEach(function(t){t.onLeave()}),this},_onSelectItem:function(t,e){var i=this._getItemIndex(t),n=t.onSelect(e),s=t.valOnSelect();return this._text=this._input.realVal(s),this._isBlur=!0,this._freezeInputFocus=!1,this._setSearchCGIParams(t),this.trigger("select",{val:this._text,pos:this._pos,item:t,meta:this._meta,itemIndex:i,byKeyboard:e,callbackOnSelect:n}),!1!==s&&(this._items=[],this.isNeedSubmitFormOnSelectItem(t)&&this.params.form.submit()),i},_isActualSearchCGIParams:!1,_setSearchCGIParams:function(t){this.params.form.removeHiddenInputs(),t.params.searchCGI&&(this._isActualSearchCGIParams=!0,this.params.form.appendHiddenInputs(t.params.searchCGI.map(function(t){return{name:t[0],value:t[1]}})))},_onDownItem:function(){this._isBlur=!1,this._isMouseDown=!0}}),BEM.DOM.decl("suggest2",{getInputLeft:function(){return 0},getInputWidth:function(){return 0},getContainerWidth:function(){return 0},getMetrics:function(){var t=this.getInputLeft(),e=this.getInputWidth(),i=this.getContainerWidth()-t;return{marginLeft:t,minWidth:e>=i?i:e,maxWidth:i}},adjustView:function(){return this.getMetrics()},_resizeHandler:function(){}}),BEM.DOM.decl("suggest2",{bindEvents:function(){var t=this;return t._input.bindEvents({keydown:t._onKeyDown,keyup:t._onKeyUp,keypress:t._onKeyPress,mousedown:function(){t._input.isFocused()&&t._onFocus()}},t),BEM.blocks["suggest2-item"].on(t.domElem,{mouseover:function(e){t._onEnterItem(e.block,!1)},mouseout:function(e,i){var n=e.block.domElem[0];n===i.relatedTarget||$.contains(n,i.relatedTarget)||t._onLeaveItem(e.block,!1)},mousedown:function(){t._onDownItem()},click:function(e){t._onSelectItem(e.block,!1)}}),t.__base.apply(t,arguments)},_onKeyDown:function(t){var e=this.__self.keyboard,i=t.which;!this._popup.isShown()||i!==e.up&&i!==e.down||(t.preventDefault(),this._enterByKeyboard(i))},_onKeyUp:function(t){var e=this.__self.keyboard;if(t.which!==e.left&&t.which!==e.right||(this.trigger("change-cursor-pos"),this._model.request(this._input.realVal(this._input.val()),this._input.getCaretPosition())),t.which===e.right&&-1!==this._enterItemIndex&&this._enterItemByKeyboard){var i=this._items[this._enterItemIndex];i&&this.trigger("ahead",{item:i,val:"link"===i.getMod("interact")?i.elem("text").text():i.val()})}},_onKeyPress:function(t){if(t.which===this.__self.keyboard.enter&&-1!==this._enterItemIndex&&this._enterItemByKeyboard){var e=this._items[this._enterItemIndex];e&&(t.preventDefault(),this._onSelectItem(e,!0))}},_enterByKeyboard:function(t){var e=t-39,i=this._items.length,n=this._enterItemIndex+e;if(-1===n||n===i)return this._enterItemIndex=n,this._unselectItems(this._items[n]),this.trigger("out",{val:this._text,byKeyboard:!0});n<0?n=i-1:n>=i&&(n=0),this._onEnterItem(this._items[n],!0)},_onEnterItem:function(t,e){this._enterItemIndex=this._getItemIndex(t),this._enterItemByKeyboard=e,this._unselectItems(),t.onEnter(e)},_onLeaveItem:function(t,e){this._clearItems()._unselectItems(t)}},{keyboard:{enter:13,left:37,up:38,right:39,down:40},live:function(){return this.liveBindTo("mousedown",function(){this._onDownItem()}),this.__base()}}),BEM.decl("suggest2",{init:function(){this.__base.apply(this,arguments),this._logOnError()},_logOnError:function(){BEM.channel("suggest2").on("response",function(t,e){var i=e.data.error;i&&"parsererror"===i&&!this._loggedError&&(this._loggedError=!0,home.error.log({block:"suggest2",message:"parser error",source:"suggest2",sourceType:"network",status:i}))},this)}}),BEM.DOM.decl("suggest2",{_doRequest:function(){(this._ignoredFirstRequest||"request"===this.params.onFocus||this._input.val())&&this.__base.apply(this,arguments),this._ignoredFirstRequest=!0}}),BEM.DOM.decl("suggest2",{_afterSetMod:function(t,e){this.__base.apply(this,arguments),"theme"!==t&&"adjustable"!==t||(this.domElem.css("width",""),this._view.setMod(t,e),this.adjustView(),this._lastSettedData&&this.setItems({},this._lastSettedData))},setItems:function(t,e){var i=this.__base.apply(this,arguments);return this._lastSettedData=e,i},bindEvents:function(){var t=this;function e(){t._popup&&t._popup.isShown()&&t._popup.hide()}t.__base.apply(t,arguments),t._input.bindEvents({click:function(){t._popup.isShown()||(t._tabChange=!1,t._doRequest())}}),BEM.blocks["suggest2-item"].on(t.domElem,{mousedown:function(){t.bindToDoc("mouseup.suggest2",function(){t._isBlur=!0,t._isMouseDown=!1,t.unbindFromDoc("mouseup.suggest2")})}}),$(window).bind("keyboardOpened.lego",function(){t._popup&&t._popup.isShown()&&t._popup.get()&&t._popup.get().repaint()});var i=!0;$(window).on("focus",function(){var n;try{n=document.activeElement}catch(t){}i||(i=!0,n&&t._input.getControl()&&t._input.getControl().is(n)&&(t._tabChange=!0),e())}).on("blur",function(){i=!1,e()})},init:function(){this.__base.apply(this,arguments),BEM.channel("suggest2").trigger("init"),this.trigger("model-ready")},_onChange:function(){return this._tabChange=!1,BEM.channel("suggest2").trigger("change"),this.__base.apply(this,arguments)},_onFocus:function(){this._tabChange||(BEM.channel("suggest2").trigger("focus"),this.__base.apply(this,arguments))},instantHidePopup:function(){this._popup.instantHide()}}),BEM.decl("suggest2-model",{onSetMod:{js:{inited:function(){this._requests=[]}}},destruct:function(){this._provider&&this._provider.destruct(),this.__base.apply(this,arguments)},getProvider:function(){return this._provider?this._provider:(this._provider=this.setProvider(this.params),this._provider)},setProvider:function(t){return this._provider=BEM.create({block:"suggest2-provider",mods:t.providerMods||{}},t),this._provider},getCancelRequestConditions:function(){return[{block:"suggest2",show:!1},{block:"suggest2",event:"select"},{block:"suggest2-item",event:"select"},{block:"suggest2",event:"out"},{block:"suggest2-item",show:!1},{block:"suggest2-popup",event:"hide"},{suggest:!1},{source:"sample"}]},request:function(t,e,i,n){var s=this,o={val:t,caretPosition:e,reqId:n,data:i};s._requests.push(o);var r=s._isNeedRequest(t,i);return r.need?(o.requestTime=(new Date).getTime(),s.lastSendedRequest=o,s.trigger("request",{val:t,pos:e,request:o}),s.getProvider().get(t,e,n,function(t,e,i,n){o.responseTime=(new Date).getTime(),$.extend(o,{duration:o.responseTime-o.requestTime,error:i.error,fromCache:n,itemsCount:i.items?i.items.length:0}),s._onResponse(t,e,i,o);var r=s._requests[s._requests.length-1];s.params.sequentialQueriesTimeout&&r&&r.val!==t&&s.request(r.val,r.caretPosition,r.data)}),s):s.trigger("reject",{val:t,pos:e,code:r.code,reason:r.reason||{}})},isTimeInRequestInterval:function(t){for(var e=this._requests.length-1;e>=0;e--)if(t>this._requests[e].requestTime&&t<this._requests[e].responseTime)return!0;return!1},filterRequestsByVal:function(t){this._requests=this._requests.filter(function(e){return e.val===t})},_isNeedRequest:function(t,e){if(""===t&&!this.params.requestOnEmptyInput)return{need:!1,code:2};var i;if(this.lastSendedRequest&&this.lastSendedRequest.val===t)return{need:!1,code:4};if(this.params.sequentialQueriesTimeout)for(i=this._requests.length-1;i>=0;i--){var n=this._requests[i];if(void 0===n.responseTime&&(new Date).getTime()-n.requestTime<this.params.sequentialQueriesTimeout)return{need:!1,code:3,reason:{request:n}}}if(!e)return{need:!0};var s,o=this.getCancelRequestConditions();t:for(i=0;i<o.length;i++){for(var r in s=o[i])if(s.hasOwnProperty(r)&&s[r]!==e[r])continue t;return{need:!1,code:1,reason:{condition:s}}}return{need:!0}},_onResponse:function(t,e,i,n){var s={val:t,pos:e,data:i||[],request:n};BEM.channel("suggest2").trigger("response",s),this.trigger("response",s)},reset:function(){this._requests=[],this.lastSendedRequest=null}}),BEM.decl("suggest2-model",{_onResponse:function(t,e,i){this.params.swytExp&&t&&(i.error||i.items&&!i.items.length)&&(i.items=i.items||[],this.params.flow?i.items.push(["fulltext",t]):i.items.push(["bemjson",t,{bemjson:[{elem:"text",content:[t]}]}])),this.__base.apply(this,arguments)}}),BEM.DOM.decl("suggest2-detect",{onSetMod:{js:{inited:function(){this.bindToDoc("keydown",function(t){this.__self._pressedKeyCode=t.which},this).bindToDoc("keyup",function(){this.__self._pressedKeyCode=null},this),this.__self.isSupportInlineSVG()||this.setMod("inlinesvg","no")}}}},{_pressedKeyCode:null,isPressedEscape:function(){return 27===this._pressedKeyCode},_isSupportInlineSVG:null,isSupportInlineSVG:function(){if(null!==this._isSupportInlineSVG)return this._isSupportInlineSVG;var t=document.createElement("div");return t.innerHTML="<svg/>",this._isSupportInlineSVG="http://www.w3.org/2000/svg"===(t.firstChild&&t.firstChild.namespaceURI),this._isSupportInlineSVG}}),function(){"use strict";BEM.DOM.decl("suggest2-detect",{},{isSupportInlineSVG:function(){return void 0===this._isSupportInlineSVG2&&(this._isSupportInlineSVG2=$("html").hasClass("i-ua_inlinesvg_yes")),this._isSupportInlineSVG2}})}(),function(t){if(!t.support.cors&&t.ajaxTransport&&window.XDomainRequest){var e=/^(https?:)?\/\//i,i=/^get|post$/i,n=new RegExp("^(//|"+location.protocol+")","i");t.ajaxTransport("* text html json",function(s,o,r){if(s.crossDomain&&s.async&&i.test(s.type)&&e.test(s.url)&&n.test(s.url)){var a=null;return{send:function(e,i){var n="",r=(o.dataType||"").toLowerCase();a=new XDomainRequest,/^\d+$/.test(o.timeout)&&(a.timeout=o.timeout),a.ontimeout=function(){i(500,"timeout")},a.onload=function(){var e="Content-Length: "+a.responseText.length+"\r\nContent-Type: "+a.contentType,n={code:200,message:"success"},s={text:a.responseText};try{if("html"===r||/text\/html/i.test(a.contentType))s.html=a.responseText;else if("json"===r||"text"!==r&&/\/json/i.test(a.contentType))try{s.json=t.parseJSON(a.responseText)}catch(t){n.code=500,n.message="parseerror"}}catch(t){throw t}finally{i(n.code,n.message,s,e)}},a.onprogress=function(){},a.onerror=function(){i(500,"error",{text:a.responseText})},o.data&&(n="string"===t.type(o.data)?o.data:t.param(o.data)),a.open(s.type,s.url),a.send(n)},abort:function(){a&&a.abort()}}}})}}(jQuery),BEM.decl("suggest2-provider",{getDefaultParams:function(){return{cache:!1,type:"GET",dataType:"jsonp",timeout:2e3}},_cachedResponses:Object.create?Object.create(null):{},_cachingTime:6e4,_lastQuery:null,get:function(t,e,i,n){"function"==typeof i&&(n=i,i=void 0);var s=this,o=s.params.abortQueries,r="jsonp"===this.params.dataType,a=s._extendParamsData(s.getRequestData(t,e,i));n=n.bind(s,t,e),o&&null!==s._lastQuery&&s._lastQuery.abort(),s._lastQuery=$.ajax(a).done(function(t){n(s.convert(t),s._validateCache(this.url))}).fail(function(t,e){!o&&!r&&n({error:e||"error"})})},convert:function(t){return{orig:t[0],items:t[1],meta:t[2]}},getRequestData:function(t,e,i){return $.extend({part:t,pos:e},i&&{suggest_reqid:i},BEM.blocks["suggest2-detect"].isSupportInlineSVG()&&{svg:1})},getRequestUrl:function(){return this.params.url},_extendParamsData:function(t){return this.params.url=this.getRequestUrl(),this.params.data=$.extend(this.params.data||{},t),this.params.traditional=!0,this.params},_validateCache:function(t){var e=Boolean(this._cachedResponses[t])&&this._cachedResponses[t]>Date.now();return!e&&this._addToCache(t),e},_addToCache:function(t){this._cachedResponses[t]=Date.now()+this._cachingTime,setTimeout(function(){this._cachedResponses[t]=void 0}.bind(this),this._cachingTime)}}),BEM.decl("suggest2-provider",{getDefaultParams:function(){var t=this.__base.apply(this,arguments);return t.cache=!0,t},get:function(t,e,i,n){this.__base.apply(this,arguments);var s=n;"function"==typeof i&&(s=i);var o=this.params.abortQueries,r="jsonp"===this.params.dataType;s=s.bind(this,t,e),this._lastQuery&&this._lastQuery.fail(function(t,e){!o&&r&&s({error:e||"error"})})}}),BEM.decl("suggest2-provider",{get:function(t,e,i,n){if(!this.params.email)return this.__base.apply(this,arguments);var s=this,o={pos:e};o[this.params&&this.params.paramName||"part"]=t;var r=this._extendParamsData(o);r.dataType="json",r.xhrFields={withCredentials:!0},n=n.bind(this,t,e),$.ajax(r).done(function(e){n({orig:t,items:s._processEmailst(e),meta:{}},!1)}).error(function(t,e,i){home.error.logAjaxError({block:"suggest2",message:"sticker suggest2 get: ajax",source:"suggest2"},t,e,i),n({error:status||"error"})})},_processEmailst:function(t){var e=[];return t.filter(function(t){return t.uid===this.params.uid&&t.contacts&&t.contacts.length},this).forEach(function(t){e=e.concat(t.contacts.map(function(t){return["email",t]}))}),e}}),BEM.DOM.decl("suggest2-item",{val:function(){if(void 0!==this.params.val)return this.params.val;var t=this.elem("text");return(t.length?t:this.domElem).text()},valOnSelect:function(){return this.val()},valOnEnter:function(){return this.val()},valOnLeave:function(){return this.val()},onEnter:function(t){return this.setMod("selected","yes").triggerEvent("enter",{val:this.valOnEnter(),byKeyboard:t})},onLeave:function(t){return this.domElem?this.delMod("selected").triggerEvent("leave",{val:this.valOnLeave(),byKeyboard:t}):this},onSelect:function(t){this.triggerEvent("select",{val:this.valOnSelect(),byKeyboard:t})},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")},triggerEvent:function(t,e){return this.trigger(t,{val:e.val,id:this.domElem.attr("id"),show:!1,byKeyboard:e.byKeyboard})}},{live:function(){return this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}),this.__base()}}),BEM.DOM.decl("suggest2-item",{},{live:function(){return this.liveBindTo("mouseover mouseout mousedown pointerclick",function(t){this.trigger("pointerclick"===t.type?"click":t.type,{domEvent:t})}).liveBindTo("link","pointerclick",function(t){this.trigger("link-click",{domEvent:t})}),this.__base()}}),BEM.DOM.decl("suggest2-item",{onLeave:function(){if(this.domElem)return this.__base.apply(this,arguments)}}),BEM.decl("suggest2-popup",{onSetMod:{js:{inited:function(){this._popup=this.params.popup,this._popupContent=this.params.popupContentElem&&this._popup.findElem(this.params.popupContentElem),this.bindSuggestEvents()}}},show:function(t){return this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null),this._popup.domElem?(t&&this.setContent(t),this.isShown()?this:(this.trigger("preshow"),this._setPosition(),this.trigger("show"),this)):this},_setPosition:function(){throw new Error("       _for")},hide:function(t){var e=this;return e.isShown()&&!e.hideTimeout&&(e.hideTimeout=setTimeout(function(){e._doHide(),e.trigger("hide",t||{}),e.hideTimeout=null},300)),e},_doHide:function(){throw new Error("       _for")},setContent:function(t){return this._popupContent?BEM.DOM.update(this._popupContent,t):this._popup.setContent(t),this},isShown:function(){throw new Error("       _for")},owner:function(t){return t?(this.params.owner=t,this):this.params.owner},get:function(){return this._popup},width:function(t){return void 0===t?this._popup.domElem.outerWidth():(this._popup.domElem.outerWidth(t),this)},destruct:function(){this._popup&&(this.unbindAllEvents(),this.__base.apply(this,arguments))},bindSuggestEvents:function(){return this.params.suggest.on({select:this._onSuggestSelect,update:this._onSuggestUpdate},this),this},_onSuggestSelect:function(t,e){this.hide(e)},_onSuggestUpdate:function(t,e){e.items.length||this.hide({response:"empty"})},unbindAllEvents:function(){return this.params.suggest.un("select").un("update"),this}}),BEM.decl("suggest2-popup",{hide:function(t){var e=this;return e.isShown()&&!e.hideTimeout&&(e.hideTimeout=setTimeout(function(){e.instantHide(t)},500)),e},instantHide:function(t){this._doHide(),this.trigger("hide",t||{}),this.hideTimeout=null}}),BEM.decl("suggest2-popup",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.on({show:function(){this.channel("suggest2").trigger("show")},hide:function(){this.channel("suggest2").trigger("hide")}})}}},pos:function(){return this.isShown()&&this._popup.repaint(),this}}),BEM.decl({block:"suggest2-popup",modName:"for",modVal:"popup"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._popup.on("hide",function(){BEM.blocks["suggest2-detect"].isPressedEscape()&&this.trigger("hide",{})},this)}}},_setPosition:function(){this._popup.show(this.params.owner)},_doHide:function(){this._popup.hide()},isShown:function(){return!!this._popup&&this._popup.isShown()}}),BEM.decl("suggest2-view",{html:function(t,e){return BEMHTML.apply(this.build(t,e))},build:function(t,e){return{block:"suggest2",elem:"content",elemMods:{theme:"normal"},content:this.buildItems(t,e)}},buildItems:function(t,e){return t.reduce(function(t,e){return t.push(this.buildItem(e)),t}.bind(this),[])},buildItem:function(t){var e=this.__self._getPrefs(t),i=this.__self._getType(t,e),n="html"===i||"bemjson"===i?{}:{type:i};return this._getItemByType(t,e,i,{text:{elem:"text",content:this.__self._highlight(this.__self._getText(t,e),e)},mods:n,js:e.js||{},props:{},content:[]})},_getItemByType:function(t,e,i,n){var s=n.text,o=n.mods,r=n.js,a=n.props,c=n.content;0===c.length&&c.push(s),this.__self._getPersonal(e)&&(o.personal="yes",c.push({elem:"spacer"},{elem:"cross",elemMods:{type:"delete"}})),e.url&&(o.interact="link",a.url=this.__self._resolveUrl(e.url),e.target&&(a.target=e.target)),e.search_cgi&&(r.searchCGI=e.search_cgi),e.attrs&&(a.attrs=e.attrs);var l,h=BEM.blocks["i-global"];return"nav"===i?l="object"==typeof t[5]?t[5].counter:t[5]:"bemjson"===i&&(l=e.counter),l&&(r.safeclickUrl=(h.param("click-host")+l).split("/*/").join("/reqid="+h.param("reqid")+"/path=695.770/vars=-js-ready=1/*/")),$.extend({block:"suggest2-item",mods:o,js:r,content:c},a)}},{_getPrefs:function(t){if(!Array.isArray(t))return{};var e=t[t.length-1];return $.isPlainObject(e)?e:{}},_getType:function(t,e){return Array.isArray(t)&&t[0]||"text"},_getText:function(t){return Array.isArray(t)?t[1]:t},_highlight:function(t,e){if(!e.hl)return t;var i,n=e.hl.sort(function(t,e){return t[0]-e[0]}).filter(function(t){return t[0]>=0}),s=[],o=0;return n.length?(n.forEach(function(e){i=o>e[0]?o:e[0],s.push(t.slice(o,i)),s.push({elem:"highlight",content:t.slice(i,o=e[1])})},this),s.push(t.slice(o)),s.filter(function(t){return t})):t},_resolveUrl:function(t){return(/[\/]{2}/.test(t)?"":"http://")+t},_getPersonal:function(t){return Boolean(t.pers)},_getPersonalProps:function(t){var e={pers:1};return t&&(e.label=t),e}}),BEM.decl("suggest2-view",{},{_getGroupType:function(t,e){return t.pers?"nah":-1!==["nav"].indexOf(e)?e:"text"},_getTextLabel:function(t){return BEM.I18N("suggest2",t)}}),BEM.decl("suggest2-view",{_getItemByType:function(t,e,i,n){var s,o;return"email"===i?(s=[],(o=n.js).email=t[1],s.push({elem:"email",content:BEM.blocks["i-common__string"].escapeHTML(t[1])}),$.extend({block:"suggest2-item",mods:n.mods,js:o,content:s},n.props)):this.__base.apply(this,arguments)}}),BEM.decl("suggest2-input",{onSetMod:{js:{inited:function(){var t=this;t._input=t.params.input,t.disableBrowserAutocomplete(),t.realVal(t.val()),t.bindEvents({change:function(e,i){t._onChange(e,i)},clear:$.throttle(function(e,i){t._onClear(e,i)},300)}),t.bindSuggestEvents()}}},_onChange:function(t,e){this.trigger("change",e)},_onClear:function(t,e){this.trigger("clear",e)},destruct:function(){this.unbindAllEvents(),this.__base.apply(this,arguments)},get:function(){return this._input},isFocused:function(){return this._input.hasMod("focused")},focus:function(){return this._input.setMod("focused","yes"),this},blur:function(){return this._input.delMod("focused"),this},getControl:function(){return this._input.elem("control")},val:function(t,e){return this._input.val.apply(this._input,arguments)},valWithoutSuggest:function(t,e){return this._input.val.call(this._input,t,$.extend(e,{suggest:!1}))},realVal:function(t){return void 0===t?this._realVal:("string"==typeof t&&(this._realVal=t),this._realVal)},width:function(){return this._input.domElem.width()},getCaretPosition:function(){var t,e=this.getControl()[0],i=this.val().length;return document.selection?((t=document.selection.createRange()).moveStart("character",-i),t.text.length):"number"==typeof e.selectionStart?e.selectionStart:i},moveCaretToEnd:function(){var t=this.getControl()[0],e=t.value.length;if(void 0!==t.createTextRange){var i=t.createTextRange();i.collapse(!1),i.select()}else"number"==typeof t.selectionStart&&(t.scrollLeft=999999,t.setSelectionRange(e,e));return this},disableBrowserAutocomplete:function(){this.getControl().attr({autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-autocomplete":"list"})},_bindedEventsNames:[],bindEvents:function(t,e){return Object.keys(t).forEach(function(i){-1===this._bindedEventsNames.indexOf(i)&&this._bindedEventsNames.push(i),this._eventsFilter(i).on(i,t[i].bind(e||this))},this),this},bindSuggestEvents:function(){var t=this.params.suggest;return t.on({out:function(t,e){this.a11yDeactive(),this._changeValueByEvent(t,e)}},this),BEM.blocks["suggest2-item"].on(t.domElem,{tpah:this._onSuggestItemTpah,select:this._onSuggestItemSelect,enter:this._onSuggestItemEnter},this),this},_onSuggestItemTpah:function(t,e){this._changeValueByEvent(t,e),this.moveCaretToEnd()},_onSuggestItemSelect:function(t,e){"link"!==t.block.getMod("interact")&&(this._changeValueByEvent(t,e),this.moveCaretToEnd())},_onSuggestItemEnter:function(t,e){this.a11yActive(e.id),e.byKeyboard&&this.params.updateOnEnterByKeyboard&&(this._changeValueByEvent(t,e),this.moveCaretToEnd())},unbindAllEvents:function(){return this._input.domElem&&this._bindedEventsNames.forEach(function(t){var e=this._eventsFilter(t);e[e instanceof BEM.DOM?"un":"off"](t)},this),this._bindedEventsNames=[],this.params.suggest.un("out"),this},a11yActive:function(t){this.getControl().attr("aria-activedescendant",t)},a11yDeactive:function(){this.getControl().removeAttr("aria-activedescendant")},_eventsFilter:function(t){return-1!==["blur","focus","change","clear"].indexOf(t)?this._input:this.getControl()},_changeValueByEvent:function(t,e){var i=e&&void 0!==e.val?e.val:this.realVal();this.val(i,$.extend({block:t.block.__self.getName(),event:t.type},e))}}),BEM.decl("suggest2-input",{onSetMod:{js:{inited:function(){var t=this;t.__base.apply(this,arguments),t.bindEvents({keydown:function(e){t._onKeyDown(e)}},t)}}},_onKeyDown:function(t){t.which===this.params.suggest.__self.keyboard.enter&&this.trigger("enter")}}),BEM.decl("suggest2-input",{disableBrowserAutocomplete:function(){}}),Date.now||(Date.now=function(){return(new Date).getTime()}),BEM.DOM.decl("suggest2-counter",{pointerStartEvent:"pointerdown",onSetMod:{js:{inited:function(){this.clear()}}},destruct:function(){this.unbindAllEvents()},getDefaultParams:function(){return{submitBySelect:!1,suggestReqID:!1,preventSubmit:!0,host:"//yandex.ru",path:"clck/jclck",dataUrl:"http://ya.ru",params:{},timeout:300}},metaProps:{exprt:"exprt",r:"region",log:"log"},clear:function(){return this._params={user_input:"",text:""},this._times=[],this._renderTimes=[],this._renderTime=0,this._path={service:this.params.service,state:"not_shown",index:0,personal:"nah_not_shown",submit:""},this._ratio={len:0,queryLen:0,actionsCount:0},this._firstChange=0,this._lastChange=0,this._sinceChange={first:0,last:0},this._selectedText="",this._session=0,this._reqID=this.__self._generateReqID(),this._meta={},this._afterSendAjaxCallback,this._startClickTime=null,this._startInputTime=null,this._requests=[],this._clicksCount=0,this},submit:function(t){var e=this.params.suggest.params["suggest2-input"],i=e.val();this._params.text=i,this._params.pos=e.getCaretPosition(),this._params.times=this._requests.map(function(t){return!t.error&&t.duration?t.duration:0}).join("."),this.params.suggestReqID&&this.attachReqID(),this.sendAjax(this.getUrl(),$.extend({submitForm:!0,afterSendAjaxCallback:function(){}},t)),this.trigger("submit",this._getSubmitEventData()).clear(),this._params.prev_query=i},_getSubmitEventData:function(){return{path:this._path,times:this._times,render_times:this._params.times,prev_query:this._params.prev_query,user_input:this._params.user_input,text:this._params.text,pos:this._params.pos,ratio:this._ratio,since_first_change:this._sinceChange.first,since_last_change:this._sinceChange.last,session:this._session,suggest_reqid:this._reqID,meta:this._meta,url:this.getUrl()}},sendAjax:function(t,e){return $.ajax({type:"GET",url:t,dataType:"script",timeout:this._getAjaxTimeout()}).always(this._sendAjaxAlways.bind(this,e)),this},_getAjaxTimeout:function(){return this.params.timeout},afterSendAjax:function(t){return this._afterSendAjaxCallback=t,this},getUrl:function(){return this.params.host+["/",this.params.path].concat(this._getUrlParams()).join("/").replace(/(\/+)/g,"/")},_sendAjaxAlways:function(t){t||(t={}),this.params.preventSubmit&&t.submitForm&&this.params.form.submit({block:this.__self.getName(),prevent:!1}),t.afterSendAjaxCallback&&t.afterSendAjaxCallback(),this._afterSendAjaxCallback&&this._afterSendAjaxCallback()},_getUrlParams:function(){var t=this;return this._getParamsList().concat(t._getData()).reduce(function(e,i){return e.concat(t._getParams(i))},[]).concat(["/"])},_getParamsList:function(){return[this.params.params,this._getPath(),this._params,this._getRatio(),this._getSinceChange(),this._getSession(),this._getResponsesShows(),{suggest_reqid:this._reqID}]},initValues:function(){return this._params.prev_query=this.params.suggest.params["suggest2-input"].val(),this},attachReqID:function(){this._reqID=this.__self._generateReqID(),this.params.form.appendHiddenInputs([{name:"suggest_reqid",value:this._reqID}])},getCurrentReqId:function(){return this._reqID},bindEvents:function(){var t=this.params,e=t.suggest,i=t.form,n=e.getModel(),s=e.params["suggest2-input"],o=e.params["suggest2-popup"];return i.on({"button-click":this._onFormButtonClick,submit:this._onFormSubmit},this),n.on({request:this._onModelRequest,response:this._onModelResponse},this),s.on({change:this._onInputChange,enter:this._onInputEnter},this),o.on({show:this._onPopupShow},this),BEM.blocks["suggest2-item"].on(e.domElem,"enter",this._onSuggestItemEnter,this),e.on({update:this._onSuggestUpdate,select:this._onSuggestSelect},this),this._input=s._input,this._input.bindTo(this.pointerStartEvent,this._onInputClick.bind(this)).on("focus",this._onInputFocus,this),this._input.findElem("control").on("blur",this._onInputBlur.bind(this)),this},_onInputClick:function(){this._startInputTime||(this._startClickTime=Date.now())},_onClickPopup:function(){this._clicksCount++},_onInputFocus:function(){this._timeoutInputTime&&clearTimeout(this._timeoutInputTime),this._startInputTime=this._startClickTime},_onInputBlur:function(t){this._timeoutInputTime=setTimeout(function(){this._startClickTime=null,this._startInputTime=null}.bind(this),300)},_onFormButtonClick:function(){"keyboard"!==this._path.submit&&(this._path.submit="button_by_mouse")},_onFormSubmit:function(t,e){e.data.block!==this.__self.getName()&&!1!==e.data.prevent&&(this.params.preventSubmit&&(e.stopImmediatePropagation(),e.preventDefault()),this._doSubmit())},_doSubmit:function(){this.submit()},_onModelRequest:function(t,e){this._requests.push(e.request)},_onModelResponse:function(t,e){if(Object(e.data).items){var i=e.data.items;this._path.personal=this._hasPersonal(i)?"nah_not_used":"nah_not_shown",this._meta=e.data.meta||{},this._renderTime=new Date,this._setMetaProps(e),this._requests&&delete this._requests[e.val.toLowerCase()]}},_onInputChange:function(t,e){e&&"clear"!==e.source||(this._params.user_input=t.block.val(),this[this._firstChange?"_lastChange":"_firstChange"]=new Date,this._startInputTime||(this._startInputTime=this._firstChange.getTime())),this._selectedText&&(this._path.state="edit"),this._ratio.actionsCount++},_onInputEnter:function(){this._path.submit="keyboard"},_onPopupShow:function(){"not_shown"===this._path.state&&(this._path.state="not_used")},_onSuggestItemEnter:function(t,e){e.byKeyboard&&this.params.suggest.params.updateOnEnterByKeyboard&&(this._selectedText=e.val,this._path.state="suggest")},_onSuggestUpdate:function(){this._addRenderTime(new Date-this._renderTime)},_onSuggestSelect:function(t,e){this._path.state=e.byKeyboard?"keyboard":"mouse",this._path.index=e.itemIndex+1,this._selectedText=e.val,e.item.hasMod("personal")&&(this._path.personal="nah_used"),this.params.submitBySelect&&(this._path.submit=e.byKeyboard?"keyboard":"click_by_mouse",this._params.pos=e.pos,this._params.text=this._selectedText),this.params.suggest.isNeedSubmitFormOnSelectItem(e.item)||this.submit({submitForm:!1,afterSendAjaxCallback:e.callbackOnSelect}),e.item.params.safeclickUrl&&((new Image).src=e.item.params.safeclickUrl)},unbindAllEvents:function(){var t=this.params,e=t.suggest,i=t.form,n=e.params["suggest2-popup"];return i.un("button-click").un("submit"),e.getModel().un("request").un("response"),e.params["suggest2-input"].un("change").un("enter"),n.un("show").un("hide"),e.un("select"),this},_hasPersonal:function(t){return t.some(function(t){return 1===BEM.blocks["suggest2-view"]._getPrefs(t).pers})},_setMetaProps:function(t){t.data.meta&&Object.keys(this.metaProps).forEach(function(e){this._params[this.metaProps[e]]=t.data.meta[e]||""},this)},_getParams:function(t){return Object.keys(t).reduce(function(e,i){return""===t[i]?e:(e.push(i+"="+encodeURIComponent(t[i]).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%2C/g,",")),e)},[])},_getPath:function(){return{path:[this._path.service,this._path.state,"p"+this._path.index,this._path.personal,this._path.submit].join(".")}},_getSession:function(){return this._session=(new Date).getTime()+Math.round(1e4*Math.random()),{session:this._session}},_getSinceChange:function(){var t=this._getSinceTime("first"),e=this._startInputTime&&Date.now()-this._startInputTime||0;return{since_first_change:t,since_last_change:this._getSinceTime("last"),total_input_time:e}},_getSinceTime:function(t){var e="_"+t+"Change";return this._sinceChange[t]=this[e]?(new Date).getTime()-this[e]:0,this._sinceChange[t]},_getResponsesShows:function(){return this._requests.reduce(function(t,e){return t.rqs++,e.error||(e.responseTime&&t.rsp++,0===e.itemsCount&&t.ersp++,e.fromCache&&t.cchd++),t},{rqs:0,rsp:0,rndr:this._renderTimes.length,ersp:0,clks:this._clicksCount,cchd:0})},_getRatio:function(){return this._ratio.len=this._params.user_input.length,this._ratio.queryLen=this._params.text.length,{ratio:[this._ratio.len,this._ratio.queryLen,this._ratio.actionsCount].join(".")}},_addRenderTime:function(t){return this._renderTimes.push(t),this._params.render_times=this._renderTimes.join("."),this},_getData:function(){return{"*data":"url="+this.params.dataUrl}}},{_generateReqID:function(){return(BEM.blocks["i-global"]&&BEM.blocks["i-global"].param("yandexuid")?BEM.blocks["i-global"].param("yandexuid"):this._random(9)+this._random(9))+String(Date.now()).slice(-7)+this._random(7)},_random:function(t){return Math.random().toString().slice(-Math.min(t,10))}},{live:function(){this.liveInitOnBlockEvent("init","suggest2-form")}}),BEM.DOM.decl("suggest2-counter",{bindEvents:function(){this.__base.apply(this,arguments);var t=this.params.suggest;return BEM.blocks["suggest2-item"].on(t.domElem,"pointerclick",this._onClickPopup.bind(this)),this}}),BEM.DOM.decl("suggest2-counter",{attachReqID:function(){this._reqID=this._reqID||this.__self._generateReqID();var t=this.params.form.findElem("hidden-input").filter("[name=suggest_reqid]");t.length?t.val(this._reqID):this.params.form.appendHiddenInputs([{name:"suggest_reqid",value:this._reqID}])},_onSuggestSelect:function(t,e){this.__base.apply(this,arguments),e.item.params.safeclickUrl&&this._addMetrikaCookie(e.item)},_addMetrikaCookie:function(t){var e=this.params.suggest._model.lastSendedRequest.val,i=this.params.suggest._model.lastSendedRequest.reqId,n=[e,t.elem("link").attr("href"),this._getNavSource(),i].map(encodeURIComponent).join(":"),s=Date.now();document.cookie="sc_"+s+"="+n+";path=/watch;domain=."+(location.hostname.match(/yandex\..+$/)||[])[0]+";expires="+new Date(s+6e5).toUTCString()+";secure"},_getNavSource:function(){return"/"},clear:function(){return this.__base.apply(this,arguments),this._path.submit="button_by_mouse",this}}),function(t){var e=t.event.special.leftclick={setup:function(){t(this).bind("click",e.handler)},teardown:function(){t(this).unbind("click",e.handler)},handler:function(e){e.button||(e.type="leftclick",t.event.dispatch.apply(this,arguments),e.type="click")}}}(jQuery),BEM.DOM.decl({block:"suggest2",modName:"theme",modVal:"flat"},{getPopupWidth:function(){var t=this._input.width();return this._input.get().hasMod("theme","normal")?t-2:t}}),BEM.DOM.decl({block:"suggest2-item",modName:"personal",modVal:"yes"},{onSetMod:{js:{inited:function(){this._catchEvents&&this._crossCatchHandler&&this.bindTo("cross",this._catchEvents,this._crossCatchHandler),this.historyElem=this.elem("text").text()}}},val:function(){return this.params.val?this.params.val:this.elem("text").text()},remove:function(t){var e=this;this.domElem.one("webkitTransitionEnd transitionend",function(){e.domElem.remove(),t&&t()}),this.domElem.css("height",0)}}),BEM.DOM.decl({block:"suggest2-item",modName:"personal",modVal:"yes"},{_catchEvents:"click",_crossCatchHandler:function(t){t.preventDefault(),t.stopImmediatePropagation(),this.trigger("delete")}}),BEM.DOM.decl({block:"suggest2",modName:"history",modVal:"yes"},{init:function(){return this.__base.apply(this,arguments),this._history=this.findBlockOn("suggest2-history"),this._historyData=this._history.getData(),this._history.on("update",this._onUpdate,this),this._boundAfterDomElemRemove=this._afterDomElemRemove.bind(this),this._updateHistory(),BEM.DOM.blocks["suggest2-item"].on(this.domElem,"delete",this._deleteHistoryItem,this),this},unbindAllEvents:function(){this._history.un("update"),this.__base.apply(this,arguments)},getDefaultParams:function(){return $.extend(this.__base(),{needRequestWithHistory:!1})},_onUpdate:function(t,e){this._historyData=e,this._updateHistory()},_updateHistory:function(){this._historyItems=this._getHistoryItems(),this._historyHtml=null},_deleteHistoryItem:function(t){var e=t.block.historyElem;$.ajax({url:this.params.deleteHistoryUrl+encodeURIComponent(e),method:"GET",dataType:"json",xhrFields:{withCredentials:!0}}).then(this._afterQueryRemove.bind(this,e,t.block))},_afterQueryRemove:function(t,e,i){BEM.DOM.blocks["suggest2-history"].updateState(),(this._findAndRemove(this._historyData.running,t)||this._findAndRemove(this._historyData.other,t))&&this._updateHistory(),e.remove(this._boundAfterDomElemRemove)},_afterDomElemRemove:function(){""===this._input.val()&&0===this._historyItems.length&&(this._model.reset(),this._doRequest())},_findAndRemove:function(t,e){var i=t.indexOf(e);return i>=0&&(t.splice(i,1),!0)},setItems:function(){if(!1===this._isShowHistory())return this.__base.apply(this,arguments)},_doRequest:function(){this._isShowHistory()?(this._showHistory(),this.params.needRequestWithHistory?this.__base.apply(this,arguments):this._model.reset()):this.__base.apply(this,arguments)},_isShowHistory:function(){return this._historyData&&""===this._input.val()&&this._historyItems.length>0},_showHistory:function(){this._historyHtml||(this._historyHtml=this._view.html(this._historyItems,{historyMod:!0})),this._popup.show(this._historyHtml),this._items=this.findBlocksInside("suggest2-item")},_getHistoryItems:function(){var t=this._generateItems(this._historyData.running),e=this._historyData.other&&this._historyData.other.length>0?this._generateItems(this._historyData.other,BEM.I18N("suggest2","on_other_devices")):[];return e.length>0?t.concat(e):t},_generateItems:function(t,e){var i=this._view.__self._getPersonalProps(e),n=this._getPersonalItemType();return(t||[]).map(function(t){return[n,t,i]})}}),BEM.DOM.decl({block:"suggest2",modName:"history",modVal:"yes"},{_showHistory:function(){this.__base.apply(this,arguments),this._applyMetricsToContent()},_applyMetricsToContent:function(){this.__base.apply(this,arguments);var t=this.findElem("content");t.width(Math.min(t.width()+1,this._maxWidth))},_getPersonalItemType:function(){return"text"}}),BEM.decl({block:"suggest2-provider",modName:"history",modVal:"yes"},{getRequestData:function(t,e,i){return $.extend(this.__base.apply(this,arguments),{hs:BEM.DOM.blocks["suggest2-history"].getState()})}}),BEM.DOM.decl("suggest2-history",{_defaultParams:{running:[],other:[]},getDefaultParams:function(){return $.extend(this.__base(),this._defaultParams)},onAjaxSuccess:function(t){this.params=$.extend(this._defaultParams,t.params||{}),this.__self.updateState(),this.trigger("update",this.params)},getData:function(){return this.params}},{_state:0,updateState:function(){this._state++},getState:function(){return this._state}}),BEM.decl({block:"suggest2-view",modName:"advanced",modVal:"yes"},{_getItemByType:function(t,e,i,n){var s=n.js,o=n.content,r=t[1];switch(i){case"html":s.val=r,o.push(e.body);break;case"bemjson":s.val=r,o.push.apply(o,Array.isArray(e.bemjson)?e.bemjson:[e.bemjson])}return this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"suggest2-item",modName:"interact",modVal:"link"},{onSelect:function(t){var e=this;e.__base.apply(e,arguments);var i=e.elem("link");if(t||"_self"===i.attr("target"))return function(){e._locationChange(i.attr("href"))}},_locationChange:function(t){window.location=t},valOnSelect:function(){return!1}}),BEM.DOM.decl({block:"suggest2",modName:"adaptive",modVal:"yes"},{init:function(){this.__base.apply(this,arguments),this._boundResizeHandler=this._resizeHandler.bind(this),this.__self._bindToWinResize(this._boundResizeHandler)},_resizeHandler:function(){this._popup.width(this.getPopupWidth())},destruct:function(){this.__self._unbindFromWinResize(this._boundResizeHandler),this._boundResizeHandler=null,this.__base.apply(this,arguments)}},{_resizeCallbacks:[],_bindToWinResize:function(t){return this._resizeCallbacks.push(t),this},_unbindFromWinResize:function(t){for(var e=0;e<this._resizeCallbacks.length;e++)if(this._resizeCallbacks[e]===t)return this._resizeCallbacks.splice(e,1),this;return this},_getResizeCallback:function(){return $.throttle(function(){var t=arguments;this._resizeCallbacks.forEach(function(e){e.apply(this,t)},this)},300,this)},live:function(){return this._resizeCallback=this._getResizeCallback(),BEM.DOM.win.on("resize",this._resizeCallback),this.__base()}}),BEM.DOM.decl({block:"suggest2",modName:"adaptive",modVal:"yes"},{_minWidth:0,_maxWidth:0,_resizeHandler:function(){this.__base.apply(this),this.afterCurrentEvent(function(){this.adjustView()})},_onShow:function(){this.__base.apply(this),this.hasMod("theme","large")&&this._applyMetricsToContent()},adjustView:function(){var t=this.__base.apply(this,arguments),e=t.minWidth,i=t.maxWidth,n=!1;return e!==this._minWidth&&(this._minWidth=e,n=!0),i!==this._maxWidth&&(this._maxWidth=i,n=!0),n&&this._popup.isShown()&&this._applyMetricsToContent(),t},_applyMetricsToContent:function(){this.__base.apply(this,arguments);var t=this.findElem("content");this._minWidth&&t.css("min-width",this._minWidth),this._maxWidth&&t.css("max-width",this._maxWidth)}}),BEM.DOM.decl({block:"suggest2",modName:"ahead",modVal:"yes"},{init:function(){var t=this.__base.apply(this,arguments),e=this;return e._model.on("response",function(t,i){var n=i.data,s=n.items&&n.items[0],o=e._input.val(),r="object"==typeof s?s[1]:s,a="string"==typeof r&&0===r.indexOf(o.toLowerCase())&&r.slice(i.val.length);n.val=i.val,e.params.aheadFromServer?e._input.get().setAhead(i.val+(n.meta&&n.meta.continue||"")):a&&o.length>=e.params.showOverChars?e._input.get().setAhead(i.val+(e.params.showFullPhrase?a[1]:a[1].split(" ")[0])):e._input.get().unsetAhead()}),t},getDefaultParams:function(){return $.extend(this.__base(),{aheadFromServer:!1,showOverChars:3,showFullPhrase:!1})}}),BEM.DOM.decl("suggest2-form",{onSetMod:{js:{inited:function(){this._isReady=!1,this._nodes=this.initNodes()}}},getDefaultParams:function(){return{inputName:"input",buttonName:"button2",popupName:"popup"}},destruct:function(){this._nodes.forEach(function(t){t.suggest.domElem&&BEM.DOM.destruct(t.suggest.domElem),this.unbindFormEvents(t),t.counter&&t.counter.destruct(),t.proxies.input.destruct(),t.proxies.popup.destruct()},this),this.__base.apply(this,arguments)},getOwner:function(t){},isReady:function(){return this._isReady},initNodes:function(){var t=this.getNodes();return t.forEach(function(t){t.suggest.init()}),this._isReady=!0,this.trigger("ready",{nodes:t}),t},getNodes:function(){return this.getNodeList().map(function(t){var e=t.suggest,i=e.params;return i.form=this,i.input=t.input,i.popup=t.popup,i.button=t.button,t.proxies={},t.proxies.popup=i["suggest2-popup"]=BEM.create({block:"suggest2-popup",mods:$.extend({for:this.params.popupName},this.params.popupMods)},this._getNodePopupParams(e,i)),t.proxies.input=i["suggest2-input"]=BEM.create({block:"suggest2-input",mods:this.params.inputMods},this._getNodeInputParams(e,i)),t.counter&&(t.counter.params.form=this,t.counter.params.suggest=e,i.counter=t.counter),this.bindFormEvents(t),t},this)},_getNodeInputParams:function(t,e){return{suggest:t,input:e.input,updateOnEnterByKeyboard:e.updateOnEnterByKeyboard}},_getNodePopupParams:function(t,e,i){return{suggest:t,popup:e.popup,popupContentElem:this.params.popupContentElem,owner:this.getOwner(i)||e.input}},bindFormEvents:function(t){var e=this;return t.button&&t.button.bindTo("pointerclick",function(t){e._onButtonClick(t)}),e.bindTo("submit",function(t,i){e.onSubmit(t,i)}),e},_onButtonClick:function(t){this.trigger("button-click",{domEvent:t})},unbindFormEvents:function(t){return t.button&&t.button.un("pointerclick"),this.unbindFrom("submit"),this},submit:function(t){return this.domElem.trigger("submit",t||{}),this},onSubmit:function(t,e){t.data=e||{},this.trigger("submit",t)},getNodeList:function(){var t=this,e=[];return t.elem("node").each(function(i,n){var s=$(n),o=t._getFormNodeElems(s);e.push(t._getFormNodeBlocks(o,s))}),e},_getFormNodeElems:function(t){return{input:this.findElem(t,"input"),button:this.findElem(t,"button")}},_getSuggestForNode:function(t){return this.findBlockInside(t,"suggest2")},_getFormNodeBlocks:function(t,e){var i=this._getSuggestForNode(e);return{node:e,suggest:i,counter:this.findBlockOn("suggest2-counter"),input:this.findBlockOn(t.input,"input"),button:this.findBlockOn(t.button,this.params.buttonName),popup:i.findBlockOn(this.params.popupName)}},appendHiddenInputs:function(t){return BEM.DOM.append(this.domElem,BEMHTML.apply(t.map(function(t){return{block:this.__self.getName(),elem:"hidden-input",tag:"input",attrs:{type:"hidden",name:t.name,value:t.value}}},this))),this},removeHiddenInputs:function(){return BEM.DOM.destruct(this.findElem(this.domElem,"hidden-input")),this}},{live:function(){return this.liveInitOnBlockInsideEvent("pointerclick change focus","input"),this.__base()}}),function(){"use strict";BEM.DOM.decl({block:"suggest2-form",modName:"stats",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._bindCounters()}}},_prepareCounterStats:function(t){var e=[];try{e.push(t.since_last_change),e.push(t.since_first_change),e.push(t.user_input.length),e.push(t.ratio.actionsCount),e.push(t.path.index),e.push("button_by_mouse"===t.path.submit?"1":"0"),e.push("edit"===t.path.state?"1":"0")}catch(t){return""}return e.join(",")},_bindCounters:function(){var t,e=this,i=e.findBlockInside("suggest2").getCounter();i&&i.on("submit",function(i,n){var s;t&&t.remove(),(s=e._prepareCounterStats(n))&&(t=$("<input>",{type:"hidden",name:"csg",value:s}),e.domElem.append(t))})}})}(),function(){"use strict";BEM.DOM.decl({block:"suggest2-form",modName:"prefetch",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._bindPrefetch()}}},_prefetchQuery:function(t){var e,i=this;i._prefetchStarted[t]||(i._prefetchStarted[t]=!0,i._nodes[0].counter.attachReqID(),e=this._getParams(t),$.ajax({url:i.domElem.attr("action")+i._serializeFormParams(e),success:function(){i._prefetchLoaded[t]=!0},cache:!0}).then(null,function(t,e,i){home.error.logAjaxError({block:"suggest2",message:"_prefetchQuery: ajax",source:"suggest2",page:"morda_comtr"},t,e,i)}))},_bindPrefetch:function(){var t=this,e=!1;t._input=t.findBlockInside("input"),t._prefetchStarted={},t._prefetchLoaded={};try{if(window.sessionStorage.setItem("test","1"),"1"!==window.sessionStorage.getItem("test"))return;window.sessionStorage.removeItem("test")}catch(t){return}t.domElem.on("submit",function(){var i=t._input.val();t._prefetchStarted[i]&&(e||(e=!0,t.domElem.append('<input type="hidden" name="prefetch" value="1">'),t._prefetchLoaded[i]||t.domElem.append('<input type="hidden" name="unfinished" value="1">')));try{window.sessionStorage.setItem("x",(new Date).getTime())}catch(t){}}),t._nodes[0].suggest.getModel().on("response",function(e,i){var n=i&&i.data;if(n&&n.meta&&"yes"===n.meta.instant&&n.meta.prefetch)for(var s=0,o=n.meta.prefetch.length;s<o;++s)t._prefetchQuery(n.meta.prefetch[s])})},_getParams:function(t){var e=[];return this.domElem.find("input").each(function(){var i=$(this),n=i.prop("name");n&&e.push({name:i.prop("name"),value:"text"===n?t:i.val()})}),e.push({name:"prefetch",value:1}),e},_serializeFormParams:function(t){for(var e=[],i=0;i<t.length;++i)e.push(encodeURIComponent(t[i].name)+"="+encodeURIComponent(t[i].value));return"?"+e.join("&")}})}(),BEM.decl("i-voice",{},{hasMicSupport:function(t){if("Promise"in window&&(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia)){var e;if(navigator.enumerateDevices?e=navigator.enumerateDevices.bind(navigator):(window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(e=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(e=function(t){navigator.mediaDevices.enumerateDevices().then(t)})),!e)return void t({message:"API is Not supported"});e(function(e){var i=e.some(function(t){return"audio"===t.kind||"audioinput"===t.kind});t(!i&&{message:"Mic is not available"})})}else t({message:"API is Not supported"})}}),function(){var t,e,i,n,s={},o=0;BEM.decl("i-voice",{},{events:{ERROR:"error",BEFORE_START_RECOGNIZE:"before-start-recognize",START_RECOGNIZE:"start-recognize",SPEECH_KIT_INIT:"speech-kit-init",SPEECH_KIT_ACCESS_GRANTED:"speech-kit-access-granted",RECOGNIZE_TEXT:"recognize-text",STOP_RECOGNIZE:"stop-recognize",PERMISSION_REQUEST:"permission-request"},eventsType:{ERROR_INIT:"error-init",ERROR_SPEECH_KIT:"error-speech-kit",SUCCESS_RECOGNIZE:"success-recognize",TIMEOUT_SUCCESS:"timeout-success",TIMEOUT_EMPTY:"timeout-empty"},TIMEOUT_RECOGNIZE:1e4,startRecognize:function(t){if(this._isOnline()){n=t,s={recognizedText:"",_startedRecognize:!0,maxTime:t.maxTime||0===t.maxTime?t.maxTime:this.TIMEOUT_RECOGNIZE};var o=window.AudioContext||window.webkitAudioContext;this._freeAudioContext();try{(i=i||new o).createScriptProcessor(256,1,1).disconnect()}catch(t){return void this.trigger(this.events.ERROR,{type:this.eventsType.ERROR_INIT,message:"AudioContext is not available"})}this.trigger(this.events.BEFORE_START_RECOGNIZE,{session:s}),this._getStreamer(t,function(n){if(n.err||!n.streamer)return this.trigger(this.events.ERROR,{type:this.eventsType.ERROR_INIT,message:n.err}),void this._freeAudioContext();window.ya.speechkit.audiocontext=i,s.streamer=n.streamer,this._speechKitStart(s,t),this.trigger(this.events.START_RECOGNIZE,{session:s}),e=setTimeout(function(){this.isStartedRecognize()&&!this.isPermissionProvided()&&this.trigger(this.events.PERMISSION_REQUEST,{session:s})}.bind(this),500)}.bind(this))}else this.trigger(this.events.ERROR,{type:this.eventsType.ERROR_INIT,message:"offline"})},_speechKitStart:function(t,e){var i=e.codec||window.ya.speechkit.FORMAT.OPUS||window.ya.speechkit.FORMAT.PCM16;t.streamer.start({lang:e.lang,model:e.recognitionModel,apikey:e.apikey,initCallback:this._speechKitInitHandler.bind(this),accessGrantedCallback:this._speechKitAccessGrantedHandler.bind(this),dataCallback:this._speechKitDataHandler.bind(this),errorCallback:this._speechKitErrorHandler.bind(this),format:i,particialResults:!0,utteranceSilence:Math.max(e.utteranceSilence||0,60),use_snr:Boolean(e.use_snr),yandexuid:e.yandexuid,applicationName:e.applicationName})},_isOnline:function(){return void 0===navigator.onLine||navigator.onLine},isStartedRecognize:function(){return s._startedRecognize},stopRecognize:function(t,i){this.isStartedRecognize()&&(clearTimeout(e),this._resetTimeout(),s._startedRecognize=!1,s.streamer&&s.streamer.abort(),clearTimeout(this._initFailedTimeout),this.trigger(this.events.STOP_RECOGNIZE,{type:t,session:s,data:i}))},isSpeechkitLoaded:function(){return window.ya&&window.ya.speechkit&&window.ya.speechkit.SpeechRecognition},isPermissionProvided:function(){return window.ya.speechkit.isPermissionProvided()},_freeAudioContext:function(){i&&i.close&&i.state&&("closed"!==i.state&&i.close(),i=null)},_speechKitDataHandler:function(t,e){o=0,this.afterCurrentEvent(function(){t&&(s.recognizedText=t,this.trigger(this.events.RECOGNIZE_TEXT,{session:s,isDone:e})),e&&this.stopRecognize(this.eventsType.SUCCESS_RECOGNIZE)}.bind(this))},_speechKitInitHandler:function(t){s.id=t,this._resetTimeout(),this._startTimeout(),clearTimeout(this._initFailedTimeout),this.trigger(this.events.SPEECH_KIT_INIT,{session:s})},_speechKitAccessGrantedHandler:function(){this._initFailedTimeout=setTimeout(function(){this.trigger(this.events.ERROR,{type:this.eventsType.ERROR_SPEECH_KIT,session:s,message:"offline"})}.bind(this),5e3),this.trigger(this.events.SPEECH_KIT_ACCESS_GRANTED,{session:s})},_speechKitErrorHandler:function(t){if("MediaDeviceFailedDueToShutdown"===t&&o<1)return this._speechKitStart(s,n),void o++;s._startedRecognize=!1,clearTimeout(e),this.trigger(this.events.ERROR,{type:this.eventsType.ERROR_SPEECH_KIT,session:s,message:t}),this._freeAudioContext()},_startTimeout:function(){s.maxTime&&(s._timerRecognize=setTimeout(this._timeoutHandler.bind(this),s.maxTime))},_resetTimeout:function(){s._timerRecognize&&(clearTimeout(s._timerRecognize),s._timerRecognize=null)},_timeoutHandler:function(){s._timerRecognize=null;var t=Boolean(s.recognizedText);this.stopRecognize(this.eventsType[t?"TIMEOUT_SUCCESS":"TIMEOUT_EMPTY"])},loadSpeechkit:function(t,e){this._loaded?e&&e():(this._loadCallbacks=this._loadCallbacks||[],this._loadCallbacks.push(e),1===this._loadCallbacks.length&&this._loadSpeechkit(t,function(t){this._loadCallbacks.forEach(function(e){e&&e(t)}),this._loadCallbacks=[],this._loaded=!0}.bind(this)))},_loadSpeechkit:function(t,e){var i=document.createElement("script");i.src=t+"/webspeechkit/v-1.0.5/webspeechkit-recognition.min.js",i.async=!0,i.crossOrigin="",i.onload=function(){e(!0)},i.onerror=function(){e(!1)},document.body.appendChild(i)},_initStreamer:function(e){try{e({streamer:t=new window.ya.speechkit.SpeechRecognition})}catch(t){e({err:"Error at SpeechStreamer create"})}},_getStreamer:function(e,i){var n=this;t?i({streamer:t}):this.isSpeechkitLoaded()?this._initStreamer(i):this.loadSpeechkit(e.origin,function(t){t?n.afterCurrentEvent(function(){n._initStreamer(i)}):i({err:"Error when loading webspeechkit"})})}}),void 0===window.ya&&(window.ya={}),void 0===window.ya.speechkit&&(window.ya.speechkit={});var r={websocketProtocol:"wss://",asrUrl:"webasr.yandex.net/asrsocket.ws",ttsUrl:"https://tts.voicetech.yandex.net",ttsStreamUrl:"webasr.yandex.net/ttssocket.ws",lang:"ru-RU",langWhitelist:["ru-RU","tr-TR","en-US","en-GB","uk-UA","ru","tr","en","uk","en-EN"],model:"notes",applicationName:"jsapi",apikey:"",uuid:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})};void 0===window.ya.speechkit._extend?window.ya.speechkit.settings=r:window.ya.speechkit.settings=window.ya.speechkit._extend(r,window.ya.speechkit.settings)}(),BEM.DOM.decl("voice-search-popup",{onSetMod:{js:{inited:function(){this._setupProperties()}}},state:{name:"state",opened:"opened",closed:"closed"},speechKitState:{name:"speechkit-state",init:"init",start:"start",recognized:"recognized",finish:"finish",error:"error",access:"access"},_indicatorHeightMultiplier:.8,SMOOTH_CONSTANT:.8,loadSpeechkit:function(t){BEM.blocks["i-voice"].loadSpeechkit(t)},startRecognition:function(t){this._voiceRecognition.startRecognize(t)},_setupProperties:function(){if(this._voiceRecognition=BEM.blocks["i-voice"],this._errorDescription={PermissionDenied:{title:home.l10n("voice-search.popup.noaccess.title"),subtitle:home.l10n("voice-search.popup.noaccess.subtitle")},ConnectionProblem:{title:home.l10n("voice-search.popup.connectionproblem.subtitle"),subtitle:home.l10n("voice-search.popup.connectionproblem.title")},other:{title:home.l10n("voice-search.popup.unknownerror.title")}},this._content=this.elem("content"),this._textElem=this.elem("text"),this._indicator=this.elem("indicator"),this._boundSetupIndicator=this._setupIndicator.bind(this),this._paranja=$(".voice-search-popup__paranja"),this._lastAmplitute=0,this._voiceRecognition){var t=this._voiceRecognition,e=t.events;this._voiceEventsType=t.eventsType,t.on(e.BEFORE_START_RECOGNIZE,this._onPreInit,this),t.on(e.SPEECH_KIT_INIT,this._onInit,this),t.on(e.SPEECH_KIT_ACCESS_GRANTED,this._onAccessGranted,this),t.on(e.ERROR,this._voiceOnError,this),t.on(e.RECOGNIZE_TEXT,this._voiceRecognizeText,this),t.on(e.STOP_RECOGNIZE,this._voiceStopRecognize,this),t.on(e.PERMISSION_REQUEST,this._voicePermissionRequest,this),this._calcSoundAmplitudePerFrameBinded=this._calcSoundAmplitudePerFrame.bind(this),this.bindTo("continue-button","click",this._onErrorContinueButtonPressed,this),this.bindTo("help-button","click",this._onErrorHelpButtonPressed,this)}},_calcSoundAmplitudePerFrame:function(){if(this._nodeAnalyzer){var t=new Uint8Array(this._nodeAnalyzer.frequencyBinCount);this._nodeAnalyzer.getByteFrequencyData(t);var e=Array.prototype.slice.call(t,0,4),i=e.reduce(function(t,e){return t+e},0)/e.length/255;this._onAudioChangeAmplitude(i),this._animationFrameId=window.requestAnimationFrame(this._calcSoundAmplitudePerFrameBinded)}},_onPreInit:function(){this._showLayout(),this.trigger("start")},_onAccessGranted:function(){this._attachCloseEvents(),this._setupIndicator(),this._showInitState()},_onInit:function(t,e){e.session&&e.session.streamer&&e.session.streamer.recorder&&(this._nodeAnalyzer=e.session.streamer.recorder.getAnalyserNode(),this._nodeAnalyzer.fftSize=32,this._nodeAnalyzer.smoothingTimeConstant=.95,this._calcSoundAmplitudePerFrameBinded()),this._showStartState()},_voiceRecognizeText:function(t,e){var i=e.session.recognizedText;i&&(this._startedRecognize=!0,this._setRecognizedText(i),this._showRecognizedState(),this.trigger("text",e))},_voiceStopRecognize:function(t,e){if(e.type===this._voiceEventsType.SUCCESS_RECOGNIZE||e.type===this._voiceEventsType.TIMEOUT_SUCCESS)return this.trigger("success",e),void setTimeout(function(){this.trigger("after-success",e),this._hideLayout()}.bind(this),this.__self.TIMEOUT_SUCCESS_RECOGNITION);this._hideLayout()},_voiceOnError:function(t,e){this._attachCloseEvents();var i=this._parseError(e.message);this._showErrorState(i)},_parseError:function(t){return-1!==(t=String(t)).indexOf("Socket error:")||"offline"===t?"ConnectionProblem":-1!==t.indexOf("not allowed")||"MediaDeviceFailedDueToShutdown"===t||"PermissionDismissedError"===t||"PermissionDeniedError"===t||"Permission denied"===t||"Permission dismissed"===t?"PermissionDenied":"other"},_attachCloseEvents:function(){var t=this._hideLayout.bind(this),e=new Date;this._paranja.on("click",function(){if(!(new Date-e>500))return!1;t()}),this.bindTo("close","click",t),this.bindToDoc("keydown",function(e){e.originalEvent&&"altKey"in e.originalEvent&&(home.stat.logPath("click","voice.popup.exit-key"),t())})},_showLayout:function(){this.afterCurrentEvent(function(){this.setMod(this._paranja,"state","open")}),home.stat.logDOMShow(this.domElem),home.stat.logDOMShow(this._paranja),this.trigger("show")},_hideLayout:function(){this._voiceRecognition.stopRecognize(),this.unbindFromDoc("keydown"),this._paranja.unbind("click"),this.unbindFrom("close","click"),window.cancelAnimationFrame(this._animationFrameId),this.delMod(this._paranja,"state"),this._hidePopup(),this.trigger("hide")},_onErrorContinueButtonPressed:function(){this._hideLayout()},_onErrorHelpButtonPressed:function(){this._hideLayout()},_bindEvents:function(){$(window).on("resize.voice-search-popup",this._boundSetupIndicator),$(window).on("popstate.voice-search-popup",this._hideLayout.bind(this)),$(window).on("scroll.voice-search-popup",this._hideLayout.bind(this)),this.__self._visibilityEventName&&$(document).one(this.__self._visibilityEventName+".voice-search-popup",function(){this.afterCurrentEvent(function(){this._hideLayout()})}.bind(this))},_unbindEvents:function(){$(window).off(".voice-search-popup"),this.__self._visibilityEventName&&$(document).off(this.__self._visibilityEventName+".voice-search-popup")},_setupIndicator:function(){var t=this.elem("content").height()*this._indicatorHeightMultiplier;t=Math.floor(t),this._indicator.width(t),this._indicator.height(t)},_getProcessedAmplitude:function(t,e){return this.SMOOTH_CONSTANT*t+(1-this.SMOOTH_CONSTANT)*e},_updateIndicatorWithAmplitude:function(t){var e=t<=this._lastAmplitute;if(t=this._getProcessedAmplitude(t,this._lastAmplitute),this._lastAmplitute=t,t<=.4||e)return this._indicator.css("transform",""),this._indicator.css("transition",""),void this._indicator.css("opacity","");var i=Math.min(1.2*t,1);this._indicator.css("transition","opacity .1s linear, transform 0s linear"),this._indicator.css("transform","translate(-50%, -50%) scale("+i+")"),this._indicator.css("opacity","1")},_showPopup:function(){this._bindEvents(),this._showLayout(),this.setMod(this.state.name,this.state.opened),history.pushState&&history.pushState(null,document.title,location.href)},_hidePopup:function(){this.getMod(this.state.name)===this.state.opened&&(this._unbindEvents(),this.setMod(this.state.name,this.state.closed))},_setRecognizedText:function(t){this._textElem.text(t)},_showInitState:function(){this.setMod(this.speechKitState.name,this.speechKitState.init),this._showPopup()},_showStartState:function(){this._setRecognizedText(""),this.setMod(this.speechKitState.name,this.speechKitState.start)},_showRecognizedState:function(){this.setMod(this.speechKitState.name,this.speechKitState.recognized)},_showErrorState:function(t){var e;this._errorDescription[t]&&(e=this._errorDescription[t].subtitle||"",this.setMod(this.speechKitState.name,this.speechKitState.error),this.elem("error-title").text(this._errorDescription[t].title),this.elem("error-subtitle").html(e),this._showPopup(),home.stat.logPath("show","voice.popup.error."+t))},_onAudioChangeAmplitude:function(t){this.getMod(this.speechKitState.name)!==this.speechKitState.finish&&this._updateIndicatorWithAmplitude(t)},_voicePermissionRequest:function(){this.setMod(this.speechKitState.name,this.speechKitState.access)}},{TIMEOUT_SUCCESS_RECOGNITION:700,live:!0,_visibilityEventName:function(){var t;return["hidden","mozHidden","webkitHidden","msHidden"].forEach(function(e){!t&&e in document&&(t=e)}),t&&t.replace(/hidden/i,"visibilitychange")}()}),BEM.DOM.decl("voice-search-popup",{_showErrorState:function(t){this.__base.apply(this,arguments);var e=!(!this.params.showMicHelper||"PermissionDenied"!==t);if(e){var i=home.l10n("voice-search.popup.chrome-permission.subtitle").replace("%icon%",'<div class="voice-search-popup__error-access-icon"></div>');this.elem("error-subtitle").html(i)}this.toggleMod("mic-helper","yes",e);var n="PermissionDenied"===t;this.toggleMod("show-help","yes",n)}}),function(){"use strict";var t=$.Deferred();$(function(){t.resolve()}),BEM.decl("i-message-locker",{},{blockOrder:[],acquireLock:function(t,e){var i,n=$.Deferred(),s=this;return this._initOrder(),t in this._blockOrderMap&&!this._locked?(i=this._blockOrderMap[t],!this._showPretender||this._showPretender.index>i?(this._showPretender?this._showPretender.deferreds.forEach(function(t){t.reject()}):this._initDelay.done(function(){setTimeout(function(){var t=s._showPretender.deferreds;s._locked=s._showPretender.name,s._closeFunc=e,s._showPretender=null,t.forEach(function(t){t.resolve()}),BEM.channel("i-message-locker").trigger("lock",s._locked)},0)}),this._showPretender={name:t,deferreds:[n],index:i}):this._showPretender&&this._showPretender.name===t?this._showPretender.deferreds.push(n):n.reject(),n):n.reject()},releaseLock:function(t){this._locked&&this._locked===t&&(this._locked="",this._closeFunc=null,BEM.channel("i-message-locker").trigger("unlock",t))},forceClose:function(){this._closeFunc&&this._closeFunc()},_blockOrderMap:void 0,_showPretender:void 0,_locked:"",_initDelay:t,_initOrder:function(){if(!this._blockOrderMap){this._blockOrderMap={};for(var t=0;t<this.blockOrder.length;++t)this._blockOrderMap[this.blockOrder[t]]=t}}})}(),BEM.decl("i-message-locker",{},{blockOrder:["b-time-banner","b-hs-balloon","dist-popup","themes-touch-promo","stream-promo-popup","themes-promo","media-zen-promo"]}),BEM.DOM.decl({name:"input",modName:"voice-search",modVal:"yes"},{onSetMod:{js:function(){var t=this;this.__base.apply(this,arguments),this._hasRecognized=!1,BEM.blocks["i-voice"].hasMicSupport(function(e){e?t.delMod("voice-search"):(t.hasMod(t.elem("clear"),"visibility","visible")||t.delMod(t.elem("voice-search"),"visibility"),home.stat.logPath("show","voice"))})}},onElemSetMod:{clear:{visibility:function(t,e,i){this.__base.apply(this,arguments),this.toggleMod(this.elem("voice-search"),"visibility","hidden","","visible"===i)}}},_initVoicePopup:function(){if(!this._popupInited){this._popupInited=!0;var t=$(home.view("voice-search-popup",{showMicHelper:this.params.showMicHelper})).appendTo("body").filter(".voice-search-popup"),e=this;this._voicePopup=t.bem("voice-search-popup",{showMicHelper:this.params.showMicHelper}),this._voicePopup.on({start:function(){e._setVoiceSearchState(!0)},hide:function(){e._setVoiceSearchState(!1)},text:function(t,i){BEM.channel("voice-search").trigger("change"),i.session.recognizedText&&(e._hasRecognized||(e._hasRecognized=!0,home.stat.logPath("click","voice.data")))},success:function(t,i){e.val(i.session.recognizedText,{suggest:!1})},"after-success":function(){e._setVoiceSearchState(!1),e._submitForm()}})}},_setVoiceSearchState:function(t){this.toggleMod(this.elem("voice-search"),"active","yes",t)},_submitForm:function(){var t=this.findBlockOutside("suggest2-form");t.domElem.append($("<input>",{type:"hidden",name:"query_source",value:"voice"})),t.submit()},startRecognize:function(){this.setMod("focused",""),this._initVoicePopup(),BEM.blocks["i-message-locker"].forceClose(),BEM.channel("voice-search").trigger("init"),this._voicePopup.startRecognition({origin:this.params.webspeechkitStaticOrigin,lang:this.params.recognitionLocale,apikey:"5e7c4b34-f4ff-49c1-a683-44439c124cc8",recognitionModel:"general",utteranceSilence:this.params.recognitionUtteranceSilence||100,applicationName:this.params.webspeechkitApplication})},_loadLib:function(){this._initVoicePopup(),this._voicePopup.loadSpeechkit(this.params.webspeechkitStaticOrigin)},_updateClear:function(){this._startedRecognize||this.__base.apply(this,arguments)}},{live:function(){var t=this.__base.apply(this,arguments);return this.liveBindTo("voice-search","mouseover",function(){this._loadLib()}),this.liveBindTo("voice-search","pointerclick",function(){home.stat.logPath("click","voice.on"),this.startRecognize()}),t}}),BEM.DOM.decl({block:"search2",modName:"sticky",modVal:["always","scroll"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._mode="static",this._headerGenerated=!1,this._prevScroll=0,this._$search=$(home.cls.full(".container__search")),this._suggest=this.findBlockInside("suggest2"),this._suggestPopup=this.findBlockOn(this._suggest.domElem,"popup"),this._$placeholder=null;var t=!!BEM.blocks["i-ua"].passiveEvents&&{passive:!0},e=this._handleScroll.bind(this);window.addEventListener("scroll",e,t),window.addEventListener("resize",e,t),window.addEventListener("orientationchange",e,t);var i=this.findBlockInside("input"),n=this._onInputInteract.bind(this);i.on("beforeFocus",n),i.elem("control").on("keydown",n)}}},_getSearchTop:function(){return("static"!==this._mode&&this._$placeholder||this._$search).offset().top},_getMode:function(t,e){var i=this.getMod("sticky"),n=500;return"static"!==this._mode&&(n-=150),t>e+n?"always"===i?"fixed":t+150<this._prevScroll?"fixed":t>this._prevScroll+150?"static"!==this._mode?"hiding":"static":this._mode:"static"!==this._mode&&t>e+200?"hiding":"static"},_handleScroll:function(){var t=$(window).scrollTop(),e=this._mode,i=this._getSearchTop(),n=this._getMode(t,i);this._prevScroll="static"===e||"hiding"===e?Math.max(t,this._prevScroll):Math.min(t,this._prevScroll),BEM.blocks["usermenu-link"].hide(),BEM.blocks.notifier.hide(),this._hideDropdowns(),e!==n&&(this._mode=n,clearTimeout(this._transitionTimeout),this._$search.addClass(home.cls.full("container__search_fixed-transition_yes")),this._transitionTimeout=setTimeout(function(){this._$search.removeClass(home.cls.full("container__search_fixed-transition_yes"))}.bind(this),100),"fixed"===n?(home.stat.logPath("show","sticky_header.scroll"),this._makeFixed(!0)):"hiding"===n?this._$search.addClass(home.cls.full("container__search_fade_out")).onceAnimationEnd("animation",300,function(){"static"!==this._mode&&(this._mode="static",this._makeStatic())}.bind(this)):this._makeStatic(),this._suggest.instantHidePopup())},_appendStickyHeader:function(){if(!this._headerGenerated){this._headerGenerated=!0;var t=home.getData("sticky-header.data");t.mix=home.cls.full("container__search-header");var e=home.view("sticky-header",t);this._$searchHeader=$(e),BEM.DOM.append(this._$search,this._$searchHeader),home.stat.logDOMShow(this._$searchHeader,{visibilityCheck:!1})}},_hideDropdowns:function(){$(".popup2").each(function(){$(this).bem("popup2").delMod("visible")})},_makeFixed:function(t){this._$placeholder||(this._$placeholder=$('<div class="'+home.cls.full("container__placeholder")+'"></div>')),this._$placeholder.insertBefore(this._$search),this._$search.addClass(home.cls.full("container__search_fixed_yes")),t&&this._$search.addClass(home.cls.full("container__search_fade_in")),this._$searchHeader&&this._$searchHeader.appendTo(this._$search),this._suggest.setMod("theme","large").setMod("adjustable","yes").delMod("size"),this._suggestPopup.setMod("position","fixed"),this._appendStickyHeader()},_makeStatic:function(){this._$placeholder.detach(),this._$search.removeClass(home.cls.full("container__search_fixed_yes container__search_fade_in container__search_fade_out")),this._$searchHeader.detach(),this._suggest.setMod("theme","flat").delMod("adjustable").setMod("size","m"),this._suggestPopup.delMod("position")},_onInputInteract:function(){"fixed"!==this._mode&&($(window).scrollTop()<=this._getSearchTop()+500||(home.stat.logPath("show","sticky_header.input"),this._mode="fixed",this._makeFixed(!1)))}}),BEM.DOM.decl({block:"suggest2",modName:"theme",modVal:"large"},{initView:function(t,e){return t=t||{},this.__base($.extend(t,{adjustable:"yes",theme:"large",group:"false"!==this.getMod("group")&&(t.group||this.getMod("group")||"type")}),e)}}),BEM.decl({block:"suggest2-view",modName:"theme",modVal:"large"},{build:function(t,e){var i=this.__base.apply(this,arguments);return i.elemMods.theme="large",i}}),BEM.decl({block:"suggest2-view",modName:"theme",modVal:"large"},{getMinWidth:function(){return this._minWidth||0},getMaxWidth:function(){return this._maxWidth||0},setMinWidth:function(t){return this._minWidth=t,this},setMaxWidth:function(t){return this._maxWidth=t,this},getMarginLeft:function(){return this._marginLeft},setMarginLeft:function(t){return this._marginLeft=t,this},build:function(t,e){var i=this.__base.apply(this,arguments),n=["min-width:"+this.getMinWidth()+"px;"],s=this.getMaxWidth();s&&n.push("max-width:"+s+"px;");var o=this.getMarginLeft();return o&&n.push("margin-left:"+o+"px;"),i.attrs={style:n.join(" ")},i}}),BEM.DOM.decl({block:"suggest2",modName:"adjustable",modVal:"yes"},{_marginLeft:0,init:function(){this.__base.apply(this,arguments),this.adjustView()},adjustView:function(){var t=this.__base.apply(this,arguments);this._view.setMarginLeft(t.marginLeft),this._view.setMinWidth(t.minWidth),this._view.setMaxWidth(t.maxWidth);var e=!1;return t.marginLeft!==this._marginLeft&&(this._marginLeft=t.marginLeft,e=!0),e&&this._popup.isShown()&&this._applyMetricsToContent(),t},getInputLeft:function(){var t=this._input.get().findElem("control"),e=t.offset(),i=t[0];if(!i)return 0;var n=i.currentStyle?i.currentStyle:window.getComputedStyle(i),s=parseInt(n.borderLeftWidth,10)||0,o=parseInt(n.paddingLeft,10)||0;return e.left+s+o},getInputWidth:function(){return this._input.get().domElem.outerWidth()},getContainerWidth:function(){return BEM.DOM.scope.width()},_applyMetricsToContent:function(){this.__base.apply(this,arguments);var t=this.findElem("content");this._marginLeft&&t.css("margin-left",this._marginLeft)}}),BEM.decl({block:"suggest2-view",modName:"group",modVal:"type"},{buildItems:function(t,e){var i,n;return t.reduce(function(t,e){var s=this.__self._getPrefs(e),o=this.__self._getType(e,s),r=this.__self._getGroupType(s,o);return i!==r&&(i=r,n=[],t.push({block:"suggest2",elem:"group",content:[{elem:"title",content:this.__self._getTextLabel(i)},{elem:"items",content:n}]})),n.push(this.buildItem(e)),t}.bind(this),[])}}),BEM.decl({block:"suggest2-view",modName:"group",modVal:"type"},{buildItems:function(t){var e,i;return t.reduce(function(t,n){var s=this.__self._getPrefs(n),o=this.__self._getType(n,s),r=this.__self._getGroupType(s,o);return e!==r&&(e=r,i=[],t.push(this.buildGroup(s,o,[{elem:"title",content:this.__self._getTextLabel(e)},{elem:"items",content:i}]))),i.push(this.buildItem(n)),t}.bind(this),[])},buildGroup:function(t,e,i){return{block:"suggest2",elem:"group",content:i}}}),BEM.DOM.decl({block:"popup",modName:"position",modVal:"fixed"},{addChild:function(t){this.__base.apply(this,arguments),t.setMod("watch-scroll","no")},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocusable.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._firstFocusable.focus())}}),BEM.DOM.decl({block:"popup",modName:"position",modVal:"fixed"},{getOwnerPos:function(){var t=this.__base.apply(this,arguments);if(this._owner){var e=this._viewport;t.top-=e.scrollTop(),t.left-=e.scrollLeft()}return t}}),$.fn.onceAnimationEnd=function(t,e,i){var n,s="animation"===t?"webkitAnimationEnd animationend":"webkitTransitionEnd transitionend",o=this;function r(){clearTimeout(n),i=null,o.off(s)}this.on(s,function(t){o.is(t.target)&&i&&(i(o),r())}),n=setTimeout(function(){i&&(i(o),r())},e+50)},BEM.DOM.decl("suggest2-counter",{sendAjax:function(t,e){return e&&e.submitForm&&"sendBeacon"in navigator&&navigator.sendBeacon(t," ")?(this._sendAjaxAlways(e),this):this.__base.apply(this,arguments)}}),BEM.DOM.decl("suggest2-counter",{bindEvents:function(){var t=this.__base.apply(this,arguments);return this._input.domElem.one("click",function(){Ya.Rum.sendTimeMark("153.882")}),t},_getParams:function(t){return Object.keys(t).reduce(function(e,i){return""===t[i]?e:(e.push(i+"="+("vars"===i?t[i]:encodeURIComponent(t[i])).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%2C/g,",")),e)},[])},_getParamsList:function(){var t,e,i=this.__base.apply(this,arguments),n=home.stat.getCustomPageParams(),s={};if(window.Ya&&Ya.Rum&&Ya.Rum.sendTimeMark&&Ya.Rum.sendTimeMark("153.1896"),n){for(var o=0,r=(n=n.replace(/^\//,"").split("/")).length;o<r;o++)t=(e=n[o]).indexOf("="),s[e.substr(0,t)]=e.substr(t+1,e.length);var a=home.stat.getRoot(),c=home.getData?home.getData("timing.reqid"):"";return a&&(s.lid=a+".searchgo"),c&&(s.sid=c),i.concat(s)}return i}}),BEM.decl({block:"suggest2-view",modName:"rich",modVal:"yes"},{_getItemByType:function(t,e,i,n){var s=n.js,o=this._getItemTitle(t),r=t[3],a=t[4];switch(i){case"nav":var c={title:o,subtitle:r,url:a};switch(s.val=o,e.type){case"base":c.thumbSize="s",c.link=!0;break;case"market":c.thumbPadding=!0;case"video":c.thumbSize="l",c.link=!0;break;case"phone":s.val=r,c.link=!1}e.type&&this._buildRich(i,n,e,c);break;case"fact":switch(e.type){case"phone":s.val=r,this._buildRich(i,n,e,{title:o,subtitle:r,link:!1})}}return this.__base.apply(this,arguments)},_buildRich:function(t,e,i,n){return e.mods=e.elemMods||{},e.mods.flow=t,e.mods.interact=n.link?"link":"",e.mods.rich=!0,e.mods[t]=i.type,e.mods.monochrome=n.monochrome,e.mods.reverse=n.reverse,e.props=e.props||{},e.props.url=n.url,e.props.target=n.target||"_blank",e.content=[this._buildThumb(i.img,n.title,n.thumbSize||"m",n.thumbPadding||!1),{attrs:{style:"overflow: hidden"},content:[{elem:"text",elemMods:{type:"title"},content:n.title},{elem:"text",elemMods:{type:"subtitle"},content:[n.subtitle&&{tag:"span",content:n.subtitle},this._buildMark(i.mark),this._buildDescr(i.descr,n.subtitle,i.mark)]}]}],e},_buildThumb:function(t,e,i,n){return t&&t.url&&{elem:"thumb",elemMods:{shade:!0,aspect:t.aspect,size:i,padding:n,circle:t.circle},color:t.color,src:t.url,alt:e,badge:t.badge,badgeColor:t.badgeColor}},_buildMark:function(t){return t&&!Array.isArray(t)&&(t=[t]),t&&t.map(function(t){var e={};return e[t]=!0,{elem:"mark",elemMods:e}})},_buildDescr:function(t,e,i){if(t){t=t.slice();return Array.isArray(t)||(t=[t]),!e||i&&i.length||t.unshift(""),{elem:"desc",content:t.join("  ")}}},_getItemTitle:function(t){return t[2]}}),BEM.DOM.decl("home-arrow",{_onSampleClick:function(t){var e=this.findBlockInside("input");e&&(e.elem("control").attr("readonly",!0),e.onFirst("clear",function t(){e.elem("control").attr("readonly",!1),e.un("clear",t)}),e.val(t.text(),{source:"sample"}),this.trigger("sample-click"))}},{live:function(){var t=function(t){this._onSampleClick(t.data.domElem),t.preventDefault()};this.liveBindTo("sample-link","pointerclick",t),this.liveBindKey("sample-link","space enter",t)}}),BEM.DOM.decl("yabrowser-promo",{_install:function(){this.params.yaCounterId&&(BEM.blocks["i-metrika"].add({id:this.params.yaCounterId,triggerEvent:!0}),this.params.bannerid&&BEM.blocks["i-bannerid"].save(this.params.bannerid))}},{live:function(){this.liveBindTo("icon-link text-link","pointerclick",function(){return this._install()})}}),BEM.DOM.decl({block:"yabrowser-promo",modName:"install",modVal:"inline"},{_install:function(){var t=this.params,e=t.counters;return this._inlineInstall||(this._inlineInstall=BEM.create({block:"i-inline-install",mods:{api:t.api}},$.extend(t,{callbacks:{yes:function(){e.install&&((new Image).src=e.install)},no:function(){e.cancel&&((new Image).src=e.cancel)}}}))),this._inlineInstall.request().fail(function(){window.location=t.url}),e.click&&((new Image).src=e.click),home.stat.logPath("click","dist.searchlink.browser.link"),!1}}),BEM.DOM.decl({block:"yabrowser-promo",modName:"install",modVal:"download"},{_install:function(){return this.__base.apply(this),this._downloadInstance||(this._downloadInstance=BEM.create("i-install-download",this.params)),this._downloadInstance.download(),home.stat.logPath("click","dist.searchlink.browser.link"),!1}}),home.cls={full:function(t){return t},part:function(t){return t}},function(t){function e(t){var e=[];return t.replace(/(\d+)|\.|[^.\d]+/g,function(t,i){i?e.push(Number(i)):e.push(t)}),e}t.compareVersions=function(t,i){if(t===i)return 0;if(void 0===t||void 0===i||null===t||null===i)return NaN;for(var n=e(String(t)),s=e(String(i)),o=Math.max(n.length,s.length),r=0;r<o;++r){var a=n[r],c=s[r];if(void 0===a)return-1;if(void 0===c)return 1;if("."===a&&"."!==c)return-1;if("."===c&&"."!==a)return 1;if(typeof a!=typeof c&&(a=String(a),c=String(c)),a!==c)return a>c?1:-1}return 0}}(home),BEM.DOM.decl({block:"popup",modName:"type",modVal:"modal"},{getDefaultParams:function(){var t=this.__base();return t.top="50%",t.left="50%",t},_isPercentVal:function(t){return"string"==typeof t&&t.indexOf("%")>0},show:function(t){return this._moveToContainer(),this.setMod("visibility","outside").setMod("adaptive","no"),this.repaint(t),this},repaint:function(t){this._moveToContainer(),t||(t={left:this.params.left,top:this.params.top});var e=this.getPopupSize();return this._isPercentVal(t.left)&&!t.marginLeft&&(t.marginLeft=e.width/(-100/parseInt(t.left,10))),this._isPercentVal(t.top)&&!t.marginTop&&(t.marginTop=e.height/(-100/parseInt(t.top,10))),this._show(t),this}}),function(){"use strict";BEM.DOM.decl({name:"popup",modName:"focus",modVal:"capture"},{_onShown:function(){this.__base.apply(this,arguments),this.domElem.attr("tabindex","0").focus()},_onHidden:function(){this.__base.apply(this,arguments),this.domElem.removeAttr("tabindex")}})}(),BEM.DOM.decl({block:"popup",modName:"expand",modVal:"simple"},{afterShow:function(){var t=this.domElem,e=this;this._addBg(),t.stop(!0).css(this._getTransitionParams()),setTimeout(function(){t.addClass("popup_expand_transition-on").css(e._getClearParams()),setTimeout(function(){e._addContent()},e.params.duration)},0),(new Image).src=this.params.banner.showStat,this._addResizeEvent()},beforeHide:function(t){var e=this.domElem,i=this;e.stop(!0,!0).css(this._getTransitionParams()),setTimeout(function(){e.css(i._getClearParams()).removeClass("popup_expand_transition-on"),i._removeContent(),t()},this.params.duration),(new Image).src=this.params.banner.closeStat},_moveToContainer:function(){this._inContainer=!0},_getBannerCoords:function(){return $(".banner-iframe")[0].getBoundingClientRect()},_getPopupCoords:function(){return this.domElem[0].getBoundingClientRect()},_addBg:function(){$(".banner__expand_popup-inner",this.domElem).css({"background-color":this.params.banner.bg})},_addResizeEvent:function(){var t=this,e=function(){t.hide(),$(window).unbind("resize orientationchange",e)};$(window).bind("resize orientationchange",e)},_addContent:function(){var t=$(".banner__expand_popup-inner",this.domElem),e=location.protocol||"http:",i=this.params.banner.src,n=this.params.banner.vars,s="";s=this.params.banner.html5?'<iframe class="banner-iframe" name="bannerhtml5" src="'+i+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" width="100%" height="100%"></iframe>':"<object classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000 codebase="+e+'//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab width=100% height=100% ><param name="allowScriptAccess" value="Always" ><param name=movie value="'+i+'" ><param name=menu value=false><param name=quality value=high><param name=wmode value=opaque><param name="flashvars" value="'+n+'" ><EMBED src="'+i+'"  flashvars="'+n+'" quality=high  allowScriptAccess=Always wmode=opaque menu=false swLiveConnect=FALSE WIDTH=100% HEIGHT=100% TYPE="application/x-shockwave-flash" PLUGINSPAGE="'+e+'//www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash"></EMBED> </object>',t.children().length||t.append(s)},_removeContent:function(){this.params.banner.eraseContent&&$(".banner__expand_popup-inner",this.domElem).html("")},_getTransitionParams:function(){var t=this._getBannerCoords(),e=this._getPopupCoords(),i=t.height/e.height;return{transform:"translate3d("+(t.left+t.width/2-(e.left+e.width/2))+"px, "+(t.top+t.height/2-(e.top+e.height/2))+"px, 0) scale("+i+","+i+")",opacity:0}},_getClearParams:function(){return{transform:"translate3d(0, 0, 0) scale(1, 1)",opacity:1}}}),function(){function t(t){var e="#"===t.charAt(0)?t.slice(1):t,i=6===e.length?[e.slice(0,2),e.slice(2,4),e.slice(4,6)]:[e.slice(0,1)+e.slice(0,1),e.slice(1,2)+e.slice(1,2),e.slice(2,3)+e.slice(2,3)];return{r:(i=i.map(function(t){return parseInt(t,16)}))[0],g:i[1],b:i[2]}}function e(t){var e,i,n=t.r/255,s=t.g/255,o=t.b/255,r=Math.max(n,s,o),a=Math.min(n,s,o),c=(r+a)/2;if(r===a)e=i=0;else{var l=r-a;switch(i=c>.5?l/(2-r-a):l/(r+a),r){case n:e=(s-o)/l+(s<o?6:0);break;case s:e=(o-n)/l+2;break;case o:e=(n-s)/l+4}e/=6}return{h:e,s:i,l:c}}function i(t){var e,i,n,s=t.h,o=t.s,r=t.l;if(0===o)e=i=n=r;else{var a=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},c=r<.5?r*(1+o):r+o-r*o,l=2*r-c;e=a(l,c,s+1/3),i=a(l,c,s),n=a(l,c,s-1/3)}return{r:Math.round(255*e),g:Math.round(255*i),b:Math.round(255*n)}}function n(t){return 1===t.length&&(t="0"+t),t}function s(t,n){return function(t,n,s){var o=e(t);return o[n]+="l"===n&&s>0?(1-o.l)*s/100:o[n]*(s/100),i(o)}(t,"l",n)}function o(){return 1===this.opacity?"#"+n(this.rgb.r.toString(16))+n(this.rgb.g.toString(16))+n(this.rgb.b.toString(16)):"rgba("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+","+Number(this.opacity.toFixed(2))+")"}home.color=function(n){return{rgb:t(n),get hsl(){return e(this.rgb)},opacity:1,toString:o,lighter:function(t){return this.rgb=s(this.rgb,t),this},setOpacity:function(t){return this.opacity=t,this},setHsl:function(t){return this.rgb=i(t),this}}},home.color.parseHex=t,home.color.rgbToHsl=e,home.color.hslToRgb=i}(),BEM.DOM.decl(home.cls.full("direct-close-block"),{onSetMod:{js:{inited:function(){var t=0===this.elem(home.cls.part("close-block")).length;this.bindTo(home.cls.part("close-button"),"click",function(){t?(this.renderCloseBlock(),t=!1,setTimeout(function(){this.toggleMod(home.cls.part("state"),home.cls.part("closing"),home.cls.part("idle"))}.bind(this),50)):this.toggleMod(home.cls.part("state"),home.cls.part("closing"),home.cls.part("idle"))})}}},renderCloseBlock:function(){var t={pseudo:"yes"};this.hasMod(home.cls.part("closing-theme"),home.cls.part("dark"))?t.violet="yes":t.blue="yes";var e=this.params.data||home.getData("direct.data."+this.params.id),i=[{options:"3-2",text:home.l10n("direct.not_interest")},{options:"14-2",text:home.l10n("direct.bought_already")},{options:"5-3",text:home.l10n("direct.spam")}].map(function(e){return home.view("home-link",{content:e.text,mods:t,mix:"direct-close-block__close-reason "+home.cls.full("direct-close-block")+"__close-reason",attrs:{"data-id":e.options},stat:""})}).join("");this.domElem.prepend(home.view("direct-close-block__close-block",{buttons:i}),home.view("direct-close-block__confirm-block",{})),e&&e.sendStat&&home.stat.logPath("click",e.statName+".close")},_onReasonClick:function(t){var e=t.data.domElem.data("id").split("-"),i=this.params.data&&this.params.data.abuseUrl||home.getData("direct.data."+this.params.id+".abuseUrl"),n=home.parseUrl(i);e.length>0&&(n.query.reason=e[0],n.query["action-id"]=e[1],(new Image).src=home.makeUrl(n),this.setMod(home.cls.part("state"),home.cls.part("confirmed")))}},{live:function(){return this.liveBindTo("close-reason","click",function(t){return this._onReasonClick(t)}),!1}}),BEM.DOM.decl(home.cls.full("direct-desktop"),{onSetMod:{js:{inited:function(){this._checkHeight(),this._directWarningAnimation(),this._initCounter(),this._calcOverflow()}}},_initCounter:function(){this._counterSent=!1,BEM.blocks["i-visibilitychange"].waitForVisible(function(){var t,e=function(e,n){n.hidden?clearTimeout(t):t=setTimeout(i,2e3)},i=function(){this._sendCounter(),BEM.channel("sys").un("visibilitychange",e)}.bind(this);t=setTimeout(i,2e3),BEM.channel("sys").on("visibilitychange",e)}.bind(this))},_sendCounter:function(){var t=home.getData("direct.counter")||this.params.counter;t&&!this._counterSent&&((new Image).src=t,this._counterSent=!0)},_checkHeight:function(){var t=this.elem(home.cls.part("header")),e=this.elem(home.cls.part("text"));t.outerHeight(!0)+e.outerHeight(!0)>88&&home.stat.logPath("text_overflow","direct.card")},_directWarningAnimation:function(){if(!this.getMod(home.cls.part("warning-med"))){var t=this.elem(home.cls.part("caption")),e=this.elem(home.cls.part("caption-message")),i=t.width(),n=e.outerWidth(),s=n-i,o=s/20,r="."+home.cls.full("direct-desktop__caption-message")+"{-webkit-transition: -webkit-transform 0s linear;transition: transform 0s linear;transform: translate(0);}."+home.cls.full("direct-desktop__caption-message_animated")+"{-webkit-transition: -webkit-transform "+o+"s linear;transition: transform "+o+"s linear;-webkit-transform: translate("+-s+"px);transform: translate("+-s+"px);}";if(!(n<i))if(this.__styleTag=document.createElement("style"),this.__styleTag.innerText=r,document.head.appendChild(this.__styleTag),$(".i-ua_browser_touch").length){var a=!1;t.parent("."+home.cls.full("direct-desktop__link")).on("click",function(t){t.preventDefault(),a||(a=!0,c(),setTimeout(function(){l(),a=!1},1e3*o+1e3))})}else t.on("mouseover",c),t.on("mouseout",l)}function c(){e.addClass(home.cls.full("direct-desktop__caption-message_animated"))}function l(){e.removeClass(home.cls.full("direct-desktop__caption-message_animated"))}},destruct:function(){this.__styleTag&&document.head.removeChild(this.__styleTag),this.__base.apply(this,arguments)},_calcOverflow:function(){this.domElem.find(".i-multiline-overflow").each(function(){var t=$(this),e=t.data("lines");BEM.blocks["i-multiline-overflow"].calcOverflow(t,e)})}},{live:function(){var t=this,e=function(){this._sendCounter(),t.liveUnbindFrom("mouseover",e)};return this.liveBindTo("mouseover",e),!1}}),home.cssSupports=function(t,e){try{if(window.CSS&&CSS.supports)return CSS.supports(t,e);if(window.supportsCSS)return window.supportsCSS(t,e)}catch(t){}},function(){"use strict";var t=/(|\.\.\.)$/,e=home.cssSupports("-webkit-line-clamp","1")||home.cssSupports("text-overflow","-o-ellipsis-lastline");BEM.decl("i-multiline-overflow",{},{_hasNativeSupport:e,calcOverflow:function(t,e,i){if(!this._hasNativeSupport&&t.prop("offsetWidth")){var n=this;t.find(".i-multiline-overflow").add(t.filter(".i-multiline-overflow")).each(function(){var t=$(this),s=i&&n._cache[i];s||(s=n._calcProps(t),i&&(n._cache[i]=s)),t.text(n._insertEllipsis(t.text(),e,s))})}},_cache:{},_$measureElem:void 0,_appliedProps:{},_calcProps:function(t){var e=t.css("line-height"),i=t.css("font-size");return e="normal"===e?1.2*parseFloat(t.css("font-size")):parseFloat(e),{width:t.width(),lineHeight:e,fontFamily:t.css("font-family"),fontWeight:t.css("font-weight"),fontSize:i,wordWrap:t.css("word-wrap"),whiteSpace:t.css("white-space"),hyphens:t.css("hyphens"),wordBreak:t.css("word-break")}},_applyProps:function(t){this._$measureElem||(this._$measureElem=$('<div class="i-multiline-overflow__measure" aria-hidden="true"></div>').appendTo("body")),this._appliedProps.width===t.width&&this._appliedProps.fontSize===t.fontSize&&this._appliedProps.fontFamily===t.fontFamily&&this._appliedProps.lineHeight===t.lineHeight&&this._appliedProps.fontWeight===t.fontWeight&&this._appliedProps.wordWrap===t.wordWrap&&this._appliedProps.whiteSpace===t.whiteSpace&&this._appliedProps.hyphens===t.hyphens&&this._appliedProps.wordBreak===t.wordBreak||(this._appliedProps=t,this._$measureElem.css({width:t.width,fontSize:t.fontSize,fontFamily:t.fontFamily,fontWeight:t.fontWeight,lineHeight:t.lineHeight+"px",wordWrap:t.wordWrap,whiteSpace:t.whiteSpace,hyphens:t.hyphens,wordBreak:t.wordBreak}))},_calcLines:function(t,e){return this._$measureElem.text(t),this._$measureElem.height()/e.lineHeight},_insertEllipsis:function(e,i,n){var s,o=0,r=e.length;if(this._applyProps(n),this._calcLines(e,n)<=i+.5)return e;for(e=e.replace(t,"");o<r;)s=Math.ceil((o+r)/2),this._calcLines(e.substr(0,s)+"",n)>i+.5?r=s-1:o=s;return this._trim(e.substr(0,o))+""},_trim:function(t){return t.replace(/[-:;,.\s]+$/,"")}})}(),BEM.decl("i-multiline-overflow",{},{calcAutoOverflow:function(t){if(!this._hasNativeSupport){var e=this;t.find('[class *= "i-multiline-overflow_lines_"]:not(.i-multiline-overflow_overflowed_yes)').each(function(){var t=$(this),i=e._calcProps(t),n=t.attr("class").match("i-multiline-overflow_lines_(\\d+)"),s=n&&n[1];s&&t.addClass("i-multiline-overflow_overflowed_yes").text(e._insertEllipsis(t.text(),Number(s),i))})}}});var AwapsJsonAPI={Json:{}};function CAWBrowser(){var t,e=[];for(t=6;t<35;t++)e[t]=!1;var i=navigator.userAgent;this.msie=i&&parseFloat(navigator.appVersion)>=4&&i.indexOf("Opera")<0&&i.indexOf("MSIE 4")<0&&i.indexOf("MSIE")>=0,this.win=i&&(i.indexOf("Windows 95")>=0||i.indexOf("Windows NT")>=0||i.indexOf("Windows 98")>=0),this.mac=navigator.platform&&-1!==navigator.platform.indexOf("Mac"),this.opera7=-1!==i.indexOf("Opera")&&window.opera&&document.readyState?1:0,this.gecko=-1!==i.toLowerCase().indexOf("gecko")&&-1===i.indexOf("safari");var n=navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]?navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin:0;if(n)for(t=6;t<35;t++)e[t]=n,e[t]=parseInt(e[t].description.substring(e[t].description.indexOf(".")-2),10)>=t;else if(this.msie&&this.win&&!this.mac)for(t=6;t<35;t++)try{e[t]=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+t)}catch(t){}for(this.other=!((this.gecko||this.msie)&&this.win&&!this.mac),this.flash=0,t=6;t<35;t++)e[t]&&(this.flash=t);this.full_version=this.flash+"",n&&n.version&&(this.full_version=n.version+"")}AwapsJsonAPI.Json=function(t,e,i,n,s,o,r,a){void 0===a&&(a=""),a&&a.length>2&&a.indexOf(":")<0&&(a+=":"),this.w=e,this.h=i;for(var c=String(i);c.length<4;)c="0"+c;for(c=e+c;c.length<8;)c="0"+c;s||(s="awaps.yandex.ru"),n=n?"&charset="+n:"",o=o?"&subsection="+o:"",this.object_name=r||"aw_json";var l=Math.round(65535*Math.random());this.json_awaps_url=a+"//"+s+"/10/"+t+"/"+c+".?charset="+n+"&callback="+this.object_name+".awaps_callback&rnd="+l+n+o,this.gif_code='<a href="'+a+"//"+s+"/1/"+t+"/"+c+'.gif" target="_blank"  ><img src="'+a+"//"+s+"/0/"+t+"/"+c+".gif?rnd="+l+'" width="'+e+'" height="'+i+'" border="0" ></A>',this.awaps_div_code='<div id="awaps_ad_div" width="'+e+'" height="'+i+'"></div>'},AwapsJsonAPI.Json.prototype.setID=function(t){t&&(this.html_cont_id=document.getElementById(t))},AwapsJsonAPI.Json.prototype.refreshAd=function(){this.callJson(this.json_awaps_url)},AwapsJsonAPI.Json.prototype.callJson=function(t){if(t){var e=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=t,e.appendChild(i)}},AwapsJsonAPI.Json.prototype.awaps_callback=function(t){var e=t.media&&t.media[0];e&&(e.bnImg||e.bnHtm)&&this.drawBanner(this.html_cont_id,e)},AwapsJsonAPI.Json.prototype.sendCounts=function(t){home.getData("common.reportVisibilityCheck")?BEM.blocks["i-visibilitychange"].waitForVisible(function(){this.sendCountsChecked(t)}.bind(this)):this.sendCountsChecked(t)},AwapsJsonAPI.Json.prototype.sendCountsChecked=function(t){window.home=window.home||{},window.home.bnCounts||(window.home.bnCounts=[]);var e=this;if(t.win_notice&&t.win_notice.length&&t.win_notice.forEach(function(t){e.sendCount(t,0,"win")}),t.bnCounts&&t.bnCounts.length){var i=1e3*t.stat_delay_sec;e.activateDelayedCounts(t.bnCounts,i,"bncount",t.contentCls)}t._moatUrl&&this.sendMoatCount(t._moatUrl)},AwapsJsonAPI.Json.prototype.activateDelayedCounts=function(t,e,i,n){if(!t||0!==t.length){var s=this,o=n?$("."+n):null,r=function(){s.bannerIsInvisible()||(BEM.channel("sys").un("visibilitychange",a),o&&o.off("mouseover",r),s._delayedTimeoutId&&(clearTimeout(s._delayedTimeoutId),s._delayedTimeoutId=null),t.forEach(function(t){s.sendCount(t,0,i)}))},a=function(){s._delayedTimeoutId&&clearTimeout(s._delayedTimeoutId),s._delayedTimeoutId=setTimeout(r,e)};BEM.channel("sys").on("visibilitychange",a),o&&o.on("mouseover",r),a()}},AwapsJsonAPI.Json.prototype.sendCount=function(t,e,i){var n=Math.round(65535*Math.random()),s=String(t).replace("%aw_random%",n),o=this;if(s){if(this.shownHash=this.shownHash||{},0===s.indexOf("https://awaps.yandex.net")){var r=home.parseUrl(s);r.query.pageview_id=home.getData("statlog.config.showId"),s=home.makeUrl(r)}setTimeout(function(){o.bannerIsInvisible()||((new Image).src=s,i&&!o.shownHash[i]&&home.stat.logPath("show","awaps_vis."+i))},e),home.bnCounts.push(s)}},AwapsJsonAPI.Json.prototype.sendMoatCount=function(t){var e=document.createElement("iframe");e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),e.style.display="none",e.onload=function(){var i=e.contentWindow.document,n=i.createElement("script");n.async=!0,n.src=t,i.getElementsByTagName("head")[0].appendChild(n)};var i=$("#banner");if(i.length&&i.children().length){var n=i.children()[0];$(n).before(e)}else $("body").append(e)},AwapsJsonAPI.Json.prototype.drawBanner=function(t,e){var i;t&&(i=this.getHTML(e),$(t).append(i),BEM.blocks["i-performance"].preparePerformanceBuffer(),this.sendCounts(e),this.autorefresh(e,$(home.cls.full(".b-banner__wrap"))))},AwapsJsonAPI.Json.prototype.getHTML=function(t){var e=-1!==document.documentElement.className.indexOf("i-ua_browser_presto"),i=t.html5_iframe_src||t.small_swiffy_iframe_src||t.bnHtm||t.small_iframe_src,n="";if(i&&!e){var s=$(home.view("b-banner__iframe",{src:i,name:"b"+(Math.random()+"").substr(3,7)}));s[0].onload=function(){BEM.blocks["i-performance"].checkUrlLoaded(i)||$("#banner.b-banner__content").parents(".container__banner").eq(0).hide()},n=s}else if(t.image)n=home.view("b-banner__img",{attrs:{src:window.detector.isRetina()&&t.hidpi_image?t.hidpi_image:t.image,width:t.width,height:t.height,border:0,alt:t.image_alt}}),t.click_url&&(n=home.view("b-banner__link",{url:t.click_url,content:n}));else if(this.checkFlash(t)){var o=location.protocol||"http:";0===o.toLowerCase().indexOf("https")&&(t.bnFlash+="&cache=1"),n="<object classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000 codebase="+o+"//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab width="+t.bnW+" height="+t.bnH+' ><param name="allowScriptAccess" value="Always" ><param name=movie value="'+t.bnFlash+'" ><param name=menu value=false><param name=quality value=high><param name=wmode value=opaque><param name="flashvars" value="'+t.flashvars+'" ><EMBED src="'+t.bnFlash+'"  flashvars="'+t.flashvars+'" quality=high  allowScriptAccess=Always wmode=opaque menu=false swLiveConnect=FALSE WIDTH='+t.bnW+" HEIGHT="+t.bnH+' TYPE="application/x-shockwave-flash" PLUGINSPAGE="'+o+'//www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash"></EMBED> </object>'}else t.bnImg&&t.bnW&&t.bnH&&(n=home.view("b-banner__img",{attrs:{src:t.bnImg,width:t.bnW,height:t.bnH,border:0,alt:t.bnAlt}}),t.gif_tizer||(n=home.view("b-banner__link",{url:t.bnHref,content:n})));return n},AwapsJsonAPI.Json.prototype.autorefresh=function(t,e){t._refresh&&(e&&e[0]&&(this.bannerIsInvisible()||this.isBannerExpandable(t)||(t._refresh.limit<=0?BEM.blocks["i-performance"].destroy():new(function(t){function e(t){t||(t={}),this._url=t.url||"/portal/ntp/banner",this._node=t.node,this._loadTimeout=t.loadTimeout||30,this._timeout=t.timeout,this._limit=t.limit||3,this._ratio=t.ratio||1,this._usedBanners=t.skip?t.skip.slice():[];var e=t.autoRefreshCheck||function(t){this._onError("No autorefresh check"),t()};this._check=e.bind(this,this.refreshBanner.bind(this)),this._query=t.queryParams,this._bannerClass=t.className,this._loadingClass=t.loadingClassName,this._wrapClass=t.wrapClass,this._onBannerMessage=t.onBannerMessage,this._container=this._node&&this._node.parentNode,"number"!=typeof this._timeout&&(this._onError("invalid timeout "+this._timeout+" set to 90"),this._timeout=90),this._node&&this._container||this._onError("invalid or detached node")}return e.prototype={_onError:function(t){var e=new Error("BannerRefresh:"+t);e.block="banner-refresh",this._node&&(e.meta={cls:this._node.className},this._container&&(e.meta.cnt=this._container.className)),home.error.log(e)},_bindOnMessage:function(e){this._onMessage&&this._unbindOnMessage(),this._onMessage=function(t){if(!e||e.contentWindow===t.source){var i;try{i=JSON.parse(t.data)}catch(t){return}i&&i.type&&(r(),this._unbindOnMessage(),this._onEvent(i,e))}}.bind(this);var i=function(){o(),e._loaded=!0},n=function(){r(),this._onEvent({type:"none"},e)}.bind(this),s=setTimeout(n,1e3*this._loadTimeout);function o(){e.removeEventListener("load",i),e.removeEventListener("error",n)}function r(){clearTimeout(s),o()}e.addEventListener("load",i),e.addEventListener("error",n),t.addEventListener("message",this._onMessage)},_unbindOnMessage:function(){this._onMessage&&(t.removeEventListener("message",this._onMessage),this._onMessage=null)},setRefresh:function(){this._timeout?setTimeout(this._check,1e3*this._timeout):this._check()},refreshBanner:function(){if(!(this._limit<=0)){this._limit--,this._timeout*=this._ratio;var t=home.deepExtend({},this._query);this._usedBanners.length&&(t["skip-banner"]=this._usedBanners.join(","));var e=home.addQueryToUrl(this._url,t);this._container?this._container.appendChild(this._createNew(e)):this._onError("No container on refresh")}},_onEvent:function(t,e){this._onBannerMessage&&this._onBannerMessage(t),"none"!==t.type?"statpixel"!==t.type&&(e._loaded?this._switchBanners():e.addEventListener("load",this._switchBanners.bind(this)),t.bannerId&&(this._usedBanners.push(t.bannerId),this._usedBanners.splice(0,this._usedBanners.length-10))):this._destroyNew()},_switchBanners:function(){this._container.removeChild(this._node),this._new.className=this._new.className.replace(new RegExp("\\b"+this._loadingClass+"\\b"),""),this._node=this._new,this._new=null,this.setRefresh()},_createNew:function(t){this._destroyNew();var e=this._new=document.createElement("iframe");if(e.className=this._bannerClass,this._bindOnMessage(e),e.src=t,this._wrapClass){var i=this._new=document.createElement("div");i.className=this._wrapClass,i.appendChild(e)}return this._new.className+=" "+this._loadingClass,this._new},_destroyNew:function(){if(this._new){var t=this._new;t.parentNode.removeChild(t),this._unbindOnMessage(),this._new=null}}},e}(window))({limit:t._refresh.limit,ratio:t._refresh.ratio,timeout:t._refresh.timeout,skip:t.skipBanner?t.skipBanner.split(","):[],queryParams:{"morda-refresh":"big",refresh_timeout:t._refresh.timeout,pageview_id:home.getData("statlog.config.showId"),slots:home.getData("timing.exp")||"","dark-theme":t.darkTheme},className:home.cls.full("b-banner__iframe"),loadingClassName:home.cls.full("b-banner__iframe b-banner_loading_yes"),node:e[0],autoRefreshCheck:this.autorefreshCheck.bind(this)}).setRefresh())))},AwapsJsonAPI.Json.prototype.readyForAutorefresh=function(){return!document.hidden},AwapsJsonAPI.Json.prototype.isAutorefreshInsertAllowed=function(t){return!this.isBannerExpandable(t)},AwapsJsonAPI.Json.prototype.autorefreshCheck=function(t){if(this.readyForAutorefresh())t();else{var e=this,i=function(n,s){s.hidden||(e.autorefreshCheck(t),BEM.channel("sys").un("visibilitychange",i))};BEM.channel("sys").on("visibilitychange",i)}},AwapsJsonAPI.Json.prototype.isBannerExpandable=function(t){return t.swf_big_show_url||t.big_iframe_src},AwapsJsonAPI.Json.prototype.addImageContent=function(){var t=home.getData("banner.image");t&&(this.sendCounts(t.data),$("."+t.contentCls).click(function(){window.open(t.data.href,"_blank")}))},AwapsJsonAPI.Json.prototype.addIframeContent=function(t,e,i){this.sendCounts(i);var n=document.createElement("iframe");if(n.className=home.getData("banner.cls.banner__size"),n.setAttribute("style",""),n.setAttribute("allowtransparency","true"),n.setAttribute("frameborder","0"),n.setAttribute("id",""),n.setAttribute("name",""),i.write||(n.src="data:text/html;charset=utf-8,"+encodeURIComponent(t)),this.addContent(e,n,i),i.write){var s=n.contentWindow.document;s.open(),s.write(t),s.close()}},AwapsJsonAPI.Json.prototype.addContent=function(t,e,i){i.noshcb&&this.removeShadowBlockers();var n=home.getData("banner.cls.banner__parent"),s=home.getData("banner.cls.banner__content"),o=home["_banner"+n];o?$("."+s,o).append(e):t.append(e)},AwapsJsonAPI.Json.prototype.bannerIsInvisible=function(){var t=home&&home.getData&&home.getData("banner.vis"),e=!0;if(1===t||3===t)e=$(".b-banner__content").is(":visible");else if(2===t){var i=home.getData("banner.cls.banner__parent"),n=home.getData("banner.cls.banner__content"),s=home["_banner"+i];if(s)e=$("."+n,s).is(":visible"),t=3;else{var o=home.getData("banner.cls.banner__content_imagegap"),r=home.getData("banner.cls.banner__content_imagesearch"),a=$("."+o),c=$("."+r),l=a.is(":visible"),h=c.is(":visible");a.length&&c.length?(e=l&&h,l||h?l?h||(t=7):t=6:t=5,-1===c.css("background-image").indexOf("yastatic")&&(t=8,e=!1)):e=$("."+n).is(":visible")}}else 4===t&&(e=$("."+home.getData("banner.cls.b-banner__content_direct")).is(":visible"));return t&&!e?t:0},AwapsJsonAPI.Json.prototype.restoreShadow=function(){var t,e=document.createElement("iframe");e.sandbox="allow-same-origin allow-scripts";try{document.body.appendChild(e),t=Object.getOwnPropertyDescriptor(e.contentWindow.Element.prototype,"createShadowRoot"),Object.defineProperty(Element.prototype,"createShadowRoot",t),Object.defineProperty(HTMLElement.prototype,"createShadowRoot",t)}catch(t){}try{document.body.removeChild(e)}catch(t){}},AwapsJsonAPI.Json.prototype.removeShadowBlockers=function(){this.restoreShadow(),home._cbCheck&&home._cbCheck();var t,e=document.documentElement;e.createShadowRoot&&((t=document.createElement("content")).innerHTML="",e.createShadowRoot().appendChild(t))},AwapsJsonAPI.Json.prototype.checkFlash=function(t){var e=new CAWBrowser,i=e.flash>=t.flashV&&(t.bnFlash||t.swf_big_show_url);return t.minFlashVersion&&e.full_version&&home.compareVersions(e.full_version,t.minFlashVersion)<0&&(i=!1),i},AwapsJsonAPI.Json.prototype.expand=function(t){if(this.isBannerExpandable(t)){var e=$("#banner");if(e.append('<div class="banner__expand_innerclick"></div>'),$(".banner__expand_innerclick").click(function(){window.open(t.click_url,"_blank")}),!(t.swf_big_show_url&&!this.checkFlash(t)||t.big_iframe_src&&!t.show_big)){e.addClass("banner__expand").append('<div class="banner__expand_inner"></div>');var i,n=$(".banner__expand_popup"),s=n?n.bem("popup"):null;if(home.expandableBannerAPI={close:function(){s&&s.hide()}},s)s.on({show:function(){i=Date.now()},hide:function(){i&&(t.show_big_seconds_stat_url&&((new Image).src=t.show_big_seconds_stat_url+Math.round((Date.now()-i)/1e3)),i=null)}}),$(window).on("message",function(t){t=t.originalEvent;var e=$(".banner-iframe",n)[0];if(e&&t.source===e.contentWindow){var i;try{i=JSON.parse(t.data)}catch(t){return}i&&i.command&&"close"===i.command&&setTimeout(function(){s.hide()},500)}});$(".banner__expand_inner").click(function(){if(s){var e=$(window).height(),i=$(window).width(),o=Math.min(1200,Math.floor(i-t._gapW)),r=Math.floor(9*o/16);return r>e-t._gapH&&(o=o*(e-t._gapH)/r,r=e-t._gapH),o<640||r<360?void window.open(t.click_url,"_blank"):($(".banner__expand_popup-inner",n).css({width:o,height:r}),s.show(),!1)}$(window).trigger("bannerpopup.show")})}}},AwapsJsonAPI.Json.prototype.checkTime=function(t){function e(){var e={};e[t.name]={},e[t.name][t.nameEnd]=1,window.defaultMetrikaCounter.params(e)}t&&function i(){var n;window.defaultMetrikaCounter?((n={})[t.name]={},n[t.name][t.nameStart]=1,window.defaultMetrikaCounter.params(n),setTimeout(e,t.timeout)):setTimeout(i,100)}()},$(function(){AwapsJsonAPI.Json.prototype.addImageContent()}),function(){"use strict";BEM.decl("i-performance",{onSetMod:{js:{inited:function(){if(window.performance&&"onresourcetimingbufferfull"in window.performance&&"addEventListener"in window.performance){this._expandTimingBuffer=this._expandTimingBuffer.bind(this),window.performance.addEventListener("resourcetimingbufferfull",this._expandTimingBuffer);var t=window.performance.getEntriesByType("resource").length;t>=this.__self._DEFAULT_TIMING_BUFFER_SIZE?(this._timingBufferSize=Math.ceil(t/this.__self._DEFAULT_TIMING_BUFFER_SIZE)*this.__self._DEFAULT_TIMING_BUFFER_SIZE,this._expandTimingBuffer()):this._timingBufferSize=this.__self._DEFAULT_TIMING_BUFFER_SIZE}}}},checkUrlLoaded:function(t){var e=!0;return window.performance&&window.performance.getEntriesByName&&(e=!1,window.performance.getEntriesByName(t).forEach(function(t){"resource"===t.entryType&&(e=!0)})),e},destruct:function(){this.__self._instance=null,"removeEventListener"in window.performance&&window.performance.removeEventListener("resourcetimingbufferfull",this._expandTimingBuffer),this.__base.apply(this,arguments)},_expandTimingBuffer:function(){this._timingBufferSize<this.__self._MAX_TIMING_BUFFER_SIZE?(this._timingBufferSize+=this.__self._DEFAULT_TIMING_BUFFER_SIZE,window.performance.setResourceTimingBufferSize(this._timingBufferSize)):window.performance.removeEventListener("resourcetimingbufferfull",this._expandTimingBuffer)}},{_DEFAULT_TIMING_BUFFER_SIZE:150,_MAX_TIMING_BUFFER_SIZE:1050,preparePerformanceBuffer:function(){this._instance||(this._instance=BEM.create(this.getName(),{}))},checkUrlLoaded:function(t){return this._instance||this.preparePerformanceBuffer(),this._instance.checkUrlLoaded(t)},destroy:function(){this._instance&&this._instance.destruct()}})}(),BEM.decl("i-visibilitychange",{},{waitForVisible:function(t){document.hidden?BEM.channel("sys").onFirst("visible",t):t()}});var RtbAPI=function(){};RtbAPI.prototype.sendCounts=function(t,e){home.getData("common.reportVisibilityCheck")?BEM.blocks["i-visibilitychange"].waitForVisible(function(){this.sendCountsChecked(t,e)}.bind(this)):this.sendCountsChecked(t,e)},RtbAPI.prototype.sendCountsChecked=function(t,e){t.counters&&t.counters.length&&this.activateDelayedCounts(t.counters,t.delay,"count",e)},RtbAPI.prototype.activateDelayedCounts=function(t,e,i,n){var s=this,o=n?$("."+n):null,r=function(){s.bannerIsInvisible()||(BEM.channel("sys").un("visibilitychange",a),o&&o.off("mouseover",r),s._delayedTimeoutId&&(clearTimeout(s._delayedTimeoutId),s._delayedTimeoutId=null),t.forEach(function(t){s.sendCount(t,0,i)}))},a=function(){s._delayedTimeoutId&&clearTimeout(s._delayedTimeoutId),s._delayedTimeoutId=setTimeout(r,e)};BEM.channel("sys").on("visibilitychange",a),o&&o.on("mouseover",r),a()},RtbAPI.prototype.sendCount=function(t,e,i){var n=this;t&&(this.shownHash=this.shownHash||{},setTimeout(function(){n.bannerIsInvisible()||((new Image).src=t,i&&!n.shownHash[i]&&home.stat.logPath("show","rtb_vis."+i))},e),window.home.bnCounts||(window.home.bnCounts=[]),home.bnCounts.push(t))},RtbAPI.prototype.bannerIsInvisible=function(){var t=home&&home.getData&&home.getData("rtb.vis"),e=!0;if(10===t||11===t)e=$("."+home.cls.full("rtb-image")).is(":visible");else if(12===t||13===t){var i=$("."+home.cls.full("rtb-iframe__content"));i.length&&(e=i.is(":visible"))}return t&&!e?t:0},RtbAPI.prototype.addImageContent=function(){var t=home.getData("rtb.image");if(t){var e=home.cls.full("rtb-image");this.sendCounts(t,e),t.href&&$("."+e).click(function(){window.open(t.href,"_blank")})}},RtbAPI.prototype.addIframeContent=function(){var t=home.getData("rtb.iframe");if(t){var e=home.cls.full("rtb-iframe__content"),i=home.cls.full("rtb-iframe");this.sendCounts(t,e);var n=$('<iframe class="'+e+'" frameborder="no" scrolling="no" allowtransparency="true" hidefocus="true" tabindex="-1" marginwidth="0" marginheight="0" sandbox="allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-scripts allow-forms"></iframe>');$("."+i).html(n);var s=t.html.replace("<head>",'<head><base href="'+t.basePath+'" target="_blank"></base>'),o=n[0].contentDocument;o.open(),o.write(s),o.close()}},$(function(){var t=new RtbAPI;t.addImageContent(),t.addIframeContent()});var rootDomain=document.domain.match(/([^.]+(?:\.com?)?\.)?[^.]+$/)[0];try{window.top||(document.domain=rootDomain)}catch(t){}BEM.DOM.declMix("mix-tabber",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._keys=this._getKeys(),this._data=this._getInitData(),this._selectedKey=this._defaultKey=this._getDefaultKey(),this._panels={},this._defaultPanels={},this._statRoot=this.params.statRoot||this.__self.getName(),this.elem("panel").toArray().forEach(function(t){var e=$(t),i=e.data("key");this._panels[i]=e,this._defaultPanels[i]=!0},this),this._$panel=this._panels[this._defaultKey]}}},_getKeys:function(){return this.params.keys},_getDefaultKey:function(){return this.params.selectedKey},_getInitData:function(){return this.params.data||{}},_selectTab:function(t,e){e=e||{},this._selectedKey===t||this._selectedParentKey===t&&!e.parentKey||this._changeTab(t,e)},_changeTab:function(t,e){var i=!this._panels[t],n=this._panels[t]||(this._panels[t]=this._createPanel(t));this._togglePanel(this._selectedKey,this._$panel,!1),this._togglePanel(t,n,!0),this._$panel=n,this._selectedKey=t,this._selectedParentKey=e.parentKey,this._afterPanelChange(t,n,!i)},_mapKeyToIndex:function(t){return this._keys.indexOf(t)},_createPanel:function(t){var e=$(home.view("mix-tabber__panel",{block:this.__self.getName(),id:this._uniqId,key:t,attrs:this._getPanelAttrs(t)}));return this._renderPanelInner(t,e,this._data[t]),e},_getPanelAttrs:function(){return{}},_renderPanelInner:function(t,e,i){e.append(this._getPanelHTML(t,i))},_afterPanelChange:function(t,e,i){i||this._onPanelDraw(t,e),this._onPanelChange(t,e)},_onPanelDraw:function(t,e){BEM.DOM.init(e),home.stat.logDOMShow(e)},_onPanelChange:function(){},_getPanelHTML:function(){return""},_togglePanel:function(t,e,i){e.attr("aria-hidden",i?"false":"true"),this._toggleMountPanel(t,e,i)},_toggleMountPanel:function(t,e,i){i?e.parent().length?e.css("display",""):this.elem("panels").append(e):e.css("display","none")}}),BEM.DOM.declMix("mix-tabber-labels",{_getKeys:function(){var t=this.elem("tab");return t.length?t.toArray().map(function(t){return String($(t).data("key"))}):this.__base.apply(this,arguments)},_getDefaultKey:function(){var t=this.elem("tab","selected","yes");return t.length?t.data("key"):this.__base.apply(this,arguments)},_changeTab:function(t,e){this.__base.apply(this,arguments);var i=this.elem("tab","selected","yes"),n=this.elem("tab").filter('[data-key="'+(e.parentKey||t)+'"]');this._toggleLabelSelection(i,!1),this._toggleLabelSelection(n,!0),e.focus&&n.focus()},_toggleLabelSelection:function(t,e){t.attr({tabindex:e?0:-1,"aria-selected":e?"true":"false","aria-controls":e?this._uniqId+"_panel_"+this._selectedKey:null}),this.toggleMod(t,"selected","yes","no",e),t.toggleClass("mix-tabber__tab_selected_yes mix-tabber__tab_selected_no")},_getPanelAttrs:function(t){return{"aria-labelledby":this._uniqId+"_tab_"+t}},_onTabClick:function(t){var e=t.data.domElem,i=String(e.data("key")),n=this._selectedKey===i;return this._selectTab(i),n?home.stat.redirect(e[0],e.data("stat-link")):home.stat.logPath("click",e.data("stat-select")),n}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("tab","pointerclick",function(t){return this._onTabClick(t)})}}),BEM.DOM.declMix("mix-tabber-labels-keyboard",{_selectTabByKeyboard:function(t,e){var i,n=this.elem("tab"),s=this._mapKeyToIndex(this._selectedParentKey||this._selectedKey);"relative"===t?s+=e:"absolute"===t&&(s=e),s<0?s=n.length-1:s>=n.length&&(s=0),i=n.eq(s),this._selectTab(String(i.data("key")),{focus:!0}),home.stat.logPath("click",i.attr(home.stat.attr))}},{live:function(){this.__base.apply(this,arguments),this.liveBindKey("tab","left right",function(t){return this._selectTabByKeyboard("relative",t.which===BEM.KEYS.LEFT?-1:1),!1}),this.liveBindKey("tab","home end",function(t){return this._selectTabByKeyboard("absolute",t.which===BEM.KEYS.HOME?0:-1),!1})}}),BEM.DOM.declMix("mix-tabber-slide2",{_changeTab:function(t){var e=this._mapKeyToIndex(this._selectedKey),i=this._mapKeyToIndex(t);this._showSide=e<i?"right":"left",this._hideSide=e<i?"left":"right",this.__base.apply(this,arguments)},_toggleMountPanel:function(t,e,i){this._panelMap=this._panelMap||{},this._panelMap[t]=i,i?(e.parent().length||this.elem("panels").append(e),e.removeClass("mix-tabber-slide2__panel_hide-side_left mix-tabber-slide2__panel_hide-side_right").addClass("mix-tabber-slide2__panel_hide-side_"+this._showSide).addClass("mix-tabber-slide2__panel_hidden_yes").removeClass("mix-tabber-slide2__panel_no-place_yes"),setTimeout(function(){this._panelMap[t]===i&&e.removeClass("mix-tabber-slide2__panel_hide-side_left mix-tabber-slide2__panel_hide-side_right").removeClass("mix-tabber-slide2__panel_hidden_yes").addClass("mix-tabber-slide2__panel_animated_yes").onceAnimationEnd("transition",250,function(){e.removeClass("mix-tabber-slide2__panel_animated_yes")})}.bind(this),200)):e.removeClass("mix-tabber-slide2__panel_hide-side_left mix-tabber-slide2__panel_hide-side_right").addClass("mix-tabber-slide2__panel_hide-side_"+this._hideSide).addClass("mix-tabber-slide2__panel_hidden_yes").addClass("mix-tabber-slide2__panel_no-place_yes").addClass("mix-tabber-slide2__panel_animated_yes")},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("mix-tabber-slide2__panel"),t}}),home.yellowskin=function(t,e){var i;return-1===e.indexOf("appsearch_header=1")&&((i=home.parseUrl(e)).query.appsearch_header=1,e=home.makeUrl(i)),home.makeUrl({scheme:"yellowskin",query:home.deepExtend({url:e},t)})},BEM.DOM.decl({block:"streamnow",baseMix:["mix-tabber","mix-tabber-labels","mix-tabber-labels-keyboard","mix-tabber-slide2"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._checkOverflow(),this._checkOverflowBound=home.throttle(this._checkOverflow.bind(this),100),this.bindToWin("resize",this._checkOverflowBound),this.bindTo("tabs","scroll",this._unscrollTabs),BEM.blocks["widget-control"].on(this.domElem,"show",this._checkOverflowBound,this)}}},destruct:function(){this.unbindFromWin("resize",this._checkOverflowBound),BEM.blocks["widget-control"].un(this.domElem,"show",this._checkOverflowBound,this),this._checkOverflowBound=null,this.__base.apply(this,arguments)},_getInitData:function(){return home.getData("streamnow.data")},_getPanelHTML:function(t,e){return e.key=t,home.view("streamnow__tab-panel",e)},_unscrollTabs:function(){this.elem("tabs").scrollLeft(0),this.elem("tabs").scrollTop(0)},_checkOverflow:function(){if(!this.hasMod("expand-tabs","yes")){this.delMod("overflow-tabs"),this.delMod(this.elem("tab-wrapper","hidden","yes"),"hidden");var t=this.elem("tabs");if(t.innerWidth()+1<t.prop("scrollWidth")){this.setMod("overflow-tabs","calc");var e=this.elem("tab"),i=t[0].getBoundingClientRect(),n=e.toArray(),s=this.elem("tab-wrapper","promoted","yes");if(s.length){var o=s.children()[0];(n=n.filter(function(t){return t!==o})).unshift(o)}for(var r=-1,a=this.elem("pseudotab").width()+12+(home.getData("widgets.alt")?18:0),c=1;c<n.length;++c){if(-1===r)n[c].getBoundingClientRect().right+a>i.right&&(r=c);r>-1&&this.setMod($(n[c]).parent(),"hidden","yes")}this.setMod("overflow-tabs","yes")}}},_toggleLabelSelection:function(t,e){if(this.__base.apply(this,arguments),e&&this.hasMod("overflow-tabs","yes")){var i=t.parent();this.delMod(this.elem("tab-wrapper","promoted","yes"),"promoted"),this.hasMod(i,"hidden","yes")&&this.setMod(i,"promoted","yes"),this._checkOverflowBound()}},_toggleExpand:function(t){this.toggleMod("expand-tabs","yes",t),this.elem("pseudotab").toggleClass("mix-tabber__tab_selected_no",!t).toggleClass("mix-tabber__tab_selected_yes",t),this.elem("tab","selected","yes").toggleClass("mix-tabber__tab_selected_no",t).toggleClass("mix-tabber__tab_selected_yes",!t)},_selectTab:function(){this.hasMod("expand-tabs","yes")&&this._toggleExpand(!1),this.__base.apply(this,arguments)},_onTabClick:function(){var t=this._selectedKey,e=this.hasMod("expand-tabs","yes");return this.__base.apply(this,arguments),this._selectedKey===t&&!e}},{live:function(){return this.__base.apply(this,arguments),this.liveBindTo("pseudotab","pointerclick",function(){var t=!this.hasMod("expand-tabs","yes");return this._toggleExpand(t),!1}),!1}}),BEM.DOM.decl("widgets",{onSetMod:{js:function(){window.Widget&&(this.save=home.debounce(this.save.bind(this),50),$(".i-ua_browser_msie8").length&&(this.oldIe=!0),this._hiddenWidgets={},this.history=[],this.historyAcceptedPosition=0,this.personalSettings=this.params.settings,this.initWapi(),this.channel("widget").on("abort-add",this.changeThis(function(t,e){this.onAbortAdd(e)})),this.channel("widget").on("commit",this.changeThis(function(t,e){this.commit(e),this._onUpdateWidgetList()})),this.channel("widget").on("tuned",this.changeThis(function(t,e){this.enableActionButton(),this.history.push(e)})),this.bindToWin("beforeunload",function(){if(this.history.length!==this.historyAcceptedPosition&&this.hasMod("drag"))return"\n"+home.l10n("informationsMessages.settingsNotSaved")+"\n"}),this.params.editMode&&(this.collectWidgetsOnPage(),this.setMod("drag","on")),this.params.add&&this.isNewPattern()&&(this.collectWidgetsOnPage(),this.hasMod("drag")||this.setMod("drag","add"),this.addWidget(this.params.add)),home.getData("widgets.alt")?(this.processHistoryState(),home.getData("widgets.altEdit")&&this.channel("widget").on("settingsSaved",function(){var t=this.collectData();this.wsave(t,!1)},this)):this.getWidgets().forEach(function(t){"hidden"===t.getMod("mode")&&(this._hiddenWidgets[t.getId()]=1)}.bind(this)))},drag:function(t,e,i){e?i||(Widget.Framework.setEdit(!0),this.recalculateWidgetCoords(),this.getParanja().appendTo(this.domElem[0]),this.oldIe||this.bindDrag(),this.processHistoryState()):(Widget.Framework.setEdit(!1),this.getParanja().detach(),this.unbindDrag())}},_afterSetMod:function(){this.__base.apply(this,arguments),this.domElem.removeClass("i-bem widgets_js_inited")},_onUpdateWidgetList:function(){var t,e=this.findBlockOutside("b-page"),i={};Widget.Framework.all().forEach(function(t){var e;t.params.removed||this._hiddenWidgets[t.id]||(e="Column"+t.params.position.split(":")[0],i[e]=1)},this),(t=home.view("media-grid__hide-media-footer-mode",{notEmptyColumns:i}))?e.setMod("hide-media-footer",t):e.delMod("hide-media-footer"),home.view("widgets__check-arrow-middle",{Widgets:{NotEmptyColumns:i},Skin:this.params.skin})?e.setMod("arrow-middle","yes"):e.delMod("arrow-middle")},canAddWidget:function(t){return this.domElem.find(".widget:not(.widget_removed_yes)").length<50-(t||0)},initWapi:function(){var t=this.params,e=t.prototype,i={wauth:t.auth,layoutFixed:!t.editMode,addUrl:"/adddata/",formUrl:"/form.html?json=1",patternId:t.patternid,yu:t.yu,domain:t.domain,locale:t.locale,prototype:e,widgetStyle:t.widgetStyle,showPreferencesHandler:this.changeThis(this.showPrefs),gsid:this.params.gsid};e&&(i[e+"_prototype"]=e),t.geoid&&(i.geoid=Number(t.geoid)),Widget.Init(i)},showPrefs:function(t){this.findBlockOutside(t.$(),"widget").showPrefs()},showError:function(t){this.channel("catalog").trigger("error",t)},hideError:function(){this.channel("catalog").trigger("error")},collectWidgetsOnPage:function(){var t={};Widget.Framework.all().forEach(function(e){e.params.is_default&&(t[e.classId]=!0)},this),this.widgetsOnPage=t},getMoved:function(){var t={};return this.history.forEach(function(e){if("drag"===e.type&&e.from!==e.to){var i=e.id;t[i]?t[i].from===e.to?t[i]=null:t[i].to=e.to:t[i]={from:e.from,to:e.to}}},this),t},collectData:function(){var t=Widget.Framework.all(),e=this.getMoved(),i=t.map(function(t){if(t.params.removed)return{id:t.id,removed:!0};t.markChanged(t.id in e);var i="";return t.params.saveWithPrefs&&(i=t.params.prefs.map(function(t){return encodeURIComponent(t[0])+"="+encodeURIComponent(t[1])}).join("&")),{id:t.id,coord:t.params.position,usrCh:t.params.usrCh,settings:i}},this);return this.personalSettings=$.extend(!0,{},this.personalSettings),delete this.personalSettings.newpattern,{save:JSON.stringify({psettings:this.personalSettings,widgets:i})}},save:function(){var t=this.collectData();this.wsave(t,!0)},revert:function(){try{this.historyAcceptedPosition=this.history.length,window.location.href="/?ncrnd="+Math.random()}catch(t){}},reset:function(){window.confirm(home.l10n("informationsMessages.beforeReset"))&&this.wsave({delete:1})},wsave:function(t,e,i){$.ajax({url:"/wsave",data:$.extend(t,{wauth:this.params.auth||this.params.wpAuth,yu:this.params.yu,prototype:this.params.prototype}),traditional:!0,type:"post",dataType:"json",success:this.changeThis(function(t){if(i||(this.historyAcceptedPosition=this.history.length),"ok"===t.result)if(e)this.channel("catalog").trigger("saved");else{var n=window.location;setTimeout(function(){window.location="//"+n.host},500)}else this.showError(home.l10n("informationsMessages.cannotSaveSettings"))})})},updatePersonalSettings:function(t,e){null===e?delete this.personalSettings[t]:this.personalSettings[t]=e,this.wsave({save:JSON.stringify({psettings:this.personalSettings})},!0,!0)},addWidget:function(t){var e=$("<div></div>").appendTo(this.domElem),i=home.parseUrl(location.href);if(!this.canAddWidget())return!1;this.widgets=null,Widget.Framework.add(t,e,{success:this.changeThis(function(t){var n;n=t.params.smart&&t.params.defplace&&t.params.defplace.match(/\d:\d/)&&this.checkInsertPosition(t.params.defplace)?t.params.defplace:this.getInsertPosition(),this.insertAt(n,e),t.params.saveWithPrefs=!(!i.query.settings||!t.params.prefs),t.params.position=n,t.markChanged(!t.params.defplace||t.params.defplace!==n||t.classId in this.widgetsOnPage,t.params.saveWithPrefs),t.init(),this.recalculateWidgetCoords();var s=this.findBlockInside(e,"widget");this.findBlocksInside({block:"widget",modName:"state",modVal:"add"}).forEach(function(t){t.accept()});var o=s.domElem.offset();window.scrollTo(0,o.top),s.setMod("state","add"),this.history.push({type:"beforeAdd",elem:s}),t.params.open_settings_on_add&&1===t.params.havePrefsFrom&&this.showPrefs(t)}),error:this.changeThis(function(){this.hasMod("drag","add")?this.delMod("drag"):this.showError(home.l10n("informationsMessages.cannotSaveSettings"))})},{sign:i.query.sign,settings:i.query.settings,showanyway:!!i.query.showanyway&&1})},onAbortAdd:function(){},commit:function(){this.save()},processHistoryState:function(){var t=window.location.hash.match(/^#open=(.+)/);if(window.history&&history.replaceState?$(window).one("load",function(){var t=home.parseUrl(location.toString());["add","sign","settings","from"].forEach(function(e){delete t.query[e]}),t.search="",history.replaceState(null,null,home.makeUrl(t))}):window.location.hash="m"+this.params.patternid,t&&t[1])for(var e=this.findBlocksInside("widget"),i=0;i<e.length;i++)if(0===e[i].getId().indexOf(t[1]))return void e[i].showPrefs()},isNewPattern:function(){return window.location.hash!=="#m"+this.params.patternid},bindDrag:function(){var t,e,i;window.PointerEvent?(t="pointerdown mousedown",e="pointermove mousemove",i="pointerup pointercancel mouseup"):window.navigator.msPointerEnabled?(t="MSPointerDown mousedown",e="MSPointerMove mousemove",i="MSPointerUp MSPointerCancel mouseup"):void 0!==window.ontouchstart?(t="touchstart mousedown",e="touchmove mousemove",i="touchend touchcancel mouseup"):(t="mousedown",e="mousemove",i="mouseup"),this.bindToDoc(t,function(t){var e=$(t.target).closest(".widget");if(e.length&&$(t.target).closest(".widget__drag").length&&!this.dragItem&&("mousedown"!==t.type||1===t.which)){var i=e.width(),n=e.height(),s=e.offset(),o=this.getDragPlace().show(),r=home.getTouchEvent(t);return o.css({height:e.outerHeight()+parseInt(e.css("marginBottom"),10)}),e.before(o).css({position:"absolute",left:s.left,top:s.top,width:i,height:n,"z-index":10,"margin-top":0,"box-shadow":"0 0 10px #aaa"}),this.dragWidth=e.outerWidth(),this.dragItem=e.appendTo("body"),this.dragPos={x:s.left-r.x,y:s.top-r.y},this.mouseY=r.y,this.widgetHeightHalf=n/2,this.recalculateParams(),this.placeRowIndex=o.index(),this.placeColumnIndex=this.getColumnFromChild(o).index,this.scrollAnimation=this.changeThis(function(){this.scroll(),this.scrollAnimation&&window.requestAnimationFrame(this.scrollAnimation)}),this.scrollAnimation(),!1}}),this.bindToDoc(e,function(t){if(this.dragItem){if("mousemove"===t.type&&1!==t.which)return this.onMouseUp();var e=home.getTouchEvent(t),i=$(".rows"),n=i.width(),s=i.height();this.dragPos.x+e.x+this.dragWidth>n&&(e.x=n-this.dragWidth-this.dragPos.x),this.dragPos.x+e.x<0&&(e.x=-this.dragPos.x),this.dragPos.y+e.y>s&&(e.y=s-this.dragPos.y),this.mouseY=e.y,this.dragItem.css({left:this.dragPos.x+e.x,top:this.dragPos.y+e.y});var o=this.getColumn(e.x,e.y);if(o){var r=o.widgets,a=this.getDragPlace();if(r.length){if(o.index<3&&r[0].elem[0]!==this.dragItem[0])return;for(var c,l=0,h=r.length,u=this.dragPos.y+e.y+this.widgetHeightHalf;l<h&&u>r[l].center;)l++;(c=r[0].elem.index()+l)===this.placeRowIndex&&o.index===this.placeColumnIndex||(this.placeRowIndex=c,this.placeColumnIndex=o.index,0===l?a.insertBefore(r[0].elem):a.insertAfter(r[l-1].elem))}else a.appendTo(o.elems);return!1}}}),this.bindToDoc(i,this.onMouseUp),this.dragEvents=t+" "+e+" "+i},unbindDrag:function(){this.unbindFromDoc(this.dragEvents)},scroll:function(){var t,e=$(window),i=e.height(),n=e.scrollTop(),s=.2*i,o=0;this.mouseY&&((t=this.mouseY-n)<s?o+=t-s:t>i-s&&(o+=s-i+t),n+=20*o/s,o&&n>0&&n+i<$(document).height()&&e.scrollTop(n))},onMouseUp:function(){if(this.dragItem){var t=this.elem("drag-place"),e=this.dragItem;t.before(this.dragItem).hide(),this.dragItem.attr("style",""),this.dragItem=this.dragPos=null;var i=this.findBlockOn(e,"widget"),n=i.getInstance(),s=n.params.position;return this.recalculateWidgetCoords(),n.params.position!==s&&this.commit({type:"drag",id:i.getId(),from:s,to:n.params.position}),this.mouseY=0,this.scrollAnimation=null,$(window).trigger("DragEnd"),this._onUpdateWidgetList(),!1}},checkInsertPosition:function(t){t=t.split(":");var e=Number(t[0]),i=this.elem("col","td",e).find(".widget:not(.widget_removed_yes):not(.widget_mode_hidden)").toArray().length;return!(e<3)||!i},getColumn:function(t,e){for(var i,n=-1,s=0;s<this.colParams.length;s++){var o=this.colParams[s],r=t<o.left?o.left-t:t>o.right?t-o.right:0,a=e<o.top?o.top-e:e>o.bottom?e-o.bottom:0,c=Math.max(r,a);(c<n||-1===n)&&(n=c,i=o)}return i},getColumnFromChild:function(t){for(var e=t.closest(".widgets__col"),i=0;i<this.colParams.length;i++){var n=this.colParams[i];if(n.elems.is(e))return n}},getColumnWidgets:function(t){return t.find(".widget:not(.widget_removed_yes):not(.widget_mode_hidden)").map(function(){var t=$(this);return{elem:t,center:t.offset().top+t.height()/2}}).toArray()},getAllColumnWidgets:function(t){return t.find(".widget:not(.widget_removed_yes)").map(function(){return{elem:$(this)}}).toArray()},getDragPlace:function(){return this.dragPlace||($(this.domElem[0]).append('<div class="widgets__drag-place"></div>'),this.dropElemCache("drag-place"),this.dragPlace=this.elem("drag-place")),this.dragPlace},getInsertPosition:function(){var t,e,i=-1;return[3,4,5].forEach(function(n){var s,o=this.elem("col","td",n).find(".widget:not(.widget_removed_yes):not(.widget_mode_hidden)").toArray(),r=o.length;s=o.reduce(function(t,e){return t+$(e).height()},0),(-1===i||s<i)&&(i=s,t=n,e=r+1)},this),t+":"+e},getParanja:function(){return this.paranja||(this.paranja=$('<div class="widgets__paranja"></div>')),this.paranja},getWidgetById:function(t){return this.findBlockOn($("#wd-wrapper-"+t),"widget")},getWidgets:function(){if(!this.widgets){var t=this.elem("col");this.widgets=this.findBlocksInside(t,"widget")}return this.widgets},recalculateParams:function(t){return this.colParams=[1,2,3,4,5].map(function(e){var i=this.elem("col","td",e),n=i.offset();return n.index=e,n.elems=i,n.height=i.height(),n.bottom=n.top+n.height,n.width=i.width(),n.right=n.left+n.width,n.widgets=t?this.getAllColumnWidgets(i):this.getColumnWidgets(i),n},this),this},recalculateWidgetCoords:function(){this.recalculateParams(!0),this.colParams.forEach(function(t,e){t.widgets.forEach(function(t,i){this.findBlockOn(t.elem,"widget").getInstance().params.position=e+1+":"+(i+1)},this)},this)},insertAt:function(t,e){t=t.split(":");var i=this.elem("col","td",t[0]),n=i.find(".widget:not(.widget_removed_yes):not(.widget_mode_hidden)"),s=n.length,o=Number(t[1])-1;s?0===o?$(n[0]).before(e):(o>s&&(o=s),$(n[o-1]).after(e)):i.append(e)},enableActionButton:function(){this.channel("catalog").trigger("enableAction")}}),BEM.DOM.decl({block:"widgets",modName:"drag",modVal:"on"},{_afterSetMod:function(t,e){this.__base.apply(this,arguments),"drag"===t&&"on"===e&&(this.getWidgets().forEach(function(t){t.setMod("drag","on")}),this.bindToEvents(),this.eventsToUndo=this.history.filter(function(t){return"remove"===t.type}).length),this.channel("catalog").on("inited",function(){this.canAddWidget(0)},this)},onSetMod:{drag:{"":function(){this.__base.apply(this,arguments),this.getWidgets().forEach(function(t){t.delMod("drag")}),this.channel("catalog").trigger("hide"),this.unbindFromEvents()}}},commit:function(t){"recover"!==t.type&&this.history.push(t),"remove"===t.type&&++this.eventsToUndo,this.canAddWidget("remove"===t.type?-1:0),this.enableActionButton()},undo:function(){for(var t;this.history.length&&(!t||"remove"!==t.type);)t=this.history.pop();this.toggleUndoButton(--this.eventsToUndo);var e=this.getWidgetById(t.id),i=e.getInstance().params;this.checkInsertPosition(i.position)?e.delMod("removed"):(e.markChanged(!0),this.insertAt(this.getInsertPosition(),e.domElem),e.delMod("removed"),this.recalculateWidgetCoords()),this.canAddWidget()},save:function(){if(this.history.length){var t=this.collectData();this.wsave(t)}else{var e=window.location;window.location="//"+e.host}},revert:function(){this.__base.apply(this,arguments),this.delMod("drag")},canAddWidget:function(t){var e=this.__base(t);return e?(this.hideError(),this.channel("catalog").trigger("unlockAdd"),this.toggleUndoButton(this.eventsToUndo)):(this.showError(home.l10n("informationsMessages.maxCount")),this.channel("catalog").trigger("lockAdd"),this.toggleUndoButton(!1)),e},toggleUndoButton:function(t){this.channel("catalog").trigger("toggleUndo",t)},bindToEvents:function(){this.channel("catalog").on("save",this.save,this).on("revert",this.revert,this).on("reset",this.reset,this).on("undo",this.undo,this).on("add",function(t,e){this.addWidget(e)},this)},insertAt:function(){this.__base.apply(this,arguments),this.canAddWidget()},onAbortAdd:function(){this.canAddWidget(-1)},unbindFromEvents:function(){this.channel("catalog").un("save revert reset undo add")}}),BEM.DOM.decl("catalog",{onSetMod:{js:function(){this.channel("catalog").on("hide",this.hide,this),this.channel("catalog").on("show",this.show,this),this.channel("catalog").on("toggleUndo",this.toggleUndo,this),this.channel("catalog").on("error",this.error,this),this.channel("catalog").on("enableAction",this.enableAction,this),this.channel("catalog").on("lockAdd",this.lockAdd,this),this.channel("catalog").on("unlockAdd",this.unlockAdd,this),window.addEventListener("message",this.changeThis(function(t){this.hasMod("state")&&t.data&&t.data.add&&this.onWidgetSelected(t.data.add)}),!1),this.hasMod("hidden")||this.show(),this.channel("catalog").trigger("inited"),this._addButton=this.findBlockOn("add","button")},state:function(t,e){$("body").css({overflow:e?"hidden":"auto"})}},onWidgetSelected:function(t){return this.delMod("state"),this.channel("catalog").trigger("add",t),this._addButton&&this._addButton.delMod("checked"),!1},hide:function(){this.setMod("hidden","yes")},show:function(){this.delMod("hidden")},lockAdd:function(){this._addButton&&this._addButton.setMod("disabled","yes")},unlockAdd:function(){this._addButton&&this._addButton.delMod("disabled")},toggleUndo:function(t,e){this.findBlockOn("undo","button").setMod("visible",e?"":"no")},enableAction:function(){this.findBlockOn("save","button").setMod("disabled","")},error:function(t,e){e?this.elem("error").html(e).show():this.elem("error").hide()},_createCatalog:function(){var t=this.elem("panel");return t.length||(this.dropElemCache("panel"),(t=$(BEMHTML.apply({block:"catalog",elem:"panel",content:[{block:"spin2",mods:{progress:"yes"}},{elem:"wrapper",content:{tag:"iframe",elem:"frame",attrs:{name:"catalog__frame",src:this.params.url,frameborder:0}}},{elem:"close",cls:"widget__icon_rm"}]}))).appendTo(this.domElem)),t}},{live:function(){return this.liveBindTo("add","pointerclick",function(){this._createCatalog(),this.afterCurrentEvent(function(){this.toggleMod("state","opened")})}),this.liveBindTo("undo","pointerclick",this._getEmitFunction("undo")),this.liveBindTo("revert","pointerclick",this._getEmitFunction("revert")),this.liveBindTo("reset","pointerclick",this._getEmitFunction("reset")),this.liveBindTo("save","pointerclick",this._getEmitFunction("save")),this.liveBindTo("close","pointerclick",function(){this.delMod("state")}),!1},_getEmitFunction:function(t){return function(){this.channel("catalog").trigger(t)}}}),BEM.DOM.decl({block:"widgets",modName:"drag",modVal:"add"},{onAbortAdd:function(t){this.showReturnButton(t.elem.domElem),this.delMod("drag")},commit:function(t){if("drag"!==t.type)if("add"===t.type){var e=this.getWidgetById(t.id);this.save(),this.showReturnButton(e.domElem),this.delMod("drag"),e.delMod("drag")}else this.__base(t)},showReturnButton:function(t){if(this.params.retpath){var e=this.elem("button");e.length||(this.dropElemCache("button"),e=$(BEMHTML.apply({block:"button",mods:{theme:"normal",size:"m"},cls:"widgets__return",url:this.params.retpath,content:home.l10n("catalog.returnToCatalog")}))),e.insertAfter(t).show()}},canAddWidget:function(){var t=this.__base.apply(this,arguments);return t||this.delMod("drag"),t}}),home.debounce=function(t,e,i,n){var s;return 3===arguments.length&&"boolean"!=typeof i&&(n=i,i=!1),function(){var o=arguments;n=n||this,i&&!s&&t.apply(n,o),clearTimeout(s),s=setTimeout(function(){i||t.apply(n,o),s=null},e)}},BEM.DOM.decl("w-rss",{onSetMod:{js:function(){var t,e,i,n,s,o=this,r=this.domElem,a=this.params.feedUrl,c=this.params.newsTimestamp,l=o.elem("list"),h=r.parent().parent().find("h2.b-widget__title,.widget__title"),u=o.elem("gradient"),d=o.elem("gradient-up"),m=o.elem("informer"),p=r.parent().find(".w-rss__arrow_type_up"),f=r.parent().find(".w-rss__arrow_type_down"),_=0===$(".i-ua_browser_touch").length,g=0,v=0,b=(new Date).getTime(),y=(new Date).getTime(),w=!1,k=!0,E=function(t,e){var i="up"===t?p:f,n="w-rss__arrow_hovered-"+("up"===t?"up":"down")+"_yes";e&&!i.get(0).clickable?(i.get(0).clickable=!0,i.css({cursor:"pointer"}),i.unbind("mouseenter").unbind("mouseleave").unbind("click").unbind("mousedown").unbind("mouseup").bind("click",function(){$.browser&&$.browser.safari&&window.getSelection&&window.getSelection().empty();try{Lego.c("stred/pid=132/cid=71588/path="+I.widget.id+"."+t)}catch(t){}A.scroll(t)}),_&&i.bind("mouseenter",function(){i.addClass(n)}).bind("mouseleave",function(){clearTimeout(v),clearInterval(g),i.removeClass(n)}).bind("mousedown",function(){if(v=setTimeout(function(){clearInterval(g),g=setInterval(function(){A.scroll(t)},250)},400),$.browser&&$.browser.opera)return!1}).bind("mouseup",function(){clearTimeout(v),clearInterval(g)})):!e&&i.get(0).clickable&&(i.get(0).clickable=!1,i.removeClass(n),i.css({cursor:"default"}),clearTimeout(v),clearInterval(g),i.unbind("mouseenter").unbind("mouseleave").unbind("click").unbind("mousedown").unbind("mouseup"))},M=!1,x=[],T=[],S=function(t){return window.wg&&wg.isColumnWide?!!wg.isColumnWide(t):1==t},C=function(t){return window.wg&&wg.isColumnNarrow?wg.isColumnNarrow(t):2==t},I=(i=(r.closest(".b-widget-data").attr("id")+"").substr(3),n=Widget.Framework.get(i),s=n.params.position.split(":")[0],e=r.hasClass("w-rss_type_text-img")?"text-img":r.hasClass("w-rss_type_magazine")?"magazine":"text",{widget:n,col:s,layout:S(s)?"horiz":"vert",mode:{compact:2==n._prefs.wht,large:3==n._prefs.wht},isHeightAuto:!n._prefs.wht,type:e}),P=I.widget.news.length,B=function(){if("vert"===I.layout&&o.hasMod("layout","horiz")?o.setMod("layout","vert"):"horiz"===I.layout&&o.hasMod("layout","vert")&&o.setMod("layout","horiz"),I.isHeightAuto&&(parseInt(I.widget._prefs.n,10)>8?(r.find(".w-rss__body").addClass("w-rss__body_height_large"),I.mode.large=!0):"horiz"===I.layout||C(I.col)||parseInt(I.widget._prefs.n,10)<=5||P<=5?(r.find(".w-rss__body").addClass("w-rss__body_height_compact"),I.mode.compact=!0):"vert"!==I.layout||C(I.col)||(r.find(".w-rss__body").removeClass("w-rss__body_height_compact"),I.mode.compact=!1)),"text-img"!==I.type||C(I.col))return l;var t=r.parent().find(".l-rss_type_"+I.layout).clone();return t.appendTo(l),t.find("tbody").html("")},D=B(),O=function(){return"text-img"!==I.type||C(I.col)?D.find("div.w-rss__item"):D.find("tr")},A={getCurrent:function(t,e){for(var i,n=0;n<t.length&&(i=$(t[n]).position().top)<e-2;)n++;return Math.abs(i-e)<2?{top:i,i:n,inside:!1}:{top:$(t[n-1]).position().top,i:n-1,inside:!0}},scroll:function(t){V();var e=O().toArray(),i=e.length-1,n=$(e[i]),s="up"===t?-1:1,r=o.elem("body").scrollTop(),a=o.elem("body").height(),c=n.position().top+n.height()-a,l=this.getCurrent(e,r),h=l.top,u=l.i,m=s<0&&h<r?u:u+s,p=!1;m=Math.max(0,Math.min(i,m));var f=$(e[m]).position().top;p=a-22<s*(f-r),u===i&&s>0&&(p=!0),p?(r+=s*(a-44),u=Math.min(u,m)):(r=f,u=m),r=Math.max(0,Math.min(c,r)),p?d.removeClass("i-hidden"):d.addClass("i-hidden"),o.elem("body").animate({scrollTop:r},100)},updateControls:function(){var t=O().toArray(),e=o.elem("body").scrollTop(),i=t.length-1,n=$(t[i]),s=o.elem("body").height(),r=n.position().top+n.height()-s;this.getCurrent(t,e).inside?d.removeClass("i-hidden"):d.addClass("i-hidden"),E("up",e>0),E("down",e<r),r-e<s&&!M&&H()},reset:function(){o.elem("body").animate({scrollTop:0},100)}},R=(t=r.parent().find(".w-rss__item").clone().remove(),function(e){var i=t.clone(),n=e.url;n=n.replace(/^https?:/,""),i.find(".w-rss__title").attr("href",n).html(e.title).addClass(home.getData("b-rss.linkTheme","")),i.find(".w-rss__date").addClass("text_gray_yes").html(e.date),e.descr?i.find(".w-rss__description").html(e.descr):i.find(".w-rss__description").remove();var s=i.find(".w-rss__preview");if(e.img){var o="magazine"===I.type&&I.mode.compact&&e.imgCompact||e.img;o=o.replace(/^https?:/,""),s.attr("href",n),s.css({"background-image":"url("+o+")"})}else i.addClass("w-rss__item_previewable_no"),s.remove();return i.show(),i}),j=r.parent().find(".l-rss_type_vert").find("tr:first").clone().remove(),L=r.parent().find(".l-rss_type_horiz").find("tr:first").clone().remove(),F=function(t){var e=[];if("text-img"!==I.type||C(I.col))for(var i=0,n=t.length;i<n;i++)t[i]&&(x.push(t[i]),$.merge(e,R(t[i])));else{var s,o=function(e,i){if(""===$(i).html()){var n=t.shift();n&&($(i).html('<div class="w-rss__item">'+R(n).html()+"</div>"),x.push(n))}},r=D.find("tr:last").eq(0);for(1===r.length&&r.find("td:not(.l-rss__gap)").each(o);t.length>0;)(s="vert"===I.layout?j.clone():L.clone()).find("td:not(.l-rss__gap)").each(o),$.merge(e,s)}D.append(e)},N=function(t,e){M=!0;var i={url:a,num:12,start:x.length+1,type:I.widget._prefs.type,"no-text":I.widget._prefs["no-text"]};"object"==typeof t&&$.extend(i,t),$.ajax({url:I.widget.params.src,dataType:"json",data:i,success:function(t){t&&t.news&&t.news.length>0&&(t.tstamp&&(c=t.tstamp),e(t))},complete:function(){M=!1,q()}})},H=function(){N({tstamp:c},function(t){F(t.news),E("down",!0)})},z=function(t){t=t||x,A.reset(),l.html(""),D=B(),x=[],F(t),E("down",!0),U()},W=function(){if(!r.get(0).isInited){r.get(0).isInited=!0;var t=r.height();if(l.height()>t){"magazine"===!I.type&&function(t){for(var e,i=O(),n=parseInt(i.eq(0).css("paddingBottom"),10),s=0,o=0;s<t&&o<100;){if(s+(e=$(i[o]).height())+n>t){t-s>e/2&&(s+=e);break}s+=e+n,o++}o<100&&o>0&&($(".w-rss__body",r).height(s),u.addClass("i-hidden"))}(t);var e=!0;r.closest(".b-widget-fixed").mouseenter(function(){f.removeClass("w-rss__arrow_visibility_hidden"),p.removeClass("w-rss__arrow_visibility_hidden")}).mouseleave(function(){f.addClass("w-rss__arrow_visibility_hidden"),p.addClass("w-rss__arrow_visibility_hidden")}).mousemove(function(){e&&(e=!1,V(),setTimeout(function(){e=!0},250))}),o.elem("body").bind("scroll",$.debounce(A.updateControls,100,A)),E("down",!0),E("up",!0),E("up",!1)}else I.isHeightAuto&&(r.find(".w-rss__body").removeClass("w-rss__body_height_large"),r.find(".w-rss__body").addClass("w-rss__body_height_compact"),I.mode.compact=!0,I.mode.large=!1,I.isHeightAuto=!1,z(),r.get(0).isInited=!1,W())}},U=function(){if("magazine"===I.type){var t=D.find("div.w-rss__item").eq(0);t.hasClass("w-rss__item_previewable_no")||t.addClass("w-rss__item_position_first")}W()},V=function(){y=(new Date).getTime()},q=function(){b=(new Date).getTime()};I.widget._onDropcallback=function(t){var e=t.split(":")[0];e!=I.col&&(S(e)!==I.layout==="horiz"||"text-img"===I.type&&(C(e)||C(I.col)))&&(I.col=e,I.layout=S(e)?"horiz":"vert",z()),I.col=e},$(document).bind("mousemove keydown",function(){k&&!w&&(k=!1,setTimeout(function(){k=!0},250),(new Date).getTime()-b>3e4&&(m.hasClass("w-rss__informer_visibility_hidden")?(w=!0,setTimeout(function(){N({start:0},function(t){var e;w=!1,t.news.length>0&&((e=t.news).length>x.length||e[0].title!==x[0].title||e[0].date!==x[0].date)&&((new Date).getTime()-y>3e4?z(t.news):(m.removeClass("w-rss__informer_visibility_hidden"),T=t.news))})},Math.round(2e3*Math.random()+3e3))):(new Date).getTime()-y>3e4&&T.length>0&&(q(),z(T),T=[],m.addClass("w-rss__informer_visibility_hidden"))))}),h.append(m),h.addClass("b-widget__title_type_rss"),F(I.widget.news),U(),$.browser&&$.browser.msie&&"text-img"===I.type&&setTimeout(function(){var t=r.find(".w-rss__preview"),e=r.find("table td").eq(0).width();t.each(function(t,i){var n=$(i);n.hide(),n.css({width:e+"px"}),n.css({heigth:"70px"}),n.show()}),r.hide(),r.css({zoom:1}),r.show()},600),setTimeout(function(){0===r.height()&&(r.parent().hide(),setTimeout(function(){r.parent().show()},200))},2e3),m.click(function(){T.length>0&&(z(T),T=[]),V(),m.addClass("w-rss__informer_visibility_hidden")})}}});var BEMHTML,WTimer=function(t,e,i){var n,s=t,o=e,r=i||!1,a=!1;function c(t){return i?n=setTimeout(s,t):(n=setInterval(s,t),a=!0),n}function l(){a&&(r?clearTimeout(n):clearInterval(n),a=!1)}return{start:function(){return c(o)},restart:function(t){return l(),c(t)},stop:function(){l()}}},WTimersHandler=function(){var t={};function e(e,i){return e in t&&i in t[e]}return{add:function(i,n,s){"undefined"!==t[i]&&"object"==typeof t[i]||(t[i]={});s=s||{};var o,r,a,c=new WTimer(n.fn,864e5,n.runOnce),l=c.start();if(t[i][l]=c,"startTimerOn"in s){var h=(o=i,r=l,a=n.delay,function(){e(o,r)&&t[o][r].restart(a)}),u=s.startTimerOn;setTimeout(h,u)}else t[i][l].restart(n.delay);if("stopTimerOn"in s){var d=function(){var n=i,s=l;return function(){e(n,s)&&(t[n][s].stop(),delete t[n][s])}}(),m=s.stopTimerOn;setTimeout(d,m)}return l},remove:function(i,n){return!!e(i,n)&&(t[i][n].stop(),delete t[i][n],!0)}}};if("undefined"==typeof Widget&&(this.Widget=function(t,e){this._(t,e)},document.Widget=Widget,function(t){var e=new WTimersHandler;Widget.prototype={undef:function(t){return t},_:function(t,e){this._prefs={};var i=!!e.src&&e.src,n=!!e.wauth&&e.wauth,s=e.type?e.type:"raw";this.params=e,this.type=s,this.id=t,this.classId=t.replace(/-[0-9]+$/i,""),this.intClassId=e.intclassid,this.instanceId=t.replace(/^(.*)-([0-9]+)$/i,"$2"),this.htmlId=t,this.src=i,this.onLoad=this.onload=!1,this.bound=!1,""!==n&&this.setValue("wauth",n),this.savedUsrCh=this.params.usrCh},init:function(){var t=this;if(!this.bound){this.bound=!0;var e=function(){t.loadFromSrc({isBinding:!0})};if(Widget.Framework.register(this),"iframe-inside"!==this.type&&new Widget.Wrapper(this),this.params.prefs)for(var i=0;i<this.params.prefs.length;i++)!1!==this.params.prefs[i]&&this.setValue(this.params.prefs[i][0],this.params.prefs[i][1]);var n=Widget.Framework.widgetPrefs[this.id];if(n){for(var s in this._prefs)n[s]||(n[s]=this._prefs[s]);this._prefs=n}"iframe"===this.type&&(this._stylescallback=function(){t.loadFromSrc({isBinding:!0})}),this.params.css&&"iframe"!==this.type&&this.css(this.params.css),this.params.js&&"iframe"!==this.type?this.library(this.params.js,e):e()}},showPreloader:function(t){var e=this;function i(){e.$().html(Widget.Framework.params.preloader)}t?i():window.setTimeout(function(){(e._inlineLoading||e._inlinePending)&&i()},100)},loadFromSrc:function(t){if(t||(t={noPreloader:!1,isBinding:!1}),!("inline"===this.type&&!1===this.src&&t.isBinding||("inline"!==this.type&&"iframe"!==this.type&&"json"!==this.type||(!t.noPreloader&&Widget.Framework._domloaded&&this.showPreloader("now"),this[this.type+"From"](this.src)),t.isBinding))){var e=Widget.Framework.params.rawBodyUrl+this.getWidgetId()+"?ncrnd="+Math.random()+"&prototype="+Widget.Framework.params.prototype;"raw"===this.type&&this.rawFrom(e+"&wauth="+this.getAuth()),"inline"===this.type&&!1===this.src&&this.inlineFrom(e)}},_autoValue:function(t,e){return parseInt(t,10)>0?parseInt(t,10)+"px":e},iframeElement:function(e,i,n){var s,o,r;e=this._createLoadUrl.apply(this,arguments),n?(s=this._autoValue(this.params.prefs_width,Widget.Framework.params.iframeWidth),o=this._autoValue(this.params.prefs_height,Widget.Framework.params.iframeHeight),r=this.wrapper.$$("prefs")):(s="100%",o=this._autoValue(this.params.height,Widget.Framework.params.iframeHeight),r=this.wrapper.$$("iframe"));var a=t.browser&&t.browser.msie&&"9.0"===t.browser.version,c=t('<iframe style="border:none" allowTransparency="true" frameborder="0"></iframe>').attr({id:r,src:a?"":e,name:r}).css({width:0,"min-width":s,height:o,margin:0,padding:0});t(document.documentElement).hasClass("m-sandbox")&&c.attr("sandbox","allow-scripts allow-popups allow-forms allow-same-origin");var l=home.getData("banner.cls.banner__dummy");if(l&&c.addClass(l),t.browser&&t.browser.msie){var h=function(){c.unbind("load",h).css({position:"",visibility:""})};c.css({position:"absolute",visibility:"hidden"}).bind("load",h)}return a&&setTimeout(function(){c.attr("src",e)},50),c},iframeFrom:function(e){var i=this;t(document).ready(function(){var n=function(){i.$().length?function(){i.$().html("");try{var n=i.iframeElement(e,[]),s=n[0].src.split("#secure:");t.browser&&(t.browser.mozilla||t.browser.safari)?n.attr({src:s[0]+"&rnd="+Math.random()+(s.length>1?"#secure:"+s[1]:"")}).appendTo(i.$()):n.appendTo(i.$()),n.one("load",i.adjustFontSize.bind(i))}catch(t){window.console&&console.error(t)}}():setTimeout(function(){n()},100)};n()})},jsonFrom:function(){var e=this._createLoadUrl.apply(this,arguments);t.getScript(e+"&ncrnd="+Math.random())},inlineFrom:function(){var e=this._createLoadUrl.apply(this,arguments),i=this;Widget.Framework.inlineLoading(1),this._inlineLoading=!0,t.get(e,function(t){i.wrapper.$().css("height",""),i._inlineFromHtml(t)})},rawFrom:function(e){var i=this;Widget.Framework.inlineLoading(1),this._inlineLoading=!0,t.get(e,function(t){i._inlineFromHtml(t)})},_inlineFromJson:function(t){return Widget.Framework.inlineLoading(1),this._inlineFromHtml(t)},_inlineLoading:!1,_inlinePending:"",_inlineFromHtml:function(e){if(!Widget.Framework._domloaded)return this._inlineLoading=!1,void(this._inlinePending=e);Widget.Framework.inlineLoading(-1);var i,n=/<script[^>]*>(?!<\/script>)((?:\s|\S)*?)<\/script>/gim;this.wrapper.$().hasClass("b-widget-fixed")&&this.wrapper.$().addClass("b-widget-fixed"),0===this.$().length&&t("<div />").attr({id:this.$$(),class:"b-widget-data"}).appendTo(this.wrapper.$());var s=this.$();BEM.DOM.destruct(s,!0),s.html(e.replace(n,"").replace(Widget.Framework.params.idTemplate,this.id)),n.lastIndex=0;for(;null!==(i=n.exec(e));)try{new Function("widget",i[1])(this)}catch(t){}this._inlineLoading=!1,this._inlinePending=!1,Widget.Framework._domloaded&&this.finalize()},_createLoadUrl:function(t,e,i){var n=[{locale:this.getLocale()}];if(n.concat(e),window.toCat&&window.toReg||n.push({frommorda:1}),t=this._addParams(t,n,i||"iframe"===this.type,i),this.params.prefs_secure){for(var s=[],o=0;o<this.params.prefs_secure.length;o++)this.params.prefs_secure[o][1]&&s.push(this.params.prefs_secure[o][0]+"="+this.params.prefs_secure[o][1]);s.length&&(t+="#secure:"+s.join(","))}return t},_addParams:function(t,e,i,n){if(i&&(Widget.Framework.params.fullproxyDomain?this._prefs["."]=Widget.Framework.params.fullproxyDomain+"|"+Widget.Framework.params.proxyDomain:this._prefs["."]=location.protocol+"//"+location.host+"|"+document.domain,!n)){var s=this.getWidgetStyle()||{};s.bg&&(this._prefs.widgetBg=s.bg),s.text&&(this._prefs.widgetText=s.text),s.link&&(this._prefs.widgetLink=s.link),s.hover&&(this._prefs.widgetHover=s.hover),s.decor&&(this._prefs.widgetDecor=s.decor),this._moving&&(this._prefs.widgetMoving=1)}for(var o=[e,[this._prefs]],r=y5Url(location.href),a={},c=0;c<o.length;c++)for(var l=0;l<o[c].length;l++){var h;if(o[c][l]instanceof Array)for(h=0;h<o[c][l].length;h++)null!==r.getParam(o[c][l][h])&&(a[o[c][l][h]]=r.getParam(o[c][l][h]));else for(h in o[c][l])"function"!=typeof o[c][l][h]&&"object"!=typeof o[c][l][h]&&(a[h]=o[c][l][h])}return y5Url(t).addParams(a).toString()},_disableAutoStats:!1,hookStats:function(){return Widget.Framework.hookStats(this)},disableAutoStats:function(){this._disableAutoStats=!0},onload:function(){},resetAuth:function(){this._splitterAuth=!1},getAuth:function(){return this.getValue("wauth")},_splittedAuth:!1,splitAuth:function(){return this._splittedAuth||(this._splittedAuth=Widget.Framework.splitAuth(this.getAuth())),this._splittedAuth},getWidgetId:function(){return this.splitAuth().id},getOwner:function(){return this.splitAuth().owner},getViewer:function(){return this.splitAuth().viewer},setValue:function(t,e){this._prefs[t]=e,"wauth"===t&&Widget.Framework.registerWauth(this)},getValue:function(t){return this._prefs[t]?this._prefs[t]:this.undef()},getBoolean:function(t){var e=this.getValue(t);return!0===e||"true"===e},_encodeValues:function(t){t===this.undef()&&(t=this._prefs);var e=y5Url("");return e.query(t),e.query()},setValues:function(t){for(var e in t)"function"!=typeof t[e]&&"object"!=typeof t[e]&&this.setValue(e,t[e])},saveValues:function(e,i){e===this.undef()&&(e=this._prefs),this.markChanged(!1,!0),this.setValues(e),t.ajax({url:(Widget.Framework.params.saveDomain||"")+Widget.Framework.params.formUrl,data:{widget:this.getWidgetId(),wauth:this.getAuth(),usrCh:this.params.usrCh,s:this._encodeValues(e)},dataType:"json",success:i})},dropValues:function(e){var i=this;t.ajax({url:(Widget.Framework.params.saveDomain||"")+Widget.Framework.params.formUrl,data:{widget:this.getWidgetId(),wauth:this.getAuth(),s:"DROP"},dataType:"json",success:function(t){Widget.Framework.widgetPrefs[i.id]=!1,e&&e(t)}})},reload:function(e,i,n){if(!this.pauseReload){t(".b-wdgt-control").appendTo("body");var s=this;if(this.wrapper){if(void 0!==i&&(this._prefs.showAnyway=i),"raw"===this.type)return Widget.Framework.reload(this,function(){e&&e(),s.onload&&s.onload(),BEM.channel("widget").trigger("reload",{widget:s}),s.queueAutoReload()},i,n);this.loadFromSrc({noPreloader:!0})}else{var o=location.host;o.indexOf("/")===o.length-1&&(o=o.substr(0,o.length-1));var r=location.pathname;0===r.indexOf("/")&&(r=r.substr(1)),location.href=this._addParams("//"+o+"/"+r,[],"isIframe")}}},setTitle:function(t){this.wrapper?this.wrapper.setTitle(t):Widget.Framework.xframe(this,"Widget::setTitle",t)},savePreferences:function(t){this.saveValues(t),this._updateOnHide=!0},dropPreferences:function(e){var i=this.getAuth();this._prefs={},this.setValue("wauth",i),this.wrapper?(this.dropValues(e),t(window).trigger({type:"widgetSettingsClosed",id:this.id})):Widget.Framework.xframe(this,"Widget::dropPreferences","",e)},showPreferences:function(){this.wrapper?this.wrapper.showPreferences():Widget.Framework.xframe(this,"Widget::showPreferences")},hidePreferences:function(){this.wrapper?(this._updateOnHide&&(this.loadFromSrc(),Widget.Framework.params.notifyChangesHandler(this)),this.wrapper.hidePreferences()):Widget.Framework.xframe(this,"Widget::hidePreferences",this._updateOnHide?"<>"+this._encodeValues():""),this._updateOnHide=!1},setIFrameHeight:function(t){this.wrapper?this.wrapper.setIFrameHeight(t):Widget.Framework.xframe(this,"Widget::setIFrameHeight",t)},setIFrameWidth:function(t){this.wrapper?this.wrapper.setIFrameWidth(t):Widget.Framework.xframe(this,"Widget::setIFrameWidth",t)},setIFrameSize:function(t,e){this.wrapper?this.wrapper.setIFrameSize(t,e):Widget.Framework.xframe(this,"Widget::setIFrameSize",t+","+e)},setPreferencesFormWidth:function(t){this.wrapper?this.wrapper.setPreferencesFormWidth(t):Widget.Framework.xframe(this,"Widget::setPreferencesFormWidth",t)},setPreferencesFormHeight:function(t){this.wrapper?this.wrapper.setPreferencesFormHeight(t):Widget.Framework.xframe(this,"Widget::setPreferencesFormHeight",t)},setPreferencesFormSize:function(t,e){this.wrapper?this.wrapper.setPreferencesFormSize(t,e):Widget.Framework.xframe(this,"Widget::setPreferencesFormSize",t+","+e)},_calculateCss:function(t,e){var i=t.css(e),n=i.replace(/(\.[0-9]+)?px$/,"");return"height"!==e||"auto"!==i&&0!==parseInt(i,10)?i!==n?parseInt(i,10):0:document.body.scrollHeight},_sumCss:function(t,e){for(var i=0,n=0;n<e.length;n++)i+=this._calculateCss(t,e[n]);return i},adjustIFrameHeight:function(){var t=this;window.clearTimeout(this._adjustIFrameHeightTimeout),this._adjustIFrameHeightTimeout=window.setTimeout(function(){t._adjustIFrameHeight()},100)},_adjustIFrameHeightPrevious:-1,_adjustIFrameHeightTimeout:!1,_adjustIFrameHeight:function(){var e;(e="iframe-inside"===this.type?t("body"):this.$()).css("overflow","hidden");var i=!1;e.css("margin-left")===e.css("margin-right")&&e.css("margin-right")===e.css("margin-top")&&e.css("margin-top")===e.css("margin-bottom")&&"0px"===e.css("margin-bottom")&&e.css("padding-left")===e.css("padding-right")&&e.css("padding-right")===e.css("padding-top")&&e.css("padding-top")===e.css("padding-bottom")&&"0px"===e.css("padding-bottom")&&(i=!0);var n=this._sumCss(e,["marginTop","marginBottom","height"]);i&&e.css("padding","1px");var s=this._sumCss(e,["marginTop","marginBottom","height"]);if(s>n&&(n=s),n!==this._adjustIFrameHeightPrevious)return t.browser&&t.browser.opera&&(n+=20),this._adjustIFrameHeightPrevious=n,this.setIFrameHeight(n)},library:function(t,e){var i=this;this._libraryLoading=!0,Widget.Framework.library(t,function(){i._libraryLoading=!1,e?e():i.finalize()})},css:function(t){return Widget.Framework.css(t)},iReload:function(e){if(this.stopAutoReload(),Widget.Framework.focused)Widget.Framework.addToReloadQueue(this,e),Widget.Framework.reloadQueueTimer&&clearTimeout(Widget.Framework.reloadQueueTimer),Widget.Framework.reloadQueueTimer=setTimeout(function(){Widget.Framework.processReloadQueue()},Widget.Framework.reloadQueueTimeout);else{var i=function(){t.browser&&t.browser.msie?t(document).unbind("focusin",i):t(window).unbind("focus",i),Widget.Framework.processReloadQueue()};Widget.Framework.addToReloadQueue(this,e),t.browser&&t.browser.msie?t(document).bind("focusin",i):t(window).bind("focus",i)}},stopAutoReload:function(){Widget.Framework.unsetAutoreload(this)},queueAutoReload:function(){Widget.Framework.setAutoreload(this)},finalize:function(){this.queueAutoReload(),this.onload&&this.onload(),this.onLoad&&this.onLoad(),this._disableAutoStats||this.hookStats(),t(window).trigger({type:"widgetLoaded",id:this.id})},countShow:function(t,e){csh_ifgsid&&!this._isNotReloaded&&csh_ifgsid(t,e)},addTimer:function(t,i){return e.add(this.id,t,i)},removeTimer:function(t){e.remove(this.id,t)},getWidgetStyle:function(){var t=this.params.position,e=Widget.Framework.params.widgetStyle;if(t||(t=window.wg&&wg._addedWidgetPosition),e&&t){var i=parseInt(t.split(":")[0],10),n={};for(var s in e[t]?n=e[t]:e.top&&i<=2?n=e.top:e.bottom&&i>2?n=e.bottom:e.all&&(n=e.all),e.def)e.def.hasOwnProperty(s)&&(n[s]||(n[s]=e.def[s]));return n}return""},appendStyle:function(t){var e=document.createElement("style");e.setAttribute("type","text/css"),document.getElementsByTagName("head").item(0).appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))},adjustFontSize:function(){"iframe"===this.type&&this.$().find("iframe")[0].contentWindow.postMessage(JSON.stringify({type:"message",message:{name:"font-size",value:Widget.Framework.getFontSize()}}),"*")},addWidgetStyles:function(){try{if(t("script[nowidgetstyles='true']").length)return;"iframe-inside"===this.type&&this._prefs&&(this._prefs.widgetLink&&this.appendStyle(":link {color:#"+this._prefs.widgetLink+" !important;}"),this._prefs.widgetHover&&this.appendStyle(":link:hover {color:#"+this._prefs.widgetHover+" !important;}"),this._prefs.widgetText&&this.appendStyle("body {color:#"+this._prefs.widgetText+" !important;}"),this._prefs.widgetDecor&&this.appendStyle(":link {text-decoration: none! important;}"))}catch(t){window.console&&window.console.log&&console.log("unable to append widget styles",this._prefs.widgetBg,this._prefs.widgetText,this._prefs.widgetLink,this._prefs.widgetHover,this._prefs.widgetDecor)}},markChanged:function(t,e){this.params.usrCh|=(t?1:0)+(e?2:0)},$:function(e){return t("#"+this.$$(e))},$$:function(t){return Widget.Framework.params.idPrefix+this.id+(t===this.undef()?"":t)},getLocale:function(){return Widget.Framework.getLocale()},end:!0}}(jQuery)),y5Url=function(){var t={UNDEF:"undefined"};t.Types={UNDEF:1,UNDEFINED:1,OBJECT:2,FUNCTION:4,NUMBER:8,STRING:16,BOOLEAN:32,DATE:1024,REGEXP:2048,ARRAY:4096,NULL:8192,EVENT:16384,NODE:32768,TYPES:{undefined:1,object:2,function:4,number:8,string:16,boolean:32},type:function(t){var e=this.TYPES[typeof t];if(null===t)return this.NULL;if(e==this.OBJECT&&(t.nodeName||this.document(t)))return this.NODE;if(e==this.OBJECT||e==this.FUNCTION)switch(t.constructor){case Array:return this.ARRAY;case RegExp:return this.REGEXP;case Date:return this.DATE}return this.event(t)?this.EVENT:e},test:function(t,e){return!!(this.type(t)&e)},def:function(t){return typeof t!=e},undef:function(t){return typeof t==e},object:function(t){return"object"==typeof t},func:function(t){return"function"==typeof t},nativeFunc:function(t){return this.func(t)&&isNativeFunc.test(t.toString())},number:function(t){return"number"==typeof t},string:function(t){return"string"==typeof t},bool:function(t){return"boolean"==typeof t},nul:function(t){return null===t},array:function(t){return t instanceof Array},regexp:function(t){return t instanceof RegExp},date:function(t){return t instanceof Date},event:function(t){return t&&typeof t.type!=e&&typeof(t.stopPropagation||t.cancelBubble)!=e},element:function(t){return checkDomNode(t,Node.ELEMENT_NODE)},attribute:function(t){return checkDomNode(t,Node.ATTRIBUTE_NODE)},text:function(t){return checkDomNode(t,Node.TEXT_NODE)},document:function(t){return t&&typeof t.documentElement!=e||!1},comment:function(t){return checkDomNode(t,Node.COMMENT_NODE)},node:function(t){return t&&typeof t.nodeType!=e}};for(var e=t.UNDEF,i=t.Types,n=/^((((\w+):)\/\/)?(([\w\-\.]+\.\w+|localhost)(\:(\d+))?))?(\/?[^\?#]*)?(\?([^#]*))?(#(.*))?$/,s=/^(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,4}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?$/,o="E9F6F3EAE5EDE3F8F9E7F5FAF4FBE2E0EFF0EEEBE4E6FDFFF7F1ECE8F2FCE1FEB8C9D6D3CAC5CDC3D8D9C7D5DAD4DBC2C0CFD0CECBC4C6DDDFD7D1CCC8D2DCC1DEA8".match(/../g),r="%D0%B9%D1%86%D1%83%D0%BA%D0%B5%D0%BD%D0%B3%D1%88%D1%89%D0%B7%D1%85%D1%8A%D1%84%D1%8B%D0%B2%D0%B0%D0%BF%D1%80%D0%BE%D0%BB%D0%B4%D0%B6%D1%8D%D1%8F%D1%87%D1%81%D0%BC%D0%B8%D1%82%D1%8C%D0%B1%D1%8E%D1%91%D0%99%D0%A6%D0%A3%D0%9A%D0%95%D0%9D%D0%93%D0%A8%D0%A9%D0%97%D0%A5%D0%AA%D0%A4%D0%AB%D0%92%D0%90%D0%9F%D0%A0%D0%9E%D0%9B%D0%94%D0%96%D0%AD%D0%AF%D0%A7%D0%A1%D0%9C%D0%98%D0%A2%D0%AC%D0%91%D0%AE%D0%81".match(/.{6}/g),a={},c=encodeURIComponent,l=[".xml",".html",".xhtml",".jpg",".gif",".png",".css",".js",".xsl",".php",".py",".pl"],h=0,u=o.length,d=/%3B|%2C|%2F|%3F|%3A|%40|%26|%3D|%2B|%24/gi;h<u;h++)a[o[h]]=r[h];function m(t,e){return a[e]||t}function p(t){return t.replace(/%([A-Fa-f0-9]{2})/g,m)}function f(t){var e=t.replace(/\+/g,"%20");try{var i=decodeURIComponent(e);if(void 0==i)throw"malformed URI sequence";return i}catch(t){try{return decodeURIComponent(p(e))}catch(t){return unescape(e)}}}function _(t,e,n){i.undef(t[e])&&(t[e]=[]),i.array(n)?t[e]=t[e].concat(n):t[e].push(n)}function g(t,e){for(var i=t[e],n=i.length,s=new Array(n),o=c(e),r=0;r<n;r++)s[r]=o+"="+c(i[r]);return s}function v(t){for(var e,i,n,s={},o=t.replace(/\+/g,"%20").split("&"),r=0,a=o.length;r<a;r++)(i=(e=o[r].split("=")).shift())&&(n=e.length>1?e.join("="):e[0]||"",_(s,f(i),f(n)));return s}t.URL=function(t){var e=(t=i.def(t)?t.toString():window.location.href).match(n);if(e){if(this.Host=e[6]||"",this.Path=e[9]||"",e[6]){var s=e[6].substring(e[6].lastIndexOf("."));-1!=$.inArray(s,l)&&(this.Path=e[6],this.Host="")}this.Href=e[0],this.Proto=e[4]||"",this.Port=e[8]||0,this.Path=function(t){try{var e=decodeURI(t);if(void 0==e)throw"malformed URI sequence";return e}catch(e){try{return decodeURI(p(t))}catch(e){return unescape(t)}}}(this.Path),this.Query=v(e[11]||""),this.Hash=f(e[13]||"")}},t.URL.prototype={go:function(){window.location.href=this.toString()},toString:function(){var t="";if((this.Proto||this.Host)&&this.Host&&(t+=(this.Proto||"http")+"://"+this.Host,this.Port&&(t+=":"+this.Port)),this.Path){this.Host&&0!=this.Path.indexOf("/")&&(t+="/"),d.lastIndex=0;for(var e,i=0,n=[];e=d.exec(this.Path);)d.lastIndex>i&&e[0]&&(n.push(this.Path.slice(i,e.index)),n.push(e[0]),i=e.index+e[0].length);i!==this.Path.length&&n.push(this.Path.slice(i)),n[0]=encodeURI(n[0]);for(var s=[],o=0;o<n.length;o++)s[o]=o%2?n[o]:encodeURI(n[o]);t+=s.join("")}for(o=0;o<"".length;o++){var r="".charAt(o),a=encodeURIComponent(encodeURIComponent(r)),l=encodeURIComponent(encodeURIComponent(r.toUpperCase()));t.indexOf(a)>-1&&(t=t.replace(new RegExp(a,"g"),r)),t.indexOf(l)>-1&&(t=t.replace(new RegExp(l,"g"),r))}var h=this.query();return h&&(t+="?"+h),this.Hash&&(t+="#"+c(this.Hash)),t},clone:function(){return new t.URL(this.toString())},proto:function(){},host:function(){},port:function(){},path:function(){},hash:function(){},query:function(t){if(i.def(t))return this.clearQuery(),i.string(t)?this.Query=v(t):this.replaceParams(t),this;var e=[];for(var n in this.Query)e=e.concat(g(this.Query,n));return e.join("&")},queryKeys:function(){var t=[];for(var e in this.Query)t.push(e);return t.sort()},addParam:function(t,e){return _(this.Query,t,e),this},addParams:function(t){for(var e in t)_(this.Query,e,t[e]);return this},removeParams:function(t){for(var e=0,i=t.length;e<i;e++)delete this.Query[t[e]];return this},replaceParams:function(t){var e=[];for(var i in t)e.push(i);return this.removeParams(e),this.addParams(t),this},clearQuery:function(){return this.Query={},this},getParam:function(t){var e=this.Query[t];return e?e[0]:null},getParams:function(t){return this.Query[t]||[]}};var b=t.URL,y=b.prototype,w={proto:"Proto",host:"Host",port:"Port",path:"Path",hash:"Hash"};for(h in w)y[h]=function(t){return function(e){return i.def(e)?(this[t]=e,this):this[t]}}(w[h]);return y.get=y.toString,t.Url=function(t){return new b(t)},b.isValid=function(t){return s.test(t)},t.Url}(),"undefined"!=typeof Widget&&void 0===Widget.Wrapper&&function(t){Widget.Wrapper=function(t){this._(t)},Widget.Wrapper.prototype={undef:function(t){return t},_:function(t){this.widget=t,this.widget.wrapper=this,Widget.Framework._wrappers[this.$$()]=t},$:function(e){return t("#"+this.$$(e))},$$:function(t){return Widget.Framework.params.wrapperPrefix+(t==this.undef()?"wrapper":t)+Widget.Framework.params.wrapperPostfix+this.widget.id},setTitle:function(t){this.$("title").html((""+t).replace(/</g,"&lt;"))},getWindowSize:function(){var e=window;if(void 0!==e.innerWidth)return{width:e.innerWidth,height:e.innerHeight};var i=document[t.support.boxModel?"documentElement":"body"];return{width:i.clientWidth,height:i.clientHeight}},_px:function(t){return(""+t).match("^[0-9]+$")&&(t+="px"),t},setIFrameHeight:function(t){this.$().css("height",""),this.$("iframe").css("height",this._px(t))},setIFrameWidth:function(t){this.$("iframe").css("width",this._px(t))},setIFrameSize:function(t,e){this.$("iframe").css("height",this._px(e)).css("width",this._px(t))},setPreferencesFormWidth:function(t){var e=this.getWindowSize().width;t=e/t<2?e/2:t;this.$("prefs").css("width",this._px(t))},setPreferencesFormHeight:function(t){var e=this.getWindowSize().height;t=e/t<2?e/2:t;this.$("prefs").css("height",this._px(t))},setPreferencesFormSize:function(t,e){this.setPreferencesFormWidth(t),this.setPreferencesFormHeight(e)},showPreferences:function(){Widget.Framework.params.showPreferencesHandler(this.widget)},hidePreferences:function(){Widget.Framework.params.hidePreferencesHandler(this.widget)},showEditForm:function(t){return Widget.Framework.showEditForm(this.widget.id,t)}}}(jQuery),"undefined"!=typeof Widget&&void 0===Widget.Framework){var widgetTiming=1e3;!function(t){Widget.Framework={undef:function(t){return t},params:!1,_id:{},_prebindId:{},_wauth:{},_no:{},_widgets:[],_wrappers:{},_callbacks:{},_callbackId:1,widgetAutoReloadTimers:{},widgetReloadQueue:{},reloadQueueTimeout:5e3,reloadQueueTimer:null,widgetPrefs:{},getLocale:function(){return this.params.locale},getDomain:function(){return this.params.domain},get:function(t){return Widget.Framework._id[t]},getPrebind:function(t){return Widget.Framework._prebindId[t]},getByWauth:function(t){return Widget.Framework._wauth[t]},getByWrapperId:function(t){return Widget.Framework._wrappers[t]},getByClass:function(t){if(this._no[t]===this.undef())return[];for(var e=[],i=0;i<this._widgets.length;i++)this._widgets[i].classId===t&&(e[e.length]=this._widgets[i]);return e},updateNo:function(t,e){var i=parseInt((""+e).replace(/^[^-]+-/,""),10);return this._no[t]===this.undef()&&(this._no[t]=0),this._no[t]<=i&&(this._no[t]=i+1),this._no[t]},register:function(t){for(var e in this.registerWauth(t),this._id[t.id]=t,this.updateNo(t.classId,t.instanceId),t.intClassId&&this.updateNo(t.intClassId,t.instanceId),this._widgets=[],this._id)this._id.hasOwnProperty(e)&&(this._widgets[this._widgets.length]=this._id[e])},registerWauth:function(t){var e=t.getValue("wauth");""!==e&&(this._wauth[e]=t),t.resetAuth()},all:function(){return this._widgets},bindIframe:function(){var t=y5Url(location.href).getParam("wauth");if(t){this.inIframe=!0;var e=this.splitAuth(t),i=this.bind(e.id,{type:"iframe-inside",wauth:t});return this.setValuesFromUrl(i),i.addWidgetStyles(),document.documentElement.id=this.params.idPrefix+i.id,i}return this.inIframe=!1,!1},setEdit:function(t){if(!arguments.length)return this.params.edit;t=!!t,this.params.edit!==t&&(t?this.unsetAutoreload():this.setAutoreload(),this.params.edit=t)},getValuesFromUrl:function(t){var e=[];try{var i,n,s=y5Url(location.href);t!==this.undef()&&s.query(t);var o=s.queryKeys();for(i=0;i<o.length;i++)s.getParam(o[i])===this.undef()?e[e.length]=[o[i],""]:e[e.length]=[o[i],s.getParam(o[i])];if(s.Hash){var r,a=s.Hash.replace("secure:","").split(",");for(i=0,n=a.length;i<n;i++)r=a[i].split("="),e[e.length]=r}}catch(t){}return e},setValuesFromUrl:function(t){var e,i=this.getValuesFromUrl();try{e=location.protocol}catch(t){e="http:"}for(var n=0;n<i.length;n++)if("."===i[n][0]){var s=i[n][1].split("|");this.params.saveDomain=s[0].replace(/(http:|https:)/,e),this.params.fullproxyDomain=s[0],this.params.fullproxyUrl=this.params.saveDomain+this.params.proxyUrl,this.params.proxyDomain=s[1]}else if("locale"===i[n][0])this.params.locale=i[n][1];else{var o=i[n][1],r=i[n][0];"prefs_get"===r&&(o=JSON.parse(o)),t.setValue(r,o)}},_inlineLoadingCount:0,inlineLoading:function(t){this._inlineLoadingCount+=t,this.onInlineLoadingChange(this._inlineLoadingCount,t)},onInlineLoadingChange:function(){},bind:function(t,e){var i=this.prebind(t,e);return i.init(),i},prebind:function(t,e){var i=new Widget(t,e);return Widget.Framework._prebindId[t]=i,i},init:function(t){if(!1===this.params)this.params=t;else for(var e in t)t.hasOwnProperty(e)&&t[e]!==this.undef()&&(this.params[e]=t[e]);this.params.preloader=this.params.preloader.replace("#dataLoading#",this.params.dataLoadingText)},insert:function(e,i,n,s){var o=t(n),r=o.data("bem").widget,a=Widget.Bind(r.id,r.initParams);i.append(o),a.bound&&("raw"===a.type||"inline"===a.type&&!1===a.src)&&a.finalize(),s&&s(a,a.$().parent())},replace:function(t,e,i){var n,s=t.$(),o=t.id;BEM.DOM.destruct(s,!0),s.html(e),BEM.DOM.init(s);var r=Widget.Framework.get(o);return n=r.wrapper.$(),i&&i(r,n),r},reload:function(e,i,n,s){n&&(e._prefs.showAnyway=n);var o={wauth:e.getAuth(),wid:e.id,usrCh:e.params.usrCh,fixed:this.params.layoutFixed?"1":"",showanyway:e._prefs.showAnyway?1:0,prefs_get:e.params.prefs_get?JSON.stringify(e.params.prefs_get):"",locale:this.getLocale(),prototype:Widget.Framework.params.prototype,bg:e.getWidgetStyle().bg};s&&(o.istuning=1),this.params.gsid&&(o.g_sid=this.params.gsid),void 0!==e.params.is_default&&(o.is_default=!0===e.params.is_default?1:0),!1!==Widget.Framework.widgetPrefs[e.id]?Widget.Framework.widgetPrefs[e.id]=e._prefs:Widget.Framework.widgetPrefs[e.id]=null,"iframe"===e.type&&(o["."]=this.params.fullproxyDomain+"|"+this.params.proxyDomain),t.get(this.params.addUrl,o,function(t){Widget.Framework.replace(e,t,i)})},add:function(e,i,n,s){var o,r,a=this.updateNo(e,"_topnews"===e?0:1);this.updateNo(e,a),"function"==typeof n?o=n:(o=n.success,r=n.error),s=s||{fixed:!1};var c=e+"-"+a,l={wauth:this.params.wauth,wid:c,smart:s.smart?"1":"",fixed:s.fixed?"1":"",locale:this.getLocale(),isAddition:1,prototype:this.params.prototype};this.params.gsid&&(l.g_sid=this.params.gsid),s.settings&&(l.settings=s.settings),s.sign&&(l.sign=s.sign),s.showanyway&&(l.showanyway=s.showanyway),t.ajax({url:this.params.addUrl,data:l,success:function(t){Widget.Framework.insert(c,i,t,o)},error:r})},fromJson:function(t,e){var i=this.getByWauth(t);i&&i._inlineFromJson(e)},splitAuth:function(t){var e=t.split(".");return e.length>4?{id:e[3],owner:e[6],viewer:e[5]}:{id:e[0],owner:e[1],viewer:e[2]}},scripts:{},library:function(e,i){var n=this.prepareLibrary(e),s=0,o=this,r=function(e){if(e!==o.undef()&&"loaded"!==o.scripts[e]){for(var a=0;a<o.scripts[e].length;a++)o.scripts[e][a]();o.scripts[e]="loaded"}if(s>=n.length)i!==o.undef()&&i();else{var c=n[s];s++,o.scripts[c]===o.undef()&&!1!==c?(o.scripts[c]=[],t.getScript(c,function(t){return function(){r(t)}}(c))):"loaded"===o.scripts[c]?r():o.scripts[c].push(r)}};r()},prepareLibrary:function(t){var e=[];if(t instanceof Array)for(var i=0;i<t.length;i++)e=t[i]instanceof Array?e.concat(this.prepareLibrary(t[i][0],t[i][1])):e.concat(this.prepareLibrary(t[i]));return!1!==t&&(e=t),e},_css:{},css:function(e){e instanceof Array?this.loadCss(e):(e.any instanceof Array&&this.loadCss(e.any),t.browser&&t.browser.msie&&e.msie instanceof Array&&this.loadCss(e.msie),t.browser&&t.browser.msie||!(e.non_msie instanceof Array)||this.loadCss(e.non_msie))},loadCss:function(t){for(var e=0;e<t.length;e++)if(!this._css[t[e]]){this._css[t[e]]=!0;var i=document.createElement("link");i.rel="stylesheet",i.href=t[e],(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(i)}},_click:function(e){var i="//yandex.ru/clck/jclck/dtype=stred/pid="+this.params.statParams.pid+"/cid="+this.params.statParams.cid+"/path="+e+"/rnd="+Math.random()+"/*"+location.href.replace(/^[^/]+\/+/,"");try{t.getScript(i)}catch(t){}},_counter:function(){var e=t(this),i=(e.closest(".widget").attr("id")||"").replace(/^wd-wrapper-/,""),n=Widget.Framework.get(i),s=n.classId+".anchors";if(n){if(e.attr("rev")){var o=e.attr("rev");if("none"===o)return;s=s+"."+o}Widget.Framework._click(s)}},hookStats:function(e){var i=this;if("iframe-inside"===e.type)t("a, input[type=button], input[type=submit], button").on("mousedown.widgetstat",function(){i._click(e.classId+".anchors")});else if(e.wrapper.$("title").not(".yandex-hook-stat").mousedown(function(){i._click(e.classId+".title")}).addClass("yandex-hook-stat"),e.wrapper.$().length>0&&"raw"!==e.type){var n="#"+e.wrapper.$().attr("id")+" a:not(.yandex-hook-stat),";n+="#"+e.wrapper.$().attr("id")+" input[type=button],",n+="#"+e.wrapper.$().attr("id")+" input[type=submit],",n+="#"+e.wrapper.$().attr("id")+" button";try{t(n).off("mousedown.widgetstat").on("mousedown.widgetstat",function(){var n=t(this),s=e.classId+".anchors";if(n.attr("rev")){var o=n.attr("rev");if("none"===o)return;s=s+"."+o}i._click(s)})}catch(t){}}},_domloaded:!1,domLoaded:function(){if(this._domloaded)return!1;this._domloaded=!0;for(var t=0;t<this._widgets.length;t++)this._widgets[t]._inlineLoading?this._widgets[t].showPreloader():this._widgets[t]._inlinePending?this._widgets[t]._inlineFromHtml(this._widgets[t]._inlinePending):this._widgets[t].finalize()},setAutoreload:function(t){if(!0!==this.params.edit)if(t){var e=this.widgetAutoReloadTimers;if(t.params.rebind&&!e[t.id]){var i=t.params.rebind*widgetTiming;e[t.id]=setTimeout(function(){e[t.id]=null,t.iReload()},i)}}else for(var n=0;n<this._widgets.length;n++)this.setAutoreload(this._widgets[n])},unsetAutoreload:function(t){if(t){var e=this.widgetAutoReloadTimers,i=e[t.id];i&&(clearTimeout(i),e[t]=null)}else for(var n=0;n<this._widgets.length;n++)this.unsetAutoreload(this._widgets[n])},_storeCallback:function(t){return this._callbacks[this._callbackId]=t,this._callbackId++},_freeCallback:function(t){var e=this._callbacks[t];return delete this._callbacks[t],e},_postMessageTransport:function(t,e,i){var n={action:"message",wauth:t.getValue("wauth"),params:{message:e}},s=this.params.fullproxyDomain;i&&(n.params.callbackId=this._storeCallback(i)),window.parent.postMessage(JSON.stringify(n),s)},_iframeTransport:function(t,e,i){var n=this.params.fullproxyUrl;if(0===n.indexOf("http:")||0===n.indexOf("https:")||"/"===n.charAt(0)){this._xframe&&document.body.removeChild(this._xframe);var s=document.createElement("iframe");s.style.visibility="hidden",s.style.position="absolute",s.name="widget"+(Math.random()+"").substr(3,7),s.style.top=s.style.left=s.style.width=s.style.height=0,this._xframe=document.body.insertBefore(s,document.body.firstChild),this.xframeSrc(this._xframe,n+"#"+e,i)}},xframe:function(t,e,i,n){try{var s,o=y5Url();o.clearQuery(),o.addParams({wauth:t.getAuth(),name:e,value:i}),o.hash(encodeURIComponent(o.query())),o.clearQuery(),s=this.params.proxyDomain+"&"+o.hash(),"postMessage"in window?this._postMessageTransport(t,s,n):this._iframeTransport(t,s,n)}catch(t){}},_isCorrectWauth:function(t){var e=this.splitAuth(t),i=this.get(e.id);return!!i&&i.getValue("wauth")===t},onWindowMessage:function(t){var e,i;try{e=JSON.parse(t.data)}catch(t){return}e&&("callback"===e.action?e.params&&e.params.callbackId&&(i=this._freeCallback(e.params.callbackId))&&i():e.wauth&&this._isCorrectWauth(e.wauth)&&e.params&&e.params.message&&(this.xframeGet(e.params.message),e.params.callbackId&&t.source.postMessage(JSON.stringify({action:"callback",params:{callbackId:e.params.callbackId}}),t.origin)))},xframeGet:function(e){if(!this.inIframe){e.indexOf("wauth%3D")>0&&(e=decodeURIComponent(e));var i=new y5Url;i.query(e.replace(/^#/,""));var n=this.splitAuth(i.getParam("wauth")),s=this.get(n.id),o=i.getParam("value");if(s)switch(i.getParam("name")){case"Widget::setTitle":s.setTitle(o);break;case"Widget::setIFrameHeight":s.setIFrameHeight(o);break;case"Widget::setPreferencesFormWidth":s.setPreferencesFormWidth(o);break;case"Widget::setPreferencesFormHeight":s.setPreferencesFormHeight(o);break;case"Widget::setPreferencesFormSize":var r=o.split(",");s.setPreferencesFormSize(r[0],r[1]);break;case"Widget::showPreferences":s.showPreferences();break;case"Widget::hidePreferences":var a,c=decodeURIComponent(e).split("<>");for(o=[],a=1;a<c.length;a++)o[o.length]=c[a];o=o.join("<>");var l={},h=this.getValuesFromUrl(o);for(a=0;a<h.length;a++)l[h[a][0]]=h[a][1];(i.Query.wauth||[])[0]===s.getAuth()&&(""!==i.getParam("value")&&s.setValues(l),setTimeout(function(){s.loadFromSrc()},200),this.params.notifyChangesHandler(s)),t(window).trigger({type:"widgetSettingsTuned",id:s.id},{state:o?"save":"close"}),s.hidePreferences();break;case"Widget::dropPreferences":s.dropPreferences(),t(window).trigger({type:"widgetSettingsDropped",id:s.id})}}},xframeSrc:function(e,i,n){var s;if(t.browser&&t.browser.msie){(s=e.cloneNode(!0)).style.position="absolute",s.style.visibility="hidden",s.id="";var o=function(){t(s).unbind("load",o),s.style.position="",s.style.visibility="",n&&n()};t(s).bind("load",o),s.src=i+"&rnd="+Math.random();try{document.body.appendChild(s)}catch(t){}}else t(e).one("load",function(){n&&n()}),e.src=i+"&rnd="+Math.random()},addToReloadQueue:function(t,e){t.id&&(this.widgetReloadQueue[t.id]={flag:!0,widget:t,callback:e})},processReloadQueue:function(){var t,e=function(t,e){var i=Math.round(30*Math.random()*1e3);setTimeout(function(){t.reload(e),t._isNotReloaded=!0},i)};for(var i in this.widgetReloadQueue)this.widgetReloadQueue.hasOwnProperty(i)&&(t=this.widgetReloadQueue[i]).flag&&(e(t.widget,t.callback),t.flag=!1)},showEditForm:function(e,i,n){var s=this.get(e);if(s.params.prefs_src!==this.undef()&&""!==s.params.prefs_src){var o=s.iframeElement(s.params.prefs_src,[],!0),r=o.attr("src");t(i).empty().append(o),o.attr("src",r+"&rnd="+Math.random()),o.bind("load",n)}else t.get(this.params.formUrl,{widget:s.getWidgetId(),wauth:s.getAuth(),dataType:"json",prefs_get:s.params.prefs_get?JSON.stringify(s.params.prefs_get):""},n)},getFontSize:function(){return this._fontSize||(this._fontSize=t(".widget").css("font-size")),this._fontSize},end:!0},Widget.Framework.init({jsonUrl:"",addUrl:"/adddata/",rawBodyUrl:"/inline/",formUrl:"/form.html",proxyUrl:"/xframeproxy.html",wauth:!1,idTemplate:/WIDGETID/g,idPrefix:"wd-",wrapperPrefix:"wd-",wrapperPostfix:"-",iframeHeight:"auto",iframeWidth:400,layoutFixed:!1,statParams:{pid:132,cid:2947},patternId:!1,yu:!1,is_default:!1,geoid:!1,region:!1,havePrefsFrom:!1,isWidgetNormal:!1,open_settings_on_add:!1,title:"",prefs_get:!1,locale:"ru",domain:"ru",dataLoadingText:" ",showPreferencesHandler:function(){},hidePreferencesHandler:function(){},notifyChangesHandler:function(){},preloader:"<div>#dataLoading#</div>"})}(jQuery),Widget.GetInstance=function(t){return Widget.Framework.get(t)},Widget.GetInstanceByWauth=function(t){return Widget.Framework.getByWauth(t)},Widget.Init=function(t){return Widget.Framework.init(t)},Widget.Bind=function(t,e){return Widget.Framework.bind(t,e)},Widget.BindOnAdd=function(t,e){return Widget.Framework.prebind(t,e)},$(document).ready(function(){Widget.Framework.domLoaded()}),Widget.Framework.focused=!0,$.browser&&$.browser.msie?($(document).bind("focusout",function(){Widget.Framework.focused=!1}),$(document).bind("focusin",function(){Widget.Framework.focused=!0})):($(window).focus(function(){Widget.Framework.focused=!0}),$(window).blur(function(){Widget.Framework.focused=!1}));var iframeWidget=Widget.Framework.bindIframe();iframeWidget?window.widget=iframeWidget:(window.WidgetMessaging=function(t){Widget.Framework.xframeGet(t)},$(window).on("resize",$.debounce(function(){var t=$(".widget").css("font-size");t!==Widget.Framework._fontSize&&(Widget.Framework._fontSize=t,Widget.Framework.all().forEach(function(t){t.adjustFontSize()}))},200))),"postMessage"in window&&$(window).bind("message",function(t){Widget.Framework.onWindowMessage(t.originalEvent)})}BEM.DOM.decl("etrains",{onSetMod:{direction:function(t,e){var i=this.params.urls&&this.params.urls[e||"fwd"];i&&this.elem("title-link").attr("href",i)}},toggle:function(){this.toggleMod("direction","rev"),home.stat.logPath("click","rasp."+this.params.counterType+".changeway")}},{live:function(){this.liveBindTo("direction","pointerclick",function(){this.toggle()})}}),BEM.DOM.decl({block:"etrains",modName:"client",modVal:"yes"},{init:function(){var t=this.findBlockOutside("widget").getInstance(),e=this.params;if(t&&e.host){var i=e.host+"widgets/suburban/next_trains",n={locale:BEM.blocks["i-global"].param("locale")};["rasp_to","rasp_direction","rasp_from","minutes_forward","minutes_backward","n"].forEach(function(e){var i=t.getValue(e);i&&(n[e]=i)}),$.ajax({url:i,data:n,dataType:"jsonp",success:this.changeThis(function(e){this.draw(e),$(window).trigger({type:"widgetLoaded",id:t.id})}),error:this.changeThis(function(){this.clear(),$(window).trigger({type:"widgetLoaded",id:t.id})})})}},draw:function(t){var e,i;if(t){var n=!0,s=this.params.counterType;t.routes_forward.length||(n=!1),e=home.view("etrains__draw",{from:t.from.name,to:t.to.name,today:t.routes_forward,host:this.params.host,direction:n,counterType:s}),i=home.view("etrains__draw",{from:t.to.name,to:t.from.name,today:t.routes_backward,host:this.params.host,direction:!n,counterType:s}),e||i||(e=i="")}else e=i="";this.elem("tracks").append(e,i),home.stat.logDOMShow(this.domElem)},clear:function(){this.elem("tracks").empty()}},{live:function(){this.__base.apply(this,arguments),this.liveInitOnEvent("init",function(t,e){this.init(e)})}}),home.decline=function(t,e){return e&&e.length?0===t&&e[3]?e[3]:e[1]||e[2]?e[2]?((t%=100)>=20&&(t%=10),1===t?e[0]:t>1&&t<5?e[1]:e[2]):t>=0&&t<=1?e[0]:e[1]:e[0]:""},BEM.DOM.decl({block:"dropdown2",modName:"switcher",modVal:"link"},null,{live:function(){return this.liveInitOnBlockInsideEvent("click","link",function(t){this._onSwitcherClick(t)}),this.__base()}}),BEM.DOM.decl({block:"menu",modName:"type",modVal:"radio"},{getVal:function(){var t=this.getItems("checked","yes")[0];return t&&this.elemParams(t).val},setVal:function(t){return this.getItems().forEach(function(e){this.elemParams(e).val===t?this.setMod(e,"checked","yes"):this.delMod(e,"checked")},this),this._onChange(),this},_onItemClick:function(t,e,i){this.__base.apply(this,arguments),this.hasMod(t,"checked","yes")||(this.delMod(this.elem("item","checked","yes"),"checked"),this.setMod(t,"checked","yes"),this._onChange())}}),BEM.DOM.decl("themes-promo",{onSetMod:{js:function(){var t=this.params,e=t.promos;this.LS_KEY="home:themes-promo-"+t.type,this.LS_KEY_THEME_PREFIX="home:themes-promo-ban-",this.now=new Date,this.expiresType=(new Date).setMonth(this.now.getMonth()+1),this.expiresSkin=(new Date).setMonth(this.now.getMonth()+2),this.now=this.now.getTime();for(var i=0,n=e.length;i<n;i+=1)if(this._canShow(e[i])){this.promo=e[i];break}this.promo&&(this.promo.dark&&this.setMod("dark","yes"),this.promo.closeCounter=this._getStatPath(this.promo.counter+".close"))},state:{shown:function(){home.subscribeData(home.stat.logDOMShow.bind(this,this.domElem)),this._hasStorage()&&this.bindTo("link","click",this._setPromo),this.bindTo("close close-icon","click",this._closePromo)}}},_canShow:function(t){return this._checkBlock(this.LS_KEY)&&this._checkBlock(this.LS_KEY_THEME_PREFIX+t.themes)},_checkBlock:function(t){if(!this._hasStorage())return!0;var e=this._getUnlockDate(t);return!e||e-this.now<=0},_closePromo:function(t){t.preventDefault(),home.localStorage.setItem(this.LS_KEY,this.expiresType),home.localStorage.setItem(this.LS_KEY_THEME_PREFIX+this.promo.themes,this.expiresSkin),this.promo.closeUrl&&((new Image).src=this.promo.closeUrl),this._hide()},_hide:function(){this.setMod("state","hidden"),this.domElem.parent().addClass("themes-promo__gone")},_setPromo:function(t){t.preventDefault();var e=this.elem("link").attr("href"),i=this.params.curTheme,n=this.promo.default;home.localStorage.setItem(this.LS_KEY_THEME_PREFIX+this.promo.themes,this.expiresSkin),$.ajax(this.promo.setThemeUrl).done(function(){setTimeout(function(){window.location.href="/?prevTheme="+encodeURIComponent(i)+"&newTheme="+encodeURIComponent(n)},500)}).fail(function(){window.location.href=e})},_getUnlockDate:function(t){return Number(home.localStorage.getItem(t))},_getStatPath:function(t){return"head.skinpromo."+t},_hasStorage:function(){return!home.disabledLS}}),BEM.DOM.decl({block:"themes-promo",modName:"type",modVal:"header"},{onSetMod:{js:function(){this.__base.apply(this,arguments);var t=this.promo;t&&t.href&&t.text&&(this.domElem.append(home.view("themes-promo__inner-header",{attrs:{href:t.href,"data-statlog":this._getStatPath(t.counter+".preview"),"data-statlog-redir":"0"},textMix:"default"!==this.params.curTheme?" link_black_yes":"",closeAttrs:home.getAttributes({"data-statlog":this._getStatPath(t.counter+".close"),"data-statlog-redir":"0","aria-label":home.l10n("promo.themes-promo__close"),tabindex:"0",role:"button"}),text:(t.title?t.title+" ":"")+t.text})),t.showUrl&&((new Image).src=t.showUrl),this.setMod("state","shown"))}},_canShow:function(t){return this.__base.apply(this,arguments)&&this._checkNotEqualCurrentTheme(t)},_checkNotEqualCurrentTheme:function(t){return t.themes!==this.params.curTheme}}),$(function(){var t,e,i,n,s,o,r,a,c=!1;function l(e){c=!0,e.bem("popup").show(t)}e=".link_geosuggest_yes",i=".link_geosuggest_yes",n=$(".geosuggest"),s=$(i),o=$(e),r=n.find(".geosuggest__header")[0],a=r?r.onclick():{},n.length>0&&setTimeout(function(){var e;if("1"===a.ispopup){if(0===(t=o).length)return!1;l(n)}else if(0===(t=s).length)return!1;e=function(){l(n)},t.click(e),$(document).keydown(function(t){"27"===t.keyCode&&n.bem("popup").hide()}),n.bem("popup").on("hide",function(){c=!1}),"1"===a.ispopup&&n.bem("popup").on("hide",function(){t.unbind("click",e)}),$(window).resize(function(){setTimeout(function(){if(c){n.bem("popup")._isShowed=!1,n.bem("popup").show(t),c=!0;try{document.body.focus()}catch(t){}}},142)}),$(".b-region__ajax-action").click(function(){return $(document.body).append('<iframe style="display:none" src="'+this.href+'"></iframe>'),n.bem("popup").hide(),!1})},1e3)}),BEM.DOM.decl({block:"themes-promo",modName:"type",modVal:"popup"},{onSetMod:{js:function(){var t=$(window);t.width()<951||t.height()<400||$("body").hasClass("b-page_win10-stripe")&&t.width()<1400||(this.__base.apply(this,arguments),BEM.blocks["i-message-locker"].acquireLock("themes-promo",this._hide.bind(this)).then(function(){var t=this.promo,e=this.params;this.promo.from_atom?$("html").hasClass("i-ua_inlinesvg_yes")&&this.promo.icon_svg?this.promo.imgSrc=this.promo.icon_svg:e.icon&&(this.promo.imgSrc=t.icon):this.promo.imgSrc=e.imgRoot+this.promo.counter+".jpg";this.elem("link").attr({href:t.href,title:t.text,"data-statlog":this._getStatPath(t.counter+".preview"),"data-statlog-redir":"0"}),this.elem("title").html(t.title),this.elem("text").html(t.text),this.elem("close-icon").attr({"data-statlog":t.closeCounter,"data-statlog-redir":"0"});var i=$('<img class="themes-promo__img"/>');i.one("error",function(){$(this).hide()}),i.one("load",this.changeThis(function(){this.elem("image").append(i),t.showUrl&&((new Image).src=t.showUrl),this.setMod("state","shown")})),i.attr("src",t.imgSrc)}.bind(this)))},state:{shown:function(){this.__base.apply(this,arguments),$(".media-grid").length||this.findBlockOutside("footer").setMod("themes","promo")}}},_getStatPath:function(t){return"skinpromo."+t}}),BEM.DOM.decl({block:"themes-promo",modName:"type",modVal:"revert"},{onSetMod:{js:function(){this.elem("close-icon").attr({"data-statlog":"head.skinpromo.revert.close","data-statlog-redir":"0"}),this.bindTo("close-icon","click",this.setMod.bind(this,this.domElem,"state","nothing")),this.delMod("state"),home.subscribeData(home.stat.logDOMShow.bind(this,this.domElem))}}}),BEM.DOM.decl("themes-touch-promo",{onSetMod:{js:function(){var t=this.__self.LS_KEY,e=$(window),i=this,n=this.hasMod("type","sms")?3e4:15e3;!home.localStorage||home.disabledLS||home.localStorage.getItem(t)||e.width()<951||e.height()<520||$("body").hasClass("b-page_win10-stripe")&&e.width()<1400||setTimeout(function(){BEM.blocks["i-message-locker"].acquireLock("themes-touch-promo",i._close.bind(i)).then(function(){home.localStorage.setItem(t,"1"),i.setMod("visible","yes"),i.bindTo("button reload","click",function(){i._submit()}),i.bindTo("close","click",function(){i._close(),home.stat.logPath("click",i.params.counters.close)}),setTimeout(i.changeThis(i._close),n),home.stat.logPath("show",i.params.counters.show),i.hasMod("type","sms")&&home.stat.logPath("show","skintouchpromo.sms.button")})},1e3)}},_submit:function(){var t=this;return this.params.sk&&(this._sk=this.params.sk,this.setMod("progress","yes"),this.setMod("submitted","yes"),$.ajax({url:"/portal/proxy/sms/submit",type:"POST",xhrFields:{withCredentials:!0},data:{sk:this._sk},success:function(e){t._processSendResult(e)},error:function(){t._processSendResult({ok:0})},dataType:"json"})),!1},_processSendResult:function(t){1===t.ok&&t.track_id?this._sendTrackId(t.track_id):this._processError("submit"),this.delMod("progress")},_sendTrackId:function(t){var e=this,i={track_id:t,sk:this._sk};return $.ajax({url:"/portal/proxy/sms/commit",type:"POST",xhrFields:{withCredentials:!0},data:i,success:function(t){e._processSendSmsResult(t)},error:function(){e._processSendSmsResult({ok:0})},dataType:"json"}),!1},_processError:function(t){this.setMod("error","yes"),home.stat.logPath("show","skintouchpromo.sms.error."+t),home.stat.logPath("show","skintouchpromo.sms.reload")},_processSuccess:function(){this.delMod("error"),this.setMod("done","yes"),home.stat.logPath("show","skintouchpromo.sms.success")},_processSendSmsResult:function(t){this.delMod("progress"),1===t.ok?this._processSuccess():this._processError("commit")},_close:function(){BEM.blocks["i-message-locker"].releaseLock("themes-touch-promo"),this.delMod("visible")}},{LS_KEY:"themesTouchPromoShown"}),BEM.DOM.decl("mts-stripe",{_closeStripe:function(){this.domElem.hide()}},{live:function(){return this.liveBindTo("close","click",function(){this._closeStripe()}),this.liveBindKey("close","space enter",function(){this._closeStripe()}),!1}}),BEM.DOM.decl("mobile-balloon",{},{live:function(){return this.liveBindTo("no","pointerclick",function(){(new Image).src=this.params.closeurl,this.domElem.hide()}),!0}}),BEM.DOM.decl("player-control",{_onClick:function(t){var e=t.data.domElem.data();return this.__self.process(e),!1}},{process:function(t){return this.testOptions(t)?this._open?Promise.resolve():(this._open=!0,this.beforePlay(t).then(this.play.bind(this)).then(this.onPlaySuccess.bind(this)).catch(this.onPlayFail.bind(this))):(home.error.logError({block:this.getName(),message:"testOptions failed",meta:t,sourceType:"logic"}),Promise.reject())},testOptions:function(t){return!!t.fromBlock},beforePlay:function(t){return this._initTiming(),this._lockAutoReload(),Promise.all([this._showLoader(t),this._awaitData()]).then(function(){return t})},play:function(t){return Promise.resolve(t)},onPlaySuccess:function(){return this._firstPaintTiming(),$(":focus").blur(),this._hideLoader()},onPlayFail:function(t){this.hide(),this._rejectTiming(),t&&home.error.logError({block:this.getName(),message:"player-control.onPlayFail: unexpected error",sourceType:t.timeout?"timeout":"logic"},t)},getContainer:function(){return $("body")},_initTiming:function(){this.TIMINGSUFFIX&&!this._timing&&(this._timing=Ya.Rum.makeSubPage("28.15.1242."+this.TIMINGSUFFIX),Ya.Rum.sendTTI(!1,Ya.Rum.getTime(),this._timing))},_rejectTiming:function(){this._timing&&this._timing.cancel()},_firstPaintTiming:function(){this._timing&&!this._timingSent&&(Ya.Rum.sendTimeMark("2793",Ya.Rum.getTime(),!1,this._timing),this._timingSent=!0)},_lockAutoReload:function(){BEM.channel("reload").trigger("lock",{block:this.getName()})},_releaseAutoReload:function(){BEM.channel("reload").trigger("release",{block:this.getName()})},_awaitData:function(){return this._awaitDataPromise||(this._awaitDataPromise=new Promise(function(t){home.subscribeData(t)})),this._awaitDataPromise},_createLoader:function(){return $(home.view("player-control__loader",{}))},_showLoader:function(){if(this._loader)return Promise.resolve();var t=this._createLoader();return t.appendTo(this.getContainer()),t.one("click",".player-control__close",function(){return this.hide(),!1}.bind(this)),this._loader=t,this._loader.show(),Promise.resolve()},_hideLoader:function(){this._loader&&(this._loader.off("click"),this._loader.remove(),this._loader=null)},hide:function(){this._hideLoader(),this._releaseAutoReload(),this._open=!1},live:function(){this.liveBindTo("link","pointerclick",function(t){return this._onClick(t)})}}),BEM.DOM.decl("player-control",{},{live:function(){return this.liveBindKey("link","enter space",function(t){return this._onClick(t)}),this.__base()}}),BEM.DOM.decl({block:"stream-control",baseBlock:"player-control"},{},{getContainer:function(){return $("body")},downloadResources:function(){return home.bundles.load("stream")},beforePlay:function(t){var e=this._currentEvent={},i={active:t.streamActive,programParams:{from_block:t.fromBlock},container:this.getContainer()},n={};return t.streamDefault&&(t.streamChannel="default"),t.streamId||t.streamChannel||t.streamActive?(n.id=t.streamId,n.type=t.type,n.channel_id=t.streamChannel,n.category=t.streamCategory,this._initTiming(),this._lockAutoReload(),Promise.all([this._showLoader({scroll:t.scroll?n:null}),this._awaitData().then(this._logDisabled.bind(this,t)).then(this.downloadResources.bind(this))]).then(function(){return this._loader&&this._currentEvent===e?Promise.resolve({stream:n,startParams:i}):Promise.reject()}.bind(this))):(home.error.logError({block:this.getName(),message:"beforePlay: bad options - nothing to play",sourceType:"logic",meta:{options:t}}),Promise.reject())},play:function(t){var e=t.stream,i=t.startParams;return BEM.DOM.blocks.stream.play(e,i).catch(function(t){throw t.message="play->"+t.message,t})},onPlaySuccess:function(){return BEM.DOM.blocks.stream.get().then(function(t){t.on("hide",function(){this.hide()}.bind(this))}.bind(this)).catch(function(t){home.error.logError({block:this.getName(),message:"onPlaySuccess: failed to bind to hide event"},t)}.bind(this)),this.__base()},startPlayerFromQuery:function(){this._awaitData().then(function(){if(!home.getData("stream.stream"))return Promise.reject();var t,e,i=home.getData("stream.stream")||{},n=i.clientData;if(!n||i.disabled)return Promise.reject();if(this._history.on("closed",this.onHistoryChange.bind(this)),!n.queryChannel&&!n.queryId)return Promise.reject();var s=n.queryId,o=n.queryChannel,r=n.queryCategory;return e={id:s,channel_id:o,category:r},t={active:n.queryActive,programParams:{from_block:n.queryFrom},container:this.getContainer()},this._initTiming(),this._lockAutoReload(),Promise.all([this._showLoader({scroll:n.queryDisableScroll?"":e}),this._awaitBlock()]).then(function(){return this.play({stream:e,startParams:t})}.bind(this)).then(this.onPlaySuccess.bind(this)).catch(function(t){if(this.hide(),this._rejectTiming(),t)throw t}.bind(this))}.bind(this)).catch(function(t){t&&home.error.logError({block:this.getName(),message:"startPlayerFromQuery: fail",sourceType:t.timeout?"network":"logic"},t)}.bind(this))},_logDisabled:function(t){var e=home.getData("stream.stream");if(!e||e.disabled){var i="_logIfDisabled: entrypoint with "+(e?"disabled stream":"stream.stream not init");return home.error.logError({block:this.getName(),message:i,sourceType:"logic",meta:{options:t}}),Promise.reject()}},_awaitBlock:function(){return this._getBlockPromise||(this._getBlockPromise=new Promise(function(t,e){var i=+new Date;!function n(){if(BEM.DOM.blocks.stream)t();else if(+new Date-i>1e4){var s=Error("_awaitBlock: no block after 10s");s.timeout=1,e(s)}else setTimeout(n,100)}()})),this._getBlockPromise},_awaitOrDownload:function(){return this._awaitData().then(function(){if(!home.getData("stream.stream"))return Promise.reject();var t=home.getData("stream.stream").clientData;return t?(this._showLoader(),t.queryChannel||t.queryId?this._awaitBlock():this.downloadResources()):Promise.reject()}.bind(this))},_initTiming:function(){var t=window.Ya=window.Ya||{},e=t.Stream=t.Stream||{};e.timing&&e.timing.cancel(),e.timing=t.Rum.makeSubPage("2952")},_rejectTiming:function(){},_firstPaintTiming:function(){},onHistoryChange:function(t,e){e&&this._awaitOrDownload().then(function(){var t=e.params,i={active:e.active,container:this.getContainer(),program_params:{from_block:"history"}};return this._history.lock(),this._lockAutoReload(),BEM.DOM.blocks.stream.play(t,i)}.bind(this)).then(function(){this._history.release(),this.onPlaySuccess()}.bind(this),function(t){t&&home.error.logError({block:"stream-control",message:"history play: playerStartFail",sourceType:"logic"},t),this._history.release(),this.hide()}.bind(this))},live:function(){return this._history=BEM.blocks["stream-history"].get(),this.startPlayerFromQuery(),this.__base()}}),BEM.DOM.decl("stream-control",{_onClick:function(){return!0}},{downloadResources:function(){var t=home.getData("stream.bundleName");return t?home.bundles.load(t):this.__base.apply(this,arguments)},beforePlay:function(t){var e,i,n,s=(home.getData("stream.stream")||{}).clientData,o=s&&s.redirectTo;return o?(e=home.parseUrl(o),i={stream_active:t.streamActive,from_block:t.fromBlock},t.streamDefault&&(t.streamChannel="default"),i.stream_id=t.streamId,i.stream_channel=t.streamChannel,e.query=i,n=home.makeUrl(e),location.href=n,Promise.reject()):this.__base.apply(this,arguments)},_createLoader:function(){return $(home.view("stream-control__loader",{}))},_showLoader:function(t){var e=t&&t.scroll,i=this.__base.bind(this);return e?this._animateOpen(e).then(function(){return i(t)}):i(t)},_animateOpen:function(t){return new Promise(function(e){var i,n;if(!this._mediaGrid){if(i=$(".media-grid"),n=$(".media-stream"),!i.length||!n.length)return void e();this._mediaGrid=i.bem("media-grid"),this._mediaStreamTop=n.offset().top-10}this._mediaGrid.hasMod("collapsed")&&this._mediaGrid.toggleCollapsed(),this._findMediaEntry(t),this.afterCurrentEvent(function(){this._animatingEntry=null,this._insertFade(),$("html,body").stop().animate({scrollTop:this._mediaStreamTop},400,function(){setTimeout(function(){this._$fade.show(),this._animateMediaEntry().then(e,e)}.bind(this),250)}.bind(this))},this)}.bind(this))},_findMediaEntry:function(t){var e,i=this._mediaGrid.domElem.find(".media-play__container");this._$mediaEntry=null,t.id&&(e=i.filter("[data-stream-id="+t.id+"]")),t.channel_id&&!e&&(e=i.filter("[data-stream-channel="+t.channel_id+"]")),e&&(e=e.find(".media-service__stream-bg")).length&&(this._$mediaEntry=$(e[0]))},_insertFade:function(){this._$fade||(this._$fade=$('<div class="stream-control__fade"></div>'),this._$fade.appendTo(this.getContainer()))},_animateMediaEntry:function(){return this._animatingEntry||(this._animatingEntry=new Promise(function(t){var e;this._$fade.addClass("stream-control__fade_animating"),this._$mediaEntry&&(e=this._getEntryTranslate(),this._$mediaEntry.css("transform","translate3d("+e.x+"px,"+e.y+"px,0) scale(4)"),this._$mediaEntry.addClass("media-service__stream-bg_animating")),setTimeout(function(){this._$mediaEntry&&(this._$mediaEntry.css({transform:"","transition-duration":"0s"}),this._$mediaEntry.removeClass("media-service__stream-bg_animating")),this._$fade.removeClass("stream-control__fade_animating"),t()}.bind(this),250)}.bind(this)).then(function(){this._$fade.hide(),this._$mediaEntry&&this._$mediaEntry.css({"transition-duration":""})}.bind(this)).catch(function(t){this._$fade.remove(),this._$fade=null,home.error.logError({block:"stream-control",message:"error"},t)}.bind(this))),this._animatingEntry},_getEntryTranslate:function(){var t=$("body"),e=this._$mediaEntry.offset(),i=e.left+this._$mediaEntry.outerWidth()/2,n=e.top+this._$mediaEntry.outerHeight()/2,s=t.scrollLeft()+window.innerWidth/2,o=this._mediaStreamTop+window.innerHeight/2;return{x:Math.ceil(s-i),y:Math.ceil(o-n)}},live:function(){return this.__base()}}),BEM.decl("stream-history",{onSetMod:{js:function(){this._w=this.params.window,this._h=this._w.history;var t=this;this._listener||$(this._w).on("popstate",function(){setTimeout(function(){t._getPopStateId()!==t._lastPopState&&t._onPopStateCold()},10)}),this._list=[],this._lastPopState=t._getPopStateId(),(this.params.flat||this.params.fallback)&&(this._interval=setInterval(function(){t._getPopStateId()!==t._lastPopState&&t._onPopStateCold()},50))},player:{"":function(){var t=this._getDepth();t&&!this.params.flat?this._h.go(-t):this.clean()}}},_getPopStateId:function(){var t=this._w.location.href+"|";return this.params.flat?t+=this._list.length:t+=this._getDepth(),t},destroy:function(){$(this._w).off("popstate",this._listener)},lock:function(){this._nohistory=!0},release:function(){this._nohistory=!1},update:function(t,e){if(!this._nohistory&&"continue"!==e.auto){var i={},n=this._getCleanUrl();e.channel_id&&(i.stream_channel=e.channel_id),"watching"!==t&&"error"!==t&&(i.stream_active=t),e.id&&(i.stream_id=e.id),"category"===t&&(i.stream_category=e.category);var s=home.makeUrl({path:n.path,hash:n.hash,query:$.extend({},n.query,i)}),o=this._getDepth(),r=e.replace,a=this._extractOtherParams(e);!this.hasMod("player","opened")&&o&&(r=!0),this.params.flat&&(this._list.push({url:this._w.location.href,other:a}),r=!0),r||o++;var c={streamDepth:o,other:a},l=r?"replaceState":"pushState";this._h[l](c,this._w.document.title,s),this._lastPopState=this._getPopStateId()}},back:function(t){var e=this._getDepth();if(t&&e<2){var i=this._getState(),n=$.extend({replace:!0},i.params,t.params);return this.update(t.active||i.active,n),void this._onPopState()}if(this.params.flat){var s=this._list.pop(),o=s&&s.url;o||(o=this._getCleanUrl()),this._otherParams=s.other,this._h.replaceState(null,this._w.document.title,o),this._onPopState()}else this._h.back()},_getCleanUrl:function(){var t=home.parseUrl(this._w.location.href),e=t.query;return delete e.stream_channel,delete e.stream_id,delete e.stream_active,delete e.stream_category,{path:t.path,query:e,hash:t.hash}},clean:function(){var t=this._getCleanUrl(),e=home.makeUrl({path:t.path,hash:t.hash,query:t.query});this._h.replaceState(this._h.state,this._w.document.title,e),this._lastPopState=this._getPopStateId(),this.trigger("x-closed")},_getState:function(){var t=home.parseUrl(this._w.location.href).query,e=t.stream_channel,i=t.stream_id,n=t.stream_active||"watching",s={},o=this._getOtherParams();if(i||e||t.stream_active){for(var r in i?s.id=i:e&&(s.channel_id=e,s.live=!0),t.stream_category&&(s.category=t.stream_category),o)o.hasOwnProperty(r)&&(s[r]=o[r]);return{active:n,params:s}}},_getDepth:function(){if(this.params.flat)return this._list.length;try{return this._h.state&&this._h.state.streamDepth||0}catch(t){return 1}},_getOtherParams:function(){return this.params.flat?this._otherParams||{}:this._h.state&&this._h.state.other||{}},_extractOtherParams:function(t){var e={auto:1,replace:1,id:1,channel:1,channel_id:1,program:1,current:1,live:1,category:1},i={};for(var n in t)t.hasOwnProperty(n)&&!e[n]&&(i[n]=t[n]);return i},_getEventName:function(){return this.getMod("player")||"closed"},_onPopStateCold:function(){return this._onPopState()},_onPopState:function(){this._lastPopState=this._getPopStateId();var t=this._getEventName(),e=this._getState();if("closed"!==t||e){var i=this._getDepth();!e||this.params.flat||i?this.trigger(t,e):"closed"===t?this.clean():this.trigger(t)}else this.trigger("x-closed")}},{get:function(t){return this._instance||(this._instance=new BEM.blocks["stream-history"]({},{window:t||window,flat:$(".i-ua_browser_msie,.i-ua_browser_edge").length})),this._instance}}),function(t,e){"use strict";var i="yc",n=1209600;t.Ya=t.Ya||{};var s=t.Ya.ycCookie=t.Ya.ycCookie||{};function o(){for(var t,n=e.cookie.split("; "),s=0;s<n.length;++s)if((t=n[s].split("="))[0]===i)return c(t.slice(1).join("="))||{};return{}}function r(t){var s,o,r=function(t){if(!t||"object"!=typeof t)return;for(var e,i,n=[],s=0,o=Object.keys(t),r=o.length;s<r;s++)e=t[o[s]],i=[o[s],encodeURIComponent(e.value||e)],/^\d+$/.test(e.expires)&&i.unshift(e.expires),n.push(i.join("."));return n.join("#")}(t),a=new Date,c=a.getTime();r?a.setTime(c+1e3*n):a.setTime(c-487),s="expires="+a.toUTCString(),o="domain="+e.domain.replace(/^\S*yandex/,".yandex"),e.cookie=i+"="+r+"; "+s+"; "+o+"; path=/"}function a(t){try{return decodeURIComponent(t)}catch(e){return t}}function c(t){if(!t||"string"!=typeof t||!t.length)return{};/%23\d{10}/.test(t)&&(t=a(t)),t=t.split("#");for(var e,i=Date.now()/1e3,n={},s=0,o=t.length;s<o;s++)2===(e=t[s].split(".")).length?n[e[0]]=a(e[1]):e.length>2&&(isNaN(e[0])?n[e[0]]=a(e.slice(1).join(".")):e[0]>i&&(n[e[1]]={value:a(e.slice(2).join(".")),expires:e[0]}));return n}s.get=function(t){var e,i,n,s=o(),r={};if(!s[t])return{};(e=s[t])&&e.value&&(e=e.value);for(var a=0,c=(i=e.split(",")).length;a<c;++a)r[(n=i[a].split(":"))[0]]=parseInt(n[1],10);return r},s.set=function(t,e){if(!t||!e||"object"!=typeof e)return this;var i,n,s,a=o(),c=[];for(i=0,n=(s=Object.keys(e)).length;i<n;i++)c.push(s[i]+":"+e[s[i]]);return c.length?(a[t]={value:c.join(","),expires:String(Math.floor(Date.now()/1e3+259200))},r(a),this):this},s.remove=function(t){if(!t)return this;var e=o();return delete e[t],r(e),this}}(window,document),BEM.DOM.decl("stream-quality",{onSetMod:{js:function(){this._yes=this.findBlockOn("yes","button"),this._no=this.findBlockOn("no","button"),this.bindTo("yes","click",this._onYes,this),this.bindTo("no","click",this._onNo,this),this._waitforStream()},disabled:function(t,e){this._yes.toggleMod("disabled","yes","",e),this._no.toggleMod("disabled","yes","",e),this.delMod("status")}},_onYes:function(){this._log("yes")},_onNo:function(){this._log("no")},_log:function(t){this.setMod("disabled","yes"),this.setMod("status",t);var e=this,i=e._stream.getMod("channel")+"."+t,n=document.createElement("img");n.onload=n.onerror=function(){e.delMod("disabled")},n.src="https://yandex.ru/clck/counter/dtype=stred/pid=132/cid=73131/path="+i+"/*"},_waitforStream:function(){var t=this,e=function(){BEM.DOM.blocks.stream?BEM.DOM.blocks.stream.get($("body")).then(function(e){t._stream=e,t.setMod("ready","yes")}):setTimeout(e,1e3)};e()}}),BEM.DOM.decl("desk-notif",{onSetMod:{js:function(){!!$(".navi").length?this._bindEvents():(this._initStatInfo(),this._sendStat())}},_bindEvents:function(){BEM.channel("navi").on("ready",function(){this._initStatInfo(),this._sendStat()}.bind(this))},_initStatInfo:function(){this._cardsStatInfo=this.params.serverCards.map(this._getStatObject)},_getStatObject:function(t){return{name:t,height:$(".desk-notif-card_"+t+"_yes").outerHeight(!0)}},_toStatFormat:function(t){return t.replace(/-/g,"_")},_sendStat:function(){var t=this._cardsStatInfo.map(function(t){return this._toStatFormat(t.name)+"="+t.height},this).join(",");home.stat.logPath("notifications_height",t)}}),BEM.DOM.decl("desk-notif-card",{onSetMod:{js:function(){this.__base.apply(this,arguments),this._initDropDownMenu(),BEM.channel("desk-notif-card").on("ban",this._onBanMessage,this),this.elem("toggler").length&&(this.bindTo("toggler","pointerclick",this._togglerOnClick),this.bindKeyTo("toggler","space enter",function(t){this._togglerOnClick(),t.preventDefault()})),this.bindTo("mouseenter mouseleave",function(t){this.toggleMod("hovered","yes","mouseenter"===t.type)})},"inner-menu":function(){this.afterCurrentEvent(this._calcShift)},hovered:function(){this.afterCurrentEvent(this._calcShift)},focused:function(){this.afterCurrentEvent(this._calcShift)}},_togglerOnClick:function(){var t=this.hasMod("minified","yes");this.delMod("hovered"),this.toggleMod("minified","yes"),this._saveState(t?"expanded":"minified"),home.stat.logDOMShow(this.domElem),home.stat.logPath("click","notifications.mail.login.resize."+(t?"big":"small"))},_initDropDownMenu:function(){this.bindTo("popup-action","pointerclick",function(t){this.dropdown.toggleMod("opened","yes"),this._onActionClick(t)}),this.bindKeyTo("popup-action","space enter",function(t){"a"!==t.data.domElem.prop("tagName").toLowerCase()&&this.dropdown.toggleMod("opened","yes"),this._onActionClick(t)}),BEM.blocks.dropdown2.on(this.domElem,"beforeOpen",function(){this.dropdown=this.findBlockInside("dropdown2"),this.setMod("inner-menu","toggled"),home.stat.logDOMShow(this.elem("options"),{visibilityCheck:!1})},this),BEM.blocks.dropdown2.on(this.domElem,"beforeClose",function(){this.delMod("inner-menu")},this)},_onBanMessage:function(t,e){e.name===this.params.name&&e.type===this.params.type&&this._onAction("ban")},_toggleExpanded:function(t){var e=this.hasMod("expanded"),i=e?"expand":"collapse",n=home.l10n("desktopNotifications.menu."+i),s=this.elem("action","type","expand");t=t||{},s.attr("title",n),s.attr("aria-label",n),this.toggleMod("expanded","yes"),this.toggleMod("minified","yes"),t.save&&this._saveState(e?"minified":"expanded"),this.domElem.removeAttr("data-statlog")},_sendAction:function(t){var e=this.params&&this.params.actions,i=e&&e[t];i&&i.href&&((new Image).src=i.href)},_hideCard:function(){BEM.channel("navi").trigger("closed",{item:this.domElem,delay:400}),this.setMod("state","hidden")},_showClientCard:function(t){this.hasError||!this.hasMod("state","hidden")&&!this.hasMod("transparent","yes")||(this.delMod("loading"),this.domElem.appendTo(this.domElem.parent()),this.delMod("state"),this.delMod(t?"position":"transparent"),setTimeout(function(){this.delMod(t?"transparent":"position"),home.stat.logDOMShow(this.domElem)}.bind(this),0))},_saveState:function(t){var e=this.params.actions&&this.params.actions[t]&&this.params.actions[t].href;e||(e=this.params.save&&this.params.save[t]),e&&setTimeout(function(){try{var t=$(".desk-notif-card__frame");t.length||(t=$('<iframe class="desk-notif-card__frame" name="desk-notif-card__frame" style="display:none"></iframe>'),$("body").append(t)),t.attr("src",e)}catch(t){}},300)},_onAction:function(t){switch(t){case"toggle":break;case"close":case"ban":this._hideCard();break;case"expand":return void this._toggleExpanded({save:!0})}this._sendAction(t)},_onActionClick:function(t){var e=$(t.data.domElem),i=this.getMod(e,"type");"setup"!==i&&t.preventDefault(),"ban"===i?BEM.channel("desk-notif-card").trigger("ban",{name:this.params.name,type:this.params.type}):i&&this._onAction(i,t)},_calcShift:function(){var t=this._isShifted();this.toggleMod("shifted","yes",t)},_isShifted:function(){return(this.hasMod("inner-menu")||this.hasMod("hovered")||this.hasMod("focused"))&&this.hasMod("actions","yes")}},{live:function(){return this.liveBindTo("action","pointerclick",function(t){this._onActionClick(t)}),this.liveBindKey("action","space enter",function(t){this._onActionClick(t)}),this.liveBindTo("focusin focusout",function(t){var e=$("html").hasClass("utilityfocus");this.toggleMod("focused","yes","focusin"===t.type&&e)}),!1}}),BEM.DOM.decl({block:"desk-notif-card",modName:"switchable",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._bindEvents()}},_bindEvents:function(){this.bindKeyTo("switch","space enter",this._switchDirection),this.bindTo("switch","pointerclick",this._switchDirection),this.bindTo("switch","mouseover mouseout focus blur",function(t){this.toggleMod("switch-hovered","yes","mouseover"===t.type||"focus"===t.type)})},_switchDirection:function(){}}),BEM.DOM.decl({block:"desk-notif-card",modName:"disaster",modVal:["yes","fatal"]},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.popup=this.findBlockOn("disaster-popup","popup"),this.popup&&(this.bindTo("link","click",this._showPopup),this.bindKeyTo("link","space enter",this._showPopup),this.params.openPopup&&this.popup.show())}},_showPopup:function(t){this.popup.show(),home.stat.logDOMShow(this.popup.domElem),t.preventDefault()}}),BEM.DOM.decl({block:"desk-notif-card",modName:"sport",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.football=BEM.blocks.football,this.hockey=BEM.blocks.hockey,!this.params.content_id&&this.football&&this.football.highlight?this.bindTo("link","click",this._showFootball):!this.params.content_id&&this.hockey&&this.hockey.highlight&&this.bindTo("link","click",this._showHockey),this.reloadTime=this.params.reloadTime,this.jsonUrl=this.params.jsonUrl}},_showFootball:function(t){this.football.highlight(),t.preventDefault()},_showHockey:function(t){this.hockey.highlight(),t.preventDefault()}}),BEM.DOM.decl({block:"desk-notif-card",modName:"route",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.routes={},this.placeholder={gohome:this.elem("route-gohome"),gowork:this.elem("route-gowork")},this._changeDirectionTo(this._getDirection()),this.hasMod("confirm-promo")&&(this.bindTo(this.elem("points-confirm","action","open-popup"),"click",this._onPointsConfirm),this.bindKeyTo(this.elem("points-confirm","action","open-popup"),"space enter",this._onPointsConfirm),this.bindTo(this.elem("points-confirm","action","reject"),"click",this._onPointsReject),this.bindKeyTo(this.elem("points-confirm","action","reject"),"space enter",this._onPointsReject),this.params["user-points"].promoMode||this._saveState("full"))},direction:function(t,e,i){this.findElem(this.findElem("route-"+e),"link").attr("tabindex","0"),i&&this.findElem(this.findElem("route-"+i),"link").attr("tabindex","-1")},hovered:{yes:function(){this.hasMod("confirm-promo")&&this._loadUserPointsBundle({preload:!0})}}},_changeDirectionTo:function(t){var e=this;return this.direction=t,this.from="gohome"===t?"gowork":"gohome",this.setMod("loading","yes"),this._getRouterData().then(this._renderRoute.bind(this)).then(this._showRoute.bind(this)).then(this._showClientCard.bind(this,this.isShowWithoutMotion)).then(function(){BEM.channel("navi").trigger("loaded",{name:"route",item:e.domElem})}).fail(this._errorHandler.bind(this))},_errorHandler:function(t){this.hasError=!0,BEM.channel("navi").trigger("failed",{name:"route",item:this.domElem}),this.setMod("loading","no");var e=this.from;this.from=this.direction,this.direction=e,home.stat.logPath("tech","notifications.route.error"+t)},_switchDirection:function(){return this._changeDirectionTo(this.from).then(this._saveDirection.bind(this)).then(function(){BEM.channel("navi").trigger("height-change",{delay:150})}),!1},_saveLastDirection:function(t){home.localStorage&&!home.localStorage.disabledLS&&home.localStorage.setItem("traffic."+this.params.id+".lastDirection",t)},_saveDirection:function(){var t;home.localStorage&&!home.localStorage.disabledLS&&(t="gowork"===this._getAutoDirectionTime()?this.__self._getWorkEnd():this.__self._getHomeEnd(),home.localStorage.setItem("traffic."+this.params.id,JSON.stringify({direction:this.direction,validUntil:t})))},_showRoute:function(){this.elem("route-placeholder").height(this.placeholder[this.direction].height()),this.setMod("direction",this.direction),this.setMod("loading","no")},_renderRoute:function(){var t,e=this.direction,i=this.placeholder[e],n=this.routes[e],s="";n.jamsNumber>6?t="red":n.jamsNumber>3?t="yellow":n.jamsNumber>=0?t="green":n.isBlocked&&(t="blocked"),t&&(s="desk-notif-card__icon_traffic_"+t);var o=n.title+" "+n.timeText,r=n.otherWayShow&&n.inBypassText.replace("%s",n.otherWayTimeBenefitText);i.html(home.view("desk-notif-card__inner",{title:home.view("home-link",{href:n.href,mix:" desk-notif-card__link",attrs:{"data-statlog":"notifications.route."+e+".card",tabindex:-1},mods:{black:"yes",pseudo:"yes"},content:o},{}),titleDesc:{mix:"desk-notif-card__style_text"},details:n.otherWayShow?home.view("home-link",{href:n.aroundHref,content:r,mix:" desk-notif-card__details-link",attrs:{"aria-label":r,"data-statlog":"notifications.route."+e+".bypass"},mods:{pseudo:"yes"}},{}):"",iconClass:s}))},_getDirection:function(){var t,e="traffic."+this.params.id;if(home.localStorage&&!home.localStorage.disabledLS){t=home.localStorage.getItem(e+".lastDirection");var i=home.localStorage.getItem(e);if(i){var n=JSON.parse(i);if(home.now().getTime()<n.validUntil)return this.isShowWithoutMotion=!0,n.direction}}var s=this._getAutoDirection();return t===s?this.isShowWithoutMotion=!0:this._saveLastDirection(s),s},_getRouterData:function(){return this.__self._getRouterDataOrCachedRawData(this.params.apiUrls[this.direction]).then(function(t){var e,i;t.isBlocked?this.routes[this.direction]={title:this.params.pointTitles[this.direction],timeText:t.description,href:t.direct&&t.direct.mapUrl,isBlocked:!0}:(t.direct.isBlocked?e=t.bypass:(e=t.direct,i=t.bypass),this.routes[this.direction]={title:this.params.pointTitles[this.direction],timeText:e.timeText,inBypassText:i&&i.label,otherWayTimeBenefitText:i&&i.timeTextDelta,jamsNumber:t.jamsRate,href:e.mapUrl,aroundHref:i&&i.mapUrl,otherWayShow:!!i})}.bind(this))},_getAutoDirection:function(){return this.params.direction?this.params.direction:this._getAutoDirectionTime()},_getAutoDirectionTime:function(){if(this.params.directionTime)return this.params.directionTime;var t=home.now().getHours();return t<15&&t>=3?"gowork":"gohome"},_loadUserPointsBundle:function(t){return t=t||{},this._userPointsBundle||(this._userPointsBundle=home.bundles.load("user-points"),this._userPointsBundle.catch(function(){this._userPointsBundle=null,home.error.logError({block:this.__self.getName(),message:"_loadUserPointsBundle, failed to load bundle"}),t.preload||(this.setMod(this.elem("points-confirm-wrapper"),"load-failed","yes"),setTimeout(function(){this.delMod(this.elem("points-confirm-wrapper"),"load-failed")}.bind(this),300))}.bind(this))),this._userPointsBundle},_onPointsConfirm:function(){return this._loadUserPointsBundle().then(function(){this._switchPromoToMinMode();var t=BEM.blocks["user-points"];t.on("hide",this._onUserPointsClose,this),t.on("points",this._onUserPointsUpdate,this),t.open(this.params["user-points"])}.bind(this)),!1},_onPointsReject:function(){return this._hideCard(),this._saveState(""),this._sendAction("ban"),!1},_switchPromoToMinMode:function(){this.delMod(this.findElem("points-screen","screen","big"),"visibility"),this.setMod(this.findElem("points-screen","screen","small"),"visibility","visible"),this._saveState("min"),home.stat.logDOMShow(this.domElem)},_onUserPointsClose:function(){BEM.blocks["user-points"].un("hide",this._onUserPointsClose,this),BEM.blocks["user-points"].un("points",this._onUserPointsUpdate,this)},_onUserPointsUpdate:function(t,e){var i=BEM.blocks["i-global"],n={GeohelperHost:i.param("geohelperHost"),MordaZone:i.param("mordaZone"),Locale:i.param("locale")};this.params.apiUrls={gohome:home.view("route__api-url",{start:e.work,finish:e.home,from:"notif"},n),gowork:home.view("route__api-url",{start:e.home,finish:e.work,from:"notif"},n)},this.delMod("confirm-promo"),this.setMod("updating","yes"),this._changeDirectionTo(this._getDirection()).then(function(){this.delMod("updating")}.bind(this)),this._saveState("")},_saveState:function(t){var e=this.params["user-points"];e.promoMode!==t&&""!==e.promoMode&&(e.csl&&((new Image).src=e.csl+"&empty=1&exdp="+t),e.promoMode=t)}},{_getWorkEnd:function(){var t=home.now();return new Date(t.getFullYear(),t.getMonth(),t.getDate(),15).getTime()},_getHomeEnd:function(){var t=home.now();return t.getHours()<3?new Date(t.getFullYear(),t.getMonth(),t.getDate(),3).getTime():new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,3).getTime()},_getRouterDataOrCachedRawData:function(t){var e=this,i=e.cache[t];if(i&&i.timestamp>home.now().getTime())return $.when(JSON.parse(i.data));return $.ajax({method:"get",url:t,cache:!1,timeout:1e4}).then(function(i){if(!i||!i.direct)return $.Deferred().reject("parseData").promise();if(!i.direct.time||i.bypass&&!i.bypass.time)return $.Deferred().reject("zeroResponse").promise();var n=i.bypass&&i.bypass.timeText;return i.isBlocked||i.direct.timeText||n?(e.cache[t]={data:JSON.stringify(i),timestamp:home.now().getTime()+3e5},i):$.Deferred().reject("parseData").promise()},function(e,i,n){return home.error.logAjaxError({block:"desk-notif-card",message:"notif-card._getRouterDataOrCahedRawData: ajax",url:t,source:"geohelper/router"},e,i,n),$.Deferred().reject("getData").promise()})},cache:{}}),BEM.DOM.decl({block:"desk-notif-card",modName:"domik",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._initMailCountUpdate()}},_initMailCountUpdate:function(){this.params.uid&&this.channel("mail").on("update",function(t,e){this.params.uid===e.uid&&this._updateMailCounter(t,e)}.bind(this))},_updateMailCounter:function(t,e){this.elem("mail-count").text(e.value||home.l10n("desktopNotifications.mail.empty"))}}),BEM.DOM.decl({name:"desk-notif-card",modName:"zen",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments);var t=$(".infinity-zen");if(t.length){var e=$(".zen-lib");if(e.length){var i=e.bem("zen-lib");i.on("promoCards",function(t,e){this._showZenCard(this._choosePromoCard(e)),BEM.channel("navi").trigger("loaded",{name:"zen",item:this.domElem})},this),i.on("error",function(){BEM.channel("navi").trigger("failed",{name:"zen",item:this.domElem})}),t.bem("infinity-zen").forceLoad()}}}},_choosePromoCard:function(t){if(this.params.norotation)return t[0];var e=t[0]&&t[0].id,i=home.localStorage.getItem("home:zen:promo-pack-id"),n=e===i?Number(home.localStorage.getItem("home:zen:promo-show-count"))+1:0,s=n%t.length;return home.localStorage.setItem("home:zen:promo-show-count",n),e!==i&&home.localStorage.setItem("home:zen:promo-pack-id",e),t[s]},_showZenCard:function(t){if(t){var e="notifications.zen.card";this.elem("card").append(home.view("desk-notif-card__zen-layout",{domainTitle:home.htmlFilter(t.domainTitle),title:home.htmlFilter(t.title)})),this.bindTo("card","pointerclick",function(i){t.sendPreviewClick();var n=0!==t.rowIndex?window.innerHeight/2-t.container.scrollHeight/2:75,s=$(".media-grid").bem("media-grid");s.hasMod("collapsed","yes")&&s.delMod("collapsed"),t.scrollTo({animate:!0,highlight:!0,offsetTop:n}),home.stat.logPath("click",e),i.preventDefault()}),this._showClientCard(!0),t.sendPreviewShow(),home.stat.logPath("show",e)}}}),BEM.DOM.decl({block:"desk-notif-card",modName:"promo",modVal:"yes"},{onSetMod:{js:function(){if(this.__base.apply(this,arguments),this.params.scroll){if(!$("."+this.params.scroll).length)return void home.error.logError({block:"desk-notif-card_promo_yes",message:"Block not found"});this.bindTo("link","click",this._onClick),this.bindKeyTo("link","space enter",this._onClick),this.params.doScroll&&this._scroll()}}},_onClick:function(t){this._scroll(),t.preventDefault()},_scroll:function(){var t=$("."+this.params.scroll),e=$(".media-grid"),i=e.bem("media-grid");t.closest(e).length&&i.hasMod("collapsed")&&i.delMod("collapsed"),$("html,body").stop().animate({scrollTop:t.offset().top-40},"slow")}}),BEM.DOM.decl({block:"desk-notif-card",modName:"district",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("district-detail"),4,"desk-notif-card_district_yes")}}}),BEM.DOM.decl({block:"desk-notif-card",modName:"stream",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("stream-text"),2,"desk-notif-card_stream_yes"),BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("stream-status-inner"),1,"desk-notif-card_stream_yes"),BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("stream-title"),this.params.line_count,"desk-notif-card__stream-title"),BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("stream-reference"),2,"desk-notif-card__stream-reference")}}}),BEM.DOM.decl({block:"desk-notif-card",modName:"etrains",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.isWidgetMode&&(this._widget=$(".widget_name_etrains").bem("widget"),this.params.isClientCard&&this._initClientSchedule(),this._bindWidgetEvents())}},_bindWidgetEvents:function(){this.bindToWin("widgetSettingsTuned",this._onWidgetTuned),this.bindToWin("widgetSettingsDropped",this._onWidgetDropped)},_onAction:function(t){"setup"===t&&this.params.isWidgetMode?this._showWidgetPreferences():this.__base.apply(this,arguments)},_onWidgetTuned:function(t,e){t.id===this._widget.getId()&&e&&"save"===e.state&&window.location.reload()},_onWidgetDropped:function(t){t.id===this._widget.getId()&&window.location.reload()},_showWidgetPreferences:function(){$(".b-wdgt-preferences").bem("b-wdgt-preferences").show(this._widget)},_initClientSchedule:function(){var t=this._widget.getInstance(),e=this.params;if(t&&e.widgetHost){var i=e.widgetHost+"widgets/suburban/next_trains",n={locale:BEM.blocks["i-global"].param("locale")};["rasp_to","rasp_direction","rasp_from","minutes_forward","minutes_backward","n"].forEach(function(e){var i=t.getValue(e);i&&(n[e]=i)}),$.ajax({url:i,data:n,context:this,dataType:"jsonp",success:this._onSuccess,error:this._onError})}},_onError:function(t,e,i){home.error.logAjaxError({block:"desk-notif-card",message:"desk-notif-card__etrains._initClientSchedule: ajax",source:"widget_store"},t,e,i),this._drawingFailed()},_onSuccess:function(t){if(t.routes_forward&&t.routes_forward.length||t.routes_backward&&t.routes_backward.length)if(t){var e=home.view("desk-notif-card__etrains-title-content",{from:t.from.name,to:t.to.name}),i=home.view("desk-notif-card__etrains-schedule",{from:t.routes_forward,to:t.routes_backward,host:this.params.host});this.elem("etrains-placeholder").append(e,i),BEM.channel("navi").trigger("loaded",{name:"etrains",item:this.domElem}),this._showClientCard(!0),home.stat.logDOMShow(this.domElem)}else this._drawingFailed();else this._drawingFailed()},_drawingFailed:function(){BEM.channel("navi").trigger("failed",{name:"etrains",item:this.domElem})},_switchDirection:function(t){t.preventDefault(),this.toggleMod("direction","reverse"),this._updateWrapperHeight()},_updateWrapperHeight:function(){var t=this.elem("etrains-list-from").height(),e=this.elem("etrains-list-to").height();if(t!==e){var i=Math.max(t,e);this.elem("etrains-list-wrapper").height(i)}}}),BEM.DOM.decl("navi",{onSetMod:{js:function(){this._items=this.elem("item"),this._downVisibleItemsCount=this.params.visibleItemsCount,this._upVisibleItemsCount=0,this._curVisibleItemsCount=this._downVisibleItemsCount,this._upStep=0,this._downStep=this._downVisibleItemsCount,this._firstItemIdx=-1,this._lastItemIdx=this._downVisibleItemsCount,this._asyncItems=this.params.asyncItems,this._topHeight=0,this._hideBottomItems(),this._updateContentHeight(),this._initBlockHeight(),this._bindEvents();var t=this.params.options;t&&!t.hasAsyncItems&&(this.delMod(this._items,"disabled"),this.delMod(this.elem("container-wrapper"),"pointer"),this._updateSteps(),this._updateContentHeight(),this.channel("navi").trigger("ready")),this.bindTo("container-wrapper","scroll",function(t){t.target.scrollTop&&(t.target.scrollTop=0,this._onClickDownward())}.bind(this))}},onElemSetMod:{upward:{disabled:{yes:function(t){t.attr("tabindex","-1"),this._tryDeleteNavigation()},"":function(t){t.attr("tabindex","0")}}},downward:{disabled:{yes:function(t){t.attr("tabindex","-1"),this._tryDeleteNavigation()},"":function(t){t.attr("tabindex","0")}}},shadow:{hidden:{yes:function(){this.elem("tools").css("margin-top","-12px")},"":function(){this.elem("tools").removeAttr("style")}}}},transitionDuration:500,_bindEvents:function(){var t=this.params.options;t&&(t.closable&&this.channel("navi").on("closed",this._onItemClosed,this),t.resizable&&this.channel("navi").on("height-change",function(t,e){clearTimeout(this._updateHeightTimeout),this._updateHeightTimeout=setTimeout(function(){this._updateContentHeight(),this._updateShadowHeight({delay:0})}.bind(this),e.delay)},this),t.collapsible&&this.channel("navi").on("collapse",this._onCollapsing,this),t.hasAsyncItems&&(this._asyncItemsStatus="loading",this.channel("navi").on("loaded",this._onLoadAsyncItem,this),this.channel("navi").on("failed",this._onFailedAsyncItem,this)),t.hasOnePageItems&&this.channel("navi").on("one-page",this._onOnePage,this))},_onOnePage:function(t,e){var i=(e=e||{}).item.closest(".navi__item"),n=0;if("done"!==this._asyncItemsStatus&&(this._updateShadowHeight(),this._updateStatus(),this.delMod(this.elem("tools"),"hidden"),this.delMod(this.elem("shadow"),"hidden"),this._asyncItemsStatus="hide-loading"),e.show){this.transitionDuration=150,this._hideBottomItems();var s=i.index(),o=this._items;this.setMod(o,"disabled","yes"),this.delMod(i,"disabled"),o.each(function(t,e){t>this._firstItemIdx&&t<s&&(n-=e.offsetHeight)}.bind(this)),this.onePageParams={firstItemIdx:this._firstItemIdx,lastItemIdx:this._lastItemIdx},this._lastItemIdx=s+1,setTimeout(function(){this._setContainerHeight(i.height()),this._updateShadowHeight(),this._updateStatus()}.bind(this),this.transitionDuration+1),this._scroll(n)}else this._undoOnePage()},_undoOnePage:function(){this.transitionDuration=500,this.delMod(this._items,"disabled"),this._firstItemIdx=this.onePageParams.firstItemIdx,this._lastItemIdx=this.onePageParams.lastItemIdx,this._scroll(0),this.onePageParams=null,this._updateContentHeight(),this._unhideContainerItems(),this._updateShadowHeight(),this._updateStatus()},_onCollapsing:function(){this.delMod(this.elem("container-wrapper"),"animation"),this._updateContentHeight(),this._initBlockHeight(),this._updateSteps(),this.setMod(this.elem("container-wrapper"),"animation","yes")},_initBlockHeight:function(){var t=this.elem("tools")[0].offsetHeight,e=this.elem("container-wrapper");if(this._maxContainerHeight=e.height(),this.setMod(e,"animation","yes"),this.params&&this.params.options&&this.params.options.hasAsyncItems){var i=this._maxContainerHeight+t,n=Math.max(this.params.minContainerHeight+t,i);this.elem("layout").css("height",n+"px")}},_onItemClosed:function(t,e){var i=(e=e||{}).item.closest(".navi__item");if(-1===this._firstItemIdx&&this._curVisibleItemsCount>=this._items.length)return setTimeout(this._removeItem.bind(this,i),400);this._minimizeShadow(),this._items.splice(i.index(),1),this._tryToFillContainer(),setTimeout(function(){if(i.remove(),this.dropElemCache("item"),!this._items.length)return this.destruct();this._firstItemIdx===this._lastItemIdx-1&&this._onClickUpward(),this._updateContentHeight(),this._unhideContainerItems()}.bind(this),400)},_tryToFillContainer:function(){var t=0,e=this._lastItemIdx;this._lastItemIdx=this._items.length;for(var i=this._firstItemIdx+1;i<this._items.length;i++){var n=this._items[i];if((t+=n.offsetHeight)>this._maxContainerHeight){this._lastItemIdx=i;break}i>=e-1&&this.delMod($(n),"hide")}this._curVisibleItemsCount=this._lastItemIdx-this._firstItemIdx-1,this._update(),this._updateMods({setElem:0===this._downStep&&this._directions.DOWNWARD,delElem:-1!==this._firstItemIdx&&this._directions.UPWARD,modName:"disabled"})},_doneAsyncLoading:function(){this._items.length>this._curVisibleItemsCount&&(this._updateShadowHeight(),this._updateStatus(),this.delMod(this.elem("tools"),"hidden"),this.delMod(this.elem("shadow"),"hidden")),setTimeout(function(){this.delMod(this._items,"disabled"),this._updateSteps(),this.channel("navi").trigger("ready")}.bind(this),250)},_update:function(){this._updateContentHeight(),this._updateSteps(),this._updateShadowHeight(),this._updateStatus()},_onLoadAsyncItem:function(t,e){var i=(e=e||{}).name,n=e.item;if(this._asyncItems[i]){var s=n.closest(".navi__item");s.removeAttr("style"),this._updateContentHeight(),this.delMod(s,"async"),delete this._asyncItems[i]}"hide-loading"!==this._asyncItemsStatus&&(this._updateContentHeight(),this._tryDoneAsyncLoading())},_onFailedAsyncItem:function(t,e){e=e||{},this.delMod(this._items,"disabled"),this._removeAsyncItem(e.item,e.name),"hide-loading"!==this._asyncItemsStatus&&(this._tryToFillContainer(),this._updateContentHeight(),this._tryDoneAsyncLoading())},_tryDoneAsyncLoading:function(){$.isEmptyObject(this._asyncItems||{})&&(this._doneAsyncLoading(),this._unbindAsyncEvents(),this._asyncItemsStatus="done")},_unbindAsyncEvents:function(){this.channel("navi").un("loaded",this._onLoadAsyncItem,this),this.channel("navi").un("failed",this._onFailedAsyncItem,this)},_removeItem:function(t){var e=t.index();if(t.remove(),this._items.splice(e,1),this.dropElemCache("item"),!this._items.length)return this.destruct()},_removeAsyncItem:function(t,e){var i=this._asyncItems[e],n=t.closest(".navi__item");this._removeItem(n),i&&delete this._asyncItems[e]},_hideBottomItems:function(){clearTimeout(this.hideBottomItemsTimeout),this.hideBottomItemsTimeout=setTimeout(function(){this._items.each(function(t,e){t>this._lastItemIdx-1&&(this.delMod($(e),"animation"),this.setMod($(e),"hide","yes"))}.bind(this))}.bind(this),this.transitionDuration)},_unhideContainerItems:function(){this._items.each(function(t,e){t>this._firstItemIdx&&t<this._lastItemIdx&&this.delMod($(e),"hide")}.bind(this))},_onClickDownward:function(){if(!this.hasMod(this.elem("downward"),"disabled","yes")){this.params.options.hasOnePageItems&&BEM.channel("navi").trigger("scroll",{direction:this._directions.DOWNWARD}),this._tempDisablePointerEvents();var t=this._items,e=this._downStep;t.each(function(t,i){t>this._firstItemIdx&&t<=this._firstItemIdx+e&&(this._topHeight-=i.offsetHeight,this.setMod($(i),"animation","yes"),this.setMod($(i),"hide","yes"))}.bind(this)),this._firstItemIdx+=e,this._lastItemIdx=Math.min(this._firstItemIdx+this._downVisibleItemsCount+1,t.length),this._curVisibleItemsCount=this._downVisibleItemsCount,this._hideBottomItems(),this._unhideContainerItems(),this._update(),this._updateMods({setElem:0===this._downStep&&this._directions.DOWNWARD,delElem:-1!==this._firstItemIdx&&this._directions.UPWARD,modName:"disabled"}),this._scroll(this._topHeight)}},_onClickUpward:function(){if(!this.hasMod(this.elem("upward"),"disabled","yes")){this.params.options.hasOnePageItems&&BEM.channel("navi").trigger("scroll",{direction:this._directions.UPWARD}),this._tempDisablePointerEvents();var t=this._items,e=this._upStep;this._firstItemIdx=Math.max(-1,this._firstItemIdx-e),this._lastItemIdx=Math.min(this._firstItemIdx+this._upVisibleItemsCount+1,t.length),t.each(function(t,e){0!==this._topHeight&&t>this._firstItemIdx&&t<this._lastItemIdx&&(this._topHeight+=e.offsetHeight,this.delMod($(e),"hide","yes"))}.bind(this)),this._curVisibleItemsCount=this._upVisibleItemsCount,this._unhideContainerItems(),this._hideBottomItems(),this._update();var i=this._lastItemIdx!==this._items.length;i&&(this.delMod(this.elem("shadow"),"hidden"),this.delMod(this.elem("status"),"hide")),this._updateMods({setElem:0===this._upStep&&this._directions.UPWARD,delElem:i&&this._directions.DOWNWARD,modName:"disabled"}),this._scroll(this._topHeight)}},_scroll:function(t){this.elem("container").css("transform","translateY("+t+"px)")},_scrollToEnd:function(){for(;this._lastItemIdx<this._items.length;)this._onClickDownward()},_scrollToTop:function(){for(;this._firstItemIdx>-1;)this._onClickUpward()},_tryDeleteNavigation:function(){-1===this._firstItemIdx&&this._curVisibleItemsCount>=this._items.length&&(this.elem("navigation").remove(),this.dropElemCache("navigation"))},_updateSteps:function(){this._calculateDownwardSteps(),this._calculateUpwardSteps()},_calculateDownwardSteps:function(){this._downStep=0;var t,e=0,i=this._items,n=i.length,s=0,o=1,r=this._lastItemIdx,a=n,c=this._curVisibleItemsCount;for(t=r;t*o<a;t+=o){var l=e+i[t].offsetHeight;if(l>this._maxContainerHeight&&o<0)break;l>this._maxContainerHeight&&o>0?(o=-1,t=r,a=0):(t===i.length-1&&(o=-1,t=r,this._downStep++,c++,a=0),o<0&&c--,s++,e=l,this._downStep+=Math.max(o,0))}0!==this._downStep&&(this._downStep=c,this._downVisibleItemsCount=s)},_calculateUpwardSteps:function(){this._upStep=0;for(var t=this._items,e=t.length,i=this._firstItemIdx,n=1,s=0,o=-1,r=0,a=i;a*o<n;a+=o){var c=s+t[a].offsetHeight;if(c>this._maxContainerHeight)break;c>this._maxContainerHeight&&o<0?(o=1,a=i,n=e):(0===a&&(o=1,a=i,this._upStep++,n=e),r++,s=c,this._upStep-=Math.min(o,0))}0!==this._upStep&&(this._upVisibleItemsCount=r)},_updateStatus:function(){this.elem("more-count").text(this._items.length-this._lastItemIdx),0===this._downStep&&this.setMod(this.elem("status"),"hide","yes")},_updateMods:function(t){var e=(t=t||{}).setElem,i=t.delElem,n=t.modName,s=t.modVal||"yes";e&&this.setMod(this.elem(e),n,s),i&&this.hasMod(this.elem(i),n,s)&&this.delMod(this.elem(i),n)},_updateContentHeight:function(){for(var t=0,e=this._firstItemIdx+1;e<this._lastItemIdx;e++)t+=this._items[e].offsetHeight;this._setContainerHeight(t)},_setContainerHeight:function(t){this.elem("container-wrapper").css("height",t)},_updateShadowHeight:function(t){var e=(t=t||{delay:300}).delay;if(0!==this._items.length){var i,n=this._items[this._lastItemIdx-1],s=$(n),o=this.elem("shadow-item"),r=this.elem("shadow-decor"),a=s.find(".desk-notif-card__card"),c=a&&a[0]&&a[0].offsetHeight;n.offsetHeight<64?this.setMod(o,"size","small"):this.hasMod(o,"size","small")&&this.delMod(o,"size"),i=c||n.offsetHeight-10,setTimeout(function(){o.css("height",i),r.removeAttr("style")},e),0===this._downStep&&this.setMod(this.elem("shadow"),"hidden","yes")}},_minimizeShadow:function(){this._lastItemIdx!==this._items.length&&(this.elem("shadow-item").css("height","8px"),this.elem("shadow-decor").css("visibility","hidden"))},_tempDisablePointerEvents:function(){var t=this.elem("container-wrapper");this.setMod(t,"pointer","yes"),setTimeout(this.delMod.bind(this,t,"pointer"),this.transitionDuration)},_directions:{UPWARD:"upward",DOWNWARD:"downward"}},{live:function(){this.liveBindTo("downward status","pointerclick",function(){this._onClickDownward()}),this.liveBindTo("upward","pointerclick",function(){this._onClickUpward()}),this.liveBindKey("downward","space enter",function(t){t.preventDefault(),this._onClickDownward()}),this.liveBindKey("upward","space enter",function(t){t.preventDefault(),this._onClickUpward()}),this.liveBindTo("item","focusin",function(t){var e=t.data.domElem.closest(".navi__item").index();e===this._firstItemIdx?this._onClickUpward():e===this._items.length-1?this._scrollToEnd():0===e&&this._scrollToTop()})}}),BEM.DOM.decl("dist-popup",{onSetMod:{js:function(){this.__base(),setTimeout(function(){BEM.blocks["i-message-locker"].acquireLock("dist-popup",this._hide.bind(this)).then(this._onShow.bind(this),this.destruct.bind(this))}.bind(this),this.__self.SHOW_TIMEOUT)}},_getPopupPosition:function(){return{top:12,left:18}},_bindEvents:function(){this.bindTo("no close","click",this._onNoClick),this.bindKeyTo("close","space enter",this._onNoClick),this.bindTo("yes","click",this._onYesClick)},_onShow:function(){var t=this.params,e=t.counters,i=detector.isSVGSupported()&&t.icons.icon_svg||t.icons.icon;this.elem("image-wrapper").prepend(home.view("dist-popup__image",{image:i})),this.popup=this.findBlockOn("popup").show(this._getPopupPosition()),this.popup.on({"before-hide":this._onBeforeHide,hide:this._onHide},this),this.popup._unbindFocusEvents(),home.getData("common.reportVisibilityCheck")?BEM.blocks["i-visibilitychange"].waitForVisible(function(){this._sendCounter(e.show)}.bind(this)):this._sendCounter(e.show),this._bindEvents()},_onBeforeHide:function(t,e){e&&"esc-key"===e.source&&this.afterCurrentEvent(this._countCancel)},_onHide:function(){BEM.blocks["i-message-locker"].releaseLock("dist-popup"),setTimeout(this.destruct.bind(this),this.__self.DESTRUCT_TIMEOUT)},_onYesClick:function(){this._closeFlag(this.params.close_url),this.params.yaCounterId&&(BEM.blocks["i-metrika"].add({id:this.params.yaCounterId,triggerEvent:!0}),this.params.bannerid&&BEM.blocks["i-bannerid"].save(this.params.bannerid))},_onNoClick:function(){return this.popup.hide(),this._countCancel(),!1},_hide:function(){this.popup.hide()},_countCancel:function(){this._closeFlag(this.params.close_url),this._closeFlag(this.params.quarantineUrl),this._sendCounter(this.params.counters.no),window.home.gaCounter.trackCancelPopup()},_closeFlag:function(t){t&&((new Image).src=t)},_sendCounter:function(t){t&&t.length&&t.forEach(function(t){"path"===t.type?csh_ifmsid(t.content):"image"===t.type&&((new Image).src=t.content)})},destruct:function(){return this.popup&&this.popup.destruct(),this.__base.apply(this,arguments)}},{SHOW_TIMEOUT:1e3,DESTRUCT_TIMEOUT:1e3}),BEM.DOM.decl({block:"dist-popup",modName:"install",modVal:"inline"},{_onYesClick:function(){this.__base.apply(this,arguments),this._sendCounter(this.params.counters.yes);var t=this,e=this.params;return this._inlineInstall||(this._inlineInstall=BEM.create({block:"i-inline-install",mods:{api:e.api}},$.extend(e,{callbacks:{yes:function(){this._sendCounter(e.counters.install),this.popup.hide()}.bind(this),no:function(){this.popup.hide()}.bind(this)}}))),this._inlineInstall.request().fail(function(){t.popup.hide()}),!1}}),BEM.DOM.decl({block:"dist-popup",modName:"install",modVal:"download"},{_onYesClick:function(){return this.__base.apply(this,arguments),this._sendCounter(this.params.counters.yes),this._downloadInstance||(this._downloadInstance=BEM.create("i-install-download",this.params)),this._downloadInstance.download(),this._hide(),!1}}),BEM.DOM.decl("news-popup",{onSetMod:{js:function(){var t=this;this.popup=this.findBlockOn(this.domElem,"popup"),this.$customTabLink=$(".news__custom-tab"),this.$tab=this.$customTabLink.closest(".content-tabs__head-item"),this.news=this.findBlockOn(this.$tab.closest(".content-tabs"),"content-tabs"),this.widget=this.news.findBlockOutside("widget"),this.turnReloadOff(),this.popup.on("show",function(){home.stat.logDOMShow(t.popup.domElem)}),this.bindTo("add","click",this.add),this.bindTo("cancel","click",this.cancel),this.popup.on("hide",this.changeThis(this.hideTab)),this.show()}},show:function(){this.popup.setRelativeContainer(this.widget),this.popup.show(this.$customTabLink),this.channel("widget").on("showPreferences",this.hideOnOpenSettings,this),$(window).scrollTop(this.$tab.offset().top),this.elem("add").focus()},hide:function(){this.popup.hide()},add:function(){this.saveNewPattern(),this.saveWidgetSettings()},cancel:function(){this.hide()},hideTab:function(){var t=this.widget.getInstance();this.actualData||t._prefs.customCatId||(this.news.hasMod(this.$tab,"active","true")&&this.news.selectRelative(-1),this.$tab.hide()),this.turnReloadOn()},hideOnOpenSettings:function(t,e){e.elem.instance===this.widget.getInstance()&&this.hide()},saveNewPattern:function(){var t=this.widget.findBlockOutside("widgets");t.params.settings&&t.params.settings.newpattern&&t.save()},saveWidgetSettings:function(){var t=this.widget.getInstance(),e=this.params.customId,i=t._prefs;i.customCatId=e,t.saveValues(i,this.afterSave.bind(this))},afterSave:function(t){"ok"===t.result&&((new Image).src=this.params.cookieUrl,this.actualData=!0),this.hide()},turnReloadOff:function(){this.widget.getInstance().pauseReload=!0},turnReloadOn:function(){var t=this.widget.getInstance();t.pauseReload=!1,!this.actualData&&t._prefs.customCatId?t.reload():Widget.Framework.addToReloadQueue(t,t.onload)}},{live:!1}),BEM.DOM.decl({block:"popup",modName:"type",modVal:"relative"},{setRelativeContainer:function(t){this._parentContainer=t},_findParent:function(){return this._parentContainer},setParent:function(t){return this._parent=t,this}}),function(){var t={};BEM.decl("i-request",{onSetMod:{js:{inited:function(){this._preventCache=!1}}},get:function(t,e,i,n){return $.isFunction(i)||(n=i,i=this.params.onError),this._get(t,e,i,$.extend({},this.params,n)),this},_get:function(e,i,n,s){var o=this._buildCacheKey(e,s),r=t[s.cacheGroup];s.cache&&r&&o in r.data?this.afterCurrentEvent(function(){i.call(this.params.callbackCtx,r.data[o])},this):this._do(e,i,n,s)},_do:function(t,e,i,n){},_onSuccess:function(t,e,i,n){n.cache&&!this._preventCache&&this.putToCache(n,t,i),this._preventCache=!1},_buildCacheKey:function(t,e){return"string"==typeof t?t:$.param(t)},putToCache:function(e,i,n){var s=t[e.cacheGroup]||(t[e.cacheGroup]={keys:[],data:{}});s.keys.length>=e.cacheSize&&delete s.data[s.keys.shift()];var o=this._buildCacheKey(i,e);return s.data[o]=n,s.keys.push(o),this},dropCache:function(){return delete t[this.params.cacheGroup],this},getDefaultParams:function(){return{cache:!1,cacheGroup:"default",cacheSize:100,callbackCtx:this}}},{_cache:t})}(),BEM.decl({block:"i-request_type_ajax",baseBlock:"i-request"},{onSetMod:{js:{inited:function(){this.__base(),this._requestNumber=this._number=this._preventNumber=this._retryCount=0}}},_get:function(t,e,i,n){this._number++,this._requestNumber++,this._retryCount=n.retryCount,this.__base.apply(this,arguments)},_do:function(t,e,i,n){var s=this;if(s._number>s._preventNumber){var o=arguments,r={data:n.data?$.extend({},n.data,t):t},a=s._wrapCallback(function(i,o,r){s._onSuccess(s._buildCacheKey(t,n),t,i[0],n),s._allowCallback(o,r)&&e.apply(n.callbackCtx,i)}),c=s._wrapCallback(function(t,e,r){s._allowCallback(e,r)&&(s._retryCount-- >0?setTimeout(function(){s._do.apply(s,o)},n.retryInterval):i&&i.apply(n.callbackCtx,t))});$.each(["url","dataType","timeout","type","jsonp","jsonpCallback","xhrFields"].concat(n.paramsToSettings||[]),function(t,e){r[e]=n[e]}),$.ajax(r).done(a).fail(c)}},_wrapCallback:function(t){var e=this._requestNumber,i=this._number;return function(n){null!==n&&t(arguments,e,i)}},_allowCallback:function(t,e){return e>this._preventNumber&&this._requestNumber===t},_buildCacheKey:function(t,e){return"string"==typeof t?t:this.__base(t)+e.url},abort:function(){this._preventNumber=++this._number},getDefaultParams:function(){return $.extend(this.__base(),{cache:!0,type:"GET",dataType:"jsonp",timeout:2e4,retryCount:0,retryInterval:2e3})}}),BEM.decl({name:"dataprovider-geo",baseBlock:"i-request_type_ajax"},{get:function(t,e){var i=Lego.params.locale||"ru",n=(location.host.match(/yandex\.(\w\w)$/)||["","ru"])[1].toUpperCase();return this.__base({v:9,search_type:"tune",results:15,lang:i+"_"+n,part:t,spn:[.01,.01].join()},function(t){e.call(this,t.results.filter(function(t){return t.geoid}).map(function(t){return["geo"].concat(t)}),t.meta)})}}),BEM.DOM.decl("b-wdgt-preferences",{onSetMod:{js:function(){var t=this;this.popup=this.findBlockOn(this.domElem,"popup"),this.popup.delMod("position"),this.bindTo("save","click",this.save),this.bindTo("cancel","click",this.cancel),this.bindTo("reset","click",this.reset),Widget.Init({hidePreferencesHandler:this.changeThis(function(){this.hide()})}),this.bindToWin("widgetSettingsTuned",function(e){t.widget&&e.id===t.widget.getId()&&t.widget.markChanged(!1,!0)}),this.popup.on("show",function(){this._skipReturnFocus=!0}),this.popup.on("hide",function(){this.channel("widget").trigger("hidePreferences",{elem:t.widget}),t._resetPopup()}),this.popup.on("show",function(){this.channel("widget").trigger("showPreferences",{elem:t.widget})}),this.baseTitle||(this.baseTitle=this.elem("head").text())}},show:function(t,e){this.widget=t,this.callback=e||function(){},this.setMod("loading","yes"),BEM.DOM.destruct(this.elem("form"),!0),Widget.Framework.showEditForm(t.getId(),this.elem("form"),this.changeThis(this.updateForm)),this.popup.show(this._setPopupParams()),this.bindToWin("resize",$.debounce(this.changeThis(function(){this.popup.repaint(this._setPopupParams())}),100))},hide:function(){this.widget=null,this.callback=null,this.popup.hide()},_resetPopup:function(){this.elem("head").text(this.baseTitle),this.unbindFromWin("resize")},_getPopupPos:function(){var t=this.domElem.width(),e=this.domElem.height(),i=$(window).height();return{left:($(window).width()-t)/2,top:Math.max(50,$(window).scrollTop()+(i-e)/2)}},_setPopupParams:function(){var t=this._getPopupPos();return this.popup.params.top=t.top,this.popup.params.left=t.left,t},updateForm:function(t){var e;t&&(this.delMod("loading"),t.title&&this.elem("head").text(t.title),t.form?e=t.form:t.prefs&&(e=this.buildForm(t.prefs)),e?(BEM.DOM.update(this.elem("form"),e),BEM.DOM.init(this.elem("form")),this.elem("controls").show()):this.elem("controls").hide(),this.popup.hasMod("visibility","visible")&&this.popup.repaint(this._setPopupParams()))},buildForm:function(t){return BEMHTML.apply({block:"b-wdgt-preferences",elem:"data",list:t})},save:function(){for(var t=this.elem("form").find("form")[0],e={},i=0;i<t.length;i++){var n=t[i];n.name&&("checkbox"===n.type?e[n.name]=!!n.checked:"radio"===n.type?n.checked&&(e[n.name]=n.value):e[n.name]=n.value)}this.widget.markChanged(!1,!0),this.widget.getInstance().saveValues(e,this.callback.bind(this.widget)),this.hide()},cancel:function(){this.hide()},reset:function(){this.widget.getInstance().dropValues(this.callback.bind(this.widget)),this.channel("catalog").trigger("enableAction"),this.hide()}},{live:!0}),BEM.DOM.decl({block:"popup",modName:"wrapped",modVal:"yes"},{onSetMod:{visibility:{visible:function(){this.__base(),this._wrap()},"":function(){this.__base(),this._unwrap()}},wrapped:{"":function(){this._unwrap()}}},_wrap:function(){this._wrapper||(this._wrapper=this.elem("wrapper").detach()),this._wrapper&&this.domElem.wrap(this._wrapper)},_unwrap:function(){this._wrapper&&this.domElem.unwrap()},_captureZIndex:function(){var t=this._zIndex,e=this.__base.apply(this,arguments);return this._zIndex!==t&&this.elem("wrapper").css("z-index",this._zIndex),e},destruct:function(){this._unwrap(),this.__base()}}),function(){var t={};BEM.DOM.decl({block:"popup",modName:"body-scroll",modVal:"no"},{onSetMod:{visibility:function(){return this.afterCurrentEvent(function(){this.domElem&&this.hasMod("visibility","visible")?t[this.params.uniqId]=!0:delete t[this.params.uniqId],this._manageScopeOverflow()}),this.__base()}},destruct:function(){var e=this.params.uniqId;t[e]&&(delete t[e],this._manageScopeOverflow()),this.__base.apply(this,arguments)},_enableScroll:function(){return this._scope.css({overflow:""}),this},_disableScroll:function(){return this._scope.css({overflow:"hidden"}),this},_manageScopeOverflow:function(){var e=Object.keys(t).length;0===e?this._enableScroll():1===e&&this._disableScroll()}})}(),BEM.DOM.decl({block:"popup",modName:"behaviour",modVal:"scrollable"},{getDefaultParams:function(){var t=this.__base();return t.top=20,t}}),BEM.DOM.decl("select",{onSetMod:{js:{inited:function(){this._items=[],this._curItemIndex=-1,this._scrollableElemOutsidePopup=null,this._rowHeight=22,this.on("change",this._redrawParentPopup);var t=this._getSelectedText();t&&t!==this._getButtonText()&&this.elem("control").trigger("change")}},disabled:function(t,e){this.elem("control").prop("disabled",e),this._getButton().setMod(t,e),e&&this.delMod("opened").delMod("focused")},focused:{yes:function(){if(this.hasMod("disabled"))return!1;this._useNativeControl()||this.bindTo("keydown",this._onKeyDown),this.afterCurrentEvent(function(){this.domElem&&this.trigger("focus")})},"":function(){this._useNativeControl()||this.delMod("opened").unbindFrom("keydown"),this.afterCurrentEvent(function(){this.domElem&&this.trigger("blur")})}},opened:function(t,e){this._getButton()&&this._getButton().domElem&&this._getButton().toggleMod("arrow","up","down",Boolean(e))}},isDisabled:function(){return this.hasMod("disabled","yes")},isOpened:function(){return this.hasMod("opened","yes")},open:function(){return this.setMod("opened","yes")},close:function(){return this.delMod("opened")},val:function(t,e){if(void 0===t)return this.elem("control").val();var i,n=-1;return this.findElem("option").each(function(e){this.value===t&&!this.disabled&&(!(i=$(this).parent("optgroup")[0])||!i.disabled)&&(n=e)}),n>-1&&this._selectedIndex(n,e),this},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},_selectedIndex:function(t,e){var i=this._getSelectedIndex();return void 0===t||t===i?i:(this.elem("control").prop("selectedIndex",t),this._useNativeControl()||(this._setButtonText(this._getSelectedText()),this._items[0]&&this.delMod(this._items,"selected").setMod(this._items.eq(t),"selected","yes")),this.trigger("change",$.extend({index:t,prev:i},e)),t)},setOptions:function(t){return t?(BEM.DOM.update(this.elem("control"),BEMHTML.apply($.map(t,this.__self._buildOption))),this.redraw()):this},redraw:function(){return this._popup&&this._redrawList(),this.elem("control").trigger("change"),this},_useNativeControl:function(){return null!==this.__self.useNativeControl?this.__self.useNativeControl:this.__self.useNativeControl="none"!==this.elem("control").css("display")},_redrawParentPopup:function(){var t;return this._isParentPopup()&&((t=this._popup._parent).repaint||t.redraw).call(t),this},_isParentPopup:function(){return this._popup&&this._popup._parent&&!this.hasMod("layout","fixed")},_onSelectChange:function(){this._setButtonText(this._getSelectedText()),this.trigger("change",{index:this._getSelectedIndex(),prev:-1})},_onControlFocusInOut:function(t){this._useNativeControl()&&this.toggleMod("focused","yes","","focusin"===t.type)},_onMouseDown:function(t){this._isControlFocused()&&t.preventDefault()},_onKeyDown:function(t){var e=BEM.blocks.keycodes,i=t.keyCode===e.UP,n=t.keyCode===e.DOWN,s=t.keyCode===e.ENTER,o=t.keyCode===e.SPACE;if(i||n){if(t.preventDefault(),!this.isOpened())return this.open();var r=this._items.length,a=this._curItemIndex;if(i&&0===a||n&&a>r-2)return;if(r){var c,l=n?1:-1;for(c=a;c>=0&&c<=r;)if(c+=l,this._isSelectableItem(this._items.eq(c))){a=c;break}this._onEnterItem(this._items.eq(a),!0)}}(s||o)&&this._onEnterItem(this._items.eq(this._curItemIndex),!0,!0)},_onEnterItem:function(t,e,i){this.elem("button").attr("aria-activedescendant",t.attr("id"));var n=this._curItemIndex,s=this._getItemIndex(t),o=this._items;n>-1&&this.delMod(o.eq(n),"hovered"),s>-1&&(this._curItemIndex=s,this.setMod(o.eq(s),"hovered","yes")),i&&this._selectedIndex(this._curItemIndex),e&&this._scrollToCurrent()},_onLeaveItem:function(t){var e=this._curItemIndex;e>-1&&e===this._getItemIndex(t)&&(this.delMod(this._items.eq(e),"hovered")._curItemIndex=-1)},_onSelectItem:function(t){return this._isSelectableItem(t)&&this._selectedIndex(this._curItemIndex),this.close()},_onButtonFocus:function(){this.setMod("focused","yes")},_findScrollableElemOutsidePopup:function(){if(null===this._scrollableElemOutsidePopup){var t,e=this._getPopup().domElem;do{t=(e=e.parent()).css("overflow-y")}while("scroll"!==t&&"auto"!==t&&"HTML"!==e.prop("tagName"));this._scrollableElemOutsidePopup=e}return this._scrollableElemOutsidePopup},_onButtonBlur:function(){if(this.isOpened()&&this._isPopupFocused())if(8===BEM.blocks["i-ua"].ie){var t=this._findScrollableElemOutsidePopup(),e=t.scrollTop();this._focusButton(),t.scrollTop(e)}else this._focusButton();else this.delMod("focused")},_onButtonPress:function(){this.toggleMod("opened","yes","")},_focusButton:function(){return this._getButton().setMod("focused","yes"),this},_blurButton:function(){return this._getButton().delMod("focused"),this},_isPopupFocused:function(){try{return this._getPopup().containsDomElem($(document.activeElement))}catch(t){return!1}},_getButtonText:function(){return this._getButton().elem("text").text()},_setButtonText:function(t){t.length&&(this._getButton().elem("text").text(t),BEM.blocks["i-ua"].ie<10&&this.domElem.parent().css("outline",""))},_isOutsideClicked:function(t,e){return this.containsDomElem($(e.target))},_getItemIndex:function(t){return $.inArray(t.get(0),this._items)},_getSelectedText:function(){return this.elem("control").find(":selected").text()},_getSelectedIndex:function(){return this.elem("control").prop("selectedIndex")},_isSelectableItem:function(t){return!this.hasMod(t,"disabled","yes")&&!this.hasMod(t,"label","yes")},_getButton:function(){return this._button||(this._button=this.findBlockOn("button","button"))},_getRowHeight:function(){return this.findElem(this._getPopup().domElem,"item").outerHeight()},_isControlFocused:function(){try{return this.containsDomElem($(this.__self.doc[0].activeElement))}catch(t){return!1}},destruct:function(){this._outPopup&&this._outPopup.un("outside-click"),this.delMod("opened"),this._popup&&this._popup.domElem&&BEM.DOM.destruct(this._popup.domElem),this.__base.apply(this,arguments)},getDefaultParams:function(){return{rows:15,popupMods:{direction:"down"}}}},{live:function(){this.liveBindTo("control","change",function(t){this._onSelectChange()}),this.liveBindTo("control","focusin focusout",function(t){this._onControlFocusInOut(t)}),this.liveBindTo("mousedown",function(t){this._onMouseDown(t)}),this.liveInitOnBlockInsideEvent("focus","button",function(){this._onButtonFocus()}).liveInitOnBlockInsideEvent("blur","button",function(){this._onButtonBlur()})},useNativeControl:null,_buildOption:function t(e,i,n){var s={};return"option"===e.item?(s={block:"select",elem:"option",tag:"option",attrs:{value:e.value},content:e.content},e.disabled&&(s.attrs.disabled="disabled"),e.selected&&(s.attrs.selected="selected")):"optgroup"===e.item&&(s={elem:"option-group",tag:"optgroup",attrs:{label:e.label}},e.disabled&&(s.attrs.disabled="disabled"),s.content=Array.isArray(e.content)?e.content.map(t):e.content),s.block="select",s}}),BEM.DOM.decl("select",{onElemSetMod:{item:{hovered:function(){BEM.blocks["i-ua"].opera<13&&this._popup.domElem.css("display","inline").css("display","")}}}},{live:function(){return this.liveInitOnBlockInsideEvent("press","button",function(){this._onButtonPress()}),this.__base.apply(this,arguments)}}),BEM.DOM.decl("select",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._initButton()}}},_initButton:function(){},_redrawList:function(){var t,e=this,i=this._getPopup().domElem;return BEM.DOM.update(this.findElem(i,"list"),this.__self._buildItemsHtml(this.elem("control").children())),t=this.findElem(i,"item"),this._curItemIndex=-1,this._items=t.filter(function(){return!e.hasMod($(this),"label","yes")}),this.bindTo(e._items,{pointerclick:function(t){t.preventDefault(),e._onSelectItem(t.data.domElem)},pointerover:function(t){e._onEnterItem(t.data.domElem)},pointerout:function(t){e._onLeaveItem(t.data.domElem)}}),this}},{_buildItemsHtml:function(t){var e={block:"select",elem:"separator",tag:"i"},i=[],n=[];function s(t,e,i){var n={block:"select",elem:"item",content:{elem:"text",tag:"span",content:{tag:!1,html:e}||"  "},elemMods:{}};return i&&(n.elemMods=i),n}return function t(o,r){var a=o.length;if(a){var c=0;do{var l=$(o[c]),h=l.attr("disabled")&&{disabled:"yes"};if(l.is("optgroup")){!0,!l.prev().is("optgroup")&&c>0&&i.push(e),n.push(i),(i=[]).push(s(0,l.attr("label"),$.extend({label:"yes"},h,r))),t(l.children(),$.extend({inner:"yes"},h,r));var u=i;(i=n.pop()).push({block:"select",elem:"group",content:u})}else i.push(s(0,l.html(),$.extend(h,l.is(":selected")&&{selected:"yes"},r)))}while(++c<a||!1)}}(t),BEMHTML.apply(i)}}),BEM.DOM.decl("select",{onSetMod:{opened:{yes:function(){if(this.hasMod("disabled"))return!1;this._drawPopup();var t=this.findElem(this._popup.domElem,"item","selected","yes");this.elem("button").attr({"aria-activedescendant":t.attr("id"),"aria-expanded":!0})},"":function(){this.elem("button").attr("aria-expanded",!1).removeAttr("aria-activedescendant"),this._getPopup().hide()}}},_getPopupContent:function(t){return{block:t,elem:"list"}},_getPopupMix:function(t){return{block:t,elem:"popup",elemMods:{}}},_getPopup:function(){if(this._popup)return this._popup;var t=this,e=t.params,i=t.__self.getName(),n=this._getPopupContent(i),s=this._getPopupMix(i),o={animate:"no"},r={directions:[{to:"bottom",axis:"left",offset:{top:8}},{to:"top",axis:"left",offset:{bottom:8}}]};["size","layout","theme","width"].forEach(function(e){t.hasMod(e)&&(s.elemMods[e]=t.getMod(e))}),$.extend(s.elemMods,e.elemPopupMods),$.extend(o,e.popupMods),$.extend(r,e.popupParams);var a=$(BEMHTML.apply({block:"popup",mods:o,mix:s,js:r,content:{elem:"content",content:n}}));return this._popup=this.findBlockOn(a,"popup"),this._popup.on({show:function(){t._curItemIndex=t._getSelectedIndex();var e=t._items.eq(t._curItemIndex);t.delMod(t._items,"selected").setMod(e,"hovered","yes").setMod(e,"selected","yes")},"outside-click":function(e,i){t._isOutsideClicked(e,i)?e.preventDefault():t._blurButton()},hide:function(){t.delMod("opened").delMod(t._items,"hovered").delMod(t.findElem(t._popup.domElem,"popup"),"scrollable")}}).bindTo("mousedown",function(t){t.preventDefault()}),BEM.DOM.append(BEM.DOM.scope,t._popup.domElem),t._redrawList(),t._outPopup=t.findBlockOutside("button","popup"),t._outPopup&&t._outPopup.on("outside-click",function(e,i){t._popup.containsDomElem($(i.target))&&e.preventDefault()}),t._popup},_calcPopupDimensions:function(){this._popupContent||(this._popupContent=this._getPopup().findBlockInside("popup").elem("content"));var t=parseInt(this.params.rows,10),e=this._getPopup();if(t&&this.findElem(this._popupContent,"item").size()>t){this._rowHeight=this._getRowHeight();var i=parseInt(e.domElem.css("height"),10),n=t*this._rowHeight;i!==n&&(e.setSize({height:n}),i>n&&this.setMod(this.findElem(e.domElem,"popup"),"scrollable","yes"))}else e.setSize({height:"auto"})},_drawPopup:function(){var t=this.findBlockInside("select");this._getPopup().show(t),this._calcPopupDimensions(),this._scrollToCurrent()},_scrollToCurrent:function(){if(this._popupContent&&!(this._curItemIndex<0)){var t,e=this._items.eq(this._curItemIndex).get(0).offsetTop,i=this._popupContent,n=i.scrollTop(),s=e-n,o=2*this._rowHeight;s>i.height()-o?t=e-o:n&&s<o&&(t=e-i.height()+o),t&&i.scrollTop(t)}}},{SHADOW_OFFSET:1}),BEM.DOM.decl({block:"checkbox",baseBlock:"control"},{onSetMod:{js:{inited:function(){var t=this.elem("control");this.toggleMod("checked","yes",t.prop("checked")),this.toggleMod("focused","yes",t.isFocused())}},hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},checked:function(t,e){this.elem("control").prop("checked",e),this.trigger("change",{checked:Boolean(e)})},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered").delMod("pressed")}}},isDisabled:function(){return this.hasMod("disabled","yes")},isChecked:function(){return Boolean(this.elem("control").prop("checked"))},toggle:function(){this.toggleMod("checked","yes")},val:function(t){var e=this.elem("control");return void 0===t?e.val():(e.val(t),this)},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},_onChange:function(t){this.toggleMod("checked","yes",t.target.checked)},_onPointerenter:function(t){this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onClick:function(t){var e=this.elem("label"),i=t.target;this.domElem[0]===i&&this._onChange(t),i!==e[0]&&this.trigger("click",{domEvent:t}),this.setMod("focused","yes")},_onKeydown:function(t){t.keyCode===BEM.blocks.keycodes.SPACE&&this.setMod("pressed","yes")},_onKeyup:function(t){t.keyCode===BEM.blocks.keycodes.SPACE&&this.delMod("pressed")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.isDisabled()||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("pointerclick",function(t){this.hasMod("disabled")||this._onClick(t)}).liveBindTo("control","keydown",function(t){this.hasMod("disabled")||this._onKeydown(t)}).liveBindTo("control","keyup",function(t){this.hasMod("disabled")||this._onKeyup(t)}).liveBindTo("control","change",function(t){this._onChange(t)}),this.__base()}}),function(){"use strict";BEM.DOM.decl("checkbox",{onSetMod:{js:function(){this.__base(),this.params.stat&&this.on("change",function(){home.stat.logPath("click",this.params.stat)})}}},{live:function(){return this.__base.apply(this,arguments),this.liveBindTo("click",function(t){$(t.target).hasClass("checkbox")&&this.toggle()}),!1}})}(),BEM.DOM.decl("radiobox",{onSetMod:{js:{inited:function(){this._val=this.findElem(this.elem("radio","checked","yes"),"control").val(),this.elem("control").each(function(t,e){var i=$(e),n=this.__self._getRadioByElem(i);i.isFocused()&&this.setMod(n,"focused","yes"),i.prop("checked")&&this.setMod(n,"checked","yes")}.bind(this))}},disabled:{yes:function(){this.setMod(this.elem("radio"),"disabled","yes")},"":function(){this.delMod(this.elem("radio"),"disabled")}}},onElemSetMod:{radio:{focused:{yes:function(t){this.delMod(this.elem("radio","focused","yes"),"focused");var e=this.findElem(t,"control");e.isFocused()||e.focus(),this.afterCurrentEvent(function(){this.domElem&&this.trigger("focus",{current:t})})},"":function(t){this.afterCurrentEvent(function(){this.domElem&&this.trigger("blur",{prev:t})})}},checked:{yes:function(t){var e=this.elem("radio","checked","yes"),i=this.findElem(t,"control"),n=this._val;this._willSwitch=!0,this.delMod(e,"checked"),this._willSwitch=!1,i.prop("checked",!0),this._val=i.val(),this.trigger("change",{current:t,currentVal:this._val,prev:e,prevVal:n})},"":function(t){var e=this.findElem(t,"control"),i=this._val;e.prop("checked",!1),this._val=void 0,this._willSwitch||this.trigger("change",{current:$(),currentVal:void 0,prev:t,prevVal:i})}},hovered:function(t){return!this.isDisabled(t)},pressed:function(t){return!this.isDisabled(t)},disabled:function(t,e,i){t.find(this.buildSelector("control")).prop("disabled",i),i&&this.delMod(t,"hovered").delMod(t,"pressed")}}},isDisabled:function(t){return this.hasMod(t,"disabled","yes")},val:function(t){if(void 0===t)return this._val;var e=this;return this.elem("control").each(function(i,n){if(n.value===t)return e.setMod(e.__self._getRadioByElem($(n)),"checked","yes"),!1}),e},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},getCurrent:function(){return this.findElem("radio","checked","yes")},uncheckAll:function(){return this.delMod(this.elem("radio","checked","yes"),"checked"),this},_onRadioEnter:function(t){this.setMod(t.data.domElem,"hovered","yes")},_onRadioLeave:function(t){this.delMod(t.data.domElem,"hovered")},_onRadioClick:function(t,e){this.isDisabled(t)||this.setMod(t,"focused","yes")},_onChange:function(t){this.setMod(this.__self._getRadioByElem(t.data.domElem),"checked","yes")},_onPointerpress:function(t){var e=t.data.domElem;this.setMod(e,"pressed","yes").bindToDoc("pointerrelease",function(){this.delMod(e,"pressed").unbindFromDoc("pointerrelease")})}},{live:function(){this.liveBindTo("radio","pointerclick",function(t){this._onRadioClick(t.data.domElem,t)}).liveBindTo("control","change",function(t){this._onChange(t)}).liveBindTo("radio","pointerover pointerout",function(t){t.data.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onRadioEnter(t):this._onRadioLeave(t))}).liveBindTo("control","focusin focusout",function(t){var e=this.__self._getRadioByElem(t.data.domElem);this.setMod(e,"focused","focusin"===t.type?"yes":""),parseInt(BEM.blocks["i-ua"].ios,10)>=8&&t.preventDefault()}).liveBindTo("radio","pointerpress",function(t){this.hasMod(t.data.domElem,"disabled")||this._onPointerpress(t)})},_getRadioByElem:function(t){return t.closest(this.buildSelector("radio"))}}),BEM.DOM.decl({block:"radio-button",baseBlock:"radiobox"},{onElemSetMod:{radio:{pressed:{yes:function(){this.delMod(this.elem("radio","pressed","yes"),"pressed")}}}},_onPointerPress:function(t){this._pressedRadio=t.data.domElem,this.isDisabled(this._pressedRadio)||(this.setMod(this._pressedRadio,"pressed","yes"),this.bindToDoc("pointerrelease",this._onPointerRelease))},_onPointerRelease:function(t){var e=this._pressedRadio;delete this._pressedRadio,this.delMod(e,"pressed"),this.afterCurrentEvent(function(){if(this.domElem){var i=this.findElem(e,"control");i.prop("checked")||!e.is(t.target)&&!e.find(t.target).length||i.trigger("change").focus()}}),this.unbindFromDoc("pointerrelease")}},{live:function(){return this.liveBindTo("radio","pointerpress",function(t){this._onPointerPress(t)}),this.__base()}}),BEM.DOM.decl("b-autocomplete-item",{val:function(){return this.params.val||this.elem("text").text()||this.domElem.text()},enter:function(){},select:function(t){},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")}},{live:function(){this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)})},highlight:function(t,e){if(!$.isArray(e))return t;var i,n=[],s=0,o=e.sort(function(t,e){return t[0]-e[0]}),r=[],a=-1!==t.indexOf("?"),c=function(t){if(a)return t;for(;-1!==t.indexOf("?")&&r.length;)t=t.replace("?",r[0]),r.shift();return t};return!a&&function(){for(var e,i=/\&(#\d+|#x[a-f\d]+|\w+);/gi;e=i.exec(t);)r.push(e[0]),t=t.replace(e[0],"?")}(),o.forEach(function(e){i=s>e[0]?s:e[0],n.push({tag:"span",elem:"span",content:c(t.slice(s,i))}),n.push({tag:"em",elem:"em",content:c(t.slice(i,s=e[1]))})},this),n.push({tag:"span",elem:"span",content:c(t.slice(s))}),n}}),BEM.DOM.decl("b-autocomplete-item",{},{live:function(){return this.liveBindTo("mouseover mouseout mousedown mouseup pointerover pointerout pointerdown pointerup",function(t){this.trigger(t.type)}),this.__base()}}),BEM.HTML.decl("b-autocomplete-item",{onBlock:function(t){var e=t.param("data"),i=BEM.blocks["i-common__string"].escapeHTML($.isArray(e)?e[1]:e);$.isArray(t.param("search_cgi"))&&t.js({cgi:t.param("search_cgi")}),t.tag("li").mod("pers",!!t.param("pers")&&"yes").content(BEM.blocks["b-autocomplete-item"].highlight(i,t.param("hl"))).js(!0)}}),BEM.DOM.decl({block:"b-autocomplete-item",modName:"type",modVal:"geo"},{val:function(){return this.elem("reg").text()},enter:function(){},select:function(t){$(".input__geo").val(this.domElem.data("id"))}}),BEM.DOM.decl({name:"input",modName:"suggest",modVal:"yes"},{onSetMod:{js:{inited:function(){this.params.foot&&(this.foot=this.params.foot),this._preventRequest=!0,this.__base.apply(this,arguments),this._userVal=this.val();var t=this._focused;t&&this.delMod("focused"),this.elem("control").attr("autocomplete","off"),this._preventRequest=!1,t&&this.setMod("focused","yes"),this._items=[],this._curItemIndex=-1,this._doRequest=$.debounce(this._doRequest,this.params.debounceDelay),this.bindToWin("resize",$.throttle(this._setWidth,60))}},focused:{yes:function(){this.__base();var t=this.params.showListOnFocus?this._onChange():this._onChange;this.on("change",t)},"":function(){this.__base(),this.un("change",this._onChange)._preventHide||this._getPopup().hide()}}},destruct:function(){var t=this._popup;return t&&t.domElem&&(this._popup=null,BEM.DOM.destruct(t.domElem)),this.__base.apply(this,arguments)},getDataprovider:function(){var t=this.params.dataprovider.url;return this._dataprovider||(this._dataprovider=BEM.create(this.params.dataprovider.name||this.__self.getName()+"__dataprovider",$.extend(this.params.dataprovider,{url:t,callbackCtx:this})))},_onChange:function(){return this._preventRequest||this._doRequest(),this._onChange},_onKeyDown:function(t){if(BEM.blocks.keycodes.is(t.which,"UP","DOWN")&&!t.shiftKey){t.preventDefault();var e=this._items.length,i=!1;if(e){var n=t.which-39,s=this._curItemIndex,o=0;do{i=(0===s&&-1===n||s+n>=e)&&this._onLeaveItem(this._items[s],!0),(s+=n)<0?s=e-1:s>=e&&(s=0)}while(!i&&!1===this._onEnterItem(this._items[s],!0)&&++o<e)}}},_onKeyPress:function(t){t.which===BEM.blocks.keycodes.ENTER&&this._curItemIndex>-1&&this._isCurItemEnteredByKeyboard&&(t.preventDefault(),this._onSelectItem(this._items[this._curItemIndex],!0))},_getPopup:function(){var t=this;if(!t._popup){var e=t.__self.getName(),i=[{elem:"items",tag:"ul",mix:[{block:e,elem:"popup-items"}]}],n=Array.isArray(t.params.popupMixs)?t.params.popupMixs:[],s={directions:"bottom-left"};t._hasPopupFade()&&i.push({block:e,elem:"fade"}),$.extend(s,t.params.popupParams),n.push({block:e,elem:"popup",elemMods:t.params.popupMods,js:{uniqId:t._uniqId}}),t._popup=$(BEMHTML.apply({block:"popup",mods:{animate:"no"},mix:n,js:s,content:{elem:"content",content:i}})).bem("popup").on({show:function(){t.bindTo("keypress",t._onKeyPress).bindTo("keydown",t._onKeyDown)},hide:function(){t.unbindFrom("keypress keydown")._curItemIndex=-1}}),$.each({pointerover:t._onEnterItem,pointerout:t._onLeaveItem,pointerdown:t._onSelectItem,pointerup:t._onItemMouseUp},function(e,i){BEM.blocks["b-autocomplete-item"].on(t._popup.domElem,e,function(e){i.call(t,e.block)})}),BEM.DOM.init(t._popup.domElem)}return t._popup},getPopup:function(){return this._getPopup()},_hasPopupFade:function(){return"yes"===(this.params.popupMods||{}).fade},_onEnterItem:function(t,e){if(t.hasMod("enterable","no"))return!1;var i=this._items,n=this._curItemIndex;n>-1&&i[n].delMod("hovered"),(n=this._getItemIndex(t))>-1&&i[n].setMod("hovered","yes"),this._curItemIndex=n,this._isCurItemEnteredByKeyboard=Boolean(e),e&&this.params.updateOnEnter&&(this._preventRequest=!0,this.val(!1!==t.enter()?t.val():this._userVal,{source:"autocomplete",itemIndex:this._curItemIndex}).del("_preventRequest"))},_onLeaveItem:function(t,e){var i=this._curItemIndex;return i>-1&&i===this._getItemIndex(t)&&(this._items[i].delMod("hovered"),this._curItemIndex=-1),e&&this.val(this._userVal),!0},_onSelectItem:function(t,e){var i=t.select(e||!1),n="object"==typeof i?i.needUpdate:!1!==i,s="object"==typeof i&&i.needEvent;this._preventRequest=!0,n&&(this._userVal=t.val(),this.val(this._userVal,{source:"autocomplete",itemIndex:this._curItemIndex})),e?this.del("_preventRequest")._getPopup().hide():(this._returnFocus=!0,this.bindToDoc("pointerrelease",this._onDocMouseUp),n||(this._preventHide=!0),this.afterCurrentEvent(function(){this.domElem&&this.setMod("focused","yes").del("_preventRequest","_preventHide")})),(n||s)&&this.trigger("select",{item:t,byKeyboard:e})},_onItemMouseUp:function(){this._closePopupByMouseUp()},_onDocMouseUp:function(){this._closePopupByMouseUp()},_closePopupByMouseUp:function(){this.unbindFromDoc("pointerrelease").del("_returnFocus")._getPopup().hide()},_getItemIndex:function(t){return $.inArray(t,this._items)},_doRequest:function(){var t=this;t._userVal=t.val(),t.trigger("data-requested").getDataprovider().get(t.val(),function(e){t.trigger("data-received",e);var i=t._getPopup(),n=e.items||e;t.foot&&n.length&&-1===$.inArray(t.foot,n)&&n.push(t.foot),n.length?(t._curItemIndex=-1,BEM.DOM.update(i.elem("items"),t._buildItemsHtml(n),function(){i.isShown()||(i.show(t.elem("box")),t._setWidth()),t._items=i.findBlocksInside("b-autocomplete-item"),t.trigger("update-items")})):i.hide()})},_setWidth:function(){this._hasPopupFade()&&this._getPopup().domElem.css("width",this.elem("box").outerWidth())},_buildItemsHtml:function(t){var e=this;return BEMHTML.apply($.map(t,function(t,i){var n,s={block:"b-autocomplete-item",data:t,mods:{type:$.isArray(t)?t[0]:"text"},suggestVersion:e.params.dataprovider.version||4};return $.isArray(t)&&$.isPlainObject(n=t.concat().pop())&&$.extend(s,n),s}))},setFoot:function(t){return this.foot=t,this.foot},getDefaultParams:function(){return $.extend(this.__base(),{updateOnEnter:!0,debounceDelay:50,showListOnFocus:!0})}}),BEM.decl({name:"input__dataprovider",baseBlock:"i-request_type_ajax"},{get:function(t,e){return this.__base({part:t},function(t){e.call(this,{items:t[1],metainfo:t[2]})})}}),BEM.DOM.decl("multiselect",{onSetMod:{js:function(){var t=this.elem("selected").val().split(","),e={};t.forEach(function(t){""!==t&&(e[t]=!0)}),this._lockUnlock(t),this.selected=e}},_onChange:function(t,e){var i=this.selected,n=[];for(var s in i[t.val()]=e.checked,i)i.hasOwnProperty(s)&&i[s]&&n.push(s);this._lockUnlock(n),this.elem("selected").val(n.join(","))},_lockUnlock:function(t){1===t.length?(this._locked=this.findBlockInside({block:"checkbox",modName:"checked",modVal:"yes"}),this._locked.setMod("disabled","yes")):this._locked&&(this._locked.delMod("disabled"),this._locked=null)}},{live:function(){return this.liveInitOnBlockInsideEvent("change","checkbox",function(t,e){this.afterCurrentEvent(function(){this._onChange(t.target,e)})}),!1}}),BEM.DOM.decl("b-wdgt-remove",{onSetMod:{js:function(){this.popup=this.findBlockOn("popup"),this.bindTo("do","click",this.yes),this.popup.on("hide",this.no,this),this.bindTo("cancel","click",this.hide),this.findBlockInside("blame","link").bindTo("click",this.changeThis(this.complain))}},show:function(t,e,i){return this.accepted=!1,this.yes=e,this.no=i,this.popup.show(t.domElem),this.updateBlameUrl(t),this},hide:function(){this.popup.hide(),this._complainUrl=""},updateBlameUrl:function(t){var e=this.findBlockInside("blame","link"),i=t.getInstance();this._complainUrl="/wcomplain/?wauth="+i.getAuth(),e.domElem.attr("href","https://forms.yandex.ru/surveys/2449/?form2449-widget_id="+i.classId)},no:function(){return this.accepted||this.no(),this.no=this.yes=null,this},yes:function(){return this.yes(),this.accepted=!0,this.popup.hide(),this},complain:function(){if(this._complainUrl){var t=this.findBlockInside("blame","link").domElem.attr("href");return $.get(this._complainUrl,function(){window.location=t}),!1}}},{live:!0}),BEM.DOM.decl("popup",{onSetMod:{js:{inited:function(){this.__base(),this._tailPos={}}}},_calcTailPos:function(t){var e=t.to,i=this._positions[t.key],n=t.tail.axis,s={};return"top"===e||"bottom"===e?s.left=this._calcTailLeft(n,i):"left"!==e&&"right"!==e||(s.top=this._calcTailTop(n,i)),s},_calcTailTop:function(t,e){var i=0,n=this.getOwnerSize(),s=this.getOwnerPos(),o=this.params.tail.width,r=this.getPopupSize(),a=r.height,c=s.top-e.top,l=e.top+r.height-(s.top+n.height);return c>0&&(i+=c,a-=c),l>0&&(a-=l),"middle"===t?i+=(a-=o)/2:"bottom"===t&&(i+=a-=o),i<0&&(i=0),i},_calcTailLeft:function(t,e){var i=0,n=this.getOwnerSize(),s=this.getOwnerPos(),o=this.params.tail.width,r=this.getPopupSize(),a=s.left-e.left,c=r.width,l=e.left+r.width-(s.left+n.width);return a>0&&(i+=a,c-=a),l>0&&(c-=l),"center"===t?i+=(c-=o)/2:"right"===t&&(i+=c-=o),i},_calcOffsetByTail:function(t){var e=this.params.tail.height,i={};switch(t.to){case"top":i={top:-e};break;case"bottom":i={top:e};break;case"right":i={left:e};break;case"left":i={left:-e}}return i},_calcTailOffset:function(t){var e={},i=t.to,n=t.tail,s=n.offset,o=n.axis;return!!s&&("top"===i||"bottom"===i?(e.left=0,"left"===o?e.left+=s.left:"center"===o?(s.left&&(e.left+=s.left),s.right&&(e.left-=s.right)):"right"===o&&(e.left-=s.right)):"left"!==i&&"right"!==i||(e.top=0,"top"===o?e.top+=s.top:"middle"===o?(s.top&&(e.top+=s.top),s.bottom&&(e.top-=s.bottom)):"bottom"===o&&(e.top-=s.bottom)),e)},_resetTailPos:function(t){return t?this._tailPos[t]=null:this._tailPos={},this},_pushTailPos:function(t,e){return this._pushPosTo(this._tailPos,t,e),this}}),BEM.DOM.decl("stream-promo-popup",{onSetMod:{js:{inited:function(){BEM.blocks["i-message-locker"].acquireLock("stream-promo-popup",this._hide.bind(this)).then(this._show.bind(this)),BEM.channel("suggest2").on("show",this._hide,this),$(window).on("keyboardOpened.lego",this._hide.bind(this))}}},_show:function(){this.setMod("visible","yes"),this.bindTo("inner","click",this._onClose),this.bindTo("close","click",this._onClose),this.bindTo("mouseenter",this._onMouseEnter),this.bindTo("mouseleave",this._onMouseLeave),home.stat.logDOMShow(this.domElem),this.params.counters.show&&((new Image).src=this.params.counters.show),this._hideTimeout=setTimeout(this._hide.bind(this),this.__self.HIDE_TIMEOUT);var t=$(".media-infinity-footer");t.length&&t.bem("media-infinity-footer").on("toggleFooter",function(){this._hovered||this._hide()},this),BEM.blocks["i-multiline-overflow"].calcAutoOverflow(this.domElem)},_hide:function(){this.delMod("visible"),BEM.blocks["i-message-locker"].releaseLock("stream-promo-popup")},_onClose:function(t){this._hide(),this.params.counters.close&&((new Image).src=this.params.counters.close),this.elem("close").is(t.data.domElem)&&(t.stopPropagation(),t.preventDefault())},_onMouseEnter:function(){this._hovered=!0,clearTimeout(this._hideTimeout)},_onMouseLeave:function(){this._hovered=!1,clearTimeout(this._hideTimeout),this._hideTimeout=setTimeout(this._hide.bind(this),this.__self.HIDE_TIMEOUT)}},{HIDE_TIMEOUT:1e4}),$(function(){var t=window.home&&home.getData&&home.getData("stream-promo-popup.etalon-counter");t&&BEM.blocks["i-message-locker"].acquireLock("stream-promo-popup").then(function(){(new Image).src=t,BEM.blocks["i-message-locker"].releaseLock("stream-promo-popup")})}),BEM.DOM.decl({block:"stream-promo-popup",modName:"exp",modVal:"yes"},{_show:function(){this._button=this.findBlockInside("button"),this.__base.apply(this,arguments)},_onMouseEnter:function(){this.__base.apply(this,arguments),this._button.setMod("hovered","yes")},_onMouseLeave:function(){this.__base.apply(this,arguments),this.hasMod("visible")&&this._button.delMod("hovered")}}),BEM.DOM.decl("media-grid",{onSetMod:{js:function(){this._notInitedBlocks=this.params.layout,this._notShowedBlocks=this._notInitedBlocks.slice(),this._sendRealShowDebounced=$.debounce(this._sendRealShow,400,this),this.bindTo("toggle-button","click",this.toggleCollapsed),this.bindKeyTo("toggle-button","space enter",this.toggleCollapsed),this.hasMod("collapsed")||(this._onScroll(null,BEM.DOM.win.scrollTop()),this.channel("i-reposition-event").on("reposition",this._onScroll,this));var t=this.findBlockInside("media-infinity-footer");t&&t.on("toggle",this.toggleCollapsed,this),this.channel("media-service").on("remove",function(t,e){var i=e.$elem.closest(this.findElem("row"));BEM.DOM.destruct(i)},this);var e=BEM.blocks["blender-logger"];e.initBlock(),e.updateMediaRows(),e.sendStat()},collapsed:{yes:function(){this.channel("i-reposition-event").un("reposition",this._onScroll,this),this.elem("toggle-button-content").text(home.l10n("a11y.expand")),this.elem("toggle-line").toggleClass("media-grid__row"),this.findBlockInside("media-footer").setMod("slim","yes"),$("body").removeClass("b-page_media-footer-collapsed_no").addClass("b-page_media-footer-collapsed_yes"),home.stat.logPath("show",this.params.counters.expand),this.trigger("collapsed")},"":function(){this.channel("i-reposition-event").on("reposition",this._onScroll,this),this.elem("toggle-button-content").text(home.l10n("a11y.collapse")),this.elem("toggle-line").toggleClass("media-grid__row"),this.findBlockInside("media-footer").delMod("slim"),$("body").removeClass("b-page_media-footer-collapsed_yes").addClass("b-page_media-footer-collapsed_no"),home.stat.logPath("show",this.params.counters.collapse),this.afterCurrentEvent(function(){this._onScroll(null,BEM.DOM.win.scrollTop()),home.stat.logDOMShow(this.domElem),this.domElem.find("[data-stream-stat]").each(function(t,e){home.stat.logPath("show",$(e).data("stream-stat"))}),this.trigger("expanded")})}}},_getDom:function(t){return this.elem("row").filter('[data-blockname="'+t+'"]').children().eq(0)},_getBlock:function(t,e){this.findBlockOn(t,home.view("media-grid__layout-to-block-name",e))},_requestInit:function(t){this._notInitedBlocks=this._notInitedBlocks.filter(function(e){var i=this._getDom(e);return i.length?t<i.offset().top||(this.setMod("visible","yes"),void this._getBlock(i,e)):(home.error.logError({block:"media-grid",message:"Child not found: "+e}),!1)},this)},_getRealShowStatPath:function(t){return t+".realshow"},_sendRealShow:function(t,e){this._notShowedBlocks=this._notShowedBlocks.filter(function(i){var n=this._getDom(i);if(!n.length)return!1;var s=n.height(),o=n.offset().top,r=o+s;if(!(t<=o&&r<=e||o<=t&&r<=e&&(r-t)/s>.5||t<=o&&e<=r&&(e-o)/s>.5))return!0;var a=this._getBlock(n,i);a&&a.setMod("visible","yes");var c=this._getRealShowStatPath(i);home.stat.logPath("show",c)},this),this._notShowedBlocks.length||this.channel("i-reposition-event").un("reposition",this._onScroll,this)},_onScroll:function(t,e){var i=window.innerHeight+e;this._requestInit(i),this._sendRealShowDebounced(e,i),!this._shown&&i>this.domElem.offset().top+this.__self.MIN_VISIBLE_HEIGHT&&(this._shown=!0,home.stat.logPath("show","mediafooter.realshow"))},toggleCollapsed:function(){var t=this.hasMod("collapsed");this.toggleMod("collapsed","yes",!t),t?(BEM.channel("navi").trigger("collapse"),home.stat.logPath("click",this.params.counters.expand),(new Image).src=this.params.expandModSaveUrl):(home.stat.logPath("click",this.params.counters.collapse),(new Image).src=this.params.collapseModSaveUrl)}},{MIN_VISIBLE_HEIGHT:62}),BEM.DOM.decl("media-service",{onSetMod:{js:function(){home.subscribeData(this._onData.bind(this)),this._initialLoadImages(),this._initMenuEvents()}},_onData:function(){this._calcOverflow(this.domElem)},_calcOverflow:function(t){BEM.blocks["i-multiline-overflow"].calcOverflow(t,this.__self.TEXT_OVERFLOW_LINES,this.__self.getName())},_initialLoadImages:function(){this._loadImages()},_loadVisibleImages:function(){},_loadImages:function(t){(t||this.domElem).filter(":not(.media-service__image-processed)").each(function(e,i){var n=$(i);t&&n.addClass("media-service__image-processed");var s=n.find(".media-service__image[data-image]"),o=0,r=this;s.each(function(){var t=new Image,e=$(this),i=e.data("image");i&&(i=r._selectImageUrl(e,i))&&(t.onload=function(){e.css("background-image",'url("'+i+'")'),e.addClass("media-service__image_loaded_yes"),++o===s.length&&r.setMod("images-loaded","yes")},t.src=i)})}.bind(this))},_selectImageUrl:function(t,e){return"string"==typeof e?e:window.devicePixelRatio>1&&e[2]?e[2]:e[1]},_isHidden:function(){return this.domElem.closest(".media-grid__row_collapsed_yes").length>0},_initMenuEvents:function(){this._getMenuId()&&(this._isHidden()?this._createMenuChecked():this.bindTo("mouseenter focusin",this._createMenuChecked))},_getMenuId:function(){return this.domElem.closest("[data-blockname]").data("blockname")},_createMenuChecked:function(){!this._control&&home.getData("widgets.alt")&&this._createMenu()},_toggle:function(){var t=this.domElem,e=t.outerHeight();this.setMod("collapsed","yes"),t.height(e),this.afterCurrentEvent(function(){t.addClass("media-service_collapsed_yes").css("height","").onceAnimationEnd("transition",300,function(){this.channel("media-service").trigger("remove",{$elem:t,layoutName:this._getMenuId()}),BEM.blocks["i-reposition-event"].trigger()}.bind(this))})},_createMenu:function(){var t=this._getMenuId();t&&(this._control=BEM.blocks["widget-control"].create(this.domElem,{name:t,removeOnHide:!0,items:{hide:!0},customItems:this._getMenuCustomItems()}),this._control.on({hide:this._toggle.bind(this,!1)},this))},_getMenuCustomItems:function(){return[]}},{live:!0,TEXT_OVERFLOW_LINES:2}),$.extend($.easing,{easeOutQuint:function(t,e,i,n,s){return n*((e=e/s-1)*e*e*e*e+1)+i}}),BEM.DOM.decl("carousel",{getDefaultParams:function(){return{animationTime:900,offset:null}},onSetMod:{js:function(){this.setScrollMod(),this.bindEvents(),this._mediaGrid=this.findBlockOutside("media-grid"),this._mediaGrid&&this._mediaGrid.on("expanded",this.setScrollMod,this)},scroll:{left:function(){var t=this.elem("control","side","right");this.hasMod(t,"hovered","yes")&&this.setMod(t,"disable","yes")},right:function(){var t=this.elem("control","side","left");this.hasMod(t,"hovered","yes")&&this.setMod(t,"disable","yes")},both:function(){this.trigger("scrollModChange",{type:"both"})}}},onElemSetMod:{control:{hovered:{"":function(){this.delMod(this.elem("control"),"disable")}}}},bindEvents:function(){return this.bindTo("control","pointerclick",this._onControlClick).bindTo("control","dblclick",function(t){t.preventDefault()}).bindTo("wrap","scroll",home.throttle(this._onScroll.bind(this),50)),$(".i-ua_browser_touch").length||this.bindTo("control","mousemove",this._onMouseMove).bindTo("control","mouseleave",this._onMouseLeave),this.bindToWin("resize",home.throttle(this._onResize.bind(this),300)),this},destruct:function(){this.unbindFromWin("resize"),this._mediaGrid&&(this._mediaGrid.un("expanded",this.setScrollMod,this),this._mediaGrid=null),this.__base.apply(this,arguments)},_onResize:function(){this.setScrollMod()},_onMouseMove:function(t){this.setMod(t.data.domElem,"hovered","yes")},_onMouseLeave:function(){this.delMod(this.elem("control"),"hovered")},_onControlClick:function(t){if(this.hasMod(this.elem("control"),"disable","yes"))return!1;var e=this.getMod(t.data.domElem,"side");this.canScrollTo(e)&&this.move(e)},_onScroll:function(){this.setScrollMod().checkEndOfList()},setScrollMod:function(){var t,e=this.elem("wrap").scrollLeft(),i=this.elem("wrap")[0].scrollWidth,n=this.elem("wrap").outerWidth();return t=i-n<=0?"":e<=0?"right":e+n+1<i?"both":"left",this.params.counter&&!this._scrollCounted&&e&&(home.stat.logPath("scroll",this.params.counter+".scroll"),this._scrollCounted=!0),this.setMod("scroll",t)},checkEndOfList:function(){if(!this.params.offset)return this;var t=this.elem("wrap"),e=t.scrollLeft(),i=t[0].scrollWidth,n=t.width();return e<=this.params.offset&&this.trigger("listOut","left"),e+n>i-this.params.offset&&this.trigger("listOut","right"),this},canScrollTo:function(t){var e=this.getMod("scroll");return"both"===e||e===t},move:function(t){var e=this.elem("wrap").scrollLeft()+this.getOffset(t);this.params.counter&&home.stat.logPath("scroll",this.params.counter+".swipe."+t),this.elem("wrap").stop().animate({scrollLeft:e},this.params.animationTime,"easeOutQuint",this.setScrollMod.bind(this))},getOffset:function(t){return("left"===t?-1:1)*this.params.step},scrollToStart:function(){this.elem("wrap").scrollLeft(0)},setItemsInList:function(t){this.getList().html(t)},appendItemsInList:function(t){this.getList().append(t)},prependItemsInList:function(t){this.getList().prepend(t)},getList:function(){return this.list||(this.list=this.elem("list"))},getContentWidth:function(){return this.getList().width()},getControlWidth:function(t){return this.elem("control","side",t).width()},getWrapperWidth:function(){return this.elem("wrap").width()},scrollLeft:function(t){return void 0!==t?this.elem("wrap").scrollLeft(t):this.elem("wrap").scrollLeft()}}),BEM.DOM.decl({name:"zen",baseBlock:"media-service"},{onSetMod:{js:function(){this._carousel=this.findBlockInside("list-wrapper","carousel"),this._lsKeys={ttl:this.__self._lsTTLPrefix+this.params.login,data:this.__self._lsDataPrefix+this.params.login},this._statRoot=null,this._sessionsCards=[],this._countOfLoads=0,this._packCounters={ice:0,personal:0},this._isCardsListVisible=!1,this._cachedData=null,this._storeTimer=null,this._processVisibleCardsThrottled=home.throttle(this._processVisibleCards.bind(this),this.__self._updateThrottle),this._logZenShowsDebounced=$.debounce(this._logZenShows,this.__self._zenShowDebounce,this),this._onScrollDebounced=$.debounce(this._onScroll,this.__self._zenShowDebounce,this),this._dataReady=$.Deferred(),this._mediaGrid=this.findBlockOutside("media-grid"),this.bindTo(this._carousel.elem("wrap"),"scroll",this._processVisibleCardsThrottled),this.channel("i-reposition-event").on("reposition",this._onScrollDebounced,this),this.bindToWin("resize",this._processVisibleCardsThrottled),this.bindTo("retry-button","click",this._onRetryClick),this.channel("sys").on("visibilitychange",this._onVisibilityChange,this),this._loadCards(),this._onScrollDebounced(null,0),this._mediaGrid.hasMod("collapsed","yes")&&this._mediaGrid.onFirst("expanded",function(){this._sessionsCards.length&&this.afterCurrentEvent(function(){this._showCards(),this._processVisibleCards()})},this),this._initMenuEvents()},visible:{yes:function(){home.stat.logDOMShow(this.domElem)}},recommend:function(t,e){this.elem("desc").html("ice"===e?home.l10n("media.zen.desc_ice"):home.l10n("media.zen.desc"))}},getPromoItems:function(){return this._dataReady},scrollTo:function(t){var e=this.elem("item").filter("[data-id="+t+"]"),i=e.prop("offsetLeft"),n=this.elem("list").width(),s=e.width();this.elem("wrap").stop().animate({scrollLeft:i-(n-s)/2},"slow")},_onScroll:function(t,e){var i=this.__self._cardFullHeight,n=this.__self._cardHeightForShow,s=e,o=this.elem("list").offset().top,r=o+i,a=s+window.innerHeight;this._isCardsListVisible=s<=o&&r<=a||o<=s&&r<=a&&(r-s)%i>n||s<=o&&a<=r&&(a-o)%i>n,this._logZenShows(this._getVisibleCards(this._getIndexesOfVisibleCards()))},_processVisibleCards:function(){if(!this._mediaGrid.hasMod("collapsed","yes")){var t=this._getIndexesOfVisibleCards();this._loadImagesForVisibleCards(t),this._logZenShowsDebounced(this._getVisibleCards(t))}},_getIndexesOfVisibleCards:function(){var t=this._carousel.scrollLeft(),e=this._carousel.getContentWidth(),i=this.__self._cardFullWidth,n=t+e,s=i-t%i>this.__self._cardWidthForShow+20,o=n%i>this.__self._cardWidthForShow,r=t/i,a=n/i;return[s?Math.floor(r):Math.ceil(r),o?Math.ceil(a):Math.floor(a)]},_getVisibleCards:function(t){return this._sessionsCards.slice(t[0],t[1])},_loadImagesForVisibleCards:function(t){this._loadImages(this.findElem("item").slice(t[0],t[1]+1))},_listenListOutOn:function(){this._countOfLoads<this.__self._maxCountOfLoads&&this._carousel.on("listOut",this._onListOut,this)},_listenListOutOff:function(){this._carousel.un("listOut",this._onListOut,this)},_onListOut:function(t,e){"right"===e&&(this._listenListOutOff(),this._loadCardsByAjax())},_loadCards:function(){var t=this._loadCardsFromLS();t?(this._onSuccess(t.data),t.forceAjax?this._loadCardsByAjax():this.hasMod("recommend","ice")?this._dataReady.reject():this._dataReady.resolve(this._sessionsCards)):this._loadCardsByAjax()},_loadCardsByAjax:function(){var t=this;return this._countOfLoads||this.setMod(this.elem("loader"),"state","loading"),$.ajax({url:this.params.zenUrl+(this._countOfLoads?"":"&cache=1"),xhrFields:{withCredentials:!0},context:this,success:this._onSuccess,error:this._onError,timeout:this.__self._timeoutZen}).then(function(){this.hasMod("recommend","ice")?t._dataReady.reject():t._dataReady.resolve(t._sessionsCards)}.bind(this))},_loadCardsFromLS:function(){var t,e,i=home.localStorage.getItem(this._lsKeys.ttl),n=(new Date).getTime();try{if(!(t=JSON.parse(home.localStorage.getItem(this._lsKeys.data))).storeTs||t.storeTs<n)return void this._cleanLS();if(t&&t.items&&t.items.length)return e={data:t},(t.items.length<=this.__self._minCountOfCards||i<n)&&(e.forceAjax=!0),e}catch(t){}this._cleanLS()},_cleanLS:function(){[this._lsKeys.ttl,this._lsKeys.data].forEach(home.localStorage.removeItem)},_onSuccess:function(t){this._checkData(t)?(this.setMod("recommend",t.context.ice_start?"ice":"personal"),this._countOfLoads+=1,this._prepareData(t),this._recommendType=t.context.ice_start?"ice":"personal",this._statRoot="mediafooter.zen."+this._recommendType+".pack",this._packCounters[this._recommendType]+=1,t.items=this._moveDirectCards(t.items),this._appendCards(t.items),this._cachedData=t,this._setStoreTimeout(this._getStoreTTL()),this._sessionsCards=this._sessionsCards.concat(t.items),this._processVisibleCards(),this._listenListOutOn(),this._createCache(t.ttlTs,t)):this._onError()},_onError:function(t,e){e&&this._logEvent("Request failed: "+e+(this._countOfLoads?"":" - empty feed")),this._countOfLoads?this.delMod(this.elem("loader"),"state"):(this.setMod(this.elem("loader"),"state","retry"),home.stat.logDOMShow(this.domElem)),this._dataReady.reject()},_onRetryClick:function(){this._loadCardsByAjax()},_prepareData:function(t){if(!t.prepared){var e=t.stats.bulk,i=1e3*(t.ttl||this.__self._defaultZenTTL),n=1e3*(t.store_ttl||this.__self._defaultZenStoreTTL);t.ttlTs=(new Date).getTime()+i,t.storeTs=(new Date).getTime()+n,t.items.forEach(function(t){return t.id=Number(Math.random().toString().substr(2,8)),t.bulk_url=e,t},this),t.prepared=1}},_createCache:function(t,e){e.ls||(e.ls=1,home.localStorage.setItem(this._lsKeys.ttl,t),home.localStorage.setItem(this._lsKeys.data,JSON.stringify(e)))},_updateCache:function(t){home.localStorage.setItem(this._lsKeys.data,JSON.stringify(t))},_cleanCards:function(){this._countOfLoads=0,this.elem("list").html(""),this._carousel.setScrollMod(),this._cachedData=null,this._sessionsCards=[],this._packCounters={ice:0,personal:0},clearTimeout(this._storeTimer),this._storeTimer=null,this._cleanLS()},_getStoreTTL:function(){return this._cachedData?this._cachedData.storeTs-(new Date).getTime():0},_setStoreTimeout:function(t){t>0&&(clearTimeout(this._storeTimer),this._storeTimer=setTimeout(this._handleStoredCards.bind(this),t))},_handleStoredCards:function(){if(this._cachedData){var t=this._getStoreTTL();t>0?this._setStoreTimeout(t):(this._cleanCards(),this._loadCardsByAjax())}else this._loadCardsByAjax()},_onVisibilityChange:function(t,e){e.hidden?(clearTimeout(this._storeTimer),this._storeTimer=null):this._handleStoredCards()},_onClick:function(t){var e=t.data.domElem.parent(".zen__item").data("id"),i=this._selectCardById(this._sessionsCards,e);i&&"ad"===i.data.type?this._logZenEvent(i.data.bulk_url,{event:i.data.items[0].stat_events.click,data:i.data.items[0].bulk_params}):i&&this._logZenEvent(i.data.bulk_url,{event:i.data.stat_events.click,data:i.data.bulk_params})},_onLikeClick:function(t){var e=t.data.domElem,i=e.parent(".zen__item").data("id"),n=this._selectCardById(this._sessionsCards,i),s=Boolean(n.data.liked);n&&(n.data.liked=!s,this._logZenEvent(n.data.bulk_url,{event:n.data.stat_events[n.data.liked?"feedback:more":"feedback:cancel_more"],data:n.data.bulk_params})),this.toggleMod(e,"liked","yes"),this.setMod(e,"scaled","yes"),setTimeout(function(){this.delMod(e,"scaled")}.bind(this),this.__self._scaleDuration)},_onDislikeClick:function(t){var e,i=t.data.domElem.parent(".zen__item"),n=i.data("id"),s=this._selectCardById(this._sessionsCards,n);s&&(this._sessionsCards.splice(s.index,1),e=[{event:s.data.stat_events["feedback:less"],data:s.data.bulk_params}],s.data.liked&&e.push({event:s.data.stat_events["feedback:cancel_more"],data:s.data.bulk_params}),this._logZenEvent(s.data.bulk_url,e),this._sessionsCards.length<=this.__self._minCountOfCards&&this._loadCardsByAjax()),this.setMod(i,"disliked","yes"),this._removeDislikedCards()},_selectCardById:function(t,e){for(var i=0;i<t.length;i+=1)if(t[i].id===e)return{data:t[i],index:i}},_removeDislikedCards:function(){clearTimeout(this._timerGC),this._timerGC=setTimeout(function(){this.findElem("item","disliked","yes").remove(),this._processVisibleCards()}.bind(this),this.__self._timeoutDislikeGC)},_moveDirectCards:function(t){var e,i,n,s=[],o=0,r=[];for(e=0,i=t.length;e<i;e++)"ad"===t[e].type&&s.push(e);if(!s.length||s[0]>=4)return t;for(n=4-s[0],e=0,i=t.length;e<i;e++)"ad"!==t[e].type&&r.push(t[e]),o<s.length&&e===s[o]+n&&(r.push(t[s[o]]),o++);return r},_renderCard:function(t){if("ad"===t.type){var e=t.items[0];return e.id=t.id,e&&"direct"===e.provider?this._renderCardDirect(e):""}var i,n,s="#FFFFFF"===t.text_color?"black":"white",o=t.background_color,r=this.__self._getTransparentPairColor(o),a=t.logo&&("black"===s?t.logo.w:t.logo.b),c={type:t.type,theme:s},l={title:home.ltgtFilter(t.title),mods:{}},h={mods:{}},u={},d={},m=this._packCounters[this._recommendType],p=this._getLongestWordLength(l.title);return a?(d.style="background-image: url("+a+")",h.mods.logo="yes"):h.title=t.domain_title,l.title.length<43&&p<13?(l.mix="i-multiline-overflow_lines_4",l.mods.size="l"):l.title.length<76&&p<17?(l.mix="i-multiline-overflow_lines_5",l.mods.size="m"):(l.mix="i-multiline-overflow_lines_6",l.mods.size="s"),t.image&&(u["data-image"]=t.image[this.__self._isRetina?"2x":"1x"]),t.stat_events["feedback:more"]&&(i=home.view("zen__item-control",{mix:"zen__item-like",attrs:{"data-statlog":this._statRoot+".like."+m,title:home.l10n("media.zen.like")}})),t.stat_events["feedback:less"]&&(n=home.view("zen__item-control",{mix:"zen__item-dislike",attrs:{"data-statlog":this._statRoot+".dislike."+m,title:home.l10n("media.zen.dislike")}})),(i||n)&&(h.mods.fadeout="yes"),home.view("zen__item",{id:t.id,title:l,text:"text"===t.type?home.ltgtFilter(t.text):"",mods:c,mix:"media-service__item media-service__shadow",attrs:{rel:t.feed_link?"":"noreferrer",href:t.feed_link||t.link,target:"_blank","data-statlog":this._statRoot+".card."+m,style:["color:"+t.text_color,"background-color:"+o].join(";")},from_color:r,to_color:o,imageAttrs:u,domain:h,domainAttrs:d,like:i,dislike:n})},_renderCardDirect:function(t){var e=this._packCounters[this._recommendType],i={type:"small",footer:"none"},n={},s={},o={mix:"i-multiline-overflow_lines_5",title:home.ltgtFilter(t.content.title),mods:{size:"m"}};return t.content.big_image?(i.type="big",n["data-image"]=t.content.big_image[0]):t.content.small_image&&(i.type="small",s["data-image"]=t.content.small_image[0],s.style=["width:"+t.content.small_image[1]+"px","height:"+t.content.small_image[2]+"px"].join(";")),t.content.warning&&t.content.age?i.footer="both":t.content.warning?i.footer="warning":t.content.age&&(i.footer="age"),home.view("zen__direct",{id:t.id,label:{text:home.l10n("media.direct.title"),href:this.params.directUrl},title:o,domain:t.content.domain,text:home.ltgtFilter(t.content.body),mods:i,attrs:{href:t.content.url,rel:"noopener",target:"_blank","data-statlog-redir":0,"data-statlog":this._statRoot+".direct."+e},from_color:"rgba(255,255,255, 0)",to_color:"rgba(255,255,255, 1)",bigImageAttrs:n,smallImage:s["data-image"]?home.view("zen__direct-type_small-img",{smallImageAttrs:s}):"",warning:t.content.warning,age:t.content.age})},_getLongestWordLength:function(t){return Math.max.apply(null,t.split(" ").map(function(t){return t.length}))},_appendCards:function(t){var e=t.map(this._renderCard,this).join("");this.elem("list").append(e),home.subscribeData(this._showCards.bind(this))},_calcOverflow:function(){var t=this.__self._textContentHeight,e=this.__self._textLineHeight;this.findElem("item","type","text").each(function(){var i=$(this),n=i.find(".zen__item-title").height(),s=Math.floor((t-n)/e);i.find(".zen__item-text").addClass("i-multiline-overflow_lines_"+s)}),BEM.blocks["i-multiline-overflow"].calcAutoOverflow(this.elem("list"))},_showCards:function(){this._mediaGrid.hasMod("collapsed","yes")||(this._calcOverflow(),this.delMod(this.elem("loader"),"state"),this.setMod(this.elem("list"),"visibility","visible"),this._carousel.setScrollMod(),this.hasMod("visible","yes")&&home.stat.logDOMShow(this.domElem))},_checkData:function(t){var e;return!(!(t&&t.items&&t.items.length&&t.stats&&t.stats.bulk)&&(t?t.items?t.items.length?t.stats&&t.stats.bulk||(e="emptystats"):e="emptyitems":e="noitems":e="nodata",e))||(this._cleanLS(),this._logEvent("Data error: "+e+(this._countOfLoads?"":" - empty feed")),!1)},_filterShowedCards:function(t){return t.filter(function(t){return"ad"===t.type&&t.items[0]?t.items[0].stat_events.show:t.stat_events.show})},_logEvent:function(t){this.params.logDisabled||home.error.logError({block:"zen",message:t})},_logZenEvent:function(t,e){$.ajax({method:"POST",url:t,timeout:this.__self._timeoutZen,xhrFields:{withCredentials:!0},data:JSON.stringify({stats:Array.isArray(e)?e:[e]})})},_logZenShows:function(t){if(this._isCardsListVisible){var e=!1,i=t.reduce(function(t,e){if(t[e.bulk_url]||(t[e.bulk_url]=[]),"ad"===e.type){var i=e.items?e.items[0]:null;i&&i.stat_events&&i.stat_events.show&&(t[e.bulk_url].push({event:i.stat_events.show,data:i.bulk_params}),delete i.stat_events.show,(new Image).src=i.content.linkHead+i.content.linkTail)}else e.stat_events&&e.stat_events.show&&(t[e.bulk_url].push({event:e.stat_events.show,data:e.bulk_params}),delete e.stat_events.show);return t},{});Object.keys(i).forEach(function(t){i[t].length&&(e=!0,this._logZenEvent(t,i[t]))},this),e&&(this._cachedData.items=this._filterShowedCards(this._cachedData.items),this._updateCache(this._cachedData))}}},{live:function(){return this.__base.apply(this,arguments),this.liveBindKey("item-link","space enter",function(t){this._onClick(t)}),this.liveBindTo("item-link","click",function(t){this._onClick(t)}),this.liveBindKey("item-like","space enter",function(t){this._onLikeClick(t)}),this.liveBindTo("item-like","click",function(t){this._onLikeClick(t)}),this.liveBindKey("item-dislike","space enter",function(t){this._onDislikeClick(t)}),this.liveBindTo("item-dislike","click",function(t){this._onDislikeClick(t)}),!0},_getTransparentPairColor:function(t){return"rgba("+[t.slice(1,3),t.slice(3,5),t.slice(5,7)].map(function(t){return parseInt(t,16)}).join(",")+", 0)"},_clearLS:function(){[this._lsTTLPrefix,this._lsDataPrefix].forEach(home.localStorage.removeItem)},_isRetina:"undefined"!=typeof detector&&detector.isRetina(),_minCountOfCards:6,_maxCountOfLoads:3,_cardFullHeight:280,_cardInnerWidth:204,_cardFullWidth:224,_cardWidthForShow:204*.8,_cardHeightForShow:224,_textLineHeight:17,_textContentHeight:195,_updateThrottle:200,_timeoutDislikeGC:300,_scaleDuration:260,_lsTTLPrefix:"home:zen-desktop-ttl-",_lsDataPrefix:"home:zen-desktop-data-",_zenShowDebounce:600,_defaultZenTTL:3600,_defaultZenStoreTTL:432e3,_timeoutZen:3e4}),BEM.DOM.decl({name:"media-broadcast",baseBlock:"media-service"},{onSetMod:{js:function(){this._initThumbnail(),this.__self.instance=this,this._downloadPromise={},this._mediaGrid=this.findBlockOutside("media-grid"),this.hasAutoplay()&&this.getPlayer(),this.initXiva(),this._initShareBlock(),this.__self.hasAutoScroll()&&this.scrollToBlock(),this._initTimer(),this._initMenuEvents()},player:function(){this._creatingPlayer=null,this.afterCurrentEvent(function(){this.getPlayer().then(function(){this._playing&&this.startPlaying()}.bind(this))})}},downloadApi:function(t){return this._downloadPromise[t]||(this._downloadPromise[t]=new Promise(function(e,i){var n=document.createElement("script");n.onload=e,n.onerror=i,n.src=t,document.getElementsByTagName("head")[0].appendChild(n)})),this._downloadPromise[t]},initXiva:function(){var t,e=this.params.xiva;e&&(t=[e.ch,e.key].join("_"),BEM.blocks["i-xiva"].listen(t,e.ts,this.onXivaMessage.bind(this),{force:!0}))},onXivaMessage:function(t){var e,i=t&&t.data;i&&(this._updateData(i),e=parseInt(i.youtube_enabled,10),parseInt(i.forced_switch,10)&&!this.hasMod("bad-ua")&&this.setMod("player",e?"youtube":""))},_initTimer:function(){if("yes"!==this.getMod("can-play")){var t=this;setTimeout(function(){t.setMod("can-play","yes")},1e3*this.params.startTime-Date.now())}},_initThumbnail:function(){var t=this.findElem("thumbnail"),e=t.data("img");e&&t.css("background-image",'url("'+e+'")')},_updateData:function(t){var e,i;e=this._convertTime(t.start_time),i=this._convertTime(t.end_time),this.params.streamUrl=t.stream_url,e&&(this.params.startTime=e),i&&(this.params.endTime=i),this.params.youtubeVideoId=t.youtube_video_id},_convertTime:function(t){var e,i;if(t&&(i=t.match(/(\d{4})-(\d{2})-(\d{2})\s+(\d{2}):(\d{2})/)))return e=new Date(i[1],i[2]-1,i[3],i[4],i[5]),e=Math.floor(e/1e3),isNaN(e)?void 0:e},_initShareBlock:function(){$.ajax({url:"//yastatic.net/share2/share.js",dataType:"script",context:this}).then(this._onShareLoad,function(t,e,i){home.error.logAjaxError({block:"media-broadcast",message:"_initshareBlock: ajax",source:"share2"},t,e,i)})},_onShareLoad:function(){var t="http://yandex."+this.params.share.zone+"/?yac2018=1",e={theme:{services:"vkontakte,facebook,odnoklassniki,twitter",lang:this.params.share.locale},content:{url:t,title:home.l10n("media.broadcast.yac2018.title"),description:home.l10n("media.broadcast.yac2018.desc"),image:this.params.share.image},contentByService:{vkontakte:{url:t,title:home.l10n("media.broadcast.yac2018.title")+". "+home.l10n("media.broadcast.yac2018.desc"),image:this.params.share.image}}};try{this._shareInstance=new Ya.share2(this.elem("share-buttons")[0],e)}catch(t){}},scrollToBlock:function(t){this.disableAutoplay(),home.stat.logPath("click",this.params.counters&&this.params.counters.scrollToBlock),this._mediaGrid.hasMod("collapsed")&&this._mediaGrid.toggleCollapsed(),this.afterCurrentEvent(function(){var e=this._mediaGrid.domElem.offset().top;$("html,body").stop().animate({scrollTop:e},t||400)})},play:function(t){this.disableAutoplay(),this.getPlayer().then(function(){this.setMod(this.elem("thumbnail"),"hidden","yes"),this.startPlaying(t),this._playing=!0}.bind(this))},startPlaying:function(t){this.player&&(t&&this.player.setVolume(0),this.player.play&&this.player.play())},getPlayer:function(){return this.downloadApi(this.getApiUrl()).then(function(){return this._creatingPlayer?this._creatingPlayer:this.createPlayer()}.bind(this))},hasAutoplay:function(){return this.params.autoplay&&!this._mediaGrid.hasMod("collapsed")},disableAutoplay:function(){this.delMod("autoplay")},getApiUrl:function(){return"https://yastatic.net/yandex-video-player-iframe-api-bundles/1.0-279/js/stream_player.min.js"},getStreamUrl:function(){var t=home.parseUrl(this.params.streamUrl);return t.query.start=this.params.startTime,t.query.end=this.params.endTime,t.query.from="morda",t.query.from_block="media-broadcast",home.makeUrl(t)},createPlayerInstance:function(){var t=this.getStreamUrl();return new Promise(function(e,i){var n;n=Ya.streamPlayer.create({element:"media-broadcast__player-container",autoplay:!0,preload:!1,version:"1.0-279",stream:t,handlers:{onError:function(t){t.isFatal&&(2e3===t.code||415!==t.code&&112!==t.code&&self._retry-- >=0||(i(),this._creatingPlayer=null))}.bind(this),onReady:function(){e(n)},onStateChange:function(t){this._playing=1===t||3===t||5===t}.bind(this)}})}.bind(this))},createPlayer:function(){return this.player&&this.player.destroy(),this.elem("player-container").html(""),this._creatingPlayer=this.createPlayerInstance().then(function(t){this.player=t}.bind(this)),this._creatingPlayer}},{live:function(){return this.liveBindTo("thumbnail","click",function(){"yes"===this.getMod("can-play")&&this.play()}),!this.hasAutoScroll()},hasAutoScroll:function(){return Boolean(home.getData("media-broadcast").yac2018.autoScroll)},disableAutoplay:function(){this.instance.disableAutoplay()},scrollToBlock:function(t){this.instance||$("."+this.getName()).bem(this.getName()),this.instance.scrollToBlock(t)},play:function(){this.instance.play()}}),BEM.DOM.decl({block:"media-broadcast",modName:"autoplay",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.hasAutoplay()&&this._initAutoplay()}},_initAutoplay:function(){this._updateVideoBottom(),this._checkAutoplay(),this._updateVideoBottom=$.throttle(this._updateVideoBottom,100),this._checkAutoplay=$.throttle(this._checkAutoplay,100),this.bindToWin("resize",this._updateVideoBottom),this.bindToWin("scroll",this._checkAutoplay)},disableAutoplay:function(){this.unbindFromWin("resize",this._updateVideoBottom),this.unbindFromWin("scroll",this._checkAutoplay),this.__base.apply(this,arguments)},_updateVideoBottom:function(){var t=this.elem("player-container");this._videoBottom=t.offset().top+t.height()},_checkAutoplay:function(){var t=$(window).scrollTop()+$(window).height();this._videoBottom<=t&&(home.stat.logPath("click",this.params.counters&&this.params.counters.autoplay),this.play(!0))}}),BEM.DOM.decl({block:"media-broadcast",modName:"player",modVal:"youtube"},{getApiUrl:function(){return"https://www.youtube.com/iframe_api"},startPlaying:function(t){this.player&&(t&&this.player.setVolume(0),this.player.playVideo&&this.player.playVideo())},downloadApi:function(){var t=this.__base.apply(this,arguments);return this._initingYoutubeApi||(this._initingYoutubeApi=new Promise(function(t){window.onYouTubeIframeAPIReady=t})),Promise.all([t,this._initingYoutubeApi])},createPlayerInstance:function(){var t=this.params.youtubeVideoId;return new Promise(function(e){var i;this.elem("player-container").html('<div id="media-broadcast__player-container_youtube"></div>'),i=new YT.Player("media-broadcast__player-container_youtube",{videoId:t,events:{onReady:function(){e(i)},onStateChange:function(t){t.data===YT.PlayerState.PLAYING?this._playing=!0:t.data!==YT.PlayerState.PAUSED&&t.data!==YT.PlayerState.ENDED||(this._playing=!1)}.bind(this)}})}.bind(this))}}),BEM.DOM.decl({name:"media-stream",baseBlock:"media-service"},{}),BEM.DOM.decl("media-footer",{onSetMod:{js:function(){home.stat.logDOMShow(this.domElem)}}},{live:function(){var t=function(t){t.preventDefault(),this.findBlockOutside("media-grid").toggleCollapsed();var e=t.data.domElem.attr("data-scroll-to"),i=$("."+e).offset().top;$("html,body").stop().animate({scrollTop:i-10},400)};return this.liveBindTo("smart-link","click",t),this.liveBindKey("smart-link","enter space",t),!0}}),BEM.DOM.decl({name:"media-event",baseBlock:"media-service"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.scrollTo&&this._scrollToTop()}},_scrollToTop:function(){var t=$(".media-grid").bem("media-grid");t.hasMod("collapsed","yes")&&t.delMod("collapsed"),this.afterCurrentEvent(function(){var t=this.domElem.offset().top;$("html,body").stop().animate({scrollTop:t},200)})},_calcOverflow:function(){}}),BEM.DOM.decl("media-episode",{onSetMod:{js:function(){BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("stream-title"),3,this.__self.getName())}}}),BEM.DOM.decl("sup-button",{onSetMod:{js:{inited:function(){this._updateSubscribed().then(this._initializeButton.bind(this),this._initializeButton.bind(this)),this._manager().on("updateTags",this._onUpdateTags,this)}}},destruct:function(){this._manager().un("updateTags",this._onUpdateTags,this),this.__base.apply(this,arguments)},_manager:function(){return BEM.blocks["sup-manager"].getInstance()},_onUpdateTags:function(t,e){for(var i=0;i<e.length;++i)for(var n=0;n<this.params.tags.length;++n){var s=e[i],o=this.params.tags[n];if(s.name===o.name&&s.value===o.value){this._updateSubscribed();break}}},_updateSubscribed:function(){return this._manager().getTags(this.params.tags).then(function(t){var e=t.every(function(t){return t});this.setMod("subscribed",e?"yes":"no")}.bind(this))},_initializeButton:function(){this._isDestructing||this.bindTo("pointerclick",this._onButtonClick)},_onButtonClick:function(){return"denied"===this._manager().getPermission()?(home.stat.logPath("click","sup.button.denied"),this._showError()):this._changeSubscriptionStatus(),!1},_finish:function(){this.delMod("progress")},_changeSubscriptionStatus:function(){return"yes"===this.getMod("subscribed")?(this.setMod("progress","yes"),this._manager().unsubscribe(this.params.tags).then(this._finish.bind(this),this._finish.bind(this))):(this.setMod("progress","hover"),this._showNotice().then(function(t){if(t)return this.setMod("progress","yes"),this._manager().subscribe(this.params.tags)}.bind(this)).catch(function(t){throw this._showError(),home.error.logError({block:"sup-button"},t),t}.bind(this)).then(this._finish.bind(this),this._finish.bind(this)))},_showNotice:function(){return new Promise(function(t,e){var i,n=this._manager().getPermission();if("granted"===n){if(this.__self._shown())return t(!0);i=this._notice("popup")}else{if("default"!==n)return e(new Error("Unknown permission: "+n));i=this._notice("default")}var s=function(e,i){var n=this._manager().getPermission();i?(this.__self._shown(i),t("granted"===n||this._requestPermission())):t()}.bind(this);i.onFirst("close",s).open("prompt")}.bind(this))},_requestPermission:function(){var t=this._notice("default").open("wait");return this._manager().requestPermission().then(function(e){if(t.close(),"granted"===e.permission)return!0;e.delay<300&&this._showError()}.bind(this)).catch(function(e){throw t.close(),e})},_notice:function(t){return BEM.DOM.blocks["sup-notice"].getInstance(t)},_showError:function(){this._notice("default").open("error")}},{STORAGE_NAME:"notifications",_shownVal:null,_shown:function(t){return void 0!==t?(t&&this._setSessionParameter(this.STORAGE_NAME,""),this._shownVal=t,t):null!==this._shownVal?this._shownVal:(this._shownVal=this._hasSessionParameter(this.STORAGE_NAME),this._shownVal)},_setSessionParameter:function(t,e){try{window.sessionStorage.setItem(t,e)}catch(t){}},_hasSessionParameter:function(t){try{return window.sessionStorage.hasOwnProperty(t)}catch(t){return!1}}}),BEM.DOM.decl("sup-button",{_notice:function(t){var e=this.__base.apply(this,arguments);return"popup"===t&&e.setOwner(this.domElem),e}}),BEM.DOM.decl("sup-notice",{onSetMod:{js:{inited:function(){var t=this.close.bind(this,!1),e=this.close.bind(this,!0);this.findBlockOn("cancel","button2").on("click",function(){home.stat.logPath("click","sup.notice_"+this.getMod("type")+"."+(this.getMod("mode")||"default")+".cancel"),this.afterCurrentEvent(t)},this),this.findBlockOn("ok","button2").on("click",function(){home.stat.logPath("click","sup.notice_"+this.getMod("type")+"."+(this.getMod("mode")||"default")+".ok"),this.afterCurrentEvent(e)},this)}}},open:function(){return this.delMod("hidden"),home.stat.logPath("show","sup.notice_"+this.getMod("type")+"."+(this.getMod("mode")||"default")),this},close:function(t){return this.hasMod("hidden","yes")||(this.setMod("hidden","yes"),this.trigger("close",t)),this},_setTitle:function(t){return this.elem("title").html(t),this},_setText:function(t){return this.elem("text").html(t),this},_setButtonText:function(t,e){return this.findBlockOn(t,"button2").setText(e),this}},{_instances:{},getInstance:function(t){if(!this._instances[t]){var e=BEM.DOM.append(BEM.DOM.scope,home.view("sup-notice_type_"+t));this._instances[t]=e.bem(this.getName())}return this._instances[t]}}),BEM.DOM.decl("sup-notice",{onSetMod:{hidden:{yes:function(){this._destroyKey("ENTER")._destroyKey("ESC"),this.__base.apply(this,arguments)}}},_handlersKeys:{},_initializeKey:function(t,e){return this._handlersKeys[t]||(this._handlersKeys[t]=function(i){BEM.blocks.keycodes.is(i.keyCode,t)&&this.close(e)},this.bindToDoc("keydown",this._handlersKeys[t])),this},_destroyKey:function(t){return this._handlersKeys[t]&&(this.unbindFromDoc("keydown",this._handlersKeys[t]),delete this._handlersKeys[t]),this}}),BEM.DOM.decl({block:"sup-notice",modName:"type",modVal:"default"},{onSetMod:{mode:{wait:function(){this._setTitle(home.l10n("pushes.notice.wait.title"))},error:function(){this._setTitle(home.l10n("pushes.notice.error.title"))._setText(home.l10n("pushes.notice.error.text"))._setButtonText("cancel",home.l10n("pushes.notice.error.cancel"))},"web-error":function(){this._setTitle(home.l10n("pushes.notice.error.title"))._setText(home.l10n("pushes.notice.error.web_error"))._setButtonText("cancel",home.l10n("pushes.notice.error.cancel"))},prompt:function(){this._setTitle(home.l10n("pushes.notice.prompt.title"))._setText(home.l10n("pushes.notice.prompt.text"))._setButtonText("cancel",home.l10n("pushes.notice.prompt.cancel"))}}},open:function(t){return this.setMod("mode",t),this.__base.apply(this,arguments),this}}),BEM.DOM.decl({block:"sup-notice",modName:"type",modVal:"default"},{onSetMod:{mode:{"*":function(t,e){this._prepareKeys(e)}},hidden:{"":function(){this._prepareKeys(this.getMod("mode"))}}},_prepareKeys:function(t){"prompt"===t?this._initializeKey("ENTER",!0)._initializeKey("ESC"):"error"===t?this._destroyKey("ENTER")._initializeKey("ESC"):this._destroyKey("ENTER")._destroyKey("ESC")}}),BEM.DOM.decl({block:"sup-notice",modName:"type",modVal:"popup"},{onSetMod:{hidden:{"":function(){this.bindToDoc("pointerdown focusin",this._onOuterAction)},yes:function(){this.unbindFromDoc("pointerdown focusin",this._onOuterAction)}}},_onOuterAction:function(t){0===$(t.target).closest(this.domElem).length&&this.close()}}),BEM.DOM.decl({block:"sup-notice",modName:"type",modVal:"popup"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._updatePositionThrottled=home.throttle(this._updatePosition.bind(this),200)}},hidden:{"":function(){this._initializeKey("ENTER",!0)._initializeKey("ESC"),this._updatePosition(),this.bindToWin("resize",this._updatePositionThrottled),this.__base.apply(this,arguments)},yes:function(){this.unbindFromWin("resize",this._updatePositionThrottled),this.__base.apply(this,arguments)}}},setOwner:function(t){this._$owner=t,this._updatePosition()},_updatePosition:function(){if(this._$owner&&0!==this._$owner.closest("html").length){var t=this._$owner.offset(),e=Math.round(t.left+this._$owner.outerWidth()/2),i=Math.round(t.top+this._$owner.outerHeight()),n=e>260,s=i+150>BEM.DOM.win.scrollTop()+BEM.DOM.win.height();this.setMod("arrow-position",n?"right":"left"),this.setMod("arrow-hidden",s?"yes":""),this.domElem.css({left:e-(n?260:70),top:s?i-170:i+15})}}}),BEM.DOM.decl({baseBlock:"sup-button",block:"promo-sup-button"},{onSetMod:{subscribed:function(t,e){this.domElem.attr("title","yes"===e?home.l10n("pushes.sup_button.unsubscribe"):home.l10n("pushes.sup_button.subscribe")),this.trigger("toggle","yes"===e)}},_onButtonClick:function(){var t=this.__base.apply(this,arguments);return home.stat.logPath("click",this.params.counter+"."+(this.hasMod("subscribed","yes")?"unsubscribe":"subscribe")),t},_initializeButton:function(){this.__base.apply(this,arguments),this._isDestructing||home.stat.logPath("show",this.params.counter+"."+(this.hasMod("subscribed","yes")?"unsubscribe":"subscribe"))}}),BEM.DOM.decl("zen-lib",{onSetMod:{js:function(){window.Ya&&Ya.Rum&&Ya.Rum.makeSubPage&&(this._timing=Ya.Rum.makeSubPage(this.params.pageId)),this.params.libParams.staticHost&&this.params.libParams.staticHost.indexOf("/static-lib/s3/zen-lib/")>-1&&!$.cookie("bltsr")&&(delete this.params.libParams.staticHost,delete this.params.libParams.isAdblock),this.bindTo("retry-button","click",this._onRetryClick)},state:function(t,e){if("loaded"===e&&"prerender"===document.visibilityState){home.stat.logPath("show",this.params.statRoot+".loaded_in_prerender");var i=this;document.addEventListener("visibilitychange",function t(){"visible"===document.visibilityState&&(home.stat.logPath("show",i.params.statRoot+".visible_after_prerender"),document.removeEventListener("visibilitychange",t))})}home.stat.logPath("show",this.params.statRoot+"."+e),this._timing&&"retry"===e&&this._timing.cancel()}},_triggerFirstPaint:function(t){this._timing&&Ya.Rum.sendTimeMark("2793",t,!1,this._timing)},_waitIdleSearchMoment:function(t,e){var i,n=[{event:"init",channel:"suggest2"},{event:"focus",channel:"suggest2"},{event:"change",channel:"suggest2"},{event:"init",channel:"voice-search"},{event:"change",channel:"voice-search"}];function s(){n.forEach(function(t){BEM.channel(t.channel).un(t.event,i)})}return this._isForceLoad?e&&!this._hasEventsAfterResolve?(s(),Promise.resolve()):new Promise(function(e){i=$.debounce(function(){s(),e(),this._hasEventsAfterResolve=!1},t,!1,this),n.forEach(function(t){BEM.channel(t.channel).on(t.event,i),this._hasEventsAfterResolve=!0},this),i()}):Promise.resolve()},loadAndRender:function(t){if(this._isForceLoad=t&&t.isForceLoad,!this._bundleRequested)return this._bundleRequested=!0,home.stat.logPath("show",this.params.statRoot+".init"),this._timing&&Ya.Rum.sendTTI(!1,Ya.Rum.getTime(),this._timing),this.params.zenHost?this._loadDevLibParams(this.params.zenHost).then(this._injectZen.bind(this)).then(this._createZen.bind(this)):(this._runIncludedLoader(),this._createZen(this.params.libParams))},_onRetryClick:function(){this.setMod("state","loading"),this._bundleRequested=!1,this.loadAndRender()},_runIncludedLoader:function(){},_loadDevLibParams:function(t){var e=this.params.libParams,i=["host","isDev","pathToLoader","staticHost","version"];return new Promise(function(n){$.ajax({url:"//"+t+"/lib-config"}).then(function(s){var o=i.reduce(function(t,e){return t[e]=s[e],t},{});e.isAdblock&&o.staticHost&&(o.staticHost="https://"+t+"/static-lib/rezen-static/build/");var r=$.extend({},e,o);console.log("Current zen lib params:",r),n(r)})})},_initialForcedDelay:function(t){return this._isForceLoad?new Promise(function(e){setTimeout(e,t)}):Promise.resolve()},_promoCards:[],PROMO_CARD_DELAY_COLLECT:50,_debouncedTriggerPromoCards:$.debounce(function(){this.trigger("promoCards",this._promoCards.sort(function(t,e){return t.index-e.index}))},this.PROMO_CARD_DELAY_COLLECT),_collectPromoCards:function(t){this._promoCards.push(t),this._debouncedTriggerPromoCards()},_writeCacheTtlToCookie:function(t){var e=Number(t&&t.ttl),i=Number(this.params.timestamp);if(e&&i){var n={};n.cach=i+e,window.Ya&&window.Ya.ycCookie&&window.Ya.ycCookie.set("zen",n)}},_rows:[],_createZen:function(t){var e={api:"1096","js-chunk":"628",css:"2447","react-chunk":"2953"},i=window.YandexZen.loader;return this.params.usePreload&&i.preload(t),i.on("timings",function(t){if(this._timing){var i=this._timing;Object.keys(e).forEach(function(n){var s=t[n];s>-1&&Ya.Rum.sendDelta(e[n],s,i)})}},this),i.on("cachePut",this._writeCacheTtlToCookie,this),i.on("precacheMiss",function(){this._logError({name:"MordaZenLibError",message:"Precache missed",owner:"backend",sourceType:"logic"})},this),this._initialForcedDelay(500).then(this._waitIdleSearchMoment.bind(this,1e3)).then(function(){var e=i.create(t);return this._lateRenderingRace({loader:e,lagTime:1e4}),e}.bind(this)).then(function(t){return this._waitIdleSearchMoment(1e3,!0).then(function(){return t})}.bind(this)).then(function(t){t.on("firstPaint",this._triggerFirstPaint,this),t.on("promoCard",this._collectPromoCards,this),t.on("stat",this._onZenStatData,this),t.on("placeholder",function(t){this.trigger("placeholder",t)},this),t.on("placeholderShow",function(t){this.trigger("placeholderShow",t)},this),t.on("rowsChanged",function(t){this._rows=t,this.trigger("rowsChanged",t)},this),t.on("cachePut",this._writeCacheTtlToCookie,this),t.render(this.elem("container")[0]),this.setMod("state","loaded")}.bind(this)).catch(function(t){this.trigger("error"),this.setMod("state","retry"),this._logError(t)}.bind(this))},_lateRenderingRace:function(t){var e=(t=t||{}).loader,i=t.lagTime,n=new Promise(function(t){setTimeout(t,i,i)});return Promise.race([e,n]).then(function(t){t===i&&this.trigger("lateRendering")}.bind(this))},_onZenStatData:function(t){var e={show:"show",click:"click",counter_click:"click",counter_show:"show"},i=t&&t.statMeta&&t.statMeta.rowIndex;if(!this._rows||!this._rows.length||"Placeholder"!==this._rows[i]){var n=t.eventName.split("#")[0],s=n.split(":"),o=s[0],r=s[1];"click"===o&&this.trigger("click");var a="number"==typeof i&&i<50?this.params.statRoot+".row"+i:this.params.statRoot;e[o]?home.stat.logPath(e[o],a+".card"):r&&e[r]?home.stat.logPath(e[r],a+"."+o):home.stat.logPath("click",a+"."+n.replace(":","_"))}},_injectZen:function(t){return new Promise(function(e,i){var n=t.pathToLoader,s=document.createElement("script");s.src=n,s.onload=function(){e(t)},document.body.appendChild(s),setTimeout(function(){i(new Error("_injectZen: Unreachable Zen loader"))},5e3)})},_logError:function(t){var e=t.name,i=t.message;home.error.logError({block:"zen_lib"+(this.params.blockerror_adblock?"_adblock":""),message:e||i?e+" "+i:"UNKNOWN_ERROR"+JSON.stringify(t),sourceType:t.sourceType,source:t.owner})}}),BEM.DOM.decl("zen-lib",{_runIncludedLoader:function(){!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=127)}([function(t,e,i){var n=i(63)("wks"),s=i(32),o=i(1).Symbol,r="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=r&&o[t]||(r?o:s)("Symbol."+t))}).store=n},function(t,e){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,i){for(var n=i(10),s=i(24),o=i(11),r=i(1),a=i(14),c=i(30),l=i(0),h=l("iterator"),u=l("toStringTag"),d=c.Array,m={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=s(m),f=0;f<p.length;f++){var _,g=p[f],v=m[g],b=r[g],y=b&&b.prototype;if(y&&(y[h]||a(y,h,d),y[u]||a(y,u,g),c[g]=d,v))for(_ in n)y[_]||o(y,_,n[_],!0)}},function(t,e,i){var n=i(7);n(n.S+n.F,"Object",{assign:i(116)})},function(t,e,i){t.exports=!i(2)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,i){var n=i(9),s=i(82),o=i(38),r=Object.defineProperty;e.f=i(5)?Object.defineProperty:function(t,e,i){if(n(t),e=o(e,!0),n(i),s)try{return r(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){var n=i(1),s=i(16),o=i(14),r=i(11),a=i(18),c=function(t,e,i){var l,h,u,d,m=t&c.F,p=t&c.G,f=t&c.S,_=t&c.P,g=t&c.B,v=p?n:f?n[e]||(n[e]={}):(n[e]||{}).prototype,b=p?s:s[e]||(s[e]={}),y=b.prototype||(b.prototype={});for(l in p&&(i=e),i)u=((h=!m&&v&&void 0!==v[l])?v:i)[l],d=g&&h?a(u,n):_&&"function"==typeof u?a(Function.call,u):u,v&&r(v,l,u,t&c.U),b[l]!=u&&o(b,l,d),_&&y[l]!=u&&(y[l]=u)};n.core=s,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){var n=i(8);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,i){"use strict";var n=i(71),s=i(70),o=i(30),r=i(23);t.exports=i(50)(Array,"Array",function(t,e){this._t=r(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,s(1)):s(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e,i){var n=i(1),s=i(14),o=i(13),r=i(32)("src"),a=Function.toString,c=(""+a).split("toString");i(16).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,i,a){var l="function"==typeof i;l&&(o(i,"name")||s(i,"name",e)),t[e]!==i&&(l&&(o(i,r)||s(i,r,t[e]?""+t[e]:c.join(String(e)))),t===n?t[e]=i:a?t[e]?t[e]=i:s(t,e,i):(delete t[e],s(t,e,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[r]||a.call(this)})},function(t,e,i){"use strict";var n,s,o,r,a=i(34),c=i(1),l=i(18),h=i(83),u=i(7),d=i(8),m=i(33),p=i(61),f=i(60),_=i(123),g=i(78).set,v=i(121)(),b=i(76),y=i(120),w=i(119),k=i(118),E=c.TypeError,M=c.process,x=M&&M.versions,T=x&&x.v8||"",S=c.Promise,C="process"==h(M),I=function(){},P=s=b.f,B=!!function(){try{var t=S.resolve(1),e=(t.constructor={})[i(0)("species")]=function(t){t(I,I)};return(C||"function"==typeof PromiseRejectionEvent)&&t.then(I)instanceof e&&0!==T.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),D=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},O=function(t,e){if(!t._n){t._n=!0;var i=t._c;v(function(){for(var n=t._v,s=1==t._s,o=0,r=function(e){var i,o,r,a=s?e.ok:e.fail,c=e.resolve,l=e.reject,h=e.domain;try{a?(s||(2==t._h&&j(t),t._h=1),!0===a?i=n:(h&&h.enter(),i=a(n),h&&(h.exit(),r=!0)),i===e.promise?l(E("Promise-chain cycle")):(o=D(i))?o.call(i,c,l):c(i)):l(n)}catch(t){h&&!r&&h.exit(),l(t)}};i.length>o;)r(i[o++]);t._c=[],t._n=!1,e&&!t._h&&A(t)})}},A=function(t){g.call(c,function(){var e,i,n,s=t._v,o=R(t);if(o&&(e=y(function(){C?M.emit("unhandledRejection",s,t):(i=c.onunhandledrejection)?i({promise:t,reason:s}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",s)}),t._h=C||R(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},R=function(t){return 1!==t._h&&0===(t._a||t._c).length},j=function(t){g.call(c,function(){var e;C?M.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})})},L=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),O(e,!0))},F=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw E("Promise can't be resolved itself");(e=D(t))?v(function(){var n={_w:i,_d:!1};try{e.call(t,l(F,n,1),l(L,n,1))}catch(t){L.call(n,t)}}):(i._v=t,i._s=1,O(i,!1))}catch(t){L.call({_w:i,_d:!1},t)}}};B||(S=function(t){p(this,S,"Promise","_h"),m(t),n.call(this);try{t(l(F,this,1),l(L,this,1))}catch(t){L.call(this,t)}},(n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(57)(S.prototype,{then:function(t,e){var i=P(_(this,S));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=C?M.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&O(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=l(F,t,1),this.reject=l(L,t,1)},b.f=P=function(t){return t===S||t===r?new o(t):s(t)}),u(u.G+u.W+u.F*!B,{Promise:S}),i(29)(S,"Promise"),i(56)("Promise"),r=i(16).Promise,u(u.S+u.F*!B,"Promise",{reject:function(t){var e=P(this);return(0,e.reject)(t),e.promise}}),u(u.S+u.F*(a||!B),"Promise",{resolve:function(t){return k(a&&this===r?S:this,t)}}),u(u.S+u.F*!(B&&i(55)(function(t){S.all(t).catch(I)})),"Promise",{all:function(t){var e=this,i=P(e),n=i.resolve,s=i.reject,o=y(function(){var i=[],o=0,r=1;f(t,!1,function(t){var a=o++,c=!1;i.push(void 0),r++,e.resolve(t).then(function(t){c||(c=!0,i[a]=t,--r||n(i))},s)}),--r||n(i)});return o.e&&s(o.v),i.promise},race:function(t){var e=this,i=P(e),n=i.reject,s=y(function(){f(t,!1,function(t){e.resolve(t).then(i.resolve,n)})});return s.e&&n(s.v),i.promise}})},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e,i){var n=i(6),s=i(31);t.exports=i(5)?function(t,e,i){return n.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var i=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=i)},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e,i){var n=i(33);t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)}}return function(){return t.apply(e,arguments)}}},function(t,e,i){var n=i(117);function s(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function o(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},i=t.name||"Function wrapped with `once`";return e.onceError=i+" shouldn't be called more than once",e.called=!1,e}t.exports=n(s),t.exports.strict=n(o),s.proto=s(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return s(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(t,e){e.desktop_supported_browsers=[{browser_base:"Chromium",min_browser_base_version:"55",build_name:"chromium"},{browser_base:"Chrome",min_browser_base_version:"55",build_name:"chromium"},{browser_name:"Firefox",min_browser_version:"51",build_name:"firefox"},{browser_name:"YandexBrowser",min_browser_version:"17.1",build_name:"chromium"},{browser_name:"MSIE",min_browser_version:"11",build_name:"legacy"},{browser_name:"Edge",min_browser_version:"13",build_name:"edge"},{browser_name:"Edge",min_browser_version:"12",build_name:"legacy"},{browser_base:"Chromium",min_browser_base_version:"42",build_name:"legacy"},{browser_name:"Firefox",min_browser_version:"45",build_name:"legacy"},{browser_name:"Safari",min_browser_version:"9",build_name:"legacy"}],e.mobile_supported_browsers=[{os_name:"iOS",os_min_version:"7",build_name:"legacy"},{os_name:"Android",os_min_version:"4.4",build_name:"legacy"}],e.tablet_supported_browsers=[{os_name:"iOS",os_min_version:"7",build_name:"legacy"},{os_name:"Android",os_min_version:"4.4",build_name:"legacy"}]},function(t,e){t.exports={NAMESPACE:"YandexZen"}},function(t,e,i){var n=i(28),s=i(24);i(105)("keys",function(){return function(t){return s(n(t))}})},function(t,e,i){var n=i(74),s=i(15);t.exports=function(t){return n(s(t))}},function(t,e,i){var n=i(75),s=i(53);t.exports=Object.keys||function(t){return n(t,s)}},function(t,e,i){"use strict";var n=i(109)(!0);i(50)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=n(e,i),this._i+=t.length,{value:t,done:!1})})},function(t,e,i){"use strict";i(113);var n=i(9),s=i(51),o=i(5),r=/./.toString,a=function(t){i(11)(RegExp.prototype,"toString",t,!0)};i(2)(function(){return"/a/b"!=r.call({source:"a",flags:"b"})})?a(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?s.call(t):void 0)}):"toString"!=r.name&&a(function(){return r.call(this)})},function(t,e){!function(e){"use strict";var i,n=Object.prototype,s=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag",l="object"==typeof t,h=e.regeneratorRuntime;if(h)l&&(t.exports=h);else{(h=e.regeneratorRuntime=l?t.exports:{}).wrap=y;var u="suspendedStart",d="suspendedYield",m="executing",p="completed",f={},_={};_[r]=function(){return this};var g=Object.getPrototypeOf,v=g&&g(g(B([])));v&&v!==n&&s.call(v,r)&&(_=v);var b=M.prototype=k.prototype=Object.create(_);E.prototype=b.constructor=M,M.constructor=E,M[c]=E.displayName="GeneratorFunction",h.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},h.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,M):(t.__proto__=M,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(b),t},h.awrap=function(t){return{__await:t}},x(T.prototype),T.prototype[a]=function(){return this},h.AsyncIterator=T,h.async=function(t,e,i,n){var s=new T(y(t,e,i,n));return h.isGeneratorFunction(e)?s:s.next().then(function(t){return t.done?t.value:s.next()})},x(b),b[c]="Generator",b[r]=function(){return this},b.toString=function(){return"[object Generator]"},h.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},h.values=B,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=i)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,s){return a.type="throw",a.arg=t,e.next=n,s&&(e.method="next",e.arg=i),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var c=s.call(r,"catchLoc"),l=s.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var r=o?o.completion:{};return r.type=t,r.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(r)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),I(i),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var s=n.arg;I(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:B(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=i),f}}}function y(t,e,i,n){var s=e&&e.prototype instanceof k?e:k,o=Object.create(s.prototype),r=new P(n||[]);return o._invoke=function(t,e,i){var n=u;return function(s,o){if(n===m)throw new Error("Generator is already running");if(n===p){if("throw"===s)throw o;return D()}for(i.method=s,i.arg=o;;){var r=i.delegate;if(r){var a=S(r,i);if(a){if(a===f)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===u)throw n=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=m;var c=w(t,e,i);if("normal"===c.type){if(n=i.done?p:d,c.arg===f)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=p,i.method="throw",i.arg=c.arg)}}}(t,i,r),o}function w(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function k(){}function E(){}function M(){}function x(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function T(t){var e;this._invoke=function(i,n){function o(){return new Promise(function(e,o){!function e(i,n,o,r){var a=w(t[i],t,n);if("throw"!==a.type){var c=a.arg,l=c.value;return l&&"object"==typeof l&&s.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,o,r)},function(t){e("throw",t,o,r)}):Promise.resolve(l).then(function(t){c.value=t,o(c)},r)}r(a.arg)}(i,n,e,o)})}return e=e?e.then(o,o):o()}}function S(t,e){var n=t.iterator[e.method];if(n===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=i,S(t,e),"throw"===e.method))return f;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var s=w(n,t.iterator,e.arg);if("throw"===s.type)return e.method="throw",e.arg=s.arg,e.delegate=null,f;var o=s.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=i),e.delegate=null,f):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function B(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(s.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=i,e.done=!0,e};return o.next=o}}return{next:D}}function D(){return{value:i,done:!0}}}(function(){return this}()||Function("return this")())},function(t,e,i){var n=i(15);t.exports=function(t){return Object(n(t))}},function(t,e,i){var n=i(6).f,s=i(13),o=i(0)("toStringTag");t.exports=function(t,e,i){t&&!s(t=i?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e){t.exports={}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++i+n).toString(36))}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=!1},function(t,e,i){var n=i(75),s=i(53).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,s)}},function(t,e,i){var n=i(9),s=i(111),o=i(53),r=i(54)("IE_PROTO"),a=function(){},c=function(){var t,e=i(62)("iframe"),n=o.length;for(e.style.display="none",i(77).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;n--;)delete c.prototype[o[n]];return c()};t.exports=Object.create||function(t,e){var i;return null!==t?(a.prototype=n(t),i=new a,a.prototype=null,i[r]=t):i=c(),void 0===e?i:s(i,e)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,i){var n=i(8);t.exports=function(t,e){if(!n(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!n(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},function(t,e,i){var n={WHITE:"white-background",LIGHT:"white",DARK:"black"},s={no_amp_links:!0,forced_bulk_stats:!0,blurred_preview:!0,big_card_images:!0,complaints_with_reasons:!0,pass_experiments:!0,video_providers:["yandex-web","youtube","youtube-web"],screen:{dpi:241},need_background_image:!0,color_theme:n.LIGHT,no_small_auth:!0,need_main_color:!0,need_zen_one_data:!0,interests_supported:!0,return_sources:!0,screens:["feed","category","categories","profile","switchable_subs","suggest","blocked","preferences","blocked_suggest","video_recommend","language","comments_counter"],stat_params_with_context:!0};t.exports={REZEN_COLOR_THEMES:n,DEFAULT_REZEN_ZEN_FEATURES:s}},function(t,e,i){var n=i(8);t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,i){var n=i(32)("meta"),s=i(8),o=i(13),r=i(6).f,a=0,c=Object.isExtensible||function(){return!0},l=!i(2)(function(){return c(Object.preventExtensions({}))}),h=function(t){r(t,n,{value:{i:"O"+ ++a,w:{}}})},u=t.exports={KEY:n,NEED:!1,fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,n)){if(!c(t))return"F";if(!e)return"E";h(t)}return t[n].i},getWeak:function(t,e){if(!o(t,n)){if(!c(t))return!0;if(!e)return!1;h(t)}return t[n].w},onFreeze:function(t){return l&&u.NEED&&c(t)&&!o(t,n)&&h(t),t}}},function(t,e,i){var n=i(37),s=i(31),o=i(23),r=i(38),a=i(13),c=i(82),l=Object.getOwnPropertyDescriptor;e.f=i(5)?l:function(t,e){if(t=o(t),e=r(e,!0),c)try{return l(t,e)}catch(t){}if(a(t,e))return s(!n.f.call(t,e),t[e])}},function(t,e,i){var n=i(8),s=i(101).set;t.exports=function(t,e,i){var o,r=e.constructor;return r!==i&&"function"==typeof r&&(o=r.prototype)!==i.prototype&&n(o)&&s&&s(t,o),t}},function(t,e,i){i(49)("match",1,function(t,e,i){return[function(i){"use strict";var n=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,n):new RegExp(i)[e](String(n))},i]})},function(t,e,i){i(49)("split",2,function(t,e,n){"use strict";var s=i(46),o=n,r=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var a=void 0===/()??/.exec("")[1];n=function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!s(t))return o.call(i,t,e);var n,c,l,h,u,d=[],m=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,f=void 0===e?4294967295:e>>>0,_=new RegExp(t.source,m+"g");for(a||(n=new RegExp("^"+_.source+"$(?!\\s)",m));(c=_.exec(i))&&!((l=c.index+c[0].length)>p&&(d.push(i.slice(p,c.index)),!a&&c.length>1&&c[0].replace(n,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(c[u]=void 0)}),c.length>1&&c.index<i.length&&r.apply(d,c.slice(1)),h=c[0].length,p=l,d.length>=f));)_.lastIndex===c.index&&_.lastIndex++;return p===i.length?!h&&_.test("")||d.push(""):d.push(i.slice(p)),d.length>f?d.slice(0,f):d}}else"0".split(void 0,0).length&&(n=function(t,e){return void 0===t&&0===e?[]:o.call(this,t,e)});return[function(i,s){var o=t(this),r=void 0==i?void 0:i[e];return void 0!==r?r.call(i,o,s):n.call(String(o),i,s)},n]})},function(t,e,i){var n=i(8),s=i(17),o=i(0)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==s(t))}},function(t,e,i){"use strict";var n=i(7),s=i(107);n(n.P+n.F*i(106)("includes"),"String",{includes:function(t){return!!~s(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,i){"use strict";var n=i(7),s=i(73)(!0);n(n.P,"Array",{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),i(71)("includes")},function(t,e,i){"use strict";var n=i(14),s=i(11),o=i(2),r=i(15),a=i(0);t.exports=function(t,e,i){var c=a(t),l=i(r,c,""[t]),h=l[0],u=l[1];o(function(){var e={};return e[c]=function(){return 7},7!=""[t](e)})&&(s(String.prototype,t,h),n(RegExp.prototype,c,2==e?function(t,e){return u.call(t,this,e)}:function(t){return u.call(t,this)}))}},function(t,e,i){"use strict";var n=i(34),s=i(7),o=i(11),r=i(14),a=i(30),c=i(112),l=i(29),h=i(110),u=i(0)("iterator"),d=!([].keys&&"next"in[].keys()),m=function(){return this};t.exports=function(t,e,i,p,f,_,g){c(i,e,p);var v,b,y,w=function(t){if(!d&&t in x)return x[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},k=e+" Iterator",E="values"==f,M=!1,x=t.prototype,T=x[u]||x["@@iterator"]||f&&x[f],S=T||w(f),C=f?E?w("entries"):S:void 0,I="Array"==e&&x.entries||T;if(I&&(y=h(I.call(new t)))!==Object.prototype&&y.next&&(l(y,k,!0),n||"function"==typeof y[u]||r(y,u,m)),E&&T&&"values"!==T.name&&(M=!0,S=function(){return T.call(this)}),n&&!g||!d&&!M&&x[u]||r(x,u,S),a[e]=S,a[k]=m,f)if(v={values:E?S:w("values"),keys:_?S:w("keys"),entries:C},g)for(b in v)b in x||o(x,b,v[b]);else s(s.P+s.F*(d||M),e,v);return v}},function(t,e,i){"use strict";var n=i(9);t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,i){var n=i(63)("keys"),s=i(32);t.exports=function(t){return n[t]||(n[t]=s(t))}},function(t,e,i){var n=i(0)("iterator"),s=!1;try{var o=[7][n]();o.return=function(){s=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var i=!1;try{var o=[7],r=o[n]();r.next=function(){return{done:i=!0}},o[n]=function(){return r},t(o)}catch(t){}return i}},function(t,e,i){"use strict";var n=i(1),s=i(6),o=i(5),r=i(0)("species");t.exports=function(t){var e=n[t];o&&e&&!e[r]&&s.f(e,r,{configurable:!0,get:function(){return this}})}},function(t,e,i){var n=i(11);t.exports=function(t,e,i){for(var s in e)n(t,s,e[s],i);return t}},function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},function(t,e,i){var n=i(58),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},function(t,e,i){var n=i(18),s=i(81),o=i(80),r=i(9),a=i(59),c=i(79),l={},h={};(e=t.exports=function(t,e,i,u,d){var m,p,f,_,g=d?function(){return t}:c(t),v=n(i,u,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(m=a(t.length);m>b;b++)if((_=e?v(r(p=t[b])[0],p[1]):v(t[b]))===l||_===h)return _}else for(f=g.call(t);!(p=f.next()).done;)if((_=s(f,v,p.value,e))===l||_===h)return _}).BREAK=l,e.RETURN=h},function(t,e){t.exports=function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!");return t}},function(t,e,i){var n=i(8),s=i(1).document,o=n(s)&&n(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},function(t,e,i){var n=i(16),s=i(1),o=s["__core-js_shared__"]||(s["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:i(34)?"pure":"global",copyright:" 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,i){"use strict";t.exports=function t(e,i){if(e===i)return!0;var n,s=Array.isArray(e),o=Array.isArray(i);if(s&&o){if(e.length!=i.length)return!1;for(n=0;n<e.length;n++)if(!t(e[n],i[n]))return!1;return!0}if(s!=o)return!1;if(e&&i&&"object"==typeof e&&"object"==typeof i){var r=Object.keys(e);if(r.length!==Object.keys(i).length)return!1;var a=e instanceof Date,c=i instanceof Date;if(a&&c)return e.getTime()==i.getTime();if(a!=c)return!1;var l=e instanceof RegExp,h=i instanceof RegExp;if(l&&h)return e.toString()==i.toString();if(l!=h)return!1;for(n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(i,r[n]))return!1;for(n=0;n<r.length;n++)if(!t(e[r[n]],i[r[n]]))return!1;return!0}return!1}},function(t,e,i){e.f=i(0)},function(t,e,i){var n=i(1),s=i(16),o=i(34),r=i(65),a=i(6).f;t.exports=function(t){var e=s.Symbol||(s.Symbol=o?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:r.f(t)})}},function(t,e,i){"use strict";var n=i(1),s=i(7),o=i(11),r=i(57),a=i(41),c=i(60),l=i(61),h=i(8),u=i(2),d=i(55),m=i(29),p=i(43);t.exports=function(t,e,i,f,_,g){var v=n[t],b=v,y=_?"set":"add",w=b&&b.prototype,k={},E=function(t){var e=w[t];o(w,t,"delete"==t?function(t){return!(g&&!h(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!h(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!h(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,i){return e.call(this,0===t?0:t,i),this})};if("function"==typeof b&&(g||w.forEach&&!u(function(){(new b).entries().next()}))){var M=new b,x=M[y](g?{}:-0,1)!=M,T=u(function(){M.has(1)}),S=d(function(t){new b(t)}),C=!g&&u(function(){for(var t=new b,e=5;e--;)t[y](e,e);return!t.has(-0)});S||((b=e(function(e,i){l(e,b,t);var n=p(new v,e,b);return void 0!=i&&c(i,_,n[y],n),n})).prototype=w,w.constructor=b),(T||C)&&(E("delete"),E("has"),_&&E("get")),(C||x)&&E(y),g&&w.clear&&delete w.clear}else b=f.getConstructor(e,t,_,y),r(b.prototype,i),a.NEED=!0;return m(b,t),k[t]=b,s(s.G+s.W+s.F*(b!=v),k),g||f.setStrong(b,t,_),b}},function(t,e,i){"use strict";var n=i(6).f,s=i(36),o=i(57),r=i(18),a=i(61),c=i(60),l=i(50),h=i(70),u=i(56),d=i(5),m=i(41).fastKey,p=i(40),f=d?"_s":"size",_=function(t,e){var i,n=m(e);if("F"!==n)return t._i[n];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,l){var h=t(function(t,n){a(t,h,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[f]=0,void 0!=n&&c(n,i,t[l],t)});return o(h.prototype,{clear:function(){for(var t=p(this,e),i=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];t._f=t._l=void 0,t[f]=0},delete:function(t){var i=p(this,e),n=_(i,t);if(n){var s=n.n,o=n.p;delete i._i[n.i],n.r=!0,o&&(o.n=s),s&&(s.p=o),i._f==n&&(i._f=s),i._l==n&&(i._l=o),i[f]--}return!!n},forEach:function(t){p(this,e);for(var i,n=r(t,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(t){return!!_(p(this,e),t)}}),d&&n(h.prototype,"size",{get:function(){return p(this,e)[f]}}),h},def:function(t,e,i){var n,s,o=_(t,e);return o?o.v=i:(t._l=o={i:s=m(e,!0),k:e,v:i,p:n=t._l,n:void 0,r:!1},t._f||(t._f=o),n&&(n.n=o),t[f]++,"F"!==s&&(t._i[s]=o)),t},getEntry:_,setStrong:function(t,e,i){l(t,e,function(t,i){this._t=p(t,e),this._k=i,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?h(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,h(1))},i?"entries":"values",!i,!0),u(e)}}},function(t,e,i){var n=i(6).f,s=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in s||i(5)&&n(s,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,i){var n=i(0)("unscopables"),s=Array.prototype;void 0==s[n]&&i(14)(s,n,{}),t.exports=function(t){s[n][t]=!0}},function(t,e,i){"use strict";i(114)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,i){var n=i(23),s=i(59),o=i(115);t.exports=function(t){return function(e,i,r){var a,c=n(e),l=s(c.length),h=o(r,l);if(t&&i!=i){for(;l>h;)if((a=c[h++])!=a)return!0}else for(;l>h;h++)if((t||h in c)&&c[h]===i)return t||h||0;return!t&&-1}}},function(t,e,i){var n=i(17);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,i){var n=i(13),s=i(23),o=i(73)(!1),r=i(54)("IE_PROTO");t.exports=function(t,e){var i,a=s(t),c=0,l=[];for(i in a)i!=r&&n(a,i)&&l.push(i);for(;e.length>c;)n(a,i=e[c++])&&(~o(l,i)||l.push(i));return l}},function(t,e,i){"use strict";var n=i(33);t.exports.f=function(t){return new function(t){var e,i;this.promise=new t(function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n}),this.resolve=n(e),this.reject=n(i)}(t)}},function(t,e,i){var n=i(1).document;t.exports=n&&n.documentElement},function(t,e,i){var n,s,o,r=i(18),a=i(122),c=i(77),l=i(62),h=i(1),u=h.process,d=h.setImmediate,m=h.clearImmediate,p=h.MessageChannel,f=h.Dispatch,_=0,g={},v=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},b=function(t){v.call(t.data)};d&&m||(d=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return g[++_]=function(){a("function"==typeof t?t:Function(t),e)},n(_),_},m=function(t){delete g[t]},"process"==i(17)(u)?n=function(t){u.nextTick(r(v,t,1))}:f&&f.now?n=function(t){f.now(r(v,t,1))}:p?(o=(s=new p).port2,s.port1.onmessage=b,n=r(o.postMessage,o,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(n=function(t){h.postMessage(t+"","*")},h.addEventListener("message",b,!1)):n="onreadystatechange"in l("script")?function(t){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),v.call(t)}}:function(t){setTimeout(r(v,t,1),0)}),t.exports={set:d,clear:m}},function(t,e,i){var n=i(83),s=i(0)("iterator"),o=i(30);t.exports=i(16).getIteratorMethod=function(t){if(void 0!=t)return t[s]||t["@@iterator"]||o[n(t)]}},function(t,e,i){var n=i(30),s=i(0)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[s]===t)}},function(t,e,i){var n=i(9);t.exports=function(t,e,i,s){try{return s?e(n(i)[0],i[1]):e(i)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,i){t.exports=!i(5)&&!i(2)(function(){return 7!=Object.defineProperty(i(62)("div"),"a",{get:function(){return 7}}).a})},function(t,e,i){var n=i(17),s=i(0)("toStringTag"),o="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,i,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?i:o?n(e):"Object"==(r=n(e))&&"function"==typeof e.callee?"Arguments":r}},function(t,e,i){"use strict";i.r(e);var n="function"==typeof fetch?fetch.bind():function(t,e){return e=e||{},new Promise(function(i,n){var s=new XMLHttpRequest;for(var o in s.open(e.method||"get",t),e.headers)s.setRequestHeader(o,e.headers[o]);function r(){var t,e=[],i=[],n={};return s.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(s,o,r){e.push(o=o.toLowerCase()),i.push([o,r]),t=n[o],n[o]=t?t+","+r:r}),{ok:1==(s.status/200|0),status:s.status,statusText:s.statusText,url:s.responseURL,clone:r,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},headers:{keys:function(){return e},entries:function(){return i},get:function(t){return n[t.toLowerCase()]},has:function(t){return t.toLowerCase()in n}}}}s.withCredentials="include"==e.credentials,s.onload=function(){i(r())},s.onerror=n,s.send(e.body)})};e.default=n},function(t,e,i){var n,s,o;void 0===(s="function"==typeof(n=o=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}return function e(i){function n(e,s,o){var r;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(o=t({path:"/"},n.defaults,o)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*o.expires),o.expires=a}o.expires=o.expires?o.expires.toUTCString():"";try{r=JSON.stringify(s),/^[\{\[]/.test(r)&&(s=r)}catch(t){}s=i.write?i.write(s,e):encodeURIComponent(String(s)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(String(e))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var c="";for(var l in o)o[l]&&(c+="; "+l,!0!==o[l]&&(c+="="+o[l]));return document.cookie=e+"="+s+c}e||(r={});for(var h=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,d=0;d<h.length;d++){var m=h[d].split("="),p=m.slice(1).join("=");this.json||'"'!==p.charAt(0)||(p=p.slice(1,-1));try{var f=m[0].replace(u,decodeURIComponent);if(p=i.read?i.read(p,f):i(p,f)||p.replace(u,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(t){}if(e===f){r=p;break}e||(r[f]=p)}catch(t){}}return r}}return n.set=n,n.get=function(t){return n.call(n,t)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(e,i){n(e,"",t(i,{expires:-1}))},n.withConverter=e,n}(function(){})})?n.call(e,i,e,t):n)||(t.exports=s),t.exports=o()},function(t,e,i){"use strict";i.r(e),i(12);var n=function(t,e){return t===e},s=i(19),o=i.n(s);function r(t,e,i,n,s,o,r){try{var a=t[o](r),c=a.value}catch(t){return void i(t)}a.done?e(c):Promise.resolve(c).then(n,s)}function a(t){return function(){var e=this,i=arguments;return new Promise(function(n,s){var o=t.apply(e,i);function a(t){r(o,n,s,a,c,"next",t)}function c(t){r(o,n,s,a,c,"throw",t)}a(void 0)})}}function c(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}i(4),i(72),i(27),i(26),i(3);var l,h=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e,i){this._events[t]||(this._events[t]=[]),this._events[t].push({listener:e,context:i})},e.off=function(t,e){if(this._events[t])for(var i=this._events[t],n=i.length,s=0;s<n;s++)if(i[s].listener===e)return void i.splice(s,1)},e.once=function(t,e,i){var n=this;this.on(t,e,i),this.on(t,function i(){n.off(t,e),n.off(t,i)})},e.addListener=function(){return this.on.apply(this,arguments)},e.removeListener=function(){return this.off.apply(this,arguments)},e.emit=function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];this._events[t]&&this._events[t].slice().forEach(function(t){var e=t.listener,n=t.context;e.apply(n,i)})},t}(),u=((l={}).error=!0,l.warn=!0,l.log=!0,l),d=new function(t,e){var i=this;void 0===t&&(t={}),this._namespace="zenLogger",this._eventEmitter=new h,this.configure=function(t){void 0===t&&(t={}),i._config=Object.assign({},i._config,t)},this._defaultLogger=function(t,e){var n;if("error"===t)(n=console).error.apply(n,[i._namespace+":"].concat(e));else if("warn"===t){var s;(s=console).warn.apply(s,[i._namespace+":"].concat(e))}else if("log"===t){var o;(o=console).log.apply(o,[i._namespace+":"].concat(e))}},this._loggerProxy=function(t,e){i._eventEmitter.emit(t,e),!0===i._config[t]&&i._defaultLogger(t,e)},this.error=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];i._loggerProxy("error",e)},this.warn=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];i._loggerProxy("warn",e)},this.log=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];i._loggerProxy("log",e)},this.removeListener=function(t,e){void 0===e&&(e=["log","warn","error"]),e.forEach(function(e){i._eventEmitter.removeListener(e,t)})},this.addListener=function(t,e){return void 0===e&&(e=["log","warn","error"]),e.forEach(function(e){i._eventEmitter.addListener(e,t)}),function(){return i.removeListener(t,e)}},this._config=Object.assign({},u,t)};function m(t,e){if(null==t)return{};var i,n,s={},o=Object.keys(t);for(n=0;n<o.length;n++)i=o[n],e.indexOf(i)>=0||(s[i]=t[i]);return s}i(10),i(25),i(108),i(48),i(47),i(22),i(45),i(44);var p,f,_,g,v=/[?&]([^&#]*)/,b=function(t,e){var i=Object.assign({},function(t){var e={},i=t.indexOf("?");if(-1===i)return e;for(var n=i;;){var s=t.slice(n).match(v);if(!s)break;n+=s[0].length;var o=s[1].split("="),r=o[0],a=o[1],c=void 0===a?"":a;r&&(e[decodeURIComponent(r)]=decodeURIComponent(c))}return e}(t),e),n=t.indexOf("?"),s=t.indexOf("#"),o=-1!==s?s:t.length,r=-1!==n?n:o;return t.slice(0,r)+function(t){var e=Object.keys(t);return 0===e.length?"":e.reduce(function(e,i){return i&&void 0!==t[i]?e+(0===e.length?"?":"&")+encodeURIComponent(i)+"="+encodeURIComponent(t[i]):e},"")}(i)+t.slice(o)},y={timeouts:[5e3,1e4,15e3]},w=function(t,e){var i,n,s=function(t){i=Object.assign({},y,t)},o=function(e){var s,o,r,a=void 0===e?{}:e,c=a.args,l=a.timeouts,h=void 0===l?i.timeouts:l,u=a.withoutAction,m=void 0!==u&&u,p=a.withoutRetries,f=void 0!==p&&p,_=a.onTryComplete,g=void 0===_?function(t){if(t.isRejected)throw t.error;return t.value}:_,v=function(t){return"function"!=typeof t?function(){return t}:t}(c),b=function(t){return Array.isArray(t)?function(e){return e<t.length?t[e]:null}:"function"!=typeof t?function(){return t}:t}(h),y=0,w=!1,k=!1,E=function(){return s===n},M=function(){return!w&&!k},x=function(){return!f&&M()&&E()},T=function(){M()&&(o&&o(),k=!0)},S=function(){var e,i=v(y);return Array.isArray(i)?e=t.apply(void 0,i):(null!=i&&d.warn("Expected action arguments to be an array or null/undefined."),e=t()),e.then(function(t){return g({value:t,tryNumber:y,isFulfilled:!0,isRejected:!1,isLastSession:E,abortRetries:T})},function(t){return g({error:t,tryNumber:y,isFulfilled:!1,isRejected:!0,isLastSession:E,abortRetries:T})})},C=m?Promise.reject(new Error("Generated error by 'withoutAction' call.")):S(),I=(r=function(){w=!0},C.catch(function t(e){if(x()){var i=b(y);if("number"==typeof i)return y++,(n=i,new Promise(function(t,e){o=function(){o=null,e(new Error("Retries aborted."))},setTimeout(function(){o=null,t()},n)})).then(function(){if(x())return S().catch(t);throw e});null!=i&&d.warn("Expected action timeout to be a number or null/undefined.")}var n;throw e}).then(function(t){return r(),t},function(t){throw r(),t}));return n&&n.abortRetries(),n=s={actionResult:C,retriesResult:I,isLastSession:E,isInProgress:M,abortRetries:T}};s(e);var r=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return o({args:e})};return r.startSession=o,r.setOptions=s,r},k=i(64),E=i.n(k),M=function(t,e){for(var i=Object.keys(t),n={},s=0;s<i.length;s++){var o=i[s];-1===e.indexOf(o)&&(n[o]=t[o])}return n},x={},T={get:(g=a(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",x[e]);case 1:case"end":return t.stop()}},t,this)})),function(t){return g.apply(this,arguments)}),put:(_=a(regeneratorRuntime.mark(function t(e,i){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:x[e]=i;case 1:case"end":return t.stop()}},t,this)})),function(t,e){return _.apply(this,arguments)}),remove:(f=a(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:delete x[e];case 1:case"end":return t.stop()}},t,this)})),function(t){return f.apply(this,arguments)}),isEnabled:function(){return!0}},S="zen-db",C="zen-api-cache",I="undefined"!=typeof document&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB);function P(t,e){return(I?(p||(p=new Promise(function(t,e){var i=I.open(S,1);i.onerror=function(){e(i.error)},i.onupgradeneeded=function(){i.result.createObjectStore(C)},i.onsuccess=function(){t(i.result),i.result.onclose=function(){p=null}}})),p):Promise.reject(new Error("indexedDB is not supported."))).then(function(i){return new Promise(function(n,s){var o=i.transaction(C,t);o.oncomplete=function(){n()},o.onerror=function(){s(o.error)},e(o.objectStore(C))})})}var B,D,O,A,R=function(t){var e;return P("readonly",function(i){e=i.get(t)}).then(function(){return e.result})},j=function(t,e){return P("readwrite",function(i){i.put(e,t)})},L=function(t){return P("readwrite",function(e){e.delete(t)})},F={get:function(t){return R(t)},put:function(t,e){return j(t,e)},remove:function(t){return L(t)},isEnabled:function(){return"undefined"!=typeof document&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB)}},N=(i(69),i(104),i(102),Object.prototype.hasOwnProperty),$=function(t){return Array.isArray(t)?t.slice():Object.assign({},t)},H=function(t){return t&&"object"==typeof t},z=function(t,e){if(Array.isArray(t)){var i=Number(e),n=t.slice(0,i).concat(t.slice(i+1));return t.length!==n.length?n:null}var s=Object.assign({},t);return delete s[e],N.call(t,e)!==N.call(s,e)?s:null},W=function(t){var e=Number(t);if(!(String(e)===String(t)&&isFinite(e)&&e>=0&&Math.floor(e)===e))throw new Error("Key '"+t+"' is not an array index.")},U=function(t){var e="string"==typeof t?t.split("."):t;if(!Array.isArray(e))throw new Error("Expected the path to be a string or array.");if(0===e.length)throw new Error("Expected the path to have at least one item.");return e},V=function(t,e){for(var i=U(e),n=t,s=0;s<i.length;s++){var o=i[s];if(!H(n)||!N.call(n,o))return;n=n[o]}return n},q=function(t,e,i){if(!H(t))throw new Error("Value is not an object.");for(var n=U(e),s=$(t),o=s,r=!1,a=0;a<n.length;a++){var c=n[a],l=a===n.length-1;if(Array.isArray(o)&&W(c),l){var h=N.call(o,c),u=h?o[c]:void 0,d=o[c]="function"==typeof i?i(u):i;h&&Object.is(u,d)||(r=!0)}else if(N.call(o,c)){if(!H(o[c]))throw new Error("Value is not an object.");o=o[c]=$(o[c])}else o=o[c]={},r=!0}return r?s:t},K={get:V,set:q,del:function(t,e){if(!H(t))throw new Error("Value is not an object.");var i=U(e);if(1===i.length){var n=i[0];return z(t,n)||t}for(var s=$(t),o=s,r=!1,a=0;a<i.length-1;a++){var c=i[a],l=a===i.length-2;if(Array.isArray(o)&&W(c),!N.call(o,c))break;if(!H(o[c]))throw new Error("Value is not an object.");if(l){var h=i[a+1];(o[c]=z(o[c],h))&&(r=!0)}else o=o[c]=$(o[c])}return r?s:t},modify:function(t,e,i){return q(t,e,i(V(t,e)))}},G=(i(98),"card"),Y="direct",J="gif";function X(t){return void 0===t&&(t="item"),t+"_"+Math.random()*Date.now()}new Set(["similar","user-feedback-question"]),(A={}).one_column={columnCount:1,layoutableTypes:[G,J,Y,"hint_eula","iceboarding-grid","similar","magic_card","story"],availableSizes:(B={},B[G]=["small"],B[Y]=["small"],B.hint_eula=["small"],B["iceboarding-grid"]=["small"],B.similar=["small"],B.magic_card=["small"],B[J]=["small"],B.story=["small"],B["user-feedback-question"]=["small"],B),initialDisplayedRowsNumber:6,rowDisplayStep:8},A.two_column={columnCount:2,layoutableTypes:[],availableSizes:{}},A.two_column_small_cards={columnCount:2,layoutableTypes:[],availableSizes:(D={},D[G]=["small"],D[Y]=["small"],D.hint_eula=["small"],D["iceboarding-grid"]=["small"],D.similar=["small"],D.magic_card=["small"],D[J]=["small"],D.story=["small"],D["user-feedback-question"]=["small"],D)},A.three_column={columnCount:3},A.three_column_first_big={columnCount:3},A.common={layoutableTypes:[G,"post",Y,"magic_card",J,"story","card-placeholder"],availableSizes:(O={},O[G]=["small","big"],O.post=["small"],O[Y]=["small"],O.hint_eula=["free"],O["iceboarding-grid"]=["free"],O.similar=["free"],O.magic_card=["big"],O[J]=["small","big"],O.story=["small"],O["card-placeholder"]=["small","big"],O.placeholder=["free"],O["user-feedback-question"]=["free"],O.similar_interests=["free"],O),initialDisplayedRowsNumber:6,rowDisplayStep:9};function Z(t){return{id:t.id,ad:t.ad,domain:t.domain,domainTitle:t.domain_title,link:t.link,title:t.title||" ",text:t.text||" ",logo:t.logo,image:t.image,bigImage:t.big_card_image||t.image,blurredPreview:t.blurred_preview,cardColors:t.card_colors&&{card:t.card_colors.card,text:t.card_colors.text},mainColor:t.main_color,similarLink:t.similar.link,bulkParams:t.bulk_params,statEvents:t.stat_events,read:t.read,feedback:function(t){var e=t.feedback_info;return e&&e.is_liked?"liked":e&&e.is_disliked?"disliked":null}(t),feedLink:t.source.feed_link,source:tt(t.source),commentsDocumentId:t.comments_document_id,commentsLink:t.comments_link,badges:t.badges,creationTime:t.creation_time}}function Q(t){return t.image&&t.big_card_image,Object.assign({type:G,isPromoted:t.is_promoted,isPromoPublication:t.is_promo_publication,cardBackgroundImage:t.card_background_image,cardBackgroundWhiteImage:t.card_background_white_image,customUserFeedbackData:function(t){if(!t.custom_user_feedback_data)return null;try{return{questions:t.custom_user_feedback_data.questions.map(function(t){return{id:t.id,type:t.type,display_type:t.display_type,text:t.text,answers:t.answers.map(function(t){var e=t.id,i=t.type,n=t.text,s=t.stats;return{id:e,type:i,text:n,isChecked:!1,stats:{statEvents:s.stat_events,bulkParams:s.bulk_params}}})}})}}catch(t){return d.warn("Error parsing custom_user_feedback_data",t),null}}(t),rocket:!!t.zen_logo,pixels:t.pixels},Z(t))}var tt=function(t){var e=t.id,i=t.type,n=t.status,s=t.title,o=t.logo,r=t.logo_background_color,a=t.title_background_color,c=t.title_color,l=t.feed_link,h=t.feed_api_link;return{id:e,type:i,status:n,title:s,logo:o,subtitle:t.subtitle,description:t.description,subscribers:t.subscribers,logoBackgroundColor:r,titleBackgroundColor:a,titleColor:c,feedLink:l,feedApiLink:h,socialLinks:t.social_links}},et=function(t){return Object.assign({},tt(t.source),{statParams:st(t.stat_params)})},it=function(t){var e=t.link,i=t.preview,n=t.width,s=t.height,o={link:e,preview:i};return(n||s)&&(o.hasSize=!0,o.width=n,o.height=s),o},nt=function(t){return{hasSound:t.has_sound,heartbeatTimes:t.heartbeat_pos,id:t.id,loop:t.loop,player:t.player,provider:t.provider,userAgent:t.userAgent,additionalParams:t.additional_params,autoplay:t.autoplay}};function st(t){if(t)return Object.keys(t).reduce(function(e,i){var n,s=t[i],o=s.bulk_params,r=s.stat_events,a=s.links;return Object.assign({},e,((n={})[i]={bulkParams:o,statEvents:r,links:a},n))},{})}function ot(t){return t.image&&!t.big_card_image&&d.warn("no big_card_image",t),Object.assign({type:J,video:nt(t.video),stats:t.stats,statParams:st(t.stat_params)},Z(t))}function rt(t){if("direct"!==K.get(t,"items.0.provider")||!K.get(t,"items.0.content"))return d.error("Ad parsing error: "+JSON.stringify(t)),null;var e=t.items[0],i=e.content,n=e.stat_events,s=e.bulk_params,o=!1;if(i.image&&i.image.length){var r=i.image;r[1]/r[2]>4/3&&(o=!0)}return{id:X(Y),type:Y,url:i.url,showUrl:i.linkHead+i.linkTail,domain:i.domain,title:i.title||" ",text:i.body,age:i.age,warning:i.warning,image:i.image,isWideImage:o,statEvents:n,bulkParams:s}}function at(t){var e=t.source_id,i=t.image,n=t.background_color,s=t.text_color;return{id:e,image:i,name:t.name,textColor:s,textBackgroundColor:t.name_background_color,imageBackgroundColor:n}}var ct,lt=function(t){return t.items.map(et)},ht=function(t){return{link:t.link,title:t.title,image:t.image,name:t.name,statEvents:t.stat_events,bulkParams:t.bulk_params}},ut=function(t){return{externalUrl:t.external_url}},dt={"no-user":ut,"user-info":function(t){return{email:t.email,name:t.name,avatar:t.avatar}},"blocked-count":function(t){return{count:t.count,externalUrl:t.external_url}},language:function(t){return{country:t.country,externalUrl:t.external_url}},feedback:ut,eula:ut,logout:ut,video:function(t){return{statEvents:t.stat_events,bulkParams:t.bulk_params,disabled:t.disabled}},autoplay:function(){return{}}},mt={"no-user":"noUser","user-info":"userInfo","blocked-count":"blockedCount"},pt=function(t){return{id:X("similar"),type:"similar",items:function(e){var i=[],n=[],s=[],o=[];t.items.forEach(function(t){switch(t.type){case"channel":case"interest":s.push(et({source:t,stat_params:t.stat_params}));break;case"small_card":i.push(function(t){var e={title:t.title||" ",text:t.text||" ",link:t.link,domainTitle:t.domain_title,image:t.images&&t.images.horizontal,bulkParams:t.bulk_params,statEvents:t.stat_events,ad:t.ad,rocket:!!t.zen_logo,cardColors:null,mainColor:null,feedLink:t.source.feed_link,commentsDocumentId:t.comments_document_id,commentsLink:t.comments_link};return t.hasOwnProperty("card_colors")?e.cardColors=t.card_colors:t.hasOwnProperty("main_color")&&(e.mainColor=t.main_color),e}(t));break;case"ad":n.push(rt(t));break;case"rtb":o.push(t)}});var r=s.map(function(t){return t.id});return{docs:i,direct:n,sources:s,sourcesIds:r,rtb:o}}()}},ft=function(t){var e={};return Object.keys(t).forEach(function(i){e[i]={count:t[i]}}),e},_t=function(t){switch(t.type){case G:return Q(t);case"post":return c={type:"post",id:(e=t).id,style:(i=e.style,n=i.background,s=i.background_color,o=i.text_color,r=i.link_color,{background:it(n),backgroundColor:s,textColor:o,linkColor:r}),link:e.link,similarLink:e.similar_link,source:tt(e.source),pixels:e.pixels,bulkParams:e.bulk_params,statEvents:e.stat_events,ad:e.ad,commentsDocumentId:e.comments_document_id,commentsLink:e.comments_link,badges:e.badges},e.rich_text&&(c.richText={json:(a=e.rich_text).json,length:a.length}),e.image&&(c.image=it(e.image)),c.read=e.was_read,c.feedback=e.feedback_status,c.domainTitle=e.source.title,c;case J:return ot(t);case"ad":return rt(t);case"iceboarding-grid":return function(t){var e={id:X("iceboarding-grid"),type:t.type,sources:t.sources.map(at),stats:t.stats,moreButton:void 0,bulkParams:t.bulk_params,statEvents:t.stat_events};return t.more_button&&(e.moreButton={link:t.more_button.click}),e}(t);case"hint_eula":return function(t){return{id:t.id,type:t.type,link:t.link,bulkParams:t.bulk_params,statEvents:t.stat_events}}(t);case"story":return function(t){var e=Q(t);return e.type="story",e.isPromoNarrative="narrative_promo_text"===t.narrative_style,e}(t);case"card-placeholder":case"placeholder":return function(t){return{id:t.item_id.toString(),type:t.type,statEvents:t.stat_events,bulkParams:t.bulk_params}}(t);case"similar_interests":return function(t){return{id:t.id,type:t.type,title:t.title,items:t.items.map(function(t){return et({source:t,stat_params:t.stat_params})})}}(t);default:return d.warn("Unsupported doc type: "+t.type),null}var e,i,n,s,o,r,a,c},gt=function(t){var e=null;if(t.items){var i=t.items.reduce(function(e,i){if(i){var n=_t(i);n&&e.push(Object.assign({},n,{packId:t.rid}))}return e},[]);e=i.length>0?i:null}var n=null;t.interests_onboarding&&(n={sources:lt(t.interests_onboarding),statParams:st(t.interests_onboarding.stat_params)});var s=null;if(t.link_board){var o=t.link_board,r=o.items,a=o.groups,c=o.stat_params;s={sources:lt({items:r}),groups:a,statParams:st(c)}}return Object.assign({},t,{id:t.rid,receivedAt:t.received_at,ttl:1e3*t.ttl,storeTtl:1e3*t.store_ttl,source:t.sf,items:e,onboardingInterests:n,linkBoard:s,experimentsData:t.experiments_data||null,clientDefinition:t.client_definition||null})},vt=(i(85),"packShown"),bt=function(t){if(!t.items)throw new Error("Invalid api response to put in cache.")},yt=function(){function t(t,e){this._zenApi=t,this._eventEmitter=e}var e,i,n,s,o,r,c,l,h,u=t.prototype;return u._getStorage=function(){var t=this._zenApi.getConfig();if(t.cache)switch(t.cache.type){case"multiCacheStorage":if(F.isEnabled())return F;if(T.isEnabled())return T;break;case"cacheStorage":if(T.isEnabled())return T}throw new Error("ZenApi cache is not enabled.")},u._getRecordKey=function(t){var e=this._zenApi.getConfig(),i=e.cache&&e.cache.namespace;if(!i)throw new Error("ZenApi cache.namespace is not configured.");return i+"-"+t},u._get=(h=a(regeneratorRuntime.mark(function t(e,i){var n,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._getStorage(),s=this._getRecordKey(e),t.next=4,n.get(s);case 4:return o=t.sent,this.validateRecord(o,i),t.abrupt("return",o);case 7:case"end":return t.stop()}},t,this)})),function(t,e){return h.apply(this,arguments)}),u._put=(l=a(regeneratorRuntime.mark(function t(e,i,n,s){var o,r,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=this._getStorage(),r=this._getRecordKey(e),a=this.createRecord(i,n,s),t.next=5,o.put(r,a);case 5:case"end":return t.stop()}},t,this)})),function(t,e,i,n){return l.apply(this,arguments)}),u._remove=(c=a(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getStorage(),n=this._getRecordKey(e),t.next=4,i.remove(n);case 4:case"end":return t.stop()}},t,this)})),function(t){return c.apply(this,arguments)}),u.getValidationParams=function(){var t,e=this._zenApi.getConfig(),i=e.clid,n=e.referrerClid,s=e.referrerPlace,o=e.feedFilter,r=e.countryCode,a=e.clientExperiments,c=e.userInfo,l=e.zenFeatures,h=e.isAdblockEnabled,u=c.oauthToken,d=c.login,m=c.deviceId,p=c.profileId,f=c.yandexuid;return{clid:i,referrerClid:n,referrerPlace:s,feedFilter:o,countryCode:r,clientExperiments:a,userId:u||d||(t=("; "+document.cookie).match(/; yandex_login=([^;]*)/),t&&t[1])||m||p||f||function(){var t=("; "+document.cookie).match(/; yandexuid=([^;]*)/);return t&&t[1]}(),zenFeatures:l,isAdblockEnabled:h}},u.createRecord=function(t,e,i){var n=this._zenApi.getConfig().apiResponseValidator,s=gt(e);return bt(s),n(s),{type:t,apiResponse:e,params:i}},u.validateRecord=function(t,e){var i=void 0===e?{}:e,n=i.byStoreTtl,s=void 0!==n&&n,o=i.ignoredZenFeatures,r=void 0===o?[]:o;!function(t){if(!(t&&t.type&&t.apiResponse&&t.params))throw new Error("Invalid cache record scheme.")}(t);var a=this._zenApi.getConfig(),c=a.apiResponseValidator,l=gt(t.apiResponse),h=this.getValidationParams(a);!function(t,e){var i=t.receivedAt,n=t.ttl,s=t.storeTtl,o=e?s:n;if(!("number"==typeof i&&"number"==typeof o&&i+o>Date.now()))throw new Error("Invalid cache "+(e?"store-ttl":"ttl")+".")}(l,s),function(t,e,i,n){var s=t&&t.userId&&e&&e.userId&&t.userId===e.userId&&Boolean(t.isAdblockEnabled)===Boolean(e.isAdblockEnabled)&&("number"!=typeof t.clid||t.clid===e.clid)&&("number"!=typeof t.referrerClid||t.referrerClid===e.referrerClid)&&("string"!=typeof t.referrerPlace||t.referrerPlace===e.referrerPlace)&&("string"!=typeof t.countryCode||t.countryCode===e.countryCode)&&E()(t.feedFilter,e.feedFilter)&&E()(t.zenFeatures&&M(t.zenFeatures,n),e.zenFeatures&&M(e.zenFeatures,n)),o=!0;if(t&&Array.isArray(t.clientExperiments)){var r=function(t,e){var i=[];return t&&Array.isArray(t.clientExperiments)&&i.push.apply(i,t.clientExperiments),e.experimentsData&&Object.keys(e.experimentsData).forEach(function(t){var n=e.experimentsData[t];n&&n.exp&&i.push(t)}),i}(e,i);o=t.clientExperiments.every(function(t){return r.includes(t)})}if(!s||!o)throw new Error("ZenApi cache is not valid.")}(h,t.params,l,r),bt(l),c(l)},u.getNotShownPack=(r=a(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._get("not-shown-pack",e));case 1:case"end":return t.stop()}},t,this)})),function(t){return r.apply(this,arguments)}),u.getLastShownPack=(o=a(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._get("last-shown-pack",e));case 1:case"end":return t.stop()}},t,this)})),function(t){return o.apply(this,arguments)}),u.putNotShownPack=(s=a(regeneratorRuntime.mark(function t(e,i,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=this.getValidationParams()),t.next=3,this._put("not-shown-pack",e,i,n);case 3:this._eventEmitter.emit("notShownPackUpdated",e,i,n);case 4:case"end":return t.stop()}},t,this)})),function(t,e,i){return s.apply(this,arguments)}),u.putLastShownPack=(n=a(regeneratorRuntime.mark(function t(e,i,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=this.getValidationParams()),t.next=3,this._put("last-shown-pack",e,i,n);case 3:this._eventEmitter.emit("lastShownPackUpdated",e,i,n);case 4:case"end":return t.stop()}},t,this)})),function(t,e,i){return n.apply(this,arguments)}),u.removeNotShownPack=(i=a(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._remove("not-shown-pack"));case 1:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)}),u.removeLastShownPack=(e=a(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._remove("last-shown-pack"));case 1:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)}),t}(),wt=function(t){return new Promise(function(e){return setTimeout(function(){return e()},t)})},kt="application/json; charset=utf-8",Et={credentials:"include",timeout:6e4},Mt={Accept:kt},xt=function(t){var e=t.ok,i=t.url,n=t.status,s=t.statusText;if(!e)throw new Error(i+" "+n+" ("+s+")");return function(t){var e=t.headers.get("Content-Type");return e&&-1!==e.indexOf(kt)?t.json():t.text()}(t)},Tt=function(t,e){var i=Object.assign({},Et,e),n=i.params?b(t,i.params):t;return new Promise(function(t,e){fetch(n,i).then(xt).then(t,e),wt(i.timeout).then(function(){e(new Error("Request timeout."))})})},St=function(t,e){void 0===e&&(e={});var i=Object.assign({},e,{method:"GET",params:Object.assign({},e.params||{},{rnd:Date.now()})});return Tt(t,i)},Ct=function(t,e){void 0===e&&(e={});var i=Object.assign({},Mt,e.headers),n=e.body;i["Content-Type"]||(i["Content-Type"]=kt,n&&"string"!=typeof n&&(n=JSON.stringify(n)));var s=Object.assign({},e,{method:"POST",headers:i,body:n});return Tt(t,s)},It=function(){function t(t){this._zenApiInstance=t}var e,i=t.prototype;return i._getExtraHeaders=function(){var t={},e=this._zenApiInstance.getConfig(),i=e.userInfo,n=e.zenFeatures,s=e.clientExperiments;return i.oauthToken&&(t.Authorization="OAuth "+i.oauthToken),Object.keys(n).length>0&&(t["Zen-Features"]=JSON.stringify(n)),t["Zen-Client-Experiments"]=["zen-version:2.65.1"].concat(Array.isArray(s)&&s.length>0?s:[]).join(", "),t},i.makeApiRequest=(e=a(regeneratorRuntime.mark(function t(e,i){var n,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i={}),n=i.noExtraHeaders?{}:this._getExtraHeaders(),s={params:i.params,headers:Object.assign({},n,i.headers),mode:i.mode},!i.body){t.next=9;break}return t.next=6,Ct(e,Object.assign({},s,{body:i.body}));case 6:o=t.sent,t.next=12;break;case 9:return t.next=11,St(e,s);case 11:o=t.sent;case 12:return t.abrupt("return",o);case 13:case"end":return t.stop()}},t,this)})),function(t,i){return e.apply(this,arguments)}),t}(),Pt=function(){function t(){this._eventEmitter=new h,this._config={limits:{docImages:10}}}var e=t.prototype;return e.onNetworkResponse=function(t){var e=this._getUrlsToPreload(t);this._eventEmitter.emit("updatePreload",e)},e.addListener=function(t,e){this._eventEmitter.addListener(t,e)},e.removeListener=function(t,e){this._eventEmitter.removeListener(t,e)},e._getUrlsToPreload=function(t){var e=[];return t&&t.items&&(e=e.concat(t.items.map(function(t){return t.cardBackgroundWhiteImage}).filter(Boolean).slice(0,this._config.limits.docImages))),e},t}(),Bt={GET_BEFORE_NETWORK:["default"],GET_AFTER_NETWORK:["default","reload"],PUT_AFTER_NETWORK:["default","reload","no-cache"]},Dt={host:null,clid:null,referrerClid:null,referrerPlace:null,countryCode:null,zenFeatures:{},clientExperiments:null,retryTimeouts:[3e4,18e4],apiResponseValidator:function(){return null},links:(ct={},ct.onboarding=null,ct.more=null,ct.bulk=null,ct.subs=null,ct.profile=null,ct.blocked=null,ct.preferences=null,ct.categories=null,ct.category=null,ct.suggest=null,ct.blocked_suggest=null,ct.video_recommend=null,ct.language=null,ct.comments_counter=null,ct),userInfo:{oauthToken:null,login:null,deviceId:null,profileId:null,yandexuid:null,partnerId:null},cache:{type:"cacheStorage",namespace:"common",isPrefetchEnabled:!0},chromeExtensionId:null},Ot=function(){function t(t){var e=this;this._config=Dt,this._eventEmitter=new h,this._cache=new yt(this,this._eventEmitter),this._network=new It(this),this._preload=new Pt,this._queue=Promise.resolve(),this._lastUsedPackId=null,this._lastUsedPackShown=!1,this._retryableGetApiResponse=w(function(t,i){return e._addToQueue(function(){return e._getApiResponse(t,i)})}),t?this.configure(t):this._updateTimeouts()}var e,i,n,s,o,r,c,l,u,p,f,_,g,v,y,k,E,M=t.prototype;return M._getApiRequestUrl=function(t){if("export"===t){var e=this._config,i=e.host,n=e.clid,s=e.referrerClid,o=e.referrerPlace,r=e.countryCode,a=e.userInfo;if(!i)throw new Error("ZenApi host is not configured.");var c={clid:n||void 0,country_code:r||void 0,referrer_clid:s,referrer_place:o};return a&&a.partnerId&&(c.partner_user_id=a.partnerId.toString()),b(i+"api/v3/launcher/export",c)}if("publisher_config"===t){var l=this._config,h=l.host,u=l.clid,d=l.referrerClid,m=l.referrerPlace,p=l.countryCode;if(!h)throw new Error("ZenApi host is not configured.");return b(h+"api/v3/launcher/publisher-config",{clid:u,country_code:p,referrer_clid:d,referrer_place:m})}var f=this._config.links[t];if(!f)throw new Error("ZenApi "+t+" url is not configured.");return f},M._getApiResponseFromNetworkAndMaybePutItToCache=(E=a(regeneratorRuntime.mark(function t(e,i){var n,s,o,r,a,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===i&&(i={}),n=this._getApiRequestUrl(e),s=i.cache||"default",o=this._cache.getValidationParams(),t.next=6,this._network.makeApiRequest(n,i);case 6:return r=t.sent,a=Object.assign({},r,{received_at:Date.now()}),c=gt(a),this._config.apiResponseValidator(c),l=Bt.PUT_AFTER_NETWORK.includes(s),this._config.cache&&l&&(this._cache.putNotShownPack(e,a,o).catch(function(t){}),this._preload.onNetworkResponse(c)),t.abrupt("return",{apiResponse:c,source:"network"});case 13:case"end":return t.stop()}},t,this)})),function(t,e){return E.apply(this,arguments)}),M._getApiResponseFromCacheBeforeNetwork=(k=a(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._cache.getNotShownPack();case 2:if(i=t.sent,n=gt(i.apiResponse),"more"!==e||"export"!==i.type){t.next=6;break}throw new Error("Can not apply cache from export to more request.");case 6:if(this._lastUsedPackId!==n.id){t.next=8;break}throw new Error("Pack '"+n.id+"' has already been used.");case 8:return t.abrupt("return",{apiResponse:n,source:"cache-before-network"});case 9:case"end":return t.stop()}},t,this)})),function(t){return k.apply(this,arguments)}),M._getApiResponseFromCacheAfterNetwork=(y=a(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._cache.getNotShownPack({byStoreTtl:!0});case 3:e=t.sent,t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(0),t.next=10,this._cache.getLastShownPack({byStoreTtl:!0});case 10:e=t.sent;case 11:return t.abrupt("return",{apiResponse:gt(e.apiResponse),source:"cache-after-network"});case 12:case"end":return t.stop()}},t,this,[[0,6]])})),function(){return y.apply(this,arguments)}),M._getApiResponse=(v=a(regeneratorRuntime.mark(function t(e,i){var n,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i={}),n=i.cache||"default",!this._config.cache||!Bt.GET_BEFORE_NETWORK.includes(n)){t.next=11;break}return t.prev=3,t.next=6,this._getApiResponseFromCacheBeforeNetwork(e);case 6:s=t.sent,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(3);case 11:if(s){t.next=31;break}return t.prev=12,t.next=15,this._getApiResponseFromNetworkAndMaybePutItToCache(e,i);case 15:s=t.sent,t.next=31;break;case 18:if(t.prev=18,t.t1=t.catch(12),!this._config.cache||"export"!==e||!Bt.GET_AFTER_NETWORK.includes(n)){t.next=29;break}return t.prev=21,t.next=24,this._getApiResponseFromCacheAfterNetwork();case 24:s=t.sent,t.next=29;break;case 27:t.prev=27,t.t2=t.catch(21);case 29:if(s){t.next=31;break}throw t.t1;case 31:return this._updateNotShownPack(),t.abrupt("return",s);case 33:case"end":return t.stop()}},t,this,[[3,9],[12,18],[21,27]])})),function(t,e){return v.apply(this,arguments)}),M._hasValidNotShownPackInCache=(g=a(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._getApiResponseFromCacheBeforeNetwork(e);case 3:return t.abrupt("return",!0);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",!1);case 9:case"end":return t.stop()}},t,this,[[0,6]])})),function(t){return g.apply(this,arguments)}),M._updateNotShownPack=function(t){var e=this,i=void 0===t?{}:t,n=i.invalidate,s=void 0!==n&&n,o=i.requestType;this._config.cache&&this._config.cache.isPrefetchEnabled&&this._addToQueue(a(regeneratorRuntime.mark(function t(){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o||"more",t.t0=s,t.t0){t.next=6;break}return t.next=5,e._hasValidNotShownPackInCache(i);case 5:t.t0=!t.sent;case 6:if(!t.t0){t.next=15;break}return t.prev=7,t.next=10,e._getApiResponseFromNetworkAndMaybePutItToCache(i);case 10:t.next=15;break;case 12:t.prev=12,t.t1=t.catch(7),d.warn("Failed to update 'not-shown' pack: '"+t.t1.message+"'.");case 15:case"end":return t.stop()}},t,this,[[7,12]])})))},M._updateTimeouts=function(){var t=this._config.retryTimeouts;this._retryableGetApiResponse.setOptions({timeouts:t})},M._addToQueue=function(t){var e=this._queue=this._queue.then(function(){return t()},function(){return t()});return e.catch(function(t){}),e},M.configure=function(t){this._config="function"==typeof t?t(this._config):t,this._updateTimeouts()},M.getConfig=function(){return this._config},M.getPublisherConfig=function(t){void 0===t&&(t={});var e=t,i=e.options,n=m(e,["options"]);return this._retryableGetApiResponse.startSession(Object.assign({},n,{args:["publisher_config",i]}))},M.getExport=function(t){void 0===t&&(t={});var e=t,i=e.options,n=m(e,["options"]);return this._retryableGetApiResponse.startSession(Object.assign({},n,{args:["export",i]}))},M.getMore=function(t){return void 0===t&&(t={}),this._retryableGetApiResponse.startSession(Object.assign({},t,{args:["more"]}))},M.getSimilar=function(t){return this._network.makeApiRequest(t).then(pt)},M.sendBannerStats=function(t){return this._network.makeApiRequest(t)},M.getProfile=(_=a(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._getApiRequestUrl("profile"),t.next=3,this._network.makeApiRequest(e);case 3:return i=t.sent,t.abrupt("return",(void 0,(n=i.items.reduce(function(t,e){return dt.hasOwnProperty(e.type)&&(t[mt[e.type]||e.type]=dt[e.type](e)),t},{})).userInfo||n.noUser||d.error("Inconsistent profile data"),n));case 5:case"end":return t.stop()}var n},t,this)})),function(){return _.apply(this,arguments)}),M.getSuggest=(f=a(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getApiRequestUrl("suggest"),t.next=3,this._network.makeApiRequest(i,{params:{search_text:e}});case 3:return n=t.sent,t.abrupt("return",lt(n));case 5:case"end":return t.stop()}},t,this)})),function(t){return f.apply(this,arguments)}),M.getBlockedSuggest=(p=a(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getApiRequestUrl("blocked_suggest"),t.next=3,this._network.makeApiRequest(i,{params:{search_text:e}});case 3:return n=t.sent,t.abrupt("return",lt(n));case 5:case"end":return t.stop()}},t,this)})),function(t){return p.apply(this,arguments)}),M.getCategories=(u=a(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._getApiRequestUrl("categories"),t.next=3,this._network.makeApiRequest(e);case 3:return i=t.sent,t.abrupt("return",(s=void 0,o=void 0,void 0,0!==(r=(n=i).items.filter(function(t){return"carousel"===t.type}).map(function(t){return t.sources})).length&&(s=(o=[]).concat.apply(o,r).map(et)),{sources:s,list:n.items.filter(function(t){return"list_item"===t.type}).map(ht).reduce(function(t,e){return t[e.name]=e,t},{})}));case 5:case"end":return t.stop()}var n,s,o,r},t,this)})),function(){return u.apply(this,arguments)}),M.getCategory=(l=a(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getApiRequestUrl("category").replace("__name__",e),t.next=3,this._network.makeApiRequest(i);case 3:return n=t.sent,t.abrupt("return",{sources:lt(s=n),category:s.category&&ht(s.category)});case 5:case"end":return t.stop()}var s},t,this)})),function(t){return l.apply(this,arguments)}),M.getPreferences=(c=a(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._getApiRequestUrl("preferences"),t.next=3,this._network.makeApiRequest(e);case 3:return i=t.sent,t.abrupt("return",lt(i));case 5:case"end":return t.stop()}},t,this)})),function(){return c.apply(this,arguments)}),M.getVideoRecommend=(r=a(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._getApiRequestUrl("video_recommend"),t.next=3,this._network.makeApiRequest(e);case 3:return i=t.sent,t.abrupt("return",(void 0,(void 0===(n=i.items)?[]:n).reduce(function(t,e){return e.type===J&&t.push(ot(e)),t},[])));case 5:case"end":return t.stop()}var n},t,this)})),function(){return r.apply(this,arguments)}),M.getCountryLang=(o=a(regeneratorRuntime.mark(function t(){var e,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._getApiRequestUrl("language"),t.next=3,this._network.makeApiRequest(e);case 3:return i=t.sent,t.abrupt("return",(void 0,o=void 0,r=void 0,void 0,s=(n=i).country_id,o=n.language_ids,r=n.countries,a=n.languages,{countryId:s,languageIds:o.reduce(function(t,e){return t[e]=!0,t},{}),countries:r.map(function(t){return{code:t.code,langs:t.langs,name:t.name}}),languages:a}));case 5:case"end":return t.stop()}var n,s,o,r,a},t,this)})),function(){return o.apply(this,arguments)}),M.getCommentsCounters=(s=a(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getApiRequestUrl("comments_counter"),t.next=3,this._network.makeApiRequest(i,{body:{documentIds:e},mode:"cors",noExtraHeaders:!0});case 3:n=t.sent;try{n=JSON.parse(n)}catch(t){console.warn("apiResponse type JSON")}return t.abrupt("return",ft(n.counts));case 6:case"end":return t.stop()}},t,this)})),function(t){return s.apply(this,arguments)}),M.setCountryLang=(n=a(regeneratorRuntime.mark(function t(e,i){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._getApiRequestUrl("language"),t.next=3,this._network.makeApiRequest(n,{body:{country_id:e,language_ids:i}});case 3:this.invalidateCache();case 4:case"end":return t.stop()}},t,this)})),function(t,e){return n.apply(this,arguments)}),M.prefetch=function(){this._updateNotShownPack()},M.invalidateCache=function(){this._updateNotShownPack({invalidate:!0})},M.packUsed=function(t){this._lastUsedPackId=t,this._lastUsedPackShown=!1},M.packShown=function(t){var e=this;this._config.cache&&this._addToQueue(a(regeneratorRuntime.mark(function i(){var n;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,e._cache.getNotShownPack();case 3:n=i.sent,i.next=8;break;case 6:i.prev=6,i.t0=i.catch(0);case 8:if(!n){i.next=18;break}if(gt(n.apiResponse).id!==t){i.next=18;break}return i.prev=11,i.next=14,Promise.all([e._cache.removeNotShownPack(),e._cache.putLastShownPack(n.type,n.apiResponse,n.params)]);case 14:i.next=18;break;case 16:i.prev=16,i.t1=i.catch(11);case 18:t!==e._lastUsedPackId||e._lastUsedPackShown||(e._lastUsedPackShown=!0,e._updateNotShownPack()),e._eventEmitter.emit(vt,t);case 20:case"end":return i.stop()}},i,this,[[0,6],[11,16]])})))},M.getNotShownPackFromCache=(i=a(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._cache.getNotShownPack(e);case 2:return i=t.sent,t.abrupt("return",gt(i.apiResponse));case 4:case"end":return t.stop()}},t,this)})),function(t){return i.apply(this,arguments)}),M.getLastShownPackFromCache=(e=a(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._cache.getLastShownPack(e);case 2:return i=t.sent,t.abrupt("return",gt(i.apiResponse));case 4:case"end":return t.stop()}},t,this)})),function(t){return e.apply(this,arguments)}),M.setIntervalPackUpdater=function(t){var e=this;setInterval(a(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._updateNotShownPack({requestType:"export"});case 1:case"end":return t.stop()}},t,this)})),t),this._updateNotShownPack({requestType:"export"})},M.on=function(){var t;(t=this._eventEmitter).on.apply(t,arguments)},M.off=function(){var t;(t=this._eventEmitter).off.apply(t,arguments)},M.addListener=function(){var t;(t=this._eventEmitter).addListener.apply(t,arguments)},M.removeListener=function(){var t;(t=this._eventEmitter).removeListener.apply(t,arguments)},t}(),At=(i(97),function(t){return{stats:t.map(function(t){var e=t.event,i=t.params,n=t.ts,s=t.info,o={event:e,data:i,ts:n};return s&&(o.info=s),o}),bulk_ts:Date.now()}}),Rt=function(){if("undefined"!=typeof document)return Boolean(document.cookie.match(new RegExp(atob("Ymx0c3I9MQ=="))))}(),jt=function(t){if(!(Array.isArray(t.items)&&t.items.length>0&&t.more&&t.more.link&&t.bulk&&t.bulk.link)){var e="Invalid response from ZenApi"+(t.message?": '"+t.message+"'":"")+".",i=new Error(e);throw t.ttl&&(i.ttl=t.ttl),i}},Lt=new(function(t){function e(){for(var e,i,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return e=i=t.call.apply(t,[this].concat(s))||this,i._bulkEvents=[],i._sendingTimeoutId=null,i._bulkEventBatch=null,e||function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)}c(e,t);var i,n,s=e.prototype;return s._getApiResponseFromNetworkAndMaybePutItToCache=(n=a(regeneratorRuntime.mark(function t(e,i){var n,s,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i={}),Rt&&this._sendBulkEventsWithinQueue(),!Rt&&0!==this._bulkEvents.length&&!i.body){t.next=4;break}return t.abrupt("return",Ot.prototype._getApiResponseFromNetworkAndMaybePutItToCache.call(this,e,i));case 4:return n=this._bulkEvents,s=At(n),o=Object.assign({},i,{body:s}),this._bulkEvents=[],t.prev=8,t.abrupt("return",Ot.prototype._getApiResponseFromNetworkAndMaybePutItToCache.call(this,e,o));case 12:throw t.prev=12,t.t0=t.catch(8),this._bulkEvents=this._bulkEvents.concat(n),t.t0;case 16:case"end":return t.stop()}},t,this,[[8,12]])})),function(t,e){return n.apply(this,arguments)}),s._addToQueue=function(e,i){return void 0===i&&(i=!0),i&&(this._bulkEventBatch=null),t.prototype._addToQueue.call(this,e)},s._sendBulkEvents=(i=a(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this._bulkEvents.length){t.next=2;break}return t.abrupt("return");case 2:return e=this._getApiRequestUrl("bulk"),i=this._bulkEvents,n=At(i),this._bulkEvents=[],t.prev=6,t.next=9,this._network.makeApiRequest(e,{body:n});case 9:t.next=15;break;case 11:throw t.prev=11,t.t0=t.catch(6),this._bulkEvents=this._bulkEvents.concat(i),t.t0;case 15:case"end":return t.stop()}},t,this,[[6,11]])})),function(){return i.apply(this,arguments)}),s._planBulkEventsSending=function(){var t=this;null===this._sendingTimeoutId&&(this._sendingTimeoutId=setTimeout(function(){t._sendingTimeoutId=null,t._sendBulkEventsWithinQueue()},1e3))},s._sendBulkEventsWithinQueue=function(){var t,e,i,n,s,o,r,a,c,l=this;if(!this._bulkEventBatch){var h=this._bulkEventBatch=(i=0,n=0,s=!1,o=new Promise(function(e){t=e}),r=new Promise(function(t){e=t}),a=function(){s=!0,e()},c=function(){++n===i&&a()},{trigger:function(){return t(),n===i&&a(),r},extend:function(t){s||(i++,o.then(t).then(c,c))}});this._addToQueue(function(){return h.trigger().then(function(){l._bulkEventBatch===h&&(l._bulkEventBatch=null)})},!1)}this._bulkEventBatch&&this._bulkEventBatch.extend(function(){return l._sendBulkEvents().catch(function(t){d.warn("Error while sending bulk events",t)})})},s.logBulkEvent=function(t){var e=t.event,i=t.bulkParams,n=t.statMeta,s=t.info,o={id:function(t){return t+"_"+Date.now()}(e),event:e,params:i,ts:Date.now(),info:s};this._bulkEvents.push(o),this._planBulkEventsSending(),this._eventEmitter.emit("bulkEventLogger",Object.assign({},o,{statMeta:n}))},s.logNonBulkEvent=function(t,e){return this._network.makeApiRequest(t,{body:e})},e}(Ot))(function(t){return Object.assign({},t,{apiResponseValidator:jt})}),Ft=new h,Nt=new h,$t=(new h,i(21));function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zt(t,e){return(zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wt(t,e,i){return(Wt=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var s=new(Function.bind.apply(t,n));return i&&zt(s,i.prototype),s}).apply(null,arguments)}function Ut(t){var e="function"==typeof Map?new Map:void 0;return(Ut=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Wt(t,arguments,Ht(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),zt(n,t)})(t)}var Vt="ZenLibLoaderError",qt=function(t){function e(e){var i,n=e.message,s=e.owner,o=e.sourceType;return(i=t.call(this,n)||this).owner=s,i.sourceType=o,i.name=Vt,i}return c(e,t),e}(Ut(Error)),Kt=i(20),Gt=function(t,e){void 0===e&&(e={}),this.is_supported=t,this.is_mobile=e.is_mobile,this.browser_name=e.browser_name,this.browser_base=e.browser_base,this.build_name=e.build_name,this.browser_version=e.browser_version};function Yt(t){return t.isTablet||t.isMobile?new Gt(!1):function(t,e){for(var i=t.BrowserName,n=t.BrowserBase,s=String(t.BrowserVersion),o=String(t.BrowserBaseVersion),r=0;r<e.length;r++){var a=e[r],c=a.build_name,l=a.min_browser_base_version,h=a.min_browser_version;if(n&&o&&n===a.browser_base&&Xt(o,l)>=0)return new Gt(!0,{browser_name:i,browser_base:n,build_name:c,browser_version:s});if(i===a.browser_name&&Xt(s,h)>=0)return new Gt(!0,{browser_name:i,build_name:c,browser_version:s})}return new Gt(!1)}(t,Kt.desktop_supported_browsers)}function Jt(t){if(t.isTouch&&!t.isTablet)for(var e=0;e<Kt.mobile_supported_browsers.length;e++){var i=Kt.mobile_supported_browsers[e],n=i.os_name,s=i.os_min_version,o=i.build_name;if(n===t.OSFamily&&parseFloat(t.OSVersion)>=parseFloat(s))return new Gt(!0,{is_mobile:!0,build_name:o,browser_base:t.BrowserBase,browser_name:t.BrowserName,browser_version:t.BrowserVersion})}return new Gt(!1)}function Xt(t,e){if("string"==typeof t&&"string"==typeof e){for(var i=[t,e].map(function(t){return t.split(".").map(function(t){return parseInt(t,10)})}),n=i[0],s=i[1],o=Math.min(n.length,s.length),r=0;r<o;r++){var a=n[r],c=s[r];if(a!==c)return a>c?1:-1}return 0}}var Zt,Qt,te=function(t){var e=function(t){if(t.isTablet){for(var e=0;e<Kt.tablet_supported_browsers.length;e++){var i=Kt.tablet_supported_browsers[e],n=i.os_name,s=i.os_min_version,o=i.build_name;if(n===t.OSFamily&&parseFloat(t.OSVersion)>=parseFloat(s))return new Gt(!0,{build_name:o,browser_base:t.BrowserBase,browser_name:t.BrowserName,browser_version:t.BrowserVersion})}return new Gt(!1)}return new Gt(!1)}(t);if(e.is_supported)return e;var i=Jt(t);return i.is_supported?i:e},ee=i(39),ie={version:"2.65.1",host:"https://zen.yandex.ru/",staticHost:"https://yastatic.net/s3/zen-lib/",initialDisplayedRowsNumber:6,exps:[],isDev:!1,isVideoDisabled:!1,theme:"white"},ne={bundleName:"lib",uatraitsType:"desktop",columnCount:3},se={bundleName:"lib-mobile",uatraitsType:"mobile",columnCount:1,isMobile:!0},oe=((Zt={}).yabro={bundleName:"yabro",uatraitsType:"desktop",columnCount:3},Zt.opera={bundleName:"opera",uatraitsType:"desktop",columnCount:3},Zt.yabroMorda={bundleName:"yabro-morda",uatraitsType:"desktop",columnCount:3},Zt.mordaDesktop=ne,Zt.mordaMobile=se,Zt.mordaTablet={bundleName:"lib",uatraitsType:"tablet",columnCount:3},Zt.defaultDesktop=ne,Zt.defaultMobile=se,Zt.defaultTablet={bundleName:"lib",uatraitsType:"tablet",columnCount:2},Zt.vb={bundleName:"vb-lib",uatraitsType:"desktop",columnCount:3},Zt.coccoc={bundleName:"coccoc-lib",uatraitsType:"desktop",columnCount:1},Zt),re=["clid","lang"],ae=function(t,e){e.forEach(function(e){if(!(e in t))throw new qt({message:"Option '"+e+"' is not found in loader params.",owner:"frontend",sourceType:"logic"})})},ce=function(t){ae(t,[])},le=((Qt={}).yabro=ce,Qt.yabroMorda=ce,Qt),he=function(t){var e,i,n,s,o,r,a,c,l=t.uatraits,h=t.columnCount,u=t.isVideoDisabled,d=t.rowPlaceholders,m=t.cardPlaceholders,p=t.theme,f=(e={browserName:l&&l.BrowserName},i=e.browserName,n=void 0===i?"MSIE":i,s=e.OSFamily,o=void 0===s?"Windows":s,r=e.OSVersion,a=void 0===r?"6.1":r,c=ee.DEFAULT_REZEN_ZEN_FEATURES.video_providers.slice(0),function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(t){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1}()?{video_providers:c}:"MSIE"!==n||"Windows"!==o||"6.1"!==a?{video_providers:c}:{video_providers:c.filter(function(t){return"yandex-web"!==t})}),_=Object.assign({},ee.DEFAULT_REZEN_ZEN_FEATURES,f,{column_count:h,row_placeholders:d,card_placeholders:m,color_theme:p});return u&&(_.no_videos=!0,delete _.video_providers),_},ue=(i(95),function(t,e){void 0===e&&(e=!1);var i={src:t,type:"preload",asAttr:"script",crossOrigin:e?"use-credentials":"anonymous"};(function(t){var e=i.src,n=i.type,s=i.asAttr,o=i.crossOrigin,r=!1;return Array.from(document.getElementsByTagName("link")).forEach(function(t){var i=-1!==t.href.indexOf(e),a=t.type===n,c=t.as===s,l=t.crossOrigin===o;!i||a&&c&&l||console.error("There is not fully matched link",t),i&&a&&c&&l&&(r=!0)}),r})()||function(t){var e=i.src,n=i.type,s=i.asAttr,o=i.crossOrigin,r=document.createElement("link");r.href=e,r.rel=n,r.as=s,r.crossOrigin=o,document.head.appendChild(r)}()}),de={},me=function(t,e){var i=void 0===e?{}:e,n=i.invalidate,s=void 0!==n&&n,o=i.crossorigin,r=void 0!==o&&o,a=i.useCredentials,c=void 0!==a&&a;if(de[t]&&!s)return de[t].promise;var l=document.createElement("script");l.src=t,l.async=!0,r&&(l.crossOrigin=c?"use-credentials":"anonymous");var h=new Promise(function(e,i){l.onload=function(){de[t].loaded=!0,e()},l.onerror=function(e){de[t].error=e,i(e)}});return de[t]&&document.head&&document.head.removeChild(de[t].script),document.head&&document.head.appendChild(l),de[t]={script:l,promise:h,loaded:!1,error:null},h};me.isRequested=function(t){return Boolean(de[t])},me.isLoaded=function(t){return Boolean(de[t]&&de[t].loaded)},me.isFailed=function(t){return Boolean(de[t]&&de[t].error)};var pe=me,fe=(i(93),i(91),i(90),i(96),new(function(){function t(){this._starts=new Map,this._results=new Map}var e=t.prototype;return e.start=function(t){var e=this._starts.get(t),i=this._results.get(t);e||i||this._starts.set(t,Date.now())},e.finish=function(t){var e=this._starts.get(t),i=this._results.get(t);e&&!i&&this._results.set(t,Date.now()-e)},e.getResults=function(){var t={},e=this._results.entries(),i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var s;if(i){if(n>=e.length)break;s=e[n++]}else{if((n=e.next()).done)break;s=n.value}var o=s;t[o[0]]=o[1]}return t},e.getInProgress=function(){var t=[],e=this._starts.keys(),i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var s;if(i){if(n>=e.length)break;s=e[n++]}else{if((n=e.next()).done)break;s=n.value}var o=s;this._results.get(o)||t.push(o)}return t.sort()},t}())),_e=function(t,e){return("/"===(i=t)[i.length-1]?i.slice(0,-1):i)+(e?"/"+e:"");var i},ge=function(t){var e=t.staticHost,i=t.version,n=t.lang,s=t.buildName,o=t.bundleName,r=t.isChunkedBundle,a=t.isAdblock,c="bundle";return a&&r?c="styles-included-chunked-bundle":a?c="styles-included-bundle":r&&(c="chunked-bundle"),_e(e,i)+"/"+o+"/"+o+"."+s+"."+n+"."+c+".js"},ve=o()(function(t){var e=t.staticHost,i=t.version,n=t.bundleName,s=t.container;fe.start("css");var o=function(t){var e=t.bundleName;return _e(t.staticHost,t.version)+"/"+e+"/"+e+".css"}({staticHost:e,version:i,bundleName:n});return new Promise(function(t,e){var i=s?s.lastChild:document.body.lastChild;!function(t,e,i){var n;function s(){!n&&e&&(n=!0,e.call(t))}function o(){!n&&i&&(n=!0,i.call(t))}t.addEventListener&&(t.addEventListener("load",s),t.addEventListener("error",o)),t.attachEvent&&(t.attachEvent("onload",s),t.attachEvent("onerror",o)),"isApplicationInstalled"in navigator&&"onloadcssdefined"in t&&t.onloadcssdefined(s)}(window.loadCSS(o,i,null,!0),function(){fe.finish("css"),t()},function(){e(new qt({message:"Failed to load css",owner:"frontend",sourceType:"network"}))})})}),be=function(t){var e=t.host,i=t.clid,n=t.referrerClid,s=t.referrerPlace,o=t.countryCode,r=t.exps,a=t.zenFeatures,c=t.cache,l=t.precacheKey,h=t.precacheRid,u=t.userInfo,d=t.feedFilter,m=t.chromeExtensionId,p=t.isAdblock;fe.start("api"),Lt.configure(function(t){return Object.assign({},t,{host:e,clid:i,referrerClid:n,referrerPlace:s,countryCode:o,zenFeatures:a,cache:c&&Object.assign({},c,{isPrefetchEnabled:!1}),isAdblockEnabled:p,clientExperiments:r,withoutRetries:!0,retryTimeouts:null,userInfo:Object.assign({},t.userInfo,u),chromeExtensionId:m,feedFilter:d})});var f={};return l&&(f.key=l),d&&d.tags&&Array.isArray(d.tags)&&1===d.tags.length&&(f.topic_id=d.tags[0]),d&&d.itemId&&(f.item_id=d.itemId),d&&d.itemType&&(f.item_type=d.itemType),Lt.getExport({options:{params:0===Object.keys(f).length?null:f,cache:l?"reload":"default",headers:h?{"zen-request-id":h}:null}}).retriesResult.then(function(t){var e=t.apiResponse;return fe.finish("api"),l&&e&&"cache"!==e.source&&Ft.emit("precacheMiss",{key:l,rid:h}),e}).catch(function(t){var e=t.toString();throw new qt({message:"Failed to fetch data from API. Reason: "+e,owner:"backend",sourceType:-1!==e.indexOf("fetch")?"network":"logic"})})},ye=o()(be);if(!window||!window.Promise)throw new qt({message:"window and promise must exist for zenlib-loader",owner:"frontend",sourceType:"logic"});var we="READY",ke=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,i=void 0,s=[],o=void 0,r=!1,a=function(t,i){return e(t,s[i])};return function(){for(var e=arguments.length,n=Array(e),c=0;c<e;c++)n[c]=arguments[c];return r&&i===this&&n.length===s.length&&n.every(a)?o:(r=!0,i=this,s=n,o=t.apply(this,n))}}(function(t){var e=t.libType,i=t.uatraits,n=t.useLegacy,s=t.isDev,o=e||function(t){return t.isTablet?"defaultTablet":t.isMobile?"defaultMobile":"defaultDesktop"}(i),r=oe[o];if(!r)throw new qt({message:"Passed libType is not exist.",owner:"frontend",sourceType:"logic"});!function(t,e){le[e]?le[e](t):function(t){if(ae(t,re),!t.uatraits&&!t.isDev&&!t.useLegacy)throw new qt({message:"'uatraits' or 'isDev' or 'useLegacy' options must be passed in loader params.",owner:"frontend",sourceType:"logic"})}(t)}(t,o);var a,c=Object.assign({},ie,r,t),l=c.uatraitsType,h=c.columnCount,u=c.isVideoDisabled,d=c.rowPlaceholders,m=c.cardPlaceholders,p=c.theme,f=c.feedFilter,_=he({uatraits:i,columnCount:h,isVideoDisabled:u,rowPlaceholders:d,cardPlaceholders:m,theme:p}),g=t.cache&&t.cache.api,v=g&&g.storeId,b=g&&g.userId;return a=b?{type:f&&f.tags&&Array.isArray(f.tags)&&1===f.tags.length?"cacheStorage":"multiCacheStorage",namespace:"lib-"+(v||"default-zen-store")+"-"+(b||"empty"),isPrefetchEnabled:!0}:null,Object.assign({},ie,r,t,{buildName:function(t){var e=t.uatraits,i=t.uatraitsType,n=t.useLegacy;if(t.isDev)return"dev";if(!e&&n)return"legacy";var s,o=function(t){var e=t.BrowserName,i=t.BrowserBase,n=t.BrowserVersion,s=t.BrowserBaseVersion,o=t.OSFamily,r=t.OSVersion,a=t.isMobile;return e&&"string"==typeof e&&n&&("string"==typeof n||"number"==typeof n)||i&&"string"==typeof i&&s&&("string"==typeof s||"number"==typeof s)||o&&"string"==typeof o&&r&&("string"==typeof r||"number"==typeof r)&&a?{isValid:!0}:{isValid:!1,error:"BrowserName/BrowserBase and BrowserVersion/BrowserBaseVersion are required and must be strings or number"}}(e),r=o.isValid,a=o.error;if(!r)throw new qt({message:"UATraits: "+a,owner:"frontend",sourceType:"logic"});switch(i){case"desktop":s=Yt;break;case"tablet":s=te;break;case"mobile":s=Jt;break;default:throw new qt({message:"No uatraits type",owner:"frontend",sourceType:"logic"})}var c=s(e),l=c.is_supported,h=c.build_name;if(!l)throw new qt({message:"Zen Library does not support current browser",owner:"frontend",sourceType:"logic"});return h}({uatraits:i,uatraitsType:l,useLegacy:n,isDev:s}),precacheKey:t.cache&&t.cache.precacheKey||null,precacheRid:t.cache&&t.cache.precacheRid||null,zenFeatures:_,cache:a})}),Ee=function(t,e,i){Ft.on(t,e,i)},Me=function(t,e){Ft.off(t,e)};Lt.addListener("notShownPackUpdated",function(t,e){Ft.emit("cachePut",e)});var xe={preload:o()(function(t){!function(t){var e=t.host,i=t.clid,n=t.referrerClid,s=t.referrerPlace,o=t.countryCode,r=t.exps,a=t.staticHost,c=t.version,l=t.lang,h=t.buildName,u=t.bundleName,d=t.zenFeatures,m=t.cache,p=t.precacheKey,f=t.precacheRid,_=t.userInfo,g=t.isAdblock,v=t.useChunkedBundle,b=t.feedFilter,y=t.container;ye({host:e,clid:i,referrerClid:n,referrerPlace:s,countryCode:o,exps:r,zenFeatures:d,cache:m,precacheKey:p,precacheRid:f,userInfo:_,feedFilter:b,isAdblock:g}).catch(function(){});var w=(void 0)({staticHost:a,version:c,lang:l,buildName:h,bundleName:u,isChunkedBundle:v,isAdblock:g}),k=g;v?(ue("//yastatic.net/react/16.4.2/react-with-dom.min.js",!1),ue(w,k)):ue(w,k),g||ve({staticHost:a,version:c,bundleName:u,container:y}).catch(function(){})}(ke(t))}),create:function(t){return Promise.resolve().then(function(){if("LOADING"===we)throw new qt({message:"Loader is in progress already",owner:"frontend",sourceType:"logic"});if("LOADED"===we)throw new qt({message:"Lib has been loaded already",owner:"frontend",sourceType:"logic"});var e,i,n,s,r,a,c,l,h,u,m,p,f,_,g,v,b,y,w,k,E,M,x,T=ke(t);return"object"==typeof T.loggerParams&&d.configure(T.loggerParams),we="LOADING",(e=T,i=e.libType,n=e.host,s=e.clid,r=e.referrerClid,a=e.referrerPlace,c=e.countryCode,l=e.exps,h=e.staticHost,u=e.version,m=e.lang,p=e.buildName,f=e.bundleName,_=e.zenFeatures,g=e.cache,v=e.precacheKey,b=e.precacheRid,y=e.userInfo,w=e.isAdblock,k=e.useChunkedBundle,E=e.chromeExtensionId,M=e.feedFilter,x=e.container,new Promise(function(t,e){var d="yabro"===i||"yabroMorda"===i?null:ye({host:n,clid:s,referrerClid:r,referrerPlace:a,countryCode:c,exps:l,zenFeatures:_,cache:g,precacheKey:v,precacheRid:b,userInfo:y,feedFilter:M,chromeExtensionId:E,isAdblock:w}).catch(function(t){throw ye=o()(be),t}),T=w?null:ve({staticHost:h,version:u,bundleName:f,container:x}).catch(function(t){throw ve=o()(T),t});wt("yabro"===i?6e5:15e3).then(function(){e(new qt({message:"Not loaded resources in timeout: "+fe.getInProgress().join(","),owner:"frontend",sourceType:"network"}))}),Promise.all([k?function(t){var e=t.staticHost,i=t.version,n=t.lang,s=t.buildName,o=t.bundleName,r=t.isAdblock;fe.start("react-chunk"),fe.start("js-chunk");var a=r,c=ge({staticHost:e,version:i,lang:n,buildName:s,bundleName:o,isChunkedBundle:!0,isAdblock:r});return pe("//yastatic.net/react/16.4.2/react-with-dom.min.js",{invalidate:!0,crossorigin:!0,useCredentials:!1}).catch(function(){throw new qt({message:"Failed to load js react chunk",owner:"frontend",sourceType:"network"})}).then(function(){return fe.finish("react-chunk"),pe(c,{invalidate:!0,crossorigin:!0,useCredentials:a})}).catch(function(t){if(t instanceof qt)throw t;throw new qt({message:"Failed to load js chunk "+s,owner:"frontend",sourceType:"network"})}).then(function(){fe.finish("js-chunk")})}({staticHost:h,version:u,lang:m,buildName:p,bundleName:f,isAdblock:w}):function(t){var e=t.staticHost,i=t.version,n=t.lang,s=t.buildName,o=t.bundleName,r=t.isAdblock;fe.start("js");var a=ge({staticHost:e,version:i,lang:n,buildName:s,bundleName:o,isAdblock:r});return pe(a,{invalidate:!0,crossorigin:!0,useCredentials:r}).then(function(){fe.finish("js")}).catch(function(){throw new qt({message:"Failed to load js bundle "+s,owner:"frontend",sourceType:"network"})})}({staticHost:h,version:u,lang:m,buildName:p,bundleName:f,isAdblock:w}),T,d]).then(function(e){Ft.emit("timings",fe.getResults()),t({loadedResources:e})}).catch(e)})).then(function(t){var e=t.loadedResources[2];return function(t,e){if(!window[$t.NAMESPACE]||!window[$t.NAMESPACE].lib)throw new qt({message:"Error with Zen Library init",owner:"frontend",sourceType:"logic"});var i=window[$t.NAMESPACE].lib;return i.init(t,e),i}(T,e)}).then(function(t){return we="LOADED",t}).catch(function(t){throw we="READY",function(t){var e,i=t instanceof Error;if(i&&((e=t).message&&e.sourceType&&e.owner))return t;var n="";return i?n=t.toString():"string"==typeof t?n=t:t&&(n=(t.name||"")+(t.message||"")),new qt({message:"Unknown error. Ahtung! Attention! "+n+". JS error: "+i,sourceType:"unknown",owner:"somebody"})}(t)})})},on:Ee,off:Me,addListener:Ee,removeListener:Me,trigger:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];Nt.emit(t,i)}};window[$t.NAMESPACE]||(window[$t.NAMESPACE]={}),window[$t.NAMESPACE].loader=xe},function(t,e,i){var n=i(23),s=i(35).f,o={}.toString,r="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return r&&"[object Window]"==o.call(t)?function(t){try{return s(t)}catch(t){return r.slice()}}(t):s(n(t))}},function(t,e,i){var n=i(17);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,i){var n=i(24),s=i(52),o=i(37);t.exports=function(t){var e=n(t),i=s.f;if(i)for(var r,a=i(t),c=o.f,l=0;a.length>l;)c.call(t,r=a[l++])&&e.push(r);return e}},function(t,e,i){"use strict";var n=i(1),s=i(13),o=i(5),r=i(7),a=i(11),c=i(41).KEY,l=i(2),h=i(63),u=i(29),d=i(32),m=i(0),p=i(65),f=i(66),_=i(89),g=i(88),v=i(9),b=i(8),y=i(23),w=i(38),k=i(31),E=i(36),M=i(87),x=i(42),T=i(6),S=i(24),C=x.f,I=T.f,P=M.f,B=n.Symbol,D=n.JSON,O=D&&D.stringify,A=m("_hidden"),R=m("toPrimitive"),j={}.propertyIsEnumerable,L=h("symbol-registry"),F=h("symbols"),N=h("op-symbols"),$=Object.prototype,H="function"==typeof B,z=n.QObject,W=!z||!z.prototype||!z.prototype.findChild,U=o&&l(function(){return 7!=E(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=C($,e);n&&delete $[e],I(t,e,i),n&&t!==$&&I($,e,n)}:I,V=function(t){var e=F[t]=E(B.prototype);return e._k=t,e},q=H&&"symbol"==typeof B.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof B},K=function(t,e,i){return t===$&&K(N,e,i),v(t),e=w(e,!0),v(i),s(F,e)?(i.enumerable?(s(t,A)&&t[A][e]&&(t[A][e]=!1),i=E(i,{enumerable:k(0,!1)})):(s(t,A)||I(t,A,k(1,{})),t[A][e]=!0),U(t,e,i)):I(t,e,i)},G=function(t,e){v(t);for(var i,n=_(e=y(e)),s=0,o=n.length;o>s;)K(t,i=n[s++],e[i]);return t},Y=function(t){var e=j.call(this,t=w(t,!0));return!(this===$&&s(F,t)&&!s(N,t))&&(!(e||!s(this,t)||!s(F,t)||s(this,A)&&this[A][t])||e)},J=function(t,e){if(t=y(t),e=w(e,!0),t!==$||!s(F,e)||s(N,e)){var i=C(t,e);return!i||!s(F,e)||s(t,A)&&t[A][e]||(i.enumerable=!0),i}},X=function(t){for(var e,i=P(y(t)),n=[],o=0;i.length>o;)s(F,e=i[o++])||e==A||e==c||n.push(e);return n},Z=function(t){for(var e,i=t===$,n=P(i?N:y(t)),o=[],r=0;n.length>r;)!s(F,e=n[r++])||i&&!s($,e)||o.push(F[e]);return o};H||(a((B=function(){if(this instanceof B)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(i){this===$&&e.call(N,i),s(this,A)&&s(this[A],t)&&(this[A][t]=!1),U(this,t,k(1,i))};return o&&W&&U($,t,{configurable:!0,set:e}),V(t)}).prototype,"toString",function(){return this._k}),x.f=J,T.f=K,i(35).f=M.f=X,i(37).f=Y,i(52).f=Z,o&&!i(34)&&a($,"propertyIsEnumerable",Y,!0),p.f=function(t){return V(m(t))}),r(r.G+r.W+r.F*!H,{Symbol:B});for(var Q="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Q.length>tt;)m(Q[tt++]);for(var et=S(m.store),it=0;et.length>it;)f(et[it++]);r(r.S+r.F*!H,"Symbol",{for:function(t){return s(L,t+="")?L[t]:L[t]=B(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in L)if(L[e]===t)return e},useSetter:function(){W=!0},useSimple:function(){W=!1}}),r(r.S+r.F*!H,"Object",{create:function(t,e){return void 0===e?E(t):G(E(t),e)},defineProperty:K,defineProperties:G,getOwnPropertyDescriptor:J,getOwnPropertyNames:X,getOwnPropertySymbols:Z}),D&&r(r.S+r.F*(!H||l(function(){var t=B();return"[null]"!=O([t])||"{}"!=O({a:t})||"{}"!=O(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],s=1;arguments.length>s;)n.push(arguments[s++]);if(i=e=n[1],(b(e)||void 0!==t)&&!q(t))return g(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!q(e))return e}),n[1]=e,O.apply(D,n)}}),B.prototype[R]||i(14)(B.prototype,R,B.prototype.valueOf),u(B,"Symbol"),u(Math,"Math",!0),u(n.JSON,"JSON",!0)},function(t,e,i){i(66)("asyncIterator")},function(t,e,i){"use strict";var n=i(2);t.exports=function(t,e){return!!t&&n(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,i){"use strict";var n=i(7),s=i(33),o=i(28),r=i(2),a=[].sort,c=[1,2,3];n(n.P+n.F*(r(function(){c.sort(void 0)})||!r(function(){c.sort(null)})||!i(92)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),s(t))}})},function(t,e,i){"use strict";var n=i(6),s=i(31);t.exports=function(t,e,i){e in t?n.f(t,e,s(0,i)):t[e]=i}},function(t,e,i){"use strict";var n=i(18),s=i(7),o=i(28),r=i(81),a=i(80),c=i(59),l=i(94),h=i(79);s(s.S+s.F*!i(55)(function(t){Array.from(t)}),"Array",{from:function(t){var e,i,s,u,d=o(t),m="function"==typeof this?this:Array,p=arguments.length,f=p>1?arguments[1]:void 0,_=void 0!==f,g=0,v=h(d);if(_&&(f=n(f,p>2?arguments[2]:void 0,2)),void 0==v||m==Array&&a(v))for(i=new m(e=c(d.length));e>g;g++)l(i,g,_?f(d[g],g):d[g]);else for(u=v.call(d),i=new m;!(s=u.next()).done;g++)l(i,g,_?r(u,f,[s.value,g],!0):s.value);return i.length=g,i}})},function(t,e,i){"use strict";var n=i(68),s=i(40);t.exports=i(67)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(s(this,"Map"),t);return e&&e.v},set:function(t,e){return n.def(s(this,"Map"),0===t?0:t,e)}},n,!0)},function(t,e,i){var n=i(1),s=i(43),o=i(6).f,r=i(35).f,a=i(46),c=i(51),l=n.RegExp,h=l,u=l.prototype,d=/a/g,m=/a/g,p=new l(d)!==d;if(i(5)&&(!p||i(2)(function(){return m[i(0)("match")]=!1,l(d)!=d||l(m)==m||"/a/i"!=l(d,"i")}))){l=function(t,e){var i=this instanceof l,n=a(t),o=void 0===e;return!i&&n&&t.constructor===l&&o?t:s(p?new h(n&&!o?t.source:t,e):h((n=t instanceof l)?t.source:t,n&&o?c.call(t):e),i?this:u,l)};for(var f=function(t){t in l||o(l,t,{configurable:!0,get:function(){return h[t]},set:function(e){h[t]=e}})},_=r(h),g=0;_.length>g;)f(_[g++]);u.constructor=l,l.prototype=u,i(11)(n,"RegExp",l)}i(56)("RegExp")},function(t,e,i){"use strict";var n=i(68),s=i(40);t.exports=i(67)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return n.def(s(this,"Set"),t=0===t?0:t,t)}},n)},function(t,e){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(t,e,i){var n=i(7),s=i(15),o=i(2),r=i(99),a="["+r+"]",c=RegExp("^"+a+a+"*"),l=RegExp(a+a+"*$"),h=function(t,e,i){var s={},a=o(function(){return!!r[t]()||""!=""[t]()}),c=s[t]=a?e(u):r[t];i&&(s[i]=c),n(n.P+n.F*a,"String",s)},u=h.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(l,"")),t};t.exports=h},function(t,e,i){var n=i(8),s=i(9),o=function(t,e){if(s(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=i(18)(Function.call,i(42).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return o(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:o}},function(t,e,i){"use strict";var n=i(1),s=i(13),o=i(17),r=i(43),a=i(38),c=i(2),l=i(35).f,h=i(42).f,u=i(6).f,d=i(100).trim,m=n.Number,p=m,f=m.prototype,_="Number"==o(i(36)(f)),g="trim"in String.prototype,v=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){var i,n,s,o=(e=g?e.trim():d(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(i=e.charCodeAt(2))||120===i)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:n=2,s=49;break;case 79:case 111:n=8,s=55;break;default:return+e}for(var r,c=e.slice(2),l=0,h=c.length;l<h;l++)if((r=c.charCodeAt(l))<48||r>s)return NaN;return parseInt(c,n)}}return+e};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof m&&(_?c(function(){f.valueOf.call(i)}):"Number"!=o(i))?r(new p(v(e)),i,m):v(e)};for(var b,y=i(5)?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;y.length>w;w++)s(p,b=y[w])&&!s(m,b)&&u(m,b,h(p,b));m.prototype=f,f.constructor=m,i(11)(n,"Number",m)}},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,i){var n=i(7);n(n.S,"Object",{is:i(103)})},function(t,e,i){var n=i(7),s=i(16),o=i(2);t.exports=function(t,e){var i=(s.Object||{})[t]||Object[t],r={};r[t]=e(i),n(n.S+n.F*o(function(){i(1)}),"Object",r)}},function(t,e,i){var n=i(0)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,i){var n=i(46),s=i(15);t.exports=function(t,e,i){if(n(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(s(t))}},function(t,e,i){i(49)("replace",2,function(t,e,i){return[function(n,s){"use strict";var o=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,o,s):i.call(String(o),n,s)},i]})},function(t,e,i){var n=i(58),s=i(15);t.exports=function(t){return function(e,i){var o,r,a=String(s(e)),c=n(i),l=a.length;return c<0||c>=l?t?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===l||(r=a.charCodeAt(c+1))<56320||r>57343?t?a.charAt(c):o:t?a.slice(c,c+2):r-56320+(o-55296<<10)+65536}}},function(t,e,i){var n=i(13),s=i(28),o=i(54)("IE_PROTO"),r=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=s(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?r:null}},function(t,e,i){var n=i(6),s=i(9),o=i(24);t.exports=i(5)?Object.defineProperties:function(t,e){s(t);for(var i,r=o(e),a=r.length,c=0;a>c;)n.f(t,i=r[c++],e[i]);return t}},function(t,e,i){"use strict";var n=i(36),s=i(31),o=i(29),r={};i(14)(r,i(0)("iterator"),function(){return this}),t.exports=function(t,e,i){t.prototype=n(r,{next:s(1,i)}),o(t,e+" Iterator")}},function(t,e,i){i(5)&&"g"!=/./g.flags&&i(6).f(RegExp.prototype,"flags",{configurable:!0,get:i(51)})},function(t,e,i){var n=i(7),s=i(2),o=i(15),r=/"/g,a=function(t,e,i,n){var s=String(o(t)),a="<"+e;return""!==i&&(a+=" "+i+'="'+String(n).replace(r,"&quot;")+'"'),a+">"+s+"</"+e+">"};t.exports=function(t,e){var i={};i[t]=e(a),n(n.P+n.F*s(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",i)}},function(t,e,i){var n=i(58),s=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?s(t+e,0):o(t,e)}},function(t,e,i){"use strict";var n=i(24),s=i(52),o=i(37),r=i(28),a=i(74),c=Object.assign;t.exports=!c||i(2)(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=c({},t)[i]||Object.keys(c({},e)).join("")!=n})?function(t,e){for(var i=r(t),c=arguments.length,l=1,h=s.f,u=o.f;c>l;)for(var d,m=a(arguments[l++]),p=h?n(m).concat(h(m)):n(m),f=p.length,_=0;f>_;)u.call(m,d=p[_++])&&(i[d]=m[d]);return i}:c},function(t,e){t.exports=function t(e,i){if(e&&i)return t(e)(i);if("function"!=typeof e)throw new TypeError("need wrapper function");return Object.keys(e).forEach(function(t){n[t]=e[t]}),n;function n(){for(var t=new Array(arguments.length),i=0;i<t.length;i++)t[i]=arguments[i];var n=e.apply(this,t),s=t[t.length-1];return"function"==typeof n&&n!==s&&Object.keys(s).forEach(function(t){n[t]=s[t]}),n}}},function(t,e,i){var n=i(9),s=i(8),o=i(76);t.exports=function(t,e){if(n(t),s(e)&&e.constructor===t)return e;var i=o.f(t);return(0,i.resolve)(e),i.promise}},function(t,e,i){var n=i(1).navigator;t.exports=n&&n.userAgent||""},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,i){var n=i(1),s=i(78).set,o=n.MutationObserver||n.WebKitMutationObserver,r=n.process,a=n.Promise,c="process"==i(17)(r);t.exports=function(){var t,e,i,l=function(){var n,s;for(c&&(n=r.domain)&&n.exit();t;){s=t.fn,t=t.next;try{s()}catch(n){throw t?i():e=void 0,n}}e=void 0,n&&n.enter()};if(c)i=function(){r.nextTick(l)};else if(!o||n.navigator&&n.navigator.standalone)if(a&&a.resolve){var h=a.resolve(void 0);i=function(){h.then(l)}}else i=function(){s.call(n,l)};else{var u=!0,d=document.createTextNode("");new o(l).observe(d,{characterData:!0}),i=function(){d.data=u=!u}}return function(n){var s={fn:n,next:void 0};e&&(e.next=s),t||(t=s,i()),e=s}}},function(t,e){t.exports=function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},function(t,e,i){var n=i(9),s=i(33),o=i(0)("species");t.exports=function(t,e){var i,r=n(t).constructor;return void 0===r||void 0==(i=n(r)[o])?e:s(i)}},function(t,e){var i=window,n=function(t,e,n,s){var o,r=i.document,a=r.createElement("link");if(e)o=e;else{var c=(r.body||r.getElementsByTagName("head")[0]).childNodes;o=c[c.length-1]}var l=r.styleSheets;a.rel="stylesheet",a.href=t,a.media="only x",function t(e){if(r.body)return e();setTimeout(function(){t(e)})}(function(){o.parentNode.insertBefore(a,e&&!s?o:o.nextSibling)});var h=function t(e){for(var i=a.href,n=l.length;n--;)if(l[n].href===i)return e();setTimeout(function(){t(e)})};function u(){a.addEventListener&&a.removeEventListener("load",u),a.media=n||"all"}return a.addEventListener&&a.addEventListener("load",u),a.onloadcssdefined=h,h(u),a};i.loadCSS=n;var s=n.relpreload={};if(s.support=function(){try{return i.document.createElement("link").relList.supports("preload")}catch(t){return!1}},s.poly=function(){for(var t=i.document.getElementsByTagName("link"),e=0;e<t.length;e++){var n=t[e];"preload"===n.rel&&"style"===n.getAttribute("as")&&(i.loadCSS(n.href,n,n.getAttribute("media")),n.rel=null)}},!s.support()){s.poly();var o=i.setInterval(s.poly,300);i.addEventListener&&i.addEventListener("load",function(){s.poly(),i.clearInterval(o)}),i.attachEvent&&i.attachEvent("onload",function(){i.clearInterval(o)})}},function(t,e,i){"use strict";i.r(e),i(124)},function(t,e,i){window.fetch||(window.fetch=i(84).default||i(84))},function(t,e,i){i(126),i(125),t.exports=i(86)}])}}),BEM.decl("blender-logger",{},{MAX_ZEN_ROW_COUNT:50,initBlock:function(){this._inited||(this._inited=!0,this.updateMediaRows(),this._zenRows=[],this._zenInserter=BEM.blocks["zen-inserter"])},updateMediaRows:function(){this._mediaRows=this._getMediaRows()},_getMediaRows:function(){var t=$(".media-grid__media-content>[data-blockname]"),e=[],i=home.getData("media-grid.layoutMap",{});return t.each(function(){var t=$(this),n=t.attr("data-blockname");if(n in i&&"infinity_zen"!==n){var s=0;n&&t.is(":visible")&&(s=Math.floor(t.outerHeight(!0))),e.push({name:n,height:s})}}),e},updateZenRowsAndSendStat:function(t){var e=this._getDefaultZenRowHeight(),i=this._zenInserter.ZEN_ROW_FOR_BLENDER;this._zenRows=t.map(function(t,n){return t.name===i?{name:t.name+".row"+n,height:e}:t}),this.sendStat()},_getDefaultZenRowHeight:function(){if(this._defaultZenRowHeight)return this._defaultZenRowHeight;var t=$(".feed__row").first();return this._defaultZenRowHeight=t.length?t.outerHeight(!0):336,this._defaultZenRowHeight},_toStatFormat:function(t){return t.replace(/-/g,"_").replace(/\./g,"#")},logBlockShow:function(t){var e=this._toStatFormat(t);home.stat.logPath("show",e+".realshow")},sendStat:function(){var t=[];if((t=(t=t.concat(this._mediaRows)).concat(this._zenRows)).length>this.MAX_ZEN_ROW_COUNT&&(t=t.slice(0,this.MAX_ZEN_ROW_COUNT)),t.every(function(t){return t&&"number"==typeof t.height&&"string"==typeof t.name})){var e=t.map(function(t){return this._toStatFormat(t.name)+"="+t.height},this).join(",");home.stat.logPath("media_services_height",e)}}}),BEM.decl("zen-inserter",{},{EMPTY_PLACEHOLDER:"EMPTY",PLACEHOLDER_FROM_ZEN:"Placeholder",ZEN_ROW_FOR_BLENDER:"infinity-zen",CLASS_NAME:"zen-insert",RENDERED_BLOCKS:{},BLOCK_NAME_TO_HEIGHT:{},initBlock:function(){this._inited||(this._inited=!0,this._blocks=home.getData("zen-inserter.blocks",[]),this._rows=[],this._blocks&&(this._blenderLogger=BEM.blocks["blender-logger"],this._blenderLogger.initBlock()))},logRealShow:function(t){if(this._blocks){var e=t.index,i=this._blocks[e];i&&this.RENDERED_BLOCKS[i]&&this.BLOCK_NAME_TO_HEIGHT[i]&&this._blenderLogger.logBlockShow(i)}},onZenRowsUpdated:function(t){if(this._blocks){var e=0,i=t.map(function(t){if(t!==this.PLACEHOLDER_FROM_ZEN)return{name:this.ZEN_ROW_FOR_BLENDER,height:null};var i=this._blocks[e]||this.EMPTY_PLACEHOLDER,n=this.BLOCK_NAME_TO_HEIGHT[i]||0;return e++,{name:i,height:n}},this);this._blenderLogger.updateZenRowsAndSendStat(i)}},renderBlock:function(t,e){var i=this._getHtml(t,e);if(!i)return $();var n=$(i);return n.addClass(this.CLASS_NAME),n},renderAfter:function(t,e,i){var n=this.renderBlock(t,i);return n.removeClass(this.CLASS_NAME),n.insertAfter(e),BEM.DOM.init(n),home.stat.logDOMShow(n),n},render:function(t){if(this._blocks){var e=t.container,i=t.index,n=this._blocks[i];if(n){var s=this.renderBlock(n);$(e).append(s),BEM.DOM.init(s),home.stat.logDOMShow(s),this.BLOCK_NAME_TO_HEIGHT[n]=Math.floor(s.outerHeight(!0)),this._rows.push(s)}}},hide:function(t){var e=t.data("blockname");t.remove(),this.BLOCK_NAME_TO_HEIGHT.hasOwnProperty(e)?this.BLOCK_NAME_TO_HEIGHT[e]=0:this._blenderLogger&&this._blenderLogger.updateMediaRows(),BEM.blocks["i-reposition-event"].trigger()},_getHtml:function(t,e){if(this.RENDERED_BLOCKS[t])return"";var i=home.view("media-grid__layout-to-block-name",t),n=home.view("media-grid__row",{view:i+"__client-view",layoutName:t,blockParams:{layoutName:t},expand:e&&e.expand},{zenInsert:!0});return n&&(this.RENDERED_BLOCKS[t]=!0),n},renderAllBefore:function(t){if(this._blocks){this._blenderLogger.updateZenRowsAndSendStat([]);var e=this._blocks.map(this._getHtml,this).join("");if(e){var i=$(e);i.insertBefore(t),BEM.DOM.init(i),home.stat.logDOMShow(i)}}},pullOutAllBefore:function(t){this._rows.forEach(function(e){e.removeClass("zen-insert").insertBefore(t)}),this._rows=[],this.renderAllBefore(t)}}),BEM.DOM.decl({name:"infinity-zen",baseBlock:"media-service"},{onSetMod:{js:function(){this._zenLib=this.findBlockInside("zen-lib"),this._grid=$(".media-grid").bem("media-grid"),this._grid.hasMod("collapsed","yes")||this._onGridExpand(),this._grid.on("collapsed",this._onGridCollapse,this),this._grid.on("expanded",this._onGridExpand,this);var t=BEM.blocks["zen-inserter"];t.initBlock(),this._debouncedRowsUpdated=$.debounce(t.onZenRowsUpdated.bind(t),this.DEBOUNCE_ZEN_ROWS_UPDATED_TIMEOUT),this._zenRow=this.domElem.closest(".media-grid__row"),this._zenLib.on("placeholder",function(e,i){t.render(i)}),this._zenLib.on("rowsChanged",function(t,e){this._debouncedRowsUpdated(e)}.bind(this)),this._zenLib.on("placeholderShow",function(e,i){t.logRealShow(i)}),this._zenLib.on("lateRendering",this.changeThis(function(){t.renderAllBefore(this._zenRow)})),this._zenLib.on("error",function(){t.renderAllBefore(this._zenRow)}.bind(this)),this._zenLib.on("error",function(){this._showAlert()},this),this.domElem.is(":visible")&&!this.elem("content-suffix").is(":visible")&&this._showAlert(),this.params.needForceLoad&&this.forceLoad(),this._initMenuEvents()},collapsed:{yes:function(){BEM.blocks["zen-inserter"].pullOutAllBefore(this._zenRow)},"":function(){this._zenLib.loadAndRender()}}},_getMenuId:function(){return"infinity_zen"},_showAlert:function(){this.hasMod("alert")||this.params.alert&&(this.domElem.append(home.view("infinity-zen__alert",this.params.alert)),this.setMod("alert","yes"),home.stat.logPath("show",this.params.statRoot+".alert"))},destruct:function(){this.channel("i-reposition-event").un("reposition",this._updateScroll,this),this.__base.apply(this,arguments)},forceLoad:function(){this._grid.hasMod("collapsed","yes")||this._isHidden()||this._zenLib.loadAndRender({isForceLoad:!0})},_appendContent:function(){this._grid.hasMod("collapsed","yes")||this._isHidden()||this._zenLib.loadAndRender()},_onGridCollapse:function(){this.channel("i-reposition-event").un("reposition",this._updateScroll,this)},_onGridExpand:function(){this.channel("i-reposition-event").on("reposition",this._updateScroll,this);var t=this.__self.HEADER_HEIGHT_PX-this.__self.SCROLL_PX;this._updateScroll(null,BEM.DOM.win.scrollTop()-t)},_updateScroll:function(t,e){var i=window.innerHeight;e-this.domElem.offset().top+i>this.__self.SCROLL_PX&&(t?this._appendContent():this.forceLoad())}},{SCROLL_PX:-200,HEADER_HEIGHT_PX:50,DEBOUNCE_ZEN_ROWS_UPDATED_TIMEOUT:1e3,live:!1}),BEM.DOM.decl("media-infinity-footer",{onSetMod:{js:{inited:function(){this._$mediaGrid=$(".media-grid"),this._grid=this._$mediaGrid.bem("media-grid"),this._$content=$(".media-infinity-footer__content"),this._grid.hasMod("collapsed","yes")||this._onGridExpand(),this._grid.on("collapsed",this._onGridCollapse,this),this._grid.on("expanded",this._onGridExpand,this),this.bindTo("up","click",this._scrollToTop),this.bindTo(this._$content.find(".media-infinity-footer__toggler"),"click",this._onTogglerClick),this.bindKeyTo(this._$content.find(".media-infinity-footer__toggler"),"space enter",this._onTogglerClick);var t=this.findElem(this._$content,"collapsed-settings");this.bindTo(t,"click",this._onCollapsedSettingsClick),this.bindKeyTo(t,"space enter",this._onCollapsedSettingsClick),"fixed"!==this._$content.css("position")||this.bindToWin("scroll",this._updateHorizontalScroll),this.bindTo(this._$content,"focusin",this._onFocusIn)}}},_onGridCollapse:function(){this.channel("i-reposition-event").un("reposition",this._updateVerticalScroll,this),this.trigger("toggleFooter",!1)},_onGridExpand:function(){this.channel("i-reposition-event").on("reposition",this._updateVerticalScroll,this),this._updateVerticalScroll(null,BEM.DOM.win.scrollTop())},_updateHorizontalScroll:function(){var t=BEM.DOM.win.scrollLeft();this._prevScrollLeft!==t&&(this._prevScrollLeft=t,this._$content.css("margin-left",-t))},_updateVerticalScroll:function(t,e){if(!$(":focus").closest(this._$content).length){var i=this._$mediaGrid.offset().top,n=window.innerHeight,s=document.body.scrollHeight,o=e>i||s-e-n<200,r=e>i;o!==this.hasMod(this._$content,"visible","yes")&&(this.toggleMod(this._$content,"visible","yes",o),this.trigger("toggleFooter",o)),this.toggleMod("arrow-visible","yes",r)}},_scrollToTop:function(){$("html,body").stop().animate({scrollTop:0},"fast")},_onTogglerClick:function(){this.trigger("toggle")},_onFocusIn:function(){this.hasMod(this._$content,"visible","yes")||(this.setMod(this._$content,"visible","yes"),this.trigger("toggleFooter",!0))},_onCollapsedSettingsClick:function(){BEM.blocks["hidden-blocks-popup"].show()}}),BEM.DOM.decl("hidden-blocks-popup",{onSetMod:{js:{inited:function(){var t=this.findBlockOutside("modal");t.on("afterClose",function(){home.stat.logPath("click","hidden_blocks_popup.cancel")}),this.findBlockInside("cancel","button").on("click",function(){t.delMod("visible")},this),this.findBlockInside("submit","button").on("click",function(){var t=[],e=[];this.elem("item").toArray().forEach(function(i){var n=$(i),s=this.findBlockInside(n,"tumbler").hasMod("checked","yes"),o=n.data("layoutName");(s?e:t).push(o)},this),home.stat.logPath("click","hidden_blocks_popup.save",{callback:function(){location.href=home.addQueryToUrl(home.getData("hidden-blocks-popup.changeUrl"),{fold:t.join(","),unfold:e.join(",")})}})},this),BEM.blocks.tumbler.on(this.domElem,"change",function(t,e){if(!this._updateInternalState){var i=t.target.domElem.closest("[data-layout-name]").data("layoutName");home.stat.logPath("click","hidden_blocks_popup.item."+i+"."+(e.checked?"show":"hide"))}},this)}}},_updateHiddenState:function(t){home.getData("hidden-blocks-popup.blocks").forEach(function(e){e.layoutName in t||(t[e.layoutName]=e.isHidden)}),this._updateInternalState=!0,this.elem("item").toArray().forEach(function(e){var i=$(e),n=i.data("layoutName");this.findBlockInside(i,"tumbler").toggleMod("checked","yes",!t[n])},this),this._updateInternalState=!1}},{show:function(){if(!this._popup){var t=$(home.view("modal",{content:home.view("hidden-blocks-popup__content",home.getData("hidden-blocks-popup.blocks"),{}),mods:{autoclosable:"yes",theme:"normal","scrollbar-hider":"yes"}})).appendTo("body");BEM.DOM.init(t),this._popup=t.bem("modal"),this._instance=this._popup.findBlockInside("hidden-blocks-popup")}this._instance._updateHiddenState(this._hiddenMap),this._popup.setMod("visible","yes")},_init:function(){this._hiddenMap={},BEM.channel("media-service").on("remove",function(t,e){this._hiddenMap[e.layoutName]=!0},this)}}),$(function(){BEM.blocks["hidden-blocks-popup"]._init()}),BEM.DOM.decl("modal",{onSetMod:{js:{inited:function(){this._popup=this.findBlockOn("popup2")}},visible:function(t,e){var i=e?"Open":"Close",n=this.elem("content"),s=window.getComputedStyle?window.getComputedStyle(n[0]):n[0].currentStyle,o=parseFloat(s.animationDuration)>0?"animationend":parseFloat(s.webkitAnimationDuration)>0?"webkitAnimationEnd":"",r=function(){this.trigger("after"+i)};this.trigger("before"+i)._popup.setMod(t,e),o?n.one(o,r.bind(this)):this.afterCurrentEvent(r)}},destruct:function(){this.delMod("visible").__base.apply(this,arguments)},setContent:function(t){return BEM.DOM.update(this.elem("content"),t),this}},{live:!0}),BEM.DOM.decl("modal",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._enforceRepaint=this._enforceRepaint.bind(this)}},visible:{yes:function(){this.__base.apply(this,arguments),window.attachEvent&&this.elem("content")[0].attachEvent("onresize",this._enforceRepaint)},"":function(){this.__base.apply(this,arguments),window.detachEvent&&this.elem("content")[0].detachEvent("onresize",this._enforceRepaint)}}},_enforceRepaint:function(){this.domElem[0].className+=""}}),BEM.DOM.decl("modal",{attachToScope:function(t){return this._popup.attachToScope(t)}}),BEM.DOM.decl("modal",{},{live:function(){var t=this.__base.apply(this,arguments);function e(){this.delMod("visible")}return this.liveBindTo("close","pointerclick",e),this.liveBindKey("close","space enter",e),t}}),BEM.DOM.decl({block:"modal",modName:"autoclosable",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._preventHideByClick=!1}},visible:{yes:function(){this.__base.apply(this,arguments),this.bindTo("content","pointerdown pointerclick",this._setPreventHideByClick).bindTo("pointerclick",this._onPointerClick)._popup.on("beforeClose",this._onPopupClose,this)},"":function(){this.__base.apply(this,arguments),this.unbindFrom("content","pointerdown pointerclick").unbindFrom("pointerclick")._popup.un("beforeClose",this._onPopupClose,this)}}},_setPreventHideByClick:function(t){this._preventHideByClick=!0},_onPointerClick:function(t){this._preventHideByClick||this.delMod("visible"),this._preventHideByClick=!1},_onPopupClose:function(){this.delMod("visible")}}),BEM.DOM.decl({block:"modal",modName:"theme",modVal:"normal"},{onSetMod:{visible:{yes:function(){this.setMod("has-animation","yes").__base.apply(this,arguments)}}}}),BEM.DOM.decl({block:"modal",modName:"scrollbar-hider",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.on({beforeOpen:this._toggleScrollbar.bind(this,!1),afterClose:this._toggleScrollbar.bind(this,!0)})}}},_toggleScrollbar:function(t){var e;e=t?0:this._getCurrentScrollWidth(),BEM.DOM.scope.css("margin-right",e).toggleClass("body_modal_yes",!t)},_getCurrentScrollWidth:function(){var t=document.documentElement;return"number"==typeof window.innerWidth?window.innerWidth-t.clientWidth:t.scrollHeight>t.clientHeight?this._getScrollWidth():0},_getScrollWidth:function(){if(null!==this._scrollWidth)return this._scrollWidth;var t=$("<div>").css({position:"absoulte",left:0,top:0,overflow:"scroll",width:200,height:200}).appendTo("body");return this._scrollWidth=200-t[0].scrollWidth,t.remove(),this._scrollWidth}}),BEM.DOM.decl({block:"tumbler"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._inputValues=this.elemParams(this.elem("input"))._values,this._labelsLength=this.elem("label").length,this._buttonWidth=this.elem("button").width(),this._maxLeft=this.elem("box").width()-this._buttonWidth}},checked:function(t,e){var i=this._inputValues[e?1:0],n=2===this._labelsLength?this.elem("text","side",e?"right":"left")[0].id:this.elem("text").length?this.elem("text")[0].id:"";this.elem("input").attr("aria-labelledby",n).val(i).prop("checked",e),this.elem("button").attr("aria-pressed",Boolean(e)),this.trigger("change",{checked:Boolean(e),value:this.val()})},disabled:function(t,e){this.__base.apply(this,arguments),this.findBlockOn("button","button2").setMod("disabled",e),this.elem("input").prop("disabled",Boolean(e))}},val:function(t){return void 0===t?this.elem("input").val():-1===this._inputValues.indexOf(t)||this.val()===t?this:this._toggle()},_toggle:function(){return this.toggleMod("checked","yes",!this.elem("input").prop("checked")),this},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onStickerClick:function(){this._toggle(),this.findBlockOn(this.elem("button"),"button2").setMod("focused","yes")},_onLabelClick:function(t){this._shouldChange(t)&&(this._toggle(),this.findBlockOn(this.elem("button"),"button2").setMod("focused","yes"))},_onButtonClick:function(){this._toggle()},_onButtonFocus:function(){this.setMod(this.elem("button"),"focused","yes"),this.setMod("focused","yes")},_onButtonBlur:function(){this.delMod(this.elem("button"),"focused"),this.delMod("focused")},_shouldChange:function(t){var e="left"===this.getMod(t.data.domElem,"side");if(2===this._labelsLength){var i=!e&&this.elem("input").prop("checked");if(e&&!this.elem("input").prop("checked")||i)return!1}return!0}},{live:function(){return this.liveInitOnBlockInsideEvent("focus","button2",function(){this.hasMod("disabled")||this._onButtonFocus()}).liveInitOnBlockInsideEvent("blur","button2",function(){this.hasMod("disabled")||this._onButtonBlur()}).liveInitOnBlockInsideEvent("click","button2",function(t){this.hasMod("disabled")||this._onButtonClick()}).liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("sticker","pointerclick",function(t){this.hasMod("disabled")||this._onStickerClick()}).liveBindTo("label","pointerclick",function(t){this.hasMod("disabled")||this._onLabelClick(t)}).liveBindTo("button","keydown",function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||BEM.blocks.keycodes.is(t.keyCode,"SPACE","LEFT","UP","RIGHT","DOWN")&&t.preventDefault()}).liveBindTo("button","keyup",function(t){var e=BEM.blocks.keycodes,i=t.keyCode;t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||(e.is(i,"LEFT","UP")?this.delMod("checked"):e.is(i,"RIGHT","DOWN")&&this.setMod("checked","yes"))}),this.__base()}}),BEM.DOM.decl("tumbler",{_onPointerenter:function(t){this.hasMod(this.elem("button"),"hovered")||this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")},_onButtonPointerenter:function(t){this.hasMod("view","classic")&&this.delMod("hovered").setMod(this.elem("button"),"hovered","yes")},_onButtonPointerleave:function(t){this.hasMod("view","classic")&&this.delMod(this.elem("button"),"hovered").setMod("hovered","yes")}},{live:function(){return this.liveBindTo("box","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("box")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("button","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("button")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onButtonPointerenter(t):this._onButtonPointerleave(t))}),this.__base()}}),BEM.DOM.declMix("mix-tabber-loader",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._dataPromises={}}}},_renderPanelInner:function(t,e,i){i?this.__base.apply(this,arguments):(e.append(this._renderLoader(t)).css("min-height",this._$panel.height()),this._loadAndDrawData(t,e))},_renderLoader:function(){return'<div class="'+this.__self.getName()+'__loader loader"></div>'},_afterPanelChange:function(t,e,i){this._data[t]||this._defaultPanels[t]?this.__base(t,e,i):BEM.DOM.init(e)},_loadAndDrawData:function(t,e){return this._loadDataWrapped(t).then(this._drawData.bind(this,t,e,!0),this._drawData.bind(this,t,e,!1))},_drawData:function(t,e,i){if(t===this._selectedKey){var n;try{i&&(n=this._getPanelHTML(t,this._data[t]))}catch(e){home.error.logError({block:this.__self.getName(),message:e,meta:{key:t},sourceType:"render"})}n||(n=this._getPanelRetry(t)),e.html(n),this._onPanelReplace(t,e),i?(this._onPanelDraw(t,e),this._onPanelChange(t,e)):home.stat.logDOMShow(e)}},_onPanelReplace:function(t,e){e.css("min-height","")},_loadDataWrapped:function(t,e){return e=e||{},this._dataPromises[t]||this._data[t]&&!e.forceReload?this._dataPromises[t]||Promise.resolve(this._data[t]):(this._dataPromises[t]=this._loadData(t).then(function(e){return e&&(this._data[t]=e),e}.bind(this),function(e){throw this._dataPromises[t]=null,home.error.logError({block:this.__self.getName(),message:e,meta:{key:t},sourceType:"network"}),e}.bind(this)),this._dataPromises[t])},_loadData:function(){return Promise.reject("Not implemented")},_getPanelRetry:function(t){return home.view("mix-tabber-loader__retry",{buttonMods:this._getRetryButtonMods(),key:t,block:this.__self.getName(),statRoot:this._statRoot})},_getRetryButtonMods:function(){return{theme:this.params.retryButtonTheme,size:"s"}},_onRetryClick:function(t){var e=this._panels[t];e&&(e.html(this._renderLoader(t)),BEM.DOM.init(e),this._loadAndDrawData(t,e))}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("retry-button","pointerclick",function(t){return this._onRetryClick(String(t.data.domElem.data("key"))),!1})}}),BEM.DOM.declMix("mix-tabber-loader-keyboard",{},{live:function(){this.__base.apply(this,arguments),this.liveBindKey("retry-button","space enter",function(){this._onRetryClick()})}}),BEM.DOM.declMix("mix-tabber-labels-preloader",{},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("tab","mouseover mouseout",function(t){var e=t.data.domElem.data("key");String(e)!==String(this._selectedKey)&&(clearTimeout(this._tabPreloadTimer),"mouseover"!==t.type||this._panels[e]||(this._tabPreloadTimer=setTimeout(function(){this._loadDataWrapped(e).catch(function(){})}.bind(this),200)))})}}),BEM.DOM.decl({block:"kinopoisk",baseBlock:"media-service",baseMix:["mix-tabber","mix-tabber-labels","mix-tabber-labels-keyboard","mix-tabber-loader","mix-tabber-loader-keyboard","mix-tabber-labels-preloader"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages(this._$panel)}.bind(this),this.__self._scrollLoadImageThrottle),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._loadVisibleImages(),this.findBlockInside("carousel").on("listOut",this._loadMoreFilms,this)}}},_getInitData:function(){return home.getData("kinopoisk.data.data",{})},_getPanelHTML:function(t,e){return home.view("kinopoisk__panel",{films:e.films,title:e.title,id:t,logShow:!1})},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("media-service__panel"),t},_loadData:function(t){var e={CountryAllowed:this.params.country,kp_group_ids:t},i=home.getData("kinopoisk.data.kpRankExp");return i&&(e.kp_rank_exp=i),new Promise(function(t,i){$.ajax({url:home.addQueryToUrl("/portal/api/data/1/kinopoisk/",e),xhrFields:{withCredentials:!0},dataType:"json",timeout:15e3}).then(t,i)}).then(function(t){return t.block[0].data.groups[0]})},_initialLoadImages:function(){},_loadVisibleImages:function(t){var e=this.findElem(t||this.domElem,"wrap"),i=e.width()+e.scrollLeft(),n=Math.ceil(i/this.__self._filmWidth),s=this.findElem(t||this.domElem,"film").slice(0,n);home.stat.logDOMShow(s,{visibilityCheck:!1}),this._loadImages(s)},_selectImageUrl:function(t,e){return e+((window.devicePixelRatio||1)>1.1?"300x450":"150x225")},_onPanelDraw:function(t,e){BEM.DOM.init(e),this.findElem(e,"wrap").on("scroll",this._scrollThrottledHandler)},_onPanelChange:function(t,e){this.__base.apply(this,arguments),this._loadVisibleImages(e),this.findBlockInside("carousel").setScrollMod()},_loadMoreFilms:function(){var t=this._selectedKey,e=this._$panel,i=this.findElem(e,"list"),n=this._data[this._defaultKey].films;this.findBlockInside("carousel").un("listOut",this._loadMoreFilms,this),i.append(home.view("kinopoisk__film-loader")),this._loadDataWrapped(t,{forceReload:!0}).then(function(){var s=this._filterLastFilms(n,this._data[t].films);this.findElem(i,"film-loader").remove(),i.append(home.view("kinopoisk__film-list",{films:s,title:this._data[t].title,id:t,logShow:!1,startIndex:i.children().length})),this._onPanelChange(t,e)}.bind(this)).catch(function(){this.findElem(i,"film-loader").remove()}.bind(this))},_filterLastFilms:function(t,e){var i={};return t.forEach(function(t){i[t.contentGroupUuid]=!0}),e.filter(function(t){return!(t.contentGroupUuid in i)})}},{live:function(){this.__base.apply(this,arguments),this.liveBindTo("film","pointerclick",function(){window.defaultMetrikaCounter&&window.defaultMetrikaCounter.reachGoal("kp_films_click")}),this.liveBindKey("film","space enter",function(t){home.stat.logPath("click",t.data.domElem.attr(home.stat.attr)),window.defaultMetrikaCounter&&window.defaultMetrikaCounter.reachGoal("kp_films_click")})},_filmWidth:136,_scrollLoadImageThrottle:200}),BEM.DOM.decl({block:"kinopoisk-control",baseBlock:"player-control"},{},{LOAD_TIMEOUT:1e4,TIMINGSUFFIX:567,testOptions:function(t){return t.selectionId&&this.__base(t)},beforePlay:function(t){return this.__base(t).then(function(){var e=home.getData("kinopoisk-control");if(!e)throw new Error("invalid data");if(!e.enabled)throw new Error("disabled");var i=$.extend({filmId:t.filmId,selectionId:t.selectionId,from_block:t.fromBlock,from_position:t.fromPosition},e.query);return{urlBase:e.urlBase,query:i}})},deleteFrame:function(){this.frame&&($(window).off("message.kinopoisk"),BEM.DOM.destruct(this.frame),this.frame=null)},openFrame:function(t){return this.deleteFrame(),new Promise(function(e,i){var n=this.getContainer(),s=this.frame=$('<iframe name="kinopoisk-frame" class="kinopoisk-control__frame" width="100%" height="100%" gesture="media" allowfullscreen allow="autoplay; fullscreen; encrypted-media"></iframe>'),o=setTimeout(function(){var t=Error("timeout");t.timeout=1,i(t)},this.LOAD_TIMEOUT);n.append(s),s.attr("src",home.makeUrl({path:t.urlBase,query:t.query})),$(window).on("message.kinopoisk",function(t){var i=t.originalEvent.data||{};t.originalEvent.source===s[0].contentWindow&&("show"===i.type&&(clearTimeout(o),e()),"hide"===i.type&&this.hide())}.bind(this)),s.one("error",function(t){$(window).off("message.kinopoisk"),i(t)})}.bind(this))},hide:function(){this.__base(),this.deleteFrame()},play:function(t){return this.openFrame(t)}}),BEM.DOM.decl("kinopoisk-control",{},{onPlaySuccess:function(){$("body").addClass("b-page_overflow_hidden"),this.__base()},hide:function(){$("body").removeClass("b-page_overflow_hidden"),this.__base()}}),home.prepareSpaces=function(t){return(t||"").replace(/(^|\s)(\S{1,2})(\s)/g,"$1$2&nbsp;")},function(){"use strict";var t={"":"a","":"b","":"v","":"g","":"d","":"e","":"e","":"j","":"z","":"i","":"y","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"f","":"h","":"c","":"ch","":"sh","":"sch","":"","":"i","":"","":"e","":"u","":"ya"};home.transliterate=function(e){return e.replace(/[-]/gi,function(e){var i=e.toLowerCase(),n=i!==e;return i in t&&(i=t[i],n&&(i=i.toUpperCase())),i})}}(),BEM.DOM.declMix("mix-tabber-select",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.blocks.select2.on(this.domElem,"change",function(t,e){this._selectTab(e.currVal,{parentKey:t.target.domElem.data("parent-key")})},this)}}}),BEM.DOM.decl({block:"afisha-inserts",baseBlock:"media-service",baseMix:["mix-tabber","mix-tabber-loader","mix-tabber-loader-keyboard","mix-tabber-labels","mix-tabber-labels-keyboard","mix-tabber-labels-preloader","mix-tabber-select"]},{onSetMod:{js:{inited:function(){if(this.__base.apply(this,arguments),this._cinemas={},this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages(this._$panel)}.bind(this),this.__self.SCROLL_THROTTLE),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._loadVisibleImages(),this.params.logged){var t=this.findBlockOutside("media-grid");t&&t.hasMod("collapsed","yes")?t.onFirst("expanded",function(){this._loadFavorites()},this):(this.channel("i-reposition-event").on("reposition",this._onScroll,this),this._onScroll(void 0,BEM.DOM.win.scrollTop()))}}}},_getKeys:function(){return this.elem("tab").length?this.__base.apply(this,arguments):["cinema"]},_initialLoadImages:function(){},_loadVisibleImages:function(t){var e=this.findElem(t||this.domElem,"wrap"),i=e.width()+e.scrollLeft(),n=this.findElem(t||this.domElem,"event"),s=0;n.length&&(s=Math.ceil(i/(n.eq(0).width()+this.__self.EVENTS_MARGIN))),this._loadImages(n.slice(0,s))},_selectImageUrl:function(t,e){if("string"==typeof e)return e;e.base&&(e={"120x180":e.base+"/120x180","240x360":e.base+"/240x360","280x136":e.base+"/s280x136","560x272":e.base+"/s560x272"});var i="120x180";return t.hasClass("afisha-event-film__image")?window.devicePixelRatio>1&&(i="240x360"):t.hasClass("afisha-event-show__image")&&(i="280x136",window.devicePixelRatio>1&&(i="560x272")),e[i]},_isFilms:function(t){return 0===t.indexOf("cinema")},_onScroll:function(t,e){window.innerHeight+e>this.domElem.offset().top+this.__self.MIN_VISIBLE_HEIGHT&&(this.channel("i-reposition-event").un("reposition",this._onScroll,this),this._loadFavorites())},_loadFavorites:function(){var t="https://"+this.params.geohelperHost+"/geohelper/nogeoget";$.ajax({dataType:"json",url:t,context:this,xhrFields:{withCredentials:!0},timeout:this.__self.GEOHELPER_TIMEOUT,data:{geoid:this.params.geoId,lang:this.params.locale,unsessions:1}}).then(function(t){this._appendFavouriteTabs(t&&t.afisha)},function(e,i,n){home.error.logAjaxError({block:"afisha-inserts",message:"_loadFavorites: ajax",url:t,source:"geohelper_nogeoget"},e,i,n)})},_appendFavouriteTabs:function(t){if(t&&t.length){var e="normal",i="n",n=i;this.domElem.hasClass("media-service_inline-tabs_yes")&&(e="inline-media",i="inline-media",n="n"),this.elem("tabs").append(home.view("mix-tabber-select",{mods:{type:"radio",view:"default",tone:"default",text:"vary",theme:e,size:i,menuSize:n,fade:"yes",native:this.params.nativeSelect?"yes":void 0},mix:"afisha-inserts__select",items:[{text:home.l10n("afisha.defaultTabLong"),val:"cinema",attrs:{"data-statlog":"afisha_inserts.select.cinema.all"}}].concat(t.map(function(t){return this._keys.push(t.id),this._cinemas[t.id]=t,{text:t.title,val:"cinema_"+t.id,attrs:{"data-statlog":"afisha_inserts.select.cinema.fav"},icon:{mods:{glyph:"afisha-fav"}}}},this)),js:{optionsMaxHeight:280},menu:{mods:{afisha:"yes"}},control:this.params.nativeSelect,attrs:{"aria-controls":this._uniqId+"_panels","data-statlog":"afisha_inserts.select.cinema.button","data-parent-key":"cinema"}})),BEM.DOM.blocks.select2.init(),this.domElem.addClass("media-service_tabs_yes")}},_changeTab:function(t,e){this.__base.apply(this,arguments);var i=this.findBlockInside("select2");i&&(this._isFilms(t)?(e.parentKey||i.setVal("cinema"),i.setMod("visibility","visible")):i.setMod("visibility","hidden"))},_loadData:function(t){var e={},i="",n=this;return this._isFilms(t)?(i="https://"+this.params.geohelperHost+"/geohelper/get_cinema_sessions",e={id:t.replace("cinema_",""),geoid:this.params.geoId,lang:this.params.locale,mobile:0}):(i="/portal/api/data/1",e={block:"afisha_inserts",content:"api_data_big",lang:this.params.locale,page_geo:this.params.geoId,event_type:t}),new Promise(function(t,n){$.ajax({url:i,xhrFields:{withCredentials:!0},dataType:"json",timeout:this.__self.GEOHELPER_TIMEOUT,data:e}).then(t,n)}.bind(this)).then(function(e){var i=[];return n._isFilms(t)?i=e:e.block&&e.block[0]&&e.block[0].data&&Array.isArray(e.block[0].data[t])&&(i=e.block[0].data[t]),{events:i}})},_renderLoader:function(t){var e,i="",n=0,s=0;return this._isFilms(t)?(i=home.view("afisha-event-film",{mix:"afisha-inserts__event media-service__item",imageMix:"media-service__shadow media-service__image",stat:"",dummy:!0}),n=680,s=8):(i=home.view("afisha-event-show",{mix:"afisha-inserts__event media-service__item",innerMix:"media-service__shadow",imageMix:"media-service__image",stat:"",dummy:!0}),n=888,s=5),e=Array(s+1).join(i),home.view("afisha-inserts__carousel",{content:e,js:{counter:"afisha_inserts",step:n}})},_onPanelChange:function(t,e){this.__base.apply(this,arguments),this._loadVisibleImages(e);var i=this.findBlockInside(e,"carousel");i&&i.setScrollMod()},_onPanelDraw:function(t,e){this.__base.apply(this,arguments),this.findElem(e,"wrap").on("scroll",this._scrollThrottledHandler)},_getPanelHTML:function(t,e){return this._isFilms(t)?home.view("afisha-inserts__panel-cinema",{events:e.events,key:t,cinema:this._cinemas[t.replace("cinema_","")]}):home.view("afisha-inserts__panel-shows",{events:e.events,key:t})},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("media-service__panel"),t}},{SCROLL_THROTTLE:200,GEOHELPER_TIMEOUT:7e3,MIN_VISIBLE_HEIGHT:0,EVENTS_MARGIN:16}),BEM.DOM.decl("select2",{onSetMod:{js:{inited:function(){this.menu=this.findBlockOn("menu","menu"),this.popup=this.findBlockOn("popup","popup2"),this.arrow=this.findBlockOn("arrow","icon"),this.button=this.findBlockOn("button","button2"),this.initialVal=this.getVal(),this.popup.setAnchor(this.button),this.popup.on("beforeClose",this._onPopupHide,this),this.button.on({click:this._onButtonClick,focus:this._onButtonFocus},this),this.bindTo("button","blur",this._onButtonBlur),this.menu.on({change:this._onMenuChange,click:this._onMenuItemClick,"item-hover":this._onMenuItemHover},this),this._preventBlur=null,this.bindTo("menu","pointerdown",this._onMenuPointerdown),document.documentMode&&this.bindTo("menu","focusin focusout",this._preventItemFocus),this._setMaxHeight()}},focused:{yes:function(){this.button.setMod("focused","yes")},"":function(){this.delMod("opened"),this.button.delMod("focused")}},opened:{"*":function(t,e){if(this.hasMod("disabled"))return!1;var i=Boolean(e);this.button.domElem.attr("aria-expanded",i),this.arrow.toggleMod("direction","top","bottom",i),this.popup.toggleMod("visible","yes",i)},yes:function(){this._setMinWidth(),this._setMaxHeight()}},disabled:{"*":function(t,e){this.button.setMod(t,e)},yes:function(){this.popup.delMod("visible")}}},getDefaultParams:function(){return{optionsMaxHeight:Number.POSITIVE_INFINITY}},getVal:function(){return this.menu.getVal()},setVal:function(t){return this.menu.setVal(t),this},reset:function(){this.menu.setVal(this.initialVal)},setContent:function(t){return this.menu.setContent(t),this._setMinWidth(),this._setMaxHeight(),this},destruct:function(){return document.documentMode&&this.unbindFrom("menu","focusin focusout",this._preventItemFocus),this.unbindFrom("menu","pointerup",this._preventButtonBlur),this.unbindFrom("menu","pointerdown",this._onMenuPointerdown),this.unbindFrom("button","blur",this._onButtonBlur),this.__base.apply(this,arguments)},_setMinWidth:function(){this.popup.domElem.css("min-width",this.button.domElem.outerWidth()),this.popup.redraw()},_setMaxHeight:function(){var t=this.popup.calcPossibleDrawingParams(),e=this.menu.domElem,i=e.outerWidth(),n=0;t.forEach(function(t){t.width>=i&&t.height>n&&(n=t.height)}),n>0&&(e.css("max-height",Math.min(this.params.optionsMaxHeight,n)),this.popup.redraw())},_onMenuChange:function(t,e){this._changeIcon(t,e),this.trigger("change",e)},_changeIcon:function(t,e){var i,n,s=this.menu,o=this.button,r=s.getItems("checked","yes").filter(function(t){return s.elemParams(t).val===e.currVal}).shift(),a=r&&s.findBlockInside(r,"icon"),c=o.findElem("icon","side","left");a?(c.length||(o.domElem.prepend(this._buildLeftIcon()),c=o.findElem("icon","side","left")),n=o.findBlockInside(c,"icon"),delete(i=a.getMods()).js,Object.keys(i).forEach(function(t){n.setMod(t,i[t])})):c.length&&c.remove()},_onMenuItemClick:function(t,e){this.delMod("opened")},_onMenuItemHover:function(t,e){var i=this.button.domElem,n=e.item;n?i.attr("aria-activedescendant",n.attr("id")):i.removeAttr("aria-activedescendant")},_onMenuPointerdown:function(t){this._preventBlur=!0},_onButtonClick:function(){this.toggleMod("opened","yes")},_onButtonKeydown:function(t){var e=BEM.blocks.keycodes;!this.hasMod("opened")&&e.is(t.keyCode,"UP","DOWN")&&(t.preventDefault(),this.setMod("opened","yes"))},_onButtonKeypress:$.noop,_onButtonFocus:function(){this.setMod("focused","yes")},_onButtonBlur:function(){this._preventBlur?(this._preventBlur=null,this.bindTo("menu","pointerup",this._preventButtonBlur)):this.delMod("focused")},_onPopupHide:function(){this.delMod("opened")},_buildLeftIcon:function(){return'<i class="icon button2__icon button2__icon_side_left" aria-hidden="true"/>'},_preventButtonBlur:function(t){this.unbindFrom("menu","pointerup",this._preventButtonBlur),this.button.domElem.focus()},_preventItemFocus:function(t){t.preventDefault(),t.stopPropagation()}},{live:function(){this.liveInitOnBlockInsideEvent("init","button2"),this.liveBindTo("button","keydown",function(t){this._onButtonKeydown(t)}).liveBindTo("button","keypress",function(t){this._onButtonKeypress(t)})}}),BEM.DOM.decl("select2",{onSetMod:{opened:{yes:function(t,e){var i,n=this.__base.apply(this,arguments);return!1===n?n:(this.menu.getItems("hovered","yes").length||((i=this.menu.getItems("checked","yes")).length?this.menu.hoverText(i[0].text()):this.menu.hoverNext()),n)},"":function(){return this._preventToToggleOpened=!1,this.__base.apply(this,arguments)}}},_onButtonKeydown:function(t){this.hasMod("opened","yes")?(this.menu._onKeydown(t,!0),this._keysToMenu=!0,this._preventToToggleOpened=!0):(this._keysToMenu=!1,this._preventToToggleOpened=!1,this.__base.apply(this,arguments))},_onButtonKeyup:function(t){this._keysToMenu&&(this.menu._onKeyup(t),this._keysToMenu=!1,this._preventToToggleOpened=!0)},_onButtonClick:function(){this._preventToToggleOpened?this._preventToToggleOpened=!1:this.__base.apply(this,arguments)},_onButtonKeypress:function(t){var e=BEM.blocks.keycodes;if(e.is(t.keyCode,"UP","DOWN","ENTER","SPACE")||0===t.keyCode&&t.charCode===e.SPACE)this.menu._onKeypress(t);else{var i=this.menu.getItems("hovered","yes");if(i.forEach(function(t){this.menu.delMod(t,"hovered")},this),this.menu._onKeypress(t),this.hasMod("opened"))return;(i=this.menu.getItems("hovered","yes")).length&&this.setVal(this.menu.elemParams(i[0]).val)}}},{live:function(){return this.liveBindTo("button","keyup",function(t){this._onButtonKeyup(t)}),this.__base()}}),BEM.DOM.decl("select2",{_onMenuChange:function(t,e){this.__base.apply(this,arguments),this.elem("control").val(e.currVal)},onSetMod:{disabled:{"*":function(t,e){this.__base.apply(this,arguments),this.elem("control").prop("disabled",Boolean(e))}}},getName:function(){return this.elem("control").attr("name")},setName:function(t){return this.elem("control").attr("name",t),this}}),BEM.DOM.decl({block:"select2",modName:"view",modVal:"default"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.popup.setAnchor(this.domElem)}}},_changeIcon:function(t,e){var i=this.menu,n=this.button,s=i.getItems("checked","yes").filter(function(t){return i.elemParams(t).val===e.currVal}).shift(),o=s&&i.findElem(s,"icon"),r=n.findElem("icon","side","left");r.length&&r.remove(),o&&n.domElem.prepend(this._buildLeftIcon(o))},_buildLeftIcon:function(t){return t.clone().addClass("button2__icon_side_left button2__icon")}}),BEM.DOM.decl({block:"select2",modName:"text",modVal:"vary"},{_onMenuChange:function(t,e){this.__base.apply(this,arguments),this.button.setText(this.getText()),this._setMinWidth()},getText:function(){var t=this.menu;return t.getItems("checked","yes").map(function(e){return t.elemParams(e).text||t.findElem(e,"text").text()}).join(", ")||this.params.text}}),BEM.DOM.decl({block:"select2",modName:"native",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=this.elem("control"),e=this.getVal();BEM.afterCurrentEvent(function(){if(t&&t.length&&this.domElem){var i=t.val();[].concat(i).join("")!==[].concat(e).join("")&&this.setVal(i)}}.bind(this)),this.bindTo("control","change",function(t){this._onControlChange(t)})}}},_onControlChange:function(t){var e=this.elem("control").val(),i=[].concat(e),n=this.menu,s=this.getVal();n.getItems().filter(function(t){return n.delMod(t,"checked"),i.indexOf(n.elemParams(t).val)>=0}).forEach(function(t){n.setMod(t,"checked","yes")}),this._onMenuChange(t,{prevVal:s,currVal:e})}},{live:function(){return this.liveBindTo("control","pointerdown").liveBindTo("pointerdown",function(){this.hasMod("native","yes")&&this.setMod("touched","yes")}),this.__base()}}),BEM.DOM.decl({block:"select2",modName:"fade",modVal:"yes"},{onSetMod:{visibility:function(){var t=this;this.setMod("fade-animate","yes"),setTimeout(function(){t.delMod("fade-animate")},150)}}}),BEM.DOM.decl({block:"district-inserts",baseBlock:"media-service"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages()}.bind(this),this.__self.SCROLL_THROTTLE),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._loadVisibleImages(),this._calcOverflow(this.domElem)}}},_loadVisibleImages:function(){var t=this.elem("wrap"),e=t.width()+t.scrollLeft(),i=Math.ceil(e/this.__self.POST_WIDTH),n=this.elem("post");this.setMod(n.slice(0,i),"visible","yes")}},{POST_WIDTH:276,SCROLL_THROTTLE:200,TEXT_OVERFLOW_LINES:4}),BEM.DOM.decl({block:"news-inserts",baseBlock:"media-service"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages()}.bind(this),this.__self._scrollLoadImageThrottle),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._loadVisibleImages(),this.findBlockInside("carousel").setScrollMod(),this._calcOverflow();var t=this.findBlockOutside("media-grid");t&&t.on("expanded",function(){this._loadVisibleImages()},this)}}},_initialLoadImages:function(){},_loadVisibleImages:function(){var t,e,i=this.findElem(this.domElem,"wrap"),n=i.scrollLeft(),s=i.width()+n+100;t=Math.ceil(s/this.__self._itemWidth),e=this.findElem(this.domElem,"item").slice(0,t),home.stat.logDOMShow(e,{visibilityCheck:!1}),this._loadImages(e)},_calcOverflow:function(){var t=this.__self.getName();BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("item-title"),5,t+"__title"),BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("item-text"),6,t+"__text")}},{_itemWidth:176,_scrollLoadImageThrottle:200,live:!1}),BEM.DOM.decl({name:"insert-loader",baseBlock:"media-service"},{onSetMod:{js:{inited:function(){this._isHidden()||(this.channel("i-reposition-event").on("reposition",this._onScroll,this),this._onScroll(null,BEM.DOM.win.scrollTop()),home.stat.logPath("show",this._getStatName()+".loading")),this._initMenuEvents()}},state:function(t,e){home.stat.logPath("show",this._getStatName()+"."+e)}},_getStatName:function(){return this.__self.getName().replace(/-/g,"_")},_getDataUrl:function(){},_selectData:function(){},_checkData:function(){},_getHTML:function(){},_onScroll:function(t,e){var i=this.domElem.offset().top;e+BEM.DOM.win.height()>i-this.__self._initOffset&&(this.channel("i-reposition-event").un("reposition",this._onScroll,this),this._loadBlockData())},_loadBlockData:function(){if(!this._loadStarted){this._loadStarted=!0;var t=this._getDataUrl();$.ajax({url:t,xhrFields:{withCredentials:!0},dataType:"json",timeout:1e4}).then(function(t){if(!this._checkData(t))return home.error.logError({block:this.__self.getName(),message:"Incorrect data"}),$.Deferred().reject();this._drawBlock(this._selectData(t))}.bind(this),function(t,e,i){home.error.logAjaxError({block:this.__self.getName(),message:"_loadBlockData: ajax",source:"morda_api"},t,e,i)}.bind(this)).fail(function(){BEM.blocks["zen-inserter"].hide(this.domElem.closest("[data-blockname]"))}.bind(this))}},_drawBlock:function(t){var e;t=$.extend(t,{retryButtonTheme:this.params.retryButtonTheme}),e=BEM.DOM.replace(this.domElem,this._getHTML(t)),home.stat.logPath("tech",this._getStatName()+".loaded"),home.stat.logDOMShow(e)},_onRetryClick:function(){this.setMod("state","loading"),this._loadBlockData()},_toggle:function(t){this.__base.apply(this,arguments),t&&this._loadBlockData()}},{_initOffset:300,live:function(){return this.liveBindTo("retry-button","click",function(){return this._onRetryClick(),!1}),!1}}),BEM.DOM.decl({block:"news-inserts-loader",baseBlock:"insert-loader"},{_getDataUrl:function(){return this.params.url},_checkData:function(t){return t.block&&t.block[0]&&t.block[0].data&&t.block[0].data.items&&t.block[0].data.items.length>=2},_selectData:function(t){return t.block[0].data},_getHTML:function(t){return home.view("news-inserts",t)}}),BEM.DOM.decl({block:"cashback",baseBlock:"media-service",baseMix:["mix-tabber","mix-tabber-labels","mix-tabber-labels-keyboard","mix-tabber-loader","mix-tabber-loader-keyboard"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages(this._$panel)}.bind(this),this.__self.SCROLL_THROTTLE),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._loadVisibleImages()}}},_initialLoadImages:function(){},_loadVisibleImages:function(t){var e=this.findElem(t||this.domElem,"wrap"),i=e.width()+e.scrollLeft(),n=Math.ceil(i/this.__self.ITEM_WIDTH),s=this.findElem(t||this.domElem,"item");this._loadImages(s.slice(0,n))},_getInitData:function(){return home.getData("cashback.data.data")},_getPanelHTML:function(t,e){return home.view("cashback__panel",{elements:e.elements,id:t})},_onPanelChange:function(t,e){this.__base.apply(this,arguments),this._loadVisibleImages(e),this.findBlockInside(e,"carousel").setScrollMod()},_onPanelDraw:function(t,e){this.__base.apply(this,arguments),this.findElem(e,"wrap").on("scroll",this._scrollThrottledHandler)},_selectImageUrl:function(t,e){return e[(window.devicePixelRatio||1)>1.1?"176x176":"88x88"]},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("media-service__panel"),t}},{ITEM_WIDTH:136,SCROLL_THROTTLE:200}),BEM.DOM.decl({block:"stream-inserts",baseBlock:"media-service"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages()}.bind(this),this.__self.SCROLL_THROTTLE),this.elem("wrap").on("scroll",this._scrollThrottledHandler);var t=this.findBlockOutside("media-grid");t&&t.on("expanded",function(){this._loadVisibleImages()},this),this._calcOverflow(),this._loadVisibleImages()}}},_initialLoadImages:function(){},_loadVisibleImages:function(){var t=this.elem("wrap"),e=t.width()+t.scrollLeft(),i=Math.ceil(e/this.__self.ITEM_WIDTH),n=this.elem("item");this._loadImages(n.slice(0,i))},_calcOverflow:function(){var t=this.__self.getName();this.hasMod("type","horizontal")&&BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("horizontal-card-title"),2,t+"__title")}},{ITEM_WIDTH:136,SCROLL_THROTTLE:200}),home.formatDuration=function(t){t=Math.round(t);var e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60),n=[i,t-3600*e-60*i].map(function(t){return(t<10?"0":"")+t});return e&&n.unshift(String(e)),n.join(":")},BEM.DOM.decl({block:"stream-inserts-loader",baseBlock:"insert-loader"},{_checkData:function(t){return t&&t.length},_getHTML:function(t){return home.view("stream-inserts",home.deepExtend(t,this.params))},_loadBlockData:function(){if(!this._loadStarted)return this._loadStarted=!0,Ya.streamCms.getCarouselItems({carousel_id:this.params.carouselId,limit:20}).then(function(t){if(!this._checkData(t))return home.error.logError({block:this.__self.getName(),message:"Incorrect data",meta:{carouselId:this.params.carouselId}}),Promise.reject();this._drawBlock({set:t,carousel_id:this.params.carouselId,type:this.params.type})}.bind(this)).catch(function(t){t&&home.error.logError({block:this.__self.getName(),message:"stream-inserts-loader error: "+String(t),meta:{carouselId:this.params.carouselId}}),BEM.blocks["zen-inserter"].hide(this.domElem.closest("[data-blockname]"))}.bind(this))}}),function(){function t(){if(t._instance)return t._instance;t._instance=this}t.prototype._init=function(){if(this._inited)return this;var t=home.getData("stream.stream.disabled"),e=home.getData("stream.stream.clientData.settings");return this.settings=e||{exp:{}},t||e||this.onError({message:"stream-cms._init: no settings !!!"}),this.settings.apiUrl&&(this.__apiUrl=this.settings.apiUrl+"/"),this._inited=!0,this},t.prototype.ajax=function(t,e){var i=home.deepExtend(home.getData("stream.reqparams-cms",{}),{stream_options:this.settings.exp.lowres?"lowres":"hires",locale:BEM&&BEM.blocks["i-global"]&&BEM.blocks["i-global"].param("locale")||"ru",from:home.getData("stream.reqparams.from")||"morda",distr_id:home.getData("stream.reqparams.distr_id"),reqid:home.getData("stream.reqparams.reqid")}),n=this,s=0===t.indexOf(this.__apiUrl),o=this._ajaxInProgress,r=function(t){var e=home.localStorage.getItem("morda-stream-stale");if(t&&t.error&&"old"===t.error.code){if("report"!==e||this._needReload||(home.error.logError({block:"stream",sourceType:"vh"},{message:"Old frontend handler after reload"}),home.localStorage.setItem("morda-stream-stale","fail")),e)return;home.error.logError({block:"stream",sourceType:"stale"},{message:"Old frontend handler was used, reloading"}),this._needReload=!0,home.localStorage.setItem("morda-stream-stale","report"),setTimeout(function(){location.reload()},500)}else home.localStorage.removeItem("morda-stream-stale")}.bind(this),a=function(){this._ajaxInProgress=Math.max(0,this._ajaxInProgress-1)}.bind(this);return this._ajaxInProgress++,i.disable_trackings=1,new Promise(function(c,l){var h=home.deepExtend(e||{},i),u=1,d=function(){var e=$.ajax({url:t,data:h,dataType:"json",xhrFields:{withCredentials:!0}});e.then(a,a),s&&e.then(r),e.then(function(t){return s&&this.checkErrors(t),t}.bind(n)).then(c,function(t,e,i){u--&&"timeout"===e?d():l(t,e,i)})},m=Math.min(300,100*o)*Math.random();m?setTimeout(d,m):d()})},t.prototype.checkErrors=function(t){var e=t.errors||{},i={invalid_region:"region",no_licenses:"licenses",old_browser:"browser",future_vod_release:"future_vod"},n=["invalid_region","outdated","no_licenses","old_browser"];this.settings.disableFutureVod||n.push("future_vod_release"),n.map(function(n){var s=e[n]||[];t.error===n&&t.content&&s.push(t.content.content_id),s.forEach(function(t){this.forbidden[t]=i[n]||n},this)},this)},t.prototype.setSessionParams=function(t){var e=home.deepExtend({},home.getData("stream.reqparams"));this._sessionParams=home.deepExtend(e,t)},t.prototype.getSessionParams=function(){return this._sessionParams||home.getData("stream.reqparams")||{}},t.prototype.onError=function(t){var e=t.meta||{};e.from=this.getSessionParams().from,e.from_block=this.getSessionParams().from_block,t.message=t.message+(t.originalMessage?",originalErrorMessage:"+t.originalMessage:""),home.error.logError({block:"stream",sourceType:"logic",meta:e},t)},t.prototype.__apiUrl="https://frontend.vh.yandex.ru/",t.prototype._ajaxInProgress=0,t.prototype.forbidden={},Ya=Ya||{},Ya.streamCms=new t,Ya.streamCms.constructor=t,Ya.streamCms._init()}(),function(t){var e,i;try{e=t.localStorage,i="ya_ls_test",e.setItem(i,"1"),"1"!==e.getItem(i)?e=null:e.removeItem(i)}catch(t){e=null}var n=t.home||(t.home={}),s=t.console&&function(t){console.log(t)}||function(){},o=function(t){s("localStorage is disabled. "+(t||""))},r=function(t){try{return t()}catch(t){o(t)}};e?n.localStorage={setItem:function(t,i){return r(function(){return e.setItem(t,i)})},getItem:function(t){return r(function(){return e.getItem(t)})},removeItem:function(t){return r(function(){return e.removeItem(t)})},clear:function(){return r(function(){return e.clear()})},key:function(t){return r(function(){return e.key(t)})}}:(n.localStorage={removeItem:o,setItem:o,getItem:o,clear:o},n.disabledLS=!0)}(window),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t,e){"use strict";if(void 0===t||null===t)throw new TypeError("Cannot convert first argument to object");for(var i=Object(t),n=1;n<arguments.length;n++){var s=arguments[n];if(void 0!==s&&null!==s)for(var o=Object.keys(Object(s)),r=0,a=o.length;r<a;r++){var c=o[r],l=Object.getOwnPropertyDescriptor(s,c);void 0!==l&&l.enumerable&&(i[c]=s[c])}}return i}}),function(t){t._programTypes={"vod-episode":"VodProgram",episode:"Episode"},t.prototype._initStores=function(){this._channelsById={},this._channelsList=[],this._channelsIcon=[],this._episodesById=[],this._vodLibs={byChannel:{},byId:{}},this._vodEpisodes={byId:{},byLib:{},byTag:{}},this._carousels={byId:{}},this._feeds={paginators:{}},this._highlightsById={},this._highlightsList={}},t.prototype._filterBanned=function(t,e){var i=0,n=t.map(function(t){return t.banned&&(i++,t=null),t});return e.limit/2<=i&&home.error.logError({block:"stream",message:"many banned resources",meta:{params:e,reqCount:e.limit,resCount:i},sourceType:"vh"}),n},t.prototype._getProgramConstructor=function(e){var i=t._programTypes[e];if(i)return Ya.streamModules[i]},t.prototype.storeResource=function(t,e){var i;if(e=void 0===e||e,"vod-episode"===t.content_type_name)this.storeVodEpisode(t),i=this.getCachedVodEpisode(t.content_id);else if("vod-library"===t.content_type_name)this.storeVodLib(t),i=this.getCachedVodLib(t.content_id);else if("episode"===t.content_type_name)i=this.storeEpisode(t);else if("channel"===t.content_type_name&&!(i=this.storeChannel(t))&&this.settings.disableStoreChannelErrors)return null;if(i)return i;throw e&&this.onError({message:"storeResource -> couldn't store resource",meta:{resource:{content_id:t.content_id,content_type:t.content_type_name}}}),new Error("storeResource -> couldn't store resource")},t.prototype.getCachedVodEpisode=function(t){return this._vodEpisodes&&this._vodEpisodes.byId&&this._vodEpisodes.byId[t]},t.prototype.getCachedVodLib=function(t){return this._vodLibs&&this._vodLibs.byId&&this._vodLibs.byId[t]},t.prototype.getChannelByContentId=function(t){return this._channelsById[t]},t.prototype.storeVodEpisode=function(t){var e;this.storeVodEpisodes?this.storeVodEpisodes([t]):(e=this.getProgramInstance(t),this._vodEpisodes.byId[e.content_id]=e)},t.prototype.storeVodLib=function(t){var e;this.storeVodLibs?this.storeVodLibs([t]):(e=new Ya.streamModules.VodLibrary(t),this._vodLibs.byId[e.content_id]=e)},t.prototype.storeChannel=function(t,e){return this._storeChannel?this._storeChannel(t,e):this.storeChannelById(t)},t.prototype.storeEpisode=function(t){var e;return this.storePrograms?this.storePrograms([t])[0]:(e=this.getProgramInstance(t),this._episodesById[e.content_id]=e,e)},t.prototype.storeChannelById=function(t){var e;return this.overrideChannel(t),e=new Ya.streamModules.Channel(t),this._channelsById[e.content_id]=e,e},t.prototype.getProgramInstance=function(e,i){this.overrideProgram(e);var n=this._getProgramConstructor(e.content_type_name);if(n)return new n(e,i);var s=Object.keys(t._programTypes);throw new TypeError('Invalid type "'+e.content_type_name+'", valid types: '+s)},t.prototype.overrideProgram=function(t){var e=this.settings,i=e.override&&e.override[t.content_id];if(i)for(var n in i)i.hasOwnProperty(n)&&("start_time"===n||"end_time"===n?t["fake_"+n]=i[n]:t[n]=i[n]);t.fakeTime=e.fakeTime},t.prototype.overrideChannel=function(t){var e=this.settings.resourceOverride&&this.settings.resourceOverride[t.content_id];if(e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},Ya.streamCms._initStores()}(Ya.streamCms.constructor),function(t){t.Ya=t.Ya||{},t.Ya.streamModules=t.Ya.streamModules||{}}(window),function(){var t;function e(e,i){for(var n in t=Ya.streamCms,this.raw=e,e)e.hasOwnProperty(n)&&(this[n]=e[n]);this.channel=i,this._setupStreams(e.streams),this.meta=this.meta||{},this.ads=!0,t.settings&&t.settings.adsDisabled&&this.disableAds(),i&&i.status.overlay&&(this.meta.with_overlay=!0),this.checkSuperres(e.streams)&&(this.meta.superres=1)}e.prototype.disableAds=function(){this.ads=!1},e.prototype._setupStreams=function(e){var i;if(e=e||[],!this.cameras){var n=e.reduce(function(n,s){var o,r;return"default"!==(o=(s=home.deepExtend({},s)).id||"default")&&i||(i=o),delete s.id,delete s.options,s.content_url&&!s.url&&(s.url=s.content_url,delete s.content_url),s.url||(s.url="",t.onError({message:"_setupStreams: no url in stream",meta:{content_id:this.content_id,content_type:this.content_type_name,streams:e}})),s.url=this._getUrl(s.url),(r=n.byId[o])||(r=n.byId[o]={streams:[],id:o},n.set.push(r)),s.title&&(r.title=s.title,delete s.title),r.thumbnail||(r.thumbnail=s.thumbnail||this.thumbnail),r.streams.push(s),n}.bind(this),{byId:{},set:[]});!n.byId.default&&i&&(n.byId.default=n.byId[i],delete n.byId[i]),this.cameras=n.byId,this._camerasArray=n.set,this._camerasArray.length?this.switchToCamera("default"):t.onError({message:"_setupStreams: no cameras",meta:{content_id:this.content_id,content_type:this.content_type_name,streams:e}})}},e.prototype.checkSuperres=function(e){var i;return!((t.settings&&t.settings.exp||{}).lowres||!e)&&(e.map(function(t){t.options&&-1!==t.options.indexOf("hires")&&(i=1)},this),i)},e.prototype.constructUrl=function(t,e){e=e||{};var i=home.parseUrl(t),n=home.deepExtend({},i.query);return i.query=home.deepExtend(n,e),home.makeUrl(i)},e.prototype._getUrl=function(t){var e=this._validateSourceUrl(t);return this.fakeTime&&((e=e||{}).faketime=Math.floor(home.now()/1e3)),e&&(t=this.constructUrl(t,e)),t},e.prototype._validateSourceUrl=function(){},e.prototype.getAdConfig=function(){var t;if(this.adConfig)return t=this.adConfig,this.ads||delete t.partner_id,this.customAdCategory&&(t.category=this.customAdCategory),t},e.prototype.getStreams=function(){var t=this._activeCam;return this.cameras[t||"default"].streams},e.prototype.getCredentials=function(){return this.channel&&this.channel.stream&&this.channel.stream.withCredentials},e.prototype.getMetrikaHeartbeat=function(){return Object.keys(window.metrikaCounterInstances).map(function(t){return["https://mc.yandex.ru/watch/"+t+"?page-url=yandexhbgoal.ru",{callsCount:1,delay:3e4}]})},e.prototype.getTrackings=function(){var e=Ya.streamTrackings;if(e){var i=t.getCurrentWatchingParams(),n=[e.getTrackings({content_id:i.content_id,channel_id:i.channel_id,stream_block:i.stream_block,from_block:t.getPleerAdditionalParams().from_block})],s=this._getOttTrackings(),o=this.getProgramTrackings();return s&&(n=n.concat(s)),o&&(n=n.concat(o)),{trackingEvents:n=n.concat({heartbeat:this.getMetrikaHeartbeat()})}}},e.prototype._getOttTrackings=function(){var e,i=window.Ya.OTT&&window.Ya.OTT.buildTrackings;if(this.ottParams&&i){try{e=i(this.ottParams,{env:"production"}).trackingEvents}catch(e){e.originalMessage=e.message,e.message="getTrackings -> couldn't build ott trackings",e.meta={content_id:this.content_id},t.onError(e)}return e}},e.prototype.getProgramTrackings=function(){return this.stream&&this.stream.trackings&&this.stream.trackings.trackingEvents},e.prototype.getLogoConfig=function(){var t=this.watermark_logo||this.channel&&this.channel.watermark_logo;if(t)return{src:t,alwaysVisible:!0}},e.prototype.getContentId=function(){return this.content_id},e.prototype.start=function(){return this.fake_start_time||this.start_time},e.prototype.end=function(){return this.fake_end_time||this.end_time},e.prototype.is=function(t){return t>=this.start()-10&&t<=this.end()+10},e.prototype.fromFuture=function(){return this.start()>home.now()/1e3},e.prototype.screwTime=function(t){return t<this.start()-10&&t>=this.start_time?this.start_time-1:t>this.end()+10&&t<=this.end_time?this.end_time+1:t},e.prototype.canPlay=function(){return!0},e.prototype.hasVodLib=function(){return!!this.parent_vod_lib_id&&!t.vodDisabled},e.prototype.getVodLib=function(){return this._lib?Promise.resolve(this._lib):this.hasVodLib()&&t.getLibById?t.getLibById(this.parent_vod_lib_id).then(function(t){return this._lib=t,this._lib}.bind(this)):Promise.reject({message:"no vodLib for episode"})},e.prototype.canRestart=function(t){return this.canPlay(t)},e.prototype.eq=function(t,e){return t&&t.content_id===this.content_id&&(void 0===e||this._activeCam===e)},e.prototype.getActiveCam=function(){return this._activeCam},e.prototype.getCameras=function(){return this._camerasArray},e.prototype.switchToCamera=function(t){if(!this.cameras[t||"default"])throw new RangeError("Camera "+t+" is unavailable");this._activeCam=t},e.prototype.getStickerpack=function(){var e=this.is(home.now()/1e3),i=this.channel||{},n=i.status||{},s=this.stickerpack||i.stickerpack||"default7",o=(t.settings&&t.settings.exp||{}).stream_emoji_hidden;return!(!e||!o&&!n.force_emoji||"disabled"===s)&&s},e.prototype.getThumbnail=function(){var t=this.channel||{},e=this.thumbnail||t.thumbnail||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==";return this.prepareThumbnailSize(e)},e.prototype.prepareThumbnailSize=function(t){return t.replace(/(\/get-vh\/.+?)\/orig$/,"$1/600x450")},e.prototype.isForbidden=function(){var e=t.forbidden;return this.meta.forbidden||e[this.content_id]||this.parent_channel_id&&e[this.parent_channel_id]||this.parent_vod_lib_id&&e[this.parent_vod_lib_id]||this.parent_id&&e[this.parent_id]},e.prototype.isPlusContent=function(){return this.ya_plus&&this.ya_plus.length||this.channel&&this.channel.ya_plus&&this.channel.ya_plus.length},e.prototype.getPlusTypes=function(){return this.ya_plus||this.channel&&this.channel.ya_plus},e.prototype.getPlusType=function(){return home.yaplus.getCheapest(this.getPlusTypes()||[])},e.prototype.canSetLikes=function(){return!(this instanceof Ya.streamModules.VoidProgram||this.is(home.now()/1e3)||this.fromFuture()||!this.canPlay(home.now()/1e3)||"vod-episode"===this.content_type_name&&-1!==["film","anim_film","series","anim_series"].indexOf(this.onto_category)||"vod-library"===this.content_type_name&&-1!==["series","anim_series"].indexOf(this.onto_category))},e.prototype.getSourceConfig=function(e){return{protectedFrame:!0,streams:this.getStreams(),startPosition:e,adConfig:this.getAdConfig(),withCredentials:!!this.getCredentials(),trackings:this.getTrackings(),logoConfig:this.getLogoConfig(),preview:this.getThumbnail(),additionalParams:t.getPleerAdditionalParams()}},Ya.streamModules.GenericProgram=e}(),function(t){t.prototype.getPleerAdditionalParams=function(){var t=this.getSessionParams(),e=this.getCurrentWatchingParams();return home.deepExtend({stream_block:e.stream_block},t)},t.prototype.setCurrentWatchingParams=function(t,e){var i={content_id:t.content_id,channel_id:t.channel&&t.channel.channel_id};if(this._currentWatchingParams=home.deepExtend(i,e||{}),this._currentWatchingParams&&"other"===this._currentWatchingParams.stream_block){var n=new Error("setCurrentWatchingParams: stream_block is other");this.onError(n)}},t.prototype.getCurrentWatchingParams=function(){return this._currentWatchingParams||{}},t.prototype.sortByWeight=function(t,e){return(+e.weight||0)-(+t.weight||0)},t.prototype.sortByStartTime=function(t,e){return t.start_time-e.start_time},t.prototype.setCacheTimer=function(t,e,i){clearInterval(this._cacheTimer[e]);var n=home.now()/1e3,s=Math.max(n,t-300);if(!(t<s)){var o=s+(t-s)*Math.random();this._cacheTimer[e]=setInterval(function(){home.now()/1e3>o&&(clearInterval(this._cacheTimer[e]),i(t))}.bind(this),1e3)}},t.prototype.destroyCacheTimer=function(t){clearInterval(this._cacheTimer[t]),delete this._cacheTimer[t]},t.prototype._cacheTimer={}}(Ya.streamCms.constructor),function(){"use strict";var t={YA_PLUS:0,YA_PLUS_3M:0,KP_BASIC:1,YA_PREMIUM:2},e=function(e){return e.map(function(t){return"YA_PLUS_3M"===t?"YA_PLUS":t}).sort(function(e,i){return t[e]-t[i]})};home.yaplus={},home.yaplus.getCheapest=function(t){return e(t)[0]},home.yaplus.getMostExpansive=function(t){return e(t)[t.length-1]},home.yaplus.getWeightByKey=function(e){return t[e]},home.yaplus.shouldBuySubscribe=function(e,i){if(!e)return!0;var n=home.yaplus.getCheapest(i);return"YA_PLUS_3M"===e&&-1===i.indexOf("YA_PLUS_3M")||t[e]<t[n]}}(),function(){var t=Ya.streamModules.GenericProgram;function e(){t.apply(this,arguments)}e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.canPlay=function(t){var e=this.start(),i=this.end(),n=t-this.channel.catchup_age;return!this.blacked&&t>=e&&n<i},e.prototype.canRestart=function(e){return Ya.streamCms.isPad?this.canPlay(e)&&this.end()<e:t.prototype.canRestart.apply(this,arguments)},e.prototype._validateSourceUrl=function(t){var e,i,n=Ya.streamCms,s=n.settings.overrideProgramUrl,o=this.start(),r=this.end(),a=home.parseUrl(t).query;return(a.start<=0||a.end<=0||isNaN(a.start)||isNaN(a.end)||a.start>a.end)&&(i="url",s=!0),(Math.abs(a.start-o)>600||Math.abs(a.end-r)>600)&&(i="largeDiff",s=!0),s&&(r===1/0||o<0||r<0||isNaN(o)||isNaN(r)?(i="params",e={start:void 0,end:void 0}):e={start:o,end:r}),i&&n.onError({message:"_validateSourceUrl: fail",meta:{errorType:i,resource:{content_id:this.content_id,content_type:this.content_type_name,url:t,start:this.start_time,end:this.end_time}}}),e},Ya.streamModules.CatchupProgram=e}(),function(){var t=Ya.streamModules.GenericProgram;function e(){t.apply(this,arguments)}e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.is=function(t){return t>=this.start()-10&&t<=this.end()+10},e.prototype.canPlay=function(t){return this.start()<t&&t<this.end()},e.prototype.canRestart=function(){return!1},e.prototype._validateSourceUrl=function(t){var e=Ya.streamCms,i=home.parseUrl(t).query;if(i.start||i.end)return e.settings.disableLiveProgramErrors||e.onError({message:"live-program._validateSourceUrl: fail",meta:{resource:{content_id:this.content_id,content_type:this.content_type_name,url:t}}}),{start:void 0,end:void 0}},Ya.streamModules.LiveProgram=e}(),function(){var t=Ya.streamModules.CatchupProgram,e=Ya.streamModules.LiveProgram;Ya.streamModules.Episode=function(i,n){return n&&n.catchup_age?new t(i,n):new e(i,n)}}(),function(){var t=Ya.streamModules.GenericProgram;function e(){t.apply(this,arguments),this.channel&&!this.channel.has_vod&&this.disable(),this.updateSerialTitle()}e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.prototype.updateSerialTitle=function(){var t=this.series;t&&(this.isSerial=!0,this.program_title=t.series_name,this.title=t.episode_name||this.title)},e.prototype.canPlay=function(){return!this._disabled},e.prototype.disable=function(){this._disabled=!0},e.prototype.getCredentials=function(){return this.stream&&this.stream.withCredentials},e.prototype.getStickerpack=function(){return!1},e.prototype.getNeighbours=function(){return this.hasVodLib()?this.getVodLib().then(function(t){return t.getNeighbourFor(this)}.bind(this)):Promise.resolve([])},e.prototype.getThumbnail=function(){return this.thumbnail?this.prepareThumbnailSize(this.thumbnail):t.prototype.getThumbnail.apply(this,arguments)},Ya.streamModules.VodProgram=e}(),function(){var t;function e(e,i){for(var n in t=Ya.streamCms,e)e.hasOwnProperty(n)&&(this[n]=e[n]);this.includes&&this._storeLastEpisodes(),this.channel=i}e.prototype.getEpisodes=function(e){var i=home.deepExtend({},e);return i.parent_id=this.content_id,t.getVodEpisodes?t.getVodEpisodes(i):Promise.resolve([])},e.prototype.getNeighbourFor=function(t){return this.getEpisodes({limit:52}).then(function(e){var i;return(i=e.map(function(t){return t.content_id}).indexOf(t.content_id))>-1?[e[i-1],e[i+1]]:[]})},e.prototype._storeLastEpisodes=function(){var e=this.includes;e&&e.length&&t.storeVodEpisodes&&t.storeVodEpisodes(e,{parent_id:this.content_id,limit:e.length}),delete this.includes},e.prototype.isForbidden=function(){return t.forbidden[this.content_id]},Ya.streamModules.VodLibrary=e}(),function(){function t(t){var e=Ya.streamCms.settings&&Ya.streamCms.settings.exp||{};for(var i in this.raw=t,t)t.hasOwnProperty(i)&&(this[i]=t[i]);this.status=this.transformStatus(t.status),this.meta=t.meta||{},t.streams&&!e.lowres&&t.streams.forEach(function(t){t.options&&-1!==t.options.indexOf("hires")&&(this.meta.superres=1)},this)}t.prototype.isProjectChannel=function(){return Boolean(this.meta&&this.meta.project_alias)},t.prototype.getVodLibs=function(t){return(t=t||{}).parent_id=this.content_id,Ya.streamCms.getVodLibs(t)},t.prototype.transformStatus=function(t){var e={};return t&&t.forEach(function(t){e[t]=1}),e},Ya.streamModules.Channel=t}(),function(t){t.prototype.getCarouselItems=function(t){return this._prepareCarousel({carousel_id:t.carousel_id}).get(t)},t.prototype._fetchCarouselItems=function(t){var e=this.__apiUrl+"carousel_videohub.json",i={carousel_id:t.carousel_id,limit:t.limit,offset:t.offset,delete_filtered:0};return this.ajax(e,i).then(function(t){var e=t&&t.set||[],n=this._prepareCarouselItems(e);return this._filterBanned(n,i)}.bind(this),function(t,e,n){return home.error.logAjaxError({block:"stream",message:"_fetchCarouselItems: ajax",source:"cms_carousel",meta:{params:i}},t,e,n),Promise.reject({message:"_fetchCarouselItems: fail"})})},t.prototype._prepareCarouselItems=function(t){return t.map(function(t){try{"channel"===(t=this.storeResource(t)).content_type_name&&t.status.hidden&&(t=null)}catch(e){t=null}return t},this)},t.prototype._prepareCarousel=function(t){var e=t.carousel_id,i=this._carousels.byId[e];return i?(i.title=i.title||t.title,i.has_vertical=i.has_vertical||t.has_vertical,i):(i=new Ya.streamModules.Carousel(t),this._carousels.byId[e]=i,i)}}(Ya.streamCms.constructor),function(){var t;function e(e){var i;for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);t=Ya.streamCms,i=this.carousel_id,this.content_type_name="carousel",i&&(this._fetcher=function(e){var n={carousel_id:i,limit:e.limit,offset:e.offset};return t._fetchCarouselItems(n)}),this.storeIncludes()}e.prototype.storeIncludes=function(e){this.includes=this.includes||e||[],this.set=[],this.set=t._prepareCarouselItems(this.includes),this._paginator?this.store(this.set):this._paginator=new Ya.streamModules.Paginator(this.set,this._fetcher),this.set=this.set.filter(Boolean),delete this.includes},e.prototype.get=function(t){return this._paginator.get(t)},e.prototype.store=function(t){this._paginator.store(t)},Ya.streamModules.Carousel=e}(),function(){function t(t,e){this._set=t||[],this._fetcher=e||null,this._getting={}}t.prototype.get=function(t){var e=((t=t||{}).limit||0)+"_"+(t.offset||0);return this._getting[e]||(this._getting[e]=this._get(t,e).then(function(){return this._getInterval(t).filter(Boolean)}.bind(this),function(){delete this._getting[e]}.bind(this))),this._getting[e]},t.prototype._get=function(t){var e=this._findMissing(t),i=Promise.resolve();return e&&this._fetcher&&(i=this._fetcher(e).then(function(t){this._store(t,e)}.bind(this))),i},t.prototype.store=function(t,e){return this._store(t,e)},t.prototype._store=function(t,e){var i,n=(e=e||{}).limit,s=e.offset||0;n>(t=t||[]).length&&(i=s+t.length)!==this._remoteTotal&&(this._remoteTotal=i),t.forEach(function(t,e){this._set[e+s]=t},this)},t.prototype._findMissing=function(t){var e,i,n,s=this._remoteTotal,o=void 0!==s,r=t.limit||0,a=t.offset||0,c=r;if(o&&r&&r+a>s&&(c=Math.max(s-a,0)),c)return i=c-(e=this._getInterval({limit:c,offset:a})).length,void 0!==(n=this._findGap(e))[0]?{limit:(i?c:n[1]+1)-n[0],offset:a+(n[0]||0)}:i?{limit:i,offset:a+(c-i)}:void 0},t.prototype._findGap=function(t){var e,i=[];for(e=0;e<t.length;e++)void 0===t[e]&&(void 0===i[0]&&(i[0]=e),i[1]=e);return i},t.prototype._getInterval=function(t){var e=(t=t||{}).limit||0,i=t.offset||0;return i||(i=0),e?this._set.slice(i,e+i):[]},Ya.streamModules.Paginator=t}(),BEM.DOM.decl({block:"edadeal",baseBlock:"media-service",baseMix:["mix-tabber","mix-tabber-labels","mix-tabber-labels-keyboard"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),BEM.blocks["i-multiline-overflow"].calcOverflow(this.elem("retailer-title"),2),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages(this._$panel)}.bind(this),this.__self._scrollLoadImageTimeout),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._loadVisibleImages()}}},_getPanelHTML:function(t,e){return this.toggleMod("distance","no","all"===t),home.view("edadeal__panel",{id:t,title:e.title,distance:e.hasGeolocation,retailers:e.retailers,logShow:!0})},_initialLoadImages:function(){},_getInitData:function(){return home.getData("edadeal.data.data",{})},_loadVisibleImages:function(t){var e=this.findElem(t||this.domElem,"wrap"),i=e.width()+e.scrollLeft(),n=Math.ceil(i/this.__self._cardWidth),s=this.findElem(t||this.domElem,"retailer");this._loadImages(s.slice(0,n))},_onPanelDraw:function(t,e){this.__base.apply(this,arguments),this.findElem(e,"wrap").on("scroll",this._scrollThrottledHandler)},_onPanelChange:function(t,e){this.__base.apply(this,arguments),this._loadVisibleImages(e),this.findBlockInside("carousel").setScrollMod()},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("media-service__panel"),t}},{_cardWidth:136,_scrollLoadImageTimeout:200}),BEM.DOM.decl({name:"widgets-list",baseBlock:"media-service"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.channel("widget").on("commit",this._onWidgetCommit,this),this._isHidden()||this._initWidgets()}}},_initWidgets:function(){this.findBlocksInside("widget")},_toggle:function(t){this.__base.apply(this,arguments),t&&this._initWidgets()},_onWidgetCommit:function(t,e){if("remove"===e.type){var i=e.widget.domElem.closest(".widgets-list__item");i.length&&(this.setMod(i,"hidden","yes"),i.onceAnimationEnd("animation",400,function(){i.remove(),this.findBlockInside("carousel").setScrollMod()}.bind(this)))}},_createMenu:function(){this.__base.apply(this,arguments),this._control.on("delete_all",function(){window.confirm(home.l10n("widgetcontrol.confirm_delete_all"))&&this.findBlocksInside("widget").forEach(function(t){t.setMod("removed","yes")})},this)},_getMenuCustomItems:function(){return[{id:"delete_all",icon:"delete",text:home.l10n("widgetcontrol.delete_all")}]}}),BEM.DOM.decl("widgets-list",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._sendCounter("show_url"),this.bindTo("promo-close","pointerclick",this._closePromo)}}},_sendCounter:function(t){var e=this.params.promo&&this.params.promo[t];e&&((new Image).src=e)},_closePromo:function(){var t=this.elem("promo");this.setMod("promo-close","yes"),t.onceAnimationEnd("animation",600,function(){t.remove(),this.delMod("promo-close"),this.delMod("promo")}.bind(this)),this._sendCounter("close_url")},_toggle:function(t){this.__base.apply(this,arguments),t||this._sendCounter("close_url")}}),BEM.DOM.decl({block:"geo-collections",baseBlock:"media-service",baseMix:["mix-tabber","mix-tabber-labels","mix-tabber-labels-keyboard"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=this.elem("panel");this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages(this._$panel)}.bind(this),this.__self._scrollLoadImageThrottle),this._onPanelChange(this._selectedKey,t),this._onPanelDraw(this._selectedKey,t);var e=this.findBlockOutside("media-grid");e&&e.on("expanded",function(){this._loadVisibleImages(this._$panel)},this)}}},_getPanelHTML:function(t,e){return home.view("geo-collections__panel",{items:e.collections,title:e.title,id:t,logShow:t!==this._defaultKey})},_initialLoadImages:function(){},_loadVisibleImages:function(t){var e,i,n=this.findElem(t||this.domElem,"wrap"),s=n.scrollLeft(),o=n.width()+s+100;e=Math.ceil(o/this.__self._itemWidth),i=this.findElem(t||this.domElem,"item").slice(0,e),this._loadImages(i)},_onPanelDraw:function(t,e){this.__base.apply(this,arguments),this.findElem(e,"wrap").on("scroll",this._scrollThrottledHandler)},_onPanelChange:function(t,e){this.__base.apply(this,arguments),this._loadVisibleImages(e),this.findBlockInside(e,"carousel").setScrollMod(),this._calcOverflow(e)},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("media-service__panel"),t}},{_itemWidth:296,_scrollLoadImageThrottle:200}),BEM.DOM.decl({block:"geo-collections-loader",baseBlock:"insert-loader"},{_getDataUrl:function(){return this.params.url},_checkData:function(t){return t.tabs&&t.tabs.length},_selectData:function(t){return t},_getHTML:function(t){return home.view("geo-collections",t)}}),BEM.DOM.decl({block:"market-media",baseBlock:"media-service"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages()}.bind(this),this.__self.SCROLL_THROTTLE),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._loadVisibleImages()}}},_initialLoadImages:function(){},_loadVisibleImages:function(){var t=this.elem("wrap"),e=t.width()+t.scrollLeft(),i=Math.ceil(e/this.__self.ITEM_WIDTH),n=this.elem("item-inner");this._loadImages(n.slice(0,i))}},{ITEM_WIDTH:136,SCROLL_THROTTLE:200}),BEM.DOM.decl({block:"market-media-loader",baseBlock:"insert-loader"},{_getDataUrl:function(){return this.params.url},_checkData:function(t){return t.models&&t.models.length},_selectData:function(t){var e=t.context||{},i={marketUrl:"",currency:{}};return i.models=t.models.filter(function(t){return t.offer&&t.offer.price&&t.offer.price.value}).map(function(t){return{link:t.link,title:t.name,photoUrl:t.photo.url,price:t.offer.price.value}}),e&&(i.marketUrl=e.marketUrl,i.currency=e.currency),i},_getHTML:function(t){return home.view("market-media",t)}}),BEM.DOM.decl({block:"collections",baseBlock:"media-service",baseMix:["mix-tabber","mix-tabber-labels","mix-tabber-labels-keyboard"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages(this._$panel)}.bind(this),this.__self._scrollLoadImageThrottle),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._onPanelChange(this._selectedKey,this.elem("panel"));var t=this.findBlockOutside("media-grid");t&&t.on("expanded",function(){this._loadVisibleImages(this._$panel)},this)}}},_getPanelHTML:function(t,e){return home.view("collections__panel",{list:e.list,title:e.title,id:t,logShow:t!==this._defaultKey})},_initialLoadImages:function(){},_loadVisibleImages:function(t){var e,i,n=this.findElem(t||this.domElem,"wrap"),s=n.scrollLeft(),o=n.width()+s+100;"channels"===this._selectedKey?(e=Math.ceil(o/this.__self._itemWidth),i=this.findElem(t||this.domElem,"item").slice(0,e)):i=this.findElem("column").filter(function(){var t=$(this),e=t.outerWidth()+parseInt(t.css("margin-right"),10);if(o>0)return o-=e,!0}).find(".collections__feed-item"),home.stat.logDOMShow(i,{visibilityCheck:!1}),this._loadImages(i)},_onPanelDraw:function(t,e){this.findElem(e,"wrap").on("scroll",this._scrollThrottledHandler)},_onPanelChange:function(t,e){this.__base.apply(this,arguments),this._loadVisibleImages(e),this.findBlockInside(e,"carousel").setScrollMod(),this._calcOverflow(e)},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("media-service__panel"),t}},{_itemWidth:187,_scrollLoadImageThrottle:200}),BEM.DOM.decl({block:"collections-loader",baseBlock:"insert-loader"},{_getDataUrl:function(){return"/portal/api/data/1/?block=collections&content=api_data_big&limit=15&feed_top_size=20&lang="+this.params.locale},_checkData:function(t){return t.block&&t.block[0]&&t.block[0].data&&t.block[0].data.list&&t.block[0].data.list.length>=2},_selectData:function(t){return t.block[0].data},_getHTML:function(t){return home.view("collections",t)}}),BEM.DOM.decl({block:"tutor",baseBlock:"media-service",baseMix:["mix-tabber","mix-tabber-labels","mix-tabber-labels-keyboard"]},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._scrollThrottledHandler=home.throttle(function(){this._loadVisibleImages(this._$panel)}.bind(this),this.__self.SCROLL_THROTTLE),this.elem("wrap").on("scroll",this._scrollThrottledHandler),this._calcOverflow(this.domElem),this._loadVisibleImages()}}},_loadVisibleImages:function(t){var e=this.findElem(t||this.domElem,"wrap"),i=e.width()+e.scrollLeft(),n=this.findElem(t||this.domElem,"card"),s=0;n.length&&(s=Math.ceil(i/(n.eq(0).width()+this.__self.EVENTS_MARGIN))),this._loadImages(n.slice(0,s))},_onPanelChange:function(t,e){this.__base.apply(this,arguments),this._calcOverflow(e),this._loadVisibleImages(e);var i=this.findBlockInside(e,"carousel");i&&i.setScrollMod()},_calcOverflow:function(t){BEM.blocks["i-multiline-overflow"].calcOverflow(t,2,"tutor")},_initialLoadImages:function(){},_createPanel:function(){var t=this.__base.apply(this,arguments);return t.addClass("media-service__panel"),t}},{SCROLL_THROTTLE:200,MIN_VISIBLE_HEIGHT:0,EVENTS_MARGIN:16}),home.getData("i-sw-reporter.on")&&"serviceWorker"in navigator&&setTimeout(function(){window.defaultMetrikaCounter&&Promise.resolve().then(function(){return navigator.serviceWorker.getRegistrations()}).then(function(t){var e=null;t.forEach(function(t){var i=home.parseUrl(t.scope).path;i=i.replace(/(^\/|\/$)/g,"").replace(/\//g,"_"),["active","installing","waiting"].forEach(function(n){t[n]&&((e=e||{})["sw-report"]=e["sw-report"]||{},e["sw-report"][i]=e["sw-report"][i]||{},e["sw-report"][i][n]=t[n].scriptURL||1)})}),e&&window.defaultMetrikaCounter.params(e)}).catch(function(){})},5e3),function(){"use strict";var t="#hs"===window.location.hash;t&&(window.history&&history.replaceState?history.replaceState(history.state,"",location.pathname+location.search):location.hash="");var e=home.localStorage,i=!home.disabledLS&&e,n=$(window);function s(t){return t?new Date(t).getTime():(new Date).getTime()}i&&BEM.DOM.decl("b-hs-balloon",{onSetMod:{js:function(){var e=this;if(t)e._setDoNotShowFlag();else if(!e._getDoNotShowFlag()&&90!==Math.abs(window.orientation)){var i=e._getData();i.length<3&&BEM.blocks["i-message-locker"].acquireLock("b-hs-balloon").then(function(){e.show(),e._updateShownDates(i),e.adjustBalloonPosition(),e._bindScroll(),e.elem("close").on("click",function(){e.forceHideBalloon()})})}}},adjustBalloonPosition:function(){var t=n.scrollTop();this.domElem.css("top",t)},_bindScroll:function(){n.on("scroll.balloon",this.changeThis(this.adjustBalloonPosition))},_unbindScroll:function(){n.off("scroll.balloon")},show:function(){var t=this;window.setTimeout(function(){t.setMod("display","yes"),t.adjustBalloonPosition(),t.setMod("opacity","visible"),home.stat.logDOMShow(t.domElem)},0),window.setTimeout(function(){t.hide()},15e3),window.location.hash="hs"},hide:function(){var t=this;this.setMod("opacity","hidden"),setTimeout(function(){t._unbindScroll(),t.setMod("display","no"),BEM.blocks["i-message-locker"].releaseLock("b-hs-balloon")},500)},immediateHide:function(){this._unbindScroll(),this.setMod("display","no"),this.setMod("opacity","hidden"),BEM.blocks["i-message-locker"].releaseLock("b-hs-balloon")},forceHideBalloon:function(){this._setDoNotShowFlag(),this.hide()},_getData:function(){var t;try{t=JSON.parse(e.getItem("balloonShownDates")).filter(function(t){return!isNaN(s(t))&&s()-s(t)<12096e5})}catch(e){t=[]}return t},_updateShownDates:function(t){t.push(s());var i,n=(i=3,t.reverse().splice(0,i).reverse());e.setItem("balloonShownDates",JSON.stringify(n))},_setDoNotShowFlag:function(){e.setItem("doNotShowHSBalloon",1)},_getDoNotShowFlag:function(){return e.getItem("doNotShowHSBalloon")}})}(),function(t){if("function"==typeof t.I18N&&t.I18N._proto)return t.I18N;"undefined"==typeof i18n&&(i18n={}),BEM=t;var e="_",i="__",n={},s=[],o=!1,r="undefined"!=typeof console&&"function"==typeof console.log;function a(t,e){if(o&&r){var i="keyset: "+e._keyset+" key: "+e._key+" (lang: "+e._lang+")";console.log(t,i)}}function c(){this._lang="",this._prj="lego",this._keyset="",this._key=""}c.prototype={lang:function(t){return this._lang=t,this},project:function(t){return this._prj=t,this},keyset:function(t,n){var o;return n&&function(t){t&&s.push(t)}(this._keyset),this._keyset="string"==typeof(o=t)?o:o.block+(o.elem?i+o.elem:"")+(o.modName?e+o.modName+e+o.modVal:""),this},key:function(t){return this._key=t,this},decl:function(t){var s=function(t){var n={};return t.split(i).forEach(function(t,i){var s=[i?"elem":"block","mod","val"];t.split(e).forEach(function(t,e){n[s[e]]=t})}),n}(this._keyset),o="i-tanker"===s.block?"tanker":this._prj,r=s.elem||this._keyset,a=this._key;(r=(o=i18n[o]||(i18n[o]={}))[r]||(o[r]={}))[a]="function"==typeof t?t:function(){return t};var c=n[this._lang]||(n[this._lang]={});(c[this._keyset]||(c[this._keyset]={}))[a]=t},val:function(t,e){var i=n[this._lang]&&n[this._lang][this._keyset];if(!i)return a("[I18N_NO_KEYSET] %s",this),"";var s=typeof(i=i[this._key]);return"undefined"===s?(a("[I18N_NO_VALUE] %s",this),""):"string"===s?i:i.call(e||this,t)},_cache:function(){return n}};var l=function(t,e,i){return l.keyset(t).key(e,i)};l._proto=new c,l.project=function(t){return this._proto.project(t),this},l.keyset=function(t){return this._proto.keyset(t,!0),this},l.key=function(t,e){var i,n,o=this._proto;return o.lang(this._lang).key(t),i=o.val(e,l),(n=s.length&&s.pop())&&o.keyset(n,!1),i},l.decl=function(t,e,i){var n,s=this._proto;for(n in i&&i.lang&&s.lang(i.lang),s.keyset(t),e)e.hasOwnProperty(n)&&s.key(n).decl(e[n]);return this},l.lang=function(t){return void 0!==t&&(this._lang=t),this._lang},l.debug=function(t){o=!!t},l.lang("ru"),t.I18N=l}("undefined"==typeof BEM?{}:BEM),"undefined"!=typeof BEM&&BEM.I18N&&(BEM.I18N.decl("b-keyboard-popup",{close:""},{lang:"ru"}),BEM.I18N.decl("popup",{add:"",cancel:"",revert:"",apply:""},{lang:"ru"}),BEM.I18N.decl("search2",{"search-button-text":"","search-input-label":"","search-service-label":"  ","search-web-label":"  "},{lang:"ru"}),BEM.I18N.decl("suggest2",{fact:"",group:" ",nah:" ",nav:"",on_other_devices:"  ",text:"",traffic:"",weather:""},{lang:"ru"}),BEM.I18N.decl("suggest2-item",{"quick-answer":" "},{lang:"ru"}),BEM.I18N.decl("tumbler",{off:"",on:""},{lang:"ru"}),BEM.I18N.lang("ru")),function(t){function e(e){var i={},n=new(function(e,i){return function(n){if("object"==typeof i&&void 0!==e)e.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).bemhtml=n()}}(function(){return function t(e,i,n){function s(r,a){if(!i[r]){if(!e[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[r]={exports:{}};e[r][0].call(h.exports,function(t){var i=e[r][1][t];return s(i||t)},h,h.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e,i){var n=t("inherits"),s=t("../bemxjst/match").Match,o=t("../bemxjst/entity").Entity;function r(t){this.bemxjst=t,this.jsClass=null,this.tag=new s(this,"tag"),this.attrs=new s(this,"attrs"),this.mod=new s(this),this.js=new s(this,"js"),this.mix=new s(this,"mix"),this.bem=new s(this,"bem"),this.cls=new s(this,"cls"),o.apply(this,arguments)}n(r,o),i.Entity=r,r.prototype.init=function(t,e){this.block=t,this.elem=e,this.jsClass=this.bemxjst.classBuilder.build(this.block,this.elem)},r.prototype._initRest=function(t){"default"===t?this.rest[t]=this.def:"tag"===t||"attrs"===t||"js"===t||"mix"===t||"bem"===t||"cls"===t||"content"===t?this.rest[t]=this[t]:this.rest.hasOwnProperty(t)||(this.rest[t]=new s(this,t))},r.prototype.defaultBody=function(t){var e,i=this.tag.exec(t);!1!==t.ctx.js&&(e=this.js.exec(t));var n=this.bem.exec(t),s=this.cls.exec(t),o=this.mix.exec(t),r=this.attrs.exec(t),a=this.content.exec(t);return this.bemxjst.render(t,this,i,e,n,s,o,r,a)}},{"../bemxjst/entity":5,"../bemxjst/match":8,inherits:11}],2:[function(t,e,i){var n=t("inherits"),s=t("../bemxjst/utils"),o=t("./entity").Entity,r=t("../bemxjst");function a(t){r.apply(this,arguments);var e=void 0===t.xhtml||t.xhtml;this._shortTagCloser=e?"/>":">",this._elemJsInstances=t.elemJsInstances}n(a,r),e.exports=a,a.prototype.Entity=o,a.prototype.runMany=function(t){var e="",i=this.context,n=i.position,s=i._notNewList;if(s?i._listLength+=t.length-1:(i.position=0,i._listLength=t.length),i._notNewList=!0,this.canFlush)for(var o=0;o<t.length;o++)e+=i._flush(this._run(t[o]));else for(o=0;o<t.length;o++)e+=this._run(t[o]);return s||(i.position=n),e},a.prototype.render=function(t,e,i,n,o,r,a,c,l){var h=t.ctx;if(void 0===i&&(i="div"),!i)return this.renderNoTag(t,n,o,r,a,c,l);var u,d="<"+i,m=h.js;!1!==m&&(!0===n&&(n={}),n&&n!==h.js?!0!==m&&(n=s.extend(m,n)):!0===m&&(n={})),n&&((u={})[e.jsClass]=n);var p=o;void 0===p&&(p=void 0===h.bem?e.block||e.elem:h.bem),p=!!p,void 0===r&&(r=h.cls);var f=u&&(this._elemJsInstances?e.block||e.elem:e.block&&!e.elem);if(!p&&!r)return this.renderClose(d,t,i,c,p,h,l);if(d+=' class="',p){var _=e.elem?t.elemMods:t.mods;if(d+=e.jsClass,d+=this.buildModsClasses(e.block,e.elem,_),h.mix&&a&&a!==h.mix&&(a=[].concat(a,h.mix)),a){var g=this.renderMix(e,a,u,f);d+=g.out,u=g.jsParams,f=g.addJSInitClass}r&&(d+=" "+("string"==typeof r?s.attrEscape(r).trim():r))}else r&&(d+=r.trim?s.attrEscape(r).trim():r);return d+=f?' i-bem"':'"',p&&u&&(d+=" data-bem='"+s.jsAttrEscape(JSON.stringify(u))+"'"),this.renderClose(d,t,i,c,p,h,l)},a.prototype.renderClose=function(t,e,i,n,o,r,a){var c=t,l=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&null!==t};if(l(n)||l(r.attrs))for(var h in n=s.extend(n,r.attrs)){var u=n[h];void 0!==u&&!1!==u&&null!==u&&(c+=!0===u?" "+h:" "+h+'="'+s.attrEscape(s.isSimple(u)?u:this.context.reapply(u))+'"')}return s.isShortTag(i)?(c+=this._shortTagCloser,this.canFlush&&(c=e._flush(c))):(c+=">",this.canFlush&&(c=e._flush(c)),(a||0===a)&&(c+=this.renderContent(a,o)),c+="</"+i+">"),this.canFlush&&(c=e._flush(c)),c},a.prototype.renderMix=function(t,e,i,n){var o={},r=this.context,a=i,c=n;o[t.jsClass]=!0,s.isArray(e)||(e=[e]);for(var l=this.classBuilder,h="",u=0;u<e.length;u++){var d=e[u];if(d){"string"==typeof d&&(d={block:d,elem:void 0});var m=!1;d.elem?m=d.elem!==t.elem&&d.elem!==r.elem||d.block&&d.block!==t.block:d.block&&(m=!(d.block===t.block&&d.mods)||d.mods&&t.elem);var p=d.block||d._block||r.block,f=d.elem||d._elem||r.elem,_=l.build(p,f),g=d.elem||d._elem||(d.block?void 0:r.elem);if(m&&(h+=" "+l.build(p,g)),h+=this.buildModsClasses(p,g,d.elem||!d.block&&(d._elem||r.elem)?d.elemMods:d.mods),d.js&&(a||(a={}),a[l.build(p,d.elem)]=!0===d.js?{}:d.js,c||(c=p&&!d.elem)),m&&!o[_]){o[_]=!0;var v=this.entities[_];if(v){var b=r.block,y=r.elem,w=v.mix.exec(r);if(r.elem=y,r.block=b,w)for(var k=0;k<w.length;k++){var E=w[k];if(E&&(!E.block&&!E.elem||!o[l.build(E.block,E.elem)])){if(E.block)continue;E._block=p,E._elem=f,e=e.slice(0,u+1).concat(E,e.slice(u+1))}}}}}}return{out:h,jsParams:a,addJSInitClass:c}},a.prototype.buildModsClasses=function(t,e,i){if(!i)return"";var n,s="";for(n in i)if(i.hasOwnProperty(n)&&""!==n){var o=i[n];if(o||0===o){"boolean"!=typeof o&&(o+="");var r=this.classBuilder;s+=" "+(e?r.buildElemClass(t,e,n,o):r.buildBlockClass(t,n,o))}}return s},a.prototype.renderNoTag=function(t,e,i,n,s,o,r){return r||0===r?this._run(r):""}},{"../bemxjst":7,"../bemxjst/utils":10,"./entity":1,inherits:11}],3:[function(t,e,i){function n(t){this.modDelim=t.mod||"_",this.elemDelim=t.elem||"__"}i.ClassBuilder=n,n.prototype.build=function(t,e){return e?t+this.elemDelim+e:t},n.prototype.buildModPostfix=function(t,e){var i=this.modDelim+t;return!0!==e&&(i+=this.modDelim+e),i},n.prototype.buildBlockClass=function(t,e,i){var n=t;return i&&(n+=this.buildModPostfix(e,i)),n},n.prototype.buildElemClass=function(t,e,i,n){var s=this.buildBlockClass(t)+this.elemDelim+e;return n&&(s+=this.buildModPostfix(i,n)),s},n.prototype.split=function(t){return t.split(this.elemDelim,2)}},{}],4:[function(t,e,i){var n=t("./utils");function s(t){this._bemxjst=t,this.ctx=null,this.block="",this._currBlock="",this.elem=null,this.mods={},this.elemMods={},this.position=0,this._listLength=0,this._notNewList=!1,this.escapeContent=!0===t.options.escapeContent,this._onceRef={}}i.Context=s,s.prototype._flush=null,s.prototype.isArray=n.isArray,s.prototype.isSimple=n.isSimple,s.prototype.isShortTag=n.isShortTag,s.prototype.extend=n.extend,s.prototype.identify=n.identify,s.prototype.xmlEscape=n.xmlEscape,s.prototype.attrEscape=n.attrEscape,s.prototype.jsAttrEscape=n.jsAttrEscape,s.prototype.isFirst=function(){return 1===this.position},s.prototype.isLast=function(){return this.position===this._listLength},s.prototype.generateId=function(){return n.identify(this.ctx)},s.prototype.reapply=function(t){return this._bemxjst.run(t)}},{"./utils":10}],5:[function(t,e,i){var n=t("./utils"),s=t("./match").Match,o=t("./tree"),r=o.Template,a=o.PropertyMatch,c=o.CompilerOptions;function l(t,e,i,n){this.bemxjst=t,this.block=null,this.elem=null,this.options={},this.canFlush=!0,this.def=new s(this),this.content=new s(this,"content"),this.rest={},this.init(e,i),this.initModes(n)}function h(){return this.ctx.content}i.Entity=l,l.prototype.init=function(t,e){this.block=t,this.elem=e},l.prototype.initModes=function(t){for(var e=0;e<t.length;e++){for(var i=t[e],s=i.predicates.length-1;s>=0;s--){if((o=i.predicates[s])instanceof a&&"_mode"===o.key){i.predicates.splice(s,1),this._initRest(o.value),this.rest[o.value].push(i);break}}-1===s&&this.def.push(i);for(s=i.predicates.length-1;s>=0;s--){var o;(o=i.predicates[s])instanceof c&&(this.options=n.extend(this.options,o.options))}}},l.prototype.prepend=function(t){for(var e=Object.keys(this.rest),i=0;i<e.length;i++){var n=e[i];t.rest[n]&&this.rest[n].prepend(t.rest[n])}e=Object.keys(t.rest);for(i=0;i<e.length;i++){n=e[i];this.rest[n]||(this._initRest(n),this.rest[n].prepend(t.rest[n]))}},l.prototype.run=function(t){return 0!==this.def.count?this.def.exec(t):this.defaultBody(t)},l.prototype.setDefaults=function(){if(0!==this.content.count&&this.content.push(new r([],h)),0!==this.def.count){this.canFlush=this.options.flush||!1;var t=this;this.def.push(new r([],function(){return t.defaultBody(this)}))}}},{"./match":8,"./tree":9,"./utils":10}],6:[function(t,e,i){function n(t,e){this.name="BEMXJSTError",this.message=t,Error.captureStackTrace?Error.captureStackTrace(this,e||this.constructor):this.stack=(new Error).stack}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,i.BEMXJSTError=n},{}],7:[function(t,e,i){var n=t("inherits"),s=t("./tree").Tree,o=t("./tree").PropertyMatch,r=t("./context").Context,a=t("./class-builder").ClassBuilder,c=t("./utils");function l(t){this.options=t||{},this.entities=null,this.defaultEnt=null,this.tree=null,this.match=null,this.contextConstructor=function(t){r.call(this,t)},n(this.contextConstructor,r),this.context=null,this.classBuilder=new a(this.options.naming||{}),this.depth=0,this.canFlush=!1,this.oninit=null,this.defaultEnt=new this.Entity(this,"","",[]),this.defaultElemEnt=new this.Entity(this,"","",[])}e.exports=l,l.prototype.locals=s.methods.concat("local","applyCtx","applyNext","apply"),l.prototype.compile=function(t){var e=this;function i(){return e._run(e.context.ctx)}function n(t,n){return n?e.local(n,function(){return e.local({ctx:t},i)}):e.local({ctx:t},i)}function o(t){return function(i){return e.local(t,i)}}var r=new s({refs:{applyCtx:n,local:o}}),a=this.recompileInput(t),c=r.build(a,[o,n,function t(i){return i?e.local(i,t):e.applyNext()},function(t,i){return e.applyMode(t,i)}]);this.tree&&(c={templates:c.templates.concat(this.tree.templates),oninit:this.tree.oninit.concat(c.oninit)}),this.tree=c;var l=this.groupEntities(c.templates);l=this.transformEntities(l),this.entities=l,this.oninit=c.oninit},l.prototype.recompileInput=function(t){var e=l.prototype.locals;if("function"==typeof t&&t.length===e.length)return t;var i=t.toString();return i=i.replace(/^function[^{]+{|}$/g,""),i=new Function(e.join(", "),i)},l.prototype.groupEntities=function(e){for(var i={},n=0;n<e.length;n++){var s,r=e[n].clone(),a=null;s=void 0;for(var c=0;c<r.predicates.length;c++){if((h=r.predicates[c])instanceof o){if("block"===h.key)a=h.value;else{if("elem"!==h.key)continue;s=h.value}r.predicates.splice(c,1),c--}}if(null===a){var l="block() subpredicate is not found.\n    See template with subpredicates:\n     * ";for(c=0;c<r.predicates.length;c++){var h=r.predicates[c];0!==c&&(l+="\n     * "),"_mode"===h.key?l+=h.value+"()":Array.isArray(h.key)?l+=h.key[0].replace("mods","mod").replace("elemMods","elemMod")+"('"+h.key[1]+"', '"+h.value+"')":h.value&&h.key?l+=h.key+"('"+h.value+"')":l+="match()"}throw l+="\n    And template body: \n    ("+("function"==typeof r.body?r.body:JSON.stringify(r.body))+")","undefined"==typeof BEMXJSTError&&(BEMXJSTError=t("./error").BEMXJSTError),new BEMXJSTError(l)}var u=this.classBuilder.build(a,s);i[u]||(i[u]=[]),i[u].push(r)}return i},l.prototype.transformEntities=function(t){for(var e=[],i=Object.keys(t),n=0;n<i.length;n++){var s=i[n],o=this.classBuilder.split(s),r=o[0],a=o[1];"*"===a&&e.push(r),t[s]=new this.Entity(this,r,a,t[s])}if(t.hasOwnProperty("*")){var c=t["*"];for(n=0;n<i.length;n++){"*"!==(s=i[n])&&t[s].prepend(c)}this.defaultEnt.prepend(c),this.defaultElemEnt.prepend(c)}for(n=0;n<e.length;n++){r=e[n];var l=this.classBuilder.build(r,"*");for(c=t[l],n=0;n<i.length;n++){if((s=i[n])!==l){var h=t[s];h.block===r&&void 0!==h.elem&&t[s].prepend(c)}}this.defaultElemEnt.prepend(c)}for(n=0;n<i.length;n++){t[s=i[n]].setDefaults(),this.defaultEnt.setDefaults(),this.defaultElemEnt.setDefaults()}return t},l.prototype._run=function(t){return void 0===t||""===t||null===t?this.runEmpty():c.isArray(t)?this.runMany(t):"string"!=typeof t.html||t.tag||void 0!==t.block||void 0!==t.elem||void 0!==t.cls||void 0!==t.attrs?c.isSimple(t)?this.runSimple(t):this.runOne(t):this.runUnescaped(t.html)},l.prototype.run=function(t){var e=this.match,i=this.context;this.match=null,this.context=new this.contextConstructor(this),this.canFlush=null!==this.context._flush,this.depth=0;var n=this._run(t);return this.canFlush&&(n=this.context._flush(n)),this.match=e,this.context=i,n},l.prototype.runEmpty=function(){return this.context._listLength--,""},l.prototype.runUnescaped=function(t){return this.context._listLength--,""+t},l.prototype.runSimple=function(t){this.context._listLength--;var e="";return(t&&!0!==t||0===t)&&(e+="string"==typeof t&&this.context.escapeContent?c.xmlEscape(t):t),e},l.prototype.runOne=function(t){var e=this.context,i=e.ctx,n=e.block,s=e._currBlock,o=e.elem,r=e.mods,a=e.elemMods;t.block||t.elem?e._currBlock="":e._currBlock=e.block,e.ctx=t,t.block?(e.block=t.block,t.mods?e.mods=t.mods:t.block===n&&t.elem||(e.mods={})):t.elem?s&&(e.block=s):e.block="",e.elem=t.elem,t.elemMods?e.elemMods=t.elemMods:e.elemMods={};var c=e.block||"",l=e.elem;c||l?e.position++:e._listLength--,this.depth++;var h=this.classBuilder.build(c,l),u=!1,d=this.entities[h];d?this.canFlush&&!d.canFlush&&(u=!0,this.canFlush=!1):(d=this.defaultEnt,void 0!==l&&(d=this.defaultElemEnt),d.init(c,l));var m=!0===this.options.production?this.tryRun(e,d):d.run(e);return e.ctx=i,e.block=n,e.elem=o,e.mods=r,e.elemMods=a,e._currBlock=s,this.depth--,u&&(this.canFlush=!0),m},l.prototype.tryRun=function(t,e){try{return e.run(t)}catch(e){return console.error("BEMXJST ERROR: cannot render "+["block "+t.block,"elem "+t.elem,"mods "+JSON.stringify(t.mods),"elemMods "+JSON.stringify(t.elemMods)].join(", "),e),""}},l.prototype.renderContent=function(t,e){var i=this.context,n=i.position,s=i._listLength,o=i._notNewList;i._notNewList=!1,e&&(i.position=0,i._listLength=1);var r=this._run(t);return i.position=n,i._listLength=s,i._notNewList=o,r},l.prototype.local=function(t,e){for(var i=Object.keys(t),n=[],s=0;s<i.length;s++){for(var o=i[s],r=o.split("."),a=this.context,c=0;c<r.length-1;c++)a=a[r[c]];n.push({parts:r,value:a[r[c]]}),a[r[c]]=t[o]}var l=e.call(this.context);for(s=0;s<n.length;s++){for(r=n[s].parts,a=this.context,c=0;c<r.length-1;c++)a=a[r[c]];a[r[c]]=n[s].value}return l},l.prototype.applyNext=function(){return this.match.exec(this.context)},l.prototype.applyMode=function(t,e){var i=this.match.entity.rest[t];if(!i)return this.context.ctx[t];if(!e)return i.exec(this.context);var n=this;return this.local(e,function(){return i.exec(n.context)})},l.prototype.exportApply=function(t){var e=this;t.apply=function(t){return e.run(t)},t.compile=function(t){return e.compile(t)};var i={};t.BEMContext=this.contextConstructor,i.BEMContext=t.BEMContext;for(var n=0;n<this.oninit.length;n++){(0,this.oninit[n])(t,i)}}},{"./class-builder":3,"./context":4,"./error":6,"./tree":9,"./utils":10,inherits:11}],8:[function(t,e,i){var n=t("./utils"),s=t("./tree"),o=s.PropertyMatch,r=s.OnceMatch,a=s.WrapMatch,c=s.PropertyAbsent,l=s.CustomMatch;function h(t,e){this.template=t,this.key=e.key,this.value=e.value}function u(t,e){this.template=t,this.keys=e.key,this.value=e.value}function d(t,e){this.template=t,this.key=e.key}function m(t,e){this.template=t,this.body=e.body}function p(t){this.template=t,this.once=null}function f(t){this.template=t,this.wrap=null}function _(t,e){this.mode=t,this.predicates=new Array(e.predicates.length),this.body=e.body;for(var i=[],s=0,_=0;s<this.predicates.length;s++,_++){var g=e.predicates[s];g instanceof o?n.isArray(g.key)?this.predicates[_]=new u(this,g):this.predicates[_]=new h(this,g):g instanceof c?this.predicates[_]=new d(this,g):g instanceof l?this.predicates[_]=new m(this,g):g instanceof r?(_--,i.push(new p(this))):g instanceof a?(_--,i.push(new f(this))):_--}for(s=0;s<i.length;s++,_++)this.predicates[_]=i[s];this.predicates.length!==_&&(this.predicates.length=_)}function g(t,e){this.entity=t,this.modeName=e,this.bemxjst=this.entity.bemxjst,this.templates=[],this.mask=[0],this.maskSize=0,this.maskOffset=0,this.count=0,this.depth=-1,this.thrownError=null}h.prototype.exec=function(t){return t[this.key]===this.value},u.prototype.exec=function(t){for(var e=t,i=0;i<this.keys.length-1;i++)if(!(e=e[this.keys[i]]))return!1;return e[this.keys[i]]===this.value},d.prototype.exec=function(t){return!t[this.key]},m.prototype.exec=function(t){return this.body.call(t,t,t.ctx)},p.prototype.exec=function(t){var e=this.once!==t._onceRef;return this.once=t._onceRef,e},f.prototype.exec=function(t){var e=this.wrap!==t.ctx;return this.wrap=t.ctx,e},i.MatchTemplate=_,i.Match=g,g.prototype.clone=function(t){var e=new g(t,this.modeName);return e.templates=this.templates.slice(),e.mask=this.mask.slice(),e.maskSize=this.maskSize,e.count=this.count,e},g.prototype.prepend=function(t){for(this.templates=t.templates.concat(this.templates),this.count+=t.count;Math.ceil(this.count/31)>this.mask.length;)this.mask.push(0);this.maskSize=this.mask.length},g.prototype.push=function(t){this.templates.push(new _(this,t)),this.count++,Math.ceil(this.count/31)>this.mask.length&&this.mask.push(0),this.maskSize=this.mask.length},g.prototype.tryCatch=function(t,e){try{return t.call(e,e,e.ctx)}catch(t){this.thrownError=t}},g.prototype.exec=function(t){for(var e,i=this.checkDepth(),n=this.maskOffset,s=this.mask[n],o=1,r=0;r<this.count;r++){if(0==(s&o)){e=this.templates[r];for(var a=0;a<e.predicates.length;a++){if(!e.predicates[a].exec(t))break}if(a===e.predicates.length)break}1073741824===o?(n++,s=this.mask[n],o=1):o<<=1}if(r===this.count)return t.ctx[this.modeName];var c,l=s,h=this.bemxjst.match;this.mask[n]|=o,this.bemxjst.match=this,this.thrownError=null,c="function"==typeof e.body?this.tryCatch(e.body,t):e.body,this.mask[n]=l,this.bemxjst.match=h,this.restoreDepth(i);var u=this.thrownError;if(null!==u)throw this.thrownError=null,u;return c},g.prototype.checkDepth=function(){if(-1===this.depth)return this.depth=this.bemxjst.depth,-1;if(this.bemxjst.depth===this.depth)return this.depth;var t=this.depth;for(this.depth=this.bemxjst.depth,this.maskOffset+=this.maskSize;this.mask.length<this.maskOffset+this.maskSize;)this.mask.push(0);return t},g.prototype.restoreDepth=function(t){-1!==t&&t!==this.depth&&(this.maskOffset-=this.maskSize),this.depth=t}},{"./tree":9,"./utils":10}],9:[function(t,e,i){var n=t("minimalistic-assert"),s=t("inherits");function o(t,e){this.predicates=t,this.body=e}function r(){}function a(t,e){this.conditions=[],this.children=[];for(var i=e.length-1;i>=0;i--){var n=e[i];n instanceof r?this.conditions.push(n):n===t.boundBody?this.children[i]=t.queue.pop():this.children[i]=n}}function c(){r.call(this)}function l(t){r.call(this),this.refs=t}function h(t){r.call(this),this.refs=t}function u(t){r.call(this),this.refs=t}function d(t){r.call(this),this.options=t}function m(t,e){r.call(this),this.key=t,this.value=e}function p(t){r.call(this),this.key=t}function f(t){r.call(this),this.body=t}function _(t){this.options=t,this.refs=this.options.refs,this.boundBody=this.body.bind(this);for(var e=this.methods("body"),i=0;i<e.length;i++){var n=e[i];this.boundBody[_.methods[i]]=n}this.queue=[],this.templates=[],this.initializers=[]}function g(t,e,i){var n=t[i],s=t.boundBody;return"body"!==e?"replace"===i||"extend"===i||"wrap"===i?function(){return n.apply(t,arguments)}:function(){return n.apply(t,arguments),s}:function(){var e=n.apply(t,arguments),o=t.queue.pop(),r=t.queue[t.queue.length-1];return r.conditions=r.conditions.concat(o.conditions),r.children=r.children.concat(o.children),"replace"===i||"extend"===i||"wrap"===i?e:s}}i.Template=o,o.prototype.wrap=function(){for(var t=this.body,e=0;e<this.predicates.length;e++){t=this.predicates[e].wrapBody(t)}this.body=t},o.prototype.clone=function(){return new o(this.predicates.slice(),this.body)},i.MatchBase=r,r.prototype.wrapBody=function(t){return t},s(c,r),i.OnceMatch=c,s(l,r),i.WrapMatch=l,l.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this,this,this.ctx))}},s(h,r),i.ReplaceMatch=h,h.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this,this,this.ctx))}},s(u,r),i.ExtendMatch=u,u.prototype.wrapBody=function(t){var e=this.refs.applyCtx,i=this.refs.local;return"function"!=typeof t?function(){for(var n={},s=Object.keys(t),o=0;o<s.length;o++)n["ctx."+s[o]]=t[s[o]];return i(n)(function(){return e(this.ctx)})}:function(){for(var n={},s=t.call(this),o=Object.keys(s),r=0;r<o.length;r++)n["ctx."+o[r]]=s[o[r]];return i(n)(function(){return e(this.ctx)})}},s(d,r),i.CompilerOptions=d,s(m,r),i.PropertyMatch=m,s(p,r),i.PropertyAbsent=p,s(f,r),i.CustomMatch=f,i.Tree=_,_.methods=["match","once","wrap","block","elem","mode","mod","elemMod","def","tag","attrs","cls","js","bem","mix","content","replace","extend","oninit","xjstOptions"],_.prototype.build=function(t,e){var i=this.methods("global").concat(e);return i[0]=this.match.bind(this),t.apply({},i),{templates:this.templates.slice().reverse(),oninit:this.initializers}},_.prototype.methods=function(t){for(var e=new Array(_.methods.length),i=0;i<e.length;i++){var n=_.methods[i];e[i]=g(this,t,n)}return e},_.prototype.flush=function(t,e){var i;i=e.conditions?t.concat(e.conditions):e.conditions;for(var n=0;n<e.children.length;n++){var s=e.children[n];if(s instanceof a)this.flush(i,e.children[n]);else{var r=new o(t,s);r.wrap(),this.templates.push(r)}}},_.prototype.body=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new a(this,t);return this.queue[this.queue.length-1].children.push(i),1===this.queue.length&&this.flush([],this.queue.shift()),this.boundBody},_.prototype.match=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++){var i=arguments[e];"function"==typeof i&&(i=new f(i)),n(i instanceof r,"Wrong .match() argument"),t[e]=i}return this.queue.push(new a(this,t)),this.boundBody},_.prototype.once=function(){if(arguments.length)throw new Error("Predicate once() should not have arguments");return this.match(new c)},_.prototype.applyMode=function(t,e){if(t.length)throw new Error("Predicate should not have arguments but "+JSON.stringify(t)+" passed");return this.mode(e)},_.prototype.wrap=function(){return this.def.apply(this,arguments).match(new l(this.refs))},_.prototype.xjstOptions=function(t){return this.queue.push(new a(this,[new d(t)])),this.boundBody},_.prototype.block=function(t){return this.match(new m("block",t))},_.prototype.elem=function(t){return this.match(new m("elem",t))},_.prototype.mode=function(t){return this.match(new m("_mode",t))},_.prototype.mod=function(t,e){return this.match(new m(["mods",t],e))},_.prototype.elemMod=function(t,e){return this.match(new m(["elemMods",t],e))},_.prototype.def=function(){return this.applyMode(arguments,"default")},_.prototype.tag=function(){return this.applyMode(arguments,"tag")},_.prototype.attrs=function(){return this.applyMode(arguments,"attrs")},_.prototype.cls=function(){return this.applyMode(arguments,"cls")},_.prototype.js=function(){return this.applyMode(arguments,"js")},_.prototype.bem=function(){return this.applyMode(arguments,"bem")},_.prototype.mix=function(){return this.applyMode(arguments,"mix")},_.prototype.content=function(){return this.applyMode(arguments,"content")},_.prototype.replace=function(){return this.def.apply(this,arguments).match(new h(this.refs))},_.prototype.extend=function(){return this.def.apply(this,arguments).match(new u(this.refs))},_.prototype.oninit=function(t){this.initializers.push(t)}},{inherits:11,"minimalistic-assert":12}],10:[function(t,e,i){var n=Object.prototype.toString;i.isArray=Array.isArray,i.isArray||(i.isArray=function(t){return"[object Array]"===n.call(t)}),i.xmlEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},i.attrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")},i.jsAttrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/'/g,"&#39;")},i.extend=function(t,e){if(!t||!e)return t||e;var i,n={};for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n};var s={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1};i.isShortTag=function(t){return s.hasOwnProperty(t)},i.isSimple=function t(e){return!e||!0===e||(!(e.block||e.elem||e.tag||e.cls||e.attrs||!e.hasOwnProperty("html")||!t(e.html))||("string"==typeof e||"number"==typeof e))};var o=0,r=+new Date,a="__"+r,c="uniq"+r;function l(){return c+ ++o}i.getUniq=l,i.identify=function(t,e){if(!t)return l();if(e||t[a])return t[a];var i=l();return t[a]=i,i}},{}],11:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],12:[function(t,e,i){function n(t,e){if(!t)throw new Error(e||"Assertion failed")}e.exports=n,n.equal=function(t,e,i){if(t!=e)throw new Error(i||"Assertion failed: "+t+" != "+e)}},{}]},{},[2])(2)}),e.exports||i.BEMHTML}({},{}))({});return n.compile(function(t,i,n,s,o,r,a,c,l,h,u,d,m,p,f,_,g,v,b,y,w,k,E,M){b(function(t){var e=t.BEMContext.prototype,i=t["i-global"]=e["i-global"]=e.extend({lang:"ru",tld:"ru","content-region":"ru","click-host":"//clck.yandex.ru","passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","export-host":"https://export.yandex.ru",login:"","lego-static-host":"https://yastatic.net/lego/2.10-142"},e["i-global"]);i._public={id:!0,lang:!0,tld:!0,"content-region":!0,"user-region":!0,login:!0,displayName:!0,index:!0,yandexuid:!0,"passport-host":!0,"pass-host":!0,"passport-msg":!0,"static-host":!0,"lego-static-host":!0,"social-host":!0,clck:!0,"click-host":!0,"export-host":!0,"i-host":!0,"social-retpath":!0,"lego-path":!0,sid:!0,retpath:!0,uid:!0},i.makePublic=function(t,n){"object"!=typeof t?(void 0===n&&(n=!0),i._public[t]=n):i._public=e.extend(i._public,t)},i.isPublic=function(t){return Boolean(i._public[t])},i.setTld=function(t){var e="tr"===t?"yandex.com.tr":"yandex."+t,n=-1!==["ua","by","kz"].indexOf(t)?"yandex.ru":e;i.tld=t,i["content-region"]=t,i["click-host"]="//clck."+n,i["passport-host"]="https://passport."+n,i["pass-host"]="https://pass."+e,i["social-host"]="https://social."+e,i["export-host"]="https://export."+e},e._iGlobalBackup={_backup:null,exists:function(){return Boolean(this._backup)},save:function(){this._backup=e.extend({},i)},restore:function(){var t;for(t in i)delete i[t];for(t in this._backup)i[t]=this._backup[t]}}}),s("i-global")(h()(""),l()(function(){var t=this.ctx.params||{},e=this["i-global"];for(var i in this._iGlobalBackup.exists()?!1!==this.ctx.reset&&this._iGlobalBackup.restore():this._iGlobalBackup.save(),t.tld&&t.tld!==e.tld&&e.setTld(t.tld),t)e[i]=t[i];return""})),b(function(t){t.BEMContext.prototype.cleverSubstring=function(t,e,i){return t.length>e+i?t.substring(0,e-1)+"":t}}),s("input")(h()("span"),r("live")(!1),r("getLive")(function(){var t=M("live"),e=this.ctx.js,i=this.mods,n={autofocus:"yes",width:"content","tap-ahead":"yes"};return e?(void 0!==e.live?Boolean(e.live):t)&&!e.autoFocus&&!Object.keys(n).some(function(t){return i[t]===n[t]}):t}),m()(function(){return{live:this._live}}),l()(function(){var t,e=M("value",{ctx:this.ctx.value}),i=this.ctx.id||this.generateId(),n=this.mods,s=M("getLive",{}),o=this.ctx.placeholder;return n.theme=n.theme||"normal",this.ctx.hasOwnProperty("placeholder")&&(t=this.isSimple(o)?o:this.reapply(o)),E({_inputId:i,_labelId:"label"+i,_hintId:"hint"+i,_name:this.ctx.name||"",_value:e,_inputLink:!0,_iconLeft:this.ctx.icon||this.ctx.iconLeft,_iconRight:this.ctx.iconRight,_disabled:n.disabled,_live:s,_placeholder:t,_hasClear:"no"!==n.clear})}),r("value")("",t(function(){return this.ctx})(function(){return this.reapply(this.ctx)}),t(function(){return this.isSimple(this.ctx)})(function(){return this.ctx}))),s("input").elem("box")(h()("span"),_()(function(){return[this._iconLeft&&{elem:"icon",icon:this._iconLeft,elemMods:{side:"left"}},this._iconRight&&{elem:"icon",icon:this._iconRight,elemMods:{side:"right"}},this._hasClear&&{elem:"clear",elemMods:this._value||0===this._value?{visibility:"visible"}:void 0,content:""},this.ctx.content].filter(Boolean)})),s("input").elem("control")(h()("input"),u()(function(){var t=this.extend({id:this._inputId,name:this._name,placeholder:this._placeholder},this.ctx.controlAttrs);return(this._value||0===this._value||""===this._value)&&(t.value=this._value),this.mods.disabled&&(t.disabled=!0),this._live&&(t.autocomplete="off"),t["aria-labelledby"]=this._labelId+" "+this._hintId,t}),n()(function(){return{elem:"box",content:this.ctx}})),s("input").elem("clear")(h()("span"),u()(function(){return{unselectable:"on"}}),_().match(function(){return!this.ctx.content})("")),b(function(t){t.BEMContext.prototype.util||(t.BEMContext.prototype.util={})}),b(function(t){var e=Object.prototype.toString;function i(t){return"object"==typeof t&&"[object Object]"===e.call(t)}function n(t,e,s){var o,r;for(o in t=Object(t),e=Object(e))void 0!==(r=s&&s(t[o],e[o],o))?t[o]=r:i(t[o])&&i(e[o])?t[o]=n(t[o],e[o],s):t[o]=e[o];return t}t.BEMContext.prototype.util.merge=n,t.BEMContext.prototype.util.mergeBemjson=function(t,e){return n(t,e,function(t,e,i){if("mix"===i)return[].concat(t,e)})}}),s("i-ua")(p()(!1),h()("script"),u()(function(){return{nonce:this.ctx.nonce||this["i-global"].nonce}}),_()(function(){return[{html:[";(function(d,e,c,r){","e=d.documentElement;",'c="className";','r="replace";','e[c]=e[c][r]("i-ua_js_no","i-ua_js_yes");','if(d.compatMode!="CSS1Compat")','e[c]=e[c][r]("i-ua_css_standart","i-ua_css_quirks")',"})(document);"].join("")}]})),s("i-ua").content()(function(){var t=[";(function(d,e,c,n,w,v,f){","e=d.documentElement;",'c="className";','n="createElementNS";','f="firstChild";','w="http://www.w3.org/2000/svg";','e[c]+=" i-ua_svg_"+(!!d[n]&&!!d[n](w,"svg").createSVGRect?"yes":"no");','v=d.createElement("div");','v.innerHTML="<svg/>";','e[c]+=" i-ua_inlinesvg_"+((v[f]&&v[f].namespaceURI)==w?"yes":"no");',"})(document);"].join("");return[].concat(E(),{html:t})}),s("link")(l()(function(){this.mods;var t=this.ctx.url;return void 0===this.ctx.tabindex&&(this.ctx.tabindex="0"),this._url=this.isSimple(t)?t:this.reapply(t),E()}),h()(function(){return void 0!==this._url?"a":"span"}),m()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:void 0,_url:this.mods.disabled?this._url:void 0}}),t(function(){return"_blank"===this.ctx.target}).attrs()(function(){var t=this.ctx.attrs,e=void 0!==Object(t).rel?String(t.rel):"";return e&&-1===e.indexOf("noopener")&&(t.rel=e+" noopener"),this.extend(E(),{rel:"noopener"})}),u()(function(){var t=this.ctx,e=this._url,i=void 0!==e,n=Boolean(this.mods.disabled),s=n?i&&-1:t.tabindex;return this.extend(E(),{id:t.id,name:t.name,title:t.title,target:t.target,tabindex:s,href:i&&!n?e:void 0,role:i?void 0:"button","aria-disabled":n?"true":void 0})}),t(function(){return void 0===this.ctx.content}).content()(function(){var t,e=this.ctx,i=Boolean(e.text),n=Boolean(e.icon),s=(t=this.xmlEscape,function(e){return"string"==typeof e?{html:t(e)}:e});return[n&&this.util.mergeBemjson({block:"icon",mix:{block:"link",elem:"icon"}},e.icon),i&&(this.isSimple(e.text)?n?{elem:"inner",content:s(e.text)}:s(e.text):e.text.block?this.util.mergeBemjson({mix:{block:"link",elem:"inner"}},e.text):this.extend({block:"link",elem:"inner"},e.text))]}),o("inner").tag()("span")),s("popup")(l().match(function(){return!this._popupDefaults})(function(){var t=this.ctx,e=this.mods;if(e.hasOwnProperty("theme")||(e.theme="ffffff"),e.hasOwnProperty("autoclosable")||(e.autoclosable="yes"),e.hasOwnProperty("adaptive")||(e.adaptive="yes"),e.hasOwnProperty("animate")||(e.animate="yes"),t.zIndex){var i=t.attrs||(t.attrs={});i.style=(i.style||"")+";z-index:"+t.zIndex+";"}return M("default",{_popupDefaults:!0})}),_()(function(){return delete this._popupDefaults,[{elem:"under",elemMods:this.ctx.underMods},this.ctx.content]})),s("suggest2").elem("items").tag()("ul"),s("suggest2-item")(h()("li"),m()(!0),o("text")(h()(function(){return this.ctx.tag||"span"}),_()(function(){return this.ctx.text?Array.isArray(this.ctx.text)?this.ctx.text.map(function(t){return"string"==typeof t?t?{html:this.xmlEscape(t)}:"":t},this):this.ctx.text?{html:this.xmlEscape(this.ctx.text)}:"":Array.isArray(this.ctx.content)?this.ctx.content.map(function(t){return"string"==typeof t?t?{html:this.xmlEscape(t)}:"":t},this):this.ctx.content?{html:this.xmlEscape(this.ctx.content)}:""})),o("fact").tag()("span")),s("i-bem").elem("i18n").def()(function(){if(!this.ctx)return"";var t=this.ctx,e=t.keyset,i=t.key,n=t.params||{};return e||i?(t.content&&(n.content=this.reapply(t.content)),BEM.I18N(e,i,n)):""}),b(function(){!function(t,e){if(!e.I18N){t.BEM=e;var i=e.I18N=function(t,e){return e};i.keyset=function(){return i},i.key=function(t){return t},i.lang=function(){}}}(this,"undefined"==typeof BEM?{}:BEM)}),s("button2")(l()(function(){return void 0===this.mods.view&&(this.mods.view="classic"),this.mods.progress&&(this.mods.disabled="yes"),void 0===this.ctx.tabindex&&(this.ctx.tabindex="0"),E()}),t(function(){return void 0===this.ctx.tag}).tag()("button"),m()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:void 0}}),u()(function(){var t=this.ctx,e=Boolean(this.mods.disabled);return{type:"button",autocomplete:"off",id:t.id,title:t.title,name:t.name,value:t.val,tabindex:e?void 0:t.tabindex,disabled:e,"aria-disabled":e&&"true"}}),t(function(){return!this.ctx.content}).content()(function(){var t=this.ctx;return[t.icon&&{elem:"icon",icon:t.icon},t.iconLeft&&{elem:"icon",elemMods:{side:"left"},icon:t.iconLeft},t.iconRight&&{elem:"icon",elemMods:{side:"right"},icon:t.iconRight},void 0!==t.text&&(this.isSimple(t.text)?{elem:"text",content:{html:this.xmlEscape(t.text)}}:this.extend(t.text,{elem:"text"}))].filter(Boolean)})),s("button2").elem("text").tag()("span"),s("suggest2").mod("theme","normal").elem("content").tag()("ul"),s("suggest2-item").elem("highlight")(h()("b"),p()(!1),_()(function(){return this.xmlEscape(this.ctx.content)})),s("suggest2-item").elem("fact")(t(function(){return this.ctx.color}).def()(function(){return this.ctx.attrs=this.extend(Object(this.ctx.attrs),{style:";color:"+this.ctx.color+";"+(Object(this.ctx.attrs).style||"")}),E()}),_()(function(){return[{block:"suggest2",elem:"a11y",content:BEM.I18N("suggest2-item","quick-answer")+": "},this.ctx.content?{html:this.xmlEscape(this.ctx.content)}:""]})),s("suggest2").elem("a11y").tag()("span"),s("suggest2-item").elem("bullet")(h()("span"),u()({"aria-hidden":!0})),s("suggest2-item").mod("type","nav").elem("fact").content()(function(){return this.xmlEscape(this.ctx.content)}),s("suggest2-item").mod("interact","link")(_()(function(){return{elem:"link",url:this.ctx.url,target:this.ctx.target||"_blank",content:this.ctx.content}}),t(function(){return"nav"===this.mods.type||"icon"===this.mods.type}).elem("text").mix()({elemMods:{type:"url"}})),s("suggest2-item").elem("link")(h()("a"),u()(function(){return{href:this.ctx.url,target:this.ctx.target}})),s("suggest2-item").elem("icon")(l()(function(){var t=BEM.blocks&&BEM.blocks["suggest2-detect"]&&BEM.blocks["suggest2-detect"],e=t&&t.isSupportInlineSVG()?"svg":"png";this.ctx.autoType&&(this.ctx[e]="//yastatic.net/suggest-flag-icons/icon."+this.ctx.autoType+e);var i=this.ctx.png&&this.ctx.svg?this.ctx[e]:this.ctx.svg||this.ctx.png;return i&&(this.ctx.attrs=this.extend(Object(this.ctx.attrs),{style:'background-image:url("'+i+'");'+(Object(this.ctx.attrs).style||"")})),E()}),h()("span")),s("suggest2-item").elem("icon").match(function(){return this.elemMods.traffic}).def()(function(){return E({"ctx.autoType":"traffic."+this.elemMods.traffic+"."})}),s("suggest2-item").elem("icon").match(function(){return this.elemMods.weather}).def()(function(){var t=this.elemMods.weather.replace("-","minus-").replace("+","plus-").replace(/_/g,"-");return E({"ctx.autoType":"weather."+t+".","elemMods.weather":t})}),s("suggest2-item")(o("thumb")(t(function(){return!this.ctx.content})(_()(function(){return[{elem:"thumb-badge",attrs:{style:"background:"+(this.ctx.badgeColor||"#04b;color:#fff;")},content:this.ctx.badge}]}),u()(function(){return{style:(this.ctx.color?"background-color:"+this.ctx.color+";":"")+(this.ctx.src?"background-image:url("+this.ctx.src+");":"")}}),l()(function(){return E({"elemMods.badge":Boolean(this.ctx.badge)})})))),s("suggest2-item").elem("img").def()(function(){var t=this.ctx.attrs||{};return this.ctx.src&&(t.style="background-image: url('"+this.ctx.src+"');"+(t.style||"")),E({"ctx.attrs":t})}),s("suggest2-item").elem("text").elemMod("type","title-url").tag()("div"),s("suggest2-item").elem("text").elemMod("type","green-url").tag()("div"),s("widget").elem("control-icon")(h()(function(){return this.ctx.href?"a":"span"}),u()(function(){var t=this.ctx.attrs||{};return this.ctx.href?t.href=this.ctx.href:(t.role="button",t.tabindex="0"),t}),_()(function(){return{cls:"b-ico widget__icon_"+this.ctx.icon}})),s("button2").mod("type","submit").attrs()(function(){return this.extend(E(),{type:"submit"})}),s("icon")(h()("span"),u()(function(){var t=this.ctx,e=void 0!==t.url,i=void 0!==Object(t.attrs).style,n=(i?t.attrs.style:"")+(e?";background-image:url('"+t.url+"');":"");return i&&(t.attrs.style=n),{style:n||void 0}})),s("icon").match(function(){return void 0!==this.mods.glyph}).def()(function(){return this.mods["has-glyph"]="yes",E()}),s("suggest2").elem("title").content()(function(){return[{elem:"a11y",content:BEM.I18N("suggest2","group")+": "},this.ctx.content]}),s("button")(l()(function(){this.mods;return E()}),h()("button"),t(function(){return this.ctx.url}).tag()("a"),m()(!0),u()(t(function(){return!0})(function(){var t=this.ctx,e={};return e.tabindex=t.tabindex,e}),t(function(){return this.ctx.url})(function(){var t=this.ctx,e=t.attrs,i=E(),n={href:t.url,target:t.target},s=void 0!==Object(e).rel?String(e.rel):"";return"_blank"===n.target&&(n.rel="noopener",s&&-1===s.indexOf("noopener")&&(e.rel=s+" noopener")),this.extend(i,n)}),t(function(){return!this.ctx.url})(function(){var t=this.ctx,e=E(),i={type:t.type||"button",autocomplete:"off",name:t.name,value:t.value};return this.extend(e,i)})),_()(function(){return{elem:"text",tag:"span",content:this.ctx.content}})),s("button").mod("disabled","yes").attrs()(function(){var t={};return this.ctx.url?t["aria-disabled"]="true":t.disabled=!0,this.extend(E(),t)}),s("spin2")(l()(function(){return void 0===this.mods.view&&(this.mods.view="default"),void 0===this.mods.tone&&(this.mods.tone="default"),E()})),s("popup").mod("has-close","yes").content()(function(){return[E(),{elem:"close"}]}),s("popup").elem("close").tag()("i"),s("b-wdgt-preferences")(o("data")(h()("form"),_()(function(){return{elem:"table",content:this.ctx.list.filter(function(t){return t.elem="pref",t.name})}})),o("pref").content()(function(){return[this.ctx.name,this.ctx.value,this.ctx.label,this.ctx.type].join(", ")}),o("pref").match(function(){return"hidden"===this.ctx.type})(h()("input"),u()(function(){return{type:"hidden",name:this.ctx.name,value:this.ctx.value}})),o("pref").match(function(){return"bool"===this.ctx.type||"boolean"===this.ctx.type}).content()(function(){return{elem:"pref-col",content:{block:"checkbox",mods:{size:"s",theme:"normal",checked:"true"===this.ctx.value?"yes":""},text:this.ctx.label,checkboxAttrs:{value:1,name:this.ctx.name}}}}),o("pref").match(function(){return"list"===this.ctx.type}).content()(function(){return[{elem:"pref-col",elemMods:{labeled:"yes"},content:[{tag:"span",elem:"label",content:this.ctx.label},{block:"select",name:this.ctx.name,mods:{theme:"normal",size:"s",layout:"fixed",width:200},js:{live:!0,elemPopupMods:{width:200}},content:[{block:"button",content:""},{elem:"control",content:this.ctx.options.map(function(t){return{elem:"option",attrs:{value:t.value,selected:t.value==(this.ctx.value||this.ctx.default)?"selected":void 0},content:t.label}},this)}]}]}]}),o("pref").match(function(){return"comment"===this.ctx.type}).content()(function(){return[{elem:"comment-cell",content:{elem:"comment-title",tag:"span",content:this.ctx.value}}]}),o("pref").match(function(){return"radio-button"===this.ctx.type}).content()(function(){return{elem:"pref-col",elemMods:{labeled:"yes"},content:[{tag:"span",elem:"label",content:this.ctx.label},{block:"radio-button",mods:{size:"xs",view:"classic",theme:"normal"},content:this.ctx.options.map(function(t){return{elem:"radio",tag:"label",content:[{elem:"control",tag:"input",attrs:{value:t.value,checked:t.value==(this.ctx.value||this.ctx.default)?"checked":void 0,type:"radio",name:this.ctx.name}},t.label]}},this)}]}}),o("pref").match(function(){return"multi"===this.ctx.type}).content()(function(){return{elem:"pref-col",content:[{elem:"label",tag:"span",content:this.ctx.label},{block:"multiselect",name:this.ctx.name,mods:{theme:"normal",size:"s"},selected:this.ctx.value,groups:this.ctx.groups,options:this.ctx.options}]}}),o("pref").match(function(){return"geoselect"===this.ctx.type||"geo"===this.ctx.type||"text"===this.ctx.type}).content()(function(){return[{tag:"table",elem:"pref-table",content:[{tag:"td",elem:"pref-td",elemMods:{labeled:"yes"},content:{tag:"span",elem:"label",content:this.ctx.label}},{tag:"td",elem:"pref-td",content:{block:"input",mods:{size:"s",suggest:"yes"},js:{dataprovider:{name:"dataprovider-geo",url:"https://suggest-maps."+document.domain.replace(/[\w\d-.]+\.(yandex\.[.\w]+)/,"$1")+"/suggest-geo"},popupMods:{fade:"yes"}},content:[{elem:"control",attrs:{value:this.ctx.geoname}},{elem:"geo",tag:"input",attrs:{type:"hidden",name:this.ctx.name,value:this.ctx.value||this.ctx.default}}]}}]}]}),o("pref").match(function(){return"text"===this.ctx.type}).content()(function(){return[{tag:"table",elem:"pref-table",content:[{tag:"td",elem:"pref-td",elemMods:{labeled:"yes"},content:{tag:"span",elem:"label",content:this.ctx.label}},{tag:"td",elem:"pref-td",content:{block:"input",mods:{size:"s"},content:{elem:"control",attrs:{name:this.ctx.name,value:this.ctx.value||this.ctx.default}}}}]}]})),s("popup").mod("wrapped","yes").content()(function(){return[E(),{elem:"wrapper",elemMods:this.ctx.wrapperMods}]}),s("popup").mod("behaviour","scrollable").def()(function(){return this.mods.wrapped="yes",this.mods["body-scroll"]="no",this.ctx.wrapperMods={behaviour:"scrollable"},E()}),s("select")(l()(function(){var t=this.ctx,e=t.id||this.generateId();return E({_controlAttrs:{id:e,name:t.name},_formSelect:{block:this.block,mods:this.mods,tabindex:t.tabindex}})}),m()(function(){return this.extend({live:!1},this.ctx.js)}),h()("span"),o("option").tag()("option"),o("option-group").tag()("optgroup"),o("text").tag()("span")),s("select").def()(function(){var t=this.ctx;if((M("js")||{}).live){var e=t.content.filter(function(t){return"control"===t.elem})[0].content;if(e.length){var i=function(t){for(var e,n,s=0;s<t.length&&("option"===(e=t[s]).elem&&Object(e.attrs).selected?n=e:"option-group"===e.elem&&(n=i(e.content)),!n);s++);return n},n=i(e);return n||"option-group"===(n=e[0]).elem&&(n=n.content[0]),E({_initValue:n.attrs.value,_initText:n.content})}}return E()}),s("select").elem("item").attrs()(function(){return{id:this.generateId()}}),s("select").elem("item").match(function(){return this.elemMods.label}).attrs()(function(){var t=E()||{};return this._labelId&&(t.id=this._labelId),t["aria-hidden"]="true",t}),s("button").match(function(){return this._formSelect})(u()(function(){var t=E()||{};t.role="listbox",t.type="button",t["aria-haspopup"]="true",t["aria-expanded"]="false";var e=this._formSelect.tabindex;return void 0!==e&&(t.tabindex=e),t}),l()(function(){var t=this.ctx,e=this._formSelect.mods,i=this.mods;return i.arrow="down",e.theme&&(i.theme=e.theme),e.size&&(i.size=e.size),e.disabled&&(i.disabled="yes"),this._initText&&(t.content=this._initText),E({"ctx._theme":!0})}),f()(function(){return[{block:this._formSelect.block,elem:"button"}]})),s("select").elem("group")(u()(function(){return{role:"group","aria-labelledby":this._labelId}}),f()(function(){return{elemMods:{position:this.isFirst()?this.isLast()?"both":"first":this.isLast()?"last":"middle"}}}),l()(function(){return E({_labelId:this.generateId()})})),s("select").elem("control")(t(function(){return this._initValue}).def()(function(){var t=this.ctx;return t.attrs=this.extend(t.attrs,{value:this._initValue}),E()}),h()("select"),u()(function(){var t={};return["id","name","tabindex"].forEach(function(e){this._controlAttrs[e]&&(t[e]=this._controlAttrs[e])}.bind(this)),t.disabled=Boolean(this.mods.disabled),t.tabindex=-1,t["aria-hidden"]="true",this.ctx.controlAttrs||t})),s("checkbox")(l()(function(){var t=this.ctx;return t.controlAttrs=this.extend({id:this.generateId(),checked:Boolean(this.mods.checked),disabled:Boolean(this.mods.disabled),tabindex:t.tabindex,name:t.name,value:t.value},void 0===t.controlAttrs?t.checkboxAttrs:t.controlAttrs),t.controlAttrs["aria-labelledby"]="label"+t.controlAttrs.id,void 0===this.mods.view&&(this.mods.view="classic"),void 0===this.mods.lines&&(this.mods.lines="multi"),E({_labelAttrs:{id:t.controlAttrs["aria-labelledby"],for:t.controlAttrs.id}})}),h()("span"),m()(function(){return this.extend({live:!1},this.ctx.js)}),t(function(){return void 0===this.ctx.content}).content()(function(){return[this.util.merge({elem:"box",tag:"span",content:[this.util.merge({elem:"control",attrs:this.ctx.controlAttrs},this.ctx.control),{elem:"tick",tag:"i"}]},this.ctx.box),void 0!==this.ctx.text&&this.util.merge({elem:"label"},this.isSimple(this.ctx.text)?{content:{html:this.xmlEscape(this.ctx.text)}}:this.ctx.text)].filter(Boolean)})),s("checkbox").elem("control")(h()("input"),u()(function(){return{type:"checkbox",autocomplete:"off"}})),s("checkbox").elem("label")(h()("label"),u()(function(){return this.extend({"aria-hidden":"true"},this._labelAttrs)})),s("radiobox")(l()(function(){var t=this.ctx,e=this.mods;return void 0===this.mods.view&&(this.mods.view="classic"),E({_disabled:e.disabled,_name:t.name,_value:t.value})}),h()("span"),m()(function(){return this.extend({live:!1},this.ctx.js)})),s("radiobox").elem("radio")(l()(function(){var t=this.ctx,e=this.elemMods,i=this.extend({id:this.generateId(),type:"radio",name:this._name,value:t.value},t.controlAttrs),n=void 0!==i.value&&i.value===this._value;return e.disabled||(e.disabled=this._disabled),e.checked||(e.checked=n?"yes":""),e.disabled&&(i.disabled=!0,i.tabindex=-1),e.checked&&(i.checked=!0),E({_controlAttrs:i})}),h()("label"),u()(function(){return{for:this._controlAttrs.id}}),_()(function(){return[{elem:"box",tag:"span",content:{elem:"control"}},{elem:"text",tag:"span",content:E()}]})),s("radiobox").elem("control")(h()("input"),u()(function(){return this._controlAttrs})),s("radio-button")(l()(function(){var t=this.ctx,e=this.mods;return void 0===this.mods.view&&(this.mods.view="classic"),E({_radioButton:{name:t.name,value:t.value,disabled:Boolean(e.disabled)}})}),h()("span"),m()(function(){return this.extend({live:!1},this.ctx.js)}),_()(function(){var t=this.ctx.content;return Array.isArray(t)?t.filter(function(t){return!this.isSimple(t)&&t},this):t})),s("radio-button").elem("radio")(l()(function(){var t=this.elemMods,e=this._radioButton,i=e.disabled,n=this.extend({},this.ctx.controlAttrs);return void 0!==n.value&&n.value===e.value&&(t.checked="yes"),i&&(t.disabled="yes"),"default"===this.mods.view||t.side||(t.side=["","right","left","both"][2*this.isFirst()+this.isLast()]),n.checked=Boolean(t.checked),n.disabled=Boolean(t.disabled),n.id||(n.id=this.generateId()),E({_controlAttrs:n})}),h()("label"),u()(function(){return{for:this._controlAttrs.id}}),_()(function(){return[{elem:"control"},{elem:"text",tag:"span",content:this.ctx.content}]})),s("radio-button").elem("control")(h()("input"),u()(function(){var t=this._controlAttrs;return t.checked=Boolean(t.checked),t.disabled=Boolean(t.disabled),t.disabled&&(t.tabindex="-1"),t.type="radio",t.name=this._radioButton.name,t})),s("b-autocomplete-item")(h()("li"),t(function(){return this.ctx.search_cgi&&Array.isArray(this.ctx.search_cgi)}).js()(function(){return{cgi:this.ctx.search_cgi}}),m()(!0),f()(function(){return[{mods:{pers:this.ctx.pers?"yes":""}}]}),_()(function(){var t=this.ctx.data;return(0,BEM.blocks["b-autocomplete-item"].highlight)(this.xmlEscape(Array.isArray(t)?t[1]:t),this.ctx.hl)})),s("b-autocomplete-item").match(function(){return this.mods&&"geo"===this.mods.type})(u()(function(){return{"data-id":this.ctx.geoid}}),_()(function(){var t=this.ctx,e=t.subtitle,i=BEM.blocks["i-common__string"];return[{tag:"span",elem:"reg",content:i.escapeHTML(t.title)},!!e&&{tag:"span",elem:"details",mix:!!e&&{elem:"full"},content:" ("+i.escapeHTML(e)+")"}]})),s("multiselect")(m()(!0),n()(function(){var t={};this.ctx.selected.split(",").forEach(function(e){t[e]=!0}),this.__selected=t;var e=this.ctx.groups||[{options:this.ctx.options}];return this.ctx.content=e.map(function(t){return t.elem="group",t}).concat({elem:"selected",name:this.ctx.name,selected:this.ctx.selected}),this.ctx}),o("group").content()(function(){var t=this.ctx.label?{elem:"label",content:this.ctx.label}:"",e=[],i=Math.ceil(this.ctx.options.length/3);return this.ctx.options.forEach(function(t,n){var s=Math.floor(n/i);e[s]||(e[s]=[]),t.elem="item",t.size=this.mods.size,t.theme=this.mods.theme,e[s].push(t)},this),[t,{elem:"items",cls:home.cls.full("row"),content:e.map(function(t){return{elem:"column",cls:home.cls.full("col"),content:t}})}]}),o("item").content()(function(){return{block:"checkbox",checkboxAttrs:{value:this.ctx.value},mods:{size:this.mods.size,theme:this.mods.theme,checked:this.__selected[this.ctx.value]?"yes":""},text:this.ctx.label}}),o("selected")(h()("input"),u()(function(){return{type:"hidden",name:this.ctx.name,value:this.ctx.selected}}))),s("b-autocomplete-item").mod("type","address")(m()(function(){return{addressLine:this.ctx.name,addressLineShort:this.ctx.name_short,coordinates:[this.ctx.lat,this.ctx.lon]}}),_()(function(){var t=this.ctx.data[1],e=BEM.blocks,i=e["i-common__string"].escapeHTML(t.name);return e["b-autocomplete-item"].highlight(i,t.hl)})),b(function(t,i){(t.BEMContext||i.BEMContext).prototype.require=function(t){return e[t]}})}),n.exportApply(i),i}var i=!0;"object"==typeof module&&"object"==typeof module.exports&&(exports.BEMHTML=e({}),i=!1),"object"==typeof modules&&(modules.define("BEMHTML",[],function(t){t(e({}))}),i=!1),i&&(BEMHTML=e({}),t.BEMHTML=BEMHTML)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),home.lang={a11y:{collapse:"",expand:""},afisha:{all_films_today:"  ",buy:" ",cards:" ",cinema:"",cinemaNoSessions:"    ",cinemaSeeNextDay:"  ",cityDayText:"  &nbsp;",cityDayTitle:"%s  &nbsp;<b>%s</b>",cityday:"  &nbsp;",citydayShort:" ",citydayToday:"&#32;",concerts:"",defaultTab:"",defaultTabLong:" ",desc:"    ",desc_inserts:"    ",elki:"",favoritePlace:" ",from:" %s",geolocationFail:"  ",geolocationInaccuracy:"  ",multiple_locations:"    ",myCinemas:" ",nearestCinemas:"",nearestCinemasFull:" ",newyear:" ",noCinemas:"   ",popularFilms:"<br>",premiere:"",premiere_in:" %s",reload:"",schedule:"",scheduleError:"   ",scheduleInProgress:" ",scheduleTryAgain:"  ",searchInProgress:"   ",showObjects:"  ",showObjectsShort:" ",since_date:" %s",sorry:",     ",theatres:"",title:""},catalog:{returnToCatalog:"  "},desktopNotifications:{menu:{ban:" ",close:"",collapse:"",expand:"",setup:"",toggle:""}},direct:{bought_already:" ",not_interest:" ",spam:""},domik:{active:""},head:{region:" "},informationsMessages:{beforeReset:" ,       ?     .",cannotSaveSettings:",     .  .",maxCount:"   ",settingsNotSaved:"      ."},media:{broadcast:{yac2018:{title:"  "}},direct:{title:"."},zen:{desc:" &nbsp;  ",desc_ice:" &nbsp;",dislike:" ",like:""}},months_short_genetive:{apr:"",aug:"",dec:"",feb:"",jan:"",jul:"",jun:"",mar:"",may:"",nov:"",oct:"",sep:""},plus:{"subscription-expires-days":["O %d  ","O %d  ","O %d  "],"subscription-expires-today":"  "},promo:{"themes-promo__close":" "},pushes:{notice:{error:{cancel:"",text:",     .",title:"-   ",web_error:"   .  "},prompt:{cancel:", ",text:"     ,    .<br>     .      .",title:"  "},wait:{title:" <b></b><br>  ."}},sup_button:{subscribe:"",unsubscribe:""}},rates:{newalt:{ceni:"%s:  ",index:"%s:  ",korz:" ",kurs:"%s:  "}},securityMessages:{noYandexWidgetAddedA:"       ."},spok_yes:{month_accus:{1:"",10:"",11:"",12:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""}},stream:{card:{category:{anim_film:"",anim_series:"",film:"",series:""}},inserts:{categ_anim_film:"",categ_anim_series:"",categ_film:"",categ_mixed:"",categ_mixed_video:"",categ_series:"","chfdqvrfr19nsvhfrf9wsurftxifbw9yzge=":""}},"time-alert":{date_format_long:"%day %month %year ",date_format_short:"%day %month"},traffic:{personal:{hour_abbr:"&nbsp;&nbsp;",minutes_abbr:"&nbsp;"}},"voice-search":{popup:{"chrome-permission":{subtitle:"  ,    %icon%   "},connectionproblem:{subtitle:" ",title:"   "},noaccess:{subtitle:"   ,    ",title:"    "},unknownerror:{title:" "}}},widgetbaloon:{cancel:"",keep:""},widgetcontrol:{confirm_delete_all:"     ?",delete:"",delete_all:" ",hide:"",setup:""}},function(){!function(){"use strict";home.parseRules={l10n:function(t,e,i){return e.l10n||home.error("Can't proccess 'l10n:"+i+"', check context of template"),e.l10n&&e.l10n(i)},baseViews:function(t,e,i){return e.baseViews(i,t)},bem:function(t,e,i){i=i.split("."),t=t||{};var n=i.pop(),s=i.pop(),o=i.pop();switch(n){case"class":var r=home.getBEMClassname(s,(o?t[o]:t)||{});return e&&e.cls&&e.cls.contains(s)?e.cls.full(r):r;case"js":return home.getBEMParams(t[s||"js"]||{});case"attrs":return home.getAttributes(t[s||"attrs"])}},cls:function(t,e,i){return e&&e.cls?e.cls.full(i):i}}}();var t,e=home.view?Object.create(home.view.templates):{},i={l10n:home.l10n,stat:{logShow:function(t,e){e&&(t+=n(e)),home.stat.logPath("show",t)},getAttr:function(t,e,i){return t?((i=i||{}).customParams&&(t+=n(i.customParams)),' data-statlog="'+t+'"'+(!1!==i.isRedirect?"":' data-statlog-redir="0"')):""},getAdaptiveCounter:function(t,e){return t?' data-statlog="'+t+'"'+(e?' data-statlog-redir="0"':"")+' data-statlog-autoshow="1"':""},getClientCounter:function(t,e,i){return(t=i?t+n(i):t)?' data-statlog="'+t+'"'+(e?' data-statlog-redir="0"':""):""}},settingsJs:{add:function(t,e,i){home.export[i]||(home.export[i]={}),home.export[i][t]=e},has:function(t,e){return home.getData&&home.getData(e+"."+t)}},csp:(t={stub:!0},["allowDefault","allowStyle","allowPlugin","allowObject","allowMedia","allowImg","allowFont","allowConnect","allowScript","allowChild","allowForm"].forEach(function(e){t[e]=function(t){if(home.error&&(!home.getData||!0===home.getData("csp.report"))){var i=new Error("req.csp."+e+" was called on clientside");i.meta={url:t},i.block="home.views",home.error.logError(i)}}}),t)};function n(t){var e=[];if(Array.isArray(t))e=t;else for(var i in t)t.hasOwnProperty(i)&&void 0!==t[i]&&e.push(i+"="+encodeURIComponent(t[i]));return e.length?"("+e.join(";")+")":""}function s(t,i){if(i){var n=e[t];i instanceof Function?e[t]=i:e[t]=home.templateGenerator(i,t),n&&(e[t].base=n)}}s.cached=function(t,i){i&&(s(t,i),e[t].cached=!0)},home.view=function(t,n,s){var o,r=s||n||{};for(o in i)r.hasOwnProperty(o)||(r[o]=i[o]);var a=window.home&&home.getData&&home.getData("common.req")||{};for(o in a)a.hasOwnProperty(o)&&!r.hasOwnProperty(o)&&(r[o]=a[o]);return function t(i,n){var s=i instanceof Function?i:e[i],o="";return s&&(o=s.cached?s(r,t):s(n,r,t)),o}(t,n)},home.view.templates=e,home.view.define=s,s("consistency-popup__html",function(t,e,i){var n,s;return"<div "+(t.className!==s?t.className:e.className!==s?e.className:(n=i("className",t))!==s?n:"")+' style="position:fixed;z-index:'+(t.zIndex!==s?t.zIndex:e.zIndex!==s?e.zIndex:(n=i("zIndex",t))!==s?n:"")+';bottom:16px;right:16px;width:340px;color:#FFF;background-color:#E26A68;padding:16px;"><div style="font-size:120%;margin-top:5px;margin-bottom:10px;">'+(t.title!==s?t.title:e.title!==s?e.title:(n=i("title",t))!==s?n:"")+'</div><div style="line-height: 18px;">'+(t.text!==s?t.text:e.text!==s?e.text:(n=i("text",t))!==s?n:"")+'</div><div style="margin-top: 30px;text-align: right"><a class="button_theme_cpopup" style="margin-right: 16px;" role="button" href="'+(t.yesLink!==s?t.yesLink:e.yesLink!==s?e.yesLink:(n=i("yesLink",t))!==s?n:"")+'"><div class="button_theme_cpopup__text b-inline" style="background-color: #EB9796;">'+(t.yesButton!==s?t.yesButton:e.yesButton!==s?e.yesButton:(n=i("yesButton",t))!==s?n:"")+'</div></a><a class="button_theme_cpopup" role="button" href="'+(t.noLink!==s?t.noLink:e.noLink!==s?e.noLink:(n=i("noLink",t))!==s?n:"")+'"><div class="button_theme_cpopup__text b-inline">'+(t.noButton!==s?t.noButton:e.noButton!==s?e.noButton:(n=i("noButton",t))!==s?n:"")+'</div></a></div><div class="button_theme_cpopup__close"><div class="button_theme_cpopup__close_img"></div></div></div>'}),s("promo-curtain__message",function(t,e,i){var n,s;return'<div class="promo-curtain__message" style="top:'+((n=t.offset)&&(n=n.top),n!==s?n:"")+'px"><div class="promo-curtain__arrow" style="left:'+((n=t.offset)&&(n=n.left),n!==s?n:"")+'px"></div><div class="promo-curtain__header">'+((n=t.langs)&&(n=n.header),n!==s?n:"")+'</div><div class="promo-curtain__line">'+((n=t.langs)&&(n=n.line1),n!==s?n:"")+'</div><div class="promo-curtain__line">'+((n=t.langs)&&(n=n.line2),n!==s?n:"")+"</div></div>"}),s("promo-curtain__layout",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"promo-curtain.class")+'"><div class="promo-curtain__agreement-text">'+((n=t.langs)&&(n=n.agreement),void 0!==n?n:"")+"</div></div>"}),s("media-event-promo__layout",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"media-event-promo.class")+'" title="'+(t.title!==n?t.title:"")+'"><div class="media-event-promo__wrapper"><div class="media-event-promo__inner"><img class="media-event-promo__icon" src="'+(t.logo!==n?t.logo:"")+'" alt="'+(t.title!==n?t.title:"")+'" width="'+(t.width!==n?t.width:"")+'" height="'+(t.height!==n?t.height:"")+'"></div></div></div>'}),s("yac-promo__layout",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"yac-promo.class")+'" title="'+(void 0!==t.title?t.title:"")+'"><div class="yac-promo__inner"></div></div>'}),s("sticky-header",function(t,e,i){var n,s=t.mode,o=i("avatar",{mix:"sticky-header__user-icon",avatarId:t.avatar_id,mods:{size:"m"}});return n="logged"===s||"nomailbox"===s?i("sticky-header__logged",{favorites:i("favorites",{from:"sticky_header"}),notifier:i("notifier__layout",{from:t.notifierParams.from,js:t.notifierParams}),register:"nomailbox"===s&&t.registerLink?i("button2",{mods:{view:"default",tone:"default",size:"n"},content:" ",url:t.registerLink,mix:"sticky-header__button-between",stat:e.stat.getAttr("sticky_header.register")}):"",link:i("home-link",{href:t.passportLink,content:i("username_sliced",{mod:"sticky-header__user-name"+("nomailbox"===s?" sticky-header__user-name_adaptive_wide":""),UserName:t.UserName})+o,mix:"usermenu-link usermenu-link__control i-bem sticky-header__user",attrs:{"data-bem":home.getBEMParams({"usermenu-link":{popup:{mainOffset:-48,secondaryOffset:-5}}})},stat:e.stat.getAttr("sticky_header.mail.toggle")})}):"stale"===s?i("sticky-header__stale",{button:i("button2",{mods:{view:"default",tone:"default",size:"n"},content:"  ",url:t.enterLink,mix:"sticky-header__button-between",stat:e.stat.getAttr("sticky_header.mail")}),username:i("username_sliced",{mod:"sticky-header__user-name sticky-header__user-name_adaptive_wide",UserName:t.UserName}),icon:o}):i("sticky-header__logout",{register:i("home-link",{mods:{gray:"yes"},content:" ",href:t.registerLink,mix:"sticky-header__register-link",stat:e.stat.getAttr("sticky_header.mail.register")}),enter:i("button2",{mods:{view:"default",tone:"default",size:"n"},content:"  ",url:t.enterLink,stat:e.stat.getAttr("sticky_header.mail.login")})}),i("sticky-header__layout",{mix:t.mix,content:n})}),s("sticky-header__logout",function(t,e,i){var n;return(t.register!==n?t.register:"")+(t.enter!==n?t.enter:"")}),s("sticky-header__stale",function(t,e,i){var n;return(t.button!==n?t.button:"")+(t.username!==n?t.username:"")+(t.icon!==n?t.icon:"")}),s("sticky-header__logged",function(t,e,i){var n;return'<div class="sticky-header__icons">'+(t.favorites!==n?t.favorites:"")+(t.notifier!==n?t.notifier:"")+"</div>"+(t.register!==n?t.register:"")+(t.link!==n?t.link:"")}),s("sticky-header__layout",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"sticky-header.class")+'">'+(void 0!==t.content?t.content:"")+"</div>"}),s("favorites",function(t,e,i){var n=(t&&t.from?t.from:"head")+".favorites",s="https://yandex."+e.MordaZone+"/collections",o=e.skin&&e.skin.widgetStyle&&e.skin.widgetStyle.top&&"dark"===e.skin.widgetStyle.top.bg;return i("home-link",{mix:"favorites",href:s,stat:e.stat.getAttr(n),content:i("div",{mix:home.getBEMClassname("favorites__icon",{mods:{dark:o?"yes":""}})}),attrs:{tabindex:"0","data-bem":home.getBEMParams({favorites:{}}),title:""}})}),s("span",function(t,e,i){var n;return'<span class="'+(t.mod!==n?t.mod:"")+'"'+home.parseRules.bem(t,e,"attrs")+">"+(t.content!==n?t.content:"")+"</span>"}),s("div",function(t,e,i){var n,s;return'<div class="'+(t.mix!==s?t.mix:e.mix!==s?e.mix:(n=i("mix",t))!==s?n:"")+'"'+home.parseRules.bem(t,e,"attrs")+">"+(t.content!==s?t.content:e.content!==s?e.content:(n=i("content",t))!==s?n:"")+"</div>"}),s("notifier__spin",function(t,e,i){return'<div class="notifier__spin '+home.parseRules.bem(t,e,"spin2.class")+'"></div>'}),s("notifier__content",function(t,e,i){return'<div class="notifier__content">'+(void 0!==t.progress?t.progress:"")+"</div>"}),s("notifier__box",function(t,e,i){var n;return'<div class="notifier__box">'+(t.icon!==n?t.icon:"")+(t.text!==n?t.text:"")+'<div class="notifier__ticker"></div>'+(t.popup!==n?t.popup:"")+"</div>"}),s("notifier__layout-html",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"notifier.class")+' i-bem" title="" aria-haspopup="true" aria-expanded="false" data-bem="'+home.parseRules.bem(t,e,"js")+'" '+home.parseRules.bem(t,e,"attrs")+(t.stat!==n?t.stat:"")+">"+(t.content!==n?t.content:"")+"</div>"}),s("notifier__layout",function(t,e,i){return t.mods={size:"l"},i("notifier__layout-html",{content:i("notifier__box",{icon:i("notifier__icon"),popup:i("popup2",{content:i("notifier__content",{progress:i("notifier__spin",{mods:{position:"center",size:"m",view:"default",tone:"default"}})}),directions:["bottom-right","bottom-center"],zIndexGroupLevel:9,mods:{autoclosable:"yes",target:"anchor",tone:"default",view:"default",theme:"normal","alt-shadow":"yes"},hasTail:!0,mix:"notifier__popup"})}),js:{notifier:t.js},mods:t.mods,stat:e.stat.getAttr((t.from||"undefined")+".notifier"),attrs:{tabindex:"0"}})}),s("notifier__icon",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"notifier__icon.class")+'"><svg xmlns="http://www.w3.org/2000/svg" width="36" height="36"><g class="notifier__bell-icon" fill="#000"><path class="notifier__bell" d="M19.96 10A5.98 5.98 0 0 0 24 17.16V21l2 1v2H11v-2l2-1v-4c.15-2.25 1.08-4.71 4-5.5V10h2.96z"/><path class="notifier__bell-nook" d="M24 18.01A7 7 0 0 1 19.04 10H20v1.5c3 .8 3.86 3.25 4 5.5v1z"/><path d="M18.5 26c.99 0 1.5-.51 1.5-1.5V23h-3v1.5c0 .99.51 1.5 1.5 1.5z"/></g></svg></div>'}),s("popup2",function(t,e,i){var n=t.mods||{},s=t.content||"";return void 0===n.view&&(n.view="classic"),t.hasTail&&(s=i("popup2__tail")+s),i("popup2__layout",{mix:t.mix,mods:n,js:home.deepExtend({popup2:{mainOffset:t.mainOffset,secondaryOffset:t.secondaryOffset,viewportOffset:t.viewportOffset,tailOffset:t.tailOffset,tailSize:t.tailSize,directions:t.directions,zIndexGroupLevel:t.zIndexGroupLevel}},t.jsMix||{}),content:s})}),s("popup2__tail",function(t,e,i){return'<div class="popup2__tail"></div>'}),s("popup2__layout",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"popup2.class")+' i-bem" data-bem="'+home.parseRules.bem(t,e,"js")+'">'+(void 0!==t.content?t.content:"")+"</div>"}),s("username_sliced",function(t,e,i){var n=t.UserName||e.UserName,s=t.maxLength||20;return i("username__layout",{f:home.htmlFilter(n.f),l:home.htmlFilter(home.cleverString.cutEndOfString(n.l,s)),mod:t.mod?" "+t.mod:""})}),s("username__layout",function(t,e,i){var n,s;return'<span class="username'+(t.mod!==s?t.mod:e.mod!==s?e.mod:(n=i("mod",t))!==s?n:"")+'"><span class="username__first-letter">'+(t.f!==s?t.f:e.f!==s?e.f:(n=i("f",t))!==s?n:"")+"</span>"+(t.l!==s?t.l:e.l!==s?e.l:(n=i("l",t))!==s?n:"")+"</span>"}),s("avatar__href",function(t,e){var i="https://avatars.mds.yandex.net/get-yapic/"+(t.avatar_id||"0/0-0")+"/"+(t.avatar_size||"islands-middle");return e.csp&&!e.csp.stub&&e.csp.allowImg(i),i}),s("avatar__image",function(t,e,i){var n,s,o=t.avatarSizes||(t.mods?{s:{default:"islands-small","2x":"islands-retina-small"},m:{default:"islands-34","2x":"islands-68"},l:{default:"islands-middle","2x":"islands-retina-middle"}}[t.mods.size]:null)||{},r="avatar__image "+(t.imageMix||""),a=i("retina-scale")>=1.25;return t.avatarUrl?n=t.avatarUrl:(n=i("avatar__href",{avatar_id:t.avatarId,avatar_size:o.default}),o["2x"]&&(s=i("avatar__href",{avatar_id:t.avatarId,avatar_size:o["2x"]}))),i("span",{mod:"avatar__image-wrapper",content:i("span",{mod:r,attrs:{style:"background-image:url("+(a&&s||n)+");"+(s?"background-image:-webkit-image-set(url("+n+") 1x, url("+s+") 1.25x)":"")}})})}),s("avatar",function(t,e,i){var n=t.mix||"",s=t.attrs||{};return i("home-link",{mix:n+=" "+home.getBEMClassname("avatar",{mods:t.mods||{}}),attrs:s,href:t.href,stat:t.stat,content:i("avatar__image",t)})}),s("home-link",function(t,e,i){var n="a",s=t.attrs||{},o=t.mods||{},r=t.inlineIcon||"";return t.href?s.href=t.href:n="span",t.title&&(s.title=t.title),t.target&&(s.target=t.target),"_blank"===s.target&&void 0===s.rel&&(s.rel="noopener"),i("home-link__tmpl",{attrs:s,tag:n,mix:t.mix,mods:o,content:t.content,stat:t.stat,icon:r})}),s("home-link__tmpl",function(t,e,i){var n;return"<"+(t.tag!==n?t.tag:"")+' class="'+home.parseRules.bem(t,e,"home-link.class")+'"'+home.parseRules.bem(t,e,"attrs")+(t.stat!==n?t.stat:"")+">"+(t.icon!==n?t.icon:"")+(t.content!==n?t.content:"")+"</"+(t.tag!==n?t.tag:"")+">"}),s.cached("retina-scale__is-big",function(t,e){return e("retina-scale")>=1.25}),s.cached("retina-scale",function(t){return"number"==typeof devicePixelRatio?devicePixelRatio:t.UserDevice&&t.UserDevice.ratio&&parseFloat(t.UserDevice.ratio.replace("_","."))||1}),s("usermenu__email",function(t){var e=home.cleverString.cutEndOfString(t.email,25);return'<div class="usermenu__user-email">'+home.htmlFilter(e)+"</div>"}),s("usermenu__user",function(t,e,i){var n=t.email&&t.mailbox,s=home.htmlFilter(home.cleverString.cutEndOfString(t.UserName.str,20)),o=home.htmlFilter(t.UserName.str),r=t.uid,a=t.avatar_id,c=t.default;return i("usermenu__user-layout",{mod:c?"":" usermenu__user_clickable_yes usermenu__item",name:s,email:n?i("usermenu__email",t):"",userIcon:i("avatar",{mix:"usermenu__user-icon usermenu__user-icon_type_"+("0/0-0"===a?"default":"custom"),avatarId:a,mods:{size:"l"}}),attrs:{tabindex:c?void 0:"0","data-uid":r,role:"button","aria-label":c?"":home.stringf("   %s",o)},stat:c?"":t.changeStat,exit:c?"":i("usermenu__user-exit",{attrs:{tabindex:c?void 0:"0","data-uid":r,role:"button",title:c?"":home.stringf("    %s",o)},stat:t.default?"":t.exitStat})})}),s("usermenu",function(t,e,i){var n=t.defaultUser,s=t.otherUsers,o=[],r=t.passportHost,a="mail.login.usermenu.",c=t.retpath,l=r+"/auth?mode=add-user&retpath="+c+"&origin=home_desktop_"+e.MordaZone.replace(".","");if(t.plus&&t.plus.active){var h="",u=t.plus.subscription_expire_days;u>=0&&(h=i("span",{mod:"usermenu__plus-subtitle",content:0===u?" ":home.decline(u,["O %d ","O %d ","O %d "]).replace("%d",u)})),o.push({href:t.plus.url,stat:e.stat.getAttr(a+"plus_info"),attrs:{"aria-label":"."},content:i("span",{mod:"usermenu__plus-icon"})+i("span",{mod:"usermenu__plus-title",content:""})+h})}return o.push({href:r+"/passport?mode=passport",stat:e.stat.getAttr(a+"passport"),text:"",attrs:{"aria-label":""}}),o.push({href:"https://yandex."+e.MordaZone+"/ugcpub/cabinet",stat:e.stat.getAttr(a+"ugcpub"),text:" ",attrs:{"aria-label":" "}}),o.push({href:r+"/passport?mode=logout&yu="+t.yandexuid+"&retpath="+c,stat:e.stat.getAttr(a+"exit"),text:"",attrs:{"aria-label":""}}),i("usermenu__layout",{mods:{multi:s.length?"yes":"no"},defaultUser:i("usermenu__user",n),links:i("menu",{mods:{view:"default",tone:"default",size:"sx",type:"navigation"},items:o.map(function(t){return t.mix="usermenu__item",t})}),otherUsers:s.map(function(t,n){return t.changeStat=e.stat.getAttr(a+"change.user"+n,null,{isRedirect:!1}),t.exitStat=e.stat.getAttr(a+"exit.user"+n,null,{isRedirect:!1}),i("usermenu__user",t)}).join(""),addUser:t.allowMoreUsers?i("usermenu__user-add",{href:l,stat:e.stat.getAttr(a+"adduser"),text:"<br/>".replace("<br/>"," ")}):"",js:{usermenu:{passport:l,auth:{action:r+"/passport?mode=embeddedauth",params:{yu:t.yandexuid,retpath:t.loginStatusRetpath,action:"change_default"}}}}})}),s("usermenu__user-add",function(t,e,i){var n;return'<div class="usermenu__list-item" role="menuitem"><a class="usermenu__user usermenu__user-add usermenu__item" href="'+(t.href!==n?t.href:"")+'" aria-label="'+(t.text!==n?t.text:"")+'"'+(t.stat!==n?t.stat:"")+'><div class="usermenu__user-icon-wrapper"><div class="usermenu__user-icon usermenu__user-add-icon"></div></div><div class="usermenu__user-info"><div class="usermenu__user-add-text">'+(t.text!==n?t.text:"")+"</div></div></a></div>"}),s("usermenu__user-exit",function(t,e,i){return'<div class="usermenu__user-exit popup__link"'+home.parseRules.bem(t,e,"attrs")+(void 0!==t.stat?t.stat:"")+'><div class="usermenu__user-exit-icon"></div></div>'}),s("usermenu__user-layout",function(t,e,i){var n;return'<div class="usermenu__list-item" role="menuitem"><div class="usermenu__user '+(t.mod!==n?t.mod:"")+'"'+home.parseRules.bem(t,e,"attrs")+(t.stat!==n?t.stat:"")+'><div class="usermenu__user-icon-wrapper">'+(t.userIcon!==n?t.userIcon:"")+'</div><div class="usermenu__user-info"><div class="usermenu__user-name">'+(t.name!==n?t.name:"")+"</div>"+(t.email!==n?t.email:"")+"</div></div>"+(t.exit!==n?t.exit:"")+"</div>"}),s("usermenu__layout",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"usermenu.class")+' i-bem" data-bem="'+home.parseRules.bem(t,e,"js")+'">'+(t.defaultUser!==n?t.defaultUser:"")+(t.links!==n?t.links:"")+'<div class="usermenu__separator"></div><div class="usermenu__list">'+(t.otherUsers!==n?t.otherUsers:"")+(t.addUser!==n?t.addUser:"")+"</div></div>"}),s("menu",function(t,e,i){var n,s=t.mods||{},o=s.disabled,r=s.type,a=void 0!==t.tabindex?t.tabindex:void 0;n=void 0!==t.val?[].concat(t.val):[],void 0===s.view&&(s.view="classic"),"default"===s.view&&void 0===s.size&&(s.size="n"),-1!==["radio","radiocheck"].indexOf(r)&&(n=n.slice(0,1));var c=function(t){return[].concat(t).filter(function(t){return!1!==t&&null!==t&&void 0!==t}).map(function(t){return"string"==typeof t&&(t={text:t}),t.items?(t.content||(t.content=c(t.items).join("")),i("menu__group",t)):(t.mods=s,t.elem="item",t.elemMods||(t.elemMods={}),-1!==["check","radio","radiocheck"].indexOf(r)?t.elemMods=home.deepExtend({type:"option",checked:-1!==n.indexOf(t.val)?"yes":void 0},t.elemMods):"navigation"===r&&(t.elemMods=home.deepExtend({type:"link"},t.elemMods)),i("menu__item",t))},this)};return i("menu__layout",{mods:s,mix:t.mix,tag:"navigation"===r?"ul":"div",attrs:{tabindex:o?void 0:null===a?void 0:a,"aria-disabled":!!o&&"true","data-bem":home.getBEMParams({menu:home.deepExtend(t.js||{},{_tabindex:null!==a&&o?a:void 0})})},content:c(t.items).join("")})}),s("menu__layout",function(t,e,i){var n;return"<"+(t.tag!==n?t.tag:"")+' class="'+home.parseRules.bem(t,e,"menu.class")+' i-bem"'+home.parseRules.bem(t,e,"attrs")+">"+(t.content!==n?t.content:"")+"</"+(t.tag!==n?t.tag:"")+">"}),s("menu__item",function(t,e,i){var n=t.elemMods||{},s="link"===n.type?"menu__item-layout-link":"menu__item-layout",o="navigation"===t.mods.type&&t.href?"link":t.mods.type&&"navigation"!==t.mods.type?"option":"menuitem";return i(s,{className:home.getBEMClassname("menu__"+(t.elem||"item"),{mods:n,mix:t.mix}),js:{menu__item:home.deepExtend(t.js||{},{val:t.val})},attrs:home.deepExtend({title:t.title&&home.htmlFilter(t.title),"aria-disabled":!!n.disabled&&"true","aria-selected":!!n.checked&&"true",href:t.href||"",target:t.href?t.target:"",rel:"_blank"===t.target?"noopener":"",role:o},t.attrs||{}),tag:t.href?"a":"div",content:[t.mods&&"default"===t.mods.view&&void 0!==t.mods.type&&"navigation"!==t.mods.type&&i("icon",{mods:{glyph:"type-check"}}),t.icon&&i("menu__icon",home.deepExtend({mods:{size:t.mods.size}},t.icon)),void 0!==t.text&&i("span",{mod:"menu__text",content:home.htmlFilter(t.text)}),t.content].filter(Boolean).join(""),stat:t.stat||""})}),s("menu__item-layout-link",function(t,e,i){var n;return'<li class="menu__list-item"><'+(t.tag!==n?t.tag:"")+' class="'+(t.className!==n?t.className:"")+'" data-bem="'+home.parseRules.bem(t,e,"js")+'"'+home.parseRules.bem(t,e,"attrs")+(t.stat!==n?t.stat:"")+">"+(t.content!==n?t.content:"")+"</"+(t.tag!==n?t.tag:"")+"></li>"}),s("menu__item-layout",function(t,e,i){var n;return'<div class="'+(t.className!==n?t.className:"")+'" data-bem="'+home.parseRules.bem(t,e,"js")+'"'+home.parseRules.bem(t,e,"attrs")+(t.stat!==n?t.stat:"")+">"+(t.content!==n?t.content:"")+"</div>"}),s("b-time-banner__text",function(t){var e="";return e+='<span class="b-time-banner__text">',e+=t.text.replace("%local_date","<b>("+t.now+")</b>").replace("%current_date","<b>("+t.timestamp+")</b>")+(t.helpQuery?" "+t.helpQuery:""),e+="</span>"}),s("b-time-banner__inner",function(t,e,i){var n=i("b-time-banner__text",t);return t.helpUrl?i("link",{content:n,stat:e.stat.getAdaptiveCounter("wrong_date."+t.type+".url"),href:t.helpUrl,mod:"b-time-banner__link"}):n}),s("link",function(t,e,i){var n={};return t.mod=t.mod?["link",t.mod.trim()].join(" "):"link",t.title&&(n.title=t.title),t.target&&(n.target=t.target),t.attrs=(t.attrs||"")+home.getAttributes(n),i("link__tmpl",t)}),s("link__tmpl",function(t,e,i){var n,s;return'<a href="'+(t.href!==s?t.href:"")+'" class="'+(t.mod!==s?t.mod:"")+'"'+(t.attrs!==s?t.attrs:"")+(t.stat!==s?t.stat:"")+(t.link__target!==s?t.link__target:"")+(t.link__title!==s?t.link__title:"")+">"+(t.link__icon!==s?t.link__icon:e.link__icon!==s?e.link__icon:(n=i("link__icon",t))!==s?n:"")+(t.content!==s?t.content:"")+"</a>"}),s("datetime__date",function(t,e,i){var n,s;return'<span class="datetime__date"><span class="datetime__day">'+(t.day!==s?t.day:e.day!==s?e.day:(n=i("day",t))!==s?n:"")+' </span><span class="datetime__month">'+(t.month!==s?t.month:e.month!==s?e.month:(n=i("month",t))!==s?n:"")+', </span><span class="datetime__wday">'+(t.wday!==s?t.wday:e.wday!==s?e.wday:(n=i("wday",t))!==s?n:"")+" </span></span>"}),s("inline-stocks__head",function(t){if(!t.col2&&!t.col4)return"";for(var e=[t.col2,t.col4],i="",n=0;n<e.length;n++)e[n]&&(i+='<th class="inline-stocks__cell" colspan="2">'+e[n]+"</th>");return'<tr class="inline-stocks__head">'+i+"</tr>"}),s("inline-stocks__t-title",function(t,e,i){var n,s;switch(t.type){case"currency":n="",s="";break;case"cash":n="",s=""}return i("inline-stocks__head",{col2:n,col4:s})}),s("inline-stocks__date",function(t){var e=t.datetime||t.time||t.date;return e?'<td><i class="inline-stocks__cell_datetime">'+e+"</i></td>":""}),s("inline-stocks__delta",function(t,e){var i,n,s=t.data,o=home.getData("inline-stocks.deltaExps",{}),r={up:"up",down:"down"},a="";return t.inverseColor&&(o.ratesInverse||o.ratesInverseLimit)&&(r.up="down",r.down="up"),t.klimit&&(n="     %d%%".replace(/%d%(%)/,t.klimit+"$1")),(i=Number((s.delta||"").replace("","-").replace(/[+%]/g,"").replace(",",".")))>0?a="inline-stocks__cell_change_"+r.up+" ":i<0&&(a="inline-stocks__cell_change_"+r.down+" "),s.delta?'<td><i class="inline-stocks__cell inline-stocks__cell_type_delta '+(!o.ratesInverseLimit||o.ratesInverseLimit&&s.is_hot?a:"")+"inline-stocks__cell_delta_"+(s.is_hot&&!o.ratesInverseLimit?"hot":"small")+'"'+(n&&s.is_hot?' title="'+n+'"':"")+' aria-hidden="true">'+s.delta+'</i><span class="a11y-hidden">'+String(s.delta).replace("","-")+"</span></td>":""}),s("inline-stocks__rows-by-type",function(t,e,i){var n=t.klimit;switch(t.type){case"cash":return t.rows.map(function(t){return i("inline-stocks__val",t)}).join("");case"currency":return t.rows.map(function(e,s){return(s?i("inline-stocks__delta",{data:e,klimit:n,inverseColor:t.inverseColor}):"")+i("inline-stocks__val",e)}).join("");case"indexes":var s=t.rows[0];return i("inline-stocks__date",s)+i("inline-stocks__delta",{data:s,klimit:n,inverseColor:t.inverseColor})+i("inline-stocks__val",s)}}),s("inline-stocks__replaceCaps",function(t){return t.text.replace(/<(\w)>([^<]+)<\/\1>/g,function(t,e,i){switch(e){case"c":return'<span class="inline-stocks__caps">'+i+"</span>";case"d":return'<span class="inline-stocks__numbers">'+i+"</span>";default:return t}})}),s("inline-stocks__block-content",function(t,e,i){for(var n="",s=t.rows,o=0,r=s.length;o<r;o++){var a=s[o],c=e.l10n("rates.newalt."+a.alt).replace(/%s/,a.text);n+='<tr class="inline-stocks__row_id_'+a.id+'" data-klimit="'+a.klimit+'"><td class="inline-stocks__row-title">'+i("home-link",{href:!e.nolinks&&a.href,mix:"home-link_blue_yes",attrs:{title:c,"data-statlog":"news_rates_manual.popup."+a.id},content:i("inline-stocks__replaceCaps",{text:a.text_caps})})+(a.nscale?'<span class="inline-stocks__row-nscale">'+a.nscale+"</span>":"")+"</td>"+i("inline-stocks__rows-by-type",{type:t.type,rows:a.data,klimit:a.klimit,inverseColor:a.inverse_color})+"</tr>"}return'<h2 class="inline-stocks__table-title">'+t.text+'</h2><table class="inline-stocks__table inline-stocks__table_type_'+t.type+" inline-stocks__table_id_"+t.i+'">'+i("inline-stocks__t-title",t)+n+"</table>"}),s("inline-stocks__grid",function(t){var e,i=t.data,n=i.length/2,s="",o="";for(e=0;e<n;e++)s+='<div class="inline-stocks__grid-item inline-stocks__grid-item_first">'+i[2*e]+"</div>",o+=i[2*e+1]?'<div class="inline-stocks__grid-item">'+i[2*e+1]+"</div>":"";return'<tr class="inline-stocks__grid-row"><td>'+s+"</td><td>"+o+"</td></tr>"}),s("inline-stocks__tables",function(t,e,i){var n,s=t.blocks;return s?(n=s.map(function(t,e){return t.i=e,"cash_rate"===t.type&&(t.type="cash"),i("inline-stocks__block-content",t)}),i("inline-stocks__grid",{data:n})):""}),s("inline-stocks__nscale",function(t,e,i){var n,s;return'<span class="inline-stocks__nscale text_gray_yes">('+(t.nscale!==s?t.nscale:e.nscale!==s?e.nscale:(n=i("nscale",t))!==s?n:"")+")</span>"}),s("inline-stocks__val",function(t,e,i){var n,s;return'<td><i class="inline-stocks__cell">'+(t.value!==s?t.value:e.value!==s?e.value:(n=i("value",t))!==s?n:"")+"</i></td>"}),s.cached("widget-control__stat-map",function(){return{topnews:"news",services:"sites",geo:"maps"}}),s("widget-control",function(t,e,i){return i("widget-control__layout",{mods:t.mods,js:{"widget-control":t.params},dropdown:{dropdown2:{}}})}),s("widget-control__layout",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"widget-control.class")+' i-bem" data-bem="'+home.parseRules.bem(t,e,"js")+'"><span class="widget-control__button widget-control__menu i-bem dropdown2 dropdown2_switcher_elem dropdown2__switcher" tabindex="0" title=" " data-bem="'+home.parseRules.bem(t,e,"dropdown.js")+'"></span><span class="widget-control__button widget-control__show" tabindex="0" title=""></span></div>'}),s("menu__group",function(t,e,i){var n=t.content;return i("menu__group-layout",{content:(t.title?i("menu__group-title",{content:t.title}):"")+n})}),s("menu__group-title",function(t,e,i){return'<div class="menu__title" aria-hidden="true">'+(void 0!==t.content?t.content:"")+"</div>"}),s("menu__group-layout",function(t,e,i){return'<div class="menu__group" role="group">'+(void 0!==t.content?t.content:"")+"</div>"}),s("menu__icon",function(t,e,i){return i(t.block||"icon",{mix:home.getBEMClassname("menu__icon",t),mods:t.mods})}),s("icon",function(t,e,i){var n=t||{},s={},o=void 0!==n.url,r=void 0!==Object(n.attrs).style,a=(r?n.attrs.style:"")+(o?";background-image:url('"+n.url+"');":"");return n.mods=n.mods||{},n.mods["has-glyph"]="yes",r&&(n.attrs.style=a),a&&(s.style=a),i("icon__html",{mods:n.mods,attrs:s,mix:n.mix,content:i("icon_glyph_"+n.mods.glyph)})}),s("icon__html",function(t,e,i){return'<span class="'+home.parseRules.bem(t,e,"icon.class")+'" '+home.parseRules.bem(t,e,"attrs")+">"+(void 0!==t.content?t.content:"")+"</span>"}),s("icon_glyph_settings",function(t,e,i){return'<svg focusable="false" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M3.051 3.05h.001l.371-.37a.4.4 0 0 1 .547-.019l.849.745a1.296 1.296 0 0 0 2.18-.904h.003l.073-1.127a.4.4 0 0 1 .4-.374H8V1v.001h.525a.4.4 0 0 1 .399.374l.074 1.127H9A1.296 1.296 0 0 0 10.3 3.75c.345 0 .658-.134.89-.353l.84-.736a.4.4 0 0 1 .546.018l.371.371h.002v.002l.37.37a.4.4 0 0 1 .019.547l-.744.85a1.297 1.297 0 0 0 .04 1.803c.223.222.527.364.864.377v.003l1.127.074a.4.4 0 0 1 .373.399V8H15V8h-.002v.525a.4.4 0 0 1-.373.4L13.498 9a1.3 1.3 0 0 0-.903 2.182h-.001l.744.85a.4.4 0 0 1-.018.546l-.371.372v.001l-.372.37a.4.4 0 0 1-.546.019l-.82-.717a1.296 1.296 0 0 0-1.833.01 1.296 1.296 0 0 0-.377.867h-.003l-.074 1.127a.4.4 0 0 1-.376.373H7.451a.4.4 0 0 1-.376-.373L7.002 13.5h-.003A1.296 1.296 0 0 0 5.7 12.25c-.352 0-.672.14-.906.368l-.825.722a.4.4 0 0 1-.547-.018l-.37-.371-.002-.001-.37-.372a.4.4 0 0 1-.019-.546l.745-.85a1.302 1.302 0 0 0-.904-2.181l-1.128-.076a.4.4 0 0 1-.373-.4v-.524L1 8l.001-.525a.4.4 0 0 1 .374-.4l1.127-.073v-.003A1.296 1.296 0 0 0 3.75 5.7c0-.342-.132-.654-.349-.886l-.74-.845a.4.4 0 0 1 .019-.546l.371-.371-.001-.002h.001zM8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" fill="#000" fill-rule="nonzero"/></svg>'}),s("icon_glyph_hide",function(t,e,i){return'<svg focusable="false" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><g fill="#000" fill-rule="nonzero"><path d="M10.445 2.536L8.423 5.763a.5.5 0 0 1-.847 0l-2.02-3.227A.35.35 0 0 1 5.851 2h4.296a.35.35 0 0 1 .297.536zM10.445 13.462l-2.022-3.227a.5.5 0 0 0-.847 0l-2.02 3.227a.35.35 0 0 0 .296.536h4.296a.35.35 0 0 0 .297-.536z"/><rect x="1" y="7" width="14" height="2" rx=".5"/></g></svg>'}),s("icon_glyph_geo",function(t,e,i){return'<svg focusable="false" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M13.565 3.086l-3.992 9.98a.5.5 0 0 1-.95-.064L7.5 8.502l-4.5-1.124a.5.5 0 0 1-.065-.95l9.982-3.992a.5.5 0 0 1 .65.65z" fill="#000" fill-rule="nonzero"/></svg>'}),s("icon_glyph_delete",function(t,e,i){return'<svg focusable="false" width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M11 2h2.5a.5.5 0 1 1 0 1h-11a.5.5 0 0 1 0-1H5l.854-.854A.5.5 0 0 1 6.207 1h3.586a.5.5 0 0 1 .353.146L11 2zm1.015 11.843A1.25 1.25 0 0 1 10.768 15H5.232a1.25 1.25 0 0 1-1.247-1.157l-.694-9.255a.55.55 0 0 1 .549-.591l8.32-.002a.55.55 0 0 1 .549.591l-.694 9.257zM6.5 6a.5.5 0 0 0-.5.5v6a.5.5 0 1 0 1 0v-6a.5.5 0 0 0-.5-.5zm3 0a.5.5 0 0 0-.5.5v6a.5.5 0 1 0 1 0v-6a.5.5 0 0 0-.5-.5z" fill="#000" fill-rule="nonzero"/></svg>'}),s("i-install-download__content",function(t,e,i){var n,s;return'<div class="'+home.parseRules.bem(t,e,"i-install-download__content.class")+'" '+home.parseRules.bem(t,e,"attrs")+' data-bem="'+home.parseRules.bem(t,e,"js")+'"><div class="i-install-download__target-pointer"><div class="i-install-download__arrow"><div class="i-install-download__stick"></div></div></div><div class="i-install-download__install-text">'+(t.text!==s?t.text:e.text!==s?e.text:(n=i("text",t))!==s?n:"")+'</div><div class="i-install-download__agreement">'+(t.legalText!==s?t.legalText:e.legalText!==s?e.legalText:(n=i("legalText",t))!==s?n:"")+' <a href="'+(t.legalLink!==s?t.legalLink:e.legalLink!==s?e.legalLink:(n=i("legalLink",t))!==s?n:"")+'" class="link link_gray_yes i-install-download__legal">'+(t.legalLinkText!==s?t.legalLinkText:e.legalLinkText!==s?e.legalLinkText:(n=i("legalLinkText",t))!==s?n:"")+"</a></div></div>"}),s("popup",function(t){var e=t.mods||{},i=t.attrs||{};return e.theme=e.theme||"ffffff",void 0===e.autoclosable&&(e.autoclosable="yes"),void 0===e.adaptive&&(e.adaptive="yes"),void 0===e.animate&&(e.animate="yes"),t.zIndex&&(i.style=i.style||"",i.style+="z-index:"+t.zIndex),'<div class="i-bem '+home.getBEMClassname("popup",{mods:e,mix:t.mix})+'" data-bem="{&quot;popup&quot;:'+home.getBEMParams(t.js?t.js:[])+(t.jsMix?","+t.jsMix:"")+'}"'+home.getAttributes(i)+'><div class="'+home.getBEMClassname("popup__under",{mods:t.underMods,mix:t.underMix})+'"></div>'+(t.tail?'<i class="popup__tail"></i>':"")+(t.content?'<div class="'+home.getBEMClassname("popup__content",{mods:t.contentMods,mix:t.contentMix})+'"'+home.getAttributes(t.contentAttrs||{})+">"+t.content+"</div>":"")+("yes"===e["has-close"]?'<i class="popup__close"'+(t.statClose||"")+">"+(t.closeText?'<div class="popup__close-text">'+t.closeText+"</div>":"")+"</i>":"")+"</div>"}),s("home-tabs__more-tabs-bottom",function(t,e,i){return t.bottom.map(function(t){var n=t.id,s=i("home-link",{href:t.href,mix:"home-tabs__more-link home-link_black_yes"+(t.search?" home-tabs__search":""),content:t.title,stat:e.stat.getAdaptiveCounter("tabsPopup."+n),attrs:{"data-id":n}});return i("home-tabs__more-item",{content:s,mix:" home-tabs__more-item_bottom"})}).join("")}),s("home-tabs__more-tabs-top",function(t,e,i){return t.top.map(function(t){var n=t.id,s=i("home-link",{href:t.href,mix:"home-tabs__more-link home-link_black_yes"+(t.search?" home-tabs__search":""),content:t.title,stat:e.stat.getAdaptiveCounter("tabsPopup."+n),attrs:{"data-id":n}});return i("home-tabs__more-item",{content:s,mix:t.adaptive?" i-adaptive__"+t.adaptive:""})}).join("")}),s("home-tabs__more-item",function(t,e,i){var n;return'<div class="home-tabs__more-item'+(t.mix!==n?t.mix:"")+'" role="menuitem">'+(t.content!==n?t.content:"")+"</div>"}),s("home-tabs__more",function(t,e,i){var n;return'<div class="home-tabs__more"><div class="home-tabs__more-top">'+(t.top!==n?t.top:"")+'</div><div class="home-tabs__more-bottom">'+(t.bottom!==n?t.bottom:"")+"</div></div>"}),s("input__ahead",function(t,e,i){return'<div class="input__ahead"><input class="input__ahead-hint" type="text" disabled="disabled" aria-hidden="true"><span class="input__ahead-filler"></span><div class="input__ahead-hintholder"></div></div>'}),s("voice-search-popup__buttons",function(t,e,i){return i("button",{mods:{size:"m",theme:"action"},mix:"voice-search-popup__continue-button voice-search-popup__error-button",content:" ",attrs:{"data-statlog":"voice.popup.continue-search"}})}),s("voice-search-popup",function(t,e,i){return i("voice-search-popup__layout",{js:{"voice-search-popup":{}},startLetters:"...".split("").map(function(t,e,n){return i("voice-search-popup__start-text-span",{letter:t,delay:.3/n.length*e,duration:.3})}).join(""),errorButtons:i("voice-search-popup__buttons",t),showMicHelper:t.showMicHelper})}),s("voice-search-popup__start-text-span",function(t,e,i){var n;return'<span class="voice-search-popup__letter" style="-webkit-animation-delay: '+(t.delay!==n?t.delay:"")+"s; -webkit-animation-duration: "+(t.duration!==n?t.duration:"")+"s; animation-delay: "+(t.delay!==n?t.delay:"")+"s; animation-duration: "+(t.duration!==n?t.duration:"")+'s;">'+(t.letter!==n?t.letter:"")+"</span>"}),s("voice-search-popup__text",function(t,e,i){return'<div class="voice-search-popup__text"></div>'}),s("voice-search-popup__layout",function(t,e,i){var n,s;return'<div class="voice-search-popup__paranja" data-statlog="voice.popup.paranja"></div><div class="voice-search-popup voice-search-popup_state_closed i-bem" data-bem="'+home.parseRules.bem(t,e,"js")+'" data-statlog="voice.popup.popup"><div class="voice-search-popup__close" data-statlog="voice.popup.close"></div><div class="voice-search-popup__content"><div class="voice-search-popup__init"></div><div class="voice-search-popup__start">'+(t.startLetters!==s?t.startLetters:"")+'</div><div class="voice-search-popup__error"><div class="voice-search-popup__title voice-search-popup__error-title"></div><div class="voice-search-popup__subtitle voice-search-popup__error-subtitle"></div><div class="voice-search-popup__error-actions">'+(t.errorButtons!==s?t.errorButtons:"")+"</div></div>"+((n=i("voice-search-popup__text",t))!==s?n:"")+'<div class="voice-search-popup__indicator"></div>'+((n=i("voice-search-popup__access",t))!==s?n:"")+"</div></div>"}),s("button",function(t){var e=t.mods||{},i="button",n=t.attrs||{};return t.url?i="a":t.tag&&(i=t.tag),e.theme||("yes"===e.pseudo?e.theme="pseudo":e.theme="normal"),n.role="button",t.tabindex&&(n.tabindex=t.tabindex),t.url?(n.href=t.url,t.target&&(n.target=t.target),e.disabled&&(n["aria-disabled"]=!0),"_blank"===n.target&&void 0===n.rel&&(n.rel="noopener")):(n.type=t.type||"button",t.name&&(n.name=t.name),t.value&&(n.value=t.value),e.disabled&&(n.disabled="disabled")),"<"+i+' class="'+home.getBEMClassname("button",{mods:e,mix:t.mix})+' i-bem" data-bem="{&quot;button&quot;:{}}"'+home.getAttributes(n)+(t.stat||"")+'><span class="button__text">'+(t.content||"")+"</span></"+i+">"}),s("voice-search-popup__access",function(t,e,i){if(t.showMicHelper)return i("voice-search-popup__access-layout",t)}),s("voice-search-popup__buttons",function t(e,i,n){return n(t.base,e)+n("button",{mods:{size:"m"},mix:"voice-search-popup__help-button voice-search-popup__error-button",url:"https://yandex.ru/support/search/how-to-search/voice-search.html",content:"  ",target:"_blank",attrs:{"data-statlog":"voice.popup.help-button"}})}),s("voice-search-popup__access-layout",function(t,e,i){return'<div class="voice-search-popup__access"><div class="voice-search-popup__title">   </div><div class="voice-search-popup__subtitle">     ,       </div></div>'}),s("direct-close-block",function(t,e,i){var n={},s=e.cls.full("direct-close-block"),o=t.idleTheme||"light",r=t.closingTheme||"light";return t.isDark&&(o="dark",r="dark"),t.theme=t.theme||e.cls.part("direct"),n.mod=s+"_"+t.theme,n.mod+=e.cls.full(" direct-close-block_idle-theme_"+o),n.mod+=e.cls.full(" direct-close-block_closing-theme_"+r),n.js={},n.js[s]={name:s,id:t.directId},t.jsParams&&(n.js[s].data=t.jsParams),t.isTouch||(n.tooltip=i("direct-close-block__tooltip")),i("direct-close-block__layout",n)}),s("direct-close-block__close-block",function(t,e,i){return'<div class="'+home.parseRules.cls(t,e,"direct-close-block__close-popup")+'"><div class="'+home.parseRules.cls(t,e,"direct-close-block__close-popup-content-wrapper")+'"><div class="'+home.parseRules.cls(t,e,"direct-close-block__close-popup-content")+'"><span class="'+home.parseRules.cls(t,e,"direct-close-block__close-popup-capture")+'"> :</span>'+(void 0!==t.buttons?t.buttons:"")+"</div></div></div>"}),s("direct-close-block__confirm-block",function(t,e,i){return'<div class="'+home.parseRules.cls(t,e,"direct-close-block__confirm-popup")+'"><div class="'+home.parseRules.cls(t,e,"direct-close-block__confirm-popup-content")+'"><div class="'+home.parseRules.cls(t,e,"direct-close-block__check-icon")+'"></div>,  </div></div>'}),s("direct-close-block__layout",function(t,e,i){var n;return'<div class="'+home.parseRules.cls(t,e,"direct-close-block")+" "+home.parseRules.cls(t,e,"direct-close-block_state_idle")+" "+(t.mod!==n?t.mod:"")+' i-bem" data-bem="'+home.parseRules.bem(t,e,"js")+'"><div class="'+home.parseRules.cls(t,e,"direct-close-block__close-button")+'"><div class="'+home.parseRules.cls(t,e,"direct-close-block__close-icon-wrapper")+'"><div class="'+home.parseRules.cls(t,e,"direct-close-block__close-icon")+'"></div></div>'+(t.tooltip!==n?t.tooltip:"")+"</div></div>"}),s("b-banner__link",function(t,e,i){var n;return'<a href="'+(t.url!==n?t.url:"")+'" target=_blank>'+(t.content!==n?t.content:"")+"</a>"}),s("b-banner__img",function(t,e,i){return"<img "+home.parseRules.bem(t,e,"attrs")+">"}),s("b-banner__iframe",function(t,e,i){var n;return'<iframe class="banner-iframe" name="'+(t.name!==n?t.name:"")+'" src="'+(t.src!==n?t.src:"")+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"  width="728" height="90"></iframe>'}),s("mix-tabber__panel",function(t,e,i){var n;return'<div class="'+(t.block!==n?t.block:"")+"__panel"+(t.mix!==n?t.mix:"")+'" role="tabpanel" id="'+(t.id!==n?t.id:"")+"_panel_"+(t.key!==n?t.key:"")+'" data-key="'+(t.key!==n?t.key:"")+'"'+home.parseRules.bem(t,e,"attrs")+">"+(t.content!==n?t.content:"")+"</div>"}),s("mix-tabber__tab",function(t,e,i){var n=t.attrs||{},s=t.mods||{},o=t.mix||"";return n.role="tab",i("home-link",{mix:o+=" "+home.getBEMClassname("mix-tabber__tab",{mods:s}),mods:t.mods,attrs:t.attrs,href:t.href,stat:t.stat,content:t.content})}),s("streamnow__tab-panel",function(t,e,i){return t.hasTabs=!0,i("streamnow__programs",t)}),s("streamnow__programs",function(t,e,i){return i("streamnow__programs-layout",{items:t.programs.map(function(n,s){var o;return o=t.hasTabs?"stream_now."+t.key.replace(/_.+$/,"")+".items."+s:"stream_now.items."+s,i("streamnow__item",{link:i("home-link",{href:i("stream-url",{fromBlock:"stream_now_item",streamId:n.program_content_id}),attrs:{"data-stream-id":n.program_content_id,"data-from-block":"stream_now_item",title:n.title!==n.program_title||t.hasTabs?n.title:void 0},target:"_blank",stat:e.stat.getAttr(o),content:i("streamnow__item-inner",{name:home.htmlFilter(n.program_title),info:home.htmlFilter(n.info||"")}),mods:{black:"yes"},mix:"stream-control__link streamnow__link"})})}).join("")})}),s("streamnow__item-inner",function(t,e,i){var n;return'<span class="b-ico streamnow__play tv__stream-triangle-round"></span><span class="streamnow__item-title">'+(t.name!==n?t.name:"")+'</span> <span class="streamnow__item-info">'+(t.info!==n?t.info:"")+"</span>"}),s("streamnow__item",function(t,e,i){return'<li class="streamnow__item">'+(void 0!==t.link?t.link:"")+"</li>"}),s("streamnow__programs-layout",function(t,e,i){return'<ul class="streamnow__items widget__content">'+(void 0!==t.items?t.items:"")+"</ul>"}),s.cached("widgets__check-arrow-middle",function(t){var e=t.Widgets&&t.Widgets.NotEmptyColumns&&!t.Widgets.NotEmptyColumns.Column1&&!t.Widgets.NotEmptyColumns.Column2,i=t.Widgets&&t.Widgets.NotEmptyColumns&&!t.Widgets.NotEmptyColumns.Column3&&!t.Widgets.NotEmptyColumns.Column4&&!t.Widgets.NotEmptyColumns.Column5;return t.Skin||t.SkinsCatalog&&"default"!==t.DefskinArg||e&&i}),s("etrains__draw",function(t,e,i){var n,s,o="",r=[],a=(t.from||"").replace(/\s*\(.*$/,""),c=(t.to||"").replace(/\s*\(.*$/,""),l=t.today,h=t.tomorrow,u="rasp."+t.counterType+".track";if(l&&l.length||h&&h.length){if(l&&l.length)for(n=0,s=l.length;n<s;n++)r.push(i("etrains__onerow",{row:l[n],host:t.host,counter:u}));if(h&&h.length)for(n=0,s=h.length;n<s;n++)r.push(i("etrains__onerow",{row:h[n],host:t.host,counter:u}));o=i("etrains__track",{direction:i("etrains__directionLayout",{stfrom:a,stto:c}),times:r.join(""),trackClass:t.direction?"fwd":"rev"})}return o}),s("etrains__onerow",function(t,e,i){var n=t.row;return i("etrains__time",{href:n.uid?t.host+"thread/"+n.uid:"javascript:void(0)",hint:i("etrains__hint",{express:n.express?"&#32;":"",name:n.name||n.title}),time:n.stime||n.departure,timeClass:n.express?" etrains__time_express":"",stat:e.stat.getAdaptiveCounter(t.counter)})}),s("etrains__hint",function(t,e,i){var n,s;return'<div class="etrains__hint"><span class="etrains__hint-baloon"><i class="etrains__hint-baloon-tail-bd"></i><i class="etrains__hint-baloon-tail"></i><span class="inline-stocks__item__baloon_inner">'+(t.express!==s?t.express:e.express!==s?e.express:(n=i("express",t))!==s?n:"")+(t.name!==s?t.name:e.name!==s?e.name:(n=i("name",t))!==s?n:"")+"</span></span></div>"}),s("etrains__directionLayout",function(t,e,i){var n,s;return'<span class="etrains__direction link link_black_yes">&#8203;'+(t.stfrom!==s?t.stfrom:e.stfrom!==s?e.stfrom:(n=i("stfrom",t))!==s?n:"")+"&nbsp; "+(t.stto!==s?t.stto:e.stto!==s?e.stto:(n=i("stto",t))!==s?n:"")+"</span>"}),s("etrains__time",function(t,e,i){var n,s;return'<li class="etrains__track-time"><a href="'+(t.href!==s?t.href:e.href!==s?e.href:(n=i("href",t))!==s?n:"")+'" class="link link_black_yes etrains__time'+(t.timeClass!==s?t.timeClass:e.timeClass!==s?e.timeClass:(n=i("timeClass",t))!==s?n:"")+'"'+(t.stat!==s?t.stat:e.stat!==s?e.stat:(n=i("stat",t))!==s?n:"")+(t.target!==s?t.target:e.target!==s?e.target:(n=i("target",t))!==s?n:"")+">"+(t.time!==s?t.time:e.time!==s?e.time:(n=i("time",t))!==s?n:"")+"</a>"+(t.hint!==s?t.hint:e.hint!==s?e.hint:(n=i("hint",t))!==s?n:"")+"</li>"}),s("etrains__trackEmpty",function(t,e,i){var n,s;return'<div class="etrains__track">'+(t.text!==s?t.text:e.text!==s?e.text:(n=i("text",t))!==s?n:"")+"</div>"}),s("etrains__track",function(t,e,i){var n,s;return'<span class="etrains__track etrains__track-'+(t.trackClass!==s?t.trackClass:e.trackClass!==s?e.trackClass:(n=i("trackClass",t))!==s?n:"")+'">'+(t.direction!==s?t.direction:e.direction!==s?e.direction:(n=i("direction",t))!==s?n:"")+'<ul class="etrains__times-list">'+(t.times!==s?t.times:e.times!==s?e.times:(n=i("times",t))!==s?n:"")+"</ul></span>"}),s("themes-promo__inner-header",function(t,e,i){var n,s;return"<a "+home.parseRules.bem(t,e,"attrs")+' class="themes-promo__link link'+(t.textMix!==s?t.textMix:e.textMix!==s?e.textMix:(n=i("textMix",t))!==s?n:"")+'"><span class="themes-promo__text">'+(t.text!==s?t.text:e.text!==s?e.text:(n=i("text",t))!==s?n:"")+'</span></a><span class="themes-promo__close'+(t.textMix!==s?t.textMix:e.textMix!==s?e.textMix:(n=i("textMix",t))!==s?n:"")+'" '+(t.closeAttrs!==s?t.closeAttrs:e.closeAttrs!==s?e.closeAttrs:(n=i("closeAttrs",t))!==s?n:"")+'>&#10005;</span><div class="themes-promo__tail"></div><div class="themes-promo__top-wing"></div><div class="themes-promo__bottom-wing"></div><div class="themes-promo__top-arrow"></div><div class="themes-promo__bottom-arrow"></div>'}),s("player-control__loader",function(t,e,i){return'<div class="player-control__loader"><div class="player-control__close" role="button" tabindex="0" title=""></div><span class="player-control__spin loader"></span></div>'}),s("stream-control__loader",function(t,e,i){return'<div class="player-control__loader"><div class="stream-control__close player-control__close" role="button" tabindex="0" title=""><svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m1.6,1.6l12.7,12.7m0,-12.7l-12.7,12.7" stroke-width="2.6" stroke="currentColor"/></svg></div><span class="player-control__spin loader"></span></div>'}),s("desk-notif-card__sport-status",function(t,e,i){var n=[],s=t.round_title,o=t.phase_title;return t.subtitle?n.push(t.subtitle):(s&&n.push(s),o&&n.push(home.prepareSpaces(o))),n.length?i("desk-notif-card__sport-status-layout",{inProgress:"in_progress"===t.status?"yes":"no",text:n.join(", ")}):""}),s("desk-notif-card__sport-status-layout",function(t,e,i){var n;return'<div class="desk-notif-card__sport-status desk-notif-card__sport-progress_'+(t.inProgress!==n?t.inProgress:"")+'">'+(t.text!==n?t.text:"")+"</div>"}),s("desk-notif-card__inner",function(t,e,i){var n="";return n+=t.link||"",n+=t.title?i("desk-notif-card__title",t):"",n+=t.details?i("desk-notif-card__details",t):"",t.iconSrc&&(t.iconSrc=i("desk-notif-card__icon-src",t)),n+=t.iconSrc||t.iconClass?i("desk-notif-card__icon",t):"",n+=t.extraElems||"",n+=t.switcher||""}),s("desk-notif-card__icon",function(t,e,i){var n,s;return'<div class="desk-notif-card__icon '+(t.iconClass!==s?t.iconClass:e.iconClass!==s?e.iconClass:(n=i("iconClass",t))!==s?n:"")+'" '+(t.iconSrc!==s?t.iconSrc:"")+"></div>"}),s("desk-notif-card__details",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"detailsDesc.desk-notif-card__details.class")+'">'+(void 0!==t.details?t.details:"")+"</div>"}),s("desk-notif-card__title",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"titleDesc.desk-notif-card__title.class")+'">'+(void 0!==t.title?t.title:"")+"</div>"}),s("route__api-url",function(t,e){function i(t){return void 0!==t.longitude&&void 0!==t.latitude?t.longitude+","+t.latitude:"string"==typeof t?t:void home.warn("Incorrect format for point from route. Got something wrong instead Object.ll Object.lt or string."+JSON.stringify(t))}var n=i(t.start),s=i(t.finish),o=t.transit,r=o&&o.length?o.map(i).join("~"):"",a=e.TestingInstance&&e.Getargshash&&e.Getargshash.geohelperMocks||"",c=t.transit&&t.transit.length&&!r;if(n&&s&&!c)return"https://"+e.GeohelperHost+"/geohelper/api/v1/router?points="+n+"~"+s+"&locale="+e.Locale+"&domain="+e.MordaZone+"&feature=bypass_first"+(r?"&via="+r:"")+(a?"&usemock="+a:"")+"&from="+t.from||e.MordaContent}),s("desk-notif-card__zen-layout",function(t,e,i){var n;return'<div class="desk-notif-card__zen desk-notif-card__icon"></div><div class="desk-notif-card__zen-domain desk-notif-card__style_caps">'+(t.domainTitle!==n?t.domainTitle:"")+'</div><div class="desk-notif-card__zen-text desk-notif-card__style_text">'+(t.title!==n?t.title:"")+"</div>"}),s("desk-notif-card__etrains-time",function(t,e,i){var n,s=t.row;return s.uid&&(n=t.host+"thread/"+s.uid),i("desk-notif-card__etrains-time-html",{link:i("home-link",{href:n,stat:e.stat.getAttr("notifications.etrains.rasp",n,{logShow:!1}),content:s.stime||s.departure,mix:s.express?"desk-notif-card__etrains-time_express":"",mods:{black:"yes"},attrs:{title:(s.express?"&#32;":"")+(s.name||s.title)}})})}),s("desk-notif-card__etrains-draw",function(t,e,i){var n=t.table;if(n&&n.length)return n.map(function(e){return i("desk-notif-card__etrains-time",{row:e,host:t.host})}).join("")}),s("desk-notif-card__etrains-schedule",function(t,e,i){var n=i("desk-notif-card__etrains-draw",{table:t.from,host:t.host}),s=i("desk-notif-card__etrains-draw",{table:t.to,host:t.host});if(n||s)return i("desk-notif-card__etrains-schedule-html",{from:n,to:s,stat:e.stat.getAttr("notifications.etrains.rasp")})}),s("desk-notif-card__etrains-title-content",function(t,e,i){return i("desk-notif-card__etrains-title-html",{content:i("desk-notif-card__etrains-route",{from:(t.from||"").replace(/\s*\(.*$/,""),to:(t.to||"").replace(/\s*\(.*$/,"")})})}),s("desk-notif-card__etrains-route",function(t,e,i){var n;return'<div class="desk-notif-card__etrains-from"><div class="desk-notif-card__etrains-route">'+(t.from!==n?t.from:"")+'</div></div><div class="desk-notif-card__etrains-to"><div class="desk-notif-card__etrains-route">'+(t.to!==n?t.to:"")+"</div></div>"}),s("desk-notif-card__etrains-title-html",function(t,e,i){return'<div class="desk-notif-card__etrains-title">'+(void 0!==t.content?t.content:"")+"</div>"}),s("desk-notif-card__etrains-time-html",function(t,e,i){return'<li class="'+home.parseRules.bem(t,e,"desk-notif-card__etrains-time.class")+'">'+(void 0!==t.link?t.link:"")+"</li>"}),s("desk-notif-card__etrains-schedule-html",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"desk-notif-card__etrains-schedule.class")+'" '+(t.stat!==n?t.stat:"")+'><div class="desk-notif-card__etrains-list-wrapper"><ul class="desk-notif-card__etrains-list desk-notif-card__etrains-list-from">'+(t.from!==n?t.from:"")+'</ul><ul class="desk-notif-card__etrains-list desk-notif-card__etrains-list-to">'+(t.to!==n?t.to:"")+"</ul></div></div>"}),s("dist-popup__image",function(t,e,i){return'<img class="dist-popup__image" alt="" src="'+(void 0!==t.image?t.image:"")+'"/>'}),s("media-grid__row",function(t,e,i){var n,s=t.view,o=t.layoutName,r={};return s&&(n=i(s,{mods:{width:"full"},params:t.blockParams||{}}))?(r.collapsed=!t.expand&&(e.blocks_folded||{})[o]?"yes":void 0,r.collapsed&&e.stat.logShow(o+".widget_control.show"),i("media-grid__row-layout",{mods:r,content:n,attrs:{"data-blockname":o}})):""}),s("media-grid__hide-media-footer-mode",function(t){var e=t.notEmptyColumns||{};if(!(e.Column3||e.Column4||e.Column5))return"full"}),s.cached("media-grid__layout-name-map",function(){return{broadcast:"media-broadcast",tv_online:"media-stream",stream_inserts_films:"stream-inserts",stream_inserts_series:"stream-inserts",stream_inserts_anim_films:"stream-inserts",stream_inserts_anim_series:"stream-inserts",stream_inserts_mixed:"stream-inserts"}}),s("media-grid__layout-to-block-name",function(t,e,i){return i("media-grid__layout-name-map")[t]||t.replace(/_/g,"-")}),s("media-grid__row-layout",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"media-grid__row.class")+'" '+home.parseRules.bem(t,e,"attrs")+">"+(void 0!==t.content?t.content:"")+"</div>"}),s.cached("media-service__tabs-theme",function(t,e){var i="mix-tabber_theme_media";return e("media-service__inline-tabs")&&(t.tabs_theme?i=t.tabs_theme:home.exp&&home.exp.getFlag&&(i="mix-tabber_theme_inline-"+(home.exp.getFlag("inline_tabs","theme",t)||"black"))),i}),s.cached("media-service__inline-tabs",function(t){return t.inline_tabs?t.inline_tabs:home.exp&&home.exp.check&&home.exp.check("inline_tabs",t)}),s("media-service__desc",function(t,e,i){var n=t.desc||t.collapsedText;if(n)return i("media-service__desc-layout",{block:t.block,desc:n,mix:t.desc?"":" media-service__desc_collapsed_yes"})}),s("media-service__more",function(t,e,i){if(t&&t.more)return i("home-link",{mix:"media-service__more "+(t.more.mix||""),mods:{black:"yes",pseudo:"yes"},target:t.more.target,stat:t.more.stat,href:t.more.href,attrs:t.more.href?t.more.attrs:home.deepExtend(t.more.attrs,{role:"button",tabindex:"0"}),content:i("media-service__more-layout",{text:t.more.content})})}),s("media-service__title",function(t,e,i){return i("home-link",{mix:t.block+"__title media-service__title-text"+(t.titleMix?" "+t.titleMix:""),href:t.href,content:t.title,attrs:t.titleAttrs,stat:t.titleStat,target:t.target})}),s("media-service",function(t,e,i){var n,s=t.content||"",o=t["title-after"]||"",r="";return t.tabs&&(r=i("div",{mix:t.block+"__tabs media-service__tabs",attrs:{role:"tablist"},content:t.tabs}),n=i("media-service__tabs-theme"),i("media-service__inline-tabs")?(o+=r,t.mods=t.mods||{},t.mods["inline-tabs"]="yes"):s=r+s,n&&(t.mix=(t.mix||"")+" "+n)),i("media-service__layout",home.deepExtend(t,{descTmpl:t.desc?i("media-service__desc",t):"",content:s,"title-after":o}))}),s("media-service__more-layout",function(t,e,i){return'<span class="media-service__more-text">'+(void 0!==t.text?t.text:"")+'</span><span class="media-service__more-icon"></span>'}),s("media-service__desc-layout",function(t,e,i){var n;return'<div class="media-service__desc '+(t.block!==n?t.block:"")+"__desc"+(t.mix!==n?t.mix:"")+'">'+(t.desc!==n?t.desc:"")+"</div>"}),s("media-service__layout",function(t,e,i){var n,s;return'<div class="'+(t.rootMod!==s?t.rootMod:"")+" "+home.parseRules.bem(t,e,"media-service.class")+'" '+home.parseRules.bem(t,e,"attrs")+">"+(t.before!==s?t.before:"")+'<div class="'+home.parseRules.bem(t,e,"headerMods.media-service__header.class")+'"><div class="media-service__title-wrapper"><h1 class="media-service__title">'+((n=i("media-service__title",t))!==s?n:"")+"</h1>"+(t.descTmpl!==s?t.descTmpl:"")+"</div>"+(t["title-after"]!==s?t["title-after"]:"")+((n=i("media-service__more",t))!==s?n:"")+'</div><div class="'+(t.block!==s?t.block:"")+"__content media-service__content "+(t.contentMix!==s?t.contentMix:"")+'">'+(t.content!==s?t.content:"")+"</div></div>"}),s("carousel",function(t,e,i){var n,s;return'<div class="'+home.parseRules.bem(t,e,"carousel.class")+' i-bem" '+home.parseRules.bem(t,e,"attrs")+' data-bem="'+home.parseRules.bem(t,e,"js")+'">'+(t.beforeWrap!==s?t.beforeWrap:"")+'<div class="carousel__wrap '+(t.wrapMix!==s?t.wrapMix:"")+'"><div class="carousel__list '+(t.listMix!==s?t.listMix:"")+'" role="list">'+(t.content!==s?t.content:"")+"</div>"+((n=i("scrollbar-hider",t))!==s?n:"")+'</div><div class="carousel__control carousel__control_side_left"></div><div class="carousel__control carousel__control_side_right"></div></div>'}),s("scrollbar-hider",function(t,e,i){return'<div class="scrollbar-hider"><div class="scrollbar-hider__inner"></div></div>'}),s("zen__direct-type",function(t,e,i){return i("zen__direct_type_"+t.mods.type,t)}),s("zen__item-content",function(t,e,i){return i("zen__item_type_"+t.mods.type,t)}),s("zen__direct-type_small-img",function(t,e,i){return'<span class="media-service__image zen__direct-image_type_small" '+home.parseRules.bem(t,e,"smallImageAttrs.attrs")+"></span>"}),s("zen__direct-age",function(t,e,i){return'<div class="zen__direct-age">'+(void 0!==t.age?t.age:"")+"</div>"}),s("zen__direct-warning",function(t,e,i){return'<div class="zen__direct-warning">'+(void 0!==t.warning?t.warning:"")+"</div>"}),s("zen__direct-footer",function(t,e,i){var n,s;return'<div class="zen__direct-footer">'+((n=i("zen__direct-warning",t))!==s?n:"")+((n=i("zen__direct-age",t))!==s?n:"")+"</div>"}),s("zen__direct-body",function(t,e,i){var n,s;return'<span class="zen__direct-title '+home.parseRules.bem(t,e,"title.zen__item-title.class")+' i-multiline-overflow">'+((n=t.title)&&(n=n.title),n!==s?n:"")+'</span><span class="zen__direct-domain">'+(t.domain!==s?t.domain:"")+'</span><div class="zen__direct-body"><span class="zen__direct-text">'+(t.smallImage!==s?t.smallImage:"")+(t.text!==s?t.text:"")+"</span></div>"}),s("zen__direct_type_small",function(t,e,i){var n,s;return'<div class="zen__direct-content">'+((n=i("zen__direct-body",t))!==s?n:"")+"</div>"+((n=i("zen__direct-footer",t))!==s?n:"")}),s("zen__direct_type_big",function(t,e,i){var n,s;return'<span class="media-service__image zen__item-image" '+home.parseRules.bem(t,e,"bigImageAttrs.attrs")+'></span><span class="zen__item-curtain" style="background-image:-webkit-linear-gradient('+(t.from_color!==s?t.from_color:"")+", "+(t.to_color!==s?t.to_color:"")+" 50%);background-image:linear-gradient("+(t.from_color!==s?t.from_color:"")+", "+(t.to_color!==s?t.to_color:"")+' 50%);"></span><div class="zen__direct-content">'+((n=i("zen__direct-body",t))!==s?n:"")+((n=i("zen__direct-footer",t))!==s?n:"")+"</div>"}),s("zen__direct",function(t,e,i){var n,s;return'<div class="zen__item '+home.parseRules.bem(t,e,"zen__direct.class")+'" role="listitem" data-id="'+(t.id!==s?t.id:"")+'"><a class="zen__item-link" '+home.parseRules.bem(t,e,"attrs")+'><object><a class="zen__direct-label" href="'+((n=t.label)&&(n=n.href),n!==s?n:"")+'" target="_blank">'+((n=t.label)&&(n=n.text),n!==s?n:"")+"</a></object>"+((n=i("zen__direct-type",t))!==s?n:"")+"</a></div>"}),s("zen__item_type_text",function(t,e,i){var n,s;return'<span class="zen__item-text-content"><span class="'+home.parseRules.bem(t,e,"title.zen__item-title.class")+' i-multiline-overflow">'+((n=t.title)&&(n=n.title),n!==s?n:"")+'</span><span class="zen__item-text i-multiline-overflow">'+(t.text!==s?t.text:"")+"</span></span>"}),s("zen__item_type_image",function(t,e,i){var n,s;return'<span class="'+home.parseRules.bem(t,e,"title.zen__item-title.class")+' i-multiline-overflow">'+((n=t.title)&&(n=n.title),n!==s?n:"")+'</span><span class="media-service__image zen__item-image" '+home.parseRules.bem(t,e,"imageAttrs.attrs")+'></span><span class="zen__item-curtain" style="background-image:-webkit-linear-gradient('+(t.from_color!==s?t.from_color:"")+", "+(t.to_color!==s?t.to_color:"")+" 50%);background-image:linear-gradient("+(t.from_color!==s?t.from_color:"")+", "+(t.to_color!==s?t.to_color:"")+' 50%);"></span>'}),s("zen__item-control",function(t,e,i){return'<span class="zen__item-control '+(void 0!==t.mix?t.mix:"")+'" role="button" tabindex="0" '+home.parseRules.bem(t,e,"attrs")+"></span>"}),s("zen__item",function(t,e,i){var n,s;return'<div class="'+home.parseRules.bem(t,e,"zen__item.class")+'" role="listitem" data-id="'+(t.id!==s?t.id:"")+'"><a class="zen__item-link" '+home.parseRules.bem(t,e,"attrs")+">"+((n=i("zen__item-content",t))!==s?n:"")+'<span class="'+home.parseRules.bem(t,e,"domain.zen__item-domain.class")+'" '+home.parseRules.bem(t,e,"domainAttrs.attrs")+">"+((n=t.domain)&&(n=n.title),n!==s?n:"")+'<span class="zen__item-domain-fadeout" style="background-image:-webkit-linear-gradient(left, '+(t.from_color!==s?t.from_color:"")+", "+(t.to_color!==s?t.to_color:"")+" 20%);background-image:linear-gradient(to right, "+(t.from_color!==s?t.from_color:"")+", "+(t.to_color!==s?t.to_color:"")+' 20%);"></span></span></a>'+(t.like!==s?t.like:"")+(t.dislike!==s?t.dislike:"")+"</div>"}),s("media-stream__title",function(t,e){return""}),s("media-stream__content",function(t,e,i){var n=t.items,s=e.MediaFooterCollapsed||!1,o=e.zenInsert,r=t.moreLength,a=t.more,c=n.map(function(t,n){var o="tv_online.items."+n,r=t.current.HHMM+"&nbsp;&nbsp;"+(t.current.title||t.current.subtitle||t.title),a="stream-control__link media-play__container media-service__item media-stream__item ";return a+=home.getBEMClassname("media-service__item",{mods:t.mods}),i("home-link",{attrs:{"data-stream-id":t.content_id,"data-stream-channel":t.channel_id,"data-from-block":"media-footer_stream_item"},href:i("stream-url",{streamChannel:t.channel_id,fromBlock:"media-footer_stream_item",streamId:t.content_id}),mods:{hover:"inherit"},target:"_blank",mix:a,stat:e.stat.getAttr(o,null,{logShow:!s}),content:i("media-stream__item-inner",{thumbnail:{"data-image":t.thumbnail},title:home.prepareSpaces(r),mediaPlay:i("media-play")})})}).join("");return r>0&&(a={mix:"stream-control__link",href:i("stream-url",{fromBlock:"media-footer_stream_more",streamDefault:1}),target:"_blank",attrs:{"data-from-block":"media-footer_stream_more","data-stream-default":1},stat:e.stat.getAttr("tv_online.more",null,{logShow:!s}),content:" "}),i("media-service",{block:"media-stream",rootMod:"i-bem media-stream stream-control",title:i("media-stream__title"),titleMix:"stream-control__link home-link_pseudo_yes",href:i("stream-url",{fromBlock:"media-footer_stream_title",streamDefault:1}),target:"_blank",titleAttrs:{role:"button",tabindex:0,"data-from-block":"media-footer_stream_title","data-stream-default":1},titleStat:e.stat.getAttr("tv_online.title",null,{logShow:!s}),content:i("media-stream__items-wrapper",{content:c}),mods:t.mods,more:a,attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({"media-stream":{live:!o},"stream-control":{}})}})}),s("media-stream__client-view",function(t,e,i){var n=home.getData("media-stream.data");if(n)return i("media-stream__content",n)}),s("media-stream__items-wrapper",function(t,e,i){return'<div class="media-service__panels media-stream__panels">'+(void 0!==t.content?t.content:"")+"</div>"}),s("media-stream__item-inner",function(t,e,i){var n;return'<div class="media-service__stream-bg media-service__shadow"><div class="media-service__image media-stream__thumbnail" '+home.parseRules.bem(t,e,"thumbnail.attrs")+"></div>"+(t.mediaPlay!==n?t.mediaPlay:"")+'</div><div class="media-service__item-title i-multiline-overflow">'+(t.title!==n?t.title:"")+"</div>"}),s("media-play",function(t,e,i){return i("media-play__layout",{mods:t&&t.mods||{}})}),s("media-play__layout",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"media-play.class")+'"></div>'}),s("sup-notice__default-ok-text",function(t,e){return" "}),s("sup-notice_type_default",function(t,e,i){return i("sup-notice__layout_type_default",{ok:i("button2",{mods:{theme:"action",size:"n",view:"default",tone:"default"},mix:"sup-notice__ok sup-notice__ok_type_default",content:i("sup-notice__default-ok-text")}),cancel:i("button2",{mods:{theme:"normal",size:"n",view:"default",tone:"default"},mix:"sup-notice__cancel sup-notice__cancel_type_default",content:", "})})}),s("sup-notice__layout_type_default",function(t,e,i){var n;return'<div class="sup-notice sup-notice_type_default sup-notice_hidden_yes i-bem"><div class="sup-notice__title">  </div><div class="sup-notice__text">     ,    .<br>     .      .</div><div class="sup-notice__buttons">'+(t.ok!==n?t.ok:"")+(t.cancel!==n?t.cancel:"")+"</div></div>"}),s("button2__icons",function(t,e,i){var n=[];return t.icon?n.push(i("button2__icon",{mod:t.icon})):t.iconObj&&n.push(i("icon",{mods:t.iconObj.mods,mix:"button2__icon"+(t.iconObj.mix?" "+t.iconObj.mix:"")})),t.iconLeft?n.push(i("button2__icon",{mod:"button2__icon_side_left "+t.iconLeft})):t.iconLeftObj&&n.push(i("icon",{mods:t.iconLeftObj.mods,mix:"button2__icon button2__icon_side_left"+(t.iconLeftObj.mix?" "+t.iconLeftObj.mix:"")})),t.iconRight?n.push(i("button2__icon",{mod:"button2__icon_side_right "+t.iconRight})):t.iconRightObj&&n.push(i("icon",{mods:t.iconRightObj.mods,mix:"button2__icon button2__icon_side_right"+(t.iconRightObj.mix?" "+t.iconRightObj.mix:"")})),n.join("")}),s("button2__default_mods",function(t,e,i){return"i-bem"}),s("button2",function(t,e,i){var n=t.mods||{},s=t.tag||"button",o=t.attrs||{};return t.url?s="a":t.tag&&(s=t.tag),n.theme||("yes"===n.pseudo?n.theme="pseudo":n.theme="normal"),o.role="button",t.tabindex&&(o.tabindex=t.tabindex),t.url?(o.href=t.url,t.target&&(o.target=t.target),n.disabled&&(o["aria-disabled"]=!0)):(o.type=t.type||"button",t.name&&(o.name=t.name),t.value&&(o.value=t.value),n.disabled&&(o.disabled="disabled")),n.view||(n.view="classic"),o["data-bem"]=home.getBEMParams({button2:t.js||{}}),"<"+s+' class="'+home.getBEMClassname("button2",{mods:n,mix:t.mix})+" "+i("button2__default_mods",t)+'"'+home.getAttributes(o)+(t.stat||"")+">"+i("button2__icons",t)+'<span class="button2__text"'+(t.text&&t.text.attrs?home.getAttributes(t.text.attrs):"")+">"+(t.content||"")+"</span></"+s+">"}),s("button2__icon",function(t,e,i){return'<span class="icon button2__icon '+(void 0!==t.mod?t.mod:"")+'" aria-hidden="true"></span>'}),s("sup-notice_type_popup",function(t,e,i){return i("sup-notice__layout_type_popup",{ok:i("button2",{mods:{theme:"action2",size:"n",view:"default"},mix:"sup-notice__ok sup-notice__ok_type_default",content:""}),cancel:i("button2",{mods:{theme:"clear",size:"n",view:"default"},mix:"sup-notice__cancel sup-notice__cancel_type_default",content:", "})})}),s("sup-notice__layout_type_popup",function(t,e,i){var n;return'<div class="sup-notice sup-notice_type_popup sup-notice_hidden_yes i-bem"><div class="sup-notice__text">      .</div><div class="sup-notice__buttons">'+(t.cancel!==n?t.cancel:"")+(t.ok!==n?t.ok:"")+"</div></div>"}),s("promo-sup-button__text",function(t){if(t.text)return'<div class="promo-sup-button__text">'+t.text+"</div>"}),s("promo-sup-button",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"promo-sup-button.class")+' i-bem" data-bem="'+home.parseRules.bem(t,e,"js")+'" title=""><svg class="promo-sup-button__icon" width="100%" height="100%" viewBox="0 0 18 18"><g fill="none"><path class="promo-sup-button__base" d="M2.5 14h13v-.382l-2-1V12l.002-3.938c-.152-2.44-1.12-4.02-3.262-4.596l-.74-.2V2h-1v1.267l-.74.199C5.669 4.028 4.658 5.66 4.5 8v4.618l-2 1V14z" stroke="#FFF" stroke-width="2"/><path class="promo-sup-button__base" d="M9 17c.986 0 1.5-.514 1.5-1.5V15h-3v.5c0 .986.514 1.5 1.5 1.5z" fill="#FFF"/><path class="promo-sup-button__path" d="M2.5 14h13v-.382l-2-1V12l.002-3.938c-.152-2.44-1.12-4.02-3.262-4.596l-.74-.2V2h-1v1.267l-.74.199C5.669 4.028 4.658 5.66 4.5 8v4.618l-2 1V14z" stroke="#FFF" stroke-width="2"/></g></svg><div class="promo-sup-button__icon-active"></div>'+(void 0!==(n=i("promo-sup-button__text",t))?n:"")+"</div>"}),s("infinity-zen__alert",function(t,e,i){var n;return'<div class="infinity-zen__alert"><div class="infinity-zen__alert-left"><div class="infinity-zen__alert-icon"></div></div><div class="infinity-zen__alert-right"><div class="infinity-zen__alert-title">'+(t.title!==n?t.title:"")+'</div><div class="infinity-zen__alert-text">'+(t.text!==n?t.text:"")+"</div></div></div>"}),s("hidden-blocks-popup__content",function(t,e,i){var n=Math.ceil(t.length/2),s=t.map(function(t){return i("hidden-blocks-popup__item",{layoutName:t.layoutName,tumbler:i("tumbler",{mods:{size:"n",tone:"grey",theme:"normal",view:"default"},content:[{side:"right",content:i("hidden-blocks-popup__item-label",{title:t.title,desc:t.desc})}]})})}),o=s.slice(0,n),r=s.slice(n);return i("hidden-blocks-popup__layout",{left:o.join(""),right:r.join(""),cancel:i("button",{mix:"hidden-blocks-popup__button hidden-blocks-popup__cancel",mods:{theme:"normal-sharp",size:"line"},content:""}),submit:i("button",{mix:"hidden-blocks-popup__button hidden-blocks-popup__submit",mods:{theme:"action-sharp",size:"line"},content:""})})}),s("hidden-blocks-popup__item-label",function(t,e,i){var n;return'<span class="hidden-blocks-popup__item-title">'+(t.title!==n?t.title:"")+'</span><span class="hidden-blocks-popup__item-desc">'+(t.desc!==n?t.desc:"")+"</span>"}),s("hidden-blocks-popup__item",function(t,e,i){var n;return'<div class="hidden-blocks-popup__item" data-layout-name="'+(t.layoutName!==n?t.layoutName:"")+'">'+(t.tumbler!==n?t.tumbler:"")+"</div>"}),s("hidden-blocks-popup__layout",function(t,e,i){var n,s;return'<div class="hidden-blocks-popup i-bem" data-bem="{&quot;hidden-blocks-popup&quot;:{}}"><div class="hidden-blocks-popup__inside"><h1 class="hidden-blocks-popup__title">  </h1><div class="hidden-blocks-popup__content"><div class="hidden-blocks-popup__column">'+(t.left!==s?t.left:"")+'</div><div class="hidden-blocks-popup__column">'+(t.right!==s?t.right:"")+'</div></div></div><div class="hidden-blocks-popup__buttons buttons-line buttons-line_border-bottom_no">'+(t.cancel!==s?t.cancel:"")+(t.submit!==s?t.submit:"")+"</div></div>"+((n=i("modal__close",t))!==s?n:"")}),s("modal",function(t,e,i){return i("popup2",{jsMix:{modal:{}},mix:home.getBEMClassname("modal",t),content:i("modal__layout",{content:t.content}),zIndexGroupLevel:t.zIndexGroupLevel||20,mods:{autoclosable:t.autoclosable}})}),s("modal__layout",function(t,e,i){return'<div class="modal__table"><div class="modal__cell"><div class="modal__content">'+(void 0!==t.content?t.content:"")+"</div></div></div>"}),s("modal__close",function(t,e,i){return'<div class="modal__close" role="button" tabindex="0" aria-label=""></div>'}),s("tumbler",function(t,e,i){var n=t.id||home.rnd(),s=void 0===t.content?[]:[].concat(t.content),o="",r="",a=function(t){"left"!==t.side&&"right"!==t.side&&home.error("tumbler:   option    side   left  right"),"left"===t.side&&(o=i("tumbler__option",t)),"right"===t.side&&(r=i("tumbler__option",t))},c=t.mods||{};c.view||(c.view="classic"),s[0]&&a(s[0]),s[1]&&a(s[1]);var l={values:[o.value||"false",r.value||"true"],view:c.view,name:t.name||n,leftId:o?"left"+n:void 0,rightId:r?"right"+n:void 0,tabindex:t.tabindex||0,checked:"yes"===c.checked,disabled:"yes"===c.disabled};return i("span",{mod:home.getBEMClassname("tumbler",{mix:"i-bem"+(t.mix?" "+t.mix:""),mods:c}),attrs:{"data-bem":home.getBEMParams({tumbler:home.deepExtend({live:!1},t.js||{})})},content:o+i("tumbler__box",l)+r+i("tumbler__input",l)})}),s("tumbler__box",function(t,e,i){return i("span",{mod:"tumbler__box",content:i("tumbler__sticker",{mods:{position:"left"},content:i("tumbler__sticker-label",{content:""})})+i("tumbler__sticker",{mods:{position:"right"},content:i("tumbler__sticker-label",{content:""})})+i("button2",{js:{prvntKeys:["ENTER"],clickKeys:["SPACE"]},mods:{view:"classic"===t.view?"classic":void 0,theme:"normal",disabled:t.disabled?"yes":void 0},tabindex:t.tabindex,attrs:{"aria-labelledby":t.leftId||t.rightId,"aria-pressed":t.checked},mix:"tumbler__button"})})}),s("tumbler__input",function(t,e,i){var n=t.checked?t.rightId||t.leftId:t.leftId||t.rightId;return i("tumbler__input-layout",{attrs:{"data-bem":home.getBEMParams({tumbler__input:{_values:t.values}}),name:t.name,checked:t.checked,value:t.values[Number(t.checked)],disabled:t.disabled,tabindex:-1,autocomplete:"off","aria-hidden":"true","aria-labelledby":n}})}),s("tumbler__input-layout",function(t,e,i){return'<input type="checkbox" class="tumbler__input"'+home.parseRules.bem(t,e,"attrs")+">"}),s("tumbler__sticker",function(t,e,i){return i("div",{mix:home.getBEMClassname("tumbler__sticker",{mods:t.mods}),attrs:{"aria-hidden":"true"},content:t.content})}),s("tumbler__sticker-label",function(t,e,i){return i("div",{mix:"tumbler__sticker-label",content:t.content})}),s("tumbler__option",function(t,e,i){return i("span",{mod:home.getBEMClassname("tumbler__label",{mods:{side:t.side}}),content:i("tumbler__text",{side:t.side,content:t.content})})}),s("tumbler__text",function(t,e,i){return i("span",{mod:home.getBEMClassname("tumbler__text",{mods:{side:t.side}}),content:t.content})}),s("mix-tabber-loader__retry-button",function(t,e,i){return i("button",{mods:t.buttonMods,mix:"mix-tabber-loader__retry-button "+t.block+"__retry-button",content:"  ",attrs:{"data-statlog":t.statRoot+".retry","data-key":t.key}})}),s("mix-tabber-loader__retry",function(t,e,i){var n,s;return'<div class="mix-tabber-loader__retry '+(t.block!==s?t.block:"")+'__retry">   '+((n=i("mix-tabber-loader__retry-button",t))!==s?n:"")+"</div>"}),s("kinopoisk__film-list",function(t,e,i){var n=home.transliterate(t.title.toLowerCase()).replace(/,/g,"").replace(/\s/g,"-"),s="kinopoisk.film."+n.replace(/-/g,"_");return t.films.map(function(o,r){var a="",c=r+1+(t.startIndex||0);return o.kpRating&&(a=i("kinopoisk-rating",{mix:"kinopoisk__film-rating",rating:o.kpRating})),i("kinopoisk__film",{rating:a,stat:e.stat.getClientCounter(s+"("+o.coId+"="+c+")"),title:home.prepareSpaces(o.title),poster:o.poster.replace("/orig","/"),bgColor:o.medianColor||"#dfdcd7",mediaPlay:i("media-play",{mods:{type:"kinopoisk"}}),attrs:{"data-film-id":o.contentGroupUuid,"data-selection-id":String(t.id),"data-from-block":n,"data-from-position":c,"data-stat":"kinopoisk.link"}})}).join("")}),s("kinopoisk__panel",function(t,e,i){return i("carousel",{mix:"kinopoisk__list-wrapper media-service__list-wrapper",wrapMix:"kinopoisk__wrap media-service__wrap",listMix:"kinopoisk__list media-service__list",content:t.films?i("kinopoisk__film-list",t):"",mods:{theme:"media","arrow-position":"weighted"},js:{carousel:{counter:"kinopoisk",step:680,offset:1120}}})}),s("kinopoisk__content",function(t,e,i){var n=t.retryButtonTheme,s=t.defaultTabId,o=t.data[s],r=t.groups,a=e.zenInsert,c=e.MediaFooterCollapsed||!1,l="kinopoisk_"+home.rnd().substr(0,5);return i("media-service",{block:"kinopoisk",rootMod:home.getBEMClassname("kinopoisk",t)+" i-bem kinopoisk-control media-grid__kinopoisk",mods:{"has-carousel":"yes",tabs:"yes"},title:t.title,titleMix:"kinopoisk-control__link home-link_pseudo_yes",titleAttrs:{"data-stat":"kinopoisk.link","data-selection-id":String(o.id),"data-from-block":"block_title",tabindex:0},titleStat:e.stat.getAttr("kinopoisk.title",null,{logShow:!c}),tabs:r.map(function(t){var n=t.default,s="kinopoisk.tab."+home.transliterate(t.title.toLowerCase()).replace(/,/g,"").replace(/\s/g,"-").replace(/-/g,"_");return i("mix-tabber__tab",{mods:{selected:n?"yes":"no"},mix:home.getBEMClassname("kinopoisk__tab",{mods:{selected:n?"yes":"no"}}),content:t.title,stat:e.stat.getAttr(s,null,{logShow:!c}),attrs:{tabindex:n?"0":"-1","aria-selected":n?"true":"false","aria-controls":n?l+"_panel_"+t.id:void 0,"data-key":t.id,id:l+"_tab_"+t.id}})}).join(""),content:i("kinopoisk__layout",{panel:i("mix-tabber__panel",{block:"kinopoisk",id:l,key:s,mix:" media-service__panel",attrs:{"aria-labelledby":l+"_tab_"+o.id},content:i("kinopoisk__panel",{id:o.id,title:o.title,films:o.films,logShow:!c,retryButtonTheme:n})})}),attrs:{role:"complementary","aria-label":t.title,"data-bem":home.getBEMParams({kinopoisk:{selectedTab:s,retryButtonTheme:n,live:!a,uniqId:l,country:t.country},"kinopoisk-control":{}})}})}),s("kinopoisk__client-view",function(t,e,i){var n=home.getData("kinopoisk.data");if(n)return i("kinopoisk__content",n)}),s("kinopoisk__film-loader",function(t,e,i){return'<div class="kinopoisk__film kinopoisk__film-loader"><div class="kinopoisk__film-loader-inner loader"></div></div>'}),s("kinopoisk__film",function(t,e,i){var n;return"<div"+(t.stat!==n?t.stat:"")+' class="kinopoisk__film media-service__item kinopoisk-control__link media-play__container"'+home.parseRules.bem(t,e,"attrs")+' role="listitem" tabindex="0"><span class="kinopoisk__film-inner"><span class="kinopoisk__film-bg media-service__bg media-service__shadow"><span class="kinopoisk__film-image media-service__image" data-image="'+(t.poster!==n?t.poster:"")+'" style="background-color:'+(t.bgColor!==n?t.bgColor:"")+'"></span>'+(t.rating!==n?t.rating:"")+(t.mediaPlay!==n?t.mediaPlay:"")+'</span></span><span class="kinopoisk__film-title media-service__item-title">'+(t.title!==n?t.title:"")+"</span></div>"}),s("kinopoisk__layout",function(t,e,i){return'<div class="media-service__panels kinopoisk__panels">'+(void 0!==t.panel?t.panel:"")+"</div>"}),s("kinopoisk-rating__color",function(t){var e=t.rating;return e>=8?"#32ba43":e>=7?"#89c939":e>=5?"#91a449":e>=3?"#85855d":"#727272"}),s("kinopoisk-rating",function(t,e,i){var n,s,o;return t.rating?(s=(n=parseFloat(t.rating)).toFixed(1).replace(".",","),o=" %s".replace("%s",s),i("kinopoisk-rating__tmpl",{mix:t.mix,text:s,label:o,color:i("kinopoisk-rating__color",{rating:n})})):""}),s("kinopoisk-rating__tmpl",function(t,e,i){var n;return'<span class="'+home.parseRules.bem(t,e,"kinopoisk-rating.class")+'" style="background-color:'+(t.color!==n?t.color:"")+';" aria-hidden="true">'+(t.text!==n?t.text:"")+'</span><span class="a11y-hidden">'+(t.label!==n?t.label:"")+"</span>"}),s("select2",function(t,e,i){var n=t.mods||{},s=t.items,o=[],r=[],a=t.val,c=t.text,l=t.content;if(s.forEach(function t(e){e.items?e.items.forEach(t):(r.push(e),o.push(e.val))},this),a=void 0===a?[]:[].concat(a).filter(function(t){return-1!==o.indexOf(t)}),-1!==["radio","radiocheck"].indexOf(n.type)&&(a.length>1?a=a.slice(-1):a&&a.length||"radio"!==n.type||(a=r[0]&&[r[0].val])),void 0===c&&(c=""),void 0===l){var h=Boolean(a.length),u=h&&-1!==["check","radiocheck"].indexOf(n.type);c="fixed"!==n.width&&h?r.reduce(function(t,e){return-1!==a.indexOf(e.val)&&t.push(e.text),t},[]).join(", "):c,!h&&"radio"===n.type&&s[0]&&(s[0]=function t(e){return e.items?e.items=[t(e.items[0])].concat(e.items.slice(1)):(e.elemMods=Object(e.elemMods),e.elemMods.checked="yes"),e}(s[0]),c=r[0].text),l=[i("select2__button",{multiselectable:"check"===n.type,required:t.required,items:r,val:a,button:home.deepExtend({mods:{size:n.size,theme:n.theme,view:n.view,tone:n.tone,disabled:n.disabled,checked:u?"yes":void 0},content:c},t.button||{})}),t.control&&i("select2__control",home.deepExtend({mods:n,elemMods:{disabled:n.disabled},multiple:"radio"!==n.type,required:t.required,name:t.name,items:r,val:a},t.control&&"object"==typeof t.control||{})),i("select2__popup",{popup:home.deepExtend({mods:{view:n.view,tone:n.tone}},t.popup),itemIconHidden:Boolean(n["item-icon-hidden"]),menu:home.deepExtend({mods:{size:n.menuSize||n.size,type:n.type,view:n.view,tone:n.tone,disabled:n.disabled},val:a,items:s},t.menu)})].filter(Boolean).join("")}return i("select2__layout",{mix:t.mix,mods:n,attrs:t.attrs,content:l,js:{select2:home.deepExtend({text:c},t.js||{})}})}),s("select2__layout",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"select2.class")+' i-bem"'+home.parseRules.bem(t,e,"attrs")+' data-bem="'+home.parseRules.bem(t,e,"js")+'"'+home.parseRules.bem(t,e,"attrs")+">"+(void 0!==t.content?t.content:"")+"</div>"}),s("select2__button",function(t,e,i){var n,s=home.rnd(),o=t.button||{};return t.items.some(function(e){return!!(t.val.indexOf(e.val)>-1&&e.icon)&&(n=e.icon,!0)}),i("button2",home.deepExtend({mods:{width:"max"},attrs:{role:"listbox","aria-labelledby":s,"aria-expanded":"false","aria-multiselectable":t.multiselectable?"true":void 0},iconLeftObj:n,iconRightObj:"default"===o.mods.view?{mods:{size:o.mods.size,glyph:"carets-v"},mix:"select2__arrow"}:"",mix:{block:"select2",elem:"button",elemMods:t.mods,js:t.js},text:{attrs:{id:s}},content:t.text},o))}),s("select2__menu",function(t,e,i){var n=t.mods||{};return n["item-icon-hidden"]=t.itemIconHidden?"yes":void 0,i("menu",home.deepExtend({mix:{block:"select2",elem:"menu",elemMods:n},mods:{theme:"normal",width:"max"},val:t.val,tabindex:null},t.menu))}),s("select2__popup",function(t,e,i){var n=t.mods||{};return i("popup2",home.deepExtend({mods:{theme:"normal",target:"anchor",hiding:"yes",autoclosable:"yes"},mainOffset:"default"===n.view?2:void 0,mix:{block:"select2",elem:"popup",elemMods:t.mods,js:t.js},directions:["bottom-left","bottom-right","top-left","top-right"],content:i("select2__menu",{itemIconHidden:t.itemIconHidden,menu:t.menu})},t.popup))}),s("select2__control",function(t,e,i){var n=t.mods||{},s=t.content;if(void 0===s){var o=t.val,r=Boolean(n.native);s=t.items.map(function(t){return i("select2__control-option",{attrs:{value:t.val,disabled:Boolean((t.elemMods||{}).disabled),selected:-1!==o.indexOf(t.val)?"selected":void 0},content:r?home.htmlFilter(t.text):void 0})}).join("")}return i("select2__control-layout",{attrs:{name:t.name,tabindex:"-1",multiple:t.multiple,required:t.required,disabled:Boolean(n.disabled)},content:s})}),s("select2__control-option",function(t,e,i){return"<option"+home.parseRules.bem(t,e,"attrs")+">"+(void 0!==t.content?t.content:"")+"</option>"}),s("select2__control-layout",function(t,e,i){return'<select class="'+home.parseRules.bem(t,e,"select2__control.class")+'"'+home.parseRules.bem(t,e,"attrs")+">"+(void 0!==t.content?t.content:"")+"</select>"}),s("afisha-event-film",function(t,e,i){var n=t.event||{},s=Boolean(t.dummy),o=(t.mix||"")+" afisha-event-film",r={imageMix:t.imageMix||"",imageAttrs:t.imageAttrs||{}};return s?(o+=" afisha-event-film_dummy",r.content=i("span",{mod:"afisha-event-film__dummy-text"})):(r.imageAttrs["data-image"]||(r.imageMix+=" afisha-event-film__image_empty_"+Math.floor(5*Math.random())),r.content=i("span",{mod:"afisha-event-film__title",content:home.prepareSpaces(n.full||n.name)})+i("span",{mod:"afisha-event-film__genre",content:n.genre||""})),n.release&&(n.premiere_badge=""),r.premiere=n.premiere_badge?i("span",{mod:"afisha-event-film__premiere",content:home.capitalize(n.premiere_badge.toLowerCase())}):"",i("home-link",{href:t.href,mix:o,stat:t.stat,content:i("afisha-event-film__layout",r)})}),s("afisha-event-film__layout",function(t,e,i){var n;return'<span class="afisha-event-film__image-wrapper"><span class="afisha-event-film__image '+(t.imageMix!==n?t.imageMix:"")+'"'+home.parseRules.bem(t,e,"imageAttrs.attrs")+"></span>"+(t.premiere!==n?t.premiere:"")+'</span><span class="afisha-event-film__content">'+(t.content!==n?t.content:"")+"</span>"}),s("afisha-event-show__dates",function(t,e,i){var n=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],s=t.dates,o=[],r=[];function a(t){var e=new Date(t);isNaN(e.valueOf())||(o.push(e.getMonth()),r.push(e.getDate()))}return a(s[0]),s[0].split("-")[1]===s[s.length-1].split("-")[1]?(a(s[1]),o.length=1):(a(s[s.length-1]),r.length=0),i("span",{mod:"afisha-event-show__date afisha-event-show__date_days_"+r.length,content:(r.length?i("span",{mod:"afisha-event-show__day",content:r.join(", ")}):"")+o.map(function(t){return i("span",{mod:"afisha-event-show__month",content:e.l10n("months_short_genetive."+n[t])})}).join("")})}),s("afisha-event-show",function(t,e,i){var n=t.event||{},s=Boolean(t.dummy),o=(t.mix||"")+" afisha-event-show",r={innerMix:t.innerMix||"",imageMix:t.imageMix||"",imageAttrs:t.imageAttrs||{}};if(n.place||(n.place="    "),n.title&&n.description&&n.place&&(o+=" afisha-event-show_content_full"),n.price){var a=n.price/100;r.price=i("span",{mod:"afisha-event-show__price",content:" %s".replace("%s",a+" "+i("rouble",{}))})}return s?(o+=" afisha-event-show_dummy",r.content=i("span",{mod:"afisha-event-show__dummy-text"})):(!r.imageAttrs["data-image"]&&n.type&&(r.imageMix+="afisha-event-show__image_empty_"+n.type+"_"+Math.floor(4*Math.random())),r.dates=Array.isArray(n.dates)&&n.dates.length?i("afisha-event-show__dates",{dates:n.dates}):"",r.content=["title","description","place"].reduce(function(t,e){return n[e]&&(t+=i("span",{mod:"afisha-event-show__"+e,content:n[e]})),t},"")),i("home-link",{mix:o,href:t.href,stat:t.stat,content:i("afisha-event-show__layout",r)})}),s("afisha-event-show__layout",function(t,e,i){var n;return'<span class="afisha-event-show__inner '+(t.innerMix!==n?t.innerMix:"")+'"><span class="afisha-event-show__image '+(t.imageMix!==n?t.imageMix:"")+'" '+home.parseRules.bem(t,e,"imageAttrs.attrs")+"></span>"+(t.price!==n?t.price:"")+'<span class="afisha-event-show__content"><span class="afisha-event-show__text">'+(t.content!==n?t.content:"")+"</span>"+(t.dates!==n?t.dates:"")+"</span></span>"}),s("rouble",function(t,e,i){return'<span class="rouble'+(void 0!==t.mod?t.mod:"")+'"></span>'}),s("afisha-inserts__panel-shows",function(t,e,i){var n,s="afisha_inserts.link."+t.key+".all";return t.events&&t.events.length?(e.stat.logShow(s),n=t.events.map(function(n){var o;return n.image_url&&(o=n.image_url.raw?n.image_url.raw:{base:n.image_url}),n.type=t.key,i("afisha-event-show",{href:n.url,mix:"afisha-inserts__event afisha-inserts__event_type_show media-service__item home-link_hover_inherit",innerMix:"media-service__shadow",imageMix:"media-service__image",imageAttrs:{"data-image":o?home.htmlFilter("string"==typeof o?o:JSON.stringify(o)):void 0},stat:e.stat.getAttr(s,null,{logShow:!1}),event:n})}).join(""),i("afisha-inserts__carousel",{content:n,js:{counter:"afisha_inserts",step:840,offset:1062}})):i("afisha-inserts__panel-empty",{content:n=",     "})}),s("afisha-inserts__carousel",function(t,e,i){var n="afisha-inserts";return i("carousel",{mix:n+"__list-wrapper media-service__list-wrapper",wrapMix:n+"__wrap media-service__wrap",listMix:n+"__list media-service__list",content:t.content,mods:{theme:"media","arrow-position":"weighted"},js:{carousel:t.js}})}),s("afisha-inserts__panel-cinema",function(t,e,i){var n,s="afisha_inserts.link.cinema."+("cinema"===t.key?"all":"fav");return t.events&&t.events.length?(e.stat.logShow(s),n=t.events.map(function(t){var n,o;return(n=t.posters&&Object.keys(t.posters).length)&&(o=t.posters.base?{base:t.posters.base}:t.posters.raw?t.posters.raw:t.posters),t.genre=(t.genre||"").toLowerCase(),i("afisha-event-film",{href:t.href,mix:"afisha-inserts__event afisha-inserts__event_type_film media-service__item home-link_hover_inherit",imageMix:"media-service__shadow media-service__image",imageAttrs:{"data-image":n?home.htmlFilter("string"==typeof o?o:JSON.stringify(o)):void 0},stat:e.stat.getAttr(s,null,{logShow:!1}),event:t})}).join(""),i("afisha-inserts__carousel",{content:n,js:{counter:"afisha_inserts",step:680,offset:1120}})):(n="    ",t.cinema&&t.cinema.href&&(n+=i("button2",{mix:"afisha-inserts__no-films-link",mods:{theme:"normal",size:"s"},content:"  ",url:home.addQueryToUrl(t.cinema.href,{"schedule-preset":"tomorrow"}),stat:e.stat.getAttr("afisha_inserts.no_timetable")})),i("afisha-inserts__panel-empty",{content:n}))}),s("afisha-inserts__tabs",function(t,e,i){var n=[],s=t.tabs||[];return s.length>0&&(s=[{id:"cinema"}].concat(s)),s.forEach(function(s){var o=s.id===t.defaultTab,r=s.title||e.l10n("afisha."+s.id);n.push(i("mix-tabber__tab",{mods:{selected:o?"yes":"no"},mix:home.getBEMClassname("afisha-inserts__tab",{mods:{selected:o?"yes":"no"}}),content:r,stat:e.stat.getAttr("afisha_inserts.tab."+s.id,null,{logShow:!1}),attrs:{tabindex:o?0:-1,"aria-selected":o?"true":"false","aria-controls":o?"afisha-inserts_panel_"+s.id:void 0,"data-key":s.id,id:"afisha-inserts_tab_"+s.id}}))}),n}),s("afisha-inserts__title",function(t,e){return""}),s("afisha-inserts__content",function(t,e,i){var n=t.retryButtonTheme,s=e.zenInsert,o=t.afisha.events,r=i("afisha-inserts__tabs",{tabs:t.afisha.tabs,defaultTab:"cinema"}),a="afisha-inserts_"+home.rnd().substr(0,5);return t.mods=t.mods||{},i("media-service",{block:"afisha-inserts",rootMod:home.getBEMClassname("afisha-inserts",t)+" i-bem media-grid__afisha-inserts",mods:{"has-carousel":"yes",tabs:r.length>1?"yes":void 0},href:t.href,title:i("afisha-inserts__title"),titleStat:e.stat.getAttr("afisha_inserts.title"),tabs:r.join("")||" ",content:i("afisha-inserts__layout",{panelId:a+"_panels",panel:i("mix-tabber__panel",{block:"afisha-inserts",id:a,key:"cinema",mix:" media-service__panel",attrs:{"aria-labelledby":a+"_tab_cinema"},content:i("afisha-inserts__panel-cinema",{key:"cinema",events:o})})}),attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({"afisha-inserts":{selectedKey:"cinema",retryButtonTheme:n,live:!s,uniqId:a,logged:t.logged,geoId:t.geoId,locale:t.locale,geohelperHost:t.geohelperHost,nativeSelect:Boolean(t.nativeSelect)}})}})}),s("afisha-inserts__client-view",function(t,e,i){var n=home.getData("afisha-inserts.data");if(n)return i("afisha-inserts__content",n)}),s("afisha-inserts__panel-empty",function(t,e,i){return'<div class="afisha-inserts__panel-empty"><div class="afisha-inserts__panel-empty-center">'+(void 0!==t.content?t.content:"")+"</div></div>"}),s("afisha-inserts__fav-icon",function(t,e,i){return'<svg class="afisha-inserts__fav-icon" width="14" height="14" viewBox="0 0 14 14"><path d="M2 13.38V1h10v12.38L7 9.67" clip-rule="evenodd" fill-rule="evenodd"/></svg>'}),s("afisha-inserts__layout",function(t,e,i){var n;return'<div class="media-service__panels afisha-inserts__panels" id="'+(t.panelId!==n?t.panelId:"")+'">'+(t.panel!==n?t.panel:"")+"</div>"}),s("mix-tabber-select",function(t,e,i){return t.mix=t.mix||"",t.mix+=" mix-tabber__select",i("select2",t)}),s("icon_glyph_afisha-fav",function(t,e,i){return'<svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="12" height="16"><path d="M2 1h8a1 1 0 0 1 1 1v11.96a.5.5 0 0 1-.812.39L6 11l-4.188 3.35A.5.5 0 0 1 1 13.96V2a1 1 0 0 1 1-1z" fill-rule="evenodd"/></svg>'}),s("icon_glyph_carets-v",function(t,e,i){return'<svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="8" height="14" viewBox="0 0 8 14"><path d="M4 0l4 6H0l4-6zm0 14l4-6H0l4 6z"/></svg>'}),s("icon_glyph_type-check",function(t,e,i){return'<svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="16" height="10" viewBox="0 0 16 10"><path d="M7.207 7.506L3.629 3.81 2.343 4.939l4.841 5.002 8.462-8.428L14.382.362z"/></svg>'}),s("district-inserts__title",function(t,e){return"uz"===e.MordaZone?"":" "}),s("district-inserts__panel",function(t,e,i){var n="district-inserts",s=t.exp&&t.exp.district_pic,o=t.data.map(function(t,n){var o=t.user||{},r=o.avatar_url||i("avatar__href",{});return i("home-link",{href:t.url,mods:{hover:"inherit"},mix:"district-inserts__post district-inserts__post_visible_no media-service__item",stat:e.stat.getAttr("district_inserts.link."+n,null,{customParams:{id:t.id}}),attrs:{"data-post-id":t.id},content:i("district-inserts__post",{avatar:r,name:home.htmlFilter(o.display_name),address:home.htmlFilter(t.district),text:home.htmlFilter(t.text),postImg:s&&t.image?i("district-inserts__post-img",{img:t.image+(i("retina-scale__is-big")?"/s136x136_crop":"/s68x68_crop"),mods:{many:t.images_count>1?"yes":""}}):"",comments:t.comments_cnt&&i("district-inserts__post-footer-item",{type:"comments",count:t.comments_cnt})||"",images:!s&&t.images_count&&i("district-inserts__post-footer-item",{type:"images",count:t.images_count})||"",likes:i("district-inserts__post-footer-item",{type:"likes",count:t.likes_cnt}),dislikes:i("district-inserts__post-footer-item",{type:"dislikes",count:t.dislikes_cnt})})})}).join("");return i("carousel",{mix:n+"__list-wrapper media-service__list-wrapper",wrapMix:n+"__wrap media-service__wrap",listMix:n+"__list media-service__list",content:o,mods:{theme:"media"},js:{carousel:{counter:"district_inserts",step:552}}})}),s("district-inserts__content",function(t,e,i){var n=e.zenInsert,s="ru";return"uz"!==e.MordaZone&&"by"!==e.MordaZone||(s=e.MordaZone),i("media-service",{block:"district-inserts",rootMod:home.getBEMClassname("district-inserts",t)+" i-bem media-grid__district-inserts",mods:{"has-carousel":"yes"},href:t.url+"?utm_source=main&utm_medium=zenpromoblock&from=home",title:i("district-inserts__title",t),titleStat:e.stat.getAttr("district_inserts.title",null,{customParams:{rtxreqid:t.rtxreqid}}),"title-after":i("home-link",{content:i("district-inserts__compose",t),href:"https://yandex."+s+"/local/create?utm_source=main&utm_medium=zenpromoblock&utm_content=write&from=home",stat:e.stat.getAttr("district_inserts.compose"),mix:"home-link_gray_yes district-inserts__compose"}),content:i("district-inserts__layout",{panel:i("district-inserts__panel",t)}),attrs:{role:"complementary","aria-label":" ","data-bem":home.getBEMParams({"district-inserts":{live:!n}})}})}),s("district-inserts__client-view",function(t,e,i){var n=home.getData("district-inserts.data");if(n)return i("district-inserts__content",n)}),s("district-inserts__post-img",function(t,e,i){return'<span class="'+home.parseRules.bem(t,e,"district-inserts__post-img.class")+'" style="background-image:url('+(void 0!==t.img?t.img:"")+')"></span>'}),s("district-inserts__compose",function(t,e,i){return'<span class="district-inserts__compose-icon"><svg class="district-inserts__compose-icon-svg" width="16" height="16"><path fill-rule="evenodd" d="M14 0l2 2-8 8-3 1 1-3 8-8zM0 2h5v2H2v10h10v-4h2v6H0V2z"/></svg></span> '}),s("district-inserts__post-footer-item",function(t,e,i){var n;return'<span class="district-inserts__post-footer-item"><span class="district-inserts__post-icon district-inserts__post-icon_type_'+(t.type!==n?t.type:"")+'"></span>'+(t.count!==n?t.count:"")+"</span>"}),s("district-inserts__post",function(t,e,i){var n;return'<span class="district-inserts__post-inner media-service__bg media-service__shadow"><span class="district-inserts__post-header"><span class="district-inserts__post-avatar" style="background-image:url('+(t.avatar!==n?t.avatar:"")+')"></span><span class="district-inserts__post-header-texts"><span class="district-inserts__post-name">'+(t.name!==n?t.name:"")+'</span><span class="district-inserts__post-address">'+(t.address!==n?t.address:"")+"</span></span></span>"+(t.postImg!==n?t.postImg:"")+'<span class="district-inserts__post-text i-multiline-overflow">'+(t.text!==n?t.text:"")+'</span><span class="district-inserts__post-footer"><span class="district-inserts__post-footer-left">'+(t.comments!==n?t.comments:"")+(t.images!==n?t.images:"")+'</span><span class="district-inserts__post-footer-right">'+(t.likes!==n?t.likes:"")+(t.dislikes!==n?t.dislikes:"")+"</span></span></span>"}),s("district-inserts__layout",function(t,e,i){return'<div class="media-service__panels district-inserts__panels"><div class="media-service__panel district-inserts__panel">'+(void 0!==t.panel?t.panel:"")+"</div></div>"}),s("news-inserts__items",function(t,e,i){return t.items.map(function(t,n){var s=t.picture&&t.picture.url&&t.picture.width>=120;return i("news-inserts__item",{mods:{img:s?"yes":void 0,text:t.text?"yes":void 0},href:t.url,stat:e.stat.getClientCounter("news_inserts.item."+n+"(id="+t.id+")"),image:s?i("news-inserts__item-img",{img:t.picture.url}):"",title:home.htmlFilter(t.title||""),text:s?"":home.htmlFilter(t.text||"")})}).join("")}),s("news-inserts__panel",function(t,e,i){var n="news-inserts",s="";return"dummy"===t.id?s=t.items:t.items&&(s=i("news-inserts__items",t)),i("carousel",{mix:n+"__list-wrapper media-service__list-wrapper",wrapMix:n+"__wrap media-service__wrap",listMix:n+"__list media-service__list",content:s,mods:{theme:"media"},js:{carousel:{counter:"news_inserts",step:704}}})}),s("news-inserts__title",function(t,e){return""}),s("news-inserts",function(t,e,i){return i("media-service",{block:"news-inserts",rootMod:home.getBEMClassname("news-inserts",t)+" i-bem media-grid__news-inserts",mods:{"has-carousel":"yes"},href:t.url,title:i("news-inserts__title"),titleStat:t.url&&e.stat.getAttr("news_inserts.title"),content:i("news-inserts__layout",{panel:i("news-inserts__panel",t)}),attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({"news-inserts":{}})}})}),s("news-inserts__client-view",function(t,e,i){var n=home.getData("news-inserts.data");if(n)return i("news-inserts-loader",n)}),s("news-inserts__item_dummy",function(t,e,i){return'<div class="news-inserts__item news-inserts__item_dummy_yes"><span class="news-inserts__item-inner media-service__bg media-service__shadow"><span class="news-inserts__item-img"></span><span class="news-inserts__item-dummy-text"></span></span></div>'}),s("news-inserts__item-img",function(t,e,i){return'<div class="news-inserts__item-img media-service__image" data-image="'+(void 0!==t.img?t.img:"")+'"></div>'}),s("news-inserts__item",function(t,e,i){var n;return'<a class="'+home.parseRules.bem(t,e,"news-inserts__item.class")+' media-service__item" href="'+(t.href!==n?t.href:"")+'"'+(t.stat!==n?t.stat:"")+'><span class="news-inserts__item-inner media-service__bg media-service__shadow">'+(t.image!==n?t.image:"")+'<span class="news-inserts__item-title i-multiline-overflow">'+(t.title!==n?t.title:"")+'</span><span class="news-inserts__item-text i-multiline-overflow">'+(t.text!==n?t.text:"")+"</span></span></a>"}),s("news-inserts__layout",function(t,e,i){return'<div class="media-service__panels news-inserts__panels"><div class="media-service__panel news-inserts__panel">'+(void 0!==t.panel?t.panel:"")+"</div></div>"}),s("news-inserts-loader",function(t,e,i){var n,s=[];for(n=0;n<5;++n)s.push(i("news-inserts__item_dummy",{}));return i("media-service",{block:"news-inserts",rootMod:home.getBEMClassname("news-inserts-loader",{mods:{state:"loading"}})+" i-bem media-grid__news-inserts",mods:{"has-carousel":"yes"},title:"",content:i("news-inserts__layout",{panel:i("news-inserts__panel",{id:"dummy",items:s.join("")})}),attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({"news-inserts-loader":{url:home.makeUrl({path:"/portal/api/data/1/",query:{block:"news_inserts",content:"api_data_big",lang:t.Locale,news_exp:t.flags}})}})}})}),s("cashback__panel",function(t,e,i){var n,s="cashback.link."+t.id;return n=t.elements.map(function(t){return i("home-link",{href:t.action_url,mods:{hover:"inherit"},mix:"cashback__item media-service__item",stat:e.stat.getAttr(s+"(id="+home.htmlFilter(t.id)+")",null,{logShow:!1}),content:i("cashback__item",{title:home.htmlFilter(t.title.trim()),image:{"data-image":t.sq_image_url?home.htmlFilter(JSON.stringify(t.sq_image_url)):void 0},imageMod:t.sq_image_url?"":" cashback__item-image_none",profit:home.htmlFilter(t.profit||"").replace(//g,i("rouble",{}))})})}).join(""),e.stat.logShow(s),i("carousel",{mix:"cashback__list-wrapper media-service__list-wrapper",wrapMix:"cashback__wrap media-service__wrap",listMix:"cashback__list media-service__list",content:n,mods:{theme:"media"},js:{carousel:{counter:"cashback",step:680,offset:1120}}})}),s("cashback__tab",function(t,e,i){var n=t.isSelected,s=t.id,o="cashback.tab."+t.key;return i("mix-tabber__tab",{mods:{selected:n?"yes":"no"},mix:home.getBEMClassname("cashback__tab",{mods:{selected:n?"yes":"no"}}),content:t.title,stat:e.stat.getAttr(o),attrs:{tabindex:n?"0":"-1","aria-selected":n?"true":"false","aria-controls":n?s+"_panel_"+t.key:void 0,"data-key":t.key,id:s+"_tab_"+t.key}})}),s("cashback__title",function(t,e){return""}),s("cashback__content",function(t,e,i){var n=t.retryButtonTheme,s=e.zenInsert,o=t.tabs,r=o[0],a=t.data[r],c="cashback_"+home.rnd().substr(0,5);return i("media-service",{block:"cashback",rootMod:home.getBEMClassname("cashback",t)+" i-bem media-grid__cashback",mods:{"has-carousel":"yes",tabs:o.length>1?"yes":void 0},href:t.href,title:i("cashback__title"),titleStat:e.stat.getAttr("cashback.title"),tabs:o.map(function(e,n){return i("cashback__tab",{isSelected:0===n,id:c,key:e,title:home.htmlFilter(t.data[e].title||"")})}).join(""),content:i("cashback__layout",{panel:i("mix-tabber__panel",{block:"cashback",id:c,key:r,mix:" media-service__panel",attrs:{"aria-labelledby":c+"_tab_"+r},content:i("cashback__panel",{id:r,elements:a.elements})})}),attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({cashback:{selectedTab:r,retryButtonTheme:n,live:!s,uniqId:c,logged:t.logged,geoId:t.geoId,locale:t.locale,geohelperHost:t.geohelperHost}})}})}),s("cashback__client-view",function(t,e,i){var n=home.getData("cashback.data");if(n)return i("cashback__content",n)}),s("cashback__item",function(t,e,i){var n;return'<span class="cashback__item-inner media-service__bg media-service__shadow"><span class="cashback__item-image media-service__image'+(t.imageMod!==n?t.imageMod:"")+'"'+home.parseRules.bem(t,e,"image.attrs")+'></span><span class="cashback__item-title media-service__item-title i-multiline-overflow">'+(t.title!==n?t.title:"")+'</span><span class="cashback__item-profit">'+(t.profit!==n?t.profit:"")+"</span></span>"}),s("cashback__layout",function(t,e,i){return'<div class="media-service__panels cashback__panels">'+(void 0!==t.panel?t.panel:"")+"</div>"}),s("stream-inserts__carousel-id",function(t,e,i){var n=i("stream-inserts__params")||{};return n[t.layoutName]&&n[t.layoutName].carouselId}),s("stream-inserts__item",function(t,e,i){var n=t.item||{},s=t.streamInserts||{},o=t.counter||"",r="",a=s[t.carousel_id];return r="horizontal"===t.type?t.dummy?i("stream-inserts__horizontal-card-dummy",{mix:"media-service__shadow media-service__bg stream-inserts__item_dummy_yes",mods:{dummy:"yes"}}):i("stream-inserts__horizontal-card",{mods:t.mods,item:n,mix:"media-service__shadow media-service__bg",thumbMix:"media-service__image"}):i("stream-inserts__item-inner",{poster:home.getAttributes({"data-image":n.onto_poster&&n.onto_poster.replace(/(\/get-vh\/.+?)\/orig$/,"$1/400x300")}),bgColorStyle:home.getAttributes({style:"background-color: "+(n.main_color||"#dfdcd7")}),mediaPlay:i("media-play",{mods:{type:"kinopoisk"}}),title:home.prepareSpaces(n.title),rating:n.rating_kp?i("kinopoisk-rating",{mix:"kinopoisk__film-rating",rating:n.rating_kp}):""}),i("home-link",{href:i("stream-url",{fromBlock:a,streamId:n.content_id}),attrs:{"data-stream-id":n.content_id,"data-from-block":a,tabindex:0},mods:{hover:"inherit"},target:"_blank",mix:"stream-inserts__item media-service__item media-play__container stream-control stream-control__link"+("horizontal"===t.type?" stream-inserts__item_type_horizontal":""),stat:e.stat.getAttr(o,null,{logShow:!1}),content:r})}),s("stream-inserts__item-list",function(t,e,i){var n=t.set||[],s=i("stream-inserts__categories-to-insert-name-map"),o=i("stream-inserts__stat-root",t.carousel_id)+".item";return!1!==t.logShow&&e.stat.logShow(o),n.map(function(e){return i("stream-inserts__item",{item:e,type:t.type,counter:o,streamInserts:s,carousel_id:t.carousel_id})}).join("")}),s("stream-inserts__content",function(t,e,i){var n="stream-inserts";return i("stream-inserts__layout",{content:i("carousel",{mix:n+"__list-wrapper media-service__list-wrapper",wrapMix:n+"__wrap media-service__wrap",listMix:n+"__list media-service__list",content:t.dummyItems?t.dummyItems:i("stream-inserts__item-list",t),mods:{theme:"media","arrow-position":"weighted"},js:{carousel:{counter:t.carousel_id&&i("stream-inserts__stat-root",t.carousel_id),step:"horizontal"===t.type?816:680}}})})}),s("stream-inserts",function(t,e,i){var n=i("stream-inserts__categories-to-insert-name-map"),s=i("stream-inserts__stat-root",t.carousel_id),o=t.headerCategories||{},r=n[t.carousel_id],a={fromBlock:r,streamDefault:1},c={"data-from-block":r,"data-stream-default":1},l=t.carousel_id.toLowerCase();return o[t.carousel_id]&&(c["data-stream-active"]="category",c["data-stream-category"]=o[t.carousel_id],a.streamActive="category",a.streamCategory=o[t.carousel_id]),i("media-service",{block:"stream-inserts",rootMod:"stream-inserts i-bem stream-control"+("horizontal"===t.type?" stream-inserts_type_horizontal":""),title:home.l10n("stream.inserts."+l),mods:{"has-carousel":"yes"},href:i("stream-url",a),titleAttrs:c,titleMix:"stream-control__link home-link_pseudo_yes",titleStat:e.stat.getAttr(s+".title"),content:i("stream-inserts__content",t),target:"_blank",attrs:{role:"complementary","aria-label":home.l10n("stream.inserts."+t.carousel_id.toLowerCase()),"data-bem":home.getBEMParams({"stream-inserts":{live:!1}})}})}),s("stream-inserts__stat-root",function(t,e,i){return i("stream-inserts__categories-to-insert-name-map")[t]||""}),s.cached("stream-inserts__params",function(){return{stream_inserts_mixed:{carouselId:"ChFDQVRFR19NSVhFRF9WSURFTxIFbW9yZGE=",type:"horizontal",exp:"inserts_stream_mixed"},stream_inserts_films:{carouselId:"CATEG_FILM",exp:"zen_inserts_stream"},stream_inserts_series:{carouselId:"CATEG_SERIES",exp:"zen_inserts_stream"},stream_inserts_anim_films:{carouselId:"CATEG_ANIM_FILM",exp:"zen_inserts_stream"},stream_inserts_anim_series:{carouselId:"CATEG_ANIM_SERIES",exp:"zen_inserts_stream"}}}),s.cached("stream-inserts__categories-to-insert-name-map",function(t,e){var i=e("stream-inserts__params"),n={};for(var s in i)i.hasOwnProperty(s)&&(n[i[s].carouselId]=s);return n}),s("stream-inserts__zen-insert-shared",function(t,e,i){var n=home.getData("stream-inserts.data");if(n)return n.carouselId=t.carouselId,n.type=t.type,i("stream-inserts-loader",{params:n})}),s("stream-inserts__client-view",function(t,e,i){var n=i("stream-inserts__params");return n[t.params.layoutName]?i("stream-inserts__zen-insert-shared",{carouselId:n[t.params.layoutName].carouselId,type:n[t.params.layoutName].type}):""}),s("stream-inserts__item-inner",function(t,e,i){var n;return'<span class="stream-inserts__item-inner"><span class="stream-inserts__item-bg media-service__bg media-service__shadow"><span class="stream-inserts__item-image media-service__image" '+(t.poster!==n?t.poster:"")+" "+(t.bgColorStyle!==n?t.bgColorStyle:"")+"></span>"+(t.rating!==n?t.rating:"")+(t.mediaPlay!==n?t.mediaPlay:"")+'</span></span><span class="stream-inserts__item-title media-service__item-title">'+(t.title!==n?t.title:"")+"</span>"}),s("stream-inserts__layout",function(t,e,i){return'<div class="media-service__panels stream-inserts__panels"><div class="media-service__panel stream-inserts__panel">'+(void 0!==t.content?t.content:"")+"</div></div>"}),s("stream-url",function(t,e,i){(t=t||{}).streamDefault&&!t.streamChannel&&(t.streamChannel="default");var n,s,o=home.getData("stream.stream.clientData.settings",i("stream-settings")),r=o.streamPath,a=o.streamPaths,c=o.streamSharePath,l=o.streamRetPath,h=o.homePageNoArgs||"",u=o.streamFrom,d=o.streamYellowSkin,m=o.streamYellowSkinParams,p=t.from||u,f={stream_active:t.streamActive,stream_id:t.streamId,stream_channel:t.streamChannel,stream_category:t.streamCategory,from_block:t.fromBlock,from:p},_=r,g=home.parseUrl(h);if(t.path&&void 0!==a[t.path]&&(_=a[t.path]),t.isSharing&&(n=g.host,s="https",_=c),t.isRetPath){var v=o.sk,b=o.inframe;n=g.host,s="https",_=l,v&&b&&(f.sk=v,f.inframe=b)}(t.withHost||d)&&(n=g.host,s="https");var y=home.makeUrl({scheme:s,host:n,path:_,query:f});return d?home.yellowskin(m,y):y}),s("stream-inserts__horizontal-card",function(t,e,i){var n,s=t.item||{},o=s.channel||{},r=parseInt(e.Timestamp||home.now&&home.now()/1e3,10),a=r>=s.start_time&&r<=s.end_time,c=s.onto_poster||o.thumbnail,l="",h="",u=[],d=i("stream-thumbnail__src",{thumbnail:s.thumbnail}),m=home.getAttributes({style:"background-color: "+(s.main_color||"#dfdcd7")}),p=i("stream-duration",{item:s});return c&&(l=i("stream-thumbnail__src",{thumbnail:c}),c=i("stream-inserts__horizontal-card-poster",{mods:{vertical:s.onto_poster?"yes":void 0},thumbMix:t.thumbMix,poster:home.getAttributes({"data-image":l}),bgColorStyle:m,rating:s.rating_kp?i("kinopoisk-rating",{mix:"stream-inserts__horizontal-card-rating",rating:s.rating_kp}):""})),a&&u.push(i("stream-inserts__horizontal-card-badge",{mods:{live:"yes"},badge:" "})),s.meta&&s.meta.superres&&(h=i("stream-inserts__horizontal-card-dhd",{firstLetter:"dHD"[0],text:"dHD".slice(1)})),(p||h)&&u.push(i("stream-inserts__horizontal-card-badge",{badge:(p?home.formatDuration(p):"")+(p&&h?"&nbsp;":"")+h})),n=o.title||i("stream-meta",{release_year:s.release_year,genres:s.genres}),i("stream-inserts__horizontal-card-layout",{mix:t.mix,attrs:t.attrs||{},thumb:home.getAttributes({"data-image":d}),mods:{poster:c?"yes":void 0,subtitle:n?"yes":"no"},thumbMix:t.thumbMix,poster:c||"",bgColorStyle:m,badges:u.join(""),title:s.title,titleMix:n?"":" i-multiline-overflow",subtitle:n?i("stream-inserts__horizontal-card-subtitle",{text:n}):""})}),s("stream-inserts__horizontal-card-dhd",function(t,e,i){var n;return'<span class="stream-inserts__horizontal-card-dhd"><span class="stream-inserts__horizontal-card-light">'+(t.firstLetter!==n?t.firstLetter:"")+"</span>"+(t.text!==n?t.text:"")+"</span>"}),s("stream-inserts__horizontal-card-badge",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"stream-inserts__horizontal-card-badge.class")+'">'+(void 0!==t.badge?t.badge:"")+"</div>"}),s("stream-inserts__horizontal-card-poster",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"stream-inserts__horizontal-card-poster.class")+" "+(t.thumbMix!==n?t.thumbMix:"")+'" '+(t.bgColorStyle!==n?t.bgColorStyle:"")+" "+(t.poster!==n?t.poster:"")+">"+(t.rating!==n?t.rating:"")+"</div>"}),s("stream-inserts__horizontal-card-dummy",function(t,e,i){return'<div class="'+home.parseRules.bem(t,e,"stream-inserts__horizontal-card.class")+'"><div class="stream-inserts__horizontal-card-image"></div><div class="stream-inserts__horizontal-card-text"></div></div>'}),s("stream-inserts__horizontal-card-subtitle",function(t,e,i){return'<div class="stream-inserts__horizontal-card-subtitle">'+(void 0!==t.text?t.text:"")+"</div>"}),s("stream-inserts__horizontal-card-layout",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"stream-inserts__horizontal-card.class")+'" '+home.parseRules.bem(t,e,"attrs")+'><div class="stream-inserts__horizontal-card-image '+(t.thumbMix!==n?t.thumbMix:"")+'" '+(t.thumb!==n?t.thumb:"")+" "+(t.bgColorStyle!==n?t.bgColorStyle:"")+">"+(t.poster!==n?t.poster:"")+'<div class="stream-inserts__horizontal-card-badges">'+(t.badges!==n?t.badges:"")+'</div></div><div class="stream-inserts__horizontal-card-text"><div class="stream-inserts__horizontal-card-title'+(t.titleMix!==n?t.titleMix:"")+'">'+(t.title!==n?t.title:"")+"</div>"+(t.subtitle!==n?t.subtitle:"")+"</div></div>"}),s("stream-thumbnail__src",function(t){var e=t.thumbnail,i=t.autoretina,n=Math.round("undefined"!=typeof window&&window.devicePixelRatio)||1;if(e)return((n-=1)>1||!i)&&(n=1),-1!==e.indexOf("/get-vh/")&&(e=e.replace(/(\/get-vh\/.+?)\/orig$/,"$1/"+["200x150","400x300"][n])),-1!==e.indexOf("/get-ott/")&&(e=e.replace(/(\/get-ott\/.+?)\/orig$/,"$1/448x292")),e}),s("stream-thumbnail",function(t,e,i){var n=i("stream-thumbnail__src",t);if(n)return"background-image:url("+n+")"}),s("stream-meta__upperCase",function(t){return t[0].toUpperCase()+t.substring(1)}),s("stream-meta",function(t,e,i){var n=t.mods||{},s=[];return t.release_year&&(n["year-badge"]&&String((new Date).getFullYear())===t.release_year?s.push(i("stream-meta-badge",{year:i("stream-meta__upperCase",t.release_year)})):s.push(i("stream-meta__upperCase",t.release_year))),t.onto_category&&s.push(i("stream-meta__upperCase",e.l10n("stream.card.category."+t.onto_category))),t.genres&&s.push(i("stream-meta__upperCase",t.genres.join(", "))),s.length?s.join(" &middot; "):""}),s("stream-duration",function(t){var e=t.item||{},i=e.start?e.start():e.start_time,n=e.end?e.end():e.end_time,s=e.duration;return e.release_date_ut&&(i=e.release_date_ut),i&&n&&!s&&(s=n-i),s}),s("stream-inserts-loader",function(t,e,i){var n,s="horizontal"===t.params.type,o=[],r=s?4:8,a=t.params.carouselId,c=a.toLowerCase(),l=e.l10n("stream.inserts."+c),h=i("stream-inserts__categories-to-insert-name-map");for(n=0;n<r;++n)o.push(i("stream-inserts__item",{dummy:!0,type:t.params.type}));return i("media-service",{block:"stream-inserts",rootMod:"stream-inserts-loader i-bem media-grid__stream-inserts-loader media-grid__"+h[a]+(s?" stream-inserts_type_horizontal":""),title:l,titleAttrs:{tabindex:0},content:i("stream-inserts__content",{dummyItems:o.join("")}),attrs:{role:"complementary","aria-label":l,"data-bem":home.getBEMParams({"stream-inserts-loader":t.params})}})}),s("edadeal__retailer-list",function(t,e,i){var n="edadeal.retailer."+t.id;return!1!==t.logShow&&e.stat.logShow(n),t.retailers.map(function(t){return i("edadeal__retailer",{stat:e.stat.getAttr(n,null,{logShow:!1}),title:t.title,logo:t.logo,href:t.url,distance:t.distance&&i("dist",{dist:t.distance}),discount:t.discount})}).join("")}),s("edadeal__panel",function(t,e,i){var n=t.retailers?i("edadeal__retailer-list",t):"";return i("carousel",{mix:"edadeal__list-wrapper media-service__list-wrapper",wrapMix:"edadeal__wrap media-service__wrap",listMix:"edadeal__list media-service__list"+(t.distance?"":" edadeal__list_distance_no"),content:n,mods:{theme:"media"},js:{carousel:{counter:"edadeal",step:680,offset:1120}}})}),s("edadeal__content",function(t,e,i){var n=t.defaultTabId,s=t.data[n],o=t.groups,r=e.zenInsert,a=e.MediaFooterCollapsed||!1,c="edadeal_"+home.rnd().substr(0,5),l=o.length>1&&o.map(function(t){var n=t.default,s="edadeal.tab."+t.id;return i("mix-tabber__tab",{mods:{selected:n?"yes":"no"},mix:home.getBEMClassname("edadeal__tab",{mods:{selected:n?"yes":"no"}}),content:t.title,stat:e.stat.getAttr(s,null,{logShow:!a}),attrs:{tabindex:n?"0":"-1","aria-selected":n?"true":"false","aria-controls":n?c+"_panel_"+t.id:void 0,"data-key":t.id,id:c+"_tab_"+t.id}})}).join("")||"";return i("media-service",{block:"edadeal",rootMod:home.getBEMClassname("edadeal",t)+" i-bem media-grid__edadeal",mods:{"has-carousel":"yes",tabs:l.length>1?"yes":void 0},href:t.url,title:t.title,titleMix:"edadeal-control__link home-link_pseudo_yes",titleStat:e.stat.getAttr("edadeal.title.link",null,{logShow:!a}),tabs:l,content:i("edadeal__layout",{panel:i("mix-tabber__panel",{block:"edadeal",id:c,key:n,mix:" media-service__panel",attrs:{"aria-labelledby":c+"_tab_"+s.id},content:i("edadeal__panel",{id:s.id,distance:s.hasGeolocation,title:s.title,retailers:s.retailers,logShow:!a})})}),attrs:{role:"complementary","aria-label":"  ","data-bem":home.getBEMParams({edadeal:{live:!r,selectedKey:n}})}})}),s("edadeal__client-view",function(t,e,i){var n=home.getData("edadeal.data");if(n)return i("edadeal__content",n)}),s("edadeal__retailer",function(t,e,i){var n;return"<a "+(t.stat!==n?t.stat:"")+'class="edadeal__retailer media-service__bg media-service__shadow media-service__item"'+home.parseRules.bem(t,e,"attrs")+'href="'+(t.href!==n?t.href:"")+'" role="listitem"><div class="edadeal__logo-wrapper"><div class="edadeal__logo media-service__image" data-image="'+(t.logo!==n?t.logo:"")+'"></div></div><div class="edadeal__retailer-title i-multiline-overflow">'+(t.title!==n?t.title:"")+'</div><div class="edadeal__footer"><div class="edadeal__discount"><span class="edadeal__discount-text"> '+(t.discount!==n?t.discount:"")+'%</span></div><div class="edadeal__distance">'+(t.distance!==n?t.distance:"")+"</div></div></a>"}),s("edadeal__layout",function(t,e,i){return'<div class="media-service__panels edadeal__panels">'+(void 0!==t.panel?t.panel:"")+"</div>"}),s("dist",function(t,e){var i=t.dist,n=void 0===t.theme?"normal":"";return i>949?(i/=1e3,i+=1e-6,i=home.stringf("%s&nbsp;",i.toFixed(1))):(i<100&&(i=100),i=home.stringf("%s&nbsp;",100*Math.round(i/100))),'<span class="dist'+(t.mod?" "+t.mod:"")+("normal"===n?" dist_theme_normal":"")+'">'+i+"</span>"}),s("widgets-list__title",function(t,e){return" "}),s("widgets-list__content",function(t,e,i){var n,s="widgets-list",o=e.zenInsert;return t.mods={many:t.list.length>3?"yes":"no",promo:t.promo?"yes":void 0},n=t.list.map(function(t){return i("widgets-list__item",{html:t})}).join(""),t.services&&(n+=i("widgets-list__services",{list:t.services,wide:t.services.length>5})),i("media-service",{block:"widgets-list",rootMod:home.getBEMClassname("widgets-list",t)+" i-bem media-grid__widgets-list",title:i("widgets-list__title",t),titleStat:e.stat.getAttr("widgets_list.title"),mods:{"has-carousel":"yes"},before:t.promo&&i("widgets-list__promo",t.promo)||"",content:i("widgets-list__list",{content:i("carousel",{mix:s+"__list-wrapper media-service__list-wrapper",wrapMix:s+"__wrap media-service__wrap",listMix:s+"__list media-service__list",content:n,mods:{theme:"media"},js:{carousel:{counter:"widgets_list",step:552}}})}),attrs:{role:"complementary","aria-label":" ","data-bem":home.getBEMParams({"widgets-list":{live:!o&&!t.promo,promo:t.promo&&{show_url:t.promo.show_url,close_url:t.promo.close_url}}})}})}),s("widgets-list__client-view",function(t,e,i){var n=home.getData("widgets-list.data");if(n)return i("widgets-list__content",n)}),s("widgets-list__item",function(t,e,i){return'<div class="widgets-list__item">'+(void 0!==t.html?t.html:"")+"</div>"}),s("widgets-list__list",function(t,e,i){return'<div class="media-service__panels widgets-list__panels"><div class="media-service__panel widgets-list__panel">'+(void 0!==t.content?t.content:"")+"</div></div>"}),s("widgets-list__promo",function(t,e,i){return'<div class="widgets-list__promo"><div class="widgets-list__promo-title">     </div><div class="widgets-list__promo-text">-                 ,     .</div><div class="widgets-list__promo-image" role="img" aria-hidden="true"></div><div class="widgets-list__promo-close" role="button" tabindex="0" title=""></div></div>'}),s("widgets-list__services-item",function(t,e,i){if(!t)return i("widgets-list__services-item-empty");var n="widgets_list.services."+t.id;return e.stat.logShow(n),i("widgets-list__services-item-layout",{icon:i("home-link",{content:"",href:t.url,stat:e.stat.getAttr(n,null,{logShow:!1}),mix:"widgets-list__services-icon widgets-list__services-icon_id_"+t.id,attrs:{"aria-hidden":"true"}}),title:i("home-link",{content:t.title,href:t.url,stat:e.stat.getAttr(n,null,{logShow:!1}),mix:"home-link_blue_yes widgets-list__services-title"}),subtitle:i("home-link",{content:home.capitalize(t.subtitle.text),href:t.subtitle.url,stat:e.stat.getAttr(n,null,{logShow:!1}),mix:"home-link_black_yes widgets-list__services-subtitle"})})}),s("widgets-list__services",function(t,e,i){var n,s,o="",r=[];t.list.forEach(function(t){t.icon&&t.icon_svg?o+=".widgets-list__services-icon_id_"+t.id+"{background-image:url("+t.icon_svg+");}.i-ua_inlinesvg_no .widgets-list__services-icon_id_"+t.id+"{background-image:url("+t.icon+");}":o+=".widgets-list__services-icon_id_"+t.id+"{background-image:url("+(t.icon_svg||t.icon)+");}"}),s=t.wide?Math.ceil(t.list.length/2):t.list.length;for(var a=0;a<s;++a)n=i("widgets-list__services-item",t.list[a]),t.wide&&(n+=i("widgets-list__services-item",t.list[a+s])),r.push(i("widgets-list__services-row",{cells:n}));return i("widgets-list__services-layout",{mods:{wide:t.wide?"yes":void 0},style:o,rows:r.join("")})}),s("widgets-list__services-item-empty",function(t,e,i){return'<div class="widgets-list__services-item"></div>'}),s("widgets-list__services-item-layout",function(t,e,i){var n;return'<div class="widgets-list__services-item"><div class="widgets-list__services-item-inner">'+(t.icon!==n?t.icon:"")+'<div class="widgets-list__services-texts">'+(t.title!==n?t.title:"")+(t.subtitle!==n?t.subtitle:"")+"</div></div></div>"}),s("widgets-list__services-row",function(t,e,i){return'<div class="widgets-list__services-row">'+(void 0!==t.cells?t.cells:"")+"</div>"}),s("widgets-list__services-layout",function(t,e,i){var n;return'<div class="'+home.parseRules.bem(t,e,"widgets-list__services-layout.class")+'"><style>'+(t.style!==n?t.style:"")+'</style><div class="widgets-list__services-table">'+(t.rows!==n?t.rows:"")+"</div></div>"}),s("geo-collections__panel",function(t,e,i){var n="geo-collections",s="";return"dummy"===t.id?s=t.items:t.items&&(s=i("geo-collections-items",t)),i("carousel",{mix:n+"__list-wrapper media-service__list-wrapper",wrapMix:n+"__wrap media-service__wrap",listMix:n+"__list media-service__list",content:s,mods:{theme:"media"},js:{carousel:{counter:"geo_collections",step:888}}})}),s("geo-collections__title",function(t,e){return"   "}),s("geo-collections",function(t,e,i){var n,s="geo-collections_"+home.rnd().substr(0,5),o={};return t.tabs.forEach(function(e){var i=home.deepExtend({},e);i.collections=i.collectionsItems.map(function(e){return t.collections[e]}),o[e.key]=i}),n=o[t.tabs[0].key],i("media-service",{block:"geo-collections",rootMod:home.getBEMClassname("geo-collections",t)+" i-bem media-grid__collections",mods:{"has-carousel":"yes",tabs:t.tabs.length>1?"yes":void 0},href:t.title.url,title:i("geo-collections__title"),titleAttrs:{tabindex:0},titleStat:e.stat.getAttr("geo_collections.title"),tabs:t.tabs.map(function(t,n){var o=0===n;return i("mix-tabber__tab",{mods:{selected:o?"yes":"no"},mix:home.getBEMClassname("geo-collections__tab",{mods:{selected:o?"yes":"no"}}),content:t.title,stat:e.stat.getAttr("geo_collections."+t.key),attrs:{tabindex:o?"0":"-1","aria-selected":o?"true":"false","aria-controls":o?s+"_panel_"+t.key:void 0,"data-key":t.key,id:s+"_tab_"+t.key}})}).join(""),content:i("geo-collections__layout",{panel:i("mix-tabber__panel",{block:"geo-collections",id:s,key:n.key,mix:" media-service__panel",attrs:{"aria-labelledby":s+"_tab_"+n.key},content:i("geo-collections__panel",{id:n.key,items:n.collections})})}),attrs:{role:"complementary","aria-label":"   ","data-bem":home.getBEMParams({"geo-collections":{data:o,live:!1,uniqId:s}})}})}),s("geo-collections__client-view",function(t,e,i){var n=home.getData("geo-collections.data");if(n)return i("geo-collections-loader",n)}),s("geo-collections__item-partner",function(t,e,i){var n;return'<div class="geo-collections__item-partner"><span class="geo-collections__item-partner-icon media-service__image" data-image="'+(t.icon!==n?t.icon:"")+'"><span class="geo-collections__item-partner-icon-placeholder"></span></span><span class="geo-collections__item-partner-name">'+(t.name!==n?t.name:"")+"</span></div>"}),s("geo-collections__item_dummy",function(t,e,i){return'<div class="geo-collections__item geo-collections__item_dummy_yes media-service__shadow"><div class="geo-collections__item-header"></div><div class="geo-collections__item-content geo-collections__item-content_dummy"><div class="geo-collections__item-placeholder"></div><div class="geo-collections__item-placeholder"></div><div class="geo-collections__item-placeholder geo-collections__item-placeholder_source"></div></div></div>'}),s("geo-collections__item",function(t,e,i){var n;return'<a class="geo-collections__item media-service__item media-service__shadow" href="'+(t.href!==n?t.href:"")+'"'+(t.stat!==n?t.stat:"")+'><div class="geo-collections__item-header"><div class="geo-collections__item-img media-service__image" data-image="'+(t.img!==n?t.img:"")+'"></div><span class="geo-collections__item-category">'+(t.category!==n?t.category:"")+'</span></div><div class="geo-collections__item-content"><div class="geo-collections__item-title i-multiline-overflow">'+(t.title!==n?t.title:"")+"</div>"+(t.partner!==n?t.partner:"")+"</div></a>"}),s("geo-collections__layout",function(t,e,i){return'<div class="media-service__panels geo-collections__panels">'+(void 0!==t.panel?t.panel:"")+"</div>"}),s("geo-collections-items",function(t,e,i){return t.items.map(function(n,s){return i("geo-collections__item",{href:n.url,stat:e.stat.getAttr("geo_collections.item."+t.id+"."+s),img:home.stringf(n.image.urlTemplate,"L"),title:n.title,category:n.rubric,partner:i("geo-collections__item-partner",{name:n.partner.title,icon:home.stringf(n.partner.icon.urlTemplate,"XXXS")})})}).join("")}),s("geo-collections-loader",function(t,e,i){var n="geo-collections_"+home.rnd().substr(0,5),s=Array(5).join(i("mix-tabber__tab",{mix:home.getBEMClassname("geo-collections__tab",{mods:{dummy:"yes"}}),content:"&nbsp;",stat:""})),o=Array(5).join(i("geo-collections__item_dummy",{}));return i("media-service",{block:"geo-collections",rootMod:home.getBEMClassname("geo-collections-loader",{mods:{state:"loading"}})+" i-bem media-grid__geo-collections",title:"   ",titleAttrs:{tabindex:0},mods:{"has-carousel":"yes",tabs:"yes"},tabs:s,content:i("geo-collections__layout",{panel:i("mix-tabber__panel",{block:"geo-collections",id:n,key:"dummy",mix:" media-service__panel",attrs:{"aria-labelledby":n+"_tab_dummy"},content:i("geo-collections__panel",{mix:"geo-collections-loader__panel",id:"dummy",items:o})})}),attrs:{role:"complementary","aria-label":"   ","data-bem":home.getBEMParams({"geo-collections-loader":{url:t.url}})}})}),s("market-media__format-price",function(t,e,i){var n=t.currency.name||"";return"RUR"===t.currency.id&&(n=i("rouble",{})),home.formatNumber(t.price)+"&nbsp;"+n}),s("market-media__minimize-photo-size",function(t){return"9hq"===t.slice(-3)?t.replace("9hq","4hq"):t}),s("market-media__title",function(t,e){return""}),s("market-media__items",function(t,e,i){return t.models.map(function(n){return i("home-link",{href:n.link,mix:"market-media__item media-service__item",mods:{color:"inherit",hover:"inherit"},stat:e.stat.getAttr("market_media.item"),content:i("market-media__item",{img:i("market-media__minimize-photo-size",n.photoUrl),price:i("market-media__format-price",{price:n.price,currency:t.currency}),title:n.title})})}).join("")}),s("market-media__panel",function(t,e,i){var n="market-media",s="";return"dummy"===t.id?s=t.items:t.models&&(s=i("market-media__items",t)),i("carousel",{mix:n+"__list-wrapper media-service__list-wrapper",wrapMix:n+"__wrap media-service__wrap",listMix:n+"__list media-service__list",content:s,mods:{theme:"media"},js:{carousel:{counter:"market-media",step:408}}})}),s("market-media",function(t,e,i){return i("media-service",{block:"market-media",mods:{"has-carousel":"yes"},rootMod:home.getBEMClassname("market-media",t)+" i-bem media-grid__market",href:t.marketUrl,title:i("market-media__title"),titleStat:e.stat.getAttr("market_media.title"),content:i("market-media__layout",{panel:i("market-media__panel",t)}),attrs:{role:"complementary","aria-label":i("market-media__title")}})}),s("market-media__client-view",function(t,e,i){var n=home.getData("market-media.data");if(n)return i("market-media-loader",n)}),s("market-media__item",function(t,e,i){var n;return'<span class="market-media__item-inner media-service__shadow"><span class="market-media__item-header"><span class="market-media__item-img media-service__image" data-image="'+(t.img!==n?t.img:"")+'"></span></span><span class="market-media__item-content"><span class="market-media__item-price">'+(t.price!==n?t.price:"")+'</span><span class="market-media__item-title i-multiline-overflow">'+(t.title!==n?t.title:"")+"</span></span></span>"}),s("market-media__layout",function(t,e,i){return'<div class="media-service__panels market-media__panels"><div class="media-service__panel market-media__panel">'+(void 0!==t.panel?t.panel:"")+"</div></div>"}),s("market-media-loader",function(t,e,i){var n=Array(11).join(i("market-media__item_dummy",{}));return i("media-service",{block:"market-media",rootMod:home.getBEMClassname("market-media-loader",{mods:{state:"loading"}})+" i-bem media-grid__market-media",mods:{"has-carousel":"yes"},title:"",titleAttrs:{tabindex:0},collapsedText:"  ",content:i("market-media__layout",{panel:i("market-media__panel",{id:"dummy",items:n})}),attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({"market-media-loader":{url:t.url}})}})}),s("collections__image-type",function(t){var e=[{name:"vertical",size:"280x404"},{name:"square",size:"404x404"},{name:"horizontal",size:"300x192"}];t.exclude&&(e=e.filter(function(e){return e.name!==t.exclude}));var i=Math.round(Math.random()*(e.length-1));return t.prev&&e[i].name===t.prev.name&&(i=i<e.length-1?i+1:i-1),e[i]}),s("collections__feed-items",function(t,e,i){var n,s=null;return t.list.map(function(o,r){var a,c,l,h,u,d=r===t.list.length-1;return a=s?n:i("collections__image-type",{prev:n,exclude:d&&!s?"horizontal":""}),n=a,c=i("collections__feed-item",{mod:" collections__feed-item_type_"+a.name,stat:e.stat.getClientCounter("collections.feed."+r+"(id="+o.channel_id+")"),img:o.images[a.size],href:o.card_link,title:home.htmlFilter((h=o.title||"",u=30,h.length>u&&(h=h.substr(0,u-1).replace(/\s+$/,"")+""),h)),color:o.color_wiz.back}),"horizontal"!==a.name||s?(l=i("collections__column",{items:(s||"")+c}),s=null):(l="",s=c),l}).join("")}),s("collections__items",function(t,e,i){return t.list.map(function(t,n){return i("collections__item",{href:t.link,stat:e.stat.getClientCounter("collections.channel."+n+"(id="+t.channel_id+")"),color1:t.color_wiz.back,color2:home.color(t.color_wiz.back).lighter(40),img:t.image||t.images["296x296"],title:home.htmlFilter(t.title||"")})}).join("")}),s("collections__panel",function(t,e,i){var n="collections",s="";return"dummy"===t.id?s=t.items:t.list&&(s="channels"===t.id?i("collections__items",t):i("collections__feed-items",t)),i("carousel",{mix:n+"__list-wrapper media-service__list-wrapper",wrapMix:n+"__wrap media-service__wrap",listMix:n+"__list media-service__list",content:s,mods:{theme:"media","arrow-position":"weighted"},js:{carousel:{counter:"collections",step:746,offset:1120}}})}),s("collections__title",function(t,e){return""}),s("collections",function(t,e,i){var n="collections_"+home.rnd().substr(0,5),s=t.list[0],o={};return t.list.forEach(function(t){o[t.id]=t}),i("media-service",{block:"collections",rootMod:home.getBEMClassname("collections",t)+" i-bem media-grid__collections",mods:{"has-carousel":"yes",tabs:t.list.length?"yes":void 0},href:t.url,title:i("collections__title"),titleAttrs:{tabindex:0},titleStat:e.stat.getAttr("collections.title"),tabs:t.list.map(function(t,s){var o=0===s;return i("mix-tabber__tab",{mods:{selected:o?"yes":"no"},mix:home.getBEMClassname("collections__tab",{mods:{selected:o?"yes":"no"}}),content:t.title,stat:e.stat.getAttr("collections."+t.id),attrs:{tabindex:o?"0":"-1","aria-selected":o?"true":"false","aria-controls":o?n+"_panel_"+t.id:void 0,"data-key":t.id,id:n+"_tab_"+t.id}})}).join(""),content:i("collections__layout",{panel:i("mix-tabber__panel",{block:"collections",id:n,key:s.id,mix:" media-service__panel",attrs:{"aria-labelledby":n+"_tab_"+s.id},content:i("collections__panel",{id:s.id,list:s.list})})}),attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({collections:{data:o,live:!1,uniqId:n}})}})}),s("collections__client-view",function(t,e,i){var n=home.getData("collections.data");if(n)return i("collections-loader",n)}),s("collections__column",function(t,e,i){return'<div class="collections__column">'+(void 0!==t.items?t.items:"")+"</div>"}),s("collections__feed-item",function(t,e,i){var n;return'<a class="collections__feed-item media-service__item'+(t.mod!==n?t.mod:"")+'" href="'+(t.href!==n?t.href:"")+'"'+(t.stat!==n?t.stat:"")+' aria-label="'+(t.title!==n?t.title:"")+'"><div class="collections__feed-img media-service__image media-service__bg media-service__shadow" data-image="'+(t.img!==n?t.img:"")+'" style="background-color:'+(t.color!==n?t.color:"")+'"></div></a>'}),s("collections__item_dummy",function(t,e,i){return'<div class="collections__item collections__item_dummy_yes"><div class="collections__item-shadows collections__item-shadows_2"></div><div class="collections__item-shadows collections__item-shadows_1"></div><div class="collections__item-img"></div><div class="collections__item-title media-service__item-title i-multiline-overflow"></div></div>'}),s("collections__item",function(t,e,i){var n;return'<a class="collections__item media-service__item" href="'+(t.href!==n?t.href:"")+'"'+(t.stat!==n?t.stat:"")+'><div class="collections__item-shadows collections__item-shadows_2" style="background-color:'+(t.color2!==n?t.color2:"")+'"></div><div class="collections__item-shadows collections__item-shadows_1" style="background-color:'+(t.color1!==n?t.color1:"")+'"></div><div class="collections__item-img media-service__image media-service__bg  media-service__shadow" data-image="'+(t.img!==n?t.img:"")+'" style="background-color:'+(t.color1!==n?t.color1:"")+'"></div><div class="collections__item-title media-service__item-title i-multiline-overflow">'+(t.title!==n?t.title:"")+"</div></a>"}),s("collections__layout",function(t,e,i){return'<div class="media-service__panels collections__panels">'+(void 0!==t.panel?t.panel:"")+"</div>"}),s("collections-loader",function(t,e,i){var n,s="collections_"+home.rnd().substr(0,5),o=[],r=[];for(n=0;n<2;++n)o.push(i("mix-tabber__tab",{mix:home.getBEMClassname("geo-collections__tab",{mods:{dummy:"yes"}}),content:"&nbsp;"}));for(n=0;n<5;++n)r.push(i("collections__item_dummy",{}));return i("media-service",{block:"collections",rootMod:home.getBEMClassname("collections-loader",{mods:{state:"loading"}})+" i-bem media-grid__collections",mods:{"has-carousel":"yes",tabs:"yes"},title:"",tabs:o.join(""),content:i("collections__layout",{panel:i("mix-tabber__panel",{block:"collections",id:s,key:"dummy",mix:" media-service__panel",attrs:{"aria-labelledby":s+"_tab_dummy"},content:i("collections__panel",{mix:"collections-loader__panel",id:"dummy",items:r.join("")})})}),attrs:{role:"complementary","aria-label":"","data-bem":home.getBEMParams({"collections-loader":{locale:t.Locale}})}})}),s("tutor-card",function(t,e,i){var n=t.mods||{},s=t.mix||"",o=i("tutor-card__layout",{title:t.title,text:t.text.replace("<br>"," <br>"),innerMix:t.innerMix||"",imageMix:t.imageMix||"",imageAttrs:t.imageAttrs||{}});return n.black="yes",i("home-link",{href:t.href,stat:t.stat||"",mods:n,mix:"tutor-card "+s,content:o})}),s("tutor-card__layout",function(t,e,i){var n;return'<span class="tutor-card__inner '+(t.innerMix!==n?t.innerMix:"")+'"><span class="tutor-card__image-wrapper"><span class="tutor-card__image '+(t.imageMix!==n?t.imageMix:"")+'" '+home.parseRules.bem(t,e,"imageAttrs.attrs")+'></span></span><span class="tutor-card__content"><span class="tutor-card__title i-multiline-overflow">'+(t.title!==n?t.title:"")+'</span><span class="tutor-card__text i-multiline-overflow">'+(t.text!==n?t.text:"")+"</span></span></span>"}),s("tutor__tabs",function(t,e,i){return(t.tabs||[]).map(function(n,s){var o=s===t.defaultTab;return i("mix-tabber__tab",{mix:home.getBEMClassname("tutor__tab",{mods:{selected:o?"yes":"no"}}),mods:{selected:o?"yes":"no"},content:n.title,stat:e.stat.getAttr("tutor.tab."+s),attrs:{tabindex:o?"0":"-1","aria-selected":o?"true":"false","aria-controls":o?"tutor_panel_"+s:void 0,"data-key":s,id:"tutor_tab_"+s}})}).join("")}),s("tutor__panel",function(t,e,i){var n=(t.cards||[]).map(function(t,n){var s=t.icons||[];return i("tutor-card",{title:t.title,text:t.text,href:t.url,mix:"tutor__card media-service__item",innerMix:"media-service__shadow",mods:{hover:"inherit"},stat:e.stat.getAttr("tutor.link."+n),imageMix:"media-service__image",imageAttrs:{"data-image":home.getBEMParams({1:s[0],2:s[2]})}})}).join("");return i("carousel",{mix:"tutor__list-wrapper media-service__list-wrapper",wrapMix:"tutor__wrap media-service__wrap",listMix:"tutor__list media-service__list",mods:{theme:"media"},js:{carousel:{counter:"tutor",step:816}},content:n})}),s("tutor__content",function(t,e,i){var n=e.zenInsert,s=t.tabs.map(function(t,e){return i("mix-tabber__panel",{block:"tutor",id:"tutor",key:e,mix:" media-service__panel",content:i("tutor__panel",{key:e,cards:t.cards}),attrs:{style:0===e?"":"display: none;","aria-labelledby":"tutor_tab_"+e}})}).join("");return i("media-service",{block:"tutor",rootMod:"tutor media-grid__tutor i-bem",href:t.href,title:i("tutor__title"),titleStat:e.stat.getAttr("tutor.title"),mods:{"has-carousel":"yes",tabs:t.tabs.length>1?"yes":void 0},tabs:i("tutor__tabs",{tabs:t.tabs,defaultTab:0}),content:i("tutor__layout",{panels:s}),attrs:{role:"complementary","aria-label":t.title,"data-bem":home.getBEMParams({tutor:{live:!n,uniqId:"tutor",selectedKey:0}})}})}),s("tutor__title",function(t,e){return""}),s("tutor__client-view",function(t,e,i){var n=home.getData("tutor.data");return n&&i("tutor__content",n)}),s("tutor__layout",function(t,e,i){return'<div class="media-service__panels tutor__panels">'+(void 0!==t.panels?t.panels:"")+"</div>"})}();if(window.Ya&&Ya.Rum){Ya.Rum.sendTimeMark("2095.1428");}