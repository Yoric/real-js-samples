var MyPage={_SET_OPTION:{ON:"ON",OFF:"OFF",TOGGLE:"TOGGLE"},_bCheckAll:null,_bCheck:null,_bSelectedAll:null,init:function(){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();null!=jindo.$Element("btn_mod_"+currentPanelName)&&(this._applyEventTogglingEditMode(),this._applyEventSelectAllCheckBox(),this._applyEventDeleteSelected())},initEvent:function(){var welContainer=jindo.$Element("container");if(welContainer){var wfClickEventHandler=jindo.$Fn(this._clickEventHandler,this).bind();welContainer.attach("click@._click",wfClickEventHandler)}},_clickEventHandler:function(oEvent){var welSource=jindo.$Element(oEvent.element);if("addWatchLater"===welSource.data("event")){var nClipNo=welSource.data("clipno"),isLogin=welSource.data("login");this.addWatchLater(nClipNo,isLogin,welSource),oEvent.stop()}},movePageOrToggleCheckBox:function(moveUri,checkboxClassId,event){var welEventTarget=event.target&&jindo.$Element(event.target);if(welEventTarget&&welEventTarget.hasClass("mv_chk"))return!1;if(this._isEditMode()){var spanMvChk=$Element(checkboxClassId).parent(function(v){return v.hasClass("mv_chk")});this._setCheckBox(spanMvChk[0],this._SET_OPTION.TOGGLE),clickcr(this,this._getClickCodeOfSelectByCurrentPanelName(),"","",event)}else if("/v/"!==moveUri&&moveUri)clickcr(this,this._getClickCodeOfCListByCurrentPanelName(),"","",event),location.href=moveUri;else{var elTarget=event.target;void 0===elTarget&&(elTarget=window.event.srcElement),"IMG"===elTarget.tagName.toUpperCase()&&(elTarget=elTarget.parentNode);var wel=$Element(elTarget);switch(wel.data("event")){case"clickThumb":case"clickTitle":case"clickChannel":clickcr(this,wel.data("clickcode"),"","",event),location.href=wel.data("move_uri")}}},_applyEventTogglingEditMode:function(){var me=this,currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();jindo.$Element("btn_mod_"+currentPanelName).attach("click",function(){var $elList=$Element("myvideo_lst");me._isEditMode()?($elList.removeClass("check_module"),this.text("편집"),clickcr(this,me._getClickCodeOfFinishByCurrentPanelName(),"","")):($elList.addClass("check_module"),this.text("완료"),clickcr(this,me._getClickCodeOfEditByCurrentPanelName(),"","")),me._uncheckAllCheckBox()})},_isEditMode:function(){return!!$Element("myvideo_lst")&&$Element("myvideo_lst").hasClass("check_module")},_applyEventSelectAllCheckBox:function(){var me=this,currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();jindo.$Element("btn_all_"+currentPanelName).attach("click",function(){this._bSelectedAll&&null!=this._bSelectedAll?(this.text("전체선택"),this._bSelectedAll=!1):(this.text("전체해제"),this._bSelectedAll=!0),me._checkAllCheckBox(this._bSelectedAll),clickcr(this,me._getClickCodeOfAllByCurrentPanelName(),"","",event)})},_setCheckBox:function(spanMvChk,setOption){var divThl=spanMvChk.parent(function(v){return v.hasClass("_MM_CARD")})[0];setOption===this._SET_OPTION.ON?(divThl.addClass("chk_on"),this._bCheck=!0):setOption===this._SET_OPTION.OFF?(divThl.removeClass("chk_on"),this._bCheck=!1):setOption===this._SET_OPTION.TOGGLE&&(divThl.hasClass("chk_on")?(divThl.removeClass("chk_on"),this._bCheck=!1):(divThl.addClass("chk_on"),this._bCheck=!0));var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();null!=$Element("btn_delete_"+currentPanelName)&&$Element("btn_delete_"+currentPanelName).child(function(v){return v.hasClass("cnt")})[0].text(this._countSelectedCheckBox())},_uncheckAllCheckBox:function(){var me=this;jindo.$$(".mv_chk").forEach(function(value,index,array){me._setCheckBox($Element(value),me._SET_OPTION.OFF)})},_checkAllCheckBox:function(isSelectedAll){var me=this,currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();$$("._card_"+currentPanelName),$$("._card_"+currentPanelName+".chk_on");this._bCheckAll=isSelectedAll?(jindo.$$(".mv_chk_"+currentPanelName).forEach(function(value,index,array){me._setCheckBox($Element(value),me._SET_OPTION.ON)}),!0):(jindo.$$(".mv_chk").forEach(function(value,index,array){me._setCheckBox($Element(value),me._SET_OPTION.OFF)}),!1)},_countSelectedCheckBox:function(){var count=0;return jindo.$$("._MM_CARD").forEach(function(value,index,array){$Element(value).hasClass("chk_on")&&count++}),0===count?"":count},_applyEventDeleteSelected:function(){var me=this,currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();jindo.$Element("btn_delete_"+currentPanelName).attach("click",function(){clickcr(this,me._getClickCodeOfDelByCurrentPanelName(),"",""),"subscription"===ghtEnv.sId?me._deleteSelectedSubscriptionItems():"likeit"===currentPanelName?me._deleteSelectedLikeItems():me._deleteSelectedItems()})},_deleteSelectedItems:function(){var cardIds=this._getSelectedItemIds();if(0!==cardIds.length&&confirm("선택한 항목을 삭제하시겠습니까?")){jindo.$Ajax("/my/playlist/delete",{type:"xhr",method:"post",onload:function(res){window.location.href=ghtEnv.serviceDomain+"/my/playlist/?type="+tvcast.pc.NavigationTab.getCurrentPanelName()}}).request({type:tvcast.pc.NavigationTab.getCurrentPanelName(),clipIds:cardIds})}},_deleteSelectedLikeItems:function(){var cardIds=this._getSelectedItemIds();if(0!==cardIds.length&&confirm("선택한 항목의 좋아요를 취소하시겠습니까?")){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName(),serviceId="likeit"===currentPanelName?"TVCAST":"TVCAST_CH",likeApiUrl=ghtEnv.likeItApiDomain+"/likeIt/v1/unLikeItContent.jsonp?serviceId="+serviceId+"&contentsId=";for(var i in cardIds)$Ajax(likeApiUrl+cardIds[i],{type:"jsonp",method:"get",onload:function(res){},onerror:function(){},timeout:3,ontimeout:function(){alert("연결시간이 초과되었습니다.\n잠시후 다시 시도해주세요.")}}).request();var sUrl=ghtEnv.serviceDomain+"/"+ghtEnv.sPageName+"/"+ghtEnv.sId+"/removeSelected/"+currentPanelName;jindo.$Ajax(sUrl,{type:"xhr",method:"post",onload:function(res){window.location.href=ghtEnv.serviceDomain+"/"+ghtEnv.sPageName+"/"+ghtEnv.sId+"/"+currentPanelName}}).request({itemIds:cardIds})}},_deleteSelectedSubscriptionItems:function(){var cardIds=this._getSelectedItemIds();if(0!==cardIds.length){var sConfirm,currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();if("channels"===currentPanelName)sConfirm="선택한 채널의 구독을 해지하시겠습니까?";else{if("creators"!==currentPanelName)return;sConfirm="선택한 창작자의 구독을 해지하시겠습니까?"}if(confirm(sConfirm)){var sUrl=ghtEnv.serviceDomain+"/"+ghtEnv.sPageName+"/"+ghtEnv.sId+"/removeSelected/"+currentPanelName;jindo.$Ajax(sUrl,{type:"xhr",method:"post",onload:function(res){window.location.href=ghtEnv.serviceDomain+"/"+ghtEnv.sPageName+"/"+ghtEnv.sId+"/"+currentPanelName}}).request({cardIds:cardIds})}}},_getSelectedItemIds:function(){var result=new Array;return jindo.$$(".chk_on").forEach(function(value,index,array){var itemId=$Element(value).query("._chb-mark").attr("value");result.push(itemId)}),result},addWatchLater:function(nClipNo,isLogin,wel){var self=this;"true"===isLogin?null!=typeof nClipNo&&jindo.$Ajax("/my/playlist/add",{type:"xhr",method:"post",onload:function(res){"success"===res.text()&&null!=wel&&("current"===wel.data("type")?self._showCurrentWatchLaterToast():wel.addClass("check"))},onerror:function(){},ontimeout:function(){}}).request({type:"watch_later",clipNo:nClipNo}):confirm("로그인이 필요한 서비스 입니다.\n로그인 하시겠습니까?")&&(window.location.href="https://nid.naver.com/nidlogin.login?url="+encodeURIComponent(location.href))},_showCurrentWatchLaterToast:function(){var welCurrentWatchLaterToast=jindo.$Element("currentWatchLaterToast");welCurrentWatchLaterToast.css("display","block"),jindo.$Fn(function(){welCurrentWatchLaterToast.css("display","none")}).delay(1)},gnbLogoutEvent:function(){ghtEnv.isLogin=!1,window.location.href="https://nid.naver.com/nidlogin.logout?returl="+ghtEnv.serviceDomain},resetModBtn:function(){var $elList=$Element("myvideo_lst");this._isEditMode()&&($elList.removeClass("check_module"),$$(".btn_mod").forEach(function(value){$Element(value).text("편집")}),this._uncheckAllCheckBox())},addMyPlaylist:function(domain,type,clipNo){if(0!=window.ghtGnb.bIsLogin){jindo.$Ajax("/my/playlist/add",{type:"xhr",method:"post"}).request({type:type,clipNo:clipNo})}},_getClickCodeOfSelectByCurrentPanelName:function(){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName(),sClickCode=this._bCheck?"select":"deselect";return"watch_later"===currentPanelName?"add."+sClickCode:"recent"===currentPanelName?"rct."+sClickCode:"likeit"===currentPanelName?"clp."+sClickCode:"channels"===currentPanelName?"chn."+sClickCode:"creators"===currentPanelName?"cre."+sClickCode:void 0},_getClickCodeOfCListByCurrentPanelName:function(){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();return"watch_later"===currentPanelName?"add.clist":"recent"===currentPanelName?"rct.clist":"likeit"===currentPanelName?"clp.clist":"channels"===currentPanelName?"chn.clist":"creators"===currentPanelName?"cre.clist":void 0},_getClickCodeOfAllByCurrentPanelName:function(){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName(),sClickCode=this._bCheckAll?"all":"alldeselect";return"watch_later"===currentPanelName?"add."+sClickCode:"recent"===currentPanelName?"rct."+sClickCode:"likeit"===currentPanelName?"clp."+sClickCode:"channels"===currentPanelName?"chn."+sClickCode:"creators"===currentPanelName?"cre."+sClickCode:void 0},_getClickCodeOfEditByCurrentPanelName:function(){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();return"watch_later"===currentPanelName?"add.edit":"recent"===currentPanelName?"rct.edit":"likeit"===currentPanelName?"clp.edit":"channels"===currentPanelName?"chn.edit":"creators"===currentPanelName?"cre.edit":void 0},_getClickCodeOfFinishByCurrentPanelName:function(){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();return"watch_later"===currentPanelName?"add.finish":"recent"===currentPanelName?"rct.finish":"likeit"===currentPanelName?"clp.finish":"channels"===currentPanelName?"chn.finish":"creators"===currentPanelName?"cre.finish":void 0},_getClickCodeOfDelByCurrentPanelName:function(){var currentPanelName=tvcast.pc.NavigationTab.getCurrentPanelName();return"watch_later"===currentPanelName?"add.del":"recent"===currentPanelName?"rct.del":"likeit"===currentPanelName?"clp.del":"channels"===currentPanelName?"chn.del":"creators"===currentPanelName?"cre.del":void 0}};