define(["jquery","base/view","base/collection"],function(a,b,c){"use strict";return b.extend({props:{deferred:{miniProfile:"profile/mini-profile/main"},cssClasses:{hint:"mini-profile-hint"},css:["profile"]},public:{init:function(){return this.collection=new c,a(window.document).on("mouseenter","."+this.cssClasses.hint,this.showMiniProfile.bind(this)).on("mouseleave","."+this.cssClasses.hint,function(){this.initTimeout&&window.clearTimeout(this.initTimeout),this.profile&&this.profile.onBubbleHide()}.bind(this)),this},destroy:function(){return this.initTimeout&&(window.clearTimeout(this.initTimeout),delete this.initTimeout),a(window.document).off("mouseenter mouseleave","."+this.cssClasses.hint),this.profile&&(this.profile.destroyBubble(),this.profile.destroy()),this},showMiniProfile:function(b,c){var d=a(b.target),e=d.data();d.removeAttr("title"),this.initTimeout=window.setTimeout(function(){this.require(this.deferred.miniProfile,function(b){var c=a.extend(this.options,{target:d,email:e.email,localContainer:e.localContainer,position:{offset:e.positionOffset,my:e.positionMy,at:e.positionAt},bubbleZIndex:e.bubbleZIndex});this.profile=new b(c),this.profile.setCollection(this.collection)}.bind(this))}.bind(this),c||500)}}})});