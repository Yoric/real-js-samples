var tabcontrol;(function(n){function et(){return n.tabErrorMsg}function ot(t){n.tabErrorMsg=t}function w(){return n.tabs||(n.tabs=[]),n.tabs}function st(){n.tabs=[]}function k(n){n&&!ht(n)&&Lib.CssClass.add(n,"tab-disable")}function d(n){n&&Lib.CssClass.remove(n,"tab-disable")}function g(n){return Lib.CssClass.contains(n,"tab-active")}function ht(n){return n&&Lib.CssClass.contains(n,"tab-disable")}function r(n){return _ge(t(n,"content"))}function e(n){return t(n,"appns")}function o(n){return t(n,"k")}function t(n,t,i){if(i===void 0&&(i=null),!n)return null;var r="data-"+t;return i===null?n.getAttribute(r):(n.setAttribute(r,i),i)}function u(n,i){return i===void 0&&(i=null),i===null?parseInt(t(n,v),10):(t(n,v,i.toString()),i)}function ct(n,t,i){i===void 0&&(i=null);t.style.opacity="0";sb_st(function(){Lib.CssClass.add(t,"tab-hide");n.style.opacity="1";Lib.CssClass.remove(n,"tab-hide");i&&i()},0);Log.Log("Show","Tab","Show",!1,"AppNS",e(n),"K",o(n));Log.Log("Hide","Tab","Hide",!1,"AppNS",e(t),"K",o(t))}function s(n){return t(n,tt)?!0:!1}function nt(n){return t(n,it)?!0:!1}function lt(n){return t(n,l)?!0:!1}function at(n,i){var e,a,v,o,u,h;if(i===void 0&&(i=null),e=t(n,f),e){if(a=t(n.parentNode,f),a&&e[0]==="#")for(v=e.substr(1).split("#"),e=a,o=0;o<v.length;++o)e=e.replace(new RegExp("\\{"+o+"\\}","gm"),v[o]);s(n)||t(n,f,"");var y=r(n),p=y.id+"_dynamic",c=sj_ce("div",p,"tab-ajaxLoad");y.innerHTML="";y.appendChild(c);u=sj_gx();h=t(r(n),"k");h=t(r(n),"appns")+"."+h.substring(0,h.indexOf("."));e+=(e.indexOf("?")!=-1?"&":"?")+"IID="+h+"&IG="+_G.IG;u.open("GET",e,!0);sb_st(function(){u&&u.abort()},1e4);u.onreadystatechange=function(){var r;if(u!==null&&4===u.readyState){var e=u.status,f=u.responseText,o=!u.getAllResponseHeaders();if(u=null,r=200===e&&f!==null&&f!=="",c.className=r?ut:ft,c.innerHTML=r?f:et(),r){nt(n)&&t(n,l,"1");r=!1;try{f&&(vt(c),_w.rms&&_w.rms.start(),r=!0)}catch(s){Log.Log("Error","Tab","ScriptException",!1,"Tx",s.message)}}else Log.Log("Error","Tab",o?"Timeout":""+e,!1);i&&i(r)}};u.send()}}function vt(n){var i=n.getElementsByTagName("script"),t,r;if(i)for(t=0;t<i.length;t++)r=i[t],yt(r)}function yt(n){if(n){var t=sj_ce("script","");t.type="text/javascript";n.src?t.src=n.src:t.innerHTML=n.innerHTML;pt(t)}}function pt(n){_d.head.appendChild(n)}function h(n,t,i){var u,r;return(i===void 0&&(i=0),!n||n.clientHeight==0)?0:(u=c(n),u>=i)?t:(r=t-(i-u),r<0&&(r=0),r)}function c(n){for(var t=0;n;)t+=n.offsetTop-n.scrollTop+n.clientTop,n=n.offsetParent;return t}function wt(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var p=w();(sj_evt.bind("ajax.unload",st),p[n])||(ot(t),p[n]=new b(n,i,u,f,e,r,o,s,h,c,l,a,v,y))}function bt(n){var t=w();for(var i in t)if(i.indexOf(n)===0)return t[i]}function kt(n,t){var i=bt(n);i&&i.swipeOnHeader(t)}var f="dataurl",tt="nc",it="nr",l="al",a=91,rt=10,v="tabindex",y=5,ut="tab-ajaxCompleted",ft="tab-ajaxError",p=function(){return _w.IsSearchAppXYFocusEnabled?!0:!1},i,b;typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),function(n){n[n.Disabled=0]="Disabled";n[n.Dock=1]="Dock";n[n.Flow=2]="Flow"}(i||(i={}));b=function(){function n(n,t,r,f,e,o,s,h,c,l,a,v,y,w){var b,tt,k,nt,d;if((this.id=n,this.rtl=t,this.maxOffset=r,this.totalTabWidth=f,this.minTotalTabWidthForEqualFlexing=e,this.menuOffset=o,this.isSwitchToFullWidthMode=s,this.enableDock=h,this.dockContentMinHeight=c,this.undockContentVisibleMaxHeight=l,this.horizontalSwipeThreshold=a,this.enableBleeding=v,this.enableScrollableHeader=y,this.enableSupportHorizontalSwipe=w,b=this,tt=_ge(n),tt)&&(b.container=tt,b.head=b.container.firstElementChild,b.content=b.container.lastElementChild,v&&(b.content=b.container.lastChild.firstChild),b.menuContainer=b.head.children.length==3?b.head.children[1]:b.head.firstElementChild,b.menu=b.menuContainer.firstElementChild,b.header=_ge("b_header"),b.menuTotalHeight=b.menuContainer.clientHeight+rt,k=b.menu,k)){for(nt=0;nt<k.children.length;++nt)d=k.children[nt],b.active==null&&g(d)&&(b.active=d),u(d,nt),b.bind(d),sj_be(d,"keydown",function(n){var r=!1,t,i;n.keyCode===37?r=b.nav(!0):n.keyCode===39?b.nav(!1):n.keyCode===36?(n.preventDefault(),t=k.children[0],b.click(t),t.focus()):n.keyCode===35&&(n.preventDefault(),i=k.children[k.childElementCount-1],b.click(i),i.focus());p()&&(r&&n.keyCode===37||n.keyCode===39)&&n.preventDefault()});if(b.navLeft=_ge(n+"_navl"),b.navRight=_ge(n+"_navr"),b.navLeft&&(sj_be(b.navLeft,"click",function(n){b.nav(!0);Swipe.StopEffect(n)}),sj_be(b.navRight,"click",function(n){b.nav();Swipe.StopEffect(n)})),typeof Orientation!="undefined"&&Orientation&&Orientation.onOrientation)Orientation.onOrientation(function(n){b.adjustMenu();Log.Log("Rotate","Tab",n?"LS":"PT",!1)});sj_evt.bind("tab_reload",function(n){n[1]===b.id&&b.loadAjaxData(b.active)});b.navstate();b.dockStatus=i.Disabled;b.shouldEnableDock()&&sj_be(_w,"scroll",b.onScrollHelper());b.enableSupportHorizontalSwipe&&b.addSupportSwipeEvent(a);sj_evt.fire("tab_init_finished")}}return n.prototype.addSupportSwipeEvent=function(n){var t=this;Swipe.OnSwipe(function(){t.nav(!0);Log.Log("Left","Tab","Swipe",!1)},function(){t.nav(!1);Log.Log("Right","Tab","Swipe",!1)},t.enableScrollableHeader?t.content:t.container,n,function(){},function(){},function(){},!0,!1,y);t.enableScrollableHeader&&Swipe.OnSwipe(function(){Log.Log("Left","Tab","Swipe",!1);Log.Log("Left","Tab","FastSwitchSwipeHeader",!1)},function(){Log.Log("Right","Tab","Swipe",!1);Log.Log("Right","Tab","FastSwitchSwipeHeader",!1)},t.head,n,function(n){t.headerOnMove(n)},function(){},null,!0,!1,y)},n.prototype.adjustMenu=function(){var n=this;if(this.isSwitchToFullWidthMode)this.adjustTabWidthForFullWidthMode();else{if(n.navLeft||n.navRight||n.menu.children.length<=1)return;this.container.scrollWidth>this.totalTabWidth?this.enableFlexing():this.disableFlexing()}},n.prototype.adjustTabWidthForFullWidthMode=function(){var r=this,n=r.menu,f=r.container.offsetWidth-r.navLeft.scrollWidth*2,o=parseInt(_w.getComputedStyle(n.children[0]).paddingRight)*2,u,t,i,e;for(n.parentElement.style.width=""+f+"px",t=0;t<n.children.length;++t)i=n.children[t],i.style.width=""+(f-o)+"px";for(u=0,t=0;t<n.children.length;++t){if(i=n.children[t],e=i.clientWidth,g(i))break;u+=e}r.maxOffset=-n.scrollWidth;Lib.CssClass.add(n,"tab-notrans");sb_st(function(){Lib.CssClass.remove(n,"tab-notrans")},100);this.shift(-u)},n.prototype.enableFlexing=function(){this.container.scrollWidth>=this.minTotalTabWidthForEqualFlexing?this.enableEqualFlexing():this.enableProportionalFlexing();Lib.CssClass.add(this.menuContainer,"tab-flex");this.maxOffset=0;this.shift(0)},n.prototype.enableProportionalFlexing=function(){for(var i,u,e=this,r=e.menu,f=0,n=0;n<r.children.length;++n)i=r.children[n],u=parseInt(t(i,"ow")),f+=u;for(n=0;n<r.children.length;++n)i=r.children[n],u=parseInt(t(i,"ow")),i.style.width=""+100*u/f+"%"},n.prototype.enableEqualFlexing=function(){for(var i,r=this,n=r.menu,t=0;t<n.children.length;++t)i=n.children[t],i.style.width=""+100/n.children.length+"%"},n.prototype.disableFlexing=function(){for(var r,f,n=this,u=n.menu,i=0;i<u.children.length;++i)r=u.children[i],f=parseInt(t(r,"w")),r.style.width=""+f+"px";Lib.CssClass.remove(this.menuContainer,"tab-flex");n.maxOffset=this.container.scrollWidth-this.totalTabWidth;n.shiftToItem(n.active)},n.prototype.nav=function(n){n===void 0&&(n=!1);var t=this,i=n===t.rtl?t.active.nextSibling:t.active.previousSibling;return i?(t.click(i),i.focus(),!0):(Log.Log(n?"Next":"Prev","Tab","Nav",!1),!1)},n.prototype.headerOnMove=function(n){var t=this,i=t.menuOffset+n;t.shift(i)},n.prototype.bind=function(n){var t=this;sj_be(n,"click",function(i){t.click(n);var u=r(n);Log.Log("Select","Tab","Click",!1,"AppNS",e(u),"K",o(u));Swipe.StopEffect(i)})},n.prototype.click=function(n){var t=this;n&&t.active!==n&&(t.onTabChange(),ct(r(n),r(t.active),function(){sj_evt.fire("layoutChange",t.id,u(n))}),this.deactivate(t.active),this.activate(n),t.active.removeAttribute&&t.active.removeAttribute("tabindex"),n.tabIndex=0,t.select(n))},n.prototype.activate=function(n){Lib.CssClass.add(n,"tab-active");sj_evt.fire("tabactive",this.id,u(n));n.setAttribute("aria-selected","true")},n.prototype.deactivate=function(n){Lib.CssClass.remove(n,"tab-active");sj_evt.fire("tabdeactive",this.id,u(n));n.setAttribute("aria-selected","false")},n.prototype.select=function(n){var t=this,i,r;nt(n)&&lt(n)||t.loadAjaxData(n);t.active=n;t.shiftToItem(n);t.navstate();i=t.active.previousSibling;s(i)||t.loadAjaxData(i);r=t.active.nextSibling;s(r)||t.loadAjaxData(r);p()&&n.focus()},n.prototype.navstate=function(){var n=this;d(n.navLeft);d(n.navRight);n.active===n.menu.firstElementChild&&k(n.rtl?n.navRight:n.navLeft);n.active===n.menu.lastElementChild&&k(n.rtl?n.navLeft:n.navRight)},n.prototype.shiftToItem=function(){var i=this,u,e,r;if(i.maxOffset<0){var t=i.menu.parentElement,n=i.active,f=0;i.enableScrollableHeader?(u=0,n&&typeof _w.getComputedStyle!="undefined"&&(u=parseInt(_w.getComputedStyle(n).marginRight)),e=n.previousSibling!=null?n.previousSibling:n,r=n.nextSibling!=null?n.nextSibling:n,f=r.offsetLeft+r.offsetWidth-e.offsetLeft+2*u>=t.offsetWidth?t.offsetLeft-n.offsetLeft+(t.offsetWidth-n.offsetWidth)/2:e.offsetLeft<t.offsetLeft?t.offsetLeft-e.offsetLeft+u:r.offsetLeft+r.offsetWidth>t.offsetLeft+t.offsetWidth?t.offsetLeft+t.offsetWidth-r.offsetLeft-r.offsetWidth-u:0):f=t.offsetLeft-n.offsetLeft+(t.offsetWidth-n.offsetWidth)/2;f*=i.rtl?-1:1;i.shift(i.menuOffset+f)}},n.prototype.shift=function(n){var t=this,i;Lib.CssClass.add(t.menu,"tab-notrans");n>=0?n=0:n<=t.maxOffset&&(n=t.maxOffset);t.menuOffset=n;i=n+"px";t.rtl?t.menu.style.marginRight=i:t.menu.style.marginLeft=i},n.prototype.loadAjaxData=function(n){var t=this;at(n,function(i){sj_evt.fire("layoutChange",t.id,u(n));i&&sj_evt.fire("tab_ajaxLoaded",t.id,u(n))})},n.prototype.onScrollHelper=function(){var n=this;return function(){if(n.shouldEnableDock()){n.headerVisibleHeight=h(n.header,a);n.menuVisibleHeight=h(n.menuContainer,n.menuTotalHeight);switch(n.dockStatus){case i.Disabled:n.shouldDockFromDisabled()&&n.dock();break;case i.Dock:var t=n.nextStatusInDock();t==i.Flow?n.flow():t==i.Disabled?n.disableDock():n.dock();break;case i.Flow:n.shouldDockFromFlow()&&n.dock()}}}},n.prototype.shouldDockFromDisabled=function(){if(this.content.clientHeight<this.dockContentMinHeight)return!1;var n=c(this.menuContainer);return n>this.headerVisibleHeight?!1:!0},n.prototype.shouldDockFromFlow=function(){var n=this.contentVisibleHeight();return n>=this.undockContentVisibleMaxHeight},n.prototype.nextStatusInDock=function(){var n=this.contentVisibleHeight();return n>=this.content.scrollHeight?i.Disabled:n<=this.undockContentVisibleMaxHeight?i.Flow:i.Dock},n.prototype.contentVisibleHeight=function(){var n=this.headerVisibleHeight+this.menuVisibleHeight;return h(this.content,this.content.scrollHeight,n)},n.prototype.dock=function(){this.dockStatus=i.Dock;Lib.CssClass.remove(this.head,"flow");Lib.CssClass.add(this.head,"dock");this.head.style.top=this.headerVisibleHeight+"px";this.content.style.marginTop=this.menuTotalHeight+"px"},n.prototype.flow=function(){this.dockStatus=i.Flow;var n=this.headerVisibleHeight+_w.pageYOffset;Lib.CssClass.add(this.head,"flow");this.head.style.top=n+"px"},n.prototype.disableDock=function(){this.dockStatus=i.Disabled;Lib.CssClass.remove(this.head,"flow");Lib.CssClass.remove(this.head,"dock");this.head.style.position="";this.head.style.top="";this.content.style.marginTop=""},n.prototype.onTabChange=function(){if(this.shouldEnableDock()&&this.dockStatus!=i.Disabled){var n=a+this.menuTotalHeight,t=c(this.content);_w.scrollBy(0,t-n)}},n.prototype.shouldEnableDock=function(){return this.enableDock?/backbuttonhelper/.test(location.hash)?!1:!0:!1},n.prototype.swipeOnHeader=function(n){this.headerOnMove(n)},n.prototype.selectTab=function(n){var t=this.menu.children[n];t&&this.click(t)},n}();n.init=wt;n.swipeTabHeader=kt;typeof WireUp!="undefined"&&WireUp&&WireUp.init("tab",function(n){if(n){var t=n.id;WireUp.onUpdate(n,"a",function(){sj_evt.fire("tab_reload",t)})}});sj_evt.fire("tab_init",n)})(tabcontrol||(tabcontrol={}))