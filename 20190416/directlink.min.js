if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO = {};}
(function(){
function BottomSheetApp(e,t,i){var n=this,o=str2Dom(TMPL.BS_APP);n.bottomSheet=o,n.relatedLinks=o.querySelector("#yjDirectSLinkRelated"),n.linker=e,n.query="",n.index=-1,n.scClass="yjDirectSLink-"+i.serviceCode.toUpperCase(),n.adjustTopInputBoxPos=function(){n.topInputBox.style.top=window.scrollY+"px"},n.logger=t,n.eventDetacher=[],n.setup()}function BottomSheetIPhone(e,t,i){var n=this,o=str2Dom(TMPL.BS_INPUT),r=str2Dom(TMPL.BS_IPN);n.topInputBox=o,n.bottomSheet=r,n.relatedLinks=r.querySelector("#yjDirectSLinkRelated"),n.directLinkInput=r.querySelector("#yjDirectSLinkIpt"),n.topInputBoxInput=o.querySelector("#yjDirectSLinkIpt2"),n.linker=e,n.query="",n.linkQuery="",n.index=-1,n.scClass="yjDirectSLink-"+i.serviceCode.toUpperCase(),n.adjustTopInputBoxPos=function(){n.topInputBox.style.top=window.scrollY+"px"},n.logger=t,n.eventDetacher=[],n.setup()}function BottomSheetPC(e,t,i){var n=this,o=str2Dom(TMPL.BS_PC);n.bottomSheet=o,n.linker=e,n.query="",n.index=-1,n._xposition=0,n._yposition=0,n.logger=t,n.eventDetacher=[],n.setup(i)}function Linker(e,t,i,n){var o=this,r=e.HighlightSearchWords,a=isPC()?10:5;o.linkClass="yjDirectSLinkHl",void 0!==t&&""!==t&&"underline"!==t&&(o.linkClass="yjDirectSLinkHl_"+t),o.linkCount=i.linkCount||a,o.fr=r.ServiceSpecific.Fr+(i.addFR?"_"+i.addFR:""),o.direct=r.Result,o.slink=r.ServiceSpecific.SearchLink,o.showBottomsheet=n}function Logger(e,t){var i=this;i.beaconer=YAHOO.i13n.Beaconer({beacon_server:CONST.URL_BEACON,keys:e,link_data:t,spaceid:e.spaceid,https:!0})}function LoggerWrapper(e){var t=this;t.pageParams=e}function loadResources(e,t){for(var i,n,o=document.head||document.getElementsByTagName("head")[0],r=0,a=!0,s=function(i){r+=1,i&&"error"===i.type&&(a=!1),e.length<=r&&t(a)},c=(isIE(),function(){s()}),d=0;d<e.length;d+=1)i=e[d],"css"!==i.type&&"js"!==i.type||("js"===i.type?(n=document.createElement("script"),n.setAttribute("src",i.src)):(n=document.createElement("link"),n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",i.src)),isIE()<10?setTimeout(c,300):!isPC()&&(isIOS()<6||isAndroid())&&"css"===i.type?setTimeout(s(),300):n.onload=n.onerror=s,o.appendChild(n))}function isAndroid(){var e,t,i=navigator.userAgent;return/Android/i.test(i)?(e=i.match(/Android (\d+)\.?(\d+)?\.?(\d+)?/),t=e[1],e[2]&&(t+="."+e[2]),e[3]&&(t+="."+e[3]),parseFloat(t)):0}function isIOS(){var e,t,i=navigator.userAgent;return/iP(hone|od touch|ad);/i.test(i)?(e=i.match(/OS (\d+)_(\d+)_?(\d+)?/),t=e[1]+"."+e[2],e[3]&&(t+="."+e[3]),parseFloat(t)):0}function isIE(){var e=navigator.userAgent,t=e.match(/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/),i=!0;return t?parseFloat((t[1]||t[2]).replace(new RegExp("\\.","g"),function(){var e=i?".":"";return i=!1,e})):0}function isPC(){return isAndroid()||isIOS()?0:1}function isYbrowser(){var e,t,i=navigator.userAgent;return/ybrowser/i.test(i)?(e=i.match(/ybrowser\/(\d+)\.(\d+)\.?(\d+)?/),t=e[1]+e[2],e[3]&&(t+="."+e[3]),parseFloat(t)):0}function isYJapp(){var e,t,i=navigator.userAgent;return/YJApp-IOS jp.co.yahoo.ipn.appli/i.test(i)?(e=i.match(/YJApp-IOS jp.co.yahoo.ipn.appli\/(\d+)\.(\d+)\.?(\d+)?/),t=e[1]+e[2],e[3]&&(t+="."+e[3]),parseFloat(t)):/YJApp-ANDROID jp.co.yahoo.android.yjtop/i.test(i)?(e=i.match(/YJApp-ANDROID jp.co.yahoo.android.yjtop\/(\d+)\.(\d+)\.?(\d+)?/),t=e[1]+e[2],e[3]&&(t+="."+e[3]),parseFloat(t)):0}function isApp(e){return e.isApp&&1===e.isApp?1:0}function isSSH(){var e=0;return"https:"===document.location.protocol&&(e=1),e}function str2Dom(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function range(e,t){var i,n=[];for(i=e;i<=t;i++)n.push(i);return i}function jsonpRequest(e,t,i){var n=document.createElement("script");YAHOO.JP.srch.dlink.cb=t,n.setAttribute("async",!0),n.setAttribute("src",e.replace("{{callback}}","YAHOO.JP.srch.dlink.cb")),i&&(n.onerror=function(){YAHOO.JP.srch.dlink.cb({})}),isIE()<10?(document.head||document.getElementsByTagName("head")[0]).appendChild(n):document.head.appendChild(n)}function checkUA(){var e="",t=navigator.userAgent;return/jp\.co\.yahoo\.android\.yjtop/.test(t)&&(e="yjapp_and"),/YJApp-ANDROID jp\.co\.yahoo\.android\.ybrowser/.test(t)&&(e="ybr"),e}function checkAppDomain(){var e="",t=window.location.href;return/^https?:\/\/matome\.naver\.jp\/m\/odai/.test(t)?e="nvm":/^https?:\/\/beauty\.yahoo\.co\.jp\/([^\/]+)\/articles/.test(t)?e="bty":/^https?:\/\/blogs\.yahoo\.co\.jp/.test(t)?e="blg":/^https?:\/\/ameblo\.jp\/([^\/]+)\/entry-\d+/.test(t)?e="amb":/^https?:\/\/192abc\.com\/\d+/.test(t)?e="kdh":/^https?:\/\/kaumo\.jp\/topic\/\d+/.test(t)?e="kum":/^https?:\/\/www\.appbank\.net\/\d+\/\d+\/\d+\/iphone-application\/\d+\.php/.test(t)?e="apb":/^https?:\/\/blog\.livedoor\.jp\/[^\/]+\/archives\/\d+\.html/.test(t)?e="ldb":/^https?:\/\/[^\/]+\.livedoor\.biz\/archives\/\d+\.html/.test(t)?e="ldb":/^https?:\/\/[^\.]+\.(2chblog|blog|bloggeek|blogism|blogo|blogstation|blogto|cafeblog|corpblog|diary\.to|doorblog|dreamlog|gger|golog|ldblog|liblo|myjournal|mynikki|officeblog|officialblog|publog|storeblog|teamblog|techblog|weblog\.to|xxxblog|youblog)\.jp\/archives\/\d+\.html/.test(t)&&(e="ldb"),e}function init(e){var t=CONST.IMG_CENTER_SSH,i=CONST.CSS_PATH,n=CONST.ULT_JS_PATH,o=CONST.API_PATH_SSH,r=YAHOO.JP.srch.dlink.PARAMS,a=isPC(),s=isApp(r),c={};a?i=CONST.CSS_PATH_PC:s&&(i=CONST.CSS_PATH_APP),i=t+i,n=t+n,Object.keys(e).length&&(e.Experiments.Experiment.forEach(function(e){200===e.Status&&0===e.Code&&void 0!==e.BucketId&&(c.mfid=e.ExperimentId+":"+e.BucketId,void 0!==e.BucketId&&(c.testbucket=e.BucketId))}),YAHOO.JP.srch.dlink.mfparams=c),r.mfID||(YAHOO.JP.srch.dlink.PARAMS.mfID=c.mfid),r.bucketID||(YAHOO.JP.srch.dlink.PARAMS.bucketID=c.testbucket),loadResources([{type:"css",src:i},{type:"js",src:n}],function(e){if(e){var t=YAHOO.JP.srch.dlink.PARAMS,i=o.replace("{{appid}}",t.appID||t.eappID).replace("{{service}}",t.serviceCode).replace("{{article_id}}",t.articleID);if(5!==t.linkCount&&(i=i+"&count="+t.linkCount),"amb"===t.serviceCode){var n=window.location.protocol+"//"+window.location.host+window.location.pathname;i=i+"&href="+encodeURIComponent(n)}jsonpRequest(i,applyLink,!1)}})}function applyLink(e){var t,i,n,o,r={nws:".articleDefault .paragraph .text,.articleDefault > .text,.articleDefault",cbr:"#detail .detailQuestion .mainSentence .mainText,#detail .detailBa .mainSentence .mainText",net:".cpDraft > p,.cpDraft > .rest-article > p",nvm:".MdMTM02Body > .MdMTM03Item > .mdMTM03Inner > p.mdMTM03Ttl,.MdMTM02Body > .MdMTM03Item > .mdMTM03Inner > p.mdMTM03Txt,.MdMTM02Body > .MdMTM03Item > .mdMTM03Inner > .mdMTM03Row > p.mdMTM03TwitterPost,.MdMTM02Body > .MdMTM03Item > .mdMTM03Inner > p.mdMTM03Comment",bty:".detail-article > #arcl > p,.detail-article > #arcl > .rest-article > p",blg:"#atcl > .richTextArea,#atcl > .richTextArea font,#atcl > .richTextArea div,#atcl > .richTextArea span,#atcl > .richTextArea b",amb:"#app div._2M0-mQO6,#app div._2M0-mQO6 div,#app div._2M0-mQO6 span",kdh:"article section p",kum:"main div p,main div div p,main div div div p",apb:"article div div,article div p,article div p strong",ldb:"#article-contents,#article-contents div b,#article-contents div div,#article-contents div.t_b,#article-contents h2"},a={cbr:".mdPstdQstn .clrfx .usrQstn .ptsQes p,.mdPstdBA .clrfx .usrQstn .ptsQes p"},s={},c=YAHOO.JP.srch.dlink.PARAMS,d=new LoggerWrapper({rpdprop:"entrypoint",service:c.serviceCode,spaceid:c.spaceID,vtestid:c.mfID,article:c.articleID,genre:c.genre?c.genre:findGenre(c.serviceCode),url:window.location.href,device:isPC()?"pc":"smt"}),l=isAndroid(),p=isIOS(),h=isPC(),u=isApp(c),m="undefined"==typeof c.bottomSheet||c.bottomSheet,g=window.navigator.userAgent;i=r,h?i=a:u&&(i=s),n=document.querySelectorAll(i[c.serviceCode]+", .yjDirectSLinkTarget"),m&&(l&&l<4||p&&p<5)&&(m=!1);var f=new Linker(e,c.highlightStyle,c,m);if(t=f.makeDirectLink(n),!t||t.length<=0){if(CONST.ALERT){var k;k="リンクを作成できなかった",alert(k)}}else if(m&&l>=5&&l<6&&g.indexOf("Nexus 5")>=0&&g.indexOf("jp.co.yahoo.android.ybrowser")>=0&&(m=!1),d.setupLinkLogger(t),d.sendLinkViewLog(),d.attachLinkClickLog(t,!m),m)o=h?new BottomSheetPC(f,d,c):u?new BottomSheetApp(f,d,c):new BottomSheetIPhone(f,d,c),t.forEach(function(e,t){e.addEventListener("click",function(i){var n=i.target,r=n.getAttribute("title"),a={x:i.clientX,y:i.clientY};YAHOO.JP.srch.dlink.istap=!0,o.returnIndex()!==t?(h&&(o.hide(),o.setPosition(e,a)),o.setIndex(t),o.show(r)):(o.setIndex(-1),o.hide()),i.preventDefault()},!1)}),h&&document.body.addEventListener("click",function(e){var t=e.target.className;"yjDirectSLinkHl"!==t&&(o.setIndex(-1),o.hide())},!1),YAHOO.JP.srch.dlink.close=function(){o.setIndex(-1),u?o.hide(0):o.hide()};else if("nws"===c.serviceCode){var v=document.getElementById("pgraphCap");v.innerHTML="※記事本文中のリンクはYahoo!検索が提供する機能であり、記事提供社とは関係ありません",v.className="articleDefaultCap"}}function makeMiffyUrl(e){var t="",i=[],n={};if(i.indexOf(e)!==-1){var o,r,a,s,c=n[e].join(","),d="",l="",p="";for(l=document.location.search.substring(1),p=l.split("&"),a=p.length,s=0;s<a;s++)o=p[s],r=o.split("="),"bucket"===r[0]&&(d+="&bucketid="+r[1]),"prev"===r[0]&&(d+="&mfprev=true");t=CONST.MIFFY_PATH+"?appid=dj0zaiZpPXZpNHZSVUExV09CeiZzPWNvbnN1bWVyc2VjcmV0Jng9MTE-&apptype=web&callback={{callback}}&experimentid="+c+d}return t}function findGenre(e){if("nws"===e){var t=window.location.href,i=t.match(new RegExp("\\/hl\\?a=\\d+-\\d+-.+-([^&]+)"));if(i&&i[1])return i[1];if(i=t.match(new RegExp("\\/article\\?a=\\d+-\\d+-.+-([^&]+)")),i&&i[1])return i[1]}return""}function validateParams(){var e,t,i=YAHOO.JP.srch.dlink.PARAMS,n=isPC(),o=window.location.href;if(!i.serviceCode&&!i.articleID){if(CONST.ALERT){var r;r="serviceCode, articleIDが不足",alert(r)}return 0}return"nws"===i.serviceCode&&n&&(t=o.match(new RegExp("\\/hl\\?a=\\d+-\\d+-([^-]+)-.+")),t&&t[1]&&(e=t[1]),"undefined"===e&&(t=o.match(new RegExp("\\/article\\?a=\\d+-\\d+-([^-]+)-.+")),t&&t[1]&&(e=t[1])),e&&"asahi"===e)?0:1}var CONST={IMG_CENTER:"http://i.yimg.jp",IMG_CENTER_SSH:"https://s.yimg.jp",CSS_PATH:"/images/search/slink/direct/sp/1.0.0/css/direct_content_sp.css",CSS_PATH_PC:"/images/search/slink/direct/pc/1.0.0/css/direct_content_pc.css",CSS_PATH_APP:"/images/search/slink/direct/app/1.0.0/css/direct_content_yjapp.css",ULT_JS_PATH:"/images/rapid/1.5.0/ult.js",MAIN_JS_PATH:"/images/search/slink/direct/sp/1.0.0/js/directlink.min.js",API_PATH:"http://entrypoint.search.yahooapis.jp/v1/link/highlight_words?&appid={{appid}}&.src={{service}}&article_id={{article_id}}&callback={{callback}}",API_PATH_SSH:"https://slink-search.yahooapis.jp/v1/link/highlight_words?&appid={{appid}}&.src={{service}}&article_id={{article_id}}&callback={{callback}}",MIFFY_PATH:"https://mf.yahoo.co.jp/v1/experiment",BEACON_SERVER:"ybx.yahoo.co.jp",CLASS_CLOSE:"animationClose",CLASS_OPEN:"animationOpen",CLASS_BGCLOSE:"animationBgClose",CLASS_BGOPEN:"animationBgOpen",ALERT:!1},TMPL={BS_IPN:['<div id="yjDirectSLink" class="animationOpen">','<div id="yjDirectSLinkHd">',"<p>Yahoo! JAPAN</p>",'<a href="javascript:void(0)" id="yjDirectSLinkExpand" class="yjDirectSLinkExp">閉じる</a>',"</div>",'<div id="yjDirectSLinkSearchBox">','<form id="yjDirectSLinkFrm" action="" method="get">','<div id="yjDirectSLinkWrap">','<div id="yjDirectSLinkIpt"></div>','<div id="yjDirectSLinkClearBtn"><span>&nbsp;</span></div>',"</div>",'<input type="submit" id="yjDirectSLinkSbmtBtn" value="検索">',"</form>","</div>",'<div class="yjDirectSLinkSm">','<p id="yjDirectSLinkRelated"></p>',"</div>",'<div class="yjDirectLinkMsg">',"<p>※本文中リンクはヤフー提供の機能で、記事提供社とは関係ありません</p>","</div>","</div>"].join(""),BS_INPUT:['<div id="yjDirectSLink2" style="display: block; top: 0px;">','<div id="yjDirectSLinkSearchBox2">','<form id="yjDirectSLinkFrm2" action="" method="get">','<div id="yjDirectSLinkWrap2">','<input type="search" name="" value="" id="yjDirectSLinkIpt2" autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="キーワードを入力" autofocus>',"</div>",'<input type="submit" id="yjDirectSLinkSbmtBtn2" value="検索">',"</form>","</div>","</div>"].join(""),BS_PC:['<div id="yjDirectSLink" style="display: block">','<a href="javascript:void(0);" target="_blank">&#x59;&#x61;&#x68;&#x6f;&#x6f;&#x21;&#x691c;&#x7d22;</a>',"</div>"].join(""),BS_APP:['<div id="yjDirectSLinkYja" class="animationBgOpen">','<div id="yjDirectSLinkShadow"></div>','<div id="yjDirectSLinkInn" class="animationOpen">','<div class="yjDirectSLinkSm">','<p id="yjDirectSLinkRelated"></p>','<div class="yjDirectLinkMsg"><p>※本文中リンクはヤフー提供の機能で、記事提供社とは関係ありません</p></div>','<div id="yjDirectSLinkHd"><a href="javascript:void(0)" id="yjDirectSLinkExpand" class="yjDirectSLinkExp">閉じる</a></div>',"</div>","</div>","</div>"].join("")};BottomSheetApp.prototype={setup:function(){var e=this,t=e.logger,i=e.bottomSheet,n=i.querySelector("#yjDirectSLinkShadow"),o=i.querySelector("#yjDirectSLinkExpand");i.classList.add(e.scClass),i.addEventListener("touchmove",function(e){e.preventDefault()},!1),o.addEventListener("click",function(t){t.preventDefault(),e.hide()},!1),n.addEventListener("click",function(t){t.preventDefault(),e.hide()},!1),t.setupBottomSheetLoggerAPP(),t.attachBottomSheetLogs(o)},hide:function(e){var t=this,i=t.bottomSheet,n=i.querySelector("#yjDirectSLinkInn"),o="undefined"!=typeof e?e:1;i.className=CONST.CLASS_BGCLOSE+" "+t.scClass,n.className=CONST.CLASS_CLOSE,t.index=-1,0!==o&&(window.location.href="yjtopapp://common/searchWord/clear"),setTimeout(function(){i.className.indexOf(CONST.CLASS_BGCLOSE)!==-1&&t.detach()},500)},detach:function(){var e=this,t=e.bottomSheet,i=t.parentNode;i&&i.removeChild(t)},attach:function(){document.body.appendChild(this.bottomSheet)},show:function(e){var t,i,n=this,o=n.logger,r=n.linker.getRelated(e),a=n.bottomSheet,s=a.querySelector("#yjDirectSLinkInn"),c=n.relatedLinks,d=[],l=function(){n.hide(0)};for(n.setQuery(e),"function"==typeof YAHOO.JP.srch.slinkapp.closeSlink&&YAHOO.JP.srch.slinkapp.closeSlink(),0===r.length&&(r=[e]),c.innerHTML="",c.style.display="block",i=0;i<r.length&&i<3;i++)t=n.createRelatedLink(r[i],e),c.appendChild(t),d.push(t),t.addEventListener("click",l,!1);o.setupRelatedLogger(i),o.sendRelatedViewLog(),o.attachLogsRelated(d),o.sendBtmsViewLog(),a.className=CONST.CLASS_BGOPEN+" "+n.scClass,s.className=CONST.CLASS_OPEN,a.style.bottom="",n.attach()},setQuery:function(e){window.location.href="yjtopapp://common/searchWord/set?query="+encodeURIComponent(e)+"&url="+encodeURIComponent(this.linker.getLinkUrl(e))},createRelatedLink:function(e,t){var i=document.createElement("a");return i.className="yjDirectLinkTag",i.innerHTML=e.replace(t,"<em>"+t+"</em>"),i.href=this.linker.getLinkUrl(e),i},returnIndex:function(){return this.index},setIndex:function(e){this.index=e}},BottomSheetIPhone.prototype={setup:function(){var e=this,t=e.logger,i=e.bottomSheet,n=i.querySelector("#yjDirectSLinkExpand"),o=i.querySelector("#yjDirectSLinkSbmtBtn"),r=i.querySelector("#yjDirectSLinkClearBtn");i.classList.add(e.scClass),i.addEventListener("touchmove",function(e){e.preventDefault()},!1),n.addEventListener("click",function(t){t.preventDefault(),e.hide()},!1),o.addEventListener("click",function(i){i.preventDefault(),e.hide();var n="";e.query!==e.linkQuery&&(n="_re"),t.loggerBtms.sendClickLog(t.linkParamsBtms[0].links[1].params,e.linker.getLinkUrl(e.query,n))}),r.addEventListener("click",function(){e.setQuery("")}),e.setupTopInputBox(t),t.setupBottomSheetLogger(),t.attachBottomSheetLogs(n)},setupTopInputBox:function(e){var t=this,i=t.topInputBox,n=i.querySelector("#yjDirectSLinkSbmtBtn2"),o=t.topInputBoxInput,r=t.directLinkInput,a=document.body,s=!1,c=function(){s||(t.setQuery(o.value),a.contains(i)&&a.removeChild(i),t.bottomSheet.className="",t.attach(),window.removeEventListener("scroll",t.adjustTopInputBoxPos))},d=function(n){n.preventDefault(),a.removeChild(i);var r="";o.value!==t.linkQuery&&(r="_re"),s=!0,e.loggerBtms.sendClickLog(e.linkParamsBtms[0].links[1].params,t.linker.getLinkUrl(o.value,r))};r.addEventListener("click",function(e){e.preventDefault(),t.detach(),t.adjustTopInputBoxPos(),a.appendChild(i),s=!1,window.removeEventListener("scroll",t.adjustTopInputBoxPos),window.addEventListener("scroll",t.adjustTopInputBoxPos),o.focus(),setTimeout(function(){t.adjustTopInputBoxPos()},500)}),i.addEventListener("touchstart",function(e){e.target===i&&(e.preventDefault(),o.blur(),c())}),n.addEventListener("touchstart",d),n.addEventListener("click",d),o.addEventListener("blur",function(){setTimeout(c,500)})},hide:function(){var e=this,t=e.bottomSheet;YAHOO.JP.srch.uho&&YAHOO.JP.srch.uho.show instanceof Function&&YAHOO.JP.srch.uho.show(),t.className=CONST.CLASS_CLOSE+" "+e.scClass,e.index=-1,setTimeout(function(){t.className.indexOf(CONST.CLASS_CLOSE)!==-1&&e.detach()},500)},detach:function(){var e=this,t=e.bottomSheet,i=t.parentNode;i&&i.removeChild(t)},attach:function(){document.body.appendChild(this.bottomSheet)},show:function(e){var t,i,n=this,o=n.logger,r=n.linker.getRelated(e),a=n.bottomSheet,s=n.relatedLinks,c=[],d=function(){n.hide()},l=isYbrowser(),p=YAHOO.JP.srch.dlink.PARAMS;if(n.setQuery(e),n.linkQuery=e,s.innerHTML="",r.length>0){for(s.style.display="block",i=0;i<r.length&&i<3;i++)t=n.createRelatedLink(r[i],e),s.appendChild(t),c.push(t),t.addEventListener("click",d,!1);o.setupRelatedLogger(i),o.sendRelatedViewLog(),o.attachLogsRelated(c)}else s.style.display="none";o.sendBtmsViewLog(),YAHOO.JP.srch.uho&&YAHOO.JP.srch.uho.hide instanceof Function&&YAHOO.JP.srch.uho.hide(),YAHOO.JP.idpf&&YAHOO.JP.idpf.loginPromo&&YAHOO.JP.idpf.loginPromo.hide instanceof Function&&YAHOO.JP.idpf.loginPromo.hide(),a.className=CONST.CLASS_OPEN+" "+n.scClass,a.style.bottom="",n.attach(),l>25.37&&(window.location.href="ybrowserapp://close/richtaptosearch?t="+p.tabID),(void 0===YAHOO.JP.srch.nhighlight.istap||void 0!==YAHOO.JP.srch.nhighlight.istap&&YAHOO.JP.srch.nhighlight.istap!==!0)&&(YAHOO.JP.srch.dlink.istap=!1)},setQuery:function(e){var t=this;t.query=e,t.directLinkInput.innerHTML=e,t.topInputBoxInput.value=e},createRelatedLink:function(e,t){var i=document.createElement("a");return i.className="yjDirectLinkTag",i.innerHTML=e.replace(t,"<em>"+t+"</em>"),i.href=this.linker.getLinkUrl(e),i},returnIndex:function(){return this.index},setIndex:function(e){this.index=e}},BottomSheetPC.prototype={setup:function(e){var t=this,i=t.logger,n=t.bottomSheet;n.classList.add("yjDirectSLink-"+e.serviceCode.toUpperCase()),n.addEventListener("click",function(){t.hide(),i.loggerBtms.beaconer.doClickBeacon(i.linkParamsBtms[0].links[0].params)}),i.setupBottomSheetLoggerPC()},attach:function(){document.body.appendChild(this.bottomSheet)},detach:function(){var e=this,t=e.bottomSheet,i=t.parentNode;i&&i.removeChild(t)},hide:function(){var e=this;e.detach()},show:function(e){var t,i=this,n=i.bottomSheet,o=i.logger;i.setQuery(e),o.sendBtmsViewLog(),t=n.getElementsByTagName("a"),t[0].href=this.linker.getLinkUrl(e),n.style.left=i._xposition+"px",n.style.top=i._yposition+"px",i.attach()},setPosition:function(e,t){var i,n,o,r,a,s=this,c={width:130,height:48},d=e.getBoundingClientRect(),l=e.getClientRects(),p=window.pageYOffset+$(window).height(),h="undefined"!=typeof e.closest,u=!1;if(l.length>1)for(a=0;a<l.length;a++)if(t.y<l[a].bottom){d=l[a];break}isIE()?(i=e.parentElement,void 0!==i&&(u=!0)):h&&(i=e.closest("div"),void 0!==i&&(u=!0)),n=u?window.pageXOffset+i.getBoundingClientRect().right:window.pageXOffset+d.right,o=d.right+window.pageXOffset-20,o+c.width>n&&(o=n-c.width),r=d.bottom+window.pageYOffset+3,r+c.height>p&&(r=d.top+window.pageYOffset-c.height),s._xposition=o,s._yposition=r},setQuery:function(e){var t=this;t.query=e},returnIndex:function(){return this.index},setIndex:function(e){this.index=e}},Linker.prototype={SEARCHURL_TEMPLATE:"http://search.yahoo.co.jp/search?p={{QUERY}}&ei=UTF-8&rkf=1&slfr=1&fr={{FR_TAG}}",SEARCHURL_TEMPLATE_SSH:"https://search.yahoo.co.jp/search?p={{QUERY}}&ei=UTF-8&rkf=1&slfr=1&fr={{FR_TAG}}",makeVariations:function(e){var t=[e];return t.push(e.replace(/[A-Za-z0-9!?()\.]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+65248)})),t.push(e.replace(/[Ａ-Ｚａ-ｚ０-９！？（）．]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})),t},getRelated:function(e){var t,i=this.slink,n=[];for(t=0;t<i.length;t+=1)i[t].Label!==e&&i[t].Label.indexOf(e)!==-1&&n.push(i[t].Label);return n},getLinkUrl:function(e,t){void 0===t&&(t="");var i=isSSH()?this.SEARCHURL_TEMPLATE_SSH:this.SEARCHURL_TEMPLATE;return i.replace("{{QUERY}}",encodeURIComponent(e)).replace("{{FR_TAG}}",this.fr+t)},getLinkableData:function(){var e,t,i,n,o,r=this,a=r.direct,s=[];for(i=0;i<a.length&&!(s.length>=r.linkCount);i++){for(t=a[i],e=!1,o=a[i].Original,n=0;n<s.length;n++)if(s[n].Original.indexOf(o)!==-1){e=!0;break}e||s.push(t)}return s},makeDirectLink:function(e){var t,i,n,o,r,a,s=this,c=s.getLinkableData(),d=[],l=[];if(CONST.ALERT){var p;p="リンク化可能文字列数："+c.length,alert(p)}for(t=0;t<e.length;t++)for(r=e[t].childNodes,i=0;i<r.length;i++)r[i].nodeType===Node.TEXT_NODE&&l.push(r[i]);for(t=0;t<c.length;t++)for(c[t].Counter=0,a=new RegExp(c[t].Original,"gm"),i=0;i<l.length;i++)c[t].Counter+=(l[i].textContent.match(a)||[]).length;for(c=c.sort(function(e,t){return e.Counter!==t.Counter?e.Counter-t.Counter:t.Original.length-e.Original.length}),t=0;t<c.length;t++)n=c[t],o=s.replaceToLink(e,s.makeVariations(n.Original),n.Label),o&&d.push(o);return d},createLink:function(e,t){var i=this,n=document.createElement("span");return n.className=i.linkClass,n.innerHTML=e,n.setAttribute("title",t),n},replaceToLink:function(e,t,i){var n,o,r,a,s,c,d,l,p=this,h=[];for(d=0;d<e.length;d++)for(r=e[d].childNodes,l=0;l<r.length;l++)r[l].nodeType===Node.TEXT_NODE&&h.push(r[l]);var u=h.length;for(d=0;d<u;d++)if(s=h[d],n=p.getMatchPosition(s.nodeValue,t))return o=p.createLink(n[1],i),a=s.splitText(n[0]+n[1].length),c=s.splitText(n[0]),c.parentNode.removeChild(c),a.parentNode.insertBefore(o,a),o},getMatchPosition:function(e,t){var i,n=t.map(function(t){var n=e.length-1;for(i=n;i>-1&&(n=e.substr(0,n+1).indexOf(t),i=n,n!==-1);i--){var o=/^[a-zA-Z0-9ａ-ｚＡ-Ｚ０-９]/.test(t),r=/[a-zA-Z0-9ａ-ｚＡ-Ｚ０-９]$/.test(t),a=/[a-zA-Z0-9ａ-ｚＡ-Ｚ０-９][ \t　]*$/.test(e.substr(0,n)),s=/^[ \t　]*[a-zA-Z0-9ａ-ｚＡ-Ｚ０-９]/.test(e.substr(n+t.length));if(o&&a){if(0===n){n=-1;break}}else{if(!r||!s)break;if(0===n){n=-1;break}}}return[n,t]});for(i=0;i<n.length;i++)if(n[i][0]!==-1)return n[i]}},Logger.prototype={sendViewLog:function(){this.beaconer.doViewBeacon(0)},attachClickLog:function(e,t,i){void 0===t&&(t={}),e.getAttribute("target")?this.attachClickLogForTargetBlank(e,t):this.attachClickLogRegular(e,t,i)},sendClickLog:function(e,t){var i=new Image;t&&(i.onload=i.onerror=i.onabort=function(){location.href=t}),i.src=this.beaconer.getClickBeacon(e)},attachClickLogRegular:function(e,t,i){void 0===t&&(t={}),e.addEventListener("click",function(e){return function(n){n.preventDefault(),e.sendClickLog(t,i)}}(this))},attachClickLogForTargetBlank:function(e,t){void 0===t&&(t={}),e.addEventListener("click",function(e){return function(){e.beaconer.doClickBeacon(t)}}(this))}},LoggerWrapper.prototype={setupLinkLogger:function(e){var t,i=e.length;this.linkParamsMain=[{mod:{name:"dslink"},links:function(){var n=[];for(t=1;t<=i;++t)n.push({params:{sec:"dslink",slk:"main",pos:t.toString(),query:e[t-1].innerHTML}});return n}()}],this.loggerMain=new Logger(this.pageParams,this.linkParamsMain)},setupBottomSheetLogger:function(){this.linkParamsBtms=[{mod:{name:"btms"},links:function(){var e=[];return e.push({params:{sec:"btms",slk:"close"}}),e.push({params:{sec:"btms",slk:"search",pos:"sbtn"}}),e}()}],this.loggerBtms=new Logger(this.pageParams,this.linkParamsBtms)},setupBottomSheetLoggerPC:function(){this.linkParamsBtms=[{mod:{name:"float"},links:function(){var e=[];return e.push({params:{sec:"float",slk:"search"}}),e}()}],this.loggerBtms=new Logger(this.pageParams,this.linkParamsBtms)},setupBottomSheetLoggerAPP:function(){this.linkParamsBtms=[{mod:{name:"float"},links:function(){var e=[];return e.push({params:{sec:"btms",slk:"close"}}),e}()}],this.loggerBtms=new Logger(this.pageParams,this.linkParamsBtms)},setupRelatedLogger:function(e){var t;this.linkParamsRelated=[{mod:{name:"btms"},links:function(){var i=[];for(t=1;t<=e;++t)i.push({params:{sec:"btms",slk:"search",pos:"rel",dpos:t.toString()}});return i}()}],this.loggerRelated=new Logger(this.pageParams,this.linkParamsRelated)},attachBottomSheetLogs:function(e,t){this.loggerBtms.attachClickLog(e,this.linkParamsBtms[0].links[0].params)},attachLinkClickLog:function(e,t){var i,n;for(n=0;n<e.length;++n)i=e[n],this.loggerMain.attachClickLog(i,this.linkParamsMain[0].links[n].params,t?i.href:void 0)},attachLogsRelated:function(e){var t,i,n;for(t=e.length,i=0;i<t;++i)n=e[i],this.loggerRelated.attachClickLog(n,this.linkParamsRelated[0].links[i].params,n.href)},sendViewLog:function(){this.sendLinkViewLog(),this.sendBtmsViewLog()},sendLinkViewLog:function(){this.loggerMain.sendViewLog()},sendBtmsViewLog:function(){this.loggerBtms.sendViewLog()},sendRelatedViewLog:function(){this.loggerRelated.sendViewLog()}},YAHOO=YAHOO||{},YAHOO.JP=YAHOO.JP||{},YAHOO.JP.srch=YAHOO.JP.srch||{},YAHOO.JP.srch.dlink=YAHOO.JP.srch.dlink||{},YAHOO.JP.srch.nhighlight=YAHOO.JP.srch.nhighlight||{},YAHOO.JP.srch.dlink.onLoad=function(e){if(YAHOO.JP.srch.dlink.PARAMS={},e({setParams:function(e){var t=checkUA(),i=checkAppDomain();if(""===t||""===i||e.addFR===t)YAHOO.JP.srch.dlink.PARAMS=e;else if(CONST.ALERT){var n;n="アプリUAでアクセスしたがローダーから呼ばれてない",alert(n)}}}),validateParams()){var t=makeMiffyUrl(YAHOO.JP.srch.dlink.PARAMS.serviceCode);if(""!==t)if(YAHOO.JP.srch.dlink.PARAMS.launchAfterDocLoad){var i=function(){var e=t;return function(){jsonpRequest(e,init,!0)}}();document.addEventListener("DOMContentLoaded",i,!1)}else jsonpRequest(t,init,!0);else YAHOO.JP.srch.dlink.PARAMS.launchAfterDocLoad?document.addEventListener("DOMContentLoaded",function(){init({})},!1):init({})}};
})();