!function(){window.SimplanumWidget=new function(){var e=0,n=!1;Object.defineProperties(String.prototype,{replaceHtmlEntites:{value:function(){var e=this,n=/&(nbsp|amp|quot|lt|gt);/g,t={nbsp:" ",amp:"&",quot:'"',lt:"<",gt:">"};return e.replace(n,function(e,n){return t[n]})},enumerable:!1,writable:!1}});var t=function(){"use strict";var e=function(e,n){var t,r=new RegExp("(?:^|,)"+e.tagName.toLowerCase()+"(?:,|$)"),i=Object.keys(n),o=!1;for(t=0;t<i.length&&!o;t++)r.test(i[t])&&(o=n[i[t]]);return o},n=function(e,n){var t=e.parentNode,r=document.createElement(n);for(e.style.cssText&&(r.style.cssText=e.style.cssText),e.className&&(r.className=e.className);e.childNodes.length>0;)r.appendChild(e.childNodes[0]);t.replaceChild(r,e)},t=function(e,n){var t,r;if("string"==typeof n&&e.style.length){for(t=e.style.length-1;t>=0;t--)r=new RegExp("(?:^|,)"+e.style[t]+"(?:,|$)"),r.test(n)||(e.style[e.style[t]]="");e.style.cssText||e.removeAttribute("style")}},r=function(e,n){var t,r;if("string"==typeof n&&e.classList.length){for(t=e.classList.length-1;t>=0;t--)r=new RegExp("(?:^|\\s)"+e.classList[t]+"(?:\\s|$)"),r.test(n)||e.classList.remove(e.classList[t]);e.className||e.removeAttribute("class")}},i=function(e){var n,t,r=!0,o=/^\s*$/;if(e.hasChildNodes())for(n=0;n<e.childNodes.length&&r;n++)t=e.childNodes[n],1===t.nodeType?r=i(t):3!==t.nodeType||o.test(t.nodeValue)||(r=!1);return r},o=function(e){for(var n=e.parentNode;e.childNodes.length>0;)n.insertBefore(e.childNodes[0],e)},a=function(e){e.nodeValue=e.nodeValue.replace(/\xa0/g," ")},l=function(n,o,l){var s;1===n.nodeType?(s=e(n,o),s?("undefined"==typeof s.valid_elements?d(n,o):d(n,s.valid_elements),s.no_empty&&i(n)?l.push({task:"remove",node:n}):(t(n,s.valid_styles),r(n,s.valid_classes),s.convert_to?l.push({task:"convert",node:n,convert_to:s.convert_to}):n.id&&n.removeAttribute("id"),"function"==typeof s.process&&l.push({task:"process",node:n,process:s.process}))):(d(n,o),n.hasChildNodes()&&l.push({task:"unpack",node:n}),l.push({task:"remove",node:n}))):3===n.nodeType&&a(n)},s=function(e){var t;for(t=0;t<e.length;t++)switch(e[t].task){case"remove":e[t].node.parentNode.removeChild(e[t].node);break;case"convert":n(e[t].node,e[t].convert_to);break;case"process":e[t].process(e[t].node);break;case"unpack":o(e[t].node)}},d=function(e,n){var t,r=[];for(t=0;t<e.childNodes.length;t++)l(e.childNodes[t],n,r);s(r)};return d}(),r=function(e){var n=document.createElement("DIV");return n.innerHTML=e.replace(new RegExp(/\n\n/g),"\n"),n.innerText.replace("&#65279;","")},i=function(e){var n=e.toString(16);return 1===n.length?"0"+n:n},o=function(e){var n=e.split(",");return"#"+i(+n[0])+i(+n[1])+i(+n[2])},a=function(e){return"undefined"==typeof e.type?!1:"undefined"==typeof e.length?!1:0===e.length&&"p"!==e.type?!1:"undefined"==typeof e.location?!1:"clr"!==e.type&&"img"!==e.type&&"link"!==e.type||"undefined"!=typeof e.value?e.location<0?!1:!0:!1},l=function(e,n){var t,r,i,s=e.querySelectorAll("*"),d={},c=s[0];if(c&&"br"!==(t=c.nodeName.toLowerCase())){if(i=e.innerHTML.replaceHtmlEntites().indexOf(c.outerHTML.replaceHtmlEntites()),d.location=i,"mark"===t){if("_mce_caret"===c.id){console.error("pls, contact with developers","span#_mce_caret");for(var m=0;m<c.childNodes.length;m++)e.append(c.childNodes[m]);return e.removeChild(c),e.innerHTML=e.innerHTML.trim(),s=e.querySelectorAll("*"),c=s[0],void(c&&l(e,n))}c.getAttribute("style")&&(r=o(c.style.backgroundColor.match(/rgb\((.*?)\)/)[1]),d.value=r,d.type="clr")}else"a"===t?(r=c.getAttribute("href")||"",d.value=r,d.type="link"):"img"===t?(r=c.src,d.value=r,d.type="img"):"span"===t?c.getAttribute("style")&&"20px"===c.style.fontSize&&(d.type="h"):"h1"===t?d.type="h":"strong"===t?d.type="b":"em"===t?d.type="i":"ul"===t?(d.type="list-marked",d.value="•"):"ol"===t?(d.type="list-numeric",d.value="1-9"):d.type=t;"img"===t?d.length=c.innerText.length+1:d.length=c.innerText.length,e.innerHTML=e.innerHTML.replace(new RegExp(/<[^>]*>/),"").replace(new RegExp("</"+t+">"),""),s=e.querySelectorAll("*"),c=s[0],a(d)&&n.push(d),c&&l(e,n)}},s=function(e,n){var t=e,r=e.match(n);return r&&(t=s(t.replace(r[0],r[1]),n)),t},d=function(e){var n=e;if(-1!==n.indexOf("<ul>")||-1!==n.indexOf("<ol>")){var t=n.indexOf("<br>"),r=n.indexOf("<ul>"),i=n.indexOf("<ol>"),o=n.indexOf("</ul>"),a=n.indexOf("</ol>");n=t>i&&a>t||t>r&&o>t?n.replace(/<br.*?>/g,""):n.replace(/<br.*?>/g,"\n")}else n=n.replace(/<br.*?>/g,"\n");return n=n.replace(/<[^\/>][^>]*><\/[^>]+>/g,function(e){return"<p></p>"===e?"<p></p>":""})},c=function(e){var n,t,r=e,i=/<ul.*?>(.*?)<\/ul>/g,o=/<ol.*?>(.*?)<\/ol>/g,a=/<li>(.*?)<\/li>/g,l=/<li>(.*?)<\/li>/,s=r.match(i);if(s)for(var d=0;d<s.length;d++){n=s[d].match(a);var c=r.indexOf(s[d]),m=r.substring(0,c),u=r.substring(c);if(n){for(var p=0;p<n.length;p++)t=n[p].match(l),u=u.replace(t[0],"	•	"+t[1]+"\n");r=m+u}}var f=r.match(o);if(f)for(var d=0;d<f.length;d++){n=f[d].match(a);var c=r.indexOf(f[d]),m=r.substring(0,c),u=r.substring(c);if(n){for(var p=0;p<n.length;p++)t=n[p].match(l),u=u.replace(t[0],"	"+(p+1)+".	"+t[1]+"\n");r=m+u}}return r},m=function(e){if("object"==typeof e)return e;var n=/<span data-mce-bogus.*?>(.*?)<\/span>/,t=/<span id="_mce_caret".*?>(.*?)<\/span>/,i=c(d(s(s(e,n),t).replace(/\uFEFF/g,"").replace(/&nbsp;/g," "))),o=[],a=document.createElement("DIV"),m=i.replace(new RegExp(/<br[^>]*>/g),"\n");return a.innerHTML=m,l(a,o),JSON.stringify({text:r(i),attributes:o})},u=function(e){var n="";return e.split("\n").map(function(e){n+=e.trim()}),n},p=function(e,n){for(var r,i,o=e.cloneNode(!0),a=["header","footer","nav","script","iframe","textarea","style","img","noscript","input"],l={"h1,h2,h3,h4,h5,h6":{valid_styles:"",valid_classes:"",no_empty:!0,process:function(e){var n,t,r=e.parentNode,i=document.createElement("span"),o=document.createElement("p");for(i.setAttribute("style","font-size: 20px;"),t=0;t<e.childNodes.length;t++)n=e.childNodes[t],"B"===n.nodeName||"STRONG"===n.nodeName?i.innerHTML+="<b>"+n.innerText+"</b>":"I"===n.nodeName||"EM"===n.nodeName?i.innerHTML+="<i>"+n.innerText+"</i>":"A"===n.nodeName?i.innerHTML+='<a href="'+n.href+'">'+n.innerText+"</a>":i.innerHTML+=n.innerText||n.textContent;o.innerHTML=i.outerHTML,r.replaceChild(o,e)}},"div,main,article,aside,blockquote,button":{convert_to:"p",valid_styles:"",valid_classes:"",no_empty:!0},p:{valid_styles:"",valid_classes:"",no_empty:!0,process:function(e){var n=e.parentNode;"%MCEPASTEBIN%"===e.innerText&&n.removeChild(e)}},a:{valid_styles:"",valid_classes:"",no_empty:!0,process:function(e){var n,t=["href"];for(n=0;n<e.attributes.length;n++)-1===t.indexOf(e.attributes[n].name)&&e.removeAttribute(e.attributes[n].name);1===e.childNodes.length&&"#text"===e.childNodes[0].nodeName&&(e.innerHTML=e.innerHTML.trim())}},span:{valid_styles:"font-size,font-weight",valid_classes:"",process:function(e){var n,t=e.parentNode;if(!e.getAttribute("style")||"20px"!==e.style.fontSize){for(n=document.createElement("span");e.childNodes.length>0;)n.appendChild(e.childNodes[0]);t.replaceChild(n,e)}"\ufeff"===e.innerHTML&&e.remove()}},"ul,ol":{valid_styles:"",valid_classes:"",process:function(e){var n,t=[];for(n=0;n<e.attributes.length;n++)-1===t.indexOf(e.attributes[n].name)&&e.removeAttribute(e.attributes[n].name)}},li:{valid_styles:"",valid_classes:"",process:function(e){function n(e){for(var n=!0,t=0;n&&t<e.length;){var r=e[t].nodeName;"#text"!==r&&"EM"!==r&&"STRONG"!==r&&"SPAN"!==r&&"B"!==r&&"I"!==r&&"MARK"!==r&&"U"!==r&&"S"!==r&&"A"!==r&&"BR"!==r&&(n=!1),t++}return n}function t(e,n){setTimeout(function(){c.childNodes[e].innerHTML+=n},100)}function r(e){return"P"===e.nodeName?1===e.childNodes.length?r(e.childNodes[0]):{isValid:n(e.childNodes),innerHTML:e.innerHTML}:{isValid:!1}}function t(e,n){setTimeout(function(){c.childNodes[e].innerHTML+=n},100)}var i,o,a,l,s,d,c=e.parentNode,m=e.childNodes,u=[];m.length;for(i=0;i<e.attributes.length;i++)-1===u.indexOf(e.attributes[i].name)&&e.removeAttribute(e.attributes[i].name);if("UL"!==c.nodeName&&"OL"!==c.nodeName&&console.error("please, contact with developers"),!c.parentNode||"UL"!==c.parentNode.nodeName&&"OL"!==c.parentNode.nodeName)if(1===m.length&&"#text"===m[0].nodeName)"UL"===c.nodeName&&((d=e.innerText.match(/\u2022[ \t](.*?)/))?e.innerText=e.innerText.replace(d[0],""):e.innerText.match(/\u2022/)&&(e.innerText="")),"OL"===c.nodeName&&((d=e.innerText.match(/\d{1,}\.[ \t](.*?)/))?e.innerText=e.innerText.replace(d[0],""):e.innerText.match(/\d{1,}\./)&&(e.innerText=""));else if(n(m))"UL"===c.nodeName&&(d=e.innerHTML.match(/\u2022[ \t](.*?)/))&&(e.innerHTML=e.innerHTML.replace(d[0],"")),"OL"===c.nodeName&&(d=e.innerHTML.match(/\d{1,}\.[ \t](.*?)/))&&(e.innerHTML=e.innerHTML.replace(d[0],""));else{for(s=0;null!=(e=e.previousSibling);)s++;c.childNodes[s]&&c.removeChild(c.childNodes[s]);var p=0,f=0,h=0;for(i=0;i<m.length;i++)if("#text"!==m[i].nodeName||""!==m[i].textContent){if(l=m[i],"UL"===l.nodeName||"OL"===l.nodeName)for(var v=0;v<l.childNodes.length;v++)a=document.createElement("li"),1===l.childNodes[v].nodeType?n(l.childNodes[v].childNodes)?a.innerHTML=l.childNodes[v].innerHTML:a.innerHTML=l.childNodes[v].innerText:a.innerText=l.childNodes[v].textContent,a.innerText.trim()&&(c.insertBefore(a,c.children[p+s]),p++);else{if(o=document.createElement("li"),1===l.nodeType)if("EM"===l.nodeName||"STRONG"===l.nodeName||"B"===l.nodeName||"U"===l.nodeName||"I"===l.nodeName||"S"===l.nodeName||"MARK"===l.nodeName||"A"===l.nodeName||"SPAN"===l.nodeName){if(m[i-1]&&("EM"===m[i-1].nodeName||"STRONG"===m[i-1].nodeName||"B"===m[i-1].nodeName||"U"===m[i-1].nodeName||"I"===m[i-1].nodeName||"S"===m[i-1].nodeName||"MARK"===m[i-1].nodeName||"A"===m[i-1].nodeName||"#text"===m[i-1].nodeName&&m[i-1].textContent||"SPAN"===l.nodeName)){f++;var g=s+h-f;t(g,l.outerHTML),h++;continue}o.innerHTML=l.outerHTML}else{var N=r(l);N.isValid?o.innerHTML=N.innerHTML:o.innerHTML=l.innerText}else if(l.textContent){if(m[i-1]){f++;var g=s+h-f;t(g,l.textContent),h++;continue}o.innerHTML=l.textContent}o.innerText.trim()&&(c.insertBefore(o,c.children[p+s]),p++)}h++}}else 1===c.parentNode.childNodes.length?(n(m)&&("UL"===c.nodeName&&(d=e.innerHTML.match(/\u2022[ \t](.*?)/))&&(e.innerHTML=e.innerHTML.replace(d[0],"")),"OL"===c.nodeName&&(d=e.innerHTML.match(/\d{1,}\.[ \t](.*?)/))&&(e.innerHTML=e.innerHTML.replace(d[0],""))),console.error("please, contact with developers")):(console.log("remove node"),e.remove())}},br:{valid_styles:"",valid_classes:"",process:function(e){var n=e.parentNode,t=document.createTextNode(" ");n.replaceChild(t,e)}},mark:{valid_styles:"background-color",valid_classes:"",no_empty:!0},"b,strong,i,em,s,u":{valid_styles:"",valid_classes:"",no_empty:!0}},s=0;s<a.length;s++){r=[].slice.call(o.getElementsByTagName(a[s]));for(var d=0;d<r.length;d++)r[d].remove()}t(o,l),i=[].slice.call(o.getElementsByTagName("a"));for(var c=0;c<i.length;c++)if(i[c].outerHTML.split("/")[1]){var m=i[c].outerHTML.indexOf("href=");i[c].outerHTML=i[c].outerHTML.substr(0,m+6)+n+i[c].outerHTML.substr(m+6)}return u(o.innerHTML.replace(/  +/g," ").trim())},f=function(t){var r;r=t?t:document.getElementsByClassName("SimplanumContent").length?document.getElementsByClassName("SimplanumContent")[0]:document.body;var i=p(r,document.location.origin)+"<p><a href="+document.location.href+">"+document.title||document.location.href+"</a></p>",o=m(i.replace(/<p><p>/g,"<p>").replace(/<\/p><\/p>/g,"</p>")),a=window.open("https://web.simplanum.com/index/","Simplanum Widget","width=600,height=450,location=no,toolbar=no,menubar=no,resizable=no");e=setInterval(function(){a.postMessage({type:"simplanum",message:o},"*")},3e3),n||(n=!0,window.addEventListener("message",function(n){-1!==n.origin.indexOf("simplanum")&&("OK!"===n.data&&clearInterval(e),"POST-SUCCESS"===n.data&&setTimeout(function(){a.close()},1e3))}))};this.init=function(e,n,t){var r=document.getElementById("SimplanumWidget"),i=document.createElement("img");i.src="https://realnoevremya.ru/assets/journal/images/logo-plan-it.png",i.height=e,i.width=n,i.addEventListener("click",function(){f(t)}),r.appendChild(i)}}}();