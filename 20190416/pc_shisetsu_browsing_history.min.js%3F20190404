var YAHOO=YAHOO||{};YAHOO.JP=YAHOO.JP||{};YAHOO.JP.trv=YAHOO.JP.trv||{};YAHOO.JP.trv.bridge=YAHOO.JP.trv.bridge||{};$(function(){var g=YAHOO.JP.trv.bridge;var o=YAHOO.JP.trv.central;var j="";var a="/api/shisetsubrowsinghistory/hotel";var h=5;var w="asiderec";var v="clsbtn";var c="del_target";var z="del_all_history";var D=0;var E="";var q="";var l=null;try{l=YAHOO.JP.trv.localstorage("browsinghistory")}catch(A){}var k="#swiperContainer";var B="swiperPrev";var C="swiperNext";var d="#swiperPrev";var f="#swiperNext";var t="";function x(){if(!l){return}var F=l.get();if(F&&!$.isArray(F)){F=[F]}F=l.getSort(F,"","desc");F.push({disp_id:q});var e="";if(g!=undefined){e=g.browsing_history_sc_i}F.push({sc_i:e});$.ajax({type:"POST",url:a,data:{data:F},timeout:$.tvPg.timeout,dataType:"json",success:function(G){if(G.ResultSet.Status==="000000"&&(G.ResultSet.Result.length!=0)){y(G.ResultSet.Result);F.pop();F.pop();u(F);i()}else{return}},error:function(){return}})}function y(e){var F=document.getElementById(w);F.innerHTML=e;s();if(YAHOO.JP.trv.ins!=undefined&&!YAHOO.JP.trv.ins.isModuleTracked(w)){YAHOO.JP.trv.ins.addModules(w)}else{YAHOO.JP.trv.ins.refreshModule(w)}}function s(){if(!l){return}var e=document.getElementById(z);if(e){e.addEventListener("click",function(){l.clear();document.getElementById(w).style.display="none"},false)}}function u(H){var F=H.length;D=F;var I=[];for(var G=1;G<=F;G++){var e=document.getElementById(v+G);e.addEventListener("click",function(){var K=this.getAttribute("data-htlcd");var L=this.getAttribute("data-pos");var J=(100+parseInt(L,10));n(K);$(this).parent().hide();D--;YAHOO.JP.trv.ins.beaconClick(w,"item_del",J,{rsec:"view_hist",pos:L});if(D==0){document.getElementById(w).style.display="none"}},false);I.push({rsec:"view_hist",slk:"item_del",pos:G,_p:(100+G)})}YAHOO.JP.trv.ins.beaconLinkViews([{sec:w,_links:I}],false)}function r(){var e=document.getElementById(C);e.addEventListener("click",function(){YAHOO.JP.trv.ins.beaconClick(w,"next",1000,{rsec:"view_hist",pos:0})},false);var F=document.getElementById(B);F.addEventListener("click",function(){YAHOO.JP.trv.ins.beaconClick(w,"prev",1001,{rsec:"view_hist",pos:0})},false)}function i(){var H=document.getElementById(c);var I=H.getAttribute("data-target");if(I!=""){var e=I.split(",");var G=e.length;for(var F=0;F<G;F++){n(e[F])}}}function n(F){if(!l){return}var H=l.get();if(H&&!$.isArray(H)){H=[H]}var e=H.length;for(var G=0;G<e;G++){if(H[G]["data"]["HTL_CD"]==F){H.splice(G,1);break}}l.clear();l.set(H)}function p(){var e={slidesPerView:2.1,roundLengths:true,watchOverflow:true,observer:true,simulateTouch:false,navigation:{nextEl:f,prevEl:d,},on:{slideChange:function(){if(t.activeIndex!=0&&t.activeIndex!=t.slides.length){document.getElementById(B).style.display="block";document.getElementById(C).style.display="block"}},reachEnd:function(){document.getElementById(C).style.display="none";document.getElementById(B).style.display="block"},reachBeginning:function(){document.getElementById(C).style.display="block";document.getElementById(B).style.display="none"},fromEdge:function(){if(t.activeIndex!=0&&t.activeIndex!=t.slides.length){document.getElementById(B).style.display="block";document.getElementById(C).style.display="block"}},},};t=new Swiper(k,e);if(t.slides.length>2){document.getElementById(B).style.display="none";document.getElementById(C).style.display="block"}else{document.getElementById(B).style.display="none";document.getElementById(C).style.display="none"}}function b(){var e=[{rsec:"view_hist",slk:"next",pos:0,_p:"1000"},{rsec:"view_hist",slk:"prev",pos:0,_p:"1001"}];YAHOO.JP.trv.ins.beaconLinkViews([{sec:w,_links:e}],false)}if(!o.getBridgeData("IS_PREMIUM")){return}var m={init:function(){this.bind()},bind:function(){var e=o.getBridgeData("DISP_KEY");q=(e)?e:"";x()}};m.init();return m});