(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"2e9c":function(e,t,n){var s=n("1029"),o=n("d869"),i=n("0592").default,a=n("bfbe"),l=n("4808"),r=n("cf07"),c=n("1cab").default,d=function(e,t){d.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(d,s.Component,{name:"ModalComponent",controllerClassName:a,viewClassName:l,modelClassName:r,controllerListeners:{},getModalContentRoute:null,modalContainerId:"overlay_container",isModalBackgroundClick:!1,isCloseEnabled:!0,isEscKeyPressCloseEnabled:!0,autoRender:!1,contentAjaxParams:{},getModalContentRouteParams:{},contentRouteOptions:null,isFullContentAppend:!0,modelParams:{},modalCloseBtnCls:"close_button",_featureComponent:null,_extendedViewProperties:{},init:function(e,t){this.addEvents(o.ModalComponent.GLOBALEVENT_MODAL_OPENED,o.ModalComponent.GLOBALEVENT_MODAL_CLOSED,o.ModalComponent.GLOBALEVENT_MODAL_BEFORE_OPEN),d.superclass.init.call(this,e,t),this._setController()},_setController:function(){var e=this.controllerClassName;return this._controller instanceof e||(this._controller=new e({items:{ModalView:{component:this._setView(),listeners:{"event-modal-background-click":"onModalBackgroundClick","event-modal-esc-key-pressed":"onModalEscKeyPressed","event-modal-displayed":"onModalDisplayed","event-modal-close-btn-click":"onModalCloseBtnClick","event-modal-show-loader":"onModalShowLoader","event-modal-before-displayed":"onModalBeforeDisplayed"}},ModalModel:{component:this._setModel(),listeners:{}}}}),s.on([{element:this._controller,event:"event-modal-background-click",handler:this.onModalBackgroundClick},{element:this._controller,event:"event-modal-esc-key-pressed",handler:this.onModalEscKeyPressed},{element:this._controller,event:"event-modal-displayed",handler:this.onModalDisplayed},{element:this._controller,event:"event-modal-close-btn-click",handler:this.onModalCloseBtnClick},{element:this._controller,event:"event-modal-show-loader",handler:this.onModalShowLoader},{element:this._controller,event:"event-modal-before-displayed",handler:this.onModalBeforeDisplayed}],this)),this._controller},_setView:function(){var e=this.viewClassName;return this._view instanceof e||(this._view=new e(Ext.apply({},{template:this.template,containerId:this.modalContainerId,model:this._setModel(),autoRender:this.autoRender,isModalBackgroundClick:this.isModalBackgroundClick,isFullContentAppend:this.isFullContentAppend,modalCloseBtnCls:this.modalCloseBtnCls},this._extendedViewProperties))),this._view},_setModel:function(){var e=this.modelClassName;if(!(this._model instanceof e)){var t=this.getModalContentRoute?{url:s.getUrl(this.getModalContentRoute,this.getModalContentRouteParams),params:this.contentAjaxParams}:{};s.isEmpty(this.modelParams)||Ext.apply(t,this.modelParams),this._model=new e({},t)}return this._model},getName:function(){return this.name},destroy:function(){this._featureComponent&&this._featureComponent.destroy(),this._model.destroy(),this._controller.destroy(),d.superclass.destroy.call(this),s.fireEvent(o.ModalComponent.GLOBALEVENT_MODAL_CLOSED,{scope:this})},lock:function(){console.error("Lock function should be overwritten in child component.")},onModalBackgroundClick:function(){this.isModalBackgroundClick&&this.closeModal()},onModalEscKeyPressed:function(){this.isEscKeyPressCloseEnabled&&this.closeModal()},onModalCloseBtnClick:function(){this.closeModal()},closeModal:function(){i.navigateBack()},onModalDisplayed:function(){s.fireEvent(o.ModalComponent.GLOBALEVENT_MODAL_OPENED,{scope:this})},onModalBeforeDisplayed:function(){c.push({event:c.CONST.EVENT.OPTIMIZE_SHOW_OVERLAY}),s.fireEvent(o.ModalComponent.GLOBALEVENT_MODAL_BEFORE_OPEN,{scope:this})},onModalShowLoader:function(){s.fireEvent(o.ModalComponent.GLOBALEVENT_MODAL_SHOW_LOADER)},isClosable:function(){return this.isCloseEnabled}})},4808:function(e,t,n){var s=n("1029"),o=n("d869"),i=n("7ab0"),a=n("a9a1").store,l=n("af42"),r=function(e){r.superclass.constructor.call(this,e)};e.exports=Ext.extend(r,s.View,{name:"ModalView",modalBackgroundId:"overlay",modalShowCls:"overlay_show",showCls:"show",showLoaderCls:"show_loader",disableCloseCls:"disable_close",hideOverlayContentCls:"overlay_content_hide",showLoaderTimeoutDelay:200,_modalDisplayed:!1,debounceWait:200,init:function(){this.getContainerElements(),r.superclass.init.call(this),this.addEvents(o.ModalView.MODAL_BACKGROUND_CLICK,o.ModalView.MODAL_CLOSE_BTN_CLICK,o.ModalView.MODAL_ESC_KEY_PRESSED,o.ModalView.MODAL_BEFORE_DISPLAYED,o.ModalView.MODAL_DISPLAYED,o.ModalView.MODAL_SHOW_LOADER),this.autoRender||this.template||(this.model.fetch({success:s.bind(this._onGetModalSuccess,this),error:s.bind(this._onGetModalError,this)}),this.showLoader()),this._showContainers()},getContainerElements:function(){this._modalBackgroundEl=Ext.get(this.modalBackgroundId),this._modalContainerEl=Ext.get(this.containerId),this._bodyEl=Ext.getBody()},render:function(){this.autoRender||(this.element=i.createElementFromHtmlString(this.model.getContent(),this.isFullContentAppend)),r.superclass.render.call(this),this._afterRender()},_afterRender:function(){this._appendModal(),this._bindModalCloseBtnClickEvent(),this._sendDisplayedEvent()},_sendDisplayedEvent:function(){this.fireEvent(o.ModalView.MODAL_DISPLAYED,this),this._modalDisplayed=!0,a.dispatch(l.markOverlayAsVisible)},_appendModal:function(){this.containerId&&this._modalContainerEl&&(this._hideModalContainer(),this._modalContainerEl.appendChild(this.element),this.fireEvent(o.ModalView.MODAL_BEFORE_DISPLAYED,this),this.element.addClass(this.showCls),this._showModalContainer(),this.hideLoader())},_hideModalContainer:function(){this._modalContainerEl.addClass(this.hideOverlayContentCls)},_showModalContainer:function(){this._modalContainerEl.removeClass(this.hideOverlayContentCls)},_onGetModalSuccess:function(){this.render()},_onGetModalError:function(e){console.warn("Get modal content error: ",e),this._hideContainers()},_showContainers:function(){this._modalBackgroundEl.addClass(this.showCls),this._modalContainerEl.addClass(this.showCls),this._bodyEl.addClass(this.modalShowCls)},showLoader:function(){s.delay(s.bind(function(e){this.fireEvent(o.ModalView.MODAL_SHOW_LOADER),this._modalDisplayed||this._modalContainerEl.addClass(e)},this),this.showLoaderTimeoutDelay,this.showLoaderCls)},hideLoader:function(){this._modalContainerEl.removeClass(this.showLoaderCls)},_hideContainers:function(){this._modalBackgroundEl.removeClass(this.showCls),this._modalContainerEl.removeClass(this.showCls),this._bodyEl.removeClass(this.modalShowCls),a.dispatch(l.markOverlayAsHidden)},destroy:function(){this._hideContainers(),r.superclass.destroy.call(this)},_bindModalCloseBtnClickEvent:function(){s.on([{element:this.element,event:"click",handler:s.debounce(this.onModalCloseBtnClick,this.debounceWait,!0),scope:this,options:{delegate:"."+this.modalCloseBtnCls}}],this)},onModalCloseBtnClick:function(e){e.preventDefault(),this.fireEvent(o.ModalView.MODAL_CLOSE_BTN_CLICK)},onModalBackgroundClick:function(){this._modalDisplayed&&this.fireEvent(o.ModalView.MODAL_BACKGROUND_CLICK)},onEscKeyUp:function(e){this._modalDisplayed&&e.keyCode===o.ModalView.ESC_KEY_CODE&&!this.model.getIsOnFullScreen()&&this.isTopModal()&&this.fireEvent(o.ModalView.MODAL_ESC_KEY_PRESSED)},isTopModal:function(){return!Ext.getBody().hasClass("overlay_prevent_scroll")},onFullScreenChange:function(){this.model.setIsOnFullScreen(s.Util.isFullScreen())},isClosable:function(){return!this._modalContainerEl.hasClass(this.disableCloseCls)},bind:function(){r.superclass.bind.call(this);var e=s.debounce(this.onFullScreenChange,this.debounceWait,!1);s.on([{element:Ext.fly(document),event:"keyup",handler:s.debounce(this.onEscKeyUp,this.debounceWait,!0)},{element:this._modalContainerEl,event:"click",handler:s.debounce(this.onModalBackgroundClick,this.debounceWait,!0),options:{target:this._modalContainerEl.dom}},{element:Ext.fly(window),event:"webkitfullscreenchange",handler:e},{element:Ext.fly(window),event:"mozfullscreenchange",handler:e},{element:Ext.fly(window),event:"fullscreenchange",handler:e},{element:Ext.fly(window),event:"MSFullscreenChange",handler:e}],this)}})},"4b39":function(e,t,n){var s=n("1029"),o=n("d869"),i=n("4808"),a=n("7ab0"),l=n("9381"),r=function(e){r.superclass.constructor.call(this,e)};e.exports=Ext.extend(r,i,{name:"PaymentModalView",popupBoxCls:"popup_box",commercialPageTemplateCls:"commercial_page_template",bodyEl:Ext.getBody(),firstBillCls:"firstbill",countdownSelector:".countdown",countdownUnbinders:[],render:function(){r.superclass.render.call(this),this._initializeTimers()},destroy:function(){for(r.superclass.destroy.call(this);this.countdownUnbinders.length;)this.countdownUnbinders.pop()()},getModalContent:function(){var e=this.element.select("."+this.commercialPageTemplateCls).item(0).dom.innerHTML;return new Ext.Template(e).apply()},changeModalContent:function(e){this.element.html(e),this._modalContainerEl.removeClass(this.disableCloseCls),this._initializeTimers()},showCommercial:function(){var e=this.getModalContent();this.changeModalContent(e)},_onGetModalSuccess:function(e){e.json.data.action!==o.PaymentModalComponent.PAYMENT_ACTION_REDIRECT?this.render():this.paymentRouterRedirect()},_onGetModalError:function(e){console.warn("Get modal content error: ",e),this.paymentRouterRedirect()},_showContainers:function(){r.superclass._showContainers.call(this),this.bodyEl.addClass(this.firstBillCls)},_hideContainers:function(){r.superclass._hideContainers.call(this),this.bodyEl.removeClass(this.firstBillCls)},paymentRouterRedirect:function(){a.setCursor("wait"),location.href=s.Config.get("getCreditsUrl")},_initializeTimers:function(){Array.prototype.forEach.call(this.element.dom.querySelectorAll(this.countdownSelector),function(e){this.countdownUnbinders.push(l.initCountdown(e))}.bind(this))}})},"547a":function(e,t,n){var s=n("1029"),o=n("d869"),i=n("2e9c"),a=n("9c7a"),l=n("4b39"),r=n("7ab0"),c=n("e568"),d=n("ae82"),h=n("a5c5"),u=n("1cab").default,m=function(e,t){m.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(m,i,{name:o.PaymentModalComponent.NAME,getModalContentRoute:"PaymentRouter/Router",contentAjaxParams:{},paymentRouterAjaxCallTimeout:30,viewClassName:l,firstBillActionParams:{},_featureComponent:null,init:function(e,t){this.addEvents(o.ModalComponent.GLOBALEVENT_PAYMENT_MODAL_CLOSED),this._setModelParams(),this.contentAjaxParams={},this.isFirstBillCompleted&&(this.contentAjaxParams.firstBillCompleted=1),this.firstBillActionParams.isForced&&(this.contentAjaxParams.isFirstBillForced=1),m.superclass.init.call(this,e,t)},_setModelParams:function(){var e=1e3*s.Config.get("paymentRouterAjaxCallTimeout",this.paymentRouterAjaxCallTimeout);this.modelParams={timeout:e,isUnsecuredUrl:!0}},onModalDisplayed:function(e){m.superclass.onModalDisplayed.call(this);var t=e.getModelAttributes(),n=t.action;t.isSmartBuyAvailable&&(s.Config.set("isOverlayPending",!1),c.setIsSmartBuyAvailable(!0),a.getInstance().setSmartBuyCsrfToken(t.smartBuyCsrfToken)),n===o.PaymentModalComponent.PAYMENT_ACTION_QUICKBUY?this._featureComponent=new d(this.element,{isMinimizeEnabled:!0,useMask:r.isChatPage()}):this._featureComponent=new h(this.element,{isReOpen:Boolean(this.firstBillActionParams.token),storedToken:this.firstBillActionParams.token,selectedPackage:this.firstBillActionParams.selectedPackage,isShowCommercialPopupEnabled:this.origin!==o.FirstBill.FIRST_BILL_RETRY_ROUTE_PARAM})},onModalEscKeyPressed:function(){this._view.isClosable()?m.superclass.onModalEscKeyPressed.call(this):(this.showCommercial(),this.refreshCreditPackagesOnFirstbill())},onModalCloseBtnClick:function(){this._view.isClosable()?m.superclass.onModalCloseBtnClick.call(this):(this.showCommercial(),this.refreshCreditPackagesOnFirstbill())},showCommercial:function(){var e;e=this._featureComponent instanceof h?"/first-bill/commercial":this._featureComponent instanceof d?"/quick-buy/commercial":"/unknown/commercial",u.trackPaymentPage(e),this._view.showCommercial()},refreshCreditPackagesOnFirstbill:function(){this._featureComponent instanceof h&&this._featureComponent.refreshCreditPackages()},onChangeContent:function(e){this._view.changeModalContent(e.content)},destroy:function(){s.fireEvent(o.PaymentModalComponent.GLOBALEVENT_PAYMENT_MODAL_CLOSED,{scope:this}),m.superclass.destroy.call(this)},bind:function(){m.superclass.bind.call(this),s.on([{element:s.Broadcaster,event:o.FirstBillComponent.GLOBALEVENT_CHANGE_CONTENT,handler:this.onChangeContent}],this)}})},9381:function(e,t,n){"use strict";n.r(t),n.d(t,"initCountdown",function(){return s});var s=function(e){var t=new Date(e.getAttribute("data-count-to")).getTime(),n=e.getAttribute("data-delimiter")||":";e.innerHTML=i(t,n);var s=setInterval(function(){var o=i(t,n);o?e.innerHTML=o:clearInterval(s)},1e3);return function(){return clearInterval(s)}},o=function(e){for(;e.toString().length<2;)e="0"+e;return e},i=function(e,t){var n=e-(new Date).getTime();if(!(n<0))return function(e,t){return e.map(o).join(t)}([Math.floor(n/36e5),Math.floor(n%36e5/6e4),Math.floor(n%6e4/1e3)],t)}},ae82:function(e,t,n){var s=n("1029"),o=n("d869"),i=n("5f9e"),a=n("7ab0"),l=n("9c7a"),r=n("5fae"),c=n("22f6"),d=n("0592").default,h=n("1cab").default,u=function(e,t){u.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(u,s.Component,{name:"QuickBuyComponent",mainPageId:"packages",packageBoxCls:".package",inProgressPageId:"transaction_process",successPageId:"transaction_success",errorPageId:"transaction_failure",packageValueSel:".package_value",animationTime:.5,isMinimizeEnabled:!0,minimizedBlockIdPrefix:"minimized_",startPurchaseRoute:"QuickBuy/StartPurchaseFromOverlay",useMask:!1,containerMaskCls:"container_mask",showCls:"show",popupBoxCls:"popup_box_container",bonusByPackageCls:"bonus_by_package",_packageBoxItems:null,_selectedCreditValue:"",_purchaseParams:{},init:function(e,t){this.addEvents(o.QuickBuyComponent.SET_QUICKBUY_PURCHASE_STATUS_CHECKER_COMPONENT,o.QuickBuyComponent.GLOBALEVENT_QUICKBUY_CREDIT_PACKAGE_CLICKED),u.superclass.init.call(this,e,t),l.getInstance().addNewButton({target:this.name}),this._selectElements(),this._setPurchaseParams(),this._setPopupBoxCls(),h.trackPaymentPage("/quick-buy/packages")},_setPurchaseParams:function(){this._purchaseParams={status:null,purchaseKey:null,credit:null,lang:s.I18n.getLanguage(),sessionId:a.getSessionId()}},_setPopupBoxCls:function(){Ext.get("quickbuy").select("."+this.popupBoxCls).item(0).addClass(this.bonusByPackageCls)},getTime:function(e){return e.getFullYear()+"."+(e.getMonth()+1)+"."+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},_selectElements:function(){if(this._mainPageEl=Ext.get(this.mainPageId),this._packageBoxItems=this.element.select(this.packageBoxCls),this._minimizedInProgressPageHtmlString=Ext.get(this.minimizedBlockIdPrefix+this.inProgressPageId).html(),this._minimizedSuccessPageHtmlString=Ext.get(this.minimizedBlockIdPrefix+this.successPageId).html(),this._minimizedErrorPageHtmlString=Ext.get(this.minimizedBlockIdPrefix+this.errorPageId).html(),!this._mainPageEl||!this._packageBoxItems)throw"@JS-ERROR: Error catched during initialization process: Could not retrieve all the important elements"},onSelectPackageClick:function(e,t){e.preventDefault(),s.fireEvent(o.QuickBuyComponent.GLOBALEVENT_QUICKBUY_CREDIT_PACKAGE_CLICKED);var n=Ext.get(t).findParent(this.packageBoxCls,50,!0);this._selectedCreditValue=n.select(this.packageValueSel).item(0).html(),this._showInProgressMask(!0),this._startPurchase()},_insertTrackingIframe:function(){var e=s.Cookie.get("session");if(s.Cookie.get("lastSession")!==e){var t=document.createElement("iframe");t.id="secureQbt",t.style.cssText="width:0; height:0; border:0; border:none",t.src=s.Config.get("secureTrackingUrl")+"?siteSessionId="+e,document.body.appendChild(t),s.Cookie.set("lastSession",e)}},_startPurchase:function(){if(!JSM.window.blockDuplication){this._insertTrackingIframe();var e=new Date,t={credit:this._selectedCreditValue,lang:s.I18n.getLanguage(),jsdatum:this.getTime(e),jstz:e.getTimezoneOffset()/60,jstimestamp:e.getTime(),session:s.Cookie.get("session")};i.request({url:s.getUrl(this.startPurchaseRoute,{},{},""),params:t,method:"POST",type:o.Chaos.Connection.TYPE_JSON,scope:this,success:this._startPurchaseSuccess,error:this._startPurchaseError,failure:this._startPurchaseError}),JSM.window.blockDuplication=!0}},_startPurchaseSuccess:function(e){s.getPath(e,"json.success")&&s.getPath(e,"json.purchaseStatus")===o.QuickBuyComponent.STATUS_PENDING||this._terminatePurchaseProcess(),JSM.window.blockDuplication=!1,Ext.apply(this._purchaseParams,{status:o.QuickBuyComponent.STATUS_PENDING,credit:this._selectedCreditValue,purchaseKey:e.json.purchaseKey});var t={animationTime:this.animationTime,purchaseParams:this._purchaseParams,purchaseStatusHtmlStrings:{successHtmlString:this._minimizedSuccessPageHtmlString,errorHtmlString:this._minimizedErrorPageHtmlString,pendingHtmlString:this._minimizedInProgressPageHtmlString}};this._showInProgressMask(!1),this.isMinimizeEnabled?t.viewClassName=r:t.viewClassName=c,s.fireEvent(o.QuickBuyComponent.SET_QUICKBUY_PURCHASE_STATUS_CHECKER_COMPONENT,t),this.isMinimizeEnabled&&d.navigate("/",{trigger:!0,replace:!0,preventNavigateBack:!0})},_startPurchaseError:function(){this._terminatePurchaseProcess()},_terminatePurchaseProcess:function(){delete this._purchaseParams,JSM.window.blockDuplication=!1,d.navigate("payment-failed",{trigger:!0,replace:!0,preventNavigateBack:!1})},_showInProgressMask:function(e){if(this.useMask){var t=this.element.select("."+this.containerMaskCls).item(0);e?t.addClass(this.showCls):t.removeClass(this.showCls)}},onSmartBuyActivated:function(){this.setSmartBuySuccessfulTooltip(),d.navigateBack()},setSmartBuySuccessfulTooltip:function(){s.fireEvent(o.TooltipView.EVENT_SHOW_TOOLTIP,{element:Ext.get("get_credits_link").dom,attributes:{target:!0,autoHide:4e3,title:".smartbuy_success_tooltip",trigger:"sticky",position:"bottom",size:"small",width:600}})},destroy:function(){u.superclass.destroy.call(this)},bind:function(){u.superclass.bind.call(this),s.on([{element:this.element.select(this.packageBoxCls),event:"click",handler:this.onSelectPackageClick},{element:s.Broadcaster,event:o.SmartBuyActivationComponent.GLOBALEVENT_ACTIVATE_SMART_BUY_SUCCESS,handler:this.onSmartBuyActivated}],this)}})},bfbe:function(e,t,n){var s=n("1029"),o=n("d869"),i=function(e,t){i.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(i,s.Controller,{name:"ModalController",init:function(e,t){i.superclass.init.call(this,e,t),this.addEvents(o.ModalController.MODAL_BACKGROUND_CLICK,o.ModalController.MODAL_ESC_KEY_PRESSED,o.ModalController.MODAL_DISPLAYED,o.ModalController.MODAL_BEFORE_DISPLAYED,o.ModalController.MODAL_CLOSE_BTN_CLICK,o.ModalController.MODAL_SHOW_LOADER)},onModalCloseBtnClick:function(){this.fireEvent(o.ModalController.MODAL_CLOSE_BTN_CLICK)},onModalBackgroundClick:function(){this.fireEvent(o.ModalController.MODAL_BACKGROUND_CLICK)},onModalEscKeyPressed:function(){this.fireEvent(o.ModalController.MODAL_ESC_KEY_PRESSED)},onModalDisplayed:function(){this.fireEvent(o.ModalController.MODAL_DISPLAYED,this)},onModalBeforeDisplayed:function(){this.fireEvent(o.ModalController.MODAL_BEFORE_DISPLAYED,this)},onModalShowLoader:function(){this.fireEvent(o.ModalController.MODAL_SHOW_LOADER,this)},getModelAttributes:function(){return this.ModalModel.attributes}})},cf07:function(e,t,n){var s=n("1029").Model,o=function(e,t){o.superclass.constructor.call(this,e,t)};e.exports=Ext.extend(o,s,{name:"ModalModel",_isOnFullScreen:!1,setIsOnFullScreen:function(e){this._isOnFullScreen=e},getIsOnFullScreen:function(){return this._isOnFullScreen}})}}]);