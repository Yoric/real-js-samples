!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var i in n)("object"==typeof exports?exports:t)[i]=n[i]}}(window,function(){return function(n){var i={};function o(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=n,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/js/cmpld/",o(o.s=880)}({1:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=console&&console.groupCollapsed&&console.groupEnd&&console.log&&!1,i=function(){function t(t){var e=new Date;this.state={messages:t,prefix:"["+e.getHours()+":"+a(e.getMinutes())+":"+a(e.getSeconds())+"]",icon:"ü§ñ"}}return t.prototype.toArray=function(){var t=this.state,e=t.icon,n=t.prefix,i=t.messages;return[e,n].concat(i)},t.prototype.str=function(){return this.toArray().join(" ")},t.prototype.prefix=function(t){return this.state.prefix=t,this},t.prototype.log=function(){return this.state.icon="ü§ñ",this},t.prototype.info=function(){return this.state.icon="üíÅ‚Äç‚ôÇÔ∏è",this},t.prototype.error=function(){return this.state.icon="üí©",this},t.prototype.warn=function(){return this.state.icon="üò¢",this},t.prototype.icon=function(t){return this.state.icon=t,this},t}();function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new i(t)}function o(t,e){return void 0===e&&(e=[]),r?(n=Function.prototype.bind).call.apply(n,[console[t],console].concat(e)):function(){};var n}function a(t){return(9<t?"":"0")+t}e.FormatDescriptor=i,e.format=s,e.print={log:o("log",s().log().toArray()),info:o("info",s().info().toArray()),warn:o("warn",s().warn().toArray()),error:o("error",s().error().toArray()),groups:function(t,e){if(r){console.groupCollapsed(s(t).str());for(var n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];console.groupCollapsed(o),console.log.apply(console,e[o]),console.groupEnd()}console.groupEnd()}}}},161:function(t,n,e){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),i(e(162)),i(e(176))},162:function(t,e,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},a=this&&this.__awaiter||function(r,s,a,l){return new(a||(a=Promise))(function(t,e){function n(t){try{o(l.next(t))}catch(t){e(t)}}function i(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,i)}o((l=l.apply(r,s||[])).next())})},l=this&&this.__generator||function(n,i){var o,r,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(s=2&e[0]?r.return:e[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;switch(r=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],r=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},h=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},u=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),c=n(163),b=n(50),p=n(165),w=n(168),d=n(32),P=n(61),L=n(171),f=n(173),m=n(174),_=n(175),g=n(32),T=n(62),y=n(63),E={answer:"js-survey__answer",answerInput:"js-survey__answer-input"},S={exclude:"data-exclude",withInput:"data-with-input"},x=-1,r=function(r){function o(){var a=null!==r&&r.apply(this,arguments)||this;return a._events={"submit:form":function(t){a.handleSubmit(t)},"click:button-reset":function(t){t.preventDefault(),a.reset()},"click:button-next":function(t){t.preventDefault();var e=a.getState(),n=e.currentIndex,i=e.survey,o=e.payload,r=n+1,s=i.questions[r];s?a.setState(function(t){return v({},t,{currentAnswer:null,currentIndex:r,currentQuestion:s,currentType:"question",hasUserInteractedWithSurvey:!0})}):a.vote(o)},"change:input":function(t){t.preventDefault();var n=S,e=t.target,i=e.getAttribute(n.exclude),o=e.getAttribute(n.withInput);if("checkbox"===e.type&&e.checked&&a.getElements("input").forEach(function(t){var e=t.getAttribute(n.exclude);(i&&!e||!i&&e)&&(t.checked=!1)}),o&&e.checked){var r=a.getElements("input-custom")[0];r&&r.focus()}},"click:input-custom":function(t){var e,n,i=E,o=t.target,r=o.parentNode;if(null!==r){for(;"DIV"!==r.tagName||!r.classList.contains(i.answer);)r=r.parentNode;if(r){var s=r.getElementsByClassName(i.answerInput),a=Array.prototype.slice.call(s);try{for(var l=h(a),u=l.next();!u.done;u=l.next()){u.value.checked=!0}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}}o.focus()}}},a}return s(o,r),o.processDataBeforePost=function(o){return Object.keys(o).reduce(function(t,e){var n=o[e];if(Array.isArray(n)){var i=n.length;0!==i&&(t[e]=1===i?n[0]:n)}else(n||"number"==typeof n)&&(t[e]=n);return t},{})},o.prototype.handleQuizStepForm=function(t){var e=this.getState().survey,n=b.serializeObject(t),i=L.findAnswersIds(n),o=n.question[0],r=P.findItem(o,e.questions);if(r)if(0!==Object.keys(i).length){var s=u(P.findItems(i,r.answers),1)[0];if(s){var a=s.right?r.correct:r.incorrect;this.setState(function(t){return v({},t,{currentAnswer:a,currentType:"answer",errors:{},hasUserInteractedWithSurvey:!0,payload:v({},t.payload,L.packPayload(r,i))})})}}else this.setState(function(t){var e;return v({},t,{errors:(e={},e[o]=[d.errorRequired()],e),hasUserInteractedWithSurvey:!0})})},o.prototype.handleSubmit=function(t){t.preventDefault&&t.preventDefault();var e=t.target,n=this.options.layout.type,i=this.type;if("step"!==n&&"sidebar"!==n||"poll"!==i&&"exam"!==i&&"survey"!==i){if("all"===n&&"poll"===i||"exam"===i||"survey"===i)throw new Error("not implemented");"quiz"===i&&this.handleQuizStepForm(e)}else this.handleSurveyStepForm(e)},o.prototype.handleSurveyStepForm=function(t){var e=this.getState(),n=e.currentIndex,i=e.payload,o=e.survey,r=o.questions,s=o.questionsById,a=b.serializeObject(t),l=a.question[0],u=s[l],h=L.findAnswersIds(a),c=(a.answer_custom||[]).filter(function(t){return t});if(u){var p=u.answers,d=u.options,f=!p||0===p.length,m=P.findItems(h,p),_=f?[]:w.validateAnswers(d,m,c);if(_.length)this.setState(function(t){var e,n;return v({},t,{errors:(e={},e[l]=_,e),formState:(n={},n[l]=L.saveQuestionState(h,c),n),hasUserInteractedWithSurvey:!0})});else{var g=v({},i,L.packPayload(u,h,c)),y=T.findNextQuestion(n,r,g);y?this.setState(function(t){return v({},t,{currentQuestion:y,currentIndex:P.itemIndex(y.id,r),errors:{},formState:{},hasUserInteractedWithSurvey:!0,payload:g})}):this.vote(g)}}},Object.defineProperty(o.prototype,"type",{get:function(){var t=this.getState().survey;return t&&t.type||"poll"},enumerable:!0,configurable:!0}),o.prototype.vote=function(n){return a(this,void 0,void 0,function(){var e,i;return l(this,function(t){switch(t.label){case 0:e=this.options.url,this.setState(function(t){return v({},t,{errors:{},formState:{},hasUserInteractedWithSurvey:!0,isBusy:!0,payload:n})}),t.label=1;case 1:return t.trys.push([1,4,,5]),[4,fetch(e,{credentials:"include",method:"POST",body:JSON.stringify(o.processDataBeforePost(n)),headers:{Accept:"application/json, application/xml, text/plain, text/html, *.*","Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}})];case 2:return[4,t.sent().json()];case 3:return i=t.sent(),this.setState(function(t){var e=t.survey;if(i.error)return v({},t,{currentState:"ready",errors:{server:[i.message]},isBusy:!1});if(0<(e.max_votes||0)){var n=f.readVotesCount(e.id);f.saveVotesCount(e.id,n+1)}return v({},t,{currentQuestion:null,currentState:"done",errors:{},isBusy:!1,survey:i,voteAttempts:f.getVoteAttempts(e.id,e.max_votes||0)})}),[3,5];case 4:return t.sent(),this.setState(function(t){return v({},t,{currentState:"ready",isBusy:!1,errors:{server:[g.errorServer500()]}})}),[3,5];case 5:return[2]}})})},o.prototype.scrollUp=function(){var t=this.getElements("scroll-anchor")[0],e=this.options.style.offsetTop;if(t)p.scrollTo(t.offsetTop+e);else{var n=this.$;p.scrollTo(n.offsetTop+e)}},o.prototype.fetchSurvey=function(){return a(this,void 0,void 0,function(){var e,r,s,n,i;return l(this,function(t){switch(t.label){case 0:return t.trys.push([0,7,,8]),e=this.options.url,[4,fetch(e,{credentials:"include"})];case 1:return[4,t.sent().json()];case 2:r=t.sent(),t.label=3;case 3:return t.trys.push([3,5,,6]),[4,m.getAuth()];case 4:return s=t.sent(),[3,6];case 5:return n=t.sent(),console.error(n),s=null,[3,6];case 6:return this.setState(function(t){if(r.error)return v({},t,{currentState:"error",errors:{server:[r.message]}});var e=t.layout,n=(c.parse(r.stop_date.rfc3339)||0)>new Date,i=f.getVoteAttempts(r.id,r.max_votes);_.preload(r);var o=r.questions;return r.questionsById=T.mapToDictById(o),v({},t,{layout:v({},e,{showCounter:"survey"!==r.type}),authorized:!!s,currentQuestion:o[t.currentIndex],currentState:L.resolveSurveyInitialStateByType(r.type,n,i),isActive:n,survey:r,type:r.type,voteAttempts:i})}),[2,r];case 7:return i=t.sent(),console.error(i),this.setState(function(t){return v({},t,{currentState:"error",errors:{server:[i.message]}})}),[3,8];case 8:return[2]}})})},o.prototype.render=function(t,e){var n=this,i=this.options.style.allowScrollUp;if(r.prototype.render.call(this,t,e),e&&("done"===e.currentState&&this.options.onFinish(e,this.$),-1===["error","loading"].indexOf(e.currentState))){i&&e.hasUserInteractedWithSurvey&&-1!==["done","step","ready"].indexOf(e.currentState)&&this.scrollUp();var o=e.currentQuestion;!o||o.id===x||o.answers&&0!==o.answers.length||(x=o.id,setTimeout(function(){var t=n.$elements.form;t&&t[0]&&(y.log("–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–±–º–∏—Ç –≤–æ–ø—Ä–æ—Å–∞"),n.handleSubmit({target:t[0]}))},50))}},o.prototype.reset=function(){r.prototype.reset.call(this),this.setState(function(t){return v({},t,{hasUserInteractedWithSurvey:!0})})},o.prototype.init=function(){this.fetchSurvey()},o.prototype.getDefaultOptions=function(){return{onFinish:function(t,e){},style:{offsetTop:0,allowScrollUp:!0},layout:{type:"step",allowRepeat:!0,showIndex:!1,showResultIndex:!0,showCounter:!0,showHeader:!0,showResults:!0}}},o.prototype.getInitialState=function(){return{layout:this.options.layout,authorized:!1,voteAttempts:0,currentIndex:0,currentState:"loading",currentType:"question",errors:{},formState:{},isBusy:!1,hasUserInteractedWithSurvey:!1,payload:{json:1},survey:{}}},o.registryName="SurveyComponent",o}(o.TemplateComponent);e.SurveyComponent=r,o.registerComponent(r)},163:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(e(164))},164:function(t,h,e){"use strict";Object.defineProperty(h,"__esModule",{value:!0}),h.DATE_METHOD_MAP={date:["getDate","setDate"],year:["getFullYear","setFullYear"],hours:["getHours","setHours"],milliseconds:["getMilliseconds","setMilliseconds"],minutes:["getMinutes","setMinutes"],month:["getMonth","setMonth"],seconds:["getSeconds","setSeconds"],time:["getTime","setTime"]},h.shift=function(t,e,n){void 0===n&&(n=1);var i=h.DATE_METHOD_MAP[e],o=i[0],r=i[1],s=Date.prototype[o],a=Date.prototype[r],l=new Date(t.getTime()),u=s.call(l);return a.call(l,u+n),l};var a=[{expr:/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})([+-]\d{2}):(\d{2})$/,pass:function(t,e){var n=t.exec(e);if(null!==n){var i=n.slice(1).map(function(t){return parseInt(t,10)}),o=i[0],r=i[1],s=i[2],a=i[3],l=i[4],u=i[5],h=i[6],c=i[7],p=(new Date).getTimezoneOffset()+60*h+c;return new Date(o,r-1,s,a,l-p,u)}}}];h.parse=function(t){var e=Date.parse(t);if(NaN!==e)return new Date(e);for(var n=0,i=a;n<i.length;n++){var o=i[n],r=o.expr,s=o.pass;if(r.test(t))return s(r,t)}},h.daysInMonth=function(t){return 32-new Date(t.getFullYear(),t.getMonth(),32).getDate()},h.getDayOfWeek=function(t){var e=t.getDay()-1;return e<0?6:e},h.isWeekend=function(t){var e=t.getDay();return 6===e||0===e},h.isPast=function(t,e){return void 0===e&&(e=new Date),e.getTime()>t.getTime()},h.isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},h.daysEq=function(t,e){var n=t.getDate()===e.getDate(),i=t.getMonth()===e.getMonth();return t.getFullYear()===e.getFullYear()&&i&&n}},165:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(e(166))},166:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(167),l=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){setTimeout(t,1e3/60)};e.scrollTo=function(i,t,e){void 0===t&&(t=1e3),void 0===e&&(e="easeOutSine");var o=a[e],r=window.scrollY,s=0;!function t(){var e=(s+=1/60)/.5,n=o(e);e<1?(l(t),window.scrollTo(0,r+(i-r)*n)):window.scrollTo(0,i)}()}},167:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Math.PI/2;function o(e){return function(t){return Math.pow(t,e)}}function r(e){return function(t){return 1-Math.abs(Math.pow(t-1,e))}}function s(t){var e=o(t),n=r(t);return function(t){return t<.5?e(2*t)/2:n(2*t-1)/2+.5}}e.linear=s(1),e.easeInQuad=o(2),e.easeOutQuad=r(2),e.easeInOutQuad=s(2),e.easeInCubic=o(3),e.easeOutCubic=r(3),e.easeInOutCubic=s(3),e.easeInQuart=o(4),e.easeOutQuart=r(4),e.easeInOutQuart=s(4),e.easeInQuint=o(5),e.easeOutQuint=r(5),e.easeInOutQuint=s(5),e.easeOutSine=function(t){return Math.sin(t*i)},e.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)}},168:function(t,e,n){"use strict";var c=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};Object.defineProperty(e,"__esModule",{value:!0});var p=n(32);e.validateAnswers=function(s,i,a){if(!s)return[];var l=s.answer_required,t=s.min_answers,e=s.max_answers,u=s.user_input_min_length,h=s.user_input_max_length,n=i.length,o=t!==e;return[function(){return l&&o&&(n<t||e<n)?p.errorRange(t,e):null},function(){return l&&o&&n<t&&!e?p.errorAtLeastOne(t):null},function(){return l&&!o&&0===n?p.errorRequired():null},function(t){var e,n;try{for(var i=c(t),o=i.next();!o.done;o=i.next())if(!o.value.id&&s.user_input_allowed){var r=a[0]||"";if(l&&0===r.length)return p.errorRequired();if(0<u){if(0===r.length||r.length<u)return p.errorMinLength(u);if(r.length>h)return p.errorMaxLength(h)}switch(s.user_input_allowed){case 1:if(!/(^[a-z–∞-—è\s]+$)/i.test(r))return p.errorLettersOnly();break;case 2:if(!/(^[0-9]+$)/i.test(r))return p.errorDigitsOnly()}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return null}].reduce(function(t,e){var n=e(i);return null!==n?t.concat(n):t},[])}},169:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(e(170))},170:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.plural=function(t,e){var n=e[0],i=e[1],o=e[2],r=Math.abs(t);return 5<=(r%=100)&&r<=20?o:1==(r%=10)?n:2<=r&&r<=4?i:o},e.trunc=function(t,e,n){return void 0===e&&(e=140),void 0===n&&(n=""),t.length<e?t:""+t.slice(0,e-n.length)+n},e.toCamelCase=function(t){return t.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(t,e){return 0==+t?"":0===e?t.toLowerCase():t.toUpperCase()}).replace(/[\-\.]/g,"")},e.toPascalCase=function(t){return t.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(t,e){return 0==+t?"":t.toUpperCase()}).replace(/[\-\.]/g,"")}},171:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(61),o=n(32),a=n(62);e.packPayload=function(t,e,n){var i,o={},r=t.id,s=t.options;return s&&s.answer_range?delete(i=Object.assign({},e))[0]:i=Object.keys(e).filter(function(t){return"0"!==t}),i&&(o[a.createQuestionKey(r)]=i),n&&(o[a.createQuestionKey(r,!0)]=n),o},e.saveQuestionState=function(e,n){var i={};return Object.keys(e).forEach(function(t){t&&(i[t]={checked:!0},"string"==typeof e[t]&&(i[t].value=e[t]),"0"===t&&(i[t].value=n[0]))}),i},e.resolveSurveyInitialStateByType=function(t,e,n){var i=e&&0<n?"ready":"done";return"poll"===t?i:"exam"===t||"survey"===t||"quiz"===t?e?0<n?"ready":"done":"hidden":i},e.findAnswersIds=function(n){return void 0===n&&(n={}),Object.keys(n).reduce(function(t,e){return"answer"===e?Object.assign(t,i.mapToDict(n[e],!0)):0===e.indexOf(o.prefixRangeAnswer)&&(t[e.replace(o.prefixRangeAnswer,"")]=n[e][0]),t},{})}},172:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(62),a=n(63),r=function(t){return Array.isArray(t)?t.length:Object.keys(t).length},l=function(t,e){return!!e&&(Array.isArray(e)?-1!==e.indexOf(""+t):!!e[t]&&"0"!==e[t])},u=[function(t,e){var n=t.min_answers;if(!n)return!0;if(!e)return!1;var i=r(e),o=(n||0)<=i;return a.log(">>> –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —á–∏—Å–ª–æ –æ—Ç–≤–µ—Ç–æ–≤ "+n+",","–ø–æ–ª—É—á–µ–Ω–æ "+i+" ‚Äî",(o?"–º–æ–∂–Ω–æ":"–ù–ï–õ–¨–ó–Ø")+" –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),o},function(t,e){if(!e)return!0;var n=t.max_answers;if(!n)return!0;var i=r(e),o=i<=(n||Number.POSITIVE_INFINITY);return a.log(">>> –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç–≤–µ—Ç–æ–≤ "+n+",","–ø–æ–ª—É—á–µ–Ω–æ "+i+" ‚Äî",(o?"–º–æ–∂–Ω–æ":"–ù–ï–õ–¨–ó–Ø")+" –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),o},function(t,e){if(!e)return!1;var n=t.checked_answer,i=!n||l(n,e);return a.log(">>> "+(i?"":"–Ω–µ ")+"–≤—ã–±—Ä–∞–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç —Å id "+n+" ‚Äî",(i?"–º–æ–∂–Ω–æ":"–ù–ï–õ–¨–ó–Ø")+" –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),i}];e.checkIfCanShowQuestion=function(t,e){a.log("–ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å "+t.id+"...");var n=t.answers;if(!n||0===n.length)return a.log(">>> –≤–æ–ø—Ä–æ—Å –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤ (–≤–æ–ø—Ä–æ—Å-—Å—Å—ã–ª–∫–∞) ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å."),!0;if(function(t,o){var r=0;return t.every(function(t){if(t.disable_multiple)return 0===r&&(r++,!0);var e=t.show_condition;if(!e)return!1;var n=e.checked_answer,i=e.question;return!(!n||!i||l(n,o[s.createQuestionKey(i)]))})}(n,e))return a.log(">>> –≤—Å–µ –æ—Ç–≤–µ—Ç—ã —Å–∫—Ä—ã—Ç—ã ‚Äî –ù–ï–õ–¨–ó–Ø –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å."),!1;if(!t.options)return a.log(">>> –Ω–µ—Ç —É—Å–ª–æ–≤–∏–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),!0;var i=t.options.show_condition;if(!i||!i.question)return a.log(">>> –Ω–µ—Ç —É—Å–ª–æ–≤–∏–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),!0;var o=i.question,r=e[s.createQuestionKey(o)];return r?u.every(function(t){return t(i,r)}):(a.log(">>> –Ω–∞ –≤–æ–ø—Ä–æ—Å "+o+", —è–≤–ª—è—é—â–∏–π—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî","–ù–ï–õ–¨–ó–Ø –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å"),!1)}},173:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return"Survey:"+t};function i(t){var e=o(t),n=localStorage.getItem(e);if(!n)return 0;var i=parseInt(n,10);return isNaN(i)?0:i}e.saveVotesCount=function(t,e){var n=o(t);localStorage.setItem(n,""+e)},e.readVotesCount=i,e.getVoteAttempts=function(t,e){return 0===e?1:e-i(t)},e.checkVotesCount=function(t,e){if(0===e)return!0;var n=i(t);return 0===n||!(e<=n)}},174:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(r,s,a,l){return new(a||(a=Promise))(function(t,e){function n(t){try{o(l.next(t))}catch(t){e(t)}}function i(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,i)}o((l=l.apply(r,s||[])).next())})},o=this&&this.__generator||function(n,i){var o,r,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(s=2&e[0]?r.return:e[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;switch(r=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],r=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(e,"__esModule",{value:!0});var r=n(191),s=null;e.getAuth=function(){return i(this,void 0,void 0,function(){return o(this,function(t){return null===s&&(s=r.getActiveUser()),[2,s]})})}},175:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(r,s,a,l){return new(a||(a=Promise))(function(t,e){function n(t){try{o(l.next(t))}catch(t){e(t)}}function i(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,i)}o((l=l.apply(r,s||[])).next())})},c=this&&this.__generator||function(n,i){var o,r,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(s=2&e[0]?r.return:e[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;switch(r=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],r=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},p=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}};function d(n){return i(this,void 0,void 0,function(){return c(this,function(t){return[2,new Promise(function(t){var e=new Image;e.onload=function(){t()},e.src=n})]})})}function f(t){if(t&&t.img&&t.img.src)return t.img.src}Object.defineProperty(e,"__esModule",{value:!0}),e.preload=function(h){return i(this,void 0,void 0,function(){var e,n,i,o,r,s,a,l,u;return c(this,function(t){i=[],o=h.questions;try{for(r=p(o),s=r.next();!s.done;s=r.next())a=s.value,i=i.concat(f(a)||[]),"quiz"===h.type&&(l=a.correct,u=a.incorrect,i=(i=i.concat(f(l)||[])).concat(f(u)||[]))}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return[2,Promise.all(i.map(d))]})})}},176:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version="3.2.4"},179:function(t,e,n){!function(a,t,e){"use strict";var n=window.ru.mail.cpf.Basic,i=n.getView,o=n.moduleOpts.setParams,r="StorySection";i({_Init:function(){this._opts.articleId&&function(){var t=this._elems,e=this._opts,i=e.attrs,o=e.cssClss,r=e.articleId,s=!1;Array.prototype.forEach.call(t.items,function(t,e){var n=a(t);n.attr(i.newsId)==r?(n.addClass(o.hidden),s=!0):s&&n.removeClass(2==e?o.hideLast:3==e?o.hidden:"")})}.call(this)}},{cssSels:{Main:{items:".js-story-news__item"}},cssClss:{hidden:"hidden_all",hideLast:"hidden_small"},attrs:{articleId:"data-article-id",newsId:"data-news-id"},visibleCount:3},null,r),o(r,{paramAttrs:{articleId:"data-article-id"}})}(window.jQuery||window.$,window)},191:function(t,e,n){"use strict";n.r(e);var i=n(80),o=n.n(i),r="undefined"!=typeof window?window.__PH:global.__PH,s=function(){var t="mail.ru"!==document.domain.split(".").slice(-2).join(".")?"https://portal.devmail.ru/NaviData":"https://portal.mail.ru/NaviData";return o()(t,{data:{mac:1,ldata:1},timeout:3e3,jsonpCallback:"callback"}).then(function(t){return t.json()})},a=function(){return new Promise(function(e,n){return r.loadAccountsList(function(t){return t?e(t):n()})})},l=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return r.authForm.show(t)},u=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.successPage?t.successPage:window.location;window.location="https://touch.mail.ru/cgi-bin/login?page=".concat(e)};n.d(e,"getAccountsList",function(){return m}),n.d(e,"getActiveUser",function(){return _}),n.d(e,"isAuth",function(){return g}),n.d(e,"getStatus",function(){return y}),n.d(e,"onGetStatus",function(){return v}),n.d(e,"applyAuth",function(){return b});var h="undefined"!=typeof window?window.__PH:global.__PH,c=[],p="",d="";function f(){return h?a().then(function(t){var e=t.status,n=t.accounts;c=n||[],p=h.activeUser()||"",d=e||""}).catch(function(t){return t}):s().then(function(t){var e=t.status,n=t.data;c=n&&n.list?n.list:[],p=n&&n.email?n.email:"",d=e||""}).catch(function(t){return t})}function m(){return f().then(function(){return c}).catch(function(t){return t})}function _(){return m().then(function(t){return t.filter(function(t){return t.active})[0]})}function g(){return f().then(function(){return!!p&&!0}).catch(function(t){return t})}function y(){return f().then(function(){return d}).catch(function(t){return t})}function v(t){return f().then(function(){if("function"!=typeof t||!p)throw new TypeError("First argument must be a function or the user is not allowed.");t(p)}).catch(function(t){return t})}function b(n){var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=2<arguments.length?arguments[2]:void 0,r="function"==typeof n;return new Promise(function(e){v(function(t){t&&r?e(n()):i&&r?function(t){h?l(t):u(t)}(o):e(t)})})}},199:function(t,e,n){!function(u,t,e){"use strict";var h=t.localStorage||{},n=e.Basic,c=n.Extend,r=e.Tools.Auth,i={cssSels:{wrapper:".js-notice__wrapper",block:".js-notice",close:".js-notice__close"},cssClss:{show:"tooltip_shown"},storage:{root:"ru.mail.news.notice.comment",keys:{close:"lockTo",unique:"viewedTo",view:"viewed",list:"ids"}},timeouts:{lock:864e5,unique:864e5,hide:1e4,show:0},limits:{skip:1,views:2},autoHide:!0,canShowOnInit:null,template:(0,e.Tools.getTemplate)("ct-notifications-new-comment.xml")},o=n.getView(function(){function a(t,e){var n=this._opts,i=this._state,o=n.storage,r=n.timeouts,s=i.storage,a=o.keys[t];switch(t){case"close":e=i.timestamp+r.lock;break;case"unique":e=(new Date).getTime()+r.unique;break;case"view":e=void 0!==e?e:s[a]+1;break;case"list":e=void 0!==e?e:s[a].concat([i.id])}s[a]=e,function(){var t=this._state,e=this._opts.storage,n=t.storage;h.setItem(e.root,JSON.stringify(c(!0,{},n)))}.call(this)}function o(){var t=this._elems,e=this._opts,n=this._state,i=e.cssSels,o=e.template,r=n.data,s=u(o(r));(s||{}).length&&(t.block=s.is(i.block)?s:s.find(i.block),(t.block||{}).length||(t.block=s),s.appendTo((t.wrapper=u(i.wrapper)||{}).length?t.wrapper:document.body),s.on("click",i.close,function(t){t.preventDefault(),function(){l.call(this,!1),a.call(this,"close"),this._trigger("hide")}.call(this)}.bind(this)),n.rendered=!0)}function l(t){var e=this._elems.block,n=this._opts.cssClss.show;(e||{}).length&&(e.toggleClass(n,t),this._trigger(t?"show":"hide"))}return{_Events:["show","hide","close"],_Init:function(t){if(t&&t.topicId){var e=this._opts,n=e.canShowOnInit,i=this._state={data:t,id:t.topicId,timestamp:(new Date).getTime()};(function(){var t=this._opts,e=this._state,n=t.storage,i=n.keys,o=e.storage={},r=h.getItem(n.root);r=r?JSON.parse(r):{},o[i.close]=r[i.close]||0,o[i.unique]=r[i.unique]||0,o[i.view]=r[i.view]||0,o[i.list]=r[i.list]||[]}).call(this),!function(){var t=this._opts,e=this._state,n=e.storage,i=t.storage.keys,o=e.timestamp,r=!1;return o<n[i.close]?r=!0:o<n[i.unique]?(a.call(this,"view",0),r=!0):-1<n[i.list].indexOf(e.id)?r=!0:n[i.view]>=t.limits.views&&(r=!0),r}.call(this)?"function"==typeof n&&n.call(this)||(a.call(this,"list"),function(){var t=this._opts,e=this._state.storage[t.storage.keys.list].length,n=t.limits.skip;return!(0===n||1<e)||e%(1+n)==1}.call(this)&&r.onGetStatus(function(t){t!==i.data.author.email&&(o.call(this),a.call(this,"view"),i.storage[e.storage.keys.view]>=e.limits.views&&(a.call(this,"unique"),a.call(this,"list",[])),function(){var t=this._opts,e=this._state,n=t.timeouts,i=parseInt(n.show)||0,o=parseInt(n.hide)||0,r=l.bind(this,!0);e.rendered&&!e.started&&(0<i?setTimeout(r,i):r(),t.autoHide&&o&&(isNaN(parseInt(o))||setTimeout(l.bind(this,!1),o+i)),e.started=!0)}.call(this))}.bind(this))):-1===i.storage[e.storage.keys.list].indexOf(i.id)&&a.call(this,"list")}}}}(),i,null,"Notice");c(!0,e,{Modules:{Notice:o}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},2:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COMPONENT_DELIMITER=",",e.COMPONENT_EVENT_DELIMITER=":",e.COMPONENT_NS_DELIMITER=".",e.COMPONENT_EL_DELIMITER=".",e.COMPONENT_DATA_BIND_DEF_DELIMITER="|",e.COMPONENT_DATA_BIND_EQ="=",e.COMPONENT_DATA_BIND_PROP_DELIMITER=";"},202:function(t,e){!function(h,c,t,p){"use strict";var d="StickyPanel";(0,t.Basic.Constructors.getView)(function(){var s=h(c),a=-1,i=0,o=1;function r(e,n){return Object.keys(n).forEach(function(t){e.toggleClass(t,n[t])}),e}var l=function(){var t=this._State.dimensions,e=this._Elems.Parent,n=e.prev(),i=e.next(),o=n.get(0).getBoundingClientRect(),r=i.get(0).getBoundingClientRect();return this._Opts.horizontal?a:o.bottom>s.height()-t.height?-1:r.top<t.height?1:0};var u=function(){this._State.dimensions=this.getDimensions()},e=function(t){var e=this._Opts.cssClss.state[t],n={};n[e.base]=!1,n[e.up]=!1,n[e.down]=!1,r(this._Elems.node,n)},t=function(){var t=this._Opts.getNextState||l,e=function(t){return t?c.scrollX||document.documentElement.scrollLeft:c.scrollY||document.documentElement.scrollTop}(this._Opts.horizontal),n=function(t){return t<0?a:0===t?i:0<t?o:null}(+t.call(this,e));this._State.state!==n&&(this._State.state=n,function(t){var e=this._State.state,n=this._Opts.cssClss.state[this._State.currentClassSet],i={};i[n.base]=!0,i[n.up]=e===a,i[n.down]=e===o,r(this._Elems.node,i),u.call(this),this._trigger("change",e,t)}.call(this,e))},n=function(){this._Opts.raf?requestAnimationFrame(t.bind(this)):t.call(this)};return{_Events:["change"],_Handlers:{},changeClassSet:function(t){t!==this._State.currentClassSet&&(e.call(this,this._State.currentClassSet),this._State.currentClassSet=t,e.call(this,t),u.call(this),(this._Opts.getInitial||function(){}).call(this),this._State.state=null,n.call(this))},getDimensions:function(){return{width:this._Elems.node.width(),height:this._Elems.node.height()}},_Init:function(){if(null!==this._Elems.node){this._State={state:null,currentClassSet:0};var t=this._Opts.getInitial||function(){};u.call(this),t.call(this),s.on("resize",function(){u.call(this),t.call(this),n.call(this)}.bind(this)),s.on("scroll",n.bind(this)),n.call(this)}else p&&c.console.warn(d+': node "'+this._opts.cssSels.Main.node+'" not found')}}}(),{cssSels:{Main:{node:".js-stickypanel__container"}},cssClss:{state:[{base:"stickypanel__container",up:"stickypanel__container_up",down:"stickypanel__container_down"}]},raf:!0,horizontal:!1,getInitial:null,getNextState:null},null,d)}(window.jQuery||window.$,window,window.ru.mail.cpf,window.DEBUG)},21:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},22:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=n(6),p=n(23),d=n(2),a=n(8),f=n(1),m=n(9);function _(t){var e=function(t){var e=t.getAttribute(a.DOM_DATA_COMPONENT_STATE_ATTR)||"{}";try{return JSON.parse(e)||{}}catch(t){return f.print.warn('Unable to parse data "'+e+'"'),{}}}(t);try{t.removeAttribute(a.DOM_DATA_COMPONENT_STATE_ATTR)}catch(t){f.print.warn('Unable to remove "'+a.DOM_DATA_COMPONENT_STATE_ATTR+'" attribute from node')}return e}function s(t,e){var n=function(t){var e=/^([\w\.]+)\s+as\s+(\w+)$/gm.exec(t);return null!==e?{name:e[1].trim(),alias:e[2].trim()}:{name:t.trim(),alias:null}}(e),i=n.name.split(d.COMPONENT_NS_DELIMITER),o=i[0],r=i.slice(1),s=m.getConfigCollapsed(n.name),a=p.getComponent(o);if(void 0===a)return f.print.warn("Component '"+o+"' was not found"),null;var l=_(t)[o]||{},u=c.deepMerge({},s.initialState,l.state),h=c.deepMerge({},s.options,l.options);return new a(r.join(d.COMPONENT_NS_DELIMITER),h,u).mount(t).dispatch(n.alias||o)}function l(t){var e=t.getAttribute(a.DOM_DATA_COMPONENT_NAME_ATTR);if(!e)return[];for(var n=[],i=0,o=e.split(d.COMPONENT_DELIMITER);i<o.length;i++){var r=s(t,o[i]);null!==r&&n.push(r)}return n}e.initComponents=l,e.initAllComponents=function(t){if(!t)throw new Error("$root element not found");var e=t.querySelectorAll(a.DOM_DATA_COMPONENT_SEL),n=Array.prototype.slice.call(e);t.getAttribute(a.DOM_DATA_COMPONENT_NAME_ATTR)&&n.unshift(t);for(var i=[],o=0,r=n;o<r.length;o++){var s=l(r[o]);i=i.concat(s)}return i}},23:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o={};e.registerComponent=function(t){var e=t.registryName;if(!e){var n=function(t){return(t.toString().match(/function (\w*)/)||[])[1]}(t);throw new Error(i.format('Static property "registryName" is not defined for component "'+n+'"').error().str())}if(e in o)throw new Error(i.format("Component with name '"+e+"' is already registered").error().str());i.print.log('Registering "'+e+'"'),o[e]=t},e.getComponent=function(t){return o[t]}},24:function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(25),r={templatesExt:".xml.js",templatesPath:"/bem",templatesNS:"fest"},s=function(){function t(){this._store=new o.Store("MPF_GLOBAL",r,this.dispatchStore.bind(this)),this._store.dispatch()}return t.prototype.dispatchStore=function(){},t.prototype.getState=function(){return this._store.read()},t.prototype.update=function(e){this._store.put(function(t){return i({},t,e)}),this._store.dispatch()},t}();e.ApplicationSettings=s,e.applicationSettings=new s},25:function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(40),s=n(42),a={},l=new r.Emitter;new s.DevToolsExtension;function u(t){for(var e={},n={},i=0,o=Object.keys(t);i<o.length;i++){var r=o[i];"@"===r.charAt(0)?e[r]=t[r]:n[r]=t[r]}return{component:n,shared:e}}var h=function(){function t(t,e,n){this._id=t,this._events=[],this._EVENT_CHANGE="CHANGE:"+t,this._EVENT_INIT="INIT:"+t;var i=u(e).component;a[t]?o.print.warn("'"+t+"' is already connected"):(this.bind(n),a[t]=i,l.emit(this._EVENT_INIT,a[t]))}return t.hasEntity=function(t){return t in a},t.prototype.destroy=function(){var e=this;this._events.forEach(function(t){l.removeListener(e._EVENT_CHANGE,t)}),delete a[this._id]},t.prototype.dispatch=function(){l.emit(this._EVENT_CHANGE,a[this._id])},t.prototype.put=function(t){var e=this.read(),n=t(this.read()),i=u(e).component,o=u(n).component,r=Object.keys(i),s=Object.keys(o);0===r.length&&0===s.length||(a[this._id]=o,l.emit(this._EVENT_CHANGE,o,e))},t.prototype.read=function(){var t=a[this._id];return i({},t)},t.prototype.bind=function(t){this._events.push(t),l.on(this._EVENT_CHANGE,t)},t}();e.Store=h},26:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(45),s=n(46),a=n(27),l=n(1),u=n(2),h=n(8);e.DOMEvent=function(t){return function(t,e,n){}},e.DOMBind=function(t,e,n){};var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._events={},t}return o(t,e),Object.defineProperty(t.prototype,"$",{get:function(){if(!this._$root)throw new Error(l.format('Component "'+this.identity+'" not mounted').error().str());return this._$root},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$elements",{get:function(){return this._collector.group(this.$,this.alias)},enumerable:!0,configurable:!0}),t.prototype.reset=function(){null!==this._unbindEvents&&(this._unbindEvents(),this._unbindEvents=null),e.prototype.reset.call(this)},t.prototype.getElements=function(t){return this._collector.elements(this.$,t,this.alias)},t.prototype.mount=function(t){return this._$root||(this._$root=t),this},t.prototype.preDispatch=function(){var e=this;this._collector=new a.Collector(function(t){return"["+h.DOM_DATA_COMPONENT_EL_ATTR+'*="'+t+u.COMPONENT_EL_DELIMITER+'"]'}(this.alias),h.DOM_DATA_COMPONENT_EL_ATTR);var t=s.eventsBinder(this.$,function(t){return e._collector.elements(e.$,t,e.alias)});this._unbindEvents=t(this._events),s.dataBinder(function(t){return"["+h.DOM_DATA_COMPONENT_BIND_ATTR+'*="'+t+u.COMPONENT_DATA_BIND_DEF_DELIMITER+'"]'}(this.alias),h.DOM_DATA_COMPONENT_BIND_ATTR)(this,this._store.bind.bind(this._store),this.getState.bind(this))},t.prototype.postDispatch=function(){l.print.groups("Component ("+this.identity+")",{$:[this.$,this.$elements],options:[this.options],state:[this.getState()]})},t}(r.Component);e.DOMComponent=c},27:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=function(){function t(t,e){this.elSel=t,this.attrSel=e}return t.prototype.getName=function(t,e){var n=t.getAttribute(this.attrSel);return"string"==typeof n&&e?n.replace(""+e+i.COMPONENT_EL_DELIMITER,""):n},t.prototype.group=function(t,e){for(var n={},i=t.querySelectorAll(this.elSel),o=0,r=Array.prototype.slice.call(i);o<r.length;o++){var s=r[o],a=this.getName(s,e);null!==a&&(n[a]||(n[a]=[]),n[a]=n[a].concat(s))}return n},t.prototype.elements=function(t,e,n){var i=this,o=t.querySelectorAll(this.elSel);return Array.prototype.slice.call(o).filter(function(t){return i.getName(t,n)===e})},t}();e.Collector=o},28:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=n(53),i=n(29),s={option:{getVal:function(t){var e=t.getAttribute("value");return null!==e?e:i.stripAndCollapse(i.getText(t))}},select:{getVal:function(t){for(var e=[],n=t.selectedIndex,i="select-one"===t.type,o=i?n+1:t.options.length,r=n<0?o:i?n:0;r<o;r++){var s=t.options[r],a=s.selected||r===n,l=s.disabled,u=s.parentNode,h=u.disabled,c=d.isNodeName(u,"optgroup");if(a&&!l&&(!h||!c)){var p=f(s);if(i)return p;e.push(p)}}return e},setVal:function(t,e){for(var n,i=[e],o=t.options.length;o--;){var r=t.options[o];(r.selected=-1!==i.indexOf(s.option.getVal(r)))&&(n=!0)}return n||(t.selectedIndex=-1),i}}};function f(t){var e,n=t.nodeName.toLowerCase(),i=s[n];return i&&void 0!==(e=i.getVal(t))?e:"string"==typeof(e=t.value)?e.replace(/\r/g,""):null===e?void 0:e}e.getValue=f,e.setValue=function(t){throw new Error("to be done")}},29:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getText=function t(e){var n,i=e.nodeType,o="",r=0;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)o+=t(e)}else if(3===i||4===i)return e.nodeValue}else for(;n=e[r++];)o+=t(n);return o},e.stripAndCollapse=function(t){return(t.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")}},295:function(t,e){!function(t,e,o){"use strict";var n=o.Basic,i=o.Mixins,r=n.getModel,a=n.Extend;r({_Events:["loading","update","error"],_mixins:[i.transport],_Init:function(t){t=t||{},this._state={is_subscribed:0},function(t){var e=this._opts.storage;-1!==((this._storageTools=new o.Tools.LocalStorage(e.options)).getItem(e.subscribedChroniclesIds)||[]).indexOf(t.chronicle_id.toString())&&this.setState({is_subscribed:1})}.call(this,t)},isSubscribed:function(){var t=this._state.is_subscribed;return void 0===t?null:1===t},toggle:function(t){(function(t){t=t||{};var e=this._opts,n=this._state,i=e.urls,o=this.isSubscribed()?i.unsubscribe:i.subscribe,r=a(!0,{},e.requestParams,t),s=e.transport||this.transport;n.loading||(n.loading=!0,this._trigger("loading"),o&&s({url:o,data:r,type:"POST"}).then(function(t){1===t.status&&t.data?(this.setState({loading:!1,email:t.email,chronicle_id:t.data.chronicle.id,chronicle_title:t.data.chronicle.title,chronicle_action:"pending",is_subscribed:1}),this._trigger("update")):this._trigger("error")}.bind(this),function(){n.loading=!1,this._trigger("error")}.bind(this)))}).call(this,t)},setState:function(t){this._state=a(this._state,t)},getState:function(){return a(!0,{},this._state)},update:function(e){var t=this._opts.storage,n=this._storageTools=new o.Tools.LocalStorage(t.options),i=n.getItem(t.subscribedChroniclesIds)||[];"reject"==e.chronicle_action?-1!==i.indexOf(e.chronicle_id.toString())&&(i=i.filter(function(t){return t!==e.chronicle_id.toString()}),n.setItem(i,!1,t.subscribedChroniclesIds),this.setState({is_subscribed:0,chronicle_action:e.chronicle_action,chronicle_id:e.chronicle_id})):"confirm"==e.chronicle_action&&this.setState({chronicle_action:e.chronicle_action,chronicle_id:e.chronicle_id}),this._trigger("update")}},{urls:{subscribe:null,unsubscribe:null},transport:null,requestParams:{},storage:{options:{root:"ru.mail.newsletter",defaultKeySuffix:"subscribedChronicles"},subscribedChroniclesIds:"subscribedChronicles.ids",subscribedChroniclesEmail:"subscribedChronicles.email"}},null,"NewsletterModel")}(window.jQuery||window.$,window,window.ru.mail.cpf)},296:function(t,e){!function(t,s,e){"use strict";var n="NewsletterView",i=e.Basic.getView,o=e.Basic.moduleOpts.setParams,a=e.Types.String.Url.getParams,r=e.Tools.getTemplate,l={cssSels:{Main:{button:".js-newsletter__button",toggleElem:".js-newsletter__toggle"}},cssClss:{subscribed:"button_toggle"},paramName:null,toggleParent:!1,checkOnInit:!1,templates:{alert:r("ct-popup-alert.xml"),subscribe:r("ct-popup-chronicle-subscribe.xml")},texts:null};i(function(){function r(){var t=this._elems,e=this._opts.cssClss,n=this._model,i=t.toggleElem,o=n.isSubscribed();(i||{}).length&&null!==o&&i.toggleClass(e.subscribed,o)}return{_Events:["noAuth","checkUser"],_Handlers:{dom:{"submit:Main.form":function(t){t.preventDefault();var e=this._elems,n=this._opts,i=this._model,o=n.cssClss,r=e.input,s=r.find("input").val(),a=/^.+@[\\.\w-]+$/.test(s);if(r.toggleClass(o.inputInvalid,!a),a){var l={email:s};i.toggle(l)}}},model:{update:r}},_Init:function(){var t=this._opts,e=this._model,n=this._elems;if(n.toggleElem=t.toggleParent?n.parent:n.toggleElem,t.checkOnInit&&this._trigger("checkUser"),r.call(this),s.location.search){var i=s.location.origin+s.location.pathname,o=a(s.location.search);o&&o.hasOwnProperty(t.paramName)&&(e.update(o),s.history.replaceState(null,null,i))}}}}(),l,null,n),o(n,{acceptTypes:["NewsletterModel"]})}(window.jQuery||window.$,window,window.ru.mail.cpf)},298:function(t,e,n){"use strict";n(202),n(299)},299:function(t,e){!function(y,v,t){"use strict";var e,n=t.Basic.moduleOpts.setParams,b=(t.Tools.FuncTools.multi,t.Basic.Extend);n("StickyPanel.TopButton",{options:{cssClss:{state:[{base:"sticky__inner",up:"hidden_all",down:"sticky__inner_bottom"}]},getInitial:function(){e||(e=this._elems.parent.get(0))},getNextState:function(){return e.getBoundingClientRect().top<0?1:-1}}}),n("StickyPanel.Rubric",{options:{cssClss:{state:[{base:"sticky__inner",up:"sticky__inner_top",down:"sticky__inner_bottom"}]}}}),n("StickyPanel.Card.AnchorMenu",function(){var m=20,_=20;function g(t){t=t||function(){if(void 0!==v.pageXOffset&&void 0!==v.pageYOffset)return{left:v.pageXOffset,top:v.pageYOffset};var t=document.documentElement||document.body.parentNode||document.body;return{left:t.scrollLeft,top:t.scrollTop}}().top;var n=this._opts,e=this._State.sizes,i=e.window.height,o=e.fullCont.el,r=this._elems.menu,s=e.items.el.filter(function(t,e){return y(e).hasClass(n.cssClss.activeItem)}),a=e.items.rects[s.data("anchor")],l=0,u={top:"",bottom:""};if(0<t-e.fullCont.offset.top+m){var h=e.mainWrapper.offset.top+e.mainWrapper.rect.height-t;l=-1,e.fullCont.rect.height<i?(u.top=m,e.fullCont.lastTop=u.top,e.fullCont.rect.height+m>h&&(u={top:"",bottom:_},l=1)):h<i&&(u={top:"",bottom:_},l=1)}return o.css(u),a&&r.scrollTop(a.offset.top-e.menu.offset.top),l}return{options:{cssSels:{Main:{menu:".js-stickypanel__menu",menuFullWrapper:".js-stickypanel__menu-wrapper_full",menuItem:".js-stickypanel__menu-item",menuItems:".reference-page__menu-inner",slot:".js-stickypanel__slot",article:".js-stickypanel__article",node:".js-stickypanel__menu-wrapper"},pageWrapper:".wrapper"},cssClss:{activeItem:"reference-page__menu-item_active",state:[{base:"",up:"sticky__inner_fixed",down:"sticky__inner_end"}]},onChange:function(t){},getInitial:function(){var o=this._State,t=this._elems,e=this._opts,n=e.cssSels,i=e.cssClss,r=i.activeItem,s=t.menuFullWrapper,a=t.node,l=t.menu,u=t.article,h=(t.slot,t.menuItems),c=r?t.menuItem:[],p=s.closest(n.pageWrapper),d=u.height();o.timer&&clearInterval(o.timer),o.timer=setInterval(function(){var t=u.height();d!==t&&y(v).trigger("resize")},500),s.height(d),a.width(s.width()),o.state=3,function(e,n){Object.keys(n).forEach(function(t){e.removeClass(n[t])})}(a,i.state[0]);var f=!o.sizes;f&&(o.sizes={menu:{el:l},fullCont:{el:a},pageWrapper:{el:p},mainWrapper:{el:s,offset:s.offset(),rect:s.get(0).getBoundingClientRect()},itemsWrapper:{el:h,rect:h.get(0).getBoundingClientRect()},slot:{},items:{el:c,rects:{}},window:{height:document.body.clientHeight}}),o.sizes.itemsWrapper.rect.height+m+_>o.sizes.window.height&&(l.css("overflow","hidden"),l.height(o.sizes.window.height-m-_)),o.sizes=b(!0,o.sizes,{menu:{offset:l.offset(),rect:l.get(0).getBoundingClientRect()},fullCont:{offset:s.offset(),rect:a.get(0).getBoundingClientRect()},pageWrapper:{rect:p.get(0).getBoundingClientRect()},mainWrapper:{rect:s.get(0).getBoundingClientRect()},itemsWrapper:{rect:h.get(0).getBoundingClientRect()},slot:{},window:{height:document.body.clientHeight}}),c.length&&c.each(function(t,e){var n=e.getAttribute("data-anchor"),i=y(e);o.sizes.items.rects[n]||(o.sizes.items.rects[n]={el:i}),o.sizes.items.rects[n].rect=e.getBoundingClientRect(),o.sizes.items.rects[n].offset=i.offset()}),f||g.call(this)},getNextState:function(t){return g.call(this,t)},raf:!1}}}())}(window.jQuery||window.$,window,window.ru.mail.cpf)},3:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(37);n.init=i.init;var o=e(9);n.setConfig=o.setConfig;var r=e(23);n.registerComponent=r.registerComponent;var s=e(22);n.initAllComponents=s.initAllComponents,function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(e(44))},32:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(169);e.DEBUG=!1,e.prefixRangeAnswer="range_",e.errorRequired=function(){return"–í–æ–ø—Ä–æ—Å —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –¥–ª—è –æ—Ç–≤–µ—Ç–∞"},e.errorRange=function(t,e){return"–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç "+t+" –¥–æ "+e+" "+i.plural(e,["–≤–∞—Ä–∏–∞–Ω—Ç","–≤–∞—Ä–∏–∞–Ω—Ç–∞","–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤"])+" –æ—Ç–≤–µ—Ç–∞"},e.errorAtLeastOne=function(t){return"–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã "+t+" "+i.plural(t,["–≤–∞—Ä–∏–∞–Ω—Ç","–≤–∞—Ä–∏–∞–Ω—Ç–∞","–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤"])+" –æ—Ç–≤–µ—Ç–∞"},e.errorMinLength=function(t){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –º–∏–Ω–∏–º—É–º –∏–∑ "+t+" "+i.plural(t,["—Å–∏–º–≤–æ–ª–∞","—Å–∏–º–≤–æ–ª–æ–≤","—Å–∏–º–≤–æ–ª–æ–≤"])},e.errorMaxLength=function(t){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –º–∞–∫—Å–∏–º—É–º –∏–∑ "+t+" "+i.plural(t,["—Å–∏–º–≤–æ–ª–∞","—Å–∏–º–≤–æ–ª–æ–≤","—Å–∏–º–≤–æ–ª–æ–≤"])},e.errorLettersOnly=function(){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã"},e.errorDigitsOnly=function(){return"–°–≤–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã"},e.errorServer500=function(){return"–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –∏ –º—ã –¥–µ–ª–∞–µ–º –≤—Å—ë –≤–æ–∑–º–æ–∂–Ω–æ–µ –¥–ª—è –µ—ë –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É"}},34:function(t,e,n){!function(c,p,n){"use strict";var t,i=n.Basic.Extend,d=c("head")[0],o=c(p),f=[],r=!1,s={loadTimeout:5e3,closestParent:null,checkRawItems:(t=function(t){var e=function(t){var e=p.Modernizr;return!e||"boolean"!=typeof e[t]||e[t]}("webaudio");return e||t.parentNode.removeChild(t),e},{soundcloud:t,rutube:t})},m={instagram:function(t){p.instgrm&&p.instgrm.Embeds&&p.instgrm.Embeds.process(t)},facebook:function(t){p.FB&&p.FB.XFBML&&p.FB.XFBML.parse(t)},twitter:function(t){p.twttr&&p.twttr.widgets&&p.twttr.widgets.load(t)}},_={various:function(){return!0}};function g(t){return!(!t||!t.length)&&(!!t.is("iframe")||!!t.find("iframe").length)}p.getNameSpace("Tools",n,!0).activateEmbeds=function(t,e){r||(function(){var t=n.Basic.moduleOpts.get("ActivateEmbeds")||{};t.initializers&&(m=n.Basic.Extend(m,t.initializers))}(),r=!0);var a=[],l=[],u=i(!0,{},s,e||{}),h=u.checkRawItems||{};return t.each(function(t,e){var n=e.getAttribute("data-type");if(!h[n]||!1!==h[n](e,n)){var i=c(),o=e.value.replace(/__text_area__/g,"textarea"),r=c(e),s=[];c(o).each(function(t,e){var n;"SCRIPT"===e.tagName?e.src?function(t){var e;t=t.split("?")[0],-1===f.indexOf(t)&&(f.push(t),(e=document.createElement("script")).type="text/javascript",e.setAttribute("defer","defer"),e.src=t+"?"+(Math.random()+"").split(".")[1],d.appendChild(e))}(e.src):((n=document.createElement("script")).type="text/javascript","textContent"in n?n.textContent=e.textContent:n=['<script type="text/javascript">',c(e).html(),"<\/script>"].join(""),s.push(n)):i=i.add(e)}),-1===a.indexOf(n)&&a.push(n),l.push(function(t,r,e){return new Promise(function(n,i){var o=e.closestParent?t.closest(e.closestParent):c(t.get(0).parentNode);setTimeout(function(){var t=_[r]||g,e={element:o.get(0),type:r};t(o)?n(e):i(e)},e.loadTimeout)})}(r,n,u).catch(function(t){})),r.replaceWith(i),s.length&&s.forEach(function(t){document.head.appendChild(t)}),p.requestAnimationFrame(i.trigger.bind(i,"documentHeightChange"))}}),p.requestAnimationFrame(function(t){if(t&&t.length){var e=o.trigger.bind(o,"resize");t.forEach(function(t){t in m&&m[t]()}),p.requestAnimationFrame(e),setTimeout(e,2e3)}}.bind(this,a)),l}}(window.jQuery||window.$,window,window.ru.mail.cpf)},35:function(t,e){!function(i,e,t){"use strict";var n=t.Basic,o=n.throttle,r=t.Tools.activateEmbeds,s=i(e),a=/iphone|ipod/i.test(navigator.userAgent),l="touchend",u="scroll",h=function(){if(i(this._Elems.Parent).is(":visible")){var e,n=this._state.winSizes.height+this._Opts.scrollLimit;this._state.items.forEach(function(t){t.getBoundingClientRect().top<n&&(e=(e||i()).add(t))}),e&&this.initItemsCode(e)}},c=function(){this._state.winSize=p(),e.requestAnimationFrame(h.bind(this))},p=function(){var t=e.document.documentElement;return{height:t.clientHeight,width:t.clientWidth}},d=function(t){var e,n=this._state;n.areListernersActive!==t&&((n.areListernersActive=t)?(e="on",n.handlers={resize:o(c.bind(this),100),scroll:o(h.bind(this),100)}):e="off",s[e]("resize",n.handlers.resize),s[e](u,n.handlers.scroll))},f=n.Constructors.getView({_Init:function(){this._state={items:[],winSizes:p(),handlers:{}},a&&"ru.mail.media.parallaxSlot"in e&&(u=l),this.processItems(),this._state.items.length&&s.on("load",o(c.bind(this),100))},processItems:function(t){var e=this._state,n=t||this._Elems.Parent,i=this._Opts.cssSels.item,o=n.find(i).removeClass(i.slice(1));e.items=e.items.concat(Array.prototype.slice.call(o)),e.items.length&&(d.call(this,!0),h.call(this))},initItemsCode:function(t){var e=this._Opts.failHandler,n=r(t,function(){return{loadTimeout:this._Opts.loadTimeout,checkRawItems:this._Opts.checkRawItems||{}}}.call(this));(function(t){var i=this._state.items;t.each(function(t,e){var n=i.indexOf(e);-1!==n&&i.splice(n,1)})}).call(this,t),this._state.items.length||d.call(this,!1),"function"==typeof e&&(e=e.bind(this),n.forEach(function(t){t.then(null,e)}))}},{cssSels:{item:".js-wysiwyg__embedcode"},scrollLimit:400,loadTimeout:5e3,failHandler:null,checkRawItems:{}},null,"MediaEmbeds");e.getNameSpace("Modules",t).MediaEmbeds=f}(window.jQuery||window.$,window,window.ru.mail.cpf)},37:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(22),o=n(1),r=n(9),s=n(24),a=!1;e.init=function(e){return new Promise(function(n,t){return a?(o.print.warn("MPF is already started"),n()):(e&&s.applicationSettings.update(e),a=!0,r.resolveConfigSetters().then(function(t){var e=function(){o.print.info("MPF init. Env: production"),i.initAllComponents(document.body),n()};"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}))})}},38:function(t,e,n){"use strict";function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var d=function(t){return null!=t&&"object"===p(t)&&!(t instanceof Promise)};e.deepMerge=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i={},o=0,r=e;o<r.length;o++){var s=r[o];if("object"===p(s)&&null!==s)for(var a=0,l=Object.keys(s);a<l.length;a++){var u=l[a],h=s[u];if(h instanceof Date){var c=new Date;c.setTime(h.getTime()),i[u]=c}else h instanceof RegExp?i[u]=new RegExp(h):Array.isArray(h)?i[u]=Array.prototype.concat.call([],h):d(h)?i[u]=t(i[u],h):i[u]=h}}return i}},39:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getIn=function(o,t){return function t(e,n){if(0===n.length)return e!==o?e:null;var i=e[n[0]];return null==i?null:t(i,n.slice(1))}(o,t)},e.setIn=function(t,e,n){return function t(e,n,i){return 1===n.length?(e[n[0]]=i,e[n[0]]):(null!==e[n[0]]&&void 0!==e[n[0]]||(e[n[0]]=e[n[0]]||{}),t(e[n[0]],n.slice(1),i))}(t,e,n),t}},40:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=function(e){function t(){var t=e.call(this)||this;return t.emit("ready"),t}return o(t,e),t}(n(41).EventEmitter);e.Emitter=r},41:function(t,e,n){"use strict";var i,o="object"==typeof Reflect?Reflect:null,h=o&&"function"==typeof o.apply?o.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}((t.exports=s).EventEmitter=s).prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function u(t,e,n,i){var o,r,s;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),s=r[e]),void 0===s)s=r[e]=n,++t._eventsCount;else if("function"==typeof s?s=r[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),0<(o=l(t))&&s.length>o&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,function(t){console&&console.warn&&console.warn(t)}(a)}return t}function c(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,h(this.listener,this.target,t))}.bind(i);return o.listener=n,i.wrapFn=o}function p(t,e,n){var i=t._events;if(void 0===i)return[];var o=i[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):f(o,o.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var r;if(0<e.length&&(r=e[0]),r instanceof Error)throw r;var s=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw s.context=r,s}var a=o[t];if(void 0===a)return!1;if("function"==typeof a)h(a,this,e);else{var l=a.length,u=f(a,l);for(n=0;n<l;++n)h(u[n],this,e)}return!0},s.prototype.on=s.prototype.addListener=function(t,e){return u(this,t,e,!1)},s.prototype.prependListener=function(t,e){return u(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,c(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,c(this,t,e)),this},s.prototype.off=s.prototype.removeListener=function(t,e){var n,i,o,r,s;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,r=n.length-1;0<=r;r--)if(n[r]===e||n[r].listener===e){s=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},s.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;0<=i;i--)this.removeListener(t,e[i]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return 0<this._eventsCount?i(this._events):[]}},42:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(e(43))},43:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof __REDUX_DEVTOOLS_EXTENSION__;var o=function(){function t(){var o=this;this.subscriptions={},i&&(this.devTools=__REDUX_DEVTOOLS_EXTENSION__.connect(),this.devTools.subscribe(function(t){if("DISPATCH"===t.type&&"JUMP_TO_STATE"===t.payload.type)for(var e=0,n=Object.keys(o.subscriptions);e<n.length;e++){var i=n[e];o.subscriptions[i](t)}}))}return t.prototype.subscribe=function(t,e){var n="handler_"+t;this.subscriptions[n]||(this.subscriptions[n]=e)},t.prototype.send=function(t,e){i&&this.devTools&&this.devTools.send(t,e)},t.prototype.remove=function(t){delete this.subscriptions["handler_"+t]},t}();e.DevToolsExtension=o},44:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(26);n.DOMComponent=i.DOMComponent,function(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}(e(49))},45:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(6),o=n(2),r=n(25),s=0,a=function(){function t(t,e,n){void 0===e&&(e={}),void 0===n&&(n={}),this._ns=t,this._id=++s,this._options=i.deepMerge({},this.getDefaultOptions(),e),this._initialState=i.deepMerge({},this.getInitialState(),n)}return t.prototype.init=function(){},t.prototype.getDefaultOptions=function(){return{}},t.prototype.getInitialState=function(){return{}},Object.defineProperty(t.prototype,"alias",{get:function(){var t=this.constructor;return this._alias||t.registryName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this._ns?""+this.alias+o.COMPONENT_NS_DELIMITER+this._ns:this.alias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identity",{get:function(){return""+this.ns+o.COMPONENT_NS_DELIMITER+this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.getState()},enumerable:!0,configurable:!0}),t.prototype.setState=function(t){return this._store.put(t)},t.prototype.getState=function(){return this._store.read()},t.prototype.update=function(t,e){},t.prototype.canDispatch=function(){return!r.Store.hasEntity(this.identity)},t.prototype.dispatchStore=function(t,e){this.shouldUpdate(t,e)&&this.update(t,e)},t.prototype.shouldUpdate=function(t,e){return!0},t.prototype.reset=function(){this._store.destroy(),this.dispatch(this._alias)},t.prototype.preDispatch=function(){},t.prototype.postDispatch=function(){},t.prototype.dispatch=function(t){return this.canDispatch()&&(this._alias=t,this._store=new r.Store(this.identity,this._initialState,this.dispatchStore.bind(this)),this.preDispatch(),this._store.dispatch(),this.postDispatch(),this.init()),this},t}();e.Component=a},46:function(t,n,e){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),i(e(47)),i(e(48))},47:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(27),g=n(1),y=n(2),o=n(8);function v(t,e){return t.split(e).map(function(t){return t.trim()})}function b(e,n){return function(t){if(e in o.DOM_ELEMENT_PROPERTIES)t[e]=n;else if(e in o.DOM_ELEMENT_ATTRIBUTES)switch(o.DOM_ELEMENT_ATTRIBUTES[e]){case o.MPFAttributeType.BOOLEAN:n?t.setAttribute(e,e):t.removeAttribute(e);break;case o.MPFAttributeType.STRING:t.setAttribute(e,n)}else t.setAttribute(e,n)}}e.dataBinder=function(t,e){var _=new i.Collector(t,e);return function(f,t,m){t(function(){for(var t,e,n,i=_.group(f.$,f.alias),o=0,r=Object.keys(i);o<r.length;o++)for(var s=r[o],a=0,l=v((t=s,e=f.alias,n=new RegExp(e+"\\"+y.COMPONENT_DATA_BIND_DEF_DELIMITER,"g"),t.replace(n,"")),y.COMPONENT_DATA_BIND_PROP_DELIMITER);a<l.length;a++){var u=v(l[a],y.COMPONENT_DATA_BIND_EQ),h=u[0],c=u[1];if("function"!=typeof f[c])g.print.warn("Method '"+c+"' not found in '"+f.alias+"' for key '"+s+"'");else{var p=i[s],d=f[c].bind(f)(m());p.forEach(b(h,d))}}})}}},476:function(t,e){!function(t,e,n,i){"use strict";var o=n.Basic.moduleOpts.setParams;o("MapView",{options:{}}),o("MapLeafletView",{options:{getGeoObjectParams:function(t){return t.type_event?this._opts.types["type"+t.type_event]:{}},geoObjectDefaults:{weight:3,color:"#f58c70",lineCap:"round",opacity:1},types:{type1:{icon:{iconUrl:"/img/map/1x/map-marker-burst.png",iconRetinaUrl:"/img/map/2x/map-marker-burst.png?@2X=2014.03.06",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type2:{icon:{iconUrl:"/img/map/1x/map-marker-airplane.png",iconRetinaUrl:"/img/map/2x/map-marker-airplane.png?@21X=2014.04.02",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type3:{icon:{iconUrl:"/img/map/1x/map-marker-flood.png",iconRetinaUrl:"/img/map/2x/map-marker-flood.png",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type4:{icon:{iconUrl:"/img/map/1x/map-marker-event-small.png",iconRetinaUrl:"/img/map/2x/map-marker-event-small.png",iconSize:[10,10],iconAnchor:[5,5],popupAnchor:[0,-3]}},type5:{icon:{iconUrl:"/img/map/1x/map-marker-event-mid.png",iconRetinaUrl:"/img/map/2x/map-marker-event-mid.png",iconSize:[26,26],iconAnchor:[13,13],popupAnchor:[0,-8]}},type6:{icon:{iconUrl:"/img/map/1x/map-marker-event-big.png",iconRetinaUrl:"/img/map/2x/map-marker-event-big.png",iconSize:[44,44],iconAnchor:[22,22],popupAnchor:[0,-10]}},type7:{color:"#f58c70"},type8:{color:"#ffbc00"},type9:{color:"#6bbedd"},type10:{color:"#f06eaa"},type11:{color:"#f58c70",dashArray:"5 15"}}}})}(window.jQuery||window.$,window,window.ru.mail.cpf,window.Terraformer)},477:function(t,e){!function(t,e,n){"use strict";(0,window.ru.mail.cpf.Basic.moduleOpts.setParams)("Slider.EmbedList",{options:{_plugins:["EmbedList"],cssClss:{animatedControl:"control_animated"},embedTypesToWatch:["vk_post","facebook"]}})}(window.jQuery||window.$,window)},478:function(t,e){!function(u,t,e){"use strict";var n=window.ru.mail.cpf.Basic,i=n.moduleOpts.setParams,h=n.typeOf,c=n.Constructors._repo.get("Popup");i("NewsletterView",{options:{cssSels:{Main:{form:".js-newsletter__form",input:".js-newsletter__input"}},cssClss:{subscribed:"hidden",inputInvalid:"error"}}}),i("NewsletterView.Chronicle",{options:{_Handlers:{model:{update:function(){var t=this._opts,e=this._elems,n=this._model,i=n.getState(),o=n._storageTools,r=n._opts.storage,s={},a=i.chronicle_id.toString();if("pending"==i.chronicle_action){var l=o.getItem(r.subscribedChroniclesIds)||[];h(l,"array")||l.split(","),l.push(a),o.setItem(l,!0,r.subscribedChroniclesIds),o.setItem(i.email,!0,r.subscribedChroniclesEmail),s={title:"–†–∞—Å—Å—ã–ª–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π —Ç–µ–º—ã",text:"<p>–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É –Ω–æ–≤–æ—Å—Ç–µ–π –ø–æ —Ç–µ–º–µ:</p><p><strong>"+i.chronicle_title+".</strong></p><p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤–æ—é –ø–æ—á—Ç—É –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Ä–∞—Å—Å—ã–ª–∫—É</p>"}}else"confirm"==i.chronicle_action?s={title:"–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏",text:"<p>–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞</p>"}:"reject"==i.chronicle_action&&(s={title:"–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏",text:"<p>–í—ã —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å –æ—Ç —Ä–∞—Å—Å—ã–ª–∫–∏</p>"});e.parent.toggleClass(t.cssClss.subscribed,n.isSubscribed()),function(t){var e=this._opts.templates.alert;e&&t&&(this._alertPopup=new c(null,u(e(t))),this._alertPopup.show())}.call(this,s)}}},paramName:"chronicle_action",toggleParent:!0}})}(window.jQuery||window.$,window)},479:function(t,e){!function(t,e){"use strict";var n=e.Basic.moduleOpts.setParams,i=e.Tools.PubSub;n("PhotoStories.Article",{options:{useBanner:!1,preloadDepth:2,_Handlers:{slide:function(){i.publish("fixedPanel_update_slot")}}}})}(window,window.ru.mail.cpf)},48:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=n(2),r=["focus","blur"];e.eventsBinder=function(h,c){var o={};return function(t){for(var u=function(t){for(var e={},n=0,i=Object.keys(t);n<i.length;n++){var o=i[n],r=o.split(p.COMPONENT_EVENT_DELIMITER),s=r[0],a=r[1];e[s]||(e[s]=[]);var l={name:a,handler:t[o]};e[s]=e[s].concat(l)}return e}(t),e=function(l){var t=function(t){for(var e=0,n=u[l];e<n.length;e++){var i=n[e],o=i.name,r=i.handler,s=t.target;if(null===s)return;for(var a=c(o);s!==h;){if(-1!==a.indexOf(s))return void r(t);s=s.parentNode}}},e=-1!==r.indexOf(l);h.addEventListener(l,t,e),o[l]={unbind:function(){h.removeEventListener(l,t)}}},n=0,i=Object.keys(u);n<i.length;n++)e(i[n]);return function(){for(var t=0,e=Object.keys(o);t<e.length;t++){var n=e[t];o[n].unbind(),delete o[n]}}}}},49:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r=n(26),p=n(1),d=n(24),f={},m={getPath:function(t,e,n){return t+"/"+e+"/"+e+n},getName:function(t){return t+".xml"}};function s(t,e){var n=e||{},i=d.applicationSettings.getState(),o=i.templatesPath,r=i.templatesNS,s=i.templatesExt;if(!o)throw new Error(p.format('Invalid application settings: "templatesPath"').error().str());if(!r)throw new Error(p.format('Invalid application settings: "templatesNS"').error().str());var a=n.getName,l=n.getPath,u="function"==typeof a?a(t):m.getName(t),h="function"==typeof l?l(o,t,s):m.getPath(o,t,s);if(f[h])return f[h];var c=new Promise(function(t,e){var n=function(t){return window[t]}(r);if(n&&n[u])return t(n[u]);var i=document.createElement("script");i.async=!0,i.type="text/javascript",i.src=h,i.addEventListener("load",function(){n&&n[u]?t(n[u]):e(new Error(p.format('Unable to read template "'+u+'"').error().str()))}),i.addEventListener("error",function(){e(new Error(p.format('Unable to load template from "'+u+'"').error().str()))}),document.head.appendChild(i)});return(f[h]=c).then(function(t){return delete f[h],t})}e.resolveTemplate=function(t,e){return function(){return"function"==typeof t?function(t){return Promise.resolve(t)}(t):"string"==typeof t?s(t,e):Promise.reject(new Error(p.format("Invalid template").error().str()))}};var a=function(i){function t(){return null!==i&&i.apply(this,arguments)||this}return o(t,i),t.prototype.update=function(t,e){var n=this;i.prototype.update.call(this,t,e),(0,this.options.template)().then(function(t){var e=n.getState();n.render(t,e)}).catch(function(t){p.print.warn(t.message)})},t.prototype.render=function(t,e){var n=t(e);this.$.innerHTML=n},t.getTemplate=e.resolveTemplate,t}(r.DOMComponent);e.TemplateComponent=a},50:function(t,n,e){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),i(e(51)),i(e(52)),i(e(28)),i(e(29)),i(e(54))},51:function(t,e,n){"use strict";function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.classNames=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var i=[],o=0,r=e;o<r.length;o++){var s=r[o];if(s){var a=c(s);if("string"===a||"number"===a)i.push(""+s);else if(Array.isArray(s))i=i.concat(t.apply(void 0,s));else for(var l=0,u=Object.keys(s);l<u.length;l++){var h=u[l];s[h]&&i.push(""+h)}}}return i}},52:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=n(28);function r(t){return Array.from(t.elements).reduce(function(t,e){var n=e,i=n.name,o=n.nodeName,r=n.type,s=n.checked,a=null!==e.getAttribute("disabled"),l=/^(?:input|select|textarea|keygen)/i.test(o),u=/^(?:submit|button|image|reset|file)$/i.test(r),h=s||!/^(?:checkbox|radio)$/i.test(r);if(i&&!a&&l&&!u&&h){var c=d.getValue(e);if(null===c)return t;if(Array.isArray(c)){var p=c.map(function(t){return{name:i,value:t.replace(/\r?\n/g,"\r\n")}});return t.concat(p)}return t.concat({name:i,value:(c||"").replace(/\r?\n/g,"\r\n")})}return t},[])}e.serializeArray=r,e.serializeObject=function(t){for(var e={},n=0,i=r(t);n<i.length;n++){var o=i[n];e[o.name]||(e[o.name]=[]),e[o.name]=e[o.name].concat(o.value)}return e},e.serializeStr=function(t){return r(t).map(function(t){var e=t.name,n=t.value;return encodeURIComponent(e)+"="+encodeURIComponent(null===n?"":n)}).join("&")}},53:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNodeName=function(t,e){return!!t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}},54:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={bubbles:!1,cancelable:!1,composed:!1};e.triggerCustomEvent=function(e,t,n){var i;void 0===n&&(n={}),n=Object.assign({},s,n);try{i=new Event(e,n)}catch(t){var o=n.bubbles,r=n.cancelable;(i=document.createEvent("Event")).initEvent(e,o,r)}t.dispatchEvent(i)}},6:function(t,n,e){"use strict";function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0}),i(e(38)),i(e(39))},61:function(t,e,n){"use strict";function i(t,i){var o=-1;return(t||[]).some(function(t,e){var n=i(t);return n&&(o=e),n}),o}Object.defineProperty(e,"__esModule",{value:!0}),e.findItem=function(e,t){return t.filter(function(t){return""+t.id==""+e})[0]},e.findItems=function(e,t){return t.filter(function(t){return t.id in e&&"0"!==e[t.id]})},e.findIndex=i,e.itemIndex=function(t,e){var n=""+t;return i(e,function(t){return""+t.id==n})},e.mapToDict=function(t,n){return(t||[]).reduce(function(t,e){return t[e]=n,t},{})}},62:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(61),a=n(172),p=n(63),l=function(t,e,n){if(e.length===t+1)return"";var i=e[t],o=i.answers,r=i.id,s=i.options;if(s){var a=s.next;if(a&&function(t){return!(!t||Array.isArray(t)&&0===t.length)}(n[d(r,!0)]))return p.log("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–ª —Å–≤–æ–π –æ—Ç–≤–µ—Ç, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–µ—Ö–æ–¥–∏–º —Å—é–¥–∞:",a),a}var l=n[d(r)];if(l){var u,h=Array.isArray(l);if(o.some(function(t){var e=t.next,n=t.id,i=h?-1!==l.indexOf(""+n):!(!e||!l[n]);return i&&(u=e),i}),u)return p.log("–ù–∞—à–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π id –≤ –æ–ø—Ü–∏—è—Ö –æ—Ç–≤–µ—Ç–æ–≤:",u),u}var c=e[t+1].id;return p.log("–ë–µ—Ä–µ–º —Å–ª–µ–¥—É—é—â–∏–π –ø–æ –ø–æ—Ä—è–¥–∫—É –≤–æ–ø—Ä–æ—Å:",c),c};function d(t,e){return"q_"+t+(e?"_":"")}e.createQuestionKey=d,e.findNextQuestion=function t(e,n,i){var o=l(e,n,i);if(!o)return p.log("–Ω–µ –Ω–∞—à–ª–∏ nextId"),null;var r=s.findItem(o,n);return r?a.checkIfCanShowQuestion(r,i)?r:t(s.itemIndex(r.id,n),n,i):(p.log("–Ω–µ –Ω–∞—à–ª–∏ –≤–æ–ø—Ä–æ—Å —Å id "+o),null)},e.mapToDictById=function n(t){return t.reduce(function(t,e){return e.answers&&(e.answersById=n(e.answers)),t[e.id]=e,t},{})}},63:function(t,e,n){"use strict";var i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var r=n(32);e.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.DEBUG&&console.log.apply(console,o([">>>"],t))}},64:function(t,e,n){(function(t){function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*! Terraformer JS - 1.0.4 - 2014-05-22
*   https://github.com/esri/Terraformer
*   Copyright (c) 2014 Environmental Systems Research Institute, Inc.
*   Licensed MIT */var e,n;e=window,n=function(){function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function o(t){if(t.type)switch(t.type){case"Point":return[t.coordinates[0],t.coordinates[1],t.coordinates[0],t.coordinates[1]];case"MultiPoint":case"LineString":return s(t.coordinates);case"MultiLineString":case"Polygon":return e(t.coordinates);case"MultiPolygon":return function(t){for(var e=null,n=null,i=null,o=null,r=0;r<t.length;r++)for(var s=t[r],a=0;a<s.length;a++)for(var l=s[a],u=0;u<l.length;u++){var h=l[u],c=h[0],p=h[1];null===e?e=c:c<e&&(e=c),null===n?n=c:n<c&&(n=c),null===i?i=p:p<i&&(i=p),null===o?o=p:o<p&&(o=p)}return[e,i,n,o]}(t.coordinates);case"Feature":return t.geometry?o(t.geometry):null;case"FeatureCollection":return function(t){for(var e,n=[],i=t.features.length-1;0<=i;i--)e=o(t.features[i].geometry),n.push([e[0],e[1]]),n.push([e[2],e[3]]);return s(n)}(t);case"GeometryCollection":return function(t){for(var e,n=[],i=t.geometries.length-1;0<=i;i--)e=o(t.geometries[i]),n.push([e[0],e[1]]),n.push([e[2],e[3]]);return s(n)}(t);default:throw new Error("Unknown type: "+t.type)}return null}function e(t){for(var e=null,n=null,i=null,o=null,r=0;r<t.length;r++)for(var s=t[r],a=0;a<s.length;a++){var l=s[a],u=l[0],h=l[1];null===e?e=u:u<e&&(e=u),null===n?n=u:n<u&&(n=u),null===i?i=h:h<i&&(i=h),null===o?o=h:o<h&&(o=h)}return[e,i,n,o]}function s(t){for(var e=null,n=null,i=null,o=null,r=0;r<t.length;r++){var s=t[r],a=s[0],l=s[1];null===e?e=a:a<e&&(e=a),null===n?n=a:n<a&&(n=a),null===i?i=l:l<i&&(i=l),null===o?o=l:o<l&&(o=l)}return[e,i,n,o]}function t(t){var e=o(t);return{x:e[0],y:e[1],w:Math.abs(e[0]-e[2]),h:Math.abs(e[1]-e[3])}}function i(t){return t*z}function a(t){return t*R}function l(t){var e=t[0],n=t[1];return[i(e/U)-360*Math.floor((i(e/U)+180)/360),i(Math.PI/2-2*Math.atan(Math.exp(-1*n/U)))]}function u(t){var e=t[0],n=Math.max(Math.min(t[1],89.99999),-89.99999);return[a(e)*U,U/2*Math.log((1+Math.sin(a(n)))/(1-Math.sin(a(n))))]}function h(t,e,n){if("Point"===t.type)t.coordinates=e(t.coordinates);else if("Feature"===t.type)t.geometry=h(t.geometry,e,!0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)t.features[i]=h(t.features[i],e,!0);else if("GeometryCollection"===t.type)for(var o=0;o<t.geometries.length;o++)t.geometries[o]=h(t.geometries[o],e,!0);else t.coordinates=function t(e,n){for(var i=0;i<e.length;i++)"number"==typeof e[i][0]&&(e[i]=n(e[i])),"object"==H(e[i])&&(e[i]=t(e[i],n));return e}(t.coordinates,e);return n||e===u&&(t.crs=Z),e===l&&delete t.crs,t}function c(t){return h(t,u)}function p(t){return h(t,l)}function d(t,e){return t[0]>e[0]?-1:t[0]<e[0]?1:t[1]>e[1]?-1:t[1]<e[1]?1:0}function f(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function m(t){var e,n,i=0,o=[];for(t=t.sort(d),e=0;e<t.length;++e){for(;2<=i&&f(o[i-2],o[i-1],t[e])<=0;)--i;o[i++]=t[e]}for(e=t.length-2,n=i+1;0<=e;--e){for(;n<=i&&f(o[i-2],o[i-1],t[e])<=0;)--i;o[i++]=t[e]}return o}function _(t,e){for(var n=!1,i=-1,o=t.length,r=o-1;++i<o;r=i)(t[i][1]<=e[1]&&e[1]<t[r][1]||t[r][1]<=e[1]&&e[1]<t[i][1])&&e[0]<(t[r][0]-t[i][0])*(e[1]-t[i][1])/(t[r][1]-t[i][1])+t[i][0]&&(n=!n);return n}function g(t,e){if(t&&t.length){if(1===t.length)return _(t[0],e);if(_(t[0],e)){for(var n=1;n<t.length;n++)if(_(t[n],e))return!1;return!0}return!1}return!1}function y(t,e,n,i){var o=(i[0]-n[0])*(t[1]-n[1])-(i[1]-n[1])*(t[0]-n[0]),r=(e[0]-t[0])*(t[1]-n[1])-(e[1]-t[1])*(t[0]-n[0]),s=(i[1]-n[1])*(e[0]-t[0])-(i[0]-n[0])*(e[1]-t[1]);if(0!=s){var a=o/s,l=r/s;if(0<=a&&a<=1&&0<=l&&l<=1)return!0}return!1}function v(t){return!isNaN(parseFloat(t))&&isFinite(t)}function b(t,e){if(v(t[0][0])){if(v(e[0][0])){for(var n=0;n<t.length-1;n++)for(var i=0;i<e.length-1;i++)if(y(t[n],t[n+1],e[i],e[i+1]))return!0}else for(var o=0;o<e.length;o++)if(b(t,e[o]))return!0}else for(var r=0;r<t.length;r++)if(b(t[r],e))return!0;return!1}function w(t){for(var e=[],n=0;n<t.length;n++){var i=t[n].slice();!1===P(i[0],i[i.length-1])&&i.push(i[0]),e.push(i)}return e}function P(t,e){for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function L(t,e){if(t.length!==e.length)return!1;for(var n=t.slice().sort(d),i=e.slice().sort(d),o=0;o<n.length;o++){if(n[o].length!==i[o].length)return!1;for(var r=0;r<n.length;r++)if(n[o][r]!==i[o][r])return!1}return!0}function T(t){if(t)switch(t.type){case"Point":return new E(t);case"MultiPoint":return new S(t);case"LineString":return new x(t);case"MultiLineString":return new M(t);case"Polygon":return new O(t);case"MultiPolygon":return new C(t);case"Feature":return new D(t);case"FeatureCollection":return new I(t);case"GeometryCollection":return new N(t);default:throw new Error("Unknown type: "+t.type)}}function E(t){var e=Array.prototype.slice.call(arguments);if(t&&"Point"===t.type&&t.coordinates)r(this,t);else if(t&&n(t))this.coordinates=t;else{if(!(2<=e.length))throw"Terraformer: invalid input for Terraformer.Point";this.coordinates=e}this.type="Point"}function S(t){if(t&&"MultiPoint"===t.type&&t.coordinates)r(this,t);else{if(!n(t))throw"Terraformer: invalid input for Terraformer.MultiPoint";this.coordinates=t}this.type="MultiPoint"}function x(t){if(t&&"LineString"===t.type&&t.coordinates)r(this,t);else{if(!n(t))throw"Terraformer: invalid input for Terraformer.LineString";this.coordinates=t}this.type="LineString"}function M(t){if(t&&"MultiLineString"===t.type&&t.coordinates)r(this,t);else{if(!n(t))throw"Terraformer: invalid input for Terraformer.MultiLineString";this.coordinates=t}this.type="MultiLineString"}function O(t){if(t&&"Polygon"===t.type&&t.coordinates)r(this,t);else{if(!n(t))throw"Terraformer: invalid input for Terraformer.Polygon";this.coordinates=t}this.type="Polygon"}function C(t){if(t&&"MultiPolygon"===t.type&&t.coordinates)r(this,t);else{if(!n(t))throw"Terraformer: invalid input for Terraformer.MultiPolygon";this.coordinates=t}this.type="MultiPolygon"}function D(t){if(t&&"Feature"===t.type)r(this,t);else{if(!(t&&t.type&&t.coordinates))throw"Terraformer: invalid input for Terraformer.Feature";this.geometry=t}this.type="Feature"}function I(t){if(t&&"FeatureCollection"===t.type&&t.features)r(this,t);else{if(!n(t))throw"Terraformer: invalid input for Terraformer.FeatureCollection";this.features=t}this.type="FeatureCollection"}function N(t){if(t&&"GeometryCollection"===t.type&&t.geometries)r(this,t);else if(n(t))this.geometries=t;else{if(!t.coordinates||!t.type)throw"Terraformer: invalid input for Terraformer.GeometryCollection";this.type="GeometryCollection",this.geometries=[t]}this.type="GeometryCollection"}function A(t,e,n){for(var i=u(t),o=n||64,r={type:"Polygon",coordinates:[[]]},s=1;s<=o;s++){var a=s*(360/o)*Math.PI/180;r.coordinates[0].push([i[0]+e*Math.cos(a),i[1]+e*Math.sin(a)])}return r.coordinates=w(r.coordinates),p(r)}function k(t,e,n){var i=n||64,o=e||250;if(!t||t.length<2||!o||!i)throw new Error("Terraformer: missing parameter for Terraformer.Circle");r(this,new D({type:"Feature",geometry:A(t,o,i),properties:{radius:o,center:t,steps:i}}))}var B={},U=6378137,z=57.29577951308232,R=.017453292519943,Z={type:"link",properties:{href:"http://spatialreference.org/ref/sr-org/6928/ogcwkt/",type:"ogcwkt"}},F=["length"];return T.prototype.toMercator=function(){return c(this)},T.prototype.toGeographic=function(){return p(this)},T.prototype.envelope=function(){return t(this)},T.prototype.bbox=function(){return o(this)},T.prototype.convexHull=function(){var t,e,n=[];if("Point"===this.type)return null;if("LineString"===this.type||"MultiPoint"===this.type){if(!(this.coordinates&&3<=this.coordinates.length))return null;n=this.coordinates}else if("Polygon"===this.type||"MultiLineString"===this.type){if(!(this.coordinates&&0<this.coordinates.length))return null;for(t=0;t<this.coordinates.length;t++)n=n.concat(this.coordinates[t]);if(n.length<3)return null}else if("MultiPolygon"===this.type){if(!(this.coordinates&&0<this.coordinates.length))return null;for(t=0;t<this.coordinates.length;t++)for(e=0;e<this.coordinates[t].length;e++)n=n.concat(this.coordinates[t][e]);if(n.length<3)return null}else if("Feature"===this.type){return new T(this.geometry).convexHull()}return new O({type:"Polygon",coordinates:w([m(n)])})},T.prototype.toJSON=function(){var t={};for(var e in this)this.hasOwnProperty(e)&&-1===F.indexOf(e)&&(t[e]=this[e]);return t.bbox=o(this),t},T.prototype.contains=function(t){return new T(t).within(this)},T.prototype.within=function(t){var e,n;if("Point"===t.type&&"Point"===this.type)return P(this.coordinates,t.coordinates);if("MultiLineString"===t.type&&"Point"===this.type)for(e=0;e<t.coordinates.length;e++){var i={type:"LineString",coordinates:t.coordinates[e]};if(this.within(i))return!0}if(("LineString"===t.type||"MultiPoint"===t.type)&&"Point"===this.type)for(e=0;e<t.coordinates.length;e++){if(this.coordinates.length!==t.coordinates[e].length)return!1;if(P(this.coordinates,t.coordinates[e]))return!0}if("Polygon"===t.type){if("Polygon"===this.type){if(t.coordinates.length===this.coordinates.length)for(e=0;e<this.coordinates.length;e++)if(L(this.coordinates[e],t.coordinates[e]))return!0;return!(!this.coordinates.length||!g(t.coordinates,this.coordinates[0][0]))&&!b(w(this.coordinates),w(t.coordinates))}if("Point"===this.type)return g(t.coordinates,this.coordinates);if("LineString"===this.type||"MultiPoint"===this.type){if(!this.coordinates||0===this.coordinates.length)return!1;for(e=0;e<this.coordinates.length;e++)if(!1===g(t.coordinates,this.coordinates[e]))return!1;return!0}if("MultiLineString"===this.type){for(e=0;e<this.coordinates.length;e++){if(!1===new x(this.coordinates[e]).within(t))return n++,!1}return!0}if("MultiPolygon"===this.type){for(e=0;e<this.coordinates.length;e++){if(!1===new T({type:"Polygon",coordinates:this.coordinates[e]}).within(t))return!1}return!0}}if("MultiPolygon"===t.type){if("Point"===this.type){if(t.coordinates.length)for(e=0;e<t.coordinates.length;e++)if(g(t.coordinates[e],this.coordinates)&&!1===b([this.coordinates],t.coordinates))return!0;return!1}if("Polygon"===this.type){for(e=0;e<this.coordinates.length;e++)if(t.coordinates[e].length===this.coordinates.length)for(j=0;j<this.coordinates.length;j++)if(L(this.coordinates[j],t.coordinates[e][j]))return!0;if(!1===b(this.coordinates,t.coordinates)&&t.coordinates.length){for(e=0;e<t.coordinates.length;e++)n=!1!==g(t.coordinates[e],this.coordinates[0][0]);return n}}else if("LineString"===this.type||"MultiPoint"===this.type)for(e=0;e<t.coordinates.length;e++){var o={type:"Polygon",coordinates:t.coordinates[e]};return!!this.within(o)}else{if("MultiLineString"===this.type){for(e=0;e<this.coordinates.length;e++){if(!1===new x(this.coordinates[e]).within(t))return!1}return!0}if("MultiPolygon"===this.type){for(e=0;e<t.coordinates.length;e++){var r={type:"Polygon",coordinates:t.coordinates[e]};if(!1===this.within(r))return!1}return!0}}}return!1},T.prototype.intersects=function(t){"Feature"===t.type&&(t=t.geometry);var e=new T(t);return!(!this.within(t)&&!e.within(this))||("Point"!==this.type&&"MultiPoint"!==this.type&&"Point"!==t.type&&"MultiPoint"!==t.type?b(this.coordinates,t.coordinates):"Feature"!==this.type?(function(){var t=Array.prototype.slice.apply(arguments);void 0!==("undefined"==typeof console?"undefined":H(console))&&console.warn&&console.warn.apply(console,t)}("Type "+this.type+" to "+t.type+" intersection is not supported by intersects"),!1):new T(this.geometry).intersects(t))},(E.prototype=new T).constructor=E,((S.prototype=new T).constructor=S).prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates]);return this},S.prototype.addPoint=function(t){return this.coordinates.push(t),this},S.prototype.insertPoint=function(t,e){return this.coordinates.splice(e,0,t),this},S.prototype.removePoint=function(t){return"number"==typeof t?this.coordinates.splice(t,1):this.coordinates.splice(this.coordinates.indexOf(t),1),this},S.prototype.get=function(t){return new E(this.coordinates[t])},((x.prototype=new T).constructor=x).prototype.addVertex=function(t){return this.coordinates.push(t),this},x.prototype.insertVertex=function(t,e){return this.coordinates.splice(e,0,t),this},x.prototype.removeVertex=function(t){return this.coordinates.splice(t,1),this},((M.prototype=new T).constructor=M).prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates])},M.prototype.get=function(t){return new x(this.coordinates[t])},((O.prototype=new T).constructor=O).prototype.addVertex=function(t){return this.coordinates[0].push(t),this},O.prototype.insertVertex=function(t,e){return this.coordinates[0].splice(e,0,t),this},O.prototype.removeVertex=function(t){return this.coordinates[0].splice(t,1),this},O.prototype.close=function(){this.coordinates=w(this.coordinates)},((C.prototype=new T).constructor=C).prototype.forEach=function(t){for(var e=0;e<this.coordinates.length;e++)t.apply(this,[this.coordinates[e],e,this.coordinates])},C.prototype.get=function(t){return new O(this.coordinates[t])},C.prototype.close=function(){var e=[];return this.forEach(function(t){e.push(w(t))}),this.coordinates=e,this},(D.prototype=new T).constructor=D,((I.prototype=new T).constructor=I).prototype.forEach=function(t){for(var e=0;e<this.features.length;e++)t.apply(this,[this.features[e],e,this.features])},I.prototype.get=function(e){var n;return this.forEach(function(t){t.id===e&&(n=t)}),new D(n)},((N.prototype=new T).constructor=N).prototype.forEach=function(t){for(var e=0;e<this.geometries.length;e++)t.apply(this,[this.geometries[e],e,this.geometries])},N.prototype.get=function(t){return new T(this.geometries[t])},((k.prototype=new T).constructor=k).prototype.recalculate=function(){return this.geometry=A(this.properties.center,this.properties.radius,this.properties.steps),this},k.prototype.center=function(t){return t&&(this.properties.center=t,this.recalculate()),this.properties.center},k.prototype.radius=function(t){return t&&(this.properties.radius=t,this.recalculate()),this.properties.radius},k.prototype.steps=function(t){return t&&(this.properties.steps=t,this.recalculate()),this.properties.steps},k.prototype.toJSON=function(){return T.prototype.toJSON.call(this)},B.Primitive=T,B.Point=E,B.MultiPoint=S,B.LineString=x,B.MultiLineString=M,B.Polygon=O,B.MultiPolygon=C,B.Feature=D,B.FeatureCollection=I,B.GeometryCollection=N,B.Circle=k,B.toMercator=c,B.toGeographic=p,B.Tools={},B.Tools.positionToMercator=u,B.Tools.positionToGeographic=l,B.Tools.applyConverter=h,B.Tools.toMercator=c,B.Tools.toGeographic=p,B.Tools.createCircle=A,B.Tools.calculateBounds=o,B.Tools.calculateEnvelope=t,B.Tools.coordinatesContainPoint=_,B.Tools.polygonContainsPoint=g,B.Tools.arraysIntersectArrays=b,B.Tools.coordinatesContainPoint=_,B.Tools.coordinatesEqual=L,B.Tools.convexHull=m,B.Tools.isConvex=function(t){for(var e,n=0;n<t.length-3;n++){var i=t[n],o=t[n+1],r=t[n+2],s=[o[0]-i[0],o[1]-i[1]],a=r[0]*s[1]-r[1]*s[0]+s[0]*i[1]-s[1]*i[0];if(0===n)e=a<0;else if(e&&0<a||!e&&a<0)return!1}return!0},B.MercatorCRS=Z,B.GeographicCRS={type:"link",properties:{href:"http://spatialreference.org/ref/epsg/4326/ogcwkt/",type:"ogcwkt"}},B},"object"==H(t)&&"object"==H(t.exports)&&(t.exports=n()),"object"==("undefined"==typeof window?"undefined":H(window))&&(e.Terraformer=n())}).call(this,n(21)(t))},76:function(t,e){!function(t,l,o){"use strict";var e=o.Basic,n=function(){function a(t,e){this._elems.sliding[t](e+"%")}function i(t){var e,n,i,o=!this._opts.isVertical,r=this._elems.parent,s=this.getOffset();s=o?(e="width",s.left):(e="height",s.top),n=r[e](),(i=Math.min((t-s)/n*100,100))==this._state.offset&&l.requestAnimationFrame(this.onAnimationEnd),this._state.offset=i,a.call(this,e,i)}return{_Handlers:{dom:{"resize:window":function(){this.fixSizes()},click:function(t){if(!this._state.animated)if(this._state.click){var e=this._elems.compareRegion.eq(0),n=this._opts.cssClss.animated;n&&(e.addClass(n).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.onAnimationEnd),this._swipe.pause(!0),this._state.animated=!0),i.call(this,function(t){return{x:t.pageX||t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.body.scrollTop+document.documentElement.scrollTop}}(t.originalEvent||t)[this._opts.isVertical?"y":"x"])}else this._state.click=!0}}},_Init:function(){var t=this._elems.compareRegion,e=this._opts.cssClss.animated;2!==t.length&&l.console.error("Wrong compare elems count"),e&&(this.onAnimationEnd=function(t,e){t.removeClass(e),this._state.animated=!1,this._swipe.pause(!1)}.bind(this,t.eq(0),e)),this._state={animated:!1,startFrom:null,click:!0,offset:this._opts.startOffset};var n=t.find("img");n.length?Promise.all(n.toArray().map(function(n){return!0===n.complete?Promise.resolve():new Promise(function(t,e){n.onload=t,n.onerror=e})})).then(this.fixSizes.bind(this)):this.fixSizes.call(this),function(){var n=this._opts.isVertical?1:0;this._swipe=o.Tools.initModule("Swipe",this._elems.parent,{targetAxis:this._opts.isVertical?"y":"x",resetDelta:!0,_Handlers:{start:function(t,e){this._state.startFrom=e.from[n]}.bind(this),move:function(t){i.call(this,this._state.startFrom+t[n])}.bind(this),end:function(){this._state.startFrom=null,this._state.click=!1}.bind(this)}})}.call(this)},getOffset:function(){var t=this._elems.parent.get(0).getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},fixSizes:function(){(function(){(function(){this._elems.compareContent.css({width:"",height:""}),this._elems.parent.height(""),this._elems.sliding[this._opts.isVertical?"height":"width"]("")}).call(this);for(var t,e,n,i=!this._opts.isVertical,o=this._elems.compareRegion.get(0).getBoundingClientRect(),r=this._elems.compareRegion.get(1).getBoundingClientRect(),s=this._elems.parent,a=["width","height"],l=0;l<a.length;l++)n=0===l,t=a[l],e=Math[n==i?"min":"max"](r[t],o[t],s[t]()),!n&&i?s[t](e):this._elems.compareContent[t](e)}).call(this),a.call(this,this._opts.isVertical?"height":"width",this._state.offset)}}}(),i=e.getView(n,{cssSels:{Main:{slider:".js-compare__separator",compareRegion:".js-compare__item",compareContent:".js-compare__size",sliding:".js-compare__sliding"}},cssClss:{animated:"compare__item_animated"},startOffset:"50",isVertical:!1},null,"CompareSlider");o.Basic.moduleOpts.setParams("CompareSlider",{paramAttrs:{startOffset:"data-startfrom",isVertical:"data-vertical"}}),e.Extend(l.getNameSpace("Modules",o),{CompareSlider:i})}(window.jQuery||window.$,window,window.ru.mail.cpf)},8:function(t,e,n){"use strict";var i,o,r,s;Object.defineProperty(e,"__esModule",{value:!0}),e.DOM_DATA_COMPONENT_SEL="[data-mp]",e.DOM_DATA_COMPONENT_NAME_ATTR="data-mp",e.DOM_DATA_COMPONENT_EL_ATTR="data-mp-el",e.DOM_DATA_COMPONENT_STATE_ATTR="data-mp-state",e.DOM_DATA_COMPONENT_BIND_ATTR="data-mp-bind",(o=i=e.MPFProperty||(e.MPFProperty={}))[o.STRING=0]="STRING",o[o.BOOLEAN=1]="BOOLEAN",o[o.NUMERIC=2]="NUMERIC",(s=r=e.MPFAttributeType||(e.MPFAttributeType={}))[s.STRING=0]="STRING",s[s.BOOLEAN=1]="BOOLEAN",e.DOM_ELEMENT_ATTRIBUTES={required:r.BOOLEAN,checked:r.BOOLEAN,disabled:r.BOOLEAN,selected:r.BOOLEAN},e.DOM_ELEMENT_PROPERTIES={alt:i.STRING,id:i.STRING,name:i.STRING,innerHTML:i.STRING,src:i.STRING,style:i.STRING,textContent:i.STRING,title:i.STRING,for:i.STRING,value:i.STRING,colspan:i.NUMERIC,height:i.NUMERIC,maxlength:i.NUMERIC,rowspan:i.NUMERIC,width:i.NUMERIC}},80:function(t,e,n){(function(t){var e;e=function(t,e){"use strict";var n=5e3,i="callback";function c(e){try{delete window[e]}catch(t){window[e]=void 0}}function p(t){var e=document.getElementById(t);e&&document.getElementsByTagName("head")[0].removeChild(e)}e.exports=function(r){var s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=r,l=s.timeout||n,u=s.jsonpCallback||i,h=void 0;return new Promise(function(e,t){var n=s.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),i=u+"_"+n;window[n]=function(t){e({ok:!0,json:function(){return Promise.resolve(t)}}),h&&clearTimeout(h),p(i),c(n)},a+=-1===a.indexOf("?")?"?":"&";var o=document.createElement("script");o.setAttribute("src",""+a+u+"="+n),s.charset&&o.setAttribute("charset",s.charset),o.id=i,document.getElementsByTagName("head")[0].appendChild(o),h=setTimeout(function(){t(new Error("JSONP request to "+r+" timed out")),c(n),p(i),window[n]=function(){c(n)}},l),o.onerror=function(){t(new Error("JSONP request to "+r+" failed")),c(n),p(i),h&&clearTimeout(h)}})}},"function"==typeof define&&define.amd?define(["exports","module"],e):e(0,t)}).call(this,n(21)(t))},83:function(t,e,o){(function(n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){if("object"==i(n)&&"object"==i(n.exports)&&(n.exports=e(o(64))),"object"==("undefined"==typeof navigator?"undefined":i(navigator))){if(!t.Terraformer)throw new Error("Terraformer.WKT requires the core Terraformer library. http://github.com/esri/terraformer");t.Terraformer.WKT=e(t.Terraformer)}}(window,function(n){function a(t){this.data=[t],this.type="PointArray"}function l(t){this.data=t,this.type="Ring"}function u(t){this.data=[t],this.type="RingList"}function h(t){this.data=[t],this.type="PolygonList"}function c(t){for(var e=[],n="",i=0;i<t.length;i++)e.push(t[i].join(" "));return n+"("+e.join(", ")+")"}var t={},i=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,point:4,EOF:5,linestring:6,polygon:7,multipoint:8,multilinestring:9,multipolygon:10,coordinate:11,DOUBLE_TOK:12,ptarray:13,COMMA:14,ring_list:15,ring:16,"(":17,")":18,POINT:19,Z:20,ZM:21,M:22,EMPTY:23,point_untagged:24,polygon_list:25,polygon_untagged:26,point_list:27,LINESTRING:28,POLYGON:29,MULTIPOINT:30,MULTILINESTRING:31,MULTIPOLYGON:32,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",12:"DOUBLE_TOK",14:"COMMA",17:"(",18:")",19:"POINT",20:"Z",21:"ZM",22:"M",23:"EMPTY",28:"LINESTRING",29:"POLYGON",30:"MULTIPOINT",31:"MULTILINESTRING",32:"MULTIPOLYGON"},productions_:[0,[3,2],[3,2],[3,2],[3,2],[3,2],[3,2],[11,2],[11,3],[11,4],[13,3],[13,1],[15,3],[15,1],[16,3],[4,4],[4,5],[4,5],[4,5],[4,2],[24,1],[24,3],[25,3],[25,1],[26,3],[27,3],[27,1],[6,4],[6,5],[6,5],[6,5],[6,2],[7,4],[7,5],[7,5],[7,5],[7,2],[8,4],[8,5],[8,5],[8,5],[8,2],[9,4],[9,5],[9,5],[9,5],[9,2],[10,4],[10,5],[10,5],[10,5],[10,2]],performAction:function(t,e,n,i,o,r){var s=r.length-1;switch(o){case 1:case 2:case 3:case 4:case 5:case 6:return r[s-1];case 7:this.$=new a([Number(r[s-1]),Number(r[s])]);break;case 8:this.$=new a([Number(r[s-2]),Number(r[s-1]),Number(r[s])]);break;case 9:this.$=new a([Number(r[s-3]),Number(r[s-2]),Number(r[s-1]),Number(r[s])]);break;case 10:this.$=r[s-2].addPoint(r[s]);break;case 11:this.$=r[s];break;case 12:this.$=r[s-2].addRing(r[s]);break;case 13:this.$=new u(r[s]);break;case 14:this.$=new l(r[s-1]);break;case 15:this.$={type:"Point",coordinates:r[s-1].data[0]};break;case 16:this.$={type:"Point",coordinates:r[s-1].data[0],properties:{z:!0}};break;case 17:this.$={type:"Point",coordinates:r[s-1].data[0],properties:{z:!0,m:!0}};break;case 18:this.$={type:"Point",coordinates:r[s-1].data[0],properties:{m:!0}};break;case 19:this.$={type:"Point",coordinates:[]};break;case 20:this.$=r[s];break;case 21:this.$=r[s-1];break;case 22:this.$=r[s-2].addPolygon(r[s]);break;case 23:this.$=new h(r[s]);break;case 24:this.$=r[s-1];break;case 25:this.$=r[s-2].addPoint(r[s]);break;case 26:this.$=r[s];break;case 27:this.$={type:"LineString",coordinates:r[s-1].data};break;case 28:this.$={type:"LineString",coordinates:r[s-1].data,properties:{z:!0}};break;case 29:this.$={type:"LineString",coordinates:r[s-1].data,properties:{m:!0}};break;case 30:this.$={type:"LineString",coordinates:r[s-1].data,properties:{z:!0,m:!0}};break;case 31:this.$={type:"LineString",coordinates:[]};break;case 32:this.$={type:"Polygon",coordinates:r[s-1].toJSON()};break;case 33:this.$={type:"Polygon",coordinates:r[s-1].toJSON(),properties:{z:!0}};break;case 34:this.$={type:"Polygon",coordinates:r[s-1].toJSON(),properties:{m:!0}};break;case 35:this.$={type:"Polygon",coordinates:r[s-1].toJSON(),properties:{z:!0,m:!0}};break;case 36:this.$={type:"Polygon",coordinates:[]};break;case 37:this.$={type:"MultiPoint",coordinates:r[s-1].data};break;case 38:this.$={type:"MultiPoint",coordinates:r[s-1].data,properties:{z:!0}};break;case 39:this.$={type:"MultiPoint",coordinates:r[s-1].data,properties:{m:!0}};break;case 40:this.$={type:"MultiPoint",coordinates:r[s-1].data,properties:{z:!0,m:!0}};break;case 41:this.$={type:"MultiPoint",coordinates:[]};break;case 42:this.$={type:"MultiLineString",coordinates:r[s-1].toJSON()};break;case 43:this.$={type:"MultiLineString",coordinates:r[s-1].toJSON(),properties:{z:!0}};break;case 44:this.$={type:"MultiLineString",coordinates:r[s-1].toJSON(),properties:{m:!0}};break;case 45:this.$={type:"MultiLineString",coordinates:r[s-1].toJSON(),properties:{z:!0,m:!0}};break;case 46:this.$={type:"MultiLineString",coordinates:[]};break;case 47:this.$={type:"MultiPolygon",coordinates:r[s-1].toJSON()};break;case 48:this.$={type:"MultiPolygon",coordinates:r[s-1].toJSON(),properties:{z:!0}};break;case 49:this.$={type:"MultiPolygon",coordinates:r[s-1].toJSON(),properties:{m:!0}};break;case 50:this.$={type:"MultiPolygon",coordinates:r[s-1].toJSON(),properties:{z:!0,m:!0}};break;case 51:this.$={type:"MultiPolygon",coordinates:[]}}},table:[{3:1,4:2,6:3,7:4,8:5,9:6,10:7,19:[1,8],28:[1,9],29:[1,10],30:[1,11],31:[1,12],32:[1,13]},{1:[3]},{5:[1,14]},{5:[1,15]},{5:[1,16]},{5:[1,17]},{5:[1,18]},{5:[1,19]},{17:[1,20],20:[1,21],21:[1,22],22:[1,23],23:[1,24]},{17:[1,25],20:[1,26],21:[1,28],22:[1,27],23:[1,29]},{17:[1,30],20:[1,31],21:[1,33],22:[1,32],23:[1,34]},{17:[1,35],20:[1,36],21:[1,38],22:[1,37],23:[1,39]},{17:[1,40],20:[1,41],21:[1,43],22:[1,42],23:[1,44]},{17:[1,45],20:[1,46],21:[1,48],22:[1,47],23:[1,49]},{1:[2,1]},{1:[2,2]},{1:[2,3]},{1:[2,4]},{1:[2,5]},{1:[2,6]},{11:51,12:[1,52],13:50},{17:[1,53]},{17:[1,54]},{17:[1,55]},{5:[2,19]},{11:58,12:[1,52],17:[1,59],24:57,27:56},{17:[1,60]},{17:[1,61]},{17:[1,62]},{5:[2,31]},{15:63,16:64,17:[1,65]},{17:[1,66]},{17:[1,67]},{17:[1,68]},{5:[2,36]},{11:58,12:[1,52],17:[1,59],24:57,27:69},{17:[1,70]},{17:[1,71]},{17:[1,72]},{5:[2,41]},{15:73,16:64,17:[1,65]},{17:[1,74]},{17:[1,75]},{17:[1,76]},{5:[2,46]},{17:[1,79],25:77,26:78},{17:[1,80]},{17:[1,81]},{17:[1,82]},{5:[2,51]},{14:[1,84],18:[1,83]},{14:[2,11],18:[2,11]},{12:[1,85]},{11:51,12:[1,52],13:86},{11:51,12:[1,52],13:87},{11:51,12:[1,52],13:88},{14:[1,90],18:[1,89]},{14:[2,26],18:[2,26]},{14:[2,20],18:[2,20]},{11:91,12:[1,52]},{11:58,12:[1,52],17:[1,59],24:57,27:92},{11:58,12:[1,52],17:[1,59],24:57,27:93},{11:58,12:[1,52],17:[1,59],24:57,27:94},{14:[1,96],18:[1,95]},{14:[2,13],18:[2,13]},{11:51,12:[1,52],13:97},{15:98,16:64,17:[1,65]},{15:99,16:64,17:[1,65]},{15:100,16:64,17:[1,65]},{14:[1,90],18:[1,101]},{11:58,12:[1,52],17:[1,59],24:57,27:102},{11:58,12:[1,52],17:[1,59],24:57,27:103},{11:58,12:[1,52],17:[1,59],24:57,27:104},{14:[1,96],18:[1,105]},{15:106,16:64,17:[1,65]},{15:107,16:64,17:[1,65]},{15:108,16:64,17:[1,65]},{14:[1,110],18:[1,109]},{14:[2,23],18:[2,23]},{15:111,16:64,17:[1,65]},{17:[1,79],25:112,26:78},{17:[1,79],25:113,26:78},{17:[1,79],25:114,26:78},{5:[2,15]},{11:115,12:[1,52]},{12:[1,116],14:[2,7],18:[2,7]},{14:[1,84],18:[1,117]},{14:[1,84],18:[1,118]},{14:[1,84],18:[1,119]},{5:[2,27]},{11:58,12:[1,52],17:[1,59],24:120},{18:[1,121]},{14:[1,90],18:[1,122]},{14:[1,90],18:[1,123]},{14:[1,90],18:[1,124]},{5:[2,32]},{16:125,17:[1,65]},{14:[1,84],18:[1,126]},{14:[1,96],18:[1,127]},{14:[1,96],18:[1,128]},{14:[1,96],18:[1,129]},{5:[2,37]},{14:[1,90],18:[1,130]},{14:[1,90],18:[1,131]},{14:[1,90],18:[1,132]},{5:[2,42]},{14:[1,96],18:[1,133]},{14:[1,96],18:[1,134]},{14:[1,96],18:[1,135]},{5:[2,47]},{17:[1,79],26:136},{14:[1,96],18:[1,137]},{14:[1,110],18:[1,138]},{14:[1,110],18:[1,139]},{14:[1,110],18:[1,140]},{14:[2,10],18:[2,10]},{12:[1,141],14:[2,8],18:[2,8]},{5:[2,16]},{5:[2,17]},{5:[2,18]},{14:[2,25],18:[2,25]},{14:[2,21],18:[2,21]},{5:[2,28]},{5:[2,29]},{5:[2,30]},{14:[2,12],18:[2,12]},{14:[2,14],18:[2,14]},{5:[2,33]},{5:[2,34]},{5:[2,35]},{5:[2,38]},{5:[2,39]},{5:[2,40]},{5:[2,43]},{5:[2,44]},{5:[2,45]},{14:[2,22],18:[2,22]},{14:[2,24],18:[2,24]},{5:[2,48]},{5:[2,49]},{5:[2,50]},{14:[2,9],18:[2,9]}],defaultActions:{14:[2,1],15:[2,2],16:[2,3],17:[2,4],18:[2,5],19:[2,6],24:[2,19],29:[2,31],34:[2,36],39:[2,41],44:[2,46],49:[2,51],83:[2,15],89:[2,27],95:[2,32],101:[2,37],105:[2,42],109:[2,47],117:[2,16],118:[2,17],119:[2,18],122:[2,28],123:[2,29],124:[2,30],127:[2,33],128:[2,34],129:[2,35],130:[2,38],131:[2,39],132:[2,40],133:[2,43],134:[2,44],135:[2,45],138:[2,48],139:[2,49],140:[2,50]},parseError:function(t){throw new Error(t)},parse:function(t){var e=this,n=[0],i=[null],o=[],r=this.table,s="",a=0,l=0,u=0;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===(this.yy.parser=this).lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;o.push(h);var c,p=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var d,f,m,_,g,y,v,b,w,P={};;){if(m=n[n.length-1],void 0===(_=this.defaultActions[m]?this.defaultActions[m]:(null==d&&(c=void 0,"number"!=typeof(c=e.lexer.lex()||1)&&(c=e.symbols_[c]||c),d=c),r[m]&&r[m][d]))||!_.length||!_[0]){var L="";if(!u){for(y in w=[],r[m])this.terminals_[y]&&2<y&&w.push("'"+this.terminals_[y]+"'");L=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[d]||d)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==d?"end of input":"'"+(this.terminals_[d]||d)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[d]||d,line:this.lexer.yylineno,loc:h,expected:w})}}if(_[0]instanceof Array&&1<_.length)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+d);switch(_[0]){case 1:n.push(d),i.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(_[1]),d=null,f?(d=f,f=null):(l=this.lexer.yyleng,s=this.lexer.yytext,a=this.lexer.yylineno,h=this.lexer.yylloc,0<u&&u--);break;case 2:if(v=this.productions_[_[1]][1],P.$=i[i.length-v],P._$={first_line:o[o.length-(v||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(v||1)].first_column,last_column:o[o.length-1].last_column},p&&(P._$.range=[o[o.length-(v||1)].range[0],o[o.length-1].range[1]]),void 0!==(g=this.performAction.call(P,s,l,a,this.yy,_[1],i,o)))return g;v&&(n=n.slice(0,-2*v),i=i.slice(0,-1*v),o=o.slice(0,-1*v)),n.push(this.productions_[_[1]][0]),i.push(P.$),o.push(P._$),b=r[n[n.length-2]][n[n.length-1]],n.push(b);break;case 3:return!0}}return!0}},n={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this},more:function(){return this._more=!0,this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done)return this.EOF;var t,e,n,i,o;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length&&(!(n=this._input.match(this.rules[r[s]]))||e&&!(n[0].length>e[0].length)||(e=n,i=s,this.options.flex));s++);return e?((o=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=o.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:o?o[o.length-1].length-o[o.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],t=this.performAction.call(this,this.yy,this,r[i],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),t||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return void 0!==t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)},options:{},performAction:function(t,e,n,i){switch(n){case 0:break;case 1:return 17;case 2:return 18;case 3:return 12;case 4:return 19;case 5:return 28;case 6:return 29;case 7:return 30;case 8:return 31;case 9:return 32;case 10:return 14;case 11:return 23;case 12:return 22;case 13:return 20;case 14:return 21;case 15:return 5;case 16:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:\()/,/^(?:\))/,/^(?:-?[0-9]+(\.[0-9]+)?)/,/^(?:POINT\b)/,/^(?:LINESTRING\b)/,/^(?:POLYGON\b)/,/^(?:MULTIPOINT\b)/,/^(?:MULTILINESTRING\b)/,/^(?:MULTIPOLYGON\b)/,/^(?:,)/,/^(?:EMPTY\b)/,/^(?:M\b)/,/^(?:Z\b)/,/^(?:ZM\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],inclusive:!0}}};return e.lexer=n,new((t.prototype=e).Parser=t)}();return a.prototype.addPoint=function(t){return"PointArray"===t.type?this.data=this.data.concat(t.data):this.data.push(t),this},a.prototype.toJSON=function(){return this.data},l.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.data.length;e++)t.push(this.data.data[e]);return t},u.prototype.addRing=function(t){return this.data.push(t),this},u.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.length;e++)t.push(this.data[e].toJSON());return t.length,t},h.prototype.addPolygon=function(t){return this.data.push(t),this},h.prototype.toJSON=function(){for(var t=[],e=0;e<this.data.length;e++)t=t.concat([this.data[e].toJSON()]);return t},t.parser=i,t.Parser=i.Parser,t.parse=function(t){var e;try{e=i.parse(t)}catch(t){throw Error("Unable to parse",t)}return n.Primitive(e)},t.convert=function(t){switch(t.type){case"Point":return function(t){var e="POINT ";return void 0===t.coordinates||0===t.coordinates.length?e+="EMPTY":(3===t.coordinates.length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates.length&&(e+="ZM "),e+="("+t.coordinates.join(" ")+")")}(t);case"LineString":return function(t){var e="LINESTRING ";return void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length?e+="EMPTY":(3===t.coordinates[0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0].length&&(e+="ZM "),e+=c(t.coordinates))}(t);case"Polygon":return function(t){var e="POLYGON ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+"EMPTY";3===t.coordinates[0][0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++)n.push(c(t.coordinates[i]));return(e+=n.join(", "))+")"}(t);case"MultiPoint":return function(t){var e="MULTIPOINT ";return void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length?e+="EMPTY":(3===t.coordinates[0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0].length&&(e+="ZM "),e+=c(t.coordinates))}(t);case"MultiLineString":return function(t){var e="MULTILINESTRING ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+"EMPTY";3===t.coordinates[0][0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++)n.push(c(t.coordinates[i]));return(e+=n.join(", "))+")"}(t);case"MultiPolygon":return function(t){var e="MULTIPOLYGON ";if(void 0===t.coordinates||0===t.coordinates.length||0===t.coordinates[0].length)return e+"EMPTY";3===t.coordinates[0][0][0].length?e+=t.properties&&!0===t.properties.m?"M ":"Z ":4===t.coordinates[0][0][0].length&&(e+="ZM "),e+="(";for(var n=[],i=0;i<t.coordinates.length;i++){for(var o="(",r=[],s=0;s<t.coordinates[i].length;s++)r.push(c(t.coordinates[i][s]));o+=r.join(", "),o+=")",n.push(o)}return(e+=n.join(", "))+")"}(t);default:throw Error("Unknown Type: "+t.type)}},t})}).call(this,o(21)(t))},84:function(t,e,n){(function(I){function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(s,p,a){var e,n,t=s.L,f={};f.version="0.7.7","object"==N(I)&&"object"==N(I.exports)?I.exports=f:"function"==typeof define&&define.amd&&define(f),f.noConflict=function(){return s.L=t,this},(s.L=f).Util={extend:function(t){var e,n,i,o,r=Array.prototype.slice.call(arguments,1);for(n=0,i=r.length;n<i;n++)for(e in o=r[n]||{})o.hasOwnProperty(e)&&(t[e]=o[e]);return t},bind:function(t,e){var n=2<arguments.length?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,n||arguments)}},stamp:(e=0,n="_leaflet_id",function(t){return t[n]=t[n]||++e,t[n]}),invokeEach:function(t,e,n){var i,o;if("object"!=N(t))return!1;for(i in o=Array.prototype.slice.call(arguments,3),t)e.apply(n,[i,t[i]].concat(o));return!0},limitExecByInterval:function(n,i,o){var r,s;return function t(){var e=arguments;return r?void(s=!0):(r=!0,setTimeout(function(){r=!1,s&&(t.apply(o,e),s=!1)},i),void n.apply(o,e))}},falseFn:function(){return!1},formatNum:function(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return f.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=f.extend({},t.options,e),t.options},getParamString:function(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")},template:function(t,i){return t.replace(/\{ *([\w_]+) *\}/g,function(t,e){var n=i[e];if(n===a)throw new Error("No value provided for variable "+t);return"function"==typeof n&&(n=n(i)),n})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var e,n,i=["webkit","moz","o","ms"];for(e=0;e<i.length&&!n;e++)n=s[i[e]+t];return n}function o(t){var e=+new Date,n=Math.max(0,16-(e-i));return i=e+n,s.setTimeout(t,n)}var i=0,r=s.requestAnimationFrame||t("RequestAnimationFrame")||o,e=s.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){s.clearTimeout(t)};f.Util.requestAnimFrame=function(t,e,n,i){return t=f.bind(t,e),n&&r===o?void t():r.call(s,t,i)},f.Util.cancelAnimFrame=function(t){t&&e.call(s,t)}}(),f.extend=f.Util.extend,f.bind=f.Util.bind,f.stamp=f.Util.stamp,f.setOptions=f.Util.setOptions,f.Class=function(){},f.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;for(var o in(i.constructor=e).prototype=i,this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);t.statics&&(f.extend(e,t.statics),delete t.statics),t.includes&&(f.Util.extend.apply(null,[i].concat(t.includes)),delete t.includes),t.options&&i.options&&(t.options=f.extend({},i.options,t.options)),f.extend(i,t),i._initHooks=[];var r=this;return e.__super__=r.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){r.prototype.callInitHooks&&r.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;t<e;t++)i._initHooks[t].call(this)}},e},f.Class.include=function(t){f.extend(this.prototype,t)},f.Class.mergeOptions=function(t){f.extend(this.prototype.options,t)},f.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var i,o,r,l,u,h,c,d,m,_,g,y,v,b,w,P,L,T,E,S,x,M,O,C="_leaflet_events";f.Mixin={},f.Mixin.Events={addEventListener:function(t,e,n){if(f.Util.invokeEach(t,this.addEventListener,this,e,n))return this;var i,o,r,s,a,l,u,h=this[C]=this[C]||{},c=n&&n!==this&&f.stamp(n);for(i=0,o=(t=f.Util.splitWords(t)).length;i<o;i++)r={action:e,context:n||this},s=t[i],c?(l=(a=s+"_idx")+"_len",(u=h[a]=h[a]||{})[c]||(u[c]=[],h[l]=(h[l]||0)+1),u[c].push(r)):(h[s]=h[s]||[],h[s].push(r));return this},hasEventListeners:function(t){var e=this[C];return!!e&&(t in e&&0<e[t].length||t+"_idx"in e&&0<e[t+"_idx_len"])},removeEventListener:function(t,e,n){if(!this[C])return this;if(!t)return this.clearAllEventListeners();if(f.Util.invokeEach(t,this.removeEventListener,this,e,n))return this;var i,o,r,s,a,l,u,h,c=this[C],p=n&&n!==this&&f.stamp(n);for(i=0,o=(t=f.Util.splitWords(t)).length;i<o;i++)if(u=(l=(r=t[i])+"_idx")+"_len",h=c[l],e){if(s=p&&h?h[p]:c[r]){for(a=s.length-1;0<=a;a--)s[a].action!==e||n&&s[a].context!==n||(s.splice(a,1)[0].action=f.Util.falseFn);n&&h&&0===s.length&&(delete h[p],c[u]--)}}else delete c[r],delete c[l],delete c[u];return this},clearAllEventListeners:function(){return delete this[C],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var n,i,o,r,s,a=f.Util.extend({},e,{type:t,target:this}),l=this[C];if(l[t])for(i=0,o=(n=l[t].slice()).length;i<o;i++)n[i].action.call(n[i].context,a);for(s in r=l[t+"_idx"])if(n=r[s].slice())for(i=0,o=n.length;i<o;i++)n[i].action.call(n[i].context,a);return this},addOneTimeEventListener:function(t,e,n){if(f.Util.invokeEach(t,this.addOneTimeEventListener,this,e,n))return this;var i=f.bind(function(){this.removeEventListener(t,e,n).removeEventListener(t,i,n)},this);return this.addEventListener(t,e,n).addEventListener(t,i,n)}},f.Mixin.Events.on=f.Mixin.Events.addEventListener,f.Mixin.Events.off=f.Mixin.Events.removeEventListener,f.Mixin.Events.once=f.Mixin.Events.addOneTimeEventListener,f.Mixin.Events.fire=f.Mixin.Events.fireEvent,u=(l="ActiveXObject"in s)&&!p.addEventListener,h=navigator.userAgent.toLowerCase(),c=-1!==h.indexOf("webkit"),d=-1!==h.indexOf("chrome"),m=-1!==h.indexOf("phantom"),_=-1!==h.indexOf("android"),g=-1!==h.search("android [23]"),y=-1!==h.indexOf("gecko"),v=("undefined"==typeof orientation?"undefined":N(orientation))!=a+"",b=!s.PointerEvent&&s.MSPointerEvent,w=s.PointerEvent&&s.navigator.pointerEnabled||b,P="devicePixelRatio"in s&&1<s.devicePixelRatio||"matchMedia"in s&&s.matchMedia("(min-resolution:144dpi)")&&s.matchMedia("(min-resolution:144dpi)").matches,L=p.documentElement,T=l&&"transition"in L.style,E="WebKitCSSMatrix"in s&&"m11"in new s.WebKitCSSMatrix&&!g,S="MozPerspective"in L.style,x="OTransition"in L.style,M=!s.L_DISABLE_3D&&(T||E||S||x)&&!m,O=!s.L_NO_TOUCH&&!m&&(w||"ontouchstart"in s||s.DocumentTouch&&p instanceof s.DocumentTouch),f.Browser={ie:l,ielt9:u,webkit:c,gecko:y&&!c&&!s.opera&&!l,android:_,android23:g,chrome:d,ie3d:T,webkit3d:E,gecko3d:S,opera3d:x,any3d:M,mobile:v,mobileWebkit:v&&c,mobileWebkit3d:v&&E,mobileOpera:v&&s.opera,touch:O,msPointer:b,pointer:w,retina:P},f.Point=function(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e},f.Point.prototype={clone:function(){return new f.Point(this.x,this.y)},add:function(t){return this.clone()._add(f.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(f.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){var e=(t=f.point(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=f.point(t)).x===this.x&&t.y===this.y},contains:function(t){return t=f.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+f.Util.formatNum(this.x)+", "+f.Util.formatNum(this.y)+")"}},f.point=function(t,e,n){return t instanceof f.Point?t:f.Util.isArray(t)?new f.Point(t[0],t[1]):t===a||null===t?t:new f.Point(t,e,n)},f.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])},f.Bounds.prototype={extend:function(t){return t=f.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new f.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new f.Point(this.min.x,this.max.y)},getTopRight:function(){return new f.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof f.Point?f.point(t):f.bounds(t))instanceof f.Bounds?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=f.bounds(t);var e=this.min,n=this.max,i=t.min,o=t.max,r=o.x>=e.x&&i.x<=n.x,s=o.y>=e.y&&i.y<=n.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},f.bounds=function(t,e){return!t||t instanceof f.Bounds?t:new f.Bounds(t,e)},f.Transformation=function(t,e,n,i){this._a=t,this._b=e,this._c=n,this._d=i},f.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new f.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},f.DomUtil={get:function(t){return"string"==typeof t?p.getElementById(t):t},getStyle:function(t,e){var n=t.style[e];if(!n&&t.currentStyle&&(n=t.currentStyle[e]),(!n||"auto"===n)&&p.defaultView){var i=p.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n},getViewportOffset:function(t){var e,n=0,i=0,o=t,r=p.body,s=p.documentElement;do{if(n+=o.offsetTop||0,i+=o.offsetLeft||0,n+=parseInt(f.DomUtil.getStyle(o,"borderTopWidth"),10)||0,i+=parseInt(f.DomUtil.getStyle(o,"borderLeftWidth"),10)||0,e=f.DomUtil.getStyle(o,"position"),o.offsetParent===r&&"absolute"===e)break;if("fixed"===e){n+=r.scrollTop||s.scrollTop||0,i+=r.scrollLeft||s.scrollLeft||0;break}if("relative"===e&&!o.offsetLeft){var a=f.DomUtil.getStyle(o,"width"),l=f.DomUtil.getStyle(o,"max-width"),u=o.getBoundingClientRect();("none"!==a||"none"!==l)&&(i+=u.left+o.clientLeft),n+=u.top+(r.scrollTop||s.scrollTop||0);break}o=o.offsetParent}while(o);o=t;do{if(o===r)break;n-=o.scrollTop||0,i-=o.scrollLeft||0,o=o.parentNode}while(o);return new f.Point(i,n)},documentIsLtr:function(){return f.DomUtil._docIsLtrCached||(f.DomUtil._docIsLtrCached=!0,f.DomUtil._docIsLtr="ltr"===f.DomUtil.getStyle(p.body,"direction")),f.DomUtil._docIsLtr},create:function(t,e,n){var i=p.createElement(t);return i.className=e,n&&n.appendChild(i),i},hasClass:function(t,e){if(t.classList!==a)return t.classList.contains(e);var n=f.DomUtil._getClass(t);return 0<n.length&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==a)for(var n=f.Util.splitWords(e),i=0,o=n.length;i<o;i++)t.classList.add(n[i]);else if(!f.DomUtil.hasClass(t,e)){var r=f.DomUtil._getClass(t);f.DomUtil._setClass(t,(r?r+" ":"")+e)}},removeClass:function(t,e){t.classList!==a?t.classList.remove(e):f.DomUtil._setClass(t,f.Util.trim((" "+f.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===a?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===a?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}},testProp:function(t){for(var e=p.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1},getTranslateString:function(t){var e=f.Browser.webkit3d,n=(e?",0":"")+")";return"translate"+(e?"3d":"")+"("+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){return f.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t)))+(" scale("+t+") ")},setPosition:function(t,e,n){t._leaflet_pos=e,!n&&f.Browser.any3d?t.style[f.DomUtil.TRANSFORM]=f.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},f.DomUtil.TRANSFORM=f.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),f.DomUtil.TRANSITION=f.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),f.DomUtil.TRANSITION_END="webkitTransition"===f.DomUtil.TRANSITION||"OTransition"===f.DomUtil.TRANSITION?f.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in p)f.extend(f.DomUtil,{disableTextSelection:function(){f.DomEvent.on(s,"selectstart",f.DomEvent.preventDefault)},enableTextSelection:function(){f.DomEvent.off(s,"selectstart",f.DomEvent.preventDefault)}});else{var e=f.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);f.extend(f.DomUtil,{disableTextSelection:function(){if(e){var t=p.documentElement.style;this._userSelect=t[e],t[e]="none"}},enableTextSelection:function(){e&&(p.documentElement.style[e]=this._userSelect,delete this._userSelect)}})}f.extend(f.DomUtil,{disableImageDrag:function(){f.DomEvent.on(s,"dragstart",f.DomEvent.preventDefault)},enableImageDrag:function(){f.DomEvent.off(s,"dragstart",f.DomEvent.preventDefault)}})}(),f.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==a&&(this.alt=parseFloat(n))},f.extend(f.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),f.LatLng.prototype={equals:function(t){return!!t&&(t=f.latLng(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=f.LatLng.MAX_MARGIN)},toString:function(t){return"LatLng("+f.Util.formatNum(this.lat,t)+", "+f.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=f.latLng(t);var e=f.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*e,i=(t.lng-this.lng)*e,o=this.lat*e,r=t.lat*e,s=Math.sin(n/2),a=Math.sin(i/2),l=s*s+a*a*Math.cos(o)*Math.cos(r);return 12756274*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))},wrap:function(t,e){var n=this.lng;return n=(n+(e=e||180))%(e-(t=t||-180))+(n<t||n===e?e:t),new f.LatLng(this.lat,n)}},f.latLng=function(t,e){return t instanceof f.LatLng?t:f.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new f.LatLng(t[0],t[1],t[2]):null:t===a||null===t?t:"object"==N(t)&&"lat"in t?new f.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===a?null:new f.LatLng(t,e)},f.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])},f.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=f.latLng(t);return(t=null!==e?e:f.latLngBounds(t))instanceof f.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new f.LatLng(t.lat,t.lng),this._northEast=new f.LatLng(t.lat,t.lng)):t instanceof f.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new f.LatLngBounds(new f.LatLng(e.lat-i,e.lng-o),new f.LatLng(n.lat+i,n.lng+o))},getCenter:function(){return new f.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new f.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new f.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof f.LatLng?f.latLng(t):f.latLngBounds(t);var e,n,i=this._southWest,o=this._northEast;return t instanceof f.LatLngBounds?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=o.lat&&e.lng>=i.lng&&n.lng<=o.lng},intersects:function(t){t=f.latLngBounds(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&i.lat<=n.lat,s=o.lng>=e.lng&&i.lng<=n.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=f.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},f.latLngBounds=function(t,e){return!t||t instanceof f.LatLngBounds?t:new f.LatLngBounds(t,e)},f.Projection={},f.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=f.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=t.lng*e,r=i*e;return r=Math.log(Math.tan(Math.PI/4+r/2)),new f.Point(o,r)},unproject:function(t){var e=f.LatLng.RAD_TO_DEG,n=t.x*e,i=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new f.LatLng(i,n)}},f.Projection.LonLat={project:function(t){return new f.Point(t.lng,t.lat)},unproject:function(t){return new f.LatLng(t.y,t.x)}},f.CRS={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return f.point(e,e)}},f.CRS.Simple=f.extend({},f.CRS,{projection:f.Projection.LonLat,transformation:new f.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),f.CRS.EPSG3857=f.extend({},f.CRS,{code:"EPSG:3857",projection:f.Projection.SphericalMercator,transformation:new f.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){return this.projection.project(t).multiplyBy(6378137)}}),f.CRS.EPSG900913=f.extend({},f.CRS.EPSG3857,{code:"EPSG:900913"}),f.CRS.EPSG4326=f.extend({},f.CRS,{code:"EPSG:4326",projection:f.Projection.LonLat,transformation:new f.Transformation(1/360,.5,-1/360,.5)}),f.Map=f.Class.extend({includes:f.Mixin.Events,options:{crs:f.CRS.EPSG3857,fadeAnimation:f.DomUtil.TRANSITION&&!f.Browser.android23,trackResize:!0,markerZoomAnimation:f.DomUtil.TRANSITION&&f.Browser.any3d},initialize:function(t,e){e=f.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=f.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==a&&this.setView(f.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===a?this.getZoom():e,this._resetView(f.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),r=(t instanceof f.Point?t:this.latLngToContainerPoint(t)).subtract(o).multiplyBy(1-1/i),s=this.containerPointToLatLng(o.add(r));return this.setView(s,e,{zoom:n})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():f.latLngBounds(t);var n=f.point(e.paddingTopLeft||e.padding||[0,0]),i=f.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i));o=e.maxZoom?Math.min(e.maxZoom,o):o;var r=i.subtract(n).divideBy(2),s=this.project(t.getSouthWest(),o),a=this.project(t.getNorthEast(),o),l=this.unproject(s.add(a).divideBy(2).add(r),o);return this.setView(l,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(f.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=f.latLngBounds(t),(this.options.maxBounds=t)?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,t);return n.equals(i)?this:this.panTo(i,e)},addLayer:function(t){var e=f.stamp(t);return this._layers[e]||(!(this._layers[e]=t).options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&f.TileLayer&&t instanceof f.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t)),this},removeLayer:function(t){var e=f.stamp(t);return this._layers[e]&&(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&f.TileLayer&&t instanceof f.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this))),this},hasLayer:function(t){return!!t&&f.stamp(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=f.extend({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),o=n.divideBy(2).round(),r=i.subtract(o);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(f.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=a}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new f.LatLngBounds(e,n)},getMinZoom:function(){return this.options.minZoom===a?this._layersMinZoom===a?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===a?this._layersMaxZoom===a?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=f.latLngBounds(t);var i,o=this.getMinZoom()-(e?1:0),r=this.getMaxZoom(),s=this.getSize(),a=t.getNorthWest(),l=t.getSouthEast(),u=!0;for(n=f.point(n||[0,0]);o++,i=this.project(l,o).subtract(this.project(a,o)).add(n),(u=e?i.x<s.x||i.y<s.y:s.contains(i))&&o<=r;);return u&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new f.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new f.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===a?this._zoom:e,this.options.crs.latLngToPoint(f.latLng(t),e)},unproject:function(t,e){return e=e===a?this._zoom:e,this.options.crs.pointToLatLng(f.point(t),e)},layerPointToLatLng:function(t){var e=f.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(f.latLng(t))._round()._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return f.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return f.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(f.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(f.latLng(t)))},mouseEventToContainerPoint:function(t){return f.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=f.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;f.DomUtil.addClass(t,"leaflet-container"+(f.Browser.touch?" leaflet-touch":"")+(f.Browser.retina?" leaflet-retina":"")+(f.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=f.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(f.DomUtil.addClass(t.markerPane,e),f.DomUtil.addClass(t.shadowPane,e),f.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return f.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){for(var e=0,n=(t=t?f.Util.isArray(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_resetView:function(t,e,n,i){var o=this._zoom!==e;i||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),n?this._initialTopLeftPoint._add(this._getMapPanePos()):f.DomUtil.setPosition(this._mapPane,new f.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var r=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),r&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(o||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(t){f.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,i=this._getZoomSpan();for(t in this._zoomBoundLayers){var o=this._zoomBoundLayers[t];isNaN(o.options.minZoom)||(e=Math.min(e,o.options.minZoom)),isNaN(o.options.maxZoom)||(n=Math.max(n,o.options.maxZoom))}t===a?this._layersMaxZoom=this._layersMinZoom=a:(this._layersMaxZoom=n,this._layersMinZoom=e),i!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(f.DomEvent){t=t||"on",f.DomEvent[t](this._container,"click",this._onMouseClick,this);var e,n,i=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(e=0,n=i.length;e<n;e++)f.DomEvent[t](this._container,i[e],this._fireMouseEvent,this);this.options.trackResize&&f.DomEvent[t](s,"resize",this._onResize,this)}},_onResize:function(){f.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=f.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||f.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!f.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&f.DomEvent.preventDefault(t);var n=this.mouseEventToContainerPoint(t),i=this.containerPointToLayerPoint(n),o=this.layerPointToLatLng(i);this.fire(e,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return f.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewTopLeftPoint(n,e).add(this._getMapPanePos());return this.project(t,e)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),r=new f.Bounds(i.subtract(o),i.add(o)),s=this._getBoundsOffset(r,n,e);return this.unproject(i.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new f.Bounds(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=this.project(e.getNorthWest(),n).subtract(t.min),o=this.project(e.getSouthEast(),n).subtract(t.max),r=this._rebound(i.x,-o.x),s=this._rebound(i.y,-o.y);return new f.Point(r,s)},_rebound:function(t,e){return 0<t+e?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom();return Math.max(e,Math.min(n,t))}}),f.map=function(t,e){return new f.Map(t,e)},f.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=f.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=this.R_MAJOR,r=this.R_MINOR,s=t.lng*e*o,a=i*e,l=r/o,u=Math.sqrt(1-l*l),h=u*Math.sin(a);h=Math.pow((1-h)/(1+h),.5*u);var c=Math.tan(.5*(.5*Math.PI-a))/h;return a=-o*Math.log(c),new f.Point(s,a)},unproject:function(t){for(var e,n=f.LatLng.RAD_TO_DEG,i=this.R_MAJOR,o=this.R_MINOR,r=t.x*n/i,s=o/i,a=Math.sqrt(1-s*s),l=Math.exp(-t.y/i),u=Math.PI/2-2*Math.atan(l),h=15,c=.1;1e-7<Math.abs(c)&&0<--h;)e=a*Math.sin(u),u+=c=Math.PI/2-2*Math.atan(l*Math.pow((1-e)/(1+e),.5*a))-u;return new f.LatLng(u*n,r)}},f.CRS.EPSG3395=f.extend({},f.CRS,{code:"EPSG:3395",projection:f.Projection.Mercator,transformation:(o=f.Projection.Mercator.R_MAJOR,r=.5/(Math.PI*o),new f.Transformation(r,.5,-r,.5))}),f.TileLayer=f.Class.extend({includes:f.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:f.Browser.mobile,updateWhenIdle:f.Browser.mobile},initialize:function(t,e){(e=f.setOptions(this,e)).detectRetina&&f.Browser.retina&&0<e.maxZoom&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,0<e.minZoom&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=f.latLngBounds(e.bounds)),this._url=t;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=f.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==a&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var n,i,o,r=t.children,s=-e(1/0,-1/0);for(i=0,o=r.length;i<o;i++)r[i]!==this._container&&(n=parseInt(r[i].style.zIndex,10),isNaN(n)||(s=e(s,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(s)?s:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(f.Browser.ielt9)for(t in e)f.DomUtil.setOpacity(e[t],this.options.opacity);else f.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=f.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=f.DomUtil.create("div",e,this._container),this._tileContainer=f.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&n<e&&(i=Math.round(t.getZoomScale(e)/t.getZoomScale(n)*i)),i},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),n=t.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var o=f.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(t){var e,n,i,o=[],r=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(n=t.min.x;n<=t.max.x;n++)i=new f.Point(n,e),this._tileShouldBeLoaded(i)&&o.push(i);var s=o.length;if(0!==s){o.sort(function(t,e){return t.distanceTo(r)-e.distanceTo(r)});var a=p.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=s,n=0;n<s;n++)this._addTile(o[n],a);this._tileContainer.appendChild(a)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var n=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=n.x)||t.y<0||t.y>=n.y)return!1}if(e.bounds){var i=this._getTileSize(),o=t.multiplyBy(i),r=o.add([i,i]),s=this._map.unproject(o),a=this._map.unproject(r);if(e.continuousWorld||e.noWrap||(s=s.wrap(),a=a.wrap()),!e.bounds.intersects([s,a]))return!1}return!0},_removeOtherTiles:function(t){var e,n,i,o;for(o in this._tiles)e=o.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),(n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(f.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),f.Browser.android||(e.onload=null,e.src=f.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var n=this._getTilePos(t),i=this._getTile();f.DomUtil.setPosition(i,n,f.Browser.chrome),this._tiles[t.x+":"+t.y]=i,this._loadTile(i,t),i.parentNode!==this._tileContainer&&e.appendChild(i)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),n=this._getTileSize();return t.multiplyBy(n).subtract(e)},getTileUrl:function(t){return f.Util.template(this._url,f.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&0<this._unusedTiles.length){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=f.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=f.Util.falseFn,f.Browser.ielt9&&this.options.opacity!==a&&f.DomUtil.setOpacity(t,this.options.opacity),f.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&f.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(f.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==f.Util.emptyImageUrl&&(f.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),f.tileLayer=function(t,e){return new f.TileLayer(t,e)},f.TileLayer.WMS=f.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var n=f.extend({},this.defaultWmsParams),i=e.tileSize||this.options.tileSize;for(var o in e.detectRetina&&f.Browser.retina?n.width=n.height=2*i:n.width=n.height=i,e)this.options.hasOwnProperty(o)||"crs"===o||(n[o]=e[o]);this.wmsParams=n,f.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[e]=this._crs.code,f.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,n=this.options.tileSize,i=t.multiplyBy(n),o=i.add([n,n]),r=this._crs.project(e.unproject(i,t.z)),s=this._crs.project(e.unproject(o,t.z)),a=1.3<=this._wmsVersion&&this._crs===f.CRS.EPSG4326?[s.y,r.x,r.y,s.x].join(","):[r.x,s.y,s.x,r.y].join(","),l=f.Util.template(this._url,{s:this._getSubdomain(t)});return l+f.Util.getParamString(this.wmsParams,l,!0)+"&BBOX="+a},setParams:function(t,e){return f.extend(this.wmsParams,t),e||this.redraw(),this}}),f.tileLayer.wms=function(t,e){return new f.TileLayer.WMS(t,e)},f.TileLayer.Canvas=f.TileLayer.extend({options:{async:!1},initialize:function(t){f.setOptions(this,t)},redraw:function(){for(var t in this._map&&(this._reset({hard:!0}),this._update()),this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=f.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=f.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),f.tileLayer.canvas=function(t){return new f.TileLayer.Canvas(t)},f.ImageOverlay=f.Class.extend({includes:f.Mixin.Events,options:{opacity:1},initialize:function(t,e,n){this._url=t,this._bounds=f.latLngBounds(e),f.setOptions(this,n)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&f.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=f.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&f.Browser.any3d?f.DomUtil.addClass(this._image,"leaflet-zoom-animated"):f.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),f.extend(this._image,{galleryimg:"no",onselectstart:f.Util.falseFn,onmousemove:f.Util.falseFn,onload:f.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,n=this._image,i=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),r=this._bounds.getSouthEast(),s=e._latLngToNewLayerPoint(o,t.zoom,t.center),a=e._latLngToNewLayerPoint(r,t.zoom,t.center)._subtract(s),l=s._add(a._multiplyBy(.5*(1-1/i)));n.style[f.DomUtil.TRANSFORM]=f.DomUtil.getTranslateString(l)+" scale("+i+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);f.DomUtil.setPosition(t,e),t.style.width=n.x+"px",t.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){f.DomUtil.setOpacity(this._image,this.options.opacity)}}),f.imageOverlay=function(t,e,n){return new f.ImageOverlay(t,e,n)},f.Icon=f.Class.extend({options:{className:""},initialize:function(t){f.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n,i=this._getIconUrl(t);if(i)return n=e&&"IMG"===e.tagName?this._createImg(i,e):this._createImg(i),this._setIconStyles(n,t),n;if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null},_setIconStyles:function(t,e){var n,i=this.options,o=f.point(i[e+"Size"]);!(n="shadow"===e?f.point(i.shadowAnchor||i.iconAnchor):f.point(i.iconAnchor))&&o&&(n=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+i.className,n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return(e=e||p.createElement("img")).src=t,e},_getIconUrl:function(t){return f.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),f.icon=function(t){return new f.Icon(t)},f.Icon.Default=f.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];f.Browser.retina&&"icon"===t&&(t+="-2x");var n=f.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+".png"}}),f.Icon.Default.imagePath=function(){var t,e,n,i,o=p.getElementsByTagName("script"),r=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=o.length;t<e;t++)if((n=o[t].src).match(r))return((i=n.split(r)[0])?i+"/":"")+"images"}(),f.Marker=f.Class.extend({includes:f.Mixin.Events,options:{icon:new f.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){f.setOptions(this,e),this._latlng=f.latLng(t)},onAdd:function(t){(this._map=t).on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=f.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",i=t.icon.createIcon(this._icon),o=!1;i!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),f.DomUtil.addClass(i,n),t.keyboard&&(i.tabIndex="0"),this._icon=i,this._initInteraction(),t.riseOnHover&&f.DomEvent.on(i,"mouseover",this._bringToFront,this).on(i,"mouseout",this._resetZIndex,this);var r=t.icon.createShadow(this._shadow),s=!1;r!==this._shadow&&(this._removeShadow(),s=!0),r&&f.DomUtil.addClass(r,n),this._shadow=r,t.opacity<1&&this._updateOpacity();var a=this._map._panes;o&&a.markerPane.appendChild(this._icon),r&&s&&a.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&f.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){f.DomUtil.setPosition(this._icon,t),this._shadow&&f.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];f.DomUtil.addClass(t,"leaflet-clickable"),f.DomEvent.on(t,"click",this._onMouseClick,this),f.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)f.DomEvent.on(t,e[n],this._fireMouseEvent,this);f.Handler.MarkerDrag&&(this.dragging=new f.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&f.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&f.DomEvent.preventDefault(t),"mousedown"!==t.type?f.DomEvent.stopPropagation(t):f.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){f.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&f.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),f.marker=function(t,e){return new f.Marker(t,e)},f.DivIcon=f.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:p.createElement("div"),n=this.options;return!1!==n.html?e.innerHTML=n.html:e.innerHTML="",n.bgPos&&(e.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),f.divIcon=function(t){return new f.DivIcon(t)},f.Map.mergeOptions({closePopupOnClick:!0}),f.Popup=f.Class.extend({includes:f.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){f.setOptions(this,t),this._source=e,this._animated=f.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&f.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&f.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),f.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&f.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=f.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",n=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=f.DomUtil.create("div",n);this.options.closeButton&&((t=this._closeButton=f.DomUtil.create("a",e+"-close-button",i)).href="#close",t.innerHTML="&#215;",f.DomEvent.disableClickPropagation(t),f.DomEvent.on(t,"click",this._onCloseButtonClick,this));var o=this._wrapper=f.DomUtil.create("div",e+"-content-wrapper",i);f.DomEvent.disableClickPropagation(o),this._contentNode=f.DomUtil.create("div",e+"-content",o),f.DomEvent.disableScrollPropagation(this._contentNode),f.DomEvent.on(o,"contextmenu",f.DomEvent.stopPropagation),this._tipContainer=f.DomUtil.create("div",e+"-tip-container",i),this._tip=f.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&o<i?(e.height=o+"px",f.DomUtil.addClass(t,r)):f.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=f.point(this.options.offset);e&&f.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);f.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,n=this._containerWidth,i=new f.Point(this._containerLeft,-e-this._containerBottom);this._animated&&i._add(f.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(i),r=f.point(this.options.autoPanPadding),s=f.point(this.options.autoPanPaddingTopLeft||r),a=f.point(this.options.autoPanPaddingBottomRight||r),l=t.getSize(),u=0,h=0;o.x+n+a.x>l.x&&(u=o.x+n-l.x+a.x),o.x-u-s.x<0&&(u=o.x-s.x),o.y+e+a.y>l.y&&(h=o.y+e-l.y+a.y),o.y-h-s.y<0&&(h=o.y-s.y),(u||h)&&t.fire("autopanstart").panBy([u,h])}},_onCloseButtonClick:function(t){this._close(),f.DomEvent.stop(t)}}),f.popup=function(t,e){return new f.Popup(t,e)},f.Map.include({openPopup:function(t,e,n){if(this.closePopup(),!(t instanceof f.Popup)){var i=t;t=new f.Popup(n).setLatLng(e).setContent(i)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),f.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var n=f.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(f.Popup.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=f.extend({offset:n},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof f.Popup?(f.setOptions(t,e),(this._popup=t)._source=this):this._popup=new f.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),f.LayerGroup=f.Class.extend({initialize:function(t){var e,n;if(this._layers={},t)for(e=0,n=t.length;e<n;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return f.stamp(t)}}),f.layerGroup=function(t){return new f.LayerGroup(t)},f.FeatureGroup=f.LayerGroup.extend({includes:f.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(f.FeatureGroup.EVENTS,this._propagateEvent,this),f.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(f.FeatureGroup.EVENTS,this._propagateEvent,this),f.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new f.LatLngBounds;return this.eachLayer(function(t){e.extend(t instanceof f.Marker?t.getLatLng():t.getBounds())}),e},_propagateEvent:function(t){t=f.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),f.featureGroup=function(t){return new f.FeatureGroup(t)},f.Path=f.Class.extend({includes:[f.Mixin.Events],statics:{CLIP_PADDING:(i=((f.Browser.mobile?1280:2e3)/Math.max(s.outerWidth,s.outerHeight)-1)/2,Math.max(0,Math.min(.5,i)))},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){f.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,f.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return f.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),f.Map.include({_updatePathViewport:function(){var t=f.Path.CLIP_PADDING,e=this.getSize(),n=f.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),i=n.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new f.Bounds(n,i)}}),f.Path.SVG_NS="http://www.w3.org/2000/svg",f.Browser.svg=!(!p.createElementNS||!p.createElementNS(f.Path.SVG_NS,"svg").createSVGRect),f.Path=f.Path.extend({statics:{SVG:f.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,n=t.firstChild;return e&&n!==e&&t.insertBefore(e,n),this},getPathString:function(){},_createElement:function(t){return p.createElementNS(f.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&f.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(f.Browser.svg||!f.Browser.vml)&&f.DomUtil.addClass(this._path,"leaflet-clickable"),f.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)f.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,n=e.mouseEventToContainerPoint(t),i=e.containerPointToLayerPoint(n),o=e.layerPointToLatLng(i);this.fire(t.type,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t}),"contextmenu"===t.type&&f.DomEvent.preventDefault(t),"mousemove"!==t.type&&f.DomEvent.stopPropagation(t)}}}),f.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=f.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&f.Browser.any3d?(f.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):f.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),n=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[f.DomUtil.TRANSFORM]=f.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max,i=n.x-e.x,o=n.y-e.y,r=this._pathRoot,s=this._panes.overlayPane;f.Browser.mobileWebkit&&s.removeChild(r),f.DomUtil.setPosition(r,e),r.setAttribute("width",i),r.setAttribute("height",o),r.setAttribute("viewBox",[e.x,e.y,i,o].join(" ")),f.Browser.mobileWebkit&&s.appendChild(r)}}}),f.Path.include({bindPopup:function(t,e){return t instanceof f.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new f.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),f.Browser.vml=!f.Browser.svg&&function(){try{var t=p.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==N(e.adj)}catch(t){return!1}}(),f.Path=f.Browser.svg||!f.Browser.vml?f.Path:f.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return p.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return p.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return p.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");f.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&f.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(t||((t=this._stroke=this._createElement("stroke")).endcap="round",i.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,n.dashArray?t.dashStyle=f.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):t.dashStyle="",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(i.removeChild(t),this._stroke=null),n.fill?(e||(e=this._fill=this._createElement("fill"),i.appendChild(e)),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(i.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),f.Map.include(f.Browser.svg||!f.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=p.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),f.Browser.canvas=!!p.createElement("canvas").getContext,f.Path=f.Path.SVG&&!s.L_PREFER_CANVAS||!f.Browser.canvas?f.Path:f.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return f.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!f.Path._updateRequest&&(f.Path._updateRequest=f.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){f.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,n,i,o,r;for(this._ctx.beginPath(),t=0,n=this._parts.length;t<n;t++){for(e=0,i=this._parts[t].length;e<i;e++)o=this._parts[t][e],r=(0===e?"move":"line")+"To",this._ctx[r](o.x,o.y);this instanceof f.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),f.Map.include(f.Path.SVG&&!s.L_PREFER_CANVAS||!f.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||((e=this._pathRoot=p.createElement("canvas")).style.position="absolute",(t=this._canvasCtx=e.getContext("2d")).lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max.subtract(e),i=this._pathRoot;f.DomUtil.setPosition(i,e),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-e.x,-e.y)}}}),f.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),this._simplifyDP(t,n)},pointToSegmentDistance:function(t,e,n){return Math.sqrt(this._sqClosestPointOnSegment(t,e,n,!0))},closestPointOnSegment:function(t,e,n){return this._sqClosestPointOnSegment(t,e,n)},_simplifyDP:function(t,e){var n=t.length,i=new(("undefined"==typeof Uint8Array?"undefined":N(Uint8Array))!=a+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,this._simplifyDPStep(t,i,e,0,n-1);var o,r=[];for(o=0;o<n;o++)i[o]&&r.push(t[o]);return r},_simplifyDPStep:function(t,e,n,i,o){var r,s,a,l=0;for(s=i+1;s<=o-1;s++)l<(a=this._sqClosestPointOnSegment(t[s],t[i],t[o],!0))&&(r=s,l=a);n<l&&(e[r]=1,this._simplifyDPStep(t,e,n,i,r),this._simplifyDPStep(t,e,n,r,o))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,o=0,r=t.length;i<r;i++)this._sqDist(t[i],t[o])>e&&(n.push(t[i]),o=i);return o<r-1&&n.push(t[r-1]),n},clipSegment:function(t,e,n,i){var o,r,s,a=i?this._lastCode:this._getBitCode(t,n),l=this._getBitCode(e,n);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;o=a||l,r=this._getEdgeIntersection(t,e,o,n),s=this._getBitCode(r,n),o===a?(t=r,a=s):(e=r,l=s)}},_getEdgeIntersection:function(t,e,n,i){var o=e.x-t.x,r=e.y-t.y,s=i.min,a=i.max;return 8&n?new f.Point(t.x+o*(a.y-t.y)/r,a.y):4&n?new f.Point(t.x+o*(s.y-t.y)/r,s.y):2&n?new f.Point(a.x,t.y+r*(a.x-t.x)/o):1&n?new f.Point(s.x,t.y+r*(s.x-t.x)/o):void 0},_getBitCode:function(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_sqClosestPointOnSegment:function(t,e,n,i){var o,r=e.x,s=e.y,a=n.x-r,l=n.y-s,u=a*a+l*l;return 0<u&&(1<(o=((t.x-r)*a+(t.y-s)*l)/u)?(r=n.x,s=n.y):0<o&&(r+=a*o,s+=l*o)),a=t.x-r,l=t.y-s,i?a*a+l*l:new f.Point(r,s)}},f.Polyline=f.Path.extend({initialize:function(t,e){f.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;t<e;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,n="";t<e;t++)n+=this._getPathPartStr(this._parts[t]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(f.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,n,i=1/0,o=this._parts,r=null,s=0,a=o.length;s<a;s++)for(var l=o[s],u=1,h=l.length;u<h;u++){e=l[u-1],n=l[u];var c=f.LineUtil._sqClosestPointOnSegment(t,e,n,!0);c<i&&(i=c,r=f.LineUtil._sqClosestPointOnSegment(t,e,n))}return r&&(r.distance=Math.sqrt(i)),r},getBounds:function(){return new f.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var n,i,o=e?t:[];for(n=0,i=t.length;n<i;n++){if(f.Util.isArray(t[n])&&"number"!=typeof t[n][0])return;o[n]=f.latLng(t[n])}return o},_initEvents:function(){f.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,n=f.Path.VML,i=0,o=t.length,r="";i<o;i++)e=t[i],n&&e._round(),r+=(i?"L":"M")+e.x+" "+e.y;return r},_clipPoints:function(){var t,e,n,i=this._originalPoints,o=i.length;if(this.options.noClip)this._parts=[i];else{this._parts=[];var r=this._parts,s=this._map._pathViewport,a=f.LineUtil;for(e=t=0;t<o-1;t++)(n=a.clipSegment(i[t],i[t+1],s,t))&&(r[e]=r[e]||[],r[e].push(n[0]),(n[1]!==i[t+1]||t===o-2)&&(r[e].push(n[1]),e++))}},_simplifyPoints:function(){for(var t=this._parts,e=f.LineUtil,n=0,i=t.length;n<i;n++)t[n]=e.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),f.Path.prototype._updatePath.call(this))}}),f.polyline=function(t,e){return new f.Polyline(t,e)},f.PolyUtil={},f.PolyUtil.clipPolygon=function(t,e){var n,i,o,r,s,a,l,u,h,c=[1,4,2,8],p=f.LineUtil;for(i=0,l=t.length;i<l;i++)t[i]._code=p._getBitCode(t[i],e);for(r=0;r<4;r++){for(u=c[r],n=[],i=0,o=(l=t.length)-1;i<l;o=i++)s=t[i],a=t[o],s._code&u?a._code&u||((h=p._getEdgeIntersection(a,s,u,e))._code=p._getBitCode(h,e),n.push(h)):(a._code&u&&((h=p._getEdgeIntersection(a,s,u,e))._code=p._getBitCode(h,e),n.push(h)),n.push(s));t=n}return t},f.Polygon=f.Polyline.extend({options:{fill:!0},initialize:function(t,e){f.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,n,i;if(t&&f.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,n=this._holes.length;e<n;e++)(i=this._holes[e]=this._convertLatLngs(this._holes[e]))[0].equals(i[i.length-1])&&i.pop();2<=(t=this._latlngs).length&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){var t,e,n,i;if(f.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(t=0,n=this._holes.length;t<n;t++)for(this._holePoints[t]=[],e=0,i=this._holes[t].length;e<i;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])},setLatLngs:function(t){return t&&f.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):f.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;n<i;n++){var o=f.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){return f.Polyline.prototype._getPathPartStr.call(this,t)+(f.Browser.svg?"z":"x")}}),f.polygon=function(t,e){return new f.Polygon(t,e)},function(){function t(t){return f.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var n=0,i=e.length;for(this.eachLayer(function(t){n<i?t.setLatLngs(e[n++]):this.removeLayer(t)},this);n<i;)this.addLayer(new t(e[n++],this._options));return this},getLatLngs:function(){var e=[];return this.eachLayer(function(t){e.push(t.getLatLngs())}),e}})}f.MultiPolyline=t(f.Polyline),f.MultiPolygon=t(f.Polygon),f.multiPolyline=function(t,e){return new f.MultiPolyline(t,e)},f.multiPolygon=function(t,e){return new f.MultiPolygon(t,e)}}(),f.Rectangle=f.Polygon.extend({initialize:function(t,e){f.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=f.latLngBounds(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),f.rectangle=function(t,e){return new f.Rectangle(t,e)},f.Circle=f.Path.extend({initialize:function(t,e,n){f.Path.prototype.initialize.call(this,n),this._latlng=f.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=f.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,n=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,n=this._latlng;return new f.LatLngBounds([n.lat-e,n.lng-t],[n.lat+e,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":f.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(f.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,n=this._point;return n.x-e>t.max.x||n.y-e>t.max.y||n.x+e<t.min.x||n.y+e<t.min.y}}),f.circle=function(t,e,n){return new f.Circle(t,e,n)},f.CircleMarker=f.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){f.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){f.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return f.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),f.circleMarker=function(t,e){return new f.CircleMarker(t,e)},f.Polyline.include(f.Path.CANVAS?{_containsPoint:function(t,e){var n,i,o,r,s,a,l=this.options.weight/2;for(f.Browser.touch&&(l+=10),n=0,r=this._parts.length;n<r;n++)for(i=0,o=(s=(a=this._parts[n]).length)-1;i<s;o=i++)if((e||0!==i)&&f.LineUtil.pointToSegmentDistance(t,a[o],a[i])<=l)return!0;return!1}}:{}),f.Polygon.include(f.Path.CANVAS?{_containsPoint:function(t){var e,n,i,o,r,s,a,l,u=!1;if(f.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,a=this._parts.length;o<a;o++)for(r=0,s=(l=(e=this._parts[o]).length)-1;r<l;s=r++)n=e[r],i=e[s],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(u=!u);return u}}:{}),f.Circle.include(f.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,n=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+n}}:{}),f.CircleMarker.include(f.Path.CANVAS?{_updateStyle:function(){f.Path.prototype._updateStyle.call(this)}}:{}),f.GeoJSON=f.FeatureGroup.extend({initialize:function(t,e){f.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,o=f.Util.isArray(t)?t:t.features;if(o){for(e=0,n=o.length;e<n;e++)((i=o[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(o[e]);return this}var r=this.options;if(!r.filter||r.filter(t)){var s=f.GeoJSON.geometryToLayer(t,r.pointToLayer,r.coordsToLatLng,r);return s.feature=f.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)}},resetStyle:function(t){var e=this.options.style;e&&(f.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),f.extend(f.GeoJSON,{geometryToLayer:function(t,e,n,i){var o,r,s,a,l="Feature"===t.type?t.geometry:t,u=l.coordinates,h=[];switch(n=n||this.coordsToLatLng,l.type){case"Point":return o=n(u),e?e(t,o):new f.Marker(o);case"MultiPoint":for(s=0,a=u.length;s<a;s++)o=n(u[s]),h.push(e?e(t,o):new f.Marker(o));return new f.FeatureGroup(h);case"LineString":return r=this.coordsToLatLngs(u,0,n),new f.Polyline(r,i);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return r=this.coordsToLatLngs(u,1,n),new f.Polygon(r,i);case"MultiLineString":return r=this.coordsToLatLngs(u,1,n),new f.MultiPolyline(r,i);case"MultiPolygon":return r=this.coordsToLatLngs(u,2,n),new f.MultiPolygon(r,i);case"GeometryCollection":for(s=0,a=l.geometries.length;s<a;s++)h.push(this.geometryToLayer({geometry:l.geometries[s],type:"Feature",properties:t.properties},e,n,i));return new f.FeatureGroup(h);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new f.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,n){var i,o,r,s=[];for(o=0,r=t.length;o<r;o++)i=e?this.coordsToLatLngs(t[o],e-1,n):(n||this.coordsToLatLng)(t[o]),s.push(i);return s},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==a&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(f.GeoJSON.latLngToCoords(t[n]));return e},getFeature:function(t,e){return t.feature?f.extend({},t.feature,{geometry:e}):f.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var D={toGeoJSON:function(){return f.GeoJSON.getFeature(this,{type:"Point",coordinates:f.GeoJSON.latLngToCoords(this.getLatLng())})}};f.Marker.include(D),f.Circle.include(D),f.CircleMarker.include(D),f.Polyline.include({toGeoJSON:function(){return f.GeoJSON.getFeature(this,{type:"LineString",coordinates:f.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),f.Polygon.include({toGeoJSON:function(){var t,e,n,i=[f.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(t=0,e=this._holes.length;t<e;t++)(n=f.GeoJSON.latLngsToCoords(this._holes[t])).push(n[0]),i.push(n);return f.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function o(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),f.GeoJSON.getFeature(this,{type:t,coordinates:e})}}f.MultiPolyline.include({toGeoJSON:o("MultiLineString")}),f.MultiPolygon.include({toGeoJSON:o("MultiPolygon")}),f.LayerGroup.include({toGeoJSON:function(){var e,t=this.feature&&this.feature.geometry,n=[];if(t&&"MultiPoint"===t.type)return o("MultiPoint").call(this);var i=t&&"GeometryCollection"===t.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),n.push(i?e.geometry:f.GeoJSON.asFeature(e)))}),i?f.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}})}(),f.geoJson=function(t,e){return new f.GeoJSON(t,e)},f.DomEvent={addListener:function(e,t,n,i){var o,r,s,a=f.stamp(n),l="_leaflet_"+t+a;return e[l]?this:(o=function(t){return n.call(i||e,t||f.DomEvent._getEvent())},f.Browser.pointer&&0===t.indexOf("touch")?this.addPointerListener(e,t,o,a):(f.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener&&this.addDoubleTapListener(e,o,a),"addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",o,!1),e.addEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?(r=o,s="mouseenter"===t?"mouseover":"mouseout",o=function(t){return f.DomEvent._checkMouse(e,t)?r(t):void 0},e.addEventListener(s,o,!1)):("click"===t&&f.Browser.android&&(r=o,o=function(t){return f.DomEvent._filterClick(t,r)}),e.addEventListener(t,o,!1)):"attachEvent"in e&&e.attachEvent("on"+t,o),e[l]=o,this))},removeListener:function(t,e,n){var i=f.stamp(n),o="_leaflet_"+e+i,r=t[o];return r&&(f.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,i):f.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,i):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",r,!1),t.removeEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1):t.removeEventListener(e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[o]=null),this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,f.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=f.DomEvent.stopPropagation;return f.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=f.DomEvent.stopPropagation,n=f.Draggable.START.length-1;0<=n;n--)f.DomEvent.on(t,f.Draggable.START[n],e);return f.DomEvent.on(t,"click",f.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return f.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new f.Point(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new f.Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){f.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t},_getEvent:function(){var t=s.event;if(!t)for(var e=arguments.callee.caller;e&&(!(t=e.arguments[0])||s.Event!==t.constructor);)e=e.caller;return t},_filterClick:function(t,e){var n=t.timeStamp||t.originalEvent.timeStamp,i=f.DomEvent._lastClick&&n-f.DomEvent._lastClick;return i&&100<i&&i<500||t.target._simulatedClick&&!t._simulated?void f.DomEvent.stop(t):(f.DomEvent._lastClick=n,e(t))}},f.DomEvent.on=f.DomEvent.addListener,f.DomEvent.off=f.DomEvent.removeListener,f.Draggable=f.Class.extend({includes:f.Mixin.Events,statics:{START:f.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=f.Draggable.START.length-1;0<=t;t--)f.DomEvent.on(this._dragStartTarget,f.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=f.Draggable.START.length-1;0<=t;t--)f.DomEvent.off(this._dragStartTarget,f.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(f.DomEvent.stopPropagation(t),!f.Draggable._disabled&&(f.DomUtil.disableImageDrag(),f.DomUtil.disableTextSelection(),!this._moving))){var e=t.touches?t.touches[0]:t;this._startPoint=new f.Point(e.clientX,e.clientY),this._startPos=this._newPos=f.DomUtil.getPosition(this._element),f.DomEvent.on(p,f.Draggable.MOVE[t.type],this._onMove,this).on(p,f.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&1<t.touches.length)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new f.Point(e.clientX,e.clientY).subtract(this._startPoint);(n.x||n.y)&&(f.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3||(f.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=f.DomUtil.getPosition(this._element).subtract(n),f.DomUtil.addClass(p.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,f.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,f.Util.cancelAnimFrame(this._animRequest),this._animRequest=f.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))}},_updatePosition:function(){this.fire("predrag"),f.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){for(var t in f.DomUtil.removeClass(p.body,"leaflet-dragging"),this._lastTarget&&(f.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),f.Draggable.MOVE)f.DomEvent.off(p,f.Draggable.MOVE[t],this._onMove).off(p,f.Draggable.END[t],this._onUp);f.DomUtil.enableImageDrag(),f.DomUtil.enableTextSelection(),this._moved&&this._moving&&(f.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),f.Handler=f.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),f.Map.mergeOptions({dragging:!0,inertia:!f.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:f.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),f.Map.Drag=f.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new f.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),200<t-this._times[0]&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,r=(i+e+n)%t-e-n,s=Math.abs(o+n)<Math.abs(r+n)?o:r;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,i=+new Date-this._lastTime,o=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var r=this._lastPos.subtract(this._positions[0]),s=(this._lastTime+i-this._times[0])/1e3,a=n.easeLinearity,l=r.multiplyBy(a/s),u=l.distanceTo([0,0]),h=Math.min(n.inertiaMaxSpeed,u),c=l.multiplyBy(h/u),p=h/(n.inertiaDeceleration*a),d=c.multiplyBy(-p/2).round();d.x&&d.y?(d=e._limitOffset(d,e.options.maxBounds),f.Util.requestAnimFrame(function(){e.panBy(d,{duration:p,easeLinearity:a,noMoveStart:!0})})):e.fire("moveend")}}}),f.Map.addInitHook("addHandler","dragging",f.Map.Drag),f.Map.mergeOptions({doubleClickZoom:!0}),f.Map.DoubleClickZoom=f.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),f.Map.addInitHook("addHandler","doubleClickZoom",f.Map.DoubleClickZoom),f.Map.mergeOptions({scrollWheelZoom:!0}),f.Map.ScrollWheelZoom=f.Handler.extend({addHooks:function(){f.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),f.DomEvent.on(this._map._container,"MozMousePixelScroll",f.DomEvent.preventDefault),this._delta=0},removeHooks:function(){f.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),f.DomEvent.off(this._map._container,"MozMousePixelScroll",f.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=f.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(f.bind(this._performZoom,this),n),f.DomEvent.preventDefault(t),f.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,n=t.getZoom();e=0<e?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(n+e)-n,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(n+e):t.setZoomAround(this._lastMousePos,n+e))}}),f.Map.addInitHook("addHandler","scrollWheelZoom",f.Map.ScrollWheelZoom),f.extend(f.DomEvent,{_touchstart:f.Browser.msPointer?"MSPointerDown":f.Browser.pointer?"pointerdown":"touchstart",_touchend:f.Browser.msPointer?"MSPointerUp":f.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,r,e){function n(t){if(!(1<(f.Browser.pointer?(h.push(t.pointerId),h.length):t.touches.length))){var e=Date.now(),n=e-(s||e);a=t.touches?t.touches[0]:t,l=0<n&&n<=250,s=e}}function i(t){if(f.Browser.pointer){var e=h.indexOf(t.pointerId);if(-1===e)return;h.splice(e,1)}if(l){if(f.Browser.pointer){var n,i={};for(var o in a)n=a[o],i[o]="function"==typeof n?n.bind(a):n;a=i}a.type="dblclick",r(a),s=null}}var s,a,l=!1,o=this._touchstart,u=this._touchend,h=[];t["_leaflet_"+o+e]=n,t["_leaflet_"+u+e]=i;var c=f.Browser.pointer?p.documentElement:t;return t.addEventListener(o,n,!1),c.addEventListener(u,i,!1),f.Browser.pointer&&c.addEventListener(f.DomEvent.POINTER_CANCEL,i,!1),this},removeDoubleTapListener:function(t,e){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+e],!1),(f.Browser.pointer?p.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+e],!1),f.Browser.pointer&&p.documentElement.removeEventListener(f.DomEvent.POINTER_CANCEL,t[n+this._touchend+e],!1),this}}),f.extend(f.DomEvent,{POINTER_DOWN:f.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:f.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:f.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:f.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,n,i){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,n,i);case"touchend":return this.addPointerListenerEnd(t,e,n,i);case"touchmove":return this.addPointerListenerMove(t,e,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,e,i,n){var o=this._pointers,r=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&f.DomEvent.preventDefault(t);for(var e=!1,n=0;n<o.length;n++)if(o[n].pointerId===t.pointerId){e=!0;break}e||o.push(t),t.touches=o.slice(),t.changedTouches=[t],i(t)};if(t["_leaflet_touchstart"+n]=r,t.addEventListener(this.POINTER_DOWN,r,!1),!this._pointerDocumentListener){var s=function(t){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o.splice(e,1);break}};p.documentElement.addEventListener(this.POINTER_UP,s,!1),p.documentElement.addEventListener(this.POINTER_CANCEL,s,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,n,i){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r[e]=t;break}t.touches=r.slice(),t.changedTouches=[t],n(t)}}var r=this._pointers;return t["_leaflet_touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,n,i){var o=this._pointers,r=function(t){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o.splice(e,1);break}t.touches=o.slice(),t.changedTouches=[t],n(t)};return t["_leaflet_touchend"+i]=r,t.addEventListener(this.POINTER_UP,r,!1),t.addEventListener(this.POINTER_CANCEL,r,!1),this},removePointerListener:function(t,e,n){var i=t["_leaflet_"+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,i,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,i,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,i,!1),t.removeEventListener(this.POINTER_CANCEL,i,!1)}return this}}),f.Map.mergeOptions({touchZoom:f.Browser.touch&&!f.Browser.android23,bounceAtZoomLimits:!0}),f.Map.TouchZoom=f.Handler.extend({addHooks:function(){f.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){f.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]),o=e._getCenterLayerPoint();this._startCenter=n.add(i)._divideBy(2),this._startDist=n.distanceTo(i),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),f.DomEvent.on(p,"touchmove",this._onTouchMove,this).on(p,"touchend",this._onTouchEnd,this),f.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&1<this._scale))&&(this._moved||(f.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),f.Util.cancelAnimFrame(this._animRequest),this._animRequest=f.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),f.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getScaleZoom(this._scale);t._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(this._moved&&this._zooming){var t=this._map;this._zooming=!1,f.DomUtil.removeClass(t._mapPane,"leaflet-touching"),f.Util.cancelAnimFrame(this._animRequest),f.DomEvent.off(p,"touchmove",this._onTouchMove).off(p,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getZoom(),o=t.getScaleZoom(this._scale)-i,r=0<o?Math.ceil(o):Math.floor(o),s=t._limitZoom(i+r),a=t.getZoomScale(s)/this._scale;t._animateZoom(n,s,e,a)}else this._zooming=!1},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),f.Map.addInitHook("addHandler","touchZoom",f.Map.TouchZoom),f.Map.mergeOptions({tap:!0,tapTolerance:15}),f.Map.Tap=f.Handler.extend({addHooks:function(){f.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){f.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(f.DomEvent.preventDefault(t),this._fireClick=!0,1<t.touches.length)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new f.Point(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&f.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(f.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),f.DomEvent.on(p,"touchmove",this._onMove,this).on(p,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),f.DomEvent.off(p,"touchmove",this._onMove,this).off(p,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&f.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new f.Point(e.clientX,e.clientY)},_simulateEvent:function(t,e){var n=p.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,s,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}),f.Browser.touch&&!f.Browser.pointer&&f.Map.addInitHook("addHandler","tap",f.Map.Tap),f.Map.mergeOptions({boxZoom:!0}),f.Map.BoxZoom=f.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){f.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){f.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!(!t.shiftKey||1!==t.which&&1!==t.button)&&(f.DomUtil.disableTextSelection(),f.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void f.DomEvent.on(p,"mousemove",this._onMouseMove,this).on(p,"mouseup",this._onMouseUp,this).on(p,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=f.DomUtil.create("div","leaflet-zoom-box",this._pane),f.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(t),o=i.subtract(e),r=new f.Point(Math.min(i.x,e.x),Math.min(i.y,e.y));f.DomUtil.setPosition(n,r),this._moved=!0,n.style.width=Math.max(0,Math.abs(o.x)-4)+"px",n.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),f.DomUtil.enableTextSelection(),f.DomUtil.enableImageDrag(),f.DomEvent.off(p,"mousemove",this._onMouseMove).off(p,"mouseup",this._onMouseUp).off(p,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,n=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(n)){var i=new f.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(n));e.fitBounds(i),e.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),f.Map.addInitHook("addHandler","boxZoom",f.Map.BoxZoom),f.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),f.Map.Keyboard=f.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),f.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;f.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var t=p.body,e=p.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),s.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;e<n;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;e<n;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;e<n;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;e<n;e++)i[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;e<n;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;e<n;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){f.DomEvent.on(p,"keydown",this._onKeyDown,this)},_removeHooks:function(){f.DomEvent.off(p,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[e]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(e in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[e])}f.DomEvent.stop(t)}}),f.Map.addInitHook("addHandler","keyboard",f.Map.Keyboard),f.Handler.MarkerDrag=f.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new f.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),f.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),f.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,n=f.DomUtil.getPosition(t._icon),i=t._map.layerPointToLatLng(n);e&&f.DomUtil.setPosition(e,n),t._latlng=i,t.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),f.Control=f.Class.extend({options:{position:"topright"},initialize:function(t){f.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return f.DomUtil.addClass(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},removeFrom:function(t){var e=this.getPosition();return t._controlCorners[e].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),f.control=function(t){return new f.Control(t)},f.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,e){var n=o+t+" "+o+e;i[t+e]=f.DomUtil.create("div",n,r)}var i=this._controlCorners={},o="leaflet-",r=this._controlContainer=f.DomUtil.create("div",o+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),f.Control.Zoom=f.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=f.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,n,i,o,r){var s=f.DomUtil.create("a",n,i);s.innerHTML=t,s.href="#",s.title=e;var a=f.DomEvent.stopPropagation;return f.DomEvent.on(s,"click",a).on(s,"mousedown",a).on(s,"dblclick",a).on(s,"click",f.DomEvent.preventDefault).on(s,"click",o,r).on(s,"click",this._refocusOnMap,r),s},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";f.DomUtil.removeClass(this._zoomInButton,e),f.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&f.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&f.DomUtil.addClass(this._zoomInButton,e)}}),f.Map.mergeOptions({zoomControl:!0}),f.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new f.Control.Zoom,this.addControl(this.zoomControl))}),f.control.zoom=function(t){return new f.Control.Zoom(t)},f.Control.Attribution=f.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){f.setOptions(this,t),this._attributions={}},onAdd:function(t){for(var e in this._container=f.DomUtil.create("div","leaflet-control-attribution"),f.DomEvent.disableClickPropagation(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),f.Map.mergeOptions({attributionControl:!0}),f.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new f.Control.Attribution).addTo(this))}),f.control.attribution=function(t){return new f.Control.Attribution(t)},f.Control.Scale=f.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",n=f.DomUtil.create("div",e),i=this.options;return this._addScales(i,e,n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=f.DomUtil.create("div",e+"-line",n)),t.imperial&&(this._iScale=f.DomUtil.create("div",e+"-line",n))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180)*(t.getNorthEast().lng-t.getSouthWest().lng)/180,i=this._map.getSize(),o=this.options,r=0;0<i.x&&(r=n*(o.maxWidth/i.x)),this._updateScales(o,r)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=e<1e3?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,n,i,o=3.2808399*t,r=this._iScale;5280<o?(e=o/5280,n=this._getRoundNum(e),r.style.width=this._getScaleWidth(n/e)+"px",r.innerHTML=n+" mi"):(i=this._getRoundNum(o),r.style.width=this._getScaleWidth(i/o)+"px",r.innerHTML=i+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=10<=n?10:5<=n?5:3<=n?3:2<=n?2:1)}}),f.control.scale=function(t){return new f.Control.Scale(t)},f.Control.Layers=f.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,n){for(var i in f.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=f.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=f.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),f.Browser.touch?f.DomEvent.on(e,"click",f.DomEvent.stopPropagation):f.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var n=this._form=f.DomUtil.create("form",t+"-list");if(this.options.collapsed){f.Browser.android||f.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var i=this._layersLink=f.DomUtil.create("a",t+"-toggle",e);i.href="#",i.title="Layers",f.Browser.touch?f.DomEvent.on(i,"click",f.DomEvent.stop).on(i,"click",this._expand,this):f.DomEvent.on(i,"focus",this._expand,this),f.DomEvent.on(n,"click",function(){setTimeout(f.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=f.DomUtil.create("div",t+"-base",n),this._separator=f.DomUtil.create("div",t+"-separator",n),this._overlaysList=f.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_addLayer:function(t,e,n){var i=f.stamp(t);this._layers[i]={layer:t,name:e,overlay:n},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,n=!1,i=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),i=i||e.overlay,n=n||!e.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(t){var e=this._layers[f.stamp(t.layer)];if(e){this._handlingClick||this._update();var n=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)}},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(n+=' checked="checked"'),n+="/>";var i=p.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=p.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=p.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers",i),e.layerId=f.stamp(t.layer),f.DomEvent.on(e,"click",this._onInputClick,this);var o=p.createElement("span");return o.innerHTML=" "+t.name,n.appendChild(e),n.appendChild(o),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),n},_onInputClick:function(){var t,e,n,i=this._form.getElementsByTagName("input"),o=i.length;for(this._handlingClick=!0,t=0;t<o;t++)e=i[t],n=this._layers[e.layerId],e.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!e.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){f.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),f.control.layers=function(t,e,n){return new f.Control.Layers(t,e,n)},f.PosAnimation=f.Class.extend({includes:f.Mixin.Events,run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[f.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",f.DomEvent.on(t,f.DomUtil.TRANSITION_END,this._onTransitionEnd,this),f.DomUtil.setPosition(t,e),f.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(f.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(f.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),f.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,e,n,i=this._el,o=s.getComputedStyle(i);if(f.Browser.any3d){if(!(n=o[f.DomUtil.TRANSFORM].match(this._transformRe)))return;t=parseFloat(n[1]),e=parseFloat(n[2])}else t=parseFloat(o.left),e=parseFloat(o.top);return new f.Point(t,e,!0)},_onTransitionEnd:function(){f.DomEvent.off(this._el,f.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[f.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),f.Map.include({setView:function(t,e,n){if((e=e===a?this._zoom:this._limitZoom(e),t=this._limitCenter(f.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&!0!==n)&&(n.animate!==a&&(n.zoom=f.extend({animate:n.animate},n.zoom),n.pan=f.extend({animate:n.animate},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e),this},panBy:function(t,e){if(e=e||{},!(t=f.point(t).round()).x&&!t.y)return this;if(this._panAnim||(this._panAnim=new f.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){f.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){f.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n))&&(this.panBy(n,e),!0)}}),f.PosAnimation=f.DomUtil.TRANSITION?f.PosAnimation:f.PosAnimation.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=f.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=f.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;t<e?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));f.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){f.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),f.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),f.DomUtil.TRANSITION&&f.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&f.DomUtil.TRANSITION&&f.Browser.any3d&&!f.Browser.android23&&!f.Browser.mobileOpera,this._zoomAnimated&&f.DomEvent.on(this._mapPane,f.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),f.Map.include(f.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&0<=t.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i),r=this._getCenterLayerPoint()._add(o);return!(!0!==n.animate&&!this.getSize().contains(o))&&(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,r,i,null,!0),!0)},_animateZoom:function(t,e,n,i,o,r,s){s||(this._animatingZoom=!0),f.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,f.Draggable&&(f.Draggable._disabled=!0),f.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:n,scale:i,delta:o,backwards:r}),setTimeout(f.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,f.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),f.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),f.Draggable&&(f.Draggable._disabled=!1)},this))}}:{}),f.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,n=f.DomUtil.TRANSFORM,i=t.delta?f.DomUtil.getTranslateString(t.delta):e.style[n],o=f.DomUtil.getScaleString(t.scale,t.origin);e.style[n]=t.backwards?o+" "+i:i+" "+o},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),f.Util.falseFn(e.offsetWidth);var n=this._map.getZoom();(n>this.options.maxZoom||n<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[f.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,n=this._getLoadedTilesPercentage(e),i=this._getLoadedTilesPercentage(t);return e&&.5<n&&i<.5?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[f.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,n,i=t.getElementsByTagName("img"),o=0;for(e=0,n=i.length;e<n;e++)i[e].complete&&o++;return o/n},_stopLoadingImages:function(t){var e,n,i,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,n=o.length;e<n;e++)(i=o[e]).complete||(i.onload=f.Util.falseFn,i.onerror=f.Util.falseFn,i.src=f.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),f.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=f.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=f.bind(this._handleGeolocationResponse,this),n=f.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,n=t.coords.longitude,i=new f.LatLng(e,n),o=180*t.coords.accuracy/40075017,r=o/Math.cos(f.LatLng.DEG_TO_RAD*e),s=f.latLngBounds([e-o,n-r],[e+o,n+r]),a=this._locateOptions;if(a.setView){var l=Math.min(this.getBoundsZoom(s),a.maxZoom);this.setView(i,l)}var u={latlng:i,bounds:s,timestamp:t.timestamp};for(var h in t.coords)"number"==typeof t.coords[h]&&(u[h]=t.coords[h]);this.fire("locationfound",u)}})}(window,document)}).call(this,n(21)(t))},85:function(t,e){!function(t,e,n,i){"use strict";var s,o,a=window.Terraformer.WKT,r=n.Basic.Extend,l=n.Basic.getView,u=n.Tools.FuncTools.multi,h={geoObjectDefaults:{},types:{},getGeoObjectParams:function(){return{}},events:{attributionControl:!1,scrollWheelZoom:!1},map:{bounds:{},center:[55.75297,37.62456],zoom:9,minZoom:0,maxZoom:18,scrollWheelZoom:!1,server:"https://c.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:[['<a href="http://leafletjs.com/" target="_blank">Leaflet</a>'," | ",'&copy; <a href="http://openstreetmap.org" target="_blank">OpenStreetMap</a>'].join("")]}};l((s=u(function(t){return null==t?"default":t.icon?"icon":"basic"}).method("default",function(t){return this._opts.geoObjectDefaults}).method("basic",function(t){return r(!0,{},this._opts.geoObjectDefaults,t)}).method("icon",function(n){return r(!0,{},this._opts.geoObjectDefaults,{pointToLayer:function(t,e){return L.marker(e,{icon:L.icon(n.icon)})}})}),o=function(){var t=this._elems.parent.get(0),e=this._opts.events,n=L.map(t,e);return n.setView(this._opts.map.center,this._opts.map.zoom),function(e){return 4===Object.keys(e).filter(function(t){return null!==e[t]&&void 0!==e[t]}).length}(this._opts.map.bounds)&&n.setMaxBounds(function(t){return L.latLngBounds(L.latLng(+t.south,+t.west),L.latLng(+t.north,+t.east))}(this._opts.map.bounds)),n},{_Init:function(t){this._map=o.call(this),[function(t){var e=L.control.attribution({prefix:""});return t.forEach(function(t){e.addAttribution(t)}),e}(this._opts.map.attribution),L.tileLayer(this._opts.map.server,{minZoom:Math.max(0,this._opts.map.minZoom||0),maxZoom:Math.min(18,this._opts.map.maxZoom||18)})].concat(function(t){return t.map(function(t){var e=a.parse(t.geo),n=this._opts.getGeoObjectParams.call(this,t),i=s.call(this,n),o=L.geoJson(e,i),r=t.desc||t.title||t.subtitle;return r&&(o.bindPopup(r),t.active&&setTimeout(function(){o.openPopup()})),o}.bind(this))}.call(this,t.objects||[])).forEach(function(e){return function(t){t.addTo(e)}}(this._map))}}),h,null,"MapLeafletView")}(window.jQuery||window.$,window,window.ru.mail.cpf)},87:function(t,e,n){!function(s,t,a){"use strict";var e=a.Basic;var l=function e(t){var n=this._Opts,i=n.attrs,o=t.filter(function(t,e){return!e.getAttribute(i.activated)});if(o.length){o.attr(i.activated,"1");var r=o.find(this._Opts.cssSels.lazyEmbed);r.length&&(r.each(function(t,e){-1!==n.embedTypesToWatch.indexOf(e.getAttribute(i.type))&&o.eq(t).attr(i.resizable,1)}),p.call(this,r.eq(0).parent()),a.Tools.activateEmbeds(r,{closestParent:".js-slider__item"}).forEach(function(t){t.then(function(){this.update()}.bind(this),function(t){s(t.element).remove(),this.update(!0).then(function(){e.call(this,f.call(this,this.getPageNo()))}.bind(this))}.bind(this))}.bind(this)))}},u=function(){var n=0,t=d.call(this);t.length&&t.each(function(t,e){n=Math.max(n,e.offsetHeight)}),n&&this._Elems.content.height(n)},o=function(t){var n=0;return t.each(function(t,e){n=Math.max(n,e.offsetHeight)}),n},h=function(t){return o.call(this,d.call(this,t))||0},c=function t(e){var n=this._State;if(clearTimeout(n.watchTimeoutId),e&&e.length&&e.parent().length){var i=o(e);n.frameHeight!==i&&(n.frameHeight=i,u.call(this)),n.watchTimeoutId=setTimeout(t.bind(this,e),this._Opts.checkHightTimeout)}},p=function(t,e){e||(e=[1e3,1500,2e3,3e3,5e3,1e4]);var n=h.bind(this),i=n(),o=t.trigger.bind(t,"documentHeightChange"),r=this.update.bind(this);e.forEach(function(t){setTimeout(function(){var t=n();t!==i&&(r(),o(),i=t)},t)})},d=function(t,e){isNaN(t)&&(t=this.getPageNo());var n=this.getPages(),i=s(n[t]&&n[t].frames),o=this._Opts.attrs.resizable;return e&&(i=i.filter(function(t,e){return!!e.getAttribute(o)})),i},f=function(t,e){t=t||0,e=e||2;for(var n=s(),i=d.bind(this),o=t+e,r=Math.max(0,t-e);r<=o;r++)n=n.add(i(r));return n};e.Constructors.addPlugin("Slider",{_Handlers:{beforeSlide:function(t,e){var n=this._Elems;n.shiftedButtons||(n.shiftedButtons=n.controlNext.add(n.controlPrev),this._State.controlHeight=o(n.shiftedButtons)),function(t){var e,n=this._Elems,i=this._State,o=Math.max(h.call(this,t),this._Opts.minItemHeight),r=!1,s=!1,a=(i.frameHeight||0)/2,l=i.controlHeight,u=this._Opts.cssClss.animatedControl;"buttonsTopShift"in i||(a<5&&(a=this._Elems.container.height()/2),n.shiftedButtons=n.controlNext.add(n.controlPrev),n.shiftedButtons.removeClass(u),i.buttonsTopShift=n.shiftedButtons.get(0).offsetTop+l/2,r=s=!0),o&&o-l<a&&(e=Math.max(o,l)/2)<i.buttonsTopShift&&(i.buttonsTopShift=e,r=!0),i.buttonsTopShift<l/2&&(i.buttonsTopShift=l/2),r&&(n.shiftedButtons.css({top:i.buttonsTopShift}),s&&n.shiftedButtons.addClass(u))}.call(this,e),this._State.firstClick||(this._State.firstClick=!0,function(t){t&&((new Image).src="//rs.mail.ru/sb"+t+".gif?r="+Math.round(1e11*Math.random()))}(n.Parent.attr(this._Opts.attrs.clickCounter)))},slide:function(t,e){for(var n=[e],i=s(),o=1;o<=this._Opts.preloadDepth;o++)n.push(e+o),0<=e-o&&n.push(e-o);n.forEach(function(t){i=i.add(d.call(this,t))},this);var r=d.call(this,e,!0);i&&i.length&&l.call(this,i),clearTimeout(this._State.watchTimeoutId),r&&r.length?c.call(this,r):this._State.frameHeight=h.call(this,e),u.call(this),this.update()}},_Init:function(){this._State||(this._State={}),l.call(this,f.call(this)),c.call(this,d.call(this,0)),this._Elems.content.on("documentHeightChange",u.bind(this))}},{cssSels:{lazyEmbed:".js-slider__lazyembed"},cssClss:{animatedControl:"animated"},attrs:{activated:"data-embed-activated",type:"data-type",clickCounter:"data-first-click",resizable:"data-embed-resizable"},embedTypesToWatch:["vk_post"],preloadDepth:1,checkHightTimeout:500,minItemHeight:300},"EmbedList")}(window.jQuery||window.$,window,window.ru.mail.cpf)},880:function(t,e,n){"use strict";n.r(e);n(298),n(64),n(83),n(84),n(85),n(476),n(34),n(35),n(87),n(477),n(76);var i=n(3),o=(n(161),window.ru.mail.cpf),r=window.$;Object(i.setConfig)("SurveyComponent",{options:{template:i.TemplateComponent.getTemplate(o.Tools.getTemplate("ct-survey.xml")),onFinish:function(t,e){o.Tools.initModules(r(e));var n=e.getAttribute("data-finish-pixel-url");"done"==t.currentState&&n&&function(t){(new Image).src=t+"?r="+Math.round(1e11*Math.random())}(n)}}}),Object(i.init)({templatesNS:"fest"});n(295),n(296),n(478),n(92),n(179),n(199),n(479)},9:function(t,e,n){"use strict";var i=this&&this.__assign||Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t};Object.defineProperty(e,"__esModule",{value:!0});var a=n(6),l=n(2),o={},r=[];function u(t){return i({},o[t])}e.resolveConfigSetters=function(){return new Promise(function(t){for(var e=0,n=r;e<n.length;e++)(0,n[e])();t(i({},o))})},e.getConfig=u,e.setConfig=function(t,e){var n=function(){o[t]=i({},e)};return r.push(n),n},e.getConfigCollapsed=function(t){for(var e=t.split(l.COMPONENT_NS_DELIMITER),n=e[0],i={},o=0,r=e.slice(1);o<r.length;o++){var s=r[o];i=a.deepMerge({},i,u(n)),n=""+n+l.COMPONENT_NS_DELIMITER+s}return a.deepMerge({},i,u(n))}},92:function(t,e){var l,u,n,i,o,r,s,a,h,c,p,d,f,m,_,g,y,v,b,w;l=window.$,u=window,n=window.ru.mail.cpf,a=n.Basic,h=a.moduleOpts,c=n.Tools,p=c.initModule,d=c.PubSub,f=c.Images.preloadImage,m=c.Counters.hitCntrsBlck,_=a.typeOf,g=n.Modules.Slider,y=h.setParams,v=u.getNameSpace("Modules",n),b="PhotoStories",w=a.Constructors.getView({_Handlers:{beforeSlide:function(){this._opts.useBanner&&this.reloadBanner();var t=this.getStoryShareUrl();this.setStoryShareUrl(t),this.pushStateUrl(t)},slide:function(t){var e=this._opts;e.usePreviews&&this._previewsSlider.goToFrame(t,!0),e.scrollTo&&!this.isTouch&&this.scrollTop(),e.hitVirtualPhoto&&this.hitVirtualPhoto(),this.preloadLazyPhotos(t)},swipeStart:function(){var t=this._State;i=t.isSwipingForward,o=t.position,s=o-r},swipeEnd:function(){var t=this._State;i!==t.isSwipingForward||(r=t.position);var e=o-r;Number.isNaN(s)||Number.isNaN(e)||s!==e&&this.scrollTop()}},_Init:function(){var t=this;this.isTouch=!!l.zepto,this._initialUpdate.then(function(){setTimeout(function(){t.setStoryShareUrl(t.getStoryShareUrl())},600),t.startLazyLoad(),t._opts.usePreviews&&(t._previewsSlider=null,t.initPreviews())})},initPreviews:function(){var t=this._elems.previewsSlider,e=this.getFrameNo();this._previewsSlider||(this._previewsSlider=p("Slider",t,this._opts.previewsSliderOpts),this._previewsSlider.goToFrame(e,!0))},startLazyLoad:function(){var t=new Array(this._State.$frames.length||0);t.fill(!1),this.photosLoaded=t;var e=this.getFrameNo();this.preloadLazyPhotos(e)},preloadLazyPhotos:function(t){var e=this,n=this._State.$frames.length,i=this._opts.preloadDepth,o=this.photosLoaded,r=[t],s=[];if(0<i)for(var a=i;0<a;a--){var l=t-a,u=t+a;l<0&&(l+=n),n<=u&&(u-=n),r.push(l,u)}return r.forEach(function(t){o[t]||(s.push(e.initLazyPhoto(t)),o[t]=!0)}),Promise.all(s).then(function(t){return t.length?e.update(!0).then(function(){return t}):Promise.resolve(t)})},initLazyPhoto:function(t){var e=this._State.$frames,n=e.length,i=".".concat(this._opts.cssClss.img),o=t;o<0&&(o+=n),n<=o&&(o-=n);var r=e.eq(o).find(i).get(0),s=r.getAttribute("data-src");return f(s).then(function(t){return r.src=s,r.complete?t:function(o){return new Promise(function(n,i){setTimeout(function(){if(o.complete)n();else{var t=function t(){clearTimeout(e),o.removeEventListener("load",t),n()},e=setTimeout(function(){o.removeEventListener("load",t),i(new Error("Timeout expired"))},1e3);o.addEventListener("load",t)}},0)})}(r).then(function(){return t})}).catch(function(t){u.console.error(t)})},initAllLazyPhotos:function(){var e=this,t=this._State.$frames,n=[];return Object.keys(t).forEach(function(t){n.push(e.initLazyPhoto(t))}),Promise.all(n).then(function(t){return t.length?e.update(!0).then(function(){return t}):Promise.resolve(t)})},getStoryShareUrl:function(){return this.getCurrentFrame().attr("data-href")},setStoryShareUrl:function(t){d.publish("setStoryShareUrl",t)},pushStateUrl:function(t){t&&u.history.replaceState({},"",t)},reloadBanner:function(){this._elems.banner.data(this._opts.bannerViewName).reload(!0)},hitVirtualPhoto:function(){var t=this.getStoryShareUrl();t&&m({url:t})},scrollTop:function(){var t=this._opts,e=t.scrollTo,n=t.scrollToDelta,i=u.pageYOffset;if(e){var o=this._elems.parent;"string"===_(e)&&l(e).length&&(o=l(e));var r=o.offset().top,s=i-(r+=n),a=s<1400?Math.round(s/2):1e3;0<s&&(this.isTouch?u.scrollTo(0,r):l("html, body").animate({scrollTop:r},a))}}},{cssSels:{Main:{container:".js-photo-stories__container",viewport:".js-photo-stories__viewport",content:".js-photo-stories__content",frames:".js-photo-stories__items",startFrame:".js-photo-stories__item-start",controlNext:".js-photo-stories__next",controlPrev:".js-photo-stories__prev",controlPage:".js-photo-stories__preview",controlPagesList:".js-photo-stories__previews",previewsSlider:".js-photo-stories__list",banner:".js-photo-stories__banner"},frame:".js-photo-stories__item"},cssClss:{currentPage:"m-photo-stories__preview_active",currentPageFrame:"m-photo-stories__item_active",animatedCont:"m-photo-stories__items_animated",disabledControl:"hidden",img:"js-photo-item"},loop:!0,pageSize:1,align:"center",scrollTo:!0,scrollToDelta:-8,hitVirtualPhoto:!0,useBanner:!0,bannerViewName:"SlotView",usePreviews:!0,preloadDepth:2,previewsSliderOpts:{cssSels:{Main:{container:".js-photo-stories__list-wrap",content:".js-photo-stories__previews"},frame:".js-photo-stories__preview"},cssClss:{animatedCont:"m-photo-stories__items_animated",disabledControl:"hidden"},pageSize:"auto",align:"left"}},g,b),y("".concat(b,".Touch"),{options:{align:"left",scrollToDelta:0,useBanner:!1,usePreviews:!1}}),v[b]=w}})});
//# sourceMappingURL=page-news.js.map