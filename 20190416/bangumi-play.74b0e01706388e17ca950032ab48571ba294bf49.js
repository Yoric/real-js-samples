"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}if(!(window.ActiveXObject||"ActiveXObject"in window)){var __getClientLogo=function(){var t,e=["%c"],i=[];JSON.parse(decodeURI(atob("JTVCJTVCJTIyJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwLy8lMjIsJTIyJTIyJTVELCU1QiUyMiUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU1QyU1QyU1QyU1QyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMC8vJTIyLCUyMiUyMiU1RCwlNUIlMjIlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlNUMlNUMlNUMlNUMlMjAlMjAlMjAlMjAlMjAlMjAlMjAvLyUyMiwlMjIlMjIlNUQsJTVCJTIyJTIwJTIwJTIwJTIwIyNEREREREREREREREREREREREREREREIyMlMjIsJTIyJTIyJTVELCU1QiUyMiUyMCUyMCUyMCUyMCMjJTIwREREREREREREREREREREREREREQlMjAjIyUyMiwlMjIlMjAlMjAlMjBfX19fX19fXyUyMCUyMCUyMF9fXyUyMCUyMCUyMF9fXyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMF9fXyUyMCUyMCUyMF9fX19fX19fJTIwJTIwJTIwX19fJTIwJTIwJTIwX19fJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwX19fJTIyJTVELCU1QiUyMiUyMCUyMCUyMCUyMCMjJTIwaGglMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaCUyMCMjJTIyLCUyMiUyMCUyMCUyMCU3QyU1QyU1QyUyMCUyMCUyMF9fJTIwJTIwJTVDJTVDJTIwJTdDJTVDJTVDJTIwJTIwJTVDJTVDJTIwJTdDJTVDJTVDJTIwJTIwJTVDJTVDJTIwJTIwJTIwJTIwJTIwJTIwJTdDJTVDJTVDJTIwJTIwJTVDJTVDJTIwJTdDJTVDJTVDJTIwJTIwJTIwX18lMjAlMjAlNUMlNUMlMjAlN0MlNUMlNUMlMjAlMjAlNUMlNUMlMjAlN0MlNUMlNUMlMjAlMjAlNUMlNUMlMjAlMjAlMjAlMjAlMjAlMjAlN0MlNUMlNUMlMjAlMjAlNUMlNUMlMjIlNUQsJTVCJTIyJTIwJTIwJTIwJTIwIyMlMjBoaCUyMCUyMCUyMCUyMC8vJTIwJTIwJTIwJTIwJTVDJTVDJTVDJTVDJTIwJTIwJTIwJTIwaGglMjAjIyUyMiwlMjIlMjAlMjAlMjAlNUMlNUMlMjAlNUMlNUMlMjAlMjAlNUMlNUMlN0MlNUMlNUMlMjAvXyU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyUyMCUyMCUyMCUyMCUyMCU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyU3QyU1QyU1QyUyMC9fJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTVDJTVDJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTVDJTVDJTIwJTIwJTIwJTIwJTIwJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTVDJTVDJTIyJTVELCU1QiUyMiUyMCUyMCUyMCUyMCMjJTIwaGglMjAlMjAlMjAvLyUyMCUyMCUyMCUyMCUyMCUyMCU1QyU1QyU1QyU1QyUyMCUyMCUyMGhoJTIwIyMlMjIsJTIyJTIwJTIwJTIwJTIwJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTIwX18lMjAlMjAlNUMlNUMlNUMlNUMlMjAlNUMlNUMlMjAlMjAlNUMlNUMlNUMlNUMlMjAlNUMlNUMlMjAlMjAlNUMlNUMlMjAlMjAlMjAlMjAlMjAlNUMlNUMlMjAlNUMlNUMlMjAlMjAlNUMlNUMlNUMlNUMlMjAlNUMlNUMlMjAlMjAlMjBfXyUyMCUyMCU1QyU1QyU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyUyMCUyMCUyMCUyMCUyMCU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyUyMiU1RCwlNUIlMjIlMjAlMjAlMjAlMjAjIyUyMGhoJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwaGglMjAjIyUyMiwlMjIlMjAlMjAlMjAlMjAlMjAlNUMlNUMlMjAlNUMlNUMlMjAlMjAlNUMlNUMlN0MlNUMlNUMlMjAlMjAlNUMlNUMlNUMlNUMlMjAlNUMlNUMlMjAlMjAlNUMlNUMlNUMlNUMlMjAlNUMlNUMlMjAlMjAlNUMlNUNfX19fJTIwJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTVDJTVDJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTVDJTVDJTdDJTVDJTVDJTIwJTIwJTVDJTVDJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTVDJTVDJTVDJTVDJTIwJTVDJTVDJTIwJTIwJTVDJTVDX19fXyUyMCU1QyU1QyUyMCU1QyU1QyUyMCUyMCU1QyU1QyUyMiU1RCwlNUIlMjIlMjAlMjAlMjAlMjAjIyUyMGhoJTIwJTIwJTIwJTIwJTIwJTIwd3d3dyUyMCUyMCUyMCUyMCUyMCUyMGhoJTIwIyMlMjIsJTIyJTIwJTIwJTIwJTIwJTIwJTIwJTVDJTVDJTIwJTVDJTVDX19fX19fXyU1QyU1QyU1QyU1QyUyMCU1QyU1Q19fJTVDJTVDJTVDJTVDJTIwJTVDJTVDX19fX19fXyU1QyU1QyU1QyU1QyUyMCU1QyU1Q19fJTVDJTVDJTVDJTVDJTIwJTVDJTVDX19fX19fXyU1QyU1QyU1QyU1QyUyMCU1QyU1Q19fJTVDJTVDJTVDJTVDJTIwJTVDJTVDX19fX19fXyU1QyU1QyU1QyU1QyUyMCU1QyU1Q19fJTVDJTVDJTIyJTVELCU1QiUyMiUyMCUyMCUyMCUyMCMjJTIwaGglMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBoaCUyMCMjJTIyLCUyMiUyMCUyMCUyMCUyMCUyMCUyMCUyMCU1QyU1QyU3Q19fX19fX18lN0MlMjAlNUMlNUMlN0NfXyU3QyUyMCU1QyU1QyU3Q19fX19fX18lN0MlMjAlNUMlNUMlN0NfXyU3QyUyMCU1QyU1QyU3Q19fX19fX18lN0MlMjAlNUMlNUMlN0NfXyU3QyUyMCU1QyU1QyU3Q19fX19fX18lN0MlMjAlNUMlNUMlN0NfXyU3QyUyMiU1RCwlNUIlMjIlMjAlMjAlMjAlMjAjIyUyME1NTU1NTU1NTU1NTU1NTU1NTU1NJTIwIyMlMjIsJTIyJTIyJTVELCU1QiUyMiUyMCUyMCUyMCUyMCMjTU1NTU1NTU1NTU1NTU1NTU1NTU1NTSMjJTIyLCUyMiUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMFJlbGVhc2UlMjAxLjAuMC4lMjBQb3dlcmVkJTIwYnklMjBqaW5rZWxhLWNvcmUlMjAyLjQuMS4lMjIlNUQsJTVCJTIyJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTVDJTVDLyUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCU1QyU1Qy8lMjIsJTIyJTIyJTVEJTVE"))).forEach(function(t){var i=t[0],n=t[1];e.push(i+n)}),i=i.concat(["color:#00a1d6"]),i=[e.join("\n")].concat(i),(t=console).log.apply(t,_toConsumableArray(i))};__getClientLogo()}!function(t){function e(e){for(var n,a,r=e[0],c=e[1],l=e[2],d=0,p=[];d<r.length;d++)a=r[d],s[a]&&p.push(s[a][0]),s[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);for(u&&u(e);p.length;)p.shift()();return o.push.apply(o,l||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==s[c]&&(n=!1)}n&&(o.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},s={0:0},o=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="//s1.hdslb.com/bfs/static/bangumi/play/";var r=window.webpackJsonp=window.webpackJsonp||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;o.push([83,1]),i()}([,,function(t,e){t.exports={report:function t(e,i,n){if(window.reportObserver){i=i||{};var s=window.reportConfig&&window.reportConfig.msgObjects?window.reportConfig.msgObjects:"";if(window[s])for(var o in e=e||{})if(e.hasOwnProperty(o)){window[s][o+"_"+e[o]]=i;try{window.reportObserver.forceCommit()}catch(t){}}}else setTimeout(function(){t(e,i)},1e3)},parseUrl:function(t){return 0===t.indexOf("//")?window.location.protocol+t:0===t.indexOf("/")?location.origin+t:0===t.indexOf("http")?t:location.href+t}}},,,,,,function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e,i){},,,,,,,,,,function(t,e,i){t.exports=i(172)},,,,,,,,,,,,,,,,,,,,,,function(t,e,i){var n=i(8);i.n(n).a},function(t,e,i){var n=i(9);i.n(n).a},function(t,e,i){var n=i(10);i.n(n).a},function(t,e,i){var n=i(11);i.n(n).a},function(t,e,i){var n=i(12);i.n(n).a},function(t,e,i){var n=i(13);i.n(n).a},function(t,e,i){var n=i(14);i.n(n).a},function(t,e,i){var n=i(15);i.n(n).a},function(t,e,i){var n=i(16);i.n(n).a},function(t,e,i){var n=i(17);i.n(n).a},function(t,e,i){var n=i(18);i.n(n).a},function(t,e,i){var n=i(19);i.n(n).a},function(t,e,i){var n=i(20);i.n(n).a},function(t,e,i){var n=i(21);i.n(n).a},function(t,e,i){var n=i(22);i.n(n).a},function(t,e,i){var n=i(23);i.n(n).a},function(t,e,i){var n=i(24);i.n(n).a},function(t,e,i){var n=i(25);i.n(n).a},function(t,e,i){var n=i(26);i.n(n).a},function(t,e,i){var n=i(27);i.n(n).a},function(t,e,i){var n=i(28);i.n(n).a},function(t,e,i){var n=i(29);i.n(n).a},function(t,e,i){var n=i(30);i.n(n).a},function(t,e,i){var n=i(31);i.n(n).a},function(t,e,i){var n=i(32);i.n(n).a},function(t,e,i){var n=i(33);i.n(n).a},function(t,e,i){var n=i(34);i.n(n).a},function(t,e,i){var n=i(35);i.n(n).a},function(t,e,i){var n=i(36);i.n(n).a},function(t,e,i){var n=i(37);i.n(n).a},function(t,e,i){var n=i(38);i.n(n).a},function(t,e,i){var n=i(39);i.n(n).a},function(t,e,i){var n=i(40);i.n(n).a},function(t,e,i){var n=i(41);i.n(n).a},function(t,e,i){var n=i(42);i.n(n).a},function(t,e,i){var n=i(43);i.n(n).a},function(t,e,i){var n=i(44);i.n(n).a},function(t,e,i){var n=i(45);i.n(n).a},function(t,e,i){var n=i(46);i.n(n).a},function(t,e,i){var n=i(47);i.n(n).a},function(t,e,i){var n=i(48);i.n(n).a},function(t,e,i){var n=i(49);i.n(n).a},function(t,e,i){var n=i(50);i.n(n).a},function(t,e,i){var n=i(51);i.n(n).a},function(t,e,i){var n=i(52);i.n(n).a},function(t,e,i){var n=i(53);i.n(n).a},function(t,e,i){var n=i(54);i.n(n).a},function(t,e,i){var n=i(55);i.n(n).a},function(t,e,i){var n=i(56);i.n(n).a},function(t,e,i){var n=i(57);i.n(n).a},function(t,e,i){var n=i(58);i.n(n).a},function(t,e,i){var n=i(59);i.n(n).a},function(t,e,i){var n=i(60);i.n(n).a},function(t,e,i){var n=i(61);i.n(n).a},function(t,e,i){var n=i(62);i.n(n).a},function(t,e,i){var n=i(63);i.n(n).a},function(t,e,i){var n=i(64);i.n(n).a},function(t,e,i){var n=i(65);i.n(n).a},function(t,e,i){var n=i(66);i.n(n).a},function(t,e,i){var n=i(67);i.n(n).a},function(t,e,i){var n=i(68);i.n(n).a},function(t,e,i){var n=i(69);i.n(n).a},function(t,e,i){var n=i(70);i.n(n).a},function(t,e,i){var n=i(71);i.n(n).a},function(t,e,i){var n=i(72);i.n(n).a},function(t,e,i){var n=i(73);i.n(n).a},function(t,e,i){i.r(e);var n=i(3);n.a.directive("mouse-movieclip",{bind:function(t,e){var i=e.value,n=0,s=0,o=!1,a=i.target?window.$(t).find("."+i.target):window.$(t),r=i.direction?i.direction:"x",c=i.directionSpc?i.directionSpc:0,l=i.speed?i.speed:80;t.addEventListener("mouseenter",function(){o=!0,s=0,clearInterval(t.timer);var e={};t.timer=setInterval(function(){n=-s*i.step,"x"===r&&(e={"background-position":"".concat(n,"px -").concat(c,"px")}),"y"===r&&(e={"background-position":"-".concat(c,"px ").concat(n,"px")}),window.$(a).css(e),o?++s>i.max-1&&(s=i.point):--s<0&&clearInterval(t.timer)},l)}),t.addEventListener("mouseleave",function(){o=!1})}}),n.a.directive("focus",{inserted:function(t){t.focus()}})},function(t,e,i){i.r(e);var n=i(3),s=i(77),o=i(1);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.a.use(o.a);var r={getSec:function(t){var e=1*t.substring(1,t.length),i=t.substring(0,1);return"s"===i?1e3*e:"h"===i?60*e*60*1e3:"d"===i?24*e*60*60*1e3:"y"===i?365*e*24*60*60*1e3:void 0},set:function(t,e,i){i=void 0===i?"d7":i;var n=this.getSec(i),s=new Date;s.setTime(s.getTime()+1*n),document.cookie=t+"="+escape(e)+";expires="+s.toGMTString()+";path=/;domain=.bilibili.com"},get:function(t){var e=new RegExp("(^| )"+t+"=([^;]*)(;|$)"),i=document.cookie.match(e);return i?unescape(i[2]):null},delete:function(t){var e=new Date;e.setTime(e.getTime()-1);var i=this.get(t);null!=i&&(document.cookie=t+"="+i+";expires="+e.toGMTString())}},c=(i(86),{timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null});function l(t){try{delete window[t]}catch(e){window[t]=void 0}}function u(t){var e=document.getElementById(t);document.getElementsByTagName("head")[0].removeChild(e)}var d=function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t,s=i.timeout||c.timeout,o=i.jsonpCallback||c.jsonpCallback;return new Promise(function(a,r){var c=i.jsonpCallbackFunction||"jsonp_".concat(Date.now(),"_").concat(Math.ceil(1e5*Math.random())),d="".concat(o,"_").concat(c);window[c]=function(t){a({ok:!0,json:function(){return Promise.resolve(t)}}),e&&clearTimeout(e),u(d),l(c)},n+=-1===n.indexOf("?")?"?":"&";var p=document.createElement("script"),h=i.type?"&type=".concat(i.type):"",f=i.nocache?"&_=".concat((new Date).getTime()):"";p.setAttribute("src","".concat(n).concat(o,"=").concat(c).concat(h).concat(f)),p.id=d,document.getElementsByTagName("head")[0].appendChild(p),e=setTimeout(function(){r(new Error("JSONP request to ".concat(t," timed out"))),l(c),u(d)},s)})},p=i(5);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var f=function(){try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}();function m(t){if("undefined"!=typeof window&&(window.location.href.toLowerCase().indexOf("https")>-1&&t&&t.toLowerCase().indexOf("https")<0))return t.replace("http","https");return t}function _(t){return t?t.replace(/^http(s)?:/,""):""}function v(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)return t;var s=t.match(/(.*\.(jpg|jpeg|gif|png))(\?.*)?/),o=-1!==t.indexOf("/bfs/");if(!s||"gif"===s[2]||!o)return _(t);e=Math.ceil(e),i=Math.ceil(i);var a=e&&i?"@"+e+"w_"+i+"h":"@";n&&(a+="_1c");var r=s[3]?s[3]:"";return _(f?s[1]+a+".webp"+r:s[1]+a+"."+s[2]+r)}function y(){var t=1;return"undefined"==typeof window?t:(void 0!==window.screen.systemXDPI&&void 0!==window.screen.logicalXDPI&&window.screen.systemXDPI>window.screen.logicalXDPI?t=window.screen.systemXDPI/window.screen.logicalXDPI:void 0!==window.devicePixelRatio&&(t=window.devicePixelRatio),1===t?2:t)}function g(t,e){if(t){var i=t.getBoundingClientRect(),n=e||0;return i.x+i.y+i.width+i.height!==0&&(i.top<window.innerHeight+n&&i.bottom>=0)}}function w(t){return"{}"===JSON.stringify(t)}function I(t){if(t&&"object"===h(t)){var e=[];for(var i in t)if(t.hasOwnProperty(i)&&void 0!==t[i]){var n="object"===h(t[i])?JSON.stringify(t[i]):t[i];e.push("".concat(i,"=").concat(encodeURIComponent(n)))}return e.join("&")}return""}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t===window?Math.max(window.pageYOffset||0,window.document.documentElement.scrollTop||window.document.body.scrollTop):t.scrollTop}function T(){return window.innerHeight||document.documentElement.clientHeight}function O(t,e){var i=document.createElement("script");i.type="text/javascript",i.src=t,i.onload=e,document.body.appendChild(i)}function C(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return"number"!=typeof t&&(t=Number(t)),void 0===t||isNaN(t)||t<=0?e:Math.abs(t)<=1e4?t:Math.abs(t)<=1e8?Math.round(t/1e3)/10+"万":Math.round(t/1e7)/10+"亿"}function S(t){"function"==typeof window.biliQuickLogin?window.biliQuickLogin(function(){t?t():window.location.reload()}):O("//static.hdslb.com/account/bili_quick_login.js",function(){window.biliQuickLogin(function(){t?t():window.location.reload()})})}function E(t){if("undefined"!=typeof window&&(/MSIE/i.test(window.navigator.userAgent)||/Trident/i.test(window.navigator.userAgent)))try{var e=window.document.createElement("iframe");e.className="bangumi-pay-layout",e.frameBorder="0",t.appendChild(e)}catch(t){}}function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var M={};function P(t){var e=t.status||-1;return new p.Promise(function(i,n){t.json().then(function(t){"object"===N(t)&&(t.httpCode=e),i(t)}).catch(function(t){n(t)})})}M.fetchGet=function(t,e){var i={method:"GET",credentials:"include"};if(e){var n=[];for(var s in e)e.hasOwnProperty(s)&&n.push("".concat(s,"=").concat(e[s]));t+="?".concat(n.join("&"))}return new p.Promise(function(e,n){window.fetch(t,i).then(function(t){return P(t)}).then(function(t){e(t)}).catch(function(t){n(t)})})},M.fetchJson=function(t,e){var i={method:"GET"};if(e){var n=[];for(var s in e)e.hasOwnProperty(s)&&n.push("".concat(s,"=").concat(e[s]));t+="?".concat(n.join("&"))}return new p.Promise(function(e,n){window.fetch(t,i).then(function(t){return P(t)}).then(function(t){e(t)}).catch(function(t){n(t)})})},M.fetchPost=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s={method:"POST",credentials:"include"};return i&&(s.mode="cors"),n?(s.headers={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},s.body=I(e)):(s.headers={"Content-Type":"application/json"},s.body=JSON.stringify(e)),new p.Promise(function(e,i){window.fetch(t,s).then(function(t){return P(t)}).then(function(t){e(t)}).catch(function(t){i(t)})})},M.fetchJsonp=function(t,e,i){return new p.Promise(function(n,s){var o=I(i);o=o?"?".concat(o):"";var a={type:e.type,jsonpCallbackFunction:e.callBack,nocache:e.nocache||!1};d(t+o,a).then(function(t){return P(t)}).then(function(t){n(t)}).catch(function(t){s(t)})})},M.getWithToken=function(t,e){return e=void 0===e?{}:e,new p.Promise(function(i,n){M.fetchGet("//bangumi.bilibili.com/web_api/get_token").then(function(s){0===s.code?(e.token=s.result.token,M.fetchGet(t,e).then(function(t){i(t)},function(t){n(t)})):n(s.message)},function(t){n(t)})})},M.postWithToken=function(t,e){return e=e||{},new p.Promise(function(i,n){M.fetchGet("//bangumi.bilibili.com/web_api/get_token").then(function(s){0===s.code?(e.token=s.result.token,M.fetchPost(t,e,!1,!0).then(function(t){i(t)},function(t){n(t)})):n(s.message)},function(t){n(t)})})},M.postFormData=function(t,e){return new p.Promise(function(i,n){var s={method:"POST",credentials:"include"};s.body=e,window.fetch(t,s).then(function(t){return P(t)}).then(function(t){i(t)}).catch(function(t){n(t)})})};var A=M,k={},D={};function U(t,e){var i,n=window.$.Deferred(),s=(t.type||"")+t.url+JSON.stringify(t.data);return e&&D[s]?n.resolve(D[s]):k[s]?k[s]:(i=function(t){return window.$.ajax(t)}(t),k[s]=i,i.done(function(t){delete k[s],e?0===t.code&&(D[s]=t):delete D[s]}),i.fail(function(){delete k[s]}),i)}var x=function(t){var e=t.getResponseHeader("Date"),i=new Date(e);return i.getTime()+60*(i.getTimezoneOffset()+480)*1e3};function j(t,e){if(void 0===t.requestUrl)return!1;var i=I({version:1,error_code:0,http_code:t.httpCode||e&&e.status||-1,crash_time:e&&x(e)||t.crash||(new Date).getTime(),uid:t.mid||0,error_msg:t.errMsg?encodeURIComponent(t.errMsg):"",request_url:encodeURIComponent(t.requestUrl),user_agent:encodeURIComponent(window.navigator.userAgent)});new Image(1,1).src="//misaka-sw.mincdn.com/misaka.gif?"+i}var L,F={API:"//api.bilibili.com",WWW:"//www.bilibili.com"};function R(t){var e=window.$(t.el),i=t.el?e.offset().left+e.width()/2:window.$(window).width()/2,n=t.el?e.offset().top:window.$(window).height()/2+window.$(window).scrollTop(),s=t.msg||"",o=t.cd||2e3,a=t.type||"success";window.$(".bili-msg").length>0&&window.$(".bili-msg").remove();var r=window.$('<div class="bili-msg"></div>');r.appendTo("body"),r.text(s).css({left:i-r.outerWidth()/2,top:n-(r.outerHeight()+10)}),r.addClass("show"),"error"===a&&r.addClass("error"),r[0].timer=setTimeout(function(){r.fadeOut(600,function(){r.remove()})},o)}function $(){return r.get("bili_jct")||""}function J(t,e,i,n){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o="";if(i=void 0===i?"番剧":i,e&&i)if(s&&t){var a=V(t,i);o="".concat(e,"：").concat(a,"_").concat(i).concat(n?"_bilibili":"","_哔哩哔哩")}else o="".concat(e,"_").concat(i).concat(n?"_bilibili":"","_哔哩哔哩");else o="番剧".concat(n?"_bilibili":"","_哔哩哔哩");if("undefined"!=typeof window){var r=window.document.createElement("div");r.innerHTML=o,o=r.innerText||r.textContent,r=null}return o}function G(t,e,i,n,s){var o=e||"";if(n&&t&&2!==s){var a=V(t,s);o="".concat(e||"","：").concat(a," ").concat(i||"")}if("undefined"!=typeof window){var r=window.document.createElement("div");r.innerHTML=o,o=r.innerText||r.textContent,r=null}return o}function V(t,e){var i=Number(t),n=1===e||4===e||"番剧"===e||"国创"===e?"话":"集";return isNaN(i)?t:"第".concat(i).concat(n)}function H(t,e,i,n){var s=window.location.protocol,o=i?"follow":"unfollow";return A.fetchPost("//bangumi.bilibili.com/follow/web_api/season/".concat(o),{season_id:t,season_type:e,csrf:$()},!1,!0).then(function(e){return 0!==e.code&&j({requestUrl:"".concat(s,"//bangumi.bilibili.com/follow/web_api/season/").concat(o),errMsg:"追番接口失败(type: ".concat(o,", seasonId: ").concat(t),mid:n||void 0},e),Promise.resolve(e)},function(e){return j({requestUrl:"".concat(s,"//bangumi.bilibili.com/follow/web_api/season/").concat(o),errMsg:"追番接口失败(type: ".concat(o,", seasonId: ").concat(t),mid:n||void 0},e),Promise.resolve(e)})}function B(t,e,i,n){return new Promise(function(s,o){!function(t,e){U({url:"".concat(F.API,"/x/relation/modify"),type:"POST",data:{fid:t.fid,act:t.act,re_src:t.re_src,cross_domain:!0,csrf:$()},xhrFields:{withCredentials:!0}}).then(function(t){t&&e(t)})}({fid:i.mid,act:t?1:2===e?2:4,re_src:14},function(e){0===e.code?(t&&function(t){var e=function(){window.followGroupDialog(t.mid,t.uname,{showErrMsgInDialog:!1,onAddTagError:function(t){R({el:".follow-dialog-window .submit",msg:t||"添加分组失败",cd:1e3,type:"error"})},onSubmitError:function(t){R({el:".follow-dialog-window .submit-move",msg:t||"移动分组失败",cd:1e3,type:"error"})},onSubmitSuccess:function(){R({el:".follow-dialog-window",msg:"加入分组成功",cd:1e3})},onEmptyTagSubmit:function(){R({el:".follow-dialog-window",msg:"加入分组成功",cd:1e3})}})};try{void 0===window.followGroupDialog?O("//static.hdslb.com/common/js/followGroupDialog.js",e):e()}catch(t){}}(i),s(t)):R({el:n,msg:e.message,cd:1e3,type:"error"})})})}function q(t,e,i,n){var s=0,o=!1,a=(1===n.vipType||2===n.vipType)&&1===n.vipStatus,r="number"==typeof i?i:-1;return 1===e?s=0:6===t||7===t?s=n.isLogin?a?0:1:2:8===t||9===t?(s=n.isLogin?1:2,o=!0):12===t?s=n.isLogin?1===r?0:1:2:13===t&&(s=n.isLogin?a?0:1:2),{status:s,isPay:6===t||7===t||8===t||9===t||12===t||13===t,isVip:a,vipNeedPay:o,payPack:r}}function W(t,e){return t=Number(t),isNaN(t)&&(t=0),1===e?"已有<span>".concat(C(t-1),"</span>人和你一起承包"):t<=0?"成为第一个承包人吧！":"已有<span>".concat(C(t),"</span>人承包")}function Q(t,e){var i={1:"番剧",2:"电影",3:"纪录片",4:"国创",5:"电视剧",7:"综艺",music:"音乐"};return[26484,26481].indexOf(e)>-1?i.music:i[t]||"番剧"}function X(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Y=(X(L={},"SET_VERSION",function(t,e){var i=e.ver;void 0!==i&&(t.ver=i)}),X(L,"SET_LOGIN_INFO",function(t,e){t.loginInfo=e}),X(L,"SET_MEDIA_INFO",function(t,e){var i=JSON.parse(JSON.stringify(e));delete i.episodes,delete i.seasons,delete i.up_info,delete i.rights,delete i.publish,delete i.newest_ep,delete i.rating,delete i.pay_pack,delete i.payment,delete i.activity,t.mediaInfo=i,t.mediaInfo.bkg_cover&&(t.special=!0),t.ssId=e.season_id||-1,t.mdId=e.media_id,t.epList=e.episodes||[],t.seasonList=e.seasons||[],t.upInfo=e.up_info||{},t.rightsInfo=e.rights||{},t.app=1===t.rightsInfo.watch_platform,t.pubInfo=e.publish||{},t.newestEp=e.newest_ep||{},t.mediaRating=e.rating||{},t.payPack=e.pay_pack||{},t.payMent=e.payment||{},t.activity=e.activity||{}}),X(L,"SET_USER_STAT",function(t,e){var i=e.watch_progress?e.watch_progress.last_ep_id:-1,n=e.watch_progress?e.watch_progress.last_ep_index:"",s=e.watch_progress?e.watch_progress.last_time:0,o=e.vipInfo||{};t.userStat={loaded:!0,error:void 0===e.pay,follow:e.follow||0,pay:e.pay||0,payPackPaid:e.pay_pack_paid||0,sponsor:e.sponsor||0,watchProgress:{lastEpId:0===i?-1:i,lastEpIndex:n,lastTime:s},vipInfo:{due_date:o.due_date||0,status:o.status||0,type:o.type||0}},e.paster&&(t.paster=e.paster||{}),t.area=1===e.area_limit?e.ban_area_show:0,3===t.area&&(window.location.href="/404"),t.seasonFollowed=1===e.follow}),X(L,"SET_FOLLOW_STAT",function(t,e){t.seasonFollowed=e}),X(L,"SET_EP_INFO",function(t,e){var i=!1;t.epList.forEach(function(n){n.ep_id===e&&(i=!0,t.epInfo=n)}),i?(t.epStat=q(t.epInfo.episode_status||t.mediaInfo.season_status,t.userStat.pay,t.userStat.payPackPaid,t.loginInfo),t.ssStat=q(t.mediaInfo.season_status,t.userStat.pay,t.userStat.payPackPaid,t.loginInfo),t.epId=e):t.epList[0]&&(t.epInfo=t.epList[0],t.epStat=q(t.epInfo.episode_status||t.mediaInfo.season_status,t.userStat.pay,t.userStat.payPackPaid,t.loginInfo),t.ssStat=q(t.mediaInfo.season_status,t.userStat.pay,t.userStat.payPackPaid,t.loginInfo),t.epId=t.epList[0].ep_id)}),X(L,"SET_PAY_STATS",function(t){t.epStat=q(t.epInfo.episode_status||t.mediaInfo.season_status,t.userStat.pay,t.userStat.payPackPaid,t.loginInfo),t.ssStat=q(t.mediaInfo.season_status,t.userStat.pay,t.userStat.payPackPaid,t.loginInfo)}),X(L,"SET_RECOM_LIST",function(t,e){t.recomList=e.length>8?e.slice(0,8):e}),X(L,"SET_PLAYER_RECOMMEND",function(t,e){var i=[];e.forEach(function(t){i.push({cover:t.cover,title:t.title,link:"//www.bilibili.com/bangumi/play/ss".concat(t.season_id,"/")})}),t.playerRecomList=i}),X(L,"SET_COIN_SPEND",function(t,e){t.spending=e}),X(L,"SET_SPONSOR_TOTAL",function(t,e){t.sponsorTotal.code=e.code,t.sponsorTotal.result=e.result||{ep_bp:0,users:0,mine:{},list:[]},t.sponsorTotalCount=e.result?e.result.users:0}),X(L,"SET_SPONSOR_WEEK",function(t,e){t.sponsorWeek.code=e.code,t.sponsorWeek.result=e.result||{ep_bp:0,users:0,mine:{},list:[]}}),X(L,"SET_MINI_ON",function(t,e){t.miniOn=e,"undefined"!=typeof window&&(window.localStorage.b_miniplayer=e?"1":"0")}),X(L,"SET_SPONSOR_STAT",function(t,e){t.userStat.sponsor=e?1:0}),X(L,"SET_PLAYER_TRIGGER_STAT",function(t,e){t.isPlayerTrigger=e}),X(L,"SET_USER_REVIEW",function(t,e){t.userScore=e.score||-1,t.userShortReview=e.short_review||{},t.userLongReview=e.long_review||{},t.canReview=1===e.is_open}),X(L,"SET_USER_OPEN",function(t,e){t.canReview=e}),X(L,"SET_SHORT_REVIEW",function(t,e){t.userShortReview.review_id=e.review_id||void 0,t.userShortReview.content=e.content||"",void 0!==e.score&&(t.userScore=e.score)}),X(L,"SET_USER_COINED",function(t,e){t.userCoined=0===e.is_coin?1:0}),X(L,"SET_VIDEO_STAT",function(t,e){t.seasonStat={views:e.views||0,danmakus:e.danmakus||0,favorites:e.favorites||0,coins:e.coins||0}}),L),z=i(76),K=i.n(z),Z="//api.bilibili.com/open/monitor/report",tt=[],et=null,it=function(t,e){try{e.level=t||"info",e.logtype=1,e.url=e.url?e.url.replace(/\?.*/,""):"empty",e.traceid_end=Date.now().toString()+Math.round(1e12*Math.random()),tt.push(e);var i=function(){et=setTimeout(function(){!function(){try{var t=new Image;t.src="".concat(Z,"?source=").concat("bangumi","&log=").concat(encodeURIComponent(JSON.stringify(tt))),tt=[]}catch(t){}}(),clearTimeout(et),et=null},2e3)};null===et?i():(clearTimeout(et),i())}catch(t){}},nt=function(t){try{return t&&t.headers&&t.headers["trace-id"]?t.headers["trace-id"]:"empty"}catch(t){return"null"}};function st(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=n&&(n.indexOf("api.bilibili.com/pgc/")>-1||n.indexOf("bangumi.bilibili.com")>-1);if("undefined"==typeof window||s||window.noClientTrace||!o)return!1;if(e){var a=e.message&&e.message.indexOf("timeout of")>-1?504:500,r=e.stack?"string"==typeof e.stack?e.stack:JSON.stringify(e.stack):e.message;r.length>200&&(r=r.substr(0,200)),it(504===a?"warning":"error",{status:a,url:n,cost:(new Date).getTime()-i,message:r||"empty"})}else if(t.data&&(t.data.code>=-500||void 0===t.data.code)){var c=nt(t),l=t.data&&(void 0===t.data.code||0===t.data.code||-101===t.data.code||-404===t.data.code),u={status:t.status,http_business_code:t.data&&void 0!==t.data.code?t.data.code:-1,url:n,cost:(new Date).getTime()-i,traceid_svr:c};l||(u.message=t.data&&t.data.message?t.data.message:"empty"),it(l?"info":"warning",u)}}var ot,at=function(t){var e={url:function(t){var e="undefined"==typeof window,i=e?"http:":window.location.protocol||"https:";return t.indexOf(".bilibili.co")>-1?(t.indexOf("-mng.bilibili.co")>-1||t.indexOf("manager.bilibili.co"),0===t.indexOf("//")?"".concat(i).concat(t):"".concat(i,"//").concat(t)):"".concat(i,"//api.bilibili.com/").concat(t)}(t.url),timeout:t.timeout||1e4},i=e.url.indexOf("-mng.bilibili.co")>-1||e.url.indexOf("manager.bilibili.co")>-1;if(void 0===t.method&&(t.method="GET"),t.method&&"GET"===t.method.toUpperCase()&&!1!==t.include?e.withCredentials=!0:!0===t.include&&(e.withCredentials=!0),t.params&&(e.params=t.params),t.cookies&&(e.withCredentials=!0,e.headers={Cookie:t.cookies}),t.method&&"GET"===t.method.toUpperCase()){var n=(new Date).getTime();return K.a.get(e.url,e).then(function(i){return st(i,null,n,e.url,t.noTrace),i}).catch(function(s){return st(null,s,n,e.url,t.noTrace),i&&"undefined"!=typeof window&&"Network Error"===s.message&&!window.errorRedirect&&(window.location.href="//".concat("","bangumi-mng.bilibili.co/html/403.html")),{status:404,msg:s.stack}})}t.method&&(e.method=t.method),e.method&&e.method.toUpperCase().indexOf("POST")>-1&&(e.headers||(e.headers={}),"MNG-POST"===e.method.toUpperCase()?(e.headers["content-type"]="application/json;charset=UTF-8",e.method="POST",e.data=e.params):(e.headers["content-type"]="application/x-www-form-urlencoded",e.data=e.params instanceof window.FormData?e.params:I(e.params||{})),delete e.params);var s=(new Date).getTime();return K()(e).then(function(i){return st(i,null,s,e.url,t.noTrace),i}).catch(function(n){return st(null,n,s,e.url,t.noTrace),i&&"undefined"!=typeof window&&"Network Error"===n.message&&!window.errorRedirect&&(window.location.href="//".concat("","bangumi-mng.bilibili.co/html/403.html")),{status:404,msg:n.stack}})};function rt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var ct=(rt(ot={},"VERSION_LOAD",function(t,e){(0,t.commit)("SET_VERSION",e)}),rt(ot,"FETCH_LOGIN",function(t){var e=t.commit;return at({url:"x/web-interface/nav",params:{ts:(new Date).getTime()}}).then(function(t){var i={};200===t.status&&t.data&&(i=t.data.data||{}),e("SET_LOGIN_INFO",i)})}),rt(ot,"FETCH_MEDIA_INFO",function(t,e){var i=t.commit,n={};return"ep"===e.viewType?n.ep_id=e.id:"ss"===e.viewType?n.season_id=e.id:n.media_id=e.id,at({url:"bangumi.bilibili.com/view/web_api/season",params:n,cookies:e.cookies,timeout:3e3}).then(function(t){if(200!==t.status||0!==t.data.code)throw 200===t.status&&-404===t.data.code?new Error(-404):new Error(t.msg);if(e.epOnly){var n=t.data.result||{};return Promise.resolve(n.episodes||[])}i("SET_MEDIA_INFO",t.data.result||{})})}),rt(ot,"FETCH_USER_STAT",function(t,e){var i=t.commit;return e.ssId>0?at({url:"bangumi.bilibili.com/view/web_api/season/user/status",params:{season_id:e.ssId,season_type:e.ssType||1,ts:(new Date).getTime()}}).then(function(t){200===t.status&&0===t.data.code?i("SET_USER_STAT",t.data.result||{}):i("SET_USER_STAT",{})}):(i("SET_USER_STAT",{}),Promise.resolve())}),rt(ot,"FOLLOW_STAT_CHANGE",function(t,e){(0,t.commit)("SET_FOLLOW_STAT",e.stat)}),rt(ot,"EP_INFO_CHANGE",function(t,e){(0,t.commit)("SET_EP_INFO",e.epId)}),rt(ot,"LOAD_PAY_STATS",function(t){(0,t.commit)("SET_PAY_STATS")}),rt(ot,"FETCH_RECOMMEND",function(t,e){var i=t.commit;if(e.aid>0)return at({url:"x/web-interface/archive/related",params:{aid:e.aid}}).then(function(t){200===t.status&&t.data&&0===t.data.code&&i("SET_RECOM_LIST",t.data.data||[])})}),rt(ot,"FETCH_PLAYER_RECOMMEND",function(t,e){var i=t.commit;if(e.ssId>0)return at({url:"pgc/web/recommend/related/recommend",params:{season_id:e.ssId}}).then(function(t){if(200===t.status&&0===t.data.code){var e=t.data.result||[];i("SET_PLAYER_RECOMMEND",e)}else i("SET_PLAYER_RECOMMEND",[])})}),rt(ot,"FETCH_COIN_SPEND",function(t,e){(0,t.commit)("SET_COIN_SPEND",e.spending)}),rt(ot,"FETCH_SPONSOR_TOTAL",function(t,e){var i=t.commit;if(e.ssId>0)return at({url:"bangumi.bilibili.com/sponsor/web_api/v2/rank/total",params:{season_type:e.ssType,season_id:e.ssId,page:1,pagesize:e.pageSize}}).then(function(t){200===t.status&&t.data?i("SET_SPONSOR_TOTAL",t.data):i("SET_SPONSOR_TOTAL",{code:-500})}).catch(function(){i("SET_SPONSOR_TOTAL",{code:-500})});i("SET_SPONSOR_TOTAL",{code:-500})}),rt(ot,"FETCH_SPONSOR_WEEK",function(t,e){var i=t.commit;if(e.ssId>0)return at({url:"bangumi.bilibili.com/sponsor/web_api/v2/rank/week",params:{season_type:e.ssType,season_id:e.ssId,page:1,pagesize:e.pageSize}}).then(function(t){200===t.status&&t.data?i("SET_SPONSOR_WEEK",t.data):i("SET_SPONSOR_WEEK",{code:-500})}).catch(function(){i("SET_SPONSOR_WEEK",{code:-500})});i("SET_SPONSOR_WEEK",{code:-500})}),rt(ot,"CHANGE_MINI_ON",function(t,e){(0,t.commit)("SET_MINI_ON",e.isOn)}),rt(ot,"SPONSOR_STAT_CHANGE",function(t,e){(0,t.commit)("SET_SPONSOR_STAT",e.stat)}),rt(ot,"CHANGE_PLAYER_TRIGGER_STAT",function(t,e){(0,t.commit)("SET_PLAYER_TRIGGER_STAT",e.stat)}),rt(ot,"FETCH_USER_REVIEW",function(t,e){var i=t.commit;return e.mediaId>0?at({url:"bangumi.bilibili.com/review/web_api/media/user/review",params:{media_id:e.mediaId,ts:(new Date).getTime()}}).then(function(t){200===t.status&&0===t.data.code?i("SET_USER_REVIEW",t.data.result||{}):i("SET_USER_REVIEW",{})}):(i("SET_USER_REVIEW",{}),Promise.resolve())}),rt(ot,"SHORT_REVIEW_CHANGE",function(t,e){(0,t.commit)("SET_SHORT_REVIEW",e.result||{})}),rt(ot,"USER_OPEN_CHANGE",function(t,e){(0,t.commit)("SET_USER_OPEN",e.isOpen||!1)}),rt(ot,"FETCH_USER_COINED",function(t,e){var i=t.commit;return e.mediaId>0?at({url:"bangumi.bilibili.com/review/web_api/media/user/status",params:{media_id:e.mediaId,ts:(new Date).getTime()}}).then(function(t){i("SET_USER_COINED",t.data&&t.data.result?t.data.result:{})}):Promise.resolve()}),rt(ot,"FETCH_REVIEW_DATA",function(t,e){t.commit;return e.mediaId>0?at({url:"bangumi.bilibili.com/review/web_api/media/play",params:{media_id:e.mediaId}}).then(function(t){var e={longList:[],shortList:[],feedList:[]};if(200===t.status&&t.data&&0===t.data.code){var i=t.data.result||{};e.shortList=i.short_review&&i.short_review.list?i.short_review.list:[],e.longList=i.long_review&&i.long_review.list?i.long_review.list:[],e.feedList=i.feed||[]}return Promise.resolve(e)}):Promise.resolve({longList:[],shortList:[],feedList:[]})}),rt(ot,"FETCH_VIDEO_STAT",function(t,e){var i=t.commit;if(e.ssId>0)return at({url:"bangumi.bilibili.com/ext/web_api/season_count",params:{season_id:e.ssId,season_type:e.ssType,ts:(new Date).getTime()}}).then(function(t){200===t.status&&t.data&&0===t.data.code&&i("SET_VIDEO_STAT",t.data.result||{})})}),ot),lt={ver:{},loginInfo:{isLogin:null},canReview:!1,userShortReview:{},userLongReview:{},userScore:0,userCoined:!1,isPlayerTrigger:!1,special:!1,area:0,app:!1,epId:-1,ssId:-1,mdId:-1,mediaInfo:{},mediaRating:{},epInfo:{},epList:[],newestEp:{},seasonList:[],seasonStat:{views:0,danmakus:0,coins:0,favorites:0},userStat:{loaded:!1,error:!1,follow:0,pay:0,payPackPaid:0,sponsor:0,watchProgress:{lastEpId:-1,lastEpIndex:"",lastTime:0},vipInfo:{due_date:0,status:0,type:0}},upInfo:{},rightsInfo:{},pubInfo:{},recomList:[],playerRecomList:[],paster:{},payPack:{},payMent:{},activity:{},spending:0,sponsorTotal:{code:0,result:{ep_bp:0,users:0,mine:{},list:[]}},sponsorWeek:{code:0,result:{ep_bp:0,users:0,mine:{},list:[]}},sponsorTotalCount:0,miniOn:!0,seasonFollowed:!1,epStat:{},ssStat:{}},ut={state:lt,getters:function(t){var e={};if("object"!==a(t)||t instanceof Array)return{};var i=function(i){if(t.hasOwnProperty(i)){var n=i.replace(/([A-Z])/g,"_$1").toUpperCase();e[n]=function(t){return t[i]}}};for(var n in t)i(n);return e}(lt),actions:ct,mutations:Y},dt=i(2),pt=new n.a;function ht(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var ft={data:function(){return{timer:null}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){ht(t,e,i[e])})}return t}({},Object(o.b)(["APP","EP_ID","SS_ID","MD_ID","USER_STAT","EP_LIST","LOGIN_INFO","MEDIA_INFO","EP_INFO","UP_INFO","SEASON_FOLLOWED","PLAYER_RECOM_LIST","SPONSOR_TOTAL_COUNT","SPONSOR_TOTAL","SPONSOR_WEEK","PASTER","PUB_INFO","RIGHTS_INFO","EP_STAT","SS_STAT"]),{playerEpNeedPay:function(){return 1===this.PUB_INFO.is_started?1===this.EP_STAT.status||2===this.EP_STAT.status&&this.EP_STAT.isPay:1===this.SS_STAT.status||2===this.SS_STAT.status&&this.SS_STAT.isPay},canPlay1080P:function(){return!!this.LOGIN_INFO.isLogin&&(1===this.USER_STAT.pay||1===this.USER_STAT.sponsor||1===this.USER_STAT.payPackPaid||0!==this.LOGIN_INFO.vipType&&1===this.LOGIN_INFO.vipStatus)}}),watch:{EP_INFO:function(){this.biliVipThaw()}},created:function(){var t=this;pt.$on("SHOW_SPONSOR_RANK",function(){Object(dt.report)({click:"bp_ranking"},{season_id:t.SS_ID,ep_id:t.EP_ID,businesstype:t.MEDIA_INFO.season_type,title:t.MEDIA_INFO.title})}),pt.$on("RANK_TAB_CHANGE",function(){Object(dt.report)({click:"bp_switch"},{season_id:t.SS_ID,ep_id:t.EP_ID,businesstype:t.MEDIA_INFO.season_type,title:t.MEDIA_INFO.title})})},mounted:function(){var t=this;!function(){for(var t=0,e=["webkit","moz"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,i){var n=(new Date).getTime(),s=Math.max(0,16.7-(n-t)),o=window.setTimeout(function(){e(n+s)},s);return t=n+s,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),window.showRealNameBind=function(t,e){pt.$emit("REAL_NAME_SHOW",t,e)};var e=function(){if(-1===t.EP_ID&&t.EP_LIST.length>0){var e=window.location.href.match(/#([0-9]+)/),i=e?isNaN(Number(e[1]))?-1:Number(e[1]):-1,n=i>-1?i:t.USER_STAT.watchProgress.lastEpId>-1?t.USER_STAT.watchProgress.lastEpId:t.EP_INFO.ep_id||-1;t.$store.dispatch({type:"EP_INFO_CHANGE",epId:n})}else t.$store.dispatch({type:"LOAD_PAY_STATS"});t.biliVipThaw()},i=[this.$store.dispatch({type:"FETCH_LOGIN"}),this.$store.dispatch({type:"FETCH_USER_STAT",ssId:this.SS_ID,ssType:this.MEDIA_INFO.season_type||1})];Promise.all(i).then(function(){if(!t.APP&&t.LOGIN_INFO.isLogin){var i=[t.$store.dispatch({type:"FETCH_USER_REVIEW",mediaId:t.MD_ID}),t.$store.dispatch({type:"FETCH_USER_COINED",mediaId:t.MD_ID})];Promise.all(i).then(e)}else e()}),this.bindCallbacks()},methods:{bindCallbacks:function(){var t=this;window.commentAgent={seek:function(e,i){var n=i&&i>0?t.EP_LIST.filter(function(t){return t.index===i.toString()}):[],s=n[0]?n[0].ep_id:"";s&&s!==t.EP_ID?(window.oldPgcCommentJump=e,t.$router.push({name:"webplay",params:{id:"ep".concat(s)}})):(window.oldPgcCommentJump=e,t.$root.$emit("RELOAD_PLAYER"))}},window.bangumiCallNext=function(e){window.playerTriggerChange=!0,e!==t.EP_ID&&(t.$store.dispatch({type:"CHANGE_PLAYER_TRIGGER_STAT",stat:!0}),t.$router.push({name:"webplay",params:{id:"ep".concat(e)}}))},window.attentionTrigger=function(e){B(e,1,t.UP_INFO,window.document.querySelector("body")).then(function(t){})},window.show1080p=function(e){if(t.LOGIN_INFO.isLogin){if(t.biliVipThaw())return;window.player1080pCallback=e,pt.$emit("SHOW_1080P",!0)}else S()},window.showPay=function(){t.LOGIN_INFO.isLogin?pt.$emit("TRIGGER_PAY_PROCESS",!0):S()},window.showVipPay=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"big";if(t.LOGIN_INFO.isLogin){Object(dt.report)({click:i},{season_id:t.SS_ID,ep_id:t.EP_ID,businesstype:t.MEDIA_INFO.season_type,title:t.MEDIA_INFO.title});var n=function(){new window.BiliBiliVipDialog({type:1,appId:e,appSubId:"".concat(t.MEDIA_INFO.season_type,"-").concat(t.SS_ID,"-").concat(t.EP_ID)},function(){window.location.reload(!0)})};window.BiliBiliVipDialog?n():O("//s1.hdslb.com/bfs/static/plugin/vip/BiliBiliVipDialog.js",n)}else S()},window.playerCallback=function(){if(t.EP_STAT.isPay&&0!==t.EP_STAT.status&&1===t.RIGHTS_INFO.is_preview){var e=window.document.querySelector("#player_placeholder");t.timer=setInterval(function(){"function"==typeof e.jwAddEventListener&&(e.jwAddEventListener("jwplayerMediaComplete","function(){ window.playerEndCallback();}"),clearInterval(t.timer),t.timer=null)},1e3)}},window.playerEndCallback=function(){pt.$emit("SIX_MIN_MASK_SHOW")},window.GNS={playerCallSendCoin:function(){pt.$emit("COIN_DIALOG",!0)}},window.playerCallSendCoin=window.GNS.playerCallSendCoin,window.getPlayerExtraParams=function(){var e=0!==t.EP_INFO.section_type?"":t.MEDIA_INFO.paster_text?encodeURIComponent(t.MEDIA_INFO.paster_text):"";return{mediaTitle:t.MEDIA_INFO.title,epTitle:t.EP_INFO.index_title,epIndex:function(t){var e=Number(t);return isNaN(e)?t:"第".concat(e,"话")}(t.EP_INFO.index),epCover:t.EP_INFO.cover,epStat:t.EP_INFO.episode_status||t.MEDIA_INFO.season_status,squarePic:t.MEDIA_INFO.square_cover?_(t.MEDIA_INFO.square_cover):"//static.hdslb.com/images/square-cover-default.png",record:e,shareText:"".concat(G(t.EP_INFO.index,t.MEDIA_INFO.title,t.EP_INFO.index_title,2===t.MEDIA_INFO.mode,t.MEDIA_INFO.season_type)," #哔哩哔哩#"),sharePic:_(t.MEDIA_INFO.cover),shareUrl:"//www.bilibili.com/bangumi/play/ss".concat(t.SS_ID,"/"),isStart:1===t.PUB_INFO.is_started,isPreview:1===t.RIGHTS_INFO.is_preview&&t.playerEpNeedPay,canPlay1080:t.canPlay1080P,allowSponsor:1===t.RIGHTS_INFO.allow_bp,multiMode:2===t.MEDIA_INFO.mode,epNeedPay:t.playerEpNeedPay,isFollow:t.SEASON_FOLLOWED,sponsorWeekList:t.SPONSOR_WEEK.result,sponsorTotalList:t.SPONSOR_TOTAL.result,sponsorCount:t.SPONSOR_TOTAL_COUNT,paster:{aid:t.EP_INFO.aid||0,cid:t.PASTER.aid||0,type:t.PASTER.type||0,duration:t.PASTER.duration||0,allow_jump:t.PASTER.allow_jump||0,url:t.PASTER.url||""},pubTime:t.PUB_INFO.pub_time_show,recommend:t.PLAYER_RECOM_LIST}},window.callBangumiFollow=function(e,i){t.LOGIN_INFO.isLogin?H(t.SS_ID,t.MEDIA_INFO.season_type,e,t.LOGIN_INFO.mid).then(function(e){0===e.code&&(t.$store.dispatch({type:"FOLLOW_STAT_CHANGE",stat:!t.SEASON_FOLLOWED}),pt.$emit("TRIGGER_FOLLOW_ANIME"),i&&i())}):S()},window.objBPPlugin={open:function(){t.LOGIN_INFO.isLogin?t.$root.$emit("trigger-sponsor-pay",!0):S()}},window.bangumiPlayerLogin=function(){window.location.reload(!0)}},biliVipThaw:function(){var t=this;if(!this.USER_STAT.loaded){var e=setTimeout(function(){t.biliVipThaw(),clearTimeout(e)},100);return!1}return 2===this.USER_STAT.vipInfo.status&&(this.EP_INFO&&(6===this.EP_INFO.episode_status||7===this.EP_INFO.episode_status||13===this.EP_INFO.episode_status)&&window.BilAccountThaw?(window.demo=new window.BilAccountThaw({appId:4,url:window.location.href}),!0):void 0)}}},mt=(i(105),i(0)),_t=Object(mt.a)(ft,function(){var t=this.$createElement;return(this._self._c||t)("router-view")},[],!1,null,null,null).exports,vt={props:{src:{},width:{},height:{},alt:{},webp:{default:!0},hd:{default:!0}},computed:{ratio:function(){return this.hd?y():2},source:function(){return this.webp?v(this.src,Math.ceil(this.width*this.ratio),Math.ceil(this.height*this.ratio)):_(this.src)}}},yt=(i(106),Object(mt.a)(vt,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"common-lazy-img"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:this.source,expression:"source"}],attrs:{alt:this.alt||"",src:""}})])},[],!1,null,null,null).exports);function gt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var wt={data:function(){return{extraUpInfo:{},followHover:!1,following:{is:!1,type:0}}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){gt(t,e,i[e])})}return t}({},Object(o.b)(["LOGIN_INFO","UP_INFO","SS_ID","EP_ID","MEDIA_INFO"]),{pendantImage:function(){return this.UP_INFO&&this.UP_INFO.pendant&&this.UP_INFO.pendant.image},verify:function(){return this.extraUpInfo.card&&this.extraUpInfo.card.official_verify?this.extraUpInfo.card.official_verify.type:-1},followText:function(){return this.following.is?this.followHover?"取消关注":"已关注":"+ 关注"},archiveCount:function(){return this.extraUpInfo.archive_count?"投稿：".concat(C(this.extraUpInfo.archive_count)):"投稿：-"},fans:function(){return this.extraUpInfo.follower?"粉丝：".concat(C(this.extraUpInfo.follower)):"粉丝：-"},sign:function(){return this.extraUpInfo.card&&this.extraUpInfo.card.sign?this.extraUpInfo.card.sign:""}}),watch:{LOGIN_INFO:function(){this.getRelation()},"UP_INFO.mid":{handler:function(t,e){t!==e&&this.getUserInfo()},deep:!0}},mounted:function(){this.getUserInfo(),this.LOGIN_INFO.isLogin&&this.getRelation()},methods:{getRelation:function(){var t=this;this.LOGIN_INFO.isLogin&&at({url:"x/relation",params:{fid:this.UP_INFO.mid}}).then(function(e){if(200===e.status&&e.data&&0===e.data.code){var i=e.data.data||{};1===i.attribute||2===i.attribute||6===i.attribute?t.following={is:!0,type:i.attribute}:t.$set(t.following,"is",!1)}})},getUserInfo:function(){var t=this;at({url:"x/web-interface/card",params:{mid:this.UP_INFO.mid,photo:1}}).then(function(e){200===e.status&&e.data&&0===e.data.code&&e.data.data&&(t.extraUpInfo=e.data.data)})},follow:function(t){var e=this;this.reportUpFlow(),this.LOGIN_INFO.isLogin?B(!this.following.is,this.following.type,this.UP_INFO,t.target).then(function(t){e.$set(e.following,"is",!e.following.is),e.following.is&&e.$set(e.following,"type",2)}):S()},reportUpFlow:function(){Object(dt.report)({click:this.following.is?"up_unfollow":"up_follow"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})},reportSpace:function(){Object(dt.report)({click:"up"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})}},components:{BiliImg:yt}},It=(i(107),Object(mt.a)(wt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bangumi-up-info clearfix"},[i("div",{staticClass:"u-face"},[i("a",{staticClass:"face-wrapper",attrs:{href:"//space.bilibili.com/"+t.UP_INFO.mid,target:"_blank"},on:{click:t.reportSpace}},[i("bili-img",{attrs:{src:t.UP_INFO.avatar,width:68,height:68}}),t._v(" "),t.pendantImage?i("bili-img",{staticClass:"pendant",attrs:{src:t.UP_INFO.pendant.image,width:112,height:112}}):t._e(),t._v(" "),0===t.verify?i("i",{staticClass:"auth p-auth",attrs:{title:"个人认证"}}):t._e(),t._v(" "),1===t.verify?i("i",{staticClass:"auth o-auth",attrs:{title:"企业/团体认证"}}):t._e()],1)]),t._v(" "),i("div",{staticClass:"info"},[i("div",{staticClass:"user clearfix"},[i("a",{staticClass:"name",attrs:{href:"//space.bilibili.com/"+t.UP_INFO.mid,target:"_blank"},on:{click:t.reportSpace}},[t._v(t._s(t.UP_INFO.uname))]),t._v(" "),i("a",{staticClass:"message",attrs:{href:"//message.bilibili.com/#whisper/mid"+t.UP_INFO.mid,target:"_blank"}},[t._v("发消息")])]),t._v(" "),i("div",{staticClass:"sign"},[t._v(t._s(t.sign))]),t._v(" "),i("div",{staticClass:"number"},[i("span",[t._v(t._s(t.archiveCount))]),t._v(" "),i("span",[t._v(t._s(t.fans))])]),t._v(" "),i("div",{class:["func-btns",{followed:t.following.is}]},[i("a",{staticClass:"func-btn b-gz",on:{click:function(e){return t.follow(e)},mouseenter:function(){return t.followHover=!0},mouseleave:function(){return t.followHover=!1}}},[t._v(t._s(t.followText))])])])])},[],!1,null,null,null).exports);function bt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Tt={computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){bt(t,e,i[e])})}return t}({},Object(o.b)(["SS_ID","EP_ID","LOGIN_INFO","PAY_PACK","PAY_MENT","MEDIA_INFO","PUB_INFO","USER_STAT","SS_STAT"]),{vipStyle:function(){return(6===this.MEDIA_INFO.season_status||7===this.MEDIA_INFO.season_status||13===this.MEDIA_INFO.season_status)&&this.SS_STAT.isVip},btnHref:function(){return 12===this.MEDIA_INFO.season_status?"//www.bilibili.com/blackboard/activity-H1WoSpdsb.html":"javascript:;"},btnText:function(){return 13===this.MEDIA_INFO.season_status?this.SS_STAT.isVip?this.PAY_MENT.tip:this.PAY_MENT.vip_promotion:12===this.MEDIA_INFO.season_status?0===this.SS_STAT.status?"查看霹雳付费专区":"霹雳付费用户专享":0===this.SS_STAT.status||8!==this.MEDIA_INFO.season_status&&9!==this.MEDIA_INFO.season_status?6===this.MEDIA_INFO.season_status||7===this.MEDIA_INFO.season_status?this.SS_STAT.isVip?"大会员".concat(6===this.MEDIA_INFO.season_status?"免费":"抢先","观看"):"付费(".concat(this.PAY_MENT.price,"B币)").concat(6===this.MEDIA_INFO.season_status?"观":"抢先","看"):void 0:"付费(".concat(this.PAY_MENT.price,"B币)").concat(8===this.MEDIA_INFO.season_status?"观":"抢先","看")}}),methods:{clickHander:function(){this.LOGIN_INFO.isLogin?13!==this.MEDIA_INFO.season_status||this.SS_STAT.isVip?12!==this.MEDIA_INFO.season_status&&1===this.SS_STAT.status&&(Object(dt.report)({click:"pay"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),1===this.PUB_INFO.is_started?pt.$emit("TRIGGER_PAY_PROCESS",!0):pt.$emit("TRIGGER_PAY_ENTRY",!0)):window.showVipPay():S()}}},Ot=(i(108),Object(mt.a)(Tt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["btn-pay-wrapper",{"vip-only":13===t.MEDIA_INFO.season_status&&!t.SS_STAT.isVip,"is-vip":t.vipStyle}]},[t.LOGIN_INFO.isLogin?i("a",{staticClass:"pay-btn",attrs:{href:t.btnHref,target:"javascript:;"===t.btnHref?"_self":"_blank"},domProps:{textContent:t._s(t.btnText)},on:{click:t.clickHander}}):t._e(),t._v(" "),t.LOGIN_INFO.isLogin?t._e():i("a",{staticClass:"pay-btn",attrs:{href:"javascript:;"},domProps:{textContent:t._s(t.btnText)},on:{click:t.clickHander}}),t._v(" "),i("div",{class:["pic-wrapper",{"is-vip":t.vipStyle||13===t.MEDIA_INFO.season_status}]}),t._v(" "),!t.SS_STAT.isVip&&13===t.MEDIA_INFO.season_status&&t.PAY_MENT.vip_first_promotion?i("span",{staticClass:"sale-corner",domProps:{textContent:t._s(t.PAY_MENT.vip_first_promotion)}}):t._e()])},[],!1,null,null,null).exports);function Ct(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var St={computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Ct(t,e,i[e])})}return t}({},Object(o.b)(["ACTIVITY"]),{activityLink:function(){return"javascript:;"},ratio:function(){return y()||2},pendantImage:function(){var t=this.ACTIVITY.pendant&&this.ACTIVITY.pendant[0]?this.ACTIVITY.pendant[0].image:"";return t?"background-image: url(".concat(v(t,Math.ceil(80*this.ratio),Math.ceil(80*this.ratio)),")"):""},random:function(){return 1===Math.floor(2*Math.random())}})},Et=(i(109),Object(mt.a)(St,function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"func-pendant",attrs:{href:this.activityLink}},[e("i",{class:["avatar",{"avatar-22":this.random,"avatar-33":!this.random}]}),this._v(" "),this.pendantImage?e("i",{staticClass:"pendant",style:this.pendantImage}):this._e()])},[],!1,null,null,null).exports);function Nt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Mt={computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Nt(t,e,i[e])})}return t}({},Object(o.b)(["SS_ID","EP_ID","MEDIA_INFO","LOGIN_INFO","USER_STAT","ACTIVITY","SPONSOR_TOTAL_COUNT"]),{btnText:function(){return 1===this.USER_STAT.sponsor?"继续承包":"我要承包"},sponsorCount:function(){return W(this.SPONSOR_TOTAL_COUNT,this.USER_STAT.sponsor)},isPendant:function(){return this.ACTIVITY.pendants&&this.ACTIVITY.pendants[0]&&this.ACTIVITY.pendants[0].image}}),methods:{clickHander:function(){this.LOGIN_INFO.isLogin?(Object(dt.report)({click:"bp"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),this.$root.$emit("trigger-sponsor-pay",!0)):S()}},components:{Pendant:Et}},Pt=(i(110),Object(mt.a)(Mt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"btn-sponsor-wrapper"},[i("span",{staticClass:"sponsor-count",domProps:{innerHTML:t._s(t.sponsorCount)}}),t._v(" "),i("a",{staticClass:"sponsor-btn",attrs:{href:"javascript:;"},domProps:{textContent:t._s(t.btnText)},on:{click:t.clickHander}}),t._v(" "),i("div",{class:["pic-wrapper",{"no-image":t.isPendant}]},[t.isPendant?i("pendant"):t._e()],1)])},[],!1,null,null,null).exports);function At(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var kt={data:function(){return{areaLink:{1:"//www.bilibili.com/anime/",2:"//www.bilibili.com/movie/",3:"//www.bilibili.com/documentary/",4:"//www.bilibili.com/guochuang/",5:"//www.bilibili.com/tv/",music:"//www.bilibili.com/v/music/"}}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){At(t,e,i[e])})}return t}({},Object(o.b)(["SS_ID","EP_ID","MEDIA_INFO","NEWEST_EP","EP_INFO"]),{areaStr:function(){return(this.MEDIA_INFO.areas&&this.MEDIA_INFO.areas.length>4?this.MEDIA_INFO.areas.slice(0,4):this.MEDIA_INFO.areas||[]).map(function(t){return t.name}).join("、")},bidLink:function(){var t=[26484,26481];return this.areaLink[t.indexOf(this.MEDIA_INFO.season_id)>-1?"music":this.MEDIA_INFO.season_type]},seasonTypeName:function(){return Q(this.MEDIA_INFO.season_type,this.MEDIA_INFO.season_id)},avId:function(){return"AV".concat(this.EP_INFO.aid)},avLink:function(){return"//www.bilibili.com/video/av".concat(this.EP_INFO.aid,"/")}}),methods:{reportHandler:function(){Object(dt.report)({click:"type"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title,url:this.areaLink[this.MEDIA_INFO.season_type]})},reportAVID:function(){Object(dt.report)({click:"avid"})}}},Dt=(i(111),Object(mt.a)(kt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"info-second"},[i("a",{attrs:{href:t.bidLink,target:"_blank"},on:{click:t.reportHandler}},[i("span",{staticClass:"info-sec-type",domProps:{textContent:t._s(t.seasonTypeName)}})]),t._v(" "),i("span",{staticClass:"info-sec-area",domProps:{textContent:t._s(t.areaStr)}}),t._v(" "),i("span",{staticClass:"info-sec-pub",domProps:{textContent:t._s(t.NEWEST_EP.desc)}}),t._v(" "),t.EP_INFO.aid?i("a",{staticClass:"info-sec-av",attrs:{href:t.avLink,target:"_blank"},domProps:{textContent:t._s(t.avId)},on:{click:t.reportAVID}}):t._e()])},[],!1,null,null,null).exports);function Ut(t,e){var i=0,n=0,s=!1,o=t.direction?t.direction:"x",a=t.directionSpc?t.directionSpc:0,r=t.speed?t.speed:80;clearInterval(t.timer);var c={};t.timer=setInterval(function(){s?(e&&e(),clearInterval(t.timer)):n>t.max-1?s=!0:(i=-n*t.step,"x"===o&&(c={"background-position":"".concat(i,"px -").concat(a,"px")}),"y"===o&&(c={"background-position":"-".concat(a,"px ").concat(i,"px")}),window.$(".".concat(t.target)).css(c),n++)},r)}var xt={data:function(){return{animating:!1,item:"bangumi-coin",targetItem:"bangumi-coin-d",tempTotalCoin:0,tempUserCoin:this.coins.user,select:0}},props:{isLogin:{type:Boolean,default:!1},seasonId:{type:Number,required:!0},coins:{type:Object,default:function(){return{video:0,user:0}}}},created:function(){var t=this;pt.$on("COIN_SUCCESS",function(e){t.animating||(t.animating=!0,t.tempUserCoin=t.select=e,Ut(t.animeConfig[1],function(){t.tempTotalCoin||(t.tempTotalCoin=t.coins.video),t.tempTotalCoin+=t.select,t.animating=!1}))})},computed:{coin:function(){return C(this.tempTotalCoin||this.coins.video)},animeConfig:function(){return[{step:60,max:19,point:0,speed:60,target:this.item},{step:60,max:40,point:0,speed:60,target:this.targetItem,directionSpc:60}]}},watch:{select:function(t,e){t!==e&&(this.$refs.animeEvent.style="background-position: 0 0")},seasonId:function(){this.tempTotalCoin=this.coins.video}},methods:{setCoinState:function(){this.$emit("click-coin"),this.coins.user>0||this.tempUserCoin>0?R({el:this.$refs.coinDom_up,msg:"对本稿件的投币枚数已用完",cd:1e3}):this.isLogin?pt.$emit("COIN_DIALOG",!0):S()}},components:{}},jt=(i(112),Object(mt.a)(xt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"mouse-movieclip",rawName:"v-mouse-movieclip",value:t.animeConfig[0],expression:"animeConfig[0]"}],staticClass:"bangumi-coin-wrap",attrs:{title:"投硬币枚数"+t.coin,"report-id":"click_coin"},on:{click:t.setCoinState}},[i("i",{directives:[{name:"show",rawName:"v-show",value:!t.tempUserCoin,expression:"!tempUserCoin"}],class:t.item}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.tempUserCoin,expression:"tempUserCoin"}],ref:"animeEvent",class:t.targetItem}),t._v(" "),i("span",{staticClass:"coin-status"},[t._v("硬币")]),t._v(" "),i("span",{attrs:{id:"v_ctimes"}},[t._v(t._s(t.coin))])])},[],!1,null,null,null).exports),Lt={data:function(){return{dialogVisible:!1,defaultSelect:null,exp:0}},props:{coin:{type:Number},aid:{type:Number},login:{type:Boolean,default:!1}},created:function(){var t=this;pt.$on("COIN_DIALOG",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.dialogVisible=e})},watch:{coin:function(){this.defaultSelect=null},dialogVisible:function(){this.dialogVisible&&this.$nextTick(function(){E(this.$el)})},login:function(){this.getExp()}},computed:{currentSelect:function(){return this.defaultSelect?this.defaultSelect:0===this.coin?1:(this.coin,1)}},methods:{selectCoin:function(t){this.defaultSelect=t},getExp:function(){var t=this;this.login&&A.fetchGet("".concat(F.API,"/x/web-interface/coin/today/exp"),null).then(function(e){0===e.code&&(t.exp=e.data||0)})},addCoin:function(t){var e=this;U({url:"".concat(F.API,"/x/web-interface/coin/add"),type:"post",data:{aid:this.aid,multiply:this.currentSelect},xhrFields:{withCredentials:!0}}).then(function(t){0===t.code?(pt.$emit("COIN_SUCCESS",e.currentSelect),R({el:window.$(".bangumi-coin-wrap")[0],msg:"投币成功",cd:1e3})):R({el:window.$(".bangumi-coin-wrap")[0],msg:t.message||"投币失败",cd:1e3,type:"error"}),pt.$emit("COIN_DIALOG",!1)})},closeDialog:function(){pt.$emit("COIN_DIALOG",!1)}},mounted:function(){this.getExp()}},Ft=(i(113),Object(mt.a)(Lt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dialogVisible?i("div",{staticClass:"dialog-mask"},[i("transition",{attrs:{name:"fade"}},[i("div",{staticClass:"coin-operated-m"},[i("i",{staticClass:"coin-close",on:{click:t.closeDialog}}),t._v(" "),i("div",{staticClass:"coin-title"},[t._v("给UP主投上 "),i("span",[t._v(t._s(t.currentSelect))]),t._v(" 枚硬币")]),t._v(" "),i("div",{staticClass:"mc clearfix"},[i("div",{staticClass:"mc-box left-con",class:1===t.currentSelect?"on":"",on:{click:function(e){return t.selectCoin(1)}}},[i("span",{staticClass:"c-num"},[t._v("1硬币")])]),t._v(" "),t._e()]),t._v(" "),i("div",{staticClass:"coin-bottom"},[i("span",{staticClass:"coin-btn",on:{click:function(e){return t.addCoin(e)}}},[t._v("确定")]),t._v(" "),t.exp<50?i("p",{staticClass:"tips"},[t._v("经验值+"+t._s(10*t.currentSelect)+"（今日"+t._s(t.exp)+"/50）")]):i("p",{staticClass:"tips"},[t._v("今日投币+50经验成就 get√ 赞！")])])])])],1):t._e()},[],!1,null,null,null).exports),Rt={data:function(){return{animating:!1,tempTotalCollect:0,itemCls:"bangumi-order",targetItem:"bangumi-order-d"}},props:{loginInfo:{type:Object,required:!0},seasonType:{type:Number,required:!0},seasonId:{type:Number,required:!0},followed:{type:Boolean,required:!0},followCount:{type:Number,required:!0}},computed:{isBangumi:function(){return 1===this.seasonType||4===this.seasonType},collect:function(){return C(this.tempTotalCollect||this.followCount)},animeConfig:function(){return[{step:60,max:this.isBangumi?24:21,point:0,speed:60,target:this.itemCls},{step:60,max:this.isBangumi?32:30,point:0,speed:60,target:this.targetItem,directionSpc:60},{step:60,max:this.isBangumi?12:7,point:0,speed:60,target:this.targetItem,directionSpc:120}]},title:function(){return this.isBangumi?"追番":"追剧"}},watch:{followed:function(t,e){this.$refs.animeEvent.style=t?"":"background-position: 0 0"},seasonId:function(){this.tempTotalCollect=this.followCount},followCount:function(){this.tempTotalCollect=this.followCount}},mounted:function(){var t=this;pt.$on("TRIGGER_FOLLOW_ANIME",function(){Ut(t.animeConfig[t.followed?2:1],function(){t.followed?t.tempTotalCollect++:t.tempTotalCollect--})})},methods:{toCollect:function(){var t=this;this.loginInfo.isLogin?this.animating||(this.animating=!0,H(this.seasonId,this.seasonType,!this.followed,this.loginInfo.mid).then(function(e){0===e.code&&(t.followed?Ut(t.animeConfig[2],function(){t.$emit("stat-change",!1),t.tempTotalCollect--,t.animating=!1}):(t.$emit("stat-change",!0),Ut(t.animeConfig[1],function(){t.tempTotalCollect++,t.animating=!1})))})):S()}}},$t=(i(114),Object(mt.a)(Rt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"mouse-movieclip",rawName:"v-mouse-movieclip",value:t.animeConfig[0],expression:"animeConfig[0]"}],class:t.itemCls+"-wrap",attrs:{title:t.title+"数"+t.collect,"report-id":t.followed?"click_unfollow":"click_follow"},on:{click:t.toCollect}},[i("i",{directives:[{name:"show",rawName:"v-show",value:!t.followed,expression:"!followed"}],class:t.itemCls}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.followed,expression:"followed"}],ref:"animeEvent",class:t.targetItem}),t._v(" "),i("span",{class:t.itemCls+"-status"},[t._v(t._s(t.title))]),t._v(" "),i("span",{attrs:{id:"v_ctimes"}},[t._v(t._s(t.collect))])])},[],!1,null,null,null).exports);function Jt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Gt={props:{funcType:String},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Jt(t,e,i[e])})}return t}({},Object(o.b)(["SS_ID","EP_ID","EP_INFO","SPENDING","SEASON_STAT","LOGIN_INFO","MEDIA_INFO","SEASON_FOLLOWED","UP_INFO"]),{coinConfig:function(){return{video:this.SEASON_STAT.coins,user:this.SPENDING}},seasonType:function(){return this.MEDIA_INFO.season_type||1},showUper:function(){return!(!this.funcType||"uper"===this.funcType||3!==this.MEDIA_INFO.season_type&&4!==this.MEDIA_INFO.season_type)},viewCount:function(){return C(this.SEASON_STAT.views||0)},danmuCount:function(){return C(this.SEASON_STAT.danmakus||0)}}),watch:{SS_ID:function(){this.loadStat()}},mounted:function(){this.SS_ID>-1&&this.loadStat()},methods:{loadStat:function(){this.$store.dispatch({type:"FETCH_VIDEO_STAT",ssId:this.SS_ID,ssType:this.MEDIA_INFO.season_type})},followChanged:function(t){this.$store.dispatch({type:"FOLLOW_STAT_CHANGE",stat:t}),Object(dt.report)({click:t?"follow":"unfollow"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})},reportCoin:function(){Object(dt.report)({click:"coin"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})},reportUpinfo:function(){Object(dt.report)({click:"up"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})}},components:{Coin:jt,Collection:$t}},Vt=(i(115),Object(mt.a)(Gt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"count-wrapper clearfix"},[i("div",{staticClass:"view-count"},[i("i"),i("span",{domProps:{textContent:t._s(t.viewCount)}})]),t._v(" "),i("div",{class:["danmu-count",{noline:t.showUper}]},[i("i"),i("span",{domProps:{textContent:t._s(t.danmuCount)}})]),t._v(" "),t.showUper?i("div",{staticClass:"up-info"},[i("i"),i("span",[i("a",{attrs:{href:"//space.bilibili.com/"+t.UP_INFO.mid,target:"_blank"},on:{click:t.reportUpinfo}},[t._v(t._s(t.UP_INFO.uname))])])]):t._e(),t._v(" "),t.EP_ID>-1?i("coin",{attrs:{coins:t.coinConfig,"season-id":t.SS_ID,"is-login":t.LOGIN_INFO.isLogin},on:{"click-coin":t.reportCoin}}):t._e(),t._v(" "),i("collection",{attrs:{"login-info":t.LOGIN_INFO,"season-id":t.SS_ID,"season-type":t.seasonType,followed:t.SEASON_FOLLOWED,"follow-count":t.SEASON_STAT.favorites||0},on:{"stat-change":t.followChanged}})],1)},[],!1,null,null,null).exports);function Ht(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Bt={computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Ht(t,e,i[e])})}return t}({},Object(o.b)(["AREA","APP","EP_INFO","MEDIA_INFO","USER_STAT","UP_INFO","RIGHTS_INFO","SS_STAT"]),{h1Title:function(){return G(this.EP_INFO.index,this.MEDIA_INFO.title,this.EP_INFO.index_title,2===this.MEDIA_INFO.mode,this.MEDIA_INFO.season_type)},payBannerShow:function(){return this.USER_STAT.loaded&&0===this.AREA&&!this.APP||"uper"===this.funcType},funcType:function(){return 12===this.MEDIA_INFO.season_status||13===this.MEDIA_INFO.season_status?"pay":0!==this.SS_STAT.status&&9===this.MEDIA_INFO.season_status?"pay":6===this.MEDIA_INFO.season_status||7===this.MEDIA_INFO.season_status?this.SS_STAT.isVip?"pay":0===this.SS_STAT.status?1===this.RIGHTS_INFO.allow_bp?"sponsor":"uper":"pay":1===this.RIGHTS_INFO.allow_bp?"sponsor":"uper"}}),components:{UperInfo:It,BtnPay:Ot,BtnSponsor:Pt,BreadThumb:Dt,BangumiCount:Vt}},qt=(i(116),Object(mt.a)(Bt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bangumi-header report-wrap-module report-scroll-module clearfix",attrs:{id:"bangumi_header"}},[i("div",{staticClass:"header-info"},[i("h1",{attrs:{title:t.h1Title},domProps:{textContent:t._s(t.h1Title)}}),t._v(" "),i("bread-thumb"),t._v(" "),i("bangumi-count",{attrs:{"func-type":t.funcType}}),t._v(" "),i("div",{staticClass:"header-ad-wrapper"})],1),t._v(" "),t.payBannerShow?i("div",{staticClass:"header-pay-banner"},["sponsor"===t.funcType?i("btn-sponsor"):t._e(),t._v(" "),"pay"===t.funcType?i("btn-pay"):t._e(),t._v(" "),"uper"===t.funcType&&t.UP_INFO.mid?i("uper-info"):t._e()],1):t._e(),t._v(" "),t._m(0)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ad-f clearfix"},[e("div",{staticClass:"left ad-fl data-id-ad",staticStyle:{display:"none"},attrs:{"data-loc-id":"124"}}),this._v(" "),e("div",{staticClass:"right ad-fr data-id-ad",staticStyle:{display:"none"},attrs:{"data-loc-id":"126"}})])}],!1,null,null,null).exports),Wt=i(6),Qt=i.n(Wt),Xt={data:function(){return{staticShow:!1,floatShow:!1,toFollow:!0}},props:{loginInfo:{type:Object,required:!0},config:{type:Object,default:function(){return{styleType:"static",price:0,payPackTitle:"",payPackUrl:"",seasonStatus:6,promotion:"",seasonId:0,seasonType:1,isStarted:1,title:"",isfollow:!0,time:"2012-01-03 00:00:00"}}}},created:function(){var t=this;pt.$on("TRIGGER_PAY_ENTRY",function(e){t.floatShow=e})},computed:{tipText:function(){return 6===this.config.seasonStatus||8===this.config.seasonStatus?"本片需付费(".concat(this.config.price,"B币)观看"):12===this.config.seasonStatus?"本片仅限购买".concat(this.config.payPackTitle,"用户观看"):"本片需付费(".concat(this.config.price,"B币)抢先看")},show:function(){return this.staticShow||this.floatShow},btnText:function(){return 6===this.config.seasonStatus?"成为大会员免费看":"成为大会员抢先看"}},watch:{show:function(){this.show&&this.$nextTick(function(){E(this.$el)})}},mounted:function(){"static"===this.config.styleType&&(this.staticShow=!0)},methods:{toPayWatchProcess:function(){this.$emit("click-pay"),12===this.config.seasonStatus?window.open(this.config.payPackUrl):("float"===this.config.styleType&&(this.floatShow=!1),pt.$emit("TRIGGER_PAY_PROCESS",!0)),1!==this.config.isStarted&&this.toFollow&&this.follow()},setToFollow:function(){this.toFollow=!this.toFollow},follow:function(){var t=this;H(this.config.seasonId,this.config.seasonType,!0,this.loginInfo.mid).then(function(e){0===e.code&&t.$emit("on-follow",!0)})},buyVip:function(){window.showVipPay()},checkLogin:function(t){this.loginInfo.isLogin?t():S()},close:function(){this.floatShow=!1}}},Yt=(i(117),Object(mt.a)(Xt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{class:["pay-watch-entry-wrapper",{"pay-watch-float":"float"===t.config.styleType},{"pay-watch-static":"static"===t.config.styleType}]},[1===t.config.isStarted?i("div",{staticClass:"pwe-popup"},["float"===t.config.styleType?i("div",{staticClass:"pwe-popup-close",on:{click:t.close}}):t._e(),t._v(" "),i("div",{staticClass:"pwe-popup-text"},[t._v("\n            "+t._s(t.tipText)+"\n            "),i("div",{staticClass:"pwe-popup-tip"},[t._v(t._s(t.config.promotion))])]),t._v(" "),i("div",{staticClass:"pwe-popup-img"}),t._v(" "),i("div",{staticClass:"pwe-popup-pay",on:{click:function(e){return t.checkLogin(t.toPayWatchProcess)}}},[t._v("立即观看")]),t._v(" "),8!==t.config.seasonStatus&&9!==t.config.seasonStatus&&12!==t.config.seasonStatus?i("div",{staticClass:"pwe-popup-buyvip",on:{click:function(e){return t.checkLogin(t.buyVip)}}},[t._v(t._s(t.btnText))]):t._e()]):t._e(),t._v(" "),1!==t.config.isStarted?i("div",{staticClass:"pwe-popup pwe-popup-alert"},["float"===t.config.styleType?i("div",{staticClass:"pwe-popup-close",on:{click:t.close}}):t._e(),t._v(" "),i("div",{staticClass:"pwe-popup-text"},[i("span",{staticClass:"pwe-popup-text-title"},[t._v("《"),i("span",[t._v(t._s(t.config.title))]),t._v("》")]),t._v(" "),i("span",{staticClass:"pwe-popup-text-time"},[t._v("将于"),i("span",[t._v(t._s(t.config.time))]),t._v("开播，确定提前购买？")]),t._v(" "),t.config.isfollow?t._e():i("div",{staticClass:"pwe-popup-tip",on:{click:t.setToFollow}},[i("div",{class:["pwe-popup-checkbox",{checked:t.toFollow}]}),t._v("\n                同时"+t._s(1===t.config.seasonType||4===t.config.seasonType?"追番":"收藏")+"接收开播提醒\n            ")]),t._v(" "),t.config.isfollow?i("div",{staticClass:"pwe-popup-tip-pos"}):t._e()]),t._v(" "),i("div",{staticClass:"pwe-popup-img"}),t._v(" "),i("div",{staticClass:"pwe-popup-confrim",on:{click:function(e){return t.checkLogin(t.toPayWatchProcess)}}},[t._v("确定")]),t._v(" "),8!==t.config.seasonStatus&&9!==t.config.seasonStatus&&12!==t.config.seasonStatus?i("div",{staticClass:"pwe-popup-buyvip",on:{click:function(e){return t.checkLogin(t.buyVip)}}},[t._v(t._s(t.btnText))]):t._e()]):t._e()]):t._e()},[],!1,null,null,null).exports),zt={data:function(){return{clickLock:!1}},props:{config:{type:Object,default:function(){return{}}}},mounted:function(){this.clickLock=!1},methods:{quickPay:function(){var t=this;this.clickLock||(this.clickLock=!0,A.fetchPost("//bangumi.bilibili.com/pay/web_api/season/quick",{season_id:this.config.seasonId,season_type:this.config.seasonType,csrf:this.config.csrf},!1,!0).then(function(e){0===e.code&&1===e.result.status?t.$emit("set-component","success"):t.$emit("set-component","failed"),t.clickLock=!1},function(){t.$emit("set-component","failed"),t.clickLock=!1}))}}},Kt=Object(mt.a)(zt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pwp-module-wrapper"},[i("div",{staticClass:"pwp-modal-header"},[t._v("您的B币余额充足")]),t._v(" "),i("div",{staticClass:"pwp-modal-container"},[i("div",{staticClass:"step-index"},[i("div",{staticClass:"money-b"},[i("span",{staticClass:"label"},[t._v("B币余额：")]),t._v(" "),i("span",{staticClass:"mark"},[t._v(t._s(t.config.userBp))]),t._v(" "),i("span",[t._v("B币")])]),t._v(" "),i("div",{staticClass:"money-n"},[i("span",{staticClass:"label"},[t._v("需要消耗：")]),t._v(" "),i("span",{staticClass:"mark"},[t._v(t._s(t.config.amount))]),t._v(" "),i("span",{staticClass:"mark"},[t._v("B币")]),t._v(" "),i("span",{staticClass:"enough"},[t._v("（余额足够，将使用余额支付）")])]),t._v(" "),i("div",{staticClass:"pwp-btn primary",on:{click:t.quickPay}},[t._v("确认支付")])])])])},[],!1,null,null,null).exports,Zt={data:function(){return{win:null,payType:"wechat",payMethod:{alipay:0,wechat:1,quick:2,center:3},payInterval:null,alipayQrcodeSrc:null,wechatQrcode:null}},props:{config:{type:Object,default:function(){return{}}},orderId:{type:String}},watch:{payType:function(){this.init()}},mounted:function(){this.init()},methods:{init:function(){this.payInterval&&clearInterval(this.payInterval),this.createOrder(),this.payInterval=setInterval(this.checkResult,3e3)},createOrder:function(){var t=this;"center"===this.payType&&this.$emit("set-component","others"),A.fetchPost("//bangumi.bilibili.com/pay/web_api/season/create",{pay_method:this.payMethod[this.payType],season_id:this.config.seasonId,season_type:this.config.seasonType,csrf:this.config.csrf},!1,!0).then(function(e){e&&0===e.code?(t.$emit("set-order-id",e.result.order_id),"wechat"===t.payType?new Qt.a({size:190,background:"#fff",element:t.$el.querySelector("#wechat-qrcode"),value:e.result.qrcode}):"alipay"===t.payType?e.result.qrcode&&(t.alipayQrcodeSrc=e.result.qrcode.replace("¬","&not").replace(/&amp;/g,"&")):"center"===t.payType&&(t.win.location.href=e.result.cashier_url)):t.payInterval&&clearInterval(t.payInterval)},function(e){t.payInterval&&clearInterval(t.payInterval),t.errReport({url:"//bangumi.bilibili.com/pay/web_api/season/create",msg:"创建订单失败"},e)})},checkResult:function(){var t=this;this.orderId&&A.fetchPost("//bangumi.bilibili.com/pay/web_api/season/success",{order_id:this.orderId,season_type:this.config.seasonType,csrf:this.config.csrf},!1,!0).then(function(e){0===e.code&&1===e.result.status&&(clearInterval(t.payInterval),t.$emit("set-component","success"))},function(){clearInterval(t.payInterval),t.$emit("set-component","failed")})},setPayMethod:function(t){"center"===t&&(this.win=window.open("https://pay.bilibili.com/jump.html","_blank")),this.payType!==t&&(this.payType=t)},refreshQrcode:function(){this.createOrder()},errReport:function(t,e){j({requestUrl:window.location.protocol+t.url,errMsg:t.msg,mid:window.uid||void 0},e)}},destroyed:function(){this.payInterval&&clearInterval(this.payInterval)}},te=(i(118),Object(mt.a)(Zt,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pwp-module-wrapper"},[i("div",{staticClass:"pwp-modal-header"},[t._v("您的B币余额不足")]),t._v(" "),i("div",{staticClass:"pwp-modal-container"},[i("div",{staticClass:"step-qrcode"},[i("div",{staticClass:"money-b"},[i("span",{staticClass:"label"},[t._v("B 币余额：")]),t._v(" "),i("span",{staticClass:"mark"},[t._v(t._s(t.config.userBp))]),t._v(" "),i("span",{staticClass:"mark"},[t._v(" B币")])]),t._v(" "),i("div",{staticClass:"money-n"},[i("span",{staticClass:"label"},[t._v("需要购买：")]),t._v(" "),i("span",{staticClass:"mark"},[t._v(t._s(t.config.amount))]),t._v(" "),i("span",{staticClass:"mark"},[t._v(" B币")])])]),t._v(" "),i("div",{staticClass:"pwp-qrcode-wrapper"},[i("div",{staticClass:"pwp-qrcode-header"},[t._v("\n                请使用"),i("span",{attrs:{id:"pwp_pay_type"}},[t._v(t._s("alipay"===t.payType?"支付宝":"微信"))]),t._v("扫码支付\n            ")]),t._v(" "),i("div",{staticClass:"pwp-qrcode-content"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"alipay"===t.payType,expression:"payType === 'alipay'"}],staticClass:"alipay-qrcode"},[i("iframe",{attrs:{width:"300",height:"290",id:"iframeQrcodePfw",scrolling:"no",src:t.alipayQrcodeSrc}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"wechat"===t.payType,expression:"payType === 'wechat'"}],staticClass:"wechat-qrcode"},[i("canvas",{attrs:{id:"wechat-qrcode"}})])]),t._v(" "),i("div",{staticClass:"pwp-qrcode-tab-wrapper"},[i("div",{staticClass:"pwp-qrcode-tab-mask"}),t._v(" "),i("div",{class:["pwp-qrcode-tab",{active:"alipay"===t.payType}],on:{click:function(e){return t.setPayMethod("alipay")}}},[i("i",{staticClass:"alipay"}),t._v("支付宝\n                ")]),t._v(" "),i("div",{class:["pwp-qrcode-tab",{active:"wechat"===t.payType}],on:{click:function(e){return t.setPayMethod("wechat")}}},[i("i",{staticClass:"wechat"}),t._v("微信\n                ")])]),t._v(" "),i("a",{staticClass:"pwp_payment_others",attrs:{href:"javascript: void(0);"},on:{click:function(e){return t.setPayMethod("center")}}},[t._v("其他支付方式>")]),t._v(" "),i("a",{staticClass:"pwp_qrcode_refresh",attrs:{href:"javascript: void(0);"},on:{click:function(e){return t.refreshQrcode()}}},[t._v("刷新二维码")])])])])},[],!1,null,null,null).exports),ee={data:function(){return{helpUrl:"//www.bilibili.com/blackboard/help.html#n1"}},props:{userPayType:{type:String,default:void 0}},methods:{rePay:function(){void 0===this.userPayType||"index"===this.userPayType?this.$emit("set-component","index"):this.$emit("set-component","qrcode")}}},ie=Object(mt.a)(ee,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pwp-module-wrapper"},[i("div",{staticClass:"step-status"},[i("div",{staticClass:"step-title"},[t._v("购买失败！")]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"step-footer"},[i("div",{staticClass:"pwp-btn primary",on:{click:t.rePay}},[t._v("重新支付")]),t._v(" "),i("a",{staticClass:"pwp-btn default",attrs:{href:t.helpUrl,target:"_blank"}},[t._v("遇到问题")])])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"stat-container"},[e("div",{staticClass:"stat-payment fail"})])}],!1,null,null,null).exports,ne={methods:{success:function(){location.reload(0)}}},se=Object(mt.a)(ne,function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"fade"}},[e("div",{staticClass:"step-status"},[e("div",{staticClass:"step-title"},[this._v("购买成功！")]),this._v(" "),e("div",{staticClass:"stat-container"},[e("div",{staticClass:"stat-payment success"})]),this._v(" "),e("div",{staticClass:"step-footer"},[e("div",{staticClass:"pwp-btn primary success",on:{click:this.success}},[this._v("确定")])])])])},[],!1,null,null,null).exports,oe={data:function(){return{payReady:!1,htmlConfig:{title:"正在付款中",orderPic:"paying",orderSuc:!0,orderErr:!0,orderBack:!1}}},props:{config:{type:Object,default:function(){return{}}},orderId:{type:String}},mounted:function(){},methods:{checkResult:function(){var t=this;this.orderId?A.fetchPost("//bangumi.bilibili.com/pay/web_api/season/success",{order_id:this.orderId,season_type:this.config.seasonType,csrf:this.config.csrf},!1,!0).then(function(e){1!==e.result.status?t.$emit("set-component","nopayed"):t.$emit("set-component","success")},function(){t.$emit("set-component","failed")}):this.$emit("set-component","nopayed")},checkOrder:function(){var t=this;this.htmlConfig.title="正在核对订单...",this.htmlConfig.orderPic="review",this.htmlConfig.orderSuc=!1,this.htmlConfig.orderErr=!1,this.htmlConfig.orderBack=!0,setTimeout(function(){t.checkResult()},1e3)},help:function(){window.open("http://www.bilibili.com/html/help.html#n1")},back:function(){this.$emit("set-component","qrcode")}}},ae={data:function(){return{sec:3,letInterval:null}},mounted:function(){var t=this;this.letInterval=setInterval(function(){t.sec=t.sec-1,0===t.sec&&t.$emit("set-component","qrcode")},1e3)},methods:{back:function(){this.$emit("set-component","qrcode")}},destroyed:function(){this.letInterval&&clearInterval(this.letInterval)}},re={data:function(){return{helpUrl:"//www.bilibili.com/blackboard/help.html#n1"}},methods:{refresh:function(){window.location.reload()}}},ce={index:Kt,qrcode:te,failed:ie,success:se,others:Object(mt.a)(oe,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"step-status"},[i("div",{staticClass:"step-title"},[t._v(t._s(t.htmlConfig.title))]),t._v(" "),i("div",{staticClass:"stat-container"},[i("div",{class:["stat-payment "+t.htmlConfig.orderPic]})]),t._v(" "),i("div",{staticClass:"step-footer"},[t.htmlConfig.orderSuc?i("div",{staticClass:"pwp-btn primary",on:{click:t.checkOrder}},[t._v("付款完成")]):t._e(),t._v(" "),t.htmlConfig.orderErr?i("div",{staticClass:"pwp-btn default",on:{click:t.help}},[t._v("遇到问题")]):t._e(),t._v(" "),t.htmlConfig.orderBack?i("a",{staticClass:"back",attrs:{href:"javascript: void(0);"},on:{click:t.back}},[t._v("返回上一步")]):t._e()])])},[],!1,null,null,null).exports,nopayed:Object(mt.a)(ae,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"step-status"},[i("div",{staticClass:"step-title"},[t._v("然而并没有收到付款")]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"step-footer"},[i("span",{attrs:{id:"second"}},[t._v(t._s(t.sec))]),t._v("\n         秒后自动 \n        "),i("a",{staticClass:"back",attrs:{href:"javascript: void(0);"},on:{click:t.back}},[t._v("返回")])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"stat-container"},[e("div",{staticClass:"stat-payment nrpy"})])}],!1,null,null,null).exports,error:Object(mt.a)(re,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pwp-module-wrapper"},[i("div",{staticClass:"step-status"},[i("div",{staticClass:"step-title"},[t._v("抱歉<(_ _)> 您的支付请求迷路了")]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"step-footer"},[i("div",{staticClass:"pwp-btn primary",on:{click:t.refresh}},[t._v("刷新重试")]),t._v(" "),i("a",{staticClass:"pwp-btn default",attrs:{href:t.helpUrl,target:"_blank"}},[t._v("遇到问题")])])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"stat-container"},[e("div",{staticClass:"stat-payment fail"})])}],!1,null,null,null).exports},le={data:function(){return{show:!1,component:null,step:null,userPayType:null,orderId:"",componentConfig:{}}},props:{config:{type:Object,default:function(){return{amount:0,seasonId:0,seasonType:1,csrf:""}}},loginInfo:{type:Object}},created:function(){var t=this;pt.$on("TRIGGER_PAY_PROCESS",function(e){t.show=e,t.$nextTick(function(){E(this.$el)})})},watch:{step:function(){this.component=ce[this.step]},config:{handler:function(t,e){this.componentConfig=this.config,this.getBp()},deep:!0},loginInfo:{handler:function(t,e){this.componentConfig=this.config,this.getBp()},deep:!0}},mounted:function(){this.componentConfig=this.config},methods:{init:function(){if(this.componentConfig.seasonId&&(this.componentConfig.userBp||0===this.componentConfig.userBp)){var t=Number(this.componentConfig.amount),e=Number(this.componentConfig.userBp);(t<0||e<0)&&(this.step="failed"),t>e?(this.userPayType="qrcode",this.step="qrcode"):t<=e&&(this.userPayType="index",this.step="index")}},setStep:function(t){this.step=t},setOrderId:function(t){this.orderId=t},close:function(){this.step=this.userPayType,this.show=!1},getBp:function(){var t=this;if(!this.loginInfo||!this.loginInfo.isLogin)return!1;A.postWithToken("//bangumi.bilibili.com/web_api/get_bp").then(function(e){if(0===e.code){var i=Number(e.result.default_bp);isNaN(i)&&(i=0),t.componentConfig.userBp=i,t.init()}else t.step="error"},function(){t.step="error"})}}},ue=(i(119),Object(mt.a)(le,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[t.show?i("div",{staticClass:"pwp-modal-mask"},[i("div",{staticClass:"pwp-modal-wrapper",attrs:{id:"pwp-content"}},[i("i",{staticClass:"pwp-modal-close",on:{click:t.close}}),t._v(" "),i(t.component,{tag:"component",attrs:{config:t.componentConfig,"user-pay-type":t.userPayType,"order-id":t.orderId},on:{"set-component":t.setStep,"set-order-id":t.setOrderId}})],1)]):t._e()])},[],!1,null,null,null).exports);function de(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var pe={computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){de(t,e,i[e])})}return t}({},Object(o.b)(["PAY_MENT","LOGIN_INFO"]),{title:function(){return this.PAY_MENT.vip_promotion||"开通大会员抢先看"}}),methods:{openVip:function(){this.LOGIN_INFO.isLogin?window.showVipPay():S()}}};i(120);function he(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var fe={components:{PayWatchEntry:Yt,VipPlaceholder:Object(mt.a)(pe,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vip-placeholder"},[i("div",{staticClass:"place-holder-title",domProps:{textContent:t._s(t.title)}}),t._v(" "),i("div",{staticClass:"place-holder-tip",domProps:{textContent:t._s(t.PAY_MENT.promotion)}}),t._v(" "),i("div",{staticClass:"place-holder-img"}),t._v(" "),i("div",{staticClass:"pwe-popup-pay",on:{click:t.openVip}},[t._v("立即开通")]),t._v(" "),t.PAY_MENT.vip_first_promotion?i("i",{staticClass:"sale",domProps:{textContent:t._s(t.PAY_MENT.vip_first_promotion)}}):t._e()])},[],!1,null,null,null).exports},props:{limitType:{type:Number,required:!0}},data:function(){return{LIMIT_MAP:{APP_ONLY:1,AREA_LIMIT:2,NOT_START:3,PAY_ONLY:4,VIP_ONLY:5}}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){he(t,e,i[e])})}return t}({},Object(o.b)(["LOGIN_INFO","SS_ID","EP_ID","EP_INFO","PAY_PACK","PAY_MENT","MEDIA_INFO","PUB_INFO","NEWEST_EP","SEASON_FOLLOWED"]),{epStatus:function(){return this.EP_INFO.episode_status||this.MEDIA_INFO.season_status},isAnime:function(){return 1===this.MEDIA_INFO.season_type||4===this.MEDIA_INFO.season_type},btnText:function(){return this.isAnime?this.SEASON_FOLLOWED?"已追番":"<i></i>追番":this.SEASON_FOLLOWED?"已追剧":"<i></i>追剧"},notStartInfo:function(){var t=this.PUB_INFO.pub_time_show||"",e=this.isAnime?"追番":"追剧";return this.isAnime?this.SEASON_FOLLOWED?"".concat(t," 即将开播！<br>敬请期待"):"".concat(t," 即将开播！<br><span>").concat(e,"</span> 即可收到开播提醒哦 ~"):"".concat(t," 即将开播！<br>敬请期待")},payOnlyConfig:function(){return{styleType:"static",price:this.PAY_MENT.price||5,payPackTitle:this.PAY_PACK.title||"",payPackUrl:this.PAY_PACK.pay_pack_url||"",seasonStatus:this.MEDIA_INFO.season_status,promotion:this.PAY_MENT.promotion,seasonId:this.SS_ID,seasonType:this.MEDIA_INFO.season_type||1,isStarted:1,title:this.MEDIA_INFO.title,isfollow:this.SEASON_FOLLOWED,time:this.PUB_INFO.pub_time_show}}}),watch:{limitType:function(){this.$nextTick(function(){this.configChanged()})}},mounted:function(){this.configChanged()},methods:{configChanged:function(){this.limitType===this.LIMIT_MAP.APP_ONLY&&new Qt.a({size:160,background:"#fff",element:this.$refs.qrcode,value:window.location.href})},follow:function(){var t=this;this.LOGIN_INFO.isLogin?(Object(dt.report)({click:this.SEASON_FOLLOWED?"unfollow":"follow"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),H(this.SS_ID,this.MEDIA_INFO.season_type||1,!this.SEASON_FOLLOWED,this.LOGIN_INFO.mid).then(function(e){0===e.code&&t.followCallback(!t.SEASON_FOLLOWED)})):S()},followCallback:function(t){this.$store.dispatch({type:"FOLLOW_STAT_CHANGE",stat:t}),pt.$emit("TRIGGER_FOLLOW_ANIME")},reportPay:function(){Object(dt.report)({click:"pay"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})}}},me=(i(121),Object(mt.a)(fe,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.limitType>0?i("div",{staticClass:"player-limit-wrap"},[t.limitType===t.LIMIT_MAP.AREA_LIMIT?i("div",{staticClass:"limit_area_wrap"},[t._m(0),t._v(" "),i("div",{staticClass:"limit_area_img"})]):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.limitType===t.LIMIT_MAP.APP_ONLY,expression:"limitType === LIMIT_MAP.APP_ONLY"}],staticClass:"limit_app_wrap"},[t._m(1),t._v(" "),i("div",{staticClass:"app_only_qrcode"},[i("div",{staticClass:"qrcode-body"},[i("img",{ref:"qrcode",attrs:{alt:"",src:""}}),t._v(" "),t._m(2)])])]),t._v(" "),t.limitType===t.LIMIT_MAP.NOT_START?i("div",{staticClass:"limit_not_start_wrap"},[i("div",{staticClass:"not_start_info",domProps:{innerHTML:t._s(t.notStartInfo)}}),t._v(" "),i("div",{staticClass:"not_start_img"}),t._v(" "),i("div",{staticClass:"not_start_btn"},[i("span",{class:{follow:!t.SEASON_FOLLOWED,anime:t.isAnime},domProps:{innerHTML:t._s(t.btnText)},on:{click:t.follow}})])]):t._e(),t._v(" "),t.limitType===t.LIMIT_MAP.PAY_ONLY?i("div",{staticClass:"limit-pay-wrap"},[i("pay-watch-entry",{attrs:{"login-info":t.LOGIN_INFO,config:t.payOnlyConfig},on:{"click-pay":t.reportPay,"on-follow":t.followCallback}})],1):t._e(),t._v(" "),t.limitType===t.LIMIT_MAP.VIP_ONLY?i("div",{staticClass:"limit-vip-wrap"},[i("vip-placeholder")],1):t._e()]):t._e()},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"limit_area_info"},[this._v("非常抱歉，根据版权方要求，"),e("br"),this._v("您所在的地区无法观看本片 ~")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app_only_info"},[this._v("\n            应版权方要求，本片仅支持App观看"),e("br"),this._v("请使用\n            "),e("a",{attrs:{href:"//app.bilibili.com",target:"_blank"}},[this._v("哔哩哔哩App")]),this._v("\n            扫描二维码\n        ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",[this._v("没有安装App？\n                    "),e("a",{attrs:{href:"//app.bilibili.com",target:"_blank"}},[this._v("前去下载")])])}],!1,null,null,null).exports),_e={props:{config:Object},mounted:function(){this.$el.innerHTML='<embed height="100%" width="100%" src="//static.hdslb.com/tc.swf" type="application/x-shockwave-flash" pluginspage="//www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" allowscriptaccess="always" rel="noreferrer" quality="high" flashvars="bili-cid='.concat(this.config.cid,"&amp;bili-aid=").concat(this.config.aid,"&amp;vid=").concat(this.config.vid,'" allowfullscreen="true">')}},ve=(i(122),Object(mt.a)(_e,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"qq-player-wrapper"})},[],!1,null,null,null).exports);function ye(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var ge={data:function(){return{isFloat:!1,floatHeight:0,playerLoaded:!1,miniPos:{},startOffset:null,limitType:-1,refreshLimitType:!0}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){ye(t,e,i[e])})}return t}({},Object(o.b)(["VER","MINI_ON","SS_ID","EP_ID","MEDIA_INFO","EP_INFO","USER_STAT","EP_LIST","LOGIN_INFO","PASTER","PUB_INFO","RIGHTS_INFO","AREA","IS_PLAYER_TRIGGER","APP","EP_STAT"]),{hasNextEp:function(){var t=this.EP_LIST.length-1;return t>-1&&this.EP_LIST[t].ep_id!==this.EP_ID},biliplayerParams:function(){var t=2!==this.MEDIA_INFO.season_type,e=this.USER_STAT.watchProgress&&(this.USER_STAT.watchProgress.lastTime||0),i=this.USER_STAT.watchProgress.lastEpId>-1?this.USER_STAT.watchProgress.lastEpId:void 0,n=!this.EP_STAT.isVip&&1!==this.USER_STAT.pay&&1!==this.USER_STAT.sponsor&&this.PASTER.cid&&this.PASTER.cid>0?1:void 0,s=0!==this.EP_INFO.section_type?"":this.MEDIA_INFO.paster_text||"";return{cid:this.EP_INFO.cid,aid:this.EP_INFO.aid,season_type:this.MEDIA_INFO.season_type||1,lastplaytime:this.playerLoaded?void 0:1e3*e,last_ep_id:this.playerLoaded?void 0:i,pre_ad:n,has_next:this.hasNextEp?1:0,as_wide:2===this.MEDIA_INFO.mode?void 0:1,player_type:t?1:2,urlparam:"module=".concat(t?"bangumi":"movie","&season_type=").concat(this.MEDIA_INFO.season_type),seasonId:this.SS_ID,episodeId:this.EP_ID,record:s}},renderPos:function(){return this.MINI_ON&&this.isFloat&&0===this.limitType?this.miniPos:{}}}),watch:{EP_ID:function(){void 0!==this.EP_STAT.status?(this.refreshLimitType=!1,this.limitType=this.getLimitType(),this.checkPlayer()):this.refreshLimitType=!0},EP_STAT:function(){this.refreshLimitType&&(this.refreshLimitType=!1,this.limitType=this.getLimitType(),this.checkPlayer())},MINI_ON:function(){if(this.MINI_ON){this.isFloat=b()>this.floatHeight;var t=setTimeout(function(){window.$&&window.$(window).trigger("scroll"),clearTimeout(t)},10)}}},mounted:function(){var t=this;if(this.$root.$off("RELOAD_PLAYER"),this.$root.$on("RELOAD_PLAYER",function(){if(t.playerLoaded){var e=Object.assign({},t.biliplayerParams);window.oldPgcCommentJump>0&&(e.t=window.oldPgcCommentJump),window.oldPgcCommentJump=0,window.GrayManager.reload(I(e))}}),"undefined"!=typeof window){var e=window.localStorage.b_miniplayer||"0";this.$store.dispatch({type:"CHANGE_MINI_ON",isOn:"1"===e?1:0})}this.miniPos={left:window.document.body.offsetWidth<1400?"".concat(window.document.body.offsetWidth-330,"px"):"".concat(this.getFLoatPos().left,"px"),top:"".concat(T()-450<0?0:T()-450,"px")},this.floatHeight=this.getFLoatPos().top+100,this.bindEvents()},methods:{getFLoatPos:function(t){void 0===t&&(t=this.$el);for(var e=t.offsetTop,i=t.offsetLeft;t.offsetParent;)e+=(t=t.offsetParent).offsetTop+t.clientTop,i+=t.offsetLeft+t.clientLeft;return{top:e+this.$el.offsetHeight,left:i+this.$el.offsetWidth-260}},getLimitType:function(){var t=this.EP_INFO.episode_status||this.MEDIA_INFO.season_status,e=1===this.EP_STAT.status||this.EP_STAT.isPay&&2===this.EP_STAT.status;return 0!==this.AREA?2:this.APP?1:1===this.RIGHTS_INFO.is_preview&&this.EP_LIST.length>0?0:1!==this.PUB_INFO.is_started?this.EP_LIST.length>0?e?13===t?5:4:0:3:e?13===t?5:4:0},checkPlayer:function(){0===this.limitType?this.renderPlayer():(this.$store.dispatch({type:"CHANGE_PLAYER_TRIGGER_STAT",stat:!1}),window.player&&window.player.destroy&&window.player.destroy())},renderPlayer:function(){if("bangumi"===this.EP_INFO.from){var t=Object.assign({},this.biliplayerParams);if(void 0!==window.oldPgcCommentJump?(window.oldPgcCommentJump>0&&(t.t=window.oldPgcCommentJump),window.oldPgcCommentJump=0):(t.t=this.$route.query.t,window.oldPgcCommentJump=0),this.playerLoaded)this.IS_PLAYER_TRIGGER?this.$store.dispatch({type:"CHANGE_PLAYER_TRIGGER_STAT",stat:!1}):window.GrayManager.reload(I(t));else{this.$refs.bofqi.innerHTML='<div id="player_placeholder" class="player"></div>',window.EmbedPlayer("player","//static.hdslb.com/play.swf",I(t),"","",window.playerCallback),this.playerLoaded=!0}var e=setTimeout(function(){window.$&&window.$(window).trigger("scroll"),clearTimeout(e)},10)}},closeMiniPlayer:function(){this.$store.dispatch({type:"CHANGE_MINI_ON",isOn:!1})},mouseDown:function(t){var e={x:"SPAN"===t.target.nodeName.toUpperCase()?t.offsetX+142:t.offsetX,y:t.offsetY};this.startOffset=e},bindEvents:function(){var t=this;pt.$on("RELOAD_PLAYER_SOURCE",function(){0===t.limitType&&window.player1080pCallback&&window.player1080pCallback(!0)}),window.addEventListener("scroll",function(){if("bangumi"!==t.EP_INFO.from||!t.MINI_ON||0===t.floatHeight)return!1;t.isFloat=b()>t.floatHeight},!1),window.addEventListener("mousemove",function(e){if(null!==t.startOffset&&t.isFloat&&t.MINI_ON){var i=e.clientX-t.startOffset.x,n=e.clientY-t.startOffset.y,s=window.document.body.offsetWidth-320,o=T()-270;t.miniPos={left:i<0?0:"".concat(i>s?s:i,"px"),top:n<0?0:"".concat(n>o?o:n,"px")}}},!1),window.addEventListener("mouseup",function(){t.startOffset=null})}},components:{Limit:me,QqPlayerEmbed:ve}},we=(i(123),Object(mt.a)(ge,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["bangumi-player",{"mini-player":t.MINI_ON&&t.isFloat&&0===t.limitType,"no-select":null!==t.startOffset}],style:t.renderPos},[i("div",{directives:[{name:"show",rawName:"v-show",value:"bangumi"===t.EP_INFO.from&&(0===t.limitType||-1===t.limitType),expression:"EP_INFO.from === 'bangumi' && (limitType === 0 || limitType === -1)"}],ref:"bofqi",staticClass:"player-content",attrs:{id:"bofqi"}}),t._v(" "),"qq"===t.EP_INFO.from&&0===t.limitType?i("qq-player-embed",{attrs:{config:t.EP_INFO}}):t._e(),t._v(" "),i("limit",{attrs:{"limit-type":t.limitType}}),t._v(" "),i("div",{class:["mini-player-move",{on:null!==t.startOffset}],on:{mousedown:t.mouseDown}},[i("span",{attrs:{title:"点击按住拖动"}}),i("i",{on:{mousedown:function(t){t.stopPropagation()},click:t.closeMiniPlayer}})]),t._v(" "),i("div",{attrs:{id:"heimu"}})],1)},[],!1,null,null,null).exports);function Ie(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var be={data:function(){return{staticShow:!0,expandShow:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Ie(t,e,i[e])})}return t}({},Object(o.b)(["MEDIA_INFO"]),{stylesRender:function(){return this.MEDIA_INFO.style?this.MEDIA_INFO.style.join("、"):""},staffRender:function(){var t=this.MEDIA_INFO.staff?this.MEDIA_INFO.staff.replace(/(\r\n)|(\n)|(\r)/g,"<br/>"):"",e=this.MEDIA_INFO.staff?this.MEDIA_INFO.staff.replace(/(\r\n)|(\n)|(\r)/g,"/"):"";return e.split("/").length>2?this.MEDIA_INFO.staff?this.staticShow?e:t:"":this.MEDIA_INFO.staff?t:""},actorTitle:function(){return 1===this.MEDIA_INFO.season_type||4===this.MEDIA_INFO.season_type?"声优：":"演员："},actorRender:function(){if(1===this.MEDIA_INFO.season_type||4===this.MEDIA_INFO.season_type){var t=this.MEDIA_INFO.actors?this.MEDIA_INFO.actors.replace(/(\r\n)|(\n)|(\r)/g,"|#|"):"";if(t){for(var e=t.split("|#|"),i=[],n=0;n<e.length;n++)e[n]&&i.push(e[n]);(t=i.join("）/ ")).length>0&&(t=(t+="）").replace(/(：)|(:)/g,"（"))}return t}return this.MEDIA_INFO.actors||""}}),watch:{"MEDIA_INFO.evaluate":{handler:function(t,e){t!==e&&this.$nextTick(function(){this.checkOverflow()})},deep:!0},"MEDIA_INFO.actors":{handler:function(t,e){t!==e&&this.$nextTick(function(){this.checkOverflow()})},deep:!0},staffRender:function(){this.$nextTick(function(){this.checkOverflow()})}},mounted:function(){this.checkOverflow()},methods:{checkOverflow:function(){var t=this.$refs.evaluate.offsetHeight>44,e=this.staffRender.split("/").length>2,i=this.$refs.actors.offsetHeight>44;(t||e||i)&&(this.expandShow=!0)}}},Te=(i(124),Object(mt.a)(be,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bangumi-detail"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.stylesRender,expression:"stylesRender"}],staticClass:"detail-info detail-styles"},[i("label",[t._v("风格：")]),i("span",[t._v(t._s(t.stylesRender))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.staffRender,expression:"staffRender"}],class:["detail-info","detail-staff",{"show-relate":!t.staticShow}]},[i("p",{class:{static:t.staticShow},domProps:{innerHTML:t._s(t.staffRender)}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.MEDIA_INFO.actors,expression:"MEDIA_INFO.actors"}],class:["detail-info","detail-actors",{"show-relate":!t.staticShow}]},[i("label",{domProps:{textContent:t._s(t.actorTitle)}}),i("span",{ref:"actors",style:{opacity:t.staticShow?0:1},domProps:{textContent:t._s(t.actorRender)}}),i("span",{staticClass:"static",style:{opacity:t.staticShow?1:0},domProps:{textContent:t._s(t.actorRender)}})]),t._v(" "),i("div",{staticClass:"detail-evaluate",style:{height:t.staticShow?"44px":"auto"}},[i("label",[t._v("简介：")]),t._v(" "),i("p",{ref:"evaluate",style:{opacity:t.staticShow?0:1,"z-index":t.staticShow?1:2}},[i("span",{domProps:{textContent:t._s(t.MEDIA_INFO.evaluate)}}),i("i",{directives:[{name:"show",rawName:"v-show",value:t.expandShow,expression:"expandShow"}],on:{click:function(){return t.staticShow=!0}}},[t._v("收起")])]),t._v(" "),i("p",{staticClass:"static",style:{opacity:t.staticShow?1:0,"z-index":t.staticShow?2:1}},[i("span",{domProps:{textContent:t._s(t.MEDIA_INFO.evaluate)}}),i("i",{directives:[{name:"show",rawName:"v-show",value:t.expandShow,expression:"expandShow"}],on:{click:function(){return t.staticShow=!1}}},[t._v("展开")])])])])},[],!1,null,null,null).exports),Oe={props:{state:{default:"loading"},data:{}},computed:{source:function(){var t=Object.prototype.toString;return"[object Array]"===t.call(this.data)?0!==this.data.length:"[object Object]"===t.call(this.data)?!w(this.data):void 0}},methods:{reloads:function(){this.$emit("reload")}}},Ce=(i(125),Object(mt.a)(Oe,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.source?t._e():i("div",{staticClass:"load-state"},["loading"===t.state?i("span",{staticClass:"loading"},[t._v("正在加载...")]):t._e(),t._v(" "),"error"===t.state?i("span",{staticClass:"error"},[t._v("加载失败，\n        "),i("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.reloads()}}},[t._v("点击重试")])]):t._e(),t._v(" "),"loaded"===t.state?i("span",{staticClass:"empty"},[t._v("没有数据(-_-#)")]):t._e()])},[],!1,null,null,null).exports),Se=!1,Ee={data:function(){return{startX:0,startStamp:0,moveStamp:0,moving:!1,distanceX:0,offsetX:0,wrapperW:0,contentW:0,timer:null}},props:{autoIndex:{type:Number,default:0},length:{type:Number,required:!0},slideType:{type:String,default:"touch"},canReset:{type:Boolean,default:!1},canEnd:{type:Boolean,default:!1},skew:{type:Number,default:0},disabledResize:{type:Boolean,default:!1},prePage:{type:Boolean,default:!1},nextPage:{type:Boolean,default:!1},detailMode:{type:Boolean,default:!0},hasSlider:{type:Boolean,default:!0}},computed:{sliderMax:function(){return this.wrapperW-this.contentW},needSlide:function(){return this.contentW>this.wrapperW},slideWidth:function(){return this.wrapperW-this.skew}},watch:{autoIndex:function(){this.$nextTick(function(){this.handerResize()})},distanceX:function(){var t=this.offsetX+this.distanceX;t=(t=t<=0?t:0)>=this.sliderMax?t:this.sliderMax,0!==this.distanceX&&(this.moving=!0,this.moveContent(t))}},mounted:function(){var t=this;this.canReset&&(pt.$on("RESET_SLIDER_STAT",function(){t.$el.children[0].children[0]&&(t.$el.children[0].children[0].style.transition="none",t.moveContent(0,!0),t.offsetX=0,setTimeout(function(){t.$el.children[0].children[0].style.transition="transform .3s ease"},100))}),pt.$on("SLIDER_TO_INDEX",function(){if(t.autoIndex>0){var e=-(t.contentW/t.length)*(t.autoIndex-.2);t.offsetX=e<t.sliderMax?t.sliderMax:e,t.moveContent(t.offsetX)}else t.$el.children[0].children[0]&&(t.$el.children[0].children[0].style.transition="none",t.moveContent(0,!0),t.offsetX=0,setTimeout(function(){t.$el.children[0].children[0].style.transition="transform .3s ease"},100))})),this.canEnd&&pt.$on("SLIDER_TO_END",function(){t.$el.children[0].children[0]&&(t.$el.children[0].children[0].style.transition="none",t.moveContent(t.sliderMax,!0),t.offsetX=t.sliderMax,setTimeout(function(){t.$el.children[0].children[0].style.transition="transform .3s ease"},100))}),this.wrapperW=this.$el.offsetWidth,window.addEventListener("resize",this.handerResize,!1)},updated:function(){if(this.detailMode){if(this.contentW=this.$el.children[0].children[0].scrollWidth,!Se&&this.needSlide&&this.autoIndex>0){var t=-(this.contentW/this.length)*(this.autoIndex-.2);this.offsetX=t<this.sliderMax?this.sliderMax:t,this.moveContent(this.offsetX),Se=!0}this.$emit("ready",this.needSlide)}},methods:{handerResize:function(){if(this.detailMode)if(this.wrapperW=this.$el.offsetWidth,this.contentW=this.$el.children[0].children[0].scrollWidth,this.needSlide&&this.autoIndex>0){var t=-(this.contentW/this.length)*(this.autoIndex-.2);this.offsetX=t<this.sliderMax?this.sliderMax:t,this.moveContent(this.offsetX)}else this.needSlide&&!this.disabledResize&&(this.offsetX=0,this.moveContent(0))},touchStart:function(t){"touch"===this.slideType&&(this.clearTimer(),this.initData(),this.needSlide&&1===t.touches.length&&(document.body.addEventListener("touchmove",this.preventScroll,!!window.supportPassive&&{passive:!1}),this.startStamp=t.timeStamp,this.startX=t.touches[0].clientX))},touchMove:function(t){this.needSlide&&0!==this.startX&&"touch"===this.slideType&&(this.moveStamp=t.timeStamp,this.distanceX=t.changedTouches[0].clientX-this.startX)},touchEnd:function(t){var e=this;if("touch"===this.slideType){if(this.needSlide&&t.timeStamp-this.moveStamp<30){var i=this.distanceX/(t.timeStamp-this.startStamp);this.autoSlide(i,function(){e.initData()})}else this.initData();document.body.removeEventListener("touchmove",this.preventScroll,!!window.supportPassive&&{passive:!1})}},slidePrev:function(){var t=this;this.offsetX<0&&null===this.timer?(this.distanceX=this.slideWidth,this.timer=setTimeout(function(){t.offsetX+=t.slideWidth,t.offsetX>0&&(t.offsetX=0),t.distanceX=0,t.clearTimer()},300)):this.prePage&&this.$emit("pagepre")},slideNext:function(){var t=this;this.offsetX>this.sliderMax&&null===this.timer?(this.distanceX=-this.slideWidth,this.timer=setTimeout(function(){t.offsetX-=t.slideWidth,t.offsetX<t.sliderMax&&(t.offsetX=t.sliderMax),t.distanceX=0,t.clearTimer()},300)):this.nextPage&&this.$emit("pagenext")},clearTimer:function(){this.timer&&clearInterval(this.timer),this.timer=null},autoSlide:function(t,e){var i=this;if(!this.timer){var n=Math.abs(t);this.timer=setInterval(function(){t>0?(i.distanceX=i.distanceX+35*t,(t-=n/35)<=0&&(t=0)):t<0?(i.distanceX=i.distanceX+35*t,(t+=n/35)>=0&&(t=0)):(e&&e(),i.clearTimer())},10)}},moveContent:function(t,e){this.$el.children[0].children[0]&&(this.$el.children[0].children[0].style.transform="translateX(".concat(t,"px)"),this.$el.children[0].children[0].style.webkitTransform="translateX(".concat(t,"px)")),this.$el.children[1].children[0].style.left="".concat(t/this.sliderMax*(this.wrapperW-90),"px")},initData:function(){this.startStamp=0,this.moveStamp=0;var t=this.offsetX+this.distanceX;this.distanceX>0?this.offsetX=t<=0?t:0:this.offsetX=t>=this.sliderMax?t:this.sliderMax,this.distanceX=0,this.startX=0,this.moving=!1},preventScroll:function(t){t.cancelable&&!t.defaultPrevented&&t.preventDefault()}}},Ne=(i(126),Object(mt.a)(Ee,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"slider-wrapper"},[i("div",{staticClass:"slider-content",on:{touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd}},[t._t("default")],2),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasSlider,expression:"hasSlider"}],staticClass:"slider-contro clearfix"},[i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.needSlide&&t.moving&&"touch"===t.slideType,expression:"needSlide && moving && slideType === 'touch'"}],staticClass:"contro-item"})]),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.detailMode&&(t.needSlide||t.prePage)&&"click"===t.slideType,expression:"detailMode && (needSlide || prePage) && slideType === 'click'"}],class:["slider-prev",{disabled:0===t.offsetX&&!t.prePage}],on:{click:t.slidePrev}}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.detailMode&&(t.needSlide||t.prePage)&&"click"===t.slideType&&t.offsetX<0,expression:"detailMode && (needSlide || prePage) && slideType === 'click' && offsetX < 0"}],staticClass:"slider-prev-mask"}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.detailMode&&(t.needSlide||t.nextPage)&&"click"===t.slideType,expression:"detailMode && (needSlide || nextPage) && slideType === 'click'"}],class:["slider-next",{disabled:t.offsetX===t.sliderMax&&!t.nextPage}],on:{click:t.slideNext}}),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.detailMode&&(t.needSlide||t.nextPage)&&"click"===t.slideType&&t.offsetX>t.sliderMax,expression:"detailMode && (needSlide || nextPage) && slideType === 'click' && offsetX > sliderMax"}],staticClass:"slider-next-mask"})],1)])},[],!1,null,null,null).exports),Me={props:{ssData:{type:Object,required:!0},current:{type:Number,required:!0}},methods:{seasonChange:function(){this.$emit("change",Number(this.ssData.season_id))}}},Pe=(i(127),Object(mt.a)(Me,function(){var t=this.$createElement;return(this._self._c||t)("li",{class:["season-item",{on:Number(this.ssData.season_id)===this.current}],attrs:{"report-id":"click_season"},domProps:{textContent:this._s(this.ssData.season_title)},on:{click:this.seasonChange}})},[],!1,null,null,null).exports);function Ae(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var ke={props:{epData:{type:Object,required:!0},mode:{type:Number,required:!0}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Ae(t,e,i[e])})}return t}({},Object(o.b)(["EP_ID","SS_ID","MEDIA_INFO"]),{epIndex:function(){return V(this.epData.index,this.MEDIA_INFO.season_type)},epIndexRender:function(){return 1===this.mode?this.epIndex:this.epData.index},domTitle:function(){return this.epData.index_title?"".concat(this.epIndex,"：").concat(this.epData.index_title):this.epIndex},epTitle:function(){return this.epData.index_title||"#".concat(this.epIndexRender)},badgeIcon:function(){if(0===this.epData.badge_type){if("抢先"===this.epData.badge)return"badge-pink-first";if("付费"===this.epData.badge)return"badge-pink-pay";if("会员"===this.epData.badge)return"badge-pink-vip"}if(2===this.epData.badge_type){if("抢先"===this.epData.badge)return"badge-orange-first";if("付费"===this.epData.badge)return"badge-orange-pay"}return""}}),methods:{epChange:function(){this.epData.ep_id!==this.EP_ID&&(Object(dt.report)({click:"ep"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title,url:"".concat(window.location.protocol,"//www.bilibili.com/bangumi/play/ep").concat(this.epData.ep_id,"/")}),this.$router.push({name:"webplay",params:{id:"ep".concat(this.epData.ep_id)}}))}}},De=(i(128),Object(mt.a)(ke,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{directives:[{name:"show",rawName:"v-show",value:-1!==t.mode,expression:"mode !== -1"}],class:["episode-item",{on:t.epData.ep_id===t.EP_ID,simple:2===t.mode}],attrs:{title:t.domTitle,"report-id":"click_ep"},on:{click:t.epChange}},[i("h4",{staticClass:"ep-index",domProps:{textContent:t._s(t.epIndexRender)}}),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:1===t.mode,expression:"mode === 1"}],staticClass:"ep-title",domProps:{textContent:t._s(t.epTitle)}}),t._v(" "),t.epData.badge?i("span",{class:["mark-icon",{pink:0===t.epData.badge_type,blue:1===t.epData.badge_type,yellow:2===t.epData.badge_type}],domProps:{textContent:t._s(t.epData.badge)}}):t._e()])},[],!1,null,null,null).exports),Ue={data:function(){return{pageSize:103,position:2}},props:{shown:{type:Boolean,required:!0},list:{type:Array,required:!0},page:{type:Number,required:!0}},computed:{splitList:function(){for(var t=Math.ceil(this.list.length/this.pageSize),e=[],i=0;i<t;i++)i===t-1?e.push("".concat(this.pageSize*i+1,"-").concat(this.list.length)):e.push("".concat(this.pageSize*i+1,"-").concat(this.pageSize*(i+1)));return e}},watch:{shown:function(){this.shown&&this.checkPosition()}},mounted:function(){this.checkPosition(),window.addEventListener("resize",this.checkPosition,!1),window.addEventListener("click",this.clickHandler,!1)},destroyed:function(){window.removeEventListener("resize",this.checkPosition,!1),window.removeEventListener("click",this.clickHandler,!1)},methods:{changePage:function(t){this.$emit("change",t)},checkPosition:function(){var t=this.getBtnPos();(window.document.documentElement.clientWidth||window.document.body.clientWidth)-t>(this.splitList.length>2?370:282)?this.position=2:this.position=1},getBtnPos:function(){for(var t=window.document.querySelector(".btn-episode-more"),e=t.offsetLeft;t.offsetParent;)e+=(t=t.offsetParent).offsetLeft+t.clientLeft;return e+68},clickHandler:function(t){this.$emit("hidden")}}},xe=(i(129),Object(mt.a)(Ue,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.shown,expression:"shown"}],class:["simple-pages-wrapper",{left:1===t.position,right:2===t.position,small:2===t.splitList.length}]},[i("ul",{staticClass:"list-container"},t._l(t.splitList,function(e,n){return i("li",{key:n,class:["page-item",{on:n===t.page}],domProps:{textContent:t._s(e)},on:{click:function(e){return t.changePage(n)}}})}),0)])},[],!1,null,null,null).exports);function je(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Le={data:function(){return{modes:[{key:1,name:"详细模式",className:"detail-mode"},{key:2,name:"精简模式",className:"simple-mode"}],modeSelected:-1,modeSelectTimer:null,selectId:null,epCache:{},state:"loaded",loadingSource:[""],ssCurrentIndex:0,epCurrentIndex:0,simplePage:0,simpleFPage:0,simplePageSize:103,pageSelectShow:!1,timer:null}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){je(t,e,i[e])})}return t}({},Object(o.b)(["EP_ID","SS_ID","EP_LIST","SEASON_LIST","MEDIA_INFO"]),{seasonId:function(){return null===this.selectId?this.SS_ID:this.selectId},canSelectPage:function(){var t=this.epCache[this.seasonId]||[];return 2===this.modeSelected&&t.length>this.simplePageSize},hasPrePage:function(){return this.simplePage>0},hasNextPage:function(){var t=this.epCache[this.seasonId]||[];return(this.simplePage+1)*this.simplePageSize<t.length},selectEpList:function(){var t=this.epCache[this.seasonId]||[];return t.length>this.simplePageSize&&(t=t.slice(this.simplePage*this.simplePageSize,(this.simplePage+1)*this.simplePageSize)),t},renderSeasonList:function(){return this.SEASON_LIST.length>0?this.SEASON_LIST:this.MEDIA_INFO.season_title?[{season_id:this.SS_ID,season_title:this.MEDIA_INFO.season_title}]:[]},hasTitle:function(){var t=!1;return this.EP_LIST.forEach(function(e,i){""!==e.index_title&&(t=!0)}),t}}),watch:{modeSelected:function(){2===this.modeSelected?pt.$emit("RESET_SLIDER_STAT"):this.simplePage===this.simpleFPage&&setTimeout(function(){pt.$emit("SLIDER_TO_INDEX")},200)},EP_ID:function(){var t=this;this.EP_ID>-1&&this.EP_LIST.forEach(function(e,i){e.ep_id===t.EP_ID&&(t.epCurrentIndex=i%103,t.simplePage=t.simpleFPage=Math.floor(i/t.simplePageSize))})}},created:function(){this.$set(this.epCache,this.SS_ID,this.EP_LIST)},mounted:function(){var t=this;this.SEASON_LIST.forEach(function(e,i){Number(e.season_id)===t.SS_ID&&(t.ssCurrentIndex=i)}),this.EP_ID>-1&&this.EP_LIST.forEach(function(e,i){e.ep_id===t.EP_ID&&(t.epCurrentIndex=i%103,t.simplePage=t.simpleFPage=Math.floor(i/t.simplePageSize))}),this.loopEpList()},methods:{btnMoreEnter:function(){this.pageSelectShow=!0,null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},btnMoreLeave:function(){var t=this;this.timer=setTimeout(function(){t.pageSelectShow=!1},1e3)},hiddenPage:function(){this.pageSelectShow=!1,null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},slidePage:function(t){1===t?(pt.$emit("RESET_SLIDER_STAT"),this.pageChange(this.simplePage+1)):(pt.$emit("SLIDER_TO_END"),this.pageChange(this.simplePage-1))},pageChange:function(t){t!==this.simplePage&&(this.simplePage=t)},modeChange:function(t){var e=this;null===this.modeSelectTimer&&t!==this.modeSelected&&(Object(dt.report)({click:"ep_switch"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),this.modeSelected=t,this.modeSelectTimer=setTimeout(function(){clearTimeout(e.modeSelectTimer),e.modeSelectTimer=null},300))},seasonChange:function(t){var e=this;t!==this.seasonId&&(Object(dt.report)({click:"season"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title,url:"".concat(window.location.protocol,"//www.bilibili.com/bangumi/play/ss").concat(t,"/")}),t===this.SS_ID?(this.EP_LIST.forEach(function(t,i){t.ep_id===e.EP_ID&&(e.simplePage=Math.floor(i/e.simplePageSize))}),1===this.modeSelected&&setTimeout(function(){pt.$emit("SLIDER_TO_INDEX")},200)):(this.simplePage=0,pt.$emit("RESET_SLIDER_STAT")),this.selectId=t,this.epCache[t]||this.loadEpList())},loadEpList:function(){var t=this;this.state="loading",this.loadingSource=[],this.$store.dispatch({type:"FETCH_MEDIA_INFO",epOnly:!0,viewType:"ss",id:this.selectId}).then(function(e){t.$set(t.epCache,t.selectId,e),t.loadingSource=[""],t.state="loaded"}).catch(function(){t.loadingSource=[],t.state="error"})},loopEpList:function(){var t=window.innerWidth>=1400?13:11;!this.hasTitle&&this.EP_LIST.length<=4*t?this.modeSelected=2:this.modeSelected=1}},components:{ListSlider:Ne,SeasonItem:Pe,EpisodeItem:De,SimplePages:xe,Loading:Ce}},Fe=(i(130),Object(mt.a)(Le,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bangumi-list-wrapper"},[i("div",{staticClass:"top-block"},[i("div",{staticClass:"ss-list-wrapper"},[i("list-slider",{attrs:{"slide-type":"click","auto-index":t.ssCurrentIndex,length:t.SEASON_LIST.length,skew:66}},[i("ul",{staticClass:"season-list"},t._l(t.renderSeasonList,function(e,n){return i("season-item",{key:n,attrs:{"ss-data":e,current:t.seasonId},on:{change:t.seasonChange}})}),1)])],1),t._v(" "),i("ul",{staticClass:"mode-select clearfix"},t._l(t.modes,function(e,n){return i("li",{key:n,class:[e.className,{selected:e.key===t.modeSelected}],attrs:{title:e.name,"report-id":"click_ep_switch"},on:{click:function(i){return t.modeChange(e.key)}}})}),0)]),t._v(" "),i("div",{class:["bottom-block",{"overflow-show":2===t.modeSelected}]},[i("list-slider",{attrs:{"can-reset":!0,"can-end":!0,"slide-type":"click","auto-index":t.epCurrentIndex,length:t.selectEpList.length,"pre-page":t.hasPrePage,"next-page":t.hasNextPage,"detail-mode":1===t.modeSelected,skew:128},on:{pagepre:function(e){return t.slidePage(0)},pagenext:function(e){return t.slidePage(1)}}},[i("ul",{class:["episode-list",{breakline:2===t.modeSelected}]},[t._l(t.selectEpList,function(e,n){return i("episode-item",{key:n,attrs:{"ep-data":e,mode:t.modeSelected}})}),t._v(" "),i("loading",{attrs:{state:t.state,data:t.loadingSource},on:{reload:t.loadEpList}}),t._v(" "),i("li",{directives:[{name:"show",rawName:"v-show",value:t.canSelectPage,expression:"canSelectPage"}],staticClass:"btn-episode-more",on:{mouseenter:t.btnMoreEnter,mouseleave:t.btnMoreLeave}},[i("span",[t._v("全部 >")]),t._v(" "),i("simple-pages",{attrs:{shown:t.pageSelectShow,list:t.epCache[t.seasonId]||[],page:t.simplePage},on:{change:t.pageChange,hidden:t.hiddenPage}})],1)],2)])],1)])},[],!1,null,null,null).exports);function Re(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var $e={computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Re(t,e,i[e])})}return t}({},Object(o.b)(["SS_ID","EP_ID","MEDIA_INFO","EP_INFO"]),{shareParams:function(){return{name:this.MEDIA_INFO.title,title:"".concat(G(this.EP_INFO.index,this.MEDIA_INFO.title,this.EP_INFO.index_title,2===this.MEDIA_INFO.mode,this.MEDIA_INFO.season_type)," #哔哩哔哩#"),pic:this.MEDIA_INFO.cover,url:"https://www.bilibili.com/bangumi/play/ss".concat(this.SS_ID,"/"),baidu:{title:"转帖：".concat(G(this.EP_INFO.index,this.MEDIA_INFO.title,this.EP_INFO.index_title,2===this.MEDIA_INFO.mode,this.MEDIA_INFO.season_type)," #哔哩哔哩#")}}}}),methods:{reportHandler:function(t){Object(dt.report)({click:"share_".concat(t)},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})},reportQrcode:function(){Object(dt.report)({click:"qrcode"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})}}},Je=(i(131),Object(mt.a)($e,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"share-module"},[i("ul",{directives:[{name:"share",rawName:"v-share",value:t.shareParams,expression:"shareParams"}],staticClass:"share-list clearfix"},[i("li",{staticClass:"share-btn btn-app",attrs:{"share-type":"app","report-id":"click_qrcode"},on:{mouseenter:t.reportQrcode}}),t._v(" "),i("li",{staticClass:"share-btn btn-weibo",attrs:{"share-type":"weibo","report-id":"click_share_weibo"},on:{click:function(e){return t.reportHandler("weibo")}}}),t._v(" "),i("li",{staticClass:"share-btn btn-qqzone",attrs:{"share-type":"qqzone","report-id":"click_share_qqzone"},on:{click:function(e){return t.reportHandler("qqzone")}}}),t._v(" "),i("li",{staticClass:"share-btn btn-qq",attrs:{"share-type":"qq","report-id":"click_share_qq"},on:{click:function(e){return t.reportHandler("qq")}}}),t._v(" "),i("li",{staticClass:"share-btn btn-baidu",attrs:{"share-type":"baidu","report-id":"click_share_tieba"},on:{click:function(e){return t.reportHandler("tieba")}}})])])},[],!1,null,null,null).exports);function Ge(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Ve={data:function(){return{timer:null,adTipShow:!1,adTipData:{link:"javascript:;",title:""}}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Ge(t,e,i[e])})}return t}({},Object(o.b)(["SPECIAL","LOGIN_INFO","SS_ID","MD_ID","EP_ID","MEDIA_INFO","EP_LIST","SEASON_FOLLOWED","SEASON_LIST","UP_INFO","PASTER"]),{ratio:function(){return this.hd?y():2},imgSrc:function(){return v(this.MEDIA_INFO.cover,Math.ceil(120*this.ratio),Math.ceil(160*this.ratio))},followType:function(){return 1!==this.MEDIA_INFO.season_type&&4!==this.MEDIA_INFO.season_type?1:0},followBtnText:function(){return 0===this.followType?this.SEASON_FOLLOWED?"已追番":"追番":this.SEASON_FOLLOWED?"已追剧":"追剧"},bangumiListShow:function(){return(this.SEASON_LIST.length>1||2===this.MEDIA_INFO.mode&&this.EP_LIST.length>0)&&!this.MEDIA_INFO.bkg_cover},bangumiDetailLink:function(){return"//www.bilibili.com/bangumi/media/md".concat(this.MD_ID,"/")}}),mounted:function(){this.loadAdOperation()},methods:{followHandler:function(){var t=this;if(!this.LOGIN_INFO.isLogin)return S(),!1;null===this.timer&&(this.lockTimer(2e3),H(this.SS_ID,this.MEDIA_INFO.season_type||1,!this.SEASON_FOLLOWED,this.LOGIN_INFO.mid).then(function(e){0===e.code&&(t.$store.dispatch({type:"FOLLOW_STAT_CHANGE",stat:!t.SEASON_FOLLOWED}),pt.$emit("TRIGGER_FOLLOW_ANIME"),Object(dt.report)({click:t.SEASON_FOLLOWED?"follow":"unfollow"},{season_id:t.SS_ID,ep_id:t.EP_ID,businesstype:t.MEDIA_INFO.season_type,title:t.MEDIA_INFO.title}))}))},lockTimer:function(t){var e=this;this.timer=setTimeout(function(){clearTimeout(e.timer),e.timer=null},t)},loadAdOperation:function(){var t=this;this.PASTER.cid&&this.PASTER.cid>0&&21453565===this.UP_INFO.mid&&at({url:"pgc/operation/api/static",params:{position_id:343}}).then(function(e){if(200===e.status&&e.data&&0===e.data.code&&e.data.result&&e.data.result[0]){var i=e.data.result[0];t.adTipData={link:i.link?_(i.link):"",title:i.title},t.adTipShow=!0}})}},components:{Detail:Te,BangumiList:Fe,Share:Je,BreadThumb:Dt,BangumiCount:Vt}},He=(i(132),Object(mt.a)(Ve,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bangumi-info clearfix"},[i("div",{staticClass:"info-cover"},[i("a",{attrs:{href:t.bangumiDetailLink,target:"_blank"}},[i("img",{class:{empty:!t.imgSrc},attrs:{src:t.imgSrc,alt:""}})])]),t._v(" "),i("div",{staticClass:"info-right"},[i("div",{staticClass:"info-title clearfix"},[i("a",{attrs:{href:t.bangumiDetailLink,target:"_blank"}},[i("h2",{domProps:{textContent:t._s(t.MEDIA_INFO.title)}})]),t._v(" "),i("div",{staticClass:"func-module clearfix"},[i("div",{staticClass:"bangumi-btn"},[t.SPECIAL?t._e():i("div",{class:[{"btn-follow":0===t.followType||1===t.followType,followed:t.SEASON_FOLLOWED}],attrs:{"report-id":t.SEASON_FOLLOWED?"click_unfollow":"click_follow"},on:{click:t.followHandler}},[i("i"),t._v(t._s(t.followBtnText))])]),t._v(" "),i("share")],1)]),t._v(" "),t.SPECIAL?i("div",{staticClass:"special-wrapper"},[i("bread-thumb"),t._v(" "),i("bangumi-count")],1):t._e(),t._v(" "),t.bangumiListShow?t._e():i("detail"),t._v(" "),t.bangumiListShow?i("bangumi-list"):t._e()],1),t._v(" "),t.adTipShow?i("div",{staticClass:"tokyo-ad-wrapper"},[i("a",{attrs:{href:t.adTipData.link,target:"javascript:;"===t.adTipData.link?"_self":"_blank"}},[i("i",{staticClass:"speaker"}),i("span",{domProps:{textContent:t._s(t.adTipData.title)}})])]):t._e()])},[],!1,null,null,null).exports);function Be(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var qe={props:{recomData:{type:Object,required:!0},align:{type:Boolean,required:!0},index:{type:Number,required:!0}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Be(t,e,i[e])})}return t}({},Object(o.b)(["SS_ID","EP_ID","MEDIA_INFO"]),{hrefLink:function(){return"//www.bilibili.com/video/av".concat(this.recomData.aid)},viewCount:function(){return C(this.recomData.stat?this.recomData.stat.view:0)},danmuCount:function(){return C(this.recomData.stat?this.recomData.stat.danmaku:0)}}),methods:{reportHandler:function(){Object(dt.report)({click:"recommend_video"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title,ord_id:this.index+1,url:"".concat(window.location.protocol,"//www.bilibili.com/video/av").concat(this.recomData.aid)})}},components:{LazyImg:yt}},We=(i(133),Object(mt.a)(qe,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{class:["recom-item",{align:t.align}]},[i("a",{attrs:{href:t.hrefLink,target:"_blank",title:t.recomData.title},on:{click:t.reportHandler}},[i("div",{staticClass:"recom-img"},[i("lazy-img",{attrs:{src:t.recomData.pic,alt:t.recomData.title,width:t.align?180:112,height:t.align?112:70}})],1),t._v(" "),i("div",{staticClass:"recom-info"},[i("div",{staticClass:"info-title",domProps:{textContent:t._s(t.recomData.title)}}),t._v(" "),i("div",{staticClass:"info-count"},[i("div",{staticClass:"play-count"},[i("i"),i("span",{domProps:{textContent:t._s(t.viewCount)}})]),t._v(" "),i("div",{staticClass:"danmu-count"},[i("i"),i("span",{domProps:{textContent:t._s(t.danmuCount)}})])])])])])},[],!1,null,null,null).exports);function Qe(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Xe={props:{align:{type:Boolean,default:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){Qe(t,e,i[e])})}return t}({},Object(o.b)(["RECOM_LIST"])),components:{RecomItem:We}},Ye=(i(134),Object(mt.a)(Xe,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["bangumi-recom",{align:t.align}]},[i("h4",{staticClass:"recom-title"},[t._v("相关视频推荐")]),t._v(" "),i("ul",{staticClass:"recom-list clearfix"},t._l(t.RECOM_LIST,function(e,n){return i("recom-item",{key:n,attrs:{index:n,"recom-data":e,align:t.align}})}),1)])},[],!1,null,null,null).exports);function ze(t){return t.setTime(t.getTime()+60*(t.getTimezoneOffset()+480)*1e3),t}var Ke={data:function(){return{twoLineTitle:!1}},props:{data:{type:Object,required:!0},mediaId:{type:Number,required:!0}},computed:{starScore:function(){var t=this.data.user_rating&&this.data.user_rating.score&&this.data.user_rating.score||0;return Math.round(t)},stars:function(){var t=[{type:"empty"},{type:"empty"},{type:"empty"},{type:"empty"},{type:"empty"}];if(0===this.starScore)return t;for(var e=0;e<10;e++)e<2?t[Math.floor(e/2)].type="full":e<this.starScore&&(t[Math.floor(e/2)].type=e%2==0?"half":"full");return t},reviewLink:function(){return this.data.title?"/read/cv".concat(this.data.article_id):"/bangumi/media/md".concat(this.mediaId,"/#short")},authorName:function(){return this.data.author&&this.data.author.uname?this.data.author.uname:""},authorSpace:function(){var t=this.data.author?this.data.author.mid:"";return t?"//space.bilibili.com/".concat(t):"javascript:;"},mediaName:function(){var t=this.data.media&&this.data.media.title?this.data.media.title:"";return t?"评 ".concat(t):""},mediaUrl:function(){var t=this.data.media&&this.data.media.media_id?this.data.media.media_id:-1;return t>-1?"/bangumi/media/md".concat(t):"javascript:;"},pubTime:function(){return function(t){var e=ze(new Date),i=e.getTime()-t.getTime(),n=ze(new Date(e.getTime()-864e5)),s=ze(new Date("".concat(n.getFullYear(),"/").concat(n.getMonth()+1,"/").concat(n.getDate()," 00:00:00")));return i<6e4?"刚刚":i<36e5?"".concat(Math.round(i/6e4),"分钟前"):i<864e5?"".concat(Math.round(i/36e5),"小时前"):t.getTime()>s.getTime()?"昨天":function(t,e,i,n,s){e=void 0===e?"/":e,n=void 0!==n;var o=t.getFullYear(),a=t.getMonth()+1,r=t.getDate();if(n&&(a=a<10?"0".concat(a):a.toString(),r=r<10?"0".concat(r):r.toString()),i){var c=t.getHours(),l=t.getMinutes();return n&&(c=c<10?"0".concat(c):c.toString(),l=l<10?"0".concat(l):l.toString()),(s?o+e:"")+a+e+r+" "+c+":"+l}return(s?o+e:"")+a+e+r}(t,"-",!1,!0,e.getFullYear()!==t.getFullYear())}(new Date(1e3*(this.data.mtime||0)))},reviewContent:function(){var t=this.data.content.replace(/(\r\n)|(\n)|(\r)/g," ").replace(/\t/g," ");return t.length>500?t.substr(0,500):t},isVip:function(){return this.data&&this.data.author&&this.data.author.vip&&1===this.data.author.vip.vipStatus&&2===this.data.author.vip.vipType},themeCls:function(){if(this.isVip&&1===(this.data.author.vip.themeType||0))return"festival-theme-v1";return""}},watch:{"data.title":{handler:function(t,e){t!==e&&this.$nextTick(function(){this.twoLineTitle=this.verfiyTitleLine()})},deep:!0}},mounted:function(){this.verfiyTitleLine()&&(this.twoLineTitle=!0)},methods:{verfiyTitleLine:function(){return this.$refs.title&&this.$refs.title.offsetHeight>24},reportHandler:function(){Object(dt.report)({click:"review_detail"},{media_id:this.mediaId,title:this.data.title,url:encodeURIComponent("//www.bilibili.com".concat(this.reviewLink))})}}},Ze=(i(135),Object(mt.a)(Ke,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"bangumi-review-item"},[i("a",{attrs:{href:t.reviewLink,target:"_blank"},on:{click:t.reportHandler}},[i("div",{staticClass:"item-header"},[i("a",{class:["author-name",{"is-vip":t.isVip},t.themeCls],attrs:{href:t.authorSpace,target:"javascript:;"===t.authorSpace?"_self":"_blank"},domProps:{textContent:t._s(t.authorName)},on:{click:function(t){t.stopPropagation()}}}),t._v(" "),i("ul",{staticClass:"item-star-wrapper clearfix"},t._l(t.stars,function(e,n){return i("li",{key:n,class:["icon-star",{"icon-star-light":"full"===e.type,"icon-star-half":"half"===e.type}]},["half"===e.type?i("i",{staticClass:"path2"}):t._e()])}),0),t._v(" "),i("span",{staticClass:"pub-time",domProps:{textContent:t._s(t.pubTime)}})]),t._v(" "),t.data.title?i("div",{ref:"title",staticClass:"long-title",domProps:{textContent:t._s(t.data.title)}}):t._e(),t._v(" "),i("p",{class:["review-content",{long:t.data.title,smaller:t.twoLineTitle}],domProps:{textContent:t._s(t.reviewContent)}})])])},[],!1,null,null,null).exports);function ti(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var ei={data:function(){return{loaded:!1,shortList:[],longList:[]}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){ti(t,e,i[e])})}return t}({},Object(o.b)(["RIGHTS_INFO","MD_ID","MEDIA_RATING","PUB_INFO","CAN_REVIEW","LOGIN_INFO","APP"]),{showMedia:function(){return 1===this.RIGHTS_INFO.allow_review&&!this.APP},mediaLink:function(){return this.MD_ID>-1?"/bangumi/media/md".concat(this.MD_ID,"/"):"javascript:;"},renderScore:function(){var t=this.MEDIA_RATING.score||0;return 0===t?"暂无评分":t.toFixed(1)},starScore:function(){var t=this.MEDIA_RATING.score||0;return Math.round(t)},stars:function(){var t=[{type:"empty"},{type:"empty"},{type:"empty"},{type:"empty"},{type:"empty"}];if(0===this.starScore)return t;for(var e=0;e<10;e++)e<2?t[Math.floor(e/2)].type="full":e<this.starScore&&(t[Math.floor(e/2)].type=e%2==0?"half":"full");return t},renderCount:function(){var t=this.MEDIA_RATING.count||0;return t>0?"".concat(C(t),"人评分"):1===this.PUB_INFO.is_started?"人数不足":"未开播"},renderList:function(){var t=this.longList;return t.length<3&&this.shortList.forEach(function(e){t.push(e)}),t.length>3?t.slice(0,3):t}}),watch:{MD_ID:function(){this.getData()}},mounted:function(){var t=this;this.getData(),this.$root.$on("REVIEW_OPEN_SUCCESS",function(){t.$store.dispatch({type:"USER_OPEN_CHANGE",isOpen:!0}),t.$root.$emit("TRIGGER_SHORT_REVIEW",!0)}),this.$root.$on("SHORT_REVIEW_SUCCESS",function(e){t.$store.dispatch({type:"SHORT_REVIEW_CHANGE",result:e})})},methods:{verifyOpen:function(t){if(!t.isTrusted)return!1;Object(dt.report)({click:"review_publish"}),this.LOGIN_INFO.isLogin?this.CAN_REVIEW?this.$root.$emit("TRIGGER_SHORT_REVIEW",!0):this.$root.$emit("TRIGGER_REVIEW_OPEN",!0):S()},getData:function(){var t=this;this.MD_ID>-1&&this.showMedia&&this.$store.dispatch({type:"FETCH_REVIEW_DATA",mediaId:this.MD_ID}).then(function(e){t.loaded=!0,t.shortList=e.shortList,t.longList=e.longList})},reportReadMore:function(){Object(dt.report)({click:"review_more"},{media_id:this.MD_ID,url:this.mediaLink})}},components:{ReviewItem:Ze}},ii=(i(136),Object(mt.a)(ei,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showMedia?i("div",{staticClass:"bangumi-media report-wrap-module report-scroll-module",attrs:{id:"bangumi_media"}},[i("div",{staticClass:"bangumi-media-header"},[i("h4",[t._v("点评")]),t._v(" "),i("div",{staticClass:"rate-wrapper clearfix"},[t.loaded&&t.renderList.length>0?i("div",{class:["rate-score",{"no-score":!t.MEDIA_RATING.score}],domProps:{textContent:t._s(t.renderScore)}}):t._e(),t._v(" "),t.loaded&&t.renderList.length>0?i("div",{staticClass:"rate-info"},[t.MEDIA_RATING.score?i("ul",{staticClass:"star-wrapper clearfix"},t._l(t.stars,function(e,n){return i("li",{key:n,class:["icon-star",{"icon-star-light":"full"===e.type,"icon-star-half":"half"===e.type}]},["half"===e.type?i("i",{staticClass:"path2"}):t._e()])}),0):t._e(),t._v(" "),i("p",{class:["info-wrapper",{"no-score":!t.MEDIA_RATING.score}],domProps:{textContent:t._s(t.renderCount)}})]):t._e(),t._v(" "),i("div",{class:["btn-go-write",{empty:0===t.renderList.length}],attrs:{"report-id":"click_review_publish"},on:{click:t.verifyOpen}},[t._m(0),t._v("去写点评")])]),t._v(" "),t.renderList.length>0?i("a",{staticClass:"btn-more-review",attrs:{href:t.mediaLink,target:"javascript:;"===t.mediaLink?"_self":"_blank"},on:{click:t.reportReadMore}},[t._v("查看全部点评")]):t._e()]),t._v(" "),i("div",{staticClass:"bangumi-media-body clearfix"},[t.renderList.length>0?i("ul",{staticClass:"bangumi-review-list clearfix"},t._l(t.renderList,function(e,n){return i("review-item",{key:n,attrs:{data:e,"media-id":t.MD_ID}})}),1):t._e(),t._v(" "),0===t.renderList.length?i("div",{staticClass:"review-empty-wrapper"},[i("div",{staticClass:"empty-img"}),t._v(" "),i("div",{staticClass:"empty-info"},[i("span",[t._v("推荐还是吐槽？点评一下吧！")]),i("span",{staticClass:"btn-go-write",attrs:{"report-id":"click_review_publish"},on:{click:t.verifyOpen}},[t._v("去写点评")])])]):t._e()])]):t._e()},[function(){var t=this.$createElement,e=this._self._c||t;return e("i",{staticClass:"icon-write"},[e("b",{staticClass:"path1"}),e("b",{staticClass:"path2"}),e("b",{staticClass:"path3"})])}],!1,null,null,null).exports);function ni(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return A.fetchPost(t,e,i,n)}var si={props:{back:Boolean,border:Boolean,title:String},methods:{goBack:function(){this.$emit("back")},payClose:function(){this.$root.$emit("trigger-sponsor-pay",!1)}}},oi=(i(137),Object(mt.a)(si,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sponsor-pay-header",class:{border:t.border}},[t.back?i("div",{staticClass:"sp-back",on:{click:t.goBack}}):t._e(),t._v(" "),i("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),t._v(" "),i("div",{staticClass:"sp-close",on:{click:t.payClose}})])},[],!1,null,null,null).exports),ai=-1,ri=0,ci=1,li=2,ui=3,di=4,pi=5,hi=6,fi=7,mi={components:{PayHeader:oi},props:{config:Object},data:function(){return{agree:!0,title:"这部番被我承包了",giftTips:"，您将获得限量挂件",active:0,custom:"",bpPay:[5,10,50,450]}},computed:{point:function(){return function(t,e){return t=Number(t),isNaN(t)&&(t=0),e=Number(e),isNaN(e)&&(e=0),t*e}(this.config.amount,this.config.rate)},needPay:function(){var t=function(t,e){return(Math.floor(100*parseFloat(t))-Math.floor(100*parseFloat(e)))/100}(this.config.amount,this.config.bp);return(isNaN(t)||t<0)&&(t=0),this.config.pay=t,t},giftHint:function(){return this.config.activity&&this.config.activity.pendant&&this.config.activity.pendant.length>0?"单次承包满5B币送限定挂件一周，10B币一月，50B币半年":""}},watch:{custom:"customChanged"},mounted:function(){this.active=this.config.$active,-1===this.active&&(this.custom=this.config.amount),this.checkGiftTips()},methods:{sponsorClick:function(t){this.config.$active=this.active=t,t<0?(""===this.custom&&(this.custom="20"),this.$refs.custom.focus()):(this.custom="",this.config.amount=this.bpPay[t]||10,this.checkGiftTips())},customChanged:function(){if(""!==this.custom||-1!==this.active){var t=parseInt(this.custom);isNaN(t)||0===t?-1===this.active&&(this.custom=1):this.custom=t,this.custom&&(this.config.amount=this.custom),this.checkGiftTips()}else this.config.amount=0},checkGiftTips:function(){var t=this.config.amount;this.giftTips=t>=50?"，您将获赠半年挂件":t>=10?"，您将获赠一月挂件":t>=5?"，您将获赠一周挂件":""},next:function(){!this.agree||this.config.amount<=0||this.$emit("next",ri)}}},_i=(i(138),Object(mt.a)(mi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sp-pay-index"},[i("pay-header",{attrs:{title:t.title,border:!0}}),t._v(" "),i("div",{staticClass:"sponsor-pay-body"},[i("div",{staticClass:"sponsor-gift-hint"},[t.giftHint?i("i"):t._e(),t._v(" "+t._s(t.giftHint))]),t._v(" "),i("ul",{staticClass:"sponsor-choice"},[t._l(t.bpPay,function(e,n){return i("li",{key:n,class:{active:t.active===n},on:{click:function(e){return t.sponsorClick(n)}}},[i("div",{staticClass:"sponsor-border"},[i("i",{class:"bp"+e})]),t._v(" "),i("span",[t._v(t._s(e)+" B币")])])}),t._v(" "),i("li",{class:{active:-1===t.active},on:{click:function(e){return t.sponsorClick(-1)}}},[i("div",{staticClass:"sponsor-border"},[i("i",{class:"bp-custom"})]),t._v(" "),i("span",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.custom,expression:"custom"}],ref:"custom",attrs:{type:"text",name:"custom-amount",placeholder:"自定义",maxlength:"5"},domProps:{value:t.custom},on:{focus:function(e){return t.sponsorClick(-1)},input:function(e){e.target.composing||(t.custom=e.target.value)}}}),t._v("B币")])])],2),t._v(" "),i("div",{staticClass:"sponsor-hint"},[t._v("\n            您的账户余额 "+t._s(t.config.bp)+" B币，还需支付"),i("em",{domProps:{textContent:t._s(t.needPay)}}),t._v("B币"),t.giftHint?i("span",{domProps:{textContent:t._s(t.giftTips)}}):t._e(),t._v(" "),i("div",{staticClass:"sponsor-point"},[t._v("预计可获得"),i("em",{domProps:{textContent:t._s(t.point)}}),t._v("积分（不包括B币券）")])]),t._v(" "),i("button",{staticClass:"sponsor-btn sponsor-btn-primary",class:{disabled:!t.agree||t.config.amount<=0},on:{click:t.next}},[t._v("立即承包")]),t._v(" "),i("div",{staticClass:"sponsor-agree"},[i("label",[i("i",{class:{agree:t.agree},on:{click:function(e){t.agree=!t.agree}}}),t._v(" "),i("input",{attrs:{type:"checkbox",checked:"checked"}}),t._v("同意\n                "),i("a",{attrs:{href:"https://bangumi.bilibili.com/anime/sponsor",target:"_blank"}},[t._v("用户须知")]),t._v("\n                及\n                "),i("a",{attrs:{href:"https://pay.bilibili.com/doc/license.html",target:"_blank"}},[t._v("B币用户协议")])])])])],1)},[],!1,null,null,null).exports),vi={components:{PayHeader:oi},props:{config:Object},data:function(){return{title:"确认承包？",lock:!1}},methods:{goBack:function(){this.$emit("back")},quickPay:function(){var t=this;if(this.lock)return!1;this.lock=!0,ni("//bangumi.bilibili.com/sponsor/web_api/v2/pay/order/quick",{season_type:this.config.seasonType,season_id:this.config.seasonId,amount:this.config.amount,csrf:r.get("bili_jct")||""}).then(function(e){0===e.code&&e.result&&1===e.result.status?(t.config.$result=e.result,t.config.$orderId=e.result.order_id||"",t.$emit("next",ci,ui)):t.$emit("next",ci,di),setTimeout(function(){t.lock=!1},200)},function(){t.$emit("next",ci,di),t.lock=!1})}}},yi=(i(139),Object(mt.a)(vi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sp-quick-pay"},[i("pay-header",{attrs:{title:t.title,back:!0,border:!0},on:{back:t.goBack}}),t._v(" "),i("div",{staticClass:"sponsor-pay-body"},[i("p",{staticClass:"sponsor-control-group"},[i("label",[t._v("承包金额：")]),t._v(" "),i("em",[t._v(t._s(t.config.amount)+" B币")])]),t._v(" "),i("p",{staticClass:"sponsor-control-group"},[i("label",[t._v("账户余额：")]),t._v(" "),i("em",[t._v(t._s(t.config.bp)+" B币")]),t._v(" "),i("span",[t._v(" (余额足够，将使用余额支付)")])])]),t._v(" "),i("div",{staticClass:"sponsor-pay-footer"},[i("a",{staticClass:"btn-link",attrs:{target:"_blank"},on:{click:t.quickPay}},[t._v("立即承包")])])],1)},[],!1,null,null,null).exports),gi=0,wi=1,Ii=3,bi={components:{PayHeader:oi},props:{config:Object},data:function(){return{timer:null,title:"这部番被我承包了",active:0,alipay:"",alifix:!0}},mounted:function(){this.tabChanged(1)},destroyed:function(){this.timer&&clearInterval(this.timer)},methods:{tabChanged:function(t){this.active=t,0===this.active?this.createOrder(gi):1===this.active&&this.createOrder(wi)},goBack:function(){this.$emit("back")},jumpToPayCenter:function(){this.createOrder(Ii)},createOrder:function(t){var e,i=this;t===Ii&&(e=window.open("https://pay.bilibili.com/jump.html","_blank"),this.$emit("next",li,pi)),ni("//bangumi.bilibili.com/sponsor/web_api/v2/pay/order/create",{pay_method:t,season_type:this.config.seasonType,season_id:this.config.seasonId,amount:this.config.amount,csrf:r.get("bili_jct")||""}).then(function(n){if(0!==n.code)return i.config.$page=10*li+1,i.config.$code=n.code,i.$emit("next",li,fi),!1;if(i.config.$orderId=n.result.order_id,t===wi)new Qt.a({size:180,background:"#fff",element:i.$el.querySelector("#qrcode"),value:n.result.qrcode});else if(t===gi)n.result.qrcode&&((!function(t){var e,i=["webkit","Moz","ms","o"],n=[],s=document.documentElement.style,o=function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})};for(e in i)n.push(o(i[e]+"-"+t));for(e in n.push(o(t)),n)if(n[e]in s)return!0;return!1}("transform")||"Microsoft Internet Explorer"===navigator.appName&&"9."===navigator.appVersion.match(/9./i))&&(i.alifix=!0),i.alipay=n.result.qrcode.replace("¬","&not").replace(/&amp;/g,"&"));else if(t===Ii)return void(e.location.href=n.result.cashier_url);i.timer&&clearInterval(i.timer),i.timer=setInterval(function(){i.checkPayStatus()},3e3)},function(){return i.config.$page=10*li,i.config.$code=-404,i.$emit("next",li,fi),!1})},checkPayStatus:function(){var t=this;this.config.$orderId&&ni("//bangumi.bilibili.com/sponsor/web_api/v2/pay/order/success",{season_type:this.config.seasonType,order_id:this.config.$orderId,csrf:r.get("bili_jct")||""}).then(function(e){0===e.code&&e.result&&1===e.result.status&&(t.config.$result=e.result,t.$emit("next",li,ui))},function(){})}}},Ti=(i(140),Object(mt.a)(bi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sp-pay-qrcode"},[i("pay-header",{attrs:{title:t.title,back:!0,border:!0},on:{back:t.goBack}}),t._v(" "),i("div",{staticClass:"sponsor-pay-amount"},[i("div",{staticClass:"sponsor-amount-group"},[i("label",[t._v("承包金额：")]),t._v(" "),i("div",{staticClass:"sponsor-amount"},[t._v(" "+t._s(t.config.amount)+" B币")])]),t._v(" "),i("div",{staticClass:"sponsor-amount-group"},[i("label",[t._v("需要支付：")]),t._v(" "),i("div",{staticClass:"sponsor-amount p"},[t._v("￥"+t._s(t.config.pay))])])]),t._v(" "),i("div",{staticClass:"sponsor-qrcode"},[i("div",{staticClass:"qr-code-title"},[t._v("请使用"+t._s(0===t.active?"支付宝":"微信")+"扫码支付")]),t._v(" "),i("div",{staticClass:"qr-code-body"},[0===t.active?i("div",{staticClass:"alipay-qrcode"},[i("iframe",{class:{"ali-fix":t.alifix},attrs:{width:"300",height:"290",scrolling:"no",src:t.alipay}})]):t._e(),t._v(" "),1===t.active?i("div",{staticClass:"wechat-qrcode"},[i("img",{attrs:{id:"qrcode",alt:""}})]):t._e()]),t._v(" "),i("div",{staticClass:"sponsor-qrcode-tab"},[i("div",{staticClass:"qrcode-tab-mask"}),t._v(" "),i("div",{staticClass:"qrcode-tab",class:{active:0===t.active},on:{click:function(e){return t.tabChanged(0)}}},[i("i",{staticClass:"alipay"}),t._v("支付宝\n            ")]),t._v(" "),i("div",{staticClass:"qrcode-tab",class:{active:1===t.active},on:{click:function(e){return t.tabChanged(1)}}},[i("i",{staticClass:"wechat"}),t._v("微信\n            ")])]),t._v(" "),i("a",{staticClass:"step_other",attrs:{href:"javascript: void(0);"},on:{click:t.jumpToPayCenter}},[t._v("其他支付方式>")])])],1)},[],!1,null,null,null).exports),Oi={components:{PayHeader:oi},props:{config:Object,needCb:Boolean},data:function(){return{title:"承包成功",agree:!0,msgText:"",msgCount:0,msgLimit:25}},computed:{ratio:function(){return y()||2},face:function(){return this.hasPendant?v(this.config.loginInfo.face,Math.ceil(100*this.ratio),Math.ceil(100*this.ratio)):""},hasActivity:function(){return this.config.activity&&this.config.activity.id?"单次承包满5B币送限定挂件一周，10B币一月，50B币半年":""},hasPendant:function(){return this.config.$result.pendants&&this.config.$result.pendants[0]?this.config.$result.pendants[0].image:""},expStr:function(){return this.config.$result.exp&&this.config.$result.exp>0?"您的经验值 +".concat(this.config.$result.exp):"您的经验值 +0"},pointStr:function(){if(this.config.$result.point&&this.config.$result.point>0)return"，积分 +".concat(this.config.$result.point)},otherStr:function(){return this.hasPendant?"，您已获得限定头像挂件".concat(this.config.$result.pendant_day_text||""):""}},watch:{msgText:"msgTextChanged"},mounted:function(){this.config.$result&&this.config.$orderId&&pt.$emit("SPONSOR_PAY_SUCCESS",this.needCb,this.config.$result,this.config.$orderId)},methods:{payClose:function(){this.$root.$emit("trigger-sponsor-pay",!1)},msgTextChanged:function(){var t=window.$.trim(this.msgText),e=t.length;if(e>this.msgLimit)return this.msgText=t.substr(0,this.msgLimit),void(this.msgCount=this.msgLimit);this.msgText=t,this.msgCount=e},msgSend:function(){var t=this,e={season_type:this.config.seasonType,season_id:this.config.seasonId,comment:this.msgText,order_id:this.config.$orderId,csrf:r.get("bili_jct")||""};if(this.agree){var i=this.config.$result.pendants;i&&i.length>0&&(e.pendant_id=i[0].pid)}ni("//bangumi.bilibili.com/sponsor/web_api/v2/pay/comment",e).then(function(e){0===e.code?t.$emit("next",ui,hi):61001!==parseInt(e.code)&&61002!==parseInt(e.code)||(t.config.$page=10*ui+2,t.config.$code=e.code||-1,t.$emit("next",ui,fi))})}}},Ci=(i(141),Object(mt.a)(Oi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sp-pay-success"},[i("div",{staticClass:"sp-close",on:{click:t.payClose}}),t._v(" "),i("div",{staticClass:"sponsor-pay-body"},[i("div",{staticClass:"sponsor-pay-preview"},[t.hasPendant?i("div",{staticClass:"sp-preview"},[t.face?i("img",{staticClass:"sp-user-face",attrs:{src:t.face,alt:""}}):t._e(),t._v(" "),i("img",{staticClass:"sp-user-pendant",attrs:{width:"168",height:"168",src:t.hasPendant}})]):t._e(),t._v(" "),t.hasPendant?t._e():i("div",{staticClass:"sp-default"})]),t._v(" "),i("div",{staticClass:"sponsor-pay-result"},[i("div",{staticClass:"sponsor-pay-result-body"},[i("p",{staticClass:"sponsor-pay-result-title",domProps:{textContent:t._s(t.title)}}),t._v(" "),i("p",[t._v(t._s(t.expStr)+t._s(t.pointStr)+t._s(t.otherStr))]),t._v(" "),t.hasActivity&&!t.hasPendant?i("p",[t._v("单次承包满5B币送限定挂件一周，10B币一月，50B币半年")]):t._e(),t._v(" "),t.hasPendant?i("p",[i("span",[i("i",{class:{agree:t.agree},on:{click:function(e){t.agree=!t.agree}}}),t._v("立刻换上")])]):t._e()])])]),t._v(" "),i("div",{staticClass:"sponsor-pay-msg"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.msgText,expression:"msgText"}],attrs:{cols:"30",rows:"10",maxlength:"50",placeholder:"您可以在这里输入承包感言，25字以内"},domProps:{value:t.msgText},on:{input:function(e){e.target.composing||(t.msgText=e.target.value)}}}),t._v(" "),i("div",{staticClass:"msg-limit"},[t._v(t._s(t.msgCount)+"/"+t._s(t.msgLimit))]),t._v(" "),i("div",{staticClass:"msg-send",on:{click:t.msgSend}},[t._v("提交留言")])])])},[],!1,null,null,null).exports),Si={components:{PayHeader:oi},props:{config:Object},data:function(){return{title:"承包失败"}},methods:{goBack:function(){this.$emit("back",[ci,li])}}},Ei=(i(142),Object(mt.a)(Si,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sp-pay-failed"},[e("pay-header",{attrs:{title:this.title}}),this._v(" "),this._m(0),this._v(" "),e("div",{staticClass:"sponsor-pay-footer"},[e("a",{staticClass:"btn-link",staticStyle:{"margin-right":"20px"},attrs:{href:"javascript: void(0);",target:"_blank"},on:{click:this.goBack}},[this._v("重新支付")]),e("a",{staticClass:"btn-link normal",attrs:{href:"https://service.bilibili.com/chat/pc/index.html?sysNum=41076deba1104a1ba055bc38aacae3d5",target:"_blank"}},[this._v("遇到问题")])])],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sponsor-pay-body"},[e("div",{staticClass:"pay-img"})])}],!1,null,null,null).exports),Ni={components:{PayHeader:oi},props:{config:Object},data:function(){return{title:"请在弹出的新页面中完成支付"}},methods:{checkPayStatus:function(){var t=this;ni("//bangumi.bilibili.com/sponsor/web_api/v2/pay/order/success",{order_id:this.config.$orderId}).then(function(e){0===e.code&&e.result&&1===e.result.status?(t.config.$result=e.result,t.$emit("next",pi,ui)):t.$emit("next",pi,di)})}}},Mi=(i(143),Object(mt.a)(Ni,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sp-pay-other"},[e("pay-header",{attrs:{title:this.title}}),this._v(" "),this._m(0),this._v(" "),e("div",{staticClass:"sponsor-pay-footer"},[e("a",{staticClass:"btn-link",staticStyle:{"margin-right":"20px"},attrs:{href:"javascript: void(0);",target:"_blank"},on:{click:this.checkPayStatus}},[this._v("完成支付")]),e("a",{staticClass:"btn-link normal",attrs:{href:"https://service.bilibili.com/chat/pc/index.html?sysNum=41076deba1104a1ba055bc38aacae3d5",target:"_blank"}},[this._v("遇到问题")])])],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sponsor-pay-body"},[e("div",{staticClass:"pay-img"})])}],!1,null,null,null).exports),Pi={components:{PayHeader:oi},props:{config:Object},data:function(){return{title:"留言成功，快去分享吧",ready:!1}},mounted:function(){this.ready=!0},methods:{}},Ai=(i(144),Object(mt.a)(Pi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sp-pay-share"},[i("pay-header",{attrs:{title:t.title}}),t._v(" "),i("div",{staticClass:"sponsor-pay-body"},[i("div",{staticClass:"pay-img"}),t._v(" "),t.ready?i("div",{staticClass:"share-module"},[i("ul",{directives:[{name:"share",rawName:"v-share",value:t.config.share,expression:"config.share"}],staticClass:"share-list clearfix"},[i("li",{staticClass:"share-btn btn-weibo",attrs:{"share-type":"weibo"}}),t._v(" "),i("li",{staticClass:"share-btn btn-qqzone",attrs:{"share-type":"qqzone"}}),t._v(" "),i("li",{staticClass:"share-btn btn-qq",attrs:{"share-type":"qq"}}),t._v(" "),i("li",{staticClass:"share-btn btn-baidu",attrs:{"share-type":"baidu"}})])]):t._e()])],1)},[],!1,null,null,null).exports),ki={components:{PayHeader:oi},props:{config:Object},data:function(){return{title:"出错了",limit:[-101]}},computed:{hasBack:function(){return!1}},mounted:function(){-101===parseInt(this.config.$code)?(this.$root.$emit("trigger-sponsor-pay",!1),window.open("https://passport.bilibili.com/login?gourl=".concat(window.location.href))):61001!==parseInt(this.config.$code)&&61002!==parseInt(this.config.$code)||(this.$root.$emit("trigger-sponsor-pay",!1),pt.$emit("REAL_NAME_SHOW",this.config.$code))},methods:{goBack:function(){this.$emit("back")}}},Di=(i(145),Object(mt.a)(ki,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sp-pay-info"},[i("pay-header",{attrs:{title:t.title,back:t.hasBack,border:!0},on:{back:t.goBack}}),t._v(" "),i("div",{staticClass:"sponsor-pay-body"},[i("div",{staticClass:"sp-info-bg"}),t._v(" "),i("p",{staticClass:"sp-info-text"},[t._v("\n            遇到问题了，请联系客服或刷新页面重试"),i("br"),t._v("\n            出错战舰编号 [ P"+t._s(t.config.$page)+"："+t._s(t.config.$code)+" ]\n        ")])]),t._v(" "),t._m(0)],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sponsor-pay-footer"},[e("a",{staticClass:"btn-link normal",attrs:{href:"https://service.bilibili.com/chat/pc/index.html?sysNum=41076deba1104a1ba055bc38aacae3d5",target:"_blank"}},[this._v("遇到问题")])])}],!1,null,null,null).exports),Ui={props:{config:{type:Object,default:function(){return{seasonId:null}}}},data:function(){return{needCallback:!1,show:!1,pageGroup:[],viewGroup:[_i,yi,Ti,Ci,Ei,Mi,Ai,Di],payConfig:{seasonId:0,seasonType:0,share:{},rate:0,bp:-1,amount:5,activity:null,loginInfo:{},$pay:0,$active:0,$page:0,$code:0,$info:"",$result:{}},component:null}},created:function(){var t=this;this.$root.$on("trigger-sponsor-pay",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.needCallback=n,e&&i&&(t.initConfig(),t.initDialog()),t.show=e})},watch:{show:function(){this.show&&this.$nextTick(function(){!function(t){if("undefined"!=typeof window&&(/MSIE/i.test(window.navigator.userAgent)||/Trident/i.test(window.navigator.userAgent)))try{var e=window.document.createElement("iframe");e.className="bangumi-pay-layout",e.frameBorder="0",t.appendChild(e)}catch(t){}}(this.$el)})}},mounted:function(){this.initConfig()},methods:{go:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t<0||(this.pageGroup.push(t),this.component=this.viewGroup[t])},back:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.length>0){for(var e=0;!(void 0===(e=this.pageGroup.pop())||t.indexOf(e)>=0););return this.go(e)}this.pageGroup.pop(),this.go(this.pageGroup.pop())},initConfig:function(){for(var t in this.payConfig)void 0!==this.config[t]&&(this.payConfig[t]=this.config[t]);this.payConfig.activity||(this.payConfig.activity={}),this.pageGroup=[]},initDialog:function(){if(this.payConfig.bp<0)return this.getBp();this.go(ri)},getBp:function(){var t=this,e=function(t,e){return e=void 0===e?{}:e,new Promise(function(i,n){A.fetchGet("//bangumi.bilibili.com/web_api/get_token").then(function(s){0===s.code?(e.token=s.result.token,A.fetchPost(t,e,!1,!0).then(function(t){i(t)},function(t){n(t)})):n(s.message)},function(t){n(t)})})}("//bangumi.bilibili.com/web_api/get_bp"),i=function(t,e){return A.fetchGet(t,e)}("//bangumi.bilibili.com/sponsor/point_rate");p.Promise.all([e,i]).then(function(e){var i=e[0]||{};if(0!==i.code)return t.payConfig.$page=10*ai+1,t.payConfig.$code=i.code||-1,void t.go(fi);t.payConfig.bp=i.result&&(i.result.default_bp||0);var n=e[1]||{};if(0!==n.code)return t.payConfig.$page=10*ai+2,t.payConfig.$code=n.code||-1,void t.go(fi);t.payConfig.rate=n.result&&(n.result.rate||0),t.initDialog()},function(){t.payConfig.$page=10*ai,t.payConfig.$code=-1,t.go(fi)})},next:function(t,e,i){t!==ri?this.go(e):this.payConfig.bp>=this.payConfig.amount?this.go(ci):this.go(li)}}},xi=(i(146),Object(mt.a)(Ui,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"sponsor-pay-dialog",on:{click:function(e){t.show=!1}}},[i("div",{staticClass:"sponsor-pay-content",on:{click:function(t){t.stopPropagation()}}},[i("transition",{attrs:{name:"jelly",mode:"out-in"}},[i(t.component,{tag:"component",attrs:{config:t.payConfig,"need-cb":t.needCallback},on:{next:t.next,back:t.back}})],1)],1)]):t._e()},[],!1,null,null,null).exports),ji={data:function(){return{iconList:[]}},computed:{icons:function(){for(var t=Math.floor(20*Math.random())+20,e=[],i=0;i<t;i++){var n=Math.floor(9*Math.random())+16,s=Math.floor(20*Math.random()),o=Math.floor(3e3*Math.random())+i%20*600,a=Math.floor(4e3*Math.random())+6e3;e.push({width:"".concat(n,"px"),height:"".concat(n,"px"),bottom:"".concat(s,"px"),animation:"bili-icon-h ".concat(a,"ms linear 1, bili-icon-r 1s linear 10"),animationDelay:"".concat(o,"ms")})}return e}}},Li=(i(147),Object(mt.a)(ji,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"rank-bb"},this._l(this.icons,function(t,i){return e("div",{key:i,staticClass:"bb-icon",style:t})}),0)},[],!1,null,null,null).exports),Fi={props:{index:{type:Number,default:0}},data:function(){return{active:0,tabs:["七日榜","总榜"],indicator:{width:0,left:0}}},watch:{index:function(t,e){t!==e&&(this.active=this.index,this.resetIndicator())}},mounted:function(){this.active=this.index,this.resetIndicator()},methods:{resetIndicator:function(){var t=this.$el.querySelectorAll("li")[this.active];this.indicator.width=t.offsetWidth,this.indicator.left=t.offsetLeft},tabClick:function(t){this.active=t,this.resetIndicator(),pt.$emit("RANK_TAB_CHANGE"),this.$emit("rank-tab",t)}}},Ri=(i(148),Object(mt.a)(Fi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"sponsor-rank-tab clearfix"},[t._l(t.tabs,function(e,n){return i("li",{key:n,class:{active:t.active===n},domProps:{textContent:t._s(e)},on:{click:function(e){return t.tabClick(n)}}})}),t._v(" "),i("div",{staticClass:"indicator",style:"left: "+t.indicator.left+"px;width: "+t.indicator.width+"px"})],2)},[],!1,null,null,null).exports),$i={props:{config:Object,parentConf:Object,index:{type:Number,required:!0}},computed:{ratio:function(){return y()||2},cover:function(){return v(this.config.face,Math.ceil(66*this.ratio),Math.ceil(66*this.ratio))},vip:function(){if(!this.config.vip)return!1;if(this.config.vip.vipType&&2===parseInt(this.config.vip.vipType)&&(this.config.vip.vipStatus&&1===parseInt(this.config.vip.vipStatus)))return 1===(this.config.vip.themeType||0)?"vip festival-theme-v1":"vip";return!1}},methods:{reportHandler:function(){var t={season_id:this.parentConf.seasonId,businesstype:this.parentConf.seasonType,title:this.parentConf.title,ord_id:this.index+1};this.parentConf.epId&&(t.ep_id=this.parentConf.epId),Object(dt.report)({click:"bp_user"},t)}}},Ji=(i(149),Object(mt.a)($i,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"sponsor-rank-item simple",class:(t.config.rank<4?"rank-":"")+(t.config.rank<4?t.config.rank:"")},[i("div",{staticClass:"sp-rank"},[i("i",{domProps:{textContent:t._s(t.config.rank>3?t.config.rank:"")}})]),t._v(" "),i("a",{attrs:{href:"//space.bilibili.com/"+(t.config.uid||0),target:"_blank"},on:{click:t.reportHandler}},[i("img",{attrs:{src:t.cover,alt:""}}),t._v(" "),i("div",{staticClass:"sp-user",class:t.vip,domProps:{textContent:t._s(t.config.uname)}})]),t._v(" "),t.config.message?i("div",{staticClass:"sp-msg"},[i("p",{domProps:{textContent:t._s(t.config.message)}})]):t._e()])},[],!1,null,null,null).exports),Gi={props:{state:{default:"loading"},data:{}},computed:{source:function(){if("hidden"===this.state)return!0;var t=Object.prototype.toString;return"[object Array]"===t.call(this.data)?0!==this.data.length:"[object Object]"===t.call(this.data)?!w(this.data):"loading"!==this.state}},methods:{reloads:function(){this.$emit("reload")}}},Vi=(i(150),Object(mt.a)(Gi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.source?t._e():i("div",{staticClass:"load-state"},["loading"===t.state?i("span",{staticClass:"loading"},[t._v("正在加载...")]):t._e(),t._v(" "),"error"===t.state?i("span",{staticClass:"error"},[t._v("加载失败，\n        "),i("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.reloads()}}},[t._v("点击重试")])]):t._e(),t._v(" "),"loaded"===t.state?i("span",{staticClass:"empty"},[t._v("没有数据(-_-#)")]):t._e()])},[],!1,null,null,null).exports),Hi=0,Bi=1,qi={components:{RankBB:Li,RankItem:Ji,RankTab:Ri,Loading:Vi},props:{config:{type:Object,default:function(){return{seasonId:void 0,pageSize:7,csrf:null}}}},data:function(){return{show:!1,mine:{},showBB:!1,showAM:!0,state:"loading",active:0,rankList:{list:[]}}},computed:{ratio:function(){return y()||2},cover:function(){return v(this.config.loginInfo.face,Math.ceil(66*this.ratio),Math.ceil(66*this.ratio))},vipCls:function(){if(!this.config.loginInfo)return!1;if(this.config.loginInfo.vipType&&2===parseInt(this.config.loginInfo.vipType)&&(this.config.loginInfo.vipStatus&&1===parseInt(this.config.loginInfo.vipStatus)))return console.log(this.config.loginInfo),1===(this.config.loginInfo.vip_theme_type||0)?"vip festival-theme-v1":"vip";return!1}},watch:{"config.rankTotal":{handler:function(t,e){var i=this;if(this.active===Bi){var n=this.config.rankTotal;setTimeout(function(){0===n.code&&n.result?(i.mine=n.result.mine||{},i.rankList.list=n.result.list||[],i.showBB=0===i.rankList.list.length,i.state="hidden",i.showAM=!0):i.state="error"},200)}},deep:!0},"config.rankWeek":{handler:function(t,e){var i=this;if(this.active===Hi){var n=this.config.rankWeek;setTimeout(function(){0===n.code&&n.result?(i.mine=n.result.mine||{},i.rankList.list=n.result.list||[],i.showBB=0===i.rankList.list.length,i.state="hidden",i.showAM=!0):i.state="error"},200)}},deep:!0},show:function(){this.show&&this.$nextTick(function(){E(this.$el)})}},created:function(){var t=this;this.$root.$on("trigger-sponsor-rank",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.show=e,t.active=i,e&&t.rankTabChanged(t.active)})},mounted:function(){this.config.csrf||(this.config.csrf=r.get("bili_jct"))},methods:{getSponsorRank:function(t){var e=this,i=this.config.seasonType||-1,n=this.config.seasonId||-1,s=this.config.pageSize||100,o=this.config.csrf||"";this.state="loading",window.$(".sp-rank-body").animate({scrollTop:0},60),this.showAM=!1,A.fetchGet(t,{season_type:i,season_id:n,page:1,pagesize:s,csrf:o}).then(function(t){0===t.code&&null!==t.result&&(e.mine=t.result.mine||{},e.rankList.list=t.result.list||[],e.showBB=0===e.rankList.list.length),e.showAM=!0,e.state="hidden"},function(){e.state="error"})},rankTabChanged:function(t){window.$(".sp-rank-body").animate({scrollTop:0},60),this.active=t,this.state="loading",this.mine={},this.rankList.list=[],this.showAM=!1,t===Hi?pt.$emit("FETCH_SPONSOR_RANK","week",100):t===Bi&&pt.$emit("FETCH_SPONSOR_RANK","total",100)}}},Wi=(i(151),Object(mt.a)(qi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"sponsor-rank-dialog",on:{click:function(e){t.show=!1}}},[i("div",{staticClass:"sponsor-rank-content",on:{click:function(t){t.stopPropagation()}}},[i("div",{staticClass:"sp-rank-header"},[i("div",{staticClass:"sp-rank-title"},[t._v("承包榜")]),t._v(" "),t.show?i("rank-tab",{staticClass:"sp-list-nav",attrs:{index:t.active},on:{"rank-tab":t.rankTabChanged}}):t._e(),t._v(" "),i("span",{staticClass:"sp-close",on:{click:function(e){t.show=!1}}})],1),t._v(" "),i("div",{staticClass:"sp-rank-body"},[t.config.loginInfo&&t.mine&&t.mine.count>0?i("div",{staticClass:"sponsor-rank-mine"},[i("div",{staticClass:"sp-rank",staticStyle:{width:"auto","min-width":"28px"}},[i("i",{staticStyle:{"max-width":"inherit"},domProps:{textContent:t._s(t.mine.rank)}})]),t._v(" "),i("a",{attrs:{href:"//space.bilibili.com/"+(t.config.loginInfo.mid||0),target:"_blank"}},[i("img",{attrs:{src:t.cover,alt:""}}),t._v(" "),i("div",{staticClass:"sp-user",class:t.vipCls,domProps:{textContent:t._s(t.config.loginInfo.uname)}})]),t._v(" "),t.mine.message?i("div",{staticClass:"sp-msg"},[i("p",{domProps:{textContent:t._s(t.mine.message)}})]):t._e(),t._v(" "),i("div",{staticClass:"sp-bp"},[i("i"),t._v(t._s(t.mine.count))])]):t._e(),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:"hidden"===t.state,expression:"state === 'hidden'"}],staticClass:"sp-rank-list"},[t._l(t.rankList.list,function(e,n){return i("rank-item",{key:n,class:{"bili-item":t.showAM},attrs:{config:e,"parent-conf":t.config,index:n}})}),t._v(" "),0===t.rankList.list.length&&"loading"!==t.state?i("li",{staticClass:"empty"},[t._v("前排虚位以待，快来承包吧")]):t._e()],2),t._v(" "),i("loading",{staticClass:"rank-loading",attrs:{data:t.rankList.list,state:t.state},on:{reload:function(e){return t.rankTabChanged(t.active)}}})],1),t._v(" "),t.showBB?i("rank-b-b"):t._e()],1)]):t._e()},[],!1,null,null,null).exports),Qi={mixins:[Ji]},Xi=(i(152),Object(mt.a)(Qi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"sponsor-rank-item special"},[i("div",{staticClass:"sp-left"},[i("a",{attrs:{href:"//space.bilibili.com/"+(t.config.uid||0),target:"_blank"},on:{click:t.reportHandler}},[i("img",{attrs:{src:t.cover,alt:""}})])]),t._v(" "),i("div",{staticClass:"sp-right"},[i("div",{staticClass:"sp-user",class:t.vip},[i("a",{staticClass:"sp-name",attrs:{href:"//space.bilibili.com/"+(t.config.uid||0),target:"_blank"},on:{click:t.reportHandler}},[t._v("\n                "+t._s(t.config.uname)+"\n                "),i("i",{staticClass:"vip-rank",class:"rank-"+(t.config.rank||0)})])]),t._v(" "),i("div",{staticClass:"sp-msg"},[i("span"),t._v(" "),i("div",[t._v("\n                "+t._s(t.config.message||"TA并沒有留言")+"\n            ")])])])])},[],!1,null,null,null).exports),Yi={mixins:[Ji]},zi=(i(153),Object(mt.a)(Yi,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"sponsor-rank-item normal"},[i("div",{staticClass:"sp-left"},[i("div",{staticClass:"face-wrap"},[i("div",{staticClass:"sp-rank",domProps:{textContent:t._s(t.config.rank)}}),t._v(" "),i("a",{attrs:{href:"//space.bilibili.com/"+(t.config.uid||0),target:"_blank"},on:{click:t.reportHandler}},[i("img",{attrs:{src:t.cover,alt:""}})])])]),t._v(" "),i("div",{staticClass:"sp-right"},[i("div",{staticClass:"sp-user",class:t.vip},[i("a",{attrs:{href:"//space.bilibili.com/"+(t.config.uid||0),target:"_blank"},on:{click:t.reportHandler}},[i("div",{staticClass:"sp-name",domProps:{textContent:t._s(t.config.uname)}})])]),t._v(" "),i("div",{staticClass:"sp-msg"},[t._v("\n            "+t._s(t.config.message||"TA并沒有留言")+"\n        ")])])])},[],!1,null,null,null).exports),Ki={props:{state:String,config:{type:Object,required:!0,validator:function(t){return(void 0===t.spec||isNaN(Number(t.spec)))&&(t.spec=3),!0}},parentConf:Object},data:function(){return{RankItemBg:Xi,RankItemSm:zi}}},Zi=(i(154),Object(mt.a)(Ki,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"sponsor-rank-list"},[t._l(t.config.list,function(e,n){return i(n<t.config.spec?t.RankItemBg:t.RankItemSm,{key:n,tag:"component",attrs:{config:e,"parent-conf":t.parentConf,index:n}})}),t._v(" "),0===t.config.list.length&&"loading"!==t.state?i("li",{key:-1,staticClass:"empty"},[t._v("前排虚位以待，快来承包吧")]):t._e()],2)},[],!1,null,null,null).exports),tn=0,en=1,nn={props:{config:{type:Object,default:function(){return{seasonId:void 0,pageSize:7,csrf:null}}}},data:function(){return{state:"loading",first:!0,active:0,rankList:{list:[],spec:3}}},watch:{"config.seasonId":{handler:function(t,e){t>-1&&t!==e&&this.rankTabChanged(this.active)},deep:!0},"config.rankTotal":{handler:function(t,e){var i=this;if(this.active===en){var n=this.config.rankTotal;setTimeout(function(){0===n.code&&n.result?(i.rankList.list=n.result.list||[],i.state="hidden"):i.state="error"},200)}},deep:!0},"config.rankWeek":{handler:function(t,e){var i=this;if(this.active===tn){var n=this.config.rankWeek;setTimeout(function(){0===n.code&&n.result?(i.rankList.list=n.result.list||[],i.first&&(i.first=!1,0===i.rankList.list.length&&i.rankTabChanged(en)),i.state="hidden"):i.state="error"},200)}},deep:!0}},mounted:function(){this.config.csrf||(this.config.csrf=r.get("bili_jct"))},methods:{showSponsorRankDialog:function(){pt.$emit("SHOW_SPONSOR_RANK"),this.$root.$emit("trigger-sponsor-rank",!0,this.active)},rankTabChanged:function(t){this.active=t,this.state="loading",this.rankList.list=[],t===tn?pt.$emit("FETCH_SPONSOR_RANK","week",7):t===en&&pt.$emit("FETCH_SPONSOR_RANK","total",7)}},components:{RankTab:Ri,RankList:Zi,Loading:Vi}},sn=(i(155),Object(mt.a)(nn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sponsor-rank-v1"},[i("div",{staticClass:"sponsor-rank-header"},[i("h3",[t._v("承包榜")]),t._v(" "),i("rank-tab",{attrs:{index:t.active},on:{"rank-tab":t.rankTabChanged}}),t._v(" "),i("div",{staticClass:"show-sponsor-rank",on:{click:t.showSponsorRankDialog}},[t._v("查看承包榜")])],1),t._v(" "),i("div",{staticClass:"sponsor-rank-body"},[i("rank-list",{directives:[{name:"show",rawName:"v-show",value:"hidden"===t.state,expression:"state === 'hidden'"}],attrs:{config:t.rankList,"parent-conf":t.config}}),t._v(" "),i("loading",{staticClass:"rank-loading",attrs:{data:t.rankList.list,state:t.state},on:{reload:function(e){return t.rankTabChanged(t.active)}}})],1)])},[],!1,null,null,null).exports),on={data:function(){return{shown:!1,codeEnum:{61001:"NO_BIND",61002:"FORBIDDEN"},code:0,message:""}},created:function(){var t=this;pt.$on("REAL_NAME_SHOW",function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t.code=e,t.message=i,t.shown=!0})},computed:{type:function(){return this.codeEnum[this.code]},title:function(){return"NO_BIND"===this.type?"请绑定手机号":"请更新绑定手机"},info:function(){return this.message?this.message:"NO_BIND"===this.type?"根据国家实名制认证的相关要求，您需要绑定手机号，才能继续进行操作。":"根据国家实名制认证的相关要求，您需要换绑一个<i>非170/171的手机号</i>，才能继续进行操作。"},btnText:function(){return"NO_BIND"===this.type?"绑定手机号":"更换绑定手机"}},methods:{close:function(){this.shown=!1,this.message=""}}},an=(i(156),Object(mt.a)(on,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.shown?i("div",{staticClass:"bangumi-rn-wrapper"},[i("div",{staticClass:"rn-content"},[i("div",{staticClass:"rn-close",on:{click:t.close}}),t._v(" "),i("div",{staticClass:"rn-title",domProps:{textContent:t._s(t.title)}}),t._v(" "),i("div",{staticClass:"rn-body"},[i("p",{staticClass:"info",domProps:{innerHTML:t._s(t.info)}})]),t._v(" "),i("div",{staticClass:"rn-footer"},[i("a",{staticClass:"btn-bind",attrs:{href:"//passport.bilibili.com/site/site.html",target:"_blank"},domProps:{textContent:t._s(t.btnText)}}),t._v(" "),"FORBIDDEN"===t.type?i("a",{staticClass:"tip",attrs:{href:"//account.bilibili.com/site/identification.html",target:"_blank"}},[t._v("无法换绑手机，尝试进行真实性验证")]):t._e()])])]):t._e()},[],!1,null,null,null).exports);function rn(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var cn={created:function(){var t=this;pt.$on("SHOW_1080P",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.shown=!0,t.needCallback=e,setTimeout(function(){t.contentShow=!0,E(t.$el)},50)})},data:function(){return{shown:!1,contentShow:!1,needCallback:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){rn(t,e,i[e])})}return t}({},Object(o.b)(["MEDIA_INFO","RIGHTS_INFO","SS_ID","EP_ID","SS_STAT"]),{title:function(){return 8===this.MEDIA_INFO.season_status||9===this.MEDIA_INFO.season_status?"付费观看本片":6===this.MEDIA_INFO.season_status||7===this.MEDIA_INFO.season_status?"付费观看本片或成为大会员":1===this.RIGHTS_INFO.allow_bp?"承包本片或成为大会员":"成为大会员"},btnText:function(){return(1===this.SS_STAT.status||2===this.SS_STAT.status&&this.SS_STAT.isPay)&&13!==this.MEDIA_INFO.season_status?"付费观看":1===this.RIGHTS_INFO.allow_bp&&13!==this.MEDIA_INFO.season_status?"承包本片":""}}),methods:{close:function(){var t=this;this.contentShow=!1,setTimeout(function(){t.shown=!1},300)},payHandler:function(){this.close(),1===this.SS_STAT.status||2===this.SS_STAT.status&&this.SS_STAT.isPay?(Object(dt.report)({click:"pay"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),pt.$emit("TRIGGER_PAY_PROCESS",!0)):1===this.RIGHTS_INFO.allow_bp&&(Object(dt.report)({click:"bp"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),this.$root.$emit("trigger-sponsor-pay",!0,!0,this.needCallback))},vipHandler:function(){this.close(),window.showVipPay(7)}}},ln=(i(157),Object(mt.a)(cn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.shown?i("div",{staticClass:"popup-1080p-wrapper"},[i("transition",{attrs:{name:"popup-1080"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.contentShow,expression:"contentShow"}],staticClass:"popup-content"},[i("div",{staticClass:"popup-close",on:{click:t.close}}),t._v(" "),i("div",{staticClass:"popup-title",domProps:{textContent:t._s(t.title)}}),t._v(" "),i("div",{staticClass:"popup-desc"},[t._v("即可解锁本片所有清晰度")]),t._v(" "),i("div",{staticClass:"popup-img"}),t._v(" "),i("div",{staticClass:"popup-btns"},[t.btnText?i("div",{staticClass:"popup-btn btn-pay",domProps:{textContent:t._s(t.btnText)},on:{click:t.payHandler}}):t._e(),t._v(" "),8!==t.MEDIA_INFO.season_status&&9!==t.MEDIA_INFO.season_status&&12!==t.MEDIA_INFO.season_status?i("div",{staticClass:"popup-btn btn-bevip",on:{click:t.vipHandler}},[t._v("成为大会员")]):t._e()])])])],1):t._e()},[],!1,null,null,null).exports);function un(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var dn={data:function(){return{shown:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){un(t,e,i[e])})}return t}({},Object(o.b)(["MINI_ON","EP_INFO"]),{style:function(){return{opacity:this.shown?1:0}}}),mounted:function(){var t=this;window.addEventListener("scroll",function(){t.shown=b()>300},!1)},methods:{gotoTop:function(){!function(){void 0!==window.animationScrollTimer&&(window.cancelAnimationFrame(window.animationScrollTimer),window.animationScrollTimer=void 0);var t=b();if(t>0){var e=Math.ceil(t/30);window.animationScrollTimer=window.requestAnimationFrame(function i(){(t-=e)<0&&(t=0),0===window.document.body.scrollTop&&0!==t?window.document.documentElement.scrollTop=t:0!==t&&(window.document.body.scrollTop=t),t<=0?(window.document.documentElement.scrollTop=window.document.body.scrollTop=0,window.cancelAnimationFrame(window.animationScrollTimer),window.animationScrollTimer=void 0):window.animationScrollTimer=window.requestAnimationFrame(i)})}}()},miniSwitch:function(){this.$store.dispatch({type:"CHANGE_MINI_ON",isOn:!this.MINI_ON})}}},pn=(i(158),Object(mt.a)(dn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bangumi-nav-right",style:t.style},[i("div",{staticClass:"nav-goto-top",on:{click:t.gotoTop}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"bangumi"===t.EP_INFO.from,expression:"EP_INFO.from === 'bangumi'"}],staticClass:"nav-mini-switch",on:{click:t.miniSwitch}},[t._v("mini"),i("br"),t._v(t._s(t.MINI_ON?"ON":"OFF"))])])},[],!1,null,null,null).exports);function hn(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var fn={data:function(){return{shown:!1,contentShow:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){hn(t,e,i[e])})}return t}({},Object(o.b)(["VER","LOGIN_INFO","EP_INFO","MEDIA_INFO","SS_ID","EP_ID","RIGHTS_INFO","PAY_MENT","USER_STAT"]),{epStatus:function(){return this.EP_INFO.episode_status||this.MEDIA_INFO.season_status},popTitle:function(){return 13===this.epStatus?"试看已结束，大会员免费看全片":"6分钟试看已播放完毕"},desc:function(){return"付费(".concat(this.PAY_MENT.price,"B币)即可开启全片")}}),created:function(){var t=this;pt.$on("SIX_MIN_MASK_SHOW",function(){t.shown=!0,setTimeout(function(){t.contentShow=!0,E(t.$el)},50)})},methods:{close:function(){var t=this;this.contentShow=!1,setTimeout(function(){t.shown=!1},300)},payHandler:function(){this.close(),this.LOGIN_INFO.isLogin?(Object(dt.report)({click:"pay"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),pt.$emit("TRIGGER_PAY_PROCESS",!0)):S()},vipHandler:function(){this.close(),window.showVipPay()}}},mn=(i(159),Object(mt.a)(fn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.shown?i("div",{class:["sixm-pay-mask",{"big-only":13===t.epStatus}]},[i("transition",{attrs:{name:"popup-sixm"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.contentShow,expression:"contentShow"}],staticClass:"popup-content"},[i("div",{staticClass:"popup-close",on:{click:t.close}}),t._v(" "),i("div",{staticClass:"popup-title",domProps:{textContent:t._s(t.popTitle)}}),t._v(" "),13!==t.epStatus?i("div",{staticClass:"popup-desc",domProps:{textContent:t._s(t.desc)}}):t._e(),t._v(" "),i("div",{staticClass:"popup-img"}),t._v(" "),i("div",{staticClass:"popup-btns"},[13!==t.epStatus?i("div",{staticClass:"popup-btn",on:{click:t.payHandler}},[t._v("立即观看")]):t._e(),t._v(" "),13===t.epStatus?i("div",{staticClass:"popup-btn",on:{click:t.vipHandler}},[t._v("成为大会员")]):t._e(),t._v(" "),13===t.epStatus&&t.PAY_MENT.vip_first_promotion?i("i",{staticClass:"sale",domProps:{textContent:t._s(t.PAY_MENT.vip_first_promotion)}}):t._e()]),t._v(" "),8!==t.epStatus&&9!==t.epStatus&&12!==t.epStatus&&13!==t.epStatus?i("div",{staticClass:"btn-bevip",on:{click:t.vipHandler}},[t._v("成为大会员免费看>")]):t._e(),t._v(" "),8!==t.epStatus&&9!==t.epStatus&&12!==t.epStatus&&13===t.epStatus?i("a",{staticClass:"btn-bevip",attrs:{href:"//big.bilibili.com/site/big.html",target:"_blank"}},[t._v("什么是大会员>")]):t._e()])])],1):t._e()},[],!1,null,null,null).exports),_n={props:{value:Number},data:function(){return{hover:0,animation:!1}},methods:{changed:function(t){var e=this;this.animation=!0,this.$emit("input",t),setTimeout(function(){e.animation=!1},600)},rateEnter:function(t){this.hover=t,this.$emit("enter",t)},rateLeave:function(t){this.hover=0,this.$emit("leave",t)}}},vn=(i(160),Object(mt.a)(_n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"rate-star clearfix",class:{animation:t.animation}},t._l(5,function(e){return i("li",{key:e,on:{click:function(i){return t.changed(e)},mouseenter:function(i){return t.rateEnter(e)},mouseleave:function(i){return t.rateLeave(e)}}},[i("i",{class:{"icon-star":e>t.value&&e>t.hover,"icon-star-light":e<=t.value||e<=t.hover,"icon-hover":e<=t.hover&&e>t.value}})])}),0)},[],!1,null,null,null).exports),yn={props:{mediaInfo:Object,reviewInfo:Object},components:{RateStar:vn},data:function(){return{score:-1}},computed:{title:function(){return this.mediaInfo.title||" "},cover:function(){return v(this.mediaInfo.cover,Math.ceil(100*y()),Math.ceil(133*y()))}},watch:{score:{handler:function(){this.$emit("score",this.score)}},"reviewInfo.user_rating.score":{handler:function(){this.score=this.reviewInfo.user_rating.score}}},mounted:function(){this.score=this.reviewInfo.user_rating.score}},gn=(i(161),Object(mt.a)(yn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"review-edit-header"},[i("a",{staticClass:"media-img",attrs:{href:"//www.bilibili.com/bangumi/media/md"+t.mediaInfo.media_id+"/",target:"_blank"}},[i("img",{attrs:{src:t.cover,alt:""}})]),t._v(" "),i("div",{staticClass:"media-info"},[i("h4",{domProps:{textContent:t._s(t.title)}}),t._v(" "),i("p",{staticClass:"rate-tip"},[t._v("请发表你对这部作品的评分")]),t._v(" "),i("div",{staticClass:"rate-wrap"},[i("rate-star",{model:{value:t.score,callback:function(e){t.score=e},expression:"score"}}),t._v(" "),5===t.score&&t.reviewInfo.is_coin?i("span",{staticClass:"is-coin"},[t._v("发表五星评价需扣除一枚硬币")]):t._e()],1)])])},[],!1,null,null,null).exports),wn={props:{mediaInfo:Object,reviewInfo:Object},components:{ReviewHeader:gn},data:function(){return{show:!1,config:{score:-1,content:"",min:0,max:100,count:0}}},computed:{tempInfo:function(){var t=-1;return this.reviewInfo.user_rating&&this.reviewInfo.user_rating.score&&(t=Math.floor(this.reviewInfo.user_rating.score/2)),{review_id:this.reviewInfo.review_id||0,is_coin:this.reviewInfo.is_coin||0,user_rating:{score:t}}},submitText:function(){return this.reviewInfo.review_id?"更新短评":"发表短评"},submitChecked:function(){return!(this.config.count>this.config.max)&&(!(this.config.count<this.config.min||this.config.count>this.config.max)&&this.config.score>0)},countColor:function(){return this.config.count>this.config.max?"#E40C0C":"#99a2aa"},countTip:function(){return this.config.count>this.config.max?"已超过规定字数":"".concat(this.config.count,"/").concat(this.config.max)}},watch:{"config.content":{handler:function(){this.config.content=this.config.content.replace(/[\t\n]/g,""),this.config.count=this.config.content.length}},reviewInfo:{handler:function(){this.reviewInfoChanged()},deep:!0},show:function(){this.show&&this.$nextTick(function(){E(this.$el)})}},created:function(){var t=this;this.$root.$on("TRIGGER_SHORT_REVIEW",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.show=e})},mounted:function(){this.reviewInfoChanged()},methods:{scoreChanged:function(t){this.config.score=t,this.$emit("score",t)},reviewInfoChanged:function(){this.reviewInfo.user_rating.score&&this.reviewInfo.user_rating.score>0&&(this.config.score=Math.floor(this.reviewInfo.user_rating.score/2)),this.config.content=this.reviewInfo.content||""},reviewSubmit:function(){var t=this;if(this.submitChecked){var e="//bangumi.bilibili.com/review/web_api/short/post",i={media_id:this.mediaInfo.media_id,score:2*this.config.score,content:this.config.content,csrf:r.get("bili_jct")||""};this.reviewInfo.review_id&&(i.review_id=this.reviewInfo.review_id,e="//bangumi.bilibili.com/review/web_api/short/modify"),at({method:"post",url:e,params:i,include:!0}).then(function(e){if(200===e.status&&e.data&&0===Number(e.data.code)){var n=e.data.result||{};t.$root.$emit("SHORT_REVIEW_SUCCESS",{score:i.score,review_id:n.id,content:n.content}),t.show=!1,t.$message({offset:"50%",message:t.reviewInfo.review_id?"更新成功":"发表成功"})}else t.$message({offset:"50%",zIndex:10020,message:e.data.message||"提交短评信息发生错误"})})}},writeLongReview:function(){window.open("https://member.bilibili.com/v2#/upload/text/edit?media_id=".concat(this.mediaInfo.media_id))}}},In=(i(162),Object(mt.a)(wn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"short-review-masker"},[i("div",{staticClass:"short-review-content",on:{click:function(t){t.stopPropagation()}}},[i("div",{staticClass:"dialog-close",on:{click:function(e){t.show=!1}}}),t._v(" "),i("div",{staticClass:"review-header-wrap"},[i("review-header",{attrs:{"media-info":this.mediaInfo,"review-info":t.tempInfo},on:{score:t.scoreChanged}})],1),t._v(" "),i("div",{staticClass:"review-body-wrap"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.config.content,expression:"config.content"}],attrs:{name:"short-review",placeholder:""},domProps:{value:t.config.content},on:{input:function(e){e.target.composing||t.$set(t.config,"content",e.target.value)}}}),t._v(" "),i("span",{staticClass:"tip",style:"color: "+t.countColor+";",domProps:{textContent:t._s(t.countTip)}},[t._v(t._s(t.config.count)+"/"+t._s(t.config.max))]),t._v(" "),i("button",{staticClass:"mr-btn",class:{active:t.submitChecked},domProps:{textContent:t._s(t.submitText)},on:{click:t.reviewSubmit}})]),t._v(" "),t.reviewInfo.review_id?t._e():i("div",{staticClass:"mr-long-review",on:{click:t.writeLongReview}},[t._v("想写长评，点这里 >")])])])},[],!1,null,null,null).exports),bn={props:{feed:{type:Object,required:!0}},computed:{ratio:function(){return y()||2},cover:function(){return v(this.feed.media.cover,Math.ceil(60*this.ratio),Math.ceil(80*this.ratio))},content:function(){var t=this.feed.content.replace(/(\r\n)|(\n)|(\r)/g," ");return t=t.replace(/\t/g," ")},likesRender:function(){var t=C(this.feed.likes);return"赞：".concat(t)},authorInfo:function(){return"".concat(this.feed.author.uname||"")},mediaInfo:function(){return"".concat(this.feed.media.title)},reviewLink:function(){return"//www.bilibili.com/read/cv".concat(this.feed.article_id)},authorLink:function(){return this.feed.author?"//space.bilibili.com/".concat(this.feed.author.mid,"/"):""},mediaLink:function(){return"//www.bilibili.com/bangumi/media/md".concat(this.feed.media.media_id,"/")},isVip:function(){return this.feed&&this.feed.author&&this.feed.author.vip&&1===this.feed.author.vip.vipStatus&&2===this.feed.author.vip.vipType},themeCls:function(){if(this.isVip&&1===(this.feed.author.vip.themeType||0))return"festival-theme-v1";return""}}},Tn=(i(163),Object(mt.a)(bn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"review-feed-item clearfix"},[i("div",{staticClass:"feed-left"},[i("div",{staticClass:"review-info"},[i("a",{staticClass:"review-title",attrs:{target:"_blank",href:t.reviewLink,title:t.feed.title},domProps:{textContent:t._s(t.feed.title)}}),t._v(" "),i("a",{staticClass:"review-content",attrs:{target:"_blank",href:t.reviewLink},domProps:{textContent:t._s(t.content)}})]),t._v(" "),i("div",{staticClass:"review-about"},[i("a",{class:["author-info",{"is-vip":t.isVip},t.themeCls],attrs:{target:"_blank",href:t.authorLink},domProps:{textContent:t._s(t.authorInfo)}}),t._v("\n            评\n            "),i("a",{staticClass:"media-title",attrs:{target:"_blank",href:t.mediaLink},domProps:{textContent:t._s(t.mediaInfo)}})])]),t._v(" "),i("div",{staticClass:"feed-right"},[i("a",{attrs:{href:t.mediaLink,target:"_blank"}},[i("img",{attrs:{src:t.cover,alt:""}})]),t._v(" "),i("div",{staticClass:"likes",domProps:{textContent:t._s(t.likesRender)}})])])},[],!1,null,null,null).exports),On={data:function(){return{state:"loading",list:[],ajaxList:[]}},props:{mediaId:{type:Number,required:!0},type:{type:Number,default:-1}},mounted:function(){this.loadData()},methods:{refreshHandler:function(){"loading"!==this.state&&(this.state="loading",this.ajaxList=[],setTimeout(this.loadData,1e3))},loadData:function(){var t=this,e={page_size:5};this.type&&(e.type=this.type),at({url:"//bangumi.bilibili.com/review/web_api/feed/pull",params:e,include:!0}).then(function(e){if(200===e.status&&e.data&&0===e.data.code){var i=e.data.result||[];t.ajaxList=i||[],t.list=i||[],t.state="loaded"}else t.state="error"})}},components:{Loading:Ce,FeedItem:Tn}},Cn=(i(164),Object(mt.a)(On,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.list.length>0?i("div",{staticClass:"review-feed-wrapper"},[i("div",{staticClass:"feed-header clearfix"},[i("h4",[t._v("点评动态")]),t._v(" "),i("span",{on:{click:t.refreshHandler}},[i("i",{staticClass:"icon-refresh"}),t._v("换一换")])]),t._v(" "),i("ul",{staticClass:"feed-list"},[t._l(t.ajaxList,function(t,e){return i("feed-item",{key:e,attrs:{feed:t}})}),t._v(" "),i("loading",{attrs:{state:t.state,data:t.ajaxList},on:{reload:t.refreshHandler}})],2)]):t._e()},[],!1,null,null,null).exports,{props:{title:String,noClose:{type:Boolean,default:!1}},data:function(){return{}},methods:{close:function(){this.$emit("close")}}}),Sn=(i(165),Object(mt.a)(Cn,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"__dialog-header"},[e("p",{domProps:{textContent:this._s(this.title)}}),this._v(" "),this.noClose?this._e():e("div",{staticClass:"mr-close",on:{click:this.close}})])},[],!1,null,null,null).exports),En={props:{loginInfo:Object,noClose:{type:Boolean,default:!1}},components:{DialogHeader:Sn},data:function(){return{show:!1,agree:!0,from:"",title:"bilibili点评公测邀请"}},computed:{levelCheck:function(){return!(!this.loginInfo||!this.loginInfo.level_info)&&this.loginInfo.level_info.current_level>=4},mobileCheck:function(){return this.loginInfo&&this.loginInfo.mobile_verified||0},mobileHref:function(){return this.loginInfo&&2===this.loginInfo.mobile_verified?"https://account.bilibili.com/site/identification.html":"https://passport.bilibili.com/site/site.html"},mobileText:function(){return this.loginInfo&&2===this.loginInfo.mobile_verified?"去实名认证":"去绑定手机"}},created:function(){var t=this;this.$root.$on("TRIGGER_REVIEW_OPEN",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t.show=e,t.from=i})},methods:{clickConfirm:function(){var t=this;this.agree?this.levelCheck&&this.mobileCheck&&at({method:"post",url:"//bangumi.bilibili.com/review/web_api/user/open",params:{csrf:r.get("bili_jct")||""},include:!0}).then(function(e){200===e.status&&e.data&&0===e.data.code?(t.$root.$emit("REVIEW_OPEN_SUCCESS",e.data.result||{},t.from),t.show=!1,t.from=""):t.$message({message:e.data.message||"开通点评失败",zIndex:10240})}):this.$message({message:"请先阅读哔哩哔哩点评规范条例",zIndex:10240})},clickDismiss:function(){this.noClose||(this.show=!1)}}},Nn=(i(166),Object(mt.a)(En,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"open-dialog-masker",on:{click:t.clickDismiss}},[i("div",{staticClass:"open-dialog-content",on:{click:function(t){t.stopPropagation()}}},[i("dialog-header",{attrs:{title:t.title,"no-close":t.noClose},on:{close:t.clickDismiss}}),t._v(" "),i("div",{staticClass:"open-body"},[i("p",[t._v("满足以下条件可以发表点评")]),t._v(" "),i("ul",[i("li",[i("span",[t._v("1、会员等级不低于Lv4")]),t._v(" "),i("i",{class:t.levelCheck?"icon-done":"icon-warning"})]),t._v(" "),i("li",[i("span",[t._v("2、绑定非虚拟号段手机")]),t._v(" "),i("i",{class:t.mobileCheck?"icon-done":"icon-warning"}),t._v(" "),t.mobileCheck?t._e():i("a",{staticClass:"pull-right",attrs:{href:t.mobileHref},domProps:{textContent:t._s(t.mobileText)}})])])]),t._v(" "),i("div",{staticClass:"open-footer"},[i("div",{staticClass:"dialog-btn-group"},[i("div",{staticClass:"btn-normal confirm",class:{disabled:!t.levelCheck||!t.mobileCheck||!t.agree},on:{click:t.clickConfirm}},[t._v("确认\n                ")]),t._v(" "),i("div",{staticClass:"btn-normal",class:{disabled:t.noClose},on:{click:t.clickDismiss}},[t._v("取消")])]),t._v(" "),i("span",{staticClass:"open-agree"},[i("i",{class:{"icon-done checked":t.agree},on:{click:function(e){t.agree=!t.agree}}}),t._v("\n                已阅读"),i("a",{attrs:{href:encodeURI("https://www.bilibili.com/blackboard/help.html#点评相关"),target:"_blank"}},[t._v("《哔哩哔哩点评规范条例》")])])])],1)]):t._e()},[],!1,null,null,null).exports),Mn={props:{config:Object}},Pn=(i(167),{components:{DialogHeader:Sn,ReportItem:Object(mt.a)(Mn,function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"__report-item"},[e("p")])}],!1,null,null,null).exports},data:function(){return{show:!1,reportUrl:""}},created:function(){var t=this;this.$root.$on("TRIGGER_REPORT_DIALOG",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;t.show=e,i=i||0,n=n||0;var o="short"===(s=s||"short")?"shortComment":"longComment";t.reportUrl="//www.bilibili.com/appeal/?reviewId=".concat(n,"&type=").concat(o,"&mediaId=").concat(i)})},mounted:function(){var t=this;window.addEventListener("message",function(e){if("close"!==e.data)return"alert-投诉成功"===e.data?(t.$message({message:"举报成功",zIndex:10240}),void(t.show=!1)):void("string"==typeof e.data&&"alert-"===e.data.substr(0,6)&&t.$message({message:e.data.substr(6),zIndex:10240}));t.show=!1})}});i(168),Object(mt.a)(Pn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("div",{staticClass:"report-dialog-masker",on:{click:function(e){t.show=!1},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"report-dialog-content",on:{click:function(t){t.stopPropagation()}}},[i("iframe",{attrs:{src:t.reportUrl,frameborder:"0"}})])]):t._e()},[],!1,null,null,null).exports;function An(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var kn={asyncData:function(t){var e=t.store,i=t.route,n=t.context;return e.dispatch({type:"FETCH_MEDIA_INFO",protocol:n.protocol,cookies:n.cookie,viewType:n.params.type,id:n.params.id,chkHealth:"health"===i.query.chk})},data:function(){return{payConf:{},commentJump:"",newEntryShow:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){An(t,e,i[e])})}return t}({},Object(o.b)(["AREA","APP","SPECIAL","SPENDING","EP_ID","SS_ID","MD_ID","CAN_REVIEW","USER_SHORT_REVIEW","USER_SCORE","USER_COINED","MEDIA_INFO","EP_INFO","RIGHTS_INFO","USER_STAT","SPONSOR_TOTAL","SPONSOR_WEEK","SPONSOR_TOTAL_COUNT","ACTIVITY","PAY_MENT","PAY_PACK","PUB_INFO","SEASON_FOLLOWED","LOGIN_INFO"]),{limit:function(){return 0!==this.AREA||this.APP},sponsorShow:function(){return!this.limit&&1===this.RIGHTS_INFO.allow_bp},commentShow:function(){return!this.limit&&this.EP_ID>-1},alignRecomShow:function(){return!this.commentShow&&this.EP_ID>-1},sponsorTip:function(){return W(this.SPONSOR_TOTAL_COUNT,this.USER_STAT.sponsor)},sponsorBtnText:function(){return 1===this.USER_STAT.sponsor?"继续承包":"我要承包"},bigCover:function(){return this.SPECIAL&&!this.limit?"url(".concat(_(this.MEDIA_INFO.bkg_cover),")"):"none"},sponsorConf:function(){return{seasonType:this.MEDIA_INFO.season_type||1,seasonId:this.SS_ID,epId:this.EP_ID,title:this.MEDIA_INFO.title,loginInfo:this.LOGIN_INFO,rankTotal:this.SPONSOR_TOTAL,rankWeek:this.SPONSOR_WEEK}},sponsorPayConf:function(){return{seasonId:this.SS_ID,seasonType:this.MEDIA_INFO.season_type||1,activity:this.ACTIVITY,loginInfo:this.LOGIN_INFO,share:{name:this.MEDIA_INFO.title,title:this.MEDIA_INFO.title,pic:this.MEDIA_INFO.cover,desc:"我在bilibili承包了《".concat(this.MEDIA_INFO.title,"》，因为喜爱所以承包～#哔哩哔哩#"),url:"https://www.bilibili.com/bangumi/play/ss".concat(this.SS_ID,"/"),weibo:{title:"我在bilibili承包了《".concat(this.MEDIA_INFO.title,"》，因为喜爱所以承包～#哔哩哔哩#")}}}},payDialogConfig:function(){return{styleType:"float",price:this.PAY_MENT.price||5,payPackTitle:this.PAY_PACK.title||"",payPackUrl:this.PAY_PACK.pay_pack_url||"",seasonStatus:this.MEDIA_INFO.season_status,promotion:this.PAY_MENT.promotion,seasonId:this.SS_ID,seasonType:this.MEDIA_INFO.season_type||1,isStarted:this.PUB_INFO.is_started,title:this.MEDIA_INFO.title,isfollow:this.SEASON_FOLLOWED,time:this.PUB_INFO.pub_time_show}},activityImage:function(){return this.ACTIVITY&&this.ACTIVITY.pendant_ops_img?"background-image: url(".concat(_(this.ACTIVITY.pendant_ops_img),");"):""},activityLink:function(){return this.ACTIVITY.pendant_ops_link||"javascript:;"},editMediaInfo:function(){return{media_id:this.MD_ID,cover:this.MEDIA_INFO.cover,title:this.MEDIA_INFO.title}},editReviewInfo:function(){return{review_id:this.USER_SHORT_REVIEW.review_id||0,content:this.USER_SHORT_REVIEW.content||"",is_open:this.CAN_REVIEW,is_coin:this.USER_COINED,user_rating:{score:this.USER_SCORE}}}}),watch:{EP_ID:function(t){t>-1&&(!window.playerTriggerChange&&window.reportObserver&&(window.reportObserver.sendPV(),window.playerTriggerChange=!1),window.document.title=J(this.EP_INFO.index,this.MEDIA_INFO.title,Q(this.MEDIA_INFO.season_type),!0,2===this.MEDIA_INFO.mode)),this.loadCoinStat(),this.loadRecomList(),this.loadComment()},SS_ID:function(){this.payConf={csrf:$(),seasonId:this.SS_ID,amount:this.PAY_MENT.price,seasonType:this.MEDIA_INFO.season_type||1},this.loadSponsorTotal(),this.loadSponsorWeek(),this.loadPlayerRecom()},"MEDIA_INFO.season_type":{handler:function(t,e){if(t!==e){var i={1:13,2:23,3:23,4:167,5:23,7:23,music:3};[26484,26481].indexOf(this.MEDIA_INFO.season_id)>-1?(window.bid=i.music,window.setTid&&window.setTid(i.music)):(window.bid=i[t],window.setTid&&window.setTid(i[t]))}},deep:!0},"LOGIN_INFO.isLogin":{handler:function(t,e){t!==e&&t&&this.loadCoinStat()},deep:!0}},mounted:function(){var t=this,e=window.location.href.match(/reply([0-9]+)$/);this.commentJump=e&&e[1]?e[1]:"",this.payConf={csrf:$(),seasonId:this.SS_ID,amount:this.PAY_MENT.price,seasonType:this.MEDIA_INFO.season_type||1},this.EP_ID>-1&&(this.loadCoinStat(),this.loadRecomList(),this.loadComment()),this.loadSponsorTotal(),this.loadSponsorWeek(),this.loadPlayerRecom(),pt.$on("FETCH_SPONSOR_RANK",function(e,i){"total"===e?t.loadSponsorTotal(i):t.loadSponsorWeek(i)}),pt.$on("SPONSOR_PAY_SUCCESS",function(e){t.$store.dispatch({type:"SPONSOR_STAT_CHANGE",stat:!0}),e&&pt.$emit("RELOAD_PLAYER_SOURCE")}),this.$root.$on("REVIEW_OPEN_SUCCESS",function(e,i){t.$store.dispatch({type:"USER_OPEN_CHANGE",isOpen:!0})});var i=r.get("stardustpgcv");"0"!==i&&"0606"!==i||(this.newEntryShow=!0)},methods:{tryNew:function(){Object(dt.report)({click:"try_new"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),r.set("stardustpgcv","0606","y1"),window.location.reload(!0)},loadSponsorTotal:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;this.sponsorShow&&this.$store.dispatch({type:"FETCH_SPONSOR_TOTAL",ssId:this.SS_ID,ssType:this.MEDIA_INFO.season_type,pageSize:t})},loadSponsorWeek:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;this.sponsorShow&&this.$store.dispatch({type:"FETCH_SPONSOR_WEEK",ssId:this.SS_ID,ssType:this.MEDIA_INFO.season_type,pageSize:t})},loadCoinStat:function(){var t=this;this.LOGIN_INFO.isLogin&&this.EP_INFO.aid&&U({url:"//api.bilibili.com/x/web-interface/archive/coins",type:"GET",dataType:"jsonp",data:{jsonp:"jsonp",aid:this.EP_INFO.aid}}).then(function(e){var i=e&&e.data&&e.data.multiply;t.$store.dispatch({type:"FETCH_COIN_SPEND",spending:i})})},loadRecomList:function(){this.$store.dispatch({type:"FETCH_RECOMMEND",aid:this.EP_INFO.aid})},loadPlayerRecom:function(){this.$store.dispatch({type:"FETCH_PLAYER_RECOMMEND",ssId:this.SS_ID})},loadComment:function(){var t=this;this.commentShow&&this.EP_INFO.aid&&(void 0===window.bbComment?O("//static.hdslb.com/phoenix/dist/js/comment.min.js",function(){new window.bbComment(".comm",t.EP_INFO.aid,1,null,t.commentJump),t.commentJump=""}):(new window.bbComment(".comm",this.EP_INFO.aid,1,null,this.commentJump),this.commentJump=""))},showSponsorPay:function(){this.LOGIN_INFO.isLogin?(Object(dt.report)({click:"bp"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title}),this.$root.$emit("trigger-sponsor-pay",!0)):S()},reportPay:function(){Object(dt.report)({click:"pay"},{season_id:this.SS_ID,ep_id:this.EP_ID,businesstype:this.MEDIA_INFO.season_type,title:this.MEDIA_INFO.title})},followCallback:function(t){this.$store.dispatch({type:"FOLLOW_STAT_CHANGE",stat:t}),pt.$emit("TRIGGER_FOLLOW_ANIME")}},components:{BangumiHeader:qt,BangumiPlayer:we,BangumiInfo:He,BangumiRecom:Ye,BangumiMedia:ii,SponsorRankView:sn,SponsorRankDialog:Wi,SponsorPayDialog:xi,PayWatchProcess:ue,PayWatchEntry:Yt,CoinDialog:Ft,RealName:an,Popup1080:ln,NavRight:pn,SixmPayMask:mn,OpenDialog:Nn,ShortReviewDialog:In}},Dn=(i(169),Object(mt.a)(kn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:["main-container",{special:t.SPECIAL&&!t.limit}],attrs:{id:"app"}},[!t.SPECIAL||t.limit?i("bangumi-header"):t._e(),t._v(" "),i("div",{staticClass:"player-wrapper report-wrap-module report-scroll-module",style:{"background-image":t.bigCover},attrs:{id:"bangumi_player"}},[t.SPECIAL&&!t.limit?i("div",{staticClass:"blur-mask",style:{"background-image":t.bigCover}}):t._e(),t._v(" "),i("bangumi-player")],1),t._v(" "),t.limit?t._e():i("div",{staticClass:"bangumi-info-wrapper report-wrap-module report-scroll-module",attrs:{id:"bangumi_detail"}},[i("bangumi-info")],1),t._v(" "),i("bangumi-media"),t._v(" "),t.sponsorShow?i("div",{staticClass:"sponsor-wrapper clearfix"},[i("div",{staticClass:"sponsor-left-area"},[i("sponsor-rank-view",{attrs:{config:t.sponsorConf}})],1),t._v(" "),i("div",{staticClass:"sponsor-right-area"},[i("div",{staticClass:"img-wrapper",style:t.activityImage},["javascript:;"!==t.activityLink?i("a",{attrs:{href:t.activityLink,target:"javascript:;"===t.activityLink?"_self":"_blank"}}):t._e()]),t._v(" "),i("p",{staticClass:"sponsor-count-info",domProps:{innerHTML:t._s(t.sponsorTip)}}),t._v(" "),i("div",{staticClass:"sponsor-btn",domProps:{textContent:t._s(t.sponsorBtnText)},on:{click:t.showSponsorPay}})])]):t._e(),t._v(" "),t.alignRecomShow?i("div",{staticClass:"recom-align-wrapper report-wrap-module report-scroll-module",attrs:{id:"bangumi_recommend_align"}},[i("bangumi-recom",{attrs:{align:!0}})],1):t._e(),t._v(" "),t.commentShow?i("div",{staticClass:"other-wrapper clearfix"},[t._m(0),t._v(" "),i("div",{staticClass:"recom-wrapper report-wrap-module report-scroll-module",attrs:{id:"bangumi_recommend_vertial"}},[i("bangumi-recom")],1)]):t._e(),t._v(" "),i("sponsor-rank-dialog",{attrs:{config:t.sponsorConf}}),t._v(" "),i("sponsor-pay-dialog",{attrs:{config:t.sponsorPayConf}}),t._v(" "),i("pay-watch-process",{attrs:{config:t.payConf,"login-info":t.LOGIN_INFO}}),t._v(" "),i("pay-watch-entry",{attrs:{"login-info":t.LOGIN_INFO,config:t.payDialogConfig},on:{"on-follow":t.followCallback}}),t._v(" "),i("coin-dialog",{attrs:{coin:t.SPENDING,aid:t.EP_INFO.aid,login:t.LOGIN_INFO.isLogin}}),t._v(" "),i("sixm-pay-mask"),t._v(" "),i("real-name"),t._v(" "),i("popup1080"),t._v(" "),i("nav-right"),t._v(" "),i("open-dialog",{attrs:{"login-info":t.LOGIN_INFO}}),t._v(" "),i("short-review-dialog",{attrs:{"media-info":t.editMediaInfo,"review-info":t.editReviewInfo}}),t._v(" "),t.newEntryShow?i("div",{staticClass:"new-entry"},[i("img",{attrs:{src:"//s1.hdslb.com/bfs/static/jinkela/videoplay/images/22.png",alt:""}}),t._v(" "),i("div",{staticClass:"btn",on:{click:t.tryNew}},[t._v("\n            试用"),i("br"),t._v("新版\n        ")])]):t._e()],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"comment-wrapper common"},[e("div",{staticClass:"comment-title b-head"},[e("span",{staticClass:"results"}),this._v("评论")]),this._v(" "),e("div",{staticClass:"comm"})])}],!1,null,null,null).exports);function Un(t){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var xn=["scroll","resize","load"];function jn(t,e){var i,n;for(i=0,n=t.length;i<n;++i)if(t[i].el===e)return i;return-1}var Ln={install:function(t,e){var i=[],n=[],s=e||{preload:0};function o(t){t.loading||t.loaded||!g(t.el,s.preload)||function(t){if(t.loading||t.loaded)return;t.loading=!0;var e=new Image;e.onload=function(){t.el.src=t.src,t.loading=!1,t.loaded=!0,t.el.setAttribute("lazy","loaded")},e.onerror=function(){t.loading=!1,t.loaded=!0,t.el.src=t.defaultImg},e.src=t.src}(t)}function a(t){!t.loaded&&g(t.el,s.preload)&&(t.handler.call(),t.loaded=!0)}function r(e,s){var r=Un(e);"string"===r?function(e,n){var s=jn(i,n),a={el:n,src:e,loading:!1,loaded:!1,defaultImg:n.getAttribute("src")};-1!==s?i[s]=a:i.push(a),t.nextTick(function(){o(a)})}(e,s):"object"===r&&function(e,i){var s=jn(n,i),o={el:i,id:e.id,loaded:!1,handler:e.handler||function(){}};-1!==s?n[s].id!==e.id&&(n[s]=o,t.nextTick(function(){a(o)})):(n.push(o),t.nextTick(function(){a(o)}))}(e,s)}t.directive("lazy",{bind:function(t,e){r(e.value,t)},update:function(t,e){r(e.value,t)},componentUpdated:function(t,e){},unbind:function(t,e){if("object"===Un(e.value)){var i=jn(n,t);-1!==i&&n.splice(i,1)}}});var c=function(t,e,i){var n=null,s=0;return function(){var o=this,a=arguments,r=+new Date;clearTimeout(n),s||(s=r),r-s>=i?(t.apply(o,a),s=r):n=setTimeout(function(){t.apply(o,a)},e)}}(function(){!function(){var t,e;for(t=0,e=i.length;t<e;++t)o(i[t])}(),function(){var t,e;for(t=0,e=n.length;t<e;++t)a(n[t])}()},200,100);if("undefined"!=typeof window)for(var l=0;l<xn.length;++l)window.addEventListener(xn[l],c);pt.$on("updateFloor",function(){c()}),pt.$on("appMounted",function(){c()}),"undefined"!=typeof window&&(window.triggerLazyProcess=c)}},Fn={},Rn=0;var $n,Jn={install:function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.directive("share",{bind:function(t,e){var i=new function(t,e){var i=this;this.shared=!1,this.listeners={},this.defaultOptions={title:document.title,url:"",desc:"",pic:"",summary:"",searchPic:"false",appkey:{weibo:"2841902482",qqweibo:"84435a83a11c484881aba8548c6e7340"},weiboTag:""},this.openShareWindow=function(t,e){var i=[];for(var n in e)e.hasOwnProperty(n)&&i.push("".concat(n,"=").concat(encodeURIComponent(e[n]||"")));var s="".concat(t,"?").concat(i.join("&"));return window.open(s,"","width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no"),!1},this.createHandler=function(t,e){return function(){i.openShareWindow(t,e)}},this.bindApp=function(t,e){t.innerHTML='<div class="weixin-share-modal"><canvas class="qrcode-wrapper" id="app-qrcode-wrapper"></canvas><p class="share-name">'+e.name+'</p><p class="share-tips">用<a href="https://app.bilibili.com/" target="_blank">哔哩哔哩客户端</a>或其他应用扫描二维码</p></div>',setTimeout(function(){new Qt.a({element:document.getElementById("app-qrcode-wrapper"),value:e.url,size:140,level:"H"})},200)},this.bindWeixin=function(t,e){var i="share-qrcode-"+Rn;t.innerHTML='<div class="weixin-share-modal"><p>扫一扫分享到微信</p><canvas class="qrcode-wrapper" id="'+i+'"></canvas></div>',setTimeout(function(){new Qt.a({element:document.getElementById(i),value:e.url,size:150,level:"H"})},200)},this.bindWeibo=function(t,e,n){i.bindEvent(t,"http://service.weibo.com/share/share.php",{url:e.url,type:"3",count:"1",appkey:e.appkey.weibo,title:e.weibo&&e.weibo.title||e.title,pic:e.pic,searchPic:e.searchPic,ralateUid:"",language:"zh_cn",rnd:(new Date).valueOf()},n)},this.bindBaidu=function(t,e,n){i.bindEvent(t,"https://tieba.baidu.com/f/commit/share/openShareApi",{title:e.baidu&&e.baidu.title||e.title,url:m(e.url),uid:726865,to:"tieba",type:"text",relateUid:"",pic:e.pic,key:"",sign:"on",desc:"",comment:e.desc},n)},this.bindQQ=function(t,e,n){i.bindEvent(t,"http://connect.qq.com/widget/shareqq/index.html",{url:e.url,showcount:1,desc:e.desc,summary:e.summary,title:e.qq&&e.qq.title||"",site:"哔哩哔哩",pics:e.pic,style:"203",width:98,height:22,otype:"share"},n)},this.bindQQZone=function(t,e,n){i.bindEvent(t,"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey",{url:e.url,desc:e.desc,title:e.title,summary:e.summary,pics:e.pic,flash:"",site:"",style:"201",width:32,height:32},n)},this.bindEvent=function(t,e,n,s){i.listeners[s]&&(t.removeEventListener("click",i.listeners[s],!1),delete i.listeners[s]);var o=i.createHandler(e,n);i.listeners[s]=o,t.addEventListener("click",o,!1)},this.init=function(t,e){var n=Object.assign({},i.defaultOptions,e);for(var s in t)if(t.hasOwnProperty(s)&&t[s]&&t[s].attributes&&t[s].attributes["share-type"]){var o=t[s].attributes["share-type"].value;"app"===o?i.bindApp(t[s],n):"weixin"===o?i.bindWeixin(t[s],n):"qq"===o?i.bindQQ(t[s],n,o):"weibo"===o?i.bindWeibo(t[s],n,o):"baidu"===o?i.bindBaidu(t[s],n,o):"qqzone"===o&&i.bindQQZone(t[s],n,o)}},this.unbind=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e].attributes["share-type"].value;"weixin"===n?t[e].innerHTML="":t[e].removeEventListener("click",i.listeners[n],!1)}}}(t.children,e.value),n="share_module_".concat(Rn++);i.init(t.children,e.value),Fn[n]=i,t.setAttribute("data-module",n)},update:function(t,e){var i=t.getAttribute("data-module");Fn[i].init(t.children,e.value)},unbind:function(t){var e=t.getAttribute("data-module");Fn[e].unbind()}})}},Gn={success:"success",info:"info",warning:"warning",error:"error"},Vn={data:function(){return{visible:!1,message:"",duration:3e3,type:"info",iconClass:"",customClass:"",onClose:null,showClose:!1,closed:!1,timer:null,dangerouslyUseHTMLString:!1,center:!1}},computed:{iconWrapClass:function(){var t=["bili-message__icon"];return this.type&&!this.iconClass&&t.push("bili-message__icon--".concat(this.type)),t},typeClass:function(){return this.type&&!this.iconClass?"bili-message__icon bili-icon-".concat(Gn[this.type]):""}},watch:{closed:function(t){t&&(this.visible=!1,this.$el.addEventListener("transitionend",this.destroyElement))}},methods:{destroyElement:function(){this.$el.removeEventListener("transitionend",this.destroyElement),this.$destroy(!0),this.$el.parentNode.removeChild(this.$el)},close:function(){this.closed=!0,"function"==typeof this.onClose&&this.onClose(this)},clearTimer:function(){clearTimeout(this.timer)},startTimer:function(){var t=this;this.duration>0&&(this.timer=setTimeout(function(){t.closed||t.close()},this.duration))},keydown:function(t){27===t.keyCode&&(this.closed||this.close())}},mounted:function(){this.startTimer(),document.addEventListener("keydown",this.keydown)},beforeDestroy:function(){document.removeEventListener("keydown",this.keydown)}},Hn=(i(170),Object(mt.a)(Vn,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"bili-message-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],class:["bili-message",t.type&&!t.iconClass?"bili-message-"+t.type:"",t.center?"is-center":"",t.customClass],attrs:{role:"alert"},on:{mouseenter:t.clearTimer,mouseleave:t.startTimer}},[t.iconClass?i("i",{class:t.iconClass}):i("i",{class:t.typeClass}),t._v(" "),t._t("default",[t.dangerouslyUseHTMLString?i("p",{staticClass:"bili-message-content",domProps:{innerHTML:t._s(t.message)}}):i("p",{staticClass:"bili-message-content"},[t._v(t._s(t.message))])]),t._v(" "),t.showClose?i("i",{staticClass:"bili-icon-close",on:{click:t.close}}):t._e()],2)])},[],!1,null,null,null).exports),Bn=n.a.extend(Hn),qn=[],Wn=1,Qn=2e3,Xn=function t(e){if(!n.a.prototype.$isServer){"string"==typeof(e=e||{})&&(e={message:e});var i=e.onClose,s="message_"+Wn++;return e.onClose=function(){t.close(s,i)},($n=new Bn({data:e})).id=s,$n.vm=$n.$mount(),document.body.appendChild($n.vm.$el),$n.vm.visible=!0,$n.dom=$n.vm.$el,$n.dom.style.zIndex=e.zIndex||Qn++,"number"==typeof e.offset?$n.dom.style.top="".concat(e.offset||60,"px"):"string"==typeof e.offset&&($n.dom.style.top=e.offset||""),qn.push($n),$n.vm}};["success","warning","info","error"].forEach(function(t){Xn[t]=function(e){return"string"==typeof e&&(e={message:e}),e.type=t,Xn(e)}}),Xn.close=function(t,e){for(var i=0,n=qn.length;i<n;i++)if(t===qn[i].id){"function"==typeof e&&e(qn[i]),qn.splice(i,1);break}},Xn.closeAll=function(){for(var t=qn.length-1;t>=0;t--)qn[t].close()};var Yn=Xn,zn={Message:Yn,install:function(){n.a.prototype.$message=Yn}};i(171),Object.assign||Object.defineProperty(Object,"assign",{value:function(t,e){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),n=1;n<arguments.length;n++){var s=arguments[n];if(null!==s&&void 0!==s)for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(i[o]=s[o])}return i},writable:!0,configurable:!0}),Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(s){if("object"!==h(s)&&"function"!=typeof s||null===s)throw new TypeError("Object.keys called on non-object");var o=[];for(var a in s)t.call(s,a)&&o.push(a);if(e)for(var r=0;r<n;r++)t.call(s,i[r])&&o.push(i[r]);return o}}()),n.a.use(Ln,{preload:100}),n.a.use(Jn),n.a.use(zn),n.a.use(s.a),n.a.use(o.a);var Kn=new o.a.Store(ut),Zn=new s.a({mode:"history",routes:[{name:"webplay",path:"/bangumi/play/:id",component:Dn},{name:"innerplay",path:"/nodessr/bangumi/play/:id",component:Dn}]});n.a.mixin({beforeRouteUpdate:function(t,e,i){var n=this,s=t.params.id.substr(0,2),o=t.params.id.substr(2),a=[],r=!0;"ep"===s&&this.$store.state.epList.forEach(function(t){t.ep_id===Number(o)&&(r=!1)}),r?a.push(this.$store.dispatch({type:"FETCH_MEDIA_INFO",id:Number(o),viewType:s})):a.push(this.$store.dispatch({type:"EP_INFO_CHANGE",epId:Number(o)})),Promise.all(a).then(function(){r?("ep"===s&&n.$store.dispatch({type:"EP_INFO_CHANGE",epId:Number(o)}),n.$store.dispatch({type:"FETCH_USER_STAT",ssId:n.$store.state.ssId}).then(function(){if("ep"!==s){var t=n.$store.state.userStat.watchProgress&&n.$store.state.userStat.watchProgress.lastEpId>-1?n.$store.state.userStat.watchProgress.lastEpId:n.$store.state.epList[0]?n.$store.state.epList[0].ep_id:{};n.$store.dispatch({type:"EP_INFO_CHANGE",epId:t})}i()}).catch(i)):i()}).catch(i)}});var ts=function(t){return{app:new n.a({store:Kn,router:Zn,ssrContext:t,render:function(t){return t(_t)}}),router:Zn,store:Kn}}(),es=ts.app,is=ts.router,ns=ts.store;if(window.__INITIAL_STATE__)ns.replaceState(window.__INITIAL_STATE__);else{var ss=is.getMatchedComponents(),os=is.currentRoute.params.id,as=os.substr(0,2),rs=os.substr(2),cs=ss.map(function(t){return t.asyncData&&t.asyncData({store:ns,route:is.currentRoute,context:{params:{type:as,id:rs},ua:window.navigator.userAgent}})});cs.push(ns.dispatch({type:"VERSION_LOAD",ver:function(t){var e=((t=void 0===t?"undefined"!=typeof window?window.navigator.userAgent:"":t).split("BiliApp/")[1]||"").split(" ")[0]||"",i=isNaN(Number(e))?0:Number(e),n=/\(i[^;]+;( U;)? CPU.+Mac OS X/i.test(t),s=/Android/i.test(t)||/Linux/i.test(t);return t?{mobile:/AppleWebKit.*Mobile.*/i.test(t),ios:n,android:s,windowsPhone:/Windows Phone/i.test(t),iPhone:/iPhone/i.test(t),ios9:/iPhone OS\ 9_/i.test(t),iPad:/iPad/i.test(t),webApp:!/Safari/i.test(t),microMessenger:/MicroMessenger/i.test(t),weibo:/Weibo/i.test(t),uc:/UCBrowser/i.test(t),qq:/MQQBrowser/i.test(t),baidu:/Baidu/i.test(t),mqq:/QQ\/([\d\.]+)/i.test(t),mBaidu:/baiduboxapp/i.test(t),iqiyi:/iqiyi/i.test(t),qqLive:/QQLive/i.test(t),safari:/Safari/i.test(t),youku:/youku/i.test(t),ie:/MSIE/i.test(t)||/Trident/i.test(t),edge:/Edge/i.test(t),bili:/bili/i.test(t),biliVer:i}:{}}(window.navigator.userAgent)})),Promise.all(cs).then(function(){"ep"===as?(ns.state.epId=Number(rs),ns.state.epList.forEach(function(t){t.ep_id===ns.state.epId&&(ns.state.epInfo=t)})):ns.state.epInfo=ns.state.epList[0]||{};var t=ns.state.mediaInfo;window.document.title=J(ns.state.epInfo.index,t.title,Q(t.season_type,t.season_id),!0,2===ns.state.mediaInfo.mode),es.$mount("#client-app")}).catch()}is.onReady(function(){is.beforeResolve(function(t,e,i){var n=is.getMatchedComponents(t),s=is.getMatchedComponents(e),o=!1,a=n.filter(function(t,e){return o||(o=s[e]!==t)});a.length?Promise.all(a.map(function(e){if(e.asyncData)return e.asyncData({store:ns,route:t,context:{ua:window.navigator.userAgent}})})).then(function(){i()}).catch(i):i()}),window&&window.document.getElementById("app")&&es.$mount("#app")})}]);