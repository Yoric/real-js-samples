var CarouselVisibilityTracking;(function(){function s(n){if(n&&n.length>2){var f=n[1],t=n[2];i=n[3];r=n[4];u=_ge(f);i?e(t):o(t)}}function h(t){var h,u,f,r,s;if(t&&t.length>1)if(h=t[1],u=t[2],h){for(r=[],s=0;s<u;s++)r.push(!1);r.push.apply(r,n);n=r}else{for(f=0;f<u;f++)n.push(!1);i?e(!0):o(!0)}}function e(i){var a=ge_cl(u,"ent_id"),o,l,s,e,v,h;if(!(a.length<1))if(o=CarouselEntity.getCarouselObject().getVisibleTileIndices(i),t){for(s="",e=0;e<o.length;e++)n[o[e]]||(v=a[o[e]].id,v&&(h=v.split("_"),h[0]==null||h[1]==null||f[h[1]]||(s+=h[1],s+="~",n[o[e]]=!0)));s!=""&&Log.Log("ClientInst","Carousel",null,!0,"VisibleEntities",s)}else{for(r!=null&&c(r),l=0;l<a.length;l++)n[l]=!1;t=!0}}function o(i){var o=u.querySelectorAll(".productMvC"),s,h,r,e,f,c,l;if(!(o.length<1)&&(s=document.querySelectorAll("[data-ad-carousel='1']"),!(s.length<1)&&!(o.length<1))){if(!t){for(h=0;h<o.length;h++)n[h]=!1;t=!0}for(r=[],e=CarouselEntity.getCarouselObject().getVisibleTileIndices(i),f=0;f<e.length;f++)n[e[f]]||(c=o[e[f]],l=c&&c.attributes["mv-data"],l&&(r.push(l.value),n[e[f]]=!0));r.length>0&&(sj_plog("CI.AdImpression","Ads",r.join(),"Event.AdImpression"),sj_logToAES(r),s[0].attributes.testmv&&(s[0].attributes.testmv.value=r.join()))}}function c(n){var i=n.split("~"),t;if(i!=null)for(t=0;t<i.length;t++)i[t]!=null&&i[t]!=""&&(f[i[t]]=!0)}var n=[],t=!1,i=!1,f={},r,u;sj_evt.bind("carousel_visibletiles",s,!0);sj_evt.bind("carousel_tilesupdated",h,!0)})(CarouselVisibilityTracking||(CarouselVisibilityTracking={}))