(function(){function l(){if(!window.history.pushState)return;c(),h(),So.comm.ajax=function(e,t,n,r,i){typeof o!="undefined"&&(o=i),o=!0,p(!0,e,t,n,r)},jQuery.ajaxPrefilter("script",function(e){e.url&&(e.url.indexOf("qhres.com")>-1||e.url.indexOf("qhmsg.com")>-1)&&(e.cache=!0)})}function c(){t.on("submit",function(){window.noresultPage=undefined;var e=$(this).find(".input_key"),t=$.trim(e.val());if(t=="")return location.href="/",!1;if($(this).find('input[name="adv_t"]').length>0)return!0;var n=$(".adv-search-btn");return n.length>0&&n.attr("data-val")!="all"&&n.attr("data-val","all").html("\u65f6\u95f4\uff1a \u5168\u90e8").addClass("adv-search-btn-short"),p(!0,t,$(this).serialize()),o=!1,!1}),e.delegate("#page a,#rs th a,#rs-top dd a","click",function(e){var t=$(this).attr("href"),n=So.lib.parseQuery(t),r=n.q,i=n.pn;o=!1;if(i==1)return!0;p(!0,r,t),e.preventDefault()}),window.addEventListener("popstate",function(e){if(i==location.search)return;history.state&&e.state&&(e.state.load==0?p(!1,e.state.q,e.state.url):location.href=e.state.url)})}function h(){var e=So.comm.q,t="/s"+location.search;history.state==null&&window.history.replaceState({q:e,url:t,load:1},e,t)}function p(e,t,r,o,u){var a=So.comm.fr||"";a&&!So.lib.parseQuery(r).fr&&(r+="&fr="+encodeURIComponent(a));var l=r.substring(0,3)=="/s?"?r:"/s?"+r,c={q:t,url:l,load:0};e?window.history.pushState(c,t,l):window.history.replaceState(c,t,l),document.title=t+"_360\u641c\u7d22",i=location.search,n.val(t).blur(),$("html,body").scrollTop(0),b(),r=r.replace(/^\/s\?/i,"");if(s[r])g(s[r]),typeof o=="function"&&o(u);else{var h=+(new Date);$.ajax({url:"/s",type:"get",data:r,success:function(e){h=+(new Date)-h,f=!0;if(e){if(e=="ANTISPIDER")return location.href="/s?c=index&a=antispider",!1;g(e,h),typeof o=="function"&&o(u)}else location.href="/s?"+r},error:function(e,t,n){location.reload(!0);return}})}}function d(){TIME._=+(new Date);var t=PageLine.queues.release;PageLine.queues={release:t},$.each(So.page.unload,function(e,t){try{t()}catch(n){}}),So.page.unload=[],$.each(So.page.timers,function(e,t){clearInterval(t),clearTimeout(t)}),So.page.timers=[],$.each([".onebox",".dianjing",".tantan",".haosou",".so"],function(e,t){$(window).off(t),$(document).off(t),$(document.body).off(t)}),m(),e.removeClass(),$("body").removeClass("res-middle-page")}function v(){t.find('input[name="psid"]').val(So.comm.sid),$.each(So.page.reload,function(e,t){t()});var e=$('form[name="f2"] .s_site');e.length>0&&($("#site_rg_1").is(":checked")?$("#site_rg_b1").attr("checked","true"):$("#site_rg_b2").attr("checked","true"))}function m(){var e=["header","tabs-wrap","warper","search","footer","mohe","so_oly-chat","debug","debug-tools"];$("body > div, body > p, body > ul, body > canvas").each(function(){this.id=="mohe"&&!o?$(this).remove():$.inArray(this.id,e)==-1&&$(this).remove()}),$(".js-g-remove").remove()}function g(t,n){d(),e.html(t),w(),v(),window.setStorage&&setTimeout(function(){window.setStorage()},300,!0),E("succ",n||0)}function y(t){d(),e.html(t),w(),v(),E("err")}function b(){r?r.show().find("div").addClass("loading"):r=$('<div id="resBar"><div class="loading"></div></div>').appendTo("#header")}function w(){r.fadeOut(500),setTimeout(function(){r.find("div").removeClass("loading")},480)}function E(e,t){So.lib.log("ajax",{type:e,value:t||0})}var e=$("#warper"),t=$("form.form"),n=t.find(".input_key"),r=null,i=location.search,s={},o=!1,u=null,a=!1,f=!0;l()})();