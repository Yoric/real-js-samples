!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.RGBaster=t()}(this,function(){"use strict";var n=function(n,t){var e=new Image,r=n.src||n;"data:"!==r.substring(0,5)&&(e.crossOrigin="Anonymous"),e.onload=function(){var n,r,i,o=(n=e.width,r=e.height,(i=document.createElement("canvas")).setAttribute("width",n),i.setAttribute("height",r),i.getContext("2d"));o.drawImage(e,0,0);var u=o.getImageData(0,0,e.width,e.height);t&&t(u.data)},e.src=r},t=function(n){return["rgb(",n,")"].join("")},e=function(n,e){return{name:t(n),count:e}},r={};return r.colors=function(r,i){var o=(i=i||{}).exclude||[],u=i.paletteSize||10;n(r,function(n){for(var r={},a="",c=[],s=0;s<n.length;s+=4)c[0]=n[s],c[1]=n[s+1],c[2]=n[s+2],a=c.join(","),-1===c.indexOf(void 0)&&0!==n[s+3]&&-1===o.indexOf(t(a))&&(r[a]=a in r?r[a]+1:1);if(i.success){var f=function(n,t){if(n.length>t)return n.slice(0,t);for(var r=n.length-1;r<t-1;r++)n.push(e("0,0,0",0));return n}(function(n){var t=[];for(var r in n)t.push(e(r,n[r]));return t.sort(function(n,t){return t.count-n.count}),t}(r),u+1);i.success({dominant:f[0].name,secondary:f[1].name,palette:f.map(function(n){return n.name}).slice(1)})}})},r});