if(void 0===COMSCORE)var COMSCORE={};void 0===COMSCORE.SiteRecruit&&(COMSCORE.SiteRecruit={sv:"scor",testUrl:"broker-test.js",configUrl:"broker-config.js",builderUrl:"builder.js",allowScriptCaching:!1,CONSTANTS:{COOKIE_TYPE:{ALREADY_ASKED:1,DD_IN_PROGRESS:2},STATE_NAME:{IDLE:"IDLE",DDINPROGRESS:"DDINPROGRESS"}}},COMSCORE.SiteRecruit.Utils=function(){var r=COMSCORE.SiteRecruit;return{location:document.location.toString(),referrer:document.referrer.toString(),loadScript:function(e,t){t&&!r.allowScriptCaching&&(e=r.Utils.appendQueryParams(e,(new Date).getTime()));var i=document.createElement("script");i.src=e,document.body.appendChild(i)},cleanURL:function(e){var t=e.split("?");if(1<t.length){var r="?";if(/([^.@\s]+)(\.[^.@\s]+)*@([^.@\s]+\.)+([^.@\s]+)|%40/i.test(t[1])){var n=t[1].split("&");for(i=0;i<n.length;i++)/([^.@\s]+)(\.[^.@\s]+)*@([^.@\s]+\.)+([^.@\s]+)|%40/i.test(n[i])||(r+=0==i?n[i]:"&"+n[i]);e=1<r.length?t[0]+r:t[0]}}return e},getDevice:function(){var e=new RegExp("iphone|ipad|ipod|android|opera mini|blackberry|windows (phone|ce)|iemobile|htc|nokia|bb10|silk","i"),t=navigator.userAgent,i=new RegExp("phone|sm-(n|g)|pixel.+xl|ph-1|oneplus|lg-|nexus 6|lm-q","i"),r=self.screen.availWidth>self.screen.availHeight?self.screen.availWidth:self.screen.availHeight,n={};return e.test(t)?(n.type=2,770<=r&&!i.test(t)&&(n.type=3)):n.type=1,n},fireBeacon:function(e){setTimeout(function(){-1==e.indexOf("?")?e+=(/\?/.test(e)?"&":"?")+(new Date).getTime():e+="&"+(new Date).getTime(),(new Image).src=e},1)},appendQueryParams:function(e,t){return e?(e=e.replace("?","")+"?",t&&(e+=t.toString().replace("?","")),e):t},getRandom:function(e){function t(e,t,i,r,n){var s=Math.floor(e/i);return s=t*(e-s*i)-s*r,Math.round(s<0?s+n:s)}for(var i=2147483563,r=40014,n=53668,s=12211,o=2147483647&Math.round((new Date).getTime()%1e5),a=o,c=[32],u=0;u<19;u++)a=t(a,r,n,s,i);for(u=0;u<32;u++)a=t(a,r,n,s,i),c[31-u]=a;a=t(a,r,n,s,i),o=t(o,40692,52774,3791,2147483399);var l=Math.round((c[Math.floor(c[0]/67108862)]+o)%i),d=Math.floor(l/(i/(1e9+1)))/1e9;return void 0===e?d:Math.floor(d*(e+1))},getExecutingPath:function(e){for(var t=document.getElementsByTagName("script"),i=t.length-1;0<=i;i--){var r=t[i].src;if(-1!=(this.scriptUrl=r).indexOf("/"+e))return r.replace(/(.*)(\/.*)$/,"$1/")}},JSONDeserialize:function(e){try{if(""===e&&(e='""'),4<e.length){if(window.JSON&&window.JSON.parse)return-1==e.indexOf('"undefined"')?window.JSON.parse(e.replace("undefined",'"undefined"')):window.JSON.parse(e);var t=e.substring(1,e.indexOf(","))+e.substring(e.indexOf("}")+1,e.length-1),i=e.slice(e.indexOf("name"),e.indexOf("}")).replace(/"/gi,""),r=e.substring(e.indexOf("[")+1,e.indexOf("]")).replace(/"/gi,""),n=t.substring(0,t.indexOf("surveys")-1).replace(/"/gi,"")+t.substring(t.indexOf("],")+2,t.length).replace(/"/gi,""),s=i.split(","),o=r.split(","),a=n.split(","),c={};c.sv=a[0].substring(a[0].indexOf(":")+1),c.state={},c.state.name=s[0].substring(s[0].indexOf(":")+1),c.state.url=s[1].substring(s[1].indexOf(":")+1),c.state.timestamp=parseInt(s[2].substring(s[2].indexOf(":")+1)),c.lastinvited=parseInt(a[1].substring(a[1].indexOf(":")+1)),c.userid=a[2].substring(a[2].indexOf(":")+1),c.vendorid=parseInt(a[3].substring(a[3].indexOf(":")+1)),c.surveys=[];for(var u=0;u<o.length;u++)c.surveys.push(o[u]);return c.graceperiod=parseInt(a[4].substring(a[4].indexOf(":")+1)),c.trackertimestamp=parseInt(a[5].substring(a[5].indexOf(":")+1)),c}return null}catch(e){return null}},JSONSerialize:function(e){try{var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var i,r,n=[],s=e&&e.constructor==Array;for(i in e)"function"!=(t=typeof(r=e[i]))&&("string"==t?r='"'+r+'"':"object"==t&&null!==r&&(r=this.JSONSerialize(r)),n.push((s?"":'"'+i+'":')+String(r)));return(s?"[":"{")+String(n)+(s?"]":"}")}catch(e){return""}}}}(),COMSCORE.SiteRecruit.Utils.UserPersistence={maxNumberOfPids:6,CONSTANTS:{STATE_NAME:{IDLE:"IDLE",DDINPROGRESS:"DDINPROGRESS"}},getCookieName:function(){var e;return COMSCORE.SiteRecruit.Broker&&COMSCORE.SiteRecruit.Broker.config&&(e=COMSCORE.SiteRecruit.Broker.config.cookie).name?e.name:""},getDefaultCookieOptions:function(){return{path:"/",domain:""}},getVendorId:function(){return 1},createCookie:function(e,t,i){if(t=escape(t),i.duration&&i.duration<0)(r=new Date).setTime(r.getTime()+24*i.duration*60*60*1e3),t+="; expires="+r.toGMTString();else if("s"==i.duration)/msie|rv\:11|edge/i.test(navigator.userAgent)||(t+="; expires=");else{var r;(r=new Date).setTime(r.getTime()+63072e6),t+="; expires="+r.toGMTString()}return i.path&&(t+="; path="+i.path),i.domain&&(t+="; domain="+i.domain),i.secure&&(t+="; secure"),i.graceperiod&&(t+="; graceperiod="+i.graceperiod),document.cookie=e+"="+t,!0},removeCookie:function(e){document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/;"},getCookieValue:function(e){var t=document.cookie.match("(?:^|;)\\s*"+e+"=([^;]*)");return!!t&&unescape(t[1])},createUserObj:function(e){var t=new Date,i=e.pid,r=e.url,n=this.CONSTANTS.STATE_NAME.IDLE;e.statename&&(n=e.statename);var s=t.getTime();e.timestamp&&(s=e.timestamp);var o=this.getCookieName();e.cookiename&&(o=e.cookiename),e.cookieoptions||(e.cookieoptions=this.getDefaultCookieOptions());var a={};a.sv=COMSCORE.SiteRecruit.sv,a.state={},a.state.name=n,a.state.url=r,a.state.timestamp=s,a.lastinvited=s,a.userid=t.getTime().toString()+Math.floor(1e16*Math.random()).toString(),a.vendorid=this.getVendorId(),a.surveys=[],a.surveys.push(i),a.graceperiod=5;var c=COMSCORE.SiteRecruit.Utils.JSONSerialize(a);return this.createCookie(o,c,e.cookieoptions),a},setUserObj:function(e){var t,r,n,s,o,a,c,u,l=this.getUserObj(e);if(l||(l=this.createUserObj(e)),u=new Date,s=0,o=this.getCookieName(),a=5,c=0,n=this.CONSTANTS.STATE_NAME.IDLE,t=e.pid,e.url?r=e.url:l.state.url&&(r=l.state.url),e.statename?n=e.statename:l.state&&l.state.name&&(n=l.state.name),e.timestamp?s=e.timestamp:l.state&&l.state.timestamp&&(s=l.state.timestamp),e.cookiename&&(o=e.cookiename),e.cookieoptions||(e.cookieoptions=this.getDefaultCookieOptions()),e.graceperiod?a=e.graceperiod:l.graceperiod&&(a=l.graceperiod),e.trackertimestamp?c=e.trackertimestamp:l.trackertimestamp&&(c=l.trackertimestamp),l.lastinvited=u.getTime(),t){var d=!1;for(i=0;i<l.surveys.length;i++)l.surveys[i]&&l.surveys[i].toLowerCase()==t.toLowerCase()&&(d=!0);for(!1===d&&(l.surveys.length&&(l.surveys.length<this.maxNumberOfPids||l.surveys.splice(0,1)),l.surveys.push(t)),i=0;i<l.surveys.length;i++)null===l.surveys[i]&&l.surveys.splice(i,1)}n&&(l.state.name=n,l.state.url=r,l.state.timestamp=s,l.graceperiod=a,l.trackertimestamp=c);var g=COMSCORE.SiteRecruit.Utils.JSONSerialize(l);return this.createCookie(o,g,e.cookieoptions),l},getUserObj:function(e){var t=this.getCookieName();e.cookiename&&(t=e.cookiename);var i=this.getCookieValue(t);if(i&&""!==i){var r=COMSCORE.SiteRecruit.Utils.JSONDeserialize(i);if(r)return r}return null}},COMSCORE.SiteRecruit.DDKeepAlive=function(){var s,o=COMSCORE.SiteRecruit,a=o.Utils;return{start:function(){var e=this;s=setInterval(function(){o.Broker.isDDInProgress()&&e.isTrackerPageOpen()?e.setDDTrackerCookie():e.isTrackerPageOpen()?e.stop():e.handleClosedTrackerPage()},1e3)},stop:function(){clearInterval(s)},isTrackerPageOpen:function(){var e={};e.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;var t,i=a.UserPersistence.getUserObj(e),r=(new Date).getTime(),n=!0;if(i&&i.state&&i.state.name==o.CONSTANTS.STATE_NAME.DDINPROGRESS&&i.state.timestamp&&i.trackertimestamp){var s=r-i.trackertimestamp;if(COMSCORE.SiteRecruit.Builder&&COMSCORE.SiteRecruit.Builder.invitation&&COMSCORE.SiteRecruit.Builder.invitation.config?t=COMSCORE.SiteRecruit.Builder.invitation.config.trackerGracePeriod:i.gracePeriod&&(t=i.gracePeriod),t)s<2*(t=parseInt(t))*1e3||(n=!1)}return n},handleClosedTrackerPage:function(){var e={},t=o.Broker.config.cookie;e.cookiename=t.name,e.statename=o.CONSTANTS.STATE_NAME.IDLE,e.cookieoptions={path:t.path,domain:t.domain},e.url=escape(a.location),e.timestamp=(new Date).getTime(),a.UserPersistence.setUserObj(e),this.stop()},setDDTrackerCookie:function(){var e=o.Broker.config.cookie,t={};t.cookiename=e.name;var i=a.UserPersistence.getUserObj(t);t.cookiename=e.name,!(t.cookieoptions={path:e.path,domain:e.domain})===document.hidden||void 0===document.hidden?t.url=escape(a.location):t.url=a.UserPersistence.getUserObj(e.name).state.url,t.statename=o.CONSTANTS.STATE_NAME.DDINPROGRESS,t.timestamp=(new Date).getTime(),COMSCORE.SiteRecruit.Builder&&COMSCORE.SiteRecruit.Builder.invitation&&COMSCORE.SiteRecruit.Builder.invitation.config?(t.pid=COMSCORE.SiteRecruit.Builder.invitation.config.projectId,t.graceperiod=COMSCORE.SiteRecruit.Builder.invitation.config.trackerGracePeriod):i&&i.gracePeriod&&(t.graceperiod=i.graceperiod),a.UserPersistence.setUserObj(t)},mDDKeepAlive:function(){s=setInterval(function(){var e,t,i=0;null!=sessionStorage.locationList&&(e=sessionStorage.locationList),null!=sessionStorage.timeList&&(t=sessionStorage.timeList);var r=escape(a.cleanURL(window.location.toString()));if(/\,/.test(e)){var n=e.split(",");n[n.length-1]!=r&&(e+=","+r,t+=","+(new Date).getTime(),i=1)}else r!=e&&(e+=","+r,t+=","+(new Date).getTime(),i=1);1==i&&(sessionStorage.locationList=e,sessionStorage.timeList=t),0==COMSCORE.SiteRecruit.Utils.UserPersistence.getCookieValue("mDDS")&&(clearInterval(s),null!=sessionStorage.locationList&&sessionStorage.removeItem("locationList"),null!=sessionStorage.timeList&&sessionStorage.removeItem("timeList"),null!=sessionStorage.locationList&&sessionStorage.removeItem("csLocation"),null!=sessionStorage.timeList&&sessionStorage.removeItem("csReferrer"))},3e3)}}}(),COMSCORE.SiteRecruit.PagemapFinder=function(){var l,s=COMSCORE.SiteRecruit.Utils;return{getTotalFreq:function(){return l},find:function(e){var t=window.location.toString();/cs\_tstMode\=(.+)/i.test(t)&&/([^\#+]*)/.test(t)&&(t=RegExp.$1);for(var i=e,r=[],n=!1,s=l=0;i&&s<i.length;s++){var o=!1,a=i[s];if(a){var c=new RegExp(a.m,"i");if(-1!=t.search(c)){var u=i[s].prereqs;o=!0,u&&(this.isMatchContent(u.content)||(o=!1),this.isMatchCookie(u.cookie)||(o=!1),this.isMatchLanguage(u.language)||(o=!1))}if(o){if(a.halt){n=!0;break}r.push(a),l=a.f}}}return!0===n?(l=0,r=null):this.choosePriority(r)},choosePriority:function(e){for(var t=null,i=0;i<e.length;i++)null===t?(t=e[i],l=e[i].f):t.p<e[i].p&&(t=e[i],l=e[i].f);return t},isMatchContent:function(e){for(var t=!0,i=0;t&&i<e.length;){var r=!1,n=!1,s=e[i];if(s.element)for(var o=document.getElementsByTagName(s.element),a=!0,c=0;c<o.length;c++){var u=new RegExp(s.elementValue,"i");if(u?u.test(o[c].innerHTML)&&(a&&(a=!1),r=!0):r=!0,s.attrib&&s.attrib.length){var l=o[c].attributes.getNamedItem(s.attrib),d=new RegExp(s.attribValue);l&&(s.attribValue&&s.attribValue.length?d.test(l.value)&&(n=!0):n=!0)}else n=!0}r&&n||(t=!1),i++}return t},isMatchCookie:function(e){for(var t=!0,i=0;t&&i<e.length;){var r=e[i],n=s.UserPersistence.getCookieValue(r.name);r=e[i];if(!(n=s.UserPersistence.getCookieValue(r.name))||null===n)return!1;t=new RegExp(r.value,"i").test(n),i++}return t},isMatchLanguage:function(e){var t=navigator.language||navigator.userLanguage;return t=t.toLowerCase(),!e||!!new RegExp(e).test(t)}}}(),COMSCORE.SiteRecruit.Broker=function(){var l=COMSCORE.SiteRecruit,d=l.Utils;return{init:function(){l.device=d.getDevice(),d.location=d.cleanURL(d.location),d.referrer=d.cleanURL(d.referrer),l.executingPath=d.getExecutingPath("broker.js"),/cs\_tstMode/i.test(window.location)&&d.loadScript("https://www.microsoft.com/library/svy/"+l.testUrl,!0);var e=d.UserPersistence.getCookieValue("msresearch"),t=!1,i="";if(e){var r=COMSCORE.SiteRecruit.Utils.JSONDeserialize(e);if(r&&(r.state.name&&(i=r.state.name),r.lastinvited)){var n=(new Date).getTime()-7776e6;r&&r.lastinvited>n&&(t=!0)}}var s=d.UserPersistence.getCookieValue("cddsinprogress");"IDLE"==i&&t&&!s||d.loadScript(l.executingPath+l.configUrl,!0)},start:function(){this.init()},run:function(){COMSCORE.SiteRecruit.Broker.config.mTracker;var e=COMSCORE.SiteRecruit.Utils.UserPersistence.getCookieValue("mDDS");if(/^1/.test(e)&&/pid=(p\d+)\,site\=(\d+)/.test(e)&&(d.loadScript(l.executingPath+"inv_mdds_"+RegExp.$1+"_"+RegExp.$2+".js",!0),COMSCORE.SiteRecruit.DDKeepAlive.mDDKeepAlive()),this.config.Events.beforeRecruit(),this.config.mobile){var t=new RegExp(this.config.mobile.match,"i");if(!0===this.config.mobile.halt&&t.test(navigator.userAgent))return}if(l.sv===this.config.sv){var i,r,n=this.config.testMode;if(i=!1!==d.UserPersistence.getCookieValue("tstMode"),r=n||i,this.isDDInProgress()&&this.processDDInProgress(),!n||this.isDDInProgress()){var s={};s.cookiename=this.config.cookie.name;var o=d.UserPersistence.getUserObj(s),a=new Date,c=this.config.cookie.duration,u=a.getTime()-24*c*60*60*1e3;if(o&&o.lastinvited>u)return}if(this.findPageMapping()&&(!COMSCORE.SiteRecruit._halt||!0!==COMSCORE.SiteRecruit._halt))if(r)this.pagemap&&this.loadBuilder();else d.getRandom()<=l.PagemapFinder.getTotalFreq()&&this.pagemap&&this.loadBuilder()}},mDDSbuildLayer:function(e,t,i,r,n){COMSCORE.SiteRecruit.Utils;var s=document.createElement("div");s.id=r;var o=s;o.innerHTML=e;var a=this.mDDSgetPageWidth(2),c=this.mDDSgetPageHeight(2),u=o.style;u.position="fixed",u.zIndex=1999999999999,u.left=a,u.top=c,u.marginLeft=-1*t+"px",u.marginTop=-1*i+"px",u.visibility=1==n?"visible":"hidden",document.body.appendChild(o)},mDDSdestroyLayer:function(e){var t=document.getElementById(e);t.style.visibility="hidden";try{t.parentNode.removeChild(t)}catch(e){}},mDDSshowLayer:function(e){document.getElementById(e).style.visibility="visible"},mDDSlaunchSurvey:function(){var e=COMSCORE.SiteRecruit.mobile.tracker;/pid=(p\d+)\,site\=(\d+),frequency\=(.+)/.test(d.UserPersistence.getCookieValue("mDDS"))&&(e.f=RegExp.$3);var t=d.UserPersistence.getUserObj("msresearch");d.UserPersistence.removeCookie("mDDS"),null!=sessionStorage.locationList?e.acceptParams.raw+="&locationList="+sessionStorage.locationList+"&timeList="+sessionStorage.timeList+"&location="+sessionStorage.csLocation+"&referrer="+sessionStorage.csReferrer:e.acceptParams.raw+="&locationList=NOTSUPPORTED&timeList=NOTSUPPORTED&location=NOTSUPPORTED&referrer=NOTSUPPORTED",null!=sessionStorage.removeItem("locationList")&&sessionStorage.removeItem("locationList"),null!=sessionStorage.removeItem("timeList")&&sessionStorage.removeItem("timeList"),null!=sessionStorage.removeItem("csLocation")&&sessionStorage.removeItem("csLocation"),null!=sessionStorage.removeItem("csReferrer")&&sessionStorage.removeItem("csReferrer"),e.beforeSubmit(),window.open(e.acceptUrl+"?"+e.acceptParams.raw+"&site="+e.acceptParams.siteCode+"&projectId="+e.projectId+"&SRmethodology="+e.methodology+"&weight="+e.weight+"&device="+COMSCORE.SiteRecruit.device.type+"&sv=scor&frequency="+e.f+"&userid="+t.userid+"&surveys="+t.surveys,"","")},mDDStrackerSwap:function(e){1==e?(this.mDDSdestroyLayer("csMenu"),this.mDDSlaunchSurvey()):(this.mDDSdestroyLayer("csTrack"),this.mDDSshowLayer("csMenu"))},mDDSgetPageWidth:function(e){switch(e){case 0:return"0%";case 1:return"50%";case 2:return"100%";default:return"0%"}},mDDSgetPageHeight:function(e){switch(e){case 0:return"0%";case 1:return"50%";case 2:return"100%";default:return"0%"}},isDDInProgress:function(){var e=!1,t={};t.cookiename=COMSCORE.SiteRecruit.Broker.config.cookie.name;var i=d.UserPersistence.getUserObj(t);return i&&i.state.name==l.CONSTANTS.STATE_NAME.DDINPROGRESS&&(e=!0),e},processDDInProgress:function(){l.DDKeepAlive.start()},findPageMapping:function(){return this.pagemap=l.PagemapFinder.find(this.config.mapping),this.pagemap},loadBuilder:function(){var e=l.executingPath+l.builderUrl;d.loadScript(e)}}}(),COMSCORE.isDDInProgress=COMSCORE.SiteRecruit.Broker.isDDInProgress,COMSCORE.SiteRecruit.OnReady=function(){var o=COMSCORE.SiteRecruit;return{onload:function(){o.OnReady.done||(o.OnReady.done=!0,o.Broker.start(),o.OnReady.timer&&clearInterval(o.OnReady.timer),document.addEventListener&&document.removeEventListener("DOMContentLoaded",o.OnReady.onload,!1))},listen:function(){var e=document.domain.split(".");e="."+e[e.length-2]+"."+e[e.length-1];var t="msresearch",i=COMSCORE.SiteRecruit.Utils.UserPersistence.getCookieValue(t);/DDINPROGRESS/i.test(i)&&(COMSCORE.SiteRecruit.Broker.config={cookie:{name:t,path:"/",domain:e,duration:90,rapidDuration:0,expireDate:""}},COMSCORE.SiteRecruit.Broker.processDDInProgress());var r=document.domain.split("."),n="";r=r[r.length-2]+"."+r[r.length-1];var s=new RegExp(r,"i");if(""!==document.referrer&&(n=document.referrer),""===n||void 0===n||s.test(n)?o.Broker.delayConfig=!1:o.Broker.delayConfig=!0,document.addEventListener&&(/loading|uninitialized/i.test(document.readyState)?document.addEventListener("DOMContentLoaded",o.OnReady.onload,!1):o.OnReady.onload()),window.ActiveXObject)COMSCORE.SiteRecruit.OnReady.waitForLoad=setInterval(function(){try{document.documentElement.doScroll("left")}catch(e){return}COMSCORE.SiteRecruit.OnReady.waitForLoad=clearInterval(COMSCORE.SiteRecruit.OnReady.waitForLoad),COMSCORE.SiteRecruit.OnReady.onload()},1e3);else if(window.addEventListener)window.addEventListener("load",o.OnReady.onload,!1);else if(window.attachEvent)return window.attachEvent("onload",o.OnReady.onload)},f:[],done:!1,timer:null}}(),COMSCORE.SiteRecruit.OnReady.listen());