!function(e){var t,r,o,n,i,c,a;i=[],t={SERVER_PV_URL:"https://pv.csdn.net/csdnbi",SERVER_RE_URL:"https://re.csdn.net/csdnbi",DELAY:500,DEBUG:!0},n={PV:"pv",VIEW:"view",CLICK:"click"},a={SKIPPED_AND_VISIBLE:"0",VISIBLE:"1"},o={getCookie:function(e){var t,r=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(r))?unescape(t[2]):null},buildRequestData:function(t,r){var o;return o=n.PV==t?{headers:{component:"enterprise",datatype:"track",version:"v1"},body:JSON.stringify({re:e.param(r)})}:{headers:{component:"enterprise",datatype:"re",version:"v1"},body:JSON.stringify({re:e.param(r)})}},serverUrl:function(e){return n==e?t.SERVER_PV_URL:t.SERVER_RE_URL},initData:function(){var t,r;return c={uid:(null!=(t=/(; )?(UserName|_javaeye_cookie_id_)=([^;]+)/.exec(window.document.cookie))?t[3]:void 0)||"-",ref:window.document.referrer,pid:window.location.host.split(".csdn.net")[0],mod:"",con:"",ck:"-",curl:window.location.href,session_id:o.getCookie("dc_session_id"),cfg:{viewStrategy:a.VISIBLE}},e("meta[name=track]").attr("content")&&(r=JSON.parse(e("meta[name=track]").attr("content"))),r&&(c=e.extend({},c,r)),c},tos:function(){var e,t,r,o;e=+new Date/1e3|0,r=null!=(t=/\bdc_tos=([^;]*)(?:$|;)/.exec(document.cookie))?t[1]:void 0;try{o=e-parseInt(r,36)}catch(n){console.warn("tos init error",n),o=-1}return document.cookie="dc_tos="+e.toString(36)+" ; expires="+new Date(1e3*(e+14400)).toGMTString()+" ; max-age=14400 ; path=/ ; domain=."+this.topDomain(window.location.host),o},topDomain:function(e){return/\.?([a-z0-9\-]+\.[a-z0-9\-]+)(:\d+)?$/.exec(e)[1]},copyArr:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t},isView:function(e,t){var r=this;if(!e)return!1;var o=this.getElementBottom(e),n=o+e.offsetHeight;return a.VISIBLE==t?r.scrollTop()<o&&o<r.scrollTop()+r.windowHeight()||r.scrollTop()<n&&n<r.scrollTop()+r.windowHeight():a.SKIPPED_AND_VISIBLE==t?o<=r.scrollTop()+r.windowHeight()||(r.scrollTop()<o&&o<r.scrollTop()+r.windowHeight()||r.scrollTop()<n&&n<r.scrollTop()+r.windowHeight()):void 0},scrollTop:function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop)},windowHeight:function(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},getElementTop:function(t){if("undefined"!=typeof jQuery)return e(t).offset().top;var r=t.offsetTop;for(t=t.offsetParent;null!=t;)r+=t.offsetTop,t=t.offsetParent;return r},getElementBottom:function(t){if("undefined"!=typeof jQuery)return e(t).offset().top+e(t).height();var r=t.offsetTop;for(t=t.offsetParent;null!=t;)r+=t.offsetTop,t=t.offsetParent;return r},url2Obj:function(e){var t={},r=e.split("&");for(var o in r)t[r[o].split("=")[0]]=decodeURIComponent(r[o].split("=")[1]);return t},fixParamConTop:function(t,r){return t.con.split(",top_")>-1?t:(t.con=t.con+",top_"+e(r).offset().top,t)},needReport:function(){var e=10;return!c.session_id||c.session_id.split(".")[1]%10<e}},r={timer:0,checkTimer:0,reportServer:function(r,c){if(o.needReport()&&this.reportServerNew(r,c),"undefined"!=typeof r&&"undefined"!=typeof c){var a=o.buildRequestData(r,c);i.push(a)}var s=o.copyArr(i);i=[];var d=n.PV==r?t.SERVER_PV_URL:t.SERVER_RE_URL;e.ajax({url:d,type:"POST",crossDomain:!0,xhrFields:{withCredentials:!0},contentType:"text/plain;charset=UTF-8",data:JSON.stringify(s),success:function(){},error:function(){console.error("csdn.track.reportServer()",arguments)}})},reportServerNew:function(t,r){var c=o.copyArr(i);if("undefined"!=typeof t&&"undefined"!=typeof r){var a=o.buildRequestData(t,r);c.push(a)}var s=n.PV==t?"https://pv1.csdn.net/csdnbi":"https://re1.csdn.net/csdnbi";e.ajax({url:s,type:"POST",crossDomain:!0,xhrFields:{withCredentials:!0},contentType:"text/plain;charset=UTF-8",data:JSON.stringify(c),success:function(){},error:function(){console.error("csdn.track.reportServer()",arguments)}})},reportServerDelay:function(e,r){var n=o.buildRequestData(e,r);i.push(n);var c=this;c.timer&&clearTimeout(c.timer),c.timer=setTimeout(function(){c.reportServer()},t.DELAY)},reportView:function(t,r,i){t=o.fixParamConTop(t,r);var a=e.extend(!0,{},c,t);a.ck="-",delete a.cfg,a.type=n.VIEW,"undefined"==typeof i?this.reportServerDelay(n.VIEW,a):this.reportServer(n.VIEW,a),"function"==typeof csdn.afterTrackReportView&&csdn.afterTrackReportView(r,t)},reportClick:function(t,r){t=o.fixParamConTop(t,r);var i=e.extend(!0,{},c,t);i.ck=i.con,delete i.cfg,i.type=n.CLICK,this.reportServer(n.CLICK,i)},reportPageView:function(t){var r=e.extend(!0,{},c,t);r.tos=o.tos(),r.referrer=r.ref,r.user_name=r.uid,r.ref="",r.uid="",delete r.cfg,r.type=n.PV,this.reportServer(n.PV,r)},viewCheck:function(){var t=this;clearTimeout(t.checkTimer),t.checkTimer=setTimeout(function(){e("[data-track-view]").each(function(){var t=e(this),r=e.extend({},c,t.data("trackView"));o.isView(t.get(0),r.cfg.viewStrategy)&&(csdn.track.reportView(r,this),t.removeData("trackView"),t.removeAttr("data-track-view"))})},200)},isView:function(e){return o.isView(e)},debug:function(e,t){var r,n;for(var i in e)n=e[i],r=o.url2Obj(JSON.parse(n.body).re),"undefined"!=typeof t?console.log(r.type,"-->:",n.headers.datatype,r.mod,r.con):console.log(r.type,"-->:",r)}},void 0===window.csdn&&(window.csdn={}),window.csdn.track=r,c=o.initData(),c.disabled||csdn.track.reportPageView()}(jQuery),jQuery(function(){var e=csdn.track;jQuery(document).on("click","[data-track-click]",function(){var t=jQuery(this).data("trackClick");e.reportClick(t,this)}),e.viewCheck(jQuery("[data-track-view]")),jQuery(window).on("scroll",function(){e.viewCheck(jQuery("[data-track-view]"))})});