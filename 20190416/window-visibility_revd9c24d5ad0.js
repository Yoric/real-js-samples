var __extends=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c),b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__decorate=this&&this.__decorate||function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g};define(["require","exports","ts/utils","ts/event"],function(a,b,c,d){"use strict";var e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.isVisibleState=!0,b.onWindowFocus=function(){b.isVisibleState=!0,b.trigger("visibilityChange",b.isVisible())},b.onWindowBlur=function(){b.isVisibleState=!1,b.trigger("visibilityChange",b.isVisible())},b.onWindowVisibilityChange=function(a,c){void 0===c&&(c=b.isVisibility()),b.isVisibleState=c,b.trigger("visibilityChange",b.isVisible())},b}return __extends(b,a),b.prototype.init=function(){var a=this,b=this.getVisibilityKeys();return setTimeout(function(){window.addEventListener("focus",a.onWindowFocus),window.addEventListener("blur",a.onWindowBlur),document.addEventListener(b.event,a.onWindowVisibilityChange)}),this},b.prototype.destroy=function(){return a.prototype.destroy.call(this),window.removeEventListener("focus",this.onWindowFocus),window.removeEventListener("blur",this.onWindowBlur),this},b.prototype.isVisible=function(){return this.isVisibleState},b.prototype.isVisibility=function(){var a=this.getVisibilityKeys();return!document[a.state]},b.prototype.getVisibilityKeys=function(){var a,b,c={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(b in c)if(c.hasOwnProperty(b)&&void 0!==document[b]){a=c[b];break}return{event:a,state:b}},b=__decorate([c.meta({autoInit:!0}),c.extend(d)],b)}(d);return e});