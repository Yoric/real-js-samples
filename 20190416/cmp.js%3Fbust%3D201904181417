define(["vendors/IAB-vendorlist","common/dmp-api"],function(n,e){window.__cmp_tools.getCookie=function(n,e){var o=document.cookie;if(new RegExp(n).test(o)){var t=o.split(n+"=").pop().split(";").shift();return t}return e},window.__cmp_tools.isStatAccepted=function(){var n=window.__cmp_tools.getCookie("__55CC");if(!n)return!0;var e=JSON.parse(decodeURIComponent(n));if(e.ccus){var o=[63,55,59,51,47,43,39,35];return o.indexOf(e.ccbm)>-1}},window.__cmp_tools.isProfilingAccepted=function(){var n=window.__cmp_tools.getCookie("__55CC");if(!n)return!0;var e=JSON.parse(decodeURIComponent(n));if(e.ccus){var o=[37,39,45,47,53,55,63];return o.indexOf(e.ccbm)>-1}},window.__cmp_tools.activateCmp=function(){function e(){try{var n,e=window.__cmp_tools.getCookie("__55CC");n=e?JSON.parse(decodeURIComponent(e)):{ccbm:63};var o={CC55_63:[63,["Sta","Per","Soc","Ad"],[1,2,3,4,5]],CC55_55:[55,["Sta","Per","Ad"],[1,2,3,4,5]],CC55_61:[61,["Per","Soc","Ad"],[1,2,3,4]],CC55_59:[59,["Sta","Soc","Ad"],[1,2,3,5]],CC55_57:[57,["Soc","Ad"],[1,2,3]],CC55_53:[53,["Per","Ad"],[1,2,3,4]],CC55_51:[51,["Sta","Ad"],[1,2,3,5]],CC55_49:[49,["Ad"],[1,2,3]],CC55_47:[47,["Sta","Per","Soc"],[4,5]],CC55_45:[45,["Per","Soc"],[4]],CC55_43:[43,["Sta","Soc"],[5]],CC55_41:[41,["Soc"],[]],CC55_39:[39,["Sta","Per"],[4,5]],CC55_37:[37,["Per"],[4]],CC55_35:[35,["Sta"],[5]],CC55_33:[33,[],[1]]},t=o["CC55_"+n.ccbm];if(t)return t[2]}catch(c){}return[]}function o(n){var e=new window.__cmp_tools.ConsentString;return e.cmpId=0,e.cmpVersion=1,e.version=1,e.consentLanguage="fr",e.consentScreen=0,e.created=new Date,e.allowedPurposeIds=[],e.allowedVendorIds=n.map(function(n){return n.id}),e}function t(n){var t=0,r=[],d=0;n&&n.vendorListVersion&&(t=n.vendorListVersion,r=n.vendors,r=r.sort(function(n,e){return n.id-e.id}),d=r[r.length-1].id);var i=o(r);i.setGlobalVendorList(n),i.maxVendorId=d,i.vendorListVersion=t,i.allowedPurposeIds=e(),i.lastUpdated=new Date,window.__cmp_consent_string=window.__cmp_tools.encodeConsentString(i),window.__cmp=function(o,c,d){return"function"!=typeof d?void console.warn("common/cmp::window.__cmp::CALLBACK SOULD BE A FUNCTION"):void("ping"===o?d({gdprAppliesGlobally:!0,cmpLoaded:!0},!0):"getVendorConsents"===o?(i.allowedPurposeIds=e(),i.lastUpdated=new Date,window.__cmp_consent_string=window.__cmp_tools.encodeConsentString(i),d({cmpId:i.getCmpId(),cmpVersion:i.getCmpVersion(),consentLanguage:i.getConsentLanguage(),consentScreen:i.getConsentScreen(),cookieVersion:1,created:i.created,gdprApplies:!0,hasGlobalScope:!0,lastUpdated:i.lastUpdated,maxVendorId:i.maxVendorId,metadata:i.getMetadataString(),purposeConsents:i.allowedPurposeIds.reduce(function(n,e){return n[e]=!0,n},{1:!1,2:!1,3:!1,4:!1,5:!1}),vendorConsents:r.reduce(function(n,e){return n[e.id]=!0,n},{}),vendorListVersion:i.vendorListVersion},!0)):"getConsentData"===o?(i.allowedPurposeIds=e(),i.lastUpdated=new Date,window.__cmp_consent_string=window.__cmp_tools.encodeConsentString(i),d({consentData:window.__cmp_consent_string,gdprApplies:!0,hasGlobalScope:!0},!0)):"getVendorList"===o?t===c?d(n,!0):d(null,!1):d({command:o,cmpLoaded:!0,error:"invalid command"},!1))},window.__cmp.cmpMsgHandler=function(n){var e=n&&n.data&&n.data.__cmpCall;e&&window.__cmp(e.command,e.parameter,function(o,t){n.source.postMessage({__cmpReturn:{callId:e.callId,command:e.command,success:t,returnValue:o}},n.origin)})},window.addEventListener?window.addEventListener("message",window.__cmp.cmpMsgHandler,!1):window.attachEvent("onmessage",window.__cmp.cmpMsgHandler),c.length&&c.forEach(function(n){n.event?window.__cmp.cmpMsgHandler(n.event):window.__cmp(n.command,n.parameter,n.callback)})}var c=[];window.__cmp&&window.__cmp.commandQueue&&(c=window.__cmp.commandQueue,window.__cmp.commandQueue=[]),t(n||[])};var o=setInterval(function(){if(window.cookieconsent){var n=window.__cmp_tools.getCookie("__55CC");if(n){var t=JSON.parse(decodeURIComponent(n));t.ccus&&(clearInterval(o),window.__cmp_tools.activateCmp(),e.sendPorofilingConsent(window.__cmp_tools.isProfilingAccepted()),console.log("CMP IS READY"))}}},100);return{hasCookieConsent:function(){var n=window.__cmp_tools.getCookie("__55CC");try{var e=JSON.parse(decodeURIComponent(n));if(e.ccus)return!0}catch(o){return!1}},get55CC:function(){return new Promise(function(n){var e=setInterval(function(){var o=window.__cmp_tools.getCookie("__55CC");if(o){var t=JSON.parse(decodeURIComponent(o));t.ccus&&(clearInterval(e),n(t.ccbm))}},500)})},getIABConsentString:function(){return new Promise(function(n){var e=setInterval(function(){var o=window.__cmp_consent_string;o&&(clearInterval(e),n(o))},350)})}}});