(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{"+pBb":function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"i",function(){return s}),n.d(t,"j",function(){return o}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return c}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return u}),n.d(t,"f",function(){return m}),n.d(t,"l",function(){return p}),n.d(t,"k",function(){return h}),n.d(t,"n",function(){return g}),n.d(t,"m",function(){return f}),n.d(t,"q",function(){return k}),n.d(t,"s",function(){return v}),n.d(t,"r",function(){return b}),n.d(t,"v",function(){return y}),n.d(t,"u",function(){return S}),n.d(t,"w",function(){return _}),n.d(t,"a",function(){return C}),n.d(t,"o",function(){return E}),n.d(t,"p",function(){return N}),n.d(t,"t",function(){return D}),n.d(t,"K",function(){return I}),n.d(t,"F",function(){return T}),n.d(t,"P",function(){return w}),n.d(t,"M",function(){return F}),n.d(t,"I",function(){return O}),n.d(t,"D",function(){return M}),n.d(t,"J",function(){return U}),n.d(t,"E",function(){return x}),n.d(t,"H",function(){return R}),n.d(t,"C",function(){return A}),n.d(t,"L",function(){return P}),n.d(t,"G",function(){return j}),n.d(t,"z",function(){return L}),n.d(t,"y",function(){return B}),n.d(t,"B",function(){return W}),n.d(t,"N",function(){return V}),n.d(t,"A",function(){return H}),n.d(t,"Q",function(){return q}),n.d(t,"x",function(){return G}),n.d(t,"O",function(){return z}),n.d(t,"S",function(){return Q}),n.d(t,"R",function(){return K});var i=n("Tznh"),r="chat.CHAT_HIDDEN",a="chat.CHAT_SHOWN",s="chat.EMOTE_SETS_UPDATED",o="chat.FOLLOWER_MODE_DURATION_PREFERENCE_CHANGED",d="chat.AUTOMOD_ACTIONS_ENABLED",c="chat.AUTOMOD_ACTIONS_DISABLED",l="chat.EMOTE_PICKER_CLOSED",u="chat.EMOTE_PICKER_OPENED",m="chat.CLOSE_CHAT_RULES",p="chat.MODERATION_ACTIONS_ENABLED",h="chat.MODERATION_ACTIONS_DISABLED",g="chat.MOD_ICONS_ENABLED",f="chat.MOD_ICONS_DISABLED",k="chat.SHOW_CHAT_RULES",v="chat.TIMESTAMPS_ENABLED",b="chat.TIMESTAMPS_DISABLED",y="chat.VIEWER_CHAT_FILTER_ENABLED",S="chat.VIEWER_CHAT_FILTER_DISABLED",_="chat.VIEWER_CHAT_FILTER_SETTINGS_CHANGED",C="chat.ADD_COMMAND",E="chat.REMOVE_COMMAND",N="chat.RENDER_SENT_CHAT_MESSAGE",D="chat.UNHIDE_IGNORED_COMMAND";function I(){return{type:v}}function T(){return{type:b}}function w(){return{type:a}}function F(){return{type:r}}function O(){return{type:d}}function M(){return{type:c}}function U(){return{type:p}}function x(){return{type:h}}function R(){return{type:g}}function A(){return{type:f}}function P(e){return{type:y,source:e||i.c.Other}}function j(e){return{type:S,source:e||i.c.Other}}function L(e,t){return{type:_,settings:e,source:t||i.c.Other}}function B(e,t){return{type:o,channelLogin:e,duration:t}}function W(){return{type:l}}function V(){return{type:u}}function H(){return{type:m}}function q(){return{type:k}}function G(e,t,n){return{type:C,command:e.toLowerCase(),handler:t,channelLogin:n}}function z(e,t,n){return{type:E,command:e.toLowerCase(),handler:t,channelLogin:n}}function Q(e){return{type:N,customEvent:e}}function K(e){return{type:D,userID:e}}},"/HY+":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=n("ZS2+").a.wrap(function(){return n.e(244).then(n.bind(null,"q0CL"))},"ReportUserModal")},"0FG4":function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c});var i,r=n("RcPG"),a=n("a1OF");!function(e){e[e.Position=0]="Position",e[e.Token=1]="Token"}(i||(i={}));var s="0";function o(e,t,n){var s,o,d=n.type===i.Position?t:e,c=n.map[d];if(c){var l=(s=e,o=c.id,{images:{sources:{"1x":Object(a.d)(o,1),"2x":Object(a.d)(o,2),"4x":Object(a.d)(o,4)},themed:!1},alt:s,emoteID:o});return{type:r.a.Emote,content:l}}return null}var d={"\\:\\&gt\\;":[":>"],"\\&gt\\;\\(":[">("],"\\&lt\\;\\]":["<]"],"\\&lt\\;3":["<3"],":-?(?:7|L)":[":-7",":-L",":7",":L"],"[oO](_|\\.)[oO]":["o_o","O_O","o_O","O_o","o.o","O.O","o.O","O.o"],"\\;-?(p|P)":[";-p",";-P",";p",";P"],"\\;-?\\)":[";-)",";)"],"\\:-?(o|O)":[":-o",":-O",":o",":O"],"\\:-?(p|P)":[":-p",":-P",":p",":P"],"\\:-?(S|s)":[":-S",":-s",":s",":S"],"\\:-?[\\\\/]":[":-/",":-\\",":/",":\\"],"\\:-?[z|Z|\\|]":[":-|",":-Z",":-z",":|",":Z",":z"],"\\:-?\\(":[":-(",":("],"\\:-?\\)":[":-)",":)"],"\\:-?D":[":-D",":D"],"#-?[\\\\/]":["#-/","#-\\","#/","#\\"],"B-?\\)":["B-)","B)"],"R-?\\)":["R-)","R)"]};function c(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n];if(r&&r.emotes)for(var a=0,o=r.emotes;a<o.length;a++){var c=o[a];if(c&&c.id&&c.token)for(var l=0,u=d[c.token]||[c.token];l<u.length;l++){var m=u[l];t[m]&&r.id===s||(t[m]={id:c.id,token:m})}}}return t}},"0JUI":function(e,t,n){},"1MDS":function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"c",function(){return p}),n.d(t,"b",function(){return h});var i=n("mrSG"),r=n("/7QA"),a=n("2xye"),s=n("oK83"),o=n("P5MF"),d=n("nR4f"),c=n("P6kH"),l={Unknown:"unknown",Chat:"chat",Room:"room",Whisper:"whisper",Vod:"vod"},u={Close:"close",ReportDropDown:"report_drop_down",Report:"report",Follow:"follow",Unfollow:"unfollow",Subscribe:"subscribe",ClickTryPrime:"click_try_prime",GoToChannel:"go_to_channel",Open:"open",ClickChannelName:"click_channel_name",CloseClickOtherEmote:"close_click_other_emote"},m={Available:"available",CreatorBanned:"creator_banned",LimitedTimeEmote:"limited_time_emote",GlobalEmote:"global_emote",Prime:"prime",Turbo:"turbo",OtherUnlockable:"other_unlockable"};function p(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,s,l,u,m,p,h,f,k,v,b,y,S,_,C;return i.__generator(this,function(i){switch(i.label){case 0:t={emoteID:e.emoticonID},n=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.q.apollo.client.query({query:d,variables:t})];case 2:return n=i.sent(),[3,4];case 3:return s=i.sent(),r.k.warn(s,"Failed to make query for emote info in EmoteCard reporting.",{emoteID:e.emoticonID}),[3,4];case 4:l=n&&n.data&&n.data.emote||null,n&&!l&&r.k.warn("Query for emote info in EmoteCard reporting returned no data.",{emoteID:e.emoticonID}),u=n&&n.data?Object(c.d)(n.data):c.a.Unknown,m=l&&l.subscriptionProduct&&l.subscriptionProduct.owner&&l.subscriptionProduct.owner.displayName||"",p=l&&l.subscriptionProduct&&l.subscriptionProduct.owner&&l.subscriptionProduct.owner.id||"",u===c.a.OWL2019&&(m=c.b,p=c.c),h={channelID:p},f=null,i.label=5;case 5:return i.trys.push([5,7,,8]),[4,r.q.apollo.client.query({query:o,variables:h})];case 6:return f=i.sent(),[3,8];case 7:return k=i.sent(),r.k.warn(k,"Failed to make query for channel info in EmoteCard reporting.",{channelID:p}),[3,8];case 8:return v=f&&f.data&&f.data.user||null,f&&!v&&r.k.warn("Query for channel info in EmoteCard reporting returned no data.",{channelID:p}),b=!!v&&!!v.hasPrime,y=v&&v.self,S=!!y&&!!y.subscriptionBenefit,_=!!y&&!!y.canPrimeSubscribe,C={emote_location:e.emoteLocation,emoticon_id:e.emoticonID,chat_channel:e.chatChannel,chat_channel_id:e.chatChannelID,emote_channel:m,emote_channel_id:p,referrer_user_id:e.referrerUserID,action:e.action,is_subscribed:S,is_subscribed_tier:y&&y.subscriptionBenefit&&y.subscriptionBenefit.tier||"",emote_tier:l&&l.subscriptionProduct&&l.subscriptionProduct.tier||"",emote_status:g(u),has_prime:b,can_subscribe:_,msg_id:e.msgID},r.p.track(a.SpadeEventType.EmoteCardInteraction,C),[2]}})})}function h(e){switch(e){case s.a.chat:return l.Chat;case s.a.whisper:return l.Whisper;case s.a.vod:return l.Vod;case s.a.room:return l.Room;case s.a.unknown:default:return l.Unknown}}function g(e){switch(e){case c.a.Prime:return m.Prime;case c.a.Turbo:return m.Turbo;case c.a.OWL2019:case c.a.Subscription:return m.Available;case c.a.LimitedTime:return m.LimitedTimeEmote;case c.a.Unavailable:return m.CreatorBanned;case c.a.Global:return m.GlobalEmote;case c.a.Unknown:default:return m.OtherUnlockable}}},"28vT":function(e,t,n){},"2Dht":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"WhisperThread"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userLastMessageRead"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"unreadMessagesCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"messages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"IntValue",value:"20"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonce"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"editedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deletedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:347}};n.loc.source={body:"query WhisperThread($id: ID!) {\nwhisperThread(id: $id) {\nid\nuserLastMessageRead {\nid\nsentAt\n__typename\n}\nunreadMessagesCount\nmessages(first: 20) {\nedges {\ncursor\nnode {\nid\nnonce\ncontent {\ncontent\nemotes {\nid\nemoteID\nsetID\nfrom\nto\n__typename\n}\n__typename\n}\nfrom {\nid\n}\nsentAt\neditedAt\ndeletedAt\n__typename\n}\n__typename\n}\n__typename\n}\n__typename\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},"35qb":function(e,t){var n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"subscriptionProductPriceInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PriceInfo"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currency"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"exponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isTaxInclusive"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tax"},arguments:[],directives:[]}]}}],loc:{start:0,end:118}};n.loc.source={body:"fragment subscriptionProductPriceInfo on PriceInfo {\ncurrency\nexponent\ntotal\ndescription\nprice\nisTaxInclusive\nid\ntax\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},"3YIm":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SendWhisper"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SendWhisperInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendWhisper"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonce"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"editedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deletedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"thread"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participants"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whisperPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"receive"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:352}};n.loc.source={body:"mutation SendWhisper($input: SendWhisperInput!) {\nsendWhisper(input: $input) {\nmessage {\nid\nnonce\ncontent {\ncontent\nemotes {\nid\nemoteID\nsetID\nfrom\nto\n__typename\n}\n__typename\n}\nfrom {\nid\n__typename\n}\nsentAt\neditedAt\ndeletedAt\nthread {\nid\nparticipants {\nid\nself {\nwhisperPermissions {\nreceive\n}\n}\n}\n}\n__typename\n}\nerror {\ncode\n__typename\n}\n__typename\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},"3iFw":function(e,t,n){"use strict";n.r(t);var i=n("fvjX"),r=n("/7QA"),a=n("mrSG"),s=n("G1cX"),o=n("CzFK"),d=234,c=310;function l(e){if(0===e.openedIDs.length)return 0;for(var t=0,n=0,i=e.openedIDs;n<i.length;n++){var r=i[n],a=e.byID[r];a.hidden||(t+=a.collapsed?d:c)}return t}function u(e){var t=e.openedIDs.slice(),n=t.pop();return n&&e.focusedID===n&&t.length>0&&(t.pop(),t.push(n)),s(e,function(e){return e.openedIDs},function(){return t})}function m(e,t){var n=e.orderedIDs.filter(function(t){return!e.openedIDs.includes(t)});return n.length>0?p(e,n[0],t):e}function p(e,t,n){var i=n-l(e),r=a.__assign({},e);return r.openedIDs.includes(t)||(i<c&&(r=u(r)),r=s(r,function(e){return e.openedIDs},function(e){return e.push(t),e})),r}function h(e,t,n){if(!e.byID[t])return e;var i=s(e,function(e){return e.byID},function(e){return e[t].collapsed=!1,e});return i.focusedID=t,l(e)>n&&(i=u(i)),i}var g="whisperNotifications.WHISPER_THREAD_NOTIFIED";function f(e,t,n){return{type:g,threadID:e,afterMessageID:n,content:t}}var k=Object(i.combineReducers)({display:function(e,t){switch(void 0===e&&(e={byID:{},orderedIDs:[],openedIDs:[],focusedID:""}),t.type){case o.f:var n=(r=a.__assign({},e)).byID[t.data.threadID],i=r.openedIDs.includes(t.data.threadID);return n||(r=s(r,function(e){return e.orderedIDs},function(e){return e.push(t.data.threadID),e}),r=s(r,function(e){return e.byID},function(e){return e[t.data.threadID]=t.data,e})),r.openedIDs.includes(t.data.threadID)&&!r.byID[t.data.threadID].hidden||(r.byID[t.data.threadID].hidden=t.data.hidden),t.data.ignoreCollapseIfOpen||t.data.collapsed||(r.focusedID=t.data.threadID),r=p(r,t.data.threadID,t.contentWidth),(!i||i&&!t.data.ignoreCollapseIfOpen)&&(t.data.collapsed||(r=h(r,t.data.threadID,t.contentWidth))),r;case o.b:if(!e.byID[t.threadID])return e;var r=s(e,function(e){return e.byID},function(e){return delete e[t.threadID],e});return r=s(r,function(e){return e.orderedIDs},function(e){return e.filter(function(e){return e!==t.threadID})}),r=s(r,function(e){return e.openedIDs},function(e){return e.filter(function(e){return e!==t.threadID})}),e.focusedID===t.threadID&&(r.focusedID=r.openedIDs[0]),m(r,t.contentWidth);case o.c:return e.byID[t.threadID]?(e.focusedID===t.threadID&&(e.focusedID=""),s(e,function(e){return e.byID},function(e){return e[t.threadID].collapsed=!0,e})):e;case o.d:return h(e,t.threadID,t.contentWidth);case o.e:return s(e,function(e){return e.focusedID},function(){return t.threadID});case o.g:return s(e,function(e){return e.focusedID},function(e){return e===t.threadID?"":e});case o.a:var d=l(e);if(d>t.contentWidth){if(e.openedIDs.length<=1)return e;for(var g=a.__assign({},e);d>t.contentWidth&&g.openedIDs.length>1;)d=l(g=u(g));return g}if(t.contentWidth-d>=c){var f=Math.floor((t.contentWidth-d)/c),k=Math.min(f,e.orderedIDs.length-e.openedIDs.length);if(0===k)return e;g=a.__assign({},e);for(var v=0;v<k;v++)if((g=m(g,t.contentWidth)).openedIDs.length>1)for(var b=g.openedIDs,y=b.length,S=0,_=g.orderedIDs;S<_.length;S++){var C=_[S];if(b[y-1]===C){var E=b.splice(y-2,1);b.push(E[0]);break}if(b[y-2]===C)break}return g}return e;default:return e}},notifications:function(e,t){switch(void 0===e&&(e={byThreadID:{}}),t.type){case g:return e.byThreadID[t.threadID]?s(e,function(e){return e.byThreadID[t.threadID]},function(e){return[{threadID:t.threadID,afterMessageID:t.afterMessageID,content:t.content}].concat(e)}):s(e,function(e){return e.byThreadID},function(e){var n;return a.__assign(((n={})[t.threadID]=[{threadID:t.threadID,afterMessageID:t.afterMessageID,content:t.content}],n),e)});default:return e}}});var v=[];function b(e,t){return e.whispers.notifications.byThreadID[t]||v}r.q.store.registerReducer("whispers",k);var y,S=n("/MKj"),_=n("XDQu"),C=n("l1Uh"),E=n("TSYQ"),N=n("q1tI"),D=n("yR8l"),I=n("eDVu"),T=n("0Log"),w=n("geRD"),F=n("/aPz"),O=n("u5aL"),M=n("8/mp"),U=n("eJ65"),x=n("yLwq"),R=n("f00E"),A=n("kz7j"),P=n("GnwI"),j=n("H/lO"),L=n("NZDK"),B=n("oe5X"),W=n("0FG4"),V=n("cys1"),H=n("oK83"),q=n("+80q"),G=n("sUnt"),z=n("hnjF"),Q=n("X2PJ");!function(e){e[e.Timestamp=0]="Timestamp",e[e.Whisper=1]="Whisper",e[e.Warning=2]="Warning",e[e.InactiveUserNotice=3]="InactiveUserNotice",e[e.NewMessages=4]="NewMessages",e[e.Notification=5]="Notification"}(y||(y={}));var K=n("Ws8v"),Y=(n("0JUI"),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.message;switch(e.type){case y.Timestamp:return N.createElement(K.a,{className:"thread-message__timestamp",color:Q.c.Alt2,fontSize:Q.d.Size7},ee(e));case y.Warning:return N.createElement(K.a,{className:"thread-message__warning",color:Q.c.Alt2},X());case y.InactiveUserNotice:return N.createElement(K.a,{className:"thread-message__inactive-user",color:Q.c.Alt2},Z());case y.Whisper:return this.props.reportOutgoingWhisperRendered&&this.props.reportOutgoingWhisperRendered(e.content),N.createElement(G.a,{className:"thread-message__message","data-a-target":"whisper-message","data-test-selector":"whisper-message"},J(e));case y.NewMessages:return N.createElement(K.a,{className:"thread-message__new-messages",color:Q.c.OverlayAlt,fontSize:Q.d.Size7},ne());case y.Notification:return N.createElement(G.a,{className:"thread-message__notification"},te(e));default:return null}},t}(N.Component));function $(e,t,n){return void 0===n&&(n={}),Object(V.f)(Object(B.a)(e,{emotes:{type:W.a.Position,map:ie(t)}}),n,!0)}var J=function(e){if(e.deletedAt)return null;var t="/me "===e.content.substr(0,4);t&&(e.content=e.content.substr(4),e.emotes=e.emotes.map(function(e){return e&&e.from&&e.to?a.__assign({},e,{from:e.from-4,to:e.to-4}):null}));var n=[N.createElement("span",{key:"str-separator","data-test-selector":"separator"},t?" ":": ")],i={messageAuthorID:e.from&&e.from.id||"",messageSourceID:e.id,emoteSourceType:H.a.whisper};if(n.push.apply(n,$(e.content,e.emotes,i)),e.editedAt){var s=Object(r.d)("edited","ThreadMessage"),o=Object(r.d)("{timestamp, date, full} {timestamp, time, long}",{timestamp:new Date(e.editedAt)},"ThreadMessage");n.push(N.createElement(z.g,{key:"editedAt",margin:{left:1}},N.createElement(q.a,{type:q.e.Span,className:"thread-message__message--edited",title:o,color:Q.c.Alt2},"("+s+")")))}var d=e.from&&e.from.chatColor||"",c=e.from&&e.from.displayName||N.createElement(q.a,{type:q.e.Span,italic:!0},Object(r.d)("Unknown","ThreadMessage")),l=t?d:"";return N.createElement(G.a,{padding:{x:1,y:.5}},N.createElement("span",{className:"thread-message__message--user-name","data-a-target":"whisper-message-name",style:{color:d}},c),N.createElement("span",{style:{color:l}},n))},X=function(){return N.createElement(G.a,{padding:{y:.5,x:1}},Object(r.d)("Please don't share passwords or personal information.","whispers"))},Z=function(){return N.createElement(G.a,{padding:{y:.5,x:1}},Object(r.d)("This account is no longer active.","whispers"))},ee=function(e){var t=new Date,n=new Date;n.setDate(n.getDate()-7);var i="",s={hour:"numeric",minute:"numeric",second:"numeric"},o=a.__assign({},s,{year:"numeric",month:"numeric",day:"numeric"});i=e.timestamp.toDateString()===t.toDateString()?Object(r.d)("Today, {timestamp, time, medium}",{timestamp:e.timestamp},"ThreadMessage"):e.timestamp<n?Object(r.j)(e.timestamp,o):Object(r.j)(e.timestamp,a.__assign({},s,{weekday:"long"}));var d=Object(r.j)(e.timestamp,a.__assign({},o,{timeZoneName:"short"}));return N.createElement(G.a,{padding:{y:1},textAlign:z.k.Center},N.createElement("span",{title:d},""+i))},te=function(e){return N.createElement(G.a,{padding:{y:.5,x:1}},N.createElement(q.a,{type:q.e.Span,color:Q.c.Alt2},e.content))},ne=function(){return N.createElement(G.a,{textAlign:z.k.Center,padding:{y:.5}},Object(r.d)("New Whispers","whispers"))};function ie(e){var t={};return e.forEach(function(e){e&&null!==e.from&&e.emoteID&&(t[e.from]={startIndex:e.from,id:e.emoteID})}),t}var re=n("HH5h"),ae=n("7uM4"),se=n("7d/q"),oe=(n("jPWu"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleThreadClick=function(){t.props.selectThread(t.props.threadID)},t.handleArchiveClick=function(e){e.stopPropagation(),t.props.archiveThread(t.props.threadID)},t}return a.__extends(t,e),t.prototype.render=function(){var e,t,n,i=this.props.user,a=this.props.lastMessage?$(this.props.lastMessage.content.content||"",this.props.lastMessage.content.emotes||[]):null,s=this.props.unreadMessageCount,o=Object(r.d)("Unknown","ThreadListItem");return i?((e=i.displayName||i.login)||(e=o),t=i.login||o,n=i.profileImageURL):(e=o,t=o,n=null),N.createElement("div",{onClick:this.handleThreadClick,role:"listitem"},N.createElement(K.a,{className:"whispers-list-item",borderBottom:!0,padding:1,display:z.d.Flex,flexDirection:z.e.Row,flexWrap:z.f.NoWrap,fullWidth:!0,alignItems:z.b.Center,"data-a-target":"whisper-with-"+t},N.createElement(G.a,{className:"whispers-list-item__avatar",margin:{right:.5},flexShrink:0},N.createElement(re.a,{size:30,alt:Object(r.d)("{interlocutorName}'s Avatar",{interlocutorName:e},"WhisperThreadListItem"),src:n,onLoad:this.props.avatarOnLoadCallback})),N.createElement(G.a,{fullWidth:!0,display:z.d.Inline},N.createElement(q.a,{fontSize:Q.d.Size5,bold:!0,italic:e===o},e),N.createElement(G.a,{className:"whispers-list-item__last-message",ellipsis:!0},a)),N.createElement(G.a,{className:"whispers-list-item__unread-count",margin:{right:1},textAlign:z.k.Right},N.createElement(q.a,{bold:!0},s>0&&!this.props.muted?s:null),this.props.muted&&N.createElement(G.a,{display:z.d.Flex,alignItems:z.b.Center,justifyContent:z.h.Center},N.createElement(ae.a,{type:ae.c.Alt2,asset:ae.b.WhisperMuted}))),N.createElement("div",{className:"whispers-list-item__archive"},N.createElement(se.a,{ariaLabel:Object(r.d)("Archive Thread","WhisperThreadListItem"),tabIndex:-1,icon:ae.b.Close,"data-a-target":"whispers-list-item__archive-button",onClick:this.handleArchiveClick,"data-click-out-id":"whispers-list-item__archive-button"}))))},t}(N.Component)),de=n("PrJw"),ce=n("i4Ys"),le=n("N6NX"),ue=function(e){function t(t){var n=e.call(this,t)||this;return n.markAllWhispersAsRead=function(){var e=Object(w.a)({markAllAsRead:!0});n.props.markAllWhispersAsRead&&(Object(de.i)(),n.props.markAllWhispersAsRead(e)),n.props.onMarkAllMessagesRead&&n.props.onMarkAllMessagesRead()},n.toggleDoNotDisturb=function(){n.state.doNotDisturb?(r.o.set("whisperDoNotDisturb",!1),Object(de.f)(),n.setState({doNotDisturb:!1})):(r.o.set("whisperDoNotDisturb",!0),Object(de.g)(),n.setState({doNotDisturb:!0}))},n.state={doNotDisturb:r.o.get("whisperDoNotDisturb",!1)},n}return a.__extends(t,e),t.prototype.render=function(){var e=this.state.doNotDisturb?Object(r.d)("Disable Do Not Disturb","ThreadsBoxSettings"):Object(r.d)("Enable Do Not Disturb","ThreadsBoxSettings"),t=Object(r.d)("Mark All Whispers as Read","ThreadsBoxSettings");return N.createElement(G.a,{className:"threads-box-settings",display:z.d.Flex,flexDirection:z.e.Column,margin:1},N.createElement(ce.a,{ariaLabel:e,onClick:this.toggleDoNotDisturb},N.createElement(G.a,{padding:{y:.5,x:1}},e)),N.createElement(ce.a,{ariaLabel:t,onClick:this.markAllWhispersAsRead},N.createElement(G.a,{padding:{y:.5,x:1}},t)))},t=a.__decorate([Object(D.a)(le,{name:"markAllWhispersAsRead"})],t)}(N.Component);function me(e,t){return e.find(function(e){return!!e&&e.id!==t})||void 0}var pe,he=n("NMMG"),ge=n("XQbB"),fe=n("wp5a"),ke=n("ygYM"),ve=n("3Law"),be=(n("dNN/"),function(e){function t(t){var n=e.call(this,t)||this;return n.onMarkAllMessagesRead=function(){n.settingsMenu.toggleBalloon(!1)},n.renderUserSearchResult=function(e,t){var i=Object(r.d)("{username}'s avatar",{username:e.name},"ThreadsBox"),a=e.profile_image||Object(x.c)(e.objectID,30);return N.createElement("div",{key:"searchResult:"+e.objectID,onClick:n.handleUserSearchResultClick(e,t)},N.createElement(K.a,{className:"whispers-list-item",borderBottom:!0,padding:1,"data-a-target":"whisper-search-result-"+e.login,display:z.d.Flex,flexDirection:z.e.Row,flexWrap:z.f.NoWrap,fullWidth:!0,alignItems:z.b.Center},N.createElement(G.a,{margin:{right:.5},flexShrink:0},N.createElement(re.a,{size:30,src:a,alt:i})),N.createElement(G.a,{fullWidth:!0,display:z.d.Flex,flexDirection:z.e.Column},N.createElement(q.a,{fontSize:Q.d.Size5,bold:!0},e.login),N.createElement(G.a,null," "))))},n.saveSettingsMenuRef=function(e){return n.settingsMenu=e},n.handleConversationsClick=function(){n.state.open||(n.props.latencyTracking.resetCustomEvents(A.a.Whispers),n.whispersHistoryLatencyEvent=n.props.latencyTracking.registerCustomEvent({benchmark:200,group:A.a.Whispers,key:A.b.WhispersHistory,label:A.c.History,start:A.d.Registration})),n.setState(function(e){return{open:!e.open}})},n.selectThread=function(e){n.handleClose(),n.clearSearchText(),n.props.selectThread(e)},n.handleClose=function(){n.setState({open:!1})},n.clearSearchText=function(){n.setState({searchText:"",searching:!1})},n.onSearchInputChange=function(e){return a.__awaiter(n,void 0,void 0,function(){var t,n=this;return a.__generator(this,function(i){return t=e.currentTarget.value,clearTimeout(this.inputTimeout),t&&0!==t.length?(this.setState({searchText:t,searching:!0}),this.inputTimeout=setTimeout(function(){n.search(n.state.searchText)},200),[2]):(this.inputTimeout=0,this.clearSearchText(),[2])})})},n.handleUserSearchResultClick=function(e,t){return function(){var i=e.objectID;if(null!==n.props.currentUserID&&i!==n.props.currentUserID){n.handleClose(),n.clearSearchText();var r=Object(he.a)(n.props.currentUserID,i);Object(de.e)({threadID:r,targetUserlogin:e.login,searchResultRank:t}),Object(de.b)({searchResultRank:t,searchQuery:n.state.searchText,isConversation:!1}),n.props.selectThread(r)}}},n.filterExistingThreads=function(e){var t=e.toLowerCase();return n.props.orderedThreadIDs.filter(function(e){var i=me(n.props.threadsByID[e].participants,n.props.currentUserID);return!(!i||!i.displayName)&&i.displayName.toLowerCase().indexOf(t)>=0})},n.searchClient=new L.a({appId:r.a.algoliaApplicationID,apiKey:r.a.algoliaAPIKey,apolloClient:r.q.apollo.client,logger:r.k,config:r.a,stats:r.q.stats}),n.state={open:!1,searchText:"",searching:!1},n}return a.__extends(t,e),t.prototype.render=function(){return N.createElement(O.a,{onClickOut:this.handleClose},N.createElement(Q.e,{className:"whispers-threads-box__container "+(this.state.open?"whispers-threads-box__container--open":""),display:z.d.Flex,flexDirection:z.e.Column,flexWrap:z.f.NoWrap,borderTop:!0,borderRight:!0,borderLeft:!0,background:Q.a.Base,position:z.j.Absolute,attachBottom:!0,attachRight:!0,"data-click-out-id":"threads-box","data-a-target":"threads-box-"+(this.state.open?"open":"closed"),borderRadius:{topLeft:Q.b.Medium,topRight:Q.b.Medium}},N.createElement("div",{"aria-labelledby":"whispers-box-header"},this.renderHeader(),this.renderList(),this.renderFooter())))},t.prototype.renderOpenCloseButton=function(){var e=null;if(this.props.unreadCount>0){var t=this.props.unreadCount>99?"99+":this.props.unreadCount.toString();e=N.createElement(G.a,{className:"whispers-threads-box__unread",position:z.j.Absolute},N.createElement(fe.a,{"data-a-target":"whisper-unreads",label:t,type:fe.b.Notification}))}return N.createElement(K.a,{position:z.j.Relative,background:Q.a.Alt,display:z.d.Flex,alignItems:z.b.Center,justifyContent:z.h.Center},e,N.createElement(ce.a,{ariaLabel:Object(r.d)("Close Threads","WhisperThreadsBox"),onClick:this.handleConversationsClick,type:ce.b.Alt,"data-a-target":"whisper-box-button"},N.createElement(K.a,{display:z.d.Flex,padding:1,color:Q.c.Link},N.createElement(ae.a,{asset:ae.b.Conversations}))))},t.prototype.renderList=function(){var e,t=this;if(!this.state.open)return null;var n=null;""!==this.state.searchText&&(n=N.createElement(K.a,{key:"otherPeopleDivider",borderBottom:!0,padding:{x:1,y:.5}},Object(r.d)("Other People","WhispersThreadBox")));var i=null;if(this.state.searching?i=N.createElement(G.a,{display:z.d.Flex,flexDirection:z.e.Column,margin:{top:4},alignItems:z.b.Center},N.createElement(ge.a,{delay:0})):this.state.searchResults&&this.state.searchResults.users&&""!==this.state.searchText&&(i=this.state.searchResults.users.totalHits>0?this.state.searchResults.users.hits.filter(function(e){return!t.props.threadsByID[e.objectID]}).map(this.renderUserSearchResult):N.createElement(G.a,{display:z.d.Flex,flexDirection:z.e.Column,margin:{top:4},alignItems:z.b.Center},N.createElement(q.a,{color:Q.c.Alt2},Object(r.d)("No users found.","WhisperThreadsBox")))),this.props.error)e=N.createElement(G.a,{margin:{x:"auto"},display:z.d.Flex,justifyContent:z.h.Center,alignItems:z.b.Center,fullHeight:!0},N.createElement(q.a,{color:Q.c.Error},Object(r.d)("There was a problem loading whispers.","WhisperThreadsBox")));else if(this.props.loading)e=N.createElement(ge.a,null);else{var a=this.props.orderedThreadIDs;""!==this.state.searchText&&(a=this.filterExistingThreads(this.state.searchText)),e=a.filter(function(e){return t.props.threadsByID[e]&&!t.props.threadsByID[e].archived}).map(function(e,n){var i=0===n?function(){t.props.latencyTracking.reportCustomEvent(t.whispersHistoryLatencyEvent)}:void 0,r=t.props.threadsByID[e],a=me(r.participants,t.props.currentUserID);return a?N.createElement(oe,{key:"whisperThread:"+r.id,user:a,threadID:r.id,lastMessage:r.lastMessage,archiveThread:t.props.archiveThread,selectThread:t.selectThread,unreadMessageCount:r.unreadMessagesCount,muted:r.muted,avatarOnLoadCallback:i}):null})}return N.createElement(M.b,{suppressScrollX:!0},N.createElement("div",{role:"list"},e,n,i,N.createElement(M.a,{enabled:this.state.open,loadMore:this.props.loadMore,pixelThreshold:200})))},t.prototype.renderHeader=function(){return this.state.open?N.createElement(K.a,{className:"whispers-threads-box__header","data-a-target":"whispers-threads-box__header",alignItems:z.b.Center,background:Q.a.Alt,borderBottom:!0,color:Q.c.Base,display:z.d.Flex,flexDirection:z.e.Row,flexGrow:0,flexShrink:0,padding:{y:.5,x:1},"data-click-hide-id":"threads-box-header"},N.createElement(z.g,{flexGrow:1,display:z.d.Flex},N.createElement("div",{id:"whispers-box-header"},N.createElement(q.a,{type:q.e.Span,bold:!0},Object(r.d)("Whispers","WhisperThreadsBox")))),N.createElement(U.a,{ref:this.saveSettingsMenuRef},N.createElement(se.a,{ariaLabel:Object(r.d)("Settings","WhisperThreadsBox"),icon:ae.b.Gear,"data-a-target":"whisper-settings-button"}),N.createElement(ke.a,{size:ke.c.Small,direction:ke.b.BottomRight,offsetX:"0.5rem"},N.createElement(ue,{onMarkAllMessagesRead:this.onMarkAllMessagesRead}))),N.createElement(se.a,{ariaLabel:Object(r.d)("Minimize","WhisperThreadsBox"),icon:ae.b.Minimize,onClick:this.handleClose,"data-a-target":"whisper-close-button"})):null},t.prototype.renderFooter=function(){return this.state.open?N.createElement(K.a,{display:z.d.Flex,flexGrow:0,flexShrink:0,alignItems:z.b.Center,borderTop:!0,background:Q.a.Alt},N.createElement(G.a,{flexGrow:1,padding:{top:.5,bottom:.5,left:1}},N.createElement(ve.a,{onChange:this.onSearchInputChange,value:this.state.searchText,placeholder:Object(r.d)("Search for People","WhisperThreadsBox"),id:"threads-box-filter",autoFocus:!0,"data-a-target":"whisper-search-input"})),this.renderOpenCloseButton()):this.renderOpenCloseButton()},t.prototype.search=function(e){return a.__awaiter(this,void 0,void 0,function(){var t;return a.__generator(this,function(n){switch(n.label){case 0:return e?[4,this.searchClient.queryForType(j.a.Users,e,R.a())]:[2];case 1:return t=n.sent(),this.setState({searchResults:t,searching:!1}),[2]}})})},t=a.__decorate([Object(P.withLatencyTracking)("WhisperCenter",{autoReportInteractive:!0})],t)}(N.Component)),ye=n("MJbm"),Se=n("aCAx"),_e=n("kRBY"),Ce=n("/HY+"),Ee=n("ZDlU"),Ne=n("x7UT"),De=n("8Ad5"),Ie=n("Mj6i"),Te=n("DMoW"),we=n("okS7"),Fe=n("mmRu"),Oe=n("cpJf"),Me=n("2xye"),Ue=n("dEDE");!function(e){e.StrangerWarningConfirmationButton="stranger-confirmation"}(pe||(pe={}));var xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e,t;e={targetUserID:this.props.targetUserID},t={target_user_id:e.targetUserID},r.p.track(Me.SpadeEventType.WhisperStrangerWarningImpression,t)},t.prototype.render=function(){var e;return e=this.props.targetDisplayName?Object(r.d)("You have blocked whispers from strangers. By sending a whisper to {username}, you will allow them to whisper you for 48 hours. You can disable their access again in whisper settings.",{username:this.props.targetDisplayName},"WhisperThread"):Object(r.d)("You have blocked whispers from strangers. By sending a whisper to this user, you will allow them to whisper you for 48 hours. You can disable their access again in whisper settings.","WhisperThread"),N.createElement(G.a,{attachBottom:!0,padding:1,position:z.j.Absolute},N.createElement(G.a,{padding:{bottom:1}},N.createElement(q.a,{color:Q.c.Alt2,fontSize:Q.d.Size6},e)),N.createElement(Ue.a,{onClick:this.props.onStrangerWarningConfirmation,"data-test-selector":pe.StrangerWarningConfirmationButton},Object(r.d)("Got it!","WhisperThread")))},t}(N.Component),Re=n("BhFH"),Ae=n("EvYO"),Pe=n("D7An"),je=n("TvOw"),Le=n("m98o"),Be=n("as+V"),We=n("oJmH"),Ve=n("iS14"),He=n("lZZ2"),qe=n("0tEc"),Ge=n("/rr3"),ze=n("J71B"),Qe=n("4qQ0"),Ke=n("Gu45"),Ye=n("dr/4"),$e="whispers-report-user-button",Je=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderReportButton=function(){var e=t.props.displayName||t.props.login,n=Object(r.d)("Report {displayName}",{displayName:e},"ThreadSettings");return N.createElement(ce.a,{"data-test-selector":$e,ariaLabel:n,onClick:t.reportUser},N.createElement(G.a,{padding:{y:.5,x:1}},n))},t.onChannelRedirect=function(){t.props.collapseThread&&t.props.collapseThread()},t.toggleMutethread=function(){var e=!t.props.isMuted,n=a.__assign({},Object(w.a)({threadID:t.props.threadID,isMuted:!t.props.isMuted}),{optimisticResponse:{updateWhisperThread:{thread:{id:t.props.threadID,isMuted:e,__typename:"WhisperThread"},__typename:"UpdateWhisperThreadPayload"}}});e?Object(de.j)(t.props.threadID):Object(de.k)(t.props.threadID),t.props.setMuteThread(n)},t.onRevokeButtonClicked=function(){return a.__awaiter(t,void 0,void 0,function(){var e;return a.__generator(this,function(t){switch(t.label){case 0:e=a.__assign({},Object(w.a)({threadID:this.props.threadID,removeWhitelist:!0})),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.props.revokeWhisperAccess(e)];case 2:return t.sent(),[3,4];case 3:return t.sent(),[2];case 4:return this.props.onCloseThread(this.props.threadID),[2]}})})},t.reportUser=function(){var e=t.props.displayName||t.props.login;t.props.showReportUserModal({onClose:t.onReportModalClose,reportContext:{contentType:Te.Pa.WHISPER_REPORT,targetUserID:t.props.userID,contentID:t.props.threadID},title:Object(r.d)("Report {displayName}",{displayName:e},"ReportUserModal")})},t.onReportModalClose=function(e,n){e===Qe.b.Success&&n&&t.props.onBlock&&t.props.onBlock(t.props.threadID)},t.blockUser=function(){t.props.currentUser&&t.props.showBlockModal({context:Te.l.WHISPER,currentUserData:t.props.currentUser,displayName:t.props.displayName||t.props.login,login:t.props.login,onBlock:function(){return t.props.onBlock(t.props.threadID)},reason:je.a.Other,userID:t.props.userID})},t.unblockUser=function(){t.props.currentUser&&(t.props.unblockUserMutation(t.props.userID,t.props.currentUser),t.props.onUnblock&&t.props.onUnblock(t.props.threadID))},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.displayName||this.props.login,t=this.props.isMuted?Object(r.d)("Turn Notifications On","ThreadSettings"):Object(r.d)("Turn Notifications Off","ThreadSettings"),n=Object(r.d)("Go to {displayName}'s Channel",{displayName:e},"ThreadSettings");return N.createElement(G.a,{display:z.d.Flex,flexDirection:z.e.Column,margin:1},N.createElement(ce.a,{ariaLabel:t,onClick:this.toggleMutethread},N.createElement(G.a,{padding:{y:.5,x:1}},t)),N.createElement(K.a,{borderBottom:!0,margin:{y:1,left:.5}}),N.createElement(qe.a,{friendButtonUIType:Ge.a.WhisperSettings,requestContext:ze.a.Conversation,targetID:this.props.userID}),this.renderRevokeButton(),this.renderBlockButton(),this.renderReportButton(),N.createElement(ce.a,{linkTo:"/"+this.props.login,onClick:this.onChannelRedirect,ariaLabel:n},N.createElement(G.a,{padding:{y:.5,x:1}},n)))},t.prototype.renderRevokeButton=function(){return this.props.hasTemporaryWhisperAccess?N.createElement(ce.a,{onClick:this.onRevokeButtonClicked,"data-test-selector":"whispers-revoke-access-button"},N.createElement(G.a,{padding:{y:.5,x:1}},Object(r.d)("Revoke Whisper Access","ThreadSettings"))):null},t.prototype.renderBlockButton=function(){var e,t,n=this.props.displayName||this.props.login;return this.isBlocked?(e=Object(r.d)("Unblock {displayName}",{displayName:n},"ThreadSettings"),t=this.unblockUser):(e=Object(r.d)("Block {displayName}",{displayName:n},"ThreadSettings"),t=this.blockUser),N.createElement(ce.a,{"data-test-selector":"whispers-block-user-button",ariaLabel:e,onClick:t},N.createElement(G.a,{padding:{y:.5,x:1}},e))},Object.defineProperty(t.prototype,"isBlocked",{get:function(){var e=this;return!!(this.props.currentUser&&this.props.currentUser.blockedUsers&&this.props.currentUser.blockedUsers.find(function(t){return!!t&&t.id===e.props.userID}))},enumerable:!0,configurable:!0}),t}(N.Component);var Xe=Object(We.compose)(Object(S.connect)(null,function(e){return{onCloseThread:function(t){return e(Object(o.h)(t,Object(C.a)()))}}}),Object(D.a)(Ke,{name:"revokeWhisperAccess"}),Object(D.a)(Ye,{name:"setMuteThread"}),He.a,Object(Ve.a)())(Je),Ze=n("pORx");var et=n("NKxy");var tt=n("796b");function nt(e){switch(e){case Te.c.ONLINE:return tt.b.Online;case Te.c.AWAY:case Te.c.IDLE:return tt.b.Away;case Te.c.BUSY:return tt.b.Busy;case Te.c.OFFLINE:default:return tt.b.Offline}}var it=n("vGFN"),rt=n("Jsra"),at=n("PL8s"),st=(n("hRS0"),"report-as-spam-button"),ot="mark-not-spam-button",dt="dismiss-prompt-button",ct="spam-prompt-pending-target",lt="spam-prompt-reported-target",ut={__typename:"User",displayName:"???",chatColor:null,profileImageURL:null,login:"???",displayBadges:[],id:"",self:null},mt=function(e){function t(t){var n=e.call(this,t)||this;n.renderPotentialSpamPrompt=function(){if(n.props.spamInfo&&n.props.spamInfo.likelihood!==Te.yb.LOW&&null===n.props.spamInfo.lastMarkedNotSpamAt){if("pending"===n.state.potentialSpamResolution)return N.createElement(G.a,{"data-a-target":ct,className:"thread-header__potential-spam-prompt",attachRight:!0,attachLeft:!0,attachTop:!0},N.createElement(K.a,{background:Q.a.Alt2,padding:.5,elevation:2},N.createElement(G.a,{display:z.d.InlineBlock,margin:.5},N.createElement(q.a,{type:q.e.Span,fontSize:Q.d.Size6,color:Q.c.Alt2},Object(r.d)("It looks like this conversation triggered our spam detector. If it is spam, please report it!","ThreadHeader"))),N.createElement(G.a,{display:z.d.InlineBlock,margin:.5},N.createElement(Ue.a,{"data-a-target":st,type:Ue.d.Alert,onClick:n.reportSpam,size:Ue.b.Small},Object(r.d)("Report spam","ThreadHeader"))),N.createElement(G.a,{display:z.d.InlineBlock,margin:.5},N.createElement(Ue.a,{"data-a-target":ot,onClick:n.markNotSpam,size:Ue.b.Small},Object(r.d)("This is not spam","ThreadHeader")))));if("reported"===n.state.potentialSpamResolution&&n.interlocutor.displayName)return N.createElement(G.a,{"data-a-target":lt,className:"thread-header__potential-spam-prompt",attachRight:!0,attachLeft:!0,attachTop:!0},N.createElement(K.a,{background:Q.a.Alt2,padding:.5,elevation:2},N.createElement(G.a,{display:z.d.InlineBlock,margin:.5},N.createElement(q.a,{type:q.e.Span,fontSize:Q.d.Size6,color:Q.c.Alt2},Object(r.d)("Thank you for helping us fight spam. We've blocked {user} from sending you further whispers. You can undo this from the Whisper Settings Menu.",{user:n.interlocutor.displayName},"ThreadHeader"))),N.createElement(G.a,{display:z.d.InlineBlock,margin:.5},N.createElement(Ue.a,{"data-a-target":dt,type:Ue.d.Text,onClick:n.dismissSpamPrompt,size:Ue.b.Small},Object(r.d)("Dismiss","ThreadHeader")))))}return null},n.reportSpam=function(){n.interlocutor.id&&n.interlocutor.login&&(n.props.reportUserMutation(n.interlocutor.id,je.b.Spam,n.props.threadID),n.props.blockUserMutation(n.interlocutor.id,je.a.Other,Te.l.WHISPER,n.props.currentUser||void 0),n.props.setThreadSpamStatusMutation(n.props.threadID,!0),Object(it.l)(n.interlocutor.login,it.a.SpamPropmt),n.setState({potentialSpamResolution:"reported"}))},n.markNotSpam=function(){n.props.setThreadSpamStatusMutation(n.props.threadID,!1),Object(it.o)(n.props.threadID),n.setState({potentialSpamResolution:"dismissed"})},n.dismissSpamPrompt=function(){n.props.onBlock&&n.props.onBlock(n.props.threadID),Object(it.n)(n.props.threadID),n.setState({potentialSpamResolution:"dismissed"})},n.onSettingsClick=function(e){e.stopPropagation()},n.onHeaderActivate=function(e){e.target===e.currentTarget&&(e.charCode!==De.a.Enter&&e.charCode!==De.a.Space||(n.props.onHeaderInteract(),e.stopPropagation()))},n.onFocus=function(){n.setState({isElementFocused:!0})},n.onBlur=function(){n.setState({isElementFocused:!1})},n.onJoinClick=function(e){n.onPresenceClick(Ae.a.WhisperHeaderButton,e)},n.onActivityClick=function(e){n.onPresenceClick(Ae.a.WhisperHeaderLink,e)},n.onPresenceClick=function(e,t){t.stopPropagation(),n.props.interlocutor&&n.props.interlocutorActivity&&n.props.interlocutor.login?Object(Ae.b)({context:e,friendActivity:n.props.interlocutorActivity,friendLogin:n.props.interlocutor.login}):r.k.warn("[ThreadHeader] Attempted to track presence click without required data.")};var i=r.q.experiments.getAndTrackAssignment(Pe.b.ExtendedPresence);return n.state={potentialSpamResolution:"pending",hasExtendedRichPresence:"variant_a"===i,isElementFocused:!1},n}return a.__extends(t,e),t.prototype.render=function(){var e=this.props.isHighlighted&&!this.state.isElementFocused,t=E({"thread-header__title-bar-container":!0,"thread-header__title-bar-container--highlighted":this.props.isHighlighted,"thread-header__title-bar-container--focused":this.props.isFocused}),n=E({"thread-header":!0,"thread-header--collapsed":this.props.isCollapsed}),i=E({"thread-header__display-name--highlighted":this.props.isHighlighted}),a=Object(r.d)("Close","WhisperThreadHeader"),s=Object(r.d)("Settings","WhisperThreadHeader");if(this.props.isLoading||!this.props.currentUser||!this.interlocutor)return N.createElement(G.a,{className:t,display:z.d.Flex,justifyContent:z.h.Between,fullWidth:!0,alignItems:z.b.Center,padding:{y:.5,x:1},flexShrink:0,flexGrow:0,flexWrap:z.f.NoWrap},N.createElement(at.a,{height:20,width:80}),N.createElement(G.a,{display:z.d.Flex},N.createElement(se.a,{ariaLabel:a,icon:ae.b.RemoveTag,"data-a-target":"whispers-thread__close-button-"+this.props.threadID,onClick:this.props.onClose})));var o=null,d=null,c=null,l=null;if(this.props.interlocutorActivity){var u=this.props.interlocutorAvailability,m=this.props.interlocutorActivity;if(d=N.createElement(G.a,{margin:{left:1},display:z.d.Flex,alignItems:z.b.Center},N.createElement(tt.a,{status:nt(u||Te.c.OFFLINE)})),m){var p={activity:m,availability:this.state.hasExtendedRichPresence?u:void 0},h=Object(Le.b)(p,!0),g=null,f=Object(Le.c)(this.interlocutor.login,m);if(f&&(g={pathname:f,state:{content:Me.PageviewContent.Presence,medium:Me.PageviewMedium.Whispers}}),g){var k=E({"thread-header__activity-link--highlighted":this.props.isHighlighted});c=N.createElement(rt.a,{className:k,title:Object(Le.b)(p)||"",onClick:this.onActivityClick,to:g,"data-test-selector":"whispers-thread__presence-link"},h)}else c=h;this.props.isCollapsed||(l=N.createElement(Be.a,{availability:u||Te.c.OFFLINE,link:g,onClick:this.onJoinClick,shouldHollowOverlay:this.props.isHighlighted,margin:{right:.5}}))}}!this.props.isCollapsed&&this.props.currentUser&&this.interlocutor.login&&this.interlocutor.id&&!this.props.interactionsDisabled&&(o=N.createElement(U.a,null,N.createElement(se.a,{ariaLabel:s,icon:ae.b.Gear,overlay:e}),N.createElement(ke.a,{direction:ke.b.BottomRight,offsetX:"0.5rem",size:ke.c.Small},N.createElement(Xe,{login:this.interlocutor.login,displayName:this.interlocutor.displayName,currentUser:this.props.currentUser,userID:this.interlocutor.id,isMuted:this.props.isMuted,threadID:this.props.threadID,collapseThread:this.props.collapse,onBlock:this.props.onBlock,onUnblock:this.props.onUnblock,showReportUserModal:this.props.showReportUserModal,hasTemporaryWhisperAccess:!!this.interlocutor.self&&!!this.interlocutor.self.whisperPermissions&&this.interlocutor.self.whisperPermissions.receive===Te.xb.TEMPORARY}))));var v=this.interlocutor.displayBadges.map(function(e){return e?N.createElement(z.g,{key:e.id,flexShrink:0,margin:{right:.5}},N.createElement("img",{alt:e.title,title:e.title,className:"thread-header__badge",src:e.imageURL})):null});return N.createElement(G.a,{className:n,position:z.j.Relative,fullWidth:!0},N.createElement("div",{className:"thread-header__click-area",onClick:this.props.onHeaderInteract,onKeyPress:this.onHeaderActivate,onFocus:this.onFocus,onBlur:this.onBlur,"data-a-target":"thread-header__click-area",tabIndex:0},N.createElement(G.a,{className:t,fullWidth:!0,padding:{x:1,y:.5},alignItems:z.b.Center,flexGrow:1,display:z.d.Flex,"data-a-target":"whisper-thread-title-bar-"+(this.interlocutor&&this.interlocutor.login),"data-click-out-id":"thread-expand-close",flexWrap:z.f.NoWrap},N.createElement(G.a,{display:z.d.Flex,flexDirection:z.e.Column,flexGrow:1,fullHeight:!0,overflow:z.i.Hidden},N.createElement(G.a,{display:z.d.Flex,flexGrow:1,alignItems:z.b.Center,flexWrap:z.f.NoWrap,padding:{right:1},ellipsis:!0},v,N.createElement(q.a,{className:i,type:q.e.Span,bold:!0,ellipsis:!0},this.interlocutor.displayName?this.interlocutor.displayName:ut.displayName),d),N.createElement(K.a,{className:"thread-header__activity",color:this.props.isHighlighted?Q.c.Overlay:Q.c.Base,padding:{right:1},ellipsis:!0},c)),N.createElement(G.a,{display:z.d.Flex,flexShrink:0,flexDirection:z.e.Row,alignItems:z.b.Center},l,N.createElement("div",{onClick:this.onSettingsClick},o),N.createElement(se.a,{ariaLabel:a,icon:ae.b.RemoveTag,"data-a-target":"thread-close-button-"+(this.interlocutor&&this.interlocutor.login),"data-test-selector":"thread-header__close-button-"+this.props.threadID,onClick:this.props.onClose,overlay:e})))),this.renderPotentialSpamPrompt())},Object.defineProperty(t.prototype,"interlocutor",{get:function(){return this.props.interlocutor||ut},enumerable:!0,configurable:!0}),t}(N.Component),pt=Object(i.compose)(Object(Re.a)(),function(){var e=this;return Object(D.a)(Ze,{props:function(t){return{reportUserMutation:function(n,i,s){return a.__awaiter(e,void 0,void 0,function(){var e;return a.__generator(this,function(a){switch(a.label){case 0:if(!t.mutate)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.mutate({variables:{input:{targetUserID:n,reason:i,threadID:s}}})];case 2:return a.sent(),[3,4];case 3:return e=a.sent(),r.k.error(e,"Unable to report user"),[3,4];case 4:return[2]}})})}}}})}(),function(){var e=this;return Object(D.a)(et,{props:function(t){return{setThreadSpamStatusMutation:function(n,i){return a.__awaiter(e,void 0,void 0,function(){var e;return a.__generator(this,function(a){switch(a.label){case 0:if(!t.mutate)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.mutate({variables:{input:{threadID:n,isSpam:i}}})];case 2:return a.sent(),[3,4];case 3:return e=a.sent(),r.k.error(e,"Unable to modify threads spam status user"),[3,4];case 4:return[2]}})})}}}})}())(mt),ht=n("HAa/"),gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={disableInfiniteTrigger:!0},t.loadMore=function(){if(t.scroll&&t.scroll.scrollContent){var e=t.scroll.scrollContent.scrollHeight;t.setState({prevScrollHeight:e})}return t.props.loadMore()},t.renderMessages=function(e){return e.map(function(e,n){return N.createElement(Y,{message:e,reportOutgoingWhisperRendered:t.props.reportOutgoingWhisperRendered||void 0,key:t.generateMessageKey(e,n.toString())})})},t.getMessages=function(){var e=t.props.unreadMessagesCount,n=t.notificationsFor();return t.props.thread.messages&&(n=n.concat(t.props.thread.messages.edges.map(function(e){return{type:y.Whisper,content:e.node.content.content||"",from:e.node.from&&e.node.from.id?t.props.participantsByID[+e.node.from.id]:null,emotes:e.node.content.emotes||[],id:e.node.id,nonce:e.node.nonce||"",sentAt:new Date(e.node.sentAt),editedAt:e.node.editedAt,deletedAt:e.node.deletedAt}}).reduce(function(n,i,r,a){if(t.notificationsFor(i.id).forEach(function(e){n.push(e)}),n.push(i),0==--e&&n.push(t.createNewMessagesIndicator()),r<a.length-1){var s=a[r+1];!i.deletedAt&&t.shouldAddTimestamp(i,s)&&n.push(t.createTimestampMessage(i))}return r!==a.length-1||i.deletedAt||n.push(t.createTimestampMessage(i)),n},[]))),n.push(t.createWarningMessage()),n.reverse(),t.props.hasUnknownParticipant&&n.push(t.createInactiveUserMessage()),n},t.shouldAddTimestamp=function(e,t){return e.sentAt.valueOf()-t.sentAt.valueOf()>6e5||e.sentAt.toDateString()!==t.sentAt.toDateString()},t.createTimestampMessage=function(e){return{type:y.Timestamp,timestamp:new Date(e.sentAt)}},t.notificationsFor=function(e){return t.props.notifications.filter(function(t){return t.afterMessageID===e}).map(t.createNotificationLine)},t.createNotificationLine=function(e){return{type:y.Notification,content:e.content}},t.createNewMessagesIndicator=function(){return{type:y.NewMessages}},t.createWarningMessage=function(){return{type:y.Warning}},t.createInactiveUserMessage=function(){return{type:y.InactiveUserNotice}},t.saveScrollRef=function(e){return t.scroll=e},t.scrollToBottom=function(){t.scroll.scrollToBottom()},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.scrollToBottom(),this.setState({disableInfiniteTrigger:!1})},t.prototype.componentWillReceiveProps=function(e){var t=this.props.thread.messages&&this.props.thread.messages.edges.length>0,n=e.thread.messages&&e.thread.messages.edges.length>0;if(!t&&n||t&&n&&this.props.thread.messages&&e.thread.messages&&this.props.thread.messages.edges[0].cursor!==e.thread.messages.edges[0].cursor){if(!this.scroll||!this.scroll.scrollContent)return;this.setState({prevScrollHeight:this.scroll.scrollContent.scrollHeight})}},t.prototype.componentDidUpdate=function(e){if(this.props.thread.messages&&e.thread.messages&&this.props.thread.messages.edges.length>e.thread.messages.edges.length)if(this.props.thread.messages.edges[0]&&e.thread.messages.edges[0]&&this.props.thread.messages.edges[0].cursor===e.thread.messages.edges[0].cursor&&this.props.thread.messages.edges[0].node.id===e.thread.messages.edges[0].node.id){if(this.scroll&&this.scroll.scrollContent&&this.state.prevScrollHeight&&this.state.prevScrollHeight!==this.scroll.scrollContent.scrollHeight){var t=this.scroll.scrollContent.scrollHeight-this.state.prevScrollHeight;this.scroll.scrollContent.scrollTop=t}}else this.scrollToBottom();this.props.notifications.length>e.notifications.length&&this.scrollToBottom(),e.collapsed&&!this.props.collapsed&&this.scrollToBottom()},t.prototype.render=function(){var e=this.getMessages();return N.createElement(G.a,{fullHeight:!0},N.createElement(M.b,{scrollRef:this.saveScrollRef,suppressScrollX:!0},N.createElement(G.a,null,N.createElement(M.a,{enabled:!this.state.disableInfiniteTrigger,loadMore:this.loadMore,pixelThreshold:200,orientation:ht.b.Down,contentLength:e.length}),this.renderMessages(e))))},t.prototype.generateMessageKey=function(e,t){switch(e.type){case y.NewMessages:case y.Warning:case y.InactiveUserNotice:return""+e.type;case y.Timestamp:return e.type+"-"+e.timestamp.getTime();case y.Whisper:return e.type+"-"+e.id;case y.Notification:return e.type+"-"+t;default:return r.k.warn("[ThreadMessages] Encountered an unknown message type."),t}},t}(N.Component);var ft,kt=Object(S.connect)(function(e,t){return{notifications:b(e,t.thread.id)}})(gt),vt=n("Wcon"),bt=n("L9xt"),yt=n("CMUD");function St(e){var t=function(e){try{return r.q.apollo.client.readQuery({query:yt,variables:{threadID:e}})}catch(e){return r.k.warn("Could not find cached whisper thread data:",e),null}}(e.threadID);if(t){var n=t.currentUser,i=t.whisperThread;if(n&&n.id&&n.login&&i){var a=i.participants.find(function(e){return!!e&&e.id!==n.id});if(a&&a.self&&a.self.whisperPermissions){var s={conversation_id:e.threadID,message_id:null,message_uuid:e.messageID,read_mode:e.automatic?ft.Focus:ft.Manual,recipient_id:n.id,recipient_login:n.login,sender_id:a.id,sender_login:a.login,sender_temp_permitted:a.self.whisperPermissions.receive===Te.xb.TEMPORARY};r.p.track(bt.SpadeEventType.WhisperRead,s)}else r.k.warn("Failed to find whisper sender in cache.")}else r.k.warn("Failed to find required data in cache.")}}!function(e){e.Focus="focus read",e.Manual="manual read"}(ft||(ft={}));var _t={};function Ct(e,t,n){var i=_t[e.threadID];if(i){if(i.lastReadCursorID>=t)return;clearTimeout(i.timeoutHandle)}var s=setTimeout(function(){var t=a.__assign({mutation:vt},Object(w.a)({threadID:e.threadID,lastReadMessageID:e.lastReadMessageID}),{optimisticResponse:{updateWhisperThread:{thread:{__typename:"WhisperThread",id:e.threadID,unreadMessagesCount:0},__typename:"UpdateWhisperThreadPayload"}}});r.q.apollo.client.mutate(t),delete _t[e.threadID],St({automatic:n,messageID:e.lastReadMessageID,threadID:e.threadID})},250);_t[e.threadID]={timeoutHandle:s,lastReadCursorID:t}}var Et=n("TOso");function Nt(e){return e.type===T.PubsubMessageType.WhisperSent}function Dt(e){return e.type===T.PubsubMessageType.WhisperReceived}n("28vT");var It,Tt,wt=n("Jpf8"),Ft=n("4VGW");!function(e){e.Wrapper="thread__wrapper",e.StrangerNotice="stranger__warning"}(Tt||(Tt={}));var Ot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={strangerWarningDismissed:!1},t.hadError=!1,t.onEmoticonClick=function(e){if(t.autocompleteInput){var n=t.autocompleteInput.getValue();n&&n.length>0&&!n.endsWith(" ")&&(n+=" "),n+=e+" ",t.autocompleteInput.setValue(n)}},t.onBlock=function(e){t.addNotification(Object(r.d)("User successfully blocked","whispers")),t.props.onBlock&&t.props.onBlock(e)},t.onUnblock=function(){t.addNotification(Object(r.d)("User successfully unblocked","whispers"))},t.loadMore=function(){return a.__awaiter(t,void 0,void 0,function(){return a.__generator(this,function(e){return this.props.data.loading||this.hadError?[2]:[2,this.props.loadMore()]})})},t.addNotification=function(e){t.props.notifyWhisperThread(t.props.threadID,e,t.getLastMessageID())},t.getLastMessageID=function(){if(t.props.data.whisperThread&&t.props.data.whisperThread.messages&&t.props.data.whisperThread.messages.edges[0])return t.props.data.whisperThread.messages.edges[0].node.id},t.handleHeaderInteract=function(){t.props.collapsed?t.expand():t.collapse()},t.expand=function(){t.props.data.currentUser&&Object(de.h)(t.props.threadID),t.props.onExpand(t.props.threadID)},t.onClickOut=function(){t.props.focused&&t.props.onUnfocus(t.props.threadID)},t.handleClose=function(){t.props.data.currentUser&&Object(de.c)(t.props.threadID),t.props.onClose(t.props.threadID)},t.collapse=function(){t.props.data.currentUser&&Object(de.d)(t.props.threadID),t.props.onCollapse(t.props.threadID)},t.handleKeydown=function(e){if((e.charCode||e.keyCode)===De.a.Enter&&t.autocompleteInput){var n=t.autocompleteInput.getValue();t.autocompleteInput.setValue(""),t.sendWhisper(n)}},t.handleClick=function(){t.props.onFocus(t.props.threadID),t.markThreadMessagesAsRead()},t.onStrangerWarningConfirmation=function(){t.setState({strangerWarningDismissed:!0})},t.markThreadMessagesAsRead=function(){if(!t.props.data.loading&&!t.hadError&&t.props.data.whisperThread&&t.props.data.whisperThread.messages&&0!==t.props.data.whisperThread.messages.edges.length&&0!==t.props.data.whisperThread.unreadMessagesCount){var e=t.props.data.whisperThread&&+t.props.data.whisperThread.messages.edges[0].cursor;e&&!isNaN(e)||(e=0),Ct({threadID:t.props.threadID,lastReadMessageID:t.props.data.whisperThread&&t.props.data.whisperThread.messages.edges[0].node.id||""},e,!1)}},t.sendWhisper=function(e){if(""!==e){t.props.latencyTracking.resetCustomEvents(A.a.Whispers),t.outgoingWhisperRenderedEvent=t.props.latencyTracking.registerCustomEvent({benchmark:150,group:A.a.Whispers,key:A.b.WhispersRenderSent,label:A.c.RenderSent,start:A.d.Registration}),t.outgoingWhisperMessage=e;var n=Object(he.b)(t.props.threadID,t.props.currentUserID);n?(t.props.data.currentUser&&t.interlocutor&&t.interlocutor.login&&Object(de.m)({threadID:t.props.threadID,targetUserLogin:t.interlocutor.login,inChannelChat:!1}),Object(Et.b)({currentUserID:t.props.currentUserID,emotes:t.props.emoteSetsData&&t.props.emoteSetsData.emoteMap||{},message:e,recipientUserID:n}).then(function(e){if(e.data.sendWhisper.error)throw new Error(e.data.sendWhisper.error.code)}).catch(function(e){var n,i;switch(e.message){case Et.a.RestrictedRecipient:n=Object(r.d)("Your whisper was not delivered because the recipient's settings prevent them from receiving it.","Thread");break;case Et.a.BodyEmpty:n=Object(r.d)("Your whisper was not delivered because it was empty.","Thread");break;case Et.a.TargetBanned:n=Object(r.d)("Your whisper was not delivered because the recipient is suspended.","Thread");break;default:n=Object(r.d)("Your whisper was not delivered.","Thread")}t.props.data.whisperThread&&t.props.data.whisperThread.messages&&t.props.data.whisperThread.messages.edges.length>0&&(i=t.props.data.whisperThread.messages.edges[0].node.id),t.props.notifyWhisperThread(t.props.threadID,n,i)})):r.k.warn("Unable to parse whisper recipient ID.")}},t.setAutocompleteInnerComponentRef=function(e){t.textInput=e},t.setAutocompleteInputRef=function(e){return t.autocompleteInput=e},t.handleContentClick=function(){var e=document.getSelection();!t.textInput||e&&e.toString()||t.textInput.focus()},t.setContainerRef=function(e){t.autocompleteContainer=e},t.reportOutgoingWhisperRendered=function(e){t.outgoingWhisperRenderedEvent&&e===t.outgoingWhisperMessage&&t.props.latencyTracking.reportCustomEvent(t.outgoingWhisperRenderedEvent)},t.otherParticipant=function(){var e=t.props.data.whisperThread;if(e)return me(e.participants,t.props.currentUserID)},t.hasUnknownParticipant=function(){var e=t.otherParticipant();return!(e&&e.login)},t.isStrangerBlocked=function(){return!!(t.interlocutor&&t.interlocutor.id&&t.interlocutor.self&&t.interlocutor.self.whisperPermissions&&t.interlocutor.self.whisperPermissions.isStrangerBlocked)},t.shouldDisableInteractions=function(){return t.hasUnknownParticipant()},t}return a.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){e.data.error&&(this.hadError=!0),e.data.error||e.data.loading||!e.data.whisperThread||this.props.reportThreadData(e.threadID,e.data.whisperThread)},t.prototype.componentDidMount=function(){this.props.data.loading||this.markSuspendedUserThreadRead()},t.prototype.componentDidUpdate=function(e){var t=this;e.data.loading&&!this.props.data.loading&&this.markSuspendedUserThreadRead();var n=e.data&&e.data.whisperThread&&e.data.whisperThread.messages&&e.data.whisperThread.messages.edges.length||0,i=this.props.data&&this.props.data.whisperThread&&this.props.data.whisperThread.messages&&this.props.data.whisperThread.messages.edges.length||0;this.isStrangerBlocked()&&n!==i&&Object(w.g)(wt,{id:this.props.threadID},function(e){var n=e.whisperThread;if(n&&n.participants){var i=me(n.participants,t.props.currentUserID);i&&i.self&&i.self.whisperPermissions&&(i.self.whisperPermissions.isStrangerBlocked=!1)}return e})},Object.defineProperty(t.prototype,"interlocutor",{get:function(){return this.otherParticipant()},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=E({"whispers-thread":!0,"whispers-thread--collapsed":this.props.collapsed,"whispers-thread--focused":this.props.focused});if(this.props.hidden)return null;var t,n=this.props.activityData.loading?void 0:this.props.activityData.user,i=n&&n.availability||void 0,r=n&&n.activity;return t=!this.state.strangerWarningDismissed&&this.interlocutor&&this.interlocutor.id&&this.interlocutor.self&&this.interlocutor.self.whisperPermissions&&this.interlocutor.self.whisperPermissions.receive===Te.xb.NOT_PERMITTED?N.createElement(xe,{onStrangerWarningConfirmation:this.onStrangerWarningConfirmation,targetDisplayName:this.interlocutor.displayName,targetUserID:this.interlocutor.id}):this.renderMessageArea(),N.createElement(O.a,{onClickOut:this.onClickOut},N.createElement(K.a,{className:e,display:z.d.Flex,flexShrink:0,flexGrow:0,position:z.j.Relative,overflow:z.i.Hidden,background:Q.a.Base,margin:{left:1},alignItems:z.b.Center,justifyContent:z.h.Center,"data-test-selector":Tt.Wrapper,"data-a-target":"whisper-thread-"+(this.interlocutor&&this.interlocutor.login)+(this.props.collapsed?"-collapsed":""),elevation:3,borderRadius:{topLeft:Q.b.Medium,topRight:Q.b.Medium}},t,N.createElement(G.a,{position:z.j.Absolute,fullWidth:!0,flexShrink:0,display:z.d.Flex,alignItems:z.b.Center,attachTop:!0,attachLeft:!0},N.createElement(pt,{isHighlighted:!!(this.props.data.whisperThread&&this.props.data.whisperThread.unreadMessagesCount>0),isFocused:!!this.props.focused,isMuted:!!this.props.data.whisperThread&&this.props.data.whisperThread.isMuted,isCollapsed:this.props.collapsed,isLoading:this.props.data.loading||this.props.activityData.loading,interactionsDisabled:this.shouldDisableInteractions(),currentUser:this.props.data.currentUser,interlocutor:this.interlocutor,interlocutorAvailability:i,interlocutorActivity:r,spamInfo:this.props.data.whisperThread&&this.props.data.whisperThread.spamInfo,threadID:this.props.threadID,collapse:this.collapse,onHeaderInteract:this.handleHeaderInteract,onBlock:this.onBlock,onUnblock:this.onUnblock,onClose:this.handleClose,showReportUserModal:this.props.showReportUserModal}))))},t.prototype.markSuspendedUserThreadRead=function(){this.hasUnknownParticipant()&&this.markThreadMessagesAsRead()},t.prototype.renderMessageArea=function(){var e=this.props.emoteSetsData&&this.props.emoteSetsData.emoteSets||[],t=null;t=this.isStrangerBlocked()?[N.createElement(q.a,{color:Q.c.Alt2,key:"stranger-notification","data-test-selector":Tt.StrangerNotice},Object(r.d)('This user has turned on "Block Whispers from Strangers" in their privacy settings and must start a conversation with you first.',"WhisperThread"))]:[N.createElement(we.b,{key:"input",disabled:this.shouldDisableInteractions(),componentType:we.a.Input,suggestionSource:we.c.Whisper,iconRight:!0,onFocus:this.handleClick,onClick:this.handleClick,onKeyDown:this.handleKeydown,componentRefDelegate:this.setAutocompleteInnerComponentRef,refDelegate:this.setAutocompleteInputRef,containerElement:this.autocompleteContainer},N.createElement(we.d,{emotes:e})),N.createElement(Fe.a,{key:"emote-picker",attachBottom:!0,attachRight:!0,inputRef:this.textInput,emotePickerSource:Oe.a.Whisper,onClickEmote:this.onEmoticonClick,padding:{x:1,bottom:1},position:z.j.Absolute,shouldCloseOnClickOut:!0,channelOwnerID:null})];var n=E({"whispers-thread__autocomplete-container":!0,"whispers-thread__autocomplete-container--with-stranger-warning":this.isStrangerBlocked()}),i=E({"whispers-thread__content":!0,"whispers-thread__content--with-stranger-warning":this.isStrangerBlocked()});return[N.createElement(G.a,{className:n,position:z.j.Absolute,attachBottom:!0,attachLeft:!0,attachRight:!0,refDelegate:this.setContainerRef,key:"whispers-input"},N.createElement(G.a,{position:z.j.Absolute,fullWidth:!0,padding:{x:1,bottom:1},attachBottom:!0,attachLeft:!0},t)),N.createElement(z.g,{fullWidth:!0,attachLeft:!0,key:"whispers-content"},N.createElement("div",{className:i,onClick:this.handleContentClick},this.renderContent()))]},t.prototype.renderContent=function(){return this.hadError?N.createElement(Ee.a,{message:Object(r.d)("Sorry, something went wrong loading this conversation.","WhisperThread")}):this.props.data.loading||this.props.activityData.loading||!this.props.data.whisperThread?N.createElement(G.a,{display:z.d.Flex,justifyContent:z.h.Center,alignItems:z.b.Center,margin:2,fullHeight:!0,flexGrow:1},N.createElement(ge.a,null)):N.createElement(kt,{thread:this.props.data.whisperThread,participantsByID:this.getUsersByID(this.props.data.whisperThread.participants),unreadMessagesCount:this.props.data.whisperThread.unreadMessagesCount,loadMore:this.loadMore,reportOutgoingWhisperRendered:this.reportOutgoingWhisperRendered,collapsed:this.props.collapsed,hasUnknownParticipant:this.hasUnknownParticipant()})},t.prototype.getUsersByID=function(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n];r&&r.id&&(t[r.id]=r)}return t},t}(N.Component),Mt=Object(i.compose)(Object(D.a)(Ft,{options:function(e){return{variables:{targetUserID:Object(he.b)(e.threadID,e.currentUserID)||""},skip:!e.currentUserID||!e.threadID}},name:"activityData"}),Object(D.a)(wt,{options:function(e){return{variables:{id:e.threadID}}},props:function(e){return a.__assign({},e,{loadMore:function(){var t="";return e.data.whisperThread&&e.data.whisperThread.messages&&e.data.whisperThread.messages.edges.length>0&&(t=e.data.whisperThread.messages.edges[e.data.whisperThread.messages.edges.length-1].cursor),e.data.fetchMore({query:wt,variables:a.__assign({},e.data.variables,{cursor:t}),updateQuery:function(e,t){var n=t.fetchMoreResult;if(!n.whisperThread)return{whisperThread:null,currentUser:e.currentUser};if(!e.whisperThread||!e.whisperThread.messages)return{whisperThread:n.whisperThread,currentUser:e.currentUser};if(!n.whisperThread||!n.whisperThread.messages)return{whisperThread:e.whisperThread,currentUser:e.currentUser};var i=a.__assign({},n.whisperThread.messages,{edges:Object(w.c)(e.whisperThread.messages.edges,n.whisperThread.messages.edges)});return{whisperThread:a.__assign({},n.whisperThread,{messages:i}),currentUser:e.currentUser}}})}})}}),Object(Ne.a)([{topic:function(e){return Object(F.O)(e.currentUserID)},mapMessageTypesToProps:(It={},It[T.PubsubMessageType.WhisperReceived]="whisperReceived",It[T.PubsubMessageType.WhisperSent]="whisperSent",It),skipMessage:function(e,t){return!Nt(e)&&!Dt(e)||e.data_object.thread_id!==t.threadID}}]),Object(Ie.a)(),Object(P.withLatencyTracking)("WhispersThread",{autoReportInteractive:!0}))(Ot);var Ut=Object(S.connect)(function(e){return{isLoggedIn:Object(_e.f)(e)}},function(e){return Object(i.bindActionCreators)({notifyWhisperThread:f,showReportUserModal:function(e){var t=a.__rest(e,[]);return Object(Se.d)(Ce.a,t)}},e)})(Mt),xt=(n("J45U"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.resizeAnimationHandle=null,t.renderThread=function(e){return e?N.createElement(Ut,{key:e.threadID,currentUserID:t.props.currentUserID,collapsed:e.collapsed,hidden:e.hidden,threadID:e.threadID,onBlock:t.onBlock,onCollapse:t.props.onCollapseThread,onClose:t.props.onCloseThread,onExpand:t.props.onExpandThread,onFocus:t.props.onFocusThread,onUnfocus:t.props.onUnfocusThread,focused:t.props.focusedThreadID===e.threadID,reportThreadData:t.props.reportThreadData}):null},t.onBlock=function(e){t.props.archiveThread(e),t.props.onBlockThread(e)},t.handleContentResize=function(){t.resizeAnimationHandle||(t.resizeAnimationHandle=requestAnimationFrame(function(){t.props.onResizeContent(),t.resizeAnimationHandle=null}))},t}return a.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.openedThreads.map(function(t){return e.renderThread(t)});return N.createElement(G.a,{className:"whispers-open-threads",display:z.d.Flex,flexDirection:z.e.RowReverse,alignItems:z.b.End,position:z.j.Absolute,attachBottom:!0,attachLeft:!0,refDelegate:C.b},t,N.createElement(ye.a,{onResize:this.handleContentResize}))},t}(N.Component));var Rt=Object(S.connect)(function(e){return{openedThreads:e.whispers.display.openedIDs.map(function(t){return function(e,t){return e.whispers?e.whispers.display.byID[t]:null}(e,t)}),focusedThreadID:e.whispers.display.focusedID}},function(e){return{onBlockThread:function(t){return e(o.h(t,Object(C.a)()))},onCloseThread:function(t){return e(o.h(t,Object(C.a)()))},onCollapseThread:function(t){return e(o.i(t,Object(C.a)()))},onExpandThread:function(t){return e(o.j(t,Object(C.a)()))},onFocusThread:function(t){return e(o.k(t,Object(C.a)()))},onUnfocusThread:function(t){return e(o.n(t,Object(C.a)()))},onResizeContent:function(){return e(o.m(Object(C.a)()))}}},void 0,{areStatesEqual:function(e,t){return e.whispers.display===t.whispers.display}})(xt);function At(e){return Object.keys(e).reduce(function(t,n){var i=e[n];return i.muted||i.archived?t:t+i.unreadMessagesCount},0)}var Pt=n("U1yz"),jt=function(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n],s=Lt(r);r.id&&s&&(t[r.id]=a.__assign({},s))}return t},Lt=function(e){return e.messages?{id:e.id,lastMessage:e.messages.edges.map(function(e){return e.node}).find(function(e){return!e.deletedAt})||null,messageHistory:e.messages.edges.map(function(e){return e.node}).slice(0,-1),unreadMessagesCount:e.unreadMessagesCount,participants:e.participants.map(function(e){return e?a.__assign({},e,{displayBadges:[],self:null}):null}),spamInfo:e.spamInfo,muted:e.isMuted,archived:e.isArchived}:null},Bt=n("xXlL");var Wt=n("Ideu"),Vt=n("WcC5"),Ht=n("PRj+"),qt=(n("c/47"),function(e){function t(t){var n=e.call(this,t)||this;n.erroredLoadingMore=!1,n.logger=r.k.withCategory("whispers"),n.archiveThread=function(e){if(n.state.threadsByID[e]){var t=a.__assign({},Object(w.a)({threadID:e,isArchived:!0}),{optimisticResponse:{updateWhisperThread:{thread:{__typename:"WhisperThread",id:e,isArchived:!0},__typename:"UpdateWhisperThreadPayload"}}});n.props.archiveThread&&(n.props.closeThread(e),n.props.data.currentUser&&Object(de.a)(e),n.props.archiveThread(t))}},n.selectThread=function(e){n.props.openThread({threadID:e,collapsed:!1})},n.onNotificationInteracted=function(e){var t=/(.*)-whisper-body/.exec(e.actionID);if(t&&t.length>1){var i=t[1];n.selectThread(i)}},n.loadMore=function(){return a.__awaiter(n,void 0,void 0,function(){var e;return a.__generator(this,function(t){switch(t.label){case 0:if(this.props.data.loading||this.props.data.error||this.erroredLoadingMore)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.props.loadMore()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),this.logger.warn("Load more whisper threads failed",{error:e}),this.erroredLoadingMore=!0,[3,4];case 4:return[2]}})})},n.handleThreadDataReport=function(e,t){var i;n.state.threadsByID[e]||Object(w.g)(Ht,{cursor:null},function(e){return e.currentUser&&e.currentUser.whisperThreads&&e.currentUser.whisperThreads.edges.unshift({cursor:"0",node:a.__assign({},t,{isArchived:!1}),__typename:"WhisperThreadEdge"}),e});var r=a.__assign({},n.state.threadsByID[e]);t.messages&&(r.messageHistory=t.messages.edges.map(function(e){return e.node}).slice(0,-1)),!1!==t.isMuted&&!0!==t.isMuted||(r.muted=t.isMuted);var s=a.__assign({},n.state.threadsByID,((i={})[e]=r,i));n.setState({threadsByID:s,unreadCount:At(s)})};var i=n.props.data.currentUser&&n.props.data.currentUser.whisperThreads&&jt(n.props.data.currentUser.whisperThreads.edges.map(function(e){return e.node}))||{};return n.state={error:!!n.props.data.error,orderedThreadIDs:n.props.data.currentUser&&n.props.data.currentUser.whisperThreads&&n.props.data.currentUser.whisperThreads.edges.map(function(e){return e.node.id})||[],renderError:!1,threadsByID:i,unreadCount:At(i)},n}return a.__extends(t,e),t.prototype.componentDidCatch=function(e,t){var n=this;this.setState({renderError:!0},function(){r.q.stats.recordComponentError("Whispers"),n.logger.error(e,"A unhandled exception occurred in the component hierarchy",{info:t})})},t.prototype.componentDidMount=function(){r.q.integrations.notifications&&r.q.integrations.notifications.onNotificationInteracted(this.onNotificationInteracted)},t.prototype.componentWillReceiveProps=function(e){if(e.data.error)this.setState({error:!!e.data.error});else if(!e.data.loading&&e.data.currentUser&&e.data.currentUser.whisperThreads){var t=jt(e.data.currentUser.whisperThreads.edges.map(function(e){return e.node}));this.setState({threadsByID:t,orderedThreadIDs:e.data.currentUser.whisperThreads.edges.map(function(e){return e.node.id}),unreadCount:At(t)})}},t.prototype.render=function(){if(!this.props.data.currentUser||!this.props.data.currentUser.id||this.state.renderError||!this.props.isVisible)return null;var e=E({whispers:!0,"whispers--theatre-mode":this.props.theatreModeEnabled,"whispers--right-column-expanded":this.props.rightColumnExpanded});return N.createElement(G.a,{className:e,position:z.j.Absolute,attachBottom:!0,attachLeft:!0,margin:{right:1}},N.createElement(Rt,{currentUserID:this.props.data.currentUser.id,reportThreadData:this.handleThreadDataReport,archiveThread:this.archiveThread}),N.createElement(be,{currentUserID:this.props.data.currentUser.id,error:this.state.error,loading:this.props.data.loading,unreadCount:this.state.unreadCount,orderedThreadIDs:this.state.orderedThreadIDs,threadsByID:this.state.threadsByID,selectThread:this.selectThread,archiveThread:this.archiveThread,loadMore:this.loadMore}))},t=a.__decorate([Object(D.a)(Ht,{props:function(e){return a.__assign({},e,{loadMore:function(){return e.data.fetchMore({query:Ht,variables:a.__assign({},e.data.variables,{cursor:e.data.currentUser&&e.data.currentUser.whisperThreads&&e.data.currentUser.whisperThreads.edges.length>0?e.data.currentUser.whisperThreads.edges[e.data.currentUser.whisperThreads.edges.length-1].cursor:null}),updateQuery:function(e,t){var n=t.fetchMoreResult;return n.currentUser?e.currentUser&&e.currentUser.whisperThreads?n.currentUser.whisperThreads?{currentUser:a.__assign({},n.currentUser,{whisperThreads:a.__assign({},n.currentUser.whisperThreads,{edges:Object(w.c)(e.currentUser.whisperThreads.edges,n.currentUser.whisperThreads.edges)})})}:{currentUser:a.__assign({},n.currentUser,{whisperThreads:e.currentUser.whisperThreads})}:{currentUser:n.currentUser}:{currentUser:null}}})}})}}),Object(D.a)(Vt,{name:"archiveThread"}),Object(I.a)(function(e){return{query:Ht,types:[T.PubsubMessageType.WhisperDeleted,T.PubsubMessageType.WhisperEdited,T.PubsubMessageType.WhisperSent,T.PubsubMessageType.WhisperAllThreadsUpdate,T.PubsubMessageType.WhisperReceived,T.PubsubMessageType.WhisperThreadUpdate],variables:a.__assign({},e.data.variables),skip:!e.data.currentUser||void 0===e.data.currentUser.id,topic:Object(F.O)(e.data.currentUser&&e.data.currentUser.id||""),mutator:function(t,n){if(!n.currentUser||!n.currentUser.whisperThreads)return n;if(Nt(t)||Dt(t)){if(Dt(t)){var i=n.currentUser.whisperThreads.edges.find(function(e){return e.node.id===t.data_object.thread_id});if(i){var a=i.node.participants.find(function(e){return!!e&&e.id===""+t.data_object.from_id});a&&a.login&&(Object(de.l)({targetUserLogin:a.login,threadID:t.data_object.thread_id}),r.q.integrations.notifications&&a.profileImageURL&&r.q.integrations.notifications.send({body_md:"**"+a.displayName+"** "+t.data_object.body,thumbnail_url:a.profileImageURL,id:t.data_object.thread_id,actions:[{id:t.data_object.thread_id+"-whisper-body",type:Wt.NotificationsIntegrationNotificationActionType.Body}],created_at:Date.now(),updated_at:Date.now(),type:"whisper",read:!1}))}}return function(e,t,n,i){if(!t.currentUser||!t.currentUser.whisperThreads)return t;var a=r.o.get("whisperDoNotDisturb",!1),s=t.currentUser.whisperThreads.edges.find(function(t){return t.node.id===e.data_object.thread_id});if(s&&s.node.messages){var o=Object(Bt.c)(e);s.node.messages.edges.unshift(o),Dt(e)&&(e.data_object.thread_id!==n?s.node.unreadMessagesCount+=1:Ct({threadID:e.data_object.thread_id,lastReadMessageID:e.data_object.message_id},e.data_object.id,!0),i({threadID:e.data_object.thread_id,collapsed:!0,hidden:a})),s.node.isArchived=!1;var d=t.currentUser.whisperThreads.edges.filter(function(t){return t.node.id!==e.data_object.thread_id});d.unshift(s),t.currentUser.whisperThreads.edges=d}else i({threadID:e.data_object.thread_id,collapsed:!0,hidden:a});return t}(t,n,e.focusedThreadID,e.openThread)}return function(e){return e.type===T.PubsubMessageType.WhisperDeleted}(t)?function(e,t){if(!t.currentUser||!t.currentUser.whisperThreads)return t;var n=t.currentUser.whisperThreads.edges.find(function(t){return t.node.id===e.data_object.thread_id});if(n&&n.node.messages){var i=n.node.messages.edges.find(function(t){return t.node.id===e.data_object.message_id});i&&(i.node.deletedAt=new Date(1e3*e.data_object.deleted_at).toISOString(),i.node.content.content=e.data_object.body,i.node.content.emotes=Object(Bt.b)(e.data_object.tags.emotes))}return t}(t,n):function(e){return e.type===T.PubsubMessageType.WhisperEdited}(t)?function(e,t){if(!t.currentUser||!t.currentUser.whisperThreads)return t;var n=t.currentUser.whisperThreads.edges.find(function(t){return t.node.id===e.data_object.thread_id});if(n&&n.node.messages){var i=n.node.messages.edges.find(function(t){return t.node.id===e.data_object.message_id});i&&(i.node.editedAt=new Date(1e3*e.data_object.edited_at).toISOString(),i.node.content.content=e.data_object.body,i.node.content.emotes=Object(Bt.b)(e.data_object.tags.emotes))}return t}(t,n):function(e){return e.type===T.PubsubMessageType.WhisperThreadUpdate}(t)?function(e,t,n){if(!t.currentUser||!t.currentUser.whisperThreads)return t;var i=t.currentUser.whisperThreads.edges.findIndex(function(t){return t.node.id===e.data_object.id});if(i>=0){var r=t.currentUser.whisperThreads.edges[i];if(r.node.messages){var a=r.node.messages.edges[0].cursor,s=parseInt(a,10)-e.data_object.last_read;r.node.unreadMessagesCount=s>=0?s:0,r.node.isMuted=e.data_object.muted,!r.node.isArchived&&e.data_object.archived&&n(e.data_object.id),r.node.isArchived=e.data_object.archived}}return t}(t,n,e.closeThread):function(e){return e.type===T.PubsubMessageType.WhisperAllThreadsUpdate}(t)?function(e,t){return t.currentUser&&t.currentUser.whisperThreads?(e.data_object.mark_all_read&&t.currentUser.whisperThreads.edges.forEach(function(e){e.node.unreadMessagesCount=0}),t):t}(t,n):n},skipMessage:function(e,t){if(Nt(e)){if(!t.currentUser||!t.currentUser.whisperThreads)return!1;var n=void 0;try{n=Object(Pt.a)(r.q.apollo.client.cache,e.data_object.thread_id,!0)}catch(e){return!1}if(n&&n.messages&&n.messages.edges.findIndex(function(t){return""!==t.node.nonce&&t.node.nonce===e.data_object.nonce})>=0)return!0}return!1}}})],t)}(N.Component));var Gt=Object(S.connect)(function(e){return{isVisible:Object(_.b)(e),rightColumnExpanded:e.ui.rightColumnExpanded,theatreModeEnabled:e.ui.theatreModeEnabled,focusedThreadID:e.whispers.display.focusedID}},function(e){return{openThread:function(t){return e(o.l(t,Object(C.a)()))},closeThread:function(t){return e(o.h(t,Object(C.a)()))}}})(qt);n.d(t,"Whispers",function(){return Gt})},"4VGW":function(e,t,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Whispers_Thread_User_Activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"targetUserID"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"targetUserID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"chatColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileImageURL"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"IntValue",value:"70"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayBadges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"imageURL"},arguments:[],directives:[]}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"presenceFragment"},directives:[]}]}}]}}],loc:{start:0,end:256}};i.loc.source={body:'#import "twilight/common/queries/presence-fragment.gql"\nquery Whispers_Thread_User_Activity($targetUserID: ID) {\nuser(id: $targetUserID) {\nid\nchatColor\ndisplayName\nprofileImageURL(width: 70)\nlogin\ndisplayBadges {\nid\ntitle\nimageURL\n}\n...presenceFragment\n}\n}',name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};i.definitions=i.definitions.concat(n("wsiY").definitions.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!r[t]&&(r[t]=!0,!0)})),e.exports=i},"4qQ0":function(e,t,n){"use strict";var i,r;n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),function(e){e.BitsViolation="bits_violation",e.ChatBanEvasion="chat_ban_evasion",e.Cheating="cheating",e.Gore="gore",e.Harassment="harassment",e.Harm="harm",e.HatefulConduct="hateful_conduct",e.Impersonation="impersonation",e.Miscategorized="miscategorized",e.OffensiveUsername="offensive_username",e.Other="other",e.Porn="porn",e.Prohibited="prohibited",e.SelfHarm="selfharm",e.SexualContent="sexual_content",e.SexualViolence="sexual_violence",e.Spam="spam",e.TosBanEvasion="tos_ban_evasion",e.Underaged="underaged"}(i||(i={})),function(e){e[e.Unsubmitted=0]="Unsubmitted",e[e.Success=1]="Success",e[e.FormError=2]="FormError",e[e.MutationError=3]="MutationError",e[e.UserError=4]="UserError"}(r||(r={}))},"5zf8":function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return d});var i,r,a=n("/7QA");function s(e,t){switch(e){case i.Second:return Object(a.d)("{secondCount, plural, one {# second} other {# seconds}}",{secondCount:t},"formatDuration");case i.Minute:return Object(a.d)("{minuteCount, plural, one {# minute} other {# minutes}}",{minuteCount:t},"formatDuration");case i.Hour:return Object(a.d)("{hourCount, plural, one {# hour} other {# hours}}",{hourCount:t},"formatDuration");case i.Day:return Object(a.d)("{dayCount, plural, one {# day} other {# days}}",{dayCount:t},"formatDuration");case i.Week:return Object(a.d)("{weekCount, plural, one {# week} other {# weeks}}",{weekCount:t},"formatDuration");case i.Month:return Object(a.d)("{monthCount, plural, one {# month} other {# months}}",{monthCount:t},"formatDuration");default:return""}}function o(e,t){switch(e){case i.Second:return Object(a.d)("{secondCount}s",{secondCount:t},"formatDuration");case i.Minute:return Object(a.d)("{minuteCount}m",{minuteCount:t},"formatDuration");case i.Hour:return Object(a.d)("{hourCount}h",{hourCount:t},"formatDuration");case i.Day:return Object(a.d)("{dayCount}d",{dayCount:t},"formatDuration");case i.Week:return Object(a.d)("{weekCount}w",{weekCount:t},"formatDuration");case i.Month:return Object(a.d)("{monthCount}mo",{monthCount:t},"formatDuration");default:return""}}function d(e,t){var n;switch(void 0===t&&(t=r.Humanized),t===r.ClockAuto&&(t=e>=3600?r.ClockHMS:r.ClockMS),t){case r.ClockHM:case r.ClockHMS:n=i.Hour;break;case r.ClockMS:n=i.Minute}var d=2;t===r.ClockHMS&&(d=3);var l=function(e,t){void 0===t&&(t=i.Month);var n={};return n.seconds=e,e<60||t===i.Second?n:(n.minutes=Math.floor(e/60),n.seconds=e%60,n.minutes<60||t===i.Minute?n:(n.hours=Math.floor(n.minutes/60),n.minutes=n.minutes%60,n.hours<24||t===i.Hour?n:(n.days=Math.floor(n.hours/24),n.hours=n.hours%24,n.days<7||t===i.Day?n:n.days<=26||t===i.Week?(n.weeks=Math.floor(n.days/7),n.days=n.days%7,n):(n.months=Math.round((n.days+3)/30),n))))}(e,n),u=Object.keys(l);if(u.forEach(function(e,n){t!==r.Humanized&&t!==r.HumanizedShort||l[e]||delete l[e],n<u.length-d&&delete l[e]}),t===r.Humanized)return function(e){return e.months?s(i.Month,e.months):e.weeks&&e.days?s(i.Week,e.weeks)+" "+s(i.Day,e.days):e.weeks?s(i.Week,e.weeks):e.days&&e.hours?s(i.Day,e.days)+" "+s(i.Hour,e.hours):e.days?s(i.Day,e.days):e.hours&&e.minutes?s(i.Hour,e.hours)+" "+s(i.Minute,e.minutes):e.hours?s(i.Hour,e.hours):e.minutes&&e.seconds?s(i.Minute,e.minutes)+" "+s(i.Second,e.seconds):e.minutes?s(i.Minute,e.minutes):s(i.Second,e.seconds||0)}(l);if(t===r.HumanizedShort)return function(e){return e.months?o(i.Month,e.months):e.weeks&&e.days?""+o(i.Week,e.weeks)+o(i.Day,e.days):e.weeks?o(i.Week,e.weeks):e.days&&e.hours?""+o(i.Day,e.days)+o(i.Hour,e.hours):e.days?o(i.Day,e.days):e.hours&&e.minutes?""+o(i.Hour,e.hours)+o(i.Minute,e.minutes):e.hours?o(i.Hour,e.hours):e.minutes&&e.seconds?""+o(i.Minute,e.minutes)+o(i.Second,e.seconds):e.minutes?o(i.Minute,e.minutes):o(i.Second,e.seconds||0)}(l);var m=":",p=!1;switch(a.q.intl.getLanguageCode()){case"cy":case"da":case"fi":case"id":case"nb":case"si":m=".";break;case"af":case"fr":case"lt":p=!0}var h=l.seconds||0,g=l.minutes||0,f=l.hours||0;switch(t){case r.ClockHM:case r.ClockHMS:var k=(p?c(f,2):f)+m+c(g,2);return t===r.ClockHMS&&(k+=m+c(h,2)),k;case r.ClockMS:return(p?c(g,2):g)+m+c(h,2)}}function c(e,t){var n=e.toString();return n.length<t?"0".repeat(t-n.length)+n:n}!function(e){e[e.Second=0]="Second",e[e.Minute=1]="Minute",e[e.Hour=2]="Hour",e[e.Day=3]="Day",e[e.Week=4]="Week",e[e.Month=5]="Month"}(i||(i={})),function(e){e[e.Humanized=0]="Humanized",e[e.HumanizedShort=1]="HumanizedShort",e[e.ClockAuto=2]="ClockAuto",e[e.ClockHM=3]="ClockHM",e[e.ClockMS=4]="ClockMS",e[e.ClockHMS=5]="ClockHMS"}(r||(r={}))},"60o1":function(e,t,n){"use strict";function i(e,t){var n=e,i=!1;return n?n.split("").map(function(e){return e.charCodeAt(0)>127}).reduce(function(e,t){return e||t})&&(i=!0):n=t,{userDisplayName:n,isIntl:i}}n.d(t,"a",function(){return i})},"6j5V":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("RcPG");function r(e){return{type:i.a.Text,content:e}}},"7SjK":function(e,t,n){"use strict";var i=n("mrSG"),r=n("q1tI"),a=n("TSYQ"),s=n("/7QA"),o=n("GnwI"),d=n("hnjF"),c=n("X2PJ"),l=n("7uM4"),u=n("Ws8v"),m=n("b7S+"),p=(n("GOKC"),r.createElement(u.a,{alignItems:d.b.Center,background:c.a.Overlay,borderRadius:c.b.Small,className:"emote-button__lock",color:c.c.Overlay,"data-test-selector":"emote-button-lock",display:d.d.InlineFlex,justifyContent:d.h.Center,position:d.j.Absolute,zIndex:d.n.Above},r.createElement(l.a,{asset:l.b.Lock,height:10,width:10}))),h=function(e){var t=a("emote-button__link",{"emote-button__link--locked":!e.onClick}),n=e.emote,i=n.displayName,c=n.srcSet;if(!c)return null;var l=r.createElement("img",{className:"emote-picker__image",srcSet:c,alt:i});if(e.isCriticalImage){for(var u=c.split(" ")[0],h={},g=0,f=c.split(",");g<f.length;g++){var k=f[g].trim().split(" "),v=k[1],b=k[0];h[v]=b}l=r.createElement(o.CriticalImage,{className:"emote-picker__emote-image",src:u,srcSet:h,alt:i||""})}return r.createElement("div",{className:"emote-button"},r.createElement(m.a,{label:i||Object(s.d)("Emote","EmoteButton"),direction:m.c.Bottom},r.createElement(d.g,{display:d.d.Flex,alignItems:d.b.Center,justifyContent:d.h.Center},r.createElement("button",{"data-test-selector":"emote-button-clickable",className:t,"aria-label":i,name:i,onClick:e.onClick?e.onClick.bind(null,e.emote):void 0,"data-a-target":i},r.createElement("figure",null,e.locked?p:null,l)))))},g=n("sUnt"),f=(n("VrOd"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClickEmote=function(e){t.props.onClickEmote&&t.props.onClickEmote(e,t.props.context)},t}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.emotes.map(function(t,n){return r.createElement(g.a,{key:"emote-button-padder-"+t.id+"--"+n,padding:{left:e.props.spaced?.5:0}},r.createElement(h,{key:"emote-button-"+t.id+"--"+n,emote:t,isCriticalImage:0===n,locked:e.props.locked||t.isLocked,onClick:e.props.locked?void 0:e.handleClickEmote}))});return r.createElement(g.a,{display:d.d.Flex,flexWrap:d.f.Wrap,justifyContent:d.h.Center},t)},t}(r.PureComponent));n.d(t,"a",function(){return f})},"8EUQ":function(e,t,n){"use strict";var i={};n.d(i,"SUB_CHECKOUT__PRODUCT_KEY",function(){return s}),n.d(i,"SUB_CHECKOUT__RECIPIENT_KEY",function(){return o}),n.d(i,"SUB_CHECKOUT__MYSTERY_GIFT_COUNT",function(){return d}),n.d(i,"SUB_CHECKOUT__GIFTING_ANONYMOUSLY",function(){return c}),n.d(i,"SUB_CHECKOUT__IS_ONE_TIME_PURCHASE",function(){return l}),n.d(i,"clearSubscriptionCheckoutKeys",function(){return m}),n.d(i,"showLoginModalWithCheckoutDispatch",function(){return p});var r=n("/7QA"),a=n("y5D0"),s="SUB_CHECKOUT__PRODUCT",o="SUB_CHECKOUT__RECIPIENT",d="SUB_CHECKOUT__MYSTERY_GIFT_COUNT",c="SUB_CHECKOUT__GIFTING_ANONYMOUSLY",l="SUB_CHECKOUT__IS_ONE_TIME_PURCHASE",u=[s,o,d,c,l];function m(){u.forEach(function(e){return r.o.remove(e)})}function p(e){return function(){return Object(a.e)(e,{onClose:m})}}n.d(t,"a",function(){return i})},"8jSG":function(e,t){var n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"blockedUsers"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"blockedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:56}};n.loc.source={body:"fragment blockedUsers on User {\nid\nblockedUsers {\nid\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},"9KaG":function(e,t,n){},BhFH:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("mrSG"),r=n("yR8l"),a=n("8jSG"),s=n("cMjZ"),o=n("kSkr");function d(){var e=this;return Object(r.a)(o,{props:function(t){return{blockUserMutation:function(n,r,o,d){return i.__awaiter(e,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return t.mutate?[4,t.mutate({variables:{input:{targetUserID:n,sourceContext:o,reason:r}},optimisticResponse:{blockUser:{__typename:"BlockUserPayload",targetUser:{__typename:"User",id:n}}},update:function(e){var t=e.readFragment({id:Object(s.a)(d),fragment:a});t&&(t.blockedUsers.push({id:n,__typename:"User"}),e.writeFragment({id:Object(s.a)(d),fragment:a,data:t}))}})]:[3,2];case 1:return e.sent(),[3,3];case 2:throw new Error("blockUserMutation is not ready");case 3:return[2]}})})}}}})}},CMUD:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Whispers_Tracking_Read"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"whisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"threadID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participants"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whisperPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"receive"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:175}};n.loc.source={body:"query Whispers_Tracking_Read($threadID: ID!) {\ncurrentUser {\nid\nlogin\n}\nwhisperThread(id: $threadID) {\nid\nparticipants {\nid\nlogin\nself {\nwhisperPermissions {\nreceive\n}\n}\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},CbHG:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ChatFilterContextProvider_User"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:69}};n.loc.source={body:"query ChatFilterContextProvider_User {\ncurrentUser {\nid\ncreatedAt\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},"DB+C":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"EmotePicker_EmotePicker_UserSubscriptionProducts"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelOwnerID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"channelOwnerID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"campaignProperties"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileImageURL"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"IntValue",value:"28"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscriptionProducts"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteSetID"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"cumulativeTenure"},name:{kind:"Name",value:"subscriptionTenure"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tenureMethod"},value:{kind:"EnumValue",value:"CUMULATIVE"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"months"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionBenefit"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"platform"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:393}};n.loc.source={body:"query EmotePicker_EmotePicker_UserSubscriptionProducts($channelOwnerID: ID!) {\nuser(id: $channelOwnerID) {\nid\nlogin\ncampaignProperties {\ndomains\n}\ndisplayName\nprofileImageURL(width: 28)\nsubscriptionProducts {\nid\nname\ntier\nurl\nemotes {\nid\nsetID\ntoken\n}\nprice\nemoteSetID\n}\nself {\ncumulativeTenure: subscriptionTenure(tenureMethod: CUMULATIVE) {\nmonths\n}\nsubscriptionBenefit {\nid\nplatform\n}\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},DnOo:function(e,t,n){"use strict";var i=n("mrSG"),r=n("q1tI"),a=n("oJmH"),s=n("/7QA"),o=n("SDEh"),d=n("8EUQ"),c=n("GnwI"),l=n("br9A"),u=n("dEDE"),m=n("vCsY"),p=n("7uM4"),h="subscribe-button__subscribe-tier-button",g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){t.openCheckout(),t.props.handleSubAction({action:l.a.ClickCheckout,checkoutButtonTier:t.props.tierPrice})},t.openCheckout=function(){t.props.isMobileCheckout||s.o.set(d.a.SUB_CHECKOUT__PRODUCT_KEY,t.props.productName)},t}return i.__extends(t,e),t.prototype.render=function(){if(this.props.isSubbedToTier){var e=Object(s.d)("Subscribed","SubTierButton");return r.createElement(u.a,{ariaLabel:e,"data-test-selector":h,disabled:!0,icon:p.b.Star},e)}var t;return t=this.props.isEsportChannel?Object(s.d)("Get the 2019 All-Access Pass Now","SubTierButton"):this.props.customSubscribeNowMessage?this.props.customSubscribeNowMessage:Object(s.d)("Subscribe","SubTierButton"),r.createElement(u.a,i.__assign({ariaLabel:t+" "+this.props.tierPrice,"data-test-selector":h,linkTo:this.props.isMobileCheckout?this.props.url:void 0,onClick:this.handleClick,purchase:this.props.tierPrice},Object(m.a)(this.props),{fullWidth:this.props.fullWidth,targetBlank:!!Object(o.b)()||void 0}),t)},t}(r.Component),f=Object(a.compose)(Object(c.withLatencyTracking)("SubTierButton",{autoReportInteractive:!0}))(g);n.d(t,!1,function(){return h}),n.d(t,"a",function(){return f})},Epr8:function(e,t,n){},GLn2:function(e,t,n){},GOKC:function(e,t,n){},Gu45:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Thread_RevokeWhisperAccess"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateWhisperThreadInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateWhisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thread"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participants"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whisperPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"receive"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:187}};n.loc.source={body:"mutation Thread_RevokeWhisperAccess($input: UpdateWhisperThreadInput!) {\nupdateWhisperThread(input: $input) {\nthread {\nid\nparticipants {\nid\nself {\nwhisperPermissions {\nreceive\n}\n}\n}\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},GzyO:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"d",function(){return m}),n.d(t,"e",function(){return p});var i=n("mrSG"),r=n("/7QA"),a=n("OpME"),s="twilight.emote_picker_history",o=24,d=[{id:"64138",token:"SeemsGood"},{id:"41",token:"Kreygasm"},{id:"245",token:"ResidentSleeper"},{id:"28087",token:"WutFace"},{id:"86",token:"BibleThump"},{id:"9",token:"<3"},{id:"58765",token:"NotLikeThis"},{id:"81274",token:"VoHiYo"},{id:"88",token:"PogChamp"},{id:"425618",token:"LUL"},{id:"25",token:"Kappa"},{id:"30259",token:"HeyGuys"}];function c(e){var t=h(),n=t[e.id];n?(n.uses++,n.lastUpdatedAt=Date.now()):t[e.id]={emote:e,lastUpdatedAt:Date.now(),uses:1},r.n.set(s,t)}function l(){var e=h();if(!(Object.keys(e).length>=o)){for(var t={},n=0;n<d.length;n++){var a=d[n];e[a.id]||(t[a.id]={emote:a,lastUpdatedAt:n,uses:0})}var c=i.__assign({},t,e);r.n.set(s,c)}}function u(){return Object(a.b)(d)}function m(e){var t=h(),n=[],i=!1;return Object.keys(t).forEach(function(r){var a=t[r];if(void 0!==a&&void 0!==e[a.emote.token]){var s=e[a.emote.token].id;s!==r&&(a.emote.id=s,t[s]=a,delete t[s],i=!0),n.push(a)}}),i&&r.n.set(s,t),n.sort(function(e,t){return e.uses>t.uses?-1:t.uses>e.uses?1:e.lastUpdatedAt>t.lastUpdatedAt?-1:t.lastUpdatedAt>e.lastUpdatedAt?1:0}),Object(a.b)(n.slice(0,24).map(function(e){return e.emote}))}function p(){var e=h(),t={};return Object.keys(e).forEach(function(n){void 0!==e[n]&&(t[e[n].emote.token]={count:e[n].uses})}),t}function h(){var e=r.n.get(s,{})||{};return e.undefined&&(delete e.undefined,r.n.set(s,e)),e}},HfAM:function(e,t,n){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"subProduct"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SubscriptionProduct"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"priceInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"subscriptionProductPriceInfo"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interval"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"cumulativeTenure"},name:{kind:"Name",value:"subscriptionTenure"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tenureMethod"},value:{kind:"EnumValue",value:"CUMULATIVE"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"months"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"benefit"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tier"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"owner"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscriptionProducts"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"stream"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:469}};i.loc.source={body:'#import "twilight/features/subscribe-button/models/subscription-product-price-info.gql"\nfragment subProduct on SubscriptionProduct {\nid\nurl\nprice\npriceInfo {\n...subscriptionProductPriceInfo\n}\nname\ntier\ninterval {\nunit\n}\nstate\nemotes {\nid\nsetID\ntoken\n}\nself {\ncumulativeTenure: subscriptionTenure(tenureMethod: CUMULATIVE) {\nmonths\n}\nbenefit {\nid\ntier\n}\n}\nowner {\nid\ndisplayName\nlogin\nsubscriptionProducts {\nid\ntier\nurl\nprice\nemotes {\nid\ntoken\n}\n}\nstream {\nid\ntype\n}\n}\n}',name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};i.definitions=i.definitions.concat(n("35qb").definitions.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!r[t]&&(r[t]=!0,!0)})),e.exports=i},J45U:function(e,t,n){},JGCS:function(e,t,n){},Jpf8:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Whispers_Thread_WhisperThread"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"Cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userLastMessageRead"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participants"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"chatColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileImageURL"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"IntValue",value:"70"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayBadges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"imageURL"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"whisperPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"receive"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isStrangerBlocked"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"spamInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lastMarkedNotSpamAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"likelihood"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"isMuted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isArchived"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"messages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"IntValue",value:"20"}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonce"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"editedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deletedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unreadMessagesCount"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"chatColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileImageURL"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"IntValue",value:"70"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayBadges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"imageURL"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"blockedUsers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:789}};n.loc.source={body:"query Whispers_Thread_WhisperThread($id: ID! $cursor: Cursor) {\nwhisperThread(id: $id) {\nid\nuserLastMessageRead {\nid\nsentAt\n__typename\n}\nparticipants {\nid\nchatColor\ndisplayName\nprofileImageURL(width: 70)\nlogin\ndisplayBadges {\nid\ntitle\nimageURL\n}\nself {\nwhisperPermissions {\nreceive\nisStrangerBlocked\n}\n}\n__typename\n}\nspamInfo {\nlastMarkedNotSpamAt\nlikelihood\n__typename\n}\nisMuted\nisArchived\nmessages(first: 20 after: $cursor) {\nedges {\ncursor\nnode {\nid\nnonce\ncontent {\ncontent\nemotes {\nid\nemoteID\nsetID\nfrom\nto\n__typename\n}\n__typename\n}\nfrom {\nid\n__typename\n}\nsentAt\neditedAt\ndeletedAt\n__typename\n}\n__typename\n}\n__typename\n}\n__typename\nunreadMessagesCount\n}\ncurrentUser {\nid\nchatColor\ndisplayName\nprofileImageURL(width: 70)\nlogin\ndisplayBadges {\nid\ntitle\nimageURL\n}\nblockedUsers {\nid\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},JzSO:function(e,t,n){},Kae6:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("pVnL"),r=n.n(i),a=n("q1tI"),s=n("fNzW"),o=n("vCsY"),d=n("hnjF"),c=n("X2PJ"),l=n("2nDl"),u=(n("VFp6"),function(e){var t,n={"tw-textarea":!0,"tw-textarea--no-resize":e.noResize,"tw-textarea--error":e.error};e.tabIndex&&(t=e.tabIndex);var i=l.c.Default;e.size&&(i=e.size);var u={paddingRight:e.paddingRight?e.paddingRight/10+"rem":void 0};return a.createElement(c.e,{display:d.d.Block,borderRadius:c.b.Medium,overflow:e.overflow,fontSize:l.b[i],fullWidth:!0},a.createElement("textarea",r()({className:Object(s.a)(n),autoFocus:e.autoFocus,cols:e.cols,disabled:e.disabled,id:e.id,maxLength:e.maxLength,name:e.name,onBlur:e.onBlur,onChange:e.onChange,onFocus:e.onFocus,onKeyDown:e.onKeyDown,style:u,placeholder:e.placeholder,rows:e.rows,tabIndex:t,value:e.value,defaultValue:e.defaultValue,ref:e.refDelegate,readOnly:e.readOnly},Object(o.a)(e))))});u.displayName="TextArea",u.displayName="TextArea"},KriR:function(e,t,n){"use strict";n.d(t,"h",function(){return s}),n.d(t,"g",function(){return i}),n.d(t,"d",function(){return m}),n.d(t,"f",function(){return o}),n.d(t,"e",function(){return d}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l}),n.d(t,"c",function(){return u});var i,r=n("/7QA"),a=n("2xye");function s(e){var t={channel:e.channelLogin,channel_id:e.channelId,payment_type:e.paymentType,payment_flow:e.paymentFlow,quantity:e.quantity,action:e.action,action_detail:e.actionDetail,product_id:e.productId,ticket_price:e.ticketPrice,currency:e.currency,saved_payment:e.savedPayment,is_anonymous:e.isAnonymous,checkout_source:e.trackingContext.source};e.trackingContext.detail&&(t.checkout_source_detail=e.trackingContext.detail),r.p.track(a.SpadeEventType.PaymentFormInteraction,t)}!function(e){e.SPM="spm",e.RecurlyCreditCard="recurlyCreditCard"}(i||(i={}));var o,d,c,l,u,m=function(){function e(e){this.store={savedPaymentAvailable:null,savedPaymentDisplayed:null,recurlyCreditCardAvailable:null,details:null},this.counter=0,this.config={allowDuplicateEvents:!(!e||!e.allowDuplicateEvents)},this.readyFields={spm:!1,recurlyCreditCard:!1}}return e.prototype.get=function(e){return this.store[e]},e.prototype.set=function(e){this.store=Object.assign(this.store,e)},e.prototype.setReady=function(e){this.readyFields[e]=!0},e.prototype.reportEvent=function(){var e,t;this.allFieldsReady&&(0===this.counter||this.config.allowDuplicateEvents)&&(this.counter++,e=this.store,t={saved_payment_available:e.savedPaymentAvailable,saved_payment_displayed:e.savedPaymentDisplayed,recurly_credit_card_available:e.recurlyCreditCardAvailable,details:e.details||""},r.p.track(a.SpadeEventType.PaymentFormDisplay,t))},Object.defineProperty(e.prototype,"allFieldsReady",{get:function(){return Object.values(this.readyFields).reduce(function(e,t){return e&&t})},enumerable:!0,configurable:!0}),e}();!function(e){e.Failed="failed",e.Pending="pending",e.Success="success"}(o||(o={})),function(e){e.MysteryGifting="mystery_gifting",e.Gifting="gifting",e.Personal="personal"}(d||(d={})),function(e){e.RecurlyCreditCard="recurly_credit_card",e.RecurlyPaypal="recurly_paypal",e.RecurlyPayWithAmazon="recurly_pay_with_amazon",e.ZuoraCreditCard="zuora_credit_card",e.Xsolla="xsolla"}(c||(c={})),function(e){e.VendorLoginClick="vendor_login_click",e.CompletePurchaseClick="complete_purchase_click",e.PaypalTokenError="paypal_token_error",e.RadioButtonClick="radio_button_click",e.TokenError="token_error",e.PriceChangeAlert="price_change_alert",e.UnsupportedCountryAlert="unsupported_country_alert"}(l||(l={})),function(e){e.ChannelSubscribeButton="channel_subscribe_button_click",e.Direct="direct_url_link",e.EmotePicker="emote_picker_click",e.Extension="extension_click",e.SubscriptionsManagement="subscriptions_management",e.TurboSubscribeButton="turbo_subscribe_button_click",e.ViewerCard="viewer_card_click"}(u||(u={}))},MJbm:function(e,t,n){"use strict";var i=n("mrSG"),r=n("q1tI"),a=n("/7QA"),s=(n("efEE"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.logger=a.q.logger.withCategory("resize-detector"),t.onScroll=function(){var e=t.container,n=e.offsetWidth,i=e.offsetHeight,r=e.offsetLeft,a=e.offsetTop;t.logger.debug("Resize Detector -- onScroll"),n===t.width&&i===t.height&&a===t.top&&r===t.left||(t.width=n,t.height=i,t.props.onResize(n,i,a,r)),t.reset()},t.setGrowDivRef=function(e){return t.growDiv=e},t.setGrowChildDivRef=function(e){return t.growChildDiv=e},t.setShrinkDivRef=function(e){return t.shrinkDiv=e},t}return i.__extends(t,e),t.prototype.render=function(){return r.createElement("div",{className:"resize-detector"},r.createElement("div",{className:"resize-detector",ref:this.setGrowDivRef},r.createElement("div",{className:"resize-detector__grow",ref:this.setGrowChildDivRef})),r.createElement("div",{className:"resize-detector",ref:this.setShrinkDivRef},r.createElement("div",{className:"resize-detector__shrink"})))},t.prototype.componentDidMount=function(){if(this.growDiv){this.growDiv.parentElement||this.logger.warn("growDiv.parentElement is undefined!"),this.container=this.growDiv.parentElement.parentElement;var e=this.container.style.position;if("relative"!==e&&"absolute"!==e&&"fixed"!==e){var t=window.getComputedStyle(this.container);t&&"static"===t.getPropertyValue("position")&&(this.container.style.position="relative")}this.onScroll(),this.growDiv.addEventListener("scroll",this.onScroll),this.shrinkDiv.addEventListener("scroll",this.onScroll)}else this.logger.warn("growDiv is undefined!")},t.prototype.componentWillUnmount=function(){this.growDiv.removeEventListener("scroll",this.onScroll),this.shrinkDiv.removeEventListener("scroll",this.onScroll)},t.prototype.reset=function(){var e=this.growDiv,t=this.shrinkDiv,n=this.growChildDiv.style;n.width="100000px",n.height="100000px",e.scrollLeft=1e5,e.scrollTop=1e5,t.scrollLeft=1e5,t.scrollTop=1e5},t}(r.Component));n.d(t,"a",function(){return s})},Mj6i:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("mrSG"),r=n("yR8l"),a=n("0FG4"),s=n("S4w9");function o(){return Object(r.a)(s,{options:function(e){return{variables:{withOwner:!0}}},props:function(e){if(e.data){var t=e.data.currentUser&&e.data.currentUser.emoteSets||[],n=t&&Object(a.b)(t);return{emoteSetsData:i.__assign({},e.data,{currentUser:e.data.currentUser||null,emoteMap:n,emoteSets:t})}}return{}},skip:function(e){return!e.isLoggedIn}})}},N6NX:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Threads_MarkAllWhispersAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateAllWhisperThreadsInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAllWhisperThreads"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:130}};n.loc.source={body:"mutation Threads_MarkAllWhispersAsRead($input: UpdateAllWhisperThreadsInput!) {\nupdateAllWhisperThreads(input: $input) {\ncount\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},NKxy:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"WhisperThread_SetThreadSpamStatus"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateWhisperThreadInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateWhisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thread"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"spamInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lastMarkedNotSpamAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"likelihood"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:178}};n.loc.source={body:"mutation WhisperThread_SetThreadSpamStatus($input: UpdateWhisperThreadInput!) {\nupdateWhisperThread(input: $input) {\nthread {\nid\nspamInfo {\nlastMarkedNotSpamAt\nlikelihood\n}\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},OpME:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"a",function(){return m}),n.d(t,"e",function(){return p}),n.d(t,"d",function(){return h});var i=n("mrSG"),r=n("lZdE"),a=n("cpJf"),s={"B-?\\)":"B)","\\:-?[z|Z|\\|]":":|","\\:-?\\)":":)","\\:-?\\(":":(","\\:-?(p|P)":":P","\\;-?(p|P)":";P","\\:-?[\\\\/]":":/","\\;-?\\)":";)","R-?\\)":"R)",":>":":>","\\:\\&gt\\;":":>","[oO](_|\\.)[oO]":"O_o","\\:-?D":":D","\\:-?(o|O)":":O",">\\\\(":">(",":-?(?:7|L)":":7","\\:-?(S|s)":":S","#-?[\\\\/]":"#/","<\\]":"<]","<3":"<3","\\&lt\\;3":"<3","\\&lt\\;\\]":"<]","\\&gt\\;\\(":">("},o=["1.0","2.0","3.0"],d=new Set([457,33,42,0]);function c(e){for(var t=[],n=function(e){if(!e||null===e.id||null===e.token)return"continue";var n=s[e.token]||e.token,r=o.reduce(function(t,n){var i=t;return i&&(i=i.concat(", ")),i.concat("https://static-cdn.jtvnw.net/emoticons/v1/"+e.id+"/"+n+" "+n+"x")},"");t.push(i.__assign({},e,{displayName:n,srcSet:r}))},r=0,a=e;r<a.length;r++){n(a[r])}return t}function l(e){return e.filter(function(e){return!!e&&!!e.id&&!!e.token}).sort(function(e,t){return parseInt(e.id,10)-parseInt(t.id,10)})}function u(e){for(var t=[],n=0,i=e;n<i.length;n++){var r=i[n];if(r&&r.id&&r.emotes){for(var a={id:r.id,emotes:[]},s=0,o=r.emotes;s<o.length;s++){var d=o[s];d&&d.id&&d.token&&a.emotes.push(d)}t.push(a)}}return t}function m(e){for(var t=[],n=[],i=0,r=e;i<r.length;i++){var a=r[i];if(a&&a.id&&a.emotes){var s={id:a.id,emotes:c(l(a.emotes))};a.owner&&(s.owner=a.owner),d.has(parseInt(a.id,10))?t.push(s):n.push(s)}}return n.concat(t)}var p=function(e,t,n){var i=n||a.c,s=[],o=[],d=[],c=new RegExp("^"+Object(r.a)(t),"i");return e.forEach(function(e){i[e.token]?d.push(e):e.token.match(c)?s.push(e):o.push(e)}),s.sort(function(e,t){return e.token<t.token?-1:e.token>t.token?1:0}),o.sort(function(e,t){return e.token<t.token?-1:e.token>t.token?1:0}),d.sort(function(e,t){return i[t.token].count-i[e.token].count}),d.concat(s).concat(o)},h=function(e){var t={};return e.filter(function(e){return!t.hasOwnProperty(e.token)&&(t[e.token]=!0)})}},P5MF:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Core_Services_Spade_EmoteCard_User"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"channelID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasPrime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canPrimeSubscribe"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscriptionBenefit"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"purchasedWithPrime"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:176}};n.loc.source={body:"query Core_Services_Spade_EmoteCard_User($channelID: ID!) {\nuser(id: $channelID) {\nid\nhasPrime\nself {\ncanPrimeSubscribe\nsubscriptionBenefit {\nid\ntier\npurchasedWithPrime\n}\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},P6kH:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return c});var i,r=n("/7QA"),a=n("DMoW"),s="owl2019_emote_ids",o="OverwatchLeague",d="137512364";function c(e){return e.emote.subscriptionProduct?"12658"===e.emote.subscriptionProduct.id?i.Prime:"324"===e.emote.subscriptionProduct.id?i.Turbo:(t=e.emote.id,r.b.get(s,[]).includes(t)?i.OWL2019:e.emote.subscriptionProduct.owner&&e.emote.subscriptionProduct.owner.id?"139075904"===e.emote.subscriptionProduct.owner.id||e.emote.subscriptionProduct.state===a.jb.INACTIVE?i.LimitedTime:i.Subscription:i.Unavailable):i.Global;var t}!function(e){e[e.Unknown=0]="Unknown",e[e.Prime=1]="Prime",e[e.Turbo=2]="Turbo",e[e.OWL2019=3]="OWL2019",e[e.LimitedTime=4]="LimitedTime",e[e.Unavailable=5]="Unavailable",e[e.Subscription=6]="Subscription",e[e.Global=7]="Global"}(i||(i={}))},"PRj+":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Whispers_Whispers_UserWhisperThreads"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"Cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"whisperThreads"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"IntValue",value:"10"}},{kind:"Argument",name:{kind:"Name",value:"after"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participants"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"chatColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileImageURL"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"IntValue",value:"70"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"spamInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lastMarkedNotSpamAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"likelihood"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"messages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"IntValue",value:"20"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonce"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"editedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deletedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"userLastMessageRead"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"isMuted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isArchived"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unreadMessagesCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:639}};n.loc.source={body:"query Whispers_Whispers_UserWhisperThreads($cursor: Cursor) {\ncurrentUser {\nid\nlogin\nwhisperThreads(first: 10 after: $cursor) {\nedges {\ncursor\nnode {\nid\nparticipants {\nid\nchatColor\ndisplayName\nprofileImageURL(width: 70)\nlogin\n__typename\n}\nspamInfo {\nlastMarkedNotSpamAt\nlikelihood\n__typename\n}\nmessages(first: 20) {\nedges {\ncursor\nnode {\nid\nnonce\nsentAt\neditedAt\ndeletedAt\nfrom {\nid\n__typename\n}\ncontent {\ncontent\nemotes {\nid\nemoteID\nsetID\nfrom\nto\n__typename\n}\n__typename\n}\n__typename\n}\n__typename\n}\n__typename\n}\nuserLastMessageRead {\nid\nsentAt\n__typename\n}\nisMuted\nisArchived\nunreadMessagesCount\n__typename\n}\n__typename\n}\n__typename\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},PrJw:function(e,t,n){"use strict";var i=n("vGFN");n.d(t,"a",function(){return i.b}),n.d(t,"b",function(){return i.c}),n.d(t,"c",function(){return i.d}),n.d(t,"d",function(){return i.e}),n.d(t,"e",function(){return i.f}),n.d(t,"f",function(){return i.g}),n.d(t,"g",function(){return i.h}),n.d(t,"h",function(){return i.i}),n.d(t,"i",function(){return i.j}),n.d(t,"j",function(){return i.k}),n.d(t,"k",function(){return i.m}),n.d(t,"l",function(){return i.p}),n.d(t,"m",function(){return i.q})},RuiO:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Core_Services_Spade_SubEvent_User"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"withVideo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"videoID"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"channelID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canPrimeSubscribe"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscriptionBenefit"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"purchasedWithPrime"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"video"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"videoID"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"withVideo"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"broadcastType"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:266}};n.loc.source={body:"query Core_Services_Spade_SubEvent_User($channelID: ID! $withVideo: Boolean! $videoID: ID) {\nuser(id: $channelID) {\nid\nself {\ncanPrimeSubscribe\nsubscriptionBenefit {\nid\ntier\npurchasedWithPrime\n}\n}\n}\nvideo(id: $videoID) @include(if: $withVideo) {\nid\nbroadcastType\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},S4w9:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"UserEmotes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"withOwner"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteSets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"owner"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"withOwner"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileImageURL"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"IntValue",value:"28"}}],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:188}};n.loc.source={body:"query UserEmotes ($withOwner: Boolean!) {\ncurrentUser {\nid\nemoteSets {\nid\nemotes {\nid\nsetID\ntoken\n}\nowner @include(if: $withOwner) {\nid\nlogin\ndisplayName\nprofileImageURL(width: 28)\n}\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},SceP:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ClipsChatCard_Clip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"slug"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"clip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"slug"},value:{kind:"Variable",name:{kind:"Name",value:"slug"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"thumbnailURL"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"curator"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"broadcaster"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:151}};n.loc.source={body:"query ClipsChatCard_Clip($slug: ID!) {\nclip(slug: $slug) {\nid\nthumbnailURL\ntitle\nslug\nurl\ncurator {\nid\ndisplayName\n}\nbroadcaster {\nid\ndisplayName\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},TOso:function(e,t,n){"use strict";var i=n("mrSG"),r=n("/7QA"),a=n("cMjZ"),s=n("geRD"),o=n("f00E"),d=n("DMoW"),c=n("U1yz"),l=n("xXlL"),u=n("a1OF");var m,p=n("3YIm"),h=n("NMMG"),g=n("Vl9+");function f(e){var t=e.currentUserID,n=e.emotes,m=e.message,f=e.recipientUserID;if(""===t||""===m||""===f)return Promise.reject(new Error("Tried to send a whisper with nonsensical parameters."));var k=Object(o.b)(),v=i.__assign({mutation:p},Object(s.a)({message:m,nonce:k,recipientUserID:f})),b=Object(h.a)(t,f),y=Object(c.a)(r.q.apollo.client.cache,b,!0);if(y&&y.messages){var S=function(e,t){for(var n=[],i=/\S+/g,r=i.exec(e);r;){var a=r[0],s=t[a];if(s){var o=Object(u.c)(e.slice(0,r.index)),d=o?o.length:r.index;n.push({id:s.id,start:d,end:d+a.length-1})}r=i.exec(e)}return n}(m,n).map(l.a);v.optimisticResponse={sendWhisper:{__typename:"SendWhisperPayload",message:{content:{content:m,emotes:S,__typename:"MessageBody"},from:{id:t,__typename:"User"},id:k,nonce:k,sentAt:(new Date).toISOString(),deletedAt:null,editedAt:null,thread:{id:b,__typename:"WhisperThread",participants:[{id:t,__typename:"User",self:{__typename:"UserSelfConnection",whisperPermissions:{receive:d.xb.NOT_PERMITTED,__typename:"WhisperPermissions"}}},{id:f,__typename:"User",self:{__typename:"UserSelfConnection",whisperPermissions:{receive:d.xb.PERMITTED,__typename:"WhisperPermissions"}}}]},__typename:"WhisperMessage"},error:null}},v.update=function(e,t){if(t.data){var n=t.data;if(n.sendWhisper.message&&!n.sendWhisper.error){var r=n.sendWhisper.message,s=Object(c.a)(e,b);if(s&&s.messages){var o=s.messages.edges.findIndex(function(e){return e.node.id===k||e.node.nonce===k||e.node.id===r.id});if(o<0){var d={cursor:(1+y.messages.edges.reduce(function(e,t){return Math.max(parseInt(t.cursor,10),e)},0)).toString(),node:r,__typename:"WhisperMessageEdge"};s.messages.edges.unshift(d)}else s.messages.edges[o].node=r;s.userLastMessageRead&&(s.userLastMessageRead.sentAt=r.sentAt),s.unreadMessagesCount=0,e.writeFragment({id:Object(a.a)(s),fragment:g,data:i.__assign({},s)})}}}}}return r.q.apollo.client.mutate(v)}n.d(t,"a",function(){return m}),n.d(t,"b",function(){return f}),function(e){e.TargetBanned="TARGET_BANNED",e.BodyEmpty="BODY_EMPTY",e.RestrictedRecipient="TARGET_RESTRICTED",e.NotDelivered="NOT_DELIVERED"}(m||(m={}))},TvOw:function(e,t,n){"use strict";var i,r;n.d(t,"b",function(){return i}),n.d(t,"a",function(){return r}),function(e){e.Spam="Spam",e.Harassment="Harassment"}(i||(i={})),function(e){e.Spam="spam",e.Harassment="harassment",e.Other="other"}(r||(r={}))},Tznh:function(e,t,n){"use strict";var i,r,a,s=n("mrSG"),o=n("q1tI"),d=n("/MKj"),c=n("fvjX"),l=n("/7QA"),u=n("yR8l"),m=n("D7An"),p=n("kRBY"),h=n("1rIY"),g=n("+pBb"),f=n("CbHG");!function(e){e.Excluded="control",e.OptIn="opt-in",e.OptOut="opt-out"}(r||(r={})),function(e){e.FilteredMessage="chat_filter_message",e.Onboarding="onboarding",e.Other="other"}(a||(a={}));var k=(i=Object(h.a)("ChatFilterContext",{chatFilterExperimentMembership:r.Excluded,chatFilterSettingsSource:a.Other,isShowingChatFilterSettings:!1,hideChatFilterSettings:function(){return null},showChatFilterSettings:function(){return null}})).InnerProvider,v=i.withContext,b=function(e){function t(t){var n=e.call(this,t)||this;return n.hideChatFilterSettings=function(){n.setState({isShowingChatFilterSettings:!1})},n.showChatFilterSettings=function(e){n.setState({chatFilterSettingsSource:e||a.Other,isShowingChatFilterSettings:!0})},n.state={chatFilterExperimentMembership:r.Excluded,chatFilterSettingsSource:a.Other,isShowingChatFilterSettings:!1,hideChatFilterSettings:n.hideChatFilterSettings,showChatFilterSettings:n.showChatFilterSettings},n}return s.__extends(t,e),t.prototype.componentDidMount=function(){this.updateStateWithProps(this.props)},t.prototype.componentWillReceiveProps=function(e){this.updateStateWithProps(e)},t.prototype.render=function(){return o.createElement(k,{value:this.state},this.props.children)},t.prototype.updateStateWithProps=function(e){switch(this.getExperimentMembership(e)){case r.OptIn:this.setOptInState(e);break;case r.OptOut:this.setOptOutState(e);break;case r.Excluded:default:this.setExcludedState()}},t.prototype.getExperimentMembership=function(e){if("off"===l.b.get("chat_filter_enabled","off"))return r.Excluded;if(!e.isLoggedIn||"en"!==e.languageCode)return r.Excluded;if(e.data&&e.data.currentUser&&e.data.currentUser.createdAt){var t=l.b.get("chat_filter_start","3000-01-01"),n=new Date(e.data.currentUser.createdAt)>=new Date(t)?m.b.ChatFiltersNewUsers:m.b.ChatFiltersExistingUsers,i=l.q.experiments.getAndTrackAssignment(n);switch(i){case r.Excluded:case r.OptIn:case r.OptOut:return i;default:return r.Excluded}}return r.Excluded},t.prototype.setExcludedState=function(){this.setState({chatFilterExperimentMembership:r.Excluded})},t.prototype.setOptInState=function(e){this.setState({chatFilterExperimentMembership:r.OptIn}),void 0===e.viewerChatFilterEnabled&&this.props.disableViewerChatFilter(a.Other)},t.prototype.setOptOutState=function(e){this.setState({chatFilterExperimentMembership:r.OptOut}),void 0===e.viewerChatFilterEnabled&&this.props.enableViewerChatFilter(a.Other)},t}(o.Component);var y=Object(c.compose)(Object(d.connect)(function(e){return{isLoggedIn:Object(p.f)(e),languageCode:Object(p.b)(e),viewerChatFilterEnabled:e.chat.viewerChatFilterEnabled}},function(e){return Object(c.bindActionCreators)({disableViewerChatFilter:g.G,enableViewerChatFilter:g.L},e)}),Object(u.a)(f,{skip:function(e){return!e.isLoggedIn||"en"!==e.languageCode}}))(b);n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,!1,function(){return k}),n.d(t,"d",function(){return v}),n.d(t,!1,function(){return b}),n.d(t,"a",function(){return y})},U1yz:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("2Dht");function r(e,t,n){try{var r=e.readQuery({query:i,variables:{id:t}},n);return r?r.whisperThread:null}catch(e){return null}}},UUau:function(e,t,n){},VFp6:function(e,t,n){},VN3V:function(e,t,n){},"Vl9+":function(e,t){var n={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"thread"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WhisperThread"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messages"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"IntValue",value:"20"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cursor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"nonce"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emoteID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"setID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"to"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"deletedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"editedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"unreadMessagesCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"userLastMessageRead"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sentAt"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:240}};n.loc.source={body:"fragment thread on WhisperThread {\nmessages(first: 20) {\nedges {\ncursor\nnode {\nid\nnonce\ncontent {\ncontent\nemotes {\nid\nemoteID\nsetID\nfrom\nto\n}\n}\ndeletedAt\neditedAt\nsentAt\nfrom {\nid\n}\n}\n}\n}\nunreadMessagesCount\nuserLastMessageRead {\nsentAt\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},VrOd:function(e,t,n){},W8Fi:function(e,t,n){"use strict";function i(e){return e.some(function(e){return!!e.self&&!!e.self.promotion})}function r(e){return e.some(function(e){return!!e.giftPromotion})}function a(e){return e.some(function(e){return!!e.self&&!!e.self.paidUpgradePromotion})}function s(e,t){var n;return t?n=e.giftPromotion:e.self&&(n=e.self.promotion),n?n.newPrice:e.price}function o(e,t){var n;return t?n=e.giftPromotion:e.self&&(n=e.self.promotion),n?parseInt(n.discountValue,10):0}function d(e){return e.self&&e.self.paidUpgradePromotion?e.self.paidUpgradePromotion.newPrice:e.price}function c(e){return e.find(function(e){return!!e.self&&!!e.self.paidUpgradePromotion})||null}n.d(t,"g",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return d}),n.d(t,"b",function(){return c})},WcC5:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Thread_ArchiveThread"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateWhisperThreadInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateWhisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thread"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isArchived"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:132}};n.loc.source={body:"mutation Thread_ArchiveThread($input: UpdateWhisperThreadInput!) {\nupdateWhisperThread(input: $input) {\nthread {\nid\nisArchived\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},Wcon:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Whispers_MarkThreadMessageRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateWhisperThreadInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateWhisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thread"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unreadMessagesCount"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:151}};n.loc.source={body:"mutation Whispers_MarkThreadMessageRead($input: UpdateWhisperThreadInput!) {\nupdateWhisperThread(input: $input) {\nthread {\nid\nunreadMessagesCount\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},XQnt:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"EmotePicker_SubUpsell_PriceInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"channelID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscriptionProducts"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"emotes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"priceInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currency"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"exponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"price"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isTaxInclusive"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tax"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"emoteSetID"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"self"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"promotion"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newPrice"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"oldPrice"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"discountType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"discountValue"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"paidUpgradePromotion"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"newPrice"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"oldPrice"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"discountType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"discountValue"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:393}};n.loc.source={body:"query EmotePicker_SubUpsell_PriceInfo($channelID: ID!) {\nuser(id: $channelID) {\nid\nsubscriptionProducts {\nid\ndisplayName\nname\ntier\nurl\nemotes {\nid\ntoken\n}\nprice\npriceInfo {\ncurrency\nexponent\ntotal\ndescription\nprice\nisTaxInclusive\nid\ntax\n}\nemoteSetID\nself {\npromotion {\nnewPrice\noldPrice\ndiscountType\ndiscountValue\n}\npaidUpgradePromotion {\nnewPrice\noldPrice\ndiscountType\ndiscountValue\n}\n}\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},XRPh:function(e,t,n){"use strict";var i=n("oJmH"),r=n("/MKj"),a=n("kRBY"),s=n("fezU"),o=n("mrSG"),d=n("q1tI"),c=n("/7QA"),l=n("D7An"),u=n("j0ar"),m="emote_card",p="emote_card_whitelist";var h=n("oK83"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.emoteClickHandler=function(e){t.props.emote.emoteID&&t.props.onEmoteClick({channelID:t.props.channelID||"",channelLogin:t.props.channelLogin||"",emoteID:t.props.emote.emoteID,emoteCode:t.props.emote.alt||"",sourceID:t.props.sourceID||"",emoteSourceType:t.props.sourceType?t.props.sourceType:h.a.unknown,referrerID:t.props.referrerID||"",initialTopOffset:e.currentTarget.getBoundingClientRect().bottom})},t}return o.__extends(t,e),t.prototype.render=function(){var e,t,n=this.props.emote.alt||"";return this.props.emote.cheerAmount&&(n+=" "+this.props.emote.cheerAmount.toString(),e=d.createElement("strong",{className:"chat-line__message--cheer-amount",style:{color:this.props.emote.cheerColor}},this.props.emote.cheerAmount)),t=d.createElement(u.a,{alt:n,cheerText:e,className:"chat-line__message--emote",srcKey:"1x",srcSet:this.props.emote.images}),this.props.emote.cheerAmount||this.props.disableCard||!function(e){var t=c.b.get(m,"off");if("on"===t)return!0;if("staff"===t&&e&&e.roles&&e.roles.isStaff)return!0;var n=c.b.get(p,[]);return!!("whitelist"===t&&e&&e.id&&n.includes(e.id))}(this.props.user)||"treatment"!==c.q.experiments.getAndTrackAssignment(l.b.EmoteCard)?t:d.createElement("div",{onClick:this.emoteClickHandler,className:"chat-line__message--emote-button","data-test-selector":"emote-button"},t)},t}(d.Component);var f=Object(i.compose)(Object(r.connect)(function(e){return{user:Object(a.e)(e)}}),Object(s.b)(function(e){return{onEmoteClick:e.onShowEmoteCard}}))(g);f.displayName="Emote",n.d(t,!1,function(){}),n.d(t,"a",function(){return f})},ZtEv:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"e",function(){return a}),n.d(t,"a",function(){return s});var i,r,a,s,o=n("0Log");n.d(t,"d",function(){return o.ModerationActions}),function(e){e[e.Message=0]="Message",e[e.ExtensionMessage=1]="ExtensionMessage",e[e.Moderation=2]="Moderation",e[e.ModerationAction=3]="ModerationAction",e[e.TargetedModerationAction=4]="TargetedModerationAction",e[e.AutoMod=5]="AutoMod",e[e.SubscriberOnlyMode=6]="SubscriberOnlyMode",e[e.FollowerOnlyMode=7]="FollowerOnlyMode",e[e.SlowMode=8]="SlowMode",e[e.EmoteOnlyMode=9]="EmoteOnlyMode",e[e.R9KMode=10]="R9KMode",e[e.Connected=11]="Connected",e[e.Disconnected=12]="Disconnected",e[e.Reconnect=13]="Reconnect",e[e.Hosting=14]="Hosting",e[e.Unhost=15]="Unhost",e[e.Hosted=16]="Hosted",e[e.Subscription=17]="Subscription",e[e.Resubscription=18]="Resubscription",e[e.GiftPaidUpgrade=19]="GiftPaidUpgrade",e[e.AnonGiftPaidUpgrade=20]="AnonGiftPaidUpgrade",e[e.PrimePaidUpgrade=21]="PrimePaidUpgrade",e[e.SubGift=22]="SubGift",e[e.AnonSubGift=23]="AnonSubGift",e[e.Clear=24]="Clear",e[e.RoomMods=25]="RoomMods",e[e.RoomState=26]="RoomState",e[e.Raid=27]="Raid",e[e.Unraid=28]="Unraid",e[e.Ritual=29]="Ritual",e[e.Notice=30]="Notice",e[e.Info=31]="Info",e[e.BadgesUpdated=32]="BadgesUpdated",e[e.Purchase=33]="Purchase",e[e.BitsCharity=34]="BitsCharity",e[e.CrateGift=35]="CrateGift",e[e.RewardGift=36]="RewardGift",e[e.SubMysteryGift=37]="SubMysteryGift",e[e.AnonSubMysteryGift=38]="AnonSubMysteryGift",e[e.FirstCheerMessage=39]="FirstCheerMessage",e[e.BitsBadgeTierMessage=40]="BitsBadgeTierMessage",e[e.InlinePrivateCallout=41]="InlinePrivateCallout"}(i||(i={})),function(e){e[e.Post=0]="Post",e[e.Action=1]="Action",e[e.PostWithMention=2]="PostWithMention"}(r||(r={})),function(e){e[e.Ban=0]="Ban",e[e.Timeout=1]="Timeout",e[e.Delete=2]="Delete"}(a||(a={})),function(e){e[e.MessageRejectedPrompt=0]="MessageRejectedPrompt",e[e.CheerMessageRejectedPrompt=1]="CheerMessageRejectedPrompt",e[e.MessageRejected=2]="MessageRejected",e[e.MessageAllowed=3]="MessageAllowed",e[e.MessageDenied=4]="MessageDenied",e[e.CheerMessageDenied=5]="CheerMessageDenied",e[e.CheerMessageTimeout=6]="CheerMessageTimeout",e[e.MessageModApproved=7]="MessageModApproved",e[e.MessageModDenied=8]="MessageModDenied"}(s||(s={}))},a1OF:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return m}),n.d(t,"e",function(){return p}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return g});var i=n("mrSG"),r=n("/7QA"),a=n("oe5X"),s=n("0FG4"),o=n("kRBY"),d=n("60o1"),c=["#FF0000","#0000FF","#008000","#B22222","#FF7F50","#9ACD32","#FF4500","#2E8B57","#DAA520","#D2691E","#5F9EA0","#1E90FF","#FF69B4","#8A2BE2","#00FF7F"],l={};function u(e,t,n,r,a,s,o){void 0===r&&(r=null),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===o&&(o=!1);var c=Object(d.a)(t.displayName,t.username);return{badges:t.badges||{},badgeDynamicData:t.badgeDynamicData||{},bits:t.bits,user:i.__assign({},c,{userLogin:t.username,userID:t.userID,userType:t.userType,color:t.color||m(t.userID)}),messageParts:p(e,t.emotes||{},t.bits,n,t.username,r||void 0),deleted:a,banned:o,hidden:s,timestamp:Date.now()}}function m(e,t){return void 0===t&&(t=15),"number"!=typeof l[e]&&(l[e]=Math.floor(Math.random()*t)),c[l[e]]}function p(e,t,n,i,d,c){var l=Object(o.e)(r.q.store.getState()),u={cheers:n?i:void 0,emotes:{type:s.a.Position,map:t},links:{parseClips:!0,parseVods:!0},mentions:{senderLogin:d,sessionUser:l},flags:c};return Object(a.a)(e,u)}function h(e){return e.match(/[^\uD800-\uDFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDFFF]/g)}function g(e,t){return"https://static-cdn.jtvnw.net/emoticons/v1/"+e+"/"+Math.min(Math.ceil(t),3)+".0"}},a5fV:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return o});var i=n("/7QA"),r=n("W8Fi");function a(e,t){return e/Math.pow(10,t)}function s(e,t){return Object(i.f)(e,{style:"currency",currency:t})}function o(e,t){return void 0===t&&(t=!1),Object(r.g)([e])||Object(r.e)([e])?Object(r.c)(e,t):e.priceInfo?s(a(e.priceInfo.total,e.priceInfo.exponent),e.priceInfo.currency):e.price}},br9A:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"b",function(){return c});var i=n("mrSG"),r=n("/7QA"),a=n("2xye"),s=n("I6K6"),o=n("RuiO"),d={BuyContinueSub:"buy_continue_sub",BuyCustomMysteryGift:"buy_custom_mystery_gift",BuyGiftSub:"buy_gift_sub",BuyGiftToPaidUpgrade:"buy_gift_to_paid_upgrade",BuyMysteryGift:"buy_mystery_gift",BuyPaidUpgrade:"buy_paid_upgrade",BuyPrimeToPaid:"buy_prime_to_paid",ChangeTier:"change_tier",ClickAnonymousGiftCheckbox:"anonymous_gift_click",ClickBack:"back_top_level",ClickCancelAndRefund:"click_cancel_and_refund",ClickCancelPaidUpgrade:"click_cancel_paid_upgrade",ClickChangePaymentMethod:"click_change_payment_method",ClickChangeSubTier:"click_change_sub_tier",ClickCheckout:"click_checkout_button",ClickDisableGift:"click_disable_gift_button",ClickDNRSub:"click_dnr_sub_button",ClickGiftSubOptions:"gift_options_click",ClickMoreSubOptions:"more_options_click",ClickPaidUpgrade:"click_paid_upgrade",ClickPrimeFAQ:"click_prime_faq",ClickResubscribe:"click_resubscribe",ClickSignupForPrime:"click_signup_for_prime",CloseSubMenu:"close_subscribe_menu",GiftASub:"gift_a_sub",OpenSubMenu:"open_subscribe_menu",SubWithPrime:"samus_spend_credit"};function c(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,d,c,l,u,m,p,h,g,f,k,v;return i.__generator(this,function(i){switch(i.label){case 0:t=r.p.getVideoPlayerTrackingData().vodID,n=!!t,d={channelID:e.channelID,withVideo:!1},n&&(d.withVideo=!0,d.videoID=t),c=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.q.apollo.client.query({query:o,variables:d})];case 2:return c=i.sent(),[3,4];case 3:return l=i.sent(),r.k.warn(l,"Failed to make query for channel info in FollowEvent reporting.",{channelID:e.channelID}),[3,4];case 4:return u=c&&c.data&&c.data.user||null,c&&!u&&r.k.warn("Query for channel info in SubEvent reporting returned no data.",{channelID:e.channelID}),m=null,c&&n&&((p=c&&c.data&&c.data.video)?m=Object(s.a)(p.broadcastType):r.k.warn("Query for video info in SubEvent reporting returned no data.",{currentVideoID:t})),h=u&&u.self,g=h?!!h.subscriptionBenefit:null,f=h&&h.subscriptionBenefit&&h.subscriptionBenefit.purchasedWithPrime||!1,k=h?h.canPrimeSubscribe:null,v={action:e.action,button_cta:e.buttonCTA,can_subscribe:k,channel:e.channelLogin,channel_id:e.channelID,checkout_button_tier:e.checkoutButtonTier,cumulative_tenure_months:e.cumulativeTenureMonths,days_to_next_tenure_anniversary:e.daysToNextTenureAnniversary||null,has_sub_credit:e.hasSubCredit||null,host_channel:e.hostChannelLogin,host_channel_id:e.hostChannelID,is_anonymous:e.isAnonymous,is_menu_open:e.isMenuOpen||null,is_single_month:e.isSingleMonth,is_subscribed:g,is_subscribed_current_tier:h&&h.subscriptionBenefit&&h.subscriptionBenefit.tier,mystery_gift_count:e.mysteryGiftCount||null,sub_location:e.sub_location,sub_recipient:e.giftRecipient||null,modal:e.modal,modal_level:e.modalLevel||"",show_prime_content:e.showPrimeContent||!1,show_resub:u?k&&f:null,streak_number:e.streakNumber||null,vod_id:t,vod_type:m,viewport_height:window.innerHeight,viewport_width:window.innerWidth},r.p.track(a.SpadeEventType.Subscription,v),[2]}})})}},"c/47":function(e,t,n){},cMjZ:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("o4DC");function r(e){return e&&Object(i.c)(e)||""}},cpJf:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),function(e){e.Chat="stream_chat",e.Feeds="feeds",e.Room="chatroom",e.Whisper="whisper",e.VodChat="vod-chat"}(i||(i={}));var r={TriHard:{count:196568036},Kappa:{count:192158118},"4Head":{count:155758710},PogChamp:{count:151485090},cmonBruh:{count:146352878},BibleThump:{count:56472964},WutFace:{count:45069031},Kreygasm:{count:41387580},DansGame:{count:38097659},hi5F:{count:34986404},SMOrc:{count:34734484},KappaPride:{count:34262839},VoHiYo:{count:27886434},SwiftRage:{count:24561900},ResidentSleeper:{count:24438298},EleGiggle:{count:19891526},FailFish:{count:19118343},NotLikeThis:{count:18802905},Keepo:{count:18351415},BabyRage:{count:18220906},MingLee:{count:18026207},pbfSSH:{count:16911241},forsenE:{count:14960299},HeyGuys:{count:14851569},ANELE:{count:14648986},PJSalt:{count:14438861}},a=["354","49106","4339","48","25","55338","70433","1902","68856","81103","76171","27509"]},cr2a:function(e,t,n){},cys1:function(e,t,n){"use strict";var i,r=n("q1tI"),a=n("/7QA"),s=n("gvGA"),o=n("5zf8"),d=n("4rCz"),c=n("x0+1"),l=n("XRPh"),u=function(e){var t=e.displayText,n=e.url;return r.createElement("a",{className:"link-fragment",href:n,target:"_blank",rel:"noreferrer noopener"},t)},m=n("TSYQ"),p=n("RcPG"),h=(n("VN3V"),function(e){var t,n=e.content,i=e.highlightType,a=m("text-fragment",((t={})["text-fragment--moderated-highlight"]=i===p.a.ModeratedText,t));return r.createElement("span",{className:a,"data-a-target":"chat-message-text"},n)}),g=n("mrSG"),f=n("oJmH"),k=n("+GjP"),v=n("2xye"),b=n("L/cU"),y=n("fPaz"),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasImageLoadingError:!1},t.handleImageError=function(){t.setState({hasImageLoadingError:!0})},t}return g.__extends(t,e),t.prototype.componentWillReceiveProps=function(){this.setState({hasImageLoadingError:!1})},t.prototype.render=function(){var e=a.a.defaultStreamPreviewURL;return!this.state.hasImageLoadingError&&this.props.imageURL&&(e=this.props.imageURL),r.createElement(b.a,{aspect:y.c.Aspect16x9,alt:this.props.altText,src:e,onError:this.handleImageError})},t}(r.Component),_=n("hnjF"),C=n("+80q"),E=n("Ws8v"),N=n("X2PJ"),D=n("PL8s"),I=n("sUnt"),T=n("Jsra"),w=(n("Epr8"),"https://static-cdn.jtvnw.net/emoticons/v1/58765/2.0"),F={ERROR:"chat-card-error",TITLE:"chat-card-title",DESCRIPTION:"chat-card-description"},O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderErrorCard=function(){var e=r.createElement("img",{"data-test-selector":F.ERROR,src:w,className:"chat-card__error-img"});return t.renderCardContent(e,t.props.error)},t.renderCardContent=function(e,t){var n,i;return t?(n=r.createElement(C.a,{type:C.e.Span,fontSize:N.d.Size5,"data-test-selector":F.TITLE,title:t.title},t.title),i=r.createElement(C.a,{type:C.e.Span,fontSize:N.d.Size6,color:N.c.Alt2,"data-test-selector":F.DESCRIPTION},t.description)):(e=r.createElement(D.a,{overlay:!0}),n=r.createElement(D.a,{width:180}),i=r.createElement(D.a,{width:120})),r.createElement(E.a,{background:N.a.Base,display:_.d.Flex,flexWrap:_.f.NoWrap,padding:.5},r.createElement(E.a,{className:"chat-card__preview-img",background:N.a.Alt2,display:_.d.Flex,alignItems:_.b.Center,justifyContent:_.h.Center,flexShrink:0},e),r.createElement(I.a,{display:_.d.Flex,alignItems:_.b.Center,overflow:_.i.Hidden},r.createElement(I.a,{padding:{left:1},fullWidth:!0},r.createElement(I.a,{className:"chat-card__title",ellipsis:!0},n),r.createElement(I.a,{ellipsis:!0},i))))},t}return g.__extends(t,e),t.prototype.render=function(){var e;if(this.props.error)e=this.renderErrorCard();else if(this.props.data){var t=Object(k.e)(this.props.data.contentURL,{tt_medium:v.PageviewMedium.Chat,tt_content:v.PageviewContent.ChatCard}),n=r.createElement(S,{altText:this.props.data.title,imageURL:this.props.data.previewImageURL});e=r.createElement(T.a,{className:"chat-card__link",to:t,targetBlank:!0},this.renderCardContent(n,{title:this.props.data.title,description:this.props.data.description}))}else e=this.renderCardContent();return r.createElement(E.a,{elevation:1,margin:{top:.5}},e)},t}(r.Component),M=n("SceP"),U={isTimedOut:!1},x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=U,t.timeoutID=null,t}return g.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.data.clip||(this.timeoutID=setTimeout(function(){e.setState({isTimedOut:!0})},5e3))},t.prototype.componentWillReceiveProps=function(e){!this.props.data.clip&&e.data.clip&&(this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null),this.setState({isTimedOut:!1}))},t.prototype.render=function(){var e=this.props.data,t=e.clip,n=e.error,i=e.loading;return n||this.state.isTimedOut?r.createElement(O,{error:{title:Object(a.d)("Something went wrong","ClipsChatCard"),description:Object(a.d)("We couldn't find that Clip","ClipsChatCard")}}):i||!t?r.createElement(O,null):r.createElement(O,{data:{title:t.title||(t.broadcaster&&t.broadcaster.displayName?Object(a.d)("Clip of {broadcaster}",{broadcaster:t.broadcaster.displayName},"ClipsChatCard"):""),description:t.curator&&t.curator.displayName?Object(a.d)("Clipped by {curator}",{curator:t.curator.displayName},"ClipsChatCard"):"",previewImageURL:t.thumbnailURL,contentURL:t.url}})},t}(r.Component),R=Object(f.graphql)(M,{options:function(e){return{variables:{slug:e.slug},notifyOnNetworkStatusChange:!0,fetchPolicy:e.forceNetworkRequest?"cache-first":"cache-only"}}})(x),A=n("gTu3"),P=(n("lpj/"),(i={})[A.a.Default]="",i[A.a.Recipient]="mention-fragment--recipient",i[A.a.Sender]="mention-fragment--sender",i),j=function(e){var t=e.isAtMention?"@":"",n=m("mention-fragment",P[e.currentUserMentionRelation]);return r.createElement("span",{className:n,"data-a-target":"chat-message-mention"},""+t+e.recipient)};j.displayName="MentionFragment";var L,B=n("yR8l"),W=n("QVaV"),V=n("sU0Q"),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g.__extends(t,e),t.prototype.render=function(){var e=this.props.data,t=e.video,n=e.error;if(e.loading||!t)return r.createElement(O,null);if(n||!t.owner||!t.owner.login||!t.publishedAt||!t.title)return r.createElement(O,{error:{title:Object(a.d)("Something went wrong","VideoChatCard"),description:Object(a.d)("We couldn't find that video","VideoChatCard")}});var i=r.createElement(C.a,null,Object(a.c)(new Date(t.publishedAt),"medium"),r.createElement("span",null," · "),Object(W.a)(t.owner.login,t.owner.displayName));return r.createElement(O,{data:{title:t.title,description:i,previewImageURL:t.previewThumbnailURL,contentURL:this.props.url}})},t}(r.Component),q=Object(B.a)(V,{options:function(e){return{variables:{videoID:e.id},notifyOnNetworkStatusChange:!0,fetchPolicy:"cache-first"}}})(H),G=n("ZtEv"),z=n("u5aL"),Q=n("fvjX"),K=n("Tznh"),Y=n("VJH5"),$=n("dEDE"),J=n("akKH"),X=n("y0tB");!function(e){e.CancelButton="flagged-fragment-cancel",e.ConfirmButton="flagged-fragment-confirm",e.FeedbackButton="flagged-fragment-feedback",e.FeedbackNo="flagged-fragment-no",e.FeedbackYes="flagged-fragment-yes",e.SettingsLink="flagged-fragment-settings",e.Title="flagged-fragment-title"}(L||(L={}));var Z,ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={feedbackSelection:null,textShown:!1},t.hasTrackedImpression=!1,t.showSettings=function(){t.props.showChatFilterSettings(K.c.FilteredMessage)},t.showText=function(){t.props.onShowText(),t.setState({textShown:!0}),a.p.track(v.SpadeEventType.ChatFilterMessageInteraction,t.getCommonTrackingProps())},t.onAffirmativeFeedbackSelected=function(){t.setState({feedbackSelection:!0})},t.onNegativeFeedbackSelected=function(){t.setState({feedbackSelection:!1})},t.onSubmit=function(){t.props.onDismissBalloon(),a.p.track(v.SpadeEventType.ChatFilterFeedbackInteraction,g.__assign({},t.getCommonTrackingProps(),{value:t.state.feedbackSelection?t.getAffirmativeText():t.getNegativeText()}))},t}return g.__extends(t,e),t.prototype.render=function(){var e=this,t=Object(a.d)("Cancel","FlaggedFragmentBalloonContent");return this.state.textShown?r.createElement(I.a,{padding:1},r.createElement(J.a,{label:Object(a.d)("Help improve our filters. Was this message correctly hidden?","FlaggedFragmentBalloonContent")},r.createElement(X.a,{label:this.getAffirmativeText(),name:"flagged-fragment-feedback",onChange:this.onAffirmativeFeedbackSelected,"data-test-selector":L.FeedbackYes}),r.createElement(X.a,{label:this.getNegativeText(),name:"flagged-fragment-feedback",onChange:this.onNegativeFeedbackSelected,"data-test-selector":L.FeedbackNo})),r.createElement(I.a,{display:_.d.Flex,justifyContent:_.h.End},r.createElement(I.a,{margin:{right:1}},r.createElement($.a,{onClick:this.props.onDismissBalloon,type:$.d.Hollow,"data-test-selector":L.CancelButton},t)),r.createElement($.a,{disabled:null===this.state.feedbackSelection,onClick:this.onSubmit,"data-test-selector":L.FeedbackButton},Object(a.d)("Submit","FlaggedFragmentBalloonContent")))):(this.hasTrackedImpression||(a.p.track(v.SpadeEventType.ChatFilterMessageImpression,this.getCommonTrackingProps()),this.hasTrackedImpression=!0),r.createElement(I.a,{padding:1},r.createElement(C.a,{bold:!0,type:C.e.H6,"data-test-selector":L.Title},this.getCategoryTitle()),Object(a.d)("Would you like to see this message? It has been hidden for you based on your <x:link>NSFW Chat Filter settings</x:link>.",{"x:link":function(t){return r.createElement(T.a,{onClick:e.showSettings,"data-test-selector":L.SettingsLink},t)}},"FlaggedFragmentBalloonContent"),r.createElement(I.a,{display:_.d.Flex,justifyContent:_.h.End},r.createElement(I.a,{margin:{right:1}},r.createElement($.a,{onClick:this.props.onDismissBalloon,type:$.d.Hollow,"data-test-selector":L.CancelButton},t)),r.createElement($.a,{onClick:this.showText,"data-test-selector":L.ConfirmButton},Object(a.d)("Show Message","FlaggedFragmentBalloonContent")))))},t.prototype.getCategoryTitle=function(){var e=this.props.messagePart.categories;return 1!==Object.values(e).filter(function(e){return!!e}).length?Object(a.d)("Message Blocked","FlaggedFragmentBalloonContent"):e[Y.a.Aggressive]?Object(a.d)("Hostile Message Blocked","FlaggedFragmentBalloonContent"):e[Y.a.Identity]?Object(a.d)("Discriminatory Message Blocked","FlaggedFragmentBalloonContent"):e[Y.a.Sexual]?Object(a.d)("Sexually Explicit Message Blocked","FlaggedFragmentBalloonContent"):Object(a.d)("Profanity Blocked","FlaggedFragmentBalloonContent")},t.prototype.getAffirmativeText=function(){return Object(a.d)("Yes","FlaggedFragmentBalloonContent")},t.prototype.getNegativeText=function(){return Object(a.d)("No","FlaggedFragmentBalloonContent")},t.prototype.getCommonTrackingProps=function(){var e=this.props.messagePart;return{channel_id:this.props.channelID||"",channel:this.props.channelLogin||"",msg_uuid:this.props.messageID||"",word:e.originalText,aggressive_language_detected:!!e.categories[Y.a.Aggressive],explicit_language_detected:!!e.categories[Y.a.Sexual],identity_language_detected:!!e.categories[Y.a.Identity],profane_language_detected:!!e.categories[Y.a.Profanity]}},t}(r.Component),te=Object(Q.compose)(Object(K.d)(function(e){return e}))(ee),ne=n("ygYM");n("UUau");!function(e){e.Balloon="flagged-fragment-balloon",e.Container="flagged-fragment-container",e.Target="flagged-fragment-span"}(Z||(Z={}));var ie=function(e){function t(t){var n=e.call(this,t)||this;return n.state={active:!1,balloonDirection:ne.b.TopCenter,balloonTailOffset:0,balloonXOffset:0,displayed:!1},n.setTopRef=function(e){n.topRef=e},n.setBalloonContentRef=function(e){n.balloonContentRef=e,n.state.active&&n.setState(g.__assign({},n.getBalloonState()))},n.onClickOut=function(){n.setState({active:!1})},n.onClick=function(){n.setState({active:!0})},n.onShowText=function(){n.setState({displayed:!0},function(){n.setState(g.__assign({},n.getBalloonState()))})},n.onDismissBalloon=function(){n.setState({active:!1})},n.placeholder=new Array(t.messagePart.length+1).join("*"),n}return g.__extends(t,e),t.prototype.render=function(){return this.state.active?r.createElement("span",{ref:this.setTopRef,"data-test-selector":Z.Container},r.createElement(_.g,{display:_.d.Inline,position:_.j.Relative},r.createElement(z.a,{onClickOut:this.onClickOut},this.renderContent(),r.createElement(ne.a,{direction:this.state.balloonDirection,offsetX:this.state.balloonXOffset+"px",show:!0,size:ne.c.Medium,tailOffset:this.state.balloonTailOffset},r.createElement("span",{ref:this.setBalloonContentRef,"data-test-selector":Z.Balloon}),r.createElement(te,g.__assign({},this.props,{onDismissBalloon:this.onDismissBalloon,onShowText:this.onShowText})))))):r.createElement("span",{ref:this.setTopRef,"data-test-selector":Z.Container},this.renderContent())},t.prototype.renderContent=function(){var e={"flagged-fragment":!(this.state.displayed&&!this.state.active),"flagged-fragment--active":this.state.active};return this.state.displayed?r.createElement("span",{className:m(e),"data-test-selector":Z.Target},ae(this.props.messagePart.content)):r.createElement("span",{className:m(e),onClick:this.onClick,"data-test-selector":Z.Target},r.createElement(h,{content:this.placeholder}))},t.prototype.getBalloonState=function(){if(this.balloonContentRef&&this.topRef&&this.topRef.offsetParent){var e=this.topRef.offsetParent.getBoundingClientRect(),t=this.balloonContentRef.getBoundingClientRect(),n=this.state.balloonDirection;t.top<e.top&&(n=ne.b.BottomCenter);var i=e.left+20,r=t.left,a=this.state.balloonXOffset-(r-i);return{balloonDirection:n,balloonTailOffset:e.width/2-a-20,balloonXOffset:a}}return{balloonDirection:ne.b.TopCenter,balloonTailOffset:0,balloonXOffset:0}},t}(r.Component);function re(e,t,n){void 0===n&&(n=!1);var i=t.content,a=i.displayText,s=i.url;return n?r.createElement(h,{key:"message-span-"+e,content:a}):r.createElement(u,{key:e+"-link",displayText:a,url:s})}function ae(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!1);var i=null,a=e.reduce(function(a,o,d){var c=[];switch(d>0&&e[d-1].type!==p.a.Text&&o.type!==p.a.Text&&c.push(" "),o.type){case p.a.Text:case p.a.ModeratedText:var u=o.content,m=o.type;c.push(r.createElement(h,{key:d,content:u,highlightType:m}));break;case p.a.FlaggedSegment:c.push(r.createElement(ie,{key:d,channelID:t.chatChannelID,channelLogin:t.chatChannelLogin,messageID:t.messageSourceID,messagePart:o}));break;case p.a.CurrentUserHighlight:c.push(r.createElement(j,{isAtMention:!1,currentUserMentionRelation:A.a.Recipient,recipient:o.content,key:d}));break;case p.a.Mention:c.push(r.createElement(j,{isAtMention:!0,currentUserMentionRelation:o.content.currentUserMentionRelation,recipient:o.content.recipient,key:d}));break;case p.a.Emote:c.push(r.createElement(l.a,{key:d,emote:o.content,channelID:t.chatChannelID,channelLogin:t.chatChannelLogin,sourceID:t.messageSourceID,sourceType:t.emoteSourceType,referrerID:t.messageAuthorID,disableCard:n}));break;case p.a.Link:c.push(re(d,o,t.disableLinks));break;case p.a.ClipLink:i||t.disableChatCard||(i=r.createElement(s.a,{key:d+"-ErrorBoundary"},r.createElement(R,{slug:o.content.slug,forceNetworkRequest:t.forceClipsNetworkRequest}))),c.push(re(d,o,t.disableLinks));break;case p.a.VideoLink:i||t.disableChatCard||(i=r.createElement(q,{key:d,id:o.content.id,url:o.content.url})),c.push(re(d,o,t.disableLinks))}return a.concat(c)},[]);return i&&(a=a.concat(i)),a}function se(e){if(e.moderationType===G.e.Delete){var t=e,n=t.userLogin,i=t.body;return r.createElement(c.a,{targetLogin:n,messageBody:i})}if((e=e).moderationType===G.e.Ban)return e.reason?r.createElement("span",{className:"chat-line__moderation--ban-with-reason"},Object(a.d)("{userLogin} has been banned. Reason: {reason}",{userLogin:e.userLogin,reason:e.reason},"ChatLine")):r.createElement("span",{className:"chat-line__moderation--ban"},Object(a.d)("{userLogin} is now banned from this channel.",{userLogin:e.userLogin},"ChatLine"));if(e.reason&&e.duration){var s=Object(a.d)("{userLogin} has been timed out for {duration} seconds. Reason: {reason}",{duration:e.duration,reason:e.reason,userLogin:e.userLogin},"ChatLine");return r.createElement("span",{className:"chat-line__moderation--timeout-with-reason"},s)}return e.duration?r.createElement("span",{className:"chat-line__moderation--timeout"},Object(a.d)("{userLogin} has been timed out for {duration} seconds.",{userLogin:e.userLogin,duration:e.duration},"ChatLine")):void 0}function oe(e){var t=e.daysLeft;0===t&&(t=e.hoursLeft);var n,i={bitsTotal:r.createElement("strong",null,Object(d.f)(e.total,{style:"currency",currency:"USD"})),charityName:r.createElement("strong",null,e.charityName),learnMoreURL:r.createElement("a",{href:e.learnMore,target:"_blank",rel:"noopener noreferrer"},e.learnMore),hashtag:r.createElement("strong",null,e.hashtag),timeRemaining:Object(d.f)(t)};return r.createElement("span",null,0===e.daysLeft?(n=i,Object(a.d)("{bitsTotal} total raised so far for {charityName}! {timeRemaining} more hours to show support. Cheer and include {hashtag}. Learn More at {learnMoreURL}",{bitsTotal:n.bitsTotal,charityName:n.charityName,timeRemaining:n.timeRemaining,hashtag:n.hashtag,learnMoreURL:n.learnMoreURL},"ChatLine")):function(e){return Object(a.d)("{bitsTotal} total raised so far for {charityName}! {timeRemaining} more days to show support. Cheer and include {hashtag}. Learn More at {learnMoreURL}",{bitsTotal:e.bitsTotal,charityName:e.charityName,timeRemaining:e.timeRemaining,hashtag:e.hashtag,learnMoreURL:e.learnMoreURL},"ChatLine")}(i))}function de(e){var t=e.enabled?Object(a.d)("This room is now in slow mode. You may send messages every {length} seconds.",{length:e.length},"ChatLine"):Object(a.d)("This room is no longer in slow mode.","ChatLine");return r.createElement("span",null,t)}function ce(e){var t;if(e.length>0){var n=e.join(", ");t=Object(a.d)("The moderators of this channel are: {moderatorList}",{moderatorList:n},"ChatLine")}else t=Object(a.d)("There are no moderators of this channel.","ChatLine");return r.createElement("span",null,t)}function le(e){if(e.enabled){var t=0===e.length?Object(a.d)("This room is in followers-only mode.","ChatLine"):Object(a.d)("This room is now in {length} followers-only mode.",{length:Object(o.b)(60*e.length)},"ChatLine");return r.createElement("span",null,t)}return r.createElement("span",null,Object(a.d)("This room is no longer in followers-only mode.","ChatLine"))}function ue(e){return e.enabled?r.createElement("span",null,Object(a.d)("This room is now in emote-only mode.","ChatLine")):r.createElement("span",null,Object(a.d)("This room is no longer in emote-only mode.","ChatLine"))}function me(e){var t=e.enabled?Object(a.d)("This room is now in subscriber-only mode.","ChatLine"):Object(a.d)("This room is no longer in subscriber-only mode.","ChatLine");return r.createElement("span",null,t)}function pe(e){return e.enabled?r.createElement("span",null,Object(a.d)("r9k mode has been enabled for this room.","ChatLine")):r.createElement("span",null,Object(a.d)("r9k mode has been disabled for this room.","ChatLine"))}function he(e){return e.isAutohost?Object(a.d)("{host} is now auto hosting you for up to {viewerCount, number} viewers.",{host:e.hostingChannel,viewerCount:e.viewerCount},"ChatLine"):e.viewerCount<=2?Object(a.d)("{host} is now hosting you.",{host:e.hostingChannel},"ChatLine"):Object(a.d)("{host} is now hosting you for up to {viewerCount, number} viewers.",{host:e.hostingChannel,viewerCount:e.viewerCount},"ChatLine")}function ge(e,t){void 0===t&&(t=!1);var n=t?e.getHours():e.getHours()%12;t||0!==n||(n=12);var i=n.toString(),r=e.getMinutes(),a=r.toString();return r<10&&(a="0"+a),t&&n<10&&(i="0"+i),i+":"+a}function fe(e,t){return void 0===t&&(t=!1),r.createElement("span",{key:"timestamp",className:"chat-line__timestamp","data-a-target":"chat-timestamp","data-test-selector":"chat-timestamp"},ge(new Date(e),t))}function ke(e){return r.createElement("span",{key:"timestamp",className:"chat-line__timestamp","data-a-target":"chat-timestamp","data-test-selector":"chat-timestamp"},function(e,t){void 0===t&&(t={});var n=a.q.intl.getLanguageCode()||"en";return Intl.DateTimeFormat(n,t).format(e)}(new Date(e),{hour:"numeric",minute:"numeric"}))}n.d(t,"f",function(){return ae}),n.d(t,"g",function(){return se}),n.d(t,"b",function(){return oe}),n.d(t,"j",function(){return de}),n.d(t,"i",function(){return ce}),n.d(t,"d",function(){return le}),n.d(t,"c",function(){return ue}),n.d(t,"k",function(){return me}),n.d(t,"h",function(){return pe}),n.d(t,"e",function(){return he}),n.d(t,"a",function(){return ge}),n.d(t,"l",function(){return fe}),n.d(t,"m",function(){return ke})},"dNN/":function(e,t,n){},"dr/4":function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Thread_SetMuteThread"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateWhisperThreadInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateWhisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thread"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isMuted"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:129}};n.loc.source={body:"mutation Thread_SetMuteThread($input: UpdateWhisperThreadInput!) {\nupdateWhisperThread(input: $input) {\nthread {\nid\nisMuted\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},efEE:function(e,t,n){},fbdC:function(e,t,n){"use strict";var i,r=n("/MKj"),a=n("fvjX"),s=n("aCAx"),o=n("mrSG"),d=n("q1tI"),c=n("/7QA"),l=n("cZKs"),u=n("Ws8v"),m=n("hnjF"),p=n("X2PJ"),h=n("sUnt"),g=n("dEDE");!function(e){e.Message="confirmation-modal__message",e.ConfirmButton="confirmation-modal__confirm-button"}(i||(i={}));var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCancelClick=function(){t.props.closeModal()},t.renderConfirmButton=function(){return d.cloneElement(t.props.confirmButton,{onClick:t.handleConfirmClick,"data-test-selector":i.ConfirmButton})},t.handleConfirmClick=function(){t.props.closeModal(),t.props.onConfirmClick()},t}return o.__extends(t,e),t.prototype.render=function(){return d.createElement(u.a,{background:p.a.Base,padding:{x:3,top:3,bottom:2},display:m.d.Flex,flexDirection:m.e.Column},d.createElement(h.a,{"data-test-selector":i.Message},this.props.message),d.createElement(h.a,{display:m.d.Flex,flexDirection:m.e.Row,justifyContent:m.h.Center,padding:{top:2}},d.createElement(h.a,{padding:{right:.5}},d.createElement(g.a,{type:g.d.Text,onClick:this.handleCancelClick},Object(c.d)("Cancel","SettingsConfirmationModal"))),d.createElement(h.a,{padding:{left:.5}},this.renderConfirmButton())),d.createElement(l.a,null))},t}(d.Component);var k=Object(r.connect)(null,function(e){return Object(a.bindActionCreators)({closeModal:s.c},e)})(f);n.d(t,"a",function(){return k}),n.d(t,!1,function(){})},fezU:function(e,t,n){"use strict";var i,r=n("mrSG"),a=n("q1tI"),s=n("1rIY"),o=n("1MDS"),d=n("oK83"),c=(i=Object(s.a)("ViewerCardContext",{viewerCardOptions:null,onShowViewerCard:function(){return null},onShowExtensionMessageCard:function(){return null},onShowEmoteCard:function(){return null},hideViewerCard:function(){return null}})).InnerProvider,l=i.withContext,u=function(e){function t(t){var n=e.call(this,t)||this;return n.onShowViewerCard=function(e,t,i,r){n.setState(function(n){var a=n.viewerCardOptions;return a&&a.targetID===e?{viewerCardOptions:null}:{viewerCardOptions:{viewerCardType:d.c.Viewer,initialTopOffset:r,sourceID:i,sourceType:t,targetID:e}}})},n.onShowExtensionMessageCard=function(e,t,i,r){n.setState(function(n){var a=n.viewerCardOptions;return a&&a.viewerCardType===d.c.Extension&&a.targetID===e?{viewerCardOptions:null}:{viewerCardOptions:{viewerCardType:d.c.Extension,initialTopOffset:r,sourceID:i,targetID:e,extensionVersion:t}}})},n.onShowEmoteCard=function(e){n.setState(function(t){var n=t.viewerCardOptions;return n&&n.viewerCardType===d.c.Emote&&n.emoteID===e.emoteID?{viewerCardOptions:null}:{viewerCardOptions:{viewerCardType:d.c.Emote,initialTopOffset:e.initialTopOffset||0,sourceID:e.sourceID,emoteSourceType:e.emoteSourceType,targetID:e.referrerID,emoteID:e.emoteID,emoteCode:e.emoteCode}}}),Object(o.c)({emoteLocation:Object(o.b)(e.emoteSourceType),emoticonID:e.emoteID,chatChannel:e.channelLogin,chatChannelID:e.channelID?e.channelID:"",referrerUserID:e.referrerID,action:o.a.Open,msgID:e.sourceID})},n.hideViewerCard=function(){n.setState({viewerCardOptions:null})},n.state={viewerCardOptions:null,onShowViewerCard:n.onShowViewerCard,onShowExtensionMessageCard:n.onShowExtensionMessageCard,onShowEmoteCard:n.onShowEmoteCard,hideViewerCard:n.hideViewerCard},n}return r.__extends(t,e),t.prototype.render=function(){return a.createElement(c,{value:this.state},this.props.children)},t}(a.Component);n.d(t,!1,function(){return c}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u})},gDzh:function(e,t,n){},gTu3:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.Default=0]="Default",e[e.Recipient=1]="Recipient",e[e.Sender=2]="Sender"}(i||(i={}))},hRS0:function(e,t,n){},i6WW:function(e,t,n){"use strict";var i=n("RcPG"),r=new RegExp("(?:^|\\s)(?:https?://)?clips.twitch.tv/(\\w+)(?:/)?(\\w+)?(?:/edit)?(?:$|\\s)?"),a=new RegExp("(?:^|\\s)(?:https?:\\/\\/)?(?:www\\.)?twitch\\.tv\\/(\\w+)\\/clip\\/(\\w+)(?:$|\\s)?");var s=new RegExp("(?:^|\\s)(?:https?://)?(?:(?:www|go).)?twitch.tv/videos/(\\d+)(?:$|\\s)?");n.d(t,"a",function(){return d});var o=/^(?:(https?:\/\/)?((?:[\w#%\-+=:~]+\.)+[a-z]{2,8}(?:\/[\w.\/#%&@()\-+=:?~]*)?))$/;function d(e,t){void 0===t&&(t={});var n=e.match(o);if(!n)return null;var d=""+(n[1]||"https://")+n[2];if(t.parseClips&&function(e){void 0===e&&(e="");var t=r.test(e)&&!e.includes("clips.twitch.tv/2017/"),n=a.test(e);return t||n}(d)){var c=function(e){void 0===e&&(e="");var t=e.match(r);if(t&&t.length>0&&void 0!==t.index)return t[1];var n=e.match(a);return n&&n.length>0&&void 0!==n.index?n[2]:""}(d);if("create"!==c)return{type:i.a.ClipLink,content:{slug:c,url:d,displayText:e}}}if(t.parseVods&&function(e){return void 0===e&&(e=""),s.test(e)}(d)){var l=function(e){void 0===e&&(e="");var t=e.match(s);return null===t?"":t&&t.length>0&&void 0!==t.index?t[1]:""}(d);return{type:i.a.VideoLink,content:{id:l,url:d,displayText:e}}}return{type:i.a.Link,content:{displayText:e,url:d}}}},iS14:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n("mrSG"),r=n("yR8l"),a=n("8jSG"),s=n("cMjZ"),o=n("zixI");function d(){var e=this;return Object(r.a)(o,{props:function(t){return{unblockUserMutation:function(n,r){return i.__awaiter(e,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return t.mutate?[4,t.mutate({variables:{input:{targetUserID:n}},optimisticResponse:{unblockUser:{__typename:"UnblockUserPayload",targetUser:{__typename:"User",id:n}}},update:function(e){var t=e.readFragment({id:Object(s.a)(r),fragment:a});t&&(t.blockedUsers=t.blockedUsers.filter(function(e){return null!==e&&e.id!==n}),e.writeFragment({id:Object(s.a)(r),fragment:a,data:t}))}})]:[3,2];case 1:return e.sent(),[3,3];case 2:throw new Error("unblockUserMutation is not ready");case 3:return[2]}})})}}}})}},j0ar:function(e,t,n){"use strict";var i=n("mrSG"),r=n("TSYQ"),a=n("q1tI"),s=n("x1M1"),o=n("hnjF"),d=n("+80q"),c=n("PL8s"),l=n("b7S+"),u=(n("9KaG"),function(e){function t(t){var n=e.call(this,t)||this;return n.onImageLoad=function(){n.setState({imageLoaded:!0})},n.onMouseOver=function(){n.setState({isHovering:!0})},n.onMouseOut=function(){n.setState({isHovering:!1})},n.renderImage=function(){var e=null,t=r("chat-image",{"chat-image__animated":!!n.props.cheerText&&n.state.imageLoaded},n.props.className);if(n.props.srcSet.themed)e=a.createElement(o.g,{display:n.state.imageLoaded?o.d.InlineBlock:o.d.Hide},a.createElement(s.a,{alt:n.props.alt,className:t,defaultRes:n.props.srcKey,onLoad:n.onImageLoad,onMouseOver:n.onMouseOver,onMouseOut:n.onMouseOut,sources:n.props.srcSet}));else{for(var i=[],d=0,c=Object.keys(n.props.srcSet.sources);d<c.length;d++){var l=c[d];i.push(n.props.srcSet.sources[l]+" "+l)}e=a.createElement(o.g,{display:n.state.imageLoaded?o.d.InlineBlock:o.d.Hide},a.createElement("img",{className:t,onLoad:n.onImageLoad,onMouseOver:n.onMouseOver,onMouseOut:n.onMouseOut,src:n.props.srcSet.sources[n.props.srcKey],srcSet:i.join(","),alt:n.props.alt}))}return e},n.renderPlaceholder=function(){return n.state.imageLoaded?null:a.createElement(o.g,{display:o.d.InlineBlock},a.createElement(d.a,{type:d.e.Span,className:"chat-image__placeholder",align:o.l.Top},a.createElement(c.a,{height:28,width:28})))},n.state={imageLoaded:!1,isHovering:!1},n}return i.__extends(t,e),t.prototype.render=function(){var e;return e=this.state.isHovering&&this.state.imageLoaded?a.createElement(l.a,{direction:this.props.tooltipDirection||l.c.Top,label:this.props.alt,display:o.d.Inline,offsetY:"0.9rem","data-a-target":"emote-name"},this.renderPlaceholder(),this.renderImage(),this.props.cheerText):a.createElement("span",{"data-a-target":"emote-name"},this.renderPlaceholder(),this.renderImage(),this.props.cheerText),this.props.cheerText?a.createElement(d.a,{type:d.e.Span,noWrap:!0},e):e},t}(a.Component));n.d(t,"a",function(){return u})},jPWu:function(e,t,n){},kPBf:function(e,t){},kSkr:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"BlockUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BlockUserInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blockUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"targetUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:94}};n.loc.source={body:"mutation BlockUser($input: BlockUserInput!) {\nblockUser(input: $input) {\ntargetUser {\nid\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},lZZ2:function(e,t,n){"use strict";var i=n("mrSG"),r=n("q1tI"),a=n("/MKj"),s=n("fvjX"),o=n("/7QA"),d=n("fbdC"),c=n("BhFH"),l=n("QVaV"),u=n("aCAx"),m=n("X2PJ"),p=n("dEDE"),h=n("CGUg"),g=n("Ws8v"),f=n("+80q"),k=n("hnjF");function v(e){return function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.showBlockModal=function(t){return e.props.showConfirmationModal({confirmButton:e.renderBlockButton(),onConfirmClick:function(){e.props.blockUserMutation(t.userID,t.reason,t.context,t.currentUserData),t.onBlock&&t.onBlock()},message:e.renderMessage(t.login,t.displayName)})},e}return i.__extends(n,t),n.prototype.render=function(){return r.createElement(e,i.__assign({},this.props,{showBlockModal:this.showBlockModal}))},n.prototype.renderBlockButton=function(){return r.createElement(p.a,{type:p.d.Alert},Object(o.d)("Block","BlockModal"))},n.prototype.renderMessage=function(e,t){var n=Object(l.a)(e,t,!0);return r.createElement(r.Fragment,null,r.createElement(g.a,{borderBottom:!0,padding:{bottom:2},textAlign:k.k.Center},r.createElement(f.a,{bold:!0,type:f.e.H4},Object(o.d)("Block {displayName}?",{displayName:n},"BlockModal"))),r.createElement(g.a,{color:m.c.Alt2,padding:{top:2}},r.createElement(h.a,{baseFontSize:m.d.Size6},r.createElement("p",null,Object(o.d)("Blocking {displayName} will:",{displayName:n},"BlockModal")),r.createElement("ul",null,r.createElement("li",null,Object(o.d)("Prevent them from sending you whispers","BlockModal")),r.createElement("li",null,Object(o.d)("Prevent them from hosting you","BlockModal")),r.createElement("li",null,Object(o.d)("Prevent them from adding you as a friend","BlockModal")),r.createElement("li",null,Object(o.d)("Prevent them from purchasing gift subs for other users in your channel","BlockModal")),r.createElement("li",null,Object(o.d)("Filter their messages out of chats you don’t moderate","BlockModal"))))))},n}(r.Component)}var b=Object(s.compose)(Object(c.a)(),Object(a.connect)(null,function(e){return Object(s.bindActionCreators)({showConfirmationModal:function(e){var t=i.__rest(e,[]);return Object(u.d)(d.a,t)}},e)}),v);n.d(t,!1,function(){return v}),n.d(t,"a",function(){return b})},lZdE:function(e,t,n){"use strict";function i(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}n.d(t,"a",function(){return i})},"lpj/":function(e,t,n){},mBWp:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Whispers_Tracking_CurrentUser"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"hasTurbo"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:86}};n.loc.source={body:"query Whispers_Tracking_CurrentUser {\ncurrentUser {\nid\nhasTurbo\navailability\nlogin\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},mmRu:function(e,t,n){"use strict";var i,r=n("/MKj"),a=n("mrSG"),s=n("q1tI"),o=n("u5aL"),d=n("/7QA"),c=n("7d/q"),l=n("7uM4"),u=function(e){return s.createElement(c.a,{icon:l.b.Emoticons,ariaLabel:Object(d.d)("Emote picker","EmotePickerButton"),type:e.isActive?c.c.Default:c.c.Secondary,onClick:e.onClick,"data-a-target":"emote-picker-button"})},m=n("fvjX"),p=n("yR8l"),h=n("x7UT"),g=n("Mj6i"),f=n("1/iK"),k=n("kRBY"),v=n("+pBb"),b=n("w1PT"),y=n("8EUQ"),S=n("KriR"),_=n("GzyO"),C=n("OpME"),E=function(e){return e.tier&&!isNaN(parseInt(e.tier,10))?parseInt(e.tier,10)/1e3:1},N=n("GnwI"),D=n("br9A"),I=n("8/mp"),T=n("2xye"),w=n("7SjK"),F=n("uG/k"),O=n("sUnt"),M=n("Ws8v"),U=n("hnjF"),x=n("+80q"),R=n("X2PJ"),A=(n("zyUW"),function(e){var t=null;return e.imgSrc&&(t=s.createElement(s.Fragment,null,s.createElement(F.a,{className:"emote-grid-section__header-image",src:e.imgSrc,alt:e.label}),s.createElement(O.a,{padding:{right:.5}}))),s.createElement(O.a,{position:U.j.Relative,padding:1,className:"emote-grid-section"},s.createElement(M.a,{alignItems:U.b.Center,display:U.d.Flex,padding:{x:1,bottom:.5}},t,s.createElement(x.a,{align:U.l.Middle,bold:!0,color:R.c.Alt},e.label)),s.createElement(w.a,{context:e.context,emotes:e.emotes,onClickEmote:e.onClickEmote,spaced:!0}))}),P=n("4VQm"),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkVisible=function(e,n){t.props.checkVisible(e,n)},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.unregister=this.props.registerReceiver(this)},t.prototype.componentWillUnmount=function(){this.unregister&&this.unregister()},t.prototype.render=function(){return s.createElement(s.Fragment,null,this.props.children)},t}(s.Component),L=Object(P.c)(function(e){return{registerReceiver:e.registerReceiver}})(j),B=n("i4Ys"),W=(n("cr2a"),function(e){return s.createElement(O.a,{className:"emote-picker-tab-item "+(e.isActive?"emote-picker-tab-item--active":""),position:U.j.Relative},s.createElement(B.a,{"data-a-target":e.label,onClick:e.onClick,blurAfterClick:!0},s.createElement(O.a,{padding:1,display:U.d.InlineFlex},s.createElement(l.a,{asset:e.icon}))))}),V=n("oJmH"),H=n("DnOo"),q=n("a5fV"),G=n("dEDE"),z=n("CGUg"),Q=(n("GLn2"),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.channelSubEmotes,n=e.channelSubscriptionProducts,i=e.subUpsellClickedEmote,r=n.find(function(e){return e.emoteSetID===i.setID});if(!r)return null;var o={};t.forEach(function(e){if(e.isLocked&&null!==e.setID&&void 0!==e.setID){var t=n.find(function(t){return t.emoteSetID===e.setID});t&&(o[t.emoteSetID]=t)}});var c=E(r),u=Object(d.d)("Subscribe at Tier {tierNumber}",{tierNumber:c},"EmotePickerCard"),m=[],p=[];t.forEach(function(e){var t=o[e.setID];t&&(E(t)<=c?p.push(a.__assign({},e,{isLocked:!1})):m.push(e))}),m.sort(function(e,t){var n=o[e.setID],i=o[t.setID],r=E(n);return E(i)-r});var h=m.concat(p),g=r.price.toString()||"";if(r.priceInfo){var f=r.priceInfo;g=Object(q.a)(Object(q.b)(f.total,f.exponent),f.currency)}var k=p.length>1?Object(d.d)("{numUnlocked} Emotes Included",{numUnlocked:p.length},"EmotePickerCard"):Object(d.d)("1 Emote Included","EmotePickerCard");return s.createElement(O.a,{className:"emote-sub-upsell"},s.createElement(M.a,{padding:{top:.5}},s.createElement(G.a,{type:G.d.Text,icon:l.b.AngleLeft,onClick:this.props.onBackClick,size:G.b.Small},Object(d.d)("Back","EmotePickerCard"))),s.createElement(M.a,{display:U.d.Flex,padding:{x:2,bottom:1}},s.createElement(O.a,{flexGrow:0,flexShrink:0,padding:{top:.5}},s.createElement(F.a,{src:this.getBigImageSrc(i.srcSet),alt:i.displayName||""})),s.createElement(O.a,{flexGrow:1,flexShrink:1,padding:{left:1}},s.createElement(x.a,{bold:!0},this.renderCopyHeader(c.toString())),s.createElement(x.a,null,this.renderCopyBody(c.toString(),p.length)))),s.createElement(O.a,{display:U.d.Flex,alignItems:U.b.Center,justifyContent:U.h.Center,padding:{x:2}},s.createElement(H.a,{customSubscribeNowMessage:u,isSubbedToTier:!1,fullWidth:!0,tierPrice:g,handleSubAction:this.props.handleSubAction,productName:r.name,url:r.url,isEsportChannel:this.props.isEsportChannel})),s.createElement(z.a,null,s.createElement("hr",{className:"emote-sub-upsell__divider"})),s.createElement(I.b,{className:"emote-sub-upsell__content"},s.createElement(O.a,null,s.createElement(O.a,{padding:{x:2}},s.createElement(x.a,{bold:!0},k)),s.createElement(O.a,{padding:{x:1,top:.5,bottom:3}},s.createElement(w.a,{emotes:h,spaced:!0,onClickEmote:this.props.onClickEmote})))))},t.prototype.renderCopyHeader=function(e){return Object(d.d)("{channelDisplayName} - Tier {tierNumber} Subscription",{tierNumber:e,channelDisplayName:this.props.channelDisplayName},"EmotePickerCard")},t.prototype.renderCopyBody=function(e,t){return 1===t?Object(d.d)("To unlock 1 emote and more subscriber benefits, subscribe at Tier {tierNumber}",{tierNumber:e},"EmotePickerCard"):Object(d.d)("To unlock {numEmotes} emotes and more subscriber benefits, subscribe at Tier {tierNumber}.",{tierNumber:e,numEmotes:t},"EmotePickercard")},t.prototype.getBigImageSrc=function(e){var t=e.split(" ");return 6===t.length?t[2]:t[0]},t}(s.Component)),K=n("XQnt"),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidUpdate=function(e){this.props.data&&(!this.props.data.loading||this.props.data.error)&&e.data&&e.data.loading&&this.props.latencyTracking.reportInteractive()},t.prototype.render=function(){return s.createElement(Q,{channelDisplayName:this.props.channelDisplayName,channelSubEmotes:this.props.channelSubEmotes,channelSubscriptionProducts:this.subscriptionProducts,handleSubAction:this.props.handleSubAction,isEsportChannel:this.props.isEsportChannel,onBackClick:this.props.onBackClick,onClickEmote:this.props.onClickEmote,subUpsellClickedEmote:this.props.subUpsellClickedEmote})},Object.defineProperty(t.prototype,"subscriptionProducts",{get:function(){return this.props.data&&this.props.data.user&&this.props.data.user.subscriptionProducts?this.props.data.user.subscriptionProducts.filter(function(e){return null!==e}):this.props.channelSubscriptionProducts},enumerable:!0,configurable:!0}),t}(s.Component),$=Object(V.compose)(Object(p.a)(K,{options:function(e){return{variables:{channelID:e.channelID}}}}),Object(N.withLatencyTracking)("EmoteSubUpsell"))(Y);!function(e){e.FrequentlyUsed="frequently_used",e.CurrentChannel="current_channel",e.OtherChannel="other_subbed_channel",e.Unlocked="unlocked",e.Global="global"}(i||(i={}));var J,X=n("XQbB"),Z=n("ygYM"),ee=n("3Law");n("JGCS");!function(e){e.FrequentlyUsedEmotes="FREQUENTLY_USED_EMOTES",e.ChannelEmotes="CHANNEL_EMOTES",e.AllEmotes="ALL_EMOTES"}(J||(J={}));var te=function(e){function t(t){var n=e.call(this,t)||this;return n.onTabNavClick=function(e){if(n.scroll&&n.scroll.scrollContent&&e.currentTarget.getAttribute("data-a-target")){var t=e.currentTarget.getAttribute("data-a-target"),i=J.FrequentlyUsedEmotes;switch(t){case J.FrequentlyUsedEmotes:n.frequentlyUsedEmotesRef&&(n.frequentlyUsedEmotesRef.scrollIntoView(),i=J.FrequentlyUsedEmotes);break;case J.ChannelEmotes:n.channelEmotesRef&&(n.channelEmotesRef.scrollIntoView(),i=J.ChannelEmotes);break;case J.AllEmotes:n.allEmotesRef&&(n.allEmotesRef.scrollIntoView(),i=J.AllEmotes)}n.setState({selectedNavTab:i})}},n.onClickEmote=function(e,t){if(n.props.onClickEmote&&!e.isLocked){n.props.onClickEmote(e.displayName||e.token,e.id);var i={channel_id:n.props.channelID||void 0,chatroom_id:n.props.roomID,context:t,emote_picker_sid:n.props.emotePickerSessionID,emote_id:e.id,emoticon_set_id:e.setID,generated_by:n.props.emotePickerSource};d.p.track(T.SpadeEventType.EmotePickerClickthrough,i)}else e.isLocked&&n.onClickLockedEmote(e)},n.saveScrollRef=function(e){return n.scroll=e},n.saveAllEmotesRef=function(e){return n.allEmotesRef=e},n.saveChannelEmotesRef=function(e){return n.channelEmotesRef=e},n.saveFrequentlyUsedEmotesRef=function(e){return n.frequentlyUsedEmotesRef=e},n.checkVisible=function(e,t){if(t){n.state.hasUserInteracted||n.setState({hasUserInteracted:!0});var i=n.state.selectedNavTab,r=n.allEmotesRef&&t.offset>=n.allEmotesRef.offsetTop;i=n.channelEmotesRef&&t.offset>=n.channelEmotesRef.offsetTop&&!r?J.ChannelEmotes:r?J.AllEmotes:J.FrequentlyUsedEmotes,n.state.selectedNavTab!==i&&n.setState({selectedNavTab:i})}},n.onClickLockedEmote=function(e){n.setState({subUpsellClickedEmote:e})},n.onBackClick=function(){n.setState({subUpsellClickedEmote:null,selectedNavTab:J.FrequentlyUsedEmotes})},n.handleFilterChange=function(e){var t=e.target.value,i=t.toLowerCase();n.setState({filter:i,inputValue:t,filteredEmotes:n.filterEmoteSets(n.props.allEmoteSets,i),selectedNavTab:J.FrequentlyUsedEmotes})},n.filterEmoteSets=function(e,t){var n=[];e.forEach(function(e){e.emotes.filter(function(e){return!(!e.displayName||!e.displayName.toLowerCase().includes(t))||e.token.toLowerCase().includes(t)}).forEach(function(t){t.setID=e.id,n.push(t)})});var i=Object(_.e)(),r=0===Object.keys(i).length?void 0:i,a=Object(C.e)(n,t,r);return Object(C.d)(a)},n.updateChannelEmotes=function(e){var t=e.channelSubEmotes;if(0===t.length||!e.channelDisplayName)return null;var i=[],r=[];t.forEach(function(e){e.isLocked?i.push(e):r.push(e)});var a=Object(C.d)(n.props.channelCampaignEmotes.concat(r,i));n.setState({sortedChannelEmotes:a})},n.state={filter:"",filteredEmotes:[],hasUserInteracted:!1,inputValue:"",selectedNavTab:J.FrequentlyUsedEmotes,sortedChannelEmotes:[],subUpsellClickedEmote:null},n}return a.__extends(t,e),t.prototype.componentDidMount=function(){if(this.props.channelID&&this.updateChannelEmotes(this.props),this.props.emotePickerSessionID&&this.props.channelID){var e={channel_id:this.props.channelID,emote_picker_sid:this.props.emotePickerSessionID,generated_by:this.props.emotePickerSource,chatroom_id:this.props.roomID};d.p.track(T.SpadeEventType.ViewedEmotePicker,e)}},t.prototype.componentWillReceiveProps=function(e){if(this.props.channelID===e.channelID&&this.props.channelSubscriptionProducts===e.channelSubscriptionProducts||this.updateChannelEmotes(e),e.channelID&&e.emotePickerSessionID&&!this.props.emotePickerSessionID){var t={channel_id:e.channelID,emote_picker_sid:e.emotePickerSessionID,generated_by:e.emotePickerSource,chatroom_id:e.roomID};d.p.track(T.SpadeEventType.ViewedEmotePicker,t)}},t.prototype.render=function(){return s.createElement(Z.a,{"data-a-target":"emote-picker",direction:this.props.direction?this.props.direction:Z.b.TopRight,size:this.props.size?this.props.size:Z.c.Medium,noTail:!0,show:!0},s.createElement(O.a,{className:"emote-picker"},this.renderView()))},t.prototype.renderView=function(){var e=null;null===this.state.subUpsellClickedEmote&&(e=s.createElement(s.Fragment,null,s.createElement(M.a,{padding:{top:2,x:2}},s.createElement(ee.a,{autoFocus:!0,onChange:this.handleFilterChange,placeholder:Object(d.d)("Search for Emotes","EmotePickerCard"),value:this.state.inputValue})),this.renderTabContent()));var t=null;return null!==this.props.channelDisplayName&&null!==this.props.channelID&&null!==this.state.subUpsellClickedEmote&&(t=s.createElement($,{channelDisplayName:this.props.channelDisplayName,channelSubEmotes:this.props.channelSubEmotes,channelID:this.props.channelID,channelSubscriptionProducts:this.props.channelSubscriptionProducts,isEsportChannel:this.props.isEsportChannel||!1,handleSubAction:this.props.handleSubAction,onBackClick:this.onBackClick,onClickEmote:this.onClickLockedEmote,ownedSetIDs:this.props.ownedSetIDs,subUpsellClickedEmote:this.state.subUpsellClickedEmote})),s.createElement(s.Fragment,null,t,e)},t.prototype.renderTabContent=function(){return this.props.gqlError?s.createElement(O.a,null,s.createElement(x.a,{"data-test-selector":"emote-picker-menu-error-text",color:R.c.Error},Object(d.d)("Unable to load available emotes.","EmotePickerCard"))):this.props.loading?s.createElement(O.a,{alignItems:U.b.Center,display:U.d.Flex,fullHeight:!0,fullWidth:!0,justifyContent:U.h.Center,padding:1},s.createElement(X.a,null)):""!==this.state.filter?this.renderSearchContent():s.createElement(s.Fragment,null,s.createElement(I.b,{scrollRef:this.saveScrollRef,className:"emote-picker__tab-content"},s.createElement(O.a,{padding:{bottom:2}},s.createElement(L,{checkVisible:this.checkVisible},this.getFrequentlyUsedEmoteGrid(),this.getCurrentChannelEmoteGrid(),this.getOtherSubEmoteGrids(),this.getResidualEmoteGrids()))),this.renderTabNav())},t.prototype.getFrequentlyUsedEmoteGrid=function(){return 0===this.props.frequentlyUsedEmotes.length?null:s.createElement(O.a,{className:"emote-picker__content-block",refDelegate:this.saveFrequentlyUsedEmotesRef},s.createElement(A,{context:i.FrequentlyUsed,emotes:this.props.frequentlyUsedEmotes,label:Object(d.d)("Frequently Used","EmotePickerCard"),onClickEmote:this.onClickEmote}))},t.prototype.getCurrentChannelEmoteGrid=function(){var e=this.props.channelCampaignEmotes.concat(this.state.sortedChannelEmotes);return 0===e.length||null===this.props.channelDisplayName?null:s.createElement(O.a,{className:this.props.isLoggedIn?"emote-picker__content-block":void 0,refDelegate:this.saveChannelEmotesRef},s.createElement(A,{context:i.CurrentChannel,emotes:e,imgSrc:this.props.channelProfileImageURL,label:this.props.channelDisplayName,onClickEmote:this.onClickEmote}))},t.prototype.getOtherSubEmoteGrids=function(){var e=this;if(!this.props.isLoggedIn)return null;var t=[];return this.props.otherChannelEmoteSets.forEach(function(n){n.owner&&n.owner.displayName&&t.push(s.createElement(O.a,{key:"emote-grid--"+n.id+"-emotes",className:"emote-picker__content-block"},s.createElement(A,{context:i.OtherChannel,emotes:n.emotes,imgSrc:n.owner.profileImageURL,label:n.owner.displayName,onClickEmote:e.onClickEmote})))}),this.state.hasUserInteracted||(t=t.slice(0,4)),s.createElement(s.Fragment,null,t)},t.prototype.getResidualEmoteGrids=function(){if(!this.props.isLoggedIn)return null;var e=[];return this.props.unlockedEmotes.length>0&&this.props.isLoggedIn&&e.push(s.createElement(O.a,{key:"emote-grid--unlocked-emotes",className:"emote-picker__content-block"},s.createElement(A,{context:i.Unlocked,emotes:this.props.unlockedEmotes,label:Object(d.d)("Unlocked","EmotePickerCard"),onClickEmote:this.onClickEmote}))),this.props.globalEmotes.length>0&&e.push(s.createElement(O.a,{key:"emote-grid--global-emotes"},s.createElement(A,{context:i.Global,emotes:this.props.globalEmotes,label:Object(d.d)("Global","EmotePickerCard"),onClickEmote:this.onClickEmote}))),s.createElement(O.a,{refDelegate:this.saveAllEmotesRef},e)},t.prototype.renderSearchContent=function(){var e=Object(d.d)('No Search Results for "{inputValue}"',{inputValue:this.state.inputValue},"EmotePickerCard");return this.state.filteredEmotes.length>0&&(e=Object(d.d)('Search Results for "{inputValue}"',{inputValue:this.state.inputValue},"EmotePickerCard")),s.createElement(I.b,{className:"emote-picker__tab-content"},s.createElement(O.a,{position:U.j.Relative,padding:{x:1,top:1,bottom:3},className:"emote-picker__content-block"},s.createElement(M.a,{padding:{x:1}},s.createElement(x.a,{bold:!0},e)),s.createElement(w.a,{emotes:this.state.filteredEmotes,onClickEmote:this.onClickEmote,spaced:!0})))},t.prototype.renderTabNav=function(){var e=null;this.state.sortedChannelEmotes.length>0&&(e=s.createElement(W,{isActive:this.state.selectedNavTab===J.ChannelEmotes,label:J.ChannelEmotes,icon:l.b.NavChannels,onClick:this.onTabNavClick}));var t=null;return this.props.isLoggedIn&&(t=s.createElement(W,{isActive:this.state.selectedNavTab===J.AllEmotes,label:J.AllEmotes,icon:l.b.EmoticonsAll,onClick:this.onTabNavClick})),e||t?s.createElement(M.a,{background:R.a.Alt,display:U.d.Flex,className:"emote-picker__tab-nav-container"},s.createElement(W,{isActive:this.state.selectedNavTab===J.FrequentlyUsedEmotes,label:J.FrequentlyUsedEmotes,icon:l.b.GlyphLength,onClick:this.onTabNavClick}),e,t):null},t}(s.PureComponent),ne=n("DB+C"),ie=function(e){function t(t){var n=e.call(this,t)||this;n.handleSubEvent=function(e){e.action===D.a.ClickCheckout&&n.checkAndDisplaySubscriptionCheckout();var t=n.props.channelData,i=null;if(t){var r=t.user;r&&r.self&&r.self.cumulativeTenure&&(i=r.self.cumulativeTenure.months)}Object(D.b)(a.__assign({},e,{action:D.a.ClickCheckout,channelID:t&&t.user&&t.user.id||"",channelLogin:t&&t.user&&t.user.displayName||"",cumulativeTenureMonths:i,isMenuOpen:null,hasSubCredit:null,sub_location:"emote_picker",modal:!1,showPrimeContent:!0,giftRecipient:null}))};var i={allEmoteSets:[],channelCampaignEmotes:[],channelSubEmotes:[],channelSubscriptionProducts:[],frequentlyUsedEmotes:t.isLoggedIn?[]:Object(_.b)(),globalEmotes:[],gqlError:t.emoteSetsData&&!!t.emoteSetsData.error||t.channelData&&!!t.channelData.error||!1,gqlLoading:t.emoteSetsData&&!!t.emoteSetsData.loading||t.channelData&&!!t.channelData.loading||!1,otherChannelEmoteSets:[],ownedSetIDs:new Set([]),unlockedEmotes:[]};return i=n.applyDataPropsToState(t,i),n.state=a.__assign({},i),n}return a.__extends(t,e),t.prototype.componentDidMount=function(){Object(_.c)(),this.checkDataLoaded(this.props)&&(this.props.onLoad&&this.props.onLoad(this.checkForContent(this.props)),this.props.latencyTracking.reportInteractive())},t.prototype.componentWillReceiveProps=function(e){if(e.emoteSetsData&&e.emoteSetsData.error||e.channelData&&e.channelData.error)this.setState({gqlError:!0});else{var t=this.applyDataPropsToState(e,this.state);this.props.pubsub.messages.subscriptionInfo!==e.pubsub.messages.subscriptionInfo&&(this.props.channelData&&this.props.channelData.refetch(),this.props.emoteSetsData&&this.props.emoteSetsData.refetch()),this.checkDataLoaded(e)&&(e.latencyTracking.reportInteractive(),e.onLoad&&e.onLoad(this.checkForContent(e)),t.gqlLoading=!1),this.setState(a.__assign({},t,{gqlError:!1}))}if(e.visible&&!this.props.visible){if(this.props.openEmotePicker(),e.emoteSetsData&&e.emoteSetsData.emoteMap){var n=Object(_.d)(e.emoteSetsData.emoteMap);this.setState({frequentlyUsedEmotes:n})}}else this.props.visible&&!e.visible&&this.props.closeEmotePicker()},t.prototype.componentWillUnmount=function(){this.props.closeEmotePicker()},t.prototype.render=function(){var e=this.props.channelData;if(!this.props.visible)return null;var t=e&&e.user&&e.user.campaignProperties&&e.user.campaignProperties.domains&&e.user.campaignProperties.domains.length>0||!1,n=e&&e.user?e.user.displayName:null,i=e&&e.user?e.user.profileImageURL:null;return s.createElement(te,{allEmoteSets:this.state.allEmoteSets,channelCampaignEmotes:this.state.channelCampaignEmotes,channelDisplayName:n,channelID:this.props.channelOwnerID,channelProfileImageURL:i,channelSubEmotes:this.state.channelSubEmotes,channelSubscriptionProducts:this.state.channelSubscriptionProducts,direction:this.props.direction,emotePickerSessionID:this.props.emotePickerSessionID,emotePickerSource:this.props.emotePickerSource,frequentlyUsedEmotes:this.state.frequentlyUsedEmotes,globalEmotes:this.state.globalEmotes,gqlError:this.state.gqlError,handleSubAction:this.handleSubEvent,isEsportChannel:t,isLoggedIn:this.props.isLoggedIn,loading:this.state.gqlLoading,onClickEmote:this.props.onClickEmote,ownedSetIDs:this.state.ownedSetIDs,otherChannelEmoteSets:this.state.otherChannelEmoteSets,roomID:this.props.roomID,size:this.props.size,toggleVisibility:this.props.toggleVisibility,unlockedEmotes:this.state.unlockedEmotes})},t.prototype.checkDataLoaded=function(e){var t=!e.channelOwnerID||e.channelData&&!e.channelData.loading,n=!e.isLoggedIn||e.emoteSetsData&&!e.emoteSetsData.loading;return t&&n},t.prototype.checkForContent=function(e){var t=e.emoteSetsData,n=e.channelData;return!!(t&&t.emoteSets&&t.emoteSets.length>0)||!!(n&&n.user&&n.user.subscriptionProducts)&&e.channelData.user.subscriptionProducts.filter(function(e){return null!==e}).filter(this.subscriptionProductHasEmotes).length>0},t.prototype.applyDataPropsToState=function(e,t){var n,i=a.__assign({},t);if(e.emoteSetsData&&e.emoteSetsData.emoteSets&&e.emoteSetsData.emoteSets.length>0){i.ownedSetIDs=new Set;for(var r=0,s=e.emoteSetsData.emoteSets;r<s.length;r++){var o=s[r];o&&o.id&&i.ownedSetIDs.add(parseInt(o.id,10))}var d=new Set;if(e.channelData&&e.channelData.user&&e.channelData.user.subscriptionProducts)for(var c=0,l=e.channelData.user.subscriptionProducts;c<l.length;c++){var u=l[c];u&&void 0!==u.emoteSetID&&null!==u.emoteSetID&&d.add(u.emoteSetID)}i.allEmoteSets=Object(C.a)(e.emoteSetsData.emoteSets);var m=[],p=[],h=[],g=[];i.allEmoteSets.forEach(function(t){t.owner||"0"!==t.id?t.owner&&""!==t.owner.id?e.channelData&&e.channelData.user&&e.channelData.user.id===t.owner.id?e.channelData.user.id!==t.owner.id||d.has(t.id)||p.push.apply(p,t.emotes):m.push(t):g.push.apply(g,t.emotes):h.push.apply(h,t.emotes)}),i.channelCampaignEmotes=p,i.otherChannelEmoteSets=function(e){var t={};e.forEach(function(e){var n;e.owner&&e.owner.id&&(t[e.owner.id]?(n=t[e.owner.id].emotes).push.apply(n,e.emotes):t[e.owner.id]=a.__assign({},e))});var n=Object.keys(t),i=[];return n.forEach(function(e){i.push(t[e])}),i}(m),i.globalEmotes=h,i.unlockedEmotes=g}if(e.channelData&&e.channelData.user&&e.channelData.user.subscriptionProducts){var f=e.channelData.user.subscriptionProducts.filter(function(e){return null!==e});i.channelSubscriptionProducts=f,i.channelSubEmotes=(n=i.ownedSetIDs,f.reduce(function(e,t){if(null===t.emotes||null===t.emoteSetID)return e;var i=Object(C.b)(t.emotes);return e.concat(i.map(function(e){return a.__assign({},e,{isLocked:!n.has(parseInt(t.emoteSetID,10))})}))},[]))}else i.channelSubscriptionProducts=[];return i},t.prototype.subscriptionProductHasEmotes=function(e){return null!==e.emoteSetID&&!!e.emotes&&e.emotes.length>0},t.prototype.checkAndDisplaySubscriptionCheckout=function(){var e=d.o.get(y.a.SUB_CHECKOUT__PRODUCT_KEY,""),t=d.o.get(y.a.SUB_CHECKOUT__RECIPIENT_KEY,""),n=d.o.get(y.a.SUB_CHECKOUT__MYSTERY_GIFT_COUNT,""),i=Number(n);e&&(this.props.channelData&&this.props.channelData.user&&this.props.channelData.user.subscriptionProducts&&this.props.channelData.user.subscriptionProducts.map(function(e){return e?e.name:null}).includes(e)?this.props.sessionUser?this.props.showSubscriptionCheckout({recipientLogin:t,productName:e,mysteryGiftCount:i,trackingContext:{source:S.c.EmotePicker}}):this.props.showLoginModal():y.a.clearSubscriptionCheckoutKeys())},t}(s.PureComponent);var re=Object(m.compose)(Object(r.connect)(function(e){return{currentUserID:e.session.user&&e.session.user.id,emotePickerSessionID:e.chat&&e.chat.emotePickerSessionID||null,sessionUser:e.session.user,isLoggedIn:Object(k.f)(e)}},function(e){return Object(m.bindActionCreators)({closeEmotePicker:v.B,openEmotePicker:v.N,showLoginModal:y.a.showLoginModalWithCheckoutDispatch(f.a.EmotePickerSubscriptionButton),showSubscriptionCheckout:b.a},e)}),Object(p.a)(ne,{name:"channelData",skip:function(e){return!e.channelOwnerID},options:function(e){return{variables:{channelOwnerID:e.channelOwnerID}}}}),Object(h.a)([{topic:function(e){return"user-subscribe-events-v1."+e.currentUserID},mapMessageTypesToProps:{"*":"subscriptionInfo"},skip:function(e){return!e.currentUserID}}]),Object(N.withLatencyTracking)("EmotePicker"),Object(g.a)())(ie),ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasInteracted:!1,isEmotePickerMenuVisible:!1,isEmotePickerButtonVisible:!1},t.onClickOut=function(){t.setState({isEmotePickerMenuVisible:!1})},t.onClickEmote=function(e,n){t.props.onClickEmote&&t.props.onClickEmote(e,n)},t.toggleEmotePicker=function(){t.setState(function(e){return{isEmotePickerMenuVisible:!e.isEmotePickerMenuVisible}})},t.onEmotePickerDataLoaded=function(e){e&&t.setState({isEmotePickerButtonVisible:!0})},t.onInteraction=function(){return t.setState({hasInteracted:!0})},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.props.latencyTracking.reportInteractive(),this.props.inputRef&&(this.props.inputRef.addEventListener("mouseenter",this.onInteraction),this.props.inputRef.addEventListener("focus",this.onInteraction))},t.prototype.componentWillUnmount=function(){this.props.inputRef&&(this.props.inputRef.removeEventListener("mouseenter",this.onInteraction),this.props.inputRef.removeEventListener("focus",this.onInteraction))},t.prototype.render=function(){var e=null;this.state.isEmotePickerButtonVisible&&(e=s.createElement(u,{onClick:this.toggleEmotePicker,isActive:this.state.isEmotePickerMenuVisible}));var t=null;this.hasInteractedOrPageload&&(t=s.createElement(re,{channelOwnerID:this.props.channelOwnerID,emotePickerSource:this.props.emotePickerSource,onClickEmote:this.onClickEmote,onLoad:this.onEmotePickerDataLoaded,toggleVisibility:this.toggleEmotePicker,visible:this.state.isEmotePickerMenuVisible,direction:this.props.direction}));var n=s.createElement(O.a,a.__assign({className:"emote-picker-and-button"},this.layoutProps),e,t);return this.props.shouldCloseOnClickOut?s.createElement(o.a,{onClickOut:this.onClickOut},n):n},Object.defineProperty(t.prototype,"hasInteractedOrPageload",{get:function(){return!(!this.props.firstPageLoaded&&!this.state.hasInteracted)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutProps",{get:function(){var e={attachTop:!!this.props.attachTop,attachRight:!!this.props.attachRight,attachBottom:!!this.props.attachBottom,attachLeft:!!this.props.attachLeft,padding:this.props.padding};return this.props.position&&(e.position=this.props.position),e},enumerable:!0,configurable:!0}),t}(s.Component),se=Object(N.withLatencyTracking)("EmotePicker")(ae);var oe=Object(r.connect)(function(e){return{firstPageLoaded:e.session.firstPageLoaded}})(se),de=n("cpJf");n.d(t,"a",function(){return oe}),n.d(t,"c",function(){return re}),n.d(t,!1,function(){return de.a}),n.d(t,!1,function(){return de.c}),n.d(t,!1,function(){return de.b}),n.d(t,"b",function(){return u})},nR4f:function(e,t,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"EmoteCard"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"emoteID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"emote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"emoteID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subscriptionProduct"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"subProduct"},directives:[]}]}}]}}]}}],loc:{start:0,end:192}};i.loc.source={body:'#import "twilight/features/chat/components/emote-card/emote-subscription-product.gql"\nquery EmoteCard ($emoteID: ID!) {\nemote(id: $emoteID) {\nid\ntoken\nsubscriptionProduct {\n...subProduct\n}\n}\n}',name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};i.definitions=i.definitions.concat(n("HfAM").definitions.filter(function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!r[t]&&(r[t]=!0,!0)})),e.exports=i},oK83:function(e,t,n){"use strict";var i,r,a;n.d(t,"a",function(){return i}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),function(e){e[e.unknown=0]="unknown",e[e.chat=1]="chat",e[e.room=2]="room",e[e.whisper=3]="whisper",e[e.vod=4]="vod"}(i||(i={})),function(e){e[e.chat_message=0]="chat_message",e[e.extension_message=1]="extension_message",e[e.member_list=2]="member_list",e[e.recent_raids=3]="recent_raids",e[e.room_message=4]="room_message",e[e.test=5]="test",e[e.user_command=6]="user_command",e[e.viewer_list=7]="viewer_list",e[e.viewer_list_mod_section=8]="viewer_list_mod_section",e[e.mega_cheer_notification=9]="mega_cheer_notification",e[e.bits_leaderboard=10]="bits_leaderboard",e[e.popout_button=11]="popout_button"}(r||(r={})),function(e){e[e.Viewer=0]="Viewer",e[e.Extension=1]="Extension",e[e.Emote=2]="Emote"}(a||(a={}))},oe5X:function(e,t,n){"use strict";var i=n("XmgI"),r=n("RcPG"),a=n("0FG4"),s=n("mrSG"),o=n("VJH5");var d=n("i6WW"),c=n("gTu3"),l=n("6j5V"),u=/^(['"*([{<\/]*)(@?)((?:[^\u0000-\u007F]|[\w-])+)/;function m(e,t){if(!t)return!1;var n=t.displayName,i=t.login;return e===n||e.toLowerCase()===i}function p(e,t){void 0===t&&(t={});for(var n=f(e),i=function(e){if(!e)return[];var t=e.list.filter(function(t){return t.categories[o.a.Aggressive]&&e.preferences[o.a.Aggressive]||t.categories[o.a.Identity]&&e.preferences[o.a.Identity]||t.categories[o.a.Profanity]&&e.preferences[o.a.Profanity]||t.categories[o.a.Sexual]&&e.preferences[o.a.Sexual]});return 0===t.length?t:(t.sort(function(e,t){return e.startIndex-t.startIndex}),t.reduce(function(e,t,n){if(0===n)return e.push(t),e;var i=e[e.length-1];return t.startIndex<=i.endIndex+1?(i.endIndex=Math.max(t.endIndex,i.endIndex),i.categories=s.__assign({},i.categories,t.categories)):e.push(t),e},[]))}(t.flags),a=0,d=[];a<n.length;){var c=i&&i.shift();c?(d.push.apply(d,h(n.slice(a,c.startIndex),a,t)),d.push({type:r.a.FlaggedSegment,categories:c.categories,content:g(h(n.slice(c.startIndex,c.endIndex+1),c.startIndex,t)),length:c.endIndex-c.startIndex+1,originalText:n.slice(c.startIndex,c.endIndex+1).join("")}),a=c.endIndex+1):(d.push.apply(d,h(n.slice(a),a,t)),a=n.length)}return g(d)}function h(e,t,n){void 0===n&&(n={});var s=n.cheers,o=n.emotes,p=n.links,h=n.mentions,g="",f=0;return e.reduce(function(n,v,b){if(k(v))return g="",n;if(0===g.length&&(f=t+b),g+=v,b!==e.length-1&&!k(e[b+1]))return n;var y=o&&Object(a.c)(g,f,o);if(y)return n.concat(y);var S=s&&Object(i.f)(g,s);if(S)return n.concat(S);var _=p&&Object(d.a)(g,p);if(_)return n.concat(_);var C=h&&function(e,t){var n=e.match(u);if(!n)return null;var i=[],a=n[1],s=Boolean(n[2].length),o=n[3],d=e.slice(n[0].length);if(a.length&&i.push(Object(l.a)(a)),s){var p=c.a.Default;m(o,t.sessionUser)?p=c.a.Recipient:t.sessionUser&&t.sessionUser.login===t.senderLogin&&(p=c.a.Sender),i.push({type:r.a.Mention,content:{recipient:o,currentUserMentionRelation:p}})}else{if(!m(o,t.sessionUser))return null;i.push({type:r.a.CurrentUserHighlight,content:o})}return d.length&&i.push(Object(l.a)(d)),i}(g,h);return C?n.concat([C]):n.concat(Object(l.a)(g))},[])}function g(e){return e.reduce(function(e,t,n){return 0===n?[].concat.call(e,t):[].concat.call(e,Object(l.a)(" "),t)},[]).reduce(function(e,t,n){if(0===n)return e.concat(t);var i=e[e.length-1];return t.type===r.a.Text&&i.type===r.a.Text?(i.content=""+i.content+t.content,e):e.concat(t)},[])}function f(e){return e.match(/[^\uD800-\uDFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDFFF]/g)||[]}function k(e){return/\s/.test(e)}n.d(t,"a",function(){return p}),n.d(t,!1,function(){return g}),n.d(t,!1,function(){return f})},okS7:function(e,t,n){"use strict";n("kPBf");var i,r=n("mrSG"),a=n("q1tI"),s=n("8Ad5"),o=n("1rIY"),d=n("TSYQ"),c=n("/7QA"),l=n("u5aL"),u=n("8/mp"),m=n("X2PJ"),p=n("sUnt"),h=n("hnjF"),g=n("ygYM"),f=n("+80q"),k=(n("JzSO"),"autocomplete-balloon-matches"),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.resizeAnimationFrame=0,t.messages={noMatches:Object(c.d)("No matches.","AutocompleteBalloon")},t.logger=c.k.withCategory("AutocompleteBalloon"),t.renderMatches=function(){return t.props.matches.map(function(e,n){var i=t.state.selectedMatch,r=i&&i.replacement===e.replacement,s=d("autocomplete-balloon__item",{"autocomplete-balloon__item--selected":r});return a.createElement(p.a,{key:"autocomplete-match-"+n,refDelegate:r?t.focusOnOption:void 0,"data-test-selector":k},a.createElement(h.g,{display:h.d.Block,fullWidth:!0},a.createElement("button",{onMouseEnter:t.handleMatchMouseEnter,className:s,"data-a-target":e.replacement,"data-click-index":n,onClick:t.onMatchClick},a.createElement(p.a,{padding:{x:.5},display:h.d.Flex,alignItems:h.b.Center},e.element))))})},t.handleMatchMouseEnter=function(e){var n=t.getMatchFromEvent(e);n&&t.setState({selectedMatch:n})},t.onMatchClick=function(e){var n=t.getMatchFromEvent(e);n&&t.props.onMatchSelect(n)},t.getMatchFromEvent=function(e){var n=t.props.matches,i=e.currentTarget.getAttribute("data-click-index");return!i||+i>=n.length?(t.logger.error(new Error,"The index received from the UI element was not found in props.matches."),null):n[+i]},t.handleKeydown=function(e){var n=e.charCode||e.keyCode,i=function(){e.preventDefault(),e.stopPropagation()};switch(n){case s.a.Tab:case s.a.Enter:i(),t.props.matches.length&&t.state.selectedMatch?t.props.onMatchSelect(t.state.selectedMatch):t.props.onDismiss();break;case s.a.Up:case s.a.Down:if(!t.state.selectedMatch||!t.props.matches.length)return;var r=t.props.matches.indexOf(t.state.selectedMatch);if(-1===r)return void t.logger.error(new Error,"The selected match was not found in props.matches.");i();var a=n===s.a.Up?-1:1,o=t.getIndexWithinLength(r+a,t.props.matches.length),d=t.props.matches[o];t.setState({selectedMatch:d})}},t.getIndexWithinLength=function(e,t){var n=e%t;return n<0?n+t:n},t.onResize=function(){t.resizeAnimationFrame||(t.resizeAnimationFrame=requestAnimationFrame(t.setContainerHeight))},t.setContainerHeight=function(){var e=t.props.containerElement&&t.props.containerElement.clientHeight||1080;t.setState({containerHeight:e}),t.resizeAnimationFrame=0},t.focusOnOption=function(e){if(e&&t.autocompleteBalloonElement){var n=e.getBoundingClientRect(),i=t.autocompleteBalloonElement.getBoundingClientRect();(n.bottom>i.bottom||n.top<i.top)&&e.scrollIntoView()}},t.setAutocompleteBalloonElement=function(e){t.autocompleteBalloonElement=e},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("keydown",this.handleKeydown,!0),window.addEventListener("resize",this.onResize,!0),this.setContainerHeight(),this.props.matches.length>0&&this.setState({selectedMatch:this.props.matches[0]})},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.onResize,!0),window.removeEventListener("keydown",this.handleKeydown,!0),this.resizeAnimationFrame&&cancelAnimationFrame(this.resizeAnimationFrame)},t.prototype.componentWillReceiveProps=function(e){var t=this,n=e.matches.reduce(function(e,n,i){return t.state.selectedMatch?n.replacement===t.state.selectedMatch.replacement?i:e:0},0);this.setState({selectedMatch:e.matches[n]})},t.prototype.render=function(){var e;return e=0===this.props.matches.length?a.createElement(p.a,{padding:{x:.5},"data-test-selector":"autocomplete-balloon-no-matches"},a.createElement(f.a,{type:f.e.Span,color:m.c.Alt2},this.messages.noMatches)):this.renderMatches(),a.createElement(p.a,{position:h.j.Relative},a.createElement(l.a,{onClickOut:this.props.onDismiss},a.createElement(g.a,{direction:g.b.TopLeft,"data-a-target":"autocomplete-balloon","data-test-selector":"autocomplete-balloon",show:!0},a.createElement(h.g,{"data-test-selector":"autocomplete-matches-container",className:"autocomplete-balloon",overflow:h.i.Hidden,display:h.d.Flex,flexDirection:h.e.Column},a.createElement("div",{style:{maxHeight:this.state.containerHeight},ref:this.setAutocompleteBalloonElement},a.createElement(u.b,null,a.createElement(p.a,{padding:{y:1}},e)))))))},t}(a.Component),b=n("uu1w"),y=n("2xye"),S={Chat:"chat",Feed:"feed",Whisper:"whisper"},_=":",C="#",E="@",N=function(e){switch(e){case b.a.Emote:return _;case b.a.Hashtag:return C;case b.a.Mention:return E;default:return void c.k.warn("Chat Suggestions tracking was passed an unknown autocomplete type.")}},D=function(e){var t=N(e.autocompleteType);if(t){var n={channel:e.channelLogin,completed_text:e.completedText,source:e.source,start_character:t};c.p.track(y.SpadeEventType.ChatSuggestionComplete,n)}},I=n("3aAs"),T=n("Kae6");!function(e){e.Input="input",e.TextArea="textarea"}(i||(i={}));var w=Object(o.a)("Autocomplete",{registerAutocompleteProvider:function(){return function(){return null}}}),F=w.withContext,O=w.InnerProvider,M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={autocompleteType:b.a.None,matchedCursorPosition:0,matches:null,value:""},t.providers=[],t.contextForChildren={registerAutocompleteProvider:t.registerAutocompleteProvider.bind(t)},t.onChange=function(e){t.setState({value:e.target.value},function(){t.getMatches()}),t.props.onChange&&t.props.onChange(e)},t.onKeyDown=function(e){var n=function(){t.props.onKeyDown&&t.props.onKeyDown(e)},i=function(){e.preventDefault(),e.stopPropagation()},r=e.charCode||e.keyCode;if(r!==s.a.Enter){switch(r){case s.a.Tab:if(!t.state.matches)t.getMatches(!0)&&i();break;case s.a.Esc:t.state.matches&&(i(),t.resetDisplayState())}n()}else n()},t.setComponentRefDelegate=function(e){t.componentRef=e,t.props.componentRefDelegate&&t.props.componentRefDelegate(e)},t.getMatches=function(e){var n=t.state.value;if(0===t.providers.length||0===n.length)return t.resetDisplayState(),!1;var i=t.getCurrentCursorPosition();if(i>n.length);else for(;i<n.length&&!/\s/.test(n.charAt(i));)i++;var r=n.substring(0,i);if(0===r.length||/\s/.test(r.substring(r.length-1)))return t.resetDisplayState(),!1;for(var a=r.split(/\s/),s=a[a.length-1],o=0,d=t.providers;o<d.length;o++){var c=d[o];if(!e||c.canBeTriggeredByTab){var l=c.getMatches(s,e);if(l)return t.setState({autocompleteType:c.autocompleteType,matchedCursorPosition:i,matches:l}),!0}}return t.resetDisplayState(),!1},t.resetDisplayState=function(e,n){var i=r.__assign({},t.state,{autocompleteType:b.a.None,matches:null},e||{});t.setState(i,n)},t.insertReplacement=function(e){var n=t.state.value,i=t.state.matchedCursorPosition,a=n.substring(0,i),s=a.lastIndexOf(e.current);if(-1===s)a=a.concat(e.replacement+" "),i=a.length;else{var o=a.substring(0,s),d=n.length>s+e.current.length?n.substring(s+e.current.length):"",c=d.startsWith(" ")?e.replacement:e.replacement+" ";a=""+o+c+d,i=o.length+c.length}D(r.__assign({},t.props.trackingParams||{},{autocompleteType:t.state.autocompleteType,completedText:e.replacement,source:t.props.suggestionSource})),t.resetDisplayState({value:a},function(){t.setCursorPosition(i)})},t.getCurrentCursorPosition=function(){return t.componentRef.selectionStart||0},t.setCursorPosition=function(e){t.componentRef&&(t.componentRef.setSelectionRange(e,e),t.componentRef.focus())},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.refDelegate&&this.props.refDelegate(this)},t.prototype.componentWillUpdate=function(e,t){!this.state.matches&&t.matches&&function(e){var t=N(e.autocompleteType);if(t){var n={source:e.source,start_character:t};c.p.track(y.SpadeEventType.ChatSuggestion,n)}}({autocompleteType:t.autocompleteType,source:e.suggestionSource})},t.prototype.componentDidUpdate=function(e,t){t.value!==this.state.value&&this.props.onValueUpdate&&this.props.onValueUpdate(this.state.value)},t.prototype.render=function(){var e=r.__assign({},this.props,{onChange:this.onChange,onKeyDown:this.onKeyDown,refDelegate:this.setComponentRefDelegate,value:this.state.value});return a.createElement(O,{value:this.contextForChildren},this.state.matches&&a.createElement(v,{matches:this.state.matches,onMatchSelect:this.insertReplacement,onDismiss:this.resetDisplayState,containerElement:this.props.containerElement}),this.props.componentType===i.Input?a.createElement(I.a,r.__assign({},e,{type:e.type||I.c.Text})):a.createElement(T.a,r.__assign({},e)),this.props.children)},t.prototype.getValue=function(){return this.state.value},t.prototype.setValue=function(e){this.resetDisplayState({value:e})},t.prototype.registerAutocompleteProvider=function(e){var t=this;return this.providers.push(e),function(){var n=t.providers.indexOf(e);t.providers.splice(n,1)}},t}(a.Component),U=n("lZdE"),x=n("OpME"),R=(n("gDzh"),function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.autocompleteType=b.a.Emote,t.canBeTriggeredByTab=!1,t.getMatches=function(e){return e.startsWith(":")?e.length<3?null:t.getMatchedEmotes(e):null},t.getMatchedEmotes=function(e){var n=t.state.hydratedEmotes;if(!n||0===n.length)return null;var i=e.substring(1),r=n.reduce(function(e,n){var r=n.emotes.filter(function(e){return t.doesEmoteMatchTerm(e,i)});return e.concat(r)},[]);return r=Object(x.d)(r),(r=Object(x.e)(r,i)).map(function(e){return{current:":"+i,replacement:e.token,element:t.renderEmoteSuggestion(e)}})},t.doesEmoteMatchTerm=function(e,t){var n=new RegExp("^"+Object(U.a)(t),"i");if(e.token.match(n))return!0;var i=new RegExp(""+Object(U.a)(t.charAt(0)).toUpperCase()),r=new RegExp("^"+Object(U.a)(t.slice(1)),"i"),a=e.token.match(i);return!!(a&&a.index&&e.token.slice(a.index+1).match(r))},t.renderEmoteSuggestion=function(e){return[a.createElement(p.a,{padding:{right:.5},flexShrink:0,key:"emote-img-"+e.id},a.createElement("img",{className:"emote-autocomplete-provider__image",srcSet:e.srcSet})),a.createElement(f.a,{type:f.e.Span,key:"emote-text-"+e.id,ellipsis:!0},e.token)]},t.hydrateEmotes=function(e){for(var n=[],i=0,r=e;i<r.length;i++){var a=r[i];a&&a.id&&a.emotes&&n.push({id:a.id,emotes:Object(x.b)(a.emotes)})}t.setState({hydratedEmotes:n})},t}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){e.emotes&&this.props.emotes!==e.emotes&&this.hydrateEmotes(e.emotes)},t.prototype.componentWillMount=function(){this.hydrateEmotes(this.props.emotes)},t.prototype.componentDidMount=function(){this.unregister=this.props.registerAutocompleteProvider(this)},t.prototype.componentWillUnmount=function(){this.unregister()},t.prototype.render=function(){return null},t}(a.Component)),A=F(function(e){return e})(R);n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,"b",function(){return M}),n.d(t,"a",function(){return i}),n.d(t,!1,function(){}),n.d(t,"e",function(){return F}),n.d(t,"d",function(){return A}),n.d(t,"c",function(){return S})},pORx:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"WhisperThread_ReportUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReportWhisperThreadInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"reportWhisperThread"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thread"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:125}};n.loc.source={body:"mutation WhisperThread_ReportUser($input: ReportWhisperThreadInput!) {\nreportWhisperThread(input: $input) {\nthread {\nid\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},sU0Q:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"VideoChatCard_Video"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"videoID"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"video"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"videoID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"previewThumbnailURL"},arguments:[{kind:"Argument",name:{kind:"Name",value:"width"},value:{kind:"IntValue",value:"90"}},{kind:"Argument",name:{kind:"Name",value:"height"},value:{kind:"IntValue",value:"51"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"publishedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"owner"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"login"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:162}};n.loc.source={body:"query VideoChatCard_Video($videoID: ID!) {\nvideo(id: $videoID) {\nid\ntitle\npreviewThumbnailURL(width: 90 height: 51)\npublishedAt\nowner {\nid\nlogin\ndisplayName\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},uu1w:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e.Emote="emote",e.Mention="mention",e.Hashtag="hashtag",e.None="none"}(i||(i={}))},vGFN:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"j",function(){return k}),n.d(t,"h",function(){return v}),n.d(t,"g",function(){return b}),n.d(t,"l",function(){return y}),n.d(t,"o",function(){return S}),n.d(t,"n",function(){return _}),n.d(t,"k",function(){return C}),n.d(t,"m",function(){return E}),n.d(t,"i",function(){return N}),n.d(t,"e",function(){return D}),n.d(t,"d",function(){return I}),n.d(t,"b",function(){return T}),n.d(t,"f",function(){return w}),n.d(t,"c",function(){return F}),n.d(t,"q",function(){return M}),n.d(t,"p",function(){return U});var i,r,a,s,o,d,c=n("mrSG"),l=n("/7QA"),u=n("2xye"),m=n("mBWp");function p(e){l.q.tracking.track(u.SpadeEventType.WhisperThreadMod,{conversation_id:e.threadID,action:e.action})}function h(e){return c.__awaiter(this,void 0,void 0,function(){var t;return c.__generator(this,function(n){switch(n.label){case 0:return[4,O()];case 1:return t=n.sent(),l.q.tracking.track(u.SpadeEventType.WhisperIgnoreUser,{ui_context:e.context,from_login:t&&t.login,ignored_login:e.targetUserLogin,reason:e.reason||i.Other,source:e.source}),[2]}})})}function g(e,t){return c.__awaiter(this,void 0,void 0,function(){var n;return c.__generator(this,function(i){switch(i.label){case 0:return[4,O()];case 1:return n=i.sent(),l.q.tracking.track(u.SpadeEventType.WhisperThreadMod,{conversation_id:e,action:t,login:n&&n.login}),[2]}})})}function f(e){l.q.tracking.track(u.SpadeEventType.WhisperAllThreadsMod,{action:e})}function k(){f(r.MarkAllRead)}function v(){f(r.EnableDoNotDisturb)}function b(){f(r.DisableDoNotDisturb)}function y(e,t){h({context:t,targetUserLogin:e,reason:i.Spam,source:"conversations_button"})}function S(e){g(e,o.MarkNotSpam)}function _(e){g(e,o.Archive)}function C(e){p({threadID:e,action:a.Mute})}function E(e){p({threadID:e,action:a.Unmute})}function N(e){p({threadID:e,action:a.Expand})}function D(e){p({threadID:e,action:a.Collapse})}function I(e){p({threadID:e,action:a.Close})}function T(e){p({threadID:e,action:a.Archive})}function w(e){l.q.tracking.track(u.SpadeEventType.WhisperThreadCreate,{conversation_id:e.threadID,target_login:e.targetUserlogin,source:"search_target_result",search_result_rank:e.searchResultRank})}function F(e){l.q.tracking.track(u.SpadeEventType.WhisperSearchClick,{query:e.searchQuery,source:"conversation_list",rank:e.searchResultRank,is_conversation:e.isConversation})}function O(){var e=this;return new Promise(function(t){setTimeout(function(){return c.__awaiter(e,void 0,void 0,function(){var e,n,i;return c.__generator(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l.q.apollo.client.query({query:m})];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),l.k.error(n,"Failed to make query for current user info in WhisperSent reporting"),[3,4];case 4:return i=e&&e.data&&e.data.currentUser,t(i),[2]}})})})})}function M(e){return c.__awaiter(this,void 0,void 0,function(){var t;return c.__generator(this,function(n){switch(n.label){case 0:return[4,O()];case 1:return t=n.sent(),l.q.tracking.track(u.SpadeEventType.WhisperSent,{to:e.targetUserLogin,from:t&&t.login,player:"web",is_turbo:t&&t.hasTurbo,conversation_id:e.threadID,availability:t&&t.availability,room_type:e.inChannelChat?d.Channel:d.Conversation}),[2]}})})}function U(e){return c.__awaiter(this,void 0,void 0,function(){var t;return c.__generator(this,function(n){switch(n.label){case 0:return[4,O()];case 1:return t=n.sent(),l.q.tracking.track(u.SpadeEventType.WhisperReceived,{to:t&&t.login,from:e.targetUserLogin,player:"web",is_turbo:t&&t.hasTurbo,conversation_id:e.threadID}),[2]}})})}!function(e){e.Harassment="Harassment",e.Spam="Spam",e.Other="Other"}(i||(i={})),function(e){e.MarkAllRead="mark_all_read",e.EnableDoNotDisturb="do_not_disturb_on",e.DisableDoNotDisturb="do_not_disturb_off"}(r||(r={})),function(e){e.Mute="mute",e.Unmute="unmute",e.Expand="maximize",e.Collapse="minimize",e.Close="close",e.Archive="archive",e.Open="open"}(a||(a={})),function(e){e.Dock="dock",e.SpamPropmt="dock_spam_cta"}(s||(s={})),function(e){e.Archive="archive",e.MarkNotSpam="mark_not_spam"}(o||(o={})),function(e){e.Channel="channel",e.Conversation="conversation"}(d||(d={}))},w1PT:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("/7QA"),r=n("ZS2+"),a=n("SDEh"),s=n("aCAx"),o=n("8EUQ"),d="core.ui.CHECKOUT_SHOWN";function c(e){if(Object(a.b)()){try{o.a.clearSubscriptionCheckoutKeys(),function(e){if(!e.productName)return void i.k.warn("No productName provided");var t=new URL("https://www.twitch.tv/products/"+e.productName);e.recipientLogin?t.searchParams.append("recipient",e.recipientLogin):e.mysteryGiftCount&&t.searchParams.append("gift_count",e.mysteryGiftCount.toString());e.isAnonymous&&t.searchParams.append("is_anonymous",e.isAnonymous.toString());e.isOneTimePurchase&&t.searchParams.append("is_one_time_purchase",e.isOneTimePurchase.toString());window.open(t.toString(),"_blank")}(e)}catch(e){i.k.error(e,"Failed to open subscription checkout externally")}return function(e){e({type:d})}}return function(t){t(Object(s.d)(r.a,{component:"CheckoutModal",loader:function(){return Promise.all([n.e(0),n.e(781)]).then(n.bind(null,"KJv/"))},componentProps:e}))}}},"x0+1":function(e,t,n){"use strict";var i=n("mrSG"),r=n("q1tI"),a=n("/7QA"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={alwaysShowMessage:!1},t.renderBody=function(){return t.state.alwaysShowMessage?t.props.messageBody:r.createElement("span",{key:"deleted",className:"chat-line__message--deleted"},r.createElement("a",{href:"",onClick:t.alwaysShowMessage},"<"+Object(a.d)("click to show","MessageDeletedLine")+">"))},t.alwaysShowMessage=function(e){e&&e.preventDefault(),t.setState({alwaysShowMessage:!0})},t}return i.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.moderatorLogin,n=e.targetIsCurrentUser,i=this.props.targetLogin;return n?Object(a.d)("A moderator deleted your message: {body}",{body:this.renderBody()},"MessageDeletedLine"):t?Object(a.d)("{moderatorLogin} deleted {targetLogin}'s message: {body}",{moderatorLogin:t,targetLogin:i,body:this.renderBody()},"MessageDeletedLine"):Object(a.d)("A moderator deleted {targetLogin}'s message: {body}",{targetLogin:i,body:this.renderBody()},"MessageDeletedLine")},t}(r.Component);n.d(t,"a",function(){return s})},xXlL:function(e,t,n){"use strict";function i(e){return{id:""+e.id,start:e.start,end:e.end}}function r(e){return{__typename:"WhisperMessageEdge",cursor:""+e.data_object.id,node:{__typename:"WhisperMessage",id:e.data_object.message_id,nonce:e.data_object.nonce,sentAt:new Date(1e3*e.data_object.sent_ts).toISOString(),editedAt:null,deletedAt:null,content:{__typename:"MessageBody",content:e.data_object.body,emotes:e.data_object.tags.emotes.map(function(e){return s(i(e))})},from:{__typename:"User",id:""+e.data_object.from_id}}}}function a(e){return e.map(function(e){return s(i(e))})}function s(e){return{from:e.start,to:e.end,emoteID:e.id,id:e.id+";"+e.start+";"+e.end,setID:"0",__typename:"EmbeddedEmote"}}n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return s})},zixI:function(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UnblockUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UnblockUserInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"unblockUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"targetUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:100}};n.loc.source={body:"mutation UnblockUser($input: UnblockUserInput!) {\nunblockUser(input: $input) {\ntargetUser {\nid\n}\n}\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=n},zyUW:function(e,t,n){}}]);