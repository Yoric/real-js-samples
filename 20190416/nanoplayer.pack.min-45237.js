!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NanoPlayer=t():e.NanoPlayer=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r,i;r=[n(1)],i=function(e){return window.NanoPlayer=e,e}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(3),n(9),n(5),n(6),n(7),n(8),n(2),n(18),n(14),n(96),n(23),n(97)],i=function(e,t,n,r,i,o,a,s,u,c,d,f){"use strict";function E(t){d.validatePlayerDivId(t),this.version=s.CORE,console.debug("NanoCore api version: "+this.version),this.type="default",this.id=Math.round(1e11*Math.random()).toString(),this._playerDivId=t,this._dummyPlayer=new e(this._playerDivId),this._realPlayer=this._dummyPlayer}var l=E.prototype=Object.create(e.prototype);return l.setup=function(e){return new f(function(n,r){var a=e&&e.events&&e.events.onError?e.events.onError:null,s=function(e){e.code||(e.code=u.SETUP.EXCEPTION),e.message||(e.message="An unknown error occured during setup.");var t={name:"Error",data:{code:e.code,message:e.message},player:this._playerDivId,id:this.id,version:this.version,state:o.IDLE};a&&this.on(t.name,a),this.emit(t.name,t),r(e)}.bind(this),d=function(e){n(e)};try{this._realPlayer&&this._realPlayer!==this._dummyPlayer&&(this._realPlayer.destroy(),this._realPlayer=this._dummyPlayer),t.create(this._playerDivId,e).then(function(t){this.version=t.version,this.type=t.type,this._realPlayer=t,this._realPlayer.id=this.id,this._propagator=c.create(t,i,this),this._realPlayer.setup(e).then(function(e){window.onunload=function(e){this._realPlayer.destroy()}.bind(this),d(e)}.bind(this),s)}.bind(this),function(e){s(e)})}catch(e){s(e)}}.bind(this))},l.destroy=function(){this._realPlayer.destroy()},l.play=function(){this._realPlayer.play()},l.pause=function(){this._realPlayer.pause()},l.mute=function(){this._realPlayer.mute()},l.unmute=function(){this._realPlayer.unmute()},l.setVolume=function(e){this._realPlayer.setVolume(e)},l.updateSource=function(e){return this._realPlayer.updateSource(e)},E.events=i,E.states=o,E.emptyConfig=n,E.validConfig=r,E.pauseReasons=a,E.errorCodes=u,E.version=s.CORE,E.capabilities=t.capabilities,E}.apply(t,r),/**
	 * @license
	 * nanoStream Player Core
	 * Copyright (c) 2016 nanocosmos IT GmbH. All rights reserved.
	 * http://www.nanocosmos.de
	 * sales@nanocosmos.de
	 *
	 * LEGAL NOTICE:
	 * This material is subject to the terms and conditions defined in
	 * separate license conditions ('LICENSE.txt')
	 * All information contained herein is, and remains the property
	 * of nanocosmos GmbH and its suppliers if any. The intellectual and technical concepts
	 * contained herein are proprietary to nanocosmos GmbH, and are protected by trade secret
	 * or copyright law. Dissemination of this information or reproduction of this material
	 * is strictly forbidden unless prior written permission is obtained from nanocosmos.
	 * All modifications will remain property of nanocosmos.
	 */
!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({NORMAL:"normal",BUFFER:"buffer",CONNECTION_CLOSE:"connectionclose",SERVER_NOT_FOUND:"servernotfound",STREAM_NOT_FOUND:"streamnotfound",INTERACTION_REQUIRED:"interactionrequired",PLAYBACK_SUSPENDED:"playbacksuspended",PLAYBACK_ERROR:"playbackerror",RECONNECTION_IMMINENT:"reconnectionimminent",DESTROY:"destroy",PLAYBACK_RESTART:"playbackrestart",VISIBILITY_HIDDEN:"visibilityhidden",NOT_ENOUGH_DATA:"notenoughdata",SOURCE_STREAM_STOPPED:"sourcestreamstopped"})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(4)],i=function(e){"use strict";function t(){this.version=void 0,this.type=void 0}var n=t.prototype=Object.create(e.prototype);return n.setup=function(){throw new Error('"setup" must be implemented or player not initialized')},n.destroy=function(){throw new Error('"destroy" must be implemented or player not initialized')},n.play=function(){throw new Error('"play" must be implemented or player not initialized by call setup')},n.pause=function(){throw new Error('"pause" must be implemented or player not initialized by call setup')},n.mute=function(){throw new Error('"mute" must be implemented or player not initialized by call setup')},n.unmute=function(){throw new Error('"unmute" must be implemented or player not initialized by call setup')},n.setVolume=function(){throw new Error('"setVolume" must be implemented or player not initialized by call setup')},n.updateSource=function(){throw new Error('"updateSource" must be implemented or player not initialized by call setup')},t.isSupported=function(){return!1},t.supportedTechniques=[],t}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){"use strict";function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var r=e.prototype;return r.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},r.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},r.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},r.addListener=function(e,n){var r,i=this.getListenersAsObject(e),o="object"==typeof n;for(r in i)i.hasOwnProperty(r)&&t(i[r],n)===-1&&i[r].push(o?n:{listener:n,once:!1});return this},r.on=n("addListener"),r.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},r.once=n("addOnceListener"),r.defineEvent=function(e){return this.getListeners(e),this},r.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},r.removeListener=function(e,n){var r,i,o=this.getListenersAsObject(e);for(i in o)o.hasOwnProperty(i)&&(r=t(o[i],n),r!==-1&&o[i].splice(r,1));return this},r.off=n("removeListener"),r.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},r.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},r.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},r.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},r.removeAllListeners=n("removeEvent"),r.emitEvent=function(e,t){var n,r,i,o,a,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(n=s[o].slice(0),i=n.length;i--;)r=n[i],r.once===!0&&this.removeListener(e,r.listener),a=r.listener.apply(this,t||[]),a===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},r.trigger=n("emitEvent"),r.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return t.length?t.length&&"object"!=typeof t[0]?t[0]={name:e,data:t[0]}:t.length&&!t[0].hasOwnProperty("data")?t[0]={name:e,data:t[0]}:t[0].name=e:t.push({name:e,data:{}}),this.emitEvent(e,t)},r.emitSimple=function(e,t,n){return this.emitEvent(e,[{name:e||"AnonymousEvent",target:n||this,data:t||{}}])},r.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},r._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},r._getEvents=function(){return this._events||(this._events={})},e}.apply(t,r),/*!
	 * EventEmitter v4.2.11 - git.io/ee
	 * Unlicense - http://unlicense.org/
	 * Oliver Caldwell - http://oli.me.uk/
	 * @preserve
	 */
!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(){return{playback:{autoplay:!0,automute:!1,muted:!1,metadata:!1,forceTech:"",flashplayer:"",videoId:"",keepConnection:!1,reconnect:{minDelay:2,maxDelay:10,delaySteps:10,maxRetries:10},timeouts:{loading:20,buffering:20,connecting:5}},source:{hls:"",h5live:{server:{websocket:"",progressive:"",hls:""},token:"",rtmp:{url:"",streamname:""},security:{token:"",expires:"",options:"",tag:""},params:{}}},events:{onReady:void 0,onPlay:void 0,onPause:void 0,onLoading:void 0,onStartBuffering:void 0,onStopBuffering:void 0,onError:void 0,onMetaData:void 0,onFullscreenEnter:void 0,onFullscreenExit:void 0,onPlaybackFinished:void 0,onMedia:void 0,onStats:void 0,onMute:void 0,onUnmute:void 0,onVolumeChange:void 0,onStreamInfo:void 0,onStreamInfoUpdate:void 0,onWarning:void 0,onDestroy:void 0},tweaks:{buffer:{min:void 0,start:void 0,max:void 0,target:void 0,limit:void 0},bufferDynamic:{offsetThreshold:void 0,offsetStep:void 0,cooldownTime:void 0}}}}return{create:e}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(){return{source:{hls:"string",h5live:{server:{websocket:"string",progressive:"string",hls:"string"},token:"string",rtmp:{url:"string",streamname:"string"},params:"object",security:{token:"string",expires:"string",options:"string",tag:"string"}}},playback:{autoplay:"boolean",automute:"boolean",muted:"boolean",forceTech:"string",metadata:"boolean",flashplayer:"string",videoId:"string",keepConnection:"boolean",reconnect:{minDelay:"number",maxDelay:"number",delaySteps:"number",maxRetries:"number"},timeouts:{loading:"number",buffering:"number",connecting:"number"}},events:{onReady:"function",onPlay:"function",onPause:"function",onLoading:"function",onStartBuffering:"function",onStopBuffering:"function",onError:"function",onMetaData:"function",onStats:"function",onMute:"function",onUnmute:"function",onVolumeChange:"function",onStreamInfo:"function",onStreamInfoUpdate:"function",onWarning:"function",onDestroy:"function"},tweaks:{buffer:{max:"number",min:"number",start:"number",target:"number",limit:"number"},bufferDynamic:{offsetThreshold:"number",offsetStep:"number",cooldownTime:"number"}}}}return{create:e}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({READY:"Ready",ERROR:"Error",PAUSE:"Pause",LOADING:"Loading",START_BUFFERING:"StartBuffering",STOP_BUFFERING:"StopBuffering",PLAY:"Play",METADATA:"MetaData",STATS:"Stats",PLAYBACK_FINISHED:"PlaybackFinished",MEDIA:"Media",STREAM_INFO:"StreamInfo",STREAM_INFO_UPDATE:"StreamInfoUpdate",MUTE:"Mute",UNMUTE:"Unmute",VOLUME_CHANGE:"VolumeChange",STATE_CHANGE:"StateChange",WARNING:"Warning",DESTROY:"Destroy"})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({UNINITIALIZED:1,IDLE:2,READY:3,LOADING:4,PLAYING:5,PAUSED:6,BUFFERING:7,UNKNOWN:8,PLAYBACK_NOT_STARTED:9,PLAYBACK_SUSPENDED:10,PAUSING:11,PLAYBACK_ERROR:12,RECONNECTION_IMMINENT:13,CONNECTION_ERROR:14,DESTROYING:15,PLAYBACK_RESTARTING:16,VISIBILITY_HIDDEN:17,NOT_ENOUGH_DATA:18,SOURCE_STREAM_STOPPED:19})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(10),n(11),n(12),n(95),n(24),n(14)],i=function(e,t,n,r,i,o){function a(e){var n=e.filter(function(e){return e.isSupported()});if(!n.length)throw new t(r.CLIENT_NOT_SUPPORTED,o.SETUP.CLIENT_NOT_SUPPORTED);return n}function s(e,n){var a={};a[i.H5LIVE_WSS]="h5live",a[i.H5LIVE_HLS]="h5live",a[i.FLASH]="h5live",a[i.NATIVE]="hls";var s=[],u=e.filter(function(e){var t=!1;return e.supportedTechniques.forEach(function(e){s.push(a[e]),t===!1&&(t=n.hasOwnProperty("source")&&n.source.hasOwnProperty(a[e]))}),t});if(!u.length)throw new t(r.SOURCE_NOT_SUPPORTED,o.SETUP.SOURCE_NOT_SUPPORTED);return u}function u(e,n){var i=[],a=function(e,t){return e.indexOf(t)!==-1||t.indexOf(e)!==-1},s=e.filter(function(e){i=i.concat(e.supportedTechniques);var t=!1;return e.supportedTechniques.forEach(function(e){t===!1&&(t=!n.playback.forceTech||a(e,n.playback.forceTech))}),t});if(!s.length)throw new t(r.FORCE_NOT_SUPPORTED.replace("$tech$",n.playback.forceTech),o.SETUP.FORCE_NOT_SUPPORTED);return s}function c(e,t){var n=e[0];return new n(t)}function d(e,t){return new Promise(function(r,i){var o=n;try{o=a(o),o=s(o,t),o=u(o,t),r(c(o,e))}catch(e){i(e)}})}function f(){var e=[];return n.filter(function(e){return e.isSupported()}).forEach(function(t){e=e.concat(t.supportedTechniques)}),e}return{create:d,capabilities:f()}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){"use strict";var e="Unknown",t="";if(screen.width){var n=screen.width?screen.width:"",r=screen.height?screen.height:"";t+=""+n+" x "+r}var i,o,a,s=navigator.appVersion,u=navigator.userAgent,c=navigator.appName,d=""+parseFloat(navigator.appVersion),f=parseInt(navigator.appVersion,10);(o=u.indexOf("Opera"))!==-1&&(c="Opera",d=u.substring(o+6),(o=u.indexOf("Version"))!==-1&&(d=u.substring(o+8))),(o=u.indexOf("OPR/"))!==-1?(c="Opera",d=u.substring(o+4)):(o=u.indexOf("MSIE"))!==-1?(c="Microsoft Internet Explorer",d=u.substring(o+5)):"Netscape"===c&&(o=u.indexOf("Trident/"))!==-1?(c="Microsoft Internet Explorer",d=u.substring(o+8),(o=u.indexOf("rv:"))!==-1&&(d=u.substring(o+3))):"Netscape"===c&&(o=u.indexOf("Edge/"))!==-1?(c="Microsoft Edge",d=u.substring(o+5)):(o=u.indexOf("Chrome"))!==-1?(c="Chrome",d=u.substring(o+7)):(o=u.indexOf("PhantomJS"))!==-1?(c="PhantomJS",d=u.substring(o+10)):(o=u.indexOf("Safari"))!==-1?(c="Safari",d=u.substring(o+7),(o=u.indexOf("Version"))!==-1&&(d=u.substring(o+8)),u.indexOf("CriOS")!==-1&&(c="Chrome")):(o=u.indexOf("Firefox"))!==-1?(c="Firefox",d=u.substring(o+8)):(i=u.lastIndexOf(" ")+1)<(o=u.lastIndexOf("/"))&&(c=u.substring(i,o),d=u.substring(o+1),c.toLowerCase()===c.toUpperCase()&&(c=navigator.appName)),(a=d.indexOf(";"))!==-1&&(d=d.substring(0,a)),(a=d.indexOf(" "))!==-1&&(d=d.substring(0,a)),(a=d.indexOf(")"))!==-1&&(d=d.substring(0,a)),f=parseInt(""+d,10),isNaN(f)&&(d=""+parseFloat(navigator.appVersion),f=parseInt(navigator.appVersion,10));var E=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(s),l=!!navigator.cookieEnabled;"undefined"!=typeof navigator.cookieEnabled||l||(document.cookie="testcookie",l=document.cookie.indexOf("testcookie")!==-1);var p=e,m=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10",r:/(Windows 10|Windows NT 10.0)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var T in m){var A=m[T];if(A.r.test(u)){p=A.s;break}}var _=e;switch(/Windows/.test(p)&&(/Windows (.*)/.exec(p)&&(_=/Windows (.*)/.exec(p)[1]),p="Windows"),p){case"Mac OS X":/Mac OS X (10[._\d]+)/.exec(u)&&(_=/Mac OS X (10[._\d]+)/.exec(u)[1]);break;case"Android":/Android ([._\d]+)/.exec(u)&&(_=/Android ([._\d]+)/.exec(u)[1]);break;case"iOS":_=/OS (\d+)_(\d+)_?(\d+)?/.exec(s),_=_?_[1]+"."+_[2]+"."+(0|_[3]):e}var h={screen:t,browser:c,browserVersion:d,mobile:E,os:p,osVersion:_,cookies:l};return h}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e,t){var n=new window.Error(e||"");return n.code=t||0,n}return e}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(13),n(13)],i=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);return e}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(3),n(16),n(15),n(18),n(10),n(19),n(20),n(4),n(22),n(23),n(25),n(5),n(6),n(8),n(27),n(7),n(14),n(28),n(24),n(2),n(29),n(34),n(35),n(37),n(39),n(57),n(66),n(30),n(32),n(31),n(33),n(41)],i=function(e,t,n,r,i,o,a,s,u,c,d,f,E,l,p,m,T,A,_,h,R,N,S,O,y,v,I,g,C,D,b,P){"use strict";function L(e){c.validatePlayerDivId(e),this._setBaseValues(e)}var U=o.log;L.getSupportedTechniques=function(){var e=[];return d.isH5LiveKnownUnsupported||(d.hasMediaSource&&e.push(_.H5LIVE_WSS),d.useHLS&&e.push(_.H5LIVE_HLS)),e},L.supportedTechniques=L.getSupportedTechniques(),L.isSupported=function(){return L.supportedTechniques.length>0};var w=L.prototype=Object.create(e.prototype);return w._setBaseValues=function(e){this.version=r.CORE,this.type="h5live",this.networkState=this.NETWORK_STATE.UNINITIALIZED,this._info=i,this.config=f.create(),this._playerDivId="",this._playing=!1,this._streamInfo=null,this._pauseReason="",this._playerDivId=e,this._mediaElementId="h5live-"+e,this._componentEmitter=new s,this._componentListeners={logic:[{type:C.SERVER_INFO,listener:this._onServerInfo.bind(this)},{type:C.STREAM_INFO,listener:this._onStreamInfo.bind(this)},{type:C.STREAM_INFO_UPDATE,listener:this._onStreamInfoUpdate.bind(this)},{type:C.NO_KEEP_CONNECTION,listener:this._onNoKeepConnection.bind(this)},{type:C.MIME_TYPE_UNSUPPORTED,listener:this._onMimeTypeUnsupported.bind(this)},{type:C.ERROR,listener:this._onLogicError.bind(this)}],network:[{type:b.CONNECTING,listener:this._onConnectionConnecting.bind(this)},{type:b.CONNECTED,listener:this._onConnectionOpen.bind(this)},{type:b.DISCONNECTED,listener:this._onConnectionClosed.bind(this)},{type:b.RECONNECTING,listener:this._onConnectionReconnecting.bind(this)},{type:b.RECONNECTION_IMMINENT,listener:this._onConnectionReconnectionImminent.bind(this)},{type:b.DESTROYED,listener:this._onConnectionDestroyed.bind(this)},{type:b.INITIALIZATION_ERROR,listener:this._onConnectionInitializationError.bind(this)},{type:b.ERROR,listener:this._onConnectionError.bind(this)}],media:[{type:D.ERROR,listener:this._onError.bind(this)},{type:D.PLAYBACK_ERROR,listener:this._onMediaError.bind(this)},{type:D.PLAYBACK_STARTED,listener:this._onMediaPlaying.bind(this)},{type:D.PLAYBACK_SUSPENDED,listener:this._onMediaSuspended.bind(this)},{type:D.BUFFERING,listener:this._onMediaBuffering.bind(this)},{type:D.PLAY_START_ERROR,listener:this._onPlayStartError.bind(this)}]},this._setState(this.STATE.IDLE)},w._baseSetup=function(e,r){var i=a.check(r,E.create());a.merge(r,this.config),a.clean(this.config);var o;if(o=c.validateConfig(e,r))return o;r.playback.videoId&&(this._mediaElementId=r.playback.videoId),this._setListeners(this.config.events,this),i.forEach(function(e){this._emitWarning(e)}.bind(this));var s=document.getElementById(this._playerDivId);this._metaDataEnabled=this.config.playback.metadata;var u=this.config.source.h5live.params,d=this.config.source.h5live.rtmp,f=u&&u.url?u.url:d&&d.url?d.url:null,l=u&&u.stream?u.stream:d&&d.streamname?d.streamname:null;f&&l?this.config.url=f+"/"+l:this.config.url="",this.config.type=this.type,this.config.id=this.id,this._components={network:v.create(this._componentEmitter),media:I.create(this._componentEmitter),logic:y.create(this._componentEmitter),performance:S.create(this._componentEmitter,this._playerDivId),propagator:N.create(this._componentEmitter),error:O.create(this._componentEmitter),state:R.create(this._componentEmitter)};for(var p in this._components)this._componentListeners.hasOwnProperty(p)&&this._componentListeners[p].length&&t.add({target:this._componentEmitter,listeners:this._componentListeners[p]});for(var T in m)(this._outwardEvents||(this._outwardEvents=[]))&&this._outwardEvents.push({from:m[T],to:m[T]});return this._outwardTranslator=n.create(this._componentEmitter,this,this._outwardEvents),this._emitConfig(),this._setupVideoElement(s),o},w.setup=function(e){return new Promise(function(t,n){try{var r=this._baseSetup(L.supportedTechniques[0],e);r?n(r):(setTimeout(function(){this._setState(this.STATE.READY),this.emit(m.READY,{config:this.config}),this.config.playback.autoplay&&this.play()}.bind(this),20),t(this.config))}catch(e){n(e)}}.bind(this))},w._destroy=function(){this._setState(this.STATE.DESTROYING),this._playing&&this.pause(this.state),this.emit(m.DESTROY),this._outwardTranslator.destroy(),this._outwardTranslator=null;for(var e in this._components)this._components.hasOwnProperty(e)&&(this._components[e].destroy(),delete this._components[e]);for(var n in this._componentListeners)this._componentListeners.hasOwnProperty(n)&&this._componentListeners[n].length&&t.remove({target:this._componentEmitter,listeners:this._componentListeners[n]});this.removeAllListeners()},w.destroy=w._destroy,w._emitConfig=function(){this._componentEmitter.emit(g.CONFIG,{config:u.copy(this.config)})},w._setState=function(e){var t=arguments.length>1?arguments[1]:{};this.state=e,t.state=e,this._componentEmitter.emit(C.STATE_CHANGE,t)},w._debug=function(e,t){U("nanoplayer ("+this._playerDivId+"): "+e,t)},w._setListeners=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&"function"==typeof e[n]){var r=n.replace("on",""),i=e[n];t.on(r,i)}},w._setupVideoElement=function(e){this._componentEmitter.emit(g.CREATE_VIDEO,{elementId:this._mediaElementId,container:e})},w._onLogicError=function(e){switch(e.data.code){case T.PLAYER.VISIBILITY_HIDDEN:this._setState(l.VISIBILITY_HIDDEN);break;case T.STREAM.NOT_ENOUGH_DATA:this._setState(l.NOT_ENOUGH_DATA);break;case T.STREAM.SOURCE_STOPPED:this._setState(l.SOURCE_STREAM_STOPPED);break;case T.MEDIA.SOURCE_ENDED:this._setState(l.PLAYBACK_ERROR)}this.emit(m.ERROR,e.data),this.pause(this.state)},w._onPlayStartError=function(e){switch(this._debug(e.data.error.name+": "+e.data.error.message,1),e.data.error.name){case"NotAllowedError":e.data.automuted?this._emitWarning("Unmuted autoplay failed by autoplay policy, but 'automute' is enabled. Try to play muted."):(this._setState(this.STATE.PLAYBACK_NOT_STARTED),this._emitError(T.PLAYER.INTERACTION_REQUIRED,"Playback must be initialized by user gesture."))}},w._onError=function(e){if(this.state!==this.STATE.PAUSING&&this.state!==this.STATE.PAUSED){var t="",n=e.data.code;switch(n){case MediaError.MEDIA_ERR_ABORTED:t="A fetching process of the media aborted by user";break;case MediaError.MEDIA_ERR_NETWORK:t="An error occurred when downloading media";break;case MediaError.MEDIA_ERR_DECODE:t="An error occurred when decoding media";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:t="The received audio/video is not supported";break;default:t="An unknown media error occurred"}this._debug('error media with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',3),this._debug("error message: "+t,3),n===MediaError.MEDIA_ERR_DECODE&&this.state!==this.STATE.LOADING&&setTimeout(this.play.bind(this),1e3),this._setState(this.STATE.PLAYBACK_ERROR),this._emitError(n+3e3,t)}},w._preparePlay=function(e){this._setState(this.STATE.LOADING,{connectDelay:e}),this.emit(m.LOADING,{connectDelay:e})},w.play=function(){var e=arguments.length?arguments[0]:0;U("nanoplayer ("+this._playerDivId+"): play in state "+this.state,1),this.state<this.STATE.READY?this._emitError(T.PLAYER.NOT_CONFIGURED,"Could not play because player has not been configured."):this.state===this.STATE.READY||this.state===this.STATE.PAUSED?(this._playing=!0,e?setTimeout(function(){this.state===this.STATE.LOADING&&(this._componentEmitter.emit(P.PLAY),this._componentEmitter.emit(g.PLAY,{external:!0}))}.bind(this),e):(this._componentEmitter.emit(P.PLAY),this._componentEmitter.emit(g.PLAY,{external:!0})),this._preparePlay(e)):this.state===this.STATE.PAUSING&&(U("nanoplayer ("+this._playerDivId+"play in PAUSING state, setting flag to resume"),this._resumeOnPause=!0)},w._onConnectionInitializationError=function(e){this._debug('error init connection with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',2),this.networkState=e.connectionState;var t="Connection initialization error.",n=e?e.data:void 0;n&&n.message&&(t=n.message),n&&n.code&&(t+=" (code:"+n.code+")"),n&&n.name&&(t=n.name+": "+t),this._setState(this.STATE.CONNECTION_ERROR),this._emitError(T.NETWORK.COULD_NOT_ESTABLISH_CONNECTION,t)},w._onConnectionError=function(e){this._debug('error connection with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',2),this.networkState=e.connectionState;var t="Connection error.",n=e?e.data:void 0;n&&n.message&&(t=n.message),n&&n.code&&(t+=" (code:"+n.code+")"),n&&n.name&&(t=n.name+": "+t),this._setState(this.STATE.CONNECTION_ERROR),this._emitError(T.NETWORK.CONNECTION_ERROR,t)},w._onConnectionConnecting=function(e){this._debug("connecting",1),this.networkState=e.connectionState},w._onConnectionOpen=function(e){e.data.count?this._debug("connection open after "+e.data.count+" reconnect tries",1):this._debug("connection open",1),this.networkState=e.connectionState},w._onConnectionClosed=function(e){this._debug("connection closed",1),this.networkState=e.connectionState;var t;t=A.hasOwnProperty(+e.data.code)?A[+e.data.code]:"Unknown reason";var n=e.data.code;n>1e3&&n<4e3&&(n+=3100),this._debug('closed connection with state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',2),n>4e3&&this._emitError(n,t)},w._onConnectionDestroyed=function(e){this._debug("connection destroyed"+(e.data.silent?", but silent":""),1),this.networkState=e.connectionState,this.state===this.STATE.READY||e.data.silent||this.pause(this.state)},w._onConnectionReconnecting=function(e){this._debug("reconnect attempt "+e.data.count+" started",1),this.networkState=e.connectionState},w._onConnectionReconnectionImminent=function(e){var t=e.data.code;t>1e3&&t<4e3&&(t+=3100),this._debug("connection "+e.data.count+(e.data.count>1?" times":" time")+" unexpectedly closed with code "+t+", but a reconnect will be prepared",1),this._debug("reconnect attempt "+e.data.count+" starts in "+Math.round(e.data.delay)+" ms",1),("iOS"!==i.os||"iOS"===i.os&&e.data.count>1)&&this._emitWarning("Connection error: closed "+e.data.count+(e.data.count>1?" times":" time")+" unexpectedly with code "+t+", but a reconnect will be prepared in "+(e.data.delay/1e3).toFixed(3)+" s"),this.networkState=e.connectionState,this._playing&&"iOS"!==i.os&&(this._setState(this.STATE.RECONNECTION_IMMINENT),this.pause(this.state),this.play(e.data.delay))},w._onServerInfo=function(e){this._debug("onServerInfo",2);try{var t=JSON.stringify(e.data);this._debug(""+t,3)}catch(e){}},w._onStreamInfo=function(e){this._debug("onStreamInfo",2),this.emit(m.STREAM_INFO,e.data)},w._onStreamInfoUpdate=function(e){this._debug("onStreamInfoUpdate",2),this.emit(m.STREAM_INFO_UPDATE,e.data)},w._onNoKeepConnection=function(e){this._debug("onNoKeepConnection",2),this._emitWarning(e.data.message)},w._onMimeTypeUnsupported=function(){this._setState(this.STATE.PLAYBACK_ERROR),this._emitError(T.MEDIA.NOT_SUPPORTED,"The received audio/video is not supported")},w._onMediaError=function(e){this._setState(this.STATE.PLAYBACK_ERROR),this._emitError(T.PLAYER.PLAYBACK_ERROR,e.data)},w._onMediaSuspended=function(){this._setState(this.STATE.PLAYBACK_SUSPENDED),this._emitError(T.PLAYER.PLAYBACK_SUSPENDED,"Playback suspended by external reason.")},w._emit=w.emit,w.emit=function(e,t){var n={};t&&t.name&&t.data?n=t:t?(n.data=t,n.name=e||"unknown"):(n.data={},n.name=e||"unknown"),n.player=this._playerDivId,n.id=this.id,n.version=this.version,n.state=this.state,"Error"===e&&n.data.code&&n.data.message&&this._debug("error "+n.data.code+" "+n.data.message,1),this._emit(n.name,n)},w._emitError=function(e,t){this.emit(m.ERROR,{code:e,message:t}),this.pause(this.state)},w._emitWarning=function(e){this.emit(m.WARNING,{message:e})},w._getPauseReason=function(e){var t="";if(e){var n=this.networkState!==this.NETWORK_STATE.OPEN&&this.networkState!==this.NETWORK_STATE.UNINITIALIZED;switch(e){case this.STATE.READY:t=h.SERVER_NOT_FOUND;break;case this.STATE.LOADING:t=n?h.CONNECTION_CLOSE:h.STREAM_NOT_FOUND;break;case this.STATE.BUFFERING:t=n?h.CONNECTION_CLOSE:h.BUFFER;break;case this.STATE.UNKNOWN:t=n?h.CONNECTION_CLOSE:h.UNKNOWN;break;case this.STATE.PLAYING:t=n?h.CONNECTION_CLOSE:h.NORMAL;break;case this.STATE.PLAYBACK_NOT_STARTED:t=h.INTERACTION_REQUIRED;break;case this.STATE.PLAYBACK_SUSPENDED:t=h.PLAYBACK_SUSPENDED;break;case this.STATE.PLAYBACK_ERROR:t=h.PLAYBACK_ERROR;break;case this.STATE.RECONNECTION_IMMINENT:t=h.RECONNECTION_IMMINENT;break;case this.STATE.CONNECTION_ERROR:t=h.CONNECTION_CLOSE;break;case this.STATE.DESTROYING:t=h.DESTROY;break;case this.STATE.PLAYBACK_RESTARTING:t=h.PLAYBACK_RESTART;break;case this.STATE.VISIBILITY_HIDDEN:t=h.VISIBILITY_HIDDEN;break;case this.STATE.NOT_ENOUGH_DATA:t=h.NOT_ENOUGH_DATA;break;case this.STATE.SOURCE_STREAM_STOPPED:t=h.SOURCE_STREAM_STOPPED;break;default:t=h.NORMAL}}else t=h.NORMAL;return t},w._triggerPause=function(){return this.state===this.STATE.PAUSED?void U("nanoplayer ("+this._playerDivId+"): trigger pause but already in state paused"):(U("nanoplayer ("+this._playerDivId+'): trigger pause with reason "'+this._pauseReason+'", state "'+this._getState()+'", networkstate "'+this._getNetworkState()+'"',3),this._setState(this.STATE.PAUSED),this.emit(m.PAUSE,{reason:this._pauseReason}),void(this._resumeOnPause&&(this._resumeOnPause=!1,this.play())))},w.pause=function(){var e=arguments.length?arguments[0]:0;U("nanoplayer ("+this._playerDivId+"): pause in state "+this.state,2),this.state<this.STATE.READY?this._emitError(T.PLAYER.NOT_PLAYING,"Could not pause because player was not in playing state before."):this.state!==this.STATE.PAUSED&&this.state!==this.STATE.PAUSING&&(this._pauseReason=this._getPauseReason(e),this._setState(this.STATE.PAUSING),this._playing=!1,this._resumeOnPause=!1,this._componentEmitter.emit(P.PAUSE),this._componentEmitter.emit(g.PAUSE),this._triggerPause())},w.mute=function(){this._componentEmitter.emit(g.MUTE)},w.unmute=function(){this._componentEmitter.emit(g.UNMUTE)},w.setVolume=function(e){this._componentEmitter.emit(g.SET_VOLUME,{volume:e})},w.updateSource=function(e){return new Promise(function(t,n){var r;if(r=c.validateConfig(L.supportedTechniques[0],{source:e}))r.message.replace("create","update"),this._emitError(r.code,r.message),n(r);else{a.merge(e,this.config.source),a.clean(this.config.source);var i=this.config.source.h5live.params,o=this.config.source.h5live.rtmp,s=i&&i.url?i.url:o&&o.url?o.url:null,u=i&&i.stream?i.stream:o&&o.streamname?o.streamname:null;s&&u?this.config.url=s+"/"+u:this.config.url="",this._componentEmitter.emit(g.UPDATE_SOURCE,{source:e}),this.state!==this.STATE.PLAYING&&this.state!==this.STATE.LOADING&&this.state!==this.STATE.BUFFERING||(this._setState(l.PLAYBACK_RESTARTING),this.pause(this.state),setTimeout(this.play.bind(this),0)),t(this.config)}}.bind(this))},w._parseUrl=function(e){var t={url:"",streamname:""},n=e.lastIndexOf("/"),r=e.substr(0,n),i=e.substr(n,e-n);return t.url=r,t.streamname=i,t},w._getState=function(){return u.findPropertyByValue(this.STATE,this.state)},w._getNetworkState=function(){return u.findPropertyByValue(this.NETWORK_STATE,this.networkState)},w._onMediaPlaying=function(e){var t=this.state;this._setState(l.PLAYING),this.emit(t===l.BUFFERING?m.STOP_BUFFERING:m.PLAY,e.data),this._debug("state is PLAYING")},w._onMediaBuffering=function(){this._setState(l.BUFFERING),this.emit(m.START_BUFFERING)},w.STATE=l,w.NETWORK_STATE=p,w.PAUSE_REASON=h,L}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({PLAYER:{NO_RTMP_URL_SET:1001,NO_SERVER_SET:1002,NOT_CONFIGURED:1003,NOT_PLAYING:1004,INTERACTION_REQUIRED:1005,BUFFER_CONFIG_INVALID:1006,PLAYBACK_SUSPENDED:1007,PLAYBACK_ERROR:1008,VISIBILITY_HIDDEN:1009},STREAM:{NOT_FOUND:2001,MEDIA_NOT_AVAILABLE:2002,NOT_ENOUGH_DATA:2003,SOURCE_STOPPED:2004,METADATA_STILL_PROCESSING:2014,METADATA_NO_START_INDEX:2013,METADATA_INVALID_JSON:2012,METADATA_WRONG_INDEX:2011},MEDIA:{ABORTED:3001,DOWNLOAD_ERROR:3002,DECODE_ERROR:3003,NOT_SUPPORTED:3004,SOURCE_ENDED:3100},NETWORK:{COULD_NOT_ESTABLISH_CONNECTION:4001,CONNECTION_ERROR:4002,MAX_RECONNECTS_REACHED:4003,RECONNECTION_CONFIG_INVALID:4004},SETUP:{EXCEPTION:5001,CLIENT_NOT_SUPPORTED:5002,FORCE_NOT_SUPPORTED:5003,SOURCE_NOT_SUPPORTED:5004,CONFIG_RTMP:5005,CONFIG_TOKEN:5006,CONFIG_WSS:5007,CONFIG_HLS:5008,CONFIG_METADATA:5009,EMBED_PLAYER:5010}})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(16)],i=function(e){function t(t,n,r){function i(){s=[],r.forEach(function(e){s.push({type:e.from,listener:a}),u[e.from]||(u[e.from]=[]),u[e.from].push(e.to)}),e.add({target:t,listeners:s})}function o(){e.remove({target:t,listeners:s}),s=null,u=null}function a(e){u[e.name]&&u[e.name].forEach(function(t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]);n.emit(t,r)})}var s,u={};return i(),{destroy:o}}return{create:t}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(17)],i=function(e){"use strict";function t(t){if(!t.target)throw new Error(e.NO_TARGET);if(!t.listeners||!t.listeners.length)throw new Error(e.NO_LISTENERS);if(!n(t.target,o)||!n(t.target,a))throw new Error(e.NOT_DISPATCHER);for(var r=0;r<t.listeners.length;++r)if(!t.listeners[r].type&&"string"!=typeof t.listeners[r].type||0!==t.listeners[r].type.length){if(!t.listeners[r].type)throw new Error(e.MISSING_TYPE.replace("%index%",r));if("function"!=typeof t.listeners[r].listener)throw new Error(e.MISSING_LISTENER.replace("%index%",r))}else t.listeners.splice(r,1),r--}function n(e,t){for(var n=0;n<t.length;++n)if("function"==typeof e[t[n]])return e[t[n]];return null}function r(e,r){t(r),i(n(r.target,e),r.target,r.listeners)}function i(e,t,n){for(var r=0;r<n.length;++r)e.call(t,n[r].type,n[r].listener)}var o=["addEventListener","addListener","on"],a=["removeEventListener","removeListener","off"];return{add:r.bind(null,o),remove:r.bind(null,a)}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({NO_TARGET:"No target in config",NO_LISTENERS:"No listeners in config",NOT_DISPATCHER:"Target is not an event dispatcher",MISSING_TYPE:"Missing type in listener #%index%",MISSING_LISTENER:"Missing/invalid listener in listener #%index%"})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return{CORE:"3.17.4-safari-12.1-hotfix-2"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e=function(){function e(){var e=isNaN(n("debug"))?0:+n("debug"),r=+t("nanoDebug");return Math.max(e,r)}function t(e){return document.cookie.indexOf(e+"=")!==-1?document.cookie.split(e+"=")[1].split(";")[0]:null}function n(e){if(!o){o=[];var t=document.location.search.substr(1,document.location.search.length);if(""===t&&document.location.href.indexOf("?")!==-1){var n=document.location.href.indexOf("?")+1;t=document.location.href.slice(n)}if(""!==t)for(var r=t.split("&"),i=0;i<r.length;++i){var a="",s=r[i].split("="),u=s[0];s.length>1&&(a=s[1]),o[decodeURIComponent(u)]=decodeURIComponent(a)}}try{return o[e]}catch(e){return}}function r(){return(new Date).toISOString()}var i=e(),o=void 0;setInterval(function(){i=e()},5e3);var a=function(e,t){try{i>=t&&console.debug(r()+": "+e)}catch(e){}};return{log:a,getHTTPParam:n}}();return e}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(11),n(21),n(14)],i=function(e,t,n){function r(e,t){var n;for(n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&("object"!=typeof e[n]||!Object.keys(e[n]).length||"object"==typeof t[n]&&Object.keys(t[n]).length?"object"==typeof e[n]?r(e[n],t[n]):t[n]=e[n]:i(e[n],t[n]))}function i(e,t){var n;for(n in e)e.hasOwnProperty(n)&&(!t[n]&&(t[n]={}),"object"==typeof e[n]?i(e[n],t[n]):t[n]=e[n])}function o(e){var t;for(t in e)e.hasOwnProperty(t)&&("undefined"==typeof e[t]||"string"==typeof e[t]&&0===e[t].length)&&delete e[t],e.hasOwnProperty(t)&&e[t]instanceof Object&&o(e[t]);for(t in e)(e.hasOwnProperty(t)&&("undefined"==typeof e[t]||"string"==typeof e[t]&&0===e[t].length)||"object"==typeof e[t]&&"function"!=typeof e[t]&&0===Object.keys(e[t]).length)&&delete e[t]}function a(e,t,n,r){n=n||"",r=r||[];var i;for(i in e)e.hasOwnProperty(i)&&t.hasOwnProperty(i)&&("object"==typeof e[i]&&"object"==typeof t[i]?r=a(e[i],t[i],n+i+".",r):typeof e[i]!==t[i]&&"*"!==t[i]&&void 0!==e[i]&&""!==e[i]&&r.push("Configuration warning. The config property '$property$' must be of type '$type$'.".replace("$property$",n+i).replace("$type$",t[i]))),e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&r.push("Configuration warning. The config property '$property$' is not a valid property. Please remove from config.".replace("$property$",n+i));return r}return{merge:r,clean:o,check:a,extend:i}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({CONFIG_RTMP:"Configuration error. Could not create player, the rtmp configuration is missing or incomplete. Add an rtmp url and streamname to the configuration.",CONFIG_TOKEN:"Configuration error. Could not create player, with this configuration an security token is required. Add an token to the configuration.",CONFIG_WSS:"Configuration error. Could not create player, the websocket server configuration is missing.",CONFIG_HLS:"Configuration error. Could not create player, the hls server configuration is missing.",CONFIG_METADATA:"Configuration error. Could not create player, the websocket server configuration for metadata is missing.",CONFIG_SOURCE:"The players source configuration is malformed or missing, please check documentation for more information or contact us."})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(t){var r;switch(typeof t){case"object":if(null===t)r=null;else switch(n.call(t)){case"[object Array]":r=t.map(e);break;case"[object Date]":r=new Date(t);break;case"[object RegExp]":r=new RegExp(t);break;default:r=Object.keys(t).reduce(function(n,r){return n[r]=e(t[r]),n},{})}break;default:r=t}return r}function t(e,t){if("object"==typeof e)for(var n in e)if(e[n]===t)return n;return!1}var n=Object.prototype.toString;return{copy:e,findPropertyByValue:t}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(11),n(21),n(24),n(14)],i=function(e,t,n,r){function i(i,o){var a=o.source;if(!a||!a.h5live)return new e(t.CONFIG_SOURCE,r.SETUP.SOURCE_NOT_SUPPORTED);var s=o.source.h5live;if(!(s.rtmp&&s.rtmp.url&&s.rtmp.streamname||s.params&&s.params.url&&s.params.stream))return new e(t.CONFIG_RTMP,r.SETUP.CONFIG_RTMP);if(!(s.server&&(s.server.websocket||s.server.hls)||s.token))return new e(t.CONFIG_TOKEN,r.SETUP.CONFIG_TOKEN);if(i===n.H5LIVE_WSS&&s.server&&!s.server.websocket)return new e(t.CONFIG_WSS,r.SETUP.CONFIG_WSS);if(i===n.H5LIVE_HLS){if(s.server&&!s.server.hls)return new e(t.CONFIG_HLS,r.SETUP.CONFIG_HLS);if(o.playback&&o.playback.metadata&&!s.server.websocket)return new e(t.CONFIG_METADATA,r.SETUP.CONFIG_METADATA)}return!1}function o(t){if(!("string"==typeof t||t instanceof String))throw new e('The param "playerDivId" must be of type "String".');var n=document.getElementById(t);if(!n)throw new e('The param "playerDivId" must be the id of an existing "div" element.');if("DIV"!==n.tagName)throw new e('The element with the id "'+t+'" is not a "div" element.');return!0}return{validateConfig:i,validatePlayerDivId:o}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({FLASH:"flash",NATIVE:"hls.native",H5LIVE_WSS:"h5live",H5LIVE_HLS:"h5live.hls"})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(10),n(26)],i=function(e,t){var n=t.create("Conditions"),r=e.os,i=e.osVersion,o=e.browser,a=parseInt(e.browserVersion.split(".")[0],10),s="iOS"===r&&parseInt(i)>=10||"iOS"!==r&&"Safari"===o&&"12.1"===e.browserVersion,u="Microsoft Edge"===o,c="Microsoft Internet Explorer"===o||u,d="Chrome"===o&&a>57,f="iOS"===r&&a>=11,E="Firefox"===o,l="Safari"===o;
console.error(l+" "+e.browserVersion);var p="iOS"!==r&&!!window.MediaSource&&(!l||l&&"12.1"!==e.browserVersion)&&(E&&a>=48||u||window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),m=function(){var e=!1;try{"Chrome"===o&&a<54?e=!0:"Firefox"===o&&a<48?e=!0:"Microsoft Internet Explorer"===o&&(a<11||11===a&&7===parseInt(i))?e=!0:"Safari"===o&&a<10&&(e=!0)}catch(e){}return e}(),T={useHLS:s,isIEorEdge:c,isChromeHigher57:d,hasMediaSource:p,isIOS11:f,isFirefox:E,isSafari:l,isH5LiveKnownUnsupported:m};for(var A in T)T.hasOwnProperty(A)&&n.debug(A+": "+T[A]);return T}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(19)],i=function(e){function t(t,n,r){e.log("["+n+"] "+r,t)}function n(e){return{debug:t.bind(this,a,e),info:t.bind(this,o,e),warn:t.bind(this,i,e),error:t.bind(this,r,e),detail:t.bind(this,s,e)}}var r=0,i=1,o=2,a=3,s=4;return{create:n}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({UNINITIALIZED:1,CONNECTING:2,OPEN:3,CLOSING:4,CLOSED:5})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({1000:"Normal closure, meaning that the purpose for which the connection was established has been fulfilled.",1001:'An endpoint is "going away", such as a server going down or a browser having navigated away from a page.',1002:"An endpoint is terminating the connection due to a protocol error",1003:"An endpoint is terminating the connection because it has received a type of data it cannot accept (e.g., an endpoint that understands only text data MAY send this if it receives a binary message).",1004:"Reserved. The specific meaning might be defined in the future.",1005:"No status code was actually present.",1006:"Maybe no network, wrong url or server down.",1007:"An endpoint is terminating the connection because it has received data within a message that was not consistent with the type of the message (e.g., non-UTF-8 [http://tools.ietf.org/html/rfc3629] data within a text message).",1008:'An endpoint is terminating the connection because it has received a message that "violates its policy". This reason is given either if there is no other sutible reason, or if there is a need to hide specific details about the policy.',1009:"An endpoint is terminating the connection because it has received a message that is too big for it to process.",1011:"A server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request.",1015:"The connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified).",4400:"Bad request. Maybe stream parameters are missing or malformed.",4403:"Access denied. The authentication token is missing or invalid.",4500:"The connection has been rejected due an internal server error.",4503:"The requested service is currently unavailable.",4900:"The security service has been rejected due an internal server error.",4901:"The security service denied access. The authentication token is invalid.",4903:"The security service denied access. The url is expired or a token parameter is missing (expires, token, or options).",4904:"The security service can not be found."})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(16),n(7),n(30),n(31),n(32),n(33),n(26)],i=function(e,t,n,r,i,o,a){function s(n){function r(){e.add({target:n,listeners:d})}function o(){e.remove({target:n,listeners:d})}function s(e,t){n.emit(e,t)}function u(e){c=e.data.state,s(t.STATE_CHANGE,e.data)}var c,d=(a.create("StateMachine"),[{type:i.STATE_CHANGE,listener:u}]);return r(),{destroy:o}}return{create:s}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="control.";return{BASE:e,CONNECT:e+"connect",DISCONNECT:e+"disconnect",NETWORK_PLAY:e+"networkPlay",NETWORK_PAUSE:e+"networkPause",PLAY:e+"play",PAUSE:e+"pause",MUTE:e+"mute",UNMUTE:e+"unmute",SET_VOLUME:e+"setVolume",SEEK:e+"seek",SET_RATE:e+"playbackRate",CONFIG:e+"config",CREATE_VIDEO:e+"createVideo",DESTROY_VIDEO:e+"destroyVideo",VIDEO_SOURCE:e+"videoSource",UPDATE_SOURCE:e+"updateSource"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="media.";return{BASE:e,LOAD_START:e+"loadstart",PROGRESS:e+"progress",SUSPEND:e+"suspend",ABORT:e+"abort",EMPTIED:e+"emptied",STALLED:e+"stalled",PLAY:e+"play",PAUSE:e+"pause",LOADED_META_DATA:e+"loadedmetadata",LOADED_DATA:e+"loadeddata",WAITING:e+"waiting",ERROR:e+"error",PLAYING:e+"playing",CAN_PLAY:e+"canplay",CAN_PLAY_THROUGH:e+"canplaythrough",SEEKING:e+"seeking",SEEKED:e+"seeked",TIME_UPDATE:e+"timeupdate",ENDED:e+"ended",RATE_CHANGE:e+"ratechange",DURATION_CHANGE:e+"durationchange",VOLUME_CHANGE:e+"volumechange",ELEMENT_CREATED:e+"elementCreated",QUALITY_STATS:e+"qualitystats",PLAY_STATS:e+"playStats",FRAME_DROP:e+"framedrop",SOURCE_OPEN:e+"sourceopen",SOURCE_ENDED:e+"sourceended",SOURCE_CLOSED:e+"sourceclosed",PLAYBACK_ERROR:e+"playbackError",PLAYBACK_STARTED:e+"playbackStarted",PLAYBACK_SUSPENDED:e+"playbackSuspended",BUFFERING:e+"buffering",PLAY_START_SUCCESS:e+"playStartSuccess",PLAY_START_ERROR:e+"playStartError",BUFFER_TWEAKS_CREATED:e+"bufferTweaksCreated",BUFFER_TWEAKS_ERROR:e+"bufferTweaksError",VIEWPORT_VISIBLE:e+"viewportvisible",VIEWPORT_HIDDEN:e+"viewporthidden"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="logic.";return{BASE:e,STATE_CHANGE:e+"stateChange",LOADING_TIMEOUT:e+"loadingTimeout",BUFFERING_TIMEOUT:e+"bufferingTimeout",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",SERVER_INFO:e+"serverInfo",STREAM_URL:e+"streamUrl",NO_KEEP_CONNECTION:e+"noKeepConnection",MIME_TYPE_UNSUPPORTED:e+"mimeTypeUnsupported",META_DATA_RECEIVED:e+"metaDataReceived",META_DATA_ERROR:e+"metaDataError",NO_SERVER_ERROR:e+"noServerError",MISSING_RTMP_ERROR:e+"missingRtmpError",STARTUP_STATS:e+"startupStats",DOCUMENT_VISIBLE:e+"documentVisible",DOCUMENT_HIDDEN:e+"documentHidden",ERROR:e+"error"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="network.";return{BASE:e,CONNECTING:e+"connecting",CONNECTED:e+"connected",DISCONNECTED:e+"disconnected",RESUMING:e+"resuming",RECONNECTION_IMMINENT:e+"reconnectionImminent",RECONNECTING:e+"reconnecting",RECONNECTION_CONFIG_INVALID:e+"reconnectionConfigInvalid",CONNECTION_ERROR:e+"connectionError",INITIALIZATION_ERROR:e+"initializationError",MAX_RETRY_REACHED:e+"maxRetryReached",ERROR:e+"error",DESTROYED:e+"destroyed",META_DATA:e+"metaData",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",RAW_PACKET:e+"raw",STREAM_STATUS:e+"streamStatus"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(16),n(14),n(7),n(30),n(31),n(32),n(33),n(26)],i=function(e,t,n,r,i,o,a,s){function u(r){function u(){e.add({target:r,listeners:S}),O.forEach(function(e){r.addListener(e.event,f)})}function c(){e.remove({target:r,listeners:S}),O.forEach(function(e){r.removeListener(e.event,f)})}function d(e,t){r.emit(e,t)}function f(e){var t,n;O.forEach(function(r){r.event===e.name&&(t=r.code?r.code:e.data.code,n=r.message?r.message:e.data.reason,r.defer?setTimeout(E.bind(this,t,n),0):E(t,n))})}function E(e,t){d(n.ERROR,{code:e,message:t})}function l(e){var t;_&&_.quality&&(t=_.quality),_=e.data.stats,t&&!_.quality&&(_.quality=t);var r,i="stats error";try{i=JSON.stringify(_),r=JSON.parse(i),delete r.buffer.update,delete r.buffer.delay.before}catch(e){}d(n.STATS,{stats:r})}function p(e){_||(_={}),_.quality=e.data}function m(e){h.debug("mediaSource "+(e.type===i.SOURCE_ENDED?"ended":"closed")+", readyState: "+e.data.readyState),d(n.PLAYBACK_FINISHED)}function T(e){e.data.muted!==N?(N=e.data.muted,d(N?n.MUTE:n.UNMUTE,{volume:R})):e.data.volume!==R&&(R=e.data.volume,d(n.VOLUME_CHANGE,{volume:R}))}function A(e){setTimeout(d.bind(this,n.METADATA,e.data),0)}var _,h=s.create("FacadePropagator"),R=1,N=!1,S=[{type:i.VOLUME_CHANGE,listener:T},{type:i.QUALITY_STATS,listener:p},{type:i.PLAY_STATS,listener:l},{type:i.SOURCE_ENDED,listener:m},{type:i.SOURCE_CLOSED,listener:m},{type:o.META_DATA_RECEIVED,listener:A}],O=[{event:o.META_DATA_ERROR,code:null,message:null,defer:!0},{event:o.MISSING_RTMP_ERROR,code:t.PLAYER.NO_RTMP_URL_SET,message:"No rtmp url set.",defer:!1},{event:o.NO_SERVER_ERROR,code:t.PLAYER.NO_SERVER_SET,message:"No server set.",defer:!1},{event:a.RECONNECTION_CONFIG_INVALID,code:t.NETWORK.RECONNECTION_CONFIG_INVALID,message:null,defer:!0},{event:i.BUFFER_TWEAKS_ERROR,code:t.PLAYER.BUFFER_CONFIG_INVALID,message:null,defer:!1}];return u(),{destroy:c}}return{create:u}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(36),n(26),n(25),n(16),n(8),n(30),n(31),n(33),n(32)],i=function(e,t,n,r,i,o,a,s,u){function c(t,o){function c(){r.add({target:t,listeners:w}),r.add({target:t,listeners:n.useHLS?F:M})}function R(){r.remove({target:t,listeners:w}),r.remove({target:t,listeners:n.useHLS?F:M})}function N(e){switch(b=e.data.state){case i.PAUSED:L={},U=null}}function S(t){var n=[d,o,t].join(f);e&&"function"==typeof e.mark&&P.indexOf(n)===-1&&(e.mark(n),P.push(n)),L[t]||t===_&&(t!==_||[m,T,A].indexOf(U)===-1)||(U=t,L[t]=e.now(),h.debug(t+": "+L[t]),t===_&&O())}function O(){if(E.forEach(function(e,t){if(void 0===L[e]){L[e]=0;for(var n=t+1,r=E.length;n<r;n+=1)if(void 0!==L[E[n]]){L[e]=L[E[n]];break}}}),E.filter(function(e){return void 0!==L[e]}).length){var e=L[l];for(var n in L)L.hasOwnProperty(n)&&(L[n]=Math.round(L[n]-e));t.emit(u.STARTUP_STATS,{stats:L}),h.debug("startup stats: "+JSON.stringify(L))}}function y(){S(l)}function v(){S(p)}function I(){S(A)}function g(){S(_)}function C(){S(m)}function D(){S(T)}var b,P=[],L={},U=null,w=[{type:u.STATE_CHANGE,listener:N}],M=[{type:s.CONNECTING,listener:y},{type:s.CONNECTED,listener:v},{type:s.STREAM_FRAGMENT,listener:C},{type:a.LOADED_DATA,listener:D},{type:a.CAN_PLAY_THROUGH,listener:I},{type:a.PLAYING,listener:g}],F=[{type:a.LOAD_START,listener:y},{type:a.DURATION_CHANGE,listener:v},{type:a.LOADED_META_DATA,listener:C},{type:a.LOADED_DATA,listener:D},{type:a.CAN_PLAY_THROUGH,listener:I},{type:a.PLAYING,listener:g}];return c(),{destroy:R}}var d="nano",f=".",E=[],l=E[0]="connecting",p=E[1]="connected",m=E[2]="firstFragmentReceived",T=E[3]="firstFrameRendered",A=E[4]="playable",_=E[5]="playing",h=t.create("Performance");return{create:c}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e=Date.now?Date.now():+new Date,t=window.performance||{},n=[],r={},i=function(e,t){for(var r=0,i=n.length,o=[];r<i;r++)n[r][e]===t&&o.push(n[r]);return o},o=function(e,t){for(var r,i=n.length;i--;)r=n[i],r.entryType!==e||void 0!==t&&r.name!==t||n.splice(i,1)};return t.now||(t.now=t.webkitNow||t.mozNow||t.msNow||function(){return(Date.now?Date.now():+new Date)-e}),t.mark||(t.mark=t.webkitMark||function(e){var i={name:e,entryType:"mark",startTime:t.now(),duration:0};n.push(i),r[e]=i}),t.measure||(t.measure=t.webkitMeasure||function(e,t,i){t=r[t].startTime,i=r[i].startTime,n.push({name:e,entryType:"measure",startTime:t,duration:i-t})}),t.getEntriesByType||(t.getEntriesByType=t.webkitGetEntriesByType||function(e){return i("entryType",e)}),t.getEntriesByName||(t.getEntriesByName=t.webkitGetEntriesByName||function(e){return i("name",e)}),t.clearMarks||(t.clearMarks=t.webkitClearMarks||function(e){o("mark",e)}),t.clearMeasures||(t.clearMeasures=t.webkitClearMeasures||function(e){o("measure",e)}),void 0===window.performance&&(window.performance=t),window.performance}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(16),n(14),n(38),n(7),n(8),n(30),n(31),n(32),n(33),n(26),n(10)],i=function(e,t,n,r,i,o,a,s,u,c,d){function f(r){function o(){e.add({target:r,listeners:v})}function d(){e.remove({target:r,listeners:v})}function f(e,t){r.emit(e,t)}function E(e,t){f(s.ERROR,{code:e,message:t})}function l(e){R=e.data.state,R===i.LOADING&&(S=!1,N=null)}function p(e){S?E(t.STREAM.NOT_ENOUGH_DATA,n.STREAM.NOT_ENOUGH_DATA):N&&"stopped"===N?E(t.STREAM.SOURCE_STOPPED,n.STREAM.SOURCE_STOPPED):E(t.STREAM.NOT_FOUND,n.STREAM.NOT_FOUND)}function m(e){N&&"stopped"===N?E(t.STREAM.SOURCE_STOPPED,n.STREAM.SOURCE_STOPPED):E(t.STREAM.MEDIA_NOT_AVAILABLE,n.STREAM.MEDIA_NOT_AVAILABLE)}function T(e){S=!0}function A(e){e.name===s.DOCUMENT_HIDDEN?O=!0:(O&&(y=!0),O=!1,setTimeout(function(e){y=!1},1e3))}function _(e){O||y?E(t.PLAYER.VISIBILITY_HIDDEN,n.PLAYER.VISIBILITY_HIDDEN):E(t.MEDIA.SOURCE_ENDED,n.MEDIA.SOURCE_ENDED)}function h(e){N=e.data.onStreamStatus.status}var R,N,S,O,y,v=(c.create("ErrorSelector"),[{type:s.STATE_CHANGE,listener:l},{type:s.LOADING_TIMEOUT,listener:p},{type:s.BUFFERING_TIMEOUT,listener:m},{type:s.STREAM_INFO,listener:T},{type:s.DOCUMENT_VISIBLE,listener:A},{type:s.DOCUMENT_HIDDEN,listener:A},{type:a.SOURCE_ENDED,listener:_},{type:u.STREAM_STATUS,listener:h}]);return o(),{destroy:d}}return{create:f}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({PLAYER:{VISIBILITY_HIDDEN:"Playback failed because the player was in visibility state 'hidden' at load start."},STREAM:{NOT_FOUND:"The requested stream can not be found.",MEDIA_NOT_AVAILABLE:"No media available.",NOT_ENOUGH_DATA:"Not enough media data received.",SOURCE_STOPPED:"The source stream has been stopped."},MEDIA:{SOURCE_ENDED:"The media source extension changed the state to 'ended'."}})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(4),n(25),n(16),n(15),n(41),n(30),n(32),n(31),n(33),n(42),n(43),n(40),n(44),n(45),n(46),n(47),n(48),n(50),n(51),n(52),n(54),n(55),n(56)],i=function(e,t,n,r,i,o,a,s,u,c,d,f,E,l,p,m,T,A,_,h,R,N,S,O){"use strict";function y(y){function v(){P.debug("init"),C=i.create(y,b,w),D=i.create(b,y,U),r.add({target:b,listeners:M}),L.push(A.create(b)),L.push(n.useHLS?h.create(b):_.create(b)),L.push(N.create(b)),L.push(R.create(b)),L.push(O.create(b))}function I(){for(C.destroy(),C=null,D.destroy(),D=null;L.length;)L.pop().destroy();r.remove({target:b,listeners:M})}function g(e){e.data.config.playback.metadata&&L.push(S.create(b))}var C,D,b=new t,P=e.create("LogicManager"),L=[],U=[{from:d.SEEK,to:a.SEEK},{from:d.RATE,to:a.SET_RATE},{from:f.CONNECT,to:a.CONNECT},{from:f.DISCONNECT,to:a.DISCONNECT},{from:f.VIDEO_SOURCE,to:a.VIDEO_SOURCE},{from:f.NETWORK_PLAY,to:a.NETWORK_PLAY},{from:f.NO_SERVER_ERROR,to:s.NO_SERVER_ERROR},{from:f.MISSING_RTMP_ERROR,to:s.MISSING_RTMP_ERROR},{from:f.NO_KEEP_CONNECTION,to:s.NO_KEEP_CONNECTION},{from:f.SERVER_INFO,to:s.SERVER_INFO},{from:f.URL,to:s.STREAM_URL},{from:l.LOADING_TIMEOUT,to:s.LOADING_TIMEOUT},{from:l.BUFFERING_TIMEOUT,to:s.BUFFERING_TIMEOUT},{from:p.CREATED,to:s.STREAM_INFO},{from:p.UPDATED,to:s.STREAM_INFO_UPDATE},{from:p.MIME_TYPE_UNSUPPORTED,to:s.MIME_TYPE_UNSUPPORTED},{from:m.RECEIVED,to:s.META_DATA_RECEIVED},{from:m.ERROR,to:s.META_DATA_ERROR},{from:T.VISIBLE,to:s.DOCUMENT_VISIBLE},{from:T.HIDDEN,to:s.DOCUMENT_HIDDEN}],w=[{from:o.PLAY,to:E.API_PLAY},{from:o.PAUSE,to:E.API_PAUSE},{from:u.BUFFER_TWEAKS_CREATED,to:E.BUFFER_TWEAKS_CREATED},{from:u.PLAY_STATS,to:E.PLAY_STATS},{from:u.PLAYBACK_STARTED,to:E.PLAYING},{from:u.BUFFERING,to:E.BUFFERING},{from:u.CAN_PLAY,to:E.CAN_PLAY},{from:u.FRAME_DROP,to:E.FRAME_DROP},{from:u.VIEWPORT_VISIBLE,to:E.VIEWPORT_VISIBLE},{from:u.VIEWPORT_HIDDEN,to:E.VIEWPORT_HIDDEN},{from:c.CONNECTING,to:E.NETWORK_CONNECTING},{from:c.CONNECTED,to:E.NETWORK_CONNECTED},{from:c.DISCONNECTED,to:E.NETWORK_DISCONNECTED},{from:c.DESTROYED,to:E.NETWORK_DISCONNECTED},{from:c.RECONNECTING,to:E.NETWORK_RECONNECTING},{from:c.RECONNECTION_IMMINENT,to:E.NETWORK_RECONNECTION_IMMINENT},{from:c.INITIALIZATION_ERROR,to:E.NETWORK_INITIALIZATION_ERROR},{from:c.ERROR,to:E.NETWORK_ERROR},{from:c.RANDOM_ACCESS_POINT,to:E.RANDOM_ACCESS_POINT},{from:c.SERVER_INFO,to:E.SERVER_INFO},{from:c.STREAM_INFO,to:E.STREAM_INFO},{from:c.STREAM_INFO_UPDATE,to:E.STREAM_INFO_UPDATE},{from:c.META_DATA,to:E.META_DATA},{from:s.STATE_CHANGE,to:E.APPLICATION_STATE_CHANGE},{from:s.STREAM_URL,to:E.STREAM_URL},{from:a.CONFIG,to:E.CONFIG},{from:a.UPDATE_SOURCE,to:E.UPDATE_SOURCE}],M=[{type:E.CONFIG,listener:g}];return v(),{destroy:I}}return{create:y}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="logicManager.";return{BASE:e,API_PLAY:e+"apiPlay",API_PAUSE:e+"apiPause",NETWORK_CONNECTING:e+"networkConnecting",NETWORK_CONNECTED:e+"networkConnected",NETWORK_DISCONNECTED:e+"networkDisconnected",NETWORK_RECONNECTION_IMMINENT:e+"networkReconnectionImminent",NETWORK_RECONNECTING:e+"networkReconnecting",NETWORK_CONNECTION_ERROR:e+"networkConnectionError",NETWORK_INITIALIZATION_ERROR:e+"networkInitializationError",NETWORK_MAX_RETRY_REACHED:e+"networkMaxRetryReached",NETWORK_ERROR:e+"networkError",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",STREAM_URL:e+"streamUrl",CONFIG:e+"config",BUFFER_TWEAKS_CREATED:e+"tweaksCreated",PLAYING:e+"playing",BUFFERING:e+"buffering",PLAY_STATS:e+"playStats",APPLICATION_STATE_CHANGE:e+"applicationStateChange",CAN_PLAY:e+"canPlay",META_DATA:e+"metaData",UPDATE_SOURCE:e+"updateSource",FRAME_DROP:e+"frameDrop",VIEWPORT_VISIBLE:e+"viewportvisible",VIEWPORT_HIDDEN:e+"viewporthidden"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="api.";return{PLAY:e+"play",PAUSE:e+"pause"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="liveBufferControl.";return{BASE:e,SEEK:e+"seek",RATE:e+"rate"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="connection.";return{BASE:e,CONNECT:e+"connect",DISCONNECT:e+"disconnect",VIDEO_SOURCE:e+"videoSource",NETWORK_PLAY:e+"networkPlay",NO_SERVER_ERROR:e+"noServerError",MISSING_RTMP_ERROR:e+"missingRtmpError",SERVER_INFO:e+"serverInfo",NO_KEEP_CONNECTION:e+"noKeepConnection",URL:e+"url"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="timeout.";return{BASE:e,LOADING_TIMEOUT:e+"loadingTimeout",BUFFERING_TIMEOUT:e+"bufferingTimeout"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="streamInfo.";return{BASE:e,CREATED:e+"created",UPDATED:e+"updated",MIME_TYPE_UNSUPPORTED:e+"mimetypeUnsupported"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="metaData.";return{BASE:e,RECEIVED:e+"received",ERROR:e+"error"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="visibility.";return{BASE:e,HIDDEN:e+"hidden",VISIBLE:e+"visible"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(16),n(43),n(40),n(27),n(49)],i=function(e,t,n,r,i,o,a){function s(s){function u(){b.debug("init"),n.add({target:s,listeners:Y})}function c(){n.remove({target:s,listeners:Y})}function d(e){b.debug(e.name+": network state change from "+g(C)+" to "+g(e.connectionState)),C=e.connectionState}function f(e){if(G){var t=e.data.onServerInfo.capabilities,n=e.data.onServerInfo.serverVersion,i=parseFloat(n);t.indexOf("onPlay")===-1&&t.indexOf("onPause")===-1&&(G=!1,s.emit(r.NO_KEEP_CONNECTION,{message:i<1.8?"The keepConnection feature is enabled by the players config, but is not supported by this server version ("+n+"). Use at least server version 1.8.0.0. The feature will be disabled.":"The keepConnection feature is enabled by the players config, but is not enabled by this server ("+n+"). The feature will be disabled."}),k||A())}s.emit(r.SERVER_INFO,e.data)}function E(e){var t=e.data.config;R(t.source.h5live),_(t.source.h5live.server),N(t.source.h5live.security),D=t.id,F=t.playback.metadata,G=t.playback.keepConnection,k=t.playback.autoplay,G&&T()}function l(e){x=!0;var t=e.data.source;b.debug("update source: "+JSON.stringify(t)),R(t.h5live),_(t.h5live.server),N(t.h5live.security),G?k||(x=!1,A(!0),T()):x=!1}function p(){if(k=!0,C===o.OPEN?(b.debug("send network play"),s.emit(r.NETWORK_PLAY)):M||T(),t.useHLS){var e=h("hls")+S()+O()+I();s.emit(r.VIDEO_SOURCE,{src:e,type:a.HLS}),s.emit(r.URL,{url:e})}}function m(){k=!1,G&&!x||(x=!1,A()),t.useHLS&&s.emit(r.VIDEO_SOURCE,{src:"",type:a.HLS})}function T(){if(C!==o.OPEN&&(F||U||!t.useHLS)){k?v("paused"):y("paused"),F&&t.useHLS?y("metastreamonly"):v("metastreamonly"),!F&&U&&t.useHLS?y("checkandclose"):v("checkandclose");var e=S()+O()+I(),n=h("websocket"),i=n+"/"+e;b.debug("connect to: "+i,1),s.emit(r.CONNECT,{url:i}),t.useHLS||s.emit(r.URL,{url:i})}}function A(e){b.debug("disconnecting"),s.emit(r.DISCONNECT,{silent:!!e})}function _(e){if("object"==typeof e){for(var t=["websocket","hls","progressive"],n=0;n<t.length;n++)e[t[n]]&&"string"==typeof e[t[n]]&&0!==e[t[n]].length&&(P||(P={}),P[t[n]]=e[t[n]]);b.debug("set connection server: "+JSON.stringify(P),3)}"undefined"==typeof P&&s.emit(r.NO_SERVER_ERROR)}function h(e){return"string"==typeof P[e]&&0!==P[e].length?(b.debug('get connection server from type "'+e+'": '+P[e],3),P[e]):(s.emit(r.NO_SERVER_ERROR),"")}function R(e){b.debug("set connection config",3);var t,n=e.rtmp,i=e.params;if("object"==typeof n&&n.url&&n.url.length&&n.streamname&&n.streamname.length||i){for(t in n)if(n.hasOwnProperty(t)){var o=t.replace("name","");L.hasOwnProperty(o)&&(L[o]=n[t],b.debug("set connection config rtmp: "+o+":"+L[o]))}}else s.emit(r.MISSING_RTMP_ERROR);if(e.token&&L.hasOwnProperty("token")&&(L.token=e.token,b.debug("set connection config token: "+L.token)),"object"==typeof i)for(t in i)i.hasOwnProperty(t)&&(L[t]=i[t],b.debug("set connection param: "+t+":"+L[t]))}function N(e){if(U=null,e){U={},b.debug("set security config",3);for(var t in e)e.hasOwnProperty(t)&&e[t].length&&(U[t]=e[t],b.debug("set security config "+t+": "+U[t]))}}function S(){var e="?";for(var t in L)L.hasOwnProperty(t)&&("cid"===t&&(L[t]=Math.round(1e6*Math.random()).toString()),"pid"!==t||L[t].length||(L[t]=D),L[t].length&&(e+=t+"="+encodeURIComponent(L[t])+"&"));return e.lastIndexOf("&")===e.length-1&&(e=e.substr(0,e.length-1)),e}function O(){var e="&";for(var t in U)U.hasOwnProperty(t)&&U[t].length&&(e+=t+"="+encodeURIComponent(U[t])+"&");return e.lastIndexOf("&")===e.length-1&&(e=e.substr(0,e.length-1)),e}function y(e){w.indexOf(e)===-1&&w.push(e)}function v(e){w=w.filter(function(t){return t!==e})}function I(){for(var e="",t="&flags=",n=0,r=w.length;n<r;n+=1)e+=w[n],n===r-1?e=t+encodeURIComponent(e):e+=",";return e}function g(e){for(var t in o)if(o.hasOwnProperty(t)&&o[t]===e)return t}var C,D,b=e.create("Connection"),P={websocket:"",hls:"",progressive:""},L={url:"",stream:"",cid:"",pid:"",token:""},U=null,w=[],M=!1,F=!1,G=!1,k=!0,x=!1,Y=[{type:i.NETWORK_CONNECTING,listener:d},{type:i.NETWORK_CONNECTED,listener:d},{type:i.NETWORK_DISCONNECTED,listener:d},{type:i.NETWORK_RECONNECTING,listener:d},{type:i.NETWORK_RECONNECTION_IMMINENT,listener:d},{type:i.NETWORK_INITIALIZATION_ERROR,listener:d},{type:i.NETWORK_ERROR,listener:d},{type:i.SERVER_INFO,listener:f},{type:i.CONFIG,listener:E},{type:i.UPDATE_SOURCE,listener:l},{type:i.API_PLAY,listener:p},{type:i.API_PAUSE,listener:m}];return u(),{destroy:c}}return{create:s}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({MP4:"video/mp4",MP4_MS:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"',HLS:"application/vnd.apple.mpegURL"})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(16),n(42),n(40),n(8)],i=function(e,t,n,r,i,o){function a(a){function s(){O.debug("init"),n.add({target:a,listeners:U}),t.isIEorEdge&&n.add({target:a,listeners:w})}function u(){n.remove({target:a,listeners:U}),t.isIEorEdge&&n.remove({target:a,listeners:w})}function c(e){y.buffer=e.data.tweaks.buffer}function d(e){for(I.push(e.data.onRandomAccessPoint.streamTime/1e3);I.length>10;)I.shift()}function f(e){t.isIEorEdge&&"extreme"===e.data.type&&b&&!D&&N===o.PLAYING&&(O.debug("hidden-to-visible change and extreme frame drop detected"),O.debug("try seeking to last RAP to get stable playback"),h(I.length?I[I.length-1]:0))}function E(){D=!1,p()}function l(){D=!0,p()}function p(){O.debug("viewport changed to "+(D?"hidden":"visible")),clearTimeout(P),P=setTimeout(function(){b=!1,O.debug("viewport change timeout")},L),b=!0}function m(e){switch(n.remove({target:a,listeners:M}),N=e.data.state){case o.PLAYING:n.add({target:a,listeners:M})}}function T(e){S=e.data.stats,C=e.data.playbackRate,v=e.data.currentTime,e.data.buffered&&e.data.buffered.length&&(g=S.buffer.end>g+.1?S.buffer.end:g,y.buffer.max<S.buffer.delay.current&&S.buffer.end>y.buffer.min?(O.debug("tweaks.buffer.max ("+y.buffer.max+") < stats.buffer.delay.current ("+S.buffer.delay.current+") && stats.buffer.end ("+S.buffer.end+") > tweaks.buffer.min ("+y.buffer.min+")"),_(y.buffer.target)):y.buffer.limit<S.buffer.delay.current?t.isIEorEdge?_(y.buffer.target):A(1.1):y.buffer.target>S.buffer.delay.current&&A(1))}function A(e){C!==e&&(O.debug("set rate to "+e),a.emit(r.RATE,{rate:e}))}function _(e){var n=g-e;t.isIEorEdge&&(n=R(v,n),n<0)||h(n)}function h(e){O.debug("seeking to "+e),a.emit(r.SEEK,{position:e})}function R(e,t){for(var n=0;n<I.length;++n)if(I[n]>e&&I[n]<=t)return I[n];return-1}var N,S,O=e.create("WSSLiveController"),y={},v=0,I=[],g=0,C=1,D=!1,b=!1,P=0,L=5e3,U=[{type:i.APPLICATION_STATE_CHANGE,listener:m},{type:i.BUFFER_TWEAKS_CREATED,listener:c},{type:i.RANDOM_ACCESS_POINT,listener:d},{type:i.FRAME_DROP,listener:f}],w=[{type:i.VIEWPORT_VISIBLE,listener:E},{type:i.VIEWPORT_HIDDEN,listener:l}],M=[{type:i.PLAY_STATS,listener:T}];return s(),{destroy:u}}return{create:a}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(16),n(42),n(40),n(8)],i=function(e,t,n,r,i,o){function a(t){function a(){p.debug("init"),n.add({target:t,listeners:_})}function s(){n.remove({target:t,listeners:_})}function u(e){for(var t in e.data.tweaks.buffer)e.data.tweaks.buffer[t]!==T.buffer[t]&&(m=!1);m||(T.buffer=e.data.tweaks.buffer)}function c(e){switch(n.remove({target:t,listeners:h}),E=e.data.state){case o.PLAYING:n.add({target:t,listeners:h})}}function d(e){l=e.data.stats,A=e.data.playbackRate,e.data.buffered&&e.data.buffered.length&&(m?l.buffer.update.avg>0&&l.buffer.update.avg+T.buffer.limit-.7<l.buffer.delay.avg?f(1.1):l.buffer.update.avg>0&&l.buffer.update.avg+T.buffer.min<l.buffer.delay.avg<=l.buffer.update.avg+T.buffer.target-.7?f(1):l.buffer.update.avg>=0&&l.buffer.update.avg>=l.buffer.delay.avg&&f(.9):T.buffer.limit<l.buffer.delay.avg?f(1.1):T.buffer.start<l.buffer.delay.avg<=T.buffer.target?f(1):T.buffer.min>=l.buffer.delay.avg&&f(.9))}function f(e){A!==e&&(p.debug("set rate to: "+e),t.emit(r.RATE,{rate:e}))}var E,l,p=e.create("HLSLiveController"),m=!0,T={buffer:{max:8,min:.2,start:.5,target:1.2,limit:1.7}},A=1,_=[{type:i.APPLICATION_STATE_CHANGE,listener:c},{type:i.BUFFER_TWEAKS_CREATED,listener:u}],h=[{type:i.PLAY_STATS,listener:d}];return a(),{destroy:s}}return{create:a}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(16),n(40),n(45),n(8),n(53),n(49)],i=function(e,t,n,r,i,o,a,s){function u(u){function c(){R.debug("init"),n.add({target:u,listeners:N})}function d(){n.remove({target:u,listeners:N})}function f(e,t){_=t.data.onStreamInfo,R.debug(JSON.stringify(_));var n=_&&_.mimeType?_.mimeType:s.MP4_MS;if(window.MediaSource.isTypeSupported(n)){var r={},o=[a.PREROLL_DURATION,a.MIME_TYPE];for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];a.hasOwnProperty(c)&&_.hasOwnProperty(d)&&o.indexOf(d)===-1&&(r[d]=_[d])}_=r,_.url=h,u.emit(e,{streamInfo:_})}else u.emit(i.MIME_TYPE_UNSUPPORTED)}function E(e){A=e.data.state}function l(e){h=e.data.url}function p(e){A!==o.READY&&f(i.CREATED,e)}function m(e){A!==o.BUFFERING&&A!==o.PLAYING||f(i.UPDATED,e)}function T(e){t.useHLS&&A===o.LOADING&&(_={haveAudio:e.data.haveAudio,haveVideo:e.data.haveVideo,audioInfo:e.data.haveAudio?{bitsPerSample:null,channels:null,sampleRate:null}:null,videoInfo:e.data.haveVideo?{width:e.data.videoWidth,height:e.data.videoHeight,frameRate:null}:null},_.url=h,u.emit(i.CREATED,{streamInfo:_}))}var A,_,h,R=e.create("StreamInfo"),N=[{type:r.APPLICATION_STATE_CHANGE,listener:E},{type:r.STREAM_INFO,listener:p},{type:r.STREAM_INFO_UPDATE,listener:m},{type:r.STREAM_URL,listener:l},{type:r.CAN_PLAY,listener:T}];return c(),{destroy:d}}return{create:u}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return Object.freeze({HAVE_VIDEO:"haveVideo",HAVE_AUDIO:"haveAudio",VIDEO_INFO:"videoInfo",AUDIO_INFO:"audioInfo",PREROLL_DURATION:"prerollDuration",MIME_TYPE:"mimeType"})}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(16),n(42),n(40),n(44),n(8)],i=function(e,t,n,r,i,o,a){function s(t){function r(){N.debug("init"),n.add({target:t,listeners:S})}function s(){clearTimeout(h),clearTimeout(R),n.remove({target:t,listeners:S})}function p(e){switch(_=e.data.state){case a.READY:case a.PLAYING:case a.PAUSED:clearTimeout(h),clearTimeout(R)}_===a.BUFFERING?T():clearTimeout(R),_===a.LOADING&&A(e.data.connectDelay)}function m(e){var t=e.data.config,n=1e3*t.playback.timeouts.loading,r=1e3*t.playback.timeouts.buffering;u=Math.max(Math.min(n,d),c),f=Math.max(Math.min(r,l),E)}function T(){clearTimeout(R),R=setTimeout(function(){t.emit(o.BUFFERING_TIMEOUT,{delay:f})},f)}function A(e){clearTimeout(h),h=setTimeout(function(){t.emit(o.LOADING_TIMEOUT,{delay:u+e})},u+e)}var _,h,R,N=e.create("Timeout"),S=[{type:i.APPLICATION_STATE_CHANGE,listener:p},{type:i.CONFIG,listener:m}];return r(),{destroy:s}}var u=2e4,c=1e4,d=6e4,f=2e4,E=1e4,l=6e4;return{create:s}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(16),n(14),n(8),n(40),n(46)],i=function(e,t,n,r,i,o,a){function s(s){function u(){S.debug("init"),n.add({target:s,listeners:O})}function c(){n.remove({target:s,listeners:O})}function d(){N=0,T=!0,A={handlerName:"",streamTime:0,message:[]},_=[],h=[],R=0}function f(e){switch(m=e.data.state){case i.LOADING:d(),n.add({target:s,listeners:y});break;case i.PAUSING:n.remove({target:s,listeners:y})}}function E(e){S.debug("onMetaData");var t=e.data[e.data.eventType];if(1===t.chunkIndex)"function"==typeof A.message.push&&0!==A.message.length&&s.emit(a.ERROR,{code:r.STREAM.METADATA_STILL_PROCESSING,message:"Received metadata with start index but currently process another. Discard old one."}),T=!0,A={handlerName:t.handlerName,streamTime:t.streamTime,message:[]};else{if(0===A.message.length||"function"!=typeof A.message.push)return void(T&&(s.emit(a.ERROR,{code:r.STREAM.METADATA_NO_START_INDEX,message:"Received metadata but no start index. Discard."}),T=!1,A.message=[]));if(!T)return}if(A.message.push(t.message),A.message.length!==t.chunkIndex)T&&(s.emit(a.ERROR,{code:r.STREAM.METADATA_WRONG_INDEX,message:"Received metadata with wrong index. Discard."}),T=!1,A.message=[]);else if(t.chunkCount-t.chunkIndex===0)try{var n=A.message.join(""),i=A.handlerName;S.debug("handlerName="+i+", metaData="+n),n=JSON.parse(n),A.message=n;var o={handlerName:A.handlerName,streamTime:A.streamTime,message:A.message};_.push(o)}catch(e){s.emit(a.ERROR,{code:r.STREAM.METADATA_INVALID_JSON,message:"Received metadata with invalid json string."})}}function l(e){for(N=e.data.currentTime;_.length;){var n=_.shift(),r=t.useHLS&&e.data.stats.buffer.delay.avg?e.data.stats.buffer.delay.avg:0;n.streamTime+R+r<=N?(n.streamTime+=R+r,s.emit(a.RECEIVED,n)):h.push(n)}for(;h.length;)_.push(h.shift())}function p(){R=m===i.PLAYING&&t.useHLS?N:0}var m,T,A,_,h,R,N,S=e.create("MetaData"),O=[{type:o.APPLICATION_STATE_CHANGE,listener:f}],y=[{type:o.META_DATA,listener:E},{type:o.PLAY_STATS,listener:l},{type:o.NETWORK_CONNECTED,listener:p}];return u(),{destroy:c};
}return{create:s}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(16),n(26),n(40),n(47)],i=function(e,t,n,r){function i(i){function o(){E.debug("initialize"),e.add({target:i,listeners:p}),"undefined"!=typeof document.hidden?(c="hidden",d="visibilitychange"):"undefined"!=typeof document.msHidden?(c="msHidden",d="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(c="webkitHidden",d="webkitvisibilitychange"),document.addEventListener(d,s)}function a(){e.remove({target:i,listeners:p}),document.removeEventListener(d,s)}function s(){l=document[c],E.debug(l?"hidden":"visible"),i.emit(l?r.HIDDEN:r.VISIBLE)}function u(e){f||(E.debug("initial player state"),s()),f=e.data.state}var c,d,f,E=t.create("VisibilityProxy"),l=!1,p=[{type:n.APPLICATION_STATE_CHANGE,listener:u}];return o(),{destroy:a}}return{create:i}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(4),n(16),n(30),n(33),n(15),n(58),n(59),n(60),n(61),n(62)],i=function(e,t,n,r,i,o,a,s,u,c){"use strict";function d(t){function d(){E=i.create(t,p,A),l=i.create(p,t,T),m.push(c.create(p)),m.push(u.create(p))}function f(){for(E.destroy(),E=null,l.destroy(),l=null;m.length;)m.pop().destroy()}var E,l,p=new e,m=[],T=[{from:s.CONNECTING,to:r.CONNECTING},{from:s.CONNECTED,to:r.CONNECTED},{from:s.RESUMING,to:r.RESUMING},{from:s.DESTROYED,to:r.DESTROYED},{from:s.RECONNECTING,to:r.RECONNECTING},{from:s.RECONNECTION_IMMINENT,to:r.RECONNECTION_IMMINENT},{from:s.RECONNECTION_CONFIG_INVALID,to:r.RECONNECTION_CONFIG_INVALID},{from:s.DISCONNECTED,to:r.DISCONNECTED},{from:s.INITIALIZATION_ERROR,to:r.INITIALIZATION_ERROR},{from:s.ERROR,to:r.ERROR},{from:a.META_DATA,to:r.META_DATA},{from:a.RANDOM_ACCESS_POINT,to:r.RANDOM_ACCESS_POINT},{from:a.SERVER_INFO,to:r.SERVER_INFO},{from:a.STREAM_INFO,to:r.STREAM_INFO},{from:a.STREAM_INFO_UPDATE,to:r.STREAM_INFO_UPDATE},{from:a.RAW_PACKET,to:r.RAW_PACKET},{from:a.STREAM_FRAGMENT,to:r.STREAM_FRAGMENT},{from:a.STREAM_STATUS,to:r.STREAM_STATUS}],A=[{from:n.CONNECT,to:o.CONNECT},{from:n.DISCONNECT,to:o.DISCONNECT},{from:n.NETWORK_PLAY,to:o.PLAY},{from:n.PAUSE,to:o.PAUSE},{from:n.CONFIG,to:o.CONFIG}];return d(),{destroy:f}}return{create:d}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="networkmanager.";return{BASE:e,CONNECT:e+"connect",DISCONNECT:e+"disconnect",PLAY:e+"play",PAUSE:e+"pause",CONFIG:e+"config"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="message.";return{BASE:e,META_DATA:e+"metaData",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",RAW_PACKET:e+"raw",STREAM_STATUS:e+"streamStatus"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="wss.";return{BASE:e,CONNECTING:e+"connecting",CONNECTED:e+"connected",DISCONNECTED:e+"disconnected",RESUMING:e+"resuming",MESSAGE:e+"message",RECONNECTION_IMMINENT:e+"reconnectionImminent",RECONNECTING:e+"reconnecting",RECONNECTION_CONFIG_INVALID:e+"reconnectionConfigInvalid",CONNECTION_ERROR:e+"connectionError",INITIALIZATION_ERROR:e+"initializationError",DESTROYED:e+"destroyed",ERROR:e+"error",STATE_CHANGE:e+"stateChange"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(16),n(59),n(60)],i=function(e,t,n){"use strict";function r(r){function i(){e.add({target:r,listeners:d})}function o(){e.remove({target:r,listeners:d})}function a(e){if(e){var n=e.data;if("string"==typeof n){var i=JSON.parse(n);if(i&&i.eventType){var o=i.eventType.substr(2,i.eventType.length-2),a=t.BASE+o[0].toLowerCase()+o.slice(1);a===t.STREAM_INFO&&s(),r.emit(a,i)}}else if(n instanceof ArrayBuffer&&n.byteLength>0){var d=new Uint8Array(n);if(r.emit(t.RAW_PACKET),n.byteLength>=8&&109===d[4]&&111===d[5]&&111===d[6]&&102===d[7]){for(var f=new Uint8Array(c),E=0,l=0;l<u.length;l++)f.set(u[l],E),E+=u[l].length;s(),r.emit(t.STREAM_FRAGMENT,f)}u.push(d),c+=n.byteLength}}}function s(){for(;u.length;)u.pop();c=0}var u=[],c=0,d=[{type:n.MESSAGE,listener:a}];return i(),{destroy:o}}return{create:r}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(22),n(16),n(27),n(58),n(60),n(63),n(64),n(65)],i=function(e,t,n,r,i,o,a,s,u,c){function d(e){function d(){r.add({target:e,listeners:x})}function m(){f.debug("destroy"),b(),r.remove({target:e,listeners:x})}function T(t){j=!1,clearTimeout(M),G=t.data,G.count=q.retryCount;try{C(G.url),e.emit(t.name?a.CONNECTING:a.RECONNECTING,w(G))}catch(t){e.emit(a.INITIALIZATION_ERROR,w(L(t)))}}function A(){try{G=c.create(G,!1),null===Y?C(G.url):(f.debug("sending play to server"),P("onPlay"),e.emit(a.RESUMING,w()))}catch(t){e.emit(a.ERROR,w(L(t)))}}function _(){try{null!==Y&&(f.debug("sending pause to server"),G=c.create(G,!0),P("onPause"))}catch(t){e.emit(a.ERROR,w(L(t)))}}function h(){try{null!==Y&&K&&(f.debug("sending ping to server"),P("onPing"))}catch(t){e.emit(a.ERROR,w(L(t)))}}function R(t){if(t.data.config.playback.reconnect){var n=s.validate(t.data.config.playback.reconnect);if(n.success)for(var r in t.data.config.playback.reconnect)t.data.config.playback.reconnect.hasOwnProperty(r)&&(q[r]=t.data.config.playback.reconnect[r]);else e.emit(a.RECONNECTION_CONFIG_INVALID,w({reason:n.reason}))}if(t.data.config.playback.timeouts){var i=1e3*t.data.config.playback.timeouts.connecting;E=Math.max(Math.min(i,p),l)}}function N(e){D(e.data.silent)}function S(){setTimeout(function(){j||null===Y||(clearTimeout(B),K&&(H=setInterval(h,W)),e.emit(a.CONNECTED,w({count:q.retryCount})),q.retryCount=0)},200)}function O(e){clearTimeout(B),clearInterval(H);var r=e;t.isIEorEdge&&1005===e.code&&(r=n.copy(e),r.code=parseInt(e.reason.split(" ")[1])),4200===r.code?D(!0):g(r,a.DISCONNECTED,w({code:r.code}))}function y(t){e.emit(a.MESSAGE,w(t.data))}function v(e){clearTimeout(F),F=setTimeout(function(){j||null===Y||(clearTimeout(B),g(e,a.CONNECTION_ERROR,w(e)))},200)}function I(){j||null===Y||g(null,a.INITIALIZATION_ERROR,w({message:"Could not open connection. Timeout reached."}))}function g(t,n,r){if(!j)if(clearTimeout(M),M=0,(t&&t.data&&k.indexOf(t.data.code)!==-1||r&&r.data&&k.indexOf(r.data.code)!==-1)&&q.retryCount<q.maxRetries){if(j=!0,!q.retryCount){for(;q.delays.length;)q.delays.pop();q.delays=u.calculate(q.minDelay,q.maxDelay,q.delaySteps,q.maxRetries,q.randomFactor)}var i=q.delays[q.retryCount];q.retryCount++;var o=G;o.count=q.retryCount,M=setTimeout(T.bind(null,{data:o}),i);var s=t&&t.data&&t.data.code?t.data.code:t&&t.code?t.code:0;s&&(s=r&&r.data&&r.data.code?r.data.code:r&&r.code?r.code:0),e.emit(a.RECONNECTION_IMMINENT,{delay:i,count:q.retryCount,code:s})}else e.emit(n,r)}function C(e){b(),Y=new WebSocket(e),Y.binaryType="arraybuffer",Y.onopen=S,Y.onclose=O,Y.onmessage=y,Y.onerror=v,B=setTimeout(I,E)}function D(t){b(),e.emit(a.DESTROYED,w({silent:!!t}))}function b(){clearTimeout(B),clearTimeout(M),clearTimeout(F),clearInterval(H),null!==Y&&(Y.onopen=null,Y.onclose=null,Y.onmessage=null,Y.onerror=null,Y.close(),Y=null)}function P(e){Y.send('{"eventType":"'+e+'", "'+e+'":{}}')}function L(e){return{code:e.code,name:e.name,message:e.message}}function U(){return V=null!==Y?Y.readyState+2:i.UNINITIALIZED}function w(e){return{connectionState:U(),data:e||void 0}}var M,F,G,k=[1002,1003,1005,1006,1007,1008,1009,1011,1015,4500,4503],x=[{type:o.CONNECT,listener:T},{type:o.DISCONNECT,listener:N},{type:o.PLAY,listener:A},{type:o.PAUSE,listener:_},{type:o.CONFIG,listener:R}],Y=null,V=i.UNINITIALIZED,B=0,H=0,W=5e4,K=!1,j=!1,q={minDelay:2,maxDelay:10,delaySteps:10,maxRetries:10,delays:[],retryCount:0,randomFactor:1.5};return d(),{destroy:m}}var f=e.create("websocket"),E=5e3,l=5e3,p=3e4;return{create:d}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e){for(var t=["minDelay","maxDelay","delaySteps","maxRetries"],n=0;n<t.length;++n){if(!e.hasOwnProperty(t[n]))return{success:!1,reason:"The reconnect config is invalid, it must contain 'minDelay', 'maxDelay', 'delaySteps', and 'maxRetries'. Reset to default."};if("number"!=typeof e[t[n]])return{success:!1,reason:"The reconnect config is invalid, the value '"+t[n]+"' have to be a number. Reset to default."}}return e[t[0]]>e[t[1]]?{success:!1,reason:"The reconnect config is invalid, the value '"+t[0]+"' have to be lower then '"+t[1]+"'. Reset to default."}:e[t[0]]<1?{success:!1,reason:"The reconnect config is invalid, the value '"+t[0]+"' have to be greater or equal then 1 sec. Reset to default."}:{success:!0}}return{validate:e}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e,t,n,r,i){var o=[],a=Math.sqrt(e),s=Math.sqrt(t);n>r&&(n=r);for(var u=(s-a)/(n-1),c=0;c<r;c+=1){var d=i*(Math.random()-.5),f=a+u*Math.min(n-1,c)+(!c&&a-Math.abs(d)<=.5?Math.abs(d)+i*Math.random():d),E=Math.round(f*f*1e3);o.push(E)}return o}return{calculate:e}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e,t){var n=e.url.split("&flags=");if(n.length>1&&(n[1]=decodeURIComponent(n[1])),t)n.length>1&&n[1].indexOf("paused")===-1?e.url=n[0]+"&flags="+encodeURIComponent("paused,"+n[1]):1===n.length&&(e.url+="&flags=paused");else if(n.length>1&&n[1].indexOf("paused")!==-1){var r=n[1].split(",");if(1===r.length)e.url=e.url.replace("&flags=paused","");else{e.url=n[0]+"&flags=";for(var i=0;i<r.length;i+=1)"paused"!==r[i]&&(e.url+=encodeURIComponent(r[i]),e.url+=encodeURIComponent(r.length>2&&i<r.length-1?",":""))}}return e}return{create:e}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(4),n(10),n(16),n(15),n(49),n(30),n(32),n(31),n(33),n(68),n(69),n(70),n(71),n(72),n(67),n(73),n(74),n(75),n(76),n(77),n(80),n(84),n(88),n(89),n(90),n(91),n(92),n(93),n(94)],i=function(e,t,n,r,i,o,a,s,u,c,d,f,E,l,p,m,T,A,_,h,R,N,S,O,y,v,I,g,C,D,b){"use strict";function P(r){function P(){i.add({target:F,listeners:x}),w=o.create(r,F,V),M=o.create(F,r,Y),k.push(R.create(F)),k.push(N.create(F)),k.push(S.create(F)),t.hasMediaSource&&k.push(O.create(F))}function L(e){G.debug("creating media handlers"),k.push(g.create(F)),k.push(D.create(F)),e.data.type===a.MP4?(k.push(v.create(F)),k.push(C.create(F)),k.push(b.create(F))):k.push(I.create(F)),t.isChromeHigher57&&k.push(y.create(F)),i.remove({target:F,listeners:x})}function U(){for(w.destroy(),w=null,M.destroy(),M=null;k.length;)k.pop().destroy()}var w,M,F=new n,G=e.create("MediaManager"),k=[],x=[{type:l.VIDEO_SOURCE,listener:L}],Y=[{from:p.LOAD_START,to:c.LOAD_START},{from:p.PROGRESS,to:c.PROGRESS},{from:p.SUSPEND,to:c.SUSPEND},{from:p.ABORT,to:c.ABORT},{from:p.EMPTIED,to:c.EMPTIED},{from:p.STALLED,to:c.STALLED},{from:p.PLAY,to:c.PLAY},{from:p.PAUSE,to:c.PAUSE},{from:p.LOADED_META_DATA,to:c.LOADED_META_DATA},{from:p.LOADED_DATA,to:c.LOADED_DATA},{from:p.WAITING,to:c.WAITING},{from:p.ERROR,to:c.ERROR},{from:p.PLAYING,to:c.PLAYING},{from:p.CAN_PLAY,to:c.CAN_PLAY},{from:p.CAN_PLAY_THROUGH,to:c.CAN_PLAY_THROUGH},{from:p.SEEKING,to:c.SEEKING},{from:p.SEEKED,to:c.SEEKED},{from:p.TIME_UPDATE,to:c.TIME_UPDATE},{from:p.ENDED,to:c.ENDED},{from:p.RATE_CHANGE,to:c.RATE_CHANGE},{from:p.DURATION_CHANGE,to:c.DURATION_CHANGE},{from:p.VOLUME_CHANGE,to:c.VOLUME_CHANGE},{from:p.ELEMENT_CREATED,to:c.ELEMENT_CREATED},{from:p.PLAY_START_SUCCESS,to:c.PLAY_START_SUCCESS},{from:p.PLAY_START_ERROR,to:c.PLAY_START_ERROR},{from:p.VIEWPORT_VISIBLE,to:c.VIEWPORT_VISIBLE},{from:p.VIEWPORT_HIDDEN,to:c.VIEWPORT_HIDDEN},{from:E.ERROR,to:c.PLAYBACK_ERROR},{from:E.SUSPENDED,to:c.PLAYBACK_SUSPENDED},{from:A.QUALITY_STATS,to:c.QUALITY_STATS},{from:A.FRAME_DROP,to:c.FRAME_DROP},{from:_.PLAY_STATS,to:c.PLAY_STATS},{from:m.SOURCE_OPEN,to:c.SOURCE_OPEN},{from:m.SOURCE_ENDED,to:c.SOURCE_ENDED},{from:m.SOURCE_CLOSED,to:c.SOURCE_CLOSED},{from:f.PLAYBACK_STARTED,to:c.PLAYBACK_STARTED},{from:f.BUFFERING,to:c.BUFFERING},{from:h.BUFFER_TWEAKS_CREATED,to:c.BUFFER_TWEAKS_CREATED},{from:h.BUFFER_TWEAKS_ERROR,to:c.BUFFER_TWEAKS_ERROR}],V=[{from:s.CREATE_VIDEO,to:l.CREATE_VIDEO},{from:s.DESTROY_VIDEO,to:l.DESTROY_VIDEO},{from:s.VIDEO_SOURCE,to:l.VIDEO_SOURCE},{from:s.PLAY,to:l.PLAY},{from:s.PAUSE,to:l.PAUSE},{from:s.SEEK,to:l.SEEK},{from:s.MUTE,to:l.MUTE},{from:s.UNMUTE,to:l.UNMUTE},{from:s.SET_VOLUME,to:l.SET_VOLUME},{from:s.SET_RATE,to:l.SET_RATE},{from:s.UPDATE_SOURCE,to:l.UPDATE_SOURCE},{from:s.CONFIG,to:T.CONFIG},{from:d.SERVER_INFO,to:T.SERVER_INFO},{from:d.STREAM_INFO,to:T.STREAM_INFO},{from:d.STREAM_INFO_UPDATE,to:T.STREAM_INFO_UPDATE},{from:d.STREAM_FRAGMENT,to:T.STREAM_FRAGMENT},{from:d.RANDOM_ACCESS_POINT,to:T.RANDOM_ACCESS_POINT},{from:u.STATE_CHANGE,to:T.APPLICATION_STATE_CHANGE},{from:u.STARTUP_STATS,to:T.STARTUP_STATS},{from:u.DOCUMENT_VISIBLE,to:T.DOCUMENT_VISIBLE},{from:u.DOCUMENT_HIDDEN,to:T.DOCUMENT_HIDDEN}];return P(),{destroy:U}}return{create:P}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="mediaManager.";return{BASE:e,CONFIG:e+"config",SERVER_INFO:e+"serverInfo",STREAM_INFO:e+"streamInfo",STREAM_INFO_UPDATE:e+"streamInfoUpdate",STREAM_FRAGMENT:e+"streamFragment",RANDOM_ACCESS_POINT:e+"randomAccessPoint",APPLICATION_STATE_CHANGE:e+"applicationStateChange",STARTUP_STATS:e+"startupStats",DOCUMENT_VISIBLE:e+"documentVisible",DOCUMENT_HIDDEN:e+"documentHidden"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="mediaControl.";return{BASE:e,PLAYBACK_STARTED:e+"playbackStarted",BUFFERING:e+"buffering"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="mediaHandler.";return{BASE:e,ERROR:e+"error",SUSPENDED:e+"suspended"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="mediaControl.";return{BASE:e,CREATE_VIDEO:e+"createVideo",DESTROY_VIDEO:e+"destroyVideo",VIDEO_SOURCE:e+"videoSource",UPDATE_SOURCE:e+"updateSource",PLAY:e+"play",PAUSE:e+"pause",SEEK:e+"seek",MUTE:e+"mute",UNMUTE:e+"unmute",SET_VOLUME:e+"volume",SET_RATE:e+"playbackRate"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="mediaElementProxy.";return{BASE:e,LOAD_START:e+"loadstart",PROGRESS:e+"progress",SUSPEND:e+"suspend",ABORT:e+"abort",EMPTIED:e+"emptied",STALLED:e+"stalled",PLAY:e+"play",PAUSE:e+"pause",LOADED_META_DATA:e+"loadedmetadata",LOADED_DATA:e+"loadeddata",WAITING:e+"waiting",ERROR:e+"error",PLAYING:e+"playing",CAN_PLAY:e+"canplay",CAN_PLAY_THROUGH:e+"canplaythrough",SEEKING:e+"seeking",SEEKED:e+"seeked",TIME_UPDATE:e+"timeupdate",ENDED:e+"ended",RATE_CHANGE:e+"ratechange",DURATION_CHANGE:e+"durationchange",VOLUME_CHANGE:e+"volumechange",QUALITY_UPDATE:e+"qualityupdate",ELEMENT_CREATED:e+"elementCreated",PLAY_START_SUCCESS:e+"playStartSuccess",PLAY_START_ERROR:e+"playStartError",VIEWPORT_VISIBLE:e+"viewportvisible",VIEWPORT_HIDDEN:e+"viewporthidden"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="mediaSourceProxy.";return{BASE:e,SOURCE_OPEN:e+"sourceopen",SOURCE_ENDED:e+"sourceended",SOURCE_CLOSED:e+"sourceclosed",SOURCE_READY:e+"sourceready"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="qualityHandler.";return{BASE:e,QUALITY_STATS:e+"qualitystats",FRAME_DROP:e+"framedrop"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="statsCollector.";return{BASE:e,PLAY_STATS:e+"playStats"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="mediaControl.";return{BASE:e,BUFFER_TWEAKS_CREATED:e+"tweaksCreated",BUFFER_TWEAKS_ERROR:e+"tweaksError"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(49),n(16),n(68),n(75),n(70),n(71),n(72),n(67),n(74),n(8)],i=function(e,t,n,r,i,o,a,s,u,c,d,f){function E(E){function l(){r.add({target:E,listeners:Y}),m()}function p(){r.remove({target:E,listeners:Y}),F&&r.remove({target:E,listeners:V}),T()}function m(){T(),r.add({target:E,listeners:B})}function T(){r.remove({target:E,listeners:B})}function A(){_(),U&&r.add({target:E,listeners:H})}function _(){r.remove({target:E,listeners:H})}function h(){A()}function R(e){!F&&P===f.PLAYING&&U.buffer.start<e.data.tweaks.buffer.start&&setTimeout(function(){M=!0,E.emit(i.BUFFERING),L.debug("new tweaks, pausing to raise buffer"),E.emit(a.PAUSE)},10),U.buffer=e.data.tweaks.buffer}function N(){P===f.LOADING&&(L.debug("hls: canplaythrough while loading, wait for progress"),E.emit(a.PLAY),G=!0)}function S(){(P===f.BUFFERING||P===f.LOADING&&G)&&(L.debug("hls: progress at buffering or after canplaythrough while loading, continue"),G=!1,M=!1,E.emit(i.PLAYBACK_STARTED,x?{stats:x}:{}))}function O(){P===f.PLAYING&&(L.debug("hls: waiting while playing, now buffering"),M=!0,E.emit(i.BUFFERING))}function y(e){F=e.data.type===n.HLS,F&&r.add({target:E,listeners:V})}function v(e){switch(P=e.data.state){case f.PLAYING:x=null;break;case f.LOADING:F&&A();break;case f.PAUSED:_();break;case f.PAUSING:_(),L.warn("entering paused state"),k=-1,w=!1,M=!0}}function I(e){x=e.data.stats}function g(){T(),E.emit(a.PLAY),m()}function C(){F||k!==-1||setTimeout(function(){L.debug("pausing to raise buffer"),E.emit(a.PAUSE)},10)}function D(e){if(e.data.buffered&&e.data.buffered.length){var n=e.data.stats,r=n.buffer.delay.current>U.buffer.start,o=n.buffer.delay.current>U.buffer.min,s=n.buffer.end-n.buffer.start,u=e.data.currentTime,c=e.data.buffered,d=b(c,u)!==-1;if(!F&&!d&&!w&&s>.45){var f=c.length,l=Math.min(c.start(f-1)+.3,c.end(f-1));return L.warn("seek to range: "+c.start(f-1)+" < "+l+" > "+c.end(f-1)),void E.emit(a.SEEK,{position:t.isIEorEdge?0:l})}if(!F&&!w&&t.isFirefox&&c.length>1&&b(c,u)!==c.length-1&&c.end(f-1)-c.start(f-1)>.3){var f=c.length,l=c.start(f-1);return L.warn("seek to startable range start: "+c.start(f-1)),void E.emit(a.SEEK,{position:l})}if(r&&k===-1&&d){if(k=u,!F&&t.isSafari&&k<.2)return k=.3,L.warn("initial safari stream startTime set to "+k+", seeking"),void E.emit(a.SEEK,{position:k});L.debug("stream startTime set to "+k)}M&&r&&(F?(L.debug("hls: buffering and has enough to start, don't wait for progress"),G=!1):(L.debug("starting stream"),g()),M=!1,w&&E.emit(i.PLAYBACK_STARTED,x?{stats:x}:{})),M||(!w&&k!==-1&&k<u-.1&&(w=!0,E.emit(i.PLAYBACK_STARTED,x?{stats:x}:{})),u>U.buffer.start&&!o&&(M=!0,F||(L.debug("pausing to buffer"),E.emit(a.PAUSE)),E.emit(i.BUFFERING)))}}function b(e,n){for(var r=0;e&&r<e.length;++r)if(e.start(r)<=n&&e.end(r)>=n||t.isIEorEdge&&n<=.3&&e.start(r)<=5&&e.end(r)-e.start(r)>.2)return r;return-1}var P,L=e.create("BufferControl"),U={},w=!1,M=!0,F=!1,G=!1,k=-1,x=null,Y=[{type:c.APPLICATION_STATE_CHANGE,listener:v},{type:c.STARTUP_STATS,listener:I},{type:a.VIDEO_SOURCE,listener:y},{type:u.SOURCE_READY,listener:h},{type:o.BUFFER_TWEAKS_CREATED,listener:R}],V=[{type:s.CAN_PLAY_THROUGH,listener:N},{type:s.PROGRESS,listener:S},{type:s.WAITING,listener:O}],B=[{type:a.PLAY,listener:C}],H=[{type:d.PLAY_STATS,listener:D}];return l(),{destroy:p}}return{create:E}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(22),n(25),n(78),n(16),n(68),n(75),n(73),n(67),n(74),n(79)],i=function(e,t,n,r,i,o,a,s,u,c,d){function f(f){function E(){D.debug("initialize"),p(),[x,n.useHLS?null:V].forEach(function(e){!!e&&i.add({target:f,listeners:e})})}function l(){I=null,[x,Y,V].forEach(function(e){i.remove({target:f,listeners:e})})}function p(){I=r.create(10*M)}function m(e){i.add({target:f,listeners:e?V:Y}),i.remove({target:f,listeners:e?Y:V})}function T(e){if(e.data.onStreamInfo.videoInfo&&e.data.onStreamInfo.haveVideo&&e.data.onStreamInfo.videoInfo.frameRate<=30&&n.isIEorEdge&&!k){var r=1;P=t.copy(b),O(Math.sqrt(30)-Math.sqrt(e.data.onStreamInfo.videoInfo.frameRate),r),P.start+=(P.target-P.start)/2,P.min+=(P.start-P.min)/2,y()}}function A(e){T(e)}function _(e){var r;e.data.config.tweaks&&(e.data.config.tweaks.buffer&&(r=d.validateBuffer(e.data.config.tweaks.buffer),r.success?(P=t.copy(e.data.config.tweaks.buffer),L=t.copy(P),k=!0):f.emit(a.BUFFER_TWEAKS_ERROR,{reason:r.reason})),e.data.config.tweaks.bufferDynamic&&!n.useHLS&&(r=d.validateDynamic(e.data.config.tweaks.bufferDynamic),r.success?(U=e.data.config.tweaks.bufferDynamic.offsetThreshold,w=e.data.config.tweaks.bufferDynamic.offsetStep,M=e.data.config.tweaks.bufferDynamic.cooldownTime):f.emit(a.BUFFER_TWEAKS_ERROR,{reason:r.reason}))),y()}function h(e){var t=e.data.stats.buffer.delay.current;t&&I.add(t),!G&&n.isIEorEdge&&t>g&&(P.target=t,P.limit=P.target+C,y()),G=!0}function R(){m(!0);var e=((new Date).getTime()-F)/1e3;F!==-1&&e<U&&P.start<L.limit&&(D.warn("buffering "+e+" seconds after stream started, raising buffer values"),O(w),y()),p(),clearInterval(v),v=0}function N(){m(!1),F=(new Date).getTime(),G&&M&&(v=setInterval(function(){D.debug("stream running stable since "+M+" sec"),D.debug("buffer min: "+I.minimum+", max: "+I.maximum),P.start>L.start?(D.debug(-w+" sec cooldown"),O(-w),y()):(D.debug("no cooldown"),clearInterval(v),v=0)},1e3*M))}function S(e){n.isFirefox&&(D.debug("frame drop"),D.debug(""+JSON.stringify(e)),D.debug("current buffer: "+JSON.stringify(P)),D.debug("limit: "+L.limit+", start: "+P.start),P.start<L.limit?(D.debug("start lower then limit -> tweaking"),O(P.target-P.start),y()):D.debug("start higher then limit -> tweaking denied"))}function O(e,t){t=t||1,["start","target","limit"].forEach(function(n){P[n]*=t,P[n]+=e})}function y(){D.debug("new buffer: "+JSON.stringify(P)),f.emit(a.BUFFER_TWEAKS_CREATED,{tweaks:{buffer:t.copy(P)}})}var v,I,g=2,C=1.5,D=e.create("BufferTweaker"),b={max:8,min:.2,start:.5,target:1.2,limit:1.7},P=t.copy(b),L=t.copy(b),U=0,w=0,M=0,F=-1,G=!1,k=!1,x=[{type:u.STREAM_INFO,listener:T},{type:u.STREAM_INFO_UPDATE,listener:A},{type:u.CONFIG,listener:_},{type:s.FRAME_DROP,listener:S}],Y=[{type:c.PLAY_STATS,listener:h},{type:o.BUFFERING,listener:R}],V=[{type:o.PLAYBACK_STARTED,listener:N}];return E(),{destroy:l}}return{create:f}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e){return e.reduce(function(e,t){return e+t},0)/e.length}function t(e){return Math.pow(e.reduce(function(e,t){return e?t?e*t:e:t},0),1/e.length)}function n(e){var t=e.reduce(function(e,t,n){return t?n-1?e+1/t:(e?1/e:0)+1/t:e},0);return t?e.length/t:0}function r(r){function i(e){for(a.push(e);a.length>r;)a.shift();return o(),{minimum:s.min,maximum:s.max,arithmetic:s.arithmetic,geometric:s.geometric,harmonic:s.harmonic}}function o(){var r=JSON.parse(JSON.stringify(a)).sort(function(e,t){return e-t},0);s.arithmetic=e(r),s.geometric=t(r),s.harmonic=n(r),s.minimum=r[0],s.maximum=r[r.length-1]}var a=[],s={};return s={add:i,minimum:0,maximum:0,arithmetic:0,geometric:0,harmonic:0,values:a}}return{create:r}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e){var t=["min","start","target","limit","max"],n=t.filter(function(t){return!e.hasOwnProperty(t)});if(n.length)return{success:!1,reason:"The buffer config is invalid, it must contain "+n.join(", ")+". Reset to default."};for(var r in t){if("number"!=typeof e[t[r]])return{success:!1,reason:"The buffer config is invalid, the value '"+t[r]+"' have to be a number. Reset to default."};if(r>0&&e[t[r-1]]>e[t[r]])return{success:!1,reason:"The buffer config is invalid, the value '"+t[r-1]+"' have to be lower then '"+t[r]+"'. Reset to default."}}return{success:!0}}function t(e){var t=["offsetThreshold","offsetStep","cooldownTime"],n=t.filter(function(t){return!e.hasOwnProperty(t)});return n.length?{success:!1,reason:"The dynamic buffer config is invalid, it must contain "+n.join(", ")+". Reset to default."}:(t.forEach(function(t){if("number"!=typeof e[t]||0===e[t])return{success:!1,reason:"The dynamic buffer config is invalid, the value '"+t+"' have to be a number. Reset to default."}}),{success:!0})}return{validateBuffer:e,validateDynamic:t}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(81),n(16),n(82),n(83),n(70),n(67),n(71)],i=function(e,t,n,r,i,o,a,s,u){function c(c){function E(){r.add({target:c,listeners:W});var e=[o.TIME_UPDATE];for(var t in o)o.hasOwnProperty(t)&&e.indexOf(o[t])===-1&&K.push({type:o[t],listener:v})}function l(){r.remove({target:c,listeners:W}),T()}function p(e){e.data.config.playback&&(Y=!!e.data.config.playback.muted,V=!!e.data.config.playback.automute)}function m(e){if(b=document.getElementById(e.data.elementId),x=!!b,k.debug("using "+(x?"external ":"generated ")+"video eleement"),P=e.data.container,b?(w=b.parentElement,U=b.style.cssText,b.style.cssText=""):(b=document.createElement("video"),b.id=e.data.elementId,b.autoplay=!1,b.controls=!1,b.setAttribute("playsinline",!0),b.style.backgroundColor="transparent"),b.muted=Y,b.volume=H,L=document.createElement("source"),b.appendChild(L),t.isIOS11){k.debug("iOS11 detected, using iframe hack"),b.style.width="100vw",b.style.height="100vh";var n=document.createElement("iframe");n.frameBorder=0,n.scrolling="no",n.style.cssText="width: 100%;height: 100%;position: absolute;display: block;top: 0;left: 0;",n.addEventListener("load",function(e){e.target.contentDocument.body.style.height="100%",e.target.contentDocument.body.style.width="100%",e.target.contentDocument.body.style.overflow="hidden",e.target.contentDocument.body.style.position="absolute",e.target.contentDocument.body.style.margin="0",e.target.contentDocument.body.style.padding="0",e.target.contentDocument.body.firstChild||(e.target.contentDocument.body.appendChild(b),r.remove({target:b,listeners:K}),r.add({target:b,listeners:K}))}),n.addEventListener("unload",function(e){e.target.contentDocument.body.firstChild&&e.target.contentDocument.body.removeChild(b)}),P.appendChild(n)}else k.debug("appending video to container"),P.appendChild(b),r.add({target:b,listeners:K});t.isIEorEdge&&(["scroll","resize"].forEach(function(e){window.addEventListener&&addEventListener(e,C,!1),window.attachEvent&&attachEvent("on"+e,C)}),C()),c.emit(u.ELEMENT_CREATED,{video:b}),c.emit(u.VOLUME_CHANGE,{muted:b.muted,volume:b.volume})}function T(){if(b){for(r.remove({target:b,listeners:K}),t.isIEorEdge&&(G=void 0,["scroll","resize"].forEach(function(e){window.removeEventListener&&removeEventListener(e,C,!1),window.detachEvent&&detachEvent("on"+e,C)})),t.useHLS&&(L.src="",b.load());P.firstChild;)P.removeChild(P.firstChild);for(;b.firstChild;)b.removeChild(b.firstChild);x&&(k.debug("releasing external video"),b.style.cssText=U,U=null,w.appendChild(b)),clearInterval(M),clearInterval(F),b=null}}function A(e){b&&(L.src=e.data.src,b.type=e.data.type,b.load(),clearInterval(M),clearInterval(F),e.data.src&&e.data.src.length&&(M=setInterval(I,d),"function"==typeof b.getVideoPlaybackQuality&&(F=setInterval(g,f))))}function _(){k.debug("mute"),Y=!0,b&&(b.muted=!0)}function h(){k.debug("unmute"),Y=!1,b&&(b.muted=!1)}function R(e){k.debug("onPlay"),b&&n.play(b).then(function(){k.debug("play promise resolved"),c.emit(u.PLAY_START_SUCCESS),B=!1}).catch(function(t){k.debug("play promise rejected"),t.error.name!==i.NOT_ALLOWED_ERROR||b.muted||!V||B?b.muted&&B&&(k.debug("unmute to reset"),h(),b.muted||(v({type:o.VOLUME_CHANGE}),B=!1)):(k.debug("mute to play"),_(),b.muted&&(B=!0,setTimeout(R,20))),e.data.external&&!B||c.emit(u.PLAY_START_ERROR,{error:t.error,automuted:B})})}function N(){if(k.debug("onPause"),b&&(b.pause(),O({data:{rate:1}}),t.isIOS11))for(var e=0;e<P.children.length;e+=1){var n=P.children[e];n&&n.tagName&&"IFRAME"===n.tagName&&n.contentWindow.location.reload(!0)}}function S(e){H=Math.min(1,Math.max(0,e.data.volume)),b&&b.volume!==H&&(k.debug("set volume: "+e.data.volume),b.volume=H)}function O(e){b&&b.playbackRate!==e.data.rate&&(k.debug("set rate to: "+e.data.rate),b.playbackRate=e.data.rate)}function y(e){b&&(k.debug("seek to: "+e.data.position),b.currentTime=e.data.position)}function v(e){var t=D();switch(e.type){case o.ERROR:t.code=b.error.code;break;case o.VOLUME_CHANGE:t.muted=b.muted,t.volume=b.volume;break;case o.CAN_PLAY:t.haveVideo="undefined"!=typeof b.videoTracks&&b.videoTracks.length>0,t.haveAudio="undefined"!=typeof b.audioTracks&&b.audioTracks.length>0,t.videoWidth=b.videoWidth,t.videoHeight=b.videoHeight}k.detail(e.type),c.emit("mediaElementProxy."+e.type,t)}function I(){c.emit(u.TIME_UPDATE,D())}function g(){var e=D();e.quality=b.getVideoPlaybackQuality(),c.emit(u.QUALITY_UPDATE,e)}function C(){var e=b&&"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{top:0,left:0,bottom:0,right:0},t=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,r=e.top<=t&&e.top+e.height>=0,i=e.left<=n&&e.left+e.width>=0,o=r&&i;o!==G&&(k.debug("viewport changed to "+(o?"visible":"hidden")),G=o,c.emit(o?u.VIEWPORT_VISIBLE:u.VIEWPORT_HIDDEN))}function D(){return{currentTime:b.currentTime,buffered:b.buffered,played:b.played,playbackRate:b.playbackRate}}var b,P,L,U,w,M,F,G,k=e.create("MediaElementProxy"),x=!1,Y=!1,V=!1,B=!1,H=1,W=[{type:s.CONFIG,listener:p},{type:a.CREATE_VIDEO,listener:m},{type:a.DESTROY_VIDEO,listener:T},{type:a.VIDEO_SOURCE,listener:A},{type:a.PLAY,listener:R},{type:a.PAUSE,listener:N},{type:a.SEEK,listener:y},{type:a.MUTE,listener:_},{type:a.UNMUTE,listener:h},{type:a.SET_VOLUME,listener:S},{type:a.SET_RATE,listener:O}],K=[];return E(),{destroy:l}}var d=100,f=1e3;return{create:c}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e){return new Promise(function(r,i){var o=e.play();Promise.all([o]).then(function(t){r({media:e})}).catch(function(r){t=r&&r.name?r.name:"Unknown",n=r&&r.message?r.message:"Message not available.",i({media:e,error:{name:t,message:n}})})})}var t,n;return{play:e}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return{ABORT_ERROR:"AbortError",NOT_ALLOWED_ERROR:"NotAllowedError"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="";return{BASE:e,LOAD_START:e+"loadstart",PROGRESS:e+"progress",SUSPEND:e+"suspend",ABORT:e+"abort",EMPTIED:e+"emptied",STALLED:e+"stalled",PLAY:e+"play",PAUSE:e+"pause",LOADED_META_DATA:e+"loadedmetadata",LOADED_DATA:e+"loadeddata",WAITING:e+"waiting",ERROR:e+"error",PLAYING:e+"playing",CAN_PLAY:e+"canplay",CAN_PLAY_THROUGH:e+"canplaythrough",SEEKING:e+"seeking",SEEKED:e+"seeked",TIME_UPDATE:e+"timeupdate",ENDED:e+"ended",RATE_CHANGE:e+"ratechange",DURATION_CHANGE:e+"durationchange",VOLUME_CHANGE:e+"volumechange"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(16),n(49),n(85),n(70),n(71),n(72),n(86)],i=function(e,t,n,r,i,o,a,s){function u(u){function c(){R.debug("create"),t.add({target:u,listeners:N}),d()}function d(){h=new window.MediaSource,t.add({target:h,listeners:S}),O.push(s.create(u,h))}function f(){if(h){for(;O.length;)O.pop().destroy();t.remove({target:h,listeners:S}),h=null}}function E(){R.debug("destroy"),f(),t.remove({target:u,listeners:N})}function l(){u.emit(i.VIDEO_SOURCE,{src:window.URL.createObjectURL(h),type:n.MP4})}function p(){f(),d(),l()}function m(){u.emit(a.SOURCE_OPEN,_())}function T(){p(),u.emit(a.SOURCE_ENDED,_())}function A(){p(),u.emit(a.SOURCE_CLOSED,_())}function _(){return{readyState:h.readyState}}var h,R=e.create("MediaSourceProxy"),N=[{type:o.ELEMENT_CREATED,listener:l},{type:i.UPDATE_SOURCE,listener:p}],S=[{type:r.SOURCE_OPEN,listener:m},{type:r.SOURCE_ENDED,listener:T},{type:r.SOURCE_CLOSED,listener:A}],O=[];return c(),{destroy:E}}return{create:u}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="";return{BASE:e,SOURCE_OPEN:e+"sourceopen",SOURCE_ENDED:e+"sourceended",SOURCE_CLOSED:e+"sourceclosed"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(25),n(16),n(87),n(85),n(70),n(71),n(67),n(72),n(8)],i=function(e,t,n,r,i,o,a,s,u){function c(i,c){function d(){t.add({target:i,listeners:Y})}function f(){for(;M.length;)M.pop();t.remove({target:i,listeners:Y}),
t.remove({target:i,listeners:V}),g&&t.remove({target:g,listeners:B}),g=null}function E(e){C=e.data.currentTime}function l(e){p(e.data)}function p(e){T({command:F,fragment:e})}function m(e,t){T({command:G,from:e,to:t})}function T(e){w?e.force?M.unshift(e):M.push(e):A(e)}function A(e){switch(e.command){case F:k&&(w=!0,g.appendBuffer(e.fragment),I()||U++);break;case G:g.buffered.length&&g.buffered.end(g.length-1)>0&&(w=!0,g.remove(e.from,e.to))}}function _(){w=!1,x&&(x=0,i.emit(s.SOURCE_READY)),M.length?A(M.shift()):v()&&I()&&m(g.buffered.start(0),C-P)}function h(t){D=t.data.onStreamInfo;var n=D&&D.mimeType?D.mimeType:'video/mp4; codecs="avc1.42E01E, mp4a.40.2"';c&&"open"===c.readyState?g?(k=!0,e.isIEorEdge&&!isNaN(c.duration)&&c.duration>0?(w=!0,x=1,c.duration=0):i.emit(s.SOURCE_READY)):S(n):c.addEventListener(r.SOURCE_OPEN,N.bind(null,n))}function R(e){}function N(e){c.removeEventListener(r.SOURCE_OPEN,N),S(e)}function S(e){!g&&c&&"open"===c.readyState&&(g=c.addSourceBuffer(e),t.add({target:i,listeners:V}),t.add({target:g,listeners:B}),k=!0,i.emit(s.SOURCE_READY))}function O(e){e.data.state===u.PAUSED&&y()}function y(){for(k=!1;M.length;)M.pop();m(0,1/0),U=0}function v(){return g.buffered.length&&g.buffered.start(0)<C-b}function I(){return L<U}var g,C,D,b=30,P=20,L=300,U=0,w=!1,M=[],F="append",G="remove",k=!0,x=0,Y=[{type:a.STREAM_INFO,listener:h},{type:a.STREAM_INFO_UPDATE,listener:R}],V=[{type:o.TIME_UPDATE,listener:E},{type:a.APPLICATION_STATE_CHANGE,listener:O},{type:a.STREAM_FRAGMENT,listener:l}],B=[{type:n.UPDATE_END,listener:_}];return d(),{destroy:f}}return{create:c}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){var e="";return{BASE:e,ABORT:e+"abort",ERROR:e+"error",UPDATE:e+"update",UPDATE_START:e+"updatestart",UPDATE_END:e+"updateend"}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(16),n(70),n(67)],i=function(e,t,n,r){function i(i){function o(){d.debug("initialize"),t.add({target:i,listeners:f})}function a(){u(),t.remove({target:i,listeners:f})}function s(e){u(),e.data.onStreamInfo.haveAudio||(window.AudioContext=window.AudioContext||window.webkitAudioContext||function(){return{close:function(){}}},c=new AudioContext)}function u(){c&&"function"==typeof c.close&&(c.close(),c=null)}var c,d=e.create("FakeAudioContext"),f=[{type:r.STREAM_INFO,listener:s},{type:n.PAUSE,listener:u}];return o(),{destroy:a}}return{create:i}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(25),n(16),n(70),n(67),n(71),n(8)],i=function(e,t,n,r,i,o,a){function s(s){function u(){N.debug("initialize"),n.add({target:s,listeners:O})}function c(){n.remove({target:s,listeners:O}),n.remove({target:s,listeners:y})}function d(e){T=e.data.state,n.remove({target:s,listeners:y}),(t.isIEorEdge&&T===a.PLAYING||!t.isIEorEdge&&T!==a.PAUSED)&&n.add({target:s,listeners:y})}function f(e){var t=l(e.data.currentTime,e.data.buffered),n=p(e.data.currentTime,e.data.buffered);if(A===e.data.currentTime){if(S++,S<_)return;if(n>t&&m(e.data.buffered,n)>R&&E(e.data.currentTime,e.data.buffered)){var i=e.data.buffered.start(p(e.data.currentTime,e.data.buffered));N.debug("recover gap, seek to "+i,3),s.emit(r.SEEK,{position:i}),s.emit(r.PLAY)}}A=e.data.currentTime,S=0}function E(e,t){return e+h>=t.end(l(e,t))}function l(e,t){for(var n=0;n<t.length-1&&t.start(n+1)<=e;)n++;return n}function p(e,t){for(var n=0;n<t.length-1&&t.start(n)<=e;)n++;return n}function m(e,t){return t<e.length?e.end(t)-e.start(t):0}var T,A,_=10,h=.2,R=.5,N=e.create("GapHandler"),S=0,O=[{type:i.APPLICATION_STATE_CHANGE,listener:d}],y=[{type:o.TIME_UPDATE,listener:f}];return u(),{destroy:c}}return{create:s}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(22),n(16),n(69),n(67),n(74),n(8)],i=function(e,t,n,r,i,o,a){function s(s){function u(){p.debug("initialize"),n.add({target:s,listeners:m})}function c(){n.remove({target:s,listeners:m})}function d(e){n.remove({target:s,listeners:T});var t=e.data.state;switch(t){case a.PAUSED:case a.PAUSING:p.debug("entering paused state"),E=null;break;case a.PLAYING:n.add({target:s,listeners:T})}}function f(e){if(E&&"undefined"!=typeof E.currentTime&&e.data.stats.currentTime<E.currentTime-l){var n={currentTime:{last:E.currentTime,current:e.data.stats.currentTime}};s.emit(r.ERROR,n)}E=t.copy(e.data.stats)}var E,l=2,p=e.create("HLSJumpHandler"),m=[{type:i.APPLICATION_STATE_CHANGE,listener:d}],T=[{type:o.PLAY_STATS,listener:f}];return u(),{destroy:c}}return{create:s}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(10),n(26),n(25),n(16),n(69),n(70),n(67),n(71),n(8)],i=function(e,t,n,r,i,o,a,s,u){function c(c){function d(){T.debug("initialize"),r.add({target:c,listeners:h})}function f(){r.remove({target:c,listeners:h})}function E(t){_=t.name===a.DOCUMENT_HIDDEN,T.debug(_?"hidden":"visible"),_&&e.mobile&&(m===u.PLAYING||m===u.LOADING||m===u.BUFFERING)&&c.emit(i.SUSPENDED)}function l(t){var r=t.data.buffered.length?t.data.buffered.end(0)-t.data.currentTime:"n.a.";(n.useHLS&&t.name===s.PAUSE||_&&e.mobile)&&m===u.PLAYING?c.emit(i.SUSPENDED):A||(A=setTimeout(function(){m===u.PLAYING&&(T.debug("nanoplayer: recover unexpected pause type "+t.name+", delay = "+r,3),c.emit(o.PLAY)),A=0},200))}function p(e){m=e.data.state}var m,T=t.create("PauseHandler"),A=0,_=!1,h=[{type:s.PAUSE,listener:l},{type:s.WAITING,listener:l},{type:s.ENDED,listener:l},{type:a.APPLICATION_STATE_CHANGE,listener:p},{type:a.DOCUMENT_VISIBLE,listener:E},{type:a.DOCUMENT_HIDDEN,listener:E}];return d(),{destroy:f}}return{create:c}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(26),n(16),n(8),n(70),n(67),n(71),n(73)],i=function(e,t,n,r,i,o,a){function s(r){function s(){t.add({target:r,listeners:C})}function u(){t.remove({target:r,listeners:C}),t.remove({target:r,listeners:D})}function c(){for(_={droppedVideoFrames:0,droppedVideoFramesCurrent:0,corruptedVideoFrames:0,corruptedVideoFramesCurrent:0,creationTime:0,totalVideoFrames:0};y.length;)y.pop()}function d(e){h=e.data.state,h===n.PAUSED?p():!g&&v&&h===n.PLAYING&&l()}function f(e){v=e.data.onStreamInfo.haveVideo&&(I=e.data.onStreamInfo.videoInfo.frameRate)}function E(e){f(e)}function l(){p(),t.add({target:r,listeners:D}),g=setInterval(T,N)}function p(){clearInterval(g),t.remove({target:r,listeners:D}),g=0,c()}function m(e){for(var t in e.data.quality)if(_.hasOwnProperty(t)){if("droppedVideoFrames"===t){for(_.droppedVideoFramesCurrent=e.data.quality.droppedVideoFrames-_.droppedVideoFrames;y.length>O-1;)y.shift();y.push({count:_.droppedVideoFramesCurrent,time:e.data.currentTime})}"corruptedVideoFrames"===t&&(_.corruptedVideoFramesCurrent=e.data.quality.corruptedVideoFrames-_.corruptedVideoFrames),_[t]=e.data.quality[t]}r.emit(a.QUALITY_STATS,_)}function T(){if(h===n.PLAYING){var e=A("extreme");if(!e&&(e=A("high")),!e&&(e=A("medium")),e){for(R.debug("frame drop detected with type '"+e.type+"'"),R.debug(e.frames.dropped+" frames in last "+e.samples.all.length+" seconds dropped");y.length;)y.pop();r.emit(a.FRAME_DROP,e)}}}function A(e){if(y.length>S[e].samplesRange-1){var t=y.slice(-S[e].samplesRange),n=t.filter(function(t){return t.count>=I*S[e].ratioThreshold});if(n.length>S[e].samplesMatchAllowed){var r=0;return t.forEach(function(e){r+=e.count}),{type:e,framerate:I,samples:{all:t,matched:n,limit:Math.ceil(I*S[e].ratioThreshold)},frames:{dropped:r}}}}return!1}var _,h,R=e.create("QualityHandler"),N=1e3,S={extreme:{ratioThreshold:.95,samplesRange:3,samplesMatchAllowed:1},high:{ratioThreshold:.2,samplesRange:5,samplesMatchAllowed:1},medium:{ratioThreshold:.1,samplesRange:10,samplesMatchAllowed:3}},O=10,y=[],v=!1,I=0,g=0,C=[{type:i.APPLICATION_STATE_CHANGE,listener:d},{type:i.STREAM_INFO,listener:f},{type:i.STREAM_INFO_UPDATE,listener:E}],D=[{type:o.QUALITY_UPDATE,listener:m}];return s(),{destroy:u}}return{create:s}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(36),n(16),n(25),n(78),n(8),n(67),n(70),n(71),n(74)],i=function(e,t,n,r,i,o,a,s,u){function c(a){function c(){_(),t.add({target:a,listeners:D}),t.add({target:a,listeners:b})}function d(){t.remove({target:a,listeners:b}),t.remove({target:a,listeners:D})}function f(e){switch(R=e.data.state){case i.PAUSED:t.remove({target:a,listeners:P});break;case i.PLAYING:break;case i.LOADING:_(),n.useHLS&&t.add({target:a,listeners:P})}}function E(e){I+=1,g+=e.data.byteLength}function l(e){!n.useHLS&&t.add({target:a,listeners:P}),N=e.data.onStreamInfo.haveVideo}function p(e){N=e.data.onStreamInfo.haveVideo}function m(t){var r=t.data.buffered.length-1,o=t.data.played.length-1;if(h.currentTime=R===i.LOADING?0:t.data.currentTime,o>=0&&(h.playout.start=t.data.played.start(o),h.playout.end=t.data.played.end(o)),r>=0&&(!n.useHLS||n.useHLS&&(h.buffer.end!==t.data.buffered.end(r)||t.data.buffered.end(r)<h.currentTime))&&(h.buffer.update.current=t.data.buffered.end(r)-h.buffer.end,h.buffer.delay.before=h.buffer.end-h.currentTime,h.buffer.start=t.data.buffered.start(r),h.buffer.end=t.data.buffered.end(r),h.buffer.delay.current=h.buffer.end-h.currentTime,S.add(h.buffer.delay.current),A(S,h.buffer.delay),O.add(h.buffer.update.current),A(O,h.buffer.update)),e&&!n.useHLS){var a=Math.floor(e.now()/1e3);C!==a&&(C=a,h.bitrate.current=8*g,y.add(h.bitrate.current),A(y,h.bitrate),N&&(h.framerate.current=I,v.add(h.framerate.current),A(v,h.framerate)),I=0,g=0)}T(t)}function T(e){a.emit(u.PLAY_STATS,{stats:h,buffered:e?e.data.buffered:null,played:e?e.data.played:null,currentTime:e?e.data.currentTime:0,playbackRate:e?e.data.playbackRate:0})}function A(e,t){t.avg=e.arithmetic,t.min=e.minimum,t.max=e.maximum}function _(){h={currentTime:0,playout:{start:0,end:0},buffer:{start:0,end:0,delay:{before:0,current:0,avg:0,min:0,max:0},update:{current:0,avg:0,min:0,max:0}},quality:{droppedVideoFrames:0,droppedVideoFramesCurrent:0,corruptedVideoFrames:0,corruptedVideoFramesCurrent:0,creationTime:0,totalVideoFrames:0},bitrate:{current:0,avg:0,min:0,max:0},framerate:{current:0,avg:0,min:0,max:0}},S=r.create(10),O=r.create(10),y=r.create(10),v=r.create(10),I=0,g=0,T(null)}var h,R,N,S,O,y,v,I,g,C=0,D=[{type:o.APPLICATION_STATE_CHANGE,listener:f}],b=[{type:o.STREAM_FRAGMENT,listener:E},{type:o.STREAM_INFO,listener:l},{type:o.STREAM_INFO_UPDATE,listener:p}],P=[{type:s.TIME_UPDATE,listener:m}];return c(),{destroy:d}}return{create:c}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[n(67)],i=function(e){function t(t){function n(){o()&&t.addListener(e.STREAM_FRAGMENT,i)}function r(){t.removeListener(e.STREAM_FRAGMENT,i)}function i(e){window.fragments||(window.fragments=[]),window.fragments.push(e.data)}function o(){return!!a("nanoDump")}function a(e){return document.cookie.indexOf(e+"=")!==-1?document.cookie.split(e+"=")[1].split(";")[0]:null}return n(),{destroy:r}}return{create:t}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){return{FORCE_NOT_SUPPORTED:'The forced tech "$tech$" is not supported by your browser.',SOURCE_NOT_SUPPORTED:"The players source configuration is malformed or missing, please check documentation for more information or contact us.",CLIENT_NOT_SUPPORTED:"This browser does not fully support HTML5 and H5Live.\t            Supported are: Chrome >=54 (Windows, MacOSX, Android), Firefox >=48 (Windows, MacOSX, Android), Microsoft Edge (Windows), Microsoft Internet Explorer 11 (at least Windows 8), Safari (MacOSX & at least iOS 10)."}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(e,t,n){function r(){for(var n in t)t.hasOwnProperty(n)&&e.on(t[n],o)}function i(){for(var n in t)t.hasOwnProperty(n)&&e.off(t[n],o)}function o(e){n.emit(e.name,e)}return r(),{destroy:i}}return{create:e}}.apply(t,r),!(void 0!==i&&(e.exports=i))},function(e,t,n){var r,i;r=[],i=function(){function e(){}function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function r(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void n._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._state?i:o)(t.promise,e._value);var r;try{r=n(e._value)}catch(e){return void o(t.promise,e)}i(t.promise,r)}))}function i(e,r){try{if(r===e)throw new TypeError("A promise cannot be resolved with itself.");if(r&&("object"==typeof r||"function"==typeof r)){var i=r.then;if(r instanceof n)return e._state=3,e._value=r,void a(e);if("function"==typeof i)return void u(t(i,r),e)}e._state=1,e._value=r,a(e)}catch(t){o(e,t)}}function o(e,t){e._state=2,e._value=t,a(e)}function a(e){2===e._state&&0===e._deferreds.length&&n._immediateFn(function(){e._handled||n._unhandledRejectionFn(e._value)});for(var t=0,i=e._deferreds.length;t<i;t++)r(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function u(e,t){var n=!1;try{e(function(e){n||(n=!0,i(t,e))},function(e){n||(n=!0,o(t,e))})}catch(e){if(n)return;n=!0,o(t,e)}}var c=setTimeout;return n.prototype.catch=function(e){return this.then(null,e)},n.prototype.then=function(t,n){var i=new this.constructor(e);return r(this,new s(t,n,i)),i},n.all=function(e){var t=Array.prototype.slice.call(e);return new n(function(e,n){function r(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(o,e)},n)}t[o]=a,0===--i&&e(t)}catch(e){n(e)}}if(0===t.length)return e([]);for(var i=t.length,o=0;o<t.length;o++)r(o,t[o])})},n.resolve=function(e){return e&&"object"==typeof e&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)})},n._immediateFn="function"==typeof window.setImmediate&&function(e){window.setImmediate(e)}||function(e){c(e,0)},n._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},n._setImmediateFn=function(e){n._immediateFn=e},n._setUnhandledRejectionFn=function(e){n._unhandledRejectionFn=e},void 0===window.Promise&&(window.Promise=n),window.Promise}.apply(t,r),!(void 0!==i&&(e.exports=i))}])});