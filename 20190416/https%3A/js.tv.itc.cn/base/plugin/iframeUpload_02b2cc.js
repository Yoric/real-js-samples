/* sohutv 2018-11-22 16:17:48 */
!function(d){var f={code:10,msg:"\u56fe\u7247\u8fc7\u5927"},o={code:30,msg:"\u8d85\u51fa\u4e0a\u4f20\u6570\u91cf"},g={code:50,msg:"\u683c\u5f0f\u4e0d\u5141\u8bb8"};d.upload=function(i){var e=document.all&&!window.atob,p={url:i.url||"//img.tv.sohu.com/ndfs/uploadPhoto.do?",data:{appid:i.appid||100114,allowGif:i.allowGif||0,needCompress:"true",isSupportHttps:"true",customParam:i.customParam||""},dom:d("input[type='file']"),accept:"image/jpg,image/jpeg,image/png"+(i.allowGif?",image/gif":""),maxSize:i.maxSize||10485760,maxGifLimit:i.maxGifLimit||{gifLimit:!1,maxSize:""},maxNum:999,multiple:!1,allowBmp:0,error:d.noop,success:d.noop,beginload:d.noop,complete:d.noop},s=null,t=0;if(d.extend(p,i),!p.dom.hasClass("JS_upload_has_bind")){p.dom.addClass("JS_upload_has_bind"),p.dom.is("input[type=file]")?s=p.dom:(p.dom.css({display:"inline-block",position:"relative",overflow:"hidden"}),s=d('<input type="file" name="file" style="position:absolute;top:0;left:0;font-size: 120px;cursor: pointer;opacity: 0;" >'),p.dom.append(s)),p.multiple?s.attr("multiple","true"):s.attr("multiple",null),s.attr("accept",p.accept);var u=new RegExp("\\.(jpg|jpeg|png"+(i.allowGif?"|gif":"")+(i.allowBmp?"|bmp":"")+")$","gi");e?function c(){try{var i="sohuHD_upload"+d.now();document.domain="sohu.com";var e,a="iframe_callback"+d.now();window[a]=function(i){i&&1==i.status?(u.lastIndex=0,e=p.maxGifLimit.gifLimit&&"image/gif"==i.type&&p.maxGifLimit.maxSize?p.maxGifLimit.maxSize:p.maxSize,i.size>e?p.error(null,f):u.test(i.url)?p.success(i):p.error(null,g)):0==i.status&&202==i.errorCode?p.error(null,g):p.error.call(this,i)},window.iframe_size_error=function(i){p.error(null,f)};var t=p.dom.width(),o=p.dom.height(),l=d('<div style="position: absolute;width: 100%;height: 100%;top:0; left: 0"></div>'),r='<form enctype="multipart/form-data" encoding="multipart/form-data" action="'+p.url+d.param(p.data)+"&callback="+a+'" target="'+i+'" method="POST" accept-charset="utf-8"></form>',n=d('<iframe style="display:none;" src="javascript:false;" name="'+i+'"></iframe>');l.append(r).append(n),s.wrap(l),s.css({position:"absolute",opacity:0,right:0,top:0,width:t||200,height:o||100}),s.on("change",function(){s.parents("form").submit(),setTimeout(function(){s.val("")},200)})}catch(m){p.error(null,m)}}():s.off().on("change",function(){if(p.maxNum<s[0].files.length)p.error(null,o);else{var i=s[0].files;p.beginload();for(var e=0;e<i.length;e++)u.lastIndex=0,(p.maxGifLimit.gifLimit&&"image/gif"==i[e].type&&p.maxGifLimit.maxSize?p.maxGifLimit.maxSize:p.maxSize)<i[e].size?p.error(i[e],f):u.test(i[e].name)?a(i[e]):p.error(i[e],g);setTimeout(function(){s.val("")},200)}})}function a(i,e){var a=new FormData;a.append("file",i),d.support.ajax.cors=!0,d.ajax({url:p.url+d.param(p.data),data:a,processData:!1,contentType:!1,type:"POST",success:function(){t++,p.success.apply(this,arguments),t==i.length&&p.complete.call(this,i)},error:function(){t++,p.error.apply(this,arguments),t==i.length&&p.complete.call(this,i)}})}}}(jQuery);