/* sohutv 2017-03-23 16:22:23 */
kao("rsscss"),function(i,s,t){t.namespace("sohuHD.rss");var n=function(){},e=0;sohuHD.id=function(i){return i=i||"",i+"-"+ ++e},sohuHD.rss.BaseDialog=function(i,n){this.relationEl=s(i),n=n||{},this.originalConfig=n,this.container=s("<div id="+sohuHD.id("rss-box")+' class="rss-wbox"></div>'),t.extend(this,n),this.dialogWidth=n.dialogWidth||400,s(document.body).append(this.container),this.init()},t.extend(sohuHD.rss.BaseDialog.prototype,{init:function(){this.initHTML(),this.initEvent()},initHTML:function(){var i='<div class="wBox"><div class="wboxTop cfix png"><div class="wbWrap png"><div class="wbCont png"></div></div></div><div class="wboxMiddle cfix png"><div class="wbWrap png"><div class="wbCont png"><div class="cfix"><a rel="btn" rev="close" title="\u5173\u95ed" class="ico1 r" href="#"></a></div><div class="wBox-con cfix"></div> </div></div></div><div class="wboxBottom cfix png"><div class="wbWrap png"><div class="wbCont png"></div></div></div></div>';this.container.html(i),this.box=this.container.find(".wBox"),this.innerBox=this.box.find(".wBox-con")},initEvent:function(){var i=this;this.container.on("click","a[rel=btn]",function(){var t=s(this),n=t.attr("rev");return"confirm"==n?i.confirmHandler():"cancel"==n?i.cancelHandler():"close"==n&&i.close(),!1})},confirmHandler:function(){this.success&&this.success()},cancelHandler:function(){this.close()},show:function(i){i&&(this.relationEl=s(i));var t="CSS1Compat"==document.compatMode?document.documentElement:document.body,n=(t.clientWidth-252)/2,e=(t.clientHeight-125)/2,o=this.relationEl.offset()||{};e="undefined"==typeof o.top?e:o.top,"undefined"!=typeof o.left&&(n=o.left-this.dialogWidth),this.container.css({position:"absolute",top:e,left:n}),this.container.show()},close:function(){this.container.hide()}}),sohuHD.rss.MesDialog=function(i,s){this.superClass.constructor.call(this,i,s),this.clockTime=this.originalConfig.clockTime||20},t.inherit(sohuHD.rss.MesDialog,sohuHD.rss.BaseDialog,{initHTML:function(){this.superClass.initHTML.call(this),this.box.addClass("wBox-read-2 mes-dialog");var i='<div class="bt">\u6211\u4eec\u5c06\u4f1a\u628a\u89c6\u9891\u66f4\u65b0\u901a\u77e5\u53d1\u9001\u5230\u60a8\u7684\u624b\u673a</div><form><table><tr><td>\u624b\u673a\u53f7\uff1a</td><td><div class="rel"><input type="text" class="input2 mobile-field" maxlength="11" /> <input type="checkbox" />\u8bb0\u4f4f\u6211<p class="tips mobile-error-tips">\u8bf7\u586b\u5199\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801</p><div class="mobile"></div></div></td></tr><tr><td>\u9a8c\u8bc1\u7801\uff1a</td><td><input type="text" class="input2 mes" style="width:100px;" /><a rel="btn" rev="mes" class="color1" href="#">\u70b9\u6b64\u63a5\u6536\u77ed\u4fe1\u9a8c\u8bc1\u7801</a><span class="mes-tip"><span class="num">20</span>\u79d2\u540e\u91cd\u65b0\u53d1\u9001</span><p class="mes-error-tips tips">\u9a8c\u8bc1\u7801\u9519\u8bef</p></td></tr><tr><td></td><td><a rel="btn" rev="confirm" class="btn1a mR6" href="#"><span>\u786e \u5b9a</span></a> <a rel="btn" rev="cancel" class="btn1" href="#"><span>\u53d6 \u6d88</span></a></td></tr></table></form>';this.innerBox.html(i),this.mobileField=this.innerBox.find("input.mobile-field"),this.mesFiled=this.innerBox.find("input.mes"),this.mobileErrorTip=this.innerBox.find("p.mobile-error-tips"),this.mobileTip=this.innerBox.find("div.mobile"),this.mesBtn=this.innerBox.find("a[rev=mes]"),this.mesTip=this.innerBox.find("span.mes-tip"),this.numTip=this.innerBox.find("span.mes-tip .num"),this.mesErrorTip=this.innerBox.find("p.mes-error-tips"),this.form=this.innerBox.find("form"),this.remField=this.innerBox.find("input:checkbox")},initEvent:function(){this.superClass.initEvent.call(this);var i=this;this.mobileField.on("focus",function(){i.mobileTip.show(),i.interID=setInterval(function(){i.setMobileNumberTip(),i.mobileErrorTip.hide()},200)}).on("blur",function(){i.mobileTip.hide(),clearInterval(i.interID)}),this.mesFiled.on("focus",function(){i.mesErrorTip.hide()}),this.mobileField.on("keydown",function(i){var s=i.keyCode;(i.shiftKey||i.ctrlKey||i.altKey)&&i.preventDefault(),13==s||8==s||9==s||s>=48&&57>=s||s>=96&&105>=s||i.preventDefault()}),this.mesBtn.on("click",function(){return i.sendMes(),!1})},sendMes:function(){if(!this.validateMobile())return void this.mobileErrorTip.show();var i=this,s=this.getMobileNumber();sohuHD.getJSONP("//my.tv.sohu.com/user/a/mobile/sendms.do?m="+s+"&push=1&callback=?",n),this.mesBtn.hide(),this.mesTip.show();var t=this.clockTime;this.numTip.html(t),this.clockTimer=setInterval(function(){t>0?i.numTip.html(--t):(i.mesBtn.show(),i.mesTip.hide(),clearInterval(i.clockTimer))},1e3)},setMobileNumberTip:function(){var i=this.getMobileNumber(),s=i;/^(\d{3})(\d{4})/.test(s)?s=s.replace(/^(\d{3})(\d{4})/,"$1-$2-"):/^(\d{3})/.test(s)&&(s=s.replace(/^(\d{3})/,"$1-")),this.mobileTip.html(s)},getMobileNumber:function(){return s.trim(this.mobileField.val())},getMes:function(){return s.trim(this.mesFiled.val())},getRem:function(){return!!this.remField.attr("checked")},validateMobile:function(){return/^1[3-9]\d{9}/.test(this.getMobileNumber())},validateMes:function(){return!!s.trim(this.mesFiled.val()).length},validateFields:function(){var i=!0,s=!0;return(i=this.validateMobile())||(i=!1,this.mobileErrorTip.show()),(s=this.validateMes())||(this.mesErrorTip.show(),s=!1),i&&s},confirmHandler:function(){if(this.validateFields()){var i=this,s=this.getMobileNumber(),t=this.getMes(),n="//my.tv.sohu.com/user/a/mobile/checkCode.do?m="+s+"&mcode="+t+"&callback=?";sohuHD.getJSONP(n,function(s){s=s||{},1==s.status?i.success&&i.success():i.mesErrorTip.show()})}},close:function(){this.superClass.close.call(this),this.mobileField.val(""),this.mesFiled.val(""),this.mobileErrorTip.hide(),this.mesErrorTip.hide(),this.mobileTip.hide()},show:function(i,s){this.superClass.show.call(this,i,s);var t=sohuHD.cookie("rssmes");t&&(this.mobileField.val(t),this.remField.attr("checked",!0))}}),sohuHD.rss.EmailDialog=function(i,s){this.superClass.constructor.call(this,i,s)},t.inherit(sohuHD.rss.EmailDialog,sohuHD.rss.BaseDialog,{initHTML:function(){this.superClass.initHTML.call(this),this.box.addClass("wBox-read-2 email-dialog");var i='<div class="bt">\u6211\u4eec\u5c06\u4f1a\u628a\u89c6\u9891\u66f4\u65b0\u901a\u77e5\u53d1\u9001\u5230\u60a8\u7684\u90ae\u7bb1</div><form><table><tr><td>Email\uff1a</td><td><input type="text" class="input2 email-field" /> <input id="rem_email" type="checkbox" /><label for="rem_email">\u8bb0\u4f4f\u6211</label><p class="tips">\u597d\u50cf\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e\u54ce</p></td></tr><tr><td></td><td><a class="btn1a mR6" href="#" rel="btn" rev="confirm"><span>\u786e \u5b9a</span></a> <a rel="btn" rev="cancel" class="btn1" href="#"><span>\u53d6 \u6d88</span></a></td></tr></table></form>';this.innerBox.html(i),this.emailField=this.innerBox.find("input.email-field"),this.emailTip=this.innerBox.find("p.tips"),this.remField=this.innerBox.find("input:checkbox")},initEvent:function(){this.superClass.initEvent.call(this);var i=this;this.emailField.on("focus",function(){i.emailTip.hide()}),this.innerBox.find("form").on("submit",function(){return i.confirmHandler(),!1})},getEmail:function(){return s.trim(this.emailField.val())},getRem:function(){return!!this.remField.attr("checked")},validateEmail:function(){return/^\w+(\.\w+)*@\w+(\.\w+)+$/.test(this.getEmail())},validateFields:function(){var i;return(i=this.validateEmail())||this.emailTip.show(),i},confirmHandler:function(){this.validateFields()&&this.success&&this.success()},close:function(){this.superClass.close.call(this),this.emailField.val(""),this.emailTip.hide()},show:function(i,s){this.superClass.show.call(this,i,s);var t=sohuHD.cookie("rssemail");t&&(this.emailField.val(t),this.remField.attr("checked",!0))}}),sohuHD.rss.TipDialog=function(i,s){this.superClass.constructor.call(this,i,s),this.dialogWidth=this.originalConfig.dialogWidth||354,this.clockTimer=null},t.inherit(sohuHD.rss.TipDialog,sohuHD.rss.BaseDialog,{initHTML:function(){this.superClass.initHTML.call(this),this.box.addClass("wBox-read-1 tip-dialog");var i=(this.originalConfig.title||"\u8ba2\u9605\u6210\u529f\uff01",this.originalConfig.infoLabel||"\u60a8\u7684\u90ae\u7bb1\u662f\uff1a",'<div class="row cfix"><span class="tip-dialog-ico ico-ok1 mR15 l"></span><div class="wzi l"><strong class="title-label fs14 c-black">\u8ba2\u9605\u6210\u529f\uff01</strong><p class="p1"><span class="info-label">\u60a8\u7684\u90ae\u7bb1\u662f\uff1a</span><span class="info-content color1"></span></p></div></div><div class="ta-c"><a rel="btn" rev="confirm" class="btn1a mR6" href="#"><span>\u786e \u5b9a</span></a><a rel="link" rev="link" target="_blank" class="btn1" href="//my.tv.sohu.com/user/setting/subscribe.do"><span>\u8bbe \u7f6e</span></a> <span class="set-tip">\u8bbe\u7f6e\u9ed8\u8ba4\u901a\u77e5\u65b9\u5f0f</span></div>');this.innerBox.html(i),this.ico=this.innerBox.find(".tip-dialog-ico"),this.titleLabel=this.innerBox.find(".title-label"),this.confirmBtn=this.innerBox.find("a[rev=confirm]"),this.linkBtn=this.innerBox.find("a[rev=link]"),this.infoLabel=this.innerBox.find(".info-label"),this.infoContainer=this.innerBox.find(".info-content"),this.setTip=this.innerBox.find(".set-tip")},setTitle:function(i){this.titleLabel.html(i||"")},setInfoLabel:function(i){this.infoLabel.html(i||"").show()},hideInfoLabel:function(){this.infoLabel.hide()},setInfo:function(i){this.infoContainer.html(sohuHD.strSub(i,24,!0)||"").show()},hideInfo:function(){this.infoContainer.hide()},showConfirmBtn:function(){this.confirmBtn.show(),this.setTip.hide()},hideConfirmBtn:function(){this.confirmBtn.hide()},showLinkBtn:function(){this.linkBtn.show(),this.setTip.show()},hideLinkBtn:function(){this.linkBtn.hide()},confirmHandler:function(){this.close()},show:function(i){clearInterval(this.clockTimer),this.superClass.show.call(this,i)},close:function(){this.superClass.close.call(this),clearInterval(this.clockTimer),this.container.removeClass("unsub")},autoClose:function(i){var s=this;clearInterval(this.clockTimer),i&&(this.clockTimer=setInterval(function(){i>0?--i:s.close()},1e3))}}),sohuHD.rss.ConfirmDialog=function(i,s){this.superClass.constructor.call(this,i,s),this.dialogWidth=this.originalConfig.dialogWidth||354},t.inherit(sohuHD.rss.ConfirmDialog,sohuHD.rss.BaseDialog,{initHTML:function(){this.superClass.initHTML.call(this),this.box.addClass("wBox-read-1 confirm-dialog"),this.title=this.originalConfig.title||"\u60a8\u786e\u5b9a\u8981\u53d6\u6d88\u8ba2\u9605\u5417\uff1f";var i='<div class="row mB10 cfix"><span class="ico-que l"></span><div class="wzi l"><div class="blank5H"></div><strong class="title-label fs14 c-black">'+this.title+'</strong></div></div><div class="ta-c"><a rel="btn" rev="confirm" class="btn1a mR6" href="#"><span>\u786e \u5b9a</span></a> <a rel="btn" rev="cancel" class="btn1" href="#"><span>\u53d6 \u6d88</span></a></div>';this.innerBox.html(i),this.titleLabel=this.innerBox.find(".title-label ")},setTile:function(i){this.titleLabel.html(i||"")}});var o={},a={};t.extend(sohuHD.rss,{subUrl:"//my.tv.sohu.com/user/a/subscribe/batchAdd.do",unsubUrl:"//my.tv.sohu.com/user/a/subscribe/delete.do",checkUrl:"//push.my.tv.sohu.com/user/a/subscribe/batchJudge.do",isLogin:function(){return!!this.getPassport()},getPassport:function(){return sohuHD.passport.getPassport()},subscribe:function(i,s,t,e){if(!this.isLogin())return!1;var o=this.getPassport();i=i?"&playlistids="+i:"",s=s?"&channelid="+s:"",t=t||n,e=t||n,sohuHD.getJSONP(this.subUrl+"?plat=604&passport="+o+i+s+"&callback=?",function(i){t(i||{})},null,function(){e()})},md5key:"2012sohu%subscribe",subAnony:function(i,s,t,n,e,o){var a=(new Date).getTime(),l=faultylabs.MD5(""+i+a+this.md5key).toLowerCase(),r=this.subUrl+"?playlistids="+s+"&passport="+i+"&type="+t+"&sig="+l+"&time="+a,c="";n=n||{};for(var h in n)c+="&"+h+"="+n[h];sohuHD.getJSONP(r+"&callback=?",function(i){e&&e(i)},null,function(){o&&o()})},unsubscribe:function(i,s,t){if(!this.isLogin())return!1;var e=this.getPassport();s=s||n,t=t||n,sohuHD.getJSONP(this.unsubUrl+"?passport="+e+"&playlistid="+i+"&callback=?",function(i){s(i||{})},null,function(){t()})},check:function(s,t,n,e){e=e||i,sohuHD.getJSONP(this.checkUrl+"?callback=?&plat=100"+(s&&s.length?"&playlistids="+s.join(","):"")+(t&&t.length?"&channelids="+t.join(","):""),function(i){i=i||{},1==i.status&&n&&n.call(e,i)})},registType:function(i,s){a[i]=s},unregistType:function(i){var s=a[i];return delete a[i],s},getStrategyType:function(i){return a[i]},regist:function(i,s){o[i]=s},unregist:function(i){var s=o[i];return delete o[i],s},store:function(i,s){sohuHD.cookie(i,s,{domain:"tv.sohu.com"})},retrive:function(i){return sohuHD.cookie(i)},clear:function(i){sohuHD.cookie(i,0,{expires:-1,domain:"tv.sohu.com"})},run:function(){for(var i=Array.prototype.slice.call(arguments,0),s=0,t=i.length;t>s;s++)try{o[i[s]]&&o[i[s]].start()}catch(n){}}})}(window,jQuery,sohuHD),function(i,s){var t=sohuHD.rss,n={autoCloseTime:3,dialogs:{},getDialog:function(i){var s;return!(s=this.dialogs[i])&&sohuHD.rss[i]&&(s=new sohuHD.rss[i],this.dialogs[i]=s),s},closeAllDialog:function(){var i=this.dialogs;for(var s in i)i[s].close()},btns:null,key:"mo-rss",start:function(){messagebus.subscribe("core.login",this.init,this,null,{cache:!0}),messagebus.subscribe("core.logout",this.uInit,this,null,{cache:!0})},uInit:function(){this.closeAllDialog(),this.btns=s(".rss-btn").addClass("btn-read"),this.btns.hide();var i=['<div class="mod-b rss-div" plid="{plid}">','<span class="btn-dy-a"><em>\u8ba2\u9605</em></span>','<ul class="read-bub td-n" style="display:none;">','<li><span class="ico-on"></span><a plid="{plid}" type="mes" class="mes u-rss-btn" href="#">\u624b\u673a\u77ed\u4fe1</a></li>','<li><span class="ico-on"></span><a plid="{plid}" type="email" class="email u-rss-btn" href="#">\u7535\u5b50\u90ae\u4ef6</a></li>','<li><span class="ico-on"></span><a plid="{plid}" type="zone" class="zone u-rss-btn" href="#">\u6211\u7684\u7a7a\u95f4</a></li>',"</ul>","</div>"];this.btns.each(function(){var t=s(this),n=t.attr("plid");t.after(i.join("").replace(/{plid}/g,n))}),this.divs=s(".rss-div"),this.uInitEvent()},uAutoRSS:function(){var i=t.retrive("rsssina"),s=this;i&&(t.subscribe(i,null,function(n){s.changeStatus({s:1,p:i});var e=s.getDialog("TipDialog");e.showLinkBtn(),e.hideConfirmBtn(),e.setInfoLabel("\u60a8\u7684\u90ae\u7bb1\u662f\uff1a"),e.setInfo(t.getPassport()),e.setTitle("\u8ba2\u9605\u6210\u529f"),e.show(el),e.autoClose(s.autoCloseTime)}),t.clear("rsssina"))},uInitEvent:function(){var i=this,n={mes:function(n){var e=function(){var e=o.getMobileNumber(),a=o.getRem(),l=s(n),r=l.attr("plid");t.subAnony(e,r,5,null,function(s){if(s&&1==s.status){a?sohuHD.cookie("rssmes",e,{path:"/",domain:"tv.sohu.com",expires:30}):sohuHD.cookie("rssmes",0,{path:"/",domain:"tv.sohu.com",expires:-1}),l.prevAll(".ico-on").show(),i.closeAllDialog();var t=i.getDialog("TipDialog");t.showLinkBtn(),t.hideLinkBtn(),t.setInfoLabel("\u60a8\u7684\u624b\u673a\u53f7\u662f\uff1a"),t.setInfo(e),t.setTitle("\u8ba2\u9605\u6210\u529f"),t.show(n),t.autoClose(i.autoCloseTime)}})},o=this.getDialog("MesDialog");return o.success=e,this.closeAllDialog(),o.show(n),!1},sina:function(i){return t.store("rsssina",s(i).attr("plid")),i.href="//my.tv.sohu.com/user/thirdParty.jsp?thirdParty=sina&bru="+escape(location.href),!0},email:function(n){var e=function(){var e=o.getEmail(),a=o.getRem(),l=s(n),r=l.attr("plid");a?sohuHD.cookie("rssemail",e,{path:"/",domain:"tv.sohu.com",expires:30}):sohuHD.cookie("rssemail",0,{path:"/",domain:"tv.sohu.com",expires:-1}),t.subAnony(e,r,6,null,function(s){if(s&&1==s.status){l.prevAll(".ico-on").show(),i.closeAllDialog();var t=i.getDialog("TipDialog");t.showConfirmBtn(),t.hideLinkBtn(),t.setInfoLabel("\u60a8\u7684\u90ae\u7bb1\u662f\uff1a"),t.setInfo(e),t.setTitle("\u8ba2\u9605\u6210\u529f\u4e86"),t.setTip.hide(),t.show(n),t.autoClose(i.autoCloseTime)}})},o=this.getDialog("EmailDialog");return o.success=e,this.closeAllDialog(),o.show(n),!1},zone:function(i){return t.store(this.key,s(i).attr("plid")),sohuHD.showLoginWinbox(),!1}};this.divs.each(function(){var i=s(this);i.find(".btn-dy-a").on("click",function(){var t=s(this);t.hasClass("btn-dy-a-ed")?(t.removeClass("btn-dy-a-ed"),i.find(".read-bub").hide()):(t.addClass("btn-dy-a-ed"),i.find(".read-bub").show())})}),this.divs.on("click",".u-rss-btn",function(){var t=!1,e=s(this).attr("type");return n[e]&&(t=n[e].call(i,this)),t})},init:function(){this.closeAllDialog(),this.btns=s(".rss-btn"),s(".rss-div").hide(),this.btns.length&&(this.btns.show(),this.initEvent(),t.isLogin()?t.check(function(){var i=[];return this.btns.each(function(){this.getAttribute("plid")&&i.push(this.getAttribute("plid"))}),i}.call(this),null,function(i){this.initBtns(i)},this):this.changeStatus(0))},autoSubscribe:function(){var i=t.retrive(this.key),s=this;i&&(t.subscribe(i,null,function(n){s.changeStatus({s:1,p:i});var e=s.getDialog("TipDialog");e.showLinkBtn(),e.hideConfirmBtn(),e.setInfoLabel("\u60a8\u7684\u90ae\u7bb1\u662f\uff1a"),e.setInfo(t.getPassport()),e.setTitle("\u8ba2\u9605\u6210\u529f"),e.show(),e.autoClose(s.autoCloseTime)}),t.clear(this.key)),this.uAutoRSS()},initBtns:function(i){var t=i.playlist||[],n=this;s.each(t,function(i,s){s.isSubsAble&&n.changeStatus({s:s.isSubs?"1":"0",p:s.playlisid})}),this.autoSubscribe()},initEvent:function(){var i=this;this.btns.hover(function(){var t=s(this);"subed"==t.data("action")&&i.changeStatus({s:2,p:t.attr("plid")})},function(){var t=s(this);"unsub"==t.data("action")&&i.changeStatus({s:1,p:t.attr("plid")})});var n={sub:function(s){var n=s.getAttribute("plid"),e=!1;return t.isLogin()?t.subscribe(n,null,function(e){i.changeStatus({s:1,p:n});var o=i.getDialog("TipDialog");o.showLinkBtn(),o.hideConfirmBtn(),o.setInfoLabel("\u60a8\u7684\u90ae\u7bb1\u662f\uff1a"),o.setInfo(t.getPassport()),o.setTitle("\u8ba2\u9605\u6210\u529f"),o.setTip.show(),o.show(s),o.autoClose(i.autoCloseTime)}):(t.store(this.key,n),s.href="//my.tv.sohu.com?bru="+escape(location.href),e=!0),e},unsub:function(s){var n=t.dialog,e=s.getAttribute("plid"),o=function(){t.unsubscribe(e,function(t){i.changeStatus({s:0,p:e}),i.closeAllDialog();var n=i.getDialog("TipDialog");n.container.addClass("unsub"),n.showConfirmBtn(),n.hideLinkBtn(),n.hideInfoLabel(),n.hideInfo(),n.setTitle("\u9000\u8ba2\u6210\u529f"),n.show(s),n.autoClose(i.autoCloseTime)})};this.closeAllDialog();var n=this.getDialog("ConfirmDialog");return n.success=o,n.show(s),!1}};this.btns.click(function(t){var e=s(this),o=e.data("action");if(n[o])var a=n[o].call(i,this);return!!a})},statusMap:{0:{c:"btn-read",t:"\u8ba2\u9605",a:"sub"},1:{c:"btn-read-ed",t:"\u5df2\u8ba2\u9605",a:"subed"},2:{c:"btn-read-cancel",t:"\u53d6\u6d88\u8ba2\u9605",a:"unsub"}},changeStatus:function(i){var t=this,n=Object.prototype.toString,e=function(){var i=[];for(var s in this.statusMap)i.push(this.statusMap[s].c);return i.join(" ")}.call(this);if("[object Number]"==n.call(i)||"[object String]"==n.call(i)){var o=this.statusMap[""+i];if(!o)return;this.btns.removeClass(e).addClass(o.c).text(o.t).data("action",o.a)}else"[object Object]"==n.call(i)&&(i=[i]),s.each(i,function(i,s){var n=t.statusMap[s.s];t.btns.filter("[plid="+s.p+"]").removeClass(e).addClass(n.c).text(n.t).data("action",n.a)})}};t.regist("mo",n)}(window,jQuery),function(i,s){var t=sohuHD.rss,n=sohuHD.showLoginWinbox,e=sohuHD.cookie,o={subBtn:"#playtoolbar .vBox-warn",needConfirmDialog:!0,subscribeCallback:function(){},unsubscribeCallback:function(){}};s.extend(sohuHD.rss,{canRss:function(){var s=i.cid;return 2==s||16==s||7==s||8==s||9001==s},configure:function(i){s.extend(o,i)}});var a={unsubed:"\u8ffd\u5267\u63d0\u9192",subed:"\u6b63\u5728\u8ffd",cancel:"\u53d6\u6d88\u8ffd\u5267"},l={dialog:{},closeAllDialog:function(){sohuHD.closeWin()},confirmDialog:function(i){var s=this.dialog.confirm;s||(s=this.dialog.confirm=new sohuHD.showWin({htmlStr:["",'<div class="wBox wBox-cancel">','<div class="wBox-wrap">','<div class="cfix"><a class="close ico-close r" href="#"></a></div>','<div class="wBox-con">','<h6 class="mB15">\u60a8\u786e\u5b9a\u8981\u53d6\u6d88\u66f4\u65b0\u63d0\u9192\u5417\uff1f</h6>','<div><input type="button" value="\u786e \u5b9a" class="btn-2"><input type="button" value="\u53d6 \u6d88" class="close btn-grey"></div>',"</div>","</div>","</div>"].join(""),noMask:!0}),s.initWin(),s.winbox.delegate("input.btn-2","click",function(){i.call(),s.closeWin()})),s.show()},successDialog:function(){var i=this.dialog.success;i||(i=this.dialog.success=new sohuHD.showWin({htmlStr:["",'<div id="wBoxA" class="wBox wBoxA">','<div class="wBox-wrap">','<div class="cfix"><a class="close ico-close r" href="#"></a></div>','<div class="wBox-con cfix">','<div class="wL l">','<span class="ico-ok l"></span>','<div class="txt l">','<span class="wBox-msg">','<strong class="fs14">\u66f4\u65b0\u63d0\u9192\u8bbe\u7f6e\u6210\u529f\uff01</strong>','<p class="p1">\u8bf7\u9009\u62e9\u60a8\u504f\u597d\u7684\u63d0\u9192\u65b9\u5f0f</p>',"</span>","<div>",'<a href="//my.tv.sohu.com/user/setting/subscribe.do" target="_blank" class="btn-2">\u8bbe\u7f6e</a>',"<p>\u8bbe\u7f6e\u9ed8\u8ba4\u901a\u77e5\u65b9\u5f0f</p>","</div>","</div>","</div>",'<div class="wR tac r">','<p class="c-black">\u5173\u6ce8\u5fae\u4fe1\u516c\u4f17\u53f7</p>','<p class="mB10 c-black">\u66f4\u65b0\u63d0\u9192\u65e9\u77e5\u9053</p>','<img class="qrcode hid" src="about:blank" width="70" height="70"/>',"</div>","</div>","</div>","</div>"].join(""),noMask:!0,autohide:!1}),i.initWin(),i.setInfo=function(s){i.winbox.find(".j-passport").html(s)},messagebus.subscribe("core.login.userinfo",function(s,t){sohuHD.getWeixinQrcode(t.id).done(function(s){i.winbox.find(".qrcode").attr("src",s).show()})},null,null,{cache:!0}),messagebus.subscribe("core.logout",function(s,t){sohuHD.getWeixinQrcode().done(function(s){i.winbox.find(".qrcode").attr("src",s).show()})},null,null,{cache:!0})),o.needConfirmDialog||this.setAnimation(),o.subscribeCallback&&o.subscribeCallback()||(i.show(),i.setInfo(t.getPassport()))},getSubBtn:function(){var i=this.getSubBtn.cached;return i&&i.length>0||(i=this.getSubBtn.cached=s(o.subBtn)),i},isTipEnable:function(){return!e("_subk")},disableTip:function(){e("_subk",1,{expires:365,domain:"tv.sohu.com",path:"/"})},changeTipStatus:function(s,t){var n=this;if(t&&this.isTipEnable()){s.addClass("vBoxVis");var e=i.setTimeout(function(){n.changeTipStatus(s,!1)},3e4);s.find(".ta-r a").one("click",function(t){return i.clearTimeout(e),n.changeTipStatus(s,!1),n.disableTip(),!1})}else s.removeClass("vBoxVis")},changeBtnStatus:function(i,s){s?(i.find(".vbtn").addClass("vbtn-warned"),o.needConfirmDialog||i.find(".vbtn").html(a.subed).attr("title","")):(i.find(".vbtn").removeClass("vbtn-warned"),o.needConfirmDialog||i.find(".vbtn").html(a.unsubed).attr("title","\u6709\u66f4\u65b0\u4f1a\u7b2c\u4e00\u65f6\u95f4\u901a\u77e5\u4f60"))},toggle:function(i,s){var n=this;i.find(".vbtn").hasClass("vbtn-warned")?(n.closeAllDialog(),o.needConfirmDialog?n.confirmDialog(function(){t.unsubscribe(s,function(){n.changeBtnStatus(i,!1),n.changeTipStatus(i,!1),o.unsubscribeCallback()})}):t.unsubscribe(s,function(){n.changeBtnStatus(i,!1),n.changeTipStatus(i,!1),o.unsubscribeCallback()})):(this.changeBtnStatus(i,!0),t.subscribe(s,null,function(){n.successDialog(),n.changeTipStatus(i,!1)}))},initEvent:function(){var i=this,e=this.getSubBtn();o.needConfirmDialog||e.find(".vbtn").hover(function(){var i=s(this);i.hasClass("vbtn-warned")&&i.html(a.cancel)},function(){var i=s(this);i.hasClass("vbtn-warned")&&i.html(a.subed)}),e.click(function(s){return t.isLogin()?(i.toggle(e,e.attr("data-plid")),void s.preventDefault()):(messagebus.publish("statV2.ping",{type:"click",txid:"pg_playlist_notice",other:""}),n(),void s.preventDefault())})},start:function(){var i=this,n=this.getSubBtn();n.length>0&&t.canRss()&&(i.changeTipStatus(n,!0),messagebus.subscribe("core.login",function(){t.check([n.attr("data-plid")],null,function(t){s.each(t.playlist||[],function(s,t){t.isSubsAble&&i.changeBtnStatus(n,t.isSubs)})})},this,null,{cache:!0}),messagebus.subscribe("core.logout",function(){i.changeBtnStatus(n,!1)},this,null,{cache:!0}),this.initEvent())},setAnimation:function(){var i=this.getSubBtn().offset(),t=s("#hd-fBox2").offset();if(t&&0!=t.left){var n=document.createElement("div");n.innerHTML='<img src="//css.tv.itc.cn/global/images/nav1/clock.png">';var e={position:"absolute",top:i.top-21+"px",left:i.left+25+"px","z-index":999},o=[];for(var a in e)o.push(a+":"+e[a]);n.style.cssText=o.join(";"),s("body").append(n),s(n).animate({top:t.top+1,left:t.left-6},500,"linear",function(){s(n).addClass("pulse"),setTimeout(function(){s(n).remove()},1e3)})}}};t.regist("psub",l)}(window,jQuery);