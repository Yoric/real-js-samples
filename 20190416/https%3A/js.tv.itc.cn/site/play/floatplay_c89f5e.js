/* sohutv 2019-04-16 14:26:50 */
!function(n){var t;function o(t,i){var c={min_x:0,max_x:100,min_y:0,max_y:100,limit:function(t){return t.x=Math.max(t.x,this.min_x),t.x=Math.min(t.x,this.max_x),t.y=Math.max(t.y,this.min_y),t.y=Math.min(t.y,this.max_y),t},onInit:function(t,i){},onDrag:function(t,i){}},n=$(t),e=$(window.document.documentElement);return i&&$.extend(c,i),n.each(function(){var s,a,o=this,l=$(this),r={},p=!1,h={};c.onInit(o),l.mousedown(function(t){document.onselectstart=function(){return!1},p=!0,s=t.pageX,a=t.pageY,r.left=parseFloat(l.css("left")),r.top=parseFloat(l.css("top")),isNaN(r.left)&&(r.left=0),isNaN(r.top)&&(r.top=0),h.x=r.left,h.y=r.top}),e.mousemove(function(t){if(p){var i=t.pageX-s,e=t.pageY-a,n=c.limit({x:r.left+i,y:r.top+e});h=n,l.css({left:n.x,top:n.y}),c.onDrag(o,{left:n.x,top:n.y,dx:i,dy:e})}}).mouseup(function(){p&&messagebus.publish("statV2.ping",{url:"mc",type:"click",txid:"pg_showplayer",other:"left:"+h.x+"px;top:"+h.y+"px"}),p=!1,document.onselectstart=function(){return!0}})}),{moveTo:function(t,i){var e=c.limit({x:t,y:i});n.css({left:e.x,top:e.y})}}}t=["","<style>",".floatplay .x-webgl canvas{width:100% !important;height:100% !important;}","</style>"].join(""),$(t).appendTo("head");var s={$placeholder:$("#sohuplayer"),$player:$("#player"),adHeight:52,checkVisible:function(t){var i=t||$(window),e=this.$placeholder,n=e.offset();n.width=e.width(),n.height=e.height()-40;var s=i.scrollLeft(),a=i.scrollTop(),o=i.width(),l=i.height();return n.left<0?"unknow":n.left+n.width>s&&n.left<s+o&&n.top+n.height>a&&n.top<a+l?"visible":"invisible"},currentSize:function(){var t=n.baseInfo,i=1.77;t&&t.settings&&t.settings.ratio&&(i=t.settings.ratio);return{width:350,height:350/i}},currentPoint:function(){if(!this.currentPoint.x||!this.currentPoint.y){var t=this.currentSize();this.currentPoint.x=$(window).width()-t.width-60,this.currentPoint.y=$(window).height()-t.height-10}return{x:this.currentPoint.x,y:this.currentPoint.y}},initEvent:function(){var t=this,i=this.$mask;function e(t){"pause"==t?i.find(".btn_control").removeClass("btn_pause"):i.find(".btn_control").addClass("btn_pause")}i.on("mouseover",".play_close",function(){$(this).next(".play_tips").html("\u5728\u8be5\u9875\u9762\u5173\u95ed\u5c0f\u7a97\u529f\u80fd")}).on("mouseout",".play_close",function(){$(this).next(".play_tips").html("\u70b9\u51fb\u6309\u4f4f\u89c6\u9891\u53ef\u62d6\u52a8")}).on("click",".play_close",function(){t.destory()}).on("click",".btn_control",function(){window._player&&(_player.ui.lock||_player.state===_player.STATE_ADV)||($(this).hasClass("btn_pause")?t.pauseVideo():t.playVideo())}),messagebus.subscribe("play.play",function(){e(n.playStatus)},null,null,{cache:!0}),messagebus.subscribe("play.pause",function(){e(n.playStatus)},null,null,{cache:!0})},initAd:function(){var l=this,r=l.$mask,p=l.$player,h="15090";_sohuHD.AD.subscribe&&_sohuHD.AD.subscribe(h,function(t,i){l.config=i||{},$("#"+h).remove();var e='<div style="position:absolute;bottom:0;border-top:2px solid #858484"><div id="15090"><div></div>';if(l.config.src){var n=l.currentSize(),s=l.currentPoint(),a=n.height+l.adHeight,o=s.y-l.adHeight;r.css({height:a,top:o}).append(e),p.css({top:o}),l.currentPoint.y=o,l.hasAd=!0}else r.append(e);_sohuHD.AD.init(h)},null,null,{cache:!0})},initMask:function(){var e=this,n=this.$mask,t=this.$player;if(!(n&&0<n.length)){var i=this.currentSize(),s=this.currentPoint(),a=["",'<div class="mini_player">','<span class="play_mask"></span>','<span class="play_close"></span>','<p class="play_tips c-white fs14">\u70b9\u51fb\u6309\u4f4f\u89c6\u9891\u53ef\u62d6\u52a8</p>','<a href="javascript:void(0);" class="btn_control"></a>',"</div>"].join("");(n=this.$mask=$(a).appendTo("body")).css({position:"fixed",width:i.width,height:i.height,left:s.x,top:s.y,"z-index":parseInt(t.css("z-index"),10)+1}),this.initEvent(),this.initAd(),new o(n,{limit:function(t){var i=$(window).width()-n.width()-10,e=$(window).height()-n.height()-10;return t.x=Math.max(t.x,10),t.x=Math.min(t.x,i),t.y=Math.max(t.y,46),t.y=Math.min(t.y,e),t},onDrag:function(t,i){e.currentPoint.x=i.left,e.currentPoint.y=i.top,e.$player.css({left:i.left,top:i.top})}})}return window._player&&(_player.ui.lock||_player.state===_player.STATE_ADV?n.find(".btn_control").hide():n.find(".btn_control").show()),n},ctrlBarVisible:function(t){try{window._player?_player.ctrlBarVisible(t):this.$player[0].ctrlBarVisible(t)}catch(i){}},pauseVideo:function(){try{window._player?(window._player.pause(),window.sohuHD&&n.onVideoPause&&n.onVideoPause()):this.$player[0].pauseVideo()}catch(t){}},playVideo:function(){try{window._player?(window._player.play(),window.sohuHD&&n.onVideoPlay&&n.onVideoPlay()):this.$player[0].playVideo()}catch(t){}},open:function(){if(!($("#player_vipTips").length||this.$player[0]&&this.$player[0].startAdInPlay&&this.$player[0].startAdInPlay()||"normal"!==n.play.player_status)){var t=this.currentSize(),i=this.currentPoint(),e={position:"fixed","z-index":1e3,left:i.x,top:i.y,width:t.width,height:t.height};this.$player.css(e).addClass("floatplay"),this.$player[0].width=t.width,this.$player[0].height=t.height,this.ctrlBarVisible(0),this.initMask(),this.$mask&&this.$mask.show(),window._player&&(_player.paused?this.pauseVideo():this.playVideo()),n.play.player_status="floating",messagebus.publish("statV2.ping",{url:"mc",type:"impress",txid:"pg_showplayer"})}},close:function(){"floating"===n.play.player_status&&(this.$player.css({position:"static",top:"auto",left:"auto","z-index":1}).removeClass("floatplay"),this.ctrlBarVisible(1),this.$mask&&this.$mask.hide(),n.play.player_status="normal",n.play.adjust())},destory:function(){this.status="destory",this.close(),this.$mask.remove()},handler:function(){if(this.$player=$("#player"),"destory"!==this.status){var t=this.checkVisible();"visible"===t?this.close():"invisible"===t&&this.open()}else $(window).unbind("scroll.floatplay")}};function i(){s.$player=$("#player");var t,i,e;$(window).bind("scroll.floatplay",(t=100,i=null,e=function(){s.handler()},function(){clearTimeout(i),i=setTimeout(e,t)}))}messagebus.subscribe("play.openVipWin",function(t,i){s.close()},null,null,{cache:!0}),messagebus.subscribe("play.onVideoPlayed",function(){i()},null,null,{cache:!0}),messagebus.subscribe("h5player.playvideo",function(){i(),window._player&&_player.on("playing",function(){_player.state===_player.STATE_MOIVE?$(".mini_player .btn_control").show():$(".mini_player .btn_control").hide()})},null,null,{cache:!0})}(sohuHD);