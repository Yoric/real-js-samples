/* sohutv 2017-11-23 14:34:24 */
!function(a,t,e){var r=t.Template;r.registHelper({extendStarWorkItem:function(a){return 1==a.cid?(a.cornerStr="rl-mov",a.maskStr=a.playTime):2==a.cid?(a.cornerStr="rl-dra",a.nowSet<a.totalSet?a.maskStr="\u66f4\u65b0\u81f3\u7b2c"+a.nowSet+"\u96c6":a.totalSet<a.nowSet?a.maskStr="\u5171"+a.nowSet+"\u96c6":a.maskStr="\u5171"+a.totalSet+"\u96c6",(!a.VIDEO_VIDEO_TV_TYPE||0!=a.VIDEO_VIDEO_TV_TYPE&&1!=a.VIDEO_VIDEO_TV_TYPE)&&(a.maskStr=a.playTime)):7==a.cid||1106==a.cid?(a.cornerStr="rl-zy",7==a.cid?a.maskStr="":a.maskStr=sohuHD.strSub(a.albumName||"",18,"..")):16==a.cid?(a.cornerStr="rl-dhua",a.maskStr=a.playTime):1108==a.cid?(a.cornerStr="rl-yle",a.maskStr=a.playTime,a.showPicClass="pic80",a.showPicHeight=80):1109==a.cid?(a.cornerStr="",a.maskStr=a.playTime,a.showPicClass="pic80",a.showPicHeight=80):121==a.cid?(a.cornerStr="",a.maskStr=a.playTime,a.showPicClass="pic80",a.showPicHeight=80):1122==a.cid?(a.cornerStr="",a.maskStr=a.video_publishTime||a.playTime,a.showPicClass="pic80",a.showPicHeight=80):1600==a.cid?(a.cornerStr="",a.maskStr=a.playTime,a.showPicClass="pic80",a.showPicHeight=80):(a.maskStr="",a.cornerStr=""),1106==a.cid||1108==a.cid||1600==a.cid||1122==a.cid||121==a.cid?(1106==a.cid||1122==a.cid||121==a.cid?(a.showtitle=sohuHD.strSub(a.video_first_title||a.title||"",53,"..."),a.title=a.video_first_title||a.title||""):(a.showtitle=sohuHD.strSub(a.handleTitle||a.title||"",53,"..."),a.title=a.handleTitle||a.title||""),a.showrole="",a.zystyle='style="height:36px;"'):(a.showtitle=sohuHD.strSub(a.title||"",32,"..."),a.showrole=a.role?"<p>\u9970\u6f14\uff1a"+a.role+"</p>":"<p>&nbsp;</p>",a.zystyle=""),a.VIDEO_VIDEO_TV_TYPE&&(2==a.VIDEO_VIDEO_TV_TYPE?a.cornerStr="rl-ygao":5==a.VIDEO_VIDEO_TV_TYPE?(a.maskStr=a.playTime,a.cornerStr="rl-phua"):(3==a.VIDEO_VIDEO_TV_TYPE||4==a.VIDEO_VIDEO_TV_TYPE||6==a.VIDEO_VIDEO_TV_TYPE)&&(a.cornerStr="rl-hxu",a.maskStr=a.playTime)),a},getWorksClass:function(a){var t="";return(1108==a||1109==a||121==a||1122==a||1600==a)&&(t="pic80"),t},getStatStar:function(a,t){var r="location=1&starid="+t.id+"&index="+a.toString()+"&refvid="+e.vid+"&refpid="+e.playlistId+"&refcid="+e.cid;return r},getStatStarWork:function(a,t,r){var i="location=2&starid="+r+"&index="+a.toString()+"&vid="+t.videoid+"&pid="+t.id+"&cid="+t.cid+"&refvid="+e.vid+"&refpid="+e.playlistId+"&refcid="+e.cid;return i},starTimeFormat:function(a){function t(a,t){return(1e20+""+a).slice(-t)}var e=t(Math.floor(a/3600),2),r=t(Math.floor((a-3600*e)/60),2),i=t(a%60,2),s=[e,r,i];return s.join(":")},delHtmlTag:function(a){return a.replace(/<[^>]+>|\s+/g,"")}});var i={};i.role_item=["","<% var ptotal = Math.ceil(starsPageParam.total / starsPageParam.pSize); %>","<% var pIndexL = ~~starsPageParam.pIndex - 1; %>","<% var pIndexR = ~~starsPageParam.pIndex + 1; %>",'<span class="role-tab-btnL role-tab-btn" pb-click data-pb-txid="pg_star_tab" data-pb-other="pageturn" data-pindex="<%=pIndexL %>" data-ptotal="<%=ptotal %>" <%if(pIndexL < 0){%>style="display:none;"<%}%> ></span>','<span class="role-tab-btnR role-tab-btn" pb-click data-pb-txid="pg_star_tab" data-pb-other="pageturn" data-pindex="<%=pIndexR %>" data-ptotal="<%=ptotal %>" <%if(pIndexR == ptotal){%>style="display:none;"<%}%> ></span>','<ul class="role-tab-list cfix">','    <% var defstarurl = "//css.tv.itc.cn/channel/play_images/defstar.jpg"; %>',"    <% $.each(data, function(n, item) { %>","    <% var staturl = helper.getStatStar(n, item); %>","    <% var showStar = !!item.vstarInfo; %>",'    <% var vstarTab = (showStar && item.vstarInfo.showStar) ? "|vstartab" : ""; %>','    <li class="<%=helper.on(curStarId == item.id)%>" star_hover_action="<%=item.bs64sid%>|0|0" pb-hover="mc" data-pb-txid="pg_star_tab" data-pb-other="<%=item.bs64sid%>|<%=item.name%><%=vstarTab%>" data-starid="<%=item.id %>">','        <span class="arr"></span>','        <p class="rlPic">','            <a title="<%=item.name%>" href="<%=item.starUrl%>" data-stat-url="<%=staturl%>" pb-click="mc" data-pb-txid="pg_star_name" data-pb-other="<%=item.bs64sid%>|<%=item.name%>|image" target="_blank">','                <span class="rlPic-circle"></span>','                <img src="<%=item.image || defstarurl%>" alt="<%=item.name%>" width="60" height="60">','                <% if(showStar && item.vstarInfo.dayRank > 0 && item.vstarInfo.dayRank < 11){ %><span class="star-rank"><%=item.vstarInfo.dayRank %></span><%}%>',"            </a>","        </p>","        <div class=\"rlIname <%=(showStar ? 'role-vstar' : '') %>\">",'            <strong><a title="<%=item.name%>" href="<%=item.starUrl%>" data-stat-url="<%=staturl%>" target="_blank" pb-click="mc" data-pb-txid="pg_star_name" data-pb-other="<%=item.bs64sid%>|<%=item.name%>|title"><%=item.name%></a></strong>',"            <% if(window.cid == 2 && item.nowRole) { %>",'                <div class="role-name" title="<%=item.nowRole %>"><%=("\u9970 " + item.nowRole)%></div>',"            <% } else {%>",'                <div class="role-name"><%=item.country%>&nbsp;<%=item.constellation%></div>',"            <% } %>","            <% if(showStar){ %> ",'                <div class="role-vstarinfo" pb-click-a data-pb-txid="pg_star_vstarhead">','                    <a href="javascript:void(0);" class="btn-love <%=(item.vstarInfo.isPraise ? \'btn-love-ed\' : \'\')%>" data-pb-other="<%=item.bs64sid%>|<%=item.name%>|like"><i><%=item.vstarInfo.popularity %></i><span class="btn-love-tips"></span></a>',"                    <a href=\"javascript:void(0);\" class=\"btn-attent <%=(item.vstarInfo.follow ? 'btn-attent-ed' : '') %>\" data-pb-other=\"<%=item.bs64sid%>|<%=item.name%>|follow\"><%=(item.vstarInfo.follow ? '\u5df2\u5173\u6ce8' : '\u5173\u6ce8')%></a>","                </div>","            <% } %>","        </div>","    </li>","    <% }); %>","</ul>"].join(""),i.role_work=["",'<ul class="role-subTab cfix">',"    <% $.each(attach.cats, function(i, cat) { %>",'    <% var pbtxid = (cat.txid ? cat.txid : "pg_star_chltab");%>','    <% var pbother = (cat.other ? cat.other : [attach.starId,cat.cid].join("|")); %>','    <li star_click_action="<%=attach.starId%>|<%=cat.cid%>|0" pb-click="mc" data-pb-txid="<%=pbtxid %>" data-pb-other="<%=pbother %>" class="<%=helper.on(attach.catId == cat.cid)%>"><%=cat.name%><span><%=cat.count%></span></li>',"    <% }); %>","</ul>",'<div class="role-tcont <%=helper.getWorksClass(attach.catId) %>">','    <ul class="list list-140 cfix" pb-click-a="mc" data-pb-txid="pg_star_nr">',"        <% $.each(attach.works, function(i, workItem) { %>","        <% var item = helper.extendStarWorkItem(workItem);%>","        <% var staturl = helper.getStatStarWork(i, workItem, attach.sid); %>","        <li>",'            <div class="pic <%=item.showPicClass%>">','                <a target="_blank" href="<%=item.videoUrl%>" title="<%=item.title%>" data-stat-url="<%=staturl%>" class="apic" data-pb-other="<%=attach.starId%>|<%=attach.catId%>|<%=item.id%>|image">','                    <img width="140" height="<%=item.showPicHeight || 190%>" src="<%=item.videoVerBigPic || item.verpic %>">',"                </a>","                <%if(item.maskStr && item.maskStr.length) {%>",'                <span class="maskBg"></span>','                <div class="maskTx">','                    <span class="l"><%=item.maskStr%></span>',"                </div>","                <%}%>","            </div>","            <strong <%=item.zystyle%> >",'                <a target="_blank" href="<%=item.videoUrl%>" title="<%=item.title%>" data-stat-url="<%=staturl%>" data-pb-other="<%=attach.starId%>|<%=attach.catId%>|<%=item.id%>|title"><%=item.showtitle%></a>',"            </strong>","            <%=item.showrole%>","        </li>","        <% }); %>","    </ul>","    <%if(attach.total > attach.pSize) {%>",'        <div id="star_point_container" data-pb-txid="pg_star_nextpg" data-pb-other="<%=attach.starId%>" data-args="<%=attach.starId%>|<%=attach.catId%>" data-pagination="<%=Math.ceil(attach.total/attach.pSize)%>|<%=attach.pIndex%>"> </div>',"    <%}%>","</div>"].join(""),i.similar_work=["",'<ul class="role-subTab cfix" pb-click="mc" data-pb-txid="pg_star_same" data-pb-other="tab">',"    <% $.each(attach.cats, function(i, cat) { %>",'    <li star_click_action="similar|<%=cat.tabId%>|0" class="<%=helper.on(attach.catId == cat.tabId)%>"><%=cat.tabName%></li>',"    <% }); %>","</ul>",'<div class="role-tcont">','    <ul class="list list-140 cfix" pb-click-a="mc" data-pb-txid="pg_star_same">',"        <% $.each(attach.works, function(i, item) { %>","        <li>",'            <div class="pic">','                <a target="_blank" href="<%=item.url%>" title="<%=item.albumName%>" class="apic" data-pb-other="cover">','                    <img width="140" height="190" src="<%=item.albumPic %>">',"                </a>",'                <span class="maskBg"></span>','                <div class="maskTx">','                    <span class="l"><%=item.updateStatus %></span>','                    <span class="r"><%=item.albumScore %>\u5206</span>',"                </div>","            </div>","            <strong>",'                <a target="_blank" href="<%=item.url%>" title="<%=item.albumName%>" data-pb-other="title"><%=item.albumName%></a>',"            </strong>","            <p><%=item.comment%></p>","        </li>","        <% }); %>","    </ul>","    <%if(attach.total > attach.pSize) {%>",'        <div id="star_point_container" pb-click data-pb-txid="pg_star_same" data-pb-other="pageturn" data-args="similar|<%=attach.catId%>" data-pagination="<%=Math.ceil(attach.total/attach.pSize)%>|<%=attach.pIndex%>"> </div>',"    <%}%>","</div>"].join(""),i.zbqd_work=["",'<ul class="role-subTab cfix" pb-click="mc" data-pb-txid="pg_star_surround">',"<% $.each(cats, function(i, cat) { %>",'<% var albumNames = cat.albumName.split("-"); %>',"<% var albumName = albumNames[1] || albumNames[0]; %>",'<li star_click_action="zbqd|<%=cat.playlistid%>|0" data-pb-other="tab" class="<%=helper.on(curplid == cat.playlistid)%>"><%=albumName %></li>',"<% }); %>","</ul>",'<div class="role-tcont">','<ul class="list list-140 cfix" pb-click-a="mc" data-pb-txid="pg_star_surround">',"<% $.each(videos, function(i, item) { %>","<li>",'<div class="pic">','<a target="_blank" href="<%=item.pageUrl%>" title="<%=item.firstTitle%>" class="" data-pb-other="cover">','<img width="140" height="190" src="<%=item.tvCropPic170225%>">',"</a>","<%if(item.playLength) {%>",'<span class="maskBg"></span>','<span class="maskTx tar"><%=helper.starTimeFormat(Math.floor(item.playLength))%></span>',"<%}%>",'<span class="<%=item.cornerStr%>"></span>',"</div>",'<strong style="height:36px;">','<a target="_blank" href="<%=item.pageUrl%>" title="<%=item.firstTitle%>" data-pb-other="title"><%=item.firstTitle%></a>',"</strong>","</li>","<% }); %>","</ul>","<%if(total > pSize) {%>",'<div id="star_point_container" class="role-point" data-pb-txid="pg_star_surround" data-pb-other="pageturn" data-args="zbqd|<%=curplid%>" data-pagination="<%=Math.ceil(total/pSize)%>|<%=pIndex%>"> </div>',"<%}%>","</div>"].join(""),i.vstar_detail=["",'<div class="vTuan cfix" pb-click-a data-pb-txid="pg_star_vstarpost">','    <div class="vXing">','        <div class="vXing-tit cfix">','            <h4 class="l">','                <a href="<%=topicinfo.detailurl %>" target="_blank" data-pb-other="<%=star.bs64sid%>|<%=star.name%>|heading"><%=topicinfo.title %></a>',"            </h4>",'            <a class="c-red r" href="<%=starhome %>" target="_blank" data-pb-other="<%=star.bs64sid%>|<%=star.name%>|morepost">\u67e5\u770b\u66f4\u591a\u70ed\u5e16</a>',"        </div>","        <% var hasPics = (topicinfo.pics && topicinfo.pics.length); %>",'        <div class="vXing-text" <%if(!hasPics){%>style="max-height:200px;"<%}%> ><%=helper.delHtmlTag(topicinfo.content) %><a class="c-red vXing-detail" href="<%=topicinfo.detailurl %>" target="_blank" data-pb-other="<%=star.bs64sid%>|<%=star.name%>|detail">\u8be6\u60c5<span class="f-song">&gt;&gt;</span></a></div>',"        <% if(hasPics){ %>",'        <ul class="list-130 cfix">',"            <% $.each(topicinfo.pics, function(index, item){ %>",'            <li><a href="<%=topicinfo.detailurl %>" target="_blank" data-pb-other="<%=star.bs64sid%>|<%=star.name%>|pic"><img src="<%=item.picUrl %>" width="130" height="130"></a></li>',"            <% }); %>","        </ul>","        <% } %>","    </div>",'    <div class="vRank">',"        <h3>\u660e\u661f\u4eba\u6c14\u65e5\u699c</h3>",'        <ul class="cfix">',"            <% $.each(ranks, function(index, item){ %>",'            <li <%if(item.starid == starId){%>class="vRank-top-one"<%}%>>','                <span class="vRank-renqi"><%=item.popular %>\u4eba\u6c14</span>','                <span class="vRank-top"><%=item.rank %></span>','                <span class="vRank-tou"><a href="<%=item.starhome %>" target="_blank" data-pb-other="<%=star.bs64sid%>|<%=star.name%>|rank"><img src="<%=item.square_pic %>"></a></span>','                <span class="vRank-name"><a href="<%=item.starhome %>" target="_blank" data-pb-other="<%=star.bs64sid%>|<%=star.name%>|rank"><%=item.name %></a></span>',"            </li>","            <% }); %>","        </ul>","    </div>","</div>"].join(""),i.role_layout=["",'<div class="role-tab cfix <% if( !isLoadSimilar && !isLoadZbqd){ %>role-tab-other<%}%> ">','    <% if(isLoadSimilar) { %><div class="same same-tab l on" pb-click pb-hover data-pb-txid="pg_star_same"><a href="javascript:void(0);" class="same-link">\u540c\u7c7b\u597d\u7247</a><span class="arr arr-same"></span></div><%}%>','    <% if(isLoadZbqd)    { %><div class="zbqd zbqd-tab l on" pb-click pb-hover data-pb-txid="pg_star_surround"><a href="javascript:void(0);" class="around-link">\u5468\u8fb9\u5f3a\u6863</a><span class="arr arr-same"></span></div><%}%>','    <div class="role-tabDiv l"></div>',"</div>",'<div class="role-tab-cnt on cfix rel"></div>'].join("");var s=document.charset||document.characterSet||"gbk";"gb2312"==s.toLowerCase()&&(s="gbk");var n={playStarConfig:{starIds:"",starId:"",playlistId:e.playlistId,cid:e.cid,encode:s,ismj:0,ssl:0},vStarConfig:{starids:"",encode:s},loadPlayStar:function(t){var e=a.Deferred(),r=a.extend({},this.playStarConfig,t),i=r.starId;return h[i]?e.resolve(h[i]):a.ajax({url:"//kis.tv.sohu.com/star/playStarV2",data:r,type:"get",dataType:"jsonp"}).then(function(a){h[i]=a,e.resolve(a)}),e.promise()},loadVStar:function(t){var e=a.Deferred();if(u)e.resolve(u);else{var r=a.extend({},this.vStarConfig,t);a.ajax({url:"//fans.tv.sohu.com/star/h5/pc/starinfos.json",data:r,type:"get",dataType:"jsonp"}).then(function(a){200==a.status&&(u=a.message,e.resolve(u))})}return e.promise()},loadVStarDetail:function(t){var e=a.Deferred(),r="vstar_"+t;return h[r]?e.resolve(h[r]):a.ajax({url:"//fans.tv.sohu.com/star/h5/pc/vinfo.json",data:{starid:t,encode:s},type:"get",dataType:"jsonp"}).then(function(a){h[r]=a,e.resolve(a)}),e.promise()},loadSimilar:function(){var t=a.Deferred();if(h.similar)t.resolve(h.similar);else{var r={pid:e.isPianhua?e.o_playlistId:e.playlistId,jsonp:1};a.ajax({url:"//rc.vrs.sohu.com/drama/similar",data:r,type:"get",dataType:"jsonp"}).then(function(a){h.similar=a,t.resolve(a)})}return t.promise()},loadZbqd:function(t){var e=a.Deferred(),r=a.extend({},{pagesize:999,order:1,ssl:0},t),i=r.playlistid;return h[i]?e.resolve(h[i]):a.ajax({url:"//pl.hd.sohu.com/videolist",data:r,type:"get",dataType:"jsonp"}).then(function(a){h[i]=a,e.resolve(a)}),e.promise()},sign:function(t){return a.ajax({url:"//fans.tv.sohu.com/star/h5/fans/sign.json",data:{starid:t,valid:1},type:"get",dataType:"jsonp"})},follow:function(t){return a.ajax({url:"//fans.tv.sohu.com/star/h5/fans/follow.json",data:{starid:t,valid:1},type:"get",dataType:"jsonp"})}},o={parsePrams:function(a){var t=a.split("|"),e={starId:t[0],catId:t[1],pIndex:parseInt(t[2],10)};return e},getStarDataCats:function(t){var e=a.grep(t.cat,function(a){return 1!=a.cid&&2!=a.cid&&7!=a.cid&&1106!=a.cid});if(t.vstarInfo&&t.vstarInfo.showStar){var r=[t.bs64sid,t.name,"tab"].join("|");e.push({cid:"vstar",count:"",name:"V\u661f\u56e2",txid:"pg_star_vstarpost",other:r})}return e},getStarDataWorks:function(t,e){var r=function(a){return a.cid==e},i=[];return i=1212==e?a.grep(t.works,function(a){return 1==a.cid||2==a.cid}):106007==e?a.grep(t.works,function(a){return 7==a.cid||1106==a.cid}):a.grep(t.works,r)}},l={"W-980":2,"W-1140":3,"W-1300":4,"W-1460":5},d={pIndex:0,total:0,pSize:l[e.currentBodyClassName]||4},c={"W-980":4,"W-1140":5,"W-1300":6,"W-1460":8},p={"W-980":4,"W-1140":5,"W-1300":6,"W-1460":7},m={catId:null,pIndex:0,total:0,pSize:p[e.currentBodyClassName]||4},h={},u=null,v=!1,f={active:"on",prevdisable:"btn-roL-dis",nextdisable:"btn-roR-dis",prev:"btn-roL l",next:"btn-roR r",horizontal:""},b={$starmod:a("#starmod"),catTabSize:c[e.currentBodyClassName]||4,curIndex:0,curStarData:null,renderType:"star",config:{ids:null,bs64sids:null,isMJ:0,isLoadZbqd:null,isLoadSimilar:!1},init:function(t){var e=this;e.config=a.extend({},e.config,t),e.$starmod.html(r.render(i.role_layout,e.config)),e.$roleTabBox=e.$starmod.find(".role-tabDiv"),e.$roleWorkBox=e.$starmod.find(".role-tab-cnt"),e.initPingback(),e.initZbpd(),e.setCurIndex(0);var s;s=e.config.isLoadSimilar?e.loadSimilarData():e.config.isLoadZbqd?e.loadZbqdData():e.loadData(),s.then(function(){e.$starmod.show()}),e.bindEvent()},initPingback:function(){var a=this;a.$starmod.attr("pb-impress","").attr("data-pb-txid","pg_star").attr("data-pb-other",a.config.ids)},initZbpd:function(){var t=this;if(t.config.isLoadZbqd){var r=e.playlistId,i=sohuHD.baseInfo.videoList.albums||[],s=a.grep(i,function(a){return a.playlistid!=r});t.zbqd={cats:s}}},setCurIndex:function(a){var t=this;t.config.ids[a]&&(t.curIndex=a)},setIndexByStarId:function(a){var t=this,e=t.config.ids.indexOf(a);-1!=e&&t.setCurIndex(e)},getCurStarId:function(){var a=this;return a.config.ids[a.curIndex]},getCurBs64StarId:function(){var a=this;return a.config.bs64sids[a.curIndex]},getVstarData:function(){var t=this,e=t.getCurStarId(),r=a.grep(u,function(a){return a.starId==e});return r[0]},loadBaseData:function(){var t=this,e=t.getCurBs64StarId(),r=n.loadPlayStar({starIds:t.config.bs64sids.join(","),starId:e,ismg:t.config.isMJ}),i=n.loadVStar({starids:t.config.ids.join(",")});return a.when(r,i)},loadData:function(a){var t=this;return a=a||!1,v?void 0:(v=!0,t.loadBaseData().then(function(e,r){v=!1,t.makeData(),a||t.renderRoleTab(),t.renderRoleWork()}))},loadSimilarData:function(){var t=this;if(!v){v=!0;var e=n.loadSimilar(),r=t.loadBaseData();return a.when(r,e).then(function(a,e){v=!1,t.makeData(),t.renderRoleTab();var r=h.similar.data;r&&r.length?t.renderSimilar():(t.$starmod.find(".same-tab").remove(),t.$starmod.find(".role-tab").addClass("role-tab-other"),t.renderRoleWork())})}},loadZbqdData:function(){var t=this;if(!v){v=!0;var e=t.zbqd.cats||[],r=m.catId||(e.length?e[0].playlistid:""),i=n.loadZbqd({playlistid:r}),s=t.loadBaseData();return a.when(s,i).then(function(a,e){v=!1,t.makeData(),t.renderRoleTab(),t.renderZbqd()})}},makeData:function(){var t=this,e=t.getCurBs64StarId(),r=t.getCurStarId();if(h[e]&&u){var i=h[e].data;a.each(i,function(e,i){i.vstarInfo=a.grep(u,function(a){return i.id==a.starId})[0],r==i.id&&(t.curStarData=i)}),t.setStarsPageParam({total:i.length})}},setStarsPageParam:function(t){d=a.extend({},d,t)},setWorksPageParam:function(t){m=a.extend({},m,t)},getStarList:function(){var a=this,t=a.getCurBs64StarId(),e=h[t],r=[],i=d;return e&&(r=e.data.slice(i.pIndex*i.pSize,i.pIndex*i.pSize+i.pSize)),r},getWorkList:function(){var t=this,e=t.getCurStarId(),r=t.getCurBs64StarId(),i=h[r],s=a.grep(i.data,function(a){return a.id==e})[0];if(s){var n=o.getStarDataCats(s),l=m.catId||n[0].cid,d=o.getStarDataWorks(s,l);t.setWorksPageParam({total:d.length});var c=m,p=c.pIndex*c.pSize,u=p+c.pSize;0!=p&&u>c.total&&(u=c.total,p=u-c.pSize),s.attach={cats:n,total:d.length,works:d.slice(p,u),sid:s.id,starId:s.bs64sid,catId:l,pIndex:c.pIndex,pSize:c.pSize}}return s},renderRoleTab:function(){var a=this,t=a.getStarList();t.length&&a.$roleTabBox.html(r.render(i.role_item,{data:t,starsPageParam:d,curStarId:a.getCurStarId()}))},renderRoleWork:function(){var a=this;a.renderType="star";var t=a.getWorkList();a.$roleWorkBox.html(r.render(i.role_work,t)),a.initRoleWorkPagination(a.$roleWorkBox)},renderVstarDetail:function(){var a=this,t=a.getCurStarId();n.loadVStarDetail(t).then(function(e){200==e.status&&(e.message.starId=t,e.message.star=a.curStarData,a.$roleWorkBox.find(".role-tcont").html(r.render(i.vstar_detail,e.message)))})},initRoleWorkPagination:function(a){var t=this,e=a.find("div[data-pagination]");if(0!==e.length){var r=e.attr("data-pagination").split("|"),i=function(a){var r=e.attr("data-args"),i=o.parsePrams(r);i.pIndex=parseInt(a,10)-1,t.setWorksPageParam({catId:i.catId,pIndex:i.pIndex}),"similar"==i.starId?t.renderSimilar():"zbqd"==i.starId?t.renderZbqd():t.renderRoleWork(),messagebus.publish("statV2.ping",{url:"mc",type:"click",txid:e.data("pb-txid"),other:e.data("pb-other")})};new sohuHD.Pagination({id:"star_point_container",total:parseInt(r[0],10),current:parseInt(r[1],10)+1,shownFirstLast:!0,type:"horizontal",len:0,classname:f,handle:i}).init()}},renderSimilar:function(){var t=this,e=h.similar.data;if(e&&e.length){t.renderType="similar",t.$roleTabBox.find("li").removeClass("on");var s=m.catId||e[0].tabId,n=a.grep(e,function(a){return a.tabId==s})[0].tab_data;t.setWorksPageParam({total:n.length});var o=m,l=o.pIndex*o.pSize,d=l+o.pSize;0!=l&&d>o.total&&(d=o.total,l=d-o.pSize);var c={cats:e.slice(0,t.catTabSize),total:n.length,works:n.slice(l,d),catId:s,pIndex:o.pIndex,pSize:o.pSize};t.$roleWorkBox.html(r.render(i.similar_work,{attach:c})),t.initRoleWorkPagination(t.$roleWorkBox)}},renderZbqd:function(){var a=this;a.renderType="zbqd",a.$roleTabBox.find("li").removeClass("on");var t=a.zbqd.cats||[];t=t.slice(0,a.catTabSize);var e=m.catId||(t.length?t[0].playlistid:"");n.loadZbqd({playlistid:e}).then(function(s){if(s){var n=s.videos;a.setWorksPageParam({total:n.length});var o=m,l=o.pIndex*o.pSize,d=l+o.pSize;0!=l&&d>o.total&&(d=o.total,l=d-o.pSize),a.$roleWorkBox.html(r.render(i.zbqd_work,{cats:t,videos:n.slice(l,d),curplid:e,total:n.length,pIndex:o.pIndex,pSize:o.pSize})),a.initRoleWorkPagination(a.$roleWorkBox)}})},bindEvent:function(){var t=this;t.$starmod.on("click",".role-tab-btn",function(e){var r=a(this),i=~~r.attr("data-pindex"),s=~~r.attr("data-ptotal");0>i||s==i||(t.setStarsPageParam({pIndex:i}),t.renderRoleTab(),"star"!=t.renderType&&t.$roleTabBox.find("li").removeClass("on"))}).on("hover","[star_hover_action]",function(){var e=a(this);if(e.toggleClass("roles-hover"),!e.hasClass("on")&&!v){t.$starmod.find(".same-tab, .zbqd-tab").removeClass("on"),e.siblings().removeClass("on"),e.addClass("on"),t.setWorksPageParam({catId:null,pIndex:0});var r=~~e.attr("data-starid");t.setIndexByStarId(r),t.loadData(!0)}}).on("hover",".same-tab",function(){var e=a(this);e.hasClass("on")||v||(t.$roleTabBox.find("li").removeClass("on"),e.addClass("on"),t.setWorksPageParam({catId:null,pIndex:0}),t.renderSimilar())}).on("hover",".zbqd-tab",function(){var e=a(this);e.hasClass("on")||v||(t.$roleTabBox.find("li").removeClass("on"),e.addClass("on"),t.setWorksPageParam({catId:null,pIndex:0}),t.renderZbqd())}).on("click","[star_click_action]",function(){var e=a(this);if(!e.hasClass("on")&&!v){var r=o.parsePrams(e.attr("star_click_action"));e.siblings().removeClass("on"),e.addClass("on"),t.setWorksPageParam({catId:r.catId,pIndex:0}),"similar"==r.starId?t.renderSimilar():"zbqd"==r.starId?t.renderZbqd():"vstar"==r.catId?t.renderVstarDetail():t.renderRoleWork()}}),t.$starmod.on("mouseenter",".role-vstarinfo",function(){var e=a(this);if(!e.hasClass("btn-love-ed")){var r=t.getVstarData();r&&(r.follow||e.addClass("role-vstarinfo-hover"))}}).on("mouseleave",".role-vstarinfo",function(){var e=a(this);if(!e.hasClass("btn-love-ed")){var r=t.getVstarData();r&&(r.follow||e.removeClass("role-vstarinfo-hover"))}}).on("click",".role-vstarinfo .btn-attent",function(){var e=a(this);if(!e.hasClass("btn-attent-ed")){var r=t.getVstarData();r&&(sohuHD.passport.getPassport()?n.follow(r.starId).then(function(a){r.follow=!0,e.html("\u5df2\u5173\u6ce8").addClass("btn-attent-ed"),e.closest(".role-vstarinfo").removeClass("role-vstarinfo-hover");var t=e.closest(".role-vstarinfo");t.find(".btn-love").trigger("click")}):sohuHD.showLoginWinbox(function(){u&&(u=null,t.loadData())}))}}).on("click",".role-vstarinfo .btn-love",function(e){var r=a(this);if(!r.hasClass("btn-love-ed")){var i=t.getVstarData();i&&n.sign(i.starId).then(function(a){i.isPraise=!0,r.addClass("btn-love-ed");var t=r.find(".btn-love-tips");t.show().animate({top:-22,opacity:sohuHD.isIE?1:0},1e3,function(){t.css({top:-10,opacity:1,display:"none"})})})}}),messagebus.subscribe("play.changed_body_class",function(){if(u){t.catTabSize=c[e.currentBodyClassName];var a=l[e.currentBodyClassName],r=Math.floor(t.curIndex/a);t.setStarsPageParam({pIndex:r,pSize:a}),t.renderRoleTab(),t.setWorksPageParam({pIndex:0,pSize:p[e.currentBodyClassName]}),"similar"==t.renderType?t.renderSimilar():"zbqd"==t.renderType?t.renderZbqd():"vstar"==m.catId||t.renderRoleWork()}},null,null,{cache:!1})}};sohuHD.starmodInit=function(a){b.init(a)}}(jQuery,sohuHD,window);