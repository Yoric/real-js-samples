function DivSelect(a,b,c){this.id=a;this.divId=b;this.divClassName=c||"selectView";this.ele=this.$(this.id);if(!this.ele)return;var d=this;this.status="close";this.parentObj=this.ele.parentNode;while(this.readStyle(this.parentObj,"display")!="block"){if(!this.parentObj.parentNode)break;this.parentObj=this.parentObj.parentNode}this.parentObj.style.position="relative";var e=this.absPosition(this.ele,this.parentObj);this.ele.style.visibility="hidden";this.__div=document.createElement("div");b&&(this.__div.id=b);this.divClassName&&(this.__div.className=this.divClassName);this.parentObj.appendChild(this.__div);this.__div.style.width=this.ele.offsetWidth+"px";this.__div.style.position="absolute";this.__div.style.left=e.left+"px";this.__div.style.top=e.top+"px";this.__div.onclick=function(){d.click()};this.__div_count=document.createElement("div");this.__div.appendChild(this.__div_count);this.__div_count.className="ds_cont";this.__div_title=document.createElement("div");this.__div_count.appendChild(this.__div_title);this.__div_title.className="ds_title";this.__div_button=document.createElement("div");this.__div_count.appendChild(this.__div_button);this.__div_button.className="ds_button";this.__div_list=document.createElement("div");this.__div.appendChild(this.__div_list);this.__div_list.className="ds_list";this.__div_list.style.display="none";this.__div_listCont=document.createElement("div");this.__div_list.appendChild(this.__div_listCont);this.__div_listCont.className="dsl_cont";this.list=[];var f;for(var g=0;g<this.ele.options.length;g++){f=document.createElement("p");this.list.push(f);this.__div_listCont.appendChild(f);f.innerHTML=this.ele.options[g].innerHTML;this.ele.selectedIndex==g&&(this.__div_title.innerHTML=f.innerHTML);f.num=g;f.onmouseover=function(){d.showSelectIndex(this.num)};f.onclick=function(){d.select(this.innerHTML)}}}DivSelect.prototype={showSelectIndex:function(a){typeof a=="undefined"&&(a=this.ele.selectedIndex);typeof this.showIndex!="undefined"&&(this.list[this.showIndex].className="");this.showIndex=a;this.list[this.showIndex].className="selected"},select:function(a){for(var b=0;b<this.ele.options.length;b++)if(this.ele.options[b].innerHTML==a){this.ele.selectedIndex=b;this.ele.onchange&&this.ele.onchange();this.__div_title.innerHTML=a;break}},setIndex:function(a){if(a<0||a>=this.list.length)return;this.ele.selectedIndex=a;this.ele.onchange&&this.ele.onchange();this.__div_title.innerHTML=this.list[a].innerHTML},clickClose:function(a){var b=a.target?a.target:event.srcElement,c=this;do{if(b==c.__div)return;if(b.tagName=="BODY")break;b=b.parentNode}while(b.parentNode);c.close()},keyDown:function(a){var b=this.showIndex;if(a.keyCode==38){b--;b<0&&(b=this.list.length-1);this.showSelectIndex(b);this.stopDefault(a)}if(a.keyCode==40){b++;b>=this.list.length&&(b=0);this.showSelectIndex(b);this.stopDefault(a)}if(a.keyCode==13||a.keyCode==9){this.setIndex(b);this.stopDefault(a);this.close()}a.keyCode==27&&this.close()},open:function(){var a=this;this.showSelectIndex();this.__div_list.style.display="block";this.status="open";this.__closeFn=function(b){a.clickClose(b)};this.__keyFn=function(b){a.keyDown(b)};this.addEvent(document,"click",this.__closeFn);this.addEvent(document,"keydown",this.__keyFn)},close:function(){var a=this;this.__div_list.style.display="none";this.status="close";this.delEvent(document,"click",this.__closeFn);this.delEvent(document,"keydown",this.__keyFn)},click:function(){this.status=="open"?this.close():this.open()},$:function(objName){return document.getElementById?eval('document.getElementById("'+objName+'")'):eval("document.all."+objName)},addEvent:function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},delEvent:function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)},readStyle:function(a,b){if(a.style[b])return a.style[b];if(a.currentStyle)return a.currentStyle[b];if(document.defaultView&&document.defaultView.getComputedStyle){var c=document.defaultView.getComputedStyle(a,null);return c.getPropertyValue(b)}return null},absPosition:function(a,b){var c=a.offsetLeft,d=a.offsetTop,e=a.offsetParent,f="";try{while(e.id!=document.body&&e.id!=document.documentElement&&e!=b&&e!=null){f+=e.tagName+" , ";e=e.offsetParent;c+=e.offsetLeft;d+=e.offsetTop}}catch(g){}return{left:c,top:d}},stopDefault:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1}};
