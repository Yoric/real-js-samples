(window.webpackJsonp=window.webpackJsonp||[]).push([["37d6fe1fee6fb6accf5867cbca2cda9c"],{"1y80":function(e,t,n){"use strict";function r(e,t,n,r,i){return window.statlogsValueEvent(e,t,n,r,i)}function i(e){return Math.random()<e}function a(e,t,n,a,o,u){i(e)&&r(t,n,a,o,u)}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return a})},"86+7":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return o});var r=n("aong");function i(e,t){return t in Object(r.r)(e).oCache}function a(e,t){var n=Object(r.r)(e).oCache[t];return n&&!n._n&&(!function(e){if(!e.first_name){var t=e.name.split(" ",2);e.first_name=t[0],e.short_name=t[1]?t[0]+" "+t[1].substr(0,1)+".":t[0]}e.inv_name||(e.inv_name=e.name),e.kick_name||(e.kick_name=e.inv_name)}(n),n._n=1),n}function o(e,t){var n=Object(r.r)(e);n.oCache||(n.oCache={}),t.id&&(n.oCache[t.id]=t)}},BxOC:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var r=window.ajax,i=2;function a(e,t,n){return t&&(t.im_v=i),new Promise(function(i,a){r.post(e,t,{timeout:n,onDone:function(){i.apply(null,[[].concat(Array.prototype.slice.call(arguments))])},onFail:function(){return a.apply(null,arguments),!0}})})}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=void 0;return i=window.XDomainRequest?new XDomainRequest:r._getreq(),{request:new Promise(function(r,a){var o=void 0,u=Date.now(),c=n.timeout||60,s=ajx2q(t);if(window.XDomainRequest)i.open("get",e+"?"+s),i.ontimeout=function(e){a([e,{}])},i.onerror=function(e){a([e,{}])},i.onload=function(){r([i.responseText,{}])},setTimeout(function(){i.send()},0);else{i.onreadystatechange=function(){4==i.readyState&&(clearInterval(o),i.status>=200&&i.status<300?r([i.responseText,i]):a([i.responseText,i]))};try{i.open("GET",e+"?"+s,!0)}catch(e){return a([e,i])}i.send()}o=setInterval(function(){Date.now()-u>1e3*c&&(a(["",{}]),clearInterval(o))},1e3)}),cancel:function(){i.abort()}}}},DM26:function(e,t,n){"use strict";function r(e,t){return new Promise(function(n){setTimeout(n.bind(null,t),1e3*e)})}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=0;return function a(){for(var o=arguments.length,u=Array(o),c=0;c<o;c++)u[c]=arguments[c];return Promise.resolve().then(function(){return e.apply(void 0,u)}).catch(function(e){if(++i<=t){var o="function"==typeof n?n(i):0;return 0===o?a.apply(void 0,u):r(o).then(function(){return a.apply(void 0,u)})}throw e})}}function a(e,t,n){var r=void 0,i=void 0;return function(){for(var a=arguments.length,o=Array(a),u=0;u<a;u++)o[u]=arguments[u];return new Promise(function(e,a){var u=n&&!r;clearTimeout(r),i&&i.reject("debounce"),r=setTimeout(function(){r=null,i=null,n||e(o)},t),u?e(o):n&&a("debounce"),i={resolve:e,reject:a}}).then(function(t){return e.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t))})}}function o(e,t){var n=void 0,r=new Promise(function(r){n=r,setTimeout(r.bind(null,t),1e3*e)});return{pause:function(){return r},abort:function(){n(t)}}}function u(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return new Promise(function(t){return e.apply(void 0,n.concat([t]))})}}n.d(t,"c",function(){return r}),n.d(t,"e",function(){return i}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"d",function(){return u})},ERyv:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return m});var r=n("BxOC"),i=n("DM26"),a=void 0,o=1;function u(e,t,n,r,i){if("Script error."!==e){var o=i?i.stack||i.message:null;d("unhandled_error",o?{err:e,stack:o}:{err:e})}a&&a.apply(this,arguments)}function c(e){e.preventDefault()}function s(){return!!window.imwl}function d(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];s()&&(n&&window.console&&(console.error(e,t),console.trace&&console.trace()),Object(i.e)(r.b,3,function(){return 2})("al_im.php",{act:"a_weird_log",kind:e,data:JSON.stringify(extend({errIdx:o++,ua:navigator.userAgent},t))}))}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return d(e,extend({err:t&&t.message||t},n)),Promise.reject(t)}function f(){a=window.onerror,window.onerror=u,window.addEventListener("unhandledrejection",c)}function m(){window.onerror=a,a=void 0,window.removeEventListener("unhandledrejection",c)}},MhhX:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"l",function(){return o}),n.d(t,"e",function(){return u}),n.d(t,"k",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"g",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"m",function(){return m}),n.d(t,"f",function(){return b}),n.d(t,"i",function(){return _}),n.d(t,"j",function(){return h}),n.d(t,"o",function(){return p}),n.d(t,"h",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return y}),n.d(t,"p",function(){return j});var r=n("f01n"),i=n("aong");function a(e,t){return"number"!=typeof t.messageId||(c(t)?t.messageId>e.out_up_to:t.messageId>e.in_up_to)}function o(e){return e.kludges&&void 0!==e.kludges.source_act}function u(e){return"call"==e.kludges.attach1_type}function c(e){return e.flags&r.m}function s(e){var t=e.attaches.filter(function(e){return"mail"===e.type}).length>0;return e.attaches.filter(function(e){return"reply"===e.type}).length>0||e.flags&r.k&&t}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.attaches[0];return r&&(r.type===t||r.type===n)}function l(e){return d(e,"doc")&&"graffiti"===e.attaches[0].kind}function f(e){return Boolean(e.attaches.find(function(e){return"doc"===e.type&&"audiomsg"===e.kind}))}function m(e){return Boolean(e.attaches.find(function(e){return"sticker"===e.type}))}function b(e){return d(e,"gift")}function _(e){return d(e,"money_transfer","money_request")}function h(e){return d(e,"money_request")}function p(e){return d(e,"link","vkpay")&&6217559==e.kludges.attach1_app_id}function g(e){return e.flags&r.l}function v(e){return c(e)?vk.id:e.userId}function y(e,t){var n=Object(i.r)(e);return c(t)?n.id:t.userId}function j(e){return e.update_time>0}},N1NS:function(e,t,n){"use strict";var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=new window.Map;function a(e){var t=i.get(e.currentTarget);if(t){var n=t[e.type];if(n)for(var a=void 0,o=0;o<n.length;o++){var u=r(n[o],2),c=u[0],s=u[1],d=void 0;if(hasClass(e.target,c)?d=s(e,e.target):(a=gpeByClass(c,e.target,e.currentTarget))&&(d=s(e,a)),!1===d)break}}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}n.d(t,"b",function(){return d}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return m});var u=window,c=u.addEvent,s=u.removeEvent;function d(e){return{callMutations:function(){if("function"==typeof e)throw console.trace(),new Error("Mutations are not initialized");return e},bindMutations:function(){if("function"!=typeof e)throw console.trace(),new Error("Mutations are already initialized");return e=e.apply(void 0,arguments)}}}function l(e,t,n,r,o){!function(e,t,n,r){var o=i.get(e);o||(i.set(e,{}),o=i.get(e));for(var u=t.split(" "),c=0;c<u.length;c++){var s=u[c];o[s]||(o[s]=[],addEvent(e,s,a)),o[s].push([n,r])}}(t,n,r,o),e._registeredHandlers.push(["delegate",t,n,r,o])}function f(e){var t={_registeredHandlers:[]};return e.handlers(function(e,t,n,r){c(t,n,r),e._registeredHandlers.push(["bind",t,n,r])}.bind(null,t),l.bind(null,t)),t}function m(e){e._registeredHandlers.forEach(function(e){var t=e.slice(1);"delegate"===e[0]?function(e,t,n,r){var o=i.get(e);o&&(t.split(" ").forEach(function(t){o[t]&&(o[t]=o[t].filter(function(e){return e[0]!==n||e[1]!==r}),0===o[t].length&&removeEvent(e,t,a))}),0===Object.keys(o).map(function(e){return o[e].length}).reduce(function(e,t){return e+t})&&i.delete(e))}.apply(void 0,o(t)):s.apply(void 0,o(t))}),e._registeredHandlers=[]}},O8ze:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"g",function(){return u}),n.d(t,"d",function(){return c}),n.d(t,"f",function(){return s}),n.d(t,"k",function(){return l}),n.d(t,"m",function(){return f}),n.d(t,"l",function(){return m}),n.d(t,"h",function(){return b}),n.d(t,"i",function(){return h}),n.d(t,"j",function(){return p}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return y});var r=n("1y80"),i=n("aong"),a={};function o(e){Object(r.b)(.1,"im_forward_stat",d(e),!!e.get().gid)}function u(e,t){Object(r.b)(.1,"im_forward_from_community_stat",d(e),!!e.get().gid,+t)}function c(){Object(r.b)(1,"im_apply_community_template_stat",1)}function s(){Object(r.b)(1,"messages_channel_forward_click",1)}function d(e){var t=e.get().pendingForward;return+(t&&t.msgIds&&t.msgIds.length)}function l(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!Object(r.a)(1))return function(){};var a=+new Date,o=_(e);return function(){var e=+new Date-a;Object(r.c)("messages_send_time_web",e,t,n,o,i)}}function f(e,t,n,r){if(t.messageId&&-1!==String(t.messageId).indexOf("rid")){var i=[t.messageId.replace("rid",""),n,r].join("_"),o=t.attaches.length>0;a[i]=l(e,n,r,o)}}function m(e,t,n,r){var i=[t.randomId,n,r].join("_"),o=a[i];o&&(o(),delete a[i])}function b(e,t,n,i){var a=_(e),o=""===t?"network":"unknown";Object(r.a)(1)&&Object(r.c)("messages_send_errors_web",o,n,i,a)}function _(e){var t=Object(i.r)(e);return Boolean(t.longpoll&&t.longpoll.isEnabled&&t.longpoll.isEnabled())}function h(e){var t=Object(i.r)(e),n=t.imQueue(t.peer).length;Object(r.a)(1)&&Object(r.c)("messages_send_queue_size",n)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";Object(r.a)(1)&&Object(r.c)("messages_send_retry",1,t,e)}function g(){var e="im_browser_notifications_users";ls.get(e)||ls.get("im_ui_notify_off")||(ls.set(e,1),Object(r.c)(e,1))}function v(){Object(r.b)(1,"im_browser_notifications_on",1)}function y(){Object(r.b)(1,"im_browser_notifications_off",1)}},P13b:function(e,t,n){"use strict";var r=n("f01n"),i=n("h++7"),a=n("nyd8"),o=n("rHUl"),u=n("MhhX"),c=n("p3re"),s=n("eTng"),d=n("vT4u"),l=n("N1NS"),f=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m="_im_join_chat";function b(e,t){var n=Object(l.a)({handlers:function(n,i){i(e,"click",m,function(e){return function(e,t){var n=domData(t,"chat-id"),i=domData(t,"hash");return lockButton(t),Object(d.Z)(n,i,e.get()).then(function(n){var i=f(n,1)[0];unlockButton(t),e.get().longpoll.push([Object(r.bb)(i)])}).catch(function(e){showFastBox(getLang("mail_join_invite_error_title"),e),unlockButton(t)})}(t,e.target)})}});return{unmount:function(){Object(l.c)(n)}}}var _=n("aong"),h=n("86+7"),p=n("Wu9C"),g=n("wSs/"),v=n("ERyv"),y=n("lJdi"),j=n("t7n3");n.d(t,"t",function(){return I}),n.d(t,"l",function(){return x}),n.d(t,"s",function(){return T}),n.d(t,"v",function(){return D}),n.d(t,"j",function(){return A}),n.d(t,"g",function(){return S}),n.d(t,"b",function(){return E}),n.d(t,"c",function(){return C}),n.d(t,"e",function(){return z}),n.d(t,"d",function(){return q}),n.d(t,"f",function(){return M}),n.d(t,"h",function(){return N}),n.d(t,"a",function(){return B}),n.d(t,"k",function(){return H}),n.d(t,"o",function(){return L}),n.d(t,"m",function(){return F}),n.d(t,"n",function(){return R}),n.d(t,"p",function(){return U}),n.d(t,"i",function(){return J}),n.d(t,"u",function(){return Q}),n.d(t,"q",function(){return Z}),n.d(t,"r",function(){return K}),n.d(t,"U",function(){return Ve}),n.d(t,"jc",function(){return Xe}),n.d(t,"L",function(){return We}),n.d(t,"y",function(){return $e}),n.d(t,"G",function(){return Ge}),n.d(t,"fb",function(){return et}),n.d(t,"ec",function(){return tt}),n.d(t,"Gb",function(){return nt}),n.d(t,"Q",function(){return rt}),n.d(t,"I",function(){return at}),n.d(t,"Jc",function(){return ot}),n.d(t,"J",function(){return ut}),n.d(t,"Vb",function(){return st}),n.d(t,"K",function(){return dt}),n.d(t,"x",function(){return ft}),n.d(t,"hc",function(){return mt}),n.d(t,"Jb",function(){return bt}),n.d(t,"dc",function(){return _t}),n.d(t,"lb",function(){return ht}),n.d(t,"ub",function(){return pt}),n.d(t,"pb",function(){return gt}),n.d(t,"Bb",function(){return vt}),n.d(t,"Cb",function(){return yt}),n.d(t,"H",function(){return It}),n.d(t,"Hc",function(){return xt}),n.d(t,"Bc",function(){return Pt}),n.d(t,"D",function(){return Tt}),n.d(t,"Xb",function(){return Et}),n.d(t,"Qb",function(){return Ct}),n.d(t,"Wb",function(){return zt}),n.d(t,"Sb",function(){return qt}),n.d(t,"Zb",function(){return Mt}),n.d(t,"Rb",function(){return Nt}),n.d(t,"ac",function(){return Bt}),n.d(t,"kc",function(){return Ht}),n.d(t,"Dc",function(){return Lt}),n.d(t,"Mb",function(){return Ft}),n.d(t,"Ob",function(){return Ut}),n.d(t,"Nb",function(){return Jt}),n.d(t,"gc",function(){return Qt}),n.d(t,"O",function(){return Zt}),n.d(t,"Hb",function(){return Kt}),n.d(t,"Tb",function(){return Xt}),n.d(t,"ic",function(){return Wt}),n.d(t,"bc",function(){return $t}),n.d(t,"w",function(){return Gt}),n.d(t,"fc",function(){return Yt}),n.d(t,"Ab",function(){return en}),n.d(t,"zc",function(){return tn}),n.d(t,"Lc",function(){return nn}),n.d(t,"Ec",function(){return rn}),n.d(t,"E",function(){return an}),n.d(t,"Ub",function(){return on}),n.d(t,"pc",function(){return un}),n.d(t,"rc",function(){return cn}),n.d(t,"xc",function(){return sn}),n.d(t,"tc",function(){return dn}),n.d(t,"F",function(){return ln}),n.d(t,"eb",function(){return fn}),n.d(t,"Gc",function(){return mn}),n.d(t,"yc",function(){return bn}),n.d(t,"C",function(){return _n}),n.d(t,"qb",function(){return hn}),n.d(t,"Db",function(){return pn}),n.d(t,"vb",function(){return gn}),n.d(t,"xb",function(){return vn}),n.d(t,"wb",function(){return yn}),n.d(t,"z",function(){return jn}),n.d(t,"wc",function(){return kn}),n.d(t,"W",function(){return On}),n.d(t,"V",function(){return wn}),n.d(t,"mc",function(){return xn}),n.d(t,"lc",function(){return Pn}),n.d(t,"S",function(){return Tn}),n.d(t,"oc",function(){return Dn}),n.d(t,"mb",function(){return An}),n.d(t,"Kc",function(){return Sn}),n.d(t,"Pb",function(){return En}),n.d(t,"tb",function(){return Cn}),n.d(t,"cb",function(){return zn}),n.d(t,"ab",function(){return qn}),n.d(t,"bb",function(){return Mn}),n.d(t,"db",function(){return Nn}),n.d(t,"cc",function(){return Bn}),n.d(t,"Ib",function(){return Ln}),n.d(t,"Ic",function(){return Fn}),n.d(t,"Yb",function(){return Rn}),n.d(t,"sc",function(){return Un}),n.d(t,"nc",function(){return Jn}),n.d(t,"Y",function(){return Qn}),n.d(t,"A",function(){return Zn}),n.d(t,"uc",function(){return Kn}),n.d(t,"vc",function(){return Vn}),n.d(t,"Eb",function(){return Xn}),n.d(t,"P",function(){return Wn}),n.d(t,"Kb",function(){return $n}),n.d(t,"Lb",function(){return Gn}),n.d(t,"Cc",function(){return Yn}),n.d(t,"sb",function(){return er}),n.d(t,"qc",function(){return tr}),n.d(t,"Ac",function(){return nr}),n.d(t,"B",function(){return rr}),n.d(t,"T",function(){return ir}),n.d(t,"N",function(){return ar}),n.d(t,"M",function(){return or}),n.d(t,"X",function(){return ur}),n.d(t,"Z",function(){return o.t}),n.d(t,"ib",function(){return o.z}),n.d(t,"rb",function(){return o.G}),n.d(t,"nb",function(){return o.D}),n.d(t,"jb",function(){return o.B}),n.d(t,"R",function(){return o.e}),n.d(t,"zb",function(){return o.I}),n.d(t,"ob",function(){return o.E}),n.d(t,"kb",function(){return o.C}),n.d(t,"gb",function(){return o.x}),n.d(t,"Fc",function(){return o.Q}),n.d(t,"hb",function(){return s.b}),n.d(t,"Fb",function(){return s.d}),n.d(t,"yb",function(){return s.c});var k=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I="_im_mess_sending",x="_im_mess_failed",P="_im_mess_original",T="_im_mess_restore",D="_im_typing",A="chat_create",S="chat_title_update",E="chat_invite_user",C="chat_kick_user",z="chat_photo_update",q="chat_photo_remove",M="chat_pin_message",N="chat_unpin_message",B="chat_invite_user_by_link",H="_im_deselect_all",L="_im_top_notice_hide",F="_im_aside_notice_hide",R="_im_aside_promo_block_hide",U="_im_vkadmin_promo_link",J="_im_clear_recent",Q="_im_toggle_mr_tab",Z="_im_mess_search",K="_im_pinned",V=window,X=V.vk,W=V.ls,$=V.se,G=V.re,Y=V.rs,ee=V.sech,te=V.inArray,ne=V.intval,re=V.trim,ie=V.stripHTML,ae=V.domFC,oe=V.domPS,ue=V.domLC,ce=V.domChildren,se=V.domClosestSibling,de=V.domData,le=V.geByClass,fe=V.geByClass1,me=V.gpeByClass,be=V.addClass,_e=V.removeClass,he=V.toggleClass,pe=V.hasClass,ge=V.attr,ve=V.setStyle,ye=V.val,je=V.getTemplate,ke=V.getLang,Oe=V.langSex,we=V.langDate,Ie=V.langNumeric,xe=V.getDateText,Pe=V.getSmDate,Te=V.getShortDate,De=V.isSameDate,Ae=V.isToday,Se=V.ajax,Ee=V.showBox,Ce=V.showFastBox,ze=V.showTabbedBox,qe=V.showTooltip,Me=V.mobPlatforms,Ne=V.onlinePlatformClass,Be=V.AudioMessagePlayer,He=V.Emoji,Le=V.slideUp,Fe=V.fadeOut,Re=V.cancelEvent,Ue=4096,Je=100,Qe=8,Ze=52,Ke="chatPosition";function Ve(){return W.get(Ke)||0}function Xe(e){e>=window.clientHeight()-30&&(e=0),W.set(Ke,e)}function We(e,t){var n=fe(e,t);n.firstElementChild.offsetHeight!==n.parentNode.offsetHeight&&ve(n.firstElementChild,{height:n.parentNode.offsetHeight})}function $e(e,t){e&&e.innerHTML!==t&&(e.innerHTML=t)}function Ge(e,t,n,r){var i=t&&!n?1:!t&&n?-1:0;i&&!Object(o.z)(e)&&r().compensateHistoryHeightChange(i)}function Ye(e,t,n,r){var i=window.devicePixelRatio>=2?"256":"128",a="animation"===n,o="im_gift";a&&(o+=" sticker_img");var u='<img height="128" class="'+o+'" src="'+Stickers.getStickerUrl(ne(e),i)+'"/>';if(a){var c="animatedSticker"+r;u='<div id="'+c+'" data-loop-count=3 data-animation-path="'+("/stickers.php?act=proxy_animation&product_id="+t+"&sticker_id="+e)+'" onmouseenter="StickersAnimation.loadAndPlaySticker(this);"\n     data-uniq-id="'+r+'" data-sticker-id="'+ne(e)+'" class="sticker_animation sticker_animation_128 im_gift">'+u+"</div>";var s=!1;browser.msie?(0^r)===r&&(s=!0):s=Number.isInteger(r),s&&window.StickersSettings.getAutoplay()&&window.StickersAnimation&&window.StickersAnimation.loadAndPlayStickerWithTimer(c,10)}return t&&(u='<a onmouseover="return Emoji.stickerOver('+ne(e)+', this);"\n        onclick="return Emoji.clickSticker('+ne(t)+', this, event);">'+u+"</a>"),u='<div class="im_sticker_row">'+u+"</div>"}function et(e,t,n){var r=e.get?e.get():e;if(vt(r,t)){var i=r.tabs[t].deleted||[];return te(n,i)}return!1}function tt(e,t,n){var r=n.randomId,i=fe("_im_mess_rid"+r,t);return i&&(t=ft(e,n,t=Rt([i],t),!0,!1)),t}function nt(e){var t=Object(o.a)(e);return browser.mobile&&browser.safari?Promise.resolve(!1):void 0!==t?Promise.resolve(t):rt().then(function(e){return e.length>0}).catch(function(e){return!1})}function rt(){return window.AudioContext&&navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(function(e){for(var t=[],n=0;n<e.length;n++)"audioinput"==e[n].kind&&t.push(e[n]);return t}):Promise.reject(new Error("NotSupported"))}function it(e){return je("im_preloader",{preloader:Y(X.pr_tpl,{id:""}),cls:"im-preloader_attach im-preloader_visible im-preloader_"+e})}function at(e){var t=e.split(".");return(t[0]<10?"0":"")+t[0]+(t[1]<10?"0":"")+t[1]+t[2]}function ot(e,t,n){var r=de(n,"msgid"),i=fe("_im_mess_"+r,t),a=n.cloneNode(!0);return i&&(i.parentNode.replaceChild(a,i),dt(t)),t}function ut(e,t,n){var r=ct(e,t),i=fe("_im_mess_"+t.messageId,n);return i&&(i.parentNode.replaceChild($(r),i),dt(n)),n}function ct(e,t){var n=["_im_mess"],r=Object(u.n)(e.tabs[t.peerId],t),i=Object(u.c)(t)?je("im_message_media",{type:"reply",messageId:t.messageId,attaches:it("reply"),text:""}):"";Object(u.k)(t)&&r&&n.push("im-mess_unread _im_mess_unread"),Object(u.k)(t)&&n.push("im-mess_out"),Object(u.p)(t)&&n.push("im-mess_was_edited"),Object(g.a)(e,t)&&n.push("im-mess_editable"),Object(u.h)(t)&&n.push("im-mess_fav"),-1!=(e.selectedMessages||[]).indexOf(t.messageId)&&n.push("im-mess_selected");var a=Date.now()-1e3*t.date>1e3;t.local&&a&&n.push("im-mess_sending"),t.local&&n.push(""+I),t.local&&Object(u.p)(t)&&!r&&n.push("im-mess_unread im-mess_nobg"),t.failed&&n.push("im-mess_failed "+x),Object(u.f)(t)&&n.push("im-mess_gift");var d=st(t),l=function(e,t){var n="",r=Object(_.r)(e).sourceEnabled&&t.kludges&&t.kludges.from_widget&&t.kludges.ref_source;Object(u.p)(t)&&(n+=je("sImLblWasEdited",{update_time:t.update_time}));if(Object(o.B)(e)&&r){var i=t.kludges.ref_source,a={};try{(a=JSON.parse(Object(j.I)(i))).link&&a.info&&(a.link=Object(c.e)(Object(j.c)(a.link),c.b.bind(null,!1)),a=Object(j.c)(langStr(ke("mail_source_info"),"link",a.link,"info",Object(j.c)(a.info))),n+=je("sImLblWasSourceInfo",{source:a}))}catch(e){}}return n}(e,t),f=i+wt(e,t.text,t.kludges,!1,t.peerId);""!=f&&(f+=l),t.subject&&"..."!==t.subject.trim()&&!Object(s.b)(t.peerId)&&(f=je("im_topic",{topic:t.subject})+f);var m=je("im_message_media",{type:"media",messageId:t.messageId,attaches:d.join(""),text:Object(u.f)(t)?'<div class="im-mess--gift-lbl">'+f+"</div>":""});return Object(u.f)(t)||(m=f+m),""==f&&(m+=l),je("im_msg_row",{msg_id:t.messageId,from_id:t.peerId,aria_hidden:t.local&&!t.failed?"true":"false",ts:t.date,marker_params:t.failed?'aria-label="'+ke("mail_send_message_error")+'" role="link"':"",unread_params:r?'aria-label="'+ke("mail_unread_message")+'"':"",cls:n.join(" ")}).replace("%text%",function(){return m})}function st(e){return e.attaches.reduce(function(t,n){return!Object(u.c)(e)||"mail"!==n.type&&"reply"!==n.type?("sticker"===n.type?e.messageId?t.push(Ye(n.id,n.productId,n.kind,e.messageId)):t.push(Ye(n.id,n.productId)):t.push(it(n.type)),t):t},[])}function dt(e){for(var t=e.getElementsByClassName("_im_mess_noa"),n=t.length;n--;)pe(t[n],"im-mess_fwd")||t[n].insertAdjacentHTML("afterbegin",je("sImHistoryRowActions")),_e(t[n],"_im_mess_noa")}function lt(e,t,n){var r,i,a,o,u,c=X.id,s=e.attaches[0],d=s.initiatorId,l=s.state,f=s.receiverId,m=void 0;switch(l){case"reached":m=ke(c===d?"mail_call_outgoing":"mail_call_incoming");var b=t?"":(r=s.duration,i=Math.floor(r/3600),a=Math.floor(r/60)-60*i,o=!1,u=!1,[i,a,r-3600*i-60*a].reduce(function(e,t){return 0!==t||u?(o&&(t=t<10?"0"+t:t),o=!0,u=!0,e+(""!==e?":":"")+t):(u=!0,e)},""));m=m.replace("{duration}",b);break;case"canceled_by_initiator":m=ke(c===d?"mail_call_canceled":"mail_call_missed");break;case"canceled_by_receiver":if(c===d){if(t)return ke("mail_call_declined");var _=Object(h.c)(n,f);return _?Oe(_.sex,ke("mail_call_declined_by","raw")).replace("{user_name}",_.first_name):ke("mail_call_declined")}return ke("mail_call_canceled");default:m=ke("mail_added_call")}return je("im_calls_link",{text:m})}function ft(e,t,n){!(arguments.length>3&&void 0!==arguments[3])||arguments[3];var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=Date.now()-1e3*t.date>1e3,c=e.tabs[t.peerId];if(!n||fe("_im_mess",n)||fe("_im_bar_date",n)||(n.innerHTML=""),c.skipped>0)return n;var d=[];t.local||(d=e.imQueue(t.peerId,r)),d.length>0&&Rt(d.map(function(e){return fe("_im_mess_rid"+e.rid,n)},n).filter(function(e){return e}));var l=ct(e,t),f=ue(n);pe(f,"_im_mess_stack")||(f=se(f,"._im_mess_stack",-1));for(var m=Object(o.k)(e,t.peerId,t.messageId);t.peerId===e.peer&&m&&!fe("_im_mess_"+m.messageId);)m=Object(o.k)(e,t.peerId,m.messageId);var b=fe("_im_unread_bar_row",n),p=Object(u.b)(t),g=m?jt(m.date,e):0;if(!m||kt(c,m,t,e,i)){var v="",y=!1;if(b&&Object(u.k)(t)&&En(e,n,t.peerId),1===c.unread&&!Object(u.k)(t)&&i&&(v+=je("im_mess_bar",{}),y=!0,En(e,n,t.peerId)),!Ae(new Date(g))){var j=new Date,k=y?"im-page--history-new-bar_hide _im_invisible_bar":"";v+=je("im_day_bar",{day:Te(t.date,e.timeshift,!0,ke("months_of","raw"),!0),date:t.date,day_class:j.getDate()+j.getMonth()+j.getFullYear()+" "+k})}if(Object(u.l)(t))v+=je("im_service_row",{text:$t(e,t,c),type:"",date:t.date,from_id:"",message_id:t.messageId});else if(Object(u.e)(t))v+=je("im_service_row",{text:Wt("",lt(t,!1,e),""),type:"",date:t.date,from_id:"",message_id:t.messageId});else{var O=e.gid&&Object(u.k)(t)?ne(t.kludges.from_admin)||-e.gid:0,w=Object(h.c)(e,O?-e.gid:p)||c,x=Object(s.b)(t.peerId)?w.name:w.first_name,P=w.link||c.href,T=je("im_mess_stack_name",{name:x,link:P,class:Object(u.i)(t)?" im-mess-stack--lnk-money-transfer":""});if(Object(u.f)(t)){var D=ke("mail_gift_message_sent","raw");T+=' <span class="im-mess-stack--gift">'+Oe(w.sex||0,D)+"</span>"}if(Object(u.i)(t)){var A=Object(u.j)(t)?ke("mail_money_request_message_sent","raw"):ke("mail_money_tranfer_message_sent","raw");T+=' <span class="im-mess-stack--money-transfer">'+Oe(w.sex||0,A)+"</span>"}var S=e.gid?"/gim"+e.gid:"/im",E=void 0;if(E=t.local?Ot(t.date,e.timeshift):je("im_stack_date",{date:Ot(t.date,e.timeshift),link:S+"?sel="+t.peerId+"&msgid="+t.messageId}),O&&e.admins[O]){var C=e.admins[O],z=O===X.id?ke("mail_by_you"):C[0];E=E+" "+je("im_admin_link",{name:z,href:C[1]})}v+=je("im_mess_stack",{photo:w.photo,href:P,cls:"",date_attr:"",link:"/im?sel="+t.peerId+"&msgid="+t.messageId,name:ie(T),stack_name:T,peerId:p,date:E,messages:l,admin:t.kludges.from_admin||0})}Object(_.p)(ee(v)).forEach(function(e){return n&&n.appendChild(e)})}else b&&e.peer===t.peerId&&!c.inplaceSearch&&Object(u.k)(t)&&En(e,n,t.peerId),fe("_im_stack_messages",f).appendChild($(l));return Object(u.k)(t)&&!a&&setTimeout(function(){var e=fe("_im_mess_"+t.messageId,n);pe(e,I)&&be(e,"im-mess_sending")},500),d=d.filter(function(e){return e.rid!==t.randomId}),dt(n),mt(d,e,n)}function mt(e,t,n){var r=void 0;return(r="object"===(void 0===e?"undefined":O(e))?e:t.imQueue(e,!1)).length>0&&r.map(function(e){return e.mess.failed=!!e.failed,e.mess}).filter(function(e){return Object(o.m)(t,e.peerId,e.messageId)}).forEach(function(e){return ft(t,e,n,!1)}),n}function bt(e,t,n){var r=e.tabs[t];return Object(_.p)(le("_im_mess_unread",n)).forEach(function(e){var t,n=ne(de(e,"msgid"));n>0&&r.out_up_to>=n&&(_e(e,"_im_mess_unread"),_e(e,"im-mess_unread"),(t=fe("_im_mess_blind_unread_marker",e))&&(t.removeAttribute("aria-label"),t.removeAttribute("role"),t.removeAttribute("tabindex")))}),n}function _t(e,t,n){var r=t.peerId,i=t.messageId,a=fe("_im_msg_reply"+i,e),o=fe("_im_msg_media"+i,e),u=n.tabs[r].mediacontent[i][0];return a&&(a.innerHTML=u[0]),o&&(o.innerHTML=u[1]),e}function ht(e,t){if(!Object(o.E)(t,e.peerId))return 0;var n=t.tabs[e.peerId];return n.msgs[e.messageId]?1:n.msgs["rid"+e.randomId]?2:0}function pt(e,t){return e===t.peer}function gt(e,t){return Object(y.m)(Object(o.t)(e,t),1024)}function vt(e,t){return!!e.tabs[t]}function yt(e,t){return!!vt(e,t)&&null!==e.tabs[t].lastmsg}function jt(e,t){return 1e3*e+1e3*t.timeshift}function kt(e,t,n,r,i){if(Object(u.b)(t)!==Object(u.b)(n))return!0;var a=jt(t.date,r),c=jt(n.date,r);return!De(a,c)||(!(!Object(o.B)(r)||ne(t.kludges.from_admin)===ne(n.kludges.from_admin))||(n.date-t.date>300||(!(!Object(u.l)(t)&&!Object(u.l)(n))||(!(!Object(u.e)(n)&&!Object(u.e)(t))||(!(!Object(u.f)(t)&&!Object(u.f)(n))||(!(!Object(u.g)(t)&&!Object(u.g)(n))||(!!Object(u.c)(n)||!(Object(u.n)(e,t)===Object(u.n)(e,n)||!i||Object(u.k)(n)||en(n.peerId,r.gid)))))))))}function Ot(e,t){return we(1e3*e,"{hour}:{minute} {am_pm}",1e3*t,[],!0)}function wt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=Math.round(1e9*Math.random()).toString(16),u={},s=0;return t=(t=Object(c.e)(t||"",c.b.bind(null,r))).replace(/(<a.+?<\/a>)/gi,function(e){var t="!link_"+s+"_"+a+"!";return u[t]=e,s++,t}),t=Object(c.f)(t),t=Object(c.c)(t),t=Object(c.d)(t,function(t){var n=Object(o.i)(e);return'<a href="/'+(n?"gim"+n:"im")+"?sel="+(i||Object(o.o)(e))+"&st="+encodeURIComponent(t)+'">'+t+"</a>"}),Object.keys(u).forEach(function(e){t=t.replace(e,function(){return u[e]})}),n.emoji&&(t=He.emojiToHTML(t,!0)),t}function It(e){return Object(s.b)(e)?"c"+(e-2e9):e<-2e9?"e"+Math.abs(e+2e9):function(e){return e>19e8&&e<2e9}(e)?"mr"+(e-19e8):e}function xt(e){switch(e.substr(0,1)){case"e":return-2e9-ne(e.substr(1));case"c":return 2e9+ne(e.substr(1));default:return ne(e)}}function Pt(e){return e>9999999?Math.floor(e/1e6)+"M":e>9999?Math.floor(e/1e3)+"K":e>0?e.toString():""}function Tt(e,t){return{search:{name:ke("mail_im_peer_search"),icon:"search"},block_community:{icon:"block",name:ke("mail_block_comm_messages")},block_notify:{icon:"block",name:ke("mail_block_notify_messages")},allow_community:{icon:"unblock",name:ke("mail_allow_comm_messages")},clear:{name:e.peer<-2e9?ke("mail_im_delete_email_contact"):ke("mail_im_delete_all_history"),icon:"clear"},chat:{name:ke("mail_im_create_chat_with"),icon:"invite"},mute:{name:ke("mail_im_mute"),icon:"mute"},unmute:{name:ke("mail_im_unmute"),icon:"unmute"},photos:{name:e.gid?ke("mail_im_show_media_history_group"):ke("mail_im_show_media_history"),icon:"media"},avatar:{icon:"avatar",name:ke("mail_update_photo_red")},block:{icon:"block",name:ke("mail_block_user")},invite:{icon:"invite",name:ke("mail_im_create_chat_with")},invite_link:{icon:"invite-link",name:ke(t?"mail_vkcomgroup_invite_link":"mail_chat_invite_link")},leave:{icon:"leave",name:ke(t?"mail_leave_channel":"mail_leave_chat")},topic:{icon:"topic",name:ke("mail_change_topic")},return:{icon:"return",name:ke(t?"mail_return_to_vkcomgroup":"mail_return_to_chat")},pin_hide:{icon:"pin_hide",name:ke("mail_menu_pin_hide")},pin_unhide:{icon:"pin_unhide",name:ke("mail_menu_pin_show")},unpin:{icon:"unpin",name:ke("mail_menu_unpin")},settings:{icon:"settings",name:ke(t?"mail_vkcomgroup_settings":"mail_settings")}}}function Dt(e,t){var n='<img src="'+e+'" alt="" class="dialogs_inline_chatter dialogs_inline_chatter_half"/>';return t&&(n=je("im_dialogs_link",{href:t,photo:n})),'<div class="im_grid">\n    <div class="dialogs_inline_chatter dialogs_inline_chatter_half">\n      '+n+"\n    </div>\n  </div>"}function At(e,t){var n='<img src="'+e+'" alt="" class="dialogs_inline_chatter"/>';return t&&(n=je("im_dialogs_link",{href:t,photo:n})),'<div class="im_grid">\n    <div class="dialogs_inline_chatter">\n      '+n+"\n    </div>\n  </div>"}function St(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if("string"==typeof e)return'<div class="im_grid"><img src="'+e+'" alt=""/></div>';switch(e.length){case 1:return'<div class="im_grid"><img src="'+e[0]+'" alt=""/></div>';case 2:return e.map(function(e,n){return Dt(e,t[n])}).join("");case 3:return Dt(e[0],t[0])+e.slice(1).map(function(e,n){return At(e,t[n+1])}).join("");case 4:return e.map(function(e,n){return At(e,t[n])}).join("")}}function Et(e,t,n){if("string"==typeof t.photo&&t.photo)return'<div class="im_grid"><img src="'+t.photo+'" alt=""></div>';if(Object(s.b)(t.peerId)&&t.membersCount<2)return'<div class="im_grid"><img src="'+e.get().default_chat_photo+'" alt=""></div>';if(Array.isArray(t.photo))return St(t.photo);var r=t.data.active.slice(0,4).map(h.c.bind(null,e));return St(r.map(function(e){return e.photo}),n?[]:r.map(function(e){return e.link}))}function Ct(e){var t=e.get().gid?ke("mail_search_only_messages_comm"):ke("mail_search_only_messages");return'<li class="im-page--mess-search-w">\n    <div class="im-page--mess-search '+Z+'">\n      <button type="button" class="im-i--messages-search"></button>'+t+"\n    </div>\n  </li>"}function zt(){return'<li class="im-search-results-head">'+ke("mail_search_messages")+"</li>"}function qt(){return'<li class="im-search-results-head">'+ke("mail_search_conversations_sep")+"</li>"}function Mt(){return'<li class="im-search-results-head">'+ke("mail_search_dialogs_sep")+"</li>"}function Nt(){return'<li class="im-search-results-head _im_recent_bar">\n    '+ke("mail_recent_searches")+'\n    <button type="button" class="'+J+' im-page--clear-recent">'+ke("mail_clear_recent")+"</button>\n  </li>"}function Bt(e){var t=e.get().popular_sugg,n=Object(o.z)(e)?8:5;return t.length>n&&(t=t.slice(0,n)),'<li class="im-popular clear_fix">'+t.map(function(t){var n=t.peerId,r=Object(h.c)(e,n)||t,i=e.get().tabs[n]||t,a=(e.get().mutedPeers||[]).indexOf(n)>=0;return'<div class="'+["im-popular--item","fl_l","_im_dialog","_dont_add_recent","_im_sugg_"+n,i.unread>0&&"sugg-is_unread",a&&"sugg-is_muted"].filter(function(e){return!!e}).join(" ")+'" data-peer="'+n+'">\n    <a class="im-popular--avatar-w '+Ne(i.online)+'" href="'+r.link+'"><img class="im-popular--avatar" src="'+r.photo+'"/></a>\n    <div class="im-popular--name-w"><a class="im-popular--name" href="'+r.link+'">'+(r.first_name||r.name)+'</a></div>\n    <span class="im-popular--unread _sugg_unread_ct">'+Pt(i.unread)+"</span>\n</div>"}).join("")+"</li>"}function Ht(e,t,n){var r=fe("_im_mess_"+t.messageId,n);if(r){ge(r,"aria-hidden","false"),be(r,"im-mess_failed "+x);var i=fe("_im_mess_marker",r);ge(i,"aria-label",ke("mail_send_message_error")),ge(i,"role","link")}return n}function Lt(e,t,n){var r=fe("_im_mess_"+t,n);if(r){_e(r,"im-mess_failed"),ge(r,"aria-hidden","true"),_e(r,x);var i=fe("_im_mess_marker",r);ge(i,"aria-label",""),ge(i,"role","")}return n}function Ft(e,t){return Rt(e.map(function(e){return fe("_im_mess_"+e,t)}).filter(function(e){return e}),t)}function Rt(e,t){var n=e.filter(function(e){return!pe(e,"im-mess_srv")}).map(function(e){return e.parentNode});return e.forEach(function(e){pe(e,"im-mess_srv")?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e)}),n.filter(function(e){return 0===ce(e).length}).map(function(e){return me("_im_mess_stack",e)}).forEach(function(e){pe(oe(e),"_im_bar_date")&&G(oe(e)),pe(oe(e),"_im_unread_bar_row")&&G(oe(e)),G(e)}),t}function Ut(e){for(var t=e;t;){var n=t;if(null===(t=t.previousElementSibling)){pe(n,"mess_srv")&&(t=n.parentNode);var r=me("_im_mess_stack",n);r&&(t=r.previousElementSibling,1===ce(n.parentNode).length&&r.parentNode.removeChild(r))}pe(n,"_im_unread_bar_row")||n.parentNode.removeChild(n)}}function Jt(e,t,n,r){return e.map(function(e){return fe("_im_mess_"+e,r)}).filter(function(e){return e}).forEach(function(e){ye(e,function(e,t,n){var r=t.innerHTML;return'<div class="im-mess--text">\n    '+ke("delete"===n?"mail_deleted_stop":"mail_marked_as_spam")+' <button type="button" data-peer="'+e+'" class="'+T+' im-mess--btn">'+ke("mail_restore")+'</button>\n    <div class="'+P+' im-mess--original">'+r+"</div>\n  </div>"}(t,e,n)),be(e,"im-mess_light")}),r}function Qt(e,t,n){var r=fe("_im_mess_"+e,n);if(r){var i=fe(P,r);ye(r,i.innerHTML),_e(r,"im-mess_light")}return n}function Zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;if(arguments.length>5&&void 0!==arguments[5]&&arguments[5])return Vt(e,t,n,r,!0,i);var a=Vt(e,t,n,r,!1,i);return a.length>60?Vt(e,t,n,r,!0,i):a}function Kt(e){var t,n=(w(t={},d.d,1),w(t,d.c,2),t),r=Object.keys(e).sort(function(e,t){return n[t]-n[e]}),i={},a=r.reduce(function(t,n){var r=(e[n]||{}).userIds;return(void 0===r?[]:r).forEach(function(e){i[e]||(i[e]=!0,t[n]=!0)}),t},{}),o=r.filter(function(e){return!!a[e]});return o.length>1?"":o[0]}function Vt(e,t,n,r,i,a){var u=function(e,t,n){var r=[],i={};return Object.keys(t).map(function(n){((t[n]||{}).userIds||[]).forEach(function(t){Object(h.b)(e,t)?parseInt(t,10)!==e.id&&(i[t]=n):r.push(t)})}),r.length&&Object(d.hb)(w({},n,r),e),Object.keys(i).sort(function(e,n){return t[i[e]].ts-t[i[n]].ts})}(r,e,t);if(0===u.length)return"";var c=Object(s.d)(t)||Object(o.C)(t)?"first_name":i?"short_name":"name",l=Kt(e),f="";l===d.c?f=ke("mail_recording_audio_several",u.length):l===d.d&&(f=ke("mail_typing_several",u.length));var m=u.slice(0,Math.min(u.length-1,a)),b=m.map(function(e){return Object(h.c)(r,e)[c]}).join(", ");if(u.length>a+1){var _=function(e){var t={};return Object.keys(e).forEach(function(n){var r=e[n].userIds;(void 0===r?[]:r).forEach(function(e){t[e]=1})}),Object.keys(t).length}(e);b+=" "+ke("mail_and_peer").replace("{count}",_-a).replace("{typing}",f)}else{if(u.length>1&&(b+=" "+ke("mail_and_peer_one")),!Object(s.b)(t)&&n)b+=" "+f;else b+=" "+Object(h.c)(r,u[m.length])[c]+" "+f}return b.trim()}function Xt(){return'<div class="im-page--chat-search-empty">\n    '+ke("mail_im_search_empty")+"\n  </div>"}function Wt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return n?'<a class="im_srv_lnk '+r+'" target="_blank" rel="noopener" href="'+e+'">'+t+"</a>":'<span class="'+r+'">'+t+"</span>"}function $t(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.kludges,a=i.source_act,o=ne(i.source_mid),u=t.userId,c=Object(h.c)(e,u),s="",d=u===o;switch(a){case A:s="mail_im_chat_created";break;case S:s=i.source_is_channel?"mail_im_title_updated_channel":"mail_im_title_updated_dot";break;case E:s=d?"mail_im_returned_to_chat":"mail_im_invited";break;case C:s=d?"mail_im_left":"mail_im_kicked_from_chat";break;case z:s="mail_im_photo_set";break;case q:s=i.source_is_channel?"mail_im_photo_removed_channel":"mail_im_photo_removed";break;case M:s=i.source_message?"mail_im_pin_message":"mail_im_pin_message_empty2";break;case N:s=i.source_message?"mail_im_unpin_message":"mail_im_unpin_message_empty2";break;case B:s="mail_im_invite_by_link";break;default:return"mail_no_support"}if(s=(s=Oe(c.sex,ke(s,"raw"))).replace("{from}",Wt(c.link,c.name,r)),o&&o!==u){var l=i.source_email;if(l)s=s.replace("{user}",Wt("/im?email="+encodeURIComponent(l),"email",r));else{var f=Object(h.c)(e,o),m=a===C?f.inv_name:f.kick_name;s=s.replace("{user}",Wt(f.link,m,r))}}if(i.source_text){var b=i.source_old_text?'«<b class="im_srv_lnk">'+i.source_old_text+"</b>» &rarr; ":"";s=s.replace("{title}",b+'«<b class="im_srv_lnk">'+i.source_text+"</b>»")}if(i.source_act===M||i.source_act===N)if(i.source_message){var _=Wt("",Yt(He.emojiToHTML(ie(i.source_message.replace(/<br\s?\/?>/gi," ")),!0)),!1,"im_srv_mess_link");s=s.replace("{msg}",_)}else s=s.replace(/{link}(.+){\/link}/i,function(e,t){return Wt("",t,!1,"im_srv_mess_link")});return s}function Gt(e,t,n,r){if(t===z){var i=fe("_im_mess_"+e.messageId,r);if(i){var a=n.tabs[e.peerId];i.parentNode.innerHTML=je("im_msg_row",{msg_id:e.messageId,from_id:e.peerId,text:$t(n,e,a)+n.chat_photo_msg,ts:e.date,cls:"im-mess_srv"})}}return r}function Yt(e){return e.replace(/&lt;&lt;/g,"&laquo;").replace(/&gt;&gt;/g,"&raquo;").replace(/ \-\-/g," &mdash;").replace(/\-\- /g,"&mdash; ").replace(i.r,"$1$4")}function en(e,t){return!t&&e===X.id}function tn(e,t){return qe(e,{url:Object(o.C)(t)?"al_groups.php":"al_profile.php",params:{act:"verified_tt",mid:t,gid:t},slide:15,ajxdt:200,showdt:200,hidedt:200,dir:"auto",shift:[94,7,7],className:"verified_tt"})}function nn(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=$(je("im_preloader",{preloader:Y(X.pr_tpl,{id:""}),cls:["bottom"===n?"im-preloader_bottom":"im-preloader_top",r].join(" ")})),a=!1;function o(){a=!0,_e(i,"im-preloader_visible"),i.parentNode&&i.parentNode.removeChild(i)}setTimeout(function(){a||("bottom"===n?e.appendChild(i):e.insertBefore(i,ae(e)),be(i,"im-preloader_visible"))},0),t.then(o).catch(function(e){Object(v.a)("wrapLoading",e),o()})}}function rn(e,t){return{0:{msgs:e.reduce(function(e,t){return e[t]=[t,r.l,0,0,"",{},{},0,0,0],e},{}),hash:t,history:1}}}function an(e,t){if(!t&&!e)return!1;var n=e.target||e.srcElement,r=Qe,i=!1,a=/_im_mess|im_log_act|im_log_ract|_im_log_body|im_log_rspacer|_im_graffiti_w|_wall_post_cont/;do{if(!n||n.onclick||n.onmousedown||"A"==n.tagName||pe(n,"_im_no_select")||pe(n,"im_msg_media_link")||"IMG"==n.tagName&&!pe(n,"_im_graffiti")&&!pe(n,"emoji")&&!pe(n,"emoji_css")&&!pe(n,"im_gift")||"TEXTAREA"==n.tagName||pe(n,"play_new")||pe(n,"videoplayer")||(i=a.test(n.className)))break}while(r--&&(n=n.parentNode));return!i||!!re((window.getSelection&&window.getSelection()||document.getSelection&&document.getSelection()||"").toString())}function on(e,t){return'<div class="im-mess--text">\n      <span>'+ke("mail_restored")+'</span>\n      <a class="_im_go_to" href="/im?sel='+It(e)+"&msgid="+t+'">'+ke("mail_im_goto_conversation")+"</a>\n    </div>"}function un(e,t,n){var r=ke("mail_deleteall1"),i=ke("mail_sure_to_delete_all"),a=ke("mail_delete");return Object(s.b)(t)&&(Object(y.m)(e,1024)?(r=ke("mail_leave_channel"),i=ke("mail_unfollow_channel_confirmation"),a=ke("mail_unfollow_channel")):i=ke("mail_chat_sure_to_delete_all")),Object(o.C)(t)&&(i=ke("mail_group_sure_to_delete_all")),Ce(r,i,a,n,ke("global_cancel"))}function cn(e,t,n){var r=Object(o.t)(e,t),i=Object(s.b)(t),a=i&&Object(y.m)(r,1024),u=ke("mail_deleteall1"),c=ke("mail_sure_to_delete_all"),d=ke("mail_delete");if(i){if(r.data.closed||r.data.kicked)return un(r,t,n.bind(null,!0));a?(u=ke("mail_leave_channel"),c=ke("mail_vkcomgroup_leave_confirm"),d=ke("mail_leave_channel")):(u=ke("mail_leave_chat"),c=ke("mail_chat_leave_confirm"),d=ke("mail_leave_chat"))}Object(o.C)(t)&&(c=ke("mail_group_sure_to_delete_all"));var l=new MessageBox({title:u,width:a?450:500}).content(c).setButtons(d,function(){return n(!!isChecked(fe("_check_is_delete"))||!i)},ke("global_cancel")).show();return i&&!a&&l.setControlsText('<div class="checkbox im-delete-forall-checkbox _check_is_delete" onclick="checkbox(this);" role="checkbox" aria-checked="false">'+ke("mail_deleteall1")+"</div>"),l}function sn(e){return Ce(ke("mail_unpin_title"),ke("mail_unpin_text"),ke("mail_unpin"),e,ke("global_cancel"))}function dn(e,t,n,r){var i=ke("mail_dialog_msg_delete_N",t),a=Ce(ke("mail_dialog_msg_delete_title"),i,ke("mail_delete"),function(){return r(isChecked(fe("_check_forall")))},ke("global_cancel")),o="",u=!1;return n&&(o='<div class="checkbox im-delete-forall-checkbox _check_forall" onclick="checkbox(this);" role="checkbox" aria-checked="false">'+ke("mail_delete_for_all")+"</div>",u=cur.imDb.selectByKey("del_forall_checked")),a.setControlsText(o),u&&checkbox(fe("_check_forall")),a}function ln(e,t,n,r,i){t.showProgress(),e.set(r.bind(null,i)).then(function(){t.hideProgress(),t.hide(),n().removePeer(e,i),n().updateDialogFilters(e)})}function fn(e,t,n,r){var i=e.get().tabs[t].memberIds;e.set(r.bind(null,"add_member",i)).then(n().showCreation)}function mn(e,t,n){var r=e.get();if(r.active_tab===i.h&&0===r.message_requests_cnt)return!1;var a=r.active_tab===i.k?i.h:i.k;return e.set(n.bind(null,a)).then(function(e){t().restoreDialogs(e,!0)})}function bn(e,t,n){if(e.get().active_tab===i.h&&0===e.get().unread_cnt)return!1;var r=e.get().active_tab===i.m?i.h:i.m;return e.set(n.bind(null,r)).then(function(e){t().restoreDialogs(e,!0)})}function _n(e,t,n,r){if(t.get().active_tab===e)return Promise.resolve(t);var i=Object(o.I)(t);return t.set(r.bind(null,e)).then(function(e){return n().restoreDialogs(e,!0,i!==Object(o.I)(e)),e})}function hn(e,t){void 0===t&&(t=e.get().peer);var n=e.get().tabs[t];return i.j[i.i]&n.folders}function pn(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===t&&(t=e.get().peer),!Object(o.D)(e))return!1;var r=n||e.get().tabs[t];return i.j[i.n]&r.folders}function gn(e,t){return!1===((t.get().block_states||{})[e]||{}).free}function vn(e){return null!=e.get().pendingForward}function yn(e,t){return(t.get().block_states[e]||{}).who===X.id}function jn(e,t){var n=e.get().block_states;Object.keys(n).forEach(function(i){n[i].time?!1===n[i].free&&Date.now()-n[i].time>=5e4&&t.push([r.nb([,1,"gim"+e.get().gid,i,0,""])]):n[i].time=Date.now()})}function kn(e,t,n){var r=void 0;return!ze("al_im.php",{act:"a_spam",offset:"0",gid:e.get().gid},{onDone:function(n,i){i&&(r=t(n,e,i))},params:{width:638,onHide:function(){Be.loaded&&Be.detachPlayer(!0),r.unmount()}}},n)}function On(e,t){return wn(e.get(),t,Object(o.t)(e,t).last_seen)}function wn(e,t,n,r){if(n[0])return ke("mail_header_online_status")+(Me[n[0]]?In(t,!1,!1,!0):"");if(!n[1])return"";var i=xe(n[1],e.timeshift),a=Oe(Object(h.c)(e,t).sex,ke("mail_last_activity_tip","raw")).replace("{user}","").replace("{time}",i);return n[2]&&(a+=In(t,!1,!1,r)),a}function In(e,t,n,r){var i={mid:e};n||(i.was=1),t?i.forcetoup=!0:i.forcetodown=!0,i=Object.assign(i,r);var a=JSON.stringify(i).slice(1,-1).replace(/"/g,"&quot;");return je("im_wrap_mobile",{class:"im_status_mob_onl",params:a})}function xn(e,t){var n=t.get().tabs[e];return Ee("al_settings.php",{act:"blacklist_box",q:n.href},{stat:["settings.js","settings.css"],dark:1})}function Pn(e,t){return Ee("groupsedit.php",{act:"bl_edit",name:"/id"+e,gid:t.get().gid},{stat:["page.css","ui_controls.js","ui_controls.css"],dark:1})}function Tn(e){return e.get().gid?"/gim"+e.get().gid:"/im"}function Dn(e,t,n,r){var i=void 0;Zn(ze("al_im.php",{act:"a_important",offset:"0"},{onDone:function(r,a){a&&(i=n(r,e,t,a))},params:{width:638,onHide:function(){Be.loaded&&Be.detachPlayer(!0)},onDestroy:function(){i&&i.unmount()}}},r),e)}function An(){var e=document.activeElement;return null!==e&&("INPUT"===e.tagName||"TEXTAREA"===e.tagName||e.getAttribute("contenteditable"))}function Sn(e,t,n){var r=fe("_im_mess_"+e,n);return r&&he(r,"im-mess_fav",t),n}function En(e,t,n){var r=fe("_im_unread_bar_row",t);if(!r)return t;var i,a=se(r,"._im_mess_stack",-1),u=se(r,"._im_mess_stack"),c=a?le("_im_mess",a).pop():null,s=u?fe("_im_mess",u):null;if(G(r),(i=fe("_im_invisible_bar",t))&&(_e(i,"_im_invisible_bar"),_e(i,"im-page--history-new-bar_hide")),!s||!c)return t;var d=de(s,"msgid"),l=Object(o.q)(e,n,d),f=Object(o.m)(e,n,d);if(!l||kt(e.tabs[n],l,f,e))return t;var m=fe("_im_stack_messages",a),b=fe("_im_stack_messages",u).children;return Object(_.p)(b).forEach(function(e){G(e),m.appendChild(e)}),G(u),t}function Cn(e,t,n){var r=Object(o.h)(e,e.get().peer);if(!r)return[!1,0];var i=fe("_im_mess_"+r,t);if(!i){var a=Object(o.k)(e,e.get().peer,r);if(!a)return[!0,0];i=fe("_im_mess_"+a.messageId,t)}var u=pe(i,"_im_mess_srv")?i:me("_im_mess_stack",i);if(!u)return[!0,0];var c=i?i.offsetTop:0,s=u.offsetTop+c,d=n.contHeight();return s<=n.scrollTop()+n.getScrollHeight()?[!0,0]:[!1,Math.max(0,d-s)]}function zn(e,t,n){Re(t);var r=me("_im_top_notice",n);Fe(r,200,G.pbind(r));var i=me("_im_page_dialogs",r);i&&pe(i,"im-page--dialogs-notice")&&_e(i,"im-page--dialogs-notice"),Se.post("al_im.php",{act:"a_hide_top_notice",type:r.getAttribute("data-type"),hash:r.getAttribute("data-hash")})}function qn(e,t,n){Re(t);var r=me("_im_aside_notice",n);Le(r,200,G.pbind(r)),Se.post("al_im.php",{act:"a_hide_top_notice",type:r.getAttribute("data-type"),hash:r.getAttribute("data-hash")})}function Mn(e,t){Re(e);var n=me("_im_aside_promo_block",t);Le(n,200,G.pbind(n)),Se.post("al_im.php",{act:"a_hide_promo_block",type:n.getAttribute("data-type"),hash:n.getAttribute("data-hash")})}function Nn(e,t){me("_im_aside_promo_block",t).classList.add("--action-called"),Se.post("al_im.php",{act:"a_vkadmin_app_install",hash:de(t,"hash"),platform:de(t,"platform")})}function Bn(e,t,n,r,i){return n=n.replace(/\<br\s*\/?\>(\n)?/gi," ").replace(/[\n\r]/gi," "),n=Object(c.f)(n,function(e,t,n,r,i){return i}),r&&(n=He.emojiToHTML(n,!0)),t&&"..."!==t.trim()&&!Object(s.b)(e)&&(n=je("im_topic",{topic:t,cls:"im-topic_dialog"})+n),!n&&i.length>0&&(n=je("im_dialog_media",{name:Hn(i[0],i)})),n}function Hn(e,t){var n={photo:ke("mail_added_photos","raw"),video:ke("mail_added_videos","raw"),audio:ke("mail_added_audios","raw")};switch(e.type){case"mail":case"respond":var r=e.object?e.object.fwd_count:e.id.split(";").length;return Ie(r,ke("mail_fwd_msgs","raw"),!0);case"photo":case"video":case"audio":var i=t.filter(function(t){return t.type===e.type}).length;return Ie(i,n[e.type],!0);case"audio_playlist":return"audio_album"===e.kind?ke("mail_added_audio_album"):ke("mail_added_audio_playlist");case"artist":return ke("mail_added_artist");case"doc":switch(e.kind){case"graffiti":return ke("mail_added_graffiti");case"audiomsg":return ke("mail_added_audiomsg");default:return ke("mail_added_docs")}case"geo":case"map":return ke("mail_added_geo");case"wall":return ke("mail_added_wall");case"wall_reply":return ke("mail_added_wall_reply");case"gift":return ke("mail_added_gift");case"link":case"share":return ke("mail_added_link");case"sticker":return ke("mail_added_sticker");case"market":return ke("mail_added_market_item");case"money_transfer":return ke("mail_added_money_transfer");case"money_request":return ke("mail_added_money_request");case"story":return ke("mail_added_story");case"mask":return ke("mail_added_mask");case"article":return ke("mail_added_article");case"call":return ke("mail_added_call");case"poll":return ke("mail_added_poll");case"podcast":return ke("mail_added_podcast");default:return ke("mail_added_"+e.type)}return""}function Ln(e){be(e,"im-send-btn_loading")}function Fn(e){_e(e,"im-send-btn_loading")}function Rn(e){var t=e.get(),n=Object(o.p)(e);if(!n||!Object(p.a)(e,Object(o.o)(e)))return"";var r=Object(h.c)(e,n.userId);if(!r)return"";var i=function(e,t){var n="";if(t&&Object(u.j)(t)&&void 0!==t.kludges.attach1_tr_amount){var r="%s "+t.kludges.attach1_currency;if("RUB"===t.kludges.attach1_currency&&(r=ke("mail_money_amount_rub","raw")),t.kludges.attach1_total_amount){var i=Ie(t.kludges.attach1_tr_amount/1e3,"%s",!0),a=Ie(t.kludges.attach1_total_amount/1e3,r,!0);n=ke("mail_money_request_collected_amount_from").replace("{amount}",i).replace("{total_amount}",a)}else{var o=Ie(t.kludges.attach1_tr_amount/1e3,r,!0);n=ke("mail_money_request_collected_amount").replace("{amount}",o)}if(ne(t.kludges.attach1_held_amount)){var c=Ie(t.kludges.attach1_held_amount/1e3,r,!0);n+=" "+ke("mail_money_request_held_amount").replace("{amount}",c)}t.text&&(n+='<span class="divider"></span>'+wt(e,t.text,t.kludges)),t.kludges.attach1_total_amount&&(n+=je("im_pinned_message_media_bar",{percent:Math.min(100,Math.floor(t.kludges.attach1_tr_amount/t.kludges.attach1_total_amount*100))}))}return n}(e,n);return i||(i=!(i=n.text)&&n.attaches.length?je("im_pinned_message_media",{text:Hn(n.attaches[0],n.attaches)}):wt(e,i,n&&n.kludges||{})||""),i=i.replace(/<br\s?\/?>/gi," "),je("im_pinned_message",{date:Pe(n.date,t.timeshift),content:i,link:r.link,name:r.name})}function Un(e,t,n){var r=n.getAttribute("data-info");r&&qe(n,{text:r,className:"_im_history_tooltip",appendParentCls:"_im_mess_stack",black:1,hidedt:1e3,shift:[0,4]})}function Jn(e,t,n){var r=+n.getAttribute("data-time");r&&qe(n,{text:ke("mail_message_edited")+" "+Pe(r,e.get().timeshift),className:"_im_history_tooltip",appendParentCls:"_im_mess_stack",black:1,shift:[0,4]})}function Qn(){var e=getSize(fe(K))[1];return e||(e=Ze),e}function Zn(e,t){e.bodyNode.addEventListener("mouseover",function(e){pe(e.target,"_im_edit_time")?Jn(t,0,e.target):pe(e.target,"_im_page_info")&&Un(0,0,e.target)})}function Kn(e,t,n,r,i){var a=e.get(),o=void 0;Zn(ze("al_im.php",{act:"a_get_pinned_message_box",chat:n,gid:e.get().gid,hash:a.tabs[n].hash},{onDone:function(n,i){i&&(o=r(n,e,t,i))},params:{width:638,onHide:function(){Be.loaded&&Be.detachPlayer(!0)},onDestroy:function(){o&&o.unmount()}}},i),e)}function Vn(e,t,n){var r=e.get();Zn(ze("al_im.php",{act:"a_get_replied_message_box",chat:r.peer,msgid:t,gid:r.gid,hash:r.tabs[r.peer].hash},{onDone:function(e,t){},params:{width:638,onHide:function(){Be.loaded&&Be.detachPlayer(!0)},onDestroy:function(){}}},n),e)}function Xn(e,t){return!(!Object(s.b)(e.peerId)||!e.memberIds)&&e.memberIds.indexOf(t)>=0}function Wn(e){return!Object(s.b)(e.peerId)||e.data.kicked?0:e.membersCount}function $n(e,t){var n=Object(h.c)(e,t.peerId),r=Object(o.t)(e,t.peerId)||{};return n&&(t.photo=t.photo||n.photo,t.name=t.name||n.name,t.href=t.link||n.link,t.sex=t.sex||n.sex),t.last_touched=r.last_touched||0,t.verified=!!t.verified,t.lastmsg=t.lastmsg||t.lastmsg_meta&&t.lastmsg_meta[0]||!1,t.folders=t.folders||null,t.unread=t.unread||0,t.last_seen=t.last_seen||[0,0,0],t.online=t.last_seen&&t.last_seen[0]||0,t.out_up_to=null!=t.out_up_to?t.out_up_to:t.in_up_to||0,Object(s.b)(t.peerId)&&(t.memberIds=t.memberIds||r.memberIds||null),t}function Gn(e,t){for(var n in t)t.hasOwnProperty(n)&&$n(e,t[n])}function Yn(e,t){var n=[],r=t.find(function(e){return"mail"===e[0]}),i=r?r[1].split(";"):[];for(i.length>Je&&(r[1]=i.slice(0,Je).join(";"));e.length>Ue;){var a=e.substr(0,Ue).lastIndexOf(" ");-1==a&&(a=Ue),n.push({msgText:re(e.substr(0,a))}),e=re(e.substr(a))}for(e.length&&n.push({msgText:e,attaches:t}),n.length||n.push({attaches:t}),i=i.slice(Je);i.length;i=i.slice(Je))n.push({attaches:[["mail",i.slice(0,Je).join(";")]]});return n}function er(e){return e.length>Ue}function tr(e,t,n){var r=!1;Ee("al_im.php",{act:"a_chat_preview",chat_id:t.invite_chat_id,hash:t.invite_hash},{stat:["boxes.css"],params:{dark:1,hideButtons:!0,onHide:function(){e.set(n),r&&r.unmount()}},onFail:function(e){return setTimeout(function(){return Ce(ke("global_error"),e)},0),!0},onDone:function(t,n){r=b(t.bodyNode,e)}},{})}function nr(){Ce(ke("global_error"),ke("mail_message_wait_until_uploaded"))}function rr(e,t){var n=Object(o.t)(e,t.peerId)||{};if(!t||!Object(u.k)(t))return!1;if(333==t.peerId)return!1;if(Date.now()/1e3-t.date>86400)return!1;if(et(e,t.peerId,t.messageId))return!1;if(Object(s.b)(t.peerId)){if(n.data.kicked||n.data.closed)return!1}else if(n.block_error>0)return!1;return!0}function ir(e,t){return t.map(function(t){return Object(h.c)(e,t)})}function ar(e,t){if("number"!=typeof e||0===e)return"";var n,r=e,i=[];if([[31536e3,ke(t?"global_years_accusative":"global_age_years","raw")],[2592e3,ke(t?"global_months_accusative":"global_age_months","raw")],[604800,ke(t?"global_weeks_accusative":"global_age_weeks","raw")],[86400,ke(t?"global_days_accusative":"global_age_days","raw")],[3600,ke(t?"global_hours_accusative":"global_hours","raw")],[60,ke(t?"global_minutes_accusative":"global_minutes","raw")],[1,ke(t?"global_seconds_accusative":"global_age_seconds","raw")]].forEach(function(e){var t=k(e,2),n=t[0],a=t[1],o=Math.floor(r/n);r%=n,o>=1&&i.push(Ie(o,a))}),1===(n=i.length))return i.pop();var a=i.slice(0,n-1).join(", "),o=i.pop();return ke("global_and").replace(/{before}/gi,a).replace(/{after}/gi,o)}function or(e,t,n,i){i&&!et(e,n,i)&&(Object(o.m)(e,n,i)?(e.setState({msgid:i}),Object(a.b)({msgid:i}),t()):e.get().longpoll.push([Object(r.bb)(n,i)]))}function ur(e){var t=fe("im-mess_is_editing");if(!t)return null;var n=e.get().tabs[e.get().peer],r=Object(o.P)(n.msgs[de(t,"msgid")]);return r&&r.peerId==e.get().peer?r:null}},Wu9C:function(e,t,n){"use strict";var r=n("N1NS"),i=n("vT4u");function a(e){return{unmount:function(){Object(r.c)(e)}}}function o(e,t,n){return(0,Object(r.b)(a).bindMutations)(Object(r.a)({handlers:function(e,t){}}))}var u=n("P13b"),c=n("rHUl"),s=n("aong"),d=n("uytb");n.d(t,"a",function(){return m}),n.d(t,"c",function(){return b}),n.d(t,"d",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"b",function(){return v});var l="_im_pin_hide",f="_im_pinned_message";function m(e,t){if(Object(s.r)(e).searchShown)return!1;var n=Object(c.t)(e,t),r=n&&Object(c.P)(n.pinned);return!!r&&n.pinHideId!=r.chat_local_id}function b(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Object(c.t)(e,t),a=i&&Object(c.P)(i.pinned);i&&a&&(i.pinHideId=a.chat_local_id,cur.imDb.update(d.a,[i.peerId,i.pinHideId]),p(n,t,e),re(geByClass1("_im_pinned_tt")),r&&window.Notifier&&Notifier.lcSend("pin_hide",{hide:1,peer:t}),statlogsValueEvent("im_pinned_messages","hide"))}function _(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Object(c.t)(e,t);i&&i.pinHideId&&(delete i.pinHideId,cur.imDb.update(d.a,[i.peerId,void 0]),p(n,t,e),r&&window.Notifier&&Notifier.lcSend("pin_hide",{hide:0,peer:t}),statlogsValueEvent("im_pinned_messages","show"))}function h(e,t,n){var r=p.bind(null,n,t),a=Object(u.xc)(function(){a.hideProgress(),a.hide(),e.set(i.Oc.bind(null,t)).then(r).then(function(e){return e.set(i.Nc.bind(null,t))}).then(r)})}function p(e,t,n){return e().updateChatTopic(t,n),Object(i.oc)(n.get()),e().updateActions(n),n}function g(e){return{unmount:function(){Object(r.c)(e)}}}function v(e,t,n){var i=Object(r.b)(g).bindMutations,a=function(e,t,n){var r=e.get().peer,i=Object(c.P)(Object(c.t)(e,r).pinned);if(n.target.classList.contains(l))i&&b(e,r,t);else if("A"!==n.target.tagName){var a=i&&i.messageId;a&&!Object(u.fb)(e,r,a)?Object(u.M)(e,t().focusOnMessage,r,a):Object(u.uc)(e,t,r,o,n),statlogsValueEvent("im_pinned_messages","open")}}.bind(null,t,n),s=function(e){showTooltip(e.target,{text:getLang("mail_hide_unpin_hover"),black:1,needLeft:1,shift:[8,4],forcetoup:!0,className:"_im_pinned_tt",appendEl:bodyNode})}.bind(null);return i(Object(r.a)({handlers:function(t,n){n(e,"click",f,a),n(e,"mouseover",l,s)}}))}},eTng:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return d}),n.d(t,"b",function(){return l});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=window.intval;function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.split("_"),i=r(n,2);return[i[0],i[1],t]}var o={};function u(e){if(o[e])return o[e];for(var t=e?e.length:0,n=[],i=[],u="",c=0;c<t;c++){var s=e[c],d=s.charCodeAt(0);d>=48&&d<=57||"_"===s||"-"===s?u+=s:"("!==s&&")"!==s&&":"!==s&&","!==s||(""!==u&&(i.push(u),n.push("id"),u=""),i.push(s),n.push(s))}u.length>0&&(i.push(u),n.push("id"));var l=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(o>50)return[[],t.length];for(var u=[],c="";i<t.length;){var s=t[i];if("id"===s)c=n[i];else if(","===s&&c)u.push(a(c)),c="";else if("("===s){var d=e(t,n,i+1,o+1),l=r(d,2),f=l[0];i=l[1],u.push(a(c,f)),c=""}else if(")"===s)return""!==c&&u.push(a(c)),[u,i];i++}return c&&u.push(a(c)),[u,i]}(n,i),f=r(l,1)[0];return Object.keys(o).length>300&&(o={}),o[e]=f,f}function c(e,t){var n=[];e.fwd_count?n.push({type:"mail",id:-t,object:{fwd_count:e.fwd_count}}):e.fwd&&n.push({type:"mail",id:-t,object:{fwd_count:u(e.fwd).length}});for(var r=1;e["attach"+r+"_type"];++r)"call"===e["attach"+r+"_type"]?n.push({type:e["attach"+r+"_type"],id:e["attach"+r],initiatorId:i(e["attach"+r+"_call_initiator_id"]),state:e["attach"+r+"_call_state"],duration:i(e["attach"+r+"_call_duration"]),receiverId:i(e["attach"+r+"_call_receiver_id"])}):n.push({type:e["attach"+r+"_type"],id:e["attach"+r],kind:e["attach"+r+"_kind"],productId:e["attach"+r+"_product_id"]});return e.geo&&n.push({type:"geo",id:e.geo}),n}function s(e){return 0==e}function d(e){return e>0&&e<2e9}function l(e){return e>2e9}},f01n:function(e,t,n){"use strict";n.d(t,"U",function(){return o}),n.d(t,"M",function(){return u}),n.d(t,"Q",function(){return c}),n.d(t,"a",function(){return s}),n.d(t,"H",function(){return d}),n.d(t,"I",function(){return l}),n.d(t,"s",function(){return f}),n.d(t,"r",function(){return m}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return _}),n.d(t,"W",function(){return h}),n.d(t,"J",function(){return p}),n.d(t,"Y",function(){return g}),n.d(t,"X",function(){return v}),n.d(t,"G",function(){return y}),n.d(t,"h",function(){return j}),n.d(t,"P",function(){return k}),n.d(t,"L",function(){return O}),n.d(t,"T",function(){return w}),n.d(t,"S",function(){return I}),n.d(t,"K",function(){return x}),n.d(t,"V",function(){return P}),n.d(t,"R",function(){return T}),n.d(t,"F",function(){return D}),n.d(t,"b",function(){return A}),n.d(t,"c",function(){return S}),n.d(t,"i",function(){return E}),n.d(t,"O",function(){return C}),n.d(t,"f",function(){return z}),n.d(t,"g",function(){return q}),n.d(t,"N",function(){return M}),n.d(t,"m",function(){return B}),n.d(t,"l",function(){return H}),n.d(t,"n",function(){return L}),n.d(t,"j",function(){return F}),n.d(t,"o",function(){return R}),n.d(t,"k",function(){return U}),n.d(t,"q",function(){return J}),n.d(t,"p",function(){return Q}),n.d(t,"B",function(){return Z}),n.d(t,"v",function(){return K}),n.d(t,"t",function(){return V}),n.d(t,"x",function(){return X}),n.d(t,"A",function(){return W}),n.d(t,"C",function(){return $}),n.d(t,"E",function(){return G}),n.d(t,"D",function(){return Y}),n.d(t,"u",function(){return ee}),n.d(t,"w",function(){return te}),n.d(t,"y",function(){return ne}),n.d(t,"z",function(){return re}),n.d(t,"gb",function(){return ie}),n.d(t,"vb",function(){return ae}),n.d(t,"Db",function(){return oe}),n.d(t,"zb",function(){return ue}),n.d(t,"Z",function(){return ce}),n.d(t,"hb",function(){return se}),n.d(t,"wb",function(){return de}),n.d(t,"ib",function(){return le}),n.d(t,"pb",function(){return fe}),n.d(t,"qb",function(){return me}),n.d(t,"mb",function(){return be}),n.d(t,"lb",function(){return _e}),n.d(t,"yb",function(){return he}),n.d(t,"ub",function(){return pe}),n.d(t,"Cb",function(){return ge}),n.d(t,"fb",function(){return ve}),n.d(t,"db",function(){return ye}),n.d(t,"eb",function(){return je}),n.d(t,"Fb",function(){return ke}),n.d(t,"rb",function(){return Oe}),n.d(t,"Hb",function(){return we}),n.d(t,"Gb",function(){return Ie}),n.d(t,"ob",function(){return xe}),n.d(t,"tb",function(){return Pe}),n.d(t,"ab",function(){return Te}),n.d(t,"jb",function(){return De}),n.d(t,"Eb",function(){return Ae}),n.d(t,"Bb",function(){return Se}),n.d(t,"sb",function(){return Ee}),n.d(t,"Ab",function(){return Ce}),n.d(t,"bb",function(){return ze}),n.d(t,"cb",function(){return qe}),n.d(t,"kb",function(){return Me}),n.d(t,"nb",function(){return Ne}),n.d(t,"xb",function(){return Be});var r=n("eTng"),i=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a="event_delete",o="event_set_flags",u="event_replace_flags",c="event_reset_flags",s="event_add_message",d="event_read_inbound",l="event_read_outbound",f="event_got_online",m="event_got_offline",b="event_chat_changed",_="event_chat_updated",h="event_typing",p="event_recoding_audio",g="event_video_call",v="event_unread_count",y="event_notify_settings_changed",j="event_empty",k="event_reset_directories",O="event_replace_directories",w="event_set_directories",I="event_resync",x="event_refresh_lp_key",P="transition_event",T="reset_peer",D="mutex",A="change_peer",S="event_change_tab",E="event_failed_message",C="event_resend",z="event_delete_dialog",q="event_edit_message",M="event_replace_message",N="event_audio_start",B=2,H=8,L=64,F=128,R=65536,U=1<<21,J=1,Q=8,Z=1,K=2,V=3,X=4,W=5,$=6,G=7,Y=8,ee=9,te=10,ne=11,re=12;function ie(e){var t=i(e,2)[1];return{type:a,localId:t}}function ae(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:u,messageId:n,mask:r,peerId:a}}function oe(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:o,messageId:n,flags:r,peerId:a}}function ue(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:c,messageId:n,flags:r,peerId:a}}function ce(e){var t=i(e,11),n=t[1],a=t[2],o=t[3],u=t[4],c=t[5],d=t[6],l=t[7],f=t[8],m=t[9],b=t[10],_=extend(d,l||void 0);return{type:s,messageId:intval(n),flags:intval(a),peerId:intval(o),date:intval(u),attaches:Object(r.a)(_,n),subject:d.title||"",text:c,kludges:_,randomId:intval(f),userId:Object(r.b)(o)?intval(_.from):intval(o),update_time:b,chat_local_id:m}}function se(e){var t=ce(e);return t.type=q,t}function de(e){var t=ce(e);return t.type=M,t}function le(e){return extend({},e,{type:q})}function fe(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:d,peerId:n,upToId:r,unread:a}}function me(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:l,peerId:n,upToId:r,unread:a}}function be(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:f,userId:-n,platform:r,lastSeenTs:a}}function _e(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:m,userId:-n,reason:r,lastSeenTs:a}}function he(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:k,peerId:n,mask:r,local:void 0!==a&&a}}function pe(e){var t=i(e,3),n=t[1],r=t[2];return{type:O,peerId:n,mask:r}}function ge(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:w,peerId:n,mask:r,local:void 0!==a&&a}}function ve(e){var t=i(e,3),n=t[1],r=t[2];return{type:z,peerId:n,localId:r}}function ye(e){var t=i(e,3),n=t[1],r=t[2];return{type:b,chatId:n,self:r}}function je(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:_,peerId:r,updateType:n,updateArg:a}}function ke(e){var t=i(e,5),n=t[1],r=t[2],a=t[3],o=t[4];return{type:h,peerId:n,userIds:r,totalCount:a,ts:o}}function Oe(e){var t=i(e,5),n=t[1],r=t[2],a=t[3],o=t[4];return{type:p,peerId:n,userIds:r,totalCount:a,ts:o}}function we(e){var t=i(e,3),n=t[1],r=t[2];return{type:g,userId:n,callId:r}}function Ie(e){var t=i(e,4),n=t[1],r=t[2],a=t[3];return{type:v,count:n,countNotMuted:r,showOnlyNotMuted:a}}function xe(e){var t=i(e,2)[1],n=void 0===t?{}:t;return{type:y,peerId:n.peer_id,sound:n.sound,disabledUntil:n.disabled_until}}function Pe(e){var t=i(e,2)[1],n=void 0===t?{}:t,r=ce([!1,n.id,n.flags,n.peer_id,n.date,n.message,extend(n.kludges,{title:n.title||""}),{},n.random_id,n.chat_local_id,n.update_time]);return r.type=q,r}function Te(e){var t=i(e,2)[1],n=void 0===t?{}:t;return{type:N,uuid:n.uuid,deviceName:n.device_name||""}}function De(e){return{type:j,params:e}}function Ae(e){return{type:P,state:e}}function Se(){return{type:I}}function Ee(e){var t=i(e,3),n=t[1],r=t[2];return{type:x,key:n,url:r}}function Ce(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:T,cancelSearch:e,removeActivePeer:t}}function ze(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return{type:A,peerId:e,msgid:t,forward:n,cancelSearch:r,entryPoint:i}}function qe(e){return{type:S,tab:e}}function Me(e,t,n){return{type:E,message:t,peer:e,error:n}}function Ne(e){var t=i(e,6),n=(t[0],t[1]),r=t[2],a=t[3],o=t[4],u=t[5];return{type:D,free:!!intval(n)||intval(o)===vk.id,resource:r,peerId:intval(a),who:intval(o),name:u}}function Be(e,t){return{type:C,message:t,peerId:e}}},"h++7":function(e,t,n){"use strict";var r;function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"t",function(){return a}),n.d(t,"f",function(){return o}),n.d(t,"B",function(){return u}),n.d(t,"q",function(){return c}),n.d(t,"r",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"v",function(){return f}),n.d(t,"u",function(){return m}),n.d(t,"d",function(){return b}),n.d(t,"o",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"z",function(){return p}),n.d(t,"A",function(){return g}),n.d(t,"w",function(){return v}),n.d(t,"m",function(){return y}),n.d(t,"h",function(){return j}),n.d(t,"n",function(){return k}),n.d(t,"i",function(){return O}),n.d(t,"k",function(){return w}),n.d(t,"l",function(){return I}),n.d(t,"g",function(){return x}),n.d(t,"j",function(){return P}),n.d(t,"y",function(){return T}),n.d(t,"p",function(){return D}),n.d(t,"c",function(){return A}),n.d(t,"s",function(){return S}),n.d(t,"x",function(){return E});var a=/^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/,o=/([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,u=/^(?:https?:\/\/)?(?:vk\.com|vkontakte\.ru)?\/([a-zA-Z0-9\._]+)\??$/,c=/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,s=/(^|[\s.,:\'\";>\)\(])(\*|@)([A-Za-z0-9_\.]{2,32})\s*\((.+?)\)/g,d=38,l=40,f=33,m=34,b=35,_=36,h=13,p=[d,l,f,m,h,27,b,_],g=[f,m,l,d,_,b],v="printable",y="unread",j="all",k="unrespond",O="important",w="mr",I="mr_rejected",x=[j,y,k,O,w],P=(i(r={},k,2),i(r,O,1),i(r,w,256),i(r,I,512),r),T=[].concat("aaa,aarp,abarth,abb,abbott,abbvie,abc,able,abogado,abudhabi,ac,academy,accenture,accountant,accountants,aco,active,actor,ad,adac,ads,adult,ae,aeg,aero,aetna,af,afamilycompany,afl,africa,ag,agakhan,agency,ai,aig,aigo,airbus,airforce,airtel,akdn,al,alfaromeo,alibaba,alipay,allfinanz,allstate,ally,alsace,alstom,am,americanexpress,americanfamily,amex,amfam,amica,amsterdam,an,analytics,android,anquan,anz,ao,aol,apartments,app,apple,aq,aquarelle,ar,aramco,archi,army,arpa,art,arte,as,asda,asia,associates,at,athleta,attorney,au,auction,audi,audible,audio,auspost,author,auto,autos,avianca,aw,aws,ax,axa,az,azure,ba,baby,baidu,banamex,bananarepublic,band,bank,bar,barcelona,barclaycard,barclays,barefoot,bargains,baseball,basketball,bauhaus,bayern,bb,bbc,bbt,bbva,bcg,bcn,bd,be,beats,beauty,beer,bentley,berlin,best,bestbuy,bet,bf,bg,bh,bharti,bi,bible,bid,bike,bing,bingo,bio,biz,bj,bl,black,blackfriday,blanco,blockbuster,blog,bloomberg,blue,bm,bms,bmw,bn,bnl,bnpparibas,bo,boats,boehringer,bofa,bom,bond,boo,book,booking,boots,bosch,bostik,boston,bot,boutique,box,bq,br,bradesco,bridgestone,broadway,broker,brother,brussels,bs,bt,budapest,bugatti,build,builders,business,buy,buzz,bv,bw,by,bz,bzh,ca,cab,cafe,cal,call,calvinklein,cam,camera,camp,cancerresearch,canon,capetown,capital,capitalone,car,caravan,cards,care,career,careers,cars,cartier,casa,case,caseih,cash,casino,cat,catering,catholic,cba,cbn,cbre,cbs,cc,cd,ceb,center,ceo,cern,cf,cfa,cfd,cg,ch,chanel,channel,chase,chat,cheap,chintai,chloe,christmas,chrome,chrysler,church,ci,cipriani,circle,cisco,citadel,citi,citic,city,cityeats,ck,cl,claims,cleaning,click,clinic,clinique,clothing,cloud,club,clubmed,cm,cn,co,coach,codes,coffee,college,cologne,com,comcast,commbank,community,company,compare,computer,comsec,condos,construction,consulting,contact,contractors,cooking,cookingchannel,cool,coop,corsica,country,coupon,coupons,courses,cr,credit,creditcard,creditunion,cricket,crown,crs,cruise,cruises,csc,cu,cuisinella,cv,cw,cx,cy,cymru,cyou,cz,dabur,dad,dance,data,date,dating,datsun,day,dclk,dds,de,deal,dealer,deals,degree,delivery,dell,deloitte,delta,democrat,dental,dentist,desi,design,dev,dhl,diamonds,diet,digital,direct,directory,discount,discover,dish,diy,dj,dk,dm,dnp,do,docs,doctor,dodge,dog,doha,domains,dot,download,drive,dtv,dubai,duck,dunlop,duns,dupont,durban,dvag,dvr,dz,earth,eat,ec,eco,edeka,edu,education,ee,eg,eh,email,emerck,energy,engineer,engineering,enterprises,epost,epson,equipment,er,ericsson,erni,es,esq,estate,esurance,et,eu,eurovision,eus,events,everbank,exchange,expert,exposed,express,extraspace,fage,fail,fairwinds,faith,family,fan,fans,farm,farmers,fashion,fast,fedex,feedback,ferrari,ferrero,fi,fiat,fidelity,fido,film,final,finance,financial,fire,firestone,firmdale,fish,fishing,fit,fitness,fj,fk,flickr,flights,flir,florist,flowers,fly,fm,fo,foo,food,foodnetwork,football,ford,forex,forsale,forum,foundation,fox,fr,free,fresenius,frl,frogans,frontdoor,frontier,ftr,fujitsu,fujixerox,fun,fund,furniture,futbol,fyi,ga,gal,gallery,gallo,gallup,game,games,gap,garden,gb,gbiz,gd,gdn,ge,gea,gent,genting,george,gf,gg,ggee,gh,gi,gift,gifts,gives,giving,gl,glade,glass,gle,global,globo,gm,gmail,gmbh,gmo,gmx,gn,godaddy,gold,goldpoint,golf,goo,goodhands,goodyear,goog,google,gop,got,gov,gp,gq,gr,grainger,graphics,gratis,green,gripe,group,gs,gt,gu,guardian,gucci,guge,guide,guitars,guru,gw,gy,hair,hamburg,hangout,haus,hbo,hdfc,hdfcbank,health,healthcare,help,helsinki,here,hermes,hgtv,hiphop,hisamitsu,hitachi,hiv,hk,hkt,hm,hn,hockey,holdings,holiday,homedepot,homegoods,homes,homesense,honda,honeywell,horse,hospital,host,hosting,hot,hoteles,hotmail,house,how,hr,hsbc,ht,htc,hu,hughes,hyatt,hyundai,ibm,icbc,ice,icu,id,ie,ieee,ifm,ikano,il,im,imamat,imdb,immo,immobilien,in,industries,infiniti,info,ing,ink,institute,insurance,insure,int,intel,international,intuit,investments,io,ipiranga,iq,ir,irish,is,iselect,ismaili,ist,istanbul,it,itau,itv,iveco,iwc,jaguar,java,jcb,jcp,je,jeep,jetzt,jewelry,jio,jlc,jll,jm,jmp,jnj,jo,jobs,joburg,jot,joy,jp,jpmorgan,jprs,juegos,juniper,kaufen,kddi,ke,kerryhotels,kerrylogistics,kerryproperties,kfh,kg,kh,ki,kia,kim,kinder,kindle,kitchen,kiwi,km,kn,koeln,komatsu,kosher,kp,kpmg,kpn,kr,krd,kred,kuokgroup,kw,ky,kyoto,kz,la,lacaixa,ladbrokes,lamborghini,lamer,lancaster,lancia,lancome,land,landrover,lanxess,lasalle,lat,latino,latrobe,law,lawyer,lb,lc,lds,lease,leclerc,lefrak,legal,lego,lexus,lgbt,li,liaison,lidl,life,lifeinsurance,lifestyle,lighting,like,lilly,limited,limo,lincoln,linde,link,lipsy,live,living,lixil,lk,loan,loans,local,locker,locus,loft,lol,london,lotte,lotto,love,lpl,lplfinancial,lr,ls,lt,ltd,ltda,lu,lundbeck,lupin,luxe,luxury,lv,ly,ma,macys,madrid,maif,maison,makeup,man,management,mango,market,marketing,markets,marriott,marshalls,maserati,mattel,mba,mc,mcd,mcdonalds,mckinsey,md,me,med,media,meet,melbourne,meme,memorial,men,menu,meo,metlife,mf,mg,mh,miami,microsoft,mil,mini,mint,mit,mitsubishi,mk,ml,mlb,mls,mm,mma,mn,mo,mobi,mobile,mobily,moda,moe,moi,mom,monash,money,monster,montblanc,mopar,mormon,mortgage,moscow,moto,motorcycles,mov,movie,movistar,mp,mq,mr,ms,msd,mt,mtn,mtpc,mtr,mu,museum,mutual,mv,mw,mx,my,mz,na,nab,nadex,nagoya,name,nationwide,natura,navy,nba,nc,ne,nec,net,netbank,netflix,network,neustar,new,newholland,news,next,nextdirect,nexus,nf,nfl,ng,ngo,nhk,ni,nico,nike,nikon,ninja,nissan,nissay,nl,no,nokia,northwesternmutual,norton,now,nowruz,nowtv,np,nr,nra,nrw,ntt,nu,nyc,nz,obi,observer,off,office,okinawa,olayan,olayangroup,oldnavy,ollo,om,omega,one,ong,onl,online,onyourside,ooo,open,oracle,orange,org,organic,orientexpress,origins,osaka,otsuka,ott,ovh,pa,page,pamperedchef,panasonic,panerai,paris,pars,partners,parts,party,passagens,pay,pccw,pe,pet,pf,pfizer,pg,ph,pharmacy,philips,phone,photo,photography,photos,physio,piaget,pics,pictet,pictures,pid,pin,ping,pink,pioneer,pizza,pk,pl,place,play,playstation,plumbing,plus,pm,pn,pnc,pohl,poker,politie,porn,post,pr,pramerica,praxi,press,prime,pro,prod,productions,prof,progressive,promo,properties,property,protection,pru,prudential,ps,pt,pub,pw,pwc,py,qa,qpon,quebec,quest,qvc,racing,radio,raid,re,read,realestate,realtor,realty,recipes,red,redstone,redumbrella,rehab,reise,reisen,reit,reliance,ren,rent,rentals,repair,report,republican,rest,restaurant,review,reviews,rexroth,rich,richardli,ricoh,rightathome,ril,rio,rip,rmit,ro,rocher,rocks,rodeo,rogers,room,rs,rsvp,ru,ruhr,run,rw,rwe,ryukyu,sa,saarland,safe,safety,sakura,sale,salon,samsclub,samsung,sandvik,sandvikcoromant,sanofi,sap,sapo,sarl,sas,save,saxo,sb,sbi,sbs,sc,sca,scb,schaeffler,schmidt,scholarships,school,schule,schwarz,science,scjohnson,scor,scot,sd,se,seat,secure,security,seek,select,sener,services,ses,seven,sew,sex,sexy,sfr,sg,sh,shangrila,sharp,shaw,shell,shia,shiksha,shoes,shop,shopping,shouji,show,showtime,shriram,si,silk,sina,singles,site,sj,sk,ski,skin,sky,skype,sl,sling,sm,smart,smile,sn,sncf,so,soccer,social,softbank,software,sohu,solar,solutions,song,sony,soy,space,spiegel,spot,spreadbetting,sr,srl,srt,ss,st,stada,staples,star,starhub,statebank,statefarm,statoil,stc,stcgroup,stockholm,storage,store,stream,studio,study,style,su,sucks,supplies,supply,support,surf,surgery,suzuki,sv,swatch,swiftcover,swiss,sx,sy,sydney,symantec,systems,sz,tab,taipei,talk,taobao,target,tatamotors,tatar,tattoo,tax,taxi,tc,tci,td,tdk,team,tech,technology,tel,telecity,telefonica,temasek,tennis,teva,tf,tg,th,thd,theater,theatre,tiaa,tickets,tienda,tiffany,tips,tires,tirol,tj,tjmaxx,tjx,tk,tkmaxx,tl,tm,tmall,tn,to,today,tokyo,tools,top,toray,toshiba,total,tours,town,toyota,toys,tp,tr,trade,trading,training,travel,travelchannel,travelers,travelersinsurance,trust,trv,tt,tube,tui,tunes,tushu,tv,tvs,tw,tz,ua,ubank,ubs,uconnect,ug,uk,um,unicom,university,uno,uol,ups,us,uy,uz,va,vacations,vana,vanguard,vc,ve,vegas,ventures,verisign,vermögensberater,vermögensberatung,versicherung,vet,vg,vi,viajes,video,vig,viking,villas,vin,vip,virgin,visa,vision,vista,vistaprint,viva,vivo,vlaanderen,vn,vodka,volkswagen,volvo,vote,voting,voto,voyage,vu,vuelos,wales,walmart,walter,wang,wanggou,warman,watch,watches,weather,weatherchannel,webcam,weber,website,wed,wedding,weibo,weir,wf,whoswho,wien,wiki,williamhill,win,windows,wine,winners,wme,wolterskluwer,woodside,work,works,world,wow,ws,wtc,wtf,xbox,xerox,xfinity,xihuan,xin,xperia,xxx,xyz,yachts,yahoo,yamaxun,yandex,ye,yodobashi,yoga,yokohama,you,youtube,yt,yu,yun,za,zappos,zara,zero,zip,zippo,zm,zone,zuerich,zw".split(","),"бг,бел,дети,ею,католик,ком,мкд,мон,москва,онлайн,орг,рус,рф,сайт,срб,укр".split(","),"qxam,90ae,90ais,d1acj3b,e1a4c,80aqecdr1a,j1aef,d1alf,l1acc,80adxhks,80asehdb,c1avg,p1acf,p1ai,80aswg,90a3ac,j1amh,80ao21a,y9a3aq,9dbq2a,mgbca7dzdo,mgba3a3ejt,mgbayh7gpa,lgbbat1ad8j,mgberp4a5d4ar,mgba7c0bbn0a,mgbc0a9azcg,mgb2ddes,mgbaam7a8h,mgba3a4f16a,mgbbh1a,mgbab2bd,ngbe9e0a,mgbbh1a71e,pgbs0dh,mgbpl2fh,ogbpf8fl,ngbc5azd,mgbtx2b,mgb9awbf,ygbi2ammx,wgbl6a,mgbi4ecexp,fhbei,wgbh1c,mgbx4cd0ab,mgbb9fbpob,4gbrim,mgbt3dhd,mgbai9azgqp6j,mgbgu82a,11b4c3d,c2br7g,h2brj9c,h2breg3eve,h2brj9c8c,i1b6b1a6a2e,54b7fta0cc,45brj9c,45br5cyl,s9brj9c,gecrj9c,3hcrj9c,xkc2dl3a5ee0h,xkc2al3hye2a,clchc0ea0b2g2a9gcd,fpcrj9c3d,2scrj9c,rvc1e0am3e,fzc2c9e2c,42c2d9a,o3cw4h,node,q9jyb4c,gckr3f0f,qcka1pmc,tckwe,cck2b3b,1ck2e1b,bck1b9a5dre4c,eckvdtc9d,rhqv96g,fiq64b,fiqs8s,fiqz9s,fiq228c5hs,vhquv,1qqw23a,vuq861b,nyqy26a,45q11c,55qx5d,55qw42g,kprw13d,kpry57d,czru2d,czrs0t,czr694b,w4rs40l,w4r85el8fhu5dnra,3ds443g,3oq18vl8pn36a,pssy2u,tiq49xqyj,fjq720a,fct429k,estv75g,xhq521b,9krt00a,30rr7y,6qq986b3xl,kput3i,kpu716f,zfr164b,mxtq1m,yfro4i67o,efvy88h,9et52u,rovu88b,nqv7f,b4w605ferd,unup4y,mix891f,mix082f,3pxu8k,pbt977c,6frz82g,nqv7fs00ema,ses554g,hxt814e,5tzm5g,io0a7i,8y0a063a,jlq61u9w7b,flw351e,g2xx48c,gk3at1e,3bst00m,fzys8d69uvgm,kcrx77d1x4a,jvr189m,imr513n,5su34j936bgsg,j6w193g,t60b56a,mk1bu44c,cg4bki,3e0b707e".split(",").map(function(e){return"xn--"+e})),D=T.reduce(function(e,t){return Math.max(e,t.length)},0),A=new RegExp("([a-zA-Zа-яА-Я\\-_\\.0-9\\+]+@(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})))","ig"),S=new RegExp("(https?:\\/\\/)?(((?:[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\—\\-\\_]+\\.){1,5})([A-Za-z\\$а-яА-Я\\-\\d]{2,22})(?:\\:(\\d{2,5}))?)(([\\/?#])(?:\\&amp;|\\&#\\d{2,6};|,[_%]|!|,*[\\wА-Яа-я\\xa8\\xb8\\xc0-\\xffєЄҐґЇїІіЈј\\—\\-\\_@#%?+\\/\\$.~=;:'ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢄᢇ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ　-〿＀-￯*]+|(?:\\(|\\[)[\\w\\$А-Яа-яёЁєЄҐґЇїІіЈј\\d&#%;,]+(?:\\)|\\])){0,200})?","ig"),E="(^|[s.,:'\";>)(]?)((#(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?))(?:[a-zA-Zа-яА-ЯёіјєїґўЁІЈЄЇҐЎ’_\\d]|(?:&#(?:19[2-9]|(?:[2-9]|1[0-3])[0-9][0-9]);?)){0,100}))(@((?:[a-z0-9_]*[a-z0-9])?(?:(?:.[a-z](?:[a-z0-9_]+[a-z0-9])?)*.[a-z][a-z0-9_]{2,40}[a-z0-9])?))?(?=$|[s.,:'\"&;?<)(]?)"},lJdi:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"d",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"l",function(){return y}),n.d(t,"f",function(){return j}),n.d(t,"e",function(){return k}),n.d(t,"h",function(){return O}),n.d(t,"i",function(){return w}),n.d(t,"j",function(){return I}),n.d(t,"g",function(){return x}),n.d(t,"k",function(){return P}),n.d(t,"m",function(){return D}),n.d(t,"n",function(){return S});var r,i=n("rHUl"),a=n("aong"),o=n("P13b");function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=1,s=4,d=8,l=16,f="see_invite_link",m="change_invite_link",b="invite_user",_="pin_unpin",h="change_title",p="add_admin",g=(u(r={},f,32),u(r,m,32),u(r,p,l),u(r,b,c),u(r,_,s),u(r,h,d),r),v=1;function y(e,t,n){return T(e,f,t,n)}function j(e,t,n){return T(e,m,t,n)}function k(e,t,n,r){var o=Object(a.r)(e);return!S(Object(i.t)(o,n||o.peer),t)&&T(e,p,n,r)}function O(e,t,n){return T(e,b,t,n)}function w(e,t,n,r){var u=Object(a.r)(e);if(function(e,t){var n=Object(a.r)(e);return void 0!==n.service&&(n.service&t)>0}(e,v))return!0;var c=Object(i.t)(u,n||u.peer);return!(c.data.kicked&&!c.data.closed)&&(!Object(o.pb)(e,n)&&(!S(c,t)&&(!!S(c,r=void 0===r?window.vk.id:r)||(A(c,r)?!A(c,t):function(e,t){return-1!==e.invitedByMe.indexOf(t)}(c,t)&&!A(c,t)))))}function I(e,t,n){return T(e,_,t,n)}function x(e,t,n){return T(e,h,t,n)}function P(e,t,n){return!Object(i.C)(n)||!!Object(i.t)(e,t).caccess[n]}function T(e,t,n,r){var u=Object(a.r)(e);r=void 0===r?window.vk.id:r,n=void 0===n?u.peer:n;var c=Object(i.t)(u,n),s=!c.data.kicked&&!c.data.closed,d=g[t];if(Object(o.pb)(e,n))switch(t){case p:case b:return!1;case f:return s;default:return u.gid>0}switch(t){case f:case m:case p:return D(c,d)?A(c,r)&&s:S(c,r);case b:case _:case h:return D(c,d)?A(c,r)&&s:s}return!1}function D(e,t){return((e&&e.data&&e.data.flags||0)&t)>0}function A(e,t){return(e&&e.adminIds||[]).indexOf(+t)>-1}function S(e,t){return e.ownerId===t}},nyd8:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return u});var r=window,i=r.nav,a=r.extend;function o(e){var t=a({},i.objLoc,e);Object.keys(t).filter(function(e){return""===t[e]}).forEach(function(e){delete t[e]});var n=i.toStr(t);i.setLoc(n)}function u(){var e={};return{scheduleNav:function(t){e=a(e,t)},commitNav:function(){o(e),e={}},scheduleNavWithTimeOut:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;e=a(e,t),setTimeout(function(){o(e),e={}},n)}}}},p3re:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return l}),n.d(t,"d",function(){return b}),n.d(t,"a",function(){return _}),n.d(t,"b",function(){return h});var r=n("h++7"),i=void 0,a=window,o=a.clean,u=a.replaceEntities,c=a.statlogsValueEvent;function s(e,t){for(var n=void 0,i=0,a=e;null!==(n=r.s.exec(e));){var o=(n=f(n))[0].length,u=n.index+o,c=e[n.index-1],s=e[u-1],d=void 0!==c&&/([\w\$А-Яа-яёЁєЄҐґЇїІіЈј\—\-\_@;.])/i.test(c),l=void 0!==s&&/([:;$])/i.test(s);if(!d&&!l){var b=m(n),_=b.domain.toLowerCase();if(_.length<=r.p&&-1!==r.y.indexOf(_)){var h=t(b);a=a.slice(0,n.index+i)+h+a.slice(u+i),i+=h.length-o}}}return a}function d(e,t){return e.replace(r.c,t||function(e){return'<a href="mailto:'+e+'">'+e+"</a>"})}function l(e,t){return e.replace(r.q,t||function(e,t,n,r,i){return'<a href="/'+(t+n)+'" class="mem_link" mention="'+o(r||"")+'" mention_id="'+o(t+n)+'" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)">'+i+"</a>"})}function f(e){if(!e[0]||!e[6])return e;var t=e[0].length-1,n=e[6].length-1;return"."===e[0][t]&&"."===e[6][n]&&(e[0]=e[0].slice(0,t),e[6]=e[6].slice(0,n)),e}function m(e){return{full:e[0],protocol:e[1]||"http://",url:e[2],domain:e[4],query:e[6]||""}}function b(e,t){return e.replace((i||(i=new RegExp(r.x,"ig")),i),function(e,n,r,i,a,o){return(n||"")+t(r+(a||""))})}function _(e){c("ttl_message_confirm_delivery",e)}function h(e,t){var n=t.protocol,i=t.url,a=t.query,c=t.domain,s=t.full;try{s=decodeURIComponent(s)}catch(e){}if(s.length>55&&(s=s.substr(0,53)+".."),s=o(s).replace(/&amp;/g,"&"),!e&&c.match(r.t)){var d,l=i=u(i).replace(r.f,encodeURIComponent),f=i.indexOf("#/"),m="";return f>=0?l=i.substr(f+1):(f=i.indexOf("#!"))>=0&&(l="/"+i.substr(f+2).replace(/^\//,"")),(d=l.match(r.B))&&d[1].length<32&&(m=' mention_id="'+d[1]+'" onclick="return mentionClick(this, event)" onmouseover="mentionOver(this)"'),'<a href="'+function(e){return e.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}(n+i+a)+'" target="_blank" rel="noopener"'+m+">"+s+"</a>"}return'<a href="'+("away.php?utf=1&to="+encodeURIComponent(n+u(i+a)))+'" target="_blank" rel="noopener" onclick="'+("return goAway('"+o((n+i+a).replace(/'/g,"\\'"))+"', {}, event);")+'">'+s+"</a>"}},rHUl:function(e,t,n){"use strict";n.d(t,"h",function(){return d}),n.d(t,"K",function(){return l}),n.d(t,"o",function(){return f}),n.d(t,"f",function(){return m}),n.d(t,"j",function(){return b}),n.d(t,"t",function(){return _}),n.d(t,"g",function(){return h}),n.d(t,"s",function(){return p}),n.d(t,"n",function(){return g}),n.d(t,"b",function(){return v}),n.d(t,"J",function(){return y}),n.d(t,"l",function(){return j}),n.d(t,"k",function(){return k}),n.d(t,"P",function(){return O}),n.d(t,"d",function(){return w}),n.d(t,"m",function(){return I}),n.d(t,"q",function(){return x}),n.d(t,"z",function(){return P}),n.d(t,"G",function(){return T}),n.d(t,"D",function(){return D}),n.d(t,"B",function(){return A}),n.d(t,"y",function(){return S}),n.d(t,"e",function(){return E}),n.d(t,"I",function(){return C}),n.d(t,"E",function(){return z}),n.d(t,"O",function(){return q}),n.d(t,"F",function(){return M}),n.d(t,"w",function(){return N}),n.d(t,"N",function(){return B}),n.d(t,"C",function(){return H}),n.d(t,"A",function(){return L}),n.d(t,"a",function(){return F}),n.d(t,"L",function(){return R}),n.d(t,"r",function(){return U}),n.d(t,"M",function(){return J}),n.d(t,"H",function(){return Q}),n.d(t,"p",function(){return Z}),n.d(t,"c",function(){return K}),n.d(t,"x",function(){return V}),n.d(t,"i",function(){return X}),n.d(t,"u",function(){return W}),n.d(t,"v",function(){return $}),n.d(t,"Q",function(){return G}),n.d(t,"R",function(){return Y});var r=n("MhhX"),i=n("f01n"),a=n("h++7"),o=n("86+7"),u=n("rjmT"),c=n("aong"),s=n("lJdi");function d(e,t){var n=Object(c.r)(e),i=n.tabs[n.peer];return Object.keys(i.msgs).filter(function(n){var a=I(e,t,n);return!Object(r.k)(a)&&intval(n)>i.in_up_to})[0]}function l(e){return Object(c.r)(e).searchShown}function f(e){return Object(c.r)(e).peer}function m(e){return b(e,f(e))}function b(e,t){return(_(e,t)||{}).keyboard}function _(e,t){var n=Object(c.r)(e);return n.tabs&&n.tabs[t]}function h(e){var t=Object(c.r)(e);return t.peer?t.tabs[t.peer]:null}function p(e){return Object(c.r)(e).selectedMessages}function g(e,t,n){var i=_(e,t),a=p(e)[0];if(void 0===a)return[n];var o=Math.min(n,a),u=Math.max(n,a);return Object.keys(i.msgs).filter(function(e){return e>=o&&e<=u}).filter(function(t){var n=I(e,e.get().peer,t);return!Object(r.l)(n)&&!Object(r.e)(n)}).map(intval)}function v(e,t){var n=_(Object(c.r)(t),e),i=0;for(var a in n.msgs)if(n.msgs.hasOwnProperty(a)){var o=I(t,e,a);Object(r.k)(o)||(i+=Object(r.n)(n,o)?1:0)}return i}function y(e,t,n){return!!function(e,t,n){var r=_(e,t);return Object.keys(r.msgs).filter(function(r){return intval(I(e,t,r).randomId)===n}).length>0}(e,t,n)}function j(e,t){var n=Object(c.r)(e),r=n.msg_local_ids_sort&&n.msg_local_ids_sort[t];return void 0!==r?2e9+r:t}function k(e,t,n){var r=_(e,t),a=I(e,t,n),o=Object.keys(r.msgs).filter(function(n){var r=I(e,t,n),o=r.local&&r.type!==i.g;return!(!a.local&&o)&&(!(!a.local||o)||j(e,a.messageId)>j(e,r.messageId))}).pop();return o?I(e,t,o):null}function O(e){return e&&e.length>0?i.Z([0].concat(e)):e}function w(e,t,n){var i=_(e,t),a=I(e,t,n),u=Object(c.r)(e);return Object(r.k)(a)?Object(o.c)(e,u.id).name:a.userId!==a.peerId?!!Object(o.b)(e,a.userId)&&Object(o.c)(e,a.userId).name:i.tab}function I(e,t,n){var r=_(e,t),i=r&&r.msgs&&r.msgs[n];return i?O(i):null}function x(e,t,n){var r=_(e,t),i=r&&r.msgs&&Object.keys(r.msgs).sort(function(e,t){return+e-t});if(!i)return null;var a=i&&i.indexOf(""+n),o=a>-1?i[a-1]:null;return r.msgs[o]}function P(e){var t=Object(c.r)(e);return t.gid||t.isClassic}function T(e){return Object(c.r)(e).gid}function D(e){return Object(c.r)(e).gid}function A(e){return!!Object(c.r)(e).gid}function S(e,t){return!!(t.peerId>2e9&&Object(s.m)(t,1024))}function E(e,t){var n=Object(c.r)(t);return n.tabs[e]||n.mapped_index[e]}function C(e){var t=Object(c.r)(e);return!!A(e)&&((19542789===t.gid||103416369==t.gid)&&(t.active_tab===a.n||t.active_tab===a.m))}function z(e,t){var n=(e=Object(c.r)(e)).tabs;return!(!n||!n[t]||void 0===n[t].history||!n[t].msgs)}function q(e,t){var n=_(e,t);n&&(n.msgs=void 0,n.msgid=void 0,n.scrollTop=void 0,n.scrollBottom=void 0,n.contHeight=void 0,n.offset=void 0,n.skipped=void 0)}function M(e){var t=e.get().go_to_end_visible;return!!t&&t[0]}function N(e){var t=e.get().go_to_end_visible;return t?t[1]:0}function B(e){return!Object(c.r)(e).lockedSending}function H(e){return e>-2e9&&e<0}function L(e,t){return!!H(t)&&!!_(e,t).blocked_community}function F(e){return Object(c.r)(e).voice_message_available}function R(e){var t=Object(c.r)(e);return!(!U(t)&&!t.recentSearch)}function U(e){return Object(c.r)(e).searchText}function J(e,t){var n=Object(c.r)(e);return!!(t&&t!==U(e)||n.recentSearch)}function Q(e){return Object(c.r)(e).recentSearch}function Z(e){var t=h(e);return t&&t.pinned&&O(t.pinned)}function K(e){var t=e.get().popular_sugg;return t&&t.length>0}function V(e){return 1==Object(c.r)(e).isEditing}function X(e){return Object(c.r)(e).gid}function W(e){return e.draft||(e.draft=Object(u.b)(cur.imDb,e.peerId)),e.draft}function $(e){return(Object(c.r)(e).templates||[]).filter(function(e){return!e.deleted})}function G(e){return e.is_message_request||e.folders&a.j[a.k]||e.folders&a.j[a.l]}function Y(e){return e.peerId>19e8&&e.peerId<2e9}},rjmT:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"b",function(){return s});var r=n("BxOC"),i=n("f01n"),a=n("vT4u"),o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function u(e,t){this._db=e,this._key=t,this.dData={txt:"",attaches:[],urlBinds:[],cancelled:[]},this.load()}function c(e){switch(e.type){case"mail":case"reply":return e.id<0&&1==e.object.fwd_count;default:return!e.object}}function s(e,t){return new u(e,"draft_"+t)}u.prototype.dump=function(){var e;this._key&&this._db.updateByKey(this._key,{txt:(e=this.dData).txt,attaches:e.attaches.length?e.attaches:void 0,urlBinds:e.urlBinds.length?e.urlBinds:void 0,cancelled:e.cancelled.length?e.cancelled:void 0})},u.prototype.load=function(){if(this._key){var e=this._db.selectByKey(this._key);e&&(this.dData=function(e){return{txt:e.txt,attaches:e.attaches||[],urlBinds:e.urlBinds||[],cancelled:e.cancelled||[]}}(e))}},u.prototype.clear=function(){this.dData={txt:"",attaches:[],urlBinds:[],cancelled:[]},this.dump()},u.prototype.setText=function(e){this.dData.txt=trim(e),this.dump()},u.prototype.addAttach=function(e,t,n){if(("share"===e&&this.removeAttachByType(e),"mail"!==e&&"reply"!==e||(this.removeAttachByType("mail"),this.removeAttachByType("reply")),"audio_playlist"===e||"artist"===e)&&this.dData.attaches.find(function(t){return t.type===e}))return!1;if(!e||!t&&"poll"!==e)return!1;var r=this.dData.attaches.findIndex(function(n){return n.type===e&&n.id===t});-1===r?(this.dData.attaches.push({type:e,id:t,object:n}),this.dump()):"video"!==e&&"poll"!==e||(this.dData.attaches[r]={type:e,id:t,object:n},this.dump())},u.prototype.syncWithSelector=function(e){var t=this,n=this.getFwdRaw();this.dData.attaches=(n?[n]:[]).concat(e.getMedias().map(function(e){var n=o(e,2),r=n[0],i=n[1];return t.dData.attaches.find(function(e){return e.type==r&&e.id==i})||{type:r,id:i}})),this.dump()},u.prototype.removeAttachByType=function(e){for(var t=this.dData.attaches.length;t--;)this.dData.attaches[t].type===e&&this.dData.attaches.splice(t,1);this.dump()},u.prototype.removeAllAttaches=function(){this.dData.attaches=[],this.dData.cancelled=[],this.dump()},u.prototype.addBindUrl=function(e,t,n){this.getBoundAttach(e)||(this.dData.urlBinds.push({url:e,type:t,id:n}),this.dump())},u.prototype.getBoundAttach=function(e){var t=this.dData.urlBinds.find(function(t){return t.url===e});return t&&this.dData.attaches.find(function(e){return e.type===t.type&&e.id===t.id})||null},u.prototype.getShareUrl=function(){var e=this.dData.attaches.find(function(e){return"share"===e.type});if(e&&e.object)return e.object.url},u.prototype.hasOnlyReplies=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?e.flags&i.k&&!this.dData.attaches.find(function(e){return"mail"!==e.type}):this.hasAttaches()&&!this.dData.attaches.find(function(e){return"reply"!==e.type})},u.prototype.getCancelledShares=function(){return this.dData.cancelled.length?this.dData.cancelled:void 0},u.prototype.hasAttaches=function(){return this.dData.attaches.length>0},u.prototype.destroy=function(){this.dData={},this._key=this._db=null},u.prototype.prepareObjects=function(e,t){var n=this;return this.dData.attaches.find(c)?Object(r.b)(a.e,{act:"draft_medias",gid:e,messageId:t||0,media:t?void 0:this.dData.attaches.map(function(e){return[e.type,e.id]}).join("*")}).then(function(e){var t=o(e,1)[0];n.dData.attaches=t.map(function(e){return{type:e[0],id:e[1],object:e[2]}})}):Promise.resolve()},u.prototype.getFwdRaw=function(){return this.dData.attaches.find(function(e){return"mail"===e.type||"reply"===e.type})},u.prototype.getFwdCount=function(){var e=this.getFwdRaw();return e?e.id<0?e.object.fwd_count:e.id.split(";").length:0}},uytb:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="recent_search",a="pin_hide";function o(e){return"im_store_"+e}function u(e){return ls.get(o(e))||{}}function c(e,t,n){if(ls.checkVersion()){var r=JSON.stringify(t);rand(0,1e5)<=1&&statlogsValueEvent("im_local_store_size",r.length),n(o(e),r)}}function s(e){var t=debounce(function(e,t){localStorage.setItem(e,t)},300);ls.checkVersion()&&function(e,t){for(var n=["fwd","draft","bind_attach"],r=u(e),i=!1,a=n.length;a--;)n[a]in r&&(delete r[n[a]],i=!0);i&&c(e,r,t)}(e,t);var n={db:u(e),checkTime:Date.now()},s=function(e,t,n){n.key===o(e)&&(t.db=JSON.parse(n.newValue),t.checkTime=Date.now())}.bind(null,e,n);return window.addEventListener("storage",s,!1),{select:function(t,r){return Date.now()-n.checkTime>1e3&&(n.db=u(e)),function(e,t,n){return t===i?e[t]||[]:t===a?e[t]&&e[t][n]:e[t]?extend(!0,{},e[t][n]):null}(n.db,t,r)},selectByKey:function(t){return Date.now()-n.checkTime>1e3&&(n.db=u(e)),n.db[t]},update:function(o,u){var s=function(e,t,n){switch(e[t]||(e[t]={}),t){case i:var o=n;o&&o.length>0?e[t]=o:delete e[t];break;case a:var u=r(n,2),c=u[0],s=u[1];s?e[t][c]=+s:delete e[t][c]}return e}(n.db,o,u);return n.db=s,n.checkTime=Date.now(),c(e,s,t)},updateByKey:function(r,i){return n.db[r]=i,n.checkTime=Date.now(),c(e,n.db,t)},unmount:function(){window.removeEventListener("storage",s,!1)}}}},vT4u:function(e,t,n){"use strict";n.d(t,"e",function(){return w}),n.d(t,"b",function(){return I}),n.d(t,"d",function(){return x}),n.d(t,"c",function(){return P}),n.d(t,"a",function(){return E}),n.d(t,"jb",function(){return C}),n.d(t,"Bc",function(){return N}),n.d(t,"Qc",function(){return B}),n.d(t,"sb",function(){return H}),n.d(t,"Vb",function(){return L}),n.d(t,"Jb",function(){return F}),n.d(t,"jc",function(){return U}),n.d(t,"kc",function(){return Q}),n.d(t,"p",function(){return Z}),n.d(t,"ad",function(){return K}),n.d(t,"oc",function(){return V}),n.d(t,"qb",function(){return X}),n.d(t,"mb",function(){return W}),n.d(t,"Fb",function(){return G}),n.d(t,"nb",function(){return Y}),n.d(t,"ob",function(){return ee}),n.d(t,"xc",function(){return te}),n.d(t,"Qb",function(){return ne}),n.d(t,"gd",function(){return oe}),n.d(t,"F",function(){return ue}),n.d(t,"h",function(){return ce}),n.d(t,"wb",function(){return de}),n.d(t,"xb",function(){return le}),n.d(t,"T",function(){return fe}),n.d(t,"Eb",function(){return me}),n.d(t,"yb",function(){return be}),n.d(t,"bd",function(){return _e}),n.d(t,"pc",function(){return he}),n.d(t,"Pc",function(){return pe}),n.d(t,"id",function(){return ge}),n.d(t,"lc",function(){return je}),n.d(t,"D",function(){return ke}),n.d(t,"C",function(){return Oe}),n.d(t,"j",function(){return we}),n.d(t,"t",function(){return Ie}),n.d(t,"E",function(){return xe}),n.d(t,"Pb",function(){return Pe}),n.d(t,"pb",function(){return Te}),n.d(t,"g",function(){return De}),n.d(t,"sc",function(){return Ae}),n.d(t,"vc",function(){return Se}),n.d(t,"rc",function(){return Ee}),n.d(t,"cc",function(){return Ce}),n.d(t,"dc",function(){return ze}),n.d(t,"ub",function(){return qe}),n.d(t,"ic",function(){return Ne}),n.d(t,"ec",function(){return Be}),n.d(t,"fc",function(){return He}),n.d(t,"Bb",function(){return Le}),n.d(t,"ib",function(){return Fe}),n.d(t,"gc",function(){return Re}),n.d(t,"X",function(){return Ue}),n.d(t,"Y",function(){return Je}),n.d(t,"m",function(){return Qe}),n.d(t,"v",function(){return Ze}),n.d(t,"hc",function(){return Ve}),n.d(t,"kb",function(){return Xe}),n.d(t,"eb",function(){return We}),n.d(t,"Nb",function(){return $e}),n.d(t,"Mb",function(){return Ge}),n.d(t,"Lb",function(){return Ye}),n.d(t,"Ob",function(){return et}),n.d(t,"Wb",function(){return tt}),n.d(t,"Xb",function(){return nt}),n.d(t,"f",function(){return it}),n.d(t,"Gb",function(){return at}),n.d(t,"nc",function(){return ot}),n.d(t,"mc",function(){return ut}),n.d(t,"K",function(){return ct}),n.d(t,"Cb",function(){return st}),n.d(t,"B",function(){return dt}),n.d(t,"I",function(){return lt}),n.d(t,"Sc",function(){return ft}),n.d(t,"gb",function(){return mt}),n.d(t,"i",function(){return bt}),n.d(t,"hb",function(){return _t}),n.d(t,"s",function(){return ht}),n.d(t,"rb",function(){return pt}),n.d(t,"Rc",function(){return gt}),n.d(t,"cb",function(){return yt}),n.d(t,"Zb",function(){return jt}),n.d(t,"Lc",function(){return kt}),n.d(t,"yc",function(){return Ot}),n.d(t,"uc",function(){return wt}),n.d(t,"G",function(){return It}),n.d(t,"Uc",function(){return xt}),n.d(t,"Zc",function(){return Pt}),n.d(t,"tb",function(){return Tt}),n.d(t,"J",function(){return Dt}),n.d(t,"qc",function(){return At}),n.d(t,"P",function(){return St}),n.d(t,"Db",function(){return Et}),n.d(t,"w",function(){return Ct}),n.d(t,"Yb",function(){return zt}),n.d(t,"Mc",function(){return qt}),n.d(t,"tc",function(){return Mt}),n.d(t,"V",function(){return Nt}),n.d(t,"fd",function(){return Bt}),n.d(t,"q",function(){return Ht}),n.d(t,"Tc",function(){return Lt}),n.d(t,"ac",function(){return Ft}),n.d(t,"H",function(){return Rt}),n.d(t,"o",function(){return Ut}),n.d(t,"Wc",function(){return Qt}),n.d(t,"Jc",function(){return Zt}),n.d(t,"vb",function(){return Kt}),n.d(t,"O",function(){return Vt}),n.d(t,"Hb",function(){return Xt}),n.d(t,"Hc",function(){return Wt}),n.d(t,"y",function(){return $t}),n.d(t,"Ub",function(){return Gt}),n.d(t,"Ac",function(){return Yt}),n.d(t,"dd",function(){return en}),n.d(t,"W",function(){return tn}),n.d(t,"u",function(){return nn}),n.d(t,"Cc",function(){return rn}),n.d(t,"Xc",function(){return an}),n.d(t,"Gc",function(){return on}),n.d(t,"Yc",function(){return un}),n.d(t,"Dc",function(){return cn}),n.d(t,"l",function(){return sn}),n.d(t,"zc",function(){return dn}),n.d(t,"Ic",function(){return ln}),n.d(t,"cd",function(){return fn}),n.d(t,"U",function(){return mn}),n.d(t,"Z",function(){return bn}),n.d(t,"M",function(){return _n}),n.d(t,"Rb",function(){return hn}),n.d(t,"db",function(){return pn}),n.d(t,"bc",function(){return gn}),n.d(t,"Sb",function(){return vn}),n.d(t,"Kb",function(){return yn}),n.d(t,"Ab",function(){return jn}),n.d(t,"Oc",function(){return kn}),n.d(t,"zb",function(){return On}),n.d(t,"Nc",function(){return wn}),n.d(t,"Q",function(){return In}),n.d(t,"N",function(){return xn}),n.d(t,"L",function(){return Tn}),n.d(t,"Vc",function(){return Dn}),n.d(t,"Ib",function(){return An}),n.d(t,"bb",function(){return Sn}),n.d(t,"ab",function(){return En}),n.d(t,"Fc",function(){return Cn}),n.d(t,"Ec",function(){return zn}),n.d(t,"r",function(){return qn}),n.d(t,"R",function(){return Mn}),n.d(t,"hd",function(){return Nn}),n.d(t,"S",function(){return Bn}),n.d(t,"k",function(){return Hn}),n.d(t,"fb",function(){return Ln}),n.d(t,"wc",function(){return Fn}),n.d(t,"z",function(){return Rn}),n.d(t,"Kc",function(){return Un}),n.d(t,"lb",function(){return Jn}),n.d(t,"n",function(){return Qn}),n.d(t,"A",function(){return Zn}),n.d(t,"x",function(){return Kn}),n.d(t,"ed",function(){return Vn}),n.d(t,"Tb",function(){return Xn});var r=n("BxOC"),i=n("nyd8"),a=n("f01n"),o=n("DM26"),u=n("aong"),c=n("uytb"),s=n("P13b"),d=n("h++7"),l=n("rHUl"),f=n("MhhX"),m=n("86+7"),b=n("ERyv"),_=n("Wu9C"),h=n("lJdi"),p=n("O8ze"),g=n("zxIV"),v=n("XzvV"),y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var w="al_im.php",I=5,x="typing",P="audiomessage",T=Object(i.a)(),D=T.scheduleNav,A=T.commitNav,S=T.scheduleNavWithTimeOut;var E={settings:0,block:1,fav:1,chat:2,invite:2,invite_link:3,topic:3,avatar:4,photos:5,search:6,pin_hide:7,pin_unhide:7,unpin:8,mute:10,unmute:10,clear:11,leave:12,return:12,block_community:12,allow_community:12,block_notify:12};function C(e,t,n){return Object(r.b)(w,{act:"a_renew_hash",peers:e.join(","),gid:t.hidegid?void 0:n.gid})}function z(e,t,n){return function(e){return e.resync_in_process?e.resync_in_process:Promise.resolve(!1)}(e).then(function(r){return r?t.apply(void 0,O(n)):function(e){if(!e.renew_hashes){var t=e.last_hashes_update||0;if(Date.now()-t<1e4)return Promise.resolve();var n=Object.keys(e.tabs).filter(function(t){return Object(s.ob)(e,t)});e.renew_hashes=C(n,{},e).then(function(t){var r=j(t,2),i=r[0],a=r[1];return n.forEach(function(t){e.tabs[t].hash=i[t]}),e.writeHash=a,delete e.renew_hashes,e.last_hashes_update=Date.now(),e})}return e.renew_hashes}(e).then(function(e){return t.apply(void 0,O(n))})})}function q(e){return function(){var t=arguments,n=t[t.length-1];return e.apply(void 0,O(t)).catch(function(r){if(r&&r.match&&r.match(/1001;/))return z(n,e,t);throw r})}}function M(e){return"string"==typeof e?Object(g.mb)("<div>"+e+"</div>"):e}function N(e){return"string"==typeof e?e:e.innerHTML}function B(e,t){return t.block_states=extend(t.block_states,e),Promise.resolve(t)}function H(e,t,n,i,a){return a.tabHistoryNotChanged=!1,Object(o.e)(r.b,3,function(e){return e-1})(w,{act:"a_start",peer:e,msgid:n,history:t,prevpeer:a.prevPeer,gid:a.gid,block:i}).then(function(t){var r=j(t,5),i=r[0],o=r[1],u=r[2],c=r[3],d=r[4];if(o.forEach(function(e){return Object(m.a)(a,e)}),a.tabs||(a.tabs={}),a.dialog_tab_cts=d,a.tabs[e]||(a.tabs[e]=Object(s.Kb)(a,i)),B(c,a),n){if(a.tabs[e]){var l=a.tabs[e].lastmsg,f=a.tabs[e].lastmsg_meta;extend(a.tabs[e],i),a.tabs[e].lastmsg=l,a.tabs[e].lastmsg_meta=f}}else extend(a.tabs[e],i);return a.admins=extend(a.admins,u),a.imQueue(e,!1),Nn(),L(e,a)}).catch(function(e){return Object(b.a)("loadPeer",e)})}function L(e,t){var n=t.imQueue(e,!1),r=t.tabs[e],i=n.filter(function(n){return!Object(l.J)(t,e,n.rid)});return r.msgs=i.reduce(function(e,t){return e["rid"+t.rid]=t.mess,e},r.msgs),t.imQueueSet(e,i),t.tabs[e].history=Object(s.hc)(i,t,M(t.tabs[e].history)),Promise.resolve(t)}function F(e,t,n){var r=n.imQueue(e,!1).filter(function(e){return e.failed&&e.mess.messageId!==t});return n.imQueueSet(e,r),n.tabs[e].history=Object(s.Mb)([t],M(n.tabs[e].history)),Promise.resolve(n)}function R(e,t){return!1===(t.block_states[e]||{}).free?Promise.resolve(t):Object(r.b)(w,{act:"a_block",peer:e,prevPeer:t.prevPeer,gid:t.gid}).then(function(e){return B(j(e,1)[0],t)})}function U(e,t){var n=t.peer;return Promise.resolve(t).then(function(t){return t.tabHistoryNotChanged=!1,Object(s.ob)(t,n)&&!t.tabs[n].msgid?(t.gid&&R(n,t),Promise.resolve(t).then(V)):(Object(s.ob)(t,n)&&(t.tabs[n].msgid=!1),H(n,e,!1,!0,t))}).then(V).then(J.bind(null,n))}function J(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(s.Bb)(t,e)&&(t.tabs[e].last_touched=Date.now()),Object(s.Bb)(t,e)&&n&&(t.tabs[e].last_visited=Date.now()),t}function Q(e,t,n){var r=n.msgid,i=n.peer;return!e&&Object(s.ob)(n,i)&&n.tabs[i].msgs[r]?(t===n.peer?n.tabHistoryNotChanged=!0:n.tabHistoryNotChanged=!1,n.gid&&R(i,n),Promise.resolve(n).then(V).then(J.bind(null,i))):H(i,!0,r,!0,n).then(V).then(function(){return Object(l.t)(n,i).msgid=r,n}).then(J.bind(null,i))}function Z(e,t,n,r){if(Nt(r))throw Object(s.Ac)(),new Error("Cant change peer while loading something");var i=r.gid?"gim"+r.gid:"im";if(r.prevPeer=r.peer,r.peer=e,r.msgid=t||"",r.currentEntryPoint=n,cur.peer=e,D({sel:e?Object(s.H)(e):null,msgid:r.msgid,email:"",0:i}),0!=r.prevPeer&&J(r.prevPeer,r,!0),0!==e){Object(s.Bb)(r,e)&&J(e,r,!0),en(r.tabbedPeers.map(function(e){return e.peer}).indexOf(e)<0?[{peer:e,type:"perm"}].concat(r.tabbedPeers):r.tabbedPeers.map(function(t){return t.peer==e&&"perm"!==t.type&&(t.type="perm"),t}),!1,r)}else en(r.tabbedPeers,!1,r);return A(),Qe(r.prevPeer,r)}function K(e){cur.wallMentions=function(){return new Promise(function(t,n){if(cur.wallMentions=[],!Object(s.hb)(e.peer)||!Object(s.ob)(e,e.peer)||Object(s.pb)(e,e.peer))return n();var r=e.tabs[e.peer];function i(){var n=[];Object.keys(r.msgs||{}).reverse().forEach(function(e){var t=Object(l.P)(r.msgs[e]),i=t&&t.userId;i&&i!=vk.id&&-1===n.indexOf(i)&&Object(s.Eb)(r,i)&&n.push(i)}),(r.memberIds||[]).forEach(function(e){-1===n.indexOf(e)&&n.push(e)});var i=[];n.forEach(function(t){if(Object(m.b)(e,t)){var n=Object(m.c)(e,t),r=n.link.substring(1);i.push([n.id,n.name,"@"+r,n.photo,void 0,void 0,void 0,r,n.first_name])}}),t(i)}r.membersLoaded?i():Pn(e.peer,e).then(i)})}}function V(e){var t=e.peer;if(0===t)return Promise.resolve(e);var n=e.tabs[t],r=[],i=Object(s.hb)(t)&&(n.data.closed||n.data.kicked),a=Object(s.pb)(e,t);n.offset&&r.push("photos"),n.offset&&r.push("search"),(t<-2e9||n.offset)&&!a&&r.push("clear"),Object(s.jb)(e)&&!a&&r.push("block"),a&&!i&&r.push("settings"),Object(s.kb)(t)&&(n.can_send_notify?r.push("block_notify"):r.push(n.blocked_community?"allow_community":"block_community")),(Object(s.hb)(t)||Object(s.Fb)(t)||Object(s.kb)(t))&&!Object(s.jb)(e)&&(Object(s.hb)(t)&&(n.data.kicked||n.data.closed)||r.push(inArray(t,e.mutedPeers)?"unmute":"mute")),Object(s.Fb)(t)&&!e.gid&&!n.blacklisted&&n.is_friend&&r.push("invite"),Object(s.hb)(t)&&!i&&(Object(h.h)(e)&&r.push("invite"),e.gid||r.push("leave")),Object(s.hb)(t)&&n.data.closed&&!n.data.kicked&&r.push("return"),Object(s.hb)(t)&&n.pinned&&(r.push(Object(_.a)(e,t)?"pin_hide":"pin_unhide"),Object(h.j)(e)&&r.push("unpin"));var o=Object(s.D)(e,a);return e.curActions=r.sort(function(e,t){return E[e]-E[t]}).reduce(function(e,t){return e[t]=o[t],e},{}),Promise.resolve(e)}function X(e,t,n){var i=n.tabs[n.peer];return Object(r.b)(w,{peer:n.peer,whole:e,act:"a_history",offset:i.offset+(i.skipped||0),toend:t,gid:n.gid}).then(function(e){var t=j(e,4),r=t[0],a=t[1],o=t[2],u=t[3];return i.allShown=o,n.admins=extend(n.admins,u),i.history=r+N(i.history),i.historyToAppend=r,i.offset+=Object.keys(a).length,i.msgs=extend(i.msgs,a),n})}function W(e){var t=e.tabs[e.peer];return Object(r.b)(w,{peer:e.peer,act:"a_history",rev:1,offset:t.skipped,gid:e.gid}).then(function(n){var r=j(n,5),i=r[0],a=r[1],o=r[2];r[3],r[4];t.allShown=t.allShown||o,t.history=N(t.history)+i,t.historyToAppend=i;var u=Object.keys(a).length;return t.skipped-=u,t.offset+=u,t.msgs=extend(t.msgs,a),e})}function $(e,t,n,r){var i=e.tabs[t];return r===a.m&&i.out_up_to>n?e:(r===a.m?i.out_up_to=n:i.in_up_to=n,e)}var G=q(function(e,t){if(Object(s.Fc)(t.tabs[e]))return Promise.resolve(t);var n=t.tabs[e],i=n.msgs||{},o=Object.keys(i).map(function(n){return Object(l.m)(t,e,n)}).filter(function(e){return!Object(f.k)(e)}).map(function(e){return e.messageId}).sort(function(e,t){return t-e});return n.skipped>0&&(o=o.filter(function(e){return intval(e)<=n.lastmsg-n.skipped})),(o=intval(o.shift()))<=n.in_up_to?Promise.resolve(t):(t.longpoll.push([a.pb([6,e,o])]),Object(r.b)(w,{peer:e,ids:[o],hash:n.hash,act:"a_mark_read",gid:t.gid}).then(function(){return $(t,e,o,a.m)}))});function Y(e){return Object(r.b)(w,{act:"a_get_key",uid:e.id,gid:e.gid}).then(function(t){var n=j(t,3),r=n[0],i=n[1],a=n[2];return extend({},e,{imKey:r,imUrl:i,imPart:a})})}function ee(e){return Object(r.b)(w,{act:"a_get_ts",gid:e.gid}).then(function(t){var n=j(t,1)[0];return extend({},e,{imTs:n})})}function te(e,t,n){var r=n.tabs[e];return r.msgs[t.messageId]&&(r.msgs[t.messageId].errored=1,r.history=Object(s.kc)(e,t,M(r.history))),Promise.resolve(n)}function ne(e,t,n,r){var i=r.tabs[e];return i.msgs[t]&&(i.msgs[t].errored=0,i.lastmsg_meta=n,i.lastmsg=t,i.history=Object(s.Dc)(e,t,M(i.history))),Promise.resolve(r)}function re(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t.deletedDialog||(e.dialog_tabs=Object.keys(e.dialog_tabs).reduce(function(e,a){return!n&&!Rt(a)(t)||i&&!i(a,e[a],t)||(e[a]=Object(u.a)(r(e[a],a))),e},e.dialog_tabs))}function ie(e,t){if(!inArray(e,t.tabbedPeers.map(function(e){return e.peer}))&&(0!==t.peer||t.searchText)&&!inArray(e,t.mutedPeers)){var n={peer:e,type:"temp"};en(t.tabbedPeers.concat([n]),!1,t)}}function ae(e,t,n){return Object(s.zb)(n)?t.concat([e]):[e].concat(t)}function oe(e,t){var n=e.get().peer,r=Object(l.t)(e,n);if(Object(s.ob)(e,n)){var i=M(r.history);r.history=Object(s.Jc)(e,i,t)}}function ue(e,t){var n=Object(l.t)(t,e.peerId);if(Object(s.ob)(t,e.peerId)){var r=M(n.history);n.msgs[e.messageId]=extend(!0,{},e),n.history=Object(s.J)(t,e,r)}n&&n.lastmsg==e.messageId&&(n.lastmsg_meta=e);var i=n&&n.pinned&&Object(l.P)(n.pinned);return i&&i.messageId==e.messageId&&(n.pinned=e),Promise.resolve(t)}function ce(e,t){var n=e.flags&a.m,r=e.peerId;if(Object(s.Bb)(t,r)){var i=t.tabs[r];if(i.deletedDialog=!1,!t.msg_local_ids_sort&&e.local?t.msg_local_ids_sort=k({},e.messageId,0):e.local&&(t.msg_local_ids_sort[e.messageId]=Object.keys(t.msg_local_ids_sort).length),n?i.unread=0:(i.lastmsg==e.messageId&&i.unread?se(t,1,e.peerId):(!i.unread&&se(t,1,e.peerId),i.unread++),ie(e.peerId,t)),Object(s.ob)(t,r)){var o=M(i.history);i.skipped>0&&i.skipped++,i.offset++,i.msgs[e.messageId]=extend(!0,{},e),i.history=Object(s.x)(t,e,o,!0,!0,!0),Object(f.k)(e)&&(i.blocked_community=0,V(t))}if(i.typing){var u=i.typing.userIds.indexOf(e.userId);u>=0&&i.typing.userIds.splice(u,1)}return i.lastmsg=e.messageId,i.lastmsg_meta=e,J(e.peerId,t),re(t,i,!1,ae.bind(null,r),Jt.bind(null,t)),Promise.resolve(t)}return H(r,0,0,0,t).then(function(t){return re(t,t.tabs[r],!1,ae.bind(null,r),Jt.bind(null,t)),J(e.peerId,t),n||ie(e.peerId,t),t})}function se(e,t,n){e.cur_unread_cnt||(e.cur_unread_cnt={}),-1===t&&delete e.cur_unread_cnt[n],e.unread_cnt+=t}function de(e,t){if(Object(s.ob)(t,e.peerId)){var n=t.tabs[e.peerId],r=n.unread;if(t=$(t,e.peerId,e.upToId,0),null!=e.unread?n.unread=e.unread:n.unread=e.upToId>=n.lastmsg?0:Object(l.b)(e.peerId,t)+(n.unread>0?+n.skipped:0),r>0&&!n.unread&&se(t,-1,e.peerId),!n.skipped){var i=M(n.history);n.history=Object(s.Pb)(t,i,e.peerId)}}else Object(s.Bb)(t,e.peerId)&&(t.tabs[e.peerId].unread>0&&se(t,-1,e.peerId),t.tabs[e.peerId].unread=0,t.tabs[e.peerId].in_up_to=e.upToId);return Object(s.Bb)(t,e.peerId)&&(t.dialog_tabs[d.m]=t.dialog_tabs[d.m].filter(function(t){return intval(t)!==e.peerId})),0!==t.unread_cnt||t.active_tab!==d.m||t.gid?Promise.resolve(t):Ut(d.h,t)}function le(e,t){var n=t.tabs[e.peerId];if(Object(s.Bb)(t,e.peerId)&&$(t,e.peerId,e.upToId,a.m),Object(s.ob)(t,e.peerId)){var r=M(n.history);n.history=Object(s.Jb)(t,e.peerId,r)}return Promise.resolve(t)}function fe(e,t,n,r,i){return i.text={},i.imQueue=e,i.imQueueResend=t,i.imQueueSet=n,i.imQueueComplete=r,Promise.resolve(i)}function me(e,t,n){function r(e,t){return{id:e.messageId,text:e.text,date:e.date,kludges:e.kludges,authorName:t}}if(1===e.length){var i=e[0],a=Object(l.m)(n,t,i),o=Object(l.d)(n,t,i);return!1===o?n.set(_t.bind(null,k({},t,[a.userId]))).then(function(n){var o=Object(l.d)(n,t,i);return{msgIds:e,object:r(a,o)}}):Promise.resolve({msgIds:e,object:r(a,o)})}return Promise.resolve({msgIds:e})}function be(e,t){Object(s.Lb)(t,e);var n=t.tabs[t.peer];return t.tabs=Object.keys(e).reduce(function(n,r){var i=t.tabs[r]?t.tabs[r].msgs:{},a=extend({},i||{},e[r].msgs||{});return n[r]=extend(t.tabs[r]||{},e[r]),a&&(n[r].msgs=a),e[r].lastmsg||(n[r].lastmsg=!1),n},t.tabs),n&&(t.tabs[t.peer]=n),Promise.resolve(t)}function _e(e,t,n,r){var i=Object(l.t)(r,e);if(i){var a=!1!==t?mobPlatforms[t]?1:0:i.last_seen[2];i.online=t,i.last_seen=[t,n||i.last_seen[1],a]}return Promise.resolve(r)}function he(e,t,n){var r=Object(l.t)(n,e.peerId);return r&&(e.ts=Date.now()/1e3,r.activity||(r.activity={}),r.activity[t]=e,r.typing===x&&(r.typing=e)),Promise.resolve(n)}function pe(e,t){var n=Object(l.t)(t,e.peerId),r=Object(f.d)(e)?"audiomessage":"typing";return n&&n.activity&&n.activity[r]&&(n.activity[r].userIds=n.activity[r].userIds.filter(function(t){return t!==e.userId})),Promise.resolve(t)}function ge(e,t,n){var r=e.peerId;return Object(o.c)(I+2).then(function(){if(Object(s.Bb)(n,r)){var e=n.tabs[r];if((e.activity||{})[t])Date.now()-1e3*e.activity[t].ts>=1e3*I&&(delete e.activity[t],0===Object.keys(e.activity)&&delete e.activity);if(e.typing)Date.now()-1e3*e.typing.ts>=1e3*I&&(e.typing=void 0)}return n})}function ve(e){var t={},n=e.find(function(e){return"poll"===e[0]});if(n){var r=j(n,3)[2];Object.assign(t,r)}return t}function ye(e){return e.map(function(e){var t="audiomsg"===e[2]?"audio_message":e[2];return e[0]+":"+e[1]+":"+t}).join(",")}var je=function(e,t,n,i){var a=Date.now()+rand(0,100).toFixed(0),o=i.ref_id,u=i.ref_source;i.ref_source=void 0,i.ref_id=void 0,(u||o)&&(D({ref_source:null,ref:null}),A()),Object(p.i)(i);var c=t.attaches.length>0,s=Object(p.k)(i,"send","server",c),d=Object.assign({act:"a_send",to:e,hash:n.hash,ref_source:u,ref:o,msg:t.message,payload:t.payload,media:ye(t.attaches),guid:a,share_url:t.share_url,cancelled_shares:t.cancelled_shares,random_id:t.rid,gid:n.hidegid?void 0:i.gid,entrypoint:i.currentEntryPoint||"",sticker_referrer:t.sticker_referrer},n.external,ve(t.attaches));return Object(r.b)(w,d,2e4).then(function(e){var t=j(e,1)[0];return s(),i.version!==t.version&&nav.reload({force:!0}),i.currentEntryPoint="",i}).catch(function(e){throw Object(p.h)(i,e,"send","server_send"),e})},ke=q(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],i=r.tabs[e];return je(e,t,y({hash:i.hash},n),r)}),Oe=q(function(e,t,n){var i=t.attaches.length>0,a=Object(p.k)(n,"edit","server",i);return Object(r.b)(w,Object.assign({act:"a_edit_message",hash:e.hash,id:t.messageId,peerId:e.peerId,gid:n.gid,msg:t.origText,media:ye(t.attaches),share_url:t.share_url,cancelled_shares:t.cancelled_shares},ve(t.attaches)),2e4).then(function(e){j(e,1)[0];return a(),n}).catch(function(e){throw Object(p.h)(n,e,"edit","server_send"),e})});function we(e,t){if(t.selectedMessages||(t.selectedMessages=[]),1===e.length&&inArray(e[0],t.selectedMessages))t.selectedMessages=t.selectedMessages.filter(function(t){return t!==e[0]});else{var n=t.selectedMessages.concat(e);t.selectedMessages=Object(u.a)(n).sort(function(e,t){return e-t})}return Promise.resolve(t)}function Ie(e){return e.selectedMessages=[],Promise.resolve(e)}function xe(e){return e.selectedMessages=[],Promise.resolve(e)}function Pe(e,t){if(Object(s.ob)(t,e.peerId)){var n=t.tabs[e.peerId],r=t.imQueue(e.peerId).filter(function(t){return t.failed&&t.rid!==e.randomId});t.imQueueSet(e.peerId,r),t.imQueueComplete(e.peerId,e.randomId),n.lastmsg_meta=e,n.lastmsg=e.messageId,n.msgs["rid"+e.randomId]&&(n.msgs[e.messageId]=e,delete n.msgs["rid"+e.randomId]),n.history=Object(s.ec)(t,M(n.history),e)}return Promise.resolve(t)}function Te(e,t){var n=Object(p.k)(t,"unknown","attach"),i={act:"a_get_media",id:e.messageId,gid:t.gid};return Object(o.e)(r.b,3,function(e){return e*e})(w,i).then(function(r){return n(),De(e,r,t)}).catch(function(n){return Object(p.h)(t,n,"unknown","server_load_attach"),De(e,null,t)})}function De(e,t,n){var r=n.tabs[e.peerId];return r.mediacontent||(r.mediacontent={}),r.mediacontent[e.messageId]=t||[getTemplate("im_retry_link")],function(e,t){var n=t.tabs[e.peerId];return n.history=Object(s.dc)(M(n.history),e,t),Promise.resolve(t)}(e,n)}function Ae(e,t,n){var r=Object(s.I)(t),i=n.tabs[e];return i.searchDay=r,i.searchOffset=0,i.searchAllLoaded=!1,Promise.resolve(n)}function Se(e,t,n){return n.tabs[t].searchText=e,Ke(t,n),n}function Ee(e,t,n){if(t){var r=n.tabs[t];r.searchText=e,r.searchOffset=0,r.searchAllLoaded=!1}else n.searchText=e,n.searchOffset=0,n.searchAllLoaded=!1;return Promise.resolve(n)}function Ce(e,t,n,i,a){var o=+new Date;return Object(r.b)(w,{act:"a_hints",str:e,gid:i.hidegid?0:a.gid,query:n,peerIds:t.join(",")}).then(function(e){var t=j(e,3),n=t[0],r=t[1];return B(t[2],a),r.forEach(function(e){return Object(m.a)(a,e)}),be(n,a),Object(v.b)("messages",o,n&&n.length),Object.keys(n).sort(function(e,t){return n[e].order-n[t].order}).map(function(e){return n[e]})})}function ze(e,t,n,r){return Ce(e,t,n,{},r).then(function(e){return e.map(function(e){return{peerId:e.peerId,name:e.tab,photo:e.photo,online:e.online,is_friend:"friends"===n}})})}function qe(e){var t={peerId:e[0],name:e[1],tab:e[1],photo:e[2],href:e[3],online:e[4],is_friend:e[5],local_index:!0};return e[6]&&(t.data={flags:e[6]}),t}function Me(e){return function(t,n){return e(n).then(function(e){var r=(t?e.search(t):e.list).map(qe);return n.mapped_index||(n.mapped_index={}),r.forEach(function(e){n.mapped_index[e.peerId]=e}),r})}}var Ne=Me(function(e){return e.topConvTree}),Be=Me(function(e){return e.imTopConvTree}),He=Me(function(e){return e.hintsTree});function Le(e,t){var n=void 0,i=void 0,a=void 0;t.topConvTree=new Promise(function(e){n=e}),t.hintsTree=new Promise(function(e){i=e}),t.imTopConvTree=new Promise(function(e){a=e});var u=e.select(c.b);return Object(o.e)(r.b,1,function(){return 4})(w,{act:"a_dialogs_preload",rs:u.join(","),gid:t.gid}).catch(function(e){return[[],[],[]]}).then(function(e){var r=j(e,4),o=r[0],u=r[1],c=r[2],s=r[3];return t.popular_sugg=c,new vkIndexer(o,function(e){return e[1]},n),new vkIndexer(u,function(e){return e[1]},i),s&&s.length>0?new vkIndexer(s,function(e){return e[1]},a):a(),t})}function Fe(e){var t=e.active_tab,n=void 0;return n=e.dialog_tabs[t].length>0?Math.min.apply(null,e.dialog_tabs[t].map(function(t){return e.tabs[t].lastmsg})):0,Object(r.b)(w,{act:"a_get_dialogs",start_message_id:n,tab:t,gid:e.gid}).then(function(n){var r=j(n,4),i=r[0],a=r[1],o=r[2],u=r[3];return o.forEach(function(t){return Object(m.a)(e,t)}),B(u,e),be(a,e),e.dialog_tabs[t]=e.dialog_tabs[t].concat(Object.keys(a).map(intval)),e.dialog_tabs_all[t]=!i.has_more,Promise.resolve(e)})}var Re=q(function(e,t){return Object(r.b)(w,{act:"a_search",q:e,from:"all",gid:t.gid,hash:t.writeHash,offset:t.searchOffset||0}).then(function(n){var r=j(n,5),i=r[0],a=r[1],o=r[2],u=r[3],c=r[4];return a.forEach(function(e){return Object(m.a)(t,e)}),Object(s.Lb)(t,i),e===t.searchText&&(t.searchOffset=u,t.searchAllLoaded=c),Object.keys(i).filter(function(e){return!t.tabs[e]}).forEach(function(e){t.tabs[e]=i[e]}),[i,o]})});function Ue(e,t){return t.tabs[e].searchAllLoaded}function Je(e,t){return!(t.peer!==e||!Object(s.ob)(t,e))&&t.tabs[e].inplaceSearch}function Qe(e,t){if(Object(s.ob)(t,e)){var n=t.tabs[e];delete n.inplaceSearch,delete n.searchOffset,delete n.searchAllLoaded,delete n.searchText,delete n.searchDay,D({st:""}),A()}return Promise.resolve(t)}function Ze(e,t){if(Object(s.ob)(t,e)){var n=t.tabs[e];delete n.searchDay,n.searchOffset=0,n.searchAllLoaded=!1}return Promise.resolve(t)}function Ke(e,t){return t.tabs[e].inplaceSearch=!0,Promise.resolve(t)}var Ve=q(function(e,t){var n=t.tabs[e],i="";if(Ke(e,t),n.searchDay&&(i="day:"+n.searchDay),!i&&!n.searchText)return Promise.reject();var a="in:"+e+" "+i+" "+(n.searchText||"");return D({st:n.searchText}),A(),Object(r.b)(w,{act:"a_search",q:a,from:"in",gid:t.gid,hash:t.writeHash,offset:n.searchOffset||0}).then(function(e){var t=j(e,3),r=t[0],i=t[1],a=t[2];return n.searchOffset=i,n.searchAllLoaded=a,r})});function Xe(e){return Object(r.b)(w,{act:"a_important",offset:e,part:e>0})}function We(e,t){var n=Object(l.t)(e,t);return Object(r.b)(w,{act:"a_load_lastmsg",peerId:t,gid:e.get().gid}).then(function(r){var i=j(r,2),a=i[0],o=i[1];n.lastmsg=a[0]||!1,n.lastmsg_meta=a;var u=j(o,3);n.unread=u[0],n.in_up_to=u[1],n.out_up_to=u[2],n.unread||(e.get().dialog_tabs[d.m]=e.get().dialog_tabs[d.m].filter(function(e){return e!=t})),re(e.get(),n,!1,ae.bind(null,t),Jt.bind(null,e.get()))})}function $e(e,t,n){if(Object(s.ob)(n,t)){var r=n.tabs[t];r.deleted=r.deleted?r.deleted.concat(e):e}return Promise.resolve(n)}function Ge(e,t,n){if(Object(s.ob)(n,t)){var r=n.tabs[t];r.history=Object(s.Mb)(e,M(r.history)),r.offset-=e.filter(function(e){return r.msgs[e]}).length,e.forEach(function(e){return delete r.msgs[e]}),e.forEach(function(e){var t=(n.selectedMessages||[]).indexOf(e);-1!=t&&n.selectedMessages.splice(t,1)})}return Promise.resolve(n)}var Ye=q(function(e,t,n,i,a){return Object(r.b)(w,{act:"a_mark",peer:t,hash:n||a.tabs[t].hash,gid:a.gid,msgs_ids:e.join(","),mark:i})});function et(e,t,n,r){if(Object(s.ob)(r,t)){var i=r.tabs[t];i.deleted=i.deleted?i.deleted.concat(e):e,i.history=Object(s.Nb)(e,t,n,M(i.history)),i.offset-=e.filter(function(e){return i.msgs[e]}).length}return Promise.resolve(r)}function tt(e,t,n){if(Object(s.ob)(n,t)){var r=n.tabs[t];r.deleted&&(r.deleted=r.deleted.filter(function(t){return t!==e})),r.history=Object(s.gc)(e,t,M(r.history)),r.offset++}return Promise.resolve(n)}function nt(e,t,n,i){return Object(r.b)(w,{act:"a_restore",id:e,peer:t,hash:n,gid:i})}var rt=q(function(e,t,n){return Object(s.Fc)(n.tabs[e])?Promise.resolve(n):(n.tabs[e].lastTyping=Date.now(),Object(r.b)(w,{act:"a_activity",type:t,peer:e,gid:n.gid,hash:n.tabs[e].hash}).then(function(){return n},function(){return n}))}),it=q(function(e,t){return Object(r.b)(w,{act:"a_accept_message_request",user_id:e,hash:t.tabs[e].hash}).then(function(){t.tabs[e].is_message_request=!1}).then(function(){return t})}),at=q(function(e,t){return Object(r.b)(w,{act:"a_reject_message_request",user_id:e,hash:t.tabs[e].hash}).then(function(){return re(t,t.tabs[e],!0,function(t){return t.filter(function(t){return t!==e})}),en(t.tabbedPeers.filter(function(t){return t.peer!==e}),!0,t),t.tabs[e].unread=0,t.tabs[e].lastmsg=!1,t.tabs[e].lastmsg_meta=null,t})}),ot=q(function(e,t){return rt(e,x,t)}),ut=q(function(e,t){return rt(e,P,t)});function ct(e,t,n,r){return t&&(r.pendingForward=null,e||(e={msgIds:[]}),t.addAttach(n?"reply":"mail",e.msgIds.join(";"),e.object||null)),Promise.resolve(r)}function st(e,t){return t.pendingForward=e,Promise.resolve(t)}function dt(e,t,n){if(Object(s.Bb)(n,e)){n.blockedFlagUpdates||(n.blockedFlagUpdates={}),n.blockedFlagUpdates[e]=!0,re(n,n.tabs[e],!0,function(t){return t.filter(function(t){return t!==e})}),n.tabs[e].unread>0&&se(n,-1,e);var r=n.tabs[e];return r.deletedDialog=!0,en(n.tabbedPeers.filter(function(t){return t.peer!==e}),!0,n),t.then(function(t){var i=j(t,2);i[0],i[1];return delete n.blockedFlagUpdates[e],r.msgs=null,r.history=null,r.unread=0,r.lastmsg=!1,r.lastmsg_meta=null,n})}}var lt=q(function(e,t){return dt(e,Object(r.b)("al_im.php",{act:"a_flush_history",id:e,from:"im",gid:t.gid,hash:t.tabs[e].hash}),t)}),ft=q(function(e,t,n){return Object(r.b)(w,{act:"a_set_chat_title",peer:e,new_title:t,gid:n.gid,hash:n.tabs[e].hash}).then(function(){return n})}),mt=q(function(e,t){return Object(r.b)(w,{act:"a_load_chat_info",peer:e,gid:t.gid,hash:t.tabs[e].hash}).then(function(n){var r=j(n,1)[0];return t.tabs[e]=extend(t.tabs[e],r),t})});var bt=q(function(e,t,n){return Object(r.b)(w,{act:"a_add_chat_members",peer:e,new_peer:t.join(","),gid:n.gid,hash:n.tabs[e].hash}).then(function(e){return n})});function _t(e,t){if(isEmpty(e))return Promise.resolve(t);var n=Object.keys(e).map(function(t){return t+":"+e[t].join(",")}).join(";");return Object(r.b)(w,{act:"a_load_member",need:n}).then(function(e){return j(e,1)[0].forEach(function(e){return Object(m.a)(t,e)}),t})}function ht(e,t,n){var r={},i=n.get();function o(e,t){Object(s.hb)(e)&&t&&!Object(m.b)(i,t)&&(r[e]?-1===r[e].indexOf(t)&&r[e].push(t):r[e]=[t])}var u=t.filter(function(e){return!Object(s.Bb)(i,e.peerId)}).map(function(e){return e.peerId});t.forEach(function(e){o(e.peerId,e.userId)}),e.forEach(function(e){o(e.peerId,+e.kludges.source_mid)});var c=t.filter(function(e){return e.flags&a.m&&!e.local}).map(function(e){return e.kludges.from_admin}).filter(function(e){return e&&!i.admins[e]});return 0===Object.keys(r).length&&0===c.length&&0===u.length?Promise.resolve(i):{shouldLoad:Object.keys(r).length>0||c.length>0||u.length>0,needMembers:r,needAdminIds:c,needPeers:u}}function pt(e,t,n){var i=e.needMembers,a=e.needAdminIds,o=e.needPeers;return t.pause(),Promise.all([_t(i,n),function(e,t){return 0===e.length?Promise.resolve(t):Object(r.b)(w,{act:"a_get_admin",admins:e.join(","),gid:t.gid}).then(function(e){var n=j(e,1)[0];return t.admins=extend(t.admins,n),t})}(a,n),Promise.all(o.map(function(e){return H(e,0,0,0,n)}))]).catch(function(){return n}).then(function(){return t.resume()}).then(function(){return n})}var gt=q(function(e,t){return e.kludges.source_act===s.d?(delete t.tabs[e.peerId].photo,delete t.tabs[e.peerId].photoLarge,Promise.resolve(t)):Object(r.b)(w,{act:"a_get_chat_photo",msg_id:e.messageId}).then(function(n){var r=j(n,2),i=r[0],a=r[1];t.chat_photo_msg=a;var o=t.tabs[e.peerId];if(t.tabs[e.peerId].photo=i[0],t.tabs[e.peerId].photoLarge=i[1],Object(s.ob)(t,e.peerId)){var u=e.kludges.source_act;o.history=Object(s.w)(e,u,t,M(o.history))}return t})});function vt(e,t,n,r){return t!==vk.id?Promise.resolve(r):(Object(s.Bb)(r,n)&&r.peer==n&&(r=V(r)),Promise.resolve(r))}var yt=q(function(e,t){return Object(r.b)(w,{act:"a_leave_chat",chat:e-2e9,gid:t.gid,hash:t.tabs[e].hash}).then(vt.bind(null,s.c,vk.id,e,t))}),jt=q(function(e,t){return Object(r.b)(w,{act:"a_return_to_chat",chat:e-2e9,gid:t.gid,hash:t.tabs[e].hash}).then(vt.bind(null,s.b,vk.id,e,t))}),kt=q(function(e,t,n){return Object(r.b)(w,{act:"a_mute",peer:e,hash:n.tabs[e].hash,gid:n.gid,value:t?1:0}).then(function(){var r=t?"mute":"unmute";return window.Notifier&&Notifier.lcSend("im",{act:r,peer:e}),n}).then(Ot.bind(null,e,t))});function Ot(e,t,n){var r=n.mutedPeers.filter(function(t){return t!==e});return t&&r.push(e),n.mutedPeers=r,cur.mutedPeers=n.mutedPeers,V(n)}function wt(e,t){return t.stack=e,Promise.resolve(t)}var It=q(function(e,t,n,i){return xt(e,n,t,i),Object(r.b)(w,{act:"a_mark_important",ids:e,val:t?1:0,from:"im",gid:i.gid,peer:n,hash:i.tabs[n].hash}).then(function(){return i})});function xt(e,t,n,r){if(Object(s.ob)(r,t)){var i=r.tabs[t];e.filter(function(e){return i.msgs[e]}).forEach(function(e){var o=Object(l.m)(r,t,e),u=n?o.flags|a.l:o.flags&~a.l;o.flags=u,i.msgs[e]=o,i.history=Object(s.Kc)(e,n,M(i.history))})}return Promise.resolve(r)}function Pt(e,t,n){return n.importants||(n.importants={}),(n.importants[t]||0)!==e&&(n.important_cnt+=e,n.importants[t]=e),Promise.resolve(n)}function Tt(e,t){return Object(r.b)(w,{act:"a_spam",offset:e,gid:t,part:e>0})}function Dt(e,t){return Object(r.b)(w,{act:"a_flush_spam",gid:t,hash:e})}function At(e,t,n){return n.creationType=e,n.creationFilter=t,Promise.resolve(n)}function St(e,t){return Object(r.b)(w,{act:"a_owner_photo",photo:JSON.parse(e).data[0],peer:t})}function Et(e,t){return t.next_chat_avatar=e,Promise.resolve(t)}var Ct=q(function(e,t,n,i){return i.creating=!0,i.longpoll.pause(),Object(r.b)(w,{act:"a_multi_start",hash:i.writeHash,peers:t.join(","),title:n}).then(function(e){var t=j(e,1)[0];return i.next_peer=t.peerId,i.tabs[t.peerId]=t,re(i,t,!1,function(e){return[t.peerId].concat(e)}),i.longpoll.resume(),i}).then(function(t){return e?function(e,t,n){return Object(r.b)("al_page.php",{act:"owner_photo_save",peer:e,_query:t}).then(function(e){return n})}(t.next_peer,e,t):t}).then(function(e){return e.creating=!1,e}).catch(function(e){throw i.creating=!1,i.longpoll.resume(),e})});function zt(e){var t=void 0;e.resync_in_process=new Promise(function(e){t=e});var n=Object.keys(e.tabs).length,i=e.active_tab;return Object(r.b)(w,{act:"a_resync",sel:e.peer,gid:e.gid,loaded:n,tab:i,add_peers:e.tabbedPeers.map(function(e){return e.peer}).join(",")}).then(function(n){var r=j(n,5),a=r[0],o=r[1],c=r[2],l=r[3],f=r[4];o.forEach(function(t){return Object(m.a)(e,t)}),Object(s.Lb)(e,a),c.user_unread&&handlePageCount("msg",c.user_unread),Object(u.i)("Resync success","success");var b=e.peer,_=void 0;if(Object(s.yb)(b))_=Promise.resolve(!1);else{var h={tabs:k({},b,e.tabs[b]),oCache:{}};_=be(k({},b,a[b]),h)}return _.then(function(n){e.tabs=a,e.admins=extend(e.admins,l),n&&(e.tabs[b]=n.tabs[b],e.tabs[b].history=Object(s.hc)(b,e,M(e.tabs[b].history))),e.loadingDialogs=!1,e.mutedPeers=c.mutedPeers,e.lastDialogsOptions={has_more:c.has_more},e.dialog_tab_cts=c.folder_cts,e.dialog_tabs[i]=f.map(intval);var r=e.dialog_tabs[i].map(function(t){return e.tabs[t]});return Object.keys(e.dialog_tabs).filter(function(e){return e!=i}).forEach(function(t){i==d.h?e.dialog_tabs[t]=r.filter(Rt(t)).map(function(e){return e.peerId}):e.dialog_tabs[t]=[]}),delete e.resync_in_process,setTimeout(t.bind(null,!0),0),Bt(intval(c.unread),e)})}).catch(function(t){return Object(u.i)("Resync error: "+t.message+" "+t.stack,"error"),Object(o.c)(2).then(zt.bind(null,e))})}function qt(e,t){return t.lockedSending=e,Promise.resolve(t)}function Mt(e,t,n){return e&&!n.delayed_message?(n.delayed_message=e,n.delayed_ts=t):e||(n.delayed_message=e,n.delayed_ts=t),Promise.resolve(n)}function Nt(e){return!!e.textMediaSelector.urlAttachmentLoading||!!(window.Upload&&Upload.options&&Upload.isSomethingUploading)&&Object.keys(Upload.options).filter(function(e){return Upload.isSomethingUploading(e)}).length>0}function Bt(e,t){return t.unread_cnt=e,t.dialog_tab_cts[d.m]=e,Promise.resolve(t)}function Ht(e,t){return t.ctrl_submit=!!e,Object(r.b)(w,{act:"a_save_ctrl_submit",to:t.peer,hash:t.tabs[t.peer].hash,value:e?1:0}).then(function(e){return t})}function Lt(e,t,n){n.cur_unread_cnt||(n.cur_unread_cnt={}),t&&!inArray(e,n.mutedPeers)&&(n.cur_unread_cnt[e]=!0);var r=document.title,i=window.devicePixelRatio>=2?"_2x":"";if(t&&!n.update_title_to){var a=function(e,t,n){return function(){n.update_old_title=e;var r=Object.keys(n.cur_unread_cnt).length;if(0===r)return Object(g.ob)(e||document.title),setFavIcon("/images/icons/favicons/fav_im"+t+".ico"),clearInterval(n.update_title_to),void(n.update_title_to=!1);e?(Object(g.ob)(e),setFavIcon("/images/icons/favicons/fav_im"+t+".ico"),e=!1):(e=document.title,setFavIcon("/images/icons/favicons/fav_im"+(r>9?10:r)+t+".ico"),Object(g.ob)(winToUtf(getLang("mail_im_new_messages",r))))}}(r,i,n);n.update_title_to=setInterval(a,1e3),a()}else!t&&n.update_old_title&&(Object(g.ob)(n.update_old_title),n.cur_unread_cnt={},r=!1,n.update_old_title=!1,setFavIcon("/images/icons/favicons/fav_im"+i+".ico"),clearInterval(n.update_title_to),n.update_title_to=!1);return Promise.resolve(n)}function Ft(e,t,n,r,i){return Object(s.ob)(i,e)&&(i.tabs[e].scrollTop=intval(t),i.tabs[e].scrollBottom=intval(n),i.tabs[e].contHeight=intval(r)),Promise.resolve(i)}function Rt(e){return e===d.h?function(e){return!Object(s.Fc)(e)}:e===d.m?function(e){return e.unread>0}:function(t){return t.folders&d.j[e]}}function Ut(e,t){t.active_tab=e,Object(i.b)({tab:e===d.h?null:e});var n=[];if(e!==d.h&&!Object(s.zb)(t)){var r=t.dialog_tabs[e];n=t.dialog_tabs[d.h].map(function(e){return t.tabs[e]}).filter(Rt(e)).map(function(e){return e.peerId}),t.dialog_tabs[e]=r.length>=n.length?r:n}return Promise.resolve(t)}function Jt(e,t,n,r){var i=e.dialog_tabs_all;return!(!i[d.h]&&!i[t])||(n.filter(function(e){return e===r.peerId}).length>0||("r"===r.lastmsg[0]||n.map(function(t){return e.tabs[t.toString()]}).filter(function(t){return Object(s.zb)(e)?t.lastmsg>r.lastmsg:t.lastmsg<r.lastmsg}).length>0))}function Qt(e,t,n,r,i){if(Object(s.Bb)(i,e)){var o=i.tabs[e];return n===a.L&&(t^=o.folders),function(e,t,n){return!(e===a.T&&n.folders&t||!(e!==a.P||n.folders&t))}(n,t,o)&&Object.keys(d.j).filter(function(e){return d.j[e]&t}).forEach(function(e){i.dialog_tab_cts[e]+=function(e,t,n){return t!==a.P||e.folders&d.j[n]?t===a.L?e.folders&d.j[n]?-1:1:t===a.T?1:-1:0}(o,n,e)}),n===a.T?i.tabs[e].folders|=t:n===a.P?i.tabs[e].folders&=~t:i.tabs[e].folders=t^=o.folders,re(i,i.tabs[e],!0,function(t,n){return t.concat([e]).map(function(e){return i.tabs[e]}).filter(Rt(n)).map(function(e){return e.peerId})},Jt.bind(null,i)),Promise.resolve(i)}return H(e,0,0,0,i).then(Qt.bind(null,e,t,n,i))}var Zt=q(function(e,t){var n=d.j[d.i],i=t.tabs[e].folders&n,o=i?a.yb:a.Cb;return t.longpoll.push([o([0,e,n,!0])]),Object(r.b)(w,{act:"a_dialog_star",val:i?0:1,peer:e,hash:t.tabs[e].hash,gid:t.gid}).then(function(){return t})}),Kt=q(function(e,t,n){var i=d.j[d.n];return n.longpoll.push([a.yb([0,e,i,!0]),a.pb([6,e,t])]),Object(r.b)(w,{act:"a_mark_answered",peer:e,lastmsg:t,hash:n.tabs[e].hash,gid:n.gid}).then(function(){return n})});function Vt(e){return Object(r.b)(w,{act:"a_get_mutex_key",gid:e})}function Xt(e,t){return B(k({},e,{free:!0}),t),Object(r.b)(w,{act:"a_block_release",peer:e,gid:t.gid}).then(function(){return t})}function Wt(e,t){var n=ls.get("comm_mute_"+t.gid)?1:0;return e&&(n^=1),ls.set("comm_mute_"+t.gid,n),t.mute=n,Promise.resolve(t)}var $t=q(function(e,t){return re(t,t.tabs[e],!0,function(t){return t.filter(function(t){return t!==e})}),t.tabs[e].deletedDialog=!0,Object(r.b)(w,{act:"a_delete_dialog",peer:e,gid:t.gid,hash:t.tabs[e].hash}).then(function(n){return n[0]?(en(t.tabbedPeers.filter(function(t){return t.peer!==e}),!0,t),t.tabs[e].unread=0,t.tabs[e].lastmsg=!1,t.tabs[e].lastmsg_meta=null):(t.tabs[e].deletedDialog=!1,re(t,t.tabs[e],!1,ae.bind(null,e),Jt.bind(null,t))),n})});function Gt(e,t,n,i){return Object(r.b)(w,{act:"a_restore_dialog",hash:t,gid:i.gid,spam:n?1:0,peer:e}).then(function(t){return i.tabs[e].deletedDialog=!1,re(i,i.tabs[e],!1,function(t){return[e].concat(t)}),i.tabs[e].unread=t,i})}function Yt(e,t,n){return Object(r.b)(w,{act:"a_spam_dialog",peer:e,gid:n.gid,hash:t})}function en(e,t,n){return n.tabbedPeers=e,Object(s.ib)(n)&&(D({peers:n.tabbedPeers.filter(function(e){var t=e.peer,r=e.type;return t!==n.peer&&"perm"===r}).map(function(e){return Object(s.R)(e.peer,n)}).filter(function(e){return!e.deletedDialog}).map(function(e){return e.peerId}).map(s.H).join("_")}),t&&A()),Promise.resolve(n)}function tn(e){return!e.peer||(Je(e.peer,e)?Ue(e.peer,e):!!Object(s.ob)(e,e.peer)&&e.tabs[e.peer].allShown)}function nn(e,t){var n=t.tabs[e];return Object(s.ob)(t,e)&&(n.skipped=null,n.msgs=null,n.offset=null,n.allShown=null,n.history=null),Promise.resolve(t)}function rn(e,t){var n=t.tabs[e];return Object(s.ob)(t,e)&&(n.history=N(n.history)),Promise.resolve(t)}function an(e,t){return t.go_to_end_visible=e,Promise.resolve(t)}function on(e,t,n){if(!Object(s.kb)(t))return Promise.resolve(n);var i=Object(l.t)(n,t);return i.blocked_community=!e,!1===e&&(i.can_send_notify=!1),Object(r.b)(w,{act:"a_toggle_community",peer_id:t,hash:i.hash,state:e?1:0}).then(function(){return V(n)})}function un(e,t){if(0!==t.peer&&Object(s.ob)(t,t.peer)){var n=Object(l.t)(t,t.peer);n.history=M(n.history),e(n.history)}return Promise.resolve(t)}function cn(e,t){if(0!==t.peer&&Object(s.ob)(t,t.peer)){var n=Object(l.t)(t,t.peer),r=geByClass1("_im_peer_history");r&&(n.history=M(r.innerHTML)),e(n.history)}return Promise.resolve(t)}function sn(e){return e.audio_msg.isRecording=!1,Promise.resolve(e)}function dn(e,t){return t.voice_message_available=e,Promise.resolve(t)}function ln(e){D({act:e?"create":null}),A()}function fn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;D({q:e}),A()}function mn(e){return void 0===e.chatResizeInitialized&&(e.chatResizeInitialized=!0,Object(s.U)()>window.clientHeight()&&Object(s.jc)(0)),Promise.resolve(e)}var bn=q(function(e,t,n){return Object(r.b)(w,{act:"a_join_chat",chat_id:e,hash:t,write_hash:n.writeHash}).then(function(e){var t=j(e,4),r=t[0],i=t[1],a=t[2],o=t[3];return a.forEach(function(e){return Object(m.a)(n,e)}),n.tabs[r]=i,re(n,i,!1,ae.bind(null,r),Jt.bind(null,n)),n.admins=extend(n.admins,o),[r]})});function _n(e,t){return Object(r.b)(w,{act:"a_get_link",gid:t.gid,chat_id:e})}var hn=q(function(e,t){var n=t.tabs[e];return Object(r.b)(w,{act:"a_reset_link",chat_id:e-2e9,write_hash:t.writeHash}).then(function(e){return n.inviteLink=e[0],e})});function pn(e){return S({invite_chat_id:null,invite_hash:null}),e.invitation=void 0,Promise.resolve(e)}function gn(e,t){var n=Object(u.a)([e].concat(t.select(c.b))).slice(0,500);t.update(c.b,n)}function vn(e){e.update(c.b,[])}function yn(e,t){var n=t.select(c.b).filter(function(t){return t!==e});return t.update(c.b,n),n}function jn(e,t,n){var r=n.tabs[t],i=Object(l.m)(n,t,e);return r.data.kicked||r.data.closed||i.kludges.source_act||(r.pinned=i),Promise.resolve(n)}function kn(e,t){return t.tabs[e].pinned=null,Promise.resolve(t)}var On=q(function(e,t,n){var i=n.tabs[t];return i.data.kicked||i.data.closed?Promise.resolve(n):Object(r.b)(w,{act:"a_pin_message",msgid:e,chat:t,gid:n.gid,hash:n.tabs[t].hash}).then(function(e){var r=j(e,1)[0];return n.tabs[t]=Object.assign({},i,r),n})}),wn=q(function(e,t){var n=t.tabs[e];return n.data.kicked||n.data.closed?Promise.resolve(t):Object(r.b)(w,{act:"a_unpin_message",chat:e,gid:t.gid,hash:t.tabs[e].hash}).then(function(r){var i=j(r,1)[0];return t.tabs[e]=Object.assign({},n,i),t})}),In=q(function(e,t){var n=t.tabs[e];return Object(r.b)(w,{act:"a_get_pinned_message",chat:e,gid:t.gid,hash:t.tabs[e].hash}).then(function(e){var r=j(e,1)[0];return n.pinned=r||null,t})}),xn=q(function(e,t,n){var i=n.tabs[e];return Object(r.b)(w,{act:"a_get_message_local_id",chat:e,chat_local_id:t,hash:i.hash})}),Pn=q(function(e,t){var n=t.tabs[e];return n.membersLoaded?Promise.resolve(t):Object(r.b)(w,{act:"a_get_chat_members",chat:e,gid:t.gid,hash:n.hash}).then(function(e){var r=j(e,1),i=j(r[0],3),a=i[0],o=i[1],u=i[2];return n.memberIds=a,n.adminIds=o,u.forEach(function(e){return Object(m.a)(t,e)}),n.membersLoaded=!0,t})}),Tn=q(function(e,t){return Promise.all([Pn(e,t),function(e,t){var n=t.tabs[e];return Object(r.b)(w,{act:"a_get_chat_details",chat:e,gid:t.gid,hash:n.hash}).then(function(e){var r=j(e,1)[0];return n.photoGrid=r.grid,n.photoLarge=r.photo,n.membersLastSeen=r.lastSeen||null,n.inviters=r.inviters,n.caccess=r.caccess,n.invitedByMe=r.invitedByMe||[],n.inviteLink=r.link||null,n.serverSettings=r.serverSettings||null,t})}(e,t)]).then(function(){return t})}),Dn=q(function(e,t,n){var i=n.tabs[e];return Object(r.b)(w,{act:"a_update_flags",chat:e,hash:i.hash,flags:t})}),An=q(function(e,t){var n=t.tabs[e];return Object(r.b)("al_page.php",{act:"owner_photo_remove",oid:e,gid:t.gid,hash:n.photoHash}).then(function(){return n.photo=null,n.photoLarge=null,t})});function Sn(e,t,n){var r=n.tabs[e];return r.memberIds=r.memberIds.filter(function(e){return e!==t}),r.adminIds=r.adminIds.filter(function(e){return e!==t}),r.membersCount=r.memberIds.length,Promise.resolve(n)}var En=q(function(e,t,n){var i=n.tabs[e];return Object(r.b)(w,{act:"a_kick_user",chat:e,hash:i.hash,mid:t}).then(function(){return i.memberIds=i.memberIds.filter(function(e){return e!==t}),i.adminIds=i.adminIds.filter(function(e){return e!==t}),i.membersCount=i.memberIds.length,n})});function Cn(e,t,n,r){var i=r.tabs[e];return i.adminIds=n?[].concat(i.adminIds,t).filter(function(e,t,n){return n.indexOf(e)===t}):i.adminIds.filter(function(e){return e!==t}),Promise.resolve(r)}var zn=q(function(e,t,n,i){var a=i.tabs[e];return Object(r.b)(w,{act:"a_toggle_admin",chat:e,hash:a.hash,mid:t,is_admin:+n}).then(function(){return Cn(e,t,n,i)})});function qn(e,t,n,r){var i=Object(l.m)(e,n,t).userId;return Object(m.c)(r,i)?Promise.resolve(r):_t(k({},n,[i]),r)}function Mn(){ajax.post("al_im.php",{act:"a_hide_promo_tooltip"})}function Nn(){cur.videoAutoplayScrollHandler&&cur.videoAutoplayScrollHandler()}var Bn=q(function(e,t){return t.tabs[e].top_banner=void 0,Object(r.b)(w,{act:"a_hide_banner",peer_id:e,gid:t.gid,hash:t.tabs[e].hash}).then(function(){return t})}),Hn=q(function(e,t,n){n.tabs[e].top_banner=void 0;var i=n.tabs[e];return Object(r.b)(w,{act:"a_callback_banner",peer_id:e,callback_data:t,hash:i.hash}).then(function(){return n})});function Ln(e,t){return Object(r.b)(w,{act:"a_load_banner",peer_id:e,gid:t.gid}).then(function(n){var r=j(n,1)[0];return t.tabs[e].top_banner=r,t})}function Fn(e,t,n){return n.tabs[e].keyboard=t&&t.buttons?t:null,Un(e,!1,!0,n)}function Rn(e,t){return Fn(e,null,t)}function Un(e,t,n,r){return((r.tabs||{})[e]||{}).keyboard&&(r.tabs[e].keyboard.hide=t,n&&ls.set("is_keyboards_hide",Object.assign(ls.get("is_keyboards_hide")||{},k({},e,t)))),Promise.resolve(r)}var Jn=q(function(e,t){var n=t.tabs[e];return Object(r.b)(w,{act:"a_get_keyboard",peer_id:e,hash:n.hash}).then(function(n){var r=j(n,1)[0];return Fn(e,r,t)})});function Qn(e,t,n,i){var a=i.tabs[e];return a.caccess[t]=n,Object(r.b)(w,{act:"a_change_caccess",peer_id:e,member_id:t,hash:a.hash,access:n?1:0}).then(function(){return i}).catch(function(e){throw a.caccess[t]=!n,e})}var Zn=q(function(e,t){var n=t.tabs[t.peer];return Object(r.b)(w,{act:"a_delete_template",template_id:e,hash:n.hash,gid:t.gid,peer_id:t.peer}).then(function(){var n=t.templates.find(function(t){return t.id===e});return n&&(n.deleted=!0),t})});function Kn(e,t,n){var i=n.tabs[n.peer];return Object(r.b)(w,{act:"a_create_template",hash:i.hash,gid:n.gid,peer_id:n.peer,name:e,text:t}).then(function(e){return n.templates.unshift(e[0]),n})}function Vn(e,t,n,i){var a=i.tabs[i.peer];return Object(r.b)(w,{act:"a_update_template",template_id:e,hash:a.hash,gid:i.gid,peer_id:i.peer,group_id:i.gid,name:t,text:n}).then(function(t){var n=i.templates.find(function(t){return t.id===e});return n&&Object.assign(n,t[0]),i})}function Xn(e,t){if(Object(s.ob)(t,e)){var n=Object(l.t)(t,e);n.allShown=!1,n.lastReset=Date.now()}return t}},"wSs/":function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"d",function(){return f});var r=n("rHUl"),i=n("MhhX"),a=n("P13b"),o=n("eTng"),u=n("aong");function c(e,t){t=Object(r.P)(t);var n=vk.id==t.peerId&&!Object(u.r)(e).gid;return 333!=t.peerId&&(!(!n&&!Object(i.k)(t))&&(!Object(i.l)(t)&&(!(Date.now()/1e3-t.date>86400)&&(!(Object(i.f)(t)||Object(i.m)(t)||Object(i.d)(t)||Object(i.g)(t)||Object(i.i)(t)||Object(i.o)(t))&&!Object(a.fb)(e,t.peerId,t.messageId)))))}function s(e){var t=document.createElement("div");return e=e.replace(/\[((id|club)\d+)\|(.+?)]/g,function(){var e=arguments.length<=1?void 0:arguments[1],t=arguments.length<=3?void 0:arguments[3];return/^\@/.test(t)?t:"@"+e+" ("+t+")"}),t.innerHTML=e,Emoji.val(t)}function d(e,t){return+(t&&t.msgs?Object.keys(t.msgs):[]).filter(function(e){return e>0}).sort(function(e,t){return t-e}).find(function(n){return c(e,t.msgs[n])})||null}function l(e,t,n){var r=Object(o.a)(t.kludges,t.messageId),i=n.dData.attaches;if(s(t.text)!==n.dData.txt||r.length!==i.length)return!0;for(var a=r.length;a--;){var u=r[a],c=i[a];if(u.id!=c.id||u.type!=c.type||"poll"==u.type&&c.object&&c.object.poll_is_edited)return!0}return!1}function f(e,t,n,r,i,o){t.origText=n,t.text=Object(a.fc)(clean(n)).replace(/\n/gi,"<br>"),t.attaches=r,t.kludges.emoji=1,t.local=1,t.share_url=i,t.cancelled_shares=o,t.update_time=Math.floor(Date.now()/1e3),e.get().tabs[t.peerId].msgs[t.messageId]=t}}}]);try{stManager.done("cmodules/bundles/37d6fe1fee6fb6accf5867cbca2cda9c.js")}catch(e){}