!function(e){var i={};function t(o){if(i[o])return i[o].exports;var r=i[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=i,t.d=function(e,i,o){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var r in e)t.d(o,r,function(i){return e[i]}.bind(null,r));return o},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=83)}({83:function(e,i,t){e.exports=t("zOBS")},nAFc:function(e,i,t){"use strict";t.d(i,"c",function(){return n}),t.d(i,"a",function(){return a}),t.d(i,"b",function(){return c}),t.d(i,"d",function(){return u});var o=function(){return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,i){var t=[],o=!0,r=!1,s=void 0;try{for(var n,a=e[Symbol.iterator]();!(o=(n=a.next()).done)&&(t.push(n.value),!i||t.length!==i);o=!0);}catch(e){r=!0,s=e}finally{try{!o&&a.return&&a.return()}finally{if(r)throw s}}return t}(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=window.Emoji,s=[["&amp;","&"],["&lt;","<"],["&gt;",">"],["&quot;",'"']];function n(e){return s.reduce(function(e,i){var t=o(i,2),r=t[0],s=t[1];return e.replace(new RegExp(s,"ig"),r)},e)}function a(e){return s.reduce(function(e,i){var t=o(i,2),r=t[0],s=t[1];return e.replace(new RegExp(r,"ig"),s)},e).replace(/&#(\d+);/g,function(e,i){return String.fromCodePoint(i)})}function c(e){return n(e).replace(/[\u00A0-\u9999<>\&]/gim,function(e){return"&#"+e.charCodeAt(0)+";"})}function u(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=i.lineBreak,o=void 0!==t&&t,s=i.convertEmoji,c=void 0===s||s,u=a(e);return u=u.replace(/\n\r/gi,"\n"),"oneline"===o?u=u.replace(/<br>/gi," ").replace(/\n/gi," "):"html"===o&&(u=u.replace(/\n/gi,"<br>")),u=n(u),c&&(u=r.emojiToHTML(u,!0)),u}},zOBS:function(e,i,t){"use strict";t.r(i);var o=t("nAFc"),r=function(){return/(?:\uD83C\uDFF4)(?:(?:\uDB40\uDC67)(?:\uDB40\uDC62)(?:(?:\uDB40\uDC65)(?:\uDB40\uDC6E)(?:\uDB40\uDC67)|(?:\uDB40\uDC77)(?:\uDB40\uDC6C)(?:\uDB40\uDC73)|(?:\uDB40\uDC73)(?:\uDB40\uDC63)(?:\uDB40\uDC74))(?:\uDB40\uDC7F)|\u200D\u2620\uFE0F?)|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC69)\u200D(?:(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83D\uDC68)(?:\u200D(?:\u2764\uFE0F?\u200D(?:(?:\uD83D\uDC8B)\u200D)?(?:\uD83D\uDC68)|(?:\uD83D[\uDC68\uDC69])\u200D(?:(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83D\uDC69)\u200D(?:\u2764\uFE0F?\u200D(?:(?:\uD83D\uDC8B)\u200D(?:\uD83D[\uDC68\uDC69])|(?:\uD83D[\uDC68\uDC69]))|(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:(?:\uD83D\uDC41)\uFE0F?\u200D(?:\uD83D\uDDE8)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|(?:\uD83D\uDC68)(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F?|(?:\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF]))\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|(?:\uD83D\uDC69)\u200D[\u2695\u2696\u2708])\uFE0F?|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC69)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC68)(?:\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF]))|(?:\uD83C\uDFF3)\uFE0F?\u200D(?:\uD83C\uDF08)|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC67)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3])|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC66)|(?:\uD83C\uDDF6)(?:\uD83C\uDDE6)|(?:\uD83C\uDDFD)(?:\uD83C\uDDF0)|(?:\uD83C\uDDF4)(?:\uD83C\uDDF2)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C\uDDED)(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|(?:\uD83C\uDDEC)(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|(?:\uD83C\uDDEA)(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|(?:\uD83C\uDDE8)(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\uD83C\uDDF2)(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|(?:\uD83C\uDDF3)(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|(?:\uD83C\uDDFC)(?:\uD83C[\uDDEB\uDDF8])|(?:\uD83C\uDDFA)(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|(?:\uD83C\uDDF0)(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|(?:\uD83C\uDDEF)(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C\uDDF8)(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|(?:\uD83C\uDDEE)(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|(?:\uD83C\uDDFF)(?:\uD83C[\uDDE6\uDDF2\uDDFC])|(?:\uD83C\uDDEB)(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|(?:\uD83C\uDDF5)(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|(?:\uD83C\uDDE9)(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|(?:\uD83C\uDDF9)(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|(?:\uD83C\uDDE7)(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|[#\*0-9]\uFE0F?\u20E3|(?:\uD83C\uDDF1)(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|(?:\uD83C\uDDE6)(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:\uD83C\uDDF7)(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|(?:\uD83C\uDDFB)(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|(?:\uD83C\uDDFE)(?:\uD83C[\uDDEA\uDDF9])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])\uFE0F?|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDD1-\uDDDD])/g},s={1:["😀","😃","😄","😁","😅","😆","😂","🤣","😉","😊","☺","🙂","🙃","😇","😗","😙","😚","😘","😍","🥰","🤩","🤗","😋","😜","🤪","😛","😝","🤑","🤭","🤐","🤫","😶","🤔","🤨","🧐","😐","😑","🙄","😬","🤥","😏","😌","🤤","😴","🤓","😎","🥳","🤠","😒","😔","😪","😕","😟","🙁","☹","😮","😯","😲","😳","🥺","😦","😧","😨","😰","😥","😢","😭","😱","😖","😣","😞","😓","😩","😫","😷","🤒","🤕","🤢","🤮","🤧","🥶","🥵","🥴","😵","🤯","😤","😠","😡","🤬","😈","👿","💀","☠","💩","🤡","👹","👺","👻","👽","👾","🤖","😺","😸","😹","😻","😼","😽","🙀","😿","😾","🙈","🙉","🙊"],2:["🐵","🐒","🦍","🐶","🐕","🐩","🐺","🦊","🦝","🐱","🐈","🦁","🐯","🐅","🐆","🐴","🐎","🦄","🦓","🦌","🐮","🐂","🐃","🐄","🐷","🐽","🐖","🐗","🐏","🐑","🐐","🐪","🐫","🦙","🦒","🐘","🦏","🦛","🐭","🐁","🐀","🐹","🐰","🐇","🐿","🦔","🦇","🐻","🐨","🐼","🦘","🦡","🐾","🦃","🐔","🐓","🐣","🐤","🐥","🐦","🐧","🕊","🦅","🦆","🦢","🦉","🦚","🦜","🐸","🐊","🐢","🦎","🐲","🐉","🦕","🦖","🐳","🐋","🐬","🐟","🐠","🐡","🦈","🐙","🦀","🦞","🦐","🦑","🐚","🐌","🦋","🐛","🐜","🐝","🐞","🦗","🕷","🕸","🦂","🦟","🦠","💐","🌸","💮","🏵","🌹","🥀","🌺","🌻","🌼","🌷","🌳","🌲","🎄","🌴","🌵","🌾","🌱","🌿","☘","🍀","🍁","🍂","🍃","🌑","🌒","🌓","🌔","🌕","🌖","🌗","🌘","🌙","🌚","🌛","🌜","🌡","☀","🌝","🌞","⭐","🌟","🌠","☁","⛅","⛈","🌤","🌥","🌦","🌧","🌨","🌩","🌪","🌫","🌬","💨","🌀","🌈","🌂","☂","☔","⛱","⚡","❄","☃","⛄","☄","🔥","💦","💧","🌊"],3:["👍🏻","👎🏻","👌🏻","✌🏻","🤞🏻","🤟🏻","🤘🏻","🤙🏻","🖕🏻","✊🏻","👊🏻","🤛🏻","🤜🏻","👈🏻","👉🏻","👆🏻","👇🏻","☝🏻","👋🏻","🤚🏻","🖐🏻","✋🏻","🖖🏻","👏🏻","🙌🏻","👐🏻","🤲🏻","🤝🏻","🙏🏻","💪🏻","🦵🏻","🦶🏻","👂🏻","👃🏻","🧠","🦷","🦴","👀","👁","👅","👄","✍","💅","🤳","👫","👭","👬","👩‍❤️‍💋‍👨","👨‍❤️‍💋‍👨","👩‍❤️‍💋‍👩","👩‍❤️‍👨","👨‍❤️‍👨","👩‍❤️‍👩","👪","👶","🧒","👦","👧","🧑","👱","👨","🧔","👱‍♂️","👨‍🦰","👨‍🦱","👨‍🦳","👨‍🦲","👩","👱‍♀️","👩‍🦰","👩‍🦱","👩‍🦳","👩‍🦲","🧓️","👴️","👵️","🙍‍♂️️","🙍‍♀️️","🙎‍♂️","🙎‍♀️️","🙅‍♂️","🙅‍♀️","🙆‍♂️","🙆‍♀️","💁‍♂️","💁‍♀️️","🙋‍♂️","🙋‍♀️️","🙇‍♂️","🙇‍♀️️","🤦‍♂️","🤦‍♀️","🤷‍♂️","🤷‍♀️","💆‍♂️️","💆‍♀️","💇‍♂️️","💇‍♀️","🚶‍♂️️","🚶‍♀️️","🏃‍♂️️","🏃‍♀️","💃","🕺","🕴️","👯‍♂️️","👯‍♀️","🧖‍♂️","🧖‍♀️️","👼","🎅","🤶","🦸‍♂️","🦸‍♀️","🦹‍♂️","🦹‍♀️","🧙‍♂️","🧙‍♀️","🧚‍♂️","🧚‍♀️","🧛‍♂️","🧛‍♀️","🧜‍♂️","🧜‍♀️","🧝‍♂️","🧝‍♀️","🧞‍♂️","🧞‍♀️","🧟‍♂️","🧟‍♀️","👨‍⚕️","👩‍⚕️","👨‍🎓","👩‍🎓","👨‍🏫","👩‍🏫","👨‍⚖️","👩‍⚖️","👨‍🌾","👩‍🌾","👨‍🍳","👩‍🍳","👨‍🔧","👩‍🔧","👨‍🏭","👩‍🏭","👨‍💼","👩‍💼","👨‍🔬","👩‍🔬","👨‍💻","👩‍💻","👨‍🎤","👩‍🎤","👨‍🎨","👩‍🎨","👨‍✈️","👩‍✈️","👨‍🚀","👩‍🚀","👨‍🚒","👩‍🚒","👮‍♂️","👮‍♀️","🕵️‍♂️","🕵️‍♀️","💂‍♂️","💂‍♀️","👷‍♂️","👷‍♀️","🤴","👸","👳‍♂️","👳‍♀️","👲","🧕","🤵","👰","🤰","🤱","🛀","🛌"],4:["🍏","🍎","🍐","🍅","🥝","🍑","🍒","🍓","🍇","🍈","🍉","🍊","🍋","🍌","🍍","🥭","🥥","🥑","🍆","🥔","🥕","🌽","🌶","🥒","🥬","🥦","🍄","🥜","🌰","🍞","🥐","🥖","🥨","🥯","🥞","🧀","🍖","🍗","🥩","🥓","🍔","🍟","🍕","🌭","🥪","🌮","🌯","🥙","🥚","🍳","🥘","🍲","🥣","🥗","🍿","🧂","🥫","🍱","🍘","🍙","🍚","🍛","🍜","🍝","🍠","🍢","🍣","🍤","🍥","🥮","🍡","🥟","🥠","🥡","🍦","🍧","🍨","🍩","🍪","🎂","🍰","🧁","🥧","🍫","🍬","🍭","🍮","🍯","🍼","🥛","☕","🍵","🍶","🍾","🍷","🍸","🍹","🍺","🍻","🥂","🥃","🥤","🥢","🍽","🍴","🥄"],5:["⚽","⚾","🥎","🏀","🏐","🏈","🏉","🎾","🥏","🎳","🏏","🏑","🏒","🥍","🏓","🏸","🥊","🥋","🥅","⛳","⛸","🎣","🎽","🛹","🎿","🛷","🥌","🎯","🎱","🎮","🕹","🎰","🎲","🧩","♟","🧗‍♂️️","🧗‍♀️","🤺","🏇","⛷","🏂","🏌️‍♂️","🏌️‍♀️","🏄‍♂️","🏄‍♀️","🚣‍♂️","🚣‍♀️","🏊‍♂️","🏊‍♀️","⛹️‍♂️","⛹️‍♀️","🏋️‍♂️","🏋️‍♀️","🚴‍♂️","🚴‍♀️","🚵‍♂️","🚵‍♀️","🤸","🤼‍♂️","🤼‍♀️","🤽‍♂️","🤽‍♀️","🤾‍♂️","🤾‍♀️","🤹‍♂️","🤹‍♀️","🧘‍♂️","🧘‍♀️","🎖","🏆","🏅","🥇","🥈","🥉"],6:["🚂","🚃","🚄","🚅","🚆","🚇","🚈","🚉","🚊","🚝","🚞","🚋","🚌","🚍","🚎","🚐","🚑","🚒","🚓","🚔","🚕","🚖","🚗","🚘","🚙","🚚","🚛","🚜","🏎","🏍","🛵","🚲","🛴","🚏","🛣","🛤","🛢","⛽","🚨","🚥","🚦","🛑","🚧","⚓","⛵","🛶","🚤","🛳","⛴","🛥","🚢","✈","🛩","🛫","🛬","💺","🚁","🚟","🚠","🚡","🛰","🚀","🛸","🌍","🌎","🌏","🌐","🗺","🗾","🧭","🏔","⛰","🌋","🗻","🏕","🏖","🏜","🏝","🏞","🏟","🏛","🏗","🧱","🏘","🏚","🏠","🏡","🏢","🏣","🏤","🏥","🏦","🏨","🏩","🏪","🏫","🏬","🏭","🏯","🏰","💒","🗼","🗽","⛪","🕌","🕍","⛩","🕋","⛲","⛺","🌁","🌃","🏙","🌄","🌅","🌆","🌇","🌉","♨","🌌","🎠","🎡","🎢","💈","🎪"],7:["🎙","🎚","🎛","🎤","🎧","📻","🎷","🎸","🎹","🎺","🎻","🥁","📯","🎭","🖼","🎨","🧵","🧶","🔮","🧿","🧸","🃏","🀄","🎴","🎃","🎆","🎇","🧨","🎈","🎉","🎊","🎋","🎍","🎎","🎏","🎐","🎑","🧧","🎀","🎁","🎗","🎟","🎫","🛎","🧳","⌛","⏳","⌚","⏰","⏱","⏲","🕰","👓","🕶","🥽","🥼","👔","👕","👖","🧣","🧤","🧥","🧦","👗","👘","👙","👚","👛","👜","👝","🛍","🎒","👞","👟","🥾","🥿","👠","👡","👢","👑","👒","🎩","🎓","🧢","⛑","📿","💄","💍","💎","📱","📲","☎","📞","📟","📠","🔋","🔌","💻","🖥","🖨","⌨","🖱","🖲","💽","💾","💿","📀","🧮","🎥","🎞","📽","🎬","📺","📷","📸","📹","📼","🔍","🔎","🕯","💡","🔦","🏮","📔","📕","📖","📗","📘","📙","📚","📓","📒","📃","📜","📄","📰","🗞","📑","🔖","🏷","💰","💴","💶","💷","💸","💳","🧾","💹","💱","💲","✉","💌","📧","📨","📩","📤","📥","📦","📫","📪","📬","📭","📮","🗳","✏","✒","🖋","🖊","🖌","🖍","📝","💼","📁","📂","🗂","📅","📆","🗒","🗓","📇","📈","📉","📊","📋","📌","📍","📎","🖇","📏","📐","✂","🗃","🗄","🗑","🔒","🔓","🔏","🔐","🔑","🗝","🔨","⛏","⚒","🛠","🗡","⚔","🔪","🔫","🏹","🛡","🔧","🔩","⚙","🗜","⚖","🔗","⛓","🧰","🧲","⚗","🧪","🧫","🧬","🔬","🔭","📡","💉","💊","🚪","🛏","🛋","🚽","🚿","🛁","🧴","🧷","🧹","🧺","🧻","🧼","🧽","🧯","🛒","🚬","⚰","⚱","🏺","🗿"],8:["💋","❤","💔","❣","💘","💝","💖","💗","💓","💞","💕","💟","💜","🧡","💛","💚","💙","🖤","💯","💢","💥","💫","🕳","💣","💬","👁️‍🗨️","🗨","🗯","💭","💤","🗣","👤","👥","👣","🔇","🔊","📢","📣","🔔","🔕","🎼","🎵","🎶","⚠","🚸","☢","☣","🆚","🆒","🆓","🆕","🚮","🚾","🚭","✅","⚕","🔱","‼","⁉","❓","❗","🆘","⛔","🚫","🚳","🚯","🚱","🚷","📵","🔞"],9:["🇷🇺","🇰🇿","🇧🇾","🇺🇦","🇲🇳","🇬🇪","🇦🇿","🇹🇯","🇧🇷","🇱🇹","🇱🇻","🇪🇪","🇦🇲","🏁","🚩","🎌","🏴","🏳","🏳️‍🌈","🏴‍☠️","🇦🇨","🇦🇩","🇦🇪","🇦🇫","🇦🇬","🇦🇮","🇦🇱","🇦🇴","🇦🇶","🇦🇷","🇦🇸","🇦🇹","🇦🇺","🇦🇼","🇦🇽","🇧🇦","🇧🇧","🇧🇩","🇧🇪","🇧🇫","🇧🇬","🇧🇭","🇧🇮","🇧🇯","🇧🇱","🇧🇲","🇧🇳","🇧🇴","🇧🇶","🇧🇸","🇧🇹","🇧🇻","🇧🇼","🇧🇿","🇨🇦","🇨🇨","🇨🇩","🇨🇫","🇨🇬","🇨🇭","🇨🇮","🇨🇰","🇨🇱","🇨🇲","🇨🇳","🇨🇴","🇨🇵","🇨🇷","🇨🇺","🇨🇻","🇨🇼","🇨🇽","🇨🇾","🇨🇿","🇩🇪","🇩🇬","🇩🇯","🇩🇰","🇩🇲","🇩🇴","🇩🇿","🇪🇨","🇪🇬","🇪🇭","🇪🇷","🇪🇸","🇪🇹","🇪🇺","🇫🇮","🇫🇯","🇫🇰","🇫🇲","🇫🇴","🇫🇷","🇬🇦","🇬🇧","🇬🇩","🇬🇫","🇬🇬","🇬🇭","🇬🇮","🇬🇱","🇬🇲","🇬🇳","🇬🇵","🇬🇶","🇬🇷","🇬🇸","🇬🇹","🇬🇺","🇬🇼","🇬🇾","🇭🇰","🇭🇲","🇭🇳","🇭🇷","🇭🇹","🇭🇺","🇮🇨","🇮🇩","🇮🇪","🇮🇱","🇮🇲","🇮🇳","🇮🇴","🇮🇶","🇮🇷","🇮🇸","🇮🇹","🇯🇪","🇯🇲","🇯🇴","🇯🇵","🇰🇪","🇰🇬","🇰🇭","🇰🇮","🇰🇲","🇰🇳","🇰🇵","🇰🇷","🇰🇼","🇰🇾","🇱🇦","🇱🇧","🇱🇨","🇱🇮","🇱🇰","🇱🇷","🇱🇸","🇱🇺","🇱🇾","🇲🇦","🇲🇨","🇲🇩","🇲🇪","🇲🇫","🇲🇬","🇲🇭","🇲🇰","🇲🇱","🇲🇲","🇲🇴","🇲🇵","🇲🇶","🇲🇷","🇲🇸","🇲🇹","🇲🇺","🇲🇻","🇲🇼","🇲🇽","🇲🇾","🇲🇿","🇳🇦","🇳🇨","🇳🇪","🇳🇫","🇳🇬","🇳🇮","🇳🇱","🇳🇴","🇳🇵","🇳🇷","🇳🇺","🇳🇿","🇴🇲","🇵🇦","🇵🇪","🇵🇫","🇵🇬","🇵🇭","🇵🇰","🇵🇱","🇵🇲","🇵🇳","🇵🇷","🇵🇸","🇵🇹","🇵🇼","🇵🇾","🇶🇦","🇷🇪","🇷🇴","🇷🇸","🇷🇼","🇸🇦","🇸🇧","🇸🇨","🇸🇩","🇸🇪","🇸🇬","🇸🇭","🇸🇮","🇸🇯","🇸🇰","🇸🇱","🇸🇲","🇸🇳","🇸🇴","🇸🇷","🇸🇸","🇸🇹","🇸🇻","🇸🇽","🇸🇾","🇸🇿","🇹🇦","🇹🇨","🇹🇩","🇹🇫","🇹🇬","🇹🇭","🇹🇰","🇹🇱","🇹🇲","🇹🇳","🇹🇴","🇹🇷","🇹🇹","🇹🇻","🇹🇼","🇹🇿","🇺🇬","🇺🇳","🇺🇸","🇺🇾","🇺🇿","🇻🇦","🇻🇨","🇻🇪","🇻🇬","🇻🇮","🇻🇳","🇻🇺","🇼🇫","🇼🇸","🇽🇰","🇾🇪","🇾🇹","🇿🇦","🇿🇲","🇿🇼"]},n={e29da4:/(\s|^)([0OО]:\))([\s\.,]|$)/g,f09f9887:/(\s|^)(;-\)+)([\s\.,]|$)/g,f09f9889:/(\s|^)([XХxх]-?D)([\s\.,]|$)/g,f09f9886:/(\s|^)(B-\))([\s\.,]|$)/g,f09f988e:/(\s|^)(3-\))([\s\.,]|$)/g,f09f988c:/(\s|^)(&gt;\()([\s\.,]|$)/g,f09f98a0:/(\s|^)(;[oоOО])([\s\.,]|$)/g,f09f98b0:/(\s|^)(8\|)([\s\.,]|$)/g,f09f98b3:/(\s|^)(8-?[oоOО])([\s\.,]|$)/g,f09f98b2:/(\s|^)(8-\))([\s\.,]|$)/g,f09f988d:/(\s|^)(:[XХ])([\s\.,]|$)/g,f09f98b7:/(\s|^)(:[oоOО])([\s\.,]|$)/g,f09f98a8:/(\s|^)(&lt;3)([\s\.,]|$)/g},a={f09f988a:/(:-\))([\s\.,]|$)/g,f09f9883:/(:-D)([\s\.,]|$)/g,f09f989c:/(;-[PР])([\s\.,]|$)/g,f09f988b:/(:-[pр])([\s\.,]|$)/g,f09f9892:/(:-\()([\s\.,]|$)/g,e298ba:/(:-?\])([\s\.,]|$)/g,f09f988f:/(;-\])([\s\.,]|$)/g,f09f9894:/(3-?\()([\s\.,]|$)/g,f09f98a2:/(:&#039;\()([\s\.,]|$)/g,f09f98ad:/(:_\()([\s\.,]|$)/g,f09f98a9:/(:\(\()([\s\.,]|$)/g,f09f9890:/(:\|)([\s\.,]|$)/g,f09f98a1:/(&gt;\(\()([\s\.,]|$)/g,f09f989a:/(:-\*)([\s\.,]|$)/g,f09f9888:/(\}:\))([\s\.,]|$)/g,f09f918d:/(:like:)([\s\.,]|$)/g,f09f918e:/(:dislike:)([\s\.,]|$)/g,e2989d:/(:up:)([\s\.,]|$)/g,e29c8c:/(:v:)([\s\.,]|$)/g,f09f918c:/(:ok:|:ок:)([\s\.,]|$)/g},c=/\uFE0F?\uD83C[\uDFFB-\uDFFF]/;function u(e){var i=e.split("").map(function(e){return e.charCodeAt(0).toString(16)}).filter(function(e){return"fe0f"!==e.toLowerCase()}).map(function(e){return String.fromCodePoint(parseInt(e,16))}).join("");return encodeURIComponent(i).replace(/%/gi,"").toLowerCase()}function l(e){return e.replace(c,"")}var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=Object.keys(s).reduce(function(e,i){return e[i]=s[i].map(function(e){return u(e)}),e},{});window.Emoji||(window.Emoji={opts:{},raw:{},last:0,shownId:!1,hasNewStickers:!1,preventMouseOver:!1,stickerPacksToLoad:[],ttShift:45,favoriteAvailable:!1,favoriteRemindOn:!1,favoriteRemindOff:!1,favoriteLimit:20,favoriteLimitNoticed:!1,stickerSize:"64",stickers:{},TAB_EMOJI:0,TAB_RECENT_STICKERS:-1,TAB_FAVORITE_STICKERS:-2,CLICK_DELAY:500,SORTED_EMOJI_SECTIONS_CODES:[-1,1,3,8,2,4,5,6,7,9],CACHED_HEIGHT_PROP:"_emojiHeight",CACHED_WIDTH_PROP:"_emojiWidth",BOTTOM_REST_FOR_ADD_EMOJI_CATEGORY:150,SHOW_TT_TIMEOUT:100,HIDE_TT_TIMEOUT:300,SHOWN_TT_CLS:"emoji_tt_shown",STICKER_REFERRERS:{RECENT:"recent",FAVORITE:"favourite",KEYBOARD:"keyboard"},DELETE_FAV_STICKER_ELEMENTS_DELAY:500,FAV_ICON_TT_MIN_HEIGHT:35,logHintsDelay:0,tabDefaultId:0,stickersKeywordsExpire:36e5*(6+2*Math.random()),init:function(e,i){var t=Emoji.last;if(Emoji.stickerSize=window.devicePixelRatio>=2?"128":"64",Emoji.tabDefaultId=Emoji.TAB_RECENT_STICKERS,i.txt=e,i.id=t,i.fieldWrap=gpeByClass("_emoji_field_wrap",e),i.emojiWrap=domByClass(i.fieldWrap,"_emoji_wrap"),i.emojiBtn=domByClass(i.emojiWrap,"_emoji_btn"),i.emojiWrap&&data(i.emojiWrap,"optId",t),e.emojiId=t,i.lastLoadedEmojiCategoriesIdxes={},i.preventDoubleClick=vkNow(),i.deletedFavoriteStickers=[],i.deleteFavoriteStickersTimeout=null,i.forceTxt)i.editable=0,placeholderInit(e);else{if(i.editable=1,setTimeout(function(){placeholderInit(e,{editable:1,editableFocus:Emoji.editableFocus,global:i.global}),i.shouldFocus&&Emoji.editableFocus(e,!1,!0)},0),browser.mozilla)try{document.execCommand("enableObjectResizing",!1,!1),cur.destroy.push(function(){document.execCommand("enableObjectResizing",!1,!0)})}catch(e){}addEvent(window,"mousemove",Emoji.preventMouseOverHandle),addEvent(e,browser.opera&&!browser.chrome?"click":"mousedown",function(o){if(o.target&&"IMG"==o.target.tagName&&Emoji.getCode(o.target))return Emoji.editableFocus(e,o.target,o.offsetX>8),cancelEvent(o);Emoji.shown&&Emoji.ttClick(t,geByClass1("emoji_smile",i.controlsCont),!0)}),i.noLineBreaks&&addEvent(e,"blur",function(i){e.textContent||e.innerText||each(geByTag("br",e),function(e,i){re(i)})}),addEvent(e,"keypress keydown keyup input paste",function(o){if(o.canceled)return!1;if("keydown"===o.type){i.onChange&&(Emoji.raw[t]=e.innerHTML);var r=i.ctrlSend?i.ctrlSend():i.noEnterSend;if(o.keyCode==KEY.RETURN||10==o.keyCode){if(i.forceEnterSend&&i.onSend)return i.onSend(),cancelEvent(o);var s=cur.ctrl_submit&&!i.noCtrlSend;if((s||r)&&(o.ctrlKey||browser.mac&&o.metaKey)||!s&&!o.shiftKey&&!(o.ctrlKey||browser.mac&&o.metaKey)){var n=data(e,"composer");if(!Emoji.emojiEnter(t,o)||!Emoji.stickerHintMove(o)||n&&n.wdd&&isVisible(n.wdd.listWrap))return!1;if(!r||o.ctrlKey||browser.mac&&o.metaKey)return Emoji.ttClick(t,geByClass1("emoji_smile",i.controlsCont),!0),i.onSend&&i.onSend(),cancelEvent(o)}if(i.noLineBreaks)return cancelEvent(o)}if(o.ctrlKey&&o.keyCode==KEY.RETURN){var a=this.value;if(i.editable)Emoji.insertHTML("<div><br/></div>");else{if("number"==typeof this.selectionStart&&"number"==typeof this.selectionEnd){var c=this.selectionStart;this.value=a.slice(0,c)+"\n"+a.slice(this.selectionEnd),this.selectionStart=this.selectionEnd=c+1}else if(document.selection&&document.selection.createRange){this.focus();var u=document.selection.createRange();u.text="\r\n",u.collapse(!1),browser.opera&&!browser.chrome&&(u.moveEnd("character",0),u.moveStart("character",0)),u.select()}e.autosize.update(),setTimeout(function(){e.autosize.update()},0)}return!1}if(o.keyCode==KEY.TAB&&!(o.ctrlKey||browser.mac&&o.metaKey)){var l=geByClass1("_sticker_hints",domPN(i.txt));if(l&&isVisible(l)){var m=geByClass1("over",l);if(m?Emoji.stickerHintKeyOut(t,m):Emoji.stickerHintKeyOver(t,geByClass1("emoji_sticker_item",l)),!Emoji.shown)return cancelEvent(o)}return Emoji.shown?(Emoji.editableFocus(e,!1,!0,void 0,!0),Emoji.ttClick(t,geByClass1("emoji_smile",i.controlsCont),!0)):Emoji.ttClick(t,geByClass1("emoji_smile",i.controlsCont),!1,!0,void 0,!0),cancelEvent(o)}if(o.keyCode==KEY.ESC){var d=geByClass1("_sticker_hints",domPN(i.txt)),D=!1;if(d&&isVisible(d)&&(Emoji.stickerHintKeyOut(t,geByClass1("emoji_sticker_item",d)),Emoji.stickersHintsHide(d,i,100),D=!0),Emoji.shown&&(Emoji.editableFocus(e,!1,!0,void 0,!0),Emoji.ttClick(t,geByClass1("emoji_smile",i.controlsCont),!0),D=!0),D)return cancelEvent(o);if(i.onEsc)return i.onEsc(o)}}return"paste"===o.type?(Emoji.onEditablePaste(e,i,t,o),i.checkEditable&&setTimeout(i.checkEditable.pbind(t,e),0),Emoji.checkStickersKeywords(t,i)):"keyup"===o.type?(!i.noLineBreaks||e.textContent||e.innerText||each(geByTag("br",e),function(e,i){re(i)}),i.checkEditable&&i.checkEditable(t,e),Emoji.checkStickersKeywords(t,i),i.onChange&&(Emoji.raw[t]!=e.innerHTML&&Emoji.onChange(i),delete Emoji.raw[t])):"keydown"!==o.type&&"input"!==o.type||(i.checkEditable&&setTimeout(i.checkEditable.pbind(t,e),0),Emoji.checkStickersKeywords(t,i)),i.onKeyAction&&i.onKeyAction(o),cur.onReplyFormSizeUpdate&&cur.onReplyFormSizeUpdate(o),!0})}return window.Notifier&&Notifier.addRecvClbk("emoji",0,Emoji.lcRecv,!0),Emoji.initStickersKeywords(),Emoji.initPromotedStickerUrls(),Emoji.checkNewStickers(i),Emoji.opts[Emoji.last]=i,Emoji.last++},onChange:function(e){isFunction(e.onChange)&&setTimeout(e.onChange,0)},preventMouseOverHandle:function(){Emoji.preventMouseOver=!1},lcRecv:function(e){switch(e.act){case"updateTabs":Emoji.updateTabs(e.newStickers,e.keywords)}},correctCaret:function(e){var i=e?function(e){var i=e.getBoundingClientRect(),t=null,o=null;if(i.top===i.bottom)return{left:0,top:0,bottom:0};if(document.selection)o=document.selection.createRange(),(t=o.getClientRects()||[]).length||(o.text="_",o.moveStart("character",-1),t=o.getClientRects(),o.text=""),t=t[t.length-1];else if(window.getSelection){var r=getSelection();if(r.anchorNode){if((o=r.getRangeAt(0)).collapsed){var s=o.startOffset;o.setStart(o.startContainer,0),t=o.getClientRects(),o.setStart(o.startContainer,s)}t=t&&t.length?t[t.length-1]:{right:i.left,top:i.top,bottom:i.top}}else t={right:0,top:0,bottom:0}}return{left:t.right-i.left,top:t.top-i.top,bottom:t.bottom-i.top}}(e).bottom:0;(i<0||i>e.offsetHeight)&&(e.scrollTop+=i-e.offsetHeight)},insertWithBr:function(e,i){if(i){var t=i.replace(/\n/g,"<br/>"),o=ce("div",{innerHTML:t});Emoji.cleanCont(o),Emoji.insertHTML(o.innerHTML)}},insertWithoutNL:function(e,i){if(i){var t=i.replace(/\n/g,""),o=ce("div",{innerHTML:t});Emoji.cleanCont(o),Emoji.insertHTML(o.innerHTML)}},focusTrick:function(e,i,t,o,r){r||(r=e);var s=ce("TEXTAREA",{className:"emoji_tmp_textarea"});e.parentNode.appendChild(s),s.focus(),setTimeout(function(){var n=r.scrollTop;re(s),e.focus(),r.scrollTop=n,Emoji.setRange(o),i(clean(val(s))),t(e)},0)},finalizeInsert:function(e){Emoji.cleanCont(e),setTimeout(Emoji.correctCaret.pbind(e),10)},getClipboard:function(e){return e.clipboardData?clean(e.clipboardData.getData("text")):!!window.clipboardData&&clean(window.clipboardData.getData("Text"))},processImagePaste:function(e,i,t,o){if(null!=e.clipboardData){var r=function(){var r=function(e){if(!e.match(/^webkit\-fake\-url\:\/\//)){var r=new Image;return r.crossOrigin="anonymous",r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,e.width,e.height),e.toBlob(function(e){!function(e){var o=void 0,r=void 0;if(e.name=e.filename="upload_"+(new Date).toISOString()+"_"+irand(0,100)+".png",hasClass(i,"_im_text")){if(t.uploadActions)return void t.uploadActions.paste([e])}else o="post_field"==i.id?cur.wallAddMedia:(r=data(i,"composer"))&&r.addMedia;o&&isFunction(t.initUploadForImagePasteCallback)&&t.initUploadForImagePasteCallback(i,o,e)}(e)},"image/png"),o(!0)},r.src=e}},s=e.clipboardData;if(s.items){for(var n=!1,a=0,c=s.items.length;a<c;a++){var u=s.items[a];if(u.type.match(/^image\//)){var l=new FileReader;l.onload=function(e){return r(e.target.result)},l.readAsDataURL(u.getAsFile()),n=!0}else if("text/plain"===u.type)return{v:o()}}return{v:n}}if(-1!==Array.prototype.indexOf.call(s.types,"text/plain"))return{v:o()};!function(e){for(var t=Math.floor(1e3*Math.random()),r=geByTag("img",i),s=0,n=r.length;s<n;s++)r[s]["_before_paste_"+t]=!0;setTimeout(function(){for(var r=geByTag("img",i),s=!1,n=0,a=r.length;n<a;n++){var c=r[n];c["_before_paste_"+t]||(e(c.src),re(c),s=!0)}s||o()},1)}(function(e){return r(e)})}();if("object"===(void 0===r?"undefined":m(r)))return r.v}else o()},onEditablePaste:function(e,i,t,o,r){var s=!1;"true"===e.getAttribute("contenteditable")&&(s=Emoji.getRange());var n=this.getClipboard(o),a=n&&s&&!r;o.clipboardData&&inArray("text/html",o.clipboardData.types)&&inArray("Files",o.clipboardData.types)&&cancelEvent(o),(this.processImagePaste(o,e,i,function(t){t||(a?(i.noLineBreaks?this.insertWithoutNL(s,n):this.insertWithBr(s,n),setTimeout(this.finalizeInsert.bind(this,e),0)):s&&this.focusTrick(e,i.noLineBreaks?this.insertWithoutNL.pbind(s):this.insertWithBr.pbind(s),this.finalizeInsert.bind(this,e),s))}.bind(this))||a)&&cancelEvent(o),Emoji.onChange(i)},cleanCont:function(e){for(var i=e.firstChild;i;){var t=i.nextSibling;switch(i.nodeType){case 1:if("tmp_paste_cont"==i.id)break;if("DIV"==i.tagName||"P"==i.tagName||"SPAN"==i.tagName)i.setAttribute("style",""),i.className="",i.id="",Emoji.cleanCont(i);else if("IMG"==i.tagName)Emoji.getCode(i)||re(i);else if("BR"!=i.tagName){var o=Emoji.editableVal(i,{saveEmoji:!0}),r=cf(clean(o).replace(/\n/g,"<br/>"));i.parentNode.replaceChild(r,i)}break;case 3:var s=clean(i.textContent||i.innerText);s&&s.match(Emoji.emojiRegex)&&(s=s.replace(Emoji.emojiRegex,Emoji.emojiReplace),i.parentNode.replaceChild(cf(s),i))}i=t}},focus:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Emoji.editableFocus(e,!1,!0);var o=t||e.parentNode;if(i){var r=getXY(o)[1],s=scrollGetY(),n=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:boxLayerBG.offsetHeight,a=getSize(o)[1];s+n<r+a?scrollToY(r-n+a+60,100):s>r&&scrollToY(r-60,100)}},destroy:function(e){if(Emoji.opts.hasOwnProperty(e)){var i=Emoji.opts[e];i.txt&&i.txt.blur(),i.imagesLoader&&i.imagesLoader.destroy(),delete Emoji.opts[e]}},editableFocus:function(e,i,t,o,r){if(!e||r&&document.activeElement===e)return!1;if((e=ge(e)).focus(),e.phonfocus&&e.phonfocus(),void 0!==window.getSelection&&void 0!==document.createRange){var s=window.getSelection();if(!browser.opera||browser.chrome||t){var n=document.createRange();i?n.selectNode(i):n.selectNodeContents(e),browser.mozilla&&"<br>"===e.innerHTML&&(e.innerHTML=""),o||n.collapse(!t),(s=window.getSelection()).removeAllRanges(),s.addRange(n)}else s.collapse(i||e,0)}else if(void 0!==document.body.createTextRange){var a=document.body.createTextRange();a.moveToElementText(i||e),a.collapse(!t),a.select()}},getRange:function(){if(window.getSelection){var e=window.getSelection();if(e.getRangeAt&&e.rangeCount)return e.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},setRange:function(e){if(window.getSelection){var i=window.getSelection();i.removeAllRanges(),i.addRange(e)}else document.selection&&e.select&&e.select()},val:function(e,i){if(void 0===i)return Emoji.editableVal(e);i=(i=Emoji.emojiToHTML(i,!0)).replace(/ $/,"&nbsp;"),e.setValue?(e.setValue(i),e.phonblur&&e.phonblur()):e.innerHTML=i,Emoji.updateStickersHints();var t=data(e,"composer");return t&&window.Composer&&setTimeout(Composer.updateAutoComplete.pbind(t)),!0},editableVal:function(e,i){if(!e)return"";if("TEXTAREA"==e.tagName)return val(e);for(var t=e.firstChild,o="",r=new RegExp("^(DIV|P|LI|OL|TR|TD|BLOCKQUOTE)$"),s=void 0;t;){switch(t.nodeType){case 3:o+=s=t.data.replace(/^\n|\n$/g," ").replace(/[\n\xa0]/g," ").replace(/[ ]+/g," ");break;case 1:if(s=Emoji.editableVal(t),t.tagName&&t.tagName.match(r)&&s){"\n"!=s.substr(-1)&&(s+="\n");for(var n=t.previousSibling;n&&3==n.nodeType&&""==trim(n.nodeValue);)n=n.previousSibling;!n||n.tagName&&(n.tagName.match(r)||"BR"==n.tagName)||(s="\n"+s)}else if("IMG"==t.tagName){var a=Emoji.getCode(t);a&&(i&&i.saveEmoji?s+=Emoji.getEmojiHTML(a):s+=Emoji.codeToChr(a))}else"BR"==t.tagName&&(s+="\n");o+=s}t=t.nextSibling}return o},cssEmoji:{e29da4:[0,"<3"],f09f988a:[1,":-)"],f09f9883:[2,":-D"],f09f9889:[3,";-)"],f09f9886:[4,"xD"],f09f989c:[5,";-P"],f09f988b:[6,":-p"],f09f988d:[7,"8-)"],f09f988e:[8,"B-)"],f09f9892:[9,":-("],f09f988f:[10,";-]"],f09f9894:[11,"3("],f09f98a2:[12,":'("],f09f98ad:[13,":_("],f09f98a9:[14,":(("],f09f98a8:[15,":o"],f09f9890:[16,":|"],f09f988c:[17,"3-)"],f09f98a0:[18,">("],f09f98a1:[19,">(("],f09f9887:[20,"O:)"],f09f98b0:[21,";o"],f09f98b3:[22,"8|"],f09f98b2:[23,"8o"],f09f98b7:[24,":X"],f09f989a:[25,":-*"],f09f9888:[26,"}:)"],f09f918d:[27,":like:"],f09f918e:[28,":dislike:"],e2989d:[29,":up:"],e29c8c:[30,":v:"],f09f918c:[31,":ok:"]},getEmojiHTML:function(e,i,t,o){if(!t&&i)return i;if(o)return'<i class="emoji @'+e+'" emoji="'+e+'"'+(i?' title="'+i+'"':"")+"></i>";var r=window.devicePixelRatio>=2?"_2x":"",s=browser.msie&&Number(browser.version)>8?' contenteditable="false"':"";return'<img class="emoji" src="/emoji/e/'+e+r+'.png"'+(i?' alt="'+i+'"':"")+s+">"},codeToChr:function(e){var i,t=e.length%2==1,o=t?e.slice(0,1):"",r=t?e.slice(1):e,s="";try{s=decodeURIComponent("%"+(i=r,i.split("").reduce(function(e,i,t){var o=(t+1)%2==0;return e+i+(o?" ":"")},"").trim().split(/\s+/)).join("%"))}catch(e){}return o+s},checkEditable:function(e,i,t){var o=i.scrollHeight,r=Emoji.opts[e];if(!r)return!1;r.scPaddings||(r.scPaddings=intval(getStyle(i,"paddingTop"))+intval(getStyle(i,"paddingBottom"))),o-=r.scPaddings;var s=r.tt;if(o>t.height+(browser.mozilla&&r.isChat?0:5)){if(!r.isSized){setStyle(i,{height:t.height+"px",overflowY:"auto"});var n=geByClass1("emoji_smile",r.controlsCont),a=geByClass1("emoji_smile_icon_promo",r.controlsCont),c=ge("im_upload"),u=sbWidth();r.ttWrap&&(u+=getSize(r.ttWrap)[0]-(getXY(r.emojiBtn)[0]-getXY(r.ttWrap)[0])),setStyle(n,vk.rtl?{left:1+u}:{right:1+u}),a&&setStyle(a,vk.rtl?{left:2+u}:{right:2+u}),c&&setStyle(c.parentNode,vk.rtl?{left:1+u}:{right:1+u}),s&&setStyle(s,vk.rtl?{left:(r.ttDiff||31)+u}:{right:(r.ttDiff||31)+u}),r.isSized=!0}}else if(r.isSized){setStyle(i,{height:"auto",overflowY:"hidden"});var l=geByClass1("emoji_smile",r.controlsCont),m=geByClass1("emoji_smile_icon_promo",r.controlsCont),d=ge("im_upload");setStyle(l,vk.rtl?{left:1}:{right:1}),m&&setStyle(m,vk.rtl?{left:2}:{right:2}),d&&setStyle(d.parentNode,vk.rtl?{left:1}:{right:1}),s&&setStyle(s,vk.rtl?{left:r.ttDiff||31}:{right:r.ttDiff||31}),r.isSized=!1}r.onResize&&r.onResize()},stickersHintsShow:function(e,i,t){if(isVisible(e)||fadeIn(e,t),!i.stickerEventsInited){var o=e&&geByClass1("_sticker_hints_inner",e);i.onHintsWheel=Emoji.onWheelStickersHints.pbind(o),addEvent(o,"DOMMouseScroll wheel",i.onHintsWheel),addEvent(document,"keydown",Emoji.stickerHintMove),i.onHintsMouseDown=function(){i.hintsClicked=!0,setTimeout(function(){delete i.hintsClicked},0)},addEvent(e,"mousedown",i.onHintsMouseDown),i.txt&&(i.onTxtFocus&&(removeEvent(i.txt,"focus",i.onTxtFocus),delete i.onTxtFocus),i.onTxtBlur=function(o){if(i.hintsClicked)return cancelEvent(o),!0;Emoji.stickersHintsHide(e,i,t)},addEvent(i.txt,"blur",i.onTxtBlur)),i.stickerEventsInited=!0}Emoji.checkStickersHintsSize(e,i)},stickersHintsHide:function(e,i,t){if(fadeOut(e,t),removeEvent(document,"keydown",Emoji.stickerHintMove),i.onHintsMouseDown&&removeEvent(e,"mousedown",Emoji.onHintsMouseDown),i.onHintsWheel){var o=e&&geByClass1("_sticker_hints_inner",e);removeEvent(o,"DOMMouseScroll wheel",Emoji.onHintsWheel)}i.txt&&(i.onTxtBlur&&(removeEvent(i.txt,"blur",i.onTxtBlur),delete i.onTxtBlur),i.onTxtFocus&&removeEvent(i.txt,"focus",i.onTxtFocus),i.onTxtFocus=function(){var e=i.txt&&geByClass1("_sticker_hints",domPN(i.txt));e&&!isVisible(e)&&(delete i.stickerHintsString,Emoji.checkStickersKeywords(i.id,i,!1))},addEvent(i.txt,"focus",i.onTxtFocus)),delete i.stickerEventsInited,delete Emoji.shownHintId,Emoji.sendHintsLog()},stickerHintOver:function(e){Emoji.stickerHintOut(e),addClass(e,"over")},stickerHintOut:function(e){each(geByClass("over",domPN(e)),function(){removeClass(this,"over")})},stickerHintClick:function(e,i,t,o){var r=Emoji.opts[e]||{},s=r.txt,n=s&&geByClass1("_sticker_hints",domPN(s)),a="suggestion_"+Emoji.getStickersHintsQuery(s);return i<0?Emoji.previewSticker(!1,o,{stickerId:-i,sticker_referrer:a}):(val(s,""),Emoji.stickerClick(e,i,256,t,o,a),r.checkEditable&&r.checkEditable(e,s)),Emoji.stickersHintsHide(n,r,0),!1},stickerHintKeyOver:function(e,i){Emoji.stickerHintOver(i),Emoji.shownHintId=e},stickerHintKeyOut:function(e,i){Emoji.stickerHintOut(i),delete Emoji.shownHintId},stickerHintMove:function(e){var i=Emoji.shownHintId;if(void 0===i)return!0;var t=Emoji.opts[i],o=t&&geByClass1("_sticker_hints",domPN(t.txt));if(o&&isVisible(o)){var r=geByClass1("over",o)||geByClass1("emoji_sticker_item",o);switch(e.keyCode){case KEY.LEFT:return(r=domPS(r))&&(Emoji.stickerHintOver(r),Emoji.checkStickersHintsScroll(r)),cancelEvent(e),!1;case KEY.RIGHT:return(r=domNS(r))&&(Emoji.stickerHintOver(r),Emoji.checkStickersHintsScroll(r)),cancelEvent(e),!1;case KEY.ENTER:return r.click(),cancelEvent(e),!1}}return!0},checkStickersHintsSize:function(e,i,t){t&&(addClass(e,"_margin_transition"),removeClassDelayed(e,"_margin_transition")),setStyle(e,{marginLeft:0});var o=getXY(e),r=getSize(e),s=Emoji.getEmojiTtXY(i.tt);i.tt&&s&&s[0]&&o[0]+r[0]+10>s[0]&&o[1]+r[1]>s[1]&&setStyle(e,{marginLeft:s[0]-o[0]-r[0]-10}),domFC(e)||Emoji.stickersHintsHide(e,i,0)},getEmojiTtXY:function(e){return e&&hasClass(e,Emoji.SHOWN_TT_CLS)?getXY(e):[0,0]},getStickersHintsQuery:function(e){var i=Emoji.val(e);if(i.length>30)return"";var t=window.cur.wallLayer?wkcur:window.cur,o=t.reply_to&&window.Wall&&Wall.getReplyName(t.reply_to[0]);return o&&o[1]&&(i=i.replace(new RegExp("^("+escapeRE(o[1])+")"),"")),each(Emoji.cssEmoji,function(e,t){var o=new RegExp("(\\s|^)("+escapeRE(t[1])+(")"==t[1][t[1].length-1]?"+":"")+")([\\s\\.,]|$)","g");i=i.replace(o,function(i,t,o,r){return(t||"")+Emoji.codeToChr(e)+(r||"")})}),i=function(e){return e.replace(r(),l)}(i=i.replace(/^[\s\uFEFF\xA0]+|[\.!\?\n]+$/g,"").toLowerCase().replace("ё","е"))},checkStickersKeywords:function(e,i,t){if(i.noStickers||!window.stickersKeywords||!window.stickersKeywordsData||!window.stickersKeywordsData.length)return!1;var o=t?0:100,r=i.txt,s=geByClass1("_sticker_hints",domPN(r)),n=function(t){if(Emoji.stickers[Emoji.TAB_RECENT_STICKERS]){var o=Emoji.sortStickersHints(r,window.stickersKeywords[t]),n=Emoji.stickers[Emoji.TAB_RECENT_STICKERS].promoted,a="";each(o,function(){a+=Emoji.render.stickerHintRs(e,this,n[this])}),Emoji.showStickersHints(s,i,a)}},a=function(){var t=Emoji.getStickersHintsQuery(r);if(!s&&!(s=Emoji.initStickersHints(r)))return!1;if(t!=i.stickerHintsString){if(t&&window.stickersKeywords[t]&&window.stickersKeywords[t].length)if(Emoji.stickers[Emoji.TAB_RECENT_STICKERS])n(t);else{var a=i.onRecentEmojiUpdate;i.onRecentEmojiUpdate=function(e){a&&a(),e&&(a?i.onRecentEmojiUpdate=a:delete i.onRecentEmojiUpdate,n(t))},Emoji.emojiLoadMore(e)}else Emoji.stickersHintsHide(s,i,o);i.stickerHintsString=t}};t?a():(clearTimeout(i.stickerHintTT),i.stickerHintTT=setTimeout(a,s&&isVisible(s)?0:200))},showStickersHints:function(e,i,t){var o=e&&geByClass1("_sticker_hints_inner",e);if(!o||i.noStickers)return!1;Emoji.clearHintsLog(),val(o,t),Emoji.stickersHintsShow(e,i,100),o.scrollLeft=0,Emoji.checkStickersHintsScroll(e,o.scrollLeft)},checkStickersHintsScroll:function(e,i){var t=domClosest("_sticker_hints",e),o=t&&geByClass1("_sticker_hints_inner",t),r=t&&geByClass1("_sticker_left",t),s=t&&geByClass1("_sticker_right",t);if(!o)return!1;var n=getSize(r)[0],a=getSize(s)[0];if(hasClass(e,"emoji_sticker_item")){var c=e.offsetLeft-8-n,u=e.offsetLeft+getSize(e)[1]+2+a-o.clientWidth;o.scrollLeft>c&&(o.scrollLeft=c),o.scrollLeft<u&&(o.scrollLeft=u),i=o.scrollLeft}var l=i>0,m=i+o.clientWidth<o.scrollWidth;toggle(r,l),toggleClass(t,"sticker_hints_left_pad",l),toggle(s,m),toggleClass(t,"sticker_hints_right_pad",m),i=void 0===i?o.scrollLeft:i;var d=o.querySelectorAll(".emoji_sticker_item"),D=l?n+8:0,E=m?a+2:0;Emoji.logHints(Array.from(d).filter(function(e){return e.offsetLeft-D>=i&&e.offsetLeft+e.offsetWidth+E-o.clientWidth<=i}).map(function(e){return intval(e.getAttribute("data-sticker-id"))}))},logHints:function(e){Emoji.logHintsTimeout&&clearTimeout(Emoji.logHintsTimeout),Emoji.logHintsTimeout=setTimeout(function(){Emoji.hintsLogBuffer=e.reduce(function(e,i){return e[i]=1,e},Emoji.hintsLogBuffer||{})},Emoji.logHintsDelay)},clearHintsLog:function(){Emoji.logHintsTimeout&&clearTimeout(Emoji.logHintsTimeout),Emoji.hintsLogBuffer={}},sendHintsLog:function(){var e=Emoji.hintsLogBuffer&&Object.keys(Emoji.hintsLogBuffer),i=window.cur&&window.cur.emojiHintsSendLogHash;e&&e.length&&i&&ajax.post("stickers.php",{act:"log_hints",sticker_ids:e,hash:i}),Emoji.clearHintsLog()},scrollStickersHints:function(e,i,t){var o=domClosest("_sticker_hints",e),r=o&&geByClass1("_sticker_hints_inner",o),s=o&&geByClass1("_sticker_left",o),n=o&&geByClass1("_sticker_right",o);if(!r)return!1;var a=r.scrollLeft+i*(r.clientWidth-2*getSize(e)[0]),c=geByClass("emoji_sticker_item",r);each(c,function(e,t){return i>0&&t.offsetLeft-8-getSize(s)[0]>a?(a=c[e-1]&&c[e-1].offsetLeft-8-getSize(s)[0]||a,!1):i<0&&t.offsetLeft+getSize(t)[1]+2+getSize(n)[0]-r.clientWidth>a?(a=t.offsetLeft+getSize(t)[1]+2+getSize(n)[0]-r.clientWidth||a,!1):void 0}),a=Math.max(0,Math.min(r.scrollWidth-r.clientWidth,a)),animate(r,{scrollLeft:a},{duration:Math.abs(r.scrollLeft-a)+50,transition:Fx.Transitions.easeOutCubic}),Emoji.checkStickersHintsScroll(r,a)},onWheelStickersHints:function(e,i){var t=void 0;"wheel"==i.type?t=Math.abs(i.deltaY)>Math.abs(i.deltaX)?-i.deltaY:-i.deltaX:void 0!==i.wheelDeltaY?t=i.wheelDeltaY:void 0!==i.wheelDelta?t=i.wheelDelta:i.detail&&2===i.axis&&(t=-i.detail),Math.abs(t)>=120&&(t=74*Math.max(-1,Math.min(1,t))),e.scrollLeft-=t,Emoji.checkStickersHintsScroll(e,e.scrollLeft),cancelEvent(i)},sortStickersHints:function(e,i){var t=[];Emoji.stickers[-1]&&(t=Emoji.stickers[-1].stickers);var o={},r=[];return each(t,function(){inArray(this[0],i)&&!o[this[0]]&&(r.push(this[0]),o[this[0]]=1)}),each(i,function(){o[this]||r.push(this)}),r},initStickersHints:function(e){return!!e&&domPN(e).insertBefore(se('<div class="_sticker_hints sticker_hints_tt"><div class="sticker_hints_arrow sticker_left _sticker_left" onclick="Emoji.scrollStickersHints(this, -1, event)"></div><div class="_sticker_hints_inner sticker_hints_inner"></div><div class="sticker_hints_arrow sticker_right _sticker_right" onclick="Emoji.scrollStickersHints(this, 1, event)"></div></div>'),e)},updateStickersHints:function(e){Emoji.opts&&each(Emoji.opts,function(i,t){e&&delete t.stickerHintsString,Emoji.checkStickersKeywords(i,t,!0)})},initStickersKeywords:function(){if(!window.stickersKeywordsData){var e=ls.get("stickers_keywords");e&&e.time&&e.time>vkNow()-Emoji.stickersKeywordsExpire&&(window.stickersKeywordsData=e.keywords)}window.stickersKeywordsData&&Emoji.setStickersKeywords(window.stickersKeywordsData)},initPromotedStickerUrls:function(){if(!window.promotedStickerUrls){var e=ls.get("promoted_stickers_urls");if(e&&e.time&&e.time>vkNow()-Emoji.stickersKeywordsExpire)window.promotedStickerUrls=e.stickerUrls;else{ajax.post("al_im.php",{act:"get_promoted_stickers"},{onDone:function(e){ls.set("promoted_stickers_urls",{time:vkNow(),stickerUrls:e}),window.promotedStickerUrls=e}})}}},cachedStickersKeywordsTime:function(){var e=ls.get("stickers_keywords");return e&&e.time?Math.floor(e.time/1e3):0},setStickersKeywords:function(e,i){if(!e)return!1;window.stickersKeywords={};var t=ce("div"),o=[],r="";if(e.forEach(function(e){var i=e.words||[],t=e.user_stickers||[],s=e.promoted_stickers||[],n=t.concat(s.map(function(e){return-e}));i.forEach(function(e){r+="\n"+e,o.push(n)})}),val(t,r),(r=t.textContent||t.innerText)&&r.slice("\n".length).split("\n").forEach(function(e,i){window.stickersKeywords[e]=o[i]}),!Emoji.stickers[-1]){var s=ls.get("recent_stickers");s&&(Emoji.stickers[-1]=s)}i&&(ls.set("stickers_keywords",{time:vkNow(),keywords:e}),Emoji.updateStickersHints(!0))},emojiEnter:function(e,i){var t=Emoji.opts[e],o=(t.ctrlSend?t.ctrlSend():t.noEnterSend)||cur.ctrl_submit&&!t.noCtrlSend;if(t.emojiFocused&&t.emojiOvered&&t.openedByTabKey&&(o?!(i.ctrlKey||browser.mac&&i.metaKey):!i.shiftKey)){if(0===t.curTab){var r=geByTag1("img",t.emojiOvered)||geByTag1("i",t.emojiOvered);Emoji.addEmoji(e,Emoji.getCode(r),t.emojiOvered)}return cancelEvent(i)}return!0},insertHTML:function(e){if(browser.msie&&parseInt(browser.version)<12)if(document.selection){var i=document.selection.createRange();i.pasteHTML&&i.pasteHTML(e)}else{var t=document.getSelection().getRangeAt(0),o=document.createElement("span");t.surroundContents(o),o.innerHTML=e,t.collapse(!1)}else e&&document.execCommand("insertHTML",!1,e)},addEmoji:function(e,i,t){if(!1===e||!1===i)return!1;var o=Emoji.opts[e];if(!(vkNow()-o.ttShowT<Emoji.CLICK_DELAY)){if(o.editable){var r=Emoji.getEmojiHTML(i,Emoji.codeToChr(i),!0),s=o.txt,n=!!window.getSelection&&window.getSelection(),a=!1;if(n&&n.rangeCount){var c=n.getRangeAt(0);a=c.commonAncestorContainer?c.commonAncestorContainer:c.parentElement?c.parentElement():c.item(0)}for(var u=a;u&&u!=s;)u=u.parentNode;var l=s.lastChild||{};browser.mozilla&&"BR"==l.tagName&&!l.previousSibling&&re(s.lastChild),u||Emoji.editableFocus(s,!1,!0),Emoji.insertHTML(r);var m=geByClass("emoji",s);for(var d in m.push.apply(m,geByClass("emoji_css",s)),m)if(m.hasOwnProperty(d)){var D=m[d].previousSibling;if(D&&3==D.nodeType&&D.textContent&&32==D.textContent.charCodeAt(0)){var E=D.previousSibling;E&&3==E.nodeType&&E.textContent&&160==E.textContent.charCodeAt(E.textContent.length-1)&&re(D)}}s.check&&s.check(),setTimeout(Emoji.correctCaret.pbind(s),5),Emoji.onChange(o);var j=data(s,"composer");j&&window.Composer&&Composer.updateAutoComplete(j)}else{var f=o.txt,_=f.value,v=void 0;v=browser.iphone||browser.ipad?Emoji.codeToChr(i):Emoji.cssEmoji[i][1]+" ";var C=void 0,k=void 0;void 0!=f.selectionStart&&void 0!=f.selectionEnd?(C=f.selectionEnd,f.value=_.slice(0,f.selectionStart)+v+_.slice(C),f.selectionStart=f.selectionEnd=C+v.length):void 0!==document.selection&&void 0!==document.selection.createRange&&(f.focus(),(k=document.selection.createRange()).text=v,k.select())}o.checkEditable&&o.checkEditable(e,o.txt),Emoji.checkStickersKeywords(e,o),o.saveDraft&&o.saveDraft(),o.onEmojiAdded&&o.onEmojiAdded(),Emoji.incrRecentEmojiRate(e,i)}},showShadow:function(){return!(browser.msie&&browser.version<10)},scrollToggleArrow:function(e,i,t,o){var r=geByClass1("emoji_tabs_"+i+"_s",t.tt);o?(e?show:hide)(r):e?fadeIn(r,200):fadeOut(r,200),t[i+"Shown"]=e},scrollTabs:function(e,i){var t=Emoji.opts[e];if(t){var o=geByClass1("emoji_tabs_wrap",t.tt),r=o.firstChild.clientWidth-o.clientWidth,s=void 0;if(i){if((s=2==i?o.scrollLeft:o.scrollLeft+170)>=r){s=r;var n=geByClass1("emoji_tabs_r_s",t.tt);fadeOut(n,200),t.rShown=!1,Emoji.scrollToggleArrow(!1,"r",t)}s&&!t.lShown&&Emoji.scrollToggleArrow(!0,"l",t)}i&&2!=i||((s=2==i?o.scrollLeft:Math.max(o.scrollLeft-170,0))<=0&&(s=0,Emoji.scrollToggleArrow(!1,"l",t)),s<r&&!t.rShown&&Emoji.scrollToggleArrow(!0,"r",t)),2!=i&&(t.scrollLeft=s,animate(o,{scrollLeft:s},300))}},scrollToTab:function(e,i){var t=Emoji.opts[i],o=t.tt,r=geByClass1("emoji_tabs_wrap",o),s=geByClass1("emoji_tab_"+e,o);if(s){var n=data(r,"tween");if(!n||!n.isTweening||e!=t.curTab){var a=getSize(s)[0],c=s.offsetLeft,u=getSize(r)[0],l=c-u/2+10;c+a<r.scrollLeft?r.scrollLeft=Math.max(c,r.scrollLeft-u/2):c+a-r.scrollLeft>u&&(r.scrollLeft=Math.min(c+a-r.scrollLeft,r.scrollLeft+u/2)),animate(r,{scrollLeft:l},300,function(){Emoji.scrollTabs(i,2)}),Emoji.selectTab(i,e,s)}}},selectTab:function(e,i,t){var o=Emoji.opts[e],r=o.tt,s=geByClass1("emoji_tabs",r),n=geByClass1("emoji_tab_sel",s);removeClass(n,"emoji_tab_sel"),addClass(t,"emoji_tab_sel"),o.curTab=i,cur.stickersTab=i,ls.set("stickers_tab",i)},tabsWheel:function(e,i){cancelEvent(e);var t=Emoji.opts[i],o=Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX,r=geByClass1("emoji_tabs_wrap",t.tt),s=r.scrollLeft;r.scrollLeft+=o,s!=r.scrollLeft&&Emoji.scrollTabs(i,2)},show:function(e,i){var t=data(domPN(e),"optId");void 0!==t&&Emoji.ttShow(t,e,i)},hide:function(e,i,t){var o=data(domPN(e),"optId");void 0!==o&&Emoji.ttHide(o,e,i,t)},ttShow:function(e,i,t){var o=Emoji.opts[e];clearTimeout(o.ctt),clearTimeout(o.stt),o.scrolling&&(o.afterScrollFn=!1),o.ttShown||(i?o.obj=i:i=o.obj,o.stt=setTimeout(function(){Emoji.ttClick(e,i,!1,!0,t)},Emoji.SHOW_TT_TIMEOUT))},ttHide:function(e,i,t,o){var r=Emoji.opts[e];if(clearTimeout(r.stt),r.ttShown)if(r.scrolling)r.afterScrollFn=Emoji.ttHide.pbind(e,i,t,o);else{i=i||r.obj||geByClass1("emoji_smile",r.controlsCont);var s=function(){Emoji.ttClick(e,i,!0,!1,t)};o?s():(clearTimeout(r.ctt),r.ctt=setTimeout(s,Emoji.HIDE_TT_TIMEOUT))}},ttClick:function(e,i,t,o,r,s){var n=Emoji.opts[e];if(n&&!(t&&!Emoji.shown||o&&Emoji.shown)&&(i||(i=Emoji.shown||ge(-3==cur.peer?"imw_smile":"im_smile")))){i.tt&&i.tt.destroy&&i.tt.destroy(),!n.tt&&n.sharedTT&&n.sharedTT.emojiTT&&(n.tt=n.sharedTT.emojiTT,n.emojiScroll=n.sharedTT.emojiScroll,n.allEmojiId=n.sharedTT.emojiAllId);var a=n.tt;if(!a){var c=ls.get("stickers_tab");c||(c=Emoji.TAB_EMOJI),n.curTab=cur.stickersTab=Emoji.TAB_EMOJI,c==Emoji.TAB_EMOJI||n.noStickers||(Emoji.stickers[Emoji.TAB_RECENT_STICKERS]=ls.get("recent_stickers"),n.curTab=cur.stickersTab=c);var u='<div class="emoji_tabs_l_s" onclick="Emoji.scrollTabs('+e+', 0);"><div class="emoji_sprite emoji_tabs_l_sc"></div><div class="emoji_sprite emoji_tabs_l_si"></div></div><div class="emoji_tabs_r_s" onclick="Emoji.scrollTabs('+e+', 1);"><div class="emoji_sprite emoji_tabs_r_sc"></div><div class="emoji_sprite emoji_tabs_r_si"></div></div>';u+=Emoji.getTabsCode([[0,1]],e),u+='<span class="emoji_tabs_wrap"><span id="emoji_tabs_cont_'+e+'" class="emoji_tabs_cont">',n.noStickers||!1===window.emojiStickers||void 0===window.emojiStickers||(u+=Emoji.getTabsCode(window.emojiStickers,e));var l="",m='onclick="Emoji.showStickersStore('+e+');"',d="showTooltip(this, {text: '"+getLang("global_store_stickers")+"', shift: [4,6,6], showdt: 0, black: 1});";n.rPointer?m+=" onmouseover=\"addClass(this.parentNode.parentNode.parentNode, 'emoji_shop_over');"+d+'" onmouseout="removeClass(this.parentNode.parentNode.parentNode, \'emoji_shop_over\');"':m+=' onmouseover="'+d+'"',u+="</span></span>",n.noStickers||(u+='<a class="fl_r emoji_shop" '+m+'><div class="emoji_sprite emoji_shop_icon">'+(Emoji.hasNewStickers?'<div class="emoji_shop_icon_badge">'+Math.abs(Emoji.hasNewStickers)+"</div>":"")+"</div></a>"),Emoji.showShadow()||(l+=" emoji_no_opacity"),(n.noStickers||n.hideStickersInitial)&&(l+=" emoji_no_tabs"),a=ce("div",{id:"emoji_block_"+e,className:"emoji_tt_wrap tt_down"+l,innerHTML:'<div class="emoji_block_cont"><div class="emoji_block_rel"><div class="emoji_list_cont"><div class="emoji_cats_title_helper"></div><div class="emoji_list"><div class="emoji_scroll emoji_scroll_smiles"></div><div class="emoji_scroll emoji_scroll_stickers"></div></div></div></div><div class="emoji_tabs clear_fix">'+u+"</div></div>",onmouseover:function(i){hasClass(a,"emoji_animated")||Emoji.ttShow(e,!1,i)},onmouseout:function(i){hasClass(a,"emoji_animated")||Emoji.ttHide(e,!1,i)}}),n.tt=a,Emoji.reappendEmoji(e,a),Emoji.emojiOver(e,geByClass1("emoji_scroll_smiles",a).firstChild),each(["emoji_tabs_l_s","emoji_tabs_r_s","emoji_tabs_wrap"],function(){addEvent(geByClass1(this,n.tt),"DOMMouseScroll wheel",function(i){Emoji.tabsWheel(i,e)})}),n.sharedTT&&(n.sharedTT.emojiTT=a),Emoji.checkEmojiSlider(n)}clearTimeout(n.ttEmojiHide),!1!==Emoji.shownId&&Emoji.shownId!=e&&Emoji.ttClick(Emoji.shownId,geByClass1("emoji_smile",Emoji.opts[Emoji.shownId].controlsCont),!0),Emoji.preventMouseOver=!1,n.emojiExpanded||Emoji.emojiExpand(e,a);var D=void 0;return Emoji.shown?(Emoji.hideTt(a),(D=geByClass1("_sticker_hints",domPN(n.txt)))&&isVisible(D)&&Emoji.checkStickersHintsSize(D,n,!0),Emoji.shown=!1,Emoji.shownId=!1,n.ttShown=!1,n.emojiFocused=!1,n.emojiOvered=!1,cur.onMouseClick=!1,removeEvent(document,"keydown",Emoji.emojiMove),removeClass(i,"emoji_smile_on"),n.onHide&&n.onHide(),Emoji.favorite.deleteFavoriteStickerElements(e)):(n.needUpdateRecentStickers&&(Emoji.updateRecentStickers(e),n.needUpdateRecentStickers=!1),n.openedByTabKey=!!s,Emoji.showTt(a),Emoji.repositionEmoji(e,i,a),(D=geByClass1("_sticker_hints",domPN(n.txt)))&&isVisible(D)&&Emoji.checkStickersHintsSize(D,n,!0),Emoji.shownId=e,Emoji.shown=i,cur.emojiList=geByClass1("emoji_list",a),n.ttShown=!0,n.ttShowT=vkNow(),n.emojiFocused=!0,removeEvent(document,"keydown",Emoji.emojiMove),setTimeout(function(){cur.onMouseClick=function(i){for(var t=i.target;t;){if("im_texts"==t.id||hasClass(t,"emoji_tt_wrap")||hasClass(t,"imw_emoji_wrap"))return!1;t=t.parentNode}Emoji.ttClick(e,!1,!0)},addEvent(document,"keydown",Emoji.emojiMove)},0),addClass(i,"emoji_smile_on"),n.emojiScroll&&n.emojiExpanded&&(n.emojiScroll.update(),browser.msie&&0===n.curTab&&n.emojiOvered&&Emoji.scrollToListEl(e,n.emojiOvered)),Emoji.tabSwitch(n.curTab,n.curTab,e),n.onRecentEmojiUpdate&&n.onRecentEmojiUpdate(!0),n.onShow&&n.onShow()),each(geByClass("emoji_smile_icon_promo"),function(e,i){removeEvent(geByClass1("emoji_smile_icon",i.parentNode),"mouseover"),re(i),Emoji.noNewStickers=!0}),n.noStickersStore?addClass(geByClass1("emoji_tabs","emoji_block_"+e),"emoji_tabs_no_store"):removeClass(geByClass1("emoji_tabs","emoji_block_"+e),"emoji_tabs_no_store"),cancelEvent(r)}},curEmojiKeys:{},curEmojiRecent:{},emojiLoadMore:function(e){var i=Emoji.opts[e];if(!i.emojiMoreSt){i.emojiMoreSt=1;var t={act:"get_emoji_list"};Emoji.stickerPacksToLoad&&(t.sticker_packs_to_load=Emoji.stickerPacksToLoad.join(",")),Emoji.hasNewStickers<0&&(t.new_shown=1),ajax.post("al_im.php",t,{onDone:function(t,o,r,s,n){if(Emoji.buildStickersIndex(t),void 0!==t[Emoji.TAB_FAVORITE_STICKERS]){var a=t[Emoji.TAB_FAVORITE_STICKERS];Emoji.tabDefaultId=Emoji.TAB_FAVORITE_STICKERS,Emoji.favoriteAvailable=!0,Emoji.favoriteRemindOn=!!a.remind_on,Emoji.favoriteRemindOff=!!a.remind_off,Emoji.favoriteLimit=a.limit,Emoji.favoriteLimitNoticed=a.limit_noticed,Emoji.sendHintsLogHash=n}s&&extend(cur.lang,s),r?stManager.add([jsc("web/stickers.js")],function(){Emoji.updateEmojiList(t,o,e,i)}):Emoji.updateEmojiList(t,o,e,i)},onFail:function(){i.emojiMoreSt=0}}),Emoji.curEmojiRecent&&i.onRecentEmojiUpdate&&i.onRecentEmojiUpdate()}},buildStickersIndex:function(e){var i={};if(e)for(var t in e)if(e.hasOwnProperty(t)&&t>0&&e[t].stickers)for(var o=e[t].stickers,r=o.length;r--;){var s=o[r];i[s[0]]={sticker:s,packId:t}}Emoji.stickersById=i},updateEmojiList:function(e,i,t,o){Emoji.stickers=e,o.emojiMoreSt=0,Emoji.stickers[-1]&&(ls.set("recent_stickers",Emoji.stickers[-1]),Emoji.updateRecentEmoji(t)),Emoji.stickers[-2],o.allEmojiId=0,o.sharedTT&&(o.sharedTT.emojiAllId=0),Emoji.onStickersLoad&&(o.afterLoad=1),Emoji.onStickersLoad&&window.emojiStickers&&(Emoji.onStickersLoad(),Emoji.onStickersLoad=!1);var r=Emoji.emojiGetRecentFromStorage();r?Emoji.curEmojiRecent=Emoji.filterEmoji(r):(Emoji.emojiOldRecentPrepare(i,t),Emoji.updateEmojiCont(t)),Emoji.updateRecentEmoji(t),o.onRecentEmojiUpdate&&o.onRecentEmojiUpdate(!0)},filterEmoji:function(e){var i=Object.keys(e);e:for(var t in d)if(d.hasOwnProperty(t))for(var o in d[t])if(d[t].hasOwnProperty(o)){var r=d[t][o],s=i.indexOf(r);if(-1!=s&&(i.splice(s,1),0==i.length))break e}var n={};for(var a in e)e.hasOwnProperty(a)&&-1==i.indexOf(a)&&(n[a]=e[a]);return i.length>0&&Emoji.setRecentEmojiList(n),n},emojiGetRecentFromStorage:function(){try{return JSON.parse(localStorage.getItem("emoji_recent_list"))}catch(e){return!1}},emojiOldRecentPrepare:function(e){var i={};for(var t in e)if(e.hasOwnProperty(t)){var o=e[t],r=void 0,s=void 0;isString(o)?(r=1,s=o):(r=o,s=t),i[s]=r}Emoji.setRecentEmojiList(Emoji.filterEmoji(i))},getRecentEmojiSorted:function(){var e=[];for(var i in Emoji.curEmojiRecent)if(Emoji.curEmojiRecent.hasOwnProperty(i)){var t=Emoji.curEmojiRecent[i];e.push([i,t])}e.sort(function(e,i){return i[1]-e[1]});var o=[];for(var r in e)e.hasOwnProperty(r)&&o.push(e[r][0]);return o.slice(0,20)},incrRecentEmojiRate:function(e,i){Emoji.emojiRecentRateTime||(Emoji.emojiRecentRateTime=vkNow()/1e3-6);var t=vkNow()/1e3-Emoji.emojiRecentRateTime;if(t>=6){var o=Math.min(100,Math.floor(t/6));for(var r in Emoji.curEmojiRecent)if(Emoji.curEmojiRecent.hasOwnProperty(r)){if(r==i)continue;Emoji.curEmojiRecent[r]*=Math.pow(.998076,o)}Emoji.emojiRecentRateTime+=6*o}Emoji.curEmojiRecent[i]||(Emoji.curEmojiRecent[i]=0),Emoji.curEmojiRecent[i]+=1;var s=Emoji.getRecentEmojiSorted();d[-1]=s,s.length>=20&&-1==s.indexOf(i)&&(s.splice(-1),s.push(i));var n={};for(var a in s)if(s.hasOwnProperty(a)){var c=s[a];n[c]=Emoji.curEmojiRecent[c]}Emoji.setRecentEmojiList(n),window.Notifier&&Notifier.lcSend("recent_emoji_set",n)},setRecentEmojiList:function(e){localStorage.setItem("emoji_recent_list",JSON.stringify(e)),Emoji.curEmojiRecent=e},updateEmojiCont:function(e){var i=Emoji.opts[e];0==i.curTab&&(val(geByClass1("emoji_scroll_smiles",i.tt),Emoji.getInitEmojiContent(e)),Emoji.updateEmojiCatTitle(e))},ttEmojiList:function(e,i){var t="",o=Emoji.emojiGetRecentFromStorage();o&&Emoji.setRecentEmojiList(o),d[-1]=Emoji.getRecentEmojiSorted();var r=i||Emoji.SORTED_EMOJI_SECTIONS_CODES;for(var s in r)if(r.hasOwnProperty(s)){var n=r[s];t+=Emoji.getEmojiCategoryHtml(e,n)}return t},getInitEmojiContent:function(e){Emoji.setEmojiLastAddedCategoryIdx(e,1);return Emoji.ttEmojiList(e,[-1,1])},getEmojiCategoryHtml:function(e,i){var t="",o=d[i];if(!o.length)return t;var r='<div class="emoji_cat_title_helper" data-id="'+i+'" id="emoji_recent_list'+e+"_"+i+'"><div class="emoji_cat_title">'+getLang("global_emoji_cat_"+(-1==i?"recent":i))+"</div></div>";return t+=r+=Emoji.emojiGetCatCont(e,o)},getEmojiLastAddedCategoryIdx:function(e){return Emoji.opts[e].lastLoadedEmojiCategoriesIdxes[e]},setEmojiLastAddedCategoryIdx:function(e,i){Emoji.opts[e].lastLoadedEmojiCategoriesIdxes[e]=i},addNextEmojiCategoty:function(e){var i=Emoji.opts[e],t=i.tt,o=Emoji.getEmojiLastAddedCategoryIdx(e);if(!i.emojiCategoryAdding&&!i.allEmojiLoaded)if(i.emojiCategoryAdding=!0,o){var r=geByClass1("emoji_scroll_smiles",t);if(o++,Emoji.SORTED_EMOJI_SECTIONS_CODES.length>o){var s=Emoji.SORTED_EMOJI_SECTIONS_CODES[o];r.insertAdjacentHTML("beforeEnd",Emoji.getEmojiCategoryHtml(e,s)),Emoji.setEmojiLastAddedCategoryIdx(e,o),i.emojiScroll.update()}else i.allEmojiLoaded=!0;i.emojiCategoryAdding=!1}else debugLog("No emoji last category idx")},hideTt:function(e){removeClass(e,Emoji.SHOWN_TT_CLS)},showTt:function(e){addClass(e,Emoji.SHOWN_TT_CLS)},emojiGetCatCont:function(e,i){for(var t="",o="",r=i.length-1,s=0;s<=r;s++)o+=Emoji.emojiWrapItem(e,i[s],s),(s>0&&s%10==9||s>=r)&&(t+='<div class="emoji_smiles_row">'+o+"</div>",o="");return t},updateRecentEmoji:function(e){var i=Emoji.getRecentEmojiSorted(),t=Emoji.emojiGetCatCont(e,i),o=ge("emoji_recent_list"+e+"_-1");if(o){for(var r=o.nextSibling;r&&(r=r.nextSibling,hasClass(r.previousSibling,"emoji_smiles_row"));)re(r.previousSibling);for(var s=ce("div",{innerHTML:t}),n=o.nextSibling,a=o.parentNode;r=s.firstChild;)a.insertBefore(r,n)}},updateRecentStickers:function(e){var i=Emoji.opts[e];if(Emoji.stickers[Emoji.TAB_RECENT_STICKERS]&&i&&i.emojiExpanded){var t=ge("emoji_recent_stickers_cont"+e);if(t){val(t,"");for(var o=Emoji.stickers[Emoji.TAB_RECENT_STICKERS].stickers,r=cf(),s=0;s<o.length;s++){var n=Emoji.render.sticker(e,Emoji.TAB_RECENT_STICKERS,o[s]);r.appendChild(n);var a=68*Math.ceil((s+1)/4);i.needLoadStickers.unshift([e+"_"+Emoji.TAB_RECENT_STICKERS+"_"+o[s][0],a])}t.appendChild(r),Emoji.updateStickersPos(e)}}},findStickerIndex:function(e,i){if(e)for(var t=e.stickers,o=t.length;o--;)if(String(t[o][0])===String(i))return o;return-1},findSticker:function(e,i){var t=Emoji.findStickerIndex(e,i);if(-1!==t)return e.stickers[t]},findFavoriteStickerIndex:function(e){return Emoji.findStickerIndex(Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS],e)},findFavoriteSticker:function(e){return Emoji.findSticker(Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS],e)},findRecentStickerIndex:function(e){return Emoji.findStickerIndex(Emoji.stickers[Emoji.TAB_RECENT_STICKERS],e)},findRecentSticker:function(e){return Emoji.findSticker(Emoji.stickers[Emoji.TAB_RECENT_STICKERS],e)},findPackSticker:function(e){if(Emoji.stickersById&&Emoji.stickersById.hasOwnProperty(e))return Emoji.stickersById[e].sticker},isStickersLoaded:function(){if(Emoji.stickers)for(var e in Emoji.stickers)if(Emoji.stickers.hasOwnProperty(e)&&e!==String(Emoji.TAB_RECENT_STICKERS))return!0;return!1},tabs:{favoriteTabContent:function(e,i){var t=Emoji.TAB_FAVORITE_STICKERS,o="emoji_tab emoji_tab_img_cont emoji_tab_favorite emoji_tab_"+t;if(cur.stickersTab===t&&(o+=" emoji_tab_sel"),0===i&&Emoji.isStickersLoaded()){var r=Emoji.stickers[t];i=r?r.stickers.length:0}return 0===i&&(o+=" unshown"),'<a class="'+o+'" onclick="'+e+'"><span class="emoji_tab_icon emoji_sprite emoji_tab_icon_favorite"></span></a>'}},favorite:{reminder:function(e){var i=hasClass(e,"on"),t=i?"favoriteRemindOff":"favoriteRemindOn";if(!Emoji[t]){var o={text:function(){return getLang(i?"purchases_stickers_favorite_rm_tt":"purchases_stickers_favorite_add_tt")},black:1,hidedt:100,typeClass:"tt_black",noZIndex:!0,shift:[10,8]},r=domClosest("ui_scroll_container",e);o.appendEl=r;var s=domClosest("ui_scroll_overflow",e),n=getXYRect(e),a=getXYRect(s),c=n.top-a.top,u=(a.right,n.right,a.bottom-n.bottom),l=n.left-a.left,m=(a.width||a.right-a.left)/2;(!vk.rtl&&l>m||vk.rtl&&l<m)&&(o.needLeft=!0,o.shift[0]=9),o.forcetodown=c<Emoji.FAV_ICON_TT_MIN_HEIGHT,o.forcetoup=u<Emoji.FAV_ICON_TT_MIN_HEIGHT,showTooltip(e,o),Emoji[t]=!0,ajax.post("stickers.php",{act:"tt_favorite_off",tt_type:i?1:2})}},addFavoriteSticker:function(e,i,t){var o=Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS];if(o){var r=Emoji.findPackSticker(i);if(r){r[4]=1,o.stickers.unshift(r);var s=Emoji.opts[e],n=s.deletedFavoriteStickers;for(s.deletedFavoriteStickers=[i];o.stickers.length>Emoji.favoriteLimit;)Emoji.favorite.deleteFavoriteSticker(e,o.stickers[o.stickers.length-1][0]);Emoji.favorite.deleteFavoriteStickerElements(e),s.deletedFavoriteStickers=n;var a=Emoji.findRecentSticker(i);a&&(a[4]=1);var c=ge("emoji_favorite_stickers_cont"+e);if(c){var u=Emoji.opts[e].emojiScroll.data.scrollHeight,l=Emoji.opts[e].emojiScroll.data.scrollTop,m=ge("emoji_sticker_item"+e+"_"+Emoji.TAB_FAVORITE_STICKERS+"_"+i);if(!m){m=Emoji.render.sticker(e,Emoji.TAB_FAVORITE_STICKERS,r),Emoji.render.stickerContent(e,m,!1);var d=domFC(c);d?domInsertBefore(m,d):c.appendChild(m),Emoji.opts[e].emojiScroll.update();var D=Emoji.opts[e].emojiScroll.data.scrollHeight-u;Emoji.opts[e].emojiScroll.scrollTop(l+D),Emoji.updateStickersPos(e)}}var E=geByClass1("emoji_tab_"+Emoji.TAB_FAVORITE_STICKERS);if(hasClass(E,"unshown")&&(Emoji.opts[e].curTab===Emoji.TAB_FAVORITE_STICKERS&&removeClass(geByClass1("emoji_tab_"+Emoji.TAB_RECENT_STICKERS),"emoji_tab_sel"),removeClass(E,"unshown")),Emoji.favorite.updateFavoriteStickerElements(e,i,!0),Emoji.opts[e].deletedFavoriteStickers.length>0){var j=indexOf(Emoji.opts[e].deletedFavoriteStickers,i);-1!==j&&Emoji.opts[e].deletedFavoriteStickers.splice(j,1)}}}},deleteFavoriteSticker:function(e,i,t){var o=Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS];if(o){var r=Emoji.findFavoriteStickerIndex(i);if(-1!==r){if(o.stickers.splice(r,1),Emoji.opts[e].deletedFavoriteStickers.push(i),0===o.stickers.length&&t)addClass(geByClass1("emoji_tab_"+Emoji.TAB_FAVORITE_STICKERS),"unshown"),domData(t.parentElement,"pack-id")===String(Emoji.TAB_FAVORITE_STICKERS)&&addClass(geByClass1("emoji_tab_"+Emoji.TAB_RECENT_STICKERS),"emoji_tab_sel");Emoji.favorite.updateFavoriteStickerElements(e,i,!1);var s=Emoji.findRecentSticker(i);s&&(s[4]=0);var n=Emoji.findPackSticker(i);n&&(n[4]=0)}}},deleteFavoriteStickerElement:function(e,i){re("emoji_sticker_item"+e+"_"+Emoji.TAB_FAVORITE_STICKERS+"_"+i)},deleteFavoriteStickerElements:function(e){var i=Emoji.opts[e];i.deletedFavoriteStickers.length>0&&(i.deletedFavoriteStickers.forEach(function(i){Emoji.favorite.deleteFavoriteStickerElement(e,i)}),i.deletedFavoriteStickers=[],Emoji.updateStickersPos(e))},deleteFavoriteStickerElementsAsync:function(e){var i=Emoji.opts[e];i.deleteFavoriteStickersTimeout||(i.deleteFavoriteStickersTimeout=setTimeout(function(){Emoji.favorite.deleteFavoriteStickerElements(e),i.deleteFavoriteStickersTimeout=null},Emoji.DELETE_FAV_STICKER_ELEMENTS_DELAY))},updateFavoriteStickerElements:function(e,i,t){geByClass("sticker_item_"+i).forEach(function(e){domData(e,"fav",t?"1":null),toggleClass(e,"faved",t),toggleClass(geByClass1("emoji_sticker_item_fav",e),"on",t)})}},updateEmojiCatTitle:function(e){var i=Emoji.opts[e];if(i&&i.emojiScroll){var t=ge("emoji_block_"+e),o=geByClass("emoji_cat_title_helper",t),r=i.emojiScroll.data.scrollTop,s=geByClass1("emoji_cats_title_helper",i.tt),n=void 0,a=void 0,c=void 0;if(o.length){var u=o[0];n=Emoji.getSizeCached(u)[1]}for(var l=o.length-1;l>=0;l--)if(r>o[l].offsetTop-n){a=o[l],c=l;break}if(!a)return debugLog("title not found");var m=intval(attr(a,"data-id"));if(i.curEmojiCatId!=m){i.curEmojiCatId=m;var d=[a],D=o[c-1];D&&(addClass(D,"emoji_cat_title_fix"),setStyle(D.firstChild,"transform","translateY("+(a.offsetTop-D.offsetTop-n)+"px)"));for(var E=a.nextSibling;E;)hasClass(E,"emoji_cat_title_fix")&&d.push(E),E=E.nextSibling;for(var j in d)d.hasOwnProperty(j)&&(removeClass(d[j],"emoji_cat_title_fix"),setStyle(d[j].firstChild,"transform","translateY(0px)"));val(s,""),i.emojiTitleHelperIsSet=0}!i.emojiTitleHelperIsSet&&r>=a.offsetTop&&r>0?(val(s,val(a)),i.emojiTitleHelperIsSet=1):i.emojiTitleHelperIsSet&&(r<a.offsetTop||0==r)&&(val(s,""),i.emojiTitleHelperIsSet=0)}},emojiWrapItem:function(e,i,t){var o=Emoji.cssEmoji[i],r=void 0;r=o?' title="'+o[1]+'"':"";var s="";return browser.mobile||(s=' onmouseover="return Emoji.emojiOver('+e+', this, true);"'),'<a class="emoji_smile_cont '+("2764"!=i&&t&&t<54?"emoji_smile_shadow":"")+'" '+r+" onmousedown=\"Emoji.addEmoji(Emoji.shownId, '"+i+'\', this); return cancelEvent(event);" onclick="return cancelEvent(event);" '+s+'><div class="emoji_bg"></div><div class="emoji_shadow"></div>'+Emoji.getEmojiHTML(i,!1,!1,!0)+"</a>"},reappendEmoji:function(e,i){var t=Emoji.opts[e];t&&t.rceCont&&(t.addMediaBtn?t.sendWrap.insertBefore(t.rceCont,t.addMediaBtn):t.sendWrap.appendChild(t.rceCont)),i&&(t.ttWrap?t.ttWrap.appendChild(i):t.emojiWrap?t.emojiWrap.appendChild(i):t.obj.appendChild(i),clearTimeout(cur.ttEmojiHide),Emoji.hideTt(i))},ttCalcHeight:function(e,i,t){window.headH=window.headH||ge("page_header")&&Emoji.getSizeCached(ge("page_header"))[1]||0;var o=(window.pageNode&&window.browser.mozilla?Math.min(getSize(pageNode)[1],window.lastWindowHeight):window.lastWindowHeight)||getScroll()[3],r=window.scrollGetY?scrollGetY():getScroll()[1],s=getXY(i)[1],n=Emoji.getSizeCached(i)[1],a=geByClass1("emoji_list",t),c=Emoji.opts[e].emojiSmileHeigh,u=window.headH,l=Emoji.opts[e].emojiRowsCount;isAncestor(i,pageNode)||(u=0),setStyle(a,{height:l*c+8});for(var m,d,D,E=r+u,j=r+o,f=t,_=getSize(t)[1],v=void 0;f!==bodyNode&&(f=domClosestOverflowHidden(f));){var C=getXY(f)[1];E=Math.max(E,C),j=Math.min(j,C+getSize(f)[1])}for(d=j-s-n-9,v=(m=s-9-E)<_&&d<_?m>=d:m>=_,Emoji.opts[e].forceUp&&(v=!0),D=v?m:d;D<_&&l>3;)l--,_-=c;Emoji.opts[e].emojiRowsCount=l,Emoji.opts[e].emojiSmileHeigh=c,setStyle(a,{height:l*c+8}),toggleClass(t,"tt_down",v),toggleClass(t,"tt_up",!v)},repositionEmoji:function(e,i,t){var o=Emoji.opts[e],r=void 0;if(o){if(t.parentNode&&getXY&&getStyle&&setStyle&&geByClass&&(r=geByClass1("emoji_rpointer",t))){var s=parseInt(getStyle(t,"width")),n=getXY(i)[0],a=parseInt(getStyle(i,"width")),c=getXY(t.parentNode)[0];n+a/2<283?(setStyle(t,"left",-s-c),setStyle(r,"left",n+a/2-20+"px")):(setStyle(t,"left",""),setStyle(r,"left",""))}else setStyle(t,"left","");var u=geByClass1("emoji_list",t),l=geByClass1("emoji_smile_cont",u);if(Emoji.opts[e].emojiSmileHeigh=l&&Emoji.getSizeCached(l)[1]||26,Emoji.opts[e].emojiRowsCount=9,Emoji.ttCalcHeight(e,i,t),o.ttWrap){var m=getSize(o.ttWrap)[0]-(getXY(o.emojiBtn)[0]-getXY(o.ttWrap)[0]);setStyle(t,"right",m-o.ttDiff+"px")}}},emojiOver:function(e,i,t){if(browser.mobile||t&&Emoji.preventMouseOver)return!0;var o=Emoji.opts[e];addClass(i,"emoji_over"),o.emojiOvered&&o.emojiOvered!=i&&removeClass(o.emojiOvered,"emoji_over"),o.emojiOvered=i},emojiExpand:function(e,i){var t=Emoji.opts[e];addClass(i,"emoji_expanded"),Emoji.emojiLoadMore(e),t.emojiScroll?t.emojiScroll.update():(t.emojiScroll=new uiScroll(geByClass1("emoji_list",i),{theme:"default emoji no_transition",shadows:!0,global:!0,noForceReFlow:!0,ondragstart:function(){t.scrolling=!0},ondragstop:function(){t.scrolling=!1,isFunction(t.afterScrollFn)&&t.afterScrollFn()},onscrollstart:function(){window.tooltips&&tooltips.destroyAll(),t.scrollStarted=!0},onupdate:function(i){t.curTab==Emoji.TAB_EMOJI?Emoji.updateEmojiCategories(i,t,e):Emoji.updateShownStickers(e)}}),t.imagesLoader=t.imagesLoader||imagesLoader(t.emojiScroll.scroller,{use_iframe:!0,need_load_class:"emoji_need_load"}),t.sharedTT&&(t.sharedTT.emojiScroll=t.emojiScroll)),t.emojiExpanded=!0},updateEmojiCategories:function(e,i,t){e.data.scrollBottom-Emoji.BOTTOM_REST_FOR_ADD_EMOJI_CATEGORY<=0&&i.scrollStarted&&setTimeout(function(){Emoji.addNextEmojiCategoty(t),Emoji.updateEmojiCatTitle(t)},0),Emoji.updateEmojiCatTitle(t)},updateShownStickers:function(e,i){var t=Emoji.opts[e];if(t.emojiScroll&&t.stickersSplitersPos){t.needLoadStickers||(t.needLoadStickers=[]);var o=t.emojiScroll.data.scrollTop,r=o,s=o+t.emojiScroll.data.viewportHeight,n=t.needLoadStickers;clearTimeout(t.preloadStickersTimer);for(var a=[],c=0;c<n.length;c++){var u=n[c];if(u[1]+72>=r&&u[1]<=s){var l=ge("emoji_sticker_item"+u[0]);if(!l||hasClass(l,"__loaded"))continue;var m=Emoji.render.stickerContent(e,l,!0);a.push([m,u[0]])}}if(Emoji.loadStickers(e,a),a.length||Emoji.preloadStickers(e),!(i||t.scrollAnimation||Emoji.onStickersLoad)){for(var d=-1,D=0;D<t.stickersSplitersPos.length;D++){var E=t.stickersSplitersPos[D];if(!(E[1]-30<o))break;d=E[0]}d!=Emoji.TAB_FAVORITE_STICKERS&&Emoji.favorite.deleteFavoriteStickerElementsAsync(e),t.curTab!=d&&Emoji.scrollToTab(d,e)}}},loadStickers:function(e,i){var t=Emoji.opts[e];if(i.length){for(var o={},r=0;r<i.length;r++){var s=i[r][0]+":"+i[r][1];t.imagesLoading[s]&&(o[s]=t.imagesLoading[s],delete t.imagesLoading[s],i.splice(r,1),r--)}for(var n in t.imagesLoading)if(t.imagesLoading.hasOwnProperty(n)){var a=t.imagesLoading[n];if(!a)return;a.src=""}for(var c in t.imagesLoading=o,i)if(i.hasOwnProperty(c)){var u=i[c][0]+":"+i[c][1];t.imagesLoading[u]=t.imagesLoader.iloader.add(i[c][0],Emoji.onStickerLoaded,e+":"+i[c][1])}}},preloadStickers:function(e){var i=Emoji.opts[e];i.imagesLoading&&Object.keys(i.imagesLoading).length>0||(clearTimeout(i.preloadStickersTimer),i.preloadStickersTimer=setTimeout(function(){var t=i.emojiScroll.data.scrollTop,o=i.emojiScroll.data.viewportHeight,r=t+o,s=t-o,n=t,a=r,c=r+o,u=geByClass1("emoji_scroll_stickers",i.tt);if(isVisible(u)){for(var l=u.firstChild,m=[];l;){if(hasClass(l,"emoji_sticker_item")&&!hasClass(l,"__loaded")){var d=l.offsetTop;if(d>=s&&d<=n||d>=a&&d<=c){var D=l.id.replace("emoji_sticker_item",""),E=Emoji.render.stickerContent(e,l,!0);m.push([E,D])}}l=l.nextSibling}Emoji.loadStickers(e,m)}},50))},onStickerLoaded:function(e){var i=String(this).split(":"),t=i[1],o=intval(i[0]),r=Emoji.opts[o],s=ge("emoji_sticker_item"+t);if(s){var n=geByTag1("img",s);if(n){addClass(s,"__loaded"),attr(n,"src",e),delete Emoji.opts[o].imagesLoading[e+":"+t];for(var a=0;a<r.needLoadStickers.length;a++){if(t==r.needLoadStickers[a][0]){r.needLoadStickers.splice(a,1);break}}Object.keys(Emoji.opts[o].imagesLoading).length||Emoji.preloadStickers(o)}}},emojiMove:function(e){var i=Emoji.shownId,t=Emoji.opts[i];if(Emoji.shown&&t&&t.emojiFocused&&t.openedByTabKey){var o=null;if(t.emojiOvered)switch(e.keyCode){case KEY.LEFT:o=Emoji.getEmojiEl(t.emojiOvered,"left"),cancelEvent(e);break;case KEY.RIGHT:o=Emoji.getEmojiEl(t.emojiOvered,"right"),cancelEvent(e);break;case KEY.UP:o=Emoji.getEmojiEl(t.emojiOvered,"up");break;case KEY.DOWN:o=Emoji.getEmojiEl(t.emojiOvered,"down");break;case KEY.ENTER:if(!Emoji.emojiEnter(i,e))return cancelEvent(e),!1;break;default:return!0}else o=Emoji.getFirstEmojiEl(i);if(o)return Emoji.preventMouseOver=!0,Emoji.emojiOver(i,o),Emoji.scrollToListEl(i,o),!1}return!0},scrollToListEl:function(e,i){var t=Emoji.opts[e];if(t&&t.emojiScroll){var o=i.offsetTop,r=Math.max(o+30-t.emojiScroll.data.viewportHeight,Math.min(t.emojiScroll.data.scrollTop,o-30));t.emojiScroll.data.scrollTop!=r&&t.emojiScroll.scrollTop(r)}},anim:function(e,i){clearInterval(cur._imAnim);var t=Math.floor(300/13),o=0,r=domLC(e),s=domFC(e),n=i?0:45,a=i?45:0,c=i?1:0,u=i?0:1;cur._imAnim=setInterval(function(){var l=++o>=t?a:n+1.95*o*(i?1:-1),m=l-45,d=o>=t?u:c+1/(300/13)*o*(i?-1:1),D=1-d;r.style.WebkitTransform=r.style.OTransform=r.style.transform="rotate("+l+"deg)",s.style.WebkitTransform=s.style.OTransform=s.style.transform="rotate("+m+"deg)",r.style.opacity=d,s.style.opacity=D,o>=t&&(clearInterval(cur._imAnim),(i?addClass:removeClass)(e,"emoji_smile_on"),r.style.WebkitTransform=r.style.OTransform=r.style.transform=s.style.WebkitTransform=s.style.OTransform=s.style.transform=r.style.opacity=s.style.opacity="")},13)},tplSmile:function(e){return'<div class="emoji_smile_wrap _emoji_wrap"><div class="emoji_smile _emoji_btn" title="'+e+'" onmouseover="return Emoji.show(this, event);" onmouseout="return Emoji.hide(this, event);" onclick="return cancelEvent(event);"><div class="emoji_smile_icon"></div></div></div>'},emojiToHTML:function(e,i,t){if(browser.ipad||browser.iphone)return e;e=(e+"").replace(/&nbsp;/g," ").replace(/<br>/g,"\n");for(var o=0;o<2;o++)Object.keys(n).forEach(function(i){e.replace(n[i],function(e,t,o,r){return(t||"")+Emoji.getEmojiHTML(i)+(r||"")})});return Object.keys(a).forEach(function(i){e=e.replace(a[i],function(e,t,o){return Emoji.getEmojiHTML(i)+(o||"")})}),e=e.replace(/\n/g,"<br>"),i&&(e=e.replace(/\uFE0F/g,"").replace(Emoji.emojiRegex,Emoji.emojiReplace)),e},emojiReplace:function(e){var i=u(e),t=Object(o.b)(e);return Emoji.getEmojiHTML(i,t,!0)},emojiRegex:r(),getCode:function(e){var i=!1;if("emoji_css"==e.className)i=e.getAttribute("emoji");else if(-1!=e.className.indexOf("emoji")){var t=e.src&&e.src.match(/\/([a-f0-9*]+)(_2x)?.png/);i=t?t[1]:e.getAttribute("emoji")}return i},getTabCont:function(e,i){var t="";if(i){var o="",r="",s=Emoji.opts[e].forceStickerPack;for(var n in window.emojiStickers)if(window.emojiStickers.hasOwnProperty(n)){var a=window.emojiStickers[n][0],c=window.emojiStickers[n][1],u=window.emojiStickers[n][4]&&s==a;if(!c&&!u)continue;var l=Emoji.stickers[a];if(!l)continue;var m=a===Emoji.TAB_RECENT_STICKERS,d=a===Emoji.TAB_FAVORITE_STICKERS,D='<div class="clear emoji_stickers_spliter" id="emoji_tab_cont_'+a+"_"+e+'"></div>';m?D+='<div class="emoji_recent_stickers_cont" id="emoji_recent_stickers_cont'+e+'">':d&&(D+='<div class="emoji_favorite_stickers_cont" id="emoji_favorite_stickers_cont'+e+'">');var E=l.stickers;for(var j in E)E.hasOwnProperty(j)&&(D+=Emoji.render.stickerRs(e,a,E[j]));m?o=D+"</div>":d?r=D+"</div>":u?t=D+t:t+=D}t=r+o+t}else t=Emoji.ttEmojiList(e);return t},updateStickersCont:function(e){var i=Emoji.opts[e],t=Emoji.getTabCont(e,Emoji.tabDefaultId);geByClass1("emoji_scroll_stickers",i.tt).innerHTML=t,i.initedStickers=1,i.imagesLoading=[],clearTimeout(i.preloadStickersTimer),Emoji.updateStickersPos(e)},updateStickersPos:function(e){for(var i=Emoji.opts[e],t=[],o=[],r=geByClass1("emoji_scroll_stickers",i.tt).firstChild,s=!1,n=!1;r;){if(!s&&hasClass(r,"emoji_recent_stickers_cont")?(r=r.firstChild,s=!0):!n&&hasClass(r,"emoji_favorite_stickers_cont")&&r.firstChild&&(r=r.firstChild,n=!0),hasClass(r,"emoji_sticker_item")){var a=r.id.replace("emoji_sticker_item","");t.push([a,r.offsetTop])}else if(hasClass(r,"emoji_stickers_spliter")){var c=r.id.replace("emoji_tab_cont_","").split("_");o.push([intval(c[0]),r.offsetTop])}(!r.nextSibling&&s||!r.nextSibling&&n)&&(r=r.parentNode),r=r.nextSibling}i.needLoadStickers=t,i.stickersSplitersPos=o},stickerItem:function(){return'<a id="emoji_sticker_item%optId%_%selId%_%stickerId%" data-opt-id="%optId%" data-sticker-id="%stickerId%" data-pack-id="%selId%" data-src="%stickerUrl%" data-fav="%fav%" data-fav-hash="%favHash%" class="emoji_sticker_item sticker_item_%stickerId% %favClass%" onclick="Emoji.stickerClick(%optId%, %stickerId%, %size%, \'%stickerUrl%\', this, \'%referrer%\');"></a>'},stickerItemAnimation:function(){return'<a id="emoji_sticker_item%optId%_%selId%_%stickerId%" data-opt-id="%optId%" data-uniq-id="%uniqId%" data-sticker-id="%stickerId%" data-pack-id="%selId%" data-src="%stickerUrl%" data-animation-path="%animationUrl%" data-fav="%fav%" data-fav-hash="%favHash%" class="emoji_sticker_item sticker_item_%stickerId% %favClass%" onclick="Emoji.stickerClick(%optId%, %stickerId%, %size%, \'%stickerUrl%\', this, \'%referrer%\');"></a>'},hintsStickerItemAnimation:function(){return'<a id="emoji_sticker_item%optId%_%selId%_%stickerId%" data-pack-id="%selId%" data-sticker-id="%stickerId%" class="emoji_sticker_item %class%" onclick="%onclick%" onmouseover="Emoji.stickerHintOver(this)" onmouseout="Emoji.stickerHintOut(this)" onmouseenter="StickersAnimation.loadAndPlaySticker(this);" data-animation-path="%animationUrl%" data-uniq-id="%uniqId%" data-sticker-id="%stickerId%"><img class="emoji_sticker_image sticker_img" src="%stickerUrl%" /></a>'},hintsStickerItem:function(){return'<a id="emoji_sticker_item%optId%_%selId%_%stickerId%" data-pack-id="%selId%" data-sticker-id="%stickerId%" class="emoji_sticker_item %class%" onclick="%onclick%" onmouseover="Emoji.stickerHintOver(this)" onmouseout="Emoji.stickerHintOut(this)"><img class="emoji_sticker_image" src="%stickerUrl%" /></a>'},tabSwitch:function(e,i,t,o){if(void 0!=e){var r=Emoji.opts[t],s=r.tt;"number"==typeof e&&(e=geByClass1("emoji_tab_"+e,s));var n=geByClass1("emoji_scroll_smiles",s),a=geByClass1("emoji_scroll_stickers",s),c=geByClass1("emoji_cats_title_helper",s);if(val(c,""),r.curEmojiCatId=null,i==Emoji.TAB_EMOJI)hide(a),show(n),show(c),r.emojiInited||(val(n,Emoji.getInitEmojiContent(t)),r.emojiInited=!0),r.imagesLoader&&r.imagesLoader.processLoad(),r.emojiOvered&&0===r.curTab&&Emoji.emojiOver(t,Emoji.getFirstEmojiEl(t)),r.curTab!=Emoji.TAB_EMOJI&&r.emojiScroll&&r.emojiScroll.scrollTop(0),Emoji.updateRecentEmoji(t),Emoji.updateEmojiCatTitle(t);else{hide(n),show(a),hide(c);var u=Emoji.stickers&&clone(Emoji.stickers);u&&delete u[Emoji.TAB_RECENT_STICKERS],!window.emojiStickers||!u||isEmpty(u)||!u[i]&&i!=Emoji.TAB_RECENT_STICKERS?(Emoji.onStickersLoad=function(){Emoji.updateTabsOpt(t),Emoji.tabSwitch(i,i,t,o)},Emoji.stickersLoadingProgress(t,i,e),r.stickersInited=!1,r.curTab=null,Emoji.emojiLoadMore(t)):r.stickersInited||(Emoji.updateStickersCont(t),r.stickersInited=!0),(r.curTab!=i||r.afterLoad)&&(Emoji.scrollToStickerPack(t,i,r.curTab==Emoji.TAB_EMOJI),r.afterLoad=0),Emoji.updateShownStickers(t,!0)}Emoji.onStickersLoad&&i!=Emoji.TAB_EMOJI||Emoji.selectTab(t,i,e)}},getFirstEmojiEl:function(e){for(var i=Emoji.opts[e],t=geByClass1("emoji_scroll_smiles",i.tt).firstChild;t;){if(hasClass(t,"emoji_smiles_row"))return t.firstChild;t=t.nextSibling}return null},getEmojiEl:function(e,i){for(var t=0,o=e.parentNode,r=0,s=void 0,n=o.firstChild;n&&(r++,n!==e);)n=n.nextSibling;for(;e&&!s;){if("left"==i||"right"==i)(s="left"==i?e.previousSibling:e.nextSibling)||("left"==i?(i="up",r=10):(i="down",r=1));else{if("up"!=i&&"down"!=i)break;for(var a=o;a&&(a="up"==i?a.previousSibling:a.nextSibling)&&!hasClass(a,"emoji_smiles_row"););if(!a)break;if(r&&a)for(var c=0,u=a.firstChild;u&&c<r;){if(++c>=r){s=u;break}u=u.nextSibling}if(s||!a)break;s="up"==i||r&&"down"==i?a.lastChild:a.firstChild}if(++t>20){debugLog("ERR!!");break}}return s},stickerClick:function(e,i,t,o,r,s){var n=Emoji.opts[e];if(!(vkNow()-n.ttShowT<Emoji.CLICK_DELAY||n.preventDoubleClick&&vkNow()-n.preventDoubleClick<Emoji.CLICK_DELAY)){Emoji.opts[e].preventDoubleClick=vkNow();var a=parseInt(attr(r,"data-pack-id")),c=!0;if(window.emojiStickers&&each(window.emojiStickers,function(e,i){if(i[0]==a)return c=!!i[1],!1}),c){var u=Emoji.findRecentStickerIndex(i);-1!==u?Emoji.stickers[Emoji.TAB_RECENT_STICKERS].stickers.splice(u,1):Emoji.stickers[Emoji.TAB_RECENT_STICKERS]||(Emoji.stickers[Emoji.TAB_RECENT_STICKERS]={stickers:[]});var l=domData(r,"animation-path")||"",m=domData(r,"fav"),d=domData(r,"fav-hash");Emoji.stickers[Emoji.TAB_RECENT_STICKERS].stickers.unshift([i,t,o,l,m,d]),ls.set("recent_stickers",Emoji.stickers[Emoji.TAB_RECENT_STICKERS]),n.needUpdateRecentStickers=!0}n.onStickerSend&&n.onStickerSend(i,s,"animation"),statlogsValueEvent("stickers_usage",n.ref,i,s),Emoji.ttHide(e,!1,!1,!0),n.recentSticker=i}},stickerOver:function(e,i){var t={act:"a_stickers_hover",sticker_id:e,from:cur.module};if(isObject(i.tt)&&"IMG"===i.firstChild.nodeName)return i.tt.show();ajax.post("al_im.php",t,{onDone:function(e,t){var o=(cur.tooltips||[]).length,r=["subscribe_post_tt","sticker_extra_tt","sticker_extra_tt"+o,e.image?"":"tt_text_only"];if(r=r.join(" "),e.show){var s={index:o,className:r,content:t,shift:function(){return[-138,0,-200]},hasover:1,slideX:15,showsp:150,cache:1,forcetodown:!0,no_shadow:!0,dir:"left",onShowStart:function(e){var i=e.container,t=getSize(e.container)[1];if(!(t>=225)){var o=intval((225-t)/2)+10,r=intval(getStyle(i,"top",!0));setStyle(i,"top",r+o)}}};gpeByClass("_im_peer_history_w",i)&&(s.appendParentCls="_im_peer_history_w"),showTooltip(i,s)}}})},selectPeer:function(e){if(void 0!==e){var i=Emoji.opts[e];if(i.peer)return i.peer}var t=cur.peer||(cur.mbTo?cur.mbTo[0]:"");if(-3==t&&cur.wdd.imw_dd){var o=0;for(var r in cur.wdd.imw_dd.selected)cur.wdd.imw_dd.selected.hasOwnProperty(r)&&(t=cur.wdd.imw_dd.selected[r][0],o+=1);o>1&&(t="")}return t},showMyStickers:function(){cur.boxMyStickers=showBox("al_im.php",{act:"stickers_my"},{dark:1,stat:["im.css","imn.js","sorter.js"]})},showStickersStore:function(e,i){var t={act:"stickers_store",peer:Emoji.selectPeer(!1!==e?e:void 0),box:1};i&&(t.from=i),cur.boxStickersStore=showBox("al_im.php",t,{dark:1,stat:["im.css","imn.js","page_help.css","sorter.js"]}),each(geByClass("emoji_smile_icon_promo"),function(e,i){geByClass1("emoji_smile_icon",i.parentNode),re(i)}),each(geByClass("emoji_shop_icon_badge"),function(e,i){re(i)}),Emoji.hasNewStickers=!1},previewSticker:function(e,i,t,o){if(t=t||{},o&&checkEvent(o))return!0;var r={act:"sticker_preview",pack_id:e},s=Emoji.selectPeer();if(t.peer?r.peer=t.peer:s&&(r.peer=s),t.preview&&(r.preview=1),t.stickerId&&(r.sticker_id=t.stickerId),r.sticker_referrer=t.sticker_referrer||"store",t.name){var n=nav.objLoc[0].split("/");"stickers"==n[0]&&n[1]!=t.name&&nav.setLoc({0:"stickers/"+t.name})}return cur.boxStickersPreview=showBox("al_im.php",r,{dark:1,stat:["im.css","imn.js"],onFail:function(i){if(window.cur.emojiStickersDisabled||(window.cur.emojiStickersDisabled={}),e&&(window.cur.emojiStickersDisabled[e]=!0),i)return!0}}),cancelEvent(o),!1},isStickerPackEnabled:function(e,i){var t=!1;if(!window.emojiStickers&&i)return ajax.post("al_im.php",{act:"a_stickers_list"},{onDone:function(e){window.emojiStickers=e,i()}}),0;if(!window.emojiStickers)return!1;for(var o in window.emojiStickers)if(window.emojiStickers.hasOwnProperty(o)&&window.emojiStickers[o][0]==e){t=!!window.emojiStickers[o][1];break}return t},clickSticker:function(e,i,t){if(window.cur.emojiStickersDisabled&&window.cur.emojiStickersDisabled[e])return!0;var o=void 0;if(i){if(0===(o=Emoji.isStickerPackEnabled(e,Emoji.clickSticker.pbind(e,i,t))))return!1;if(o){var r=!1;if(i.getAttribute("contenteditable"))r=i;else{for(var s=i.parentNode,n=!1;(s=s.parentNode)&&!hasClass(s,"js-im-page");){if(hasClass(s,"fc_tab")){n=!0;break}if(hasClass(s,"mv_chat"))break}if(!s)return!1;n?r=geByClass1("fc_editable",s):hasClass(s,"js-im-page")?r=geByClass1("_im_text"):hasClass(s,"mv_chat")&&(r=domByClass(s,"mv_chat_reply_input"))}if(r){var a=Emoji.opts[r.emojiId];Emoji.ttClick(r.emojiId,geByClass1("_emoji_btn",r.parentNode.parentNode),!1,!0);var c=geByClass1("emoji_tab_"+e,a.tt),u=Emoji.stickers&&clone(Emoji.stickers);u&&delete u[-1],!u||isEmpty(u)?(Emoji.onStickersLoad=Emoji.tabSwitch.pbind(e,e,r.emojiId),Emoji.stickersLoadingProgress(r.emojiId,e,c)):(a.initedStickers=0,Emoji.tabSwitch(c,e,r.emojiId))}}}return i&&o||Emoji.previewSticker(e,!1,{sticker_referrer:"message"}),t&&cancelEvent(t),!1},stickersLoadingProgress:function(e,i,t){var o=Emoji.opts[e];removeClass(geByClass1("emoji_tab_sel",o.tt),"emoji_tab_sel"),addClass(t,"emoji_tab_sel"),geByClass1("emoji_scroll_stickers",o.tt).innerHTML='<div class="emoji_scroll_progress">'+rs(vk.pr_tpl,{id:"",cls:"pr_big"})+"</div>"},buyStickers:function(e,i,t,o,r){if(t&&hasClass(t,"secondary"))return!0;var s=Emoji.selectPeer();return ajax.post("/al_im.php",{act:"a_stickers_buy",pack_id:e,hash:o,peer:s,sticker_referrer:unclean(r)},{onDone:function(i,t,o,s,n,a){if(each(geByClass("_sticker_btn_"+e),function(){this.innerHTML=s,this.onmouseover="",this.onclick="",addClass(this,"secondary")}),cur.boxStickersPreview&&cur.boxStickersPreview.hide(),n&&cur.boxStickersStore&&cur.boxStickersStore.hide(),showDoneBox(i),t){Emoji.stickers[Emoji.TAB_RECENT_STICKERS].promoted=a,Emoji.updateTabs(t,o,!0);try{vk.widget&&window.Rpc&&window.Rpc.callMethod("proxy","updateStickers")}catch(e){}"video_live"===r&&window.Videoview&&window.Videoview.onStickersPurchased(e)}var c=cur.tabbedStickersBox;if(c&&c.tbUpdate)for(var u in c.tbUpdate)c.tbUpdate.hasOwnProperty(u)&&(c.tbUpdate[u]=1);var l=cur.emojiId&&cur.emojiId[cur.peer];if(l){var m=geByClass1("emoji_tab_"+e,Emoji.opts[l].tt);m&&Emoji.tabSwitch(m,e,l)}},showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t),onFail:function(e){return e&&setTimeout(showFastBox(getLang("global_error"),e).hide,3e3),!0}}),cancelEvent(i)},stickerAct:function(e,i,t,o,r){if(r&&hasClass(e,"secondary"))return!0;var s=(r?hasClass(e,"secondary"):hasClass(e,"_im_sticker_activated"))?1:0,n=cur.tabbedStickersBox;if(n)for(var a in n.tbUpdate)n.tbUpdate.hasOwnProperty(a)&&(n.tbUpdate[a]=1);return ajax.post("/al_im.php",{act:"a_stickers_switch",pack_id:i,hash:t,state:s,from_btn:r?1:0},{onDone:function(t,o,n,a){r||(e.innerHTML=t,e.onmouseover="",setStyle(e,{width:"auto"}),toggleClass(e,"_im_sticker_activated",!s)),each(geByClass("_sticker_btn_"+i),function(){this.innerHTML=a,this.onmouseover="",toggleClass(this,"secondary",!s)}),Emoji.updateTabs(o,n,!0);var c=e.parentNode.parentNode;if(!r){if(cur.stickersSorter.destroy(),s){show("im_stickers_deact");var u=ge("im_stickers_deact_wrap");u.firstChild?u.insertBefore(c,u.firstChild):u.appendChild(c),setStyle(c,{cursor:"default"})}else{geByTag1("div","im_stickers_my_wrap").appendChild(c),ge("im_stickers_deact_wrap").childNodes.length||hide("im_stickers_deact")}cur.stickersSorterInit()}},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)}),cancelEvent(o)},getTabsCode:function(e,i){var t=[];e&&t.push.apply(t,e),t.length>1&&(Emoji.hasNewStickers=!1);var o=Emoji.opts[i].forceStickerPack,r="",s="";for(var n in t)if(t.hasOwnProperty(n)){var a=t[n][0],c=t[n][1],u=t[n][3],l=t[n][4]&&a==o,m=t[n][5];if(!c&&!u&&!l)continue;var d=void 0;if(c||l?(a>0&&-1===Emoji.stickerPacksToLoad.indexOf(a)&&Emoji.stickerPacksToLoad.push(a),d="return Emoji.tabSwitch(this, "+a+", "+i+");"):d="return Emoji.previewSticker("+a+", false, {sticker_referrer: 'keyboard'});",t[n][2]&&(Emoji.hasNewStickers=t[n][2]),a===Emoji.TAB_RECENT_STICKERS){var D="emoji_tab emoji_tab_img_cont emoji_tab_recent emoji_tab_"+a;cur.stickersTab==a&&(D+=" emoji_tab_sel"),r+='<a class="'+D+'" onclick="'+d+'"><span class="emoji_tab_icon emoji_sprite emoji_tab_icon_recent"></span></a>'}else if(a===Emoji.TAB_FAVORITE_STICKERS)r+=Emoji.tabs.favoriteTabContent(d,t[n][6]);else if(a){var E="emoji_tab emoji_tab_img_cont emoji_tab_"+a;cur.stickersTab==a&&(E+=" emoji_tab_sel"),c||l||(E+=" emoji_tab_promo");var j='<a class="'+E+'" onclick="'+d+'"><img width="22" height="22" src="'+m+'" class="emoji_tab_img" /></a>';l?s=j+s:s+=j}else{var f="emoji_tab emoji_tab_"+a;cur.stickersTab==a&&(f+=" emoji_tab_sel"),c||(f+=" emoji_tab_promo"),r+='<a class="'+f+'" onclick="'+d+'"><div class="emoji_tab_icon emoji_sprite emoji_tab_icon_'+a+'"></div></a>'}}return r+s},updateTabsOpt:function(e,i){var t=Emoji.opts[e];if(!t.noStickers){var o=ge("emoji_tabs_cont_"+e);o&&(o.innerHTML=Emoji.getTabsCode(window.emojiStickers,e)),Emoji.checkEmojiSlider(t),Emoji.checkNewStickers(t),void 0!==(void 0===i?"undefined":m(i))&&(t.stickersInited=!!i)}},updateTabs:function(e,i,t){e&&t&&window.Notifier&&Notifier.lcSend("emoji",{act:"updateTabs",newStickers:e,keywords:i});var o=0;for(var r in void 0===i?(Emoji.initStickersKeywords(),window.stickersKeywordsData||(o=1)):(window.stickersKeywordsData=i,Emoji.setStickersKeywords(window.stickersKeywordsData,t)),void 0===e?window.emojiStickers&&window.stickersKeywordsData||ajax.post("al_im.php",{act:"a_stickers_list",need_keywords:o,cache_time:Emoji.cachedStickersKeywordsTime()},{onDone:Emoji.updateTabs}):window.emojiStickers=e,Emoji.opts)Emoji.opts.hasOwnProperty(r)&&Emoji.updateTabsOpt(r,!1);var s=Emoji.stickers&&clone(Emoji.stickers);s&&delete s[Emoji.TAB_RECENT_STICKERS],Emoji.onStickersLoad&&window.emojiStickers&&!isEmpty(s)&&(Emoji.onStickersLoad(),Emoji.onStickersLoad=!1)},checkNewStickers:function(e){var i=e.txt;if(!e.noStickers&&!e.noStickersStore&&window.emojiStickers&&i&&i.getAttribute("contenteditable")){for(var t in window.emojiStickers)if(window.emojiStickers.hasOwnProperty(t)&&window.emojiStickers[t][2]){Emoji.hasNewStickers=window.emojiStickers[t][2];break}Emoji.hasNewStickers<0&&!Emoji.noNewStickers&&setTimeout(function(){each(geByClass("emoji_smile_icon"),function(e,i){var t=i.parentNode;geByClass1("emoji_smile_icon_promo",t)||(t.appendChild(ce("div",{className:"emoji_smile_icon_promo"})),addEvent(i,"mouseover",function(){showTooltip(this,{text:getLang("global_store_stickers_new_available"),shift:[7,1,4],showdt:0,black:1})}))})},hasClass(i,"fc_editable")?200:0)}},checkEmojiSlider:function(e){var i=geByClass1("emoji_tabs_wrap",e.tt),t=!1;if(i){if(i.firstChild.clientWidth&&i.firstChild.clientWidth>i.clientWidth+i.scrollLeft)t=!0;else{var o=i.firstChild.childNodes;o.length>6&&(e.scrollLeft||0)<34*(o.length-6)-16&&(t=!0)}var r=vk.rtl?"l":"r";t?(e.sliderShown=!0,Emoji.scrollToggleArrow(!0,r,e,!0)):e.sliderShown&&(e.sliderShown=!1,Emoji.scrollToggleArrow(!1,r,e,!0))}},giftSticker:function(e,i,t,o){var r={act:"stickers_gift_box",pack_id:e,peers:i,ref:(o=o||{}).ref};return o.from&&(r.from=o.from),r.sticker_referrer=o.sticker_referrer||"store",boxLayerWrap.scrollTop=0,showBox("/al_im.php",r,{stat:["wide_dd.js","wide_dd.css","notifier.css","notifier.js"],dark:1}),cancelEvent(t)},showStickerTT:function(e){var i=e.getAttribute("data-title");i&&showTooltip(e,{text:i,slide:15,shift:[74-getSize(e)[0]/2,120,5],className:"sticker_hint_tt",hasover:1})},scrollToStickerPack:function(e,i,t){var o=Emoji.opts[e],r=ge("emoji_tab_cont_"+i+"_"+e),s=r&&i!=Emoji.tabDefaultId?r.offsetTop+getSize(r)[1]:0;o.scrollAnimation=1,o.emojiScroll.scrollTop(s,t?0:200,function(){o.scrollAnimation=0}),Emoji.scrollToTab(i,e)},toggleStickers:function(e,i){var t=Emoji.opts[e];t&&t.tt?(t.noStickers=i,toggleClass(t.tt,"emoji_no_tabs",i),t.curTab&&Emoji.tabSwitch(0,0,e)):t&&(t.hideStickersInitial=i)},getSizeCached:function(e){return(e=ge(e))?(void 0!==e[Emoji.CACHED_WIDTH_PROP]&&void 0!==e[Emoji.CACHED_HEIGHT_PROP]||(e[Emoji.CACHED_WIDTH_PROP]=e.offsetWidth,e[Emoji.CACHED_HEIGHT_PROP]=e.offsetHeight),[e[Emoji.CACHED_WIDTH_PROP],e[Emoji.CACHED_HEIGHT_PROP]]):[0,0]},clearSizeCached:function(e){(e=ge(e))&&(e[Emoji.CACHED_WIDTH_PROP]=void 0,e[Emoji.CACHED_HEIGHT_PROP]=void 0)},getStickerReferrer:function(e){return e===Emoji.TAB_RECENT_STICKERS?Emoji.STICKER_REFERRERS.RECENT:e===Emoji.TAB_FAVORITE_STICKERS?Emoji.STICKER_REFERRERS.FAVORITE:Emoji.STICKER_REFERRERS.KEYBOARD},render:{sticker:function(e,i,t){var o=Emoji.render.stickerRs(e,i,t);return se(o)},stickerRs:function(e,i,t){var o={optId:e,selId:i,stickerId:t[0],size:t[1]?t[1]:256,stickerSize:Emoji.stickerSize,stickerUrl:t[2],fav:t[4]||"",favHash:t[5]||"",referrer:Emoji.getStickerReferrer(i),favClass:t[4]?"faved":""},r="";if(browser.msie&&!browser.msie_edge||!t[3])r=Emoji.stickerItem();else{r=Emoji.stickerItemAnimation();var s=rand(1,1e5);o.animationUrl=t[3],o.uniqId=s}return rs(r,o)},stickerHintRs:function(e,i,t){var o=i,r="";r=i<0?window.promotedStickerUrls&&window.promotedStickerUrls[-o]:t?t[2]:"";var s=t?t[3]:"",n={optId:e,selId:0,stickerId:o,stickerUrl:r,class:o<0?"promo":"",onclick:"Emoji.stickerHintClick("+e+", "+o+", '"+r+"', this)",stickerSize:Emoji.stickerSize},a="";return(!browser.msie||browser.msie_edge)&&s&&r?(a=Emoji.hintsStickerItemAnimation(),n.animationUrl=s,n.class+=" sticker_animation"):r&&(a=Emoji.hintsStickerItem()),rs(a,n)},stickerContent:function(e,i,t){var o=attr(i,"data-animation-path"),r=attr(i,"data-src"),s="/images/blank.gif";t||(s=r);var n=attr(i,"data-sticker-id"),a=attr(i,"data-fav-hash"),c=attr(i,"data-fav"),u="";o?u='<div data-uniq-id="'+attr(i,"data-uniq-id")+'" onmouseenter="StickersAnimation.loadAndPlaySticker(this);" class="sticker_animation" data-sticker-id="'+n+'" data-animation-path="'+o+'"><img class="sticker_img emoji_sticker_image" src="'+s+'" data-src="'+r+'"/></div>':u='<img class="emoji_sticker_image" src="'+s+'" data-src="'+r+'"/>';if(Emoji.favoriteAvailable){var l="";1==c&&(l=" on"),u=u+'<span role="link" onmouseover="Emoji.favorite.reminder(this)" class="emoji_sticker_item_fav'+l+'" data-sticker-id="'+n+'" data-hash="'+a+'" onclick="Stickers.toggleFavorite(this, event, '+e+')"></span>'}return val(i,u),r}},__eof:1});try{stManager.done(jsc("web/emoji.js"))}catch(e){}}});