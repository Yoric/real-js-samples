!function(e){function t(t){for(var i,r,a=t[0],c=t[1],l=t[2],d=0,p=[];d<a.length;d++)r=a[d],s[r]&&p.push(s[r][0]),s[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,a=1;a<n.length;a++){var c=n[a];0!==s[c]&&(i=!1)}i&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var i={},s={4:0},o=[];function r(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=i,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var a=window.swcJsonp=window.swcJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;o.push([371,0]),n()}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(42),s=window;t.swcWindow=s,s.swc=s.swc||s.SkypeWebControl||{},s.swc.shared=s.swc.shared||{},s.swc.scriptLoader=s.swc.scriptLoader||i.ScriptLoader,s.SKYPE=s.SKYPE||{},s.SkypeWebControl=s.swc,s.swc.vendors=s.swc.vendors||{};var o=s.swc;t.swc=o,t.SKYPE=s.SKYPE||{}},,function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),o=n(50),r=n(22),a=function(){function e(){}return Object.defineProperty(e,"ECS",{get:function(){return i({},{frameless:""},s.swc.EcsConfig)},set:function(e){s.swc.EcsConfig=e},enumerable:!0,configurable:!0}),e.getPlatformId=function(){return o.PlatformUtils.getPlatformId()},e.getPlatformName=function(){return o.PlatformUtils.getPlatformName()},e.getClientVersion=function(){if(e.CLIENT_VERSION!==e.DEFAULT_CLIENT_VERSION)return e.CLIENT_VERSION;for(var t=e.ECS.version.split("."),n=t.length,i=0;i<4-n;i++)t.splice(t.length-1,0,"0");return e.CLIENT_VERSION=e.getPlatformId()+"/"+t.join("."),e.CLIENT_VERSION},e.getVersion=function(){if(e.VERSION!==e.DEFAULT_VERSION)return e.VERSION;for(var t=e.ECS.version.split("."),n=t.length,i=0;i<4-n;i++)t.splice(t.length-1,0,"0");return e.VERSION=t.join("."),e.VERSION},e.getChatClientInfo=function(){if(this.CHAT_CLIENT_INFO)return this.CHAT_CLIENT_INFO;var t=s.swc.EcsHeaderConfig&&s.swc.EcsHeaderConfig.CountryCode?s.swc.EcsHeaderConfig.CountryCode:"NR";return this.CHAT_CLIENT_INFO="os=Windows; osVer=10; proc=Win32; lcid=en-us; deviceType=1; country="+t+"; clientName=swc; clientVer="+e.getUiVersion(),this.CHAT_CLIENT_INFO},e.getUiVersion=function(){return this.UI_VERSION?this.UI_VERSION:(this.UI_VERSION=e.getClientVersion()+"//swc",this.UI_VERSION)},e.getClientInfo=function(){if(this.SYSTEM_INFO)return this.SYSTEM_INFO;var t=r.UNKNOWN_VERSION;try{t=window.navigator.platform}catch(e){}return this.SYSTEM_INFO=e.getUiVersion()+"os="+r.default.getOsName()+"; osVer="+r.default.getOsVersion()+"; proc="+t+"; deviceType="+r.default.getDeviceType()+"; browser="+r.default.getBrowserName()+"; browserVer="+r.default.getBrowserVersion(),this.SYSTEM_INFO},e.APPNAME="SWC",e.LOCALE="en-us",e.PES_LOCALE="en",e.ORIGIN="SkypeLWC",e.ORIGIN_CALLING="SkypeCalling",e.MSG_MAX_LENGTH=2e3,e.PLATFORM_ID=912,e.BUTTON_MARKER_CLASS=".skype-button",e.CHAT_MARKER_CLASS=".skype-chat",e.RECENTS_MARKER_CLASS=".skype-recents",e.CHAT_FRAME_MARKER_CLASS=".lwc-chat-frame",e.CALL_FRAME_MARKER_CLASS=".swc-call-frame",e.LOGIN_CLIENT_ID="919866",e.LOGIN_PAGE_URL="https://login.skype.com/login",e.LOGIN_THEME="skype-white",e.LOGOUT_PAGE_URL="https://login.skype.com/logout",e.LOGIN_POPUP_URL="https://demoplayground.skype.com/joinlwc?t=",e.LOGIN_POPUP_FEATURES="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no",e.LOGOUT_POPUP_FEATURES="width=1, height=1, menubar=no, status=no, titlebar=no, toolbar=no",e.TEAMS_URL="https://api.teams.skype.com/",e.TEAMS_AUTH_URL="https://authsvc.teams.microsoft.com/v1.0",e.TEAMS_PROFILE_URL="https://teams.microsoft.com/",e.TEAMS_MIDDLE_TIER_URL="https://teams.microsoft.com/api/mt/amer",e.TEAMS_CSA_URL="https://chatsvcagg.teams.microsoft.com",e.SHAREPOINT_URL="https://microsoft-my.sharepoint.com/",e.AMS_HOST_URL="https://api.asm.skype.com/v1/",e.APS_HOST_URL="https://api.aps.skype.com/v1/",e.CDN_SERVICE_HOST="secure.skypeassets.com",e.OA_URL="https://pro.skype.com/v1/onboarding",e.OA_URL_INT="https://havana-latest.skype.com/v1/onboarding",e.URLP_SERVICE_URL="https://urlp.asm.skype.com",e.ECS_GRAPH_URL="https://skypegraph.skype.com/",e.MS_GRAPH_URL="https://graph.microsoft.com/v1.0/me/",e.MS_APP_CLIENT_ID="b8d5facb-2aee-4653-98cb-4acc8f0d0e97",e.MS_APP_REDIRECT_URL_DEMO="https://latest-swc.cdn.skype.com/demo/connect.html",e.MS_APP_REDIRECT_URL_OUTLOOK="https://latest-swc.cdn.skype.com/demo/msauth.html",e.MS_AUTHORIZE_URL="https://login.microsoftonline.com/common/oauth2/v2.0/authorize",e.ECS_GRAPH_ETAG=null,e.ECS_GRAPH_SERVICE_SETTINGS=null,e.INVITE_HOST_URL_INT="https://latest-join.skype.com/api/v1/",e.INVITE_HOST_URL="https://join.skype.com/api/v1/",e.CHAT_CLIENT_INFO="",e.CHAT_GUEST_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_HOST_URL="https://client-s.gateway.messenger.live.com/v1/",e.CHAT_JOIN_URL="https://latest-join.skype.com/api/v2/conversation",e.SKYPE_CALLER_ID="lwc",e.CONTACTS_HOST_URL="https://edge.skype.com/pcs-df/contacts/v2/",e.CONTACTS_SCD_HOST_URL="https://scd.skype.com/contacts/v3/",e.AGENTS_HOST_URL="https://join.skype.com/",e.AVATAR_SERVICE_URL="https://avatar.skype.com/v1/",e.STRATUS_DOMAIN_HOST_URL="https://profile.skype.com/profile/v1/",e.WX_HOST_URL="https://wx.skype.com/api/v1/scom/",e.USER_OPTIONS_SERVICE={OLD:"https://options.skype.com/",PROD:"https://edge.skype.com/",INT:"https://optionsservice-test-northeurope.cloudapp.net:443/"},e.ECS_CLIENT_NAME="skype",e.ECS_TEAM_NAME="lwc",e.ECS_CLIENT_VERSION="1.00",e.GET_HELP_URL="https://support.skype.com/en/faq/FA34704/what-is-skype-web-control",e.THIRD_PARTY_NOTICES_PATH="/third-party_attributions.html",e.PRIVACY_AND_COOKIES_URL="https://go.microsoft.com/fwlink/?LinkId=521839",e.TERMS_OF_USE_URL="https://go.microsoft.com/fwlink/?LinkID=246338",e.CONCIERGE_BOT_MRI="28:concierge",e.CONCIERGE_BOT_DF_MRI="28:concierge_df",e.BRB_BOT_MRI="28:a62068e3-63e9-4ffc-89a6-14d841e224d2",e.BRB_BOT_MRI_TEAMS="28:5932bde2-77dd-4eb7-a704-d1da88e37485",e.BRB_START_MESSAGE="Sending feedback details...",e.NEW_CHAT_COMPOSER_ID="newChatComposerId",e.DEFAULT_VERSION="0.0.0.0",e.DEFAULT_CLIENT_VERSION=e.getPlatformId()+"/"+e.DEFAULT_VERSION,e.CLIENT_VERSION=e.DEFAULT_CLIENT_VERSION,e.VERSION=e.DEFAULT_VERSION,e.DEFAULT_AVATAR_URI="https://swc.cdn.skype.com/assets/img/defaultAvatar.png",e.MSG_DELETED_CLASSIC_SKYPE="Edited previous message: ",e.UI_VERSION="",e.SYSTEM_INFO="",e.MESSAGE_PROPERTIES={GLOBAL:{ACTIVITY_DATA:"activityData",PINNED:"pinned",PROTOTYPE_SKYPEX:"prototype_skypex"},PER_USER:{EMOTIONS:"emotions",POLL:"poll",TRANSLATIONS:"translations",ACTIVITY_DATA:"activityData",SMS_REPORT:"smsdeliveryreports"}},e.CHAT_SERVICE_COMMANDS={SET_MESSAGE_PROPERTY:"setMessageProperty",REMOVE_MESSAGE_PROPERTY:"removeMessageProperty",REMOVE_ALL_MESSAGES:"removeAllMessage",SET_IS_FAVORITE:"setIsFavorite",SMS_PRICE:"getSmsPrice"},e}();t.Configuration=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.compatEvent="compatEvent",e.CreateControl="createControl",e.IncomingCall="incomingCall",e.CallingReady="callingReady",e.RecentsReady="recentsReady",e.InChatCallingReady="inChatCallingReady",e.BotAddedToThread="botAddedToThread",e.RecentDataLoaded="recentDataLoaded",e.StartChat="startChat",e.StartReportProblemChat="startReportProblemChat",e.StartCall="startCall",e.AcceptCall="acceptCall",e.RejectCall="rejectCall",e.UpdateCallingScreen="updateCallingScreen",e.ForceExpandChat="forceExpandChat",e.ToggleExpressionPicker="toggleExpressionPicker",e.HideExpressionPicker="hideExpressionPicker",e.PesConfigInitialized="pesConfigInitialized",e.Ready="ready",e.ChatOpen="chat-open",e.Click="click",e.Fullscreenchange="fullscreenchange",e.UpdateUnreadMessageCounter="updateUnreadMessageCounter",e.InappActivityStarted="inappActivityStarted",e.ClientOpened="clientOpened",e.ClientFocused="clientFocused",e.ChatServiceUnavailable="chatServiceUnavailable",e.RemoveAllMessagesFromUi="removeAllMessagesFromUi",e.RequestEditingMessage="requestEditingMessage",e.OnVisibilityChange="onVisibilityChange",e.OnMessageSent="onMessageSent",e.OnMessageReceived="onMessageReceived",e.onFocused="onFocused",e.OnConversationReady="onConversationReady",e.onControlShow="onControlShow",e.onControlHide="onControlHide",e.onControlClose="onControlClose",e.OnCallStart="onCallStart",e.OnCallConnect="onCallConnect",e.OnCallEnd="onCallEnd",e.CallingLayoutChanged="callingLayoutChanged",e.CallStatusChanged="callStatusChanged",e.DevicesPermissions="devicesPermissions",e.DominantSpeakerChanged="dominantSpeakerChanged",e.EndpointRegistered="endpointRegistered",e.RecentConversationsFetched="recentConversationsFetched",e.UnreadConversationsUpdate="unreadConversationsUpdate",e.UnsupportedFileSelected="unsupportedFileSelected",e.ReceivedNotification="receivedNotification",e.HideNotification="hideNotification",e.OpenRecentList="openRecentList",e.recentsShown="recentsShown",e.recentsHidden="recentsHidden",e.RecentItemSelected="onRecentItemSelected",e.recentsUIReady="recentsUIReady",e.recentItemsLoaded="recentItemsLoaded",e.onMessageExpand="onMessageExpand",e.onMessageCollapse="onMessageCollapse",e.OnConversationDelete="onConversationDelete",e.scrollToBottom="scrollToBottom",e.hideBubbleWindow="hideBubbleWindow",e.openChatLocal="openChatLocal",e.errorCode="errorCode",e.contactAdded="contactAdded",e.notificationSettingsChange="notificationSettingsChange",e.invoke={sendMessageToBotResponse:"invoke:sendMessageToBot:response",sendMessageToBot:"invoke:sendMessageToBot",signOut:"invoke:signOut",startCall:"invoke:startCall",stopCall:"invoke:stopCall",setAad:"invoke:setAad",getTokenExpirationTime:"invoke:getTokenExpirationTime",registerMask:"registerMask",unregisterMask:"unregisterMask"},e.cmd={reg:"cmd:register",unreg:"cmd:unregister",exec:"cmd:execute"},e.threadNotificationsProxy={reg:"proxy:threadNotifications:register",unreg:"proxy:threadNotifications:unregister",notify:"proxy:threadNotifications:notify"},e.messagingProxy={disconnect:"proxy:messaging:disconnect",disconnected:"proxy:messaging:disconnected"},e.recentsProxy={options:{request:"proxy:recents:options:request",resolve:"proxy:recents:options:resolve"}},e.conversationProxy={regIsTyping:"proxy:conversation:regIsTyping",resIsTyping:"proxy:conversation:resIsTyping",disableInput:"proxy:conversation:disableInput",expand:"proxy:conversation:expand",connected:"proxy:conversation:connected",focusInput:"proxy:conversation:focusInput",openFilePicker:"proxy:conversation:filepicker",setInputPlaceholder:"proxy:conversation:placeholder",setMessageProperties:"proxy:conversation:setMessageProperties",setInputText:"proxy:conversation:inputtext",toggleEmoticonPicker:"proxy:conversation:emoticonpicker",showConfirmationDialog:"proxy:conversation:showConfirmationDialog",resShowConfirmationDialog:"proxy:conversation:resShowConfirmationDialog",regMessageReceived:"proxy:conversation:regMessageReceived",messageReceived:"proxy:conversation:messageReceived",regUnreadCount:"proxy:conversation:regUnreadCount",unreadCount:"proxy:conversation:unreadCount",setActionBar:"proxy:conversation:setActionBar",resActionBar:"proxy:conversation:resActionBar",regDownload:"proxy:conversation:regDownload",resDownload:"proxy:conversation:resDownload",regAvatar:"proxy:conversation:regAvatar",resAvatar:"proxy:conversation:resAvatar",regTitle:"proxy:conversation:regTitle",resTitle:"proxy:conversation:resTitle",regPresenceStatus:"proxy:conversation:regPresenceStatus",resPresenceStatus:"proxy:conversation:resPresenceStatus",regCollapse:"proxy:conversation:regCollapse",resCollapse:"proxy:conversation:resCollapse",regClose:"proxy:conversation:regClose",resClose:"proxy:conversation:resClose"},e.applicationProxy={setLanguage:"proxy:application:setLanguage"},e.presenceProxy={setStatus:"proxy:presence:setStatus",setStatusResponse:"proxy:presence:setStatus:response",getStatus:"proxy:presence:getStatus",getStatusResponse:"proxy:presence:getStatus:response",getUserStatus:"proxy:presence:getUserStatus",getUserStatusResponse:"proxy:presence:getUserStatus:response",announceUserStatus:"proxy:presence:announceUserStatus",subscribeToUserStatus:"proxy:presence:subscribeToUserStatus",unsubscribeFromUserStatus:"proxy:presence:unsubscribeFromUserStatus",getStatusList:"proxy:presence:getStatusList",getStatusListResponse:"proxy:presence:getStatusList:response"},e.notificationsSettingsProxy={setOption:"proxy:settings:notification:setOption",setOptionResponse:"proxy:settings:notification:setOption:response",readOption:"proxy:settings:notification:readOption",readOptionResponse:"proxy:settings:notification:readOption:response"},e.proxy={resolve:"proxy:resolve",request:"proxy:request"},e.bridge={theme:{request:"bridge:request:theme",return:"bridge:request:return"}},e}();t.ApiEvents=i;var s=function(){function e(){}return e.SELECTED_PARTICIPANTS_CHANGE="selectedParticipants:change",e}();t.ParticipantEvents=s;var o=function(){function e(){}return e.SCROLL_RECOUNT="scroll:recount",e}();t.ScrollEvents=o;var r=function(){function e(){}return e.ITEM_SEND_REQUEST="pes:picker:sendRequest",e.ITEM_CANCEL_REQUEST="pes:picker:cancelRequest",e.OPEN_PICKER="pes:picker:open",e}();t.ExpressionPickerEvents=r;var a=function(){function e(){}return e.SEARCH_START="search:start",e.UPDATE_SEARCH_RESULTS="update:searchResults",e.TOGGLE_RESULTS_COMPONENT="search:toggleResultsComponent",e.SEARCH_CREATE_CONTACTLIST="create:contactlist",e.EMPTY_SEARCH_INPUT="search:emptyInput",e.FOCUS_SEARCH_INPUT="search:FocusInput",e.RESET_PARTICIPANTS_SEARCH_RESULT="search:resetParticipantsResult",e}();t.SearchEvents=a;var c=function(){function e(){}return e.SHOW="campaign:show",e.DISMISS="campaign:dismiss",e}();t.CampaignEvents=c,function(e){e.Ready="services:ready",e.Loaded="services:loaded",e.Init="services:init"}(t.ServicesEvents||(t.ServicesEvents={})),function(e){e.Ready="messaging:ready"}(t.MessagingEvents||(t.MessagingEvents={})),function(e){e.Add="viewport:add",e.Ready="viewport:ready",e.Remove="viewport:remove",e.Update="viewport:update"}(t.ViewportEvents||(t.ViewportEvents={}))},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(10),a=n(11),c=n(0),l=n(28),u=function(e){function t(){var t=e.call(this)||this;return t.sessionId="",t.backend=a.MessagingBackend.UNDETERMINED,t.style="",t.translatorEnabled=!1,t.frameless=!1,t.callingReady=!1,t.standaloneCalling=!1,t.largeEmoticonClass=!1,t.isParallelView=!1,t.parentProtocol="n/a",t.bridge(),t}return s(t,e),Object.defineProperty(t,"get",{get:function(){return c.swc.shared.app||(c.swc.shared.app=new t),c.swc.shared.app},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLocale",{get:function(){return l.LocaleInfo.instance.getLocale()},enumerable:!0,configurable:!0}),t.prototype.copy=function(e){e&&Object.getOwnPropertyNames(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);i&&i.writable&&(t[n]=i.value||t[n])})},t.prototype.isTeams=function(){return this.backend===a.MessagingBackend.TEAMS},Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme},set:function(e){e!==this._theme&&(this._theme=e,this.publish("theme",e))},enumerable:!0,configurable:!0}),t.prototype.bridge=function(){var e=this;c.swc.Eventing.registerEvent(o.ApiEvents.bridge.theme.return,function(t){return e.theme=t}),c.swc.Eventing.triggerEvent(o.ApiEvents.bridge.theme.request)},t}(r.default);t.default=u},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getComposedBlockClassName=function(){var e=this.blockClassName;return this.props.className&&(e+=" "+this.props.className),e},t}(n(3).Component);t.SwcBaseComponent=o},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(35)),i(n(51)),i(n(52)),i(n(53)),i(n(54)),i(n(55))},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),c=n(6);!function(e){e.Small="swcIcon_size_small",e.Medium="swcIcon_size_medium",e.Large="swcIcon_size_large"}(t.SwcIconSize||(t.SwcIconSize={})),function(e){e.SVG="swcIcon_svg",e.CallEnd="swcIcon_callEnd",e.CallRecordDot="swcIcon_callRecordDot",e.CallRecordStroke="swcIcon_callRecordStroke",e.CallStart="swcIcon_callStart",e.Cancel="swcIcon_cancel",e.ChevronDown="swcIcon_chevronDown",e.Clippy="swcIcon_clippy",e.Contact="swcIcon_contact",e.ContactGroupPair="swcIcon_contactGroupPair",e.Contract="swcIcon_contract",e.EmoticonStroke="swcIcon_emoticonStroke",e.Error="swcIcon_error",e.Expand="swcIcon_expand",e.Favourite="swcIcon_favourite",e.File="swcIcon_file",e.IconSkypeForBusiness="swcIcon_iconSkypeForBusiness",e.Landline="swcIcon_landline",e.Left="swcIcon_left",e.LogoMicrosoft="swcIcon_logoMicrosoft",e.Message="swcIcon_message",e.Microphone="swcIcon_microphone",e.MicrophoneOff="swcIcon_microphoneOff",e.More="swcIcon_more",e.MsExcel="swcIcon_msExcel",e.MsOneNote="swcIcon_msOneNote",e.MsPowerPoint="swcIcon_msPowerPoint",e.MsVisio="swcIcon_msVisio",e.MsWord="swcIcon_msWord",e.NotificationOff="swcIcon_notificationOff",e.Ok="swcIcon_ok",e.Picture="swcIcon_picture",e.Pdf="swcIcon_pdf",e.Plus="swcIcon_plus",e.PresenceOnline="swcIcon_presenceOnline",e.PresenceAway="swcIcon_presenceAway",e.PresenceDnd="swcIcon_presenceDnd",e.PresenceBlocked="swcIcon_presenceBlocked",e.RadiobuttonUnselected="swcIcon_radiobuttonUnselected",e.Search="swcIcon_search",e.Send="swcIcon_send",e.Settings="swcIcon_settings",e.Skype="swcIcon_skype",e.StarFilled="swcIcon_starFilled",e.Video="swcIcon_video",e.VideoOff="swcIcon_videoOff"}(r=t.SwcIconType||(t.SwcIconType={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcIcon",t}return s(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),this.props.type&&(t+=" "+this.props.type),t},t.prototype.render=function(){var e=this.props.type===r.SVG?{dangerouslySetInnerHTML:{__html:this.props.content}}:{};return a.createElement("span",o({"aria-hidden":"true",className:this.getComposedBlockClassName()},e))},t}(c.SwcBaseComponent);t.SwcIcon=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=function(){function e(){}return e.throwError=function(e,t,n,s){var o=new Error(function(){if(!n||0===Object.getOwnPropertyNames(n).length)return e+(t?": "+t:"");if("string"==typeof n)return n;var i="";return Object.getOwnPropertyNames(n).forEach(function(e){i+=e+": "+n[e]+";"}),i}());i.swc.Eventing.triggerEvent("errorCode",e);try{i.swc.Telemetry.sendEvent.runtimeError(e,o.message,e+(t?": "+t:""),o.stack,s)}catch(e){}},e.throwHttpErrorCode=function(e,t){e+=1e3,i.swc.Eventing.triggerEvent("errorCode",e)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var e=this;this.callbacks={},this.subscribe=function(t,n){void 0===e.callbacks[t]&&(e.callbacks[t]=new Array),e.callbacks[t].push(n)},this.unsubscribe=function(t,n){if(void 0!==e.callbacks[t]){var i=e.callbacks[t].indexOf(n);i>-1&&e.callbacks[t].splice(i,1)}},this.publish=function(t,n){void 0!==e.callbacks[t]&&e.callbacks[t].map(function(e){return e}).forEach(function(e){e(n)})}}return e.prototype.dispose=function(){for(var e in this.callbacks)this.callbacks.hasOwnProperty(e)&&(this.callbacks[e]=null);this.callbacks={}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.SKYPE=100]="SKYPE",e[e.TEAMS=300]="TEAMS"}(t.MessagingBackend||(t.MessagingBackend={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMBER_0:48,NUMBER_9:57,NUMPAD_0:96,NUMPAD_9:105,A:65,G:71,H:72,J:74,K:75,L:76,Z:90,F6:117,F10:121}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(2),o=n(11),r=n(32),a=n(67),c=n(44),l={"<":"&lt;",">":"&gt;","&lt;":"<","&gt;":">","&LT;":"<","&GT;":">","&":"&amp;",'"':"&quot;","'":"&apos;","&amp;":"&","&quot;":'"',"&apos;":"'","&#39;":"'","&#96;":"`","&AMP;":"&","&QUOT;":'"',"&APOS;":"'"},u='(?:(?:\\s*title="[^"]+?"\\s*)|(?:\\s*tabindex="-1"\\s*)|(?:\\s*target="_blank"\\s*)){0,3}',d=a.default.multilineRegExp(["(&lt;a ",u,'href="((?:https?://|mailto:)[^"]+?)"',u,"&gt;)","((?:(?!&lt;/a&gt;)[\\s\\S])*)","(&lt;/a&gt;)"],"gi"),p={ALLOWED_TAGS:["span","canvas"],ALLOWED_ATTR:["id","type","data-item-id","class","data-is-animated"]},h={ALLOWED_TAGS:["b","i","s","hr","br","at","ss","h1","h2","h3","h4","h5","h6","span","div","quote","ul","li","ol","em","strong","br","canvas","p","title","description"],ALLOWED_ATTR:["tabindex","title","target","id","type","data-item-id","class","data-is-animated"]},f=function(){function e(){}return Object.defineProperty(e,"anchor",{get:function(){return e._anchor||(e._anchor=document.createElement("a"))},enumerable:!0,configurable:!0}),e.map=function(e){return l[e]},e.modifyLinkAnchorOpening=function(e,t){return e.search(a.default.escapeSpecialChars(t))>-1?e:e.replace(/(<a|&lt;a)/,function(e){return e+" "+t})},e.validateUrl=function(t,n){var i=e.anchor;return i&&e.validateUrlFormat(t)&&e.validateURLProtocol(i,n)},e.validateURLProtocol=function(e,t){return(t||["https:"]).indexOf(e.protocol)>-1&&-1===["javascript:"].indexOf(e.protocol)},e.validateUrlFormat=function(e){return!!e.match(/^(https:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g)},e.escapeBrackets=function(e){return e.replace(/([<>])/gi,this.map)},e.unescapeBrackets=function(e){return e.replace(/(&lt;|&gt;)/gi,this.map)},e.unescape=function(e){return e.replace(/(&lt;|&gt;|&amp;|&quot;|&apos;|&#39;|&#96;)/gi,this.map)},e.validateUnescapedLink=function(e){return this.escapeBrackets(e).replace(d,this.validateAnchor)},e.parseTopic=function(t){return t?(t?e.unescape(t):"").replace(/<[^a\/].*?>(.*?)<\/[^a].*?>/gi,"$1").replace(/(<.*?\.{3,})$/,"").trim():t},e.getMessageSanitizedContent=function(e,t){var n={ALLOWED_TAGS:[],ALLOWED_ATTR:[]};return t&&t.noLinks?n=h:t&&t.noFormatting?n=p:(n={ALLOWED_TAGS:h.ALLOWED_TAGS.concat(["a"]),ALLOWED_ATTR:h.ALLOWED_ATTR.concat(["href"])},i.default.get.backend===o.MessagingBackend.TEAMS&&(n.ALLOWED_TAGS.push("img"),n.ALLOWED_ATTR.push("src","style","alt"))),r.default.dompurify.sanitize(e,n)},e.normalizeUrl=function(t){var n=e.anchor;return n.href=t,e.validateUrl(t)&&n.href},e.validateAnchor=function(t,n,i,s,o){var r=e.unescapeBrackets(n),a=e.unescapeBrackets(o);return 0!==i.indexOf("mailto:")&&(r=e.modifyLinkAnchorOpening(r,'target="_blank"')),r=e.modifyLinkAnchorOpening(r,'tabindex="-1"'),(r=e.modifyLinkAnchorOpening(r,'title="'+i+'"'))+s+a},e.webify=function(e){return e.replace(/(\r?\n)|(&lt;br\s?\/&gt;)/gm,"<br/>")},e.attachActionToLinks=function(e,t,n,i){if(1===e.nodeType&&e.matches(t))for(var s=e.querySelectorAll("a"),o=0;o<s.length;o++){var r=s[o];if(r.href.indexOf(n)>1){var a=c.default.getQueryParameter(r.href,n);a&&(r.setAttribute("data-swc-payload",a),r.addEventListener("click",i))}}},e.getSenderIdFromUrl=function(e){if(!e)return e;var t=e.match(/\/(\d+:[^?\/]*)/);return t&&t[1]?t[1]:(e.match(/(\d+:[^?\/]*)/),e)},e.extractMsgContent=function(e){return 0!==e.indexOf(s.Configuration.MSG_DELETED_CLASSIC_SKYPE)?e:e.slice(s.Configuration.MSG_DELETED_CLASSIC_SKYPE.length,e.length)},e.sanitizeTopic=function(e){return r.default.dompurify.sanitize(e,{ALLOWED_TAGS:h.ALLOWED_TAGS.concat(["img","a"]),ALLOWED_ATTR:h.ALLOWED_ATTR.concat(["src","href"])})},e.getMessagePreviewContent=function(t){return t=e._dropNewLineTag(t),t=e._dropAnchorTag(t),t=e._dropImgTag(t)},e._dropNewLineTag=function(e){return e.replace(/<br\s*\/?>/gm," ")},e._dropAnchorTag=function(e){return e.replace(/<\/*a.*?>/g," ")},e._dropImgTag=function(e){return e.replace(/<img .*?>/g,"")},e}();t.MessageUtils=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(30),s=n(0),o=n(37),r=n(43),a={allowedDomains:["swc.cdn.skype.com","latest-swc.cdn.skype.com"]},c=function(){function e(){}return e.combine=function(e,t){return e.lastIndexOf("/")!==e.length-1&&"/"!==t.substring(0,1)?e+"/"+t:this.getAppPath()+e+t},e.getAbsoluteUrl=function(e,t){var n=this.getCompletePath(e,t),o="css"===t?"css/":"";return e===i.PackageName.SDK_LOADER_CHAT?this.combine(s.swc.EcsConfig.loaderUrl,n):e===i.PackageName.CONNECT?this.combine(s.swc.EcsConfig.loaderUrl,n):this.combine(o,n)},e.getCompletePath=function(e,t){var n="";switch(s.swc.EcsConfig.environment){case"df":case"ppe":case"prod":n=".min"}return""+e+n+"."+t},e.setQueryParameters=function(e,t){return e+"?"+this.buildQueryParameters(t)},e.buildQueryParameters=function(e){var t=[];return Object.keys(e).forEach(function(n){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}),t.join("&")},e.getHost=function(){try{var e=window.location.hostname;return!e&&e.length>0?e:("file:"===window.location.protocol.toLowerCase()&&(e="local"),e)}catch(e){return null}},e.getVendorPath=function(){return e.getCDNPath()+"/vendors"},e.getConnectPagePath=function(){return e.getAppPath()+"connect.html"},e.getAppPath=function(){var t=s.swc.EcsConfig.version||s.swc.SDK.version,n=o.getBranchParentFolder(t);return e.getCDNPath()+"/"+n+"/"+t+"/"},e.getCDNPath=function(){var t=s.swc.EcsConfig.domain;return e.validateUriOrDie(t,a),t},e.validateUriOrDie=function(e,t){if(!r.UrlValidator.instance.validate(e,t))throw new Error("Invalid URI!")},e.appendQueryParam=function(e,t,n){return e+(-1===e.indexOf("?")?"?":"&")+encodeURIComponent(t)+"="+encodeURIComponent(n)},e}();t.UrlHelper=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.guid={generate:function(){var e=new Uint16Array(8);(window.crypto||window.msCrypto).getRandomValues(e);var t=0,n=function(){return(4369|e[t++]).toString(16)};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},isGuid:function(e){return/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/.test(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=function(){function e(e){var t=this;this._isCanceled=!1,this._status=i.Pending,this.cancel=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t._isCanceled||(t._isCanceled=!0,e[0]=e[0]||{},e[0].isCanceled=!0,t._status=i.Rejected,t._reject.apply(t._promise,e))},this._promise=new Promise(function(n,s){t._resolve=n,t._reject=s,e&&(e.then(function(e){t._isCanceled||(t._status=i.Resolved,n(e))},function(e){t._status=i.Rejected,s(e)}),e.catch(function(e){t._status=i.Rejected,t._isCanceled?s({isCanceled:!0}):s(e)}))})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCanceled",{get:function(){return this._isCanceled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._status!==i.Resolved&&(this._status=i.Resolved,this._resolve.apply(this._promise,e))},e.prototype.cancelQuitely=function(){this.status===i.Pending&&(this.promise.then(function(){},function(){}),this.cancel())},e}();t.CancelablePromise=s,function(e){e[e.Pending=0]="Pending",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(i=t.PromiseStatus||(t.PromiseStatus={}))},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(1),a=n(0),c=n(40),l=n(6),u=n(8),d=n(76);!function(e){e.Online="online",e.Busy="busy",e.Away="away"}(o=t.PresenceStatusUI||(t.PresenceStatusUI={})),function(e){e.SuperSmall="swcAvatar_size_superSmall",e.Small="swcAvatar_size_small",e.Medium="swcAvatar_size_medium",e.MediumLarge="swcAvatar_size_mediumLarge",e.Large="swcAvatar_size_large",e.SuperLarge="swcAvatar_size_superLarge"}(t.SwcAvatarSize||(t.SwcAvatarSize={}));var p=/teams.microsoft.com/,h="#ccc",f=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="swcAvatar",n._handleImageError=function(){n.setState({hasImageError:!0})},n.state=t.avatarUrl?{bgColor:"transparent",showBlock:!!t.showBlock,presenceStatus:t.presenceStatus,initials:"",hasImageError:!1}:{initials:t.title?c.getInitials(t.title):"",bgColor:t.title?c.getBackgroundColor(t.title):h,showBlock:!!t.showBlock,presenceStatus:t.presenceStatus,hasImageError:!1},n}return s(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),t},t.prototype.componentDidUpdate=function(e){this.props.title!==e.title&&this.props.title&&this.setState({initials:c.getInitials(this.props.title),bgColor:c.getBackgroundColor(this.props.title)}),this.props.showBlock!==e.showBlock&&this.setState({showBlock:!!this.props.showBlock}),this.props.presenceStatus!==e.presenceStatus&&this.props.presenceStatus&&this.setState({presenceStatus:this.props.presenceStatus})},t.prototype.render=function(){var e=function(e,t){if(e)return u.SwcIconType.PresenceBlocked;switch(t){case o.Away:return u.SwcIconType.PresenceAway;case o.Busy:return u.SwcIconType.PresenceDnd;case o.Online:return u.SwcIconType.PresenceOnline;default:return null}}(this.state.showBlock,this.state.presenceStatus),t=this.props.avatarUrl,n=t&&""!==t&&"avatar NA"!==t;return this.state.hasImageError?r.createElement(g,{initials:this.state.initials,bgColor:this.state.bgColor}):r.createElement("div",{className:this.getComposedBlockClassName(),"aria-label":a.swc.services.i18n.fetch("aria_avatar_label",{title:this.props.title}),"aria-hidden":!1===this.props.accessible?"true":void 0},n?r.createElement(d.SwcImageLoader,{className:"swcAvatar__img",useCredentials:p.test(t),src:t,onError:this._handleImageError,placeholder:r.createElement(g,{initials:this.state.initials,bgColor:this.state.bgColor})}):r.createElement(g,{initials:this.state.initials,bgColor:this.state.bgColor}),!!e&&r.createElement(u.SwcIcon,{className:"swcAvatar__presence",type:e}))},t}(l.SwcBaseComponent);function g(e){var t=e.initials,n=e.bgColor;return r.createElement("div",{className:"swcAvatar__initials swcAvatar_size_medium",style:{"background-color":n}},t)}t.SwcAvatar=f},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(12).default,s={96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};function o(e){return e.which||e.keyCode}function r(e){var t=o(e);return t>=i.NUMPAD_0&&t<=i.NUMPAD_9}t.default={swallow:function(e){e.preventDefault()},getKeyCode:o,getNumpadKey:function(e){return!!r(e)&&s[o(e)]},isActivation:function(e){var t=o(e);return t===i.ENTER||t===i.SPACE},isAlphaNumericKey:function(e){var t=o(e);return t>=i.NUMBER_0&&t<=i.NUMBER_9||t>=i.A&&t<=i.Z},isNumPadKey:r,isDeactivation:function(e){return o(e)===i.ESCAPE}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getWindow=function(){return window},e.getDocument=function(){return window.document},e.getParentWithClass=function(e,t){for(;e&&!this.hasClass(e,t);)e=e.parentNode;return e},e.isInViewport=function(e,t){return t=t||this.getWindow(),e.bottom>0&&e.right>0&&e.top<t.innerHeight&&e.left<t.innerWidth},e.readDataset=function(e,t,n){return e.dataset?e.dataset[t]:e.getAttribute("data-"+n)},e.writeDataset=function(e,t,n,i){e.dataset?e.dataset[t]=i:e.setAttribute("data-"+n,i)},e.hasClass=function(e,t){if(e.classList)return e.classList.contains(t);for(var n=0,i=e.className?e.className.split(" "):[];n<i.length;n++){if(i[n]===t)return!0}return!1},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s,o,r=n(0),a=n(21),c=n(16),l={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"};!function(e){e.Desktop="Desktop",e.Mobile="Mobile",e.Tablet="Tablet"}(i=t.DeviceType||(t.DeviceType={})),function(e){e.MSIE="MSIE",e.CHROME="Chrome",e.FIREFOX="Firefox",e.SAFARI="Safari",e.EDGE="Edge",e.ELECTRON="Electron",e.SKYPE_SHELL="SkypeShell",e.PHANTOMJS="PhantomJS",e.UNKNOWN="Unknown"}(s=t.BrowserVendor||(t.BrowserVendor={})),function(e){e.WINDOWS="Windows",e.MACOSX="Mac OS X",e.WINDOWS_PHONE="Windows Phone",e.WINDOWS_RT="Windows RT",e.IOS="iOS",e.ANDROID="Android",e.LINUX="Linux",e.UNKNOWN="Unknown"}(o=t.OperatingSystem||(t.OperatingSystem={})),t.UNKNOWN_VERSION="U";var u=function(){function e(){}return e.getDeviceType=function(){return window.navigator.userAgent.match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?i.Mobile:window.navigator.userAgent.match(/tablet|ipad/i)?i.Tablet:i.Desktop},e.getUserAgent=function(){return a.default.getWindow().navigator.userAgent},e.userAgentContainsString=function(e){return this.getUserAgent().indexOf(e)>-1},e.isChrome=function(){return this.userAgentContainsString(s.CHROME)&&!this.userAgentContainsString(s.EDGE)},e.isIe=function(){return this.userAgentContainsString("Trident")},e.isEdge=function(){return this.userAgentContainsString(s.EDGE)},e.isOpera=function(){return this.userAgentContainsString("OPR/")},e.testSupporedList=function(t){if(!t)return!1;t.constructor!==Array&&"string"==typeof t&&(t=[t]);for(var n=e.getBrowserName().toLocaleLowerCase(),i=0;i<t.length;i++)if(t[i].toLowerCase().indexOf(n)>-1)return!0;return!1},e.getBrowserName=function(){return this.isOpera()?s.UNKNOWN:this.userAgentContainsString(s.PHANTOMJS)?s.PHANTOMJS:this.isEdge()?s.EDGE:this.userAgentContainsString(s.ELECTRON)?s.ELECTRON:this.userAgentContainsString(s.CHROME)?s.CHROME:this.userAgentContainsString(s.FIREFOX)?s.FIREFOX:this.userAgentContainsString(s.SAFARI)?s.SAFARI:this.userAgentContainsString(s.SKYPE_SHELL)?s.SKYPE_SHELL:this.isIe()?s.MSIE:s.UNKNOWN},e.getBrowserVersion=function(){var e,n,i,o,r,a=this;return this.isIe()?(o=a.getUserAgent(),(r=o.match(new RegExp(s.MSIE+" ([\\d,.]+)")))?r[1]:(i=o.match(new RegExp("rv:([\\d,.]+)")))?i[1]:void 0):((e=this.getBrowserName())===s.SAFARI&&(e="Version"),(n=a.getUserAgent().match(new RegExp(e+"/([\\d,.]+)")))?n[1]:t.UNKNOWN_VERSION)},e.getScreenInfo=function(){var e=a.default.getWindow(),t=a.default.getWindow().navigator;return{width:a.default.getWindow().screen&&a.default.getWindow().screen.width||0,height:a.default.getWindow().screen&&a.default.getWindow().screen.height||0,pixelRatio:a.default.getWindow().devicePixelRatio||0,colorDepth:a.default.getWindow().screen&&a.default.getWindow().screen.colorDepth||0,isTouchEnabled:Object.prototype.hasOwnProperty.call(e,"ontouchstart")||t.MaxTouchPoints>0}},e.getOsName=function(){var e=this.getUserAgent();return e.match(/windows\sphone\s\d+\.\d+/i)?o.WINDOWS_PHONE:e.match(/ arm;/i)?o.WINDOWS_RT:e.match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?o.IOS:e.match(/android/i)?o.ANDROID:e.match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?o.LINUX:e.match(/(macintosh|mac os x)/i)?o.MACOSX:e.match(/(windows|win32)/i)?o.WINDOWS:o.UNKNOWN},e.getOsVersion=function(e){var n=this;void 0===e&&(e=!1);var i;return this.getOsName()===o.WINDOWS?function(e){var i=n.getUserAgent().match(new RegExp("Windows NT ([\\d,.]+)"));if(i){if(e)return i[1];if(l[i[1]])return l[i[1]]}return t.UNKNOWN_VERSION}(e):this.getOsName()===o.MACOSX&&(i=n.getUserAgent().match(new RegExp(o.MACOSX+" ([\\d,_,.]+)")))?i[1].replace(/_/g,"."):t.UNKNOWN_VERSION},e.getDeviceId=function(){var e=r.swc.services.localStorage,t=e.getItem("swc-deviceId");return t||(t=c.guid.generate(),e.setItem("swc-deviceId",t)),t},e}();t.default=u},,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SignedOut=0]="SignedOut",e[e.SigningIn=1]="SigningIn",e[e.SignedIn=2]="SignedIn",e[e.SigningOut=3]="SigningOut"}(t.SigninState||(t.SigninState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(18);t.SwcAvatar=i.SwcAvatar,t.SwcAvatarSize=i.SwcAvatarSize;var s=n(77);t.SwcRecentAvatar=s.SwcRecentAvatar;var o=n(33);t.SwcPersonAvatar=o.SwcPersonAvatar;var r=n(78);t.SwcConversationAvatar=r.SwcConversationAvatar},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),s=n(0),o=n(75),r=function(){function e(){this.requests={}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.async=function(e,t,n){var o=this;return this.requests[t]=this.requests[t]||new Promise(function(r,a){var c=n&&setTimeout(a,n),l=function(n){n&&n.refId&&n.refId===t&&(c&&clearTimeout(c),s.swc.Eventing.unregisterEvent(i.ApiEvents.proxy.resolve,l),r(o.create(e,n)))};s.swc.Eventing.registerEvent(i.ApiEvents.proxy.resolve,l)}),s.swc.Eventing.triggerEvent(i.ApiEvents.proxy.request,t),this.requests[t]},e.prototype.create=function(e,t){return new e(t)},e}();t.ProxyFactory=r;var a=function(){return function(e){var t=this;this.data={},this.callCount=0,this.exec=function(e,t){return s.swc.Eventing.triggerEvent(e,t)},this.reg=function(e,t){return s.swc.Eventing.registerEvent(e,t)},this.unreg=function(e,t){return s.swc.Eventing.unregisterEvent(e,t)},this.createCID=function(){return o.hashCode((t.callCount++).toString()+t.refId)},this.refId=e.refId,this.data=e,this.init()}}();t.Proxy=a;var c=function(){function e(){var e=this;this.connections={},this.answer=function(t){var n=e.connections[t];n&&s.swc.Eventing.triggerEvent(i.ApiEvents.proxy.resolve,Object.assign(n,{refId:t}))},s.swc.Eventing.registerEvent(i.ApiEvents.proxy.request,this.answer)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e)},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t,n){this.connections[e]||(this.connections[e]=t||{},n&&n(),this.answer(e))},e.prototype.disconnect=function(e){delete this.connections[e]},e}();t.ProxyConnector=c},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),r=n(0),a=function(e){function t(){return e.call(this)||this}return s(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t)},enumerable:!0,configurable:!0}),t.prototype.getLocale=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=null),t?(this.locale=t,this._locale):e?(this.locale=e,this._locale):this._locale?this._locale:r.swc.SDK&&r.swc.SDK.locale?(this.locale=r.swc.SDK.locale,this._locale):document.documentElement.lang?document.documentElement.lang.toLowerCase():window.navigator.languages&&0!==window.navigator.languages.length?window.navigator.languages[0].toLowerCase():navigator.language.toLowerCase()},Object.defineProperty(t.prototype,"locale",{set:function(e){e&&this._locale!==e.toLowerCase()&&(this._locale=e.toLowerCase(),this.publish("locale",this._locale))},enumerable:!0,configurable:!0}),t}(o.default);t.LocaleInfo=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.UNDETERMINED=10]="UNDETERMINED",e[e.GUEST=100]="GUEST",e[e.SKYPE=200]="SKYPE",e[e.DL_TOKEN=300]="DL_TOKEN",e[e.TEAMS=400]="TEAMS"}(t.IdentityType||(t.IdentityType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.SDK_LOADER_CHAT="sdk-loader",e.SDK_CORE="sdk-core",e.ASSETS="assets-bundle",e.BUILDER="builder-bundle",e.BUILDER_CORE="builder-core",e.CALLING="calling-bundle",e.CALLING_STANDALONE="callingStandalone-bundle",e.SERVICES="services-bundle",e.CHAT_BUNDLE="chat-bundle",e.RECENTS_BUNDLE="recents-bundle",e.UICOMPONENT_BUNDLE="uicomponent-bundle",e.TELEMETRY_BUNDLE="telemetry-bundle",e.CONNECT="connect",e.HOST_CHAT_PAGE="host-chat",e.HOST_BING_PAGE="host-button",e.HOST_BUILDER_PAGE="host-builder",e.STYLE_BUILDER="swc-builder",e.STYLE_SDK="swc-sdk",e.STYLE_CHAT_SKYPE="swc-chat",e.STYLE_RECENTS_SKYPE="swc-recents",e.STYLE_CHAT_BING="swc-bing",e.STYLE_CHAT_THEME_DARK="swc-dark",e.STYLE_CALLING="swc-calling",e}();t.PackageName=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(34),s=n(7),o=n(9),r=function(){function e(){}return e.strip=function(e){var t=e.match(this.idRegExp);return t?t[2]:e},e.detectConversationType=function(e){if(!e)return s.ConversationType.UNDEFINED;if(this.typeMapppings[e])return this.typeMapppings[e];var t,n=e.match(this.idRegExp);if(n&&(t=this.getTypeByPrefix(n[1])),t)return this.typeMapppings[e]=t,t;if(0===e.indexOf("https://join.skype.com/"))return this.typeMapppings[e]=s.ConversationType.JOIN,s.ConversationType.JOIN;if(/^(28:)?[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.test(e))return this.typeMapppings[e]=s.ConversationType.AGENT,s.ConversationType.AGENT;if(/^(19:)?[\S]+[@]([\S].)?[\S]*thread\.skype/i.test(e))return this.typeMapppings[e]=s.ConversationType.GROUP,s.ConversationType.GROUP;return/(?:00|\+)?(^[^a-z][^A-Z])(\d+$)/i.test(e.replace(/\s+|[()\-\+]/gi,""))?(this.typeMapppings[e]=s.ConversationType.PHONE,s.ConversationType.PHONE):(this.typeMapppings[e]=s.ConversationType.PERSON,s.ConversationType.PERSON)},e.getSdkModeFromId=function(e){switch(this.detectConversationType(e)){case s.ConversationType.PERSON:return i.SDKMode.PERSON;case s.ConversationType.AGENT:return i.SDKMode.BOT;case s.ConversationType.JOIN:return i.SDKMode.JOIN_URL;case s.ConversationType.PHONE:return i.SDKMode.PHONE;case s.ConversationType.GROUP:return i.SDKMode.THREAD}return i.SDKMode.UNDEFINED},e.toFullIdentifier=function(e){var t=this.getPrefixForId(e);return 0===e.indexOf(t+":")?e:t?t+":"+e:e},e.addPrefix=function(e,t){return 0===t.indexOf(e+this.SPLITTER)?t:0===t.indexOf(this.SPLITTER)?e+t:e+this.SPLITTER+t},e.getNormalizeId=function(e){return e.match(this.idRegExp)?e.replace(/\d{1,2}:/,""):e},e.isEqual=function(e,t){return this.toFullIdentifier(e).toLowerCase()===this.toFullIdentifier(t).toLowerCase()},e.getPrefixForId=function(e){if(this.hasAlreadyPrefix(e))return"";var t=this.getSdkModeFromId(e);switch(t){case i.SDKMode.PERSON:return"8";case i.SDKMode.BOT:return"28";case i.SDKMode.THREAD:return"19";case i.SDKMode.PHONE:return"4";default:o.default.throwError(10502,"Unable to define conversation prefix",{id:e,sdkMode:t})}return""},e.getTypeByPrefix=function(e){if(!e)return s.ConversationType.UNDEFINED;switch(e.indexOf(":")>-1&&(e=e.replace(":","")),e){case"4":return s.ConversationType.PHONE;case"8":return s.ConversationType.PERSON;case"19":return s.ConversationType.GROUP;case"28":return s.ConversationType.AGENT;default:return s.ConversationType.UNDEFINED}},e.hasAlreadyPrefix=function(e){var t=/^\d+:/.exec(e);return!!t&&!!t[0]},e.SPLITTER=":",e.idRegExp=/(\d{1,2}:)([\S]*)/,e.typeMapppings={},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=function(){function e(){}return Object.defineProperty(e,"dompurify",{get:function(){return i.swcWindow.DOMPurify},enumerable:!0,configurable:!0}),e}();t.default=s},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(45),c=n(6),l=n(18),u=n(49),d=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="",n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n._onBlockedUpdate=function(e){n.setState({showBlock:e})},n._onPresenceUpdate=function(e){var t;switch(e){case a.PresenceStatus.Online:t=l.PresenceStatusUI.Online;break;case a.PresenceStatus.Busy:case a.PresenceStatus.OnThePhone:t=l.PresenceStatusUI.Busy;break;case a.PresenceStatus.Away:case a.PresenceStatus.Idle:case a.PresenceStatus.OutToLunch:case a.PresenceStatus.BeRightBack:t=l.PresenceStatusUI.Away}n.setState({presenceStatus:t})},n.state={title:"",size:t.size,avatarUrl:"",showBlock:!1,presenceStatus:null},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props.person;this._onTopicUpdate(e.displayName||e.id),e.subscribe("displayName",this._onTopicUpdate),this.props.isPstn||(this._onBlockedUpdate(e.isBlocked),e.subscribe("isBlocked",this._onBlockedUpdate),this.props.customAvatar?this._onAvatarUpdate(this.props.customAvatar):(e.avatarData&&this._onAvatarUpdate(e.avatarData),e.subscribe("avatarData",this._onAvatarUpdate)),this.props.showPresence&&(this._onPresenceUpdate(e.presenceStatus),e.subscribe("presenceStatus",this._onPresenceUpdate)))},t.prototype.componentWillReceiveProps=function(e){this.setState({size:e.size})},t.prototype.componentWillUnmount=function(){var e=this.props.person;e.unsubscribe("avatarData",this._onAvatarUpdate),e.unsubscribe("displayName",this._onTopicUpdate),e.unsubscribe("isBlocked",this._onBlockedUpdate),e.unsubscribe("presenceStatus",this._onPresenceUpdate)},t.prototype.render=function(){return this.props.isPstn?r.createElement(u.SwcPstnAvatar,o({className:this.getComposedBlockClassName()},this.state,{accessible:this.props.accessible})):r.createElement(l.SwcAvatar,o({className:this.getComposedBlockClassName()},this.state,{onClick:this.props.onClick,accessible:this.props.accessible}))},t}(c.SwcBaseComponent);t.SwcPersonAvatar=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.PERSON=1]="PERSON",e[e.THREAD=2]="THREAD",e[e.BOT=3]="BOT",e[e.JOIN_URL=4]="JOIN_URL",e[e.PHONE=5]="PHONE"}(t.SDKMode||(t.SDKMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Skype=8]="Skype",e[e.Agent=28]="Agent",e[e.Pstn=4]="Pstn",e[e.MSA=1]="MSA",e[e.Undefined=0]="Undefined"}(t.ContactType||(t.ContactType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.HideChatWindow="bs:hChat",e.OpenChatWindow="bs:oChat",e.ShowChatWindow="bs:sChat",e.CollapseChatWindow="bs:chat:collapse",e.ExpandChatWindow="bs:chat:expand",e.LoadChatData="bs:sChat:run",e.StartActivation="bs:sChat:startActivation",e.StopActivation="bs:sChat:stopActivation",e.UpdateConversation="swc:chat:update",e.MessageSent="lwc:mSent",e.DockIframe="bs:calling:iframe:dock",e.IframeDocked="bs:calling:iframe:docked",e.UndockIframe="bs:calling:iframe:undock",e.IframeUndocked="bs:calling:iframe:undocked",e.IframeDragging="bs:calling:iframe:drag:dragging",e.IframeDragStart="bs:calling:iframe:drag:start",e.IframeDragStop="bs:calling:iframe:drag:stop",e.TriggerAPI="bs:api:trigger",e.OpenRecentsWindow="swc:recents:open"}(t.ActionNames||(t.ActionNames={}))},function(e,t,n){"use strict";function i(e){return!!e&&(0===e.indexOf("fb-")||0===e.indexOf("pr-"))}Object.defineProperty(t,"__esModule",{value:!0}),t.versionRegExp=/\d+.\d+.\d+/,t.getBranchParentFolder=function(e){return i(e)?"fb":"v"},t.isAppVersion=function(e){return!!e&&t.versionRegExp.test(e)},t.isFeatureBranch=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SKYPE_TOKEN_KEY="skype|token",t.SKYPE_REGTOKEN_KEY="skype|registrationtoken",t.SKYPE_ENDPOINT_ID_KEY="skype|epid",t.SKYPE_ENDPOINT_KEY="skype|endpoint",t.SKYPE_HAS_HISTORY_KEY="skype|hasHistory",t.SKYPE_GRAPH_ACCESS_TOKEN_KEY="skype|graphAccessToken",t.SKYPE_ENDPOINT_OWNER_KEY="skype|endpointowner",t.SWC_SFB_DISMISSED_KEY="swc-sfb-dismissed"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="px",s="all 0.5s ease";function o(e,t){var n=e.style;n.top=t.top+i,n.left=t.left+i,n.width=t.width+i,n.height=t.height+i}function r(e){return window.getComputedStyle(e)}t.transport=function(e,t,n,i,r,a){var c=e.getBoundingClientRect(),l=function(e){return t.appendChild(e)};a||l(e),e.style.transition=s,o(e,c),setTimeout(function(){return o(e,n)},0),setTimeout(function(){r(),e.style.transition=null,a&&l(e)},i)},t.setRectStyle=o,t.resetRectStyle=function(e){var t=e.style;t.width=t.height=t.top=t.bottom=t.right=t.left=null},t.isInDom=function(e){if(e)for(;e.parentNode;)if((e=e.parentNode)===document.documentElement)return!0;return!1},t.innerSize=function(e){var t=r(e);return{width:e.offsetWidth-parseInt(t.paddingLeft,10)-parseInt(t.paddingRight,10),height:e.offsetHeight-parseInt(t.paddingTop,10)-parseInt(t.paddingBottom,10)}},t.setStyle=function(e,t){e.setAttribute("style",t)},t.style=r,t.copyStyle=function(e,t,n){for(var i=r(t),s=e.style,o=0,a=n;o<a.length;o++){var c=a[o];s[c]=i[c]}},t.isInIframe=function(){try{return window.self!==window.top}catch(e){return!0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(41),s=n(14),o="returnDefaultImage=false",r="returnDefaultImage=true",a="?returnDefaultImage",c="?auth_key=",l=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"];t.loadAvatarUri=function(e,t,n){e&&(e.indexOf(c)<0&&(e=e.indexOf(a)<0?function(e){var t=e.split("?")[0],n=e.split("?")[1],i=function(e){return e.indexOf("/profile/avatar")>-1||e.indexOf("/public")>-1}(e);return n?(e=t+"?"+n,e+=i?"&"+o:""):e+=i?"?"+o:"",e}(e):e.replace(r,o)),i.default.preloadImage(e,t,n))},t.getBackgroundColor=function(e){for(var t=0,n=(e&&e.length||0)-1;n>=0;n--){var i=e.charCodeAt(n),s=n%8;t^=(i<<s)+(i>>8-s)}return l[t%l.length]},t.getInitials=function(e){var t="",n=(e=function(e){return s.MessageUtils.getMessageSanitizedContent(e).replace(/\s+/gi," ").trim()}(e)).split(" ");return n.length>1?(t+=n[0][0]?n[0][0]:"",t+=n[1][0]?n[1][0]:""):n.length&&(t+=n[0][0]?n[0][0]:"",t+=n[0][1]?n[0][1]:""),t.toUpperCase()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),s=n(0),o={caseFirst:"upper"},r=function(){function e(){}return e.mapSearchProfileInfo=function(e){return e&&e.results?e.results.map(function(e){var t=e.nodeProfileData.skypeId,n={skypeid:-1===t.indexOf("8:")?"8:"+t:t,name:e.nodeProfileData.name,avatar:e.nodeProfileData.avatarUrl,type:i.ContactType.Skype,contactType:e.nodeProfileData.contactType,annotation:e.nodeAnnotation,jobTitle:e.nodeProfileData.jobTitle,department:e.nodeProfileData.department,location:e.nodeProfileData.location};return e.nodeConnectionData&&(n.distance=e.nodeConnectionData.distance,n.mutualFriendCount=e.nodeConnectionData.mutualFriendCount),n}):[]},e.getWrappedIdWithMri=function(e){var t=/^\d+:/.exec(e.id);if(t&&t[0])return e.id;var n=e.isAgent?/^28:/:/^8:/;return(e.isAgent?"28:":"8:")+e.id.replace(n,"")},e.sortByName=function(e,t){var n=e.person.displayName.localeCompare(t.person.displayName,void 0,o);return 0===n?e.person.id.localeCompare(t.person.id):n},e.getSortedByRelevance=function(t){var n=t.filter(function(e){return e.rawPerson.mutualFriendCount}).sort(function(e,t){return t.rawPerson.mutualFriendCount-e.rawPerson.mutualFriendCount}),i=t.filter(function(e){return!e.rawPerson.mutualFriendCount}).sort(e.sortByName);return n.concat(i)},e.preloadImage=function(e,t,n){if(e.indexOf("data:image/jpeg;base64")>-1)t&&"function"==typeof t&&t(e);else{if(-1!==e.indexOf("https://teams.microsoft.com")){var i=s.swc.services.avatarService;if(i.fetchSingleAvatar&&t&&"function"==typeof t)return void i.fetchSingleAvatar(e).then(function(e){t(e)})}var o=new Image,r=encodeURI(decodeURI(e));o.onload=function(){t&&"function"==typeof t&&t(r)},o.onerror=function(e){n&&"function"==typeof n&&n()},o.src=r}},e.replaceAvatarPath=function(e){return e.indexOf("data:image/jpeg;base64")>-1?e:e=(e=e.replace("URL@","")).indexOf("/views/avatar_fullsize")<0?e+"/views/avatar_fullsize":e},e.resolveConversationAvatar=function(t,n){return n?t?e.replaceAvatarPath(n):n:""},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(21),s=n(15),o=function(){function e(){}return e.addScript=function(t,n,o,r){var a=n?s.UrlHelper.getAbsoluteUrl(t,"js"):t;if(-1===e.loaded.indexOf(a)){var c=e.progress;if(c[a])return o&&-1===c[a].success.indexOf(o)&&c[a].success.push(o),void(r&&-1===c[a].failure.indexOf(r)&&c[a].failure.push(r));c[a]={success:[],failure:[]},o&&c[a].success.push(o),r&&c[a].failure.push(r);var l=i.default.getDocument(),u=l.createElement("script");u.crossOrigin="anonymous",u.type="text/javascript",u.src=a,o&&(u.onload=function(){e.progress[a].success.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a],e.loaded.push(a)}),r&&(u.onerror=function(){e.progress[a].failure.forEach(function(e){try{e()}catch(e){}}),delete e.progress[a]}),l.getElementsByTagName("body")[0].appendChild(u)}else o&&o()},e.loaded=[],e.progress={},e}();t.ScriptLoader=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={allowedProtocols:["https:"]},s=function(){function e(){this.probe=document.createElement("a")}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},e.prototype.validate=function(e,t){if(!e)return!1;var n=Object.assign(i,t||{}),s=function(e,t){if(!t)return!0;for(var n,i=0,s=t;i<s.length;i++){if(n=s[i]===e)break}return n};this.probe.href=e;var o=s(this.probe.protocol,n.allowedProtocols)&&s(this.probe.hostname,n.allowedDomains)&&s(this.probe.port,n.allowedPorts);return this.probe.href="",o},e}();t.UrlValidator=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getQueryParameters=function(){var e=window.location.search.substring(1);return this.extractQueryParameters(e)},e.extractQuery=function(e){var t="";return e.indexOf("?")>-1&&(t=e.split("?")[1]),t},e.getQueryParameter=function(e,t){var n=this.extractQuery(e);return n?this.extractQueryParameters(n)[t]:null},e.extractQueryParameters=function(e){var t=e.split("&"),n={};return t.forEach(function(e){var t=e.split("=");n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])||""}),n},e.extractProtocol=function(e){var t=null;return e.indexOf("://")>-1&&(t=e.split("://")[0]),t},e.extractHostname=function(e){return(e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]},e.extractPath=function(e){var t="";e.indexOf("//")>-1&&(e=e.split("//")[1]);var n=e.indexOf("/");return n>-1&&(t=e.substring(n)),t=t.split("?")[0]},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Online="Online",e.Busy="Busy",e.Offline="Offline",e.Undefined="Undefined",e.OnThePhone="OnThePhone",e.Away="Away",e.Idle="Idle",e.OutToLunch="OutToLunch",e.BeRightBack="BeRightBack",e.DoNotDisturb="DoNotDisturb"}(t.PresenceStatus||(t.PresenceStatus={}))},,,function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(0),a=n(6),c=n(18),l=n(33),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="",t}return s(t,e),t.prototype.render=function(){var e=r.swc.services.persons.getPerson(this.props.personId);return o.createElement(l.SwcPersonAvatar,{person:e,className:this.getComposedBlockClassName(),size:c.SwcAvatarSize.Medium,isPstn:this.props.isPstn,customAvatar:this.props.customAvatar,showPresence:this.props.showPresence,onClick:this.props.onClick,accessible:this.props.accessible})},t}(a.SwcBaseComponent);t.SwcPersonIdAvatar=u},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(0),a=n(40),c=n(6),l=n(8),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcAvatar",t}return s(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),t},t.prototype.render=function(){var e={"background-color":a.getBackgroundColor(this.props.title)||"transparent"};return o.createElement("div",{className:this.getComposedBlockClassName(),style:e,"aria-hidden":!1===this.props.accessible?"true":void 0,"aria-label":r.swc.services.i18n.fetch("aria_avatar_label",{title:this.props.title})},o.createElement("span",{className:"swcAvatar__initials"},o.createElement(l.SwcIcon,{type:l.SwcIconType.Landline})))},t}(c.SwcBaseComponent);t.SwcPstnAvatar=u},function(e,t,n){"use strict";var i,s,o;Object.defineProperty(t,"__esModule",{value:!0}),window.swc=window.swc||{},function(e){e[e.iwapp=927]="iwapp",e[e.todo=927]="todo",e[e.wac=928]="wac",e[e.powerbi=930]="powerbi",e[e.sharepoint=931]="sharepoint",e[e.adminportal=932]="adminportal",e[e.yammer=933]="yammer",e[e.dynamics365=934]="dynamics365",e[e.dynamicsnav=934]="dynamicsnav"}(i||(i={})),function(e){e[e.outlook=915]="outlook",e[e.interviews=916]="interviews",e[e.bing=917]="bing",e[e.msn=918]="msn",e[e.azureportal=919]="azureportal",e[e.onedrive=920]="onedrive",e[e.scom=921]="scom",e[e.office=927]="office",e[e.word=928]="word",e[e.excel=929]="excel",e[e.powerpoint=930]="powerpoint",e[e.sharepoint=931]="sharepoint",e[e.adminportal=932]="adminportal",e[e.yammer=933]="yammer",e[e.dynamics=934]="dynamics",e[e["office default"]=935]="office default"}(s=t.NameMapping||(t.NameMapping={})),function(e){e[e["outlook.live.com"]=915]="outlook.live.com",e[e["outlook-sdf.live.com"]=915]="outlook-sdf.live.com",e[e["outlook.office.com"]=915]="outlook.office.com",e[e["outlook-sdf.office.com"]=915]="outlook-sdf.office.com",e[e["interviews.skype.com"]=916]="interviews.skype.com",e[e["interviews-df.skype.com"]=916]="interviews-df.skype.com",e[e["interviews-int.skype.com"]=916]="interviews-int.skype.com",e[e["www.bing.com"]=917]="www.bing.com",e[e["www.staging-bing-int.com"]=917]="www.staging-bing-int.com",e[e["www.bing-int.com"]=917]="www.bing-int.com",e[e["www.msn.com"]=918]="www.msn.com",e[e["int.msn.com"]=918]="int.msn.com",e[e["int1.msn.com"]=918]="int1.msn.com",e[e["wtskype2.azurewebsites.net"]=919]="wtskype2.azurewebsites.net",e[e["azuresupportextension-ms.hosting.portal.azure.net"]=919]="azuresupportextension-ms.hosting.portal.azure.net",e[e["portal.azure.com"]=919]="portal.azure.com",e[e["rc.portal.azure.com"]=919]="rc.portal.azure.com",e[e["ms.portal.azure.com"]=919]="ms.portal.azure.com",e[e["onedrive.live.com"]=920]="onedrive.live.com",e[e["www.skype.com"]=921]="www.skype.com",e[e["www.office.com"]=927]="www.office.com",e[e["microsoft-my.sharepoint.com"]=931]="microsoft-my.sharepoint.com",e[e["www.onedrive.com"]=920]="www.onedrive.com",e[e["word.office.com"]=928]="word.office.com",e[e["word.live.com"]=928]="word.live.com",e[e["excell.office.com"]=929]="excell.office.com",e[e["excell.live.com"]=929]="excell.live.com",e[e["powerpoint.office.com"]=930]="powerpoint.office.com",e[e["powerpoint.live.com"]=930]="powerpoint.live.com",e[e["sharepoint.office.com"]=931]="sharepoint.office.com",e[e["adminportal.office.com"]=932]="adminportal.office.com",e[e["www.yammer.com"]=933]="www.yammer.com",e[e["dynamics.office.com"]=934]="dynamics.office.com",e[e[".office.com"]=935]=".office.com"}(o||(o={}));var r=function(){function e(){}return e.getPlatformId=function(e){if(void 0===e&&(e=null),this._platformId)return this._platformId;if(swc.SDK&&swc.SDK.platformId&&swc.SDK.platformId>0)return this._platformId=swc.SDK.platformId,this._platformId;var t=-1;return e&&(t=this.getPlatformIdByAttribute(e)),t<=0&&(t=this.getPlatformIdByDomain()),t>0?t:912},e.getPlatformIdByAttribute=function(e){if(e){e=e.trim().toLowerCase();var t=parseInt(e,10);return t&&t>0?t:this.getPlatformIdForOffice(e)}return-1},e.getPlatformName=function(){var e=this.getPlatformId();return s[e]?s[e]:"other"},e.getPlatformIdForOffice=function(e){return i[e]||935},e.getPlatformIdByDomain=function(){var t=e.getHost();if(o.hasOwnProperty(t))return o[t];for(var n in o)if("."===n.charAt(0)&&t.indexOf(n)>0)return o[n];return-1},e.getHost=function(){try{var e=window.location.hostname;return!e&&e.length>0?e:("file:"===window.location.protocol.toLowerCase()&&(e="local"),e)}catch(e){return null}},e}();t.PlatformUtils=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.unknown=0]="unknown",e[e.card=1]="card",e[e.carousel=2]="carousel",e[e.signin=3]="signin",e[e.receipt=4]="receipt",e[e.multiline=5]="multiline",e[e.adaptive=6]="adaptive"}(t.SwiftCardType||(t.SwiftCardType={})),function(e){e[e.unknown=0]="unknown",e[e.hero=1]="hero",e[e.thumb=2]="thumb",e[e.receipt=3]="receipt",e[e.signin=4]="signin",e[e.video=5]="video",e[e.audio=6]="audio",e[e.animation=7]="animation",e[e.actionImage=8]="actionImage",e[e.flex=9]="flex",e[e.adaptive=10]="adaptive"}(t.SwiftCardContentType||(t.SwiftCardContentType={})),function(e){e[e.unknown=0]="unknown",e[e.unsupported=1]="unsupported",e[e.openUrl=2]="openUrl",e[e.imBack=3]="imBack",e[e.signin=4]="signin",e[e.call=5]="call",e[e.showImage=6]="showImage",e[e.payment=7]="payment",e[e.postBack=8]="postBack"}(t.SwiftCardActionType||(t.SwiftCardActionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UserMessage="UserMessage",e.SwiftCard="SwiftCard",e.SystemMessage="SystemMessage",e.Unsupported="Unsupported",e.SkypeLogo="SkypeLogo",e.Welcome="Welcome",e.Translate="Translate",e.LwcImage="LwcImage",e.LwcFile="LwcFile",e.UnreadSplitter="UnreadSplitter"}(t.MessageType||(t.MessageType={})),function(e){e.CallEnd="CallEndMsg",e.MissedCall="MissedCallMsg",e.MissedGroupCall="MissedGroupCallMsg",e.Call="CallMsg",e.Custom="CustomMsg",e.MeLeftGroup="MeLeftGroupConversation"}(t.CustomMessageType||(t.CustomMessageType={})),function(e){e[e.Incoming=0]="Incoming",e[e.Outgoing=1]="Outgoing"}(t.Direction||(t.Direction={})),function(e){e[e.Pending=0]="Pending",e[e.Sent=1]="Sent",e[e.Failed=2]="Failed"}(t.DeliveryStatus||(t.DeliveryStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.addMember="addMember",e.changeTopic="changeTopic",e.changePicture="changePicture",e.kickMember="kickMember",e.editMsg="editMsg",e.callP2P="callP2P",e.sendText="sendText",e.sendSms="sendSms",e.sendFileP2P="sendFileP2P",e.sendContacts="sendContacts",e.sendVideoMsg="sendVideoMsg",e.sendMediaMsg="sendMediaMsg",e.changeModerated="changeModerated"}(t.ParticipantCapabilities||(t.ParticipantCapabilities={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.UNDEFINED="",e.PERSON="person",e.PHONE="phone",e.AGENT="agent",e.JOIN="join",e.GROUP="group"}(t.ConversationType||(t.ConversationType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Admin="Admin",e.User="User"}(t.ParticipantRole||(t.ParticipantRole={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="NFKD",s={"ª":"a","º":"o","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","ā":"a","ă":"a","ą":"a","ć":"c","ĉ":"c","ċ":"c","č":"c","ď":"d","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","ĥ":"h","ĩ":"i","ī":"i","ĭ":"i","į":"i","ĳ":"ij","ĵ":"j","ķ":"k","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l·","ń":"n","ņ":"n","ň":"n","ŉ":"ʼn","ō":"o","ŏ":"o","ő":"o","ŕ":"r","ŗ":"r","ř":"r","ś":"s","ŝ":"s","ş":"s","š":"s","ţ":"t","ť":"t","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","ŵ":"w","ŷ":"y","ź":"z","ż":"z","ž":"z","ſ":"s","ơ":"o","ư":"u","ǆ":"dz","ǈ":"Lj","ǉ":"lj","ǋ":"Nj","ǌ":"nj","ǎ":"a","ǐ":"i","ǒ":"o","ǔ":"u","ǖ":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǟ":"a","ǡ":"a","ǧ":"g","ǩ":"k","ǫ":"o","ǭ":"o","ǰ":"j","ǳ":"dz","ǵ":"g","ǹ":"n","ǻ":"a","ȁ":"a","ȃ":"a","ȅ":"e","ȇ":"e","ȉ":"i","ȋ":"i","ȍ":"o","ȏ":"o","ȑ":"r","ȓ":"r","ȕ":"u","ȗ":"u","ș":"s","ț":"t","ȟ":"h","ȧ":"a","ȩ":"e","ȫ":"o","ȭ":"o","ȯ":"o","ȱ":"o","ȳ":"y","ʰ":"h","ʲ":"j","ʳ":"r","ʷ":"w","ʸ":"y","ˡ":"l","ˢ":"s","ˣ":"x"};function o(e,t){var n=e.substring(0,t).search(/\S+$/),i=e.substring(t).search(/\s/);return-1===n&&(n=t),-1===i?i=e.length:i+=t,{start:n,end:i}}t.toBoolean=function(e){return e?"true"===e.toLowerCase():null},t.wordAt=function(e,t){var n=o(e,t);return e.substring(n.start,n.end)},t.inject=function(e,t,n,i){return void 0===i&&(i=n),e.substr(0,n)+t+e.substr(i,e.length)},t.wordBoundariesAt=o,t.b64DecodeUnicode=function(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},t.normalizeString=function(e){if(e=e.toLowerCase(),String.prototype.normalize)return e.normalize(i).replace(/[\u0300-\u036f]/g,"");var t=parseInt("0xD800",16),n=parseInt("0xDBFF",16),o=0,r="",a="",c=void 0;if(!e)return e;for(;o<e.length;)r+=e.charAt(o),((c=e.charCodeAt(o))<t||c>n)&&(a+=s.hasOwnProperty(r)?s[r]:r,r=""),o++;return a},t.startsWith=function(e,t){return 0===e.indexOf(t)},t.endsWith=function(e,t){return e.lastIndexOf(t)===e.length-t.length}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(145),c=n(20),l=n(12),u=function(e){function t(n,i){var s=e.call(this,n,i)||this;return s._lastItemId=0,s._items={},s._itemCount=0,s._currentItemIndex=0,s._isFocusIn=!1,s._onFocusIn=function(e){var n=e.target;s._isFocusIn=t._isParentChild(s._node,n)},s._onKeyDown=function(e){if(s._isFocusIn){var t=c.default.getKeyCode(e);if(t===l.default.UP||t===l.default.DOWN||t===l.default.ENTER)if(e.stopImmediatePropagation(),e.preventDefault(),t!==l.default.ENTER){var n=s._getSortedItemIds();if(s._currentItemIndex>=0){var i=n[s._currentItemIndex+(t===l.default.UP?-1:1)];if(i){var o=s._items[i];o&&o.focus()}}}else if(s._currentItemId){var r=s._items[s._currentItemId];r&&r.click()}}},s}return s(t,e),t.prototype.getChildContext=function(){return{accessibleList:this}},t.prototype.render=function(){return r.createElement(o.Fragment,null,this.props.children)},t.prototype.componentDidMount=function(){if(this._node=a.findDOMNode(this),!this._node)throw new Error("Failed to find list container node.");document.addEventListener("focusin",this._onFocusIn),window.addEventListener("keydown",this._onKeyDown)},t.prototype.componentWillUnmount=function(){this._restoreFocusabilityTimer&&(window.clearTimeout(this._restoreFocusabilityTimer),this._restoreFocusabilityTimer=void 0),document.removeEventListener("focusin",this._onFocusIn),window.removeEventListener("keydown",this._onKeyDown)},t.prototype.onItem=function(e,t){t?(e.id="i"+ ++this._lastItemId,this._items[e.id]=e,this._itemCount++,e.limitFocusability(!0)):(this._currentItemId===e.id&&(this._currentItemId=void 0),delete this._items[e.id],this._itemCount--),this._currentItemIndex>=this._itemCount&&(this._currentItemIndex=this._itemCount>0?this._itemCount-1:0),this._sortedItemIds=void 0,this._restoreFocusability()},t.prototype.onItemFocus=function(e){if(this._currentItemId!==e.id){var t=this._items[this._currentItemId];t&&t.limitFocusability(!0),this._currentItemId=e.id,this._currentItemIndex=this._getSortedItemIds().indexOf(e.id),e.limitFocusability(!1)}},t.prototype._restoreFocusability=function(){var e=this;this._restoreFocusabilityTimer||(this._restoreFocusabilityTimer=window.setTimeout(function(){e._restoreFocusabilityTimer=void 0;var t=e._getSortedItemIds()[e._currentItemIndex];if(t!==e._currentItemId){if(e._currentItemId){var n=e._items[e._currentItemId];n&&n.limitFocusability(!0)}var i=e._items[t];e._currentItemId=t,i&&(i.limitFocusability(!1),e._isFocusIn&&i.focus())}},0))},t.prototype._getSortedItemIds=function(){var e=this;return void 0===this._sortedItemIds&&(this._sortedItemIds=Object.keys(this._items),this._sortedItemIds.sort(function(t,n){if(t===n)return 0;var i=e._items[t].getNode(),s=e._items[n].getNode();return i?s&&i.compareDocumentPosition(s)&document.DOCUMENT_POSITION_PRECEDING?1:-1:1})),this._sortedItemIds},t._isParentChild=function(e,t){return t===e||!!(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_CONTAINED_BY)},t}(o.Component);t.AccessibleList=u;var d=function(e){function t(t,n){var i=e.call(this,t,n)||this;if(i._onFocusIn=function(e){i._list.onItemFocus(i)},!i.context.accessibleList)throw new Error("No list container found.");return i._list=i.context.accessibleList,i}return s(t,e),t.prototype.render=function(){return r.createElement(o.Fragment,null,this.props.children)},t.prototype.getNode=function(){return this._node},t.prototype.componentDidMount=function(){if(this._node=a.findDOMNode(this),!this._node)throw new Error("Failed to find list item node.");this._list.onItem(this,!0),this._node.addEventListener("focusin",this._onFocusIn)},t.prototype.componentWillUnmount=function(){this._list.onItem(this,!1),this._node.removeEventListener("focusin",this._onFocusIn)},t.prototype.limitFocusability=function(e){this._node&&(this._node.tabIndex=e?-1:0)},t.prototype.focus=function(){this._node&&this._node.focus()},t.prototype.click=function(){this._node&&this._node.click()},t}(o.Component);t.AccessibleListItem=d},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(5),o=n(2),r=n(29),a=n(11),c=n(0),l=n(64);t.TEAMS_NOTIFICATION_CHANNEL_ID="48:notifications";var u=function(e){void 0===e&&(e="");var t=e.match((i||(i=s.default.get.backend===a.MessagingBackend.TEAMS?/^(https?:.+?\.microsoft\.com\/V\d+\/)/i:/^(https?:.+?\.live\.com\/V\d+\/)/i),i));return t?t[1]:null};function d(e){return u(e).replace(/\/(v2)\/?$/i,"/v1/")}t.parseChatServiceHostUrl=d,t.handle404Redirect=function(e,t,n){var i=e.headers.get("location");return 404===e.status&&i&&u(i)?(o.Configuration.CHAT_HOST_URL=d(i),n?t(i):t()):Promise.resolve(e)},t.getDomain=function(){return c.swc.services.signInManager.userIdentityType===r.IdentityType.GUEST&&o.Configuration.CHAT_GUEST_HOST_URL!==o.Configuration.CHAT_HOST_URL&&c.swc.Telemetry.sendEvent.serviceQos("webapi-guestInDogfood","",0,null,""),o.Configuration.CHAT_HOST_URL},t.getConversationIdFromUrl=function(e){var t=e&&e.match(/\/(\d+:[^\/]*)[\/]?/);return t&&t[1]?t[1]:void 0},t.reset=function(){o.Configuration.CHAT_HOST_URL=o.Configuration.CHAT_GUEST_HOST_URL},t.normalizePersonId=function(e){var t=e.match(/(\d+:)([\S]*)/);return t?t[2]:e},t.isThread=function(e){try{var t=e.threadtype;if(t&&(t===l.ThreadType.Space||t===l.ThreadType.Topic))return!0}catch(e){}return!1},t.isThreadExtended=function(e){try{var t=(e.threadtype||e.threadType||e.threadProperties&&(e.threadProperties.threadtype||e.threadProperties.threadType)||e.properties&&(e.properties.threadtype||e.properties.threadType)||e.type||"").toLowerCase();if(t&&(t===l.ThreadType.Space||t===l.ThreadType.Topic))return!0}catch(e){}return!1}},,function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(10),a=n(17),c=function(e){function t(){var t=e.call(this)||this;return t._isOnline=navigator.onLine,t.subscribeOnlineHandlers(),t}return s(t,e),Object.defineProperty(t.prototype,"isOnline",{get:function(){return this._isOnline},set:function(e){e!==this._isOnline&&(this._isOnline=e,this.publish("isOnline",e),e&&this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending&&this._onlinePromise.resolve())},enumerable:!0,configurable:!0}),t.prototype.onceOnline=function(){return this.isOnline?Promise.resolve():(this._onlinePromise&&this._onlinePromise.status===a.PromiseStatus.Pending||(this._onlinePromise=new a.CancelablePromise),this._onlinePromise.promise)},t.prototype.subscribeOnlineHandlers=function(){window.addEventListener("online",this.onlineStatusHandler.bind(this)),window.addEventListener("offline",this.onlineStatusHandler.bind(this))},t.prototype.onlineStatusHandler=function(){this.isOnline=navigator.onLine},t}(r.default);t.get=function(){return o||(o=new c),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);!function(e){e.StartVideoCall="videocall",e.StartAudioCall="audiocall",e.Feedback="feedback",e.GetHelp="gethelp",e.ThirdPartyNotices="thirdPartyNotices",e.PrivacyAndCookies="privacyAndCookies",e.TermsOfUse="termsOfUse",e.OpenComposer="openComposer",e.AddParticipant="addParticipant",e.Participants="participants",e.Fullscreen="fullscreen",e.MediaSettings="mediaSettings",e.SwitchToChat="switchToChat",e.MinimizeChat="minimizeChat",e.VideoOn="videoOn",e.VideoOff="videoOff",e.AudioOn="audioOn",e.AudioOff="audioOff",e.ScreenSharingOn="screenSharingOn",e.ScreenSharingOff="screenSharingOff",e.ToggleAudio="toggleAudio",e.StopCall="stopCall",e.ExpressionPicker="expressionPicker",e.FilePicker="filePicker",e.DeleteMessage="deleteMessage",e.DeleteConversation="deleteChat",e.LeaveConversation="leaveChat",e.BlockUser="block",e.UnblockUser="unblock",e.ReactionPicker="reactionPicker",e.MarkMessageUnread="markMessageUnread",e.MarkConversationUnread="markConversationUnread",e.MarkConversationsRead="markAllRead",e.SortByTime="sortByTime",e.SortByUnread="sortByUnread",e.SelectStandartView="setRecentsStandardView",e.SelectCompactView="setRecentsCompactView",e.HideFavorites="hideFavorites",e.ShowFavorites="showFavorites",e.AddToFavorites="addToFavorites",e.RemoveFromFavorites="removeFromFavorites",e.StartScreenShare="startScreenShare",e.OpenContacts="contacts",e.OpenRecents="recents",e.StopScreenShare="stopScreenShare",e.RecentsMore="moreRecentsActions",e.NotificationSettings="notificationSettings",e.BackFromNotificationSettings="backFromNotificationSettings",e.ReportProblem="reportProblem",e.CallBack="callBack"}(t.UserActionType||(t.UserActionType={})),t.sendUserActionEvent=function(e){var t={name:"kpi_action",properties:{type:{value:e}}};i.swc.Telemetry.getLogger().logEvent(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OneOnOne="1on1",e.Chat="chat",e.Space="space",e.Topic="topic",e.SfbInterop="sfbinterop",e.SfbInteropChat="sfbinteropchat",e.Meeting="meeting"}(t.ThreadType||(t.ThreadType={})),function(e){e.EventMessage="EventMessage"}(t.EventType||(t.EventType={})),function(e){e.Text="Text",e.RichText="RichText",e.RichTextUriObject="RichText/UriObject",e.RichTextMedia_GenericFile="RichText/Media_GenericFile",e.ControlClearTyping="Control/ClearTyping",e.ControlTyping="Control/Typing",e.ControlLiveState="Control/LiveState",e.SystemMessage="SystemMessage",e.InviteFreeRelationshipChangedInitialized="InviteFreeRelationshipChanged/Initialized",e.SignalFlamingo="Signal/Flamingo",e.RichTextHtml="RichText/Html",e.EventCall="Event/Call"}(t.MessagePayloadType||(t.MessagePayloadType={})),function(e){e.Audio="Audio",e.Video="Video"}(t.PresenceCapabilities||(t.PresenceCapabilities={}))},function(e,t,n){(function(t){var n="Expected a function",i=NaN,s="[object Symbol]",o=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,p=u||d||Function("return this")(),h=Object.prototype.toString,f=Math.max,g=Math.min,v=function(){return p.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function _(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&h.call(e)==s}(e))return i;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=a.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):r.test(e)?i:+e}e.exports=function(e,t,i){var s,o,r,a,c,l,u=0,d=!1,p=!1,h=!0;if("function"!=typeof e)throw new TypeError(n);function y(t){var n=s,i=o;return s=o=void 0,u=t,a=e.apply(i,n)}function w(e){var n=e-l;return void 0===l||n>=t||n<0||p&&e-u>=r}function b(){var e=v();if(w(e))return C(e);c=setTimeout(b,function(e){var n=t-(e-l);return p?g(n,r-(e-u)):n}(e))}function C(e){return c=void 0,h&&s?y(e):(s=o=void 0,a)}function E(){var e=v(),n=w(e);if(s=arguments,o=this,l=e,n){if(void 0===c)return function(e){return u=e,c=setTimeout(b,t),d?y(e):a}(l);if(p)return c=setTimeout(b,t),y(l)}return void 0===c&&(c=setTimeout(b,t)),a}return t=_(t)||0,m(i)&&(d=!!i.leading,r=(p="maxWait"in i)?f(_(i.maxWait)||0,t):r,h="trailing"in i?!!i.trailing:h),E.cancel=function(){void 0!==c&&clearTimeout(c),u=0,s=l=o=c=void 0},E.flush=function(){return void 0===c?a:C(v())},E}}).call(this,n(24))},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.multilineRegExp=function(e,t){return new RegExp(e.join(""),t)},e.escapeSpecialChars=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},e}();t.default=i},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),r=n(0),a=n(28),c=n(4),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isFocused=!0,t.restart=function(){t.dispose(),t._initManagers&&t._initManagers(),t._signInManager.getSkypeToken().then(null,function(){}),r.swc.services.mePersonManager.fetch(),t.restoreLastConversation()},t}return s(t,e),Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.initServices=function(e){t._initParams=e;var n=t._initParams;return r.swc.Eventing.registerEvent(c.ApiEvents.CallStatusChanged,function(e){if(e)switch(e.status){case 2:case 3:case 4:case 9:t._isInCall=!0;break;default:t._isInCall=!1}}),r.swc.services.initManagers(a.LocaleInfo.instance.getLocale(),{tokenProvider:n.skypeTokenProvider||n.tokenProvider,initialToken:n.initialSkypeTokenData,externalLogin:n.externalLogin,tokenType:n.tokenType,enterpriseAuth:n.enterpriseAuth},{fileSharing:n.fileSharing,userSettings:n.userSettings}).then(function(){t.instance.SignInManager,r.swc.services.persons})},t.prototype.dispose=function(){var e;(e=this._mePersonManager)&&(e.dispose(),e=null),this._amsManager&&this._amsManager.dispose(),this._persons&&this._persons.dispose(),this._isCleared=!1},Object.defineProperty(t.prototype,"SignInManager",{get:function(){return this._signInManager||(this._signInManager=r.swc.services.signInManager,this._signInManager&&this._signInManager.subscribe("resurrect",this.restart)),this._signInManager},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCleared",{get:function(){return this._isCleared},set:function(e){e!==this._isCleared&&(this._isCleared=e,this.publish("isCleared",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFocused",{get:function(){return this._isFocused},set:function(e){e!==this._isFocused&&(this._isFocused=e,this.publish("isFocused",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isInCall",{get:function(){return t._isInCall},enumerable:!0,configurable:!0}),t.prototype.setRestoreOfLastConversation=function(e){this._lastConversationCallback=e},t.prototype.restoreLastConversation=function(){this._lastConversationCallback&&this._lastConversationCallback()},t.prototype.setManagersInit=function(e){this._initManagers||(this._initManagers=e)},t._isInCall=!1,t}(o.default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s="px",o=25,r="swc-scroll-hide",a=200;function c(){return"rtl"===document.dir}var l=function(){function e(e,t){var n=this;this.container=e,this.viewport=t,this.recount=function(){n.vh=n.viewport.offsetHeight,n.sh=n.viewport.scrollHeight,n.vw=n.container.offsetWidth;var e=n.viewport.getBoundingClientRect();n.vpOffsetX=e.left,n.vpOffsetY=e.top,n.vh2sh=n.vh/n.sh,n.sh2vh=n.sh/n.vh;var t=Math.round(n.vh*n.vh2sh),i=n.slider.style;if(t<o){var r=n.vh-o+t;n.vh2sh=r/n.sh,i.height=o+s,n.sliderH=o}else i.height=t+s,n.sliderH=t;n.show(),n.updateSlider()},this.update=function(){n.ticking=!1,n.updateSlider()},this.show=function(){n.sh<=n.vh||!n.active?n.hide():n.visible||(n.rail.style.display="",n.visible=!0)},this.hide=function(){n.visible&&(n.rail.style.display="none",n.viewport.classList.remove("active"),n.visible=!1)},this.updateSlider=function(){var e=n.viewport.scrollTop*n.vh2sh;n.currentTop!==e&&(n.currentTop=e,n.slider.style.top=n.currentTop+s)},this.requestTick=function(e){n.ticking||(n.ownerWindow&&n.ownerWindow.requestAnimationFrame(n.update),n.update()),n.ticking=!0,n.update()},this.bindEvents=function(){n.viewport.addEventListener("scroll",n.requestTick,!1),n.container.addEventListener("mousedown",n.onMouseDown),n.container.addEventListener("mousemove",n.onMouseMove),n.container.addEventListener("mouseenter",n.onMouseEnter),n.container.addEventListener("mouseleave",n.onMouseLeave)},this.onMouseMove=function(e){n.dragging?n.viewport.scrollTop=(e.clientY-n.vpOffsetY)*n.sh2vh:(c()?e.clientX-n.vpOffsetX<=10:e.clientX-n.vpOffsetX>n.vw-10)?(n.rail.classList.add("active"),n.hover=!0):n.hover&&(n.rail.classList.remove("active"),n.hover=!1)},this.onMouseEnter=function(){n.active=!0,n.recount()},this.onMouseLeave=function(){n.active=!1,n.dragging||n.hide()},this.onMouseDown=function(e){var t=e.clientX-n.vpOffsetX,i=e.clientY-n.vpOffsetY;if(c()?t<10:t>=n.vw-10){var s=parseInt(n.slider.style.top,10);i>s&&i<s+n.sliderH?n.startDrag(e):n.viewport.scrollTop=i*n.sh2vh,e.preventDefault(),e.stopPropagation()}},this.handleDrag=function(e){n.viewport.scrollTop=(e.clientY-n.dragOffset)*n.sh2vh},this.startDrag=function(e){n.dragging||(n.viewport.classList.add("scrolling"),n.dragOffset=e.pageY-n.slider.offsetTop,n.dragging=!0,n.container.removeEventListener("mousemove",n.onMouseMove),n.container.ownerDocument.addEventListener("mouseup",n.stopDrag),n.container.ownerDocument.addEventListener("mousemove",n.handleDrag)),e.preventDefault()},this.stopDrag=function(){n.container.ownerDocument.removeEventListener("mousemove",n.handleDrag),n.container.ownerDocument.removeEventListener("mouseup",n.stopDrag),n.container.addEventListener("mousemove",n.onMouseMove),n.viewport.classList.remove("scrolling"),n.dragging=!1},this.container.classList.add("swc-scroll-wrapper"),this.viewport.classList.add("swc-scroll-viewport"),this.build(),this.init(),function(e){if(i)return i;var t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",t.style.left="-9999px",t.className="swc-scroll-viewport",t.innerHTML="<style>.swc-scroll-viewport{-ms-overflow-style:none;}.swc-scroll-viewport::-webkit-scrollbar{width:0;}</style>";var n=e.ownerDocument||document;return n.body.appendChild(t),i=new Promise(function(e){var i=function(){var s=t.offsetWidth;if(s){var o=s-t.clientWidth;e(o),n.body.removeChild(t)}else setTimeout(i,a)};i()})}(e).then(function(e){e&&n.viewport.classList.add(r)})}return Object.defineProperty(e.prototype,"ownerWindow",{get:function(){return this.container.ownerDocument.defaultView},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.bindEvents()},e.prototype.build=function(){this.slider=document.createElement("div"),this.slider.className="swc-scroll-slider",this.rail=document.createElement("div"),this.rail.className="swc-scroll-rail",this.rail.appendChild(this.slider),this.rail.style.display="none",this.container.appendChild(this.rail)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SEARCH="search",e.CONTACTS="contacts",e.RECENT="recent",e.NEWCHAT="new",e.AVATAR="avatar",e.CONVERSATION_ROSTER="conversationRoster",e.ADD_PARTICIPANTS_TEAMS="addParticipantsTeams"}(t.OpenChatOrigin||(t.OpenChatOrigin={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(110),s=n(111),o=n(14),r=n(112),a=function(){function e(){}return Object.defineProperty(e,"encoder",{get:function(){return e._encoder||(e._encoder=new i.Encoder),this._encoder},enumerable:!0,configurable:!0}),e.INVALID_VALUE="invalidValue",e.filterOutNotValidItems=function(t,n){for(var i=e.mapArray(t,n),s=[],o=0;o<i.length;o++){var r=i[o];r.isValid&&!r.isValid()||s.push(r)}return s},e.filterOutDisabledItems=function(t,n){for(var i=e.mapArray(t,n),s=[],o=0;o<i.length;o++){var r=i[o];r.isDisabled&&r.isDisabled()||s.push(r)}return s},e.getItemIfNotDisabled=function(e){return e.isDisabled&&e.isDisabled()?null:e},e.mapArray=function(e,t){var n=[];if(!e)return n;for(var i=0;i<e.length;i++){var s=e[i];s&&n.push(t(s))}return n},e.mapImages=function(e,t,n,i){var s=[];return e.forEach(function(e){e.url&&s.push(new r.default(e,t,n,i))}),s},e.normalizeText=function(e){return e?o.MessageUtils.getMessageSanitizedContent(e):null},e.normalizeUrl=function(e){return o.MessageUtils.normalizeUrl(e)},e.normalizeDestination=function(t){return/^(skype|tel):/i.test(t)?o.MessageUtils.getMessageSanitizedContent(t):e.INVALID_VALUE},e.normalizeRichText=function(t){if(!t)return"";t=e.encoder.decode(e.encoder.encode(t)),t=o.MessageUtils.unescapeBrackets(t);var n=s.default.parse(t);return o.MessageUtils.getMessageSanitizedContent(n)},e}();t.default=a},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(22),s={id:"flik",ariaLabelLocKey:"expressionPicker_mruMojiPack_ariaLabel",titleLocKey:"expressionPicker_mruMojiPack_title",mruLimit:10},o=function(){function e(){var e=this;this.CACHE_KEY="swx|pes",this.SAVED_DATA_VERSION="v1.0",this.FEATURED_IN_PREFIX="FeaturedIn-",this.pesCDNAuthentication={skypeServiceHost:"static.asm.skype.com",tokenSourceEndpoint:"/pes/v1/petoken",cdnServiceHost:"static-asm.secure.skypeassets.com",cookieSourceEndpoint:"/token/token_to_cookies",securedPathsPatter:"static[.]asm[.]skype[.]com",cdnTokenTtlMs:3e5,rewriteRules:[{from:"static.asm.skype.com",to:"static-asm.secure.skypeassets.com"},{from:"api.asm.skype.com",to:"static-asm.secure.skypeassets.com"}]},this.itemTypes={typeKeyName:"type",tab:{id:"tab",ariaLabelLocKey:"expressionPicker_mruTab_ariaLabel",titleLocKey:"expressionPicker_mruTab_title"},emoticon:{id:"emoticon",ariaLabelLocKey:"expressionPicker_mruEmoticonPack_ariaLabel",titleLocKey:"expressionPicker_mruEmoticonPack_title",mruLimit:27},moji:s,image:{id:"image"},message:{id:"message"},sticker:{id:"sticker"},flik:s},this.mru={TAB_ID:"mru",PACK_PREFIX:"mru:"},this.bingSearch={TAB_ID:"bing",PACK_PREFIX:"bing:"},this.giphyImageSearch={TAB_ID:"giphyImages",PACK_PREFIX:"giphy-imh:"},this.localSearch={TAB_ID:"localSearch",PACK_PREFIX:"local:",titleLocKey:"expressionPicker_localSearchPack_title",ariaLabelLocKey:"expressionPicker_localSearchPack_ariaLabel"},this.frameHeights={emoticons:{SMALL:20,LARGE:40,EXTRA_LARGE:60,SUPER_LARGE:120},moji:{THUMBNAIL:40,KEYFRAME:80},packs:{TAB:19}},this.profiles={emoticons:{getSmall:function(){return e.highDpi?"default_40_f":"default_20_f"},getLarge:function(){return e.highDpi?"default_80_f":"default_40_f"},getExtraLarge:function(){return e.highDpi?"default_120_f":"default_60_f"},getSuperLarge:function(){return e.highDpi?"default_240_f":"default_120_f"},getSmallAnimated:function(){return e.highDpi?"default_40_anim_f":"default_20_anim_f"},getLargeAnimated:function(){return e.highDpi?"default_80_anim_f":"default_40_anim_f"},getExtraLargeAnimated:function(){return e.highDpi?"default_120_anim_f":"default_60_anim_f"},getSuperLargeAnimated:function(){return e.highDpi?"default_240_anim_f":"default_120_anim_f"}},moji:{thumbnail:"thumbnail",content:"default"}}}return Object.defineProperty(e.prototype,"highDpi",{get:function(){return this._highDpi||(this._highDpi=i.default.getScreenInfo().pixelRatio>1),this._highDpi},enumerable:!0,configurable:!0}),e}();t.default=new o},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hashCode=function(e){var t=0,n=e.length,i=0;if(n>0)for(;i<n;)t=(t<<5)-t+e.charCodeAt(i++)|0;return t}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=function(e){function t(t){var n=e.call(this,t)||this;return n._onError=function(){n.props.onLoad&&n.props.onError()},n._onLoad=function(){n.setState({loaded:!0}),n.props.onLoad&&n.props.onLoad()},n.state={loaded:!1},n}return s(t,e),t.prototype.render=function(){var e=this.props,t=e.src,n=e.className,i=e.useCredentials,s=e.placeholder,a=this.state.loaded;return r.createElement(o.Fragment,null,!a&&s&&s,i?r.createElement("img",{crossOrigin:"use-credentials",src:t,hidden:!a,onError:this._onError,onLoad:this._onLoad,className:n}):r.createElement("img",{src:t,hidden:!a,onError:this._onError,onLoad:this._onLoad,className:n}))},t}(o.Component);t.SwcImageLoader=a},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(6),a=n(18),c=n(48),l=n(49),u=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="",n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n.state={title:"",avatarUrl:"",isPerson:!1,isPstn:!1},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props.item;this.setState({isPerson:e.isPerson,isPstn:e.isPstn}),e.isPerson||(this._onTopicUpdate(e.topic),e.subscribe("topic",this._onTopicUpdate),e.isPstn||(e.avatar&&this._onAvatarUpdate(e.avatar),e.subscribe("avatar",this._onAvatarUpdate)))},t.prototype.componentWillUnmount=function(){var e=this.props.item;e.unsubscribe("avatar",this._onAvatarUpdate),e.unsubscribe("topic",this._onTopicUpdate)},t.prototype.render=function(){if(this.state.isPstn)return o.createElement(l.SwcPstnAvatar,{className:this.getComposedBlockClassName(),size:a.SwcAvatarSize.Medium,title:this.state.title,accessible:!1});if(this.state.isPerson){var e=this.props.item.id;return this.props.item.withPerson&&(e=this.props.item.withPerson.mri),o.createElement(c.SwcPersonIdAvatar,{className:this.getComposedBlockClassName(),personId:e,showPresence:!0,accessible:!1})}return o.createElement(a.SwcAvatar,{className:this.getComposedBlockClassName(),size:a.SwcAvatarSize.Medium,title:this.state.title,avatarUrl:this.state.avatarUrl,accessible:!1})},t}(r.SwcBaseComponent);t.SwcRecentAvatar=u},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(6),a=n(18),c=n(79),l=n(33),u=n(48),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="",t}return s(t,e),t.prototype.render=function(){return this.props.conversation.isOneOnOne?this.props.conversation.isTeamsOneOnOne?o.createElement(l.SwcPersonAvatar,{className:this.getComposedBlockClassName(),size:a.SwcAvatarSize.Medium,person:this.props.conversation.theOtherParticipant.person,showPresence:!0,customAvatar:this.props.customAvatar}):o.createElement(u.SwcPersonIdAvatar,{className:this.getComposedBlockClassName(),personId:this.props.conversation.id,showPresence:!0,customAvatar:this.props.customAvatar}):o.createElement(c.SwcGroupAvatar,{className:this.getComposedBlockClassName(),group:this.props.conversation,customAvatar:this.props.customAvatar,customTitle:this.props.customTitle})},t}(r.SwcBaseComponent);t.SwcConversationAvatar=d},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(6),c=n(18),l=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="",n._onAvatarUpdate=function(e){n.setState({avatarUrl:e})},n._onTopicUpdate=function(e){n.setState({title:e})},n.state={title:n.props.customTitle||"",avatarUrl:n.props.customAvatar||""},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props.group;this.props.customTitle?this._onTopicUpdate(this.props.customTitle):(this._onTopicUpdate(e.topic),e.subscribe("topic",this._onTopicUpdate)),this.props.customAvatar?this._onAvatarUpdate(this.props.customAvatar):(e.avatar&&this._onAvatarUpdate(e.avatar),e.subscribe("avatar",this._onAvatarUpdate))},t.prototype.componentWillUnmount=function(){var e=this.props.group;e.unsubscribe("avatar",this._onAvatarUpdate),e.unsubscribe("topic",this._onTopicUpdate)},t.prototype.render=function(){return r.createElement(c.SwcAvatar,o({className:this.getComposedBlockClassName(),size:c.SwcAvatarSize.Medium},this.state))},t}(a.SwcBaseComponent);t.SwcGroupAvatar=l},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=function(e){try{var t=i.swc.services.mePerson.mri;return i.swc.services.webApi.createThread([{id:t,role:"Admin"},{id:e,role:"Admin"}]).then(function(e){return e.headers.get("location").match(/threads\/(19:.*)$/)[1]})}catch(e){}return Promise.resolve(void 0)};t.generateOneToOneConversationId=function(e){try{if(t.isEnterpriseObjectId(e))return function(e){try{var t=i.swc.services.contactsService;if(t.getContactByObjectId)return t.getContactByObjectId(e).then(function(e){return s(e.mri)})}catch(e){}return Promise.resolve(void 0)}(t.getGuidFromEnterpriseObjectId(e));if(t.isEnterpriseUserMri(e))return s(e)}catch(e){}return Promise.resolve(void 0)},t.isEnterpriseUserMri=function(e){return/^8:orgid:[^@]+$/.test(e)},t.isEnterpriseObjectId=function(e){return/^objectId:[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/.test(e)},t.getGuidFromEnterpriseObjectId=function(e){return e.replace("objectId:","")}},,function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(57),c=n(20),l=n(12),u=n(8),d=n(6);!function(e){e.Wide="swcMenuList_wide"}(t.SwcMenuListSize||(t.SwcMenuListSize={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcMenuList",t._onItemKeyDown=function(e,t){var n=c.default.getKeyCode(t);!e.action||n!==l.default.ENTER&&n!==l.default.SPACE||e.action()},t._onItemClick=function(e){e.action&&e.action()},t}return s(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),t},t.prototype.render=function(){var e=this,t="swcMenuList__item  "+(this.props.itemClassName||"");return r.createElement(a.AccessibleList,null,this.props.groups.map(function(n){return r.createElement("ul",{key:n.id,className:e.getComposedBlockClassName()+" "+(n.className||"")},n.items.map(function(n){return r.createElement("li",{tabIndex:n.disabled?-1:0,key:n.title,"aria-label":n.title,title:n.title,onKeyDown:o.linkEvent(n,e._onItemKeyDown),onMouseDown:o.linkEvent(n,e._onItemClick),className:t+" "+n.className},n.title,n.innerElement,n.selected&&r.createElement(u.SwcIcon,{type:u.SwcIconType.Ok}))}))}))},t}(d.SwcBaseComponent);t.SwcMenuList=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.transformRawToXml=function(e,t,n,i){var s=[];for(s.push(t);0!==s.length;){var o=s.pop();o.nodeType===Node.TEXT_NODE?this.encodeTextNodeToXml(e,o,n,i):this.isElementAllowed(o)&&this.pushChildNodes(s,o)}},e.prototype.wordMatcher=function(){return/[\w()#:\-=<>;'\|\$"\]\*\^&\+@\{\?Ǝ\/\\!~]+/g},e.prototype.getAllWords=function(e){for(var t,n=this.wordMatcher(),i=new Array;null!==(t=n.exec(e));)i.push(t);return i},e.prototype.encodeTextNodeToXml=function(e,t,n,i){var s=t.parentNode,o=this.encodeWords(e,t,n,i);o&&o.length&&(o.forEach(function(e){s.insertBefore(e,t)}),s.removeChild(t))},e.prototype.encodeWords=function(e,t,n,i){var s=this,o=t.nodeValue,r=this.getAllWords(o),a=0,c=[];return r.forEach(function(t){var r=s.wordRawToXml(e,t[0],n,i);0!==r.length&&(a!==t.index&&c.push(e.createTextNode(o.substring(a,t.index))),a=t.index+t[0].length,c=c.concat(r))}),0!==a&&a<o.length&&c.push(e.createTextNode(o.substring(a))),c},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e}();t.WordDomTransformer=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(35),s=function(){function e(){}return e._personIdRegExp=/(\d+:)([\S]*)/,e.normalizePersonId=function(t){var n=t&&t.match(e._personIdRegExp);return n?n[2]:t},e.parsePersonId=function(t){var n=t.match(e._personIdRegExp);return n?{id:n[2],type:parseInt(n[1],0)}:{id:t,type:null}},e.getContactType=function(e){var t=/\d{0,}[^:]/g.exec(e.mri);return t&&t[0]?parseInt(t[0],0):i.ContactType.Undefined},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(21),s=function(){function e(){}return e.addStyle=function(e,t){if(!(t=t||i.default.getDocument()).head||function(e,t){for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].href===e)return!0;return!1}(e))return Promise.resolve();var n=t.createElement("link");return n.type="text/css",n.rel="stylesheet",n.href=e,new Promise(function(e,i){n.onload=function(){return e()},n.onerror=function(){return i()},t.head.appendChild(n)})},e}();t.StyleLoader=s},function(e,t,n){(function(t){var n=1/0,i="[object Symbol]",s=/[&<>"'`]/g,o=RegExp(s.source),r="object"==typeof t&&t&&t.Object===Object&&t,a="object"==typeof self&&self&&self.Object===Object&&self,c=r||a||Function("return this")();var l,u=(l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},function(e){return null==l?void 0:l[e]}),d=Object.prototype.toString,p=c.Symbol,h=p?p.prototype:void 0,f=h?h.toString:void 0;function g(e){if("string"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&d.call(e)==i}(e))return f?f.call(e):"";var t=e+"";return"0"==t&&1/e==-n?"-0":t}e.exports=function(e){var t;return(e=null==(t=e)?"":g(t))&&o.test(e)?e.replace(s,u):e}}).call(this,n(24))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);function s(e){var t=e.definition;return i.swc.Telemetry.createEventProps.conversation(e.id,e.backend,t&&t.TrafficProvider,t&&t.TrafficSource,t&&t.PlatformFeature)}t.createConversationEvent=s,t.createConversationEventFromId=function(e){try{var t=i.swc.services.conversations.getIfExist(e);if(t)return s(t)}catch(e){}return{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),s=n(70),o=n(0),r=n(15),a="/sdk/v1/",c="sdk",l="js",u=function(){function e(){}return e.startChat=function(e,t,n,s,r,a){var c={ConversationId:e||"",Style:t.Style,Title:t.Title,SetConversationTopic:t.SetConversationTopic,NewChatFlag:n,DisableAvatarClickAction:t.DisableAvatarClickAction};a&&(c.ExecuteCall=a),o.swc.services.signInManager.isTrusted?o.swc.Eventing.triggerEvent(i.ApiEvents.StartChat,c):o.swc.Eventing.triggerLocalEvent(i.ApiEvents.openChatLocal,c),o.swc.Telemetry.sendEvent.recentsAction(e?"openChat":"newChat",s)},e.startCall=function(t,n,i,o,r,a){var c={calleeId:t,withVideo:i,displayName:o,avatarUrl:r,isGroup:a};e.startChat(t,n,!1,s.OpenChatOrigin.RECENT,null,c)},e.joinGroupCall=function(t,n,i,o,r){var a={threadId:t,withVideo:i,displayName:o,avatarUrl:r,isGroup:!0,accept:!0};e.startChat(t,n,!1,s.OpenChatOrigin.RECENT,null,a)},e.closeAllOpenChats=function(){o.swc.Eventing.triggerEvent("closeAllChats")},e._getSDKUrl=function(){return r.UrlHelper.getCDNPath()+r.UrlHelper.getCompletePath(a+c,l)},e._callingPopup=null,e}();t.default=u},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),s=1048576;t.checkFile=function(e,t){if(!t)return{supportedFileSize:!0,supportedFileExtension:!0,supportedFileType:!0};var n=isNaN(t.size)||e.size/s<=t.size,i=e.name.split("."),o=function(e,t){return!t||!t.length||e&&t.indexOf(e)>-1};return{supportedFileSize:n,supportedFileExtension:o(i.length>1&&"."+i.pop(),t.extensions),supportedFileType:o(e.type,t.types)}},t.isDocumentTypeImage=function(e){return-1!==e.indexOf("image")},t.createImageMessage=function(e,t){var n=i.Configuration.AMS_HOST_URL+"objects/"+t,s=i.Configuration.AMS_HOST_URL+"objects/"+t+"/views/imgt1",o="https://login.skype.com/login/sso?go=webclient.xmm&amp;pic="+t,r=e.name;return['<URIObject type="Picture.1" uri="'+n+'" url_thumbnail="'+s+'">','To view this shared photo, go to: <a href="'+o+'">'+o+"</a>",'<OriginalName v="'+r+'"/><meta type="photo" originalName="'+r+'"/>',"</URIObject>"].join("")},t.createFileMessage=function(e,t){var n=i.Configuration.AMS_HOST_URL+"objects/"+t,s=i.Configuration.AMS_HOST_URL+"objects/"+t+"/views/thumbnail",o="https://login.skype.com/login/sso?go=webclient.xmm&amp;docid="+t,r=e.name;return['<URIObject type="File.1" uri="'+n+'" url_thumbnail="'+s+'">',"<Title>Title: "+r+"</Title>","<Description> Description: "+r+"</Description>",'<a href="'+o+'">'+o+"</a>",'<OriginalName v="'+r+'"/>','<FileSize v="'+e.size+'"/>',"</URIObject>"].join("")},t.getNameAndExtension=function(e){var t=(e||"").split("."),n="",i="";return t.length>1?(i=t.pop().toLowerCase(),n=t.join(".")):(i="",n=t[0]),{name:n,extension:i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.BUTTON_SEND_CLICK=1]="BUTTON_SEND_CLICK",e[e.KEYPRESS_ENTER=2]="KEYPRESS_ENTER",e[e.WELCOME_MESSAGE=3]="WELCOME_MESSAGE",e[e.TYPING=4]="TYPING",e[e.SUGGESTED_ACTION=5]="SUGGESTED_ACTION",e[e.BUTTON_SWIFT_CLICKED=6]="BUTTON_SWIFT_CLICKED",e[e.INVITE=7]="INVITE",e[e.ADDON=8]="ADDON"}(t.ActionTrigger||(t.ActionTrigger={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.read=0]="read"}(t.Permission||(t.Permission={})),function(e){e[e.Success=1]="Success",e[e.InProgress=2]="InProgress",e[e.ScanInProgress=3]="ScanInProgress",e[e.Failed=4]="Failed",e[e.Malware=5]="Malware"}(t.DocumentStatus||(t.DocumentStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(136),s=n(93),o=n(7),r=n(0),a=n(71),c="https://www.skype.com/",l="width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no, rel=noopener noreferrer",u=function(){function e(e,t,n){var u=this;switch(this.type=o.SwiftCardActionType.unknown,this.actions={},this.isValid=function(){return!!u.title||!!u.value||!!u.fallbackUri},this.isDisabled=function(){return!1},this.isSupported=function(){return null!==u.type&&u.type!==o.SwiftCardActionType.unknown},this.action=function(){return u.isValid()?u.actions[o.SwiftCardActionType[u.type]]().then(function(){}).catch(function(){}):Promise.resolve()},this.openUrl=function(){return u.value.match(/^skype:\?payments/)||u.value.match(/^skype:/),window.open(u.value,"_blank").opener=null,Promise.resolve()},this.imBack=function(){return u.conversation.sendSwift({title:u.title,value:u.value}).then(function(){return Promise.resolve()}).catch(function(){})},this.showImage=function(){var e=u.value||"";return u.conversation.sendMessage(e,s.ActionTrigger.SUGGESTED_ACTION),Promise.resolve()},this.postBack=function(){return u.conversation.sendSwift({title:u.title,value:u.value,image:u.image}),Promise.resolve()},this.payment=function(){var e=u.fallbackUri?u.fallbackUri:u.value;if(e){var t=window.open(e,"_blank",l);return t&&window.focus&&t.focus(),t.opener=null,Promise.resolve()}},this.convertToActionType=function(e){if(!e)return null;try{switch(e.toLowerCase()){case"unsupported":return o.SwiftCardActionType.unsupported;case"openurl":return o.SwiftCardActionType.openUrl;case"imback":return o.SwiftCardActionType.imBack;case"signin":return o.SwiftCardActionType.signin;case"call":return o.SwiftCardActionType.call;case"showimage":return o.SwiftCardActionType.showImage;case"payment":case"anypayment":return o.SwiftCardActionType.payment;case"postback":return o.SwiftCardActionType.postBack;default:return o.SwiftCardActionType.unknown}}catch(e){return o.SwiftCardActionType.unknown}},this.type=this.convertToActionType(e.type),this.isCallActionType=this.type===o.SwiftCardActionType.call,this.title=a.default.normalizeText(e.title),this.value=e.value?a.default.normalizeUrl(e.value):null,this.senderId=n,this.tooltip=this.title,this.image=e.image?e.image:null,this.fallbackUri=e.fallback&&e.fallback.uri?a.default.normalizeUrl(e.fallback.uri):null,this.actions[o.SwiftCardActionType[o.SwiftCardActionType.call]]=this.call,this.actions[o.SwiftCardActionType[o.SwiftCardActionType.imBack]]=this.imBack,this.actions[o.SwiftCardActionType[o.SwiftCardActionType.postBack]]=this.postBack,this.actions[o.SwiftCardActionType[o.SwiftCardActionType.openUrl]]=this.openUrl,this.actions[o.SwiftCardActionType[o.SwiftCardActionType.showImage]]=this.showImage,this.actions[o.SwiftCardActionType[o.SwiftCardActionType.signin]]=this.openUrl,this.actions[o.SwiftCardActionType[o.SwiftCardActionType.payment]]=this.payment,this.type){case o.SwiftCardActionType.call:this.value=a.default.normalizeDestination(this.value);break;case o.SwiftCardActionType.imBack:if(t.isGroup){var d=this.value,p=n.substring(3),h=function(){var e=new i.MentionDomEncoder,n=e.getMentionUserData(p,t);if(n){var s=e.createXmlElement(document,n).outerHTML;u.value=s+" "+d}};t.participants.filter(function(e){return e.person.id.toLowerCase()===p}).forEach(function(e){e.person.subscribe("displayName",h)}),h()}break;case o.SwiftCardActionType.showImage:this.value&&(this.value=a.default.normalizeUrl(e.value)),this.title||(this.title=r.swc.services.i18n.fetch("s_showImageTitle"));break;case o.SwiftCardActionType.payment:this.value&&(this.value.match(/^skype:\?payments/)?this.value=a.default.normalizeDestination(this.value):this.value=a.default.normalizeUrl(e.value));break;case o.SwiftCardActionType.openUrl:this.value&&(this.value.match(/^skype:/)?this.value=a.default.normalizeDestination(this.value):this.value=a.default.normalizeUrl(e.value),this.tooltip?this.tooltip+="\n\n"+this.value:this.tooltip=this.value);break;case o.SwiftCardActionType.signin:this.value=a.default.normalizeUrl(e.value),this.title||(this.title=r.swc.services.i18n.fetch("s_signInTitle"));break;case o.SwiftCardActionType.unsupported:this.type=o.SwiftCardActionType.openUrl,this.title||(this.title=r.swc.services.i18n.fetch("s_unsupported_button")),this.value||(this.value=c);break;case o.SwiftCardActionType.postBack:this.title=a.default.normalizeText(this.title),this.value=a.default.normalizeText(this.value),this.tooltip||(this.tooltip=this.title)}this.conversation=t}return e.prototype.call=function(){return Promise.reject("Calling is not supported")},e}();t.default=u},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["button:enabled:not([readonly])","select:enabled:not([readonly])","textarea:enabled:not([readonly])","input:enabled:not([readonly])","a[href]","area[href]","iframe","object","embed","[tabindex]","[contenteditable]","[autofocus]"].join(",");function s(e,t){return e.filter(function(e){return!t||e.tabIndex>=0})}t.setFocusLock=function(e){var t=function(t){var n=t.target,o=t.relatedTarget;if(!o||!e.contains(o)){var r,a,c,l=(r=e.querySelectorAll(i),a=Array.prototype.slice.call(r),(c=s(a,!0)).length||(c=s(a,!1)),c);if(l.length){var u=0===l.indexOf(n)?l[l.length-1]:l[0];setTimeout(function(){u.focus()})}}};return e.addEventListener("focusout",t),function(){e.removeEventListener("focusout",t)}}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this)||this}return s(t,e),t.create=function(){var e=Object.create(t.prototype);return e.callbacks=[],e},t.prototype.pushObservable=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.prototype.push.apply(this,t);var i=new r(t);return this.publish(i),this.length},t.prototype.popObservable=function(){var t=e.prototype.pop.call(this);return this.publish(),t},t.prototype.shiftObservable=function(){var t=e.prototype.shift.call(this);return this.publish(),t},t.prototype.unshiftObservable=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.prototype.unshift.apply(this,t);var i=new r(t);return this.publish(i),this.length},t.prototype.sortObservable=function(t){var n=e.prototype.sort.call(this,t);return this.publish(),n},t.prototype.spliceObservable=function(t,n){for(var i,s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];i=n?s?e.prototype.splice.apply(this,[t,n].concat(s)):e.prototype.splice.call(this,t,n):e.prototype.splice.call(this,t);var a=new r([],i);return this.publish(a),i},t.prototype.subscribe=function(e){this.callbacks.push(e)},t.prototype.unsubscribe=function(e){var t=this.callbacks.indexOf(e);t>-1&&this.callbacks.splice(t,1)},t.prototype.dispose=function(){var e=this;this.callbacks.forEach(function(t,n){e.callbacks[n]=null}),this.callbacks=[]},t.prototype.publish=function(e){var t=this;e||(e=new r),this.callbacks.forEach(function(n){n(t,e)})},t}(Array);t.ObservableCollection=o;var r=function(){return function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.newItems=e,this.oldItems=t}}()},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),c=n(16),l=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="emoticon",n._id=c.guid.generate(),n.state=o({isAnimated:!1,textOnly:!1},n._getNewState(t)),t.setUpdateCallback&&t.setUpdateCallback(function(e){n.setState(function(){return n._getNewState(e)})}),n}return s(t,e),t.prototype._getNewState=function(e){var t=a.swc.services.pesManager.emoticonMap,n=e.emoticonId||this.props.emoticonId,i=e.textContent||this.props.textContent,s=e.title||this.props.title;if(!n||!t.hasOwnProperty(n))return{textOnly:!0,textContent:i};var o={textOnly:!1,textContent:i,title:s,emoticonId:n};return!0===e.isAnimated?o.isAnimated=!0:!1===e.isAnimated&&(o.isAnimated=!1),o},t.prototype.componentDidMount=function(){var e=this;this.setState(function(t,n){return e._getNewState(n)})},t.prototype.componentWillReceiveProps=function(e){var t=this;this.setState(function(n,i){return t._getNewState(e)})},t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.large&&(t+=" "+this.props.largeEmoticonClass),t},t.prototype.render=function(){if(this.state.textOnly)return r.createElement("span",null,this.state.textContent);var e={"data-item-id":this.state.emoticonId,"data-is-animated":this.state.isAnimated,textContent:this.state.textContent,title:this.state.title};return this.props.large&&["emoticon"].push(this.props.largeEmoticonClass),r.createElement("span",{className:this.getComposedBlockClassName()},r.createElement("canvas",o({},e,{id:this._id}),this.state.textContent))},t}(n(6).SwcBaseComponent);t.SwcEmoticon=l},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Calling="calling",e.Messaging="chat",e.Recents="recents"}(t.ModuleType||(t.ModuleType={}))},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(5),r=n(2),a=n(83),c=n(15),l=function(){function e(){}return e.createMenuItem=function(e){return{title:e.title,group:e.itemLevel||1,action:e.action,selected:e.selected,className:e.className||"",innerElement:e.innerElement,disabled:e.disabled}},e.getFeedbackUri=function(){var e={p:r.Configuration.getPlatformId(),v:r.Configuration.ECS.version,lang:o.default.get.currentLocale||"",e:r.Configuration.getPlatformName()};return o.default.get.correlationId&&(e.tcg=o.default.get.correlationId),c.UrlHelper.setQueryParameters("https://go.skype.com/feedback.sor",e)},e.createMenuList=function(e,t,n){var o=document.createDocumentFragment(),r=s.createElement(a.SwcMenuList,{groups:e,className:t,size:n});return i.render(r,o),o},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(87),s=n(11),o=n(0),r=n(253),a=n(5),c=n(254),l=n(149),u=n(255),d=n(136),p=n(257),h=n(258),f={LARGE:"large",EXTRA_LARGE:"extraLarge"},g=3,v=function(e){var t;return(o.swc.services.pesManager.config?o.swc.services.pesManager.config.items:[]).forEach(function(n){t||n.id!==e||(t=n)}),t},m=function(){return function(e,t){var n=this;this.outgoingDomTransformers=[],this.incomingDomTransformers=[],this.encode=function(e,t,s){var o=new DOMParser,r=i(e),a=c.default.addFormatting(r),l=o.parseFromString(a,"text/html");if(0!==l.getElementsByTagName("parsererror").length)return r;try{return n.outgoingDomTransformers.forEach(function(e){try{e.transformRawToXml(l,l.body,t,s)}catch(e){}}),n.convertHtmlDomToXmlString(l)}catch(e){return r}},this.decode=function(e){var t,i,c,l=n;a.default.get.backend===s.MessagingBackend.TEAMS&&(e=r.TeamsMessageUtil.prepare(e));try{var u=n._private.parseXML(n._private.encapsulateInRootElement(e));if(u)return i=u.documentElement,o.swc.services.pesManager.canRenderConfigItems()&&function(e){var n=a.default.get.largeEmoticonClass?f.EXTRA_LARGE:f.LARGE,s=i.getElementsByTagName("ss"),o=[],r=s.length<=g&&s.length>0;if(r){var c=i.childNodes;for(a.default.get.isTeams()&&1===c.length&&"message"===c[0].tagName&&(c=c[0].childNodes),t=0;t<c.length;++t){var u=0===c[t].textContent.replace(" ","").replace(/<br\s*\/?>/g,"").replace(/\n/g,"").length;r=r&&("ss"===c[t].tagName||u)}}var d,p,h=s.length>20;for(t=0;t<s.length;++t){var v=l.emoticonEncoder.createHtmlElement(e,s[t].getAttribute("type"),s[t].textContent,r,h,n);v&&o.push([v,s[t]])}for(t=0;t<o.length;++t)d=o[t][0],(p=o[t][1]).parentNode&&p.parentNode.replaceChild(d,p)}(u),(c=i.getElementsByTagName("e_m"))&&0!==c.length&&c[0].parentNode.removeChild(c[0]),n.incomingDomTransformers.forEach(function(e){try{e.transformRawToXml(u,i)}catch(e){}}),l.emoticonEncoder.fixInvalidHtml(n._private.decapsulateFromRootElement(n._private.xmlToString(u)))}catch(e){}return e},this.convertHtmlDomToXmlString=function(e){for(var t=e.implementation.createDocument(e.body.namespaceURI,"message",null);0!==e.body.childNodes.length;)t.childNodes[0].appendChild(e.body.childNodes[0]);var i=t.childNodes[0].outerHTML;return a.default.get.backend===s.MessagingBackend.TEAMS&&(i=n._translateToTeamsEmoticons(i,e,t)),i.replace(/(?:^<message.*?>|<\/message>$)/g,"")},this._translateToTeamsEmoticons=function(e,t,n){var i=e.match(/<ss[^>]+>[^<]+<\/ss>/g);if(i){var s=i.length===n.firstChild.childNodes.length&&i.length<=g&&i.length>0,r=o.swc.services.pesManager.map;for(var a in i){var c=i[a],l=c.match(/<ss type="([^"]+)">([^<]+)<\/ss>/),u=l[1],d=r[l[2]];d.match(/^\(.*\)$/)||(d="("+d+")");var p=v(u),h=t.implementation.createDocument(t.body.namespaceURI,"emoticon",null),f=h.createElement("span"),m=s?50:20;f.setAttribute("class","animated-emoticon-"+m+"-"+u),f.setAttribute("title",u),f.setAttribute("type",d);var _=h.createElement("img");_.setAttribute("alt",p.description),_.setAttribute("itemid",u),_.setAttribute("itemscope",""),_.setAttribute("itemtype","http://schema.skype.com/Emoji"),_.setAttribute("src","https://statics.teams.microsoft.com/evergreen-assets/funstuff/skype-emoticons-f/"+u+"/default_"+m+".png"),_.setAttribute("style","width:"+m+"px;height:"+m+"px;"),f.appendChild(_),h.childNodes[0].appendChild(f);var y=h.childNodes[0].outerHTML.replace(/(?:^<emoticon.*?>|<\/emoticon>$)/g,"");e="<div><div>"+(e=e.replace(c,y))+"</div></div>"}}return e},this._private={separators:{"   ":!0,"\n":!0,"\r":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0,"　":!0},createFlagElement:function(e,t,n){var i=e.createElement("span");return i.textContent=n,i.setAttribute("class","flag "+t),i.textContent="(flag:"+t+")",i},encapsulateInRootElement:function(e){for(var t;t!==e;)t=e,e=e.replace(/<\s*?root[\s\S]*?>.*?(<\s*?\/\s*?root\s*?>)?/gi,"");return"<root>"+e+"</root>"},decapsulateFromRootElement:function(e){return e.match(/<root ?\/>/)?"":e.length==="</root>".length?"":e.substring("<root>".length,e.length-"</root>".length)},parseXML:function(e){var t;try{if(o.swcWindow.DOMParser){var n=new DOMParser;n.async=!1,t=n.parseFromString(e,"text/xml")}else{var i=new ActiveXObject("Microsoft.XMLDOM");if(i.async=!1,i.loadXML(e))return i}}catch(e){return null}var s=t.parseError;return s&&0!==s.errorCode?null:t.getElementsByTagName("parsererror").length>0?null:t},xmlToString:function(e){var t;try{t=(new XMLSerializer).serializeToString(e)}catch(n){t=e.xml}return t},xmlEscapeMap:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},escapeXml:function(e){var t=this.xmlEscapeMap;return e.replace(/[<>&"']/g,function(e){return t[e]})},unescapeXml:function(e){var t={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};return e.replace(/&lt;|&gt;|&amp;|&quot;|&apos/g,function(e){return t[e]})}},this.emoticonEncoder=new l.default,e?e.forEach(function(e){n.incomingDomTransformers.push(e)}):this.incomingDomTransformers=[new p.NewLineDomTransformer,new u.MentionDomDecoder],t?t.forEach(function(e){n.outgoingDomTransformers.push(e)}):this.outgoingDomTransformers=[new h.URLDomTransformer,new p.NewLineDomTransformer,new d.MentionDomEncoder,this.emoticonEncoder]}}();t.Encoder=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(0),o=function(){function e(){}return Object.defineProperty(e,"Marked",{get:function(){return s.swc.vendors.marked},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renderer",{get:function(){return this._renderer||(this._renderer=new e.Marked.Renderer),this._renderer},enumerable:!0,configurable:!0}),e.parse=function(t,n){return e.Marked.setOptions({renderer:this.renderer,gfm:!0,tables:!1,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1}),i.default.get.isTeams()&&(t=t.replace(/<br\/><br\/>/g,"<br/>").replace(/<br\s*\/?>\r\n/g,"  \n")),t=t.replace(/<br\s*\/?><br\s*\/?>/g,"\n\n").replace(/<br\s*\/?>/g,"  \n").replace(/<\/p>\n<p>/g,"\n\n"),t=(t=e.Marked(t).trim()).replace(/(^<p>)|(<\/p>$)/g,"").replace(/<\/p>\n<p>/g,"<br><br />")},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),s=n(7),o=n(0),r=n(9),a=n(137),c=n(95),l=n(71),u=function(){return function(e,t,n,u){var d=this;this.url=ko.observable(),this.destinationSize={narrow:{},default:{},carouselDefault:{},carouselNarrow:{}},this.trustedDomains=[i.Configuration.AMS_HOST_URL,i.Configuration.CDN_SERVICE_HOST],this.shouldProcessThroughAMS=function(e){return d._conversation.isSkypeBackend()&&!d.isTrustedUrl(e)},this.processImage=function(e){d.shouldProcessThroughAMS(e)?d.processViaAMS(e).then(function(e){var t=e.url||e.thumbnail,n=e.thumbnail_meta?e.thumbnail_meta:null;n?(d.url(t),d.naturalSize({height:n.height,width:n.width})):d.loadImageSize(l.default.normalizeUrl(t))},function(e){}):d.loadImageSize(d._conversation.isSkypeBackend()?l.default.normalizeUrl(e):e)},this.hasProcessedUrl=function(){return!!d.url()},this.isTrustedUrl=function(e){var t=!1;return d.trustedDomains.forEach(function(n){t=e.indexOf(n)>-1}),t},this.processViaAMS=function(e){var t=i.Configuration.URLP_SERVICE_URL+"/v1/url/info?url=",n=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),s=new RegExp(n,"g"),r=e.indexOf(t)>0?e.replace(s,""):e;return new Promise(function(e){return o.swc.services.amsManager.getPictureThumbnail(t+encodeURIComponent(r)).then(e)})},this.loadImageSize=function(e){var t=new Image;t.onload=function(){d.url(e),d.naturalSize({height:t.naturalHeight,width:t.naturalWidth})},t.onerror=function(e){r.default.throwError(10110,"Unable to load an image",e)},t.src=e},this.getUiSize=function(){var e=a.default.instance.CurrentStyle,t=d.getDestinationSize(d.contentType,e,d.isImageInCarousel()),n=d.naturalSize(),i={height:0,width:0};if(0===n.height||0===n.width||0===t.height)return i;var o=t.width/t.height,r=n.width/n.height;switch(d.contentType){case s.SwiftCardContentType.hero:r<o?(i.width=t.width,i.height=n.height*t.width/n.width,d.bottomAlignment((i.height-t.height)/2)):(i.height=t.height,i.width=n.width*t.height/n.height),d.leftAlignment(i.width/-2);break;case s.SwiftCardContentType.animation:case s.SwiftCardContentType.audio:r<o?(i.width=n.width*t.height/n.height,i.height=n.height*t.height/n.height):(i.height=t.height,i.width=n.width*t.height/n.height);break;case s.SwiftCardContentType.thumb:case s.SwiftCardContentType.actionImage:r<o?(i.height=t.height,i.width=i.height*r):r===o?(i.height=t.height,i.width=n.width*t.height/n.height):(i.width=t.width,i.height=i.width/r),d.bottomAlignment((i.height-t.height)/2),d.leftAlignment(i.width/-2);break;case s.SwiftCardContentType.receipt:r<o?(i.height=t.height,i.width=i.height*r):r===o?(i.height=t.height,i.width=n.width*t.height/n.height):(i.width=t.width,i.height=i.width/r,d.bottomAlignment((i.height-t.height)/2)),d.leftAlignment(i.width/-2);break;case s.SwiftCardContentType.flex:r<=o?(1===r?(i.height=t.height,i.width=t.height):(i.width=n.width*t.height/n.height,i.height=t.height),d.leftAlignment((i.width-t.width)/-2)):(i.height=t.height,i.width=n.width*t.height/n.height,d.leftAlignment((i.width-t.width)/-2))}return i},this.getTitleByType=function(){switch(d.tap.type){case s.SwiftCardActionType.call:case s.SwiftCardActionType.imBack:return d.createImageTitle();case s.SwiftCardActionType.openUrl:return d.createImageTitle()+"\n\n"+d.tap.value;case s.SwiftCardActionType.showImage:return(d.alt?d.alt+" ":"")+d.lowerFirstLetter(d.tap.title)}return""},this.createImageTitle=function(){var e=d.tap.title||"",t=o.swc.services.i18n.fetch("accessibility_swift_action_prefix",{swiftAction:d.lowerFirstLetter(e)});return(d.alt?d.alt+" ":"")+t},this.lowerFirstLetter=function(e){return e?e[0].toLowerCase()+e.substring(1):""},this.getDestinationSize=function(e,t,n){return(t===a.StyleModes.NORMAL?n?d.destinationSize.carouselDefault:d.destinationSize.default:n?d.destinationSize.carouselNarrow:d.destinationSize.narrow)[e]},this._conversation=t,this.destinationSize.narrow[s.SwiftCardContentType.hero]={height:105,width:188},this.destinationSize.default[s.SwiftCardContentType.hero]={height:153,width:272},this.destinationSize.carouselDefault[s.SwiftCardContentType.hero]={height:145,width:270},this.destinationSize.carouselNarrow[s.SwiftCardContentType.hero]={height:105,width:188},this.destinationSize.narrow[s.SwiftCardContentType.thumb]={height:76,width:76},this.destinationSize.default[s.SwiftCardContentType.thumb]={height:112,width:112},this.destinationSize.carouselDefault[s.SwiftCardContentType.thumb]={height:112,width:112},this.destinationSize.carouselNarrow[s.SwiftCardContentType.thumb]={height:76,width:76},this.destinationSize.narrow[s.SwiftCardContentType.receipt]={height:76,width:76},this.destinationSize.default[s.SwiftCardContentType.receipt]={height:112,width:112},this.destinationSize.narrow[s.SwiftCardContentType.animation]={height:105,width:172},this.destinationSize.default[s.SwiftCardContentType.animation]={height:153,width:256},this.destinationSize.carouselDefault[s.SwiftCardContentType.animation]={height:145,width:256},this.destinationSize.carouselNarrow[s.SwiftCardContentType.animation]={height:105,width:172},this.destinationSize.narrow[s.SwiftCardContentType.audio]={height:105,width:172},this.destinationSize.default[s.SwiftCardContentType.audio]={height:145,width:256},this.destinationSize.carouselDefault[s.SwiftCardContentType.audio]={height:145,width:256},this.destinationSize.carouselNarrow[s.SwiftCardContentType.audio]={height:105,width:172},this.destinationSize.default[s.SwiftCardContentType.actionImage]={height:20,width:20},this.destinationSize.narrow[s.SwiftCardContentType.actionImage]={height:16,width:16},this.destinationSize.narrow[s.SwiftCardContentType.flex]={height:105,width:188},this.destinationSize.default[s.SwiftCardContentType.flex]={height:153,width:272},this.destinationSize.carouselDefault[s.SwiftCardContentType.flex]={height:145,width:256},this.destinationSize.carouselNarrow[s.SwiftCardContentType.flex]={height:105,width:188},this.contentType=u,this.alt=l.default.normalizeRichText(e.alt),e.url&&this.processImage(e.url),this.tap=null,e.tap&&(this.tap=l.default.getItemIfNotDisabled(new c.default(e.tap,t,n)),this.tap&&this.tap.type===s.SwiftCardActionType.showImage&&!this.tap.value&&(this.tap.value=this.url())),this.naturalSize=ko.observable({height:0,width:0}),this.uiSize=ko.pureComputed(this.getUiSize.bind(this)),this.isValid=ko.pureComputed(this.hasProcessedUrl),this.bottomAlignment=ko.observable(),this.leftAlignment=ko.observable(),this.isImageInCarousel=ko.observable(!1)}}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s,o=n(5),r=n(45);!function(e){e.Mobile="Mobile",e.Desktop="Desktop",e.Web="Web"}(t.DeviceType||(t.DeviceType={})),function(e){e.Available="Available",e.AvailableIdle="AvailableIdle",e.Busy="Busy",e.BusyIdle="BusyIdle",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Away="Away",e.Offline="Offline",e.PresenceUnknown="PresenceUnknown"}(i=t.Availability||(t.Availability={})),function(e){e.Available="Available",e.Inactive="Inactive",e.Busy="Busy",e.InMeeting="InAMeeting",e.InCall="InACall",e.InConferenceCall="InAConferenceCall",e.UrgentInterruptionOnly="UrgentInterruptionOnly",e.DoNotDisturb="DoNotDisturb",e.Presenting="Presenting",e.BeRightBack="BeRightBack",e.Away="Away",e.Offwork="Offwork",e.OutOfOffice="OutOfOffice",e.Offline="Offline",e.PresenceUnknown="PresenceUnknown"}(s=t.Activity||(t.Activity={}));var a={};a[i.Available]=[s.Available],a[i.Busy]=[s.Busy],a[i.DoNotDisturb]=[s.DoNotDisturb],a[i.BeRightBack]=[s.BeRightBack],a[i.Away]=[s.Away,s.Offline],t.allowedForcedAvailabilities=[i.Available,i.Busy,i.DoNotDisturb,i.BeRightBack,i.Away],t.isForcedAvailabilityAllowed=function(e){return 1===t.allowedForcedAvailabilities.filter(function(t){return t===e}).length},t.isActivityCombinationAllowed=function(e,t){return!(!a[t]||1!==a[e].filter(function(e){return e===t}).length)},t.getAvailabilityFromStatus=function(e){if(o.default.get.isTeams())switch(e){case r.PresenceStatus.Online:return i.Available;case r.PresenceStatus.Busy:return i.Busy;case r.PresenceStatus.BeRightBack:return i.BeRightBack;case r.PresenceStatus.Away:return i.Away;case r.PresenceStatus.DoNotDisturb:return i.DoNotDisturb;default:return}else switch(e){case r.PresenceStatus.Online:return i.Available;case r.PresenceStatus.Away:return i.Away;case r.PresenceStatus.Busy:return i.Busy;default:return}},t.getStatusFromAvailability=function(e){if(o.default.get.isTeams())switch(e){case i.Available:case i.AvailableIdle:return r.PresenceStatus.Online;case i.Away:return r.PresenceStatus.Away;case i.BeRightBack:return r.PresenceStatus.BeRightBack;case i.DoNotDisturb:return r.PresenceStatus.DoNotDisturb;case i.Busy:case i.BusyIdle:return r.PresenceStatus.Busy;default:return r.PresenceStatus.Offline}else switch(e){case i.Available:case i.AvailableIdle:return r.PresenceStatus.Online;case i.Away:return r.PresenceStatus.Away;case i.BeRightBack:return r.PresenceStatus.BeRightBack;case i.DoNotDisturb:return r.PresenceStatus.DoNotDisturb;case i.Busy:case i.BusyIdle:return r.PresenceStatus.Busy;default:return r.PresenceStatus.Offline}}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.reportUserActivityStart=function(){i.swc.services.signInManager.onceSignedIn().then(function(){return i.swc.Telemetry.sendEvent.userActivityStart()})}},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.findRecentConversationIdForMembers=function(e){return new Promise(function(t,n){return function(e,t,n){i.swc.services.webApi.fetchRecentConversations().then(function(i){var s;i.conversations.sort(function(e,t){return e.id.localeCompare(t.id)}).some(function(t){var n=2===e.length&&t.isOneOnOne,i=e.length>2&&!t.isOneOnOne;if(t.members&&t.members.length===e.length&&(n||i)){var o=!0;if(e.forEach(function(e){var n;o=o&&(n=e.id,1===t.members.filter(function(e){return e.id===n}).length)}),o)return s=t.id,!0}return!1}),s?t(s):n()})}(e,t,n)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);!function(e){e.OpenChat="openChat",e.Cancel="cancel"}(t.ActionType||(t.ActionType={})),t.sendSearchActionEvent=function(e,t,n){void 0===n&&(n=0);var s={name:"kpi_search_action",properties:{actionType:{value:e},openItemType:{value:t},total:{value:n||0}}};i.swc.Telemetry.getLogger().logEvent(s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=function(){function e(){}return e.add=function(t,n,o){if(t&&n){var r=e.build(t.ownerDocument),a=r.container,c={dialogContent:n},l=s.createElement(o,c);i.render(l,a),t.insertBefore(r.container,t.firstChild)}},e.remove=function(){if(e.instance&&e.instance.container){var t=e.instance.container.parentElement;t&&t.removeChild(e.instance.container),i.render(null,e.instance.container)}},e.build=function(t){if(!e.instance){var n=t.createElement("div");e.instance={container:n}}return i.render(null,e.instance.container),e.instance},e}();t.ConfirmationDialog=o},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(84),r=/(\(|\))/g,a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.isElementAllowed=function(e){return"i"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("mention")},t.prototype.wordRawToXml=function(e,t,n,i){for(var s,o=[],r=/[\.,_:\-;?]$/,a=t.substring(1),c=this.getMentionUserData(a,n,i);!c&&a.match(r);)s=a.charAt(a.length-1),a=a.substring(0,a.length-1),c=this.getMentionUserData(a,n,i);return c&&(o.push(this.createXmlElement(e,c)),s&&o.push(e.createTextNode(s))),o},t.prototype.getMentionUserData=function(e,t,n){var i,s={defaultDisplayName:"",displayName:"",skypeId:"",type:"",isMePerson:!1};if(!e)return null;var o=0===(e=e.toLowerCase()).indexOf("("),a=o?e.substring(1,e.length-1):"",c=t?t.participants:[];if(s.isMePerson=!!n&&(e===n.id.toLowerCase()||o&&n.displayName.replace(r,"").toLowerCase()===a),s.isMePerson)i=n;else{var l=c.filter(function(t){return t.person.id.toLowerCase()===e||o&&t.person.displayName.replace(r,"").toLowerCase()===a});l.length&&(i=l[0].person)}return i?(s.skypeId=i.id,s.type="28",s.displayName=i.displayName,s.defaultDisplayName||(s.defaultDisplayName=s.displayName),s):null},t.prototype.wordMatcher=function(){return/@([a-z0-9\.,\-_:]+|\(.+?\))/gi},t.prototype.createXmlElement=function(e,t){var n=e.createElement("at");return n.setAttribute("id",t.type+":"+t.skypeId),n.innerText=t.defaultDisplayName,n},t}(o.WordDomTransformer);t.MentionDomEncoder=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(65),o=n(21),r=function(){function e(){var e=this;this.handlers=[],this.dispose=function(){o.default.getWindow().removeEventListener("resize",e.windowResizeHandler)},this.getCurrentStyle=function(){return(e.forcedWidth||o.default.getWindow().innerWidth)<356?i.NARROW:i.NORMAL},this.onResize=function(){e._currentStyle=e.getCurrentStyle();for(var t=0,n=e.handlers;t<n.length;t++){var i=n[t];try{i()}catch(e){}}};this.windowResizeHandler=s(this.onResize,500),o.default.getWindow().addEventListener("resize",this.windowResizeHandler)}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentStyle",{get:function(){return this._currentStyle},enumerable:!0,configurable:!0}),e.prototype.forceWidth=function(e){this.forcedWidth=e,this._currentStyle=this.getCurrentStyle()},e.prototype.addResizeHandler=function(e){-1===this.handlers.indexOf(e)&&this.handlers.push(e)},e.prototype.removeResizeHandler=function(e){var t=this.handlers.indexOf(e);-1!==t&&this.handlers.splice(t,1)},e}();t.default=r,function(e){e[e.NARROW=0]="NARROW",e[e.NORMAL=1]="NORMAL"}(i=t.StyleModes||(t.StyleModes={}))},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),o={isEnabled:!0,pollingInterval:240};t.getConfig=function(){return i({},o,s.Configuration.ECS.presence)}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.NONE="none",e.UIONLY="uionly",e.FULL="full",e.HIDDEN="hidden",e}();t.PreloadType=i},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(15),o=function(){function e(){}return e.isDomainIn=function(e){var t=window.swc.EcsConfig[e];if(!t)return!1;var n=this.getHost();return Array.isArray(t)?t.some(function(e){return e.toLowerCase()===n.toLowerCase()}):"true"===t.toLowerCase},e.getHost=function(){return i.default.get.host?i.default.get.host:s.UrlHelper.getHost()},e}();t.default=o},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.getContentElement=function(){return o.createElement("p",null,this.props.dialogContent.text)},t}(n(148).Dialog);t.TextDialog=r},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(99),c=n(20),l=n(12),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._setButtonRef=function(e){t._buttonElement=e},t._onFadeElementChange=function(e){return t._fadeElement=e},t._onConfirmClick=function(e){t.confirmAction()},t._onCancelClick=function(e){t.props.dialogContent.cancel.action()},t._onFadeClick=function(e){e.target===t._fadeElement&&t._onCancelClick(e)},t._onKeyDown=function(e){c.default.getKeyCode(e)===l.default.ESCAPE&&t._onCancelClick(e)},t._onModalElementChange=function(e){t._modalElement!==e&&(t._removeFocusLock&&(t._removeFocusLock(),t._removeFocusLock=null),t._modalElement=e,t._modalElement&&(t._removeFocusLock=a.setFocusLock(t._modalElement)))},t}return s(t,e),t.prototype.confirmAction=function(){this.props.dialogContent.confirm.action()},t.prototype.componentDidMount=function(){var e=this;setTimeout(function(){e._buttonElement&&e._buttonElement.focus()},0)},t.prototype.render=function(){var e=this.props.dialogContent.cancel.title,t=this.props.dialogContent.confirm.title,n=this.props.dialogContent.title;return r.createElement("div",{className:"swcDialog__backdrop",ref:this._onFadeElementChange,onClick:this._onFadeClick,onKeyDown:this._onKeyDown},r.createElement("div",{className:"swcDialog",role:"dialog",ref:this._onModalElementChange},r.createElement("div",{className:"swcDialog__content"},r.createElement("h1",null,n),this.getContentElement()),r.createElement("div",{className:"swcDialog__buttons"},r.createElement("button",{className:"swcDialog__action swcDialog__action_confirm",ref:this._setButtonRef,title:t,onClick:this._onConfirmClick},t),r.createElement("button",{className:"swcDialog__action swcDialog__action_cancel",title:e,onClick:this._onCancelClick},e))))},t}(o.Component);t.Dialog=u},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(0),c=n(101),l=n(84),u=/^\w$/,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.hasLargeEmoticon=function(e){return/<span(\sxmlns=".*")? class="emoticon\s?\w*\s?(animated)?\s+\w*large"><canvas(\s?(data-[-a-z]*|height|width|id|textcontent)=".*")*?>.*<\/canvas><\/span>/i.test(e)},t.prototype.fixInvalidHtml=function(e){return e.replace(/<canvas((?:\s?(?:data-[-a-z]*|height|width)="[a-z0-9]*")*)\s*\/>/g,"<canvas$1></canvas>")},t.prototype.createHtmlElement=function(e,t,n,i,s,a){var l={large:i,largeEmoticonClass:a,textContent:n,emoticonId:t,isAnimated:!s},u=r.createElement(c.SwcEmoticon,l),d=document.createDocumentFragment();return o.render(u,d),d},t.prototype.isElementAllowed=function(e){return"span"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("emoticon")},t.prototype.encodeTextNodeToXml=function(t,n,i,s){n.parentNode&&"a"!==n.parentNode.nodeName.toLowerCase()&&e.prototype.encodeTextNodeToXml.call(this,t,n,i,s)},t.prototype.wordRawToXml=function(e,t,n){var i=[],s=0,o=a.swc.services.pesManager.map;if(!a.swc.services.pesManager.canRenderConfigItems()||n&&n.isSfB)return i;for(var r=0;r<t.length;r++){for(var c="",l=-1,u=r+1;u<t.length+1;u++){var d=t.substring(r,u),p=o.hasOwnProperty(d)&&o[d];p&&!this.isWordChar(t[u])&&(c=p,l=u)}c&&(s!==r&&i.push(e.createTextNode(t.substring(s,r))),s=l,i.push(this.createXmlElement(e,c,t.substring(r,l))),r=l-1)}return 0!==s&&s<t.length&&i.push(e.createTextNode(t.substring(s))),i},t.prototype.createXmlElement=function(e,t,n){var i=e.createElement("ss");return i.setAttribute("type",t),i.innerText=n,i},t.prototype.isWordChar=function(e){return u.test(e)},t}(l.WordDomTransformer);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.implode=function(e){return e.join(",")},e.explode=function(e){return e?e.replace(/\s/g,"").split(","):[]},e.find=function(t,n){return e.explode(t).indexOf(n)>-1},e.add=function(t,n,i){if(!i||!e.find(t,n)){var s=e.explode(t);s.push(n),t=e.implode(s)}return t},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s,o=n(4),r=n(0),a=n(20),c=n(12);function l(){r.swc.Eventing.triggerLocalEvent(o.ApiEvents.hideBubbleWindow)}!function(e){e.Info="info",e.List="list",e.ReactionPreview="reactionPreview",e.ReactionPane="reactionPane"}(i=t.BubbleType||(t.BubbleType={})),function(e){e.nextToElement="nextToElement",e.onContextMenu="onContextMenu"}(s=t.BubblePosition||(t.BubblePosition={}));var u=function(){function e(){}return e.add=function(t,n,a,c,u){void 0===u&&(u=s.nextToElement);for(var d=e.build(),p=c===i.Info,h=d.content;h.firstChild;)h.removeChild(h.firstChild);if(h.appendChild(a),d.container.className="swc-bubble "+c,d.arrow.style.display=p?"block":"none",u===s.nextToElement){var f,g=t.getBoundingClientRect(),v=n.getBoundingClientRect(),m=g.top-v.top,_=v.bottom-g.bottom,y=g.left-v.left,w=v.right-g.right,b=p?10:0,C=void 0,E=g.width/2;if(y<w)d.container.style.right="",(f=(C=g.left-v.left+E)-90)<0?(d.container.style.left=C-90-f+E+"px",d.arrow.style.left=90-E+f-8+"px"):(d.container.style.left=C-90+E+"px",d.arrow.style.left="82px");else d.container.style.left="",(f=(C=v.right-g.right+E)-90)<0?(d.container.style.right=C-90+E-f+"px",d.arrow.style.left=90+E-f-8+"px"):(d.container.style.right=C-90+E+"px",d.arrow.style.left="82px");m>_?(d.container.style.top="",d.container.style.bottom=v.bottom-g.top+b+"px",d.arrow.style.top="",d.arrow.style.bottom="-10px",d.arrow.style.borderBottom="",d.arrow.style.borderTop="10px solid #d8d8d8",d.arrowInner.style.bottom="2px",d.arrowInner.style.borderBottom="",d.arrowInner.style.borderTop="9px solid #fdc856"):(d.container.style.bottom="",d.container.style.top=g.bottom-v.top+b+"px",d.arrow.style.bottom="",d.arrow.style.top="-10px",d.arrow.style.borderTop="",d.arrow.style.borderBottom="10px solid #d8d8d8",d.arrow.style.top="-10px",d.arrowInner.style.top="2px",d.arrowInner.style.borderTop="",d.arrowInner.style.borderBottom="9px solid #fdc856"),n.appendChild(d.container)}else{var S=t,I=S.target,T={x:S.clientX,y:S.clientY},P=n.getBoundingClientRect(),x=n.parentElement?n.parentElement.getBoundingClientRect():null;if(!t||!I)return;var k=T.y-x.top,A=x.bottom-T.y,O=T.x-P.left,M=P.right-T.x;d.container.style.display="none",n.appendChild(d.container),setTimeout(function(){d.container.style.display="";var e=d.container.offsetWidth,t=d.container.offsetHeight,n=M>e?O:O-e,i=A>t?k+x.top-P.top:k+x.top-P.top-t;d.container.style.left=n+"px",d.container.style.right="",d.container.style.top=i+"px",d.container.style.bottom=""},0)}c!==i.List&&c!==i.ReactionPane||setTimeout(function(){var t=d.content.querySelector("[tabindex]");t&&(e._previouslyFocusedElement=document.activeElement,t.focus())}),d.container.addEventListener("focusout",e._onFocusOut),d.container.addEventListener("keydown",e._onKeyDown),n.addEventListener("click",l),r.swc.Eventing.registerEvent(o.ApiEvents.hideBubbleWindow,e.remove)},e.remove=function(){if(e._scheduleFocusReturn(),e.instance&&e.instance.container){var t=e.instance.container.parentElement;t&&(t.removeEventListener("click",l),e.instance.container.removeEventListener("focusout",e._onFocusOut),e.instance.container.removeEventListener("keydown",e._onKeyDown),r.swc.Eventing.unregisterEvent(o.ApiEvents.hideBubbleWindow,e.remove),t.removeChild(e.instance.container))}},e._scheduleFocusReturn=function(){var t=e._previouslyFocusedElement;e._previouslyFocusedElement=null,setTimeout(function(){t&&document.contains(t)&&document.activeElement!==t&&t.focus()})},e.build=function(){if(!e.instance){var t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div");n.className="swc-content",i.className="swc-arrow",s.className="swc-arrow-inner",i.appendChild(s),t.appendChild(i),t.appendChild(n),e.instance={container:t,content:n,arrow:i,arrowInner:s}}return e.instance},e._onFocusOut=function(t){setTimeout(function(){e.instance&&e.instance.container&&(e.instance.container.contains(e.instance.container.ownerDocument.activeElement)||l())},0)},e._onKeyDown=function(e){e.stopPropagation(),a.default.getKeyCode(e)===c.default.ESCAPE&&l()},e}();t.default=u},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(113)),i(n(138))},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r=n(10),a=n(100),c=n(7),l=function(e){function t(t,n){var i=e.call(this)||this;return i.customType=c.CustomMessageType.Custom,i.supportedAnnotations=[],i.type=c.MessageType.UserMessage,i._isDeleted=!1,i._isEdited=!1,i.timestamp=new Date,i.originalTimestamp=i.timestamp,i._payload=n,i._status=c.DeliveryStatus.Pending,i.suggestedActions=a.ObservableCollection.create(),t&&(i.type=c.MessageType.SystemMessage),i.supportedAnnotations.push(o.Configuration.MESSAGE_PROPERTIES.PER_USER.EMOTIONS),i.emotions=a.ObservableCollection.create(),i._files=a.ObservableCollection.create(),i}return s(t,e),Object.defineProperty(t.prototype,"files",{get:function(){return this._files},set:function(e){this._files=e,this.publish("files",e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientMessageId",{get:function(){return this._clientMessageId},set:function(e){this._clientMessageId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"composeTime",{get:function(){return this._composeTime},set:function(e){e!==this._composeTime&&(this._composeTime=e,this.publish("composeTime",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"content",{get:function(){return this._content},set:function(e){e.indexOf("customDebug"),e!==this._content&&(this._content=e,this.publish("content",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){e!==this._direction&&(this._direction=e,this.publish("direction",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){e!==this._id&&(this._id=e,this.publish("id",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageContent",{get:function(){return this._imageContent},set:function(e){e!==this._imageContent&&(this._imageContent=e,this.publish("imageContent",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(e){e!==this._isDeleted&&(this._isDeleted=e,this.publish("isDeleted",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEdited",{get:function(){return this._isEdited},set:function(e){e!==this._isEdited&&(this._isEdited=e,this.publish("isEdited",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFirst",{get:function(){return this._isFirst},set:function(e){e!==this._isFirst&&(this._isFirst=e,this.publish("isFirst",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTranslated",{get:function(){return this._isTranslated},set:function(e){e!==this._isTranslated&&(this._isTranslated=e,this.publish("isTranslated",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(e){e!==this._key&&(this._key=e,this.publish("key",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalTimestamp",{get:function(){return this._originalTimestamp},set:function(e){e!==this._originalTimestamp&&(this._originalTimestamp=e,this.publish("originalTimestamp",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return this._payload},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processedContent",{get:function(){return this._processedContent},set:function(e){e!==this._processedContent&&(this._processedContent=e,this.publish("processedContent",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawMessageType",{get:function(){return this._rawMessageType},set:function(e){this._rawMessageType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sender",{get:function(){return this._sender},set:function(e){e!==this._sender&&(this._sender=e,this.publish("sender",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"senderId",{get:function(){return this._senderId},set:function(e){e!==this._senderId&&(this._senderId=e,this.publish("senderId",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skypeEditedId",{get:function(){return this._skypeEditedId},set:function(e){e!==this._skypeEditedId&&(this._skypeEditedId=e,this.publish("skypeEditedId",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},set:function(e){e!==this._status&&(this._status=e,this.publish("status",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timestamp",{get:function(){return this._timestamp},set:function(e){e!==this._timestamp&&(this._timestamp=e,this.publish("timestamp",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"translation",{get:function(){return this._content},set:function(e){e!==this._translation&&(this._translation=e,this.publish("translation",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},set:function(e){e!==this._version&&(this._version=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imdisplayname",{get:function(){return this._imdisplayname},set:function(e){e!==this._imdisplayname&&(this._imdisplayname=e)},enumerable:!0,configurable:!0}),t.prototype.getKey=function(){return this._key||this._skypeEditedId||this._clientMessageId||this._id||"0"},t}(r.default);t.default=l},,,,,,,,,,,,,function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,r=n(4),a=n(0),c=n(27),l=r.ApiEvents.conversationProxy;!function(e){e.Bridged="bridged",e.Unbridged="unbridged"}(t.DeliveryMode||(t.DeliveryMode={})),function(e){e[e.CONFIRMED=0]="CONFIRMED",e[e.CANCELED=1]="CANCELED"}(o=t.DialogResult||(t.DialogResult={}));var u=function(e){function t(t){var n=e.call(this,t)||this;return n.isInputDisabled=!1,n.dialogs={},n.actions={},n}return s(t,e),t.prototype.init=function(){this.conversationId=this.data.conversationId},t.prototype.sendMessageToBot=function(e){var t=this.createCID(),n={botId:this.conversationId,content:e,botMessageId:t},i=new Promise(function(e,n){var i=function(s){t===s.botMessageId&&(a.swc.Eventing.unregisterEvent(r.ApiEvents.invoke.sendMessageToBotResponse,i),s.success?e():n())};a.swc.Eventing.registerEvent(r.ApiEvents.invoke.sendMessageToBotResponse,i)});return this.exec(r.ApiEvents.invoke.sendMessageToBot,n),i},t.prototype.openEmoticonPicker=function(){this.isInputDisabled||this.exec(l.toggleEmoticonPicker,{id:this.conversationId,open:!0})},t.prototype.closeEmoticonPicker=function(){this.exec(l.toggleEmoticonPicker,{id:this.conversationId,open:!1})},t.prototype.openFilePicker=function(){this.exec(l.openFilePicker,this.conversationId)},t.prototype.setInputPlaceholder=function(e){this.exec(l.setInputPlaceholder,{id:this.conversationId,text:e})},t.prototype.setInputText=function(e){this.exec(l.setInputText,{id:this.conversationId,text:e})},t.prototype.setMessageProperties=function(e){var t={deliveryMode:e?e.deliveryMode:"",tags:e?e.tags:""};this.exec(l.setMessageProperties,{id:this.conversationId,props:t})},t.prototype.connect=function(){this.exec(l.connected,{id:this.conversationId,connected:!0})},t.prototype.disconnect=function(){this.exec(l.connected,{id:this.conversationId,connected:!1})},t.prototype.setActionBar=function(e){for(var t=this,n=[],i=0,s=e;i<s.length;i++){var o=s[i],r=this.createCID();this.actions[r]=o.handler,n.push({CID:r,name:o.name,className:o.className,title:o,text:o.text})}this.exec(l.setActionBar,{id:this.conversationId,definition:n}),this.reg(l.resActionBar,function(e){t.actions[e]&&t.actions[e]()})},t.prototype.showConfirmationDialog=function(e){var t=this,n=this.createCID();this.dialogs[n]=e;this.reg(l.resShowConfirmationDialog,function(e){t.resolveDialog(e.CID,e.res)}),this.exec(l.showConfirmationDialog,{id:this.conversationId,dialog:{CID:n,title:e.title,description:e.description,confirmationButtonTitle:e.confirmationButtonTitle,cancelButtonTitle:e.cancelButtonTitle}})},t.prototype.disableInput=function(){this.isInputDisabled=!0,this.exec(l.disableInput,{id:this.conversationId,disable:!0})},t.prototype.enableInput=function(){this.isInputDisabled=!1,this.exec(l.disableInput,{id:this.conversationId,disable:!1})},t.prototype.expand=function(){this.exec(l.expand,{id:this.conversationId})},t.prototype.focusInput=function(){this.exec(l.focusInput,{id:this.conversationId})},t.prototype.onUnreadCount=function(e){var t=this;this.exec(l.regUnreadCount,{id:this.conversationId,refId:this.refId}),this.reg(l.unreadCount,function(n){n.refId===t.refId&&e(n.count)})},t.prototype.onAvatar=function(e){var t=this;this.reg(l.resAvatar,function(n){n.refId===t.refId&&e(n.avatarUrl)}),this.exec(l.regAvatar,{id:this.conversationId,refId:this.refId})},t.prototype.onTitle=function(e){var t=this;this.reg(l.resTitle,function(n){n.refId===t.refId&&e(n.title)}),this.exec(l.regTitle,{id:this.conversationId,refId:this.refId})},t.prototype.onPresenceStatus=function(e){var t=this;this.reg(l.resPresenceStatus,function(n){n.refId===t.refId&&e(n.presenceStatus)}),this.exec(l.regPresenceStatus,{id:this.conversationId,refId:this.refId})},t.prototype.onCollapse=function(e,t){var n=this;this.exec(l.regCollapse,{id:this.conversationId,refId:this.refId,preventDefault:t}),this.reg(l.resCollapse,function(t){t.refId===n.refId&&e(t.isCollapsed)})},t.prototype.onMessageReceived=function(e){var t=this;this.exec(l.regMessageReceived,{id:this.conversationId,refId:this.refId}),this.reg(l.messageReceived,function(n){n.refId===t.refId&&e(n.message)})},t.prototype.onIsTyping=function(e){var t=this;this.exec(l.regIsTyping,{id:this.conversationId,refId:this.refId}),this.reg(l.resIsTyping,function(n){n.refId===t.refId&&e(n.isTyping)})},t.prototype.onFileDownload=function(e){var t=this;this.exec(l.regDownload,{id:this.conversationId,refId:this.refId}),this.reg(l.resDownload,function(n){n.refId===t.refId&&e(n.url)})},t.prototype.onClose=function(e,t){var n=this;this.exec(l.regClose,{refId:this.refId,preventDefault:t}),this.reg(l.resClose,function(t){t.refId===n.refId&&e()})},t.prototype.resolveDialog=function(e,t){var n=this.dialogs[e];n&&(t===o.CONFIRMED?n.onConfirm():n.onCancel(),delete this.dialogs[e])},t}(c.Proxy);t.ConversationProxy=u},,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),s=n(5),o=n(25),r=n(7),a=n(0),c=n(9),l=n(31),u=function(){function e(t){var n=this;this._element=t,this.init=function(e){void 0===e&&(e=!0),e&&(a.swc.services.signInManager.unsubscribe("isSignedIn",n.init),a.swc.services.mePersonManager.fetch().then(function(e){return a.swc.Calling.init(n._element,e.id,null,null,{onCallStatusChange:n._onCallStatusChange,onRegistryUpdate:n._onRegistryUpdate},s.default,null,null,s.default.get.selectedDevices||null)}).then(function(){var e;s.default.get.callingReady=!0,e=!s.default.get.standaloneCalling||!a.swc.CallingControl||{threadId:a.swc.CallingControl.threadId},a.swc.Eventing.triggerEvent(i.ApiEvents.CallingReady,e,!0),a.swc.Eventing.registerEvent(i.ApiEvents.StartCall,n._startCall),a.swc.Eventing.registerEvent(i.ApiEvents.AcceptCall,n._acceptCall),a.swc.Eventing.registerEvent(i.ApiEvents.RejectCall,n._rejectCall),a.swc.Eventing.registerEvent(i.ApiEvents.UpdateCallingScreen,n._showCalling),a.swc.Eventing.registerEvent(i.ApiEvents.OnCallEnd,n._hideCalling),a.swc.Eventing.registerEvent(i.ApiEvents.CallingLayoutChanged,n._onCallingLayoutChange),n._ready=!0}).catch(function(e){a.swc.Eventing.triggerEvent(i.ApiEvents.CallingReady,!1,!0)}))},this._onCallStatusChange=function(e){n._callState=e},this._onRegistryUpdate=function(e){return n._disableTransition()},this._disableTransition=function(){n._element.parentElement&&n._element.parentElement.classList.add("no-transition")},this._onCallingLayoutChange=function(t){if(n._activeCallMri&&t.mri===n._activeCallMri){var i=e._getChat();i&&i.getConversationTuple(n._activeCallMri).then(function(n){e._toggleActiveCallClass(n,"maximize"===t.action||"undock"===t.action)})}},this._hideCalling=function(){var t=e._getChat();t&&n._activeCallMri&&t.getConversationTuple(n._activeCallMri).then(function(t){t.alwaysOnStage=!1,t.container.removeChild(n._element),e._toggleActiveCallClass(t,!1)}).catch(function(e){c.default.throwError(10902,"Unable to hide calling screen - no such conversation",e,n._activeCallMri)})},this._showCalling=function(t){n._activeCallMri=t.mri;var i=e._getChat();i&&i.getConversationTuple(t.mri).then(function(i){i.alwaysOnStage=!0,i.container.contains(n._element)||i.container.appendChild(n._element),e._toggleActiveCallClass(i,t.fullyCover),n._disableTransition()}).catch(function(e){c.default.throwError(10901,"Unable to update calling screen - no such conversation",e,t.mri)})},this._startCall=function(e){if(n._ready){n._showCalling({mri:e.calleeId,fullyCover:!1});var t=function(){a.swc.Calling.startCall(e.calleeId,e.withVideo,{avatarURI:e.avatarUrl,displayName:e.displayName},e.isGroup,!0)};n._callState&&7!==n._callState||(e.isGroup||l.default.detectConversationType(e.calleeId)===r.ConversationType.AGENT?t():a.swc.services.webApi.getUsersPresence([e.calleeId]).then(function(n){var i=n[0];"Online"!==(i&&i.Payload&&i.Payload.availability)&&a.swc.Eventing.triggerEvent("calleeUnavailable",{mri:e.calleeId,withVideo:e.withVideo}),t()}))}},this._rejectCall=function(e){n._ready&&a.swc.Calling.rejectCallById(e.id)},this._acceptCall=function(e){n._ready&&(e.threadId?n._joinGroupCall(e):(n._showCalling({mri:e.callerMri,fullyCover:!1}),a.swc.Calling.acceptCallById(e.id)))},this._element.innerHTML="";var u=a.swc.services.signInManager;u.state===o.SigninState.SignedIn?this.init():u.subscribe("isSignedIn",this.init)}return e._getChat=function(){return!s.default.get.standaloneCalling&&a.swc.ChatContent},e._toggleActiveCallClass=function(e,t){t?e.view.classList.add("onactivecall"):e.view.classList.remove("onactivecall")},e.prototype._joinGroupCall=function(e){this._showCalling({mri:e.threadId,fullyCover:!1}),a.swc.Calling.acceptCallByThreadId(e.threadId)||a.swc.Calling.startCall(e.threadId,e.withVideo,{avatarURI:e.avatarUrl,displayName:e.displayName},e.isGroup,!0)},e}();t.CallingView=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(0),r=n(57),a=n(26),c=n(8);t.Contact=function(e){return s.createElement(r.AccessibleListItem,null,s.createElement("div",{role:"button",tabIndex:0,className:"item",onClick:e.onClick},s.createElement(a.SwcPersonAvatar,{person:e.person,isPstn:e.contactId.indexOf("4:")>-1,size:a.SwcAvatarSize.Medium,accessible:!1}),s.createElement("div",{role:"none",className:"info"},s.createElement("div",{role:"none",className:"titleRow"},s.createElement("p",{role:"none",className:"title"},e.displayName),e.mutualFriendCount&&s.createElement("div",{role:"none",className:"mutualsCount"},s.createElement(c.SwcIcon,{type:c.SwcIconType.ContactGroupPair}),s.createElement("p",{role:"none","aria-label":o.swc.services.i18n.fetch("mutual_friends",{count:e.mutualFriendCount})},e.mutualFriendCount))),(e.showPersonId||e.jobTitle)&&s.createElement("div",{role:"none",className:"idRow"},e.showPersonId?s.createElement(i.Fragment,null,s.createElement(c.SwcIcon,{type:c.SwcIconType.Skype}),s.createElement("p",{role:"none",className:"id"},e.contactId)):s.createElement("p",{role:"none",className:"engineering-title"},e.jobTitle||"")))))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(249),s=n(28),o=function(){function e(){}return e.isToday=function(e){var t=i.getCurrentDate();return t.setHours(0,0,0,0),e.getTime()>t.getTime()},e.isWithinSevenDays=function(e){var t=e.getTime(),n=i.getCurrentDate().getTime();return t>=new Date(n-6048e5).getTime()},e.getDifferenceForLastHour=function(e){var t=Math.round((Date.now()-e.getTime())/60/1e3);return t<0?0:t},e.minutesUntilMidnight=function(){var e=i.getCurrentDate();return e.setHours(24,0,0,0),Math.floor((e.getTime()-i.getCurrentDate().getTime())/1e3/60)},e.toStringMessageDate=function(e,t){if(!e)return"";var n=s.LocaleInfo.instance.getLocale().split("?",1)[0];if(this.isToday(e))return e.toLocaleTimeString(n,{hour:"2-digit",minute:"2-digit"});var o=!!t&&t.dateWithTime;if(this.isWithinSevenDays(e))return o?e.toLocaleTimeString(n,{weekday:"short",hour:"2-digit",minute:"2-digit"}):e.toLocaleDateString(n,{weekday:"short"});var r=i.getCurrentDate().getFullYear()>e.getFullYear(),a=r?{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}:{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},c=r?{year:"numeric",month:"short",day:"numeric"}:{month:"short",day:"numeric"};return e.toLocaleDateString(n,o?a:c)},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentDate=function(){return new Date}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(0),a=n(6),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcSpinner",t}return s(t,e),t.prototype.getComposedBlockClassName=function(){var t=e.prototype.getComposedBlockClassName.call(this);return this.props.size&&(t+=" "+this.props.size),t},t.prototype.render=function(){return o.createElement("div",{role:"status","aria-label":(e="recentlistChats_loading",r.swc.services.i18n.fetch(e)),"aria-live":"off",className:this.getComposedBlockClassName()});var e},t.defaultProps={size:"swcSpinner_medium"},t}(a.SwcBaseComponent);t.SwcSpinner=c},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),a=n(1),c=n(5),l=n(2),u=n(68),d=n(36),p=n(29),h=n(0),f=n(8),g=function(e){return h.swc.services.i18n.fetch(e)},v="https://go.skype.com/signup?client_id=578134&redirect_uri=https%3A%2F%2Fweb.skype.com",m=function(e){var t=e.componentConfig,n=e.guestOnly,i=e.isTeams,s=e.signinEnabled,o=e.signIn,r=e.close;return a.createElement("div",{className:"sign-in-wrapper"},a.createElement("div",{className:"sign-in-row close"},t.CanClose&&a.createElement("button",{className:"sign-in-cancel",onClick:r},a.createElement("span",{class:"swcIcon swcIcon_cancel","aria-hidden":"true"}))),a.createElement("div",{className:"sign-in-content"},i?a.createElement("div",{className:"icon-chats",dangerouslySetInnerHTML:{__html:h.swc.Assets.SVG.iconChats}}):a.createElement("div",{className:"skype-logo",dangerouslySetInnerHTML:{__html:h.swc.Assets.SVG.skypeLogo}}),a.createElement("div",null,g(n?"you_cannot_sign_in_when_guest_only_mode_enabled":"sign_in_welcome")),s&&!n&&a.createElement("button",{className:"sign-in-button",onClick:o},g("sign_in"))),a.createElement("div",{className:"sign-in-row signup"},a.createElement("div",null,g("do_not_have_account")),a.createElement("a",{href:v,target:"_blank",rel:"noreferrer noopener"},g("sign_up"))))},_=function(e){var t=e.icon,n=e.text;return a.createElement("li",null,a.createElement("div",{class:"icon"},a.createElement(f.SwcIcon,{type:t})),a.createElement("div",{className:"text"},n))},y=function(e){var t=e.signIn;return a.createElement("div",{className:"sign-in-wrapper msn"},a.createElement("div",{className:"sign-in-section top"},a.createElement("div",{className:"title"},g("msn_signin_screen_title")),a.createElement("ul",{className:"sign-in list"},a.createElement(_,{icon:f.SwcIconType.Contact,text:g("msn_signin_screen_contacts")}),a.createElement(_,{icon:f.SwcIconType.Ok,text:g("msn_signin_screen_recents")}),a.createElement(_,{icon:f.SwcIconType.CallStart,text:g("msn_signin_screen_calling_messaging")}))),a.createElement("div",{className:"sign-in-section bottom"},a.createElement("div",{className:"sign-in-row title"},g("msn_signin_screen_connect")),a.createElement("div",{className:"sign-in-row microsoft"},a.createElement(f.SwcIcon,{type:f.SwcIconType.LogoMicrosoft}),a.createElement("div",{className:"text"},g("msn_signin_screen_connect_description"))),a.createElement("div",{className:"sign-in-row actions"},a.createElement("div",{className:"signin"},a.createElement("div",null,g("msn_signin_screen_sign_in_has_account")),a.createElement("button",{className:"action",onClick:t},g("msn_signin_screen_sign_in_button"))),a.createElement("div",{className:"signup"},a.createElement("div",null,g("msn_signin_screen_sign_in_no_account")),a.createElement("a",{className:"action",href:v,target:"_blank",rel:"noreferrer noopener"},g("msn_signin_screen_create_account_button"))))))},w=function(e){function t(t){var n=e.call(this,t)||this;return n.signIn=function(){return h.swc.services.signInManager.login(function(e){return n.props.params.isSignedIn=!!e})},n.signinEnabled=function(){return n.setState({signinEnabled:u.default.instance.isCleared||n.props.params.explicitSignInRequired||n.props.params.isConversationWithPerson&&h.swc.services.signInManager.userIdentityType===p.IdentityType.GUEST})},n.state={signinEnabled:!1},n}return s(t,e),t.prototype.close=function(){c.default.get.frameless?h.swc.SDK.Chat.resolveMessage({origin:l.Configuration.ORIGIN,action:d.ActionNames.HideChatWindow}):parent&&parent.postMessage({origin:l.Configuration.ORIGIN,action:d.ActionNames.HideChatWindow},document.referrer||"*"),h.swc.Telemetry.sendEvent.visibilityChangeQos(!1)},t.prototype.componentWillMount=function(){this.signinEnabled(),u.default.instance.subscribe("isCleared",this.signinEnabled),h.swc.Telemetry.sendEvent.authPageLanding(h.swc.services.signInManager.lastAuthSource)},t.prototype.render=function(){var e={componentConfig:this.props.componentConfig,signinEnabled:this.state.signinEnabled,guestOnly:c.default.get.isGuestOnlyMode,isTeams:c.default.get.isTeams(),signIn:this.signIn,close:this.close};return"msn"===this.props.componentConfig.Style?a.createElement(y,{signIn:this.signIn}):a.createElement(m,o({},e))},t}(r.Component);t.SignIn=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(273),s="no-transition",o=function(){function e(){var e=this;this.players=function(){return e._players},this.terminatedMedia=function(){return e._terminatedMedia},this.pauseAll=function(){e.players().forEach(function(e){e.pause(),e.mute&&e.mute(!0)})},this.registerPlayer=function(e){var t={id:e.id,isInFullscreen:e.isInFullscreen,pause:e.pause,play:e.play,mute:e.mute?e.mute:null,type:e.mediaType,isPlaying:e.isPlaying,autoplay:e.autoplay,isQueuedForPlaying:e.isQueuedForPlaying,triggeredByUser:e.triggeredByUser};this.players().push(t)},this.removePlayer=function(t){var n=e.getPlayerById(t);n&&e.players().splice(e.players().indexOf(n),1)},this.getPlayerById=function(t){var n;return e.players().forEach(function(e){e.id===t&&(n=e)}),n},this.getPlayingMedia=function(){var t;return e.players().forEach(function(e){(e.isPlaying()||e.isQueuedForPlaying())&&(t=e)}),t},this.onEnteringFullscreen=function(t){e.mainComponentElement&&e.mainComponentElement.classList.add(s),e.playerInFullscreen=t},this.onLeavingFullscreen=function(){e.mainComponentElement&&e.mainComponentElement.classList.remove(s),e.playerInFullscreen=null},this.onFullScreenChanged=function(t){if(!(t.target&&(t.target.id&&"yt_msg_"===t.target.id.substring(0,7)||t.target.activeElement&&t.target.activeElement.id&&"yt_msg_"===t.target.activeElement.id.substring(0,7)))){var n=document,i=!!(n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement||n.msFullscreenElement);e.playerInFullscreen&&e.playerInFullscreen.isInFullscreen(i),i||e.onLeavingFullscreen()}},this.onClientBlurred=function(){var t=e.getPlayingMedia();t&&!t.triggeredByUser()&&(t.pause(),e.terminatedMedia=t)},this.onClientFocused=function(){e.terminatedMedia&&e.terminatedMedia().play&&(e.terminatedMedia().play(),e.terminatedMedia=null)},this.dispose=function(){document.removeEventListener("webkitfullscreenchange",e.onFullScreenChanged),document.removeEventListener("mozfullscreenchange",e.onFullScreenChanged),document.removeEventListener("MSFullscreenChange",e.onFullScreenChanged),document.removeEventListener("fullscreenchange",e.onFullScreenChanged),document.removeEventListener(i.default.events.browser.BLUR,e.onClientBlurred),document.removeEventListener(i.default.events.browser.FOCUS,e.onClientFocused)}}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e,e._instance.init()),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._players=[],this._terminatedMedia=null,this.mainComponentElement=document.querySelector(".swc.main-component"),document.addEventListener("webkitfullscreenchange",this.onFullScreenChanged),document.addEventListener("mozfullscreenchange",this.onFullScreenChanged),document.addEventListener("MSFullscreenChange",this.onFullScreenChanged),document.addEventListener("fullscreenchange",this.onFullScreenChanged),document.addEventListener(i.default.events.browser.BLUR,this.onClientBlurred),document.addEventListener(i.default.events.browser.FOCUS,this.onClientFocused)},Object.defineProperty(e.prototype,"playerInFullscreen",{get:function(){return this._playerInFullscreen},set:function(e){e!==this._playerInFullscreen&&(this._playerInFullscreen=e)},enumerable:!0,configurable:!0}),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prepare=function(e){return e=(e=e.replace(/&nbsp;/g," ").replace(/<div( itemprop="copy-paste-block")?>/g,"").replace(/<\/div>/g,"").trim()).replace(/<span[^>]*type="(\([a-z]+\))"[^>]*><img[^>]*itemid="(\w+)"[^>]*><\/span>/g,'<ss type="$2">$1</ss>')},e}();t.TeamsMessageUtil=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.addFormatting=function(t){return t=e.addFormattingTags(t,"s",/(\s|^|_|\*|i>|b>|s>)~((?!~\s).)*~(\s|$|_|\*|<)/gi,"~")},e.addFormattingTags=function(t,n,i,s){for(var o=t.match(i);o&&o.length>0&&2!==o[0].trim().length;)o.forEach(function(i){var o=i.trim(),r=(o=o.substring(o.indexOf(s),o.lastIndexOf(s)+1)).substr(1,o.length-2);r=e.createStartTag(n,s)+r+e.createEndTag(n),t=t.replace(o,r)}),o=t.match(i);return t},e.createStartTag=function(e,t){return"<"+e+' raw_pre="'+t+'" raw_post="'+t+'">'},e.createEndTag=function(e){return"</"+e+">"},e}();t.default=i},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.isElementAllowed=function(e){return"i"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("mention")},t.prototype.xmlNodeToHtml=function(e,t){if("at"===t.nodeName.toLowerCase()&&t.attributes.getNamedItem("id")){var n=e.createElement("i");return n.setAttribute("class","mention"),n.setAttribute("title",t.attributes.getNamedItem("id").value),n.textContent=t.textContent,[n]}return[]},t}(n(256).DomTransformerBase);t.MentionDomDecoder=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.transformRawToXml=function(e,t,n,i){var s=[];for(s.push(t);0!==s.length;){var o=s.pop();this.encodeTextNodeToXml(e,o,n,i)&&o.nodeType!==Node.TEXT_NODE&&this.isElementAllowed(o)&&this.pushChildNodes(s,o)}},e.prototype.encodeTextNodeToXml=function(e,t,n,i){var s=t.parentNode,o=this.xmlNodeToHtml(e,t,n,i);if(!o||!o.length)return!0;for(var r=0;r<o.length;r++)s.insertBefore(o[r],t);return s.removeChild(t),!1},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e}();t.DomTransformerBase=i},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.isElementAllowed=function(e){return"pre"!==e.nodeName.toLowerCase()},t.prototype.wordRawToXml=function(e,t){return[r(e)]},t.prototype.getAllWords=function(e){for(var t,n=/\r?\n/g,i=new Array;null!==(t=n.exec(e));)i.push(t);return i},t}(n(84).WordDomTransformer);function r(e){return e.createElement("br")}t.NewLineDomTransformer=o},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.isElementAllowed=function(e){return"a"!==e.nodeName.toLowerCase()},t.prototype.wordRawToXml=function(e,t){var n,i=t.match(/^(?:https?:\/\/|mailto:)(.+)$/i),s=i&&i[0],o=s;return s||(s=(i=t.match(/^[^@]+@(?:\w+(?:\.\w+)+)$/i))&&"mailto:"+i[0],o=i&&i[0]),s||(i=t.match(/^(?:www(?:\.\w+){1,}\.(?:com|org|net|edu|gov|mil|aero|arpa|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|pro|tel|travel|[a-z]{2,3}))$/i))&&i[0]&&(n=i.input?i.input.split("?")[1]:"",s="https://"+i[0],o=s=n?s+"?"+n:s),s?[r(e,s,o)]:[]},t.prototype.wordMatcher=function(){return/\S+/g},t}(n(84).WordDomTransformer);function r(e,t,n){var i=e.createElement("a");return i.setAttribute("href",t),i.setAttribute("title",t),i.setAttribute("target","_blank"),i.setAttribute("tabindex","-1"),i.innerText=n,i}t.URLDomTransformer=o},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=function(e){function t(t,n,i){var s=e.call(this,t,n,i)||this;return s.actionType=o.SwiftCardActionType.unknown,s.originalPayload=t,s.actionType=t.type,s.image=t.image||t.image_url||null,s}return s(t,e),t}(n(95).default);t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);!function(e){e.OK="ok",e.CANCEL="cancel"}(t.NewChatAction||(t.NewChatAction={})),t.sendChatComposerActionEvent=function(e,t,n,s){var o={name:"chat_composer_action",properties:{action:{value:e},participants:{value:t},isTopicSet:{value:n},ttc:{value:s}}};i.swc.Telemetry.getLogger().logEvent(o)}},,,,,,,,,,,,function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(21),a=n(252),c=n(274),l=r.default.getDocument(),u=60,d=".timeline",p=function(e){function t(t,n){var i=e.call(this,t)||this;return i.isInFullscreen=ko.observable(!1),i.play=function(){i.queuedForPlaying=!i.isLoaded,i.isLoaded?(i.player.play(),i.isPlaying(!0),i.onLoadedActionHandler=null):i.onLoadedActionHandler=i.play},i.pause=function(){i.queuedForPlaying=!1,i.touchedByUser=!1,i.isLoaded?(i.player.pause(),i.isPlaying(!1),i.onLoadedActionHandler=null):i.onLoadedActionHandler=i.pause},i.togglePlay=function(){i.player.paused||i.player.ended?(a.default.instance.pauseAll(),i.play(),i.mute(!1),i.touchedByUser=!0):i.pause()},i.getCurrentTime=function(){return i.formatTime(i.currentTimeUnformatted())},i.getTotalTime=function(){return i.formatTime(i.totalTimeUnformatted())},i.getPlayButtonText=function(){var e=i.isPlaying()?"mediaPlayer_pause":"mediaPlayer_play";return o.swc.services.i18n.fetch(e)},i.formatTime=function(e){var t=Math.round(e),n=0;return t>=u&&(t-=(n=parseInt((t/u).toString(),10))*u),i.addLeadingZero(n)+":"+i.addLeadingZero(t)},i.onTimeUpdated=function(){i.currentTimeUnformatted(i.player.currentTime),i.setProgress(i.currentTimeUnformatted()/i.totalTimeUnformatted()*100)},i.isQueuedForPlaying=function(){return i.queuedForPlaying},i.triggeredByUser=function(){return i.touchedByUser},i.dispose=function(){i.currentTime.dispose(),i.totalTime.dispose(),i.playButtonText.dispose(),a.default.instance.removePlayer(i.id)},i.isPlaying=ko.observable(!1),i.currentProgress=ko.observable("0"),i.progressBar=t.querySelector(d),i.currentTime=ko.computed(i.getCurrentTime),i.totalTime=ko.computed(i.getTotalTime),i.playButtonText=ko.computed(i.getPlayButtonText),i.mediaType=n,i}return s(t,e),t.prototype.mute=function(e){this.player&&this.isMuted&&(this.player.muted=e,this.isMuted(e))},t.prototype.addLeadingZero=function(e){return 1===e.toString().length?"0"+e:e},t.prototype.setProgress=function(e){this.currentProgress("width: "+e+"%")},t.prototype.updateRange=function(e){var t=this.progressBar.offsetWidth,n=this.progressBar.getBoundingClientRect().left,i=e.pageX-n;this.player.currentTime=this.player.duration*(i/t),this.setProgress(i/t*100)},t.prototype.onTimelineClick=function(e,t){this.updateRange(t)},t.prototype.onHandleStartDrag=function(e,t){this.updateRange(t),l.addEventListener("mousemove",this.updateRange),l.addEventListener("mouseup",function(){l.removeEventListener("mousemove",this.updateRange),l.removeEventListener("mouseup",this.onMouseUp)})},t}(c.default);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={events:{browser:{FOCUS:"focus",BLUR:"blur",KEYDOWN:"keydown",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=".player",s=function(){function e(e){var t=this;this.element=e,this.canPlay=ko.observable(),this.isLoading=ko.observable(),this.failed=ko.observable(),this.onMetadataLoaded=function(){t.isLoaded=!0,t.onLoadedActionHandler&&t.onLoadedActionHandler(),t.currentTimeUnformatted(t.player.currentTime),t.totalTimeUnformatted(t.player.duration)},this.canPlay=ko.observable(!1),this.isLoading=ko.observable(!0),this.failed=ko.observable(!1),this.isLoaded=!1,this.currentTimeUnformatted=ko.observable(0),this.totalTimeUnformatted=ko.observable(0),this.player=this.element.querySelector(i)}return e.prototype.onError=function(){this.canPlay(!1),this.isLoading(!1),this.failed(!0)},e.prototype.onReady=function(){this.canPlay(!0),this.isLoading(!1),this.failed(!1)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(8);t.getFileIconTypeByExtension=function(e){switch(e){case"xls":case"xlsx":return i.SwcIconType.MsExcel;case"doc":case"docx":return i.SwcIconType.MsWord;case"ppt":case"pptx":return i.SwcIconType.MsPowerPoint;case"one":return i.SwcIconType.MsOneNote;case"pdf":return i.SwcIconType.Pdf;case"vdx":case"vsd":case"vsdx":return i.SwcIconType.MsVisio;default:return i.SwcIconType.File}}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(94),a=n(0),c=n(6),l=n(8),u=n(250),d=function(e){return a.swc.services.i18n.fetch(e)},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcFileStatus",t}return s(t,e),t.prototype.render=function(){var e=this.props.status,t=!1,n=!1,i=!1;switch(e){case r.DocumentStatus.Success:t=!0;break;case r.DocumentStatus.InProgress:case r.DocumentStatus.ScanInProgress:i=!0;break;case r.DocumentStatus.Failed:case r.DocumentStatus.Malware:n=!0}var s=function(e){var t="";switch(e){case r.DocumentStatus.Failed:t=d("message_text_upload_failed");break;case r.DocumentStatus.ScanInProgress:t=d("message_text_scanning");break;case r.DocumentStatus.InProgress:t=d("message_text_uploading");break;case r.DocumentStatus.Malware:t=d("message_text_malware");break;case r.DocumentStatus.Success:t=d("message_text_upload_complete")}return t}(e);return o.createElement("div",{className:this.getComposedBlockClassName(),title:s},i&&o.createElement(u.SwcSpinner,{className:"swcFileStatus__icon"}),t&&o.createElement(l.SwcIcon,{className:"swcFileStatus__icon",type:l.SwcIconType.Ok}),n&&o.createElement(l.SwcIcon,{className:"swcFileStatus__icon",type:l.SwcIconType.Error}))},t}(c.SwcBaseComponent);t.SwcFileStatus=p},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(94),r=n(0),a=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="",n.state={status:null},n}return s(t,e),t.prototype.checkFileStatus=function(e){var t=this;r.swc.services.amsManager.getFileStatus(e).then(function(n){t.setState({status:n.uploadStatus}),n.uploadStatus!==o.DocumentStatus.InProgress&&n.uploadStatus!==o.DocumentStatus.ScanInProgress||(t._timeoutId=setTimeout(function(){t.checkFileStatus(e)},500))})},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t}(n(6).SwcBaseComponent);t.SwcSharepointItemBase=a},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=n(0),a=n(95),c=n(385),l=n(112),u=n(386),d=n(387),p=n(71),h="9:16",f="portrait",g="landscape",v=function(){return function(){this.unsupportedText=r.swc.services.i18n.fetch("s_unsupported"),this.vatText=r.swc.services.i18n.fetch("s_vat"),this.taxText=r.swc.services.i18n.fetch("s_tax"),this.totalPriceText=r.swc.services.i18n.fetch("s_totalPrice"),this.areButtonsMultiLine=!1,this.mainSection=null}}();t.BaseContent=v;var m=function(e){function t(n,i,s,r){var c=e.call(this)||this;c.computeButtonsLimit=function(){if(c.type===o.SwiftCardContentType.thumb)return 3;var e=3;return 0===c.mainSection.images.length&&(e+=2),c.mainSection.text||(e++,c.mainSection.title||e++,c.mainSection.subtitle||e++),Math.min(e,6)},c.isValid=function(){return 0!==c.buttons.length?c.buttons.every(function(e){return e.isValid()}):c.mainSection.isValid()},c.isSupported=function(){var e=c.buttons.every(function(e){return e.isSupported()});return c.isValid()&&e},c.type=r,c.buttons=p.default.filterOutDisabledItems(n.buttons,function(e){return new a.default(e,i,s)}),c.tap=n.tap?p.default.getItemIfNotDisabled(new a.default(n.tap,i,s)):null,c.mainSection=new d.default(n,i,s,r);var l=c.computeButtonsLimit();return c.buttons.length>l&&(c.buttons=c.buttons.slice(0,l)),c.areButtonsMultiLine=t.areButtonsMultiLine(c.buttons),c}return s(t,e),t.areButtonsMultiLine=function(e){switch(e.length){case 2:return!e.every(function(e){return e.title.length<=11});case 3:return!e.every(function(e){return e.title.length<=5})}return!0},t}(v);t.default=m;var _=function(e){function t(t,n,i){var s=e.call(this)||this;s.isValid=function(){return 0!==s.buttons.length&&!!s.text},s.isSupported=function(){return s.isValid()},s.find=function(e,t){var n;for(n=0;n<e.length;++n)if(t(e[n],n,e))return e[n]},s._conversation=n,s.type=o.SwiftCardContentType.signin,s.buttons=p.default.filterOutDisabledItems(t.buttons,function(e){return new a.default(e,n,i)});var r=s.find(s.buttons,function(e){return e.type===o.SwiftCardActionType.signin});return s.buttons=r?[r]:[],s.text=p.default.normalizeRichText(t.text),s}return s(t,e),t}(v);t.SignInContent=_;var y=function(e){function t(t,n,i,s){var o=e.call(this)||this;return o.hasUrl=function(){return!!o.image&&!!o.image.url},o.hasTitle=function(){return!!o.title||!!o.subtitle},o.isValid=function(){return!!o.media&&!!o.media.isValid()},o.isSupported=function(){return o.isValid()},o.type=s,o.autoloop=t.autoloop,o.autostart=t.autostart,o.shareable=t.shareable,o.subtitle=t.subtitle?p.default.normalizeRichText(t.subtitle):null,o.title=t.title?p.default.normalizeRichText(t.title):null,o.image=new l.default(t.image||{},n,i,s),o.aspect=t.aspect&&t.aspect===h?f:g,o.hasThumbnail=ko.computed(o.hasUrl),o.hasTextInfo=ko.computed(o.hasTitle),o.media=t.media&&t.media.length?new u.default(t.media[0],n,i,s):null,o.buttons=p.default.filterOutDisabledItems(t.buttons,function(e){return new a.default(e,n,i)}),o.buttons.length>3&&(o.buttons=o.buttons.slice(0,3)),o.areButtonsMultiLine=m.areButtonsMultiLine(o.buttons),o}return s(t,e),t}(v);t.MediaContent=y;var w=function(e){function t(n,i,s){var l=e.call(this)||this;return l.itemsForInitialDisplay=[],l.triggerFoldAction=function(){l.isCollapsed(!l.isCollapsed()),l.isCollapsed()?l.collapseItems():(l.displayedItems(l.items),l.foldButtonText(r.swc.services.i18n.fetch("s_showLess")))},l.isValid=function(){var e=l.buttons.every(function(e){return e.isValid()});return!!l.total&&e},l.isSupported=function(){var e=l.buttons.every(function(e){return e.isSupported()});return l.isValid()&&e},l.collapseItems=function(){l.displayedItems(l.itemsForInitialDisplay),l.foldButtonText(r.swc.services.i18n.fetch("s_showAll"))},l.getItemsForInitialDisplay=function(){for(var e=0,n=0;n<l.items.length;n++){if(e>=t.MAX_ITEMS_NUMBER_TO_DISPLAY)return;l.itemsForInitialDisplay.push(l.items[n]),l.items[n].images.length>0?e+=t.IMAGE_ITEM_COUNTER:e++}l.itemsForInitialDisplay=[]},l._conversation=i,l.type=o.SwiftCardContentType.receipt,l.buttons=p.default.filterOutDisabledItems(n.buttons,function(e){return new a.default(e,i,s)}),l.buttons.length>3&&(l.buttons=l.buttons.slice(0,3)),l.areButtonsMultiLine=m.areButtonsMultiLine(l.buttons),l.tap=n.tap?new a.default(n.tap,i,s):null,l.title=p.default.normalizeRichText(n.title),l.total=p.default.normalizeText(n.total),l.tax=p.default.normalizeText(n.tax),l.vat=p.default.normalizeText(n.vat),l.facts=p.default.filterOutNotValidItems(n.facts,function(e){return new c.default(e)}),l.items=p.default.filterOutNotValidItems(n.items,function(e){return new d.default(e,i,s,o.SwiftCardContentType.thumb)}),l.displayedItems=ko.observableArray(),l.showFoldButton=ko.observable(!1),l.isCollapsed=ko.observable(!1),l.foldButtonText=ko.observable(),l.getItemsForInitialDisplay(),l.itemsForInitialDisplay.length>0?(l.showFoldButton(!0),l.isCollapsed(!0),l.collapseItems()):l.displayedItems(l.items),l}return s(t,e),t.MAX_ITEMS_NUMBER_TO_DISPLAY=5,t.IMAGE_ITEM_COUNTER=3,t}(v);t.ReceiptContent=w;var b=function(e){function t(t,n,i,s){var r=e.call(this)||this;r.expandedText=function(){return r.title&&r.subtitle?"":r.title||r.subtitle?"expandedTextOnce":"expandedTextTwice"},r.isValid=function(){return!!r.title||!!r.subtitle||!!r.text||0!==r.images.length},r.isSupported=function(){return r.isValid()},r.computeButtonsLimit=function(){if(r.type===o.SwiftCardContentType.thumb)return 3;var e=3;return 0===r.images.length&&(e+=2),r.text||(e++,r.title||e++,r.subtitle||e++),Math.min(e,6)},r._conversation=n,r.type=s,r.buttons=p.default.filterOutDisabledItems(t.buttons,function(e){return new a.default(e,n,i)}),r.title=t.title?p.default.normalizeRichText(t.title):null,r.subtitle=t.subtitle?p.default.normalizeRichText(t.subtitle):null,r.text=t.text?p.default.normalizeRichText(t.text):null,r.tap=t.tap?p.default.getItemIfNotDisabled(new a.default(t.tap,n,i)):null,r.images=t.images?p.default.mapImages(t.images,n,i,r.type):[];var c=r.computeButtonsLimit();return r.buttons.length>c&&(r.buttons=r.buttons.slice(0,c)),r.areButtonsMultiLine=m.areButtonsMultiLine(r.buttons),r}return s(t,e),t}(v);t.FlexContent=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(4),r=n(5),a=n(2),c=n(70),l=n(69),u=n(133),d=n(7),p=n(32),h=n(63),f=n(0),g=n(89),v=n(150),m=n(248),_=n(146),y=n(20),w=n(12),b=n(109),C=n(85),E=n(151),S=n(26),I=n(135),T=n(147),P=n(101),x={FILE:"filemessage",IMAGE:"imagemessage",SWIFT:"swiftContainer",WELCOME:"welcome"},k={ME:"me",OTHER:"other",NEW:"new",FIRST:"isFirst",GROUP:"group",LESS:"less"},A={USER:"UserMessage",SWIFT:"SwiftCard",SYSTEM:"SystemMessage",WELCOME:"Welcome",TRANSLATE:"Translate",IMAGE:"LwcImage",FILE:"LwcFile"},O=", ",M="tag-",N=function(){function e(e,t,n,N){var L=this;if(this.message=e,this.conversation=t,this._conversationElement=n,this.messageFromMe=!1,this.author=ko.observable(),this.showAuthor=ko.observable(!1),this.isGroup=!1,this.showStatus=ko.observable(!1),this.status=ko.observable(),this.isNew=ko.observable(!0),this.type=d.MessageType.UserMessage,this.showMessageInfo=ko.observable(!1),this.showTimestamp=ko.observable(!1),this.showEditedIcon=ko.observable(!1),this.isDeletedMessage=ko.observable(!1),this.showMessageActions=ko.observable(!1),this._reactionItems={},this.hasReactions=ko.observable(!1),this.reactionsPaneEnabled=!1,this.reactionsPaneItems=[],this._userCanDeleteMessages=!1,this._userCanEditMessages=!1,this.isContentExpanded=ko.observable(),this.contentLimitValue=ko.observable(""),this._updateItems=function(e,t){e.forEach(function(e){for(var n=0;n<L.reactionsPaneItems.length;n++){var i=L.reactionsPaneItems[n];if(r.default.get.isTeams()&&"like"===e.key&&(e.key="yes"),e.key===i.id)for(var s=0;s<e.users.length;s++)if(f.swc.services.mePersonManager.isMe(e.users[s].mri)){i.selected=t,t?L._reactionItems[i.id].classList.add("selected"):L._reactionItems[i.id].classList.remove("selected");break}}})},this._addReactionsToFragment=function(){if(!(L._mapReactionPaneItems.length<1)){L._reactionElement=document.createElement("div"),L._reactionElement.className="swc-scroll-wrapper";var e=document.createElement("div");e.className="swc-scroll-viewport";var t=document.createElement("div");t.className="reactionsPane",t.setAttribute("role","list");for(var n=document.createDocumentFragment(),r=function(e){var t=L.reactionsPaneItems[e],r=document.createElement("div");r.className="reaction",r.setAttribute("role","listitem"),r.setAttribute("tabindex","0"),t.selected&&r.classList.add("selected");var a={callback:function(){}},c={large:!0,largeEmoticonClass:"large",emoticonId:t.id,title:t.title,isAnimated:t.selected,setUpdateCallback:function(e){a.callback=e}},l=s.createElement(P.SwcEmoticon,c),u=document.createDocumentFragment();i.render(l,u);var d=function(){a.callback({isAnimated:!0})},p=function(){a.callback({isAnimated:!1})};r.addEventListener("mouseover",d),r.addEventListener("mouseout",p),r.addEventListener("focus",d),r.addEventListener("blur",p),r.appendChild(u);var h=document.createElement("span");h.className="selectedPoint",r.appendChild(h);r.addEventListener("click",function(e){t.selected?(L._removeReactionOnMessage(t,e),r.classList.remove("selected")):(L._setReactionOnMessage(t,e),r.classList.add("selected")),a.callback({isAnimated:!t.selected})}),r.addEventListener("keydown",function(e){e.stopPropagation();var t=y.default.getKeyCode(e);t!==w.default.ENTER&&t!==w.default.SPACE||r.click(),t===w.default.ESCAPE&&f.swc.Eventing.triggerLocalEvent(o.ApiEvents.hideBubbleWindow)}),n.appendChild(r),L._reactionItems[t.id]=r},a=0;a<L.reactionsPaneItems.length;a++)r(a);t.appendChild(n),e.appendChild(t),L._reactionElement.appendChild(e),L.reactionScrollBar=new l.default(L._reactionElement,L._reactionElement.firstChild)}},this._mapReactionPaneItems=function(e){for(var t=[],n=0;n<L.ecsReactionsPack.length;n++){var i=e[L.ecsReactionsPack[n]];i&&t.push({id:i.id,title:i.description||i.id,selected:!1})}return t},this._setReactionSelectedState=function(e){for(var t=function(t){for(var n=e[t],i=!1,s=0;s<n.users.length;s++)if(n.users[s].person.id===L._mePersonId){i=!0;break}i&&L.reactionsPaneItems.forEach(function(e){r.default.get.isTeams()&&"like"===n.key&&(n.key="yes"),n.key===e.id&&(e.selected=!0)})},n=0;n<e.length;n++)t(n)},this._isUserMessage=function(){return"UserMessage"===L.message.type},this.triggerEditMessageAction=function(){f.swc.Eventing.triggerEvent(o.ApiEvents.RequestEditingMessage,{convId:L.conversation.id,message:L.message})},this.copyMessageAction=function(){var e=p.default.dompurify.sanitize(L.message.content,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]}),t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)},this.openDeleteMsgConfirmationDialog=function(){I.ConfirmationDialog.add(L._conversationElement,L.removeMessageConfirmation,T.TextDialog)},this.triggerUnreadFromHere=function(){var e=L._getPreviousMessage(),t=e.getKey(),n=e.timestamp.getTime()+";"+(new Date).getTime()+";"+t;f.swc.services.webApi.updateConsumptionHorizon(L.conversation.id,n).then(function(){L.conversation.updateConsumptionHorizon(n)}),E.default.remove(),f.swc.Telemetry.sendEvent.userAction(h.UserActionType.MarkMessageUnread)},this._setReactionOnMessage=function(e,t){e.id&&(t.preventDefault(),L.conversation.setMessageProperty(L.conversation.id,L.message.id,a.Configuration.MESSAGE_PROPERTIES.PER_USER.EMOTIONS,{key:e.id}).then(function(){e.selected=!0,f.swc.Telemetry.sendEvent.reactionSet(e.id)}))},this._removeReactionOnMessage=function(e,t){e.id&&L.conversation.removeMessageProperty(L.conversation.id,L.message.id,a.Configuration.MESSAGE_PROPERTIES.PER_USER.EMOTIONS,{key:e.id}).then(function(){e.selected=!1})},this.openReactionsPane=function(e,t){if(L._reactionElement&&L.reactionsPaneItems.length){t.preventDefault(),t.stopPropagation();var n=t.target,i={target:t.target,clientX:t.clientX||n.getBoundingClientRect().right,clientY:t.clientY||n.getBoundingClientRect().top};E.default.add(i,L.messageListElement,L._reactionElement,E.BubbleType.ReactionPane,E.BubblePosition.onContextMenu),L.reactionScrollBar&&(L.reactionScrollBar.recount(),f.swc.services.pesManager.refresh()),f.swc.Telemetry.sendEvent.userAction(h.UserActionType.ReactionPicker)}},this.openMessageActions=function(e,t){if(t.target&&L.message.type!==d.MessageType.SystemMessage){var n=L.getMessageActions();if(n.length){var i=b.default.createMenuList(n,"msgActionsMenuList");t.preventDefault(),t.stopPropagation(),E.default.add(t,L.messageListElement,i,E.BubbleType.List,E.BubblePosition.onContextMenu),L._conversationElement&&L._conversationElement.addEventListener("click",L._removeBubbleListener)}}},this._removeBubbleListener=function(){E.default.remove(),L._conversationElement&&L._conversationElement.removeEventListener("click",L._removeBubbleListener)},this._setAvatarVM=function(e,t){if(!f.swc.services.mePersonManager.isMe(L.message.senderId)){var n=e?e.nextElementSibling:null;if(L._avatarContainer=n?n.querySelector(".headerAvatar"):null,L._avatarContainer){var o={person:t,size:S.SwcAvatarSize.Medium},r=s.createElement(S.SwcPersonAvatar,o);i.render(r,L._avatarContainer)}}},this._showAuthor=function(){return!L.messageFromMe&&"Welcome"!==L.message.type},this.mapMessageTypeClassName=function(){switch(L.type){case A.FILE:return x.FILE;case A.WELCOME:return x.WELCOME;case A.IMAGE:return x.IMAGE;case A.SWIFT:return x.SWIFT;default:return""}},this.setClassNames=function(){var e=[];return e.push(L.messageTypeClassName),e.push(L.messageFromMe?k.ME:k.OTHER),L.isNew()&&e.push(k.NEW),L.showAuthor()&&e.push(k.FIRST),L.isGroup&&e.push(k.GROUP),L.isContentExpanded()&&e.push(k.LESS),L.message.senderId&&0===L.message.senderId.indexOf("28:")&&e.push("bot"),L.tags&&v.default.explode(L.tags).forEach(function(t){return e.push(M+t)}),e.join(" ")},this._startChatFromContactTeams=function(e,t){var n=[{role:"Admin",id:f.swc.services.mePersonManager.mePerson.mri},{role:"Admin",id:e}],i=function(e){var n=e.headers.get("location").match(/threads\/(19:.*)$/)[1];g.default.startChat(n,L.conversation.definition,!1,t)},s=function(e){};u.findRecentConversationIdForMembers(n).then(function(e){g.default.startChat(e,L.conversation.definition,!1,t)}).catch(function(e){f.swc.services.webApi.createThread(n).then(i,s)})},this.navigateToChat=function(e){r.default.get.disableAvatarClickAction||(r.default.get.isTeams()?L._startChatFromContactTeams(e,c.OpenChatOrigin.AVATAR):g.default.startChat(e,L.conversation.definition,!1,c.OpenChatOrigin.AVATAR))},this.onAvatarKeyDown=function(e,t){var n=y.default.getKeyCode(t);n!==w.default.ENTER&&n!==w.default.SPACE||t.target.click()},this.dispose=function(){L.message.senderId&&L.updateDisplayName&&f.swc.services.persons.getPerson(L.message.senderId).unsubscribe("displayName",L.updateDisplayName);L.message.unsubscribe("isFirst",L.updateMessageInfo),L.message.unsubscribe("status",L.subscribeToDeliveryStatus),L._avatarContainer&&i.render(null,L._avatarContainer)},this.updateDisplayName=function(){var e=f.swc.services.persons.getPerson(L.message.senderId);e.displayName&&L.author(e.displayName+O)},this.updateMessageInfo=function(e){L.showAuthor(L._showAuthor()&&e),L.showTimestamp(e),L.showMessageInfo((L.showAuthor()||L.showTimestamp())&&L.conversation.isSkypeBackend()&&"SystemMessage"!==L.message.type&&"UnreadSplitter"!==L.message.type&&"SkypeLogo"!==L.message.type&&"Welcome"!==L.message.type)},r.default.get.isTeams()?this.ecsReactionsPack=["yes"]:this.ecsReactionsPack=a.Configuration.ECS.reactionPacks||[],this.reactionsPaneEnabled=!_.default.isDomainIn("disableSendingReactions")&&"SystemMessage"!==e.type&&"UnreadSplitter"!==e.type&&!!this.ecsReactionsPack.length,this.isContentExpanded(!1),this.messageListElement=N.parentNode,this._mePersonId=f.swc.services.mePersonManager.mePerson.id,this.openMenuText=f.swc.services.i18n.fetch("open_menu_dialog_text"),this.editMessageTitle=f.swc.services.i18n.fetch("confirm_dialog_edit_msg_header"),this.editedMessageText=f.swc.services.i18n.fetch("icon_text_message_was_edited"),this.deleteMessageHeader=f.swc.services.i18n.fetch("confirm_dialog_delete_msg_header"),this.deleteMessageText=f.swc.services.i18n.fetch("confirm_dialog_delete_msg_text"),this.openReactionsPaneText=f.swc.services.i18n.fetch("reactions_react_to_message"),this.unreadFromHereTitle=f.swc.services.i18n.fetch("unread_from_here"),this.copyMessageTitle=f.swc.services.i18n.fetch("copy_message"),t.definition.MessageContentLimit=t.definition.MessageContentLimit?"130px":"",this.reactionsPaneItems=this._mapReactionPaneItems(f.swc.services.pesManager.emoticonMap),this._setReactionSelectedState(e.emotions),this._addReactionsToFragment(),this.type=e.type,this.senderId=e.senderId,this.timestamp=m.default.toStringMessageDate(this.message.timestamp,{dateWithTime:!0}),this.messageTypeClassName=this.mapMessageTypeClassName(),"SystemMessage"!==e.type&&"UnreadSplitter"!==e.type){if(e.subscribe("isFirst",this.updateMessageInfo),this.message.senderId){var D=f.swc.services.persons.getPerson(this.message.senderId,!0),R=this.message.senderId;e.imdisplayname?R=e.imdisplayname:(D.subscribe("displayName",function(e){e&&L.author(e+O)}),R=D.displayName),this._setAvatarVM(N,D),R&&this.author(R+O);var U=f.swc.services.mePersonManager.isMe(C.default.normalizePersonId(e.senderId));this.messageFromMe=!!e.senderId&&U}else this.messageFromMe=e.direction===d.Direction.Outgoing;this.showAuthor(this._showAuthor())}f.swc.services.capabilitiesService.getCapabilitiesForConversation(this.conversation).then(function(e){L.showMessageActions(L.messageFromMe&&!t.definition.HideMessageActionsMenu&&e.allowDeleteMessage),L._userCanDeleteMessages=e.allowDeleteMessage,L._userCanEditMessages=e.allowEditMessage}),this.isGroup=t.isGroup,this.subscribeToDeliveryStatus(e),e.isEdited&&e.type!==d.MessageType.SystemMessage&&this.showEditedIcon(this._isUserMessage()),e.subscribe("isEdited",function(t){e.type!==d.MessageType.SystemMessage&&L.showEditedIcon(t)}),this.isDeletedMessage(e.isDeleted),e.subscribe("isDeleted",function(e){L.isDeletedMessage(e)}),e.subscribe("content",function(e){""!==e&&setTimeout(function(){f.swc.services.pesManager.refresh()})}),this.classNames=ko.pureComputed(this.setClassNames),this.removeMessageConfirmation={title:this.deleteMessageHeader,text:this.deleteMessageText,confirm:{title:f.swc.services.i18n.fetch("btn_confirm_removal"),action:function(){f.swc.Telemetry.sendEvent.userAction(h.UserActionType.DeleteMessage),L.conversation.deleteMessage(L.message),I.ConfirmationDialog.remove()}},cancel:{title:f.swc.services.i18n.fetch("sign_in_cancel"),action:I.ConfirmationDialog.remove}},this.hasReactions(!!e.emotions&&!!e.emotions.length),e.emotions&&e.emotions.subscribe(function(e,t){t.newItems&&t.newItems.length>0?L._updateItems(t.newItems,!0):t.oldItems&&t.oldItems.length>0&&L._updateItems(t.oldItems,!1),L.hasReactions(!!e.length)})}return Object.defineProperty(e.prototype,"properties",{get:function(){var e,t=this.message.properties;if(t)if("string"==typeof t)try{e=JSON.parse(t)}catch(e){}else"object"==typeof t&&(e=t);return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this.properties?this.properties.tags:null},enumerable:!0,configurable:!0}),e.prototype._getPreviousMessage=function(){for(var e=this.conversation.messages,t=this.message.getKey(),n=e[0],i=e.length-1;i>0;i--)if(e[i].getKey()===t){n=e[i-1];break}return n},e.prototype.getMessageActions=function(){var e=this.message.type===A.USER&&this._userCanEditMessages,t=this._userCanDeleteMessages,n=[{items:[],id:"messageOptions"}];return this.message.type!==d.MessageType.LwcImage&&this.message.type!==d.MessageType.LwcFile&&n[0].items.push({title:this.copyMessageTitle,group:1,action:this.copyMessageAction}),this.messageFromMe?(e&&n[0].items.push({title:this.editMessageTitle,group:1,action:this.triggerEditMessageAction}),t&&n[0].items.push({title:this.deleteMessageHeader,group:1,action:this.openDeleteMsgConfirmationDialog})):this.message.type!==d.MessageType.SystemMessage&&n[0].items.push({title:this.unreadFromHereTitle,group:1,action:this.triggerUnreadFromHere}),n},e.prototype.seeMore=function(){this.isContentExpanded(!0),this.contentLimitValue("inherit"),f.swc.Eventing.triggerEvent(o.ApiEvents.onMessageExpand)},e.prototype.seeLess=function(){this.isContentExpanded(!1),this.contentLimitValue(this.conversation.definition.MessageContentLimit),f.swc.Eventing.triggerEvent(o.ApiEvents.onMessageCollapse)},e.prototype.subscribeToDeliveryStatus=function(e){function t(){switch(e.status){case 0:this.status(f.swc.services.i18n.fetch("sending")),this.showStatus(!0);break;case 1:this.status(f.swc.services.i18n.fetch("sent")),this.showStatus(!1);break;case 2:this.status(f.swc.services.i18n.fetch("failed")),this.showStatus(!0);break;default:this.status(""),this.showStatus(!1)}}"SystemMessage"!==this.message.type&&"UnreadSplitter"!==this.message.type&&(e.subscribe("status",t.bind(this)),t.bind(this)())},e}();t.BaseMessage=N},function(e,t){e.exports='<div class="lwx-message">\r\n    \x3c!-- ko if: !imageContent()  --\x3e\r\n        <div class="content" data-bind="style:{\r\n                backgroundColor: messageColor,\r\n                background: messageColor\r\n            },\r\n            css: { sticker: isExtraLargeEmoticon, bot: isAgent, withReactions: $parent.hasReactions,\r\n                system: isSystemMsg()}">\r\n            \x3c!-- ko if: content --\x3e\r\n                <span class="text" data-bind="html: content"></span>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: $parent.reactionsPaneEnabled && !$parent.messageFromMe --\x3e\r\n            <button tabindex="-1" class="reactionsBtn" data-bind="click: $parent.openReactionsPane,\r\n            attr: {title: $parent.openReactionsPaneText}">\r\n                <span class="swcIcon swcIcon_emoticonStroke" aria-hidden="true"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n            <reactions-bar class="reactionsBar" params="message: message, messageListElement: messageList"></reactions-bar>\r\n\r\n            <div class="filesContainer"></div>\r\n        </div>\r\n\r\n        \x3c!-- ko if: isTranslated --\x3e\r\n            <div class="translation-globe">\r\n                <span class="swcIcon swcIcon_globe" aria-hidden="true"></span>\r\n            </div>\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: imageContent() --\x3e\r\n        <div class="content image" data-bind="html: imageContent,\r\n        style:{backgroundColor: messageColor}"></div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showEditedIcon --\x3e\r\n    <span class="messageBtn edit" data-bind="attr:{\'aria-label\': $parent.editedMessageText, title: $parent.editedMessageText}">\r\n        <span class="swcIcon swcIcon_topic" aria-hidden="true"></span>\r\n    </span>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showMessageActions() --\x3e\r\n    <div class="actionsContainer">\r\n        <button tabindex="-1" class="messageBtn deleteAction" data-bind="click: $parent.openDeleteMsgConfirmationDialog,\r\n        attr: {title: $parent.deleteMessageHeader}">\r\n            <span class="swcIcon swcIcon_delete" aria-hidden="true"></span>\r\n        </button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(4),o=n(27),r=n(0);!function(e){e[e.submit=0]="submit",e[e.change=1]="change"}(i=t.CommandMode||(t.CommandMode={}));var a=function(){function e(){var e=this;this.commands=[],this.mode=i.change,this.setupProxy=function(){r.swc.Eventing.registerEvent(s.ApiEvents.cmd.reg,function(t){return e.register(t)}),r.swc.Eventing.registerEvent(s.ApiEvents.cmd.unreg,function(t){return e.unregister(t)})},o.ProxyConnector.instance.connect("commands",null,this.setupProxy)}return Object.defineProperty(e,"instance",{get:function(){return e.init()},enumerable:!0,configurable:!0}),e.init=function(){return e._instance||(e._instance=new e)},e.prototype.register=function(e){e&&-1===this.commands.indexOf(e)&&this.commands.push(e)},e.prototype.unregister=function(e){var t=this.commands.indexOf(e);-1!==t&&this.commands.splice(t,1)},e.prototype.isValidCommand=function(e){if("/"!==e.charAt(0)||!this.commands.length)return!1;var t=e.substr(1).split(" ")[0];return-1!==this.commands.indexOf(t)},e.prototype.evaluate=function(e,t,n){var i,o,a;if("/"!==e.charAt(0)&&void 0===n||!this.commands.length)return i;n&&n.keyCode?(o="keydown",a=JSON.stringify({keyCode:n.keyCode,shiftKey:n.shiftKey})):(o=e.substr(1).split(" ")[0],a=e.substr(o.length+2));return(i=-1!==this.commands.indexOf(o))&&r.swc.Eventing.triggerEvent(s.ApiEvents.cmd.exec,{command:o,conversationId:t,data:a}),i},e}();t.Commands=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(56),s=function(){function e(e){this.text=e}return e.prototype.applySuggestion=function(){var e=this.text.value,t=i.wordBoundariesAt(e,this.text.selectionStart),n=this.getReplacer(),s=e.slice(t.end);return""===s&&(n+=" "),{value:e=e.slice(0,t.start)+n+s,selectionStart:this.text.selectionStart,selectionEnd:t.start+n.length}},e}();t.Suggestion=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(0),r=n(438),a=function(){function e(e,t,n,i){var s=this;this.person=e,this.containerElement=t,this.action=n,this.canRemoveObservable=i,this.selectedForRemoval=ko.observable(!1),this.action=function(){return n(s)},this.render(),this.selectedForRemoval.subscribe(function(){return s.render()}),this.canRemoveObservable&&this.canRemoveObservable.subscribe(function(){return s.render()}),this.person.subscribe("displayName",function(){return s.render()})}return e.prototype.render=function(){var e,t,n,a=this,c=document.createDocumentFragment(),l=this.containerElement?this.containerElement.childNodes:[];i.render(s.createElement(r.Participant,{person:this.person,action:this.action,canBeRemoved:!!this.canRemoveObservable&&this.canRemoveObservable(),removeParticipantText:(t="remove_participant_by_name",n={participantName:this.person.displayName},o.swc.services.i18n.fetch(t,n)),selectedForRemoval:this.selectedForRemoval()}),c),l.forEach(function(t){t.getAttribute("data-id")===a.person.id&&(e=t)}),this.participantEl=c.firstChild,this.containerElement&&e?this.containerElement.replaceChild(this.participantEl,e):this.containerElement&&this.containerElement.appendChild(this.participantEl)},e}();t.ParticipantVM=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),s=n(5),o=n(2),r=n(36),a=n(70),c=n(7),l=n(260),u=n(0),d=n(89),p=n(16),h=n(31),f=n(14),g="",v=function(){return function(e,t){var n=this;this._definition=e,this._element=t,this.selectedParticipantsCount=ko.observable(0),this.correlationId=p.guid.generate(),this.onSelectedParticipantsChange=function(e){n.selectedParticipantsCount(e)},this.isCreatingGroupChat=function(){return n.selectedParticipantsCount()>1},this.closeNewChatWindow=function(){s.default.get.frameless?u.swc.SDK.Chat.resolveMessage({origin:o.Configuration.ORIGIN,action:r.ActionNames.HideChatWindow}):parent&&parent.postMessage({origin:o.Configuration.ORIGIN,action:r.ActionNames.HideChatWindow},document.referrer||"*"),n._clearViewModelData();var e={id:o.Configuration.NEW_CHAT_COMPOSER_ID,container:n._container};u.swc.Eventing.triggerEvent(i.ApiEvents.onControlClose,e)},this.cancel=function(e){u.swc.Telemetry.sendEvent.chatComposerAction(l.NewChatAction.CANCEL,e.length,!!n.titleInput.value,Date.now()-n.timeStarted),n.closeNewChatWindow()},this.confirmAddParticipants=function(e){n._mePersonId||(n._mePersonId=u.swc.services.mePersonManager.mePerson.id),1===e.length?(u.swc.Telemetry.sendEvent.chatComposerAction(l.NewChatAction.OK,e.length,!!n.titleInput.value,Date.now()-n.timeStarted),d.default.startChat(e[0].id,n.definition,!1,a.OpenChatOrigin.NEWCHAT)):n._createConversation(e),n.closeNewChatWindow()},this._createConversation=function(e){var t={id:h.default.toFullIdentifier(n._mePersonId),role:c.ParticipantRole.Admin},i=n.titleInput.value?n.titleInput.value.trim():"";i=f.MessageUtils.sanitizeTopic(i),0===e.filter(function(e){return e.id===t.id}).length&&e.push(t),u.swc.services.webApi.createThread(e).then(function(t){var s=t.headers.get("location").match(/threads\/(19:.*)$/)[1];i&&(n.definition.Title=i,n.definition.SetConversationTopic=!0),u.swc.Telemetry.sendEvent.chatComposerAction(l.NewChatAction.OK,e.length,!!i,Date.now()-n.timeStarted),u.swc.Telemetry.sendEvent.chatComposerQos(e.length,!!i,Date.now()-n.timeStarted),d.default.startChat(s,n.definition,!1,a.OpenChatOrigin.NEWCHAT)},function(e){}),n._clearViewModelData()},this._clearViewModelData=function(){n.titleInput.value=g,n.selectedParticipantsCount(0)},this.definition=this._definition,this._container=this._element,this.enterGroupNameText=u.swc.services.i18n.fetch("new_chat_enter_group_name"),this.cancelText=u.swc.services.i18n.fetch("sign_in_cancel"),this.closeText=u.swc.services.i18n.fetch("close_window"),this.addToNewGroupText=u.swc.services.i18n.fetch("add_to_new_group_header"),this.newChatSelectItemsText=u.swc.services.i18n.fetch("new_chat_header_select_who_to_chat_with"),this.titleInput=t.querySelector("input.newChatInput"),this.timeStarted=Date.now(),setTimeout(function(){u.swc.Eventing.triggerEvent(i.SearchEvents.SEARCH_CREATE_CONTACTLIST,n.correlationId)},100)}}();t.default=v},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),o=n(1),r=n(444);t.DEFAULT_SETTINGS={actionOnResult:function(){},showCounter:!1,showHeaders:!0,showContactListAsDefault:!0,placeHolder:!0,isRecentListComponent:!1,showSearchIcon:!1};var a=function(){return function(e,t,n){n.innerHTML="";var a=o.createElement(r.SearchResults,i({},e));s.render(a,n)}}();t.default=a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(372);t.default=i.swc.ChatContent=new s.default},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(87),o=n(4),r=n(106),a=n(2),c=n(68),l=n(25),u=n(17),d=n(36),p=n(93),h=n(29),f=n(30),g=n(143),v=n(34),m=n(27),_=n(60),y=n(7),w=n(38),b=n(0),C=n(373),E=n(410),S=n(412),I=n(81),T=n(9),P=n(16),x=n(31),k=n(281),A=n(39),O=n(28),M=n(14),N=n(86),L=n(22),D=n(15),R=n(5),U=n(188),F=n(455),B=function(){function e(t){var n=this;if(this.element=t,this._chatInstances={},this._stylesReady=!1,this._callingInitialized=!1,this._initializing=!1,this.isInitialized=!1,this._loadConversation=function(e,t,i){e&&(n._createConversationID(e),n._topic=t,n._avatar=i)},this._hideConversation=function(e){var t=e===a.Configuration.NEW_CHAT_COMPOSER_ID?e:x.default.toFullIdentifier(e),i=n._chatInstances[t];n._setActive(i,!1),n._triggerChatVisibilityChange(!1,t),i&&(i.view.parentElement.style.display="none")},this._updateConversation=function(e,t){for(var i in n._chatInstances){if(i===(e.chatConfig.ConversationId===a.Configuration.NEW_CHAT_COMPOSER_ID?a.Configuration.NEW_CHAT_COMPOSER_ID:x.default.toFullIdentifier(e.chatConfig.ConversationId))){var s=n._chatInstances[i];s.model.definition=e.chatConfig,t&&n.setContainerByMri(i,t),n._setActive(s,!0),n._triggerChatVisibilityChange(!0,i),n._chatDataConfig.ExecuteCall&&n._executeCall(n._chatDataConfig.ExecuteCall)}else if(!R.default.get.isParallelView){var o=!!n._chatInstances[i].model.isActive;n._setActive(n._chatInstances[i],!1),o&&n._triggerChatVisibilityChange(!1,i)}}},this._focusNewChatSearch=function(e){var t=e.querySelector("input.searchContactsInput");t&&t.focus()},this._getNewChatNode=function(){var e=document.createElement("div");return e.innerHTML='<div\n            role="region"\n            aria-label="'+b.swc.services.i18n.fetch("add_to_new_group_header")+'"\n            class="swc conversation skype-conversation swc-focus-outline-area"\n            data-bind="component: \'new-chat\'"></div>',e.firstElementChild.cloneNode(!0)},this._initNewChatWindow=function(e){var t=n._chatInstances[a.Configuration.NEW_CHAT_COMPOSER_ID];if(!t){var i=n._getNewChatNode();e.appendChild(i),t=n._chatInstances[a.Configuration.NEW_CHAT_COMPOSER_ID]={view:i,model:{},container:e},ko.applyBindings(null,i),n._setActive(t,!0),R.default.get.isParallelView&&(n._CM.add(a.Configuration.NEW_CHAT_COMPOSER_ID,{alwaysOnStage:!0,view:i,model:{}}),R.default.get.isParallelView&&n.createContainer(a.Configuration.NEW_CHAT_COMPOSER_ID))}(n._stylesReady||n._isModule)&&n._openChatWindow(),n._focusNewChatSearch(t.view)},this._runChat=function(t){n.setCmBaseParent(t),n._stylesReady||(n._CM.baseParent.style.display="none");var i=t.element||n._CM.baseParent;t.id&&e._getConversationIdAsync(t.id).then(function(e){(I.isEnterpriseObjectId(n._conversationId)||I.isEnterpriseObjectId(_.normalizePersonId(n._conversationId)))&&(n._conversationId=e);var s,o=!1;for(var r in n._chatInstances){var a=n._chatInstances[r];e===r?(o=!0,s=a.model):!R.default.get.isParallelView&&a.model.isActive&&n._triggerChatVisibilityChange(!1,r),n._setActive(a,e===r)}if(t.data&&t.data.chatConfig&&t.data.chatConfig.NewChatFlag)n._initNewChatWindow(i);else{if(o)s.isDisposed&&s.start(),s.markAsRead();else{var c=t.data&&t.data.chatConfig?t.data.chatConfig.RefId:null;n._setupConversation(i,c)}!!t.element&&!R.default.get.isParallelView||!n._stylesReady&&!n._isModule||n._openChatWindow();var l=n._chatDataConfig.ExecuteCall;l&&n._executeCall(l)}})},this._forceExpandChat=function(e){return b.swc.Eventing.triggerLocalEvent(o.ApiEvents.ForceExpandChat,e)},this._openChatWindow=function(){b.swc.Eventing.triggerEvent(d.ActionNames.ShowChatWindow),R.default.get.frameless?b.swc.SDK.Chat.resolveMessage({origin:a.Configuration.ORIGIN,action:d.ActionNames.ShowChatWindow}):parent&&parent.postMessage({origin:a.Configuration.ORIGIN,action:d.ActionNames.ShowChatWindow},"*"),n._triggerChatVisibilityChange(!0,n._conversationId)},this.signinStateChangedHandler=function(e){switch(e){case l.SigninState.SignedOut:n.disposeConversationsOnSkypeLogout(),n.resetSkypeBackend();break;case l.SigninState.SigningIn:n.disposeConversationsOnSkypeLogout();break;case l.SigninState.SignedIn:R.default.get.isTeams()&&A.isInIframe()&&(b.swc.secured=!0,b.swc.Eventing.secure()),R.default.get.callingReady&&n._callingInitialized||n.setupCalling(),b.swc.services.amsManager.authenticate();break;case l.SigninState.SigningOut:}},this.resetSkypeBackend=function(){return c.default.instance.isCleared=!1,b.swc.services.webApi.reset().then(function(){if(c.default.instance.dispose(),b.swc.services.signInManager.reloginContext.canRelogin){var e=function(){b.swc.services.mePersonManager.fetch(),c.default.instance.restoreLastConversation()};b.swc.services.signInManager.reloginContext.execCallback().then(e,e)}else c.default.instance.isCleared=!0})},this.restoreLastConversation=function(){if(n._conversationId){var e=n._chatInstances[n._conversationId];e&&(e.model.start(),n.isClientVisible()&&b.swc.services.webApi.startEndpointActivation())}},this.setup=function(e){window.onbeforeunload=function(){b.swc.services.webApi.reset(),n.disposeConversations()},n._loadCss(),C.default.register(n._chatDataConfig),S.default.register(n._chatDataConfig);var t=x.default.getSdkModeFromId(n._chatDataConfig.ConversationId);b.swc.services.signInManager.activeConversationSdkMode=t,e.data&&n._chatDataConfig&&n._chatDataConfig.EnableCalling&&L.default.testSupporedList(a.Configuration.ECS.callingSupportedBrowsers)&&b.swc.services.mePersonManager.fetch();var i=x.default.detectConversationType(n._chatDataConfig.ConversationId),r=function(){var t=n._chatDataConfig.Title?M.MessageUtils.parseTopic(n._chatDataConfig.Title):"";e.id&&n._loadConversation(s(e.id),t,s(n._chatDataConfig.Avatar)),n.enable()&&n._runChat(e)};n.setCmBaseParent(e),i===y.ConversationType.PHONE?n._callingInitialized&&b.swc.Eventing.triggerEvent(o.ApiEvents.StartCall,{calleeId:"4:"+e.id,withVideo:!1,avatarUrl:null,displayName:e.id}):n._chatDataConfig.ConversationId&&(e.data&&e.data.switchConversation||n.isInitialized?r():b.swc.services.initPromise.then(r))},this._getCSSUris=function(e){var t=[],i=e.Style&&/https:\/\/[\S]+.css/g.test(e.Style),s=f.PackageName.STYLE_CHAT_SKYPE;return e.Style&&!i&&(s="swc-chat-"+e.Style),t.push(D.UrlHelper.getAbsoluteUrl(s,"css")),i&&t.push(e.Style),e.Theme&&(t.push(D.UrlHelper.getAbsoluteUrl("swc-"+n._chatDataConfig.Theme,"css")),n._CM.baseParent.classList.add(n._chatDataConfig.Theme)),e.CssUrl&&t.push(e.CssUrl),t},this._loadCss=function(){if(!n._isModule){var e=[];n._getCSSUris(n._chatDataConfig).forEach(function(t){return e.push(N.StyleLoader.addStyle(t))}),Promise.all(e).then(function(){n._stylesReady||(n._openChatWindow(),n._stylesReady=!0,n._CM.baseParent&&(n._CM.baseParent.style.display=""))})}},this._onMessageReceived=function(e){e.origin===a.Configuration.ORIGIN&&/^(bs:[soh]Chat.*)|(swc:chat:)|(swc:calling:)/.test(e.action)&&n.resolveMessage(e)},this.openChatLocal=function(e){var t=e.ConversationId,s=n._chatInstances[t]?d.ActionNames.UpdateConversation:d.ActionNames.ShowChatWindow,o={chatConfig:i({},n._chatDataConfig,{ConversationId:t})};n.resolveMessage({action:s,id:t,data:o})},this.signIn=function(e,t,i){n._applicationInitialized.promise.then(function(){b.swc.services.signInManager.setExternalCallbacks(e,t),b.swc.services.signInManager.getSkypeToken()})},this.signOut=function(){return n._applicationInitialized.promise.then(function(){return b.swc.services.signInManager.logout("external")})},this.setAad=function(e){var t=n._chatInstances[n._conversationId];t.model.contextAad=e},this.getTokenExpirationTime=function(){return b.swc.services.signInManager.getTokenExpirationTime()},this.onOpenedChatWindow=function(){if(n.isClientVisible()){var e=n._chatInstances[n._conversationId];e&&e.model&&e.model.markAsRead&&e.model.markAsRead(),n.sendChatVisibilityChangeTelemetry()}},this.sendChatVisibilityChangeTelemetry=function(){var e=0;n._CM.forEach(function(t){t.onStage&&e++}),b.swc.Telemetry.sendEvent.visibilityChangeQos(!0,e)},this.onClientFocused=function(){c.default.instance.isFocused=!0,n.isClientVisible()&&(b.swc.Eventing.triggerEvent(o.ApiEvents.onFocused,!0),n.sendInappActivityStart("Foregrounded")),n._CM&&n._CM.forEach(function(e){e.onStage&&e.model&&e.model.markAsRead&&e.model.markAsRead()})},this.onClientBlurred=function(){c.default.instance.isFocused=!1,b.swc.Eventing.triggerEvent(o.ApiEvents.onFocused,!1)},this.bindTheme=function(){R.default.get.subscribe("theme",function(e){for(var t in n._chatInstances){var i=n._chatInstances[t].container.classList;n._theme&&i.remove(n._theme),e&&i.add(e)}n._theme=e})},this.setupMessagingProxy=function(){var e=function(e){return b.swc.Eventing.triggerEvent(o.ApiEvents.messagingProxy.disconnected,e)};b.swc.Eventing.registerEvent(o.ApiEvents.messagingProxy.disconnect,function(){return b.swc.services.webApi.reset().then(function(){return e(!0)},function(){return e(!1)})})},this._applicationInitialized=new u.CancelablePromise,b.swc.Eventing.registerEvent(o.ApiEvents.compatEvent,this._onMessageReceived),b.swc.Eventing.registerEvent(o.ApiEvents.openChatLocal,this.openChatLocal),A.isInIframe()){var p=this.element||document.querySelector("#main.swc"),h=b.swc.options[r.ModuleType.Messaging];if(h&&h.chatConfig){var g=h.chatConfig,v=g&&g.ParallelView?4:1;this._CM=this._CM||new E.default({container:p,minWidth:400}),this._CM.createViewports(v,this._getCSSUris(h.chatConfig),g).then(function(){return b.swc.Eventing.triggerEvent(o.MessagingEvents.Ready)})}}else b.swc.Eventing.triggerEvent(o.MessagingEvents.Ready)}return e.prototype.init=function(e){var t=this;if(!this._initializing&&!this.isInitialized){var n;if(this._initializing=!0,e.data&&e.data.chatConfig&&(O.LocaleInfo.instance.getLocale(e.data.chatConfig.Locale),n=e.data.chatConfig.ChatMinWidth),c.default.initServices({skypeTokenProvider:e.tokenProvider,initialSkypeTokenData:e.initialSkypeTokenData,tokenType:e.tokenType,fileSharing:e.data.fileSharing,userSettings:e.data.userSettings}),b.swc.services.initPesManager(),b.swc.Eventing.registerEvent(o.ApiEvents.onControlClose,function(e){return t._hideConversation(e.id)}),!A.isInIframe()){var i=this.element||document.querySelector("#main.swc");this._CM=this._CM||new E.default({container:i,minWidth:n})}b.swc.services.signInManager.subscribe("state",this.signinStateChangedHandler),c.default.instance.setRestoreOfLastConversation(this.restoreLastConversation),this._applicationInitialized.resolve(),b.swc.services.signInManager.state===l.SigninState.SignedIn&&this.signinStateChangedHandler(b.swc.services.signInManager.state),b.swc.Eventing.registerEvent(o.ApiEvents.invoke.sendMessageToBot,function(e){return t.sendMessageToBot(e.content,e.botId,e.botMessageId)}),b.swc.Eventing.registerEvent(o.ApiEvents.invoke.signOut,function(e){return t.signOut()}),b.swc.Eventing.registerEvent(o.ApiEvents.invoke.setAad,function(e){return t.setAad(e.aad)}),b.swc.Eventing.registerEvent("closeAllChats",function(e){return t.closeAllChats()}),k.Commands.init(),this.bindTheme()}},e.prototype.dispose=function(){b.swc.services.signInManager.unsubscribe("state",this.signinStateChangedHandler),this.enable(!1),ko.cleanNode(this._CM.baseParent),this.disposeConversations(),b.swc.services.signInManager.state=l.SigninState.SignedOut,this._CM.baseParent=null},e.prototype.disposeConversations=function(){for(var e in this._chatInstances){var t=this._chatInstances[e].model;t&&t.dispose&&t.dispose(),delete this._chatInstances[e]}},e.prototype._createConversationID=function(e){this._conversationId=e===a.Configuration.NEW_CHAT_COMPOSER_ID?a.Configuration.NEW_CHAT_COMPOSER_ID:x.default.toFullIdentifier(e)},e.prototype._setActive=function(e,t){if(e){var n=e.view.classList;t?n.add("conversation-active"):n.remove("conversation-active"),e.model.isActive=t}t&&this._CM.baseParent&&this._stylesReady&&(this._CM.baseParent.style.display="")},e.prototype.createContainer=function(e){var t=document.createElement("div");t.className="swc chat "+R.default.get.currentLocale,this.setContainer(e,t),R.default.get.theme&&(this._theme=R.default.get.theme,t.classList.add(this._theme))},e.prototype.setContainerByMri=function(e,t){this._chatInstances[e]&&(this._CM.setContainer(e,t),t.appendChild(this._chatInstances[e].view),this._chatInstances[e].container=t)},e.prototype.isOnStage=function(e){var t=this._CM.get(e);return t&&t.onStage},e.prototype.setContainer=function(e,t){e===a.Configuration.NEW_CHAT_COMPOSER_ID?this.setContainerByMri(e,t):this.setContainerByMri(x.default.toFullIdentifier(e),t)},e.prototype.getContainer=function(e){return e===a.Configuration.NEW_CHAT_COMPOSER_ID?this.getContainerByMri(e):this.getContainerByMri(x.default.toFullIdentifier(e))},e.prototype.getConversationTuple=function(t){var n=this;return e._getConversationIdAsync(t).then(function(e){return n._CM.getAsync(e)})},e.prototype.getContainerByMri=function(e){var t;return this._chatInstances[e]&&(t=R.default.get.isParallelView?this._chatInstances[e].view:this._chatInstances[e].container),t||this._CM.baseParent},e.prototype.setCmBaseParent=function(e){this._CM.baseParent||(this._CM.baseParent=e.data&&e.data.placeholder?e.data.placeholder:e.element)},e._getConversationIdAsync=function(e){if(I.isEnterpriseObjectId(e))return I.generateOneToOneConversationId(e);var t=x.default.toFullIdentifier(e);return I.isEnterpriseUserMri(t)?I.generateOneToOneConversationId(t):Promise.resolve(t)},e.prototype._executeCall=function(e){R.default.get.callingReady?e.accept?b.swc.Eventing.triggerEvent(o.ApiEvents.AcceptCall,e):b.swc.Eventing.triggerEvent(o.ApiEvents.StartCall,e):e.accept?b.swc.Eventing.registerEvent(o.ApiEvents.CallingReady,function(){return b.swc.Eventing.triggerEvent(o.ApiEvents.AcceptCall,e)}):b.swc.Eventing.registerEvent(o.ApiEvents.CallingReady,function(){return b.swc.Eventing.triggerEvent(o.ApiEvents.StartCall,e)}),this._chatDataConfig.ExecuteCall=null},e.prototype._setupConversation=function(e,t){var n=this,i=b.swc.services.conversations.get(this._conversationId,this._chatDataConfig);i.refId=t,"null"!==this._topic&&""!==this._topic&&(i.topic=this._topic),i.avatar=this._avatar?this._avatar:i.avatar;var s=F.default.getView("skype");e.appendChild(s),this._chatInstances[this._conversationId]={view:s,model:i,container:e},this.enable(!0),ko.applyBindings({conversation:i,enable:this.enable},s),i.start(),this._chatDataConfig.SetConversationTopic&&i.isGroup&&i.topic&&i.setTopic(i.topic),this._setActive(this._chatInstances[this._conversationId],!0),this._chatDataConfig.WelcomeMessage&&b.swc.services.mePersonManager.fetch().then(function(){b.swc.services.mePersonManager.mePerson.fetchDisplayNameAndAvatar().then(function(){return i.sendMessage(n._chatDataConfig.WelcomeMessage,p.ActionTrigger.WELCOME_MESSAGE)},function(e){})},function(e){}),this._CM.add(this._conversationId,{view:s,model:i,container:e,displayedAt:Date.now(),onStage:!1,vm:ko.dataFor(s.firstChild)}),R.default.get.isParallelView&&this.createContainer(this._conversationId),this._chatDataConfig.GroupWith&&"none"!==this._chatDataConfig.GroupWith&&i.addBotToThread(this._chatDataConfig.GroupWith)},e.prototype._triggerChatVisibilityChange=function(e,t){var n=this,i={type:e?"show":"hide",container:null,isVisible:e,conversationId:x.default.getSdkModeFromId(t)===v.SDKMode.BOT?t:"n/a",key:t};R.default.get.frameless&&(i.container=this.getContainerByMri(t)),b.swc.Eventing.triggerEvent(o.ApiEvents.OnVisibilityChange,i),e&&t&&b.swc.services.signInManager.getSkypeToken().then(function(){n.sendInappActivityStart("Opened")},function(){}).catch(function(){})},e.prototype.disposeConversationsOnSkypeLogout=function(){for(var e in this._CM.dispose(),this._chatInstances){var t=this._chatInstances[e].model;t.dispose&&t.dispose()}b.swc.services.webApi.stopEndpointActivation()},e.prototype.setupCalling=function(){var e=this;b.swc.services.capabilitiesService.getCommonCapabilities(this._chatDataConfig).then(function(t){if(t.allowCalling){if(e._callingInitialized=!0,!e._isModule){var n=D.UrlHelper.getAbsoluteUrl(f.PackageName.STYLE_CALLING,"css");if(A.isInIframe())b.swc.services.viewports.byType("conversation").forEach(function(e){return N.StyleLoader.addStyle(n,e.document)});else N.StyleLoader.addStyle(n)}b.swc.Eventing.registerEvent("calling:ready",function(){var t=document.createElement("div");t.style.display="none",e._callingComponent=new U.CallingView(t)}),b.swc.scriptLoader.addScript(f.PackageName.CALLING,!0,function(){b.swc.Eventing.registerEvent(o.ApiEvents.CallingReady,function(){x.default.detectConversationType(e._chatDataConfig.ConversationId)===y.ConversationType.PHONE&&setTimeout(function(){return b.swc.Eventing.triggerEvent(o.ApiEvents.StartCall,{calleeId:"4:"+e._chatDataConfig.ConversationId,withVideo:!1,avatarUrl:null,displayName:e._chatDataConfig.ConversationId.substr(2)})},1e3)})})}})},e.prototype._setupChatConfig=function(e){if(e.data&&e.data.chatConfig){var t=e.data;this._chatDataConfig=t.chatConfig||this._chatDataConfig,R.default.get.inputPlaceholderOverride=R.default.get.inputPlaceholderOverride||this._chatDataConfig.InputPlaceholder,this._chatDataConfig.Style?R.default.get.style||(R.default.get.style=this._chatDataConfig.Style):this._chatDataConfig.Style=R.default.get.style,R.default.get.suppressBackgroundRinging=R.default.get.suppressBackgroundRinging||this._chatDataConfig.SuppressBackgroundRinging||"outlook"===R.default.get.style,R.default.get.isParallelView=R.default.get.isParallelView||this._chatDataConfig.ParallelView,R.default.get.isGuestOnlyMode=!!t.chatConfig.GuestOnly,R.default.get.sessionId=t.chatConfig.SessionId||R.default.get.sessionId||P.guid.generate(),R.default.get.parentProtocol=t.chatConfig.Protocol||e.data.chatConfig.Protocol||R.default.get.parentProtocol,R.default.get.correlationId=e.correlationId,R.default.get.isSkypeOnly=!!t.chatConfig.SkypeOnly,R.default.get.disableAvatarClickAction=t.chatConfig.DisableAvatarClickAction,t.chatConfig.ForceAuthentication&&this._clearSessionData()}},e.prototype._clearSessionData=function(){b.swc.services.sessionStorage.removeItem(w.SKYPE_TOKEN_KEY),b.swc.services.sessionStorage.removeItem(w.SKYPE_REGTOKEN_KEY),b.swc.services.sessionStorage.removeItem(w.SKYPE_ENDPOINT_ID_KEY),b.swc.services.sessionStorage.removeItem(w.SKYPE_HAS_HISTORY_KEY)},e.prototype._initChat=function(e){this.init(e||{}),R.default.get.host=e.host||R.default.get.host||"n/a",this._isModule=e.isModule;var t=window.location.hostname.replace("www.","");R.default.get.frameless=this._isModule||!A.isInIframe()&&t&&a.Configuration.ECS.frameless.indexOf(t)>-1,R.default.get.callStartMode=this._chatDataConfig.CallStartMode,R.default.get.displayDeviceGuide=this._chatDataConfig.DisplayDeviceGuide,R.default.get.translatorEnabled=this._chatDataConfig.EnableTranslator,b.swc.Telemetry.Context.SDK.setCorrelationId(R.default.get.correlationId),this.enable(this._chatDataConfig.Preload!==g.PreloadType.UIONLY),this.setup(e),this.isInitialized||(this.isInitialized=!0,b.swc.Eventing.triggerEvent(o.ApiEvents.Ready,!0))},e.prototype.createGuestInChat=function(e){var t=this;b.swc.services.wx.join(e.data.id,"").then(function(n){n?(e.initialSkypeTokenData={skypeToken:n.skypetoken,isGuest:!0,expiresAt:828e5},t._initChat(e)):T.default.throwError(10504,"Unable to create group conversation with a guest")},function(e){T.default.throwError(10504,"Unable to create group conversation with a guest",e)})},e.prototype.createGroupChatWithGuest=function(e){var t=this;b.swc.services.wx.auth().then(function(n){n?(e.id=n.ThreadId,e.initialSkypeTokenData={skypeToken:n.SkypeToken,isGuest:!0,expiresAt:828e5},t._initChat(e)):T.default.throwError(10504,"Unable to create group conversation with a guest")},function(e){T.default.throwError(10504,"Unable to create group conversation with a guest",e)})},e.prototype.createGroupChat=function(e){var t=this;this.init(e),b.swc.services.signInManager.getSkypeToken().then(function(){var n;n=new Array,e.data.chatConfig.GroupWith.split(",").forEach(function(e){n.push({role:y.ParticipantRole.User,id:x.default.toFullIdentifier(e)})}),0!==n.length&&(n.push({role:y.ParticipantRole.Admin,id:x.default.toFullIdentifier(b.swc.services.signInManager.currentUserName)}),b.swc.services.webApi.createThread(n).then(function(n){var i=n.headers.get("location").match(/threads\/(19:.*)$/)[1];e.id=i,b.swc.services.webApi.enableJoining(i),b.swc.services.webApi.discloseHistory(i),t._initChat(e)},function(){}))})},e.prototype.resolveMessage=function(e){var t=this;switch(e.action){case d.ActionNames.StartActivation:this.onClientFocused();break;case d.ActionNames.StopActivation:this.onClientBlurred();break;case d.ActionNames.ExpandChatWindow:break;case d.ActionNames.UpdateConversation:this._setupChatConfig(e),this._updateConversation(e.data,e.element);break;case d.ActionNames.LoadChatData:this.enable()||this._runChat(e),this._stylesReady&&(this._CM.baseParent.style.display="");break;case d.ActionNames.ShowChatWindow:if(this._setupChatConfig(e),!e.data||!e.data.chatConfig)break;e.tokenString&&(e.tokenProvider=function(){return Promise.resolve(e.tokenString)});var n=function(){t.enable=ko.observable();var n=x.default.getSdkModeFromId(e.data.id),s=e.data.chatConfig.ConversationId,o=x.default.detectConversationType(s);if(e.data.id&&n===v.SDKMode.THREAD&&e.data.chatConfig.GuestOnly)t.createGuestInChat(e);else if(e.data.chatConfig.GroupWith.length>0&&e.data.chatConfig.GuestOnly)t.createGroupChatWithGuest(e);else if(e.data.chatConfig.GroupWith.length>0&&e.data.chatConfig.SkypeOnly)t.createGroupChat(e);else if(!s||y.ConversationType.PERSON!==o&&y.ConversationType.AGENT!==o||!I.isEnterpriseUserMri(s)&&!I.isEnterpriseObjectId(s))t._initChat(e);else try{b.swc.services.signInManager.onceSignedIn().then(function(){b.swc.services.signInManager.userIdentityType===h.IdentityType.TEAMS&&I.generateOneToOneConversationId(e.data.chatConfig.ConversationId).then(function(n){var s=i({},e);s.id=n,s.data.id=n,s.data.chatConfig.ConversationId=n,t._initChat(s)})})}catch(e){}};m.ProxyConnector.instance.connect("messaging",null,this.setupMessagingProxy);var s=D.UrlHelper.getVendorPath()+"/knockout-latest.js";b.swcWindow.ko?n():b.swc.scriptLoader.addScript(s,null,function(){return n()});break;case d.ActionNames.OpenChatWindow:this._forceExpandChat(this._conversationId),this.onOpenedChatWindow(),window.setTimeout(function(){return b.swc.Eventing.triggerEvent(o.ApiEvents.ChatOpen,!0)},5);break;case d.ActionNames.HideChatWindow:R.default.get.frameless?b.swc.SDK.Chat.resolveMessage({origin:a.Configuration.ORIGIN,action:d.ActionNames.HideChatWindow}):parent&&parent.postMessage({origin:a.Configuration.ORIGIN,action:d.ActionNames.HideChatWindow},document.referrer||"*")}},e.prototype.sendMessageToBot=function(e,t,n){if(t&&0!==t.length){var i=x.default.toFullIdentifier(t),s=this._chatInstances[i];if(s&&s.model)return s.model.sendDataToBot({payload:e}).then(function(e){return b.swc.Eventing.triggerEvent(o.ApiEvents.invoke.sendMessageToBotResponse,{success:!0,botMessageId:n})},function(e){return b.swc.Eventing.triggerEvent(o.ApiEvents.invoke.sendMessageToBotResponse,{success:!1,botMessageId:n})});var r="Unable to send message the bot - wrong chat id";return T.default.throwError(10508,r),Promise.reject(r)}},e.prototype.closeAllChats=function(){var e=this._chatInstances[this._conversationId];e&&(e.view.parentElement.style.display="none"),this.disposeConversations(),this._CM.dispose(),this._conversationId=""},e.prototype.isClientVisible=function(){if(!this._conversationId)return!1;var e=this._chatInstances[this._conversationId];return!!e&&e.model.isActive},e.prototype.sendInappActivityStart=function(e){b.swc.services.signInManager.currentUserName&&b.swc.Eventing.triggerEvent(o.ApiEvents.InappActivityStarted,e)},e}();t.default=B},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(374),o=n(375),r=n(376),a=n(377),c=n(382),l=n(388),u=n(389),d=n(390),p=n(391),h=n(392),f=n(393),g=n(394),v=function(){function e(){}return e.register=function(e){if(!this.isInitialized){p.default.register(),ko.components.isRegistered("conversations-list")||ko.components.register("conversations-list",{viewModel:{createViewModel:function(e,t){return new h.ConversationsListVM(e.conversations)}},template:n(396),synchronous:!0}),ko.components.register("messageitem",{viewModel:{createViewModel:function(e,t){return g.getMessageViewModel(e.message,e.conversation,e.conversationContainer,t.element)}},template:n(397),synchronous:!0}),ko.components.register("usermessage",{viewModel:{createViewModel:function(t,n){return new a.default(t.message,t.conversation,t.messageListElement,n.element,e)}},template:n(280),synchronous:!0}),ko.components.register("systemmessage",{viewModel:{createViewModel:function(e,t){return new a.default(e.message,e.conversation,e.messageListElement,t.element)}},template:n(280),synchronous:!0}),ko.components.register("swiftcard",{viewModel:{createViewModel:function(e,t){return new c.default(e,t.element)}},template:n(398),synchronous:!0}),ko.components.register("adaptivecard",{viewModel:{createViewModel:function(e,t){return new l.default(e.content,e.conversation,t.element)}},template:n(399),synchronous:!0}),ko.components.register("lwcimage",{viewModel:{createViewModel:function(e,t){return new f.ImageMessageVM(e.message,e.conversation,e.messageListElement,t.element)}},template:n(400),synchronous:!0}),ko.components.register("lwcfile",{template:n(401),synchronous:!0}),ko.components.register("welcome",{viewModel:{createViewModel:function(e){return new d.default(e.message,e.conversation)}},template:n(402),synchronous:!0}),ko.components.register("skypelogo",{template:n(403),synchronous:!0}),ko.components.register("unreadsplitter",{template:n(404),synchronous:!0}),ko.components.register("unsupported",{viewModel:{createViewModel:function(t,n){return new a.default(t.message,t.conversation,t.messageListElement,n.element,e)}},template:n(405),synchronous:!0}),ko.components.register("translate",{viewModel:{createViewModel:function(e){return new u.default(e.message,e.conversation)}},template:n(406),synchronous:!0}),ko.components.register("audioplayer",{viewModel:{createViewModel:function(e,t){return new s.default(e,t.element)}},template:n(407),synchronous:!0}),ko.components.register("videoplayer",{viewModel:{createViewModel:function(e,t){return new r.default(e,t.element)}},template:n(408),synchronous:!0}),ko.components.register("gifplayer",{viewModel:{createViewModel:function(e,t){return new o.default(e,t.element)}},template:n(409),synchronous:!0});var t=i.swc.Assets.SVG;ko.components.register("skype-logo",{template:t.skypeLogo}),ko.components.register("icon-chats",{template:t.iconChats}),this.isInitialized=!0}},e.unregister=function(){for(var e=0,t=["contactrequest","usermessage","systemmessage","swiftcard","adaptivecard","lwcimage","lwcfile","audioplayer","videoplayer","gifplayer","skype-logo"];e<t.length;e++){var n=t[e];ko.components.unregister(n)}this.isInitialized=!1},e.isInitialized=!1,e}();t.default=v},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=n(272),a=n(252),c=function(e){function t(t,n){var i=e.call(this,n,o.SwiftCardContentType.audio)||this;return i._params=t,i.shouldShowCover=function(){return!(!i.coverImage||!i.coverImage.url)},i.onAudioEnded=function(){i.isPlaying(!1)},i.dispose=function(){i.showCoverImage.dispose()},i.coverImage=i._params.coverImage,i.media=i._params.media,i.autoloop=i._params.autoloop,i.id=i._params.messageId,i.showLoadingInfo=i._params.showLoadingInfo||!0,i.showCoverImage=ko.computed(i.shouldShowCover),a.default.instance.registerPlayer(i),i}return s(t,e),t}(r.default);t.default=c},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,n)||this;return i._params=t,i.shouldShowCover=function(){return!(!i.coverImage||!i.coverImage.url||i.canPlay())},i.dispose=function(){i.showCoverImage.dispose()},i.media=i._params.media,i.coverImage=i._params.coverImage,i.showCoverImage=ko.computed(i.shouldShowCover),i.showLoadingInfo=i._params.showLoadingInfo||!0,i}return s(t,e),t}(n(274).default);t.default=o},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=n(0),a=n(272),c=n(252),l=".videoPlayer",u=function(e){function t(t,n){var i=e.call(this,n,o.SwiftCardContentType.video)||this;return i._params=t,i.thumbnail=ko.observable(),i.toggleMuteText=function(){var e=i.isMuted()?"videoPlayer_button_unmute":"videoPlayer_button_mute";return r.swc.services.i18n.fetch(e)},i.onVideoEnded=function(){i.touchedByUser=!1,i.isPlaying(!1)},i.getFullscreenButtonText=function(){var e=i.isInFullscreen()?"videoPlayer_exitFullscreen":"videoPlayer_fullscreen";return r.swc.services.i18n.fetch(e)},i.enterFullscreen=function(){i.playerHolder.requestFullscreen?i.playerHolder.requestFullscreen():i.playerHolder.mozRequestFullScreen?i.playerHolder.mozRequestFullScreen():i.playerHolder.webkitRequestFullScreen?i.playerHolder.webkitRequestFullScreen():i.playerHolder.msRequestFullscreen&&i.playerHolder.msRequestFullscreen()},i.onProgress=function(e){},i.exitFullscreen=function(){var e=document;e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.msExitFullscreen&&e.msExitFullscreen()},i.toggleFullscreen=function(){i.touchedByUser=i.isPlaying(),i.isInFullscreen()?i.exitFullscreen():(i.enterFullscreen(),c.default.instance.onEnteringFullscreen(i),i.trackFullscreenAction())},i.trackFullscreenAction=function(){i.wasInFullscreen||(i.wasInFullscreen=!0)},i.dispose=function(){i.fullscreenButtonText.dispose()},i.thumbnail=i._params.thumbnail?t.thumbnail.url:ko.observable(),i.media=i._params.media,i.autoplay=i._params.autoplay,i.autoloop=i._params.autoloop,i.id=i._params.messageId,i.showLoadingInfo=i._params.showLoadingInfo||!0,i.title=i._params.title,i.subtitle=i._params.subtitle,i.displayCurrentTime=i._params.displayCurrentTime,i.displayTotalTime=i._params.displayTotalTime,i.displayMuteButton=i._params.displayMuteButton,i.isMuted=ko.observable(i._params.muted),i.playerHolder=n.querySelector(l),i.isFullscreenSupported=!!(i.playerHolder.requestFullscreen||i.playerHolder.mozRequestFullScreen||i.playerHolder.webkitRequestFullScreen||i.playerHolder.msRequestFullscreen),i.fullscreenButtonText=ko.computed(i.getFullscreenButtonText),i.player&&(i.player.muted=i._params.muted),i._params.autoplay&&(c.default.instance.pauseAll(),i.play()),c.default.instance.registerPlayer(i),i}return s(t,e),t.prototype.toggleMute=function(){this.touchedByUser=!0,this.isMuted()?this.mute(!1):this.mute(!0)},t}(a.default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(5),r=n(2),a=n(149),c=n(7),l=n(0),u=n(14),d=n(378),p=function(){function e(e,t,n,s,d){var p=this;if(this.message=e,this.conversation=t,this.element=s,this.content=ko.observable(),this.imageContent=ko.observable(),this.isAgent=ko.observable(),this.isSystemMsg=ko.observable(),this.showStatus=ko.observable(),this.messageColor=ko.observable(),this.isTranslated=ko.observable(),this.isExtraLargeEmoticon=ko.observable(),this._onMessageFilesUpdate=function(e){var t=function(){p.message.files===e?p._updateFilesList(e):e.unsubscribe(t)};p._updateFilesList(e),e.subscribe(t)},this._onFileDownload=function(e){l.swc.services.amsManager.downloadRawFile(e).then(function(t){if(t){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(t,e.fileName);else{var n=window.URL||l.swcWindow.webkitURL,i=n.createObjectURL(t),s=document.createElement("a");document.body.appendChild(s),s.href=i,s.setAttribute("download",e.fileName),s.click(),n.revokeObjectURL(i)}l.swc.Telemetry.sendEvent.fileAction("DownloadClick",e.fileName,p.message.clientMessageId,p.message.rawMessageType,p.conversation.id,p.conversation.selfParticipant.person.id,p.message.senderId,!p.conversation.isOneOnOne,p.conversation.members.length||p.conversation.participants.length||0)}})},this.dispose=function(){p.message.unsubscribe("content",p.content),p.message.unsubscribe("imageContent",p.imageContent),p.message.unsubscribe("files",p._onMessageFilesUpdate);var e=p.element.querySelector(".filesContainer");e&&i.render(null,e)},this.messageList=n,"waiting_for_replay"===e.content){var h=u.MessageUtils.sanitizeTopic(t.topic);this.content(l.swc.services.i18n.fetch("waitingForReply",{user_name:h}))}else{var f=u.MessageUtils.sanitizeTopic(e.content);o.default.get.isTeams()&&this.conversation.isBRB&&(f=function(e){var t,n=e.indexOf("#bug | Platform: "+r.Configuration.getPlatformId()+" |");(t=n>-1?e.substring(0,n):e)||(t=r.Configuration.BRB_START_MESSAGE);return t}(f)),this.content(f)}var g=u.MessageUtils.sanitizeTopic(e.imageContent);this.imageContent(g),e.subscribe("imageContent",function(e){return p.imageContent(e)}),this.isTranslated(e.isTranslated),e.isTranslated||e.subscribe("content",function(e){var t=u.MessageUtils.sanitizeTopic(e);p.content(t)}),e.subscribe("isTranslated",function(e){p.isTranslated(e),e&&p.message.unsubscribe("content",p.content)}),this.isAgent(this.conversation.isAgent),this.isSystemMsg(this.message.type===c.MessageType.SystemMessage),d&&d.ColorMessage&&e.direction===c.Direction.Incoming&&this.messageColor(d.ColorMessage),this.isExtraLargeEmoticon(a.default.hasLargeEmoticon(this.content())),this._updateFilesList(e.files),e.subscribe("files",this._onMessageFilesUpdate)}return e.prototype._updateFilesList=function(e){if(e&&e.length){var t=this.element.querySelector(".filesContainer"),n={files:e,onDownload:this._onFileDownload},o=s.createElement(d.SwcSharepointFilesList,n);i.render(o,t)}},e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(379);t.SwcSharepointFilesList=i.SwcSharepointFilesList},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(6),a=n(380),c=n(381),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcSharepointFilesList",t}return s(t,e),t.prototype.render=function(){var e=this;return o.createElement("ul",{className:this.getComposedBlockClassName()},this.props.files.map(function(t){var n=function(e){var t;e.fileInfo&&(t=e.fileInfo.fileUrl);return t}(t),i=function(e,t){var n="";if(!function(e){switch(e.fileType){case"jpeg":case"jpg":case"gif":case"png":case"bmp":case"tiff":case"jfif":return!0;default:return!1}}(e))return n;n=e.filePreview&&e.filePreview.previewUrl?e.filePreview.previewUrl:t;return n}(t,n);return i?o.createElement(c.SwcSharepointImage,{key:t.id,className:"swcSharepointFilesList__item swcSharepointFilesList__item_image",previewUrl:i,fileUrl:n,fileId:t.id}):o.createElement(a.SwcSharepointFile,{key:t.id,className:"swcSharepointFilesList__item swcSharepointFilesList__item_file",file:t,onDownload:e.props.onDownload})}))},t}(r.SwcBaseComponent);t.SwcSharepointFilesList=l},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(275),c=n(20),l=n(12),u=n(276),d=n(8),p=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="swcSharepointFile",n._onDownloadClick=function(e,t){t.stopPropagation(),t.preventDefault(),n.props.onDownload(e)},n._onKeyDown=function(e){e.stopPropagation();var t=c.default.getKeyCode(e);t!==l.default.ENTER&&t!==l.default.SPACE||e.target.click()},n.state={status:null},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props.file.id;this.checkFileStatus(e)},t.prototype.render=function(){var e=this.props.file,t=a.getFileIconTypeByExtension(e.fileType);return r.createElement("li",{className:this.getComposedBlockClassName()},r.createElement("a",{className:"swcSharepointFile__link",tabIndex:-1,onClick:o.linkEvent(e,this._onDownloadClick),onKeyDown:this._onKeyDown},r.createElement(d.SwcIcon,{className:"swcSharepointFile__icon",type:t,size:d.SwcIconSize.Medium}),r.createElement("div",{className:"swcSharepointFile__meta"},r.createElement("div",{className:"swcSharepointFile__name"},e.fileName)),!!this.state.status&&r.createElement(u.SwcFileStatus,{className:"swcSharepointFile__status",status:this.state.status})))},t}(n(277).SwcSharepointItemBase);t.SwcSharepointFile=p},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(94),a=n(0),c=n(276),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcSharepointImage",t}return s(t,e),t.prototype.componentDidMount=function(){var e=this.props.fileId;this.checkFileStatus(e)},t.prototype.render=function(){var e=this.props,t=e.fileUrl,n=e.previewUrl,i=this.state.status,s={"background-image":'url("'+n+'")'};return o.createElement("li",{className:this.getComposedBlockClassName()},o.createElement("a",{href:t,className:"swcSharepointImage__link",target:"_blank",rel:"noopener noreferrer",tabIndex:-1,title:a.swc.services.i18n.fetch("message_text_photo"),style:s},!!i&&i!==r.DocumentStatus.Success&&o.createElement(c.SwcFileStatus,{className:"swcSharepointImage__status",status:i})))},t}(n(277).SwcSharepointItemBase);t.SwcSharepointImage=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),s=n(32),o=n(383),r=/(<swiftcard>?[\s\S]*<\/swiftcard>)/i,a=/(?:<swiftcard[\s]+swift=\")([\s\S]*)(?:\">)/i,c=-1,l=function(){return function(e,t){var n=this;this.element=t,this.isDisjoined=!0,this.unsupportedText="Swift is not supported",this.parse=function(e,t,l){var u;if(!/^<swiftcard/i.test(e.content))return c;n.content=e.content;var d=e.content.match(r);if(!d||0===d.length)return c;var p=d[0].replace("><",">$$$<").split("$$$"),h=n.find(p,function(e){return a.test(e)});if(!h)return c;var f,g=h.match(a)[1];try{u=JSON.parse(g)}catch(t){return f=e.content,s.default.dompurify.sanitize(f,{ALLOWED_TAGS:[]})}if(!u)return c;n.swift=new o.default(u,t,e,l),n.customMessageClasses="swiftCard "+(n.swift.isSupported()?i.SwiftCardType[n.swift.type].toLowerCase():"unsupported")+(n.swift.isValid()?"":" invalid")},this.find=function(e,t){var n;for(n=0;n<e.length;++n)if(t(e[n],n,e))return e[n]},this.message=e.message,this.conversation=e.conversation,this.parse(e.message,e.conversation,this.element)===c&&(this.content=this.unsupportedText,this.swift=new o.default({},e.conversation,e.message,this.element))}}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(110),s=n(7),o=n(0),r=n(137),a=n(95),c=n(384),l=n(259),u=n(71),d=function(){return function(e,t,n,d){var p=this;if(this._encoder=new i.Encoder,this.CAROUSEL_WIDTH_DEFAULT=288,this.CAROUSEL_WIDTH_NARROW=204,this.selectedCard=ko.observable(0),this.unsupportedText=o.swc.services.i18n.fetch("s_unsupported"),this.types={Unknown:s.SwiftCardType.unknown,Card:s.SwiftCardType.card,Carousel:s.SwiftCardType.carousel,SignIn:s.SwiftCardType.signin,Receipt:s.SwiftCardType.receipt},this.carouselLeftPosition=function(){var e=p.CAROUSEL_WIDTH_DEFAULT;return r.default.instance.CurrentStyle===r.StyleModes.NARROW&&(e=p.CAROUSEL_WIDTH_NARROW),p.isFirst()?"0px":p.isLast()?"calc("+p.selectedCard()*-e+"px + (100% - "+e+"px))":"calc("+p.selectedCard()*-e+"px + (100% - "+e+"px) / 2)"},this.isSupported=function(){var e=p.cards.every(function(e){return e.isSupported()});return p.isValid()&&p.type!==s.SwiftCardType.unknown&&e},this.isValid=function(){var e=p.cards.every(function(e){return e.isValid()});return!!p.type&&0!==p.cards.length&&e},this.isCarousel=function(){return p.type===s.SwiftCardType.carousel},this.isMultilineCard=function(){return p.type===s.SwiftCardType.multiline},this.nextCard=function(){p.moveTo(p.selectedCard()+1)},this.prevCard=function(){p.moveTo(p.selectedCard()-1)},this.moveTo=function(e){e<0||e>=p.cards.length||(p.selectedCard(e),p.isFirst(0===e),p.isLast(e===p.cards.length-1))},this.moveToCard=function(e){p.moveTo(p.cards.indexOf(e))},this.types["message/card"]=s.SwiftCardType.card,this.types["message/card.carousel"]=s.SwiftCardType.carousel,this.types["message/card.signin"]=s.SwiftCardType.signin,this.types["message/card.receipt"]=s.SwiftCardType.receipt,this.types["message/card.multiline"]=s.SwiftCardType.multiline,e)if(this.content=e.content?u.default.normalizeRichText(e.content):null,this.summary=u.default.normalizeText(e.summary),this.type=e.type?this.types[e.type]:null,this.cards=u.default.mapArray(e.attachments,function(e){return new c.default(e,t,n.senderId,d)}),e.suggestedActions&&e.suggestedActions.actions&&e.suggestedActions.actions.forEach(function(e){e.title&&(e.title=p._encoder.decode(p._encoder.encode(e.title))),n.suggestedActions.pushObservable(new l.default(e,t,n.senderId))}),this.isValid()){if(this.isSupported()||(this.button=new a.default({type:s.SwiftCardActionType.unsupported,title:o.swc.services.i18n.fetch("s_learnMore")},t,n.senderId)),this.areButtonsMultiLine=!this.cards.every(function(e){return e.content&&e.isValid()&&!1===e.content.areButtonsMultiLine}),this.isFirst=ko.observable(!0),this.isLast=ko.observable(1===this.cards.length),this.selectedCard=ko.observable(0),this.isMultiple=ko.observable(this.cards.length>1),this.isMultiple())for(var h=0;h<this.cards.length;h++){var f=this.cards[h];if(f.isValid()&&f.content&&f.content.mainSection)for(var g=0;g<f.content.mainSection.images.length;g++)f.content.mainSection.images[g].isImageInCarousel(!0)}this.prevCardTitle=o.swc.services.i18n.fetch("s_prevCard"),this.nextCardTitle=o.swc.services.i18n.fetch("s_nextCard")}else this.button=new a.default({type:s.SwiftCardActionType.unsupported,title:o.swc.services.i18n.fetch("s_learnMore")},t,n.senderId)}}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),s=n(278),o=function(){return function(e,t,n,o){var r=this;if(this.contentType=i.SwiftCardContentType.unknown,this.content=null,this.isValid=function(){return r.contentType===i.SwiftCardContentType.adaptive||r.contentType!==i.SwiftCardContentType.unknown&&r.content&&r.content.isValid&&r.content.isValid()||r.contentType===i.SwiftCardContentType.unknown},this.isSupported=function(){return r.contentType===i.SwiftCardContentType.adaptive||r.contentType!==i.SwiftCardContentType.unknown&&(!r.content||!!r.content.isSupported&&r.content.isSupported())},this.getContentTypeName=function(){return i.SwiftCardContentType[r.contentType].toLowerCase()},this.convertToCardContentType=function(e,t){if(!e)return i.SwiftCardContentType.unknown;var n=t&&t.media&&t.media[0]&&t.media[0].profile;try{switch(e.toLowerCase()){case"application/vnd.microsoft.card.hero":return i.SwiftCardContentType.hero;case"application/vnd.microsoft.card.thumbnail":return i.SwiftCardContentType.thumb;case"application/vnd.microsoft.card.receipt":return i.SwiftCardContentType.receipt;case"application/vnd.microsoft.card.signin":return i.SwiftCardContentType.signin;case"application/vnd.microsoft.card.video":return i.SwiftCardContentType.video;case"application/vnd.microsoft.card.audio":return i.SwiftCardContentType.audio;case"application/vnd.microsoft.card.flex":return i.SwiftCardContentType.flex;case"application/vnd.microsoft.card.animation":return"video"===n?i.SwiftCardContentType.video:i.SwiftCardContentType.animation;case"application/vnd.microsoft.card.adaptive":return i.SwiftCardContentType.adaptive;default:return i.SwiftCardContentType.unknown}}catch(e){return i.SwiftCardContentType.unknown}},this.contentType=this.convertToCardContentType(e.contentType,e.content),this.content=null,this._conversation=t,e.content)switch(this.contentType){case i.SwiftCardContentType.hero:case i.SwiftCardContentType.thumb:this.content=new s.default(e.content,t,n,this.contentType);break;case i.SwiftCardContentType.signin:this.content=new s.SignInContent(e.content,t,n);break;case i.SwiftCardContentType.receipt:this.content=new s.ReceiptContent(e.content,t,n);break;case i.SwiftCardContentType.audio:case i.SwiftCardContentType.video:case i.SwiftCardContentType.animation:this.content=new s.MediaContent(e.content,t,n,this.contentType);break;case i.SwiftCardContentType.flex:this.content=new s.FlexContent(e.content,t,n,this.contentType);break;case i.SwiftCardContentType.adaptive:this.content=e.content}}}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(71),s=function(){return function(e){var t=this;this.isValid=function(){return!!t.key||!!t.value},this.key=i.default.normalizeRichText(e.key),this.value=i.default.normalizeRichText(e.value)}}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),s=n(112),o=n(71),r=function(){return function(e,t,n,r){var a=this;if(this.isValid=function(){return!!(a.video||a.audio||a.animation||a.animation.url)},this.getSourceDomain=function(e){var t=e.replace(/^(https?:\/\/)?(w*\.)?/i,"");return t?t.split("/")[0]:null},this.url=e.url?o.default.normalizeUrl(e.url):null,this.url)switch(r){case i.SwiftCardContentType.video:this.video=this.url;break;case i.SwiftCardContentType.audio:this.audio=this.url;break;case i.SwiftCardContentType.animation:this.animation=new s.default(e||{},t,n,r)}this.sourceDomain=this.url?this.getSourceDomain(this.url):null}}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),s=n(0),o=n(95),r=n(112),a=n(71),c=n(71),l=function(){return function(e,t,n,l){var u=this;this.expandedText=function(){return""===u.subtitle||""===u.title},this.isValid=function(){return!!u.title||!!u.subtitle||!!u.text||!!u.buttons&&0!==u.buttons.length||u.images&&0!==u.images.length},this.getTitleByType=function(){switch(u.tap.type){case i.SwiftCardActionType.call:case i.SwiftCardActionType.imBack:return u.createSectionTitle();case i.SwiftCardActionType.openUrl:return u.createSectionTitle()+"\n\n"+u.tap.value}return""},this.createSectionTitle=function(){return s.swc.services.i18n.fetch("accessibility_swift_action_prefix",{swiftAction:u.lowerFirstLetter(u.tap.title)})},this.lowerFirstLetter=function(e){return e?e[0].toLowerCase()+e.substring(1):""};var d=new r.default(e.image||{},t,n,l);this._conversation=t,this.title=a.default.normalizeRichText(e.title),this.subtitle=a.default.normalizeRichText(e.subtitle),this.text=a.default.normalizeRichText(e.text),this.price=a.default.normalizeText(e.price),this.images=e.images?c.default.mapImages(e.images,t,n,l):[],0===this.images.length&&e.image&&e.image.url&&this.images.push(d),this.buttons=c.default.filterOutDisabledItems(e.buttons,function(e){return new o.default(e,t,n)}),this.tap=e.tap?c.default.getItemIfNotDisabled(new o.default(e.tap||{},t,n)):null}}();t.default=l},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(111),a=n(7),c=n(0),l=n(14),u=n(15),d=n(278),p="/adaptivecardsv3.min.js",h=/swc:addon:open=([^&]*)/g,f={supportsInteractivity:!0,fontFamily:"Segoe UI",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{fontColors:{default:{normal:"#333333",subtle:"#EE333333"},accent:{normal:"#2E89FC",subtle:"#882E89FC"},good:{normal:"#54a254",subtle:"#DD54a254"},warning:{normal:"#c3ab23",subtle:"#DDc3ab23"},attention:{normal:"#FF0000",subtle:"#DDFF0000"}},backgroundColor:"#FFFFFF"},emphasis:{fontColors:{default:{normal:"#333333",subtle:"#EE333333"},accent:{normal:"#2E89FC",subtle:"#882E89FC"},good:{normal:"#54a254",subtle:"#DD54a254"},warning:{normal:"#c3ab23",subtle:"#DDc3ab23"},attention:{normal:"#FF0000",subtle:"#DDFF0000"}},backgroundColor:"#08000000"}},spacing:{small:3,default:8,medium:20,large:30,extraLarge:40,padding:10},separator:{lineThickness:1,lineColor:"#EEEEEE"},actions:{maxActions:5,spacing:"Default",buttonSpacing:20,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"Emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Left"},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:"maxImageHeight"},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",warp:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",warp:!0},spacing:10}},g=function(e){function t(t,n,i){var s=e.call(this)||this;s.element=i,s._actionHandlers={},s._mapSupportedActionTypes=function(){s._actionHandlers["Action.OpenUrl"]=s.openUrl,s._actionHandlers["Action.ShowCard"]=s.showCard,s._actionHandlers["Action.Http"]=s.httpAction,s._actionHandlers["Action.Submit"]=s.submit,s._actionHandlers.Submit=s.submit},s._processNodes=function(e,t){for(var n=0;n<e.length;n++){var i=e[n];if("p"===i.nodeName)s._processNodes(i.childNodes,t),t.push(250);else if("s"===i.nodeName)s._processNodes(i.childNodes,t),t.push(100);else if("break"===i.nodeName)if(i.attributes.strength){var o=i.attributes.strength.nodeValue;"weak"===o||("medium"===o?t.push(50):"strong"===o?t.push(100):"x-strong"===o&&t.push(250))}else i.attributes.time&&t.push(JSON.parse(i.attributes.time.value));else"audio"===i.nodeName?i.attributes.src&&t.push(i.attributes.src.value):"say-as"===i.nodeName?s._processNodes(i.childNodes,t):"w"===i.nodeName?s._processNodes(i.childNodes,t):"phoneme"===i.nodeName?s._processNodes(i.childNodes,t):t.push(i.nodeValue)}},s._renderContent=function(){s._element.parentElement.insertBefore(s._content,s._element),c.swc.Eventing.triggerEvent(o.ApiEvents.scrollToBottom,s._conversation.id)},s._playSpeech=function(e,t){if(t<e.length){var n=e[t];if("number"==typeof n)setTimeout(function(){s._playSpeech(e,t+1)},n);else if(0===n.indexOf("http"))s._audioContainer.autoplay=!0,s._audioContainer.src=n,s._audioContainer.onended=function(){return s._playSpeech(e,t+1)},s._audioContainer.onerror=function(){return s._playSpeech(e,t+1)},s._audioContainer.play();else{var i=new(0,window.SpeechSynthesisUtterance);if(!c.swcWindow.speechSynthesis||!i)return;i.text=n,i.lang="en-US",i.onerror=function(n){s._playSpeech(e,t+1)},i.onend=function(n){s._playSpeech(e,t+1)},c.swcWindow.speechSynthesis.speak(i)}}},s.executeAction=function(e){if(e&&!e.stop){var t=e.type||e.title,n=s._actionHandlers[t];!n&&e.url&&(n=s._actionHandlers["Action.OpenUrl"]),n&&"function"==typeof n&&n(e)}},s.openUrl=function(e){if(e.url){if(e.url.match(/^skype:\?payments/));else{if(e.url.match(h))return void("overlay"===h.exec(e.url)[1]&&c.swc.Eventing.triggerEvent("swc:addon:open",{id:s._conversation.id,url:e.url}));e.url.match(/^skype:/)}window.open(e.url,"_blank").opener=null}},s.submit=function(e){if(!e.data)return null;var t={value:JSON.stringify({userSubmitData:e.data}),title:""};return s._conversation.sendSwift(t).then(function(){return Promise.resolve()}).catch(function(){})},s.isValid=function(){return!!s._content},s.isSupported=function(){return s.isValid()},s._element=s.element,s._conversation=n,s._audioContainer=document.createElement("audio");var r=u.UrlHelper.getVendorPath()+p;return c.swcWindow.AdaptiveCards?(s._adaptiveCard=c.swcWindow.AdaptiveCards,s._render(t)):c.swc.scriptLoader.addScript(r,null,function(){s._adaptiveCard=c.swcWindow.AdaptiveCards,s._render(t)}),s}return s(t,e),t.prototype._render=function(e){if(e&&this._adaptiveCard){e.version=e.version||"1.0",e.body&&(e.body=e.body.filter(function(e){return e.text&&(e.text=r.default.parse(e.text),e.text=l.MessageUtils.getMessageSanitizedContent(e.text)),e}));var t=new this._adaptiveCard.AdaptiveCard;t.hostConfig=new this._adaptiveCard.HostConfig(f),t.onExecuteAction=this.executeAction,t.parse(e),this._content=t.render(),this.type=a.SwiftCardContentType.adaptive,this._mapSupportedActionTypes(),this._renderContent()}},t.prototype.showCard=function(e){},t.prototype.httpAction=function(e){},t.ready=!1,t}(d.BaseContent);t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(0),o=n(20),r=n(12),a=function(){function e(e,t){this.myLanguage=ko.observable(),this.theirLanguage=ko.observable(),this.callToAction=ko.observable(),this.they_are_speaking=ko.observable(s.swc.services.i18n.fetch("they_are_speaking",{theirLanguage:this.theirLanguage()})),this.you_are_speaking=ko.observable(s.swc.services.i18n.fetch("you_are_speaking",{myLanguage:this.myLanguage()})),this.onKeyDown=function(e,t){var n=o.default.getKeyCode(t);n!==r.default.ENTER&&n!==r.default.SPACE||t.target.click()},this.myLanguage(i.default.get.translationLanguages[navigator.language.split("-")[0]].name),this.theirLanguage(i.default.get.translationLanguages[i.default.get.translationLanguage].name),this.callToAction("Start translation?")}return e.prototype.activateTranslation=function(){this.callToAction("")},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(25),o=n(93),r=n(29),a=n(0),c=function(){function e(e,t){var n=this;this.loggedIn=ko.observable(),this.nameClicked=ko.observable(!1),this.isAgent=ko.observable(!0),this.isGuest=ko.observable(!0),this.displayName=ko.observable(),this.say_hi=ko.observable(a.swc.services.i18n.fetch("say_hi")),this.or_text=ko.observable(a.swc.services.i18n.fetch("or_text")),this.sign_in_text=ko.observable(a.swc.services.i18n.fetch("sign_in_text")),this.to_save_your_chat=ko.observable(a.swc.services.i18n.fetch("to_save_your_chat")),this.welcome_back_text=ko.observable(a.swc.services.i18n.fetch("welcome_back_text")),this.click_here_text=ko.observable(a.swc.services.i18n.fetch("click_here_text")),this.to_switch_accounts=ko.observable(a.swc.services.i18n.fetch("to_switch_accounts")),this.title=ko.observable(),this.disableLogout=ko.observable(),this.dispose=function(){a.swc.services.signInManager.unsubscribe("isSignedIn",n.onAppReadyStateChange),a.swc.services.mePersonManager.mePerson&&a.swc.services.mePersonManager.mePerson.unsubscribe("displayName",n.onDisplayNameChange)},this.onDisplayNameChange=function(){n.setGreetingMessage()},this.onAppReadyStateChange=function(){n.welcomeMsgHandler()},this.isGuestOnlyMode=i.default.get.isGuestOnlyMode,this._conversation=t,this.say_hi_to_bot_aria=a.swc.services.i18n.fetch("say_hi_to_a_bot"),this.sign_in_to_save_chat_aria=a.swc.services.i18n.fetch("sign_in_to_save_your_chat"),this.click_here_to_switch_accounts_aria=a.swc.services.i18n.fetch("click_here_to_switch_accounts_aria_label"),this.msg_hi=a.swc.services.i18n.fetch("hi"),a.swc.services.signInManager.subscribe("isSignedIn",this.onAppReadyStateChange),a.swc.services.mePersonManager.mePerson.subscribe("displayName",this.onDisplayNameChange),this.isAgent(t.isAgent),this.isGuest(a.swc.services.mePersonManager.mePerson.isGuest),this.welcomeMsgHandler(),this.setGreetingMessage(),this.getConversationTitle(),this.disableLogout(this._conversation.definition.DisableLogout)}return e.prototype.getConversationTitle=function(){var e=this;if(""!==this._conversation.topic||this._conversation.isGroup)this.title(this._conversation.topic),this._conversation.subscribe("topic",function(t){e.title(t)});else{var t=a.swc.services.persons.getPerson(this._conversation.id,!0);t.displayName===t.id&&a.swc.services.signInManager.getSkypeToken().then(function(n){a.swc.services.signInManager.state===s.SigninState.SignedIn&&e._subscribeToDisplayName(t)}).catch(function(n){a.swc.services.signInManager.state===s.SigninState.SignedIn?e._subscribeToDisplayName(t):a.swc.services.signInManager.subscribe("state",function(){a.swc.services.signInManager.state===s.SigninState.SignedIn&&(e._subscribeToDisplayName(t),t.fetchDisplayNameAndAvatar())})})}},e.prototype._subscribeToDisplayName=function(e){var t=this;e.displayName&&this._handleDisplayName(e),e.subscribe("displayName",function(){return t._handleDisplayName(e)})},e.prototype._handleDisplayName=function(e){this.title(e.displayName===e.id?"":e.displayName)},e.prototype.signin=function(){a.swc.services.signInManager.login()},e.prototype.sendHi=function(){this._conversation.sendMessage(this.msg_hi,o.ActionTrigger.WELCOME_MESSAGE)},e.prototype.nameClick=function(){this._conversation.definition.DisableLogout||this.nameClicked(!0)},e.prototype.signout=function(){this.nameClicked(!1),a.swc.services.signInManager.logout("welcome")},e.prototype.welcomeMsgHandler=function(){a.swc.services.signInManager.userIdentityType!==r.IdentityType.GUEST?this.loggedIn(a.swc.services.signInManager.state!==s.SigninState.SignedOut):this.loggedIn(!1)},e.prototype.setGreetingMessage=function(){var e=a.swc.services.mePersonManager.mePerson;this.displayName(e.displayName)},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(273),o=n(20),r=n(12),a="tabindex",c="role";!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(i||(i={}));var l=function(){function e(e,t){var n=this;this.container=e,this.dispose=function(){n.removeListeners()},this.onMouseDown=function(){n.clicked=!0},this.onMouseUp=function(){n.clicked=!1},this.onFocus=function(e){var t=e.target;if(n.elementIsContainer(t)){var i=n.getItemsInList();i.length&&(n.controlElementSelectable(n.container),n.setItemTabIndexes(),n.clicked||(-1!==i.indexOf(n.focusedElement)?n.focusElement(n.focusedElement):n.options.selectLastItem?n.focusElement(i[i.length-1]):n.focusElement(i[0])))}else n.clicked&&(n.clicked=!1)},this.onBlur=function(e){var t=e.target;setTimeout(function(){var e,i=n.getItemsInList();e=h(t),n.elementIsContainer(t)||-1!==i.indexOf(e)||d(n.container)})},this.onKeyDown=function(e){var t,s=o.default.getKeyCode(e);if(function(e){var t=o.default.getKeyCode(e);return e.shiftKey&&t===r.default.F10}(e))!function(e){var t=p(e.target).createEvent("MouseEvents"),n=e.target.getBoundingClientRect();e.preventDefault(),e.stopPropagation(),t.initMouseEvent("contextmenu",!0,!1,window,0,0,0,n.right,n.top,!1,!1,!0,!1,2,null),e.target.dispatchEvent(t)}(e);else{if(function(e,t){return(e===r.default.ENTER||e===r.default.SPACE)&&f(t)}(s,n.focusedElement)&&n.focusedElement.click(),function(e,t){return e===r.default.TAB&&!!t}(s,n.focusedElement))if(n.selectSubsequentChild(e.shiftKey?i.Backward:i.Forward))return e.preventDefault(),void e.stopPropagation();(function(e){return[r.default.LEFT,r.default.UP,r.default.RIGHT,r.default.DOWN,r.default.HOME,r.default.END].indexOf(e)>-1})(s)&&(t=n.getItemsInList(),n.setItemTabIndexes(),e.preventDefault(),e.stopPropagation(),s===r.default.LEFT||s===r.default.UP?n.selectSubsequentItem(i.Backward,t,e):s===r.default.RIGHT||s===r.default.DOWN?n.selectSubsequentItem(i.Forward,t,e):s===r.default.HOME?n.selectFirstItem(t):s===r.default.END&&n.selectLastItem(t))}},this.options={selectLastItem:!!t.selectLastItem,itemSelector:t.itemSelector||""},d(e),this.setItemTabIndexes(),this.addListeners()}return e.prototype.setItemTabIndexes=function(){var e=this;this.getItemsInList().forEach(function(t){e.controlElementSelectable(t)})},e.prototype.getItemsInList=function(){return u(this.container.querySelectorAll(this.options.itemSelector))},e.prototype.controlElementSelectable=function(e){this.elementIsContainer(e)||e.setAttribute(c,"listitem"),e.setAttribute(a,"-1")},e.prototype.elementIsContainer=function(e){return e===this.container},e.prototype.addListeners=function(){this.container.addEventListener(s.default.events.browser.FOCUS,this.onFocus,!0),this.container.addEventListener(s.default.events.browser.BLUR,this.onBlur,!0),this.container.addEventListener(s.default.events.browser.KEYDOWN,this.onKeyDown),this.container.addEventListener(s.default.events.browser.MOUSEDOWN,this.onMouseDown),this.container.addEventListener(s.default.events.browser.MOUSEUP,this.onMouseUp)},e.prototype.removeListeners=function(){this.container.removeEventListener(s.default.events.browser.FOCUS,this.onFocus,!0),this.container.removeEventListener(s.default.events.browser.BLUR,this.onBlur,!0),this.container.removeEventListener(s.default.events.browser.KEYDOWN,this.onKeyDown),this.container.removeEventListener(s.default.events.browser.MOUSEDOWN,this.onMouseDown),this.container.removeEventListener(s.default.events.browser.MOUSEUP,this.onMouseUp)},e.prototype.selectSubsequentItem=function(e,t,n){var i=t[t.indexOf(n.target)];if(i)do{if(!(i=t[t.indexOf(i)+e]))break;this.focusElement(i)}while(!f(i));else this.options.selectLastItem?this.selectLastItem(t):this.selectFirstItem(t)},e.prototype.selectSubsequentChild=function(e){var t=u(this.focusedElement.querySelectorAll("[tabindex]")),n=t[t.indexOf(h(this.focusedElement))];do{if(!(n=t[t.indexOf(n)+e]))break;n.focus()}while(!f(n));return!!n},e.prototype.selectFirstItem=function(e){this.focusElement(e[0])},e.prototype.selectLastItem=function(e){this.focusElement(e[e.length-1])},e.prototype.focusElement=function(e){e.focus&&e.focus(),this.focusedElement=e},e}();function u(e){return Array.prototype.slice.call(e)}function d(e){e.setAttribute(c,"application"),e.setAttribute(a,"0")}function p(e){return e.ownerDocument}function h(e){return p(e).activeElement}function f(e){return e===h(e)}t.KBNav=l,t.default={register:function(){ko.bindingHandlers.keyboardNavigation={init:function(e,t){var n=new l(e,t());ko.utils.domNodeDisposal.addDisposeCallback(e,n.dispose)}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(0),r=n(26),a=function(){return function(e){var t=this;this.conversations=e,this.count=ko.observable(0),this.expanded=ko.observable(!1),this.buttonTitle=ko.pureComputed(function(){return t.expanded()?o.swc.services.i18n.fetch("hide_collapsed_chats"):o.swc.services.i18n.fetch("show_collapsed_chats")}),this.toggleExpand=function(e,n){t.expanded(!t.expanded()),setTimeout(function(){var e=n.target.parentElement.querySelector("ul");e&&e.focus()})},this.appendAvatarVM=function(e,t,n){if(e&&e.nodeType===Node.ELEMENT_NODE){var o=document.createDocumentFragment(),a={customAvatar:n.chatDataConfig.Avatar,customTitle:n.chatDataConfig.Title,conversation:n.conversation},c=s.createElement(r.SwcConversationAvatar,a);i.render(c,o),e.insertBefore(o,e.firstChild)}},this.conversationsList=this.conversations.conversationsList,this.conversationsList.subscribe(function(){t.count(t.conversationsList().length)})}}();t.ConversationsListVM=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(20),o=n(12),r="/views/imgpsh_fullsize",a=function(){function e(e,t,n,a){var u=this;this.message=e,this._conversation=t,this.thumbnailUrl=ko.observable(),this.onImgKeyDown=function(e,t){var n=s.default.getKeyCode(t);n!==o.default.ENTER&&n!==o.default.SPACE||t.target.click()},this.downloadImage=function(){var e=null,t=!!navigator.msSaveOrOpenBlob,n=c(u.message.content),s=l(u.message.content);s&&-1===s.indexOf(r)?s+=r:s="https://api.asm.skype.com/v1/objects/"+n+r,u._conversation.download(s)||(t||(e=window.open("","_blank")),i.swc.services.amsManager.downloadPicture(n).then(function(n){t?navigator.msSaveOrOpenBlob(n,function(e){var t=e.match(/<LwcImage[^>]*?\sfilename=\"([^"]+?)\"/i);if(!t)return null;var n=t[1];return n.substr(n.lastIndexOf("/")+1)}(u.message.content)):e.location.href=s}))},this.messageList=n,e.subscribe("content",function(e){u.onContentUpdate(e)}),this.onContentUpdate(e.content)}return e.prototype.onContentUpdate=function(e){var t=this,n=c(e);n&&i.swc.services.amsManager.downloadPictureThumbnail(n).then(function(e){var n=(window.URL||i.swcWindow.webkitURL).createObjectURL(e);t.thumbnailUrl(n)})},e}();function c(e){var t=l(e);return t?t.substr(t.lastIndexOf("/")+1):null}function l(e){var t=e.match(/<LwcImage[^>]*?\surl=\"([^"]+?)\"/i);return t?t[1]:null}t.ImageMessageVM=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),s=n(395),o=n(279);t.getMessageViewModel=function(e,t,n,r){return e.type===i.MessageType.LwcFile?new s.BaseFileMessage(e,t,n,r):new o.BaseMessage(e,t,n,r)}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(94),r=n(7),a=n(0),c=n(92),l=n(275),u=n(279),d=function(e){function t(t,n,i,s){var o=e.call(this,t,n,i,s)||this;return o.displaySize=ko.observable(),o.originalName=ko.observable(),o.downloaded=ko.observable(!1),o.title=ko.observable(),o.icon=ko.observable(),o.directionIcon='<span class="swcIcon swcIcon_settingsGeneral"></span>',o.statusText=ko.observable(),o.statusIcon=ko.observable(),o.downloadText=a.swc.services.i18n.fetch("message_text_download"),o.isMyNewMessage=!1,o._retryFileSend=function(){a.swc.services.amsManager.retryFileUpload(o.conversation,o.documentId),o.updateFileStatus(o.documentId)},o.downloadFile=function(){o.conversation.download(o.url)||a.swc.services.amsManager.downloadFileByDocumentId(o.documentId).then(function(e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(e,o.fullName);else{var t=a.swcWindow.URL||a.swcWindow.webkitURL,n=t.createObjectURL(e),i=document.createElement("a");document.body.appendChild(i),i.href=n,i.setAttribute("download",o.fullName),i.click(),t.revokeObjectURL(n)}o.downloaded(!0),o.sendDlTelemetry()})},o.isMyNewMessage=t.direction===r.Direction.Outgoing&&t.status===r.DeliveryStatus.Pending,t.subscribe("content",function(e){clearTimeout(o.statusTimeout),o.statusTimeout=void 0,o.onContentUpdate(e)}),o.onContentUpdate(t.content),o}return s(t,e),t.prototype.onContentUpdate=function(e){var t=function(e){var t=function(e){var t=e.match(/<LwcFile[^>]*?\surl=\"([^"]+?)\"/i);if(!t)return null;var n=t[1];return n.substr(n.lastIndexOf("/")+1)}(e);if(!t)return{size:0,name:null,url:null,extension:"",documentId:""};var n=e.match(/<LwcFile[^>]*?\ssize=\"([\d]+?)\"/i),i=n&&parseInt(n[1],10)||0,s=e.match(/<LwcFile[^>]*?\soriginalName=\"([^"]+?)\"/i),o=s?s[1]:null,r=e.match(/<LwcFile[^>]*?\surl=\"([^"]+?)\"/i),a=r?r[1]:null,l=c.getNameAndExtension(o),u=l.name,d=l.extension;return{size:i,name:u,url:a,extension:d,documentId:t}}(e);this.displaySize(function(e){var t=0;for(;e>=1024;)e/=1024,t++;return Math.floor(e)+" "+["Bytes","KB","MB","GB"][t]}(t.size)),this.originalName(t.name),this.url=t.url,this.documentId=t.documentId,this.fullName=t.name+"."+t.extension;var n=function(e){var t=a.swc.services.i18n.fetch("message_text_file_type",{ext:e.toUpperCase()}),n='<span class="swcIcon '+l.getFileIconTypeByExtension(e)+'"></span>';switch(e){case"xls":case"xlsx":t="Excel";break;case"doc":case"docx":t="Word";break;case"ppt":case"pptx":t="PowerPoint";break;case"one":t="OneNote";break;case"pdf":t="PDF";break;case"vdx":case"vsd":case"vsdx":t="Visio"}return{icon:n,title:t}}(t.extension);this.title(n.title),this.icon(n.icon),this.isMyNewMessage&&this.updateFileStatus(this.documentId)},t.prototype.updateFileStatus=function(e){var t=this;a.swc.services.amsManager.getFileStatus(e).then(function(n){t.documentId===e&&(n.uploadStatus!==o.DocumentStatus.InProgress&&n.uploadStatus!==o.DocumentStatus.ScanInProgress||(t.statusTimeout=setTimeout(function(){t.updateFileStatus(e)},2e3)),t.setUploadStatus(n.uploadStatus))}).catch(function(){t.documentId===e&&t.setUploadStatus(o.DocumentStatus.Failed)})},t.prototype.setUploadStatus=function(e){var t=a.swc.services.i18n,n="",i="";switch(e){case o.DocumentStatus.Failed:n=this.isMyNewMessage?t.fetch("message_text_upload_failed"):t.fetch("message_text_error"),i='<span class="swcIcon swcIcon_error"></span>';break;case o.DocumentStatus.ScanInProgress:n=t.fetch("message_text_scanning"),i='<div class="swcSpinner swcSpinner_small"></div>';break;case o.DocumentStatus.InProgress:n=t.fetch("message_text_uploading"),i='<div class="swcSpinner swcSpinner_small"></div>';break;case o.DocumentStatus.Malware:n=t.fetch("message_text_malware"),i='<span class="swcIcon swcIcon_error"></span>';break;case o.DocumentStatus.Success:n=this.isMyNewMessage?t.fetch("message_text_upload_complete"):"",i=this.isMyNewMessage?'<span class="swcIcon swcIcon_ok"></span>':""}this.uploadStatus=e,this.statusText(n),this.statusIcon(i)},t.prototype.getMessageActions=function(){var t=e.prototype.getMessageActions.call(this);return this.isMyNewMessage&&this.uploadStatus===o.DocumentStatus.Failed&&t[0].items.push({title:a.swc.services.i18n.fetch("message_text_retry"),group:1,action:this._retryFileSend}),t},t.prototype.sendDlTelemetry=function(){a.swc.Telemetry.sendEvent.fileAction("DownloadClick",this.fullName,this.message.clientMessageId,this.message.rawMessageType,this.conversation.id,this.conversation.selfParticipant.person.id,this.message.senderId,!this.conversation.isOneOnOne,this.conversation.members.length||this.conversation.participants.length||-1)},t}(u.BaseMessage);t.BaseFileMessage=d},function(e,t){e.exports='<div class="conversationsList" data-bind="visible: count()">\r\n    <ul data-bind="foreach: { data: conversationsList, as: \'item\', afterAdd: appendAvatarVM },\r\n        visible: expanded, click: toggleExpand, keyboardNavigation: { itemSelector: \'li\' }">\r\n        <li data-bind="click: show">\r\n            <p class="title" data-bind="text: item.title()"></p>\r\n        </li>\r\n    </ul>\r\n    <button class="expand" aria-haspopup="true"\r\n            data-bind="click: toggleExpand, css: {expanded: expanded()}, attr: {title: buttonTitle()}">\r\n        <span>+<span class="title" data-bind="text: count()"></span></span>\r\n    </button>\r\n</div>\r\n'},function(e,t){e.exports='\x3c!-- ko if: !isDeletedMessage() --\x3e\r\n    <div class="message" role="presentation" data-bind="css: classNames,\r\n    attr: {\'data-messageType\': type}, event: { contextmenu: openMessageActions }">\r\n        <div class="headerAvatar" aria-label="avatar" tabindex="-1"\r\n        data-bind="click: navigateToChat.bind(null, senderId), event: { keydown: onAvatarKeyDown }, visible: showAuthor()"></div>\r\n        <div class="authorAndContent">\r\n            <div class="messageInfo" data-bind="visible: showMessageInfo">\r\n                <span class="author" data-bind="text: author, visible: showAuthor()"></span>\r\n                <span class="timestamp"\r\n                    data-bind="text: timestamp, visible: !showStatus() && showTimestamp()"></span>\r\n            </div>\r\n            <div class="bubble" data-bind="style:{ \'max-height\': contentLimitValue }">\r\n                <div class="messageType" data-bind="component: {\r\n                    name: type.toLowerCase(),\r\n                    params: {\r\n                        message: $data.message,\r\n                        conversation: $data.conversation,\r\n                        meUserName: $parent.meUserName,\r\n                        suggestedActions: $parent.suggestedAction,\r\n                        messageListElement: messageListElement\r\n                    }\r\n                }"></div>\r\n            </div>\r\n            <div class="buttons">\r\n                <button tabindex="-1" class="button seemore" data-bind="click: seeMore">\r\n                    <span class="normal">See All </span>\r\n                    <span class="swcIcon swcIcon_chevronDown" aria-hidden="true"></span>\r\n                </button>\r\n                <button tabindex="-1" class="button seeless" data-bind="click: seeLess">\r\n                    <span class="normal">See Less </span>\r\n                    <span class="swcIcon swcIcon_chevronUp" aria-hidden="true"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="sendingStatus" data-bind="text: status(), visible: showStatus(),\r\n            css: { sending: showStatus() }"></div>\r\n    </div>\r\n\x3c!-- /ko --\x3e\r\n'},function(e,t){e.exports="<div class=\"swift\">\r\n    \x3c!-- ko if: !swift.isSupported() --\x3e\r\n        \x3c!-- ko template: { name: 'swiftUnsupported', data: swift } --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: swift.isSupported() --\x3e\r\n        \x3c!-- ko if: swift.isCarousel() --\x3e\r\n            \x3c!-- ko template: { name: 'swiftCarouselCard', data: swift } --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: !swift.isCarousel() && !swift.isMultilineCard()--\x3e\r\n            \x3c!-- ko template: { name: 'swiftSingleCard', data: swift } --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: swift.isMultilineCard() --\x3e\r\n        \x3c!-- ko template: { name: 'swiftMultilineCard', data: swift } --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n"},function(e,t){e.exports="\x3c!-- DO NOT REMOVE - Adaptive Card template holder --\x3e\r\n"},function(e,t){e.exports='<div class="lwx-message">\r\n    <div class="PictureWrapper">\r\n        <div class="PictureSharing">\r\n            <a class="thumbnailHolder" data-bind="click: downloadImage, event: { keydown: onImgKeyDown }" target="_blank" tabindex="-1">\r\n                \x3c!-- ko if: thumbnailUrl --\x3e\r\n                <span class="thumbnail" data-bind="style: {backgroundImage: \'url(\\\'\' + thumbnailUrl() + \'\\\')\'}"></span>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko ifnot: thumbnailUrl --\x3e\r\n                <span class="thumbnail"></span>\r\n                \x3c!-- /ko --\x3e\r\n            </a>\r\n        </div>\r\n        <reactions-bar class="reactionsBar" params="message: message, messageListElement: messageList"></reactions-bar>\r\n    </div>\r\n    \x3c!-- ko if: $parent.showEditedIcon --\x3e\r\n    <span class="edit messageBtn" data-bind="attr:{\'aria-label\': $parent.editedMessageText, title: $parent.editedMessageText}">\r\n        <span class="swcIcon swcIcon_topic" aria-hidden="true"></span>\r\n    </span>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showMessageActions() --\x3e\r\n    <div class="actionsContainer">\r\n        <button tabindex="-1" class="messageBtn deleteAction" data-bind="click: $parent.openDeleteMsgConfirmationDialog,\r\n        attr: {title: $parent.deleteMessageHeader}">\r\n            <span class="swcIcon swcIcon_delete" aria-hidden="true"></span>\r\n        </button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<div class="lwx-message">\r\n    <div class="previewWithMeta">\r\n        <div class="meta">\r\n            <div class="name" data-bind="text: $parent.originalName, attr: {title: $parent.originalName}"></div>\r\n            <div class="status">\r\n                <span class="size" data-bind="text: $parent.displaySize, attr: {title: $parent.displaySize}"></span>\r\n                <span class="status-text" data-bind="text: $parent.statusText, attr: {title: $parent.statusText}"></span>\r\n                <span class="status-icon" data-bind="html: $parent.statusIcon"></span>\r\n            </div>\r\n            <div class="type">\r\n                <span class="type-icon" data-bind="html: $parent.icon"></span>\r\n                <span class="type-title" data-bind="text: $parent.title, attr: {title: $parent.title}"></span>\r\n                <span class="type-direction-icon" data-bind="html: $parent.directionIcon"></span>\r\n            </div>\r\n        </div>\r\n        <button tabindex="-1" aria-label="download file" class="download" data-bind="click: $parent.downloadFile, text: $parent.downloadText"></button>\r\n    </div>\r\n\r\n    \x3c!-- ko if: $parent.showMessageActions() --\x3e\r\n    <div class="actionsContainer">\r\n        <button tabindex="-1" class="messageBtn deleteAction" data-bind="click: $parent.openDeleteMsgConfirmationDialog,\r\n        attr: {title: $parent.deleteMessageHeader}">\r\n            <span class="swcIcon swcIcon_delete" aria-hidden="true"></span>\r\n        </button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<div class="action">\r\n    \x3c!-- ko ifnot: loggedIn --\x3e\r\n        <div class="callToAction">\r\n            \x3c!-- ko if: isAgent --\x3e\r\n            <button class="sayhi" tabindex="-1" data-bind="click: sendHi,\r\n            text: say_hi,\r\n            attr: {\'aria-label\': say_hi_to_bot_aria}"></button>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko ifnot: isGuestOnlyMode --\x3e\r\n            <span data-bind="text: or_text()"></span>\r\n            <span class="signin">\r\n            <button tabindex="-1" data-bind="click: signin,\r\n                text: sign_in_text,\r\n                attr: {\'aria-label\': sign_in_to_save_chat_aria}"></button>\r\n                <span data-bind="text: to_save_your_chat"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: loggedIn --\x3e\r\n        <div>\r\n            <span data-bind="text: welcome_back_text"></span><button data-bind="attr:{ \'title\':displayName }, text:displayName, click: nameClick, css: {nameClicked: nameClicked, disableLogout: disableLogout}" tabindex="-1"></button>!\r\n        </div>\r\n        \x3c!-- ko if: nameClicked --\x3e\r\n        <div>\r\n        <button class="signin" tabindex="-1" data-bind="click: signout,\r\n            text: click_here_text, attr: { \'title\': click_here_to_switch_accounts_aria }"></button>\r\n        <span data-bind="text: to_switch_accounts"></span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t){e.exports='<div class="skypeLogo">\r\n    <skype-logo></skype-logo>\r\n</div>\r\n'},function(e,t){e.exports='<div class="unread-splitter" data-bind="html: message.content"></div>\r\n'},function(e,t){e.exports='<div class="lwx-message">\r\n    <div class="content" data-bind="html: content,\r\n        style:{ backgroundColor:messageColor, background: messageColor },\r\n        css: { sticker: isExtraLargeEmoticon, bot: isAgent }"></div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="message welcome">\r\n    <skype-logo></skype-logo>\r\n    <div data-bind="html: they_are_speaking()">\r\n    </div>\r\n    <div data-bind="html: you_are_speaking()">\r\n    </div>\r\n    <div>\r\n        <a tabindex="-1" data-bind="click:activateTranslation, text: callToAction, event: { keydown: onKeyDown }"></a>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="audioPlayer">\r\n    \x3c!-- ko if: showCoverImage() --\x3e\r\n    <div class="coverHolder">\r\n        <img class="thumbnail" data-bind="attr: { src: coverImage.url, alt: coverImage.alt, width: coverImage.uiSize().width, height: coverImage.uiSize().height },\r\n                style: { left: coverImage.leftAlignment() + \'px\', bottom: coverImage.bottomAlignment() + \'px\' }" />\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="loader" data-bind="visible: isLoading()"></div>\r\n    <div class="error" data-bind="visible: failed()">\r\n        <span class="swcIcon swcIcon_error"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="controlsOverlay" data-bind="click: togglePlay"></div>\r\n\r\n    <audio class="player" data-bind="attr: { src: media, loop: autoloop}, click: togglePlay,\r\n            event: {canplay: onReady, error: onError, loadedmetadata: onMetadataLoaded, timeupdate: onTimeUpdated, ended: onAudioEnded}"></audio>\r\n\r\n    <div class="playerControls" data-bind="visible: canPlay">\r\n\r\n        <button data-bind="click: togglePlay, attr: {title: playButtonText}"\r\n                class="button" type="button">\r\n            \x3c!-- ko if: isPlaying() --\x3e\r\n            <span class="swcIcon swcIcon_pause"></span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isPlaying() --\x3e\r\n            <span class="swcIcon swcIcon_play"></span>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n\r\n        <div class="timeline" data-bind="click: onTimelineClick">\r\n            <div class="timers">\r\n                <div class="currentTime" data-bind="text: currentTime"></div>\r\n                <div class="totalTime" data-bind="text: totalTime"></div>\r\n            </div>\r\n            <div class="totalProgress"></div>\r\n\r\n            <div class="progress" data-bind="attr: {style: currentProgress}">\r\n                <div class="handle" data-bind="event: {mousedown: onHandleStartDrag}"></div>\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="videoPlayer">\r\n\r\n    <div class="fullsreenInfo" data-bind="visible: isInFullscreen">\r\n        \x3c!-- ko if: subtitle --\x3e\r\n        <h2 data-bind="text: subtitle, attr: { title: subtitle }"></h2>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: title --\x3e\r\n        <h1 data-bind="text: title, attr: { title: title }"></h1>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="loader" data-bind="visible: isLoading()"></div>\r\n    <div class="error" data-bind="visible: failed()">\r\n        <span class="swcIcon swcIcon_error"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="controlsOverlay" data-bind="click: togglePlay"></div>\r\n\r\n    <video class="player" data-bind="attr: { src: media, loop: autoloop, autoplay: autoplay}, click: togglePlay,\r\n            event: {onprogress: onProgress, canplay: onReady, error: onError, loadedmetadata: onMetadataLoaded, timeupdate: onTimeUpdated, ended: onVideoEnded}">\r\n    </video>\r\n\r\n    <div class="playerControls" data-bind="visible: canPlay">\r\n\r\n        <button data-bind="click: togglePlay, attr: {title: playButtonText}"\r\n                class="button" type="button">\r\n            \x3c!-- ko if: isPlaying() --\x3e\r\n            <span class="swcIcon swcIcon_pause"></span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isPlaying() --\x3e\r\n            <span class="swcIcon swcIcon_play"></span>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n\r\n        \x3c!-- ko if: displayCurrentTime --\x3e\r\n        <div class="currentTime" data-bind="text: currentTime"></div>\r\n        \x3c!-- /ko  --\x3e\r\n\r\n        <div class="timeline" data-bind="click: onTimelineClick">\r\n            <div class="totalProgress"></div>\r\n            <div class="progress" data-bind="attr: {style: currentProgress}">\r\n                <div class="handle" data-bind="event: {mousedown: onHandleStartDrag}"></div>\r\n            </div>\r\n        </div>\r\n\r\n        \x3c!-- ko if: displayTotalTime --\x3e\r\n        <div class="totalTime" data-bind="text: totalTime"></div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: displayMuteButton --\x3e\r\n        <button data-bind="click: toggleMute, attr: {title: toggleMuteText()}"\r\n                class="button" type="button">\r\n            \x3c!-- ko if: isMuted() --\x3e\r\n            <span class="swcIcon swcIcon_volumeOff"></span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isMuted() --\x3e\r\n            <span class="swcIcon swcIcon_volumeMax"></span>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isFullscreenSupported --\x3e\r\n        <button data-bind="click: toggleFullscreen, attr: {title: fullscreenButtonText}"\r\n                class="button toggleFullscreen" type="button">\r\n            \x3c!-- ko if: isInFullscreen() --\x3e\r\n            <span class="swcIcon swcIcon_contract"></span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isInFullscreen() --\x3e\r\n            <span class="swcIcon swcIcon_expand"></span>\r\n            \x3c!-- /ko --\x3e\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="gifPlayer">\r\n    \x3c!-- ko if: showCoverImage() --\x3e\r\n    <div class="coverHolder">\r\n        <img class="thumbnail" data-bind="attr: { src: coverImage.url(), alt: coverImage.alt, width: coverImage.uiSize().width, height: coverImage.uiSize().height },\r\n                style: { left: coverImage.leftAlignment() + \'px\', bottom: coverImage.bottomAlignment() + \'px\' }" />\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="loader" data-bind="visible: isLoading()"></div>\r\n    <div class="error" data-bind="visible: failed()">\r\n        <span class="swcIcon swcIcon_error"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: media --\x3e\r\n    <img data-bind="visible: canPlay(),\r\n            attr: { src: media.url,\r\n                alt: media.alt,\r\n                width: media.uiSize().width,\r\n                height: media.uiSize().height\r\n            }, style: { left: media.leftAlignment(),\r\n                bottom: media.bottomAlignment()\r\n            },\r\n            event: { load: onReady, error: onError }" />\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),s=n(5),o=n(0),r=n(39),a=n(86),c=n(411),l=n(65),u="width: 300px; height: 47px; position: relative;",d="width: 300px; height: 450px; position: relative;",p=function(){function e(){this._resolveCallbacks=[],this._rejectCallbacks=[]}return e.prototype.add=function(e,t){this._resolveCallbacks.push(e),this._rejectCallbacks.push(t)},e.prototype.resolve=function(e){this._resolveCallbacks.forEach(function(t){return t(e)})},e.prototype.reject=function(){this._rejectCallbacks.forEach(function(e){return e()})},e}(),h=function(){function e(e){var t=this;this._conversations={},this._asyncConversationRequests={},this._stageCapacity=1,this._minWidth=1,this._activeCount=0,this._maxStageCapacity=4,this.viewports=[],this._onVisibilityChange=function(e){var n=t.get(e.key);if(n){var i=e.isVisible&&n.onStage;!n.alwaysOnStage&&n.stashed&&t._pop(e.key),e.isVisible?i||(n.alwaysOnStage&&r.isInIframe()&&t._recountStage(!0),t._moveToStage(n)):t._removeFromStage(e.key),i||(t._recountStage(),t._stored&&(t._moveToStage(t._stored),t._stored=null))}},this._onResize=function(){t._recountStage()},this._removeFromStage=function(e,n){var i,s;e?s=e:t.forEach(function(e,t){!e.alwaysOnStage&&e.onStage&&(i?e.displayedAt<=i&&(i=e.displayedAt,s=t):(i=e.displayedAt,s=t))});var o=t.get(s);return r.isInIframe()&&t.removeFromViewport(o),o.onStage=!1,t._activeCount--,o.model.isActive=!1,o},this._pop=function(e){if(!t._conversationsList)return null;var n,i=e;if(i||t.forEach(function(e,t){e.stashed&&(n?e.displayedAt>=n&&(n=e.displayedAt,i=t):(n=e.displayedAt,i=t))}),i){var s=t.get(i);return s.stashed=!1,s.container.style.display="flex",t._conversationsList.remove(s.vm),s}return null},this._stash=function(e){if(!t._conversationsList){t._conversationsList=new c.ConversationsList;var n=document.createElement("div");if(n.innerHTML="\x3c!-- ko component: {name: 'conversations-list', params: {conversations: conversations}} --\x3e\x3c!-- /ko --\x3e",ko.applyBindings({conversations:t._conversationsList},n),t._conversationsListContainer=n.firstElementChild,s.default.get.theme&&(t._theme=s.default.get.theme,t._conversationsListContainer.classList.add(t._theme)),t._bindTheme(),t.listViewport)t.listViewport.document.body.appendChild(n);else{var i=t._container||document.body;i.insertBefore(t._conversationsListContainer,i.childNodes[0])}}r.isInIframe()&&e.container&&document.body.appendChild(e.container),e.stashed=!0,e.container.style.display="none",t._conversationsList.add(e.vm)},this._bindTheme=function(){return s.default.get.subscribe("theme",function(e){var n=t._conversationsListContainer.classList;t._theme&&n.remove(t._theme),e&&n.add(e),t._theme=e})},this._toggleCollapse=function(e){var n=t.get(e),i=n&&n.container;if(i){var s=i.classList,o=s.contains("collapsed");o?s.remove("collapsed"):s.add("collapsed");var r=n.viewport;r&&t._parallelView&&t._viewports.update(r,{classes:s.value.split(" "),attrs:{style:o?d:u},active:!!o})}},this._container=e.container,this._minWidth=e.minWidth,o.swc.Eventing.registerEvent(i.ApiEvents.OnVisibilityChange,this._onVisibilityChange),this._addListeners(),this._viewports=o.swc.services.viewports}return Object.defineProperty(e.prototype,"baseParent",{get:function(){return this._container},set:function(e){this._container=e,this._recountStage()},enumerable:!0,configurable:!0}),e.prototype.forEach=function(e){for(var t in this._conversations)if(this._conversations.hasOwnProperty(t)){var n=this._conversations[t];e.call(n,n,t)}},e.prototype.add=function(e,t){var n=this;if(!this._conversations[e]){this._conversations[e]=t;var i=this._asyncConversationRequests[e];i&&(i.resolve(t),delete this._asyncConversationRequests[e])}var s=t.vm;s&&s.isCollapsed.subscribe(function(){return n._toggleCollapse(e)})},e.prototype.get=function(e){return this._conversations[e]},e.prototype.getAsync=function(e){var t=this;return new Promise(function(n,i){var s=t.get(e);s?n(s):(t._asyncConversationRequests[e]||(t._asyncConversationRequests[e]=new p),t._asyncConversationRequests[e].add(n,i),setTimeout(function(){var n=t._asyncConversationRequests[e];n&&(delete t._asyncConversationRequests[e],n.reject())},6e4))})},e.prototype.setContainer=function(e,t){var n=this.get(e);n&&(n.container=t)},e.prototype.dispose=function(){var e=this;this.forEach(function(t,n){var i=t.model;t.stashed?e._pop(n):e._removeFromStage(n),i&&i.dispose(),delete e._conversations[n]})},e.prototype._addListeners=function(){this._windowResizeHandler=l(this._onResize,200),window.addEventListener("resize",this._windowResizeHandler),o.swc.services.notificationsManager.setOpenedConversations(this._conversations)},e.prototype.createViewports=function(e,t,n){var i=this;this._parallelView=n.ParallelView,this._parallelView&&e++;for(var s=[],o=function(e){var n=e||!r._parallelView?"conversation":"conversationsList",o=e?{attrs:{style:"display: none;"},classes:["swcChat__frame"]}:{attrs:r._parallelView?{style:"display: none;"}:{style:"display: block;"},classes:r._parallelView?["conversationsList"]:["swcChat__frame","lwc-chat-frame"]};s.push(r._viewports.create({type:n,group:"messaging"},o).then(function(n){var s=n.document.body;e?s.style.margin="0":i._parallelView?s.setAttribute("style","display: flex; justify-content: flex-end; height: 100%; width: 100%; flex-direction: column; align-items: flex-end;"):n.document.body.parentElement.className="swc-chat";var o=[];if(t)for(var r=0,c=t;r<c.length;r++){var l=c[r];o.push(a.StyleLoader.addStyle(l,n.document))}return Promise.all(o).then(function(){e||!i._parallelView?i.viewports.push(n):i._parallelView&&(i.listViewport=n)})}))},r=this,c=0;c<e;c++)o(c);return Promise.all(s)},e.prototype.addToViewport=function(e){for(var t=0,n=this.viewports;t<n.length;t++){var i=n[t],s=i.document.body;if(!s.firstElementChild)return e.container&&(s.appendChild(e.container),e.viewport=i,this._parallelView&&this._viewports.update(i,{attrs:{style:d},active:!0}),o.swc.services.pesManager.refresh()),!0}return!1},e.prototype.removeFromViewport=function(e){this._parallelView&&(document.body.appendChild(e.container),this._viewports.update(e.viewport,{attrs:{style:"display: none;"},active:!1}),e.viewport=null)},e.prototype._moveToStage=function(e){e&&(this._currentConversation=e,e.onStage||(e.onStage=!0,e.model.isActive=!0,this._activeCount++),e.displayedAt=Date.now(),e.container.style.display="",r.isInIframe()?this.addToViewport(e)||(document.body.appendChild(e.container),this._stored=e):this._container&&(this._container.contains(e.container)||this._container.appendChild(e.container)),e.vm.isCollapsed(!1),o.swc.Eventing.triggerLocalEvent("viewRestored",e.model.id))},e.prototype._getOuterWidth=function(e){var t=e.offsetWidth,n=window.getComputedStyle(e,null),i=parseInt(n.maxWidth,10)||0;return(t=t<i?i:t)+(parseInt(n.marginLeft,10)||0)+(parseInt(n.marginRight,10)||0)},e.prototype._recountStage=function(e){if(this._conversations&&this._activeCount){if(this._container){var t=this._container.clientWidth;this._stageCapacity=t/(this._minWidth||this._getOuterWidth(this._currentConversation.container))}this._maxStageCapacity?Math.min(this._stageCapacity,this._maxStageCapacity):this._stageCapacity;4;var n=Math.floor(4)-this._activeCount;if(e&&n<1&&n--,n<0)for(var i=0;i>n;i--)this._stash(this._removeFromStage());else if(n>0)for(i=0;i<n;i++)this._moveToStage(this._pop());if(this.listViewport){var s=this._conversationsList&&this._conversationsList.count?{attrs:{style:"width: 240px; height: 450px; position: relative;"},active:!0}:{attrs:{style:"display: none;"},active:!0};this._viewports.update(this.listViewport,s)}}},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.conversationsList=ko.observableArray()}return e.prototype.add=function(e){return this.conversationsList.push(e)},e.prototype.remove=function(e){return this.conversationsList.remove(e)},e.prototype.shift=function(){return this.conversationsList.shift()},Object.defineProperty(e.prototype,"count",{get:function(){return this.conversationsList().length},enumerable:!0,configurable:!0}),e}();t.ConversationsList=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(11),o=n(413),r=n(432),a=n(433),c=n(436),l=n(437),u=n(284),d=n(439),p=n(440),h=n(441),f=n(442),g=n(285),v=function(){function e(){}return e.register=function(e){this.isInitialized||(ko.components.register("messages-list",{viewModel:{createViewModel:function(e,t){return new a.default(e,t.element)}},template:n(445),synchronous:!0}),ko.components.register("typing-indicator",{viewModel:{createViewModel:function(e){return new r.default(e.conversation)}},template:n(446),synchronous:!0}),ko.components.register("conversation",{viewModel:{createViewModel:function(t,n){return new o.default(t,e,n.element)}},template:n(447),synchronous:!0}),ko.components.register("lwc-signin",{viewModel:{createViewModel:function(t,n){return new c.default(t,e,n.element)}},template:n(448),synchronous:!0}),ko.components.register("new-chat",{viewModel:{createViewModel:function(t,n){return i.default.get.backend===s.MessagingBackend.TEAMS?new d.default(e,n.element):new u.default(e,n.element)}},template:n(449),synchronous:!0}),ko.components.register("add-participants",{viewModel:{createViewModel:function(e,t){return new l.default(e,t.element)}},template:n(450),synchronous:!0}),ko.components.register("remove-participants",{viewModel:{createViewModel:function(e,t){return new p.default(e,t.element)}},template:n(451),synchronous:!0}),ko.components.register("chat-search-input",{viewModel:{createViewModel:function(t,n){return new f.default(t,e,n.element)}},template:n(452),synchronous:!0}),ko.components.register("chat-search-results",{viewModel:{createViewModel:function(t,n){return new g.default(t,e,n.element)}},template:n(453),synchronous:!0}),ko.components.register("reactions-bar",{viewModel:{createViewModel:function(e,t){return new h.default(e.message,e.messageListElement,t.element)}},template:n(454),synchronous:!0}),this.isInitialized=!0)},e.unregister=function(){ko.components.unregister("messages-list"),ko.components.unregister("conversation"),ko.components.unregister("new-chat"),ko.components.unregister("chat-search-input"),ko.components.unregister("chat-search-results"),ko.components.unregister("add-participants"),ko.components.unregister("remove-participants"),ko.components.unregister("reactions-bar"),this.isInitialized=!1},e.isInitialized=!1,e}();t.default=v},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=n(3),o=n(1),r=n(4),a=n(5),c=n(2),l=n(68),u=n(25),d=n(36),p=n(93),h=n(29),f=n(70),g=n(34),v=n(166),m=n(27),_=n(133),y=n(152),w=n(7),b=n(153),C=n(32),E=n(63),S=n(88),I=n(118),T=n(38),P=n(0),x=n(414),k=n(89),A=n(41),O=n(150),M=n(146),N=n(9),L=n(92),D=n(16),R=n(31),U=n(109),F=n(14),B=n(62),j=n(22),H=n(15),V=n(151),z=n(26),W=n(415),G=n(427),K=n(8),q=n(428),Y=n(135),$=n(429),X=n(147),Q=n(431),J=n(65),Z=function(e,t){return P.swc.services.i18n.fetch(e,t)},ee="swc-calling",te="./calling-popup.html",ne="width=640, height=480, menubar=no, status=no, titlebar=no, toolbar=no, rel=noopener noreferrer",ie="/sdk/v1/",se="sdk",oe="js",re=1e3,ae=",";function ce(){var e=P.swc.services.localStorage.getItem(T.SWC_SFB_DISMISSED_KEY);return e?e.split(ae):[]}var le=function(){function e(e,t,n){var i=this;this._params=e,this.chatDataConfig=t,this._element=n,this.showComponent=ko.observable(!1),this.isCollapsed=ko.observable(!1),this.title=ko.observable(),this.avatarUrl=ko.observable(""),this.brandMessage=ko.observable(""),this.showBrand=ko.observable(!0),this.isAgent=ko.observable(!1),this.signedIn=ko.observable(!0),this.showLoginPage=ko.observable(!1),this.privacyStatement=ko.observable(),this.termOfUse=ko.observable(),this.showTermsOfUse=ko.observable(),this.showPrivacyStatement=ko.observable(),this.isPickerVisible=ko.observable(!1),this.pesConfigInitialized=ko.observable(!1),this.userMessageSent=ko.observable(!1),this.isGuest=ko.observable(!0),this.showCalling=ko.observable(!1),this.showOtherActions=ko.observable(!0),this.suppressCallingControls=ko.observable(!1),this.audioEnabled=ko.observable(!0),this.videoEnabled=ko.observable(!0),this.animateLoginScreen=ko.observable(!0),this.canAddParticipants=ko.observable(!0),this.showAddParticipants=ko.observable(!1),this.showRemoveParticipants=ko.observable(!1),this.showShowParticipants=ko.observable(!1),this.isMePersonGuest=ko.observable(!0),this.showMoreActionsBtn=ko.observable(!1),this.isParticipantControlEnabled=ko.observable(!1),this.unreadMessageCounter=ko.observable(0),this.participantsCount=ko.observable(""),this.participantsCountLabel=ko.observable(""),this.isTitleFocused=ko.observable(!1),this.titleColor=ko.observable(""),this.titleBackground=ko.observable(""),this.correlationId=D.guid.generate(),this.ms_service_privacy_agreement=ko.observable(""),this._callingPopup=null,this.isTypingProxied=!1,this.proxy={},this._proxiedIsChatEnabled=!0,this._canSendEmoticons=!0,this._canUploadFile=!0,this._showCallingWarning=!1,this._showSfbWarning=!1,this._onIsBlockedChange=function(e){e?i.showCalling(!1):i.setCallingCapabilities(),i.conversation.isChatEnabled=!e,i.conversation.isGroup||i._updatePersonBlockedState(i.conversation.id,e)},this._onAlertsOffChange=function(e){e?i.unreadMessageCounter(-1):i.unreadMessageCounter(i.conversation.unreadMessagesCount)},this._onParticipantsUpdate=function(){if(i.conversation.isGroup&&!i.conversation.isOneOnOne){var e=i._hasMyselfParticipant(i.conversation.participants);e&&i._enableGroupConversation(),i._showMoreActionButton(e),i._updateParticipantsCountLabels(i.conversation.participants.length)}i.onConversationUpdate()},this._showMoreActionButton=function(e){a.default.get.isTeams()?!i.isOneOnOneConversation()&&e?i.showMoreActionsBtn(!0):i.showMoreActionsBtn(!1):i.showMoreActionsBtn(!0)},this._byTimestamp=function(e,t){return t.originalTimestamp.getTime()>e.originalTimestamp.getTime()?-1:1},this.onConversationUpdate=function(){var e=i.conversation.definition.Prefill,t=i._proxiedPlaceholder||i.conversation.definition.InputPlaceholder||a.default.get.inputPlaceholderOverride||Z("area_text_insertText"),n=i.conversation.participants.map(function(e){return e.person.mri}),s=P.swc.services.signInManager.isAadSupported()?P.swc.services.userService.then(function(e){return e.getUsers(n)}):Promise.resolve([]);Promise.all([P.swc.services.capabilitiesService.getCapabilitiesForConversation(i.conversation),s]).then(function(n){var s=n[0],o=n[1],r=i._proxiedIsChatEnabled&&s.allowChat,a=!1,c=i.getInitialChatInputProps(),l=c.canSendEmoticons,u=c.canUploadFile;r?P.swc.services.signInManager.isAadSupported()&&(a=o.some(function(e){return!e.featureSettings.isPrivateChatEnabled}))&&(t=i.conversation.isOneOnOne?Z("teams_admin_chat_disabled"):Z("teams_admin_chat_disabled_group"),l=!1,u=!1):t=Z("area_text_disabled"),i._canSendEmoticons=l&&s.allowSendEmoticons&&(i.pesConfigInitialized()||P.swc.services.pesManager.isInitialized),i._canUploadFile=u&&r&&s.allowUploadFiles,i.updateChatInput({isChatEnabled:r&&!a,isEditingEnabled:r&&s.allowEditMessage,canSendEmoticons:i._canSendEmoticons,canUploadFile:i._canUploadFile,placeholder:t,prefillText:e})})},this._enableGroupConversation=function(){i.conversation.isChatEnabled=!0,i.isParticipantControlEnabled(!0),i.setCallingCapabilities()},this.onClicked=function(){return P.swc.Eventing.triggerLocalEvent(r.ApiEvents.hideBubbleWindow),!0},this._getMoreActions=function(){var e=[{items:[],id:"conversationOptions"}];return i.conversation.isTeamsOneOnOne||(i.conversation.isGroup?i._hasMyselfParticipant(i.conversation.participants)&&e[0].items.push(U.default.createMenuItem({title:Z("roster_menu_leave_conversation"),action:i.openLeaveConversation})):i.conversation.isBlocked?e[0].items.push(U.default.createMenuItem({title:Z("roster_menu_unblock_contact"),action:i.openUnblockContact})):e[0].items.push(U.default.createMenuItem({title:Z("roster_menu_block_contact"),action:i.openBlockContact}))),a.default.get.isTeams()||e[0].items.push(U.default.createMenuItem({title:Z("roster_menu_delete_conversation"),action:i.openDeleteConversation})),e},this._removeMeParticipantFromModel=function(){for(var e=0;e<i.conversation.participants.length;e++){i.conversation.participants[e].person.id===P.swc.services.mePersonManager.mePerson.id&&i.conversation.participants.spliceObservable(e,1)}},this.openDeleteConversation=function(e){var t=Z("confirm_dialog_delete_conversation_header"),n=Z("confirm_dialog_delete_conversation_text"),s=Z("btn_confirm_deletion"),o=Z("sign_in_cancel"),a={actionConfirm:function(){var e=Date.now();i.conversation.deleteConversation().then(function(t){P.swc.Eventing.triggerLocalEvent(r.ApiEvents.RemoveAllMessagesFromUi,i.conversation.id),P.swc.Telemetry.sendEvent.conversationRemoved(S.createConversationEvent(i.conversation),"delete",i.conversation.members.length||i.conversation.participants.length||-1,Date.now()-e,t.status),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.DeleteConversation)},function(e){}).then(function(){if(i.conversation.isGroup){var e=function(){Y.ConfirmationDialog.remove(),P.swc.Eventing.triggerLocalEvent(r.ApiEvents.OnConversationDelete,i.conversation.id),i.close()};i.conversation.members.filter(function(e){return P.swc.services.mePersonManager.isMe(e.id)}).length>0&&1!==i.conversation.members.length?i._removeMeParticipant().then(function(){e()}):e()}else P.swc.Eventing.triggerEvent(r.ApiEvents.OnConversationDelete,i.conversation.id),i.conversation.messages.length&&i.conversation.messages.spliceObservable(0,i.conversation.messages.length),Y.ConfirmationDialog.remove(),i.close()})},actionCancel:function(){}};Y.ConfirmationDialog.add(i._element,i.createConfirmationDialog(t,n,s,o,a),X.TextDialog)},this.openLeaveConversation=function(e){var t=Z("sign_in_cancel"),n={actionConfirm:function(){i._removeMeParticipant().then(Y.ConfirmationDialog.remove)},actionCancel:function(){}};Y.ConfirmationDialog.add(i._element,i.createConfirmationDialog(i.deleteConversationTitle,i.deleteConversationText,i.deleteConversationConfirmTitle,t,n),X.TextDialog)},this.openBlockContact=function(e){var t=Z("confirm_dialog_block_contact_header"),n=Z("are_you_sure"),s=Z("btn_confirm_blocking");Y.ConfirmationDialog.add(i._element,i.createReportAbuse(t,n,s,function(e,t){var n=Date.now();P.swc.services.contactsManager.blockContact(i.conversation.id,e,t).then(function(s){P.swc.Telemetry.sendEvent.contactBlock("block",s.status,Date.now()-n,e,t),Y.ConfirmationDialog.remove(),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.BlockUser),P.swc.services.persons.getPerson(i.conversation.id).isBlocked=!0},function(e){}),P.swc.services.webApi.setBlockedConversation(i.conversation.id,!0)}),$.BlockDialog)},this.openUnblockContact=function(e){var t=Date.now();P.swc.services.contactsManager.unblockContact(i.conversation.id).then(function(e){P.swc.Telemetry.sendEvent.contactBlock("unblock",e.status,Date.now()-t),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.UnblockUser),P.swc.services.persons.getPerson(i.conversation.id).isBlocked=!1},function(e){}),P.swc.services.webApi.setBlockedConversation(i.conversation.id,!1)},this.openMoreActions=function(e,t){var n=U.default.createMenuList(i._getMoreActions(),"rosterMenuList");t.stopPropagation(),V.default.add(i._element.querySelector(".rosterMenuListBtn"),i._element,n,V.BubbleType.List)},this._renderAvatar=function(e){void 0===e&&(e=""),i.avatarUrl(e),s.render(null,i._avatarContainer);var t={customAvatar:e,customTitle:i.chatDataConfig.Title,conversation:i.conversation,className:i.isAgent()?"bot":""},n=o.createElement(z.SwcConversationAvatar,t);s.render(n,i._avatarContainer)},this.onUnreadMessageCount=function(e){i.conversation.alertsOff||(i.unreadMessageCounter(e),P.swc.Eventing.triggerEvent(r.ApiEvents.UpdateUnreadMessageCounter,{convId:i.convId,count:e}))},this.controlShowHandler=function(e){e.currentConversationId&&R.default.toFullIdentifier(e.currentConversationId)===i.conversation.id?(i.conversation.isControlOpen=!0,i.conversation.unreadMessagesCount=0,i.triggerFocusInputEvent()):i.conversation.isControlOpen=!1},this.openAddon=function(e){var t={"swc:addon:close":function(e){e.message&&i.conversation.sendMessage(e.message,p.ActionTrigger.ADDON),e.invokeData&&i.conversation.sendDataToBot(e.invokeData)}};new x.default(i._element,e.url,t).show()},this.onCalleeUnavailable=function(e){if(e.mri===i.conversation.id){var t=e.withVideo?".actionsbar .calling.video":".actionsbar .calling.audio",n=document.createElement("span");n.textContent=Z("callee_unavailable"),V.default.add(i._element.querySelector(t),i._element,n,V.BubbleType.Info)}},this.callStatusChangedHandler=function(e){var t=7!==e.status;i.suppressCallingControls(t),e.conversationId===i.conversation.id&&t?(i.canClose(!1),i.toggleChatSize(null,null,!0)):i.canClose(i.chatDataConfig.CanClose)},this.callingLayoutChangedHandler=function(e){"minimize"===e.action&&e.mri===i.conversation.id&&i.triggerFocusInputEvent()},this.controlHideHandler=function(e){e.currentConversationId===i.conversation.id&&(i.conversation.isControlOpen=!1)},this.openAddParticipantsView=function(){P.swc.Telemetry.sendEvent.userAction(E.UserActionType.AddParticipant),i.showAddParticipants(!0),i._addParticipantsNode&&i._addParticipantsNode.firstChild&&!i._addParticipantsVM&&(i._addParticipantsVM=ko.dataFor(i._addParticipantsNode.firstChild)),i._addParticipantsVM&&i._addParticipantsVM.triggerFocusToSearch(),P.swc.Eventing.triggerEvent(r.SearchEvents.SEARCH_CREATE_CONTACTLIST,i.correlationId)},this.closeAddParticipantsView=function(){i.showAddParticipants(!1)},this._joinOrCreateConversation=function(e){var t=function(e){k.default.startChat(e,i.chatDataConfig,!1,f.OpenChatOrigin.ADD_PARTICIPANTS_TEAMS)},n=function(e){var n=e.headers.get("location").match(/threads\/(19:.*)$/)[1];t(n),i.closeAddParticipantsView()},s=function(e){},o=e.concat(i.conversation.members);_.findRecentConversationIdForMembers(o).then(function(e){t(e),i.closeAddParticipantsView()}).catch(function(e){P.swc.services.webApi.createThread(o).then(n,s)})},this._addToExistingConversation=function(e){e.forEach(function(e){e.id&&i.conversation.addParticipant(e.id)}),i.closeAddParticipantsView()},this.addParticipantsToConversation=function(e){a.default.get.isTeams()&&i.conversation.isOneOnOne?i._joinOrCreateConversation(e):i._addToExistingConversation(e)},this.openShowParticipantsView=function(){i.showShowParticipants(!0),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.Participants)},this.closeShowParticipantsView=function(){i.showShowParticipants(!1)},this.openRemoveParticipantsView=function(){i.showRemoveParticipants(!0),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.Participants)},this.closeRemoveParticipantsView=function(){i.showRemoveParticipants(!1)},this.removeParticipantsFromConversation=function(e){e.forEach(function(e){i.conversation.removeParticipant(e)}),i.closeRemoveParticipantsView()},this.init=function(){var e=function(e){i.isGuest(P.swc.services.signInManager.userIdentityType===h.IdentityType.GUEST),i.updateSignedInState(),e===u.SigninState.SignedIn&&i.setCallingCapabilities()};P.swc.services.signInManager.subscribe("state",e),P.swc.Eventing.registerEvent(r.ApiEvents.ForceExpandChat,function(e){(!a.default.get.isParallelView||a.default.get.isParallelView&&e===i.conversation.id)&&(i.isCollapsed(!1),P.swc.services.webApi.startEndpointActivation())}),e(P.swc.services.signInManager.state),i._initConversation()},this.onDragEnter=function(e,t){var n=i._canProcessDropEvent(t);return i._handleDragEventEvent(t,n)},this.onDragOver=function(e,t){return i._handleDragEventEvent(t,i._canProcessDropEvent(t))},this.onDragLeave=function(){},this.onDrop=function(e,t){if(i._canProcessDropEvent(t)){var n=[];t.dataTransfer&&t.dataTransfer.files?n=t.dataTransfer.files:t.originalEvent.dataTransfer&&(n=t.originalEvent.dataTransfer.files),i.sendFiles(n)}return i._allowCustomHandling(t)},this.dispose=function(){i._idSubscription&&i._idSubscription.dispose();var e=i.conversation;if(e){e.unsubscribe("unreadMessagesCount",i.onUnreadMessageCount),e.unsubscribe("alertsOff",i._onAlertsOffChange),e.unsubscribe("isChatEnabled",i.onConversationUpdate),e.unsubscribe("isUnderQuarantine",i.onConversationUpdate),e.unsubscribe("definition",i.onConversationUpdate),e.unsubscribe("isOneOnOne",i.isOneOnOneConversation),e.unsubscribe("isBlocked",i._onIsBlockedChange);var t=e.participants;t&&t.unsubscribe(i._onParticipantsUpdate)}},this._isJoinLink=function(e){return e.indexOf("https")>-1},this._initConversation=function(){i._isJoinLink(i.conversation.id)||i._changeConversation(i.conversation)},this.subscribeToAvatar=function(e,t){i.conversation.isGroup?i.conversation.subscribe("avatar",i._renderAvatar):(e.avatarData&&i._renderAvatar(e.avatarData),e&&e.subscribe("avatarData",function(e){t===i.conversation.id&&i._renderAvatar(e)}))},this.setupProxy=function(){var e=function(e){return e===i.conversation.id},t=i.conversation.refId,n=r.ApiEvents.conversationProxy;P.swc.Eventing.registerEvent(n.expand,function(t){e(t.id)&&i.toggleChatSize(null,null,!0)}),P.swc.Eventing.registerEvent(n.regClose,function(e){e.refId===t&&(i.proxy.close={handler:function(){return P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resClose,{refId:t})},preventDefault:!!e.preventDefault})}),P.swc.Eventing.registerEvent(n.regCollapse,function(t){e(t.id)&&(i.conversation.refId=t.refId,i.proxy.toggle={handler:function(){return P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resCollapse,{refId:i.conversation.refId,isCollapsed:!i.conversation.isControlOpen})},preventDefault:!!t.preventDefault})}),P.swc.Eventing.registerEvent(n.showConfirmationDialog,function(t){var n=function(e){P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resShowConfirmationDialog,{CID:t.dialog.CID,res:e})};if(e(t.id)){var s={actionConfirm:function(){n(v.DialogResult.CONFIRMED)},actionCancel:function(){n(v.DialogResult.CANCELED)}};Y.ConfirmationDialog.add(i._element,i.createConfirmationDialog(t.dialog.title,t.dialog.description,t.dialog.confirmationButtonTitle,t.dialog.cancelButtonTitle,s),X.TextDialog)}}),P.swc.Eventing.registerEvent(n.regUnreadCount,function(t){e(t.id)&&(i.refId=i.refId||t.refId,i.conversation.subscribe("unreadMessagesCount",function(e){P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.unreadCount,{refId:i.refId,count:e})}))}),P.swc.Eventing.registerEvent(n.regAvatar,function(t){if(e(t.id)){i.refId=i.refId||t.refId;var n="";if(i.conversation.isGroup)n=i.conversation.avatar,i.conversation.subscribe("avatar",function(e){P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resAvatar,{refId:i.refId,avatarUrl:e})});else{var s=P.swc.services.persons.getPerson(i.conversation.id);n=s.avatarData,s.subscribe("avatarData",function(e){P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resAvatar,{refId:i.refId,avatarUrl:e})})}P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resAvatar,{refId:i.refId,avatarUrl:n})}}),P.swc.Eventing.registerEvent(n.regTitle,function(t){if(e(t.id)){if(i.refId=i.refId||t.refId,i.conversation.isGroup)i.conversation.subscribe("topic",function(e){P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resTitle,{refId:i.refId,title:e})});else{var n=P.swc.services.persons.getPerson(i.conversation.id);n.subscribe("displayName",function(e){var t=n.isAgent&&n.displayName===n.id?"":n.displayName;P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resTitle,{refId:i.refId,title:t})})}P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resTitle,{refId:i.refId,title:i.conversation.topic})}}),P.swc.Eventing.registerEvent(n.regPresenceStatus,function(t){if(e(t.id)&&(i.refId=i.refId||t.refId,!i.conversation.isGroup)){var n=P.swc.services.persons.getPerson(i.conversation.id);P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resPresenceStatus,{refId:i.refId,presenceStatus:n.presenceStatus}),n.subscribe("presenceStatus",function(e){P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resPresenceStatus,{refId:i.refId,presenceStatus:e})})}}),P.swc.Eventing.registerEvent(n.toggleEmoticonPicker,function(e){e.open?i.toggleExpressionPickerHandler(e.id,e.open):i.hideExpressionPickerHandler(e.id)}),P.swc.Eventing.registerEvent(n.setMessageProperties,function(t){if(e(t.id)){var n="";t.props&&(i.conversation.currentMessageProperties=t.props,t.props.tags&&(n=O.default.explode(t.props.tags).join(" "))),i.updateChatInput({tags:n})}}),P.swc.Eventing.registerEvent(n.setInputPlaceholder,function(t){e(t.id)&&(i._proxiedPlaceholder=t.text,i.onConversationUpdate())}),P.swc.Eventing.registerEvent(n.regIsTyping,function(t){e(t.id)&&(i.conversation.refId=t.refId,i.isTypingProxied=!0)}),P.swc.Eventing.registerEvent(n.disableInput,function(t){e(t.id)&&(i._proxiedIsChatEnabled=!t.disable,i.onConversationUpdate())}),P.swc.Eventing.registerEvent(n.setActionBar,function(t){if(e(t.id)){var s=t.definition.map(function(e){return{name:e.name,text:e.text,title:e.title,handler:function(){return P.swc.Eventing.triggerEvent(n.resActionBar,e.CID)},className:e.className}});i.initActionBar(s)}}),P.swc.Eventing.registerEvent(n.setInputText,function(t){e(t.id)&&(i.conversation.definition.Prefill=t.text,i.updateChatInput({prefillText:void 0}),i.updateChatInput({prefillText:t.text}))}),m.ProxyConnector.instance.connect(i.conversation.refId,{conversationId:i.conversation.id})},this.hideExpressionPickerHandler=function(e){i.conversation.id===e&&i.hideExpressionPicker()},this.toggleExpressionPickerHandler=function(e,t){i.conversation.id!==e||i.isPickerVisible()?t||i.isPickerVisible(!1):(i.isPickerVisible(!0),P.swc.Eventing.triggerEvent(r.ExpressionPickerEvents.OPEN_PICKER),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.ExpressionPicker))},this.sendFiles=function(e){for(var t=0;t<e.length;t++){var n=e[t],s=L.checkFile(n,{size:i._fileSize,extensions:i._extensions,types:i._types});s.supportedFileSize&&s.supportedFileExtension&&s.supportedFileType?P.swc.services.amsManager.sendFile(i.conversation,n):P.swc.Eventing.triggerEvent(r.ApiEvents.UnsupportedFileSelected,{fileName:n.name,fileSize:n.size,supportedFileSize:s.supportedFileSize,supportedFileExtension:s.supportedFileExtension,supportedFileType:s.supportedFileType})}},this.isSupportedBrowser=j.default.testSupporedList(c.Configuration.ECS.callingSupportedBrowsers),this.isIeEngine=j.default.isIe(),this.conversation=this._params.conversation,this.convId=R.default.getNormalizeId(this.conversation.id),this.enable=this._params.enable,this._avatarContainer=n.querySelector(".swc-header .headerAvatar"),this.canClose=ko.observable(t.CanClose),this.closeWindow=Z("close_window"),this.minimizeWindow=ko.pureComputed(function(){return i.isCollapsed()?Z("maximize_window"):Z("minimize_window")}),this.startAudioCalling=Z("start_audio_calling"),this.startVideoCalling=Z("start_video_calling"),this.openRemoveParticipants=Z("open_remove_participants"),this.openAddParticipants=Z("open_add_participants"),this.openShowParticipants=Z("open_show_participants"),this.openMoreActionsText=Z("open_more_actions"),t.TitleColor&&this.titleColor(t.TitleColor),t.TitleBackground&&this.titleBackground(t.TitleBackground);var d=encodeURIComponent(this.chatDataConfig.Locale||c.Configuration.LOCALE);this._setContent(d),this._params.enable()?this.init():this._params.enable.subscribe(function(e){return e&&i.init()}),!a.default.get.callingReady&&this.chatDataConfig.EnableCalling&&P.swc.Eventing.registerEvent(r.ApiEvents.CallingReady,function(){i.setCallingCapabilities()}),this.showBrand(!M.default.isDomainIn("hideLogoOnHosts")),this.suppressCallingControls(l.default.isInCall),this.conversation.subscribe("unreadMessagesCount",this.onUnreadMessageCount),this.conversation.subscribe("alertsOff",this._onAlertsOffChange),this.conversation.subscribe("isChatEnabled",this.onConversationUpdate),this.conversation.subscribe("isUnderQuarantine",this.onConversationUpdate),this.conversation.subscribe("definition",this.onConversationUpdate),this._setAcceptedFiles();var g=this.getInitialChatInputProps(),y=g.canSendEmoticons,C=g.canUploadFile;this._canSendEmoticons=y,this._canUploadFile=C,this._chatInputProps={canSendEmoticons:this._canSendEmoticons,canUploadFile:this._canUploadFile,conversationId:this.conversation.id,isChatEnabled:!0,isEditingEnabled:!0,acceptedFiles:this._accepted,placeholder:"",prefillText:this.conversation.definition.Prefill,tags:"",message:null,onSendFiles:this.sendFiles,onTypingChange:J(function(e){var t=e&&B.get().isOnline;i.isTypingProxied&&P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.resIsTyping,{refId:i.conversation.refId,isTyping:t}),i.conversation.setIsTyping(t)},re,{maxWait:re}),onSendNewMessage:function(e,t){i.conversation.sendMessage(e,t)},onSendEditedMessage:function(e,t){e.content!==t&&(i.conversation.editMessage(e,t),i.updateChatInput({message:void 0}))},onMessageEditRequest:function(){var e=i._getMyLastMessage();i.updateChatInput({message:e})},onCancelMessageEditRequest:function(){i.updateChatInput({message:void 0})},onSearch:function(e){P.swc.services.searchManager.searchSkypeDirectory(e).then(function(e){A.default.mapSearchProfileInfo(e).forEach(function(e){var t=new b.default(!1);t.content=e.name,t.direction=w.Direction.Incoming,t.status=-1,i.conversation.messages.pushObservable(t)})})}};var T,N=function(){return setTimeout(function(){setTimeout(function(){i.renderChatInput(),i.onConversationUpdate()})})};P.swc.services.pesManager.isInitialized?(this.pesConfigInitialized(!0),N()):P.swc.Eventing.registerEvent(r.ApiEvents.PesConfigInitialized,function(){i.pesConfigInitialized(!0),N()}),P.swc.Eventing.registerEvent(r.ApiEvents.onControlShow,this.controlShowHandler),P.swc.Eventing.registerEvent(r.ApiEvents.onControlHide,this.controlHideHandler),P.swc.Eventing.registerEvent(r.ApiEvents.CallStatusChanged,this.callStatusChangedHandler),P.swc.Eventing.registerEvent(r.ApiEvents.CallingLayoutChanged,this.callingLayoutChangedHandler),P.swc.Eventing.registerEvent("calleeUnavailable",this.onCalleeUnavailable),P.swc.Eventing.registerEvent("swc:addon:open",function(e){e.id===i.conversation.id&&i.openAddon(e)}),P.swc.Eventing.registerEvent(r.ApiEvents.RequestEditingMessage,function(e){e.convId===i.conversation.id&&i._chatInputProps.isEditingEnabled&&i.updateChatInput({message:e.message})}),P.swc.Eventing.registerEvent(r.ApiEvents.OnConversationDelete,function(e){e===i.conversation.id&&i.close()}),this.animateLoginScreen(!t.DisableInOutAnimation),this.isGroupConversation=ko.observable(this.conversation.isGroup),this.isOneOnOneConversation=ko.observable(this.conversation.isOneOnOne),this.conversation.subscribe("isOneOnOne",this.isOneOnOneConversation),this._addParticipantsNode=n.querySelector(".addParticipants"),this.conversation.participants.subscribe(this._onParticipantsUpdate),this._onParticipantsUpdate(),P.swc.services.mePersonManager.fetch().then(function(e){i.isMePersonGuest(e.isGuest)}),this.showParticipantsControl=ko.computed(function(){return t.EnableParticipantsControl&&i.isGroupConversation()&&!i.isOneOnOneConversation()&&!i.isMePersonGuest()&&i.isParticipantControlEnabled()}),this._showMoreActionButton(),this.showActionsBar=ko.computed(function(){return i.showParticipantsControl()||i.showCalling()&&!i.suppressCallingControls()||i.showOtherActions()}),this.conversation.subscribe("isBlocked",this._onIsBlockedChange),this.conversation.isBRB&&(this.sendFirstReportMessage(),P.swc.Eventing.registerEvent(r.ApiEvents.StartReportProblemChat,function(){return i.sendFirstReportMessage()})),this.setTitle(this.conversation.topic),I.reportUserActivityStart(),this.setupProxy(),this._showSfbWarning=this.conversation.isSfB&&(T=this.conversation.id,!(ce().indexOf(T)>=0)),this.updateWarnings()}return e.prototype._updatePersonBlockedState=function(e,t){P.swc.services.persons.getPerson(e).isBlocked=t},e.prototype.updateChatInput=function(e){this._chatInputProps=i({},this._chatInputProps,e),this.renderChatInput()},e.prototype.renderChatInput=function(){var e=this._element.querySelector(".chat-input"),t=o.createElement(W.SwcChatInput,this._chatInputProps);s.render(t,e)},e.prototype.updateWarnings=function(){var e=this,t=this._showCallingWarning,n=this._showSfbWarning,i=[];t&&i.push({icon:K.SwcIconType.Error,text:Z("calling_disabled_warning"),onClose:function(){e._showCallingWarning=!1,e.updateWarnings()}}),n&&i.push({icon:K.SwcIconType.IconSkypeForBusiness,text:Z("sfb_warning"),onClose:function(){var t,n;e._showSfbWarning=!1,t=e.conversation.id,(n=ce()).indexOf(t)>=0||(n.push(t),P.swc.services.localStorage.setItem(T.SWC_SFB_DISMISSED_KEY,n.join(ae))),e.updateWarnings()}}),this.renderWarnings(i)},e.prototype.renderWarnings=function(e){var t=this._element.querySelector(".warningbar");if(t)if(e.length){var n={items:e,render:function(e){return o.createElement(G.SwcChatWarning,e)}},i=o.createElement(q.SwcList,n);s.render(i,t)}else s.render(null,t)},e.prototype._getMyLastMessage=function(){var e=this.conversation.messages?this.conversation.messages.filter(function(e){return e.type===w.MessageType.UserMessage&&e.direction===w.Direction.Outgoing&&!e.isDeleted}).sort(this._byTimestamp):[];return e.length?e[e.length-1]:null},e.prototype.getInitialChatInputProps=function(){var e=this.conversation.isSfB,t=this.conversation.definition,n=t.DisableSendingEmoticons,i=t.CanUploadFile;return{canSendEmoticons:c.Configuration.ECS.expressionPickerEnabled&&!n&&!e,canUploadFile:(i||this.chatDataConfig.CanUploadFile)&&!e}},e.prototype._updateParticipantsCountLabels=function(e){this.participantsCount(e?e.toString():""),this.participantsCountLabel(e?Z("chat_participants_count",{count:e}):"")},e.prototype.sendFirstReportMessage=function(){var e=a.default.get.isTeams()?"":c.Configuration.BRB_START_MESSAGE;this.conversation.sendMessage(e,p.ActionTrigger.SUGGESTED_ACTION)},e.prototype._setContent=function(e){this.privacyStatementText=Z("header_privacyPolicy"),this.termOfUseText=Z("header_termsOfUse"),this.editConversationTitleText=Z("edit_conversation_title_text"),this.deleteConversationTitle=Z("confirm_dialog_leave_conversation_header"),this.deleteConversationText=Z("confirm_dialog_leave_conversation_text"),this.deleteConversationConfirmTitle=Z("btn_confirm_leave"),this.brandMessage(Z("powered_by_skype"));var t=C.default.dompurify.sanitize(Z("ms_service_privacy_agreement",{0:'<a href="https://www.microsoft.com/'+e+'/servicesagreement/" target="_blank">',1:"</a>",2:'<a href="https://privacy.microsoft.com/'+e+'/privacystatement" target="_blank">',3:"</a>"}),{ALLOWED_TAGS:["a"],ALLOWED_ATTR:["target","href"]});this.ms_service_privacy_agreement(t)},e.prototype._hasMyselfParticipant=function(e){return e.some(function(e){return e.person.mri===P.swc.services.mePersonManager.mePerson.mri})},e.prototype.createConfirmationDialog=function(e,t,n,i,s){return{title:e,text:t,confirm:{title:n,action:function(){s.actionConfirm(),Y.ConfirmationDialog.remove()}},cancel:{title:i,action:function(){s.actionCancel(),Y.ConfirmationDialog.remove()}}}},e.prototype.createReportAbuse=function(e,t,n,i){return{title:e,text:t,confirm:{title:n,action:function(e,t){i(e,t),Y.ConfirmationDialog.remove()}},cancel:{title:Z("sign_in_cancel"),action:Y.ConfirmationDialog.remove}}},e.prototype._removeMeParticipant=function(){var e=this;return this.conversation.removeParticipant(P.swc.services.mePersonManager.mePerson.mri).then(function(){e.conversation.isChatEnabled=!1,e.showCalling(!1),e.isParticipantControlEnabled(!1),a.default.get.isTeams()&&e.showOtherActions(!1),e._removeMeParticipantFromModel();var t=Z("message_text_you_have_left_the_conversation");P.swc.services.webApi.sendLocalSystemMessage(e.conversation.id,t,w.CustomMessageType.MeLeftGroup),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.LeaveConversation)}).catch(function(e){})},e.prototype.triggerFocusInputEvent=function(){var e=this;setTimeout(function(){P.swc.Eventing.triggerEvent(r.ApiEvents.conversationProxy.focusInput,{id:e.conversation.id})})},e.prototype.startVideoCall=function(e,t){t.stopPropagation(),this._startCall(!0),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.StartVideoCall)},e.prototype.startAudioCall=function(e,t){t.stopPropagation(),this._startCall(!1),P.swc.Telemetry.sendEvent.userAction(E.UserActionType.StartAudioCall)},e.prototype.loginCss=function(){return{anim:!0}},e.prototype.setCallingCapabilities=function(){var e=this;P.swc.services.capabilitiesService.getCapabilitiesForConversation(this.conversation).then(function(t){var n=t.allowCalling;if(e.showCalling(n),e.videoEnabled(n),e.audioEnabled(n),e._showCallingWarning=!1,e.updateWarnings(),!e.conversation.isWithMe()){if(!n){var i=e.chatDataConfig.EnableCalling&&!e.isSupportedBrowser;return e._showCallingWarning=i,e.showCalling(i),void e.updateWarnings()}if(e.conversation.getConversationType()!==w.ConversationType.PHONE)if(!a.default.get.isTeams()||e.isOneOnOneConversation()||e._hasMyselfParticipant(e.conversation.participants)){if(!e.conversation.isGroup&&(e.isGuest()||e.conversation.isAgent)&&e._capabilities){var s=function(t){return e._capabilities.indexOf(t)>-1},o=s("video.send"),r=s("audio.send"),c=o||r;e.showCalling(c),e.videoEnabled(o),e.audioEnabled(r)}}else e.showCalling(!1);else e.videoEnabled(!1)}},function(e){})},e.prototype.updateSignedInState=function(){var e=P.swc.services.signInManager;if(this.conversation.sdkMode!==g.SDKMode.BOT||a.default.get.isSkypeOnly)if(this.conversation.getConversationType()===w.ConversationType.PERSON&&e.userIdentityType===h.IdentityType.GUEST)this.showLoginPage(!0),this.showComponent(!1),this.signedIn(!1);else if(this.conversation.getConversationType()===w.ConversationType.GROUP&&a.default.get.isGuestOnlyMode)this.showLoginPage(!1),this.showComponent(!0),this.signedIn(!0);else{this.showLoginPage(e.state===u.SigninState.SignedOut||e.state===u.SigninState.SigningOut);var t=e.state===u.SigninState.SignedIn||this.conversation.isGroup||!this.isGuest()&&this.conversation.isPerson;this.signedIn(e.state!==u.SigninState.SignedOut&&t),this.showComponent(!1),this.showLoginPage()||this.signedIn()!==this.showLoginPage()?!this.showLoginPage()&&this.signedIn()&&(this.conversation.isActive=!0):N.default.throwError(10505,"Empty chat is shown","",this.conversation.id)}else this.showLoginPage(!1),this.showComponent(!0),this.signedIn(e.state!==u.SigninState.SignedOut)},e.prototype.close=function(e,t){if(t&&t.stopPropagation(),!this.proxy.close||(this.proxy.close.handler(),!this.proxy.close.preventDefault)){var n={id:this.conversation.id},i={origin:c.Configuration.ORIGIN,action:d.ActionNames.HideChatWindow,data:n};P.swc.Eventing.triggerEvent(r.ApiEvents.onControlClose,n,!0),this.conversation.definition.EnableCustomOnCloseHandler||(P.swc.Eventing.triggerEvent(r.ApiEvents.compatEvent,i),P.swc.Telemetry.sendEvent.visibilityChangeQos(!1))}},e.prototype.toggleChatSize=function(e,t,n){if(this.chatDataConfig.CanCollapse){var i=this.proxy.toggle;if(!(!i||!i.preventDefault))return this.conversation.isControlOpen=!!n||!this.conversation.isControlOpen,this.conversation.isControlOpen&&(this.conversation.unreadMessagesCount=0,this.conversation.markAsRead()),void i.handler();this.isCollapsed(!(n||this.isCollapsed()));var s=this.isCollapsed()?d.ActionNames.CollapseChatWindow:d.ActionNames.ExpandChatWindow;P.swc.Eventing.triggerEvent(r.ApiEvents.compatEvent,{origin:c.Configuration.ORIGIN,action:s}),this.conversation.isControlOpen=!this.isCollapsed(),this.conversation.isControlOpen&&(this.conversation.unreadMessagesCount=0);var o=this.conversation.sdkMode===g.SDKMode.BOT,a={type:this.isCollapsed()?"collapse":"expand",isVisible:!this.isCollapsed(),conversationId:o?this.conversation.id:"n/a"};P.swc.Eventing.triggerEvent(r.ApiEvents.OnVisibilityChange,a,!0),this.isCollapsed()||this.conversation.markAsRead(),i&&i.handler()}},e.prototype._startCall=function(e){var t=this,n=this.conversation.isGroup,i=this.conversation.id;a.default.get.isTeams()&&this.conversation.isOneOnOne&&(n=!1,i=this.conversation.members.filter(function(e){return!P.swc.services.mePersonManager.isMe(e.id)}).shift().id),"https:"===a.default.get.parentProtocol?P.swc.Eventing.triggerEvent(r.ApiEvents.StartCall,{calleeId:i,withVideo:e,avatarUrl:this.avatarUrl(),displayName:this.title(),isGroup:n}):null===this._callingPopup||this._callingPopup.closed?P.swc.services.signInManager.getSkypeToken().then(function(n){var s={token:n,convId:i,convType:R.default.detectConversationType(i),withVideo:e,SDKUrl:t._getSDKUrl(),env:P.swc.EcsConfig.environment};t._callingPopup=window.open(H.UrlHelper.setQueryParameters(te,s),ee,ne)}):this._callingPopup.focus()},e.prototype._getSDKUrl=function(){return H.UrlHelper.getCDNPath()+H.UrlHelper.getCompletePath(ie+se,oe)},e.prototype._allowCustomHandling=function(e){return e.preventDefault(),e.stopPropagation(),this.isIeEngine&&(e.returnValue=!1),!1},e.prototype._handleDragEventEvent=function(e,t){var n=e.dataTransfer||e.originalEvent.dataTransfer;return n&&(n.dropEffect=t?"copy":"none"),this._allowCustomHandling(e)},e.prototype._containsType=function(e,t){var n=e.dataTransfer||e.originalEvent.dataTransfer;return Array.prototype.some.call(n.types,function(e){return e===t})},e.prototype._canProcessDropEvent=function(e){return this._canUploadFile&&this._containsType(e,"Files")},e.prototype.show=function(){k.default.startChat(this.conversation.id,this.chatDataConfig,!1,f.OpenChatOrigin.CONVERSATION_ROSTER),this.isCollapsed(!1)},e.prototype._subscribeToDisplayName=function(e){var t=this;e.displayName&&this._handleDisplayName(e),e.subscribe("displayName",function(){return t._handleDisplayName(e)})},e.prototype._handleDisplayName=function(e){var t=e.isAgent&&e.displayName===e.id?"":e.displayName;this.setTitle(t),this.conversation.topic=e.displayName},e.prototype.onTitleFocusIn=function(){this.isTitleFocused(!0)},e.prototype.onTitleFocusOut=function(){this.isTitleFocused(!1)},e.prototype._changeConversation=function(e){var t,n=this,i=P.swc.services.signInManager;this.isGuest(i.userIdentityType===h.IdentityType.GUEST||i.state!==u.SigninState.SignedIn),this.conversation=e,this.conversation.sdkMode===g.SDKMode.BOT?this.showLoginPage(!1):this.updateSignedInState(),this.isAgent(this.conversation.isAgent),this._renderAvatar(),this.conversation.isOneOnOne&&(t=this.conversation.isTeamsOneOnOne?this.conversation.theOtherParticipant.person:P.swc.services.persons.getPerson(this.conversation.id,!0,this.isAgent()),a.default.get.isTeams()?P.swc.services.presenceService.subscribe(t.mri,function(e){t.presenceStatus=y.getStatusFromAvailability(e.presence.availability)}):P.swc.services.webApi.subscribeContactPresence(t.id)),this.conversation.isOneOnOne&&!this.conversation.topic?this._subscribeToDisplayName(t):this.conversation.topic&&this.setTitle(this.conversation.topic),this.chatDataConfig.Title||this.conversation.subscribe("topic",function(e){return n.setTitle(e)});var s=this.chatDataConfig.Avatar;this.conversation.avatar?this._renderAvatar(this.conversation.avatar):s?this._renderAvatar(s):this._renderAvatar(),this.subscribeToAvatar(t,this.conversation.id),this.conversation.sdkMode===g.SDKMode.BOT&&t&&P.swc.services.agentsManager.getAgent(t.id).then(function(e){if(e&&e.agentDescriptions&&1===e.agentDescriptions.length){var t=e.agentDescriptions[0],i=n.conversation.definition.PrivacyUri||t.privacyStatement,s=n.conversation.definition.TermsOfUseUri||t.tos;n.privacyStatement(i),n.termOfUse(s),n.showPrivacyStatement(t.privacyStatement&&t.privacyStatement.length>0),n.showTermsOfUse(t.tos&&t.tos.length>0),t.capabilities&&(n._capabilities=t.capabilities,n.setCallingCapabilities())}})},e.prototype.setTitle=function(e){if(e){var t=F.MessageUtils.sanitizeTopic(e);this.title(t)}},e.prototype.initActionBar=function(e){var t=o.createElement(Q.ActionBar,{actions:e}),n=this._element.querySelector(".action-bar");s.render(t,n)},e.prototype.hideExpressionPicker=function(){this.isPickerVisible()&&this.isPickerVisible(!1),P.swc.Eventing.triggerEvent(r.ExpressionPickerEvents.ITEM_CANCEL_REQUEST)},e.prototype._setAcceptedFiles=function(){var e=this.conversation.definition?this.conversation.definition:this.chatDataConfig;this._fileSize=parseFloat(e.FileSize),this._extensions=O.default.explode(e.FileExtensions),this._types=O.default.explode(e.FileTypes),this._accepted=O.default.implode(this._extensions.concat(this._types))},e}();t.default=le},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n){var i=this;this.onClose=function(){i.frame.contentWindow.postMessage("swc:addon:userClosed","*"),window.setTimeout(function(){i.hide(),i.destroy()},5)},this.handlers={},this.onmessage=function(e){var t=e.data;if(t&&t.action)switch(t.action){case"swc:addon:close":(0,i.handlers["swc:addon:close"])(t),i.hide(),i.destroy()}},this.handlers=n,this.wrapper=document.createElement("div"),this.close=document.createElement("div"),this.frame=document.createElement("iframe");this.wrapper.setAttribute("style","position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5; background: #fff");this.frame.setAttribute("style","width: 100%; height: 100%; border: none;"),this.frame.setAttribute("allow","camera; microphone;"),this.frame.src=encodeURI(t);this.close.textContent="close",this.close.setAttribute("style","position: absolute; z-index: 10; right: 5px; top: 5px; font-size: 9px;"),this.close.addEventListener("click",this.onClose),this.hide(),this.listen(),this.wrapper.appendChild(this.frame),this.wrapper.appendChild(this.close),e.appendChild(this.wrapper)}return e.prototype.listen=function(){window.addEventListener("message",this.onmessage)},e.prototype.show=function(){this.wrapper.style.display="block"},e.prototype.hide=function(){this.wrapper.style.display="none"},e.prototype.destroy=function(){window.removeEventListener("message",this.onmessage),this.close.removeEventListener("click",this.onClose);var e=this.wrapper.parentElement;this.wrapper.removeChild(this.frame),e.removeChild(this.wrapper)},e}();t.default=i},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(4),c=n(2),l=n(93),u=n(32),d=n(63),p=n(0),h=n(281),f=n(20),g=n(12),v=n(14),m=n(56),_=n(416),y=n(6),w=n(421),b=n(8),C=n(426),E=" ",S=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="swcChatInput",n.focusTextarea=function(){return n._textarea&&setTimeout(function(){return n._textarea.focus()})},n.onKeyDown=function(e){e.stopPropagation(),n.props.onTypingChange(!!n._textarea.value);var t=f.default.getKeyCode(e);return n.suggestionList.handleKeyDown(e,t)?(e.preventDefault(),!1):(t!==g.default.ESCAPE&&t!==g.default.UP&&t!==g.default.DOWN&&t!==g.default.TAB&&t!==g.default.ENTER||n.keyDownHandler(e),t===g.default.UP&&""===n._textarea.value?(n.props.onMessageEditRequest(),!0):t===g.default.ESCAPE?(n.props.onCancelMessageEditRequest(),!0):t!==g.default.ENTER||(!!e.shiftKey||(n.props.isChatEnabled?(e.preventDefault(),n.sendMessage(l.ActionTrigger.KEYPRESS_ENTER),n._onEmoticonPickerClose(),n.suggestionList.handleInput({value:n._textarea.value,selectionStart:n._textarea.selectionStart},null),!1):void 0)))},n.handleInput=function(e){e.stopPropagation();var t=n._textarea.value;t.length>c.Configuration.MSG_MAX_LENGTH&&(t=t.substring(0,c.Configuration.MSG_MAX_LENGTH)),n.setState({messageText:t}),n.evaluateChangeCommand(t.trim()),n.props.message&&!t&&n.props.onCancelMessageEditRequest(),n.suggestionList.handleInput({value:t,selectionStart:n._textarea.selectionStart},null)},n.pasteInput=function(e){e.stopPropagation(),e.preventDefault();var t,i,s=(window.clipboardData||e.clipboardData).getData("Text");s&&n.insertTextToSelection(s),!s&&(t="Files",i=e.clipboardData,Array.prototype.some.call(i.types,function(e){return e===t}))?n.props.canUploadFile&&n.props.onSendFiles(e.clipboardData.files):n.handleInput(e)},n.sendButtonHandler=function(e){e.stopPropagation(),n.props.isChatEnabled&&(n.suggestionList.clear(),n.sendMessage(l.ActionTrigger.BUTTON_SEND_CLICK))},n.cancelEditingMode=function(e){e.stopPropagation(),n.props.onCancelMessageEditRequest()},n._onEmoticonBtnClick=function(e){e.stopPropagation(),n._toggleEmoticonPicker()},n._toggleEmoticonPicker=function(e){n.state.isEmoticonPickerVisible?e||n.setState({isEmoticonPickerVisible:!1}):(n.setState({isEmoticonPickerVisible:!0}),p.swc.Telemetry.sendEvent.userAction(d.UserActionType.ExpressionPicker))},n._onEmoticonSelect=function(e){var t=e&&e.shortcuts&&e.shortcuts.length?e.shortcuts[0]+E:"";t&&n.insertTextToSelection(t)},n._onSuggestionApply=function(e){n.setCursorAt(e.selectionEnd),n.setState({messageText:e.value})},n._onEmoticonPickerClose=function(){n.setState({isEmoticonPickerVisible:!1})},n._onFileInputChange=function(e){e.stopPropagation(),n._fileSelector&&0!==n._fileSelector.files.length&&(n.props.onSendFiles(n._fileSelector.files),n._textarea.focus())},n._onAttachBtnClick=function(e){e.stopPropagation(),n.openFileSelector(n.props.acceptedFiles)},n.state={isEmoticonPickerVisible:!1,messageText:""},n.suggestionList=new _.SuggestionList(n._onSuggestionApply,t.canSendEmoticons),n}return s(t,e),t.prototype.componentDidMount=function(){var e=this,t=a.ApiEvents.conversationProxy,n=function(t){return t===e.props.conversationId};p.swc.Eventing.registerEvent(t.openFilePicker,function(t){n(t)&&e.openFileSelector(e.props.acceptedFiles)}),p.swc.Eventing.registerEvent(t.toggleEmoticonPicker,function(t){n(t.id)&&(t.open||e._onEmoticonPickerClose(),e._toggleEmoticonPicker(t.open))});var i=function(t){n(t.id)&&e._textarea&&e._textarea.focus()};p.swc.Eventing.registerEvent(t.focusInput,i),p.swc.Eventing.registerEvent("paste",i),this.focusTextarea()},t.prototype.componentWillReceiveProps=function(e){if(!e.prefillText&&""!==e.prefillText||this.props.prefillText===e.prefillText||this.setState({messageText:e.prefillText}),e.message&&this.props.message!==e.message){var t=I(e.message);this.setCursorAt(t.length),this.setState({messageText:t})}this.props.message&&!e.message&&this.emptyTextArea(),this.props.canSendEmoticons!==e.canSendEmoticons&&(this.suggestionList.clear(),this.suggestionList.dispose(),this.suggestionList=new _.SuggestionList(this._onSuggestionApply,e.canSendEmoticons))},t.prototype.componentDidUpdate=function(e,t){var n=this;if(this._textarea){if(t.messageText!==this.state.messageText&&this._mirror&&(this._mirror.style.width=this._textarea.offsetWidth+"px",this._textarea.style.height=this._mirror.offsetHeight+"px"),""===this.state.messageText&&this.focusTextarea(),this._cursorPosition>=0){var i=this._cursorPosition;this._textarea.focus(),setTimeout(function(){n._textarea.setSelectionRange(i,i)})}this._cursorPosition=void 0}},t.prototype.render=function(){var e=this,t=!!this.state.messageText,n=this.props.message,i=n&&this.state.messageText===I(n),s=p.swc.services.i18n.fetch("send_message"),a=p.swc.services.i18n.fetch("text_cancel_editing_message"),l=p.swc.services.i18n.fetch("send_file"),u=this.state.isEmoticonPickerVisible?p.swc.services.i18n.fetch("emoticon_picker_close"):p.swc.services.i18n.fetch("emoticon_picker_open");return r.createElement("div",{className:this.getComposedBlockClassName()},this.state.isEmoticonPickerVisible&&r.createElement(w.SwcEmoticonPicker,{className:"swcChatInput__emoticonPicker",onSelect:this._onEmoticonSelect,onClose:this._onEmoticonPickerClose}),r.createElement("div",{className:"swcChatInput__container "+this.props.tags},this.props.canSendEmoticons&&r.createElement("button",{className:"swcChatInput__button swcChatInput__button_emoticon",onClick:this._onEmoticonBtnClick,title:u,disabled:!this.props.isChatEnabled},r.createElement(b.SwcIcon,{className:"swcChatInput__icon",type:b.SwcIconType.EmoticonStroke,size:b.SwcIconSize.Medium})),r.createElement("textarea",{ref:function(t){return e._textarea=t},className:"swcChatInput__textArea",onKeyDown:this.onKeyDown,onInput:this.handleInput,onPaste:this.pasteInput,value:this.state.messageText,placeholder:this.props.placeholder,maxLength:c.Configuration.MSG_MAX_LENGTH,disabled:!this.props.isChatEnabled}),this.props.isChatEnabled&&(t||!this.props.canUploadFile)&&!i&&r.createElement("button",{className:"swcChatInput__button swcChatInput__button_send",onClick:this.sendButtonHandler,disabled:!this.props.isChatEnabled,title:s,"aria-label":s},r.createElement(b.SwcIcon,{className:"swcChatInput__icon",type:b.SwcIconType.Send,size:b.SwcIconSize.Medium})),(t||!this.props.canUploadFile)&&i&&r.createElement("button",{className:"swcChatInput__button swcChatInput__button_cancel",onClick:this.cancelEditingMode,title:a},r.createElement(b.SwcIcon,{className:"swcChatInput__icon",type:b.SwcIconType.Cancel,size:b.SwcIconSize.Medium})),this.props.canUploadFile&&r.createElement(o.Fragment,null,r.createElement("input",{ref:function(t){return e._fileSelector=t},type:"file",className:"swcChatInput__fileInput",multiple:!0,onChange:this._onFileInputChange}),!t&&r.createElement("button",{className:"swcChatInput__button swcChatInput__button_file",onClick:this._onAttachBtnClick,title:l},r.createElement(b.SwcIcon,{className:"swcChatInput__icon",type:b.SwcIconType.Clippy,size:b.SwcIconSize.Medium})))),r.createElement(C.SwcSuggestionPicker,{className:"swcChatInput__suggestions",suggestionList:this.suggestionList}),r.createElement("div",{style:"max-width: 0; max-height: 0; position: absolute; overflow: hidden;"},r.createElement("div",{ref:function(t){return e._mirror=t},className:"swcChatInput__textArea",style:"position: relative; word-wrap: break-word; white-space: pre-wrap;"},this.state.messageText)))},t.prototype.sendMessage=function(e){var t=this.state.messageText.trim();if(t&&!(t.length>c.Configuration.MSG_MAX_LENGTH)){var n=h.Commands.instance;n.commands.length&&n.isValidCommand(t)?n.mode===h.CommandMode.submit&&this.emptyTextArea():(0===this.state.messageText.toLowerCase().indexOf("skypesearch:")?this.props.onSearch(t.substr("skypesearch:".length).trim()):this.props.message?this.props.onSendEditedMessage(this.props.message,t):this.props.onSendNewMessage(t,e),this.emptyTextArea())}},t.prototype.emptyTextArea=function(){this.setState({messageText:""})},t.prototype.keyDownHandler=function(e){this.evaluateChangeCommand("",e)},t.prototype.evaluateChangeCommand=function(e,t){var n=h.Commands.instance;n.mode===h.CommandMode.change&&n.evaluate(e,this.props.conversationId,t)},t.prototype.insertTextToSelection=function(e){var t=this._textarea.selectionStart,n=this._textarea.selectionEnd;this.setCursorAt(t+e.length),this.setState(function(i){var s=i.messageText;return{messageText:m.inject(s,e,t,n)}})},t.prototype.setCursorAt=function(e){this._cursorPosition=e},t.prototype.openFileSelector=function(e){void 0===e&&(e=""),this._fileSelector&&(this._fileSelector.value="",this._fileSelector.accept=e,this._fileSelector.click(),p.swc.Telemetry.sendEvent.userAction(d.UserActionType.FilePicker))},t}(y.SwcBaseComponent);function I(e){var t=e.content.replace(/<br\s*\/?><br\s*\/?>/g,"\n\n").replace(/<br\s*\/?>/g,"  \n"),n=u.default.dompurify.sanitize(t,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]});return v.MessageUtils.unescape(n)}t.SwcChatInput=S},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),r=n(12),a=n(56),c=n(417),l=n(419),u=function(e){function t(t,n){var i=e.call(this)||this;return i.onSuggestionApply=t,i._suggestionEngines=[],i._selectedIndex=-1,i._suggestions=[],i._getWord=function(e){var t=e.selectionStart;return a.wordAt(e.value,t).toLocaleLowerCase()},i._processSuggestions=function(e){var t=e.length?e.reduce(function(e,t){return e.concat(t)}):[];i.setSuggestions(t),0===i.suggestions.length?i.setSelectedIndex(-1):(-1===i.selectedIndex||i.selectedIndex>i.suggestions.length)&&i.setSelectedIndex(0)},i._suggestionEngines.push(l.default),n&&i._suggestionEngines.push(c.default),i}return s(t,e),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"suggestions",{get:function(){return this._suggestions},enumerable:!0,configurable:!0}),t.prototype.setSelectedIndex=function(e){e!==this._selectedIndex&&(this._selectedIndex=e,this.publish("selectedIndex",e))},t.prototype.setSuggestions=function(e){e!==this._suggestions&&(this._suggestions=e,this.publish("suggestions",e))},t.prototype.handleInput=function(e,t){var n=this,i=[];this._suggestionEngines.forEach(function(s){var o=n._getWord(e);s.shouldCreateSuggestion(o)&&i.push(new Promise(function(n,i){s.getSuggestions(e,o,t).then(function(e){n(e.slice(0,5))})}))}),Promise.all(i).then(this._processSuggestions)},t.prototype.clear=function(){this.setSuggestions([]),this.setSelectedIndex(-1)},t.prototype.applyItem=function(e){if(e<0||e>=this.suggestions.length)this.clear();else{var t=this.suggestions[e].applySuggestion();this.clear(),this.onSuggestionApply(t)}},t.prototype.handleKeyDown=function(e,t){if(0===this.suggestions.length||-1===[r.default.UP,r.default.DOWN,r.default.ENTER,r.default.TAB].indexOf(t))return!1;switch(t){case r.default.UP:case r.default.DOWN:if(this.suggestions.length<2)return!1;var n=38===t?-1:1;this.setSelectedIndex((this.selectedIndex+this.suggestions.length+n)%this.suggestions.length);break;case r.default.ENTER:case r.default.TAB:if(e.shiftKey)return!1;this.applyItem(this.selectedIndex)}return!0},t}(o.default);t.SuggestionList=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(418),o=function(){function e(){this.isEnabled=!0,this.suggestHidden=!0}return e.prototype.shouldCreateSuggestion=function(e){return!!this.isEnabled&&(0===e.indexOf("(")&&e.length>=2)},e.prototype.getSuggestions=function(e,t,n){var i=this;return new Promise(function(n,s){i.filterEmoticons(t,e).then(function(e){1===e.length&&i.hasExactMatch("("+t,e[0].emoticon)&&(e=[]),n(e)})})},e.prototype.filterEmoticons=function(e,t){var n=this.suggestHidden;return i.swc.services.pesManager.getConfiguration().then(function(i){var o=i.items.reduce(function(i,o){if("emoticon"!==o.type||!o.visible&&!n)return i;var r=o.shortcuts.filter(function(t){return 0===t.indexOf(e.toLocaleLowerCase())});if(r.length){var a=new s.EmoticonSuggestion(o,r[0],t);return i.push(a),i}return i},[]);return o.sort(function(e,t){var n=e.shortcut,i=t.shortcut;return n.length>i.length?1:n.length<i.length?-1:0}),o})},e.prototype.hasExactMatch=function(e,t){return!!t.shortcuts.filter(function(t){return t===e}).length},e}();t.EmoticonSuggestionEngine=o,t.default=new o},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,i){var s=e.call(this,i)||this;return s.emoticon=t,s.shortcut=n,s}return s(t,e),t.prototype.getReplacer=function(){return this.shortcut},t}(n(282).Suggestion);t.EmoticonSuggestion=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(420),s=function(){function e(){}return e.prototype.shouldCreateSuggestion=function(e){return!(e.length<1||"@"!==e.charAt(0))},e.prototype.getSuggestions=function(e,t,n){return new Promise(function(t,s){t(n.participants.map(function(t){return new i.MentionSuggestion(t,e)}))})},e}();t.default=new s},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var i=e.call(this,n)||this;return i.participant=t,i.templateName="suggestion-item-mention",i.displayName=ko.observable(t.person.displayName),t.person.subscribe("displayName",i.displayName),i}return s(t,e),t.prototype.dispose=function(){this.participant.person.unsubscribe("displayName",this.displayName)},t.prototype.getReplacer=function(){var e=this.participant.person;return"@"+(e.isAgent?"("+e.displayName.replace(/(\(|\))/g,"")+")":e.id)},t}(n(282).Suggestion);t.MentionSuggestion=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(422);t.SwcEmoticonPicker=i.SwcEmoticonPicker},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(73),c=n(0),l=n(20),u=n(12),d=n(6),p=n(423),h=n(424),f=n(425),g=[],v=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="swcEmoticonPicker",n.onKeyDown=function(e){e.stopPropagation(),l.default.getKeyCode(e)===u.default.ESCAPE&&n.onClose()},n.onSearchQueryChange=function(e){n.setState({searchQuery:e})},n.onClose=function(){n.onSearchQueryChange(""),n.props.onClose()},n.onEmoticonPreview=function(e){n.setState({currentEmoticonId:e})},n.onEmoticonSelect=function(e){n.onEmoticonPreview(e);var t=y(g,e);n.props.onSelect(t)},n.state={searchQuery:"",currentEmoticonId:""},g.length?n:(c.swc.services.pesManager.getConfiguration().then(function(e){g=function(e){var t={},n=[];if(!e)return n;e.tabs&&e.tabs.forEach(function(e){e.sections&&e.sections.forEach(function(e){e.pack&&(t[e.pack]=e)})});e.packs&&(n=e.packs.filter(function(e){var n=!1;if(!t[e.id])return!1;if(!e.title||e.id===m||e.id===_)return!1;for(var i=0;i<e.items.length;i++)if(e.items[i].type===a.default.itemTypes.emoticon.id){n=!0;break}return n}));return n}(e),n.forceUpdate()}),n)}return s(t,e),t.prototype.render=function(){var e=this.state.currentEmoticonId?function(e,t){var n=y(e,t);if(!n)return null;return{id:n.id,description:n.description,shortcut:n.shortcuts&&n.shortcuts[0]||""}}(g,this.state.currentEmoticonId):{id:"smile",description:"Smile",shortcut:":)"};return r.createElement("div",{className:this.getComposedBlockClassName(),onKeyDown:this.onKeyDown},r.createElement(p.SwcEmoticonPickerHeader,{className:"swcEmoticonPicker__header",searchQuery:this.state.searchQuery,onSearchQueryChange:this.onSearchQueryChange,onClose:this.onClose}),r.createElement("div",{className:"swcEmoticonPicker__content"},r.createElement(f.SwcEmoticonPickerPreview,o({className:"swcEmoticonPicker__preview"},e)),r.createElement(h.SwcEmoticonPickerList,{className:"swcEmoticonPicker__list",searchQuery:this.state.searchQuery,emoticonPacks:g,onEmoticonPreview:this.onEmoticonPreview,onEmoticonSelect:this.onEmoticonSelect})))},t}(d.SwcBaseComponent);t.SwcEmoticonPicker=v;var m="e6a2194043654a10b081028546390dd8",_="c31911f4054c48e39c3139bd0f2a456e";function y(e,t){for(var n=0,i=g;n<i.length;n++)for(var s=0,o=i[n].items;s<o.length;s++){var r=o[s];if(r.id===t)return r}return null}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(0),a=n(6),c=n(8),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcEmoticonPickerHeader",t.onSearchIconClick=function(e){e.stopPropagation(),t.focusInput()},t.focusInput=function(){t._input&&t._input.focus()},t.onInputValueChange=function(e){e.stopPropagation();var n=e.target;t.props.onSearchQueryChange(n.value)},t.onCloseClick=function(e){e.stopPropagation(),t.props.onClose()},t}return s(t,e),t.prototype.componentDidMount=function(){setTimeout(this.focusInput,100)},t.prototype.render=function(){var e=this,t=r.swc.services.i18n.fetch("search"),n=r.swc.services.i18n.fetch("emoticon_picker_close");return o.createElement("div",{className:this.getComposedBlockClassName()},o.createElement("span",{className:"swcEmoticonPickerHeader__iconWrapper",title:t,onClick:this.onSearchIconClick},o.createElement(c.SwcIcon,{className:"swcEmoticonPickerHeader__icon",type:c.SwcIconType.Search,size:c.SwcIconSize.Medium})),o.createElement("input",{className:"swcEmoticonPickerHeader__input",ref:function(t){return e._input=t},type:"text",value:this.props.searchQuery,onInput:this.onInputValueChange,placeholder:t}),o.createElement("button",{className:"swcEmoticonPickerHeader__button",onClick:this.onCloseClick,title:n},o.createElement(c.SwcIcon,{className:"swcEmoticonPickerHeader__icon",type:c.SwcIconType.Cancel,size:c.SwcIconSize.Medium})))},t}(a.SwcBaseComponent);t.SwcEmoticonPickerHeader=l},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(0),c=n(20),l=n(12),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcEmoticonPickerList",t.handleMouseEvent=function(e,n){n.stopPropagation(),t.props.onEmoticonPreview(e)},t.handleClickEvent=function(e,n){n.stopPropagation(),t.props.onEmoticonSelect(e)},t.handleKeyDownEvent=function(e,n){if(c.default.getKeyCode(n)!==l.default.ENTER)return!0;n.preventDefault(),t.handleClickEvent(e,n)},t}return s(t,e),t.prototype.render=function(){var e=this,t=a.swc.services.i18n.fetch("search_no_results_found").toUpperCase();return r.createElement("div",{className:this.getComposedBlockClassName()},!this.props.emoticonPacks.length&&r.createElement("h4",{className:"swcEmoticonPickerList__title"},t),r.createElement("div",{className:"swcEmoticonPickerList__emoticonPacks"},this.props.emoticonPacks.map(function(t){return r.createElement(o.Fragment,{key:t.id},t.title&&r.createElement("h4",{className:"swcEmoticonPickerList__title"},t.title),r.createElement("div",{className:"swcEmoticonPickerList__packItems","data-name":t.id,"aria-label":t.ariaLabel},t.items.map(function(t){return r.createElement("div",{key:t.id,onMouseOver:o.linkEvent(t.id,e.handleMouseEvent),onFocus:o.linkEvent(t.id,e.handleMouseEvent),onClick:o.linkEvent(t.id,e.handleClickEvent),onKeyDown:o.linkEvent(t.id,e.handleKeyDownEvent),tabIndex:0,title:t.description,"data-item-id":t.id,className:t.type+" swcEmoticonPickerList__packItem",role:"listitem",hidden:!d(t,e.props.searchQuery),style:{"background-image":"url("+t.background+")"}})})))})))},t}(n(6).SwcBaseComponent);function d(e,t){var n=[e.keywords||[],e.shortcuts||[],e.description.split(/\s/),(e.copyright||"").split(/\s/),(e.pickerTitle||"").split(/\s/),(e.transcript||"").split(/\s/)].reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return void 0!==e&&""!==e&&null!==e}).map(function(e){return e.toLowerCase()});return t=t.toLowerCase(),n.find(function(e){return e.indexOf(t)>-1})}t.SwcEmoticonPickerList=u},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(101),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcEmoticonPickerPreview",t}return s(t,e),t.prototype.render=function(){return o.createElement("div",{className:this.getComposedBlockClassName()},o.createElement(r.SwcEmoticon,{className:"swcEmoticonPickerPreview__emoticon",large:!0,largeEmoticonClass:"extraLarge",title:this.props.description,emoticonId:this.props.id,isAnimated:!0}),o.createElement("h4",{className:"swcEmoticonPickerPreview__description"},this.props.description),!!this.props.shortcut&&o.createElement("h4",{className:"swcEmoticonPickerPreview__shortcut"},this.props.shortcut))},t}(n(6).SwcBaseComponent);t.SwcEmoticonPickerPreview=a},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(0),c=n(101),l=function(e){function t(t){var n=e.call(this,t)||this;return n.blockClassName="swcSuggestionPicker",n.propNames=["suggestions","selectedIndex"],n._setNewState=function(){n.setState({suggestions:n.props.suggestionList.suggestions,selectedIndex:n.props.suggestionList.selectedIndex})},n._clickHandler=function(e){n.props.suggestionList.applyItem(e)},n.state={suggestions:[],selectedIndex:-1},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this;this.propNames.forEach(function(t){e.props.suggestionList.subscribe(t,e._setNewState)})},t.prototype.componentDidUpdate=function(){a.swc.services.pesManager.refresh()},t.prototype.componentWillUnmount=function(){var e=this;this.propNames.forEach(function(t){e.props.suggestionList.unsubscribe(t,e._setNewState)})},t.prototype.render=function(){var e=this;return r.createElement("ul",{className:this.getComposedBlockClassName()},this.state.suggestions.map(function(t,n){var i="swcSuggestionPicker__item"+(e.state.selectedIndex===n?" swcSuggestionPicker__item_selected":"");return r.createElement("li",{key:t.emoticon.id,className:i,onClick:o.linkEvent(n,e._clickHandler)},r.createElement(c.SwcEmoticon,{className:"swcSuggestionPicker__emoticon",emoticonId:t.emoticon.id,isAnimated:!0}),r.createElement("span",{className:"swcSuggestionPicker__shortcut"},t.shortcut))}))},t}(n(6).SwcBaseComponent);t.SwcSuggestionPicker=l},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(0),a=n(6),c=n(8),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcChatWarning",t}return s(t,e),t.prototype.render=function(){return o.createElement("li",{role:"alertdialog",className:this.getComposedBlockClassName()},o.createElement(c.SwcIcon,{className:"swcChatWarning__icon",type:this.props.icon,size:c.SwcIconSize.Medium}),o.createElement("div",{className:"swcChatWarning__text"},this.props.text),o.createElement("button",{className:"swcChatWarning__close",onClick:this.props.onClose,title:(e="chat_warning_dismiss",r.swc.services.i18n.fetch(e))},o.createElement(c.SwcIcon,{type:c.SwcIconType.Cancel,size:c.SwcIconSize.Medium})));var e},t}(a.SwcBaseComponent);t.SwcChatWarning=l},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockClassName="swcList",t}return s(t,e),t.prototype.render=function(){return o.createElement("ul",{className:this.getComposedBlockClassName()},this.props.items.map(this.props.render))},t}(n(6).SwcBaseComponent);t.SwcList=r},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(0),a=n(430),c=function(e){function t(t){var n=e.call(this,t)||this;return n._translations={confirm_dialog_report_abuse_spam_reason_text:r.swc.services.i18n.fetch("confirm_dialog_report_abuse_spam_reason_text"),confirm_dialog_report_abuse_pornography_reason_text:r.swc.services.i18n.fetch("confirm_dialog_report_abuse_pornography_reason_text"),confirm_dialog_report_abuse_child_exploitation_reason_text:r.swc.services.i18n.fetch("confirm_dialog_report_abuse_child_exploitation_reason_text"),confirm_dialog_report_abuse_harassment_reason_text:r.swc.services.i18n.fetch("confirm_dialog_report_abuse_harassment_reason_text"),confirm_dialog_block_report_abuse_checkbox:r.swc.services.i18n.fetch("confirm_dialog_block_report_abuse_checkbox")},n._onReasonChange=function(e){n.setState({value:e.target.value})},n._onCheckChange=function(e){n.setState({reportAbuseCheckBox:e.target.checked})},n.state={reportAbuseCheckBox:!1,value:a.AbuseTypes.Spam},n}return s(t,e),t.prototype.getContentElement=function(){return o.createElement("div",null,o.createElement("label",{className:"blockLabel"},o.createElement("input",{className:"blockCheckBox",type:"checkbox",onChange:this._onCheckChange,checked:this.state.reportAbuseCheckBox}),o.createElement("p",{className:"blockText"},this._translations.confirm_dialog_block_report_abuse_checkbox)),this.state.reportAbuseCheckBox&&o.createElement("select",{value:this.state.value,onChange:this._onReasonChange,className:"abuseOptions"},o.createElement("option",{selected:this.state.value===a.AbuseTypes.Spam,value:a.AbuseTypes.Spam},this._translations.confirm_dialog_report_abuse_spam_reason_text),o.createElement("option",{selected:this.state.value===a.AbuseTypes.Pornography,value:a.AbuseTypes.Pornography},this._translations.confirm_dialog_report_abuse_pornography_reason_text),o.createElement("option",{selected:this.state.value===a.AbuseTypes.ChildExploitation,value:a.AbuseTypes.ChildExploitation},this._translations.confirm_dialog_report_abuse_child_exploitation_reason_text),o.createElement("option",{selected:this.state.value===a.AbuseTypes.Harassment,value:a.AbuseTypes.Harassment},this._translations.confirm_dialog_report_abuse_harassment_reason_text)))},t.prototype.confirmAction=function(){var e=this.state.reportAbuseCheckBox,t=this.state.value;this.props.dialogContent.confirm.action(e,t)},t}(n(148).Dialog);t.BlockDialog=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Spam="spam",e.Pornography="pornography",e.ChildExploitation="child-exploitation",e.Harassment="harassment"}(t.AbuseTypes||(t.AbuseTypes={}))},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.render=function(){var e=this.props.actions;return r.createElement("div",{className:"swc-action-bar"},e.map(function(e){return r.createElement("button",{key:e.name,className:"swc-action "+e.className,onClick:e.handler,title:e.title},e.text)}))},t}(o.Component);t.ActionBar=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(31),o=function(e,t){return i.swc.services.i18n.fetch(e,t)},r=function(){function e(e){var t=this;this.conversation=e,this.typingIndicator=ko.observable(o("typingIndicatorOnLoad")),this.isTyping=ko.observable(!1),this._typingParticipants={},this._onDisplayNameUpdate=function(e){t.typingIndicator(o("typingIndicatorHuman",{typingMessage:t.adjustBotName(e)}))},this.conversation.participants.subscribe(this._onParticipantsChange.bind(this)),this.conversation.subscribe("isTyping",this._onTypingIndicator.bind(this)),this.boundConversationLoadedHandler=this._onConversationLoadedHandler.bind(this),e.isLoaded?this.setup():(this.isTyping(!0),this.conversation.subscribe("isLoaded",this.boundConversationLoadedHandler))}return e.prototype.setup=function(){if(this.conversation.isGroup){var e=o("typingIndicatorHuman",{typingMessage:o("typingIndicatorSomebody")});this.typingIndicator(e)}else this._person=i.swc.services.persons.getPerson(this.conversation.id,!0),this._onDisplayNameUpdate(this._person.displayName),this._person.subscribe("displayName",this._onDisplayNameUpdate)},e.prototype._onParticipantsChange=function(e,t){var n=this;e.length&&t.newItems&&t.newItems.length&&t.newItems.forEach(function(e){var t=n._typingDetector.bind(n,e);e.subscribe("isTyping",t)})},e.prototype._onConversationLoadedHandler=function(){this.isTyping(!1),this.setup()},e.prototype._onTypingIndicator=function(e){if(this.isTyping(!!e),this.timeoutId&&clearTimeout(this.timeoutId),e){var t=this;this.timeoutId=setTimeout(function(){t.isTyping(!1),t.timeoutId=void 0},5e3)}},e.prototype._typingDetector=function(e,t){var n=this,i=e.person.id;t?this._typingParticipants[i]=e:delete this._typingParticipants[i];var s=Object.keys(this._typingParticipants),r="";s.length?(this.conversation.isGroup&&(s.forEach(function(e){var t=n._typingParticipants[e].person.displayName;r+=""===r?t:", "+t}),this.typingIndicator(o("typingIndicatorHuman",{typingMessage:r}))),this.isTyping(!0)):this.isTyping(!1)},e.prototype.adjustBotName=function(e){return e&&e!==s.default.getNormalizeId(this.conversation.id)?e:this.conversation.isAgent?"Bot":"Person"},e.prototype.dispose=function(){this.conversation.unsubscribe("isLoaded",this.boundConversationLoadedHandler),this._person&&(this._person.unsubscribe("displayName",this._onDisplayNameUpdate),this._person=null)},e}();t.default=r},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=n(5),a=n(2),c=n(69),l=n(7),u=n(153),d=n(0),p=n(15),h=n(151),f=n(9),g=n(137),v=n(434),m="isUnderQuarantine",_="isBlocked",y="swift-narrow",w=function(e){function t(n,i){var s=e.call(this,n.conversation,i)||this;return s._params=n,s._canMarkNewMessage=!1,s._fetchingInProgress=!1,s._isFirstLoad=!0,s._crMessage=null,s._unreadSplitter=null,s._blockedChatMsg=null,s.lastScrollStartTime=0,s.init=function(){s.conversation.subscribe(m,s._onQuarantineHandlerSubscripion),s.conversation.subscribe(_,s._onBlockedHandlerSubscripion),s.conversation.consumptionHorizon.subscribe("value",function(){s._updateUnreadSplitter()}),d.swc.services.mePersonManager.fetch().then(function(e){s.meUserName=e.id,s._initConversationMessagesList(),s._addBotGreetingMessage(),s._addWelcomeMessage(),s._updateUnreadSplitter(),s._scrollToBottom(),s._setMinHeight(),s.viewport.addEventListener("scroll",s._onScroll),s._messagesEl=s._element.querySelector(".messages"),s.isShowMessages(!s.conversation.isBlocked),s.isBlocked(s.conversation.isBlocked);var t=g.default.instance;t.forceWidth(s._messagesEl.offsetWidth),t.addResizeHandler(s._onResize),t.CurrentStyle===g.StyleModes.NARROW&&s._messagesEl.classList.add(y),d.swc.Eventing.registerEvent("viewRestored",function(e){e===s.conversation.id&&(s._updateUnreadSplitter(!0),setTimeout(s._scrollToBottom,0))})},function(e){f.default.throwError(101010,"Unable to fetch me person in messages list VM")}),d.swc.Eventing.registerEvent(o.ApiEvents.RemoveAllMessagesFromUi,s.removeAllMessagesFromUI),d.swc.Eventing.registerEvent(o.ApiEvents.scrollToBottom,function(e){return e===s.conversation.id&&s._scrollToBottom()}),s.scroll=new c.default(s._element,s.viewport)},s.removeAllMessagesFromUI=function(e){e===s.conversation.id&&s._removeAllMessagesFromUI()},s._onResize=function(){s.scroll.recount()},s._onScroll=function(){s.lastScrollStartTime=Date.now(),s.isScrolling=!0,s.messagesList().length&&s.viewport.scrollTop<4*(s.viewport.clientHeight||500)&&!s._fetchingInProgress&&(s._fetchingInProgress=!0,-1===s._lastScrollPositionFromBottomBeforeFetching&&(s._lastScrollPositionFromBottomBeforeFetching=s.viewport.scrollHeight-s.viewport.scrollTop),s.conversation.loadMoreMessages().then(function(){return s._fetchingInProgress=!1})),s.viewport.scrollTop<s.viewport.scrollHeight-s.viewport.offsetHeight-500&&s.showJumpArrow(!0),s.viewport.scrollTop+250>=s.viewport.scrollHeight-s.viewport.offsetHeight&&s.showJumpArrow(!1),s.scrollingTimer||(s.scrollingTimer=setTimeout(function(){Date.now()-500>s.lastScrollStartTime&&(s.isScrolling=!1,d.swc.services.pesManager.refresh(),s.lastScrollStartTime=0,s.scrollingTimer=null)},500)),h.default.remove()},s.dispose=function(){s.conversation&&s.conversation.messages&&(s.conversation.messages.unsubscribe(s._onNewMessages),s.conversation.messages.spliceObservable(0,s.conversation.messages.length)),s.messagesList().forEach(function(e){e.dispose()}),s.viewport.removeEventListener("scroll",s._onScroll),g.default.instance.removeResizeHandler(s._onResize),s.messagesList.removeAll(),s.conversation.unsubscribe(m,s._onQuarantineHandlerSubscripion),s.conversation.unsubscribe(_,s._onBlockedHandlerSubscripion)},s._initConversationMessagesList=function(){if(s.conversation.messages.length>0){s._canMarkNewMessage=!0,t.initTelemetrySent||(t.initTelemetrySent=!0);for(var e=0,n=s.conversation.messages;e<n.length;e++){var i=n[e];if(s._checkUserMessageSent(i))break}s._addMessagesToUI(s.conversation.messages),setTimeout(s._scrollToBottom,0)}s.conversation.messages.subscribe(s._onNewMessages.bind(s))},s.addMessage=function(e){var t=new u.default(!1);t.type=l.MessageType.UserMessage,t.direction=l.Direction.Incoming,t.content=e,t.status=-1,s.conversation.messages.pushObservable(t)},s._checkUserMessageSent=function(e){return!!s._params.userMessageSent()||("UserMessage"===e.type&&e.direction===l.Direction.Outgoing&&(s._params.userMessageSent(!0),s._setMinHeight()),!1)},s._onNewMessages=function(e,n){var i;s._canMarkNewMessage||(s._canMarkNewMessage=!0),t.initTelemetrySent||(t.initTelemetrySent=!0),s._isFirstLoad&&r.default.get.isTeams()&&s.messagesList().length>1&&s.messagesList(s.messagesList().filter(function(e){return e.type!==l.MessageType.Welcome}));var o=s.messagesList().length-1,a=s.messagesList()[o]?s.messagesList()[o].timestamp.getTime():0,c=n.newItems?n.newItems.slice():[],u=n.oldItems?n.oldItems.slice():[];if(s._isFirstLoad&&1===s.messagesList().length){var p=s.messagesList()[0],h=e.filter(function(e){return e.id===p.id})[0];h&&(c.unshift(h),u.unshift(p))}var f=[],g=[];if(u.length&&s._removeMessagesFromUI(u),c.length&&c.forEach(function(e){e&&e.content;s._checkUserMessageSent(e),e.isDeleted||s.conversation.definition.HideSystemMessages&&e.type===l.MessageType.SystemMessage||(e.content||0!==e.files.length)&&(a<=e.timestamp.getTime()?f.push(e):g.push(e))}),s._isFirstLoad&&setTimeout(s._scrollToBottom,0),g.length){for(var v=s.messagesList()[0],m=[],_=s.viewport.scrollTop-s.viewport.scrollHeight,y=function(e){for(var t=s.messagesList().length-1;t>=0;t--)if(s.messagesList()[t].timestamp.getTime()<e.timestamp.getTime())return t;return-1},w=0;w<g.length;w++){var b=g[w];if(v&&b.timestamp<=v.timestamp)m.push(b);else{var C=y(b)+1;s.messagesList.splice(C,0,b),s.adjustAuthorInfo(C,C+1)}}m.length&&((i=s.messagesList).unshift.apply(i,m),s.adjustAuthorInfo(0,g.length)),s.viewport.scrollTop=s.viewport.scrollHeight+_}if(f.length){s._addMessagesToUI(f);var E=s.messagesList().length-f.length,S=E>0?E-1:0;s.adjustAuthorInfo(S,s.messagesList().length);var I=f[f.length-1].direction===l.Direction.Outgoing;(s._needUpdateScroll()||I)&&setTimeout(s._scrollToBottom,0)}(s._isFirstLoad&&e.length||f.length)&&(s._processSuggestedActions(e[e.length-1]),s._isFirstLoad=!1),s._updateUnreadSplitter(),s.scroll.recount(),d.swc.services.pesManager.refresh()},s._onMessageDeleted=function(e){e&&s._updateUnreadSplitter()},s.convContainerNode=i.parentElement,s._onQuarantineHandlerSubscripion=s.onQuarantineHandler.bind(s),s._onBlockedHandlerSubscripion=s.onBlockedHandler.bind(s),s._params.enable()?s.init():s._params.enable.subscribe(function(e){return e&&s.init()}),s}return s(t,e),t.prototype._addMessagesToUI=function(e){var t,n=this;e.forEach(function(e){e.subscribe("isDeleted",n._onMessageDeleted)}),(t=this.messagesList).push.apply(t,e)},t.prototype._removeMessagesFromUI=function(e){var t=this;e.forEach(function(e){e.unsubscribe("isDeleted",t._onMessageDeleted)}),this.messagesList.removeAll(e)},t.prototype._removeAllMessagesFromUI=function(){var e=this;this.messagesList().forEach(function(t){t.unsubscribe("isDeleted",e._onMessageDeleted)}),this.messagesList.removeAll()},t.prototype._setMinHeight=function(){this.clientHeight(this.viewport.clientHeight?this.viewport.clientHeight+"px":"100%")},t.prototype._addWelcomeMessage=function(){var e=a.Configuration.ECS.hideWelcomeOnHosts;if(e&&e.some(function(e){return p.UrlHelper.getHost()===e||r.default.get.host===e}))return;var t=new u.default(!1);t.type=l.MessageType.Welcome,t.status=l.DeliveryStatus.Sent,this.messagesList.push(t)},t.prototype.onQuarantineHandler=function(){if(this.conversation.isUnderQuarantine&&!this._crMessage){this._crMessage=new u.default(!0),this._crMessage.type=l.MessageType.SystemMessage;var e="";!this.person&&this.conversation.isPerson&&(this.person=d.swc.services.persons.getPerson(this.conversation.id),e=this.person.displayName||this.person.id),this._crMessage.content=d.swc.services.i18n.fetch("waiting_for_replay",{user_name:e}),this.messagesList.push(this._crMessage)}else!this.conversation.isUnderQuarantine&&this._crMessage&&(this.messagesList.remove(this._crMessage),this._crMessage=null)},t.prototype.onBlockedHandler=function(){this.isShowMessages(!this.conversation.isBlocked),this.isBlocked(this.conversation.isBlocked)},t.prototype._addBotGreetingMessage=function(){var e=this;this.conversation.isAgent&&(void 0!==this.conversation.isNew?this.conversation.isNew&&this.person&&(this.person.description&&this.addMessage(this.person.description),this.person.subscribe("description",function(t){e.addMessage(t)})):this.conversation.subscribe("isNew",function(t){e._addBotGreetingMessage()}))},t.prototype._needUpdateScroll=function(){return!(this.viewport.scrollTop>=this.viewport.scrollHeight-this.viewport.offsetHeight)},t.prototype.adjustAuthorInfo=function(e,t){var n;e>0?n=this.messagesList()[e-1]:(n=this.messagesList()[e],e++);for(var i=e;i<t;i++){var s=this.messagesList()[i];if(!n)return;var o=s.timestamp.getTime()-n.timestamp.getTime();s.isFirst=s.senderId!==n.senderId||o>12e4,n=s}},t.prototype._updateUnreadSplitter=function(e){if(void 0===e&&(e=!1),!this._unreadSplitter){var t=new u.default(!1);t.content=d.swc.services.i18n.fetch("unread_messages"),t.type=l.MessageType.UnreadSplitter,this._unreadSplitter=t}e&&this.messagesList.remove(this._unreadSplitter);var n=this.messagesList();if(!e){var i=this.messagesList.indexOf(this._unreadSplitter);if(this._shouldRemoveSplitter(n,i))return void this.messagesList.remove(this._unreadSplitter);if(i>-1)return}var s=this._getAddSplitterIndex(n);s>-1&&this.messagesList.splice(s,0,this._unreadSplitter)},t.prototype._shouldRemoveSplitter=function(e,t){if(t<0)return!1;if(t===e.length-1)return!0;for(var n=!0,i=t+1;i<e.length;i++){var s=e[i];if(d.swc.services.mePersonManager.isMe(s.senderId))return!0;var o=s.type===l.MessageType.UserMessage,r=s.type===l.MessageType.SystemMessage;(o||r)&&(n=n&&s.isDeleted)}return n},t.prototype._getAddSplitterIndex=function(e){for(var t=this.conversation.consumptionHorizon,n=e.length-1,i=!1,s=e.length-1;s>=0;s--){var o=e[s];t.lastReadMessageId===o.getKey()&&(n=s)}for(s=e.length-1;s>n;s--){o=e[s];if(!d.swc.services.mePersonManager.isMe(o.senderId)){var r=o.type===l.MessageType.UserMessage,a=o.type===l.MessageType.SystemMessage;!r&&!a||o.isDeleted||(i=!0)}}return i?n+1:-1},t.initTelemetrySent=!1,t}(v.default);t.default=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(14),o=n(62),r=n(435),a="swc:action:click",c=".message",l=function(){return function(e,t){var n=this;this._element=t,this.messagesList=ko.observableArray(),this.isShowMessages=ko.observable(!0),this.isBlocked=ko.observable(!1),this.clientHeight=ko.observable("100%"),this.blockChatMsg=ko.observable(i.swc.services.i18n.fetch("area_text_disabled")),this.languages=ko.observableArray(),this.showSuggestedActions=ko.observable(!1),this.hasSuggestedActionOnLeft=ko.observable(!0),this.hasSuggestedActionOnRight=ko.observable(!0),this.translatorActive=ko.observable(!1),this.translator_active=ko.observable(i.swc.services.i18n.fetch("translator_active",{0:"<strong>",1:"</strong>"})),this.isConnected=ko.observable(!0),this.no_connection=ko.observable(i.swc.services.i18n.fetch("no_connection")),this.showJumpArrow=ko.observable(!1),this.label_scrollToBottom=ko.observable(i.swc.services.i18n.fetch("scroll_to_bottom")),this._isScrollAnimating=!1,this._lastScrollPositionFromBottomBeforeFetching=-1,this.invokeSuggestedAction=function(e){e&&"function"==typeof e.action&&e.action()},this.suggestionChanged=function(){var e;e=0!==n._suggestionArea.scrollLeft,n.hasSuggestedActionOnLeft(e),e=n._suggestionArea.scrollLeft!==n._suggestionArea.scrollWidth-n._suggestionArea.clientWidth,n.hasSuggestedActionOnRight(e)},this.scrollSuggestionsToBeginning=function(){n._scrollSuggestedArea(0)},this.scrollSuggestionsToLeft=function(){n._scrollSuggestedArea(n._suggestionArea.scrollLeft-n._suggestionArea.clientWidth)},this.scrollSuggestionsToRight=function(){n._scrollSuggestedArea(n._suggestionArea.scrollLeft+n._suggestionArea.clientWidth)},this.newMessageAddeded=function(e){Object.keys(i.swc.Eventing.registry).length&&s.MessageUtils.attachActionToLinks(e,c,a,n._swcClickEventHandler)},this.newMessageRendered=function(e){if(n.conversation.definition.MessageContentLimit&&e&&0!==e.length){var t=e[0].nextElementSibling;if(t&&t.classList.contains("message")&&t.classList.contains("other")&&!t.querySelector(".swift")){var i=t.getBoundingClientRect();n._shouldLimit(i.height)&&(t.classList.add("limited"),t.classList.add("less"),t.querySelector(".bubble").style.maxHeight=n.conversation.definition.MessageContentLimit)}}},this._shouldLimit=function(e){var t=!!n.conversation.definition.MessageContentLimit;if(!t)return!1;var i=parseInt(n.conversation.definition.MessageContentLimit.replace("px",""),10);return t&&i<e},this.jumpToBottom=function(){return n._scrollToBottom()},this._scrollToBottom=function(){n.viewport.scrollTop=n.viewport.scrollHeight,i.swc.services.pesManager.refresh()},this._scrollToLast=function(){-1!==n._lastScrollPositionFromBottomBeforeFetching&&(n.viewport.scrollTop=n.viewport.scrollHeight-n._lastScrollPositionFromBottomBeforeFetching,n._lastScrollPositionFromBottomBeforeFetching=-1)},this._swcClickEventHandler=function(e){var t=e.target.getAttribute("data-swc-payload"),n=e.target.getAttribute("href");t&&i.swc.Eventing.triggerEvent("click",t),n.toLowerCase().indexOf("swc:preventdefault=false")<0&&e.preventDefault()},this._processSuggestedActions=function(e){e&&e.suggestedActions.length?(n.suggestedActions(e.suggestedActions),n.showSuggestedActions(!0),n.suggestionChanged(),n.scrollSuggestionsToBeginning(),setTimeout(function(){return n._scrollToBottom()},250)):(n.suggestedActions([]),n.showSuggestedActions(!1))},this._scrollSuggestedArea=function(e){r.scrollTo(e,250,"scrollLeft",n._suggestionArea,function(){return n.suggestionChanged()})},this.viewport=this._element.querySelector(".swc-scroll-viewport"),this.conversation=e,this._suggestionArea=t.querySelector(".suggestionArea"),this.suggestedActions=ko.observableArray([]),window.addEventListener("resize",function(){n.suggestionChanged()}),o.get().subscribe("isOnline",this.isConnected)}}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scrollTo=function e(t,n,i,s,o){var r="scrollLeft"===i?s.scrollLeft:s.scrollTop,a=(t-r)/n*10;setTimeout(function(){var c=r+a;"scrollLeft"===i?s.scrollLeft=c:s.scrollTop=c,n-=10,c===t||n<=0?o&&o():e(t,n,i,s,o)},10)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(251),r=function(){return function(e,t,n){n.innerHTML="";var r={componentConfig:t,params:e},a=s.createElement(o.SignIn,r);i.render(a,n)}}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),s=n(2),o=n(69),r=n(7),a=n(0),c=n(31),l=n(283),u=function(){function e(e,t){var n=this;this._params=e,this._element=t,this.addPeopleToChat=a.swc.services.i18n.fetch("conversation_add_people_to_chat"),this.cancelText=a.swc.services.i18n.fetch("sign_in_cancel"),this.confirmNewChatText=a.swc.services.i18n.fetch("new_chat_button_confirm_selection"),this.settings={},this.selectedParticipants=ko.observableArray([]),this._selectedContactVMs=[],this.hasSelectedParticipants=function(){return n.selectedParticipants().length>0},this.addParticipant=function(e){if(!n.selectedParticipants().some(function(t){return t.person.id===e.person.id})){var t=new l.ParticipantVM(e.person,n.selectedParticipantsList,n.removeParticipant);n.selectedParticipants.push(t),n._selectedContactVMs.push(e),n._notifyOnParticipantChanges(),n.scrollParticipants.recount(),n.scrollSearch.recount()}},this.removeParticipant=function(e){n.selectedParticipants.remove(e),e.containerElement.removeChild(e.participantEl);for(var t=0;t<n._selectedContactVMs.length;t++){n._selectedContactVMs[t].person.id===e.person.id&&n._selectedContactVMs.splice(t,1)}n._notifyOnParticipantChanges(),n.scrollParticipants.recount(),n.scrollSearch.recount()},this.triggerFocusToSearch=function(){a.swc.Eventing.triggerEvent(i.SearchEvents.FOCUS_SEARCH_INPUT,n.correlationId)},this._notifyOnParticipantChanges=function(){n._triggerParticipantsChange(n._selectedContactVMs),n.triggerFocusToSearch(),n.addParticipantParentAction&&n.addParticipantParentAction(n.selectedParticipants().length)},this._getSelectedParticipants=function(){for(var e=[],t=n.selectedParticipants(),i=0;i<t.length;i++){var s=t[i]?t[i].person.id:null;if(!s||a.swc.services.mePersonManager.isMe(s))break;e.push({id:c.default.toFullIdentifier(s),role:r.ParticipantRole.User})}return e},this._triggerParticipantsChange=function(e){a.swc.Eventing.triggerEvent(i.ParticipantEvents.SELECTED_PARTICIPANTS_CHANGE,{id:n.correlationId,selectedParticipants:e})},this.confirmParticipantsView=function(){var e=n._getSelectedParticipants();n.confirmAction&&n.confirmAction(e),n.emptyVMData()},this.dispose=function(){n.selectedParticipants([]),n._selectedContactVMs=[]},this.emptyVMData=function(){for(n._selectedContactVMs=[],n.selectedParticipants([]),n._triggerParticipantsChange([]);n.selectedParticipantsList.firstChild;)n.selectedParticipantsList.removeChild(n.selectedParticipantsList.firstChild);a.swc.Eventing.triggerEvent(i.SearchEvents.EMPTY_SEARCH_INPUT,{id:n.correlationId})},this.searchSettings={actionOnResult:this.addParticipant,showHeaders:!1,showCounter:!0,placeHolder:!0,showContactListAsDefault:!0,isRecentListComponent:!1,showSearchIcon:!1},this.selectedParticipantsList=this._element.querySelector(".addParticipants-selectedItems"),this.participantsContainer=this._element&&this._element.querySelector(".participants-scrollArea"),this.participantsViewport=this.participantsContainer&&this.participantsContainer.querySelector(".swc-scroll-viewport"),this.searchContainer=this._element&&this._element.querySelector(".search-scrollArea"),this.searchViewPort=this.searchContainer&&this.searchContainer.querySelector(".swc-scroll-viewport"),this.definition=this._params.definition,this.conversation=this._params.conversation,this.cancelAction=this._params.controlActions.cancel,this.confirmAction=this._params.controlActions.confirm,this.settings.showTitle=this._params.settings?this._params.settings.showTitle:null,this.correlationId=this._params.settings?this._params.settings.id:null,this._isNewChatControl=this._params.settings.isNewChatControl,this.addParticipantParentAction=this._params.controlActions.add,this.triggerFocusToSearch(),a.swc.Eventing.registerEvent(i.ApiEvents.onControlClose,function(e){var t=n._isNewChatControl?s.Configuration.NEW_CHAT_COMPOSER_ID:n.conversation?n.conversation.id:"";e&&e.id===t&&n.emptyVMData()}),a.swc.Eventing.registerEvent(i.ApiEvents.OnVisibilityChange,function(e){e&&e.key===s.Configuration.NEW_CHAT_COMPOSER_ID&&"show"===e.type&&n.triggerFocusToSearch()}),this.scrollParticipants=new o.default(this.participantsContainer,this.participantsViewport),this.scrollSearch=new o.default(this.searchContainer,this.searchViewPort),this.confirmButtonText=this._isNewChatControl?a.swc.services.i18n.fetch("button_create_new_chat"):a.swc.services.i18n.fetch("button_add_participants")}return e.prototype.cancelParticipantsView=function(){var e=this._getSelectedParticipants();this.cancelAction&&this.cancelAction(e),this.emptyVMData()},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=n(26),o=n(8);t.Participant=function(e){var t=["actionItem"];return e.canBeRemoved&&t.push("canRemove"),e.selectedForRemoval&&t.push("selected"),i.createElement("li",{className:t.join(" "),onclick:e.action||void 0,"aria-label":e.canBeRemoved?e.removeParticipantText:void 0,"aria-selected":e.selectedForRemoval,title:e.canBeRemoved?e.removeParticipantText:void 0,"data-id":e.person.id},i.createElement(s.SwcPersonAvatar,{size:s.SwcAvatarSize.Small,person:e.person}),i.createElement("p",{className:"title"},e.person.displayName),i.createElement("button",{className:"cancel",title:e.removeParticipantText,"aria-label":e.removeParticipantText},i.createElement(o.SwcIcon,{type:o.SwcIconType.Cancel})))}},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(70),r=n(133),a=n(0),c=n(89),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.confirmAddParticipants=function(e){t._mePersonId||(t._mePersonId=a.swc.services.mePersonManager.mePerson.id);var n={role:"Admin",id:a.swc.services.mePersonManager.mePerson.mri};e.push(n),t.titleInput.value.trim()?t._createNew(e):r.findRecentConversationIdForMembers(e).then(function(e){c.default.startChat(e,t.definition,!1,o.OpenChatOrigin.NEWCHAT),t.closeNewChatWindow()}).catch(function(n){t._createNew(e)})},t._createNew=function(e){t._createConversation(e),t.closeNewChatWindow()},t}return s(t,e),t}(n(284).default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),s=n(69),o=n(7),r=n(0),a=n(41),c=n(283),l=function(){function e(e,t){var n=this;this._params=e,this.element=t,this.cancelText=r.swc.services.i18n.fetch("sign_in_cancel"),this.removeButtonText=r.swc.services.i18n.fetch("button_remove_participants"),this.removePeopleFromChat=r.swc.services.i18n.fetch("conversation_remove_people_to_chat"),this.removeParticipantText=r.swc.services.i18n.fetch("new_chat_button_remove_selection"),this.confirmRemovingParticipantsText=r.swc.services.i18n.fetch("new_chat_button_confirm_selection"),this.existingParticipants=ko.observableArray([]),this.canRemoveParticipants=ko.observable(!1),this.defaultAvatar="",this._updateAndSubscribeSelfParticipant=function(){n._setSelfParticipantProperties(),n.conversation.selfParticipant.subscribe("role",n._setSelfParticipantProperties),n.conversation.selfParticipant.subscribe("capabilities",n._setSelfParticipantProperties)},this._setSelfParticipantProperties=function(){if(!i.default.get.isTeams()){var e=n.conversation.selfParticipant;n.canRemoveParticipants(e.role===o.ParticipantRole.Admin||e.capabilities.some(function(e){return e===o.ParticipantCapabilities.kickMember}))}},this._createParticipant=function(e){return new c.ParticipantVM(e,n.existingParticipantsList,n.toggleAddForRemoval,n.canRemoveParticipants)},this._createMeParticipant=function(e){return new c.ParticipantVM(e,n.existingParticipantsList,void 0,ko.observable(!1))},this.addExisting=function(e){var t=!1,i=e.person;if(n.existingParticipants().forEach(function(e){e.person.id===i.id&&(t=!0)}),!t){var s=r.swc.services.mePersonManager.isMe(i.id)?n._createMeParticipant(i):n._createParticipant(i);n.existingParticipants.push(s),n.scroll&&n.scroll.recount()}},this.removeExisting=function(e){for(var t=0;t<n.existingParticipants().length;t++){var i=n.existingParticipants()[t];e.person.id===i.person.id&&(n.existingParticipants.splice(t,1),n._removeParticipantNode(i))}n.scroll.recount()},this.onParticipantsUpdate=function(e,t){t.oldItems&&t.oldItems.forEach(n.removeExisting),t.newItems&&t.newItems.forEach(n.addExisting)},this.toggleAddForRemoval=function(e){n.canRemoveParticipants()&&e.selectedForRemoval(!e.selectedForRemoval())},this._removeParticipantNode=function(e){e.containerElement&&e.containerElement.removeChild(e.participantEl)},this._getSelectedIds=function(){for(var e=[],t=n.existingParticipants(),i=0;i<t.length;i++){var s=t[i];s.selectedForRemoval()&&e.push(a.default.getWrappedIdWithMri(s.person))}return e},this.confirmRemovingParticipants=function(){var e=n._getSelectedIds();n.confirmAction&&n.confirmAction(e),n.unSelectAll()},this.unSelectAll=function(){n.existingParticipants().forEach(function(e){e.selectedForRemoval(!1)})},this.dispose=function(){n.existingParticipants([]),n.existingParticipantsObserver&&n.existingParticipantsObserver.dispose(),n.hasSelectedItems.dispose()},this.definition=this._params.definition,this.conversation=this._params.conversation,this.cancelAction=this._params.controlActions.cancel,this.confirmAction=this._params.controlActions.confirm,this.existingParticipantsList=t.querySelector(".removeParticipants-list"),this.container=t&&this.element.querySelector(".swc-scroll-wrapper"),this.viewport=t&&this.element.querySelector(".swc-scroll-viewport"),this.scroll=new s.default(this.container,this.viewport);var l=this.conversation.participants;this.existingParticipantsObserver=l.subscribe(this.onParticipantsUpdate),this.onParticipantsUpdate(l,{newItems:l,oldItems:[]}),this.hasSelectedItems=ko.computed(function(){var e=!1;return n.existingParticipants().forEach(function(t){t.selectedForRemoval()&&(e=!0)}),e}),this.conversation.isOneOnOne||this.conversation.subscribe("selfParticipant",this._updateAndSubscribeSelfParticipant)}return e.prototype.cancelParticipantsView=function(){this.cancelAction&&this.cancelAction(),this.unSelectAll()},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(5),r=n(11),a=n(73),c=n(0),l=n(20),u=n(12),d=n(151),p=n(26),h=n(101),f="https://"+a.default.pesCDNAuthentication.cdnServiceHost+"/pes/v1/emoticons/",g=a.default.profiles.emoticons.getSmall(),v=function(){function e(e,t,n){var f=this;this.element=n,this.reactions=ko.observableArray([]),this.showReactionsBar=ko.observable(!1),this.ecsTeamsReactionsPack=["yes"],this._removeItems=function(e){e.forEach(function(e){o.default.get.backend===r.MessagingBackend.TEAMS&&"like"===e.key&&(e.key="yes");for(var t=0;t<f.reactions().length;t++){var n=f.reactions()[t];e.key===n.id&&f.reactions().splice(t,1)}})},this._addItems=function(e){e.forEach(function(e){var t;if(0!==e.users.length){o.default.get.backend===r.MessagingBackend.TEAMS&&"like"===e.key&&(e.key="yes");var n=null,i=f._pesEmoticonMap[e.key];if(i){for(var s=0;s<f.reactions().length;s++){var a=f.reactions()[s];e.key===a.id&&(n=a)}n?n.users=e.users:(!o.default.get.isTeams()||o.default.get.isTeams()&&f.ecsTeamsReactionsPack.indexOf(e.key)>-1)&&(t=f.reactions).push.apply(t,[f._mapEmoticonToReactionItem(i,e)])}}})},this._mapEmoticonToReactionItem=function(e,t){var n=e.description||e.id;return{id:e.id,url:f.getEmoticonUrl(e.id),users:t.users,title:c.swc.services.i18n.fetch("reactions_see_who_reacted_text",{key:n})}},this.getEmoticonUrl=function(e){return e?'url("'+f._getUrl(e)+'")':""},this.getUserListNames=function(e){var t="",n=null,i=[];return f.reactions().forEach(function(t){t.id===e&&(n=t)}),n&&n.users.forEach(function(e){var t=e.person.displayName||e.person.id;i.push(t)}),i.length>0&&(t=i.join("\n")),t},this._getDisplayName=function(e){var t=e.displayName||e.id;return e.id===f._mePersonId&&(t+=" "+f._reactionsYouText),t},this.onKeyDown=function(e,t){var n=l.default.getKeyCode(t);n!==u.default.ENTER&&n!==u.default.SPACE||t.target.click()},this.showReactionPreview=function(e,t){var n=document.createElement("div");n.className="reactionPreviewWrapper";var o=document.createElement("div");o.classList.add("reactionPreviewArea");var r={large:!0,largeEmoticonClass:"extraLarge",emoticonId:e.id,title:e.title,isAnimated:!0},a=s.createElement(h.SwcEmoticon,r),l=document.createDocumentFragment();if(i.render(a,l),o.appendChild(l),n.appendChild(o),e.users&&e.users.length){var u=document.createElement("div");u.className="reactionPreviewUsers",e.users.forEach(function(e){var t=document.createElement("div");t.className="userItem";var n=document.createDocumentFragment(),o={person:e.person,size:p.SwcAvatarSize.SuperSmall},r=s.createElement(p.SwcPersonAvatar,o);i.render(r,n),t.appendChild(n);var a=document.createElement("span");a.className="name",a.innerText=f._getDisplayName(e.person),t.appendChild(a),u.appendChild(t)}),n.appendChild(u)}t.preventDefault(),t.stopPropagation();var g=t.target,v={target:t.target,clientX:t.clientX||g.getBoundingClientRect().right,clientY:t.clientY||g.getBoundingClientRect().top};d.default.add(v,f._messageList,n,d.BubbleType.ReactionPreview,d.BubblePosition.onContextMenu),c.swc.services.pesManager.refresh()},this._messageList=t,this._pesEmoticonMap=c.swc.services.pesManager.emoticonMap,this.showHighDpiClass=a.default.highDpi,this._addItems(e.emotions),this.showReactionsBar(!!this.reactions().length),this._reactionsYouText=c.swc.services.i18n.fetch("reactions_you_text"),this._mePersonId=c.swc.services.mePersonManager.mePerson.id,e.emotions.subscribe(function(e,t){t.newItems&&t.newItems.length>0?f._addItems(t.newItems):t.oldItems&&t.oldItems.length>0&&f._removeItems(t.oldItems),f.showReactionsBar(!!f.reactions().length)})}return e.prototype._getUrl=function(e){return f+e+"/views/"+g},e}();t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(1),o=n(443),r=n(285),a=function(){return function(e,t,n){this._params=e,this.recentsDataConfig=t,this.element=n,n.innerHTML="";var a={settings:e.settings||r.DEFAULT_SETTINGS,id:e.id,recentList:this._params.RecentList},c=s.createElement(o.SearchInput,a);i.render(c,n)}}();t.default=a},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(4),c=n(0),l=n(12),u=n(8),d=n(65),p="",h=400,f=function(e){return c.swc.services.i18n.fetch(e)},g=function(e){function t(t){var n=e.call(this,t)||this;return n.lastSearchQuery=p,n.onQueryChanged=function(e){var t=e.target.value,i=(t||"").trim().toLowerCase();n.setState({searching:!!i,query:t},function(){n.props.onInput&&n.props.onInput(e)}),i?n.search(i):n.exit()},n.focus=function(){return n.inputRef&&setTimeout(function(){return n.inputRef.focus()})},n.clear=function(){n.setState({query:p,searching:!1}),n.lastSearchQuery=p},n.exit=function(){n.clear(),c.swc.Eventing.triggerLocalEvent(a.SearchEvents.RESET_PARTICIPANTS_SEARCH_RESULT,{id:n.props.id})},n.startSearch=function(e){e===n.props.id&&n.setState({searching:!0})},n.onBlur=function(){n.props.settings.isRecentListComponent&&n.state.searching&&!n.state.query&&n.exit()},n.onKeyDown=function(e){var t=e.keyCode;return t===l.default.ESCAPE?(n.state.searching&&(n.exit(),e.preventDefault(),e.stopPropagation()),!1):t!==l.default.BACKSPACE||n.state.query?t!==l.default.ENTER:(n.exit(),e.preventDefault(),!1)},n.state={query:p,searching:!1},c.swc.Eventing.registerEvent(a.SearchEvents.EMPTY_SEARCH_INPUT,n.clear),c.swc.Eventing.registerEvent(a.SearchEvents.SEARCH_CREATE_CONTACTLIST,n.startSearch),c.swc.Eventing.registerEvent(a.SearchEvents.FOCUS_SEARCH_INPUT,function(e){e===n.props.id&&n.focus()}),n.search=d(function(e){e!==n.lastSearchQuery&&(c.swc.Eventing.triggerLocalEvent(a.SearchEvents.UPDATE_SEARCH_RESULTS,{query:e,id:n.props.id}),n.lastSearchQuery=e)},h,{leading:!0}),n}return s(t,e),t.prototype.componentDidMount=function(){this.focus()},t.prototype.componentWillUnmount=function(){this.clear()},t.prototype.render=function(){var e=this,t=f("sign_in_cancel");return r.createElement("div",{className:"searchInputWrapper",role:"search","aria-label":f("search_label"),"data-test-id":this.props.dataTestId},this.props.settings.showSearchIcon&&r.createElement(u.SwcIcon,{size:u.SwcIconSize.Medium,type:u.SwcIconType.Search}),r.createElement("input",{onInput:this.onQueryChanged,onBlur:this.onBlur,onFocus:this.props.onFocus,onKeyDown:this.onKeyDown,value:this.state.query,placeholder:this.props.settings.placeHolder?f("search"):p,ref:function(t){return e.inputRef=t},type:"text","data-test-id":"searchContactsInput",className:"searchContactsInput"}),this.props.settings.isRecentListComponent&&this.state.searching&&!!this.state.query&&r.createElement("button",{title:t,onClick:this.exit,"aria-label":t,className:"iconClose"},r.createElement(u.SwcIcon,{size:u.SwcIconSize.Medium,type:u.SwcIconType.Cancel})))},t}(o.Component);t.SearchInput=g},function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(1),a=n(4),c=n(5),l=n(2),u=n(70),d=n(134),p=n(0),h=n(57),f=n(41),g=n(56),v=n(247),m=function(e,t){return p.swc.services.i18n.fetch(e,t)},_=function(e){function t(t){var n=e.call(this,t)||this;return n.resetParticipantsResult=function(){n.setState({peopleList:[],botList:[],contactList:n.state.initialContacts.reduce(n.personReducer,[]).sort(f.default.sortByName),resultsCount:0})},n.fetchMyContacts=function(){p.swc.services.signInManager.onceSignedIn().then(function(){p.swc.services.contactsManager.fetchMyContacts().then(function(e){var t=e&&e.contacts?e.contacts:null,i=t?t.reduce(n.personReducer,[]).sort(f.default.sortByName):[];n.setState({contactList:i,initialContacts:e.contacts})},function(){})})},n.startSearching=function(e){var t=e.toLowerCase();t&&(n.searchContacts(t),n.searchPeople(t),n.searchBots(t),p.swc.Telemetry.sendEvent.contactsSearch(e))},n.searchContacts=function(e){var t=n.state.initialContacts.filter(function(t){var n=g.normalizeString(t.name),i=t.skypeid.toLowerCase();return n.indexOf(e)>-1||i.indexOf(e)>-1}).reduce(n.personReducer,[]).sort(f.default.sortByName);t.length>0&&n.setState({contactList:t})},n.searchPeople=function(e){p.swc.services.searchManager.searchSkypeDirectory(e).then(function(e){var t=f.default.mapSearchProfileInfo(e).reduce(n.personReducer,[]),i=f.default.getSortedByRelevance(t);i.length>0&&n.setState({peopleList:i}),p.swc.Eventing.triggerLocalEvent(a.ScrollEvents.SCROLL_RECOUNT,{id:n.state.correlationId})},function(){})},n.searchBots=function(e){p.swc.services.searchManager.searchAgents(e).then(function(e){var t=e.reduce(n.personReducer,[]).sort(f.default.sortByName);t.length>0&&n.setState({botList:t}),p.swc.Eventing.triggerLocalEvent(a.ScrollEvents.SCROLL_RECOUNT,{id:n.state.correlationId})},function(){})},n.personReducer=function(e,t){var i=p.swc.services.persons.getPerson(t.skypeid);return n.props.conversation&&n.props.conversation.participants&&n.props.conversation.participants.some(function(e){return e.person.id===i.id})?e:n.state.selectedParticipants.length>0&&n.state.selectedParticipants.some(function(e){return e.person.id===i.id})?e:n.props.recentList&&n.isInRecent(n.props.recentList,i.mri.toLowerCase())?e:(e.push({person:i,rawPerson:t}),e)},n.isInRecent=function(e,t){return c.default.get.isTeams()?e.some(function(e){return e.withPerson&&e.withPerson.mri===t}):e.some(function(e){return e.id===t})},n.getResultsCount=function(){var e=n.state,t=e.peopleList,i=e.botList;return t.length+i.length},n.startChatAction=function(e,t){t.stopPropagation();var i=n.props.settings.actionOnResult;"function"==typeof i&&(i(e,u.OpenChatOrigin.SEARCH),setTimeout(function(){p.swc.Eventing.triggerLocalEvent(a.SearchEvents.EMPTY_SEARCH_INPUT,{id:n.props.id})}),p.swc.Telemetry.sendEvent.searchAction(d.ActionType.OpenChat,e.rawPerson.type))},n.resetResults=function(){n.setState({peopleList:[],botList:[],contactList:[],resultsCount:0})},n.state={correlationId:t.id,peopleList:[],botList:[],contactList:[],initialContacts:[],selectedParticipants:[],resultsCount:0,isFirstTime:!0,isSearching:!1},n}return s(t,e),t.prototype.componentDidMount=function(){var e=this;this.fetchMyContacts(),p.swc.Eventing.registerEvent(a.SearchEvents.SEARCH_CREATE_CONTACTLIST,function(){e.setState({isSearching:!0})}),p.swc.Eventing.registerEvent(a.ApiEvents.onControlClose,function(t){t.id===l.Configuration.NEW_CHAT_COMPOSER_ID&&e.setState({selectedParticipants:[]})}),p.swc.Eventing.registerEvent(a.SearchEvents.UPDATE_SEARCH_RESULTS,function(t){t.id===e.state.correlationId&&(e.resetResults(),t.query&&e.startSearching(t.query))}),p.swc.Eventing.registerEvent(a.ParticipantEvents.SELECTED_PARTICIPANTS_CHANGE,function(t){e.state.correlationId===t.id&&(p.swc.Eventing.triggerLocalEvent(a.SearchEvents.EMPTY_SEARCH_INPUT,{id:e.props.id}),e.setState(function(){return{selectedParticipants:t.selectedParticipants}},function(){return e.resetParticipantsResult()}))}),p.swc.Eventing.registerEvent(a.SearchEvents.RESET_PARTICIPANTS_SEARCH_RESULT,this.resetParticipantsResult)},t.prototype.componentWillUnmount=function(){this.resetResults()},t.prototype.render=function(){var e=this,t=this.props.settings,n=this.state,i=n.peopleList,s=n.botList,a=n.contactList;return n.isSearching&&r.createElement(h.AccessibleList,null,r.createElement("div",{role:"none",className:"searchResultsWrapper"},a.length>0&&r.createElement("div",{role:"none",className:"searchHeader"},r.createElement("h3",null,m("text_contacts"))),a.length>0&&r.createElement("div",{role:"list","aria-label":m("text_contacts"),className:"contactsWrapper","data-test-id":"contactsWrapper"},a.map(function(t){return r.createElement(v.Contact,{key:t.person.id,person:t.person,displayName:t.person.displayName,mutualFriendCount:c.default.get.isTeams()?null:t.rawPerson.mutualFriendCount,jobTitle:t.rawPerson.jobTitle,contactId:t.person.id,onClick:o.linkEvent(t,e.startChatAction)})})),t.showCounter&&this.getResultsCount()>0&&r.createElement("div",{role:"none",className:"searchHeader"},r.createElement("h3",null,m("search_results",{resultscount:this.getResultsCount()}))),t.showHeaders&&i.length>0&&r.createElement("div",{role:"none",className:"searchHeader"},r.createElement("h3",null,m("text_people"))),i.length>0&&r.createElement("div",{role:"list","aria-label":m("text_people"),className:"contactsPeopleWrapper"},i.map(function(t){return r.createElement(v.Contact,{key:t.person.id,person:t.person,displayName:t.person.displayName,mutualFriendCount:c.default.get.isTeams()?null:t.rawPerson.mutualFriendCount,showPersonId:!c.default.get.isTeams(),jobTitle:t.rawPerson.jobTitle,contactId:t.person.id,onClick:o.linkEvent(t,e.startChatAction)})})),t.showHeaders&&s.length>0&&r.createElement("div",{role:"none",className:"searchHeader"},r.createElement("h3",null,m("text_bots"))),s.length>0&&r.createElement("div",{role:"list","aria-label":m("text_bots"),className:"contactsBotWrapper"},s.map(function(t){return r.createElement(v.Contact,{key:t.person.id,person:t.person,displayName:t.person.displayName,contactId:t.person.id,onClick:o.linkEvent(t,e.startChatAction)})}))))},t}(o.Component);t.SearchResults=_},function(e,t){e.exports='<div class="down-arrow" data-bind="css: {\'show-down-arrow\': showJumpArrow()}">\r\n    <button class="down-btn" data-bind="text: label_scrollToBottom, click: jumpToBottom"></button>\r\n</div>\r\n<div class="swc-scroll-viewport"\r\n     data-bind="keyboardNavigation: { itemSelector: \'.message:not(.welcome)\', selectLastItem: true }">\r\n    <div class="messages">\r\n        \x3c!-- ko if: isShowMessages() --\x3e\r\n            \x3c!-- ko foreach: {data: messagesList, afterAdd:newMessageAddeded, afterRender: newMessageRendered} --\x3e\r\n                \x3c!-- ko component: {\r\n                    name: \'messageitem\',\r\n                    params: {\r\n                        message: $data,\r\n                        conversation: $parent.conversation,\r\n                        conversationContainer: $parent.convContainerNode,\r\n                        meUserName: $parent.meUserName,\r\n                        suggestedActions: $parent.suggestedActions\r\n                    }\r\n                } --\x3e\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: isBlocked() --\x3e\r\n            <div class="message content system" data-messagetype="SystemMessage" >\r\n                <span class="text" data-bind="html: blockChatMsg()"></span>\r\n            </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="branding" aria-hidden="true" tabindex="-2" data-bind="css: {emptyBottomMargin: showSuggestedActions()}">\r\n            <typing-indicator params="conversation: conversation"></typing-indicator>\r\n            <div class="translate" data-bind="css: { isTranslating: translatorActive}">\r\n                <div class="translation-globe">\r\n                    <span class="swcIcon swcIcon_globe" aria-hidden="true"></span>\r\n                </div>\r\n                    <div data-bind="html: translator_active()">\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="suggested-actions" data-bind="css: {\'show-suggested-actions\': showSuggestedActions()}">\r\n            \x3c!-- ko if: showSuggestedActions() --\x3e\r\n            <div class="navBtnWrapper" data-bind="click: scrollSuggestionsToLeft, css: { disabled: !hasSuggestedActionOnLeft()}">\r\n                <div class="left" role="button" role="button" data-bind="attr: {tabindex: hasSuggestedActionOnLeft() ? 0 : undefined}">\r\n                    <span class="swcIcon swcIcon_navigationBackCentered swcIcon_size_medium" aria-hidden="true"></span>\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="suggestionArea actionItems" data-bind="foreach: {data: suggestedActions}, scroll: suggestionsChanged">\r\n                <button class="actionItem" data-bind="click: $parent.invokeSuggestedAction,\r\n                    attr: {title: actionType === \'openUrl\' ? value : \'\'}, css: {icon: (actionType === \'openUrl\' || actionType === \'call\') }">\r\n                    \x3c!-- ko if: actionType === \'openUrl\' --\x3e\r\n                    <span class="swcIcon swcIcon_link" aria-hidden="true"></span>\r\n                    \x3c!-- /ko --\x3e\r\n                    \x3c!-- ko if: actionType === \'call\' --\x3e\r\n                    <span class="swcIcon swcIcon_callStart" aria-hidden="true"></span>\r\n                    \x3c!-- /ko --\x3e\r\n                    <p data-bind="html: title"></p>\r\n                </button>\r\n            </div>\r\n            \x3c!-- ko if: showSuggestedActions() --\x3e\r\n            <div class="navBtnWrapper" data-bind="click: scrollSuggestionsToRight, css: { disabled: !hasSuggestedActionOnRight()}">\r\n                <div role="button" data-bind="attr: {tabindex: hasSuggestedActionOnRight() ? 0 : undefined}">\r\n                    <span class="swcIcon swcIcon_navigationForwardCentered swcIcon_size_medium" aria-hidden="true"></span>\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        <div class="status-msg" data-bind="css: {\'show-status\': !isConnected()}">\r\n            <div class="down-btn" data-bind="attr: {tabindex: isConnected() ? undefined : 0}, text: no_connection()"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script type="text/html" id="swiftUnsupported">\r\n    <div class="lwx-message">\r\n        <div class="card unsupported">\r\n            <div class="text">\r\n                <div data-bind="text: unsupportedText"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftSingleCard">\r\n<div class="lwx-message" role="listitem">\r\n    \x3c!-- ko template: { name: \'contentSection\' } --\x3e\x3c!-- /ko --\x3e\r\n    <div class="card" data-bind="template: { name: cards[0].getContentTypeName() === \'hero\' || cards[0].getContentTypeName() === \'thumb\' ? \'swiftCard\' : \'swiftCard-\' + cards[0].getContentTypeName(), data: cards[0]}, css: cards[0].getContentTypeName()"></div>\r\n</div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftMultilineCard">\r\n    <div class="lwx-message multiline">\r\n        \x3c!-- ko template: { name: \'contentSection\' } --\x3e\x3c!-- /ko --\x3e\r\n        <div class="carouselContainer" data-bind="css: { multiLine: areButtonsMultiLine },\r\n                                          foreach: {\r\n                                              data: cards,\r\n                                              as: \'card\'\r\n                                          }">\r\n            <div class="card" data-bind="template: { name: card.getContentTypeName() === \'hero\' || card.getContentTypeName() === \'thumb\' ? \'swiftCard\' : \'swiftCard-\' + card.getContentTypeName(), data: card },\r\n                                        css: card.getContentTypeName()"></div>\r\n\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCarouselCard">\r\n    <div class="lwx-message carousel" data-bind="css: { first: isFirst, last: isLast, multiple: isMultiple, double: cards.length == 2, triple: cards.length == 3 }">\r\n        \x3c!-- ko template: { name: \'contentSection\' } --\x3e\x3c!-- /ko --\x3e\r\n        <div class="carouselContainer" data-bind="css: { multiLine: areButtonsMultiLine },\r\n                                          foreach: {\r\n                                              data: cards,\r\n                                              as: \'card\',\r\n                                              afterRender: function(e, card) { e[1].addEventListener(\'focus\', function() { moveToCard(card); }, true); }\r\n                                          },\r\n                                          style: { left: carouselLeftPosition() }">\r\n            <div class="card" data-bind="template: { name: card.getContentTypeName() === \'hero\' || card.getContentTypeName() === \'thumb\' ? \'swiftCard\' : \'swiftCard-\' + card.getContentTypeName(), data: card },\r\n                                        css: card.getContentTypeName()"></div>\r\n\r\n        </div>\r\n        <div class="prev" data-bind="click: prevCard, enterKey: prevCard, attr: { title: prevCardTitle }">\r\n            <div class="button" role="button" tabindex="0">\r\n                <span class="swcIcon swcIcon_navigationBackCentered swcIcon_size_small" aria-hidden="true"></span>\r\n            </div>\r\n        </div>\r\n        <div class="next" data-bind="click: nextCard, enterKey: nextCard, attr: {title: nextCardTitle}">\r\n            <div class="button" role="button" tabindex="0">\r\n                <span class="swcIcon swcIcon_navigationForwardCentered swcIcon_size_small" aria-hidden="true"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard">\r\n    <div class="cardContent" data-bind="attr: { tabindex: (content.tap && content.tap.isValid()) ? -1 : null, role: (content.tap && content.tap.isValid()) ? \'presentation\' : null, title: (content.tap && content.tap.isValid()) ? content.tap.tooltip : null },\r\n                                              css: { tap: content.tap && content.tap.isValid() },\r\n                                              enterKey: (content.tap && content.tap.isValid()) ? content.tap.action : null,\r\n                                              click: (content.tap && content.tap.isValid()) ? content.tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: content.mainSection.isValid() --\x3e\r\n        \x3c!-- ko template: { name: \'swiftSection\', data: content.mainSection } --\x3e\x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-flex">\r\n    <div class="cardContent" data-bind="attr: { tabindex: (content.tap && content.tap.isValid()) ? -1 : null, role: (content.tap && content.tap.isValid()) ? \'presentation\' : null, title: (content.tap && content.tap.isValid()) ? content.tap.tooltip : null },\r\n                                              css: { tap: content.tap && content.tap.isValid() },\r\n                                              enterKey: (content.tap && content.tap.isValid()) ? content.tap.action : null,\r\n                                              click: (content.tap && content.tap.isValid()) ? content.tap.action : null, clickBubble: false">\r\n        <div class="section">\r\n            \x3c!-- ko if: content.title || content.subtitle || content.text --\x3e\r\n            <div class="textContent">\r\n                \x3c!-- ko if: content.subtitle --\x3e\r\n                <h2 data-bind="html: content.subtitle, attr: { title: $element.textContent }"></h2>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: content.title --\x3e\r\n                <h1 data-bind="html: content.title, attr: { title: $element.textContent }"></h1>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: content.text --\x3e\r\n                <p class="normal" data-bind="html: content.text, attr: { title: $element.textContent }, css: content.expandedText() "></p>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.images.length > 0 --\x3e\r\n            \x3c!-- ko with: content.images[0] --\x3e\r\n            <div class="image" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'button\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n\r\n                <img data-bind="attr: { src: url(), alt: alt, width: uiSize().width, height: uiSize().height }" />\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- ko if: content.buttons.length > 0 --\x3e\r\n        <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n\r\n<script type="text/html" id="swiftCard-receipt">\r\n    <div data-bind="attr: { tabindex: (content.tap && content.tap.isValid()) ? 0 : null, role: (content.tap && content.tap.isValid()) ? \'button\' : null, title: (content.tap && content.tap.isValid()) ? content.tap.tooltip : null },\r\n                                              css: { tap: content.tap && content.tap.isValid() },\r\n                                              enterKey: (content.tap && content.tap.isValid()) ? content.tap.action : null,\r\n                                              click: (content.tap && content.tap.isValid()) ? content.tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: content.title --\x3e\r\n        <h1 data-bind="html: content.title"></h1>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: content.facts.length !== 0 --\x3e\r\n        <div class="facts" role="list" data-bind="foreach: { data: content.facts, as: \'fact\' }">\r\n            \x3c!-- ko template: { name: \'swiftFact\', data: fact } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: content.displayedItems().length !== 0 --\x3e\r\n        <div class="items" role="list" data-bind="foreach: { data: content.displayedItems, as: \'item\' }">\r\n            <div class="item" role="listitem">\r\n                \x3c!-- ko template: { name: item.images.length !== 0 ? \'swiftSection\' : \'swiftItem\', data: item } --\x3e\x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: content.showFoldButton --\x3e\r\n        <div class="button fold" data-bind="attr: { tabindex: -1, role: \'button\', title: content.foldButtonText() },\r\n                                   enterKey: content.triggerFoldAction,\r\n                                   click: content.triggerFoldAction, clickBubble: false">\r\n            <span class="normal" data-bind="text: content.foldButtonText()"></span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="summary">\r\n            \x3c!-- ko if: content.vat --\x3e\r\n            <div class="line">\r\n                <span class="key normal" data-bind="text: content.vatText"></span>\r\n                <span class="value normal" data-bind="text: content.vat"></span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.tax --\x3e\r\n            <div class="line">\r\n                <span class="key normal" data-bind="text: content.taxText"></span>\r\n                <span class="value normal" data-bind="text: content.tax"></span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="line">\r\n                <span class="key normal" data-bind="text: content.totalPriceText"></span>\r\n                <span class="value normal" data-bind="text: content.total"></span>\r\n            </div>\r\n        </div>\r\n        <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-signin">\r\n    <div class="text" data-bind="html: content.text"></div>\r\n    <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }">\r\n        \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftSection">\r\n    <div class="section" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'presentation\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                css: { tap: tap && tap.isValid() },\r\n                enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: subtitle || title || price || text --\x3e\r\n        <div class="textContent">\r\n            \x3c!-- ko if: subtitle --\x3e\r\n                <h2 data-bind="html: subtitle, attr: { title: $element.textContent }"></h2>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: title --\x3e\r\n                <h1 data-bind="html: title, attr: { title: $element.textContent }"></h1>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: price --\x3e\r\n                <span class="price normal" data-bind="html: price, attr: { title: $element.textContent }"></span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: text --\x3e\r\n                <p class="normal" data-bind="html: text, attr: { title: $element.textContent }, css: { expandedText: expandedText() }"></p>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: images.length > 0 --\x3e\r\n            \x3c!-- ko with: images[0] --\x3e\r\n                \x3c!-- ko if: isValid() && url() --\x3e\r\n                <div class="image" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'button\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n\r\n                    <img data-bind="attr: { src: url(), alt: alt, width: uiSize().width, height: uiSize().height },\r\n                                    style: { bottom: bottomAlignment() + \'px\'}" />\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftButton">\r\n    <div class="lwx-message button" data-bind="attr: { tabindex: isValid() ? -1 : null, role: isValid() ? \'button\' : null, title: tooltip },\r\n                                   enterKey: isValid() ? action : null,\r\n                                   click: isValid() && !isCallActionType ? action : null, clickBubble: false">\r\n\r\n            \x3c!--  ko if: !isCallActionType --\x3e\r\n            <span class="normal" data-bind="text: title"></span>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!--  ko if: isCallActionType && value --\x3e\r\n            <a data-bind="text: title, attr: { href: value }"></a>\r\n            \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftFact">\r\n    <div class="fact" role="listitem">\r\n        <span class="key normal" data-bind="html: key"></span>\r\n        <span class="value normal" data-bind="html: value"></span>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftItem">\r\n    <span class="swc-title" data-bind="html: title"></span>\r\n    <span class="price normal" data-bind="text: price"></span>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-video">\r\n    <div class="cardContent" data-bind="css: content.aspect">\r\n        <div class="videoCard">\r\n            <videoplayer params="media: content.media.video, thumbnail: content.image.url, autoplay: content.autostart, muted: true, autoloop: false, displayMuteButton: true, messageId: $component.message.id, title: content.title, subtitle: content.subtitle"></videoplayer>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-audio">\r\n    <div class="cardContent">\r\n        <div class="audioCard">\r\n            <div class="audio-message" data-bind="css: {thumbnail: content.hasThumbnail()}">\r\n                <div class="media-holder">\r\n                    <div class="media-content">\r\n                        <audioplayer params="media: content.media.audio, autoplay: content.autostart, messageId: $component.message.id, coverImage: content.image"></audioplayer>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-animation">\r\n    <div class="cardContent">\r\n        <div class="animationCard">\r\n            <gifplayer params="media: content.media.animation, coverImage: content.image"></gifplayer>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="contentSection">\r\n    \x3c!-- ko if: content --\x3e\r\n    <div class="card" data-bind="css: cards[0].getContentTypeName()">\r\n        <div class="cardContent">\r\n            <div class="section">\r\n                <div class="textContent">\r\n                    <p class="normal" data-bind="html: content"></p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="mediaCardSection">\r\n    \x3c!-- ko if: content.hasTextInfo() --\x3e\r\n    <div class="section">\r\n        <div class="textContent">\r\n            \x3c!-- ko if: content.title --\x3e\r\n            <h1 data-bind="text: content.title, attr: { title: content.title }"></h1>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.subtitle --\x3e\r\n            <h2 data-bind="text: content.subtitle, attr: { title: content.subtitle }"></h2>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: content.media --\x3e\r\n                \x3c!-- ko if: content.media.sourceDomain --\x3e\r\n                <h3 class="domain" data-bind="text: content.media.sourceDomain, attr: { title: content.media.sourceDomain }"></h3>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    <div class="buttons" data-bind="foreach: { data: content.buttons, as: \'button\' }, css: { multiLine: content.areButtonsMultiLine}">\r\n        \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard-adaptive">\r\n    <adaptivecard params="content: content, conversation: _conversation"></adaptivecard>\r\n<\/script>\r\n\r\n'},function(e,t){e.exports='<div class="typingIndicator" data-bind="css: {isTyping: isTyping()}">\r\n    <div class="bubble"></div>\r\n    <div class="bubble"></div>\r\n    <div class="bubble"></div>\r\n    <div>\r\n        <span data-bind="text: typingIndicator"></span>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="dragAndDropContainer" data-bind="event: {\r\n        click: onClicked,\r\n        dragenter: onDragEnter,\r\n        dragover: onDragOver,\r\n        dragleave: onDragLeave,\r\n        drop: onDrop\r\n     }, visible: !showAddParticipants() && !showRemoveParticipants() && !showShowParticipants()">\r\n    \x3c!-- ko if: showLoginPage --\x3e\r\n    <lwc-signin params="isSignedIn: signedIn, isConversationWithPerson: conversation.isPerson" data-bind="css:{anim:animateLoginScreen}"></lwc-signin>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: signedIn --\x3e\r\n    \x3c!-- ko if: chatDataConfig.ShowHeader --\x3e\r\n    <div class="swc-header" data-bind="style: {background: titleBackground }">\r\n        <div class="titlebar" data-bind="css:{unread:unreadMessageCounter()>0, focused: isTitleFocused()},\r\n                style: {background: titleBackground}, click: toggleChatSize,\r\n                event: {focusin: onTitleFocusIn, focusout: onTitleFocusOut}">\r\n            <div class="headerAvatar" aria-label="avatar"></div>\r\n            <div class="topic">\r\n                <div class="swc-title" data-bind="attr:{\'aria-label\':title}, style:{color:titleColor}, text: title"></div>\r\n                <div class="terms">\r\n                    \x3c!-- ko if: showTermsOfUse --\x3e\r\n                    <a class="termsOfUse" data-bind="attr:{href:termOfUse}, text: termOfUseText" target="_blank"></a>\r\n                    \x3c!-- /ko --\x3e\r\n\r\n                    \x3c!-- ko if: showPrivacyStatement --\x3e\r\n                    <a class="privacy" data-bind="attr:{href:privacyStatement}, text: privacyStatementText" target="_blank"></a>\r\n                    \x3c!-- /ko --\x3e\r\n                </div>\r\n            </div>\r\n            <div class="counter">\r\n                <p data-bind="text:unreadMessageCounter"></p>\r\n            </div>\r\n            \x3c!-- ko if: showCalling() --\x3e\r\n            <button data-bind="enable: videoEnabled(), click: startVideoCall, attr: { title: startVideoCalling }" class="calling video">\r\n                <span\r\n                    class="swcIcon swcIcon_size_medium"\r\n                    data-bind="css: {\r\n                        swcIcon_video: videoEnabled(),\r\n                        swcIcon_videoOff: !videoEnabled(),\r\n                        swcIcon_disabled: !videoEnabled()\r\n                    }"\r\n                    aria-hidden="true">\r\n                </span>\r\n            </button>\r\n            <button data-bind="enable: audioEnabled(), click: startAudioCall, attr: { title: startAudioCalling }" class="calling audio">\r\n                <span\r\n                    class="swcIcon swcIcon_size_medium"\r\n                    data-bind="css: {\r\n                        swcIcon_callStart: audioEnabled(),\r\n                        swcIcon_callDisabled: !audioEnabled(),\r\n                        swcIcon_disabled: !audioEnabled()\r\n                    }"\r\n                    aria-hidden="true">\r\n                </span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n\r\n             \x3c!-- ko if: chatDataConfig.CanCollapse--\x3e\r\n            <button data-bind="attr:{title: minimizeWindow}" class="minimize collapse">\r\n                <span class="swcIcon swcIcon_minus swcIcon_size_medium" aria-hidden="true"></span>\r\n            </button>\r\n            \x3c!--/ko  --\x3e\r\n\r\n            \x3c!-- ko if: canClose() --\x3e\r\n            <button data-bind="click:close, attr:{ title: closeWindow }" class="close">\r\n                <span class="swcIcon swcIcon_cancel swcIcon_size_medium" aria-hidden="true"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- ko if: showActionsBar() --\x3e\r\n        <div class="actionsbar">\r\n            \x3c!-- ko if: showParticipantsControl() --\x3e\r\n                <button data-bind="click: openRemoveParticipantsView, attr: { title: openRemoveParticipants }" >\r\n                    <span class="swcIcon swcIcon_contact swcIcon_size_medium" aria-hidden="true"></span>\r\n                </button>\r\n                <span class="actionBtnText" data-bind="attr: { title: participantsCountLabel }">\r\n                    <span data-bind="text: participantsCount" aria-hidden="true"></span>\r\n                </span>\r\n                <div class="separator"></div>\r\n            \x3c!-- /ko  --\x3e\r\n            \x3c!-- ko if: showCalling() && !suppressCallingControls() --\x3e\r\n            <button data-bind="enable: videoEnabled(), click: startVideoCall, attr: { title: startVideoCalling }" class="calling video">\r\n                <span\r\n                    class="swcIcon swcIcon_size_medium"\r\n                    data-bind="css: {\r\n                        swcIcon_video: videoEnabled(),\r\n                        swcIcon_videoOff: !videoEnabled(),\r\n                        swcIcon_disabled: !videoEnabled()\r\n                    }"\r\n                    aria-hidden="true">\r\n                </span>\r\n            </button>\r\n            <button data-bind="enable: audioEnabled(), click: startAudioCall, attr: { title: startAudioCalling }" class="calling audio">\r\n                <span\r\n                    class="swcIcon swcIcon_size_medium"\r\n                    data-bind="css: {\r\n                        swcIcon_callStart: audioEnabled(),\r\n                        swcIcon_callDisabled: !audioEnabled(),\r\n                        swcIcon_disabled: !audioEnabled()\r\n                    }"\r\n                    aria-hidden="true">\r\n                </span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: showParticipantsControl() --\x3e\r\n            <button data-bind="click: openAddParticipantsView, visible: canAddParticipants, attr: { title: openAddParticipants }" >\r\n                <span class="swcIcon swcIcon_contactAdd swcIcon_size_medium" aria-hidden="true"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: showOtherActions() && showMoreActionsBtn() --\x3e\r\n            <button aria-haspopup="true" class="rosterMenuListBtn" data-bind="click: openMoreActions, attr: { title: openMoreActionsText }">\r\n                <span class="swcIcon swcIcon_more swcIcon_size_medium" aria-hidden="true"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="warningbar"></div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <messages-list role="list" aria-live="polite" class="swc-scroll-wrapper" data-bind="css: {\'no-header\': !chatDataConfig.ShowHeader, \'collapsed\': isCollapsed()}"  params="conversation: conversation, userMessageSent: userMessageSent, enable: enable"></messages-list>\r\n\r\n    \x3c!-- ko if: isGuest() && !userMessageSent() --\x3e\r\n    <div class="msa-privacy">\r\n        <div data-bind="html: ms_service_privacy_agreement" class="text"></div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="action-bar" data-bind="css: {collapsed: isCollapsed()}"></div>\r\n    <div class="chat-input" data-bind="css: {collapsed: isCollapsed()}"></div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: showBrand --\x3e\r\n    <div class="skypeBrandMessage" data-bind="text:brandMessage"></div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\r\n\x3c!-- ko if: showParticipantsControl() --\x3e\r\n    <add-participants class="addParticipantsComponent" params="definition: chatDataConfig,\r\n        controlActions: {\r\n             confirm: addParticipantsToConversation,\r\n             cancel: closeAddParticipantsView\r\n        },\r\n        settings: { showTitle: true, id: correlationId },\r\n        conversation: conversation" data-bind="visible: showAddParticipants()"></add-participants>\r\n    <remove-participants class="removeParticipants" params="definition: chatDataConfig,\r\n        controlActions: {\r\n             confirm: removeParticipantsFromConversation,\r\n             cancel: closeRemoveParticipantsView\r\n        },\r\n        conversation: conversation" data-bind="visible: showRemoveParticipants()"></remove-participants>\r\n\x3c!-- /ko --\x3e\r\n'},function(e,t){e.exports="\r\n"},function(e,t){e.exports='<div class="swc-header newChat">\r\n    <div class="titlebar">\r\n        <div class="textField">\r\n            <input class="newChatInput swc-title" type="text" data-bind="\r\n                attr: { placeholder: isCreatingGroupChat()\r\n                ? enterGroupNameText : addToNewGroupText },\r\n                enable: isCreatingGroupChat(), css: {editable: isCreatingGroupChat()}"/>\r\n        </div>\r\n        <button class="close" data-bind="click: cancel,\r\n            attr:{title: cancelText}">\r\n            <span class="swcIcon swcIcon_cancel swcIcon_size_medium" aria-hidden="true"></span>\r\n        </button>\r\n    </div>\r\n</div>\r\n\r\n<add-participants class="newChatParticipantsComponent" params="definition: definition,\r\n    controlActions: {\r\n        confirm: confirmAddParticipants,\r\n        add: onSelectedParticipantsChange\r\n},\r\nsettings: { showTitle: false, isNewChatControl: true, id: correlationId}"></add-participants>\r\n'},function(e,t){e.exports='<div class="addParticipants">\r\n    <div class="addParticipantsHeader" data-bind="visible: settings.showTitle">\r\n        <h3 class="header" data-bind="text: addPeopleToChat"></h3>\r\n        <button class="cancel" tabindex="0" data-bind="click: cancelParticipantsView,\r\n                attr: { title: cancelText }">\r\n            <span class="swcIcon swcIcon_cancel swcIcon_size_medium" aria-hidden="true"></span>\r\n        </button>\r\n    </div>\r\n\r\n    <div class="participants-scrollArea swc-scroll-wrapper" data-bind="visible: hasSelectedParticipants()">\r\n        <ul class="addParticipants-selectedItems swc-scroll-viewport" data-bind="foreach: selectedParticipants"></ul>\r\n    </div>\r\n\r\n    <chat-search-input class="searchInputComponent"\r\n        params="settings: searchSettings, id: correlationId, conversation: conversation"></chat-search-input>\r\n    <div class="search-scrollArea swc-scroll-wrapper">\r\n            <chat-search-results class="searchResultsComponent swc-scroll-viewport"\r\n            params="settings: searchSettings, id: correlationId, conversation: conversation"></chat-search-results>\r\n    </div>\r\n</div>\r\n\r\n<div class="addParticipantsFooter" data-bind="visible: hasSelectedParticipants()">\r\n    <button class="confirm add" data-bind="click: confirmParticipantsView,\r\n            text: confirmButtonText,\r\n            enable: hasSelectedParticipants(),\r\n            attr:{ title: confirmButtonText }">\r\n    </button>\r\n</div>\r\n'},function(e,t){e.exports='<div class="removeParticipantsHeader">\r\n    <h3 class="header" data-bind="text: removePeopleFromChat"></h3>\r\n    <button class="cancel" tabindex="0" data-bind="\r\n            click: cancelParticipantsView,\r\n            attr: { title: cancelText, \'aria-label\': cancelText}">\r\n        <span class="swcIcon swcIcon_cancel swcIcon_size_medium" aria-hidden="true"></span>\r\n    </button>\r\n</div>\r\n\r\n<div class="removeParticipantsBody swc-scroll-wrapper">\r\n    <ul class="removeParticipants-list swc-scroll-viewport"\r\n        data-bind="keyboardNavigation: { itemSelector: \'.actionItem\' }"></ul>\r\n</div>\r\n\r\n<div class="removeParticipantsFooter" data-bind="visible: hasSelectedItems()">\r\n    <button class="confirm" data-bind="click: confirmRemovingParticipants,\r\n            text: removeParticipantText,\r\n            enable: hasSelectedItems(),\r\n            attr:{ title: removeParticipantText },\r\n            css: { \'disabled\': !hasSelectedItems() }">\r\n    </button>\r\n</div>\r\n'},function(e,t){e.exports="<div></div>"},function(e,t){e.exports="<div></div>"},function(e,t){e.exports='\r\n\x3c!-- ko if: showReactionsBar --\x3e\r\n<ul class="reactionsItems" data-bind="foreach: { data: reactions(), as: \'reaction\' }">\r\n    <li tabindex="-1" class="reactionItem" data-bind="click: $parent.showReactionPreview, event: { keydown: $parent.onKeyDown }">\r\n        <span class="emoticon" data-bind="attr:\r\n            { title: reaction.title, \'aria-label\': reaction.title },\r\n            style: { \'background-image\' : $parent.getEmoticonUrl(reaction.id) },\r\n            css: { highDpi: $parent.showHighDpiClass }">\r\n        </span>\r\n        <span class="counter" data-bind="text: reaction.users.length"></span>\r\n    </li>\r\n</ul>\r\n\x3c!-- /ko --\x3e\r\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.getView=function(t){var n=e.views[t];if(!n){var i=document.createElement("div");i.innerHTML=e.templates[t],n=e.views[t]=i}return n.firstElementChild.cloneNode(!0)},e.views={},e.templates={skype:'\n            <div class="conversation skype-conversation swc-focus-outline-area" data-bind="component: {\n                name: \'conversation\',\n                params: {\n                    conversation: conversation,\n                    enable: enable\n                }\n            }"></div>\n        '},e}();t.default=i}]);