window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.FileProviderStore.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[105,7],{1933:function(e,t,n){"use strict";var r=n(0),i=n(2090),o=n.n(i),a=n(1983),s=n.n(a);function u(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i,a,u,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return i=s()({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),a=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(u=new Headers).append("X-OWA-ActionName",a),c={headers:u,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0},[4,o()(i,c)];case 1:return[4,(l=r.sent()).json()];case 2:return[2,{token:r.sent(),response:l}]}})})}var c=n(2091),l=n.n(c),d=n(20),f=n(139),p=function(e,t,n){return r.__assign({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},m=function(e){return"TokenRetrievalError"===e._typeSpec},v={},h=1,_=30,b="",g="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function T(e){v[e]=null}function y(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,u(e,t,n)];case 1:return i=r.sent(),function(e,t,n){var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var i="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,o=n.response.headers.get("x-tokenresult"),a=null!=o&&o.indexOf(g)>0;throw p(new Error(i),r.TokenResultCode,a)}var s=v[e]||{};s[t]=r,v[e]=s}(e,t,i),[2,i.token]}})})}function w(e,t,n){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){var i,o;return r.__generator(this,function(r){return i=b,n&&(o=Object(f.parse)(n),i=Object(d.format)("{0}//{1}/",o.protocol,o.hostname)),[2,P(e,i,t)]})})}function S(e,t,n){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){return[2,P(0,e,t,n)]})})}function P(e,t,n,i){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){var o,a;return r.__generator(this,function(r){switch(r.label){case 0:return n||!function(e,t){var n=v[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var i=new Date(r.AccessTokenExpiry),o=l()(new Date(Date.now()),h);return null!=i&&o<i}(e,t)?[3,1]:(o=v[e],a=o[t],l()(new Date(Date.now()),_)>new Date(a.AccessTokenExpiry)&&y(e,t,i),[2,a.AccessToken]);case 1:return[4,y(e,t,i)];case 2:return[2,(a=r.sent()).AccessToken]}})})}function O(e,t,n){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return[4,w(e,t,n)];case 1:return[2,"Bearer "+r.sent()]}})})}var k="https://www.googleapis.com/drive/v3/files";function R(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),r.__awaiter(this,void 0,void 0,function(){var i,o,a;return r.__generator(this,function(r){switch(r.label){case 0:return i=n.forceTokenRefresh,o=n.requestInit||{},[4,O(t,i,e)];case 1:return a=r.sent(),o.headers||(o.headers=new Headers),o.headers.set("Authorization",a),[4,fetch(e,o)];case 2:return[2,r.sent()]}})})}function j(e,t){return void 0===t&&(t=!1),r.__awaiter(this,void 0,void 0,function(){var n,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,R(k+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i)}];case 3:return[2,{errorResponse:n,result:null}]}})})}function D(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,R(k+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}})})}var I,E="_api/v2.0/drive",C=E+"/items",x="root",A=n(129),N=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function F(){return Object.keys(N).map(function(e){return N[e]}).join(",")}function M(e,t,n,i,o,a,s){return void 0===a&&(a=I.None),r.__awaiter(this,void 0,void 0,function(){var u,c,l,d,p,m,v;return r.__generator(this,function(r){switch(r.label){case 0:return o=o||x,u=function(e){switch(e){case 0:return N.name;case 1:return N.size;default:return N.lastModifiedDateTime}}(n),c=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(A.a)(e)}}(i),l="expand=thumbnails(select=medium)&orderby=folder,"+u+" "+c+"&select="+F(),a!==I.None&&(l=l+"&filter="+function(e){switch(e){case I.None:return"";case I.Folder:return"("+N.folder+" ne null)";default:return Object(A.a)(e)}}(a)),s&&(l=l+"&$top="+s.maxEntries,s.skipToken&&(l=l+"&$skiptoken="+s.skipToken)),[4,R(e+"/"+C+"/"+o+"/children?"+l,t,{requestInit:{headers:new Headers({Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"})}})];case 1:return(d=r.sent()).ok?[4,d.text()]:[3,3];case 2:return p=r.sent(),m=JSON.parse(p),v=m["@odata.nextLink"]?function(e){var t=Object(f.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(m["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:m.value,skipToken:v}}];case 3:return[2,{errorResponse:d,result:null}]}})})}function q(e,t,n,i){return r.__awaiter(this,void 0,void 0,function(){var o,a,s,u,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return i=i||x,o="expand=thumbnails(select=medium)&select="+F(),a=t+"/"+C+"/"+i+"/children?"+o,s={name:n,folder:{}},(u=new Headers).append("Content-Type","application/json"),u.append("Accept","application/json"),[4,R(a,e,{requestInit:{method:"POST",body:JSON.stringify(s),headers:u}})];case 1:return(c=r.sent()).ok?[4,c.text()]:[3,3];case 2:return l=r.sent(),[2,{errorResponse:null,result:JSON.parse(l)}];case 3:return[2,{errorResponse:c,result:null}]}})})}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(I||(I={}));var L=n(2278);var z,U=n(190);!function(e){e[e.Id=0]="Id",e[e.SpecialFolder=1]="SpecialFolder"}(z||(z={}));var B=Object.freeze({folderInfo:{type:0,identifier:x},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function H(e,t,n){var i=this,o=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:r.__awaiter(i,void 0,void 0,function(){var i,a,s,u,c,l,d,f,p,m,v,h,_,b,g,T,y,w;return r.__generator(this,function(S){switch(S.label){case 0:switch(function(e){Object.keys(B).forEach(function(t){e[t]=e[t]||B[t]})}(n),i=n.fileToUpload,a=i.fileName,s=i.fileBlob,u=n.folderInfo,c=u.type,l=u.identifier,d=n.conflictBehavior,f=n.sliceSize,p=n.onProgress,c){case 0:m=t+"/"+C+"/"+l+":/"+encodeURI(a)+":/createUploadSession";break;case 1:m=t+"/"+E+"/"+l+":/"+encodeURI(a)+":/createUploadSession";break;default:Object(A.a)(c)}return v={item:{"@name.conflictBehavior":d}},h=new Headers({"Content-Type":"application/json",Accept:"application/json"}),[4,R(m,e,{requestInit:{method:"POST",body:JSON.stringify(v),headers:h}})];case 1:return(_=S.sent()).ok?[4,_.text()]:[3,4];case 2:return b=S.sent(),g=JSON.parse(b),T=function(e,t,n,i){var o=this,a=e.uploadUrl,s=t.size,u=null,c=null,l=function(e,t,n,i,o,a){var s=this;return function(u,c){return r.__awaiter(s,void 0,void 0,function(){var s,l,d,f,p;return r.__generator(this,function(r){switch(r.label){case 0:return s=function(e,t,n){var r=W(e,t,n),i=r.rangeStart,o=r.rangeEnd;return new Headers({"Content-Range":"bytes "+i+"-"+o+"/"+n,Accept:"application/json"})}(c,t,n),l=function(e){var r=W(e,t,n).rangeStart;return function(e){var t=e.loaded,o=r+t;i({loaded:o,total:n})}}(c),[4,(m=e,v=l,h={method:"PUT",body:u,headers:s},void 0===h&&(h={method:"POST"}),new Promise(function(e,t){var n=h.method,r=h.body,i=h.headers,o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&e({status:o.status,text:function(){return Promise.resolve(o.responseText)}})},o.ontimeout=function(){t(new Error("Request timed out"))},o.onerror=function(){t(new Error("Request failed"))},o.onabort=function(){t(new Error("Request aborted"))},v&&(o.upload.onprogress=v),o.open(n,m,!0),new Headers(i).forEach(function(e,t){o.setRequestHeader(t,e)}),r?o.send(r):o.send()}))];case 1:return 201!==(d=r.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=r.sent(),p=JSON.parse(f),o(p),r.label=3;case 3:if(!Object(U.a)(d.status))throw a(d),new Error("Unable to upload file");return[2]}var m,v,h})})}}(a,n,s,i,function(e){u=e},function(e){c=e}),d=Object(L.a)(t,l,{sliceSize:n,numberOfSlicesToParallelize:1}),f=d.onCompletePromise,p=d.cancel,m=r.__awaiter(o,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,f];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:c,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:c,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(A.a)(e)]}return[2]}})});return{uploadPromise:m,cancel:function(){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:p(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,m];case 2:return e.sent(),[3,5];case 3:return[4,J(a)];case 4:return[2,e.sent()];case 5:return[2]}})})}}}(g,s,f,p),y=T.uploadPromise,w=T.cancel,o=w,[4,y];case 3:return[2,S.sent()];case 4:return[2,{errorResponse:_,result:null}]}})}),cancel:function(){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,o()];case 1:return[2,e.sent()]}})})}}}function W(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function J(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object(U.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}})})}function V(e){return"file"===e[".tag"]}function G(e){return"folder"===e[".tag"]}function Q(e){return"deleted"===e[".tag"]}function X(e){return"folder"===e.type}var Y="https://api.dropboxapi.com/2/files";function K(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i,o;return r.__generator(this,function(r){switch(r.label){case 0:return e.path=e.path||"",t=Y+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,R(t,2,{requestInit:n})];case 1:return(i=r.sent()).ok?[4,i.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:i,result:null}]}})})}var Z,$="https://api.box.com/2.0",ee=2e3;function te(e,t){return void 0===t&&(t=ee),r.__awaiter(this,void 0,void 0,function(){var n,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,R($+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:n,result:null}]}})})}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(Z||(Z={}));var ne=Z,re="https://graph.facebook.com/v2.7",ie=200;function oe(e,t){return void 0===t&&(t=ie),r.__awaiter(this,void 0,void 0,function(){var n,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,R(re+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).data}];case 3:return[2,{errorResponse:n,result:null}]}})})}var ae=n(897),se=n.n(ae),ue=n(896),ce=n.n(ue),le=n(65),de=n.n(le),fe=n(16),pe=n(355),me=n.n(pe),ve=n(187),he=n.n(ve),_e=n(31),be=n(11);function ge(e,t){var n=function(e,t){return ce()({ParentFolderIds:[de()({Id:e})],ItemShape:he()({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return se()({Header:Object(_e.getJsonRequestHeader)(),Body:n})}function Te(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i,o;return r.__generator(this,function(r){switch(r.label){case 0:return n=me()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,ge(e=e||Object(fe.a)("inbox"),n)];case 1:return i=r.sent(),(o=i.Body.ResponseMessages.Items[0])&&"Success"===o.ResponseClass&&o.RootFolder.Items?[2,{errorResponse:null,result:o.RootFolder.Items}]:(be.c.warn("Find Item Response of get mail messages failed with "+o),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}})})}n.d(t,"k",function(){return O}),n.d(t,"j",function(){return w}),n.d(t,"p",function(){return S}),n.d(t,"e",function(){return T}),n.d(t,"u",function(){return m}),n.d(t,"m",function(){return j}),n.d(t,"l",function(){return D}),n.d(t,"o",function(){return M}),n.d(t,"d",function(){return I}),n.d(t,"f",function(){return q}),n.d(t,"v",function(){return H}),n.d(t,"c",function(){return"https://s2s-api.onedrive.com"}),n.d(t,"a",function(){return"_api/v2.0/shares"}),n.d(t,"s",function(){return V}),n.d(t,"t",function(){return G}),n.d(t,"r",function(){return Q}),n.d(t,"h",function(){return K}),n.d(t,"q",function(){return X}),n.d(t,"g",function(){return te}),n.d(t,"b",function(){return ne}),n.d(t,"i",function(){return oe}),n.d(t,"n",function(){return Te})},1983:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2010:function(e,t,n){var r=n(1240);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},2071:function(e,t,n){"use strict";var r=n(1),i=Object(r.createStore)("searchDiagnosticsStore",{searchInstrumentationList:[],selectedDiagnosticsPanelEntryIndex:0})();t.a=i},2090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(1983);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2091:function(e,t,n){var r=n(2010),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},2278:function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=!1;return{task:function(){return new Promise(function(s,u){for(var c=0,l=0,d=0,f=function(){var p,m,v,h,_;a&&s(1),c<n&&d<t.length&&((p=d,m=t[p],v=m.start,h=m.end,_=e.slice(v,h),r(_,o(p),i)).then(function(){return c-=1,(l+=1)===t.length&&s(0),void f()}).catch(u),d+=1,c+=1)},p=0;p<n;p++)f()})},cancelTask:function(){return a=!0}}}var i,o=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function a(e,t,n){void 0===n&&(n=o),function(e){e.sliceSize=e.sliceSize||o.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||o.numberOfSlicesToParallelize}(n);var i=n.sliceSize,a=n.numberOfSlicesToParallelize,c=Math.ceil(e.size/i),l=function(e,t,n){for(var r=[],i=0,o=0;o<e;o++){var a=Math.min(i+t,n);r.push({start:i,end:a}),i=a}return r}(c,i,e.size),d=r(e,[l[0]],1,t,c,function(){return 0}),f=l.length>2?r(e,l.slice(1,l.length-1),a,t,c,function(e){return e+1}):u(),p=l.length>1?r(e,[l[l.length-1]],1,t,c,function(){return l.length-1}):u();return{onCompletePromise:d.task().then(s(f.task)).then(s(p.task)),cancel:function(){d.cancelTask(),f.cancelTask(),p.cancelTask()}}}function s(e){return function(t){return 0===t?e():Promise.resolve(t)}}function u(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}!function(e){e[e.Completed=0]="Completed",e[e.Cancelled=1]="Cancelled"}(i||(i={})),n.d(t,"a",function(){return a})},2350:function(e,t,n){"use strict";var r=n(895),i=n(0),o=n(1),a=n(2071),s=Object(o.mutatorAction)("selectedDiagnosticsPanelEntryIndex",function(e){a.a.selectedDiagnosticsPanelEntryIndex=e}),u=n(17),c=n(28),l=n(3),d=n(2432),f=n(3532),p=n(2112),m=n(2561),v=n(1993),h=n(2622),_=function(e){function t(t){var r=e.call(this,t)||this;return r.renderPanel=function(){return l.createElement(n,null)},r.selection=new f.a({onSelectionChanged:function(){var e=r.selection.getSelectedIndices()[0];s(e)},canSelectItem:function(){return!0},selectionMode:p.c.single,getKey:function(e,t){return t.toString()}}),r.selection.setItems(a.a.searchInstrumentationList.map(function(e){return{key:e.SearchClientRequestID}})),r.selection.setIndexSelected(a.a.selectedDiagnosticsPanelEntryIndex,!0,!0),r}var n;return i.__extends(t,e),n=t,t.prototype.componentWillUnmount=function(){s(0)},t.prototype.mapRequestInstrumentationToTopLevelDatapoint=function(e){return{QueryText:e.PIIData.queryText,Page:e.PageNumber,EndToEndJSTime:0==e.PageNumber?e.ClientJSEndToEndTime:"N/A",StartTime:Object(c.K)(Object(c.Ab)(e.ClientTimeSentUTC.getTime())),HttpStatus:e.ClientHttpStatus}},t.prototype.getResourceTimingsW3C=function(e){return e?{RedirectStart:e.RedirectStart,RedirectEnd:e.RedirectEnd,FetchStart:e.FetchStart,DomainLookupStart:e.DomainLookupStart,DomainLookupEnd:e.DomainLookupEnd,ConnectStart:e.ConnectStart,SecureConnectStart:e.SecureConnectStart,ConnectEnd:e.ConnectEnd,RequestStart:e.RequestStart,ResponseStart:e.ResponseStart,ResponseEnd:e.ResponseEnd}:null},t.prototype.getClientProcessResponseDelayTime=function(e){return e.ResourceTimingEntry?e.ClientNetworkTime-e.ResourceTimingEntry.ResponseEnd:"Unknown"},t.prototype.getTotalXHRTime=function(e){return e.ResourceTimingEntry?e.ResourceTimingEntry.ResponseEnd:"Unknown"},t.prototype.parseOwsPrimeCheckMarks=function(e){if(!e)return null;var t=e.split("/");if(t.length<3)return null;var n=Number(t[0].substring(t[0].indexOf("=")+1)),r=Number(t[1].substring(t[0].indexOf("=")+1));return{RequestProcessTime:n,Query3STime:r-n,ResponseProcessTime:Number(t[2].substring(t[0].indexOf("=")+1))-r}},t.prototype.mapSearchInstrumentationToDetailsDataPoint=function(e){var t=this.parseOwsPrimeCheckMarks(e.DiagnosticsCheckpoints);return{TimingBreakdown:{ClientJSPreRequestTime:0==e.PageNumber?e.ClientJSPreRequestTime:"N/A",TotalXHRTime:this.getTotalXHRTime(e),ResourceTimingsW3C:this.getResourceTimingsW3C(e.ResourceTimingEntry),OwsPrimeRequestProcessTime:t?t.RequestProcessTime:"Unknown",Query3STime:t?t.Query3STime:"Unknown",OwsPrimeResponseProcessTime:t?t.ResponseProcessTime:"Unknown",ClientCallbackLatency:this.getClientProcessResponseDelayTime(e),ClientJSResponseProcessTime:0==e.PageNumber?e.ClientResponseProcessTime:"N/A",EndToEndJSTime:0==e.PageNumber?e.ClientJSEndToEndTime:"N/A"},AdditionalDiagnostics:{ClientSearchProvider:e.ClientSearchProvider,PageNumber:e.PageNumber,SearchDateTime:e.SearchDateTime,SearchBETarget:e.SearchBETarget,SearchFETarget:e.SearchFETarget,SearchBEHttpStatus:e.SearchBEHttpStatus,SearchMsEdgeRef:e.SearchMsEdgeRef,SearchErrorContent:e.SearchErrorContent,SearchTraceID:e.SearchTraceID,ClientBuildNumber:e.ClientBuildNumber,ClientTimeSentUTC:e.ClientTimeSentUTC,ClientTimeFinishedUTC:e.ClientTimeFinishedUTC,ClientHttpStatus:e.ClientHttpStatus,SearchQueryId:e.SearchQueryId,SearchClientRequestID:e.SearchClientRequestID,SearchClientSessionID:e.SearchClientSessionID,ClientName:e.ClientName,HttpProtocol:e.ResourceTimingEntry?e.ResourceTimingEntry.Protocol:"Unknown",ClientJSRenderingTime:0==e.PageNumber?e.ClientJSRenderingTime:"N/A",ErrorResponse:e.SearchErrorContent?e.SearchErrorContent:"N/A"}}},t.prototype.getTopLevelPanelEntries=function(){var e=this;return 0==a.a.searchInstrumentationList.length?[]:a.a.searchInstrumentationList.map(function(t){return e.mapRequestInstrumentationToTopLevelDatapoint(t)})},t.prototype.getSelectedDetailsDataPoint=function(){var e=a.a.selectedDiagnosticsPanelEntryIndex,t=a.a.searchInstrumentationList[e];return this.mapSearchInstrumentationToDetailsDataPoint(t)},t.prototype.render=function(){var e,t,n=this.getTopLevelPanelEntries();if(!n||0==n.length)return null;var r=n[0],o=[];try{for(var s=i.__values(Object.keys(r)),u=s.next();!u.done;u=s.next()){var c=u.value;o.push({key:c,minWidth:0,name:c,fieldName:c})}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return l.createElement("div",{className:h.outerContainer},l.createElement("div",{className:h.headerText},"Click on a search entry below to see details."),l.createElement("div",{className:h.columnWrapper},l.createElement("div",{className:h.column},l.createElement("div",{className:h.listContainer},l.createElement(m.a,{items:n,columns:o,compact:!0,constrainMode:v.d.unconstrained,setKey:"searchDiagnostics",selection:this.selection,selectionMode:p.c.single,selectionPreservedOnEmptyClick:!0,onRenderItemColumn:function(e,t,n){return l.createElement("span",null,e[n.key])}}))),l.createElement("div",{className:h.column},a.a.selectedDiagnosticsPanelEntryIndex>-1&&l.createElement("div",null,l.createElement("span",{className:h.inspectorHeader},"Diagnostics breakdown"),l.createElement("div",{className:h.inspectorContainer},l.createElement(d.Inspector,{data:this.getSelectedDetailsDataPoint(),expandPaths:["$","$.TimingBreakdown"]}))))))},t=n=i.__decorate([u.observer],t)}(l.Component);n.d(t,"a",function(){return b}),n.d(t,"b",function(){return w});var b="Search",g=function(){return new _({}).renderPanel()},T={name:b,datapoints:[],type:"Custom"},y=!1;function w(){y||(y=!0,r.b.import().then(function(e){r.c.importAndExecute(T,e(),g)}))}},2360:function(e,t,n){"use strict";n.d(t,"c",function(){return u}),n.d(t,"b",function(){return c});n(12);var r=n(2),i=n(2350);n.d(t,"a",function(){return i.a});var o=n(285);n.d(t,"d",function(){return o});var a=n(2071);n.d(t,"e",function(){return a.a});var s=new r.c(function(){return n.e(219).then(n.bind(null,3496))}),u=new r.b(s,function(e){return e.addSearchRequestInstrumentation}),c=new r.b(s,function(e){return e.addResourceTimingEntry})},2414:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a});var r={};function i(e,t){r[e]=t}function o(e){return e in r?r[e]:null}function a(e){r[e]=null}},2622:function(e,t,n){var r=n(2623),i=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},2623:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._3IQBsw1K2G1sEDGwZobP1i{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}._2YhLfKALJBvJYC1hU5N3Zu{display:-webkit-box;display:-ms-flexbox;display:flex;overflow-y:auto}._1pSw37WGUVvjhjudzB4YqW{font-weight:600;font-size:12px}html[dir=ltr] ._1pSw37WGUVvjhjudzB4YqW{padding:15px 0 10px 10px}html[dir=rtl] ._1pSw37WGUVvjhjudzB4YqW{padding:15px 10px 10px 0}._2TLYfmijjPv4jc7BIBFjWq{-webkit-box-flex:1;-ms-flex:1;flex:1}html[dir=ltr] ._3ck3JDyCZlNHKT9RF9C2DV{padding-right:25px}html[dir=rtl] ._3ck3JDyCZlNHKT9RF9C2DV{padding-left:25px}._2RcCeAXv-R2YdFX6wWytcr{font-weight:600;font-size:12px}html[dir] ._1HwmoVjMzgWWDT9kelzRX9{padding-top:11px}",""]),t.locals={outerContainer:"_3IQBsw1K2G1sEDGwZobP1i",columnWrapper:"_2YhLfKALJBvJYC1hU5N3Zu",headerText:"_1pSw37WGUVvjhjudzB4YqW",column:"_2TLYfmijjPv4jc7BIBFjWq",listContainer:"_3ck3JDyCZlNHKT9RF9C2DV",inspectorHeader:"_2RcCeAXv-R2YdFX6wWytcr",inspectorContainer:"_1HwmoVjMzgWWDT9kelzRX9"}},2690:function(e,t,n){"use strict";var r=n(2728),i=n.n(r),o=n(3211),a=n.n(o),s=n(355),u=n.n(s),c=n(3212),l=n.n(c),d=n(2729),f=n.n(d),p=n(0),m=n(11);function v(e,t,n,r){return e?n(e):(m.c.warn(t.statusText),404===t.status?r(4):401===t.status||403===t.status?r(2):r(1))}var h=Object.freeze({SortColumn:2,SortOrder:1}),_="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",b="GDriveDataProviderItem:#Exchange",g="FacebookDataProviderItem:#Exchange",T="FileAttachmentDataProviderItem:#Exchange",y="FolderAttachmentDataProviderItem:#Exchange",w="OneDriveProScope:#Exchange",S="OneDriveProItemSkipTokenPagingMetadata:#Client",P=n(1933);function O(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map(function(e){return t(e)})}}function k(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}var R="application/vnd.google-apps.folder";function j(e){return{__type:b,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===R?1:0}}function D(e){return p.__assign({},O(e.files,j),{NextPageToken:e.nextPageToken})}function I(e){return p.__assign({},k(e),{NextPageToken:null})}function E(e,t){return void 0===t&&(t=!1),p.__awaiter(this,void 0,void 0,function(){var n,r,i;return p.__generator(this,function(o){switch(o.label){case 0:return[4,Object(P.m)(e,t)];case 1:return n=o.sent(),r=n.errorResponse,(i=n.result)?[2,v(i,null,D,I)]:[2,v(null,r,D,I)]}})})}var C=n(32),x=n(1),A=Object(x.mutatorAction)("setCurrentSearchQueryId",function(e,t){Object(C.a)(t).currentSearchQueryId=e}),N=n(989);function F(e){return e.From&&e.From.Mailbox?e.From.Mailbox.Name:null}function M(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:F(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}var q=function(e){return O(e,M)};function L(e,t){return p.__awaiter(this,void 0,void 0,function(){var n,r,i;return p.__generator(this,function(o){switch(o.label){case 0:return[4,Object(P.n)(e,t)];case 1:return n=o.sent(),r=n.errorResponse,(i=n.result)?[2,v(i,null,q,k)]:[2,v(null,r,q,k)]}})})}var z=n(89),U=n(31),B=n(80),H=n(2360),W=n(35),J=200;function V(e){return p.__awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u,c,l,d,f,h,_;return p.__generator(this,function(b){switch(b.label){case 0:if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");return t=Object(B.q)(B.f.FilesPicker),A(t.nextSearchQueryId,B.f.FilesPicker),Object(N.a)(Object(z.a)(),B.f.FilesPicker),n=Object(U.getJsonRequestHeader)(),r={Cvid:Object(z.a)(),Scenario:{Name:W.a.MailEmailAttachmentPicker},TimeZone:Object(W.r)(n),TextDecorations:"Off",EntityRequests:(g=e,{Field:"Time",SortDirection:"Desc"},T=[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:g},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}],T)},i=0,o=0,a=new Date,[4,Object(W.M)(r,t.searchSessionGuid)];case 1:return(s=b.sent())&&2==s.length?(u=s[0].status,l=(c=u==J)?null:s[0].statusText,d=function(e,t,n,r,i,o,a){if(!e||2!=e.length)return null;var s=Object(W.d)(e[0],t,n,"SubstrateSearch",r,new Date,i.currentSearchQueryId,new Headers(e[1]),0,W.a.MailEmailAttachmentPicker);return s.ClientJSPreRequestTime=o,s.ClientJSRequestThreadTime=a,Object(B.X)(s.SearchTraceID,B.f.FilesPicker,!1),H.c.import().then(function(e){return e(s)}),W.C.importAndExecute(s.SearchTraceID,s.ClientNetworkTime,s.ClientHttpStatus,new Date),s}(s,e,l,a,t,i,o),c?[4,s[0].json()]:[3,3]):(m.c.warn("3S Response for search mail messages failed"),[2,v(null,_={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},q,k)]);case 2:return f=b.sent(),h=function(e,t){var n,r;if(e&&e.Results&&0!==e.Results.length){var i=[],o=e.Results;try{for(var a=p.__values(o),s=a.next();!s.done;s=a.next()){var u=s.value,c=Object(W.f)(u.Source,t);c.InstanceKey=u.ReferenceId,i.push(c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}return[]}(Object(W.o)(f),r),W.D.importAndExecute(d.SearchTraceID,new Date,W.a.MailEmailAttachmentPicker),[2,v(h,null,q,k)];case 3:return m.c.warn("3S Response for search mail messages failed with "+l),_={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:l,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},W.B.importAndExecute(d.SearchTraceID,W.a.MailEmailAttachmentPicker),[2,v(null,_,q,k)]}var g,T})})}function G(e,t,n,r,o,s,c){if(void 0===s&&(s=null),5===e)return function(e,t){return void 0===t&&(t=""),p.__awaiter(this,void 0,void 0,function(){var n;return p.__generator(this,function(r){return n=_+"&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '"+e+"'",t&&(n=n+" and '"+t+"' in parents"),[2,E(n)]})})}(n,o);if(10===e)return V(n);var d=f()({AttachmentDataProviderId:t,Query:n,Paging:i()({Sort:c||a()(h),FolderId:r,Location:o,RequestedData:u()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:s})});return l()({request:d})}var Q=n(12),X=n(5),Y=n(20);function K(e,t){return p.__awaiter(this,void 0,void 0,function(){var n,r,i;return p.__generator(this,function(o){switch(o.label){case 0:n="FPAccessTokenUnavailable",r=[e],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Object(P.j)(e,!1,t)];case 2:return i=o.sent(),Object(Y.isStringNullOrWhiteSpace)(i)?(Object(Q.k)(n,r),[2,!1]):[2,!0];case 3:return o.sent(),Object(Q.k)(n,r),[2,!1];case 4:return[2]}})})}function Z(e,t){return p.__awaiter(this,void 0,void 0,function(){var n,r;return p.__generator(this,function(i){switch(i.label){case 0:switch(e){case 3:case 2:case 6:return[3,1];case 5:case 10:return[3,4];case 0:return[3,5]}return[3,8];case 1:return(n=Object(X.d)("doc-filePicker-thirdPartyProviderClientCalls"))?[4,K(e,null)]:[3,3];case 2:n=i.sent(),i.label=3;case 3:return[2,n];case 4:return[2,!0];case 5:return(r=Object(X.d)("doc-filePicker-oneDriveProClientCalls"))?[4,K(e,t)]:[3,7];case 6:r=i.sent(),i.label=7;case 7:return[2,r];case 8:return[2,!1]}})})}var $=n(3213),ee=n.n($);function te(e){return e.__type===y||1===e.Type}function ne(e){var t=e.filter(te),n=e.filter(function(e){return!te(e)});return t.concat(n)}var re=n(129);function ie(e,t,n){var r,i,o=null,a=null;switch(e){case"asc":o=(r=p.__read([t,n],2))[0],a=r[1];break;case"desc":o=(i=p.__read([n,t],2))[0],a=i[1];break;default:Object(re.a)(e)}return o<a?-1:o>a?1:0}function oe(e,t,n){switch(t){case 2:e.sort(function(e,t){var r=e.Modified,i=t.Modified,o=r?new Date(r):new Date(0),a=i?new Date(i):new Date(0);return ie(0===n?"asc":"desc",o,a)});break;case 1:e.sort(function(e,t){var r=e.Size||0,i=t.Size||0;return 0===n?r-i:i-r});break;default:e.sort(function(e,t){var r=e.Name.toLowerCase(),i=t.Name.toLowerCase();return ie(0===n?"asc":"desc",r,i)})}}function ae(e){return{__type:Object(P.q)(e)?y:T,Id:e.id,AttachmentProviderId:null,Location:(t=e.path_collection,"/"+(t.entries||[]).map(function(e){return e.name}).join("/")+"/"+e.name),Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(P.q)(e)?1:0};var t}var se=function(e){return O(e,ae)};function ue(e,t,n){return p.__awaiter(this,void 0,void 0,function(){var r,i,o,a;return p.__generator(this,function(s){switch(s.label){case 0:return[4,Object(P.g)(e)];case 1:return r=s.sent(),i=r.errorResponse,(o=r.result)?(oe((a=v(o,null,se,k)).Items,t,n),a.Items=ne(a.Items),[2,a]):[2,v(null,i,se,k)]}})})}function ce(e){return{__type:Object(P.t)(e)?y:T,Id:Object(P.r)(e)?null:e.id,AttachmentProviderId:null,Location:Object(P.r)(e)?"":e.path_lower,Modified:Object(P.s)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(P.s)(e)?e.size:0,Type:Object(P.t)(e)?1:0}}var le=function(e){return O(e,ce)};function de(e,t,n){return p.__awaiter(this,void 0,void 0,function(){var r,i,o,a;return p.__generator(this,function(s){switch(s.label){case 0:return[4,Object(P.h)({path:e})];case 1:return r=s.sent(),i=r.errorResponse,(o=r.result)?(oe((a=v(o,null,le,k)).Items,t,n),a.Items=ne(a.Items),[2,a]):[2,v(null,i,le,k)]}})})}var fe=n(3215),pe=n.n(fe),me=150,ve=200;function he(e){var t,n=(t=e.images,p.__read(p.__spread(t).reverse().filter(function(e){return e.width>=ve&&e.height>=me}),1)[0]||t[0]);return pe()({Url:n.source,Height:n.height,Width:n.width})}function _e(e){var t=he(e),n=e.images[0],r=pe()({Url:n.source,Height:n.height,Width:n.width});return{__type:g,Id:e.id,Name:"Photo "+e.id+".jpg",AttachmentProviderId:null,ProviderType:6,Location:n.source,DownloadUrl:n.source+"&dl=1",Thumbnail:t,Preview:r,From:e.from?e.from.name:null,PlaceName:e.place?e.place.name:null,AlbumName:e.album?e.album.name:null,CreatedTime:e.created_time||null,PostUrl:e.link,Type:0}}var be=function(e){return O(e,_e)};function ge(e){return e?function(e){switch(e){case 1:return P.b.Uploaded;case 0:return P.b.Tagged;default:return Object(re.a)(e)}}(e.Type):P.b.Tagged}function Te(e){return p.__awaiter(this,void 0,void 0,function(){var t,n,r,i;return p.__generator(this,function(o){switch(o.label){case 0:return t=ge(e),[4,Object(P.i)(t)];case 1:return n=o.sent(),r=n.errorResponse,(i=n.result)?[2,v(i,null,be,k)]:[2,v(null,r,be,k)]}})})}var ye=n(3216),we=n.n(ye),Se="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";function Pe(e,t){var n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");var r=t&&0===t.SortOrder?"asc":"desc";return Se+"&orderBy=folder,"+n+" "+r+'&q=mimeType!="application/octet-stream" and trashed=false and "'+(e||"root")+'" in parents'}function Oe(e){return e.file?e.file.mimeType:e.package&&"oneNote"===e.package.type?"application/onenote":null}var ke=n(139);function Re(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function je(e,t,n,r,i,o){var a,s=void 0;if(i)switch(r){case 0:var u=o?o.totalItemsFetched+e.length:e.length;a={skipToken:i,totalItemsFetched:u},s=p.__assign({},a,{__type:"OneDriveProItemSkipTokenPagingMetadata:#Client"});break;case 1:throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(re.a)(r)}var c=e.length;return i&&s?c=s.totalItemsFetched+1:s&&(c=s.totalItemsFetched),{TotalItemCount:c,ResultCode:0,Items:e.map(function(e){return function(e,t,n,r){var i=p.__read(e.folder?[y,null,e.folder.childCount,1,0]:[T,Oe(e),0,0,e.size],5),o=i[0],a=i[1],s=i[2],u=i[3],c=i[4];return{__type:o,Id:e.id,Name:e.name,Size:c,Thumbnail:{Url:e.thumbnails&&e.thumbnails[0]&&e.thumbnails[0].medium?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:e.lastModifiedBy&&e.lastModifiedBy.user?e.lastModifiedBy.user.displayName:null,MimeType:a,Location:Object(ke.parse)(e.webDavUrl).path,ProviderEndpointUrl:t,ChildCount:s,AttachmentProviderId:n,ProviderType:r,Type:u}}(e,t,n,r)}),PagingMetadata:s}}function De(e,t,n,r,i,o,a){return t?v(t,null,function(e){return je(e,n,r,i,o,a)},Re):v(null,e,function(e){return je(e,n,r,i,o,a)},Re)}function Ie(e,t,n,r,i,o){return void 0===o&&(o=null),p.__awaiter(this,void 0,void 0,function(){var a,s,u,c,l,d,f,m;return p.__generator(this,function(p){switch(p.label){case 0:return a=Object(ke.parse)(e),s=a.protocol+"//"+a.host,u=o?{maxEntries:o.maxEntries,skipToken:o.metadata?o.metadata.skipToken:null}:null,[4,Object(P.o)(s,0,n,r,i,void 0,u)];case 1:return c=p.sent(),l=c.errorResponse,d=c.result,f=d.items,m=d.skipToken,[2,De(l,f,e,t,0,m,o?o.metadata:null)]}})})}function Ee(e){return null!==e&&e.__type===w}var Ce=we()({Type:0,DisplayName:"Files",AriaLabel:"Files"});function xe(e,t,n,r,o,a,s,c){var l={AttachmentDataProviderId:e,Paging:i()({Sort:c||h,FolderId:r||"",Location:o||"",FilterBy:n,RequestedData:u()({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),PagingMetadata:s}),Scope:null==a?Ce:a};return ee()({request:l})}function Ae(e,t,n,r,i,o,a,s,u,c){return void 0===i&&(i=null),void 0===o&&(o=null),void 0===u&&(u=null),p.__awaiter(this,void 0,void 0,function(){var l,d,f;return p.__generator(this,function(p){switch(p.label){case 0:return p.trys.push([0,15,,16]),[4,Z(e,o)];case 1:return p.sent()?5!==e?[3,3]:[4,E(Pe(s,c))]:[3,13];case 2:return[2,p.sent()];case 3:return 2!==e?[3,5]:(l=c?c.SortColumn:h.SortColumn,d=c?c.SortOrder:h.SortOrder,[4,de(s,l,d)]);case 4:return[2,p.sent()];case 5:return 3!==e?[3,7]:(l=c?c.SortColumn:h.SortColumn,d=c?c.SortOrder:h.SortOrder,[4,ue(a,l,d)]);case 6:return[2,p.sent()];case 7:return 6!==e?[3,9]:[4,Te(i)];case 8:return[2,p.sent()];case 9:if(0!==e||i&&(!Ee(i)||0!==i.Type))return[3,11];if(u&&!function(e){return e&&e.__type===S}(u))throw new Error("The paging metadata is not of type OneDriveProItemsSkipTokenPagingMetadata");return[4,Ie(o,t,c?c.SortColumn:h.SortColumn,c?c.SortOrder:h.SortOrder,a,{metadata:u,maxEntries:100})];case 10:return[2,p.sent()];case 11:return 10!==e?[3,13]:[4,L(a,n)];case 12:return[2,p.sent()];case 13:return[4,xe(t,n,r,a,s,i,u,c)];case 14:return[2,p.sent()];case 15:throw f=p.sent(),m.c.warn("FilePicker: getFileProviderItems got error: "+f.message),f;case 16:return[2]}})})}n.d(t,"f",function(){return G}),n.d(t,"b",function(){return Ae}),n.d(t,"a",function(){return P.e}),n.d(t,"e",function(){return P.u}),n.d(t,"d",function(){return Ee}),n.d(t,"c",function(){return Oe})},2728:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AttachmentItemsPagingDetails:#Exchange"},e)}},2729:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SearchAttachmentDataProviderItemsRequest:#Exchange"},e)}},3147:function(e,t,n){"use strict";var r=n(2414);n.d(t,"a",function(){return r.a}),n.d(t,"c",function(){return r.c});var i=n(2053);n.d(t,"b",function(){return i.b});var o=n(2),a=new o.c(function(){return n.e(104).then(n.bind(null,4297))}),s=new o.a(a,function(e){return e.addFileProviderAfterAuthFinished});"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=s);new o.b(a,function(e){return e.getAddableFileProviderInfo}),new o.b(a,function(e){return e.addFileProvider}),new o.b(a,function(e){return e.createAddableFileProviderInfo}),new o.b(a,function(e){return e.getAuthRedirectPageUrl})},3211:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AttachmentItemsSort:#Exchange"},e)}},3212:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(2729);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("SearchAttachmentDataProviderItems",e,t)}},3213:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(3214);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("GetAttachmentDataProviderItems",e,t)}},3214:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentDataProviderItemsRequest:#Exchange"},e)}},3215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AttachmentThumbnailInfo:#Exchange"},e)}},3216:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"OneDriveProScope:#Exchange"},e)}},4529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"RemoveAttachmentDataProviderRequest:#Exchange"},e)}},4530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentDataProvidersRequest:#Exchange"},e)}},5663:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(4529);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("RemoveAttachmentDataProvider",e,t)}},5664:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(4530);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAllAttachmentDataProviders",e,t)}},7013:function(e,t,n){"use strict";n.r(t);var r=n(2048),i=n(1),o=Object(i.action)("ADD",function(e){return{providerViewState:e}}),a=Object(i.action)("LOAD",function(e){return{providers:e}}),s=Object(i.action)("REMOVE",function(e){return{providerType:e}}),u=Object(i.action)("ADD_TO_REMOVING",function(e){return{providerType:e}}),c=Object(i.action)("SET_LOAD_STATE",function(e){return{loadState:e}});function l(e){Object(r.a)().providers.set(e.viewType.toString(),e)}Object(i.mutator)(o,function(e){return l(e.providerViewState)}),Object(i.mutator)(u,function(e){return Object(r.a)().removalPending.set(e.providerType.toString(),"")}),Object(i.mutator)(s,function(e){Object(r.a)().providers.delete(e.providerType.toString()),Object(r.a)().removalPending.delete(e.providerType.toString())}),Object(i.mutator)(a,function(e){return e.providers.forEach(l)}),Object(i.mutator)(c,function(e){Object(r.a)().loadState=e.loadState});var d=n(0),f=n(2209),p=n(2502),m=n(8),v=n.n(m),h=Object(i.action)("ADD_FILE_PROVIDER",function(e,t,n){return{providerType:e,getAddableFileProviderInfoCustom:t,updateProvider:n}}),_=Object(i.action)("LOAD_PROVIDERS",function(e,t){return{onLoaded:e,onError:t}}),b=Object(i.action)("REMOVE_AND_ADD_FILE_PROVIDER",function(e){return{providerType:e}}),g=Object(i.action)("REMOVE_FILE_PROVIDER",function(e){return{providerType:e}}),T=n(127),y=n(2081);function w(e){if(y.c.indexOf(e.Type)<-1)return null;var t=e.Type;try{var n=5===t?e.Scopes.filter(function(e){return"Photos"!==e.DisplayName}):e.Scopes;return{name:e.DisplayName,providerAccountIdentifier:e.AssociatedDataProviderAccountId||"",isPrimaryProvider:!e.IsThirdPartyProvider,type:t,allowFolderSharing:e.AllowFolderSharing,model:e,scopes:n||[],viewType:t,associatedWithPrimaryProvider:!1,usesGroupsViewAtTopLevel:!1}}catch(e){return null}}var S=n(2061),P=n(20),O=n(12),k=n(11),R=n(3147);function j(e,t,n){return d.__awaiter(this,void 0,void 0,function(){var r,i;return d.__generator(this,function(a){switch(a.label){case 0:if(!Object(p.b)(e))throw new Error(p.a);a.label=1;case 1:return a.trys.push([1,3,,4]),[4,D(e,t,n)];case 2:return r=a.sent(),[3,4];case 3:return function(e,t){throw k.c.warn("Error in adding file provider "+e.toString()),n=Object(f.a)(t),Object(T.b)(v.a.CouldNotConnectToAccountTitleText,Object(P.format)(v.a.ErrorAddingNewProviderDescriptionText,n),!1,{hideCancelButton:!0}),e;var n}(a.sent(),e),[2];case 4:return i=w(r),o(i),Object(S.a)(i),[2]}})})}function D(e,t,n){return Object(O.k)("FPAddDataProviderAuthWindowOpened",[e]),new Promise(function(r,i){var o,a,s,u,c,l,d=(t=t||R.b)(e).getAuthUrlInfo(),f=d.authUrl,p={info:{redirectUrl:d.redirectUrl,csrfToken:d.csrfToken,updateProvider:n},onProviderAdded:function(e){return r(e)},onErrorAddingProvider:function(e){return i(e)},getAddableFileProviderInfo:t};Object(R.a)(e),Object(R.c)(e,p),o=f,a=600,s=600,u=(window.screen.width-a)/2,c=(window.screen.height-s)/2,l="width="+a+", height="+s+", top="+c+", left="+u+", menubar=no, toolbar=no",window.open(o,"_blank",l)})}Object(i.orchestrator)(h,function(e){j(e.providerType,e.getAddableFileProviderInfoCustom,e.updateProvider)});var I=n(2690),E=n(2072),C=n(4529),x=n.n(C),A=n(5663),N=n.n(A);function F(e){return d.__awaiter(this,void 0,void 0,function(){var t;return d.__generator(this,function(n){switch(n.label){case 0:return(t=Object(E.a)(e.toString()))&&Object(p.b)(e)?[4,(r=t.model.Id,i=x()({DataProviderId:r}),N()(i))]:(M("Unable to remove the provider as the provider does not exist in the store or is not addable.",e),[2]);case 1:return n.sent().RemovedSuccessfuly?(s(e),Object(S.b)(e),Object(I.a)(t.type)):M("Unable to remove the provider",t.type),[2]}var r,i})})}function M(e,t){var n;k.c.warn("Error in removing file provider "+e),n=Object(f.a)(t),Object(T.b)(v.a.ErrorRemovingProviderTitleText,Object(P.format)(v.a.ErrorRemovingProviderDescriptionText,n),!1,{hideCancelButton:!0})}function q(e){return Object(T.b)(v.a.CouldNotConnectToAccountTitleText,Object(P.format)(v.a.ErrorConnectingToProviderDescriptionText,e),!1)}Object(i.orchestrator)(g,function(e){F(e.providerType)}),Object(i.orchestrator)(b,function(e){!function(e){d.__awaiter(this,void 0,void 0,function(){var t;return d.__generator(this,function(n){switch(n.label){case 0:t=Object(f.a)(e),n.label=1;case 1:return n.trys.push([1,6,,7]),[4,F(e)];case 2:return n.sent(),[4,q(t)];case 3:return n.sent()!==T.a.ok?[3,5]:[4,j(e)];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:return n.sent(),[3,7];case 7:return[2]}})})}(e.providerType)});var L=n(2175),z=n(5664),U=n.n(z),B=n(4530),H=n.n(B);function W(e){void 0===e&&(e=0);var t=H()({ClientVersion:2,RequestOrigin:e});return U()(t)}var J=n(2142),V=n(5);var G=n(2437),Q=n(47);Object(i.orchestrator)(_,function(e){!function(e,t){d.__awaiter(this,void 0,void 0,function(){var n,r,i,o,s;return d.__generator(this,function(u){switch(u.label){case 0:if(Object(L.a)()!==J.a.NotLoaded)return[3,5];c(J.a.Loading),n=void 0,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,W()];case 2:return n=u.sent(),[3,4];case 3:return r=u.sent(),c(J.a.NotLoaded),t&&t(r),[2];case 4:f={__type:"MailMessage",DisplayName:v.a.InboxText,AriaLabel:v.a.InboxText},i={__type:"MailMessageAttachmentDataProvider",Id:"MailMessage",Type:10,DisplayName:v.a.MailMessageFileProviderDisplayName,AssociatedDataProviderAccountId:null,Scopes:[f],DefaultScopeIndex:0,AllowFolderSharing:!1,DefaultPermissionType:6,IsSearchSupported:Object(V.d)("doc-filePicker-mailMessageSearch"),IsThirdPartyProvider:!1},n.push(i),o=n.filter(function(e){return y.c.indexOf(e.Type)>-1&&Object(G.a)(e.Type)}),Object(V.d)("doc-filePicker-oneDriveProRecentFiles")||function(e){var t=d.__read(e.filter(function(e){return 0===e.Type}),1)[0];if(t){var n=d.__read(t.Scopes.filter(function(e){return 4===e.Type}),1),r=n[0];if(r){var i=t.Scopes.indexOf(r);!function(e,t){if(t<0||t>=e.Scopes.length)throw new Error("Invalid scope index "+t+" for the provider "+e.Id);e.Scopes.splice(t,1),e.DefaultScopeIndex===t&&(e.DefaultScopeIndex=0)}(t,i)}}}(o),s=function(e){return e.map(w).filter(function(e){return null!==e})}(o),!Object(Q.a)()&&Object(V.d)("doc-filePicker-groupFiles")&&s.splice(0,0,(l=s[0],d.__assign({},l,{scopes:[{__type:"OneDriveProScope:#Exchange",Type:3,DisplayName:""}],isPrimaryProvider:!1,viewType:y.b.Groups,name:v.a.GroupsFileProviderDisplayName,associatedWithPrimaryProvider:!0,usesGroupsViewAtTopLevel:!0}))),a(s),c(J.a.Loaded),e&&e(s),Object(S.c)(s),u.label=5;case 5:return[2]}var l,f})})}(e.onLoaded,e.onError)}),n.d(t,"removeFileProvider",function(){return g}),n.d(t,"removeAndAddFileProvider",function(){return b}),n.d(t,"loadProviders",function(){return _}),n.d(t,"addFileProvider",function(){return h})}},0,[5,6,9,11,217,0,2,3,8,90,279,51,280,57,283,80,104,219]]);
//# sourceMappingURL=owa.FileProviderStore.mail.js.map
window.scriptsLoaded['owa.FileProviderStore.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.FileProviderStore.mail.js'] = (new Date()).getTime();