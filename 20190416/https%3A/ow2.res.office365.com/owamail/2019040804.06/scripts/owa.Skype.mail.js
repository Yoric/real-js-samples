window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.Skype.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[228],{2513:function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"c",function(){return c}),a.d(t,"b",function(){return o});var n,r,i=a(2634);function c(e){switch(e){case n.Off:return i.a.None;case n.Notification:return i.a.ToastOnly;case n.All:default:return i.a.ToastAndSound}}function o(e){switch(e){case i.a.None:return n.Off;case i.a.ToastOnly:return n.Notification;case i.a.ToastAndSound:default:return n.All}}!function(e){e.All="ALL",e.Notification="NOTIFICATION",e.Off="OFF"}(n||(n={})),function(e){e.IncomingCall="swc.notification.incoming-call",e.NewMessage="swc.notification.new-message"}(r||(r={}))},2634:function(e,t,a){"use strict";var n;!function(e){e[e.None=0]="None",e[e.ToastAndSound=1]="ToastAndSound",e[e.ToastOnly=2]="ToastOnly",e[e.Migrated=3]="Migrated"}(n||(n={})),t.a=n},2912:function(e,t,a){"use strict";var n=a(217),r=a(1);t.a=Object(r.createStore)("swcOptions",{skypeMessageNotification:null,skypeCallingNotification:null,feature:n.a.SkypeNotifications})},3506:function(e,t,a){"use strict";var n=a(2),r=a(204),i=a(3574),c=a(5);var o=new n.c(function(){return Promise.all([a.e(10),a.e(353)]).then(a.bind(null,7042))}),l=Object(r.b)({key:"skypeNotifications",titleStringKey:Object(i.a)()?"optionSubcategory_chatandcall":"optionSubcategory_chat",searchTermsStringKey:"optionSubcategory_notifications",isHidden:function(){return!(!Object(c.d)("fwk-partner-code-off")&&(Object(c.d)("fwk-skypeConsumer")||Object(c.d)("fwk-skypeBusiness")))}},o,function(e){return e.default}),s=a(2634),u=(a(2513),a(2912));a.d(t,"d",function(){return f}),a.d(t,"a",function(){return l}),a.d(t,"b",function(){return s.a}),a.d(t,"c",function(){return u.a});var d=new n.c(function(){return a.e(229).then(a.bind(null,7146))}),f=new n.a(d,function(e){return e.initializeNotificationSettings})},3574:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(5);function r(){return Object(n.d)("fwk-skypeConsumer")||Object(n.d)("fwk-skypeBusinessCalling")}},4057:function(e,t,a){"use strict";var n=a(1);t.a=Object(n.action)("ON_COMMIT_THEME_CHANGE",function(e){return{themeId:e}})},5313:function(e,t,a){var n=a(5314),r=a(55);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)r.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},5314:function(e,t,a){(t=e.exports=a(54)(!1)).push([e.i,'.K2bNwbvdsvTT3AkP2FCqW{width:235px}html[dir] .K2bNwbvdsvTT3AkP2FCqW{padding:25px 20px 12px}._17AcE6RCo0OI4-Vl-XmjFS{font-size:21px;font-weight:100;font-weight:600;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._17AcE6RCo0OI4-Vl-XmjFS{padding-bottom:12px}.kTwYX4Qb6QHwy-UIg9-Hp{font-size:14px;font-weight:400;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}._1wiS8dtOiA2W-7bBqFn-fE{font-weight:400}html[dir] ._1wiS8dtOiA2W-7bBqFn-fE{padding-top:8px}._1y5jnobWd-dZKDcw7Y8lJp{color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={notificationContent:"K2bNwbvdsvTT3AkP2FCqW",notificationTitle:"_17AcE6RCo0OI4-Vl-XmjFS",notificationSubtext:"kTwYX4Qb6QHwy-UIg9-Hp",goToTeams:"_1wiS8dtOiA2W-7bBqFn-fE",teamsLink:"_1y5jnobWd-dZKDcw7Y8lJp"}},5315:function(e,t,a){var n=a(5316),r=a(55);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)r.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},5316:function(e,t,a){(t=e.exports=a(54)(!1)).push([e.i,"._3xy1fVS5Ibj7zv2_FQpzy_{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);bottom:0;position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;max-width:calc(100% - 300px)}html[dir] ._3xy1fVS5Ibj7zv2_FQpzy_{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}html[dir=ltr] ._3xy1fVS5Ibj7zv2_FQpzy_{right:0}html[dir=rtl] ._3xy1fVS5Ibj7zv2_FQpzy_{left:0}._3xy1fVS5Ibj7zv2_FQpzy_ .conversation{display:initial}",""]),t.locals={chatWrapper:"_3xy1fVS5Ibj7zv2_FQpzy_"}},6985:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(999),i=a(4057),c=a(104);function o(e){window.swc&&"function"==typeof window.swc.setTheme&&window.swc.setTheme(e)}Object(n.orchestrator)(r.a,function(e){o(e.isDarkModeEnabled?"dark":Object(c.d)())}),Object(n.orchestrator)(i.a,function(e){o(e.themeId)});var l=a(0),s=a(1605),u=a(4),d=Object(u.action)("updateIsRecentsInitialized ")(function(e){s.a.isRecentsInitialized=e});function f(e){s.a.isSwcInitialized?h(e):window.addEventListener("swc:core:ready",function(){!function e(t){window.removeEventListener("swc:core:ready",function(){e(t)});h(t)}(e)})}function h(e){window.swc&&(window.swc.API.registerEvent("recentsReady",k),window.swc.create("recents",{},e))}function k(){d(!0)}var b=a(17),p=a(1326),v=a(78),w=a(1859),g=a(5),y=a(20),m=a(15),S=a.n(m),B=a(3),O=a(5313),T=a(275),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.populateRecentsContent=function(e){e&&(s.a.isRecentsInitialized?function(e){window.swc&&window.swc.SDK.Recents.refreshDOM(e)}(e):f(e))},t}return l.__extends(t,e),t.prototype.render=function(){var e=this,t=Object(g.d)("fwk-skypeConsumer");return B.createElement(p.a,{onDismiss:function(){return e.props.onDismiss()},target:this.props.target,isBeakVisible:!t,beakWidth:15,gapSpace:0,directionalHint:t?v.DirectionalHint.bottomCenter:v.DirectionalHint.bottomLeftEdge,calloutWidth:t?320:275,setInitialFocus:!0},t?this.renderSkypeRecents():this.renderChatWillBeBackNotification())},t.prototype.renderSkypeRecents=function(){return B.createElement("div",{"data-style":"outlook",className:T("skype-recents",O.recentsWrapper),ref:this.populateRecentsContent})},t.prototype.renderChatWillBeBackNotification=function(){var e=B.createElement(w.a,{"aria-label":S.a.skypeEnterpriseGoToTeams_cta_ariaLabel,className:O.teamsLink,href:"https://teams.microsoft.com",target:"_blank"},S.a.skypeEnterpriseGoToTeams_cta);return B.createElement("div",{className:O.notificationContent},B.createElement("div",{className:O.notificationTitle},S.a.skypeEnterpriseWillBeBack_Title),B.createElement("div",{className:O.notificationSubtext},S.a.skypeEnterpriseWillBeBack_Text,B.createElement("div",{className:O.goToTeams},Object(y.formatToArray)(S.a.skypeEnterpriseGoToTeams_Text,e))))},t=l.__decorate([b.observer],t)}(B.Component),j=a(12),x=Object(u.action)("updateIsGlimpseOpen ")(function(e){s.a.isGlimpseOpen=e,window.swc&&(e?window.swc.API.triggerEvent("recentsShown"):window.swc.API.triggerEvent("recentsHidden")),Object(j.k)("Skype_Recents",[e])});var N=a(796),I=a(857),C=a(377);function A(e){C.a.notificationViewStates.forEach(function(t){t.actionType!=I.c.SkypeNotification||t.actionContext.id!=e||Object(I.j)(t)})}var E=a(3506),L=a(217),P=0,F=1;function z(e){var t=e.type,a=e.title,n=e.description,r=e.actions,i=e.avatarUrl,c=Object(g.d)("fwk-skypeSettingsMigration")?Object(E.c)():Object(L.c)(L.a.SkypeNotifications);if(function(e,t){switch(t){case I.b:case I.e:return!s.a.isGlimpseOpen&&e.skypeMessageNotification!==E.b.None;case I.a:return e.skypeCallingNotification!==E.b.None;default:return null}}(c,t)){Object(I.g)(I.c.SkypeNotification,D);var o={actionType:I.c.SkypeNotification,title:a,description:n,actionLink:r.length>P?r[P].title:null,cancelLink:r.length>F?r[F].title:null,image:i,actionContext:e,ignore:!1,playSound:H(c,t),type:e.type};Object(I.f)(o)}}function D(e){var t=e.actionContext,a=t.actions,n=t.type,r=e.ignore,i=e.timedOut;r&&a.length>F?a[F].action():!r&&!i&&a.length>P&&(a[P].action(),n===I.e&&x(!0)),Object(j.k)("Skype_Notification",[n,i?null:r,i])}function H(e,t){switch(t){case I.b:case I.e:return e.skypeMessageNotification!==E.b.ToastOnly;case I.a:return e.skypeCallingNotification!==E.b.ToastOnly;default:return!1}}var R=a(1705),W=Object(u.action)("updateIsSwcInitialized ")(function(e){s.a.isSwcInitialized=e}),M=Object(u.action)("updateUnreadConversationCount")(function(e){s.a.unreadConversationCount=e}),Q=a(186),V=a(7),U=a(47),G=a(359),K="dark",q={IsVirtual:!0,ParallelView:!Object(R.a)(),Style:"outlook",CanCollapse:!0};function X(e){var t,a=this,n=Object(Q.c)()?K:Object(c.d)();window.swc&&window.swc.init(null,(t={toLoadUnreadConversationsCount:!0,locale:Object(V.a)().SessionSettings.UserLanguage},Object(U.a)()?t:l.__assign({tokenProvider:Y,tokenType:"aad"},t))).then(function(){return l.__awaiter(a,void 0,void 0,function(){return l.__generator(this,function(t){return W(!0),window.swc.API.registerEvent("receivedNotification",z),window.swc.API.registerEvent("unreadConversationsUpdate",Z),window.swc.API.registerEvent("hideNotification",A),window.swc.API.registerEvent("onRecentItemSelected",J),window.swc.create("chat",q,e),Object(R.a)()&&window.swc.getRecents().then(function(e){return e.setOptions({PreventOpenChat:!0})}),window.swc.setTheme(n),[2]})})})}function Y(e){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(t){switch(t.label){case 0:return[4,Object(G.b)(e)];case 1:return[2,t.sent()]}})})}function J(e){x(!1),Object(R.a)()&&Object(n.dispatch)(Object(N.a)(e))}function Z(e){M(e)}function $(e){window.addEventListener("swc:core:ready",function(){!function e(t){window.removeEventListener("swc:core:ready",function(){e(t)});X(t)}(e)})}var ee=a(5315),te=a(275),ae="chat-wrapper";var ne=function(){var e=document.createElement("div");return e.className=te(ae,ee.chatWrapper),document.body.appendChild(e),e};function re(){var e;$(ne()),(e=document.createElement("script")).type="text/javascript",e.setAttribute("data-style","outlook"),e.setAttribute("data-manual-boot","true"),e.src="https://swc.cdn.skype.com/sdk/v1/sdk.min.js",document.head.appendChild(e)}function ie(){return Object(L.c)(L.a.SkypeNotifications).skypeMessageNotification!==E.b.None}var ce="swc:ready";function oe(){window.addEventListener(ce,function(){!function e(){window.removeEventListener(ce,function(){e()});E.d.importAndExecute()}()})}a.d(t,"SkypeGlimpse",function(){return _}),a.d(t,"updateIsGlimpseOpen",function(){return x}),a.d(t,"beginSkypeInitialization",function(){return re}),a.d(t,"shouldShowUnreadConversationCount",function(){return ie}),a.d(t,"onNotificationReceived",function(){return z}),a.d(t,"onHideNotificationReceived",function(){return A}),a.d(t,"createOnSwcReadyEvent",function(){return oe})}},0,[1,10,14,17,193,279,51,280,57,289,109,229]]);
//# sourceMappingURL=owa.Skype.mail.js.map
window.scriptsLoaded['owa.Skype.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.Skype.mail.js'] = (new Date()).getTime();