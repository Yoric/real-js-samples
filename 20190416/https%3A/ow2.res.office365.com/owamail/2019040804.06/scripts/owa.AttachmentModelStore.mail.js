window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.AttachmentModelStore.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[62],{1314:function(e,t,n){"use strict";var r=n(129),i=n(830);n(267);function o(e,t,n,o){void 0===o&&(o=!0);var a=e,c=a.AttachmentId,u=a.Name,s=a.OriginalPermissionType,l=a.PermissionType,d=a.AttachLongPathName;switch(t){case 0:case 3:return i.b(c,d,t,n,l,s,o,u);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:i.b(c,d,1,n,l,s,o,u);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function a(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),i.a(e.mailboxInfo&&e.mailboxInfo.mailboxId,e,t,n,r)}function c(e,t,n,r,i,c){return void 0===c&&(c=!1),r?o(t,n,i):a(e,n,c)}n.d(t,"b",function(){return c}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return"/owa/"})},1528:function(e,t,n){"use strict";var r=n(828),i=n(47),o=n(20),a=n(267),c="/owa/",u="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",l="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",f="service.svc/s/GetAttachmentThumbnail?id={0}",h="pdfprint.aspx?id={0}",p="pdfprint.aspx?id={0}&location={1}",m=n(110),v=n(168);var b=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var w=n(129);function g(e,t,n,r,i,u,l,f){var h;switch(void 0===i&&(i=0),void 0===u&&(u=0),void 0===l&&(l=!0),void 0===f&&(f=null),n){case 0:h=s;break;case 3:h=p;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&b.indexOf(t.toLowerCase())>=0}(f))return null;h=d;break;default:Object(w.a)(n)}var m=r?u:i;!m&&i&&(m=i);var v=Object(o.format)("{0}{1}&permissionLevel={2}",c,Object(o.format)(h,encodeURIComponent(e.Id),encodeURIComponent(t)),m);l&&(v=v+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)());return v}function P(e,t,n,s,d){var p;switch(void 0===s&&(s=!1),void 0===d&&(d=!0),n){case 0:p=u;break;case 1:p=l;break;case 2:p=f;break;case 3:p=h;break;default:return Object(w.a)(n)}return Object(o.isStringNullOrWhiteSpace)(p)?null:Object(o.format)("{0}{1}{2}",function(e,t,n,u,s){if(void 0===s&&(s=!1),!t||!t.Id)return null;var l=Object(o.format)(n,encodeURIComponent(t.Id));if(!Object(r.c)()||s&&"Firefox"===Object(m.a)().browser)return c+l+"&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)();var d="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(i.a)()&&(d+="&isc=1");var f=Object(o.format)(d,Object(r.b)(),e,l,window.location.hostname,Object(v.d)()||"unofficial");return u&&(f+="&X-OWA-CANARY="+Object(a.getOwaCanaryCookie)(),f+="&token="+Object(r.a)()),f}(e,t,p,d,3===n),s?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return g}),n.d(t,"a",function(){return P})},1534:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},1760:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),o=Object(i.action)("checkPendingAttachmentOperation",function(e,t,n,r,i){return{attachmentId:e,itemId:t,operationId:n,operationType:r,completeHandler:i}}),a=n(3208),c=n.n(a),u=n(3767),s=n.n(u);function l(e,t,n,r,i){var o=function(e,t,n,r){return c()({ewsAttachmentId:e,itemId:t,operationId:n,operationType:r})}(e,t,n,r);return s()(o,i)}var d=n(11),f=(Object(i.orchestrator)(o,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=e.itemId?e.itemId.mailboxInfo:e.attachmentId.mailboxInfo,[4,l(e.attachmentId?e.attachmentId.Id:null,e.itemId?e.itemId.Id:null,e.operationId,e.operationType,t.requestOptions)];case 1:return n=r.sent(),e.completeHandler(n),[3,3];case 2:return i=r.sent(),d.c.warn("checkPendingAttachmentOperationAction is failing with error: "+i),[3,3];case 3:return[2]}})})}),n(926)),h=n(825),p=n(2039),m=n(3035);Object(i.orchestrator)(p.h,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return"object"!=typeof e.id?[3,2]:(t=Object(h.a)(e.id))?(n=t.model,[4,Object(m.a)([e.id],n.PermissionType)]):[3,2];case 1:r.sent(),Object(f.a)(t.id),r.label=2;case 2:return[2]}})})});var v=n(2259),b=n(2619),w=n(2563),g=n(2433),P=n(2721),O=n(2492),y=n(2701),I=n(4),A=Object(I.action)("setAttachmentInfo")(function(e,t){Object(h.a)(e).info=t});n.d(t,"addAndInitializeAttachments",function(){return v.a}),n.d(t,"setPreviewImageUrl",function(){return b.a}),n.d(t,"refreshDownloadUrl",function(){return w.a}),n.d(t,"refreshThumbnailImageUrl",function(){return g.a}),n.d(t,"refreshPreviewImageUrl",function(){return P.a}),n.d(t,"getAttachment",function(){return h.a}),n.d(t,"checkPendingAttachmentOperation",function(){return o}),n.d(t,"shouldShowImageView",function(){return O.a}),n.d(t,"createAttachmentInfo",function(){return y.a}),n.d(t,"setAttachmentInfo",function(){return A})},1953:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(889);function i(e){return a(e.type)}function o(e){return a(Object(r.a)(e))}function a(e){return 1===e}},1983:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},2010:function(e,t,n){var r=n(1240);e.exports=function(e,t){var n=r(e).getTime(),i=Number(t);return new Date(n+i)}},2060:function(e,t,n){"use strict";var r=n(0),i=n(2102),o=n(2206),a=n(129);var c=Object(i.a)(function(e){switch(e){case 0:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(o.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return r.__assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1},{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(a.a)(e)}}),u=c.getDataProviderInfo;c.getDefaultDataProviderInfo;t.a=u},2089:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(1933),o=n(2239);function a(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(o.a)(e.AttachLongPathName),[4,Object(i.l)(t)];case 1:return[2,(n=r.sent()).result&&n.result.thumbnailLink||null]}})})}},2090:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(1983);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},2091:function(e,t,n){var r=n(2010),i=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*i)}},2102:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),i=n(276),o=n(697),a=[0,1,3,2,6,5,7,8,4];function c(e){var t=null,n=function(n){var i=Object(o.b)(n);return null===i?null:function(){var n,i;if(!t){t={};try{for(var o=r.__values(a),c=o.next();!c.done;c=o.next()){var u=c.value;t[u]=e(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}return t}()[i]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?i.l:i.m)}}}},2167:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(276),i=n(2060),o=n(827);function a(e,t,n){var a=e.level!==o.c.Block&&e.directFileAccessEnabled;return a&&t.__type===r.n&&(a=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,n.host.indexOf(c,0)>0||n.search.indexOf(u,0)>0)return!1}if(r=e.ProviderType,o=Object(i.a)(r),o&&o.supportDownload&&!e.AttachmentIsFolder)return!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);var r,o;return!1}(t,n)),a}var c="safelinks.protection.outlook.com",u="b7780972f918485c8cfc32b1ba7438eb"},2168:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5);function i(e,t,n){var i=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""),o=-1!==i.indexOf("MSIE")||-1!==i.indexOf("rv:")&&-1!==i.indexOf("Trident"),a=-1===i.indexOf("Edge")&&-1!==i.indexOf("Chrome"),c=-1!==i.indexOf("Firefox"),u=-1!==i.indexOf("Edge");return a?function(e){return(e=e||navigator&&navigator.plugins)&&null!==e.namedItem("Chrome PDF Viewer")}(n):o?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(t||function(e){return new ActiveXObject(e)}):c?!(Object(r.d)("doc-SxS-pdfJsPreview")&&Object(r.d)("doc-SxS-pdfJsPreviewDefaultInFirefox")):!u||!(Object(r.d)("doc-SxS-pdfJsPreview")&&Object(r.d)("doc-SxS-pdfJsPreviewDefaultInEdge"))}},2169:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),i=n(276),o=n(2089),a=n(1314);function c(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var c;return r.__generator(this,function(r){switch(r.label){case 0:return n?(c=t).ProviderType===i.f&&c.AttachLongPathName?[4,Object(o.a)(c)]:[3,2]:[2,Object(a.b)(e,t,2,n,!0)];case 1:return[2,r.sent()];case 2:return[2,c.AttachmentThumbnailUrl||null]}})})}},2206:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function i(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},2239:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",function(){return r})},2433:function(e,t,n){"use strict";var r=n(0),i=n(825),o=n(276),a=n(2089),c=n(1953),u=n(1314),s=n(4);t.a=Object(s.action)("refreshThumbnailImageUrl")(function(e,t,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){var s,l;return r.__generator(this,function(r){switch(r.label){case 0:if(s=Object(i.a)(e),!Object(c.b)(s.model))return[3,7];switch(s.model.ProviderType){case o.f:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(a.a)(s.model)];case 2:return l=r.sent(),s.thumbnailImage.url=l,[3,4];case 3:return r.sent(),s.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:l=Object(u.b)(e,s.model,2,Object(c.b)(s.model),t,n),s.thumbnailImage.url=l,r.label=8;case 8:return[2]}})})})},2619:function(e,t,n){"use strict";var r=n(825),i=n(4);t.a=Object(i.action)("setPreviewImageUrl")(function(e,t){Object(r.a)(e).previewImage.url=t})},2721:function(e,t,n){"use strict";var r=n(0),i=n(2619),o=n(825),a=n(276),c=n(2089),u=n(1953),s=n(1314),l=n(4);function d(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Object(c.a)(e)];case 1:if(null==(t=n.sent()))throw new Error("URL not available");return"2",[2,t+"2"]}})})}t.a=Object(l.action)("refreshPreviewImageUrl")(function(e,t,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){var c,l,f;return r.__generator(this,function(r){switch(r.label){case 0:return c=Object(o.a)(e),Object(u.b)(c.model)&&c.model.ProviderType===a.f?[4,d(c.model)]:[3,2];case 1:return l=r.sent(),Object(i.a)(e,l),[3,3];case 2:Object(u.b)(c.model)&&c.model.ProviderType!==a.l&&c.model.ProviderType!==a.m||(f=Object(s.b)(e,c.model,1,1===c.type,t,n),Object(i.a)(e,f)),r.label=3;case 3:return[2]}})})})},2727:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetAttachmentPermissionsRequest:#Exchange"},e)}},2898:function(e,t,n){"use strict";var r=n(926),i=n(825),o=n(2714),a=n(5),c=n(7),u=n(4);t.a=Object(u.action)("setAttachmentPermissionLevel")(function(e,t,n,u){var s=Object(i.a)(e),l=s.model;l.PermissionType=t,n&&(l.AttachLongPathName=n,s.openUrl=Object(o.a)(l,Object(c.a)())),Object(a.d)("doc-attachment-referenceAttachmentExpiration")&&s.info&&s.info.sharingInfo&&(s.info.sharingInfo.expirationDate=u),Object(r.a)(e)})},3035:function(e,t,n){"use strict";var r=n(0),i=n(4),o=n(225),a=n(2898),c=n(2727),u=n.n(c),s=n(3209),l=n.n(s);function d(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var i=function(e,t,n,r){return void 0===n&&(n=null),void 0===r&&(r=!1),u()({AttachmentIds:e,PermissionLevel:t,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(e,t,n,r);return l()({request:i})}t.a=Object(i.action)("changeAttachmentPermission")(function(e,t,n,i){return void 0===n&&(n=null),void 0===i&&(i=!1),r.__awaiter(this,void 0,void 0,function(){var c;return r.__generator(this,function(r){switch(r.label){case 0:return[4,d(e.map(function(e){return e.Id}),t,n,i)];case 1:if(!(c=r.sent()).OperationSucceeded||!c.NewAttachLongPathNames||c.NewAttachLongPathNames.length!==e.length)throw new Error("Error setting attachment permissions");return e.forEach(function(e,n){var r=null;c.ExpirationDates&&c.ExpirationDates[n]&&(r=Object(o.c)(c.ExpirationDates[n])),Object(a.a)(e,t,c.NewAttachLongPathNames[n],r)}),[2]}})})})},3208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CheckPendingAttachmentOperationRequest:#Exchange"},e)}},3209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(2727);t.default=function(e,t){return void 0===e.request||e.request.__type||(e.request=i.default(e.request)),r.makeServiceRequest("SetAttachmentPermissionsV2",e,t)}},3767:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(3208);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("CheckPendingAttachmentOperation",e,t)}},697:function(e,t,n){"use strict";var r;!function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem"}(r||(r={}));var i={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function o(e){switch(e?e.toLowerCase():null){case i.ONE_DRIVE_PRO.toLowerCase():return 0;case i.GDRIVE.toLowerCase():return 5;case i.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case i.DROPBOX.toLowerCase():return 2;case i.BOX.toLowerCase():return 3;case i.WOPI_BOX.toLowerCase():return 7;case i.WOPI_EGNYTE.toLowerCase():return 8;case i.MAILBOX.toLowerCase():return 4;case i.FACEBOOK.toLowerCase():return 6;default:return null}}function a(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:r.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function u(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],o={fileType:r.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(o)}return t}function s(e,t){var n=[],i={fileType:r.MailItem,name:e,size:0,mimeContent:t};return n.push(i),n}var l=n(11);function d(e,t){if(e.length!=t.length)return l.c.error("The sizes of subjects and latestItemIds are different"),null;for(var n=[],i=0;i<e.length;i++){var o={fileType:r.MailItem,name:e[i],size:0,itemId:t[i]};n.push(o)}return n}var f=n(868);function h(e){return e.map(function(e){return{fileType:r.Uri,name:e.name,type:Object(f.a)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return o}),n.d(t,"e",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return c}),n.d(t,"h",function(){return h}),n.d(t,"f",function(){return s}),n.d(t,"a",function(){return r})},825:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(727);function i(e){return Object(r.a)().attachments.get(e.Id)}},826:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange"}(o||(o={}))},827:function(e,t,n){"use strict";var r;!function(e){e.InfoRestrictedAccess="infoRestrictedAccess"}(r||(r={}));var i=n(129);function o(e){switch(e){case 0:return r.InfoRestrictedAccess;default:return Object(i.a)(e)}}var a,c=n(7);function u(e){switch(e){case 0:return(t=Object(c.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(i.a)(e)}var t}!function(e){e[e.AccessRestricted=0]="AccessRestricted"}(a||(a={}));var s=[0],l=n(1534);function d(e){return e&&e.length>0&&function(e){return e.some(function(e){return!((t=e).IsInline&&!function(e){return e.__type===l.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t})}(e)?s.filter(u):[]}var f=n(8),h=n.n(f),p=n(826);function m(e){switch(e){case r.InfoRestrictedAccess:return{key:"access_control_info_bar",source:p.c.Compose,rank:p.b.Error,messageParts:[h.a.attachmentPolicyInformation,(t="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(f.getOwaMailStrings)().attachmentPolicyHyperLinkText,action:function(){window.open(t,"_blank")}})],color:p.a.Red};default:return Object(i.a)(e)}var t}var v,b=n(868);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.ConditionalAccess=4]="ConditionalAccess"}(v||(v={}));var w=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=v[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,r){e&&(e=e.toLowerCase());var i=this.getFileAccessLevel(e,t),o=!1,a=!1,c=!1,u="ReferenceAttachment:#Exchange"===r;return i!==v.Block&&n&&(this.isWacViewingEnabled(e)&&(o=!0),!this.directFileAccessEnabled&&u&&(o=!1),a=this.isForceBrowserViewingFirst(o),o&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),o||this.directFileAccessEnabled||(i=v.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:i,useWac:o,forceBrowserViewingFirst:a,wacEdit:c}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=v.Undefined),n===v.Block)return v.Block;var r=this.mimeTypeToPolicyMap[t];return r===v.Block?v.Block:n===v.ForceSave||r===v.ForceSave?v.ForceSave:n===v.Allow||r===v.Allow?v.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var r={};return this.addPolicyIntoMap(r,n,v.Allow),this.addPolicyIntoMap(r,t,v.ForceSave),this.addPolicyIntoMap(r,e,v.Block),r},e}(),g=null,P=null;function O(){if(!g){var e=Object(c.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;g=new w(t,n),n&&(P=g)}return g}function y(e,t){var n=Object(b.a)(e.Name),r=e.ContentType;return O().getPolicyInfo(n,r,t,e.__type)}function I(e,t){var n=Object(b.a)(e.Name),r=e.ContentType;return function(){if(!P){var e=Object(c.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return O();P=new w(e.AttachmentPolicy,!0)}return P}().getPolicyInfo(n,r,t,e.__type)}function A(e,t,n){var r=y(e,!0),i=O();return r.level!==v.Block&&i.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"h",function(){return m}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return d}),n.d(t,"a",function(){return s}),n.d(t,"g",function(){return o}),n.d(t,"i",function(){return A}),n.d(t,"c",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"f",function(){return I}),n.d(t,"j",function(){return O})},828:function(e,t,n){"use strict";var r=n(0);var i=n(1537),o=n.n(i),a=n(7),c=n(12),u=n(63),s=n(5),l=n(20),d=n(11);n.d(t,"a",function(){return p}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return v});var f=function(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,o=function(a,c){i?c(new Error("The function retry was cancelled")):(r++,e().then(a).catch(function(e){t&&r>=t?c(e):setTimeout(function(){return o(a,c)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return o(e,t)})},cancel:function(){return i=!0}}}}({timeBetweenRetryInMS:function(){return 3e4}}),h=function(){function e(e,t,n,i){var a=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.mailboxAddress=n,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(a,void 0,void 0,function(){function e(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,i,a,u=this;return r.__generator(this,function(o){switch(o.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=f(function(){return r.__awaiter(u,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,i=new c.b("AttachmentRefreshDownloadToken"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n()];case 2:return o.sent(),i.addCustomData([t]),i.end(),[3,4];case 3:return a=o.sent(),d.c.warn("Retry to refresh token failed: "+a),i.addCustomData([t]),i.endWithError("ServerError",a),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(l.isStringNullOrWhiteSpace)(this.downloadUrlBase)&&!Object(l.isStringNullOrWhiteSpace)(this.mailboxAddress)&&Object(s.d)("doc-attachment-downloadDomain"),this.downloadToken=i,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(a.a)(),n=Object(u.c)().mailboxId,r=t.ApplicationSettings;e.instance=new e(r.DownloadTokenRefreshMinutes,r.DownloadUrlBase,n,r.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function p(){return h.getInstance().getDownloadToken()}function m(){return h.getInstance().getUseDownloadUrlBase()}function v(){return h.getInstance().getDownloadUrlBase()}},830:function(e,t,n){"use strict";var r=n(1528);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var i=n(828);n.d(t,"c",function(){return i.a})},868:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){var t=r(e);return t?t.replace(".",""):null}var o=n(8),a=n.n(o),c=n(20);function u(e){var t;return e>=1073741824?(e/=1073741824,t=a.a.sizeWithGigabyteAbbreviationText):e>=1048576?(e/=1048576,t=a.a.sizeWithMegabyteAbbreviationText):e>=1024?(e/=1024,t=a.a.sizeWithKilobyteAbbreviationText):t=a.a.sizeWithByteAbbreviationText,Object(c.format)(t,Math.round(e))}var s=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];function l(e){var t=r(e);return!!t&&s.indexOf(t.toLowerCase())>=0}var d=n(5),f=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function h(e){if(!Object(d.d)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&f.indexOf(t.toLowerCase())>=0}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return h})}},0,[279,51,280,57,226]]);
//# sourceMappingURL=owa.AttachmentModelStore.mail.js.map
window.scriptsLoaded['owa.AttachmentModelStore.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.AttachmentModelStore.mail.js'] = (new Date()).getTime();