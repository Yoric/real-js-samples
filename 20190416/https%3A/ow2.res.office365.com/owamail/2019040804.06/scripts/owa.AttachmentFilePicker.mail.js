window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.AttachmentFilePicker.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[60],{6907:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r(2429),o=r(697);function a(e,t,r,n){c(e,Object(o.e)(t),n,r)}function c(e,t,r,n,i){void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=null),e({files:t,shouldShare:r,isInline:n,dataProviderType:i})}function u(e,t,r,n){if(r===i.e.LocalComputerFiles)a(e,t,n===i.a.Insert,n===i.a.Share);else if(r===i.e.ProviderFiles){var u=t;n!==i.a.AttachAndShare?function(e,t,r){var n=t.length>0?t[0].model.ProviderType:null,i=null;if(n&&10===n){var a=[],u=[];t.forEach(function(e){a.push(e.model.Subject),u.push(e.model.Id)}),i=Object(o.g)(a,u)}else i=t.map(function(e){return Object(o.d)(e.model)});c(e,i,r,!1,n)}(e,u,n===i.a.Share):function(e,t){var r=t.length>0?t[0].model.ProviderType:null,n=t.filter(function(e){return null!==e.location}),i=t.filter(function(e){return null===e.location});n.length>0&&c(e,n.map(function(e){return Object(o.d)(e.model)}),!0,!1,r),i.length>0&&c(e,i.map(function(e){return Object(o.c)(e.model)}),!1,!1,r)}(e,u)}}var l=r(7),s=r(47),f=1,h=2,d=3;function p(e){switch(e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse){case f:return i.b.List;case h:return i.b.Tile;default:return Object(s.a)()?i.b.Tile:i.b.List}}var S=r(129);function g(e){switch(e){case i.b.List:return f;case i.b.Tile:return h;case i.b.Groups:return d;default:return Object(S.a)(e)}}var F={AFPChangePreferredViewType:{name:"AFPChangePreferredViewType",customData:function(e,t){return[g(t)]}},AFPSetUserPreferredAction:{name:"AFPSetUserPrefferdAction",customData:function(e,t){return[t]}},AFPSetUserPreferredActionGroups:{name:"AFPSetUserPreferredActionGroups",customData:function(e,t){return[t]}}},v=r(30),A=r(105),m=r.n(A),P=r(619),w=r.n(P),b=r(643),y=r.n(b),C=r(644),O=r.n(C),V=r(60),T=r.n(V),j=r(36),k=r.n(j),I=r(620),_=r.n(I),G=r(31),U="root",D="OWA.ViewStateConfiguration";function L(e,t,r){var n=w()({UserConfigurationName:_()({Name:e,BaseFolderId:m()({Id:U})}),Dictionary:[T()({DictionaryKey:k()(t),DictionaryValue:k()(r)})]});return y()({Header:Object(G.getJsonRequestHeader)(),Body:O()({UserConfiguration:n})}).then(function(e){return e.Body.ResponseMessages.Items[0]})}var M=Object(v.b)("setUserPreferredViewType",F.AFPChangePreferredViewType)(function(e,t){e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse=g(t),L(D,{Type:"String",Value:["AttachmentsFilePickerViewTypeForMouse"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachmentsFilePickerViewTypeForMouse]})}),E=Object(v.b)("setPreferredActionForCloudFile",F.AFPSetUserPreferredAction)(function(e,t){e.ViewStateConfiguration.AttachOrShareCloudFiles=t,L(D,{Type:"String",Value:["AttachOrShareCloudFiles"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachOrShareCloudFiles]})}),B=Object(v.b)("setPreferredActionForGroupFile",F.AFPSetUserPreferredActionGroups)(function(e,t){e.ViewStateConfiguration.AttachOrShareGroupsFiles=t,L(D,{Type:"String",Value:["AttachOrShareGroupsFiles"]},{Type:"Integer32",Value:[""+e.ViewStateConfiguration.AttachOrShareGroupsFiles]})});function H(){var e=Object(l.a)();return{preferredViewType:{value:p(e),valueSetter:function(t){M(e,t)}},attachOrShareCloudFiles:{value:e.ViewStateConfiguration.AttachOrShareCloudFiles,valueSetter:function(t){E(e,t)}},attachOrShareGroupsFiles:{value:e.ViewStateConfiguration.AttachOrShareGroupsFiles,valueSetter:function(t){B(e,t)}}}}var N=r(11);function R(e,t,r,o,a){return n.__awaiter(this,void 0,void 0,function(){var c,l;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.h.import()];case 1:c=n.sent(),l=H();try{return[2,c(t,a,r,!1,t.length>1,o,l).then(function(r){u(e,t,o,r)}).catch(function(){})]}catch(e){N.c.error("Error creating the action panel. Attaching or sharing files might not work! "+e)}return[2]}})})}function $(e,t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i.i.import()];case 1:r=n.sent(),t.userConfiguration||(t.userConfiguration=H());try{return[2,r(t).then(function(t){u(e,t.files,t.source,t.action)}).catch(function(){})]}catch(e){N.c.error("Error creating the file picker. Attaching or sharing files might not work! "+e)}return[2]}})})}var q=r(17),x=r(3083),z=r(3),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onFilesSelected=function(e){var r=t.props,n=r.action;a(r.createAttachmentHandler,e,n===x.b.Insert,n===x.b.Share)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this;return z.createElement(i.d,{ref:function(t){return e.localComputerFilePicker=t},onFilesSelected:this.onFilesSelected,fileSelectionFilter:this.props.fileSelectionFilter})},t.prototype.click=function(){this.localComputerFilePicker.getInnerComponent().click()},t=n.__decorate([q.observer],t)}(z.Component),K=r(12),W=r(868);function Q(e){for(var t=e.files,r=e.shouldShare,n=e.isInline,i=e.dataProviderType,o=[],a=0;t[a];)o=o.concat(t[a].size),a++;var c=function(e){for(var t=[],r=0;e[r];)t=t.concat(Object(W.a)(e[r].name)),r++;return t}(t);Object(K.k)("AFPAttachOrShare",[r,n,o.join(","),t.length,i,c.join(","),!1])}r.d(t,"attachmentActionsPanel",function(){return R}),r.d(t,"attachmentFilePicker",function(){return $}),r.d(t,"AttachmentLocalComputerFilePicker",function(){return J}),r.d(t,"logAttachOrShareDatapoint",function(){return Q})}},0,[2,8,20,288,103,3,105,279,51,280,57]]);
//# sourceMappingURL=owa.AttachmentFilePicker.mail.js.map
window.scriptsLoaded['owa.AttachmentFilePicker.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.AttachmentFilePicker.mail.js'] = (new Date()).getTime();