window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.OwaHipCheckModal.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[198],{1884:function(e,r,t){"use strict";t.r(r);var a=t(0),o=t(3),n=t(17),l=t(5),c="vendor_hip_script",i="hip_global_challenge_loaded_callback",A="https://client.arkoselabs.com/fc/api/?onload="+i,s=[],h=!1;function u(){return h?Promise.resolve(window.ArkoseEnforcement):null!=document.querySelector("script#"+c)?new Promise(function(e,r){s.push({resolve:e,reject:r})}):new Promise(function(e,r){s.push({resolve:e,reject:r}),Object.hasOwnProperty(i)&&s.forEach(function(e){return(0,e.reject)(new Error("There was already a global callback registered. This should not happen."))}),window[i]=function(){h=!0,delete window[i],s.forEach(function(e){return(0,e.resolve)(window.ArkoseEnforcement)})};var t=document.createElement("script");t.src=A,t.id=c,document.querySelector("head").appendChild(t)})}var d=t(1856),m=t(723),b=t(1349),g=t(236),k=t(275),f=t.n(k),p=t(4522),B=t.n(p),v=t(5570),S=t.n(v);function _(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(r){return[2,S()(B()({FcToken:e}))]})})}var w,H=t(8),E=t.n(H),y=t(12),O=t(5571),T="vendor_hip_host",U="data-is-focusable";!function(e){e[e.INITIAL=0]="INITIAL",e[e.COMPLETED_WAITING_FOR_SERVER=1]="COMPLETED_WAITING_FOR_SERVER",e[e.SUBMITTED_WITHOUT_ATTEMPT=2]="SUBMITTED_WITHOUT_ATTEMPT",e[e.FAILED_SERVER_VALIDATION=3]="FAILED_SERVER_VALIDATION",e[e.ERROR=4]="ERROR"}(w||(w={}));var G=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(r,e),r.prototype.shouldComponentUpdate=function(){return!1},r.prototype.render=function(){return o.createElement("div",{id:T,className:O.vendorHipHost},o.createElement("div",null,o.createElement(b.a,{size:g.a.large,label:E.a.placeholderLoadingMessage,ariaLive:"assertive"})))},r}(o.Component);function M(){var e=document.getElementById(T);if(e)for(var r=e.querySelectorAll("iframe"),t=0;t<r.length;t++)r[t].setAttribute(U,"true")}var Q=function(e){switch(e.captchaState){case 2:return o.createElement("div",{className:f()(O.banner,O.waiting)},E.a.captchaSubmittedWithoutAttempt);case 1:return o.createElement("div",{className:f()(O.banner,O.waiting)},o.createElement(b.a,{size:g.a.large,label:E.a.captchaPending,labelPosition:"right",ariaLive:"assertive"}));case 3:return o.createElement("div",{className:f()(O.banner,O.failure)},E.a.captchaFailed);case 4:return o.createElement("div",{className:f()(O.banner,O.failure)},E.a.captchaError);case 0:return null}},C=function(e){function r(r){var t=e.call(this,r)||this;return t.formRef=o.createRef(),t.submitToServer=function(){return a.__awaiter(t,void 0,void 0,function(){var e,r,t;return a.__generator(this,function(a){switch(a.label){case 0:null==(e=this.arkoseEnforcement.getSessionToken())&&(Object(y.k)("ArkoseCaptchaFcTokenUnset"),this.setState({captchaState:4})),this.setState({isFetchingCaptchaResult:!0}),a.label=1;case 1:return a.trys.push([1,3,,4]),Object(y.k)("ArkoseCaptchaSubmitted",[this.getArkoseSessionTokenForLogs()]),[4,_(e)];case 2:return r=a.sent(),[3,4];case 3:throw t=a.sent(),Object(y.k)("ArkoseCaptchaBackendError",[this.getArkoseSessionTokenForLogs(),"Server error : "+t.message]),this.setState({captchaState:4}),t;case 4:if(r.Error)throw this.setState({captchaState:4}),Object(y.k)("ArkoseCaptchaBackendError",[this.getArkoseSessionTokenForLogs(),r.Error.ErrorMessage]),new Error('Error verifying captcha token: "'+r.Error.ErrorMessage+'"');return r.Success&&r.Success.Solved?(Object(y.k)("ArkoseCaptchaVerifiedCompleted",[this.getArkoseSessionTokenForLogs()]),this.props.onDismiss({success:!0})):(this.arkoseEnforcement.refresh_session(),this.setState({captchaState:r.Success.Attempted?3:2})),[2]}})})},t.closeModal=function(){Object(y.k)("ArkoseCaptchaModalClosed",[t.getArkoseSessionTokenForLogs()]),t.props.onDismiss({success:!1})},t.getArkoseSessionTokenForLogs=function(){return t.arkoseEnforcement&&t.arkoseEnforcement.getSessionToken()},t.state={isFetchingCaptchaResult:!1,captchaState:0},t}return a.__extends(r,e),r.prototype.componentDidMount=function(){var e=this;this._isMounted=!0,Object(y.k)("ArkoseCaptchaModalOpened"),u().then(function(r){e._isMounted&&(e.arkoseEnforcement=new r({public_key:"FB98C7DB-7AFF-DD4C-A55B-6CF11267BC91",target_html:T,callback:function(){e.setState({captchaState:1}),e.submitToServer()},loaded_callback:M}),Object(y.k)("ArkoseCaptchaLoaded",[e.getArkoseSessionTokenForLogs()]))})},r.prototype.componentWillUnmount=function(){this._isMounted=!1},r.prototype.render=function(){return o.createElement(d.a,{containerClassName:O.modalContainer,hidden:!1,title:E.a.vendorCaptchaTitle,dialogContentProps:{type:m.a.normal},onDismiss:this.closeModal,modalProps:{isBlocking:!0}},o.createElement(Q,{captchaState:this.state.captchaState}),o.createElement("p",{className:O.introParagraph},E.a.vendorCaptchaExplanation),o.createElement("form",{ref:this.formRef},o.createElement(G,null)))},r}(o.PureComponent),D=t(5573),V="owahipcontrol.aspx",W="ht=1",x=function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.frameElement=null,r.formChangeObserver=null,r.onUnload=function(){setTimeout(function(){r.onLocationChanged()},0)},r.onLocationChanged=function(){var e=r.frameElement&&r.frameElement.contentWindow&&r.frameElement.contentWindow.location&&r.frameElement.contentWindow.location.href;if(!e)throw new Error("Hip check iframe had no location after unload");-1!==e.indexOf(V)&&-1===e.indexOf(W)||r.props.onDismiss({success:!0})},r.registerFormChangeObserver=function(){r.formChangeObserver=new MutationObserver(r.recalculateFrameHeight),r.formChangeObserver.observe(r.getIframeFormElement(),{childList:!0,subtree:!0}),r.recalculateFrameHeight()},r.recalculateFrameHeight=function(){r.frameElement.style.height=r.getIframeFormElement().scrollHeight+"px"},r.getIframeFormElement=function(){var e=r.frameElement.contentDocument.querySelector(".owa-hip-form");if(!e)throw r.props.onDismiss({success:!1}),new Error("The content of the iframe'd hip page should have an object with class '.owa-hip-form'");return e},r}return a.__extends(r,e),r.prototype.componentWillUnmount=function(){null!==this.frameElement&&(this.frameElement.removeEventListener("load",this.recalculateFrameHeight),this.frameElement.contentWindow.removeEventListener("unload",this.onUnload)),this.formChangeObserver&&this.formChangeObserver.disconnect()},r.prototype.shouldComponentUpdate=function(){return!1},r.prototype.registerIframeCloseCallback=function(){this.frameElement.addEventListener("load",this.registerFormChangeObserver),this.frameElement.contentWindow.addEventListener("unload",this.onUnload)},r.prototype.render=function(){var e=this;return o.createElement(d.a,{hidden:!1,dialogContentProps:{className:D.hipCheckDialogRoot,type:m.a.normal},onDismiss:function(){return e.props.onDismiss({success:!1})}},o.createElement("iframe",{className:D.hipCheckIframe,ref:function(r){r&&(e.frameElement=r,e.registerIframeCloseCallback())},src:"/owa/owahipcontrol.aspx?compose=1&embedForm=1"}))},r}(o.Component),I=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(r,e),r.prototype.render=function(){return Object(l.d)("cmp-hipCheckVendorModal")?o.createElement(C,a.__assign({},this.props)):o.createElement(x,a.__assign({},this.props))},r=a.__decorate([n.observer],r)}(o.Component);t.d(r,"HipCheckModal",function(){return I})},5571:function(e,r,t){var a=t(5572),o=t(55);"string"==typeof a&&(a=[[e.i,a]]);for(var n=0;n<a.length;n++)o.loadStyles(a[n][1],!1);a.locals&&(e.exports=a.locals)},5572:function(e,r,t){(r=e.exports=t(54)(!1)).push([e.i,'._3hWHhSaV8T06NwObiwsbu7,._3p9kwawpfgB6hZhUSn7Gf6{max-width:301px}._3p9kwawpfgB6hZhUSn7Gf6{color:"[theme:white, default:#ffffff]"}html[dir] ._3p9kwawpfgB6hZhUSn7Gf6{padding:1em}html[dir] ._3p9kwawpfgB6hZhUSn7Gf6._1fe0bRei05hfP6YdjjwIlN{background-color:"[theme:redDark, default:#a80000]"}html[dir] ._3p9kwawpfgB6hZhUSn7Gf6._2_MYqNo_YeC8GznJGnsgaz{background-color:#004b1c}html[dir] ._3p9kwawpfgB6hZhUSn7Gf6._2T-qIsGeA10AziW16PXSMe{background-color:"[theme:neutralLighterAlt, default:#f8f8f8]"}._2Tb9SruPvHT2QkS0oHigMu{min-height:310px;min-width:308px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._1Ij8fsHUpe8v3KNYnk03jg{max-width:none!important;min-width:357px}',""]),r.locals={banner:"_3p9kwawpfgB6hZhUSn7Gf6",introParagraph:"_3hWHhSaV8T06NwObiwsbu7",failure:"_1fe0bRei05hfP6YdjjwIlN",success:"_2_MYqNo_YeC8GznJGnsgaz",waiting:"_2T-qIsGeA10AziW16PXSMe",vendorHipHost:"_2Tb9SruPvHT2QkS0oHigMu",modalContainer:"_1Ij8fsHUpe8v3KNYnk03jg"}},5573:function(e,r,t){var a=t(5574),o=t(55);"string"==typeof a&&(a=[[e.i,a]]);for(var n=0;n<a.length;n++)o.loadStyles(a[n][1],!1);a.locals&&(e.exports=a.locals)},5574:function(e,r,t){(r=e.exports=t(54)(!1)).push([e.i,'._2hoFexALcnYPJG-_YaAOU4{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._2hoFexALcnYPJG-_YaAOU4{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._37yoQ_9BOAc0W0VGHSH2UD{-ms-overflow-style:-ms-autohiding-scrollbar;scrollbar-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]" transparent;scrollbar-width:thin;min-height:420px;max-height:70vh;outline:0}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD{border:0}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar{height:18px;width:18px}._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar:disabled{display:none}._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-corner{cursor:pointer}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-corner{background:transparent}._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:decrement,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:decrement:hover,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:increment,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:increment:hover,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:decrement,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:decrement:hover,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:increment,._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:increment:hover{height:18px;width:18px}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:decrement,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:increment,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:decrement,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:increment,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-button:vertical:increment:hover{background-position:50%}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-track{background:transparent}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-thumb,html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-thumb:hover{border-radius:9px;border:solid 6px transparent;background-clip:content-box}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-thumb{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-thumb:hover{background-color:#98a3a6}._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-thumb:vertical{min-height:50px}._37yoQ_9BOAc0W0VGHSH2UD::-webkit-scrollbar-thumb:horizontal{min-width:50px}',""]),r.locals={hipCheckDialogRoot:"_2hoFexALcnYPJG-_YaAOU4",hipCheckIframe:"_37yoQ_9BOAc0W0VGHSH2UD"}}},0,[279,51,280,57]]);
//# sourceMappingURL=owa.OwaHipCheckModal.mail.js.map
window.scriptsLoaded['owa.OwaHipCheckModal.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.OwaHipCheckModal.mail.js'] = (new Date()).getTime();