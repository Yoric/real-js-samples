window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.OutlookServiceOptions.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[194],{7046:function(t,e,o){"use strict";o.r(e);var n,a=o(0),i=o(4),r=Object(i.action)("setFeatureSettings")(function(t,e,o){t.options[e]=o}),c=o(43),s=o(1112),d=o(611),u=o(89),f=o(56),O=o(20),p=o(11),l="ows/v1.0/OutlookOptions/{0}";function b(t,e){var o=Object(O.format)(l,c.a[t]);if(Object(d.a)().loadState===s.a.OptionsLoaded){if(Object(d.a)().options[t]&&Object(d.a)().options[t].lastModifiedDateTime){if(e&&0!==Object.keys(e).length){var n=e;n["feature@is.Queryable"],n["feature@odata.type"],n.createdDateTime,n.lastModifiedDateTime;return j(1,o,a.__rest(n,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]))}return p.c.info("createOrUpdateOptionsForFeature called with no changes to options"),Promise.resolve()}return j(0,o,e)}return Promise.reject("Options are not loaded. Cannot update options.")}function j(t,e,o){var n={correlationId:Object(u.a)(),options:o};return(1==t?f.c:f.d)(e,n,n.correlationId).then(function(t){if(!function(t){if(t&&t.options&&1==t.options.length){var e=t.options[0];return r(Object(d.a)(),e.feature,e),!0}return!1}(t))throw new Error("Error processing options response")})}!function(t){t[t.POST=0]="POST",t[t.PATCH=1]="PATCH"}(n||(n={}));var v=o(610),S=o(395),h=Object(i.action)("applyDefaultOptions")(function(t){void 0===t&&(t=Object(v.a)()),Object.keys(Object(d.a)().options).forEach(function(e){Object(d.a)().options[e].lastModifiedDateTime||t[e]&&S(Object(d.a)().options[e],t[e])})}),w=o(1161),m=null,A=Object(i.action)("loadOptions")(function(){switch(Object(d.a)().loadState){case s.a.OptionsNotLoaded:return Object(d.a)().loadState=s.a.OptionsLoading,m=Object(f.b)("ows/v1.0/OutlookOptions").then(function(t){!function(t){t?(t.options&&t.options.forEach(function(t){null!=t&&r(Object(d.a)(),t.feature,t)}),h(),Object(d.a)().loadState=s.a.OptionsLoaded):(p.c.info("Error loading options"),Object(w.a)(),Object(d.a)().loadState=s.a.OptionsNotLoaded)}(t),m=null});case s.a.OptionsLoading:return m;case s.a.OptionsLoaded:return Promise.resolve()}});var g=o(1e3);function T(t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(e){switch(e.label){case 0:return[4,A()];case 1:return e.sent(),[2,Object(g.a)(t)]}})})}var P=Object(i.action)("updateAddinPinStatus")(function(t,e,o){var n=Object(g.a)(c.a.SurfaceActions),a=Object(g.a)(c.a.CalendarSurfaceAddins),i=!!o.readMode&&y(n.readSurfaceAddins,t,e);i=o.composeMode&&y(n.composeSurfaceAddins,t,e)||i;var r=!!o.calendarMode&&y(a.calendarSurfaceAddins,t,e);i&&b(c.a.SurfaceActions,n),r&&b(c.a.CalendarSurfaceAddins,a)}),y=function(t,e,o){var n=!1;return o?-1===t.indexOf(e)&&(t.push(e),n=!0):-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),n=!0),n};o.d(e,"createOrUpdateOptionsForFeature",function(){return b}),o.d(e,"loadOptions",function(){return A}),o.d(e,"getServerOptionsForFeature",function(){return T}),o.d(e,"updateAddinPinStatus",function(){return P})}},0,[279,51]]);
//# sourceMappingURL=owa.OutlookServiceOptions.mail.js.map
window.scriptsLoaded['owa.OutlookServiceOptions.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.OutlookServiceOptions.mail.js'] = (new Date()).getTime();