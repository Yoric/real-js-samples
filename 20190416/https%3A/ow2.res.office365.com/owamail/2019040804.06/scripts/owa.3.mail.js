window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.3.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[3],{2112:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return s});var i,s,o="change";!function(e){e[e.none=0]="none",e[e.single=1]="single",e[e.multiple=2]="multiple"}(i||(i={})),function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(s||(s={}))},3532:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(2112),s=n(317),o=function(){function e(e){void 0===e&&(e={});var t=e.onSelectionChanged,n=e.getKey,s=e.canSelectItem,o=void 0===s?function(e){return!0}:s,r=e.selectionMode,l=void 0===r?i.c.multiple:r;this.mode=l,this._getKey=n||c,this._changeEventSuppressionCount=0,this._exemptedCount=0,this._anchoredIndex=0,this._unselectableCount=0,this._onSelectionChanged=t,this._canSelectItem=o,this._isModal=!1,this.setItems([],!0)}return e.prototype.canSelectItem=function(e,t){return!("number"==typeof t&&t<0)&&this._canSelectItem(e,t)},e.prototype.getKey=function(e,t){var n=this._getKey(e,t);return"number"==typeof n||n?""+n:""},e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1,0===this._changeEventSuppressionCount&&this._hasChanged&&(this._hasChanged=!1,t||this._change())},e.prototype.isModal=function(){return this._isModal},e.prototype.setModal=function(e){this._isModal!==e&&(this.setChangeEvents(!1),this._isModal=e,e||this.setAllSelected(!1),this._change(),this.setChangeEvents(!0))},e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var n={},i={},s=!1;this.setChangeEvents(!1),this._unselectableCount=0;for(var o=0;o<e.length;o++){if(a=e[o]){var c=this.getKey(a,o);c&&(n[c]=o)}i[o]=a&&!this.canSelectItem(a),i[o]&&this._unselectableCount++}(t||0===e.length)&&this.setAllSelected(!1);var r={},l=0;for(var h in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(h)){var a,u=Number(h),d=(a=this._items[u])?this.getKey(a,Number(u)):void 0,_=d?n[d]:u;void 0===_?s=!0:(r[_]=!0,l++,s=s||_!==u)}this._items&&0===this._exemptedCount&&e.length!==this._items.length&&this._isAllSelected&&(s=!0),this._exemptedIndices=r,this._exemptedCount=l,this._keyToIndexMap=n,this._unselectableIndices=i,this._items=e,this._selectedItems=null,s&&(this._updateCount(),this._change()),this.setChangeEvents(!0)},e.prototype.getItems=function(){return this._items},e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedItems.push(e[t])}return this._selectedItems},e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount},e.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedIndices.push(t)}return this._selectedIndices},e.prototype.isRangeSelected=function(e,t){if(0===t)return!1;for(var n=e+t,i=e;i<n;i++)if(!this.isIndexSelected(i))return!1;return!0},e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;return this.mode===i.c.single&&(e=Math.min(e,1)),this.count>0&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&e>0},e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)},e.prototype.isIndexSelected=function(e){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])},e.prototype.setAllSelected=function(e){if(!e||this.mode===i.c.multiple){var t=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),t>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount()),this.setChangeEvents(!0)}},e.prototype.setKeySelected=function(e,t,n){var i=this._keyToIndexMap[e];i>=0&&this.setIndexSelected(i,t,n)},e.prototype.setIndexSelected=function(e,t,n){if(this.mode!==i.c.none&&!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){this.setChangeEvents(!1);var s=this._exemptedIndices[e];!this._unselectableIndices[e]&&(t&&this.mode===i.c.single&&this.setAllSelected(!1),s&&(t&&this._isAllSelected||!t&&!this._isAllSelected)&&(delete this._exemptedIndices[e],this._exemptedCount--),!s&&(t&&!this._isAllSelected||!t&&this._isAllSelected)&&(this._exemptedIndices[e]=!0,this._exemptedCount++),n&&(this._anchoredIndex=e)),this._updateCount(),this.setChangeEvents(!0)}},e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)},e.prototype.selectToIndex=function(e,t){if(this.mode!==i.c.none)if(this.mode!==i.c.single){var n=this._anchoredIndex||0,s=Math.min(e,n),o=Math.max(e,n);for(this.setChangeEvents(!1),t&&this.setAllSelected(!1);s<=o;s++)this.setIndexSelected(s,!0,!1);this.setChangeEvents(!0)}else this.setIndexSelected(e,!0,!0)},e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())},e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)},e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)},e.prototype.toggleRangeSelected=function(e,t){if(this.mode!==i.c.none){var n=this.isRangeSelected(e,t),s=e+t;if(!(this.mode===i.c.single&&t>1)){this.setChangeEvents(!1);for(var o=e;o<s;o++)this.setIndexSelected(o,!n,!1);this.setChangeEvents(!0)}}},e.prototype._updateCount=function(){var e=this.getSelectedCount();e!==this.count&&(this.count=e,this._change()),this.count||this.setModal(!1)},e.prototype._change=function(){0===this._changeEventSuppressionCount?(this._selectedItems=null,this._selectedIndices=void 0,s.EventGroup.raise(this,i.a),this._onSelectionChanged&&this._onSelectionChanged()):this._hasChanged=!0},e}();function c(e,t){return e&&e.key?e.key:""+t}},3534:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n(0),s=n(3),o=n(335),c=n(193),r=n(98),l=n(255),h=n(712),a=n(144),u=n(95),d=n(128),_=n(2112),p="data-selection-toggle",f="data-selection-invoke",g="data-selection-all-toggle",m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._root=s.createRef(),t.ignoreNextFocus=function(){t._handleNextFocus(!1)},t._onMouseDownCapture=function(e){if(document.activeElement===e.target||Object(o.a)(document.activeElement,e.target)){if(Object(o.a)(e.target,t._root.current))for(var n=e.target;n!==t._root.current;){if(t._hasAttribute(n,f)){t.ignoreNextFocus();break}n=Object(c.a)(n)}}else t.ignoreNextFocus()},t._onFocus=function(e){var n=e.target,i=t.props.selection,s=t._isCtrlPressed||t._isMetaPressed,o=t._getSelectionMode();if(t._shouldHandleFocus&&o!==_.c.none){var c=t._hasAttribute(n,p),r=t._findItemRoot(n);if(!c&&r){var l=t._getItemIndex(r);s?(i.setIndexSelected(l,i.isIndexSelected(l),!0),t.props.enterModalOnTouch&&t._isTouch&&i.setModal&&(i.setModal(!0),t._setIsTouch(!1))):t.props.isSelectedOnFocus&&t._onItemSurfaceClick(e,l)}}t._handleNextFocus(!1)},t._onMouseDown=function(e){t._updateModifiers(e);var n=e.target,i=t._findItemRoot(n);if(!t._isSelectionDisabled(n))for(;n!==t._root.current&&!t._hasAttribute(n,g);){if(i){if(t._hasAttribute(n,p))break;if(t._hasAttribute(n,f))break;if(!(n!==i&&!t._shouldAutoSelect(n)||t._isShiftPressed||t._isCtrlPressed||t._isMetaPressed)){t._onInvokeMouseDown(e,t._getItemIndex(i));break}if(t.props.disableAutoSelectOnInputElements&&("A"===n.tagName||"BUTTON"===n.tagName||"INPUT"===n.tagName))return}n=Object(c.a)(n)}},t._onTouchStartCapture=function(e){t._setIsTouch(!0)},t._onClick=function(e){t._updateModifiers(e);var n=e.target,i=t._findItemRoot(n);if(!t._isSelectionDisabled(n))for(;n!==t._root.current;){if(t._hasAttribute(n,g)){t._onToggleAllClick(e);break}if(i){var s=t._getItemIndex(i);if(t._hasAttribute(n,p)){t._isShiftPressed?t._onItemSurfaceClick(e,s):t._onToggleClick(e,s);break}if(t._hasAttribute(n,f)){t._onInvokeClick(e,s);break}if(n===i){t._onItemSurfaceClick(e,s);break}if("A"===n.tagName||"BUTTON"===n.tagName||"INPUT"===n.tagName)return}n=Object(c.a)(n)}},t._onContextMenu=function(e){var n=e.target,i=t.props,s=i.onItemContextMenu,o=i.selection;if(s){var c=t._findItemRoot(n);if(c){var r=t._getItemIndex(c);t._onInvokeMouseDown(e,r),s(o.getItems()[r],r,e.nativeEvent)||e.preventDefault()}}},t._onDoubleClick=function(e){var n=e.target;if(!t._isSelectionDisabled(n)){var i=t.props.onItemInvoked,s=t._findItemRoot(n),o=t._getSelectionMode();if(s&&i&&o!==_.c.none&&!t._isInputElement(n)){for(var r=t._getItemIndex(s);n!==t._root.current&&!t._hasAttribute(n,p)&&!t._hasAttribute(n,f);){if(n===s){t._onInvokeClick(e,r);break}n=Object(c.a)(n)}n=Object(c.a)(n)}}},t._onKeyDownCapture=function(e){t._updateModifiers(e),t._handleNextFocus(!0)},t._onKeyDown=function(e){t._updateModifiers(e);var n=e.target;if(!t._isSelectionDisabled(n)){var i=t.props.selection,s=e.which===r.a.a&&(t._isCtrlPressed||t._isMetaPressed),o=e.which===r.a.escape;if(!t._isInputElement(n)){var l=t._getSelectionMode();if(s&&l===_.c.multiple&&!i.isAllSelected())return i.setAllSelected(!0),e.stopPropagation(),void e.preventDefault();if(o&&i.getSelectedCount()>0)return i.setAllSelected(!1),e.stopPropagation(),void e.preventDefault();var h=t._findItemRoot(n);if(h)for(var a=t._getItemIndex(h);n!==t._root.current&&!t._hasAttribute(n,p);){if(t._shouldAutoSelect(n)){t._onInvokeMouseDown(e,a);break}if(!(e.which!==r.a.enter&&e.which!==r.a.space||"BUTTON"!==n.tagName&&"A"!==n.tagName&&"INPUT"!==n.tagName))return!1;if(n===h){if(e.which===r.a.enter)return t._onInvokeClick(e,a),void e.preventDefault();if(e.which===r.a.space)return t._onToggleClick(e,a),void e.preventDefault();break}n=Object(c.a)(n)}}}},t}return i.__extends(t,e),t.prototype.componentDidMount=function(){var e=Object(l.a)(this._root.current),t=Object(h.e)(this._root.current);this._events.on(e,"keydown, keyup",this._updateModifiers,!0),this._events.on(t,"click",this._tryClearOnEmptyClick),this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(document.body,"touchend",this._onTouchStartCapture,!0)},t.prototype.render=function(){return s.createElement("div",i.__assign({className:"ms-SelectionZone",ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu},{onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus}),this.props.children)},t.prototype._isSelectionDisabled=function(e){for(;e!==this._root.current;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=Object(c.a)(e)}return!1},t.prototype._onToggleAllClick=function(e){var t=this.props.selection;this._getSelectionMode()===_.c.multiple&&(t.toggleAllSelected(),e.stopPropagation(),e.preventDefault())},t.prototype._onToggleClick=function(e,t){var n=this.props.selection,i=this._getSelectionMode();if(n.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&!n.isIndexSelected(t)&&n.setModal&&(n.setModal(!0),this._setIsTouch(!1)),i===_.c.multiple)n.toggleIndexSelected(t);else{if(i!==_.c.single)return void n.setChangeEvents(!0);var s=n.isIndexSelected(t);n.setAllSelected(!1),n.setIndexSelected(t,!s,!0)}n.setChangeEvents(!0),e.stopPropagation()},t.prototype._onInvokeClick=function(e,t){var n=this.props,i=n.selection,s=n.onItemInvoked;s&&(s(i.getItems()[t],t,e.nativeEvent),e.preventDefault(),e.stopPropagation())},t.prototype._onItemSurfaceClick=function(e,t){var n=this.props.selection,i=this._isCtrlPressed||this._isMetaPressed,s=this._getSelectionMode();s===_.c.multiple?this._isShiftPressed&&!this._isTabPressed?n.selectToIndex(t,!i):i?n.toggleIndexSelected(t):this._clearAndSelectIndex(t):s===_.c.single&&this._clearAndSelectIndex(t)},t.prototype._onInvokeMouseDown=function(e,t){this.props.selection.isIndexSelected(t)||this._clearAndSelectIndex(t)},t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)},t.prototype._clearAndSelectIndex=function(e){var t=this.props.selection;1===t.getSelectedCount()&&t.isIndexSelected(e)||(t.setChangeEvents(!1),t.setAllSelected(!1),t.setIndexSelected(e,!0,!0),this.props.enterModalOnTouch&&this._isTouch&&t.setModal&&(t.setModal(!0),this._setIsTouch(!1)),t.setChangeEvents(!0))},t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey,this._isCtrlPressed=e.ctrlKey,this._isMetaPressed=e.metaKey;var t=e.keyCode;this._isTabPressed=!!t&&t===r.a.tab},t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this._root.current;){var n=e.getAttribute("data-selection-index"),i=Number(n);if(null!==n&&i>=0&&i<t.getItems().length)break;e=Object(c.a)(e)}if(e!==this._root.current)return e},t.prototype._getItemIndex=function(e){return Number(e.getAttribute("data-selection-index"))},t.prototype._shouldAutoSelect=function(e){return this._hasAttribute(e,"data-selection-select")},t.prototype._hasAttribute=function(e,t){for(var n=!1;!n&&e!==this._root.current;)n="true"===e.getAttribute(t),e=Object(c.a)(e);return n},t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName},t.prototype._isNonHandledClick=function(e){var t=Object(a.a)();if(t&&e)for(;e&&e!==t.documentElement;){if(Object(u.n)(e))return!1;e=Object(c.a)(e)}return!0},t.prototype._handleNextFocus=function(e){var t=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=e,e&&this._async.setTimeout(function(){t._shouldHandleFocus=!1},100)},t.prototype._setIsTouch=function(e){var t=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,e&&this._async.setTimeout(function(){t._isTouch=!1},300)},t.prototype._getSelectionMode=function(){var e=this.props.selection,t=this.props.selectionMode;return void 0===t?e?e.mode:_.c.none:t},t.defaultProps={isMultiSelectEnabled:!0,isSelectedOnFocus:!0,selectionMode:_.c.multiple},t}(d.a)}}]);
//# sourceMappingURL=owa.3.mail.js.map
window.scriptsLoaded['owa.3.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.3.mail.js'] = (new Date()).getTime();