window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.ConversationAttachment.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[82],{1939:function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return Y});var r=n(2020),o=n(1968),a=n(868);function i(t,e){return{extraSmall:Object(o.a)(t+"_16x16"),small:Object(o.a)(t+"_20x20"),medium:Object(o.a)(t+"_32x32"),large:Object(o.a)(t+"_64x64"),cdn:e?Object(r.a)("generic_16x16"):Object(r.a)(t+"_16x16")}}var c={extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(r.a)("folder_16x16")},s=i("accdb"),u=i("audio"),l=i("calendar"),d=i("code"),p=i("csv"),m=i("xlsx"),h=i("xltx"),f=i("exe"),v=i("generic"),b=i("gdoc",!0),g=i("gform",!0),_=i("gsheet",!0),w=i("gslide",!0),I=i("infopath"),O=i("link"),C=i("email"),j=i("one"),x=i("onetoc"),S=i("pblsh"),y=i("pdf"),A=i("photo"),T=i("pptx"),P=i("potx"),k=i("ppsx"),N=i("project"),M=i("mpt"),E=i("rpmsg"),D=i("txt"),V=i("vector"),R=i("video"),F=i("vsdx"),B=i("vssx"),X=i("vstx"),U=i("docx"),W=i("dotx"),L=i("zip"),q=Object.freeze({".3g2":R,".3gp":R,".aac":u,".accdb":s,".accdc":s,".accde":s,".accdr":s,".accdt":s,".acs":s,".ai":V,".aiff":u,".ape":u,".asf":R,".aspx":d,".asx":R,".avi":R,".bmp":A,".csv":p,".dib":A,".dgn":V,".doc":U,".docm":U,".docx":U,".dot":W,".dotm":U,".dotx":W,".email":C,".emf":V,".eml":C,".eps":V,".exe":f,".flac":u,".flv":R,".gdraw":V,".gif":A,".htm":d,".html":d,".ical":l,".icalendar":l,".ico":A,".ics":l,".indd":V,".indt":V,".jfif":A,".jpe":A,".jpeg":A,".jpg":A,".log":D,".lync":v,".m1v":R,".m4a":u,".mdb":s,".mht":d,".mov":R,".mp2":u,".mp3":u,".mp4":R,".mpa":u,".mpe":R,".mpeg":R,".mpg":R,".mpp":N,".mpt":M,".mpv2":R,".msg":C,".odp":T,".ods":m,".odt":U,".ogg":u,".one":j,".onepkg":x,".onetoc":x,".onetoc2":x,".oxps":V,".pd":V,".pdf":y,".plt":V,".png":A,".pot":T,".potm":T,".potx":P,".ppa":T,".ppam":T,".pps":T,".ppsm":T,".ppsx":k,".ppt":T,".pptm":T,".pptx":T,".pro":V,".ps":V,".psd":A,".pub":S,".rpmsg":E,".rtf":D,".sketch":V,".srt":R,".svg":V,".svgz":V,".swf":R,".tif":A,".tiff":A,".txt":D,".url":O,".vcs":l,".vdx":F,".vob":R,".vsd":F,".vsdx":F,".vsl":F,".vss":F,".vssx":B,".vst":X,".vstx":X,".wav":u,".wm":u,".wma":u,".wmd":R,".wmf":V,".wms":R,".wmv":R,".wmz":R,".wps":U,".wri":U,".xcl":m,".xd":V,".xla":m,".xlam":m,".xls":m,".xlsb":m,".xlsm":m,".xlsx":m,".xlt":m,".xltm":m,".xltx":h,".xml":d,".xps":V,".xsn":I,".zip":L}),K=Object.freeze({"application/vnd.google-apps.document":b,"application/vnd.google-apps.spreadsheet":_,"application/vnd.google-apps.presentation":w,"application/vnd.google-apps.form":g,"application/onenote":j,"application/pdf":y});function Y(t,e,n){if(void 0===e&&(e=!1),e)return c;var r=null,o=Object(a.a)(t);return o&&(r=q[o.toLowerCase()]),!r&&n&&n in K?K[n]:r||v}},1959:function(t,e,n){"use strict";var r=n(0),o=n(1),a=n(1960),i=n(2261),c={},s=function(){function t(t,e,n){var r=this;this.estimatedTimeToCompleteInMS=t,this.updateIntervalInPercent=e,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var t=r.getActionCompletePercent();t<=r.maxPercent?(r.updatePropertyHandler(t),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent,this.updatePropertyHandler=this.updatePropertyHandler.bind(this)}return t.prototype.complete=function(){var t=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout(function(){return t.updatePropertyHandler(1.1)},500)},t.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},t.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},t.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},t}();function u(t,e){var n=c[t.Id];n&&(e?n.complete():n.abort(),delete c[t.Id])}function l(t,e,n,r){var o=new s(t,e,n);c[r.Id]=o,o.start()}var d=n(2166),p=n(2707);Object(o.orchestrator)(i.a,function(t){return r.__awaiter(void 0,void 0,void 0,function(){var e,n;return r.__generator(this,function(r){switch(r.label){case 0:return o=t.attachment,Object(a.a)(o,7,13),[4,Object(p.a)(t.attachment.attachmentId.Id,null,null)];case 1:return e=r.sent(),n=e&&"Success"===e.ResponseClass?14:15,function(t,e,n,r,o){u(t,!0),Object(d.a)(n,o),Object(a.a)(n,r,e)}(t.attachment.attachmentId,n,t.attachment,0,7),[2]}var o})})});var m=n(877),h=n(2423),f=n(2493),v=n.n(f),b=n(2881),g=n.n(b);function _(t,e,n,r,o){var a=function(t,e,n,r,o){return v()({ewsAttachmentId:{RootItemChangeKey:e.ChangeKey,RootItemId:e.Id,Id:t},itemId:t,subscriptionId:n,channelId:r,cancellationId:o})}(t,e,n,r,o);return g()({requestObject:a})}var w=n(12),I=n(825),O=n(2431),C=n(356),j=n(4),x={},S=Object(j.action)("convertClassicToCloudy")(function(t,e,n){return r.__awaiter(this,void 0,void 0,function(){var o,i,c;return r.__generator(this,function(r){switch(r.label){case 0:return o=new w.a("AttachmentConvertClassicToCloudy"),function(t){Object(a.a)(t,5,8)}(t),i=function(e){if(A(t,e.ResultCode),T(o,t.attachmentId,e.ResultCode,e.Exception),0===e.ResultCode&&e.Response&&e.Response.ResponseMessages&&e.Response.ResponseMessages.Items&&e.Response.ResponseMessages.Items.length>0&&"NoError"===e.Response.ResponseMessages.Items[0].ResponseCode){var r=e.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(e){A(t,1),n(!1,null),T(o,t.attachmentId,1,e)},[4,y(t.attachmentId,e,i,c)];case 1:return r.sent(),[2]}})})});function y(t,e,n,o){return r.__awaiter(this,void 0,void 0,function(){var a,i,c,s,u,l;return r.__generator(this,function(d){switch(d.label){case 0:return[4,Object(O.a)(n)];case 1:a=r.__read.apply(void 0,[d.sent(),4]),i=a[0],c=a[1],s=a[2],u=a[3],x[t.Id]=i,d.label=2;case 2:return d.trys.push([2,4,,5]),[4,_(t.Id,e,i,u,i)];case 3:return d.sent(),[3,5];case 4:return l=d.sent(),o(l.message),C.g.importAndExecute(c,s),[3,5];case 5:return[2]}})})}function A(t,e){switch(e){case 0:break;case 11:Object(a.a)(t,0,0);break;default:Object(a.a)(t,0,9)}delete x[t.attachmentId.Id]}function T(t,e,n,r){var o=Object(I.a)(e);t.addCustomData([o.model.Size,n]),0===n||11===n?t.end():t.endWithError("ServerError",new Error(r))}var P={name:"CancelConvertClassicToCloudy"},k={name:"CancelConvertCloudyToClassic"},N=n(2494),M=n.n(N),E=n(2882),D=n.n(E);function V(t){var e=function(t){return M()({cancellationId:t})}(t);return D()(e)}var R=n(30),F=Object(R.b)("cancelConvertClassicToCloudy",P)(function(t){var e,n=(e=t.attachmentId.Id,x[e]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(a.a)(t,5,10),V(n)}),B=n(2349),X=Object(j.action)("updateIsViewingInProviderSupported")(function(t,e){t.strategy.isViewingInProviderSupported=e}),U=n(2605),W=n(2716),L=Object(j.action)("saveToCloud")(function(t,e){return r.__awaiter(this,void 0,void 0,function(){var n,o,a;return r.__generator(this,function(r){switch(r.label){case 0:return n=new w.a("AttachmentSaveToCloud"),K(t),o=function(r){var o=0===r.ResultCode;return Y(t,o,o?r.Item.Location:null),e(o),q(n,t.attachmentId,r.ResultCode,"ServerError",r.Exception),!0},a=function(r,o,a){Y(t,!1,null),e(!1),q(n,t.attachmentId,o,a,r)},[4,Object(U.b)(t.attachmentId,null,o,a)];case 1:return r.sent(),[2]}})})});function q(t,e,n,r,o){var a=Object(I.a)(e);t.addCustomData([a.model.Size,n]),0===n?t.end():t.endWithError(r,new Error(o))}function K(t){Object(a.a)(t,2,1)}function Y(t,e,n){if(e){Object(d.a)(t,2),Object(W.a)(t.attachmentId,n);var r=Object(B.b)(!1,n);X(t,r)}Object(a.a)(t,0,e?3:4)}var z=Object(j.action)("setActionCompletePercent")(function(t,e){t.actionCompletePercent=e}),H=n(2299),Z=n(2170),G=(n(2113),n(2047)),J=n(2165),Q=n(2171),$=n(870),tt=n(2259),et=n(2357),nt=n(2563),rt=n(1953),ot=Object(j.action)("updateAttachment")(function(t,e,n,o,a){Object(et.a)(t.attachmentId);var i=r.__assign({},o.AttachmentId,{mailboxInfo:e.mailboxInfo});if(n.AttachmentId=i,o.Name&&(n.Name=o.Name),o.Size&&(n.Size=o.Size),o.ContentType&&(n.ContentType=o.ContentType),o.__type&&(n.__type=o.__type),n.IsInline&&(n.ContentId=o.ContentId),Object(rt.b)(o)){var c=n;c.AttachLongPathName=o.AttachLongPathName,c.PermissionType=o.PermissionType,c.ProviderType=o.ProviderType,c.AttachmentThumbnailUrl=o.AttachmentThumbnailUrl,c.AttachmentPreviewUrl=o.AttachmentPreviewUrl}if(Object(tt.a)([{attachmentId:i,attachment:n,permissionInfo:a}],!1),t.attachmentId=i,Object(Q.a)(t))Object(Z.a)(t,1);else{Object($.g)(t,!1),setTimeout(function(){z(t,1.1)},500),Object(J.a)(t,0);var s=Object(I.a)(i);Object(G.a)(t,s,t.strategy.supportedMenuActions),s.download.url||Object(nt.a)(i,t.isReadOnly,!0)}}),at=n(2495),it=n.n(at),ct=n(2883),st=n.n(ct);function ut(t,e,n,r,o,a,i,c){var s=function(t,e,n,r,o,a,i,c){return it()({ewsAttachmentId:t,emailId:e,subscriptionId:n,channelId:r,cancellationId:o,fullPathLocation:a,attachmentDataProviderId:c,PermissionLevel:i})}(t,e,n,r,o,a,i,c);return st()({requestObject:s})}function lt(t){return ft(Object(I.a)(t).model.Size)}function dt(t){return 2856+.00145*t}function pt(t){return 4*ft(t)}function mt(t){return 4*ft(t)}function ht(t){return 2*ft(t)}function ft(t){return Math.round(t/256)}var vt=n(2496),bt=n.n(vt),gt={},_t=Object(o.action)("convertCloudyToClassic",function(t,e,n,r,o,a){return{attachment:t,parentItemId:e,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:o,source:a}}),wt=_t;function It(t,e,n,o,a,i){return r.__awaiter(this,void 0,void 0,function(){var c,s,u,l,d,p;return r.__generator(this,function(m){switch(m.label){case 0:return[4,Object(O.a)(a)];case 1:c=r.__read.apply(void 0,[m.sent(),4]),s=c[0],u=c[1],l=c[2],d=c[3],gt[t.Id]=s,m.label=2;case 2:return m.trys.push([2,4,,5]),[4,ut(t.Id,e,s,d,s,n,o)];case 3:return m.sent(),[3,5];case 4:return p=m.sent(),i(p.message),C.g.importAndExecute(u,l),[3,5];case 5:return[2]}})})}function Ot(t,e){switch(e){case 0:break;case 11:Object(a.a)(t,0,0);break;default:Object(a.a)(t,0,12)}delete gt[t.attachmentId.Id]}function Ct(t,e,n,r,o){var a=Object(I.a)(e);t.addCustomData([a.model.Size,n,a.model.AttachmentId&&a.model.AttachmentId.Id,o]),0===n||11===n?t.end():t.endWithError("ServerError",new Error(r))}Object(o.orchestrator)(_t,function(t){var e=t.attachment;!function(t,e,n,o,i,c){r.__awaiter(this,void 0,void 0,function(){var s,u,l;return r.__generator(this,function(r){switch(r.label){case 0:return s=new w.a("AttachmentConvertCloudyToClassic"),function(t){Object(a.a)(t,6,11)}(t),u=function(e){if(Ot(t,e.ResultCode),Ct(s,t.attachmentId,e.ResultCode,e.Exception,c),0===e.ResultCode){var n=bt()({Name:e.Item.Name,Size:e.Item.Size,AttachmentId:e.NewAttachmentId});i(!0,n)}else i(!1,null);return!0},l=function(e){Ot(t,1),i(!1,null),Ct(s,t.attachmentId,1,e,c)},[4,It(t.attachmentId,e,n,o,u,l)];case 1:return r.sent(),[2]}})})}(e,t.parentItemId,t.fullPathLocation,t.permissionLevel,function(n,r){n?t.replaceAttachmentHandler(e,r,!1,!0):u(e.attachmentId,n)},t.source),l(lt(e.attachmentId),.1,function(t){z(e,t)},e.attachmentId)});var jt=n(2497),xt=n.n(jt),St=n(2884),yt=n.n(St);function At(t){var e=function(t){return xt()({cancellationId:t})}(t);return yt()(e)}var Tt,Pt=Object(o.action)("cancel_ConvertCloudyToClassic",function(t){return Object(R.a)(k,{attachmentViewState:t})}),kt=Pt;Object(o.orchestrator)(Pt,function(t){var e,n=(e=t.attachmentViewState.attachmentId.Id,gt[e]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(a.a)(t.attachmentViewState,6,10),At(n)}),function(t){t[t.contextMenu=0]="contextMenu",t[t.sharingTip=1]="sharingTip"}(Tt||(Tt={}));var Nt=n(827),Mt=n(2039),Et=n(218);function Dt(t){return r.__awaiter(this,void 0,void 0,function(){var e=this;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Mt.f.import()];case 1:return n.sent()(t.model.AttachLongPathName).then(function(n){return r.__awaiter(e,void 0,void 0,function(){var e,o;return r.__generator(this,function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(e=Object(Nt.e)(t.model,!0),[4,Et.h.importAndExecute(e,t.attachmentClass,t.model,!0,t.model.ProviderType,n)]);case 1:return o=r.sent(),Et.l.importAndExecute(t.id,o),Object(Et.n)(t.id),[2]}})})}),[2]}})})}var Vt=n(2238);function Rt(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=0),{attachmentType:1,attachmentId:t,isInline:!0,isHiddenInline:n,placeholderId:e,status:r}}function Ft(t){return!!t.strategy.isSaveToCloudSupported&&-1===t.completedActions.indexOf(2)}n.d(e,"g",function(){return h.a}),n.d(e,"b",function(){return F}),n.d(e,"d",function(){return S}),n.d(e,"s",function(){return L}),n.d(e,"u",function(){return K}),n.d(e,"t",function(){return Y}),n.d(e,"v",function(){return z}),n.d(e,"w",function(){return H.a}),n.d(e,"x",function(){return Z.a}),n.d(e,"y",function(){return a.a}),n.d(e,"B",function(){return ot}),n.d(e,"p",function(){return G.a}),n.d(e,"m",function(){return G.b}),n.d(e,"c",function(){return kt}),n.d(e,"e",function(){return wt}),n.d(e,"l",function(){return Dt}),n.d(e,"z",function(){return l}),n.d(e,"A",function(){return u}),n.d(e,"j",function(){return dt}),n.d(e,"k",function(){return mt}),n.d(e,"o",function(){return pt}),n.d(e,"i",function(){return ht}),n.d(e,"f",function(){return Vt.a}),n.d(e,"h",function(){return Rt}),n.d(e,"n",function(){return lt}),n.d(e,"r",function(){return Ft}),n.d(e,"q",function(){return Q.a}),n.d(e,"a",function(){return m.a})},1960:function(t,e,n){"use strict";var r=n(2165),o=n(2113),a=n(2388),i=n(4);e.a=Object(i.action)("setOngoingActionAndActionMessage")(function(t,e,n){Object(r.a)(t,e),t.actionMessage=n,Object(a.a)(t)?Object(o.a)(t,!0):Object(o.a)(t,!1)})},1968:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(2367),o="fileType-icon";function a(t){return r[function(t){return o+"-"+t}(t)]}},1983:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},t)}},2010:function(t,e,n){var r=n(1240);t.exports=function(t,e){var n=r(t).getTime(),o=Number(e);return new Date(n+o)}},2011:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(1939),o=n(2020),a=Object(r.b)("calendar"),i=Object(r.b)("generic"),c=Object(r.b)("email"),s=Object(r.b)("sharedfolder"),u={extraSmall:Object(r.b)("generic").extraSmall,small:Object(r.b)("generic").small,medium:Object(r.b)("blockedfile").medium,large:Object(r.b)("generic").large,cdn:Object(o.a)("generic_16x16")};function l(t,e,n,o,l){if(n)return u;switch(l){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":return c;case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return a}return o?s:Object(r.a)(t,!1,e)||i}},2020:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(20),o="https://r{0}.res.outlook.com/owa/prem/images/{1}.png",a=1;function i(t){return Object(r.format)(o,a++%4+1,t)}},2047:function(t,e,n){"use strict";var r=n(2349),o=n(2166),a=n(1960),i=n(20);var c=n(877),s=n(1953),u=n(827),l=n(218),d=n(4);n.d(e,"b",function(){return m});var p=null;function m(){return p||(p=Object.keys(c.a).reduce(function(t,e){var n=c.a[e];return Number.isInteger(n)&&t.push(n),t},[])),p}e.a=Object(d.action)("initializeAttachmentFullViewState")(function(t,e,n){var d;n&&0!==n.length||(d=e.model,n=Object(l.e)(d)?function(t){return 2===Object(l.c)(t)?[c.a.Preview,c.a.Download]:[c.a.Download]}(d):m());var p=Object(u.e)(e.model,!0),h=Object(u.j)(),f=Object(s.a)(e),v=Object(r.a)(h,p,e.attachmentClass,e.model,f?e.model.ProviderType:null,e.model.AttachmentOriginalUrl,e.info.allowDownload,n,t.isReadOnly);t.strategy=v,function(t,e,n){n&&!Object(i.isStringNullOrWhiteSpace)(e.model.AttachmentOriginalUrl)&&(Object(o.a)(t,2),Object(a.a)(t,0,2))}(t,e,t.strategy.isSaveToCloudSupported)})},2059:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51);e.default=function(t,e){return r.makeServiceRequest("GetWacAttachmentInfo",t,e)}},2062:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(1968);n.d(e,"c",function(){return r.a});var o=n(2011);n.d(e,"d",function(){return o.a});var a=n(1939);n.d(e,"e",function(){return a.a}),n.d(e,"b",function(){return a.b});var i=n(2),c=new i.c(function(){return n.e(102).then(n.bind(null,2556))}),s=Object(i.d)(c,function(t){return t.CloudIconWithOverlay})},2068:function(t,e,n){"use strict";var r=n(1314);function o(t){window.open(t,"_blank")}function a(t,e,n,r){if(e)o(t);else{var a=document.createElement("a");a.style.display="none",a.href=t,a.download=r||"",n||(n=document.activeElement&&document.activeElement.parentElement||document.body),n.appendChild(a),a.click(),n.removeChild(a)}}function i(t,e){a(Object(r.b)(t,e,0,!1,!1,!0),!1)}var c=n(0),s=n(868),u=n(2169),l=n(1953),d=n(2176);function p(t,e){return c.__awaiter(this,void 0,void 0,function(){var n,o;return c.__generator(this,function(a){switch(a.label){case 0:return".pdf"!==Object(s.a)(e.Name).toLowerCase()?[3,1]:(n=Object(r.b)(t,e,3,!1,!1),window.open(n,"_blank"),[3,3]);case 1:return Object(s.c)(e.Name)?[4,Object(u.a)(t,e,Object(l.b)(e))]:[3,3];case 2:o=a.sent(),d.a.importAndExecute(function(t){var e=document.createElement("div"),n=document.createElement("img");return n.src=t,e.appendChild(n),e.innerHTML}(o),"img {max-width: 100%; max-height: 100%; width: auto;  }"),a.label=3;case 3:return[2]}})})}var m=n(2168),h=n(2167),f=n(827);function v(t){var e=Object(f.e)(t,!0),n=Object(s.a)(t.Name);return Object(h.a)(e,t,n)}function b(t){var e=Object(s.a)(t.Name);return v(t)&&e&&(".pdf"===e.toLowerCase()&&Object(m.a)()||Object(s.c)(t.Name))}n.d(e,"a",function(){return i}),n.d(e,"f",function(){return p}),n.d(e,"d",function(){return b}),n.d(e,"c",function(){return v}),n.d(e,"b",function(){return a}),n.d(e,"e",function(){return o})},2090:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51),o=n(1983);e.default=function(t,e){return void 0===t||t.__type||(t=o.default(t)),r.makeServiceRequest("GetAccessTokenforDataProvider",t,e)}},2091:function(t,e,n){var r=n(2010),o=6e4;t.exports=function(t,e){var n=Number(e);return r(t,n*o)}},2113:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.action)("setShouldShowImageOverlay")(function(t,e){t.shouldShowImageOverlay=e})},2165:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.action)("setOngoingAction")(function(t,e){t.ongoingAction=e})},2166:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.action)("addCompletedAction")(function(t,e){t.completedActions.push(e)})},2170:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.action)("setInlineAttachmentStatus")(function(t,e){t.status=e})},2171:function(t,e,n){"use strict";function r(t){return 1===t.attachmentType}n.d(e,"a",function(){return r})},2176:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(2),o=new r.c(function(){return n.e(205).then(n.bind(null,2708))}),a=new r.a(o,function(t){return t.print})},2203:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0),o=n(3),a=n(237),i=Object(a.a)(),c=.01,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._onRenderProgress=function(t){var n=e.props,r=n.ariaValueText,a=n.barHeight,s=n.className,u=n.styles,l=n.theme,d="number"==typeof e.props.percentComplete?Math.min(100,Math.max(0,100*e.props.percentComplete)):void 0,p=i(u,{theme:l,className:s,barHeight:a,indeterminate:void 0===d}),m={width:void 0!==d?d+"%":void 0,transition:void 0!==d&&d<c?"none":void 0},h=void 0!==d?0:void 0,f=void 0!==d?100:void 0,v=void 0!==d?Math.floor(d):void 0;return o.createElement("div",{className:p.itemProgress},o.createElement("div",{className:p.progressTrack}),o.createElement("div",{className:p.progressBar,style:m,role:"progressbar","aria-valuemin":h,"aria-valuemax":f,"aria-valuenow":v,"aria-valuetext":r}))},e}return r.__extends(e,t),e.prototype.render=function(){var t=this.props,e=t.barHeight,n=t.className,a=t.label,c=void 0===a?this.props.title:a,s=t.description,u=t.styles,l=t.theme,d=t.progressHidden,p=t.onRenderProgress,m=void 0===p?this._onRenderProgress:p,h="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,f=i(u,{theme:l,className:n,barHeight:e,indeterminate:void 0===h});return o.createElement("div",{className:f.root},c?o.createElement("div",{className:f.itemName},c):null,d?null:m(r.__assign({},this.props,{percentComplete:h}),this._onRenderProgress),s?o.createElement("div",{className:f.itemDescription},s):null)},e.defaultProps={label:"",description:"",width:180},e}(o.Component)},2238:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(0),o=n(870);function a(t,e,n,a,i,c){void 0===i&&(i=!1),void 0===c&&(c=null);var s=Object(o.c)(t,e,a,i,c),u=s.strategy;return r.__assign({},s,{attachmentType:0,strategy:r.__assign({},u,{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},2261:function(t,e,n){"use strict";var r=n(1),o=n(30),a=Object(r.action)("addCalendarEventsAttachment",function(t,e){return Object(o.a)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:e}},{attachment:t})});e.a=a},2279:function(t,e,n){"use strict";var r=n(0),o=n(218),a=n(825),i=n(2068),c=n(279);function s(t,e,n){return r.__awaiter(this,void 0,void 0,function(){var s,u;return r.__generator(this,function(r){switch(r.label){case 0:return(s=Object(a.a)(t))?Object(o.e)(s.model)?[4,c.f.import()]:[3,2]:[2];case 1:return r.sent()(s.model),[3,3];case 2:(u=s.download.url)&&Object(i.b)(u,e,n),r.label=3;case 3:return[2]}})})}var u=n(2),l=n(57);n.d(e,"c",function(){return p}),n.d(e,"d",function(){return m}),n.d(e,"a",function(){return l.h}),n.d(e,"b",function(){return s});var d=new u.c(function(){return Promise.all([n.e(2),n.e(3),n.e(8),n.e(9),n.e(66)]).then(n.bind(null,7131))}),p=new u.a(d,function(t){return t.clickAttachment}).importAndExecute,m=new u.a(d,function(t){return t.previewAttachment})},2299:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.action)("setAttachmentShouldShowContextMenu")(function(t,e){t.shouldShowContextMenu=e})},2344:function(t,e,n){"use strict";function r(t,e){return-1!==e.strategy.supportedMenuActions.indexOf(t)}n.d(e,"a",function(){return r})},2349:function(t,e,n){"use strict";var r=n(0),o=n(827),a=n(877),i=n(129),c=n(870);function s(t){switch(t){case a.a.Download:return c.a.Download;case a.a.OpenInNewTab:return c.a.OpenInNewTab;case a.a.Preview:return c.a.Preview;case a.a.ImportCalendarEventAttachment:case a.a.ChangePermissions:case a.a.CopyLink:case a.a.SaveToCloud:case a.a.ViewInProvider:case a.a.ConvertClassicToCloudy:case a.a.ConvertCloudyToClassic:case a.a.MoveAttachmentToInline:case a.a.RefreshLink:case a.a.IgnoreExpiration:return null;default:return Object(i.a)(t)}}function u(t){switch(t){case c.a.Download:return a.a.Download;case c.a.OpenInNewTab:return a.a.OpenInNewTab;case c.a.Preview:return a.a.Preview;case c.a.NoAction:return null;default:return Object(i.a)(t)}}var l=n(2102),d=n(47);var p=Object(l.a)(function(t){switch(t){case 0:return e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},r.__assign({},e,{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return r.__assign({},t,{supportConvertCloudyToClassic:Object(d.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(i.a)(t)}var e}),m=p.getDataProviderInfo,h=p.getDefaultDataProviderInfo,f=m;var v=n(218),b=n(20);function g(t,e,n,a,i,l,d,p,m){var h=Object(c.d)(e,n,a);!function(t,e){var n=function(t,e,n){void 0===n&&(n=!1);var r=t.filter(function(t){return-1!==e.indexOf(t)});return n&&(r=r.filter(function(t,e,n){return n.indexOf(t)===e})),r}(t.supportedOpenActions.map(u).filter(function(t){return!!t}),e);t.supportedOpenActions=n.map(s)}(h,p);var b,g=function(t){return t.__type===v.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(a),w=Object(o.i)(a,g,m),I=function(t,e){return t}(g),O=_(g,l),C=function(t,e,n){return t.convertClassicToCloudyEnabled&&!e&&!n}(t,g,m),j=function(t,e,n,r,o){if(t.convertCloudyToClassicEnabled&&e&&!n&&r){var a=f(o);return a&&a.supportConvertCloudyToClassic||!1}return!1}(t,g,m,d,i),x=function(t,e,n){return 2===t&&!e&&!n}(n,g,m);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:b=function(t,e,n,o,a,i,c,s){return r.__assign({},t,{isSaveToCloudSupported:e,isOpeningByLinkSupported:n,isOpeningInProviderSupported:o,isViewingInProviderSupported:a,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:s,showActionsMenu:!0,supportedMenuActions:[]})}(h,w,g,I,O,C,j,x);break;case 1:b=function(t){return r.__assign({},t,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(h);break;default:b=g?function(t,e,n,o){return r.__assign({},t,{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:e,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:o,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(h,I,O,j):function(t,e,n,o){return r.__assign({},t,{isSaveToCloudSupported:e,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:o,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(h,w,O,C)}return b.supportedMenuActions=p,b}function _(t,e){if(t)return!1;var n=Object(d.a)(),r=h(n);return!Object(b.isStringNullOrWhiteSpace)(e)&&(n||r&&r.supportViewInProvider)}n.d(e,"a",function(){return g}),n.d(e,"b",function(){return _})},2356:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"SaveAttachmentsToCloudRequest:#Exchange"},t)}},2357:function(t,e,n){"use strict";var r=n(727),o=n(4);e.a=Object(o.action)("deleteAttachment")(function(t){Object(r.a)().attachments.delete(t.Id)})},2388:function(t,e,n){"use strict";function r(t){return 0!==t.actionMessage}n.d(e,"a",function(){return r})},2423:function(t,e,n){"use strict";var r=n(2047),o=n(0),a=n(103),i=n(121);var c=n(2389);function s(t){return o.__awaiter(this,void 0,void 0,function(){var e;return o.__generator(this,function(n){switch(n.label){case 0:return t.strategy.previewMethod!==i.a.Wac?[3,2]:[4,Object(c.a)(t.attachmentId,!1)];case 1:9!==(e=n.sent()).Status&&6!==e.Status||(r=t.strategy).previewMethod===i.a.Wac&&(r.previewMethod=i.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter(function(t){return t!==a.a.Preview})),n.label=2;case 2:return[2]}var r})})}var u=n(2238),l=n(2259),d=n(825);function p(t,e,n,o,a,i,c,p){void 0===i&&(i=null),void 0===p&&(p=!1),Object(l.a)([{attachmentId:t,attachment:e}],n,a);var m=Object(d.a)(t),h=Object(u.a)(t,n,o,1===m.type,!1,i);return Object(r.a)(h,m,c),p&&s(h),h}n.d(e,"a",function(){return p})},2433:function(t,e,n){"use strict";var r=n(0),o=n(825),a=n(276),i=n(2089),c=n(1953),s=n(1314),u=n(4);e.a=Object(u.action)("refreshThumbnailImageUrl")(function(t,e,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){var u,l;return r.__generator(this,function(r){switch(r.label){case 0:if(u=Object(o.a)(t),!Object(c.b)(u.model))return[3,7];switch(u.model.ProviderType){case a.f:return[3,1]}return[3,5];case 1:return r.trys.push([1,3,,4]),[4,Object(i.a)(u.model)];case 2:return l=r.sent(),u.thumbnailImage.url=l,[3,4];case 3:return r.sent(),u.thumbnailImage.url=null,[3,4];case 4:case 5:return[3,6];case 6:return[3,8];case 7:l=Object(s.b)(t,u.model,2,Object(c.b)(u.model),e,n),u.thumbnailImage.url=l,r.label=8;case 8:return[2]}})})})},2471:function(t,e,n){"use strict";var r=n(859),o=n(2203),a=n(18),i=n(344),c={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},s=Object(a.keyframes)({"0%":{left:"-30%"},"100%":{left:"100%"}}),u=Object(a.keyframes)({"100%":{right:"-30%"},"0%":{right:"100%"}});n.d(e,"a",function(){return l});var l=Object(r.a)(o.a,function(t){var e,n,r=Object(i.a)(),o=t.className,l=t.indeterminate,d=t.theme,p=t.barHeight,m=void 0===p?2:p,h=d.palette,f=d.semanticColors,v=Object(a.getGlobalClassNames)(c,d),b=h.neutralLight;return{root:[v.root,d.fonts.medium,{fontWeight:a.FontWeights.regular},o],itemName:[v.itemName,a.noWrap,{color:f.bodyText,fontSize:a.FontSizes.medium,paddingTop:4,lineHeight:20}],itemDescription:[v.itemDescription,{color:f.bodySubtext,fontSize:a.FontSizes.xSmall,lineHeight:18}],itemProgress:[v.itemProgress,{position:"relative",overflow:"hidden",height:m,padding:"8px 0"}],progressTrack:[v.progressTrack,{position:"absolute",width:"100%",height:m,backgroundColor:b,selectors:(e={},e[a.HighContrastSelector]={borderBottom:"1px solid WindowText"},e)}],progressBar:[{backgroundColor:h.themePrimary,height:m,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[a.HighContrastSelector]={backgroundColor:"WindowText"},n)},l?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+b+" 0%, "+h.themePrimary+" 50%, "+b+" 100%)",animation:(r?u:s)+" 3s infinite"}:{transition:"width .15s linear"},v.progressBar]}},void 0,{scope:"ProgressIndicator"})},2493:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},t)}},2494:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},t)}},2495:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},t)}},2496:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"FileAttachment:#Exchange"},t)}},2497:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},t)}},2614:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51),o=n(2615);e.default=function(t,e){return void 0===t||t.__type||(t=o.default(t)),r.makeServiceRequest("ImportCalendarEvent",t,e)}},2615:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"ImportCalendarEventJsonRequest:#Exchange"},t)}},2616:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"ImportCalendarEventRequest:#Exchange"},t)}},2707:function(t,e,n){"use strict";var r=n(0),o=n(65),a=n.n(o),i=n(2614),c=n.n(i),s=n(2616),u=n.n(s),l=n(170),d=n.n(l),p=n(31);function m(t,e,n){return c()({Header:Object(p.getJsonRequestHeader)(),Body:u()({Content:t,ImportedItemFolderId:d()({BaseFolderId:a()({Id:e})}),AttachmentId:n})},{datapoint:{jsonCustomData:function(t){return{status:t.ResponseClass,numberOfEventsImported:t.NumberOfEventsImported}}}}).then(function(t){if(null!=t&&null!=t.Body)return t.Body;throw new Error("[importCalendarOperation failed]")})}function h(t,e,n){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,m(e,n,t)];case 1:return[2,r.sent()];case 2:return r.sent(),[2,null];case 3:return[2]}})})}n.d(e,"a",function(){return h})},2715:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51),o=n(2356);e.default=function(t,e){return void 0===t.requestObject||t.requestObject.__type||(t.requestObject=o.default(t.requestObject)),r.makeServiceRequest("SaveAttachmentsToCloud",t,e)}},2881:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51),o=n(2493);e.default=function(t,e){return void 0===t.requestObject||t.requestObject.__type||(t.requestObject=o.default(t.requestObject)),r.makeServiceRequest("ConvertLocalToRefAttachment",t,e)}},2882:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51),o=n(2494);e.default=function(t,e){return void 0===t||t.__type||(t=o.default(t)),r.makeServiceRequest("CancelConvertLocalToRefAttachment",t,e)}},2883:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51),o=n(2495);e.default=function(t,e){return void 0===t.requestObject||t.requestObject.__type||(t.requestObject=o.default(t.requestObject)),r.makeServiceRequest("ConvertRefToLocalAttachment",t,e)}},2884:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(51),o=n(2497);e.default=function(t,e){return void 0===t||t.__type||(t=o.default(t)),r.makeServiceRequest("CancelConvertRefToLocalAttachment",t,e)}},2979:function(t,e,n){"use strict";n.d(e,"c",function(){return a}),n.d(e,"b",function(){return i}),n.d(e,"a",function(){return c});var r=n(2),o=new r.c(function(){return Promise.all([n.e(2),n.e(3),n.e(8),n.e(9),n.e(66)]).then(n.bind(null,4296))}),a=Object(r.d)(o,function(t){return t.AttachmentThumbnailView}),i=Object(r.d)(o,function(t){return t.AttachmentIconView}),c=Object(r.d)(o,function(t){return t.AttachmentDocInfoView})},3154:function(t,e,n){"use strict";var r=n(0),o=n(3185),a=n(2344),i=n(17),c=n(728),s=n(98),u=n(12),l=n(3658),d=n(218),p=n(825),m=n(2068),h=n(57),f=n(279),v=n(8),b=n.n(v),g=n(11),_=n(3),w=n(1959),I=n(275),O=n(4212),C=function(t){function e(e){var n=t.call(this,e)||this;return n.keyDown=function(t){t.keyCode!==s.a.enter&&t.keyCode!==s.a.space||(g.c.info("AttachmentDownloadButton.keyDown enter|space"),t.stopPropagation(),n.downloadAttachment())},n.handleOnFocus=function(){Object(o.b)(n.props.attachmentViewState,n.props.isForImageView)},n.handleOnBlur=function(){Object(o.a)(n.props.attachmentViewState,n.props.isForImageView)},n.downloadAttachment=function(){return r.__awaiter(n,void 0,void 0,function(){var t;return r.__generator(this,function(e){switch(e.label){case 0:return(t=Object(p.a)(this.props.attachmentViewState.attachmentId))?(Object(u.k)("AttachmentSurfaceActionDownload",[this.props.attachmentViewState.isCloudy]),Object(d.e)(t.model)?[4,f.f.import()]:[3,2]):(g.c.error("AttachmentDownloadButton.downloadAttachment attachmentModel is null"),[2]);case 1:return e.sent()(t.model),[3,3];case 2:Object(m.b)(t.download.url,this.props.attachmentViewState.isCloudy,document.body),e.label=3;case 3:return[2]}})})},n.onClickDownloadButton=n.onClickDownloadButton.bind(n),n}return r.__extends(e,t),e.prototype.render=function(){if(this.getShouldHideDownloadButton())return null;var t=void 0,e=this.getAttachmentStyle(this.props.previewState);return t=this.props.isForImageView?I([O.downloadButton,O.downloadButtonForImageView,this.props.customClassName]):this.props.attachmentViewState.isReadOnly?I([O.downloadButton,e,this.props.customClassName]):I([O.downloadButton,e,O.downloadButtonForDocViewInCompose,this.props.customClassName]),_.createElement(c.IconButton,{onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onKeyDown:this.keyDown,ariaLabel:b.a.downloadText,title:b.a.downloadText,onClick:this.onClickDownloadButton,className:t,iconProps:{iconName:"Download",styles:{root:O.icon}}})},e.prototype.onClickDownloadButton=function(t){g.c.info("AttachmentDownloadButton.onclick"),t.stopPropagation(),this.downloadAttachment()},e.prototype.getShouldHideDownloadButton=function(){var t=this.props.attachmentViewState;return!Object(a.a)(w.a.Download,t)||!Object(l.a)(t)||0!==t.ongoingAction||!this.props.attachmentViewState.strategy.showActionsMenu},e.prototype.getAttachmentStyle=function(t){switch(t){case h.a.Edit:return O.edit;case h.a.NotSelectedAndSaving:return O.notSelectedAndSaving;case h.a.OtherSaving:return O.attachmentView;case h.a.Selected:return O.selected;case h.a.SelectedAndPending:return O.selectedAndPending;case h.a.SelectedAndSaving:return O.selectedAndSaving;default:return O.default}},e=r.__decorate([i.observer],e)}(_.Component);e.a=C},3155:function(t,e,n){"use strict";e.a={OnClick:{name:"AttachmentOnClick",customData:function(t){return[t]}}}},3185:function(t,e,n){"use strict";var r=n(4),o=Object(r.action)("setShouldShowActionsContainer")(function(t,e){t.shouldShowActionsContainer=e}),a=n(2113),i=n(2388);n.d(e,"b",function(){return u}),n.d(e,"a",function(){return l}),n.d(e,"c",function(){return d}),n.d(e,"d",function(){return p});var c={},s=null;function u(t,e){c[t.attachmentId.Id]&&(clearTimeout(c[t.attachmentId.Id]),c[t.attachmentId.Id]=null),s=t.attachmentId.Id,o(t,!0),e&&!Object(i.a)(t)&&Object(a.a)(t,!0)}function l(t,e){c[t.attachmentId.Id]&&clearTimeout(c[t.attachmentId.Id]),c[t.attachmentId.Id]=setTimeout(function(){o(t,!1),e&&!Object(i.a)(t)&&Object(a.a)(t,!1),t.attachmentId.Id===s&&(s=null),c[t.attachmentId.Id]=null},40)}function d(t,e){o(t,!0),e&&!Object(i.a)(t)&&Object(a.a)(t,!0)}function p(t,e){t.attachmentId.Id!==s&&(o(t,!1),e&&!Object(i.a)(t)&&Object(a.a)(t,!1))}},3528:function(t,e,n){"use strict";function r(t,e){var n,r,o=(n=t,null!=(r=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$","i").exec(n))&&r.length>1?r[1].toLowerCase():null);return null!=o?o:e}var o=n(3672),a=n(868),i=n(20),c=n(11);function s(t,e){var n=e.model.Name;if(t.isCloudy){var r=e;if(r.openUrl)n+="\n \n"+r.openUrl;else{var o=e.model;o.AttachLongPathName&&(n+="\n \n"+o.AttachLongPathName)}}return n}function u(t,e){if(t.isCloudy){var n=e.model;if(t.isReadOnly)return{text:r(e.openUrl,n.AttachLongPathName||null),title:null};var s=e.info&&e.info.sharingInfo&&e.info.sharingInfo.expirationDate,u=Object(o.a)(n.PermissionType,n.ProviderType,s,t.isPlaceholderAttachment);return{text:u,title:u}}var l=e.model.Size>0?Object(a.e)(e.model.Size):null;return isNaN(e.model.Size)&&c.c.error(Object(i.format)("Size for Attachment {0} is not a Number.",e.model.AttachmentId)),{text:l,title:l}}n.d(e,"a",function(){return s}),n.d(e,"b",function(){return u})},3657:function(t,e,n){"use strict";n.d(e,"b",function(){return c}),n.d(e,"d",function(){return s});var r=n(3154);n.d(e,"a",function(){return r.a});var o=n(2),a=n(3155);n.d(e,"c",function(){return a.a});var i=new o.c(function(){return Promise.all([n.e(2),n.e(3),n.e(8),n.e(9),n.e(66)]).then(n.bind(null,4757))}),c=Object(o.d)(i,function(t){return t.AttachmentView}),s=new o.b(i,function(t){return t.getContextMenus})},3658:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(218),o=n(825);function a(t){var e=Object(o.a)(t.attachmentId);return!!e&&(!!Object(r.e)(e.model)||e.download.url&&e.info&&e.info.allowDownload)}},3672:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(20),o=n(2111),a=n(5),i=n(475),c=n(397),s=n(8),u=n.n(s);function l(t,e,n,s){return void 0===n&&(n=null),void 0===s&&(s=!1),null==t||s?null:Object(a.d)("doc-attachment-expiringLinkImprovements")&&n&&Object(i.a)(n,Object(c.a)())?Object(r.format)(u.a.AttachPerms_ExpiredLink,n):Object(o.d)(t,e)}},4212:function(t,e,n){var r=n(4213),o=n(55);"string"==typeof r&&(r=[[t.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(t.exports=r.locals)},4213:function(t,e,n){(e=t.exports=n(54)(!1)).push([t.i,'._2IvXEPgK9k8K8VDRMWnU7D{font-size:14px;color:"[theme:neutralSecondary, default:#666666]";height:26px;width:26px}html[dir] ._2IvXEPgK9k8K8VDRMWnU7D{padding:4px;text-align:center}._2IvXEPgK9k8K8VDRMWnU7D:focus,._2IvXEPgK9k8K8VDRMWnU7D:hover,._3Cm5qFFmoqzmulqc5YmEra{color:"[theme:neutralSecondary, default:#666666]"}._3Cm5qFFmoqzmulqc5YmEra{display:block}._2OZDFgDuC3KrCyrS5nVo7N{bottom:0;position:absolute;color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._2OZDFgDuC3KrCyrS5nVo7N{right:26px}html[dir=rtl] ._2OZDFgDuC3KrCyrS5nVo7N{left:26px}._2OZDFgDuC3KrCyrS5nVo7N:focus,._2OZDFgDuC3KrCyrS5nVo7N:hover{color:"[theme:white, default:#ffffff]"}html[dir] ._2OZDFgDuC3KrCyrS5nVo7N:focus,html[dir] ._2OZDFgDuC3KrCyrS5nVo7N:hover{background:"[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]"}html[dir=ltr] ._2OZDFgDuC3KrCyrS5nVo7N:focus,html[dir=ltr] ._2OZDFgDuC3KrCyrS5nVo7N:hover{border-bottom-right-radius:2px}html[dir=rtl] ._2OZDFgDuC3KrCyrS5nVo7N:focus,html[dir=rtl] ._2OZDFgDuC3KrCyrS5nVo7N:hover{border-bottom-left-radius:2px}._2pSF7WaduNQjxNF4PRI95h{font-size:14px}html[dir] ._2pSF7WaduNQjxNF4PRI95h{margin:0}html[dir] ._3R3B0JqB9PYlMQo1viYxrH:focus,html[dir] ._3R3B0JqB9PYlMQo1viYxrH:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._2L8hQB9NMllzerkbl4qi3o,html[dir] ._3BBwZqbB6BqdVUe3F43Xg9,html[dir] ._3nfkSYSTXhfR72JZGZB63M,html[dir] ._3UAa0IIN8WyuGImG7Uy7PZ,html[dir] ._254koIc77MJw-i07JOZAgU,html[dir] ._-4ppTNcUT5WVLBRhTZPuZ{margin:0;background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._2L8hQB9NMllzerkbl4qi3o:focus,html[dir] ._2L8hQB9NMllzerkbl4qi3o:hover,html[dir] ._3BBwZqbB6BqdVUe3F43Xg9:focus,html[dir] ._3BBwZqbB6BqdVUe3F43Xg9:hover,html[dir] ._3nfkSYSTXhfR72JZGZB63M:focus,html[dir] ._3nfkSYSTXhfR72JZGZB63M:hover,html[dir] ._3UAa0IIN8WyuGImG7Uy7PZ:focus,html[dir] ._3UAa0IIN8WyuGImG7Uy7PZ:hover,html[dir] ._254koIc77MJw-i07JOZAgU:focus,html[dir] ._254koIc77MJw-i07JOZAgU:hover,html[dir] ._-4ppTNcUT5WVLBRhTZPuZ:focus,html[dir] ._-4ppTNcUT5WVLBRhTZPuZ:hover{background:"[theme:themeTertiary, default:#71AFE5]"}',""]),e.locals={downloadButton:"_2IvXEPgK9k8K8VDRMWnU7D",downloadButtonForDocViewInCompose:"_3Cm5qFFmoqzmulqc5YmEra",downloadButtonForImageView:"_2OZDFgDuC3KrCyrS5nVo7N",icon:"_2pSF7WaduNQjxNF4PRI95h",default:"_3R3B0JqB9PYlMQo1viYxrH",thematic:"_3UAa0IIN8WyuGImG7Uy7PZ",edit:"_3nfkSYSTXhfR72JZGZB63M",selected:"_-4ppTNcUT5WVLBRhTZPuZ",selectedAndPending:"_2L8hQB9NMllzerkbl4qi3o",selectedAndSaving:"_254koIc77MJw-i07JOZAgU",notSelectedAndSaving:"_3BBwZqbB6BqdVUe3F43Xg9"}},4240:function(t,e,n){"use strict";function r(t){return t.actionCompletePercent>0&&t.actionCompletePercent<=1}n.d(e,"a",function(){return r})},4311:function(t,e,n){"use strict";var r=n(870),o=n(2433),a=n(825),i=n(1314),c=n(20),s=n(11),u=n(4),l=n(57),d=n(63),p=Object(u.select)({previewPaneStore:function(){return l.y}})(Object(u.action)("createImageGalleryFromAttachmentWell")(function(t,e,n){var u=n.previewPaneStore.state;if(u&&u.type===r.b.Image&&t.imageViewAttachments.some(function(t){return Object(d.d)(t.attachmentId,u.attachmentId)})){var l=[];t.imageViewAttachments.forEach(function(n){var r=Object(a.a)(n.attachmentId),u=r.model,d=Object(i.b)(r.id,r.model,2,1===r.type,n.isReadOnly),p=n.strategy.isSaveToCloudSupported&&Object(c.isStringNullOrWhiteSpace)(r.model.AttachmentOriginalUrl),m={attachmentId:n.attachmentId,name:u.Name,size:u.Size,downloadUrl:r.download.url,isDownloadDisabled:!r.info||!r.info.allowDownload,isSaveToCloudEnabled:p,previewUrl:r.previewImage.url,thumbnailUrl:d,isCloudy:n.isCloudy,parentItemId:e};l.push(m),Object(o.a)(n.attachmentId,t.isReadOnly).then(function(){var t=Object(a.a)(n.attachmentId).thumbnailImage.url;m.thumbnailUrl=t},function(t){return s.c.warn("Unable to refresh thumbnail image for "+n.attachmentId+". Got error "+t)})}),n.previewPaneStore.imageGallery=l}})),m=n(0),h=n(218);function f(t,e){return void 0===e&&(e=!1),m.__awaiter(this,void 0,void 0,function(){var n,r,o,a,i,c,u,l,d,p,f;return m.__generator(this,function(m){switch(m.label){case 0:return n=[],[4,h.i.import()];case 1:return r=m.sent(),[4,h.k.import()];case 2:return o=m.sent(),e?[4,h.m.import()]:[3,4];case 3:return i=m.sent(),[3,5];case 4:i=null,m.label=5;case 5:a=i,c=e?t.docViewAttachments:t.imageViewAttachments,u=0,m.label=6;case 6:if(!(u<c.length))return[3,12];if(l=c[u],d=r(l.attachmentId),e&&!a(d.model))return[3,11];m.label=7;case 7:return m.trys.push([7,9,,10]),[4,o(l.attachmentId,t.isReadOnly)];case 8:return m.sent(),[3,10];case 9:return p=m.sent(),s.c.warn("Unable to refresh thumbnail image for "+l.attachmentId+". Got error "+p),[3,10];case 10:f={downloadUrl:d.download.url,id:l.attachmentId,previewUrl:d.previewImage.url,thumbnailUrl:d.thumbnailImage.url},n.push(f),m.label=11;case 11:return u++,[3,6];case 12:return[2,n]}})})}n.d(e,"b",function(){return p}),n.d(e,"a",function(){return f})},4321:function(t,e,n){"use strict";var r=n(475),o=n(397);function a(t){return t&&t.info&&t.info.sharingInfo&&t.info.sharingInfo.expirationDate&&Object(r.a)(t.info.sharingInfo.expirationDate,Object(o.a)())}var i=n(129),c=n(870),s=n(5),u=n(63),l=n(47),d=n(20),p=n(1918),m=n.n(p),h=n(8),f=n.n(h),v=n(3528);function b(t,e){return e?f.a.SavedOneFileToGroupFilesText:Object(d.format)(f.a.SavedOneFileToOneDriveText,t?f.a.ConsumerDefaultSaveToCloudLocationText:f.a.OneDriveText)}function g(t,e){var n,r=Object(l.a)(),o=void 0!==e.id.mailboxInfo&&e.id.mailboxInfo.type==u.a.GroupMailbox;if(0===t.actionMessage)return function(t,e){var n=Object(v.b)(t,e);return{text:n.text,title:n.title,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1,useExpiredAttachmentStyling:Object(s.d)("doc-attachment-expiringLinkImprovements")&&a(e)}}(t,e);var p=!1,h=!1;switch(t.actionMessage){case 1:n=function(t,e){if(e)return f.a.SavingOneFileToGroupFilesText;var n=Object(c.f)();return t?Object(d.format)(f.a.SavingOneFileToOneDriveConsumerText,f.a.ConsumerDefaultSaveToCloudLocationText):Object(d.format)(f.a.SavingOneFileToOneDriveText,n)}(r,o);break;case 5:n=f.a.CanceledSaveOneFileToOneDriveText;break;case 2:n=b(r,o);break;case 3:n=b(r,o),p=!0;break;case 4:case 9:n=function(t,e){return e?f.a.FailedToSaveFileToGroupFilesText:Object(d.format)(f.a.FailedToSaveFileToOneDriveText,t?f.a.ConsumerDefaultSaveToCloudLocationText:f.a.OneDriveText)}(r,o),h=!0;break;case 7:n=f.a.UpdatingAttachmentText;break;case 6:n=f.a.DeletingAttachmentText;break;case 8:n=function(t,e){if(e)return f.a.UploadingToGroupFilesText;var n=Object(c.f)();return t?Object(d.format)(f.a.UploadingToOneDriveConsumerText,n,f.a.ConsumerDefaultSaveToCloudLocationText):Object(d.format)(f.a.UploadingToOneDriveText,n)}(r,o);break;case 10:n=f.a.CancelingText;break;case 11:n=f.a.AttachingACopyText;break;case 12:n=f.a.FailedToAttachAsACopyText,h=!0;break;case 16:n=f.a.CancelingText;break;case 14:n=f.a.AddToCalendarSuccessMessgaeWithIcon,p=!0;break;case 15:n=m.a.ICSFileErrorText,h=!0;break;case 13:n=m.a.ImportingText;break;case 17:n=f.a.UpdatingAttachmentText;break;default:Object(i.a)(t.actionMessage)}return{text:n,title:n,shouldDisplaySuccessIcon:p,shouldDisplayFailureIcon:h,useExpiredAttachmentStyling:!1}}n.d(e,"a",function(){return g})},6154:function(t,e,n){var r=n(6155),o=n(55);"string"==typeof r&&(r=[[t.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(t.exports=r.locals)},6155:function(t,e,n){(e=t.exports=n(54)(!1)).push([t.i,'._3thuWUNFvlK1l3Xth75Rd6{display:block;width:261px}html[dir] ._3thuWUNFvlK1l3Xth75Rd6._1MWtOFgZj31e4UkQy6Y0EF,html[dir] ._3thuWUNFvlK1l3Xth75Rd6:focus,html[dir] ._3thuWUNFvlK1l3Xth75Rd6:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._3thuWUNFvlK1l3Xth75Rd6._1MWtOFgZj31e4UkQy6Y0EF ._1tW61X6_rIoj262h7NCl-H,._3thuWUNFvlK1l3Xth75Rd6:focus ._1tW61X6_rIoj262h7NCl-H,._3thuWUNFvlK1l3Xth75Rd6:hover ._1tW61X6_rIoj262h7NCl-H{visibility:visible}._3thuWUNFvlK1l3Xth75Rd6._1MWtOFgZj31e4UkQy6Y0EF ._1FvBPwGPyvX3Iyi3CdAYC2,._3thuWUNFvlK1l3Xth75Rd6:focus ._1FvBPwGPyvX3Iyi3CdAYC2,._3thuWUNFvlK1l3Xth75Rd6:hover ._1FvBPwGPyvX3Iyi3CdAYC2{display:inline-block}._3thuWUNFvlK1l3Xth75Rd6._1MWtOFgZj31e4UkQy6Y0EF .KRuYDNwY4vQuwSi8S0jAj,._3thuWUNFvlK1l3Xth75Rd6:focus .KRuYDNwY4vQuwSi8S0jAj,._3thuWUNFvlK1l3Xth75Rd6:hover .KRuYDNwY4vQuwSi8S0jAj{width:142px}._AevPvX10pVae8HYgwGkg{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;position:relative}._3JCJMOVTDFH_HO52pddntm{display:block}html[dir] ._3JCJMOVTDFH_HO52pddntm{margin:6px 8px}._P4APX2LUsxsXK-r6JBmL{font-size:24px;color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] ._P4APX2LUsxsXK-r6JBmL{background:transparent}._2GuCwb0QYFspVzLzxr_jCS{display:block;white-space:nowrap;position:relative;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._2GuCwb0QYFspVzLzxr_jCS{padding:6px 4px}._27S34NNYbGzLZqJsqy9mkk{font-size:14px;font-weight:400;max-width:194px}.KRuYDNwY4vQuwSi8S0jAj{font-size:11px;font-weight:400;max-width:194px}html[dir] .KRuYDNwY4vQuwSi8S0jAj{padding-top:3px}.KRuYDNwY4vQuwSi8S0jAj ._3vE7-q6ppASdrAKlXdPTeu{font-size:12px;font-weight:400;font-weight:600;position:relative;top:2px}html[dir=ltr] .KRuYDNwY4vQuwSi8S0jAj ._3vE7-q6ppASdrAKlXdPTeu{padding-right:4px}html[dir=rtl] .KRuYDNwY4vQuwSi8S0jAj ._3vE7-q6ppASdrAKlXdPTeu{padding-left:4px}.KRuYDNwY4vQuwSi8S0jAj ._2_HXACMkxRqesWhsya_Dl8{color:#107c10}.KRuYDNwY4vQuwSi8S0jAj .RsIrqbstiK4YTvrE5GkOf{color:#e81123}._1atqMuBqD5kFCMsuAuApSF{overflow:hidden;text-overflow:ellipsis}._1XEX76V0IqydK9RI22R25P{height:50%;width:52px;position:absolute;bottom:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] ._1XEX76V0IqydK9RI22R25P{right:0}html[dir=rtl] ._1XEX76V0IqydK9RI22R25P{left:0}._1tW61X6_rIoj262h7NCl-H{visibility:hidden;display:block;height:100%;width:26px;position:absolute;bottom:0}html[dir=ltr] ._1tW61X6_rIoj262h7NCl-H{right:0}html[dir=rtl] ._1tW61X6_rIoj262h7NCl-H{left:0}html[dir] ._1tW61X6_rIoj262h7NCl-H:focus,html[dir] ._1tW61X6_rIoj262h7NCl-H:hover{background:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1FvBPwGPyvX3Iyi3CdAYC2{display:none}._3vE7-q6ppASdrAKlXdPTeu{font-size:14px}html[dir] ._3vE7-q6ppASdrAKlXdPTeu{margin:0}._2oWc81ducIhJZd3bKXiV13{font-size:12px;font-weight:400;line-height:30px;cursor:pointer;width:261px;-webkit-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}html[dir=ltr] ._2oWc81ducIhJZd3bKXiV13{padding:0 20px 0 54px}html[dir=rtl] ._2oWc81ducIhJZd3bKXiV13{padding:0 54px 0 20px}html[dir] ._2oWc81ducIhJZd3bKXiV13:focus,html[dir] ._2oWc81ducIhJZd3bKXiV13:hover{background:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._1tOIFg_W_VrXpDav76mYI2{margin-top:-4px}._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator-itemName{display:none}._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator,._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}html[dir] ._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator,html[dir] ._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,html[dir] ._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,html[dir] ._1tOIFg_W_VrXpDav76mYI2 .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{padding:0}',""]),e.locals={container:"_3thuWUNFvlK1l3Xth75Rd6",active:"_1MWtOFgZj31e4UkQy6Y0EF",menuButton:"_1tW61X6_rIoj262h7NCl-H",downloadButton:"_1FvBPwGPyvX3Iyi3CdAYC2",secondLine:"KRuYDNwY4vQuwSi8S0jAj",innerContainer:"_AevPvX10pVae8HYgwGkg",thumbnailDiv:"_3JCJMOVTDFH_HO52pddntm",placeholder:"_P4APX2LUsxsXK-r6JBmL",infoDiv:"_2GuCwb0QYFspVzLzxr_jCS",firstLine:"_27S34NNYbGzLZqJsqy9mkk",icon:"_3vE7-q6ppASdrAKlXdPTeu",success:"_2_HXACMkxRqesWhsya_Dl8",failure:"RsIrqbstiK4YTvrE5GkOf",textOverFlow:"_1atqMuBqD5kFCMsuAuApSF",actionsContainer:"_1XEX76V0IqydK9RI22R25P",menuItem:"_2oWc81ducIhJZd3bKXiV13",progressIndicator:"_1tOIFg_W_VrXpDav76mYI2"}},6156:function(t,e,n){var r=n(6157),o=n(55);"string"==typeof r&&(r=[[t.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(t.exports=r.locals)},6157:function(t,e,n){(e=t.exports=n(54)(!1)).push([t.i,"._1jxRKqJaJ0KxwrTzmxRDNt{overflow-y:auto;overflow-x:hidden}",""]),e.locals={container:"_1jxRKqJaJ0KxwrTzmxRDNt"}},6158:function(t,e,n){var r=n(6159),o=n(55);"string"==typeof r&&(r=[[t.i,r]]);for(var a=0;a<r.length;a++)o.loadStyles(r[a][1],!1);r.locals&&(t.exports=r.locals)},6159:function(t,e,n){(e=t.exports=n(54)(!1)).push([t.i,'._1-Mun9s9v3QQLmnpj3_Vp9{color:"[theme:neutralDark, default:#212121]"}html[dir] ._1-Mun9s9v3QQLmnpj3_Vp9{border-radius:2px}html[dir] ._1-Mun9s9v3QQLmnpj3_Vp9:not(:hover){background-color:transparent}._1-Mun9s9v3QQLmnpj3_Vp9.ms-Button{min-width:50px}html[dir] ._1-Mun9s9v3QQLmnpj3_Vp9.ms-Button{padding:0}html[dir=ltr] ._3osEV_LVq0X_In8ctXruwG{margin-left:2px}html[dir=rtl] ._3osEV_LVq0X_In8ctXruwG{margin-right:2px}._3MO6EUnkX_Uv_LsMcuXtXl{font-size:10px}html[dir] ._3MO6EUnkX_Uv_LsMcuXtXl{margin:2px 6px 0}._5K5VaB3ZRJuJfE7srSdXA{font-size:14px;font-weight:400}html[dir] ._5K5VaB3ZRJuJfE7srSdXA{margin:0}',""]),e.locals={button:"_1-Mun9s9v3QQLmnpj3_Vp9",icon:"_3osEV_LVq0X_In8ctXruwG",menuIcon:"_3MO6EUnkX_Uv_LsMcuXtXl",label:"_5K5VaB3ZRJuJfE7srSdXA"}},7073:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(18),a=n(17),i=n(728),c=n(354),s=n(2471),u=n(12),l=n(870),d=n(2299),p=n(3657),m=n(4321),h=n(4240),f=n(825),v=n(2279),b=n(2979),g=n(868),_=n(2062),w=n(476),I=n(57),O=n(3),C=n(218),j=n(6154),x=n(160).bind(j),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(t){var n=Object(l.e)(e.props.attachmentViewState.strategy);if(n!==l.a.NoAction){var r=p.c.OnClick,o=r.name,a=r.customData;Object(u.k)(o,a(n)),Object(v.c)(e.props.attachmentViewState,I.h.ConversationAttachmentWell,e.props.instrumentationContext,e.props.parentItemId,!1,e.props.onBeforePreview,null,e.props.createImageGallery,e.containerElement.parentElement)}},e.onContextMenu=function(t){t.preventDefault(),Object(d.a)(e.props.attachmentViewState,e.contextMenuJustOpened=!0)},e.onMenuItemClicked=function(t,n){t.stopPropagation(),n.onClick(t,n),Object(d.a)(e.props.attachmentViewState,!1)},e.onMenuButtonClicked=function(t){t.stopPropagation(),Object(d.a)(e.props.attachmentViewState,e.contextMenuJustOpened=!e.props.attachmentViewState.shouldShowContextMenu)},e}return r.__extends(e,t),e.prototype.render=function(){var t=this,e=Object(f.a)(this.props.attachmentViewState.attachmentId);return O.createElement("div",{"aria-label":e.model.Name,ref:function(e){return t.containerElement=e},onFocus:function(){return t.props.onFocus&&t.props.onFocus(t.props.attachmentViewState.attachmentId.Id)},onMouseOver:function(){return t.props.onFocus&&t.props.onFocus(t.props.attachmentViewState.attachmentId.Id)},className:x(j.container,{active:this.props.attachmentViewState.shouldShowContextMenu}),"data-is-focusable":!0,onClick:this.onClick,onContextMenu:this.onContextMenu},O.createElement("div",{className:j.innerContainer},this.renderIcon(e),this.renderInfo(e),this.props.attachmentViewState.strategy.showActionsMenu&&O.createElement("div",{className:j.actionsContainer},O.createElement(p.a,{attachmentViewState:this.props.attachmentViewState,isForImageView:!1,previewState:I.a.None,customClassName:j.downloadButton}),O.createElement(i.IconButton,{"data-is-focusable":!1,className:j.menuButton,onClick:this.onMenuButtonClicked,iconProps:{iconName:this.props.attachmentViewState.shouldShowContextMenu?"ChevronUp":"ChevronDown",styles:{root:j.icon}}}))),this.renderProgressIndicator(),this.props.attachmentViewState.shouldShowContextMenu?this.renderContextMenu(e):null)},e.prototype.renderIcon=function(t){var e=C.m.tryImportSync();if(e&&e(t.model)){var n=t.model.Name,r=Object(_.e)(n),a=null,i=Object(o.getIconClassName)("Photo2");return Object(g.d)(n)&&(a=r.small,i=r.small),O.createElement("div",{className:j.thumbnailDiv},O.createElement(b.c,{attachmentViewState:this.props.attachmentViewState,placeHolderCSSClass:x(i,j.placeholder),fileIconCssClass:a,imageLoadErrorCSSClass:r.small,thumbnailWidth:32,thumbnailHeight:32}))}return O.createElement(b.b,{attachmentId:this.props.attachmentViewState.attachmentId})},e.prototype.renderInfo=function(t){var e=1!==t.type&&0===this.props.attachmentViewState.actionMessage?{text:Object(w.a)(this.props.itemReceivedTime),title:null,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1}:Object(m.a)(this.props.attachmentViewState,t);return O.createElement("div",{className:j.infoDiv},O.createElement("div",{className:x(j.firstLine,j.textOverFlow),title:t.model.Name},t.model.Name),O.createElement("div",{className:x(j.secondLine,j.textOverFlow),title:e.title},e.shouldDisplaySuccessIcon?O.createElement(c.a,{iconName:"Accept",className:x(j.icon,j.success)}):null,e.shouldDisplayFailureIcon?O.createElement(c.a,{iconName:"Cancel",className:x(j.icon,j.failure)}):null,e.text))},e.prototype.renderContextMenu=function(t){var e=this,n=p.d.tryImportSync(),r=n?n(this.props.attachmentViewState,t,{viewState:this.props.attachmentViewState,previewPaneSelectionSource:I.h.ConversationAttachmentWell,parentItemId:this.props.parentItemId,isDraft:!1,onBeforePreview:this.props.onBeforePreview,onAfterPreview:null,createImageGallery:this.props.createImageGallery,instrumentationContext:this.props.instrumentationContext},this.props.parentItemId,null,this.containerElement.parentElement,null):[];return O.createElement("div",null,r.map(function(t){return O.createElement("div",{"data-is-focusable":!0,className:j.menuItem,key:t.key,onClick:function(n){return e.onMenuItemClicked(n,t)}},t.name)}))},e.prototype.renderProgressIndicator=function(){return Object(h.a)(this.props.attachmentViewState)?O.createElement("div",{className:j.progressIndicator},O.createElement(s.a,{percentComplete:this.props.attachmentViewState.actionCompletePercent})):null},e.prototype.componentDidUpdate=function(t,e){if(this.contextMenuJustOpened&&(this.contextMenuJustOpened=!1,this.props.attachmentViewState.shouldShowContextMenu)){var n=this.containerElement.parentElement.clientHeight,r=this.containerElement.parentElement.scrollTop,o=this.containerElement.offsetHeight,a=this.containerElement.offsetTop;o+a>n+r?this.containerElement.parentElement.scrollTop=o+a-n:a<r&&(this.containerElement.parentElement.scrollTop=a)}},e=r.__decorate([a.observer],e)}(O.Component),y=n(1347),A=n(158),T=n(1),P=Object(T.mutatorAction)("updateConversationAttachmentWellMaxHeight",function(t){t.maxHeight=(window.innerHeight||document.body.clientHeight)-200}),k=n(4311),N=n(181),M=n(6156),E=n(160).bind(M),D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onItemFocused=function(t){e.props.viewState.docViewAttachments.forEach(function(e){e.shouldShowContextMenu&&e.attachmentId.Id!==t&&Object(d.a)(e,!1)})},e.onResize=function(){P(e.props.viewState)},e.createImageGallery=function(){return r.__awaiter(e,void 0,void 0,function(){return r.__generator(this,function(t){return[2,Object(k.a)(this.props.viewState,!0)]})})},e}return r.__extends(e,t),e.prototype.componentDidMount=function(){this.onResize(),N.a.importAndExecute(this.onResize)},e.prototype.componentWillUnmount=function(){N.c.importAndExecute(this.onResize)},e.prototype.render=function(){var t=this;return O.createElement(y.a,{direction:A.a.vertical,className:E("disableTextSelection","customScrollBar",M.container),style:{maxHeight:this.props.viewState.maxHeight+"px"}},this.props.viewState.docViewAttachments.map(function(e){return O.createElement(S,{key:"convoWell_"+e.attachmentId.Id,attachmentViewState:e,parentItemId:t.props.viewState.parentItemIdMap[e.attachmentId.Id],itemReceivedTime:t.props.viewState.itemReceivedTimeMap[e.attachmentId.Id],instrumentationContext:t.props.instrumentationContext,onBeforePreview:t.props.onBeforePreview,onFocus:t.onItemFocused,createImageGallery:t.createImageGallery})}))},e=r.__decorate([a.observer],e)}(O.Component),V=n(872),R=n(1326),F=n(78),B=Object(T.mutatorAction)("setConversationAttachmentWellVisible",function(t,e){t.isVisible=e}),X=n(20),U=n(8),W=n.n(U),L=n(6158),q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dismissCallout=function(){B(e.props.viewState,!1),e.props.viewState.docViewAttachments.forEach(function(t){Object(d.a)(t,!1)})},e.onShowMenuClicked=function(){B(e.props.viewState,!e.props.viewState.isVisible)},e}return r.__extends(e,t),e.prototype.render=function(){var t=this,e=this.props.viewState.docViewAttachments.length;if(0===e)return null;var n=e+(this.props.canLoadMore?"+":"");return O.createElement("div",{className:this.props.className||""},O.createElement("div",{ref:function(e){return t.buttonElement=e}},O.createElement(V.a,{onClick:this.onShowMenuClicked,text:n,className:L.button,iconProps:{iconName:"Attach",styles:{root:L.icon}},menuIconProps:{iconName:"ChevronDown",styles:{root:L.menuIcon}},ariaLabel:this.getAriaLabel(),styles:{label:L.label}})),this.props.viewState.isVisible?O.createElement(R.a,{setInitialFocus:!0,isBeakVisible:!1,target:this.buttonElement,onDismiss:this.dismissCallout,directionalHint:F.DirectionalHint.bottomRightEdge},O.createElement(D,{viewState:this.props.viewState,instrumentationContext:this.props.instrumentationContext,onBeforePreview:this.dismissCallout})):null)},e.prototype.getAriaLabel=function(){var t=this.props.viewState.docViewAttachments.length;return t>1?Object(X.format)(W.a.NAttachments,t):Object(X.format)(W.a.OneAttachment,t)},e=r.__decorate([a.observer],e)}(O.Component);n.d(e,"ConversationAttachmentWellButton",function(){return q})}},0,[2,3,8,9,66,7,23,62,279,51,280,57,300,186,102,226]]);
//# sourceMappingURL=owa.ConversationAttachment.mail.js.map
window.scriptsLoaded['owa.ConversationAttachment.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.ConversationAttachment.mail.js'] = (new Date()).getTime();