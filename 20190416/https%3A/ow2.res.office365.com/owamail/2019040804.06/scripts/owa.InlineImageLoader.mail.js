window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.InlineImageLoader.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[146],{1879:function(e,t,n){"use strict";n.r(t);var r=n(1239),a=n(4),i=Object(a.action)("clearInlineImageStore")(function(){r.a.inlineImages={}}),o=n(2200),c=n(2329),u=n(1586),s=Object(a.action)("addInlineImageToStore")(function(e,t){r.a.inlineImages[e]=t}),d=n(357);function l(e){var t=Object(c.a)(e,o.e),n=Object(c.a)(e,d.c);if(t.length>0&&n.length>0){var r=Object(u.a)(e);r&&s(n,r)}}var f=n(3499),m=n(3278),g=n(3281),h=n(3713),b=n(2401),v=n(12),p=n(11);function O(e){var t=[e];Object(v.k)("InlineImageAttachmentUpload",t),p.c.info("InlineImageAttachmentUpload: "+t)}n.d(t,"clearInlineImageStore",function(){return i}),n.d(t,"cacheInlineImage",function(){return l}),n.d(t,"loadFromAttachmentServiceUrl",function(){return f.a}),n.d(t,"loadFromAttachment",function(){return m.a}),n.d(t,"loadFromProxy",function(){return g.a}),n.d(t,"loadFromImageTag",function(){return h.a}),n.d(t,"logImageLoadError",function(){return b.a}),n.d(t,"logImageUpload",function(){return O}),n.d(t,"tryCreateDataURIFromImage",function(){return u.a})},2200:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"q",function(){return s}),n.d(t,"m",function(){return d}),n.d(t,"l",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"k",function(){return m}),n.d(t,"g",function(){return g}),n.d(t,"o",function(){return h}),n.d(t,"n",function(){return b}),n.d(t,"p",function(){return v}),n.d(t,"i",function(){return p}),n.d(t,"h",function(){return O});var r="src",a="data-imagetype",i="crossorigin",o="data-itemid",c="data-inetid",u="use-credentials",s="AttachmentByCid",d="OnError",l="NullAttachmentUrl",f="DOMDetached",m="ImageMismatch",g="RP",h="DataUri",b="CrossDomain",v="SameDomain",p="ImageProxySkipForConsumerChild",O="ImageProxyConnectorsAuthTokenFalse"},2207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),a=n(2620);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetClientAccessToken",e,t)}},2208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}},2329:function(e,t,n){"use strict";function r(e,t){return e.hasAttribute(t)?e.getAttribute(t):""}n.d(t,"a",function(){return r})},2401:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(12),a=n(11),i=new RegExp("[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}","i");function o(e,t,n,o,c,u,s,d,l,f,m,g,h,b){void 0===o&&(o=""),void 0===c&&(c=""),void 0===u&&(u=""),void 0===s&&(s=""),void 0===d&&(d=""),void 0===l&&(l=""),void 0===f&&(f=""),void 0===m&&(m=""),void 0===g&&(g=""),void 0===h&&(h=""),void 0===b&&(b="");var v=[e,t,n,o,c,u,s=function(e){if(!e)return"";var t="",n=e,r=e.indexOf(":");return r>=0&&(t=e.slice(0,r+1),n=e.slice(r+1)),t+(n=n.match(i)?"<GUID>":"<PII>")}(s),d,l,f,m,g,h,b];Object(r.k)("InlineImageLoadError",v),a.c.info("InlineImageLoadError: "+v)}},2521:function(e,t,n){"use strict";function r(e,t,n,r,a,i,o){void 0===r&&(r=""),void 0===a&&(a=""),void 0===i&&(i=""),void 0===o&&(o=""),e.addCustomData([t,n,r,a,i,o]),r&&r.length>0?e.endWithError("ClientError"):e.end()}n.d(t,"a",function(){return r})},2522:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(357),a="onload";function i(e,t,n,a){e.onload=function(e){var t=e.target;o(t),n&&n(t)},e.onerror=function(e){var t=e.target;o(t),a&&a(t)},e.setAttribute(r.b,r.d),e.src=t}function o(e){e.removeAttribute(a),e.removeAttribute(r.b),e.onload=null,e.onerror=null}},2620:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},e)}},2650:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(2200),a=n(2329),i=n(45),o=n(96),c=n(11),u=n(357),s="deeplink/read/",d="/owa/?debugJS=true&viewmodel=ReadMessageItem&InternetMessageID=";function l(e,t,n,i){var o="Please engage nickhu@microsoft.com with below data:\n",s=Object(a.a)(e,r.d);s&&(o+="Deeplink (React): "+f(s,!0)+"\n");var d=Object(a.a)(e,r.c);d&&(o+="Deeplink (MVVM): "+f(d,!1)+"\n");var l=e.src;l&&(o+="Src: "+l+"\n");var m=Object(a.a)(e,u.c);if(m&&(o+="OriginalSrc: "+m+"\n"),n){var g=n.status,h=n.contentType,b=n.detectedFormat,v=n.first10BytesBase64;g&&(o+="Status: "+g+"\n"),h&&(o+="ContentType: "+h+"\n"),b&&(o+="DetectedFormat: "+b+"\n"),v&&(o+="First10Bytes: "+v+"\n"),o+="MimeMatch: "+n.mimeMatched}i&&i>0&&(o+="Retried: "+i),c.c.error("Error loading inline image: "+t+".\n"+o)}function f(e,t){void 0===t&&(t=!0);var n=Object(i.a)(),r=n.origin;return r||(r=n.protocol+"//"+n.hostname+(n.port?":"+n.port:"")),t?r+Object(o.k)()+s+e:r+d+e}},2930:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(3280),a=n(12);function i(){return new a.a(r.a)}},3032:function(e,t,n){"use strict";var r,a,i=n(0),o=n(12),c=n(5),u=n(2208),s=n.n(u),d=n(2207),l=n.n(d),f=n(726),m=n(47),g=n(359),h=n(1343),b="GetConnectorsLTITokenFailure",v="GetConnectorsLTITokenException",p="GetConnectorsLTITokenNull",O="ConnectorsLtiToken",j="40B852DF-9693-420D-AA7D-10072C9CE077",y="https://outlook.office365.com/connectors",w="User.Read",A=5;function I(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return!Object(c.d)("rp-actionableMessages-aad-token")||Object(m.a)()?[3,2]:[4,T()];case 1:return[2,e.sent()];case 2:return Object(c.d)("rp-actionableMessages-msa-token")&&Object(m.a)()?[4,C()]:[3,4];case 3:return[2,e.sent()];case 4:return[4,x()];case 5:return[2,e.sent()]}})})}function C(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return[4,Object(g.d)(w)];case 1:return[2,e.sent()]}})})}function T(){return i.__awaiter(this,void 0,void 0,function(){var e,t,n;return i.__generator(this,function(r){switch(r.label){case 0:return e=i.__read(Object(g.c)(y),2),t=e[0],n=e[1],t?[3,2]:[4,n];case 1:t=r.sent(),r.label=2;case 2:return[2,t]}})})}function x(){return i.__awaiter(this,void 0,void 0,function(){var e,t,n;return i.__generator(this,function(i){switch(i.label){case 0:if(function(){if(!r)return!1;return Date.now()-a<1e3*(r.TTL-A)*60}())return _(r.TokenValue),[2,r.TokenValue];e={Header:Object(f.getJsonRequestHeader)(),Body:s()({TokenRequests:[{__type:"TokenRequest:#Exchange",Id:j,TokenType:"Connectors"}]})},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,l()(e)];case 2:return(t=i.sent())&&"Success"===t.Body.ResponseMessages.Items[0].ResponseClass?(o=t.Body.ResponseMessages.Items[0].Token,r=o,a=Date.now(),_(r.TokenValue),[2,r.TokenValue]):(S(b),[2,Promise.reject(new Error("getClientAuthToken failed"))]);case 3:return n=i.sent(),S(v),[2,Promise.reject(new Error("getClientAuthToken exception: "+n))];case 4:return[2]}var o})})}function S(e){Object(o.k)(e),r=void 0}function _(e){!function(e,t,n){if(!t)throw S(p),new Error("getClientAuthToken null");h.set(e,t,n)}(O,e,{path:"/actions/"})}n.d(t,"a",function(){return I}),n.d(t,"b",function(){return x})},3278:function(e,t,n){"use strict";n.d(t,"a",function(){return j});var r=n(2200),a=n(2521),i=n(104),o=n(3499),c=n(3601),u=n(2522),s=n(2401),d=n(2329),l=n(2930),f=n(1239),m=n(1314),g=n(357),h="naturalwidth",b="naturalheight",v="width",p="height",O="px";function j(e,t,n){void 0===n&&(n=!0);var j=Object(d.a)(e,g.a);if(0==j.length)return!1;var A=Object(d.a)(e,g.c),I=Object(d.a)(e,r.b),C=A.length>0?f.a.inlineImages[A]:null;if(C){var T=Object(l.a)();Object(u.a)(e,C,function(e){w(e),Object(a.a)(T,I,r.o,"",t)},function(e){Object(a.a)(T,I,r.o,r.m,t),Object(s.a)(I,r.o,r.m,"",t,"",A,"")})}else{var x={Id:decodeURIComponent(j),mailboxInfo:Object(c.a)(e)},S=Object(m.c)(x,1);if(null!=S&&S.length>0){var _=e.style.display,D=n?function(e){var t="50px",n="50px";e.style.width&&e.style.height?(t=e.style.width,n=e.style.height):e.getAttribute(v)&&e.getAttribute(p)?(t=e.getAttribute(v)+O,n=e.getAttribute(p)+O):e.getAttribute(h)&&e.getAttribute(b)&&(t=e.getAttribute(h)+O,n=e.getAttribute(b)+O);var r=Object(i.g)(),a=document.createElement("div");if(a.style.display="inline-block",a.style.width=t,a.style.height=n,a.style.maxWidth="100%",a.style.maxHeight=e.style.maxHeight,a.style.borderWidth="1px",a.style.borderStyle="dashed",a.style.borderColor=r.themePrimary,a.style.boxSizing="border-box",e.style.display="none",e.parentNode.insertBefore(a,e),e.getAttribute(h)&&e.getAttribute(b)){var o=Math.min(parseInt(a.style.width),a.offsetWidth);a.style.height=Math.ceil(o/parseInt(e.getAttribute(h))*parseInt(e.getAttribute(b))).toString()}return a}(e):null;Object(o.a)(e,S,t,function(e){y(D),w(e),e.style.display=_},function(e){y(D),e.style.display="inline"},!0)}else Object(s.a)(I,"",r.l,"",t,"",A,""),e.src=A||""}return!0}function y(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function w(e){var t=e.style;e.hasAttribute("width")||t.width||e.hasAttribute("height")||t.height||(t.maxWidth="100%",t.height="auto")}},3279:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(2200),a="RequestError",i="RequestTimeout",o="RequestAbort",c="ImageZeroBytes",u="ImageInvalidLength",s=[{format:"JPEG",signature:new Uint8Array([255,216,255,224]),mime:/^image\/p?jpe?g$/i,expectedMime:"image/jpeg"},{format:"EXIF",signature:new Uint8Array([255,216,255,225]),mime:/^image\/p?jpe?g$/i},{format:"SPIFF",signature:new Uint8Array([255,216,255,232]),mime:/^image\/p?jpe?g$/i},{format:"CannonEOS",signature:new Uint8Array([255,216,255,226]),mime:/^image\/p?jpe?g$/i},{format:"SamsungD500",signature:new Uint8Array([255,216,255,227]),mime:/^image\/p?jpe?g$/i},{format:"PNG",signature:new Uint8Array([137,80,78,71,13,10,26,10]),mime:/^image\/png$/i,expectedMime:"image/png"},{format:"GIF",signature:new Uint8Array([71,73,70,56]),mime:/^image\/gif$/i,expectedMime:"image/gif"},{format:"TIFF1",signature:new Uint8Array([73,32,73]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF2",signature:new Uint8Array([73,73,42,0]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF3",signature:new Uint8Array([77,77,0,42]),mime:/^image\/(x-)?tiff$/i},{format:"TIFF4",signature:new Uint8Array([77,77,0,43]),mime:/^image\/(x-)?tiff$/i},{format:"BMP",signature:new Uint8Array([66,77]),mime:/^image\/bmp$/i}];function d(e,t){return void 0===t&&(t=!1),new Promise(function(n){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){var e=d.status,t=d.getResponseHeader("Content-Type")||"";if(t.length>0){var a=t.indexOf(";");a>0&&(t=t.substr(0,a))}var i="",o=null,f="",m=!1,g="";if(200==e){var h=d.response;if(h&&0!=h.byteLength)if(h.byteLength<10)i=u;else{var b=function(e){for(var t=0;t<s.length;t++)for(var n=s[t],r=0;r<n.signature.length&&n.signature[r]==e[r];r++)if(r==n.signature.length-1)return n;return null}(o=new Uint8Array(d.response,0,10));b&&(f=b.format,(m=t&&b.mime.test(t))||(i=r.k,g=b.expectedMime))}else i=c}n({status:i,responseCode:e,contentType:t,detectedFormat:f,first10BytesBase64:o?l(o):"",mimeMatched:m,expectedMime:g})}},d.ontimeout=function(){n({status:i})},d.onerror=function(){n({status:a})},d.onabort=function(){n({status:o})},t&&(d.withCredentials=!0),d.open("GET",e,!0),d.responseType="arraybuffer",d.send()})}function l(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}},3280:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="InlineImageLoad"},3281:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(3602),i=n(3603),o="onload";function c(e,t){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,Object(a.a)(e)];case 1:return(t=n.sent())?(e.removeAttribute(o),e.onload=null,Object(i.a)()?e.src=t:e.src="",[2,!0]):[2,!1]}})})}},3499:function(e,t,n){"use strict";var r=n(2200),a=n(2521),i=n(3279),o=new RegExp("^https?://([^/]*)/.*","i"),c=window.location.hostname.toLowerCase();function u(e){if(e){var t=e.ownerDocument||document;return t&&t.documentElement.contains(e)}return!1}var s,d=n(2522),l=n(2650),f=n(2401),m=n(5),g="DataUri_Success",h="DataUri_RequestFailed",b="DataUri_OnError",v=new RegExp("^data:[a-z]+\\/[a-z-]+;","i");function p(e,t,n,r,i,o){n?r&&r(e):i&&i(e);var c=t.imageType,u=t.perfDataPoint,s=t.howLoad,d=t.context,h=t.loaderCode,b=t.originalSrc,v=t.owaDomain,p=t.downloadDomain,O=t.responseData,j=O.responseCode,y=O.status,w=O.contentType,A=O.detectedFormat,I=O.first10BytesBase64,C=O.mimeMatched,T=n?"":o||y||j.toString();u&&Object(a.a)(u,c,s,T,d,h,n?g:""),n||(Object(f.a)(c,s,T,j.toString(),d,h,b,w,v,p,A,I,C.toString()),Object(m.d)("mc-imageDiagnostics")&&Object(l.a)(e,T,O))}!function(e){e[e.NotStarted=0]="NotStarted",e[e.Pending=1]="Pending",e[e.Completed=2]="Completed"}(s||(s={}));var O=4,j=3,y=1e3,w=2e4,A="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7",I="RetryTimedOut",C=[],T=null;function x(e,t,n,a,i){var o={image:e,url:t,retryContext:n,currentRetry:0,status:s.NotStarted,whenQueued:Date.now(),onSuccessCallback:a,onErrorCallback:i};S(o),C.push(o),T||(T=setTimeout(function(){return function e(){if(C.length>0){var t=Date.now(),n=[],a=[],i=[];C.forEach(function(e){e.status!=s.Completed&&(t-e.whenQueued>w?_(e,!1,I):e.status==s.Pending?(i.push(e),n.push(e)):e.status==s.NotStarted&&(a.push(e),n.push(e)))});var o=O-i.length;o>0&&a.length>0&&(c=a.slice(0,Math.min(o,a.length)))&&c.length>0&&c.forEach(function(e){e.currentRetry++,e.status=s.Pending,u(e.image)?Object(d.a)(e.image,e.url,function(t){_(e,!0)},function(t){e.currentRetry>=j?_(e,!1):S(e)}):_(e,!1,r.j+"_R"+e.currentRetry)}),C=n}var c;T=C.length>0?setTimeout(function(){return e()},y):null}()},y))}function S(e){e.status=s.NotStarted,e.image.src=A}function _(e,t,n){if(void 0===n&&(n=""),e.status!=s.Completed){var r=e.image,i=e.onSuccessCallback,o=e.onErrorCallback,c=e.currentRetry;t?i&&i(r):o&&o(r);var u=e.retryContext,d=u.imageType,g=u.perfDataPoint,h=u.howLoad,b=u.context,v=u.loaderCode,p=u.originalSrc,O=u.owaDomain,j=u.downloadDomain,y=u.responseData,w=y.responseCode,A=y.status,I=y.contentType,C=y.detectedFormat,T=y.first10BytesBase64,x=y.mimeMatched,S=t?"":n||A||w.toString();g&&Object(a.a)(g,d,h,S,b,v,c.toString()),t||(Object(f.a)(d,h,S,w.toString(),b,v,p,I,O,j,C,T,x.toString(),c.toString()),Object(m.d)("mc-imageDiagnostics")&&200==w&&Object(l.a)(r,S,y)),e.status=s.Completed}}var D=n(2329),k=n(2930),R=n(11),E=n(357);n.d(t,"a",function(){return U});var M="ZeroNaturalWidth";function U(e,t,n,s,g,O){void 0===O&&(O=!1);var j,y=Object(k.a)(),w=null!=(j=t.match(o))&&j.length>1&&j[1].toLowerCase()!=c,A=w?r.n:r.p,I=Object(D.a)(e,E.c),C=Object(D.a)(e,r.b);0==C.length&&(C=r.q);var T="";w&&(e.setAttribute(r.a,r.f),T=r.f),R.c.info("InlineImage: Load attachment, Url: "+t+", crossDomain: "+w+", crossOrigin: "+T);var S=w?c:"",_=w?function(e){var t=e.match(o);return null!=t&&t.length>1?t[1].toLowerCase():c}(t):"";Object(d.a)(e,t,function(e){s&&s(e);var t=e.naturalWidth>0;Object(a.a)(y,C,A,t?"":M,n,T),t||Object(f.a)(C,A,M,"",n,T,I,"",S,_)},function(o){var c=r.m;n!=r.g||u(o)?Object(i.a)(t,w).then(function(i){if(O&&200==i.responseCode&&i.mimeMatched)x(o,t,{imageType:C,howLoad:A,context:n,loaderCode:T,originalSrc:I,owaDomain:S,downloadDomain:_,responseData:i,perfDataPoint:y},s,g);else if(i.status==r.k&&i.expectedMime)!function(e,t,n,a,i){var o=new XMLHttpRequest;o.onload=function(){var t=new FileReader;t.onloadend=function(){if(t.result){var r=t.result.replace(v,"data:"+n.responseData.expectedMime+";");Object(d.a)(e,r,function(){return p(e,n,!0,a,i)},function(){return p(e,n,!1,a,i,b)})}},t.readAsDataURL(o.response)},o.ontimeout=o.onerror=function(){p(e,n,!1,a,i,h)},e.crossOrigin==r.f&&(o.withCredentials=!0),o.open("GET",t,!0),o.responseType="blob",o.send()}(o,t,{imageType:C,howLoad:A,context:n,loaderCode:T,originalSrc:I,owaDomain:S,downloadDomain:_,responseData:i,perfDataPoint:y},s,g);else{g&&g(o);var u=i.status,j=i.responseCode,w=i.contentType,D=i.detectedFormat,k=i.first10BytesBase64,R=i.mimeMatched;c=u||j.toString(),Object(a.a)(y,C,A,c,n,T),Object(f.a)(C,A,c,j.toString(),n,T,I,w,S,_,D,k,R.toString()),Object(m.d)("mc-imageDiagnostics")&&(404!=j&&0!=j&&200!=j||Object(l.a)(e,c,200==j?i:null))}}):(g&&g(o),c=r.j,Object(a.a)(y,C,A,c,n,T),Object(f.a)(C,A,c,"",n,T,I,"",S,_))})}},3601:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(39),a=n(63),i=n(20),o=n(2329),c="explicitlogon";function u(e){var t=Object(o.a)(e,c);return Object(i.isStringNullOrWhiteSpace)(t)?Object(a.c)():Object(r.m)(t)}},3602:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(0),a=n(2200),i=n(3032),o=n(407),c=n(7),u=n(12),s=n(2329),d=n(357),l="data-imageproxyendpoint",f="data-connectorsauthtoken",m="u",g="i",h="d",b="ClientId";function v(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i,h;return r.__generator(this,function(r){switch(r.label){case 0:return t=Object(s.a)(e,d.c),n=Object(s.a)(e,l),i=Object(s.a)(e,f),t&&n?Object(c.a)().IsConsumerChild?(Object(u.k)(a.i),[2,t]):"1"!=i?[3,2]:[4,p(n,t)]:[2,""];case 1:return h=r.sent(),[3,3];case 2:h=function(e,t){var n=Object(o.getCookie)(b);if(!n)return null;if("/actions/ei"==e.toLowerCase())return Object(u.k)(a.h),null;return e+"?"+m+"="+encodeURIComponent(t)+"&"+g+"="+encodeURIComponent(n)}(n,t),r.label=3;case 3:return[2,h]}})})}function p(e,t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(i.b)()];case 1:return n.sent(),[3,3];case 2:return n.sent(),[2,null];case 3:return[2,e+"?"+m+"="+encodeURIComponent(t)+"&"+h+"="+encodeURIComponent((new Date).toISOString())]}})})}},3603:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(217),a=n(5);function i(){var e=Object(r.c)(r.a.ExternalImages);return!Object(a.d)("rp-externalImagesProxyOption")||0===e.externalImagesSelectedOption}},3713:function(e,t,n){"use strict";var r=n(3278),a=n(3281),i=n(2200),o=n(2521),c=n(3279),u=n(2522),s=n(2650),d=n(3280),l=n(12);var f=n(2401),m=n(2329),g=n(2930),h=n(5),b=n(357),v="data-imageerror",p="data-outlook-trace",O="CidTildeWrd",j="AttNotFound",y=new RegExp("^cid:\\s?~WRD","i"),w=new RegExp("f:([0-9]+)","i"),A=new RegExp("t:([0-9]+)","i");function I(e,t){var n=Object(m.a)(e,v),r=Object(m.a)(e,i.b),a=Object(m.a)(e,b.c);if(n&&n.length>0){var I=n;if(a&&y.test(a))I=O;else if(n==j){var C=function(e){var t="";if(e){var n=w.exec(e),r=A.exec(e);if(n&&2==n.length&&r&&2==r.length){var a=parseInt(n[1]),i=parseInt(r[1]);isNaN(a)||isNaN(i)||(0==a?t="PreEWS":a>0&&(a<i?t="MidEWS":a==i&&(t="PostEWS")))}}else t="NoTrace";return t}(Object(m.a)(e,p));C&&(I=j+"_"+C)}!function(e,t,n,r,a,i){void 0===n&&(n=""),void 0===r&&(r=""),void 0===a&&(a=""),void 0===i&&(i="");var o=new l.a(d.a),c=[e,t,n,r,a,i];o.addCustomData(c),n&&n.length>0?o.endWithError("ClientError"):o.end()}(r,"",I,t),Object(f.a)(r,"",I,"",t,"",a,""),e.onload=null,e.src=a||"",Object(h.d)("mc-imageDiagnostics")&&(n!=j&&0!=n.indexOf("NotImage")||Object(s.a)(e,n))}else if(a){var T=Object(g.a)();Object(u.a)(e,a,function(e){Object(o.a)(T,r,"","",t)},function(e){Object(o.a)(T,r,"",i.m,t),Object(c.a)(a).then(function(e){var n=e.status,i=e.responseCode,o=e.contentType,c=n||i.toString();Object(f.a)(r,"",c,i.toString(),t,"",a,o)})})}}function C(e,t,n){var i=t||"";Object(r.a)(e,i,!!n)||Object(a.a)(e,i)||I(e,i)}n.d(t,"a",function(){return C})}},0,[279,51,280,57,283,80,289,109]]);
//# sourceMappingURL=owa.InlineImageLoader.mail.js.map
window.scriptsLoaded['owa.InlineImageLoader.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.InlineImageLoader.mail.js'] = (new Date()).getTime();