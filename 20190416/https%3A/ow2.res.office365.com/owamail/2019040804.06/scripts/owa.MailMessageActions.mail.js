window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.MailMessageActions.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[171],{1229:function(e,a,n){"use strict";var t=n(268),i=n(45),r=n(548),o=n(117);function l(e,a){if(a){var n=a.displayName?a.displayName+"<"+a.smtpAddress+">":a.smtpAddress;return e?"&"+e+"="+n:n}return""}function s(e,a){return a?"&"+e+"="+a:""}function c(e){if(!e.to||!e.to.smtpAddress)return"";var a=o.parse(Object(i.a)().search.substr(1));return a.mailtouri=function(e){if(!e.to||!e.to.smtpAddress)return"";var a="mailto:"+l(null,e.to),n="";return n+=l("cc",e.cc),n+=l("bcc",e.bcc),n+=s("subject",e.subject),(n+=s("body",e.body))?a+"?"+n.slice(1):a}(e),Object(r.a)(t.e,t.b,"?"+o.stringify(a))}n.d(a,"a",function(){return c})},1255:function(e,a,n){"use strict";var t=n(1);a.a=Object(t.action)("SHOW_IN_IMMERSIVE_READER",function(e,a,n){return{itemId:e,actionSource:a,subActionSource:n}})},1270:function(e,a,n){"use strict";n.d(a,"a",function(){return i});var t=n(1568);function i(e){var a=document.createElement("div");e?a.innerHTML=e:a.appendChild(document.createElement("br"));var n=a.style,i=Object(t.a)();return i.fontFamily&&(n.fontFamily=i.fontFamily),i.fontSize&&(n.fontSize=i.fontSize),i.textColor&&(n.color=i.textColor),i.bold&&(n.fontWeight="bold"),i.italic&&(n.fontStyle="italic"),i.underline&&(n.textDecoration="underline"),a.outerHTML}a.b=function(){return i()}},1275:function(e,a,n){"use strict";n.d(a,"a",function(){return r});var t=n(7),i=n(46);function r(){return Object(t.a)().UserOptions.GlobalReadingPanePositionReact==i.a.Bottom}},1316:function(e,a,n){"use strict";n.d(a,"a",function(){return o});var t=n(268),i=n(45),r=n(548);function o(e){return e?Object(r.a)(t.e,t.f+"/"+encodeURIComponent(e),Object(i.a)().search):""}},1324:function(e,a,n){"use strict";function t(e){return e.localizedName?e.localizedName:e.name}var i=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','微软雅黑',STHeiti,sans-serif",localizedName:"微软雅黑"},{name:"SimHei",family:"SimHei,'黑体',STHeiti,sans-serif",localizedName:"黑体"},{name:"NSimSun",family:"NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif",localizedName:"新宋体"},{name:"FangSong",family:"FangSong,'仿宋',STFangsong,serif",localizedName:"仿宋"},{name:"SimLi",family:"SimLi,'隶书','Baoli SC',serif",localizedName:"隶书"},{name:"KaiTi",family:"KaiTi,'楷体',STKaiti,serif",localizedName:"楷体"},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif",localizedName:"微軟正黑體"},{name:"PMingLiU",family:"PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif",localizedName:"新細明體"},{name:"DFKai-SB",family:"DFKai-SB,'標楷體','BiauKai',serif",localizedName:"標楷體"},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'メイリオ','Hiragino Sans',sans-serif",localizedName:"メイリオ"},{name:"MS PGothic",family:"'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"ＭＳ Ｐゴシック"},{name:"MS PMincho",family:"'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif",localizedName:"ＭＳ Ｐ明朝"},{name:"Yu Gothic",family:"'Yu Gothic','游ゴシック','YuGothic',sans-serif",localizedName:"游ゴシック"},{name:"Yu Mincho",family:"'Yu Mincho','游明朝','YuMincho',serif",localizedName:"游明朝"},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif",localizedName:"맑은 고딕"},{name:"Gulim",family:"Gulim,'굴림','Nanum Gothic',sans-serif",localizedName:"굴림"},{name:"Dotum",family:"Dotum,'돋움',AppleGothic,sans-serif",localizedName:"돋움"},{name:"Batang",family:"Batang,'바탕',AppleMyungjo,serif",localizedName:"바탕"},{name:"BatangChe",family:"BatangChe,'바탕체',AppleMyungjo,serif",localizedName:"바탕체"},{name:"Gungsuh",family:"Gungsuh,'궁서',GungSeo,serif",localizedName:"궁서"},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function r(e){for(var a=e.toUpperCase(),n=0;n<i.length;n++){var t=i[n];if(t.name.toUpperCase()==a||t.localizedName&&t.localizedName.toUpperCase()==a)return t.family}return null}var o="pt",l=[8,10,12,14,18,24,36],s=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],c=s.map(function(e){return e.toString()});function u(e){return"number"==typeof e&&e<=7?l[e-1]:e}function m(e){var a=u(e).toString();return a?a+o:a}n.d(a,"g",function(){return t}),n.d(a,"a",function(){return i}),n.d(a,"d",function(){return r}),n.d(a,"b",function(){return s}),n.d(a,"c",function(){return c}),n.d(a,"e",function(){return u}),n.d(a,"f",function(){return m})},1568:function(e,a,n){"use strict";n.d(a,"a",function(){return l}),n.d(a,"b",function(){return s});var t=n(0),i=n(7),r=n(1324),o={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function l(){var e=Object(i.a)().UserOptions;return e?s(e.ComposeFontName,e.ComposeFontSize,e.ComposeFontColor,e.ComposeFontFlags):o}function s(e,a,n,i){var l=t.__assign({},o),s=e?Object(r.d)(e):null;s&&(l.fontFamily=s);var c=a?Object(r.f)(a):null;return c&&(l.fontSize=c),n&&(l.textColor=n),i&&(l.bold=1==(1&i),l.italic=2==(2&i),l.underline=4==(4&i)),l}},1696:function(e,a,n){"use strict";var t=n(0),i=n(789),r=n(66),o=n(173),l=n(30),s=n(124),c=n(12),u=n(89),m=(n(217),n(96));a.a=Object(l.b)("newMessage",i.a.MailComposeNew)(function(e,a,n,i,l,d){return t.__awaiter(this,void 0,void 0,function(){var f,y,p,h,b,w;return t.__generator(this,function(g){switch(g.label){case 0:return(f=d?r.a.Popout:Object(s.a)()&&!Object(m.s)()?r.a.SecondaryTab:r.a.PrimaryReadingPane)!==r.a.PrimaryReadingPane?[3,2]:[4,r.z.importAndExecute(null)];case 1:g.sent(),g.label=2;case 2:return y=Object(r.e)(),p=[],n&&p.push.apply(p,t.__spread(n)),h=Object(u.a)(),(b=Object(c.m)())&&b.addCustomData({composeTraceId:h,actionSource:e}),w={operation:0,bodyType:y,to:p,preferAsyncSend:!0,subject:i,newContent:l,logTraceId:h},[4,r.t.importAndExecute(w,f,a)];case 3:return g.sent(),Object(o.j)(f===r.a.SecondaryTab),[2]}})})})},268:function(e,a,n){"use strict";n.d(a,"c",function(){return r}),n.d(a,"b",function(){return o}),n.d(a,"h",function(){return l}),n.d(a,"g",function(){return s}),n.d(a,"f",function(){return c}),n.d(a,"d",function(){return u}),n.d(a,"e",function(){return m}),n.d(a,"a",function(){return d});var t=n(0),i=n(270),r="deeplink",o="compose",l="reply",s="replyall",c="read",u="group",m="/"+t.__spread(["mail"],Object(i.a)().split("/").slice(1)).join("/")+r+"/",d="/"+t.__spread(["calendar"],Object(i.a)().split("/").slice(1)).join("/")+r+"/"},2919:function(e,a,n){"use strict";function t(e){var a=e?e.RightsManagementLicenseData:null,n={ReplyAllowed:!0,ReplyAllAllowed:!0,ForwardAllowed:!0,PrintAllowed:!0,CopyAllowed:!0};!a||a.RightsManagedMessageDecryptionStatus&&0!=a.RightsManagedMessageDecryptionStatus||(n={ReplyAllowed:a.ReplyAllowed,ReplyAllAllowed:a.ReplyAllAllowed,ForwardAllowed:a.ForwardAllowed,PrintAllowed:a.PrintAllowed,CopyAllowed:a.ExtractAllowed});var t=e&&e.DoNotForwardMeeting;return n.ForwardAllowed=n.ForwardAllowed&&!t,n}n.d(a,"a",function(){return t})},548:function(e,a,n){"use strict";n.d(a,"a",function(){return i});var t=n(139);function i(e,a,n){var i={pathname:e+a,search:n};return t.format(i)}},7015:function(e,a,n){"use strict";n.r(a);var t=n(1696),i=n(0),r=n(127),o=n(22),l=n(2919);function s(e,a,n){var t=o.a.items.get(e),i=Object(l.a)(t);return!(a.PrintAllowed&&!i.PrintAllowed||a.ForwardAllowed&&!i.ForwardAllowed||a.ReplyAllowed&&!i.ReplyAllowed||a.ReplyAllAllowed&&!i.ReplyAllAllowed)||(Object(r.b)(null,n,!1,{hideCancelButton:!0}),!1)}var c=n(972),u=n(66),m=n(173),d=n(241),f=n(13),y=n(20),p=n(8),h=n.n(p),b=function(e,a){var n=f.A.items.get(e);if(!Object(d.a)(n))return!0;var t=Object(y.format)(h.a.irm_actionNotAllowedOnThisConversation,a);return Object(r.b)(null,t,!1,{hideCancelButton:!0}),!1},w=n(4),g=Object(w.action)("forwardConversation")(function(e,a,n,t){return i.__awaiter(this,void 0,void 0,function(){var r,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Object(c.a)(e)];case 1:return(r=i.sent())&&r.Id&&(o={ForwardAllowed:!0},s(r.Id,o,Object(y.format)(h.a.irm_actionNotAllowedOnThisConversation,h.a.itemHeaderForward))&&b(r.Id,h.a.itemHeaderForward)&&(u.n.importAndExecute(r,a,n,t),m.e.importAndExecute())),[2]}})})}),v=n(279),A=Object(w.action)("forwardItem")(function(e,a,n,t){return i.__awaiter(this,void 0,void 0,function(){var r,o,l,c;return i.__generator(this,function(i){switch(i.label){case 0:return r={ForwardAllowed:!0},o=f.A.items.get(e.Id),(c=!Object(d.a)(o))?[3,3]:[4,v.b.import()];case 1:return[4,i.sent()(e.Id,h.a.itemHeaderForward)];case 2:c=i.sent(),i.label=3;case 3:return l=c,s(e.Id,r,Object(y.format)(h.a.irm_actionNotAllowedOnThisItem,h.a.itemHeaderForward))&&l&&(u.n.importAndExecute(e,a,n,t),m.e.importAndExecute()),[2]}})})}),C=n(87),N=Object(w.action)("printConversation")(function(e,a){return i.__awaiter(this,void 0,void 0,function(){var n,t;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Object(c.a)(e)];case 1:return(n=i.sent())&&n.Id&&(t={PrintAllowed:!0},s(n.Id,t,Object(y.format)(h.a.irm_actionNotAllowedOnThisConversation,h.a.itemHeaderPrint))&&(C.j.importAndExecute(n,a),Object(m.k)())),[2]}})})}),S=Object(w.action)("printItem")(function(e,a){return i.__awaiter(this,void 0,void 0,function(){var n;return i.__generator(this,function(t){return n={PrintAllowed:!0},s(e.Id,n,Object(y.format)(h.a.irm_actionNotAllowedOnThisItem,h.a.itemHeaderPrint))&&(C.j.importAndExecute(e,a),Object(m.k)()),[2]})})}),O=Object(w.action)("replyToConversation")(function(e,a,n,t,r,o,l,d){return i.__awaiter(this,void 0,void 0,function(){var f,p,w,g;return i.__generator(this,function(i){switch(i.label){case 0:return[4,Object(c.a)(e)];case 1:return(f=i.sent())&&f.Id&&(p={ReplyAllAllowed:a,ReplyAllowed:!a},w=a?h.a.itemHeaderReplyAll:h.a.itemHeaderReply,s(f.Id,p,Object(y.format)(h.a.irm_actionNotAllowedOnThisConversation,w))&&b(f.Id,w))?(g=u.w.importAndExecute({referenceItemId:f,isReplyAll:a,useFullCompose:r,actionSource:n,instrumentationContexts:t,conversationId:r?null:e.Id,initialComposeLogTraceId:l,onComposeViewStateCreated:d,suppressServerMarkReadOnReplyOrForward:o}),m.e.importAndExecute(),[2,g]):[2]}})})}),M=Object(w.action)("replyToItem")(function(e,a,n,t,r){return i.__awaiter(this,void 0,void 0,function(){var o,l,c,p,b;return i.__generator(this,function(i){switch(i.label){case 0:return o={ReplyAllAllowed:a,ReplyAllowed:!a},l=a?h.a.itemHeaderReplyAll:h.a.itemHeaderReply,c=f.A.items.get(e.Id),(b=!Object(d.a)(c))?[3,3]:[4,v.b.import()];case 1:return[4,i.sent()(e.Id,l)];case 2:b=i.sent(),i.label=3;case 3:return p=b,s(e.Id,o,Object(y.format)(h.a.irm_actionNotAllowedOnThisItem,l))&&p&&(u.w.importAndExecute({referenceItemId:e,isReplyAll:a,useFullCompose:!0,actionSource:t,instrumentationContexts:n,suppressServerMarkReadOnReplyOrForward:r}),m.e.importAndExecute()),[2]}})})}),I=n(1270),j=n(6),T=n(1275),_=n(704),R=n(11),x="userQuote",F="smartReply",G=Object(w.action)("replyWithText")(function(e,a,n,t){return i.__awaiter(this,void 0,void 0,function(){var r,o,l,s,c,m,d,f,y;return i.__generator(this,function(i){switch(i.label){case 0:return r=function(e){switch(e){case 0:return x;case 1:return F;default:return R.c.warn("replyWithText_getElementClassName: Unsupported feature inputted"),""}}(t),o=r+Math.round(1e6*Math.random()).toString(),l=Object(u.e)()===u.b,s=function(e,a,n){switch(e){case 0:return function(e,a){var n=document.createElement("blockquote");n.id=e,n.className=x,n.style.borderLeft="3px solid #C8C8C8",n.style.paddingLeft="1ex",n.style.marginLeft="0.8ex",n.style.color="#666666",n.innerHTML=a+"<br/>";var t=document.createElement("div");return t.appendChild(document.createElement("br")),t.appendChild(n),t.appendChild(document.createElement("br")),t.innerHTML}(a,n);case 1:return function(e,a){var n=document.createElement("span");n.id=e,n.innerText=a;var t=document.createElement("div");return t.appendChild(n),t.innerHTML}(a,n);default:return R.c.warn("replyWithText_createHtmlForText: Unsupported feature inputted"),""}}(t,o,n),c=l?n:Object(I.a)(s),m=Object(u.d)(a),d=null,m?(d=m,[3,4]):[3,1];case 1:return[4,u.x.import()];case 2:return[4,i.sent()({referenceItemOrId:e,isReplyAll:!0,useFullCompose:1==H()||Object(T.a)()||Object(_.a)(),conversationId:a,body:c,instrumentationContexts:[]})];case 3:d=i.sent(),i.label=4;case 4:return d?[4,u.m.tryImportSync()]:[3,6];case 5:(f=i.sent())&&(y=f(d))&&y.contentOperationPlugin&&(m?y.contentOperationPlugin.insertContentIntoEditor(l?n:s,function(e){switch(e){case 0:return"UserHighlighting";case 1:return"SmartReply";default:return R.c.warn("replyWithText_getEventName: Unsupported feature inputted"),""}}(t),!1,!0):l||y.contentOperationPlugin.moveCaretBelowHtmlElement(o)),i.label=6;case 6:return[2]}})})});function H(){var e=null,a=Object(j.x)();return a&&a.tableQuery&&(e=a.tableQuery.listViewType),e}var L=n(1255),P=Object(w.action)("showConversationInImmersiveReader")(function(e,a){return i.__awaiter(this,void 0,void 0,function(){var n;return i.__generator(this,function(t){switch(t.label){case 0:return[4,Object(c.a)(e)];case 1:return(n=t.sent())&&Object(L.a)(n,a),[2]}})})});n.d(a,"newMessage",function(){return t.a}),n.d(a,"forwardConversation",function(){return g}),n.d(a,"forwardItem",function(){return A}),n.d(a,"printConversation",function(){return N}),n.d(a,"printItem",function(){return S}),n.d(a,"replyToConversation",function(){return O}),n.d(a,"replyToItem",function(){return M}),n.d(a,"replyWithText",function(){return G}),n.d(a,"showConversationInImmersiveReader",function(){return P})},704:function(e,a,n){"use strict";var t=n(268);function i(){return(location?location.pathname:"").split("/").indexOf(t.c)>=0}n(45),n(548);n(1229),n(1316);n.d(a,"a",function(){return i})}},0,[0,5,6,14,209,1,3,4,162,10,17,193,279,51,280,57,283,80,72,182,236]]);
//# sourceMappingURL=owa.MailMessageActions.mail.js.map
window.scriptsLoaded['owa.MailMessageActions.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.MailMessageActions.mail.js'] = (new Date()).getTime();