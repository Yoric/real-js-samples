window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.ExpandedListSelectionActions.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[94],{3193:function(e,t,n){"use strict";var o=n(0),a=n(2424),i=n(1258),r=n(746),s=n(66),d=n(358),c=n(4),u=n(6);t.a=Object(c.select)({composeViewState:function(){return s.c.viewStates.get(s.c.primaryComposeId)},conversationItems:function(){return u.H.conversationItems}})(Object(c.action)("reloadReadingPane")(function(e){var t=Object(u.x)(),n=t?o.__spread(t.selectedRowKeys.keys()):[];if(1==n.length){var c=u.b.getRowClientItemId(n[0],t),v=Object(d.a)(n,t)[0];switch(t.tableQuery.listViewType){case 0:var l=e.conversationItems.get(c.Id);e.composeViewState&&e.composeViewState.isInlineCompose?s.z.importAndExecute(e.composeViewState).then(function(){Object(a.b)(c,v,l.subject)}):Object(a.b)(c,v,l.subject);break;case 1:e.composeViewState&&e.composeViewState.isInlineCompose?s.z.importAndExecute(e.composeViewState).then(function(){Object(i.a)(c,v,r.a)}):Object(i.a)(c,v,r.a)}}}))},3543:function(e,t,n){"use strict";var o=n(1);t.a=Object(o.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}})},3755:function(e,t,n){"use strict";var o=n(1);t.a=Object(o.action)("ON_ITEM_PART_SELECTED",function(e,t){return{conversationNodeId:e,conversationId:t}})},3830:function(e,t,n){"use strict";var o=n(1),a=Object(o.action)("ON_CONVERSATION_OPTION_SAVED");t.a=a},7083:function(e,t,n){"use strict";n.r(t);var o=n(22),a=n(11),i=n(20),r=n(6),s=n(9);function d(e,t){var n=function(e){var t={},n=o.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){a.c.error("Invalid loop found in ParentInternetMessageId pointers");break}if(t[n.internetMessageId]=!0,Object(i.isStringNullOrWhiteSpace)(n.parentInternetMessageId))break;n=o.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new s.ObservableMap({});return t.forEach(function(t){var a=o.a.conversationNodes.get(t),i=t===e?r.a.CheckMark:r.a.None;n.set(a.internetMessageId,i)}),n}(e,t);for(var d=new s.ObservableMap({}),c=!1,u=!1,v=0,l=0;l<t.length;l++){var w=o.a.conversationNodes.get(t[l]);n[w.internetMessageId]?(c?v+1===Object.keys(n).length?(d.set(w.internetMessageId,r.a.BusEnd),u=!0):d.set(w.internetMessageId,r.a.BusStop):(d.set(w.internetMessageId,r.a.BusStart),c=!0),v++):!c||u?d.set(w.internetMessageId,r.a.None):d.set(w.internetMessageId,r.a.NoStop)}return d}var c=n(82),u=n(26),v=n(3543),l=n(13),w=n(1);function p(){u.a.expandedConversationViewState.expandedRowKey=null,u.a.expandedConversationViewState.selectedNodeIds=[],u.a.expandedConversationViewState.shouldBeExpanded=!1,u.a.expandedConversationViewState.busStopStateMap=new s.ObservableMap({})}Object(w.mutator)(c.t,function(e){var t=e.nodeId,n=e.allNodeIds,o=u.a.expandedConversationViewState.selectedNodeIds;o.indexOf(t)>-1?(o.splice(o.indexOf(t),1),1===o.length&&(u.a.expandedConversationViewState.busStopStateMap=d(o[0],n))):o.push(t)}),Object(w.mutator)(c.h,function(e){u.a.expandedConversationViewState.busStopStateMap=new s.ObservableMap({})}),Object(w.mutator)(c.q,function(e){var t=e.rowKey,n=e.nodeIdToSelect,o=e.allNodeIds;u.a.expandedConversationViewState.expandedRowKey=t,u.a.expandedConversationViewState.selectedNodeIds=[n],u.a.expandedConversationViewState.busStopStateMap=d(n,o)}),Object(w.mutator)(c.u,function(e){var t=u.a.expandedConversationViewState;e.mailListItemSelectionSource==l.e.MailListItemCheckbox&&t.expandedRowKey!=e.rowKey&&p()}),Object(w.mutator)(c.p,function(e){var t=u.a.expandedConversationViewState;e.shouldSelect||t.expandedRowKey!=e.rowKey||p()}),Object(w.mutator)(c.i,function(e){p()}),Object(w.mutator)(c.k,function(e){p()}),Object(w.mutator)(c.r,function(e){var t=u.a.expandedConversationViewState;e.mailListItemSelectionSource==l.e.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)}),Object(w.mutator)(c.o,function(e){u.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded}),Object(w.mutator)(v.a,function(e){if(1===u.a.expandedConversationViewState.selectedNodeIds.length){var t=u.a.expandedConversationViewState.selectedNodeIds[0],n=l.A.conversations.get(e.conversationId).conversationNodeIds;u.a.expandedConversationViewState.busStopStateMap=d(t,n)}});var b=n(0),I=n(1511),f=n(173),O=n(87),S=n(2092);Object(w.orchestrator)(c.a,function(e){x(e.itemId,e.tableView,e.nodeId,e.allNodeIds,l.e.MailListItemExpansion)});function x(e,t,n,o,a){Object(f.i)(t,!0,a),O.n.importAndExecute(e),c.q(r.H.expandedConversationViewState.expandedRowKey,n,o,t.id)}function m(e,t){var n,o,a=r.b.getConversationId(e,t),i=l.A.conversations.get(a);try{for(var s=b.__values(i.conversationNodeIds),d=s.next();!d.done;d=s.next()){var c=d.value,u=Object(S.b)(c);if(u){x(u.ItemId.Id,t,c,i.conversationNodeIds,l.e.RowRemoval);break}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}}function j(e,t){c.o(!1),m(e,t)}function V(){c.i()}Object(w.orchestrator)(c.e,function(e){if(e.mailListItemSelectionSource==l.e.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");Object(I.a)(e.rowKey)?V():j(e.rowKey,e.tableView)}}),Object(w.orchestrator)(c.c,function(e){Object(I.a)(e.rowKey)||j(e.rowKey,e.tableView)}),Object(w.orchestrator)(c.b,function(e){Object(I.a)(e.rowKey)&&V()}),Object(w.orchestrator)(c.l,function(e){for(var t=r.b.getConversationId(e.rowKey,e.tableView),n=l.A.conversations.get(t),o=null,a=null,i=n.conversationNodeIds.indexOf(r.H.expandedConversationViewState.selectedNodeIds[0])+1;i<n.conversationNodeIds.length;i++){var s=n.conversationNodeIds[i],d=Object(S.b)(s);if(d){a=d.ItemId.Id,o=s;break}}o?x(a,e.tableView,o,n.conversationNodeIds,l.e.RowRemoval):m(e.rowKey,e.tableView)});var g=n(3193),N=n(3830),h=(Object(w.orchestrator)(N.a,function(e){Object(g.a)(),1===Object(r.z)().expandedConversationViewState.selectedNodeIds.length&&c.h()}),n(3755)),y=n(518);Object(w.orchestrator)(h.a,function(e){if(r.H.expandedConversationViewState.expandedRowKey){var t=l.A.conversations.get(e.conversationId);c.q(r.H.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(y.a)())}})}},0,[0,5,6,14,209,19,179,2,3,8,9,66,1,4,162,10,17,193,7,23,62,279,51,280,57,283,80,72,100,182,236]]);
//# sourceMappingURL=owa.ExpandedListSelectionActions.mail.js.map
window.scriptsLoaded['owa.ExpandedListSelectionActions.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.ExpandedListSelectionActions.mail.js'] = (new Date()).getTime();