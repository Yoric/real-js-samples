window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.RecipientCache.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[210],{1318:function(e,t,n){"use strict";var r=n(1),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=i},1986:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(7),i=n(5);function a(){var e=Object(r.a)(),t=e&&e.SessionSettings&&e.SessionSettings.IsExplicitLogon;return(Object(i.d)("rp-3SPeopleSuggestions")||Object(i.d)("rp-linkedInPeopleSuggestions"))&&!t}},2308:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId"]},2394:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(20),i=n(942);function a(e,t){var n=e.EmailAddresses?e.EmailAddresses[0]:null;if(!t&&Object(i.b)().sessionMaskedRecipients[n])return null;var a={EmailAddress:n,Name:Object(r.isStringNullOrWhiteSpace)(e.DisplayName)?e.Text:e.DisplayName,MailboxType:u(e.PeopleSubtype),RoutingType:s(e.PeopleSubtype),ItemId:e.PDLItemId?{Id:e.PDLItemId,__type:"ItemId:#Exchange"}:null};return{EmailAddress:a,EmailAddresses:[a],DisplayName:e.DisplayName,PersonaTypeString:o(e.PeopleSubtype),ADObjectId:e.ADObjectId,PersonaId:{Id:e.PersonaId},FeatureData:e.FeatureData,Id:e.Id}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function o(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function u(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}},2396:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},7074:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2396),a=n(5),s=n(904),o=n.n(s),u=n(560),c=n.n(u),l=n(731),d=n.n(l),p=n(355),f=n.n(p),I=n(732),b=n.n(I),h=n(33),P=n.n(h),m=n(733),y=n.n(m),v=n(31),g=500,S="owa.react.compose";function O(){if(Object(a.d)("rp-requestPersonaResponseShape")){var e=b()({BaseShape:"IdOnly",AdditionalProperties:[P()({FieldURI:"PersonaEmailAddress"}),P()({FieldURI:"EmailAddresses"}),P()({FieldURI:"PersonaDisplayName"}),P()({FieldURI:"PersonaDisplayNames"}),P()({FieldURI:"PersonaId"}),P()({FieldURI:"PersonaType"})]});return Object(a.d)("rp-3SLocalSearchRanking")&&e.AdditionalProperties.push(P()({FieldURI:"FeatureData"})),e}return b()({BaseShape:"Default"})}function D(){var e=d()({IndexedPageItemView:f()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:g}),PersonaShape:O(),QuerySources:["Mailbox"],QueryString:"",SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:[o()({Key:"AppName",Value:"OWA"}),o()({Key:"AppScenario",Value:S})]});return y()(c()({Header:Object(v.getJsonRequestHeader)(),Body:e})).then(function(e){return e.Body})}var w=n(89),A=n(56),j=n(2308),E="/search/api/v1/suggestions?",_="owa.react.recipientcache",R=500;function L(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,C()];case 1:return e=n.sent(),t=function(e){return{AppName:"OWA",Scenario:{Name:_},Cvid:Object(w.a)(),EntityRequests:[e]}}(e),[2,Object(A.d)(E,t,null,!1,null,!0).then(function(e){return e},function(e){throw new Error(e.message)})]}})})}function C(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){return[2,{Query:{QueryString:""},EntityType:"People",Provenances:["Mailbox"],Size:R,Fields:j.a}]})})}var x=n(2394),U=n(11),N=n(30),F=Object(N.b)("tryInitializeCacheWithSource",{name:"RecipientCacheInitialization",custonData:function(e,t){return[e,t]}})(function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var t,a,s,o;return r.__generator(this,function(u){switch(u.label){case 0:switch(u.trys.push([0,6,,7]),t=void 0,e){case 0:return[3,1];case 1:return[3,3]}return[3,5];case 1:return[4,L()];case 2:return a=u.sent(),t=function(e){var t,n,i=[];if(!e||!e.Groups)throw new Error("Response groups should not be null");try{for(var a=r.__values(e.Groups),s=a.next();!s.done;s=a.next()){var o=s.value;if("People"===o.Type){i=o.Suggestions.map(function(e){return Object(x.a)(e)});break}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i}(a),[3,5];case 3:return[4,D()];case 4:return s=u.sent(),t=s.ResultSet,[3,5];case 5:return t&&(t.forEach(function(e){var t=Object(i.a)(e);t&&(n.store.allKeys[t]=!0)}),n.store.recipientCache=t),[3,7];case 6:return o=u.sent(),U.c.error(o.message),[3,7];case 7:return[2]}})})});var G=n(1318),M=n(1986),k=n(4),z=Object(k.action)("initializeCache")(Object(k.select)({store:function(){return G.a}})(function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return t=Object(M.a)(),[4,F(t?0:1,!1,e)];case 1:return n.sent(),!t||e.store.recipientCache?[3,3]:[4,F(1,!0,e)];case 2:n.sent(),n.label=3;case 3:return e.store.recipientCache||(e.store.recipientCache=[]),[2]}})})}));n.d(t,"initializeCache",function(){return z})}},0,[279,51]]);
//# sourceMappingURL=owa.RecipientCache.mail.js.map
window.scriptsLoaded['owa.RecipientCache.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.RecipientCache.mail.js'] = (new Date()).getTime();