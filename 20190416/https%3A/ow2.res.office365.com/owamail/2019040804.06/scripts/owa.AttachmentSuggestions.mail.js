window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.AttachmentSuggestions.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[65],{1777:function(e,t,r){"use strict";r.r(t);var n=r(1),o=Object(n.action)("getAttachmentSuggestionsAction",function(e){return{referenceItemId:e}}),i=r(13),a=Object(n.action)("storeAttachmentSuggestionsOnItemAction",function(e,t){return{referenceItemId:e,attachmentSuggestions:t}}),c=(Object(n.mutator)(a,function(e){var t=i.A.items.get(e.referenceItemId);t&&(t.AttachmentSuggestions=e.attachmentSuggestions)}),r(1042)),u=Object(n.action)("storeMRUSuggestionsAction",function(e){return{mruAttachments:e}}),s=(Object(n.mutator)(u,function(e){Object(c.a)().attachments=e.mruAttachments}),Object(n.action)("getMRUSuggestionsAction")),l=Object(n.action)("getReplyWithSuggestionsAction",function(e){return{referenceItemId:e}}),d=r(5);Object(n.orchestrator)(o,function(e){(Object(d.d)("mc-replyWith")||Object(d.d)("mc-replyWithNAMPrime")||Object(d.d)("mc-replyWithContextual"))&&l(e.referenceItemId),(Object(d.d)("mc-replyWith")||Object(d.d)("mc-replyWithNAMPrime")||Object(d.d)("mc-replyWithMRUClassic")||Object(d.d)("mc-replyWithMRUCloudy"))&&s()});var f=r(0),h=r(11);function p(e){try{var t=!!e.Source.LastShared&&!e.Source.WebUrl,r=e.Source.Author?e.Source.Author.DisplayName:"";return{Author:r,CreatedBy:r,DateAccessed:e.Source.LastAccessDateTime,DateCreated:null,DateModified:e.Source.LastModifiedDateTime,Endpoint:t?2:1,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:t?e.Source.LastShared.AttachmentId:e.Id,ModifiedBy:m(e),ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Text:e.Source.Title,Title:e.Source.Title,Url:e.Source.Url}}catch(e){return h.c.error("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+e.message),null}}function m(e){return e.Source.LastModifiedBy?e.Source.LastModifiedBy.DisplayName:e.Source.LastShared.SharedBy.DisplayName}var v=r(12),b=r(515),g=r(359),y="application/json;charset=utf-8",O="https://substrate.office.com/search/api/v1/recommendations",_="recEnableSharedClassicAttachments",w="maxMRUFiles1";function A(){return f.__awaiter(this,void 0,void 0,function(){var e,t,r,n,o,i,a,c,u,s,l,m;return f.__generator(this,function(f){switch(f.label){case 0:e=null,t=0,r="",n=null,f.label=1;case 1:return f.trys.push([1,7,8,9]),Object(v.k)("MRUQueryExecuted"),n=new v.a("QueryResponseInformation",{logVerbose:!0}),o=!1,i=1,Object(d.d)("mc-replyWithMRUClassic")&&(o=!0,i=2),n.addCustomData({endpoint:i}),[4,P()];case 2:return a=f.sent(),c=function(e,t){var r={};r.headers=new Headers,r.headers.set("Authorization","Bearer "+e),r.headers.set("Content-Type",y),r.method="POST";var n=Object(b.getDefaultAnchorMailboxCookie)();n&&r.headers.append("X-AnchorMailbox",n);if(r.headers.set("X-Client-LocalTime",(new Date).toISOString()),t){var o=_;Object(d.d)("mc-replyWithMRUCloudyLimited")&&(o+=","+w),r.headers.set("X-Client-Flights",o)}return r.body=JSON.stringify({EntityRequests:[{}],Scenario:{Name:"AttachFile"}}),r}(a,o),n.addCheckmark("Request"),[4,fetch(O,c)];case 3:return u=f.sent(),n.addCheckmark("Response"),u&&200==u.status?[4,u.text()]:[3,5];case 4:return s=f.sent(),l=JSON.parse(s),e=function(e){try{var t=e.EntitySets[0].ResultSets[0].Results;return t.map(p)}catch(e){return h.c.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),[]}}(l),t=e.length,[3,6];case 5:r=u?u.status+"-"+u.statusText:"No response",f.label=6;case 6:return[3,9];case 7:return m=f.sent(),r=m.message,[3,9];case 8:return r&&h.c.info("getMRUSuggestions: Error "+r),n.addCustomData({numResults:t}),r?n.endWithError("ServerError",new Error(r)):n.end(),[2,e];case 9:return[2]}})})}function P(){return f.__awaiter(this,void 0,void 0,function(){var e,t,r;return f.__generator(this,function(n){switch(n.label){case 0:return e=f.__read(Object(g.c)(window.location.origin),2),t=e[0],r=e[1],t?[3,2]:[4,r];case 1:t=n.sent(),n.label=2;case 2:return[2,t]}})})}Object(n.orchestrator)(s,function(){return f.__awaiter(this,void 0,void 0,function(){var e;return f.__generator(this,function(t){switch(t.label){case 0:return[4,A()];case 1:return(e=t.sent())&&u(e),[2]}})})});var I=r(351),S=r(352),j=r(119),E=r.n(j),C=r(187),R=r.n(C),D="EntityExtraction/Highlights_Delayed",T="EntityExtraction/ReplyWithQueryCoverage",x=E()({PropertyName:D,DistinguishedPropertySetId:"Common",PropertyType:"String"}),M=E()({PropertyName:T,DistinguishedPropertySetId:"Common",PropertyType:"String"});function N(e){return f.__awaiter(this,void 0,void 0,function(){var t,r,n,o,i;return f.__generator(this,function(a){switch(a.label){case 0:return null!=(t=F(e)).HighlightsDelayed||null!=t.ReplyWithQueryCoverage?[3,2]:(r=R()({BaseShape:"IdOnly",AdditionalProperties:[x,M]}),[4,Object(I.a)([e.ItemId.Id],r,null,null,e.MailboxInfo&&e.MailboxInfo.requestOptions)]);case 1:n=a.sent(),Object(S.a)(n[0])&&((o=n[0])&&o.Items&&o.Items[0]?(i=o.Items[0],t=F(i)):h.c.info("getReplyWithProperties: Unable to parse GetItem response properly.")),a.label=2;case 2:return[2,t]}})})}function F(e){var t={HighlightsDelayed:null,ReplyWithQueryCoverage:null},r=e.ExtendedProperty;if(r)for(var n=r.length,o=0;o<n;o++){var i=r[o];i.ExtendedFieldURI.PropertyName===D?t.HighlightsDelayed=i:i.ExtendedFieldURI.PropertyName===T&&(t.ReplyWithQueryCoverage=i)}return t}var U=r(56),L="ContentRequest",W="/ows/search/api/v1/";function k(e){return f.__awaiter(this,void 0,void 0,function(){var t,r,n,o,i=this;return f.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t=function(e){var t={},r=function(e){var t=[];if(null!=e.ReplyWithQueryCoverage)for(var r=JSON.parse(e.ReplyWithQueryCoverage.Value)[0],n=r.coverageCheckResults,o=Object.keys(n),i=0;i<o.length;i++){var a=o[i];n[a]||t.push(a)}return t}(e);return JSON.parse(e.HighlightsDelayed.Value)[0].sentences.forEach(function(e){var n=e.text;r.includes(n)||e.segments.forEach(function(e){if(e.segment==L){var r=e.actions[0].requests[0],o=function(e,t){for(var r,n,o=W+e,i=0;i<t.length;i++)r=t[i].Key,n=t[i].Value,o+=0==i?"?":"&",o+=r+"="+n;return o}(r.Endpoint,r.UrlParameters);t[n]=o}})}),t}(e),r={},(n=Object.keys(t)).length>0?(Object(v.k)("ReplyWithQueryExecuted"),[4,Promise.all(n.map(function(e){return f.__awaiter(i,void 0,void 0,function(){var n,o;return f.__generator(this,function(i){switch(i.label){case 0:return n=r,o=e,[4,z(t[e])];case 1:return[2,n[o]=i.sent()]}})})}))]):[3,2];case 1:return a.sent(),[2,B(r)];case 2:return[3,4];case 3:return o=a.sent(),h.c.info("Failed to parse property, error: "+o.message),[3,4];case 4:return[2,null]}})})}function z(e){return f.__awaiter(this,void 0,void 0,function(){var t,r,n,o,i;return f.__generator(this,function(a){switch(a.label){case 0:t=null,r=0,n="",o=null,a.label=1;case 1:return a.trys.push([1,3,4,5]),(o=new v.a("QueryResponseInformation")).addCustomData({endpoint:0}),[4,Object(U.b)(e)];case 2:return t=a.sent(),o.addCheckmark("Response"),t&&0!=t.length||(n="No response payload"),[3,5];case 3:return i=a.sent(),n=i.message,[3,5];case 4:return r=function(e){try{return e.Groups[0].Suggestions.length}catch(e){return 0}}(t),o.addCustomData({numResults:r}),n?o.endWithError("ServerError",new Error(n)):o.end(),[2,t];case 5:return[2]}})})}function B(e){try{var t={};return Object.keys(e).forEach(function(r){t[r]=e[r].Groups[0].Suggestions;for(var n=0;n<t[r].length;n++)t[r][n].Endpoint=0}),t}catch(e){return h.c.info("getSentenceToAttachmentSuggestionsMap: Failed to execute, error: "+e.message),null}}function G(e){return f.__awaiter(this,void 0,void 0,function(){var t,r;return f.__generator(this,function(n){switch(n.label){case 0:return t=null,[4,N(e)];case 1:return(r=n.sent())?[4,k(r)]:[3,3];case 2:t=n.sent(),n.label=3;case 3:return[2,t]}})})}Object(n.orchestrator)(l,function(e){return f.__awaiter(this,void 0,void 0,function(){var t,r,n;return f.__generator(this,function(o){switch(o.label){case 0:return t=e.referenceItemId,!(r=i.A.items.get(t))||r.AttachmentSuggestions?[3,2]:[4,G(r)];case 1:n=o.sent(),a(t,n),o.label=2;case 2:return[2]}})})});var V=r(697),X=r(2054);function Q(e,t){return f.__awaiter(this,void 0,void 0,function(){var r;return f.__generator(this,function(n){switch(n.label){case 0:return r=null,Object(X.i)()!==X.c.NotLoaded?[3,2]:[4,X.k.import()];case 1:return n.sent()(function(n){r=q(Object(X.g)(),e),t(r)}),[3,3];case 2:r=q(Object(X.g)(),e),t(r),n.label=3;case 3:return[2]}})})}function q(e,t){var r=function(e){for(var t=0;t<e.length;t++)if(0==e[t].type)return e[t].model.Id;return h.c.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:V.a.Cloud,name:t.FileName,size:null,providerId:r,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}r.d(t,"getAttachmentSuggestionsAction",function(){return o}),r.d(t,"createCloudFileFromAttachmentData",function(){return Q})},2048:function(e,t,r){"use strict";var n=r(1),o=r(9),i=r(2142),a={providers:new o.ObservableMap,loadState:i.a.NotLoaded,removalPending:new o.ObservableMap},c=Object(n.createStore)("fileProviderStoreV2",a);t.a=c},2053:function(e,t,r){"use strict";var n=r(0),o=r(2624),i=r.n(o),a=r(2361),c=r.n(a);function u(e){var t=c()({ProviderType:e});return i()(t)}var s=r(2625),l=r.n(s),d=r(2362),f=r.n(d);function h(e){var t=f()({ProviderType:e});return l()(t)}var p=r(2562),m=r(5);r.d(t,"a",function(){return w}),r.d(t,"b",function(){return I});var v="code",b="token",g=3e3;function y(e){return{state:e}}function O(e){return e.state}function _(e){return e.code}function w(e,t,r,o,i){var a={providerType:e,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:_};return function e(t,r,o,i,a,c){return n.__awaiter(this,void 0,void 0,function(){var s,l;return n.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),s=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,h(t)];case 1:return l=n.sent(),s=l.AttachmentDataProviderCreator.ProviderAppKey,o=l.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(t)];case 3:l=n.sent(),s=l.ProviderAppKey,n.label=4;case 4:return r.getAuthUrlInfo=Object(p.d)(t,o,i,s,a,c),[3,6];case 5:return n.sent(),setTimeout(function(){return e(t,r,o,i,a,c)},g),[3,6];case 6:return[2]}})})}(e,a,t,r,o,i),a}var A=null;function P(){if(!A){(A={})[3]=w(3,"https://app.box.com/api/oauth2/authorize",Object(p.c)(3),v,y),A[2]=w(2,"https://www.dropbox.com/oauth2/authorize",Object(p.b)(2),v,y);var e=w(6,"https://www.facebook.com/dialog/oauth",Object(p.b)(6),b,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=O,e.getOAuthCode=function(e){return e.access_token},A[6]=e;var t=w(5,"https://accounts.google.com/o/oauth2/auth",p.a+"/ADPRedirect.aspx",v,function(e){var t={state:e,provider:5..toString(),url:Object(p.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},A[5]=t,A[1]=w(1,"https://login.live.com/oauth20_authorize.srf",Object(p.c)(1),v,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(m.d)("doc-fileProvider-wopiClient")&&(A[7]=w(7,"",Object(p.c)(7),v,y),A[8]=w(8,"",Object(p.c)(8),v,y),A[9]=w(9,"",Object(p.c)(9),v,y))}return A}function I(e){var t=P();return e in t?t[e]:null}},2054:function(e,t,r){"use strict";var n=r(2305),o=r(2209),i=(r(2048),r(2061)),a=r(2081),c=(r(2502),r(2437),r(2072));var u=r(2175),s=r(2),l=r(2142),d=r(2053);r.d(t,"k",function(){return h}),r.d(t,"m",function(){return p}),r.d(t,"j",function(){return m}),r.d(t,"l",function(){return v}),r.d(t,"a",function(){return a.b}),r.d(t,"b",function(){return n.a}),r.d(t,"f",function(){return d.b}),r.d(t,"c",function(){return l.a}),r.d(t,"d",function(){return i.a}),r.d(t,"e",function(){return i.b}),r.d(t,"h",function(){return o.a}),r.d(t,"i",function(){return u.a}),r.d(t,"g",function(){return c.b}),r.d(t,"n",function(){return i.c});var f=new s.c(function(){return Promise.all([r.e(2),r.e(3),r.e(8),r.e(20),r.e(105)]).then(r.bind(null,7013))}),h=new s.b(f,function(e){return e.loadProviders}),p=new s.b(f,function(e){return e.removeFileProvider}),m=new s.b(f,function(e){return e.addFileProvider}),v=new s.b(f,function(e){return e.removeAndAddFileProvider})},2061:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o}),r.d(t,"c",function(){return a});var n=r(1),o=Object(n.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),i=Object(n.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),a=Object(n.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},2072:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return a});var n=r(0),o=r(2048),i=function(){return n.__spread(Object(o.a)().providers.values())},a=function(e){return Object(o.a)().providers.get(e)||null}},2081:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i}),r.d(t,"c",function(){return a});var n,o=r(0);!function(e){e[e.Groups=1e4]="Groups"}(n||(n={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(o.__spread(i,[0,4,10]))},2142:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(n||(n={}))},2175:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(2048);function o(){return Object(n.a)().loadState}},2209:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(129),o=r(8),i=r.n(o);function a(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:case 1:return i.a.OneDriveFileProviderDisplayName;case 2:case 9:return i.a.DropboxFileProviderDisplayName;case 3:case 7:return i.a.BoxFileProviderDisplayName;case 5:return i.a.GoogleDriveFileProviderDisplayName;case 6:return i.a.FacebookFileProviderDisplayName;case 4:return i.a.RecentAttachmentsFileProviderDisplayName;case 10:return i.a.MailMessageFileProviderDisplayName;case 8:return i.a.EgnyteFileProviderDisplayName;default:return Object(n.a)(e)}}},2305:function(e,t,r){"use strict";var n;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(n||(n={})),t.a=n},2361:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},2362:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},2437:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(7),o=r(47),i=r(129),a=r(5);function c(e){var t=Object(n.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.d)("doc-fileProvider-facebook");case 1:return!!Object(o.a)()||Object(a.d)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(a.d)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.d)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2502:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return i});var n=r(2081),o="file provider is not addable";function i(e){return n.a.indexOf(e)>-1}},2562:function(e,t,r){"use strict";function n(e,t,r){if(!e||!t||!r)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+r:e+"?"+t+"="+r}r.d(t,"a",function(){return o}),r.d(t,"b",function(){return i}),r.d(t,"c",function(){return a}),r.d(t,"d",function(){return c});var o="exchangelabs.live-int.com"===window.location.host?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function i(e){var t=e?encodeURIComponent("?provider="+e):"",r=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return window.location.protocol+"//"+window.location.host+"/mail/"+r+t}function a(e){var t=window.location.protocol+"//"+window.location.host+"/mail/AddFileProvider.html",r=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+r}function c(e,t,r,o,i,a){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,r=[],n=0;n<16;n++)r.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+r.join("")}(),c=n(t,"client_id",o);if(c=n(c,"redirect_uri",r),c=n(c,"response_type",i),a){var u=a(e);c=Object.keys(u).reduce(function(e,t){return n(e,t,u[t])},c)}return{authUrl:c,redirectUrl:r,csrfToken:e}}}},2624:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(51),o=r(2361);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),n.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},2625:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(51),o=r(2362);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),n.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},697:function(e,t,r){"use strict";var n;!function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem"}(n||(n={}));var o={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function i(e){switch(e?e.toLowerCase():null){case o.ONE_DRIVE_PRO.toLowerCase():return 0;case o.GDRIVE.toLowerCase():return 5;case o.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case o.DROPBOX.toLowerCase():return 2;case o.BOX.toLowerCase():return 3;case o.WOPI_BOX.toLowerCase():return 7;case o.WOPI_EGNYTE.toLowerCase():return 8;case o.MAILBOX.toLowerCase():return 4;case o.FACEBOOK.toLowerCase():return 6;default:return null}}function a(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:n.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function c(e){return null==e?null:{fileType:n.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function u(e){if(!e)return null;for(var t=[],r=0;r<e.length;r++){var o=e[r],i={fileType:n.Local,name:o.name,size:o.size,type:o.type,fileObject:o};t.push(i)}return t}function s(e,t){var r=[],o={fileType:n.MailItem,name:e,size:0,mimeContent:t};return r.push(o),r}var l=r(11);function d(e,t){if(e.length!=t.length)return l.c.error("The sizes of subjects and latestItemIds are different"),null;for(var r=[],o=0;o<e.length;o++){var i={fileType:n.MailItem,name:e[o],size:0,itemId:t[o]};r.push(i)}return r}var f=r(868);function h(e){return e.map(function(e){return{fileType:n.Uri,name:e.name,type:Object(f.a)(e.url),size:0,uri:e.url}})}r.d(t,"b",function(){return i}),r.d(t,"e",function(){return u}),r.d(t,"g",function(){return d}),r.d(t,"c",function(){return a}),r.d(t,"d",function(){return c}),r.d(t,"h",function(){return h}),r.d(t,"f",function(){return s}),r.d(t,"a",function(){return n})},868:function(e,t,r){"use strict";function n(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function o(e){var t=n(e);return t?t.replace(".",""):null}var i=r(8),a=r.n(i),c=r(20);function u(e){var t;return e>=1073741824?(e/=1073741824,t=a.a.sizeWithGigabyteAbbreviationText):e>=1048576?(e/=1048576,t=a.a.sizeWithMegabyteAbbreviationText):e>=1024?(e/=1024,t=a.a.sizeWithKilobyteAbbreviationText):t=a.a.sizeWithByteAbbreviationText,Object(c.format)(t,Math.round(e))}var s=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];function l(e){var t=n(e);return!!t&&s.indexOf(t.toLowerCase())>=0}var d=r(5),f=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function h(e){if(!Object(d.d)("doc-attachment-documentThumbnail"))return!1;var t=n(e);return!!t&&f.indexOf(t.toLowerCase())>=0}r.d(t,"a",function(){return n}),r.d(t,"b",function(){return o}),r.d(t,"e",function(){return u}),r.d(t,"c",function(){return l}),r.d(t,"d",function(){return h})}},0,[2,3,8,20,105,279,51,280,57,283,80]]);
//# sourceMappingURL=owa.AttachmentSuggestions.mail.js.map
window.scriptsLoaded['owa.AttachmentSuggestions.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.AttachmentSuggestions.mail.js'] = (new Date()).getTime();