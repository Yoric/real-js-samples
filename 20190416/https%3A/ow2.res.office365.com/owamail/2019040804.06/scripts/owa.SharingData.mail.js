window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.SharingData.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[226],{4156:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(0);n.default=function(e){return r.__assign({__type:"GetSharingInfoResponse:#Exchange"},e)}},4528:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(0);n.default=function(e){return r.__assign({__type:"GetSharingInfoRequest:#Exchange"},e)}},5659:function(e,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=i(51),t=i(4528);n.default=function(e,n){return void 0===e||e.__type||(e=t.default(e)),r.makeServiceRequest("GetSharingInformation",e,n)}},6978:function(e,n,i){"use strict";i.r(n);var r=i(0),t=i(56),a="ows/api/beta/sharinglink/info";function s(e,n){return void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(i){switch(i.label){case 0:return[4,Object(t.d)(a,{url:e},void 0,n)];case 1:return[2,i.sent()]}})})}var o,u,c=i(129),l=i(5),g=i(190),f=i(4528),h=i.n(f),m=i(4156),d=i.n(m),p=i(5659),S=i.n(p),x=i(11);function I(e){return Object(l.d)("doc-attachment-sharingLinkInfoOWSPrimeService")?function(e){return r.__awaiter(this,void 0,void 0,function(){var n,i,t,a,c,l,f,h,m,p,S,I;return r.__generator(this,function(E){switch(E.label){case 0:return[4,s(e,!0)];case 1:return n=E.sent(),Object(g.a)(n.status)?(a=(t=JSON).parse,[4,n.text()]):[3,3];case 2:if(function(e){return e.providerType===o.OneDrivePro}(i=a.apply(t,[E.sent()])))return c=r.__read(i.sharingLinks.filter(function(e){return e.type===u.AnonymousEdit}),1),l=c[0],f=r.__read(i.sharingLinks.filter(function(e){return e.type===u.AnonymousView}),1),h=f[0],m=r.__read(i.sharingLinks.filter(function(e){return e.type===u.OrganizationEdit}),1),p=m[0],S=r.__read(i.sharingLinks.filter(function(e){return e.type===u.OrganizationView}),1),I=S[0],[2,d()({AccessRequestMode:i.accessRequestMode,AnonymousEditLink:l?l.url:void 0,AnonymousViewLink:h?h.url:void 0,CanCreateAnonymousEditLink:i.canCreateAnonymousEditLink,CanCreateAnonymousViewLink:i.canCreateAnonymousViewLink,CanCreateOrganizationEditLink:i.canCreateOrganizationEditLink,CanCreateOrganizationViewLink:i.canCreateOrganizationViewLink,CanShareExternally:i.canShareExternally,CanShareInternally:i.canShareInternally,CanonicalUrl:i.canonicalUrl,ExpirationDate:i.expirationTime,FileName:i.name,IsAnonymousEditLinkAvailable:!!l,IsAnonymousViewLinkAvailable:!!h,IsOrganizationEditLinkAvailable:!!p,IsOrganizationViewLinkAvailable:!!I,MimeType:void 0,OrganizationEditLink:p?p.url:void 0,OrganizationViewLink:I?I.url:void 0,ResultCode:0,SharingLinkKind:L(i.linkType)})];throw new Error("Invalid response from OWS` from sharing link info");case 3:return 404===n.status?[2,d()({ResultCode:4})]:400===n.status?[2,d()({ResultCode:24})]:(x.c.warn("Invalid response for OWS' get share info. Status code: "+n.status),[2,d()({ResultCode:1})]);case 4:return[2]}})})}(e):S()(function(e){return h()({attachmentUrl:e})}(e))}function L(e){switch(e){case u.None:return 0;case u.View:case u.Edit:return 1;case u.AnonymousView:return 4;case u.AnonymousEdit:return 5;case u.OrganizationView:return 2;case u.OrganizationEdit:return 3;default:return Object(c.a)(e)}}!function(e){e.OneDrivePro="OneDrivePro"}(o||(o={})),function(e){e.None="None",e.View="View",e.Edit="Edit",e.AnonymousView="AnonymousView",e.AnonymousEdit="AnonymousEdit",e.OrganizationView="OrganizationView",e.OrganizationEdit="OrganizationEdit"}(u||(u={}));var E=i(1992),v=i(8),O=i.n(v);var P=i(2115),T=i(12);function k(e,n,i){if(1!==e.length||null===i)return null;switch(n){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.externalRecipientCSL:case E.a.sharingWithLargeDL:return e[0].supportsDownsell?[i(e[0].id)]:null;case E.a.getSharingInfoFailed:case E.a.noPermissionSet:return null;case E.a.linkHasExpired:case E.a.linkWillExpire:return function(e){return[{text:O.a.SuggestActionRefreshTheLink,action:function(){Object(P.a)(e.id),Object(T.k)("SharingTipsRefreshExpirationInfoBarClicked")}},{text:O.a.SuggestActionIgnoreExpiration,action:function(){e.sharingTipsIgnored.push(E.a.linkHasExpired),e.sharingTipsIgnored.push(E.a.linkWillExpire),Object(T.k)("SharingTipsIgnoreExpirationInfoBarClicked")}}]}(e[0]);default:return Object(c.a)(n)}}var b=i(826);function y(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&e.sharingInfo&&!e.sharingInfo.canShareExternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function w(e,n){return n.filter(function(e){return e.totalMemberCount>100}).length>0&&e.sharingInfo&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}function j(e){return e.sharingInfo&&!e.sharingInfo.getSharingInfoSucceeded}function C(e,n){return n.filter(function(e){return e.externalMemberCount>0}).length>0&&(6===e.currentPermissionLevel||5===e.currentPermissionLevel)}var F=i(475),A=i(397);function _(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(F.a)(e.sharingInfo.expirationDate,Object(A.a)())}var W=i(478);function R(e){return e&&e.sharingInfo&&!!e.sharingInfo.expirationDate&&Object(W.a)(e.sharingInfo.expirationDate,Object(A.a)())}function D(e){return e.sharingInfo&&e.sharingInfo.getSharingInfoSucceeded&&!e.sharingInfo.canShareInternally&&(2===e.currentPermissionLevel||1===e.currentPermissionLevel)}var V=i(2039);function z(e,n){return M(e.sharingInfo)?0===e.currentPermissionLevel&&!D(e):0===e.currentPermissionLevel&&function(e){return e.sharingInfo.recipientPermissionInfos.some(function(e){return!e.hasAccess&&e.getPermissionInfoStatus===V.a.Succeeded})}(e)}function M(e){return!Object(l.d)("doc-recipient-permission")||e.hasDLRecipient||function(e){return e.recipientPermissionInfos.some(function(e){return e.getPermissionInfoStatus===V.a.Failed})}(e)}var N=i(2114);var H=i(20);var B=function(e){return e?e.filter(function(e){return e.totalMemberCount>100}).map(function(e){return e.name}).join(", "):""};function q(e){if(M(e.sharingInfo))return O.a.WarningSharingWithoutSettingPermissionsText;var n=e.sharingInfo.recipientPermissionInfos.filter(function(e){return!e.hasAccess&&e.getPermissionInfoStatus}).length,i=function(e){return e.sharingInfo.recipientPermissionInfos.filter(function(e){return!e.hasAccess}).map(function(e){return e.name?e.name:e.emailAddress}).join(", ")}(e);return 1===n?Object(H.format)(O.a.SingleRecipientCannotAccessFileText,i,"{0}"):n<4?Object(H.format)(O.a.MultipleRecipientsCannotAccessFileText,i,"{0}"):O.a.WarningSharingWithoutSettingPermissionsText}function G(e,n,i,r){if(!function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.externalRecipientCSL:case E.a.noPermissionSet:case E.a.sharingWithLargeDL:return Object(l.d)("doc-attachment-sharingTips");case E.a.getSharingInfoFailed:return Object(l.d)("doc-attachment-sharingTips")&&Object(l.d)("doc-attachment-sharingInfoFailureTip");case E.a.linkWillExpire:case E.a.linkHasExpired:return Object(l.d)("doc-attachment-sharingTips")&&Object(l.d)("doc-attachment-expiringLinkImprovements");default:return Object(c.a)(e)}}(n))return null;var t=function(e){switch(e){case E.a.noPermissionToShare:return D;case E.a.getSharingInfoFailed:return j;case E.a.linkHasExpired:return _;case E.a.linkWillExpire:return R;case E.a.externalRecipientCSL:return C;case E.a.noPermissionToShareExternally:return y;case E.a.noPermissionSet:return z;case E.a.sharingWithLargeDL:return w;default:return Object(c.a)(e)}}(n),a=e.filter(function(e){return t(e,i)});if(0===a.length)return null;var s=a.filter(function(e){return!Object(H.isStringNullOrWhiteSpace)(e.name)}).map(function(e){return e.name}).join(", "),o=function(e,n,i){switch(e){case E.a.noPermissionToShare:return{singleFile:O.a.NoPermissionToShareText,multipleFiles:O.a.NoPermissionToShareText};case E.a.getSharingInfoFailed:return{singleFile:O.a.NoSharingInfoText,multipleFiles:O.a.NoSharingInfoText};case E.a.linkHasExpired:return{singleFile:O.a.SingleLinkIsExpiredText,multipleFiles:O.a.MultipleLinksAreExpiredText};case E.a.linkWillExpire:return{singleFile:O.a.SingleLinkWillExpireText,multipleFiles:O.a.MultipleLinksWillExpireText};case E.a.noPermissionToShareExternally:return{singleFile:O.a.NoPermissionToShareExternallyText,multipleFiles:O.a.NoPermissionToShareExternallyText};case E.a.externalRecipientCSL:return{singleFile:O.a.WarningSharingCSLWithExternalRecipientsText,multipleFiles:O.a.WarningSharingCSLWithExternalRecipientsText};case E.a.noPermissionSet:return{singleFile:q(i[0]),multipleFiles:O.a.WarningSharingWithoutSettingPermissionsText};case E.a.sharingWithLargeDL:var r=B(n);return{singleFile:Object(H.format)(O.a.NoPermissionBigDLRecipientsText,r,"{0}","{1}"),multipleFiles:Object(H.format)(O.a.NoPermissionBigDLRecipientsText,r,"{0}","{1}")};default:return Object(c.a)(e)}}(n,i,a),u=a.length>1?o.multipleFiles:o.singleFile;s&&0!==s.length||!u||0===u.length||x.c.error("file names should not be null or empty if the infobarStringTemplate is not");var g,f=k(a,n,r),h=function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.getSharingInfoFailed:return[N.a.ignore];case E.a.externalRecipientCSL:case E.a.noPermissionSet:case E.a.sharingWithLargeDL:return[N.a.ignore,N.a.changePermission];case E.a.linkWillExpire:case E.a.linkHasExpired:return[N.a.ignore,N.a.refreshExpiration];default:return Object(c.a)(e)}}(n);if(null!==f&&0!==f.length)g=Object(H.format)(u,s);else{var m="",d=function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.externalRecipientCSL:return{singleFile:O.a.SuggestAttachingACopySingleText,multipleFiles:O.a.SuggestActionForMultipleFilesCannotShareText};case E.a.getSharingInfoFailed:case E.a.linkHasExpired:case E.a.linkWillExpire:case E.a.noPermissionSet:case E.a.sharingWithLargeDL:return null;default:return Object(c.a)(e)}}(n);null!==d&&(m=a.length>1?d.multipleFiles:d.singleFile),g=Object(H.format)(u,s,m)}return{id:n,sharingTipString:g,actions:f,sharingTipActions:h,messageRank:function(e){switch(e){case E.a.noPermissionToShare:case E.a.noPermissionToShareExternally:case E.a.sharingWithLargeDL:case E.a.linkHasExpired:case E.a.externalRecipientCSL:case E.a.noPermissionSet:return b.b.Error;case E.a.linkWillExpire:case E.a.getSharingInfoFailed:return b.b.Info;default:return Object(c.a)(e)}}(n)}}function U(e,n,i,r){var t=G(e,n,i,r);if(null===t)return null;var a={key:n,source:b.c.Compose,rank:t.messageRank,messageParts:[t.sharingTipString]};return null!==t.actions&&t.actions.map(function(e){a.messageParts.push(e)}),function(e){return a}}function $(e,n){return Object(E.b)().filter(function(n){return-1===e.sharingTipsIgnored.indexOf(n)}).map(function(i){return G([e],i,n)}).filter(function(e){return null!==e})}i.d(n,"getSharingInformation",function(){return I}),i.d(n,"getInfoBarCreator",function(){return U}),i.d(n,"getSharingIssuesForSharingData",function(){return $})}},0,[279,51,280,57]]);
//# sourceMappingURL=owa.SharingData.mail.js.map
window.scriptsLoaded['owa.SharingData.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.SharingData.mail.js'] = (new Date()).getTime();