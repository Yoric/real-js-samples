window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.NotificationBar.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[187],{1519:function(t,e,a){"use strict";a.d(e,"a",function(){return l});var i=a(0),r=a(3),n=a(128),o=a(860),c=a(872),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._skipComponentRefResolution=!0,e}return i.__extends(e,t),e.prototype.render=function(){return r.createElement(c.a,i.__assign({},this.props,{primary:!0,onRenderDescription:n.b}))},e=i.__decorate([Object(o.a)("PrimaryButton",["theme","styles"],!0)],e)}(n.a)},1781:function(t,e,a){"use strict";a.r(e);var i=a(1),r=a(9),n={notificationsMap:new r.ObservableMap,notificationStack:[],notificationBarViewState:{isHovered:!1,autoDismissTimerCompleted:!1}},o=Object(i.createStore)("NotificationBarStore",n)(),c=a(11),l=Object(i.mutatorAction)("removeNotification",function(t){var e=o.notificationStack.indexOf(t);if(e<0)return c.c.error("notification id cannot be found in removeNotification"),void o.notificationsMap.delete(t);o.notificationStack.splice(e,1),o.notificationsMap.delete(t)}),s={};function d(t){return s[t]}var f=Object(i.action)("notificationAutoDismissTimerCompleted"),u=Object(i.action)("notificationMouseEnter"),h=Object(i.action)("notificationMouseLeave",function(t){return{notificationId:t}}),m=Object(i.action)("resetNotificationViewState"),k=Object(i.action)("setNotificationIsHovered",function(t){return{isHovered:t}}),b=a(971),p=1e3,v=null;function x(t){clearTimeout(v),function(t){delete s[t]}(t),l(t),m()}Object(i.orchestrator)(h,function(t){if(o.notificationBarViewState.autoDismissTimerCompleted){var e=d(t.notificationId);x(t.notificationId),e&&e(b.a.MouseLeaveAfterTimerCompleted)}k(!1)}),Object(i.mutator)(f,function(t){o.notificationBarViewState.autoDismissTimerCompleted=!0}),Object(i.mutator)(u,function(t){o.notificationBarViewState.isHovered=!0}),Object(i.mutator)(k,function(t){o.notificationBarViewState.isHovered=t.isHovered}),Object(i.mutator)(m,function(t){o.notificationBarViewState.isHovered=!1,o.notificationBarViewState.autoDismissTimerCompleted=!1});var g=a(0),B=a(3),y=a(104),S=a(3802),w={root:{backgroundColor:Object(y.g)().neutralSecondary,marginRight:"8px",borderStyle:"solid",borderWidth:"1px",borderColor:Object(y.g)().white},rootHovered:{backgroundColor:Object(y.g)().neutralPrimaryAlt},rootPressed:{backgroundColor:Object(y.g)().neutralDark},textContainer:{overflow:"hidden"},label:S.actionButtonText},T={root:{marginRight:"8px"}},A=a(18),C=a(2398),_=a(1519),D=a(872),E=a(728),I=a(354),O=a(17),N=a(1349),L=a(236),P=a(3802),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderSpinnerOrIcon=function(){if(e.props.notification.shouldShowSpinner)return B.createElement(N.a,{className:P.spinner,type:L.b.normal});if(e.props.notification.icon){var t={root:P.iconRoot};return B.createElement(I.a,{styles:t,iconName:e.props.notification.icon})}return B.createElement("div",{className:P.iconSpace})},e.onPrimaryButtonClick=function(t){e.closeAndExecuteCallback(b.a.PrimaryActionClicked)},e.onSecondaryButtonClick=function(t){e.closeAndExecuteCallback(b.a.SecondaryActionClicked)},e.onDismissClick=function(t){e.closeAndExecuteCallback(b.a.DismissClicked)},e.onMouseEnter=function(t){u()},e.onMouseLeave=function(t){h(e.props.notification.id)},e}return g.__extends(e,t),e.prototype.render=function(){var t=this.props,e=t.notification,a=g.__rest(t,["notification"]);return B.createElement(C.CSSTransition,g.__assign({},a,{timeout:167,classNames:{enter:A.AnimationClassNames.slideUpIn20,exit:A.AnimationClassNames.slideDownOut20}}),B.createElement("div",{className:P.positioningContainer},B.createElement("div",{className:P.notificationBarContainer,style:{minWidth:e.minWidth+"px",maxWidth:e.maxWidth+"px"},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},B.createElement("div",{className:P.leftItems},this.renderSpinnerOrIcon(),B.createElement("span",{className:P.contentText},e.contentText)),B.createElement("div",{className:P.rightItems},e.primaryActionText&&B.createElement(_.a,{onClick:this.onPrimaryButtonClick,text:e.primaryActionText,title:e.primaryActionText,ariaLabel:e.primaryActionText,styles:w}),e.primaryActionText&&e.secondaryActionText&&B.createElement(D.a,{onClick:this.onSecondaryButtonClick,text:e.secondaryActionText,title:e.secondaryActionText,ariaLabel:e.secondaryActionText,styles:w}),e.shouldShowDismissIcon&&B.createElement(E.IconButton,{onClick:this.onDismissClick,styles:T,iconProps:{iconName:"Cancel",styles:{root:P.dismissIcon}}})))))},e.prototype.closeAndExecuteCallback=function(t){var e=d(this.props.notification.id);x(this.props.notification.id),e&&e(t)},e=g.__decorate([O.observer],e)}(B.Component),H=a(20),K=a(110),V=a(8),M=a.n(V),W=a(3802),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return g.__extends(e,t),e.prototype.render=function(){var t;if(o.notificationStack.length>0){var e=o.notificationStack[o.notificationStack.length-1];t=o.notificationsMap.get(e);var a=K.j?M.a.ariaUndoWinText:M.a.ariaUndoMacText;this.ariaNotifString=null!==t.primaryActionText?Object(H.format)(M.a.ariaNotifBarActionString,t.contentText,a,t.primaryActionText):t.contentText}return B.createElement(C.TransitionGroup,{className:W.notificationBarHostContainer},t&&B.createElement(j,{notification:Object(r.toJS)(t),key:t.id}),B.createElement("div",{className:"screenReaderOnly",role:"alert","aria-relevant":"additions",id:"notificationBarText"}))},e.prototype.componentDidUpdate=function(){o.notificationStack.length>0&&this.addAccessibilityNotifBarDiv()},e.prototype.addAccessibilityNotifBarDiv=function(){var t=document.getElementById("notificationBarText");t.firstChild&&t.removeChild(t.firstChild);var e=document.createElement("div");e.innerText=this.ariaNotifString,document.getElementById("notificationBarText").appendChild(e)},e=g.__decorate([O.observer],e)}(B.Component),J=Object(i.mutatorAction)("pushNotification",function(t,e){o.notificationsMap.has(t)?c.c.error("cannot add notification with the same id.  Please dismiss the notification before adding it again."):(o.notificationsMap.set(t,e),o.notificationStack.push(t))}),Y=a(4),z=Object(Y.select)({store:function(){return o}})(function(t,e,a,i){var r=void 0===a?{}:a,n=r.icon,l=r.primaryActionText,u=r.secondaryActionText,h=r.minWidth,m=void 0===h?400:h,k=r.maxWidth,g=void 0===k?400:k,B=r.shouldShowDismissIcon,y=void 0===B||B,S=r.shouldShowSpinner,w=void 0!==S&&S,T=r.allowAutoDismiss,A=void 0===T||T,C=r.autoDismissInSeconds,_=void 0===C?7:C,D=(r.isHovered,r.notificationCallback);if(e="function"==typeof e?e():e)if(!l&&!u||D){var E={id:t,contentText:e,icon:n,primaryActionText:l,secondaryActionText:u,minWidth:m,maxWidth:g,shouldShowDismissIcon:y,shouldShowSpinner:w,allowAutoDismiss:A,autoDismissInSeconds:_};if(i.store.notificationStack.length>0){var I=i.store.notificationStack[i.store.notificationStack.length-1];i.store.notificationsMap.get(I).allowAutoDismiss&&x(I)}!function(t,e){if(void 0!==s[t])throw new Error("Cannot over write an existing notification callback.");s[t]=e}(t,D),J(t,E),A&&function(t,e){v=setTimeout(function(){if(f(),!o.notificationBarViewState.isHovered){var e=d(t);x(t),e&&e(b.a.AutoDismissed)}},e*p)}(t,_)}else c.c.error("notification callback must be defined with a primary or secondary action");else c.c.error("contentText is required to show the notification")});a.d(e,"NotificationBarHost",function(){return G}),a.d(e,"showNotification",function(){return z}),a.d(e,"dismissNotification",function(){return x})},3802:function(t,e,a){var i=a(4912),r=a(55);"string"==typeof i&&(i=[[t.i,i]]);for(var n=0;n<i.length;n++)r.loadStyles(i[n][1],!1);i.locals&&(t.exports=i.locals)},4912:function(t,e,a){(e=t.exports=a(54)(!1)).push([t.i,'._2LXbAP5E3ktqzI6E5BoChy{pointer-events:none;position:absolute;bottom:0;z-index:4}html[dir] ._2LXbAP5E3ktqzI6E5BoChy{background-color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._2LXbAP5E3ktqzI6E5BoChy,html[dir=rtl] ._2LXbAP5E3ktqzI6E5BoChy{left:0;right:0}._359IiFKO6md-nI-SAIbY5K{width:100%;position:absolute;bottom:0;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}._117GC_knc_9YqrmXKnDEVa,._359IiFKO6md-nI-SAIbY5K{display:-webkit-box;display:-ms-flexbox;display:flex}._117GC_knc_9YqrmXKnDEVa{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:48px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;pointer-events:auto}html[dir] ._117GC_knc_9YqrmXKnDEVa{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white);-webkit-box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";box-shadow:0 1px 12px 0 "[theme:blackTranslucent40, default:rgba(0, 0, 0, .4)]";background-color:"[theme:neutralSecondary, default:#666666]";border-radius:4px 4px 0 0}html[dir=ltr] .zeVkRLv4kBfia8a1LjaJk{margin-left:24px;margin-right:14px}html[dir=rtl] .zeVkRLv4kBfia8a1LjaJk{margin-right:24px;margin-left:14px}._2ni1gBu6TtJHbYNKGWKJUY{color:"[theme:white, default:#ffffff]";font-size:15px}html[dir=ltr] ._2ni1gBu6TtJHbYNKGWKJUY{margin-left:24px;margin-right:16px}html[dir=rtl] ._2ni1gBu6TtJHbYNKGWKJUY{margin-right:24px;margin-left:16px}html[dir=ltr] ._16OgP6fJGs0jVDxWtYRPVL{margin-left:48px}html[dir=rtl] ._16OgP6fJGs0jVDxWtYRPVL{margin-right:48px}._23UNarBsLsXDTFgv56d8tC{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}html[dir=ltr] ._23UNarBsLsXDTFgv56d8tC{margin-right:8px}html[dir=rtl] ._23UNarBsLsXDTFgv56d8tC{margin-left:8px}._3PQA5BmxnK4ruPcoABVgAM{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;max-width:66%}.GtkKsG1EsnfvqPDSnb3ZK{color:"[theme:white, default:#ffffff]"}.GtkKsG1EsnfvqPDSnb3ZK :hover{color:"[theme:neutralPrimary, default:#333333]"}.ZOyCRPzrHdws8uD9Wpuzx{font-size:14px;font-weight:400}._17oa6x36u2hA0j9J9hOOqi,.ZOyCRPzrHdws8uD9Wpuzx{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"[theme:white, default:#ffffff]"}._17oa6x36u2hA0j9J9hOOqi{height:32px;line-height:32px}',""]),e.locals={notificationBarHostContainer:"_2LXbAP5E3ktqzI6E5BoChy",positioningContainer:"_359IiFKO6md-nI-SAIbY5K",notificationBarContainer:"_117GC_knc_9YqrmXKnDEVa",spinner:"zeVkRLv4kBfia8a1LjaJk",iconRoot:"_2ni1gBu6TtJHbYNKGWKJUY",iconSpace:"_16OgP6fJGs0jVDxWtYRPVL",leftItems:"_23UNarBsLsXDTFgv56d8tC",rightItems:"_3PQA5BmxnK4ruPcoABVgAM",dismissIcon:"GtkKsG1EsnfvqPDSnb3ZK",contentText:"ZOyCRPzrHdws8uD9Wpuzx",actionButtonText:"_17oa6x36u2hA0j9J9hOOqi"}}},0,[289,109]]);
//# sourceMappingURL=owa.NotificationBar.mail.js.map
window.scriptsLoaded['owa.NotificationBar.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.NotificationBar.mail.js'] = (new Date()).getTime();