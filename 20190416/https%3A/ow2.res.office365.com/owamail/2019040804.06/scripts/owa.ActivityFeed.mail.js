window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.ActivityFeed.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[50],{1896:function(e,t,n){"use strict";n.r(t);var r,o=n(0),i=n(1),a=Object(i.action)("LOAD_ACTIVITY_FEED"),s=n(2982);!function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention"}(r||(r={}));var c=Object(i.mutatorAction)("ACTIVITY_FEED_LOADED",function(e){var t=Object(s.a)();t.firstFetchComplete=!0,e&&e.filter(function(e){return e.type===r.Like}).forEach(function(e){t.items.set(e.id,{type:e.type,payload:JSON.parse(e.activityFeedItemPayload),id:e.id,version:e.version,expiry:e.expiry,isSeen:e.isSeen,isRead:e.isRead,isDismissed:e.isDismissed,priority:e.priority,timeOfAction:e.timeOfAction,aggregationKey:e.aggregationKey})})}),u=n(56);Object(i.orchestrator)(a,function(){return o.__awaiter(void 0,void 0,void 0,function(){var e;return o.__generator(this,function(t){switch(t.label){case 0:return[4,Object(u.b)("ows/beta/ActivityFeed")];case 1:return e=t.sent(),c(e),[2]}})})});var l=Object(i.action)("ACTIVITY_FEED_ITEM_ACTION",function(e){return{itemId:e}});Object(i.orchestrator)(l,function(e){var t,n=e.itemId;t=[n],Object(u.e)("ows/beta/ActivityFeed/MarkItemsAsRead",t)}),Object(i.mutator)(l,function(e){var t=e.itemId,n=Object(s.a)().items;n.has(t)&&(n.get(t).isRead=!0)});var p=Object(i.action)("ACTIVITY_FEED_ITEMS_SEEN",function(e){return{itemIds:e}});Object(i.mutator)(p,function(e){var t,n=e.itemIds;t=n,Object(u.e)("ows/beta/ActivityFeed/MarkItemsAsSeen",t)}),Object(i.mutator)(p,function(e){var t=e.itemIds,n=Object(s.a)();t.forEach(function(e){n.items.get(e).isSeen=!0})});var d=n(1984),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.getJsonTypeName=function(){return"Action.OpenMail"},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.itemId=t.itemId},t}(d.Action),f=n(3),y=n(354),h=n(88),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),Object.defineProperty(t.prototype,"className",{get:function(){return""},enumerable:!0,configurable:!0}),t.prototype.internalRender=function(){return this.elementHost=document.createElement("div"),this.elementHost.className=this.className,h.render(this.renderComponent(),this.elementHost),this.elementHost},t.prototype.remove=function(){return this.elementHost&&(h.unmountComponentAtNode(this.elementHost),this.elementHost=null),e.prototype.remove.call(this)},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.parseInternal(t)},t}(d.CardElement),x=n(4071),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.renderComponent=function(){return f.createElement(y.a,{iconName:this.iconName})},Object.defineProperty(t.prototype,"className",{get:function(){return x.icon},enumerable:!0,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Icon"},t.prototype.renderSpeech=function(){return""},t.prototype.parseInternal=function(e){this.iconName=e.iconName},t}(b),A=n(17),w=n(4071),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.renderComponent=function(){return f.createElement(I,{itemId:this.itemId})},Object.defineProperty(t.prototype,"className",{get:function(){return w.unreadMarker},enumerable:!0,configurable:!0}),t.prototype.getJsonTypeName=function(){return"UnreadMarker"},t.prototype.renderSpeech=function(){return""},t.prototype.parseInternal=function(e){this.itemId=e.itemId},t}(b),I=Object(A.observer)(function(e){var t=e.itemId;return Object(s.a)().items.get(t).isRead?null:f.createElement(y.a,{iconName:"CircleFill"})}),_=n(1226),O=n(34),k=n(4071),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.renderComponent=function(){return f.createElement(_.a,{emailAddress:this.emailAddress,name:this.name,size:O.c.size28})},Object.defineProperty(t.prototype,"className",{get:function(){return k.icon},enumerable:!0,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Icon"},t.prototype.renderSpeech=function(){return""},t.prototype.parseInternal=function(e){this.emailAddress=e.emailAddress,this.name=e.name},t}(b),j=function(){d.AdaptiveCard.actionTypeRegistry.registerType("Action.OpenMail",function(){return new m}),d.AdaptiveCard.elementTypeRegistry.registerType("Icon",function(){return new v}),d.AdaptiveCard.elementTypeRegistry.registerType("UnreadMarker",function(){return new g}),d.AdaptiveCard.elementTypeRegistry.registerType("Persona",function(){return new C}),a()},E=n(186),M=n(4459),T=function(e){function t(t){var n=e.call(this,t)||this;return n.createCard=function(){var e=new d.AdaptiveCard,t=Object(E.d)(),r=n.props,o=r.itemId,i=r.json,a=r.onAction;return e.hostConfig=new d.HostConfig({fontFamily:"Segoe UI, Helvetica Neue, sans-serif",containerStyles:{default:{foregroundColors:{default:{default:t.black,subtle:t.neutralSecondary},accent:{default:t.themePrimary}}}},fontSizes:{small:12,default:14},fontWeights:{bolder:600}}),e.onExecuteAction=function(e){return a(o,e)},e.parse(i),e},n}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.container&&this.container.appendChild(this.createCard().render())},t.prototype.render=function(){var e=this;return f.createElement("div",{className:M.feedItem,ref:function(t){return e.container=t}})},t}(f.Component),F=n(28),N=n(20),S=n(15),J=n.n(S),D=function(e){switch(e.type){case r.Like:return z(e);case r.AtMention:case r.GroupMention:case r.MeMention:case r.FileMention:case r.GroupAtAllMention:case r.Unknown:return H()}return function(){throw new Error}()},H=function(){return{}},z=function(e){return{type:"AdaptiveCard",body:[{type:"Container",items:[{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Persona",emailAddress:e.payload.Actors[0].EmailAddress.EmailAddress,name:e.payload.Actors[0].EmailAddress.Name}],width:"28px"},{type:"Column",items:[{type:"TextBlock",horizontalAlignment:"Left",text:Object(N.format)(J.a.activityFeedLikeCardBody,e.payload.Actors[0].EmailAddress.Name,e.payload.TargetSubject),wrap:!0,maxLines:2}],width:"Auto"},{type:"Column",items:[{type:"Icon",iconName:"Like",horizontalAlignment:"Center"}],width:"16px"}]},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"UnreadMarker",itemId:e.id}],width:"28px"},{type:"Column",items:[{type:"TextBlock",horizontalAlignment:"Left",text:""+Object(F.z)(Object(F.h)(new Date(e.payload.LatestTimestamp))),wrap:!0,maxLines:2,isSubtle:!0,weight:"Bolder",size:"Small"}],width:"Auto"}]}]}],selectAction:{type:"Action.OpenMail",itemId:""+e.payload.TargetItemId},$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.0"}},L=n(4459),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.cards.map(function(t){return f.createElement(T,{key:t.id,itemId:t.id,json:D(t),onAction:e.props.onAction})});return f.createElement("div",{className:L.feed},t)},t}(f.Component),R=n(1349),G=n(236),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleAction=function(e,n){switch(l(e),n.getJsonTypeName()){case"Action.OpenMail":t.props.actions.openMail(n.itemId)}},t}return o.__extends(t,e),t.prototype.componentDidMount=function(){p(o.__spread(Object(s.a)().items.values()).filter(function(e){return!e.isSeen}).map(function(e){return e.id})),a()},t.prototype.render=function(){var e=Object(s.a)(),t=e.firstFetchComplete,n=e.items;return t?f.createElement(P,{cards:o.__spread(n.values()),onAction:this.handleAction}):f.createElement(R.a,{size:G.a.large})},t=o.__decorate([A.observer],t)}(f.Component);n.d(t,"initializeActivityFeed",function(){return j}),n.d(t,"ActivityFeed",function(){return Y})},2982:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1),o=n(9),i=Object(r.createStore)("activityFeedStore",{firstFetchComplete:!1,items:new o.ObservableMap})},4071:function(e,t,n){var r=n(5445),o=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4459:function(e,t,n){var r=n(5446),o=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5445:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._1YnJepNwKncV30l6xKFhVD{font-size:16px;color:"[theme:neutralSecondary, default:#666666]"}._3h5NO44KeWL-JQjR6zsqxe{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:8px;height:100%;color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={icon:"_1YnJepNwKncV30l6xKFhVD",unreadMarker:"_3h5NO44KeWL-JQjR6zsqxe"}},5446:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'html[dir] ._2JuHjDilROU3_SFsylrFnd{margin-bottom:48px}.XF9ZIJGc6dyPHvxEId2Y5{cursor:pointer;max-width:288px}html[dir] .XF9ZIJGc6dyPHvxEId2Y5{border-radius:2px;-webkit-box-shadow:0 2px 4px -.8px "[theme:blackTranslucent10, default:rgba(0, 0, 0, .1)]";box-shadow:0 2px 4px -.8px "[theme:blackTranslucent10, default:rgba(0, 0, 0, .1)]";background-color:"[theme:white, default:#ffffff]";margin-top:8px;-webkit-transition:-webkit-box-shadow .2s ease-in-out;transition:-webkit-box-shadow .2s ease-in-out;transition:box-shadow .2s ease-in-out;transition:box-shadow .2s ease-in-out,-webkit-box-shadow .2s ease-in-out}html[dir] .XF9ZIJGc6dyPHvxEId2Y5:first-of-type{margin-top:0}html[dir] .XF9ZIJGc6dyPHvxEId2Y5:hover{-webkit-box-shadow:0 2px 4px 3.3px "[theme:blackTranslucent10, default:rgba(0, 0, 0, .1)]";box-shadow:0 2px 4px 3.3px "[theme:blackTranslucent10, default:rgba(0, 0, 0, .1)]"}html[dir] .XF9ZIJGc6dyPHvxEId2Y5 .ac-container.ac-selectable:hover{background:none!important}',""]),t.locals={feed:"_2JuHjDilROU3_SFsylrFnd",feedItem:"XF9ZIJGc6dyPHvxEId2Y5"}}},0,[279,51,280,57,289,109]]);
//# sourceMappingURL=owa.ActivityFeed.mail.js.map
window.scriptsLoaded['owa.ActivityFeed.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.ActivityFeed.mail.js'] = (new Date()).getTime();