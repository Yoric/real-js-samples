window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.Addins.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[52],{1229:function(e,t,n){"use strict";var r=n(268),a=n(45),i=n(548),o=n(117);function s(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function c(e,t){return t?"&"+e+"="+t:""}function l(e){if(!e.to||!e.to.smtpAddress)return"";var t=o.parse(Object(a.a)().search.substr(1));return t.mailtouri=function(e){if(!e.to||!e.to.smtpAddress)return"";var t="mailto:"+s(null,e.to),n="";return n+=s("cc",e.cc),n+=s("bcc",e.bcc),n+=c("subject",e.subject),(n+=c("body",e.body))?t+"?"+n.slice(1):t}(e),Object(i.a)(r.e,r.b,"?"+o.stringify(t))}n.d(t,"a",function(){return l})},1230:function(e,t,n){"use strict";var r=n(4),a=n(1543),i=n.n(a),o=n(1544),s=n.n(o),c=n(20),l=n(31),u=n(11);function d(e){var t=s()({EntityFeedbackEntries:e});return i()({Header:Object(l.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;u.c.info(Object(c.format)("addEntityFeedback Error count: {0}",t.ErrorCount)),u.c.info(Object(c.format)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(r.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(d(e.entityFeedbackEntries),u.c.info(Object(c.format)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},1233:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1242);function a(e){return Object(r.a)().sharingLinks.get(e)}},1235:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1532),a=n(20),i=n(11);function o(e,t){if(Object(a.isStringNullOrWhiteSpace)(e.clientSessionId))return i.c.warn(Object(a.format)("{0} - Attempting to create session feedback entry with empty client session id",e.entityScenarioName)),null;var n="";t&&(n=null==t.recipientEmailAddresses?"":JSON.stringify(t.recipientEmailAddresses));var o="";if(!Object(a.isStringNullOrWhiteSpace)(t.endSessionAction)){var s={EndSessionAction:t.endSessionAction};o=JSON.stringify(s)}return Object(r.a)(e,"",t.eventType,n,0,o)}},1237:function(e,t,n){"use strict";var r=n(0),a=n(1570),i=n(1243),o=n(1325),s=n(1576),c=n(1320),l=n(1563),u=n(110),d=n(90),p=27,f=75,m=Object(d.h)()?function(e){return e.metaKey}:function(e){return e.ctrlKey},g=function(){function e(e,t){var n=this;this.ribbonViewState=e,this.getSelectedImageCallback=t,this.workaroundFocusIssueForFirefox=Object(u.e)()?function(){var e=n.editor.getCustomData("WORKAROUND_TEXTBOX_FOR_FIREFOX",function(){var e=n.editor.getDocument().createElement("input");return e.type="textbox",e.style.width="0",e.style.height="0",n.editor.insertNode(e,{position:3,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),e},function(e){return e.parentNode&&e.parentNode.removeChild(e)});e.style.display="",e.focus(),e.style.display="none"}:function(){},this.insertNodeFromExpressionPicker=function(e){if(n.editor&&!n.editor.isDisposed()){n.editor.focus();var t=c.a.expressionPickerViewState.wordToReplace;n.editor.performAutoComplete(function(){t?n.pluginUtils.replaceWithNode(n.editor,t,e,!0):n.editor.insertNode(e,{position:2,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1}),Object(s.a)(c.a.expressionPickerViewState,"")},"Ribbon")}},this.insertLinkFeature={keys:[f],allowFunctionKeys:!0,shouldHandleEvent:function(e){var t=e.rawEvent;return!t.altKey&&!t.shiftKey&&m(t)},handleEvent:function(e){var t=e.rawEvent;t.preventDefault(),t.stopPropagation(),n.workaroundFocusIssueForFirefox(),i.f.import().then(function(e){return e(n)})}},this.closeContextualFormatBarFeature={keys:[p],shouldHandleEvent:function(){return n.ribbonViewState.isContextualFormatBarShown},handleEvent:function(e){var t=e.rawEvent;t.preventDefault(),t.stopPropagation(),Object(a.a)(n.ribbonViewState,!1)}}}return e.prototype.getName=function(){return"Ribbon"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.editor.addContentEditFeature(this.insertLinkFeature),this.editor.addContentEditFeature(this.closeContextualFormatBarFeature),i.g.import().then(function(e){return t.updateRibbonState=e})},e.prototype.onPluginEvent=function(e){var t=this;if(this.updateRibbonState&&(2==e.eventType&&e.rawEvent.keyCode!=p||5==e.eventType||6==e.eventType)){var n=6!=e.eventType;this.updateRibbonState(this,this.ribbonViewState,n,!0)}this.ribbonViewState.formatViewState.formatPainterFormat&&5==e.eventType&&i.d.import().then(function(e){return e(t)})},e.prototype.dispose=function(){this.editor=null,o.a.importAndExecute()},e.prototype.getEditor=function(){return this.editor},e.prototype.getFormatState=function(){return this.ribbonViewState.formatViewState},e.prototype.getImageSelectedByPlugin=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return this.getSelectedImageCallback?[4,this.getSelectedImageCallback]:[3,2];case 1:return e=t.sent()(),[3,3];case 2:e=null,t.label=3;case 3:return[2,e]}})})},e.prototype.setPluginUtils=function(e){this.pluginUtils=e},e.prototype.toggleExpressionPicker=function(e,t){e?l.a.importAndExecute(this.insertNodeFromExpressionPicker,t,"","ribbon"):o.a.importAndExecute()},e}();t.a=g},1239:function(e,t,n){"use strict";var r=n(1),a=Object(r.createStore)("inlineimages",{inlineImages:{}})();t.a=a},1242:function(e,t,n){"use strict";var r=n(9),a=n(1),i={sharingLinks:new r.ObservableMap({})},o=Object(a.createStore)("sharingLinkStore",i);t.a=o},1243:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"h",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return p});n(1237);var r=n(2),a=new r.c(function(){return Promise.all([n.e(5),n.e(9),n.e(14),n.e(19),n.e(139)]).then(n.bind(null,1868))}),i=Object(r.d)(a,function(e){return e.Ribbon}),o=Object(r.d)(a,function(e){return e.ContextualFormatBar}),s=new r.a(a,function(e){return e.updateRibbonWidth}),c=new r.b(a,function(e){return e.updateRibbonState}),l=new r.b(a,function(e){return e.formatPainterFinish}),u=new r.b(a,function(e){return e.showInsertLinkDialog}),d=new r.b(a,function(e){return e.displayInsertLinkDialog}),p=new r.b(a,function(e){return e.showImageAltTextDialog})},1245:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(0),a=n(7),i=/emoji_([0-9a-z]+(_[0-9a-z]+)?)-png/i,o=49;function s(e){var t,n;void 0===e&&(e=o);var s=Object(a.a)().UserOptions.MruEmojis,c=[];if(s&&s.length>0)try{for(var l=r.__values(s),u=l.next();!u.done;u=l.next()){var d=u.value.match(i);if(d&&d.length>=2&&(c.push(d[1].toLowerCase()),c.length>=e))break}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return c}},1246:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r="ReferenceAttachment:#Exchange",a=1024,i=1048576},1249:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("updateMailtips",function(e,t,n){return{composeId:e,fromEmailAddress:t,recipients:n}})},1252:function(e,t,n){"use strict";var r=n(0),a=n(374),i=n(4),o=Object(i.action)("addInfoBarMessage")(function(e,t,n,i){void 0===n&&(n="0"),-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=r.__spread(e.infoBarIds),i&&(a.b[n]||(a.b[n]={}),a.b[n][t]=i)});t.a=o},1260:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(845);function a(e,t){return{email:e||Object(r.a)(t)}}},1261:function(e,t,n){"use strict";var r=n(4),a=n(474);t.a=Object(r.action)("preloadComposePlugins")(function(e){var t=Object(a.b)(e);t&&t.mentionsPickerPlugin&&e.atMentions.atMentionTuples&&Object.keys(e.atMentions.atMentionTuples).length>0&&t.mentionsPickerPlugin.getPlugin()})},1262:function(e,t,n){"use strict";var r=n(0),a=n(3),i=n(4),o=Object(i.action)("setTableEditMenuViewState")(function(e,t,n){e.position=t,e.hasHeaders=n}),s=n(8),c=n.n(s),l=n(966),u=n(9),d=n(17),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismiss=function(){o(t.props.viewState,null,t.props.viewState.hasHeaders)},t.setTableHeaders=function(e,n){t.onDismiss(),t.props.plugin.setTableHeaders(t.props.viewState.hasHeaders)},t.editTable=function(e,n){t.onDismiss();var r=n.data;t.props.plugin.editTable(r)},t.formatTable=function(e,n){t.onDismiss();var r=n.data;t.props.plugin.formatTable(r)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.viewState.position;return e&&a.createElement(l.a,{shouldFocusOnMount:!0,target:e,onDismiss:this.onDismiss,items:this.menuItems})},Object.defineProperty(t.prototype,"menuItems",{get:function(){return[{key:"insert",name:c.a.tableMenuInsert,subMenuProps:{items:[{key:"insertAbove",name:c.a.tableMenuInsertAbove,data:0,onClick:this.editTable},{key:"insertBelow",name:c.a.tableMenuInsertBelow,data:1,onClick:this.editTable},{key:"insertLeft",name:c.a.tableMenuInsertLeft,data:2,onClick:this.editTable},{key:"insertRight",name:c.a.tableMenuInsertRight,data:3,onClick:this.editTable}]}},{key:"delete",name:c.a.tableMenuDelete,subMenuProps:{items:[{key:"deleteTable",name:c.a.tableMenuDeleteTable,data:4,onClick:this.editTable},{key:"deleteColumn",name:c.a.tableMenuDeleteColumn,data:5,onClick:this.editTable},{key:"deleteRow",name:c.a.tableMenuDeleteRow,data:6,onClick:this.editTable}]}},{key:"merge",name:c.a.tableMenuMerge,subMenuProps:{items:[{key:"mergeAbove",name:c.a.tableMenuMergeAbove,data:7,onClick:this.editTable},{key:"mergeBelow",name:c.a.tableMenuMergeBelow,data:8,onClick:this.editTable},{key:"mergeLeft",name:c.a.tableMenuMergeLeft,data:9,onClick:this.editTable},{key:"mergeRight",name:c.a.tableMenuMergeRight,data:10,onClick:this.editTable}]}},{key:"split",name:c.a.tableMenuSplit,subMenuProps:{items:[{key:"splitHorizontally",name:c.a.tableMenuSplitHorizontally,data:11,onClick:this.editTable},{key:"splitVertically",name:c.a.tableMenuSplitVertically,data:12,onClick:this.editTable}]}},{key:"style",name:c.a.tableMenuStyle,subMenuProps:{items:[{key:"styleDefault",name:c.a.tableMenuStyleDefault,data:"Default",onClick:this.formatTable},{key:"styleGrid",name:c.a.tableMenuStyleGrid,data:"Grid",onClick:this.formatTable},{key:"styleLightLines",name:c.a.tableMenuStyleLightLines,data:"LightLines",onClick:this.formatTable},{key:"styleTwoTones",name:c.a.tableMenuStyleTwoTones,data:"TwoTones",onClick:this.formatTable},{key:"styleLightBands",name:c.a.tableMenuStyleLightBands,data:"LightBands",onClick:this.formatTable},{key:"styleClear",name:c.a.tableMenuStyleClear,data:"Clear",onClick:this.formatTable}]}},{key:"headers",name:c.a.tableMenuHeaderRow,isChecked:this.props.viewState.hasHeaders,canCheck:!0,onClick:this.setTableHeaders}]},enumerable:!0,configurable:!0}),r.__decorate([u.computed],t.prototype,"menuItems",null),t=r.__decorate([d.observer],t)}(a.Component),f=n(836),m="TD",g="TH";function h(e,t,n,r,a){return{bgColorEven:e,bgColorOdd:t,topBorderColor:n,bottomBorderColor:r,verticalBorderColor:a}}var v={Default:h("#FFF","#FFF","#ABABAB","#ABABAB","#ABABAB"),LightLines:h("#FFF","#FFF",null,"#92C0E0"),TwoTones:h("#C0E4FF","#FFF"),LightBands:h("#D8D8D8","#FFF"),Grid:h("#D8D8D8","#FFF","#ABABAB","#ABABAB","#ABABAB"),Clear:h("#FFF","#FFF")},y=function(){function e(e){var t=this;this.viewState=e,this.onContextMenu=function(e){var n=t.editor.getElementAtCursor(m+","+g,e.srcElement||e.target);if(n){t.range=t.editor.getSelectionRange(),t.invokedTableCell=n;for(var r=t.pluginUtils.createVTable(t.invokedTableCell),a=!0,i=0;i<r.cells[0].length;i++){var s=r.cells[0][i].td;if(s&&s.tagName!=g){a=!1;break}}o(t.viewState,{x:e.pageX,y:e.pageY},a),e.preventDefault()}}}return e.prototype.getName=function(){return"TableEdit"},e.prototype.initialize=function(e){this.editor=e,this.onContextMenuDisposer=this.editor.addDomEventHandler("contextmenu",this.onContextMenu)},e.prototype.dispose=function(){this.onContextMenuDisposer&&(this.onContextMenuDisposer(),this.onContextMenuDisposer=null),this.editor=null,this.invokedTableCell=null},e.prototype.setPluginUtils=function(e){this.pluginUtils=e},e.prototype.editTable=function(e){this.range&&this.editor&&(this.editor.select(this.range),this.pluginUtils.editTable(this.editor,e),this.range=null)},e.prototype.formatTable=function(e){var t=v[e];t&&this.range&&this.editor&&(this.editor.select(this.range),this.pluginUtils.formatTable(this.editor,t),this.range=null)},e.prototype.setTableHeaders=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.range&&this.editor?[4,f.d.import()]:[3,2];case 1:t.sent()(this.editor,this.invokedTableCell,e),t.label=2;case 2:return this.invokedTableCell=null,[2]}})})},e}();function b(){return{position:null,hasHeaders:!1}}n.d(t,"a",function(){return p}),n.d(t,"b",function(){return y}),n.d(t,"c",function(){return b})},1263:function(e,t,n){"use strict";var r=n(240);function a(){return{position:null,subMenuSelectionIndex:-1}}var i=n(2);n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return a});var o=new i.c(function(){return Promise.all([n.e(5),n.e(9),n.e(14),n.e(19),n.e(139)]).then(n.bind(null,7076))}),s=Object(i.d)(o,function(e){return e.PasteOptioin}),c=Object(r.a)(o,function(e){return e.PasteOptionPlugin},"PasteOption",function(e,t){return 6===e.eventType&&"Paste"==e.source})},1267:function(e,t,n){"use strict";function r(e){var t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach(function(e){t.push(e.attachmentId)}),n.inlineAttachments.forEach(function(e){t.push(e.attachmentId)}),n.imageViewAttachments.forEach(function(e){t.push(e.attachmentId)})),t}n.d(t,"a",function(){return r})},1268:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r,a=n(12);function i(e,t){if(t){var n=null;switch(e){case 0:n="SmartReplySendMessage";break;case 1:n="SmartReplySaveMessage";break;case 2:n="SmartReplyDiscardMessage"}Object(a.k)(n,[t])}}!function(e){e[e.Send=0]="Send",e[e.Save=1]="Save",e[e.Discard=2]="Discard"}(r||(r={}))},1269:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1270),a=n(401),i=n(20),o="Signature";function s(e,t,n){var s="";if(t&&!function(e,t){if("HTML"==e){var n=(new DOMParser).parseFromString(t,"text/html").documentElement;if(n){var r=n.innerText.replace(/(\t|\n|\r|\v|\f)/g,""),a=n.querySelectorAll('img[src]:not([src=""])');return!r&&0==a.length}return!0}return!t}(e,t))if("HTML"==e){var c=Object(r.b)(),l=Object(a.a)(t,e);s=n?c+c:c,s+=Object(i.format)("<div id='{0}'>{1}</div>",o,l)}else s="\n\n"+t;return s}},1270:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1568);function a(e){var t=document.createElement("div");e?t.innerHTML=e:t.appendChild(document.createElement("br"));var n=t.style,a=Object(r.a)();return a.fontFamily&&(n.fontFamily=a.fontFamily),a.fontSize&&(n.fontSize=a.fontSize),a.textColor&&(n.color=a.textColor),a.bold&&(n.fontWeight="bold"),a.italic&&(n.fontStyle="italic"),a.underline&&(n.textDecoration="underline"),t.outerHTML}t.b=function(){return a()}},1271:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5),a=n(29);function i(){var e=Object(a.f)();return Object(r.d)("mc-smartCompose")&&("en-US"===e||"en-CA"===e)}},1272:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(2),a=n(240),i=new r.c(function(){return n.e(230).then(n.bind(null,1882))}),o=Object(a.a)(i,function(e){return e.default},"SmartCompose",null),s=new r.a(i,function(e){return e.updateRecipientsForSmartCompose})},1273:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=48,a=49,i=56;function o(e,t){return(t?a:i)+(e?r:0)}},1278:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(223),a=n(1625),i=n(833);function o(e){var t=Object(i.a)()&&e.IRMData?Object(a.a)(e.IRMData.RmsTemplateId):null;t&&e.infoBarIds.indexOf(t)<0&&Object(r.a)(e,t)}},1279:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(250),a=n(1652),i=n.n(a),o=n(187),s=n.n(o),c=n(33),l=n.n(c),u=n(1653),d=n.n(u),p=n(31);function f(e,t,n,a,o,c){var u=function(e,t,n,a,o,c){var u=i()({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:a?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[t],TimeFormat:o,ItemShape:s()({BaseShape:"IdOnly",AdditionalProperties:[l()({FieldURI:"ItemLastModifiedTime"})]})});return a?c&&(u.ItemShape.ReturnOnlyInternetMessageId=!0):(u.ItemShape=Object(r.b)(n),u.ShapeName="MailCompose"),u.GroupSmtpAddress=e,u}(e,t,n,a,o,c);return d()({Header:Object(p.getJsonRequestHeader)(),Body:u}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},1280:function(e,t,n){"use strict";var r=n(0),a=n(474),i=n(305),o=n(1269),s=n(854),c=n(280),l=n(185),u=n(1569),d=n(1),p=Object(d.mutatorAction)("removeAppendOnSend",function(e){e.appendOnSend=[]}),f=n(12),m=function(){function e(e){this.viewState=e,this.hiddenAttachmentsHtml=""}return e.prototype.getName=function(){return"ContentOperation"},e.prototype.initialize=function(e){this.editor=e,this.saveOnDispose=!0},e.prototype.dispose=function(){this.saveOnDispose&&(this.cursorSnapshot={},this.editor&&this.editor.getSelectionRange()&&(this.cursorSnapshot.htmlSnapshotWithCursorMarker=this.editor.getContent(!1,!0)),this.updateContentToViewState(),this.cursorSnapshot.snapshot=this.viewState.content,Object(c.c)(this.viewState)&&!this.viewState.subjectPickerViewState.isLoadingConversation&&Object(i.b)(this.viewState,!0)),this.saveOnDispose=!1,this.editor=null},e.prototype.hasCursorSnapshot=function(){return this.cursorSnapshot&&this.cursorSnapshot.htmlSnapshotWithCursorMarker},e.prototype.focusToEditor=function(){this.editor?(this.editor.focus(),this.hasCursorSnapshot()&&this.cursorSnapshot.snapshot==this.viewState.content&&(this.editor.setContent(this.cursorSnapshot.htmlSnapshotWithCursorMarker,void 0,this.editor.isDarkMode()),this.editor.triggerContentChangedEvent("RestoreCursor"))):this.plainTextEditor&&(this.plainTextEditor.focus(),this.plainTextEditor.selectionStart=0,this.plainTextEditor.selectionEnd=0),this.cursorSnapshot=null},e.prototype.stopSaveOnDispose=function(){this.saveOnDispose=!1},e.prototype.updateContentToViewState=function(){var e=this.editor?this.editor.getContent(!0):this.plainTextEditor?this.plainTextEditor.value:null;null!=e&&Object(u.a)(this.viewState,e)},e.prototype.setPlainTextEditor=function(e){this.plainTextEditor=e},e.prototype.onPluginEvent=function(e){if(9===e.eventType){var t=this.editor.queryElements("#OwaReferenceAttachments")[0],n=this.editor.queryElements("#OwaReferenceAttachmentsEnd")[0];t&&!t.previousElementSibling&&n&&n.previousElementSibling==t&&(this.hiddenAttachmentsHtml=(t?t.outerHTML:"")+(n?n.outerHTML:""),this.editor.deleteNode(t),this.editor.deleteNode(n))}else if(7===e.eventType)e.content=this.hiddenAttachmentsHtml+e.content;else if(6===e.eventType){"SetContent"===e.source&&this.replyWithTextElementId&&this.moveCaretBelowHtmlElement(this.replyWithTextElementId)}},e.prototype.insertSignature=function(e){var t=Object(o.a)(e,Object(s.a)(e));if("HTML"==e&&this.editor)this.editor.focus(),this.editor.addUndoSnapshot(),this.editor.insertContent(t,{position:2,updateCursor:!1,replaceSelection:!0,insertOnNewLine:!0}),this.editor.triggerContentChangedEvent("Signature"),this.editor.addUndoSnapshot();else if("Text"==e&&this.plainTextEditor){var n=this.plainTextEditor.selectionEnd,r=this.plainTextEditor.value.substr(0,n)+t+this.plainTextEditor.value.substr(n);this.plainTextEditor.value=r}},e.prototype.insertAppendOnSend=function(e){var t=this,n=this.viewState.appendOnSend,r="",a="MailComposeAppendOnSend";if("HTML"==e&&this.editor){n.map(function(e){var n=e.txt;e.typ===l.d.Text&&(n=t.escapeAppendOnSendForHtml(n)),r+=n});var i=this.editor.queryElements("div#appendonsend");if(0==i.length)Object(f.k)(a,["End","HTML"]),this.editor.insertContent(r,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!0});else for(var o=0;o<i.length;o++){var s=i[o];if("appendonsend"===s.id&&""===s.innerHTML){Object(f.k)(a,["Div","HTML"]),s.innerHTML=r;break}}}else if("Text"==e&&this.plainTextEditor){n.map(function(e){e.typ!==l.d.Html&&(r+="\n"+e.txt)}),Object(f.k)(a,["End","Text"]);var c=this.plainTextEditor.value+r;this.plainTextEditor.value=c}p(this.viewState)},e.prototype.escapeAppendOnSendForHtml=function(e){return e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")).replace(/'/g,"&#39;")).replace(/\//g,"&#x2F;")},e.prototype.moveCaretBelowHtmlElement=function(e){this.editor?this.placeCursorAfterElement(e):this.replyWithTextElementId=e},e.prototype.isEmpty=function(){return this.editor&&this.editor.isEmpty()},e.prototype.removeInlineImage=function(){var e=this;this.editor.queryElements("img",function(t){e.editor.deleteNode(t)})},e.prototype.getTextContent=function(){return this.editor&&this.editor.getTextContent()},e.prototype.insertContentIntoEditor=function(e,t,n,r){var a="HTML"==this.viewState.bodyType;if(a&&this.editor)r&&this.editor.focus(),this.editor.addUndoSnapshot(),this.editor.insertContent(e,{insertOnNewLine:n,position:n?1:2,replaceSelection:!1,updateCursor:!n}),this.editor.triggerContentChangedEvent(t),this.editor.addUndoSnapshot();else if(!a&&this.plainTextEditor){var i=this.plainTextEditor.selectionStart,o=this.plainTextEditor.selectionEnd;n?(this.plainTextEditor.value+=e,this.plainTextEditor.selectionStart=i,this.plainTextEditor.selectionEnd=o):this.plainTextEditor.value=this.plainTextEditor.value.substr(0,i)+e+this.plainTextEditor.value.substr(o)}r&&a||this.updateContentToViewState()},e.prototype.placeCursorAfterElement=function(e){var t=this.editor.getDocument().getElementById(e);t&&(this.editor.focus(),this.editor.select(t,-3))},e}(),g=function(){function e(){var e=this;this.scrollListeners=[],this.scrollContainerChangedListeners=[],this.cachedElementPosition=NaN,this.onScroll=function(){e.scrollListeners.forEach(function(e){return e()})}}return e.prototype.setScrollContainer=function(e){var t=this;this.scrollContainer&&this.scrollContainer.removeEventListener("scroll",this.onScroll),this.scrollContainer=e,this.scrollContainerChangedListeners.forEach(function(e){return e(t.scrollContainer)}),this.scrollContainer&&this.scrollContainer.addEventListener("scroll",this.onScroll)},e.prototype.addScrollEventListener=function(e){this.scrollListeners.indexOf(e)<0&&this.scrollListeners.push(e)},e.prototype.removeScrollEventListener=function(e){var t=this.scrollListeners.indexOf(e);t>=0&&this.scrollListeners.splice(t,1)},e.prototype.addScrollContainerChangedListener=function(e){this.scrollContainerChangedListeners.indexOf(e)<0&&this.scrollContainerChangedListeners.push(e)},e.prototype.removeScrollContainerChangedListener=function(e){var t=this.scrollContainerChangedListeners.indexOf(e);t>=0&&this.scrollContainerChangedListeners.splice(t,1)},e.prototype.getScrollContainer=function(){return this.scrollContainer},e.prototype.saveElementPosition=function(e){e&&this.scrollContainer?this.cachedElementPosition=e.offsetTop-this.scrollContainer.scrollTop:this.cachedElementPosition=NaN},e.prototype.restoreElementPosition=function(e){e&&this.scrollContainer&&!isNaN(this.cachedElementPosition)&&"number"==typeof this.cachedElementPosition&&(this.scrollContainer.scrollTop=e.offsetTop-this.cachedElementPosition,this.cachedElementPosition=NaN)},e}(),h=2;var v=function(){function e(e){this.viewState=e,this.scrollAdapter=new g}return e.prototype.initialize=function(e){this.editor=e,this.scrollAdapter.addScrollContainerChangedListener(this.onScrollContainerChanged)},e.prototype.onPluginEvent=function(e){(2==e.eventType||1==e.eventType||6==e.eventType&&"SetContent"!=e.source)&&this.viewState.isBottomDocking&&this.scrollCursorIntoView()},e.prototype.scrollCursorIntoView=function(){var e=this;this.scrollThrottlingJob||(this.scrollThrottlingJob=window.setTimeout(function(){e.scrollThrottlingJob=0;var t=e.scrollAdapter.getScrollContainer();if(t&&e.editor){var n=t.getBoundingClientRect(),r=e.editor.getCursorRect();n&&r&&(t.scrollTop=function(e,t,n,r,a,i,o){void 0===o&&(o=h);var s=i-(r-e.bottomDockingHeight-e.scrollBarHeight)+o;return e.isBottomDocking&&s>0&&(t+=s),t}(e.viewState,t.scrollTop,n.top,n.bottom,r.top,r.bottom))}},100))},e.prototype.setDockingTriggerPart=function(e){this.dockingTriggerPart=e},e.prototype.setInitialVisiblePart=function(e){this.initialVisiblePart=e,this.tryScrollIntoView()},e.prototype.getScrollAdapter=function(){return this.scrollAdapter},e.prototype.dispose=function(){this.scrollAdapter.removeScrollContainerChangedListener(this.onScrollContainerChanged),this.editor=null},e.prototype.onContentSizeChanged=function(e,t){void 0===t&&(t=null);var n=this.scrollAdapter.getScrollContainer();if(n&&0!=e){var r=0,a=n.scrollHeight-n.clientHeight,i=n.scrollTop+e;if(i=Math.max(r,i),i=Math.min(i,a),t&&(r=Math.max(r,t.offsetTop+t.clientHeight-n.clientHeight),a=Math.min(a,t.offsetTop)),i!=n.scrollTop&&i>=r&&i<=a)n.scrollTop=i;else{var o=n.scrollTop;o<r?n.scrollTop=r:o>a&&(n.scrollTop=a)}}},e.prototype.getVisibleAreaInfo=function(){var e,t=this.scrollAdapter.getScrollContainer(),n=0;if(t&&t.scrollHeight!==t.clientHeight&&this.dockingTriggerPart){var r=t.scrollTop,a=t.clientHeight,i=this.dockingTriggerPart.offsetTop,o=this.dockingTriggerPart.offsetHeight;n=this.viewState.isBottomDocking?i+o-r-a+this.viewState.bottomDockingHeight:0}return this.dockingTriggerPart&&(e=this.dockingTriggerPart.offsetHeight-n),{top:0,bottom:n,visibleBodyHeight:e,visibleBodyWidth:this.viewState.dockingWidth||(this.dockingTriggerPart?this.dockingTriggerPart.offsetWidth:0)}},e.prototype.tryScrollIntoView=function(){var e=this.scrollAdapter.getScrollContainer();if(this.editor&&e&&this.initialVisiblePart){var t=e.getBoundingClientRect(),n=this.initialVisiblePart.getBoundingClientRect();n.bottom>t.bottom&&(e.scrollTop+=n.bottom-t.bottom),n.top<t.top&&(e.scrollTop+=n.top-t.top)}},e}(),y=n(4),b=Object(y.action)("updateDocking")(function(e,t,n,r,a,i){e.isBottomDocking=t,e.dockingWidth=a,e.scrollLeft=n,e.scrollBarHeight=r,e.bottomDockingBottom=i}),_=Object(y.action)("updateStickyDocking")(function(e,t){e.isBottomDocking=t});var S=n(181),C=function(e){function t(t){var n=e.call(this,t)||this;return n.onScrollContainerChanged=function(e){e?n.tryStartObserver():n.tryStopObserver()},n.calculateDockingWithThrottling=function(){n.dockingThrottlingJob||(n.dockingThrottlingJob=window.requestAnimationFrame(function(){n.dockingThrottlingJob=0,n.editor&&n.onCalculateDocking()}))},n.onCalculateDocking=function(){var e,t,r,a,i,o,s,c,l,u,d,p=n.scrollAdapter.getScrollContainer();if(n.viewState&&p&&n.dockingTriggerPart){var f=n.dockingTriggerPart.offsetWidth;e=n.viewState,t=p.scrollTop,r=p.scrollLeft,a=p.clientHeight,i=p.offsetHeight,o=n.dockingTriggerPart.offsetTop,s=n.dockingTriggerPart.offsetHeight,c=f,l=o+s>=t+a-e.bottomDockingHeight,u=Math.min(t+a-o-e.bottomDockingHeight-e.minBodyHeight,0),d=i-a,l==e.isBottomDocking&&c==e.dockingWidth&&r==e.scrollLeft&&d==e.scrollBarHeight&&u==e.bottomDockingBottom||b(e,l,r,d,c,u)}},"function"==typeof MutationObserver&&(n.observer=new MutationObserver(n.calculateDockingWithThrottling)),n}return r.__extends(t,e),t.prototype.getName=function(){return"Docking"},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.scrollAdapter.addScrollEventListener(this.calculateDockingWithThrottling),this.tryStartObserver(),S.a.importAndExecute(this.calculateDockingWithThrottling)},t.prototype.dispose=function(){S.c.importAndExecute(this.calculateDockingWithThrottling),this.tryStopObserver(),this.scrollAdapter.removeScrollEventListener(this.calculateDockingWithThrottling),this.dockingThrottlingJob&&(window.cancelAnimationFrame(this.dockingThrottlingJob),this.dockingThrottlingJob=0),e.prototype.dispose.call(this)},t.prototype.tryStartObserver=function(){var e=this.scrollAdapter.getScrollContainer();this.observer&&!this.observerConnected&&this.editor&&e&&(this.observer.observe(e,{childList:!0,attributes:!0,subtree:!0}),this.tryScrollIntoView(),this.calculateDockingWithThrottling(),this.observerConnected=!0)},t.prototype.tryStopObserver=function(){this.observer&&this.observerConnected&&(this.observer.disconnect(),this.observerConnected=!1)},t}(v),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onScrollContainerChanged=function(e){t.updateIntersectionObserver()},t}return r.__extends(t,e),t.prototype.getName=function(){return"StickyDocking"},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.scrolledIntoView=!1,this.updateIntersectionObserver()},t.prototype.dispose=function(){this.updateIntersectionObserver(),e.prototype.dispose.call(this)},t.prototype.setStickyBottomBorder=function(e){this.stickyBottomBorder=e,this.updateIntersectionObserver()},t.prototype.setInitialVisiblePart=function(t){e.prototype.setInitialVisiblePart.call(this,t),this.updateIntersectionObserver()},t.prototype.updateIntersectionObserver=function(){var e=this,t=this.scrollAdapter.getScrollContainer();this.stickyBottomBorder&&this.editor&&t?this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver(function(t){if(t[0]){var n=1!=t[0].intersectionRatio;_(e.viewState,n),n&&!e.scrolledIntoView&&e.tryScrollIntoView(),e.scrolledIntoView=!0}},{rootMargin:"0px",threshold:[1],root:t}),this.intersectionObserver.observe(this.stickyBottomBorder)):this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null)},t}(v),I=n(1261),O=n(1591),T=n(1622),x=n(1565),E=n(224),M=n(189),P=n(58);var k=n(825);var R=n(706),w=n(1271),N=function(){function e(){}return e.prototype.getName=function(){return"AddIn"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.plainTextEditor=null},e.prototype.isPlainTextEditor=function(){return!!this.plainTextEditor},e.prototype.setPlainTextEditor=function(e){this.plainTextEditor=e},e.prototype.updateContent=function(e,t){if(this.editor.getContent(!1)!=e){this.editor.setContent("");var n=this.createNodeFromContent(e);this.insertNode(n,{position:0,updateCursor:!0,replaceSelection:!1,insertOnNewLine:!1}),this.editor.select(n,-3),this.triggerContentChangedByAddinEvent(),this.editor.addUndoSnapshot()}},e.prototype.getContent=function(){return this.isPlainTextEditor()?this.plainTextEditor.value:this.editor.getContent()},e.prototype.getSelectedData=function(){if(this.isPlainTextEditor()){var e=this.plainTextEditor.selectionStart,t=this.plainTextEditor.selectionEnd;return{data:this.plainTextEditor.value.substring(e,t),sourceProperty:"body",startPosition:e,endPosition:t}}var n=this.editor.getSelectionRange(),r=n.cloneContents(),a=document.createElement("div");return a.appendChild(r),{data:a.innerHTML.length>0?a.innerHTML:null,sourceProperty:"body",startPosition:n.startOffset,endPosition:n.endOffset}},e.prototype.prependContent=function(e){if(this.isPlainTextEditor())this.plainTextEditor.value=e+this.plainTextEditor.value;else{var t=this.createNodeFromContent(e);this.insertNode(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1})}},e.prototype.setSelectedData=function(e){if(this.isPlainTextEditor()){var t=this.plainTextEditor.selectionStart,n=this.plainTextEditor.selectionEnd;this.plainTextEditor.value=this.plainTextEditor.value.substring(0,t)+e+this.plainTextEditor.value.substring(n+1)}else{var r=this.createNodeFromContent(e),a=this.editor.getSelectionRange()?2:1;this.insertNode(r,{position:a,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1})}},e.prototype.insertNode=function(e,t){this.editor.addUndoSnapshot(),this.editor.focus(),this.triggerContentChangedByAddinEvent(),this.editor.insertNode(e,t),this.triggerContentChangedByAddinEvent(),this.editor.addUndoSnapshot()},e.prototype.createNodeFromContent=function(e){var t=this.editor.getDocument().createElement("span");return t.innerHTML=e,t},e.prototype.triggerContentChangedByAddinEvent=function(){this.editor.triggerContentChangedEvent("Addins")},e}(),D=n(240),F=n(2),L=new F.c(function(){return Promise.all([n.e(1),n.e(9),n.e(19),n.e(32),n.e(83)]).then(n.bind(null,6965))}),U=Object(D.a)(L,function(e){return e.CortanaPickerPlugin},"CortanaCompose",function(e){return 1===e.eventType&&"/"==e.rawEvent.key}),B=new F.c(function(){return n.e(47).then(n.bind(null,7077))}),j=Object(D.a)(B,function(e){return e.AccCheckerPlugin},"AccChecker",null),H=(Object(F.d)(B,function(e){return e.AccCheckerPane}),n(1624)),V=new F.c(function(){return Promise.all([n.e(19),n.e(286),n.e(16),n.e(91)]).then(n.bind(null,7019))}),W=Object(D.a)(V,function(e){return e.EmojiPickerPlugin},"EmojiPicker",H.b);var G=new F.c(function(){return Promise.all([n.e(16),n.e(92)]).then(n.bind(null,7062))}),z=Object(D.a)(G,function(e){return e.EmojiPlugin},"Emoji",function(e,t){return 2===e.eventType});var q=new F.c(function(){return Promise.all([n.e(5),n.e(9),n.e(14),n.e(19),n.e(139)]).then(n.bind(null,6984))}),X=Object(D.a)(q,function(e){return e.LinkPlugin},"Link",function(e){return 6===e.eventType||7===e.eventType||0===e.eventType||1===e.eventType},!0);var K=new F.c(function(){return Promise.all([n.e(5),n.e(9),n.e(14),n.e(19),n.e(139)]).then(n.bind(null,6987))}),J=Object(D.a)(K,function(e){return e.AtMentionPickerPlugin},"AtMentionsPicker",function(e,t){if(1===e.eventType){var n=e.rawEvent;return"@"==n.key||"2"==n.key&&n.shiftKey}return!1}),Q=n(1263),Y=n(1237),Z=n(1345);var $=new F.c(function(){return n.e(232).then(n.bind(null,6991))}),ee=Object(D.a)($,function(e){return e.default},"SmartSuggestion",function(e,t){if(2===e.eventType){var n=e.rawEvent;if(n.which===Z.f||n.which===Z.m)return!0}return!1}),te=n(1272),ne=n(1262),re=n(5);n(1548);var ae,ie=new F.c(function(){return Promise.all([n.e(32),n.e(156)]).then(n.bind(null,7148))}),oe=Object(D.a)(ie,function(e){return e.default},"LinkPreview",function(e,t){if(6===e.eventType){var n=e;if(("AutoLink"===n.source||"SetContent"===n.source)&&t.getContent(!1).toLowerCase().indexOf("<a ")>=0)return!0}return!1}),se=n(386),ce=n(735),le=n(7),ue=n(9),de=n(1314),pe=n(357),fe=n(104),me=n(11),ge=n(90),he=n(218),ve=n(479),ye=n(697),be=n(1341),_e="Upload",Se="SmimeInline",Ce="Attachment",Ae="NullAttachmentUrl",Ie=new RegExp("^file:///[a-zA-Z]:","i"),Oe=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");!function(e){e[e.Started=0]="Started",e[e.PlaceholderShown=1]="PlaceholderShown"}(ae||(ae={}));var Te={position:2,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1},xe=function(){function e(e,t,n,r,a){var i=this;this.getInlineAttachmentStates=e,this.createAttachments=t,this.deleteInlineAttachments=n,this.convertContentIdToAttachmentUrl=r,this.processInlineImageAfterUploadSuccess=function(e,t,n){if(i.editor){var r=n.attachmentStore.get(e.Id).model,a=Object(he.d)(e.Id),o=a?i.getAttachmentUrlForSmime(r):Object(de.c)(e,1);o?i.replacePlaceholderImage(t,o,r.ContentId,r.Size,r.ContentType,a):ve.g.import().then(function(e){return e(Ce,"",Ae,"",a?Se:_e)})}},this.onCopy=function(e){Object(be.b)(e.currentTarget)},this.processNodeDeleted=function(e){for(var t=0;t<e.length;t++){var n=e[t].removedNodes;if(n)for(var r=0;r<n.length;r++){var a=n.item(r),o=i.getPendingPlaceholderForNode(a);o&&(me.c.info("InlineImagePlugin: Pending image placeholder removed from DOM. Deleting the attachment."),i.deleteInlineAttachments(o),i.imageStatusMap[o]&&delete i.imageStatusMap[o])}}i.disconnectMutationObserverIfNecessary()},ve.b.importAndExecute(),this.processInlineImageAfterUploadSuccess=Object(y.select)({attachmentStore:function(){return Object(he.b)().attachments}})(this.processInlineImageAfterUploadSuccess)}return e.prototype.getName=function(){return"InlineImage"},e.prototype.onPluginEvent=function(e){if(8==e.eventType)this.processInlineImage(e);else if(6==e.eventType){var t=e.source;"Addins"==t?this.convertAllContentIdToAttachmentUrl():"SetContent"!=t&&"UpgradeCompose"!=t||(this.loadInlineImages(),this.loadExternalImages())}},e.prototype.initialize=function(e){var t=this;this.editor=e,this.imageStatusMap={};var n=this.getInlineAttachmentStates(),r=Object(ue.computed)(function(){return n.map(function(e){return e.status})});this.onCopyDisposer=this.editor.addDomEventHandler("copy",this.onCopy),this.observer=new MutationObserver(this.processNodeDeleted),this.autorunDisposer=Object(ue.autorun)(function(){r.get().forEach(function(e,r){var a=n[r];a.isHiddenInline||1!=e&&2!=e&&3!=e||(1==e||3==e?t.processInlineImageAfterUploadSuccess(a.attachmentId,a.placeholderId):t.onImageError(null,a.placeholderId,null),M.s.importAndExecute(a,4))})})},e.prototype.dispose=function(){this.editor=null,this.observer.disconnect(),this.imageStatusMap=null,this.autorunDisposer(),Object(be.a)(),this.onCopyDisposer&&(this.onCopyDisposer(),this.onCopyDisposer=null)},e.prototype.processInlineImageBeforeUpload=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a=this;return r.__generator(this,function(r){switch(r.label){case 0:return this.editor&&this.imageStatusMap?(ve.h.import().then(function(e){return e(t.fileType.toString())}),t.fileType!=ye.a.Base64InlineImage?[3,1]:(this.imageStatusMap[e]={status:ae.PlaceholderShown,placeholder:t.imageNode},[3,4])):[2];case 1:return t.fileType!=ye.a.Local?[3,3]:(n=t.fileObject,this.imageStatusMap[e]={status:ae.Started},[4,M.m.import()]);case 2:return r.sent()(n,function(n,r){return a.insertPlaceholderImage(e,t.name,n,r)}),[3,4];case 3:ve.g.import().then(function(e){return e(t.fileType.toString(),"","UnsupportedFileType","",_e)}),r.label=4;case 4:return[2]}})})},e.prototype.insertPlaceholderImage=function(e,t,n,r){if(this.editor){var a=this.imageStatusMap[e];if(a&&a.status==ae.Started){this.editor.addUndoSnapshot();var i=this.generatePlaceholderNode(e,t,n,r);this.editor.insertNode(i,Te);var o=i.offsetWidth;o<n&&(i.style.height=Math.ceil(o/n*r).toString()),a.placeholder=i,a.status=ae.PlaceholderShown;var s=this.getContentEditableParent(i);s&&(me.c.info("InlineImagePlugin: Start observing on content editable div"),this.observer.observe(s,{subtree:!0,childList:!0}))}}},e.prototype.onSmimeUploadSuccess=function(e,t,n){var r=this.getImageElementsByContentId(e);if(r.length>0){var a=r[0],i=Object(de.c)(t,1);a.setAttribute("originalSrc","cid:"+n),ve.d.import().then(function(e){return e(a,i,Se)})}else me.c.error("S/MIME onSmimeUploadSuccess : Inline image target element not found for content id : "+e)},e.prototype.onImageLoad=function(e,t){if(this.editor){t.setAttribute("unselectable","on"),t.setAttribute("tabindex","-1"),t.style.msUserSelect="none",t.style.webkitUserSelect="none";var n=this.imageStatusMap[e];if(n&&n.status==ae.PlaceholderShown){var r=n.placeholder;this.editor.contains(r)?(r.removeAttribute("data-loadPending"),this.editor.replaceNode(r,t),this.editor.select(t,-3)):this.editor.insertNode(t,Te)}else this.editor.insertNode(t,Te);Object(ge.e)()?setTimeout(function(){ve.a.import().then(function(e){return e(t)})},1e3):ve.a.import().then(function(e){return e(t)}),delete this.imageStatusMap[e],this.addEditorUndoSnapshotIfNecessary(),this.disconnectMutationObserverIfNecessary(),t.onload=null}},e.prototype.onImageError=function(e,t,n){if(this.editor){var r=this.imageStatusMap[t];if(r&&r.status==ae.PlaceholderShown){var a=r.placeholder;a&&this.editor.deleteNode(a)}delete this.imageStatusMap[t],this.addEditorUndoSnapshotIfNecessary()}},e.prototype.processInlineImage=function(e){if(0==e.pasteOption){for(var t=e.fragment.querySelectorAll("img"),n=t.length,r=[],a=0,i=0;i<n;i++){var o=t[i],s=o.getAttribute("src");if(s&&0!==s.indexOf("blob:")&&0!==s.indexOf("webkit-fake-url:")&&!s.match(Ie)){var c=s.match(Oe);if(c&&3===c.length){var l={name:"pastedImagebase64"+a+++".png",size:0,type:c[1],dataUri:c[2],imageNode:o,fileType:ye.a.Base64InlineImage};r.push(l)}}else o.parentNode.removeChild(o)}r.length>0&&this.createAttachments(r,!0,!1,!1,this.processInlineImageBeforeUpload.bind(this))}else if(2==e.pasteOption){for(;e.fragment.firstChild;)e.fragment.removeChild(e.fragment.firstChild);e.pasteOption=0,this.createAttachmentsForLocalFiles(e.clipboardData.image)}},e.prototype.getImageElementsByContentId=function(e){return this.editor.queryElements('img[originalsrc^="cid:'+e+'"]')},e.prototype.replacePlaceholderImage=function(e,t,n,r,a,i){var o=this;void 0===i&&(i=!1);var s,c=!1;if(i){var l=this.getImageElementsByContentId(n);l.length>0&&(s=l[0],c=!0)}s||((s=this.editor.getDocument().createElement("img")).setAttribute("originalSrc","cid:"+n),s.setAttribute("size",r.toString()),s.setAttribute("contentType",a),s.style.maxWidth="100%"),ve.d.import().then(function(n){return n(s,t,i?Se:_e,c?null:function(t){o.onImageLoad(e,t)},c?null:function(n){o.onImageError(t,e,n)})})},e.prototype.generatePlaceholderNode=function(e,t,n,r){var a=this.editor.getDocument().createElement("div"),i=a.style;return 0!=n&&0!=r||(n=320,r=220),i.display="inline-block",i.maxWidth="100%",i.borderWidth="1px",i.borderStyle="dashed",i.borderColor=Object(fe.g)().themePrimary,i.boxSizing="border-box",i.width=n.toString()+"px",i.height=r.toString()+"px",a.title=t,a.contentEditable="false",a.setAttribute("tempid",e),a.setAttribute("data-loadPending","true"),a},e.prototype.createAttachmentsForLocalFiles=function(e){var t=Object(ye.e)([e])[0];t.name||(t.name="pastedImagefile.png"),this.createAttachments([t],!0,!1,!1,this.processInlineImageBeforeUpload.bind(this))},e.prototype.addEditorUndoSnapshotIfNecessary=function(){0==Object.keys(this.imageStatusMap).length&&(this.editor.triggerContentChangedEvent("InlineImage"),this.editor.addUndoSnapshot())},e.prototype.disconnectMutationObserverIfNecessary=function(){0===Object.keys(this.imageStatusMap).length&&(me.c.info("InlineImagePlugin: Disconnect mutation observer"),this.observer.disconnect())},e.prototype.getContentEditableParent=function(e){for(;e;){if("true"==e.contentEditable)return e;e=e.parentElement}return null},e.prototype.getPendingPlaceholderForNode=function(e){if("div"==e.nodeName.toLowerCase()&&e.hasAttribute("tempid")&&e.hasAttribute("data-loadPending"))return e.getAttribute("tempid");if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var n=this.getPendingPlaceholderForNode(e.childNodes[t]);if(n)return n}return null},e.prototype.convertAllContentIdToAttachmentUrl=function(){var e=this;this.editor.queryElements('img[src^="cid:"]',function(t){var n=t.src.substr("cid:".length),r=e.convertContentIdToAttachmentUrl(n);r&&(t.setAttribute("originalsrc","cid:"+r.contentId),ve.d.import().then(function(e){return e(t,r.url,"MoveFromAttachmentWell")}))})},e.prototype.loadInlineImages=function(){this.editor.queryElements("img["+pe.a+"]",function(e){ve.c.import().then(function(t){return t(e,"Compose",!1)})})},e.prototype.loadExternalImages=function(){this.editor.queryElements("img[data-imageproxyendpoint]",function(e){ve.f.import().then(function(t){return t(e,"Compose")})})},e.prototype.getAttachmentUrlForSmime=function(e){var t=e.Content;return"data:"+e.ContentType+";base64,"+t},e}();var Ee=new F.c(function(){return n.e(147).then(n.bind(null,7086))}),Me=Object(D.a)(Ee,function(e){return e.InlineImageResizePlugin},"InlineImageResize",function(e,t){if(5==e.eventType){var n=e.rawEvent.target;if(null!=n&&"IMG"==n.nodeName)return!0}return!1}),Pe=new F.b(Ee,function(e){return e.getSelectedImage});function ke(e){return function(t){!function(e,t){if(t.attachmentWell&&t.attachmentWell.inlineAttachments){for(var n=null,a=0;a<t.attachmentWell.inlineAttachments.length;++a){var i=t.attachmentWell.inlineAttachments[a];if(i.placeholderId==e&&0===i.status){n=i;break}}if(n){var o=r.__assign({},t.itemId,{mailboxInfo:Object(P.a)()});M.h.importAndExecute(t.attachmentWell,n,o,Object(E.a)(t),Object(E.c)(t))}}}(t,e)}}function Re(e){return function(){return e.subject}}function we(e,t){var n=e.docking.useStickyDocking?new A(e.docking):new C(e.docking),i=n.getScrollAdapter(),o=new xe(function(e){return function(){return e.attachmentWell.inlineAttachments}}(e),function(e){return function(t,n,a,i,o){var s={isInline:n,isHiddenInline:i},c=a?r.__assign({},s,{shouldShare:!0}):r.__assign({},s,{shouldShare:!1});Object(x.a)(t,e,c,o)}}(e),ke(e),function(e){return function(t){var n,a;if(e.attachmentWell&&e.attachmentWell.inlineAttachments)try{for(var i=r.__values(e.attachmentWell.inlineAttachments),o=i.next();!o.done;o=i.next()){var s=o.value,c=Object(k.a)(s.attachmentId);if(c&&c.thumbnailImage&&c.model&&(c.model.ContentId==t||c.model.Name==t))return{url:c.thumbnailImage.url,contentId:c.model.ContentId}}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return null}}(e)),s=null,c=null;Object(re.d)("cmp-newEmoji-plugin")?c=new W(e.emojiPicker,i,!0,{elementIdPrefix:"EMOJI",changeSource:"EmojiPicker",triggerCharacter:":",isHorizontal:!0,handleAutoComplete:!0}):s=new z(e.emoji,i,!0);var l=new J(e.atMentions,i,e.toRecipientWell,function(e){return function(){e.showCompactRecipientWell&&Object(O.a)(e)}}(e),Object(T.a)(e),function(e){return function(){return Object(ce.a)(Object(se.c)(e))}}(e),{elementIdPrefix:"OWAAM",changeSource:"AtMention",triggerCharacter:"@"}),u=Object(le.a)().SessionSettings.IsUserCultureRightToLeft,d={undo:t,dockingPlugin:n,ribbonPlugin:new Y.a(e.ribbon,Pe.import()),inlineImagePlugin:o,inlineImageResizePlugin:new Me(i),emojiPlugin:s,mentionsPickerPlugin:l,cortanaComposePlugin:Object(re.d)("mc-cortanaCompose")&&new U(i),emojiPickerPlugin:c,contentOperationPlugin:new m(e),smartSuggestionsPlugin:Object(re.d)("mc-smartSuggestions")?new ee:null,linkPreviewPlugin:new oe(i),addinPlugin:Object(re.d)("rp-addins")?new N:null,pasteOptionPlugin:new Q.a(e.pasteOption,i,u),tableEdit:new ne.b(e.tableEdit),accCheckerPlugin:Object(re.d)("cmp-accChecker")?new j(e.accChecker):null,linkPlugin:Object(re.d)("doc-attachment-sharingTips")?new X(e.attachmentWell,i,Object(se.c)(e),Object(R.a)(e.toRecipientWell)):null,smartComposePlugin:Object(w.a)()?new te.a(function(e){return function(){return Object(se.c)(e)}}(e),Re(e),e.operation):null};return Object(a.a)(e,d),Object(I.a)(e),d}n.d(t,"a",function(){return we})},1281:function(e,t,n){"use strict";var r=n(0),a=n(1623);function i(e,t){var n,r=function(e){var t=[];e.ToRecipients&&e.ToRecipients.forEach(function(e){return o(t,e.EmailAddress)});e.CcRecipients&&e.CcRecipients.forEach(function(e){return o(t,e.EmailAddress)});e.BccRecipients&&e.BccRecipients.forEach(function(e){return o(t,e.EmailAddress)});e.From&&o(t,e.From.Mailbox.EmailAddress);return t}(t),a=function(e){var t=[];return e.toRecipients.forEach(function(e){return o(t,e.persona.EmailAddress.EmailAddress)}),e.ccRecipients.forEach(function(e){return o(t,e.persona.EmailAddress.EmailAddress)}),e.bccRecipients.forEach(function(e){return o(t,e.persona.EmailAddress.EmailAddress)}),t}(e);return n=r,a.filter(function(e){return-1===n.indexOf(e)}).filter(function(e,t,n){return n.indexOf(e)===t})}function o(e,t){e.includes(t)||e.push(t)}var s=n(1271),c=n(1600),l=n(185),u=n(12),d=n(1272),p=n(5),f=n(709),m=n(305),g=n(162),h=n(58),v=n(22),y=n(554),b=n(1526),_=n(1539),S=n(1552),C=n(1322),A=n(1),I=n(224),O=n(697),T=n(276),x=n(189);function E(e,t,n,a,i){return r.__awaiter(this,void 0,void 0,function(){var o,s,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return[4,x.d.import()];case 1:return o=r.sent(),s=n.filter(function(e){return!((t=e).__type!==T.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE&&t.IsInline);var t}).map(o),c=s.filter(function(e){return e.fileType===O.a.Cloud}),(l=s.filter(function(e){return e.fileType===O.a.AttachmentItem})).length>0&&M(t,e,l,a,i,!1,!1),c.length>0&&M(t,e,c,a,i,!1,!0),[2]}})})}function M(e,t,n,a,i,o,s){var c={isInline:o,isHiddenInline:!1},l=s?r.__assign({},c,{shouldShare:!0}):r.__assign({},c,{shouldShare:!1});x.g.import().then(function(r){r(e,t,n,a,i,l)})}var P=n(20),k=n(8),R=n.n(k),w=n(826),N="InfoIncludeMostRecentAttachmentsMessage";function D(e,t,n,r,a,i,o,s){var c={key:N,source:w.c.Compose,rank:null,messageParts:[F(a,r)]};c.messageParts.push(function(e,t,n,r,a,i){return{text:n.Attachments.length>1?R.a.SuggestIncludeMostRecentAttachment_MultipleAttachmentsText:R.a.SuggestIncludeMostRecentAttachment_SingleAttachmentText,action:function(){i(),Object(u.k)("AttachmentIncludeMostRecentAttachments"),E(e,t,n.Attachments,r,a)}}}(e,n,t,i,o,s)),c.messageParts.push("|"),c.messageParts.push(function(e,t){return{text:R.a.DontIncludeMostRecentAttachments,action:function(){t(),e([N]),Object(u.k)("AttachmentDoNotIncludeMostRecentAttachments")}}}(o,s)),i(N,function(){return c})}function F(e,t){return e>1?Object(P.format)(R.a.IncludeMostRecentAttachmentAddedRecipient_MultipleRecipientsText,e):Object(P.format)(R.a.IncludeMostRecentAttachmentAddedRecipient_SingleRecipientText,t)}n.d(t,"b",function(){return B}),n.d(t,"a",function(){return V});var L="errorMessageNoRecipentsMailCanNotBeSend",U=[];function B(e){var t=U.indexOf(e);-1!==t&&U.splice(t,1)}function j(e){var t=V(e);t&&Object(f.a)(t,1)}function H(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a;return r.__generator(this,function(r){switch(r.label){case 0:return(n=V(e))?n.itemId||!n.groupId?[3,2]:[4,Object(m.b)(n)]:[2];case 1:r.sent(),r.label=2;case 2:return a=G(n),t?(i=n,Object(I.c)(i)([L]),W(n,a,t)):W(n,a),[2]}var i})})}function V(e){var t,n,a=null;if(e&&e.recipients)try{for(var i=r.__values(r.__spread(g.a.viewStates.values())),o=i.next();!o.done;o=i.next()){var s=o.value;if(z(G(s),e.recipients)){a=s;break}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}function W(e,t,n){if(e.referenceItemId){var a=Object(v.c)().items.get(e.referenceItemId.Id);if(a&&(c=e.composeId,-1===U.indexOf(c))){var o=i(t,a),s=o.length;!function(e,t,n){var r=e.operation;return Object(p.d)("doc-attachment-includeMostRecentAttachments")&&t&&n>0&&(1===r||2===r||4===r)}(e,a.HasAttachments,s)?function(e,t){return Object(p.d)("doc-attachment-includeMostRecentAttachments")&&X(e)&&0===t}(e,s)&&Object(I.c)(e)([N]):(!function(e){X(e)||Object(u.k)("AttachmentShowIncludeMostRecentAttachmentsMessage")}(e),D(r.__assign({},e.itemId,{mailboxInfo:Object(h.a)()}),a,e.attachmentWell,1===s?o[0]:n,s,Object(I.a)(e),Object(I.c)(e),q(e.composeId)))}}var c}function G(e){return{toRecipients:e.toRecipientWell?e.toRecipientWell.recipients:[],ccRecipients:e.ccRecipientWell?e.ccRecipientWell.recipients:[],bccRecipients:e.bccRecipientWell?e.bccRecipientWell.recipients:[]}}function z(e,t){return e.toRecipients===t||e.ccRecipients===t||e.bccRecipients===t}Object(A.orchestrator)(b.a,function(e){var t=e.recipientData,n=e.recipientWell,r=t.map(function(e){return Object(C.a)(e.newPersona,e.isValid,e.newEmailAddress)});Object(y.a)()&&j(n),function(e,t){var n=V(e);if(!n)return;Object(a.a)(n.composeId,e,t)}(n,r)}),Object(A.orchestrator)(S.a,function(e){H(e.recipientWellRecipients),Object(y.a)()&&j(e.recipientWellRecipients)}),Object(A.orchestrator)(_.a,function(e){var t,n,r=e.recipientWellRecipients,a=e.recipientData;a&&a.map(function(e){return Object(C.a)(e.newPersona,e.isValid,e.newEmailAddress)}).forEach(function(e){H(r,e.displayText)});if(Object(p.d)("rp-addins")){var i=V(e.recipientWellRecipients);if(i){var o=(t=i,(n=e.recipientWellRecipients)===t.toRecipientWell?l.f.To:n===t.ccRecipientWell?l.f.Cc:n===t.bccRecipientWell?l.f.Bcc:null);l.F.import().then(function(e){return e(i.composeId,o)}),Object(c.a)(i)}}Object(s.a)()&&d.b.importAndExecute(e.recipientWellRecipients.recipients)});var q=function(e){return function(){U.push(e)}};function X(e){return-1!==Object(I.b)(e)().indexOf(N)}},1284:function(e,t,n){"use strict";var r=n(511),a=n(1),i=Object(a.action)("setAppPaneUnderlayVisibility",function(e,t,n){return{key:e,isShown:t,shrinkable:n}});Object(a.mutator)(i,function(e){var t=Object(r.a)();e.isShown?t.shrinkable.set(e.key,e.shrinkable):t.shrinkable.delete(e.key),t.isShown.set(e.key,e.isShown)}),t.a=i},1287:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(7);function a(e){var t=Object(r.a)().UserOptions,n=!1;switch(e){case 0:n=t.AutoAddSignature;break;case 1:case 2:case 3:n=t.AutoAddSignatureOnReply}return n}},1314:function(e,t,n){"use strict";var r=n(129),a=n(830);n(267);function i(e,t,n,i){void 0===i&&(i=!0);var o=e,s=o.AttachmentId,c=o.Name,l=o.OriginalPermissionType,u=o.PermissionType,d=o.AttachLongPathName;switch(t){case 0:case 3:return a.b(s,d,t,n,u,l,i,c);case 1:return e.AttachmentPreviewUrl?e.AttachmentPreviewUrl:a.b(s,d,1,n,u,l,i,c);case 2:return e.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function o(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),a.a(e.mailboxInfo&&e.mailboxInfo.mailboxId,e,t,n,r)}function s(e,t,n,r,a,s){return void 0===s&&(s=!1),r?i(t,n,a):o(e,n,s)}n.d(t,"b",function(){return s}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return"/owa/"})},1316:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(268),a=n(45),i=n(548);function o(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(a.a)().search):""}},1318:function(e,t,n){"use strict";var r=n(1),a=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=a},1320:function(e,t,n){"use strict";var r=n(1),a=n(217),i={expressionPickerViewState:null,selectedSkinTone:Object(a.c)(a.a.DiverseEmojis).diverseEmojisSelectedSkinTone,useFlexPane:null},o=Object(r.createStore)("expression",i)();t.a=o},1321:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(1),a=Object(r.action)("ADD_SHAREPOINT_LINK",function(e,t,n,r){return{linkId:e,url:t,sharingLinkIds:n,response:r}}),i=Object(r.action)("REMOVE_SHARING_LINK",function(e,t){return{linkId:e,sharingLinkIds:t}})},1322:function(e,t,n){"use strict";var r=n(724),a=n(47);t.a=function(e,t,n){e||(e={EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:n,Name:n}});var i=e.EmailAddress.Name?e.EmailAddress.Name:e.EmailAddress.EmailAddress;if(!Object(a.a)()){var o=e.EmailAddress.EmailAddress?e.EmailAddress.EmailAddress.split("@")[1]:"",s="ExternalMailbox"===e.EmailAddress.MailboxType||"LinkedIn"===e.EmailAddress.MailboxType;!i||Object(r.a)(i)&&i.split("@")[1]===o||!s||(i=i+" ("+o+")")}return{persona:e,displayText:i,isValid:t,isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1}}},1324:function(e,t,n){"use strict";function r(e){return e.localizedName?e.localizedName:e.name}var a=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','',STHeiti,sans-serif",localizedName:""},{name:"SimHei",family:"SimHei,'',STHeiti,sans-serif",localizedName:""},{name:"NSimSun",family:"NSimSun,'',SimSun,'',SimSun-ExtB,'-ExtB',STSong,serif",localizedName:""},{name:"FangSong",family:"FangSong,'',STFangsong,serif",localizedName:""},{name:"SimLi",family:"SimLi,'','Baoli SC',serif",localizedName:""},{name:"KaiTi",family:"KaiTi,'',STKaiti,serif",localizedName:""},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','','Apple LiGothic',sans-serif",localizedName:""},{name:"PMingLiU",family:"PMingLiU,'',PMingLiU-ExtB,'-ExtB','Apple LiSung',serif",localizedName:""},{name:"DFKai-SB",family:"DFKai-SB,'','BiauKai',serif",localizedName:""},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'','Hiragino Sans',sans-serif",localizedName:""},{name:"MS PGothic",family:"'MS PGothic',' ','MS Gothic',' ','Hiragino Kaku Gothic ProN',sans-serif",localizedName:" "},{name:"MS PMincho",family:"'MS PMincho',' ','MS Mincho',' ','Hiragino Mincho ProN',serif",localizedName:" "},{name:"Yu Gothic",family:"'Yu Gothic','','YuGothic',sans-serif",localizedName:""},{name:"Yu Mincho",family:"'Yu Mincho','','YuMincho',serif",localizedName:""},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic',' ',AppleGothic,sans-serif",localizedName:" "},{name:"Gulim",family:"Gulim,'','Nanum Gothic',sans-serif",localizedName:""},{name:"Dotum",family:"Dotum,'',AppleGothic,sans-serif",localizedName:""},{name:"Batang",family:"Batang,'',AppleMyungjo,serif",localizedName:""},{name:"BatangChe",family:"BatangChe,'',AppleMyungjo,serif",localizedName:""},{name:"Gungsuh",family:"Gungsuh,'',GungSeo,serif",localizedName:""},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function i(e){for(var t=e.toUpperCase(),n=0;n<a.length;n++){var r=a[n];if(r.name.toUpperCase()==t||r.localizedName&&r.localizedName.toUpperCase()==t)return r.family}return null}var o="pt",s=[8,10,12,14,18,24,36],c=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],l=c.map(function(e){return e.toString()});function u(e){return"number"==typeof e&&e<=7?s[e-1]:e}function d(e){var t=u(e).toString();return t?t+o:t}n.d(t,"g",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return l}),n.d(t,"e",function(){return u}),n.d(t,"f",function(){return d})},1325:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a=new r.c(function(){return Promise.all([n.e(16),n.e(96)]).then(n.bind(null,1871))}),i=new r.a(a,function(e){return e.closeExpressionPane})},1327:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return i});var r="c026002d-cda6-401e-bfad-28de214d0fba",a="cf5cf348-a8d7-40d5-91ef-a600b88a395d",i=r},1328:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("onMailTipRetrieved",function(e,t){return{composeId:e,fromAddress:t}})},1341:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return d});var r,a=n(1586),i=n(1239),o=n(12),s=n(7),c="none",l=function(){function e(){var e=this;this.restoreImageAttributes=function(){if(e.imagesToRestore)for(var t=e.imagesToRestore.pop();t;){var n=t.image,r=t.sourceToRestore,a=t.shouldSetUserSelectNone;r&&(n.src=r),a&&(n.style.webkitUserSelect=c),t=e.imagesToRestore.pop()}},this.imagesToRestore=[]}return e.prototype.dispose=function(){this.imagesToRestore=null},e.prototype.handleCopy=function(e){for(var t=e.getElementsByTagName("img"),n=t.length,r=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,l=Object(s.a)().ApplicationSettings.DownloadUrlBase,u=window.location.origin,d=0;d<n;d++){var p=t[d],f=p.getAttribute("src");if(f&&(0==f.indexOf(l)||0==f.indexOf(u))){var m=p.getAttribute("originalsrc"),g=i.a.inlineImages[m];if(g||(g=Object(a.a)(p)),g){var h=null,v=!1,y=p.getAttribute("contenttype");y&&-1!=y.indexOf("gif")&&(h=f),r&&p.style.webkitUserSelect==c&&(p.style.webkitUserSelect="all",v=!0),(h||v)&&this.imagesToRestore.push({image:p,sourceToRestore:h,shouldSetUserSelectNone:v}),p.src=g}else Object(o.k)("ImageCopyHandlerNullDataURI")}}this.imagesToRestore.length>0&&setTimeout(this.restoreImageAttributes,500)},e}();function u(e){r||(r=new l),r.handleCopy(e)}function d(){r&&(r.dispose(),r=null)}},1345:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"f",function(){return a}),n.d(t,"m",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return u}),n.d(t,"i",function(){return d}),n.d(t,"j",function(){return p}),n.d(t,"l",function(){return f}),n.d(t,"n",function(){return m}),n.d(t,"k",function(){return g}),n.d(t,"a",function(){return h});var r=8,a=13,i=32,o=46,s=48,c=57,l=65,u=90,d=96,p=105,f=186,m=192,g=219,h=222},1346:function(e,t,n){"use strict";var r=n(0),a=n(943),i=n(386),o=n(845),s=n(848);var c=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function l(e){var t=0;if(e){var n=e.match(c);t=n?n.length:0}return t}var u=n(5),d=n(1530);var p=n(577),f=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),m=new RegExp('\\sSRC\\s*=\\s*"[\\s\\S]+?"',"im"),g=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function h(e,t){return e?e.replace(f,function(e){return e=e.replace(m,""),t&&(e=e.replace(g,' src="')),e}):e}var v=n(7),y=n(910),b=n.n(y),_=n(318),S=n.n(_),C=n(119),A=n.n(C),I=35356;function O(e,t){if(t.ExtendedProperty)for(var n=e.length;n--&&t.ExtendedProperty.length>0;)for(var r=t.ExtendedProperty.length;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}function T(e,t,n){var r,a;n?O(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(a=t).ExtendedProperty||(a.ExtendedProperty=[]),a.ExtendedProperty.push(S()({Value:JSON.stringify(r),ExtendedFieldURI:A()({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function x(e,t){e.internetHeaders.size>0&&function(e,t){var n,a;t.ExtendedProperty||(t.ExtendedProperty=[]);try{for(var i=r.__values(e.keys()),o=i.next();!o.done;o=i.next()){var s=o.value;t.ExtendedProperty.push(S()({Value:e.get(s),ExtendedFieldURI:A()({DistinguishedPropertySetId:"InternetHeaders",PropertyName:s,PropertyType:"String"})}))}}catch(e){n={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&O(e.keysOfInternetHeadersToBeRemoved,t)}var E=n(280),M=n(1618),P=n(1),k=Object(P.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",function(e){e.keysOfInternetHeadersToBeRemoved=[]}),R=n(761),w=n(703),N=n(4),D=Object(N.action)(w.c)(function(e,t,n){}),F=n(474),L=n(975),U=n(713),B=n(10),j=n(39),H=n(535),V=n(59),W=n(944),G=n(1279),z=n(1654),q=n.n(z),X=n(1655),K=n.n(X),J=n(187),Q=n.n(J),Y=n(33),Z=n.n(Y),$=n(31);function ee(e,t,n,r,a){var i=function(e,t,n,r,a){var i=K()({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",OutboundCharset:"AutoDetect",Items:[t],TimeFormat:r,ItemShape:Q()({BaseShape:"IdOnly",AdditionalProperties:[Z()({FieldURI:"ItemLastModifiedTime"})]})});return a&&(i.ItemShape.ReturnOnlyInternetMessageId=!0),i}(e,t,0,r,a);return q()({Header:Object($.getJsonRequestHeader)(),Body:i}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var te=n(1656),ne=n.n(te),re=n(1657),ae=n.n(re);function ie(e,t,n,r,a,i){var o=function(e,t,n,r,a){var i=ae()({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Q()({BaseShape:"IdOnly",AdditionalProperties:[Z()({FieldURI:"ItemLastModifiedTime"})]})});return a&&(i.ItemShape.ReturnOnlyInternetMessageId=!0),i}(e,t,0,0,i);return ne()({Header:Object($.getJsonRequestHeader)(),Body:o},a).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var oe=n(552),se=n.n(oe),ce=n(742),le=n.n(ce);var ue=n(363),de=n(973),pe=n.n(de);function fe(e,t){return pe()({Path:A()({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var me=n(556),ge=n.n(me),he=n(167),ve=n.n(he),ye=n(558),be=n.n(ye),_e=n(557),Se=n.n(_e);function Ce(e,t,n,a,i){var o=[];e.MimeContent&&o.push(Object(ue.a)("MimeContent",e.MimeContent));var s=[Object(ue.a)("ToRecipients",e.ToRecipients),Object(ue.a)("CcRecipients",e.CcRecipients),Object(ue.a)("BccRecipients",e.BccRecipients),Object(ue.a)("Subject",e.Subject),Object(ue.a)("Body",e.Body),Object(ue.a)("Importance",e.Importance),Object(ue.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(ue.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];e.ItemClass&&s.push(Object(ue.a)("ItemClass",e.ItemClass)),e.From&&s.push(Object(ue.a)("From",e.From)),a.length>0&&a.map(function(e){s.push(fe("InternetHeaders",e))}),t&&s.push(fe("Common","AppendOnSend")),e.MentionsEx&&s.push(Object(ue.a)("MentionsEx",e.MentionsEx)),e.Sensitivity&&s.push(Object(ue.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map(function(e){s.push(function(e){return le()({Path:A()(e.ExtendedFieldURI),Item:se()({ExtendedProperty:[S()(e)]})})}(e))}),t&&i&&i.length>0&&s.push(Object(ue.a)("DocLinks",i));var c=ge()({Updates:r.__spread(o,s),ItemId:ve()({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),l=be()({ItemChanges:[c],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",OutboundCharset:"AutoDetect",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Q()({BaseShape:"IdOnly",AdditionalProperties:[Z()({FieldURI:"ItemLastModifiedTime"})]})});return n&&n.IsOwner&&(l.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),l}function Ae(e,t,n,r,a){var i=Ce(e,t,n,r,a);return Se()({Header:Object($.getJsonRequestHeader)(),Body:i}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var Ie=n(22),Oe="InternetHeaders",Te="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",xe="X-Ms-Exchange-Organization-Dlp-FalsePositive";var Ee=n(1658),Me=n.n(Ee),Pe=n(878),ke=n.n(Pe),Re=n(1659),we=n.n(Re),Ne=n(1660),De=n.n(Ne),Fe=n(1288),Le=n.n(Fe),Ue=n(1289),Be=n.n(Ue),je=n(47),He=n(279),Ve=n(307),We=n(730),Ge=n(522),ze=n(20);n.d(t,"c",function(){return $e}),n.d(t,"b",function(){return et}),n.d(t,"a",function(){return tt});var qe='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',Xe="IPM.Note";function Ke(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,i,o,s,c,l;return r.__generator(this,function(r){switch(r.label){case 0:return(a=Object(F.b)(e))&&a.mentionsPickerPlugin&&a.mentionsPickerPlugin.isImported()?[4,a.mentionsPickerPlugin.getPlugin()]:[3,2];case 1:i=r.sent(),o=i.dataProvider,t?(s=Object(v.a)().SessionSettings,(c=o.getMentionsWrappersForSend({MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:s.UserEmailAddress,Name:s.UserDisplayName}))&&c.length>0&&(n.MentionsEx=c)):(l=o.getPendingTagsForSave()).length>0&&(n.PendingSocialActivityTagIds=l),r.label=2;case 2:return[2]}})})}function Je(e){var t=e.content;if("HTML"==e.bodyType){var n=e.explicitTextDirection||(Object(v.a)().SessionSettings.IsUserCultureRightToLeft?L.a.RTL:L.a.LTR);t=h(t),t=Object(ze.format)(qe,n,t)}var a,i=ke()({BodyType:e.bodyType,Value:t});i.DataUriCount=l(e.content);var o={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};return a=we()(r.__assign({},o,{Body:i})),e.itemId&&(a.ItemId=e.itemId),e.fromViewState&&function(e,t){var n=e.from;t.From=b()({Mailbox:n.email})}(e.fromViewState,a),a}function Qe(e){var t=e.content,n=Object(We.a)(e.smimeViewState);if(e.useSmartResponse&&(t+=Object(U.a)(e.bodyType)),"HTML"==e.bodyType){var i=e.explicitTextDirection||(Object(v.a)().SessionSettings.IsUserCultureRightToLeft?L.a.RTL:L.a.LTR);t=h(t,n),t=Object(ze.format)(qe,i,t)}var o=ke()({BodyType:e.bodyType,Value:t});o.DataUriCount=l(e.content);var s,c=Object(a.a)(e.itemId),u=Object(a.a)(e.referenceItemId),d=Object(p.a)(e.toRecipientWell),f=Object(p.a)(e.ccRecipientWell),m=Object(p.a)(e.bccRecipientWell),g={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:d,CcRecipients:f,BccRecipients:m,Sensitivity:e.sensitivity};return e.useSmartResponse?s=(2==e.operation?Le.a:Be.a)(r.__assign({},g,{UpdateResponseItemId:c,ReferenceItemId:u,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:o})):5==e.operation||6==e.operation?s=(5==e.operation?Me.a:De.a)(r.__assign({},g,{ReferenceItemId:u,Body:o})):(s=se()(r.__assign({},g,{Body:o})),e.itemId&&(s.ItemId=e.itemId)),e.fromViewState&&function(e,t){var n=e.from;if(n){var r=!1,a=Object(v.a)().SessionSettings.ConnectedAccountInfos;if(a)for(var i=0;i<a.length;i++){var o=a[i];if(o.EmailAddress==n.email.EmailAddress){r=!0;var s=S()({Value:o.SubscriptionGuid,ExtendedFieldURI:A()({PropertyId:I,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(s):t.ExtendedProperty=[s],t.From=b()({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:o.DisplayName}});break}}r||(t.From=b()({Mailbox:n.email}))}}(e.fromViewState,s),s}function Ye(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,c,l,d,p,f,m,g;return r.__generator(this,function(h){switch(h.label){case 0:return c=Object(v.a)().UserOptions.TimeFormat,Object(H.b)(e)?(l=e,n=Je(e),[4,Object(W.a)(n,e.bodyType,t,c,e.isInlineCompose,e.IRMData,l.publicFolderId)]):[3,2];case 1:return a=h.sent(),[3,11];case 2:return n=Qe(e),x(e,n),T(e,n,t),[4,Ke(e,t,n)];case 3:if(h.sent(),!Object(We.a)(e.smimeViewState))return[3,8];h.label=4;case 4:return h.trys.push([4,6,,7]),d=function(e,t,n){var a,c=e.smimeViewState||Object(s.a)(),l=c.shouldSignMessageAsSmime,u=c.shouldEncryptMessageAsSmime,d=c.signingCertRawData,p=e.attachmentWell,f=p.docViewAttachments,m=p.inlineAttachments;return(a=f.slice(0)).push.apply(a,r.__spread(m)),{shouldSignMessageAsSmime:l,shouldEncryptMessageAsSmime:u,message:t,fromAddress:Object(o.a)(),isSend:n,composeId:e.composeId,signingCertRawData:d,allRecipients:Object(i.a)(e),attachments:a}}(e,n,t),[4,He.m.import().then(function(e){return e(d)})];case 5:return h.sent(),[3,7];case 6:return p=h.sent(),(g=new Error).message=p.message==Ve.a?Ve.a:"SmimeEncodeError",[2,Promise.reject(g)];case 7:return[3,9];case 8:Object(u.d)("cmp-smime")&&e.itemId&&(f=Object(Ie.c)().items.get(e.itemId.Id))&&Object(Ge.a)(f.ItemClass)&&(n.ItemClass=Xe),h.label=9;case 9:return t&&function(e){var t=[];if(e.isReportedFalsePositive){var n={ExtendedFieldURI:{PropertyName:xe,PropertyType:"String",DistinguishedPropertySetId:Oe},Value:""};t.push(n)}e.isOverridden&&(n={ExtendedFieldURI:{PropertyName:Te,PropertyType:"String",DistinguishedPropertySetId:Oe},Value:e.overrideJustification},t.push(n));return t}(e.policyTipsViewState).map(function(e){return r=e,void(null==(t=n).ExtendedProperty?t.ExtendedProperty=[r]:t.ExtendedProperty.push(r));var t,r}),[4,Ze(e,n,c,t)];case 10:a=h.sent(),h.label=11;case 11:return k(e),(m=a&&a.ResponseMessages&&a.ResponseMessages.Items?a.ResponseMessages.Items[0]:a&&!a.ResponseMessages?a:null)&&"Success"==m.ResponseClass?[2,Promise.resolve(m)]:(Object(M.d)(a,e),g=void 0,m?(g=new Error(m.ResponseCode)).messageText=m.MessageText:g=new Error("Unrecognized response"),[2,Promise.reject(g)])}})})}function Ze(e,t,n,a){return r.__awaiter(this,void 0,void 0,function(){var i,o,s,c,l,p;return r.__generator(this,function(r){switch(r.label){case 0:return Object(E.b)(e)?a&&3!=e.operation?Object(je.a)()||e.itemId||t.RightsManagementLicenseData?[4,ee(e.groupId,t,e.bodyType,n,e.isInlineCompose)]:[3,2]:[3,4]:[3,6];case 1:return[2,r.sent()];case 2:return i=Object(j.m)(e.groupId),[4,ie(e.groupId,t,e.bodyType,0,i.requestOptions,e.isInlineCompose)];case 3:return[2,r.sent()];case 4:return o=1==e.operation||2==e.operation,!e.itemId&&o||e.useSmartResponse?[4,Object(G.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)]:[3,6];case 5:return[2,r.sent()];case 6:return s=Object(V.c)(),c=!(!s||s.treeType!==B.j&&s.treeType!==B.c),l=a?function(e){var t=[];return Object(u.d)("doc-attachment-sharingDialog")||Object(u.d)("doc-attachment-docLinksProperty")?(e.attachmentWell.sharingLinkIds.forEach(function(e){var n=Object(d.f)(e),r=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel);if(1===r||2===r){var a={ProviderType:"OneDrivePro",Url:n.url,PermissionType:r};t.push(a)}}),t):t}(e):null,!e.useSmartResponse&&e.itemId?[3,8]:[4,Object(W.a)(t,e.bodyType,a,n,e.isInlineCompose,e.IRMData,null,c)];case 7:return p=r.sent(),[3,10];case 8:return[4,Ae(t,a,e.IRMData,e.keysOfInternetHeadersToBeRemoved,l)];case 9:p=r.sent(),r.label=10;case 10:return[2,p]}})})}function $e(e){return Ye(e,!0)}function et(e){return Ye(e,!1)}function tt(e,t){var n=function(e){if(e&&e.Items)return e.Items[0];if(e&&e.Item)return e.Item;return null}(e);return!!n&&(n.ItemId&&(Object(R.a)(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&D(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId),!0)}},1515:function(e,t,n){"use strict";function r(e){return null==e||0==e.trim().length}n.d(t,"a",function(){return r})},1517:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={}))},1526:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("addReadWriteRecipients",function(e,t,n){return void 0===n&&(n=!0),{recipientWell:e,recipientData:t,resetFindResult:n}});t.a=a},1528:function(e,t,n){"use strict";var r=n(828),a=n(47),i=n(20),o=n(267),s="/owa/",c="service.svc/s/GetFileAttachment?id={0}",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",u="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",p="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",m="pdfprint.aspx?id={0}&location={1}",g=n(110),h=n(168);var v=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var y=n(129);function b(e,t,n,r,a,c,u,p){var f;switch(void 0===a&&(a=0),void 0===c&&(c=0),void 0===u&&(u=!0),void 0===p&&(p=null),n){case 0:f=l;break;case 3:f=m;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&v.indexOf(t.toLowerCase())>=0}(p))return null;f=d;break;default:Object(y.a)(n)}var g=r?c:a;!g&&a&&(g=a);var h=Object(i.format)("{0}{1}&permissionLevel={2}",s,Object(i.format)(f,encodeURIComponent(e.Id),encodeURIComponent(t)),g);u&&(h=h+"&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)());return h}function _(e,t,n,l,d){var m;switch(void 0===l&&(l=!1),void 0===d&&(d=!0),n){case 0:m=c;break;case 1:m=u;break;case 2:m=p;break;case 3:m=f;break;default:return Object(y.a)(n)}return Object(i.isStringNullOrWhiteSpace)(m)?null:Object(i.format)("{0}{1}{2}",function(e,t,n,c,l){if(void 0===l&&(l=!1),!t||!t.Id)return null;var u=Object(i.format)(n,encodeURIComponent(t.Id));if(!Object(r.c)()||l&&"Firefox"===Object(g.a)().browser)return s+u+"&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)();var d="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(a.a)()&&(d+="&isc=1");var p=Object(i.format)(d,Object(r.b)(),e,u,window.location.hostname,Object(h.d)()||"unofficial");return c&&(p+="&X-OWA-CANARY="+Object(o.getOwaCanaryCookie)(),p+="&token="+Object(r.a)()),p}(e,t,m,d,3===n),l?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return b}),n.d(t,"a",function(){return _})},1530:function(e,t,n){"use strict";var r=n(1242);function a(){return Object(r.a)().sharingLinks.size}var i=n(1233);function o(e){var t=Object(i.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored}:null}var s=n(1540),c=n(2),l=n(1321),u=n(829);n.d(t,"l",function(){return p}),n.d(t,"g",function(){return f}),n.d(t,"k",function(){return m}),n.d(t,"m",function(){return g}),n.d(t,"i",function(){return h}),n.d(t,"h",function(){return v}),n.d(t,"j",function(){return y}),n.d(t,"b",function(){return l.a}),n.d(t,"n",function(){return l.b}),n.d(t,"r",function(){return u.e}),n.d(t,"p",function(){return u.c}),n.d(t,"q",function(){return u.d}),n.d(t,"o",function(){return u.b}),n.d(t,"c",function(){return u.a}),n.d(t,"a",function(){return s.a}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return i.a});var d=new c.c(function(){return n.e(155).then(n.bind(null,6980))}),p=new c.b(d,function(e){return e.updateHasDLRecipient}),f=new c.b(d,function(e){return e.addRecipientsIntoLink}),m=new c.b(d,function(e){return e.removeRecipientsFromLink}),g=new c.b(d,function(e){return e.updateRecipientPermissionInfo}),h=new c.b(d,function(e){return e.ignoreSharingTip}),v=new c.b(d,function(e){return e.getSharingTipRecipientInfo}),y=new c.b(d,function(e){return e.linkBootStrap})},1532:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),i=n(20),o=n(1515),s=n(11),c=n(28);function l(e,t,n,r,l,u,d,p){if(void 0===p&&(p=Object(c.ob)()),!e)return s.c.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(o.a)(e.clientSessionId))return s.c.warn(Object(i.format)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var f={ClientEventTimeUtc:Object(c.Y)(p),ClientEventTimeLocal:Object(c.W)(p),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:r,EntityAddSource:l,JsonPropertyBag:u,ScenarioName:d||e.entityScenarioName};return a(e),f}n.d(t,"a",function(){return l})},1539:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("onRecipientsChanged",function(e,t){return{recipientWellRecipients:e,recipientData:t}});t.a=a},1540:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded"}(r||(r={}))},1542:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(r||(r={}))},1548:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(2),a=new r.c(function(){return Promise.all([n.e(32),n.e(156)]).then(n.bind(null,1874))}),i=new r.b(a,function(e){return e.createLinkPreview}),o=new r.b(a,function(e){return e.rehydrateLinkPreview})},1552:function(e,t,n){"use strict";var r=n(1),a=Object(r.action)("removeRecipientFromRecipientWell",function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,selectToRight:n,onRecipientDeletedCallback:r}});t.a=a,Object(r.orchestrator)(a,function(e){e.recipientWellRecipients.isDirty=!0;var t=e.recipientWellRecipients.recipients.splice(e.recipientIndex,1);e.onRecipientDeletedCallback(t,e.recipientIndex,e.recipientWellRecipients,e.selectToRight)})},1563:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a=new r.c(function(){return Promise.all([n.e(287),n.e(16),n.e(95)]).then(n.bind(null,1870))}),i=new r.a(a,function(e){return e.showExpressionPane});Object(r.d)(a,function(e){return e.ExpressionPane})},1565:function(e,t,n){"use strict";var r=n(0),a=n(224),i=n(4),o=Object(i.action)("setNumberOfWaitingAttachments")(function(e,t){t<0||(e.numberOfWaitingAttachments=t)}),s=n(305),c=n(63),l=n(5),u=n(709),d=n(554),p=n(279),f=n(730),m=n(11),g=n(189);function h(e,t,n,r){if(e.isInline)for(var a=t.length,i=n.attachmentWell.inlineAttachments.length,o=0;o<a;o++){var s=n.attachmentWell.inlineAttachments[i-a+o];r&&r(s.placeholderId,t[o])}}function v(e,t,n,i,v,y,b,_){return r.__awaiter(this,void 0,void 0,function(){var S,C;return r.__generator(this,function(A){switch(A.label){case 0:S=!1,Object(l.d)("cmp-upgradeCompose")&&!t.itemId&&(S=!0,o(t,t.numberOfWaitingAttachments+1)),A.label=1;case 1:return A.trys.push([1,,6,7]),(C=!t.itemId)?[4,Object(s.e)(t)]:[3,3];case 2:C=!A.sent(),A.label=3;case 3:return C?[4,Object(s.b)(t)]:[3,5];case 4:A.sent(),A.label=5;case 5:return function(e,t,n,i,o,s,l,u){var d=this;Object(f.a)(t.smimeViewState)?p.d.import().then(function(l){return r.__awaiter(d,void 0,void 0,function(){var u,d;return r.__generator(this,function(p){switch(p.label){case 0:return p.trys.push([0,2,,3]),[4,l(e,r.__assign({},t.itemId,{mailboxInfo:Object(c.c)()}),t.attachmentWell,n,o||Object(a.a)(t),s||Object(a.c)(t))];case 1:return u=p.sent(),h(n,u,t,i),[3,3];case 2:return d=p.sent(),m.c.warn(d),[3,3];case 3:return[2]}})})}):g.g.import().then(function(d){var p=d(t.attachmentWell,r.__assign({},t.itemId,{mailboxInfo:Object(c.c)()}),e,o||Object(a.a)(t),s||Object(a.c)(t),n,l,u);h(n,p,t,i)})}(e,t,n,i,v,y,function(e){b&&b(e),Object(d.a)()&&Object(u.a)(t,8)},_),[3,7];case 6:return S&&o(t,t.numberOfWaitingAttachments-1),[7];case 7:return[2]}})})}n.d(t,"a",function(){return v})},1568:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return c});var r=n(0),a=n(7),i=n(1324),o={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function s(){var e=Object(a.a)().UserOptions;return e?c(e.ComposeFontName,e.ComposeFontSize,e.ComposeFontColor,e.ComposeFontFlags):o}function c(e,t,n,a){var s=r.__assign({},o),c=e?Object(i.d)(e):null;c&&(s.fontFamily=c);var l=t?Object(i.f)(t):null;return l&&(s.fontSize=l),n&&(s.textColor=n),a&&(s.bold=1==(1&a),s.italic=2==(2&a),s.underline=4==(4&a)),s}},1569:function(e,t,n){"use strict";var r=n(4),a=n(1581);t.a=Object(r.action)("updateContent")(function(e,t,n){e.content!=t&&(e.content=t,n||Object(a.a)(e,!0)),n&&(e.initialContent=t)})},1570:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("setIsContextualFormatBarShown")(function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=0),e.isContextualFormatBarShown=t,e.contextualFormatBarLeft=n,e.contextualFormatBarTop=r})},1571:function(e,t,n){"use strict";var r=n(1245),a=35;n.d(t,"a",function(){return s});var i=14,o=["1f602","2764","1f60d","1f62d","1f60a","1f612","1f495","1f618","267b","1f629","1f44c","1f60f","1f601","1f609","1f44d","2b05","1f60c","1f64f","1f914","1f622","1f60e","1f633","1f440","1f605","1f64c","1f494","1f648","270c","2728","1f499","1f49c","1f4af","1f604","1f496","1f61c"];function s(e){void 0===e&&(e=a);for(var t=Object(r.b)(Math.min(e,i)),n=0;t.length<e;n++){var s=o[n];t.includes(s)||t.push(s)}return t}},1576:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.mutatorAction)("setWordToReplace",function(e,t){e.wordToReplace=t})},1577:function(e,t,n){"use strict";function r(){return{visibleItemCount:0,formatViewState:{fontName:"",fontSize:"",isBold:!1,isItalic:!1,isUnderline:!1,backgroundColor:"",textColor:"",isBullet:!1,isNumbering:!1,isStrikeThrough:!1,isSubscript:!1,isSuperscript:!1,isBlockQuote:!1,canUnlink:!1,canAddImageAltText:!1,canUndo:!1,canRedo:!1,formatPainterFormat:null},isContextualFormatBarShown:!1,contextualFormatBarLeft:0,contextualFormatBarTop:0}}n.d(t,"a",function(){return r})},1579:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return l});var r=n(1542),a=n(138),i=n(4),o=Object(i.select)({conversationReadingPaneState:function(){return a.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.itemPart:null}),s=Object(i.select)({conversationReadingPaneState:function(){return a.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null}),c=Object(i.select)({conversationReadingPaneState:function(){return a.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState.initiallySelectedItemPart?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null}),l=Object(i.select)({conversationReadingPaneState:function(){return a.a.conversationReadingPaneViewState}})(function(e,t){var n=o(t),a=s(t);return n==e&&a==r.a.Item})},1580:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1671),a=n(1672);function i(e){var t=e.policyMatchDetails,n=t.filter(function(e){return 0!=e.MatchPriority});return n.length>0?Object(a.a)(n,function(e){return e.MatchPriority}):Object(r.a)(t,function(e){return function(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}(e.Action)})}},1581:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("setIsDirty")(function(e,t){e.isDirty=t})},1586:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(12),a="2d",i="canvas",o="image/png";function s(e){try{var t=document.createElement(i),n=e.naturalWidth,s=e.naturalHeight;if(n>0&&s>0||(Object(r.k)("CreateDataURIMissingNaturalDimensions"),n=e.width,s=e.height),n>0&&s>0)return t.width=n,t.height=s,t.getContext(a).drawImage(e,0,0),t.toDataURL(o)}catch(e){}return null}},1587:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r,a=n(1592);function i(e,t,n){return r||(r=Object(a.a)()),{composeId:n,allowShowMultipleRows:!e,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:t,isReadOnly:e,groupId:null,maxTotalClassicAttachmentSize:r,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[]}}},1591:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("switchToReadWriteRecipient")(function(e){e.showCompactRecipientWell=!1})},1592:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1246),a=n(9),i=n(7),o=25*r.b;function s(){return c.get()}var c=Object(a.computed)(function(){var e=Object(i.a)();return e&&e.SessionSettings&&e.ApplicationSettings?(e.SessionSettings.MaxMessageSizeInKb-2048)*r.a:o})},1594:function(e,t,n){"use strict";var r;!function(e){e[e.Textarea=1]="Textarea",e[e.RoosterHTML=2]="RoosterHTML",e[e.RawContentEditableDivHTML=3]="RawContentEditableDivHTML"}(r||(r={}));var a=n(0);function i(e){return"object"==typeof e&&null!==e&&e.hasOwnProperty("Text")&&e.hasOwnProperty("HTML")&&Object.keys(e).every(function(t){return l[e[t]]===t})}var o,s="compose.PREFERRED_EDITORS",c={Text:1,HTML:2},l=((o={})[1]="Text",o[2]="HTML",o[3]="HTML",o),u=null;function d(){return null===u&&(u=function(){try{var e=JSON.parse(localStorage.getItem(s));return i(e)?e:null}catch(e){return null}}()||a.__assign({},c)),a.__assign({},u)}function p(e,t){u[e]=t,localStorage.setItem(s,JSON.stringify(u))}function f(e){null==e.bodyType&&setTimeout(function(){throw new Error("viewState.bodyType was nullish ("+e.bodyType+"). Please report this + what you were doing before it happened.")},0);var t=e.bodyType||"HTML";null==e.preferredEditors&&setTimeout(function(){throw new Error("viewState.preferredEditors was nullish ("+e.preferredEditors+"). Please report this + what you were doing before it happened.")},0);var n=e.preferredEditors||a.__assign({},c);try{return n[t]}catch(e){return setTimeout(function(){throw e},0),2}}var m,g=((m={})[1]={bottomActionBar:!0},m[2]={formattingRibbon:!0,bottomActionBar:!0},m[3]={},m);function h(e){return g[e.preferredEditors[e.bodyType]]}n.d(t,"a",function(){return l}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return p}),n.d(t,"b",function(){return f}),n.d(t,"d",function(){return h})},1598:function(e,t,n){"use strict";var r=n(4),a=n(1252),i=Object(r.action)("addInfoBarMessageInReadingPane")(function(e,t,n){Object(a.a)(e,t,e.itemId,n)});t.a=i},1600:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r,a=n(0),i=n(386),o=n(706),s=n(224),c=n(189),l=n(1608),u=n(735);function d(e){return a.__awaiter(this,void 0,void 0,function(){var t,n,d,p;return a.__generator(this,function(a){switch(a.label){case 0:return r?[3,2]:[4,c.q.import()];case 1:r=a.sent(),a.label=2;case 2:return t=Object(i.c)(e),n=Object(u.a)(t),d=Object(o.a)(e.toRecipientWell),p=function(e,t){var n=[];return e.forEach(function(e){var r=e.persona,a=Object(l.a)(t,r.EmailAddress.EmailAddress);null!==a&&n.push({emailAddress:r.EmailAddress.EmailAddress,ADObjectId:r.ADObjectId,totalMemberCount:a.TotalMemberCount,externalMemberCount:a.ExternalMemberCount,name:r.EmailAddress.Name,MailboxType:r.EmailAddress.MailboxType,RoutingType:r.EmailAddress.RoutingType})}),n}(n,d),r(e.attachmentWell,e.itemId,p,e.infoBarIds.slice(),Object(s.a)(e),Object(s.c)(e)),[2]}})})}},1601:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=5},1607:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageMaxRecipientsExceed","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError"]},1608:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(700);function a(e,t){var n=Object(r.a)().get(e,t);return n?{TotalMemberCount:n.value.TotalMemberCount,ExternalMemberCount:n.value.ExternalMemberCount}:null}},1609:function(e,t,n){"use strict";function r(){return{maxActionBatchSize:10,entityType:1,entityScenarioName:"FindPeople_react",hasSessionStarted:!1,isSessionPaused:!1,entityFeedbackEntries:[],clientSessionId:"",clientVersion:"1.0",clientId:1,entrySequenceNumber:0}}n.d(t,"a",function(){return r})},1617:function(e,t,n){"use strict";function r(e,t){if(e){if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch"}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",function(){return r})},1618:function(e,t,n){"use strict";n.d(t,"d",function(){return m}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return y}),n.d(t,"a",function(){return b});var r=n(0),a=n(15),i=n.n(a),o=n(278),s=n(305),c=n(1619),l=n(5),u=n(1007),d="",p="",f="/owa/owahipcontrol.aspx?compose=1";function m(e,t){if(e){e.WasclUpgradeToPremiumUrl&&(d=e.WasclUpgradeToPremiumUrl),e.AccountRecoveryFlowUrl&&(p=e.AccountRecoveryFlowUrl);var n=e.ResponseMessages&&e.ResponseMessages.Items?e.ResponseMessages.Items[0]:null;!n||"ErrorExceededMessageLimit"!=n.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=n.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=n.ResponseCode||Object(s.b)(t,!0)}}function g(e){return{text:i.a.errorMessageUpgradeToPremium,action:function(){Object(o.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(d)}}}var h=null;function v(e){Object(o.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}function y(e){return{text:i.a.errorMessageVerify,action:function(){var t;if(Object(l.d)("cmp-hipCheckModal")){if(null!==h)return;t=r.__read(Object(u.a)(c.a),1),(h=t[0]).then(function(t){var n=t.success;h=null,n&&v(e)},function(e){h=null})}else v(e),window.open(f)}}}function b(e){return{text:i.a.errorMessageVerify,action:function(){Object(o.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(p)}}}},1619:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a=new r.c(function(){return Promise.all([n.e(303),n.e(198)]).then(n.bind(null,1884))}),i=Object(r.d)(a,function(e){return e.HipCheckModal})},1620:function(e,t,n){"use strict";var r=n(755);t.a=function(){for(var e=Object(r.a)().userLabels,t=0;t<e.length;t++)if(e[t].isDefault)return e[t];return null}},1621:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(186),a=n(5);function i(){return Object(a.d)("cmp-darkMode")&&Object(r.c)()}},1622:function(e,t,n){"use strict";function r(e){var t=e.IRMData;return!t||t.IsOwner||t.ForwardAllowed}n.d(t,"a",function(){return r})},1623:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("updateMailTipsForRecipients",function(e,t,n){return{composeId:e,recipientWell:t,recipients:n}})},1624:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a});var r=":";function a(e,t){return 1===e.eventType&&e.rawEvent.key==r}},1625:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1327),a=n(29);function i(e){if(!Object(a.m)())return"irmInfoBar";switch(e){case r.b:return"encryption";case r.a:return"encryptionDoNotForward";default:return null}}},1626:function(e,t,n){"use strict";var r=n(839),a=n(4);t.a=Object(a.action)("showCcWell")(function(e){e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.findPeopleFeedbackManager,[]))})},1731:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(3),i=n(335),o=n(95),s=n(126),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._root=a.createRef(),t._firstBumper=a.createRef(),t._lastBumper=a.createRef(),t._hasFocus=!1,t._onRootFocus=function(e){t.props.onFocus&&t.props.onFocus(e),t._hasFocus=!0},t._onRootBlur=function(e){t.props.onBlur&&t.props.onBlur(e);var n=e.relatedTarget;null===e.relatedTarget&&(n=document.activeElement),Object(i.a)(t._root.current,n)||(t._hasFocus=!1)},t._onFirstBumperFocus=function(){t._onBumperFocus(!0)},t._onLastBumperFocus=function(){t._onBumperFocus(!1)},t._onBumperFocus=function(e){var n=e===t._hasFocus?t._lastBumper.current:t._firstBumper.current;if(t._root.current){var r=e===t._hasFocus?Object(o.i)(t._root.current,n,!0,!1):Object(o.f)(t._root.current,n,!0,!1);r&&(t._isBumper(r)?t.focus():r.focus())}},t._onFocusCapture=function(e){t.props.onFocusCapture&&t.props.onFocusCapture(e),e.target===e.currentTarget||t._isBumper(e.target)||(t._previouslyFocusedElementInTrapZone=e.target)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this._bringFocusIntoZone(),this._updateEventHandlers(this.props)},t.prototype.componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElementOutsideTrapZone!==t&&(this._previouslyFocusedElementOutsideTrapZone=t),this._updateEventHandlers(e)},t.prototype.componentDidUpdate=function(e){var t=void 0===e.forceFocusInsideTrap||e.forceFocusInsideTrap,n=void 0===this.props.forceFocusInsideTrap||this.props.forceFocusInsideTrap;!t&&n?this._bringFocusIntoZone():t&&!n&&this._returnFocusToInitiator()},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._returnFocusToInitiator()},t.prototype.render=function(){var e=this.props,t=e.className,n=e.ariaLabelledBy,i=Object(s.f)(this.props,s.e),o={style:{pointerEvents:"none",position:"fixed"},tabIndex:0,"aria-hidden":!0,"data-is-visible":!0};return a.createElement("div",r.__assign({},i,{className:t,ref:this._root,"aria-labelledby":n,onFocusCapture:this._onFocusCapture,onFocus:this._onRootFocus,onBlur:this._onRootBlur}),a.createElement("div",r.__assign({},o,{ref:this._firstBumper,onFocus:this._onFirstBumperFocus})),this.props.children,a.createElement("div",r.__assign({},o,{ref:this._lastBumper,onFocus:this._onLastBumperFocus})))},t.prototype.focus=function(){var e=this.props,t=e.focusPreviouslyFocusedInnerElement,n=e.firstFocusableSelector;if(t&&this._previouslyFocusedElementInTrapZone&&Object(i.a)(this._root.current,this._previouslyFocusedElementInTrapZone))this._focusAsync(this._previouslyFocusedElementInTrapZone);else{var r,a="string"==typeof n?n:n&&n();this._root.current&&(a&&(r=this._root.current.querySelector("."+a)),r||(r=Object(o.j)(this._root.current,this._root.current.firstChild,!1,!1,!1,!0))),r&&this._focusAsync(r)}},t.prototype._focusAsync=function(e){this._isBumper(e)||Object(o.b)(e)},t.prototype._bringFocusIntoZone=function(){var e=this.props,n=e.elementToFocusOnDismiss,r=e.disableFirstFocus,a=void 0!==r&&r;t._focusStack.push(this),this._previouslyFocusedElementOutsideTrapZone=n||document.activeElement,a||Object(i.a)(this._root.current,this._previouslyFocusedElementOutsideTrapZone)||this.focus()},t.prototype._returnFocusToInitiator=function(){var e=this,n=this.props.ignoreExternalFocusing;t._focusStack=t._focusStack.filter(function(t){return e!==t});var r=document.activeElement;n||!this._previouslyFocusedElementOutsideTrapZone||"function"!=typeof this._previouslyFocusedElementOutsideTrapZone.focus||!Object(i.a)(this._root.current,r)&&r!==document.body||this._focusAsync(this._previouslyFocusedElementOutsideTrapZone)},t.prototype._updateEventHandlers=function(e){var t=e.isClickableOutsideFocusTrap,n=void 0!==t&&t,r=e.forceFocusInsideTrap,a=void 0===r||r;a&&!this._hasFocusHandler?this._events.on(window,"focus",this._forceFocusInTrap,!0):!a&&this._hasFocusHandler&&this._events.off(window,"focus",this._forceFocusInTrap,!0),this._hasFocusHandler=a,n||this._hasClickHandler?n&&this._hasClickHandler&&this._events.off(window,"click",this._forceClickInTrap,!0):this._events.on(window,"click",this._forceClickInTrap,!0),this._hasClickHandler=!n},t.prototype._isBumper=function(e){return e===this._firstBumper.current||e===this._lastBumper.current},t.prototype._forceFocusInTrap=function(e){if(t._focusStack.length&&this===t._focusStack[t._focusStack.length-1]){var n=document.activeElement;Object(i.a)(this._root.current,n)||(this.focus(),this._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},t.prototype._forceClickInTrap=function(e){if(t._focusStack.length&&this===t._focusStack[t._focusStack.length-1]){var n=e.target;n&&!Object(i.a)(this._root.current,n)&&(this.focus(),this._hasFocus=!0,e.preventDefault(),e.stopPropagation())}},t._focusStack=[],t}(n(128).a)},1735:function(e,t,n){"use strict";var r=n(859),a=n(0),i=n(3),o=n(237),s=n(712),c=n(126),l=n(128),u=Object(o.a)(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){Object(s.c)()},t.prototype.componentWillUnmount=function(){Object(s.d)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,r=e.theme,o=e.styles,s=Object(c.f)(this.props,c.e),l=u(o,{theme:r,className:n,isDark:t});return i.createElement("div",a.__assign({},s,{className:l.root}))},t}(l.a),p=n(18),f={root:"ms-Overlay",rootDark:"ms-Overlay--dark"};n.d(t,"a",function(){return m});var m=Object(r.a)(d,function(e){var t,n=e.className,r=e.theme,a=e.isNone,i=e.isDark,o=r.palette,s=Object(p.getGlobalClassNames)(f,r);return{root:[s.root,r.fonts.medium,{backgroundColor:o.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[p.HighContrastSelector]={border:"1px solid WindowText",opacity:0},t)},a&&{visibility:"hidden"},i&&[s.rootDark,{backgroundColor:o.blackTranslucent40}],n]}},void 0,{scope:"Overlay"})},1773:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"MAX_REGEX_MATCHES",function(){return y}),n.d(r,"MAX_BODY_REGEX_ACTIVATION_LENGTH",function(){return b}),n.d(r,"MAX_REGEX_MATCH_LENGTH",function(){return _});var a=n(890),i=n(2709),o=n(2643),s=n(0),c=n(2803),l=n(1909),u=n(1957),d=function(){function e(e){this.collectionRule=e}return e.prototype.Evaluate=function(e,t){var n,r,a=this.GetInitialEvaluationResult();try{for(var i=s.__values(this.collectionRule.Rules),o=i.next();!o.done;o=i.next()){var c=T(o.value).Evaluate(e,t);a=this.UpdateEvaluationResult(a,c)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},e.prototype.ItemIsReadyForEvaluation=function(e){var t,n;try{for(var r=s.__values(this.collectionRule.Rules),a=r.next();!a.done;a=r.next()){if(!T(a.value).ItemIsReadyForEvaluation(e))return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0},e.prototype.GetInitialEvaluationResult=function(){if("AND"==this.collectionRule.Mode.toUpperCase())return!0;if("OR"==this.collectionRule.Mode.toUpperCase())return!1;throw new Error("Invalid mode for a Collection rule: "+this.collectionRule.Mode)},e.prototype.UpdateEvaluationResult=function(e,t){return!("AND"==this.collectionRule.Mode.toUpperCase()&&!t)&&(!("OR"!=this.collectionRule.Mode.toUpperCase()||!t)||e)},e}(),p=function(){function e(e){}return e.prototype.Evaluate=function(e,t){return!!e.HasAttachments},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}();function f(e){return function(e){return e.replace(/\n[\s]*/g,"[\n]+")}(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"))}var m=n(395),g="MeetingString",h=function(){function e(e){this.itemHasKnownEntityRule=e}return e.prototype.Evaluate=function(e,t){if(!e.EntityExtractionResult)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Addresses,"Address");case 7:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Contacts,"ContactString");case 6:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.EmailAddresses,"EmailAddress");case 1:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.MeetingSuggestions,g);case 5:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.PhoneNumbers,"OriginalPhoneString");case 2:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.TaskSuggestions,"TaskString");case 4:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Urls,"Url");default:throw new Error("Unexpected known entity: "+this.itemHasKnownEntityRule.EntityType)}},e.prototype.EvaluateForEntityType=function(e,t,n,r){var a,i;if(!n)return!1;var o=[],c=!1,l=0;try{for(var u=s.__values(n),d=u.next();!d.done;d=u.next()){var p=d.value;if(this.EvaluateRegExForTerm(p[r])){c=!0,-1===t.evaluationResult.matchedKnownEntityTypes.indexOf(this.itemHasKnownEntityRule.EntityType)&&t.evaluationResult.matchedKnownEntityTypes.push(this.itemHasKnownEntityRule.EntityType),2!==this.itemHasKnownEntityRule.Highlight&&"Subject"!==p.Position&&(t.terms.push(v(p,r)),l++);var f=m({},p);o.push(f)}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}if(this.itemHasKnownEntityRule.FilterName&&this.itemHasKnownEntityRule.RegExFilter&&this.SaveRegexMatches(o,t.evaluationResult),l>0){var g=t.highlightableEntities[this.itemHasKnownEntityRule.EntityType];(!g||l>g)&&(t.highlightableEntities[this.itemHasKnownEntityRule.EntityType]=l)}return c},e.prototype.EvaluateRegExForTerm=function(e){var t=this.itemHasKnownEntityRule.IgnoreCase,n=this.itemHasKnownEntityRule.RegExFilter;if(!n)return!0;var r=Object(u.l)(e,n,t);return r&&r.length>0},e.prototype.ItemIsReadyForEvaluation=function(e){return!!e.EntityExtractionResult||!this.ItemHasEntityOnServer(e)},e.prototype.ItemHasEntityOnServer=function(e){if(!e.PropertyExistence)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return e.PropertyExistence.ExtractedAddresses;case 7:return e.PropertyExistence.ExtractedContacts;case 6:return e.PropertyExistence.ExtractedEmails;case 1:return e.PropertyExistence.ExtractedMeetings;case 5:return e.PropertyExistence.ExtractedPhones;case 2:return e.PropertyExistence.ExtractedTasks;case 4:return e.PropertyExistence.ExtractedUrls;default:return!1}},e.prototype.SaveRegexMatches=function(e,t){switch(this.itemHasKnownEntityRule.EntityType){case 3:t.filteredEntityMatches.Addresses||(t.filteredEntityMatches.Addresses={}),t.filteredEntityMatches.Addresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 7:t.filteredEntityMatches.Contacts||(t.filteredEntityMatches.Contacts={}),t.filteredEntityMatches.Contacts[this.itemHasKnownEntityRule.FilterName]=e;break;case 6:t.filteredEntityMatches.EmailAddresses||(t.filteredEntityMatches.EmailAddresses={}),t.filteredEntityMatches.EmailAddresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 1:t.filteredEntityMatches.MeetingSuggestions||(t.filteredEntityMatches.MeetingSuggestions={}),t.filteredEntityMatches.MeetingSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 5:t.filteredEntityMatches.PhoneNumbers||(t.filteredEntityMatches.PhoneNumbers={}),t.filteredEntityMatches.PhoneNumbers[this.itemHasKnownEntityRule.FilterName]=e;break;case 2:t.filteredEntityMatches.TaskSuggestions||(t.filteredEntityMatches.TaskSuggestions={}),t.filteredEntityMatches.TaskSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 4:t.filteredEntityMatches.Urls||(t.filteredEntityMatches.Urls={}),t.filteredEntityMatches.Urls[this.itemHasKnownEntityRule.FilterName]=e}},e}();function v(e,t){return t===g?function(e,t){var n=e[t];if(!e.TimeStringLength)return f(n);var r=n.slice(e.TimeStringBeginIndex,e.TimeStringBeginIndex+e.TimeStringLength),a=n.slice(e.TimeStringBeginIndex+e.TimeStringLength,n.length);if(0==a.length)return f(r);return f(r)+"(?="+f(a)+")"}(e,t):f(e[t])}var y=50,b=5e5,_=10240,S=n(129);function C(e){return 0===e.indexOf("ipm.note")||0===e.indexOf("ipm.schedule")||0===e.indexOf("ipm.sharing")}function A(e){return 0===e.indexOf("ipm.appointment")||"ipm.ole.class.{00061055-0000-0000-c000-000000000046}"==e}var I=function(){function e(e){this.itemIsRule=e}return e.prototype.Evaluate=function(e,t){return this.EvaluateItemType(e)&&this.EvaluateItemClass(e)},e.prototype.EvaluateItemType=function(e){var t=e.ItemClass;return!(1!=this.itemIsRule.ItemType||!t||!C(t.toLowerCase()))||(!(2!=this.itemIsRule.ItemType||!t||!A(t.toLowerCase()))||!this.itemIsRule.ItemType)},e.prototype.EvaluateItemClass=function(e){var t=e.ItemClass;return!this.itemIsRule.ItemClass||(this.itemIsRule.IncludeSubClasses?t&&0===t.toLowerCase().indexOf(this.itemIsRule.ItemClass.toLowerCase()):t&&this.itemIsRule.ItemClass.toLowerCase()===t.toLowerCase())},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e}(),O=function(){function e(e,t){this.itemHasRegularExpressionMatchRule=e,this.limits=t||r}return e.prototype.Evaluate=function(e,t){var n,r,a=this.GetPropertyForEvaluation(e,t),i=this.itemHasRegularExpressionMatchRule.RegExValue,o=this.itemHasRegularExpressionMatchRule.IgnoreCase,c=null;if(null!=a&&(c=Object(u.l)(a,i,o)),null==c)return t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=[],!1;var l=this.removeDuplicatesAndApplyMatchLimits(c);if(t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=l,2===this.itemHasRegularExpressionMatchRule.Highlight)return!0;if(2==this.itemHasRegularExpressionMatchRule.PropertyName)try{for(var d=s.__values(l),p=d.next();!p.done;p=d.next()){var m=p.value;t.terms.push(f(m))}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}return!0},e.prototype.ItemIsReadyForEvaluation=function(e){return!0},e.prototype.removeDuplicatesAndApplyMatchLimits=function(e){var t,n,r={},a=0;try{for(var i=s.__values(e),o=i.next();!o.done;o=i.next()){var c=o.value;if(a>=this.limits.MAX_REGEX_MATCHES)break;c.length<=this.limits.MAX_REGEX_MATCH_LENGTH&&(r[c]=1,a++)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return Object.keys(r)},e.prototype.GetPropertyForEvaluation=function(e,t){switch(this.itemHasRegularExpressionMatchRule.PropertyName){case 1:return e.Subject;case 4:return this.GetSenderSMTPAddress(e);case 3:return this.GetBodyWithLimits(e);case 2:if(t.plainTextBody)return t.plainTextBody;var n=this.GetBodyWithLimits(e);return t.plainTextBody=Object(u.g)(n),t.plainTextBody;default:return Object(S.a)(this.itemHasRegularExpressionMatchRule.PropertyName),""}},e.prototype.GetSenderSMTPAddress=function(e){if(C(e.ItemClass)){var t=e;if(t.Sender&&t.Sender.Mailbox)return t.Sender.Mailbox.EmailAddress}if(A(e.ItemClass)){var n=e;if(n.Organizer&&n.Organizer.Mailbox)return n.Organizer.Mailbox.EmailAddress}return null},e.prototype.GetBodyWithLimits=function(e){var t=this.GetBody(e);return null!=t&&t.length>this.limits.MAX_BODY_REGEX_ACTIVATION_LENGTH?null:t},e.prototype.GetBody=function(e){var t;e.NormalizedBody?t=e.NormalizedBody:e.UniqueBody?t=e.UniqueBody:e.Body&&(t=e.Body);var n=this.itemHasRegularExpressionMatchRule.PropertyName;return!t||"Text"===t.BodyType&&3===n?null:t.Value},e}();function T(e){if("ItemIs"==e.Type)return new I(e);if("ItemHasAttachment"==e.Type)return new p(e);if("ItemHasKnownEntity"==e.Type)return new h(e);if("ItemHasRegularExpressionMatch"==e.Type)return new O(e);if("Collection"==e.Type)return new d(e);throw new Error("Rule type not supported: "+e.Type)}var x=n(9);function E(e,t,n){var r,a={};e.length>0&&e.forEach(function(e){var i,o,c,u;c=r,u={evaluationResult:Object(l.g)(),highlightableEntities:{},terms:[]},c&&(u.plainTextBody=c.plainTextBody,u.highlightableEntities=c.highlightableEntities);var d=function(e,t,n){try{return function(e,t,n){if(T(e).Evaluate(t,n))return n.terms;return[]}(e.detectedEntity.Rule,t,n)}catch(e){return[]}}(e,t,r=u);try{for(var p=s.__values(d),f=p.next();!f.done;f=p.next()){var m=f.value;a[m]?a[m].push(e):a[m]=[e]}}catch(e){i={error:e}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}d.length>0&&(n[e.extension.Id]=r.evaluationResult)});return new x.ObservableMap(a)}function M(e,t){try{return function(e,t){return T(e).ItemIsReadyForEvaluation(t)}(e.detectedEntity.Rule,t)}catch(e){return!0}}function P(e,t){return s.__awaiter(this,void 0,void 0,function(){var n;return s.__generator(this,function(r){switch(r.label){case 0:return function(e,t){var n,r;try{for(var a=s.__values(e),i=a.next();!i.done;i=a.next())if(!M(i.value,t))return!1}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!0}(t,e)?[3,2]:[4,Object(u.o)(e)];case 1:n=r.sent(),Object(l.db)(e,n.EntityExtractionResult),r.label=2;case 2:return[2]}})})}var k=n(161),R=n(5);function w(e,t){return s.__awaiter(this,void 0,void 0,function(){var n,r,a,i,o,c;return s.__generator(this,function(d){switch(d.label){case 0:return(n=Object(u.n)(t))?(r=!1,n.isSharedItem&&(r=n.isSharedItem()),a=function(e){var t=l.i.EnabledAddinCommands.getExtensionPoint(k.a.DetectedEntity);if(0==t.length)return[];if(e){if(!Object(R.d)("addin-delegateAccess"))return[];t=Object(l.k)(t)}return t.map(function(e){return s.__spread(e.AddinCommands.values())[0]})}(r),i={},[4,P(e,a)]):[2];case 1:return d.sent(),o=E(a,e,i),c=new x.ObservableMap(i),Object(l.cb)(t,o,c),[2]}})})}var N=n(2205),D=n(2385),F=n(3020);function L(e,t,n){return void 0===n&&(n=!0),s.__awaiter(this,void 0,void 0,function(){var r;return s.__generator(this,function(a){switch(a.label){case 0:return Object(u.d)(e,t),Object(l.E)(e),((i=t.mode)==k.a.MessageRead||i==k.a.MeetingRequest||i==k.a.AppointmentAttendee)&&(r=t,Object(l.ib)(function(e,t){return function(){return w(e.getItem(),t)}}(r,e))),Object(u.r)(e),Object(F.d)(n),[4,Object(D.f)(t.mode)];case 1:return a.sent(),[4,Object(c.a)()];case 2:return a.sent(),Object(N.c)()&&Object(F.e)(F.a.Single,e),[2]}var i})})}function U(e){Object(u.j)(e),Object(F.b)(e),Object(l.h)(e),function(e,t){Object(l.G)(e)?Object(x.when)(function(){return!Object(l.G)(e)},function(){return t(e)}):t(e)}(e,B)}function B(e){Object(l.J)(e)||Object(u.i)(e)}var j=n(1044);function H(e,t){t==j.a.Deselected&&Object(F.b)(e)}function V(e){return!!Object(l.t)(e)&&null!=Object(l.t)(e).contextualTerms}function W(e,t){return Object(x.when)(function(){return V(e)},function(){return t(V(n=e)?s.__spread(Object(l.t)(n).contextualTerms.keys()):null);var n})}var G=n(2133),z=n(993),q=n(1160),X=function(e){function t(){var t=e.call(this,{},{},{},{})||this;return t.extension={AppDomains:[q.e,q.d],Id:q.k,Version:q.i,Type:"Default",TypeString:"Default",Origin:"Default",OriginString:"Default",IconUrl:q.h,DisplayName:q.c,ConsentState:0,Description:q.b,ProviderName:q.j,HighResolutionIconUrl:q.g,AppStatus:"",LicenseType:0,Settings:"{}",RequestedCapabilities:1,DisableEntityHighlighting:!1,Enabled:!0,LicenseStatus:0,IsMandatory:!1,ExtensionPointCollection:t.get_ExtensionPointCollection()},t.addinId=q.k,t.commandId=q.a,t.endpoint=q.d,t}return s.__extends(t,e),t.prototype.get_EntryPoint=function(){return this.endpoint.toString()},t.prototype.get_Label=function(){return this.extension.DisplayName},t.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},t.prototype.get_Id=function(){return this.extension.Id},t.prototype.get_Size16Icon=function(){return this.extension.IconUrl},t.prototype.get_Version=function(){return this.extension.Version},t.prototype.get_ExtensionPointCollection=function(){return{FunctionFile:q.f,MessageReadCommandSurface:this.get_ExtensionPoint(),MessageComposeCommandSurface:null,AppointmentOrganizerCommandSurface:null,AppointmentAttendeeCommandSurface:null,Events:null,DetectedEntity:null,CustomPane:null,__type:"MessageReadCommandSurface"}},t.prototype.get_ExtensionPoint=function(){return{Tabs:[this.get_Tab()],__type:""}},t.prototype.get_Tab=function(){return{Type:0,Id:"TabDefault",Groups:[this.get_Group()],Label:q.c,__type:null}},t.prototype.get_Group=function(){return{Id:"ScreamGroup",Label:q.c,Controls:[this.get_TaskPaneControl()],__type:null}},t.prototype.get_IconUrls=function(){return{Size16Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon16x16.png",Size32Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon32x32.png",Size80Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon80x80.png",Size20Url:null,Size24Url:null,Size40Url:null,Size48Url:null,Size64Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",__type:null}},t.prototype.get_TaskPaneControl=function(){var e=this.get_Control();return e.Action={SourceLocation:q.f,__type:"TaskPaneButton"},e},t.prototype.get_Control=function(){return{Label:q.c,Supertip:{Title:"Translate Item",Description:q.b},Icon:this.get_IconUrls(),Id:q.a,__type:"ShowTaskpane"}},t}(l.a),K=n(2751);function J(e){return s.__awaiter(this,void 0,void 0,function(){var t;return s.__generator(this,function(n){switch(n.label){case 0:return[4,Object(K.a)()];case 1:return n.sent(),null==(t=new X)?[3,3]:[4,Object(F.f)(e,t,k.a.MessageRead)];case 2:return n.sent(),[2];case 3:return[2,null]}})})}var Q=n(2645),Y=n(3086),Z=n(7);function $(){var e=Object(l.q)().Context,t=Object(l.H)(),n=Object(Z.a)().SegmentationSettings.OnSendAddinsEnabled;return e&&t?n&&Object(Y.a)(1).length>0:n}var ee=n(3),te=n(996),ne=n(3593);var re=n(3087),ae=n(3088),ie=n(2050),oe=n.n(ie),se=n(127),ce=n(12);function le(){return s.__awaiter(this,void 0,void 0,function(){var e;return s.__generator(this,function(t){switch(t.label){case 0:return[4,Object(se.b)(oe.a.gdprMinorDialogTitleText,oe.a.gdprMinorWarningText,!1,{okText:oe.a.gdprMinorDialogOKButtonText,cancelText:oe.a.gdprMinorRemoveAddinText})];case 1:return e=t.sent(),Object(ce.k)("ExtGDPRMinorDialogResponse",[e]),e===se.a.cancel&&Object(N.b)()&&Object(ae.a)(),[2]}})})}var ue=n(2517);function de(e,t,n){return s.__awaiter(this,void 0,void 0,function(){var r,a,i;return s.__generator(this,function(o){switch(o.label){case 0:return Object(ue.f)(t)?[4,le()]:[3,2];case 1:return o.sent(),[2];case 2:return r=Object(u.n)(e),a=!0,r.mode!==k.a.MessageRead&&r.mode!==k.a.AppointmentAttendee||(i=r.getItem(),a=Object(l.U)(i)),[4,Object(se.b)(oe.a.restrictedItemDialogHeader,"",a,{bodyElement:ee.createElement("p",null,oe.a.restrictedItemDialogLabel),hideCancelButton:!0})];case 3:return o.sent(),a?(ne.c(t.control)?Object(re.a)(e,t,r.mode,n):ne.a(t.control)&&function(e,t){var n=Object(l.v)();Object(l.T)(n,e,t)}(t,e),[2]):[2]}})})}var pe=n(3595),fe=n(198),me=function(){function e(e,t){this.key=e,this.name=t}return e.prototype.generateData=function(){return{key:this.key,name:this.name,title:this.description,ariaLabel:this.accessibilityText,iconProps:Object(pe.a)(this.iconUrl),itemType:fe.a.Normal,getClickHandler:this.getClickHandler,subMenuProps:this.subMenuData?{items:[this.subMenuData.generateData()]}:null}},e}(),ge=function(){function e(e,t){this.key=e,this.header=t,this.menuItemDataList=[]}return e.prototype.addItem=function(e){this.menuItemDataList.push(e)},e.prototype.generateItemsData=function(){var e,t;try{for(var n=s.__values(this.menuItemDataList),r=n.next();!r.done;r=n.next()){var a=r.value;this.data.push(a.generateData())}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.generateData=function(){return this.data=[],this.generateItemsData(),{key:this.key,itemType:fe.a.Section,sectionProps:{title:this.header,items:this.data}}},e}();function he(e){var t=e.control,n=t.Id,r=t.Label,a=new me(n,r);return e.isMenu?a.subMenuData=ve(n,r,e.subCommands):e.isActionable&&(a.getClickHandler=_e(e)),a.iconUrl=e.control.Icon.Size16Url,a.accessibilityText=e.control.Label,a.description=e.control.Supertip.Title,a}function ve(e,t,n){var r,a,i=new ge(e,t);try{for(var o=s.__values(n),c=o.next();!c.done;c=o.next()){var l=c.value;i.addItem(he(l))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}return i}function ye(e){var t=new me(e.Id,e.DisplayName);if(Object(ue.h)(e))if(Object(ue.g)(e))t.subMenuData=ve(e.Id,e.DisplayName,Object(ue.d)(e).subCommands);else{var n=s.__spread(e.AddinCommands.values());t.subMenuData=ve(e.Id,e.DisplayName,n)}else Object(ue.a)(e)&&(t.getClickHandler=_e(Object(ue.d)(e)));return t.description=Object(ue.e)(e),t.accessibilityText=Object(ue.b)(e),t.iconUrl=e.IconUrl,t}var be=n(3596);function _e(e){return function(t){return function(n){n.stopPropagation(),de(t,e)}}}function Se(e){var t=function(e){var t,n,r=new ge("AddinsHeader",oe.a.overflowMenuHeaderAddins);try{for(var a=s.__values(e),i=a.next();!i.done;i=a.next()){var o=i.value;r.addItem(ye(o))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}(e).generateData();return Object(R.d)("addin-inClientStoreEnabled")&&(t.sectionProps.items.push(Object(be.b)()),t.sectionProps.items.push(Object(be.a)())),t}var Ce=n(728),Ae=n(744),Ie=n(99),Oe=n(17),Te=n(5079),xe=function(e){function t(t){var n=e.call(this,t,{hasLoadFailed:!1})||this;return n.handleAddinButtonLeftClick=function(e){e.stopPropagation(),Object(ue.a)(n.props.addin)&&de(n.props.hostItemIndex,Object(ue.d)(n.props.addin))},n.state={hasLoadFailed:!1},n}return s.__extends(t,e),t.prototype.onLoadingStateChanged=function(e){e==Ie.ImageLoadState.error?this.setState({hasLoadFailed:!0}):this.setState({hasLoadFailed:!1})},t.prototype.render=function(){var e={iconType:Ae.IconType.Image,imageProps:{src:this.props.addin.IconUrl,width:16,height:16,imageFit:Ie.ImageFit.contain,onLoadingStateChange:this.onLoadingStateChanged.bind(this)}},t={iconType:Ae.IconType.Default,iconName:"Photo2"},n=Object(ue.b)(this.props.addin),r={className:Te.addinEntryButton,iconProps:this.state.hasLoadFailed?t:e,title:n,ariaLabel:n};if(Object(ue.a)(this.props.addin))return ee.createElement(Ce.IconButton,s.__assign({onClick:this.handleAddinButtonLeftClick},r));if(Object(ue.h)(this.props.addin)){var a=ye(this.props.addin).generateData();return Object(te.a)(this.props.hostItemIndex,a),ee.createElement(Ce.IconButton,s.__assign({onMenuClick:this.handleAddinButtonLeftClick,menuProps:a.subMenuProps,menuIconProps:null},r))}return null},t=s.__decorate([Oe.observer],t)}(ee.Component),Ee=n(5081),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.__extends(t,e),t.prototype.render=function(){var e,t,n=[];try{for(var r=s.__values(this.props.addins),a=r.next();!a.done;a=r.next()){var i=a.value;n.push(ee.createElement(xe,{hostItemIndex:this.props.hostItemIndex,addin:i,key:i.Id}))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return ee.createElement("div",{className:Ee.listViewContainer},n)},t}(ee.Component),Pe=n(275),ke=n.n(Pe),Re=n(5083),we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleChevronLeftClick=function(e){e.stopPropagation()},t}return s.__extends(t,e),t.prototype.render=function(){var e={iconType:Ae.IconType.Default,iconName:"ChevronDownMed",className:ke()([Re.overflowChevron])},t={className:ke()([Re.overflowChevronContainer]),iconProps:e,title:oe.a.overflowMenuTooltip,ariaLabel:oe.a.overflowMenuAccessibilityLabel},n=Se(this.props.addins);return Object(te.a)(this.props.hostItemIndex,n),ee.createElement("div",{className:ke()([Re.overflowContainer])},ee.createElement("div",{className:ke()([Re.overflowDivider])}),ee.createElement(Ce.IconButton,s.__assign({onMenuClick:this.handleChevronLeftClick,menuProps:{items:[n]},menuIconProps:null},t)))},t=s.__decorate([Oe.observer],t)}(ee.Component),Ne=n(5085),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.__extends(t,e),t.prototype.getMaxVisibleAddinsCount=function(e){switch(e){case k.a.MessageRead:return 3;case k.a.MessageCompose:default:return 5}},t.prototype.render=function(){var e=l.i.HostItems.get(this.props.Index),t=l.i.EnabledAddinCommands;if(!e)return ee.createElement("div",null);var n=Object(u.n)(this.props.Index),r=this.getMaxVisibleAddinsCount(n.mode),a=t.getExtensionPoint(n.mode),i=null;return(r=Math.min(r,a.length))<a.length&&(i=ee.createElement(we,{hostItemIndex:this.props.Index,addins:a.slice(r,a.length)})),ee.createElement("div",{className:Ne.divContainer},ee.createElement(Me,{hostItemIndex:this.props.Index,addins:a.slice(0,r)}),i)},t=s.__decorate([Oe.observer],t)}(ee.Component),Fe=n(3494),Le=n(3513),Ue=n(3594);function Be(e,t,n){Object(l.D)(e,t,n);var r=Object(l.q)();Object(Ue.a)(t,r.contextualCalloutState.activeContextualAddinCommands[0])}function je(e,t,n,r,a){return s.__awaiter(this,void 0,void 0,function(){var i;return s.__generator(this,function(o){switch(o.label){case 0:return null==(i=Object(ue.c)(t,n,r))?[3,2]:[4,de(e,i,a)];case 1:return o.sent(),[2];case 2:return[2,null]}})})}var He={};function Ve(e,t){var n=function(e,t){return e+"_"+t}(e,t=!!t);return He[n]||(He[n]=Object(x.computed)(function(){var n=Object(l.q)().Context,r=Object(l.q)().EnabledAddinCommands;return function(e,t,n,r){if(n&&t.isInitialized){var a=t.getExtensionPoint(e,r);return Se(a)}return null}(e,r,n,t)})),He[n]}var We=n(3018),Ge=n(20),ze=n(8),qe=n.n(ze),Xe=n(2802);function Ke(e){return s.__awaiter(this,void 0,void 0,function(){var t,n,r,a;return s.__generator(this,function(i){switch(i.label){case 0:if(!Object(R.d)("addin-itemSendEvent"))return[2,!0];if(t=Object(Xe.b)(),function(){var e=Object(l.q)().Context,t=Object(l.H)();if(Object(Z.a)().SegmentationSettings.OnSendAddinsEnabled&&(!e||!t))return Object(se.b)(qe.a.messageSendingFailTitle,oe.a.itemSendEventAddinErrorExtensibilityUnavailable,!1,{hideCancelButton:!0}),!0;return!1}())return Object(Xe.d)(t,1),[2,!1];if(n=Object(l.r)(1),(r=Object(u.n)(e))&&r.isSharedItem&&r.isSharedItem()){if(!Object(R.d)("addin-delegateAccess"))return[2,!0];n=Object(l.j)(n)}!function(e,t){e.forEach(function(e){return Object(u.s)(t,e.extension.Id,e.extension.Id+"ItemSend")})}(n,e),a=0,i.label=1;case 1:return a<n.length?[4,Je(e,n[a],t)]:[3,4];case 2:if(!i.sent())return[2,!1];t.addCheckmark("ItemSend"+a),i.label=3;case 3:return a++,[3,1];case 4:return n.length>0?Object(Xe.d)(t,4):t.invalidate(),[2,!0]}})})}function Je(e,t,n){return s.__awaiter(this,void 0,void 0,function(){var r,a;return s.__generator(this,function(i){switch(i.label){case 0:return r=Object(l.v)(),[4,Object(l.T)(r,t,e)];case 1:return(a=i.sent()).status!==l.e.Success||!1===a.allowEvent?(Object(u.e)(e,t.extension.Id,!1,t.extension.Id+"ItemSend",0,Object(Ge.format)(oe.a.itemSendEventAddinBlockEvent,t.extension.DisplayName)),Object(Xe.c)(n,a,t),[2,!1]):[2,!0]}})})}n.d(t,"removeExtensibilityNotification",function(){return a.h}),n.d(t,"updatePersistentNotifications",function(){return i.a}),n.d(t,"closeTaskPaneAddinCommand",function(){return o.a}),n.d(t,"initializeAddinsForItem",function(){return L}),n.d(t,"deinitializeAddinsForItem",function(){return U}),n.d(t,"onHostItemChanged",function(){return H}),n.d(t,"initializeExtensibilityContext",function(){return c.a}),n.d(t,"whenItemHasContextualAddinKeywords",function(){return W}),n.d(t,"triggerAppointmentTimeChangedEvent",function(){return G.e}),n.d(t,"triggerAttachmentsChangedEvent",function(){return G.f}),n.d(t,"triggerRecipientsChangedEvent",function(){return G.h}),n.d(t,"triggerRecurrenceChangedEvent",function(){return G.i}),n.d(t,"triggerLocationsChangedEvent",function(){return G.g}),n.d(t,"isTranslatorEnabled",function(){return z.a}),n.d(t,"launchTranslateCommand",function(){return J}),n.d(t,"setPersistedAddin",function(){return Q.a}),n.d(t,"shouldForceFullCompose",function(){return $}),n.d(t,"AddinBarView",function(){return De}),n.d(t,"TaskPaneCollection",function(){return Fe.a}),n.d(t,"onComposeClose",function(){return Le.a}),n.d(t,"openContextualCallout",function(){return Be}),n.d(t,"launchAddinCommand",function(){return je}),n.d(t,"observeAddinCommandSurfaceItems",function(){return Ve}),n.d(t,"onItemNavigation",function(){return We.a}),n.d(t,"allowItemSendEvent",function(){return Ke})},1909:function(e,t,n){"use strict";var r,a=function(){return function(e,t){if(this.AddinCommands=t,!this.AddinCommands)throw new Error("AddinCommands cannot be null while constructing an addin");this.DisplayName=e.DisplayName,this.IconUrl=e.IconUrl,this.HighResolutionIconUrl=e.HighResolutionIconUrl,this.Id=e.Id}}(),i=n(0),o=n(3593),s=n(129),c=function(){function e(t,n,r,a){var s,c;if(this.control=t,this.tabInfo=n,this.groupInfo=r,this.extension=a,o.b(t)){var l=t;this.subCommands=[];try{for(var u=i.__values(l.MenuItems),d=u.next();!d.done;d=u.next()){var p=d.value;this.subCommands.push(new e(p,n,r,a))}}catch(e){s={error:e}}finally{try{d&&!d.done&&(c=u.return)&&c.call(u)}finally{if(s)throw s.error}}}}return Object.defineProperty(e.prototype,"isActionable",{get:function(){return!!this.control.Action},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMenu",{get:function(){return!!this.control.MenuItems},enumerable:!0,configurable:!0}),e.prototype.get_EntryPoint=function(){return o.c(this.control)?this.control.Action.SourceLocation:o.a(this.control)?this.extension.ExtensionPointCollection.FunctionFile:(Object(s.a)(this.control),"")},e.prototype.get_Id=function(){return this.extension.Id+this.control.Id},e.prototype.get_Label=function(){return this.control.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_Size16Icon=function(){return this.control&&this.control.Icon?this.control.Icon.Size16Url:null},e}(),l=function(){function e(e,t){this.detectedEntity=e,this.extension=t}return e.prototype.get_EntryPoint=function(){return this.detectedEntity.SourceLocation},e.prototype.get_Id=function(){return this.extension.Id},e.prototype.get_Label=function(){return this.detectedEntity.Label},e.prototype.get_ExtensionDisplayName=function(){return this.extension.DisplayName},e.prototype.get_ActivationRule=function(){return this.detectedEntity.Rule},e.prototype.get_Size16Icon=function(){return this.extension.IconUrl},e}(),u=n(994);!function(e){e[e.TimedOut=-1]="TimedOut",e[e.Success=0]="Success",e[e.FunctionNotFound=11101]="FunctionNotFound",e[e.NavigatedBeforeCompleted=13001]="NavigatedBeforeCompleted",e[e.PreinstalledConsented=13002]="PreinstalledConsented",e[e.Unknown=13003]="Unknown"}(r||(r={}));var d=r,p=n(790),f=n(3086),m=function(){function e(){}return e.prototype.CreateAddinCommand=function(e,t,n,r){return new c(e,t,n,r)},e.prototype.CreateContextualAddinCommand=function(e,t){return new l(e,t)},e.prototype.CreateEventAddinCommand=function(e,t){switch(e.Type){case 1:return new c({Id:"ItemSend",Action:e},null,null,t)}return null},e}(),g=n(161);function h(e,t){switch(t){case g.a.MeetingRequest:return e.MessageReadCommandSurface;case g.a.AppointmentAttendee:return e.AppointmentAttendeeCommandSurface;case g.a.AppointmentOrganizer:return e.AppointmentOrganizerCommandSurface;case g.a.DetectedEntity:return e.DetectedEntity;case g.a.MessageCompose:return e.MessageComposeCommandSurface;case g.a.MessageRead:return e.MessageReadCommandSurface;case g.a.TrapOnSendEvent:default:return null}}var v=n(9),y=function(){function e(e){this.addinCommandFactory=e}return e.prototype.CreateAddinIfEntryPointSupported=function(e,t){var n;return(n=t==g.a.TrapOnSendEvent?this.GetEventsAddinCommands(e.ExtensionPointCollection.Events,e):t==g.a.DetectedEntity?this.GetContextualAddinCommand(h(e.ExtensionPointCollection,t),e):this.GetAddinCommands(h(e.ExtensionPointCollection,t),e))?new a(e,n):null},e.prototype.GetAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.Tabs.forEach(function(e){e.Groups.forEach(function(a){a.Controls.forEach(function(i){r[i.Id]=n.addinCommandFactory.CreateAddinCommand(i,e,a,t)})})}),new v.ObservableMap(r)},e.prototype.GetContextualAddinCommand=function(e,t){if(!e)return null;var n={};return n[t.Id]=this.addinCommandFactory.CreateContextualAddinCommand(e,t),new v.ObservableMap(n)},e.prototype.GetEventsAddinCommands=function(e,t){var n=this;if(!e)return null;var r={};return e.forEach(function(e){r[e.Type]=n.addinCommandFactory.CreateEventAddinCommand(e,t)}),new v.ObservableMap(r)},e}();var b=n(876);function _(){return{regExMatches:{},matchedKnownEntityTypes:[],filteredEntityMatches:{}}}var S=n(4),C=Object(S.action)("destroyExtensibilityHostItem")(function(e){b.a.HostItems.delete(e)}),A=n(961),I=n(486);function O(e){var t=Object(I.a)();return t.runningContextualAddinCommand&&t.runningContextualAddinCommand.controlId===e?t.runningContextualAddinCommand:null}var T=n(2125),x=n(892);function E(e){var t=Object(T.c)(e);if(t)return t.addinCommand;var n=O(e);return n?n.addinCommand:Object(x.a)(e)}function M(e){var t=Object(I.a)().activeDialog;return t&&e===t.controlId?5:Object(T.c)(e)?2:O(e)?1:Object(x.a)(e)?3:4}function P(e){var t=Object(I.a)(),n=function(e,t){return i.__spread(t.taskPanes.values()).filter(function(t){return t.hostItemIndex===e}).map(function(e){return e.controlId})}(e,t),r=function(e,t){var n=t.runningUILessAddinCommands;if(n.has(e))return i.__spread(n.get(e).keys());return[]}(e,t),a=function(e,t){var n=t.runningContextualAddinCommand;if(n&&n.hostItemIndex===e)return[t.runningContextualAddinCommand.controlId];return[]}(e,t);return i.__spread(n,r,a)}var k=n(739);function R(){return b.a.Context}function w(e){var t=E(e);return t&&t.extension.Id}function N(e){return b.a.HostItems.get(e)}function D(e){var t=Object(T.c)(e);if(t)return t.hostItemIndex;var n=O(e);return n?n.hostItemIndex:Object(x.b)(e)}function F(){return b.a.activeSsoDialog}function L(e){return E(e).extension.WebApplicationResource}var U=n(995),B=n(1),j=Object(B.mutatorAction)("hideSsoDialog",function(e){var t=F();(!e||t.isOpen&&t.controlId===e)&&(b.a.activeSsoDialog=Object(U.a)())});function H(){return Object(I.a)().EnabledAddinCommands.isInitialized}function V(e){H()?e():Object(v.when)(H,e)}function W(){return b.a.ExtensibilityStateIsDirty}var G=n(89);function z(){return Object(G.a)()}var q=Object(S.action)("terminateContextualCallout")(function(){var e=Object(I.a)();e.runningContextualAddinCommand=null,e.contextualCalloutState.contextualAnchor=null,e.contextualCalloutState.activeContextualAddinCommands=[],e.contextualCalloutState.selectedTerms=[]}),X=Object(S.action)("initializeContextualCallout")(function(e,t,n){var r=Object(I.a)();r.runningContextualAddinCommand&&q();var a=N(t),o=new v.ObservableMap,s=r.contextualCalloutState;s.selectedTerms=[],e.forEach(function(e){var t=a.contextualTerms.get(e).slice();t&&t.length>0&&(s.selectedTerms.push(e),t.forEach(function(e){o.set(e.get_Id(),e)}))}),s.contextualAnchor=n,s.activeContextualAddinCommands=i.__spread(o.values()),s.hostItemIndex=t}),K=Object(S.action)("initializeExtensibilityHostItem")(function(e){b.a.HostItems.has(e)||b.a.HostItems.set(e,{contextualTerms:null,contextualEvaluationResults:null})}),J=n(2924);function Q(){return!!b.a.activeDialog||F().isOpen}function Y(e){return Object(I.a)().HostItems.has(e)}var Z=Object(B.mutatorAction)("setActiveDialog",function(e){Object(I.a)().activeDialog=e}),$=Object(S.action)("setEnabledAddinCommands")(function(e){b.a.EnabledAddinCommands=e}),ee=n(5),te=n(29),ne=Object(S.action)("setExtensibilityContext")(function(e){if(e&&e.Extensions){for(var t=Object(te.e)(),n=t&&t.UserOptions&&t.UserOptions.WebSuggestedRepliesEnabledForUser,r=-1,a=0;a<e.Extensions.length;a++){var i=e.Extensions[a];"599e5de2-d41c-442a-bdb4-92eafa18a0dc"===i.Id&&null==i.ExtensionPointCollection.DetectedEntity&&(i.ExtensionPointCollection.DetectedEntity=i.ExtensionPointCollection.CustomPane,i.ExtensionPointCollection.DetectedEntity.Label=i.DisplayName),n&&"bc13b9d0-5ba2-446a-956b-c583bdc94d5e"===i.Id&&(Object(ee.d)("rp-smartTime")||Object(ee.d)("mc-smartReplyWithCustomMeeting"))&&(r=a)}r>=0&&e.Extensions.splice(r,1)}b.a.Context=e}),re=Object(S.action)("setExtensibilityStateIsDirty")(function(e){b.a.ExtensibilityStateIsDirty=e}),ae=Object(S.action)("setContextualAddinCommand")(function(e,t,n){Object(I.a)().runningContextualAddinCommand=function(e,t,n){return{controlId:e,addinCommand:t,hostItemIndex:n}}(e,n,t)}),ie=Object(B.mutatorAction)("setTaskPaneAddinCommand",function(e,t,n,r,a,i){var o=Object(I.a)().taskPanes,s=function(e,t,n,r,a,i){return{controlId:e,addinCommand:t,hostItemIndex:n,mode:r,errorType:a||0,initializationContext:i}}(e,n,t,a,null,i);o.set(r,s)}),oe="DeferrablePromise timed out",se=function(){function e(e){var t=this;this.internalPromise=new Promise(function(n,r){t.internalResolve=n,t.internalReject=r,t.timeout=setTimeout(function(){r(new Error(oe)),t.isRejected=!0},e)})}return e.prototype.then=function(e,t){return this.internalPromise.then(e,t)},e.prototype.catch=function(e){return this.internalPromise.catch(e)},e.prototype.resolve=function(e){this.isFullfilled&&this.isRejected||(this.internalResolve(e),this.isFullfilled=!0,clearTimeout(this.timeout))},e.prototype.reject=function(e){this.isFullfilled&&this.isRejected||(this.internalReject(e),this.isRejected=!0,clearTimeout(this.timeout))},e}(),ce=33e4,le={};var ue=Object(S.action)("setUilessAddinCommand")(function(e,t,n){var r=function(e){var t=new se(ce);return le[e]=t,t.catch(function(e){return e.message===oe?{status:d.TimedOut}:{status:d.Unknown}})}(e),a=Object(I.a)().runningUILessAddinCommands;return a.has(n)||a.set(n,new v.ObservableMap),a.get(n).set(e,t),r}),de=n(962),pe=Object(B.mutatorAction)("showSsoDialog",function(e,t,n){b.a.activeSsoDialog=Object(U.b)(e,t,n)}),fe=Object(B.mutatorAction)("terminateTaskPaneAddin",function(e){Object(I.a)().taskPanes.delete(e)}),me=Object(B.mutatorAction)("terminatePersistantTaskPaneAddinWithAppId",function(e){var t=Object(I.a)().taskPanes.get("Persistent");t&&t.addinCommand.extension.Id===e&&Object(I.a)().taskPanes.delete("Persistent")}),ge=Object(S.action)("terminateUilessAddinCommand")(function(e,t,n,r){!function(e,t){le[e]&&(le[e].resolve(t),delete le[e])}(e,{status:n,allowEvent:r&&r.allowEvent});var a=Object(I.a)().runningUILessAddinCommands;a.has(t)&&(a.get(t).delete(e),0===a.get(t).size&&a.delete(t))}),he=Object(B.mutatorAction)("toggleTaskPaneType",function(e){var t=Object(T.b)(e);if(t){var n=Object(I.a)().taskPanes;n.delete(e),n.set(Object(T.a)(e),t)}}),ve=Object(S.action)("updateConsentState")(function(e,t,n){E(t).extension.ConsentState=Number(n)}),ye=Object(S.select)({hostItem:function(e,t,n){return b.a.HostItems.get(e)}})(Object(S.action)("updateContextualEvaluation")(function(e,t,n,r){var a=r.hostItem;a&&(a.contextualTerms=t,a.contextualEvaluationResults=n)})),be=Object(S.action)("updateEntityExtractionResult")(function(e,t){e.EntityExtractionResult=t}),_e=Object(S.action)("updateExtensionSettings")(function(e,t,n){E(t).extension.Settings=n}),Se=n(2925),Ce=Object(B.mutatorAction)("updatePersistentTaskPaneHostItem",function(e){Object(T.b)("Persistent").hostItemIndex=e}),Ae=Object(B.mutatorAction)("updateSsoDialogVisibility",function(e){F().isVisible=e}),Ie=Object(S.action)("setCompliance")(function(e){var t=JSON.parse(e);t&&t.hasOwnProperty("IsMinor")&&(b.a.compliance.isMinor=t.IsMinor)});n.d(t,"b",function(){return m}),n.d(t,"c",function(){return y}),n.d(t,"i",function(){return b.a}),n.d(t,"g",function(){return _}),n.d(t,"h",function(){return C}),n.d(t,"j",function(){return A.a}),n.d(t,"k",function(){return A.b}),n.d(t,"l",function(){return E}),n.d(t,"o",function(){return M}),n.d(t,"m",function(){return P}),n.d(t,"y",function(){return T.b}),n.d(t,"z",function(){return T.c}),n.d(t,"A",function(){return T.d}),n.d(t,"w",function(){return k.c}),n.d(t,"n",function(){return k.a}),n.d(t,"p",function(){return R}),n.d(t,"q",function(){return I.a}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return N}),n.d(t,"u",function(){return D}),n.d(t,"x",function(){return F}),n.d(t,"B",function(){return L}),n.d(t,"C",function(){return j}),n.d(t,"H",function(){return H}),n.d(t,"ib",function(){return V}),n.d(t,"I",function(){return W}),n.d(t,"v",function(){return z}),n.d(t,"D",function(){return X}),n.d(t,"E",function(){return K}),n.d(t,"G",function(){return x.c}),n.d(t,"L",function(){return x.d}),n.d(t,"K",function(){return J.a}),n.d(t,"F",function(){return Q}),n.d(t,"J",function(){return Y}),n.d(t,"M",function(){return Z}),n.d(t,"P",function(){return $}),n.d(t,"Q",function(){return ne}),n.d(t,"R",function(){return re}),n.d(t,"O",function(){return ae}),n.d(t,"S",function(){return ie}),n.d(t,"T",function(){return ue}),n.d(t,"U",function(){return de.a}),n.d(t,"V",function(){return pe}),n.d(t,"W",function(){return q}),n.d(t,"Y",function(){return fe}),n.d(t,"X",function(){return me}),n.d(t,"Z",function(){return ge}),n.d(t,"ab",function(){return he}),n.d(t,"bb",function(){return ve}),n.d(t,"cb",function(){return ye}),n.d(t,"db",function(){return be}),n.d(t,"eb",function(){return _e}),n.d(t,"fb",function(){return Se.a}),n.d(t,"gb",function(){return Ce}),n.d(t,"hb",function(){return Ae}),n.d(t,"N",function(){return Ie}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return u.a}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return p.a}),n.d(t,"r",function(){return f.a})},1914:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s});var r={};function a(e,t){s(e)&&i(e),r[e]=t}function i(e){delete r[e]}function o(e){return r[e]}function s(e){return!!r[e]}},1918:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20),a=["doneText","addRemoveTimezonesText","timezonesSearchHintText","localTimeText","timeZoneText","todayStringLowerCaseText","allDayDurationText","cancelLowerCaseText","previousMonthText","nextMonthText","selectDateAriaLabelText","cancelMeetingText","closeText","deleteEventConfirmationTitleText","deleteSeriesConfirmationTitleText","deleteEventConfirmationSubText","deleteGroupEventConfirmationSubText","deleteThisEventForwardTitleText","deleteThisEventForwardSubText","deleteThisGroupEventForwardSubText","deleteEventSeriesConfirmationSubText","deleteGroupEventSeriesConfirmationSubText","deleteCalendarConfirmationTitleText","deleteCalendarConfirmationSubText","deleteCalendarGroupConfirmationTitleText","deleteCalendarGroupConfirmationSubText","confirmDiscardEventTitleText","confirmDiscardEventSubText","confirmDiscardChangesTitleText","confirmDiscardChangesSubText","confirmAttachmentsChangedTitleText","confirmAttachmentsChangedSubText","calendarModuleNameText","newCalendarEventText","calendarEllipsisAriaLabelText","calendarsAreNotAvailable","tryAgainByRefreshingBrowser","calendarsUnavailableDismissLabel","calendarLoadingEvents","calendarErrorItemNoLongerExist","calendarAgendaToggle","calendarNotificationsBarCreateEvent","calendarNotificationsBarUpdateEvent","calendarNotificationsBarDeleteEvent","calendarNotificationsBarUpdateMeeting","calendarNotificationsBarCancelMeeting","calendarNotificationsBarDeclineMeeting","calendarNotificationsBarForwardEvent","calendarNotificationsBarCreateEventFailed","calendarNotificationsBarUpdateEventFailed","calendarNotificationsBarDeleteEventFailed","calendarNotificationsBarForwardEventFailed","calendarNotificationsBarCreateCalendar","calendarNotificationsBarAddCalendar","calendarNotificationsBarRenameCalendar","calendarNotificationsBarUpdateCalendar","calendarNotificationsBarSetCalendarColor","calendarNotificationsBarDeleteCalendar","calendarNotificationsBarRemoveCalendar","calendarNotificationsBarCreateCalendarFailed","calendarNotificationsBarAddCalendarFailed","calendarNotificationsBarRenameCalendarFailed","calendarNotificationsBarDeleteCalendarFailed","calendarNotificationsBarRemoveCalendarFailed","calendarNotificationsBarUpdateCalendarFailed","calendarNotificationsBarSetCalendarColorFailed","calendarNotificationsBarCreateCalendarGroup","calendarNotificationsBarRenameCalendarGroup","calendarNotificationsBarDeleteCalendarGroup","calendarNotificationsBarCreateCalendarGroupFailed","calendarNotificationsBarRenameCalendarGroupFailed","calendarNotificationsBarDeleteCalendarGroupFailed","calendarNotificationsBarTryAgain","calendarNotificationsBarUndo","calendarText","myCalendarsText","otherCalendarsText","peoplesCalendarsText","groupCalendarsText","selectedCalendarText","notSelectedCalendarText","failedCreateCalendarGroupText","failedDeleteCalendarGroupText","failedCreateCalendarText","failedDeleteCalendarText","failedRenameCalendarText","failedRenameCalendarGroupText","failedSetCalendarColorText","failedUpdateCalendarText","shareCalendarDialogTitle","shareLabel","removeTooltip","notSharedPermission","notSharedPermissionTooltip","canViewPermission","canViewPermissionTooltip","canViewBusyPermission","canViewBusyPermissionTooltip","canViewTitlesPermission","canViewTitlesPermissionTooltip","canViewAllDetailsPermission","canViewAllDetailsPermissionTooltip","canEditPermission","canEditPermissionTooltip","delegatePermission","delegatePermissionTooltip","privateEventCheckbox","delegateSectionTitle","delegateSectionDescription","delegateSectionLabel","delegateAndSendMeCopyPermission","delegateAndSendMeCopyPermissionTooltip","delegateOnlyPermission","delegateOnlyPermissionTooltip","delegateAndMePermission","delegateAndMePermissionTooltip","sharedUsersForConsumersListSectionLabel","sharedUsersInOrganizationListSection","sharedUsersOutsideOrganizationListSection","notSharedWithAnyoneText","shareInvitationInfoText","peoplePickerPlaceHolderText","learnMoreLinkText","myOrganizationLabel","retrievingSharingInvitationsText","validatingSharingPermissionsMessage","doNotHavePermissionsMessage","searchPeopleLabel","noResultsFoundLabel","loadingLabel","suggestedContactsAriaLabel","peoplePickerAriaLabel","sharingPermissionsNotLoaded","sharingPermissionDeleteFailed","sharingPermissionUpdateFailed","sharingInviteSendFailed","emailAddressValidationFailed","globalDelegateSettingUpdateFailed","sharingPermissionsNotLoadedIllustrationMessage","tryAgainLabel","alreadySharedAriaLabel","shareSuccessAriaLabel","updatePermissionSuccessAriaLabel","removePermissionSuccessAriaLabel","open","openOccurrence","openSeries","charm","freeBusyItemSelectedScreenReaderText","freeBusyItemNotSelectedScreenReaderText","categoryMenuItemMenuText","addToMyCalendar","addToMyCalendarSubMenuAddOccurrenceText","addToMyCalendarSubMenuAddSeriesText","lightBlueCalendarColorText","lightGreenCalendarColorText","redCalendarColorText","darkBlueCalendarColorText","yellowCalendarColorText","tealCalendarColorText","lightPinkCalendarColorText","brownCalendarColorText","darkPinkCalendarColorText","blueCalendarColorText","greenCalendarColorText","indigoCalendarColorText","grayCalendarColorText","pinkCalendarColorText","orangeCalendarColorText","violetCalendarColorText","charmsCatAriaText","charmsDogAriaText","charmsPlaneAriaText","charmsCalculatorAriaText","charmsMedicalAriaText","charmsTrophyAriaText","charmsHouseAriaText","charmsMedicineAriaText","charmsBriefcaseAriaText","charmsCoffeeAriaText","charmsPeopleAriaText","charmsStopwatchAriaText","charmsMusicAriaText","charmsShoppingAriaText","charmsCarAriaText","charmsStarAriaText","charmsNoteAriaText","charmsPersonAriaText","charmsBalloonsAriaText","charmsForkAndKnifeAriaText","charmsHeartAriaText","charmsSoccerBallAriaText","charmsFilmAriaText","charmsChartAriaText","charmsBooksAriaText","charmsCakeAriaText","charmsTvPanelAriaText","charmsTravelAriaText","charmsPackageDeliveryAriaText","charmsPromotionAriaText","charmsEventAriaText","charmsHotelAriaText","everyoneAvailable","singleAttendeeUnavailable","multipleAttendeesUnavailable","singleAttendeeAndOrganizerUnavailable","multipleAttendeesAndOrganizerUnavailable","organizerUnavailable","singleLocationAndSingleAttendeeUnavailable","singleLocationAndMultipleAttendeesUnavailable","singleLocationSingleAttendeeAndOrganizerUnavailable","singleLocationMultipleAttendeesAndOrganizerUnavailable","singleLocationAndOrganizerUnavailable","multipleLocationsAndSingleAttendeeUnavailable","multipleLocationsAndMultipleAttendeesUnavailable","multipleLocationsSingleAttendeeAndOrganizerUnavailable","multipleLocationsMultipleAttendeesAndOrganizerUnavailable","multipleLocationsAndOrganizerUnavailable","singleLocationUnavailable","multipleLocationsUnavailable","locationsUnavailable","updateWithSingleLocationConflict","updateWithMultipleLocationsConflict","saveButtonLabel","sendButtonLabel","attachButtonLabel","attachFromMenuHeaderText","attachFromComputerButtonLabel","attachFromCloudButtonLabel","discardButtonLabel","deleteButtonLabel","cancelButtonLabel","bodyPlaceholderText","private","peoplePickerAddPeoplePlaceHolder","peoplePickerAddRequiredPeoplePlaceHolder","peoplePickerAddOptionalPeoplePlaceHolder","optionalAttendeesPickerPlaceHolder","organizerAvailableTitle","organizerFreeBusyTitle","attendeeStatusTitle","attendeeAvailableStatusTitle","attendeeStatusUnknownTitle","attendeeConflictOverflowTooltip","openSchedulingAssistantTitle","availableFreeBusy","unknownFreeBusy","addroomText","roomListTitle","roomsTitle","tracking","insertPicturesInlineTooltip","emojiTooltip","formattingOptionsTooltipHide","formattingOptionsTooltip","ReplyAllMenuItem","ReplyMenuItem","ForwardMenuItem","expressionsHeader","fullComposeTitlePlaceholderText","recurrenceUntilAriaPlaceholder","roomCapacityTitle","roomFeaturesTitle","roomAdaCompliantFeatureTitle","groupMemberWillReceiveInvite","groupMemberWillContinueToReceiveUpdates","groupMemberWillContinueToReceiveUpdatesInInbox","groupMemberWillGetMeetingCancellation","browsePlacesTitle","searchRoomsPlaceholder","browseMorePlacesTitle","anyRoomListName","missingTitleTitle","missingTitleMeetingDescription","missingTitleAppointmentDescription","dontSaveButtonLabel","dontSendButtonLabel","showStartEndTimeZoneOption","hideStartEndTimeZoneOption","showTimeConversionsOption","hideTimeConversionsOption","removeTimeZoneTooltip","addTimeZoneButton","timeZonesHeader","timeConversionsTitle","timezoneInsightsInfobar","showTimeZoneInsightsInfobarAction","hideTimeZoneInsightsInfobarAction","overwriteTimeZonesWarningTitle","overwriteTimeZonesWarningMessage","nextDay","previousDay","invalidRecipientsDialogTitle","invalidRecipientsDialogDescription","suggestedRoomListsHeader","allRoomListsHeader","showOnlyAvailableRoomsToggleLabel","noRoomsFoundMessageLineOne","noRoomsFoundMessageLineTwo","findingRoomsSearchState","checkingAvailabilitySearchState","showingResultsFromSearchState","roomRichConferencingFeatureTitle","roomCapacityWithPlaceholderTitle","initialRoomPanelSearchStateLabel","reservedRoomsState","managedRoomsState","roomResultAriaLabel","timeSuggestionLabel","timeSuggestionLoading","timeSuggestionNotFound","timeSuggestionSchedulingAssistant","timeSuggestionSeparator","accessibilityCheckerHeader","multipleRoomListsSelectionLabel","roomPanelFilterWellPlaceholderLabel","roomPanelFilterWellNoResultsFound","roomPanelFilterSuggestionRoomlist","roomPanelFilterSuggestionCity","roomPanelShowingAvailableRoomsIn","roomPanelShowingRoomsIn","roomPanelSuggestedRooms","roomPanelShowAllRooms","explicitFeedbackLinkText","feedbackDialogTitle","feedbackDialogInputDescription","quickAddIntroHeader","quickAddIntroBody1","quickAddIntroBody2","quickAddIntroBody3","quickAddIntroCTA","sundayAbbreviated","mondayAbbreviated","tuesdayAbbreviated","wednesdayAbbreviated","thursdayAbbreviated","fridayAbbreviated","saturdayAbbreviated","organizerInvitedPrincipal","organizerInvitedYou","youAreOrganizer","principalIsOrganizer","eventPartOfSeries","noResponseReceivedAttendeesLabelAndCount","declinedAttendeesLabelAndCount","tentativelyAcceptedAttendeesLabelAndCount","acceptedAttendeesLabelAndCount","attendeeAccepted","attendeeTentativelyAccepted","attendeeDeclined","attendeeDidnotRespond","twoAttendeesAccepted","twoAttendeesTentativelyAccepted","twoAttendeesDeclined","twoAttendeesDidnotRespond","twoAttendeeResponsesConcatenationFormat","threeAttendeeResponsesConcatenationFormat","fourAttendeeResponsesConcatenationFormat","acceptedTime","tenativelyAcceptedTime","cancelledTime","edit","cancel","cancelError","thisEvent","thisAndAllFollowingEvents","allEventsInSeries","editorPlaceholderText","editorDescriptionAriaLabel","cancelEdit","cancelSendNow","cancelEditorText","cancelThisEventForwardEditorText","cancelOccurrenceEditorText","cancelSeriesEditorText","delete","createError","deleteError","updateError","removeFromCalendar","removeSeriesFromCalendar","respondWithMessage","sendResponseNow","noSendResponse","cancelWithMessage","cancelNow","responseEditorWatermark","sendButtonString","discardButtonString","openItemButtonAriaLabel","acceptButtonText","acceptButtonAriaLabel","tentativeButtonText","tentativeButtonAriaLabel","declineButtonText","declineButtonAriaLabel","itemDeleteConfirmationDescriptionText","itemCancelConfirmationDescriptionText","itemDeleteConfirmationBackText","forwardButtonLabel","duplicateEventButtonLabel","acceptedButtonLabel","tentativeButtonLabel","declineButtonLabel","discardChangesConfirmationLabel","dontDiscardLabel","requestResponsesItem","allowForwardingItem","hideAttendeesItem","responseOptionsButtonLabel","addSkypeMeetingLabel","addTeamsMeetingLabel","removeSkypeMeetingLabel","removeTeamsMeetingLabel","addedSkypeMeetingToast","addedTeamsMeetingToast","onlineSkypeMeetingLocationLabel","joinSkypeMeetingButton","onlineTeamsMeetingLocationLabel","joinTeamsMeetingButton","genericOnlineMeetingButton","addOnlineMeeting","removeOnlineMeeting","singleEmailReminderSummary","multipleEmailRemindersSummary","addEmailReminderDropdownOption","editEmailReminderDropdownOption","emailReminderHeader","emailReminderInfoHeader","emailReminderMessagePlaceholder","addAnotherEmailReminderButtonLabel","emailReminderDescription","editEmailReminderButtonLabel","removeEmailReminderButtonLabel","remindMeLabel","remindAllAttendeesLabel","customReminderLabel","customReminderDatePickerAriaLabel","customReminderTimePickerAriaLabel","reminderSummaryText","noReminderMessageText","sendToAllAttendees","saveEmailRemidnerText","dicardEmailReminderText","dayOfEventOptionEmailReminder","oneDayBeforeEventOptionEmailReminder","twoDaysBeforeEventOptionEmailReminder","oneWeekBeforeEventOptionEmailReminder","twoWeeksBeforeEventOptionEmailReminder","oneMonthBeforeEventOptionEmailReminder","invalidRecurrenceDialogTitle","invalidRecurrenceDialogDescription","commandBarOverflowAriaLabel","acceptEvent","tentativelyAcceptEvent","declineEvent","proposeNewTime","acceptEventAndAddMessage","tentativelyAcceptEventAndAddMessage","declineEventAndAddMessage","acceptOccurrenceAndAddMessage","tentativelyAcceptOccurrenceAndAddMessage","declineOccurrenceAndAddMessage","acceptSeriesAndAddMessage","tentativelyAcceptSeriesAndAddMessage","declineSeriesAndAddMessage","proposeNewTimeAndAddMessage","notifyOrganiserLabel","rsvpToInstanceLabel","rsvpToSeriesLabel","editRsvpToLabel","editRsvpLabel","rsvpLabel","taskPPFAriaLabel","goalPPFAriaLabel","fitnessPPFAriaLabel","cakePPFAriaLabel","examPPFAriaLabel","pastClarificationPPFC","pastTentativePPFC","pastNoPPFC","pastYesPPFC","popoutsOpenInNewWindow","addLocationText","addLocationTextConsumer","addToCalendarText","durationDay","durationFirstPluralDays","durationSecondGenitivePluralDays","durationHour","durationFirstPluralHours","durationSecondGenitivePluralHours","reminderDay","reminderSingularHour","reminderSingularWeek","reminderFirstPluralHours","reminderSecondGenitivePluralHours","reminderFirstPluralMin","reminderSecondGenitiveMin","reminderBefore","reminderAfter","reminderDayOfEvent","reminderDayBeforeEvent","reminderWeekBeforeEvent","addToCalendar","allDay","atTimeOfEvent","custom","remindMe","repeat","customRecurrenceModalTitle","start","noReminder","repeatNever","repeatNeverAriaText","repeatDaily","repeatWeekly","repeatMonthly","repeatYearly","recurrenceDropdownAriaText","recurrenceHeaderAriaLabel","repeatsWithEndAriaPlaceHolder","repeatsWithoutEndPlaceHolder","occursPlaceHolder","occursAriaPlaceHolder","occursUntilPlaceHolder","occursMonthlyUntilPlaceHolder","occursUntilAriaPlaceHolder","chooseEndDateLabel","save","discard","undo","eventDeleted","replyDiscarded","moreDetails","durationLabel","startTimeLabel","endTimeLabel","timeOptionsLabel","startDateLabel","endDateLabel","subjectDetailsLabel","selectEventCharmLabel","selectEventCalendarLabel","infoMessageEditOccurrence","infoMessageEditSeries","toText","changeRecurrenceConfirmationTitleText","changeRecurrenceSubText","titlePlaceholderText","repeatEvery","day","days","month","months","week","weeks","year","years","removeEndDate","createEventOnGroupCalendar","invitationWontBeSentToGroup","sendEventToAllGroupMembers","guidedCaptureExample","guidedCaptureExampleShort","forwardingMasterInfoMessage","forwardingInstanceInfoMessage","forwardingSingleEventInfoMessage","requiredAttendees","addRequiredAttendee","optionalAttendees","addOptionalAttendee","resourceAttendees","addRoom","showOnlyWorkHours","expandHeader","collapseHeader","schedulingAssistantAriaLabel","schedulingAssistantAriaDateAndStatus","removeAttendee","attendeeStatusFree","attendeeStatusTentative","attendeeStatusBusy","attendeeStatusOOF","attendeeStatusWorkingElsewhere","attendeeStatusNoData","attendeeStatusLoading","goToTodayStringLowerCaseText","goToTodayDateText","switchToDayText","switchToWeekText","switchToWorkWeekText","switchToMonthText","goToPreviousDayText","goToNextDayText","goToPreviousWeekStringText","goToNextWeekStringText","goToPreviousMonthText","goToNextMonthStringText","goToPreviousDayStringLowerCaseText","goToNextDayStringLowerCaseText","goToPreviousWeekStringLowerCaseText","goToNextWeekStringLowerCaseText","goToPreviousMonthStringLowerCaseText","goToNextMonthStringLowerCaseText","goToPreviousYearStringLowerCaseText","goToNextYearStringLowerCaseText","am","pm","moreTooltip","addCalendarString","newCalendarString","newCalendarGroupString","newGroupString","discoverGroupsString","renameCalendarGroupString","deleteCalendarGroupString","renameCalendarString","removeCalendarString","changeCalendarColorString","automaticColorString","addToFavorites","removeFromFavorites","toggleLeftPaneAriaLabel","eventLocationAriaText","eventOrganizerAriaText","eventDescriptionAriaText","allDayEventDescriptionAriaText","singleDayEventDescriptionAriaText","whenStartEndsSameDayLongAriaText","whenStartEndsDifferentDayLongAriaText","whenStartEndsDifferentDayDateOnlyLongAriaText","calendarMeetingDndModalTitle","calendarMeetingDndModalEditButtonText","calendarMeetingDndModalEditButtonDesc","calendarMeetingDndModalDiscardButtonText","calendarMeetingDndModalDiscardButtonDesc","commandBarEllipsisAriaLabel","toggleSplitViewText","toggleSplitViewDisabledTooltip","toggleSplitViewDisabledForOneCalendarTooltip","toggleDeclinedMeetingsViewText","showMoreCalendarsString","showLessCalendarsString","bookingPageButtonText","newBirthdayString","declinedEvent","leftRailRegionName","commandBarRegionName","newEventSkipLinkName","miniMonthRegionName","calendarPickerRegionName","surfaceCommandBarRegionName","timestripRegionName","calendarSurfaceRegionName","eventsLoadedLiveNotification","jumpToRegion","newEventRegionName","dateSelectionRegionName","calendarListRegionName","moduleSwitcherRegionName","calendarViewOptionsRegionName","calendarViewRegionName","agendaViewRegionName","agendaViewToggleRegionName","monthViewOverFlowMoreEvents","collapseMiniMonthTitle","expandMiniMonthTitle","expandAgendaPaneTitle","collapseAgendaPaneTitle","firstName","lastName","birthday","birthdaysTitle","neverRemind","happyBirthdayGreeting","editEventButton","deleteEventButton","viewBirthdayEvent","editBirthdayEvent","deleteBirthdayEvent","discardChangesButton","saveChangesButton","remindLabel","newBirthdayEvent","DiscoverCalendarsText","AddAndDiscoverCalendarsText","PoweredByText","BingText","PopularCalendarsText","PopularText","AddCalendarErrorText","RemoveCalendarErrorText","GetInterestingCalendarsErrorText","DataFromText","HolidaysText","AddCalendarText","FromFileText","FromWebText","ICErrorText","HolidaysErrorText","CancelText","ImportFromFileText","ImportFromWebText","ImportEventsText","ChooseICSFileText","ImportToText","BrowseText","ImportText","ImportingText","NoFileSelectedText","ICSFileTooLargeText","ICSFileErrorText","ImportedText","SubscribeOnlineText","LinkToCalendarText","LinkToCalendarPlaceholderText","CalendarNameText","CalendarNamePlaceholderText","WebcalSuccessText","WebcalSubscriptionExistsText","WebcalUrlErrorText","ICS_SingleFile_MutipleEvents_NotificationMessage","FromDirectoryText","ImportFromDirectoryText","SelectPeopleOrResourceText","FindPeopleControlPlaceholderText","AddText","AddingText","AddCalendarFromDirectoryErrorText","calendarActionsHeaderText","createEventsHeaderText","goToHeaderText","navigateCalendarHeaderText","closeEventCommand","deleteEventCommand","discardDraftCommand","focusSkipLinksCommand","goToCalendarCommand","goToMailCommand","goToNextTimePeriodCommand","goToPeopleCommand","goToPreviousTimePeriodCommand","goToTasksCommand","goToTodayCommand","insertHyperlinkCommand","newEventCommand","openDayViewCommand","openEventCommand","openMonthViewCommand","openAgendaInMonthViewCommand","openWeekViewCommand","openWorkWeekViewCommand","printCalendarCommand","saveAppointmentCommand","searchCalendarsCommand","sendMeetingCommand","showKeyboardShortcutsCommand","locationCardDetailsLabel","openInMaps","call","directions","address","noAddress","phoneNumber","noPhoneNumber","addAddress","capacity","capacitySingle","unknownCapacity","reservedRoom","somethingWentWrong","openNow","detailedOpenNow","closedNow","detailedClosedNow","addALocationText","suggestedLocationsText","useThisLocationText","findLocationInfo_Searching","findLocationInfo_NoMatchFound","findLocationInfo_Loading","resolvedLocationAriaLabel","multipleLocationsFoundAriaLabel","locationSelectedAriaLabel","locationCardInformationLabel","locationCardMapLabel","locationSuggestionRecurringAvailability","locationSuggestionRecurringPartialAvailability","locationSuggestionNotAvailable","eventSeriesOutOfRoomBookingWindow","eventUpdateRecurrenceEndDate","editCommandBarAccesibility","respondYesAccesibility","respondMaybeAccesibility","respondNoAccesibility","respondedYesAccesibility","respondedMaybeAccesibility","respondedNoAccesibility","moreReplyOptionsAccesibility","showAsAccesibility","categorizeAccesibility","deleteAccesibility","cancelAccesibility","ellipsisAccesibility","notifyOrganizerToggleOnAccesibility","editorAriaLabel","sendResponseArialabel","saveResponseArialabel","discardResponseArialabel","sendArialabel","discardArialabel","sendCancelledResponseArialabel","discardCancelledResponseArialabel","notifyOrganizerToggleOffAccesibility","charmSelectedAccesibility","noCharmSelectedAccesibility","titleLabelAccessibility","privateAccesibility","eventDateAccessibility","viewSeriesAccesibility","locationAccessibility","reminderAccesibility","recurrenceAccesibility","notesAccessibility","organizerCardAccesibility","respondedAttendeeCardAccesibility","openInNewWindowAccesibility","closeEventAccesibility","respondYesPeekAria","respondMaybePeekAria","respondedYesPeekAria","respondedMaybePeekAria","respondNoPeekAria","editPeekAria","cancelPeekAria","deletePeekAria","viewPeekAria","getMoreDetailsPeekAria","eventTitlePeekAria","privateMarkerPeekAria","eventDatePeekAria","eventRecurringInfoAria","eventLocationPeekAria","organizerRowOrganizerPeekAria","organizerRowAttendeePeekAria","attendeeSummaryPeekAria","eventNotesPeekAria","respondFormGroupEditorLabelAria","forwardFormGroupEditorLabelAria","cancelFormGroupEditorLabelAria","attendeeWellTitle","sortByString","sortByDisplayName","sortByStatus","sortByOrderAdded","organizer","didNotRespondStatus","noResponseStatus","acceptedStatus","declinedStatus","tentativeStatus","requiredAttendeesLabel","optionalAttendeesLabel","showAsDropDownTitle","showAsFree","showAsWorkingElsewhere","showAsTentative","showAsBusy","showAsAway","showAsNoInformation","showAsOutsideWorkingHours","reminderDropDownTitle","meetingFormEllipsisAriaLabelText","privateControlAltText","privateControlHoverTextForPrivate","privateControlHoverTextForNonPrivate","infobarCannotEditPublicMeeting","infobarCancelledMeeting","infobarEventInPast","infobarNoResponseRequested","infobarNoResponseReuqestedOrganizer","infobarAcceptedByUser","infobarAcceptedByDelegate","infobarTentativelyAcceptedByUser","infobarTentativelyAcceptedByDelegate","infobarDeclinedByUser","infobarDeclinedByDelegate","infobarViewSeries","infobarHideAttendees","infobarHideAttendeesOrganizer","joinByPhone","conferenceId","relatedContentHeader","relatedContentSubHeader","relatedContentFilesHeader","relatedContentEmailsHeader","seeMoreButtonText","moreRelatedContentText","positiveFeedbackTooltip","negativeFeedbackTooltip","resolvedFeedbackTooltip","feedbackQuestionText","yesText","noText","jumpToMeetingInsightsButton","calendarPrintPanelPrintLabel","calendarPrintPanelCancelLabel","calendarPrintPreviewLabel","calendarPrintPreviewCalendarViewButton","calendarPrintPreviewAgendaViewButton","printModalLabel","calendarPrintSettingsCalendarLabel","calendarPrintSettingsMultiCalendarsLabel","calendarPrintSettingsLayoutLabel","calendarPrintSettingsLayoutStandard","calendarPrintSettingsLayoutHorizontal","calendarPrintSettingsLayoutVertical","calendarPrintSettingsViewLabel","calendarPrintSettingsViewDay","calendarPrintSettingsViewWeek","calendarPrintSettingsViewWorkWeek","calendarPrintSettingsViewMonth","calendarPrintSettingsPrintFromLabel","calendarPrintSettingsPrintToLabel","calendarPrintSettingsTimeRangeLabel","calendarPrintSettingsTimeRangeText","printModalCloseIconTitle","calendarPrintSettingsPrintAgenda","calendarPrintSettingsLeaveRoomForNotes","calendarPrintSettingsHideMiniMonth","ErrorCalendarEventCanNotBeCreated","ErrorCannotCreatePublicFolderMeetings","InfoEditingMasterOfSeries","InfoEditingThisAndAllFollowingEvents","InfoEditingOccurrenceOfSeries","InfoAttendeeTentativeAndProposedNewTime","InfoAttendeeDeclinedAndProposedNewTime","InfoMultipleAttendeesHaveProposedNewTime","InfoTimeProposalViewInSchedulingAssistant","InfoTimeProposalEditEvent","InfoTimeProposalCurrentMeetingTime","ErrorInvalidRecipientsMeetingCanNotExecuteOperation","InfoComposeSkypeMeetingDetails","InfoComposeTeamsMeetingDetails","InfoEventOccursInThePast","InfoDoesNotRequireResponseOrganizer","InfoDoesNotRequireResponseAttendee","InfoMeetingAttendeeDoNotForward","InfoMeetingInvitationNotSent","InfoMeetingUpdatesNotSent","WarningCannotEditPublicFolderMeetings","WarningNoResponseTrackingForMeetingOnSecondaryCalendar","WarningContentUnblock","infoLinkClickHere"];t.OwaCalendarStringsStringModule=r.registerStringPackage("owa-calendar-strings",null,a);var i={};a.forEach(function(e){Object.defineProperty(i,e,{get:function(){return t.OwaCalendarStringsStringModule.strings.get(e)}})}),t.getOwaCalendarStrings=function(){return i},t.default=i},1957:function(e,t,n){"use strict";var r,a=n(893),i=n(0);!function(e){e[e.Message=1]="Message",e[e.Appointment=2]="Appointment",e[e.MeetingRequest=3]="MeetingRequest",e[e.MessageCompose=4]="MessageCompose",e[e.AppointmentCompose=5]="AppointmentCompose"}(r||(r={}));var o=r;function s(e,t){return i.__awaiter(this,void 0,void 0,function(){var n;return i.__generator(this,function(r){switch(r.label){case 0:return t.itemType=o.AppointmentCompose,n=t,[4,e.getSeriesId()];case 1:return n.seriesId=r.sent(),[2,t]}})})}function c(e,t,n){return e&&e.match(function(e,t){var n,r="g";t&&(r="ig");try{n=new RegExp(e,r)}catch(e){return null}return n}(t,n))}var l=n(9),u=n(395);function d(e,t,n){if(!e)return{};var r={Addresses:e.Addresses?e.Addresses.map(function(e){return e.Address}):[],Urls:e.Urls?e.Urls.map(function(e){return e.Url}):[],PhoneNumbers:e.PhoneNumbers?e.PhoneNumbers:[]};return r.IsLegacyExtraction=function(e){return!(e.EntityDocument||e.PropertyExistence&&e.PropertyExistence.TextEntityExtractions)}(t),0!=n.extension.RequestedCapabilities&&(r.Contacts=e.Contacts?e.Contacts:[],r.EmailAddresses=e.EmailAddresses?e.EmailAddresses.map(function(e){return e.EmailAddress}):[],r.MeetingSuggestions=e.MeetingSuggestions?e.MeetingSuggestions.map(function(e){var t=this.IsLegacyExtraction,n=Object(l.toJS)(u({},e));return n.EndTime=t?f(n.EndTime):new Date(n.EndTime).getTime(),n.StartTime=t?f(n.StartTime):new Date(n.StartTime).getTime(),n}.bind(r)):[],r.TaskSuggestions=e.TaskSuggestions?e.TaskSuggestions:[]),r}function p(e,t){var n,r;try{for(var a=i.__values(t),o=a.next();!o.done;o=a.next()){var s=c(e,o.value,!0);if(s&&s.length>0)return!0}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return!1}function f(e){var t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),n.getTime()}var m=n(1909);function g(e){var t={};return e&&Object.keys(e).forEach(function(n){var r;e[n]&&(t[n]=(r=e[n],Object(m.q)().contextualCalloutState.selectedTerms.filter(function(e){return r.indexOf(e)>=0})))}),t}var h=n(1092),v=n.n(h),y=n(1093),b=n.n(y),_=n(167),S=n.n(_),C=n(31),A="Success";function I(e,t,n){var r=e.map(function(e){return S()({Id:e})});return v()({Header:Object(C.getJsonRequestHeader)(),Body:b()({ItemShape:t,ItemIds:r,ShapeName:n})}).then(function(e){return function(e){if(e.ResponseClass==A){var t=e;return t.Items[0]}return{}}(e.Body.ResponseMessages.Items[0])})}var O=n(187),T=n.n(O),x=n(33),E=n.n(x);function M(e){return I([e.ItemId.Id],T()({BaseShape:"IdOnly",AdditionalProperties:[E()({FieldURI:"EntityExtractionResult"})]}),null)}function P(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a,o,s;return i.__generator(this,function(i){switch(i.label){case 0:if(t.EntityExtractionResult||!function(e){return e.PropertyExistence&&(e.PropertyExistence.ExtractedAddresses||e.PropertyExistence.ExtractedContacts||e.PropertyExistence.ExtractedEmails||e.PropertyExistence.ExtractedMeetings||e.PropertyExistence.ExtractedPhones||e.PropertyExistence.ExtractedTasks||e.PropertyExistence.ExtractedUrls)}(t))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,M(t)];case 2:return a=i.sent(),Object(m.db)(t,a.EntityExtractionResult),[3,4];case 3:return i.sent(),[3,4];case 4:return t.EntityExtractionResult&&(r.entities=d(t.EntityExtractionResult,t,n),r.entities&&(o=JSON.parse(JSON.stringify(r.entities)),r.selectedEntities=function(e,t){var n={};return e&&t&&(e.Addresses&&(n.Addresses=e.Addresses.filter(function(e){return p(e,t)})),e.MeetingSuggestions&&(n.MeetingSuggestions=e.MeetingSuggestions.filter(function(e){return p(e.MeetingString,t)})),e.TaskSuggestions&&(n.TaskSuggestions=e.TaskSuggestions.filter(function(e){return p(e.TaskString,t)})),e.PhoneNumbers&&(n.PhoneNumbers=e.PhoneNumbers.filter(function(e){return p(e.OriginalPhoneString,t)})),e.Urls&&(n.Urls=e.Urls.filter(function(e){return p(e,t)})),e.Contacts&&(n.Contacts=e.Contacts.filter(function(e){return p(e.ContactString,t)})),e.EmailAddresses&&(n.EmailAddresses=e.EmailAddresses.filter(function(e){return p(e,t)}))),n}(o,Object(m.q)().contextualCalloutState.selectedTerms))),(s=function(e,t){var n=Object(m.t)(e);return n&&n.contextualEvaluationResults&&n.contextualEvaluationResults.has(t)?n.contextualEvaluationResults.get(t):null}(e,n.extension.Id))&&(r.filteredEntities=s.filteredEntityMatches,r.regExMatches=s.regExMatches,r.selectedRegExMatches=g(r.regExMatches)),[2,r]}})})}var k,R,w=n(2550);!function(e){e[e.Other=0]="Other",e[e.DistributionList=1]="DistributionList",e[e.User=2]="User",e[e.ExternalUser=3]="ExternalUser"}(k||(k={})),function(e){e[e.Unknown=0]="Unknown",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accept=3]="Accept",e[e.Decline=4]="Decline",e[e.NoResponseReceived=5]="NoResponseReceived"}(R||(R={}));var N=function(e){return{address:e.EmailAddress,name:e.Name,recipientType:L(e.MailboxType)}},D=function(e){var t=N(e.Mailbox);return t.appointmentResponse=function(e){switch(e){case"Organizer":return R.Organizer;case"Tentative":return R.Tentative;case"Accept":return R.Accept;case"Decline":return R.Decline;case"NoResponseReceived":return R.NoResponseReceived;default:return R.Unknown}}(e.ResponseType),t},F=function(e){return e?e.map(function(e){return D(e)}):[]};function L(e){switch(e){case"PublicDL":case"PrivateDL":case"PublicFolder":return k.DistributionList;case"Mailbox":case"Contact":return k.User;case"OneOff":return k.ExternalUser;default:return k.Other}}function U(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var s,c,l,u;return i.__generator(this,function(i){switch(i.label){case 0:return r.itemType=o.Appointment,s=e.getItem(),r.id=s.ItemId.Id,r.end=s.End,r.start=s.Start,r.location=s.Location.DisplayName,r.dateTimeCreated=s.DateTimeCreated?new Date(s.DateTimeCreated):null,r.dateTimeModified=s.LastModifiedTime?new Date(s.LastModifiedTime):null,r.itemClass=s.ItemClass,r.subject=s.Subject,r.normalizedSubject=s.Subject,r.organizer=D(s.Organizer),c=F(s.RequiredAttendees),r.to=function(e,t){if(t){var n=e.some(function(e){return e.address.toLowerCase()===t.address.toLowerCase()});if(!n)return e.concat(t)}return e}(c,r.organizer),r.cc=F(s.OptionalAttendees),r.attachments=s.Attachments?Object(a.b)(s.Attachments):[],[4,e.getRecurrence()];case 1:return l=i.sent(),r.recurrence=Object(w.a)({recurrenceType:l,timeZone:s.StartTimeZoneId,startTime:new Date(s.Start),endTime:new Date(s.End)}),r.resources=F(s.Resources),u=r,[4,e.getSeriesId()];case 2:return u.seriesId=i.sent(),[4,P(n,s,t,r)];case 3:return[2,r=i.sent()]}})})}var B,j=n(47);function H(){return function(e){if(e===B.consumer)return"outlookCom";return"office365"}(function(){if(Object(j.a)())return B.consumer;return B.office365}())}!function(e){e[e.consumer=0]="consumer",e[e.office365=1]="office365"}(B||(B={}));var V=n(120),W=n(5),G=n(29),z=n(168);function q(e,t,n,r){return r=function(e,t){return t.hostVersion=Object(z.d)()||"debug",t.owaView="mouse",t.timeZoneOffsets=Object(V.d)(),t}(0,r=function(e,t){var n=e.extension;return t.extensionId=n.Id,t.marketplaceContentMarket=n.MarketplaceContentMarket,t.permissionLevel=n.RequestedCapabilities,t.marketplaceAssetId=n.MarketplaceAssetID,t.entryPointUrl=e.get_EntryPoint(),t.consentMetadata=n.ConsentMetadata,t.endNodeUrl=n.EndNodeUrl,t}(t,r)),0!=t.extension.RequestedCapabilities&&(r=function(e,t){return t.userDisplayName=Object(G.g)(),t.userEmailAddress=Object(G.h)(),t.userTimeZone=Object(G.k)(),t.userProfileType=H(),t.ewsUrl=Object(m.p)().EwsUrl,t.restUrl=Object(m.p)().RestUrl,t}(0,r)),Object(W.d)("addin-delegateAccess")&&e.isSharedItem&&e.getSharedProperties&&(r.isFromSharedFolder=e.isSharedItem()),Object(W.d)("addin-delegateAccess")&&(r.shouldRunNewCodeForFlags|=1),r}var X="0xe1d";function K(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var s;return i.__generator(this,function(i){switch(i.label){case 0:return r.id=e.getItemId(),r.isRead=!0,r.itemType=o.Message,s=e.getItem(),r.itemClass=s.ItemClass,r.subject=s.Subject,r.normalizedSubject=function(e,t){if(!e.ExtendedProperty)return null;for(var n=0;n<e.ExtendedProperty.length;n++){var r=e.ExtendedProperty[n];if(r&&r.ExtendedFieldURI&&r.ExtendedFieldURI.PropertyTag===t)return r.Value}return null}(s,X),r.conversationId=s.ConversationId.Id,r.internetMessageId=s.InternetMessageId,r.dateTimeCreated=s.DateTimeCreated?new Date(s.DateTimeCreated).getTime():null,r.dateTimeModified=s.LastModifiedTime?new Date(s.LastModifiedTime).getTime():null,r.dateTimeSent=s.DateTimeSent?new Date(s.DateTimeSent).getTime():null,r.attachments=s.Attachments?Object(a.b)(s.Attachments):[],[4,P(n,s,t,r)];case 1:return r=i.sent(),0==t.extension.RequestedCapabilities?[3,3]:(r.from=s.From?N(s.From.Mailbox):null,r.sender=s.Sender?N(s.Sender.Mailbox):null,r.to=s.ToRecipients?s.ToRecipients.map(N):[],r.cc=s.CcRecipients?s.CcRecipients.map(N):[],r.bcc=s.BccRecipients?s.BccRecipients.map(N):[],function(e){return 0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Request")||0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Canceled")}(s)?[4,J(e,r)]:[3,3]);case 2:r=i.sent(),i.label=3;case 3:return[2,r]}})})}function J(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,a;return i.__generator(this,function(i){switch(i.label){case 0:return n=e.getItem(),t.itemType=o.MeetingRequest,t.location=n.Location.DisplayName,t.start=n.Start,t.end=n.End,t.to=n.RequiredAttendees?n.RequiredAttendees.map(D):[],t.cc=n.OptionalAttendees?n.OptionalAttendees.map(D):[],t.resources=n.Resources?n.Resources.map(D):[],r=t,[4,e.getSeriesId()];case 1:return r.seriesId=i.sent(),[4,e.getRecurrence()];case 2:return a=i.sent(),t.recurrence=Object(w.a)({recurrenceType:a,timeZone:n.StartTimeZoneId,startTime:new Date(n.Start),endTime:new Date(n.End)}),[2,t]}})})}var Q=n(161),Y=n(1914);function Z(e,t){return i.__awaiter(this,void 0,void 0,function(){var n,r,a;return i.__generator(this,function(i){switch(i.label){case 0:switch(n={},r=Object(Y.c)(t),Object(m.t)(t),a=Object(m.l)(e),n=q(r,a,0,n),r.mode){case Q.a.MeetingRequest:case Q.a.MessageRead:return[3,1];case Q.a.MessageCompose:return[3,3];case Q.a.AppointmentAttendee:return[3,4];case Q.a.AppointmentOrganizer:return[3,6]}return[3,8];case 1:return[4,K(r,a,t,n)];case 2:return n=i.sent(),[3,8];case 3:return n=function(e,t){return t.itemType=o.MessageCompose,t.conversationId=e.getConversationId(),t.isRead=!1,t}(r,n),[3,8];case 4:return[4,U(r,a,t,n)];case 5:return n=i.sent(),[3,8];case 6:return[4,s(r,n)];case 7:return n=i.sent(),[3,8];case 8:return[2,n]}})})}var $=n(960),ee=n(959),te=n(885),ne=n(998),re=function(e){var t={locationIdentifier:{}};return t.displayName=e.DisplayName,e.PostalAddress&&"Resource"===e.PostalAddress.LocationSource?(t.emailAddress=e.PostalAddress.LocationUri,t.locationIdentifier.id=t.emailAddress,t.locationIdentifier.type=ne.a.Room):(t.emailAddress="",t.locationIdentifier.id=t.displayName,t.locationIdentifier.type=ne.a.Custom),t};function ae(e){var t,n;if(!e||e.length<=0)return!1;try{for(var r=i.__values(e),a=r.next();!a.done;a=r.next()){if(a.value.id.trim().length<=0)return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}function ie(e,t,n){return"Addin_"+e+"_"+t+"_"+n}var oe,se=n(2709),ce=n(932),le=n(871);function ue(e){return void 0===e&&(e=null),{error:oe.Success,data:e}}function de(e){return{error:oe.Failed,errorCode:e}}function pe(e,t){return!fe(e)&&(t(de(le.a.InsufficientItemPermissions)),!0)}function fe(e){return!e.isSharedItem||!e.getSharedProperties||(!e.isSharedItem()||e.getSharedProperties().delegatePermissions.EditOwn)}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed"}(oe||(oe={}));var me,ge=n(890);function he(e,t,n){return i.__awaiter(this,void 0,void 0,function(){var r,a,o,s,c,l;return i.__generator(this,function(i){switch(i.label){case 0:if(r=Object(Y.c)(e),a=Object(m.s)(t),o=ie(e,a,n),!Object(ge.f)(o))return[2,de(le.b.NotificationKeyNotFound)];if(s=Object(ge.e)(o),(c=s.Persistent)&&!fe(r))return[2,de(le.b.InsufficientItemPermissions)];r.removeNotificationMessage(o),Object(ge.h)(o),i.label=1;case 1:return i.trys.push([1,4,,5]),c?[4,Object(se.a)(e,a)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:return(l=i.sent())instanceof ce.a?[2,de(l.errorCode)]:[3,5];case 5:return[2,ue()]}})})}function ve(e){switch(e){case 0:return"informationalMessage";case 2:return"errorMessage";case 1:return"progressIndicator"}return""}function ye(e,t,n,r,a,o,s,c){return void 0===s&&(s=null),void 0===c&&(c=!1),i.__awaiter(this,void 0,void 0,function(){var l,u,d,p,f,g,h;return i.__generator(this,function(i){switch(i.label){case 0:if(l=Object(Y.c)(e),u=Object(m.s)(t),d=ie(e,u,r),function(e,t,n){var r=Object(m.l)(t);if(r){var a=r.get_Id(),i=ie(e,n,a);Object(ge.f)(i)&&he(e,t,a)}}(e,t,u),p=!1,Object(ge.f)(d)){if(c)return[2,de(le.b.DuplicateNotificationKey)];f=Object(ge.e)(d),p=f.Persistent}else if(Object(ge.g)(e,u))return[2,de(le.b.NumberOfNotificationsExceeded)];if(g=function(e,t,n,r,a,i){return{ExtensionId:e,Persistent:!!t||2===r,Key:n,Type:r,Message:a,Icon:i}}(u,n,r,a,o,s),!fe(l)&&g.Persistent)return[2,de(le.b.InsufficientItemPermissions)];Object(ge.a)(e,u,d,g),l.addNotificationMessage(d),i.label=1;case 1:return i.trys.push([1,4,,5]),p||g.Persistent?[4,Object(se.a)(e,u)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:return(h=i.sent())instanceof ce.a?[2,de(h.errorCode)]:[3,5];case 5:return[2,ue()]}})})}function be(e){try{var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("style");if(n&&n.length>0)for(var r=0;r<n.length;r++)n[r]&&(n[r].innerHTML="");return t.body.textContent||""}catch(e){return""}}function _e(e){var t=Object(m.z)(e);if(t){var n=t.hostItemIndex,r=Object(m.A)(e);Object(m.Y)(r);var a=Object(Y.c)(n);a.closeTaskPane&&a.closeTaskPane()}}function Se(e){return Object(Y.d)(e)}!function(e){e[e.None=-1]="None",e[e.Preset0=0]="Preset0",e[e.Preset1=1]="Preset1",e[e.Preset2=2]="Preset2",e[e.Preset3=3]="Preset3",e[e.Preset4=4]="Preset4",e[e.Preset5=5]="Preset5",e[e.Preset6=6]="Preset6",e[e.Preset7=7]="Preset7",e[e.Preset8=8]="Preset8",e[e.Preset9=9]="Preset9",e[e.Preset10=10]="Preset10",e[e.Preset11=11]="Preset11",e[e.Preset12=12]="Preset12",e[e.Preset13=13]="Preset13",e[e.Preset14=14]="Preset14",e[e.Preset15=15]="Preset15",e[e.Preset16=16]="Preset16",e[e.Preset17=17]="Preset17",e[e.Preset18=18]="Preset18",e[e.Preset19=19]="Preset19",e[e.Preset20=20]="Preset20",e[e.Preset21=21]="Preset21",e[e.Preset22=22]="Preset22",e[e.Preset23=23]="Preset23",e[e.Preset24=24]="Preset24"}(me||(me={}));var Ce=n(91),Ae=n(89);var Ie=/^[a-zA-Z0-9.!#$%&*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function Oe(e){return Ie.test(e)}function Te(e){var t=[];return e.forEach(function(e){Oe(e.address)&&t.push({Name:e.name,EmailAddress:e.address})}),t}var xe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},Ee=/[&<>"'\/]/g;var Me=n(4420),Pe=n.n(Me);function ke(){return null}var Re="<div>",we="</div>";function Ne(e){var t=e.trim();return t.substr(0,Re.length).toLowerCase()==Re&&t.substr(t.length-we.length,we.length).toLowerCase()==we&&(t=t.substring(Re.length,t.length-we.length)),t}function De(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){switch(n.label){case 0:return[4,(r=e,Pe()({input:r}).catch(ke))];case 1:return null==(t=n.sent())?[2,null]:[2,Ne(t)]}var r})})}var Fe=n(110),Le=1e6;function Ue(e,t,n,r,a,o){return i.__awaiter(this,void 0,void 0,function(){var t,s,c,l,u;return i.__generator(this,function(i){switch(i.label){case 0:return(t=n.appendTxt?n.appendTxt:n.data).length>Le?(r(de(le.a.OoeInvalidDataFormat)),[2]):(s=o&&o(),c=null,n.coercionType!==te.a.Html?[3,2]:[4,De(t)]);case 1:return null==(c=i.sent())?(r(de(le.a.HtmlSanitizationFailure)),[2]):[3,3];case 2:l=Object(Y.c)(e),c="HTML"!==l.getBodyType()||n.appendOnSend?t:t.replace(Ee,function(e){return xe[e]}),i.label=3;case 3:if(n.appendOnSend)n.appendOnSend.txt=c,a(n.appendOnSend);else{if(o&&(u=o(),p=u,!(null==(d=s)&&null==p||null!=d&&null!=p&&d.data===p.data&&d.sourceProperty===p.sourceProperty&&d.startPosition===p.startPosition&&d.endPosition===p.endPosition)))return r(de(le.a.CursorPositionChanged)),[2];a(c),"Firefox"===Object(Fe.a)().browser&&document.activeElement.blur()}return r(ue()),[2]}var d,p})})}var Be=n(2924),je=5e3;var He,Ve=n(3513);function We(e,t,n,r){!function(e){return i.__spread(Object(m.q)().taskPanes.values()).some(function(t){return t.controlId===e})}(t)?function(e){return Object(m.q)().runningContextualAddinCommand&&Object(m.q)().runningContextualAddinCommand.controlId===e}(t)&&Object(m.W)():_e(t),r(ue())}!function(e){e[e.MaxRecipientsOnDisplayNewAppointment=100]="MaxRecipientsOnDisplayNewAppointment",e[e.MaxSubjectLength=255]="MaxSubjectLength",e[e.MaxBodyLengthOnDisplayApis=32768]="MaxBodyLengthOnDisplayApis",e[e.MaxLocationLengthOnDisplayNewAppointment=255]="MaxLocationLengthOnDisplayNewAppointment",e[e.MaxAttachmentNumberOnDisplayApis=100]="MaxAttachmentNumberOnDisplayApis",e[e.MaxRecipientsPerCall=100]="MaxRecipientsPerCall"}(He||(He={}));var Ge=He,ze=function(e){return"string"==typeof e?{Name:e,EmailAddress:e}:{Name:e.name,EmailAddress:e.address}},qe=function(e){return e?e.map(ze):[]};function Xe(e,t){return e&&e.length>t}function Ke(e){switch(e[0]){case"file":return function(e){return{id:e[2],name:e[1],attachmentType:a.a.File,isInline:e[3]}}(e);case"item":return function(e){return{id:e[2],name:e[1],attachmentType:a.a.Item,isInline:!1}}(e);default:return null}}function Je(e,t,n,r,a){return i.__awaiter(this,void 0,void 0,function(){var t,o,s;return i.__generator(this,function(i){switch(i.label){case 0:return t="",o=[],n.htmlBody?n.htmlBody.length>Ge.MaxBodyLengthOnDisplayApis?(r(de()),[2]):[4,De(n.htmlBody)]:[3,2];case 1:if(null==(t=i.sent()))return r(de()),[2];i.label=2;case 2:if(n.attachments){if(n.attachments.length>Ge.MaxAttachmentNumberOnDisplayApis)return r(de()),[2];o=n.attachments.map(Ke)}return[4,(s=Object(Y.c)(e)).displayReplyForm(s.getItemId(),a,t,o)];case 3:return i.sent(),r(ue()),[2]}})})}function Qe(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Je(e,0,n,r,!0)];case 1:return t.sent(),[2]}})})}function Ye(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Je(e,0,n,r,!1)];case 1:return t.sent(),[2]}})})}n(2041);var Ze=n(4421),$e=n.n(Ze);function et(e,t,n){var r={Body:e,Token:t,ExtensionId:n};return $e()(r)}var tt=n(20),nt="Token type is not supported for caching: {0}",rt=n(2207),at=n.n(rt),it=n(2208),ot=n.n(it),st="CallerIdentity",ct="ScopedToken",lt="ExtensionRestApiCallback",ut="ExtensionCallback";function dt(e,t,n){var r=new Array(t.length);t.forEach(function(t,a){return r[a]={TokenType:t,Id:e,Scope:n}});var a=ot()({TokenRequests:r});return at()({Header:Object(C.getJsonRequestHeader)(),Body:a})}var pt=15,ft={},mt={};function gt(e,t){yt(t.TokenType)[e]=function(e){return{cacheTime:Date.now(),token:e}}(t)}function ht(e,t){var n=yt(t);return function(e,t){var n=yt(t);n[e]&&(r=n[e],a=Date.now()-r.cacheTime,i=1e3*(r.token.TTL-pt)*60,a>=i)&&delete n[e];var r,a,i;return!!n[e]}(e,t)?n[e].token:null}function vt(e){return e==st||e==ut}function yt(e){switch(e){case st:return ft;case ut:return mt;default:throw Object(tt.format)(nt,e)}}var bt="Success";function _t(e,t,n){return i.__awaiter(this,void 0,void 0,function(){var r,a,o,s;return i.__generator(this,function(i){switch(i.label){case 0:if(vt(t)&&(r=ht(e.extension.Id,t)))return[2,r];a=[],ht(e.extension.Id,st)||a.push(st),2!=e.extension.RequestedCapabilities||ht(e.extension.Id,ut)||a.push(ut),!n||t!=lt&&t!=ct||a.push(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,dt(e.extension.Id,a,n)];case 2:return o=i.sent(),[3,4];case 3:return i.sent(),[2,null];case 4:return s=function(e){return e.Body.ResponseMessages.Items.forEach(St),e.Body.ResponseMessages.Items}(o),[2,Ct(t)(s)]}})})}function St(e){"NoError"==e.ResponseCode&&e.ResponseClass==bt&&vt(e.Token.TokenType)&&gt(e.Token.Id,e.Token)}var Ct=function(e){return function(t){var n=t.filter(At(e))[0];return n?n.Token:null}},At=function(e){return function(t){return"NoError"==t.ResponseCode&&t.ResponseClass==bt&&t.Token.TokenType==e}};var It=1e6;var Ot,Tt=n(3491),xt="Error",Et="accessToken";!function(e){e.Base64="base64",e.Eml="eml",e.Url="url",e.Ical="iCalendar"}(Ot||(Ot={}));var Mt=n(129);function Pt(e,t,n){return i.__awaiter(this,void 0,void 0,function(){var r,a,o,s,c,l,u,d,p,f,m,g;return i.__generator(this,function(h){switch(h.label){case 0:if(o=null,s=t.getItem(),c=!1,!s.HasAttachments)return[3,13];h.label=1;case 1:h.trys.push([1,10,11,12]),l=i.__values(s.Attachments),u=l.next(),h.label=2;case 2:return u.done?[3,9]:(d=u.value,p=d.AttachmentOriginalUrl,f=d.AttachmentId.Id,"ReferenceAttachment:#Exchange"!==d.__type||n!==p?[3,3]:(m=d,o={format:Ot.Url,content:m.AttachLongPathName},c=!0,[2,o]));case 3:return n!==f?[3,8]:!0!==e?[3,5]:[4,t.getAttachmentContent(n)];case 4:return o=h.sent(),[3,7];case 5:return[4,t.getAttachmentContent(n)];case 6:o=h.sent(),h.label=7;case 7:return c=!0,[2,o];case 8:return u=l.next(),[3,2];case 9:return[3,12];case 10:return g=h.sent(),r={error:g},[3,12];case 11:try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}return[7];case 12:if(!c)return[2,o];h.label=13;case 13:return[2,o]}})})}function kt(e){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){switch(n.label){case 0:return e.NormalizedBody?[3,2]:[4,I([e.ItemId.Id],T()({BaseShape:"IdOnly",AdditionalProperties:[E()({FieldURI:"NormalizedBody"})]}),"ItemNormalizedBody")];case 1:t=n.sent(),e.NormalizedBody=t.NormalizedBody,n.label=2;case 2:return[2,e.NormalizedBody.Value]}})})}function Rt(e,t){return{wasSuccessful:e,token:t}}var wt="ParentItemId:";var Nt=n(2802);var Dt=32,Ft=126;function Lt(e){var t,n;if(!e)return!1;try{for(var r=i.__values(e),a=r.next();!a.done;a=r.next()){var o=a.value;if(null==o||0===o.trim().length)return!1;for(var s=o.length;s--;)if(o.charCodeAt(s)>Ft||o.charCodeAt(s)<Dt)return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!0}var Ut,Bt,jt=500;!function(e){e[e.Read=1]="Read",e[e.Create=2]="Create",e[e.DeleteOwn=4]="DeleteOwn",e[e.DeleteAll=8]="DeleteAll",e[e.EditOwn=16]="EditOwn",e[e.EditAll=32]="EditAll"}(Ut||(Ut={})),function(e){e[e.Start=1]="Start",e[e.End=2]="End"}(Bt||(Bt={}));var Ht=Bt;var Vt=n(547),Wt=n(4422),Gt=n.n(Wt);function zt(e,t,n){var r={ExtensionId:e,ItemId:t};return Gt()({request:r},n?{headers:Object(Vt.c)(n)}:{})}function qt(e,t,n){return{errorMessage:e,wasSuccessful:t,customProperties:n}}var Xt=n(2133);var Kt=n(4423),Jt=n.n(Kt),Qt=n(4424),Yt=n.n(Qt);function Zt(e,t){var n=Yt()({Id:e,ConsentState:t});return Jt()({Header:Object(C.getJsonRequestHeader)(),Body:n})}var $t=n(4425),en=n.n($t);function tn(e,t,n,r){var a={ExtensionId:e,ItemId:t,CustomProperties:r};return en()({request:a},n?{headers:Object(Vt.c)(n)}:{})}var nn=n(4426),rn=n.n(nn);var an=32768;var on=255;var sn,cn,ln=n(12);!function(e){e[e.GetInitialData=1]="GetInitialData",e[e.GetUserIdentityToken=2]="GetUserIdentityToken",e[e.EwsRequest=5]="EwsRequest",e[e.LoadCustomProperties=3]="LoadCustomProperties",e[e.SaveCustomProperties=4]="SaveCustomProperties",e[e.DisplayNewAppointmentForm=7]="DisplayNewAppointmentForm",e[e.DisplayMessageForm=8]="DisplayMessageForm",e[e.DisplayAppointmentForm=9]="DisplayAppointmentForm",e[e.DisplayReplyForm=10]="DisplayReplyForm",e[e.DisplayReplyAllForm=11]="DisplayReplyAllForm",e[e.GetCallbackToken=12]="GetCallbackToken",e[e.SetBodySelectedDataAsync=13]="SetBodySelectedDataAsync",e[e.GetBodyTypeAsync=14]="GetBodyTypeAsync",e[e.GetRecipientsAsync=15]="GetRecipientsAsync",e[e.AddFileAttachmentAsync=16]="AddFileAttachmentAsync",e[e.SetSubjectAsync=17]="SetSubjectAsync",e[e.GetSubjectAsync=18]="GetSubjectAsync",e[e.AddItemAttachmentAsync=19]="AddItemAttachmentAsync",e[e.RemoveAttachmentAsync=20]="RemoveAttachmentAsync",e[e.SetRecipientsAsync=21]="SetRecipientsAsync",e[e.AddRecipientsAsync=22]="AddRecipientsAsync",e[e.BodyPrependAsync=23]="BodyPrependAsync",e[e.GetTimeAsync=24]="GetTimeAsync",e[e.SetTimeAsync=25]="SetTimeAsync",e[e.GetLocationAsync=26]="GetLocationAsync",e[e.SetLocationAsync=27]="SetLocationAsync",e[e.GetSelectedDataAsync=28]="GetSelectedDataAsync",e[e.SetSelectedDataAsync=29]="SetSelectedDataAsync",e[e.DisplayReplyFormWithAttachments=30]="DisplayReplyFormWithAttachments",e[e.DisplayReplyAllFormWithAttachments=31]="DisplayReplyAllFormWithAttachments",e[e.SaveAsync=32]="SaveAsync",e[e.AddNotificationMessageAsync=33]="AddNotificationMessageAsync",e[e.GetAllNotificationMessagesAsync=34]="GetAllNotificationMessagesAsync",e[e.ReplaceNotificationMessageAsync=35]="ReplaceNotificationMessageAsync",e[e.RemoveNotificationMessageAsync=36]="RemoveNotificationMessageAsync",e[e.GetBodyAsync=37]="GetBodyAsync",e[e.SetBodyAsync=38]="SetBodyAsync",e[e.RegisterConsentAsync=40]="RegisterConsentAsync",e[e.Close=41]="Close",e[e.CloseApp=42]="CloseApp",e[e.DisplayNewMessageForm=44]="DisplayNewMessageForm",e[e.EventCompleted=94]="EventCompleted",e[e.CloseContainer=97]="CloseContainer",e[e.GetAccessTokenAsync=98]="GetAccessTokenAsync",e[e.GetInitializationContextAsync=99]="GetInitializationContextAsync",e[e.AppendOnSendAsync=100]="AppendOnSendAsync",e[e.GetRecurrenceAsync=103]="GetRecurrenceAsync",e[e.SetRecurrenceAsync=104]="SetRecurrenceAsync",e[e.GetFromAsync=107]="GetFromAsync",e[e.GetSharedPropertiesAsync=108]="GetSharedPropertiesAsync",e[e.MESSAGE_PARENT_DISPID=144]="MESSAGE_PARENT_DISPID",e[e.GetAttachmentsAsync=149]="GetAttachmentsAsync",e[e.AddBase64FileAttachmentAsync=148]="AddBase64FileAttachmentAsync",e[e.GetAttachmentContentAsync=150]="GetAttachmentContentAsync",e[e.GetInternetHeadersAsync=151]="GetInternetHeadersAsync",e[e.SetInternetHeadersAsync=152]="SetInternetHeadersAsync",e[e.RemoveInternetHeadersAsync=153]="RemoveInternetHeadersAsync",e[e.GetEnhancedLocationsAsync=154]="GetEnhancedLocationsAsync",e[e.AddEnhancedLocationsAsync=155]="AddEnhancedLocationsAsync",e[e.RemoveEnhancedLocationsAsync=156]="RemoveEnhancedLocationsAsync",e[e.GetMasterCategoriesAsync=160]="GetMasterCategoriesAsync",e[e.AddMasterCategoriesAsync=161]="AddMasterCategoriesAsync",e[e.RemoveMasterCategoriesAsync=162]="RemoveMasterCategoriesAsync",e[e.SaveSettingsRequest=404]="SaveSettingsRequest"}(sn||(sn={}));var un=((cn={})[sn.GetInitialData]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var n;return i.__generator(this,function(a){switch(a.label){case 0:return[4,Z(t,e)];case 1:return n=a.sent(),Object(Nt.e)(!0,Object(m.l)(t),e,Object(m.o)(t)),r(n),[2]}})})},cn[sn.EwsRequest]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var e,a,o,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return!(e=n.body)||e.length>It?(r(de(le.b.GenericResponseError)),[2]):[4,_t(a=Object(m.l)(t),ut)];case 1:if(!(o=i.sent()))return r(de(le.b.GenericTokenError)),[2];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,et(e,o.TokenValue,a.extension.Id)];case 3:return s=i.sent(),c=function(e){return{wasProxySuccessful:e.WasProxySuccessful,errorMessage:e.ErrorMessage,statusCode:e.StatusCode,statusDescription:e.StatusDescription,body:e.Body}}(s),r(c),[3,5];case 4:return i.sent(),r(de(le.b.GenericResponseError)),[3,5];case 5:return[2]}})})},cn[sn.GetRecipientsAsync]=function(e,t,n,r){r(ue(Object(Y.c)(e).getRecipients(n.recipientField).slice(0,jt).map(function(e){return{name:e.Name,address:e.EmailAddress,recipientType:L(e.MailboxType)}})))},cn[sn.GetSubjectAsync]=function(e,t,n,r){r(ue(Object(Y.c)(e).getSubject()||""))},cn[sn.SetSubjectAsync]=function(e,t,n,r){if(n.subject.length>on)r(de(null));else{var a=Object(Y.c)(e);pe(a,r)||(a.setSubject(n.subject),r(ue()))}},cn[sn.SetRecipientsAsync]=function(e,t,n,r){var a=Object(Y.c)(e);if(!pe(a,r)){var i=Te(n.recipientArray);try{a.setRecipients(n.recipientField,i),r(ue())}catch(e){r(de(e.errorCode))}}},cn[sn.AddRecipientsAsync]=function(e,t,n,r){var a=Object(Y.c)(e);if(!pe(a,r)){var i=Te(n.recipientArray);try{a.addRecipients(n.recipientField,i),r(ue())}catch(e){r(de(e.errorCode))}}},cn[sn.SaveSettingsRequest]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a,o,s;return i.__generator(this,function(i){switch(i.label){case 0:if(a=n[0],(o=JSON.stringify(a)).length>an)return r(de(le.b.GenericSettingsError)),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),s=Object(m.l)(t),[4,(c=s.extension.Id,l=s.extension.Version,u=o,d={ExtensionId:c,ExtensionVersion:l,Settings:u},rn()({request:d}))];case 2:return i.sent(),Object(m.eb)(e,t,o),r(ue()),[3,4];case 3:return i.sent(),r(de(le.b.GenericSettingsError)),[3,4];case 4:return[2]}var c,l,u,d})})},cn[sn.GetAccessTokenAsync]=function(e,t,n,r){Object(W.d)("addin-getAccessTokenAsync-api")?!function(e){return!!Object(m.B)(e)}(t)?r(de(Tt.b.NotSsoAgave)):Object(m.F)()?r(de(Tt.b.InternalError)):(Object(Tt.d)(function(e,t){var n,a;r(e?function(e){var t;return(t={})[xt]=e,t}(e):(n=t,(a={})[xt]=oe.Success,a[Et]=n,a))}),n.forceConsent?Object(m.V)(t,m.f.OmexConsent,n.authChallenge):n.authChallenge?Object(m.V)(t,m.f.MFASignIn,n.authChallenge):Object(Tt.c)(t,n.authChallenge)):r(de(Tt.b.OperationNotSupported))},cn[sn.GetCallbackToken]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a,o,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return a=Object(m.l)(t),o=function(e){var t=Y.c(e).getItemId();return t?wt+t:null}(e),s=n.isRest?lt:ct,o?[4,_t(a,s,o)]:(r(de(le.b.CallSaveAsyncBeforeToken)),[2]);case 1:return c=i.sent(),r(c?Rt(!0,c.TokenValue):de(le.b.GenericTokenError)),[2]}})})},cn[sn.GetUserIdentityToken]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(n){switch(n.label){case 0:return[4,_t(Object(m.l)(t),st)];case 1:return e=n.sent(),r(e?Rt(!0,e.TokenValue):de(le.b.GenericTokenError)),[2]}})})},cn[sn.MESSAGE_PARENT_DISPID]=function(e,t,n,r){Object(Xt.d)(Xt.a.DISPLAY_DIALOG_DISPID,t,n,function(){r(ue())})},cn[sn.SetBodyAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a;return i.__generator(this,function(i){switch(i.label){case 0:return pe(t=Object(Y.c)(e),r)?[2]:(a=n.coercionType==te.a.Html?"HTML":"Text",[4,Ue(e,0,n,r,function(e){return t.setBody(e,a)})]);case 1:return i.sent(),[2]}})})},cn[sn.GetBodyAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o;return i.__generator(this,function(i){switch(i.label){case 0:if(t=Object(Y.c)(e),a=t.mode,o=null,a!=Q.a.MessageRead&&a!=Q.a.AppointmentAttendee)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,kt(t.getItem())];case 2:return o=i.sent(),[3,4];case 3:return i.sent(),r(de(le.a.GenericResponseError)),[2];case 4:return[3,6];case 5:a!=Q.a.MessageCompose&&a!=Q.a.AppointmentOrganizer||(o=t.getBody()),i.label=6;case 6:return n.coercionType==te.a.Text&&(o=be(o)),r(ue(o)),[2]}})})},cn[sn.GetBodyTypeAsync]=function(e,t,n,r){var a=Object(Y.c)(e).getBodyType();r(ue(a&&a.toLowerCase()||null))},cn[sn.BodyPrependAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(a){switch(a.label){case 0:return pe(t=Object(Y.c)(e),r)?[2]:n.coercionType===te.a.Html&&"Text"===t.getBodyType()?(r(de(le.a.OoeInvalidDataFormat)),[2]):[4,Ue(e,0,n,r,t.prependBody)];case 1:return a.sent(),[2]}})})},cn[sn.Close]=function(e,t){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Object(Y.c)(e).close()];case 1:return t.sent(),Object(Ve.a)(e),[2]}})})},cn[sn.CloseApp]=We,cn[sn.CloseContainer]=We,cn[sn.DisplayMessageForm]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){switch(t.label){case 0:return[4,Object(Y.c)(e).displayMessageForm(n.itemId)];case 1:return t.sent(),r(ue()),[2]}})})},cn[sn.DisplayReplyAllForm]=Qe,cn[sn.DisplayReplyAllFormWithAttachments]=Qe,cn[sn.DisplayReplyForm]=Ye,cn[sn.DisplayReplyFormWithAttachments]=Ye,cn[sn.DisplayAppointmentForm]=function(e,t,n,r){n.itemId?(Object(Y.c)(e).displayAppointmentForm(n.itemId),r(ue())):r(de())},cn[sn.DisplayNewAppointmentForm]=function(e,t,n,r){var a;!n||Xe((a=n).requiredAttendees,Ge.MaxRecipientsOnDisplayNewAppointment)||Xe(a.optionalAttendees,Ge.MaxRecipientsOnDisplayNewAppointment)||Xe(a.subject,Ge.MaxSubjectLength)||Xe(a.body,Ge.MaxBodyLengthOnDisplayApis)||Xe(a.location,Ge.MaxLocationLengthOnDisplayNewAppointment)?r(de()):(Object(Y.c)(e).displayNewAppointmentForm(qe(n.requiredAttendees),qe(n.optionalAttendees),n.start,n.end,n.location,n.resources,n.subject,n.body),r(ue()))},cn[sn.DisplayNewMessageForm]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o,s,c,l,u,d;return i.__generator(this,function(p){switch(p.label){case 0:if(t=!1,a=i.__read([n.toRecipients,n.ccRecipients,n.bccRecipients].map(function(e){return e?e.length>Ge.MaxRecipientsPerCall?(t=!0,null):function(e){var t=[];return e.forEach(function(e){Oe(e)&&t.push({Name:e,EmailAddress:e,MailboxType:"OneOff",RoutingType:"SMTP"})}),t}(e):[]}),3),o=a[0],s=a[1],c=a[2],t)return r(de()),[2];if(l="",n.subject){if(n.subject.length>Ge.MaxSubjectLength)return r(de()),[2];l=n.subject}return u="",n.htmlBody?n.htmlBody.length>Ge.MaxBodyLengthOnDisplayApis?(r(de()),[2]):[4,De(n.htmlBody)]:[3,2];case 1:if(null==(u=p.sent()))return r(de()),[2];p.label=2;case 2:if(d=[],n.attachments){if(n.attachments.length>Ge.MaxAttachmentNumberOnDisplayApis)return r(de()),[2];d=n.attachments.map(Ke)}return[4,Object(Y.c)(e).displayNewMessageForm(o,s,c,l,u,d)];case 3:return p.sent(),r(ue()),[2]}})})},cn[sn.EventCompleted]=function(e,t,n,r){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(t,n)},cn[sn.GetSelectedDataAsync]=function(e,t,n,r){var a=Object(Y.c)(e).getSelectedData();a?(n.coercionType==te.a.Text&&(a.data=be(a.data)),r(ue(a))):r(de(le.a.InvalidSelection))},cn[sn.SetSelectedDataAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a;return i.__generator(this,function(i){switch(i.label){case 0:return pe(t=Object(Y.c)(e),r)?[2]:null==(a=t.getSelectedData())?(r(de(le.a.InvalidSelection)),[2]):n.coercionType===te.a.Html&&("subject"===a.sourceProperty||"body"===a.sourceProperty&&"Text"===t.getBodyType())?(r(de(le.a.OoeInvalidDataFormat)),[2]):[4,Ue(e,0,n,r,t.setSelectedData,t.getSelectedData)];case 1:return i.sent(),[2]}})})},cn[sn.SetBodySelectedDataAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(a){switch(a.label){case 0:return pe(t=Object(Y.c)(e),r)?[2]:[4,Ue(e,0,n,r,t.setBodySelectedData,t.getSelectedData)];case 1:return a.sent(),[2]}})})},cn[sn.SaveAsync]=function(e,t,n,r){var a=Object(Y.c)(e);pe(a,r)||a.saveItem().then(function(e){r(e?ue(e):de(le.a.SaveError))})},cn[sn.LoadCustomProperties]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var n,a,o,s,c,l;return i.__generator(this,function(i){switch(i.label){case 0:if(n=Object(Y.c)(e),!(a=n.getItemId()))return r(qt("",!0,"{}")),[2];o=Object(m.s)(t),i.label=1;case 1:return i.trys.push([1,3,,4]),n.isSharedItem&&n.getSharedProperties&&n.isSharedItem()&&n.isRemoteItem()&&(c=n.getSharedProperties(),s=c.owner),[4,zt(o,a,s)];case 2:return l=i.sent(),r(qt(l.ErrorMessage,l.WasSuccessful,l.CustomProperties)),[3,4];case 3:return i.sent(),r(de(le.b.GenericResponseError)),[3,4];case 4:return[2]}})})},cn[sn.SaveCustomProperties]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a,o,s,c,l,u,d;return i.__generator(this,function(i){switch(i.label){case 0:a=Object(Y.c)(e),o=Object(m.s)(t),s=JSON.stringify(n.customProperties),c=a.getItemId(),i.label=1;case 1:return i.trys.push([1,5,,6]),pe(a,r)?[2]:c?[3,3]:[4,a.saveItem()];case 2:c=i.sent(),i.label=3;case 3:return a.isSharedItem&&a.getSharedProperties&&a.isSharedItem()&&a.isRemoteItem()&&(u=a.getSharedProperties(),l=u.owner),[4,tn(o,c,l,s)];case 4:return d=i.sent(),Object(W.d)("addin-delegateAccess")?r(ue()):r(qt(d.ErrorMessage,d.WasSuccessful)),[3,6];case 5:return i.sent(),r(de(le.b.GenericResponseError)),[3,6];case 6:return[2]}})})},cn[sn.AddNotificationMessageAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a;return i.__generator(this,function(i){switch(i.label){case 0:return[4,ye(e,t,n.persistent,n.key,n.type,n.message,n.icon,!0)];case 1:return a=i.sent(),r(a),[2]}})})},cn[sn.GetAllNotificationMessagesAsync]=function(e,t,n,r){r(ue(Object(Y.c)(e).getNotificationMessageIds().reduce(function(e,t){var n=Object(ge.e)(t);return n&&e.push(function(e){return i.__assign({key:e.Key,type:ve(e.Type),message:e.Message,icon:e.Icon},e.Persistent&&{persistent:!0})}(n)),e},[])))},cn[sn.RemoveNotificationMessageAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a;return i.__generator(this,function(i){switch(i.label){case 0:return[4,he(e,t,n.key)];case 1:return a=i.sent(),r(a),[2]}})})},cn[sn.ReplaceNotificationMessageAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a;return i.__generator(this,function(i){switch(i.label){case 0:return[4,ye(e,t,n.persistent,n.key,n.type,n.message,n.icon,!1)];case 1:return a=i.sent(),r(a),[2]}})})},cn[sn.AddItemAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o;return i.__generator(this,function(i){switch(i.label){case 0:t=Object(Y.c)(e),i.label=1;case 1:return i.trys.push([1,3,,4]),pe(t,r)?[2]:[4,t.addItemAttachment(n.name,n.itemId,n.isInline)];case 2:return a=i.sent(),r(a?ue(a):de(le.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=i.sent(),r(de(o)),[3,4];case 4:return[2]}})})},cn[sn.AddFileAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o;return i.__generator(this,function(i){switch(i.label){case 0:t=Object(Y.c)(e),i.label=1;case 1:return i.trys.push([1,3,,4]),pe(t,r)?[2]:[4,t.addFileAttachment(n.name,n.uri,n.isInline)];case 2:return a=i.sent(),r(a?ue(a):de(le.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=i.sent(),r(de(o.errorCode)),[3,4];case 4:return[2]}})})},cn[sn.AddBase64FileAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o;return i.__generator(this,function(i){switch(i.label){case 0:t=Object(Y.c)(e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.addFileAttachmentFromBase64(n.base64String,n.name,n.isInline)];case 2:return a=i.sent(),r(a?ue(a):de(le.a.AttachmentUploadGeneralFailure)),[3,4];case 3:return o=i.sent(),r(de(o.errorCode)),[3,4];case 4:return[2]}})})},cn[sn.RemoveAttachmentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a;return i.__generator(this,function(i){switch(i.label){case 0:if(!n||!n.attachmentIndex)return r(de(le.a.InvalidAttachmentId)),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),pe(t=Object(Y.c)(e),r)?[2]:[4,t.removeAttachment(n.attachmentIndex)];case 2:return i.sent(),r(ue()),[3,4];case 3:return a=i.sent(),r(de(a.errorCode)),[3,4];case 4:return[2]}})})},cn[sn.GetAttachmentContentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o;return i.__generator(this,function(i){switch(i.label){case 0:if(!n||!n.id)return r(de(le.a.InvalidAttachmentId)),[2];switch(t=null,a=Object(Y.c)(e),o=a.mode){case Q.a.MessageRead:return[3,1];case Q.a.MessageCompose:return[3,3];case Q.a.AppointmentAttendee:return[3,5];case Q.a.AppointmentOrganizer:return[3,7]}return[3,9];case 1:return[4,Pt(!0,a,n.id)];case 2:return t=i.sent(),[3,10];case 3:return[4,a.getAttachmentContent(n.id)];case 4:return t=i.sent(),[3,10];case 5:return[4,Pt(!1,a,n.id)];case 6:return t=i.sent(),[3,10];case 7:return[4,a.getAttachmentContent(n.id)];case 8:return t=i.sent(),[3,10];case 9:Object(Mt.a)(o),i.label=10;case 10:if(null==t)return r(de(le.a.InvalidAttachmentId)),[2];try{r(ue(t))}catch(e){r(de(le.a.InvalidAttachmentId))}return[2]}})})},cn[sn.GetAttachmentsAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n,a;return i.__generator(this,function(i){switch(i.label){case 0:switch(t=Object(Y.c)(e),n=null,a=[],t.mode){case Q.a.MessageCompose:return[3,1];case Q.a.AppointmentOrganizer:return[3,3]}return[3,5];case 1:return[4,t.getAttachments()];case 2:return n=i.sent(),[3,5];case 3:return[4,t.getAttachments()];case 4:return n=i.sent(),[3,5];case 5:if(null==n)return r(de(le.a.GenericResponseError)),[2];a=n.map(function(e){return{id:e.id,name:e.name,contentType:e.contentType,size:e.size,attachmentType:e.attachmentType,isInline:e.isInline,url:e.url?e.url:void 0}});try{r(ue(a))}catch(e){r(de(e.errorCode))}return[2]}})})},cn[sn.RegisterConsentAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a,o,s;return i.__generator(this,function(i){switch(i.label){case 0:if(a=n.consentState,!(o=Object(m.s)(t))||!a)return r(de(le.b.GenericResponseError)),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),Object(m.bb)(e,t,a),[4,Zt(o,a)];case 2:return"NoError"===(s=i.sent()).Body.ResponseCode&&"Success"===s.Body.ResponseClass?(r(ue()),[2]):(r(de(le.b.GenericResponseError)),[3,4]);case 3:return i.sent(),r(de(le.b.GenericResponseError)),[3,4];case 4:return[2]}})})},cn[sn.GetLocationAsync]=function(e,t,n,r){r(ue(Object(Y.c)(e).getLocation()||""))},cn[sn.SetLocationAsync]=function(e,t,n,r){if(null!=n.location){var a=Object(Y.c)(e);pe(a,r)||(a.setLocation(n.location),r(ue()))}else r(de(null))},cn[sn.GetTimeAsync]=function(e,t,n,r){var a=Object(Y.c)(e),i=null;n.TimeProperty===Ht.Start?i=a.getStartTime():n.TimeProperty===Ht.End&&(i=a.getEndTime()),r(ue(i))},cn[sn.SetTimeAsync]=function(e,t,n,r){var a=Object(Y.c)(e);if(!pe(a,r)){var i=new Date(n.time);if(n.TimeProperty===Ht.Start)a.setStartTime(i);else if(n.TimeProperty===Ht.End&&!a.setEndTime(i))return void r(de(le.a.InvalidEndTime));r(ue())}},cn[sn.GetInitializationContextAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n;return i.__generator(this,function(a){return t=Object(m.q)().taskPanes,i.__spread(t.values()).forEach(function(t){t.hostItemIndex===e&&t.initializationContext&&(n=t.initializationContext)}),r(n?ue(n):de()),[2]})})},cn[sn.GetFromAsync]=function(e,t,n,r){var a=Object(Y.c)(e).getFrom();r(a?ue({name:a.Name,address:a.EmailAddress}):de())},cn[sn.GetSharedPropertiesAsync]=function(e,t,n,r){var a=Object(Y.c)(e).getSharedProperties();r(ue({delegatePermissions:(i=a.delegatePermissions,o=0,i.Read&&(o+=Ut.Read),i.Create&&(o+=Ut.Create),i.DeleteOwn&&(o+=Ut.DeleteOwn),i.DeleteAll&&(o+=Ut.DeleteAll),i.EditOwn&&(o+=Ut.EditOwn),i.EditAll&&(o+=Ut.EditAll),o),owner:a.owner,restUrl:Object(m.p)().RestUrl}));var i,o},cn[sn.GetRecurrenceAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,n,a;return i.__generator(this,function(i){switch(i.label){case 0:return[4,(t=Object(Y.c)(e)).getRecurrence()];case 1:return n=i.sent(),a=Object(w.a)({recurrenceType:n,timeZone:t.getTimeZone(),endTime:t.getEndTime(),startTime:t.getStartTime()}),r(ue(a)),[2]}})})},cn[sn.SetRecurrenceAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a;return i.__generator(this,function(i){switch(i.label){case 0:return Object(w.c)(n.recurrenceData)?pe(t=Object(Y.c)(e),r)?[2]:[4,t.getSeriesId()]:(r(de(le.a.InvalidRecurrence)),[2]);case 1:return null!=i.sent()?(r(de(le.a.SetRecurrenceOnInstance)),[2]):(null==(a=Object(w.b)(n.recurrenceData))?t.setRecurrence(null):(t.setStartTime(a.startTime),t.setEndTime(a.endTime),t.setRecurrence(a.recurrenceType)),r(ue()),[2])}})})},cn[sn.GetInternetHeadersAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(a){switch(a.label){case 0:return n&&Lt(n.internetHeaderKeys)?[4,Object(Y.c)(e).getInternetHeaders(n.internetHeaderKeys)]:(r(de()),[2]);case 1:return t=a.sent(),r(ue(t)),[2]}})})},cn[sn.SetInternetHeadersAsync]=function(e,t,n,r){if(n&&(a=n.internetHeaderNameValuePairs)&&Lt(Object.keys(a))){var a,i=Object(Y.c)(e);pe(i,r)||(i.setInternetHeaders(n.internetHeaderNameValuePairs),r(ue()))}else r(de())},cn[sn.RemoveInternetHeadersAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(a){switch(a.label){case 0:return n&&Lt(n.internetHeaderKeys)?pe(t=Object(Y.c)(e),r)?[2]:[4,t.removeInternetHeaders(n.internetHeaderKeys)]:(r(de()),[2]);case 1:return a.sent(),r(ue()),[2]}})})},cn[sn.AppendOnSendAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var a,o,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return(a=n.appendTxt)&&a.length>je?(r(de(le.a.OoeInvalidDataFormat)),[2]):pe(o=Object(Y.c)(e),r)?[2]:n.coercionType===te.a.Html&&"Text"===o.getBodyType()?(r(de(le.a.OoeInvalidDataFormat)),[2]):null==(s=Object(m.s)(t))||Object(Be.a)(s,t)?(r(de(le.a.GenericResponseError)),[2]):(c={id:s,typ:n.coercionType,txt:a},n.appendOnSend=c,[4,Ue(e,0,n,r,o.appendOnSend)]);case 1:return i.sent(),[2]}})})},cn[sn.GetEnhancedLocationsAsync]=function(e,t,n,r){var a=Object(Y.c)(e).getEnhancedLocations();!a||a.length<=0?r(ue([])):r(ue(a.map(re)))},cn[sn.AddEnhancedLocationsAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(a){switch(a.label){case 0:if(pe(t=Object(Y.c)(e),r))return[2];if(!n||!ae(n.enhancedLocations))return r(de()),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.addEnhancedLocations(n.enhancedLocations)];case 2:return a.sent(),r(ue()),[3,4];case 3:return a.sent(),r(de()),[3,4];case 4:return[2]}})})},cn[sn.RemoveEnhancedLocationsAsync]=function(e,t,n,r){var a=Object(Y.c)(e);n&&ae(n.enhancedLocations)?(a.removeEnhancedLocations(n.enhancedLocations),r(ue())):r(de())},cn[sn.GetMasterCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var e,t;return i.__generator(this,function(n){try{e=[],null!==(t=Object(Ce.l)())&&(e=t.map(function(e){return{Name:e.Name,Color:me[e.Color]}})),r(ue(e))}catch(e){r(de(e.errorCode))}return[2]})})},cn[sn.AddMasterCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o,s,c;return i.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(t=Object(Y.c)(e)).isSharedItem()?(r(de(le.b.InsufficientItemPermissions)),[2]):(a=n.categoryDetails.map(function(e){return{Name:e.displayName,Id:Object(Ae.a)(),Color:me[e.color]}}),(o=function(e,t){var n=[];return e.forEach(function(e){var t=e.Name.length;if(0===t||t>255)return null;for(var r=!1,a=0;a<n.length;a++)n[a].Name==e.Name&&(n[a].Color=e.Color,r=!0);r||n.push(e)}),n}(a))?function(e){for(var t=Object(Ce.l)(),n=function(n){var r=t.filter(function(t){return t.Name===e[n].Name});if(r.length>0)return{value:!0}},r=0;r<e.length;r++){var a=n(r);if("object"==typeof a)return a.value}return!1}(o)?(r(de(le.b.DuplicateCategoryError)),[2]):[4,t.addCategoriesMailbox(o)]:(r(de(le.b.InvalidCategoryError)),[2]));case 1:return s=i.sent(),r(s?ue():de(le.b.GenericResponseError)),[3,3];case 2:return c=i.sent(),r(de(c.errorCode)),[3,3];case 3:return[2]}})})},cn[sn.RemoveMasterCategoriesAsync]=function(e,t,n,r){return i.__awaiter(this,void 0,void 0,function(){var t,a,o,s;return i.__generator(this,function(i){switch(i.label){case 0:if(i.trys.push([0,2,,3]),(t=Object(Y.c)(e)).isSharedItem())return r(de(le.b.InsufficientItemPermissions)),[2];for(a=0;a<n.categories.length;a++)if(0===(o=n.categories[a].length)||o>255)return r(de(le.b.InvalidCategoryError)),[2];return[4,t.removeCategoriesMailbox(n.categories)];case 1:return s=i.sent(),r(s?ue():de(le.b.GenericResponseError)),[3,3];case 2:return i.sent(),r(de()),[3,3];case 3:return[2]}})})},cn);function dn(e,t,n,r,a){var i=un[t];if(i){var o=Object(m.l)(n),s="ExecuteApiMethod";if(!Se(e))return Object(ln.k)("ExtExecuteApiMethodNoItemFailure",[t]),void a(de(le.b.GenericResponseError));try{i(e,n,r,function(r){var i=null;r&&r.errorCode&&(i=r.errorCode),Object(ln.k)(s,{dispId:t,Id:o.extension.Id,DisplayName:o.extension.DisplayName,owa_1:Object(z.a)(),owa_2:Object(m.w)(e),extPoint:Object(m.o)(n),owa_4:o.extension.Type,errorCode:i}),a(r)})}catch(r){Object(ln.k)(s,{dispId:t,Id:o.extension.Id,DisplayName:o.extension.DisplayName,owa_1:Object(z.a)(),owa_2:Object(m.w)(e),extPoint:Object(m.o)(n),owa_4:o.extension.Type,error:JSON.stringify(r)}),a(de(le.b.InternalServerError))}}}var pn=n(4427),fn=n.n(pn);function mn(e,t,n,r,a){var i={FormFactor:e,ClientLanguage:t,IncludeDisabledExtensions:n,ApiVersionSupported:r,ClientOverrideVersion:a};return fn()({request:i})}var gn=n(4428),hn=n.n(gn),vn=n(4429),yn=n.n(vn);function bn(e){var t=yn()({ItemId:e});return hn()({Header:Object(C.getJsonRequestHeader)(),Body:t})}function _n(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,r;return i.__generator(this,function(a){switch(a.label){case 0:return t=Object(Y.c)(e),n={Id:t.getItemId()},t.addNotificationMessage?(Object(ge.c)(e).map(t.addNotificationMessage),[4,bn(n).catch(Sn)]):[2];case 1:return(r=a.sent())&&(r.Body.Apps||[]).forEach(function(n){var r=!1;n.Notifications.forEach(function(a){var i={ExtensionId:n.Id,Persistent:!0,Key:a.Key,Type:a.Type,Message:a.Message,Icon:a.Icon};2===a.Type&&(i.Persistent=!1,r=!0);var o=ie(e,n.Id,a.Key);Object(ge.a)(e,n.Id,o,i),t.addNotificationMessage(o)}),r&&Object(se.a)(e,n.Id)}),[2]}})})}function Sn(){return null}n.d(t,"d",function(){return Y.a}),n.d(t,"i",function(){return Y.b}),n.d(t,"n",function(){return Y.c}),n.d(t,"h",function(){return re}),n.d(t,"e",function(){return ye}),n.d(t,"g",function(){return be}),n.d(t,"f",function(){return _e}),n.d(t,"j",function(){return ge.b}),n.d(t,"k",function(){return Se}),n.d(t,"l",function(){return c}),n.d(t,"m",function(){return dn}),n.d(t,"o",function(){return M}),n.d(t,"p",function(){return mn}),n.d(t,"q",function(){return H}),n.d(t,"r",function(){return _n}),n.d(t,"s",function(){return he}),n.d(t,"a",function(){return ee.a}),n.d(t,"b",function(){return Z}),n.d(t,"c",function(){return $.a})},1967:function(e,t,n){"use strict";var r=n(5),a=n(4);t.a=Object(a.action)("updateFindResultTransactionId")(function(e,t){var n,a="";t&&(Object(r.d)("rp-3SPeopleSuggestions")?(n=t).Groups&&n.Instrumentation&&(a=n.Instrumentation.TraceId):"Success"==(n=t).ResponseClass&&n.ResultSet&&(a=n.TransactionId));e.findResultTransactionId=a})},1978:function(e,t,n){"use strict";var r=n(1967),a=n(2182),i=n(2183),o=n(2184),s=n(2119),c=n(2080),l=n(2034),u=n(4);t.a=Object(u.action)("showHideFindResult")(function(e,t,n,u){var d=e.findResultSet?e.findResultSet.length:0;if(e.findResultHightlightIndex=-1,n&&d&&e.findResultSet.splice(0,d),t)if(Object(o.a)(e.findPeopleFeedbackManager),0!=e.queryString.length||e.inForceResolve)e.findResultHightlightIndex=0;else{var p=Object(a.a)(e,u);Object(s.a)(e.findResultSet,Object(l.a)(p)),Object(r.a)(e),Object(c.a)(e)}else Object(i.a)(e.findPeopleFeedbackManager);e.shouldShowFindResult=t})},2034:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},2038:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}function a(e){return r(e)&&"Resource"===e.LocationSource}function i(e){var t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}var o=n(7),s=n(1515),c="en-us",l={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","sw-ke":"a_c_pc_pr_ctry","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};var u=", ";function d(e,t,n,r,a,i){var o=[];Object(s.a)(e)||(o[o.length]=e);var c="";return Object(s.a)(t)||(c=t),Object(s.a)(n)||(c=Object(s.a)(c)?n:c+i+n),Object(s.a)(r)||(c=Object(s.a)(c)?r:c+i+r),Object(s.a)(c)||(o[o.length]=c),Object(s.a)(a)||(o[o.length]=a),o}function p(e,t,n,r,a){var i=function(){var e=Object(o.a)(),t="";e&&e.SessionSettings&&!Object(s.a)(e.SessionSettings.UserCulture)&&(t=e.SessionSettings.UserCulture.toLowerCase());var n=l[t];return null==n&&(n=l[c]),n}(),p=[],f=u;switch(i){case"a_c_pc_pr_ctry":p=d(e,t,n,r,a,f);break;case"a_c_pr_ctry_pc":p=d(e,t,r,a,n,f);break;case"a_c_pr_pc_ctry":p=d(e,t,r,n,a,f);break;case"a_ctry_c_pr_pc":p=d(e,a,t,r,n,f);break;case"a_pc_c_pr_ctry":p=d(e,n,t,r,a,f);break;case"a_pc_pr_c_ctry":p=d(e,n,r,t,a,f);break;case"c_a_pc_pr_ctry":p=d(t,e,n,r,a,f);break;case"ctry_pc_pr_c_a":p=d(a,n,r,t,e,f);break;case"ctry_pr_c_pc_a":p=d(a,r,t,n,e,f);break;case"pc_ctry_pr_c_a":p=d(n,a,r,t,e,f);break;case"pc_pr_c_a_ctry":p=d(n,r,t,e,a,f)}return p.join(f)}function f(e){return e?p(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function m(e,t){return Object(s.a)(e)?f(t):e}var g=n(20);function h(e,t){var n=f(t);return Object(s.a)(e)?n:""==n?e:Object(g.format)("{0} ({1})",e,f(t))}var v=/\(([^)]*)\)/gi,y=/\([^)]*\)|[\0-\u001F\!-\/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,b=/\s+/gi;function _(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(v,"")).replace(y,"")).replace(b," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var S=n(34),C=Object.keys(S.a).length/2;function A(e){if(!e)return null;for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),a=n%8;t^=(r<<a)+(r>>8-a)}return t%C}function I(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:_(e),textBoyColor:A(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}function O(e){if(e){var t=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),n=m(e.DisplayName,t);return"Room"==e.PersonaTypeString&&(t.LocationUri=e.EmailAddress.EmailAddress),{personaId:e.PersonaId&&e.PersonaId.Id,feedbackId:e.FeedbackId,displayName:n,postalAddress:t,emailAddress:e.EmailAddress,displayAddress:f(t),initials:_(n),textBoyColor:A(n),selectionSource:"LocationWell",personaType:Object(s.a)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability}}return null}var T=n(0),x=n(3);function E(e,t,n,r){var a=Object(o.a)(),i="",c="",l="";return null!=a&&null!=a.ApplicationSettings&&null!=a.SessionSettings&&null!=a.PolicySettings&&a.PolicySettings.PlacesEnabled&&(i=a.ApplicationSettings.StaticMapUrl,c=a.ApplicationSettings.MapControlKey,l=a.SessionSettings.UserCulture),Object(s.a)(i)||Object(s.a)(c)||Object(s.a)(l)||!e||!t?"":Object(g.format)(i+"?centerPoint={0},{1}&pp={0},{1};51&ms={2},{3}&fmt=png&key={4}&c={5}",e,t,n,r,c,l)}var M=100,P=64,k=64;var R=n(17),w=n(1864),N=n(11),D=n(395),F=function(e){function t(t){var n=e.call(this,t)||this;return n.onCompleteDownload=function(e){n.setState({blobUrl:e}),e?n.requestStatus="success":(n.requestStatus="failed",N.c.warn("getLocationPhoto.downloadLocationPhoto failed"))},n.state={blobUrl:null},n}return T.__extends(t,e),t.prototype.componentDidMount=function(){this.fetchPersonaPhoto(this.props)},t.prototype.componentWillReceiveProps=function(e){this.fetchPersonaPhoto(e)},t.prototype.fetchPersonaPhoto=function(e){e.locationPersona.postalAddress&&e.locationPersona.postalAddress.Latitude&&e.locationPersona.postalAddress.Longitude&&!Object(s.a)(e.locationPersona.displayName)&&!this.state.blobUrl&&"pending"!=this.requestStatus&&"failed"!=this.requestStatus&&(this.requestStatus="pending",function(e,t){var n="";e.postalAddress&&e.postalAddress.Latitude&&e.postalAddress.Longitude&&(n=E(e.postalAddress.Latitude,e.postalAddress.Longitude,P,k));var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType="blob",r.onreadystatechange=function(){if(4===r.readyState){var e=null,n=!1;if(200===r.status){e=r.response;var a=r.getResponseHeader("Content-Type");n=a&&0==a.toLowerCase().indexOf("image")&&e instanceof Blob}var i=void 0;n&&e&&e.size>M&&(i=URL.createObjectURL(e)),t(i)}},r.send()}(e.locationPersona,this.onCompleteDownload))},t.prototype.render=function(){var e=this.props,t=e.locationPersona,n=e.className,r=e.size,a=e.showPersonaDetails;if(t){var i={};return Object(s.a)(this.state.blobUrl)?D(i,{imageInitials:t.initials,initialsColor:t.textBoyColor}):D(i,{imageUrl:this.state.blobUrl,imageShouldFadeIn:!1}),x.createElement(w.a,T.__assign({className:n,presence:S.b.none,hidePersonaDetails:!a,size:r,text:t.displayName,secondaryText:t.displayAddress},i))}return null},t=T.__decorate([R.observer],t)}(x.Component),L=n(2703);function U(e,t){return{displayName:t,postalAddress:e,displayAddress:f(e),initials:_(t),textBoyColor:A(t),selectionSource:"LocationWell",personaType:"Unknown",personaControlId:t}}var B=n(2342),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return T.__extends(t,e),t.prototype.render=function(){return x.createElement(F,{className:B.persona,showPersonaDetails:!0,size:S.c.large,locationPersona:this.props.locationPersona})},t}(x.Component),H=n(354),V=n(98),W="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}",G="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}";function z(e,t,n,r){return e&&t?Object(g.format)(W,e.toString(),t.toString(),n,r):n?Object(g.format)(G,n,r):null}var q=n(1918),X=n.n(q),K=n(2342),J=n(160).bind(K),Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openDirections=function(){t.props.locationPersona.postalAddress&&window.open(z(t.props.locationPersona.postalAddress.Latitude,t.props.locationPersona.postalAddress.Longitude,t.props.locationPersona.postalAddress.FormattedAddress,t.props.locationPersona.displayName),"_blank")},t.onKeyDown=function(e){e.which==V.a.enter&&t.openDirections()},t}return T.__extends(t,e),t.prototype.render=function(){var e=this.props.locationPersona,t=E(e&&e.postalAddress?e.postalAddress.Latitude:void 0,e&&e.postalAddress?e.postalAddress.Longitude:void 0,290,135);return x.createElement("span",null,e.displayAddress&&x.createElement("div",{className:K.cardSection},x.createElement("div",{className:K.sectionHeader},X.a.locationCardInformationLabel),x.createElement(H.a,{className:K.icon,iconName:"Poi"}),x.createElement("div",{tabIndex:0,"aria-label":e.displayName,role:"button",className:J(K.linkToBing,K.informationRow),onClick:this.openDirections,onKeyDown:this.onKeyDown},e.displayAddress),x.createElement("div",{className:K.clearFix})),t&&x.createElement("div",{className:K.cardSection},x.createElement("div",{className:K.sectionHeader},X.a.locationCardMapLabel),x.createElement("img",{className:K.linkToBing,src:t,onClick:this.openDirections,onKeyDown:this.onKeyDown})))},t}(x.Component),Y=n(104),Z=n(799);function $(e){var t=e&&e.accessibleText&&e.accessibleText.msColorWhiteBackground||Object(Y.g)().themePrimary,n=e?e.calDarker:Object(Y.g)().themeDarker;return Object(Z.a)({color:t,cursor:"pointer",selectors:{"&:hover":{color:n},"&:focus":{color:n}}})}var ee=function(e){function t(t){var n=e.call(this,t)||this;n.onRenderCompactCard=function(e){return x.createElement(j,{locationPersona:e})};var r=n.props,i=r.postalAddress,o=r.name,s=0;return i&&((i.Street||i.LocationUri&&!a(n.props.postalAddress))&&(s+=110),i.Latitude&&i.Longitude&&(s+=217)),n.state={expandingCardProps:{compactCardHeight:93,expandedCardHeight:s,onRenderCompactCard:n.onRenderCompactCard,onRenderExpandedCard:n.onRenderExpandedCard},locationPersona:U(i,o)},n}return T.__extends(t,e),t.prototype.render=function(){return r(this.props.postalAddress)?x.createElement(L.a,{cardDismissDelay:300,trapFocus:!0,expandingCardProps:T.__assign({renderData:this.state.locationPersona},this.state.expandingCardProps),instantOpenOnClick:!0},x.createElement("span",{className:$(this.props.colorScheme),tabIndex:0},this.props.children)):x.createElement("span",null,this.props.children)},t.prototype.onRenderExpandedCard=function(e){return x.createElement(Q,{locationPersona:e})},t}(x.Component),te=n(1326),ne=n(2342),re=(function(e){function t(t){var n=e.call(this,t)||this;return n.locationPersona=U(t.postalAddress,t.name),n}T.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.target,n=e.onDismiss;return x.createElement(te.a,{isBeakVisible:!1,target:t,onDismiss:n,setInitialFocus:!0},x.createElement("div",{className:ne.container,onMouseLeave:n},x.createElement(j,{locationPersona:this.locationPersona}),x.createElement(Q,{locationPersona:this.locationPersona})))},t=T.__decorate([R.observer],t)}(x.Component),n(2));function ae(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}n.d(t,"m",function(){return oe}),n.d(t,"k",function(){return h}),n.d(t,"i",function(){return f}),n.d(t,"j",function(){return p}),n.d(t,"g",function(){return I}),n.d(t,"f",function(){return O}),n.d(t,"b",function(){return F}),n.d(t,"a",function(){return ee}),n.d(t,"h",function(){return z}),n.d(t,"c",function(){return E}),n.d(t,"l",function(){return $}),n.d(t,"e",function(){return i}),n.d(t,"d",function(){return ae});var ie=new re.c(function(){return n.e(402).then(n.bind(null,7152))}),oe=new re.b(ie,function(e){return e.createTxpPostalAddressFromLocationPersona})},2041:function(e,t,n){"use strict";var r=n(188),a=n(7),i=n(5);n(3853);var o=n(3854);OSF.getLocalizedStringsFilePath=function(){var e=Object(r.a)()+"resources/locale/osfruntime/",t=Object(a.a)().SessionSettings?Object(a.a)().SessionSettings.UserLanguage:"en";return e+(o[t]||"en-us")+"/jscript/"},OSF.getManifestHostType=function(){},OSF.AppTelemetry={enableTelemetry:Object(i.d)("addin-oteljs")}},2065:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1318),a=n(12);function i(e,t,n,i){var c=[],l=0;for(e=e.toLowerCase();c.length<t&&r.a.recipientCache&&l<r.a.recipientCache.length;){var u=r.a.recipientCache[l].EmailAddress;if(o(e,u)){var d=!1;n&&s(u,n)&&(d=!0),i&&i.indexOf(u.MailboxType)>=0&&(d=!0),d||(c.push(r.a.recipientCache[l]),Object(a.k)("RecipientCacheHitIndex",[Math.ceil(l/50)]))}l++}return c}function o(e,t){if(t.EmailAddress&&0==t.EmailAddress.toLowerCase().indexOf(e))return!0;for(var n=t.Name.toLowerCase().split(" "),r=0;r<n.length;r++)if(0==n[r].indexOf(e))return!0;return!1}function s(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}},2076:function(e,t,n){"use strict";n.d(t,"d",function(){return p}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return g}),n.d(t,"e",function(){return h}),n.d(t,"f",function(){return v});var r,a,i=n(2150),o=n(510),s=n.n(o),c=n(1909),l=n(2205),u=n(29),d=n(5);n(2041);function p(){return r}function f(){void 0===r&&(r="Store"+OSF.OUtil.generateConversationId());var e=Object(c.p)(),t=r+"|"+window.location.href.split("?")[0],n=OSF.OUtil.addXdmInfoAsHash(e.InClientStoreUrl,t);n=i.a(n,"client","WAC_Outlook");var o=Date.now();return n=i.a(n,"cv","16.2130.0.9999"),n=i.a(n,"ui",Object(u.f)()),n=i.a(n,"rs",Object(u.f)()),n=i.a(n,"timestamp",o.toString()),n=i.a(n,"ep",function(){if(a)return"il";return"ma"}()),n=i.a(n,"exchver",i.c()),n=i.a(n,"privateenabled",e.CustomExtensionsEnabled.toString()),n=i.a(n,"cb",i.d()),n=i.a(n,"ClientSessionId",i.e()),n=i.a(n,"userPuid","0"),Object(l.d)()&&(n=Object(d.d)("cal-addins")?i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options,Marketplace.Outlook.Pin.Addin.Calendar.Options"):i.a(n,"gates","Marketplace.Outlook.Pin.Addin.Options")),n}function m(){var e=OSF.OUtil.getUniqueId();return Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(e)}function g(){var e=s()();return e.headers.append("X-EWS-TargetVersion","2.80"),delete e.credentials,e}function h(e){return"string"==typeof e?e:["notresponded","notconsented","consented"][e]}var v=function(e){a=e}},2080:function(e,t,n){"use strict";var r=n(1230),a=n(1532),i=n(28),o=n(1515),s=n(20),c=n(11),l=n(4),u=n(89),d=Object(l.action)("localCacheTransactionCompleted")(function(e,t,n,l,d,p){if(void 0===p&&(p=Object(i.ob)()),e&&e.hasSessionStarted){var f={TransactionRequestTime:Object(i.W)(p),TransactionRequestDuration:Object(i.p)(Object(i.ob)(),p),QueryString:Object(s.isStringNullOrWhiteSpace)(t)?"":t,QueryStringLength:Object(o.a)(t)?0:t.length,FeatureData:null!=l?l:void 0,personaTypeList:d,ImpressionId:Object(u.a)()},m=JSON.stringify(f),g=JSON.stringify(n),h=Object(a.a)(e,"","LocalCacheTransactionCompleted",g,0,m);Object(r.a)(e,h,!1),c.c.info(Object(s.format)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),p=n(2180);function f(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(p.a[e.PersonaTypeString])}),d(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return f})},2083:function(e,t,n){"use strict";n.d(t,"a",function(){return v}),n.d(t,"c",function(){return y}),n.d(t,"b",function(){return b});var r=n(188),a=n(139),i=n(186),o=n(2221),s="resources/images/surfaceActions",c=s+"/attach.svg",l=s+"/attachDark.svg",u=s+"/inlineimage.svg",d=s+"/inlineimageDark.svg",p=s+"/emoji.svg",f=s+"/dictate.svg",m=s+"/dictationRecording.svg",g=s+"/showribbon.svg",h=s+"/showribbonDark.svg";function v(e){var t,n,s=!1;switch(e){case"AddAttachment":t=Object(a.resolve)(Object(r.a)(),Object(i.c)()?l:c),n=Object(a.resolve)(Object(r.a)(),c),s=!0;break;case"AddInlineImage":t=Object(a.resolve)(Object(r.a)(),Object(i.c)()?d:u),n=Object(a.resolve)(Object(r.a)(),u),s=!0;break;case"AddEmoji":t=Object(a.resolve)(Object(r.a)(),p),s=!0;break;case"ToggleDictation":t=Object(a.resolve)(Object(r.a)(),Object(o.a)()?m:f),s=!0;break;case"ToggleRibbon":t=Object(a.resolve)(Object(r.a)(),Object(i.c)()?h:g),n=Object(a.resolve)(Object(r.a)(),g),s=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:s}}function y(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function b(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},2119:function(e,t,n){"use strict";var r=n(0),a=n(2065),i=n(4);t.a=Object(i.action)("getAndPopulateSuggestedContacts")(function(e,t){var n=Object(a.a)("",5,t).map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}});e.splice.apply(e,r.__spread([0,e.length],n))})},2125:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"a",function(){return c});var r=n(0),a=n(486);function i(e){return Object(a.a)().taskPanes.get(e)}function o(e){return function(e){var t,n,i=Object(a.a)();try{for(var o=r.__values(i.taskPanes.values()),s=o.next();!s.done;s=o.next()){var c=s.value;if(e(c))return c}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return null}(function(t){return t.controlId===e})}function s(e){var t,n;try{for(var a=r.__values(["Persistent","NonPersistent"]),o=a.next();!o.done;o=a.next()){var s=o.value,c=i(s);if(c&&c.controlId===e)return s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return null}function c(e){return"Persistent"===e?"NonPersistent":"Persistent"}},2129:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.compact=0]="compact",e[e.expanded=1]="expanded"}(r||(r={}))},2133:function(e,t,n){"use strict";var r,a;function i(e,t){var n,r;e&&e((n=t.EventResponseCode,(r={}).Error=n,r))}function o(e,t){(function(e){return void 0!==e.invokeHandlerIfPreviousOnTriggerFailed})(e)&&e.invokeHandlerIfPreviousOnTriggerFailed(t)}!function(e){e[e.DISPLAY_DIALOG_DISPID=10]="DISPLAY_DIALOG_DISPID",e[e.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID=11]="DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID",e[e.ITEM_CHANGED_EVENT_DISPID=46]="ITEM_CHANGED_EVENT_DISPID",e[e.RECIPIENTS_CHANGED_EVENT_DISPID=47]="RECIPIENTS_CHANGED_EVENT_DISPID",e[e.APPOINTMENT_TIME_CHANGED_EVENT_DISPID=48]="APPOINTMENT_TIME_CHANGED_EVENT_DISPID",e[e.RECURRENCE_CHANGED_EVENT=49]="RECURRENCE_CHANGED_EVENT",e[e.ATTACHMENTS_CHANGED_EVENT_DISPID=50]="ATTACHMENTS_CHANGED_EVENT_DISPID",e[e.LOCATIONS_CHANGED_EVENT=51]="LOCATIONS_CHANGED_EVENT"}(r||(r={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.INTERNAL_ERROR=5001]="INTERNAL_ERROR",e[e.URL_NOT_IN_APP_DOMAINS=12004]="URL_NOT_IN_APP_DOMAINS",e[e.WEB_DIALOG_CLOSED=12006]="WEB_DIALOG_CLOSED",e[e.DIALOG_ALREADY_OPEN=12007]="DIALOG_ALREADY_OPEN"}(a||(a={}));var s=a,c="DialogApiEventError",l="ApiEventError";function u(e,t,n){return{EventResponseCode:e,ErrorClassification:t,ErrorDetails:n}}function d(){return u(s.SUCCESS)}function p(e){return e.EventResponseCode===s.SUCCESS}function f(e,t){return d()}function m(e){return d()}function g(e,t){return d()}function h(e){return e}function v(e){return[JSON.stringify(e)]}var y={};function b(e,t){return y[e]&&y[e][t]?y[e][t]:null}function _(e){delete y[e]}function S(e,t){return!!b(e,t)}function C(e,t,n,r){var a=U(e),o=a.onTrigger(n,t);p(o)&&(o=function(e,t,n,r){var a=b(e,t);if(!a)return u(s.INTERNAL_ERROR,l,"HandlerNotRegistered");var i=n.formatArgsForHandler(r);return a(i),d()}(t,e,a,n)),i(r,o)}var A=n(89),I=n(1909);function O(e,t){if(Object(I.F)())return u(s.DIALOG_ALREADY_OPEN,c,s[s.DIALOG_ALREADY_OPEN]);if(!function(e,t){if(t&&1==t.displayInIframe){var n=Object(I.l)(e).extension.AppDomains;return function(e,t){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(e,t)}(n,t.url)}return!0}(e,t))return u(s.URL_NOT_IN_APP_DOMAINS,c,s[s.URL_NOT_IN_APP_DOMAINS]);var n=function(e,t,n){var r=Object(I.u)(e);return t&&1==t.displayInIframe?{controlId:Object(A.a)(),dialogType:1,url:t.url,heightInPercentage:t.height,widthInPercentage:t.width,parentControlId:e,isOpen:n,hostItemIndex:r}:Object(I.L)(e)?{controlId:Object(A.a)(),dialogType:2,parentControlId:e,isOpen:n,hostItemIndex:r}:null}(e,t,!0);return Object(I.M)(n),d()}function T(e){return Object(I.M)(null),C(r.DISPLAY_DIALOG_DISPID,e,null),d()}function x(e,t){return d()}function E(e){return function(e){return null!=e&&void 0!==e.messageToParent}(e)?function(e){var t=e.messageToParent;return{messageType:"0",messageContent:t}}(e):{messageType:s.WEB_DIALOG_CLOSED}}var M=n(12),P=!1,k=null;function R(e,t){return function(e,t){S(t,r.ITEM_CHANGED_EVENT_DISPID)||(P=!0,k={controlId:t,args:e},Object(M.k)("ExtTriggerUnregisteredItemChangedEvent"))}(e,t),d()}function w(e){P&&k.controlId===e&&C(r.ITEM_CHANGED_EVENT_DISPID,e,k.args),P=!1,k=null}function N(e){return[JSON.stringify(e)]}function D(e){return[JSON.stringify(e)]}function F(e){var t={recurrence:JSON.stringify(e.recurrence)};return[JSON.stringify(t)]}function L(e){return[JSON.stringify(e)]}function U(e){switch(e){case r.DISPLAY_DIALOG_DISPID:case r.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:return{register:O,unregister:T,onTrigger:x,formatArgsForHandler:E};case r.ITEM_CHANGED_EVENT_DISPID:return{register:f,unregister:m,onTrigger:R,formatArgsForHandler:h,invokeHandlerIfPreviousOnTriggerFailed:w};case r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:return{register:f,unregister:m,onTrigger:g,formatArgsForHandler:v};case r.RECIPIENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:m,onTrigger:g,formatArgsForHandler:D};case r.RECURRENCE_CHANGED_EVENT:return{register:f,unregister:m,onTrigger:g,formatArgsForHandler:F};case r.LOCATIONS_CHANGED_EVENT:return{register:f,unregister:m,onTrigger:g,formatArgsForHandler:N};case r.ATTACHMENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:m,onTrigger:g,formatArgsForHandler:L};default:throw new Error("ApiEvent not implemented")}}function B(e,t,n){if(Object(I.L)(t.controlId)&&function(e){switch(e){case r.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:case r.DISPLAY_DIALOG_DISPID:return!1;case r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:case r.ITEM_CHANGED_EVENT_DISPID:case r.RECIPIENTS_CHANGED_EVENT_DISPID:case r.RECURRENCE_CHANGED_EVENT:case r.LOCATIONS_CHANGED_EVENT:case r.ATTACHMENTS_CHANGED_EVENT_DISPID:return!0}}(t.eventDispId))i(n,d());else{var a=function(e){return e.targetId?JSON.parse(e.targetId):null}(t),c=U(t.eventDispId),f=c.register(t.controlId,a);p(f)&&(f=function(e,t,n){if(S(e,t))return u(s.INTERNAL_ERROR,l,"ControlAlreadyRegistered");return function(e,t,n){y[e]||(y[e]={}),y[e][t]=n}(e,t,n),d()}(t.controlId,t.eventDispId,e)),i(n,f),o(c,t.controlId)}}function j(e,t){var n=U(e.eventDispId).unregister(e.controlId);p(n)&&(n=function(e,t){if(!S(e,t))return u(s.INTERNAL_ERROR,l,"ControlNotRegistered");return function(e,t){y[e]&&y[e][t]&&delete y[e][t]}(e,t),d()}(e.controlId,e.eventDispId)),i(t,n)}function H(e,t,n){var r=Object(I.m)(e),a=!1,i=null;r.forEach(function(e){S(e,t)&&(a||(a=!0,i=n()),C(t,e,i))})}var V=n(1957),W=n(161);function G(e){var t=Object(I.n)(e),n=Object(V.n)(t);if(null!=n&&n.mode===W.a.AppointmentOrganizer){var a=n;H(t,r.APPOINTMENT_TIME_CHANGED_EVENT_DISPID,function(){return{start:a.getStartTime(),end:a.getEndTime()}})}}var z=n(129);function q(e,t,n){var a=Object(I.n)(e),i=Object(V.n)(a);if(null!=i&&(i.mode===W.a.AppointmentOrganizer||i.mode===W.a.MessageCompose)){var o=null;switch(t){case V.a.Added:o="added";break;case V.a.Deleted:o="removed";break;default:Object(z.a)(t)}var s={attachmentStatus:o,attachmentDetails:n};H(a,r.ATTACHMENTS_CHANGED_EVENT_DISPID,function(){return s})}}function X(e,t){var n=Object(I.n)(e),a=Object(V.n)(n);if(null!=a&&(a.mode===W.a.AppointmentOrganizer||a.mode===W.a.MessageCompose)){var i=null;if(a.mode==W.a.MessageCompose)switch(i={to:!1,cc:!1,bcc:!1},t){case V.c.To:i.to=!0;break;case V.c.Cc:i.cc=!0;break;case V.c.Bcc:i.bcc=!0}else if(a.mode===W.a.AppointmentOrganizer)switch(i={requiredAttendees:!1,optionalAttendees:!1,resources:!1},t){case V.c.RequiredAttendees:i.requiredAttendees=!0;break;case V.c.OptionalAttendees:i.optionalAttendees=!0;break;case V.c.Resources:i.resources=!0}H(n,r.RECIPIENTS_CHANGED_EVENT_DISPID,function(){return i})}}var K=n(2550);function J(e,t){var n=Object(I.n)(e),a=Object(V.n)(n);if(null!=a&&a.mode===W.a.AppointmentOrganizer){var i=Object(K.a)({recurrenceType:t,startTime:a.getStartTime(),endTime:a.getEndTime(),timeZone:a.getTimeZone()});H(n,r.RECURRENCE_CHANGED_EVENT,function(){return{recurrence:i}})}}function Q(e,t){var n=Object(I.n)(e),a=Object(V.n)(n);if(null!=a&&a.mode===W.a.AppointmentOrganizer){var i=t.map(V.h);H(n,r.LOCATIONS_CHANGED_EVENT,function(){return{enhancedLocations:i}})}}n.d(t,"c",function(){return B}),n.d(t,"j",function(){return j}),n.d(t,"d",function(){return C}),n.d(t,"b",function(){return _}),n.d(t,"e",function(){return G}),n.d(t,"f",function(){return q}),n.d(t,"h",function(){return X}),n.d(t,"i",function(){return J}),n.d(t,"g",function(){return Q}),n.d(t,"a",function(){return r})},2150:function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"e",function(){return p}),n.d(t,"f",function(){return f}),n.d(t,"b",function(){return m}),n.d(t,"g",function(){return g});var r,a=n(89),i=n(7),o=n(1909),s=n(2751),c=n(168);function l(){return"x"}function u(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");var r=e.split("#"),a=1==r.length?"":e.substr(e.indexOf("#"));return e=e.indexOf("?")>0?r[0]+"&"+t+"="+n+a:r[0]+"?"+t+"="+n+a}function d(){return Object(c.j)()}function p(){return null==r&&(r=Object(a.a)()),r}function f(){return Object(i.a)().UserOptions.TimeZone}function m(e){var t=encodeURIComponent(e),n=unescape(t);return btoa(n)}function g(){Object(o.R)(!0),Object(s.a)()}n(139)},2151:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(2),a=new r.c(function(){return Promise.all([n.e(0),n.e(107)]).then(n.bind(null,2694))}),i=new r.a(a,function(e){return e.mountAndShowFlexPane}),o=new r.a(a,function(e){return e.hideFlexPane})},2180:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},2181:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}n.d(t,"a",function(){return r})},2182:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2181);function a(e,t){return Object(r.a)(e)?e.recipients:t||[]}},2183:function(e,t,n){"use strict";var r=n(1230),a=n(1235),i=n(20),o=n(11),s=n(4);t.a=Object(s.action)("pauseSession")(function(e){if(e&&e.hasSessionStarted&&!e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionPaused",recipientEmailAddresses:null,endSessionAction:null});Object(r.a)(e,t,!1),e.isSessionPaused=!0,o.c.info(Object(i.format)("{0} pauseSession : Session paused. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},2184:function(e,t,n){"use strict";var r=n(1230),a=n(1235),i=n(20),o=n(11),s=n(4);t.a=Object(s.action)("resumeSession")(function(e){if(e&&e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionResumed",recipientEmailAddresses:null,endSessionAction:null});Object(r.a)(e,t,!1),e.isSessionPaused=!1,o.c.info(Object(i.format)("{0} FeedbackManagerBase.ResumeSession: Session resumed. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},2205:function(e,t,n){"use strict";var r=n(5);function a(){return Object(r.d)("addin-inClientStoreEnabled")}function i(){return Object(r.d)("addin-inClientStorePinnableExperience")}function o(){return Object(r.d)("addin-persistentTaskPane")}function s(){return Object(r.d)("addin-complianceVerification")}n.d(t,"b",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return s})},2221:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=!1;function a(){return r}function i(){r=!r}},223:function(e,t,n){"use strict";var r=n(1252),a=n(4),i=Object(a.action)("addInfoBarMessageInCompose")(function(e,t,n){Object(r.a)(e,t,e.composeId,n)});t.a=i},224:function(e,t,n){"use strict";var r=n(223),a=n(278);n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s});var i=function(e){return function(t,n){Object(r.a)(e,t,n)}},o=function(e){return function(t){Object(a.a)(e,t)}},s=function(e){return function(){return function(e){return e.infoBarIds}(e)}}},2253:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(0),a=n(3),i=n(126),o=n(1326),s=n(78),c=n(2456),l=function(e){var t=e.gapSpace,n=void 0===t?0:t,l=e.directionalHint,u=void 0===l?s.DirectionalHint.bottomLeftEdge:l,d=e.directionalHintFixed,p=e.targetElement,f=e.firstFocus,m=e.trapFocus,g=e.onLeave,h=e.className,v=e.finalHeight,y=e.content,b=r.__assign({},Object(i.f)(e,i.e),{className:h,target:p,isBeakVisible:!1,directionalHint:u,directionalHintFixed:d,finalHeight:v,minPagePadding:24,onDismiss:g,gapSpace:n});return a.createElement(a.Fragment,null,m?a.createElement(c.a,r.__assign({},b,{focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!f}}),y):a.createElement(o.a,r.__assign({},b),y))}},2260:function(e,t,n){"use strict";var r=n(2),a=n(2442);function i(e){return a.a.addinOptionSurfaceItems[e]}var o=n(47),s=n(8),c=n.n(s),l=n(20),u=n(2221);function d(e){switch(e){case"AddAttachment":return c.a.attachTooltip;case"AddInlineImage":return c.a.insertPicturesInlineTooltip;case"AddEmoji":return c.a.emojiTooltip;case"ToggleDictation":return Object(u.a)()?c.a.startDictationTooltip:c.a.stopDictationTooltip;case"ToggleRibbon":return c.a.formattingOptionsTooltip;case"SaveDraft":return c.a.saveDraft;case"InsertSignature":return c.a.insertSignature;case"ShowFrom":return c.a.showFrom;case"SetImportance":return c.a.setImportance;case"ShowMessageOptions":return c.a.showMessageOptions;case"SwitchBodyType":return c.a.switchToPlainTextMenuItem;case"SensitivityMenu":return c.a.sensitivityMenuText;case"ProtectMessage":return c.a.composeProtectButton;case"AccChecker":return c.a.accCheckerMenuItemText;default:return""}}function p(e){switch(e){case"LikeUnlike":return c.a.itemHeaderLike;case"Reply":return c.a.itemHeaderReply;case"ReplyAll":return c.a.itemHeaderReplyAll;case"Forward":return c.a.itemHeaderForward;case"ReplyByMeeting":return c.a.itemHeaderReplyByMeeting;case"ReportAbuse":return c.a.reportAbuse;case"Popout":return c.a.popoutsOpenInNewWindow;case"Delete":return c.a.itemHeaderDelete;case"MarkReadUnread":return c.a.markAsUnread;case"FlagUnflag":return c.a.itemHeaderFlag;case"AssignPolicy":return c.a.assignPolicyMenuItemName;case"AddToSafeSenders":return c.a.itemHeaderAddToSafeSenders;case"MarkJunkNotJunk":return c.a.itemHeaderMarkAsJunk;case"MarkAsPhishing":return c.a.itemHeaderMarkAsPhishing;case"Block":return Object(l.format)(c.a.itemHeaderBlock,"");case"CreateRule":return c.a.createRule;case"Print":return c.a.itemHeaderPrint;case"Translate":return c.a.itemHeaderTranslate;case"ShowInImmersiveReader":return c.a.showInImmersiveReader;case"ViewMessageSource":return Object(o.a)()?c.a.itemHeaderViewMessageSource:c.a.itemHeaderViewMessageDetails;case"ToggleDarkMode":return c.a.itemHeaderLightsOn;default:return""}}function f(e){switch(e){case"None":return c.a.none;case"Delete":return c.a.deleteItem;case"Archive":return c.a.archive;case"PinUnpin":return c.a.pin;case"ReadUnread":return c.a.readUnread;case"FlagUnflag":return c.a.flag;case"Move":return c.a.moveToFolder;default:return""}}var m=n(2083),g=n(2441),h=n(833),v=n(5),y=n(217),b=n(7),_=n(186);function S(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return Object(v.d)("rp-replyByMeeting")&&e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(b.a)().SessionSettings.IsShadowMailbox||e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0},{key:"ReportAbuse",hideInGroup:!Object(o.a)(),hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),!Object(o.a)()&&Object(v.d)("tri-retentionPolicies")&&e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0},{key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(v.d)("gsx-translator-translateMessage")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(_.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(v.d)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),Object(v.d)("rp-popouts")&&e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(v.d)("rp-like")&&!Object(o.a)()&&e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),e}function C(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return e.push({key:"AddEmoji",hideInGroup:!1}),Object(v.d)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1}]),Object(v.d)("cmp-clp")&&!Object(o.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(h.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(g.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e.push({key:"SwitchBodyType",hideInGroup:!1}),Object(v.d)("cmp-accChecker")&&e.push({key:"AccChecker",hideInGroup:!1}),e}function A(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function I(e){return-1!==Object(y.c)(y.a.SurfaceActions).readSurfaceActions.indexOf(e)}var O=n(12);function T(e,t,n,r){var a;r?a=r:(a="Pinned",n&&n.renderedInOverflow&&(a=n.isPinned?"Overflow":"NotPinned")),Object(O.k)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,a])}function x(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0})}function E(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!1})}n.d(t,"j",function(){return P}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return p}),n.d(t,"f",function(){return f}),n.d(t,"a",function(){return"-"}),n.d(t,"d",function(){return m.a}),n.d(t,"h",function(){return m.c}),n.d(t,"e",function(){return C}),n.d(t,"i",function(){return S}),n.d(t,"o",function(){return A}),n.d(t,"n",function(){return I}),n.d(t,"k",function(){return T}),n.d(t,"m",function(){return x}),n.d(t,"l",function(){return E});var M=new r.c(function(){return n.e(237).then(n.bind(null,7180))}),P=new r.a(M,function(e){return e.setAddinOptionSurfaceItems})},2336:function(e,t,n){"use strict";n.d(t,"a",function(){return v});var r=n(0),a=n(3),i=n(237),o=n(1333),s=n(98),c=n(245),l=n(126),u=n(144),d=n(128),p=n(2337),f=n(2352),m=n(2129),g=n(2351),h=Object(i.a)(),v=function(e){function t(t){var n=e.call(this,t)||this;return n._hoverCard=Object(o.a)(),n.dismiss=function(e){n._async.clearTimeout(n._openTimerId),n._async.clearTimeout(n._dismissTimerId),e?n._dismissTimerId=n._async.setTimeout(function(){n._setDismissedState()},n.props.cardDismissDelay):n._setDismissedState()},n._cardOpen=function(e){n._shouldBlockHoverCard()||"keydown"===e.type&&e.which!==n.props.openHotKey||(n._async.clearTimeout(n._dismissTimerId),"mouseenter"===e.type&&(n._currentMouseTarget=e.currentTarget),n._executeCardOpen(e))},n._executeCardOpen=function(e){n._async.clearTimeout(n._openTimerId),n._openTimerId=n._async.setTimeout(function(){n.setState(function(t){return t.isHoverCardVisible?t:{isHoverCardVisible:!0,mode:m.a.compact,openMode:"keydown"===e.type?p.b.hotKey:p.b.hover}})},n.props.cardOpenDelay)},n._cardDismiss=function(e,t){if(e){if(!(t instanceof MouseEvent))return;if("keydown"===t.type&&t.which!==s.a.escape)return;n.props.sticky||n._currentMouseTarget!==t.currentTarget&&t.which!==s.a.escape||n.dismiss(!0)}else{if(n.props.sticky&&!(t instanceof MouseEvent)&&t.nativeEvent instanceof MouseEvent&&"mouseleave"===t.type)return;n.dismiss(!0)}},n._setDismissedState=function(){n.setState({isHoverCardVisible:!1,mode:m.a.compact,openMode:p.b.hover})},n._instantOpenAsExpanded=function(e){n._async.clearTimeout(n._dismissTimerId),n.setState(function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:m.a.expanded}})},n._setEventListeners=function(){var e=n.props,t=e.trapFocus,r=e.instantOpenOnClick,a=n._getTargetElement(),i=n._nativeDismissEvent;n._events.on(a,"mouseenter",n._cardOpen),n._events.on(a,"mouseleave",i),t?n._events.on(a,"keydown",n._cardOpen):(n._events.on(a,"focus",n._cardOpen),n._events.on(a,"blur",i)),r?n._events.on(a,"click",n._instantOpenAsExpanded):(n._events.on(a,"mousedown",i),n._events.on(a,"keydown",i))},n._nativeDismissEvent=n._cardDismiss.bind(n,!0),n._childDismissEvent=n._cardDismiss.bind(n,!1),n.state={isHoverCardVisible:!1,mode:m.a.compact,openMode:p.b.hover},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){this._setEventListeners()},t.prototype.componentDidUpdate=function(e,t){var n=this;e.target!==this.props.target&&(this._events.off(),this._setEventListeners()),t.isHoverCardVisible!==this.state.isHoverCardVisible&&(this.state.isHoverCardVisible?(this._async.setTimeout(function(){n.setState({mode:m.a.expanded},function(){n.props.onCardExpand&&n.props.onCardExpand()})},this.props.expandedCardOpenDelay),this.props.onCardVisible&&this.props.onCardVisible()):(this.setState({mode:m.a.compact}),this.props.onCardHide&&this.props.onCardHide()))},t.prototype.render=function(){var e=this.props,t=e.expandingCardProps,n=e.children,i=e.id,o=e.setAriaDescribedBy,s=void 0===o||o,u=e.styles,d=e.theme,m=e.className,v=e.type,y=e.plainCardProps,b=e.trapFocus,_=e.setInitialFocus,S=this.state,C=S.isHoverCardVisible,A=S.mode,I=S.openMode,O=i||Object(c.getId)("hoverCard");this._classNames=h(u,{theme:d,className:m});var T=r.__assign({},Object(l.f)(this.props,l.e),{id:O,trapFocus:!!b,firstFocus:_||I===p.b.hotKey,targetElement:this._getTargetElement(),onEnter:this._cardOpen,onLeave:this._childDismissEvent}),x=r.__assign({},t,T,{mode:A}),E=r.__assign({},y,T);return a.createElement("div",{className:this._classNames.host,ref:this._hoverCard,"aria-describedby":s&&C?O:void 0,"data-is-focusable":!Boolean(this.props.target)},n,C&&(v===p.a.expanding?a.createElement(f.a,r.__assign({},x)):a.createElement(g.a,r.__assign({},E))))},t.prototype._getTargetElement=function(){var e=this.props.target;switch(typeof e){case"string":return Object(u.a)().querySelector(e);case"object":return e;default:return this._hoverCard.current||void 0}},t.prototype._shouldBlockHoverCard=function(){return!(!this.props.shouldBlockHoverCard||!this.props.shouldBlockHoverCard())},t.defaultProps={cardOpenDelay:500,cardDismissDelay:100,expandedCardOpenDelay:1500,instantOpenOnClick:!1,setInitialFocus:!1,openHotKey:s.a.c,type:p.a.expanding},t}(d.a)},2337:function(e,t,n){"use strict";var r,a;n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a}),function(e){e[e.hover=0]="hover",e[e.hotKey=1]="hotKey"}(r||(r={})),function(e){e.plain="PlainCard",e.expanding="ExpandingCard"}(a||(a={}))},2338:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var r=n(0),a=n(3),i=n(237),o=n(98),s=n(128),c=n(2129),l=n(2253),u=Object(i.a)(),d=function(e){function t(t){var n=e.call(this,t)||this;return n._expandedElem=a.createRef(),n._onKeyDown=function(e){e.which===o.a.escape&&n.props.onLeave&&n.props.onLeave(e)},n._onRenderCompactCard=function(){return a.createElement("div",{className:n._classNames.compactCard},n.props.onRenderCompactCard(n.props.renderData))},n._onRenderExpandedCard=function(){return!n.state.firstFrameRendered&&n._async.requestAnimationFrame(function(){n.setState({firstFrameRendered:!0})}),a.createElement("div",{className:n._classNames.expandedCard,ref:n._expandedElem},a.createElement("div",{className:n._classNames.expandedCardScroll},n.props.onRenderExpandedCard&&n.props.onRenderExpandedCard(n.props.renderData)))},n._checkNeedsScroll=function(){var e=n.props.expandedCardHeight;n._async.requestAnimationFrame(function(){n._expandedElem.current&&n._expandedElem.current.scrollHeight>=e&&n.setState({needsScroll:!0})})},n.state={firstFrameRendered:!1,needsScroll:!1},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){this._checkNeedsScroll()},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=this.props,t=e.styles,n=e.compactCardHeight,i=e.expandedCardHeight,o=e.theme,s=e.mode,d=e.className,p=this.state,f=p.needsScroll,m=p.firstFrameRendered,g=n+i;this._classNames=u(t,{theme:o,compactCardHeight:n,className:d,expandedCardHeight:i,needsScroll:f,expandedCardFirstFrameRendered:s===c.a.expanded&&m});var h=a.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this._onRenderCompactCard(),this._onRenderExpandedCard());return a.createElement(l.a,r.__assign({},this.props,{content:h,finalHeight:g,className:this._classNames.root}))},t.defaultProps={compactCardHeight:156,expandedCardHeight:384,directionalHintFixed:!0},t}(s.a)},2339:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),a=n(3),i=n(237),o=n(98),s=n(128),c=n(2253),l=Object(i.a)(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeyDown=function(e){e.which===o.a.escape&&t.props.onLeave&&t.props.onLeave(e)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme,i=e.className;this._classNames=l(t,{theme:n,className:i});var o=a.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this.props.onRenderPlainCard(this.props.renderData));return a.createElement(c.a,r.__assign({},this.props,{content:o,className:this._classNames.root}))},t}(s.a)},2342:function(e,t,n){var r=n(2989),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},2351:function(e,t,n){"use strict";var r=n(859),a=n(18),i={root:"ms-PlainCard-root"};var o=n(2339);n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t,n=e.theme,r=e.className;return{root:[Object(a.getGlobalClassNames)(i,n).root,{pointerEvents:"auto",boxShadow:"0 0 20px rgba(0, 0, 0, .2)",border:"none",selectors:(t={},t[a.HighContrastSelector]={border:"1px solid WindowText"},t)},r]}},void 0,{scope:"PlainCard"})},2352:function(e,t,n){"use strict";var r=n(859),a=n(18),i={root:"ms-ExpandingCard-root",compactCard:"ms-ExpandingCard-compactCard",expandedCard:"ms-ExpandingCard-expandedCard",expandedCardScroll:"ms-ExpandingCard-expandedCardScrollRegion"};var o=n(2338);n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t,n=e.theme,r=e.needsScroll,o=e.expandedCardFirstFrameRendered,s=e.compactCardHeight,c=e.expandedCardHeight,l=e.className,u=n.palette,d=Object(a.getGlobalClassNames)(i,n);return{root:[d.root,{width:"340px",pointerEvents:"none",boxShadow:"0 0 20px rgba(0, 0, 0, .2)",border:"none",selectors:(t={},t[a.HighContrastSelector]={border:"1px solid WindowText"},t)},l],compactCard:[d.compactCard,{pointerEvents:"auto",position:"relative",height:s}],expandedCard:[d.expandedCard,{height:"1px",overflowY:"hidden",pointerEvents:"auto",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)",selectors:{":before":{content:'""',position:"relative",display:"block",top:"0",left:"24px",width:"292px",height:"1px",backgroundColor:u.neutralLighter}}},o&&{height:c}],expandedCardScroll:[d.expandedCardScroll,r&&{height:"100%",boxSizing:"border-box",overflowY:"auto"}]}},void 0,{scope:"ExpandingCard"})},2385:function(e,t,n){"use strict";var r=n(3520),a=n(2644);function i(e){var t=Object(r.a)(e);return Object(a.a)()[t]}var o=n(2645);function s(e){return e.isActionable&&e.control.Action.SupportsPersistence}var c=n(0),l=n(161),u=n(2205),d=n(20),p=n(3501),f=!1;function m(e){return c.__awaiter(this,void 0,void 0,function(){var t,n;return c.__generator(this,function(r){switch(r.label){case 0:return Object(u.c)()?e===l.a.AppointmentAttendee||e===l.a.AppointmentOrganizer?[2]:f?[3,2]:[4,Object(p.a)()]:[2];case 1:t=r.sent(),(n=JSON.parse(t)).addins&&(f=!0,n.addins.forEach(function(e){if(function(e){return!Object(d.isStringNullOrWhiteSpace)(e.mode)&&!Object(d.isStringNullOrWhiteSpace)(e.addinId)&&!Object(d.isStringNullOrWhiteSpace)(e.commandId)}(e)){var t={addinId:e.addinId,commandId:e.commandId};Object(a.a)()[e.mode]=t}})),r.label=2;case 2:return[2]}})})}function g(){return f}function h(e){return{addinId:e.extension.Id,commandId:e.control.Id}}var v=n(1909);function y(e){for(var t=Object.keys(Object(a.a)()),n=0;n<t.length;n++){var r=t[n],i=Object(a.a)()[r];i&&e.indexOf(i.addinId)<0&&(Object(o.b)(r,null),Object(v.X)(i.addinId))}}var b=function(e){var t=i(l.a.MessageRead),n=i(l.a.MessageCompose);return!!(t&&e.extension.Id===t.addinId&&e.get_Id().indexOf(t.commandId)>=0)||!!(n&&e.extension.Id===n.addinId&&e.get_Id().indexOf(n.commandId)>=0)};n.d(t,"c",function(){return i}),n.d(t,"h",function(){return o.a}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return m}),n.d(t,"e",function(){return g}),n.d(t,"b",function(){return h}),n.d(t,"g",function(){return y}),n.d(t,"d",function(){return b})},240:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),a=n(2);function i(e,t,n,i,o){return function(){function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onImportedCallbacks=[],this.args=e,this.pluginName=n}return s.prototype.initialize=function(e){this.editor=e,this.pluginInstance?this.initializeAndCallback():i||this.internalImport()},s.prototype.dispose=function(){this.pluginInstance&&(this.pluginInstance.dispose(),o||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]},s.prototype.getName=function(){return this.pluginName},s.prototype.setPluginUtils=function(e){if(this.pluginUtils=e,this.pluginInstance){var t=this.pluginInstance;t.setPluginUtils&&t.setPluginUtils(this.pluginUtils)}},s.prototype.onPluginEvent=function(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):i&&i(e,this.editor)&&this.internalImport(e)},s.prototype.willHandleEventExclusively=function(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)},s.prototype.getPlugin=function(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()},s.prototype.isImported=function(){return!!this.pluginInstance},s.prototype.addOnImportedCallback=function(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)},s.prototype.initializeAndCallback=function(){var e=this;this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach(function(t){return t(e.pluginInstance)})},s.prototype.internalImport=function(n){var i=this;return this.importPluginPromise||(this.importPluginPromise=new a.b(e,t).import().then(function(e){i.pluginInstance=new(e.bind.apply(e,r.__spread([void 0],i.args))),i.pluginName=i.pluginInstance.getName&&i.pluginInstance.getName()||i.pluginName;var t=i.pluginInstance;return t.setPluginUtils&&t.setPluginUtils(i.pluginUtils),i.editor&&(i.initializeAndCallback(),n&&i.pluginInstance.onPluginEvent(n)),i.pluginInstance})),this.importPluginPromise},s}()}},2441:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5),a=n(29);function i(){return!Object(a.m)()&&(Object(r.d)("cmp-requestReadReceipts")||Object(r.d)("cmp-requestDeliveryReceipts")||Object(r.d)("cmp-setMessageSensitivity")||Object(r.d)("cmp-smime"))}},2442:function(e,t,n){"use strict";var r=n(1),a=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=a},2456:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),a=n(3),i=n(1326),o=n(1731),s=function(e){return a.createElement(i.a,r.__assign({},e),a.createElement(o.a,r.__assign({},e.focusTrapProps),e.children))}},2517:function(e,t,n){"use strict";n.d(t,"h",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"g",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return p});var r=n(0),a=n(1909);function i(e){return s(e)?c(e).isMenu:e.AddinCommands.size>1}function o(e){return!!s(e)&&c(e).isActionable}function s(e){return 1==e.AddinCommands.size}function c(e){return e.AddinCommands.size>0?r.__spread(e.AddinCommands.values())[0]:null}function l(e){return s(e)?c(e).control.Supertip.Title:""}function u(e){var t=e.DisplayName;s(e)&&(t+=" - "+c(e).control.Supertip.Title);return t}function d(e,t,n){var i,o,s,c;try{for(var l=r.__values(a.i.EnabledAddinCommands.getExtensionPoint(n)),u=l.next();!u.done;u=l.next()){var d=u.value;if(d.Id==e&&d.AddinCommands.size>0)try{for(var p=r.__values(d.AddinCommands.values()),f=p.next();!f.done;f=p.next()){var m=f.value;if(m.control.Id==t)return m}}catch(e){s={error:e}}finally{try{f&&!f.done&&(c=p.return)&&c.call(p)}finally{if(s)throw s.error}}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return null}function p(e){return a.i.compliance.isMinor&&(!function(e){return"Default"===e.TypeString}(t=e.extension)&&!function(e){return"Organization"===e.OriginString}(t)&&!function(e){return"Private"===e.TypeString}(t));var t}},2550:function(e,t,n){"use strict";var r,a=n(0),i=n(120),o=60,s=6e4;function c(e){var t=e.split("-");return{year:parseInt(t[0]),month:parseInt(t[1]),day:parseInt(t[2])}}!function(e){e.Monday="mon",e.Tuesday="tue",e.Wednesday="wed",e.Thursday="thu",e.Friday="fri",e.Saturday="sat",e.Sunday="sun",e.Weekday="weekday",e.WeekendDay="weekendDay",e.Days="day",e.None=""}(r||(r={}));var l="Monday",u="Tuesday",d="Wednesday",p="Thursday",f="Friday",m="Saturday",g="Sunday",h=[l,u,d,p,f].join(" "),v=[m,g].join(" "),y=[h,v].join(" ");function b(e){switch(e){case"mon":return l;case"tue":return u;case"wed":return d;case"thu":return p;case"fri":return f;case"sat":return m;case"sun":return g;case"weekday":return h;case"weekendDay":return v;case"day":return y}return""}function _(e){switch(e){case l:return"mon";case u:return"tue";case d:return"wed";case p:return"thu";case f:return"fri";case m:return"sat";case g:return"sun";case h:return"weekday";case v:return"weekendDay";case y:return"day"}return""}var S;!function(e){e.January="jan",e.February="feb",e.March="mar",e.April="apr",e.May="may",e.June="jun",e.July="jul",e.August="aug",e.September="sep",e.October="oct",e.November="nov",e.December="dec",e.None=""}(S||(S={}));var C="January",A="February",I="March",O="April",T="May",x="June",E="July",M="August",P="September",k="October",R="November",w="December";function N(e){switch(e){case"jan":return C;case"feb":return A;case"mar":return I;case"apr":return O;case"may":return T;case"jun":return x;case"jul":return E;case"aug":return M;case"sep":return P;case"oct":return k;case"nov":return R;case"dec":return w}return""}function D(e){switch(e){case C:return"jan";case A:return"feb";case I:return"mar";case O:return"apr";case T:return"may";case x:return"jun";case E:return"jul";case M:return"aug";case P:return"sep";case k:return"oct";case R:return"nov";case w:return"dec"}return""}var F;!function(e){e.First="first",e.Second="second",e.Third="third",e.Fourth="fourth",e.Last="last",e.None=""}(F||(F={}));var L="First",U="Second",B="Third",j="Fourth",H="Last";function V(e){switch(e){case"first":return L;case"second":return U;case"third":return B;case"fourth":return j;case"last":return H}return""}function W(e){switch(e){case L:return"first";case U:return"second";case B:return"third";case j:return"fourth";case H:return"last"}return""}function G(e){if(null==e.recurrenceType)return null;var t=function(e){var t=e.startTime,n=e.endTime,r=e.recurrenceType,l=e.timeZone,u=c(r.RecurrenceRange.StartDate),d=(n.getTime()-t.getTime())/s,p=t.getUTCHours()*o+t.getUTCMinutes()+Object(i.f)(t,l),f={startYear:u.year,startMonth:u.month,startDay:u.day,startTimeMin:p,durationMin:d};if(r.RecurrenceRange.EndDate){var m=c(r.RecurrenceRange.EndDate);f=a.__assign({},f,{endDay:m.day,endMonth:m.month,endYear:m.year})}else f.noEndDate=!0;return f}(e),n={name:e.timeZone,offset:Object(i.f)(e.startTime,e.timeZone)},r=e.recurrenceType.RecurrencePattern;switch(r.__type){case"DailyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval},recurrenceType:"daily",seriesTimeJson:t,recurrenceTimeZone:n}}(r,t,n);case"WeeklyRecurrence:#Exchange":return function(e,t,n){if(1===e.Interval&&"weekday"===_(e.DaysOfWeek))return{recurrenceProperties:void 0,recurrenceType:"weekday",seriesTimeJson:t,recurrenceTimeZone:n};return{recurrenceProperties:{interval:e.Interval,days:e.DaysOfWeek.split(" ").map(_),firstDayOfWeek:_(e.FirstDayOfWeek)},recurrenceType:"weekly",seriesTimeJson:t,recurrenceTimeZone:n}}(r,t,n);case"AbsoluteMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfMonth:e.DayOfMonth},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(r,t,n);case"RelativeMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfWeek:_(e.DaysOfWeek),weekNumber:W(e.DayOfWeekIndex)},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(r,t,n);case"AbsoluteYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfMonth:e.DayOfMonth,month:D(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(r,t,n);case"RelativeYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfWeek:_(e.DaysOfWeek),weekNumber:W(e.DayOfWeekIndex),month:D(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(r,t,n)}return null}var z=60;function q(e,t,n,r){var a=Math.floor(r/z);return r-=a*z,new Date(Date.UTC(e,t-1,n,a,r))}function X(e,t){switch(e){case"daily":return function(e){return{__type:"DailyRecurrence:#Exchange",Interval:e.interval}}(t);case"weekday":return{__type:"WeeklyRecurrence:#Exchange",Interval:1,FirstDayOfWeek:"Monday",DaysOfWeek:"Monday Tuesday Wednesday Thursday Friday"};case"weekly":return function(e){return{__type:"WeeklyRecurrence:#Exchange",Interval:e.interval,FirstDayOfWeek:b(e.firstDayOfWeek),DaysOfWeek:e.days.map(b).join(" ")}}(t);case"monthly":return function(e){return e.dayOfMonth?{__type:"AbsoluteMonthlyRecurrence:#Exchange",DayOfMonth:e.dayOfMonth,Interval:e.interval}:{__type:"RelativeMonthlyRecurrence:#Exchange",Interval:e.interval,DaysOfWeek:b(e.dayOfWeek),DayOfWeekIndex:V(e.weekNumber)}}(t);case"yearly":return function(e){return e.dayOfMonth?{__type:"AbsoluteYearlyRecurrence:#Exchange",Month:N(e.month),DayOfMonth:e.dayOfMonth}:{__type:"RelativeYearlyRecurrence:#Exchange",Month:N(e.month),DaysOfWeek:b(e.dayOfWeek),DayOfWeekIndex:V(e.weekNumber)}}(t);default:return null}}function K(e,t,n){return e+"-"+J(t)+"-"+J(n)}function J(e){return e<10?"0"+e:""+e}function Q(e){if(null==e)return null;var t,n,r=e.seriesTimeJson,a=e.recurrenceProperties,i=e.recurrenceType,o=r.startDay,s=r.startMonth,c=r.startYear,l=r.startTimeMin,u=r.durationMin;return{recurrenceType:{__type:"RecurrenceType:#Exchange",RecurrenceRange:(t=r,n=K(t.startYear,t.startMonth,t.startDay),t.noEndDate?{__type:"NoEndRecurrence:#Exchange",StartDate:n}:{__type:"EndDateRecurrence:#Exchange",StartDate:n,EndDate:K(t.endYear,t.endMonth,t.endDay)}),RecurrencePattern:X(i,a)},startTime:q(c,s,o,l),endTime:q(c,s,o,l+u)}}function Y(e,t,n){return e>=1601&&t>=1&&t<=12&&n>=1&&n<=31}function Z(e,t,n){var r=new Date;return r.setFullYear(e),r.setMonth(t-1),r.setDate(n),r}function $(e){return null==e||!!e.recurrenceType&&(!(!e.seriesTimeJson||!function(e){if(!e)return!1;if(!Y(e.startYear,e.startMonth,e.startDay))return!1;if(!e.noEndDate){if(!Y(e.endYear,e.endMonth,e.endDay))return!1;if(Z(e.startYear,e.startMonth,e.startDay)>=Z(e.endYear,e.endMonth,e.endDay))return!1}return!(e.startTimeMin<0||e.durationMin<0)}(e.seriesTimeJson))&&!!function(e,t){switch(e){case"daily":return!!(n=t)&&!(!n.interval||n.interval<1);case"weekly":return function(e){return!!e&&(!(!e.interval||e.interval<1)&&(!(!e.days||e.days.length<1)&&!!e.firstDayOfWeek))}(t);case"monthly":return function(e){return!!e&&(!(!e.interval||e.interval<1)&&(!(!e.dayOfMonth||e.dayOfWeek||e.weekNumber)||!(!e.dayOfWeek||!e.weekNumber||e.dayOfMonth)))}(t);case"yearly":return function(e){return!!e&&(!(!e.interval||e.interval<1)&&(!!e.month&&(!(!e.dayOfMonth||e.dayOfWeek||e.weekNumber)||!(!e.dayOfWeek||!e.weekNumber||e.dayOfMonth))))}(t);case"weekday":return!t}var n}(e.recurrenceType,e.recurrenceProperties))}n.d(t,"a",function(){return G}),n.d(t,"b",function(){return Q}),n.d(t,"c",function(){return $})},2552:function(e,t,n){"use strict";var r=n(0),a=n(2050),i=n.n(a);var o=function(e){return function(){window.open(e.extension.EndNodeUrl)}};function s(e){switch(e){case 0:case 3:case 1:return 2;case 2:default:return 0}}var c=n(188),l=n(29),u={sets:[{name:"mailbox",maxVersion:"1.7"},{name:"DialogAPI"},{name:"react"}]},d="16.01",p=["progress.gif","agavedefaulticon96x96.png","moe_status_icons.png"],f=["moeerrorux.css"],m="resources/images/osfruntime/",g="resources/styles/osfruntime/";function h(e,t,n){t.getLocalizedCSSFilePath=v(f,Object(c.a)()+g),t.getLocalizedImageFilePath=v(p,Object(c.a)()+m),t._notifyHostError=t._notifyHost,t._hostType="Outlook",t._hostPlatform="Web",t._hostSpecificFileVersion=d,t.getRequirementsChecker().setRequirements(u)}function v(e,t){return function(n){var r=e.filter(function(e){return n==e})[0];return(r=function(e){if(!Object(l.n)())return e;switch(e){case"moeerrorux.css":return"moerroruxrtl.css";default:return e}}(r))?t+r:""}}n(2041);var y=n(1957),b=n(1909),_=n(2133),S=function(e){return function(t,n){if(t){var r=t.ApiParams,a=E(t.MethodData.ControlId),i=t.MethodData.DispatchId;Object(y.m)(e,i,a,r,n)}}},C=function(e,t,n){Object(_.c)(e,n,t)},A=function(e,t,n){n.controlId=E(n.controlId),n.eventDispId=function(e){if(e==_.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID)return _.a.DISPLAY_DIALOG_DISPID;return e}(n.eventDispId),Object(_.j)(n,t)},I=[{name:"GetInitialData",isBlocking:!0,action:S},{name:"executeMethod",isBlocking:!1,action:function(e){return function(t,n){if(t){var r=E(t.DdaMethod.ControlId),a=t.DdaMethod.DispatchId;Object(y.m)(e,a,r,t,n)}}}},{name:"ExecuteMethod",isBlocking:!1,action:S}];function O(e){return[{name:"appCommandInvoked",registerAction:OfficeExt.AddinCommandsRuntimeManager.registerEvent,unregisterAction:OfficeExt.AddinCommandsRuntimeManager.unregisterEvent},{name:"dialogMessageReceived",registerAction:C,unregisterAction:A},{name:"dialogNotificationShown",registerAction:C,unregisterAction:A},{name:"olkItemSelectedChanged",registerAction:C,unregisterAction:A},{name:"olkAppointmentTimeChanged",registerAction:C,unregisterAction:A},{name:"olkRecipientsChanged",registerAction:C,unregisterAction:A},{name:"olkRecurrenceChanged",registerAction:C,unregisterAction:A},{name:"olkEnhancedLocationsChanged",registerAction:C,unregisterAction:A},{name:"olkAttachmentsChanged",registerAction:C,unregisterAction:A}]}function T(e,t){I.forEach(function(n){t.registerMethod(n.name,n.action(e),Microsoft.Office.Common.InvokeType.async,n.isBlocking)}),O().forEach(function(e){t.registerEventEx(e.name,e.registerAction,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,e.unregisterAction,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent)})}function x(e,t){I.forEach(function(e){return t.unregisterMethod(e.name)}),O().forEach(function(e){return t.unregisterEvent(e.name)})}function E(e){var t=Object(b.q)().activeDialog;return t&&t.controlId===e?t.parentControlId:e}var M=n(168),P=n(5);function k(e,t,n){var r=t.addinCommand,a=t.controlId,i=t.isDialog,o=r.extension.Settings?JSON.parse(r.extension.Settings):{},s=function(e,t){var n=Object(y.n)(t);return JSON.stringify({userType:Object(y.q)(),userId:Object(M.c)(),extensionType:e.extension.TypeString,module:Object(M.a)(),deployment:Object(M.h)(),scenario:Object(b.w)(t),clientVersion:Object(M.d)(),isPinned:n.isAddinPinned(e.extension.Id),react:!0,disableLogging:!1})}(r,e);return{div:n,id:a,marketplaceID:i?a:r.extension.Id,marketplaceVersion:r.extension.Version,settings:o,store:"",storeType:OSF.StoreType.Exchange,hostCustomMessage:Object(P.d)("addin-oteljs")?void 0:s,isDialog:i,isVirtualOsfControl:!1}}var R=n(4778),w=n(2802),N=n(171),D=function(){function e(e,t,n,a,i){var o,s,c=this;this.hostItemIndex=e,this.notifyHost=this.notifyHost.bind(this),this.contextActivationManager=(o=Object(l.f)(),s=this.notifyHost,OSF.AppSpecificSetup._setupFacade=h,new OSF.ContextActivationManager({appName:64,appVersion:d,clientMode:1,appUILocale:o,lcid:o,notifyHost:s,dataLocale:"",hostControl:{},localizedScriptsUrl:OSF.getLocalizedStringsFilePath(),docUrl:""})),this.notifyHostActions=n||{},this.onInsertOsfControlAction=a,this.onDisplayNotificationAction=i,this.manifestCacheProvider=t;var u=this.notifyHostActions[8];this.notifyHostActions[8]=function(e,t){return r.__awaiter(c,void 0,void 0,function(){return r.__generator(this,function(n){return u&&u(e,t),this.notifyHostError(e,t),[2]})})},this.notifyHostActions[23]=this.sendTelemetryEvent.bind(this)}return e.prototype.insertOsfControl=function(e,t){T(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.activeOsfControl=e,this.extensionContainer=t,this.manifestCacheProvider.cache(e,Object(l.f)()),this.contextActivationManager.insertOsfControl(k(this.hostItemIndex,this.activeOsfControl,t))},e.prototype.purgeOsfControl=function(){if(this.activeOsfControl&&this.extensionContainer){var e=this.activeOsfControl.controlId;x(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),Object(_.b)(e),this.contextActivationManager.purgeOsfControl(e,!1),this.activeOsfControl=null,this.extensionContainer=null}},e.prototype.onInsertOsfControl=function(){var e=this.activeOsfControl.addinCommand.extension;("User"==e.OriginString||"Organization"==e.OriginString)&&b.i.Context&&b.i.Context.IsInOrgMarketplaceRole&&this.tryDisplayNotification(e.AppStatus,e.LicenseType),this.onInsertOsfControlAction&&this.onInsertOsfControlAction()},e.prototype.notifyAgave=function(e){var t=this.activeOsfControl.controlId;this.contextActivationManager.notifyAgave(t,e)},e.prototype.updateHostItemIndex=function(e){x(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.hostItemIndex=e,T(e,this.contextActivationManager._serviceEndPoint)},e.prototype.dispose=function(){this.contextActivationManager.dispose(),this.contextActivationManager=null},e.prototype.notifyHost=function(e,t,n){return r.__awaiter(this,void 0,void 0,function(){var a,i;return r.__generator(this,function(r){switch(r.label){case 0:return(a=this.notifyHostActions)&&(i=a[t])?[4,i(e,n)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},e.prototype.notifyHostError=function(e,t){var n=this.activeOsfControl.addinCommand;Object(w.e)(!1,n,this.hostItemIndex,Object(b.o)(e),t.errorCode)},e.prototype.sendTelemetryEvent=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var e,n,a,i,o;return r.__generator(this,function(r){switch(r.label){case 0:return Object(P.d)("addin-oteljs")?[4,Object(N.c)(t.telemetryProperties.ariaTenantToken)]:[3,2];case 1:e=r.sent(),n=Object(R.a)(t,[],Date.now()),a=this.activeOsfControl,i=a.addinCommand,o=a.controlId,Object(w.a)(n,i,this.hostItemIndex,o),e.logEvent(n),r.label=2;case 2:return[2]}})})},e.prototype.displayNotification=function(e){this.contextActivationManager.displayNotification(e),this.onDisplayNotificationAction&&this.onDisplayNotificationAction(e)},e.prototype.tryDisplayNotification=function(e,t){var n=this.activeOsfControl,r=n.addinCommand,a=n.controlId;if(e){var s=function(e,t,n){var r="",a="",s=!1,c=!1;switch(n){case"1.0":r=i.a.appErrorCode1_0,a=i.a.appErrorCodeUpdateAction,s=!0,c=!0;break;case"1.1":r=i.a.appErrorCode1_1,a=i.a.appErrorCodeUpdateAction,s=!0,c=!0;break;case"1.2":r=i.a.appErrorCode1_2,a=i.a.appErrorCodeUpdateAction,s=!0,c=!0;break;case"2.0":r=i.a.appErrorCode2_0,a=i.a.appErrorCodeUpdateAction;break;case"2.1":r=i.a.appErrorCode2_1,a=i.a.appErrorCodeUpdateAction;break;case"3.0":r=i.a.appErrorCode3_0,a=i.a.appErrorCodeDetailsAction;break;case"3.1":r=i.a.appErrorCode3_1,a=i.a.appErrorCodeDetailsAction;break;case"3.2":r=i.a.appErrorCode3_2,a=i.a.appErrorCodeDetailsAction;break;case"3.3":r=i.a.appErrorCode3_3,a=i.a.appErrorCodeDetailsAction;break;default:return null}return{infoType:1,id:e,title:i.a.appErrorTitle,description:r,buttonTxt:a,buttonCallback:o(t),detailView:s,displayDeactive:c,reDisplay:!0}}(a,r,e);s&&this.displayNotification(s)}else 1==t&&this.displayNotification(function(e,t){return{infoType:2,id:t,title:i.a.appInfoTitle,description:i.a.appTrialMessage,buttonTxt:i.a.appBuyButtonLabel,buttonCallback:function(){window.open(e.extension.EndNodeUrl)},reDisplay:!0}}(r,a))},e}(),F="permission";var L="DefaultSettings",U="0",B={cache:function(e,t){var n,a,i=e.addinCommand,o=i.extension,s="Preinstalled"===o.TypeString&&2!==o.ConsentState?function(e){var t,n=function(e){switch(e){case 1:return"ReadItem";case 2:return"ReadWriteMailbox";case 3:return"ReadWriteItem";default:return"Restricted"}}(e),r=Object(b.p)().ConsentUrl;if(r.indexOf("?")>0)t=(a=r.split("?"))[0]+"?"+F+"="+n+"&"+a[1];else if(r.indexOf("#")>0){var a;t=(a=r.split("#"))[0]+"?"+F+"="+n+"#"+a[1]}else t=r+"?"+F+"="+n;return t}(o.RequestedCapabilities):i.get_EntryPoint();a=H(s,t),n=function(e,t,n){var a=n._sourceLocations[t];return new OSF.Manifest.Manifest(function(t){t._id=e.get_Id(),t._version=e.extension.Version,t._extensionSettings={},t._displayNames={},t._defaultLocale="",t._displayNames[U]=e.extension.DisplayName,t._extensionSettings[L]=n,t._appDomains=r.__spread(e.extension.AppDomains,[a])})}(i,t,a),OSF.OsfManifestManager.cacheManifest(i.extension.Id,i.extension.Version,n)}},j={cache:function(e,t){var n=e.addinCommand,r=e.controlId,a=e.sourceLocation,i=function(e,t,n,r){var a=OSF.OsfManifestManager.getCachedManifest(e.extension.Id,e.extension.Version),i=OfficeExt.AddinCommandsManifestManager.createManifestForAddinAction(a,r,null,t);return i._extensionSettings={},i._extensionSettings[L]=H(r,n),i}(n,r,t,a);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(i,r,n.extension.Version)}};function H(e,t){var n=new OSF.Manifest.ExtensionSettings;return n._sourceLocations={},n._sourceLocations[t]=e,n}n.d(t,"a",function(){return B}),n.d(t,"b",function(){return j}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return D})},2643:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1909);function a(e){var t=Object(r.y)("NonPersistent");!t||e&&t.hostItemIndex!==e||Object(r.Y)("NonPersistent")}},2644:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r={};function a(){return r}},2645:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(3520),a=n(2644),i=n(3501);function o(e,t){s(Object(r.a)(e),t)}function s(e,t){var n=t?t.addinId:"",r=t?t.commandId:"";Object(a.a)()[e]=t||void 0,Object(i.b)(e,n,r)}},2647:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),a=n(3),i=n(2205),o=n(2552),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=function(e){e&&(r.extensionContainer=e,r.osfControlAdapter.insertOsfControl(r.props,r.extensionContainer))},r.handlerContainerOnFocus=function(){r.notifyAgave(11)},r.osfControlAdapter=r.props.osfControlAdapter?r.props.osfControlAdapter:new o.c(t.hostItemIndex,t.manifestCacheProvider,t.notifyHostActions,t.onInsertOsfControl,t.onDisplayNotification),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillReceiveProps=function(e){Object(i.c)()&&this.isNewHostItemIndex(e)&&this.osfControlAdapter.updateHostItemIndex(e.hostItemIndex)},t.prototype.shouldComponentUpdate=function(e){return this.isNewOsfControl(e)},t.prototype.componentWillUpdate=function(){this.osfControlAdapter.purgeOsfControl()},t.prototype.componentDidUpdate=function(){this.osfControlAdapter.onInsertOsfControl()},t.prototype.componentWillUnmount=function(){this.osfControlAdapter.purgeOsfControl(),this.osfControlAdapter.dispose(),this.osfControlAdapter=null},t.prototype.notifyAgave=function(e){this.osfControlAdapter.notifyAgave(e)},t.prototype.isNewOsfControl=function(e){return this.props.controlId!=e.controlId},t.prototype.isNewHostItemIndex=function(e){return this.props.hostItemIndex!=e.hostItemIndex},t.prototype.render=function(){return this.extensionContainer&&this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer),a.createElement("div",{tabIndex:0,ref:this.refCallback,style:this.props.style,className:this.props.className,onFocus:this.handlerContainerOnFocus})},t}(a.Component)},268:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"h",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return d}),n.d(t,"a",function(){return p});var r=n(0),a=n(270),i="deeplink",o="compose",s="reply",c="replyall",l="read",u="group",d="/"+r.__spread(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",p="/"+r.__spread(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},2703:function(e,t,n){"use strict";var r=n(859),a=n(18),i={host:"ms-HoverCard-host"};var o=n(2336);n.d(t,"a",function(){return s});var s=Object(r.a)(o.a,function(e){var t=e.className,n=e.theme;return{host:[Object(a.getGlobalClassNames)(i,n).host,t]}},void 0,{scope:"HoverCard"})},2709:function(e,t,n){"use strict";var r=n(0),a=n(932),i=n(871),o=n(4418),s=n.n(o),c=n(4419),l=n.n(c),u=n(31);function d(e,t,n){var r=l()({ItemId:t,Id:e,Notifications:n});return s()({Header:Object(u.getJsonRequestHeader)(),Body:r})}var p=n(1914),f=n(890);function m(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o,s,c;return r.__generator(this,function(r){switch(r.label){case 0:if(n=Object(p.c)(e),!(o={Id:n.getItemId()}).Id)throw new a.a(i.b.CannotPersistPropertyInUnsavedDraftError);return s=Object(f.d)(e,t),c=Object.keys(s).map(function(e){var t=s[e];return{Key:t.Key,Type:t.Type,Message:t.Message,Icon:t.Icon}}),[4,d(t,o,c).catch(function(e){throw new a.a(i.b.PersistedNotificationArraySaveError)})];case 1:return r.sent(),[2]}})})}n.d(t,"a",function(){return m})},2719:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetCalendarEventRequest:#Exchange"},e)}},2720:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),a=n(2887);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetCalendarEvent",e,t)}},2737:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),a=n(185),i=n(697),o=n(868);function s(e){var t,n,s=[];try{for(var c=r.__values(e),l=c.next();!l.done;l=c.next()){var u=l.value,d=null;u.attachmentType==a.i.Item?d={fileType:i.a.MailItem,name:u.name,size:u.size,itemId:u.id}:u.attachmentType==a.i.File&&(d={fileType:i.a.Uri,name:u.name,size:u.size,uri:u.id,type:Object(o.a)(u.id)}),d&&s.push({file:d,isInline:u.isInline})}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return s}},2751:function(e,t,n){"use strict";var r=n(2803);n.d(t,"a",function(){return r.a});var a=n(2926);n.d(t,"b",function(){return a.a})},278:function(e,t,n){"use strict";var r=n(540),a=n(4),i=Object(a.action)("removeInfoBarMessageInCompose")(function(e,t){e.infoBarIds&&e.infoBarIds.length&&(t?(t=Array.isArray(t)?t:[t]).forEach(function(t){Object(r.a)(e,t,e.composeId)}):e.infoBarIds.forEach(function(t){Object(r.a)(e,t,e.composeId)}))});t.a=i},2802:function(e,t,n){"use strict";var r=function(){return{tenantTokens:["56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696"]}},a=n(1957),i=n(12),o=n(5),s=n(29),c=n(1909),l=n(168),u=function(e,t,n,u,d){if(Object(o.d)("addin-launchDatapoint")){var p=function(e){if(Object(o.d)("addin-delegateAccess")){var t=Object(a.n)(e);if(t.isSharedItem)return t.isSharedItem()}return!1}(n);!function(e,t,n,a,o,u){var d=new i.a("ExtAddinLaunched",r());d.addCustomData({id:t.extension.Id,name:t.extension.DisplayName,owa_1:Object(l.a)(),owa_2:Object(c.w)(n),owa_3:a,lang:Object(s.f)(),owa_4:t.extension.Type,errorCode:o,delegate:u}),e?d.end():d.endWithError("Timeout",new Error("Add-in failed to load with code: "+o))}(e,t,n,u,d,p),e&&p&&function(e,t){var n=new i.a("ExtDelegateAddinLaunched",r());n.addCustomData({id:e.extension.Id,name:e.extension.DisplayName,owa_1:Object(l.a)(),owa_2:Object(c.w)(t)}),n.end()}(t,n)}};var d,p=9e5;function f(){var e=r();return e.timeout=p,new i.a("ExtItemSendEvent",e)}function m(e,t){e.addCustomData({owa_1:t}),e.end()}function g(e,t,n){e.addCustomData({reason:h(t),id:n.extension.Id,name:n.extension.DisplayName,module:Object(l.a)()}),e.end()}function h(e){if(e.status===c.e.Success)return e.allowEvent?4:2;switch(e.status){case c.e.TimedOut:return 16;case c.e.FunctionNotFound:return 8;default:return 32}}!function(e){e[e.ExtensibilityUnavailable=1]="ExtensibilityUnavailable",e[e.AllowEventFalse=2]="AllowEventFalse",e[e.AllowEventTrue=4]="AllowEventTrue",e[e.FunctionNotFound=8]="FunctionNotFound",e[e.FunctionTimedOut=16]="FunctionTimedOut",e[e.Unknown=32]="Unknown"}(d||(d={}));var v=n(2385),y=n(161),b=n(110);function _(e,t,n,r){var i=Object(s.e)();e.properties["App.Name"]="Outlook",e.properties["App.Platform"]="Web",e.properties["App.Version"]=Object(l.d)(),e.properties["Release.AudienceGroup"]=function(){switch(Object(l.h)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";default:return"Production"}}(),e.properties["Release.Audience"]=Object(l.h)(),e.properties["User.TenantId"]=i.SessionSettings.ExternalDirectoryTenantGuid,e.properties["User.TenantGroup"]="outlookCom"===Object(a.q)()?"Consumer":"Commercial",e.properties["User.PrimaryIdentityHash"]=i.SessionSettings.UserPuid,e.properties["Browser.Name"]=Object(b.a)().browser,e.properties["Browser.Version"]=Object(b.a)().browserVersion.join("."),e.properties["Session.Id"]=function(e){if(void 0!==e)return(e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)).toLowerCase();return e}(Object(l.c)()),e.properties["Event.Time"]=(new Date).toISOString(),e.properties["Data.SDX.AppState"]=function(e){switch(Object(a.n)(e).mode){case y.a.MessageRead:return"MessageRead";case y.a.MessageCompose:return"MessageCompose";case y.a.AppointmentAttendee:return"AppointmentAttendee";case y.a.AppointmentOrganizer:return"AppointmentOrganizer";default:return"Unknown"}}(n),e.properties["Device.OsVersion"]="N/A",e.properties["Device.OsBuild"]="N/A",e.properties["Data.SDX.LaunchReason"]=function(e,t){if(Object(c.K)(e.extension.Id,t))return"Auto";if(Object(v.d)(e))return"Auto";return"Manual"}(t,r),e.properties["Data.SDX.CommandPlacement"]=function(e,t,n){if(Object(c.K)(e.extension.Id,n))return"OnSend";if(Object(v.d)(e))return"Persistent";if(e.detectedEntity)return"Contextual";return Object(a.n)(t).isAddinPinned(e.extension.Id)?"Ribbon":"Overflow"}(t,n,r),e.properties["Data.SDX.ActionType"]=function(e){switch(Object(c.o)(e)){case 2:return"ShowTaskpane";case 3:return"ExecuteFunction";case 1:return"Contextual";case 5:return"Dialog";case 4:return"Unknown"}}(r),e.properties["Data.ExEnv"]=Object(l.h)()}n.d(t,"e",function(){return u}),n.d(t,"b",function(){return f}),n.d(t,"c",function(){return g}),n.d(t,"d",function(){return m}),n.d(t,"a",function(){return _})},2803:function(e,t,n){"use strict";var r=n(0),a=function(){function e(e){this.addinFactory=e}return e.prototype.activate=function(e,t){var n=this;return new Promise(function(r,a){var i=[];e.forEach(function(e){var r=n.addinFactory.CreateAddinIfEntryPointSupported(e,t);r&&i.push(r)}),r(i)})},e}(),i=n(2260),o=n(3020),s=n(161);var c=n(1909),l=n(2385);function u(e,t){var n=new c.d;return t.activate(e,s.a.AppointmentAttendee).then(function(r){return n.setExtensionPoint(r,s.a.AppointmentAttendee),t.activate(e,s.a.AppointmentOrganizer)}).then(function(r){return n.setExtensionPoint(r,s.a.AppointmentOrganizer),t.activate(e,s.a.DetectedEntity)}).then(function(r){return n.setExtensionPoint(r,s.a.DetectedEntity),t.activate(e,s.a.MessageRead)}).then(function(r){return n.setExtensionPoint(r,s.a.MessageRead),t.activate(e,s.a.MessageCompose)}).then(function(r){return n.setExtensionPoint(r,s.a.MessageCompose),t.activate(e,s.a.MeetingRequest)}).then(function(r){return n.setExtensionPoint(r,s.a.MeetingRequest),t.activate(e,s.a.TrapOnSendEvent)}).then(function(e){n.setExtensionPoint(e,s.a.TrapOnSendEvent)}).then(function(){n.isInitialized=!0,Object(c.P)(n),function(e){var t={};[s.a.MessageRead,s.a.MessageCompose,s.a.AppointmentAttendee,s.a.AppointmentOrganizer].forEach(function(n){var r=e.getExtensionPoint(n);t[n]=Object(o.c)(r)}),i.j.importAndExecute(t)}(n);var t=e.map(function(e){return e.Id});Object(l.g)(t)})}var d=n(2926),p=n(2205),f=n(11);n.d(t,"a",function(){return g});var m=!1;function g(){var e=this;return new Promise(function(t,n){return r.__awaiter(e,void 0,void 0,function(){var e,n,i;return r.__generator(this,function(r){switch(r.label){case 0:if((m||Object(c.H)())&&!Object(c.I)())return Object(c.ib)(t),[2];Object(c.R)(!1),h(!0),[],e=new a(new c.c(new c.b)),n=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(d.a)()];case 2:return n=r.sent(),[3,4];case 3:return i=r.sent(),f.c.error(i),[3,4];case 4:return Object(c.Q)(n),n=Object(c.p)(),Object(p.a)()&&Object(c.N)(n.GenericInfo),[4,u(function(e){return e&&e.Extensions?e.Extensions.filter(function(e){return e.Enabled&&null!=e.ExtensionPointCollection}):[]}(n),e)];case 5:return r.sent(),h(!1),t(),[2]}})})})}function h(e){m=e}},2887:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetCalendarEventJsonRequest:#Exchange"},e)}},2888:function(e,t,n){"use strict";var r=n(4),a=n(540),i=Object(r.action)("removeInfoBarMessageInReadingPane")(function(e,t){Object(a.a)(e,t,e.itemId)});t.a=i},2889:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"b",function(){return c});var r=n(0),a=n(63),i=n(184),o={width:1095,height:640};function s(e,t,n){if(e){var i=Object(a.c)();c(r.__assign({ItemId:r.__assign({mailboxInfo:i},e)},t),n,0)}}function c(e,t,n){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t},o)}},2910:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(2737),a=n(5),i=n(66);function o(e,t,n,o,s,c){if(Object(a.d)("rp-popouts")){var l={operation:0,bodyType:"HTML",subject:o,newContent:s,to:e,cc:t,bcc:n,preferAsyncSend:!0},u=Object(r.a)(c);i.t.importAndExecute(l,i.a.Popout,null,u)}}},2924:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1909);function a(e,t){var n=Object(r.l)(t);return!!n&&n.get_Id()===e+"ItemSend"}},2925:function(e,t,n){"use strict";var r=n(2125),a=n(1);t.a=Object(a.mutatorAction)("updatePersistentTaskPaneError",function(e){var t=Object(r.b)("Persistent");t&&(t.errorType=e)})},2926:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var r=n(0),a=n(1957),i=n(29),o=3,s=3e3,c=3,l=!0,u="1.7",d="1.1";function p(){return function e(t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,(p=t==o?0:s,new Promise(function(e,t){setTimeout(function(){e()},p)}))];case 1:return r.sent(),[4,Object(a.p)(c,Object(i.i)(),l,u,d)];case 2:return[2,r.sent()];case 3:if(n=r.sent(),0==t)throw n;return[3,4];case 4:return[4,e(--t)];case 5:return[2,r.sent()]}var p})})}(o)}},2927:function(e,t,n){var r=n(3869),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},2989:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._3KjHyvZGRc_EnqhgTAoiHJ{width:340px}html[dir=ltr] ._1u__wJzaiLbDkuiYxcu4SU{margin:20px 0 20px 24px}html[dir=rtl] ._1u__wJzaiLbDkuiYxcu4SU{margin:20px 24px 20px 0}html[dir] ._2V4RmecOo921qLicyghJo7{padding:20px 24px;border-top:1px solid "[theme:neutralLighter, default:#f4f4f4]"}._3e5GKSOFibil4nTQzGS4-5{font-weight:600;font-size:14px}html[dir] ._3e5GKSOFibil4nTQzGS4-5{margin-bottom:12px}._1HKlGqoINOBqrOiiB8vnAq{color:"[theme:themePrimary, default:#0078D4]";cursor:pointer}html[dir] ._1HKlGqoINOBqrOiiB8vnAq{background-color:transparent}html[dir] ._3f0MRdhfrlUMx2zrbohjEP{margin-top:3px}html[dir=ltr] ._3f0MRdhfrlUMx2zrbohjEP{float:left}html[dir=rtl] ._3f0MRdhfrlUMx2zrbohjEP{float:right}._15WARQbpLndiLJZybTBTGi{width:244px;vertical-align:middle}html[dir=ltr] ._15WARQbpLndiLJZybTBTGi{float:left;margin-left:12px;text-align:left}html[dir=rtl] ._15WARQbpLndiLJZybTBTGi{float:right;margin-right:12px;text-align:right}._3a4OUz7VBsoa9brQ-2Djjq{clear:both}',""]),t.locals={container:"_3KjHyvZGRc_EnqhgTAoiHJ",persona:"_1u__wJzaiLbDkuiYxcu4SU",cardSection:"_2V4RmecOo921qLicyghJo7",sectionHeader:"_3e5GKSOFibil4nTQzGS4-5",linkToBing:"_1HKlGqoINOBqrOiiB8vnAq",icon:"_3f0MRdhfrlUMx2zrbohjEP",informationRow:"_15WARQbpLndiLJZybTBTGi",clearFix:"_3a4OUz7VBsoa9brQ-2Djjq"}},3018:function(e,t,n){"use strict";var r=n(1957),a=n(2517),i=n(2385),o=n(1909);function s(e,t){var n=Object(r.n)(e);if(n){var s=n.mode,c=Object(i.c)(s);if(c){var l=Object(a.c)(c.addinId,c.commandId,s);if(l&&!Object(a.f)(l)){var u=Object(o.v)();Object(o.S)(u,e,l,"Persistent",s,t)}else!l&&Object(o.H)()&&Object(i.h)(s,null)}}}var c=n(161),l={hostItemIndex:null,mode:c.a.Unknown,isNullSent:!1};function u(){return l}function d(e){l=e}function p(e){switch(Object(r.n)(e).mode){case c.a.MessageRead:case c.a.MeetingRequest:return c.a.MessageRead;case c.a.MessageCompose:return c.a.MessageCompose;default:return c.a.Unknown}}function f(){Object(o.Y)("Persistent"),d({hostItemIndex:null,mode:c.a.Unknown,isNullSent:!1})}var m=n(0),g=n(2133);function h(e){var t,n=u();n.mode!==c.a.MessageCompose&&n.mode!==c.a.Unknown?(Object(o.fb)(e),n.isNullSent||((t=Object(o.y)("Persistent"))&&Object(g.d)(g.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,null),d({hostItemIndex:null,mode:c.a.MessageRead,isNullSent:!0}))):f()}var v=n(2925);function y(e){Object(v.a)(0),Object(o.y)("Persistent")?(Object(o.gb)(e),function(e){m.__awaiter(this,void 0,void 0,function(){var t,n;return m.__generator(this,function(a){switch(a.label){case 0:return(t=Object(o.y)("Persistent"))?[4,Object(r.b)(t.controlId,e)]:[3,2];case 1:n=a.sent(),Object(g.d)(g.a.ITEM_CHANGED_EVENT_DISPID,t.controlId,n),a.label=2;case 2:return[2]}})})}(e)):s(e),d({hostItemIndex:e,mode:p(e),isNullSent:!1})}var b=n(2205),_=n(933);function S(e,t){if(Object(b.c)())switch(e){case _.a.NotSupported:f();break;case _.a.Empty:h(1);break;case _.a.Multi:h(2);break;case _.a.Single:t&&function(e,t){Object(r.k)(t)&&Object(o.H)()&&Object(i.e)()&&!function(e){var t=Object(r.n)(e);return t.mode===c.a.MessageRead&&t.isInlineComposeOpen()}(t)&&function(e){var t=Object(r.n)(e);return t.mode!==c.a.MessageRead||t.isItemSelected()}(t)&&!function(e){return e===u().hostItemIndex}(t)&&(function(e){var t=Object(r.n)(e);return t.mode!==c.a.MessageRead||Object(o.U)(t.getItem())}(t)?function(e){return p(e)!==u().mode}(t)?function(e){Object(o.Y)("Persistent"),s(e),d({hostItemIndex:e,mode:p(e),isNullSent:!1})}(t):y(t):h(3))}(0,t)}}n.d(t,"a",function(){return S})},3020:function(e,t,n){"use strict";var r,a=n(3018),i=n(933),o=n(2643),s=n(3087),c=n(0),l=n(3),u=n(88),d=n(3594),p=n(3088),f=n(2050),m=n.n(f),g=n(2205),h=n(17),v=n(3861),y=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.handleRemoveLinkClick=function(e){e.stopPropagation(),e.preventDefault(),r.props.onClickUninstall&&r.props.onClickUninstall(),Object(g.b)()&&Object(p.a)()},r.handleRemoveLinkClick=r.handleRemoveLinkClick.bind(r),r}return c.__extends(t,e),t.prototype.render=function(){return l.createElement("div",{className:v.divContainer},l.createElement("div",null,m.a.gdprMinorWarningText," ",l.createElement("a",{href:"",onClick:this.handleRemoveLinkClick},m.a.gdprMinorRemoveAddinText)))},t=c.__decorate([h.observer],t)}(l.Component),b=n(725),_=n(728),S=n(2552),C=n(1326),A=n(354),I=n(1222),O=n(2517),T=n(2647),x=(n(2041),n(1909)),E=n(3863),M=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.refCallback=r.refCallback.bind(r),r.focusOnAddinBar=r.focusOnAddinBar.bind(r),r.dismissCallout=r.dismissCallout.bind(r),r.getContextualExecutor=r.getContextualExecutor.bind(r),r.convertAddinsToCommandBarItems=r.convertAddinsToCommandBarItems.bind(r),r}return c.__extends(t,e),t.prototype.dismissCallout=function(){Object(x.q)().activeDialog||(Object(x.q)().contextualCalloutState.contextualAnchor.focus(),Object(x.W)())},t.prototype.focusOnAddinBar=function(){this.commandBar.focus()},t.prototype.getContextualExecutor=function(e){return function(){var t=Object(x.q)().runningContextualAddinCommand,n=t.hostItemIndex,r=t.addinCommand;e.get_Id()!==r.get_Id()&&Object(d.a)(n,e)}},t.prototype.convertAddinsToCommandBarItems=function(e,t){var n=this;return e.map(function(e){var r=e.get_Id()===t.get_Id();return{key:e.get_Id(),className:r&&E.selected,text:e.detectedEntity.Label,onClick:n.getContextualExecutor(e)}})},t.prototype.refCallback=function(e){this.commandBar=e},t.prototype.onRenderContextualAddin=function(e){return l.createElement(b.ActionButton,{className:e.className,onClick:e.onClick,text:e.text,ariaLabel:e.text})},t.prototype.onRenderOverflowButton=function(e){return l.createElement(_.IconButton,{menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:m.a.overflowMenuAccessibilityLabel})},t.prototype.render=function(){var e=Object(x.q)();if(!e.runningContextualAddinCommand)return l.createElement("div",null);var t=e.contextualCalloutState.contextualAnchor,n=e.runningContextualAddinCommand,r=n.hostItemIndex,a=n.addinCommand,i=this.convertAddinsToCommandBarItems(e.contextualCalloutState.activeContextualAddinCommands,a),o={height:a.detectedEntity.RequestedHeight?a.detectedEntity.RequestedHeight+"px":"350px"},s={};s[13]=this.focusOnAddinBar,s[14]=this.focusOnAddinBar,s[15]=this.dismissCallout;var c=Object(O.f)(a)?l.createElement(y,{onClickUninstall:this.dismissCallout}):l.createElement(T.a,{addinCommand:e.runningContextualAddinCommand.addinCommand,controlId:e.runningContextualAddinCommand.controlId,hostItemIndex:r,manifestCacheProvider:S.a,style:o,notifyHostActions:s});return l.createElement(C.a,{gapSpace:0,target:t,onDismiss:this.dismissCallout,setInitialFocus:!0,calloutWidth:parseInt("570px"),beakWidth:19,className:E.divContainer},l.createElement(A.a,{className:E.appIcon,iconName:"OfficeAddinsLogo"}),l.createElement("div",{className:E.divider}),l.createElement(I.a,{componentRef:this.refCallback,items:i,className:E.contextualBar,onRenderItem:this.onRenderContextualAddin,onRenderOverflowButton:this.onRenderOverflowButton}),l.createElement("div",{className:E.contextualAddinFrame},c))},t=c.__decorate([h.observer],t)}(l.Component),P=n(1856),k=n(723),R=n(2133),w=n(3865),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c.__extends(t,e),t.prototype.hideDialog=function(e){Object(R.j)({eventDispId:R.a.DISPLAY_DIALOG_DISPID,controlId:e})},t.prototype.render=function(){var e=Object(x.q)().activeDialog;if(!e)return l.createElement("div",{className:w.divContainer});if(e.isOpen&&1==e.dialogType){var t=Object(x.l)(e.parentControlId),n=t.extension.DisplayName,r={height:e.heightInPercentage+"vh",width:e.widthInPercentage+"vw",overflow:"hidden"},a=m.a.iFrameableDialogCloseButtonAccessibilityLabel;a&&(a=a.replace("{0}",n));var i={};return i[15]=this.hideDialog,l.createElement(P.a,{hidden:!e.isOpen,onDismiss:this.hideDialog.bind(this,e.parentControlId),dialogContentProps:{type:k.a.close,title:n,closeButtonAriaLabel:a},modalProps:{isBlocking:!0,containerClassName:w.dialogContainer},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},l.createElement(T.a,{addinCommand:t,controlId:e.controlId,isDialog:!0,hostItemIndex:e.hostItemIndex,sourceLocation:e.url,manifestCacheProvider:S.b,notifyHostActions:i,style:r}))}return l.createElement("div",{className:w.divContainer})},t=c.__decorate([h.observer],t)}(l.Component),D=n(3494),F=n(3874),L=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.hideDialog=function(){Object(R.j)({eventDispId:R.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID,controlId:r.props.controlId})},r}return c.__extends(t,e),t.prototype.render=function(){var e=x.i.activeDialog,t=!1;e&&e.parentControlId==this.props.controlId&&2==e.dialogType&&(t=!0);var n=this.props.addinCommand,r=n.extension.ConsentState,a=n.extension.Type,i=2!=r&&"Preinstalled"==a?F.consentContainer:F.uiLessContainer,o=t?"":F.hiddenContainer;return l.createElement("div",null,l.createElement(P.a,{hidden:!1,onDismiss:this.hideDialog.bind(this),dialogContentProps:{type:k.a.normal,title:n.extension.DisplayName},modalProps:{isBlocking:t,containerClassName:F.dialogContainer,className:o},forceFocusInsideTrap:t,containerClassName:F.dialogContainer,isClickableOutsideFocusTrap:!0},l.createElement("div",{className:i},this.props.children)))},t=c.__decorate([h.observer],t)}(l.Component),U=n(1957),B=n(20),j=n(3876),H=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.addDisplayNotification=r.addDisplayNotification.bind(r),r.addGenericErrorNotification=r.addGenericErrorNotification.bind(r),r.invokeAppCommand=r.invokeAppCommand.bind(r),r.infoBarId=0,r}return c.__extends(t,e),t.prototype.addDisplayNotification=function(e){Object(U.e)(this.props.hostItemIndex,this.props.controlId,!1,""+this.props.addinCommand.get_Id()+this.infoBarId++,Object(S.d)(e.infoType),e.description)},t.prototype.addGenericErrorNotification=function(){var e=Object(B.format)(m.a.officeAddinsNotificationGenericError,this.props.addinCommand.get_ExtensionDisplayName());Object(U.e)(this.props.hostItemIndex,this.props.controlId,!1,this.props.addinCommand.get_Id(),2,e,this.props.addinCommand.get_Size16Icon())},t.prototype.removeProgressNotification=function(){Object(U.s)(this.props.hostItemIndex,this.props.controlId,this.props.addinCommand.get_Id())},t.prototype.addProgressNotification=function(){var e=Object(B.format)(m.a.officeAddinsAutomaticProgressNotificationLabel,this.props.addinCommand.get_ExtensionDisplayName(),this.props.addinCommand.get_Label());Object(U.e)(this.props.hostItemIndex,this.props.controlId,!1,this.props.addinCommand.get_Id(),1,e)},t.prototype.invokeAppCommand=function(){var e=this.props.addinCommand.control,t=e.Action.FunctionName,n={source:{id:e.Id}};this.addProgressNotification(),OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.props.controlId,t,n,this.onEventCompleted.bind(this))},t.prototype.onEventCompleted=function(e,t){this.removeProgressNotification();var n=t?t.completedContext:void 0;e!=x.e.Success&&Object(x.G)(this.props.hostItemIndex)&&this.addGenericErrorNotification(),Object(x.Z)(this.props.controlId,this.props.hostItemIndex,e,n)},t.prototype.render=function(){var e={};return e[8]=this.addGenericErrorNotification,l.createElement(T.a,{addinCommand:this.props.addinCommand,controlId:this.props.controlId,hostItemIndex:this.props.hostItemIndex,manifestCacheProvider:S.a,onInsertOsfControl:this.invokeAppCommand,onDisplayNotification:this.addDisplayNotification,notifyHostActions:e,className:j.uiLessContainer})},t}(l.Component),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c.__extends(t,e),t.prototype.render=function(){var e=[];return Object(x.q)().runningUILessAddinCommands.forEach(function(t,n){t.forEach(function(t,r){e.push(l.createElement(L,{hostItemIndex:n,controlId:r,addinCommand:t,key:r},l.createElement(H,{addinCommand:t,controlId:r,hostItemIndex:n})))})}),l.createElement("div",null,e)},t=c.__decorate([h.observer],t)}(l.Component),W=n(3491);function G(e){r||(r=document.createElement("div"),document.body.appendChild(r),u.render(l.createElement(z,{renderTaskPaneInPanel:e}),r))}var z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c.__extends(t,e),t.prototype.render=function(){return l.createElement("div",null,this.props.renderTaskPaneInPanel&&l.createElement(D.a,{renderTaskPaneInPanel:!0}),l.createElement(V,null),l.createElement(M,null),l.createElement(N,null),l.createElement(W.a,null))},t}(l.Component),q=n(3595),X=n(3596),K=n(198);function J(e){var t,n=e.map(Q);return n.push({key:(t=Object(X.a)()).key,name:t.name,itemType:t.itemType,iconProps:t.iconProps}),n}function Q(e){return{key:e.Id,name:e.DisplayName,itemType:K.a.Normal,iconProps:Object(q.a)(e.IconUrl)}}n.d(t,"e",function(){return a.a}),n.d(t,"a",function(){return i.a}),n.d(t,"b",function(){return o.a}),n.d(t,"f",function(){return s.a}),n.d(t,"d",function(){return G}),n.d(t,"c",function(){return J})},305:function(e,t,n){"use strict";n.d(t,"d",function(){return _}),n.d(t,"e",function(){return S}),n.d(t,"c",function(){return C}),n.d(t,"a",function(){return A});var r=n(0),a=n(223),i=n(278),o=n(709),s=n(553),c=n(1607),l=n(1268),u=n(847),d=n(1617),p=n(1346),f=n(280),m=n(554),g=n(7),h=n(30),v={};function y(e){var t=v[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},v[e.composeId]=t),t}function b(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=y(e)).activeSaveAction?[3,1]:[2,Promise.resolve(!0)];case 1:return t.hasPendingSaveAction?[4,t.activeSaveAction]:[3,3];case 2:return n.sent(),[2,Promise.resolve(!1)];case 3:return t.hasPendingSaveAction=!0,[4,t.activeSaveAction];case 4:return n.sent(),t.hasPendingSaveAction=!1,[2,Promise.resolve(!0)]}})})}function _(e,t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return(n=y(e)).activeSaveAction=t,[4,t.then(function(e){return n.activeSaveAction=null,Promise.resolve(e)}).catch(function(e){return n.activeSaveAction=null,Promise.reject(e)})];case 1:return r.sent(),[2]}})})}function S(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return(t=v[e.composeId])&&t.activeSaveAction?[4,t.activeSaveAction]:[3,2];case 1:return n.sent(),[2,Promise.resolve(!0)];case 2:return[2,Promise.resolve(!1)]}})})}function C(e){var t=v[e.composeId];return t&&!!t.activeSaveAction}function A(e){v[e.composeId]&&delete v[e.composeId]}t.b=Object(h.b)("trySaveMessage",s.b.MailComposeSave)(function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){switch(r.label){case 0:return e?e.isSending?[2,Promise.resolve()]:(t||Object(i.a)(e,c.a),function(e){return Object(f.a)(e)<=Object(g.a)().MaxRecipientsPerMessage}(e)?[4,b(e)]:(t||Object(a.a)(e,"warningMessageMaxRecipientsExceed"),[2,Promise.resolve()])):[2,Promise.reject("could not save message if view state does not exist")];case 1:return r.sent()?[2,_(e,Object(p.b)(e).then(function(n){return Object(p.a)(n,e),Object(m.a)()&&Object(o.a)(e,t?2:4),Object(l.a)(1,Object(u.a)(e)),Promise.resolve()}).catch(function(r){if(!t){var i=Object(d.a)(r?r.message:null,!1);Object(a.a)(e,i)}return n?Promise.reject(r):Promise.resolve()}))]:[2,Promise.resolve()]}})})})},3086:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(161),a=n(1909);function i(e){return Object(a.q)().EnabledAddinCommands.getExtensionPoint(r.a.TrapOnSendEvent).map(function(t){return t.AddinCommands.get(e.toString())})}},3087:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(2643),a=n(1957),i=n(2385),o=n(1909);function s(e,t,n,s){Object(r.a)(e);var c=Object(o.y)("Persistent");if(!(c&&(l=c.addinCommand,u=t,l&&u&&l.get_Id()===u.get_Id()))){var l,u,d=Object(a.n)(e);d.openTaskPane&&d.openTaskPane();var p=Object(o.v)();Object(o.S)(p,e,t,function(e,t){var n=Object(i.c)(t);if(!n)return"NonPersistent";var r=n.addinId,a=n.commandId;return e.get_Id()===""+r+a?"Persistent":"NonPersistent"}(t,n),n,s)}}},3088:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r,a=n(3),i=n(88),o=n(3264),s=n(3492);function c(){Object(s.a)().then(function(e){var t=e,n=a.createElement(o.a,{storeUrl:t});i.render(n,r).setPanelOpen()})}r=document.createElement("div"),document.body.appendChild(r)},3222:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(2),a=new r.c(function(){return n.e(53).then(n.bind(null,4770))}),i=new r.a(a,function(e){return e.getTypeOfAttachment}),o=new r.a(a,function(e){return e.getAllAttachments}),s=new r.a(a,function(e){return e.getAttachmentContentHelper})},3263:function(e,t,n){var r=n(3855),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3264:function(e,t,n){"use strict";var r=n(0),a=n(3),i=n(997),o=n(15),s=n.n(o),c=n(728),l=n(5),u=n(1732),d=n(3714),p=n(3040),f=n(3856),m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isPanelOpen:!0},n}return r.__extends(t,e),t.prototype.setPanelOpen=function(){this.setState({isPanelOpen:!0})},t.prototype.openSendFeedbackCompose=function(){i.a.sendFeedback()},t.prototype.render=function(){var e=this;return Object(l.d)("addin-centerAlignedICSEnabled")?a.createElement(u.a,{isOpen:this.state.isPanelOpen,onDismiss:function(){return e.setState({isPanelOpen:!1})}},a.createElement("div",{className:f.container},a.createElement(c.IconButton,{className:f.closeButton,onClick:function(){e.setState({isPanelOpen:!1})},iconProps:{iconName:"Cancel"}}),a.createElement("iframe",{src:this.props.storeUrl,title:"",className:f.inClientStoreIFrameCenter,frameBorder:0})),Object(l.d)("addin-inClientStoreSendFeedbackEnabled")&&a.createElement("div",{className:f.FeedbackCommandBarCenter},a.createElement("div",{onClick:this.openSendFeedbackCompose},s.a.sendFeedback))):a.createElement(d.a,{isOpen:this.state.isPanelOpen,type:p.a.largeFixed,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1},onDismiss:function(){return e.setState({isPanelOpen:!1})},className:f.inClientStorePanelContainer},a.createElement("iframe",{src:this.props.storeUrl,title:"",className:f.inClientStoreIFrame,frameBorder:0}),Object(l.d)("addin-inClientStoreSendFeedbackEnabled")&&a.createElement("div",{className:f.FeedbackCommandBar},a.createElement("div",{onClick:this.openSendFeedbackCompose},s.a.sendFeedback)))},t}(a.Component);t.a=m},3265:function(e,t,n){e.exports=n.p+"../resources/images/progress-e4ba8e5c7eb8b6080aadb62c29bbf737.gif"},3491:function(e,t,n){"use strict";var r;!function(e){e[e.Success=0]="Success",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.InternalError=5001]="InternalError",e[e.BrowserAPINotSupported=5009]="BrowserAPINotSupported",e[e.CrossZone=12011]="CrossZone",e[e.NotSsoAgave=13e3]="NotSsoAgave",e[e.UserNotSignedIn=13001]="UserNotSignedIn",e[e.UserAborted=13002]="UserAborted",e[e.UnsupportedUserIdentity=13003]="UnsupportedUserIdentity",e[e.InvalidResourceUrl=13004]="InvalidResourceUrl",e[e.InvalidGrant=13005]="InvalidGrant",e[e.ClientError=13006]="ClientError",e[e.ServerError=13007]="ServerError",e[e.AddinIsAlreadyRequestingToken=13008]="AddinIsAlreadyRequestingToken"}(r||(r={}));var a=n(0),i=n(3),o=null;function s(e){o=e}function c(){s(null)}var l=function(e,t){o&&o(e,t)},u=n(1909);function d(e){l(e),c(),Object(u.C)()}var p,f,m=n(139),g=n(89),h="https",v="store.office.com",y="client/consentnotification.aspx",b="WAC_Outlook";!function(e){e[e.TrustYellowBar=0]="TrustYellowBar",e[e.ConsentYellowBar=1]="ConsentYellowBar",e[e.ConsentWhiteDialog=2]="ConsentWhiteDialog"}(p||(p={})),function(e){e[e.ConsentResult=0]="ConsentResult",e[e.TabExit=1]="TabExit",e[e.ButtonClick=2]="ButtonClick",e[e.PageLoad=3]="PageLoad"}(f||(f={}));var _=f,S={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",InvalidGrant:"AADSTS65001"};var C,A=n(359),I="bc59ab01-8403-45c6-8796-ac3ef710b3e3",O="/owa/extSSO.aspx";function T(e,t){var n=Object(u.B)(e),r=Object(m.resolve)(window.location.origin,O);Object(A.a)(I,r,n,t,x)}function x(e,t){var n,a;t?l(null,t):l((n=e,a=r.InternalError,n&&n.indexOf(S.NoUserLogin)>=0?a=r.UserNotSignedIn:n&&n.indexOf(S.InvalidResourceUrl)>=0?a=r.InvalidResourceUrl:n&&n.indexOf(S.InvalidGrant)>=0&&(a=r.InvalidGrant),a)),c()}function E(e,t){Object(u.C)(),T(e,t)}!function(e){e[e.Success=0]="Success",e[e.Cancelled=100]="Cancelled",e[e.ClientError=400]="ClientError",e[e.ServerError=500]="ServerError",e[e.UnknowError=600]="UnknowError"}(C||(C={}));var M=C;var P=n(17),k=n(3263),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.refcallback=function(e){var t=function(n){if(e&&n.source==e.contentWindow){var a=JSON.parse(n.data);a.messageType==_.ConsentResult?(window.removeEventListener("message",t),function(e){switch(e){case M.Success:var t=Object(u.x)();E(t.controlId,t.authChallenge);break;case M.Cancelled:d(r.UserAborted);break;default:d(r.InvalidGrant)}}(a.messageValue)):a.messageType==_.PageLoad&&Object(u.hb)(!0)}};window.addEventListener("message",t),null!=e&&null!=e.contentWindow&&e.contentWindow.focus()},t}return a.__extends(t,e),t.prototype.render=function(){var e=Object(u.x)(),t=function(e,t,n){var r={client:b,cv:n,ui:t,appDomain:window.location.origin,rs:e.extension.MarketplaceContentMarket,notificationType:2,corr:Object(g.a)()};return e.extension.MarketplaceAssetID?r.assetid=e.extension.MarketplaceAssetID:(r.appid=e.extension.WebAppId,r.scopes=e.extension.WebAppScopes.join(",")),Object(m.format)({protocol:h,host:v,pathname:y,query:r})}(Object(u.l)(e.controlId),this.props.userCulture,this.props.owaVersion);return i.createElement("div",null,i.createElement("iframe",{src:t,frameBorder:"0",className:k.consentContainer,ref:this.refcallback}))},t=a.__decorate([P.observer],t)}(i.Component),w=n(2050),N=n.n(w),D=n(1519),F=n(872),L=n(1521),U=n(1535),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return i.createElement("div",null,i.createElement(U.a,null,N.a.ssoSignInLabelText),i.createElement(L.a,null,i.createElement(D.a,{onClick:this.onSignInClick.bind(this),text:N.a.ssoSignInButtonText}),i.createElement(F.a,{onClick:this.onDismiss.bind(this),text:N.a.ssoSignInCloseButtonText})))},t.prototype.onSignInClick=function(){var e=Object(u.x)();E(e.controlId,e.authChallenge)},t.prototype.onDismiss=function(){d(r.UserAborted)},t}(i.Component),j=n(1856),H=n(723),V=n(29),W=n(168),G=n(3263),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=Object(u.x)(),t=e.isVisible?"":G.hiddenContainer,n=this.createSsoDialog(e.type);return n?i.createElement("div",null,i.createElement(j.a,{isOpen:e.isOpen,type:n.type,onDismiss:this.closeDialog.bind(this),title:n.title,modalProps:{isBlocking:!0,containerClassName:"ms-dialogMainOverride"},className:t},n.component)):i.createElement("div",null)},t.prototype.closeDialog=function(){d(r.UserAborted)},t.prototype.createSsoDialog=function(e){switch(e){case u.f.OmexConsent:var t=Object(V.f)(),n=Object(W.d)();return{component:i.createElement(R,{userCulture:t,owaVersion:n}),title:N.a.ssoConsentPermissionTitleText,type:H.a.close};case u.f.MFASignIn:return{component:i.createElement(B,null),title:N.a.ssoSignInButtonText,type:H.a.normal};default:return null}},t=a.__decorate([P.observer],t)}(i.Component);function q(e){s(e)}n.d(t,"a",function(){return z}),n.d(t,"d",function(){return q}),n.d(t,"c",function(){return T}),n.d(t,"b",function(){return r})},3492:function(e,t,n){"use strict";n(2041);var r=n(2076),a=n(2150),i=n(2646),o=n.n(i),s=n(2752),c=n.n(s),l=n(168),u=n(726);function d(e){e.registerMethod("InstallOutlookWebExt",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:e[1],MarketplaceContentMarket:e[0],Client:"WAC_Outlook",ClientVersion:Object(l.d)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null},n={Header:Object(u.getJsonRequestHeader)(a.f()),Body:t},i=o()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{var r=n.Body.Extension?n.Body.Extension.MarketplaceAssetID:e[1],i=!!n.Body.WasFirstInstall;t([r,i],0),a.g()}})},Microsoft.Office.Common.InvokeType.async,!1)}var p=n(7),f=n(47),m=n(1909),g=n(171);var h=n(3858),v=n.n(h),y=n(4430),b=n.n(y);function _(e){e.registerMethod("DisableOutlookWebExt",function(e,t){(function(e){var t={__type:"DisableAppRequest:#Exchange",ID:e.toString(),DisableReason:"NoReason"},n={Header:Object(u.getJsonRequestHeader)(a.f()),Body:t},i=v()(n),o=Object(r.b)();return b()(i,o)})(e).then(function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):t([e.toString()],0),a.g()})},Microsoft.Office.Common.InvokeType.async,!1)}var S=n(5);var C=n(3859),A=n.n(C),I=n(4431),O=n.n(I);function T(e){e.registerMethod("UninstallOutlookWebExt",function(e,t){(function(e){var t={__type:"UninstallAppRequest:#Exchange",ID:e.toString()},n={Header:Object(u.getJsonRequestHeader)(a.f()),Body:t},i=A()(n),o=Object(r.b)();return O()(i,o)})(e).then(function(n){"Error"==n.Body.ResponseClass.toString()?t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1):(t([e.toString()],0),a.g())})},Microsoft.Office.Common.InvokeType.async,!1)}function x(e){e.registerMethod("InstallOutlookWebExtByManifest",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(l.d)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:e[0],Id:null};t.Manifest=a.b(t.Manifest);var n={Header:Object(u.getJsonRequestHeader)(a.f()),Body:t},i=o()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,e.Body.Extension?e.Body.Extension.Enabled.toString():"false",e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),a.g())})},Microsoft.Office.Common.InvokeType.async,!1)}function E(e){e.registerMethod("InstallOutlookWebExtByManifestUrl",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(l.d)(),SendWelcomeEmail:!0,ManifestUrl:e[0],Manifest:null,Id:null},n={Header:Object(u.getJsonRequestHeader)(a.f()),Body:t},i=o()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(e){"Error"==e.Body.ResponseClass.toString()?t([e.Body.MessageText.toString(),e.Body.ResponseCode.toString()],-1):(t([!!e.Body.WasFirstInstall,e.Body.Extension?e.Body.Extension.Id:null,!!e.Body.Extension&&e.Body.Extension.Enabled.toString(),e.Body.Extension?e.Body.Extension.ConsentState.toString():null,e.Body.Extension?e.Body.Extension.TypeString.toString():null,e.Body.Extension?e.Body.Extension.LicenseStatus.toString():null,e.Body.Extension?e.Body.Extension.TrialExpirationDate:null,e.Body.Extension?e.Body.Extension.Description:null,e.Body.Extension?e.Body.Extension.ProviderName:null,e.Body.Extension?e.Body.Extension.IconUrl:null,e.Body.Extension?e.Body.Extension.HighResolutionIconUrl:null,e.Body.Extension?e.Body.Extension.DisplayName:null,e.Body.Extension?e.Body.Extension.Requirements.toString():null,e.Body.Extension?e.Body.Extension.Version:null],0),a.g())})},Microsoft.Office.Common.InvokeType.async,!1)}function M(e){e.registerMethod("InstallOutlookWebExtByProductId",function(e,t){(function(e){var t={__type:"InstallAppRequest:#Exchange",MarketplaceAssetId:null,MarketplaceContentMarket:null,Client:"WAC_Outlook",ClientVersion:Object(l.d)(),SendWelcomeEmail:!0,ManifestUrl:null,Manifest:null,Id:e},n={Header:Object(u.getJsonRequestHeader)(a.f()),Body:t},i=o()(n),s=Object(r.b)();return c()(i,s)})(e).then(function(n){if("Error"==n.Body.ResponseClass.toString())t([n.Body.MessageText.toString(),n.Body.ResponseCode.toString()],-1);else{t([e,!1],0)}a.g()})},Microsoft.Office.Common.InvokeType.async,!1)}var P=n(3860),k=n.n(P),R=n(4432),w=n.n(R),N=n(2751);function D(e){e.registerMethod("EnableApp",function(e,t){(function(e){var t={DisplayName:e[0],RawIdentity:e[1]},n={Header:Object(u.getJsonRequestHeader)(a.f()),Identity:t},i=k()(n),o=Object(r.b)();return w()(i,o)})(e).then(function(e){t([e.WasSuccessful],0),Object(N.b)().then(function(e){Object(m.Q)(e),Object(m.R)(!0)})}).catch(function(e){e.ErrorMessage?t([e.ErrorMessage],-1):t([],-1)})},Microsoft.Office.Common.InvokeType.async,!1)}var F=n(217);function L(e,t){!function(e){e.registerMethod("GetTelemetryInfoFromOutlook",function(e,t){var n=Object(m.p)(),r=Object(p.a)(),i=!r.SessionSettings.IsSPOnPrem,o=Object(f.a)(),s=i?o?"Consumer":"Business":"OnPremise";t([Object(g.a)(),r.SessionSettings.UserCulture,"16.2130.0.9999",a.c(),s,i,o,n.MarketplaceUrl,r.SessionSettings.ExternalDirectoryUserGuid,r.SessionSettings.OrganizationDomain,a.e(),"other","OWA_REACT",n.GenericInfo],0)},Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllInstalledAddIns",function(e,t){var n=Object(m.p)(),a=[];n.Extensions.forEach(function(e){"Private"!==e.TypeString&&"Default"!==e.TypeString&&a.push([e.Id,e.MarketplaceAssetID,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString,e.LicenseStatus.toString(),e.TrialExpirationDate,e.IsMandatory.toString(),e.OriginString])}),t(a,0)},Microsoft.Office.Common.InvokeType.async,!1)}(e),function(e){e.registerMethod("GetAllPrivateAddIns",function(e,t){var n=Object(m.p)().Extensions,a=[];n.forEach(function(e){("Private"===e.TypeString||Object(S.d)("addin-inClientStoreDefaultAddinsEnabled")&&"Default"===e.TypeString)&&a.push([e.Id,e.Enabled.toString(),Object(r.e)(e.ConsentState),e.TypeString.toString(),e.LicenseStatus.toString(),e.TrialExpirationDate,e.Description,e.ProviderName,e.IconUrl,e.HighResolutionIconUrl,e.DisplayName,e.RequestedCapabilities.toString(),e.Version,e.OriginString,e.IsMandatory.toString()])}),t(a,0)},Microsoft.Office.Common.InvokeType.async,!1)}(e),d(e),_(e),T(e),x(e),E(e),M(e),D(e),function(e){e.registerMethod("LaunchUrl",function(e){var t=e;return window.open(t),null},Microsoft.Office.Common.InvokeType.sync,!1)}(e),function(e){e.registerMethod("UpdateAddinPinOptions",function(e){var t={readMode:e[2],composeMode:e[3],calendarMode:e[4]};F.g.importAndExecute(e[0],e[1],t)},Microsoft.Office.Common.InvokeType.async,!1)}(e),e.registerConversation(r.d(),t,null,null)}t.a=function(){var e=r.c();return Object(N.a)().then(function(){var t=r.a();return L(e,t),t})}},3494:function(e,t,n){"use strict";var r=n(0),a=n(3),i=n(275),o=n.n(i),s=n(2050),c=n.n(s),l=n(354),u=n(3867),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.getErrorText(this.props.errorType);return a.createElement("div",{className:u.errorContainer},a.createElement("div",{className:u.errorContent},a.createElement(l.a,{className:u.errorIcon,iconName:"OfficeAddinsLogo"}),a.createElement("span",{className:o()([u.errorTextCommon,u.errorTextTitle])},e.title),a.createElement("span",{className:o()([u.errorTextCommon,u.errorTextDescription])},e.description)))},t.prototype.getErrorText=function(e){switch(e){case 1:return{title:c.a.taskPaneErrorNoItemSelected,description:c.a.taskPaneErrorNoItemSelectedDescription};case 2:return{title:c.a.taskPaneErrorMultipleItemsSelected,description:c.a.taskPaneErrorMultipleItemsSelectedDescription};case 3:return{title:c.a.taskPaneErrorAddinsNotSupported,description:c.a.taskPaneErrorAddinsNotSupportedDescription};default:return{title:null,description:null}}},t}(a.Component),p=n(744),f=n(99),m=n(1215),g=n(17),h=n(2927),v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasLoadFailed:!1},n}return r.__extends(t,e),t.prototype.onLoadingStateChanged=function(e){e==f.ImageLoadState.error?this.setState({hasLoadFailed:!0}):this.setState({hasLoadFailed:!1})},t.prototype.render=function(){return this.state.hasLoadFailed?a.createElement(l.a,{iconName:"Photo2",iconType:p.IconType.default,className:o()([h.fallbackIcon,this.props.className])}):a.createElement(m.a,{onLoadingStateChange:this.onLoadingStateChanged.bind(this),src:this.props.src,width:this.props.width,height:this.props.height,imageFit:f.ImageFit.contain,className:this.props.className})},t=r.__decorate([g.observer],t)}(a.Component),y=n(20),b=n(728),_=n(2927),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.getPersistButtonIcon(),t=this.getPersistButtonText();return a.createElement(b.IconButton,{className:_.persistIcon,onClick:this.props.togglePersist,title:t,ariaLabel:t,iconProps:{iconName:e}})},t.prototype.getPersistButtonText=function(){var e=this.props.isPersisted?c.a.taskPaneUnpinButtonLabel:c.a.taskPanePinButtonLabel;return Object(y.format)(e,this.props.displayName)},t.prototype.getPersistButtonIcon=function(){return this.props.isPersisted?"Pinned":"Pin"},t}(a.Component),C=n(2205),A=n(2927),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.focusCloseButton=function(){this.closeButton&&this.closeButton.focus()},t.prototype.render=function(){var e=this,t=this.props.isCalendar;return a.createElement("div",{className:o()(A.addinPaneHeader,t&&A.addinPaneHeaderCalendar)},a.createElement(v,{src:this.props.iconUrl,width:32,height:32,className:A.addinPaneIcon}),a.createElement("div",{className:o()([A.addinPaneLabelText,A.ellipsis])},this.props.displayName),a.createElement("div",{className:A.rightButtons},Object(C.c)()&&this.props.isPersistable&&!t&&a.createElement(S,{displayName:this.props.displayName,isPersisted:this.props.isPersisted,togglePersist:this.props.togglePersist}),a.createElement(b.IconButton,{componentRef:function(t){return e.closeButton=t},className:A.closeButton,onClick:this.props.closeOnClick,ariaLabel:c.a.taskPaneCloseButtonAriaLabel,iconProps:{iconName:"Cancel"}})))},t}(a.Component),O=n(2552),T=n(1731),x=n(3714),E=n(3870),M=function(e){return e.renderInPanel?a.createElement(x.a,{focusTrapZoneProps:{forceFocusInsideTrap:!1,disableFirstFocus:e.disableFirstFocus,isClickableOutsideFocusTrap:!0},hasCloseButton:!1,isOpen:!0,onDismiss:e.onDismiss,className:o()(E.taskPane,e.isDeepLink&&E.taskPaneNoHeader),isBlocking:!1,isFooterAtBottom:!0,isLightDismiss:!0},e.children):a.createElement(T.a,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:E.taskPane},e.children)},P=n(1957),k=n(161),R=n(704),w=n(2647),N=(n(2041),n(1909)),D=n(2385),F=n(3872),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusTaskPaneHeader=function(){t.taskPaneHeader&&t.taskPaneHeader.focusCloseButton()},t.renderError=function(){var e=t.props.instance.errorType;return t.hasError()&&a.createElement(d,{errorType:e})},t.renderOsfHostContainer=function(){var e=t.props.instance,n=e.hostItemIndex,r=e.controlId,i=e.addinCommand,s={};return s[15]=t.focusTaskPaneHeader,s[14]=t.focusTaskPaneHeader,s[13]=t.focusTaskPaneHeader,a.createElement(w.a,{addinCommand:i,controlId:r,className:o()([F.extensionHost,t.hasError()&&F.hide]),hostItemIndex:n,manifestCacheProvider:O.a,notifyHostActions:s})},t.hasError=function(){return 0!==t.props.instance.errorType},t.close=function(){var e=t.props.instance,n=e.mode,r=e.controlId;t.isPersisted()&&Object(D.h)(n,null),Object(P.f)(r)},t.togglePersist=function(){var e=t.isPersisted()?null:Object(D.b)(t.props.instance.addinCommand);Object(D.h)(t.props.instance.mode,e),Object(N.ab)(t.props.type)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.instance,n=void 0===this.props.renderInPanel||this.props.renderInPanel;if(!t)return a.createElement("div",{className:F.divContainer});var r=t.addinCommand;return a.createElement(M,{renderInPanel:n,onDismiss:this.close,isDeepLink:Object(R.a)(),disableFirstFocus:this.isPersisted()},a.createElement(I,{iconUrl:r.extension.IconUrl,displayName:r.extension.DisplayName,closeOnClick:this.close,ref:function(t){return e.taskPaneHeader=t},isCalendar:this.isCalendar(),isPersistable:this.supportsPersisted(),isPersisted:this.isPersisted(),togglePersist:this.togglePersist}),a.createElement("div",{tabIndex:0,className:o()(F.extensionContainer,this.isCalendar()&&F.extensionContainerCalendar),"aria-label":Object(y.format)(c.a.extensionContainerAriaLabel,r.extension.DisplayName),role:"complementary"},this.renderError(),this.renderOsfHostContainer()))},t.prototype.supportsPersisted=function(){return Object(D.a)(this.props.instance.addinCommand)},t.prototype.isCalendar=function(){return this.props.instance.mode===k.a.AppointmentAttendee||this.props.instance.mode===k.a.AppointmentOrganizer},t.prototype.isPersisted=function(){return"Persistent"===this.props.type},t=r.__decorate([g.observer],t)}(a.Component),U=n(1284),B=n(2151),j=n(181),H="addinTaskPane";var V=n(168),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){if("Mail"===Object(V.a)()){var e=Object(N.q)().taskPanes;!this.previousTaskPanesSize&&e.size?(Object(U.a)(H,!0,!1),j.b.importAndExecute(),B.a.importAndExecute()):this.previousTaskPanesSize&&!e.size&&(Object(U.a)(H,!1,!1),j.b.importAndExecute()),this.previousTaskPanesSize=e.size}},t.prototype.renderTaskPane=function(e){var t=Object(N.y)(e);return t&&a.createElement(L,{key:t.controlId,type:e,instance:t,renderInPanel:this.props.renderTaskPaneInPanel})},t.prototype.render=function(){var e=Object(C.c)()&&this.renderTaskPane("Persistent"),t=this.renderTaskPane("NonPersistent");return a.createElement(a.Fragment,null,[e,t])},t=r.__decorate([g.observer],t)}(a.Component);t.a=W},3501:function(e,t,n){"use strict";var r=n(89),a=n(56),i="/ows/api/beta/PersistedAddins";function o(e,t,n){var o=Object(r.a)();Object(a.c)(i,{Addin:{mode:e,addinId:t,commandId:n}},o)}var s=n(0),c=n(190);function l(){return s.__awaiter(this,void 0,void 0,function(){var e,t;return s.__generator(this,function(n){switch(n.label){case 0:return e=Object(r.a)(),[4,Object(a.b)(i,e,!0)];case 1:return t=n.sent(),Object(c.a)(t.status)?[4,t.text()]:[3,3];case 2:return[2,n.sent()];case 3:return[2,"{}"]}})})}n.d(t,"b",function(){return o}),n.d(t,"a",function(){return l})},3513:function(e,t,n){"use strict";var r=n(0),a=n(2133),i=n(1909),o=function(e){Object(i.q)().activeDialog&&Object(i.q)().activeDialog.parentControlId==e&&Object(a.j)({eventDispId:a.a.DISPLAY_DIALOG_DISPID,controlId:e}),Object(i.C)(e)};function s(e){Object(i.q)().runningUILessAddinCommands.has(e)&&r.__spread(Object(i.q)().runningUILessAddinCommands.get(e).keys()).forEach(function(t,n){!function(e,t,n){o(e),Object(i.Z)(e,t,n)}(t,e,i.e.NavigatedBeforeCompleted)})}function c(e){s(e)}n.d(t,"a",function(){return c})},3520:function(e,t,n){"use strict";var r;!function(e){e.MailRead="MailRead",e.MailCompose="MailCompose",e.NoEndpoint=""}(r||(r={}));var a=r,i=n(161);function o(e){switch(e){case i.a.MessageRead:case i.a.MeetingRequest:return a.MailRead;case i.a.MessageCompose:return a.MailCompose;default:return a.NoEndpoint}}n.d(t,"a",function(){return o})},3593:function(e,t,n){"use strict";function r(e){var t=e&&e.Action;return t&&!!t.SourceLocation}function a(e){var t=e&&e.Action;return t&&!!t.FunctionName}function i(e){return!!e&&!!e.MenuItems}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i})},3594:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1909);function a(e,t){var n=Object(r.v)();Object(r.O)(n,e,t)}},3595:function(e,t,n){"use strict";var r=n(3),a=n(744),i=n(354),o=n(99),s=n(3878);t.a=function(e){return{iconType:a.IconType.Image,imageProps:{src:e,width:16,height:16,imageFit:o.ImageFit.contain,shouldFadeIn:!1},styles:{root:{width:"16px !important",height:"16px !important"}},imageErrorAs:function(e){return r.createElement(i.a,{className:s.fallbackIcon,iconName:"Photo2",iconType:a.IconType.Default})}}}},3596:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l});var r=n(3088),a=n(8),i=n.n(a),o=n(744),s=n(198);function c(){return{key:"AddinMarketplace",name:i.a.manageAddins,title:i.a.manageAddins,ariaLabel:i.a.manageAddins,iconProps:{iconName:"AddIn",iconType:o.IconType.default},itemType:s.a.Normal,onClick:function(){Object(r.a)()}}}function l(){return{key:"AddinMarketplaceDivider",displayName:"-",itemType:s.a.Divider,iconProps:{iconName:"AddIn",iconType:o.IconType.default},onClick:null}}},363:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(552),a=n.n(r),i=n(33),o=n.n(i),s=n(742),c=n.n(s);function l(e,t){var n;return c()({Path:o()({FieldURI:e}),Item:a()((n={},n[e]=t,n))})}},3634:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),a=n(184),i=n(2889);function o(e,t,n,o){var s="read/"+encodeURIComponent(e);Object(a.c)("calendar",s,r.__assign({},n,{entrySource:t}),i.a,!1,t)}},3835:function(e,t,n){"use strict";var r=n(839),a=n(4);t.a=Object(a.action)("showBccWell")(function(e){e.bccRecipientWell||(e.bccRecipientWell=Object(r.a)(e.findPeopleFeedbackManager,[]))})},3848:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateSubject")(function(e,t){e.subject=t,e.isDirty=!0})},3849:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("updateSubjectSelectionRange")(function(e,t,n){e.subjectViewState.selectionStart=t,e.subjectViewState.selectionEnd=n})},3851:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(697),a=n(474),i=n(1565),o=n(224);function s(e,t,n,s){return new Promise(function(c,l){var u=!1,d=Object(o.a)(e);try{var p=Object(r.h)([{name:t,url:n}]),f=Object(a.b)(e).inlineImagePlugin,m="HTML"!=e.bodyType?null:f.processInlineImageBeforeUpload.bind(f);Object(i.a)(p,e,{isInline:s,isHiddenInline:!0,shouldShare:!1},m,function(e,t){d(e,t),u||(u=!0,l({errorType:"UploadError",id:e}))},Object(o.c)(e),function(e){u||(u=!0,c(e.Id))})}catch(e){l({errorType:"UploadError"})}})}},3852:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(697),a=n(1565),i=n(224);function o(e,t,n,o){return new Promise(function(s,c){var l=!1,u=Object(i.a)(e),d=Object(r.g)([t],[n]);Object(a.a)(d,e,{isInline:o,isHiddenInline:!1,shouldShare:!1},null,function(e,t){u(e,t),l||(l=!0,c({errorType:"UploadError",id:e}))},Object(i.c)(e),function(e){l||(l=!0,s(e.Id))})})}},3853:function(e,t){
/*!
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var n,r;n=u||(u={}),r=function(){var e=!0;function t(){}return t.prototype.isMsAjaxLoaded=function(){var t="function",n="undefined";return!!(typeof Sys!==n&&typeof Type!==n&&Sys.StringBuilder&&typeof Sys.StringBuilder===t&&Type.registerNamespace&&typeof Type.registerNamespace===t&&Type.registerClass&&typeof Type.registerClass===t&&typeof Function._validateParams===t&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===t)&&e},t.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";i.OUtil.loadScript(t,e)},Object.defineProperty(t.prototype,"msAjaxError",{get:function(){var e=this;return null==e._msAjaxError&&e.isMsAjaxLoaded()&&(e._msAjaxError=Error),e._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxString",{get:function(){var e=this;return null==e._msAjaxString&&e.isMsAjaxLoaded()&&(e._msAjaxString=String),e._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxDebug",{get:function(){var e=this;return null==e._msAjaxDebug&&e.isMsAjaxLoaded()&&(e._msAjaxDebug=Sys.Debug),e._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:e,configurable:e}),t}(),n.MicrosoftAjaxFactory=r;var a=new u.MicrosoftAjaxFactory,i=i||{};!function(e){var t=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,r=0;r<n;r++){var a=this._internalStorage.key(r);0===a.indexOf(e)&&t.push(a)}}catch(e){}return t},e}();e.SafeStorage=t}(u||(u={})),i.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},i.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext"},i.OUtil=function(){var e="focus",t="on",n="configurable",r="writable",o="enumerable",s="",c="undefined",l=!1,d=!0,p=2147483647,f=null,m=-1,g=m,h="&_xdm_Info=",v="&_serializer_version=",y="_xdm_",b="#",_="class",S={},C=f,A=f,I=(new Date).getTime();function O(){var e=p*Math.random();return(e^=I^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function T(){if(!C){try{var e=window.sessionStorage}catch(t){e=f}C=new u.SafeStorage(e)}return C}function x(e){for(var t,n=[],r=[],a=e.length,i=0;i<a;i++)(t=e[i]).tabIndex?t.tabIndex>0?r.push(t):0===t.tabIndex&&n.push(t):n.push(t);return r=r.sort(function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=r.indexOf(e)-r.indexOf(t)),n}),[].concat(r,n)}return{set_entropy:function(e){if("string"==typeof e)for(var t=0;t<e.length;t+=4){for(var n=0,r=0;r<4&&t+r<e.length;r++)n=(n<<8)+e.charCodeAt(t+r);I^=n}else I^="number"==typeof e?e:p*Math.random();I&=p},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var r=e[n];try{r=JSON?JSON.stringify(r,function(e,t){return i.OUtil.isDate(this[e])?i.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+i.DDA.SettingsManager.DataJSONSuffix:t}):Sys.Serialization.JavaScriptSerializer.serialize(r),t[n]=r}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var r=e[n];try{r=JSON?JSON.parse(r,function(e,t){var n;return"string"==typeof t&&t&&t.length>6&&t.slice(0,5)===i.DDA.SettingsManager.DateJSONPrefix&&t.slice(m)===i.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,m))))?n:t}):Sys.Serialization.JavaScriptSerializer.deserialize(r,d),t[n]=r}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var r=window.document,a=S[e];if(a)a.loaded?t():a.pendingCallbacks.push(t);else{var i=r.createElement("script");i.type="text/javascript",a={loaded:l,pendingCallbacks:[t],timer:f},S[e]=a;var o=function(){a.timer!=f&&(clearTimeout(a.timer),delete a.timer),a.loaded=d;for(var e=a.pendingCallbacks.length,t=0;t<e;t++){a.pendingCallbacks.shift()()}},s=function(){delete S[e],a.timer!=f&&(clearTimeout(a.timer),delete a.timer);for(var t=a.pendingCallbacks.length,n=0;n<t;n++){a.pendingCallbacks.shift()()}};i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=f,o())}:i.onload=o,i.onerror=s,n=n||3e4,a.timer=setTimeout(s,n),i.setAttribute("crossOrigin","anonymous"),i.src=e,r.getElementsByTagName("head")[0].appendChild(i)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,t){var n=t[e.trim()];if(typeof n==c)throw a.msAjaxDebug.trace("invalid enumeration string:"+e),a.msAjaxError.argument("str");return n},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(g+=1).toString()},formatString:function(){var e=arguments;return e[0].replace(/{(\d+)}/gm,function(t,n){var r=parseInt(n,10)+1;return void 0===e[r]?"{"+n+"}":e[r]})},generateConversationId:function(){return[O(),O(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return y+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,h,t,l)},addSerializerVersionAsHash:function(e,t){return i.OUtil.addInfoAsHash(e,v,t,d)},addInfoAsHash:function(e,t,n,r){var a,i=(e=e.trim()||s).split(b),o=i.shift(),c=i.join(b);return a=r?[t,encodeURIComponent(n),c].join(s):[c,t,n].join(s),[o,b,a].join(s)},parseHostInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=i.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=i.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return i.OUtil.parseInfoWithGivenFragment(h,y,l,e,t)},parseSerializerVersion:function(e){var t=i.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=i.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(i.OUtil.parseInfoWithGivenFragment(v,"_serializer_version=",d,e,t))},parseInfoFromWindowName:function(e,t,n){try{var r=JSON.parse(t),a=r!=f?r[n]:f,o=T();if(!e&&o&&r!=f){var s=r[i.WindowNameItemKeys.BaseFrameName]+n;a?o.setItem(s,a):a=o.getItem(s)}return a}catch(e){return f}},parseInfoWithGivenFragment:function(e,t,n,r,a){var i=a.split(e),o=i.length>1?i[i.length-1]:f;n&&o!=f&&(o.indexOf("&")>=0&&(o=o.split("&")[0]),o=decodeURIComponent(o));var s=T();if(!r&&s){var c=window.name.indexOf(t);if(c>m){var l=window.name.indexOf(";",c);l==m&&(l=window.name.length);var u=window.name.substring(c,l);o?s.setItem(u,o):o=s.getItem(u)}}return o},getConversationId:function(){var e=window.location.search,t=f;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var t=e.split("$");return typeof t[1]==c&&(t=e.split("|")),typeof t[1]==c&&(t=e.split("%7C")),t},getXdmFieldValue:function(e,t){var n=s,r=i.OUtil.parseXdmInfo(t);if(r){var a=i.OUtil.getInfoItems(r);if(null!=a&&a.length>=3)switch(e){case i.XdmFieldName.ConversationUrl:n=a[2];break;case i.XdmFieldName.AppId:n=a[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:l},{name:"expectedProperties",type:Object,mayBeNull:l},{name:"callback",type:Function,mayBeNull:d}]);if(n)throw n;for(var r in t)if(n=Function._validateParameter(e[r],t[r],r))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),a.msAjaxDebug.trace(e))},outputDebug:function(e){typeof a!==c&&a.msAjaxDebug&&a.msAjaxDebug.trace&&a.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,r){for(var a in n=n||{},r){var i=r[a];null==n[i]&&(n[i]=d)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){for(var r in t=t||{})i.OUtil.defineNondefaultProperty(e,r,t[r],n);return e},defineEnumerableProperty:function(e,t,n){return i.OUtil.defineNondefaultProperty(e,t,n,[o])},defineEnumerableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[o])},defineMutableProperty:function(e,t,a){return i.OUtil.defineNondefaultProperty(e,t,a,[r,o,n])},defineMutableProperties:function(e,t){return i.OUtil.defineNondefaultProperties(e,t,[r,o,n])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),r=n.length,a=0;a<r;a++){var i=n[a],o=Object.getOwnPropertyDescriptor(e,i);o.get||o.set||(o.writable=t.writable||l),o.configurable=t.configurable||l,o.enumerable=t.enumerable||d,Object.defineProperty(e,i,o)}return e},mapList:function(e,t){var n=[];if(e)for(var r in e)n.push(t(e[r]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return d;return l},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return d;return l},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var r in t)n(r,t[r])},redefineList:function(e,t){for(var n in e)delete e[n];for(var r in t)e[r]=t[r]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,n,r){e.addEventListener?e.addEventListener(n,r,l):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent(t+n,r):e[t+n]=r},removeEventListener:function(e,n,r){e.removeEventListener?e.removeEventListener(n,r,l):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent(t+n,r):e[t+n]=f},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,s)},xhrGet:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,d),r.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,r){var a,i=t;try{(a=new XMLHttpRequest).onreadystatechange=function(){4==a.readyState&&(200==a.status?n(a,i):r(a.status))},a.open("GET",e,d),a.send()}catch(e){r(e)}},encodeBase64:function(e){if(!e)return e;var t,n,r,a,i,o,c,l=[],u=[],d=0,p=e.length;do{t=e.charCodeAt(d++),n=e.charCodeAt(d++),r=e.charCodeAt(d++),c=0,a=255&t,i=t>>8,o=255&n,u[c++]=a>>2,u[c++]=(3&a)<<4|i>>4,u[c++]=(15&i)<<2|o>>6,u[c++]=63&o,isNaN(n)||(a=n>>8,i=255&r,o=r>>8,u[c++]=a>>2,u[c++]=(3&a)<<4|i>>4,u[c++]=(15&i)<<2|o>>6,u[c++]=63&o),isNaN(n)?u[c-1]=64:isNaN(r)&&(u[c-2]=64,u[c-1]=64);for(var f=0;f<c;f++)l.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u[f]))}while(d<p);return l.join(s)},getSessionStorage:function(){return T()},getLocalStorage:function(){if(!A){try{var e=window.localStorage}catch(t){e=f}A=new u.SafeStorage(e)}return A},convertIntToCssHexColor:function(e){return"#"+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){if(Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:l},{name:"paramName",type:String,mayBeNull:l}]))return a.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),s;var n=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return n.test(e)?n.exec(e)[1]:(a.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),s)},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?d:l},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!i.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},shallowCopy:function(e){if(e==f)return f;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var r=e.constructor();for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);return r}return e},createObject:function(e){var t=f;if(e){t={};for(var n=e.length,r=0;r<n;r++)t[e[r].name]=e[r].value}return t},addClass:function(e,t){if(!i.OUtil.hasClass(e,t)){var n=e.getAttribute(_);n?e.setAttribute(_,n+" "+t):e.setAttribute(_,t)}},removeClass:function(e,t){if(i.OUtil.hasClass(e,t)){var n=e.getAttribute(_),r=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(r,s),e.setAttribute(_,n)}},hasClass:function(e,t){var n=e.getAttribute(_);return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(t,n){var r,a,i=l,o=function(){i=d},s=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(t=x(t),r=n?t.length-1:0,0===t.length)return f;for(;!i&&r>=0&&r<t.length;)a=t[r],window.focus(),a.addEventListener(e,o),a.focus(),a.removeEventListener(e,o),r=s(t.length,r,n),i||a!==document.activeElement||(i=d);return i?a:f},focusToNextTabbable:function(t,n,r){var a,i,o,s=l,c=function(){s=d},u=function(e,t,n){return t<0||t>e?m:0===t&&n?m:t!==e-1||n?n?t-1:t+1:m};if(a=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return m}(t=x(t),n),(i=u(t.length,a,r))<0)return f;for(;!s&&i>=0&&i<t.length;)(o=t[i]).addEventListener(e,c),o.focus(),o.removeEventListener(e,c),i=u(t.length,i,r),s||o!==document.activeElement||(s=d);return s?o:f}}}(),i.OUtil.Guid=function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var t="",n=(new Date).getTime(),r=0;r<32&&n>0;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[n%16],n=Math.floor(n/16);for(;r<32;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[Math.floor(16*Math.random())];return t}}}(),window.OSF=i,function(e){var t="\n",n=!0,r=null,i="undefined",o=function(){function e(){}return e.isInstanceOfType=function(e,t){if(typeof t===i||t===r)return!1;if(t instanceof e)return n;var a=t.constructor;return a&&"function"==typeof a&&a.__typeName&&"Object"!==a.__typeName||(a=Object),!(a!==e)||a.__typeName&&e.__typeName&&a.__typeName===e.__typeName},e}();e.MsAjaxTypeHelper=o;var s=function(){var e="Parameter name: {0}";function n(){}return n.create=function(e,t){var n=new Error(e);if(n.message=e,t)for(var r in t)n[r]=t[r];return n.popStackFrame(),n},n.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||"Parameter count mismatch."),r=n.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},n.argument=function(r,a){var i="Sys.ArgumentException: "+(a||"Value does not fall within the expected range.");r&&(i+=t+c.format(e,r));var o=n.create(i,{name:"Sys.ArgumentException",paramName:r});return o.popStackFrame(),o},n.argumentNull=function(r,a){var i="Sys.ArgumentNullException: "+(a||"Value cannot be null.");r&&(i+=t+c.format(e,r));var o=n.create(i,{name:"Sys.ArgumentNullException",paramName:r});return o.popStackFrame(),o},n.argumentOutOfRange=function(a,o,s){var l="Sys.ArgumentOutOfRangeException: "+(s||"Specified argument was out of the range of valid values.");a&&(l+=t+c.format(e,a)),typeof o!==i&&o!==r&&(l+=t+c.format("Actual value was {0}.",o));var u=n.create(l,{name:"Sys.ArgumentOutOfRangeException",paramName:a,actualValue:o});return u.popStackFrame(),u},n.argumentType=function(r,a,i,o){var s="Sys.ArgumentTypeException: ";s+=o||(a&&i?c.format("Object of type '{0}' cannot be converted to type '{1}'.",a.getName?a.getName():a,i.getName?i.getName():i):"Object cannot be converted to the required type."),r&&(s+=t+c.format(e,r));var l=n.create(s,{name:"Sys.ArgumentTypeException",paramName:r,actualType:a,expectedType:i});return l.popStackFrame(),l},n.argumentUndefined=function(r,a){var i="Sys.ArgumentUndefinedException: "+(a||"Value cannot be undefined.");r&&(i+=t+c.format(e,r));var o=n.create(i,{name:"Sys.ArgumentUndefinedException",paramName:r});return o.popStackFrame(),o},n.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e||"Operation is not valid due to the current state of the object."),r=n.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},n}();e.MsAjaxError=s;var c=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/gm,function(e,n){var r=parseInt(n,10);return void 0===t[r]?"{"+n+"}":t[r]})},e.startsWith=function(e,t){return e.substr(0,t.length)===t},e}();e.MsAjaxString=c;var l=function(){function e(){}return e.trace=function(){},e}();if(e.MsAjaxDebug=l,!a.isMsAjaxLoaded()){var u=function(e,t,n){void 0!==e.__typeName&&e.__typeName!==r||(e.__typeName=t),void 0!==e.__class&&e.__class!==r||(e.__class=n)};u(Function,"Function",n),u(Error,"Error",n),u(Object,"Object",n),u(String,"String",n),u(Boolean,"Boolean",n),u(Date,"Date",n),u(Number,"Number",n),u(RegExp,"RegExp",n),u(Array,"Array",n),Function.createCallback||(Function.createCallback=function(e,t){var r=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:n}]);if(r)throw r;return function(){var n=arguments.length;if(n>0){for(var r=[],a=0;a<n;a++)r[a]=arguments[a];return r[n]=t,e.apply(this,r)}return e.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(e,t){var r=Function._validateParams(arguments,[{name:"instance",mayBeNull:n},{name:"method",type:Function}]);if(r)throw r;return function(){return t.apply(e,arguments)}}),Function._validateParams||(Function._validateParams=function(e,t,n){var a,o=t.length;if(n=n||typeof n===i,a=Function._validateParameterCount(e,t,n))return a.popStackFrame(),a;for(var s=0,c=e.length;s<c;s++){var l=t[Math.min(s,o-1)],u=l.name;if(l.parameterArray)u+="["+(s-o+1)+"]";else if(!n&&s>=o)break;if(a=Function._validateParameter(e[s],l,u))return a.popStackFrame(),a}return r}),Function._validateParameterCount||(Function._validateParameterCount=function(e,t,a){var i,o,c=t.length,l=e.length;if(l<c){var u=c;for(i=0;i<c;i++){var d=t[i];(d.optional||d.parameterArray)&&u--}l<u&&(o=n)}else if(a&&l>c)for(o=n,i=0;i<c;i++)if(t[i].parameterArray){o=!1;break}if(o){var p=s.parameterCount();return p.popStackFrame(),p}return r}),Function._validateParameter||(Function._validateParameter=function(e,t,n){var a,o=t.type,s=!!t.integer,c=!!t.domElement,l=!!t.mayBeNull;if(a=Function._validateParameterType(e,o,s,c,l,n))return a.popStackFrame(),a;var u=t.elementType,d=!!t.elementMayBeNull;if(o===Array&&typeof e!==i&&e!==r&&(u||!d))for(var p=!!t.elementInteger,f=!!t.elementDomElement,m=0;m<e.length;m++){var g=e[m];if(a=Function._validateParameterType(g,u,p,f,d,n+"["+m+"]"))return a.popStackFrame(),a}return r}),Function._validateParameterType||(Function._validateParameterType=function(t,n,a,o,s,c){var l;return typeof t===i?s?r:((l=e.MsAjaxError.argumentUndefined(c)).popStackFrame(),l):t===r?s?r:((l=e.MsAjaxError.argumentNull(c)).popStackFrame(),l):n&&!e.MsAjaxTypeHelper.isInstanceOfType(n,t)?((l=e.MsAjaxError.argumentType(c,typeof t,n)).popStackFrame(),l):r}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++)n[t[r]]=n[t[r]]||{},n=n[t[r]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(e){({})}),typeof Sys===i&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){var e=this;if(0!==arguments.length)throw s.parameterCount();if(typeof e.stack!==i&&e.stack!==r&&typeof e.fileName!==i&&e.fileName!==r&&typeof e.lineNumber!==i&&e.lineNumber!==r){for(var n=e.stack.split(t),a=n[0],o=e.fileName+":"+e.lineNumber;typeof a!==i&&a!==r&&-1===a.indexOf(o);)n.shift(),a=n[0];var c=n[1];if(typeof c!==i&&c!==r){var l=c.match(/@(.*):(\d+)$/);typeof l!==i&&l!==r&&(e.fileName=l[1],e.lineNumber=parseInt(l[2]),n.shift(),e.stack=n.join(t))}}}),a.msAjaxError=s,a.msAjaxString=c,a.msAjaxDebug=l}}(u||(u={})),i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},i.SerializerVersion={MsAjax:0,Browser:1},function(e){(u||(u={})).appSpecificCheckOrigin=function(){return!1}}(),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=this,n=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(n)throw n;t._methodObjectList={},t._eventHandlerProxyList={},t._Id=e,t._conversations={},t._policyManager=null,t._appDomains={},t._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,r){var i="invokeType",o=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1},{name:"method",type:Function,mayBeNull:!1},{name:i,type:Number,mayBeNull:!1},{name:"blockingOthers",type:Boolean,mayBeNull:!1}]);if(o)throw o;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw a.msAjaxError.argument(i);var s=new Microsoft.Office.Common.MethodObject(t,n,r);this._methodObjectList[e]=s},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var r=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1},{name:"registerMethod",type:Function,mayBeNull:!1},{name:"unregisterMethod",type:Function,mayBeNull:!1}]);if(r)throw r;var a=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,!1),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,!1));this._methodObjectList[e]=a},registerEventEx:function(e,t,n,r,a){var i=!1,o=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:i},{name:"registerMethod",type:Function,mayBeNull:i},{name:"registerMethodInvokeType",type:Number,mayBeNull:i},{name:"unregisterMethod",type:Function,mayBeNull:i},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:i}]);if(o)throw o;var s=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,i),new Microsoft.Office.Common.MethodObject(r,a,i));this._methodObjectList[e]=s},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,r){var i="appDomains",o=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:!0},{name:i,type:Object,mayBeNull:!0,optional:!0},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(o)throw o;if(n){if(!(n instanceof Array))throw a.msAjaxError.argument(i);this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:r}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t="policyManager",n=Function._validateParams(arguments,[{name:t,type:Object,mayBeNull:!1}]);if(n)throw n;if(!e.checkPermission)throw a.msAjaxError.argument(t);this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){var e=null,t=this;t._methodObjectList=e,t._eventHandlerProxyList=e,t._Id=e,t._conversations=e,t._policyManager=e,t._appDomains=e,t._onHandleRequestError=e}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,r){var o="targetWindow",s=this,c=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:o,mayBeNull:!1},{name:"targetUrl",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(c)throw c;try{if(!t.postMessage)throw a.msAjaxError.argument(o)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw a.msAjaxError.argument(o)}s._conversationId=e,s._targetWindow=t,s._targetUrl=n,s._callingIndex=0,s._callbackList={},s._eventHandlerList={},s._serializerVersion=null!=r?r:i.SerializerVersion.Browser},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(a)throw a;var i=r._callingIndex++,o={callback:t,createdOn:(new Date).getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(o.timeout=n.__timeout__,delete n.__timeout__),r._callbackList[i]=o;try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,r._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}},registerForEvent:function(e,t,n,r){var a=this,i=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(i)throw i;var o=a._callingIndex++,s=new Date;a._callbackList[o]={callback:n,createdOn:s.getTime()};try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,a._conversationId,o,r),l=Microsoft.Office.Common.MessagePackager.envelope(c,a._serializerVersion);a._targetWindow.postMessage(l,a._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),a._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[o]}}},unregisterForEvent:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(a)throw a;var i=r._callingIndex++,o=new Date;r._callbackList[i]={callback:t,createdOn:o.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,r._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}finally{delete r._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e="serviceEndPointId",t=!0,n="channel is not ready.",r="conversationId",o="Unknown conversation Id.",s=!1,c=null,l=[],d=c,p=c,f=10,m=s,g=c,h=65e3,v={},y={},b=s;function _(e){for(var t in v)if(v[t]._conversations[e])return v[t];throw a.msAjaxDebug.trace(o),a.msAjaxError.argument(r)}function S(e){var t=y[e];return!t&&a.msAjaxDebug.trace(o),t}function C(e){l.push(e)}function A(){if(p!==c){if(!m)if(l.length>0){I(l.shift())}else clearInterval(p),p=c}else a.msAjaxDebug.trace(n)}function I(e){m=e.getInvokeBlockingFlag(),e.invoke(),d=(new Date).getTime()}function O(){if(g){var e,t,r=0,i=new Date;for(var o in y)for(var s in(e=y[o])._callbackList){var l=e._callbackList[s];if((t=l.timeout?l.timeout:h)>=0&&Math.abs(i.getTime()-l.createdOn)>=t)try{l.callback&&l.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,c)}finally{delete e._callbackList[s]}else r++}0===r&&(clearInterval(g),g=c)}else a.msAjaxDebug.trace(n)}function T(){m=s}function x(e,n){var r,a,i=s;return e===t?t:e&&n&&e.length&&n.length?(r=document.createElement("a"),a=document.createElement("a"),r.href=e,a.href=n,i=M(r,a),delete r,i):i}function E(e,t){var n=s;if(!(t&&t.length&&e&&e instanceof Array&&e.length))return n;var r=document.createElement("a"),a=document.createElement("a");r.href=t;for(var i=0;i<e.length&&!n;i++)-1!==e[i].indexOf("://")&&(a.href=e[i],n=M(r,a));return delete r,n}function M(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&e.port==t.port}function P(e){var n="Access Denied";if(i&&""!=e.data){var r,o=i.SerializerVersion.Browser,l=e.data;try{o=(r=Microsoft.Office.Common.MessagePackager.unenvelope(l,i.SerializerVersion.Browser))._serializerVersion!=c?r._serializerVersion:o}catch(e){return}if(r._messageType===Microsoft.Office.Common.MessageType.request){var g=e.origin==c||"null"==e.origin?r._origin:e.origin;try{var h=_(r._conversationId),v=h._conversations[r._conversationId];o=v.serializerVersion!=c?v.serializerVersion:o;var y=[v.url].concat(h._appDomains[r._conversationId]);if(!E(y,e.origin)&&!u.appSpecificCheckOrigin(y,e,r._origin,E))throw"Failed origin check";var b=h.getPolicyManager();if(b&&!b.checkPermission(r._conversationId,r._actionName,r._data))throw n;var O=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw a.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),a.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(h,r),M=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,g,r._actionName,r._conversationId,r._correlationId,T,o),P=new Microsoft.Office.Common.Invoker(O,r._data,M,h._eventHandlerProxyList,r._conversationId,r._actionName,o),k=t;p==c&&((d==c||(new Date).getTime()-d>f)&&!m?(I(P),k=s):p=setInterval(A,f)),k&&C(P)}catch(t){h&&h._onHandleRequestError&&h._onHandleRequestError(r,t);var R=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;t==n&&(R=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var w=new Microsoft.Office.Common.Response(r._actionName,r._conversationId,r._correlationId,R,Microsoft.Office.Common.ResponseType.forCalling,t),N=Microsoft.Office.Common.MessagePackager.envelope(w,o),D=s;try{D=!(!e.source||!e.source.postMessage)}catch(e){}D&&e.source.postMessage(N,g)}}else{if(r._messageType!==Microsoft.Office.Common.MessageType.response)return;var F=S(r._conversationId);if(!F)return;if(F._serializerVersion=o,!x(F._targetUrl,e.origin))throw"Failed orgin check";if(r._responseType===Microsoft.Office.Common.ResponseType.forCalling){var L=F._callbackList[r._correlationId];if(L)try{L.callback&&L.callback(r._errorCode,r._data)}finally{delete F._callbackList[r._correlationId]}}else{var U=F._eventHandlerList[r._actionName];void 0!==U&&U!==c&&U(r._data)}}}}function k(){b||(!function(e){if(window.addEventListener)window.addEventListener("message",e,s);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw a.msAjaxDebug.trace("Browser doesn't support the required API."),a.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(P),b=t)}return{connect:function(e,t,n,r){var a=y[e];return a||(k(),a=new Microsoft.Office.Common.ClientEndPoint(e,t,n,r),y[e]=a),a},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:s}]);if(t)throw t;return y[e]},createServiceEndPoint:function(e){k();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return v[e]=t,t},getServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;return v[t]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:r,type:String,mayBeNull:s}]);if(t)throw t;delete y[e]},deleteServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;delete v[t]},checkUrlWithAppDomains:function(e,t){return E(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:s}]);if(t)throw t;h=e<=0?65e3:e},_startMethodTimeoutTimer:function(){g||(g=setInterval(O,2e3))}}}(),Microsoft.Office.Common.Message=function(e,t,n,r,a){var i=this,o=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:!1},{name:"actionName",type:String,mayBeNull:!1},{name:"conversationId",type:String,mayBeNull:!1},{name:"correlationId",mayBeNull:!1},{name:"data",mayBeNull:!0,optional:!0}]);if(o)throw o;i._messageType=e,i._actionName=t,i._conversationId=n,i._correlationId=r,i._origin=window.location.href,i._data=void 0===a?null:a},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,r,a){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,r,a),this._actionType=t},i.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,r,a,i){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,i),this._errorCode=r,this._responseType=a},i.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=i.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,r,i,o,s){var c=!1,l=this,u=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(u)throw u;l._requesterWindow=e,l._requesterUrl=t,l._actionName=n,l._conversationId=r,l._correlationId=i,l._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,l._responseType=o;var d=l;l._send=function(e){try{var t=new Microsoft.Office.Common.Response(d._actionName,d._conversationId,d._correlationId,d._invokeResultCode,d._responseType,e),n=Microsoft.Office.Common.MessagePackager.envelope(t,s);d._requesterWindow.postMessage(n,d._requesterUrl)}catch(e){a.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,r,i,o,s){var c=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(c,e,t,n,r,i,Microsoft.Office.Common.ResponseType.forCalling,s),c._postCallbackHandler=o;var l=c;c._send=function(e,t){null!=t&&(l._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(l._actionName,l._conversationId,l._correlationId,l._invokeResultCode,l._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,s);l._requesterWindow.postMessage(r,l._requesterUrl),l._postCallbackHandler()}catch(e){a.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},i.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,r,a,i,o){var s=this,c=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:!1},{name:"paramValue",mayBeNull:!0},{name:"invokeCompleteCallback",mayBeNull:!1},{name:"eventHandlerProxyList",mayBeNull:!0},{name:"conversationId",type:String,mayBeNull:!1},{name:"eventName",type:String,mayBeNull:!1},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(c)throw c;s._methodObject=e,s._param=t,s._invokeCompleteCallback=n,s._eventHandlerProxyList=r,s._conversationId=a,s._eventName=i,s._serializerVersion=o},Microsoft.Office.Common.Invoker.prototype={invoke:function(){var e=this;try{var t;switch(e._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:e._methodObject.getMethod()(e._param,e._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:t=e._methodObject.getMethod()(e._param),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var n=e._createEventHandlerProxyObject(e._invokeCompleteCallback);t=e._methodObject.getMethod()(n.getSend(),e._param),e._eventHandlerProxyList[e._conversationId+e._eventName]=n.getSend(),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var r=e._eventHandlerProxyList[e._conversationId+e._eventName];t=e._methodObject.getMethod()(r,e._param),delete e._eventHandlerProxyList[e._conversationId+e._eventName],e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var a=e._createEventHandlerProxyObject(e._invokeCompleteCallback);e._methodObject.getMethod()(a.getSend(),e._invokeCompleteCallback.getSend(),e._param),e._eventHandlerProxyList[e._callerId+e._eventName]=a.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var i=e._eventHandlerProxyList[e._callerId+e._eventName];e._methodObject.getMethod()(i,e._invokeCompleteCallback.getSend(),e._param),delete e._eventHandlerProxyList[e._callerId+e._eventName]}}catch(t){e._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),e._invokeCompleteCallback.getSend()(t)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},i.OUtil.setNamespace("OSF",window),i.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},i.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614},i.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},i.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},i.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23},i.SharedConstants={NotificationConversationIdSuffix:"_ntf"},i.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},i.OfficeAppContext=function(e,t,n,r,a,i,o,s,c,l,u,d,p,f,m,g,h,v,y,b,_,S,C,A){var I=this;I._id=e,I._appName=t,I._appVersion=n,I._appUILocale=r,I._dataLocale=a,I._docUrl=i,I._clientMode=o,I._settings=s,I._reason=c,I._osfControlType=l,I._eToken=u,I._correlationId=d,I._appInstanceId=p,I._touchEnabled=f,I._commerceAllowed=m,I._appMinorVersion=g,I._requirementMatrix=h,I._hostCustomMessage=v,I._hostFullVersion=y,I._isDialog=!1,I._clientWindowHeight=b,I._clientWindowWidth=_,I._addinName=S,I._appDomains=C,I._dialogRequirementMatrix=A,I.get_id=function(){return this._id},I.get_appName=function(){return this._appName},I.get_appVersion=function(){return this._appVersion},I.get_appUILocale=function(){return this._appUILocale},I.get_dataLocale=function(){return this._dataLocale},I.get_docUrl=function(){return this._docUrl},I.get_clientMode=function(){return this._clientMode},I.get_bindings=function(){return this._bindings},I.get_settings=function(){return this._settings},I.get_reason=function(){return this._reason},I.get_osfControlType=function(){return this._osfControlType},I.get_eToken=function(){return this._eToken},I.get_correlationId=function(){return this._correlationId},I.get_appInstanceId=function(){return this._appInstanceId},I.get_touchEnabled=function(){return this._touchEnabled},I.get_commerceAllowed=function(){return this._commerceAllowed},I.get_appMinorVersion=function(){return this._appMinorVersion},I.get_requirementMatrix=function(){return this._requirementMatrix},I.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},I.get_hostCustomMessage=function(){return this._hostCustomMessage},I.get_hostFullVersion=function(){return this._hostFullVersion},I.get_isDialog=function(){return this._isDialog},I.get_clientWindowHeight=function(){return this._clientWindowHeight},I.get_clientWindowWidth=function(){return this._clientWindowWidth},I.get_addinName=function(){return this._addinName},I.get_appDomains=function(){return this._appDomains}},i.OsfControlType={DocumentLevel:0,ContainerLevel:1},i.ClientMode={ReadOnly:0,ReadWrite:1},i.OUtil.setNamespace("Microsoft",window),i.OUtil.setNamespace("Office",Microsoft),i.OUtil.setNamespace("Client",Microsoft.Office),i.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},i.OUtil.setNamespace("DDA",i),i.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},i.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},i.DDA.EventDescriptors={},i.DDA.ListDescriptors={},i.DDA.UI={},i.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},i.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147},i.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},i.Constants={FileVersion:"16.0.10908.10000",ThreePartsFileVersion:"16.0.10908",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",OmexConsentNotificationPage:"/client/consentnotification.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"https://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js",StringResourceFile:"osfruntime_strings.js"};var o,s,c=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)};!function(e){!function(e){var t="ov:Control",n="ov:SourceLocation",r="resid",a="ov:Description",i="ov:Title",o="bt:Image",s="ov:VersionOverrides",l="o:OfficeApp",u=null,d=function(){return function(e){this.name="AddinManifestError",this.message=this.name+": "+e}}(),p=function(){return function(e){this.name="AddinInternalError",this.message=e}}();function f(e,t){if(e==u)throw new d(t)}var m=function(){function e(e){var t="bt:String",n=this;n.Images={},n.Urls={},n.LongStrings={},n.ShortStrings={};var r=e.manifest._xmlProcessor.selectSingleNode(l),a=e.selectSingleNode(r,[s,"ov:Resources"]);n.parseCollection(e,e.selectChildNodes(o,a,["bt:Images"]),n.Images),n.parseCollection(e,e.selectChildNodes("bt:Url",a,["bt:Urls"]),n.Urls),n.parseCollection(e,e.selectChildNodes(t,a,["bt:LongStrings"]),n.LongStrings),n.parseCollection(e,e.selectChildNodes(t,a,["bt:ShortStrings"]),n.ShortStrings)}return e.prototype.parseCollection=function(e,t,n){for(var r=t.length,a=0;a<r;a++){var i=t[a];n[i.getAttribute("id")]=e.parseLocaleAwareSettingsAndGetValue(i)}},e}();e.ManifestResourceManager=m;var g=function(){function e(e,t,n,r){var a=this;a.hostType=e,a.formFactor=t,a.entitlement=n,a.manifest=r,a.resources=new m(a)}return e.prototype.parseIdRequired=function(e){var t=e.getAttribute("id");return f(t,"Id required"),t},e.prototype.parseLabel=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:Label",e);return t!=u?this.getShortString(t):u},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return f(t,"Label required"),t},e.prototype.parseRequiredSuperTip=function(e){var t=this.parseSuperTip(e);return f(t,"SuperTip required"),t},e.prototype.parseSuperTip=function(e){var t=this,n=u,r=t.manifest._xmlProcessor.selectSingleNode("ov:Supertip",e);if(r!=u){var o,s=r;f(r=t.manifest._xmlProcessor.selectSingleNode(i,s),"Title is necessary for SuperTip."),o=t.getShortString(r),f(r=t.manifest._xmlProcessor.selectSingleNode(a,s),"Description is necessary for SuperTip."),n={title:o,description:t.getLongString(r)}}return n},e.prototype.parseRequiredIcon=function(e){var t=this.parseIcon(e);return f(t,"Icon required"),t},e.prototype.parseIcon=function(e){var t=this.selectChildNodes(o,e,["ov:Icon"]),n=t.length;if(0==n)return u;for(var r={},a=0;a<n;a++){var i=t[a];r[i.getAttribute("size")]=this.getImageResource(i)}return r},e.prototype.parseChildControls=function(e,t,n){var r=this.manifest._xmlProcessor.selectNodes(e,t);return this.parseControls(r,n)},e.prototype.parseControls=function(e,t){for(var n=[],r=e.length,a=0;a<r;a++){var i=t(this,e[a]);f(i,"parser must return a control."),n.push(i)}return n},e.prototype.parseControlInGroup=function(t){var n,r=t.getAttribute(e.typeAttributeName);switch(r){case"Menu":n=new A;break;case"Button":n=new O(r);break;default:throw new d("Unsupported control type.")}return n.parse(this,t),n},e.prototype.parseMenuItem=function(e){var t=new T;return t.parse(this,e),t},e.prototype.parseLocaleAwareSettingsAndGetValue=function(e){var t=this,n={},r=e.getAttribute("DefaultValue");n[t.manifest._defaultLocale]=r,n[t.manifest._defaultLocale.toLocaleLowerCase()]=r;var a=t.manifest._xmlProcessor.selectNodes("bt:Override",e);if(a)for(var i=a.length,o=0;o<i;o++){var s=(e=a[o]).getAttribute("Locale"),c=e.getAttribute("Value");n[s]=c,n[s.toLocaleLowerCase()]=c}return t.manifest._getDefaultValue(n)},e.prototype.selectSingleNode=function(e,t){if(t==u)return e;for(var n=0;n<t.length&&(e=this.manifest._xmlProcessor.selectSingleNode(t[n],e))!=u;n++);return e},e.prototype.selectChildNodes=function(e,t,n){return(t=this.selectSingleNode(t,n))==u?[]:this.manifest._xmlProcessor.selectNodes(e,t)},e.prototype.getResourceByNode=function(e,t){var n=t.getAttribute(r),a=e[n];return f(a,"resid: "+n+" not found"),a},e.prototype.getImageResource=function(e){return this.getResourceByNode(this.resources.Images,e)},e.prototype.getUrlResource=function(e){return this.getResourceByNode(this.resources.Urls,e)},e.prototype.getLongString=function(e){return this.getResourceByNode(this.resources.LongStrings,e)},e.prototype.getShortString=function(e){return this.getResourceByNode(this.resources.ShortStrings,e)},e.typeAttributeName="xsi:type",e}();e.ParsingContext=g;var h=function(){function e(){}return e.buildControls=function(e,t){for(var n=t.length,r=0;r<n;r++){t[r].apply(e)}},e}(),v=function(){return function(e,t){this.functionFile=e,this.builder=t}}(),y=function(){function e(){}return e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor,r=n.selectSingleNode(i,t);f(r,"Title is necessary for GetStarted."),this.title=e.getShortString(r);var o=n.selectSingleNode(a,t);f(o,"Description is necessary for GetStarted."),this.description=e.getLongString(o);var s=n.selectSingleNode("ov:LearnMoreUrl",t);this.learnMoreUrl=e.getUrlResource(s)},e}(),b=function(){function e(e){this.type=e}return e.prototype.buildAction=function(){},e.prototype.parse=function(){},e}(),_=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return e.actionBuilder.buildShowTaskpane(this.sourceLocation,this.title,this.taskpaneId)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n);var r=t.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",n);r!=u&&(this.taskpaneId=r.firstChild.nodeValue),(r=t.manifest._xmlProcessor.selectSingleNode(i,n))!=u&&(this.title=t.getShortString(r))},t}(function(e){function t(){e.apply(this,arguments),this.title=u}return c(t,e),t.prototype.parse=function(e,t){var r=e.manifest._xmlProcessor.selectSingleNode(n,t);f(r,"SourceLocation is necessary for ShowTaskpane action"),this.sourceLocation=e.getUrlResource(r),e.manifest.addManifestUrl(this.sourceLocation)},t}(b)),S=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.buildAction=function(e){return f(e.functionFile,"Function file source url is necessary for ExecuteFunctionAction."),e.actionBuilder.buildCallFunction(e.functionFile,this.functionName,this.controlId)},t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",t);f(n,"FunctionName is necessary for ExecuteFunctionAction."),this.functionName=e.manifest._xmlProcessor.getNodeValue(n)},t}(b),C=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),A=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.apply=function(e){e.controlBuilder.startBuildMenu(this),h.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=t.parseRequiredIcon(n),r.superTip=t.parseRequiredSuperTip(n);var a=t.selectChildNodes("ov:Item",n,["ov:Items"]);r.children=t.parseControls(a,function(e,t){return e.parseMenuItem(t)})},t}(C),I=function(e){function t(t){e.call(this),this.controlType=t}return c(t,e),t.prototype.apply=function(e){var t=this,n=t.action.buildAction(e),r={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:n};t.applyControl(e,r)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=r.parseIcon(t,n),r.superTip=t.parseRequiredSuperTip(n);var a=t.manifest._xmlProcessor.selectSingleNode("ov:Action",n);f(a,"Action is necessary for itemControl.");var i,o=a.getAttribute(g.typeAttributeName);switch(o){case"ShowTaskpane":i=new _(o);break;case"ExecuteFunction":(i=new S(o)).controlId=r.id;break;default:throw new d("Unsupported action type.")}i.parse(t,a),r.actionType=o,r.action=i},t.prototype.applyControl=function(){throw new p("Not implemented method applyControl for ItemControl.")},t.prototype.parseIcon=function(e,t){return e.parseIcon(t)},t}(C),O=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addButton(t)},t.prototype.parseIcon=function(e,t){return e.parseRequiredIcon(t)},t}(I),T=function(e){function t(){e.call(this,"MenuItem")}return c(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addMenuItem(t)},t}(I),x=function(){function e(e){var t=this;t.label=u,t.isOfficeTab=!1,t.children=[],t.isOfficeTab=e}return e.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildTab(this);for(var t=this.children.length,n=0;n<t;n++){this.children[n].apply(e)}e.builder.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var n=this;n.id=e.parseIdRequired(t),n.isOfficeTab||(n.label=e.parseLabelRequired(t)),n.children=e.parseChildControls("ov:Group",t,function(e,t){var n=new E;return n.parse(e,t),n})},e}(),E=function(e){function n(){e.apply(this,arguments)}return c(n,e),n.prototype.parse=function(n,r){e.prototype.parse.call(this,n,r),this.icon=n.parseRequiredIcon(r),this.children=n.parseChildControls(t,r,function(e,t){return e.parseControlInGroup(t)})},n.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildGroup(this),h.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.ribbonBuilder},this.children),e.builder.ribbonBuilder.endBuildGroup()},n}(C),M=function(){function e(e){this.type=e,this.tabs=[]}return e.prototype.apply=function(e){if(this.type==e.builder.commandSurface)for(var t=this.tabs.length,n=0;n<t;n++){this.tabs[n].apply(e)}},e.prototype.parse=function(e,t){var n,r=e.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",t);r!=u&&((n=new x(!0)).parse(e,r),this.tabs.push(n));(r=e.manifest._xmlProcessor.selectSingleNode("ov:CustomTab",t))!=u&&((n=new x(!1)).parse(e,r),this.tabs.push(n))},e}(),P=function(){function e(){}return e.prototype.parse=function(e,n){this.id=e.parseIdRequired(n),this.children=e.parseChildControls(t,n,function(e,t){return e.parseControlInGroup(t)})},e.prototype.apply=function(e){e.controlBuilder.startBuildMenu({id:this.id,label:u,superTip:u}),h.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},e}(),k=function(){function e(e){this.type=e}return e.prototype.apply=function(e){this.type==e.builder.commandSurface&&h.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.contextMenuBuilder},this.children)},e.prototype.parse=function(e,t){this.children=e.parseChildControls("ov:OfficeMenu",t,function(e,t){var n=new P;return n.parse(e,t),n})},e}(),R=function(){function e(e){this.type=e}return e.prototype.apply=function(){},e.prototype.parse=function(e,t){var n=this,a=e.manifest._xmlProcessor.selectSingleNode("ov:Namespace",t);if(a&&(n.namespaceResId=a.getAttribute(r)),!n.namespaceResId)throw new d("Missing required <Namespace> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var i=e.manifest._xmlProcessor.selectSingleNode("ov:Script",t);if(i&&(n.scriptResId=n._parseSourceLocationResId(e,i)),!n.scriptResId)throw new d("Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var o=e.manifest._xmlProcessor.selectSingleNode("ov:Page",t);if(o&&(n.pageResId=n._parseSourceLocationResId(e,o)),!n.pageResId)throw new d("Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var s=e.manifest._xmlProcessor.selectSingleNode("ov:Metadata",t);if(s&&(n.metadataResId=n._parseSourceLocationResId(e,s)),!n.metadataResId)throw new d("Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.")},e.prototype._parseSourceLocationResId=function(e,t){var a=e.manifest._xmlProcessor.selectSingleNode(n,t);if(a)return a.getAttribute(r)},e}();e.CustomFunctionsExtensionPoint=R;var w=function(){function e(){var e=this;e.getStartedNode=u,e.functionFile=u,e.cacheableUrls=[],e.ExtensionPoints=[]}return e.prototype.cacheableResources=function(){return this.cacheableUrls},e.prototype.apply=function(e,t){var n=this;try{e.startApplyAddin({entitlement:n.extensionEntitlement,manifest:n.extensionManifest,startedNode:n.getStartedNode,overrides:{type:n.type,description:n.description}});for(var r=new v(n.functionFile,e),a=n.ExtensionPoints.length,i=0;i<a;i++){n.ExtensionPoints[i].apply(r)}e.endApplyAddin()}catch(e){throw e instanceof d&&t.setErrorMessageForAddin(n.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),e}},e.prototype.parse=function(e,t){var n=this;n.type=t.getAttribute(g.typeAttributeName);var r=e.manifest._xmlProcessor.selectSingleNode(a,t);r!=u&&(n.description=e.getLongString(r));for(var i=e.selectChildNodes("ov:Host",t,["ov:Hosts"]),o=u,s=i.length,c=0;c<s;c++){var l=i[c];if(l.getAttribute(g.typeAttributeName)==e.hostType){(o=e.manifest._xmlProcessor.selectSingleNode("ov:"+e.formFactor,l))==u&&(o=e.manifest._xmlProcessor.selectSingleNode("ov:AllFormFactors",l));break}}var p=e.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",o);p!=u&&(n.getStartedNode=new y,n.getStartedNode.parse(e,p)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",o))!=u&&(n.functionFile=e.getUrlResource(r),e.manifest.addManifestUrl(n.functionFile));var f=e.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",o);s=f.length;for(c=0;c<s;c++){var m,h=f[c],v=h.getAttribute(g.typeAttributeName);switch(v){case"Events":throw"Not Implemented";case"PrimaryCommandSurface":m=new M(v);break;case"ContextMenu":m=new k(v);break;case"CustomFunctions":m=new R(v);break;default:throw new d("Unsupported extension type.")}m.parse(e,h),n.ExtensionPoints.push(m)}var b=e.resources.Images;for(var _ in b)n.cacheableUrls.push(b[_]);n.extensionEntitlement=e.entitlement,n.extensionManifest=e.manifest},e}();e.VersionOverrides=w;var N=function(){function e(){}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(){},e}(),D=function(){function e(e,t){this.hostType=e,this.formFactor=t}return e.prototype.parseExtensions=function(e,t,n){try{var r=t._xmlProcessor.selectSingleNode(l),a=t._xmlProcessor.selectSingleNode(s,r);if(a==u)return new N;var i=new w;return i.parse(new g(this.hostType,this.formFactor,e,t),a),i}catch(t){throw t instanceof d&&n.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}},e}();e.AddinCommandsManifestParser=D}(e.Parser||(e.Parser={}))}(u||(u={})),function(e){var t=function(){function e(){}return e.createManifestForAddinAction=function(e,t,n,r){var a=null,o=new i.Manifest.ExtensionSettings,s=(i.FormFactor.Default,{}),c=e._UILocale.toLocaleLowerCase();s[c]=n,o._defaultHeight=a,o._defaultWidth=a,o._sourceLocations={},o._sourceLocations[c]=t;var l=e;return new i.Manifest.Manifest(function(e){e._xmlProcessor=l._xmlProcessor,e._displayNames=n!=a?s:l._displayNames,e._iconUrls=l._iconUrls,e._extensionSettings={formFactor:o},e._highResolutionIconUrls=l._highResolutionIconUrls,e._target=l._target,e._id=r!=a?r:l._id,e._version=l._version,e._providerName=l._providerName,e._idIssuer=l._idIssuer,e._alternateId=l._alternateId,e._defaultLocale=l._defaultLocale,e._signature=l._signature,e._capabilities=l._capabilities,e._hosts=l._hosts,e._descriptions=l._descriptions,e._appDomains=l._appDomains,e._permissions=l._permissions,e._requirements=l._requirements,e._webApplicationResource=l._webApplicationResource,e._webApplicationId=l._webApplicationId,e._webApplicationScopes=l._webApplicationScopes,e._webApplicationAuthorizations=l._webApplicationAuthorizations},l._UILocale)},e.cacheManifestForAction=function(e,t,n){i.OsfManifestManager.cacheManifest(t,n,e)},e.purgeManifestForAction=function(e,t){i.OsfManifestManager.purgeManifest(e,t)},e}();e.AddinCommandsManifestManager=t}(u||(u={})),function(e){var t="##UILessContainer##",n=null;e.AddinActionContextMap={},e.AutoShowTaskPaneControlIdMap={};var r={};!function(e){var t="ExclusiveForNew",n="ExclusiveForCur";e[e.Default=1]="Default",e[e[n]=2]=n,e[e[t]=3]=t}(e.CommandInvokeMode||(e.CommandInvokeMode={}));var a,o=e.CommandInvokeMode;!function(e){var t="ooeOperationNotSupported",n="ooeSuccess",r="ooeTimeout";e[e[r]=-1]=r,e[e[n]=0]=n,e[e[t]=5e3]=t}(a||(a={}));var s=function(){function o(e,t,n){this.contextProvider=e,this.manifest=n,this.entitlement=t}return o.prototype.buildShowTaskpane=function(e,t,n){return this.CreateManifestAndActivationContextForTaskpaneCommand(e,t,n)},o.prototype.buildCallFunction=function(e,t,n){return this.CreateManifestAndActivationContextForUILessCommand(e,t,n)},o.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,t,i){var o=function(e,t){t==a.ooeSuccess&&i!=n&&(r[i]=e)},s=function(e,t){var a=r[e];if(a==n)return!1;var i=t.getOsfControl(a);return i!=n&&(i._refresh(),!0)};return this.CreateManifestAndActivationContext(e,t,i,function(e,t,r,a){i!=n&&s(i,t),e.showTaskpane(r,a,o)})},o.prototype.CreateManifestAndActivationContext=function(t,r,a,o){var s=this,c=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,t,r,n);return function(t){var r=s.contextProvider.createActionContext(t,function(n,r){var l={assetId:s.entitlement.assetId+(a||t),appVersion:s.entitlement.appVersion,storeId:s.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane};c._inMemoryEToken=s.entitlement.eToken,e.AddinCommandsManifestManager.cacheManifestForAction(c,l.assetId,l.appVersion),o(n,r,l,c)});e.AddinActionContextMap[t]=r,e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]==n&&"Office.AutoShowTaskpaneWithDocument"==a&&(e.AutoShowTaskPaneControlIdMap[s.entitlement.assetId]=t)}},o.prototype.CreateManifestAndActivationContextForUILessCommand=function(r,o,s){var c=this,l=function(e,t){if(t==a.ooeSuccess){var n={source:{id:s}};d.invokeAppCommand(e,o,n,function(){})}},u=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,r,n,n);return function(n){var r=c.contextProvider.createActionContext(n,function(n){var r={assetId:c.entitlement.assetId+t,appVersion:c.entitlement.appVersion,storeId:c.entitlement.storeId,storeType:i.StoreType.InMemory,targetType:i.OsfControlTarget.TaskPane};e.AddinCommandsManifestManager.cacheManifestForAction(u,r.assetId,r.appVersion),n.createUILessSandbox(r,u,function(e,t){if(t==a.ooeSuccess)d.ensureOsfHostEntry(e,n);l(e,t)})});e.AddinActionContextMap[n]=r}},o}(),c=function(){function n(e,t){this.contextProvider=e,this.entitlement=t}return n.prototype.buildShowTaskpane=function(){var t=this;return function(n){delete e.AddinActionContextMap[n],e.AddinCommandsManifestManager.purgeManifestForAction(t.entitlement.assetId+n,t.entitlement.appVersion)}},n.prototype.buildCallFunction=function(){var n=this;return function(r){delete e.AddinActionContextMap[r],e.AddinCommandsManifestManager.purgeManifestForAction(n.entitlement.assetId+t,n.entitlement.appVersion)}},n}(),l=function(){function t(){}return t.createActionBuilder=function(e,t,n){return new s(e,t,n)},t.createDeleterActionBuilder=function(e,t){return new c(e,t)},t.bindAction=function(e,t){t(e)},t.retrieveActionContext=function(t){return e.AddinActionContextMap[t]},t.retrieveAutoShowTaskPaneControlIdMap=function(){return e.AutoShowTaskPaneControlIdMap},t}();e.DefaultControlActionBinder=l;var u=function(){function e(){this.invocationQueue={}}return e.prototype.invokeAppCommand=function(t,r,a,s,c){var l=this,u={dispid:i.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:l.osfControlId};u[0]=t,u[1]=r,u[2]=JSON.stringify(a),c=c||e.defaultTimeout;var d=a&&a.commandMode?a.commandMode:o.Default,p={args:u,onComplete:s,timeout:c,timeoutTimer:n},f=l.invocationQueue[r];f==n&&(f=[],l.invocationQueue[r]=f),!(d==o.ExclusiveForCur&&f.length>0)&&!(d==o.ExclusiveForNew&&f.length>1)&&f.push(p),1==f.length&&l.trySendInvocation(p)},e.prototype.invocationCompleted=function(e,t,r){var a=this,i=a;for(var o in a.invocationQueue){var s=a.invocationQueue[o],c=s[0];if(e==c.args[0]){if(s.length>1){s.splice(0,1);var l=s[0];window.setTimeout(function(){i.trySendInvocation(l)},0)}else delete a.invocationQueue[o];return c.timeoutTimer!=n&&(window.clearTimeout(c.timeoutTimer),c.timeoutTimer=n),void c.onComplete(t,r)}}},e.prototype.sendInvocations=function(e){var t=this;if(t.eventHandler=e,e!=n)for(var r in t.invocationQueue){var a=t.invocationQueue[r][0];t.sendInvocation(e,a)}},e.prototype.trySendInvocation=function(e){var t=this.eventHandler;t!=n&&this.sendInvocation(t,e)},e.prototype.sendInvocation=function(e,t){var n=this,r=t.args;e(r),t.timeoutTimer=window.setTimeout(function(){n.invocationTimeout(r[0])},t.timeout)},e.prototype.invocationTimeout=function(e){this.invocationCompleted(e,a.ooeTimeout,n)},e.prototype.disposeHost=function(){var e=this;for(var t in e.invocationQueue)return;e.host.disposeHost(e.osfControlId),e.onDisposed!=n&&e.onDisposed(e)},e.defaultTimeout=3e5,e}(),d=function(){var e="targetId",t="controlId",r="eventDispId";function o(){}return o.registerEvent=function(n,a,i){o.registerEventInternal(i[r],i[t],i[e],n,function(e){a&&a(0==e)})},o.unregisterEvent=function(n,a,i){o.unregisterEventInternal(i[r],i[t],i[e],n,function(e){a&&a(0==e)})},o.invokeAppCommand=function(e,t,n,r){var a=o.getOrCreateOsfHostEntry(e),i=o.getNextAppCommandId();a.invokeAppCommand(i,t,n,r)},o.invocationCompleted=function(e,t){var r=o.getOrCreateOsfHostEntry(e),a=t[0],i=t[1],s=t[2]?JSON.parse(t[2]):n;r.invocationCompleted(a,i,s)},o.ensureOsfHostEntry=function(e,t){var r=o.getOrCreateOsfHostEntry(e);return r.host==n&&(r.host=t),r},o.getNextAppCommandId=function(){return"AppCmd"+o._nextAppCommandId++},o.getOrCreateOsfHostEntry=function(e){var t=o._invocationQueues[e];return t==n&&((t=new u).osfControlId=e,t.onDisposed=function(e){delete o._invocationQueues[e.osfControlId]},o._invocationQueues[e]=t),t},o.registerEventInternal=function(e,t,n,r,s){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var c=o.getOrCreateOsfHostEntry(t);return s(a.ooeSuccess),void c.sendInvocations(r)}s(a.ooeOperationNotSupported)},o.unregisterEventInternal=function(e,t,r,s,c){switch(e){case i.DDA.EventDispId.dispidAppCommandInvokedEvent:var l=o.getOrCreateOsfHostEntry(t);return l.eventHandler==s&&(l.eventHandler=n),void c(a.ooeSuccess)}c(a.ooeOperationNotSupported)},o._nextAppCommandId=0,o._invocationQueues={},o}();e.AddinCommandsRuntimeManager=d}(u||(u={})),i.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen"},i.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},i.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},i.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},i.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},i.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},i.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){!function(e){var t="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function n(e){if("undefined"!=typeof JSON)try{return JSON.stringify(e)}catch(e){}return""}function r(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return o("Error happens in isInternetExplorer.",e),!1}}function o(e,t){a.msAjaxDebug.trace(e+" Exception details: "+n(t))}e.parseAppContextFromWindowName=function(e,t){return i.OUtil.parseInfoFromWindowName(e,t,i.WindowNameItemKeys.AppContext)},e.serializeObjectToString=n,e.isHostTrusted=function(){return new RegExp(t).test(i.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,r="#",a=(e=e.trim()||"").split(r),i=a.shift(),o=a.join(r),s=i.split("?");return s.length>1?n=i+"&_host_Info="+t:s.length>0&&(n=i+"?_host_Info="+t),o?[n,r,o].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3"],t=window.navigator.userAgent,n=0,a=e.length;n<a;n++)if(t.indexOf(e[n])>-1)return r();return!1}catch(e){return o("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=r,e.removeMatchesFromLocalStorage=function(e){for(var t=i.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),r=0,a=n.length;r<a;r++)for(var o=n[r],s=0,c=e.length;s<c;s++)if(e[s].test(o)){t.removeItem(o);break}},e.logExceptionToBrowserConsole=o;var s=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+"appinstall_authenticated.{0}.{1}.{2}.{3}",e.EntitlementsKey="entitle.{0}.{1}",e}();e.CacheConstants=s}(e.WACUtils||(e.WACUtils={}))}(u||(u={})),i.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64},i.Xpath3Provider=function(e,t){var n=this;n._xmldoc=(new DOMParser).parseFromString(e,"text/xml"),n._evaluator=new XPathEvaluator,n._namespaceMapping={},n._defaultNamespace=null;for(var r,a=t.split(" "),i=0;i<a.length;++i)(r=/xmlns="([^"]*)"/g.exec(a[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(a[i]))&&(n._namespaceMapping[r[1]]=r[2]);n._resolver=n},i.Xpath3Provider.prototype={lookupNamespaceURI:function(e){return this._namespaceMapping[e]||this._defaultNamespace},addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return r?r.singleNodeValue:null},selectNodes:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),a=[];if(r)for(var i=r.iterateNext();i;)a.push(i),i=r.iterateNext();return a},selectNodesByXPath:function(e,t){var n=this._evaluator.evaluate(e,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=[];if(n)for(var a=n.iterateNext();a;)r.push(a),a=n.iterateNext();return r},getDocumentElement:function(){return this._xmldoc.documentElement}},i.IEXpathProvider=function(e,t){for(var n=null,r=["MSXML2.DOMDocument.6.0"],o=0;o<r.length;o++)try{(n=new ActiveXObject(r[o])).setProperty("ResolveExternals",!1),n.setProperty("ValidateOnParse",!1),n.setProperty("ProhibitDTD",!0),n.setProperty("MaxXMLSize",i.XmlConstants.MaxXmlSize),n.setProperty("MaxElementDepth",i.XmlConstants.MaxElementDepth),n.async=!1,n.loadXML(e),n.setProperty("SelectionLanguage","XPath"),n.setProperty("SelectionNamespaces",t);break}catch(e){a.msAjaxDebug.trace("xml doc creating error:"+e)}this._xmldoc=n},i.IEXpathProvider.prototype={selectSingleNode:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectSingleNode(n)},addNamespaceMapping:function(e,t){var n="SelectionNamespaces",r=this._xmldoc.getProperty(n),a="xmlns:"+e+"=",i="xmlns:"+e+'="'+t+'"';return-1==r.indexOf(a)&&(r=r+" "+i,this._xmldoc.setProperty(n,r),!0)},selectNodes:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectNodes(n)},selectNodesByXPath:function(e,t){return t.selectNodes(e)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}},i.DomParserProvider=function(e,t){var n=this;try{n._xmldoc=(new DOMParser).parseFromString(e,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}n._namespaceMapping={},n._defaultNamespace=null;for(var r,a=t.split(" "),i=0;i<a.length;++i)(r=/xmlns="([^"]*)"/g.exec(a[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(a[i]))&&(n._namespaceMapping[r[1]]=r[2])},i.DomParserProvider.prototype={addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=t||this._xmldoc,r=this._selectNodes(e,n);return 0===r.length?null:r[0]},selectNodes:function(e,t){var n=t||this._xmldoc;return this._selectNodes(e,n)},selectNodesByXPath:function(){return null},_selectNodes:function(e,t){var n=[];if(!e)return n;var r,i,o=e.split(":");if(1===o.length)r=null,i=o[0];else{if(2!==o.length)throw a.msAjaxError.argument("name");r=this._namespaceMapping[o[0]],i=o[1]}if(!t.hasChildNodes)return n;for(var s=t.childNodes,c=0;c<s.length;c++)i===this._removeNodePrefix(s[c].nodeName)&&r===s[c].namespaceURI&&n.push(s[c]);return n},_removeNodePrefix:function(e){var t=e.split(":");return 1===t.length?e:t[1]},getDocumentElement:function(){return this._xmldoc.documentElement}},i.XmlProcessor=function(e,t){var n=this,r=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:!1},{name:"xmlNamespaces",type:String,mayBeNull:!1}]);if(r)throw r;document.implementation&&document.implementation.hasFeature("XPath","3.0")?n._provider=new i.Xpath3Provider(e,t):(n._provider=new i.IEXpathProvider(e,t),n._provider.getActiveXObject()||(n._provider=new i.DomParserProvider(e,t)))},i.XmlProcessor.prototype={addNamespaceMapping:function(e,t){var n=Function._validateParams(arguments,[{name:"namespacePrefix",type:String,mayBeNull:!1},{name:"namespaceUri",type:String,mayBeNull:!1}]);if(n)throw n;return this._provider.addNamespaceMapping(e,t)},selectSingleNode:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectSingleNode(e,t)},selectNodes:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectNodes(e,t)},selectNodesByXPath:function(e,t){var n=Function._validateParams(arguments,[{name:"xpath",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return t=t||this._provider.getDocumentElement(),this._provider.selectNodesByXPath(e,t)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.text?e.text:e.textContent},getNodeText:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return 9==this.getNodeType(e)?this.getNodeText(this.getDocumentElement()):e.text?e.text:e.textContent},setNodeText:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"text",type:String,mayBeNull:!1}]);if(n)throw n;if(9==this.getNodeType(e))return!1;try{e.text?e.text=t:e.textContent=t}catch(e){return!1}return!0},getNodeXml:function(e){var t,n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(n)throw n;return e.xml?t=e.xml:(t=(new XMLSerializer).serializeToString(e),2==this.getNodeType(e)&&(t=this.getNodeBaseName(e)+'="'+t+'"')),t},setNodeXml:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"xml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var a=r.getDocumentElement();try{e.parentNode.replaceChild(a,e)}catch(e){return null}return a},getNodeNamespaceURI:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.namespaceURI},getNodePrefix:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.prefix},getNodeBaseName:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return!e.nodeType||1!=e.nodeType&&2!=e.nodeType?e.nodeName:e.baseName?e.baseName:e.localName},getNodeType:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.nodeType},appendChild:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"childXml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new i.XmlProcessor(t,"");if(!r.isValidXml())return null;var a=r.getDocumentElement();return e.appendChild(a),a},_getAttributeLocalName:function(e){return e.localName?e.localName:e.baseName},readAttributes:function(e,t,n){var r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"attributesToRead",type:Object,mayBeNull:!1},{name:"objectToFill",type:Object,mayBeNull:!1}]);if(r)throw r;for(var a,i,o=0;o<e.attributes.length;o++)for(var s in a=e.attributes[o],i=this._getAttributeLocalName(a),t)i===s&&(n[t[s]]=a.value)},isValidXml:function(){var e="parsererror";if(null==this.getDocumentElement())return!1;if(this._provider._xmldoc.getElementsByTagName(e).length>0){var t=(new DOMParser).parseFromString("<","text/xml").getElementsByTagName(e)[0].namespaceURI;return this._provider._xmldoc.getElementsByTagNameNS(t,e).length<=0}return!0}},function(e){var t=function(){function e(){}return e.prototype.Serialize=function(e){try{return JSON.stringify(e)}catch(e){return null}},e.prototype.Deserialize=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();e.SafeSerializer=t;var n=function(){function e(e,t){this._localStorage=e,this._serializer=t}return e.prototype.GetCacheItem=function(t,n,r,a,i){var o="cacheExpired",s=this;void 0===n&&(n=!0),void 0===i&&(i=!0),s.ValidateCurrentCache();var c=s._localStorage.getItem(t);if(c){var l=s._serializer.Deserialize(c);if(void 0!==a&&a>0&&a-l.createdOn>0)s._localStorage.removeItem(t),r&&(r[o]=!0);else{if(!n)return l.data;var u=new Date;if(Math.abs(u.getTime()-l.createdOn)<e.msPerDay*l.refreshRate)return l.data;i&&(s._localStorage.removeItem(t),r&&(r[o]=!0))}}},e.prototype.SetCacheItem=function(t,n,r){r=r||e.defaultRefreshRateInDays;var a={data:n,createdOn:(new Date).getTime(),refreshRate:r};this._localStorage.setItem(t,this._serializer.Serialize(a))},e.prototype.RemoveCacheItem=function(e){this._localStorage.removeItem(e)},e.prototype.RemoveAll=function(e){for(var t=this._localStorage.getKeysWithPrefix(e),n=0,r=t.length;n<r;n++)this._localStorage.removeItem(t[n])},e.prototype.RemoveMatches=function(e){for(var t=this._localStorage.getKeysWithPrefix(""),n=0,r=t.length;n<r;n++)for(var a=t[n],i=0,o=e.length;i<o;i++)if(e[i].test(a)){this._localStorage.removeItem(a);break}},e.prototype.ValidateCurrentCache=function(){this._localStorage.getItem(e.cacheVersionKey)!=e.currentSchemaVersion&&(this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]),this._localStorage.setItem(e.cacheVersionKey,e.currentSchemaVersion))},e.defaultRefreshRateInDays=3,e.msPerDay=864e5,e.currentSchemaVersion="1",e.checkedCache=!1,e.cacheVersionKey="osfCacheVersion",e}();e.AppsDataCacheManager=n;var r=function(e){function t(t,n){e.call(this,t,n)}return c(t,e),t.prototype.GetRefreshToken=function(n,r){var a=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);return e.prototype.GetCacheItem.call(this,a)},t.prototype.AddRefreshToken=function(n,r,a){var o=i.OUtil.formatString(t._refreshTokenCacheKey,r,a);e.prototype.SetCacheItem.call(this,o,n)},t.prototype.RemoveAll=function(){e.prototype.RemoveAll.call(this,t._refreshTokenCachePrefixKey)},t.prototype.RemoveRefreshToken=function(n,r){var a=i.OUtil.formatString(t._refreshTokenCacheKey,n,r);e.prototype.RemoveCacheItem.call(this,a)},t._refreshTokenCacheKey="_OSF_PRIVATECATALOG_REFRESHTOKEN_{0}_{1}",t._refreshTokenCachePrefixKey="_OSF_PRIVATECATALOG_REFRESHTOKEN",t}(n);e.TokenCacheManager=r}(u||(u={})),function(e){var t="Error",n="ResponseTime",r="Result",a="OperationMetadata",i="ErrorResult",o="AssetId",s="CorrelationId",l=!0,u=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:l,configurable:l}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:l,configurable:l}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){null!=t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){var e=this;return e._serializedFields={},e.SetSerializedField("Table",e._table),e.SerializeFields(),JSON.stringify(e._serializedFields)},e}();e.BaseUsageData=u;var d=function(e){var t="Stage11Time",n="Stage10Time",r="Stage9Time",a="Stage8Time",u="Stage7Time",d="Stage6Time",p="Stage5Time",f="Stage4Time",m="Stage3Time",g="Stage2Time",h="Stage1Time",v="InstanceId",y="ActivationInfo",b="AppInfo";function _(){e.call(this,"AppLoadTime")}return c(_,e),Object.defineProperty(_.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,b,{get:function(){return this.Fields[b]},set:function(e){this.Fields[b]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,y,{get:function(){return this.Fields[y]},set:function(e){this.Fields[y]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,h,{get:function(){return this.Fields[h]},set:function(e){this.Fields[h]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,u,{get:function(){return this.Fields[u]},set:function(e){this.Fields[u]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),Object.defineProperty(_.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),_.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(b,e.AppInfo),e.SetSerializedField(y,e.ActivationInfo),e.SetSerializedField(v,e.InstanceId),e.SetSerializedField(o,e.AssetId),e.SetSerializedField(h,e.Stage1Time),e.SetSerializedField(g,e.Stage2Time),e.SetSerializedField(m,e.Stage3Time),e.SetSerializedField(f,e.Stage4Time),e.SetSerializedField(p,e.Stage5Time),e.SetSerializedField(d,e.Stage6Time),e.SetSerializedField(u,e.Stage7Time),e.SetSerializedField(a,e.Stage8Time),e.SetSerializedField(r,e.Stage9Time),e.SetSerializedField(n,e.Stage10Time),e.SetSerializedField(t,e.Stage11Time),e.SetSerializedField(i,e.ErrorResult)},_}(u);e.AppLoadTimeUsageData=d;var p=function(e){var t="NotificationClickInfo";function n(){e.call(this,"AppNotification")}return c(n,e),Object.defineProperty(n.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(n.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),Object.defineProperty(n.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),n.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(i,e.ErrorResult),e.SetSerializedField(t,e.NotificationClickInfo)},n}(u);e.AppNotificationUsageData=p;var f=function(e){function t(){e.call(this,"AppManagementMenu")}return c(t,e),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(o,e.AssetId),e.SetSerializedField(a,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(u);e.AppManagementMenuUsageData=f;var m=function(e){var t="LastActiveTabCount",n="LastActiveTab",r="DialogState",a="TrustPageSessionTime",i="TotalSessionTime";function s(){e.call(this,"InsertionDialogSession")}return c(s,e),Object.defineProperty(s.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(s.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),s.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(o,e.AssetId),e.SetSerializedField(i,e.TotalSessionTime),e.SetSerializedField(a,e.TrustPageSessionTime),e.SetSerializedField(r,e.DialogState),e.SetSerializedField(n,e.LastActiveTab),e.SetSerializedField(t,e.LastActiveTabCount)},s}(u);e.InsertionDialogSessionUsageData=m;var g=function(e){function t(){e.call(this,"UploadFileDevCatelog")}return c(t,e),Object.defineProperty(t.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(t.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(a,e.OperationMetadata),e.SetSerializedField(i,e.ErrorResult)},t}(u);e.UploadFileDevCatelogUsageData=g;var h=function(e){var t="AppSizeHeight",n="AppSizeWidth",r="IsAppCommand",a="AppTargetType",i="AppVersion",o="AppId",u="StoreType";function d(){e.call(this,"UploadFileDevCatalogUsage")}return c(d,e),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,u,{get:function(){return this.Fields[u]},set:function(e){this.Fields[u]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,i,{get:function(){return this.Fields[i]},set:function(e){this.Fields[i]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.CorrelationId),e.SetSerializedField(u,e.StoreType),e.SetSerializedField(o,e.AppId),e.SetSerializedField(i,e.AppVersion),e.SetSerializedField(a,e.AppTargetType),e.SetSerializedField(r,e.IsAppCommand),e.SetSerializedField(n,e.AppSizeWidth),e.SetSerializedField(t,e.AppSizeHeight)},d}(u);e.UploadFileDevCatalogUsageUsageData=h;var v=function(e){function a(){e.call(this,"OneDriveCatalogGetAccessToken")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(u);e.OneDriveCatalogGetAccessTokenUsageData=v;var y=function(e){function a(){e.call(this,"OneDriveCatalogGetManifests")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(u);e.OneDriveCatalogGetManifestsUsageData=y;var b=function(e){var a="id";function i(){e.call(this,"OneDriveCatalogGetManifest")}return c(i,e),Object.defineProperty(i.prototype,a,{get:function(){return this.Fields.id},set:function(e){this.Fields.id=e},enumerable:l,configurable:l}),Object.defineProperty(i.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(i.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(i.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),i.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(a,e.id),e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},i}(u);e.OneDriveCatalogGetManifestUsageData=b;var _=function(e){function a(){e.call(this,"OneDriveCatalogInsertManifest")}return c(a,e),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:l,configurable:l}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:l,configurable:l}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(u);e.OneDriveCatalogInsertManifestUsageData=_}(o||(o={})),function(e){var t=null;!function(e){var t="verboseEx",n="unexpected";e[e[n]=10]=n,e[e.warning=15]="warning",e[e.info=50]="info",e[e.verbose=100]="verbose",e[e[t]=200]=t}(e.ULSTraceLevel||(e.ULSTraceLevel={}));var n=e.ULSTraceLevel;!function(e){var t="msoulscat_Osf_UploadFileDevCatalogUsage",n="msoulscat_Osf_UploadFileDevCatelog",r="msoulscat_Osf_InsertionDialogSession",a="msoulscat_Osf_AppManagementMenu",i="msoulscat_Osf_Runtime",o="msoulscat_Osf_Notification",s="msoulscat_Osf_Latency";e[e[s]=1401]=s,e[e[o]=1402]=o,e[e[i]=1403]=i,e[e[a]=1404]=a,e[e[r]=1405]=r,e[e[n]=1406]=n,e[e[t]=1411]=t}(e.ULSCat||(e.ULSCat={}));var r,a,s=e.ULSCat;!function(e){var t="IsAnonymous",n="InsertionDialogClosed",r="ConfirmationDialogCancel";e[e[r]=256]=r,e[e[n]=512]=n,e[e[t]=1024]=t}(r||(r={})),function(e){var t="TrustPageVisited",n="Canceled",r="Inserted",a="Undefined";e[e[a]=0]=a,e[e[r]=1]=r,e[e[n]=2]=n,e[e.Closed=3]="Closed",e[e[t]=8]=t}(a||(a={}));var c=function(){function e(){this.timeValue=0}return e.prototype.Start=function(){this.timeValue=-(new Date).getTime(),this.finishedMeasurement=!1},e.prototype.Stop=function(){this.timeValue<0&&(this.timeValue+=(new Date).getTime(),this.finishedMeasurement=!0)},Object.defineProperty(e.prototype,"Finished",{get:function(){return this.finishedMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){var e=this.timeValue;return!this.Finished&&e<0&&(e=Math.abs(e)-(new Date).getTime()),e},enumerable:!0,configurable:!0}),e}();e.LatencyStopwatch=c;var l=function(){return function(){}}();e.Context=l;var u=function(){function e(){}return e.SendULSTraceTag=function(e,t,n,r){Microsoft.Office.WebExtension.FULSSupported&&Diag.UULS.trace(r,e,t,n)},e}(),d=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),6062431)},e.category=s.msoulscat_Osf_Notification,e.level=n.info,e}();e.NotificationLogger=d;var p=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085957)},e.category=s.msoulscat_Osf_AppManagementMenu,e.level=n.info,e}();e.AppManagementMenuLogger=p;var f=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085958)},e.category=s.msoulscat_Osf_UploadFileDevCatelog,e.level=n.info,e}();e.UploadFileDevCatelogLogger=f;var m=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17834653)},e.category=s.msoulscat_Osf_UploadFileDevCatalogUsage,e.level=n.info,e}();e.UploadFileDevCatalogUsageLogger=m;var g=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),4748055)},e.category=s.msoulscat_Osf_Latency,e.level=n.info,e}();e.LatencyLogger=g;var h=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){u.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085959)},e.category=s.msoulscat_Osf_InsertionDialogSession,e.level=n.info,e}();e.InsertionDialogSessionLogger=h;var v=function(){function e(){}return e.LogNotification=function(e,t,n){var r=new o.AppNotificationUsageData;r.CorrelationId=e,r.ErrorResult=t,r.NotificationClickInfo=n,d.Instance().LogData(r)},e}();e.AppNotificationHelper=v;var y=function(){function e(){}return e.LogAppManagementMenuAction=function(e,t,n,a,i,s){var c=new o.AppManagementMenuUsageData,l=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10);a&&(t|=r.InsertionDialogClosed),i&&(t|=r.IsAnonymous),c.AssetId=l,c.OperationMetadata=t,c.ErrorResult=s,p.Instance().LogData(c)},e}();e.AppManagementMenuHelper=y;var b=function(){function e(){}return e.LogUploadFileDevCatelogAction=function(e,t,n,r,a,i){var s=new o.UploadFileDevCatelogUsageData;s.CorrelationId=e,s.OperationMetadata=t,s.ErrorResult=i,f.Instance().LogData(s)},e}();e.UploadFileDevCatelogHelper=b;var _=function(){function e(){}return e.LogUploadFileDevCatalogUsageAction=function(e,t,n,r,a,i,s,c){var l=new o.UploadFileDevCatalogUsageUsageData;l.CorrelationId=e,l.StoreType=t,l.AppId=n,l.AppVersion=r,l.AppTargetType=a,l.IsAppCommand=i,l.AppSizeWidth=s,l.AppSizeHeight=c,m.Instance().LogData(l)},e}();e.UploadFileDevCatalogUsageHelper=_;var S=function(){var e="Stage11Time",r="Stage10Time",a="Stage9Time",i="Stage8Time",l="Stage7Time",d="Stage5Time",p="Stage4Time",f="Stage2Time",m="Stage1Time";function h(){}return h.GenerateActivationMessage=function(e,n){var r="";return e!=t&&(r+="ActivationRuntimeType: "+e.toString()+"|"),n!=t&&(r+="CorrelationId: "+n),r},h.ActivationStart=function(t,g,v,y,b,_){h.activatingNumber++,t.LoadTime=new o.AppLoadTimeUsageData,t.Timers={},t.LoadTime.CorrelationId=y,t.LoadTime.AppInfo=g,t.LoadTime.ActivationInfo=0,t.LoadTime.InstanceId=b,t.LoadTime.AssetId=v,t.LoadTime.Stage1Time=0,t.Timers[m]=new c,t.LoadTime.Stage2Time=0,t.Timers[f]=new c,t.LoadTime.Stage3Time=0,t.LoadTime.Stage4Time=0,t.Timers[p]=new c,t.LoadTime.Stage5Time=0,t.Timers[d]=new c,t.LoadTime.Stage6Time=h.activatingNumber,t.LoadTime.Stage7Time=0,t.Timers[l]=new c,t.LoadTime.Stage8Time=0,t.Timers[i]=new c,t.LoadTime.Stage9Time=0,t.Timers[a]=new c,t.LoadTime.Stage10Time=0,t.Timers[r]=new c,t.LoadTime.Stage11Time=0,t.Timers[e]=new c,t.LoadTime.ErrorResult=0,t.ActivationRuntimeType=_,h.StartStopwatch(t,m),u.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,h.GenerateActivationMessage(_,y),19515419)},h.ActivationEnd=function(e){h.ActivateEndInternal(e)},h.PageStart=function(e){h.StartStopwatch(e,f)},h.PageLoaded=function(e){h.StopStopwatch(e,f)},h.ServerCallStart=function(e){h.StartStopwatch(e,p)},h.ServerCallEnd=function(e){h.StopStopwatch(e,p)},h.AuthenticationStart=function(e){h.StartStopwatch(e,d)},h.AuthenticationEnd=function(e){h.StopStopwatch(e,d)},h.EntitlementCheckStart=function(e){h.StartStopwatch(e,l)},h.EntitlementCheckEnd=function(e){h.StopStopwatch(e,l)},h.KilledAppsCheckStart=function(e){h.StartStopwatch(e,i)},h.KilledAppsCheckEnd=function(e){h.StopStopwatch(e,i)},h.AppStateCheckStart=function(e){h.StartStopwatch(e,a)},h.AppStateCheckEnd=function(e){h.StopStopwatch(e,a)},h.ManifestRequestStart=function(e){h.StartStopwatch(e,r)},h.ManifestRequestEnd=function(e){h.StopStopwatch(e,r)},h.OfficeJSStartToLoad=function(t){h.StartStopwatch(t,e)},h.OfficeJSLoaded=function(t){h.StopStopwatch(t,e)},h.SetAnonymousFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,0)},h.SetRetryCount=function(e,t){h.SetActivationInfoField(e,t,3,2)},h.SetManifestTrustCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,5)},h.SetManifestDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,7)},h.SetOmexHasEntitlementFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,9)},h.SetManifestDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,11)},h.SetAppStateDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,13)},h.SetAppStateDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,15)},h.SetActivationRuntimeType=function(e,t){h.SetActivationInfoField(e,t,2,17)},h.SetErrorResult=function(e,t){e.LoadTime&&(e.LoadTime.ErrorResult=t,h.ActivateEndInternal(e))},h.SetBit=function(e,t,n,r){h.SetActivationInfoField(e,t,r||2,n)},h.StartStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Start(),h.UpdateActivatingNumber(e))},h.StopStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Stop(),h.UpdateActivatingNumber(e))},h.ConvertFlagToBit=function(e){return e?2:1},h.SetActivationInfoField=function(e,t,n,r){e.LoadTime&&(h.UpdateActivatingNumber(e),e.LoadTime.ActivationInfo=h.SetBitField(e.LoadTime.ActivationInfo,t,n,r))},h.SetBitField=function(e,t,n,r){return e&~(Math.pow(2,n)-1<<r)|t<<r},h.UpdateActivatingNumber=function(e){e.LoadTime&&(e.LoadTime.Stage6Time=e.LoadTime.Stage6Time>h.activatingNumber?e.LoadTime.Stage6Time:h.activatingNumber)},h.ActivateEndInternal=function(e){if(e.LoadTime){if(h.StopStopwatch(e,m),e.Timers)for(var r in e.Timers)e.Timers[r].ElapsedTime!=t&&(e.LoadTime[r]=e.Timers[r].ElapsedTime);u.SendULSTraceTag(s.msoulscat_Osf_Runtime,n.info,h.GenerateActivationMessage(e.ActivationRuntimeType,e.LoadTime.CorrelationId),19515420),g.Instance().LogData(e.LoadTime),e.LoadTime=t,h.activatingNumber--}},h.activatingNumber=0,h}();e.AppLoadTimeHelper=S;var C=function(){var e=" AppCorrelationId:";function r(){}return r.LogProxyFailure=function(e,a,o){var s;e==t&&(e=""),s=i.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",e,a),Object.keys(o).forEach(function(e){var n=o[e];n!=t&&(n=n.toString()),s+=", "+e+":"+n}),u.SendULSTraceTag(r.category,n.warning,s,6062432)},r.LogExceptionTag=function(a,i,o,s){var c=a;i&&(i.name&&(c+=" Exception name:"+i.name+"."),i.paramName&&(c+=" Param name:"+i.paramName+"."),i.message&&(c+=" Message:"+i.message+"."),i.stack&&(c+=" [Stack:"+i.stack+"]")),o!=t&&(c+=e+o+"."),u.SendULSTraceTag(r.category,n.warning,c,s)},r.LogCommonMessageTag=function(a,i,o){i!=t&&(a+=e+i+"."),u.SendULSTraceTag(r.category,n.info,a,o)},r.category=s.msoulscat_Osf_Runtime,r}();e.RuntimeTelemetryHelper=C;var A=function(){function e(){}return e.LogInsertionDialogSession=function(e,t,n,r,i,s){var c=new o.InsertionDialogSessionUsageData,l=0===e.toLowerCase().indexOf("wa")?parseInt(e.substring(2),10):parseInt(e,10),u=a.Undefined;u|=r?a.Inserted:a.Canceled,n>0&&(u|=a.TrustPageVisited),c.AssetId=l,c.TotalSessionTime=t,c.TrustPageSessionTime=n,c.DialogState=u,c.LastActiveTab=i,c.LastActiveTabCount=s,h.Instance().LogData(c)},e}();e.InsertionDialogSessionHelper=A}(s||(s={}));var l='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';i.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160"},i.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};var u;i.HostSpecificFileVersionDefault="16.00",i.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.02"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"}},i.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote"},i.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook",Mailbox:"Mailbox"},i.HostPlatform={Web:"Web"},i.getAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="excel.exe";break;case i.AppName.AccessWebApp:t="ZAC";break;case i.AppName.PowerpointWebApp:t="WAP";break;case i.AppName.WordWebApp:t="WAW";break;case i.AppName.OneNoteWebApp:t="WAO";break;default:throw a.msAjaxDebug.trace(n),n}return t},i.getModernAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case i.AppName.ExcelWebApp:t="WAC_Excel";break;case i.AppName.PowerpointWebApp:t="WAC_PowerPoint";break;case i.AppName.WordWebApp:t="WAC_Word";break;case i.AppName.OneNoteWebApp:t="WAC_OneNote";break;case i.AppName.OutlookWebApp:t="WAC_Outlook";break;default:throw a.msAjaxDebug.trace(n),n}return t},i.getManifestHostType=function(e){var t;switch(e){case i.HostType.Excel:t=i.ManifestHostType.Workbook;break;case i.HostType.Word:t=i.ManifestHostType.Document;break;case i.HostType.PowerPoint:t=i.ManifestHostType.Presentation;break;case i.HostType.OneNote:t=i.ManifestHostType.Notebook;break;case i.HostType.Outlook:t=i.ManifestHostType.Mailbox;default:throw a.msAjaxDebug.trace("Invalid host type."),"Invalid hostType."}return t},i.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook"},i.HostCapability={Excel:i.Capability.Workbook,Outlook:i.Capability.Mailbox,Access:i.Capability.Database,PowerPoint:i.Capability.Presentation,Word:i.Capability.Document,Sway:i.Capability.Sway,OneNote:i.Capability.Notebook},i.OsfControlTarget={Undefined:-1,InContent:0,TaskPane:1,Contextual:2},i.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131,ReadWriteDocument:135},i.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8},i.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6},i.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",Exchange:"exchange",FileSystem:"filesystem",Registry:"registry",InMemory:"inmemory",OneDrive:"onedrive",PrivateCatalog:"excatalog",HardCodedPreinstall:"hardcodedpreinstall",FirstParty:"firstparty",UploadFileDevCatalog:"uploadfiledevcatalog",Sdx:"sdxcatalog"},i.StoreTypeEnum={MarketPlace:0,Catalog:1,SPApp:2,Exchange:3,FileSystem:4,Registry:5,OneDrive:9,PrivateCatalog:10,HardCodedPreinstall:11,FirstParty:12,Sdx:14,UploadFileDevCatalog:15},i.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"},i.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15,UserIsMinor:16},i.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4},i.OmexTrialType={None:0,Office:1,External:2},i.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"},i.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3},i.OmexRemoveAppStatus={Failed:0,Success:1},i.OfficeAppType={ContentApp:i.OsfControlTarget.InContent,TaskPaneApp:i.OsfControlTarget.TaskPane,MailApp:i.OsfControlTarget.Contextual},i.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"},i.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"},i.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"},i.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"},i.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1},i.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2},i.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942},i.BWsaStreamTypes={Static:1},i.BWsaConfig={defaultMaxStreamRows:1e3},i.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR:-2147209295,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055,WAC_FirstPartyAddInListRequestFailure:1056,WAC_SSOAddinRequireConsent:1057},i.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10},i.OmexClientNames=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]="WAC_Excel",e[t.WordWebApp]="WAC_Word",e[t.OutlookWebApp]="WAC_Outlook",e[t.AccessWebApp]="WAC_Access",e[t.PowerpointWebApp]="WAC_Powerpoint",e[t.OneNoteWebApp]="WAC_OneNote",e}(),i.OmexAppVersions=function(){var e={},t=i.AppName;return e[t.ExcelWebApp]=i.AppVersion.excelwebapp,e[t.WordWebApp]=i.AppVersion.wordwebapp,e[t.OutlookWebApp]=i.AppVersion.outlookwebapp,e[t.AccessWebApp]=i.AppVersion.access,e[t.PowerpointWebApp]=i.AppVersion.powerpointwebapp,e[t.OneNoteWebApp]=i.AppVersion.onenotewebapp,e}(),i.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3},i.ManifestRequestTypes={Manifest:1,Etoken:2,Both:3},function(e){var t=null,n=function(){function e(){}return e.versionLessThan=function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},e.ParseManifest=function(e,n,r){try{return new i.Manifest.Manifest(e,n)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest:",e,r,20306078),t}},e}();e.ManifestUtil=n;var r=function(){function n(){}return n.failed=function(n,r,a){if(n.status!=e.DataServiceResultCode.Succeeded){var i={status:n.status,httpStatus:n.httpStatus};return a!=t&&(i.value=a),r(i),!0}return!1},n}();e.AsyncUtil=r;var a=function(){function e(){}return e.register=function(e,t){this._registry[e]=t},e.resolve=function(e,n){var r=this,a=r._resolved[e];if(a!=t)return a;if((n=n||r._hostInfo)!=t){var i=r._registry[e];if(i==t)return t;r._resolved[e]=a=i(n)}return a},e.setHostContext=function(e){this._hostInfo=e},e.getHostContext=function(){return this._hostInfo},e._registry={},e._resolved={},e}();e.CatalogFactory=a}(u||(u={})),function(e){var t=function(){function t(e){this._initParams=e}return t.prototype.getEntitlementAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAndCacheManifest=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed,httpStatus:404})},t.prototype.activateAsync=function(t,n){var r=this;r._initParams&&r._initParams.loaderParams?r._initParams.controlStatus===i.OsfControlStatus.ActivationFailed?n.fail(r._initParams.loaderParams,r._initParams.controlStatus):n.notifyUser(r._initParams.loaderParams):n.fail(e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveActivationError_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),i.OsfControlStatus.ActivationFailed)},t.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed,httpStatus:403})},t}();e.ForbiddenCatalog=t}(u||(u={})),function(e){var t=function(){var e=null;function t(){}return t.defaultTitle=function(e){switch(e){case i.InfoType.Information:return Strings.OsfRuntime.L_AgaveInformationTitle_TXT;case i.InfoType.Error:return Strings.OsfRuntime.L_AgaveErrorTile_TXT;case i.InfoType.Warning:return Strings.OsfRuntime.L_AgaveWarningTitle_TXT}return Strings.OsfRuntime.L_AgaveInformationTitle_TXT},t.fillMissing=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Information:n.infoType,n.title=n.title||t.defaultTitle(n.infoType),n.buttonTxt=n.buttonTxt||Strings.OsfRuntime.L_OkButton_TXT,n.buttonCallback=n.buttonCallback||e,n.url=n.url||e,n.urlButtonTxt=n.urlButtonTxt||e,n.dismissCallback=n.dismissCallback||e,n.reDisplay=!n.dismissCallback,n.displayDeactive=n.displayDeactive==e||n.displayDeactive,n.detailView=n.detailView||!1,n.logAsError=n.logAsError||!1,n.highPriority=n.highPriority||!1,n.retryAll=n.retryAll||!1,n.errorCode=n.errorCode?n.errorCode:0,n},t.error=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Error:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.warning=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?i.InfoType.Warning:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.showNotification=function(e,n){e.notifyUser(t.fillMissing(n))},t.showError=function(e,n){e.notifyUser(t.error(n))},t.showWarning=function(e,n){e.notifyUser(t.warning(n))},t.failWithWarning=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.warning(n),r)},t.failWithError=function(e,n,r){r=t.isNullOrUndefined(r)?i.OsfControlStatus.ActivationFailed:r,e.fail(t.error(n),r)},t.isNullOrUndefined=function(t){return t===e||void 0===t},t}();e.LoaderUtil=t}(u||(u={})),function(e){var t=function(){function t(e,t){this.osfControl=e,this.trusted=t}return t.prototype.getRequirementsChecker=function(){return this.osfControl._contextActivationMgr.getRequirementsChecker()},t.prototype.load=function(t,n){var r=null,a=this;a.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted&&(a.osfControl._retryActivate=r,a.osfControl._contextActivationMgr.retryAll(t.entitlement.assetId)),a.osfControl._status!==i.OsfControlStatus.NotActivated&&a.osfControl.deActivate();var o=t.manifest,s=a.osfControl;if(s._etoken=t.eToken,s._manifest=o,s._sourceLocationOverrideResourceId?s._iframeUrl=o.getSourceLocationOverrideByResourceId(s._sourceLocationOverrideResourceId):s._iframeUrl=o.getDefaultSourceLocation(s._contextActivationMgr.getFormFactor()),s.getStoreType()===i.StoreType.Sdx&&s._iframeUrl&&t.manifestUrl!==r){var c=t.manifestUrl.lastIndexOf("/");if(-1!==c){var l=t.manifestUrl.substr(0,c)+"/index.html";s.updateUrlsForSdxBundle(l)}}if(s._permission=o.getPermission(),s._appDomains=o.getAppDomains(),s.processManifestForCustomFunctions(o),n!=r&&(s._iframeUrl=n.decorateUrl(s._iframeUrl)),s._contextActivationMgr._doesUrlHaveSupportedProtocol(s._iframeUrl)){n!=r&&n.preLoad(s,s._contextActivationMgr);var u=o.getDefaultDisplayName();s._isAddinCommands(function(e){e&&(s._isvirtualOsfControl=!0,s.invokeVirtualOsfControlActivationCallback(o)),(!e||o.containsCustomFunctionsForAppHost(s._contextActivationMgr._hostType))&&s._createIframeAndActivateOsfControl(u)}),n!=r&&n.postLoad(s,s._contextActivationMgr)}else e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveManifestError_ERR,detailView:!0,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT})},t.prototype.skipTrust=function(){var e=this;return e.osfControl._contextActivationMgr._autoTrusted||e.osfControl.getTrustNoPrompt()||e.osfControl._isOsfControlInEmbeddingMode(e.osfControl)},t.prototype.hasConsent=function(){return this.trusted||this.isInsertion()},t.prototype.isInsertion=function(){return this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted},t.prototype.setRetryCall=function(e){this.osfControl._retryActivate=e},t.prototype.askForTrust=function(e,t){var n=this;this.osfControl._showTrustError(e.clientName,e.displayName,e.providerName,e.iconUrl,e.entitlement.storeType,function(){n.restartActivation(),t()},e.url,e.isSSOAddin)},t.prototype.askForUpgrade=function(e,t){var n=this;e.buttonCallback=function(){n.restartActivation(),t()},this.notifyUser(e)},t.prototype.askForConsentForSideloadAddin=function(e,t){var n=this;this.osfControl._manifest=e,this.osfControl._isAddinCommands(function(e){e?n.osfControl.showConsentError(t,i.NotificationType.ConsentWhiteDialog,!0):n.osfControl.showConsentError(t,i.NotificationType.ConsentYellowBar,!0)})},t.prototype.fail=function(e,t){var n=this.osfControl;n._status=t,this.notifyUser(e),n._contextActivationMgr.raiseOsfControlStatusChange(n)},t.prototype.notifyUser=function(e){var t=this.osfControl;e.id=t._id,t._contextActivationMgr.displayNotification(e)},t.prototype.restartActivation=function(){this.osfControl._restartActivate()},t.prototype.isForCustomFunctionSandbox=function(){return this.osfControl.isCustomFunctionSandbox()},t.prototype.setIsUpgrading=function(e){this.osfControl.setIsUpgrading(e)},t}();e.OsfControlLoader=t}(u||(u={})),function(e){var t=function(){function e(e){this._requirementsChecker=e}return e.prototype.getRequirementsChecker=function(){return this._requirementsChecker},e.prototype.load=function(){},e.prototype.skipTrust=function(){return!1},e.prototype.hasConsent=function(){return!1},e.prototype.setRetryCall=function(){},e.prototype.askForTrust=function(){},e.prototype.askForUpgrade=function(){},e.prototype.askForConsentForSideloadAddin=function(){},e.prototype.fail=function(){},e.prototype.notifyUser=function(){},e.prototype.restartActivation=function(){},e.prototype.isForCustomFunctionSandbox=function(){return!1},e.prototype.setIsUpgrading=function(){},e}();e.PreCacher=t}(u||(u={})),function(e){var t=function(){var t=null;function n(){var e=this;e.isReady=!1,e.clientEndPoint=t,e.pendingCallbacks=[],e.iframe=t,e._pendingRequests={},e.conversationId=i.OUtil.generateConversationId()}return n.prototype.invokeProxyCommandAsync=function(n,r,a){var i=this,o=r||r.correlationId||"";this.prepareProxy(function(c){c.value!=t?i.invokeProxyMethodAsync(n,a,r):(s.RuntimeTelemetryHelper.LogExceptionTag("clientendpoint is invalid",t,o,18940552),a({status:e.DataServiceResultCode.ProxyNotReady}))},function(){s.RuntimeTelemetryHelper.LogExceptionTag("proxysetup failure",t,o,18940553),a({status:e.DataServiceResultCode.ProxyNotReady})})},n.prototype.prepareProxy=function(){},n.prototype.doesUrlHaveSupportedProtocol=function(e){var n=!1;e&&(n=decodeURIComponent(e).match(/^https?:\/\/.+$/gi)!=t);return n},n.prototype.invokeProxyMethodAsync=function(n,r,a){var o,c=a||a.correlationId||"",l=[this.clientEndPoint._targetUrl,n];for(var u in a)("string"===(o=typeof a[u])||"number"===o||"boolean"===o)&&l.push(a[u]);var d=l.join("."),p=this._pendingRequests,f={onCompleted:r,methodName:n,correlationId:c},m=p[d];if(m)m.push(f);else{p[d]=[f];a||(a={}),a.officeVersion=i.Constants.ThreePartsFileVersion,this.clientEndPoint.invoke(n,function(n,r){var a=t,i=0,o=e.DataServiceResultCode.Failed;0===n&&r.status&&(a=r.result,o=e.DataServiceResultCode.Succeeded);var c=p[d];delete p[d];for(var l=c.length,u=0;u<l;u++){var f=c.shift();try{r&&r.failureInfo&&(i=r.failureInfo.statusCode||t,r.failureInfo.result=r.result,s.RuntimeTelemetryHelper.LogProxyFailure(f.correlationId,f.methodName,r.failureInfo)),f.onCompleted({status:o,httpStatus:i,value:a})}catch(t){var m="invokeProxyMethodAsync failed";e.WACUtils.logExceptionToBrowserConsole(m,t),s.RuntimeTelemetryHelper.LogExceptionTag(m,t,f.correlationId,19015124)}}},a)}},n}();e.ProxyBase=t}(u||(u={})),function(e){!function(e){var t="ManifestRequest",n="KilledAppsCheck",r="AppStateCheck",a="EntitlementCheck",i="Authentication",o="ServerCall",s="Activation";e[e[s]=0]=s,e[e[o]=1]=o,e[e[i]=2]=i,e[e[a]=3]=a,e[e[r]=4]=r,e[e[n]=5]=n,e[e[t]=6]=t}(e.Activity||(e.Activity={}));var t=e.Activity;!function(e){var t="DmsRequestCachedFlag",n="ManifestRequestType",r="ActivationRuntimeType",a="AppStateDataInvalidFlag",i="AppStateDataCachedFlag",o="ManifestDataInvalidFlag",s="OmexHasEntitlementFlag",c="ManifestDataCachedFlag",l="ManifestTrustCachedFlag",u="RetryCount",d="AnonymousFlag";e[e[d]=0]=d,e[e[u]=1]=u,e[e[l]=2]=l,e[e[c]=3]=c,e[e[s]=4]=s,e[e[o]=5]=o,e[e[i]=6]=i,e[e[a]=7]=a,e[e[r]=8]=r,e[e[n]=9]=n,e[e[t]=10]=t}(e.FlagName||(e.FlagName={}));var n=e.FlagName,r=function(){function r(e,t,n,r,a){var i=this;i.correlationId=e,i.perfContext=t,i.appInfo=n,i.assetId=r,i.instanceId=a}return r.prototype.startActivity=function(a){var o=this;switch(a){case t.Activation:var c=i.ActivationTypes.V2Enabled;return 0==(15&o.appInfo)&&e.S2SOmexCatalogService._requestHandler&&(c=i.ActivationTypes.V2S2SEnabled),s.AppLoadTimeHelper.ActivationStart(o.perfContext,o.appInfo,o.assetId,o.correlationId,o.instanceId,c),void o.setBits(n.ActivationRuntimeType,c)}s.AppLoadTimeHelper.StartStopwatch(o.perfContext,r.StopWatchName[a])},r.prototype.stopActivity=function(e){s.AppLoadTimeHelper.StopStopwatch(this.perfContext,r.StopWatchName[e])},r.prototype.setFlag=function(e,t){var n=t?2:1;this.setBits(e,n)},r.prototype.setBits=function(e,t){s.AppLoadTimeHelper.SetBit(this.perfContext,t,r.FlagOffsetMap[e],2)},r.FlagOffsetMap=[0,2,5,7,9,11,13,15,17,19,21],r.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"],r}();e.ActivationTelemetryContext=r;var a=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.AddinCommandsTelemetryContext=a;var o=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.InsertDialogTelemetryContext=o;var c=function(){function e(){}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.SimpleTelemetryContext=c}(u||(u={})),function(e){var t=null,n=function(){var n=".";function r(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return r.prototype.getEntitlementAsync=function(n,r,a){var o=this,s=o,c=[],l=[],u=n?o.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey():o.getUploadFileDevCatalogAddinsCacheKey(),d=o._cacheManager.GetCacheItem(u);d!=t&&(d.forEach(function(n){var r=s._cacheManager.GetCacheItem(s.getUploadFileDevCatalogManifestCacheKey(n));if(r!=t){var a=e.ManifestUtil.ParseManifest(r,s._initParam.appUILocale);if(a==t)return;var o={assetId:n,appVersion:a.getMarketplaceVersion(),storeId:"developer",storeType:i.StoreType.UploadFileDevCatalog,targetType:a.getTarget()};l.push(o),c.push(n)}}),c.length!=d.length&&(c.length>0?o._cacheManager.SetCacheItem(u,c):o._cacheManager.RemoveCacheItem(u))),a({status:e.DataServiceResultCode.Succeeded,value:l})},r.prototype.getAndCacheManifest=function(n,r,a,o){var s=i.OsfManifestManager.getCachedManifest(n.assetId,n.appVersion);if(s==t){if(s==t){var c=this._cacheManager.GetCacheItem(this.getUploadFileDevCatalogManifestCacheKey(n.assetId));c!=t&&(s=e.ManifestUtil.ParseManifest(c,this._initParam.appUILocale))!=t&&i.OsfManifestManager.cacheManifest(n.assetId,n.appVersion,s)}o({status:s!=t?e.DataServiceResultCode.Succeeded:e.DataServiceResultCode.Failed,value:s})}else o({status:e.DataServiceResultCode.Succeeded,value:s})},r.prototype.activateAsync=function(n,r,a){var o=this;this.getAndCacheManifest(n,n.storeId,a,function(s){if(s.status!=e.DataServiceResultCode.Succeeded)e.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE});else{var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(c&&c.enableSingleSignOnForAddin&&!r.isForCustomFunctionSandbox()){var l=s.value;if(l.isSSOAddin()){return void r.askForConsentForSideloadAddin(l,function(){r.load({entitlement:n,eToken:"",manifest:s.value},t)})}}r.load({entitlement:n,eToken:"",manifest:s.value},t)}})},r.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},r.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed})},r.prototype.validateAndCacheNewManifest=function(e,t,n,r){return!!this.validateAddinIdAndVersion(e,t)&&(this.cacheManifest(e,t,n,r),!0)},r.prototype.localCacheAddinCommands=function(e){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(),e)},r.prototype.validateAddinIdAndVersion=function(e,t){return r.idRegExp.test(e)&&r.versionRegExp.test(t)},r.prototype.cacheManifest=function(e,t,n,r){var a=this;i.OsfManifestManager.cacheManifest(e,t,r),a.cacheMyAddins(a.getUploadFileDevCatalogAddinsCacheKey(),e),a._cacheManager.SetCacheItem(a.getUploadFileDevCatalogManifestCacheKey(e),n)},r.prototype.cacheMyAddins=function(e,n){var r=this._cacheManager.GetCacheItem(e);r==t&&(r=[]),r.lastIndexOf(n)<0&&(r.push(n),this._cacheManager.SetCacheItem(e,r))},r.prototype.getUploadFileDevCatalogAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.myAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.addinCommandsMyAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogManifestCacheKey=function(e){return r.UploadFileCatalogCacheKey.manifest+n+this._initParam.appName+n+e},r.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.",r.UploadFileCatalogCacheKey={myAddins:r.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:r.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:r.UploadFileCatalogCacheKeyPrefix+"Manifest"},r.idRegExp=new RegExp("[\\w-]+"),r.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}"),r}();e.CatalogFactory.register(i.StoreType.UploadFileDevCatalog,function(r){return r.enableUploadFileDevCatalog?new n({appName:r.appName,appUILocale:r.appUILocale,userNameHashCode:r.userNameHashCode}):new e.ForbiddenCatalog(t)});var r=function(){var t="Should never here";function n(e,t){this._catalog=e,this._storeType=t}return n.prototype.validateAndCacheNewManifest=function(){throw t},n.prototype.getEntitlementsAsync=function(t,n,r,a){this._catalog.getEntitlementAsync(n,new e.AddinCommandsTelemetryContext(i.OUtil.Guid.generateNewGuid()),function(e){a(e.value)},!1,r)},n.prototype.getManifestAsync=function(){throw t},n.prototype.localCacheAddinCommands=function(e,t,n,r){this._storeType==i.StoreType.UploadFileDevCatalog&&this._catalog.localCacheAddinCommands(t,n,r)},n}(),a=function(){function n(){}return n.createAddinDataProvider=function(n){var a=e.CatalogFactory.resolve(n);return a==t?t:new r(a,n)},n}();e.AddinDataProviderFactory=a}(u||(u={})),function(e){!function(e){var t="Unauthenticated",n="UnknownUserType",r="ProxyNotReady",a="Succeeded";e[e[a]=1]=a,e[e.Failed=0]="Failed",e[e[r]=-1]=r,e[e[n]=2]=n,e[e[t]=3]=t}(e.DataServiceResultCode||(e.DataServiceResultCode={}));e.DataServiceResultCode}(u||(u={})),function(e){var t=function(){var t=null;function n(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return n.prototype.getEntitlementAsync=function(){throw new Error("in firstParty get Entitlementasync")},n.prototype.getAndCacheManifest=function(){throw new Error("in firstParty getAndCacheManifest")},n.prototype.removeAsync=function(){throw new Error("in firstParty removeAsync")},n.prototype.getAppDetails=function(){throw new Error("in firstParty getappDetails")},n.prototype.TryFallBackFirstPartyAddInList=function(n,r){s.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale 1st party add-ins list.",t,n.correlationId,34366471);var a=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!1);r(a?{status:e.DataServiceResultCode.Succeeded,value:a}:{status:e.DataServiceResultCode.Failed,value:t})},n.prototype.GetFirstyPartyAddInsInfo=function(n,r,a){var i=this,o=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1);if(o){var c={addInList:o,refreshRate:t};a({status:e.DataServiceResultCode.Succeeded,value:c})}else n.getFirstPartyAddInList(function(n){if(n.status==e.DataServiceResultCode.Succeeded){var o=t;try{o=e.OmexXmlProcessor.ProcessFirstPartyAddInList(n.value)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Problem parsing first party list.",e,r.correlationId,34366472),void i.TryFallBackFirstPartyAddInList(r,a)}i._cacheManager.SetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,o.addInList,o.refreshRate/e.CacheConsts.hourToDayConversionFactor),a({status:e.DataServiceResultCode.Succeeded,value:o})}else i.TryFallBackFirstPartyAddInList(r,a)})},n.prototype.TryFallBackFirstPartyManifest=function(n,r,a){s.RuntimeTelemetryHelper.LogExceptionTag("Falling back to stale manifest for: "+n,t,r.correlationId,34366473);var i=this.ReadFirstPartyManifestFromLocalStorage(r,n);a(i?{status:e.DataServiceResultCode.Succeeded,value:i}:{status:e.DataServiceResultCode.Failed,value:t})},n.prototype.ReadFirstPartyManifestFromLocalStorage=function(n,r){var a=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r),o=this._cacheManager.GetCacheItem(a,!1);return o?e.ManifestUtil.ParseManifest(o,this._initParam.appUILocale,n.correlationId):t},n.prototype.GetFirstPartyManifest=function(t,n,r,a){var o=this,s=i.OsfManifestManager.getCachedManifest(r.assetId,"");if(s||(s=this.ReadFirstPartyManifestFromLocalStorage(n,r.assetId))&&i.OsfManifestManager.cacheManifest(r.assetId,"",s),!s||i.OsfManifestManager.versionLessThan(s.getMarketplaceVersion(),r.version)){var c=i.OUtil.formatString("{0}/{1}",this._initParam.firstPartyManifestCDNUrl,r.path);t.getFirstPartyManifest(c,function(t){if(t.status==e.DataServiceResultCode.Succeeded){var s=e.ManifestUtil.ParseManifest(t.value,o._initParam.appUILocale,n.correlationId);if(s){i.OsfManifestManager.cacheManifest(r.assetId,"",s);var c=i.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r.assetId);o._cacheManager.SetCacheItem(c,t.value),a({status:e.DataServiceResultCode.Succeeded,value:s})}else o.TryFallBackFirstPartyManifest(r.assetId,n,a)}else o.TryFallBackFirstPartyManifest(r.assetId,n,a)})}else a({status:e.DataServiceResultCode.Succeeded,value:s})},n.prototype.getDataService=function(n,r){var a=this,i=a;if(a._dataService==t){var o={status:e.DataServiceResultCode.Failed,value:t},s=function(t,n){t.status==e.DataServiceResultCode.Succeeded?(i._dataService=n,o.value=n,o.status=e.DataServiceResultCode.Succeeded,r(o)):(o.httpStatus=t.httpStatus,r(o))},c=e.ProxyBasedCatalogService.getFirstPartyInstance(a._initParam);c.prepareProxy(n.correlationId,function(e){s(e,c)})}else r({status:e.DataServiceResultCode.Succeeded,value:a._dataService})},n.prototype.createActivityScope=function(t,n){var r=this;this.getDataService(t,function(a){if(!e.AsyncUtil.failed(a,n)){var i=a.value,o={cacheManager:r._cacheManager,cachePrefix:e.CacheConsts.anonymousCacheKeyPrefix,cid:i.getCID(),anonymous:!0,telemetryContext:t},s=i.createScope(o);n({status:e.DataServiceResultCode.Succeeded,value:s})}})},n.prototype.activateAsync=function(n,r,a){var o=this;a.startActivity(e.Activity.Activation),a.startActivity(e.Activity.ServerCall);var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),l=c&&c.enableFirstPartySDXErrorMessages;this.createActivityScope(a,function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Failed to create 1st party activity scope.",t,a.correlationId,34366474),void e.LoaderUtil.failWithError(r,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError});var u=c.value;o.GetFirstyPartyAddInsInfo(u,a,function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Failed get list of 1st party addIns.",t,a.correlationId,34366475),void e.LoaderUtil.failWithError(r,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});var d=c.value.addInList[n.assetId];if(!d)return s.RuntimeTelemetryHelper.LogExceptionTag("Could not find 1st party addin assetId in list: "+n.assetId,t,a.correlationId,34366476),void e.LoaderUtil.failWithError(r,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});a.startActivity(e.Activity.ManifestRequest),o.GetFirstPartyManifest(u,a,d,function(c){if(c.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Could not find get 1st party manifest: "+n.assetId,t,a.correlationId,34366477),void e.LoaderUtil.failWithError(r,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),o.activateAsync(n,r,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure});a.stopActivity(e.Activity.ManifestRequest),a.stopActivity(e.Activity.ServerCall);var u=c.value;r.load({entitlement:n,manifest:u,eToken:""},t)})})})},n}();e.FirstPartyCatalog=t,e.CatalogFactory.register(i.StoreType.FirstParty,function(n){if(n.osfOmexBaseUrl&&n.firstPartyManifestCDNUrl){var r,a=n.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);r=a>=0?n.osfOmexBaseUrl.substr(a):i.Constants.ProtocolSeparator+n.osfOmexBaseUrl;var o=i.Constants.Https+r;return new t({appName:n.appName,appUILocale:n.appUILocale,AppVersion:n.appVersion,clientMode:n.clientMode,docUrl:n.docUrl,omexBaseUrl:o,omexForceAnonymous:!0,firstPartyManifestCDNUrl:n.firstPartyManifestCDNUrl})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})})}(u||(u={})),function(e){var t=function(){var e="OMEX_clearCacheAsync",t="OMEX_removeCacheAsync",n="OMEX_getAppStateAsync",r="OMEX_getKilledAppsAsync",a="OMEX_getManifestAndETokenAsync";function i(){}return i.CheckProxyIsReady="OMEX_isProxyReady",i.Gated_GetManifestAndEToken=a,i.Gated_GetKilledApps=r,i.Gated_GetEntitlementSummary="OMEX_getEntitlementSummaryAsync",i.Gated_GetAppState=n,i.Gated_RemoveApp="OMEX_removeAppAsync",i.Gated_RemoveCache=t,i.Gated_ClearCache=e,i.UnGated_GetAppDetails="OMEX_getAppDetailsAsync",i.UnGated_GetRecommendations="OMEX_getRecommendationsAsync",i.UnGated_ClearCache=e,i.Anonymous_GetManifestAndEToken=a,i.Anonymous_GetKilledApps=r,i.Anonymous_GetAppState=n,i.Anonymous_RemoveCache=t,i.Anonymous_ClearCache=e,i.Anonymous_GetAuthNStatus="OMEX_getAuthNStatus",i.Anonymous_GetFirstPartyAddInList="OMEX_getFirstPartyAddInListAsync",i.Anonymous_GetFirstPartyManifest="OMEX_getFirstPartyManifestAsync",i}();e.OmexProxyMethods=t;var n=function(n){var r=null;function a(e){n.call(this),this.osfOmexBaseUrl=e}return c(a,n),a.prototype.prepareProxy=function(e,t,n){var i=this;n&&(i.isReady=!1,a.resetProxy(i)),i.isReady?e({status:r,value:{clientEndpoint:i.clientEndPoint}}):i.clientEndPoint?i.pendingCallbacks.push([e,t]):i.createProxy(e,t)},a.resetProxy=function(e){Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=r),e.clientEndPoint=r},a.prototype.createProxy=function(n,o){var c=this;try{!c.doesUrlHaveSupportedProtocol(c.proxyUrl)&&o({status:r,value:{errorMessage:"Protocal of proxyUrl is not supported."}});var l=document.createElement("iframe");l.setAttribute("id",c.proxyName),l.setAttribute("name",c.proxyName);var u=c.proxyUrl+"?"+c.conversationId;u=i.OUtil.addXdmInfoAsHash(u,c.conversationId+"|"+c.proxyName+"|"+window.location.href),u=i.OUtil.addSerializerVersionAsHash(u,i.SerializerVersion.Browser),l.setAttribute("src",u),l.setAttribute("scrolling","auto"),l.setAttribute("border","0"),l.setAttribute("width","0"),l.setAttribute("height","0"),l.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(l);var d=c,p=function(){if(d.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(d.conversationId,l.contentWindow,d.proxyUrl),d.clientEndPoint)d.clientEndPoint.invoke(t.CheckProxyIsReady,function(e,t){var n=d.pendingCallbacks.length;if(0!=n){var i=r;0===e&&t.status?(d.isReady=!0,i={status:r,value:{clientEndpoint:d.clientEndPoint}}):(a.resetProxy(d),i={status:r,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var o=0;o<n;o++){var s=d.pendingCallbacks.shift();d.isReady?s[0](i):s[1](i)}}},{__timeout__:500});else{var e="Unexpected error, iframe loaded again after failing OMEX_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,r,r,18121820),o({status:r,value:{errorMessage:e}})}i.OUtil.set_entropy((new Date).getTime())};i.OUtil.addEventListener(l,"load",p),c.iframeOnload=p,c.pendingCallbacks.push([n,o]),c.iframe=l}catch(t){var f="Error creating client endpoint with proxyUrl = ["+c.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);o({status:r,value:{errorMessage:f}})}},a}(e.ProxyBase);e.OmexProxyBase=n}(u||(u={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionAnonymousProxy",n.proxyUrl=n.osfOmexBaseUrl+"/anonymousserviceextension.aspx"}return c(n,t),n.prototype.getManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetManifestAndEToken,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),n(t)})},n.prototype.getFirstPartyAddInListAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyAddInList,t,function(e){n(e)})},n.prototype.getFirstPartyManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyManifest,t,function(e){n(e)})},n.prototype.getAppStateAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAppState,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),n(t)})},n.prototype.getKilledAppAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetKilledApps,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),n(t)})},n.prototype.getAuthNStatusAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAuthNStatus,t,n)},n}(e.OmexProxyBase);e.AnonymousOmexProxy=t}(u||(u={})),function(e){var t=function(t){var n=null;function r(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionGatedProxy",n.proxyUrl=n.osfOmexBaseUrl+"/gatedserviceextension.aspx"}return c(r,t),r.prototype.getOmexEntitlementsAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetEntitlementSummary,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertEntitlementInfo(t.value)),r(t)})},r.prototype.getManifestAndETokenAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetManifestAndEToken,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),r(t)})},r.prototype.getAppStateAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetAppState,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),r(t)})},r.prototype.getKilledAppAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetKilledApps,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),r(t)})},r.prototype.removeApps=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_RemoveApp,t,function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertRemoveAppResponse(t.value)),r(t)})},r}(e.OmexProxyBase);e.GatedOmexProxy=t}(u||(u={})),function(e){var t,n="",r=null;!function(e){var t="AnonymousUser",n="AuthedUser",r="NotDetected";e[e[r]=0]=r,e[e[n]=1]=n,e[e[t]=2]=t}(t||(t={}));var a=function(){function a(n){var r=this;r.currentUserType=t.NotDetected,r.omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,r.omexAuthConnectTries=1,r.initParams=n,r.gatedProxy=new e.GatedOmexProxy(n.omexBaseUrl),r.ungatedProxy=new e.UnGatedOmexProxy(n.omexBaseUrl),r.anonymousProxy=new e.AnonymousOmexProxy(n.omexBaseUrl)}return a.getInstance=function(e){return a._instance==r&&(a._instance=new a(e)),a._instance},a.getFirstPartyInstance=function(e){if(a._firstPartyInstance==r){var t=new a(e);t._isFirstParty=!0,t.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,this._firstPartyInstance=t}return a._firstPartyInstance},a.prototype.prepareProxy=function(a,i){var o=this;a=a||n;this.ensureOmexProxySetUp(a,function(n){var a;n&&n.status!=r?n.status:e.DataServiceResultCode.ProxyNotReady;n&&n.value&&(o._isFirstParty?a=!0:n.value.currentUserType&&(n.value.currentUserType==t.AuthedUser?a=!1:n.value.currentUserType==t.AnonymousUser&&(a=!0))),i({status:n.status,value:{anonymous:a}})})},a.prototype.createScope=function(e){return new c(e,this)},a.prototype.getCID=function(){switch(this.currentUserType){case t.AuthedUser:return this._cid;case t.AnonymousUser:return n}throw"not initialized"},a.prototype.ensureOmexProxySetUp=function(n,a){var o=this;if(o.currentUserType==t.NotDetected||!o.anonymousProxy.isReady&&!o.gatedProxy.isReady){var c=o,l=function(){c.currentUserType=t.AuthedUser,a({status:e.DataServiceResultCode.Succeeded,value:c})},u=function(){c.omexAuthConnectTries<i.Constants.AuthenticatedConnectMaxTries?(c.omexAuthConnectTries++,c.omexAuthNStatus!==i.OmexAuthNStatus.CheckFailed?c.anonymousProxy.prepareProxy(d,f):c.gatedProxy.prepareProxy(l,u)):(s.RuntimeTelemetryHelper.LogExceptionTag("exceed maximum tries and fail",r,n,18657693),c.anonymousProxy.prepareProxy(p,f))},d=function(e){if(e&&e.value){c.anonymousProxy.getAuthNStatusAsync({correlationId:n},function(e){if(e.status===i.ProxyCallStatusCode.Succeeded){var t=e.value;t==i.OmexAuthNStatus.Authenticated?(c.omexAuthNStatus=i.OmexAuthNStatus.Authenticated,c.gatedProxy.prepareProxy(l,u)):t!=i.OmexAuthNStatus.Anonymous&&t!=i.OmexAuthNStatus.Unknown||(c.omexAuthNStatus=i.OmexAuthNStatus.Anonymous,c.anonymousProxy.prepareProxy(p,f))}else s.RuntimeTelemetryHelper.LogExceptionTag("auth check failure.",r,n,18657694),c.omexAuthNStatus=i.OmexAuthNStatus.CheckFailed,c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(p,f):c.gatedProxy.prepareProxy(l,u)})}else s.RuntimeTelemetryHelper.LogExceptionTag("GetAuthNStatus callback param invalid",r,n,18657695)},p=function(n){c.omexAuthNStatus==i.OmexAuthNStatus.NotAttempted?d(n):(c.currentUserType=t.AnonymousUser,a({status:e.DataServiceResultCode.Succeeded,value:c}))},f=function(){s.RuntimeTelemetryHelper.LogExceptionTag("create anonymous proxy failure",r,n,18657696),a({status:e.DataServiceResultCode.ProxyNotReady})};c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(p,f):c.gatedProxy.prepareProxy(l,u)}else a({status:e.DataServiceResultCode.Succeeded,value:o})},a}();e.ProxyBasedCatalogService=a;var o=function(){function e(){}return e.dummyApplicationName="unused",e}(),c=function(){var a="contentMarket",c="assetID",u="applicationName",d="errors";function p(e,t){var r=this;r._build=i.Constants.FileVersion,r._catalogService=t,r._appVersion=i.OmexAppVersions[r._catalogService.initParams.appName],r._clientName=i.OmexClientNames[r._catalogService.initParams.appName],r._clientVersion=l.getClientVersionFromWACAppVersion(r._catalogService.initParams.AppVersion),r._correlationId=e.telemetryContext.correlationId||n}return p.prototype.getFirstPartyAddInList=function(e){var t=this.buildOmexRequestParameters();t[d]={},this._catalogService.anonymousProxy.getFirstPartyAddInListAsync(t,e)},p.prototype.getFirstPartyManifest=function(e,t){var n=this.buildOmexRequestParameters();n[d]={},n.manifestUrl=e,this._catalogService.anonymousProxy.getFirstPartyManifestAsync(n,t)},p.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},p.prototype.isUserTypeValid=function(e){return e!==t.NotDetected||(s.RuntimeTelemetryHelper.LogExceptionTag("userType is invalid.",r,this._correlationId,18657698),!1)},p.prototype.getEntitlementAsync=function(n,r,a){var i=this,s=i,c=i.buildOmexRequestParameters();c[u]=o.dummyApplicationName,c.appVersion=i._appVersion,c.clearEntitlement=a||!1;var l=i._catalogService.currentUserType;i.isUserTypeValid(l)?l===t.AuthedUser?i._catalogService.gatedProxy.getOmexEntitlementsAsync(c,function(e){s.tryFail(e.status,e.httpStatus,r)||(s._catalogService._cid=e.value.cid,r(e))}):l===t.AnonymousUser&&r({status:e.DataServiceResultCode.Succeeded,value:{refreshRate2:0,entitlements:[]}}):r({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,entitlements:[]}})},p.prototype.getLastStoreUpdate=function(){},p.prototype.isStoreDisabled=function(t){t({status:e.DataServiceResultCode.Succeeded,value:!1})},p.prototype.getManifest=function(t,r,a){this.getETokenAndManifestInternal(t,r,i.ClientAppInfoReturnType.urlOnly,function(t){var r=t&&t.value&&t.value.manifest?t.value.manifest:n,o=t&&t.value&&t.value.status2?t.value.status2:i.OmexClientAppStatus.ServerError,s=t?t.status:e.DataServiceResultCode.Failed;a({status:s,value:{status2:o,manifest:r}})})},p.prototype.getEToken=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.etokenOnly,n)},p.prototype.getETokenAndManifest=function(e,t,n){this.getETokenAndManifestInternal(e,t,i.ClientAppInfoReturnType.both,n)},p.prototype.getAppState=function(r,i){var o=this,s=o,l=o.buildOmexRequestParameters();l[c]=r.assetId,l[a]=r.storeId,l[d]={};var u=o._catalogService.currentUserType;o.isUserTypeValid(u)?u===t.AuthedUser?o._catalogService.gatedProxy.getAppStateAsync(l,function(e){s.tryFail(e.status,e.httpStatus,i)?s.logServiceCallResponseError("appstate",e.httpStatus):i(e)}):u===t.AnonymousUser&&o._catalogService.anonymousProxy.getAppStateAsync(l,i):i({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,assetId:n,productId:n,version:n,state2:-1}})},p.prototype.getKilledApps=function(n){var a=this,i=a,o=a.buildOmexRequestParameters(),s=a._catalogService.currentUserType;a.isUserTypeValid(s)?s===t.AuthedUser?a._catalogService.gatedProxy.getKilledAppAsync(o,function(e){i.tryFail(e.status,e.httpStatus,n)?i.logServiceCallResponseError("killedapps",e.httpStatus):n(e)}):s===t.AnonymousUser&&a._catalogService.anonymousProxy.getKilledAppAsync(o,n):n({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,killedApps:r}})},p.prototype.getAppDetails=function(e,t,r){var i=this,o=this.buildOmexRequestParameters();o.assetid=n,o[c]=e.join(","),o[a]=t,this._catalogService.ungatedProxy.getAppDetailsAsync(o,function(e){i.tryFail(e.status,e.httpStatus,r)?i.logServiceCallResponseError("appdetails",e.httpStatus):r(e)})},p.prototype.removeApps=function(r,a){var i=this,o=i,s=i.buildOmexRequestParameters();s.assetid=n,s[c]=r.join(",");var l=i._catalogService.currentUserType;i.isUserTypeValid(l)?l===t.AuthedUser?i._catalogService.gatedProxy.removeApps(s,function(e){o.tryFail(e.status,e.httpStatus,a)?o.logServiceCallResponseError("removeapps",e.httpStatus):a(e)}):l===t.AnonymousUser&&a({status:e.DataServiceResultCode.Succeeded,value:{removedApps:[]}}):a({status:e.DataServiceResultCode.UnknownUserType,value:{removedApps:[]}})},p.prototype.getETokenAndManifestInternal=function(s,l,d,p){var f=this,m=f,g=f.buildOmexRequestParameters();g[u]=o.dummyApplicationName,g[c]=s.assetId,g.clientAppInfoReturnType=d;var h=f._catalogService.currentUserType;f.isUserTypeValid(h)?h===t.AuthedUser&&d!=i.ClientAppInfoReturnType.urlOnly?(g.assetContentMarket=l,g.userContentMarket=s.storeId,g.expectedVersion=s.appVersion,f._catalogService.gatedProxy.getManifestAndETokenAsync(g,function(e){m.tryFail(e.status,e.httpStatus,p)?m.logServiceCallResponseError("manifestandetoken",e.httpStatus):p(e)})):(g[a]=s.storeId,g.clientAppInfoReturnType==i.ClientAppInfoReturnType.etokenOnly?p({status:e.DataServiceResultCode.Succeeded,value:{status2:i.OmexClientAppStatus.OK,etoken:n,manifest:r}}):f._catalogService.anonymousProxy.getManifestAsync(g,function(e){m.tryFail(e.status,e.httpStatus,p)?m.logServiceCallResponseError("manifest",e.httpStatus):p(e)})):p({status:e.DataServiceResultCode.UnknownUserType,value:{etoken:n,manifest:r}})},p.prototype.buildOmexRequestParameters=function(){var e=this;return{clientName:e._clientName,clientVersion:e._clientVersion,correlationId:e._correlationId,build:e._build}},p.prototype.logServiceCallResponseError=function(e,t){var n="proxybased request "+e+" failed";t&&(n+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(n,r,this._correlationId,18657697)},p}();e.ProxyBasedCatalogServiceScope=c;var l=function(){function e(){}return e.getClientVersionFromWACAppVersion=function(e){if(e){var t=e.split("."),n=parseInt(t[0],10),r=parseInt(t[1],10)||0;if(!(n<=15&&r<=0)){var a=i.Constants.FileVersion.split(".");return n+"."+r+"."+a[2]+"."+a[3]}}},e.getOmexEndPointPageUrl=function(e,t,n){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",e,n,t)},e}();e.OmexUtils=l}(u||(u={})),function(e){var t=function(t){function n(e){var n=this;t.call(n,e),n.proxyName="__omexExtensionProxy",n.proxyUrl=n.osfOmexBaseUrl+"/ungatedserviceextension.aspx"}return c(n,t),n.prototype.getAppDetailsAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.UnGated_GetAppDetails,t,function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppDetails(t.value)),n(t)})},n}(e.OmexProxyBase);e.UnGatedOmexProxy=t}(u||(u={})),function(e){var t=!1,n=null,r=!0,a=function(){var a="cacheExpired";function o(e,t){var n=this;n._initParam=t,n._cacheManager=e.cacheManager,n._cachePrefix=e.cachePrefix,n._cid=e.cid,n._anonymous=e.anonymous,n._telemetryContext=e.telemetryContext}return o.prototype.GetCacheKeyPrefix=function(){return this._cachePrefix},o.prototype.getOmexEndPointPageUrl=function(t,n){return e.OmexUtils.getOmexEndPointPageUrl(this._initParam.omexBaseUrl,t,n)},o.prototype.getKilledApps=function(t,a,o){var s=this,c=s;s._telemetryContext.startActivity(e.Activity.KilledAppsCheck);var l=i.OUtil.formatString(e.CacheConsts.killedAppsCacheKey,s.GetCacheKeyPrefix());if(o)s._cacheManager.RemoveCacheItem(l);else{var u=s._cacheManager.GetCacheItem(l,r);if(u&&u.refreshRate2!=n)return s._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),void a({status:e.DataServiceResultCode.Succeeded,value:u})}t.getKilledApps(function(t){t.status==e.DataServiceResultCode.Succeeded?(c._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),u=t.value,c._cacheManager.SetCacheItem(l,u,u.refreshRate/e.CacheConsts.hourToDayConversionFactor),a(t)):a(t)})},o.prototype.getAppState=function(o,s,c,l){var u=this,d=u;u._telemetryContext.startActivity(e.Activity.AppStateCheck);var p,f=i.OUtil.formatString(e.CacheConsts.appStateCacheKey,u.GetCacheKeyPrefix(),s.storeId,s.assetId);if(l)u._cacheManager.RemoveCacheItem(f);else{var m={};if(p=u._cacheManager.GetCacheItem(f,r,m),u._telemetryContext.setFlag(e.FlagName.AppStateDataInvalidFlag,m[a]||t),p&&p.state2!=n)return u._telemetryContext.stopActivity(e.Activity.AppStateCheck),u._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,r),void c({status:e.DataServiceResultCode.Succeeded,value:p})}o.getAppState(s,function(n){n.status==e.DataServiceResultCode.Succeeded?(d._telemetryContext.stopActivity(e.Activity.AppStateCheck),d._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,t),p=n.value,d._cacheManager.SetCacheItem(f,p,p.refreshRate2/e.CacheConsts.hourToDayConversionFactor),c(n)):c(n)})},o.prototype.getManifest=function(o,s,c,l,u){var d=this,p=d;d._telemetryContext.startActivity(e.Activity.ManifestRequest);var f,m=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,s.assetId,s.storeId);if(u)d._cacheManager.RemoveCacheItem(m);else{var g={};if(f=d._cacheManager.GetCacheItem(m,r,g),d._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,g[a]||t),f&&f.status2!=n)return d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,r),void l({status:e.DataServiceResultCode.Succeeded,value:{status2:f.status2,manifest:f.manifest}})}o.getManifest(s,c,function(n){n.status==e.DataServiceResultCode.Succeeded&&n.value.status2==i.OmexClientAppStatus.OK?(p._telemetryContext.stopActivity(e.Activity.ManifestRequest),p._telemetryContext.stopActivity(e.Activity.ServerCall),p._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),p._telemetryContext.setBits(e.FlagName.ManifestRequestType,i.ManifestRequestTypes.Manifest),f={etoken:"",status2:n.value.status2,manifest:n.value.manifest},p._cacheManager.SetCacheItem(m,f,e.CacheConsts.manifestRefreshRate),l(n)):l(n)})},o.prototype.removeApps=function(n,a,o){var s=this;n.removeApps(a,function(n){if(n.status==e.DataServiceResultCode.Succeeded){for(var a=".*",c=t,l=[],u=n.value.removedApps,d=0;d<u.length;++d)u[d].result2==i.OmexRemoveAppStatus.Success&&(l.push(new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,a,u[d].assetId,a,a),"i")),c=r);c&&s._cacheManager.RemoveMatches(l),o(n)}else o(n)})},o.prototype.getCachedETokenAndManifest=function(i){var o={},s=this._cacheManager.GetCacheItem(i,r,o);if(this._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,o[a]||t),s){if(s.status2&&s.tokenExpirationDate2&&s.tokenExpirationDate2>(new Date).getTime())return s;s.etoken=n,s.tokenExpirationDate2=n,s.entitlementType=n}return s},o.prototype.getETokenAndManifest=function(a,o,s,c,l){var u=this,d=u;if(u._anonymous)u.getManifest(a,o,s,function(t){e.AsyncUtil.failed(t,c)||c({status:t.status,value:{etoken:"",status2:t.value.status2,manifest:t.value.manifest}})},l);else{u._telemetryContext.startActivity(e.Activity.ManifestRequest);var p,f=function(t,n){d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),n&&d._telemetryContext.setBits(e.FlagName.ManifestRequestType,n)},m=i.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,u._cid,o.assetId,o.storeId,s);if(l)u._cacheManager.RemoveCacheItem(m);else{if((p=u.getCachedETokenAndManifest(m))&&p.etoken&&p.manifest)return f(r),void c({status:e.DataServiceResultCode.Succeeded,value:p});var g=p?p.manifest:n;if(g==n||""==g){var h=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,o.assetId,o.storeId),v=u._cacheManager.GetCacheItem(h,r);v&&(g=v.manifest)}if(g)return void(p&&p.etoken?(f(r),p.manifest=g,c({status:e.DataServiceResultCode.Succeeded,value:p})):a.getEToken(o,s,function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value&&(f(t,i.ManifestRequestTypes.Etoken),(p=n.value).status2===i.OmexClientAppStatus.OK&&(d._cacheManager.SetCacheItem(m,p,e.CacheConsts.manifestRefreshRate),p.manifest=g)),c(n)}))}a.getETokenAndManifest(o,s,function(n){n.status==e.DataServiceResultCode.Succeeded?(f(t,i.ManifestRequestTypes.Both),n.value.status2===i.OmexClientAppStatus.OK&&d._cacheManager.SetCacheItem(m,n.value,e.CacheConsts.manifestRefreshRate),c(n)):c(n)})}},o.prototype.getEntitlements=function(t,r,a,i){var o=this,s=o;o._telemetryContext.startActivity(e.Activity.EntitlementCheck);var c,l,u=function(){l!=n&&c!=n&&(c=c.filter(function(e){return l.every(function(t){return t.assetId!=e.assetId})}),a({status:e.DataServiceResultCode.Succeeded,value:{entitlements:c,killed:l}}))};o._anonymous?(c=[],o._telemetryContext.stopActivity(e.Activity.EntitlementCheck),u()):t.getEntitlementAsync(r,function(t){s._telemetryContext.stopActivity(e.Activity.EntitlementCheck),a!=n&&(e.AsyncUtil.failed(t,a)?a=n:(s._cid||(s._cid=t.value.cid),c=t.value.entitlements,u()))},i),o.getKilledApps(t,function(t){a!=n&&(l=t.status==e.DataServiceResultCode.Succeeded?t.value.killedApps:[],u())})},o.prototype.activate=function(a,o,c){var l,u,d=this,p={assetId:o.assetId,appVersion:o.appVersion,storeId:o.storeId,storeType:o.storeType,targetType:o.targetType},f=t,m=this.getOmexEndPointPageUrl(p.assetId,p.storeId),g=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),h=function(u,f){switch(u.status2){case i.OmexClientAppStatus.OK:if(u.tokenExpirationDate2&&u.tokenExpirationDate2<=(new Date).getTime())return void e.LoaderUtil.failWithWarning(c,e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){return v()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED}));var h=e.ManifestUtil.ParseManifest(u.manifest,d._initParam.appUILocale,d._telemetryContext.correlationId);if(h==n)return void e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT});var b=h.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(p.assetId,o.appVersion,h),h.requirementsSupported===t||void 0===h.requirementsSupported&&!c.getRequirementsChecker().isManifestSupported(h)){h.requirementsSupported=t;var S;return S=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(c,{description:S,url:m,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex})}h.requirementsSupported=r,d._telemetryContext.setFlag(e.FlagName.ManifestTrustCachedFlag,!f);var C=i.OUtil.formatString(i.Constants.ActivatedCacheKey,o.assetId.toLowerCase(),o.storeType,o.storeId);if(f&&!c.skipTrust(o)){var A=i.OmexClientNames[d._initParam.appName];if(!(d._anonymous&&d._cacheManager.GetCacheItem(C,t))&&!c.hasConsent(o)&&!c.isForCustomFunctionSandbox())return void c.askForTrust({anonymous:t,clientName:A,entitlement:p,displayName:h.getDefaultDisplayName(),providerName:h.getProviderName(),iconUrl:h.getDefaultIconUrl(),url:m,isSSOAddin:h.isSSOAddin()},function(){d.restartActivationTelemetry(),d._cacheManager.SetCacheItem(C,r),d._anonymous?c.load({entitlement:p,manifest:h,eToken:u.etoken},n):d.getETokenAndManifest(a,p,p.storeId,function(t){t.status==e.DataServiceResultCode.Succeeded&&t.value.status2==i.OmexClientAppStatus.OK?(t.value.version!=n&&e.ManifestUtil.versionLessThan(p.appVersion,t.value.version)&&(p.appVersion=t.value.version),_(r)):e.LoaderUtil.failWithError(c,{infoType:i.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure})})})}c.hasConsent(o)&&d._cacheManager.SetCacheItem(C,r);var I=l.version;e.ManifestUtil.versionLessThan(I,o.appVersion)&&(I=o.appVersion),e.ManifestUtil.versionLessThan(b,I)?(p.appVersion=I,e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),c.setIsUpgrading(r),v(r),y()},url:m,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})):l.state2===i.OmexState.DeveloperWithdrawn?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}):l.state2===i.OmexState.Flagged?e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED}):!d._anonymous&&u.entitlementType&&u.entitlementType.toLowerCase()===i.OmexEntitlementType.Trial&&(e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){return window.open(m)},reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE}),e.LoaderUtil.showNotification(c,{description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,reDisplay:r,highPriority:r,displayDeactive:t,errorCode:i.ErrorStatusCodes.S_USER_CLICKED_BUY})),c.load({entitlement:p,manifest:h,eToken:u.etoken},n);break;case i.OmexClientAppStatus.KilledAsset:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});break;case i.OmexClientAppStatus.NoEntitlement:case i.OmexClientAppStatus.TrialNotSupported:case i.OmexClientAppStatus.LimitedTrial:case i.OmexClientAppStatus.EntitlementDeactivated:if(d._anonymous){e.LoaderUtil.failWithError(c,{title:Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,description:Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,buttonTxt:Strings.OsfRuntime.L_SignInButton_TXT,buttonCallback:function(){var e=window.location.href,t=d._initParam.omexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(e);window.open(t)},errorCode:i.ErrorStatusCodes.E_USER_NOT_SIGNED_IN})}else{c.setRetryCall(function(){d.restartActivationTelemetry(),v(r)}),e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){window.open(m),e.LoaderUtil.showWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,retryAll:r,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}break;case i.OmexClientAppStatus.UnknownAssetId:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST});break;case i.OmexClientAppStatus.Expired:case i.OmexClientAppStatus.Invalid:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v()},errorCode:i.ErrorStatusCodes.E_TOKEN_EXPIRED});break;case i.OmexClientAppStatus.Revoked:e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE});break;case i.OmexClientAppStatus.VersionMismatch:p.appVersion=u.version,c.askForUpgrade(e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,url:m,highPriority:r,logAsError:r,errorCode:i.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE}),function(){d.restartActivationTelemetry(),c.setIsUpgrading(r),v(r)});break;case i.OmexClientAppStatus.VersionNotSupported:e.LoaderUtil.failWithWarning(c,{description:Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,errorCode:i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType},i.OsfControlStatus.UnsupportedStore);break;case i.OmexClientAppStatus.UserIsMinor:g&&g.enableDisplayBlockedMinorError&&e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR});break;default:s.RuntimeTelemetryHelper.LogExceptionTag("unknown clientAppStatus in manifestAndEtoken: "+u.status2,n,d._telemetryContext.correlationId,20030238),e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(r)},errorCode:i.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus})}},v=function(o){var s=u?u.contentMarket:p.storeId,m=function(n,a){return n.status!=e.DataServiceResultCode.Succeeded?g&&g.enableDisplayBlockedMinorError&&451===n.httpStatus?(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}),r):(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),v(o)},errorCode:a}),r):t};c.skipTrust(p)?d.getManifest(a,p,s,function(e){if(!m(e,i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure))return o?(l=n,void S(r)):void h({etoken:"",status2:e.value.status2,manifest:e.value.manifest})},o):d.getETokenAndManifest(a,p,s,function(e){if(!m(e,i.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure))return o?(l=n,f=t,_(r),void S(r)):void h(e.value)},o)},y=function(){var t=i.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,p.assetId,p.storeId);d._cacheManager.RemoveCacheItem(t)},b=function(){if(l!=n&&f){if(u!=n)return p.appVersion=u.version,void v();var t,s,g;if(l.state2===i.OmexState.Flagged?t=r:l.state2===i.OmexState.DeveloperWithdrawn?s=r:l.state2===i.OmexState.Withdrawn&&(g=r),!(t||s||g)||(e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE}),!t))if(c.hasConsent(o))v();else{var y=u?u.contentMarket:p.storeId;d.getManifest(a,p,y,function(t){t.status==e.DataServiceResultCode.Succeeded?h({etoken:"",status2:t.value.status2,manifest:t.value.manifest},r):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),d.restartActivationTelemetry(),b()},errorCode:i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure})})}}},_=function(o){u=n,f=t,d.getEntitlements(a,t,function(a){if(a.status!=e.DataServiceResultCode.Succeeded)return g&&g.enableDisplayBlockedMinorError&&451===a.httpStatus?void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}):void e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){c.restartActivation(),_()},errorCode:i.ErrorStatusCodes.WAC_AgaveEntitlementRequestFailure});a.value.killed.some(function(e){return e.assetId==p.assetId})?e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED}):(a.value.entitlements.some(function(e){return e.assetId.toLowerCase()==p.assetId.toLowerCase()?(u=e,m=d.getOmexEndPointPageUrl(e.assetId,e.contentMarket),r):t}),d._telemetryContext.setFlag(e.FlagName.OmexHasEntitlementFlag,u!=n),f=r,b())},o)},S=function(t){l=n,d.getAppState(a,p,function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return l={state2:i.OmexState.OK,productId:n,assetId:p.assetId,version:p.appVersion,refreshRate2:0},void b();t.value.state2!==i.OmexState.Killed?(l=t.value,b()):e.LoaderUtil.failWithError(c,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED})},t)};S(),_()},o.prototype.restartActivationTelemetry=function(){var t=this;t._telemetryContext.startActivity(e.Activity.Activation),t._telemetryContext.startActivity(e.Activity.ServerCall),t._telemetryContext.setFlag(e.FlagName.AnonymousFlag,t._anonymous)},o}(),o=function(){function o(t,a){void 0===a&&(a=n),this._anonymous=r,this._initParam=t,this._cacheManager=a||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return o.prototype.GetCacheKeyPrefix=function(){return this._anonymous?e.CacheConsts.anonymousCacheKeyPrefix:e.WACUtils.CacheConstants.GatedCacheKeyPrefix},o.prototype.getOmexEndPointPageUrl=function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._initParam.omexBaseUrl,t,e)},o.prototype.getDataService=function(t,r){var a=this,o=a;if(a._dataService==n)if(a._dataServiceReady==n){a._dataServiceReady=r;var s={status:e.DataServiceResultCode.Failed,value:n},c=function(t,r){var a=o._dataServiceReady;o._dataServiceReady=n,t.status==e.DataServiceResultCode.Succeeded?(o._anonymous=t.value.anonymous,o._dataService=r,s.value=r,s.status=e.DataServiceResultCode.Succeeded,a(s)):(s.httpStatus=t.httpStatus,a(s))};t.startActivity(e.Activity.Authentication);var l=new e.S2SOmexCatalogService(a._initParam);l.initialize(t.correlationId,function(n){if(n.status==e.DataServiceResultCode.Succeeded){var r=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(!r||!r.enableAnonymousUseLegacyCatalogService||!n.value.anonymous)return t.stopActivity(e.Activity.Authentication),void c(n,l)}t.setBits(e.FlagName.ActivationRuntimeType,i.ActivationTypes.V2Enabled);var a=e.ProxyBasedCatalogService.getInstance(o._initParam);a.prepareProxy(t.correlationId,function(n){t.stopActivity(e.Activity.Authentication),t.setBits(e.FlagName.RetryCount,a.omexAuthConnectTries),c(n,a)})})}else{t.startActivity(e.Activity.Authentication);var u=a._dataServiceReady;a._dataServiceReady=function(n){t.stopActivity(e.Activity.Authentication),u(n),r(n)}}else r({status:e.DataServiceResultCode.Succeeded,value:a._dataService})},o.prototype.createActivityScope=function(t,r){var i=this;this.getDataService(t,function(o){if(e.AsyncUtil.failed(o,r))s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data service.",n,t.correlationId,18657692);else{t.setFlag(e.FlagName.AnonymousFlag,i._anonymous);var c=o.value,l={cacheManager:i._cacheManager,cachePrefix:i.GetCacheKeyPrefix(),cid:c.getCID(),anonymous:i._anonymous,telemetryContext:t},u=c.createScope(l),d=new a(l,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:u,activityScope:d}})}})},o.prototype.getEntitlementAsync=function(t,n,r,a,o){var s=this;this.createActivityScope(n,function(n){e.AsyncUtil.failed(n,r,[])||(s._anonymous?r({status:e.DataServiceResultCode.Failed,httpStatus:403}):n.value.serviceScope.getEntitlementAsync(t,function(t){if(!e.AsyncUtil.failed(t,r,[])){for(var n=t.value.entitlements,a=0;a<n.length;a++){var o=n[a],s=o;s.appVersion=o.version,s.storeId=o.contentMarket,s.storeType=i.StoreType.OMEX,s.targetType=i.OUtil.getTargetType(o.appSubType)}r({status:t.status,value:n})}},a,o))})},o.prototype.getAndCacheManifest=function(r,a,o,s,c){var l=this;c=c||t;var u=i.OsfManifestManager.getCachedManifest(r.assetId,r.appVersion);c||u==n?this.createActivityScope(o,function(t){if(!e.AsyncUtil.failed(t,s)){var u=t.value.serviceScope;t.value.activityScope.getManifest(u,r,a,function(t){if(!e.AsyncUtil.failed(t,s))if(t.value.status2==i.OmexClientAppStatus.OK){var a=e.ManifestUtil.ParseManifest(t.value.manifest,l._initParam.appUILocale,o.correlationId);a!=n?(i.OsfManifestManager.cacheManifest(r.assetId,r.appVersion,a),s({status:e.DataServiceResultCode.Succeeded,value:a})):s({status:e.DataServiceResultCode.Failed,value:a})}else s({status:e.DataServiceResultCode.Failed})},c)}}):s({status:e.DataServiceResultCode.Succeeded,value:u})},o.prototype.activateAsync=function(t,n,a){var o=this;a.startActivity(e.Activity.Activation),a.startActivity(e.Activity.ServerCall),this.createActivityScope(a,function(s){o.isStoreDisabled(a,function(c){if(c.value===r)e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_OmexStoreDisabledByAdmin,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED});else if(s.status!=e.DataServiceResultCode.Succeeded)return void e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),o.activateAsync(t,n,a)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})});var c=s.value.serviceScope;s.value.activityScope.activate(c,t,n)})},o.prototype.removeAsync=function(t,n,r){this.createActivityScope(n,function(n){if(!e.AsyncUtil.failed(n,r)){var a=n.value.serviceScope;n.value.activityScope.removeApps(a,t,r)}})},o.prototype.getAppDetails=function(t,a,o,s,c){var l=this,u=l,d=[];if(c)l._cacheManager.RemoveAll(e.CacheConsts.ungatedCacheKeyPrefix);else{for(var p=t,f=[],m=0;m<p.length;++m){var g=i.OUtil.formatString(e.CacheConsts.appDetailKey,p[m]),h=l._cacheManager.GetCacheItem(g,r);h&&h.state2!=n?d.push(h):f.push(p[m])}if(0===f.length)return void s({status:e.DataServiceResultCode.Succeeded,value:d});t=f}l.createActivityScope(o,function(n){e.AsyncUtil.failed(n,s,d)||n.value.serviceScope.getAppDetails(t,a,function(t){if(!e.AsyncUtil.failed(t,s,d)){for(var n=t.value,r=0;r<n.length;++r){var a=n[r],o=i.OUtil.formatString(e.CacheConsts.appDetailKey,a.assetId);u._cacheManager.SetCacheItem(o,a),d.push(a)}t.value=d,s(t)}})})},o.prototype.isStoreDisabled=function(n,r){this.createActivityScope(n,function(n){e.AsyncUtil.failed(n,r,t)||n.value.serviceScope.isStoreDisabled(r)})},o}();e.OmexCatalog=o,e.CatalogFactory.register(i.StoreType.OMEX,function(t){if(t.allowExternalMarketplace&&t.osfOmexBaseUrl){var n,a=t.osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);n=a>=0?t.osfOmexBaseUrl.substr(a):i.Constants.ProtocolSeparator+t.osfOmexBaseUrl;var s=i.Constants.Https+n;return i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(t.omexForceAnonymous=r),new o({appName:t.appName,appUILocale:t.appUILocale,AppVersion:t.appVersion,clientMode:t.clientMode,docUrl:t.docUrl,omexBaseUrl:s,omexForceAnonymous:t.omexForceAnonymous})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:i.OsfControlStatus.ActivationFailed})})}(u||(u={})),function(e){var t=function(){function e(){}return e.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.ungatedCacheKeyPrefix="__OSF_OMEX.",e.manifestRefreshRate=1825,e.hourToDayConversionFactor=24,e.anonymousAppInstallInfoCacheKey=e.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}",e.firstPartyAddinListCacheKey=e.anonymousCacheKeyPrefix+"firstPartyAddInList",e.firstPartyManifestCacheKey=e.anonymousCacheKeyPrefix+"firstPartyManifest.{0}",e.killedAppsCacheKey="{0}killedApps",e.appStateCacheKey="{0}appState.{1}.{2}",e.appDetailKey="__OSF_OMEX.appDetails.{0}",e}();e.CacheConsts=t}(u||(u={})),function(e){var t=null,n=function(){function n(e,t,n){var r=this;r._handler=e,r._initParam=t,r._cacheManager=n.cacheManager,r._cachePrefix=n.cachePrefix,r._cid=n.cid,r._correlationId=n.telemetryContext.correlationId}return n.prototype.tryFail=function(t,n){return 200!=t&&(n({httpStatus:t,status:e.DataServiceResultCode.Failed}),!0)},n.prototype.getLastStoreUpdate=function(t){var n=this,r=n,a=n._initParam.appUILocale;n._handler.getLastStoreUpdate(a,n._correlationId,function(n,a){r.tryFail(n,t)?r.logServiceCallResponseError("laststoreupdate",n):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessLastStoreUpdate(a)})})},n.prototype.getEntitlementAsync=function(n,r,a,o){var s=this,c=s,l=i.OmexAppVersions[s._initParam.appName],u=i.OUtil.formatString(s._cachePrefix+e.WACUtils.CacheConstants.EntitlementsKey,l,s._cid);if(a)s._cacheManager.RemoveCacheItem(u);else{var d=s._cacheManager.GetCacheItem(u,!0,t,o);if(d!=t)return void r({status:e.DataServiceResultCode.Succeeded,value:d})}s._handler.getEntitlement(n,l,s._correlationId,function(t,n){if(c.tryFail(t,r))c.logServiceCallResponseError("entitlement",t);else{var a=e.OmexXmlProcessor.ProcessEntitlement(n);a.cid=c._cid,c._cacheManager.SetCacheItem(u,a,a.refreshRate2/e.CacheConsts.hourToDayConversionFactor),r({status:e.DataServiceResultCode.Succeeded,value:a})}})},n.prototype.getEToken=function(t,n,r){var a=this,o=n,s=t.storeId,c=t.assetId,l=t.appVersion;this._handler.getEToken(s,o,c,l,this._correlationId,function(t,n){a.tryFail(t,r)?a.logServiceCallResponseError("etoken",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessClientAppInstallInfo(n,i.ClientAppInfoReturnType.etokenOnly)})})},n.prototype.getETokenAndManifest=function(t,n,r){var a=this;this.getEToken(t,n,function(i){i.status==e.DataServiceResultCode.Succeeded?a.getManifest(t,n,function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return i.status=t.status,i.httpStatus=t.httpStatus,void r(i);i.value.manifest=t.value.manifest,r(i)}):r(i)})},n.prototype.getManifest=function(t,n,r){var a=n;this._handler.getManifest(a,t.assetId,this._correlationId,function(t,n){r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ConvertAnonymousManifest(t,n)})})},n.prototype.getAppState=function(t,n){var r=this,a=t.storeId+":"+t.assetId;this._handler.getAppState(a,this._correlationId,function(t,a){r.tryFail(t,n)?r.logServiceCallResponseError("appstate",t):n({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppState(a)})})},n.prototype.getKilledApps=function(t){var n=this;this._handler.getKilledApps(this._correlationId,function(r,a){n.tryFail(r,t)?n.logServiceCallResponseError("killedapps",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessKilledApps(a)})})},n.prototype.getAppDetails=function(t,n,r){var a=this;this._handler.getAppDetails(n,t.join(","),this._correlationId,function(t,n){a.tryFail(t,r)?a.logServiceCallResponseError("appdetails",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppDetails(n)})})},n.prototype.removeApps=function(t,n){var r=this;this._handler.removeApps(t.join(","),this._correlationId,function(t,a){if(r.tryFail(t,n))r.logServiceCallResponseError("removeapps",t);else{var o=e.OmexXmlProcessor.ProcessRemoveAppResponse(a);o.removedApps.some(function(e){return e.result2==i.OmexRemoveAppStatus.Success})&&r.clearEntitlementCache(),n({status:e.DataServiceResultCode.Succeeded,value:o})}})},n.prototype.clearEntitlementCache=function(){var t=new RegExp(i.OUtil.formatString(e.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i");this._cacheManager.RemoveMatches([t])},n.prototype.isStoreDisabled=function(t){var n=this;this._handler.isStoreDisabled(this._correlationId,function(r){if(200!=r&&403!=r&&401!=r)return n.logServiceCallResponseError("isStoreDisabled",r),void t({status:e.DataServiceResultCode.Failed,value:!1});t({status:e.DataServiceResultCode.Succeeded,value:401==r})})},n.prototype.logServiceCallResponseError=function(e,n){var r="s2s request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18657699)},n}();e.OmexCatalogServiceS2SScope=n;var r=function(){function r(e){this._cid="",this._initParam=e}return r.initRequestHandler=function(e){r._requestHandler==t&&(r._requestHandler=e)},r.prototype.getCID=function(){return this._cid},r.prototype.initialize=function(n,a){var i=this;r._requestHandler!=t?this._initParam.omexForceAnonymous?a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):r._requestHandler.getUserId(n,function(r,o){200==r?(i._cid=o.trim(),a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!1}})):403==r?a({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):(s.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+r,t,n,18657728),a({status:e.DataServiceResultCode.Failed,httpStatus:r}))}):a({status:e.DataServiceResultCode.Failed,httpStatus:404})},r.prototype.createScope=function(e){return new n(r._requestHandler,this._initParam,e)},r}();e.S2SOmexCatalogService=r}(u||(u={})),function(e){var t=function(){var e="description",t="provider",n="o:assets",r="contentMarket",a="appSubType",o="expirationDate",s="state",c="version",u="productId",d="assetId",p="o:asset",f="o:results",m="refreshRate",g=null;function h(){}return h.ProcessLastStoreUpdate=function(e){var t=new i.XmlProcessor(e,l).getDocumentElement().selectSingleNode("o:update");return t.firstChild!=g?Date.parse(t.firstChild.nodeValue):g},h.ProcessAppState=function(e){var t={},n=new i.XmlProcessor(e,l),r=n.getDocumentElement();n.readAttributes(r,{rr:m},t);var a=n.selectSingleNode(f),g=n.selectSingleNode("o:lang",a),v=n.selectSingleNode(p,g);return n.readAttributes(v,{assetid:d,prodid:u,ver:c,state:s,tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:o},t),h.ConvertAppState(t)},h.ProcessFirstPartyAddInList=function(e){var t={addInList:{},refreshRate:g},n=new i.XmlProcessor(e,l),r=n.getDocumentElement(),a=n.selectSingleNode("o:Apps",r),o=a.getAttribute("d1p1:rr");t.refreshRate=o?parseInt(o):0;for(var s=n.selectNodes("o:App",a),c=0;c<s.length;c++){var u=s[c],p={assetId:g,path:g,version:g};n.readAttributes(u,{assetid:d},p);var f=n.selectSingleNode("o:Path",u);p.path=f.text!=g?f.text:f.textContent!=g?f.textContent:f.nodeTypedValue;var m=n.selectSingleNode("o:Version",u);p.version=m.text!=g?m.text:m.textContent!=g?m.textContent:m.nodeTypedValue,t.addInList[p.assetId]=p}return t},h.ConvertAppState=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e.state2=e.state?parseInt(e.state):0,e.expirationDate2=h.GetTickByDate(e.expirationDate),e},h.ProcessEntitlement=function(e){var t={},n=new i.XmlProcessor(e,l),s=n.selectSingleNode("o:entitlementlist"),p=n.selectSingleNode("o:hdr",s);n.readAttributes(p,{pm:"billingMarket",pagesize:"pageSize",rr:m},t);for(var f,g,v=n.selectNodes("o:entitlement",n.selectSingleNode("o:entitlements",s)),y=[],b=0;b<v.length;++b)g={},f=v[b],n.readAttributes(f,{assetid:d,pid:u,ver:c,appst:a,cm:r,trlt:"licenseType",acqdate:"acquireDate",expiry2:o,attreq:"attentionRequired"},g),y.push(g);return t.entitlements=y,h.ConvertEntitlementInfo(t)},h.ConvertEntitlementInfo=function(e){for(var t=e.entitlements,n=0;n<t.length;++n){var r=t[n];r.appSubType2=r.appSubType?parseInt(r.appSubType):0,r.acquireDate2=h.GetTickByDate(r.acquireDate),r.expirationDate2=h.GetTickByDate(r.expirationDate),r.attentionRequired2="true"===r.attentionRequired}return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},h.ProcessKilledApps=function(e){var t={},r=new i.XmlProcessor(e,l),a=r.getDocumentElement();r.readAttributes(a,{rr:m},t);for(var o=[],s=r.selectSingleNode(n),c=r.selectNodes(p,s),f=0;f<c.length;++f){var g=c[f],v={};r.readAttributes(g,{assetid:d,pid:u},v),o.push({assetId:v.assetId,productId:v.productId})}return t.killedApps=o,h.ConvertKilledAppsInfo(t)},h.ConvertKilledAppsInfo=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},h.ProcessClientAppInstallInfo=function(e,t){var a=new i.XmlProcessor(e,l),o=a.selectSingleNode(n),s=a.selectSingleNode(p,o),u={etoken:g,manifest:g};if(t===i.ClientAppInfoReturnType.urlOnly?a.readAttributes(s,{url:"url"},u):t===i.ClientAppInfoReturnType.etokenOnly?a.readAttributes(s,{etok:"etoken"},u):a.readAttributes(s,{url:"url",etok:"etoken"},u),a.readAttributes(s,{status:"status",cm:r,assetid:d,ver:c},u),t!=i.ClientAppInfoReturnType.urlOnly&&u.etoken){var f=new i.XmlProcessor(u.etoken,""),m=f.selectSingleNode("t",f.selectSingleNode("r"));f.readAttributes(m,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},u)}return h.ConvertClientAppInstallInfo(u)},h.ConvertClientAppInstallInfo=function(e){return e.status2=e.status?parseInt(e.status):0,e.tokenExpirationDate2=h.GetTickByDate(e.tokenExpirationDate),e},h.ProcessManifest=function(e){return{manifest:e}},h.ProcessRemoveAppResponse=function(e){for(var t,n,r={removedApps:[]},a=new i.XmlProcessor(e,l),o=(a.getDocumentElement(),a.selectSingleNode("o:apps",a.selectSingleNode("o:removedApps"))),s=a.selectNodes("o:app",o),c=0;c<s.length;++c)t=s[c],n={},a.readAttributes(t,{assetid:d,result:"result"},n),r.removedApps.push(n);return h.ConvertRemoveAppResponse(r)},h.ConvertRemoveAppResponse=function(e){for(var t=e.removedApps,n=0;n<t.length;++n){var r=t[n];r.result2=r.result?parseInt(r.result):0}return e},h.ProcessAppDetails=function(n){for(var r,o,u=new i.XmlProcessor(n,l),p=u.selectSingleNode(f),m=u.selectNodes("o:wainfo",p),g=[],v=0;v<m.length;++v)r=m[v],o={},u.readAttributes(r,{assetid:d,defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:t,desc:e,icon:"iconUrl",ver:c,state:s,appst:a,appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},o),g.push(o);return h.ConvertAppDetails(g)},h.ConvertAppDetails=function(e){for(var t=0;t<e.length;++t){var n=e[t];n.defaultHeight2=n.defaultHeight?parseInt(n.defaultHeight):0,n.defaultWidth2=n.defaultWidth?parseInt(n.defaultWidth):0,n.state2=n.state?parseInt(n.state):0,n.appSubType2=n.appSubType?parseInt(n.appSubType):0}return e},h.ProcessRecommendations=function(n){for(var r,a,o,u=new i.XmlProcessor(n,l),p=u.selectSingleNode(f),m=u.selectNodes("o:wa",p),g=[],h=0;h<m.length;++h)r=m[h],o={},u.readAttributes(r,{assetid:d,title:"name",desc:e,icon:"iconUrl",ver:c,state:s,rat:"rating",dls:"downloads",prov:t},o),a=u.selectSingleNode("o:price",r),u.readAttributes(a,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},o),g.push(o);return g},h.ConvertAnonymousManifest=function(e,t){var n,r="";switch(e){case 200:n=i.OmexClientAppStatus.OK,r=t;break;case 204:case 1223:n=i.OmexClientAppStatus.NoEntitlement;break;case 400:n=i.OmexClientAppStatus.BadRequest;break;case 410:n=i.OmexClientAppStatus.KilledAsset;break;case 404:n=i.OmexClientAppStatus.UnknownAssetId;break;case 412:n=i.OmexClientAppStatus.VersionNotSupported;break;case 451:n=i.OmexClientAppStatus.UserIsMinor;break;default:n=i.OmexClientAppStatus.ServerError}return{status2:n,manifest:r}},h.GetTickByDate=function(e){return e?new Date(e).getTime():g},h}();e.OmexXmlProcessor=t}(u||(u={})),function(e){var t=function(){var t=null;function n(n,r,a,o){void 0===o&&(o=t),this._cacheManager=o||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),this._privateCatalogService=new e.PrivateCatalogService(i.OmexClientNames[n],i.OUtil.normalizeAppVersion(r)),this._uiLocale=a}return n.prototype.getEntitlementAsync=function(t,r,a,i){r.startActivity(e.Activity.EntitlementCheck),i&&(this._cacheManager.RemoveAll(n._addInsCacheKey),this._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey)),this.GetAddInList(t,r,function(t){for(var i=[],o=0;o<t.length;o++){var s=t[o];s.addInState===n._addInOkState&&i.push(s)}r.stopActivity(e.Activity.EntitlementCheck),a({status:e.DataServiceResultCode.Succeeded,value:i})},function(e){a({status:e})})},n.prototype.getAppDetails=function(r,a,i,o,s){var c=this,l=c;s&&c._cacheManager.RemoveAll(n._addInDetailsCacheKeyPrefix);for(var u=[],d=[],p=0;p<r.length;p++){var f=n.GetAppDetailsCacheKey(r[p].ProductId),m=c._cacheManager.GetCacheItem(f);m?u.push(m):d.push(r[p])}0!==d.length?c._privateCatalogService.GetManifests(d,t,t,i,function(t){for(var r=0;r<t.length;r++){var a=l.ParseAndCacheManifest(t[r],i);if(a){var s=n.CreateAddInDetails(a);u.push(s);var c=n.GetAppDetailsCacheKey(s.assetId);l._cacheManager.SetCacheItem(c,s,n._addInDetailsRefreshRateDays)}}o({status:e.DataServiceResultCode.Succeeded,value:u})},function(e){o({status:e})}):o({status:e.DataServiceResultCode.Succeeded,value:u})},n.prototype.getAndCacheManifest=function(t,r,a,i){var o={ProductId:t.assetId,Version:t.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:t.storeId,ContentMarket:r}};this.GetManifest(o,a,function(t){i({status:e.DataServiceResultCode.Succeeded,value:t})},function(e){i({status:e})})},n.prototype.activateAsync=function(r,a,o){var s=this;o.startActivity(e.Activity.Activation);var c=this;this.GetAddInList(!1,o,function(l){for(var u,d=/[{}]/g,p=0;p<l.length;p++){var f=l[p];if(r.assetId.replace(d,"").toLowerCase()===f.assetId.replace(d,"").toLowerCase()){u=f;break}}if(u)if(u.addInState===n._addInOkState){r.appVersion=u.appVersion;var m={ProductId:u.assetId,Version:u.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:u.storeId,ContentMarket:""}};s.GetManifest(m,o,function(e){a.load({entitlement:r,manifest:e,eToken:""},t)},function(){e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c.activateAsync(r,a,o)}})})}else e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,url:"",errorCode:i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});else e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,a,o)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},function(){e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),c._cacheManager.RemoveAll(n._addInsCacheKey),c._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),c.activateAsync(r,a,o)},detailView:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.WAC_AgaveActivationError}),o.stopActivity(e.Activity.Activation)})},n.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},n.GetAppDetailsCacheKey=function(e){return n._addInDetailsCacheKeyPrefix+i.OUtil.formatString(n._addInDetailsCacheKeySufix,e)},n.GetManifestCacheKey=function(e,t){return n._manifestCacheKeyPrefix+i.OUtil.formatString(n._manifestCacheKeySufix,e,t)},n.CreateAddInDetails=function(e){return{assetId:e.getMarketplaceID(),defaultHeight2:e.getDefaultHeight()||0,defaultHeight:String(e.getDefaultHeight()||0),defaultWidth2:e.getDefaultWidth()||0,defaultWidth:String(e.getDefaultWidth()||0),name:e.getDefaultDisplayName(),provider:e.getProviderName(),description:e.getDefaultDescription(),iconUrl:e.getDefaultIconUrl(),version:e.getMarketplaceVersion(),state2:1,state:"1",appSubType2:e.getOmexTargetCode(),appSubType:String(e.getOmexTargetCode()),appVersions:void 0,requirements:e.getRequirementsXml(),hosts:e.getHostsXml(),highResolutionIconUrl:e.getDefaultHighResolutionIconUrl()}},n.prototype.GetAddInList=function(e,r,a,i){var o,s=this;e||!(o=this._cacheManager.GetCacheItem(n._addInsCacheKey))?this._privateCatalogService.GetAddInList(t,t,r,function(e){for(var t=0;t<e.length;t++){var r=e[t],i=n.GetAppDetailsCacheKey(r.assetId),o=s._cacheManager.GetCacheItem(i);o&&o.version!==r.appVersion&&s._cacheManager.RemoveCacheItem(i)}s._cacheManager.SetCacheItem(n._addInsCacheKey,e,n._addInListRefreshRateDays),a(e)},i):a(o)},n.prototype.GetManifest=function(r,a,o,s){var c=this,l=c;a.startActivity(e.Activity.ManifestRequest);var u=i.OsfManifestManager.getCachedManifest(r.ProductId,r.Version);if(u)return a.stopActivity(e.Activity.ManifestRequest),void o(u);var d=n.GetManifestCacheKey(r.ProductId,r.Version),p=c._cacheManager.GetCacheItem(d);if(p)return(u=new i.Manifest.Manifest(p,c._uiLocale))?(a.stopActivity(e.Activity.ManifestRequest),void o(u)):void s(e.DataServiceResultCode.Failed);c._privateCatalogService.GetManifests([r],t,t,a,function(t){(u=l.ParseAndCacheManifest(t[0],a))?(i.OsfManifestManager.cacheManifest(r.ProductId,r.Version,u),a.stopActivity(e.Activity.ManifestRequest),o(u)):s(e.DataServiceResultCode.Failed)},function(e){s(e)})},n.prototype.ParseAndCacheManifest=function(e,r){try{var a=new i.Manifest.Manifest(e,this._uiLocale),o=n.GetManifestCacheKey(a.getMarketplaceID(),a.getMarketplaceVersion());return this._cacheManager.SetCacheItem(o,e,n._addInManifestRefreshRateDays),a}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest retrieved from Private Catalog.",e,r.correlationId,19965729)}return t},n._addInsCacheKey="__OSF_PRIVATECATALOG_ADDINS",n._addInDetailsCacheKeyPrefix="__OSF_PRIVATECATALOG_ADDINDETAILS",n._addInDetailsCacheKeySufix="_{0}",n._manifestCacheKeyPrefix="__OSF_PRIVATECATALOG_MANIFEST",n._manifestCacheKeySufix="_{0}_{1}",n._lastCatalogUpdateKey="_OSF_PRIVATECATALOG_LASTUPDATE",n._addInListRefreshRateDays=1/24,n._addInDetailsRefreshRateDays=365,n._addInManifestRefreshRateDays=365,n._addInOkState="Ok",n}();e.PrivateCatalog=t,e.CatalogFactory.register(i.StoreType.PrivateCatalog,function(e){return new t(e.appName,e.appVersion,e.appUILocale)})}(u||(u={})),function(e){var t=function(){var t=!1,n=null;function r(e,t){this._clientCode=e,this._clientVersion=t}return r.initRequestHandler=function(t,a,o){r._requestHandler==n&&(r._requestHandler=t),r.authenticationProxy==n&&(r.authenticationProxy=a),r._isThirdPartyHostEnabled=o,r._tokenCacheManager=new e.TokenCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),r._cacheManager=new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)},r.ParseAddInList=function(e,t){var a,o=[];try{a=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetAddIns reponse.",e,t.correlationId,19965730),n}if(!a||!a.AddIns)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetPrivateCatalogAddIns response could not be parsed.",t.correlationId,20194262),o;for(var c=0,l=a.AddIns;c<l.length;c++){var u=l[c];u.AddInState&&u.ProductId&&u.Version?(o.push({assetId:u.ProductId,storeId:u.StoreInfo?u.StoreInfo.AssetId:"none",appVersion:u.Version,storeType:i.StoreType.PrivateCatalog,targetType:i.OsfControlTarget.Undefined,addInState:u.AddInState,contentMarket:u.StoreInfo?u.StoreInfo.ContentMarket:""}),r.StoreAuthenticationData(a)):s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString('Add-In metadata was missing some data. ID: "{0}", Version: "{1}", State: "{2}".',u.ProductId||"",u.Version||"",u.AddInState||""),t.correlationId,20194263)}return o},r.ParseAndCacheManifestList=function(e,t){var a,i=[];try{a=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetManifests reponse.",e,t.correlationId,19965731),n}if(!a||!a.Manifests)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetAddInManifests response could not be parsed.",t.correlationId,20194264),i;for(var o=0,c=a.Manifests;o<c.length;o++){var l=c[o];i.push(l)}return r.StoreAuthenticationData(a),i},r.StoreAuthenticationData=function(e){r._tokenCacheManager.AddRefreshToken(e.RefreshToken,e.UserId,e.TenantId),r._userId=e.UserId,r._tenantId=e.TenantId},r.prototype.GetLastPrivateCatalogUpdate=function(a,i,o,c,l){var u=this,d=0;r._requestHandler.getLastPrivateCatalogUpdate(this._clientCode,this._clientVersion,a,i,o.correlationId,function(p,f){if(d++,200===p){var m;try{m=JSON.parse(f)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetLastPrivateCatalogUpdate reponse.",t,o.correlationId,22823177),void l(e.DataServiceResultCode.Failed)}return m&&m.LastUpdate?(r.StoreAuthenticationData(m),void c(m.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag("GetLastPrivateCatalogUpdate response could not be parsed.",o.correlationId,22823178),void l(e.DataServiceResultCode.Failed))}if(403===p){var g;if(1==d)if(d++,g=JSON.parse(f)){var h=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(h!=n)return void u.GetLastPrivateCatalogUpdate(a,h,o,c,l)}if(d>2||a!=n)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate authentication loop occured.",n,o.correlationId,22823179),void l(e.DataServiceResultCode.Unauthenticated);var v=!0;return setTimeout(function(){r.authenticationProxy.tryAuthorize(function(e){v&&(v=t,u.GetLastPrivateCatalogUpdate(e,i,o,c,l))},function(){v&&(v=t,l(e.DataServiceResultCode.Unauthenticated))})},0),void setTimeout(function(){v&&(v=t,l(e.DataServiceResultCode.Unauthenticated))},5e3)}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate request failed with status code "+p,n,o.correlationId,22823180),l(e.DataServiceResultCode.Failed)})},r.prototype.GetAddInList=function(a,i,o,c,l){var u=this,d=0;r._requestHandler.getPrivateCatalogAddIns(this._clientCode,this._clientVersion,a,i,o.correlationId,function(p,f){if(d++,200===p){var m=r.ParseAddInList(f,o);return m?void c(m):void l(e.DataServiceResultCode.Failed)}if(403===p){var g;if(1==d)if(d++,g=JSON.parse(f)){var h=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(h!=n)return void u.GetAddInList(a,h,o,c,l)}if(d>2||a!=n)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList authentication loop occured. Either authentication attempts count is greater than 2, or authorizationCode is not null. attemptsCount: "+d,n,o.correlationId,20497158),void l(e.DataServiceResultCode.Unauthenticated);var v=!0;return setTimeout(function(){r.authenticationProxy.tryAuthorize(function(e){v&&(v=t,u.GetAddInList(e,i,o,c,l))},function(){v&&(v=t,l(e.DataServiceResultCode.Failed))})},0),void setTimeout(function(){if(v){v=t;var n=r._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;l(n)}},5e3)}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList request failed with status code "+p,n,o.correlationId,20497159),l(e.DataServiceResultCode.Failed)})},r.prototype.GetManifests=function(t,a,i,o,c,l){var u=this,d=0,p={AddIns:t,RefreshToken:i,UserId:"",TenantId:""};r._requestHandler.getPrivateCatalogManifests(e.WACUtils.serializeObjectToString(p),a,i,o.correlationId,function(p,f){if(d++,200===p){var m=r.ParseAndCacheManifestList(f,o);return m?void c(m):void l(e.DataServiceResultCode.Failed)}if(403===p){var g;if(1==d)if(d++,g=JSON.parse(f)){var h=r._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId);if(h!=n)return void u.GetManifests(t,a,h,o,c,l)}return d>2?(s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests authentication loop occured.",n,o.correlationId,20497160),void l(e.DataServiceResultCode.Unauthenticated)):void r.authenticationProxy.tryAuthorize(function(e){u.GetManifests(t,e,i,o,c,l)},function(){l(e.DataServiceResultCode.Unauthenticated)})}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests request failed with status code "+p,n,o.correlationId,20497161),l(e.DataServiceResultCode.Failed)})},r.SignOutUser=function(){s.RuntimeTelemetryHelper.LogCommonMessageTag(i.OUtil.formatString("PrivateCatalogService.SignOutUser: userId = {0}, tenantId = {1}",r._userId,r._tenantId),n,21616005),r._tokenCacheManager.RemoveRefreshToken(r._userId,r._tenantId),r.authenticationProxy.signOut(function(){r._cacheManager.RemoveAll(e.PrivateCatalog._addInsCacheKey),r._cacheManager.RemoveAll(e.PrivateCatalog._addInDetailsCacheKeyPrefix)},function(){s.RuntimeTelemetryHelper.LogCommonMessageTag("Private Catalog: Failed to sign out ",n,22316866)})},r}();e.PrivateCatalogService=t}(u||(u={})),function(e){var t=function(){var t=null;function n(){}return n.ConvertSessionStartInfoToDmsRing=function(e){var r="Production",a="Microsoft",i=t;if(e&&e.sessionStartInfoJson){var o=n.JsonSerializer.Deserialize(e.sessionStartInfoJson);o!=t&&(i=o.AudienceGroup)}switch(i){case"Dogfood":case"Automation":return"Dogfood";case a:return a;case r:return r;default:return s.RuntimeTelemetryHelper.LogExceptionTag("Could not obtain DMS ring from settings. AudienceGroup value: "+i,t,t,38590113),r}},n.GenerateCapabilitiesList=function(e){var r=[],a=e._getSupportedSet();return a!=t&&(a="string"==typeof a?n.JsonSerializer.Deserialize(a):a,r=Object.keys(a).map(function(e){return{Name:e,Version:a[e]}})),r},n.GenerateDMSPackageListRequestBody=function(e,t,r,a){var i={};i.Hosts=[t],i.ReactNativeVersion="0.0.0.0",i.Channel="DevMain",i.Capabilities=n.GenerateCapabilitiesList(r),i.Ring=n.ConvertSessionStartInfoToDmsRing(a),i.Platform="Web",i.Locales=[e],a&&a.clientId&&(i.ClientId=a.clientId);var o={};return o.Context=i,o.SyncId=0,n.JsonSerializer.Serialize(o)},n.GetDMSPackageList=function(t,r,a,i,o,s){e.SdxWebRequestHandler.SendRequestAsync("POST",t,n.GenerateDMSPackageListRequestBody(r,a,i,o),{"Content-Type":"application/json"},s)},n.JsonSerializer=new e.SafeSerializer,n}();e.DMSHandler=t}(u||(u={})),function(e){var t=function(){function t(){}return t.GetSdxList=function(e,n){var r=i.OUtil.formatString(t.SdxListCacheKeyCompleteFormatter,e,n),a=t.CacheManager.GetCacheItem(r,!0);if(null==a){var o=i.OUtil.formatString(t.SdxListCacheKeyHostPrefixFormatter,e);t.CacheManager.RemoveAll(o)}return a},t.CacheSdxList=function(e,n,r){var a=e.CacheTtlInSec/86400,o=i.OUtil.formatString(t.SdxListCacheKeyCompleteFormatter,n,r);t.CacheManager.SetCacheItem(o,e,a)},t.CacheManager=new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer),t.SdxListCacheKeyHostPrefixFormatter="__OSF_SdxList.{0}",t.SdxListCacheKeyCompleteFormatter=t.SdxListCacheKeyHostPrefixFormatter+".{1}",t}();e.SdxCache=t}(u||(u={})),function(e){var t=function(){var t=null;function n(){}return n.generateLoaderError=function(t,r,a,i,o,s,c){e.LoaderUtil.failWithError(i,{description:t,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){i.restartActivation(),n.activateAsync(a,i,o,s,c)},errorCode:r})},n.GetSDXList=function(r,a,i,o,c,l,u){var d=e.SdxCache.GetSdxList(o,i);r.setFlag(e.FlagName.DmsRequestCachedFlag,d!=t),d==t?e.DMSHandler.GetDMSPackageList(a,i,o,c,l,function(r){if(r.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("GetDMSPackageList request to DMS failed with status = "+r.status+".",t,t,37291604),void u({status:r.status,value:t});var a=n.jsonSerializer.Deserialize(r.value);if(a==t)return s.RuntimeTelemetryHelper.LogExceptionTag("GetDMSPackageList DMS response could not be parsed.",t,t,37291605),void u({status:e.DataServiceResultCode.Failed,value:t});e.SdxCache.CacheSdxList(a,o,i),u({status:e.DataServiceResultCode.Succeeded,value:a})}):u({status:e.DataServiceResultCode.Succeeded,value:d})},n.activateAsync=function(r,a,o,c,l){o.startActivity(e.Activity.Activation),o.startActivity(e.Activity.ServerCall);var u=e.CatalogFactory.getHostContext(),d=i.getManifestHostType(u.hostType);s.RuntimeTelemetryHelper.LogCommonMessageTag('Start activating SDX with assetId ".'+r.assetId+'".',o.correlationId,37291606),n.GetSDXList(o,u.sdxDmsUrl,u.appUILocale,d,c,l,function(d){if(d.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Retrieving SDX list failed.",t,t,37291607),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,i.ErrorStatusCodes.WAC_AgaveActivationError,r,a,o,c,l);for(var p=t,f=0,m=d.value.Packages;f<m.length;f++){var g=m[f];if(g.AssetId.toLowerCase()==r.assetId.toLowerCase()){p=g;break}}if(p==t)return s.RuntimeTelemetryHelper.LogExceptionTag('Unable to find SDX with assetId "'+r.assetId+'".',t,t,37291608),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveNotExist_ERR,i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,r,a,o,c,l);o.startActivity(e.Activity.ManifestRequest),e.SdxCdnHandler.GetManifestFromCdn(u.sdxCdnUrl,p,function(d){if(d.status!=e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("Retrieving SDX manifest from CDN failed.",t,t,37291609),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,i.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,r,a,o,c,l);var f=e.ManifestUtil.ParseManifest(d.value,u.appUILocale,o.correlationId);if(f==t)return s.RuntimeTelemetryHelper.LogExceptionTag("Unable to parse the SDX manifest.",t,t,37291610),void n.generateLoaderError(Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT,r,a,o,c,l);o.stopActivity(e.Activity.ServerCall),o.stopActivity(e.Activity.ManifestRequest);var m=e.SdxCdnHandler.GetManifestCdnUrl(u.sdxCdnUrl,p);a.load({entitlement:r,manifest:f,eToken:"",manifestUrl:m},t)})})},n.jsonSerializer=new e.SafeSerializer,n}();e.SDXCatalog=t}(u||(u={})),function(e){var t=function(){function t(){}return t.GetManifestFromCdn=function(n,r,a){var i=t.GetManifestCdnUrl(n,r);e.SdxWebRequestHandler.SendRequestAsync("GET",i,null,null,a)},t.GetManifestCdnUrl=function(e,t){return i.OUtil.formatString(e,t.AssetId,t.FFN,t.Version,"en-us")},t}();e.SdxCdnHandler=t}(u||(u={})),function(e){var t=function(){function t(){}return t.SendRequestAsync=function(t,n,r,a,i){var o="HTTP request (",c=null;void 0===r&&(r=c),void 0===a&&(a=c);var l=new XMLHttpRequest;if(l.open(t,n,!0),l.onload=function(){if(l.readyState==XMLHttpRequest.DONE){var r=l.status;if(r>=200&&r<300&&l.responseText!=c)return void i({status:e.DataServiceResultCode.Succeeded,value:l.responseText})}s.RuntimeTelemetryHelper.LogExceptionTag(o+t+" "+n+") failed with status code = "+l.status+".",c,c,37291611),i({status:e.DataServiceResultCode.Failed,value:c})},l.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag(o+t+" "+n+") failed with unexpected error.",c,c,37291612),i({status:e.DataServiceResultCode.Failed,value:c})},l.timeout=3e3,l.ontimeout=function(){s.RuntimeTelemetryHelper.LogExceptionTag(o+t+" "+n+") timeout.",c,c,37291613),i({status:e.DataServiceResultCode.Failed,value:c})},a!=c)for(var u in a)l.setRequestHeader(u,a[u]);l.send(r)},t}();e.SdxWebRequestHandler=t}(u||(u={})),function(e){var t=!1,n=null,r=!0,a=function(){function a(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._telemetryContext=e.telemetryContext}return a.prototype.getManifest=function(a,o,s,c){var l=this,u=l;l._telemetryContext.startActivity(e.Activity.ManifestRequest);var d=i.OsfManifestManager.getCachedManifest(o.OfficeExtensionID,o.OfficeExtensionVersion);if(d)return l._telemetryContext.stopActivity(e.Activity.ManifestRequest),l._telemetryContext.stopActivity(e.Activity.ServerCall),void s({status:e.DataServiceResultCode.Succeeded,value:{manifest:d,cached:r}});o.EncodedAbsUrl?a.getManifest(o.EncodedAbsUrl,o.OfficeExtensionID,o.OfficeExtensionVersion,function(r){if(u._telemetryContext.stopActivity(e.Activity.ManifestRequest),u._telemetryContext.stopActivity(e.Activity.ServerCall),r.status==e.DataServiceResultCode.Succeeded){var a=e.ManifestUtil.ParseManifest(r.value.manifest,u._initParam.appUILocale,u._telemetryContext.correlationId);a==n&&(r.status=e.DataServiceResultCode.Failed),s({status:r.status,value:{manifest:a,cached:t}})}else s({status:r.status,value:{manifest:n,cached:t}})},c):s({status:e.DataServiceResultCode.Failed,value:{manifest:n,cached:t}})},a.prototype.activate=function(a,o,s){var c,l=this,u={assetId:o.assetId,appVersion:o.appVersion,storeId:o.storeId,storeType:o.storeType,targetType:o.targetType},d=function(a,c){var d=a.manifest,p=d.getMarketplaceVersion();if(i.OsfManifestManager.cacheManifest(o.assetId,o.appVersion,d),a.cached&&e.ManifestUtil.versionLessThan(p,o.appVersion))m(r);else{if(d.requirementsSupported===t||void 0===d.requirementsSupported&&!s.getRequirementsChecker().isManifestSupported(d)){d.requirementsSupported=t;var f;return f=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(s,{description:f,detailView:r,errorCode:i.ErrorStatusCodes.WAC_AgaveRequirementsError})}if(d.requirementsSupported=r,c&&!s.skipTrust(o)){var g=i.OUtil.formatString(i.Constants.ActivatedCacheKey,o.assetId.toLowerCase(),o.storeType,o.storeId),h=i.OmexClientNames[l._initParam.applicationName];if(!l._cacheManager.GetCacheItem(g,t)&&!s.hasConsent(o)&&!s.isForCustomFunctionSandbox())return void s.askForTrust({anonymous:n,clientName:h,entitlement:u,displayName:d.getDefaultDisplayName(),providerName:d.getProviderName(),iconUrl:d.getDefaultIconUrl(),isSSOAddin:d.isSSOAddin()},function(){l._cacheManager.SetCacheItem(g,r),s.load({entitlement:u,manifest:d,eToken:n},n)})}s.hasConsent(o)&&l._cacheManager.SetCacheItem(g,r),s.load({entitlement:u,manifest:d,eToken:n},n)}},p=function(t){l.getManifest(a,c,function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value.manifest?d(n.value,r):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),p(t)},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})},t)},f=function(t){c?c.OfficeExtensionKillbit?e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,errorCode:i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED}):p(t):e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),l._telemetryContext.startActivity(e.Activity.Activation),l._telemetryContext.startActivity(e.Activity.ServerCall),m(r)},errorCode:i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST})},m=function(r){c=n,l._telemetryContext.startActivity(e.Activity.EntitlementCheck),a.getEntitlementAsync(t,o.targetType,function(t){if(t.status==e.DataServiceResultCode.Succeeded){l._telemetryContext.stopActivity(e.Activity.EntitlementCheck);for(var a,o=n,d=t.value.entitlements,p=0;p<d.length;p++)(a=d[p]).OfficeExtensionID&&u.assetId&&a.OfficeExtensionID.toLowerCase()==u.assetId.toLowerCase()&&(o&&!e.ManifestUtil.versionLessThan(o.OfficeExtensionVersion,a.OfficeExtensionVersion)||(o=a));c=o,f(r)}else e.LoaderUtil.failWithError(s,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){s.restartActivation(),l._telemetryContext.startActivity(e.Activity.Activation),l._telemetryContext.startActivity(e.Activity.ServerCall),m()},errorCode:i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})},r)};m()},a}(),o=function(){function o(t,r){var a=this;void 0===r&&(r=n),a._appDataService={},a._catalogUrlDataService={},a._initParam=t,a._cacheManager=r||new e.AppsDataCacheManager(i.OUtil.getLocalStorage(),new e.SafeSerializer)}return o.prototype.getDataService=function(e,t,n){this.getDataServiceInternal(this._appDataService,e,t,n)},o.prototype.getCatalogUrlDataService=function(e,t,n){this.getDataServiceInternal(this._catalogUrlDataService,e,t,n)},o.prototype.getDataServiceInternal=function(t,r,a,i){if(t[r]==n&&(t[r]={spCatalogService:n,spCatalogServiceReady:n}),t[r].spCatalogService==n)if(t[r].spCatalogServiceReady==n){t[r].spCatalogServiceReady=i;var o={status:e.DataServiceResultCode.Failed,value:n},s=function(a,i){var s=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=n,a.status==e.DataServiceResultCode.Succeeded?(t[r].spCatalogService=i,o.value=i,o.status=e.DataServiceResultCode.Succeeded,s(o)):(o.httpStatus=a.httpStatus,s(o))};a.startActivity(e.Activity.Authentication);var c=e.SPCatalogProxyBasedCatalogService.getInstance(this._initParam);c.prepareProxy(r,a.correlationId,function(t){a.stopActivity(e.Activity.Authentication),s(t,c)})}else{var l=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=function(e){l(e),i(e)}}else i({status:e.DataServiceResultCode.Succeeded,value:t[r].spCatalogService})},o.prototype.createActivityScope=function(t,n,r){var i=this;this.getDataService(t,n,function(o){if(!e.AsyncUtil.failed(o,r)){var s=o.value,c={cacheManager:i._cacheManager,storeId:t,telemetryContext:n},l=s.createScope(c),u=new a(c,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:l,activityScope:u}})}})},o.prototype.getEntitlementAsync=function(t,r,a,o,s,c){var l=this,u=function(s){s.status===e.DataServiceResultCode.Succeeded?(l.myOrgCatalogUrl=s.value,l.createActivityScope(s.value,r,function(r){e.AsyncUtil.failed(r,a,[])||r.value.serviceScope.getEntitlementAsync(t,n,function(t){if(!e.AsyncUtil.failed(t,a,[])){for(var n=t.value.entitlements,r=0;r<n.length;r++){var o=n[r];o.assetId=o.OfficeExtensionID,o.appVersion=o.OfficeExtensionVersion,o.storeId=l.myOrgCatalogUrl,o.storeType=i.StoreType.SPCatalog,o.targetType=i.OfficeAppType[o.OEType]}a({status:t.status,value:n})}},o)})):a({status:s.status,value:n})};(c=c||this.myOrgCatalogUrl||n)?u({status:e.DataServiceResultCode.Succeeded,value:c}):this.getSPCatalogUrl(r,u)},o.prototype.getAndCacheManifest=function(a,o,s,c){var l=this;this.getEntitlementAsync(r,s,function(t){if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),t.status===e.DataServiceResultCode.Succeeded&&t.value){for(var r=t.value,o=r.length,u=n,d=0;d<o;d++){var p=r[d];p.OfficeExtensionID&&a.assetId&&p.OfficeExtensionID.toLowerCase()===a.assetId.toLowerCase()&&(u&&!i.OsfManifestManager.versionLessThan(u.OfficeExtensionVersion,p.OfficeExtensionVersion)||(u=p))}u!=n?l.createActivityScope(l.myOrgCatalogUrl,s,function(t){e.AsyncUtil.failed(t,c)||t.value.activityScope.getManifest(t.value.serviceScope,u,function(e){c({status:e.status,value:e.value.manifest})})}):c({status:e.DataServiceResultCode.Failed,value:n})}else c({status:e.DataServiceResultCode.Failed,value:n})},t,0,a.storeId)},o.prototype.activateAsync=function(t,n,r){var a=this;r.startActivity(e.Activity.Activation),r.startActivity(e.Activity.ServerCall),this.createActivityScope(t.storeId,r,function(o){if(o.status==e.DataServiceResultCode.Succeeded){var s=o.value.serviceScope;o.value.activityScope.activate(s,t,n)}else e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),a.activateAsync(t,n,r)},errorCode:i.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})})},o.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},o.prototype.getAppDetails=function(t,n,r,a){a({status:e.DataServiceResultCode.Failed})},o.prototype.getSPCatalogUrl=function(t,n){var r=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,t,function(){e.SPCatalogProxyBasedCatalogService.getInstance(r._initParam).getSPCatalogUrl(r._initParam.spBaseUrl,t.correlationId,n)})},o}();e.CatalogFactory.register(i.StoreType.SPCatalog,function(e){return new o({applicationName:i.HostCapability[e.hostType],AppVersion:e.appVersion,clientMode:e.clientMode,appUILocale:e.appUILocale,spBaseUrl:e.spBaseUrl,docUrl:e.docUrl})})}(u||(u={})),function(e){var t=function(){function e(){}return e.CheckProxyIsReady="OEM_isProxyReady",e.GetEntitlementSummary="OEM_getEntitlementSummaryAsync",e.GetManifest="OEM_getManifestAsync",e.GetSPCatalogUrl="OEM_getSPCatalogUrlAsync",e}();e.SPCatalogProxyMethods=t;var n=function(){function e(){this.iframeProxies={},this.iframeProxyCount=0}return e.iframeNamePrefix="__officeExtensionProxy",e}();e.IframeProxyGroup=n;var r=function(r){var a=null;function o(e,t){r.call(this),this.proxyUrl=e,this.iframeProxyGroup=t}return c(o,r),o.prototype.getEntitlementsAsync=function(e,n){this.invokeProxyCommandAsync(t.GetEntitlementSummary,e,n)},o.prototype.getManifestAsync=function(e,n){this.invokeProxyCommandAsync(t.GetManifest,e,n)},o.prototype.getSPCatalogUrlAsync=function(e,n){this.invokeProxyCommandAsync(t.GetSPCatalogUrl,e,n)},o.prototype.prepareProxy=function(e,t){var n=this;n.isReady?e({status:a,value:{clientEndpoint:n.clientEndPoint}}):n.clientEndPoint?n.pendingCallbacks.push([e,t]):n.createProxy(e,t)},o.resetProxy=function(e){delete e.iframeProxyGroup.iframeProxies[e.proxyUrl],e.iframeProxyGroup.iframeProxyCount=e.iframeProxyGroup.iframeProxyCount-1,Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(i.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=a),e.clientEndPoint=a},o.prototype.createProxy=function(r,c){var l=this;try{if(!l.doesUrlHaveSupportedProtocol(l.proxyUrl))return void c({status:a,value:{errorMessage:"Protocal of proxyUrl is not supported."}});l.iframeProxyGroup.iframeProxies[l.proxyUrl]=l,l.iframeProxyGroup.iframeProxyCount=l.iframeProxyGroup.iframeProxyCount+1;var u=l.proxyUrl,d=u.length;"/"===u.charAt(d-1)&&(u=u.substr(0,d-1));var p=document.createElement("iframe"),f=n.iframeNamePrefix+l.iframeProxyGroup.iframeProxyCount;p.setAttribute("id",f),p.setAttribute("name",f);var m=u+"/_layouts/15/OfficeExtensionManager.aspx?"+l.conversationId;m=i.OUtil.addXdmInfoAsHash(m,l.conversationId+"|"+f+"|"+window.location.href),m=i.OUtil.addSerializerVersionAsHash(m,i.SerializerVersion.Browser),p.setAttribute("scrolling","auto"),p.setAttribute("border","0"),p.setAttribute("width","0"),p.setAttribute("height","0"),p.setAttribute("style","position: absolute; left: -100px; top:0px;");var g=l;document.body.appendChild(p);var h=function(){if(g.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(g.conversationId,p.contentWindow,g.proxyUrl),g.clientEndPoint)g.clientEndPoint.invoke(t.CheckProxyIsReady,function(e,t){var n=a;0===e&&t.status?(g.isReady=!0,n={status:a,value:{clientEndpoint:g.clientEndPoint}}):(o.resetProxy(g),n={status:a,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var r=g.pendingCallbacks.length,i=0;i<r;i++){var s=g.pendingCallbacks.shift();g.isReady?s[0](n):s[1](n)}},{__timeout__:2e3});else{var e="Unexpected error, iframe loaded again after failing OEM_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,a,a,18657365),c({status:a,value:{errorMessage:e}})}};i.OUtil.addEventListener(p,"load",h),p.setAttribute("src",m),l.iframeOnload=h,l.pendingCallbacks.push([r,c]),l.iframe=p}catch(t){var v="Error creating client endpoint with proxyUrl = ["+l.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);c({status:a,value:{errorMessage:v}})}},o}(e.ProxyBase);e.SPCatalogProxy=r}(u||(u={})),function(e){var t=null,n=function(){function n(t){this.proxyRetries={},this.initParams=t,this.iframeProxyGroup=new e.IframeProxyGroup}return n.getInstance=function(e){return n._instance==t&&(n._instance=new n(e)),n._instance},n.prototype.prepareProxy=function(n,r,a){r=r||"";this.proxyRetries[n]=1,this.ensureSPCatalogProxySetUp(n,r,function(n){n&&n.status!=t?n.status:e.DataServiceResultCode.ProxyNotReady;a({status:n.status})})},n.prototype.createScope=function(e){return new r(e,this)},n.prototype.getSPCatalogUrl=function(n,r,o){var c=this;this.prepareProxy(n,r,function(){var l;if(n&&(l=c.iframeProxyGroup.iframeProxies[n])){var u={};u.webUrl=n,l.getSPCatalogUrlAsync(u,function(n){var i="getspcatalogurl failed";n.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(i,t,r,19015125),a.msAjaxDebug.trace(i)),o(n)})}else s.RuntimeTelemetryHelper.LogExceptionTag(i.OUtil.formatString("getspcatalogurl proxy not found, webUrl: {0}",n),t,r,19969545),o({status:e.DataServiceResultCode.ProxyNotReady})})},n.prototype.ensureSPCatalogProxySetUp=function(n,r,a){if(!n)return s.RuntimeTelemetryHelper.LogExceptionTag("proxyUrl is null",t,r,19969546),void a({status:e.DataServiceResultCode.Failed});var o=this.iframeProxyGroup.iframeProxies[n];if(o||(o=new e.SPCatalogProxy(n,this.iframeProxyGroup)),o.isReady)a({status:e.DataServiceResultCode.Succeeded});else{var c=this,l=function(){a({status:e.DataServiceResultCode.Succeeded})},u=function(){c.proxyRetries[n]<i.Constants.AuthenticatedConnectMaxTries?(c.proxyRetries[n]++,o.prepareProxy(l,u)):(s.RuntimeTelemetryHelper.LogExceptionTag("sp exceed maximum tries and fail",t,r,18940555),a({status:e.DataServiceResultCode.ProxyNotReady}))};o.prepareProxy(l,u)}},n}();e.SPCatalogProxyBasedCatalogService=n;var r=function(){var n="clearCache";function r(e,t){this._catalogService=t,this.proxyUrl=e.storeId,this._correlationId=e.telemetryContext.correlationId||""}return r.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},r.prototype.getEntitlementAsync=function(e,t,r,a){var i=this,o=i,s=i._catalogService.iframeProxyGroup.iframeProxies[i.proxyUrl],c={};c.webUrl=i.proxyUrl,c.applicationName=i._catalogService.initParams.applicationName,c.officeExtentionTarget=t,c[n]=a||!1,c.supportedManifestVersions={"1.0":!0,1.1:!0},s.getEntitlementsAsync(c,function(e){o.tryFail(e.status,e.httpStatus,r)?o.logServiceCallResponseError("entitlement",e.httpStatus):r(e)})},r.prototype.getLastStoreUpdate=function(){},r.prototype.getManifest=function(e,t,r,a,i){var o=this,s=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],c={};c.manifestUrl=e,c.id=t,c.version=r,c[n]=i,s.getManifestAsync(c,function(e){o.tryFail(e.status,e.httpStatus,a)?o.logServiceCallResponseError("manifest",e.httpStatus):a(e)})},r.prototype.logServiceCallResponseError=function(e,n){var r="spproxy request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18940556)},r}();e.SPCatalogProxyBasedCatalogServiceScope=r}(u||(u={})),i.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3},i.NotificationType={TrustYellowBar:0,ConsentYellowBar:1,ConsentWhiteDialog:2,TrustPromptTaskpane:3,TrustPromptContent:4},i.ConsentResultCode={Success:0,Cancelled:100,ClientError:400,ServerError:500,UnknownError:600},i.OmexMessageType={ConsentResult:0,TabExit:1,ButtonClick:2,PageLoad:3},i._ErrorUXHelper=function(e){var t="progress_",n="input,a,button",r="moe-infobar-button2_",a=!0,o="moe-infobar-button_",c="moe-infobar-button",l=!1,d="button",p="moe-infobar-dismiss_",f="moe-infobar-dismiss",m="moe-infobar-message",g="moe-infobar-message_",h="moe-infobar-title",v="span",y="moe-infobar-message-div",b="moe-infobar-secinfo",_="moe-infobar-info",S="moe-infobar-warning",C="moe-infobar-error",A="moe-infobar-button-cell",I="moe-infobar-top-right-cell",O="moe-infobar-message-cell",T="moe-infobar-top-left-cell",x="presentation",E="role",M="moe-infobar-infotable",P="table",k="moe-infobar-body",R="alt",w=null,N="100%",D="center",F="no-repeat",L="alpha(opacity=100)",U="1",B="white",j="url(",H="onclick",V="tabindex",W="image",G="type",z="input",q="id",X="moe-background",K="class",J="div",Q="moe-trust-prompt-table_",Y="notificationbackground_",Z="moe-infobar-body_",$="agavedefaulticon96x96.png",ee="moe_status_icons.png",te="progress.gif",ne="img",re=e,ae=re.getOsfOmexBaseUrl(),ie="omexNotificationIframeClassName";i.OUtil.loadCSS(re.getLocalizedCSSFilePath("moeerrorux.css")),document.createElement(ne).src=re.getLocalizedImageFilePath(te),document.createElement(ne).src=re.getLocalizedImageFilePath(ee),document.createElement(ne).src=re.getLocalizedImageFilePath($);var oe={},se=0,ce=function(e){for(var t,n=e.childNodes.length,r=0;r<n;)"iframe"===(t=e.childNodes.item(r)).tagName.toLowerCase()?r++:(e.removeChild(t),n--)},le=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},ue=function(e,t){var n;i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start),n=t?Z+e:Y+e;var r=Me(e);r&&oe[e][0].highPriority&&se--,le(n),r&&oe[e].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},de=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2Start);var t=Q+e.id,n=Me(e.id);n&&oe[e.id][0].highPriority&&se--,le(t),n&&oe[e.id].shift(),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage2End)},pe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1Start),ce(e.div);var t=document.createElement(J);t.setAttribute(K,X),t.setAttribute(q,"icon_"+e.id);var n=document.createElement(z);n.setAttribute(q,"iconImg_"+e.id),n.setAttribute(G,W),n.setAttribute(V,"0"),n.src=re.getLocalizedImageFilePath(ee);var r,a,o;n.setAttribute(H,"getIntoStage2(params)"),i.OUtil.attachClickHandler(n,function(){!function(e){e.sqmDWords[1]|=2,Ae(e.id);var t=u.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):fe(e)}(e)}),t.appendChild(n),e.displayDeactive&&(t.style.backgroundImage=j+re.getLocalizedImageFilePath($)+")",t.style.backgroundColor=B,t.style.opacity=U,t.style.filter=L,t.style.backgroundRepeat=F,t.style.backgroundPosition=D,t.style.height=N),e.infoType===i.InfoType.Error?(r="moe-status-error-icon",a="iconImg_error_"+e.id,o=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(r="moe-status-warning-icon",a="iconImg_warning_"+e.id,o=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(r="moe-status-info-icon",a="iconImg_info_"+e.id,o=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(r="moe-status-secinfo-icon",a="iconImg_secinfo_"+e.id,o=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=w&&9==parseFloat(RegExp.$1)&&(r+="_ie"),n.setAttribute(K,r),n.setAttribute(q,a),n.setAttribute(R,o),0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),Oe(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage1End)},fe=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start),ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,u=document.getElementById(n);null==u&&((u=document.createElement(J)).setAttribute(K,k),u.setAttribute(q,n));var Q=document.createElement(J);Q.innerHTML=t,u.setAttribute("title",Q.textContent),Q=w;var te=document.createElement(P);te.setAttribute(K,M),te.setAttribute(E,x);for(var ae=0;ae<3;ae++)te.insertRow(ae).setAttribute(E,x);var ie=te.rows;ie[0].insertCell(0),ie[0].insertCell(1),ie[0].insertCell(2),ie[0].cells[1].setAttribute("rowSpan","2"),ie[1].insertCell(0),ie[1].insertCell(1),ie[2].insertCell(0),ie[2].insertCell(1),ie[2].insertCell(2),ie[0].cells[0].setAttribute(K,T),ie[0].cells[1].setAttribute(K,O),ie[0].cells[2].setAttribute(K,I),ie[2].cells[1].setAttribute(K,A);var oe,se,le=document.createElement(ne);le.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(oe=C,se=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(oe=S,se=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(oe=_,se=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(oe=b,se=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),le.setAttribute(K,oe),le.setAttribute(R,se),ie[0].cells[0].appendChild(le);var de=document.createElement("a");de.setAttribute(K,y),de.setAttribute(V,U);var pe=document.createElement(v);pe.setAttribute(K,h),pe.innerHTML=e.title;var fe=g+e.id,me=document.getElementById(fe);null==me&&((me=document.createElement(v)).setAttribute(K,m),me.setAttribute(q,fe)),me.innerHTML=e.description,de.appendChild(pe),de.appendChild(me),ie[0].cells[1].appendChild(de);var ge=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},he=function(){e.sqmDWords[1]|=8,ge(e),!e.reDisplay&&ue(e.id,e.displayDeactive),Ae(e.id),e.reDisplay?xe(e):Ee(e.id),e.dismissCallback&&e.dismissCallback()},ve=document.createElement(z);ve.setAttribute(G,W),ve.setAttribute("src",re.getLocalizedImageFilePath(ee)),ve.setAttribute(K,f),ve.setAttribute(q,p+e.id),ve.setAttribute(V,"0"),ve.setAttribute(R,Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT),ve.setAttribute(E,d),ve.setAttribute(H,"handleDismiss();"),i.OUtil.attachClickHandler(ve,he),ie[0].cells[2].appendChild(ve),e.detailView=l;var ye=document.createElement(d);if(ye.setAttribute(K,c),ye.innerHTML=e.buttonTxt,ye.setAttribute(q,o+e.id),ye.setAttribute(V,U),ye.setAttribute(G,d),e.buttonCallback){ye.setAttribute(H,"handleButtonClick()"),i.OUtil.attachClickHandler(ye,function(){if(e.sqmDWords[1]|=4,ge(e),ue(e.id,l),Ae(e.id),Ee(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=w,re.retryAll(t._marketplaceID)}e.buttonCallback()})}else ye.setAttribute(H,"handleDismiss()"),i.OUtil.attachClickHandler(ye,he);if(ie[2].cells[1].appendChild(ye),e.url){var be=document.createElement(d);be.setAttribute(K,c),be.innerHTML=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,be.setAttribute(q,r+e.id),be.setAttribute(H,"moreInfoButtonClick()"),i.OUtil.attachClickHandler(be,function(){e.sqmDWords[1]|=4,ge(e),e.sqmDWords[1]=1,window.open(e.url)}),be.setAttribute(V,U),be.setAttribute(G,d),ie[2].cells[1].appendChild(be)}u.appendChild(te);var _e=document.createElement(J);_e.setAttribute(K,X),_e.setAttribute(q,Y+e.id),e.displayDeactive&&(_e.style.backgroundImage=j+re.getLocalizedImageFilePath($)+")",_e.style.backgroundColor=B,_e.style.opacity=U,_e.style.filter=L,_e.style.backgroundRepeat=F,_e.style.backgroundPosition=D,_e.style.height=N),_e.appendChild(u),0!=e.div.childNodes.length?e.div.insertBefore(_e,e.div.childNodes[0]):e.div.appendChild(_e),Oe(e.id,i.AgaveHostAction.TabIn),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},me=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,r=document.getElementById(n);null==r&&((r=document.createElement(J)).className=k,r.id=n),r.title=t,e.iframeNotificationUrl?r.appendChild(ve(e,r)):r.appendChild(he(e));var a=document.createElement(J);a.className=X,a.id=Y+e.id,e.displayDeactive&&(a.style.backgroundImage=j+re.getLocalizedImageFilePath($)+")",a.style.backgroundColor=B,a.style.opacity=U,a.style.filter=L,a.style.backgroundRepeat=F,a.style.backgroundPosition=D,a.style.height=N),a.appendChild(r),0!=e.div.childNodes.length?e.div.insertBefore(a,e.div.childNodes[0]):e.div.appendChild(a),Oe(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show infobar, error message: ",e,w,23455900)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},ge=function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=function(e){function t(e,t){var n=e.insertRow(-1);n.className="moe-trust-prompt-row "+t,n.setAttribute(E,x),n.insertCell(-1).className="moe-trust-prompt-cell"}e.id;var n=Q+e.id,r=document.getElementById(n);r===w&&((r=document.createElement(P)).id=n,r.className="moe-trust-prompt-table",r.setAttribute(E,x)),t(r.createTHead(),"moe-trust-prompt-header");var a=r.createTBody();return t(a,"moe-trust-prompt-preview"),t(a,"moe-trust-prompt-description"),t(r.createTFoot(),"moe-trust-prompt-footer"),r}(e),n=t.rows,r=function(e){var t=document.createElement("p");return t.innerHTML=e.notificationType===i.NotificationType.TrustPromptContent?e.name:e.title,t.className="moe-trust-prompt-header-title",t}(e);n[0].cells[0].appendChild(r);var o=function(e){var t=document.createElement(ne);return t.src=e.icon,t.className="moe-trust-prompt-preview-img",t.setAttribute(R,e.iconTitle),t}(e),c=function(e){var t=document.createElement("p");return t.innerHTML=e.name,t.className="moe-trust-prompt-preview-title",t}(e),l=function(e){var t=document.createElement("p");return t.innerHTML=e.provider,t.className="moe-trust-prompt-preview-sub",t}(e);n[1].cells[0].appendChild(o),n[1].cells[0].appendChild(c),n[1].cells[0].appendChild(l);var u=function(e){var t=document.createElement("p");return t.innerHTML=e.description,t.className="moe-trust-prompt-description-text",t}(e);n[2].cells[0].appendChild(u);var p=function(){var t,n=document.createElement(d);return n.textContent=e.buttonTxt,n.className="moe-trust-prompt-button moe-trust-prompt-button-primary moe-trust-prompt-buttons-action",n.id="moe-trust-prompt-buttons-action_"+e.id,n.tabIndex=0,n.type=d,t=e.buttonCallback?function(){if(e.sqmDWords[1]|=4,_e(e),de(e),Ae(e.id),Ee(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=w,re.retryAll(t._marketplaceID)}e.buttonCallback()}:function(){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&de(e),Ae(e.id),e.reDisplay?xe(e):Ee(e.id),e.dismissCallback&&e.dismissCallback()},i.OUtil.attachClickHandler(n,t),n}();if(n[3].cells[0].appendChild(p),e.url!==w){var f=function(e){var t=document.createElement(d);return t.textContent=e.urlButtonTxt||Strings.OsfRuntime.L_MoreInfoButton_TXT,t.className="moe-trust-prompt-button moe-trust-prompt-buttons-url",t.id="moe-trust-prompt-buttons-url_"+e.id,t.tabIndex=1,t.type=d,i.OUtil.attachClickHandler(t,function(){e.sqmDWords[1]|=4,_e(e),window.open(e.url)}),t}(e);n[3].cells[0].appendChild(f)}var m=function(e){var t=document.createElement(J);t.className="moe-trust-prompt-collapse cui-ctl-iconContainer cui-img-cont-float cui-img-16by16";var n=document.createElement(ne);switch(e.clientName){case"WAC_Powerpoint":n.src=re.getLocalizedImageFilePath("per.png"),n.className="per_UpChevron_16x16x32";break;case"WAC_Word":n.src=re.getLocalizedImageFilePath("we.png"),n.className="we_UpChevron_16x16x32";break;case"WAC_Excel":n.src=re.getLocalizedImageFilePath("EwaEdit.png"),n.className="ewaboot_UpChevron16"}return n.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.appendChild(n),i.OUtil.attachClickHandler(t,function(){var t="collapsed";e.collapsed===a?e.div.classList.remove(t):e.div.classList.add(t),e.collapsed=!e.collapsed}),t}(e);0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),e.div.appendChild(m),e.div.style.overflowY="auto",e.div.classList.add("moe-trust-prompt"),e.div.classList.add(e.clientName),e.div.classList.add(e.notificationType===i.NotificationType.TrustPromptContent?"content-add-in":"taskpane-add-in"),Oe(e.id,i.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show trust prompt, error message: ",e,w,38592974)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderStage2End)},he=function(e){var t=ye(e),n=t.rows;n[0].cells[0].appendChild(be(e));var s=document.createElement("a");s.className=y,s.tabIndex=1;var u=document.createElement(v);u.className=h,u.textContent=e.title;var p=g+e.id,f=document.getElementById(p);null==f&&((f=document.createElement(v)).className=m,f.id=p),f.textContent=e.description,s.appendChild(u),s.appendChild(f),n[0].cells[1].appendChild(s);var b=function(){Se(e)},_=Ce(e);i.OUtil.attachClickHandler(_,b),n[0].cells[2].appendChild(_),e.detailView=l;var S=document.createElement(d);if(S.className=c,S.textContent=e.buttonTxt,S.id=o+e.id,S.tabIndex=1,S.type=d,e.buttonCallback){i.OUtil.attachClickHandler(S,function(){if(e.sqmDWords[1]|=4,_e(e),ue(e.id,l),Ae(e.id),Ee(e.id),e.retryAll===a){var t=re.getOsfControl(e.id);t._retryActivate=w,re.retryAll(t._marketplaceID)}e.buttonCallback()})}else i.OUtil.attachClickHandler(S,b);if(n[2].cells[1].appendChild(S),e.url){var C=document.createElement(d);C.className=c,C.textContent=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,C.id=r+e.id,i.OUtil.attachClickHandler(C,function(){e.sqmDWords[1]|=4,_e(e),e.sqmDWords[1]=1,window.open(e.url)}),C.tabIndex=1,C.type=d,n[2].cells[1].appendChild(C)}return t},ve=function(e,t){var n="message",r=ye(e),o=r.rows,c=document.createElement("iframe");window.getComputedStyle(e.div,w);c.width=N,c.frameBorder="0",c.className=ie,c.src=e.iframeNotificationUrl,o[0].cells[1].appendChild(c);var u="moe-hovered";t.addEventListener("mouseenter",function(){i.OUtil.addClass(t,u),c.contentWindow.postMessage(i.AgaveHostAction.MouseEnter,ae)}),t.addEventListener("mouseleave",function(){i.OUtil.removeClass(t,u),c.contentWindow.postMessage(i.AgaveHostAction.MouseLeave,ae)}),e.detailView=l;var d=w,p=Ce(e);return i.OUtil.attachClickHandler(p,function(){Se(e),window.removeEventListener(n,d)}),o[0].cells[2].appendChild(p),p.addEventListener("keydown",function(e){9==e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),c.contentWindow.postMessage(i.AgaveHostAction.TabInShift,ae))}),e.buttonCallback&&(d=function(t){try{if(t.source==c.contentWindow){var r=JSON.parse(t.data),o=parseInt(r[i.OmexMessageKeys.MessageType]),u=parseInt(r[i.OmexMessageKeys.MessageValue]);if(o==i.OmexMessageType.ConsentResult){if(ue(e.id,l),Ae(e.id),Ee(e.id),e.retryAll===a&&(e.notificationType==i.NotificationType.TrustYellowBar||e.notificationType==i.NotificationType.ConsentYellowBar&&u==i.ConsentResultCode.Success)){var f=re.getOsfControl(e.id);f._retryActivate=w,re.retryAll(f._marketplaceID)}window.removeEventListener(n,d),e.buttonCallback(u)}else o==i.OmexMessageType.TabExit&&(u==i.AgaveHostAction.TabExitShift&&re._notifyHost?re._notifyHost(e.id,i.AgaveHostAction.TabExitShift):u==i.AgaveHostAction.TabExit&&(window.focus(),p.focus()))}}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Exception in receivedMessageHandler: ",e,w,23455901)}},window.addEventListener(n,d)),r},ye=function(e){var t=document.createElement(P);t.className=M,t.setAttribute(E,x);for(var n=e.iframeNotificationUrl?1:3,r=0;r<n;r++){t.insertRow(r).setAttribute(E,x)}var a=t.rows;return a[0].insertCell(0),a[0].insertCell(1),a[0].insertCell(2),a[0].cells[1].setAttribute("rowSpan","2"),a[0].cells[0].setAttribute(K,T),a[0].cells[1].setAttribute(K,O),a[0].cells[2].setAttribute(K,I),e.iframeNotificationUrl==w&&(a[1].insertCell(0),a[1].insertCell(1),a[2].insertCell(0),a[2].insertCell(1),a[2].insertCell(2),a[2].cells[1].setAttribute(K,A)),a[0].cells[0].appendChild(be(e)),t},be=function(e){var t,n,r=document.createElement(ne);return r.src=re.getLocalizedImageFilePath(ee),e.infoType===i.InfoType.Error?(t=C,n=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===i.InfoType.Warning?(t=S,n=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===i.InfoType.Information?(t=_,n=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(t=b,n=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),r.className=t,r.alt=n,r},_e=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},Se=function(e){e.sqmDWords[1]|=8,_e(e),!e.reDisplay&&ue(e.id,e.displayDeactive),Ae(e.id),e.reDisplay?xe(e):Ee(e.id),e.dismissCallback&&e.dismissCallback()},Ce=function(e){var t=document.createElement(z);return t.type=W,t.src=re.getLocalizedImageFilePath(ee),t.className=f,t.id=p+e.id,t.tabIndex=0,t.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.setAttribute(E,d),t},Ae=function(e){var t=re.getOsfControl(e);t&&(t._controlFocus=a)},Ie=function(e){var t=re.getOsfControl(e);if(t&&!Me(e))if(t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready)t.notifyAgave(i.AgaveHostAction.TabIn);else{var n="_trySetFocusInAppContent$newCallback";if(t._notifyHostIFrameOnLoaded&&t._notifyHostIFrameOnLoaded.newCallbackIdentity&&t._notifyHostIFrameOnLoaded.newCallbackIdentity===n)return;var r=function(e){return function(){if(e)try{e()}catch(e){}t.getStatus()===i.OsfControlStatus.Activated&&t.getPageStatus()===i.OsfControlPageStatus.Ready&&t.notifyAgave(i.AgaveHostAction.TabIn),t._notifyHostIFrameOnLoaded=e}}(t._notifyHostIFrameOnLoaded);r.newCallbackIdentity=n,t._notifyHostIFrameOnLoaded=r}},Oe=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Me(e)){var a=oe[e][0];if(a&&a.div)if(a.iframeNotificationUrl!=w){var o=a.div.getElementsByClassName(ie)[0];o&&(o.contentWindow.postMessage(i.AgaveHostAction.TabIn,ae),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}else{var s=a.div.querySelectorAll(n);if(s&&s.length>0){var c=s[0];c instanceof HTMLElement&&(window.focus(),c.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r.notifyAgave(t)},Te=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(Me(e)){var a=oe[e][0];if(a&&a.div){var o=a.div.querySelectorAll(n);if(o&&o.length>0){var s=o.length>1?o[1]:o[0];s instanceof HTMLElement&&(window.focus(),s.focus(),re._notifyHost&&re._notifyHost(e,i.AgaveHostAction.SelectWithError))}}}else r._controlFocus=l,re._notifyHost(e,t)},xe=function(e){var t=u.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),n=t&&t.enableNewTrustPromptForAddIn;e.notificationType!==i.NotificationType.TrustPromptContent&&e.notificationType!==i.NotificationType.TrustPromptTaskpane||!n?null==e.detailView||e.detailView===l?(e.sqmDWords[1]=0,pe(e)):(e.sqmDWords[1]=1,t&&t.enableSingleSignOnForAddin?me(e):fe(e)):ge(e)},Ee=function(e){if(Me(e)){var t=oe[e][0];xe(t)}else Ie(e)},Me=function(e){return oe[e]&&oe[e].length>0};return{showProgress:function(e,n){try{if(i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationStart),!document.getElementById(t+n)){oe[n]=[];var r=document.createElement(J);r.setAttribute(K,X),r.setAttribute(q,t+n),r.style.backgroundColor="rgba(255, 255, 255, 0.5)",r.style.opacity=U,r.style.filter=L,r.style.height=N;var a=document.createElement(J);a.style.width=N,a.style.height=N,a.style.backgroundImage=j+re.getLocalizedImageFilePath(te)+")",a.style.backgroundRepeat=F,a.style.backgroundPosition=D,r.appendChild(a),e.appendChild(r)}i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(e){}},showNotification:function(e){e.sqmDWords=[e.errorCode,0],delete e.errorCode,null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?a:l),null==e.reDisplay&&(e.reDisplay=e.infoType===i.InfoType.Error?a:l);var t=oe[e.id];void 0===t&&(t=[],oe[e.id]=t),e.highPriority===l?t.push(e):(t.splice(se,0,e),se++),(1===oe[e.id].length||e.highPriority)&&xe(t[0])},showICon:function(e){pe(e)},removeDOMElement:function(e){le(e)},removeProgressDiv:function(e,n){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationStart),e.ownerDocument.getElementById(t+n)&&ce(e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(e){!function(e){i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1Start),le("icon_"+e),i.OUtil.writeProfilerMark(i.NotificationUxPerfMarker.RemoveStage1End)}(e)},removeInfoBarDiv:function(e,t){ue(e,t)},dismissMessages:function(e){!function(e){if(oe[e]){if(oe[e].length>0){var t=oe[e][0].div;ce(t)}delete oe[e]}}(e)},getHTMLEncodedString:function(e){return function(e){var t=document.createElement(J),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}(e)},purgeOsfControlNotification:function(e){var t=oe[e],n=re.getOsfControl(e);t&&t.length>0&&n&&s.AppNotificationHelper.LogNotification(e,t[0].sqmDWords[0],t[0].sqmDWords[1])},focusOnNotificationUx:function(e,t){Ae(e),Oe(e,t)},focusOnNotificationUxShiftIn:function(e,t){Ae(e),Te(e,t)},appHasNotifications:function(e){return Me(e)}}},function(e){var t=function(){function e(){}return e.setHostFeatureEnabledInfo=function(e){this._hostFeatureEnabledInfo=e},e.getHostFeatureEnabledInfo=function(){return this._hostFeatureEnabledInfo},e}();e.HostFeatureEnabledInfo=t}(u||(u={})),i.OUtil.setNamespace("AppSpecificSetup",i),i.ContextActivationManager=function(e){var t="0",n="osfControl for the given ID doesn't exist.",r=null,o=!0,c=!1,l=this;if(i.OUtil.validateParamObject(e,{appName:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},clientMode:{type:Number,mayBeNull:c},appUILocale:{type:String,mayBeNull:c},dataLocale:{type:String,mayBeNull:c},osfOmexBaseUrl:{type:String,mayBeNull:o},devCatalogUrl:{type:String,mayBeNull:o},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:o},sdxCdnUrl:{type:String,mayBeNull:o},sdxDmsUrl:{type:String,mayBeNull:o},spBaseUrl:{type:String,mayBeNull:o},docUrl:{type:String,mayBeNull:o},hostControl:{type:Object,mayBeNull:o},pageBaseUrl:{type:String,mayBeNull:o},lcid:{type:String,mayBeNull:o},formFactor:{type:String,mayBeNull:o},controlStatusChanged:{type:Object,mayBeNull:o},notifyHost:{type:Object,mayBeNull:o},allowExternalMarketplace:{type:Boolean,mayBeNull:o},localizedScriptsUrl:{type:String,mayBeNull:o},localizedImagesUrl:{type:String,mayBeNull:o},localizedStylesUrl:{type:String,mayBeNull:o},localizedResourcesUrl:{type:String,mayBeNull:o},trustAgaves:{type:Boolean,mayBeNull:o},enableAddinCommands:{type:Boolean,mayBeNull:o},enableBlackForestRedirect:{type:Boolean,mayBeNull:o},enableMyOrg:{type:Boolean,mayBeNull:o},enableMyApps:{type:Boolean,mayBeNull:o},enableDevCatalog:{type:Boolean,mayBeNull:o},enableOneDriveCatalog:{type:Boolean,mayBeNull:o},enablePrivateCatalog:{type:Boolean,mayBeNull:o},enableTaskpaneUpgradeToAppCommand:{type:Boolean,mayBeNull:o},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:o},enableV1RedirectApis:{type:Boolean,mayBeNull:o},omexForceAnonymous:{type:Boolean,mayBeNull:o},userNameHashCode:{type:Number,mayBeNull:o},hostFullVersion:{type:String,mayBeNull:o},envCode:{type:String,mayBeNull:o},showSignOutFromPrivateCatalogMessage:{type:Boolean,mayBeNull:o},enableSingleSignOnForAddin:{type:Boolean,mayBeNull:o},enableServiceDeliveredExperience:{type:Boolean,mayBeNull:o},hideAppsExtensionUrl:{type:String,mayBeNull:o},enableInsertDialogAccessibilityFix:{type:Boolean,mayBeNull:o},disableLogging:{type:Boolean,mayBeNull:o},enableDisplayBlockedMinorError:{type:Boolean,mayBeNull:o},enableFirstPartySSO:{type:Boolean,mayBeNull:o},enableFirstPartySSOResourceCheck:{type:Boolean,mayBeNull:o},enableFirstPartyUseWopiIdentity:{type:Boolean,mayBeNull:o},disableAppsForOfficeThirdParty:{type:Boolean,mayBeNull:o},wacSessionId:{type:String,mayBeNull:o},enableFirstPartySDXErrorMessages:{type:Boolean,mayBeNull:o},isHostDocumentDomain:{type:Boolean,mayBeNull:o},enableRichApiCellEditDelay:{type:Boolean,mayBeNull:o},enableNewTrustPromptForAddIn:{type:Boolean,mayBeNull:o}},r),l._osfOmexBaseUrl=e.osfOmexBaseUrl,l._devCatalogUrl=e.devCatalogUrl,l._sdxCdnUrl=e.sdxCdnUrl,l._sdxDmsUrl=e.sdxDmsUrl,l._firstPartyManifestCDNUrl=e.firstPartyManifestCDNUrl,l._oneDriveCatalogBaseApiUrl=e.oneDriveCatalogBaseApiUrl,l._spBaseUrl=e.spBaseUrl,l._myOrgCatalogUrl=r,l._enableAddinCommands=e.enableAddinCommands||c,l._enableBlackForestRedirect=e.enableBlackForestRedirect||c,l._enableInsertDialogAccessibilityFix=e.enableInsertDialogAccessibilityFix||c,l._enableFirstPartySDXErrorMessages=e.enableFirstPartySDXErrorMessages||c,l._enableMyOrg=e.enableMyOrg||c,l._enableMyApps=e.enableMyApps||c,l._enableDevCatalog=e.enableDevCatalog||c,l._enableOneDriveCatalog=e.enableOneDriveCatalog||c,l._enablePrivateCatalog=e.enablePrivateCatalog||c,l._showSignOutFromPrivateCatalogMessage=e.showSignOutFromPrivateCatalogMessage||c,l._enableTaskpaneUpgradeToAppCommand=e.enableTaskpaneUpgradeToAppCommand||c,l._enableUploadFileDevCatalog=e.enableUploadFileDevCatalog||c,l._enableV1RedirectApis=e.enableV1RedirectApis||c,l._appName=e.appName,l._appVersion=e.appVersion,l._clientMode=e.clientMode,l._appUILocale=e.appUILocale,l._dataLocale=e.dataLocale,l._docUrl=e.docUrl,l._hostControl=e.hostControl,l._formFactor=e.formFactor||i.FormFactor.Default,l._pageBaseUrl=e.pageBaseUrl,l._lcid=e.lcid,l._controlStatusChanged=e.controlStatusChanged,l._notifyHost=e.notifyHost||function(){},l._allowExternalMarketplace=e.allowExternalMarketplace,l._localizedScriptsUrl=e.localizedScriptsUrl,l._localizedImagesUrl=e.localizedImagesUrl,l._localizedStylesUrl=e.localizedStylesUrl,l._localizedResourcesUrl=e.localizedResourcesUrl,l._autoTrusted=e.trustAgaves,l._omexForceAnonymous=e.omexForceAnonymous||c,l._userNameHashCode=e.userNameHashCode||0,l._hostFullVersion=e.hostFullVersion,l._wacHostEnvironment=e.envCode,l._enableSingleSignOnForAddin=e.enableSingleSignOnForAddin||c,l._enableFirstPartySSO=e.enableFirstPartySSO||c,l._enableFirstPartySSOResourceCheck=e.enableFirstPartySSOResourceCheck||c,l._enableFirstPartyUseWopiIdentity=e.enableFirstPartyUseWopiIdentity||c,l._enableServiceDeliveredExperience=e.enableServiceDeliveredExperience||o,l._hideAppsExtensionUrl=l._osfOmexBaseUrl+e.hideAppsExtensionUrl,l._disableLogging=e.disableLogging||c,l._enableDisplayBlockedMinorError=e.enableDisplayBlockedMinorError||c,l._disableAppsForOfficeThirdParty=e.disableAppsForOfficeThirdParty||c,l._isHostDocumentDomain=e.isHostDocumentDomain||c,l._enableRichApiCellEditDelay=e.enableRichApiCellEditDelay||c,l._loggableUserId=e.loggableUserId,l._sessionStartInfoJson=e.sessionStartInfoJson,l._enableNewTrustPromptForAddIn=e.enableNewTrustPromptForAddIn||c,u.HostFeatureEnabledInfo.setHostFeatureEnabledInfo(e),l._pageBaseUrl&&"/"!==l._pageBaseUrl.charAt(l._pageBaseUrl.length-1)&&(l._pageBaseUrl=l._pageBaseUrl+"/"),l._localizedResourcesUrl&&"/"!==l._localizedResourcesUrl.charAt(l._localizedResourcesUrl.length-1)&&(l._localizedResourcesUrl=l._localizedResourcesUrl+"/"),l._clientId=i.OUtil.getUniqueId(),l._cachedOsfControls={},l._iframeAttributeBag={},l._serviceEndPoint=r,l._serviceEndPointInternal=r,l._internalConversationId=r,l._iframeProxies={},l._iframeProxyCount=0,l._iframeNamePrefix="__officeExtensionProxy",l._webUrl=r,l._wsa=r,l._insertDialogDiv=r,l._hasPreloadedOfficeJs=c,l._contextMgrCorrelationId=e.wacSessionId||i.OUtil.Guid.generateNewGuid(),s.RuntimeTelemetryHelper.LogCommonMessageTag("_contextMgrCorrelationId :"+l._contextMgrCorrelationId,r,20194265),l._hostType=r,l._hostPlatform=r,l._hostSpecificFileVersion=r,l._requirementsChecker=new i.RequirementsChecker,l._onClickInstallOsfControl=r,l._osfOmexBaseUrl){var d,p=l._osfOmexBaseUrl.indexOf(i.Constants.ProtocolSeparator);d=p>=0?l._osfOmexBaseUrl.substr(p):i.Constants.ProtocolSeparator+l._osfOmexBaseUrl;var f=i.Constants.Https+d,m=i.Constants.Https+d;i.OUtil.getQueryStringParamValue(window.location.search,i.Constants.OmexForceAnonymousParamName).toLowerCase()==i.Constants.OmexForceAnonymousParamValue.toLowerCase()?(l._omexAuthNStatus=i.OmexAuthNStatus.Anonymous,l._omexForceAnonymous=o):l._omexAuthNStatus=i.OmexAuthNStatus.NotAttempted,l._omexGatedWSProxy={proxyUrl:f+i.Constants.OmexGatedServiceExtension,proxyName:"__omexExtensionGatedProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},l._omexWSProxy={proxyUrl:m+i.Constants.OmexUnGatedServiceExtension,proxyName:"__omexExtensionProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},l._omexAnonymousWSProxy={proxyUrl:f+i.Constants.OmexAnonymousServiceExtension,proxyName:"__omexExtensionAnonymousProxy",isReady:c,clientEndPoint:r,pendingCallbacks:[]},l._omexBillingMarket=r,l._omexEndPointBaseUrl=m}l._isFromWacAutomation=function(){if(void 0!==this._isFromWacAutomation&&this._isFromWacAutomation!==r)return this._isFromWacAutomation;try{for(var e=window,t=void 0;e!==t;){if(!e.location||!e.location.search)return c;if(e.location.search.toLowerCase().indexOf("automation=1")>=0)return o;t=e,e=e.parent}}catch(e){return c}return c}(),i.OsfManifestManager._setUILocale(l._appUILocale);var g=l;if(g.getContextForEmbeddingPage=function(){var e=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var t=g._hostSpecificFileVersion.split("."),n=t[1];isNaN(n)||(e=parseInt(t[1]))}var r=g._requirementsChecker._getSupportedSet();return{appName:g._appName,appVersion:g._appVersion,appUILocal:g._appUILocale,dataLocale:g._dataLocale,docUrl:g._docUrl||window.location.href,clientMode:g._clientMode,minorVersion:e,requirements:r}},l._enableServiceDeliveredExperience)var h=function(e){var t=e&&e.contextId?g.getOsfControl(e.contextId):r;switch(e.id){case i.MessageIDs.FetchBundleUrl:if(!t._agaveEndPoint){var n=t._conversationId+i.SharedConstants.NotificationConversationIdSuffix;t._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n,t._frame.contentWindow,t._iframeUrl)}if(t._bundleUrl){var o={id:i.MessageIDs.LoadReactBundle,bundleUrl:t._bundleUrl};t.sendMessageToSdx(o)}break;case i.MessageIDs.LoadBundleSuccess:t._pageStatus=i.OsfControlPageStatus.Ready,t._contextActivationMgr._ErrorUXHelper&&t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id);break;case i.MessageIDs.LoadBundleError:break;default:a.msAjaxDebug.trace("MessageID: "+e.id+" onMessageFromSdx got wrong message.")}};var v=function(e,t){e.hasOwnProperty("fromInsertDialog")&&!e.fromInsertDialog||g._insertDialogDiv!=r&&2==g._insertDialogDiv.childNodes.length&&g._insertDialogDiv.removeChild(g._insertDialogDiv.lastChild);var n,o=i.OUtil.Guid.generateNewGuid(),s=new u.InsertDialogTelemetryContext(o);e.storeType==i.StoreTypeEnum.MarketPlace?n={storeType:i.StoreType.OMEX,storeLocator:g._osfOmexBaseUrl}:e.storeType==i.StoreTypeEnum.Catalog?n={storeType:i.StoreType.SPCatalog,storeLocator:g._myOrgCatalogUrl}:e.storeType==i.StoreTypeEnum.OneDrive&&(n={storeType:i.StoreType.OneDrive,storeLocator:g._oneDriveCatalogBaseApiUrl});var l=e.refresh,d={assetId:"",contentMarket:"",anonymous:c,clientEndPoint:r,clearCache:l,clearKilledApps:c,referenceInUse:n,hostType:g._hostType};if(e&&e.storeType==i.StoreTypeEnum.MarketPlace){d.clientVersion=g._getClientVersionForOmex(),d.clientVersion&&(d.clientName=g._getClientNameForOmex(),d.appVersion=g._getAppVersionForOmex());(f=u.CatalogFactory.resolve(i.StoreType.OMEX)).getEntitlementAsync(c,s,Function.createDelegate(g,function(e){if(e.status==u.DataServiceResultCode.Succeeded&&e.value){var n=e.value,a=n.length;0===a&&t({errorCode:i.InvokeResultCode.S_OK});for(var o,c={},d=[],p=0;p<a;p++)c[(o=n[p]).contentMarket]?c[o.contentMarket].push(o.assetId):c[o.contentMarket]=[o.assetId];var m=0,h=function(e,n){if(e.status==u.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&e.value.length>0)for(var r=e.value,o=g.getRequirementsChecker(),s=0;s<r.length;s++){if(o.isEntitlementFromOmexSupported(r[s])){var c=[];c.push(r[s].name),c.push(r[s].assetId),c.push(r[s].description),c.push(i.OUtil.getTargetType(r[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(r[s].version)),c.push(r[s].assetId),c.push(i.StoreType.OMEX),c.push(parseInt(r[s].defaultWidth)),c.push(parseInt(r[s].defaultHeight)),c.push(r[s].iconUrl),c.push(r[s].provider),c.push(n),c.push(i.StoreType.OMEX),d.push(c)}m++}if(m===a){var l={value:d,errorCode:i.InvokeResultCode.S_OK};t(l)}},v=function(e,t){f.getAppDetails(e,t,s,function(e){Function.createDelegate(g,h)(e,t)},l)};for(var y in c)v(c[y],y)}else{var b={value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN};t(b)}}),l)}else if(e&&e.storeType==i.StoreTypeEnum.Catalog){var p=u.CatalogFactory.resolve(i.StoreType.SPCatalog);p.myOrgCatalogUrl=g._myOrgCatalogUrl;p.getEntitlementAsync(c,s,Function.createDelegate(g,function(e){var a;if(i.OUtil.writeProfilerMark(i.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),e.status==u.DataServiceResultCode.Succeeded&&e.value){for(var o,s=e.value,c=s.length,l=[],d=0,p=g.getRequirementsChecker(),f=0;f<c;f++)if(o=s[f],p.isEntitlementFromCorpCatalogSupported(o)){var m=[];m.push(o.Title),m.push(o.OfficeExtensionID),m.push(o.OfficeExtensionDescription),m.push(i.OfficeAppType[o.OEType]),m.push(i.OUtil.normalizeAppVersion(o.OfficeExtensionVersion)),m.push(o.OfficeExtensionID),m.push(i.StoreType.SPCatalog),m.push(parseInt(o.OfficeExtensionDefaultWidth.toString())),m.push(parseInt(o.OfficeExtensionDefaultHeight.toString())),m.push(o.OfficeExtensionIcon),m.push(o.OEProviderName),m.push(n.storeLocator),m.push(i.StoreType.SPCatalog),l.push(m),d++}a=d>0?{value:l,errorCode:i.InvokeResultCode.S_OK}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS}}else a=n.storeLocator?{value:r,errorCode:i.InvokeResultCode.E_GENERIC_ERROR}:{value:r,errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS};t(a)}),l)}else if(e&&e.storeType==i.StoreTypeEnum.OneDrive){i.OsfManifestManager.getOneDriveEntitlementsAsync(d,function(e){var n;e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(n={value:e.value.entitlements,errorCode:i.InvokeResultCode.S_OK},t(n))})}else if(e&&e.storeType==i.StoreTypeEnum.PrivateCatalog){var f;(f=u.CatalogFactory.resolve(i.StoreType.PrivateCatalog)).getEntitlementAsync(c,s,Function.createDelegate(g,function(e){if(e.status!=u.DataServiceResultCode.Unauthenticated)if(e.status===u.DataServiceResultCode.Succeeded&&e.value){var n=e.value;if(0!==n.length){var a;a=n.map(function(e){return{ProductId:e.assetId,AddInState:e.addInState,Version:e.appVersion}});var o=[];f.getAppDetails(a,"",s,Function.createDelegate(g,function(e){if(e.status===u.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&0!==e.value.length){for(var n=e.value,a=g.getRequirementsChecker(),s=0;s<n.length;s++)if(a.isEntitlementFromOmexSupported(n[s])){var c=[];c.push(n[s].name),c.push(n[s].assetId),c.push(n[s].description),c.push(i.OUtil.getTargetType(n[s].appSubType)),c.push(i.OUtil.normalizeAppVersion(n[s].version)),c.push(n[s].assetId),c.push(i.StoreType.PrivateCatalog),c.push(parseInt(n[s].defaultWidth)),c.push(parseInt(n[s].defaultHeight)),c.push(n[s].iconUrl),c.push(n[s].provider),c.push(i.StoreType.PrivateCatalog),c.push(i.StoreType.PrivateCatalog),o.push(c)}t({value:o,errorCode:i.InvokeResultCode.S_OK})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED})}),l)}else t({errorCode:i.InvokeResultCode.E_CATALOG_NO_APPS})}else t({value:r,errorCode:i.InvokeResultCode.E_CATALOG_REQUEST_FAILED});else t({value:r,errorCode:i.InvokeResultCode.E_USER_NOT_SIGNED_IN})}),l)}else a.msAjaxDebug.trace("Unknown store type.")};l._onClickInstallOsfControl=function(e){if(g._enableUploadFileDevCatalog){a.msAjaxDebug.trace("onClickInstallOsfControl!");try{i.OUtil.validateParamObject(e,{manifest:{type:String,mayBeNull:c}},r);var n=new i.Manifest.Manifest(e.manifest,g.getAppUILocale()),l=n.getMarketplaceID(),d=n.getMarketplaceVersion();if(u.CatalogFactory.resolve(i.StoreType.UploadFileDevCatalog).validateAndCacheNewManifest(l,d,e.manifest,n)){var p={id:l,targetType:n.getTarget(),appVersion:d,currentStoreType:i.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:l,assetStoreId:i.StoreType.UploadFileDevCatalog,width:parseInt(n.getDefaultWidth()||t),height:parseInt(n.getDefaultHeight()||t),isAddinCommands:n._isAddinCommandsManifest(i.getManifestHostType(g._hostType))};i.OUtil.validateParamObject(p,{id:{type:String,mayBeNull:c},targetType:{type:Number,mayBeNull:c},appVersion:{type:String,mayBeNull:c},width:{type:Number,mayBeNull:o},height:{type:Number,mayBeNull:o}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,p.currentStoreType,p.assetId,p.appVersion,p.targetType,p.isAddinCommands,p.width,p.height),g._notifyHost(t,i.AgaveHostAction.InsertAgave,p)}else g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}catch(e){var f="Invalid manifest from addincommands dev catalog.";return u.WACUtils.logExceptionToBrowserConsole(f,e),s.RuntimeTelemetryHelper.LogExceptionTag(f,e,this._appCorrelationId,19203548),void g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)}}};var y=function(e){a.msAjaxDebug.trace("onClickRefreshfAddinCommands!"),g._notifyHost(t,i.AgaveHostAction.RefreshAddinCommands,e)},b=function(e){var t=i.OUtil.Guid.generateNewGuid(),n=new u.InsertDialogTelemetryContext(t),a=u.CatalogFactory.resolve(i.StoreType.OMEX),o=new u.PreCacher(g.getRequirementsChecker()),s={assetId:e.assetId,storeType:i.StoreType.OMEX,storeId:e.storeId,appVersion:"",targetType:r};a.activateAsync(s,o,n)},_=function(e,t){if(g._enableSingleSignOnForAddin)S(e,t);else{var n={assetId:e.id,clientVersion:g._getClientVersionForOmex(),clientName:g._getClientNameForOmex(),clientEndPoint:g._omexGatedWSProxy.clientEndPoint},r=g._insertDialogDiv,a={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED},o=i.OUtil.Guid.generateNewGuid(),l=new u.InsertDialogTelemetryContext(o);u.CatalogFactory.resolve(i.StoreType.OMEX).removeAsync([n.assetId],l,function(o){var l=0;if(o.status==u.DataServiceResultCode.Succeeded&&o.value&&o.value.removedApps&&o.value.removedApps.length>0){for(var d=o.value.removedApps,p=i.InvokeResultCode.E_OEM_REMOVED_FAILED,f=0;f<d.length;f++)if(d[f].assetId==n.assetId){d[f].result==i.OmexRemoveAppStatus.Success&&(p=i.InvokeResultCode.S_OK);break}p==i.InvokeResultCode.S_OK&&(l=g.untrustOsfControls(e)),a.errorCode=p}var m=!document.documentElement.contains(r);s.AppManagementMenuHelper.LogAppManagementMenuAction(n.assetId,i.AppManagementAction.Remove,l,m,c,a.errorCode),t(a)})}},S=function(e,n){var r=g._hideAppsExtensionUrl+"&"+i.OmexPageParameterKeys.AppName+"="+i.getModernAppVerCode(g._appName)+"&"+i.OmexPageParameterKeys.AssetId+"="+e.id+"&"+i.OmexPageParameterKeys.AppCorrelationId+"="+g._contextMgrCorrelationId,a=document.createElement("iframe");a.setAttribute("id","serviceExtensionIframe"),a.setAttribute("src",r),a.setAttribute("scrolling","auto"),a.setAttribute("border",t),a.setAttribute("width",t),a.setAttribute("height",t),a.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(a);var o=g._insertDialogDiv,l=function(t){if(t.source==a.contentWindow){var r={errorCode:i.InvokeResultCode.E_OEM_REMOVED_FAILED};document.body.removeChild(a),window.removeEventListener("message",l);var u=0,d=JSON.parse(t.data),p=parseInt(d[i.OmexRemoveAddinMessageKeys.RemoveAddinResultCode]),f=i.InvokeResultCode.E_OEM_REMOVED_FAILED;if(p===i.OmexRemoveAddinResultCode.Success){for(var m=d[i.OmexRemoveAddinMessageKeys.RemoveAddinResultValue],h=0;h<m.length;h++)if(m[h]==e.id){f=i.InvokeResultCode.S_OK;break}f==i.InvokeResultCode.S_OK&&(u=g.untrustOsfControls(e),C(e.id)),r.errorCode=f}var v=!document.documentElement.contains(o);s.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,i.AppManagementAction.Remove,u,v,c,r.errorCode),n(r)}};window.addEventListener("message",l)},C=function(e){var t=".*",n=[];n.push(new RegExp(i.OUtil.formatString(u.WACUtils.CacheConstants.EntitlementsKey,t,t),"i")),n.push(new RegExp(i.OUtil.formatString(u.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,t,e,t,t),"i")),u.WACUtils.removeMatchesFromLocalStorage(n)};if(l._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(l._clientId),l._serviceEndPoint._onHandleRequestError=function(e,t){var n,a,o;e&&(n=e._data)&&((a="string"==typeof(a="object"==typeof n?n[0]:n)?a:r)&&(o=g.getOsfControl(a))&&(o._pageStatus="Failed origin check"===t?i.OsfControlPageStatus.FailedOriginCheck:"Access Denied"===t?i.OsfControlPageStatus.FailedPermissionCheck:i.OsfControlPageStatus.FailedHandleRequest,s.RuntimeTelemetryHelper.LogExceptionTag(t,r,o.getCorrelationId(),19203549)))},l._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",function(e,l){var u="string"==typeof e?e:"object"==typeof e&&e.length>0?e[0]:r;(!u||!l)&&s.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",r,r,19203545);var d=g.getOsfControl(u);if(!d)throw a.msAjaxDebug.trace(n),s.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",r,r,19203546),a.msAjaxError.argument("contextId");s.AppLoadTimeHelper.OfficeJSLoaded(d._telemetryContext);var p=d.getEToken(),f=0;if(g._hostSpecificFileVersion&&-1!=g._hostSpecificFileVersion.indexOf(".")){var m=g._hostSpecificFileVersion.split("."),h=m[1];isNaN(h)||(f=parseInt(m[1]))}var v=g._requirementsChecker._getSupportedSet(),y=new i.OfficeAppContext(d.getMarketplaceID(),g._appName,g._appVersion,g._appUILocale,g._dataLocale,g._docUrl||window.location.href,g._clientMode,d.getSettings(),d.getReason(),d.getOsfControlType(),p,d._appCorrelationId,d.getID(),c,o,f,v,d.getHostCustomMessage(),g._hostFullVersion||i.Constants.FileVersion,window.innerHeight,window.innerWidth,d.getManifest()?d.getManifest().getDefaultDisplayName():r,d._appDomains,void 0);y._wacHostEnvironment=g._wacHostEnvironment||t,y._isFromWacAutomation=!!g._isFromWacAutomation,l(y),d._pageStatus=i.OsfControlPageStatus.Ready,d._pageIsReadyTimerExpired&&s.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",r,d.getCorrelationId(),19203547),d._contextActivationMgr._ErrorUXHelper&&d._contextActivationMgr._ErrorUXHelper.removeProgressDiv(d._div,d._id),d._timer&&(window.clearTimeout(d._timer),d._timer=r);var b=d._conversationId+i.SharedConstants.NotificationConversationIdSuffix;d._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(b,d._frame.contentWindow,d._iframeUrl),s.AppLoadTimeHelper.ActivationEnd(d._telemetryContext)},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",function(e){e&&2==e.length||(!e||3!=e.length||e[1]!==i.AgaveHostAction.UpdateTargetUrl&&e[1]!==i.AgaveHostAction.SendTelemetryEvent)&&a.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var t=e[0],r=e[1],o=g.getOsfControl(t);if(o)if(r===i.AgaveHostAction.TabExitShift||r===i.AgaveHostAction.ExitNoFocusableShift)g._ErrorUXHelper.focusOnNotificationUxShiftIn(t,r);else if(r===i.AgaveHostAction.UpdateTargetUrl){var s=e[2];o.checkAppDomains(s)&&o.updateAgaveEndPointTargetUrl(s)}else if(r===i.AgaveHostAction.SendTelemetryEvent){var c=e[2];o._contextActivationMgr._notifyHost(t,r,c)}else o._contextActivationMgr._notifyHost?o._contextActivationMgr._notifyHost(t,r):a.msAjaxDebug.trace("No notifyHost provided by the host.");else a.msAjaxDebug.trace(n)},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",function(e){window.open(e.strUrl,e.strWindowName,e.strWindowFeatures)},Microsoft.Office.Common.InvokeType.async,c),l._enableServiceDeliveredExperience&&l._serviceEndPoint.registerMethod("Office_sendMessageToHost",h,Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(l._clientId+i.Constants.EndPointInternalSuffix),l._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",v,Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",function(e){if(e&&e.storeType!=i.StoreTypeEnum.PrivateCatalog){var n=window.location.href,a=g._osfOmexBaseUrl+i.Constants.SignInRedirectUrl+encodeURIComponent(n);window.location.assign(a)}else u.PrivateCatalogService.authenticationProxy.getSignInUrl(function(e){window.top.location.replace(e)},function(){g._notifyHost(t,i.AgaveHostAction.NotifyHostError,r)})},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignOut",function(e){e&&e.storeType==i.StoreTypeEnum.PrivateCatalog&&u.PrivateCatalogService.SignOutUser(),y(e,r)},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",function(e){window.open(e.pageUrl)},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",function(e){a.msAjaxDebug.trace("onClickInsertOsfControl!"),g._notifyHost(t,i.AgaveHostAction.InsertAgave,e)},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",l._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",y,Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",function(){a.msAjaxDebug.trace("onClickCancelDialog!"),g._notifyHost(t,i.AgaveHostAction.CancelDialog),g._internalConversationId&&(g._serviceEndPointInternal.unregisterConversation(g._internalConversationId),g._internalConversationId=r)},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",_,Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",function(e){switch(e.datapointName){case i.DataPointNames.AppManagementMenu:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.AppManagementMenuHelper.LogAppManagementMenuAction(e.assetId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.InsertionDialogSession:i.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:c},totalSessionTime:{type:Number,mayBeNull:c},trustPageSessionTime:{type:Number,mayBeNull:c},appInserted:{type:Boolean,mayBeNull:c},lastActiveTab:{type:Number,mayBeNull:c},lastActiveTabCount:{type:Number,mayBeNull:c}},r),s.InsertionDialogSessionHelper.LogInsertionDialogSession(e.assetId,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount);break;case i.DataPointNames.UploadFileDevCatelog:i.OUtil.validateParamObject(e,{operationMetadata:{type:Number,mayBeNull:c},hrStatus:{type:Number,mayBeNull:c}},r),s.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,e.operationMetadata,0,c,c,e.hrStatus);break;case i.DataPointNames.UploadFileDevCatalogUsage:i.OUtil.validateParamObject(e,{currentStoreType:{type:String,mayBeNull:c},id:{type:String,mayBeNull:o},appVersion:{type:String,mayBeNull:o},appTargetType:{type:Number,mayBeNull:c},isAppCommand:{type:String,mayBeNull:c},appSizeWidth:{type:Number,mayBeNull:o},appSizeHeight:{type:Number,mayBeNull:o}},r),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,e.currentStoreType,e.Id,e.appVersion,e.appTargetType,e.isAppCommand,e.appSizeWidth,e.appSizeHeight)}},Microsoft.Office.Common.InvokeType.async,c),l._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",b,Microsoft.Office.Common.InvokeType.async,c),i.AppSpecificSetup._setupFacade(l._hostControl,l,l._serviceEndPoint,l._serviceEndPointInternal),e.hostType=l._hostType,e.spBaseUrl=l._spBaseUrl,u.CatalogFactory.setHostContext(e),l._localeStringLoadingPendingCallbacks=[],l._localizedScriptsUrl&&"null/"!=l._localizedScriptsUrl){l._loadLocaleString(Function.createDelegate(l,function(){this._ErrorUXHelper=new i._ErrorUXHelper(this)}))}l.queryEntitlementDetails=function(e){v(e,e.callbackFunc)},l._getOmexData=function(e){b(e)},l._removeAppForInsertDialog=function(e){_(e,e.callbackFunc)}},i.ContextActivationManager.prototype={insertOsfControl:function(e){var t=!0,n=!1,r=this;if(i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},storeType:{type:String,mayBeNull:n},alternateReference:{type:Object,mayBeNull:t},settings:{type:Object,mayBeNull:t},reason:{type:String,mayBeNull:t},osfControlType:{type:Number,mayBeNull:t},snapshotUrl:{type:String,mayBeNull:t},preactivationCallback:{type:Object,mayBeNull:t},virtualOsfControlActivationCallback:{type:Object,mayBeNull:t},isvirtualOsfControl:{type:Boolean,mayBeNull:t},isDialog:{type:Boolean,mayBeNull:t},hostCustomMessage:{type:String,mayBeNull:t},isForUILessAction:{type:Boolean,mayBeNull:t},ownerAddinAssetId:{type:String,mayBeNull:t},ownerAddinStoreType:{type:String,mayBeNull:t}},null),!r._disableAppsForOfficeThirdParty||e.storeType.toLowerCase()===i.StoreType.FirstParty.toLowerCase()){var a={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,alternateReference:e.alternateReference,settings:e.settings,reason:e.reason,osfControlType:e.osfControlType,snapshotUrl:e.snapshotUrl,contextActivationMgr:r,preactivationCallback:e.preactivationCallback,virtualOsfControlActivationCallback:e.virtualOsfControlActivationCallback,isvirtualOsfControl:e.isvirtualOsfControl,isDialog:e.isDialog,hostCustomMessage:e.hostCustomMessage,isForUILessAction:e.isForUILessAction,ownerAddinAssetId:e.ownerAddinAssetId,sourceLocationOverrideResourceId:e.sourceLocationOverrideResourceId,ownerAddinStoreType:e.ownerAddinStoreType},o=r.getSQMAgaveUsage(a.storeType,a.osfControlType,a.reason,e.marketplaceID),s=new i.OsfControl(a);s._sqmDWords[0]=o[0],s._sqmDWords[1]=o[1],s._contextActivationMgr._ErrorUXHelper&&s._contextActivationMgr._ErrorUXHelper.showProgress(s._div,s._id);return r._loadLocaleString(Function.createDelegate(r,function(){s.activate()})),s}},insertDialogControl:function(e){var t=!1;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:t},id:{type:String,mayBeNull:t},dialogUrl:{type:String,mayBeNull:t},marketplaceID:{type:String,mayBeNull:t},marketplaceVersion:{type:String,mayBeNull:t},appDomains:{type:Array,mayBeNull:t},store:{type:String,mayBeNull:t},storeType:{type:String,mayBeNull:t},agaveName:{type:String,mayBeNull:!0}},null);var n={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,isDialog:!0,contextActivationMgr:this};new i.OsfControl(n).createIframeForDialogControl(e.agaveName,e.dialogUrl,e.appDomains)},insertBlankControlWithErrorUX:function(e,t){var n=!1,r=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:!0},storeType:{type:String,mayBeNull:n}},null);var a={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,osfControlType:e.osfControlType,contextActivationMgr:r,isvirtualOsfControl:n},o=new i.OsfControl(a);o._contextActivationMgr.registerOsfControl(o);var s=function(e,t){var r,a="",i="",o="",s=n;e.status===u.DataServiceResultCode.Succeeded&&e.value&&(a=(r=e.value).getDefaultDisplayName(),i=r.getProviderName(),o=r.getDefaultIconUrl(),s=r.isSSOAddin()),t(a,i,o,s)},c=u.OmexUtils.getOmexEndPointPageUrl(r.getOsfOmexBaseUrl(),e.marketplaceID,e.store),l=u.CatalogFactory.resolve(e.storeType.toLowerCase());if(null!=l){var d={assetId:e.marketplaceID,appVersion:e.marketplaceVersion,storeType:e.storeType,storeId:e.store,targetType:null},p=i.OmexClientNames[r._appName];l.getAndCacheManifest(d,r._storeLocator,new u.AddinCommandsTelemetryContext(o.getCorrelationId()),function(n){s(n,function(n,r,a,i){o._showTrustError(p,n,r,a,e.storeType,t,c,i)})})}},purgeDialogControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&(n._conversationId&&this._getServiceEndPoint().unregisterConversation(n._conversationId),this.unregisterOsfControl(n))},dispose:function(){var e=this;e._serviceEndPoint&&(e._serviceEndPoint.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId),e._serviceEndPoint=null),e._serviceEndPointInternal&&(e._serviceEndPointInternal.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId+i.Constants.EndPointInternalSuffix),e._serviceEndPointInternal=null)},setLocalizedUrl:function(e,t,n){var r=this,a=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:!1},{name:"imageUrl",type:String,mayBeNull:!1},{name:"styleUrl",type:String,mayBeNull:!1}]);if(a)throw a;if(r._localizedScriptsUrl=e,r._localizedImagesUrl=t,r._localizedStylesUrl=n,r._localizedScriptsUrl&&"null/"!=r._localizedScriptsUrl){r._loadLocaleString(Function.createDelegate(r,function(){this._ErrorUXHelper||(this._ErrorUXHelper=new i._ErrorUXHelper(this))}))}},getOsfControlStatus:function(e){var t=this._cachedOsfControls[e];return t?t.getStatus():i.OsfControlStatus.InvalidOsfControl},activateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.activate()},deActivateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.deActivate()},purgeOsfControl:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&r.purge(t)},purgeOsfControlNotifications:function(){for(var e in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(e)},untrustOsfControls:function(e){var t=this,n=0,r=function(e){return function(){e.activate({hasConsent:!0})}},a=i.OUtil.formatString(i.Constants.ActivatedCacheKey,e.id.toLowerCase(),e.currentStoreType,e.storeId);for(var o in t._deleteCachedFlag(a),t._cachedOsfControls){var s=t._cachedOsfControls[o];if(s._marketplaceID.toLowerCase()==e.id.toLowerCase()){t._ErrorUXHelper.purgeOsfControlNotification(s._id),s.deActivate();var c=u.OmexUtils.getOmexEndPointPageUrl(t.getOsfOmexBaseUrl(),s._marketplaceID,e.storeId),l=i.OmexClientNames[t._appName];s._showTrustError(l,e.displayName,e.providerName,e.iconUrl,e.currentStoreType,r(s),c),n++}}return n},retryAll:function(e){var t=this;for(var n in t._cachedOsfControls){var r=t._cachedOsfControls[n];r._marketplaceID.toLowerCase()==e.toLowerCase()&&r._retryActivate&&(t._ErrorUXHelper.purgeOsfControlNotification(r._id),t._ErrorUXHelper.removeInfoBarDiv(n,!1),r._retryActivate(),r._retryActivate=null)}},getOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;return this._cachedOsfControls[e]},getOsfControls:function(){var e=[];for(var t in this._cachedOsfControls)e.push(this._cachedOsfControls[t]);return e},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},isStoreDisabled:function(e){this._loadLocaleString(Function.createDelegate(this,function(){var t=u.CatalogFactory.resolve(i.StoreType.OMEX),n=i.OUtil.Guid.generateNewGuid(),r=new u.InsertDialogTelemetryContext(n);t instanceof u.OmexCatalog?t.isStoreDisabled(r,e):e({value:!1,status:200})}))},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(e){this._controlStatusChanged&&this._controlStatusChanged(e)},registerOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._cachedOsfControls[e.getID()]=e},unregisterOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;delete this._cachedOsfControls[e.getID()]},setIframeAttributeBag:function(e){this._iframeAttributeBag=e},getOmexIframeNotificationUrl:function(e,t,n){var r="&",a="=",o=this,s=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"notificationType",type:Number,mayBeNull:!1},{name:"isForSideloadAddin",type:Boolean,mayBeNull:!1}]);if(s)throw s;var c=o.getOsfControl(e);if(c){var l=o._osfOmexBaseUrl+i.Constants.OmexConsentNotificationPage+"?"+i.OmexPageParameterKeys.AppName+a+i.getModernAppVerCode(o._appName)+r+i.OmexPageParameterKeys.AppVersion+a+(o._hostFullVersion||i.Constants.FileVersion)+r+i.OmexPageParameterKeys.AppUILocale+a+o._appUILocale+r+i.OmexPageParameterKeys.AppDomain+a+window.location.origin+r+i.OmexPageParameterKeys.StoreLocator+a+c.getStoreLocator()+r+i.OmexPageParameterKeys.NotificationType+a+t+r+i.OmexPageParameterKeys.AppCorrelationId+a+c.getCorrelationId()+r+i.OmexPageParameterKeys.AuthType+a+o._getAuthTypeForHideAppsExtensionUrl();if(n){var u=c.getManifest().getWebApplicationId(),d=c.getManifest().getWebApplicationScopes();l=l+r+i.OmexPageParameterKeys.AppId+a+u+r+i.OmexPageParameterKeys.Scopes+a+encodeURIComponent(d.join(","))}else{var p=c.getOwnerAddinAssetId(),f=p||c.getMarketplaceID();l=l+r+i.OmexPageParameterKeys.AssetId+a+f}return l}return null},displayNotification:function(e){var t=null,n=!0,r=!1,a=this;i.OUtil.validateParamObject(e,{infoType:{type:Number,mayBeNull:r},id:{type:String,mayBeNull:r},title:{type:String,mayBeNull:r},description:{type:String,mayBeNull:r},url:{type:String,mayBeNull:n},icon:{type:String,mayBeNull:n},buttonTxt:{type:String,mayBeNull:n},buttonCallback:{type:Function,mayBeNull:n},dismissCallback:{type:Function,mayBeNull:n},"displayDeactive ":{type:Boolean,mayBeNull:n},highPriority:{type:Boolean,mayBeNull:n},detailView:{type:Boolean,mayBeNull:n},reDisplay:{type:Boolean,mayBeNull:n},logAsError:{type:Boolean,mayBeNull:n},errorCode:{type:Number,mayBeNull:n},retryAll:{type:Boolean,mayBeNull:n},iframeNotificationUrl:{type:String,mayBeNull:n},notificationType:{type:Number,mayBeNull:n}},t),e.errorCode||(e.errorCode=0);var o=a._cachedOsfControls[e.id];if(o)if(o._isvirtualOsfControl){if(e.errorCode==i.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED||e.errorCode==i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED)return void a.purgeOsfControl(e.id,n);if(null==e.highPriority&&(e.highPriority=e.infoType===i.InfoType.Error?n:r),e.highPriority===r)o._notificationParams.push(e);else{for(var c=o._notificationParams,l=0;l<c.length;l++)if(!c[l].highPriority){c.splice(l,0,e),c=t;break}c!=t&&c.push(e)}!o._isvirtualOsfControlCallbackInvoked&&o.ensureToGetVirtualOsfControlManifest(function(e){o.invokeVirtualOsfControlActivationCallback(e)}),!o._isManifestProcessedForCustomFunctions&&o.ensureToGetVirtualOsfControlManifest(function(e){o.processManifestForCustomFunctions(e)})}else{if(e.logAsError&&(s.AppLoadTimeHelper.SetErrorResult(o._telemetryContext,e.errorCode),a._notifyHostError)){var u={errorCode:e.errorCode};a._notifyHostError(e.id,i.AgaveHostAction.NotifyHostError,u)}(e.displayDeactive||e.iframeNotificationUrl!=t)&&(e.detailView=n),e.div=o._div,a._ErrorUXHelper.showNotification(e)}},dismissMessages:function(e){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(e)},notifyAgave:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"actionId",type:Number,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(t===i.AgaveHostAction.CtrlF6In||t===i.AgaveHostAction.TabIn||t===i.AgaveHostAction.Select?this._ErrorUXHelper.focusOnNotificationUx(e,t):t===i.AgaveHostAction.TabInShift&&r._pageStatus!==i.OsfControlPageStatus.Ready?this._ErrorUXHelper.focusOnNotificationUxShiftIn(e,t):r.notifyAgave(t))},setWSA:function(e){var t=this;t._wsa=e,t._wsa&&(t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,i.BWsaStreamTypes.Static,2,i.BWsaConfig.defaultMaxStreamRows),t._wsa.createStreamUnobfuscated(i.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,i.BWsaStreamTypes.Static,4,i.BWsaConfig.defaultMaxStreamRows))},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(e,t,n,r){var a,o;switch(e.toLowerCase()){case i.StoreType.OMEX:a=0;break;case i.StoreType.SPCatalog:a=1;break;case i.StoreType.FileSystem:a=2;break;case i.StoreType.Registry:a=3;break;case i.StoreType.Exchange:a=4;break;case i.StoreType.SPApp:a=5;break;case i.StoreType.FirstParty:a=6;break;case i.StoreType.Sdx:a=7;break;default:a=15}switch(t){case i.OsfControlType.DocumentLevel:o=1;break;case i.OsfControlType.ContainerLevel:o=0;break;default:o=2}var s=7;if(n&&n.toLowerCase)switch(n.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():s=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():s=1}var c=0;0!==r.toLowerCase().indexOf("wa")&&0!==r.toLowerCase().indexOf("fa")||(c=r&&r.length>2?parseInt(r.substring(2),10):0,isNaN(c)&&(c=0));return[s<<8|o<<4|a,c]},isMyOrgReady:function(e){var t=this;if(t._enableMyOrg)if(t._spBaseUrl&&t._iframeProxies&&t._iframeProxies[t._spBaseUrl]&&t._iframeProxies[t._spBaseUrl].clientEndPoint)e({isReady:!0,clientEndPoint:t._iframeProxies[t._spBaseUrl].clientEndPoint});else{t._createSharePointIFrameProxy(t._spBaseUrl,function(t){e(t?{isReady:!0,clientEndPoint:t}:{isReady:!1})})}else e({isReady:!1})},openInputUrlDialog:function(e){var t=document.createElement("p");t.setAttribute("id","title-p"),t.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):",e.appendChild(t);var n=document.createElement("input");n.setAttribute("type","url"),n.setAttribute("id","url-input"),n.setAttribute("size","80"),n.setAttribute("data-lpignore","true"),e.appendChild(n);var r=this,a=function(e){var t=new i.Manifest.Manifest(e,r.getAppUILocale());!i.OsfManifestManager.hasManifest(t.getMarketplaceID(),t.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(t.getMarketplaceID(),t.getMarketplaceVersion(),t);var n={id:t.getMarketplaceID(),targetType:t.getTarget(),appVersion:t.getMarketplaceVersion(),currentStoreType:i.StoreType.Registry,storeId:"developer",assetId:t.getMarketplaceID(),assetStoreId:i.StoreType.Registry,width:t.getDefaultWidth()||0,height:t.getDefaultHeight()||0,isAddinCommands:t._isAddinCommandsManifest(i.getManifestHostType(r._hostType))};s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,n.currentStoreType,n.id,n.appVersion,n.targetType,n.isAddinCommands,n.width,n.height),r._notifyHost("0",i.AgaveHostAction.InsertAgave,n)},o=function(e){alert("Error when requsting manifest file: "+e)},c=document.createElement("input");c.setAttribute("type","button"),c.setAttribute("value","Insert"),i.OUtil.addEventListener(c,"click",function(){i.OUtil.xhrGet(r._devCatalogUrl+"/"+n.value,a,o)}),e.appendChild(c)},launchInsertDialog:function(e,t,n){var r=null,a="100%";0!=e.childNodes.length&&e.removeChild(e.childNodes.item(0));var o,c=i.OUtil.Guid.generateNewGuid(),l=new u.InsertDialogTelemetryContext(c);if(this._enableDevCatalog){(o=document.createElement("div")).style.width=a,o.style.height="80%",e.appendChild(o);var d=document.createElement("div");d.style.width=a,d.style.height="20%",e.appendChild(d),this.openInputUrlDialog(d)}else o=e;var p=this;p._insertDialogDiv=o;var f=document.createElement("div");f.style.width=a,f.style.height=a,f.style.backgroundImage="url("+p.getLocalizedImageFilePath("progress.gif")+")",f.style.backgroundRepeat="no-repeat",f.style.backgroundPosition="center",o.appendChild(f);!function(e,t){if(p._enableMyOrg)try{i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1}},t),p.isMyOrgReady(function(n){n.isReady?(e.clientEndPoint=n.clientEndPoint,u.CatalogFactory.resolve(i.StoreType.SPCatalog).getSPCatalogUrl(l,function(n){t({statusCode:n.status,value:n.value,context:e})})):t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})})}catch(n){return s.RuntimeTelemetryHelper.LogExceptionTag("Error when getting corporate catalog url:",n,this._appCorrelationId,34719254),void t({statusCode:i.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}else t({statusCode:i.InvokeResultCode.E_CATALOG_NO_APPS,value:r,context:e})}({webUrl:p._spBaseUrl},function(e){var c=document.createElement("iframe");c.setAttribute("id","InsertDialog"),c.setAttribute("src","about:blank"),c.setAttribute("width",a),c.setAttribute("height",a),c.setAttribute("marginHeight","0"),c.setAttribute("marginWidth","0"),c.setAttribute("frameBorder","0"),c.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups"),"undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime&&c.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var l=r,u=[];p.isStoreDisabled(function(a){var d='"}',f='], "url":"',m='{ "IsUploadFileDevCatalogEnabled":'+p._enableUploadFileDevCatalog+',"isStoreDisabled":'+a.value+',"showSignOutFromPrivateCatalogMessage":'+p._showSignOutFromPrivateCatalogMessage+',"enableInsertDialogAccessibilityFix":'+p._enableInsertDialogAccessibilityFix+',"isBlackForestRedirectEnabled":'+p._enableBlackForestRedirect+',"isHostDocumentDomain":'+p._isHostDocumentDomain+" }";if(p.isExternalMarketplaceAllowed()){var g='{ "provValues":[0,0,0,'+(p._enableMyApps?i.InvokeResultCode.S_OK.toString():i.InvokeResultCode.S_HIDE_PROVIDER.toString())+f+p._osfOmexBaseUrl+'", "client":"'+p._getClientNameForOmex()+'", "'+i.OmexPageParameterKeys.AuthType+'":'+p._getAuthTypeForHideAppsExtensionUrl()+"}";u.push('"myApp":'+g),s.RuntimeTelemetryHelper.LogCommonMessageTag("isExternalMarketplaceAllowed is true, myApp tab show firstly.",p._contextMgrCorrelationId,20194266)}if(e&&e.value!=r){if(p._enableMyOrg){p._myOrgCatalogUrl=e.value;var h='{ "provValues":[1,1,0,'+e.statusCode+f+e.value+d;u.push('"myOrg":'+h)}if(p._enableOneDriveCatalog&&-1!=document.cookie.indexOf("OneDriveCatalog=true")){p._myOneDriveCatalogUrl=e.value;var v='{ "provValues":[9,9,0,0], "url":"'+e.value+d;u.push('"myOneDrive":'+v)}}if(p._enablePrivateCatalog){var y='{"provValues":[10,10,0,0], "client":"'+p._getClientNameForOmex()+d;u.push('"privateCatalog":'+y)}u.length>0&&(l="{"+u.join(", ")+"}"),p._internalConversationId&&p._serviceEndPointInternal.unregisterConversation(p._internalConversationId);var b=p.getClientId()+"_"+p.getDocUrl(),_=i.OUtil.getFrameName(b),S=i.OUtil.generateConversationId();p._internalConversationId=i.OUtil.generateConversationId(),c.setAttribute("name",_);var C=r;n!=r&&(C='{ "navigationMode":'+n.navigationMode+', "navigationModeParameter": "'+n.assetId+'", "category":"'+n.category+d);var A="",I=[S,encodeURIComponent(window.location.href),p._appVersion,i.getAppVerCode(p._appName),p.getLcid(),i.Constants.FileVersion,encodeURIComponent(l),t,encodeURIComponent(m),encodeURIComponent(C),p._contextMgrCorrelationId];A=p._localizedResourcesUrl?p._localizedResourcesUrl+"WefGallery.htm?b="+i.Constants.FileVersion:p._pageBaseUrl+p.getLcid()+"/WefGallery.htm?b="+i.Constants.FileVersion;var O=i.OUtil.addXdmInfoAsHash(A,I.join("|"));p._serviceEndPointInternal.registerConversation(S,O),c.setAttribute("src",O),p._insertDialogDiv?(0!=o.childNodes.length&&o.removeChild(o.childNodes.item(0)),o.appendChild(c)):(o.insertBefore(c,o.firstChild),p._insertDialogDiv=o)})}),p._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var e in this._cachedOsfControls){var t=this._cachedOsfControls[e];t._status===i.OsfControlStatus.NotSandBoxSupported&&t.activate()}},setRequirementsChecker:function(e){this._requirementsChecker=e},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(e){return!!this._ErrorUXHelper&&this._ErrorUXHelper.appHasNotifications(e)},refreshOsfControl:function(e,t){var n=this;for(var r in n._cachedOsfControls)if(n._cachedOsfControls[r]&&e==n._cachedOsfControls[r]._marketplaceID&&t==n._cachedOsfControls[r]._sourceLocationOverrideResourceId){n._cachedOsfControls[r].refresh();break}},_doesUrlHaveSupportedProtocol:function(e){var t=!1;e&&(t=null!=decodeURIComponent(e).match(/^https?:\/\/.+$/gi));return t},_loadLocaleString:function(e){var t=this;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){for(var n=t._localeStringLoadingPendingCallbacks.length,r=0;r<n;r++){t._localeStringLoadingPendingCallbacks.shift()()}e()}else{t._localeStringLoadingPendingCallbacks.push(e);var a=t._localeStringLoadingPendingCallbacks;if(1===a.length){t._loadStringScript(function(){for(var e=a.length,t=0;t<e;t++){var n=a.shift();"function"==typeof n&&n()}})}}},_loadStringScript:function(e){var t=this,n=this.getLocalizedScriptsUrl();n+=i.Constants.StringResourceFile;var r=0,a=function(){var o=null;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){if(r>0){c=i.OUtil.formatString("osfruntime_strings loaded after {0} retries.",r);s.RuntimeTelemetryHelper.LogExceptionTag(c,o,o,20306077)}e()}else{if(++r<3)return void setTimeout(function(){i.OUtil.loadScript(n,a)},750*r);t._localeStringLoadingPendingCallbacks.length=0;var c=i.OUtil.formatString("The locale, {0}, provided by the host app is not supported. Url: {1}",t.getLcid(),n);s.RuntimeTelemetryHelper.LogExceptionTag(c,o,o,20306076)}};i.OUtil.loadScript(n,a)},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(e,t){return i.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,t,e)},_getManifestAndTargetByConversationId:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];if(e===n._getConversationId()){var r=n.getStoreType()==i.StoreType.FirstParty?"":n.getMarketplaceVersion();return{manifest:n.getManifest()||i.OsfManifestManager.getCachedManifest(n.getMarketplaceID()),version:r,target:n.getOsfControlType()}}}return null},_createSharePointIFrameProxy:function(e,t){var n=null,r=this;if(r._doesUrlHaveSupportedProtocol(e)){var a=e.length;"/"===e.charAt(a-1)&&(e=e.substr(0,a-1));var o=r._iframeProxies[e];if(o)o.isReady?t(o.clientEndPoint):o.pendingCallbacks.push(t);else{var c=i.OUtil.generateConversationId(),l=document.createElement("iframe");r._iframeProxyCount=r._iframeProxyCount+1;var u=r._iframeNamePrefix+r._iframeProxyCount;l.setAttribute("id",u),l.setAttribute("name",u);var d=e+"/_layouts/15/OfficeExtensionManager.aspx?"+c;d=i.OUtil.addXdmInfoAsHash(d,c+"|"+u+"|"+window.location.href),d=i.OUtil.addSerializerVersionAsHash(d,i.SerializerVersion.Browser),l.setAttribute("scrolling","auto"),l.setAttribute("border","0"),l.setAttribute("width","0"),l.setAttribute("height","0"),l.setAttribute("style","position: absolute; left: -100px; top:0px;");var p=r,f=function(t,r){var a,o=p._iframeProxies[e];if(o&&0===t&&r.status?(o.isReady=!0,a=o.clientEndPoint):(delete p._iframeProxies[e],Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(c)?(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(c),i.OUtil.removeEventListener(l,"load",m),l.parentNode.removeChild(l)):s.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",n,n,19203550),a=n),o)for(var u=o.pendingCallbacks.length,d=0;d<u;d++){o.pendingCallbacks.shift()(a)}},m=function(){p._iframeProxies[e]&&(p._iframeProxies[e].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(c,l.contentWindow,e),p._iframeProxies[e].clientEndPoint.invoke("OEM_isProxyReady",f,{__timeout__:2e3}))};document.body.appendChild(l),i.OUtil.addEventListener(l,"load",m),l.setAttribute("src",d),r._iframeProxies[e]={clientEndPoint:n,isReady:!1,pendingCallbacks:[t]}}}else t(n)},_getClientVersionForOmex:function(){if(this._appVersion){var e=this._appVersion.split("."),t=parseInt(e[0],10),n=parseInt(e[1],10)||0;if(!(t<=15&&n<=0)){var r=i.Constants.FileVersion.split(".");return t+"."+n+"."+r[2]+"."+r[3]}}},_getClientNameForOmex:function(){return i.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return i.OmexAppVersions[this._appName]},_setCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.setItem(e,"true")},_getCachedFlag:function(e){var t=i.OUtil.getLocalStorage();if(t)return!!t.getItem(e)},_deleteCachedFlag:function(e){var t=i.OUtil.getLocalStorage();t&&t.removeItem(e)},_preloadOfficeJs:function(){var e=this;if(!e._hasPreloadedOfficeJs){var t=document.createElement("script");t.src=i.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",i.Constants.PreloadOfficeJsUrl,e._appUILocale,e._appName,e._hostSpecificFileVersion),t.type="text/javascript",t.id=i.Constants.PreloadOfficeJsId,t.onerror=function(){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,19203551)},document.getElementsByTagName("head")[0].appendChild(t),e._hasPreloadedOfficeJs=!0}},_getAuthTypeForHideAppsExtensionUrl:function(){var e=i.OUtil.getQueryStringParamValue(this._hideAppsExtensionUrl,i.OmexPageParameterKeys.AuthType);return e||i.AuthType.Anonymous},isAddinCommandsAsync:function(e,t){var n=null,r=!1;i.OUtil.validateParamObject(e,{marketplaceId:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},storeId:{type:String,mayBeNull:r},targetData:{type:Object,mayBeNull:r},clearCache:{type:Boolean,mayBeNull:!0}},n);var a=e.storeType.toLowerCase(),o={contextActivationMgr:n,referenceInUse:n},c=e.clearCache||r;try{o.referenceInUse={id:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeLocator:e.storeId},o.contextActivationMgr=this;var l=function(a){a!=n&&a.statusCode==u.DataServiceResultCode.Succeeded&&a.value!=n?t(!0,a.value._isAddinCommandsManifest(i.getManifestHostType(o.contextActivationMgr._hostType)),e):t(r,r,e)};if(i.StoreType.OMEX===a||i.StoreType.UploadFileDevCatalog===a||i.StoreType.SPCatalog===a||i.StoreType.PrivateCatalog===a){var d=u.CatalogFactory.resolve(a),p={assetId:o.referenceInUse.id,storeType:a,storeId:o.referenceInUse.storeLocator,appVersion:o.referenceInUse.version,targetType:n},f=i.OUtil.Guid.generateNewGuid(),m=new u.AddinCommandsTelemetryContext(f);d.getAndCacheManifest(p,p.storeId,m,function(e){l({statusCode:e.status,value:e.value})},c)}else t(!0,r,e)}catch(a){s.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",a,n,19203552),t(r,r,e)}},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getUserNameHashCode:function(){return this._userNameHashCode}},i.OsfControl=function(e){var t=null,n=!0,r=!1,a=this;i.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:r},contextActivationMgr:{type:Object,mayBeNull:r},id:{type:String,mayBeNull:r},marketplaceID:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},store:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},alternateReference:{type:Object,mayBeNull:n},settings:{type:Object,mayBeNull:n},reason:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:n},snapshotUrl:{type:String,mayBeNull:n},preactivationCallback:{type:Object,mayBeNull:n},virtualOsfControlActivationCallback:{type:Object,mayBeNull:n},isvirtualOsfControl:{type:Boolean,mayBeNull:n},isDialog:{type:Boolean,mayBeNull:n},hostCustomMessage:{type:String,mayBeNull:n},isForUILessAction:{type:Boolean,mayBeNull:n},ownerAddinAssetId:{type:String,mayBeNull:n},sourceLocationOverrideResourceId:{type:String,mayBeNull:n},ownerAddinStoreType:{type:String,mayBeNull:n}},t),a._div=e.div,a._sourceLocationOverrideResourceId=e.sourceLocationOverrideResourceId,a._contextActivationMgr=e.contextActivationMgr,a._id=e.id,a._storeType=e.storeType.toLowerCase(),a._storeLocator=e.store,a._marketplaceID=e.marketplaceID,a._marketplaceVersion=e.marketplaceVersion,a._alternateReference=e.alternateReference,a._settings=e.settings||{},a._reason=null==e.reason?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:e.reason,a._osfControlType=null==e.osfControlType?i.OsfControlType.DocumentLevel:e.osfControlType,a._snapshotUrl=e.snapshotUrl,a._status=i.OsfControlStatus.NotActivated,a._notificationParams=[],a._iframeUrl=t,a._permission=t,a._conversationId=t,a._manifestUrl=t,a._pageStatus=i.OsfControlPageStatus.NotStarted,a._pageIsReadyTimerExpired=r,a._timer=t,a._retryLoadingNum=2,a._frame=t,a._agaveEndPoint=t,a._etoken="",a._sqmDWords=[0,0],a._preactivationCallback=e.preactivationCallback,a._telemetryContext={},a._controlFocus=r,a._agavePageUrl=t,a._agaveWindowName=t,a._manifest=t,a._virtualOsfControlActivationCallback=e.virtualOsfControlActivationCallback,a._isvirtualOsfControl=null==e.isvirtualOsfControl?r:e.isvirtualOsfControl,a._isvirtualOsfControlCallbackInvoked=r,a._isManifestProcessedForCustomFunctions=r,a._isDialog=null==e.isDialog?r:e.isDialog,a._hostCustomMessage=e.hostCustomMessage,a._isUpgrading=r,a._contextActivationMgr._enableServiceDeliveredExperience&&(a._bundleUrl=t,a._sdxIframeTemplateUrl="https://osf-agave/rtm/sdx/index.html"),a._isUILessAddInCommands=!!e.isForUILessAction,a._ownerAddinAssetId=e.ownerAddinAssetId?e.ownerAddinAssetId:t,a._ownerAddinStoreType=e.ownerAddinStoreType?e.ownerAddinStoreType:t,i.OUtil.isiOS()&&(a._div.style.webkitOverflowScrolling="touch",a._div.style.overflow="auto"),a._appCorrelationId=a._contextActivationMgr._contextMgrCorrelationId||i.OUtil.Guid.generateNewGuid(),a._iframeOnLoadDelegate=Function.createDelegate(a,a._iframeOnLoad),a._retryActivate=t,a._onKeyDownEventDelegate=Function.createDelegate(a,a._onKeydownEvent)},i.OsfControl.prototype={activate:function(e){var t=!0,n=null,r=this,a=r;if(r._status!==i.OsfControlStatus.Activated){try{if(r._contextActivationMgr.registerOsfControl(r),i.OUtil.addEventListener(r._div,"keydown",r._onKeyDownEventDelegate),(e=e||{}).hostType=r._contextActivationMgr._hostType,e.osfControl=e.osfControl||r,e.referenceInUse=e.referenceInUse||{id:r._marketplaceID,version:r._marketplaceVersion,storeType:r._storeType,storeLocator:r._storeLocator},e.correlationId=e.osfControl._appCorrelationId,!r._doesBrowserSupportRequiredFeatures())return r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,t,i.ErrorStatusCodes.E_BROWSER_VERSION),void r.invokePreactivationCompletedCallback();var o=document.createElement("iframe"),c="sandbox"in o;o=n;var l=!1,d=i.OUtil.getLocalStorage();if(d&&(l=d.getItem(i.Constants.IgnoreSandBoxSupport)),r._contextActivationMgr._autoTrusted&&!c&&!l)return r._contextActivationMgr._ErrorUXHelper.removeProgressDiv(r._div,r._id),r._status=i.OsfControlStatus.NotSandBoxSupported,r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN_FirstParty,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR_FirstParty,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT_FirstParty,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}):r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,icon:n,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(r._activateAgavesBlockedBySandboxNotSupport,r._contextActivationMgr),url:i.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:n,reDisplay:t,displayDeactive:t,errorCode:i.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:t}),void r.invokePreactivationCompletedCallback();r.startActivate();var p=r,f=e.referenceInUse;if(f.storeType===i.StoreType.OMEX||f.storeType===i.StoreType.UploadFileDevCatalog||f.storeType===i.StoreType.SPCatalog||f.storeType===i.StoreType.PrivateCatalog||f.storeType===i.StoreType.FirstParty||f.storeType===i.StoreType.Sdx){var m=new u.OsfControlLoader(r,e.hasConsent),g=new u.ActivationTelemetryContext(r.getCorrelationId(),r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r._id);if(f.storeType===i.StoreType.Sdx)u.SDXCatalog.activateAsync({assetId:f.id,storeId:f.storeLocator,appVersion:f.version,storeType:f.storeType,targetType:""},m,g,r._contextActivationMgr.getRequirementsChecker(),{clientId:r._contextActivationMgr._loggableUserId,sessionStartInfoJson:r._contextActivationMgr._sessionStartInfoJson});else{var h=e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?n:e.osfControl.getOsfControlType();u.CatalogFactory.resolve(f.storeType).activateAsync({assetId:f.id,storeId:f.storeLocator,appVersion:f.version,storeType:f.storeType,targetType:f.storeType===i.StoreType.SPCatalog?h:""},m,g)}return void r.invokePreactivationCompletedCallback()}if("1B4CD97F-DBFE-4C1A-B4C4-FC163B4F9693"===f.id&&s.RuntimeTelemetryHelper.LogCommonMessageTag("ONO_Onboarding_CorrelationId :"+r.getCorrelationId(),n,23381916),s.AppLoadTimeHelper.ActivationStart(r._telemetryContext,r._sqmDWords[0],r._sqmDWords[1],r.getCorrelationId(),r._id,i.ActivationTypes.V2Enabled),s.AppLoadTimeHelper.ServerCallStart(r._telemetryContext),f.storeType===i.StoreType.Exchange||f.storeType===i.StoreType.InMemory)i.OsfManifestManager.getManifestAsync(e,function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&!a._etoken&&(a._etoken=e.value.getInMemoryEToken()||""),a._onGetManifestCompleted(e)});else if(f.storeType===i.StoreType.Registry&&r._contextActivationMgr._enableDevCatalog||f.storeType===i.StoreType.HardCodedPreinstall)if(e.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened){i.OUtil.xhrGet(r._contextActivationMgr._devCatalogUrl+"/"+f.id+".xml",function(t){var n=new i.Manifest.Manifest(t,p._contextActivationMgr.getAppUILocale());!i.OsfManifestManager.hasManifest(n.getMarketplaceID(),n.getMarketplaceVersion())&&i.OsfManifestManager.cacheManifest(n.getMarketplaceID(),n.getMarketplaceVersion(),n),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(p,p._onGetManifestCompleted))},function(e){alert("Error when requsting manifest file: "+e)})}else i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(r,r._onGetManifestCompleted));else if(f.storeType===i.StoreType.OneDrive&&r._contextActivationMgr._enableOneDriveCatalog){var v=function(t){var n=new i.Manifest.Manifest(t,p._contextActivationMgr.getAppUILocale());i.OsfManifestManager.cacheManifest(f.id,n.getMarketplaceVersion(),n),i.OsfManifestManager.getManifestAsync(e,Function.createDelegate(p,p._onGetManifestCompleted))},y=function(){p._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(p,p._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},b=window.location.protocol+"//"+window.location.host;i.OneDriveOAuth.setHostCallbackUri(b);var _=r._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+f.id+":/content?access_token=";i.OneDriveOAuth.getAccessToken(function(e){_+=e,i.OUtil.xhrGet(_,v,y)},function(){p._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(p,p._refresh),n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)})}else f.storeType===i.StoreType.SPApp?(s.AppLoadTimeHelper.EntitlementCheckStart(r._telemetryContext),e.baseUrl=r._contextActivationMgr.getPageBaseUrl(),e.pageUrl=r._contextActivationMgr._docUrl,e.webUrl=r._contextActivationMgr._webUrl,e.appWebUrl=r._contextActivationMgr._webUrl,i.OsfManifestManager.getSPAppEntitlementsAsync(e,Function.createDelegate(r,r._onGetEntitlementsCompleted))):f.storeType===i.StoreType.FileSystem||f.storeType===i.StoreType.Registry||f.storeType===i.StoreType.HardCodedPreinstall?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):f.storeType===i.StoreType.OneDrive?r._showActivationWarning(i.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,n,n,n,n,i.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):r._showActivationError(i.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,n,n,n,n,n,n,i.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}catch(e){var S="Error getting app data.";u.WACUtils.logExceptionToBrowserConsole(S,e),s.RuntimeTelemetryHelper.LogExceptionTag(S,e,r.getCorrelationId(),18420419),r._contextActivationMgr._enableFirstPartySDXErrorMessages&&r.isFirstParty()?r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError):r._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(r,r._refresh),n,n,n,n,i.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}r.invokePreactivationCompletedCallback()}else r.invokePreactivationCompletedCallback()},createIframeForDialogControl:function(e,t,n){for(var r=this;r._div.childNodes.length>0;)r._div.removeChild(r._div.childNodes.item(0));var a=r._createIframeForControl(e);r._iframeUrl=t,r._appDomains=n,r._setIframeAttribute(a,t),r._div.appendChild(a),r._contextActivationMgr.registerOsfControl(r)},deActivate:function(){var e=null,t=this;try{if(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationStart),t._contextActivationMgr.dismissMessages(t._id),t._retryActivate=e,t._status!==i.OsfControlStatus.NotActivated){for(t._agaveEndPoint&&(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(t._agaveEndPoint._conversationId),t._agaveEndPoint=e),t._frame&&(i.OUtil.removeEventListener(t._frame,"load",t._iframeOnLoadDelegate),t._frame=e),t._timer&&(window.clearTimeout(t._timer),t._timer=e);t._div.childNodes.length>0;)t._div.removeChild(t._div.childNodes.item(0));t._status=i.OsfControlStatus.NotActivated,t._conversationId&&t._contextActivationMgr._getServiceEndPoint().unregisterConversation(t._conversationId),t._contextActivationMgr.raiseOsfControlStatusChange(t)}t._controlFocus=!1,i.OUtil.removeEventListener(t._div,"keydown",t._onKeyDownEventDelegate),i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.DeactivationEnd)}catch(e){var n="Deactivate failed.";u.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),18420420)}},startActivate:function(){var e=this;for(e._controlFocus=!0,e._pageStatus=i.OsfControlPageStatus.Loading,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationStart),e._frame&&(i.OUtil.removeEventListener(e._frame,"load",e._iframeOnLoadDelegate),e._frame=null);e._div.childNodes.length>0;)e._div.removeChild(e._div.childNodes.item(0));e._contextActivationMgr._ErrorUXHelper.showProgress(e._div,e._id)},refresh:function(){this._refresh()},_restartActivate:function(){this.deActivate(),this.startActivate(),this.invokePreactivationCompletedCallback()},purge:function(e){var t=this,n=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;try{t._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(t._id),t.deActivate(),e&&i.OsfManifestManager.purgeManifest(t._marketplaceID,t._marketplaceVersion),t._contextActivationMgr.unregisterOsfControl(t)}catch(e){var r="Purge failed.";u.WACUtils.logExceptionToBrowserConsole(r,e),s.RuntimeTelemetryHelper.LogExceptionTag(r,e,t.getCorrelationId(),18420421)}},invokeVirtualOsfControlActivationCallback:function(e){var t=this;try{t._virtualOsfControlActivationCallback&&(t._virtualOsfControlActivationCallback(t,e),t._isvirtualOsfControlCallbackInvoked=!0)}catch(e){var n="invokeVirtualOsfControlActivationCallback failed.";u.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),36496280)}},ensureToGetVirtualOsfControlManifest:function(e){var t=null,n=this,r=n;if(n._manifest)e(n._manifest);else{var a={assetId:n._marketplaceID,appVersion:n._marketplaceVersion,storeType:n._storeType,storeId:n._storeLocator,targetType:t},o=function(n){var a=t;n.status===u.DataServiceResultCode.Succeeded&&n.value?a=n.value:r._status=i.OsfControlStatus.ActivationFailed,e(a)},s=u.CatalogFactory.resolve(a.storeType);s!=t?s.getAndCacheManifest(a,n._storeLocator,new u.AddinCommandsTelemetryContext(n.getCorrelationId()),o):(alert("AddinCommands is not supported in "+a.storeType+" store."),o({status:u.DataServiceResultCode.Failed,value:t}))}},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(e){this._settings=e},getReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},isFirstParty:function(){return this._storeType&&(this._storeType===i.StoreType.FirstParty||this._storeType===i.StoreType.Sdx)},updateAgaveEndPointTargetUrl:function(e){this._agaveEndPoint._targetUrl=e},getStoreLocator:function(){return this._storeLocator},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;return this._settings[e]},addProperty:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",type:String,mayBeNull:!1}]);if(n)throw n;this._settings[e]=t},removeProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;delete this._settings[e]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},checkAppDomains:function(e){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(this._appDomains,e)},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){this._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return!1},getEToken:function(){return this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(e){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,e)},sendMessageToSdx:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_sendMessageToSdx",t,e)},isUILessAddInCommands:function(){return this._isUILessAddInCommands},getOwnerAddinAssetId:function(){return this._ownerAddinAssetId},getOwnerAddinStoreType:function(){return this._ownerAddinStoreType},_onKeydownEvent:function(e){var t="input, button, a",n=this;if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){e.preventDefault(),e.stopPropagation();var r=i.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(r=i.AgaveHostAction.CtrlF6ExitShift),n._contextActivationMgr._notifyHost(n._id,r)}else if(9==e.keyCode){e.preventDefault(),e.stopPropagation();var a=n._div.querySelectorAll(t);if(0==a.length)return;i.OUtil.focusToNextTabbable(a,e.target||e.srcElement,e.shiftKey)||(e.shiftKey?n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExitShift):n._agaveEndPoint?n.notifyAgave(i.AgaveHostAction.TabIn):n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.TabExit))}else if(27==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.EscExit);else if(113==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.F2Exit);else if(13==e.keyCode||32==e.keyCode)for(var o=n._div.querySelectorAll(t),s=0;s<o.length;s++){var c=e.target||e.srcElement;if(o[s]===c)return e.preventDefault(),e.stopPropagation(),void c.click()}else e.preventDefault(),e.stopPropagation()},_onGetEntitlementsCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.EntitlementCheckEnd(n._telemetryContext);for(var r,a=e.context.referenceInUse,o=e.value.entitlements,c=o.length,l=t,u=0;u<c;u++)(r=o[u]).OfficeExtensionID&&a.id&&r.OfficeExtensionID.toLowerCase()===a.id.toLowerCase()&&(l&&!n._lessThan(l.OfficeExtensionVersion,r.OfficeExtensionVersion)||(l=r));(r=l)?r.OfficeExtensionKillbit?n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_OEM_EXTENSION_KILLED):(e.context.manifestUrl=r.EncodedAbsUrl,e.context.appInstanceId=r.AppInstanceID,e.context.productId=r.ProductID,e.context.appInstanceId?i.OsfManifestManager.getAppInstanceInfoByIdAsync(e.context,Function.createDelegate(n,n._onGetAppInstanceInfoByIdCompleted)):i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(n,n._onGetManifestCompleted))):n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback(function(e){e.osfControl._refresh(e)},{clearCache:!0,referenceInUse:e.context.referenceInUse,osfControl:e.context.osfControl}),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST)}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){var r=e.value,a=e.context;r.AppWebFullUrl&&(a.appWebUrl=r.AppWebFullUrl),a.clientId=r.AppPrincipalId,a.remoteAppUrl=r.RemoteAppUrl,a.appWebUrl&&a.productId?i.OsfManifestManager.getSPTokenByProductIdAsync(a,Function.createDelegate(n,n._onGetSPTokenByProductIdCompleted)):i.OsfManifestManager.getManifestAsync(a,Function.createDelegate(n,n._onGetManifestCompleted))}else n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(e){e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value&&(this._etoken=e.value),i.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))},_retryActivation:function(){var e=this;e._retryLoadingNum--,e._pageStatus===i.OsfControlPageStatus.Ready||e._retryLoadingNum<=0?(e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id),e._retryLoadingNum=2):e._refresh()},_iframeOnLoad:function(){var e=this;s.AppLoadTimeHelper.PageLoaded(this._telemetryContext);e._pageStatus!==i.OsfControlPageStatus.Ready?e._timer=window.setTimeout(function(){!function(e){var t=null;if(e){if(e._contextActivationMgr._ErrorUXHelper&&(i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.SelectionTimeout),e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id)),e._pageStatus!==i.OsfControlPageStatus.Ready)if(2===e._retryLoadingNum){var n=i.ErrorStatusCodes.WAC_AgaveActivationError;switch(e._pageStatus){case i.OsfControlPageStatus.FailedOriginCheck:n=i.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case i.OsfControlPageStatus.FailedPermissionCheck:n=i.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case i.OsfControlPageStatus.FailedHandleRequest:n=i.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()?e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n):e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else 1===e._retryLoadingNum&&(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()?e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR_FirstParty,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading):e._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,i.ErrorStatusCodes.WAC_ActivateAttempLoading));else e._notifyHostIFrameOnLoaded();e._timer&&(window.clearTimeout(e._timer),e._timer=t),e._pageIsReadyTimerExpired=!0}}(e)},5e3*e._retryLoadingNum+1):e._notifyHostIFrameOnLoaded()},_isOsfControlInEmbeddingMode:function(e){var t=!1;try{t=null!=e.getContainingDiv().parentNode.parentNode.id.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/gi)}catch(e){u.WACUtils.logExceptionToBrowserConsole("_isOsfControlInEmbeddingMode error.",e)}return t},_createIframeAndActivateOsfControl:function(e){var t=this._createIframeForControl(e);this._activate(t,this._iframeUrl)},_createIframeForControl:function(e){var t,n=this,r=document.createElement("iframe");for(var a in r.setAttribute("id",n._id),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),t=n._contextActivationMgr._enableFirstPartySDXErrorMessages&&n.isFirstParty()?Strings.OsfRuntime.L_IframeTitle_TXT_FirstParty+" "+e:Strings.OsfRuntime.L_IframeTitle_TXT+" "+e,r.setAttribute("title",t),r.style.msUserSelect="element",n._setSandboxAttribute(r),n._contextActivationMgr._iframeAttributeBag)r.setAttribute(a,n._contextActivationMgr._iframeAttributeBag[a]);return n._frame=r,r},_setSandboxAttribute:function(e){e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox"),e.setAttribute("allow","geolocation;microphone;camera")},_onGetManifestCompleted:function(e){var t=null,n=this;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.ManifestRequestEnd(n._telemetryContext),s.AppLoadTimeHelper.ServerCallEnd(n._telemetryContext);var r=e.value,a=e.context,o=a.referenceInUse,c=o.storeType,l=r.getDefaultDisplayName();if(n._manifest=r,a.manifestCached&&!a.retried){var d=r.getMarketplaceVersion();if(n._lessThan(d,o.version)&&c===i.StoreType.SPApp)return void n._refresh({clearCache:!0,referenceInUse:o,osfControl:a.osfControl,retried:!0})}if(!1===r.requirementsSupported||void 0===r.requirementsSupported&&!n._contextActivationMgr.getRequirementsChecker().isManifestSupported(r)){r.requirementsSupported=!1;var p,f;return p=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,f=i.ErrorStatusCodes.WAC_AgaveRequirementsError,void n._showActivationError(i.OsfControlStatus.ActivationFailed,p,t,t,null,t,t,!0,f)}if(r.requirementsSupported=!0,n._iframeUrl=r.getDefaultSourceLocation(n._contextActivationMgr.getFormFactor()),c===i.StoreType.Sdx&&n._iframeUrl&&n.updateUrlsForSdxBundle(),n._permission=r.getPermission(),n._appDomains=r.getAppDomains(),c===i.StoreType.SPApp&&n._iframeUrl&&(a.clientId&&(n._iframeUrl=n._iframeUrl.replace(/~clientid/gi,a.clientId)),a.appWebUrl&&(n._iframeUrl=n._iframeUrl.replace(/~appweburl/gi,a.appWebUrl)),a.remoteAppUrl&&(n._iframeUrl=n._iframeUrl.replace(/~remoteappurl/gi,a.remoteAppUrl))),!n._contextActivationMgr._doesUrlHaveSupportedProtocol(n._iframeUrl))return void n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,t,t,t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);n.processManifestForCustomFunctions(r),n._isvirtualOsfControl?!a.showNewerVersion&&n.invokeVirtualOsfControlActivationCallback(r):n._createIframeAndActivateOsfControl(l)}else s.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+u.WACUtils.serializeObjectToString(e),t,t,18420422),n._showActivationError(i.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,i.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},isCustomFunctionSandbox:function(){var e=this;if("object"==typeof e._settings&&"number"==typeof e._settings.length)for(var t=0;t<e._settings.length;t++)if("object"==typeof e._settings[t]&&"number"==typeof e._settings[t].length&&"string"==typeof e._settings[t][0]&&"string"==typeof e._settings[t][1]&&"customfunctionaddinid"==e._settings[t][0].toLowerCase())return!0;return!1},processManifestForCustomFunctions:function(e){var t=this,n=t;if((!t._isManifestProcessedForCustomFunctions||t._isUpgrading)&&(t._isManifestProcessedForCustomFunctions=!0,(t.getReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted||t.getReason()===Microsoft.Office.WebExtension.InitializationReason.DocumentOpened)&&e.containsCustomFunctionsForAppHost(t._contextActivationMgr._hostType))){var r=i.getManifestHostType(t._contextActivationMgr._hostType),o=t._contextActivationMgr.getFormFactor(),s=new u.Parser.ParsingContext(r,o,null,e),c=new u.Parser.AddinCommandsManifestParser(r,o),l={assetId:t._marketplaceID,appVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetType:null},d={setErrorMessageForAddin:function(e,t){a.msAjaxDebug.trace("Error parsing app manifest: "+t)}},p=c.parseExtensions(l,e,d);if("object"==typeof p.ExtensionPoints&&"number"==typeof p.ExtensionPoints.length)for(var f=0;f<p.ExtensionPoints.length;f++)if("CustomFunctions"===p.ExtensionPoints[f].type){var m=p.ExtensionPoints[f],g=function(){var t={osfControl:n,namespace:s.resources.ShortStrings[m.namespaceResId],metadataUrl:s.resources.Urls[m.metadataResId],manifest:e._xmlProcessor.getNodeXml(e._xmlProcessor.getDocumentElement())};n._contextActivationMgr._notifyHost(n._id,i.AgaveHostAction.InstallCustomFunctions,t)};t.isCustomFunctionSandbox()?(t._iframeUrl=s.resources.Urls[m.pageResId],t._isUpgrading&&g()):g();break}}},setIsUpgrading:function(e){this._isUpgrading=e},getIsUpgrading:function(){return this._isUpgrading},updateUrlsForSdxBundle:function(e){var t=this;if(t._contextActivationMgr._enableServiceDeliveredExperience){var n=".js";t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n&&(t._bundleUrl=t._iframeUrl,t._iframeUrl=null!=e?e:t._sdxIframeTemplateUrl)}},_lessThan:function(e,t){return i.OsfManifestManager.versionLessThan(e,t)},_showTrustError:function(e,t,n,r,a,o,s,c){var l=null,u=this,d=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,t||"");d=u._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var p=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,n||"");p=u._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(p);var f=i.OUtil.formatString(Strings.OsfRuntime.L_AgaveUntrusted_INFO,d,p);c=null==c?!!u.getManifest()&&u.getManifest().isSSOAddin():c;var m=Strings.OsfRuntime.L_ActivateButton_TXT,g=i.NotificationType.TrustYellowBar,h=Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,v=c&&u._storeType===i.StoreType.OMEX?u._contextActivationMgr.getOmexIframeNotificationUrl(u._id,i.NotificationType.TrustYellowBar):l;u._contextActivationMgr._enableNewTrustPromptForAddIn&&(f=Strings.OsfRuntime.L_AgaveTrustAddIn_INFO,m=Strings.OsfRuntime.L_TrustButton_TXT,g=u._osfControlType===i.OsfControlType.DocumentLevel?i.NotificationType.TrustPromptContent:i.NotificationType.TrustPromptTaskpane),u._retryActivate=o,u._contextActivationMgr.displayNotification({id:u._id,infoType:i.InfoType.SecurityInfo,clientName:e,name:t||l,provider:n,title:h,description:f,icon:r||l,buttonTxt:m,buttonCallback:o,url:s||l,dismissCallback:l,reDisplay:!0,displayDeactive:!0,logAsError:!0,retryAll:!0,errorCode:i.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED,iframeNotificationUrl:v,notificationType:g})},showConsentError:function(e,t,n){var r=this;r._retryActivate=e,r._contextActivationMgr.displayNotification({id:r._id,infoType:i.InfoType.SecurityInfo,title:"",description:"",icon:null,buttonCallback:e,dismissCallback:null,reDisplay:!0,displayDeactive:!1,retryAll:!0,errorCode:i.ErrorStatusCodes.WAC_SSOAddinRequireConsent,iframeNotificationUrl:r._contextActivationMgr.getOmexIframeNotificationUrl(r._id,t,n),notificationType:t})},_showActivationError:function(e,t,n,r,a,o,s,c,l){var u=!0,d=null,p=this;if(p._status=e,p._contextActivationMgr._enableFirstPartySDXErrorMessages&&p.isFirstParty())var f={id:p._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:a||d,dismissCallback:o||d,reDisplay:!o&&u,displayDeactive:u,detailView:!!c&&u,logAsError:u,errorCode:l||0};else f={id:p._id,infoType:i.InfoType.Error,status:e,title:s||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:a||d,dismissCallback:o||d,reDisplay:!o&&u,displayDeactive:u,detailView:!!c&&u,logAsError:u,errorCode:l||0};p._contextActivationMgr.displayNotification(f),p._contextActivationMgr.raiseOsfControlStatusChange(p)},_showActivationWarning:function(e,t,n,r,a,o,s){var c=!0,l=null,u=this;if(u._status=e,u._contextActivationMgr._enableFirstPartySDXErrorMessages&&u.isFirstParty())var d={id:u._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT_FirstParty,description:t,icon:l,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||l,url:a||l,dismissCallback:o||l,reDisplay:!o&&c,displayDeactive:c,logAsError:c,errorCode:s||0};else d={id:u._id,infoType:i.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:t,icon:l,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||l,url:a||l,dismissCallback:o||l,reDisplay:!o&&c,displayDeactive:c,logAsError:c,errorCode:s||0};u._contextActivationMgr.displayNotification(d),u._contextActivationMgr.raiseOsfControlStatusChange(u)},_refresh:function(e){this.deActivate(),this.activate(e)},_activateAgavesBlockedBySandboxNotSupport:function(e){e.activateAgavesBlockedBySandboxNotSupport();var t=i.OUtil.getLocalStorage();t&&t.setItem(i.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(e){this._contextActivationMgr._setCachedFlag(e)},_getCachedFlag:function(e){return this._contextActivationMgr._getCachedFlag(e)},_deleteCachedFlag:function(e){this._contextActivationMgr._deleteCachedFlag(e)},_notifyHostIFrameOnLoaded:function(){this._contextActivationMgr._notifyHost&&this._contextActivationMgr._notifyHost(this._id,i.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var t=document.createElement("a");t.href=e;var n=this.getEToken(),r=i.Constants.ETokenParameterName+"="+encodeURIComponent(i.OUtil.encodeBase64(n)),a=t.search.length>1?t.search.substr(1)+"&":"";t.search=a+r;var o=t.href;return t=null,o},_activate:function(e,t){var n=this;s.AppLoadTimeHelper.PageStart(n._telemetryContext),n._setIframeAttribute(e,t),n._pageIsReadyTimerExpired=!1,i.OUtil.addEventListener(e,"load",n._iframeOnLoadDelegate),n._div.appendChild(e),n._status=i.OsfControlStatus.Activated,i.OUtil.writeProfilerMark(i.OsfControlActivationPerfMarker.ActivationEnd),n._contextActivationMgr.raiseOsfControlStatusChange(n),s.AppLoadTimeHelper.OfficeJSStartToLoad(n._telemetryContext)},_setIframeAttribute:function(e,t){var n=this;t=n._addETokenAsQueryParameter(t);var r=n._contextActivationMgr.getClientId()+"_"+n._contextActivationMgr.getDocUrl()+"_"+n._id,a=i.OUtil.getFrameName(r);n._conversationId=i.OUtil.generateConversationId();var o=[n._contextActivationMgr._hostType,n._contextActivationMgr._hostPlatform,n._contextActivationMgr._hostSpecificFileVersion,n._contextActivationMgr._appUILocale,n.getCorrelationId(),n._isDialog?"isDialog":null,n._contextActivationMgr._disableLogging?"disableLogging":null].join("|"),s=t,c=window.location.href,l=n._conversationId+"|"+n._id+"|"+(c.indexOf("$")>=0?encodeURIComponent(c):c),d={};d[i.WindowNameItemKeys.BaseFrameName]=a,d[i.WindowNameItemKeys.HostInfo]=o,d[i.WindowNameItemKeys.XdmInfo]=l,d[i.WindowNameItemKeys.SerializerVersion]=i.SerializerVersion.Browser;var p=i.OUtil.getLocalStorage();if(p){var f="CustomFunctionsRuntimeLogging",m=p.getItem(f);m&&(d[f]=m)}n._contextActivationMgr._getServiceEndPoint().registerConversation(n._conversationId,s,n._appDomains),e.setAttribute("src",s),n._agaveWindowName=u.WACUtils.serializeObjectToString(d),e.setAttribute("name",n._agaveWindowName),i.OUtil.addClass(e,"AddinIframe"),n._agavePageUrl=s},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{get:function(){return this.desc},set:function(e){this.desc=e}}),e=!0}catch(e){}return e},_isAddinCommands:function(e){var t=this;if(t._isvirtualOsfControl)e(!0);else if(t._contextActivationMgr._enableAddinCommands&&t._contextActivationMgr._enableTaskpaneUpgradeToAppCommand&&null!=t._virtualOsfControlActivationCallback){var n={marketplaceId:t._marketplaceID,marketplaceVersion:t._marketplaceVersion,storeType:t._storeType,storeId:t._storeLocator,targetData:{}};t._contextActivationMgr.isAddinCommandsAsync(n,function(t,n){e(n)})}else e(!1)}},i.OUtil.setNamespace("Manifest",i),i.Manifest.HostApp=function(e){this._appName=e,this._minVersion=null},i.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(e){this._minVersion=e}},i.Manifest.ExtensionSettings=function(){this._sourceLocations={},this._defaultHeight=null,this._defaultWidth=null},i.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(e,t){this._sourceLocations[e.toLocaleLowerCase()]=t},_setDefaultWidth:function(e){this._defaultWidth=e},_setDefaultHeight:function(e){this._defaultHeight=e}},i.Manifest.WebAppInfoAuthorization=function(){this._resource=null,this._scopes=null},i.Manifest.WebAppInfoAuthorization.prototype={getResource:function(){return this._resource},getScopes:function(){return this._scopes}},i.Manifest.Manifest=function(e,t){var n="o:OfficeApp",r="1.1",o=this;if(o._UILocale=t||"en-us","string"==typeof e){var s;o._displayNames={},o._descriptions={},o._iconUrls={},o._extensionSettings={},o._highResolutionIconUrls={},o._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces[r]),o._xmlProcessor.selectSingleNode(n)?(s=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Hosts",l);e._hosts=e._parseHosts(t),t&&(e._hostsXml=t.xml||t.outerHTML);t=e._xmlProcessor.selectSingleNode("o:Requirements",l),e._requirements=e._parseRequirements(t),t&&(e._requirementsXml=t.xml||t.outerHTML);(t=e._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",l))&&e._parseLocaleAwareSettings(t,Function.createDelegate(e,e._addHighResolutionIconUrl))},o._manifestSchemaVersion=i.ManifestSchemaVersion[r]):(o._xmlProcessor=new i.XmlProcessor(e,i.ManifestNamespaces["1.0"]),s=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Capabilities",l),n=e._xmlProcessor.selectNodes("o:Capability",t);e._capabilities=e._parseCapabilities(n)},o._manifestSchemaVersion=i.ManifestSchemaVersion["1.0"]);var c=o._xmlProcessor.getDocumentElement();o._target=i.OUtil.parseEnum(c.getAttribute("xsi:type"),i.OfficeAppType);var l=o._xmlProcessor.selectSingleNode(n);if(c=o._xmlProcessor.selectSingleNode("o:Id",l),o._id=o._xmlProcessor.getNodeValue(c),!new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i").test(o._id))throw a.msAjaxError.argument("Manifest");if(c=o._xmlProcessor.selectSingleNode("o:Version",l),o._version=o._xmlProcessor.getNodeValue(c),c=o._xmlProcessor.selectSingleNode("o:ProviderName",l),o._providerName=o._xmlProcessor.getNodeValue(c),c=o._xmlProcessor.selectSingleNode("o:IdIssuer",l),o._idIssuer=o._parseIdIssuer(c),(c=o._xmlProcessor.selectSingleNode("o:AlternateId",l))&&(o._alternateId=o._xmlProcessor.getNodeValue(c)),c=o._xmlProcessor.selectSingleNode("o:DefaultLocale",l),o._defaultLocale=o._xmlProcessor.getNodeValue(c),c=o._xmlProcessor.selectSingleNode("o:DisplayName",l),o._parseLocaleAwareSettings(c,Function.createDelegate(o,o._addDisplayName)),c=o._xmlProcessor.selectSingleNode("o:Description",l),o._parseLocaleAwareSettings(c,Function.createDelegate(o,o._addDescription)),c=o._xmlProcessor.selectSingleNode("o:AppDomains",l),o._appDomains=o._parseAppDomains(c),(c=o._xmlProcessor.selectSingleNode("o:IconUrl",l))&&o._parseLocaleAwareSettings(c,Function.createDelegate(o,o._addIconUrl)),(c=o._xmlProcessor.selectSingleNode("o:Signature",l))&&(o._signature=o._xmlProcessor.getNodeValue(c)),o._parseExtensionSettings(),c=o._xmlProcessor.selectSingleNode("o:Permissions",l),o._permissions=o._parsePermission(c),o._allowSnapshot=!0,(c=o._xmlProcessor.selectSingleNode("o:AllowSnapshot",l))&&(o._allowSnapshot=o._parseBooleanNode(c)),o._manifestSchemaVersion===i.ManifestSchemaVersion[r]){var u="ov:";if(o._target==i.OfficeAppType.ContentApp&&(u="c:"),c=o._xmlProcessor.selectSingleNode(u+"VersionOverrides",l)){var d=o._xmlProcessor.selectSingleNode(u+"WebApplicationInfo",c);if(d){var p=o._xmlProcessor.selectSingleNode(u+"Resource",d);o._webApplicationResource=o._xmlProcessor.getNodeValue(p);var f=o._xmlProcessor.selectSingleNode(u+"Id",d);o._webApplicationId=o._xmlProcessor.getNodeValue(f);var m=o._xmlProcessor.selectSingleNode(u+"Scopes",d);o._webApplicationScopes=o._parseWebApplicationScopes(m,u),o._webApplicationAuthorizations=o._parseWebAppInfoAuthorizations(d,u)}}}if(o._manifestSchemaVersion===i.ManifestSchemaVersion[r]){var g=o._xmlProcessor.selectSingleNode("ov:VersionOverrides",l);g&&(o._manifestSourceLocationOverrides=o._parseSourceLocationOverrides(g))}s.apply(o)}else e(o)},i.Manifest.Manifest.prototype={getSourceLocationOverrideByResourceId:function(e){return e&&this._manifestSourceLocationOverrides?this._manifestSourceLocationOverrides[e]:null},getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(e){return this._displayNames[e.toLocaleLowerCase()]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(e){return this._descriptions[e]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(e){return this._iconUrls[e]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(e,t){return this._getExtensionSetting(t).getSourceLocations()[e.toLocaleLowerCase()]},getDefaultSourceLocation:function(e){var t=this._getExtensionSetting(e).getSourceLocations();return this._getDefaultValue(t)},getDefaultWidth:function(e){return this._getExtensionSetting(e).getDefaultWidth()},getDefaultHeight:function(e){return this._getExtensionSetting(e).getDefaultHeight()},getTarget:function(){return this._target},getOmexTargetCode:function(){switch(this._target){case i.OfficeAppType.ContentApp:return 2;case i.OfficeAppType.TaskPaneApp:return 1;case i.OfficeAppType.MailApp:return 3;default:return 0}},getPermission:function(){return this._permissions},hasPermission:function(e){return(this._permissions&e)===e},getHosts:function(){return this._hosts},getHostsXml:function(){return this._hostsXml},getRequirements:function(){return this._requirements},getRequirementsXml:function(){return this._requirementsXml},getHighResolutionIconUrl:function(e){return this._highResolutionIconUrls[e]},getDefaultHighResolutionIconUrl:function(){return this._getDefaultValue(this._highResolutionIconUrls)},getAppDomains:function(){return this._appDomains},getInMemoryEToken:function(){return this._inMemoryEToken},isAllowSnapshot:function(){return this._allowSnapshot},addManifestUrl:function(e){var t=u.WACUtils.getDomainForUrl(e);-1===this._appDomains.indexOf(t)&&this._appDomains.push(t)},getWebApplicationResource:function(){return this._webApplicationResource},getWebApplicationId:function(){return this._webApplicationId},getWebApplicationScopes:function(){return this._webApplicationScopes},getWebApplicationAuthorizations:function(){return this._webApplicationAuthorizations},isSSOAddin:function(){return!!this._webApplicationResource&&!!this._webApplicationId},containsAddinCommands:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t&&null!=this._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",t))return!0;return!1},containsCustomFunctions:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t){var n=this._xmlProcessor.selectSingleNode("ov:AllFormFactors",t);if(null!==n){var r=this._xmlProcessor.selectNodes("ov:ExtensionPoint",n);if(null!==r)for(var a=r.length,i=0;i<a;i++){if("CustomFunctions"===r[i].getAttribute("xsi:type"))return!0}}}return!1},containsCustomFunctionsForAppHost:function(e){var t=i.getManifestHostType(e);return e!=i.HostType.Outlook&&this.containsCustomFunctions(t)},_getDefaultValue:function(e){var t,n=this;if(n._UILocale&&(t=e[n._UILocale]||e[n._UILocale.toLocaleLowerCase()]||void 0),!t&&n._defaultLocale&&(t=e[n._defaultLocale]||e[n._defaultLocale.toLocaleLowerCase()]||void 0),!t){var r;for(var a in e){r=a;break}t=e[r]}return t},_getExtensionSetting:function(e){var t,n=this;if(void 0!==n._extensionSettings[e])t=n._extensionSettings[e];else for(var r in n._extensionSettings){t=n._extensionSettings[r];break}return t},_addDisplayName:function(e,t){this._displayNames[e.toLocaleLowerCase()]=t},_addDescription:function(e,t){this._descriptions[e]=t},_addIconUrl:function(e,t){this._iconUrls[e]=t},_parseLocaleAwareSettings:function(e,t){if(!e)throw a.msAjaxError.argument("Manifest");var n=e.getAttribute("DefaultValue");t(this._defaultLocale,n);var r=this._xmlProcessor.selectNodes("o:Override",e);if(r)for(var i=r.length,o=0;o<i;o++){var s=r[o];t(s.getAttribute("Locale"),s.getAttribute("Value"))}},_parseBooleanNode:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e).toLowerCase();return"true"===t||"1"===t}return!1},_parseIdIssuer:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.ManifestIdIssuer)}return i.ManifestIdIssuer.Custom},_parseCapabilities:function(e){for(var t,n=[],r=0;r<e.length;r++){t=e[r].getAttribute("Name"),t=i.OUtil.parseEnum(t,i.Capability),n.push(t)}return n},_parsePermission:function(e){if(!e)throw a.msAjaxError.argument("Manifest");var t=this._xmlProcessor.getNodeValue(e);return i.OUtil.parseEnum(t,i.OsfControlPermission)},_parseExtensionSettings:function(){var e,t,n,r=this,o=r;for(var s in i.FormFactor){var c=r._xmlProcessor.selectSingleNode("o:OfficeApp");if(t=r._xmlProcessor.selectSingleNode("o:"+i.FormFactor[s],c)){e=new i.Manifest.ExtensionSettings,n=r._xmlProcessor.selectSingleNode("o:SourceLocation",t);r._parseLocaleAwareSettings(n,function(t,n){e._addSourceLocation(t,n),o.addManifestUrl(n)}),(n=r._xmlProcessor.selectSingleNode("o:RequestedWidth",t))&&e._setDefaultWidth(r._xmlProcessor.getNodeValue(n)),(n=r._xmlProcessor.selectSingleNode("o:RequestedHeight",t))&&e._setDefaultHeight(r._xmlProcessor.getNodeValue(n)),r._extensionSettings[s]=e}}if(!e)throw a.msAjaxError.argument("Manifest")},_parseHosts:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Host",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseWebApplicationScopes:function(e,t){var n=[];if(e)for(var r=this._xmlProcessor.selectNodes(t+"Scope",e),a=0;a<r.length;a++)n.push(this._xmlProcessor.getNodeValue(r[a]));return n},_parseWebAppInfoAuthorizations:function(e,t){var n=this,r=[],a=n._xmlProcessor.selectSingleNode(t+"Authorizations",e);if(a){var o=n._xmlProcessor.selectNodes(t+"Authorization",a);if(o)for(var s in o){var c=o[s],l=new i.Manifest.WebAppInfoAuthorization,u=n._xmlProcessor.selectSingleNode(t+"Resource",c);u&&(l._resource=n._xmlProcessor.getNodeValue(u));var d=n._xmlProcessor.selectSingleNode(t+"Scopes",c);if(d){var p=n._xmlProcessor.selectNodes(t+"Scope",d);if(p){var f=[];for(var m in p){var g=p[m];f.push(n._xmlProcessor.getNodeValue(g))}l._scopes=f}}r.push(l)}}return r},_parseRequirements:function(e){var t=this,n={sets:[],methods:[]};if(e){var r=t._xmlProcessor.selectSingleNode("o:Sets",e);n.sets=t._parseSets(r);var a=t._xmlProcessor.selectSingleNode("o:Methods",e);n.methods=t._parseMethods(a)}return n},_parseSets:function(e){var t=[];if(e)for(var n=e.getAttribute("DefaultMinVersion"),r=this._xmlProcessor.selectNodes("o:Set",e),a=0;a<r.length;a++){var i=r[a],o=i.getAttribute("MinVersion");t.push({name:i.getAttribute("Name"),version:o||n})}return t},_parseMethods:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Method",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseSourceLocationOverrides:function(e){var t={};if(e){var n=this._xmlProcessor.selectSingleNode("ov:Resources",e);if(n){var r=this._xmlProcessor.selectSingleNode("bt:Urls",n);if(r){var a=this._xmlProcessor.selectNodes("bt:Url",r);if(a)for(var i=0;i<a.length;i++){var o=a[i],s=o.getAttribute("id"),c=o.getAttribute("DefaultValue");s&&c&&(t[s]=c)}}}}return t},_parseAppDomains:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:AppDomain",e),r=0;r<n.length;r++){var a=u.WACUtils.getDomainForUrl(this._xmlProcessor.getNodeValue(n[r]));-1===t.indexOf(a)&&t.push(a)}return t},_addHighResolutionIconUrl:function(e,t){this._highResolutionIconUrls[e]=t},_isAddinCommandsManifest:function(e){return this.containsAddinCommands(e)||this.containsCustomFunctions(e)},_getCurrentHostTypeNode:function(e){var t=null,n=this,r=n._xmlProcessor.selectSingleNode("o:OfficeApp");if(r!==t&&n.getManifestSchemaVersion()===i.ManifestSchemaVersion[1.1]){var a=n._xmlProcessor.selectSingleNode("ov:VersionOverrides",r);if(a!==t){var o=n._xmlProcessor.selectSingleNode("ov:Hosts",a);if(o!==t){var s=n._xmlProcessor.selectNodes("ov:Host",o);if(s!==t)for(var c=s.length,l=0;l<c;l++){if(s[l].getAttribute("xsi:type")===e)return s[l]}}}}return t}},i.OsfManifestManager=function(){var e="undefined",t="marketplaceVersion",n="marketplaceID",r=null,a=!0,o=!1,c={},l="en-us",d={};function p(e,t){return e+"_"+t}return{getManifestAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o}},t);var n=e.referenceInUse,l=p(n.id,n.version),d=c[l];if(e.manifestCached=o,d)e.manifestCached=a,t({statusCode:i.ProxyCallStatusCode.Succeeded,value:d,context:e});else if(e.clientEndPoint&&e.manifestUrl){s.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);var f={manifestUrl:e.manifestUrl,id:n.id,version:n.version,clearCache:e.clearCache||o};this._invokeProxyMethodAsync(e,"OEM_getManifestAsync",function(e){var o;if(e.statusCode===i.ProxyCallStatusCode.Succeeded&&e.value)try{var c;o=e.context.osfControl,"string"==typeof e.value?(e.context.manifestCached=a,c=e.value):(e.context.manifestCached=e.value.cached,c=e.value.manifest),s.AppLoadTimeHelper.SetManifestDataCachedFlag(o._telemetryContext,e.value.cached),e.value=new i.Manifest.Manifest(c,o._contextActivationMgr.getAppUILocale()),i.OsfManifestManager.cacheManifest(n.id,n.version,e.value)}catch(t){var l;e.value=r,o&&(l=o._appCorrelationId);var d="Invalid manifest in getManifestAsync.";u.WACUtils.logExceptionToBrowserConsole(d,t),s.RuntimeTelemetryHelper.LogExceptionTag(d,t,l,18420423)}else s.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+u.WACUtils.serializeObjectToString(e),r,r,18420424);t(e)},f)}else t({statusCode:i.ProxyCallStatusCode.Failed,value:r,context:e})},getAppInstanceInfoByIdAsync:function(e,t){i.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:o},appInstanceId:{type:String,mayBeNull:o},clientEndPoint:{type:Object,mayBeNull:o}},t);var n={webUrl:e.webUrl,appInstanceId:e.appInstanceId,clearCache:e.clearCache||o};this._invokeProxyMethodAsync(e,"OEM_getSPAppInstanceInfoByIdAsync",t,n)},getSPTokenByProductIdAsync:function(e,t){i.OUtil.validateParamObject(e,{appWebUrl:{type:String,mayBeNull:o},productId:{type:String,mayBeNull:o}},t);var n=this;e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.appWebUrl,function(a){if(a){var s={webUrl:e.appWebUrl,productId:e.productId,clearCache:e.clearCache||o,clientEndPoint:a};n._invokeProxyMethodAsync(e,"OEM_getSPTokenByProductIdAsync",t,s)}else t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:r,context:e})})},getSPAppEntitlementsAsync:function(e,t){var n="/";if(i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o},baseUrl:{type:String,mayBeNull:o},pageUrl:{type:String,mayBeNull:o},webUrl:{type:String,mayBeNull:a}},t),e.webUrl)this.getCorporateCatalogEntitlementsAsync(e,t);else{var s=document.createElement("a");s.href=e.pageUrl;var c=s.pathname,l=c.split(n),u=l.length-1,d=s.href.substring(0,s.href.length-c.length);d&&d.charAt(d.length-1)!==n&&(d+=n);for(var p=[d],f=0;f<u;f++)l[f]&&(d=d+l[f]+n,p.push(d));s=r;var m=this,g=e.osfControl._contextActivationMgr,h=p.pop(),v=function(e){if(e.statusCode===i.ProxyCallStatusCode.Succeeded){var r=e.value;r&&r.charAt(r.length-1)!==n&&(r+=n),g._webUrl=r,e.context.webUrl=r,e.context.appWebUrl=r,m.getCorporateCatalogEntitlementsAsync(e.context,t)}else t(e)},y=function(n){if(n){e.clientEndPoint=n;var a={pageUrl:e.pageUrl,baseUrl:h,clearCache:e.clearCache||o};m._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",v,a)}else p.length>0?(h=p.pop(),g._createSharePointIFrameProxy(h,y)):t({statusCode:i.ProxyCallStatusCode.Failed,value:r,context:e})};g._createSharePointIFrameProxy(h,y)}},getOneDriveEntitlementsAsync:function(e,t){var n="Content-Type",r=e.referenceInUse.storeLocator,a=e.referenceInUse.storeLocator+"/root:/Manifests",o=i.OneDriveOAuth.getAccessTokenFromCookie(),s="?access_token="+o,c=a+s,l=new XMLHttpRequest,u=new XMLHttpRequest;l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var t=JSON.parse(l.response).id,r=e.referenceInUse.storeLocator+"/items/"+t+"/children"+s;u.open("GET",r),u.setRequestHeader(n,"json"),u.send()}};var d=[],p=0,f=0,m=function(){p==f&&t({statusCode:i.ProxyCallStatusCode.Succeeded,value:{entitlements:d},context:e})},g=function(e,t){f++;var n=t;try{var r=new i.Manifest.Manifest(e.responseText),a=[];a.push(r.getDefaultDisplayName()),a.push(n),a.push(r.getDefaultDescription()),a.push(r.getTarget()),a.push(r.getMarketplaceVersion()),a.push(n),a.push(i.StoreType.OneDrive),a.push(r.getDefaultWidth()||0),a.push(r.getDefaultHeight()||0),a.push(r.getDefaultIconUrl()),a.push(r.getProviderName()),a.push(r.getDefaultLocale()),a.push(i.StoreType.OneDrive),d.push(a)}catch(e){}m()},h=function(){f++,m()};u.onreadystatechange=function(){if(4==u.readyState&&200==u.status){for(var e=JSON.parse(u.responseText),t=0;t<e.value.length;t++)if(".xml"==e.value[t].name.substr(e.value[t].name.length-4).toLowerCase()){var n=r+"/root:/Manifests/"+e.value[t].name+":/content?access_token="+o;i.OUtil.xhrGetFull(n,e.value[t].name,g,h),p++}m()}},l.open("GET",c),l.setRequestHeader(n,"json"),l.send()},getCorporateCatalogEntitlementsAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o},webUrl:{type:String,mayBeNull:o}},t),s.AppLoadTimeHelper.AuthenticationStart(e.osfControl._telemetryContext);var n=this,c=0,l=function(u){if(u){s.AppLoadTimeHelper.AuthenticationEnd(e.osfControl._telemetryContext),e.clientEndPoint=u;var d={webUrl:e.webUrl,applicationName:i.HostCapability[e.hostType],officeExtentionTarget:e.noTargetType||e.osfControl.getOsfControlType()===i.OsfControlTarget.TaskPane?r:e.osfControl.getOsfControlType(),clearCache:e.clearCache||o,supportedManifestVersions:{"1.0":a,1.1:a}};n._invokeProxyMethodAsync(e,"OEM_getEntitlementSummaryAsync",t,d)}else c<i.Constants.AuthenticatedConnectMaxTries?(c++,setTimeout(function(){e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,l)},500)):t({statusCode:i.ProxyCallStatusCode.ProxyNotReady,value:r,context:e})};e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,l)},_invokeProxyMethodAsync:function(e,t,n,a){var o,c=[a.clientEndPoint?a.clientEndPoint._targetUrl:e.clientEndPoint._targetUrl,t];for(var l in a)("string"===(o=typeof a[l])||"number"===o||"boolean"===o)&&c.push(a[l]);var p=c.join("."),f=d,m={onCompleted:n,context:e,methodName:t},g=f[p];if(g)g.push(m);else{f[p]=[m];var h=e.clientEndPoint;a.clientEndPoint&&(h=a.clientEndPoint,delete a.clientEndPoint),e.referenceInUse&&e.referenceInUse.storeType===i.StoreType.OMEX&&(a.officeVersion=i.Constants.ThreePartsFileVersion),h.invoke(t,function(e,t){var n=r,a=i.ProxyCallStatusCode.Failed;0===e&&t.status&&(n=t.result,a=i.ProxyCallStatusCode.Succeeded);var o=f[p];delete f[p];for(var c=o.length,l=0;l<c;l++){var d,m=o.shift();try{m.context&&m.context.osfControl&&(d=m.context.osfControl._appCorrelationId),t&&t.failureInfo&&s.RuntimeTelemetryHelper.LogProxyFailure(d,m.methodName,t.failureInfo),m.onCompleted({statusCode:a,value:n,context:m.context})}catch(e){var g="_invokeProxyMethodAsync failed.";u.WACUtils.logExceptionToBrowserConsole(g,e),s.RuntimeTelemetryHelper.LogExceptionTag(g,e,d,18420425)}}},a)}},removeOmexCacheAsync:function(e,t){i.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:o},referenceInUse:{type:Object,mayBeNull:o},clientEndPoint:{type:Object,mayBeNull:o}},t);var n=e.referenceInUse,r={applicationName:e.hostType,assetID:n.id,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||o,clearToken:e.clearToken||o,clearAppState:e.clearAppState||o,clearManifest:e.clearManifest||o,appVersion:e.appVersion};e.anonymous?r.contentMarket=n.storeLocator:(r.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,r.userContentMarket=n.storeLocator),this._invokeProxyMethodAsync(e,"OMEX_removeCacheAsync",t,r)},purgeManifest:function(r,a){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o}]);if(i)throw i;var s=p(r,a);typeof c[s]!=e&&delete c[s]},cacheManifestFromXml:function(e,r,a,s){var c=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o},{name:"manifestXml",type:String,mayBeNull:o},{name:"uiLocale",type:String,mayBeNull:o}]);if(c)throw c;this.cacheManifest(e,r,new i.Manifest.Manifest(a,s))},cacheManifest:function(e,r,a){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o},{name:"manifest",type:Object,mayBeNull:o}]);if(i)throw i;var s=p(e,r);a._UILocale=a._UILocale||l,c[s]=a},hasManifest:function(r,i){var s=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o}]);if(s)throw s;var l=p(r,i);return typeof c[l]!=e?a:o},getCachedManifest:function(e,r){var a=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:o},{name:t,type:String,mayBeNull:o}]);if(a)throw a;var i=p(e,r);return c[i]},versionLessThan:function(e,t){for(var n,r,a=e.split("."),i=t.split("."),s=Math.min(a.length,i.length),c=0;c<s;c++)try{if((n=parseFloat(a[c]))!=(r=parseFloat(i[c])))return n<r}catch(e){}if(a.length>=i.length)return o;s=i.length;var l=0;for(c=a.length;c<s;c++){try{r=parseFloat(i[c])}catch(e){r=0}l+=r}return l>0},_setUILocale:function(e){l=e}}}(),i.ManifestSchemaVersion={"1.0":"1.0",1.1:"1.1"},i.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',1.1:'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xmlns:c="http://schemas.microsoft.com/office/contentappversionoverrides"'},i.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3},i.RequirementsChecker=function(e,t,n,r,a){var i=this;i.setCapabilities(e),i.setHosts(t),i.setRequirements(n),i.setSupportedControlTargets(r),i.setSupportedOmexAppVersions(a),i.setFilteringEnabled(!1)},i.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.getManifestSchemaVersion()||i.ManifestSchemaVersion["1.0"]){case i.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(e);case i.ManifestSchemaVersion[1.1]:return this._checkManifest1_1(e);default:return!1}},isEntitlementFromOmexSupported:function(e){var t,n=this;if(!n.isFilteringEnabled())return!0;if(!e)return!1;switch(e.appSubType){case"1":t=i.OsfControlTarget.TaskPane;break;case"2":t=i.OsfControlTarget.InContent;break;case"3":t=i.OsfControlTarget.Contextual;break;case"4":t=i.OsfControlTarget.TaskPane;break;default:return!1}if(!n._checkControlTarget(t))return!1;if(!e.requirements&&!e.hosts)return!e.hasOwnProperty("appVersions")||void 0===e.appVersions||n._checkOmexAppVersions(e.appVersions);var r,a,o,s,c=new i.Manifest.Manifest(function(){});return e.requirements&&(c._xmlProcessor=new i.XmlProcessor(e.requirements,i.ManifestNamespaces[1.1]),a=c._xmlProcessor.getDocumentElement()),r=c._parseRequirements(a),e.hosts&&(c._xmlProcessor=new i.XmlProcessor(e.hosts,i.ManifestNamespaces[1.1]),s=c._xmlProcessor.getDocumentElement()),o=c._parseHosts(s),n._checkHosts(o)&&n._checkSets(r.sets)&&n._checkMethods(r.methods)},isEntitlementFromCorpCatalogSupported:function(e){var t=this;if(!t.isFilteringEnabled())return!0;if(!e)return!1;var n=i.OfficeAppType[e.OEType];if(!t._checkControlTarget(n))return!1;var r,a,o,s,c,l=new i.Manifest.Manifest(function(){});e.OfficeExtensionCapabilitiesXML&&(l._xmlProcessor=new i.XmlProcessor(e.OfficeExtensionCapabilitiesXML,i.ManifestNamespaces[1.1]),s=l._xmlProcessor.getDocumentElement(),a=(c=l._parseRequirements(s)).sets,o=c.methods,r=l._parseHosts(s));return t._checkHosts(r)&&t._checkSets(a)&&t._checkMethods(o)},setCapabilities:function(e){this._supportedCapabilities=this._scalarArrayToObject(e)},setHosts:function(e){this._supportedHosts=this._scalarArrayToObject(e)},setRequirements:function(e){var t=this;t._supportedSets=e&&t._arrayToSetsObject(e.sets)||{},t._supportedMethods=e&&t._scalarArrayToObject(e.methods)||{}},setSupportedControlTargets:function(e){this._supportedControlTargets=this._scalarArrayToObject(e)},setSupportedOmexAppVersions:function(e){this._supportedOmexAppVersions=e&&e.slice?e.slice(0):[]},setFilteringEnabled:function(e){this._filteringEnabled=!!e},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(e){return this._checkCapabilities(e.getCapabilities())},_checkCapabilities:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedCapabilities[e[t]])return!0;return!1},_checkManifest1_1:function(e){var t=e.getRequirements()||{};return this._checkHosts(e.getHosts())&&this._checkSets(t.sets)&&this._checkMethods(t.methods)},_checkHosts:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedHosts[e[t]])return!0;return!1},_checkSets:function(e){var t=this;if(!e||0===e.length)return!0;for(var n=0;n<e.length;n++){var r=e[n],a=t._supportedSets[r.name.toLowerCase()];if(!a)return!1;if(r.version&&(t._compareVersionStrings(a.minVersion||t.defaultMinMaxVersion,r.version)>0||t._compareVersionStrings(a.maxVersion||t.defaultMinMaxVersion,r.version)<0))return!1}return!0},_checkMethods:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(!this._supportedMethods[e[t]])return!1;return!0},_checkControlTarget:function(e){return null!=e&&this._supportedControlTargets[e]},_checkOmexAppVersions:function(e){if(!e)return!1;for(var t=0;t<this._supportedOmexAppVersions.length;t++)if(e.indexOf(this._supportedOmexAppVersions[t])>=0)return!0;return!1},_scalarArrayToObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++)null!=e[n]&&(t[e[n]]=!0);return t},_arrayToSetsObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];r&&null!=r.name&&(t[r.name.toLowerCase()]=r)}return t},_getSupportedSet:function(){for(var e={},t=Object.getOwnPropertyNames(this._supportedSets),n=0;n<t.length;n++){var r=this._supportedSets[t[n]];e[r.name.toLowerCase()]=r.maxVersion||this.defaultMinMaxVersion}return"undefined"!=typeof JSON?JSON.stringify(e):e},_compareVersionStrings:function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length),r=0;r<n;r++){var a=parseInt(e[r],10)||0,i=parseInt(t[r],10)||0;if(a!==i)return a-i}return 0}},u.appSpecificCheckOrigin=function(e,t,n,r){try{return!(!(t&&t.source&&t.source.location&&t.source.location.pathname)||t.source.location.pathname.indexOf("projection.aspx")<0)&&r(e,n)}catch(e){return!1}},window.OfficeExt=u},3854:function(e,t){e.exports={am:"am-et",ar:"ar-sa",bg:"bg-bg","bn-in":"bn-in",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es","es-mx":"es-mx",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr","fr-ca":"fr-ca",gl:"gl-es",gu:"gu-in",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",kn:"kn-in",ko:"ko-kr","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv",ml:"ml-in",mr:"mr-in",ms:"ms-my",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",pl:"pl-pl",pt:"pt-br","pt-pt":"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn","zh-hans":"zh-cn","zh-hant":"zh-tw"}},3855:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._2IwjXWsBof1LEMlX5rjY6x{width:300px;height:71px}._1QvD6qjp1cCyQX1rPCvklr{display:none!important}",""]),t.locals={consentContainer:"_2IwjXWsBof1LEMlX5rjY6x",hiddenContainer:"_1QvD6qjp1cCyQX1rPCvklr"}},3856:function(e,t,n){var r=n(3857),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3857:function(e,t,n){var r=n(2040);(t=e.exports=n(54)(!1)).push([e.i,"._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel{top:48px}._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-contentInner{top:40px;position:absolute;overflow:visible}._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-contentInner .ms-Panel-content{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;min-height:400px;overflow:visible}html[dir] ._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-bottom:0}html[dir=ltr] ._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-contentInner .ms-Panel-content,html[dir=rtl] ._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-contentInner .ms-Panel-content{padding-left:0;padding-right:0}._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-main{width:955px!important}html[dir=ltr] ._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-main{right:0!important;left:auto!important}html[dir=rtl] ._3ABYy1yjtTrGXE0kxWnyQO.ms-Panel .ms-Panel-main{left:0!important;right:auto!important}._23q5NnoE2HPOyes7APcWZ0{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100vh - 80px);width:960px;overflow:hidden}._3z_Eoamt--4t8xyin4Sox-{position:absolute;top:6px;z-index:1000;cursor:pointer}html[dir] ._3z_Eoamt--4t8xyin4Sox-{background:none}html[dir=ltr] ._3z_Eoamt--4t8xyin4Sox-{left:901px}html[dir=rtl] ._3z_Eoamt--4t8xyin4Sox-{right:901px}.H0xzDjov0m5suiJq2FHGE{height:100%;width:100%}html[dir] .H0xzDjov0m5suiJq2FHGE{background:url("+r(n(3265))+");background-repeat:no-repeat;background-position:50%;padding-top:17px}._7umiVcLYypRrTWKqVg-Gh{top:11px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._7umiVcLYypRrTWKqVg-Gh{right:73px}html[dir=rtl] ._7umiVcLYypRrTWKqVg-Gh{left:73px}.CaoSkXe79e_HA1fNeDvMI{height:100%;width:100%}html[dir] .CaoSkXe79e_HA1fNeDvMI{background:url("+r(n(3265))+");background-repeat:no-repeat;background-position:50%}._1ZHxk5aS351C3dk1b_NsL4{top:-29px;z-index:1;position:absolute;cursor:pointer}html[dir=ltr] ._1ZHxk5aS351C3dk1b_NsL4{right:73px}html[dir=rtl] ._1ZHxk5aS351C3dk1b_NsL4{left:73px}",""]),t.locals={inClientStorePanelContainer:"_3ABYy1yjtTrGXE0kxWnyQO",container:"_23q5NnoE2HPOyes7APcWZ0",closeButton:"_3z_Eoamt--4t8xyin4Sox-",inClientStoreIFrameCenter:"H0xzDjov0m5suiJq2FHGE",FeedbackCommandBarCenter:"_7umiVcLYypRrTWKqVg-Gh",inClientStoreIFrame:"CaoSkXe79e_HA1fNeDvMI",FeedbackCommandBar:"_1ZHxk5aS351C3dk1b_NsL4"}},386:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(735),a=function(e){return[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]},i=function(e){var t=a(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress.EmailAddress})},o=function(e){var t=a(e);return Object(r.a)(t).map(function(e){return e.persona.EmailAddress})}},3861:function(e,t,n){var r=n(3862),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3862:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._2VMsDISazXAAMjGAz0QE1L{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;max-width:510px}html[dir] ._2VMsDISazXAAMjGAz0QE1L{margin:30px}",""]),t.locals={divContainer:"_2VMsDISazXAAMjGAz0QE1L"}},3863:function(e,t,n){var r=n(3864),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3864:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._1jZWQDWEaSmKRIYcLO7t6W{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._1jZWQDWEaSmKRIYcLO7t6W{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._1jZWQDWEaSmKRIYcLO7t6W .ms-Callout-main{overflow:hidden!important}.f54SiBNe7CoJN69TQKx-Y{height:32px!important;color:inherit}html[dir] .f54SiBNe7CoJN69TQKx-Y{background-color:transparent}.f54SiBNe7CoJN69TQKx-Y .ms-Button{height:32px}._1hBWoAGN-D6FSRtocx9Tzi .ms-Button-label,.f54SiBNe7CoJN69TQKx-Y .is-expanded .ms-CommandBarItem-overflow{color:"[theme:themePrimary, default:#0078D4]"!important}.n9V7qduDbfKti1imDhA-C{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}html[dir] .n9V7qduDbfKti1imDhA-C{padding:8px}html[dir=ltr] .n9V7qduDbfKti1imDhA-C{float:left}html[dir=rtl] .n9V7qduDbfKti1imDhA-C{float:right}._1BmpObUU7NrFnmLfqUXFCn{height:16px;width:0}html[dir] ._1BmpObUU7NrFnmLfqUXFCn{padding:0;margin:8px 0;border-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"!important}html[dir=ltr] ._1BmpObUU7NrFnmLfqUXFCn{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._1BmpObUU7NrFnmLfqUXFCn{border-left-width:1px;border-left-style:solid;float:right}.bznuxXeqbanCSTPJKANfK{width:570px;max-height:450px;min-height:32px}html[dir] .bznuxXeqbanCSTPJKANfK{border-top-style:solid;border-top-width:1px;border-top-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={divContainer:"_1jZWQDWEaSmKRIYcLO7t6W",contextualBar:"f54SiBNe7CoJN69TQKx-Y",selected:"_1hBWoAGN-D6FSRtocx9Tzi",appIcon:"n9V7qduDbfKti1imDhA-C",divider:"_1BmpObUU7NrFnmLfqUXFCn",contextualAddinFrame:"bznuxXeqbanCSTPJKANfK"}},3865:function(e,t,n){var r=n(3866),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3866:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._1IeXJ1hn07aKgB3WG-0OVY{display:none}._11yJFeJioVkN2ZyNsB0f37{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none!important}html[dir] ._11yJFeJioVkN2ZyNsB0f37{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}",""]),t.locals={divContainer:"_1IeXJ1hn07aKgB3WG-0OVY",dialogContainer:"_11yJFeJioVkN2ZyNsB0f37"}},3867:function(e,t,n){var r=n(3868),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3868:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._2z78SZex2aWP6rphcKKo8S{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] ._2z78SZex2aWP6rphcKKo8S{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._3n32-nBGCSGi_RBL97XSy0{position:relative;top:25%}html[dir] ._3n32-nBGCSGi_RBL97XSy0{text-align:center}._2DpaADvmpkzIX7LIdAqReA{display:inline-block;font-size:80px;line-height:1;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._2DpaADvmpkzIX7LIdAqReA{text-align:center}.fhjELM4VU9eud5o8ySanr{display:block;max-width:70%}html[dir] .fhjELM4VU9eud5o8ySanr{margin:auto}._23HecXG9RGQGM0KLifhMnr{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._23HecXG9RGQGM0KLifhMnr{padding-top:25px}.prhdxAzt20TaxV1LtvIRF{font-size:12px;font-weight:400;color:"[theme:neutralSecondary, default:#666666]"}html[dir] .prhdxAzt20TaxV1LtvIRF{padding-top:10px}',""]),t.locals={errorContainer:"_2z78SZex2aWP6rphcKKo8S",errorContent:"_3n32-nBGCSGi_RBL97XSy0",errorIcon:"_2DpaADvmpkzIX7LIdAqReA",errorTextCommon:"fhjELM4VU9eud5o8ySanr",errorTextTitle:"_23HecXG9RGQGM0KLifhMnr",errorTextDescription:"prhdxAzt20TaxV1LtvIRF"}},3869:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._2yeRwX-dbTlOkS3z-1cvAr{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:70px}html[dir] ._2yeRwX-dbTlOkS3z-1cvAr{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white);padding:0 22px;padding-top:10px}._1388weeZLcyCaCcbeMYhS-{height:60px}html[dir] ._1388weeZLcyCaCcbeMYhS-{padding:0 32px;padding-top:10px}html[dir=ltr] ._1388weeZLcyCaCcbeMYhS-{padding-right:36px}html[dir=rtl] ._1388weeZLcyCaCcbeMYhS-{padding-left:36px}._3_4MGrskj3O35f_8jYjxj8{position:static}html[dir=ltr] ._3_4MGrskj3O35f_8jYjxj8{margin-right:-10px;right:0}html[dir=rtl] ._3_4MGrskj3O35f_8jYjxj8{margin-left:-10px;left:0}._24Dh-UJCMMyPNbZ_UdB4q7{font-size:32px;color:"[theme:neutralSecondary, default:#666666]";width:32px;height:32px;min-width:32px}html[dir] ._24Dh-UJCMMyPNbZ_UdB4q7{border:0;padding:0}html[dir=ltr] ._24Dh-UJCMMyPNbZ_UdB4q7{float:left}html[dir=rtl] ._24Dh-UJCMMyPNbZ_UdB4q7{float:right}._3EmHkw7DNVOAe7YcZmuysJ{color:"[theme:neutralTertiary, default:#a6a6a6]"}.xoC1lykbhU2aGESrFjX1i{font-size:21px;font-weight:100;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:"[theme:neutralPrimary, default:#333333]";overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] .xoC1lykbhU2aGESrFjX1i{float:left;margin-left:8px}html[dir=rtl] .xoC1lykbhU2aGESrFjX1i{float:right;margin-right:8px}._3leHOU7VTJ01sFzF34NX1K{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}._2_v1sdvJH_r2o-ZI5xP6jm{white-space:nowrap}._7aaSSnyztm7hprNVDs6R2{color:"[theme:neutralPrimary, default:#333333]"}',""]),t.locals={addinPaneHeader:"_2yeRwX-dbTlOkS3z-1cvAr",addinPaneHeaderCalendar:"_1388weeZLcyCaCcbeMYhS-",closeButton:"_3_4MGrskj3O35f_8jYjxj8",addinPaneIcon:"_24Dh-UJCMMyPNbZ_UdB4q7",fallbackIcon:"_3EmHkw7DNVOAe7YcZmuysJ",addinPaneLabelText:"xoC1lykbhU2aGESrFjX1i",ellipsis:"_3leHOU7VTJ01sFzF34NX1K",rightButtons:"_2_v1sdvJH_r2o-ZI5xP6jm",persistIcon:"_7aaSSnyztm7hprNVDs6R2"}},3870:function(e,t,n){var r=n(3871),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3871:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._9TS1iVQf07jU6Ipp9mLRg .ms-Panel-content{height:100%;overflow-y:hidden}html[dir] ._9TS1iVQf07jU6Ipp9mLRg .ms-Panel-content{padding:0}._9TS1iVQf07jU6Ipp9mLRg .ms-Panel-main{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);top:48px;height:calc(100% - 48px);width:320px!important}html[dir] ._9TS1iVQf07jU6Ipp9mLRg .ms-Panel-main{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}html[dir=ltr] ._9TS1iVQf07jU6Ipp9mLRg .ms-Panel-main{left:calc(100vw - 322px)!important}html[dir=rtl] ._9TS1iVQf07jU6Ipp9mLRg .ms-Panel-main{right:calc(100vw - 322px)!important}.pbF_5hXYKXo3JsJdNrJoJ .ms-Panel-main{top:0;height:100%}._9TS1iVQf07jU6Ipp9mLRg .ms-Panel-contentInner{height:100%}._9TS1iVQf07jU6Ipp9mLRg{height:100%;overflow-y:hidden}",""]),t.locals={taskPane:"_9TS1iVQf07jU6Ipp9mLRg",taskPaneNoHeader:"pbF_5hXYKXo3JsJdNrJoJ"}},3872:function(e,t,n){var r=n(3873),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3873:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._1Ao0zr7dHvI7atQ_y820Jc{display:none}._3jO_fYZkETihBbd1wAnkAS{width:100%;height:calc(100% - 80px)}._1kgyZKCq3JmMt853PY73hP{height:calc(100% - 70px)}.sFXu6QbY7Ky_o7XUmLrSp{display:block;top:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.sFXu6QbY7Ky_o7XUmLrSp iframe{max-height:100%}._2ZwJR2pdaqqXnj3Xg_FBSY{display:none}",""]),t.locals={divContainer:"_1Ao0zr7dHvI7atQ_y820Jc",extensionContainer:"_3jO_fYZkETihBbd1wAnkAS",extensionContainerCalendar:"_1kgyZKCq3JmMt853PY73hP",extensionHost:"sFXu6QbY7Ky_o7XUmLrSp",hide:"_2ZwJR2pdaqqXnj3Xg_FBSY"}},3874:function(e,t,n){var r=n(3875),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3875:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._3GlbR6r5hZZtQO_5eErN8c{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none}html[dir] ._3GlbR6r5hZZtQO_5eErN8c{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);--composeNeutralBackground:var(--fallback-composeNeutralBackground);--composeNeutralLighterBackground:var(--fallback-composeNeutralLighterBackground);background:var(--white)}._1gzBJflRWf7kgqloIUJMh0{height:190px}._2mAt9OH2hL-fmykxmkz2cu{width:550px;height:400px}.fPNKAC482erUZ8ypDgzAC{display:none!important}",""]),t.locals={dialogContainer:"_3GlbR6r5hZZtQO_5eErN8c",uiLessContainer:"_1gzBJflRWf7kgqloIUJMh0",consentContainer:"_2mAt9OH2hL-fmykxmkz2cu",hiddenContainer:"fPNKAC482erUZ8ypDgzAC"}},3876:function(e,t,n){var r=n(3877),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3877:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,".AKBXDolUEkjgZ8t9YVtQ0{width:100%;height:100%}",""]),t.locals={uiLessContainer:"AKBXDolUEkjgZ8t9YVtQ0"}},3878:function(e,t,n){var r=n(3879),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},3879:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,".ms-ContextualMenu-icon ._34U-dwA4A9qL_t4zAEdQ73{position:relative;top:-8px}",""]),t.locals={fallbackIcon:"_34U-dwA4A9qL_t4zAEdQ73"}},401:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1546);function a(e,t){return"HTML"==t&&e&&e.indexOf("<")>=0?r.HtmlSanitizer.convertInlineCss(e):e}},4315:function(e,t,n){"use strict";var r=n(1598),a=n(2888);n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return s});var i=function(e){return function(t,n){Object(r.a)(e,t,n)}},o=function(e){return function(t){Object(a.a)(e,t)}},s=function(e){return function(){return function(e){return e.infoBarIds}(e)}}},474:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"c",function(){return s});var r={};function a(e,t){r[e.composeId]=t}function i(e){return r[e.composeId]}function o(e){var t=i(e);t&&t.contentOperationPlugin&&t.contentOperationPlugin.stopSaveOnDispose(),delete r[e.composeId]}function s(e){var t=[e.dockingPlugin,e.ribbonPlugin,e.inlineImagePlugin,e.inlineImageResizePlugin,e.contentOperationPlugin,e.tableEdit];function n(e){e&&t.push(e)}return n(e.emojiPlugin),n(e.smartSuggestionsPlugin),n(e.linkPreviewPlugin),n(e.addinPlugin),n(e.accCheckerPlugin),n(e.pasteOptionPlugin),n(e.linkPlugin),n(e.mentionsPickerPlugin),n(e.cortanaComposePlugin),n(e.emojiPickerPlugin),n(e.smartComposePlugin),t}},479:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"i",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"g",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return p}),n.d(t,"e",function(){return f});var r=n(2),a=(n(1239),new r.c(function(){return n.e(146).then(n.bind(null,1879))})),i=new r.a(a,function(e){return e.clearInlineImageStore}),o=new r.b(a,function(e){return e.tryCreateDataURIFromImage}),s=new r.b(a,function(e){return e.cacheInlineImage}),c=new r.b(a,function(e){return e.logImageUpload}),l=new r.b(a,function(e){return e.logImageLoadError}),u=new r.b(a,function(e){return e.loadFromAttachmentServiceUrl}),d=new r.b(a,function(e){return e.loadFromAttachment}),p=new r.b(a,function(e){return e.loadFromProxy}),f=new r.b(a,function(e){return e.loadFromImageTag})},5079:function(e,t,n){var r=n(5080),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5080:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._2rFe9Eavw9OYJV9btTQfdH{width:16px;height:16px}html[dir] ._2rFe9Eavw9OYJV9btTQfdH{padding:7px}._3VxZo3VujIF36VYTy2QkM_{width:30px;height:30px;cursor:pointer}html[dir] ._3VxZo3VujIF36VYTy2QkM_{background-color:transparent;padding:0}html[dir=ltr] ._3VxZo3VujIF36VYTy2QkM_{margin:0 5px 0 0}html[dir=rtl] ._3VxZo3VujIF36VYTy2QkM_{margin:0 0 0 5px}html[dir] ._3VxZo3VujIF36VYTy2QkM_:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._3VxZo3VujIF36VYTy2QkM_ .ms-Button-menuIcon{display:none}',""]),t.locals={image:"_2rFe9Eavw9OYJV9btTQfdH",addinEntryButton:"_3VxZo3VujIF36VYTy2QkM_"}},5081:function(e,t,n){var r=n(5082),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5082:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._3TWgu5FKbs4M8gUiO8k9o_{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;height:30px}",""]),t.locals={listViewContainer:"_3TWgu5FKbs4M8gUiO8k9o_"}},5083:function(e,t,n){var r=n(5084),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5084:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._2u3egdG6DbxgQNDXArvfLZ{display:block}html[dir] ._2u3egdG6DbxgQNDXArvfLZ{background:transparent;border:none}html[dir=ltr] ._2u3egdG6DbxgQNDXArvfLZ{margin-right:5px}html[dir=rtl] ._2u3egdG6DbxgQNDXArvfLZ{margin-left:5px}._30APfly70tf6qamWM2aPBy{height:16px;width:0;color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._30APfly70tf6qamWM2aPBy{padding:0;margin:7px 0}html[dir=ltr] ._30APfly70tf6qamWM2aPBy{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._30APfly70tf6qamWM2aPBy{border-left-width:1px;border-left-style:solid;float:right}._2jMia2Taf-wXCVGdqZ2-kK{display:inline-block;width:30px;height:30px;cursor:pointer}html[dir] ._2jMia2Taf-wXCVGdqZ2-kK{background-color:transparent}html[dir] ._2jMia2Taf-wXCVGdqZ2-kK:hover{background-color:"[theme:themeLighter, default:#DEECF9]"}._2jMia2Taf-wXCVGdqZ2-kK .ms-Button-menuIcon{display:none}._1AK7cEK0BvAqF7ntZZ8md8{font-size:10px;color:"[theme:neutralSecondary, default:#666666]"}',""]),t.locals={overflowContainer:"_2u3egdG6DbxgQNDXArvfLZ",overflowDivider:"_30APfly70tf6qamWM2aPBy",overflowChevronContainer:"_2jMia2Taf-wXCVGdqZ2-kK",overflowChevron:"_1AK7cEK0BvAqF7ntZZ8md8"}},5085:function(e,t,n){var r=n(5086),a=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5086:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,".Xsn97PScx-fAjmSCnyR7O{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex}html[dir=ltr] .Xsn97PScx-fAjmSCnyR7O{float:right}html[dir=rtl] .Xsn97PScx-fAjmSCnyR7O{float:left}",""]),t.locals={divContainer:"Xsn97PScx-fAjmSCnyR7O"}},535:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var r=n(0),a=n(738),i=n(710);function o(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,Object(a.b)(e)];case 1:return t=r.sent(),(n=t).fromViewState=Object(i.a)(e.from,e.meetingRequestItem,e.referenceItemId,!0),n.publicFolderId=e.publicFolderId,[2,n]}})})}function s(e){return void 0!==e.publicFolderId}},548:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(139);function a(e,t,n){var a={pathname:e+t,search:n};return r.format(a)}},553:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(847),a=n(280),i="MailComposeSend";t.b={MailComposeReply:{name:"MailComposeReply",options:{isQos:!0},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{isQos:!0},customData:function(e){return[e.actionSource,e.useFullCompose]},actionSource:function(e){return e.actionSource},cosmosOnlyData:function(e){return e.referenceItemId}},MailComposeForward:{name:"MailComposeForward",options:{isQos:!0},customData:function(e,t,n,r){return[t]},actionSource:function(e,t,n,r){return t},cosmosOnlyData:function(e,t,n,r){return e&&e.toString()}},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:function(e){return{composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(a.b)(e)}}},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:function(e){return{composeTraceId:e.logTraceId,wasEmptyBody:e.initialContent===e.content,wasEmptySubject:""===e.subject}},options:{isCore:!0},cosmosOnlyData:function(e){return JSON.stringify({smartReplyExtractionId:Object(r.a)(e)})}},ComposeCommandShowFrom:{name:"ComposeCommandShowFrom"},ComposeCommandSetImportance:{name:"ComposeCommmandSetImportance",customData:function(e,t){return[t]}}}},554:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(7),a=n(47),i=n(5);function o(){return Object(r.a)().PolicyTipsEnabled&&(Object(a.a)()||Object(i.d)("cmp-policyTips"))}},6960:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(697),i=n(185),o=n(189),s=n(3851),c=n(3852),l=n(474),u=n(1565),d=n(224),p=n(868);var f=n(58),m=n(3222);function g(e,t){var n=S(e.docViewAttachments,t);if(n||(n=S(e.imageViewAttachments,t)),n||(n=S(e.inlineAttachments,t)),!n)throw new i.a(i.b.GenericResponseError);return m.b.importAndExecute(n,t)}var h=function(e){return function(t,n,r){return Object(c.a)(e,t,n,r).catch(v)}};function v(e){throw e.messageId?function(e){switch(e){case"ErrorTooLargeForLocalAttachmentSingle":case"ErrorTooLargeForLocalAttachmentMultiple":return i.b.AttachmentSizeExceeded;default:return i.b.AttachmentUploadGeneralFailure}}(e.messageId):i.b.AttachmentUploadGeneralFailure}var y=function(e){return function(t,n,r){return Object(s.a)(e,t,n,r).catch(v)}},b=function(e){return function(){return m.a.importAndExecute(e.attachmentWell)}},_=function(e){return function(t,n,r){return function(e,t,n,r){return new Promise(function(o,s){var c=!1,f=Object(d.a)(e);try{for(var m=atob(t),g=m.length,h=new Uint8Array(new ArrayBuffer(g)),v=0;v<g;v++)h[v]=m.charCodeAt(v);var y=Object(p.c)(n)?new Blob([h],{type:"image/png"}):new Blob([h]);y.name=n;var b=Object(a.e)([y]),_=Object(l.b)(e).inlineImagePlugin,S="HTML"!=e.bodyType?null:_.processInlineImageBeforeUpload.bind(_);Object(u.a)(b,e,{isInline:r,isHiddenInline:!0,shouldShare:!1},S,function(e,t){f(e,t),c||(c=!0,s({errorType:"UploadError",id:e}))},Object(d.c)(e),function(e){c||(c=!0,o(e.Id))})}catch(e){s({errorType:i.b.AttachmentUploadGeneralFailure})}})}(e,t,n,r).catch(v)}};function S(e,t){var n=e.filter(function(e){return e.attachmentId.Id===t});return n.length>0?n[0]:null}var C=function(e){return function(t){return new Promise(function(n,a){o.h.import().then(function(o){try{var s=S(e.attachmentWell.docViewAttachments,t);if(s||(s=S(e.attachmentWell.imageViewAttachments,t)),s||(s=S(e.attachmentWell.inlineAttachments,t)),!s)return void a(new i.a(i.b.AttachmentToDeleteDoesNotExist));var c=r.__assign({},e.itemId,{mailboxInfo:Object(f.a)()});o(e.attachmentWell,s,c,Object(d.a)(e),Object(d.c)(e)),n()}catch(e){a(new i.a(i.b.AttachmentDeleteGeneralFailure))}})})}},A=function(e){return function(t){return g(e.attachmentWell,t)}},I=function(e){return!(!e||0==e.length)&&e.some(function(e){return e.file.fileType==a.a.Uri&&e.isInline})},O=n(305),T=n(1569),x=function(e){return function(){var t=Object(l.b)(e);return Object(T.a)(e,t.addinPlugin.getContent()),Object(O.b)(e,!1,!0).then(function(){return Promise.resolve(e.itemId.Id)}).catch(function(){return Promise.resolve(null)})}},E=n(826),M=n(2050),P=n.n(M);function k(e,t,n){return function(){var r=Object(i.l)(t);if(!r)return null;var a=function(e,t,n,r){return{text:P.a.dismissAddinsInfoBarLabel,action:function(){var a=n.ExtensionId,o=n.Persistent;i.B.import().then(function(n){n(t),o&&i.G.import().then(function(t){t(e,a)})}),r(t)}}}(e,t,r,n);return{key:r.Key,source:E.c.Extensibility,rank:R(r.Type),messageParts:[r.Message,"|",a],color:E.a.Grey}}}function R(e){switch(e){case 0:case 1:return E.b.Info;case 2:return E.b.Error}return E.b.Safety}var w=function(e){return function(t){d.a(e)(t,k(Object(i.k)(e.composeId),t,N(e)))}},N=function(e){return function(t){d.c(e)([t])}},D=function(e){return function(){return d.b(e)()}},F=n(3835),L=n(1626),U=n(1591),B=n(577),j=n(1526),H=n(4),V=Object(H.action)("clearRecipientWell")(function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return e.recipients=[],e.isDirty=!0,[2]})})}),W=n(1978),G=function(e){return function(t){var n=K(e,t);return Object(B.a)(n)}},z=function(e){return function(t,n){X(e,t);var r=K(e,t);V(r);var a=n.map(function(e){return{isValid:!0,newPersona:{EmailAddress:e}}});Object(j.a)(r,a),Object(W.a)(r,!1)}},q=function(e){return function(t,n){X(e,t);var r=K(e,t),a=n.map(function(e){return{isValid:!0,newPersona:{EmailAddress:e}}});Object(j.a)(r,a),Object(W.a)(r,!1)}};function X(e,t){switch(e.showCompactRecipientWell&&Object(U.a)(e),t){case i.f.To:return;case i.f.Cc:return void Object(L.a)(e);case i.f.Bcc:return void Object(F.a)(e)}}var K=function(e,t){var n;switch(t){case i.f.To:n=e.toRecipientWell;break;case i.f.Cc:n=e.ccRecipientWell;break;case i.f.Bcc:n=e.bccRecipientWell}return n},J=n(127),Q=n(66),Y=n(8),Z=n.n(Y),$=function(e){return function(){Object(J.b)(Z.a.closeMessage,Z.a.addinCloseCompose,!Object(Q.h)(e),{okText:Z.a.closeButton,hideCancelButton:!1}).then(function(t){t==J.a.ok&&Q.i.importAndExecute(e)})}},ee=n(3634);function te(e){Object(ee.a)(e,"Mail_Addins",null,2)}var ne=n(22);function re(e){return ne.a.items.get(e)}var ae=n(5),ie=n(6),oe=n(68),se=n(572);function ce(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return(t=re(e))&&t.NormalizedBody?[3,2]:(n={Id:e,mailboxInfo:Object(f.b)(Object(ie.x)())},[4,Object(oe.j)(n,"LoadItemReadingPane")]);case 1:t=r.sent(),r.label=2;case 2:return t.IsDraft?[4,le(e)]:[3,4];case 3:return r.sent(),[3,5];case 4:Object(ae.d)("rp-popouts")&&Object(se.a)(e),r.label=5;case 5:return[2]}})})}function le(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return Object(ae.d)("rp-popouts")?[4,Q.q.importAndExecute(e,Q.a.Popout)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}var ue=n(161),de=n(1),pe=Object(de.mutatorAction)("appendOnSend",function(e,t){var n=e.appendOnSend;if(n){for(var r=!1,a=0;a<n.length;a++)if(n[a].id===t.id){e.appendOnSend[a]=t,r=!0;break}r||e.appendOnSend.push(t)}}),fe=function(e){return function(){var t=Object(l.b)(e);return Object(T.a)(e,t.addinPlugin.getContent()),e.content}},me=function(e){return function(t,n){(Object(T.a)(e,t),"HTML"==e.bodyType)&&Object(l.b)(e).addinPlugin.updateContent(t,n)}},ge=function(e){return function(){return e.bodyType}},he=function(e){return function(t){var n=Object(l.b)(e).addinPlugin;n.prependContent(t),Object(T.a)(e,n.getContent())}},ve=function(e){return function(t){var n=Object(l.b)(e).addinPlugin;n.setSelectedData(t),Object(T.a)(e,n.getContent())}},ye=function(e){return function(t){pe(e,t)}};var be=n(351),_e=n(352),Se=n(726),Ce=n(187),Ae=n.n(Ce),Ie=Object(de.mutatorAction)("setInternetHeaders",function(e,t){e.internetHeaders=e.internetHeaders.merge(t)}),Oe="00020386-0000-0000-C000-000000000046";function Te(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a;return r.__generator(this,function(r){switch(r.label){case 0:return a=[],t.forEach(function(t){e.internetHeaders.get(t)||a.push(t)}),a.length>0?[4,xe(a,e.itemId.Id)]:[3,2];case 1:n=r.sent(),Ie(e,n),r.label=2;case 2:return[2]}})})}function xe(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,a,i,o,s;return r.__generator(this,function(r){switch(r.label){case 0:n=Ae()({BaseShape:"IdOnly",AdditionalProperties:Ee(e)}),a={},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(be.a)([t],n,null)];case 2:return i=r.sent(),Object(_e.a)(i[0])&&(o=i[0],(s=o.Items[0]).ExtendedProperty&&(c=s.ExtendedProperty,a=c.reduce(function(e,t){return e[t.ExtendedFieldURI.PropertyName]=t.Value,e},{}))),[3,4];case 3:throw r.sent();case 4:return[2,a]}var c})})}function Ee(e){var t=[];return e.forEach(function(e){t.push(Object(Se.getExtendedPropertyUri)(Oe,e,"String"))}),t}var Me=function(e){return function(t){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,Te(e,t)];case 1:n.sent(),n.label=2;case 2:return[2,r.__spread(e.internetHeaders.keys()).filter(function(e){return t.includes(e)}).reduce(function(t,n){return t[n]=e.internetHeaders.get(n),t},{})]}})})}},Pe=function(e){return function(t){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return[4,xe(t,e.ItemId.Id)];case 1:return[2,n.sent()]}})})}},ke=function(e){return function(){return e.itemId?e.itemId.Id:null}},Re=function(e){return function(){return e.ItemId.Id}},we=function(e){return function(){return e.conversationId}},Ne=n(845),De=function(e){return function(){return e.fromViewState&&e.fromViewState.from?e.fromViewState.from.email:Object(Ne.a)()}},Fe=n(3848),Le=n(3849),Ue=function(e){return function(){return e.subject}},Be=function(e){return function(t){Object(Fe.a)(e,t)}};function je(e){return 5===e.lastFocusedControl}var He=function(e){return function(){return 7===e.lastFocusedControl?function(e){return function(){return function(e){return 7===e.lastFocusedControl}(e)?Object(l.b)(e).addinPlugin.getSelectedData():null}}(e)():5===e.lastFocusedControl?function(e){return function(){if(!je(e))return null;var t=e.subjectViewState,n=t.selectionStart,r=t.selectionEnd,a=e.subject;return{data:a=a.slice(n,r),sourceProperty:"subject",startPosition:n,endPosition:r}}}(e)():null}},Ve=function(e){return function(t){7===e.lastFocusedControl?ve(e)(t):5===e.lastFocusedControl&&function(e){return function(t){if(je(e)){var n=e.subject,r=e.subjectViewState,a=r.selectionStart,i=r.selectionEnd;n=n.slice(0,a)+t+n.slice(i),Object(Fe.a)(e,n);var o=a+t.length;Object(Le.a)(e,o,o)}}}(e)(t)}},We=n(217),Ge=function(e){return!!~Object(We.c)(We.a.SurfaceActions).composeSurfaceAddins.indexOf(e)},ze=function(e){return!!~Object(We.c)(We.a.SurfaceActions).readSurfaceAddins.indexOf(e)},qe=n(10),Xe=function(e){return function(){return Je(e)}},Ke=function(e){return function(){return!!e.itemId&&Je(Object(ne.c)().items.get(e.itemId.Id))}};function Je(e){if(!e||!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(qe.G)(t,qe.j)}function Qe(){return!0}var Ye=Object(de.mutatorAction)("removeInternetHeaders",function(e,t){t.forEach(function(t){e.internetHeaders.get(t)&&(e.keysOfInternetHeadersToBeRemoved.push(t),e.internetHeaders.delete(t))})}),Ze=function(e){return function(t){Ie(e,t)}},$e=function(e){return function(t){return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(n){switch(n.label){case 0:return 4!==e.operation?[3,2]:[4,Te(e,t)];case 1:n.sent(),n.label=2;case 2:return Ye(e,t),[2]}})})}},et=n(91);function tt(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,et.r.import()];case 1:return[2,t.sent()(e,"Addin")]}})})}function nt(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,et.t.import()];case 1:return[2,t.sent()(e,"Addin")]}})})}function rt(e){return{getRecipients:G(e),setRecipients:z(e),addRecipients:q(e),getSubject:Ue(e),setSubject:Be(e),getItemId:ke(e),getConversationId:we(e),getBody:fe(e),setBody:me(e),getBodyType:ge(e),prependBody:he(e),getSelectedData:He(e),setSelectedData:Ve(e),setBodySelectedData:ve(e),mode:ue.a.MessageCompose,saveItem:x(e),addNotificationMessage:w(e),removeNotificationMessage:N(e),getNotificationMessageIds:D(e),close:$(e),displayMessageForm:ce,displayAppointmentForm:te,addItemAttachment:h(e),addFileAttachment:y(e),addFileAttachmentFromBase64:_(e),removeAttachment:C(e),getAttachments:b(e),getAttachmentContent:A(e),isAddinPinned:Ge,isSharedItem:Ke(e),isRemoteItem:Qe,getFrom:De(e),getInternetHeaders:Me(e),setInternetHeaders:Ze(e),removeInternetHeaders:$e(e),appendOnSend:ye(e),addCategoriesMailbox:tt,removeCategoriesMailbox:nt}}function at(e){var t=[];return e&&(t=e.map(function(e){return{Mailbox:e}})),t}var it=n(2038),ot=n(2889),st=function(e,t,n,r,a,i,o,s){var c,l=at(e),u=at(t),d=new Date(null==n?Date.now():n),p=null==r?void 0:new Date(r);if(a){var f=Object(it.g)(a);c=Object(it.e)(f)[0]}var m={RequiredAttendees:l||[],OptionalAttendees:u||[],Locations:c?[c]:[],Resources:(i?i.map(function(e){return{Mailbox:{EmailAddress:e}}}):null)||[],Subject:o,Body:{Value:s},Start:d,End:p};Object(ot.b)(m,"Mail_AddIns",2)},ct=n(2910),lt=n(2737),ut=n(63);function dt(e,t,n,r){if(Object(ae.d)("rp-popouts")){var a=re(e),i=a?a.ConversationId.Id:null,o=Object(lt.a)(r);Q.w.importAndExecute({referenceItemId:{Id:e,mailboxInfo:Object(ut.c)()},isReplyAll:t,useFullCompose:!0,actionSource:"AddIns",instrumentationContexts:[],conversationId:i,body:n,fullComposeTarget:Q.a.Popout,attachmentFiles:o})}}var pt=n(13),ft=n(2719),mt=n.n(ft),gt=n(33),ht=n.n(gt),vt=n(2720),yt=n.n(vt),bt=n(31);function _t(e){return function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,yt()({Header:Object(bt.getJsonRequestHeader)(),Body:mt()({EventIds:[e],ItemShape:Ae()({BaseShape:"IdOnly",AdditionalProperties:[ht()({FieldURI:"calendar:Recurrence"}),ht()({FieldURI:"calendar:SeriesMasterItemId"})]})})},null)];case 1:return[2,t.sent().Body.ResponseMessages.Items]}})})}(e).then(function(e){if(Object(pt.f)(e[0])){var t=e[0].Items[0];return{SeriesMasterItemId:t.SeriesMasterItemId,Recurrence:t.Recurrence}}return null})}function St(e){var t=this;return e&&e.IsRecurring?function(){return r.__awaiter(t,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,_t(e.AssociatedCalendarItemId)];case 1:return(t=n.sent())&&t.SeriesMasterItemId?[2,t.SeriesMasterItemId.Id]:[2,null]}})})}:function(){return Promise.resolve(void 0)}}var Ct=n(174),At=n(29),It=function(e){return function(){var t=e.ParentFolderId.Id,n=Object(At.h)(),r=Object(Ct.f)(t,n);return{owner:Object(qe.x)().get(t).principalSMTPAddress,delegatePermissions:{Read:"FullDetails"==r.ReadItems,Create:r.CanCreateItems,EditOwn:"All"==r.EditItems||"Owned"==r.EditItems,EditAll:"All"==r.EditItems,DeleteOwn:"All"==r.DeleteItems||"Owned"==r.DeleteItems,DeleteAll:"All"==r.DeleteItems}}}},Ot=n(138),Tt=n(1579),xt=n(4315),Et=function(e){return function(t){xt.a(e)(t,k(Object(i.m)(e.itemId),t,Mt(e)))}},Mt=function(e){return function(t){xt.c(e)(t)}},Pt=function(e){return function(){return xt.b(e)()}},kt=function(e){return function(t){return g(e.attachmentWell,t)}},Rt=function(e){return function(){return e}},wt=function(e,t){return function(){return!e.isConversationItemPart||Object(Tt.b)({conversationReadingPaneState:t.store.conversationReadingPaneViewState})==e}},Nt=function(e,t){return function(){var n=e.isConversationItemPart&&t.ConversationId?t.ConversationId.Id:null;return!!Object(Q.d)(n)}},Dt=Object(H.select)({store:function(){return Ot.a}})(function(e,t,n){return{getItem:Rt(e),getItemId:Re(e),addNotificationMessage:Et(t),removeNotificationMessage:Mt(t),getNotificationMessageIds:Pt(t),mode:ue.a.MessageRead,displayMessageForm:ce,displayNewMessageForm:ct.a,displayNewAppointmentForm:st,displayReplyForm:dt,displayAppointmentForm:te,isAddinPinned:ze,isItemSelected:wt(t,n),isInlineComposeOpen:Nt(t,e),isSharedItem:Xe(e),isRemoteItem:Qe,getSharedProperties:It(e),getRecurrence:(a=e,function(){return r.__awaiter(void 0,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return a.AssociatedCalendarItemId?a.Recurrence?[2,a.Recurrence]:[3,1]:[2,null];case 1:return[4,_t(a.AssociatedCalendarItemId)];case 2:return(e=n.sent())?e.Recurrence?[2,e.Recurrence]:e.SeriesMasterItemId?[4,_t(e.SeriesMasterItemId)]:[3,4]:[2,null];case 3:return(t=n.sent())?[2,t.Recurrence]:[2,null];case 4:return[2,null]}})})}),getSeriesId:St(e),getInternetHeaders:Pe(e),getAttachmentContent:kt(t),addCategoriesMailbox:tt,removeCategoriesMailbox:nt};var a});n.d(t,"hasInlineImage",function(){return I}),n.d(t,"createMailComposeAdapter",function(){return rt}),n.d(t,"createMailReadAdapter",function(){return Dt})},697:function(e,t,n){"use strict";var r;!function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem"}(r||(r={}));var a={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function i(e){switch(e?e.toLowerCase():null){case a.ONE_DRIVE_PRO.toLowerCase():return 0;case a.GDRIVE.toLowerCase():return 5;case a.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case a.DROPBOX.toLowerCase():return 2;case a.BOX.toLowerCase():return 3;case a.WOPI_BOX.toLowerCase():return 7;case a.WOPI_EGNYTE.toLowerCase():return 8;case a.MAILBOX.toLowerCase():return 4;case a.FACEBOOK.toLowerCase():return 6;default:return null}}function o(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function s(e){return null==e?null:{fileType:r.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function c(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n],i={fileType:r.Local,name:a.name,size:a.size,type:a.type,fileObject:a};t.push(i)}return t}function l(e,t){var n=[],a={fileType:r.MailItem,name:e,size:0,mimeContent:t};return n.push(a),n}var u=n(11);function d(e,t){if(e.length!=t.length)return u.c.error("The sizes of subjects and latestItemIds are different"),null;for(var n=[],a=0;a<e.length;a++){var i={fileType:r.MailItem,name:e[a],size:0,itemId:t[a]};n.push(i)}return n}var p=n(868);function f(e){return e.map(function(e){return{fileType:r.Uri,name:e.name,type:Object(p.a)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"g",function(){return d}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"h",function(){return f}),n.d(t,"f",function(){return l}),n.d(t,"a",function(){return r})},700:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(736);function a(){return Object(r.b)().mailTips}},703:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return o});var r="onCloseInlineCompose",a="UpdateInternetMessageId",i="closeCompose",o="openCompose"},704:function(e,t,n){"use strict";var r=n(268);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}n(45),n(548);n(1229),n(1316);n.d(t,"a",function(){return a})},706:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1281),a=n(1260);function i(e){var t=Object(r.a)(e);return t&&t.fromViewState&&t.fromViewState.from&&t.fromViewState.from.email?t.fromViewState.from.email.EmailAddress:Object(a.a)().email.EmailAddress}},709:function(e,t,n){"use strict";var r=n(1267),a=n(223),i=n(1650),o=n(1651),s=n.n(o),c=n(47),l=n(278),u=n(4),d=n(20),p=n(386),f=n(1580),m=n(11),g=Object(u.action)("triggerPolicyTips")(function(e,t,n,a,i){var o=e.policyTipsViewState;if(!o.handlerDisabled&&!e.IRMData){var c,u=o.inProgressPolicyMatch,d=o.succeededPolicyMatch,f=o.pendingPolicyMatch;if(n||(n=y(e.subject)),a||(a=y(e.content)),i||(i=Object(r.a)(e)),o.isRequestInProgress)o.pendingRequests=!0,f.itemId=e.itemId,f.subjectChecksum=n,f.contentChecksum=a,f.eventTrigger=t,f.attachmentIds=i;else{if(o.pendingRequests=!1,u.itemId=e.itemId,u.subjectChecksum=n,u.contentChecksum=a,u.eventTrigger=t,u.attachmentIds=i,0==(c=u).subjectChecksum&&0==c.contentChecksum&&0==c.attachmentIds.length)return d.policyMatchDetails=[],d.subjectChecksum=0,d.contentChecksum=0,d.attachmentIds=[],void Object(l.a)(e,"dlpPolicyTips");(b(u,d)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(var n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(u,d)||1==t)&&function(e){var t=e.policyTipsViewState,n=t.succeededPolicyMatch,r=t.inProgressPolicyMatch,a=e.itemId;if(a&&a.Id){var i={ItemId:a,ClientSupportsScanResultData:!0,ScanResultData:n.scanResultData,ScanResultMetadata:n.scanResultMetaData,BodyOrSubjectChanged:b(r,n),NeedToReclassify:!n.itemId,CustomizedStringsNeeded:!0,Recipients:Object(p.a)(e),EventTrigger:r.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,s()(i).then(function(t){!function(e,t,n,r){var a=t.policyTipsViewState,i=a.pendingPolicyMatch;a.isRequestInProgress=!1,a.pendingRequests&&i&&g(t,i.eventTrigger,i.subjectChecksum,i.contentChecksum,i.attachmentIds);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,h,v)})}}(e)}}});function h(e,t){var n,r=e.policyTipsViewState,o=r.succeededPolicyMatch,s=r.inProgressPolicyMatch;o.itemId=s.itemId,o.attachmentIds=s.attachmentIds,o.subjectChecksum=s.subjectChecksum,o.contentChecksum=s.contentChecksum,o.policyMatchDetails=t.Matches,t.ScanResultData&&(o.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(o.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(r.handlerDisabled=!0),function(e,t){if(t){var n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString};Object(i.a)(n,r,function(e,t){return t||e})}}(e,t.CustomizedStrings),n=e,Object(l.a)(n,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(f.a)(n.policyTipsViewState.succeededPolicyMatch)&&(Object(c.a)()?Object(a.a)(n,"consumerDlpPolicyTips"):Object(a.a)(n,"enterpriseDlpPolicyTips"))}function v(e,t){var n=e.policyTipsViewState;t?(m.c.warn(Object(d.format)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(m.c.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(m.c.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(l.a)(e,"dlpPolicyTips")}function y(e){var t=0;if(e)for(var n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function b(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}t.a=g},710:function(e,t,n){"use strict";var r=n(1260),a=n(47);var i=n(845),o=n(853),s=n(7);function c(e,t,n,c){var l=!!t,u=(Object(o.a)()||null!=e)&&!l,d=null;if(!e){var p=Object(i.c)(n);p&&(d={MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:p,Name:Object(s.a)().SessionSettings.UserDisplayName})}return function(e,t,n,i){return{from:e||n||i?Object(r.a)(t):null,isFromShown:e,isFromContextMenuShown:!1,sendAsEmailAddresses:[],loadAliasActionStatus:Object(a.a)()?0:2,isFromReadOnly:n,isFromEditing:!1,isFromValid:!0,fromWellFindControlViewState:null}}(u,e||d,l,c)}n.d(t,"a",function(){return c})},713:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r="<div id=appendonsend></div>";function a(e){var t="";return"HTML"==e&&(t+=r),t}},714:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(7);function a(e,t){return e==t||e&&t&&e.toLowerCase()==t.toLowerCase()}function i(e){return e&&a(e.EmailAddress,Object(r.a)().SessionSettings.UserEmailAddress)}},724:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function a(e){return r.test(e)}},730:function(e,t,n){"use strict";var r=n(5);t.a=function(e){if(e){var t=e.shouldEncryptMessageAsSmime,n=e.shouldSignMessageAsSmime;return Object(r.d)("cmp-smime")&&(t||n)}return!1}},735:function(e,t,n){"use strict";var r=n(0);t.a=function(e){return e&&0!==e.length?e.filter(function(e){return!!e}).reduce(function(e,t){return r.__spread(e,(n=t)&&n.recipients?n.recipients.slice():[]);var n},[]):[]}},736:function(e,t,n){"use strict";var r,a=n(1),i=n(840),o=n(846),s=n(0),c=n(31),l=n(1615),u=n.n(l),d=n(1616),p=n.n(d);function f(e,t){return u()({Header:Object(c.getJsonRequestHeader)(),Body:p()({MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:t.map(function(e){return{EmailAddress:e}})})}).then(function(e){return e&&e.Body&&"Success"==e.Body.ResponseClass?e.Body:null}).catch(function(e){return Promise.resolve(null)})}!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var m=r,g=n(747),h=/<!--((.|\n)*?)-->/gi,v=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t};var y=function(e){return e.childNodes?S(v(e.childNodes).filter(function(e){return"ReplyBody"===e.localName})[0]):""},b=function(e){return e.replace(h,"")},_=function(e){var t=e.split(" "),n=g.a.None;return t.map(function(e){n|=g.a[e]}),n};function S(e){if(e){var t=b(e.textContent).replace(/<\/a>/gi,"</a> "),n=(new DOMParser).parseFromString(t,"text/html");if(n&&n.childNodes&&n.childNodes.length&&n.childNodes[0].textContent)return n.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}var C=n(700),A=Object(a.mutatorAction)("addMailTipsToCache",function(e,t){if(e&&e.length>0&&t){var n=Object(C.a)();e.map(function(e){n.add(t,new i.a(e,t,e.RecipientAddress))})}}),I=n(1249),O=n(1328),T=n(12);Object(a.orchestrator)(I.a,function(e){return s.__awaiter(void 0,void 0,void 0,function(){var t,n,r,a,i,o,c;return s.__generator(this,function(s){switch(s.label){case 0:return t=e.composeId,n=e.fromEmailAddress,r=e.recipients,n&&r&&r.length?(a=Object(C.a)(),(i=r.filter(function(e){return e&&!a.containsValueForKey(n,e)})).length?[4,f(n,i)]:[3,2]):[3,4];case 1:return(o=s.sent())&&(c=o.ResponseMessages.map(function(e){return function(e){if(!e)return null;var t=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return v(t).reduce(function(e,t){switch(t.localName){case m.RecipientAddress:t.childNodes.length>1&&(e.RecipientAddress=t.childNodes[1].textContent);break;case m.MailboxFull:e.MailboxFull="true"===t.textContent;break;case m.IsModerated:e.IsModerated="true"===t.textContent;break;case m.TotalMemberCount:e.TotalMemberCount=parseInt(t.textContent)||0;break;case m.ExternalMemberCount:e.ExternalMemberCount=parseInt(t.textContent)||0;break;case m.MaxMessageSize:e.MaxMessageSize=parseInt(t.textContent)||0;break;case m.DeliveryRestricted:e.DeliveryRestricted="true"===t.textContent;break;case m.PreferAccessibleContent:e.PreferAccessibleContent="true"===t.textContent;break;case m.OutOfOffice:e.OutOfOffice=y(t);break;case m.CustomMailTip:e.CustomMailTip=S(t);break;case m.GuestMailTipStatus:e.GuestStatus=_(t.textContent)}return e},{})}(e.MessageText)}).filter(function(e){return!!e}))&&c.length>0&&(A(c,n),Object(O.a)(t,n)),[3,3];case 2:Object(O.a)(t,n),s.label=3;case 3:r.map(function(e){var t=!1;-1==i.indexOf(e)&&(t=!0),Object(T.k)("UpdateMailtipsDatapoint",[t])}),s.label=4;case 4:return[2]}})})});n.d(t,"b",function(){return E});var x={mailTips:new o.b(i.a.compareEntryCacheTime)},E=Object(a.createStore)("mailTipsCacheStore",x),M=E();t.a=M},738:function(e,t,n){"use strict";var r=n(0),a=n(401),i=n(1269);function o(e,t,n,r){return{selectionStart:-1,selectionEnd:-1,inputId:"subjectLine"+e}}var s=n(1620),c=n(710),l=n(854),u=n(224),d=n(1621),p=n(7);function f(){return Object(p.a)().UserOptions.AlwaysShowBcc}var m=n(1287),g=n(1280),h=n(1273),v=100;function y(e,t){return{isBottomDocking:!1,bottomDockingHeight:Object(h.a)(e,t),minBodyHeight:v,scrollLeft:0,scrollBarHeight:0,dockingWidth:0,bottomDockingBottom:0,useStickyDocking:_()}}var b=null;function _(){return b||(b={value:S("position","sticky")&&"function"==typeof IntersectionObserver}),b.value}function S(e,t){var n=document.createElement("div");return n.style[e]=t,n.style[e]===t}var C=n(1278),A=n(223),I=n(9),O=n(189),T=n(1587),x=n(63),E=n(1609),M=n(122),P=n(836);var k=n(1571);var R=n(1245),w=n(1601);function N(e){var t={queryString:"",wordBeforeCursor:"",isSuggesting:!1,isPopupShown:!1,findResultSet:[],selectedRecipientIndex:0,isSearching:!1,hasSearchedDirectory:!1,atMentionTuples:{},mentionsAddedRecipients:[]};return e&&e.length>0&&e.forEach(function(e){var n=JSON.parse(e);if(n&&n.a&&n.b){var r=JSON.parse(n.a);r&&("MentionAddedRecipients"==n.b&&r instanceof Array?t.mentionsAddedRecipients=r:r.Mentioned&&(t.atMentionTuples[n.b]={EmailAddress:r.Mentioned}))}}),t}var D=n(1263),F=n(1577),L=n(1262),U=n(857),B=n(1594),j=n(15),H=n.n(j);var V=n(839),W=n(47),G=n(848),z=n(4);n.d(t,"c",function(){return X}),n.d(t,"a",function(){return K}),n.d(t,"b",function(){return Q});var q=0;function X(){return(q++).toString()}function K(e){var t=e.operation,n=e.bodyType,r=e.itemId,u=e.subject,p=e.newContent,g=e.quotedBody,h=e.to,v=e.cc,b=e.bcc,_=e.referenceItemId,S=e.referenceItemDocumentId,C=e.conversationId,A=e.importance,O=e.alternateSignature,x=e.preferAsyncSend,P=e.from,U=e.pendingSocialActivityTags,j=e.IRMData,z=e.useSmartResponse,q=e.logTraceId,K=e.isPopout,Q=e.explicitTextDirection,Z=e.isReadReceiptRequested,$=e.isDeliveryReceiptRequested,ee=e.meetingRequestItem,te=e.sensitivity,ne=e.smimeViewState,re=void 0===e.isInlineCompose?!!C:e.isInlineCompose,ae=v&&v.length>0||(Object(W.a)()?f():!re),ie=b&&b.length>0||f(),oe="HTML"==n,se=g||"",ce=e.appendOnSend?e.appendOnSend:[],le=Object(m.a)(t)?Object(l.a)(n):O;le&&(se=Object(i.a)(n,le,!0)+Object(a.a)(se,n)),se=(Object(a.a)(p,n)||"")+Object(a.a)(se,n);var ue,de=Object(E.a)(),pe=Object(V.a)(de,h),fe=X(),me=Object(c.a)(P,ee,_),ge=I.observable.object({content:se,isDirty:!1,operation:t,itemId:r,bodyType:n,subject:u||"",attachmentWell:Object(T.a)(!1,!0,fe),referenceItemId:_,referenceItemDocumentId:S,importance:A||"Normal",fromViewState:me,subjectViewState:o(fe),subjectPickerViewState:(ue={supportsSubjectPicker:0===t&&!u&&!p},{supportsSubjectPicker:ue.supportsSubjectPicker,isPickerOpened:ue.isPickerOpened,isLoadingConversation:ue.isLoadingConversation,showBackButton:ue.showBackButton,isBackButtonHovered:ue.isBackButtonHovered,initialToRecipient:ue.initialToRecipient,nextFocusControl:ue.nextFocusControl,initialContent:ue.initialContent}),IRMData:j,policyTipsViewState:{inProgressPolicyMatch:{itemId:null,scanResultData:null,scanResultMetaData:null,subjectChecksum:0,contentChecksum:0,eventTrigger:null,policyMatchDetails:[],attachmentIds:[]},succeededPolicyMatch:{itemId:null,scanResultData:null,scanResultMetaData:null,subjectChecksum:0,contentChecksum:0,eventTrigger:null,policyMatchDetails:[],attachmentIds:[]},pendingPolicyMatch:{itemId:null,scanResultData:null,scanResultMetaData:null,subjectChecksum:0,contentChecksum:0,eventTrigger:null,policyMatchDetails:[],attachmentIds:[]},isRequestInProgress:!1,pendingRequests:!1,handlerDisabled:!1,isOverridden:!1,overrideJustification:null,isReportedFalsePositive:!1,complianceUrl:"",blockString:H.a.policyTipsBlockDefault,notifyString:H.a.policyTipsNotifyDefault,overrideString:H.a.policyTipsBlockDefault},meetingRequestItem:ee,internetHeaders:new I.ObservableMap,keysOfInternetHeadersToBeRemoved:[],appendOnSend:ce,findPeopleFeedbackManager:de,toRecipientWell:pe,ccRecipientWell:ae?Object(V.a)(de,v):null,bccRecipientWell:ie?Object(V.a)(de,b):null,isInlineCompose:re,conversationId:C,lastSaveTimeStamp:null,isRibbonShown:oe,isSending:!1,isSavingSpinnerShown:!1,infoBarIds:[],showCompactRecipientWell:re&&!me.isFromShown,dropViewState:Object(M.a)(),isFocusWorkaroundDivShown:!0,showSendDiscardAsIcon:!1,lastFocusedControl:null,isPopout:K,sendDisabled:!1,smimeViewState:ne||Object(G.b)(),quotedBody:null,useSmartResponse:re||z,upgradeTimer:null,numberOfWaitingAttachments:0,emoji:{wordBeforeCursor:"",emojis:Object(R.b)(w.a-1),isSuggesting:!1,isPopupShown:!1,isShortcut:!1,selectedEmojiIndex:0,showMore:!0},emojiPicker:{emojiResults:Object(k.a)(),queryString:"",wordBeforeCursor:"",isSuggesting:!1,isPopupShown:!1,selectedEmojiIndex:0},docking:y(oe,re),ribbon:Object(F.a)(),atMentions:N(U),pasteOption:Object(D.c)(),tableEdit:Object(L.c)(),accChecker:{isOpen:!1,errors:[]},isReadReceiptRequested:"boolean"==typeof Z&&Z,isDeliveryReceiptRequested:"boolean"==typeof $&&$,preferAsyncSend:!1,asyncSendState:0,composeId:fe,logTraceId:q,explicitTextDirection:Q||null,sensitivity:te,preferredEditors:Object(B.c)(),isDarkMode:Object(d.a)(),selectedCLPLabel:Object(s.a)()});return 1==x&&Y(ge),J(ge),ge}var J=function(e){Object(C.a)(e),e.selectedCLPLabel&&Object(A.a)(e,"CLPLabel")};function Q(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,a;return r.__generator(this,function(r){switch(r.label){case 0:return t=K(e),n=t,[4,O.i.import()];case 1:return n.attachmentWell=r.sent()(t.composeId,{attachments:e.attachments,mailboxInfo:Object(x.c)(),parentItemId:e.itemId,infoBarAddHandler:Object(u.a)(t),infoBarRemoveHandler:Object(u.c)(t)}),[4,P.c.import()];case 2:return a=r.sent()(!0),Object(g.a)(t,a),[2,t]}})})}var Y=Object(z.action)("enableAsyncSend")(function(e){U.i.import().then(function(){e.preferAsyncSend=!0})})},747:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},825:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(727);function a(e){return Object(r.a)().attachments.get(e.Id)}},826:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i}),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity"}(a||(a={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange"}(i||(i={}))},828:function(e,t,n){"use strict";var r=n(0);var a=n(1537),i=n.n(a),o=n(7),s=n(12),c=n(63),l=n(5),u=n(20),d=n(11);n.d(t,"a",function(){return m}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return h});var p=function(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,s){a?s(new Error("The function retry was cancelled")):(r++,e().then(o).catch(function(e){t&&r>=t?s(e):setTimeout(function(){return i(o,s)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n,a){var o=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.mailboxAddress=n,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return r.__awaiter(o,void 0,void 0,function(){function e(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.c.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,a,o,c=this;return r.__generator(this,function(i){switch(i.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=p(function(){return r.__awaiter(c,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,a=new s.b("AttachmentRefreshDownloadToken"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n()];case 2:return i.sent(),a.addCustomData([t]),a.end(),[3,4];case 3:return o=i.sent(),d.c.warn("Retry to refresh token failed: "+o),a.addCustomData([t]),a.endWithError("ServerError",o),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(u.isStringNullOrWhiteSpace)(this.downloadUrlBase)&&!Object(u.isStringNullOrWhiteSpace)(this.mailboxAddress)&&Object(l.d)("doc-attachment-downloadDomain"),this.downloadToken=a,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(o.a)(),n=Object(c.c)().mailboxId,r=t.ApplicationSettings;e.instance=new e(r.DownloadTokenRefreshMinutes,r.DownloadUrlBase,n,r.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function m(){return f.getInstance().getDownloadToken()}function g(){return f.getInstance().getUseDownloadUrlBase()}function h(){return f.getInstance().getDownloadUrlBase()}},829:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var r=n(1),a=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",function(e,t){return{linkId:e,sharingDialogResponse:t}}),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",function(e,t){return{linkId:e,newPermission:t}}),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",function(e,t,n,r){return{linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r}}),s=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",function(e,t){return{linkId:e,actionStatus:t}}),c=Object(r.action)("CREATE_SHARING_LINK",function(e,t,n,r){return{linkId:e,currentUrl:t,canonicalUrl:n,newPermissionLevel:r}})},830:function(e,t,n){"use strict";var r=n(1528);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var a=n(828);n.d(t,"c",function(){return a.a})},833:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(7),a=n(47),i=n(5);function o(){return Object(a.a)()?Object(i.d)("cmp-encryption")&&Object(r.a)().SessionSettings.IsPremiumConsumerMailbox:Object(i.d)("cmp-manageIRM")&&Object(r.a)().SegmentationSettings.Irm}},836:function(e,t,n){"use strict";n.d(t,"b",function(){return ReactEditor}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s});var r=n(2),a=new r.c(function(){return Promise.all([n.e(5),n.e(9),n.e(14),n.e(19),n.e(139)]).then(n.bind(null,1876))}),ReactEditor=Object(r.d)(a,function(e){return e.ReactEditor}),i=Object(r.d)(a,function(e){return e.BareContentEditableDivEditor}),o=new r.b(a,function(e){return e.createUndo}),s=new r.b(a,function(e){return e.setTableHeaderRow})},839:function(e,t,n){"use strict";var r=n(0),a=n(724);function i(e){return Object(a.a)(e.EmailAddress)||e.ItemId&&"PrivateDL"==e.MailboxType}var o=n(122),s=n(1517);function c(e,t){var n,a,c={queryString:"",recipients:[],isDirty:!1,shouldShowFindResult:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:s.a.None,findResultHightlightIndex:-1,isSearching:!1,hasSearchedDirectory:!1,dropViewState:Object(o.a)(),findPeopleFeedbackManager:e};if(t)try{for(var l=r.__values(t),u=l.next();!u.done;u=l.next()){var d=u.value,p={displayText:d.Name,persona:{EmailAddress:d,PersonaId:d.ItemId},isContextMenuOpen:!1,isValid:i(d),isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1};c.recipients.push(p)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return c}n.d(t,"a",function(){return c})},840:function(e,t,n){"use strict";var r=n(0),a=function(e){function t(t,n,r){var a=e.call(this,n,r)||this;return a.value=t,a}return r.__extends(t,e),t}(n(846).a);t.a=a},845:function(e,t,n){"use strict";n.d(t,"c",function(){return l}),n.d(t,"a",function(){return p}),n.d(t,"b",function(){return f});var r=n(0),a=n(714),i=n(13),o=n(7),s=n(47);function c(e){var t=Object(o.a)().SessionSettings,n=[],r=t.UserProxyAddresses;return t.NotManagedEmailAddresses&&(r=r.concat(t.NotManagedEmailAddresses)),r&&r.length>0&&r.forEach(function(t){e==t||m(t)||n.push(t)}),n}function l(e){var t,n=Object(i.q)(),r=n&&n.items;if(r&&e&&r.has(e.Id)&&(t=r.get(e.Id)),t){var a=function(e,t){for(var n=0;n<t.length;n++)if(g(t[n],e.ToRecipients)||g(t[n],e.CcRecipients))return t[n];return null}(t,f());if(a&&a!==u())return a}return null}function u(){var e=Object(o.a)(),t=Object(s.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault;return t||d()}function d(){return Object(o.a)().SessionSettings.UserEmailAddress}function p(e){var t=l(e);return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||function(){var e=u(),t=d();if(t==e&&m(e)){var n=c(t);if(n&&n.length>0)return n[0]}return e}(),Name:Object(o.a)().SessionSettings.UserDisplayName}}function f(){var e,t,n=[],r=d();return m(r)||n.push(r),Object(s.a)()&&(n=n.concat(c(r))),e=n,(t=Object(o.a)().SessionSettings.ConnectedAccountInfos)&&t.length>0&&t.forEach(function(t){-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)}),n=e}function m(e){var t=!1;if(Object(s.a)()){var n=Object(o.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}function g(e,t){var n,i;if(t&&t.length>0)try{for(var o=r.__values(t),s=o.next();!s.done;s=o.next()){var c=s.value;if(Object(a.a)(e,c.EmailAddress))return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1}},846:function(e,t,n){"use strict";var r=n(0),a=n(9),i=n(771),o=300,s=function(){function e(e,t){this.parentCacheKey=e,this.childMruCacheKey=t,this.cacheTime=Date.now()}return e.isExpired=function(e){return Date.now()-e.cacheTime>=72e5},e.compareEntryCacheTime=function(e,t){return e.cacheTime-t.cacheTime},e}(),c=n(4),l=function(){function e(e,t,n){void 0===t&&(t=o),void 0===n&&(n=Date.now()),this.comparer=e,this.cacheLimit=t,this.lastExpiredEntryClearedTime=n,this.cache=new a.ObservableMap}return e.prototype.initialize=function(e){this.cache=e.cache},e.prototype.add=function(e,t){var n=this;Object(c.action)("NestedMruCache_add")(function(){n.clearOldEntriesIfNeeded();var r=null;n.cache.has(e)?r=n.cache.get(e):((r=new i.a(n.cacheLimit)).initialize(new a.ObservableMap),n.cache.set(e,r)),r.add(t.childMruCacheKey,t)})()},e.prototype.containsValueForKey=function(e,t){if(!this.cache.has(e))return!1;var n=this.cache.get(e).get(t);return!(!n||s.isExpired(n))},e.prototype.get=function(e,t){var n=null;return this.containsValueForKey(e,t)&&(n=this.cache.get(e).get(t)),n},e.prototype.clearUpExpiredEntries=function(){var e,t;if(!(Date.now()-this.lastExpiredEntryClearedTime<12e5)){var n=function(e){e.getItemIds().forEach(function(t){s.isExpired(e.get(t))&&e.remove(t)})};try{for(var a=r.__values(this.cache.values()),i=a.next();!i.done;i=a.next()){n(i.value)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}this.lastExpiredEntryClearedTime=Date.now()}},e.prototype.remove=function(e){var t=this;Object(c.action)("NestedMruCache_remove")(function(){if(t.cache.has(e)){var n=t.cache.get(e);n.getItemIds().map(function(e){n.remove(e)})}})()},e.prototype.clear=function(){var e=this;Object(c.action)("NestedMruCache_clear")(function(){var t,n,a=e.cache.keys();try{for(var i=r.__values(a),o=i.next();!o.done;o=i.next()){var s=o.value;e.remove(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}})()},e.prototype.countTotalNumberOfEntries=function(){var e,t,n=0;if(this.cache)try{for(var a=r.__values(this.cache.values()),i=a.next();!i.done;i=a.next()){n+=i.value.getItemIds().length}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n},e.prototype.returnAllMailTipsCacheEntries=function(){var e,t,n=[];if(this.cache){var a=function(e){e&&e.getItemIds().map(function(t){var r=e.get(t);n.push(r)})};try{for(var i=r.__values(this.cache.values()),o=i.next();!o.done;o=i.next()){a(o.value)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}}return n},e.prototype.clearOldEntriesIfNeeded=function(){var e,t;if(this.countTotalNumberOfEntries()>=o&&this.clearUpExpiredEntries(),this.countTotalNumberOfEntries()>=o){var n=[],a=function(e){e.getItemIds().forEach(function(t){n.push(e.get(t))})};try{for(var i=r.__values(this.cache.values()),s=i.next();!s.done;s=i.next()){a(s.value)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}n.sort(this.comparer);for(var c=0;c<50;c++){var l=n[c].parentCacheKey,u=n[c].childMruCacheKey;this.cache.get(l).remove(u)}}},e}();n.d(t,"b",function(){return l}),n.d(t,"a",function(){return s})},847:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(13);function a(e){var t="";if(e){var n=r.A.items.get(e.referenceItemId&&e.referenceItemId.Id);n&&n.SmartReplyData&&n.SmartReplyData.ExtractionID&&(t=n.SmartReplyData.ExtractionID)}return t}},848:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),{shouldEncryptMessageAsSmime:e,shouldSignMessageAsSmime:t}};function a(e){switch(e){case 6:return r(!0,!1);case 10:case 11:return r(!1,!0);case 12:case 13:case 14:return r(!0,!0);case-1:case 0:default:return r()}}},853:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(7),a=n(29);function i(){var e=Object(r.a)().UserOptions,t=Object(r.a)().SessionSettings;return e.AlwaysShowFrom||Object(a.m)()&&(t.ConnectedAccountInfos.length>0||t.NotManagedEmailAddresses&&t.NotManagedEmailAddresses.length>0||t.UserProxyAddresses.length>1)}},854:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(7);function a(e){var t=Object(r.a)().UserOptions;return"HTML"==e?t.SignatureHtml:t.SignatureText}},868:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function a(e){var t=r(e);return t?t.replace(".",""):null}var i=n(8),o=n.n(i),s=n(20);function c(e){var t;return e>=1073741824?(e/=1073741824,t=o.a.sizeWithGigabyteAbbreviationText):e>=1048576?(e/=1048576,t=o.a.sizeWithMegabyteAbbreviationText):e>=1024?(e/=1024,t=o.a.sizeWithKilobyteAbbreviationText):t=o.a.sizeWithByteAbbreviationText,Object(s.format)(t,Math.round(e))}var l=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];function u(e){var t=r(e);return!!t&&l.indexOf(t.toLowerCase())>=0}var d=n(5),p=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function f(e){if(!Object(d.d)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&p.indexOf(t.toLowerCase())>=0}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return f})},943:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(167),a=n.n(r);function i(e){return e?a()({Id:e.Id,ChangeKey:e.ChangeKey}):null}},944:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var r=n(1582),a=n.n(r),i=n(1593),o=n.n(i),s=n(187),c=n.n(s),l=n(33),u=n.n(l),d=n(250),p=n(31),f=n(65),m=n.n(f),g=n(170),h=n.n(g),v=n(390),y=n(7),b=n(5);function _(e,t,n,r,i,s,l,f,g){var _,S=function(e,t,n,r,a,i,s,l,p){var f="PostItem:#Exchange"==e.__type?"newPost":"newMail",g=s?h()({BaseFolderId:m()({Id:s})}):null,v=o()({ClientSupportsIrm:!0,ComposeOperation:f,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",OutboundCharset:"AutoDetect",Items:[e],TimeFormat:r,SendOnNotFoundError:!0,RemoteExecute:l,ItemShape:c()({BaseShape:"IdOnly",AdditionalProperties:[u()({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:g,SuppressMarkAsReadOnReplyOrForward:Object(b.d)("tri-suppressMarkReadBehaviorOnRF")&&p});return i&&i.IsOwner&&(v.ComplianceId=i.RmsTemplateId?i.RmsTemplateId.toUpperCase():"0"),n?a&&(v.ItemShape.ReturnOnlyInternetMessageId=!0):(v.ItemShape=Object(d.b)(t),v.ShapeName="MailCompose"),v}(e,t,n,r,i,s,l,f,g);if("PostItem:#Exchange"==e.__type){var C=v.b.folderTable.get(l);_=Object(v.a)(null!=C.ReplicaList?C.ReplicaList[0]:Object(y.a)().SessionSettings.DefaultPublicFolderMailbox)}return a()({Header:Object(p.getJsonRequestHeader)(),Body:S},_).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}},975:function(e,t,n){"use strict";var r;!function(e){e.LTR="ltr",e.RTL="rtl"}(r||(r={})),t.a=r}},0,[5,6,9,11,217,14,19,139,2,3,8,66,0,1,4,162,176,10,17,193,7,23,62,16,96,279,51,280,57,283,80,289,109,107,72,100,155,182,236]]);
//# sourceMappingURL=owa.Addins.mail.js.map
window.scriptsLoaded['owa.Addins.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.Addins.mail.js'] = (new Date()).getTime();