window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.vendors~CortanaCompose~EmojiPickerPlugin~HtmlEditor~MeetingMessage.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[19],{1931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4122);t.NodeBlockElement=o.default;var r=n(2990);t.getBlockElementAtNode=r.default;var i=n(4490);t.getFirstLastBlockElement=i.default;var a=n(4488);t.StartEndBlockElement=a.default;var s=n(4491);t.ContentTraverser=s.default;var l=n(5507);t.PositionContentSearcher=l.default;var u=n(3140);t.getInlineElementAtNode=u.default;var c=n(4492);t.ImageInlineElement=c.default;var d=n(4493);t.LinkInlineElement=d.default;var f=n(3637);t.NodeInlineElement=f.default;var p=n(3639);t.PartialInlineElement=p.default;var h=n(4125);t.applyTextStyle=h.default;var g=n(4497);t.Browser=g.default,t.getBrowserInfo=g.getBrowserInfo;var v=n(5508);t.applyFormat=v.default;var m=n(4498);t.changeElementTag=m.default;var y=n(4123);t.collapseNodes=y.default;var E=n(2593);t.contains=E.default;var C=n(5509);t.extractClipboardEvent=C.default;var S=n(3638);t.findClosestElementAncestor=S.default;var b=n(4489);t.fromHtml=b.default;var N=n(4127);t.getComputedStyles=N.default,t.getComputedStyle=N.getComputedStyle;var O=n(2594);t.getTagOfNode=O.default;var P=n(4124);t.isBlockElement=P.default;var T=n(4499);t.isNodeEmpty=T.default;var _=n(4128);t.isVoidHtmlElement=_.default;var M=n(5510);t.matchLink=M.default;var A=n(5511);t.adjustNodeInsertPosition=A.default;var w=n(5512);t.queryElements=w.default;var D=n(3635);t.splitParentNode=D.default,t.splitBalancedNodeRange=D.splitBalancedNodeRange;var R=n(4501);t.unwrap=R.default;var k=n(3636);t.wrap=k.default;var x=n(3141);t.getNextLeafSibling=x.getNextLeafSibling,t.getPreviousLeafSibling=x.getPreviousLeafSibling;var B=n(4495);t.getFirstLeafNode=B.getFirstLeafNode,t.getLastLeafNode=B.getLastLeafNode;var I=n(4502);t.VTable=I.default;var L=n(2680);t.Position=L.default;var F=n(3640);t.createRange=F.default,t.getRangeFromSelectionPath=F.getRangeFromSelectionPath;var j=n(5513);t.getPositionRect=j.default;var U=n(4500);t.isPositionAtBeginningOf=U.default;var z=n(5514);t.getSelectionPath=z.default},1965:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5544);t.changeFontSize=o.default,t.FONT_SIZES=o.FONT_SIZES;var r=n(5545);t.clearBlockFormat=r.default,t.TAGS_TO_UNWRAP=r.TAGS_TO_UNWRAP,t.TAGS_TO_STOP_UNWRAP=r.TAGS_TO_STOP_UNWRAP,t.ATTRIBUTES_TO_PRESERVE=r.ATTRIBUTES_TO_PRESERVE;var i=n(5546);t.clearFormat=i.default;var a=n(5547);t.createLink=a.default;var s=n(5548);t.getFormatState=s.default,t.getPendableFormatState=s.getPendableFormatState,t.getElementBasedFormatState=s.getElementBasedFormatState,t.getStyleBasedFormatState=s.getStyleBasedFormatState;var l=n(5549);t.insertImage=l.default;var u=n(5550);t.insertTable=u.default;var c=n(5551);t.editTable=c.default;var d=n(5552);t.formatTable=d.default;var f=n(5553);t.removeLink=f.default;var p=n(5554);t.replaceWithNode=p.default;var h=n(5555);t.setAlignment=h.default;var g=n(4513);t.setBackgroundColor=g.default;var v=n(4516);t.setTextColor=v.default;var m=n(5556);t.setDirection=m.default;var y=n(4514);t.setFontName=y.default;var E=n(4515);t.setFontSize=E.default;var C=n(5557);t.setImageAltText=C.default;var S=n(5558);t.setIndentation=S.default;var b=n(4517);t.toggleBold=b.default;var N=n(5559);t.toggleBullet=N.default;var O=n(4518);t.toggleItalic=O.default;var P=n(5560);t.toggleNumbering=P.default;var T=n(5561);t.toggleBlockQuote=T.default;var _=n(5562);t.toggleCodeBlock=_.default;var M=n(5563);t.toggleStrikethrough=M.default;var A=n(5564);t.toggleSubscript=A.default;var w=n(5565);t.toggleSuperscript=w.default;var D=n(4519);t.toggleUnderline=D.default;var R=n(5566);t.toggleHeader=R.default},2079:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5515);t.Keys=o.Keys;var r=n(5516);t.Editor=r.default;var i=n(4511);t.Undo=i.default;var a=n(4504);t.EditPlugin=a.default;var s=n(4509);t.MouseUpPlugin=s.default;var l=n(4503);t.DOMEventPlugin=l.default;var u=n(4510);t.TypeInContainerPlugin=u.default;var c=n(4505);t.FirefoxTypeAfterLink=c.default;var d=n(4130);t.cacheGetEventData=d.default;var f=n(4507);t.clearEventDataCache=f.default;var p=n(4506);t.cacheGetContentSearcher=p.cacheGetContentSearcher,t.clearContentSearcherCache=p.clearContentSearcherCache;var h=n(5543);t.cacheGetElementAtCursor=h.default},2593:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(t instanceof Node||(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&e.contains(t)))}},2594:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}},2680:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3638),r=n(3427),i=function(){function e(e,t){switch(e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=a(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=a(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=s(this.node),this.isAtEnd=!0;break;default:var n=s(this.node);this.offset=Math.max(0,Math.min(t,n)),this.isAtEnd=t>0&&t>=n}this.element=o.default(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType&&t.firstChild;)t=0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n],n=this.isAtEnd?-1:0;return new e(t,n)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:r.default(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return new e(t.endContainer,t.endOffset)},e}();function a(e){for(var t=0;e=e.previousSibling;)t++;return t}function s(e){return 3==e.nodeType?e.nodeValue.length:1==e.nodeType?e.childNodes.length:1}t.default=i},2774:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},o=e.getSelectionRange();o&&o.collapsed?(e.addUndoSnapshot(),n()):e.addUndoSnapshot(n,"Format")}},2990:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4123),r=n(2593),i=n(2594),a=n(4124),s=n(4122),l=n(4488);function u(e,t,n){var o=e;if("BR"==i.default(o)&&n)return o;for(;o;){for(var r=e;!(r=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return o;for(;r;){if(a.default(r))return o;if("BR"==i.default(r))return n?r:o;e=r,r=n?e.firstChild:e.lastChild}o=e}return o}t.default=function(e,t){if(!r.default(e,t))return null;var n=l.default.getBlockContext(t);if(n==t)return new s.default(n);var i=u(t,n,!1),c=u(t,n,!0),d=o.default(e,i,c,!1);if(i=d[0],c=d[d.length-1],i.parentNode!=c.parentNode)return new l.default(e,i,c);for(;!i.previousSibling&&!c.nextSibling;){var f=i.parentNode;if(f==n){n!=e&&(i=c=f);break}i=c=f}return i==c&&a.default(i)?new s.default(i):new l.default(e,i,c)}},3140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2990),r=n(2594),i=n(4492),a=n(4493),s=n(3637);t.default=function(e,t){var n=e instanceof Node?o.default(e,t):e;return t&&n&&function(e,t){for(var n,o=[e],l=e.parentNode;l&&t.contains(l);l=l.parentNode)o.push(l);for(var u=o.length-1;u>=0&&!n;u--){var c=o[u],d=r.default(c);"A"==d?n=new a.default(c,t):"IMG"==d&&(n=new i.default(c,t))}return n||new s.default(e,t)}(t,n)}},3141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2593),r=n(4126);function i(e,t,n){var i=null,a=n?function(e){return e.nextSibling}:function(e){return e.previousSibling},s=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(o.default(e,t))for(var l=t,u=!0;u;){var c=l.parentNode;for(l=a(l);!l&&c!=e;)l=a(c),c=c.parentNode;for(;l&&s(l);)l=s(l);if(!(u=l&&r.default(l))){i=l;break}}return i}t.getLeafSibling=i,t.getNextLeafSibling=function(e,t){return i(e,t,!0)},t.getPreviousLeafSibling=function(e,t){return i(e,t,!1)}},3427:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},3428:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931),r="â€‹";t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var i=n.startContainer;"SPAN"!=o.getTagOfNode(i)||i.firstChild&&("BR"!=o.getTagOfNode(i.firstChild)||i.firstChild.nextSibling)?(i&&3==i.nodeType&&i.nodeValue==r&&"SPAN"==o.getTagOfNode(i.parentNode)||(e.addUndoSnapshot(),i=e.getDocument().createTextNode(r),n.insertNode(i)),o.applyTextStyle(i,t),e.select(i,-1)):(e.addUndoSnapshot(),t(i))}else e.addUndoSnapshot(function(){for(var n,o,r=e.getSelectionTraverser(),i=r&&r.currentInlineElement;i;){var a=r.getNextInlineElement();i.applyStyle(function(e){t(e),n=n||e,o=e}),i=a}n&&o&&e.select(n,-2,o,-3)},"Format")}},3635:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3427);function r(e,t){if(!e||!e.parentNode)return null;var n=e.parentNode,o=n.cloneNode(!1);if(o.removeAttribute("id"),t)for(;n.firstChild&&n.firstChild!=e;)o.appendChild(n.firstChild);else for(;e.nextSibling;)o.appendChild(e.nextSibling);return o.firstChild&&""!=o.innerHTML?n.parentNode.insertBefore(o,t?n:n.nextSibling):o=null,o}t.default=r,t.splitBalancedNodeRange=function(e){var t=e instanceof Array?e[0]:e,n=e instanceof Array?e[e.length-1]:e,i=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(i){if(o.default(t,n)){var a=n;n=t,t=a}r(t,!0),r(n,!1)}return i}},3636:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4489);t.default=function(e,t){if(0==(e=e?e instanceof Node?[e]:e:[]).length||!e[0])return null;if(!(t instanceof Element)){var n=e[0].ownerDocument;t=/^\w+$/.test(t=t||"div")?n.createElement(t):o.default(t,n)[0]}var r=e[0].parentNode;r&&r.insertBefore(t,e[0]);for(var i=0,a=e;i<a.length;i++){var s=a[i];t.appendChild(s)}return t}},3637:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4125),r=n(3427),i=n(2680),a=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return 3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new i.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new i.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&r.default(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){o.default(this.containerNode,e)},e}();t.default=a},3638:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2593);t.default=function(e,t,n){var r=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(r&&n)if(r.closest)r=r.closest(n);else for(;r&&r!=t&&!(r.matches||r.msMatchesSelector).call(r,n);)r=r.parentElement;return!t||o.default(t,r)?r:null}},3639:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4125),r=n(3640),i=n(2680),a=n(3141),s=function(){function e(e,t,n){this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return r.default(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end&&new e(this.inlineElement,this.end,null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start&&new e(this.inlineElement,null,this.start)},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),r=this.getContainerNode();if(t.isAtEnd){var s=a.getNextLeafSibling(r,t.node);t=s?new i.default(s,0):null}if(0==n.offset){var l=a.getPreviousLeafSibling(r,n.node);n=l?new i.default(l,-1):null}o.default(r,e,t,n)},e}();t.default=s},3640:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4128),r=n(2680);function i(e,t,n,o){var i,u;if(s(e)?(i=e,u=s(t)?t:null):e instanceof Node&&(t instanceof Array?(i=l(e,t),u=n instanceof Array?l(e,n):null):"number"==typeof t?(i=new r.default(e,t),u=n instanceof Node?new r.default(n,o):null):(t instanceof Node||!t)&&(i=new r.default(e,-2),u=new r.default(t||e,-3))),i){var c=i.node.ownerDocument.createRange();return i=a(i),u=a(u||i),c.setStart(i.node,i.offset),c.setEnd(u.node,u.offset),c}return null}function a(e){return 1==e.node.nodeType&&o.default(e.node)?new r.default(e.node,e.isAtEnd?-3:-2):e}function s(e){return e&&e.node}function l(e,t){if(!e||!t)return null;for(var n,o=0;o<t.length&&(n=t[o],o<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);o++)e=e.childNodes[n];return new r.default(e,n)}t.default=i,t.getRangeFromSelectionPath=function(e,t){return i(e,t.start,t.end)}},4122:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2593),r=n(3427),i=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return r.default(this.element,e.getEndNode())},e.prototype.contains=function(e){return o.default(this.element,e,!0)},e}();t.default=i},4123:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2593),r=n(3635);function i(e,t,n,i,a){for(;t.parentNode!=e&&!o.default(t.parentNode,n);){if(i&&t.previousSibling||!i&&t.nextSibling){if(!a)break;r.default(t,i)}t=t.parentNode}return t}t.default=function(e,t,n,r){if(!o.default(e,t)||!o.default(e,n))return[];if(t=i(e,t,n,!0,r),n=i(e,n,t,!1,r),o.default(t,n,!0))return[t];if(o.default(n,t))return[n];if(t.parentNode==n.parentNode){var a=[].slice.call(t.parentNode.childNodes),s=a.indexOf(t),l=a.indexOf(n);return a.slice(s,l+1)}return[t,n]}},4124:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2594),r="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),i=["block","list-item","table-cell"];t.default=function(e){var t=o.default(e);return!(!t||!(i.indexOf(e.style.display)>=0||r.indexOf(t)>=0))}},4125:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2594),r=n(2680),i=n(3636),a=n(3141),s=n(3635),l="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function u(e,t,n){var o=e.nodeValue.substr(0,t),r=e.nodeValue.substr(t),i=e.ownerDocument.createTextNode(n?o:r);return e.nodeValue=n?r:o,e.parentNode.insertBefore(i,n?e:e.nextSibling),i}t.default=function(e,t,n,c){void 0===n&&(n=new r.default(e,0).normalize()),void 0===c&&(c=new r.default(e,-1).normalize());for(var d=[];n&&c&&c.isAfter(n);){var f=n.node,p=o.default(f.parentNode),h=a.getNextLeafSibling(e,f);3==f.nodeType&&["TR","TABLE"].indexOf(p)<0&&(f!=c.node||c.isAtEnd||(f=u(f,c.offset,!0)),n.offset>0&&(f=u(f,n.offset,!1)),d.push(f)),n=h&&new r.default(h,0)}if(d.length>0){if(d.every(function(e){return e.parentNode==d[0].parentNode})){var g=d.shift();d.forEach(function(e){g.nodeValue+=e.nodeValue,e.parentNode.removeChild(e)}),d=[g]}d.forEach(function(e){for(;"SPAN"!=o.default(e)&&l.indexOf(o.default(e.parentNode))>=0;)e=s.splitBalancedNodeRange(e);t("SPAN"==o.default(e)?e:i.default(e,"span"))})}}},4126:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4127),r=/^[\r\n]+$/gm;t.default=function(e){return 3==e.nodeType?!e.nodeValue||""==e.textContent||r.test(e.nodeValue):1!=e.nodeType||"none"==o.getComputedStyle(e,"display")}},4127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3638);function r(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n=o.default(e),r=[];if(t=t instanceof Array?t:[t],n){var a=(n.ownerDocument.defaultView||window).getComputedStyle(n);if(a)for(var s=0,l=t;s<l.length;s++){var u=l[s],c=(a.getPropertyValue(u)||"").toLowerCase();c="font-size"==u?i(c):c,r.push(c)}}return r}function i(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}t.default=r,t.getComputedStyle=function(e,t){return r(e,t)[0]||""}},4128:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2594),r="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&r.indexOf(o.default(e))>=0}},4129:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3140),r=n(3639),i=n(4126),a=n(3141);function s(e,t,n){if(!e||!t||!t.node)return null;var s=(t=t.normalize()).node,l=t.offset,u=t.isAtEnd,c=!1;!n&&0==l&&!u||n&&u?s=a.getLeafSibling(e,s,n):3==s.nodeType&&(!n&&!u||n&&l>0)&&(c=!0),s&&i.default(s)&&(s=a.getLeafSibling(e,s,n));var d=o.default(e,s);return d&&(c||d.contains(t))&&(d=n?new r.default(d,t,null):new r.default(d,null,t)),d}t.getInlineElementBefore=function(e,t){return s(e,t,!1)},t.getInlineElementAfter=function(e,t){return s(e,t,!0)},t.getInlineElementBeforeAfter=s},4130:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var o=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=o),o}},4131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931),r="ROOSTERJS_TEMP_NODE_FOR_LIST",i='<img class="'+r+'">';function a(e,t,n){o.applyFormat(e,{fontFamily:t[0],fontSize:t[1],textColors:n?{lightModeColor:t[4],darkModeColor:t[2]}:null,textColor:t[2]},n)}t.default=function(e,t){o.Browser.isChrome&&function(e){for(var t=e.getSelectionTraverser(),n=t&&t.currentBlockElement;n;){var r=n.getStartNode();if(r&&!o.isNodeEmpty(r)){var a=o.fromHtml(i,e.getDocument())[0];o.isVoidHtmlElement(r)||!o.isBlockElement(r)?r.parentNode.insertBefore(a,r):r.insertBefore(a,r.firstChild)}n=t.getNextBlockElement()}}(e);var n=e.getElementAtCursor(),s=o.getComputedStyles(n),l=n.dataset.ogsc;s.push(l);var u=e.getElementAtCursor("OL,UL");e.getDocument().execCommand(t,!1,null),e.queryElements("."+r,function(t){return e.deleteNode(t)});var c=e.getElementAtCursor("OL,UL");if(c==u&&(c=null),c&&"OL"==o.getTagOfNode(c)){var d=[].slice.call(c.childNodes).filter(function(e){return"LI"==o.getTagOfNode(e)});if(1==d.length&&o.isNodeEmpty(d[0],!0))a(d[0],s,e.isDarkMode());else for(var f=0,p=d;f<p.length;f++){var h=p[f],g=o.getFirstLeafNode(h);g&&a(h,o.getComputedStyles(g),e.isDarkMode())}}return c}},4488:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4123),r=n(2593),i=n(2594),a=n(4124),s=n(3427),l=n(3636),u=n(3635),c=["TD","TH","LI","BLOCKQUOTE"],d=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(;e&&!a.default(e);)e=e.parentNode;return e},e.prototype.collapseToSingleElement=function(){for(var t=o.default(e.getBlockContext(this.startNode),this.startNode,this.endNode,!0),n=e.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&c.indexOf(i.default(t[0].parentNode))<0;)t=[u.splitBalancedNodeRange(t)];return 1==t.length&&a.default(t[0])?t[0]:l.default(t)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return s.default(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return r.default(this.startNode,e,!0)||r.default(this.endNode,e,!0)||s.default(e,this.startNode)&&s.default(this.endNode,e)},e}();t.default=d},4489:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,[].slice.call(n.childNodes)}},4490:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2990);function r(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&o.default(e,n)}t.default=r,t.getFirstBlockElement=function(e){return r(e,!0)},t.getLastBlockElement=function(e){return r(e,!1)}},4491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5504),r=n(4496),i=n(2990),a=n(3140),s=n(3639),l=n(5505),u=n(5506),c=n(4129),d=n(3141),f=function(){function e(e){this.scoper=e}return e.createBodyTraverser=function(t,n){return new e(new o.default(t,n))},e.createSelectionTraverser=function(t,n){return new e(new u.default(t,n))},e.createBlockTraverser=function(t,n,o){return void 0===o&&(o=2),new e(new l.default(t,n,o))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!0,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement,n=d.getLeafSibling(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e),o=n?i.default(this.scoper.rootNode,n):null;return o&&this.scoper.isBlockInScope(o)&&(e&&o.isAfter(t)||!e&&t.isAfter(o))?(this.currentBlock=o,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof r.default?null:this.currentInline},enumerable:!0,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n instanceof r.default?(t=c.getInlineElementBeforeAfter(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof s.default){var o=n?t.nextInlineElement:t.previousInlineElement;if(o)return o}var r=t.getContainerNode();return r=d.getLeafSibling(e,r,n),a.default(e,r)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null},e}();t.default=f},4492:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t}(n(3637).default);t.default=i},4493:function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t}(n(3637).default);t.default=i},4494:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3140),r=n(4495);t.getFirstInlineElement=function(e){var t=r.getFirstLeafNode(e);return t?o.default(e,t):null},t.getLastInlineElement=function(e){var t=r.getLastLeafNode(e);return t?o.default(e,t):null}},4495:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4126),r=n(3141);function i(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},i=n(e);i&&n(i);)i=n(i);return i&&o.default(i)&&(i=r.getLeafSibling(e,i,t)),i}t.getFirstLeafNode=function(e){return i(e,!0)},t.getLastLeafNode=function(e){return i(e,!1)}},4496:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=o},4497:function(e,t,n){"use strict";function o(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),o=-1!=e.indexOf("MSIE")||n,r=!1,i=!1,a=!1,s=!1,l=-1!=e.indexOf("WebKit");return o||(r=-1!=e.indexOf("Chrome"),i=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(s=-1!=e.indexOf("Edge"))&&(l=r=i=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:l,isIE:o,isIE11OrGreater:n,isSafari:a,isChrome:r,isFirefox:i,isEdge:s,isIEOrEdge:o||s}}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=o;var r=window?o(window.navigator.userAgent,window.navigator.appVersion):{};t.default=r},4498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4127),r=n(2594);t.default=function(e,t){var n;if(!e||!t)return null;for(var i=e.ownerDocument.createElement(t),a=0;a<e.attributes.length;a++){var s=e.attributes[a];i.setAttribute(s.name,s.value)}for(;e.firstChild;)i.appendChild(e.firstChild);return"P"!=r.default(e)&&"P"!=r.default(i)||(n=o.default(e,["margin-top","margin-bottom"]),i.style.marginTop=n[0],i.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(i,e),i}},4499:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2594),r=["IMG"],i=["TABLE","IMG","LI"].join(","),a=/\u200b/g;function s(e,t){return e=e.replace(a,""),t?e.trim():e}t.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==s(e.nodeValue,t);if(1==e.nodeType){var n=e;if(""!=s(n.textContent,t)||r.indexOf(o.default(n))>=0||n.querySelectorAll(i)[0])return!1}return!0}},4500:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2593),r=n(4499);function i(e){for(;e.previousSibling;)if(e=e.previousSibling,!r.default(e))return!1;return!0}t.default=function(e,t){if(e){var n=e.normalize(),r=n.node;if(0==n.offset){for(;o.default(t,r)&&i(r);)r=r.parentNode;return r==t}}return!1}},4501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},4502:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){var t=this;if(this.trs=[],this.table=e instanceof HTMLTableElement?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var n=e instanceof HTMLTableElement?null:e,o=[].slice.call(this.table.rows);this.cells=o.map(function(e){return[]}),o.forEach(function(e,o){t.trs[o%2]=e;for(var r=0,i=0;r<e.cells.length;r++){for(;t.cells[o][i];i++);var a=e.cells[r];a==n&&(t.col=i,t.row=o);for(var s=0;s<a.colSpan;s++,i++)for(var l=0;l<a.rowSpan;l++)t.cells[o+l][i]={td:s+l==0?a:null,spanLeft:s>0,spanAbove:l>0}}})}}return e.prototype.writeBack=function(){var e=this;this.cells?(s(this.table),this.cells.forEach(function(t,n){var o=a(e.trs[n%2]||e.trs[0]);e.table.appendChild(o),t.forEach(function(t,r){t.td&&(e.recalcSpans(n,r),o.appendChild(t.td))})})):this.table&&this.table.parentNode.removeChild(this.table)},e.prototype.applyFormat=function(e){e&&this.table&&(this.table.style.borderCollapse="collapse",this.trs[0].style.backgroundColor=e.bgColorOdd||"transparent",this.trs[1]&&(this.trs[1].style.backgroundColor=e.bgColorEven||"transparent"),this.cells.forEach(function(t){return t.filter(function(e){return e.td}).forEach(function(t){t.td.style.borderTop=r(e.topBorderColor),t.td.style.borderBottom=r(e.bottomBorderColor),t.td.style.borderLeft=r(e.verticalBorderColor),t.td.style.borderRight=r(e.verticalBorderColor)})}))},e.prototype.edit=function(e){var t=this;if(this.table){var n=this.cells[this.row],o=n[this.col];switch(e){case 0:this.cells.splice(this.row,0,n.map(i));break;case 1:var r=this.row+this.countSpanAbove(this.row,this.col);this.cells.splice(r,0,this.cells[r-1].map(function(e,n){var o=t.getCell(r,n);if(o.spanAbove)return i(o);if(e.spanLeft){var s=i(e);return s.spanAbove=!1,s}return{td:a(t.getTd(t.row,n))}}));break;case 2:this.forEachCellOfCurrentColumn(function(e,n){n.splice(t.col,0,i(e))});break;case 3:var l=this.col+this.countSpanLeft(this.row,this.col);this.forEachCellOfColumn(l-1,function(e,n,o){var r,s=t.getCell(o,l);s.spanLeft?r=i(s):e.spanAbove?(r=i(e)).spanLeft=!1:r={td:a(t.getTd(o,t.col))},n.splice(l,0,r)});break;case 6:this.forEachCellOfCurrentRow(function(e,n){var o=t.getCell(t.row+1,n);e.td&&e.td.rowSpan>1&&o.spanAbove&&(o.td=e.td)}),this.cells.splice(this.row,1);break;case 5:this.forEachCellOfCurrentColumn(function(e,n,o){var r=t.getCell(o,t.col+1);e.td&&e.td.colSpan>1&&r.spanLeft&&(r.td=e.td),n.splice(t.col,1)});break;case 7:case 8:for(var u=7==e?-1:1,c=this.row+u;c>=0&&c<this.cells.length;c+=u){if((g=this.getCell(c,this.col)).td&&!g.spanAbove){var d=c<this.row?g:o,f=c<this.row?o:g;d.td.colSpan==f.td.colSpan&&(s(f.td,d.td),f.td=null,f.spanAbove=!0);break}}break;case 9:case 10:for(var p=9==e?-1:1,h=this.col+p;h>=0&&h<this.cells[this.row].length;h+=p){var g;if((g=this.getCell(this.row,h)).td&&!g.spanLeft){var v=h<this.col?g:o,m=h<this.col?o:g;v.td.rowSpan==m.td.rowSpan&&(s(m.td,v.td),m.td=null,m.spanLeft=!0);break}}break;case 4:this.cells=null;break;case 12:if(o.td.rowSpan>1)this.getCell(this.row+1,this.col).td=a(o.td);else{var y=n.map(function(e){return{td:e==o?a(e.td):null,spanAbove:e!=o,spanLeft:e.spanLeft}});this.cells.splice(this.row+1,0,y)}break;case 11:o.td.colSpan>1?this.getCell(this.row,this.col+1).td=a(o.td):this.forEachCellOfCurrentColumn(function(e,o){o.splice(t.col+1,0,{td:o==n?a(e.td):null,spanAbove:e.spanAbove,spanLeft:o!=n})})}}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells)for(e=Math.min(this.cells.length-1,e),t=Math.min(this.cells[e].length-1,t);e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){for(var n=0;n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){for(var n=0;n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalcSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,o=t+1;o<this.cells[e].length;o++){var r=this.getCell(e,o);if(r.td||!r.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,o=e+1;o<this.cells.length;o++){var r=this.getCell(o,t);if(r.td||!r.spanAbove)break;n++}return n},e}();function r(e){return"solid 1px "+(e||"transparent")}function i(e){return{td:a(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function a(e){var t=e?e.cloneNode(!1):null;return t&&t instanceof HTMLTableCellElement&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}function s(e,t){for(;e.firstChild;)t?t.appendChild(e.firstChild):e.removeChild(e.firstChild)}t.default=o},4503:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931),r=function(){function e(e){var t=this;this.disableRestoreSelectionOnFocus=e,this.inIme=!1,this.onNativeEvent=function(e){t.editor.runAsync(function(){t.editor.addUndoSnapshot(function(){},"cut"==e.type?"Cut":"Drop")})}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n=this;this.editor=e,this.disposer=e.addDomEventHandler(((t={compositionstart:function(){return n.inIme=!0},compositionend:function(t){n.inIme=!1,e.triggerEvent({eventType:3,rawEvent:t})}})[o.Browser.isIEOrEdge?"beforedeactivate":"blur"]=function(){return e.saveSelectionRange()},t.focus=!this.disableRestoreSelectionOnFocus&&function(){return e.restoreSavedRange()},t.drop=this.onNativeEvent,t.cut=this.onNativeEvent,t))},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.isInIME=function(){return this.inIme},e}();t.default=r},4504:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this.currentFeature=null,this.featureMap={},this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.addFeature({keys:[8],shouldHandleEvent:function(){return null!==t.autoCompleteSnapshot},handleEvent:function(e,n){e.rawEvent.preventDefault(),n.setContent(t.autoCompleteSnapshot,!1)}})},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=!1;switch(e.eventType){case 6:this.autoCompleteChangeSource!=e.source&&(t=!0),this.currentFeature||this.findFeature(e);break;case 4:case 0:t=!0}if(this.currentFeature){var n=this.currentFeature;this.currentFeature=null,n.handleEvent(e,this.editor)}t&&(this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null)},e.prototype.willHandleEventExclusively=function(e){return this.findFeature(e),!!this.currentFeature},e.prototype.addFeature=function(e){var t=this;e.initialize&&e.initialize(this.editor),e.keys.forEach(function(n){var o=t.featureMap[n]||[];o.push(e),t.featureMap[n]=o})},e.prototype.performAutoComplete=function(e,t){var n=this;this.editor.addUndoSnapshot(function(o,r,i){var a=e();return n.autoCompleteSnapshot=i,n.autoCompleteChangeSource=t,a},t)},e.prototype.findFeature=function(e){var t,n=this,o=!1;if(0==e.eventType){var r=e.rawEvent;o=r.ctrlKey||r.altKey||r.metaKey,t=this.featureMap[r.which]}else 6==e.eventType&&(t=this.featureMap[2048]);this.currentFeature=t&&t.filter(function(t){return(t.allowFunctionKeys||!o)&&t.shouldHandleEvent(e,n.editor)})[0]},e}();t.default=o},4505:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4506),r=n(1931),i=function(){function e(){}return e.prototype.getName=function(){return"FirefoxTypeAfterLink"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(1==e.eventType){var t=this.editor.getSelectionRange();if(t&&t.collapsed&&this.editor.getElementAtCursor("A[href]")){var n=o.cacheGetContentSearcher(e,this.editor).getInlineElementBefore();n instanceof r.LinkInlineElement&&this.editor.select(new r.Position(n.getContainerNode(),-3))}}},e}();t.default=i},4506:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4130),r=n(4507),i="CONTENTSEARCHER";t.cacheGetContentSearcher=function(e,t){return o.default(e,i,function(){return t.getContentSearcherOfCursor()})},t.clearContentSearcherCache=function(e){r.default(e,i)}},4507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)&&delete e.eventDataCache[t]}},4508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e){var t=e.document.activeElement;return t&&o.contains(e.contentDiv,t,!0)}},4509:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerEvent({eventType:5,rawEvent:t}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){4!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=o},4510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931),r=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){1==e.eventType&&this.onKeyPress(e)},e.prototype.ensureTypeInElement=function(e,t){var n,r=e.normalize(),i=this.editor.getBlockElementAtNode(r.node);if(i){n=i.collapseToSingleElement();var a=o.isNodeEmpty(n)||t&&this.wasNodeJustCreatedByKeyboardEvent(t,n);n=n&&a?n:null}else n=o.fromHtml(o.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",this.editor.getDocument())[0],this.editor.insertNode(n,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),r=new o.Position(n.firstChild,0);return n&&o.applyFormat(n,this.editor.getDefaultFormat(),this.editor.isDarkMode()),r},e.prototype.onKeyPress=function(e){var t=this,n=this.editor.getSelectionRange();n&&!this.editor.contains(o.findClosestElementAncestor(n.startContainer))&&(n.collapsed?this.tryNormalizeTyping(e,n):n.collapsed||this.editor.runAsync(function(){t.tryNormalizeTyping(e)}))},e.prototype.tryNormalizeTyping=function(e,t){var n=this.ensureTypeInElement(o.Position.getStart(t||this.editor.getSelectionRange()),e);this.editor.select(n)},e.prototype.wasNodeJustCreatedByKeyboardEvent=function(e,t){return e.rawEvent.target instanceof Node&&e.rawEvent.target.contains(t)&&e.rawEvent.key===t.innerText},e}();t.default=r},4511:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5526),r=function(){function e(e,t){void 0===t&&(t=1e7),this.preserveSnapshots=e,this.maxBufferSize=t}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.preserveSnapshots||this.clear()},e.prototype.onPluginEvent=function(e){if(!this.editor.isInIME())switch(e.eventType){case 9:this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 3:this.clearRedoForInput(),this.addUndoSnapshot();break;case 6:this.isRestoring||this.clearRedoForInput()}},e.prototype.clear=function(){this.undoSnapshots=null,this.hasNewContent=!1},e.prototype.undo=function(){this.hasNewContent&&this.addUndoSnapshot(),this.restoreSnapshot(-1)},e.prototype.redo=function(){this.restoreSnapshot(1)},e.prototype.canUndo=function(){return this.hasNewContent||this.getSnapshotsManager().canMove(-1)},e.prototype.canRedo=function(){return this.getSnapshotsManager().canMove(1)},e.prototype.addUndoSnapshot=function(){var e=this.editor.getContent(!1,!0,!this.editor.isDarkMode());return this.getSnapshotsManager().addSnapshot(e),this.hasNewContent=!1,e},e.prototype.getSnapshotsManager=function(){return this.undoSnapshots||(this.undoSnapshots=new o.default(this.maxBufferSize)),this.undoSnapshots},e.prototype.restoreSnapshot=function(e){var t=this.getSnapshotsManager().move(e);if(null!=t)try{this.isRestoring=!0,this.editor.setContent(t)}finally{this.isRestoring=!1}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which){var t=this.editor.getSelectionRange();t&&(!t.collapsed||this.lastKeyPress!=e.which||e.ctrlKey||e.metaKey)&&this.addUndoSnapshot(),this.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.getSnapshotsManager().clearRedo(),this.lastKeyPress=0,this.hasNewContent=!0},e}();t.default=r},4512:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);function r(e){var t=e.getStartNode();return e instanceof o.StartEndBlockElement&&t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(o.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),o=n&&n.currentBlockElement,i=[];o;)r(o)||i.push(o),o=n.getNextBlockElement();i.forEach(function(e){var n=e.collapseToSingleElement();t(n)})}},4513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3428);t.default=function(e,t){if("string"==typeof t){var n=t.trim();o.default(e,function(e){e.style.backgroundColor=n})}else{var r=e.isDarkMode(),i=r?t.darkModeColor:t.lightModeColor;o.default(e,function(e){e.style.backgroundColor=i,r&&(e.dataset.ogsb=t.lightModeColor)})}}},4514:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3428);t.default=function(e,t){t=t.trim(),o.default(e,function(e){return e.style.fontFamily=t})}},4515:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3428),r=n(1931);t.default=function(e,t){t=t.trim(),o.default(e,function(e){e.style.fontSize=t,"normal"!=r.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")})}},4516:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3428);t.default=function(e,t){if("string"==typeof t){var n=t.trim();o.default(e,function(e){e.style.color=n})}else{var r=e.isDarkMode(),i=r?t.darkModeColor:t.lightModeColor;o.default(e,function(e){e.style.color=i,r&&(e.dataset.ogsc=t.lightModeColor)})}}},4517:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774);t.default=function(e){o.default(e,"bold")}},4518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774);t.default=function(e){o.default(e,"italic")}},4519:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774);t.default=function(e){o.default(e,"underline")}},4520:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931),r="&#8203;",i="LI,THEAD,TBODY,TR,TD,TH".split(","),a=function(e){};t.default=function(e,t,n,s,l){void 0===s&&(s=function(e){return o.wrap(e,t)}),void 0===l&&(l=o.unwrap),e.focus(),e.addUndoSnapshot(function(u,c){var d,f=e.getSelectionRange();if(f&&0==e.queryElements(t,1,l).length){var p=o.Position.getStart(f).normalize().node,h=e.getBlockElementAtNode(p),g=o.Position.getEnd(f).normalize().node,v=e.getBlockElementAtNode(g),m=h&&v?e.collapseNodes(h.getStartNode(),v.getEndNode(),!0):[];if(0==m.length)m=o.fromHtml("<DIV>"+(o.Browser.isIEOrEdge?r:"<BR>")+"</DIV>",e.getDocument()),e.insertNode(m[0]),e.select(m[0],0);else if(1==m.length){var y=o.getTagOfNode(m[0]);"BR"==y?m=[o.wrap(m[0])]:"LI"!=y&&"TD"!=y||(m=[].slice.call(m[0].childNodes))}else for(;m[0]&&e.contains(m[0].parentNode)&&m.some(function(e){return i.indexOf(o.getTagOfNode(e))>=0});)m=[o.splitBalancedNodeRange(m)];d=s(m),(n||a)(d)}return!e.select(u,c)&&d&&e.select(d),d},"Format")}},5504:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2593),r=n(2990),i=n(3140),a=n(4490),s=n(4494),l=function(){function e(e,t){this.rootNode=e,this.startNode=o.default(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?r.default(this.rootNode,this.startNode):a.getFirstBlockElement(this.rootNode)},e.prototype.getStartInlineElement=function(){return this.startNode?i.default(this.rootNode,this.startNode):s.getFirstInlineElement(this.rootNode)},e.prototype.isBlockInScope=function(e){return o.default(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=l},5505:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4496),r=n(2990),i=n(3140),a=n(4122),s=n(2680),l=n(4129),u=n(4494),c=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,t=t instanceof Range?s.default.getStart(t):t,this.position=t.normalize(),this.block=r.default(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:return function(e,t){if(e instanceof a.default){var n=e.getStartNode();return t?u.getFirstInlineElement(n):u.getLastInlineElement(n)}return i.default(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 2:var e=l.getInlineElementAfter(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new o.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=c},5506:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2990),r=n(3639),i=n(2680),a=n(4129),s=function(){function e(e,t){this.rootNode=e,this.start=i.default.getStart(t).normalize(),this.end=i.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=o.default(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(a.getInlineElementAfter(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=n&&n.equals(e);else{var r=o.default(this.rootNode,this.end.node);t=n&&r&&(e.equals(n)||e.equals(r)||e.isAfter(n)&&r.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var o=!1,i=!1;return this.start.isAfter(t)&&(t=this.start,o=!0),n.isAfter(this.end)&&(n=this.end,i=!0),t.isAfter(n)||t.equalTo(n)?null:o||i?new r.default(e,o&&t,i&&n):e},e}();t.default=s},5507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4491),r=n(3640),i=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.inlineElements=[]}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse(function(){return e.word}),this.word},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=o.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse(function(){return t.text.length>=e}),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n,o,i=e.length-1;return this.forEachTextInlineElement(function(r){for(var a=r.getTextContent()||"",s=a.length-1;s>=0&&i>=0;s--)if(e.charCodeAt(i)==a.charCodeAt(s))i--,o||(o=r.getStartPosition().move(s+1));else if(t||o)return!0;return-1==i&&(n=r.getStartPosition().move(s+1),!0)}),n&&o&&r.default(n,o)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse(function(){return e.nearestNonTextInlineElement}),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||o.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var r=i.exec(n);r&&2==r.length&&(this.word=r[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},5508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(t){var o=e.style,r=t.fontFamily,i=t.fontSize,a=t.textColor,s=t.textColors,l=t.backgroundColor,u=t.backgroundColors,c=t.bold,d=t.italic,f=t.underline;r&&(o.fontFamily=r),i&&(o.fontSize=i),(a||s)&&(s&&n&&(e.dataset.ogsc=s.lightModeColor),o.color=a),(l||u)&&(u&&n&&(e.dataset.ogsb=u.lightModeColor),o.backgroundColor=l),c&&(o.fontWeight="bold"),d&&(o.fontStyle="italic"),f&&(o.textDecoration="underline")}}},5509:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4497),r=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i;function i(e){for(var t=e.items?e.items.length:0,n=0;n<t;n++){var o=e.items[n];if(o.type&&0==o.type.indexOf("image/"))return o.getAsFile()}t=e.files?e.files.length:0;for(n=0;n<t;n++){var r=e.files.item(n);if(r.type&&0==r.type.indexOf("image/"))return r}return null}function a(e){var t=r.exec(e);if(t&&3==t.length){var n=parseInt(t[1]),o=parseInt(t[2]);n>0&&o>n&&(e=e.substring(n,o))}return e}t.default=function(e,t){var n=e.clipboardData||e.srcElement.ownerDocument.defaultView.clipboardData,r={types:n.types?[].slice.call(n.types):[],text:n.getData("text"),image:i(n),html:void 0};if(e.clipboardData&&e.clipboardData.items){e.preventDefault();for(var s=e.clipboardData.items,l=0;l<s.length;l++){var u=s[l];if(u.type&&0==u.type.indexOf("text/html"))return void u.getAsString(function(e){r.html=o.default.isEdge?a(e):e,t(r)})}r.html=null}t(r)}},5510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,r="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",i={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+r+"|www\\."+r,"i"),except:o,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+r,"i"),except:o},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+r+"|ftp\\."+r,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+r,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+r,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+r,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+r,"i")}};t.default=function(e){if(e)for(var t=0,n=Object.keys(i);t<n.length;t++){var o=n[t],r=i[o],a=e.match(r.match);if(a&&a[0]==e&&(!r.except||!r.except.test(e)))return{scheme:o,originalUrl:e,normalizedUrl:r.normalizeUrl?r.normalizeUrl(e):e}}return null}},5511:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4498),r=n(3638),i=n(2594),a=n(4500),s=n(4128),l=n(2680),u=n(4501),c=n(4502),d=n(3636);t.default=function(e,t,n){var f=t;if(11==f.nodeType){var p=[].slice.call(f.childNodes).filter(function(e){return"BR"!=i.default(e)});f=1==p.length?p[0]:null}var h=i.default(f),g=h&&"BR"==i.default(f.nextSibling),v=r.default(n.node,e,"LI"),m=v&&r.default(v,e,"OL,UL"),y=r.default(n.node,e,"TD,TH"),E=y&&r.default(y,e,"TR");if("LI"==h&&(h=m?i.default(m):"UL",f=d.default(f,h)),"OL"!=h&&"UL"!=h||"LI"!=i.default(f.firstChild)){if("TABLE"==h&&E){var C=new c.default(f),S=new c.default(y);0==S.col&&y==S.getCell(S.row,0).td&&C.cells[0]&&C.cells[0].length==S.cells[0].length&&a.default(n,y)&&("TBODY"!=i.default(f.firstChild)||f.firstChild.nextSibling||u.default(f.firstChild),u.default(f),n=new l.default(E,-3))}}else{var b=!f.firstChild.nextSibling&&!g;g&&f.parentNode&&f.parentNode.removeChild(f.nextSibling),b?(u.default(f.firstChild),u.default(f)):i.default(m)==h&&(u.default(f),n=new l.default(v,a.default(n,v)?-2:-3))}if("P"==i.default(n.node)){var N=n.normalize(),O=o.default(n.node,"div");N.node!=O&&(n=N)}return s.default(n.node)&&(n=new l.default(n.node,n.isAtEnd?-3:-2)),n}},5512:function(e,t,n){"use strict";function o(e,t){return t.some(function(t){return 0==t?0==e:(e&t)==t})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,i){if(void 0===r&&(r=0),!e||!t)return[];var a=[].slice.call(e.querySelectorAll(t));return 0!=r&&i&&(a=a.filter(function(e){return function(e,t,n){var r=e.compareDocumentPosition(t.startContainer),i=e.compareDocumentPosition(t.endContainer),a=[0,8];return n||a.push(16),o(r,a)||o(i,a)||o(r,[2])&&o(i,[4])&&!o(i,[16])}(e,i,2==r)})),n&&a.forEach(n),a}},5513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3640);function r(e){var t=e||{},n=t.left,o=t.right,r=t.top,i=t.bottom;return n+o+r+i>0?{left:Math.round(n),right:Math.round(o),top:Math.round(r),bottom:Math.round(i)}:null}t.default=function(e){if(!e)return null;var t=o.default(e),n=t.getBoundingClientRect&&r(t.getBoundingClientRect());if(n)return n;e=e.normalize();var i=t.getClientRects&&t.getClientRects();if(n=i&&1==i.length&&r(i[0]))return n;if(3==e.node.nodeType){var a=document.createElement("SPAN");if(a.innerHTML="â€‹",(t=o.default(e)).insertNode(a),n=a.getBoundingClientRect&&r(a.getBoundingClientRect()),a.parentNode.removeChild(a),n)return n}var s=e.element;return s&&s.getBoundingClientRect&&(n=r(s.getBoundingClientRect()))?n:null}},5514:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2593),r=n(2680);function i(e,t){if(!e||!t)return[];var n,r=e.node,i=e.offset,a=[];if(!o.default(t,r,!0))return[];if(3==r.nodeType){for(n=r.parentNode;r.previousSibling&&3==r.previousSibling.nodeType;)i+=r.previousSibling.nodeValue.length,r=r.previousSibling;a.unshift(i)}else n=r,r=r.childNodes[i];do{i=0;for(var s=!1,l=n.firstChild;l&&l!=r;l=l.nextSibling){if(3==l.nodeType){if(0==l.nodeValue.length||s)continue;s=!0}else s=!1;i++}a.unshift(i),r=n,n=n.parentNode}while(r&&r!=t);return a}t.default=function(e,t){return t?{start:i(r.default.getStart(t),e),end:i(r.default.getEnd(t),e)}:null}},5515:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SPACE=32]="SPACE",e[e.UP=38]="UP",e[e.DOWN=40]="DOWN",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.Ctrl=256]="Ctrl",e[e.Meta=512]="Meta",e[e.Shift=1024]="Shift",e[e.CONTENTCHANGED=2048]="CONTENTCHANGED",e[e.MOUSEDOWN=4096]="MOUSEDOWN"}(t.Keys||(t.Keys={}))},5516:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5517),r=n(1931),i=function(){function e(e,t){void 0===t&&(t={});var n=this;if("DIV"!=r.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");if(this.core=o.default(e,t),this.core.plugins.forEach(function(e){return e.initialize(n)}),this.setContent(t.initialContent||e.innerHTML||"",!0,this.core.inDarkMode),this.eventDisposers=[this.core.api.attachDomEvent(this.core,"keypress",1),this.core.api.attachDomEvent(this.core,"keydown",0),this.core.api.attachDomEvent(this.core,"keyup",2),this.core.api.attachDomEvent(this.core,"mousedown",4),this.core.api.attachDomEvent(this.core,r.Browser.isIE?"textinput":"input",11)],t.additionalEditFeatures&&t.additionalEditFeatures.forEach(function(e){return n.addContentEditFeature(e)}),!t.omitContentEditableAttributeChanges&&!e.isContentEditable){e.setAttribute("contenteditable","true");var i=e.style;i.userSelect=i.msUserSelect=i.webkitUserSelect="text",this.contenteditableChanged=!0}try{r.Browser.isFirefox?(this.core.document.execCommand("enableObjectResizing",!1,!1),this.core.document.execCommand("enableInlineTableEditing",!1,!1)):r.Browser.isIE&&this.core.document.execCommand("defaultParagraphSeparator",!1,"div")}catch(e){}this.triggerEvent({eventType:9},!0),this.core.corePlugins.typeInContainer.ensureTypeInElement(new r.Position(e,0))}return e.prototype.dispose=function(){this.triggerEvent({eventType:10},!0),this.core.plugins.forEach(function(e){return e.dispose()}),this.eventDisposers.forEach(function(e){return e()}),this.eventDisposers=null;for(var e=0,t=Object.keys(this.core.customData);e<t.length;e++){var n=t[e],o=this.core.customData[n];o&&o.disposer&&o.disposer(o.value),delete this.core.customData[n]}if(this.contenteditableChanged){var r=this.core.contentDiv.style;r.userSelect=r.msUserSelect=r.webkitUserSelect="",this.core.contentDiv.removeAttribute("contenteditable")}this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.isDarkMode()?this.convertContentToDarkMode(e):null,o=!!e&&this.core.api.insertNode(this.core,e,t);return o&&n&&n(),o},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t){return!!(e&&t&&this.contains(e))&&(e.parentNode.replaceChild(t,e),!0)},e.prototype.getInlineElementAtNode=function(e){return r.getInlineElementAtNode(this.core.contentDiv,e)},e.prototype.getBlockElementAtNode=function(e){return r.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return r.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var o=t instanceof Function?0:t;n=t instanceof Function?t:n;var i=0==o?null:this.getSelectionRange();return r.queryElements(this.core.contentDiv,e,n,o,i)},e.prototype.collapseNodes=function(e,t,n){return r.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return r.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e,t,n){void 0===e&&(e=!0),void 0===t&&(t=!1),void 0===n&&(n=!0);var o,i=this.core.contentDiv,a=i.innerHTML;if(t&&(o=r.getSelectionPath(i,this.getSelectionRange()))&&(a+="\x3c!--"+JSON.stringify(o)+"--\x3e"),e){var s={eventType:7,content:a};this.triggerEvent(s,!0),a=s.content}return this.core.inDarkMode&&n&&(a=this.getColorNormalizedContent(a)),a},e.prototype.getColorNormalizedContent=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.getElementsByTagName("*");return[].forEach.call(n,function(e){e.dataset&&(e.style.color=e.dataset.ogsc?e.dataset.ogsc:"",e.style.backgroundColor=e.dataset.ogsb?e.dataset.ogsb:"",e.dataset.ogac&&e.setAttribute("color",e.dataset.ogac),e.dataset.ogab&&e.setAttribute("bgcolor",e.dataset.ogab),delete e.dataset.ogsc,delete e.dataset.ogsb,delete e.dataset.ogac,delete e.dataset.ogab)}),t.innerHTML},e.prototype.getTextContent=function(){return this.core.contentDiv.innerText},e.prototype.setContent=function(e,t,n){void 0===t&&(t=!0);var o=this.core.contentDiv,i=!1;if(o.innerHTML!=e){o.innerHTML=e||"",i=!0;var a=o.lastChild;if(a&&8==a.nodeType)try{var s=JSON.parse(a.nodeValue);this.deleteNode(a);var l=r.getRangeFromSelectionPath(o,s);this.select(l)}catch(e){}}if(n){var u=this.convertContentToDarkMode(o,!0);u&&(u(),i=!0)}t&&i&&this.triggerContentChangedEvent()},e.prototype.insertContent=function(e,t){if(e){var n=r.fromHtml(e,this.core.document);t&&t.insertOnNewLine&&n.length>0&&(n=[r.wrap(n)]);for(var o=0;o<n.length;o++)this.insertNode(n[o],t)}},e.prototype.getSelectionRange=function(){return this.core.api.getSelectionRange(this.core,!0)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,o){var i=e instanceof Range?e:r.createRange(e,t,n,o);return this.core.api.selectRange(this.core,i)},e.prototype.getSelection=function(){return this.core.document.defaultView.getSelection()},e.prototype.saveSelectionRange=function(){this.core.cachedSelectionRange=this.core.api.getSelectionRange(this.core,!1)},e.prototype.restoreSavedRange=function(){this.select(this.core.cachedSelectionRange),this.core.cachedSelectionRange=null},e.prototype.getFocusedPosition=function(){var e=this.getSelection();if(this.contains(e&&e.focusNode))return new r.Position(e.focusNode,e.focusOffset);var t=this.getSelectionRange();return t?r.Position.getStart(t):null},e.prototype.getCursorRect=function(){var e=this.getFocusedPosition();return e&&r.getPositionRect(e)},e.prototype.getElementAtCursor=function(e,t){if(!t){var n=this.getFocusedPosition();t=n&&n.node}return t&&r.findClosestElementAncestor(t,this.core.contentDiv,e)},e.prototype.addDomEventHandler=function(e,t){var n=this;if(e instanceof Object){var o=Object.keys(e).map(function(t){return e[t]&&n.core.api.attachDomEvent(n.core,t,null,e[t])}).filter(function(e){return e});return function(){return o.forEach(function(e){return e()})}}return this.core.api.attachDomEvent(this.core,e,null,t)},e.prototype.triggerEvent=function(e,t){void 0===t&&(t=!0),this.core.api.triggerEvent(this.core,e,t)},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerEvent({eventType:6,source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.corePlugins.undo.undo()},e.prototype.redo=function(){this.focus(),this.core.corePlugins.undo.redo()},e.prototype.addUndoSnapshot=function(e,t){this.core.api.editWithUndo(this.core,e,t)},e.prototype.performAutoComplete=function(e,t){this.core.corePlugins.edit.performAutoComplete(e,t)},e.prototype.canUndo=function(){return this.core.corePlugins.undo.canUndo()},e.prototype.canRedo=function(){return this.core.corePlugins.undo.canRedo()},e.prototype.getDocument=function(){return this.core.document},e.prototype.getCustomData=function(e,t,n){return this.core.api.getCustomData(this.core,e,t,n)},e.prototype.isInIME=function(){return this.core.corePlugins.domEvent.isInIME()},e.prototype.getDefaultFormat=function(){return this.core.defaultFormat},e.prototype.getBodyTraverser=function(e){return r.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&r.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=2);var t=this.getSelectionRange();return t&&r.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(){var e=this.getSelectionRange();return e&&new r.PositionContentSearcher(this.core.contentDiv,r.Position.getStart(e))},e.prototype.runAsync=function(e){var t=this;(this.core.contentDiv.ownerDocument.defaultView||window).requestAnimationFrame(function(){!t.isDisposed()&&e&&e()})},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.addContentEditFeature=function(e){this.core.corePlugins.edit.addFeature(e)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(void 0,!0);this.core.inDarkMode=e,this.core.defaultFormat=o.calcDefaultFormat(this.core.contentDiv,this.core.defaultFormat,this.core.inDarkMode),e?this.setContent(t,void 0,!0):this.setContent(t)}},e.prototype.isDarkMode=function(){return this.core.inDarkMode},e.prototype.getDarkModeOptions=function(){return this.core.darkModeOptions},e.prototype.convertContentToDarkMode=function(e,t){var n=this,o=[];return e instanceof HTMLElement?(o=Array.prototype.slice.call(e.getElementsByTagName("*")),t||o.unshift(e)):e instanceof DocumentFragment&&(o=Array.prototype.slice.call(e.querySelectorAll("*"))),o.length>0?function(){var e=n.getDarkModeOptions();o.forEach(function(t){e&&e.onExternalContentTransform?e.onExternalContentTransform(t):(t.style.color=null,t.style.backgroundColor=null)})}:null},e}();t.default=i},5517:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5518),r=n(4503),i=n(4504),a=n(5519),s=n(4505),l=n(5520),u=n(5521),c=n(5522),d=n(4508),f=n(5523),p=n(4509),h=n(5524),g=n(5525),v=n(4510),m=n(4511),y=n(1931),E=n(5527);function C(e,t,n){if(n&&(t.backgroundColors||(t.backgroundColors=E.DARK_MODE_DEFAULT_FORMAT.backgroundColors),t.textColors||(t.textColors=E.DARK_MODE_DEFAULT_FORMAT.textColors)),t&&0===Object.keys(t).length)return{};var o=(t=t||{}).fontFamily,r=t.fontSize,i=t.textColor,a=t.textColors,s=t.backgroundColor,l=t.backgroundColors,u=t.bold,c=t.italic,d=t.underline,f=o&&r&&(i||a)?null:y.getComputedStyles(e);return{fontFamily:o||f[0],fontSize:r||f[1],get textColor(){return a?n?a.darkModeColor:a.lightModeColor:i||f[2]},textColors:a,get backgroundColor(){return l?n?l.darkModeColor:l.lightModeColor:s||""},backgroundColors:l,bold:u,italic:c,underline:d}}function S(e){return{attachDomEvent:(e=e||{}).attachDomEvent||o.default,editWithUndo:e.editWithUndo||a.default,focus:e.focus||l.default,getCustomData:e.getCustomData||u.default,getSelectionRange:e.getSelectionRange||c.default,hasFocus:e.hasFocus||d.default,insertNode:e.insertNode||f.default,select:e.select||h.select,selectRange:e.selectRange||h.default,triggerEvent:e.triggerEvent||g.default}}t.default=function(e,t){var n={undo:t.undo||new m.default,edit:new i.default,typeInContainer:new v.default,mouseUp:new p.default,domEvent:new r.default(t.disableRestoreSelectionOnFocus),firefoxTypeAfterLink:y.Browser.isFirefox&&new s.default},o=[n.typeInContainer,n.edit,n.mouseUp].concat(t.plugins||[],[n.firefoxTypeAfterLink,n.undo,n.domEvent]).filter(function(e){return!!e}),a=o.filter(function(e){return e.onPluginEvent||e.willHandleEventExclusively});return{contentDiv:e,document:e.ownerDocument,defaultFormat:C(e,t.defaultFormat,t.inDarkMode),corePlugins:n,currentUndoSnapshot:null,customData:{},cachedSelectionRange:null,plugins:o,eventHandlerPlugins:a,api:S(t.coreApiOverride),defaultApi:S(),inDarkMode:t.inDarkMode,darkModeOptions:t.darkModeOptions}},t.calcDefaultFormat=C},5518:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n,o){var r=function(t){var r;"keydown"!=(r=t).type&&"keypress"!=r.type&&"keyup"!=r.type||t.ctrlKey||t.altKey||t.metaKey||!t.key||1!=t.key.length||t.stopPropagation(),o&&o(t),null!=n&&e.api.triggerEvent(e,{eventType:n,rawEvent:t},!1)};return e.contentDiv.addEventListener(t,r),function(){e.contentDiv.removeEventListener(t,r)}}},5519:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e,t,n){var r,i=null!==e.currentUndoSnapshot;i||(e.currentUndoSnapshot=e.corePlugins.undo.addUndoSnapshot());try{if(t){var a=e.api.getSelectionRange(e,!0);r=t(a&&o.Position.getStart(a).normalize(),a&&o.Position.getEnd(a).normalize(),e.currentUndoSnapshot),i||e.corePlugins.undo.addUndoSnapshot()}}finally{i||(e.currentUndoSnapshot=null)}if(t&&n){var s={eventType:6,source:n,data:r};e.api.triggerEvent(e,s,!0)}}},5520:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.cachedSelectionRange&&e.api.selectRange(e,e.cachedSelectionRange,!0))){var t=o.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,o.createRange(t,0),!0)}e.cachedSelectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}},5521:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n,o){return(e.customData[t]=e.customData[t]||{value:n(),disposer:o}).value}},5522:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e,t){var n=null;if(!t||e.api.hasFocus(e)){var r=e.document.defaultView.getSelection();if(r&&r.rangeCount>0){var i=r.getRangeAt(0);o.contains(e.contentDiv,i)&&(n=i)}}return!n&&t&&(n=e.cachedSelectionRange),n}},5523:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e,t,n){n=n||{position:2,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var r=e.contentDiv;switch(n.updateCursor&&e.api.focus(e),n.position){case 0:case 1:var i=0==n.position,a=o.getFirstLastBlockElement(r,i),s=void 0;if(a){var l=i?a.getStartNode():a.getEndNode();s=n.insertOnNewLine||3==l.nodeType||o.isVoidHtmlElement(l)?l.parentNode.insertBefore(t,i?l:l.nextSibling):l.insertBefore(t,i?l.firstChild:null)}else s=r.appendChild(t);s&&n.insertOnNewLine&&!o.isBlockElement(s)&&o.wrap(s);break;case 4:case 2:var u=function(e,t){var n=e.api.getSelectionRange(e,!0),o=null;return 4==t.position?(o=n,n=t.range):n&&(o=n.cloneRange()),{range:n,rangeToRestore:o}}(e,n),c=u.range,d=u.rangeToRestore;if(!c)return;n.replaceSelection&&!c.collapsed&&c.deleteContents();var f=o.Position.getStart(c),p=void 0;f=n.insertOnNewLine&&(p=o.getBlockElementAtNode(r,f.normalize().node))?new o.Position(p.getEndNode(),-3):o.adjustNodeInsertPosition(r,t,f);var h=11==t.nodeType?t.lastChild:t;(c=o.createRange(f)).insertNode(t),n.updateCursor&&h&&(d=o.createRange(new o.Position(h,-3).normalize())),e.api.selectRange(e,d);break;case 3:e.contentDiv.parentNode.insertBefore(t,r.nextSibling)}return!0}},5524:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4508),r=n(1931);t.default=function(e,t,n){if(r.contains(e.contentDiv,t)){var i=e.document.defaultView.getSelection();if(i){var a=!0;if(i.rangeCount>0)try{var s=void 0;(n||r.Browser.isEdge)&&(s=1==i.rangeCount?i.getRangeAt(0):null)&&s.startContainer==t.startContainer&&s.startOffset==t.startOffset&&s.endContainer==t.endContainer&&s.endOffset==t.endOffset?a=!1:i.removeAllRanges()}catch(e){}return a&&i.addRange(t),o.default(e)||(e.cachedSelectionRange=t),!0}}return!1},t.select=function(e,t,n,o,i){var a=t instanceof Range?t:r.createRange(t,n,o,i);return e.api.selectRange(e,a)}},5525:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n){!n&&e.eventHandlerPlugins.some(function(e){return function(e,t){return!!(t.onPluginEvent&&t.willHandleEventExclusively&&t.willHandleEventExclusively(e))&&(t.onPluginEvent(e),!0)}(t,e)})||e.eventHandlerPlugins.forEach(function(e){e.onPluginEvent&&e.onPluginEvent(t)})}},5526:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=1e7,r=function(){function e(e){void 0===e&&(e=o),this.maxSize=e,this.snapshots=[],this.totalSize=0,this.currentIndex=-1}return e.prototype.canMove=function(e){var t=this.currentIndex+e;return t>=0&&t<this.snapshots.length},e.prototype.move=function(e){return this.canMove(e)?(this.currentIndex+=e,this.snapshots[this.currentIndex]):null},e.prototype.addSnapshot=function(e){if(this.currentIndex<0||e!=this.snapshots[this.currentIndex]){this.clearRedo(),this.snapshots.push(e),this.currentIndex++,this.totalSize+=e.length;for(var t=0;t<this.snapshots.length&&this.totalSize>this.maxSize;)this.totalSize-=this.snapshots[t].length,t++;t>0&&(this.snapshots.splice(0,t),this.currentIndex-=t)}},e.prototype.clearRedo=function(){if(this.canMove(1)){for(var e=0,t=this.currentIndex+1;t<this.snapshots.length;t++)e+=this.snapshots[t].length;this.snapshots.splice(this.currentIndex+1),this.totalSize-=e}},e}();t.default=r},5527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5528);t.DocumentCommand=o.DocumentCommand;var r=n(5529);t.DocumentPosition=r.DocumentPosition;var i=n(5530);t.NodeType=i.NodeType;var a=n(5531);t.DARK_MODE_DEFAULT_FORMAT=a.DARK_MODE_DEFAULT_FORMAT;var s=n(5532);t.Alignment=s.Alignment;var l=n(5533);t.ChangeSource=l.ChangeSource;var u=n(5534);t.ContentPosition=u.ContentPosition;var c=n(5535);t.Direction=c.Direction;var d=n(5536);t.FontSizeChange=d.FontSizeChange;var f=n(5537);t.Indentation=f.Indentation;var p=n(5538);t.PasteOption=p.PasteOption;var h=n(5539);t.PositionType=h.PositionType;var g=n(5540);t.QueryScope=g.QueryScope;var v=n(5541);t.TableOperation=v.TableOperation;var m=n(5542);t.PluginEventType=m.PluginEventType},5528:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BackColor="backColor",e.Bold="bold",e.ClearAuthenticationCache="ClearAuthenticationCache",e.ContentReadOnly="contentReadOnly",e.Copy="copy",e.CreateLink="createLink",e.Cut="cut",e.DecreaseFontSize="decreaseFontSize",e.DefaultParagraphSeparator="defaultParagraphSeparator",e.Delete="delete",e.EnableInlineTableEditing="enableInlineTableEditing",e.EnableObjectResizing="enableObjectResizing",e.FontName="fontName",e.FontSize="fontSize",e.ForeColor="foreColor",e.FormatBlock="formatBlock",e.ForwardDelete="forwardDelete",e.Heading="heading",e.HiliteColor="hiliteColor",e.IncreaseFontSize="increaseFontSize",e.Indent="indent",e.InsertBrOnReturn="insertBrOnReturn",e.InsertHorizontalRule="insertHorizontalRule",e.InsertHTML="insertHTML",e.InsertImage="insertImage",e.InsertOrderedList="insertOrderedList",e.InsertUnorderedList="insertUnorderedList",e.InsertParagraph="insertParagraph",e.InsertText="insertText",e.Italic="italic",e.JustifyCenter="justifyCenter",e.JustifyFull="justifyFull",e.JustifyLeft="justifyLeft",e.JustifyRight="justifyRight",e.Outdent="outdent",e.Paste="paste",e.Redo="redo",e.RemoveFormat="removeFormat",e.SelectAll="selectAll",e.StrikeThrough="strikeThrough",e.Subscript="subscript",e.Superscript="superscript",e.Underline="underline",e.Undo="undo",e.Unlink="unlink",e.StyleWithCSS="styleWithCSS"}(t.DocumentCommand||(t.DocumentCommand={}))},5529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Same=0]="Same",e[e.Disconnected=1]="Disconnected",e[e.Preceding=2]="Preceding",e[e.Following=4]="Following",e[e.Contains=8]="Contains",e[e.ContainedBy=16]="ContainedBy"}(t.DocumentPosition||(t.DocumentPosition={}))},5530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Element=1]="Element",e[e.Text=3]="Text",e[e.ProcessingInstruction=7]="ProcessingInstruction",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment"}(t.NodeType||(t.NodeType={}))},5531:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DARK_MODE_DEFAULT_FORMAT={backgroundColors:{darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},textColors:{darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"}}},5532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.Alignment||(t.Alignment={}))},5533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.AutoLink="AutoLink",e.CreateLink="CreateLink",e.Format="Format",e.ImageResize="ImageResize",e.Paste="Paste",e.SetContent="SetContent",e.Cut="Cut",e.Drop="Drop"}(t.ChangeSource||(t.ChangeSource={}))},5534:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Begin=0]="Begin",e[e.End=1]="End",e[e.SelectionStart=2]="SelectionStart",e[e.Outside=3]="Outside",e[e.Range=4]="Range"}(t.ContentPosition||(t.ContentPosition={}))},5535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(t.Direction||(t.Direction={}))},5536:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.FontSizeChange||(t.FontSizeChange={}))},5537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.Indentation||(t.Indentation={}))},5538:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.PasteHtml=0]="PasteHtml",e[e.PasteText=1]="PasteText",e[e.PasteImage=2]="PasteImage"}(t.PasteOption||(t.PasteOption={}))},5539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Begin=0]="Begin",e[e.End=-1]="End",e[e.Before=-2]="Before",e[e.After=-3]="After"}(t.PositionType||(t.PositionType={}))},5540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Body=0]="Body",e[e.OnSelection=1]="OnSelection",e[e.InSelection=2]="InSelection"}(t.QueryScope||(t.QueryScope={}))},5541:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.InsertAbove=0]="InsertAbove",e[e.InsertBelow=1]="InsertBelow",e[e.InsertLeft=2]="InsertLeft",e[e.InsertRight=3]="InsertRight",e[e.DeleteTable=4]="DeleteTable",e[e.DeleteColumn=5]="DeleteColumn",e[e.DeleteRow=6]="DeleteRow",e[e.MergeAbove=7]="MergeAbove",e[e.MergeBelow=8]="MergeBelow",e[e.MergeLeft=9]="MergeLeft",e[e.MergeRight=10]="MergeRight",e[e.SplitHorizontally=11]="SplitHorizontally",e[e.SplitVertically=12]="SplitVertically"}(t.TableOperation||(t.TableOperation={}))},5542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.KeyDown=0]="KeyDown",e[e.KeyPress=1]="KeyPress",e[e.KeyUp=2]="KeyUp",e[e.CompositionEnd=3]="CompositionEnd",e[e.MouseDown=4]="MouseDown",e[e.MouseUp=5]="MouseUp",e[e.ContentChanged=6]="ContentChanged",e[e.ExtractContent=7]="ExtractContent",e[e.BeforePaste=8]="BeforePaste",e[e.EditorReady=9]="EditorReady",e[e.BeforeDispose=10]="BeforeDispose",e[e.Input=11]="Input"}(t.PluginEventType||(t.PluginEventType={}))},5543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4130),r="GET_ELEMENT_AT_CURSOR_";t.default=function(e,t,n){return o.default(t,r+n,function(){return e.getElementAtCursor(n)})}},5544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3428),r=n(1931);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];var i=1,a=1e3;function s(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var o=n[n.length-1];if(e<=n[0])e=Math.max(e+t,i);else if(e>o||e==o&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),o),a);else if(1==t){for(var r=0;r<n.length;r++)if(e<n[r]){e=n[r];break}}else for(r=n.length-1;r>=0;r--)if(e>n[r]){e=n[r];break}return e}t.default=function(e,n,i){void 0===i&&(i=t.FONT_SIZES);var a=0==n?1:-1;o.default(e,function(e){var t=parseFloat(r.getComputedStyle(e,"font-size"));e.style.fontSize=s(t,a,i)+"pt","normal"!=r.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")})},t.getNewFontSize=s},5545:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4512),r=n(1931);function i(e,t){return e.indexOf(r.getTagOfNode(t))<0}t.TAGS_TO_UNWRAP="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),t.TAGS_TO_STOP_UNWRAP=["TD","TH","TR","TABLE","TBODY","THEAD"],t.ATTRIBUTES_TO_PRESERVE=["href"],t.default=function(e,n,a,s){void 0===n&&(n=t.TAGS_TO_UNWRAP),void 0===a&&(a=t.TAGS_TO_STOP_UNWRAP),void 0===s&&(s=t.ATTRIBUTES_TO_PRESERVE),e.focus(),e.addUndoSnapshot(function(t,l){var u=[{}],c=a.join(",");o.default(e,function(t){var n=u[u.length-1],o=e.getElementAtCursor(c,t);o!=n.td&&n.first&&u.push(n={}),n.td=o,n.first=n.first||t,n.last=t}),u.filter(function(e){return e.first}).forEach(function(t){var o=e.collapseNodes(t.first,t.last,!0);if(i(a,o[0]))for(;e.contains(o[0].parentNode)&&i(a,o[0].parentNode);)o=[r.splitBalancedNodeRange(o)];if(o.forEach(function(e){return function e(t,n,o,a){if(1!=t.nodeType||"BR"==r.getTagOfNode(t))return!1;var s=[].slice.call(t.childNodes).map(function(t){return e(t,n,o,a)}).reduce(function(e,t){return e&&t},!0);if(!i(o,t))return!1;var l=r.isBlockElement(t);return n.indexOf(r.getTagOfNode(t))>=0||s?(l&&!s&&r.wrap(t),r.unwrap(t)):function(e,t){for(var n=0,o=[].slice.call(e.attributes);n<o.length;n++){var r=o[n];t.indexOf(r.name.toLowerCase())<0&&e.removeAttribute(r.name)}}(t,a),l}(e,n,a,s)}),t.td){var l=t.td.getAttribute("style")||"",u=l.split(";");(l=(u=u.filter(function(e){return 0==e.trim().toLowerCase().indexOf("border")})).join(";"))?t.td.setAttribute("style",l):t.td.removeAttribute("style")}}),e.select(t,l)},"Format")}},5546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774),r=n(4513),i=n(4514),a=n(4515),s=n(4516),l=n(4517),u=n(4518),c=n(4519),d=["font","text-decoration","color","background"];t.default=function(e){e.focus(),e.addUndoSnapshot(function(){o.default(e,"removeFormat"),e.queryElements("[class]",1,function(e){return e.removeAttribute("class")});var t=e.getDefaultFormat(),n=0===Object.keys(t).length;e.queryElements("[style]",2,function(e){d.forEach(function(t){return e.style.removeProperty(t)}),n&&""===e.getAttribute("style")&&e.removeAttribute("style")}),n||(t.fontFamily&&i.default(e,t.fontFamily),t.fontSize&&a.default(e,t.fontSize),t.textColor&&(t.textColors?s.default(e,t.textColors):s.default(e,t.textColor)),t.backgroundColor&&(t.backgroundColors?r.default(e,t.backgroundColors):r.default(e,t.backgroundColor)),t.bold&&l.default(e),t.italic&&u.default(e),t.underline&&c.default(e))},"Format")}},5547:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931),r=/^[a-zA-Z]+:/i,i=/^[\w.%+-]+@/i,a=/^ftp\./i,s="istemptitle";function l(e){return e.queryElements("a[href]",1)[0]}function u(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,c){e.focus();var d=t?t.trim():"";if(d){var f=o.matchLink(d),p=f?f.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(r)<0&&(t=0==e.search(i)?"mailto:":0==e.search(a)?"ftp://":"http://"),t+e}(d),h=f?f.originalUrl:d;e.addUndoSnapshot(function(){var t=e.getSelectionRange(),o=null;return t&&t.collapsed?(o=l(e))?(o.href=p,u(o,c)):((o=e.getDocument().createElement("A")).textContent=c||h,o.href=p,e.insertNode(o)):(e.getDocument().execCommand("createLink",!1,p),u(o=l(e),c)),n&&o&&(o.removeAttribute(s),o.title=n),o},"CreateLink")}}},5548:function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(2079),i=n(1931),a={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"};function s(e){return Object.keys(a).reduce(function(t,n){return t[n]=e.queryCommandState(a[n]),t},{})}function l(e,t){var n=i.getTagOfNode(r.cacheGetElementAtCursor(e,t,"OL,UL")),o=i.getTagOfNode(r.cacheGetElementAtCursor(e,t,"H1,H2,H3,H4,H5,H6"));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:o&&parseInt(o[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}function u(e){var t=e.getSelectionRange(),n=t&&i.Position.getStart(t).normalize().node,o=n?i.getComputedStyles(n):[];return{fontName:o[0],fontSize:o[1],textColor:o[2],backgroundColor:o[3]}}t.getPendableFormatState=s,t.getElementBasedFormatState=l,t.getStyleBasedFormatState=u,t.default=function(e,t){return o({},s(e.getDocument()),l(e,t),u(e),{canUndo:e.canUndo(),canRedo:e.canRedo()})}},5549:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=new FileReader;n.onload=function(t){e.isDisposed()||e.addUndoSnapshot(function(){var n=e.getDocument().createElement("img");n.src=t.target.result,n.style.maxWidth="100%",e.insertNode(n)},"Format")},n.readAsDataURL(t)}},5550:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);function r(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,i){var a=e.getDocument(),s=a.createDocumentFragment(),l=a.createElement("table");s.appendChild(l),l.cellSpacing="0",l.cellPadding="1";for(var u=0;u<n;u++){var c=a.createElement("tr");l.appendChild(c);for(var d=0;d<t;d++){var f=a.createElement("td");c.appendChild(f),f.appendChild(a.createElement("br")),f.style.width=r(t)}}e.focus(),e.addUndoSnapshot(function(){var t=new o.VTable(l);t.applyFormat(i||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(s),e.runAsync(function(){return e.select(new o.Position(l,0).normalize())})},"Format")}},5551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot(function(r,i){var a=new o.VTable(n);a.edit(t),a.writeBack(),e.focus(),e.select(r,i)||e.select(e.contains(n)?n:a.getCurrentTd())},"Format")}},5552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot(function(r,i){var a=new o.VTable(n);a.applyFormat(t),a.writeBack(),e.focus(),e.select(r,i)},"Format")}},5553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e){e.focus(),e.addUndoSnapshot(function(t,n){e.queryElements("a[href]",1,o.unwrap),e.select(t,n)},"Format")}},5554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,r){if(!t||!n)return!1;var i;if(i="string"==typeof t?(r=r||e.getContentSearcherOfCursor())&&r.getRangeFromText(t,o):t){var a=e.getSelectionRange();return a.collapsed&&i.endContainer==a.startContainer&&i.endOffset==a.startOffset&&(o=!0),e.insertNode(n,{position:4,updateCursor:o,replaceSelection:!0,insertOnNewLine:!1,range:i}),!0}return!1}},5555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774);t.default=function(e,t){var n="justifyLeft",r="left";1==t?(n="justifyCenter",r="center"):2==t&&(n="justifyRight",r="right"),e.addUndoSnapshot(function(){o.default(e,n),e.queryElements("[align]",1,function(e){return e.style.textAlign=r})},"Format")}},5556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4512);t.default=function(e,t){e.focus(),e.addUndoSnapshot(function(n,r){o.default(e,function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"}),e.select(n,r)},"Format")}},5557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot(function(){e.queryElements("img",1,function(e){return e.setAttribute("alt",t)})},"Format")}},5558:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4131);t.default=function(e,t){var n=0==t?"indent":"outdent";e.addUndoSnapshot(function(){var t;return e.focus(),e.getElementAtCursor("OL,UL")?t=o.default(e,n):(e.getDocument().execCommand(n,!1,null),e.queryElements("BLOCKQUOTE",1,function(e){t=t||e,e.style.marginTop="0px",e.style.marginBottom="0px"})),t},"Format")}},5559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4131);t.default=function(e){e.focus(),e.addUndoSnapshot(function(){return o.default(e,"insertUnorderedList")},"Format")}},5560:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4131);t.default=function(e){e.focus(),e.addUndoSnapshot(function(){return o.default(e,"insertOrderedList")},"Format")}},5561:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4520),r="blockquote",i=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){o.default(e,r,t||i)}},5562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4520),r=n(1931),i="pre",a="code",s="CODE";function l(e){var t=r.wrap(e,a);return r.wrap(t,i)}function u(e){if(!e)return null;var t=e.childNodes[0];return 1==e.childNodes.length&&r.getTagOfNode(t)==s&&r.unwrap(t),r.unwrap(e)}t.default=function(e,t){o.default(e,i,t,l,u)}},5563:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774);t.default=function(e){o.default(e,"strikeThrough")}},5564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774);t.default=function(e){o.default(e,"subscript")}},5565:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2774);t.default=function(e){o.default(e,"superscript")}},5566:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1931);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot(function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);for(var o=e.getDocument().createElement("div");t.firstChild;)o.appendChild(t.firstChild);e.replaceNode(t,o)}),t>0){for(var r=e.getSelectionTraverser(),i=r?r.currentInlineElement:null;i;){var a=o.findClosestElementAncestor(i.getContainerNode());a&&(a.style.fontSize=""),i=r.getNextInlineElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}},"Format")}}}]);
//# sourceMappingURL=owa.vendors~CortanaCompose~EmojiPickerPlugin~HtmlEditor~MeetingMessage.mail.js.map
window.scriptsLoaded['owa.vendors~CortanaCompose~EmojiPickerPlugin~HtmlEditor~MeetingMessage.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.vendors~CortanaCompose~EmojiPickerPlugin~HtmlEditor~MeetingMessage.mail.js'] = (new Date()).getTime();