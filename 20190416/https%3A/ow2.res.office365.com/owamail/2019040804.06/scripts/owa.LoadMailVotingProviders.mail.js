window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.LoadMailVotingProviders.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[160],{1582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=n(1742);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("CreateItem",e,t)}},1593:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateItemRequest:#Exchange"},e)}},1742:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"CreateItemJsonRequest:#Exchange"},e)}},4823:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"VotingResponseItem:#Exchange"},e)}},6986:function(e,t,n){"use strict";n.r(t);var r=n(1),o=Object(r.action)("setVotingOptions",function(e){return{votingOptions:e}}),a=Object(r.action)("setReferenceItemId",function(e){return{referenceItemId:e}}),i=Object(r.action)("resetVotingStore"),c=Object(r.action)("castVoteForProvider",function(e){return{infoBarOption:e}}),s=n(938),u=(Object(r.mutator)(o,function(e){var t=Object(s.a)();t&&(t.options=e.votingOptions)}),Object(r.mutator)(a,function(e){var t=Object(s.a)();t&&(t.referenceItemId=e.referenceItemId)}),Object(r.action)("loadVotingOptions",function(e){return{messageId:e}})),d=Object(r.action)("getItemVotingAndModerationData",function(e){return{message:e}}),f=Object(r.action)("setItemVotingAndModerationData",function(e,t,n){return{messageId:e,votingInformation:t,approvalRequestData:n}}),v=Object(r.action)("getConversationVotingAndModerationData",function(e,t){return{conversationNodes:e,conversationSortOrder:t}}),m=Object(r.action)("castVote",function(e){return{votingResponse:e}}),p=n(22),O=(Object(r.mutator)(f,function(e){var t=Object(p.c)().items.get(e.messageId);t&&(t.VotingInformation=e.votingInformation,t.ApprovalRequestData=e.approvalRequestData)}),n(592)),I=(Object(r.mutator)(i,function(e){var t=Object(s.a)();t&&(t.options=void 0,t.activeProviders=[O.a],t.referenceItemId=void 0)}),n(1128)),g=n(13),l=(Object(r.orchestrator)(u,function(e){var t=!1,n=Object(s.a)(),r=e.messageId,c=Object(g.q)().items.get(r);n.referenceItemId&&n.referenceItemId.Id!=r&&i();for(var u=Object(I.a)(),d=0;d<u.length;d++)if(u[d].provider==O.a){t=!0;break}if((void 0===n.options||!t)&&c){var f=c.VotingInformation;f&&f.UserOptions&&f.UserOptions.forEach(function(e){var t={displayName:e.DisplayName,provider:O.a};u.push(t)}),o(u),a(c.ItemId)}}),n(0)),b=n(351),j=n(352),_=n(187),h=n.n(_),V=n(33),y=n.n(V);function R(e){return l.__awaiter(this,void 0,void 0,function(){var t;return l.__generator(this,function(n){switch(n.label){case 0:return[4,Object(b.a)([e],h()({BaseShape:"IdOnly",AdditionalProperties:[y()({FieldURI:"VotingInformation"}),y()({FieldURI:"ApprovalRequestData"})]}),null)];case 1:return t=n.sent(),[2,(r=t,Object(j.a)(r[0])?r[0].Items[0]:{})]}var r})})}Object(r.orchestrator)(d,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r,o;return l.__generator(this,function(a){switch(a.label){case 0:t=e.message.ItemId.Id,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,R(t)];case 2:return(n=a.sent())&&(r=n.VotingInformation,o=n.ApprovalRequestData,f(t,r,o)),[3,4];case 3:return a.sent(),[3,4];case 4:return[2]}})})});var w=n(5),D=(Object(r.orchestrator)(v,function(e){return l.__awaiter(void 0,void 0,void 0,function(){return l.__generator(this,function(t){return Object(w.d)("mc-voting")&&Object(g.k)(e.conversationNodes,e.conversationSortOrder).Items.forEach(function(e){d(e)}),[2]})})}),n(4823)),A=n.n(D),P=n(1582),q=n.n(P),C=n(1593),M=n.n(C),S=n(31),E=n(7);function F(e,t){var n=A()({Response:e,ReferenceItemId:t}),r=Object(E.a)().UserOptions.TimeFormat,o=M()({ClientSupportsIrm:!0,ComposeOperation:null,MessageDisposition:"SendAndSaveCopy",OutboundCharset:"AutoDetect",Items:[n],TimeFormat:r});return q()({Header:Object(S.getJsonRequestHeader)(),Body:o}).then(function(e){return e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout"))})}var B=n(11),N=(Object(r.orchestrator)(m,function(e){return l.__awaiter(void 0,void 0,void 0,function(){var t,n,r;return l.__generator(this,function(o){switch(o.label){case 0:t=e.votingResponse,n=Object(s.a)().referenceItemId,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,F(t,n)];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),B.c.error("Cannot create voting response item. "+r.message),[3,4];case 4:return[2]}})})}),{name:O.a,loadOptions:function(e){return u(e)},castVote:function(e){return m(e)}});function U(e){switch(e){case O.a:default:return N}}Object(r.orchestrator)(c,function(e){var t=e.infoBarOption.value,n=U(t.provider),r=t.displayName,o=Object(s.a)().referenceItemId;o&&n.castVote(r,o.Id)});function k(e){Object(s.a)().activeProviders.forEach(function(t){U(t).loadOptions(e)})}n.d(t,"loadActiveVotingProviders",function(){return k}),n.d(t,"getItemVotingAndModerationData",function(){return d}),n.d(t,"getConversationVotingAndModerationData",function(){return v}),n.d(t,"castVoteForProvider",function(){return c})}},0,[279,51,280,57,283,80]]);
//# sourceMappingURL=owa.LoadMailVotingProviders.mail.js.map
window.scriptsLoaded['owa.LoadMailVotingProviders.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.LoadMailVotingProviders.mail.js'] = (new Date()).getTime();