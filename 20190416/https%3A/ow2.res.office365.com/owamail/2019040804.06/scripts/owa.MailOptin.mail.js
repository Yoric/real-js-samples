window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.MailOptin.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[174],{1589:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(1750);t.default=function(e,t){if(void 0!==e.datapoints)for(var n=0;n<e.datapoints.length;n++)void 0===e.datapoints[n]||e.datapoints[n].__type||(e.datapoints[n]=i.default(e.datapoints[n]));return r.makeServiceRequest("LogDatapoint",e,t)}},1750:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"Datapoint:#Exchange"},e)}},1789:function(e,t,n){"use strict";n.r(t);var r=n(3500),i=n(5),o=n(2277);function a(){Object(r.d)(),Object(r.e)()&&Object(o.d)(),Object(r.e)()&&Object(i.d)("addin-persistentTaskPane")&&Object(o.e)(),Object(r.a)(window),Object(r.c)(window),Object(r.b)(window)}n.d(t,"initializeMailOptinService",function(){return a})},2277:function(e,t,n){"use strict";var r=n(185),i=n(2),o=n(2910),a=n(8),u=n.n(a);var c=n(63),d=n(496);function s(e){if(!e)return!1;if(function(e){return null!=e.RightsManagementLicenseData}(e))return!1;if(e.IsDraft)return!1;if(Object(d.a)()&&e.MailboxInfo&&e.MailboxInfo.type===c.a.GroupMailbox)return!1;var t=e.ItemClass.toLowerCase();return!function(e){return 0==e.indexOf("ipm.note.smime")&&-1==e.indexOf("ipm.note.smime.multipartsigned")}(t)&&!function(e){return 0==e.indexOf("report")}(t)}var l=n(356);function f(e){l.c.import().then(function(t){t().then(e)})}var p=n(56),b=n(89),m=n(12),v=n(217),O="ows/api/beta/Addins/PinAddins";function h(){var e=Object(b.a)(),t=new m.a("ExtPinRequest");Object(p.d)(O,{correlationId:e,defaults:Object(v.b)()[v.a.SurfaceActions]},e,!0).then(function(n){t.addCustomData([e,n.status]),200==n.status&&n.text().then(function(e){v.d.importAndExecute(v.a.SurfaceActions,JSON.parse(e))}),t.end()}).catch(function(){t.end()})}var I,g,y=n(0),j=n(161),C=n(7);!function(e){e[e.None=0]="None",e[e.Compose=1]="Compose",e[e.Read=2]="Read"}(g||(g={}));var w=((I={})[g.None]="NoAddins",I[g.Compose]="ComposeAddinOnly",I[g.Read]="ReadAddinOnly",I[g.Compose|g.Read]="BothAddins",I);function _(e){var t=JSON.parse(e);return{addinId:t.id,commandId:t.controlId}}function T(){return y.__awaiter(this,void 0,void 0,function(){var e,t,n,i,o,a,u;return y.__generator(this,function(c){switch(c.label){case 0:return e=Object(C.a)().ViewStateConfiguration,[4,r.C.import()];case 1:return t=c.sent(),n=g.None,(i=e.PinnedComposeAddin)&&(o=_(i),t(j.a.MessageCompose,o),n|=g.Compose),(a=e.PinnedReadAddin)&&(u=_(a),t(j.a.MessageRead,u),n|=g.Read),Object(m.k)("ExtPersistedAddinMigration",[w[n]]),[2]}})})}var A=n(5);function E(e,t){return void 0===t&&(t=null),y.__awaiter(this,void 0,void 0,function(){return y.__generator(this,function(n){switch(n.label){case 0:return Object(A.d)("rp-addins")&&Object(A.d)("addin-persistentTaskPane")?[4,r.z.import()]:[3,2];case 1:n.sent()(e,t),n.label=2;case 2:return[2]}})})}var P=n(39);function R(){Object(P.p)()?E(r.g.NotSupported):E(r.g.Empty)}n.d(t,"c",function(){return M}),n.d(t,"b",function(){return S}),n.d(t,"a",function(){return L}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return f}),n.d(t,"d",function(){return h}),n.d(t,"e",function(){return T}),n.d(t,"h",function(){return E}),n.d(t,"i",function(){return R});var x=new i.c(function(){return Promise.all([n.e(0),n.e(5),n.e(35),n.e(36),n.e(52)]).then(n.bind(null,6960))}),M=new i.b(x,function(e){return e.hasInlineImage}),S=new i.b(x,function(e){return e.createMailReadAdapter}),L=new i.b(x,function(e){return e.createMailComposeAdapter});r.h.sendFeedback=function(){var e=[{Name:u.a.sendFeedbackDialogTitle,EmailAddress:"outlookinclientstorefeedback@service.microsoft.com"}];o.a(e,[],[],u.a.sendFeedbackEmailSubject,u.a.sendFeedbackEmailContentStart,[])}},2573:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return s});var r=n(2909),i=n(7),o="OptInPrg";function a(){return c(2)}function u(){return c(1)}function c(e){return Object(r.a)(o)==""+e}function d(e){s(1);var t=Object(i.a)().SessionSettings.WebSessionType,n="/owa/",r=[];t&&r.push("isc="+t),e&&r.push(e),r.length>0&&(n=n+"?"+r.join("&")),location.assign(n)}function s(e){null==e?Object(r.b)(o):Object(r.b)(o,""+e,{path:"/"})}},2737:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),i=n(185),o=n(697),a=n(868);function u(e){var t,n,u=[];try{for(var c=r.__values(e),d=c.next();!d.done;d=c.next()){var s=d.value,l=null;s.attachmentType==i.i.Item?l={fileType:o.a.MailItem,name:s.name,size:s.size,itemId:s.id}:s.attachmentType==i.i.File&&(l={fileType:o.a.Uri,name:s.name,size:s.size,uri:s.id,type:Object(a.a)(s.id)}),l&&u.push({file:l,isInline:s.isInline})}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return u}},2909:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o});var r=n(1343);function i(e){return r.get(e)}function o(e,t,n){t?r.set(e,t,n):r.remove(e)}},2910:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2737),i=n(5),o=n(66);function a(e,t,n,a,u,c){if(Object(i.d)("rp-popouts")){var d={operation:0,bodyType:"HTML",subject:a,newContent:u,to:e,cc:t,bcc:n,preferAsyncSend:!0},s=Object(r.a)(c);o.t.importAndExecute(d,o.a.Popout,null,s)}}},3500:function(e,t,n){"use strict";var r=n(12),i=n(3789),o=n.n(i),a=n(2573),u=2,c=1e4,d=0;function s(e){Object(a.b)()&&(Object(a.d)(0),e.addEventListener("unload",function(){Object(a.a)()||Object(a.d)(null)}),Object(r.k)("optInReactClient"),function e(t){o()({clientTypeOptInState:2}).then(function(e){Object(a.d)(null)}).catch(function(n){d++<u&&t.setTimeout(function(){e(t)},c)})}(e))}var l=n(2909),f="appcacheuninstaller",p="owa/manifests/appCacheManifestHandler.ashx",b="?manifest=0&layout=mouse&UA=0",m="UnInstallAppcache",v="AppcacheObsolete",O=null;function h(e){var t,n;e.applicationCache&&(function(e){var t=null;null!=e.localStorage&&(t=e.localStorage.getItem(v));return t}(e)||((O=e.document.createElement("iframe")).src=(t=e.location.href,(n=new URL(t)).pathname=p,n.search=b,n.href),O.setAttribute("id",f),O.style.display="none",O.onload=function(){O.onload=null;try{!function(e){var t=O.contentWindow.applicationCache;t.onobsolete=function(){g(e),I(t)},t.onerror=function(){g(e),I(t)}}(e)}catch(t){g(e)}},Object(l.b)(m,"true",{path:"/"}),e.document.body.appendChild(O)))}function I(e){e.onerror=null,e.onobsolete=null}function g(e){!function(e){if(null!=e.localStorage)try{e.localStorage.setItem(v,"1")}catch(e){}}(e),Object(l.b)(m),e.document.body.removeChild(O),O=null}function y(e){var t=e.navigator.serviceWorker;null!=t&&null!=t.controller&&t.getRegistrations().then(function(t){for(var n=e.location.origin+"/",r=0;r<t.length;++r)n.toLowerCase()==t[r].scope.toLowerCase()&&t[r].unregister()})}var j=n(3790),C=n.n(j),w=n(1589),_=n.n(w),T=69,A=75,E=1,P="ReOptInClk",R="CalReOptInClk";function x(){if(Object(a.b)()){var e=0;M(T,P)&&(e=T),M(A,R)&&(e=A),Object(r.k)("cleanupOptInCallout",[e])}}function M(e,t){var n=!1;return Object(l.a)(t)&&(n=!0,_()({datapoints:[{Id:"PerfTraceCTQ",Consumers:1,Time:new Date(Date.now()).toISOString(),Keys:["S","cd"],Values:["lightningPeekMore","id_"+e+"|category_4"]}]}),Object(l.b)(t)),C()({Identities:[e],Command:E}),n}n.d(t,"a",function(){return s}),n.d(t,"b",function(){return h}),n.d(t,"c",function(){return y}),n.d(t,"d",function(){return x}),n.d(t,"e",function(){return a.b}),n.d(t,"f",function(){return a.c})},3789:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51);t.default=function(e,t){return r.makeServiceRequest("UpdateClientTypeOptInState",e,t)}},3790:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),i=n(3791);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("UpdateLightning",e,t)}},3791:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateLightningRequest:#Exchange"},e)}},697:function(e,t,n){"use strict";var r;!function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem"}(r||(r={}));var i={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function o(e){switch(e?e.toLowerCase():null){case i.ONE_DRIVE_PRO.toLowerCase():return 0;case i.GDRIVE.toLowerCase():return 5;case i.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case i.DROPBOX.toLowerCase():return 2;case i.BOX.toLowerCase():return 3;case i.WOPI_BOX.toLowerCase():return 7;case i.WOPI_EGNYTE.toLowerCase():return 8;case i.MAILBOX.toLowerCase():return 4;case i.FACEBOOK.toLowerCase():return 6;default:return null}}function a(e){return null==e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}function u(e){return null==e?null:{fileType:r.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:e.Thumbnail?e.Thumbnail.Url:"",previewUrl:e.Preview?e.Preview.Url:"",type:e.MimeType}}function c(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],o={fileType:r.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(o)}return t}function d(e,t){var n=[],i={fileType:r.MailItem,name:e,size:0,mimeContent:t};return n.push(i),n}var s=n(11);function l(e,t){if(e.length!=t.length)return s.c.error("The sizes of subjects and latestItemIds are different"),null;for(var n=[],i=0;i<e.length;i++){var o={fileType:r.MailItem,name:e[i],size:0,itemId:t[i]};n.push(o)}return n}var f=n(868);function p(e){return e.map(function(e){return{fileType:r.Uri,name:e.name,type:Object(f.a)(e.url),size:0,uri:e.url}})}n.d(t,"b",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"g",function(){return l}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return u}),n.d(t,"h",function(){return p}),n.d(t,"f",function(){return d}),n.d(t,"a",function(){return r})},868:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){var t=r(e);return t?t.replace(".",""):null}var o=n(8),a=n.n(o),u=n(20);function c(e){var t;return e>=1073741824?(e/=1073741824,t=a.a.sizeWithGigabyteAbbreviationText):e>=1048576?(e/=1048576,t=a.a.sizeWithMegabyteAbbreviationText):e>=1024?(e/=1024,t=a.a.sizeWithKilobyteAbbreviationText):t=a.a.sizeWithByteAbbreviationText,Object(u.format)(t,Math.round(e))}var d=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];function s(e){var t=r(e);return!!t&&d.indexOf(t.toLowerCase())>=0}var l=n(5),f=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function p(e){if(!Object(l.d)("doc-attachment-documentThumbnail"))return!1;var t=r(e);return!!t&&f.indexOf(t.toLowerCase())>=0}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return p})}},0,[0,1,3,4,162,279,51,280,57,283,80,300,186,72,182,236]]);
//# sourceMappingURL=owa.MailOptin.mail.js.map
window.scriptsLoaded['owa.MailOptin.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.MailOptin.mail.js'] = (new Date()).getTime();