window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.ImmersiveReaderContainer.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[142],{1255:function(e,r,t){"use strict";var i=t(1);r.a=Object(i.action)("SHOW_IN_IMMERSIVE_READER",function(e,r,t){return{itemId:e,actionSource:r,subActionSource:t}})},1669:function(e,r,t){"use strict";var i=t(0),n=t(1),a=t(1255),o=function(e){return new Promise(function(r){return setTimeout(function(){r()},e)})},s=t(1675),d=t.n(s);function m(e,r,t,i){return d()({itemId:e,sessionId:r,version:t},i)}var c,u=t(12),l=t(127),v=t(167),p=t.n(v),R=t(8),f=t.n(R),h=(Object(n.orchestrator)(a.a,function(e){return i.__awaiter(void 0,void 0,void 0,function(){var r,t,n,a,s,d,c,v,R,S,b,w,_;return i.__generator(this,function(i){switch(i.label){case 0:if(r=e.itemId,t=C(),!r||t.isLoading||0!==t.immersiveReaderFrameState)return[2];(n=new u.a("ShowInImmersiveReader")).addCustomData({sessionId:t.sessionId,subAction:e.subActionSource}),n.addActionSource(e.actionSource),h(!0),g(!0),a=(new Date).getUTCMilliseconds(),s=!0,d=null,c=null,i.label=1;case 1:return i.trys.push([1,7,8,9]),[4,m(p()({Id:r.Id}),t.sessionId,"2.0",r.mailboxInfo&&r.mailboxInfo.requestOptions)];case 2:if(v=i.sent(),n.addCheckmark("ImmersiveReaderProcessText_Done"),v&&v.ReaderModelJson?d=JSON.parse(v.ReaderModelJson):(s=!1,c="Response from service call was null or did not contain a ReaderModelJson"),!s)return[3,6];R=(new Date).getUTCMilliseconds(),S=(R-a).toString(),null,d.launchToPostMessageSentDurationInMs=S,I({messageType:"LinguisticModel",messageValue:d}),b=120,w=0,i.label=3;case 3:return w<b&&1===C().immersiveReaderFrameState?[4,o(500)]:[3,5];case 4:return i.sent(),w++,[3,3];case 5:1===C().immersiveReaderFrameState&&(s=!1,c="Frame never got to Ready state"),i.label=6;case 6:return[3,9];case 7:return _=i.sent(),s=!1,n.addCheckmark("CaughtException"),c=_.toString(),[3,9];case 8:return h(!1),[7];case 9:return s?n.end():(g(!1),n.endWithError("ServerError",new Error(c)),Object(l.b)(f.a.immersiveReaderErrorTitle,f.a.immersiveReaderErrorText,!1,{hideCancelButton:!0})),[2]}})})}),Object(n.mutatorAction)("toggleImmersiveReaderLoadingState",function(e){C().isLoading=e})),g=Object(n.mutatorAction)("toggleImmersiveReaderShowingState",function(e){C().immersiveReaderFrameState=e?1:0}),I=Object(n.mutatorAction)("setImmersiveReaderApiResponse",function(e){C().apiResponse=e}),S=t(89),b={sessionId:Object(S.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},C=Object(n.createStore)("immersivereader",b),w=C(),_=Object(n.mutatorAction)("setImmersiveReaderFrameReady",function(){C().immersiveReaderFrameState=2}),F=Object(n.mutatorAction)("closeImmersiveReader",function(){var e=C();e.immersiveReaderFrameState=0,e.apiResponse=null});!function(e){e[e.Closed=0]="Closed",e[e.Showing=1]="Showing",e[e.Ready=2]="Ready"}(c||(c={}));t.d(r,"e",function(){return w}),t.d(r,"b",function(){return C}),t.d(r,"c",function(){return _}),t.d(r,"a",function(){return F}),t.d(r,"d",function(){return a.a})},1675:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=t(51),n=t(167);r.default=function(e,r){return void 0===e.itemId||e.itemId.__type||(e.itemId=n.default(e.itemId)),i.makeServiceRequest("ImmersiveReaderProcessText",e,r)}},1797:function(e,r,t){"use strict";t.r(r);var i=t(0),n=t(9),a=t(17),o=t(3),s=t(12),d=t(8),m=t.n(d),c=t(5),u=t(7),l=t(1669),v=t(5427),p="https://learningtools.edog.onenote.com/learningtoolsapp/reader",R="https://learningtools.onenote.com/learningtoolsapp/reader",f=function(e){function r(r){var t=e.call(this,r)||this;return t.onReceivePostMessage=function(e){e&&0!==l.e.immersiveReaderFrameState&&0===t.immersiveReaderUrl.toLowerCase().indexOf(e.origin.toLowerCase())&&("ImmersiveReader-ReadyForContent"===e.data?(t.dp&&t.dp.addCheckmark("ReceivedReadyForContent"),Object(l.c)(),t.immersiveReaderFrame.focus()):"CloseImmersiveReader"===e.data&&(t.dp&&t.dp.addCheckmark("ReceivedCloseReader"),t.receivedCloseCallback=!0,Object(l.a)()))},t.getImmersiveReaderUrl=function(){var e=R;Object(c.d)("rp-immersiveReaderDogfood")&&(e=p);var r=Object(u.a)().SessionSettings.UserCulture;return e+"?exitCallback=CloseImmersiveReader&appId=OWA&sessionId="+l.e.sessionId+"&ui="+r+"&appSubId=React"},t.immersiveReaderUrl=t.getImmersiveReaderUrl(),t}return i.__extends(r,e),r.prototype.componentDidMount=function(){var e=this;window.addEventListener("message",this.onReceivePostMessage,!1),this.autorunDisposer=Object(n.autorun)(function(){l.e.apiResponse&&2===l.e.immersiveReaderFrameState&&e.immersiveReaderFrame&&(e.dp&&e.dp.addCheckmark("SendingPostMessageToFrame"),e.immersiveReaderFrame.contentWindow.postMessage(JSON.stringify(l.e.apiResponse),"*"))})},r.prototype.componentWillUnmount=function(){window.removeEventListener("message",this.onReceivePostMessage,!1),this.autorunDisposer()},r.prototype.render=function(){var e=this;return 0===l.e.immersiveReaderFrameState||this.dp?0===l.e.immersiveReaderFrameState&&this.dp&&(this.receivedCloseCallback?this.dp.end():this.dp.endWithError("ServerError",new Error("Did not receive close callback")),this.dp=null):(this.dp=new s.a("ImmersiveReaderContainer"),this.dp.addCustomData({sessionId:l.e.sessionId}),this.receivedCloseCallback=!1),0!==l.e.immersiveReaderFrameState?o.createElement("div",{className:v.immersiveReaderContainer},o.createElement("iframe",{id:"immersive-reader-iframe",className:v.immersiveReaderIframe,title:m.a.immersiveReaderIframeTitle,allowFullScreen:!0,src:this.immersiveReaderUrl,ref:function(r){e.dp&&e.dp.addCheckmark("GotFrameRef"),e.immersiveReaderFrame=r}})):null},r=i.__decorate([a.observer],r)}(o.Component);t.d(r,"ImmersiveReaderContainer",function(){return f})},5427:function(e,r,t){var i=t(5428),n=t(55);"string"==typeof i&&(i=[[e.i,i]]);for(var a=0;a<i.length;a++)n.loadStyles(i[a][1],!1);i.locals&&(e.exports=i.locals)},5428:function(e,r,t){(r=e.exports=t(54)(!1)).push([e.i,"._3T8B8-6fpileHSnn-64UB9{top:0;bottom:0;position:absolute;z-index:3001}html[dir=ltr] ._3T8B8-6fpileHSnn-64UB9,html[dir=rtl] ._3T8B8-6fpileHSnn-64UB9{left:0;right:0}._2doLWEDVBamz2btoVxZ7Bu{position:fixed;top:0;bottom:0;width:100%;height:100%}html[dir] ._2doLWEDVBamz2btoVxZ7Bu{border:0;margin:0;padding:0}html[dir=ltr] ._2doLWEDVBamz2btoVxZ7Bu,html[dir=rtl] ._2doLWEDVBamz2btoVxZ7Bu{left:0;right:0}",""]),r.locals={immersiveReaderContainer:"_3T8B8-6fpileHSnn-64UB9",immersiveReaderIframe:"_2doLWEDVBamz2btoVxZ7Bu"}}},0,[279,51,280,57,283,80]]);
//# sourceMappingURL=owa.ImmersiveReaderContainer.mail.js.map
window.scriptsLoaded['owa.ImmersiveReaderContainer.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.ImmersiveReaderContainer.mail.js'] = (new Date()).getTime();