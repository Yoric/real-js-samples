window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.ItemActions.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[149],{1255:function(e,t,n){"use strict";var r=n(1);t.a=Object(r.action)("SHOW_IN_IMMERSIVE_READER",function(e,t,n){return{itemId:e,actionSource:t,subActionSource:n}})},1292:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(12);function o(e){var t=e.isArchiveTag,n=e.actionSource,o=e.responseClass;Object(r.k)("TnS_RetentionPolicySelected",[t,n,o])}},1348:function(e,t,n){var r=n(1762),o=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},1668:function(e,t,n){"use strict";var r=n(2),o=n(306),i=n(0),a=n(10);var s=n(198),c=n(1348);function u(e){var t=e.retentionId,n=e.displayName,r=e.isChecked,o=e.subMenuProps;return{key:t,text:n,data:t,onClick:e.onClickCallback,checked:r,itemProps:r?{styles:{label:c.checkedItem}}:null,iconProps:r?{iconName:"CheckMark",className:c.checkmark}:null,subMenuProps:o}}var d=n(8),l=n.n(d);function m(e){var t=e.retentionId,n=e.retentionPolicyTags,r=e.folderType,o=e.isArchive,i=e.isChecked,a=e.onClickCallback,s=function(e,t){return 12==e?t?l.a.noDefaultArchivePolicyText:l.a.noDefaultDeletePolicyText:l.a.useParentFolderPolicyText}(r,o);return u({retentionId:t,displayName:17!=r?function(e){var t=e.retentionPolicyTags,n=e.folderType,r=e.isArchive,o=e.defaultName;return t.reduce(function(e,t){return t.Type===n&&t.IsArchive==r?t.DisplayName:e},o)}({retentionPolicyTags:n,folderType:r,isArchive:o,defaultName:s}):s,isChecked:i,subMenuProps:null,onClickCallback:a})}var p=n(1348);function h(e,t,n,r,i){var a=!1;return(12==r?[]:e.map(function(e){var r=e.RetentionId===n;return r&&(a=!0),u({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&r,subMenuProps:null,onClickCallback:i})})).concat(m({retentionId:o.a,retentionPolicyTags:e,folderType:r,isArchive:!0,isChecked:t&&!a,onClickCallback:i}))}var f=n(1348);function b(e,t,n,r,i,a){var s=!1;return(17!=r||"archive"===i?[]:function(e){var t={},n=e.filter(function(e){return null==e.ParentLabelIdentity||e.ParentLabelIdentity.length<=0}).reduce(function(e,n){var r={parentPolicyTag:n,childrenPolicyTags:[]};return e.push(r),t[n.RetentionId]=r,e},[]);return e.filter(function(e){return null!=e.ParentLabelIdentity&&e.ParentLabelIdentity.length>0&&e.ParentLabelIdentity in t}).forEach(function(e){t[e.ParentLabelIdentity].childrenPolicyTags.push(e)}),n}(e).map(function(e){var r=function(e,t,n,r){var o=e.parentPolicyTag,i=e.childrenPolicyTags,a=o.RetentionId===n;if(null==i||0==i.length)return{item:u({retentionId:o.RetentionId,displayName:o.DisplayName,isChecked:t&&a,subMenuProps:null,onClickCallback:r}),policyFound:a};var s=!1,c=i.map(function(e){var o=e.RetentionId===n;return o&&(s=!0),u({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&o,subMenuProps:null,onClickCallback:r})});return{item:u({retentionId:o.RetentionId,displayName:o.DisplayName,isChecked:t&&a,subMenuProps:{items:c},onClickCallback:null}),policyFound:s}}(e,t,n,a);return r.policyFound&&(s=!0),r.item})).concat(m({retentionId:o.c,retentionPolicyTags:e,folderType:r,isArchive:!1,isChecked:t&&!s,onClickCallback:a}))}function I(e){var t=e.retentionPolicyTagList,n=e.showTagSelection,r=e.selectedArchiveTag,o=e.selectedDeleteTag,c=e.treeType,u=e.distinguishedFolderId,d=e.hasArchive,m=e.onArchivePolicyClickedCallback,I=e.onDeletePolicyClickedCallback,k=[],v=d&&c!=a.c,y=function(e){switch(e){case"msgfolderroot":case"archivemsgfolderroot":return 12;case"deleteditems":case"archivedeleteditems":return 3;case"recoverableitemsdeletions":case"archiverecoverableitemsdeletions":return 18;case"calendar":return 1;case"contacts":return 2;case"conversationhistory":return 16;case"drafts":return 4;case"inbox":return 5;case"junkemail":return 6;case"journal":return 7;case"notes":return 8;case"outbox":return 9;case"sentitems":return 10;case"syncissues":return 15;case"tasks":return 11;case"none":default:return 17}}(u),O=t.filter(function(e){return e.IsVisible&&e.IsArchive}).sort(g),S=t.filter(function(e){return e.IsVisible&&!e.IsArchive}).sort(g);return v&&k.push.apply(k,i.__spread(function(e,t,n,r,o){var i=n&&n.IsExplicit?n.Value:null;return[{key:"archiveSection",className:p.sectionHeader,itemType:s.a.Section,sectionProps:{bottomDivider:!0,title:l.a.archivePolicyMenuGroupHeaderText,items:h(e,t,i,r,o)}}]}(O,n,r,y,m))),k.push.apply(k,i.__spread(function(e,t,n,r,o,i){var a=n&&n.IsExplicit?n.Value:null;return[{key:"deleteSection",className:f.sectionHeader,itemType:s.a.Section,sectionProps:{title:l.a.deletePolicyMenuGroupHeaderText,items:b(e,t,a,r,o,i)}}]}(S,n,o,y,u,I))),{items:k}}function g(e,t){return e.RetentionPeriod&&t.RetentionPeriod?e.RetentionPeriod-t.RetentionPeriod:t.RetentionPeriod?1:-1}var k=n(5),v=n(7),y=n(47);function O(e){if(Object(y.a)()||!Object(k.d)("tri-retentionPolicies"))return null;var t=Object(v.a)(),n=e.treeType,r=t.RetentionPolicyTags;return r&&0!==r.length&&n!==a.j?{key:"AssignPolicy",name:l.a.assignPolicyMenuItemName,disabled:!1,subMenuProps:I(i.__assign({},e,{showTagSelection:!0,retentionPolicyTagList:r,hasArchive:!!t.SessionSettings.HasArchive}))}:null}var S=n(39),C=n(6),A=n(77),T=n(202);var P=n(494),j=n(58);function x(e,t,n){var r=C.H.tableViews.get(e);if(!r)return null;var o=function(e){if(e&&Object(S.o)(e.tableQuery)){var t=T.f.tryImportSync();return t?t(e.tableQuery):[]}return Object(v.a)().RetentionPolicyTags}(r);if(!o||!o.length)return null;var s=function(e){var t,n;if(e&&Object(S.o)(e.tableQuery))t=null,n="groups";else{var r=Object(A.d)(e),o=r&&Object(a.x)().get(r);if(!o)return null;t=o.DistinguishedFolderId||o.FolderId.Id,n=o.treeType}return{folderId:t,treeType:n}}(r);if(!s)return null;var c,u,d,l=i.__spread(r.selectedRowKeys.keys());return n?(c=n.ArchiveTag,u=n.PolicyTag,d=!0):(c=1==l.length?C.b.getArchiveTag(l[0],r):null,u=1==l.length?C.b.getPolicyTag(l[0],r):null,d=1==l.length),I({retentionPolicyTagList:o,showTagSelection:d,selectedArchiveTag:c,selectedDeleteTag:u,treeType:s.treeType,distinguishedFolderId:"none",hasArchive:M(r),onArchivePolicyClickedCallback:w({isArchivePolicyClicked:!0,tableView:r,selectedTag:c,folderId:s.folderId,clientItem:n,actionSource:t}),onDeletePolicyClickedCallback:w({isArchivePolicyClicked:!1,tableView:r,selectedTag:u,folderId:s.folderId,clientItem:n,actionSource:t})})}function M(e){return(!e||!Object(S.o)(e.tableQuery))&&!!Object(v.a)().SessionSettings.HasArchive}function w(e){var t=e.isArchivePolicyClicked,n=e.tableView,r=e.selectedTag,a=e.folderId,s=e.clientItem,c=e.actionSource;return function(e,u){var d,l,m,p;if(d={retentionTag:r,retentionId:u.data,inheritSubMenuIdentifier:t?o.a:o.c},l=d.retentionTag,m=d.retentionId,p=d.inheritSubMenuIdentifier,!!l&&m!=l.Value||!l&&m!=p){var h="RPCSAOverflow"==c||1===n.tableQuery.listViewType,f=i.__spread(n.selectedRowKeys.keys()),b=Object(j.b)(n);if(h){var I="RPCSAOverflow"==c?[s.ItemId.Id]:f.map(function(e){return Object(C.B)(e,n.id).clientId.Id});Object(P.d)(t,u.data,I,c,b)}else{var g=f.map(function(e){return Object(C.f)(e,n.id)});I=f.reduce(function(e,t){var r=Object(C.A)(t,n.id);return r&&e.push.apply(e,i.__spread(r.itemIds)),e},[]);Object(P.c)(t,u.data,a,g,I,c,b)}}}}function _(e){var t=e.folder,n=e.retentionId,r=e.inheritSubMenuIdentifier,i=r===o.a?t.ArchiveTag:t.PolicyTag;return!!i&&n!=i.Value||!i&&n!=r}var R=n(556),B=n.n(R),D=n(167),E=n.n(D),F=n(557),N=n.n(F),L=n(558),G=n.n(L),H=n(31),U=n(552),W=n.n(U),V=n(33),Q=n.n(V),J=n(742),K=n.n(J),z=n(973),q=n.n(z);function Y(e,t,n,r){var o=function(e,t,n){var r,o=t?"ItemArchiveTag":"ItemPolicyTag",i=t?"ArchiveTag":"PolicyTag",a=[n?K()({Path:Q()({FieldURI:o}),Item:W()((r={},r[i]=n,r))}):q()({Path:Q()({FieldURI:o})})],s=[];return e.forEach(function(e){return s.push(B()({Updates:a,ItemId:E()({Id:e})}))}),G()({ItemChanges:s,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:!1,ClientSupportsIrm:!0,OutboundCharset:"AutoDetect",SendCalendarInvitationsOrCancellations:"SendToNone"})}(e,t,n);return N()({Header:Object(H.getJsonRequestHeader)(),Body:o},r).then(function(e){return e.Body.ResponseMessages.Items[0]})}var Z=n(1),X=n(11),$=n(1292),ee=(Object(Z.orchestrator)(P.d,function(e){return i.__awaiter(void 0,void 0,void 0,function(){var t,n,r,a,s,c,u,d;return i.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,r=e.itemIds,a=e.actionSource,s=e.mailboxInfo,c=n===o.a||n===o.c?null:{Value:n,IsExplicit:!0},[4,Y(r,t,c,s.requestOptions)];case 1:return"Success"==(u=i.sent()).ResponseClass&&Object(P.e)(c,t,r),Object($.a)({isArchiveTag:t,actionSource:a,responseClass:u.ResponseClass}),[3,3];case 2:return d=i.sent(),X.c.error("Error while updating item retention tag "+d),[3,3];case 3:return[2]}})})}),n(1572)),te=n.n(ee),ne=n(1573),re=n.n(ne),oe=n(1574),ie=n.n(oe),ae=n(170),se=n.n(ae),ce=n(726),ue=n(105),de=n.n(ue),le=n(65),me=n.n(le),pe=n(16);function he(e,t,n,r,o){var i=function(e,t,n,r){var o=e.map(function(e){return function(e,t,n,r){var o=ie()({Action:"SetRetentionPolicy",ConversationId:E()({Id:e.conversationId}),RetentionPolicyType:n});t&&(o.RetentionPolicyTagId=t);if(r){var i=se()({BaseFolderId:(a=r,Object(pe.a)(a)?de()({Id:a}):me()({Id:a}))});o.ContextFolderId=i}var a;return o}(e,t,n,r)});return re()({ConversationActions:o,ReturnMovedItemIds:!1})}(e,t,n,r);return te()({Header:Object(ce.getJsonRequestHeader)(),Body:i},o).then(function(e){return e.Body.ResponseMessages.Items[0]})}Object(Z.orchestrator)(P.c,function(e){return i.__awaiter(void 0,void 0,void 0,function(){var t,n,r,a,s,c,u,d,l,m,p,h;return i.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=e.isArchiveTag,n=e.tagValue,r=e.folderId,a=e.conversationActionContexts,s=e.itemIds,c=e.actionSource,u=e.mailboxInfo,d=t?1:0,l=n===o.a||n===o.c,[4,he(a,l?null:n,d,r,u.requestOptions)];case 1:return"Success"==(m=i.sent()).ResponseClass&&(p=l?null:{Value:n,IsExplicit:!0},Object(P.e)(p,t,s)),Object($.a)({isArchiveTag:t,actionSource:c,responseClass:m.ResponseClass}),[3,3];case 2:return h=i.sent(),X.c.error("Error while updating conversation retention tag"+h),[3,3];case 3:return[2]}})})});var fe=n(13);Object(Z.mutator)(P.e,function(e){var t=e.itemIds,n=e.tag,r=e.isArchiveTag;t.forEach(function(e){var t=fe.A.items.get(e);t&&(r?t.ArchiveTag=n:t.PolicyTag=n)})}),n.d(t,"f",function(){return Ie}),n.d(t,"g",function(){return ge}),n.d(t,"a",function(){return o.a}),n.d(t,"b",function(){return o.c}),n.d(t,"d",function(){return O}),n.d(t,"c",function(){return x}),n.d(t,"e",function(){return _});var be=new r.c(function(){return n.e(214).then(n.bind(null,7057))}),Ie=new r.b(be,function(e){return e.onArchiveTagForFolderChanged}),ge=new r.b(be,function(e){return e.onDeleteTagForFolderChanged})},1669:function(e,t,n){"use strict";var r=n(0),o=n(1),i=n(1255),a=function(e){return new Promise(function(t){return setTimeout(function(){t()},e)})},s=n(1675),c=n.n(s);function u(e,t,n,r){return c()({itemId:e,sessionId:t,version:n},r)}var d,l=n(12),m=n(127),p=n(167),h=n.n(p),f=n(8),b=n.n(f),I=(Object(o.orchestrator)(i.a,function(e){return r.__awaiter(void 0,void 0,void 0,function(){var t,n,o,i,s,c,d,p,f,v,y,S,C;return r.__generator(this,function(r){switch(r.label){case 0:if(t=e.itemId,n=O(),!t||n.isLoading||0!==n.immersiveReaderFrameState)return[2];(o=new l.a("ShowInImmersiveReader")).addCustomData({sessionId:n.sessionId,subAction:e.subActionSource}),o.addActionSource(e.actionSource),I(!0),g(!0),i=(new Date).getUTCMilliseconds(),s=!0,c=null,d=null,r.label=1;case 1:return r.trys.push([1,7,8,9]),[4,u(h()({Id:t.Id}),n.sessionId,"2.0",t.mailboxInfo&&t.mailboxInfo.requestOptions)];case 2:if(p=r.sent(),o.addCheckmark("ImmersiveReaderProcessText_Done"),p&&p.ReaderModelJson?c=JSON.parse(p.ReaderModelJson):(s=!1,d="Response from service call was null or did not contain a ReaderModelJson"),!s)return[3,6];f=(new Date).getUTCMilliseconds(),v=(f-i).toString(),null,c.launchToPostMessageSentDurationInMs=v,k({messageType:"LinguisticModel",messageValue:c}),y=120,S=0,r.label=3;case 3:return S<y&&1===O().immersiveReaderFrameState?[4,a(500)]:[3,5];case 4:return r.sent(),S++,[3,3];case 5:1===O().immersiveReaderFrameState&&(s=!1,d="Frame never got to Ready state"),r.label=6;case 6:return[3,9];case 7:return C=r.sent(),s=!1,o.addCheckmark("CaughtException"),d=C.toString(),[3,9];case 8:return I(!1),[7];case 9:return s?o.end():(g(!1),o.endWithError("ServerError",new Error(d)),Object(m.b)(b.a.immersiveReaderErrorTitle,b.a.immersiveReaderErrorText,!1,{hideCancelButton:!0})),[2]}})})}),Object(o.mutatorAction)("toggleImmersiveReaderLoadingState",function(e){O().isLoading=e})),g=Object(o.mutatorAction)("toggleImmersiveReaderShowingState",function(e){O().immersiveReaderFrameState=e?1:0}),k=Object(o.mutatorAction)("setImmersiveReaderApiResponse",function(e){O().apiResponse=e}),v=n(89),y={sessionId:Object(v.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null},O=Object(o.createStore)("immersivereader",y),S=O(),C=Object(o.mutatorAction)("setImmersiveReaderFrameReady",function(){O().immersiveReaderFrameState=2}),A=Object(o.mutatorAction)("closeImmersiveReader",function(){var e=O();e.immersiveReaderFrameState=0,e.apiResponse=null});!function(e){e[e.Closed=0]="Closed",e[e.Showing=1]="Showing",e[e.Ready=2]="Ready"}(d||(d={}));n.d(t,"e",function(){return S}),n.d(t,"b",function(){return O}),n.d(t,"c",function(){return C}),n.d(t,"a",function(){return A}),n.d(t,"d",function(){return i.a})},1699:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),o=new r.c(function(){return n.e(111).then(n.bind(null,1893))}),i=new r.b(o,function(e){return e.preparePopoutDataForReadingPane})},1762:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,"._3RC22E4ie2Lvku3nOPT0Pp{font-weight:600}html[dir] ._29Q0naZwHcGiOhPt4bHnhN .ms-ContextualMenu-header{padding:0 4px}._1H-gT_1L_rC8pqisaUmnDV{font-weight:700}",""]),t.locals={checkedItem:"_3RC22E4ie2Lvku3nOPT0Pp",sectionHeader:"_29Q0naZwHcGiOhPt4bHnhN",checkmark:"_1H-gT_1L_rC8pqisaUmnDV"}},2083:function(e,t,n){"use strict";n.d(t,"a",function(){return I}),n.d(t,"c",function(){return g}),n.d(t,"b",function(){return k});var r=n(188),o=n(139),i=n(186),a=n(2221),s="resources/images/surfaceActions",c=s+"/attach.svg",u=s+"/attachDark.svg",d=s+"/inlineimage.svg",l=s+"/inlineimageDark.svg",m=s+"/emoji.svg",p=s+"/dictate.svg",h=s+"/dictationRecording.svg",f=s+"/showribbon.svg",b=s+"/showribbonDark.svg";function I(e){var t,n,s=!1;switch(e){case"AddAttachment":t=Object(o.resolve)(Object(r.a)(),Object(i.c)()?u:c),n=Object(o.resolve)(Object(r.a)(),c),s=!0;break;case"AddInlineImage":t=Object(o.resolve)(Object(r.a)(),Object(i.c)()?l:d),n=Object(o.resolve)(Object(r.a)(),d),s=!0;break;case"AddEmoji":t=Object(o.resolve)(Object(r.a)(),m),s=!0;break;case"ToggleDictation":t=Object(o.resolve)(Object(r.a)(),Object(a.a)()?h:p),s=!0;break;case"ToggleRibbon":t=Object(o.resolve)(Object(r.a)(),Object(i.c)()?b:f),n=Object(o.resolve)(Object(r.a)(),f),s=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":case"AccChecker":t="OutlookLogo";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:s}}function g(e){var t;switch(e){case"-":t="-";break;case"Reply":t="Reply";break;case"ReplyAll":t="ReplyAll";break;case"Forward":t="Forward";break;case"ReplyByMeeting":t="Calendar";break;case"ReportAbuse":t="ReportHacked";break;case"Delete":t="Delete";break;case"MarkReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"AssignPolicy":t="Assign";break;case"AddToSafeSenders":t="AddFriend";break;case"MarkJunkNotJunk":t="MailAlert";break;case"MarkAsPhishing":t="Phishing";break;case"Block":t="BlockContact";break;case"CreateRule":t="CreateMailRule";break;case"Print":t="Print";break;case"Translate":t="LocaleLanguage";break;case"ShowInImmersiveReader":t="ReadOutLoud";break;case"ViewMessageSource":t="OpenSource";break;case"Popout":t="OpenInNewWindow";break;case"LikeUnlike":t="Like";break;case"ToggleDarkMode":t="Sunny";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function k(e){var t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},2221:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var r=!1;function o(){return r}function i(){r=!r}},2260:function(e,t,n){"use strict";var r=n(2),o=n(2442);function i(e){return o.a.addinOptionSurfaceItems[e]}var a=n(47),s=n(8),c=n.n(s),u=n(20),d=n(2221);function l(e){switch(e){case"AddAttachment":return c.a.attachTooltip;case"AddInlineImage":return c.a.insertPicturesInlineTooltip;case"AddEmoji":return c.a.emojiTooltip;case"ToggleDictation":return Object(d.a)()?c.a.startDictationTooltip:c.a.stopDictationTooltip;case"ToggleRibbon":return c.a.formattingOptionsTooltip;case"SaveDraft":return c.a.saveDraft;case"InsertSignature":return c.a.insertSignature;case"ShowFrom":return c.a.showFrom;case"SetImportance":return c.a.setImportance;case"ShowMessageOptions":return c.a.showMessageOptions;case"SwitchBodyType":return c.a.switchToPlainTextMenuItem;case"SensitivityMenu":return c.a.sensitivityMenuText;case"ProtectMessage":return c.a.composeProtectButton;case"AccChecker":return c.a.accCheckerMenuItemText;default:return""}}function m(e){switch(e){case"LikeUnlike":return c.a.itemHeaderLike;case"Reply":return c.a.itemHeaderReply;case"ReplyAll":return c.a.itemHeaderReplyAll;case"Forward":return c.a.itemHeaderForward;case"ReplyByMeeting":return c.a.itemHeaderReplyByMeeting;case"ReportAbuse":return c.a.reportAbuse;case"Popout":return c.a.popoutsOpenInNewWindow;case"Delete":return c.a.itemHeaderDelete;case"MarkReadUnread":return c.a.markAsUnread;case"FlagUnflag":return c.a.itemHeaderFlag;case"AssignPolicy":return c.a.assignPolicyMenuItemName;case"AddToSafeSenders":return c.a.itemHeaderAddToSafeSenders;case"MarkJunkNotJunk":return c.a.itemHeaderMarkAsJunk;case"MarkAsPhishing":return c.a.itemHeaderMarkAsPhishing;case"Block":return Object(u.format)(c.a.itemHeaderBlock,"");case"CreateRule":return c.a.createRule;case"Print":return c.a.itemHeaderPrint;case"Translate":return c.a.itemHeaderTranslate;case"ShowInImmersiveReader":return c.a.showInImmersiveReader;case"ViewMessageSource":return Object(a.a)()?c.a.itemHeaderViewMessageSource:c.a.itemHeaderViewMessageDetails;case"ToggleDarkMode":return c.a.itemHeaderLightsOn;default:return""}}function p(e){switch(e){case"None":return c.a.none;case"Delete":return c.a.deleteItem;case"Archive":return c.a.archive;case"PinUnpin":return c.a.pin;case"ReadUnread":return c.a.readUnread;case"FlagUnflag":return c.a.flag;case"Move":return c.a.moveToFolder;default:return""}}var h=n(2083),f=n(2441),b=n(833),I=n(5),g=n(217),k=n(7),v=n(186);function y(){var e=[{key:"Reply",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!1},{key:"Forward",hideInGroup:!1,hideInSxS:!1}];return Object(I.d)("rp-replyByMeeting")&&e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(k.a)().SessionSettings.IsShadowMailbox||e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0},{key:"ReportAbuse",hideInGroup:!Object(a.a)(),hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),!Object(a.a)()&&Object(I.d)("tri-retentionPolicies")&&e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0},{key:"Print",hideInGroup:!1,hideInSxS:!1}),Object(I.d)("gsx-translator-translateMessage")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(v.c)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),Object(I.d)("rp-immersiveReader")&&e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),Object(I.d)("rp-popouts")&&e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object(I.d)("rp-like")&&!Object(a.a)()&&e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),e}function O(){var e=[{key:"AddAttachment",hideInGroup:!1},{key:"AddInlineImage",hideInGroup:!1}];return e.push({key:"AddEmoji",hideInGroup:!1}),Object(I.d)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1}]),Object(I.d)("cmp-clp")&&!Object(a.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(b.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(f.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),e.push({key:"SwitchBodyType",hideInGroup:!1}),Object(I.d)("cmp-accChecker")&&e.push({key:"AccChecker",hideInGroup:!1}),e}function S(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function C(e){return-1!==Object(g.c)(g.a.SurfaceActions).readSurfaceActions.indexOf(e)}var A=n(12);function T(e,t,n,r){var o;r?o=r:(o="Pinned",n&&n.renderedInOverflow&&(o=n.isPinned?"Overflow":"NotPinned")),Object(A.k)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,o])}function P(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0})}function j(e){e.subMenuProps&&e.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!1})}n.d(t,"j",function(){return M}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return l}),n.d(t,"g",function(){return m}),n.d(t,"f",function(){return p}),n.d(t,"a",function(){return"-"}),n.d(t,"d",function(){return h.a}),n.d(t,"h",function(){return h.c}),n.d(t,"e",function(){return O}),n.d(t,"i",function(){return y}),n.d(t,"o",function(){return S}),n.d(t,"n",function(){return C}),n.d(t,"k",function(){return T}),n.d(t,"m",function(){return P}),n.d(t,"l",function(){return j});var x=new r.c(function(){return n.e(237).then(n.bind(null,7180))}),M=new r.a(x,function(e){return e.setAddinOptionSurfaceItems})},2441:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(5),o=n(29);function i(){return!Object(o.m)()&&(Object(r.d)("cmp-requestReadReceipts")||Object(r.d)("cmp-requestDeliveryReceipts")||Object(r.d)("cmp-setMessageSensitivity")||Object(r.d)("cmp-smime"))}},2442:function(e,t,n){"use strict";var r=n(1),o=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();t.a=o},306:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"d",function(){return a});var r="ArchivePolicyParentRow",o="DeletePolicyParentRow",i="FolderArchiveTag",a="FolderPolicyTag"},4299:function(e,t,n){"use strict";var r,o=n(1),i=Object(o.createStore)("SurfaceActionsStore",{isAddinObserverLoaded:!1})(),a=n(4),s=Object(a.action)("setAddinObserverLoaded ")(function(){i.isAddinObserverLoaded=!0}),c=n(185);c.p.import().then(function(e){r=e,s()});var u=n(0),d=n(198),l=n(161),m=n(10),p=n(2260);function h(e,t,n,o,a,s,h,f,b,I){var g,k=function(e,t){return i.isAddinObserverLoaded&&r?r(e,t).get():null}(e,function(e){if(!e)return!1;if(!e.ParentFolderId)return!1;var t=e.ParentFolderId.Id;return Object(m.G)(t,m.j)}(t));g=k?k.sectionProps.items:[];var v=e==l.a.MessageRead?Object(c.m)(n):Object(c.k)(n),y=!0;g.forEach(function(e){Object(c.j)(v,e);var t=e;if(t.iconOnly=!0,b&&(t.className=b),o.indexOf(e.key)>=0){var n=t;I&&(n=u.__assign({},t)),null!=n.name&&null!=n.title&&n.name.trim()!=n.title.trim()&&(n.name=n.ariaLabel),n.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach(function(e){e.isPinned=!0}),n?e.unshift(t):e.push(t)}(a,n,h)}(-1==o.indexOf(e.key)||I)&&(y&&(!function(e,t){var n=e.length;n>0&&e[n-1].displayName!=p.a&&e.push({key:"addinDivider_"+t,displayName:p.a,itemType:d.a.Divider,onClick:null})}(s,f++),y=!1),t.renderedInOverflow=!0,t.subMenuProps&&t.subMenuProps.items.forEach(function(e){e.renderedInOverflow=!0}),(t.itemType!==d.a.Divider||0!==s.length&&s[s.length-1].itemType!==d.a.Divider)&&s.push(t))})}n.d(t,"a",function(){return h})},4582:function(e,t,n){var r=n(6162),o=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},494:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return a}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c});var r=n(1),o=Object(r.action)("ON_ARCHIVE_TAG_FOR_FOLDER_UPDATE_SUCCESS",function(e,t){return{folder:e,archiveTag:t}}),i=Object(r.action)("ON_DELETE_TAG_FOR_FOLDER_UPDATE_SUCCESS",function(e,t){return{folder:e,deleteTag:t}}),a=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_UPDATE_SUCCESS",function(e,t,n){return{tag:e,isArchiveTag:t,itemIds:n}}),s=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_CHANGED",function(e,t,n,r,o){return{isArchiveTag:e,tagValue:t,itemIds:n,actionSource:r,mailboxInfo:o}}),c=Object(r.action)("ON_RETENTION_TAG_FOR_CONVERSATIONS_CHANGED",function(e,t,n,r,o,i,a){return{isArchiveTag:e,tagValue:t,folderId:n,conversationActionContexts:r,itemIds:o,actionSource:i,mailboxInfo:a}})},6160:function(e,t,n){var r=n(6161),o=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6161:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._2H21pKzsjpxFYb303ICfwd div[class~=ms-Button-label]{display:block}html[dir] ._2H21pKzsjpxFYb303ICfwd div[class~=ms-Button-label]{margin:0 1px;padding:0}button._3HPsduuSR0kiYT7qgEdpTW.ms-Button{width:auto}html[dir] button._37bd_CzSN2HdBQ6LNpwKfb{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}._2VhiYGqSDy6tVtxTQ8DWIn{width:230px}html[dir] ._2VhiYGqSDy6tVtxTQ8DWIn{background-color:"[theme:white, default:#ffffff]"}._1eqEII4kXFuD0mZB-Ro2-r{max-height:400px;overflow-x:hidden}._3hEaa47BcWeKXUbDXWFh5o{-webkit-animation:none!important;animation:none!important}._1G3_bG8Hbm81ZqzIWdOC6{overflow:hidden}._3tYxJQQQ1PqdghMB01OZ59{height:44px}html[dir=ltr] ._3tYxJQQQ1PqdghMB01OZ59{padding-left:12px}html[dir=rtl] ._3tYxJQQQ1PqdghMB01OZ59{padding-right:12px}html[dir] ._3tYxJQQQ1PqdghMB01OZ59:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}',""]),t.locals={likeCustomButton:"_2H21pKzsjpxFYb303ICfwd",likeIconButtonCustom:"_3HPsduuSR0kiYT7qgEdpTW",likeCustomButtonActive:"_37bd_CzSN2HdBQ6LNpwKfb",callout:"_2VhiYGqSDy6tVtxTQ8DWIn",scrollContainer:"_1eqEII4kXFuD0mZB-Ro2-r",animationStop:"_3hEaa47BcWeKXUbDXWFh5o",personaCollection:"_1G3_bG8Hbm81ZqzIWdOC6",persona:"_3tYxJQQQ1PqdghMB01OZ59"}},6162:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'html[dir=ltr] ._7U7lf32M2TlqTAxnpbp5k{padding-right:2px}html[dir=rtl] ._7U7lf32M2TlqTAxnpbp5k{padding-left:2px}._2zMcBmiUjYUI6pt6roo31r{width:100%;min-width:0;height:40px;display:inline-block;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;position:relative;top:1px}html[dir=ltr] ._2zMcBmiUjYUI6pt6roo31r{left:2px}html[dir=rtl] ._2zMcBmiUjYUI6pt6roo31r{right:2px}.noRhmXv-2SrGDukn5FnPC{font-size:14px;color:"[theme:themePrimary, default:#0078D4]"}html[dir] .noRhmXv-2SrGDukn5FnPC{background:transparent}._36Q5gzmGWcba7i9Opp3y-V{height:32px}html[dir] ._36Q5gzmGWcba7i9Opp3y-V{background-color:transparent;padding:4px 0}.DnQMzXGrWfrSS5STM1SQ9{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._5ECwz2NLGZ3gU6TpCRuGx{height:100%;min-width:32px}html[dir] ._5ECwz2NLGZ3gU6TpCRuGx{background-color:transparent;margin:0 2px}._1kFs3eANyeyGudchSfDO3i.ms-ContextualMenu-icon.hideMenuIcon,._2R5GIxZhPMnnR2bvO7nx8A:not(.noRhmXv-2SrGDukn5FnPC),._5ECwz2NLGZ3gU6TpCRuGx .ms-Button-label{display:none}._2qrAdKnBUIg087Wmw5ZH_I{position:relative;top:8px}html[dir=ltr] ._2qrAdKnBUIg087Wmw5ZH_I{float:right;padding-right:11px}html[dir=rtl] ._2qrAdKnBUIg087Wmw5ZH_I{float:left;padding-left:11px}._1QWBJdjfYAfubopkIaoBn2{display:none}._3yD7OW79cWN53ThAEdCN0e{width:32px;height:32px}html[dir] ._3yD7OW79cWN53ThAEdCN0e{border-radius:2px;background:transparent}._3yD7OW79cWN53ThAEdCN0e.ms-Button{width:32px;height:32px}html[dir] ._3yD7OW79cWN53ThAEdCN0e:hover{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] ._3yD7OW79cWN53ThAEdCN0e:active{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._3yD7OW79cWN53ThAEdCN0e._9n1gFKjzTs5aCsl8mFF7M{background-color:"[theme:themeLighter, default:#DEECF9]"}._3yD7OW79cWN53ThAEdCN0e._9n1gFKjzTs5aCsl8mFF7M.ms-Button .ms-Button-icon,._3yD7OW79cWN53ThAEdCN0e._9n1gFKjzTs5aCsl8mFF7M.ms-Button .ms-Button-menuIcon,._3yD7OW79cWN53ThAEdCN0e:active.ms-Button .ms-Button-icon,._3yD7OW79cWN53ThAEdCN0e:active.ms-Button .ms-Button-menuIcon,._3yD7OW79cWN53ThAEdCN0e:hover.ms-Button .ms-Button-icon,._3yD7OW79cWN53ThAEdCN0e:hover.ms-Button .ms-Button-menuIcon{color:"[theme:themeDarker, default:#004578]"}._2O8JcS9Q4Qu-9SWJcaoeJo{color:"[theme:themePrimary, default:#0078D4]"}._24oqM25CLGLnN1P65NaEvK{color:"[theme:neutralTertiary, default:#a6a6a6]"}html[dir] ._1NKt8NixsrA9TKXXD1d8Im{background-color:transparent}',""]),t.locals={surfaceActionsCommandBarCharms:"_7U7lf32M2TlqTAxnpbp5k",surfaceActionsCommandBarContainer:"_2zMcBmiUjYUI6pt6roo31r",surfaceActionsCommandBarOverflowIcon:"noRhmXv-2SrGDukn5FnPC",surfaceActionsCommandBar:"_36Q5gzmGWcba7i9Opp3y-V",surfaceActionsCommandBarPrimarySet:"DnQMzXGrWfrSS5STM1SQ9",surfaceActionsCommandBarButton:"_5ECwz2NLGZ3gU6TpCRuGx",commandBarMenuIcon:"_2R5GIxZhPMnnR2bvO7nx8A",commandBarIcon:"_1kFs3eANyeyGudchSfDO3i",itemHeaderDropDownButtonCharms:"_2qrAdKnBUIg087Wmw5ZH_I",hideCharms:"_1QWBJdjfYAfubopkIaoBn2",iconButton:"_3yD7OW79cWN53ThAEdCN0e",isChecked:"_9n1gFKjzTs5aCsl8mFF7M",enabledIconButton:"_2O8JcS9Q4Qu-9SWJcaoeJo",disabledIconButton:"_24oqM25CLGLnN1P65NaEvK",disabledReplyActionButton:"_1NKt8NixsrA9TKXXD1d8Im"}},6163:function(e,t,n){var r=n(6164),o=n(55);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},6164:function(e,t,n){(t=e.exports=n(54)(!1)).push([e.i,'._3cI2g0LwJl59SGGcQrb0Wj{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2_w_2cebu8k1brG8sRRf_t{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre-line}._1thrRJhB2eQb5pHyzgiwGD{color:"[theme:white, default:#ffffff]"!important}html[dir] ._1thrRJhB2eQb5pHyzgiwGD{background-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._1thrRJhB2eQb5pHyzgiwGD:hover{background-color:"[theme:themeDark, default:#0D62AA]"}html[dir] ._1thrRJhB2eQb5pHyzgiwGD:active{background-color:"[theme:themeDarker, default:#004578]"}',""]),t.locals={container:"_3cI2g0LwJl59SGGcQrb0Wj",content:"_2_w_2cebu8k1brG8sRRf_t",button:"_1thrRJhB2eQb5pHyzgiwGD"}},7032:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(3518),i=n(17),a=n(581),s=n(1326),c=n(78),u=n(34),d=n(1298),l=n(344),m=n(89),p=n(1226),h=n(90),f=n(3),b=n(7),I=n(20),g=n(8),k=n.n(g),v=100;function y(e){try{if(e.LikeCount&&e.Likers){var t=Object(b.a)().SessionSettings.UserEmailAddress,n=!!e.Likers&&e.Likers.some(function(e){return e.EmailAddress===t});switch(e.LikeCount){case 1:return n?k.a.likersSummaryOnePersonYouText:Object(I.format)(k.a.likersSummaryOneOtherPersonText,e.Likers[0].Name);case 2:return n?Object(I.format)(k.a.likersSummaryTwoPersonYouAndOneOtherText,e.Likers.filter(function(e){return e.EmailAddress!==t})[0].Name):Object(I.format)(k.a.likersSummaryTwoPersonOtherText,e.Likers[0].Name,e.Likers[1].Name);case 3:return n?Object(I.format)(k.a.likersSummaryThreePersonYouAndTwoOtherText,e.Likers[0].Name,k.a.likersSummaryOneOtherText):Object(I.format)(k.a.likersSummaryThreePersonOtherText,e.Likers[0].Name,e.Likers[1].Name,k.a.likersSummaryOneOtherText);default:return n?e.LikeCount>=v?Object(I.format)(k.a.likersSummaryYouAndMoreThanMaxLikersText,v-1):Object(I.format)(k.a.likersSummaryFourPersonYouAndMoreOtherText,e.Likers[0].Name,Object(I.format)(k.a.likersSummaryNOthersText,e.LikeCount-2)):e.LikeCount>=v?Object(I.format)(k.a.likersSummaryOtherMoreThanMaxLikersText,v-1):Object(I.format)(k.a.likersSummaryFourPersonOthersText,e.Likers[0].Name,e.Likers[1].Name,Object(I.format)(k.a.likersSummaryNOthersText,e.LikeCount-2))}}}catch(e){return null}return null}function O(e){return e.LikeCount?e.LikeCount<v?e.LikeCount.toString():v-1+"+":null}var S=n(1972),C=n(6160),A=n(4582),T=n(275),P=100,j=function(e){function t(t){var n=e.call(this,t)||this;return n.onLikeClicked=function(e,t){t.onClick(e,t),e.stopPropagation()},n.handleMouseOver=function(){window.requestAnimationFrame(function(){setTimeout(function(){n.setState({isMouseOverButton:!0})},10)})},n.handleMouseLeave=function(){setTimeout(function(){n.setState({isMouseOverButton:!1})},P)},n.handleLikersListMouseOver=function(){n.setState({isMouseOverLikersList:!0})},n.handleLikersListMouseLeave=function(){setTimeout(function(){n.setState({isMouseOverLikersList:!1})},P)},n.state={isMouseOverButton:!1,isMouseOverLikersList:!1},n}return r.__extends(t,e),t.prototype.IsLikersListShown=function(){return this.state.isMouseOverLikersList},t.prototype.render=function(){var e=this,t=this.props,n=t.surfaceActionItem,o=t.message,i=o.LikeCount&&o.Likers&&(this.state.isMouseOverButton||this.state.isMouseOverLikersList),b="likeButtonId"+Object(m.a)();return f.createElement(d.a,{content:n.name},f.createElement(a.CommandBarButton,{id:b,role:"menuItem",ariaLabel:n.name,ariaDescription:y(o),iconProps:n.iconProps,styles:{root:T(A.surfaceActionsCommandBarButton,A.iconButton,o.LikeCount&&C.likeCustomButton,o.LikeCount&&C.likeIconButtonCustom,i&&C.likeCustomButtonActive),rootChecked:A.checkedCommandBarButton,rootDisabled:A.disabledReplyActionButton,icon:A.enabledIconButton,iconDisabled:A.disabledIconButton,menuIcon:A.commandBarMenuIcon},onClick:function(t){return e.onLikeClicked(t,n)},onMouseEnter:this.handleMouseOver,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,text:O(o)}),i&&f.createElement(s.a,{className:T(C.callout,{animationStop:Object(h.c)()}),onDismiss:function(){return e.setState(r.__assign({},e.state,{isMouseOverButton:!1,isMouseOverLikersList:!1}))},target:"#"+b,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(l.a)()?c.DirectionalHint.bottomLeftEdge:c.DirectionalHint.bottomRightEdge},f.createElement("div",{className:T(C.scrollContainer,"customScrollBar"),onMouseEnter:this.handleLikersListMouseOver,onMouseOver:this.handleLikersListMouseOver,onMouseLeave:this.handleLikersListMouseLeave},f.createElement("div",{className:C.personaCollection},o.Likers.map(function(e){return f.createElement(x,{emailAddress:e.EmailAddress,name:e.Name,mailBoxType:e.MailboxType,disableHover:!0,clientScenario:"Liker"},f.createElement(p.a,{className:C.persona,key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:u.c.size32,showPersonaDetails:!0}))})))))},t=r.__decorate([i.observer],t)}(f.Component),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return f.createElement("div",{onClick:this.props.onPersonaCardBehaviorClick},this.props.children)},t=r.__decorate([S.a],t)}(f.Component),M=n(1858),w=n(874),_=n(1856),R=n(723),B=n(1521),D=n(351),E=n(352),F=n(187),N=n.n(F);function L(e){return Object(D.a)([e.ItemId.Id],N()({BaseShape:"IdOnly"}),"MessageDetails","V2016_06_24",e.MailboxInfo&&e.MailboxInfo.requestOptions).then(function(e){return function(e){if(Object(E.a)(e[0])){var t=e[0].Items[0];if(null!=t.ExtendedProperty&&t.ExtendedProperty.length>=1)return t.ExtendedProperty[0].Value}return null}(e)})}function G(e){return Object(D.a)([e.ItemId.Id],N()({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",e.MailboxInfo&&e.MailboxInfo.requestOptions).then(function(e){return function(e){return Object(E.a)(e[0])?e[0].Items[0].MimeContent:null}(e)})}var H=n(47),U=n(15),W=n.n(U),V=n(88),Q=n(275),J=n(6163),K=function(e){function t(t){var n=e.call(this,t)||this;return n.onDismiss=function(){n.props.onClose()},n.state={content:""},n}return r.__extends(t,e),t.prototype.render=function(){return f.createElement(_.a,{hidden:!1,containerClassName:J.container,dialogContentProps:{showCloseButton:!1,title:Object(H.a)()?k.a.ViewMessageSourceDialogueTitleText:k.a.ViewMessageDetailsDialogueTitleText,type:R.a.normal},onDismiss:this.onDismiss},f.createElement("div",{className:Q(J.content,"allowTextSelection"),tabIndex:-1},this.state.content),f.createElement(B.a,null,f.createElement(M.a,{buttonType:w.a.normal,onClick:this.onDismiss,className:J.button},W.a.confirmDialogCloseText)))},t.prototype.setContent=function(e){this.setState({content:e})},t}(f.Component);var z=n(6);function q(e){var t=Object(z.F)(e)?e:null;if(null==t)return null;var n=t.Sender&&t.Sender.Mailbox;if(n){var r=Y(n);if(r)return r}var o=t.From&&t.From.Mailbox;if(o){var i=Y(o);if(i)return i}return null}function Y(e){return"GroupMailbox"==e.MailboxType||Object(I.isStringNullOrWhiteSpace)(e.EmailAddress)?null:Object(I.isStringNullOrWhiteSpace)(e.Name)?e.EmailAddress:e.Name}var Z=n(9),X=n(1758),$=n(198),ee=n(98),te=n(4299),ne=n(161),re=n(12),oe=n(63),ie=n(5),ae=n(1669),se=n(2277),ce=n(66),ue=n(174),de=n(67),le=n(1699),me=n(308),pe=n(4440),he=n(1678),fe=n(3503),be=n(3894),Ie=n(2565),ge=n(30),ke=Object(ge.b)("toggleUndoDarkMode",{name:function(e){return e.undoDarkMode?"ToggleDarkModeOn":"ToggleDarkModeOff"},actionSource:"ReadingPane"})(function(e){e&&(e.undoDarkMode=!e.undoDarkMode)}),ve=n(3882),ye=n(1579),Oe=n(1635),Se=n(1275),Ce=n(3600),Ae=n(1668),Te=n(793),Pe=n(1111),je=n(1110),xe=n(2919),Me=n(572),we=n(57),_e=n(181),Re=n(243),Be=n(974),De=n(241),Ee=n(10),Fe=n(52),Ne=n(185),Le=n(2260),Ge=n(217),He=n(4582),Ue=n(160).bind(He),We="Dropdown",Ve=5,Qe=function(e){function t(t){var n=e.call(this,t)||this;return n.commandBarHiddenOverflowItems=[],n.commandBarDividerKey=0,n.likeButtonClickCount=0,n.likeUnlikeInProgress=!1,n.getHandler=function(e,t,r){return function(o,i){Object(Le.k)(!1,r,i,n.getActionSource(i)),t?(n.updateSelectItemPart(),e(o,i)):o.which==ee.a.enter&&(o.preventDefault(),o.stopPropagation(),n.updateSelectItemPart(),e(o,i))}},n.updateSelectItemPart=function(){n.props.viewState.isConversationItemPart&&Object(Ie.a)(n.props.viewState,!1)},n.ItemHeaderToolbarButton=Object(i.observer)(function(e){return f.createElement(a.CommandBarButton,r.__assign({},e,{menuProps:e.menuProps&&r.__assign({},e.menuProps,{directionalHint:c.DirectionalHint.bottomAutoEdge}),onMenuClick:n.updateSelectItemPart,styles:r.__assign({},e.styles,{root:Ue(He.surfaceActionsCommandBarButton,He.iconButton),rootChecked:He.checkedCommandBarButton,rootDisabled:He.disabledReplyActionButton,icon:He.enabledIconButton,iconDisabled:He.disabledIconButton,menuIcon:He.commandBarMenuIcon}),role:"menuItem"}))}),n.ItemHeaderToolbarOverflowButton=Object(i.observer)(function(e){var t=n.ItemHeaderToolbarButton;return f.createElement(d.a,{content:k.a.MoreActionsButton},f.createElement(t,r.__assign({},e)))}),n.onCommandBarReduceData=function(e){var t=e.primaryItems,o=e.overflowItems,i=e.cacheKey,a=t[0];if(void 0!==a)return n.commandBarHiddenOverflowItems=r.__spread([a],n.commandBarHiddenOverflowItems),t=t.slice(1),i=n.computeCommandBarCacheKey(t),r.__assign({},e,{primaryItems:t,overflowItems:o,cacheKey:i})},n.onCommandBarGrowData=function(e){var t=e.primaryItems,o=e.overflowItems,i=e.cacheKey,a=n.commandBarHiddenOverflowItems[0];if(void 0!==a)return n.commandBarHiddenOverflowItems=n.commandBarHiddenOverflowItems.slice(1),t=r.__spread([a],t),i=n.computeCommandBarCacheKey(t),r.__assign({},e,{primaryItems:t,overflowItems:o,cacheKey:i})},n.onResize=function(){n.commandBar&&n.commandBar.remeasure()},n.onPopout=function(e,t){e.stopPropagation(),n.asyncOnPopout(t)},n.asyncOnPopout=function(e){return r.__awaiter(n,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,le.a.import()];case 1:return e=t.sent(),Object(Me.a)(this.props.viewState.itemId,this.props.item.MailboxInfo,e(Object(z.x)())),[2]}})})},n.onReply=function(e,t){n.onReplyReplyAllInternal(e,!1,t)},n.onReplyAll=function(e,t){n.onReplyReplyAllInternal(e,!0,t)},n.onReplyReplyAllInternal=function(e,t,o){e.stopPropagation();var i=n.getConversationId();ce.w.importAndExecute({referenceItemId:r.__assign({},n.props.item.ItemId,{mailboxInfo:n.props.item.MailboxInfo}),isReplyAll:t,useFullCompose:!1,actionSource:We,instrumentationContexts:[n.props.instrumentationContext],conversationId:i,suppressServerMarkReadOnReplyOrForward:Object(z.K)(Object(z.x)())}),n.props.isItemAttachment&&we.q.importAndExecute("replyAllToItemAttachment")},n.onForward=function(e,t){e.stopPropagation(),ce.n.importAndExecute(r.__assign({},n.props.item.ItemId,{mailboxInfo:n.props.item.MailboxInfo}),We,[n.props.instrumentationContext],Object(z.K)(Object(z.x)())),n.props.isItemAttachment&&we.q.importAndExecute("forwardItemAttachment")},n.onReplyByMeeting=function(e,t){e.stopPropagation(),Object(fe.a)(n.props.item.ItemId.Id,null,!1,We)},n.onLikeUnLike=function(){return function(e,t){e.stopPropagation(),!n.likeUnlikeInProgress&&t&&(n.likeUnlikeInProgress=!0,n.asyncLikeItem(t))}},n.asyncLikeItem=function(e){return r.__awaiter(n,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,Fe.q.import()];case 1:return e=t.sent(),this.likeButtonClickCount++,e(r.__assign({},this.props.item.ItemId,{mailboxInfo:this.props.item.MailboxInfo}),this.props.item,Object(z.x)(),this.likeButtonClickCount>=Ve,this.props.instrumentationContext),this.likeUnlikeInProgress=!1,[2]}})})},n.onDelete=function(e,t){e.stopPropagation();var r=n.getConversationId();if(r&&Object(ie.d)("rp-selectionUI")){var o=Object(pe.b)(r,n.props.viewState);Fe.k.importAndExecute([n.props.item.ItemId.Id],Object(Oe.a)(n.props.item.ItemId.Id),[n.props.instrumentationContext],We,n.props.item.MailboxInfo,!0).then(function(){Object(be.a)(o)})}else Fe.k.importAndExecute([n.props.item.ItemId.Id],Object(Oe.a)(n.props.item.ItemId.Id),[n.props.instrumentationContext],We,n.props.item.MailboxInfo)},n.onToggleJunkNotjunk=function(){return function(e,t){e.stopPropagation(),Fe.s.importAndExecute(n.props.item.ItemId.Id,Object(z.x)(),We,[n.props.instrumentationContext]),Object(de.a)()}},n.onPhishing=function(e,t){e.stopPropagation(),Fe.r.importAndExecute(n.props.item.ItemId.Id,Object(z.x)(),We),Object(de.a)()},n.onReportAbuse=function(e,t){e.stopPropagation(),Ce.b.importAndExecute(n.props.item,Object(z.x)(),[n.props.instrumentationContext],We),Object(de.a)()},n.onBlock=function(e,t){e.stopPropagation(),Fe.f.importAndExecute(n.props.item.ItemId.Id,[n.props.instrumentationContext],We),Object(de.a)()},n.onToggleReadMenuItem=function(e,t){e.stopPropagation();var r=n.props.item;me.c.importAndExecute(n.props.item.ItemId.Id,Object(z.x)(),!r.IsRead,[n.props.instrumentationContext],We)},n.onToggleFlagMenuItem=function(e,t){var r;e.stopPropagation(),r="Flagged"!=n.props.item.Flag.FlagStatus?"Flagged":"NotFlagged",Fe.H.importAndExecute([n.props.item.ItemId.Id],[n.props.instrumentationContext],{FlagStatus:r},Object(z.x)().id,We)},n.onAddToSafeSenders=function(e,t){e.stopPropagation();var r=n.props.item;Fe.c.import().then(function(e){e(r.Sender.Mailbox,r.ItemId.Id,n.getActionSource(t))})},n.onAssignPolicy=function(e,t){e.stopPropagation()},n.onCreateRule=function(e,t){e.stopPropagation();var r=n.props.item;Pe.a.importAndExecute(r.From.Mailbox,n.getActionSource(t))},n.onPrint=function(e,t){e.stopPropagation(),Object(he.a)(r.__assign({},n.props.item.ItemId,{mailboxInfo:n.props.item.MailboxInfo}),We)},n.onTranslate=function(e,t){e.stopPropagation(),Object(re.k)("LaunchTranslateCommand",{subActionSource:n.getActionSource(t)},{actionSource:We}),Ne.w.import().then(function(e){e(Object(Ne.m)(n.props.item.ItemId.Id))})},n.onShowInImmersiveReader=function(e,t){e.stopPropagation(),Object(ae.d)(r.__assign({},n.props.item.ItemId,{mailboxInfo:n.props.item.MailboxInfo}),We,n.getActionSource(t))},n.onViewMessageSource=function(e,t){e.stopPropagation(),Object(re.k)("ViewMessageSource",{subActionSource:n.getActionSource(t)},{actionSource:We}),function(e){r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){return(t=document.createElement("div")).id="ViewMessageSourceDialog",document.body.appendChild(t),n=V.render(f.createElement(K,{onClose:function(){V.unmountComponentAtNode(t),document.body.removeChild(t)}}),t),Object(H.a)()?e.MimeContent?n.setContent(atob(e.MimeContent.Value)):G(e).then(function(t){e.MimeContent=t,n.setContent(atob(e.MimeContent.Value))}):L(e).then(function(e){n.setContent(e)}),[2]})})}(n.props.item)},n.onToggleUndoDarkMode=function(e,t){e.stopPropagation(),ke(n.props.viewState)},n.renderLikeCustomButtonMenuItem=function(e){return f.createElement(j,{ref:function(e){return n.customLikeButton=e},surfaceActionItem:e,message:n.props.item})},n}return r.__extends(t,e),t.prototype.disableTranslate=function(e){return!(e.CopyAllowed&&e.ForwardAllowed&&e.ReplyAllAllowed&&e.ReplyAllowed&&e.PrintAllowed&&Object(se.f)(this.props.item)&&Object(Ne.o)())},t.prototype.shouldAddBlockSafeSenderMenuItemForFolder=function(e){return!Object(Re.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(je.a)(e.Sender.Mailbox.EmailAddress)&&null!=q(e)},t.prototype.shouldAddAssignPolicyMenuItem=function(e){return!this.isGroupItem()&&(Object(Ee.G)(e,Ee.h)||Object(Ee.G)(e,Ee.c)||Object(Ee.G)(e,"favorites"))},t.prototype.blockMenuItemName=function(e){return Object(I.format)(k.a.itemHeaderBlock,q(e))},t.prototype.isCSAExperimentUser=function(){return Object(ie.d)("rp-csaExp")||Object(ie.d)("rp-csaExpWithMenuIcons")},t.prototype.isSmimeResponseDisabled=function(e){return e&&(!Object(ie.d)("cmp-smime")||this.props.viewState.isConversationItemPart)},t.prototype.createCommandBarItems=function(e,t,n){var o=this;this.commandBarHiddenOverflowItems=[];var i=[],a=[],s=Object(Le.i)(),c=this.isSmimeResponseDisabled(t);return(this.props.customizedSubsetActionKeys&&this.props.customizedSubsetActionKeys.length>0?s.filter(function(e){return o.props.customizedSubsetActionKeys.indexOf(e.key)>-1}):s).forEach(function(s){var u=o.tryCreateStaticActionCommandBarItem(s,e,t,n,c);if(u){var d=s.key;if(o.props.hideSurfaceButton)o.addItemToCommandBarOverflow(d,a,u);else if(o.isCSAExperimentUser()){var l=u;(o.props.shouldIncludeFullInfo||Object(ie.d)("rp-selectionUI"))&&Object(Le.n)(d)&&(l=r.__assign({},u),o.addItemToCommandBarSurface(d,i,u)),o.addItemToCommandBarOverflow(d,a,l)}else Object(Le.n)(d)?o.addItemToCommandBarSurface(d,i,u):o.addItemToCommandBarOverflow(d,a,u)}}),this.tryCreateAddinsCommandBarItems(i,a),!this.isCSAExperimentUser()||this.props.shouldIncludeFullInfo||Object(ie.d)("rp-selectionUI")||i.push({key:"charms",onRender:function(){return f.createElement("div",{className:He.surfaceActionsCommandBarCharms},o.renderCharms())}}),{items:this.props.hideSurfaceButton?[]:i,overflowItems:this.props.isFloatingActionBar?[]:a}},t.prototype.addItemToCommandBarSurface=function(e,t,n){n.isPinned=!0,Object(Le.o)(e)?t.push(n):t.unshift(n)},t.prototype.addItemToCommandBarOverflow=function(e,t,n){n.renderedInOverflow=!0,n.onRender=null,"-"==e?this.tryAddDivider(t,n):t.push(n)},t.prototype.tryAddDivider=function(e,t){var n=e.length;n>0&&e[n-1].displayName!=Le.a&&e.push(t)},t.prototype.tryCreateStaticActionCommandBarItem=function(e,t,n,r,o){if(e.hideInGroup&&this.isGroupItem()||e.hideInSxS&&this.props.isItemAttachment)return null;var i,a=e.key,s=Object(Le.g)(a),c=Object(Le.h)(a).iconName,u=null,d=!1,l=null,m=e.key,p=this.props.item;switch(a){case"LikeUnlike":if(Object(ie.d)("rp-like")&&!Object(H.a)()&&!Object(Ee.G)(p.ParentFolderId.Id,Ee.j)){var h=Object(b.a)().SessionSettings.UserEmailAddress,f=!!p.Likers&&p.Likers.some(function(e){return e.EmailAddress===h});i=this.onLikeUnLike(),f&&(c="LikeSolid",s=k.a.itemHeaderUnlike),Object(Le.n)(e.key)&&(l=this.renderLikeCustomButtonMenuItem)}break;case"Reply":i=this.onReply,d=!t.ReplyAllowed||r||o;break;case"ReplyAll":i=this.onReplyAll,d=!t.ReplyAllAllowed||r||o;break;case"Forward":i=this.onForward,d=!t.ForwardAllowed||o;break;case"ReplyByMeeting":i=this.onReplyByMeeting,d=n;break;case"Popout":this.props.isItemAttachment||this.props.isDeeplink||(i=this.onPopout);break;case"Delete":!this.props.isItemAttachment&&Object(ue.b)(8)&&(i=this.onDelete,d=!!this.isGroupItem()&&!p.CanDelete);break;case"MarkReadUnread":this.isGroupPopout()||(s=p.IsRead?k.a.markAsUnread:k.a.markAsRead,m=p.IsRead?"MarkItemUnread":"MarkItemRead",i=this.onToggleReadMenuItem);break;case"FlagUnflag":if(Object(ue.b)(10)){var I=!p.Flag||"Flagged"!=p.Flag.FlagStatus;s=I?k.a.itemHeaderFlag:k.a.itemHeaderUnflag,m=I?"FlagItem":"UnflagItem",i=this.onToggleFlagMenuItem}break;case"AssignPolicy":if(this.shouldAddAssignPolicyMenuItem(p.ParentFolderId.Id)){i=this.onAssignPolicy;var g=Object(z.x)();u=Object(Ae.c)(g?g.id:null,"RPCSAOverflow",this.props.item)}break;case"AddToSafeSenders":this.shouldAddBlockSafeSenderMenuItemForFolder(p)&&(i=this.onAddToSafeSenders);break;case"MarkJunkNotJunk":Object(ue.g)()&&Object(Ee.I)(p.ParentFolderId.Id)&&(s=this.isInJunkFolder?k.a.itemHeaderMarkAsNotJunk:k.a.itemHeaderMarkAsJunk,m=this.isInJunkFolder?"MarkItemNotjunk":"MarkItemJunk",i=this.onToggleJunkNotjunk());break;case"MarkAsPhishing":i=this.onPhishing;break;case"Block":this.shouldAddBlockSafeSenderMenuItemForFolder(p)&&Object(Ee.I)(p.ParentFolderId.Id)&&(s=this.blockMenuItemName(p),i=this.onBlock);break;case"ReportAbuse":Object(ie.d)("tri-reportAbuse")&&(s=k.a.reportAbuse,i=this.onReportAbuse);break;case"CreateRule":Object(Te.b)()&&this.itemHasSenderSMTP()&&Object(Ee.I)(p.ParentFolderId.Id)&&(i=this.onCreateRule);break;case"Print":i=this.onPrint,d=!t.PrintAllowed;break;case"Translate":i=this.onTranslate,d=this.disableTranslate(t);break;case"ShowInImmersiveReader":i=this.onShowInImmersiveReader;break;case"ViewMessageSource":i=this.onViewMessageSource;break;case"ToggleDarkMode":var v=this.props.viewState.undoDarkMode;s=v?k.a.itemHeaderLightsOff:k.a.itemHeaderLightsOn,c=v?"ClearNight":"Sunny",m=v?"ToggleDarkModeOn":"ToggleDarkModeOff",i=this.onToggleUndoDarkMode;break;case"-":return{key:(this.commandBarDividerKey++).toString(),displayName:Le.a,itemType:$.a.Divider,onClick:null}}return i?{key:a,name:s,iconProps:{iconName:c,className:Ue(He.commandBarIcon,{hideMenuIcon:!Object(ie.d)("rp-csaExpWithMenuIcons")})},onRender:l,disabled:d,onClick:this.getHandler(i,!0,m),onKeyDown:this.getHandler(i,!1,m),iconOnly:!0,ariaLabel:s,subMenuProps:u}:null},t.prototype.tryCreateAddinsCommandBarItems=function(e,t){var n=this;if(this.shouldAddinsPopulate()){var o,i=[],a=[],s=Object(Ge.c)(Ge.a.SurfaceActions);if(this.props.viewState.isConversationItemPart&&Object(ie.d)("rp-selectionUI")){var c=Object(ye.b)();o=c&&c.itemId}Object(te.a)(ne.a.MessageRead,this.props.item,o||this.props.item.ItemId.Id,s.readSurfaceAddins,i,a,!0,this.commandBarDividerKey,null,this.isCSAExperimentUser()),i.forEach(function(e){if(e.onClick){var t=e.onClick;e.onClick=n.getHandler(t,!0,"Addins"),e.onKeyDown=n.getHandler(t,!1,"Addins")}}),a.forEach(function(e){if(e.onClick){var t=e.onClick;e.onClick=n.getHandler(t,!0,"Addins"),e.onKeyDown=n.getHandler(t,!1,"Addins")}}),e.unshift.apply(e,r.__spread(i)),t.push.apply(t,r.__spread(a))}},t.prototype.componentDidMount=function(){_e.a.importAndExecute(this.onResize)},t.prototype.componentWillUnmount=function(){_e.c.importAndExecute(this.onResize)},t.prototype.componentDidUpdate=function(){this.shouldAddinsPopulate()&&Object(se.h)(Ne.g.Single,Object(Ne.m)(this.props.item.ItemId.Id))},t.prototype.render=function(){var e=this.props.isParentComponentMounted,t=null==e||e;return f.createElement("div",{className:He.surfaceActionsCommandBarContainer},t&&this.renderCommandBar())},t.prototype.renderCommandBar=function(){var e=this,t=Object(xe.a)(this.props.item),n=Object(De.a)(this.props.item),r=Object(ve.b)(this.props.item),o=this.createCommandBarItems(t,n,r),i=Ue(He.itemHeaderDropDownButtonCharms,this.customLikeButton&&this.customLikeButton.IsLikersListShown()&&He.hideCharms);return f.createElement(f.Fragment,null,f.createElement(X.a,{componentRef:function(t){return e.commandBar=t},items:o.items,overflowItems:o.overflowItems,overflowButtonProps:{menuIconProps:{iconName:"More",styles:{root:He.surfaceActionsCommandBarOverflowIcon}},ariaLabel:k.a.mailEllipsisAriaLabelText},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:Le.m,onDataGrown:Le.l,styles:{root:He.surfaceActionsCommandBar,primarySet:He.surfaceActionsCommandBarPrimarySet},ariaLabel:k.a.itemHeaderMessageActions,onReduceData:this.isCSAExperimentUser()?this.onCommandBarReduceData:void 0,onGrowData:this.isCSAExperimentUser()?this.onCommandBarGrowData:void 0}),!this.isCSAExperimentUser()&&!(this.props.shouldIncludeFullInfo||Object(ie.d)("rp-selectionUI"))&&f.createElement("div",{className:i},this.renderCharms()))},t.prototype.renderCharms=function(){var e=this.props.item;return f.createElement(o.b,{message:e,importance:e.Importance,hasAttachments:!1,flagStatus:e.Flag?e.Flag.FlagStatus:"NotFlagged",charmSize:o.a.size16,itemClass:e.ItemClass})},t.prototype.computeCommandBarCacheKey=function(e){return[e.reduce(function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)},""),"","overflow"].join(" ")},t.prototype.getConversationId=function(){var e=this.props.viewState.isConversationItemPart&&this.props.item.ConversationId?this.props.item.ConversationId.Id:null;return Object(Se.a)()?null:e},t.prototype.isGroupPopout=function(){return this.props.isDeeplink&&this.isGroupItem()},t.prototype.isGroupItem=function(){return!!this.props.item.MailboxInfo&&this.props.item.MailboxInfo.type===oe.a.GroupMailbox},Object.defineProperty(t.prototype,"isInJunkFolder",{get:function(){var e=this.props.item;return Object(Re.a)(e.ParentFolderId.Id,"junkemail")},enumerable:!0,configurable:!0}),t.prototype.itemHasSenderSMTP=function(){var e=Object(z.F)(this.props.item)?this.props.item:null;return!!(e&&e.From&&e.From.Mailbox)},t.prototype.shouldAddinsPopulate=function(){var e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&(this.props.shouldIncludeFullInfo||Object(ie.d)("rp-selectionUI"));return!(!Object(ie.d)("rp-addins")||!e||Object(ce.d)(this.getConversationId())||this.props.isItemAttachment||!Object(Ne.I)(this.props.item)||this.isGroupItem()||Object(Be.a)(this.props.item))},t.prototype.getActionSource=function(e){var t="RPCSAPinned";return e&&e.renderedInOverflow&&(t=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),this.props.actionSource&&(t=this.props.actionSource),t},r.__decorate([Z.computed],t.prototype,"isInJunkFolder",null),t=r.__decorate([i.observer],t)}(f.Component);n.d(t,"ItemActions",function(){return Qe}),n.d(t,"Charms",function(){return o.b})},833:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(7),o=n(47),i=n(5);function a(){return Object(o.a)()?Object(i.d)("cmp-encryption")&&Object(r.a)().SessionSettings.IsPremiumConsumerMailbox:Object(i.d)("cmp-manageIRM")&&Object(r.a)().SegmentationSettings.Irm}}},0,[5,6,14,19,179,9,11,217,2,3,8,66,0,1,4,162,176,10,17,193,310,254,279,51,280,57,283,80,289,109,300,186,184,56,72,100,178,182,236]]);
//# sourceMappingURL=owa.ItemActions.mail.js.map
window.scriptsLoaded['owa.ItemActions.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.ItemActions.mail.js'] = (new Date()).getTime();