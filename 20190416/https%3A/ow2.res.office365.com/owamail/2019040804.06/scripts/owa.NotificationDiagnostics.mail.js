window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.NotificationDiagnostics.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[188],{6998:function(t,n,e){"use strict";e.r(n);var i=e(0),a=e(356),r=e(5);function o(){return new Date(Date.now()).toLocaleTimeString()}function s(t,n,e){t.push(n),t.length>e&&t.splice(0,1)}var c,u=e(4),d=Object(u.action)("addChannelDatapoint")(function(t,n){s(n.datapoints,{message:t,timestamp:o()},1e3)}),p=e(895),f="Channel",l=!1;function b(t){!function(){i.__awaiter(this,void 0,void 0,function(){var t,n,e;return i.__generator(this,function(i){switch(i.label){case 0:return l?[3,3]:(l=!0,c={name:f,datapoints:[]},[4,p.b.import()]);case 1:return t=i.sent(),[4,p.c.import()];case 2:n=i.sent(),e=t(),n(c,e),c=e.loggers.get(f),i.label=3;case 3:return[2]}})})}(),d(t,c)}var v=e(10);function m(t){var n="";if(t){var e=v.n.folderTable.get(t);e&&(n=e.DisplayName)}return n}function h(t){var n="";return t.Conversation?n=t.Conversation.ConversationTopic:t.Item&&(n=t.Item.Subject),n}var g,w=Object(u.action)("addNotificationDatapoint")(function(t,n){var e=t,i=t;s(n.datapoints,{id:t.id,type:t.EventType,folder:m(e.FolderId||i.folderId),subject:h(e),timestamp:o()},1e3)}),_="Notifications",D=!1;function j(t){!function(){i.__awaiter(this,void 0,void 0,function(){var t,n,e;return i.__generator(this,function(i){switch(i.label){case 0:return D?[3,3]:(D=!0,g={name:_,datapoints:[]},[4,p.b.import()]);case 1:return t=i.sent(),[4,p.c.import()];case 2:n=i.sent(),e=t(),n(g,e),g=e.loggers.get(_),i.label=3;case 3:return[2]}})})}(),w(t,g)}var S,T=Object(u.action)("addSubscriptionDatapoint")(function(t,n){n.datapoints.push({id:t.subscriptionId,type:t.subscriptionParameters&&t.subscriptionParameters.NotificationType?t.subscriptionParameters.NotificationType:"",folder:t.subscriptionParameters?m(t.subscriptionParameters.FolderId):"",status:"Uninitialized",handlers:1,retries:0,error:""})}),I=Object(u.action)("removeSubscriptionDatapoint")(function(t,n){for(var e=n.datapoints,i=0;i<e.length;i++)if(e[i].id===t){e.splice(i,1);break}}),C=Object(u.action)("setSubscriptionDatapointStatus")(function(t,n,e,i,a,r){for(var o=r.datapoints,s=0;s<o.length;s++)if(o[s].id===t)switch(o[s].handlers=e,o[s].retries=i,a&&(o[s].error=a),n){case 0:o[s].status="Uninitialized";break;case 3:o[s].status="Connected";break;case 2:o[s].status="Pending";break;case 1:o[s].status="Disconnected"}}),N="Subscriptions",y=!1;function O(){return i.__awaiter(this,void 0,void 0,function(){var t,n,e;return i.__generator(this,function(i){switch(i.label){case 0:return y?[3,3]:(y=!0,S={name:N,datapoints:[]},[4,p.b.import()]);case 1:return t=i.sent(),[4,p.c.import()];case 2:n=i.sent(),e=t(),n(S,e),S=e.loggers.get(N),i.label=3;case 3:return[2]}})})}function P(t){O(),T(t,S)}function k(t,n,e){O(),C(t.subscriptionId,n.status,n.refs.length,n.retries,e,S)}function z(t){O(),I(t.subscriptionId,S)}var U=e(11);function E(t){U.c.warn(t)}function F(t){U.c.error(t)}function $(){return i.__awaiter(this,void 0,void 0,function(){var t,n;return i.__generator(this,function(e){switch(e.label){case 0:return Object(r.d)("fwk-devTools")?[4,a.d.import()]:[3,2];case 1:t=e.sent(),(n=t()).on(a.a.ChannelData,b),n.on(a.a.NotificationData,j),n.on(a.a.SubscriptionAdded,P),n.on(a.a.SubscriptionRemoved,z),n.on(a.a.SubscriptionUpdated,k),n.on(a.a.TraceWarn,E),n.on(a.a.TraceError,F),e.label=2;case 2:return[2]}})})}e.d(n,"initializeNotificationDiagnostics",function(){return $})}},0,[0,2,3,8,90,279,51,280,57,283,80,300,186]]);
//# sourceMappingURL=owa.NotificationDiagnostics.mail.js.map
window.scriptsLoaded['owa.NotificationDiagnostics.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.NotificationDiagnostics.mail.js'] = (new Date()).getTime();