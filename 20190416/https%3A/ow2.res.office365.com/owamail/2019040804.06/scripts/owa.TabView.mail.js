window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['owa.TabView.mail.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[246],{1301:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var r=a(6);function o(){var e=Object(r.x)();if(!e||!e.isInitialLoadComplete)return"Loading";var t=0==e.rowKeys.length;return 0!=e.loadErrorStatus&&t?"Error":t?"Empty":"Loaded"}},3175:function(e,t,a){"use strict";var r=a(3544),o=a(0),n=a(6);var i=a(138),l=a(4),c=Object(l.action)("clearReadingPaneStore")(function(e){switch(e){case 0:i.a.conversationReadingPaneViewState=null;break;case 1:i.a.itemReadingPaneViewState=null}}),s=a(2424),d=a(1258),f=a(746),u=a(66),m=a(97),h={onActivate:function(e){var t=e.data;if(!t.isCreatedFromSubjectPicker)switch(t.listViewType){case 0:Object(s.b)(t.id,t.instrumentationContext,t.subject);var a=Object(u.d)(t.id.Id);a&&u.u.importAndExecute(a);break;case 1:Object(d.a)(t.id,t.instrumentationContext,f.a)}},canClose:function(e){return o.__awaiter(void 0,void 0,void 0,function(){var t,a,r;return o.__generator(this,function(l){switch(l.label){case 0:switch(t=e.data,t.listViewType){case 0:return[3,1];case 1:return[3,4]}return[3,4];case 1:return(a=i.a.conversationReadingPaneViewState.conversationId.Id)==(c=Object(n.x)(),s=c.isInVirtualSelectAllMode,1!=(d=o.__spread(c.selectedRowKeys.keys())).length||s?null:n.b.getRowIdString(d[0],c))?[2,!0]:(r=Object(u.d)(a))?[4,u.z.importAndExecute(r)]:[3,3];case 2:return l.sent(),[2,!Object(u.d)(a)];case 3:case 4:return[2,!0]}var c,s,d})})},onDeactivate:function(e){var t=e.data;c(t.listViewType)}};var p=a(149);t.a=Object(l.action)("moveReadingPaneToTab")(function(e,t,a,o,n,i,l,c){void 0===i&&(i=!1);var s=Object(r.a)(e.Id);s&&(c||s.isShown||m.h.importAndExecute(s,!0),o&&m.e.importAndExecute(s)),s||function(e,t,a,r,o,n,i,l){void 0===n&&(n=!1);var c=Object(p.a)(),s={id:e,subject:t,categories:a,listViewType:null!=i?i:c.tableQuery.listViewType,isCreatedFromSubjectPicker:n,instrumentationContext:o};Object(m.j)(m.a.SecondaryReadingPane,h),m.f.importAndExecute(m.a.SecondaryReadingPane,!l,r,s)}(e,t,a,o,n,i,l,c)})},3544:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var r=a(0),o=a(97);function n(e){var t,a,n=Object(o.d)();try{for(var i=r.__values(n.tabs),l=i.next();!l.done;l=i.next()){var c=l.value;if(c.type===o.a.SecondaryReadingPane){var s=c.data;if(s.id&&s.id.Id==e)return c}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(a=i.return)&&a.call(i)}finally{if(t)throw t.error}}return null}},3546:function(e,t,a){"use strict";var r=a(0),o=a(2424),n=a(3175),i=a(138),l=a(162),c=a(59),s=a(97),d=a(124),f=a(4),u=a(66);t.a=Object(f.action)("loadConversationReadingPaneForSingleMailItemSelected")(Object(f.select)({conversationReadingPaneState:function(){return i.a.conversationReadingPaneViewState}})(function(e,t,a,i,f,m,h){return r.__awaiter(this,void 0,void 0,function(){var p,b,g,v,y,w,_=this;return r.__generator(this,function(x){if(p=Object(s.c)(),b=Object(d.a)(),y=Object(l.b)(),b&&p)switch(p.type){case s.a.SecondaryReadingPane:0==p.data.listViewType&&(v=Object(u.d)(h.conversationReadingPaneState.conversationId.Id),g=!!v);break;case s.a.Compose:v=y.viewStates.get(p.data);break;case s.a.Primary:v=h.conversationReadingPaneState?Object(u.d)(h.conversationReadingPaneState.conversationId.Id,!0):null,g=!!v;break;default:v=null}else v=y.viewStates.get(y.primaryComposeId);return h.conversationReadingPaneState&&h.conversationReadingPaneState.conversationId.Id==e.Id&&h.conversationReadingPaneState.currentSelectedFolderId==Object(c.b)()||v&&6!==v.asyncSendState&&!t?[2]:v?b&&p?(p.type==s.a.SecondaryReadingPane||g?(w=6==v.asyncSendState,Object(n.a)(h.conversationReadingPaneState.conversationId,h.conversationReadingPaneState.conversationSubject,h.conversationReadingPaneState.conversationCategories,!1,a,!1,0,w)):u.r.importAndExecute(v,!0,!1),[2,Object(o.b)(e,a,i,f,m)]):v.isInlineCompose?(u.z.importAndExecute(v).then(function(){return r.__awaiter(_,void 0,void 0,function(){return r.__generator(this,function(t){return v?[2]:[2,Object(o.b)(e,a,i,f,m)]})})}),[2]):(u.z.importAndExecute(v),[2,Object(o.b)(e,a,i,f,m)]):[2,Object(o.b)(e,a,i,f,m)]})})}))},3548:function(e,t,a){"use strict";var r=a(0),o=a(647),n=a(1017),i=a(30),l=a(519),c=a(163);t.a=Object(i.b)("closeTab",o.a.TabViewCloseTab)(function(e,t){return r.__awaiter(this,void 0,void 0,function(){var a,o,i,s;return r.__generator(this,function(r){switch(r.label){case 0:return a=!0,o=Object(l.a)(e.type),!t&&o&&o.canClose?[4,o.canClose(e)]:[3,2];case 1:a=r.sent(),r.label=2;case 2:return a&&(Object(n.a)(e,!1),i=Object(c.a)(),(s=i.tabs.indexOf(e))>=0&&i.tabs.splice(s,1)),[2]}})})})},4054:function(e,t,a){var r=a(5263),o=a(55);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)o.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},4449:function(e,t,a){var r=a(5264),o=a(55);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)o.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},5263:function(e,t,a){(t=e.exports=a(54)(!1)).push([e.i,'._3g-3C9EgqXAoivyXhpl_8s{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;height:32px}html[dir] ._3g-3C9EgqXAoivyXhpl_8s{background-color:"[theme:neutralQuaternary, default:#d0d0d0]"}._3g-3C9EgqXAoivyXhpl_8s._1RHn61VtVQ1ERw51W1GE2I{height:36px;pointer-events:none;width:100%}html[dir] ._3g-3C9EgqXAoivyXhpl_8s._1RHn61VtVQ1ERw51W1GE2I{border:solid "[theme:neutralQuaternaryAlt, default:#dadada]";background-color:"[theme:neutralLighterAlt, default:#f8f8f8]";border-width:1px 0 0;padding-top:4px}@-webkit-keyframes ygHGdT_Oi7NmiH7y7tYQ4{0%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}20%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}25%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}85%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}to{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}}@-webkit-keyframes _3HiOw4e4t5ssWGBgmBzqRs{0%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}20%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}25%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}85%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}to{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}}@keyframes ygHGdT_Oi7NmiH7y7tYQ4{0%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}20%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}25%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}85%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}to{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}}@keyframes _3HiOw4e4t5ssWGBgmBzqRs{0%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}20%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}25%{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}85%{color:"[theme:neutralSecondary, default:#666666]";background-color:"[theme:neutralLighter, default:#f4f4f4]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}to{color:"[theme:white, default:#ffffff]";background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}}.QC8HktsAo3W15G5QvXAII{-ms-flex-negative:1;flex-shrink:1;cursor:pointer;width:200px;min-width:80px;max-width:200px;vertical-align:middle;font-size:14px;color:"[theme:neutralSecondary, default:#666666]";text-overflow:ellipsis;white-space:nowrap}html[dir] .QC8HktsAo3W15G5QvXAII{border:solid "[theme:neutralQuaternary, default:#d0d0d0]";background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir=ltr] .QC8HktsAo3W15G5QvXAII{border-width:1px 1px 0 0}html[dir=rtl] .QC8HktsAo3W15G5QvXAII{border-width:1px 0 0 1px}html[dir] .QC8HktsAo3W15G5QvXAII:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}.QC8HktsAo3W15G5QvXAII._18MkjPukE-G5E0QCe50tDe{color:"[theme:themePrimary, default:#0078D4]"}html[dir] .QC8HktsAo3W15G5QvXAII._18MkjPukE-G5E0QCe50tDe{background-color:"[theme:white, default:#ffffff]";border-top-color:"[theme:white, default:#ffffff]"}.QC8HktsAo3W15G5QvXAII._18MkjPukE-G5E0QCe50tDe._1ByvODeSg__KmdEfhMso7C{min-width:300px;width:300px}.QC8HktsAo3W15G5QvXAII._3HiOw4e4t5ssWGBgmBzqRs{color:"[theme:white, default:#ffffff]"}html[dir] .QC8HktsAo3W15G5QvXAII._3HiOw4e4t5ssWGBgmBzqRs{background-color:"[theme:themePrimary, default:#0078D4]";border-top-color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] .QC8HktsAo3W15G5QvXAII._3HiOw4e4t5ssWGBgmBzqRs{-webkit-animation:_3HiOw4e4t5ssWGBgmBzqRs 2s 1 ease-out;animation:_3HiOw4e4t5ssWGBgmBzqRs 2s 1 ease-out}html[dir=rtl] .QC8HktsAo3W15G5QvXAII._3HiOw4e4t5ssWGBgmBzqRs{-webkit-animation:ygHGdT_Oi7NmiH7y7tYQ4 2s 1 ease-out;animation:ygHGdT_Oi7NmiH7y7tYQ4 2s 1 ease-out}._1R7-frZg3d0Nc3aDfZakdM .QC8HktsAo3W15G5QvXAII{height:18px;max-width:200px}._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII{pointer-events:auto;font-weight:600;vertical-align:middle;font-size:14px}html[dir] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII{border-color:"[theme:neutralQuaternaryAlt, default:#dadada]";border-radius:2px 2px 0 0;border-width:1px 1px 0}html[dir=ltr] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII{margin-left:8px}html[dir=rtl] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII{margin-right:8px}._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII._18MkjPukE-G5E0QCe50tDe{color:"[theme:themeSecondary, default:#2B88D8]"}html[dir] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII._18MkjPukE-G5E0QCe50tDe{background-color:"[theme:white, default:#ffffff]";border-top-color:"[theme:neutralQuaternary, default:#d0d0d0]"}._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII._18MkjPukE-G5E0QCe50tDe._1ByvODeSg__KmdEfhMso7C{min-width:300px;width:300px}html[dir=ltr] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII:first-child{margin-left:8px}html[dir=ltr] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII:last-child,html[dir=rtl] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII:first-child{margin-right:8px}html[dir=rtl] ._1RHn61VtVQ1ERw51W1GE2I .QC8HktsAo3W15G5QvXAII:last-child{margin-left:8px}._3g-3C9EgqXAoivyXhpl_8s._1xknpOIrglV3fYK1TVx-qG .QC8HktsAo3W15G5QvXAII._18MkjPukE-G5E0QCe50tDe._1ByvODeSg__KmdEfhMso7C{min-width:80px}._35yJQjGLO1BBWcheuJbFij{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir] ._35yJQjGLO1BBWcheuJbFij{padding:7px}._1RHn61VtVQ1ERw51W1GE2I ._35yJQjGLO1BBWcheuJbFij{-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir=ltr] ._1RHn61VtVQ1ERw51W1GE2I ._35yJQjGLO1BBWcheuJbFij{padding:0 10px 0 8px}html[dir=rtl] ._1RHn61VtVQ1ERw51W1GE2I ._35yJQjGLO1BBWcheuJbFij{padding:0 8px 0 10px}.wYTQXkoQ5cx3epox_Zhjo{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._2mEiVYyiE3moRVPABJgcum{font-size:14px}html[dir=ltr] ._2mEiVYyiE3moRVPABJgcum{margin-left:4px}html[dir=rtl] ._2mEiVYyiE3moRVPABJgcum{margin-right:4px}',""]),t.locals={tabBar:"_3g-3C9EgqXAoivyXhpl_8s",tabBarNew:"_1RHn61VtVQ1ERw51W1GE2I",tab:"QC8HktsAo3W15G5QvXAII",active:"_18MkjPukE-G5E0QCe50tDe",isChatTab:"_1ByvODeSg__KmdEfhMso7C",blink:"_3HiOw4e4t5ssWGBgmBzqRs","blink-rtl":"ygHGdT_Oi7NmiH7y7tYQ4",overflowMenuItem:"_1R7-frZg3d0Nc3aDfZakdM",shrinkChatTabs:"_1xknpOIrglV3fYK1TVx-qG",tabContent:"_35yJQjGLO1BBWcheuJbFij",subject:"wYTQXkoQ5cx3epox_Zhjo",overflowChevron:"_2mEiVYyiE3moRVPABJgcum"}},5264:function(e,t,a){(t=e.exports=a(54)(!1)).push([e.i,"._3ONvaxzTocLEByNby9c1Uj{font-size:14px}html[dir=ltr] ._3ONvaxzTocLEByNby9c1Uj{margin-right:4px}html[dir=rtl] ._3ONvaxzTocLEByNby9c1Uj{margin-left:4px}._362KfmV12ppDjrLeKlhLco{height:18px;width:18px}html[dir] ._362KfmV12ppDjrLeKlhLco.ms-Button{padding:0}._362KfmV12ppDjrLeKlhLco.ms-Button .ms-Icon{font-size:14px}html[dir] ._362KfmV12ppDjrLeKlhLco.ms-Button .ms-Icon{margin:0}",""]),t.locals={leftIcon:"_3ONvaxzTocLEByNby9c1Uj",rightIcon:"_362KfmV12ppDjrLeKlhLco"}},5265:function(e,t,a){var r=a(5266),o=a(55);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)o.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},5266:function(e,t,a){(t=e.exports=a(54)(!1)).push([e.i,".x_QBomBQVH-k3SdupL-iy{position:absolute;bottom:60px;width:100%;height:400px;overflow-wrap:normal;white-space:normal}html[dir=ltr] .x_QBomBQVH-k3SdupL-iy{left:0}html[dir=rtl] .x_QBomBQVH-k3SdupL-iy{right:0}._2zqJz9W1xJJHvwPgmsyIIm{display:none}._527t15gCjz76kBbLdiu3z{height:18px;width:18px}html[dir] ._527t15gCjz76kBbLdiu3z.ms-Button{padding:0}._527t15gCjz76kBbLdiu3z.ms-Button .ms-Icon{font-size:14px}html[dir] ._527t15gCjz76kBbLdiu3z.ms-Button .ms-Icon{margin:0}",""]),t.locals={chatContainer:"x_QBomBQVH-k3SdupL-iy",chatInactive:"_2zqJz9W1xJJHvwPgmsyIIm",rightIcon:"_527t15gCjz76kBbLdiu3z"}},5267:function(e,t,a){var r=a(5268),o=a(55);"string"==typeof r&&(r=[[e.i,r]]);for(var n=0;n<r.length;n++)o.loadStyles(r[n][1],!1);r.locals&&(e.exports=r.locals)},5268:function(e,t,a){(t=e.exports=a(54)(!1)).push([e.i,'._3pybz8bEN6xm5iCg-CLvWx{position:relative}._3pybz8bEN6xm5iCg-CLvWx:before{content:"\\1F81F";bottom:100%;font-size:1.2em;pointer-events:none;position:absolute;width:100%;color:"[theme:black, default:#000000]";opacity:0}html[dir] ._3pybz8bEN6xm5iCg-CLvWx:before{margin-bottom:.5em;text-align:center;-webkit-transition:opacity .2s,-webkit-transform .2s;transition:opacity .2s,-webkit-transform .2s;transition:opacity .2s,transform .2s;transition:opacity .2s,transform .2s,-webkit-transform .2s;-webkit-transform:translateY(.5em);transform:translateY(.5em)}html[dir=ltr] ._3pybz8bEN6xm5iCg-CLvWx:before{text-shadow:-1px -1px 0 "[theme:white, default:#ffffff]",0 -1px 0 "[theme:white, default:#ffffff]",1px -1px 0 "[theme:white, default:#ffffff]",1px 0 0 "[theme:white, default:#ffffff]",1px 1px 0 "[theme:white, default:#ffffff]",0 1px 0 "[theme:white, default:#ffffff]",-1px 1px 0 "[theme:white, default:#ffffff]",-1px 0 0 "[theme:white, default:#ffffff]"}html[dir=rtl] ._3pybz8bEN6xm5iCg-CLvWx:before{text-shadow:1px -1px 0 "[theme:white, default:#ffffff]",0 -1px 0 "[theme:white, default:#ffffff]",-1px -1px 0 "[theme:white, default:#ffffff]",-1px 0 0 "[theme:white, default:#ffffff]",-1px 1px 0 "[theme:white, default:#ffffff]",0 1px 0 "[theme:white, default:#ffffff]",1px 1px 0 "[theme:white, default:#ffffff]",1px 0 0 "[theme:white, default:#ffffff]"}._3pybz8bEN6xm5iCg-CLvWx.NDL70zgpfiP0PZ0kB5fLb:before{opacity:1}html[dir] ._3pybz8bEN6xm5iCg-CLvWx.NDL70zgpfiP0PZ0kB5fLb:before{-webkit-transform:translate(0);transform:translate(0)}',""]),t.locals={canHaveDragIndicator:"_3pybz8bEN6xm5iCg-CLvWx",withDragIndicator:"NDL70zgpfiP0PZ0kB5fLb"}},6923:function(e,t,a){"use strict";a.r(t);var r=a(412);a.d(t,"activateTab",function(){return r.a});var o=a(1096);a.d(t,"addTab",function(){return o.a});var n=a(3548);a.d(t,"closeTab",function(){return n.a});var i=a(1017);a.d(t,"setTabIsShown",function(){return i.a})},7004:function(e,t,a){"use strict";a.r(t);var r=a(0),o=a(3),n=a(412),i=a(7),l=a(175),c=a(8),s=a.n(c),d=a(6),f=a(202),u=a(17),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=e.subjectClassName,r="",n=Object(d.x)(),i=n&&1==n.tableQuery.type,c=n&&2==n.tableQuery.type;if(i)r=s.a.searchResults;else if(c){var u=f.e.tryImportSync();u&&(r=u(n))}else{var m=Object(l.a)();m&&(r=m.DisplayName)}return o.createElement("div",{className:t,title:r},o.createElement("div",{className:a},r))},t=r.__decorate([u.observer],t)}(o.Component),h=a(163),p=a(4),b=Object(p.action)("setIsOverflowMenuShown")(function(e){Object(h.a)().isOverflowMenuShown=e}),g=a(1326),v=a(78),y=a(354),w=a(20),_=a(4054),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissMenu=function(){b(!1)},t.onClick=function(){b(!0)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.viewState,r=t.className,n=t.subjectClassName,i=a.data,l=Object(w.format)(s.a.moreTabs,i.length);return o.createElement("div",{className:r,title:l,onClick:this.onClick,ref:function(t){return e.div=t}},o.createElement("div",{className:n},l),o.createElement(y.a,{iconName:"ChevronDown",className:_.overflowChevron}),Object(h.a)().isOverflowMenuShown&&o.createElement(g.a,{target:this.div,isBeakVisible:!1,directionalHint:v.DirectionalHint.topRightEdge,onDismiss:this.onDismissMenu},i.map(function(e){return o.createElement(K,{viewState:e,key:e.id})})))},t=r.__decorate([u.observer],t)}(o.Component),C=a(1301),k=a(138),I=a(66),E=a(229),j=a(4449),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,a=e.subjectClassName,n=Object(d.x)(),i=Object(d.k)(n),l=null;if(!n)return null;var c=n.isInVirtualSelectAllMode,f=Object(C.a)(),u="",m=r.__spread(n.selectedRowKeys.keys()),h=n.tableQuery.folderId;1!=m.length||c?u=c||m.length>0?Object(d.o)(n)?-1!==i?0===i?s.a.everythingSelectedFocused:s.a.everythingSelectedOther:s.a.everythingSelected:Object(w.format)(s.a.someItemsSelected,m.length):"Loaded"==f||k.a.shouldShowEmptyReadingPane?s.a.emptyStateMessageSelectAnItemToRead:"Empty"==f?Object(E.c)(h)||Object(E.b)(h)?s.a.folderIsBeingEmptied:s.a.folderIsEmpty:"Error"==f?s.a.mailListErrorMessage:1==n.tableQuery.type?s.a.searchResults:s.a.loadingFolder:(""==(u=d.b.getSubject(m[0],n)||"").trim()&&(u=s.a.noSubject),l=0==n.tableQuery.listViewType&&Object(I.d)(d.b.getRowIdString(m[0],n)));return o.createElement("div",{className:t,title:u},l&&o.createElement(y.a,{iconName:"Edit",className:j.leftIcon}),o.createElement("div",{className:a},u))},t=r.__decorate([u.observer],t)}(o.Component),O=a(728),S=a(3548),A=a(1132),P=a(5265),R=a(160).bind(P),D="Skype Chat Tab",B=function(e){function t(t){var a=e.call(this,t)||this;return a.conversationProxy=null,a.onComponentRefUpdated=function(e){return function(t){if(t&&window.swc&&!a.conversationProxy){var r=window.swc.SDK.Chat.startChat({ConversationId:e},t),o=a.props.viewState;r.then(function(e){a._isMounted&&(a.conversationProxy=e,a.conversationProxy.onTitle&&a.conversationProxy.onTitle(function(e){a.setState({chatTitle:e})}),a.conversationProxy.onUnreadCount&&a.conversationProxy.onUnreadCount(function(e){a.setState({unreadCount:e})}),a.conversationProxy.onClose&&a.conversationProxy.onClose(function(){Object(S.a)(o)}),a.conversationProxy.onCollapse&&a.conversationProxy.onCollapse(function(e){o.isChatActive&&e&&Object(A.a)(o)}))})}}},a.onClickCloseButton=function(e){e.stopPropagation(),Object(S.a)(a.props.viewState)},a.containerOnClick=function(e){e.stopPropagation()},a.state={chatTitle:D,unreadCount:0},a}return r.__extends(t,e),t.prototype.componentDidMount=function(){this._isMounted=!0},t.prototype.componentWillUnmount=function(){this._isMounted=!1,this.conversationProxy=null},t.prototype.render=function(){var e=this.props,t=e.viewState,a=e.className,r=e.subjectClassName,n=t.isChatActive,i=t.data,l=this.state.unreadCount>0?"("+this.state.unreadCount+") "+this.state.chatTitle:this.state.chatTitle;return o.createElement("div",{className:a,title:l},o.createElement("div",{className:R(P.chatContainer,{chatInactive:!n}),onClick:this.containerOnClick},o.createElement("div",{className:"swc chat",ref:this.onComponentRefUpdated(i)})),o.createElement("div",{className:r},l),o.createElement(O.IconButton,{iconProps:{iconName:"Cancel"},onClick:this.onClickCloseButton,className:P.rightIcon,"aria-label":s.a.closeTabAriaLabel}))},t=r.__decorate([u.observer],t)}(o.Component),T=a(46),W=a(4449),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCloseButton=function(e){e.stopPropagation(),Object(S.a)(t.props.viewState)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.viewState,a=e.className,r=e.subjectClassName,n=t.data,i=n.subject;""==(i=i||"").trim()&&(i=s.a.noSubject);var l=0==(Object(d.x)()&&Object(d.x)().tableQuery.listViewType)&&Object(I.d)(n.id.Id);return o.createElement("div",{className:a,title:i},l&&o.createElement(y.a,{iconName:"Edit",className:W.leftIcon}),o.createElement("div",{className:r},i),o.createElement(O.IconButton,{iconProps:{iconName:"Cancel"},onClick:this.onClickCloseButton,className:W.rightIcon,"aria-label":s.a.closeTabAriaLabel}))},t=r.__decorate([u.observer],t)}(o.Component),V=a(22),H=a(69),L=a(5267),N=a(160).bind(L),z=function(e){function t(t){var a=e.call(this,t)||this;return a.dragoverTimerId=null,a.dragCounter=0,a.onDragEnter=function(){a.dragCounter++,null===a.dragoverTimerId&&(a.dragoverTimerId=window.setTimeout(a.executeCallback,a.props.dragTimeoutMs),a.setState({isDraggingOver:!0}))},a.onDragLeave=function(){a.dragCounter--,null===a.dragoverTimerId||a.dragCounter>0||a.clearDragoverTimer()},a.executeCallback=function(){a.dragoverTimerId=null,a.props.onDragTimeout(),a.setState({isDraggingOver:!1})},a.clearDragoverTimer=function(){window.clearTimeout(a.dragoverTimerId),a.dragoverTimerId=null,a.setState({isDraggingOver:!1})},a.state={isDraggingOver:!1},a}return r.__extends(t,e),t.prototype.render=function(){var e,t=r.__assign({},this.props);return delete t.onDragEnter,delete t.onDragLeave,delete t.showDragIndicatorArrow,delete t.onDragTimeout,delete t.dragTimeoutMs,delete t.className,o.createElement("div",r.__assign({},t,{className:N(this.props.className||"",(e={},e[L.withDragIndicator]=this.state.isDraggingOver&&this.props.showDragIndicatorArrow,e[L.canHaveDragIndicator]=this.props.showDragIndicatorArrow,e)),onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave}))},t.prototype.componentWillUnmount=function(){this.clearDragoverTimer()},t}(o.Component),M=a(513),X=a(4054),J=a(160).bind(X),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.activateThisTab=function(){t.props.viewState.type!=H.a.OverflowMenu&&Object(n.a)(t.props.viewState,!0)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.viewState,t=e.isActive,a=e.blink,n=e.type,l=null,c={className:X.tabContent,subjectClassName:X.subject};switch(e.type){case H.a.OverflowMenu:l=o.createElement(x,r.__assign({},r.__assign({},c,{viewState:e})));break;case H.a.FloatingChat:l=o.createElement(B,r.__assign({},r.__assign({},c,{viewState:e})));break;case H.a.Compose:l=o.createElement(M.c,r.__assign({},r.__assign({},c,{viewState:e})));break;case H.a.SecondaryReadingPane:l=o.createElement(G,r.__assign({},r.__assign({},c,{viewState:e})));break;case H.a.Primary:l=Object(i.a)().UserOptions.GlobalReadingPanePositionReact==T.a.Off&&!V.a.mailModule.showReadingPane?o.createElement(m,r.__assign({},r.__assign({},c,{viewState:e}))):o.createElement(Q,r.__assign({},r.__assign({},c,{viewState:e})))}var s=J(X.tab,{active:t,blink:a,isChatTab:n==H.a.FloatingChat});return o.createElement(z,{className:s,dragTimeoutMs:250,onClick:this.activateThisTab,onDragTimeout:this.activateThisTab,showDragIndicatorArrow:!0},l)},t=r.__decorate([u.observer],t)}(o.Component),F=a(5),q=1,Y=81,U=89,Z=310,$=8;function ee(e){return e.type==H.a.FloatingChat&&e.isChatActive?Z:te()}function te(){return Object(F.d)("rp-newTabLook")?U:Y}var ae=function(){var e=Object(h.a)(),t=e.tabs.filter(function(e){return e.isShown}),a=e.tabBarWidth,o=a-(Object(F.d)("rp-newTabLook")?$:0),i=!1;if(t.reduce(function(e,t){return e+ee(t)},0)-(Object(F.d)("rp-newTabLook")?$:0)>o){var l=[],c=[],s=t.splice(0,q);t.forEach(function(e){e.isActive?e.type==H.a.FloatingChat?l.push(e):l.unshift(e):c.push(e)}),t=r.__spread(s,l,c);var d=void 0;for(d=0;o>0&&d<t.length;d++){var f=t[d];if((o-=i?ee(f):te())<0){if(f.type!=H.a.FloatingChat||!f.isChatActive)break;if(i=!0,(o=a-(d+1*te()))<0)break}}var u=t.splice(d-1).map(function(e){return e.type==H.a.FloatingChat&&e.isChatActive&&Object(n.a)(e),e});t.push({id:"overflowMenu",type:H.a.OverflowMenu,isActive:!1,isShown:!0,blink:!1,data:u})}return{visibleTabs:t,shouldShrinkActiveChatTabs:i}},re=a(3546),oe=a(1258),ne=a(746),ie=a(358),le=a(97),ce={onActivate:function(e){var t=Object(d.x)();if(V.a.mailModule.showReadingPane&&t){var a=t.isInVirtualSelectAllMode,o=r.__spread(t.selectedRowKeys.keys());if(1==o.length&&!a){var n=d.b.getRowClientItemId(o[0],t),i=t.tableQuery.listViewType,l=Object(ie.a)([o[0]],t)[0];switch(i){case 0:var c=d.b.getSubject(o[0],t),s=d.b.getCategories(o[0],t);Object(re.a)(n,!0,l,c,s);var f=Object(I.d)(n.Id);f&&I.u.importAndExecute(f);break;case 1:Object(oe.a)(n,l,ne.a,null,null)}}}}};var se=a(181),de=Object(p.action)("setTabBarWidth")(function(e){Object(h.a)().tabBarWidth=e}),fe=a(4054),ue=a(160).bind(fe),me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onResize=function(){if(t.div){var e=t.div.clientWidth;e>0&&e!=Object(h.a)().tabBarWidth&&de(e)}},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){se.a.importAndExecute(this.onResize),this.onResize()},t.prototype.componentWillUnmount=function(){se.c.importAndExecute(this.onResize)},t.prototype.render=function(){var e=this;Object(le.j)(le.a.Primary,ce);var t=ae(),a=t.visibleTabs,r=t.shouldShrinkActiveChatTabs;return o.createElement("div",{className:ue(fe.tabBar,{tabBarNew:Object(F.d)("rp-newTabLook"),shrinkChatTabs:r}),ref:function(t){return e.div=t}},a.map(function(e){return o.createElement(K,{key:e.id,viewState:e})}))},t=r.__decorate([u.observer],t)}(o.Component);a.d(t,"TabBar",function(){return me})}},0,[5,6,14,19,179,2,3,8,9,66,0,1,4,162,7,23,62,279,51,280,57,283,80,72,100,182,236]]);
//# sourceMappingURL=owa.TabView.mail.js.map
window.scriptsLoaded['owa.TabView.mail.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['owa.TabView.mail.js'] = (new Date()).getTime();