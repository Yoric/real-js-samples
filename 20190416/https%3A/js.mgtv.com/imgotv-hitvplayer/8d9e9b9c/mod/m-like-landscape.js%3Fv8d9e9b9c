honey.def("lib:jquery, lib:mustache, plugin:stk",function(a){var i="//rc.log.mgtv.com/rpt",n=new STK.start,d=null,r=function(a,t){var e=[];if(!a)return"";for(var i=0;i<a.length;i++)e.push(a[i][t]);return e.join(",")},o=!1;try{o=!![].map&&0==document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(t){}var s=function(){},c=function(a,t){var e=this;e.box=$(a),e.wrap=$(t.wrap),e.changeBtn=t.changeBtn,e.unit=e.box.find("li.v-slider-fav-item").width()||190,e.gap=t.gap||10,e.row=t.row||2,e.portraitClass=t.portraitClass||"like-portrait",e.onClickEvent=t.onClickEvent||s,e.onPvEvent=t.onPvEvent||s,e.onChangeEvent=t.onChangeEvent||s,e.index=0,e.data={data:[]},e.tpl="",e.page=2,e.init(),e.bindEvents()};c.prototype.init=function(){var a=this,t={guid:$.cookie("MQGUID")||"748809690125176832",uid:$.cookie("uuid")||"1",cookie:$.cookie("__STKUUID")||"ccc",vid:VIDEOINFO.vid,c:VIDEOINFO.videocid||VIDEOINFO.rid||""};a.hasReportPV=!1,d=$.ajax({async:!1,type:"get",url:"//rc.mgtv.com/pc/like",data:t,dataType:"jsonp",jsonpCallback:"rc_like",success:function(t){d=null,t&&t.data&&t.data.length?(a.tpl=$("#jTmpl_player_guessLike_"+t.style).html(),a.data=t,$.each(t.data,function(a){t.data[a].tpl=function(a,t){var e=a.type,i="";t=o?1==t?"_220x125_h.webp":"_220x310_h.webp":1==t?"_220x125.jpg":"_220x310.jpg";var n=['<a class="u-video" href="'+a.play_url+'" target="_blank">','<img class="u-image"  class="lazy" data-original="'+a.image+t+'" src="'+a.image+t+'?BacuIUiq/c" alt="'+a.title+'">','<em class="u-catg">'+a.plcount+"</em>","</a>",'<a class="u-title" href="'+a.play_url+'" target="_blank">'+a.name+"</a>",'<span class="u-desc">'+a.info+"</span>"].join(""),d=['<a class="u-video" href="'+a.play_url+'" target="_blank">','<img class="u-image"  class="lazy" data-original="'+a.image+t+'" src="'+a.image+t+'?BacuIUiq/c" alt="'+a.title+'">','<em class="u-time">'+a.desc+"</em>","</a>",'<a class="u-title" href="'+a.play_url+'" target="_blank">'+a.name+"</a>",'<span class="u-desc">'+a.info+"</span>"].join("");switch(e){case 1:i=d;break;case 2:i=n;break;case 3:i=d}return i}(t.data[a],t.style)}),a.normalize(),a.render()):(a.data={data:[]},a.hasReportPV=!0,$(".m-sliderheader").hide())}})},c.prototype.sendPvEvent=function(){var a=this,t={bid:"1.1.4",time:STK.$.getTimer("yyyyMMddhhmmss"),act:"relatepv",ver:a.data.ver||"",reqid:a.data.reqid||"",region:VIDEOINFO.region||"2",cid:VIDEOINFO.rid,rcdata:r(a.data.data,"videoId")||"",videoid:VIDEOINFO.vid,vidauto:0,rctype:r(a.data.items,"rcType")};a.onPvEvent.call(a,t),n.pageEvent(t,i)},c.prototype.sendClickEvent=function(a){var t=this,e={bid:"1.1.4",time:STK.$.getTimer("yyyyMMddhhmmss"),act:"recommended",ver:t.data.ver||"",reqid:t.data.reqid||"",region:VIDEOINFO.region||"2",cid:VIDEOINFO.rid,rcdata:r(t.data.data,"videoId")||"",hitid:a.hitid,pos:a.pos,videoid:VIDEOINFO.vid,vidauto:0,rctype:r(t.data.items,"rcType")};t.onClickEvent.call(t,e),n.pageEvent(e,i)},c.prototype.sendChangeEvent=function(){var a=this,t={bid:"1.1.4",time:STK.$.getTimer("yyyyMMddhhmmss"),act:"change",ver:a.data.ver||"",reqid:a.data.reqid||"",region:VIDEOINFO.region||"2",mdname:"relate",zxdata:r(a.data.items,"videoId")||"",videoid:VIDEOINFO.vid,vidauto:0,cid:VIDEOINFO.rid,rctype:r(a.data.items,"rcType")};a.onChangeEvent.call(a,t),n.pageEvent(t,i)},c.prototype.bindEvents=function(){var e=this;this.hasBindEvents||(this.hasBindEvents=!0,e.wrap.on("click",e.changeBtn,function(a){a.preventDefault(),e.sendChangeEvent(),e.change()}),e.box.on("click",".v-slider-fav-item",function(a){var t=$(this);e.sendClickEvent({hitid:t.data("vid"),pos:t.index()+1,videoid:VIDEOINFO.vid})}),$(document).on("page.reload.mock",function(){d&&d.abort(),d=null,e.init()}),$(window).on("onResizeEx",function(){e.render()}),$(document).on("scroll.player",function(){480<$(this).scrollTop()&&!e.hasReportPV&&(e.sendPvEvent(),e.hasReportPV=!0)}))},c.prototype.change=function(){var a=this,t=a.box.innerWidth(),e=Math.ceil(t/(a.unit+a.gap))*a.page,i=Math.ceil(a.data.data.length/e);a.index++,a.index>=i&&(a.index=0),a.render()},c.prototype.normalize=function(){for(var a,t=this.data.data.length,e=0;e<t;e++)(a=this.data.data[e]).isPlayList=2==a.type},c.prototype.render=function(){var a=this,t=a.box.innerWidth(),e=a.row*Math.ceil(t/(a.unit+a.gap)),i=a.data.data.length,n=(a.index+1)*e>=i,d=n?Math.max(i-e,0):a.index*e,r=n?i:(a.index+1)*e;a.data.items=a.data.data.slice(d,r),i<=e&&(a.data.items=a.data.data);var o=Mustache.render(a.tpl,a.data);a.box.html(o),2==a.data.style&&a.box.addClass(a.portraitClass),e<i?$(a.changeBtn).show():$(a.changeBtn).hide()},$.fn.likeLandscape=function(e,i){var n="change-plugin";return this.each(function(){var a=$(this),t=a.data(n);"string"==typeof e?t&&"function"==typeof t[e]&&t[e](i):(t&&t.dispose&&t.dispose(),t=new c(this,e),a.data(n,t))})}});