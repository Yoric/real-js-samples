"use strict";honey.def("lib:jquery, lib:mustache, plugin:stk",function(t){new STK.start;var d="",s=a("uuid")||"",e=""==a("HDCN")?"":a("HDCN").match(/\b\w+\b/g)[0];function a(t){var a=new RegExp("(?:^|;+|\\s+)"+t+"=([^;]*)"),i=document.cookie.match(a);return i?i[1]:""}var l=$("#v-slider-star-box"),n=$("div[node-type=m-starlist]"),o=$("div[node-type=u-turn]"),r=!1,i=function(t){var a,i;a="//mgtpl.api.max.mgtv.com/fans/isFans?uid="+s+"&artistId="+t.join(",")+"&token="+e,i=function(t){if(t&&0==t.code){var a=t.data;a.length&&$.each(a,function(t){$("li[online="+a[t]+"]").find(".u-follow").addClass("u-followed").find("em").html("已关注")})}},$.ajax({url:a,type:"GET",dataType:"jsonp"}).done(function(t){t&&i.call(this,t)}).fail(function(){console.log("data error")})},c=1,h=1,u=[],p=function(s){if(s&&0<s.data.length){var t=s.data.length;$.each(s.data,function(t){var a,i;s.data[t].headerPhotoUrl=(a=s.data[t].headerPhotoUrl,(i=new RegExp("^((https|http)?://)")).test("http://"),i.test(a)?a:"//"+Math.floor(5*Math.random())+"img.imgo.tv/preview"+a),s.data[t].url="//www.mgtv.com/fantuan/"+s.data[t].uid+"/list.html",t<3&&u.push(s.data[t].uid)}),3<t&&l.addClass("fix");h=Math.ceil(t/3);var a=$("#v-slider-star-box"),i=Mustache.render(d,s);l.html(i),l.parent().show(),t<=3&&o.hide();var e=$("#v-slider-star li");e.each(function(t){var a=$(this),i=Math.ceil((t+1)/3);a.addClass("star_row_"+i),a.attr("page-data",i)}),$("li[page-data=1]",a).show(),$(document).scroll(function(){$(this).scrollTop()>n.position().top&&(r||(MgStat.send("udp",{mod:"syu1t3",ctl:window.VIDEOINFO.mod},{event:"show"}),r=!0))})}else $(".m-starlist").hide()};o.on("click","#starlist-next",function(){if($(this).hasClass("disabled"))return!1;if(++c==h&&$(this).addClass("disabled"),c<=h){var t=$("#v-slider-star");$("li",t).hide(),$("li[page-data="+c+"]",t).show(),$("#starlist-prev").removeClass("disabled")}var a=[];$("li[page-data="+c+"]",t).each(function(t){a.push($(this).attr("online"))}),i(a)}),o.on("click","#starlist-prev",function(){if($(this).hasClass("disabled"))return!1;if(1==--c&&$(this).addClass("disabled"),1<=c){var t=$("#v-slider-star");return $("li",t).hide(),$("li[page-data="+c+"]",t).show(),$("#starlist-next").removeClass("disabled"),!1}});var v=function(){var t=window.STK&&window.STK.$.getCxid("cxid")||"";$.ajax({url:"//pcweb.api.mgtv.com/star/list?video_id="+VIDEOINFO.vid+"&cxid="+t,type:"GET",async:!1,dataType:"jsonp",jsonpCallback:"mgtvcallback_psl",success:function(t){if(t&&200==t.code){d=$("#jTmpl_star_player_list").html();p(t=t)}else $(".m-starlist").hide()}})};v(),$(document).on("page.reload.mock",function(){u=[],v()})});