mw.loader.implement("ext.gadget.ReferenceTooltips@164k9dv",function($,jQuery,require,module){$(function(){var settings,settingsString,$footer,enabled,delay,isTouchscreen,settingsMenu;if(window.pg){return;}function toggleRT(enable){mw.loader.using('jquery.cookie',function(){$.cookie('RTsettings',(enable?'1':'0')+'|'+settings[1]+'|'+settings[2],{path:'/',expires:90});location.reload();});}if($.inArray(mw.config.get('wgCanonicalNamespace'),['','Project','Help','Draft'])!==-1){mw.messages.set({'RT-enable':'Enable Reference Tooltips','RT-disable':'Disable Reference Tooltips','RT-disablenote':'Once disabled, Reference Tooltips can be re-enabled using a link in the footer of the page.','RT-delay':'Delay before the tooltip appears (in milliseconds): ','RT-activationmethod':'Tooltip is activated by:','RT-hovering':'hovering','RT-clicking':'clicking','RT-options':'Reference Tooltips options','RT-options-save':'Save settings','RT-settings':'Tooltip settings'});settingsString=document.cookie.split
('RTsettings=')[1];if(settingsString){settings=settingsString.split(';')[0].split('%7C');enabled=!!+settings[0];delay=+settings[1];isTouchscreen=!!+settings[2];}else{enabled=!0;delay=200;isTouchscreen='ontouchstart'in document.documentElement;}if(!enabled){$footer=$('#footer-places, #f-list');if($footer.length===0){$footer=$('#footer li').parent();}$footer.append($('<li>').append($('<a>').text(mw.message('RT-enable')).attr('href','').on('click',function(e){e.preventDefault();toggleRT(true);})));return;}$('.reference').each(function(){var tooltipNode,hideTimer,showTimer,checkFlip=!1;function findRef(h){h=h.firstChild;h=h&&h.getAttribute&&h.getAttribute('href');h=h&&h.split('#');h=h&&h[1];h=h&&document.getElementById(h);h=h&&h.nodeName==='LI'&&h;return h;}function hide(refLink){if(tooltipNode&&tooltipNode.parentNode===document.body){hideTimer=setTimeout(function(){$(tooltipNode).animate({opacity:0},100,function(){document.body.removeChild(tooltipNode);});},isTouchscreen?16:100);}
else{$(findRef(refLink)).removeClass('RTTarget');}}function show(){if(!tooltipNode.parentNode||tooltipNode.parentNode.nodeType===11){document.body.appendChild(tooltipNode);checkFlip=!0;}$(tooltipNode).stop().animate({opacity:1},100);clearTimeout(hideTimer);}function openSettingsMenu(){if(settingsMenu){settingsMenu.dialog('open');}else{settingsMenu=$('<form>').append($('<button>').css('width','100%').text(mw.msg('RT-disable',mw.user)).button().on('click',function(e){e.preventDefault();toggleRT(false);}),$('<br>'),$('<small>').text(mw.msg('RT-disablenote')),$('<hr>'),$('<label>').text(mw.msg('RT-delay')).append($('<input>').attr({type:'number',value:delay,step:50,min:0,max:5000})),$('<br>'),$('<span>').text(mw.msg('RT-activationmethod',mw.user)),$('<label>').append($('<input>').attr({type:'radio',name:'RTActivate',checked:!isTouchscreen?'checked':undefined,disabled:'ontouchstart'in document.documentElement?'disabled':undefined}),mw.msg('RT-hovering',mw.user)),$('<label>').append($(
'<input>').attr({type:'radio',name:'RTActivate',checked:isTouchscreen?'checked':undefined}),mw.msg('RT-clicking',mw.user))).submit(function(e){e.preventDefault();}).dialog({modal:!0,width:500,title:mw.msg('RT-options'),buttons:[{text:mw.msg('RT-options-save',mw.user),click:function(){var inputs=this.getElementsByTagName('input'),newDelay=+inputs[0].value;$.cookie('RTsettings','1|'+(newDelay>-1&&newDelay<5001?newDelay:delay)+'|'+(inputs[1].checked?'0':'1'),{path:'/',expires:90});location.reload();}}]});}}function onStartEvent(e){var onBodyClick,self=this;if(window.pg){return;}if(isTouchscreen){e.preventDefault();if(!(tooltipNode&&tooltipNode.parentNode===document.body)){onBodyClick=function(e){e=e||event;e=e.target||e.srcElement;for(;e&&!$(e).hasClass('referencetooltip');){e=e.parentNode;}if(!e){clearTimeout(showTimer);hide(self);$(document.body).off('click touchstart',onBodyClick);}};setTimeout(function(){$(document.body).on('click touchstart',onBodyClick);});}}if(hideTimer){
clearTimeout(hideTimer);}if(showTimer){clearTimeout(showTimer);}showTimer=setTimeout(function(){var windowTop,hOffsetTop,c,o,oH,h=findRef(self);if(!h){return;}windowTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;hOffsetTop=$(h).offset().top;if(!isTouchscreen&&windowTop<hOffsetTop&&windowTop+$(window).height()>hOffsetTop+h.offsetHeight){$(h).addClass('RTTarget');return;}if(!tooltipNode){tooltipNode=document.createElement('ul');tooltipNode.className='referencetooltip';c=tooltipNode.appendChild($(h).clone(true)[0]);try{if(c.firstChild.nodeName!=='A'){while(c.childNodes[1].nodeName==='A'&&c.childNodes[1].getAttribute('href').indexOf('#cite_ref-')!==-1){do{c.removeChild(c.childNodes[1]);}while(c.childNodes[1].nodeValue===' ');}}}catch(err){mw.log(err);}c.removeChild(c.firstChild);$(tooltipNode.firstChild.insertBefore(document.createElement('span'),tooltipNode.firstChild.firstChild)).addClass('RTsettings').attr('title',mw.msg('RT-settings')).on('click'
,function(){mw.loader.using(['jquery.cookie','jquery.ui.dialog'],openSettingsMenu);});tooltipNode.appendChild(document.createElement('li'));if(!isTouchscreen){$(tooltipNode).on('mouseenter',show).on('mouseleave',hide);}}show();o=$(self).offset();oH=tooltipNode.offsetHeight;$(tooltipNode).css({top:o.top-oH,left:o.left-7});if(tooltipNode.offsetHeight>oH){$(tooltipNode).css({left:'auto',right:0});tooltipNode.lastChild.style.marginLeft=(o.left-tooltipNode.offsetLeft)+'px';}if(checkFlip){if(o.top<tooltipNode.offsetHeight+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0)){$(tooltipNode).addClass('RTflipped').css({top:o.top+12});}else if(tooltipNode.className==='referencetooltip RTflipped'){$(tooltipNode).removeClass('RTflipped');}checkFlip=!1;}},isTouchscreen?0:delay);}function onEndEvent(){clearTimeout(showTimer);hide(this);}$(this).on(isTouchscreen?{click:onStartEvent}:{mouseenter:onStartEvent,mouseleave:onEndEvent});});}});},{"css":[
".referencetooltip{position:absolute;list-style:none;list-style-image:none;opacity:0;font-size:12px;margin:0;z-index:5;padding:0}.referencetooltip \u003E li{background:#fff;border:1px solid #bbb;-webkit-box-shadow:0 0 10px rgba(0,0,0,0.2);-moz-box-shadow:0 0 10px rgba(0,0,0,0.2);box-shadow:0 0 10px rgba(0,0,0,0.2);margin:0;padding:8px 10px;line-height:18px;max-width:300px}.referencetooltip \u003E li + li{box-sizing:border-box;margin-left:7px;margin-top:-1px;border:0;padding:0;height:3px;width:0;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;border-top:12px #bbb solid;border-right:7px transparent solid;border-left:7px transparent solid}.referencetooltip \u003E li + li::after{z-index:111;content:'';border:6px solid transparent;border-bottom:0;border-top:8px solid #fff;height:0;width:0;display:block;margin-left:-6px;margin-top:-12px}.RTflipped{padding-top:13px}.referencetooltip.RTflipped \u003E li + li{position:absolute;top:0;border-top:0;border-bottom:12px #bbb solid}.referencetooltip.RTflipped \u003E li + li::after{border-top:0;border-bottom:8px #fff solid;position:absolute;margin-top:7px}.RTsettings{ background-image:linear-gradient(transparent,transparent),url(data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0D%0A%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%3E%0D%0A%20%20%20%20%3Cpath%20fill%3D%22%23555%22%20d%3D%22M20%2014.5v-2.9l-1.8-.3c-.1-.4-.3-.8-.6-1.4l1.1-1.5-2.1-2.1-1.5%201.1c-.5-.3-1-.5-1.4-.6L13.5%205h-2.9l-.3%201.8c-.5.1-.9.3-1.4.6L7.4%206.3%205.3%208.4l1%201.5c-.3.5-.4.9-.6%201.4l-1.7.2v2.9l1.8.3c.1.5.3.9.6%201.4l-1%201.5%202.1%202.1%201.5-1c.4.2.9.4%201.4.6l.3%201.8h3l.3-1.8c.5-.1.9-.3%201.4-.6l1.5%201.1%202.1-2.1-1.1-1.5c.3-.5.5-1%20.6-1.4l1.5-.3zM12%2016c-1.7%200-3-1.3-3-3s1.3-3%203-3%203%201.3%203%203-1.3%203-3%203z%22%2F%3E%0D%0A%3C%2Fsvg%3E);  display:block;float:right;cursor:pointer;margin:0;margin-top:-4px;height:24px;width:24px;border-radius:2px;box-sizing:border-box;background-position:center center;background-repeat:no-repeat;background-size:24px 24px;margin-left:8px}.RTsettings:hover{background-color:#eee}.RTTarget{background-color:#def}"
]});