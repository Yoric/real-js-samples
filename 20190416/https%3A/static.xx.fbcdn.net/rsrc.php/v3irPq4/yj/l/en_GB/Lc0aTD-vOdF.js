if (self.CavalryLogger) { CavalryLogger.start_js(["aSP\/\/"]); }

__d("dangerouslyBypassDispatchError",[],(function(a,b,c,d,e,f){"use strict";function a(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];setTimeout(function(){a.apply(null,c)},0)}e.exports=a}),null);
__d("UFICommentTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:UFICommentLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:UFICommentLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:UFICommentLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setDuration=function(a){this.$1.duration=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setHasPhoto=function(a){this.$1.has_photo=a;return this};c.setHasSticker=function(a){this.$1.has_sticker=a;return this};c.setIsReply=function(a){this.$1.is_reply=a;return this};c.setRequestLength=function(a){this.$1.request_length=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={duration:!0,event:!0,has_photo:!0,has_sticker:!0,is_reply:!0,request_length:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("UFICommentLogger",["UFICommentTypedLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={},this.$2={}}var c=a.prototype;c.logNewCommentPost=function(a,c,d){this.$2[a]=babelHelpers["extends"]({timestamp:c},d),new(b("UFICommentTypedLogger"))().setEvent("new_comment_post").setHasPhoto(d.has_photo).setHasSticker(d.has_sticker).setIsReply(d.is_reply).log()};c.logNewCommentReceived=function(a,c){var d=this.$2[a];if(d){var e=0;c&&d.timestamp&&(e=c-d.timestamp);new(b("UFICommentTypedLogger"))().setEvent("new_comment_received").setDuration(e).setHasPhoto(d.has_photo).setHasSticker(d.has_sticker).setIsReply(d.is_reply).log()}delete this.$2[a]};c.logCommentFetch=function(a,c,d){c=babelHelpers["extends"]({timestamp:c},d);this.$1[a]===void 0?this.$1[a]=[c]:this.$1[a].push(c);new(b("UFICommentTypedLogger"))().setEvent("fetch_comment").setIsReply(d.is_reply).setRequestLength(d.request_length).log()};c.logCommentFetchReceived=function(a,c){if(this.$1[a]){var d=this.$1[a].shift(),e=0;c&&d.timestamp&&(e=c-d.timestamp);new(b("UFICommentTypedLogger"))().setEvent("fetch_comment_received").setDuration(e).setIsReply(d.is_reply).setRequestLength(d.request_length).log();this.$1[a].length===0&&delete this.$1[a]}};return a}();e.exports=new a()}),null);
__d("UFIRootRegistry",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h={},i={},j=[];a={registerController:function(a,b,c,d){g[a]=d,h[c]=[].concat(h[c]||[],[b]),i[b]=c},registerSnowliftID:function(a){j.push(a)},isSnowliftNode:function(a){return j.indexOf(a)>=0},getInstanceIDFromFTEntIdentifier:function(a){return h[a]||null},getFTEntIdentifierFromInstanceID:function(a){return i[a]||null},cleanupInstance:function(a){var b=i[a],c=h[b];c&&c.includes(a)&&(h[b]=c.filter(function(b){return b!=a}),h[b].length==0&&delete h[b]);delete i[a]},cleanupSnowliftNodes:function(){j.forEach(function(a){return g[a]&&g[a]()}),g={},j=[]}};e.exports=a}),null);
__d("UFIStoryActionType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHANGE_ACCEPTED_ANSWER:"story_change_accepted_answer",COMMENTS_ARRIVED:"story_comments_arrived",PAGE_IN_COMMENTS:"story_page_in_comments",SHOW_REPLIES:"story_show_replies",SHOW_COMMENTS:"story_show_comments",SPAM_FETCHED:"story_spam_fetched",CHANGE_REACTION:"story_change_reaction",CHANGE_REACTION_FAILURE:"story_change_reaction_failure",CHANGE_REACTION_SUCCESS:"story_change_reaction_success",TOGGLE_REPLIES:"story_toggle_replies",FRIEND_TYPING:"story_friend_typing",SOMEONE_TYPING:"story_someone_typing",TYPING_STOPPED:"story_typing_stopped",LIVE_PIN_COMMENT:"story_live_pin_comment",LIVE_UNPIN_COMMENT:"story_live_unpin_comment",SHOW_FACECAST_REPLIES:"story_show_facecast_replies",HIDE_FACECAST_REPLIES:"story_hide_facecast_replies",ADD_FACECAST_REPLY:"story_add_facecast_reply",ADD_FACECAST_REPLIES:"story_add_facecast_replies",FACECAST_REPLIES_LOADED:"facecast_replies_loaded",SET_COMMENTS_SCROLL_DISTANCE:"set_comments_scroll_distance",HANDLE_NEW_COMMENTS:"handle_new_comments",HANDLE_NEW_FACECAST_REPLY:"handle_new_facecast_reply",SET_COMMENT_REACTIONS_MENU_SHOWN:"set_comment_reactions_menu_shown"})}),null);
__d("UFIActionTypes",["UFIInstanceActionType","UFIStoryActionType","UFIAddCommentActionType","UFICommentActionType"],(function(a,b,c,d,e,f){"use strict";a={INSTANCE:b("UFIInstanceActionType"),STORY:b("UFIStoryActionType"),ADD_COMMENT:b("UFIAddCommentActionType"),COMMENT:b("UFICommentActionType")};e.exports=a}),null);
__d("ReactDispatcher_DEPRECATED",["Dispatcher_DEPRECATED","ReactDOM"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.dispatch=function(c){var d=this;b("ReactDOM").unstable_batchedUpdates(function(){a.prototype.dispatch.call(d,c)})};return c}(b("Dispatcher_DEPRECATED"));e.exports=a}),null);
__d("UFICommentVoteSyncStore",["FluxReduceStore","UFIActionTypes","UFIConstants","UFIDispatcherBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){__p&&__p();var d;switch(c.type){case b("UFIActionTypes").INSTANCE.INIT:var e=c.payload,f=e.feedbacktarget?e.feedbacktarget:e.feedbacktargets&&e.feedbacktargets[0];if(!f)return a;f=e.comments.reduce(function(a,b){a[b.fbid]={voteCount:b.voteCount,voteState:b.voteState};return a},{});return babelHelpers["extends"]({},a,f);case b("UFIActionTypes").COMMENT.UPDATE_VOTE_COUNT_AND_STATE:return babelHelpers["extends"]({},a,(e={},e[c.fbid]={voteCount:c.voteCount?c.voteCount:0,voteState:c.voteState?c.voteState:b("UFIConstants").UFICommentVoteType.NONE},e));case b("UFIActionTypes").COMMENT.CHANGE_VOTE:f=this.getOptimisticVoteState(this.getVoteState(c.fbid),c.arrowType);e=this.getOptimisticVoteCount(c.fbid,f);return babelHelpers["extends"]({},a,(d={},d[c.fbid]={voteCount:e,voteState:f},d));case b("UFIActionTypes").COMMENT.CHANGE_VOTE_SUCCESS:case b("UFIActionTypes").COMMENT.CHANGE_VOTE_FAILURE:return babelHelpers["extends"]({},a,(e={},e[c.fbid]={voteCount:c.voteCount,voteState:c.voteState},e));default:return a}};d.getVoteCount=function(a){return!this.getState()[a]?0:this.getState()[a].voteCount};d.getVoteState=function(a){return!this.getState()[a]?b("UFIConstants").UFICommentVoteType.NONE:this.getState()[a].voteState};d.$UFICommentVoteSyncStore1=function(a){switch(a){case b("UFIConstants").UFICommentVoteType.UPVOTE:return 1;case b("UFIConstants").UFICommentVoteType.DOWNVOTE:return-1;case b("UFIConstants").UFICommentVoteType.NONE:default:return 0}};d.$UFICommentVoteSyncStore2=function(a,b){return this.$UFICommentVoteSyncStore1(b)-this.$UFICommentVoteSyncStore1(a)};d.getOptimisticVoteCount=function(a,b){var c=this.getVoteCount(a);a=this.$UFICommentVoteSyncStore2(this.getVoteState(a),b);return c+a};d.getOptimisticVoteState=function(a,c){return a===c?b("UFIConstants").UFICommentVoteType.NONE:c};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFICommercialBreakStore",["UFIDispatcherBase","UFIInstanceActionType","UFIKeyValueStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getValueFor=function(b){return!!a.prototype.getValueFor.call(this,b)};d.getStateValue=function(a){switch(a.type){case b("UFIInstanceActionType").TOGGLE_COMMERCIAL_BREAK:return a.inCommercial}return null};return c}(b("UFIKeyValueStore"));e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIInteractionStore",["UFIAddCommentActionType","UFICommentActionType","UFIDispatcherBase","UFIInstanceActionType","UFIKeyValueStore","UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getValueFor=function(b){return!!a.prototype.getValueFor.call(this,b)};d.getStateValue=function(a){switch(a.type){case b("UFIAddCommentActionType").CHANGE_CONTENT:case b("UFIAddCommentActionType").SUBMIT_EDIT:case b("UFIAddCommentActionType").SUBMIT_NEW:case b("UFICommentActionType").CHANGE_REACTION:case b("UFICommentActionType").EDIT:case b("UFICommentActionType").REMOVE:case b("UFICommentActionType").TOGGLE_LIKE:case b("UFICommentActionType").TOGGLE_MARK_AS_SPAM:case b("UFICommentActionType").TRANSLATE:case b("UFIInstanceActionType").CHANGE_ORDER_MODE:case b("UFIInstanceActionType").TOGGLE_COMMENTS:case b("UFIStoryActionType").PAGE_IN_COMMENTS:case b("UFIStoryActionType").SHOW_REPLIES:case b("UFIStoryActionType").TOGGLE_REPLIES:return!0}return null};return c}(b("UFIKeyValueStore"));e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFILiveTypingStore",["FluxReduceStore","UFIDispatcherBase","UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}c.getNewFeedbackState=function(a){switch(a){case b("UFIStoryActionType").FRIEND_TYPING:return"friend";case b("UFIStoryActionType").SOMEONE_TYPING:return"someone";case b("UFIStoryActionType").TYPING_STOPPED:return!1;default:return null}};var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,b){var d=c.getNewFeedbackState(b.type);if(d!==null){var e;a=babelHelpers["extends"]({},a,(e={},e[b.ftentidentifier]=d,e))}return a};d.isFriendTyping=function(a){return this.getState()[a]==="friend"};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("LiveVideoViewerTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:LiveVideoViewerLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:LiveVideoViewerLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:LiveVideoViewerLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCommentID=function(a){this.$1.comment_id=a;return this};c.setCommentLocation=function(a){this.$1.comment_location=a;return this};c.setCommentReplyThreadLength=function(a){this.$1.comment_reply_thread_length=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setReplyThreadDurationMs=function(a){this.$1.reply_thread_duration_ms=a;return this};c.setTargetID=function(a){this.$1.target_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={comment_id:!0,comment_location:!0,comment_reply_thread_length:!0,event:!0,reply_thread_duration_ms:!0,target_id:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("UFILiveVideoLoggingStore",["FluxReduceStore","LiveVideoViewerTypedLogger","UFIDispatcherBase","UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){__p&&__p();switch(c.type){case b("UFIStoryActionType").SHOW_FACECAST_REPLIES:var d;new(b("LiveVideoViewerTypedLogger"))().setEvent("opened_reply_thread_from_comment").setCommentID(c.commentID).log();return babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:c.commentID,time_opened_ms:Date.now()},d));case b("UFIStoryActionType").HIDE_FACECAST_REPLIES:if(!c.isExplicit)return a;d=a[c.instanceID];if(d==null)return a;new(b("LiveVideoViewerTypedLogger"))().setEvent("closed_reply_thread_explicitly").setCommentID(d.comment_id).setReplyThreadDurationMs(Date.now()-d.time_opened_ms).log();return babelHelpers["extends"]({},a,(c={},c[d.comment_id]=null,c));default:return a}};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIPlayLiveVODHighlightsStore",["UFIDispatcherBase","UFIInstanceActionType","UFIKeyValueStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getValueFor=function(b){return!!a.prototype.getValueFor.call(this,b)};d.getStateValue=function(a){switch(a.type){case b("UFIInstanceActionType").PLAY_LIVE_VOD_HIGHLIGHTS:return a.playingLiveVODHighlights}return null};return c}(b("UFIKeyValueStore"));e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIReactionPendingRequestsStore",["FluxReduceStore","UFIActionTypes","UFIDispatcherBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return a+"-comment"}function h(a){return a+"-story"}function i(a,b){var c;return babelHelpers["extends"]({},a,(c={},c[b]=(a[b]||0)+1,c))}function j(a,b){var c;return babelHelpers["extends"]({},a,(c={},c[b]=(a[b]||0)-1,c))}a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){switch(c.type){case b("UFIActionTypes").STORY.CHANGE_REACTION:return i(a,h(c.ftentidentifier));case b("UFIActionTypes").COMMENT.CHANGE_REACTION:return i(a,g(c.fbid));case b("UFIActionTypes").STORY.CHANGE_REACTION_SUCCESS:case b("UFIActionTypes").STORY.CHANGE_REACTION_FAILURE:return j(a,h(c.ftentidentifier));case b("UFIActionTypes").COMMENT.CHANGE_REACTION_FAILURE:case b("UFIActionTypes").COMMENT.CHANGE_REACTION_SUCCESS:return j(a,g(c.fbid))}return a};d.getPendingRequestsForComment=function(a){return this.getState()[g(a)]||0};d.getPendingRequests=function(a){return this.getState()[h(a)]||0};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIReactionSyncStore",["FluxReduceStore","UFIActionTypes","UFIDispatcherBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return a+"-comment"}function h(a){return a+"-story"}a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){__p&&__p();switch(c.type){case b("UFIActionTypes").INSTANCE.INIT:var d=c.payload;d=d.feedbacktarget?d.feedbacktarget:d.feedbacktargets&&d.feedbacktargets[0];if(!d)return a;var e=c.payload.comments.reduce(function(a,b){a[g(b.fbid)]=b.viewerreaction;return a},{});return babelHelpers["extends"]({},a,e,(e={},e[h(c.ftentidentifier)]=d.viewerreaction,e));case b("UFIActionTypes").STORY.CHANGE_REACTION_SUCCESS:return babelHelpers["extends"]({},a,(d={},d[h(c.ftentidentifier)]=c.reactionType,d));case b("UFIActionTypes").COMMENT.CHANGE_REACTION_SUCCESS:return babelHelpers["extends"]({},a,(e={},e[g(c.fbid)]=c.reactionType,e));default:return a}};d.getLastKnownCommentReaction=function(a){return this.getState()[g(a)]};d.getLastKnownReaction=function(a){return this.getState()[h(a)]};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIVideoPlayerControllerStore",["FluxReduceStore","UFIDispatcherBase","UFIInstanceActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){switch(c.type){case b("UFIInstanceActionType").FOUND_VIDEO_PLAYER_CONTROLLER:var d;return babelHelpers["extends"]({},a,(d={},d[c.instanceID]={videoPlayerController:c.videoPlayerController},d));default:return a}};d.getVideoPlayerController=function(a){var b;return(b=this.getState())!=null?(b=b[a])!=null?b.videoPlayerController:b:b};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFISharedDispatcher",["UFIDispatcherBase","UFIFeedbackStore","UFICommentEditIDStore","UFICommentVisibilityStore","UFICommentVoteSyncStore","UFICommercialBreakStore","UFIComposerIsTypingStore","UFIInteractionStore","UFILivePinnedCommentStore","UFILiveTypingStore","UFILocallyComposedCommentStore","UFIOrderingModeStore","UFIReactionPendingRequestsStore","UFIReactionSyncStore","UFISpamStore","UFIPlayLiveVODHighlightsStore","UFIThreadedFacecastCommentsStore","UFILiveVideoLoggingStore","UFIVideoPlayerControllerStore"],(function(a,b,c,d,e,f){"use strict";b("UFIFeedbackStore"),b("UFICommentEditIDStore"),b("UFICommentVisibilityStore"),b("UFICommentVoteSyncStore"),b("UFICommercialBreakStore"),b("UFIComposerIsTypingStore"),b("UFIFeedbackStore"),b("UFIInteractionStore"),b("UFILivePinnedCommentStore"),b("UFILiveTypingStore"),b("UFILocallyComposedCommentStore"),b("UFIOrderingModeStore"),b("UFIReactionPendingRequestsStore"),b("UFIReactionSyncStore"),b("UFISpamStore"),b("UFIPlayLiveVODHighlightsStore"),b("UFIThreadedFacecastCommentsStore"),b("UFILiveVideoLoggingStore"),b("UFIVideoPlayerControllerStore"),e.exports=b("UFIDispatcherBase")}),null);
__d("UFICentralUpdatesLocalCommentAdapter",["ClientIDs","FeedbackPayloadSourceType","UFICentralUpdates","UFIDispatcherBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h=(d={},d[b("FeedbackPayloadSourceType").USER_ACTION]=a,d[b("FeedbackPayloadSourceType").ENDPOINT_ADD_COMMENT]=c,d);function i(){return b("UFICentralUpdates").subscribe("update-comments",function(a,b){if(b.comments){a=h[b.payloadsource];a&&b.comments.forEach(a)}})}function a(a){if(!b("ClientIDs").isExistingClientID(a.id))return;g[a.id]=a.ufiinstanceid;b("UFIDispatcherBase").dispatch({type:"CENTRALUPDATES_ADDED_COMMENT",instanceID:a.ufiinstanceid,ftentidentifier:a.ftentidentifier,clientID:a.id})}function c(a){if(!b("ClientIDs").isExistingClientID(a.clientid))return;var c=g[a.clientid];delete g[a.clientid];if(!c)return;b("UFIDispatcherBase").dispatch({type:"CENTRALUPDATES_SAVED_COMMENT",instanceID:c,ftentidentifier:a.ftentidentifier,clientID:a.clientid,commentID:a.id})}var j;f={subscribeOnce:function(){if(!j){j=i();return j}return null}};e.exports=f}),null);
__d("UFIPagedCommentListImpl",["ClientIDs","KeyedCallbackManager","UFICentralUpdates","UFICommentLogger","UFIConfig","UFIConstants","UFIFeedbackTargets"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(a){__p&&__p();var c=this;this.actorID=null;this.basePermalink=null;this.commentPermalinks=Object.create(null);this.count=0;this.dataSource=new(b("KeyedCallbackManager"))();this.deletedComments=Object.create(null);this.deletedCount=0;this.lastRequestedLength=0;this.lastRequestedOffset=0;this.feedbackTargetID=a;b("UFIFeedbackTargets").getFeedbackTarget(this.feedbackTargetID,function(a){c.actorID=a.actorforpost,c.basePermalink=a.permalink})}var c=a.prototype;c.setClientHasAll=function(a){};c.addOrUpdateComment=function(a){if(!a)return;a.__typename==="local"?this.$1(a.id):this.$2(a.id,a.clientid,a.legacyid);b("UFICentralUpdates").didUpdateFeedback(this.feedbackTargetID)};c.$1=function(a){this.dataSource.setResource(this.count,a),this.count++};c.$2=function(a,c,d){__p&&__p();var e=c&&b("ClientIDs").isExistingClientID(c),f=this.dataSource.getAllResources(),g={};for(var h in f){var i=f[h];g[i]=h}if(e&&c&&c in g){g[a]=g[c];i=g[c];this.dataSource.setResource(i,a);b("UFIConfig").logCommentPost&&b("UFICommentLogger").logNewCommentReceived(c,Date.now())}else!g[a]&&c&&this.$1(a);d&&a in g&&(this.commentPermalinks[a]=this.buildCommentPermalink(a,d,g[a]))};c.addCommentIDs=function(a,c,d){var e={};for(var f=0;f<c;f++)e[a+f]=d[f]||b("UFIConstants").unavailableCommentKey;this.dataSource.addResourcesAndExecute(e);b("UFICentralUpdates").didUpdateFeedback(this.feedbackTargetID)};c.getComments=function(a,b,c,d){__p&&__p();var e=this,f=new Array(b).fill().map(function(b,c){return c+a}),g=this.dataSource.getUnavailableResourcesFromRequest(f);if(g.length){var h=Math.min.apply(Math,g);g=Math.max.apply(Math,g);var i=h;g=g-h+1;(i<this.lastRequestedOffset||i+g>this.lastRequestedOffset+this.lastRequestedLength)&&(this.lastRequestedOffset=i,this.lastRequestedLength=g,this.fetchComments(i,g,c))}else this.dataSource.executeOrEnqueue(f,function(c){return d(e.commentsFromCommentIDs(c,a,b))})};c.getCommentsOrThrow=function(a){__p&&__p();var b=this;a=[a.getLength(),a.getOffset()];var c=a[0],d=a[1],e={};new Array(c).fill().forEach(function(a,c){a=c+d;c=b.dataSource.getResource(a);if(!c)throw new Error("Tried to get nonexistent comment");e[a]=c});return this.commentsFromCommentIDs(e,d,c)};c.fetchComments=function(a,b,c){};c.commentsFromCommentIDs=function(a,b,c){return{}};c.reset=function(){var a=this.dataSource.getAllResources();this.dataSource.reset();this.count=0;this.deletedCount=0;this.deletedComments={};this.lastRequestedOffset=0;this.lastRequestedLength=0;return a};c.deleteComment=function(a){a in this.deletedComments||(this.deletedComments[a]=!0,this.deletedCount++)};c.updateCommentCount=function(a){this.count=a,this.deletedCount=0};c.getFeedbackTargetID=function(){return this.feedbackTargetID};c.getCommentCount=function(){return this.count};c.getDeletedCount=function(){return this.deletedCount};c.getDisplayedCommentCount=function(){return this.count-this.deletedCount};c.getBasePermalink=function(){return this.basePermalink};c.buildCommentPermalink=function(a,b,c){return null};c.getPermalinkForComment=function(a){return this.commentPermalinks[a]};return a}();e.exports=a}),null);
__d("UFIReplyCommentListImpl",["ActorURI","JSLogger","MercuryServerDispatcher","UFICommentLogger","UFIComments","UFIConfig","UFIPagedCommentListImpl","URI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("JSLogger").create("ufi_reply_comment_list");a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b,c,d){b=a.call(this,b)||this;b.parentCommentID=c;b.containerOrderingMode=d;return b}var d=c.prototype;d.fetchComments=function(a,c,d){b("UFIConfig").logCommentLoad&&b("UFICommentLogger").logCommentFetch(this.feedbackTargetID,Date.now(),{request_length:c,is_reply:!0});a={ft_ent_identifier:this.feedbackTargetID,parent_comment_ids:[this.parentCommentID],source:null,offsets:[a],lengths:[c],feed_context:d?d.feedContext:null,numpagerclicks:d?d.numPagerClicks:null,containerorderingmode:this.containerOrderingMode,translate_all:d?d.translateAll:null};(!d||!d.viewAs)&&(a[b("ActorURI").PARAMETER_ACTOR]=this.actorID);b("MercuryServerDispatcher").trySend("/ajax/ufi/reply_fetch.php",a)};d.commentsFromCommentIDs=function(a,c,d){var e={};for(var f=0;f<d;f++){var g=b("UFIComments").getComment(a[c+f]);g&&(e[c+f]=g)}return e};d.reset=function(){var c=a.prototype.reset.call(this),d={};for(var e in c){var f=c[e];d[f]=!0}b("UFIComments").resetComments(d);return c};d.getParentCommentID=function(){return this.parentCommentID};d.buildCommentPermalink=function(a,c,d){if(!this.basePermalink)return null;a=this.getParentCommentID().split("_");d=c;a.length===2?d=a[1]:g.error("Bad reply comment ID: "+this.getParentCommentID());return new(b("URI"))(this.basePermalink).addQueryData({comment_id:d,reply_comment_id:c}).toString()};return c}(b("UFIPagedCommentListImpl"));b("MercuryServerDispatcher").registerEndpoints({"/ajax/ufi/reply_fetch.php":{mode:b("MercuryServerDispatcher").IMMEDIATE}});e.exports=a}),null);
__d("CommentSection",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DEFAULT:"default",FRIENDS:"friends"})}),null);
__d("UFIToplevelPagedCommentListImpl",["ActorURI","CommentSection","MercuryServerDispatcher","UFICommentLogger","UFIComments","UFIConfig","UFIOrderingModeStore","UFIPagedCommentListImpl","URI","WebCommentViewOption"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e){c=a.call(this,c)||this;c.clientHasAll=!1;c.orderingMode=d;c.section=e||b("CommentSection").DEFAULT;c.clientHasAll=!1;return c}var d=c.prototype;d.fetchComments=function(a,c,d){b("UFIConfig").logCommentLoad&&b("UFICommentLogger").logCommentFetch(this.feedbackTargetID,Date.now(),{request_length:c,is_reply:!1});a={ft_ent_identifier:this.feedbackTargetID,viewas:d&&d.viewAs?d.viewAs+"":null,source:d&&d.feedbackSource,offset:a,length:c,orderingmode:this.orderingMode,section:this.section,direction:d&&d.direction,feed_context:d?d.feedContext:null,numpagerclicks:d?d.numPagerClicks:null,translate_all:d?d.translateAll:null,clientcommentcount:this.count};(this.orderingMode!==b("WebCommentViewOption").RANKED_THREADED||this.orderingMode!==b("WebCommentViewOption").RANKED_UNFILTERED||this.orderingMode!==b("WebCommentViewOption").RECENT_ACTIVITY)&&delete a.clientcommentcount;(!d||!d.viewAs)&&(a[b("ActorURI").PARAMETER_ACTOR]=this.actorID);d&&d.interactionRequestCorrelationID&&(a.ircid=d.interactionRequestCorrelationID);b("MercuryServerDispatcher").trySend("/ajax/ufi/comment_fetch.php",a)};d.commentsFromCommentIDs=function(a,c,d){var e={},f=c,g=c+d-1,h=b("UFIOrderingModeStore").isInverted(this.orderingMode,this.feedbackTargetID);for(var i=0;i<d;i++){var j=h?g-i:f+i;j=b("UFIComments").getComment(a[j]);j&&(e[c+i]=j)}return e};d.getOrderingMode=function(){return this.orderingMode};d.getCommentSection=function(){return this.section};d.setClientHasAll=function(a){this.clientHasAll=a};d.getClientHasAll=function(){return this.clientHasAll};d.buildCommentPermalink=function(a,c,d){return!this.basePermalink?null:new(b("URI"))(this.basePermalink).addQueryData({comment_id:c}).toString()};return c}(b("UFIPagedCommentListImpl"));b("MercuryServerDispatcher").registerEndpoints({"/ajax/ufi/comment_fetch.php":{mode:b("MercuryServerDispatcher").IMMEDIATE}});e.exports=a}),null);
__d("UFICentralUpdates",["Arbiter","ArbiterMixin","BanzaiODS","FeedbackSourceType","LiveTimer","ShortProfiles","UFIConstants","UFIUserActions","mixin"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("BanzaiODS").setEntitySample("feedback",1e-4);var g=0,h={},i={},j=[];function k(){if(!g){var a=h,b=i;h={};i={};Object.keys(a).length&&m("feedback-updated",a);Object.keys(b).length&&m("comments-updated",b);j.pop()}}function l(){if(j.length)return j[j.length-1];else return b("UFIConstants").UFIPayloadSourceType.UNKNOWN}function m(a,b){n.inform(a,{updates:b,payloadSource:l()})}var n=babelHelpers["extends"]({},b("ArbiterMixin"),{handleUpdateWithUserAction:function(a,c){var d=this;c.actions.forEach(function(e){a==b("UFIConstants").UFIPayloadSourceType.ENDPOINT_HIDE_COMMENT?Object.prototype.hasOwnProperty.call(e,"commentid")&&(b("UFIUserActions").setHideAsSpam(e.commentid,!0,{source:b("FeedbackSourceType").NONE}),b("Arbiter").inform("bulk_actions_hidden",{})):d.handleUpdate(a,c)})},handleUpdate:function(a,c){__p&&__p();var d=this;Object.keys(c).length&&this.synchronizeInforms(function(){j.push(a);var e=babelHelpers["extends"]({payloadsource:l()},c);e.adjustedRanges&&d.inform("update-ranges",e);d.inform("update-feedback",e);d.inform("update-comment-lists",e);d.inform("update-comments",e);d.inform("update-actions",e);b("ShortProfiles").setMulti(c.profiles||{});c.servertime&&b("LiveTimer").restart(c.servertime)})},didUpdateFeedback:function(a){h[a]=!0,k()},didUpdateComment:function(a){i[a]=!0,k()},synchronizeInforms:function(a){g++;try{a()}catch(a){throw a}finally{g--,k()}}});e.exports=n}),null);
__d("UFICommentAction",["UFICommentActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={bulkReview:function(a,b){return{type:"bulk_review",instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:b.fbid,comment:b}},changeReaction:function(a,c,d,e){return{type:b("UFICommentActionType").CHANGE_REACTION,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,reactionType:d,target:e}},changeReactionSuccess:function(a,c,d){return{type:b("UFICommentActionType").CHANGE_REACTION_SUCCESS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,reactionType:d}},changeReactionFailure:function(a,c,d){return{type:b("UFICommentActionType").CHANGE_REACTION_FAILURE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,reactionType:d}},changeVote:function(a,c,d,e,f){return{arrowType:f,comment:c,currentVoteState:e,fbid:c.fbid,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,target:d,type:b("UFICommentActionType").CHANGE_VOTE}},changeVoteFailure:function(a,c,d,e){return{comment:c,fbid:c.fbid,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,type:b("UFICommentActionType").CHANGE_VOTE_FAILURE,voteCount:d,voteState:e}},changeVoteSuccess:function(a,c,d,e){return{comment:c,fbid:c.fbid,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,type:b("UFICommentActionType").CHANGE_VOTE_SUCCESS,voteCount:d,voteState:e}},updateVoteCountAndState:function(a,c,d,e){return{fbid:c,ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,type:b("UFICommentActionType").UPDATE_VOTE_COUNT_AND_STATE,voteCount:d,voteState:e}},mounted:function(a,c){return{type:b("UFICommentActionType").MOUNTED,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.comment.fbid,renderedComment:c,contextArgs:a}},unmounted:function(a,c){return{type:b("UFICommentActionType").UNMOUNTED,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.comment.fbid,renderedComment:c,contextArgs:a}},changeVisibility:function(a,c,d){return{type:b("UFICommentActionType").CHANGE_VISIBILITY,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.comment.fbid,renderedComment:c,contextArgs:a,visibility:d}},edit:function(a,c){return{type:b("UFICommentActionType").EDIT,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c}},remove:function(a,c,d,e){return{type:b("UFICommentActionType").REMOVE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d,onConfirm:e}},removeAndBlock:function(a,c,d,e){return{type:b("UFICommentActionType").REMOVE_AND_BLOCK,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d,onConfirm:e}},delete_comment_and_remove_commenter:function(a,c,d,e){return{type:b("UFICommentActionType").DELETE_COMMENT_AND_REMOVE_COMMENTER,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d,onConfirm:e}},mute_member:function(a,c,d,e){return{type:b("UFICommentActionType").MUTE_MEMBER,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d,onConfirm:e}},toggle_text_delights:function(a,c,d){return{type:b("UFICommentActionType").TOGGLE_TEXT_DELIGHTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d}},removePreview:function(a,c,d){return{type:b("UFICommentActionType").REMOVE_PREVIEW,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d}},toggleLike:function(a,c,d){return{type:b("UFICommentActionType").TOGGLE_LIKE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,like:!c.hasviewerliked,target:d}},translate:function(a,c,d){return{type:b("UFICommentActionType").TRANSLATE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,trigger:d}},markAsSpam:function(a,c,d){return{type:b("UFICommentActionType").TOGGLE_MARK_AS_SPAM,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,is_spam:!0,target:d}},markAsNotSpam:function(a,c,d){return{type:b("UFICommentActionType").TOGGLE_MARK_AS_SPAM,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,is_spam:!1,target:d}},inlineBan:function(a,c,d,e){return{type:b("UFICommentActionType").TOGGLE_INLINE_BAN,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,is_banned:!0,ownerid:e,target:d}},undoInlineBan:function(a,c,d,e){return{type:b("UFICommentActionType").TOGGLE_INLINE_BAN,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,is_banned:!1,ownerid:e,target:d}},inlineStreamBan:function(a,c,d,e){return{type:b("UFICommentActionType").TOGGLE_INLINE_STREAM_BAN,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,is_banned:!0,ownerid:e,target:d}},undoInlineStreamBan:function(a,c,d,e){return{type:b("UFICommentActionType").TOGGLE_INLINE_STREAM_BAN,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,is_banned:!1,ownerid:e,target:d}},embed:function(a,c){return{type:b("UFICommentActionType").EMBED,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c}},deleteCommentWithFeedback:function(a,c,d){return{type:b("UFICommentActionType").DELETE_COMMENT_WITH_FEEDBACK,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d}},pinByAuthor:function(a,c,d){return{comment:c,type:b("UFICommentActionType").CHANGE_PIN_BY_AUTHOR,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,pinnedByAuthor:d}},manageConstituentBadge:function(a,c){return{type:b("UFICommentActionType").MANAGE_CONSTITUENT_BADGE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c}},keepSpam:function(a,c,d){return{type:b("UFICommentActionType").TOGGLE_KEEP_SPAM,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,fbid:c.fbid,comment:c,target:d}},appealSpam:function(a,c,d,e){return{type:b("UFICommentActionType").TOGGLE_APPEAL_SPAM,instanceID:a.instanceid,ftentidentifier:c.fbid,fbid:c.fbid,comment:c,target:d,feedback:e}},secureAccount:function(a,c,d,e){return{type:b("UFICommentActionType").TOGGLE_SECURE_ACCOUNT,instanceID:a.instanceid,ftentidentifier:c.fbid,fbid:c.fbid,comment:c,target:d,feedback:e}}};e.exports=a}),null);
__d("XUFICommentVoteController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/vote/",{new_vote_count:{type:"Int"},new_vote_state:{type:"Enum",enumType:0},old_vote_count:{type:"Int"},old_vote_state:{type:"Enum",enumType:0}})}),null);
__d("UFICommentVoteUserActions",["AsyncRequest","AsyncResponse","ChannelClientID","ClientIDs","UFICentralUpdates","UFICommentAction","UFIComments","UFICommentVoteSyncStore","UFIConstants","UFIFeedbackTargets","UFISharedDispatcher","XUFICommentVoteController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=null;a={changeCommentVote:function(a,c,d,e,f,k){__p&&__p();var l=b("UFIComments").getComment(a),m=b("UFICommentVoteSyncStore").getVoteCount(c),n=b("UFICommentVoteSyncStore").getOptimisticVoteState(e,d),o=b("UFICommentVoteSyncStore").getOptimisticVoteCount(c,n);if(!l||l.__typename!=="saved"||e===n)return;b("UFIFeedbackTargets").getFeedbackTarget(l.ftentidentifier,function(c){c=j(l,c,o,n);b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:c});g&&g.abort();c=b("XUFICommentVoteController").getURIBuilder().getURI();g=new(b("AsyncRequest"))().setURI(c).setMethod("POST").setData({client_id:b("ClientIDs").getNewClientID(),comment_id:a,ft_ent_identifier:l.ftentidentifier,instance_id:f.instanceid,legacy_id:l.legacyid,new_vote_count:o,new_vote_state:n,old_vote_count:m,old_vote_state:e,session_id:b("ChannelClientID").getID(),source:f.source}).setErrorHandler(function(a){h(a)}).setHandler(function(a){i(a)})});g&&g.send()}};function h(c){__p&&__p();var a=c.request;if(!a||!a.data)return;a=a.data;var d=b("UFIComments").getComment(a.comment_id);if(!d||d.__typename!=="saved")return;var e=a.ft_ent_identifier,f=a.instance_id,h=a.old_vote_count;a=a.old_vote_state;if(!e||!f)return;b("UFISharedDispatcher").dispatch(b("UFICommentAction").changeVoteFailure({instanceid:f,ftentidentifier:e},d,h,a));b("AsyncResponse").defaultErrorHandler(c)}function i(a){__p&&__p();a=a.request;if(!a||!a.data)return;a=a.data;var c=b("UFIComments").getComment(a.comment_id);if(!c||c.__typename!=="saved")return;var d=a.ft_ent_identifier,e=a.instance_id,f=a.new_vote_count;a=a.new_vote_state;if(!d||!e)return;b("UFISharedDispatcher").dispatch(b("UFICommentAction").changeVoteSuccess({instanceid:e,ftentidentifier:d},c,f,a))}function j(a,c,d,e){var f=a.id;c=[k(a,d,e,f,c.actorforpost)];a.voteState!==e&&c.push({commentID:f,actionType:b("UFIConstants").UFIActionType.COMMENT_VOTE,voteCount:d,voteEnabled:!0,voteState:e});return c}function k(a,c,d,e,f){return{actionType:b("UFIConstants").UFIActionType.COMMENT_VOTE,commentID:e,voteCount:c,voteEnabled:a.voteEnabled,voteState:d}}e.exports=a}),null);
__d("CommentApprovalsResponsibleUserAction",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({APPEALED:"APPEALED",SECURED_ACCOUNT:"SECURED_ACCOUNT"})}),null);
__d("LiveWWWFeedbackTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:LiveWWWFeedbackLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:LiveWWWFeedbackLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:LiveWWWFeedbackLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setCommentID=function(a){this.$1.comment_id=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setIsMSite=function(a){this.$1.is_m_site=a;return this};c.setMechanism=function(a){this.$1.mechanism=a;return this};c.setOriginatedLocally=function(a){this.$1.originated_locally=a;return this};c.setRecipientID=function(a){this.$1.recipient_id=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTimeSinceSub=function(a){this.$1.time_since_sub=a;return this};c.setUpdateType=function(a){this.$1.update_type=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={comment_id:!0,event:!0,is_m_site:!0,mechanism:!0,originated_locally:!0,recipient_id:!0,time:!0,time_since_sub:!0,update_type:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("UFIComments",["invariant","ClientIDs","CommentApprovalsResponsibleUserAction","ImmutableObject","LiveWWWFeedbackTypedLogger","UFICentralUpdates","UFIConstants","randomInt"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=5,i={},j={},k={},l={},m={};l.shareOnComment=m;var n="DONT_SHOW_SHARE_OPTION";function o(a){return a in j?j[a]:a}function p(a,c){__p&&__p();a.forEach(function(a){__p&&__p();var d=a.ftentidentifier,e=b("UFIConstants").UFIPayloadSourceType,f=a.clientid,g=!1,l=babelHelpers["extends"]({},a);if(f){delete l.clientid;g=b("ClientIDs").isExistingClientID(f);if(g&&j[f]){new(b("LiveWWWFeedbackTypedLogger"))().setEvent("update_view").setUpdateType("comment").setOriginatedLocally(!0).setCommentID(a.id).log();return}}(c===b("UFIConstants").UFIPayloadSourceType.LIVE_SEND||c===b("UFIConstants").UFIPayloadSourceType.STREAMING)&&(l.islive=!0);(c===e.ENDPOINT_COMMENT_FETCH||c===e.ENDPOINT_ID_COMMENT_FETCH)&&(l.fromfetch=!0);g&&i[f]&&(l.ufiinstanceid=i[f].ufiinstanceid,l.trackingID=i[f].trackingID,j[f]=a.id,k[a.id]=f,i[a.id]=i[f],delete i[f],b("UFICentralUpdates").didUpdateComment(f));if(c===e.LIVE_SEND||c===b("UFIConstants").UFIPayloadSourceType.STREAMING||c===e.USER_ACTION||c===e.ENDPOINT_ADD_COMMENT||c===e.ENDPOINT_EDIT_COMMENT){l.isunseen=!0;if(a.body&&a.body.text&&a.body.text.trim().split(/\s+/).length>=h&&(c===e.USER_ACTION||c===e.ENDPOINT_ADD_COMMENT)){g=m[d];g!==n&&(m[d]=!g||a.id===g||L.getLocalID(a.id)===g?a.id:n)}}L.setComment(a.id,new(b("ImmutableObject"))(l));b("UFICentralUpdates").didUpdateComment(a.id);b("UFICentralUpdates").didUpdateFeedback(d)})}function q(a,c){__p&&__p();for(var d=0;d<a.length;d++){var e=a[d];switch(e.actiontype){case b("UFIConstants").UFIActionType.LIKE_ACTION:L.getComment(e.entidentifier)&&t(e.clientid,e.entidentifier,e.hasviewerliked,e.likecount,e.reactiondata,c);break;case b("UFIConstants").UFIActionType.COMMENT_LIKE:t(e.clientid,e.commentid,e.viewerliked,e.likecount,e.reactiondata,c);break;case b("UFIConstants").UFIActionType.MUTE_MEMBER:u(e);break;case b("UFIConstants").UFIActionType.REACTION:L.getComment(e.entidentifier)&&v(e.entidentifier,e);break;case b("UFIConstants").UFIActionType.COMMENT_REACTION:v(e.commentid,e);break;case b("UFIConstants").UFIActionType.DELETE_COMMENT:z(e);break;case b("UFIConstants").UFIActionType.LIVE_DELETE_COMMENT:A(e);break;case b("UFIConstants").UFIActionType.CHANGE_ACCEPTED_ANSWER:B(e);break;case b("UFIConstants").UFIActionType.REMOVE_PREVIEW:C(e);break;case b("UFIConstants").UFIActionType.COMMENT_SET_SPAM:D(e);break;case b("UFIConstants").UFIActionType.COMMENT_KEEP_SPAM:E(e);break;case b("UFIConstants").UFIActionType.COMMENT_APPEAL_SPAM:F(e);break;case b("UFIConstants").UFIActionType.COMMENT_SECURE_ACCOUNT:G(e);break;case b("UFIConstants").UFIActionType.CONFIRM_COMMENT_REMOVAL:H(e);break;case b("UFIConstants").UFIActionType.TRANSLATE_COMMENT:x(e);break;case b("UFIConstants").UFIActionType.COMMENT_LIKECOUNT_UPDATE:w(e);break;case b("UFIConstants").UFIActionType.UPDATE_CONSTITUENT_BADGE:J(e);break;case b("UFIConstants").UFIActionType.COMMENT_VOTE:s(e);break;case b("UFIConstants").UFIActionType.COMMENT_AUTHOR_PIN_CHANGE:r(e)}}}function r(a){var b=L.getComment(a.commentid);b&&K(b.id,{ispinnedbyauthor:a.ispinnedbyauthor})}function s(a){var b=L.getComment(a.commentID);b&&K(b.id,{voteCount:a.voteCount,voteEnabled:a.voteEnabled,voteState:a.voteState})}function t(a,c,d,e,f,g){var h=L.getComment(c);if(h){h={};a=a&&b("ClientIDs").isExistingClientID(a);a||(h.hasviewerliked=d,h.likecount=e,f&&(h.reactioncount=f.reactioncount,h.reactioncountmap=f.reactioncountmap,h.reactioncountreduced=f.reactioncountreduced,h.viewerreaction=f.viewerreaction));(g===b("UFIConstants").UFIPayloadSourceType.LIVE_SEND||g===b("UFIConstants").UFIPayloadSourceType.STREAMING)&&new(b("LiveWWWFeedbackTypedLogger"))().setEvent("update_view").setUpdateType("comment_like").setOriginatedLocally(Boolean(a)).setCommentID(c).log();h.likeconfirmhash=b("randomInt")(0,1024);K(c,h)}}function u(a){for(var b in i){var c=i[b];if(c.author===a.authorid){c={};c.ismuted=a.shouldmute;K(b,c)}}}function v(a,c){__p&&__p();var d=L.getComment(a);if(d){var e={};if(c.clientid&&b("ClientIDs").isExistingClientID(c.clientid)&&c.viewerreaction!==d.viewerreaction)return;e.hasviewerliked=c.hasviewerliked;e.likecount=c.likecount;e.reactioncount=c.reactioncount;e.reactioncountmap=c.reactioncountmap;e.reactioncountreduced=c.reactioncountreduced;e.viewerreaction=c.viewerreaction;K(a,e)}}function w(a){var c=L.getComment(a.commentid);if(c&&a.hasviewerliked===c.hasviewerliked){c={likecount:a.likecount,likeconfirmhash:b("randomInt")(0,1024)};K(a.commentid,c)}}function x(a){var b=a.commentid,c=L.getComment(b);if(c){c={translationdata:a.translationdata};K(b,c)}}function y(a){a={reportLink:a.reportLink,commenterIsFOF:a.commenterIsFOF,userIsMinor:a.userIsMinor,giveFeedbackLink:a.giveFeedbackLink,reportOptionsLink:a.reportOptionsLink,isBroadcast:a.isBroadcast,showStreamBanControls:a.showStreamBanControls};return a}function z(a){a=L.getComment(a.commentid);a&&I(a,b("UFIConstants").UFIStatus.DELETED)}function A(a){a=L.getComment(a.commentid);a&&a.status!==b("UFIConstants").UFIStatus.DELETED&&I(a,b("UFIConstants").UFIStatus.LIVE_DELETED)}function B(a){K(a.commentid,{postacceptedanswer:a.isaccepted?a.commentid:null})}function C(a){K(a.commentid,{attachment:null})}function D(a){var c=L.getComment(a.commentid);a=a.shouldHideAsSpam?b("UFIConstants").UFIStatus.SPAM_DISPLAY:null;c&&I(c,a)}function E(a){a=L.getComment(a.commentid);a&&K(a.id,{needsApproval:!1,isApproved:!0})}function F(a){a=L.getComment(a.commentid);a&&K(a.id,{appealStatus:b("CommentApprovalsResponsibleUserAction").APPEALED,canAppeal:!1,canSecure:!1})}function G(a){a=L.getComment(a.commentid);a&&K(a.id,{appealStatus:b("CommentApprovalsResponsibleUserAction").SECURED_ACCOUNT,canAppeal:!1,canSecure:!1})}function H(a){K(a.commentid,y(a))}function I(a,b){K(a.id,{priorstatus:a.status,status:b})}function J(a){var b=L.getComment(a.commentid);if(b){b={constituentTitle:a.constituentTitle,hasConstituentBadge:a.hasConstituentBadge};K(a.commentid,b)}}function K(a,c){var d=L.getComment(a)||new(b("ImmutableObject"))({});L.setComment(a,b("ImmutableObject").set(d,c));b("UFICentralUpdates").didUpdateComment(d.id);b("UFICentralUpdates").didUpdateFeedback(d.ftentidentifier)}var L={getRenderKey:function(a){return"comment"+(a in k?k[a]:a)},getLocalID:function(a){return a in k?k[a]:a},getComment:function(a){return a===b("UFIConstants").unavailableCommentKey?null:i[o(a)]},setComment:function(a,c){c instanceof b("ImmutableObject")||g(0,4388),i[o(a)]=c},setCacheVariable:function(a,b){a.length!==0||g(0,4389),l[a]=b},getCacheVariable:function(a){return l[a]},resetComments:function(a){for(var b in a)delete i[o(b)]},getCommentsForFTEntIdentifier:function(a){var b=[];for(var c in i){var d=i[c];d.ftentidentifier==a&&b.push(d)}return b}};b("UFICentralUpdates").subscribe("update-comments",function(a,b){b.comments&&b.comments.length&&p(b.comments,b.payloadsource),b.privatecomments&&b.privatecomments.length&&p(b.privatecomments,b.payloadsource),b.pinnedcomments&&b.pinnedcomments.length&&p(b.pinnedcomments,b.payloadsource),b.livethreadedcomments&&b.livethreadedcomments.length&&p(b.livethreadedcomments,b.payloadsource),b.authorpinnedcomments&&b.authorpinnedcomments.length&&p(b.authorpinnedcomments,b.payloadsource)});b("UFICentralUpdates").subscribe("update-actions",function(a,b){b.actions&&b.actions.length&&q(b.actions,b.payloadsource)});e.exports=L}),6);
__d("UFIFeedbackTargets",["Bootloader","KeyedCallbackManager","UFICentralUpdates"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("KeyedCallbackManager"))();function h(a){var c;if(!a)return;var d=babelHelpers["extends"]({},a);delete d.commentlist;delete d.commentcount;b("UFICentralUpdates").didUpdateFeedback(a.entidentifier);g.addResourcesAndExecute((c={},c[a.entidentifier]=d,c))}function i(a,c){__p&&__p();b("Bootloader").loadModules(["UFIFeedbackMutator"],function(b){__p&&__p();for(var d=0;d<a.length;d++){var e=a[d];e.arecommentsdisabled=!!e.arecommentsdisabled;e.cancomment=!!e.cancomment;e.hasviewerliked=!!e.hasviewerliked;e.hasviewersubscribed=!!e.hasviewersubscribed;e.likecount=e.likecount||0;var f=g.getResource(e.entidentifier);if(!f)break;var i=b.getHandlerForAction(e);h(i(f,e,c))}},"UFIFeedbackTargets")}a={getFeedbackTarget:function(a,b){a=g.executeOrEnqueue(a,b);b=g.getUnavailableResources(a);b.length;return a},getFeedbackTargetIfExists:function(a){return g.getResource(a)||null},unsubscribe:function(a){g.unsubscribe(a)}};b("UFICentralUpdates").subscribe("update-feedback",function(a,b){a=b.feedbacktarget?b.feedbacktarget:b.feedbacktargets&&b.feedbacktargets[0];a&&h(a)});b("UFICentralUpdates").subscribe("update-actions",function(a,b){b.actions&&b.actions.length&&i(b.actions,b.payloadsource)});e.exports=a}),6);
__d("UFIReactionsUtils",[],(function(a,b,c,d,e,f){__p&&__p();a={getReactionData:function(a,b,c,d){__p&&__p();b=parseInt(b,10);var e=!!b,f=a.reactorids?a.reactorids.slice(0):[],g=f.indexOf(c),h=0;e?g<0&&(c&&f.unshift(c),h=1):g>-1&&(f.splice(g,1),h=-1);g=Math.max(a.reactioncount+h,0);h=a.reactioncountreduced;h&&!isNaN(h)&&(d?h=d(g):h=g.toString());d=a.reactioncountmap||{};var i,j=a.viewerreaction;j&&d[j]&&(d[j]["default"]=Math.max((d[j]["default"]||0)-1,0),i=d[j].reduced,i&&!isNaN(i)&&(d[j].reduced=d[j]["default"].toString()));e&&d[b]&&(d[b]["default"]=(d[b]["default"]||0)+1,i=d[b].reduced,i&&!isNaN(i)&&(d[b].reduced=d[b]["default"].toString()));i=a.userreactions;(!i||Array.isArray(i))&&(i={});c&&(e?i[c]=b:delete i[c]);e=null;if(a.reactionsentences){c=!(j&&b);e={current:a.reactionsentences[c?"alternate":"current"],alternate:a.reactionsentences[c?"current":"alternate"]}}return{reactioncount:g,reactioncountmap:d,reactioncountreduced:h,reactionsentences:e,reactorids:f,userreactions:i,viewerreaction:b}},getReactionCountMapFromSummary:function(a){var b={};if(!a)return b;for(var c=0;c<a.length;c++){var d=a[c],e=d.feedback_reaction.key;b[e]={"default":d.reactors&&d.reactors.count,reduced:d.reactors&&d.reactors.display_count}}return b}};e.exports=a}),null);
__d("UFIStoryAction",["UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={changeAcceptedAnswer:function(a,c,d){return{type:b("UFIStoryActionType").CHANGE_ACCEPTED_ANSWER,instanceID:a.instanceid,ftentidentifier:c.ftentidentifier,comment:c,doAccept:d}},commentsArrived:function(a,c,d,e,f,g,h){return{type:b("UFIStoryActionType").COMMENTS_ARRIVED,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,section:f,newOffset:c,newLength:d,source:e,interactionRequestCorrelationID:g,liveVideoCommentPermalinkID:h}},pageInComments:function(a,c,d,e,f){return{type:b("UFIStoryActionType").PAGE_IN_COMMENTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,interactionRequestCorrelationID:a.interactionRequestCorrelationID,commentID:c,direction:d,nextRange:e,section:f}},showComments:function(a){return{type:b("UFIStoryActionType").SHOW_COMMENTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},showReplies:function(a,c,d){return{type:b("UFIStoryActionType").SHOW_REPLIES,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:c,initiatorComment:d}},spamFetched:function(a,c,d,e){return{type:b("UFIStoryActionType").SPAM_FETCHED,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,viewas:c,commentIDs:d,parentCommentID:e}},changeReaction:function(a,c,d,e,f){e===void 0&&(e=null);f===void 0&&(f=null);return{type:b("UFIStoryActionType").CHANGE_REACTION,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,contextArgs:a,reactionType:c,target:d,sphericalYaw:e,sphericalPitch:f}},changeReactionSuccess:function(a,c){return{type:b("UFIStoryActionType").CHANGE_REACTION_SUCCESS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,reactionType:c}},changeReactionFailure:function(a,c){return{type:b("UFIStoryActionType").CHANGE_REACTION_FAILURE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,reactionType:c}},toggleReplies:function(a,c){return{type:b("UFIStoryActionType").TOGGLE_REPLIES,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:c}},friendTyping:function(a){return{type:b("UFIStoryActionType").FRIEND_TYPING,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},someoneTyping:function(a){return{type:b("UFIStoryActionType").SOMEONE_TYPING,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},typingStopped:function(a){return{type:b("UFIStoryActionType").TYPING_STOPPED,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},pinComment:function(a,c,d){d===void 0&&(d=null);return{type:b("UFIStoryActionType").LIVE_PIN_COMMENT,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:c,pinEventID:d}},unpinComment:function(a,c){c===void 0&&(c=null);return{type:b("UFIStoryActionType").LIVE_UNPIN_COMMENT,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:null,pinEventID:c}},showFacecastReplies:function(a,c){return{type:b("UFIStoryActionType").SHOW_FACECAST_REPLIES,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:c}},hideFacecastReplies:function(a,c){return{type:b("UFIStoryActionType").HIDE_FACECAST_REPLIES,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,isExplicit:c}},addFacecastReply:function(a,c){return{type:b("UFIStoryActionType").ADD_FACECAST_REPLY,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,replyCommentID:c}},addFacecastReplies:function(a,c){return{type:b("UFIStoryActionType").ADD_FACECAST_REPLIES,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,replyCommentIDs:c}},facecastRepliesLoaded:function(a,c){return{type:b("UFIStoryActionType").FACECAST_REPLIES_LOADED,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentID:c}},setCommentsScrollDistance:function(a,c){return{type:b("UFIStoryActionType").SET_COMMENTS_SCROLL_DISTANCE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,scrollDist:c}},handleNewComments:function(a,c){return{type:b("UFIStoryActionType").HANDLE_NEW_COMMENTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,numComments:c}},handleNewFacecastReply:function(a,c){return{type:b("UFIStoryActionType").HANDLE_NEW_FACECAST_REPLY,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,replyCommentID:c}},setCommentReactionsMenuShown:function(a,c){return{type:b("UFIStoryActionType").SET_COMMENT_REACTIONS_MENU_SHOWN,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,commentReactionsMenuShown:c}}};e.exports=a}),null);
__d("UFIUserActionUtils",["Nectar","TrackingNodes","collectDataAttributes"],(function(a,b,c,d,e,f){__p&&__p();a={trackingData:function(a){if(!a)return{ft:{}};var c={ft:b("collectDataAttributes")(a,["ft"]).ft};if(g(c.ft.tn))return{};b("Nectar").addModuleData(c,a);return c}};function g(a){if(a){a=b("TrackingNodes").parseTrackingNodeString(a);for(var c=0;c<a.length;c++){var d=a[c][0];switch(d){case b("TrackingNodes").types.COMMENT:return!0}}}return!1}e.exports=a}),null);
__d("XUFICommentReactionController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/reaction/",{reaction_type:{type:"Enum",enumType:0}})}),null);
__d("XUFIReactionController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/reaction/",{client_id:{type:"String"},ft_ent_identifier:{type:"String"},reaction_type:{type:"Enum",enumType:0},story_render_location:{type:"Enum",enumType:1},is_inline:{type:"Bool",defaultValue:!1},is_comment:{type:"Bool",defaultValue:!1},is_permalink:{type:"Bool",defaultValue:!1},action_source:{type:"String"},feedback_source:{type:"Int"},feedback_referrer:{type:"String"},is_sponsored:{type:"Bool",defaultValue:!1},basic_origin_uri:{type:"String"},basic_reload:{type:"Exists",defaultValue:!1},bgsync_id:{type:"String"},aftercursor:{type:"String"},tab:{type:"String"},_ft_:{type:"String"}})}),null);
__d("UFIReactionUserActions",["ActorURI","AsyncResponse","ChannelClientID","ClientIDs","MercuryServerDispatcher","NumberFormat","QE2Logger","UFICentralUpdates","UFICommentAction","UFIComments","UFIConfig","UFIConstants","UFIFeedbackTargets","UFIReactionPendingRequestsStore","UFIReactionsUtils","UFIReactionSyncStore","UFIReactionTypes","UFISharedDispatcher","UFIStoryAction","UFIUserActionUtils","UFIVideoPlayerRegistry","XUFICommentReactionController","XUFIReactionController","ifRequired","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={changeReaction:function(a,c,d,e,f,g){__p&&__p();f===void 0&&(f=null),g===void 0&&(g=null),b("UFIFeedbackTargets").getFeedbackTarget(a,function(h){__p&&__p();var i=q(h,c);b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:i});i=b("UFIUserActionUtils").trackingData(e);var j={};j[b("ActorURI").PARAMETER_ACTOR]=h.actorforpost;var k=babelHelpers["extends"]({client_id:b("ClientIDs").getNewClientID(),ft_ent_identifier:a,reaction_type:c,root_id:d.rootid,session_id:b("ChannelClientID").getID(),source:d.source,feedback_referrer:d.feedbackReferrer,instance_id:d.instanceid},j,i);if(d.fluentContentToken){h=d.fluentContentToken;var l=b("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerForElement(e,h);l&&l.isSpherical()&&(k.video_playback_timestamp=b("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(e,h));d.isLiveVOD?k.on_demand_content_time_offset=b("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(e,h):d.islivestreaming&&(k.live_content_time_offset=b("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(e,h));l&&l.isSpherical()&&b("ifRequired")("SphericalViewportControlStore",function(a){a=a.getOrientation(l.getVideoPlayerID());a&&(f!==null&&g!==null?(k.spherical_yaw=f,k.spherical_pitch=g):(k.spherical_pitch=Math.round(a.pitch),k.spherical_yaw=Math.round(a.yaw)))})}b("MercuryServerDispatcher").trySend(b("XUFIReactionController").getURIBuilder().getURI(),k)})},changeCommentReaction:function(a,c,d,e){var f=b("UFIComments").getComment(a);f&&f.__typename==="saved"&&f.viewerreaction!=c&&b("UFIFeedbackTargets").getFeedbackTarget(f.ftentidentifier,function(g){var h=b("UFIUserActionUtils").trackingData(e),i=p(f,g,c);b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:i});i={};i[b("ActorURI").PARAMETER_ACTOR]=g.actorforpost;b("MercuryServerDispatcher").trySend(b("XUFICommentReactionController").getURIBuilder().getURI(),babelHelpers["extends"]({comment_id:a,legacy_id:f.legacyid,reaction_type:c,ft_ent_identifier:f.ftentidentifier,source:d.source,instance_id:d.instanceid,client_id:b("ClientIDs").getNewClientID(),session_id:b("ChannelClientID").getID()},h,i))})}},h={},i=b("XUFIReactionController").getURIBuilder().getURI();h[i]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:f,handler:d};i=b("XUFICommentReactionController").getURIBuilder().getURI();h[i]={mode:b("MercuryServerDispatcher").BATCH_CONDITIONAL,batch_if:a,batch_function:c,error_handler:o,handler:n};b("MercuryServerDispatcher").registerEndpoints(h);function a(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier&&a.comment_id==b.comment_id}function c(a,b){return b}var j="feedback_reactions_www_rollback_universe";function k(){b("QE2Logger").logExposureForUser(j)}function l(a,c){var d=b("UFIReactionPendingRequestsStore").getPendingRequests(a);if(d>0)return;var e=b("UFIReactionSyncStore").getLastKnownReaction(a);if(c===e)return;b("UFIFeedbackTargets").getFeedbackTarget(a,function(a){a=q(a,e);b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:a})})}function d(a,c){a=c.data;var d=a.ft_ent_identifier,e=a.reaction_type;b("UFISharedDispatcher").dispatch(b("UFIStoryAction").changeReactionSuccess({instanceid:a.instance_id,ftentidentifier:d},e));b("setImmediate")(function(){return l(d,e)})}function f(a){__p&&__p();var c=a.request.data,d=c.ft_ent_identifier,e=c.reaction_type;k();var f=b("UFIConfig").reactionsHasReactionsRollback,g=b("UFIConfig").reactionsHasReactionsRetry;if(g&&!c.retry_attempt){b("MercuryServerDispatcher").trySend(b("XUFIReactionController").getURIBuilder().getURI(),babelHelpers["extends"]({},c,{retry_attempt:1}));return}b("UFISharedDispatcher").dispatch(b("UFIStoryAction").changeReactionFailure({instanceid:c.instance_id,ftentidentifier:d},e));f&&b("setImmediate")(function(){return l(d,e)});b("AsyncResponse").defaultErrorHandler(a)}function m(a,c,d){var e=b("UFIReactionPendingRequestsStore").getPendingRequestsForComment(c.fbid);if(e>0)return;var f=b("UFIReactionSyncStore").getLastKnownCommentReaction(c.fbid);if(d===f)return;b("UFIFeedbackTargets").getFeedbackTarget(a,function(a){a=p(c,a,f);b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:a})})}function n(a,c){a=c.data;var d=a.ft_ent_identifier,e=a.reaction_type,f=b("UFIComments").getComment(a.comment_id);if(!f||f.__typename!=="saved")return;b("UFISharedDispatcher").dispatch(b("UFICommentAction").changeReactionSuccess({instanceid:a.instance_id,ftentidentifier:d},f,e));b("setImmediate")(function(){return m(d,f,e)})}function o(a){__p&&__p();var c=a.request.data,d=c.ft_ent_identifier,e=c.reaction_type,f=b("UFIComments").getComment(c.comment_id);if(!f)return;k();var g=b("UFIConfig").reactionsHasCommentReactionsRollback,h=b("UFIConfig").reactionsHasCommentReactionsRetry;if(h&&!c.retry_attempt){b("MercuryServerDispatcher").trySend(b("XUFICommentReactionController").getURIBuilder().getURI(),babelHelpers["extends"]({},c,{retry_attempt:1}));return}f&&f.__typename==="saved"&&(b("UFISharedDispatcher").dispatch(b("UFICommentAction").changeReactionFailure({instanceid:c.instance_id,ftentidentifier:d},f,e)),g&&b("setImmediate")(function(){return m(d,f,e)}));b("AsyncResponse").defaultErrorHandler(a)}function p(a,c,d){var e=a.id,f=[s(a,d,e,c.supportedreactions||[],c.actorforpost)];d=d===b("UFIReactionTypes").LIKE;if(c.hasviewerliked!==d){c=d?1:-1;f.push({commentid:e,actiontype:b("UFIConstants").UFIActionType.COMMENT_LIKE,viewerliked:d,likecount:(a.likecount||0)+c})}return f}function q(a,c){var d=[r(a,c)];c=c!==b("UFIReactionTypes").NONE;if(a.hasviewerliked!==c){var e=c?1:-1;d.push({actiontype:b("UFIConstants").UFIActionType.LIKE_ACTION,actorid:a.actorforpost,hasviewerliked:c,likecount:(a.likecount||0)+e,entidentifier:a.entidentifier,likesentences:{current:a.likesentences.alternate,alternate:a.likesentences.current}})}return d}function r(a,c){return Object.assign({actiontype:b("UFIConstants").UFIActionType.REACTION,actorid:a.actorforpost,entidentifier:a.entidentifier},b("UFIReactionsUtils").getReactionData(a,c,a.actorforpost,b("NumberFormat").formatInteger))}function s(a,c,d,e,f){var g={};for(var h=0;h<e.length;h++){var i=e[h],j=a.reactioncountmap?a.reactioncountmap[i]:null;g[i]={"default":j?j["default"]:0,reduced:j?j.reduced:"0"}}i=b("UFIReactionsUtils").getReactionData({viewerreaction:a.viewerreaction,reactioncount:a.reactioncount,reactioncountreduced:a.reactioncountreduced,reactioncountmap:g,reactorids:a.viewerreaction?[f]:[]},c,f);return{actiontype:b("UFIConstants").UFIActionType.COMMENT_REACTION,commentid:d,hasviewerliked:!!c,likecount:i.reactioncountmap[1]["default"],reactioncount:i.reactioncount,reactioncountmap:i.reactioncountmap,reactioncountreduced:i.reactioncountreduced,viewerreaction:c}}e.exports=g}),null);
__d("UFIReplyCommentList",["UFICentralUpdates","UFIComments","UFIConstants","UFIReplyCommentListImpl","getObjectValues"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h={getCommentList:function(a,c,d){g[c]||(g[c]={});if(!g[c][d]){a=new(b("UFIReplyCommentListImpl"))(a,c,d);var e=h.getReplyListsForParentCommentID(String(c));e.length&&a.updateCommentCount(e[0].getCommentCount());g[c][d]=a}return g[c][d]},getReplyListsForParentCommentID:function(a){return b("getObjectValues")(g[a]||{})},resetWithContext:function(a,b,c,d){a=(g[b]||{})[d];if(!a)return;a.reset();a.actorID=c}};function i(a){a=b("UFIComments").getComment(a.commentid);if(!a)return;var c=a.id,d=a.parentcommentid;if(!d)return;a.status!==b("UFIConstants").UFIStatus.DELETED&&a.status!==b("UFIConstants").UFIStatus.FAILED_ADD&&h.getReplyListsForParentCommentID(d).forEach(function(a){a.deleteComment(c)})}b("UFICentralUpdates").subscribe("update-actions",function(a,c){if(c.actions&&c.actions.length)for(var a=0;a<c.actions.length;a++){var d=c.actions[a];switch(d.actiontype){case b("UFIConstants").UFIActionType.DELETE_COMMENT:i(d);break}}});b("UFICentralUpdates").subscribe("update-comment-lists",function(a,b){a=b.commentlists;if(a&&a.replies&&Object.keys(a).length)for(var c in a.replies){b=a.replies[c];var d=b.ftentidentifier,e=b.containerorderingmode;d=h.getCommentList(String(d),String(c),e);d.addCommentIDs(b.range.offset,b.range.length,b.values);d.updateCommentCount(b.count)}});b("UFICentralUpdates").subscribe("update-comments",function(a,b){(b.comments||[]).concat(b.privatecomments||[]).concat(b.authorpinnedcomments||[]).forEach(function(a){var b=a.parentcommentid;if(!b)return;h.getReplyListsForParentCommentID(String(b)).forEach(function(b){b.addOrUpdateComment(a)})})});e.exports=h}),6);
__d("UFIThreadedFacecastCommentsStore",["FeedbackPayloadSourceType","FluxReduceStore","UFIComments","UFIDispatcherBase","UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){__p&&__p();switch(c.type){case b("UFIStoryActionType").SHOW_FACECAST_REPLIES:var d;return babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:c.commentID,reply_comment_ids:this.getReplyCommentIDs(c.instanceID),is_loaded:!1},d));case b("UFIStoryActionType").HIDE_FACECAST_REPLIES:return babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:null,reply_comment_ids:[],is_loaded:!1},d));case b("UFIStoryActionType").ADD_FACECAST_REPLY:if(this.getCommentID(c.instanceID)===null)return a;d=c.replyCommentID;var e=this.getReplyCommentIDs(c.instanceID);e.indexOf(d)===-1&&(e=e.slice(0),e.push(d));return babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:this.getCommentID(c.instanceID),reply_comment_ids:e,is_loaded:this.getIsLoaded(c.instanceID)},d));case b("UFIStoryActionType").ADD_FACECAST_REPLIES:if(this.getCommentID(c.instanceID)===null)return a;var f=this.getReplyCommentIDs(c.instanceID);e=c.replyCommentIDs.filter(function(a){return f.indexOf(a)===-1});e.length!==0&&(f=f.concat(e));return babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:this.getCommentID(c.instanceID),reply_comment_ids:f,is_loaded:this.getIsLoaded(c.instanceID)},d));case b("UFIStoryActionType").FACECAST_REPLIES_LOADED:e=this.getCommentID(c.instanceID);return e!==c.commentID?a:babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:this.getCommentID(c.instanceID),reply_comment_ids:this.getReplyCommentIDs(c.instanceID),is_loaded:!0},d));case b("UFIStoryActionType").COMMENTS_ARRIVED:if(c.source!==b("FeedbackPayloadSourceType").INITIAL_SERVER||c.liveVideoCommentPermalinkID==null)return a;e=b("UFIComments").getComment(c.liveVideoCommentPermalinkID);return e==null?a:babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:e.parentcommentid||e.id,reply_comment_ids:this.getReplyCommentIDs(c.instanceID),is_loaded:this.getIsLoaded(c.instanceID)},d));case"CENTRALUPDATES_SAVED_COMMENT":e=this.getReplyCommentIDs(c.instanceID);if(e.length===0)return a;d=e.indexOf(c.clientID);if(d===-1)return a;e.slice(0)[d]=c.commentID;return babelHelpers["extends"]({},a,(d={},d[c.instanceID]={comment_id:this.getCommentID(c.instanceID),reply_comment_ids:e,is_loaded:this.getIsLoaded(c.instanceID)},d));default:return a}};d.getCommentID=function(a){a=this.getState()[a];return!a?null:a.comment_id};d.getReplyCommentIDs=function(a){a=this.getState()[a];return!a?[]:a.reply_comment_ids};d.getIsLoaded=function(a){a=this.getState()[a];return!a?!1:a.is_loaded};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIToplevelPagedCommentList",["CommentPrivacyValue","CommentSection","UFICentralUpdates","UFIComments","UFIConstants","UFIReplyCommentList","UFIToplevelPagedCommentListImpl","UFIToplevelStreamedCommentList","WebCommentViewOption","forEachObject"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h={getCommentList:function(a,c,d){d=d||b("CommentSection").DEFAULT;g[a]||(g[a]={});g[a][d]||(g[a][d]={});if(!g[a][d][c]){var e=new(b("UFIToplevelPagedCommentListImpl"))(a,c,d),f=h.getSectionedCommentListsForFeedbackTargetID(a,d);f.length&&e.updateCommentCount(f[0].getCommentCount());g[a][d][c]=e}return g[a][d][c]},getAllCommentListsForFeedbackTargetID:function(a){var c=[];b("forEachObject")(g[a]||{},function(a){b("forEachObject")(a,function(a){c.push(a)})});return c},getSectionedCommentListsForFeedbackTargetID:function(a,b){var c=[];a=(g[a]||{})[b]||{};for(var d in a)c.push(a[d]);return c},getPagedCommentCountForFeedbackTargetID:function(a,b){a=h.getSectionedCommentListsForFeedbackTargetID(a,b);return a.length?a[0].getCommentCount():null},getDisplayedCommentCountForFeedbackTargetID_UNSAFE:function(a){var c=h.getSectionedCommentListsForFeedbackTargetID(a,b("CommentSection").DEFAULT);c=c.length?c[0].getDisplayedCommentCount():null;a=b("UFIToplevelStreamedCommentList").getAllExistingCommentLists(a);a=a.length?a[0].getDisplayedCommentCount():null;return c===null&&a===null?null:Math.max(c||0,a||0)},resetCommentListsForFeedbackTargetID:function(a){__p&&__p();a=g[a];if(!a)return;var c={};for(var d in a){var e=a[d];for(var f in e){var h=e[f];h=h.reset();for(var i in h){var j=h[i];c[j]=!0}}}b("UFIComments").resetComments(c)},resetCommentListsWithContext:function(a,c){__p&&__p();var d=g[a];if(!d)return;var e={};for(var f in d){var h=d[f];for(var i in h){var j=h[i];j.actorID=c;j=j.reset();for(var k in j){var l=j[k];e[l]=!0;b("UFIReplyCommentList").resetWithContext(a,l,c,i)}}}b("UFIComments").resetComments(e)}};function i(a){__p&&__p();var c=b("UFIComments").getComment(a.commentid);if(!c)return;var d=c.id,e=c.ftentidentifier,f=c.parentcommentid;if(f)return;f=b("CommentSection").DEFAULT;(c.privacy_value===b("CommentPrivacyValue").FRIENDS_ONLY||c.privacy_value===b("CommentPrivacyValue").FRIENDS_AND_POST_OWNER)&&g[e]&&g[e][b("CommentSection").FRIENDS]&&(f=b("CommentSection").FRIENDS);(a.islocal||c.status!==b("UFIConstants").UFIStatus.DELETED&&c.status!==b("UFIConstants").UFIStatus.FAILED_ADD)&&h.getSectionedCommentListsForFeedbackTargetID(e,f).forEach(function(a){a.deleteComment(d)})}function j(a,c){b("forEachObject")(a,function(a,d){b("forEachObject")(a,function(a,b){b=h.getCommentList(d,b,c);b.addCommentIDs(a.range.offset,a.range.length,a.values);b.setClientHasAll(!!a.clienthasall);typeof a.count==="number"&&a.count!==b.getCommentCount()&&b.updateCommentCount(a.count)})})}function k(a,b){a.forEach(function(a){if(a.parentcommentid)return;var c=a.ftentidentifier;h.getSectionedCommentListsForFeedbackTargetID(c,b).forEach(function(b){b.addOrUpdateComment(a)})})}b("UFICentralUpdates").subscribe("update-actions",function(a,c){if(c.actions&&c.actions.length)for(var a=0;a<c.actions.length;a++){var d=c.actions[a];switch(d.actiontype){case b("UFIConstants").UFIActionType.DELETE_COMMENT:i(d);break}}});b("UFICentralUpdates").subscribe("update-comment-lists",function(a,c){a=c.commentlists;c=c.privatecommentlists;a&&a.comments&&j(a.comments,b("CommentSection").DEFAULT);c&&c.comments&&j(c.comments,b("CommentSection").FRIENDS)});b("UFICentralUpdates").subscribe("update-comments",function(a,c){a=c.comments;var d=c.privatecomments;c=c.authorpinnedcomments;a&&a.length&&k(a,b("CommentSection").DEFAULT);d&&d.length&&k(d,b("CommentSection").FRIENDS);c&&c.length&&k(c,b("CommentSection").DEFAULT)});b("UFICentralUpdates").subscribe("update-feedback",function(a,c){__p&&__p();var d=c.feedbacktarget?c.feedbacktarget:c.feedbacktargets&&c.feedbacktargets[0];if(d){var e=d.entidentifier;a=d.defaultcommentorderingmode;var f=new Set();a&&f.add(a);d.orderingmodes&&d.orderingmodes.forEach(function(a){if(a.value===b("WebCommentViewOption").LIVE_STREAMING)return;f.add(a.value)});c=d.privatecommentcount;f.forEach(function(a){h.getCommentList(e,a,b("CommentSection").DEFAULT).updateCommentCount(d.commentcount)});typeof c==="number"&&h.getCommentList(e,b("WebCommentViewOption").TOPLEVEL,b("CommentSection").FRIENDS).updateCommentCount(c)}});e.exports=h}),6);
__d("UFIStreamingStateType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({LIVE:"live",ON_DEMAND:"on_demand"})}),null);
__d("UFIToplevelStreamedCommentList",["invariant","ClientIDs","LiveVideoUFIConfig","UFICentralUpdates","UFICommentLogger","UFIComments","UFIConfig","UFIConstants","UFIRange","UFIStreamingStateType","UFIThreadedFacecastCommentsStore","gkx","objectValues"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=function(){__p&&__p();function a(a){this.feedbackTargetID=a,this.commentIDs=[],this.deletedCount=0,this.totalCommentCount=0,this.addedCommentCountForUnseenCounter=0}var c=a.prototype;c.getFeedbackTargetID=function(){return this.feedbackTargetID};c.getClientHasAll=function(){return!1};c.getActualCommentCount=function(){return this.commentIDs.length};c.getCommentCount=function(){return this.totalCommentCount};c.getAddedCommentCountForUnseenCounter=function(){return this.addedCommentCountForUnseenCounter};c.getDisplayedCommentCount=function(){return this.getCommentCount()-this.getDeletedCount()};c.getDeletedCount=function(){return this.deletedCount};c.getPermalinkForComment=function(a){return""};c.getComments=function(a,c,d,e){e(this.getCommentsOrThrow(new(b("UFIRange"))(a,c),d))};c.getCommentsOrThrow=function(a,c){__p&&__p();a=[a.getLength(),a.getOffset()];var d=a[0];a=a[1];a===0||g(0,2239);a=c.streamingOrderReversed;c={};for(var e=0;e<Math.min(d,this.commentIDs.length);++e){var f=a?this.commentIDs.length-1-e:e;f=b("UFIComments").getComment(this.commentIDs[f]);f&&(c[e]=f)}return c};c.$3=function(){var a=this.commentIDs;this.commentIDs=[];return a};c.hasComment=function(a){for(var b=0;b<this.commentIDs.length;++b)if(this.commentIDs[b]===a.id)return!0;return!1};c.addCommentIDs=function(a,b,c){};c.setClientHasAll=function(a){};c.addOrUpdateComment=function(a,c){__p&&__p();c===void 0&&(c=null);var d=a.clientid;if(d&&b("ClientIDs").isExistingClientID(d))for(var e=0;e<this.commentIDs.length;++e)this.commentIDs[e]===d&&(this.commentIDs[e]=a.id,b("UFIConfig").logCommentPost&&b("UFICommentLogger").logNewCommentReceived(d,Date.now()));else if(c||a.__typename==="local"){if(this.hasComment(a))return;this.commentIDs.push(a.id);c!==b("UFIStreamingStateType").ON_DEMAND&&!a.isAnnouncement&&!a.tipOptionIndex&&(this.totalCommentCount+=1,a.__typename!=="local"&&((b("gkx")("678270")||!b("objectValues")(b("UFIThreadedFacecastCommentsStore").getState()||{}).map(function(a){return(a=a)!=null?a.comment_id:a}).includes(a.parentcommentid))&&(this.addedCommentCountForUnseenCounter+=1)))}e=b("LiveVideoUFIConfig").live_video_scrollable_comments;this.commentIDs.length>e&&this.commentIDs.shift();b("UFICentralUpdates").didUpdateFeedback(this.feedbackTargetID)};c.deleteComment=function(a){this.deletedCount+=1;var c=[];for(var d=0;d<this.commentIDs.length;++d){var e=this.commentIDs[d],f=b("UFIComments").getComment(e);e!==a&&((f=f)!=null?f.parentcommentid:f)!==a&&c.push(e)}this.commentIDs=c};c.updateCommentCount=function(a){this.totalCommentCount=a,this.deletedCount=0};a.getCommentList=function(b,c){c===void 0&&(c=a.GLOBAL_ID);var d=a.$1.get(b);d||(d=new Map(),a.$1.set(b,d));var e=d.get(c);e||(e=new a(b),d.set(c,e));return e};a.getExistingCommentList=function(b,c){c===void 0&&(c=a.GLOBAL_ID);b=a.$1.get(b);return!b?null:b.get(c)};a.getAllExistingCommentLists=function(b){b=a.$1.get(b);return!b?[]:Array.from(b.values())};a.$4=function(b,c){__p&&__p();var d=a.$2.get(b);if(d){c.forEach(function(a){d[a]=!0});return}var e={};c.forEach(function(a){e[a]=!0});a.$2.set(b,e)};a.resetCommentList=function(b,c){c===void 0&&(c=a.GLOBAL_ID);c=a.getExistingCommentList(b,c);if(!c)return;a.$4(b,c.$3())};a.resetAllCommentLists=function(c){var d=a.getAllExistingCommentLists(c);if(d.length===0)return;d.forEach(function(b){a.$4(c,b.$3())});d=a.$2.get(c);d&&(a.$2["delete"](c),b("UFIComments").resetComments(d))};return a}();h.GLOBAL_ID="GLOBAL_ID";h.$1=new Map();h.$2=new Map();b("UFICentralUpdates").subscribe("update-actions",function(a,c){__p&&__p();if(!c.actions)return;c.actions.forEach(function(a){__p&&__p();if(a.actiontype!==b("UFIConstants").UFIActionType.DELETE_COMMENT)return;var c=b("UFIComments").getComment(a.commentid);if(!c)return;var d=c.id,e=c.ftentidentifier,f=c.parentcommentid;if(f)return;(a.islocal||c.status!==b("UFIConstants").UFIStatus.DELETED&&c.status!==b("UFIConstants").UFIStatus.FAILED_ADD)&&h.getAllExistingCommentLists(e).forEach(function(a){return a.deleteComment(d)})})});b("UFICentralUpdates").subscribe("update-comments",function(a,b){if(!b.comments)return;var c=b.targetufiinstanceid;b.comments.forEach(function(a){c?h.getCommentList(a.ftentidentifier,c).addOrUpdateComment(a,b.streamingstate):h.getAllExistingCommentLists(a.ftentidentifier).forEach(function(c){c.addOrUpdateComment(a,b.streamingstate)})})});b("UFICentralUpdates").subscribe("update-feedback",function(a,b){var c=b.feedbacktarget?b.feedbacktarget:b.feedbacktargets&&b.feedbacktargets[0];if(!c)return;h.getAllExistingCommentLists(c.entidentifier).forEach(function(a){return a.updateCommentCount(c.commentcount)})});e.exports=h}),6);
__d("CommentPostedLiveState",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({LIVE:"Live",ON_DEMAND:"OnDemand"})}),null);
__d("XGroupsMuteMembersController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groups/mutemember/",{group_id:{type:"FBID"},user_id:{type:"FBID"},mute_duration:{type:"Enum",enumType:1},source:{type:"Enum",enumType:1},should_reload:{type:"Bool",defaultValue:!1},mute_reason:{type:"FBID"},custom_expiration:{type:"Int"},share_feedback:{type:"Bool",defaultValue:!1},selected_rules:{type:"FBIDVector",defaultValue:[]},admin_notes:{type:"String",defaultValue:""}})}),null);
__d("XTownHallController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/townhall/",{ref:{type:"Enum",enumType:1},notif_id:{type:"Int"},setting_nux:{type:"Bool",defaultValue:!1},new_reps:{type:"Int"},tab:{type:"Enum",enumType:1}})}),null);
__d("XUFIActorChangeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/actor/change/",{})}),null);
__d("XUFIAddCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/add/comment/",{})}),null);
__d("XUFIAuthorPinnedCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/author_pin/",{})}),null);
__d("XUFICommentAcceptAnswerController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/answer/accept/",{})}),null);
__d("XUFICommentAppealSpamController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/appeal_spam/",{})}),null);
__d("XUFICommentBulkReviewController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comments/bulk_review/",{feedback_target_id:{type:"FBID",required:!0},entry_point:{type:"Enum",required:!0,enumType:1},refetch_data:{type:"Bool",defaultValue:!1},__asyncDialog:{type:"Int"}})}),null);
__d("XUFICommentKeepSpamController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/keep_spam/",{})}),null);
__d("XUFICommentLikeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/like/",{})}),null);
__d("XUFICommentSecureAccountController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/comment/secure_account/",{})}),null);
__d("XUFIDeleteCommentAndRemoveCommenterController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/deletecommentandremovecommenter/",{})}),null);
__d("XUFIDeleteCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/delete/comment/",{})}),null);
__d("XUFIEditCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/edit/comment/",{})}),null);
__d("XUFIHideCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/hide/comment/",{})}),null);
__d("XUFILikeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/like/",{})}),null);
__d("XUFIToggleTextDelightsAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/textdelights/hide_comment_text_delights/",{comment_id:{type:"String"},should_hide:{type:"Bool",defaultValue:!1}})}),null);
__d("XUFITranslateCommentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ufi/translate/comment/",{})}),null);
__d("UFIUserActions",["errorCode","fbt","invariant","ActorURI","AsyncRequest","AsyncResponse","Bootloader","ChannelClientID","ClientIDs","CommentPostedLiveState","CommentPrivacyValue","ImmutableObject","MercuryServerDispatcher","UFICentralUpdates","UFICommentActionType","UFICommentLogger","UFIComments","UFICommentVoteUserActions","UFIConfig","UFIConstants","UFIFeedbackTargets","UFINewCommentsPillUtils","UFIReactionUserActions","UFIStoryAction","UFIToplevelPagedCommentList","UFIToplevelStreamedCommentList","UFIUserActionUtils","UFIVideoPlayerRegistry","UnicodeBidi","XGroupsMuteMembersController","XTownHallController","XUFIActorChangeController","XUFIAddCommentController","XUFIAuthorPinnedCommentController","XUFICommentAcceptAnswerController","XUFICommentAppealSpamController","XUFICommentBulkReviewController","XUFICommentKeepSpamController","XUFICommentLikeController","XUFICommentSecureAccountController","XUFIDeleteCommentAndRemoveCommenterController","XUFIDeleteCommentController","XUFIEditCommentController","XUFIHideCommentController","XUFILikeController","XUFIToggleTextDelightsAsyncController","XUFITranslateCommentController","goURI","ifRequired"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=Object.freeze({BAN:"ban",UNDO_BAN:"undo_ban"}),k={changeActor:function(a,c){b("UFIFeedbackTargets").getFeedbackTarget(a,function(d){b("UFIToplevelPagedCommentList").resetCommentListsWithContext(a,c);b("UFIToplevelStreamedCommentList").resetAllCommentLists(a);b("UFICentralUpdates").inform("actor-changed",{actorID:c});d=(d={from_actor_id:d.actorforpost,ft_ent_identifier:a},d[b("ActorURI").PARAMETER_ACTOR]=c,d);var e=b("XUFIActorChangeController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(e,d)})},changeCommentLike:function(a,c,d){__p&&__p();var e=b("UFIComments").getComment(a);if(e&&e.__typename==="saved"&&e.hasviewerliked!=c){var f=d.target?b("UFIUserActionUtils").trackingData(d.target):{},g=c?1:-1;g={commentid:a,actiontype:b("UFIConstants").UFIActionType.COMMENT_LIKE,viewerliked:c,likecount:(e.likecount||0)+g};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[g]});b("UFIFeedbackTargets").getFeedbackTarget(e.ftentidentifier,function(g){var h={};h[b("ActorURI").PARAMETER_ACTOR]=g.actorforpost;g=b("XUFICommentLikeController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(g,babelHelpers["extends"]({comment_id:a,legacy_id:e.legacyid,like_action:c,ft_ent_identifier:e.ftentidentifier,source:d.source,client_id:b("ClientIDs").getNewClientID(),session_id:b("ChannelClientID").getID()},f,h))})}},_getAttachment:function(a){return a},_getLocalComment:function(a,c,d,e,f,g){e=b("ClientIDs").getNewClientID();var i=b("UnicodeBidi").isDirectionLTR(d)?"ltr":"rtl",j=this._getAttachment(f.attachedsticker),k=f.replyid,l=null;if(k!=null){k=b("UFIComments").getComment(k);l=k!=null?k.author:null}return{__typename:"local",ftentidentifier:c,body:{text:d,dir:i},author:a.actorforpost,cancomment:!1,clientid:null,fbid:null,id:e,ufiinstanceid:f.ufiinstanceid,likecount:0,hasviewerliked:!1,parentcommentid:f.replyid,parentcommentauthorid:l,replycommentparentid:f.replycommentparentid,attachment:j,photo_comment:f.attachedphoto,video_comment:f.attachedvideo,file_comment:f.attachedfile,timestamp:{time:Math.floor(Date.now()/1e3),text:h._("A few seconds ago")},photoTextTagID:f.photoTextTagID,isPhotoTag:f.isPhotoTag,photoTagX:f.photoTagX,photoTagY:f.photoTagY,privacy_value:f.privacyValue,videoTimeOffset:g,postedLiveState:f.islivestreaming?b("CommentPostedLiveState").LIVE:b("CommentPostedLiveState").ON_DEMAND,trackingID:f.trackingID,voteEnabled:!1,voteCount:0,voteState:b("UFIConstants").UFICommentVoteType.NONE}},addComment:function(a,c,d,e){__p&&__p();var f=this;b("UFIFeedbackTargets").getFeedbackTarget(a,function(g){__p&&__p();var h=f.createComment(a,c,d,e);if(!h)return;var i={actiontype:b("UFIConstants").UFIActionType.SUBSCRIBE_ACTION,actorid:g.actorforpost,hasviewersubscribed:!0,entidentifier:g.entidentifier};g={actiontype:b("UFIConstants").UFIActionType.ADD_COMMENT_ACTION,feedbackfbid:g.targetfbid};var j=[],k=[];(h.privacy_value===b("CommentPrivacyValue").FRIENDS_ONLY||h.privacy_value===b("CommentPrivacyValue").FRIENDS_AND_POST_OWNER?k:j).push(h);b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:j,privatecomments:k,actions:[i,g]});if(h.parentcommentid&&(e.islivestreaming||e.isLiveVOD)&&e.ufiinstanceid!=null){j={ftentidentifier:a,instanceid:e.ufiinstanceid};b("UFINewCommentsPillUtils").dispatchNewCommentAction(b("UFIStoryAction").handleNewFacecastReply(j,h.id),j)}})},createComment:function(a,c,d,e){__p&&__p();var f=b("UFIFeedbackTargets").getFeedbackTargetIfExists(a);if(!(f&&f.actorforpost))return null;var g=null,h=null;if(e.isBroadcasterUFI)g=b("ifRequired")("LiveVideoBroadcastBroadcastStore",function(a){return a.getCurrentBroadcastTime()});else if(e.isActiveLivingRoom&&e.livingRoomID!=null){var i=b("ifRequired")("LivingRoomStore",function(a){return a.getVideoPlayerController(e.livingRoomID)});g=i?Math.round(i.getCurrentTimePosition()):null;h=b("ifRequired")("LivingRoomStore",function(a){return(a=a.getCurrentContentItem(e.livingRoomID))==null?void 0:a.id})}else if(e.fluentContentToken&&(e.isLiveVOD||e.islivestreaming||e.enableVODCommentTimestamps)){i=b("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTimeForElement(e.target,e.fluentContentToken)||0;if(e.isLiveVOD||e.islivestreaming)g=i;else{var j=b("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerForElement(e.target,e.fluentContentToken);j!=null&&i>0&&i<Math.floor(j.getPlaybackDuration())&&(g=i)}}j=this._getLocalComment(f,a,c,d,e,g);this._sendCommentToServer(a,f.actorforpost,c,d,e,j.id,g,h);return j},_sendCommentToServer:function(a,c,d,e,f,g,h,j){__p&&__p();d=null;if(f.reply_fbid)d=f.reply_fbid;else if(f.replyid){var k=b("UFIComments").getComment(f.replyid);k||i(0,199);d=k.fbid}var l;b("UFIConfig").logCommentPost&&b("UFICommentLogger").logNewCommentPost(g,f.timestamp||0,{has_photo:!!f.attachedphoto,has_video:!!f.attachedvideo,has_file:!!f.attachedfile,has_sticker:!!f.attachedsticker,is_reply:!!f.replyid});k={};f.liveVideoQuickCommentQuality!=null&&(k={live_video_quick_comment_quality:f.liveVideoQuickCommentQuality});var m={};m[b("ActorURI").PARAMETER_ACTOR]=c;c=b("XUFIAddCommentController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(c,babelHelpers["extends"]({ft_ent_identifier:a,comment_text:e,source:f.source,client_id:g,session_id:b("ChannelClientID").getID(),reply_fbid:d,parent_comment_id:f.parent_comment_id||f.replyid,reply_comment_parent_id:f.replycommentparentid,rootid:f.rootid,clp:l,attached_sticker_fbid:f.attachedsticker?f.attachedsticker.fbid:0,attached_photo_fbid:f.attachedphoto?f.attachedphoto.fbid:0,attached_video_fbid:f.attachedvideo?f.attachedvideo.fbid:0,attached_file_fbid:f.attachedfile?f.attachedfile.fbid:0,attached_share_url:f.attachedshareurl,feedback_referrer:f.feedbackReferrer,feed_context:f.feedcontext,video_time_offset:h,is_live_streaming:f.islivestreaming,is_markdown:f.isMarkdown},b("UFIUserActionUtils").trackingData(f.target),m,{living_room_content_item_id:j,photo_text_tag_id:f.photoTextTagID,is_photo_tag:f.isPhotoTag,photo_fbid:f.photoFBID,photo_tag_x:f.photoTagX,photo_tag_y:f.photoTagY,privacy_value:f.privacyValue,delight_ranges:f.delightRanges,selected_insight_point:f.selectedInsightPoint},k))},_hasCommentTextChanged:function(a,b){return!!a.body&&a.body.text!=b},_hasCommentPhotoChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&b&&a.fbid!=b.fbid)},_hasCommentVideoChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&b&&a.fbid!=b.fbid)},_hasCommentFileChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&b&&a.fbid!=b.fbid)},_hasCommentStickerChanged:function(a,b){return!!((a||b)&&!(a&&b)||a&&a.type=="sticker"&&b&&a.fbid!=b.fbid)},_hasCommentShareURLChanged:function(a,b){if(b)return!0;else return Boolean(a&&a.type=="share")},editComment:function(a,c,d,e){__p&&__p();var f=b("UFIUserActionUtils").trackingData(e.target),g=b("UFIComments").getComment(a);if(!g)return;a=this._hasCommentTextChanged(g,c)||this._hasCommentPhotoChanged(g.photo_comment,e.attachedPhoto)||this._hasCommentStickerChanged(g.attachment,e.attachedSticker)||this._hasCommentVideoChanged(g.video_comment,e.attachedVideo)||this._hasCommentFileChanged(g.file_comment,e.attachedFile)||this._hasCommentShareURLChanged(g.attachment,e.attachedShareURL);g=b("ImmutableObject").set(g,{status:b("UFIConstants").UFIStatus.PENDING_EDIT,body:{text:c},editnux:null,attachment:e.attachedSticker,photo_comment:e.attachedPhoto,video_comment:e.attachedVideo,file_comment:e.attachedFile});a&&(g=b("ImmutableObject").set(g,{originalTimestamp:g.timestamp.time,timestamp:{time:Math.floor(Date.now()/1e3),text:h._("A few seconds ago")}}));b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[g]});b("UFIFeedbackTargets").getFeedbackTarget(g.ftentidentifier,function(a){var c={};c[b("ActorURI").PARAMETER_ACTOR]=a.actorforpost;a=b("XUFIEditCommentController").getURIBuilder().getURI();g&&b("MercuryServerDispatcher").trySend(a,babelHelpers["extends"]({ft_ent_identifier:g.ftentidentifier,comment_text:d,source:e.source,comment_id:g.id,parent_comment_id:g.parentcommentid,attached_sticker_fbid:e.attachedSticker?e.attachedSticker.fbid:0,attached_photo_fbid:e.attachedPhoto?e.attachedPhoto.fbid:0,attached_video_fbid:e.attachedVideo?e.attachedVideo.fbid:0,attached_file_fbid:e.attachedFile?e.attachedFile.fbid:0,attached_share_url:e.attachedShareURL,is_markdown:e.isMarkdown,delight_ranges:e.delightRanges},f,c))})},translateComments:function(a,c,d,e){var f=b("XUFITranslateCommentController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(f,{ft_ent_identifier:a,comment_ids:c,source:e.source,trigger:d})},setHideAsSpam:function(a,c,d){var e=b("UFIUserActionUtils").trackingData(d.target),f=b("UFIComments").getComment(a),g={commentid:a,actiontype:b("UFIConstants").UFIActionType.COMMENT_SET_SPAM,shouldHideAsSpam:c};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[g]});f&&b("UFIFeedbackTargets").getFeedbackTarget(f.ftentidentifier,function(g){var h={};h[b("ActorURI").PARAMETER_ACTOR]=g.actorforpost;g=b("XUFIHideCommentController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(g,babelHelpers["extends"]({comment_id:a,spam_action:c,ft_ent_identifier:f.ftentidentifier,source:d.source},e,h))})},keepSpam:function(a,c){var d=b("UFIUserActionUtils").trackingData(c.target),e=b("UFIComments").getComment(a),f={commentid:a,actiontype:b("UFIConstants").UFIActionType.COMMENT_KEEP_SPAM};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[f]});e&&b("UFIFeedbackTargets").getFeedbackTarget(e.ftentidentifier,function(f){var g={};g[b("ActorURI").PARAMETER_ACTOR]=f.actorforpost;f=b("XUFICommentKeepSpamController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(f,babelHelpers["extends"]({comment_id:a,ft_ent_identifier:e.ftentidentifier,source:c.source},d,g));b("Bootloader").loadModules(["SimpleXUIDialog"],function(a){a.show(h._("This comment is now visible on your post."),h._("Comment restored"))},"UFIUserActions")})},appealSpam:function(a,c,d){__p&&__p();var e=b("UFIUserActionUtils").trackingData(d.target),f=b("UFIComments").getComment(a);c={commentid:a,actiontype:b("UFIConstants").UFIActionType.COMMENT_APPEAL_SPAM};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[c]});f&&b("UFIFeedbackTargets").getFeedbackTarget(f.ftentidentifier,function(c){var g={};g[b("ActorURI").PARAMETER_ACTOR]=c.actorforpost;c=b("XUFICommentAppealSpamController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(c,babelHelpers["extends"]({comment_id:a,ft_ent_identifier:f.ftentidentifier,source:d.source},e,g));b("Bootloader").loadModules(["SimpleXUIDialog"],function(a){a.show(h._("Your feedback helps us do better."),h._("Thanks for letting us know"))},"UFIUserActions")})},secureAccount:function(a,c){var d=b("UFIUserActionUtils").trackingData(c.target),e=b("UFIComments").getComment(a);a={actiontype:b("UFIConstants").UFIActionType.COMMENT_SECURE_ACCOUNT,commentid:a,islocal:!0,oneclick:c.oneclick};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]});e&&b("UFIFeedbackTargets").getFeedbackTarget(e.ftentidentifier,function(a){var f={};f[b("ActorURI").PARAMETER_ACTOR]=a.actorforpost;a=b("XUFICommentSecureAccountController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(a,babelHelpers["extends"]({comment_id:e.id,ft_ent_identifier:e.ftentidentifier,source:c.source},d,f))})},removeComment:function(a,c,d){var e=b("UFIUserActionUtils").trackingData(c.target),f=b("UFIComments").getComment(a);a={actiontype:b("UFIConstants").UFIActionType.DELETE_COMMENT,commentid:a,islocal:!0,oneclick:c.oneclick};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]});f&&f.__typename==="saved"&&b("UFIFeedbackTargets").getFeedbackTarget(f.ftentidentifier,function(a){var g={};g[b("ActorURI").PARAMETER_ACTOR]=a.actorforpost;a=b("XUFIDeleteCommentController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(a,babelHelpers["extends"]({comment_id:f.id,comment_legacyid:f.legacyid,ft_ent_identifier:f.ftentidentifier,one_click:c.oneclick,source:c.source,block_author:d,client_id:b("ClientIDs").getNewClientID()},e,g))})},deleteCommentAndRemoveCommenter:function(a,c,d,e,f,g,h){var i=b("UFIUserActionUtils").trackingData(c.target),j=b("UFIComments").getComment(a);a={actiontype:b("UFIConstants").UFIActionType.DELETE_COMMENT_REMOVE_COMMENTER,commentid:a,islocal:!0,oneclick:c.oneclick};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]});j&&j.__typename==="saved"&&b("UFIFeedbackTargets").getFeedbackTarget(j.ftentidentifier,function(a){var k={};k[b("ActorURI").PARAMETER_ACTOR]=a.actorforpost;a=b("XUFIDeleteCommentAndRemoveCommenterController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(a,babelHelpers["extends"]({comment_id:j.id,comment_legacyid:j.legacyid,ft_ent_identifier:j.ftentidentifier,one_click:c.oneclick,source:c.source,delete_posts:d,delete_comments:e,decline_pending_members:f,block_permanently:g,apply_to_other_groups:h,client_id:b("ClientIDs").getNewClientID()},i,k))})},muteMember:function(a,c,d,e){__p&&__p();c=b("UFIComments").getComment(a);a=d!==null;if(c&&c.__typename==="saved"){a={authorid:c.author,actiontype:b("UFIConstants").UFIActionType.MUTE_MEMBER,shouldmute:a};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]});var f;b("Bootloader").loadModules(["GroupMemberActionSource"],function(a){f=a.GROUP_COMMENT},"UFIUserActions");a=b("XGroupsMuteMembersController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(a,{group_id:c.group_id,user_id:c.author,mute_duration:d,custom_expiration:e,should_reload:!1,source:f})}},showBulkReview:function(a,c){c=b("UFIComments").getComment(a);if(c){a=b("XUFICommentBulkReviewController").getURIBuilder().setFBID("feedback_target_id",c.ftentidentifier).setEnum("entry_point","comment_chevron").getURI();new(b("AsyncRequest"))(a).send()}},toggleTextDelights:function(a,c,d){var e=b("XUFIToggleTextDelightsAsyncController").getURIBuilder().getURI();b("MercuryServerDispatcher").trySend(e,{comment_id:a.id,ft_ent_identifier:a.ftentidentifier,should_hide:d,parent_comment_id:a.parentcommentid,source:c.source})},changeAcceptedAnswer:function(a,c){b("MercuryServerDispatcher").trySend(p,{ft_ent_identifier:a.id,do_accept:c})},banUser:function(a,c,d,e){e=d?j.BAN:j.UNDO_BAN;b("MercuryServerDispatcher").trySend("/ajax/ufi/ban_user.php",{page_id:c,commenter_id:a.author,action:e,comment_id:a.id,client_side:!0,post_only:!1})},streamBanUser:function(a,c,d,e){e=d?j.BAN:j.UNDO_BAN;b("MercuryServerDispatcher").trySend("/ajax/ufi/ban_user.php",{page_id:c,commenter_id:a.author,action:e,comment_id:a.id,client_side:!0,stream_only:!0})},changeSubscribe:function(a,c,d){b("UFIFeedbackTargets").getFeedbackTarget(a,function(e){var f=b("UFIUserActionUtils").trackingData(d.target);if(e.hasviewersubscribed!==c){var g={actiontype:b("UFIConstants").UFIActionType.SUBSCRIBE_ACTION,actorid:e.actorforpost,hasviewersubscribed:c,entidentifier:a};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[g]});g={};g[b("ActorURI").PARAMETER_ACTOR]=e.actorforpost;b("MercuryServerDispatcher").trySend("/ajax/ufi/subscribe.php",babelHelpers["extends"]({subscribe_action:c,ft_ent_identifier:a,source:d.source,client_id:b("ClientIDs").getNewClientID(),rootid:d.rootid,comment_expand_mode:d.commentexpandmode},f,g))}})},fetchSpamComments:function(a,c,d,e){b("MercuryServerDispatcher").trySend("/ajax/ufi/id_comment_fetch.php",{ft_ent_identifier:a,viewas:e,comment_ids:c,parent_comment_id:d,source:null})},manageConstituentBadge:function(a){b("goURI")(b("XTownHallController").getURIBuilder().setBool("setting_nux",!0).getURI())},authorPinComment:function(a,c){b("MercuryServerDispatcher").trySend(q,{comment_id:a.id,ft_ent_identifier:a.ftentidentifier,is_pinned_by_author:c});var d={commentid:a.id,pinnedByAuthor:c,actiontype:b("UFICommentActionType").CHANGE_PIN_BY_AUTHOR};a=b("UFIComments").getComment(a.id);if(!a)return;a=b("ImmutableObject").set(a,{ispinnedbyauthor:c});b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[a],actions:[d]})},removePreview:function(a,c){var d=b("UFIUserActionUtils").trackingData(c.target),e={commentid:a.id,actiontype:b("UFIConstants").UFIActionType.REMOVE_PREVIEW};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[e]});b("MercuryServerDispatcher").trySend("/ajax/ufi/remove_preview.php",babelHelpers["extends"]({comment_id:a.id,ft_ent_identifier:a.ftentidentifier,source:c.source},d))}};function a(a){b("AsyncResponse").defaultErrorHandler(a)}function c(a){__p&&__p();var c=a.request.data;b("AsyncResponse").defaultErrorHandler(a);var d=c.client_id||c.comment_id;d=b("UFIComments").getComment(d);if(!d)return;var e=d.status===b("UFIConstants").UFIStatus.PENDING_EDIT?b("UFIConstants").UFIStatus.FAILED_EDIT:b("UFIConstants").UFIStatus.FAILED_ADD;d=b("ImmutableObject").setDeep(d,{status:e,allowRetry:l(a),body:{mentionstext:c.comment_text,mentionsphoto:d.photo_comment,mentionsvideo:d.video_comment,mentionsfile:d.file_comment}});e=[];a=[];(d.privacy_value===b("CommentPrivacyValue").FRIENDS_ONLY||d.privacy_value===b("CommentPrivacyValue").FRIENDS_AND_POST_OWNER?a:e).push(d);b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:e,privatecomments:a})}function l(a){var b=a.getError();if(a.isBlockedAction())return!1;if(a.silentError)return!0;return b===1357012||b===1357006?!1:!0}function d(a){a=a.request.data;a=a.comment_id;a=b("UFIComments").getComment(a);if(!a)return;a=b("ImmutableObject").set(a,{status:a.priorstatus||null,priorstatus:void 0});b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[a]})}function f(a){a=a.request.data;a=a.comment_id;var c=b("UFIComments").getComment(a);if(!c)return;c=b("ImmutableObject").set(c,{commentid:a,needsApproval:!c.needsApproval,isApproved:!c.isApproved});b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[c]})}function g(a){a=a.request.data;a=a.comment_id;var c=b("UFIComments").getComment(a);c&&(c=b("ImmutableObject").set(c,{commentid:a,appealStatus:null,canAppeal:!c.canAppeal,canSecure:!c.canSecure}),b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{comments:[c]}))}function m(a){var c=a.request.data,d=c.comment_id,e=b("UFIComments").getComment(d);if(e&&c.like_action===e.hasviewerliked){c=e.hasviewerliked?-1:1;d={commentid:d,actiontype:b("UFIConstants").UFIActionType.COMMENT_LIKE,viewerliked:!e.hasviewerliked,likecount:(e.likecount||0)+c};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[d]})}b("AsyncResponse").defaultErrorHandler(a)}function n(a){var c=a.request.data,d=c.ft_ent_identifier;b("UFIFeedbackTargets").getFeedbackTarget(d,function(a){if(a.hasviewerliked===c.like_action){var e=a.hasviewerliked?-1:1;e={actiontype:b("UFIConstants").UFIActionType.LIKE_ACTION,actorid:a.actorforpost,hasviewerliked:!a.hasviewerliked,likecount:(a.likecount||0)+e,entidentifier:d,likesentences:{current:a.likesentences.alternate,alternate:a.likesentences.current}};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[e]})}});b("AsyncResponse").defaultErrorHandler(a)}function o(a){var c=a.request.data,d=c.ft_ent_identifier;b("UFIFeedbackTargets").getFeedbackTarget(d,function(a){if(a.hasviewersubscribed===c.subscribe_action){a={actiontype:b("UFIConstants").UFIActionType.SUBSCRIBE_ACTION,actorid:a.actorforpost,hasviewersubscribed:!a.hasviewersubscribed,entidentifier:d};b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.USER_ACTION,{actions:[a]})}});b("AsyncResponse").defaultErrorHandler(a)}a={"/ajax/ufi/ban_user.php":{mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:a},"/ajax/ufi/subscribe.php":{mode:b("MercuryServerDispatcher").BATCH_CONDITIONAL,error_handler:o,batch_if:t,batch_function:u},"/ajax/ufi/id_comment_fetch.php":{mode:b("MercuryServerDispatcher").IMMEDIATE},"/ajax/ufi/remove_preview.php":{mode:b("MercuryServerDispatcher").IMMEDIATE},"/profile/broadcast_request/async/add_composer_token/":{mode:b("MercuryServerDispatcher").IMMEDIATE}};o=b("XUFIAddCommentController").getURIBuilder().getURI();a[o]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:c};t=b("XUFIDeleteCommentController").getURIBuilder().getURI();a[t]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:d};o=b("XUFIDeleteCommentAndRemoveCommenterController").getURIBuilder().getURI();a[o]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:d};t=b("XUFICommentLikeController").getURIBuilder().getURI();a[t]={mode:b("MercuryServerDispatcher").BATCH_CONDITIONAL,error_handler:m,batch_if:r,batch_function:u};var p=b("XUFICommentAcceptAnswerController").getURIBuilder().getURI();a[p]={mode:b("MercuryServerDispatcher").IMMEDIATE};o=b("XGroupsMuteMembersController").getURIBuilder().getURI();a[o]={mode:b("MercuryServerDispatcher").IMMEDIATE};t=b("XUFIToggleTextDelightsAsyncController").getURIBuilder().getURI();a[t]={mode:b("MercuryServerDispatcher").IMMEDIATE};m=b("XUFIHideCommentController").getURIBuilder().getURI();a[m]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:d};r=b("XUFICommentKeepSpamController").getURIBuilder().getURI();a[r]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:f};o=b("XUFICommentAppealSpamController").getURIBuilder().getURI();a[o]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:g};t=b("XUFICommentSecureAccountController").getURIBuilder().getURI();a[t]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:g};m=b("XUFILikeController").getURIBuilder().getURI();a[m]={mode:b("MercuryServerDispatcher").BATCH_CONDITIONAL,error_handler:n,batch_if:s,batch_function:u};d=b("XUFIEditCommentController").getURIBuilder().getURI();a[d]={mode:b("MercuryServerDispatcher").IMMEDIATE,error_handler:c};r=b("XUFITranslateCommentController").getURIBuilder().getURI();a[r]={mode:b("MercuryServerDispatcher").IMMEDIATE};f=b("XUFIActorChangeController").getURIBuilder().getURI();a[f]={mode:b("MercuryServerDispatcher").IMMEDIATE};var q=b("XUFIAuthorPinnedCommentController").getURIBuilder().getURI();a[q]={mode:b("MercuryServerDispatcher").IMMEDIATE};b("MercuryServerDispatcher").registerEndpoints(a);function r(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier&&a.comment_id==b.comment_id}function s(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier}function t(a,b){return a&&a.ft_ent_identifier==b.ft_ent_identifier}function u(a,b){return b}e.exports=babelHelpers["extends"]({},k,b("UFIReactionUserActions"),b("UFICommentVoteUserActions"))}),null);
__d("UFICommentEditIDStore",["FluxReduceStore","UFIAddCommentActionType","UFICentralUpdates","UFICommentActionType","UFIDispatcherBase","UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){a=h(a,"string");return typeof a==="symbol"?a:String(a)}function h(a,b){__p&&__p();if(typeof a!=="object"||a===null)return a;var c=a[typeof Symbol==="function"?Symbol.toPrimitive:"@@toPrimitive"];if(c!==void 0){c=c.call(a,b||"default");if(typeof c!=="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(b==="string"?String:Number)(a)}a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){c=a.call(this,c)||this;b("UFICentralUpdates").subscribe("actor-changed",function(a,c){b("UFIDispatcherBase").dispatch({type:"PRIVATE_ACTOR_CHANGED",instanceID:!0,ftentidentifier:!0})});return c}var d=c.prototype;d.getInitialState=function(){return{}};d.getForInstance=function(a){return this.getState()[a]||null};d.reduce=function(a,c){switch(c.type){case"PRIVATE_ACTOR_CHANGED":return{};case b("UFIAddCommentActionType").CANCEL:case b("UFIStoryActionType").SHOW_FACECAST_REPLIES:case b("UFIStoryActionType").HIDE_FACECAST_REPLIES:case b("UFIAddCommentActionType").SUBMIT_EDIT:a[c.instanceID];var d=babelHelpers.objectWithoutPropertiesLoose(a,[c.instanceID].map(g));return d;case b("UFICommentActionType").EDIT:return babelHelpers["extends"]({},a,(d={},d[c.instanceID]=c.comment.id,d))}return a};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIVisibility",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({VISIBLE:"visible",HIDDEN:"hidden"});e.exports=a}),null);
__d("UFICommentVisibilityStore",["invariant","FluxReduceStore","UFICommentActionType","UFIComments","UFIDispatcherBase","UFIInstanceActionType","UFILivePinnedCommentStore","UFIRootRegistry","UFIVisibility","filterObject"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a,b){b===void 0&&(b=null);return b&&b.comment.fbid?a+"-"+b.comment.fbid+(b.isLivePinnedComment?"-P":"")+(b.isInLiveVideoReplyMode?"-R":""):a}function i(a,b){return a===b||a.startsWith(b+"-")}function j(a){a=b("UFIRootRegistry").getInstanceIDFromFTEntIdentifier(a);return a?a:[]}function k(a){return{instanceid:a}}a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.getVisibility=function(a,c,d){d===void 0&&(d=null);d=d?h(c.instanceid,d):h(c.instanceid);return Object.prototype.hasOwnProperty.call(a,d)?a[d]:b("UFIVisibility").HIDDEN};d.$UFICommentVisibilityStore1=function(a){a=k(a);return this.getVisibility(this.getState(),a)===b("UFIVisibility").VISIBLE};d.isFeedbackTargetVisible=function(a){var b=this;a=j(a);return a.some(function(a){return b.$UFICommentVisibilityStore1(a)})};d.reduce=function(a,c){__p&&__p();switch(c.type){case b("UFICommentActionType").UNMOUNTED:var d=babelHelpers["extends"]({},a);delete d[h(c.instanceID,c.renderedComment)];return d;case b("UFICommentActionType").CHANGE_VISIBILITY:return babelHelpers["extends"]({},a,(d={},d[h(c.instanceID,c.renderedComment)]=c.visibility,d));case b("UFIInstanceActionType").CHANGE_VISIBILITY:d=b("UFIRootRegistry").getFTEntIdentifierFromInstanceID(c.instanceID);var e=b("UFIComments").getCommentsForFTEntIdentifier(d);c.type===b("UFIInstanceActionType").CHANGE_VISIBILITY||g(0,3643);var f=c.visibility;if(e){e=e.reduce(function(a,b){a[h(c.instanceID,b.fbid?{comment:b,isLivePinnedComment:!1,isInLiveVideoReplyMode:!1}:null)]=f;return a},{});if(d){d=b("UFILivePinnedCommentStore").getPinnedCommentID(d);if(d){d=b("UFIComments").getComment(d);d&&d.__typename==="saved"&&(e[h(c.instanceID,{comment:d,isLivePinnedComment:!0,isInLiveVideoReplyMode:!1})]=f)}}return babelHelpers["extends"]({},a,(d={},d[h(c.instanceID)]=c.visibility,d),e)}case b("UFIInstanceActionType").REMOVE:var j=c.instanceID,k=h(j);return b("filterObject")(a,function(a,b){return b!==k&&!i(b,j)})}return a};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFILivePinnedCommentStore",["FluxReduceStore","UFIComments","UFIDispatcherBase","UFIFeedbackTargets","UFIStoryActionType","areEqual"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){var d;switch(c.type){case b("UFIStoryActionType").LIVE_PIN_COMMENT:case b("UFIStoryActionType").LIVE_UNPIN_COMMENT:var e=c.commentID,f=c.pinEventID;return babelHelpers["extends"]({},a,(d={},d[c.ftentidentifier]={commentID:e,pinEventID:f},d));default:return a}};d.areEqual=function(a,c){return b("areEqual")(a,c)};d.getPinnedCommentID=function(a){var c=this.getState()[a];if(!c){a=b("UFIFeedbackTargets").getFeedbackTargetIfExists(a);return!a?null:a.livepinnedcommentid||null}return c.commentID||null};d.getPinEventID=function(a){a=this.getState()[a];return!a?null:a.pinEventID||null};d.getPinnedCommentAuthorID=function(a){a=this.getPinnedCommentID(a);if(!a)return null;a=b("UFIComments").getComment(a);return a?a.author||null:null};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFILocallyComposedCommentStore",["invariant","ClientIDs","FluxReduceStore","UFIAddCommentActionType","UFICentralUpdatesLocalCommentAdapter","UFIDispatcherBase","setByPath"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){return babelHelpers["extends"]({},a)}a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){c=a.call(this,c)||this;b("UFICentralUpdatesLocalCommentAdapter").subscribeOnce();return c}var d=c.prototype;d.getInitialState=function(){return{}};d.getStateForInstance=function(a){return a?this.getState()[a]||{}:{}};d.reduce=function(a,c){__p&&__p();switch(c.type){case"CENTRALUPDATES_ADDED_COMMENT":b("ClientIDs").isExistingClientID(c.clientID)||g(0,3492);a=h(a);b("setByPath")(a,[c.instanceID,c.clientID],!0);return a;case"CENTRALUPDATES_SAVED_COMMENT":b("ClientIDs").isExistingClientID(c.clientID)||g(0,3492);a=h(a);b("setByPath")(a,[c.instanceID,c.commentID],!0);delete a[c.instanceID][c.clientID];return a;case b("UFIAddCommentActionType").SUBMIT_EDIT:a=h(a);b("setByPath")(a,[c.instanceID,c.comment.id],!0);return a}return a};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFISpamStore",["FluxReduceStore","UFIDispatcherBase","UFIStoryActionType","UFIUserActions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.areEqual=function(a,b){return Object.keys(a).length===Object.keys(b).length};d.reduce=function(a,c){switch(c.type){case b("UFIStoryActionType").SPAM_FETCHED:a=babelHelpers["extends"]({},a);c.commentIDs.forEach(function(b){return a[b]=!0});b("UFIUserActions").fetchSpamComments(c.ftentidentifier,c.commentIDs,c.parentCommentID,c.viewas);break}return a};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFIUnseenCommentsStore",["FluxReduceStore","UFIComments","UFIConstants","UFIDispatcherBase","UFIStoryActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=30;a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{}};d.reduce=function(a,c){__p&&__p();switch(c.type){case b("UFIStoryActionType").SET_COMMENTS_SCROLL_DISTANCE:var d=c.instanceID,e=c.scrollDist,f=this.getInstanceState(d);f=babelHelpers["extends"]({},f,{scrollDist:e});this.shouldAddUnseenCommentsForState(f)||(f.unseenComments=0,f.unseenCommentsByThread={});return babelHelpers["extends"]({},a,(e={},e[d]=f,e));case b("UFIStoryActionType").SET_COMMENT_REACTIONS_MENU_SHOWN:var g;d=c.instanceID;f=c.commentReactionsMenuShown;e=this.getInstanceState(d);return babelHelpers["extends"]({},a,(g={},g[d]=babelHelpers["extends"]({},e,{commentReactionsMenuShown:f}),g));case b("UFIStoryActionType").HANDLE_NEW_COMMENTS:d=c.instanceID;e=c.numComments;if(!this.shouldAddUnseenComments(d))return a;f=this.getInstanceState(d);return babelHelpers["extends"]({},a,(g={},g[d]=babelHelpers["extends"]({},f,{unseenComments:f.unseenComments+e}),g));case b("UFIStoryActionType").HANDLE_NEW_FACECAST_REPLY:d=c.instanceID;f=b("UFIComments").getComment(c.replyCommentID);if(!this.shouldAddUnseenComments(d)||!f)return a;e=this.getInstanceState(d);g=e.unseenCommentsByThread;c=f.parentcommentid;if(c)g[c]=g[c]||0,g[c]++;else return a;return babelHelpers["extends"]({},a,(f={},f[d]=babelHelpers["extends"]({},e,{unseenCommentsByThread:g}),f));default:return a}};d.getInstanceState=function(a){a=this.getState()[a];return a||{commentsReactionMenuShown:!1,scrollDist:0,unseenComments:0,unseenCommentsByThread:{}}};d.getCommentReactionsMenuShown=function(a){return this.getInstanceState(a).commentReactionsMenuShown};d.getScrolledUp=function(a){return this.getScrollDist(a)>b("UFIConstants").maxScrollDistanceForAutoScroll};d.getScrollDist=function(a){return this.getInstanceState(a).scrollDist};d.getUnseenComments=function(a){return this.getInstanceState(a).unseenComments};d.getUnseenCommentsByThread=function(a){return this.getInstanceState(a).unseenCommentsByThread};d.getUnseenCommentsInThread=function(a,b){a=this.getUnseenCommentsByThread(a);return a[b]||0};d.shouldAddUnseenComments=function(a){return this.shouldAddUnseenCommentsForState(this.getInstanceState(a))};d.shouldAddUnseenCommentsForState=function(a){return a.scrollDist>b("UFIConstants").maxScrollDistanceForAutoScroll||a.commentReactionsMenuShown&&a.scrollDist>=g};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("UFIDispatcherBase"))}),null);
__d("UFINewCommentsPillUtils",["UFISharedDispatcher","UFIStoryAction","UFIStoryActionType","UFIUnseenCommentsStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={findNumNewComments:function(a,b){__p&&__p();var c=a?a.length:0,d=b?b.length:0;if(!c&&!d)return 0;var e,f=0;if(a)for(var c=c-1;c>=0;c--){var g=a[c];if(g.__typename==="saved"){e=g.id;break}f++}g=0;c=!1;if(b)for(var a=d-1;a>=0;a--){d=b[a];if(d.id===e){c=!0;break}g++}d=g-f;if(!e||c)return d;else return 0},handleScroll:function(a,b){b=b.target;b instanceof HTMLElement&&this.updateScrolledUp(b,a)},updateScrolledUp:function(a,c){a=a.scrollHeight-a.offsetHeight-a.scrollTop;b("UFISharedDispatcher").dispatch(b("UFIStoryAction").setCommentsScrollDistance(c,a))},scrollToBottom:function(a,b){if(a&&b){var c=a.scrollHeight-a.offsetHeight;b=b.Animation;new b(a).to("scrollTop",c).ease(b.ease.end).duration(Math.min(400,Math.max(200,(c-a.scrollTop)/1.5))).ondone(function(){a.scrollTop=a.scrollHeight-a.offsetHeight}).go()}},dispatchNewCommentAction:function(a,c){a.type===b("UFIStoryActionType").HANDLE_NEW_FACECAST_REPLY&&b("UFISharedDispatcher").dispatch(b("UFIStoryAction").addFacecastReply(c,a.replyCommentID));c=c.instanceid;!b("UFIUnseenCommentsStore").getScrolledUp(c)&&b("UFIUnseenCommentsStore").getCommentReactionsMenuShown(c)?setTimeout(function(){b("UFISharedDispatcher").dispatch(a)},0):b("UFISharedDispatcher").dispatch(a)}};e.exports=a}),null);