if (self.CavalryLogger) { CavalryLogger.start_js(["LdNK9"]); }

__d("FBStoriesProductionTypes",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={CAMERA_ERROR:"CAMERA_ERROR",FILE_SIZE_EXCEED:"FILE_SIZE_EXCEED",LEAVING:"LEAVING"};c=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("immutable").Record({hasImage:void 0,hasMediaStream:void 0,isCameraMediaOpen:void 0,imageSource:void 0,mediaNode:void 0,mediaStream:void 0,privacySettingsCustomParticipants:void 0,privacySettingsMode:void 0,videoSource:void 0}));d={CAMERA_1:"CAMERA_1",CAMERA_2:"CAMERA_2",NULL_STATE:"NULL_STATE",UPLOAD_1:"UPLOAD_1"};f={UNSET:"UNSET",PUBLIC:"PUBLIC",FRIENDS_AND_CONNECTIONS:"FRIENDS_AND_CONNECTIONS",FRIENDS:"FRIENDS",CUSTOM:"CUSTOM"};e.exports={FBStoriesCameraPopupDialogTypes:a,FBStoriesCameraState:c,FBStoriesProductionFlowStageTypes:d,UnifiedStoriesAudienceModeTypes:f}}),null);
__d("FBStoriesPrivacyActionTypes",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({LOADING:"FB_STORIES_PRIVACY.LOADING",LOADED:"FB_STORIES_PRIVACY.LOADED",LOADED_ERROR:"FB_STORIES_PRIVACY.LOADED_ERROR",SET_IS_SAVING:"FB_STORIES_PRIVACY.SET_IS_SAVING",SET_AUDIENCE_MODE:"FB_STORIES_PRIVACY.SET_AUDIENCE_MODE",SET_LOADING_PROMISE:"FB_STORIES_PRIVACY.SET_LOADING_PROMISE",SET_SUBSCRIPTION_TOKEN:"FB_STORIES_PRIVACY.SET_SUBSCRIPTION_TOKEN",SUBSCRIPTION_UPDATE:"FB_STORIES_PRIVACY.SUBSCRIPTION_UPDATE"});e.exports=a}),null);
__d("FBStoriesPrivacyDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){b=a.call(this,b)||this;babelHelpers.assertThisInitialized(b).dispatch=b.dispatch.bind(babelHelpers.assertThisInitialized(b));return b}return b}(b("ExplicitRegistrationReactDispatcher"));e.exports=new a({strict:!0})}),null);
__d("FBStoriesPrivacyHelper",["fbt"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a={getSelectedAudienceMode:function(a){return(a=a)!=null?(a=a.unified_stories_setting)!=null?a.audience_mode:a:a},getEligibleAudienceModesList:function(a){return((a=a)!=null?(a=a.stories_data)!=null?a.audience_mode_list:a:a)||[]},getCustomParticipants:function(a){return((a=a)!=null?(a=a.unified_stories_setting)!=null?(a=a.custom_participants)!=null?a.nodes:a:a:a)||[]},getBlockedParticipants:function(a){return((a=a)!=null?(a=a.unified_stories_setting)!=null?(a=a.blocked_participants)!=null?a.nodes:a:a:a)||[]},getCustomMenuText:function(a){var b=a.length;a=a.map(function(a){return(a=a)!=null?(a=a.actor)!=null?a.name:a:a});switch(b){case 0:return g._("No one can see your story");case 1:return g._("{name_of_friend_connection} can see your story",[g._param("name_of_friend_connection",a[0])]);case 2:return g._("{name_of_first_friend_connection} and {name_of_second_friend_connection} can see your story",[g._param("name_of_first_friend_connection",a[0]),g._param("name_of_second_friend_connection",a[1])]);case 3:return g._("{names_of_first_two_friends_connections} and {name_of_third_friend_connection} can see your story",[g._param("names_of_first_two_friends_connections",a.slice(0,2).join(", ")),g._param("name_of_third_friend_connection",a[2])]);default:return g._({"*":"{names_of_first_three_friends_connections} and {number} others can see your story","_1":"{names_of_first_three_friends_connections} and 1 other can see your story"},[g._param("names_of_first_three_friends_connections",a.slice(0,3).join(", ")),g._plural(b-3,"number")])}}};e.exports=a}),null);
__d("fbStoriesPrivacySelectors",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={getLoadingPromise:function(a){return a.loadingPromise},getHasLoadingError:function(a){return a.data.hasError()},_getLoadedObject:function(a){a=a.data;return a.hasValue()?a.getValueEnforcing():{blockedParticipants:[],customParticipants:[],eligibleAudienceModesList:[],selectedAudienceMode:null}},getIsSaving:function(a){return a.isSaving},getSubscriptionToken:function(a){return a.subscriptionToken},getBlockedParticipants:function(a){return this._getLoadedObject(a).blockedParticipants},getCustomParticipants:function(a){return this._getLoadedObject(a).customParticipants},getEligibleAudienceModesList:function(a){return this._getLoadedObject(a).eligibleAudienceModesList},getSelectedAudienceMode:function(a){return this._getLoadedObject(a).selectedAudienceMode}};e.exports=a}),null);
__d("fbStoriesPrivacyReducer",["FBStoriesPrivacyActionTypes","FBStoriesPrivacyHelper","LoadObject","fbStoriesPrivacySelectors"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){__p&&__p();switch(c.type){case b("FBStoriesPrivacyActionTypes").LOADING:return babelHelpers["extends"]({},a,{data:b("LoadObject").loading()});case b("FBStoriesPrivacyActionTypes").LOADED:var d;d=(d=c.data)!=null?d.viewer:d;var e=b("FBStoriesPrivacyHelper").getBlockedParticipants(d),f=b("FBStoriesPrivacyHelper").getCustomParticipants(d),g=b("FBStoriesPrivacyHelper").getEligibleAudienceModesList(d);d=b("FBStoriesPrivacyHelper").getSelectedAudienceMode(d);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({blockedParticipants:e,customParticipants:f,eligibleAudienceModesList:g,selectedAudienceMode:d})});case b("FBStoriesPrivacyActionTypes").LOADED_ERROR:return babelHelpers["extends"]({},a,{data:b("LoadObject").withError(new Error(c.error.message))});case b("FBStoriesPrivacyActionTypes").SET_IS_SAVING:return babelHelpers["extends"]({},a,{isSaving:c.value});case b("FBStoriesPrivacyActionTypes").SET_AUDIENCE_MODE:return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({blockedParticipants:b("fbStoriesPrivacySelectors").getBlockedParticipants(a),customParticipants:b("fbStoriesPrivacySelectors").getCustomParticipants(a),eligibleAudienceModesList:b("fbStoriesPrivacySelectors").getEligibleAudienceModesList(a),selectedAudienceMode:c.value})});case b("FBStoriesPrivacyActionTypes").SET_LOADING_PROMISE:return babelHelpers["extends"]({},a,{loadingPromise:c.value});case b("FBStoriesPrivacyActionTypes").SET_SUBSCRIPTION_TOKEN:return babelHelpers["extends"]({},a,{subscriptionToken:c.value});case b("FBStoriesPrivacyActionTypes").SUBSCRIPTION_UPDATE:f=(e=c.data)!=null?(e=e.unified_stories_privacy_change_subscribe)!=null?e.viewer:e:e;g=b("FBStoriesPrivacyHelper").getBlockedParticipants(f);d=b("FBStoriesPrivacyHelper").getCustomParticipants(f);c=b("FBStoriesPrivacyHelper").getEligibleAudienceModesList(f);e=b("FBStoriesPrivacyHelper").getSelectedAudienceMode(f);return babelHelpers["extends"]({},a,{data:b("LoadObject").withValue({blockedParticipants:g,customParticipants:d,eligibleAudienceModesList:c,selectedAudienceMode:e})});default:return a}}e.exports=a}),null);
__d("FBStoriesPrivacyStore",["FBStoriesPrivacyDispatcher","FluxReduceStore","LoadObject","fbStoriesPrivacyReducer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.getInitialState=function(){return{data:b("LoadObject").empty(),loadingPromise:null,isSaving:!1,subscriptionToken:null}};d.reduce=function(a,c){return b("fbStoriesPrivacyReducer")(a,c)};return c}(b("FluxReduceStore"));a.__moduleID=e.id;e.exports=new a(b("FBStoriesPrivacyDispatcher"))}),null);
__d("FBStoriesPrivacyActions",["CurrentUser","FBLogger","FBStoriesGraphQLAPI","FBStoriesPrivacyActionTypes","FBStoriesPrivacyDispatcher","FBStoriesPrivacyHelper","FBStoriesPrivacyStore","FBStoriesProductionTypes","Run","fbStoriesPrivacySelectors","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBStoriesPrivacyDispatcher").dispatch;a=b("FBStoriesProductionTypes").UnifiedStoriesAudienceModeTypes;var h={_previousSelectedAudienceMode:a.CUSTOM,loadData:function(){__p&&__p();var a=this,c=b("fbStoriesPrivacySelectors").getLoadingPromise(b("FBStoriesPrivacyStore").getState());if(c)return c;g({type:b("FBStoriesPrivacyActionTypes").LOADING});c=b("FBStoriesGraphQLAPI").loadPrivacySettings();b("promiseDone")(c,function(c){var d;d=(d=c)!=null?d.viewer:d;a._previousSelectedAudienceMode=b("FBStoriesPrivacyHelper").getSelectedAudienceMode(d);g({type:b("FBStoriesPrivacyActionTypes").LOADED,data:c})},function(a){a=a.errors;var c={};a&&a.length>0&&(c=a[0]);g({type:b("FBStoriesPrivacyActionTypes").SET_LOADING_PROMISE,value:null});g({type:b("FBStoriesPrivacyActionTypes").LOADED_ERROR,error:c})});g({type:b("FBStoriesPrivacyActionTypes").SET_LOADING_PROMISE,value:c});var d=b("FBStoriesPrivacyStore").getState();d=b("fbStoriesPrivacySelectors").getSubscriptionToken(d);d||(d=b("FBStoriesGraphQLAPI").subscribeToPrivacyChanges(function(a){g({type:b("FBStoriesPrivacyActionTypes").SUBSCRIPTION_UPDATE,data:a})}),g({type:b("FBStoriesPrivacyActionTypes").SET_SUBSCRIPTION_TOKEN,value:d}));b("Run").onBeforeUnload(this.cleanup);return c},setIsSaving:function(a){g({type:b("FBStoriesPrivacyActionTypes").SET_IS_SAVING,value:a})},revertAudienceMode:function(){if(!this._previousSelectedAudienceMode)return;h.setAudienceMode(this._previousSelectedAudienceMode)},changeAudienceMode:function(a,c){__p&&__p();var d=this,e=b("FBStoriesPrivacyStore").getState();e=b("fbStoriesPrivacySelectors").getSelectedAudienceMode(e);if(!e){this._audienceChangeFailed(c);return}e=b("FBStoriesGraphQLAPI").changeAudienceMode(b("CurrentUser").getID(),e);b("promiseDone")(e.then(function(){d._audienceChangeSucceeded(a)},function(){d._audienceChangeFailed(c)}));h.setIsSaving(!0)},_audienceChangeSucceeded:function(a){h.setIsSaving(!1),a&&a()},_audienceChangeFailed:function(a){h.revertAudienceMode(),h.setIsSaving(!1),a&&a()},setAudienceMode:function(a){var c=b("FBStoriesPrivacyStore").getState();c=b("fbStoriesPrivacySelectors").getSelectedAudienceMode(c);this._previousSelectedAudienceMode=c;g({type:b("FBStoriesPrivacyActionTypes").SET_AUDIENCE_MODE,value:a})},cleanup:function(){var a=b("FBStoriesPrivacyStore").getState();a=b("fbStoriesPrivacySelectors").getSubscriptionToken(a);a&&a.unsubscribe();g({type:b("FBStoriesPrivacyActionTypes").SET_LOADING_PROMISE,value:null});g({type:b("FBStoriesPrivacyActionTypes").SET_SUBSCRIPTION_TOKEN,value:null})}};e.exports=h}),null);
__d("FBStoriesPrivacySelectorInit",["regeneratorRuntime","FBStoriesPrivacyActions"],(function(a,b,c,d,e,f){"use strict";e.exports={loadData:function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",b("FBStoriesPrivacyActions").loadData());case 1:case"end":return a.stop()}},null,this)}}}),null);
__d("FBStoriesPrivacySelectorLoadingPlaceholder.react",["fbt","React","XUIButton.react","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("React").createElement("div",null,b("React").createElement(b("XUIButton.react"),{size:"medium",haschevron:!1,label:g._("Loading..."),image:b("React").createElement(b("XUISpinner.react"),null),onClick:function(a){a.stopPropagation()}}))};e.exports=a}),null);
__d("FBStoriesPrivacySelectorLoadingContainerBootloader.react",["FBStoriesGating","FBStoriesPrivacySelectorLoadingPlaceholder.react","JSResource","React","lazyLoadComponent","uuid"],(function(a,b,c,d,e,f){"use strict";var g=b("lazyLoadComponent")(b("JSResource")("FBStoriesPrivacySelectorLoadingContainer.react").__setRef("FBStoriesPrivacySelectorLoadingContainerBootloader.react")),h=b("lazyLoadComponent")(b("JSResource")("FBStoriesPrivacyRelaySelectorLoadingContainer.react").__setRef("FBStoriesPrivacySelectorLoadingContainerBootloader.react"));a=function(a){var c;c=(c=a.sessionKey)!=null?c:b("uuid")();var d=b("FBStoriesGating").shouldUseRelayPrivacySelector();return b("React").createElement(b("React").Suspense,{fallback:b("React").createElement(b("FBStoriesPrivacySelectorLoadingPlaceholder.react"),null)},d?b("React").createElement(h,babelHelpers["extends"]({},a,{sessionKey:c})):b("React").createElement(g,babelHelpers["extends"]({},a,{sessionKey:c})))};e.exports=a}),null);
__d("FBStoriesPrivacySelector",["regeneratorRuntime","CSS","Event","FBStoriesGating","FBStoriesPrivacyDispatcher","FBStoriesPrivacySelectorInit","FBStoriesPrivacySelectorLoadingContainerBootloader.react","FBStoriesPrivacyStore","React","ReactDOM","Run"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={init:function(){b("FBStoriesPrivacyDispatcher").explicitlyRegisterStores([b("FBStoriesPrivacyStore")]),b("FBStoriesPrivacySelectorInit").loadData()},onClick:function(a){__p&&__p();var c,d,e,f,g,h,i,j,k,l;return b("regeneratorRuntime").async(function(m){__p&&__p();while(1)switch(m.prev=m.next){case 0:e=a.buttonIcon,f=a.buttonSpinner,g=a.container,h=a.privateSharingOn,i=a.menuAlignh,j=a.menuPosition;k=b("FBStoriesGating").shouldUseRelayPrivacySelector();if(k){m.next=6;break}b("FBStoriesPrivacyDispatcher").explicitlyRegisterStores([b("FBStoriesPrivacyStore")]);m.next=6;return b("regeneratorRuntime").awrap(b("FBStoriesPrivacySelectorInit").loadData());case 6:b("ReactDOM").render(b("React").createElement(b("FBStoriesPrivacySelectorLoadingContainerBootloader.react"),{editable:!0,openOnLoad:!0,privateSharingOn:h,menuAlignh:(c=i)!=null?c:void 0,menuPosition:(d=j)!=null?d:void 0}),g),b("CSS").hide(f),b("CSS").show(e),l=b("Event").listen(g,"click",function(a){a.stopPropagation()}),b("Run").onBeforeUnload(function(){l.remove()});case 11:case"end":return m.stop()}},null,this)}};e.exports=a}),null);