if (self.CavalryLogger) { CavalryLogger.start_js(["nqcnC"]); }

/**
 * License: https://www.facebook.com/legal/license/r7OSaMSYkrI/
 */
__d("SlideshowMaker",[],(function(a,b,c,d,e,f){__p&&__p();!function(a,b){"object"==typeof f&&"undefined"!=typeof e?e.exports=b():"function"==typeof define&&define.amd?define(b):a.SlideshowMaker=b()}(this,function(){"use strict";__p&&__p();function a(a){Object.getOwnPropertyNames(g).forEach(function(b){a.setRequestHeader(b,g[b])})}function b(b,c,d,e){var f=new XMLHttpRequest();f.onload=function(){var a="response"in f?f.response:f.responseText;d(JSON.parse(a))},f.onerror=e,f.ontimeout=e,f.open("get",b,!0),g["X-Animoto-Authorization"]="Bearer "+c,a(f),f.send(null)}function c(a){var b=document.createElement("a");return b.href=a,b.origin||(b.origin=b.protocol+"//"+b.hostname),b.origin}function d(a,b){return a.origin===b&&"object"===i(a.data)&&"action"in a.data&&a.data.contentType===o}function f(a,b,c){b.contentType=o,a.postMessage(b,c)}var g={"X-Animoto-Accept":"application/vnd.animoto-v4+json","Content-Type":"application/json"},h=function(){},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},j=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},k=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),l=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},m=3,n=function(){__p&&__p();function a(b){j(this,a),this.url=b.url,this.clientToken=b.clientToken,this.success=b.success||h,this.error=b.error||h,this.retries=0,this.makeRequest()}return k(a,[{key:"makeRequest",value:function(){var a=this,c=function(b){a.checkStatus(b)},d=function(){a.retry()};b(this.url,this.clientToken,c,d)}},{key:"checkStatus",value:function(a){a=a.response.payload.rendering_job;var b=a.state;return"completed"===b?void this.success(a.links.video):"failed"===a.state?void this.retry():void this.poll()}},{key:"poll",value:function(){var b=this,a=function(){b.makeRequest()};setTimeout(a,2e4)}},{key:"retry",value:function(){return this.retries===m?void this.error():(this.retries+=1,void this.poll())}}]),a}(),o="application/x-maker-v1+json",p="https://video440.com",q=p+"/mm/fb/create",r=["src","srcdoc","align"];p=function(){__p&&__p();function a(b){j(this,a);var d={name:"slideshow-maker",id:"slideshow-maker",title:"Slideshow Maker",style:"width:100%;height:100%;border:0",frameborder:"0",allowtransparency:"true",allowfullscreen:"true",scrolling:"no"};d={iframeAttrs:d,onIframeClose:h,onRenderComplete:h,onRenderError:h,onFinalize:h};if(this.options=l(d,b||{}),this.iframeAttrs=this.options.iframeAttrs,!this.options.id)throw new Error("Slideshow Maker was initialized without an ID");this.id=this.options.id,this.contentWindow=window,this.iframeOrigin=c(q),this.addListener(),this.createIframe()}return k(a,[{key:"addListener",value:function(){var a=this,b=function b(c){a.messageHandler(c,b)};this.contentWindow.addEventListener("message",b,!1)}},{key:"removeListener",value:function(a){this.contentWindow.removeEventListener("message",a,!1)}},{key:"createIframe",value:function(){var a=this,b=document.getElementById(this.id);this.iframe=document.createElement("iframe"),Object.keys(this.iframeAttrs).forEach(function(b){r.indexOf(b)===-1&&a.iframe.setAttribute(b,a.iframeAttrs[b])}),this.iframe.src=q,b&&(b.appendChild(this.iframe),this.childWindow=this.iframe.contentWindow,this.iframe.onload=function(){f(a.childWindow,{action:"handshake"},a.iframeOrigin)})}},{key:"renderComplete",value:function(a){this.options.onRenderComplete(a)}},{key:"renderError",value:function(){throw this.options.onRenderError(),new Error("Rendering job failed to completed")}},{key:"pollForRender",value:function(a){var b=this;this.renderJob=new n({url:a,clientToken:this.clientToken,success:function(a){b.renderComplete(a)},error:function(){b.renderError()}})}},{key:"messageHandler",value:function(a,b){__p&&__p();if(d(a,this.iframeOrigin)){a=a.data;var c=a.action;if("handshake"===c)this.clientToken=a.clientToken;else if("render"===c){a=a.renderJob;this.pollForRender(a),this.removeListener(b),this.options.onFinalize()}else"close"===c&&(this.removeListener(b),this.options.onIframeClose())}}}]),a}();e.exports=p;return p})}),null);