!function(w){function extendDeep(e,r){var t,n=Object.prototype.toString;for(t in r=r||{},e)e.hasOwnProperty(t)&&("object"==typeof e[t]?(r[t]="[object Array]"===n.call(e[t])?[]:{},extendDeep(e[t],r[t])):r[t]=e[t]);return r}function getCookie(e){var r=new RegExp("(^| )"+e+"(?:=([^;]*))?(;|$)"),t=document.cookie.match(r);return t&&t[2]?t[2]:""}function getFeatureSign(){var featureMap=[{appname:"sogou",apptest:"!!navigator.userAgent.match(/metaSr/i);"},{appname:"baidu",apptest:"!!navigator.userAgent.match(/bidubrowser/i);"},{appname:"uc",apptest:"!!navigator.userAgent.match(/ubrowser/i);"},{appname:"2345",apptest:"!!navigator.userAgent.match(/2345explorer/i);"},{appname:"maxthon",apptest:"!!navigator.userAgent.match(/maxthon/i);"},{appname:"liebao",apptest:"!!navigator.userAgent.match(/lbbrowser/i);"},{appname:"qq",apptest:"!!navigator.userAgent.match(/qqbrowser/i);"},{appname:"360",apptest:"!!navigator.userAgent.match(/360se/i) || (window.chrome && navigator.mediaDevices == undefined);"},{appname:"chrome",apptest:"!!window.chrome && !!!/opera|opr/i.test(navigator.userAgent);"},{appname:"firefox",apptest:"!!navigator.userAgent.match(/firefox/i);"},{appname:"opera",apptest:"!!/opera|opr/i.test(navigator.userAgent);"},{appname:"safari",apptest:"/constructor/i.test(window.HTMLElement);"},{appname:"ie6",apptest:"document.all && !window.XMLHttpRequest"},{appname:"ie7",apptest:"document.all && window.XMLHttpRequest && !document.querySelector"},{appname:"ie8",apptest:"document.all && document.querySelector && !document.addEventListener"},{appname:"ie9",apptest:"document.all && document.addEventListener && !window.atob;"},{appname:"ie10",apptest:"document.all && window.atob;"},{appname:"ie11",apptest:"'-ms-scroll-limit' in document.documentElement.style && '-ms-ime-align' in document.documentElement.style;"}];for(var key in featureMap){var reslut=eval(featureMap[key].apptest);if(reslut)return featureMap[key].appname}return"other"}function getResolution(){return screen.width+"*"+screen.height}function getPlatform(){return navigator.platform}function getCurrentPageUrl(){return location.href}function ErrorTracker(e){this.config=extendDeep(w.__FE_Monitor_Config||e,{delay:1e4,interval:1e4,logUrl:"//fm.3.cn/log?",max:5}),this.map={},this.errors=[],this.timer=null,this.interval=null,this.currentBorwser=getFeatureSign(),w.__FE_Monitor_Config&&this.init()}ErrorTracker.prototype={init:function(){if("function"==typeof w.onerror)throw new Error("The Error event has been registed.");this.isTargetBrowser()&&(this.bindError(),this.checkError())},bindError:function(){var i=this;w.onerror=function(e,r,t,n,o){i.onError(e,r,t,n,o)}},onError:function(e,r,t,n,o){e&&-1==e.indexOf("Script error")&&!this.map[e]&&this.errors.length<this.config.max&&this.errors.push({message:e,filename:r})},isTargetBrowser:function(){var e=0,r=__FE_Monitor_Config.browsers.length;if(!__FE_Monitor_Config.browsers.length)return!0;for(;e<r;e++)if(this.currentBorwser==__FE_Monitor_Config.browsers[e])return!0;return!1},checkError:function(){var e=this;this.timer=setTimeout(function(){e.errors.length&&e.sendError()},this.config.delay)},serializeParams:function(){var e=[],i=this;function a(e){return encodeURIComponent(e)}function s(){return a(document.referrer)}function u(){var e=getCookie("__jda");return e&&e.split(".").length?e.split(".")[1]:""}function p(){return a(navigator.userAgent)}function c(){return"uuid="+u()+"; pin="+getCookie("pin")}function r(e){var r,t=[];for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];"filename"===n&&(o=-1<(r=e[n]).lastIndexOf("/")?r.substr(r.lastIndexOf("/")):r),t.push(n+"="+a(o))}return t.join("&")+"&uid="+u()+"&sid="+w.__FE_Monitor_Config.sid+"&useragent="+p()+"&cookies="+c()+"&feature="+i.currentBorwser+"&referer="+s()+"&resolution="+getResolution()+"&platform="+getPlatform()+"&uri="+getCurrentPageUrl()+"&level=0"}if(0==!!arguments.length)for(var t=0;t<this.errors.length;t++)e.push(r(this.errors[t]));else e.push("message="+arguments[0].message+"&filename="+arguments[0].filename+"&uid="+u()+"&sid="+w.__FE_Monitor_Config.sid+"&useragent="+p()+"&cookies="+c()+"&feature="+i.currentBorwser+"&referer="+s()+"&resolution="+getResolution()+"&platform="+getPlatform()+"&uri="+getCurrentPageUrl()+"&level="+arguments[1]);return e},sendError:function(){var e,r=this.config.logUrl;e=2==arguments.length?this.serializeParams(arguments[0],arguments[1]):this.serializeParams();for(var t=0;t<e.length;t++){(new Image).src=r+e[t]}},log:function(e){this.isTargetBrowser()&&this.sendError(e,3)},info:function(e){this.isTargetBrowser()&&this.sendError(e,2)},warn:function(e){this.isTargetBrowser()&&this.sendError(e,1)},error:function(e){this.isTargetBrowser()&&this.sendError(e,0)}},w.errortracker=new ErrorTracker}(window);