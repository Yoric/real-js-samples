var Mustache;!function(t){"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define?define(t):Mustache=t}(function(){var m={name:"mustache.js",version:"0.7.0",tags:["{{","}}"]};m.Scanner=C,m.Context=c,m.Writer=t;var d=/\s*/,y=/\s+/,r=/\S/,w=/\s*=/,_=/\s*\}/,k=/#|\^|\/|>|\{|&|=|!/;function b(t){return e=r,n=t,!RegExp.prototype.test.call(e,n);var e,n}var u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function x(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function C(t){this.string=t,this.tail=t,this.pos=0}function c(t,e){this.view=t,this.parent=e,this.clearCache()}function t(){this.clearCache()}function l(t){for(var e,n=t[3],r=n;(e=t[4])&&e.length;)r=(t=e[e.length-1])[3];return[n,r]}function U(t){if(2!==t.length)throw new Error("Invalid tags: "+t.join(" "));return[new RegExp(x(t[0])+"\\s*"),new RegExp("\\s*"+x(t[1]))]}m.escape=function(t){return String(t).replace(/[&<>"'\/]/g,function(t){return e[t]})},C.prototype.eos=function(){return""===this.tail},C.prototype.scan=function(t){var e=this.tail.match(t);return e&&0===e.index?(this.tail=this.tail.substring(e[0].length),this.pos+=e[0].length,e[0]):""},C.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return e},c.make=function(t){return t instanceof c?t:new c(t)},c.prototype.clearCache=function(){this._cache={}},c.prototype.push=function(t){return new c(t,this)},c.prototype.lookup=function(t){var e=this._cache[t];if(!e){if("."===t)e=this.view;else for(var n=this;n;){if(0<t.indexOf(".")){var r=t.split("."),i=0;for(e=n.view;e&&i<r.length;)e=e[r[i++]]}else e=n.view[t];if(null!=e)break;n=n.parent}this._cache[t]=e}return"function"==typeof e&&(e=e.call(this.view)),e},t.prototype.clearCache=function(){this._cache={},this._partialCache={}},t.prototype.compile=function(t,e){var n=this._cache[t];if(!n){var r=m.parse(t,e);n=this._cache[t]=this.compileTokens(r,t)}return n},t.prototype.compilePartial=function(t,e,n){var r=this.compile(e,n);return this._partialCache[t]=r},t.prototype.compileTokens=function(t,r){var a=function i(s){var a={};function u(t,e,n){if(!a[t]){var r=i(e);a[t]=function(t,e){return r(t,e,n)}}return a[t]}return function(t,e,n){for(var r,i,a="",o=0,c=s.length;o<c;++o)switch((r=s[o])[0]){case"#":i=n.slice.apply(n,l(r)),a+=t._section(r[1],e,i,u(o,r[4],n));break;case"^":a+=t._inverted(r[1],e,u(o,r[4],n));break;case">":a+=t._partial(r[1],e);break;case"&":a+=t._name(r[1],e);break;case"name":a+=t._escaped(r[1],e);break;case"text":a+=r[1]}return a}}(t),o=this;return function(t,e){if(e)if("function"==typeof e)o._loadPartial=e;else for(var n in e)o.compilePartial(n,e[n]);return a(o,c.make(t),r)}},t.prototype.render=function(t,e,n){return this.compile(t)(e,n)},t.prototype._section=function(t,e,n,r){var i=e.lookup(t);switch(typeof i){case"object":if(u(i)){for(var a="",o=0,c=i.length;o<c;++o)a+=r(this,e.push(i[o]));return a}return i?r(this,e.push(i)):"";case"function":var s=this;return i.call(e.view,n,function(t){return s.render(t,e)})||"";default:if(i)return r(this,e)}return""},t.prototype._inverted=function(t,e,n){var r=e.lookup(t);return!r||u(r)&&0===r.length?n(this,e):""},t.prototype._partial=function(t,e){t in this._partialCache||!this._loadPartial||this.compilePartial(t,this._loadPartial(t));var n=this._partialCache[t];return n?n(e):""},t.prototype._name=function(t,e){var n=e.lookup(t);return"function"==typeof n&&(n=n.call(e.view)),null==n?"":String(n)},t.prototype._escaped=function(t,e){return m.escape(this._name(t,e))},m.parse=function(t,e){var n,r,i,a,o=U(e=e||m.tags),c=new C(t),s=[],u=[],l=!1,p=!1;function h(){if(l&&!p)for(;u.length;)s.splice(u.pop(),1);else u=[];p=l=!1}for(;!c.eos();){if(n=c.pos,i=c.scanUntil(o[0]))for(var f=0,v=i.length;f<v;++f)b(a=i.charAt(f))?u.push(s.length):p=!0,s.push(["text",a,n,n+1]),n+=1,"\n"===a&&h();if(n=c.pos,!c.scan(o[0]))break;if(l=!0,r=c.scan(k)||"name",c.scan(d),"="===r)i=c.scanUntil(w),c.scan(w),c.scanUntil(o[1]);else if("{"===r){var g=new RegExp("\\s*"+x("}"+e[1]));i=c.scanUntil(g),c.scan(_),c.scanUntil(o[1]),r="&"}else i=c.scanUntil(o[1]);if(!c.scan(o[1]))throw new Error("Unclosed tag at "+c.pos);s.push([r,i,n,c.pos]),"name"!==r&&"{"!==r&&"&"!==r||(p=!0),"="===r&&(o=U(e=i.split(y)))}return function(t){for(var e,n,r=0;r<t.length;++r)e=t[r],n&&"text"===n[0]&&"text"===e[0]?(n[1]+=e[1],n[3]=e[3],t.splice(r--,1)):n=e}(s),function(t){for(var e,n,r=[],i=r,a=[],o=0;o<t.length;++o)switch((e=t[o])[0]){case"#":case"^":e[4]=[],a.push(e),i.push(e),i=e[4];break;case"/":if(0===a.length)throw new Error("Unopened section: "+e[1]);if((n=a.pop())[1]!==e[1])throw new Error("Unclosed section: "+n[1]);i=0<a.length?a[a.length-1][4]:r;break;default:i.push(e)}if(n=a.pop())throw new Error("Unclosed section: "+n[1]);return r}(s)};var i=new t;return m.clearCache=function(){return i.clearCache()},m.compile=function(t,e){return i.compile(t,e)},m.compilePartial=function(t,e,n){return i.compilePartial(t,e,n)},m.compileTokens=function(t,e){return i.compileTokens(t,e)},m.render=function(t,e,n){return i.render(t,e,n)},m.to_html=function(t,e,n,r){var i=m.render(t,e,n);if("function"!=typeof r)return i;r(i)},m}());