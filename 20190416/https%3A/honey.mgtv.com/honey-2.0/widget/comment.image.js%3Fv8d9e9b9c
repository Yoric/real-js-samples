!function(c,r,i,t){var e=function(i,t){this.$elem=i,this.$pic_item=this.$elem.find(".pic_item"),this.$popWin=c("div[node-type=mango-comment-showpic]"),this.$popMask=c("div[node-type=mango-comment-mask]"),this.$picView=this.$popWin.find(".mango-comment-showimg"),this.$pic=this.$picView.find(".pic"),this.$btn_prev=this.$popWin.find(".mango-comment-prev"),this.$btn_next=this.$popWin.find(".mango-comment-next"),this.$btn_close=this.$popWin.find(".mango-comment-pic-closed"),this.groupName=null,this.groupData=[],this.index=0,this.pic_t=0,this.b_stop=!0,this.size_w=0,this.size_h=0,this.defaults={ifChange:!1},this.opts=c.extend({},this.defaults,t)};e.prototype={drawImage:function(i,t,e){var n=new Image;n.src=i.src;var o=.6*c(r).width(),h=c(r).height()-c("ul[node-type=mango-comment-viewer]").height()-90,s=t||n.width,a=e||n.height;n.width=s,n.height=a,0<n.width&&0<n.height&&(n.width/n.height>=o/h?n.width>o?(i.width=o,i.height=n.height*o/n.width):(i.width=n.width,i.height=n.height):n.height>h?(i.height=h,i.width=n.width*h/n.height):(i.width=n.width,i.height=n.height)),this.autoTop(c(r).height(),i.height)},loadingImg:function(){c(".mango-comment-showimg img")[0].onload=function(){c(".mango-comment-showimg .loading").hide()}},changePic:function(){var i=this;this.$pic.attr("src",""),this.$pic.attr("src",this.groupData[this.index].src);var t=c(".pic-viewer-list li:eq("+i.index+")").attr("size");i.size_w=t.split("*")[0],i.size_h=t.split("*")[1],i.drawImage(c(".mango-comment-showimg img")[0],i.size_w,i.size_h),c(".pic-viewer-list li:eq("+i.index+")").addClass("current").siblings().removeClass("current"),c(".mango-comment-showimg .loading").show(),i.loadingImg()},btnSwitch:function(){var t=this;this.$btn_prev.off().on("click",function(i){t.index<=0?t.index=t.groupData.length-1:t.index--,t.changePic(),i.stopPropagation()}),this.$btn_next.off().click(function(i){t.index>=t.groupData.length-1?t.index=0:t.index++,t.changePic(),i.stopPropagation()}),this.$popWin.off().on("click",".pic-viewer-list li",function(i){c(this).addClass("current").siblings().removeClass("current"),t.index=c(this).index(),t.changePic(),i.stopPropagation()})},showPop:function(i){this.$popMask.fadeIn(),this.$popWin.fadeIn(),this.$pic.attr("src",i)},initalPop:function(){var o=this,h=null;this.$pic_item.click(function(){var t=[],i=c(this).attr("data-group");h=c(this).attr("data-source"),c(this).attr("data-id");var e=c(this).attr("size");o.$pic.attr("src","");var n=new Image;n.src=c(".mango-comment-showimg img").attr("src"),e?(o.size_w=e.split("*")[0],o.size_h=e.split("*")[1]):(o.size_w=n.width,o.size_h=n.height),o.groupName!==i&&(o.groupName=i,o.getGroupData()),o.index=c(this).index(),o.showPop(h),o.btnSwitch(),o.opts.ifChange?(o.$btn_prev.show(),o.$btn_next.show()):(o.$btn_prev.hide(),o.$btn_next.hide()),o.$pic_item.each(function(i){t.push('<li size="'+c(this).attr("size")+'"><div class="box"><img src="'+c(this).find("img").attr("src")+'" alt=""></div></li>')}),c(".pic-viewer-list").html(t.join("")),c(".pic-viewer-list li:eq("+c(this).index()+")").addClass("current"),c(r).off("resize",o.autoTop),c(r).on("resize",o.autoTop(c(r).height(),o.size_h)),o.drawImage(c(".mango-comment-showimg img")[0],o.size_w,o.size_h),o.loadingImg()})},autoTop:function(i,t){var e=(i-130-t)/2;e<=0&&(e=25),this.$picView.css({top:e})},getGroupData:function(){var i=this;i.groupData=[],this.groupData.length=0,this.$pic_item.each(function(){i.groupData.push({id:c(this).attr("data-id"),src:c(this).attr("data-source")})})},getIndexOf:function(i){var t=0;return c(this.groupData).each(function(){if(this.id===i)return!1;t++}),t},constructor:e},c("body").on("click","i.mango-comment-pic-closed",function(i){i.preventDefault(),c("div[node-type=mango-comment-mask]").hide(),c("div[node-type=mango-comment-showpic]").hide()}),c("body").on("click","div[node-type=mango-comment-showpic]",function(i){i.preventDefault(),c("div[node-type=mango-comment-mask]").hide(),c("div[node-type=mango-comment-showpic]").hide()}),c.fn.lightbox=function(i){return this.each(function(){return new e(c(this),i).initalPop()})}}(jQuery,window,document);