(function(){var a={email:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,cnPhone:/^(\d{3,4}-)\d{7,8}(-\d{1,6})?$/,mobile:/^1[3458]\d{9}$/,cnMobile:/^1\d{10}$/,date:/^\d{4}\-[01]?\d\-[0-3]?\d$|^[01]\d\/[0-3]\d\/\d{4}$|^\d{4}\u5e74[01]?\d\u6708[0-3]?\d[\u65e5\u53f7]$/,string:/\d$/,integer:/^[1-9][0-9]*$/,number:/^[+-]?[1-9][0-9]*(\.[0-9]+)?([eE][+-][1-9][0-9]*)?$|^[+-]?0?\.[0-9]+([eE][+-][1-9][0-9]*)?$/,numberWithZero:/^[0-9]+$/,money:/^\d+(\.\d{0,2})?$/,alpha:/^[a-zA-Z]+$/,alphaNum:/^[a-zA-Z0-9_]+$/,
betaNum:/^[a-zA-Z0-9-_]+$/,cnID:/^\d{15}$|^\d{17}[0-9a-zA-Z]$/,urls:/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,url:/^(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,chinese:/^[\u2E80-\uFE4F]+$/,postal:/^[0-9]{6}$/,mutiYYYMM:/(20[0-1][0-9]((0[1-9])|(1[0-2]))[\,]?)+$/,bankName:/^[a-zA-Z0-9\u4e00-\u9fa5]+$/,name:/^([\u4e00-\u9fa5|A-Z|\s]|\u3007)+([\.\uff0e\u00b7\u30fb]?|\u3007?)+([\u4e00-\u9fa5|A-Z|\s]|\u3007)+$/,realName:/^([\u4e00-\u9fa5|a-zA-Z|\s]|\u3007)+([\.\uff0e\u00b7\u30fb]?|\u3007?)+([\u4e00-\u9fa5|a-zA-Z|\s]|\u3007)+$/},
b={100:"%s",101:"\u8bf7\u586b\u5199%s\u3002",1011:"\u8bf7\u9009\u62e9%s\u3002",102:"%s\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7%s\u3002",103:"%s\u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e%s\u3002",104:"%s\u6570\u503c\u4e0d\u80fd\u5927\u4e8e%s\u3002",105:"%s\u6570\u503c\u4e0d\u80fd\u5c0f\u4e8e%s\u3002",106:"%s\u4e0d\u80fd\u5927\u4e8e%s\u4e2a\u5b57\u7b26\uff0c1\u4e2a\u6c49\u5b57\u63092\u4e2a\u5b57\u7b26\u8ba1\u7b97","not-number":"%s\u4e0d\u80fd\u5168\u4e3a\u6570\u5b57\u3002",notEqual:"%s",number:"%s\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",
betaNum:"%s\u53ea\u80fd\u5305\u542b\u6570\u5b57\u3001\u5b57\u6bcd\u3001\u4e0b\u5212\u7ebf\u548c\u6a2a\u6760\u3002",email:"%s\u683c\u5f0f\u4e0d\u6b63\u786e\u3002",money:"%s\u5fc5\u987b\u4e3a\u6574\u6570\u6216\u5c0f\u6570\uff0c\u5c0f\u6570\u70b9\u540e\u4e0d\u8d85\u8fc72\u4f4d\u3002",numberWithZero:"%s\u5fc5\u987b\u4e3a\u6570\u5b57\u3002",chinese:"%s\u5fc5\u987b\u4e3a\u6c49\u5b57\u3002",cnMobile:"\u624b\u673a\u53f7\u7801\u683c\u5f0f\u6709\u8bef\uff0c\u5fc5\u987b\u662f11\u4f4d\u6570\u5b57\uff0c\u4e14\u4ee513/14/15/18\u5f00\u5934\u3002",
mobile:"\u624b\u673a\u53f7\u7801\u683c\u5f0f\u6709\u8bef\uff0c\u5fc5\u987b\u662f11\u4f4d\u6570\u5b57\uff0c\u4e14\u4ee513/14/15/18\u5f00\u5934\u3002",bankName:"%s\u53ea\u80fd\u542b\u6c49\u5b57\u3001\u5927\u5199\u5b57\u6bcd\u3001\u5c0f\u5199\u5b57\u6bcd\u548c\u6570\u5b57\u3002",name:"%s\u53ea\u80fd\u542b\u6c49\u5b57\u3001\u5927\u5199\u5b57\u6bcd\u3001\u7b26\u53f7\u4e2d\u7684\u7a7a\u683c\u548c\u70b9\uff0c\u4e14\u81f3\u5c11\u4e24\u4e2a\u5b57\u3002",realName:"%s\u53ea\u80fd\u542b\u6c49\u5b57\u3001\u5b57\u6bcd\u3001\u7b26\u53f7\u4e2d\u7684\u7a7a\u683c\u548c\u70b9\uff0c\u4e14\u81f3\u5c11\u4e24\u4e2a\u5b57\u3002"};
AP.widget.Validator=function(){this.options={formId:"",itemClass:"fm-item",notifyClass:"fm-explain",errorClass:"fm-error",tipsClass:"fm-tips",checkOnBlur:!0,onSubmit:!0,stopSubmit:!1,onSuccess:null,onFail:null,ruleType:"name",userValidate:null,userDefine:null,loadClass:"loading-text",instanceHelp:null,suppressInstanceHelp:!1,checkNull:!1,unitBytes:!1};this.cache={access:!1,tipfield:[]};this.options.rules={};this.items={};this.init.apply(this,arguments)};AP.widget.Validator.prototype={init:function(a){L.augmentObject(this.options,
a,!0);this.setAccess(this.options.onSubmit);AP.cache.tester=this.options.rules;window.tester=function(){for(var a=[],b=0;b<arguments.length;b++){var e=arguments[b];AP.cache.tester.hasOwnProperty(e)&&(delete AP.cache.tester[e],a=a.concat(D.query("*[name="+e+"]")).concat(D.query("*[id="+e+"]")))}log(a.length+" elements found: ");log(a);E.removeListener(a)};this.validate()},setAccess:function(a){if(!0===a){for(var a=0,b=E.getListeners(this.options.formId,"submit");b&&-1<a;)E.removeListener(this.options.formId,
"submit"),a++;E.on(this.options.formId,"submit",this.plugin.stopEvent)}},getExplain:function(a){var b=D.getAncestorByClassName(a,this.options.itemClass);return D.query("."+this.options.notifyClass,b)[0]||Element.create("div",{"class":this.options.notifyClass,appendTo:a.parentNode})},showExplain:function(a,b){var f=this.getParentItem(b),d=this.options.rules[b[this.options.ruleType]];D.removeClass(f,this.options.errorClass);D.removeClass(f,"fm-hover");D.addClass(f,"fm-focus");["input","textarea"].contains(b.tagName.toLowerCase())&&
b.select();try{if(0==this.getExplain(b).innerHTML.trim().length)return;(!b.getAttribute("data-explain")||0==b.getAttribute("data-explain").trim().length)&&D.addClass(this.getExplain(b),"fn-hide");this.getExplain(b).innerHTML=b.getAttribute("data-explain")}catch(h){}d&&d.onFocusEvent&&d.onFocusEvent.call(this,b)},hoverIn:function(a,b){var f=b.parentNode;!D.hasClass(f,"fm-error")&&!D.hasClass(f,"fm-focus")&&D.addClass(f,"fm-hover")},hoverOut:function(a,b){D.removeClass(b.parentNode,"fm-hover")},getError:function(a){var g=
1,f=b[a]||b.email;if(null!=f){for(;"undefined"!==typeof arguments[g];)f=f.replace(/%s/,arguments[g++]);return f}},showError:function(a){var b=D.query("."+this.options.notifyClass,this.parentNode)[0];D.addClass(this.parentNode,this.options.errorClass);D.removeClass(b,"fn-hide");b.innerHTML=a},getLength:function(a){return this.options.unitBytes?a.len():a.length},getParentItem:function(a){for(a=a.parentNode;1==a.nodeType&&a!==document&&!D.hasClass(a,this.options.itemClass);)a=a.parentNode;return a},
renderHelp:function(a,b,f){D.addClass(D.query(".instanceHelp"),"fn-hide");if(0==D.query("."+a).length){var d=Element.create("div",{"class":"instanceHelp "+a});d.innerHTML="<div class='helpHead'></div><div class='helpBody'><em class='m-help'>\u5e2e\u52a9\u4fe1\u606f</em><a class='closeHelp' href='javascript:void(0)'>\u5173\u95ed</a><ul class='helpUl'></ul></div><div class='helpFoot'></div>";document.body.appendChild(d)}else D.removeClass(D.query("."+a),"fn-hide");0==D.query(".helpArrow").length?(d=
Element.create("div",{"class":"helpArrow"}),document.body.appendChild(d)):D.removeClass(D.query(".helpArrow"),"fn-hide");E.on(D.query(".closeHelp"),"click",this.hideHelp);d=D.getRegion(D.query("."+a)[0]);d=[b[0]+24,Math.floor(b[1]-(d.bottom-d.top)/2)];f="<li>"+f.instanceHelp.join('</li><li class="helpaim">');D.query("."+a+" .helpUl")[0].innerHTML=f+"</li>";D.setXY(D.query("."+a),d);D.setXY(D.query(".helpArrow")[0],[b[0]+10,b[1]-15])},showInstanceHelp:function(a){var b=a.element,f=D.getRegion(b);this.renderHelp(b.id,
[f.right,Math.floor((f.top+f.bottom)/2)],a)},hideHelp:function(){D.addClass(D.query(".helpArrow"),"fn-hide");D.addClass(D.query(".instanceHelp"),"fn-hide")},validateProcess:function(b,g){var f=this.options.rules[g[0][this.options.ruleType]];if(f&&(f.desc||f.type||"undefined"!=f.error)){var d=f.element||g[0],h=f.type,j=f.not||!1,k=!1===f.error?f.explain||d.getAttribute("data-explain"):f.error,l=f.desc,n=this.getParentItem(d),o=this.getExplain(d)||null,q=o?o.innerHTML:null,m=!0,r=g[2],t=!0===this.options.errorTrack?
!0:!1,v=f.noTrack&&!0===f.noTrack?!0:!1,w=AP.hashExtend({SEPARATOR:"|",EMPTY:"empty",INVALID:"invalid"},this.options.errorTrackType,!0),s=!1;if(d){f.element||(f.element=d);if(f.beforeValidate&&!1===f.beforeValidate.call(this,this,d,f))return!1;var p=d.value.trim(),u=f.relate;if(!u||D.get(u).checked){f.trimChar&&(d.value=p=p.trimChar());d.getAttribute("data-tips")&&p===d.getAttribute("data-tips")&&(p="");"RADIO"==d.type.toUpperCase()&&(u=D.query("input[type=radio]["+this.options.ruleType+"="+d.name+
"]:checked"),q=f.explainEl||D.query("."+this.options.notifyClass,d.parentNode)[0],0<u.length?(D.removeClass(d.parentNode,"fm-error"),D.removeClass(d.parentNode,"fm-hover"),D.addClass(q,"fn-hide")):(q.innerHTML=k||this.getError(101,l),D.removeClass(q,"fn-hide"),m=!1),E.on(D.query("input[type=radio]["+this.options.ruleType+"="+d[this.options.ruleType]+"]"),"click",function(){D.removeClass(d.parentNode,"fm-error");D.removeClass(d.parentNode,"fm-hover");D.addClass(q,"fn-hide")},this));if(0==p.length&&
"RADIO"!==d.type.toUpperCase())if(r&&f.required)!1==f.error?o.innerHTML=f.explain&&0<f.explain.length?f.explain:o.innerHTML||"":(h="SELECT"===d.tagName.toUpperCase()?1011:101,o.innerHTML=this.getError(h,l)),s=w.EMPTY,m=!1;else return;else if(f.isAmount&&(__v=Math.round(p*Math.pow(10,2))/Math.pow(10,2),d.value=isNaN(__v)?p:__v,p=d.value),f.validate)!1===f.validate.call(this,d,o)&&(m=!1);else{j&&a[j].test(p)&&(o.innerHTML=this.getError("not-"+j,l),m=!1);"undefined"!==typeof f.notEaqual&&f.notEaqual!==
p&&(o.innerHTML=k||this.getError("notEqual",l),m=!1);if(h&&h.constructor==Array)for(j=0;j<h.length;j++)if(a[h[j]].test(p)){m=!0;break}else m=!1;if(h&&!f.numberWithSpace&&a[h]&&!a[h].test(p)&&m)o.innerHTML=k||this.getError(h,l),m=!1;else if(m&&(f.numberWithSpace&&(p=p.trimAll()),f.numberWithSpace&&!a.numberWithZero.test(p)&&(o.innerHTML=k||this.getError("number",l),m=!1),f.words&&p.len()>f.words&&(o.innerHTML=k||this.getError(106,l,f.words),m=!1),f.maxLength&&this.getLength(p)>f.maxLength&&(o.innerHTML=
k||this.getError(102,l,f.maxLength),m=!1),f.minLength&&this.getLength(p)<f.minLength&&(o.innerHTML=k||this.getError(103,l,f.minLength),m=!1),f.maxValue&&""!==f.maxValue&&parseFloat(p)>f.maxValue&&(o.innerHTML=k||this.getError(104,l,f.maxValue),m=!1),f.minValue&&""!==f.minValue&&parseFloat(p)<f.minValue&&(o.innerHTML=k||this.getError(105,l,f.minValue),m=!1),f.mask&&!f.mask.test(p)))o.innerHTML=k,m=!1}this.hideHelp();f.afterValidate&&!1===f.afterValidate.call(this,this,d,m)&&(t=m=!1);f.except&&p===
f.except&&(m=!0);D.removeClass(n,"fm-focus");if(!m){s=s||w.INVALID;if(t&&!0!==v)try{this.plugin.tracker(d[this.options.ruleType]+w.SEPARATOR+s)}catch(x){}D.addClass(n,this.options.errorClass);D.removeClass(o,"fn-hide");this.cache.access=!1;f.instanceHelp&&!f.suppressInstanceHelp&&this.showInstanceHelp(f)}m&&this.options.instanceHelp&&this.hideHelp()}}}},onSubmitProcess:function(){this.cache.access=!0;if(this.options.onBefore&&!this.options.onBefore())return!1;this.options.userValidate&&!this.options.userValidate.apply(this)&&
(this.cache.access=!1);for(i in this.options.rules){var a="name"===this.options.ruleType?D.query("*[name="+i+"]")[0]:D.get(i);if(!1===this.options.rules[i].depends||a&&0!=a.offsetHeight){var b=this.options.rules[i].relate||null;(!b||D.get(b).checked)&&this.validateProcess.apply(this,["",[a,null,!0]])}}this.clearFocus.call(this);if(this.cache.access){if(this.options.onSuccess)this.options.onSuccess();a=D.query(".m-error",D.get(this.options.formId));0<a.length&&D.addClass(a[0],"fn-hide");this.cache.tipfield.forEach(function(a){if(a.value===
a.getAttribute("data-tips"))a.value=""});!(this.options.userDefine&&!1==this.options.userDefine(this))&&!this.options.stopSubmit&&(this.options.loadClass&&(a=D.query("."+this.options.loadClass,D.get("this.options.formId")),0<a.length&&D.removeClass(a[0],"fn-hide")),D.get(this.options.formId).submit())}else this.options.onFail&&this.options.onFail.call(this)},others:function(){},clearFocus:function(){D.removeClass(D.query(".fm-item",D.get(this.options.formId)),"fm-focus")},plugin:{maxLen:function(a,
b){b[0].value.length>=_rule.maxLength&&(b[0].value=b[0].value.substring(0,_rule.maxLength))},stopEvent:function(a){E.preventDefault(a)},tracker:function(a){Tracker.click(a)}},validate:function(){for(i in this.options.rules){var a="name"===this.options.ruleType?D.query("*[name="+i+"]")[0]:D.get(i),b=this.options.rules[i];if(!(null==a||"undefined"==a)){null===a.getAttribute("data-explain")&&a.setAttribute("data-explain",this.getExplain(a).innerHTML.replace(/(\"|\')/g,"$1"));b.tips&&(this.cache.tipfield.push(a),
0===a.value.trimAll().length?(D.addClass(a,"fn-tips"),a.value=b.tips):a.value.trimAll()!==b.tips&&D.removeClass(a,"fn-tips"),a.setAttribute("data-tips",b.tips),E.on(a,"focus",function(){D.removeClass(this,"fn-tips");if(this.value===this.getAttribute("data-tips"))this.value=""},"",a),E.on(a,"blur",function(){if(this.value.trimAll().length===0){this.value=this.getAttribute("data-tips");D.addClass(this,"fn-tips")}},"",a));E.addListener(a,"focus",this.showExplain,a,this);E.addListener(a,"mouseover",this.hoverIn,
a,this);E.addListener(a,"mouseout",this.hoverOut,a,this);if(b.hasOwnProperty("checkOnBlur")&&"boolean"===typeof b.checkOnBlur?b.checkOnBlur:this.options.checkOnBlur)E.addBlurListener(a,this.validateProcess,[a,null,"undefined"===typeof b.checkNull?this.options.checkNull:b.checkNull],this);E.addBlurListener(a,function(a,b){var e=b.getParentItem(this);e&&e.nodeType===1&&D.removeClass(e,"fm-focus")},this);"TEXTAREA"==a.tagName.toUpperCase()&&b.isLimit&&(E.on(a,"keydown",this.plugin.maxLen,[a,b],this),
E.on(a,"keyup",function(a,e){try{if(e.value.length>=b.maxLength)e.value=e.value.substring(0,this.options.rules[i].maxLength)}catch(h){}},a,this))}}E.on(this.options.formId,"submit",this.onSubmitProcess,this,this)}}})();
(function(){function a(){try{setTimeout(function(){D.setStyles(D.query("div.cal-calendar"),{display:"none"})},0)}catch(a){}AP.cache.xbox.timer&&clearInterval(AP.cache.xbox.timer);if(AP.cache.xbox.DOMParent){var b=D.get("xbox-mock").firstChild;D.hasClass(b,"xbox-caption")&&(b=b.nextSibling);AP.cache.xbox.DOMParent.appendChild(b)}try{if(AP.env.browser.msie&&8>AP.env.browser.v||!0===AP.env.browser.mozilla){var f=D.query(".alieditContainer");0<f.length&&AP.cache.hidePWDEdit&&f.forEach(function(a){a.style.visibility=
"visible";a.style.opacity="1";a.style.filter="alpha(opacity = 100)";AP.cache.hidePWDEdit=!0})}}catch(d){}try{E.removeListener(document,"keyup"),E.removeListener("xbox-mock"),E.removeListener("xbox-overlay")}catch(h){}b=D.get("xbox-mock");f=D.get("xbox-overlay");b&&document.body.removeChild(b);f&&document.body.removeChild(f);try{if(AP.cache.xbox.onHideEvent){AP.cache.xbox.onHideEvent.call();var j=AP.cache.xbox.onHideEvent}}catch(k){}AP.cache.xbox={};AP.cache.xbox.onHideEvent=j}AP.cache.xbox={};var b=
new AP.Class({options:{},cfg:{MOCK:"xbox-mock",MOCK_CLASS:"xbox-mock",LOAD:"xbox-load",IFRAME:"xbox-iframe",IFRAME_FIX:"xbox-hide-select",OVERLAY:"xbox-overlay",OVERLAY_BG:"xbox-overlay-bg"},setOptions:function(a){return AP.hashExtend({el:"",type:"string",value:"",modal:!0,width:600,height:"",maxWidth:800,maxHeight:500,minHeight:null,autoFit:!0,autoShow:!1,border:!0,onShowEvent:!1,onHideEvent:!1,noScroll:!1,fixed:!1,load:!1,cross_domain:!1,loadsrc:"https://i.alipayobjects.com/e/201309/1BaxfIFEuF.gif"},
a,!0)},initialize:function(a){this.options=this.setOptions(a);this._preLoadImg();this._bindEvent();E.on(document,"keyup",function(a){if(27==E.getCharCode(a||window.event)){AP.widget.xBox.hide();try{parent.AP.widget.xBox.hide()}catch(b){}}});this.options.onHideEvent&&(AP.cache.xbox.onHideEvent=this.options.onHideEvent)},_preLoadImg:function(){(new Image).src=this.options.loadsrc},_bindEvent:function(){if(!1!==this.options.el&&""!==this.options.el)E.on(this.options.el,"click",function(a,b){b.fire.call(b,
this,b);E.preventDefault(a)},this);E.on(D.query(".xbox-close-link"),"click",function(a){AP.widget.xBox.hide();E.preventDefault(a)})},_makeValue:function(){var a=this.options.value,b=this.options.type;return"function"==typeof a?a.call(this,AP.cache.xbox.fireObject):"iframe"===b?a:/^[a-zA-Z]([^#.\s]*)[a-zA-Z0-9]$/.test(a)?D.get(a):/^[a-zA-Z#\.]*(\s?)(.*)[a-zA-Z0-9]$/.test(a)?D.query(a)[0]:a.toString()},_fixUrl:function(a){return a+(0>a.indexOf("?")?"?_xbox=true":"&_xbox=true")},_getType:function(a){var b;
return("object"==(b=typeof a)?null==a&&"null"||Object.prototype.toString.call(a).slice(8,-1):b).toLowerCase()},_getOptWidth:function(){var a;try{a=parent&&parent.D.get("xbox-iframe")&&0<parent.D.get("xbox-iframe").getAttribute("auto-width")?parent.D.get("xbox-iframe").getAttribute("auto-width"):parseInt(this.options.width,10)}catch(b){a=parseInt(this.options.width,10)}return this.options.width=a},_getOptHeight:function(){return parseInt(this.options.height,10)},_getType:function(a){var b;return("object"==
(b=typeof a)?null==a&&"null"||Object.prototype.toString.call(a).slice(8,-1):b).toLowerCase()},_getNiceTop:function(a){var b=D.get(this.cfg.MOCK),b="dom"==this.options.type.toLowerCase()?b.firstChild:b,f=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop,d=D.getViewportHeight();_mH=a?parseInt(this._getIFRHeight()||D.getStyle(this.cfg.MOCK,"height"),10):this._getWH(b)[1];a=Math.max(50,d>_mH?0.382*d-_mH/2:50)+f;a=Math.max(50,a);return parseInt(a,10)},_getNiceLeft:function(){var a=
this._getWH(D.get(this.cfg.MOCK))[0],a=(D.getViewportWidth()-5-a)/2;return parseInt(a,10)},_getWH:function(a){a="string"==typeof a?document.getElementById(a):a;if(0===a.offsetWidth||0===a.offsetHeight){var b=a.style.display||"",f=a.style.visibility||"",d;a.style.visibility="hidden";a.style.display="block";d=document.createElement("div");d.style.visibility="hidden";d.appendChild(a.cloneNode(!0));document.body.appendChild(d);a=d.firstChild;try{a.style.visibility=f,a.style.display=b,document.body.removeChild(d)}catch(h){}}return[a.offsetWidth,
a.offsetHeight]},_contentOnLoad:function(a){a.hideLoad.call(a);var b=D.get(this.cfg.MOCK),b="dom"===this.options.type.toLowerCase()?b:b.firstChild,b=a._getWH(b);D.setStyles(a.cfg.MOCK,{width:(a._getOptWidth()||b[0])+"px"});D.setStyles(a.cfg.MOCK,{top:a._getNiceTop(!1)+"px",left:a._getNiceLeft()+"px",visibility:"visible"})},_iframeOnLoad:function(){this.hideLoad();this._fitIFR();D.setStyle(this._mock,"top",this._getNiceTop(!0)+"px");D.setStyle(this.cfg.IFRAME,"height",this._getIFRHeight()+"px");this.options.autoFit&&
this._autoFit();D.setStyle(this._iframe,"visibility","visible");D.setStyle(this._mock,"visibility","visible");AP.env.browser.mozilla&&"1.9.0.15"===AP.env.browser.v&&(1>document.location.host.indexOf("cashier")&&(this.cfg.autoFit=!1),D.get(this.cfg.IFRAME).style.height=parseInt(D.get(this.cfg.MOCK).style.height,10)+1+"px");try{E.on(D.query(".xbox-close-link",D.get(this.cfg.IFRAME).contentWindow.document),"click",function(a){AP.widget.xBox.hide();E.preventDefault(a)})}catch(a){}},_fitIFR:function(){try{D.get(this.cfg.MOCK),
D.setStyles(this.cfg.MOCK,{width:this._getOptWidth()+"px",height:this._getIFRHeight()+"px",left:(D.getViewportWidth()-this.options.width)/2+"px"}),D.setStyle(this.cfg.IFRAME,"width",this._getOptWidth()+"px"),D.setStyle(this.cfg.IFRAME,"height",this._getIFRHeight()+"px"),D.getStyle(this.cfg.MOCK,"height")+D.getStyle(this.cfg.MOCK,"top")>D.getViewportHeight()&&D.setStyle(this.cfg.MOCK,"top",this._getNiceTop(!0)+"px")}catch(a){}},_autoFit:function(){try{var a=this;AP.cache.xbox.timer&&clearInterval(AP.cache.xbox.timer);
AP.cache.xbox.timer=setInterval(function(){a._fitIFR()},75)}catch(b){}},_getIFRHeight:function(){if(this.options.cross_domain&&this.options.height)return this.options.height;var a=D.get(this.cfg.IFRAME);try{var b=a.contentWindow.document.body.scrollHeight,f=a.contentWindow.document.documentElement.scrollHeight,d=window.userAgent,h=-1<d.indexOf("safari")||-1<d.indexOf("chrome")?Math.min(b,f):Math.max(b,f);100<f-b&&(h=b);0<parseInt(this.options.minHeight,10)&&this.options.minHeight>h&&(h=this.options.minHeight);
return h}catch(j){}},_makeContent:function(){switch(this.options.type.toLowerCase()){case "iframe":this.options.load=!0;this._iframe=Element.create("iframe",{id:this.cfg.IFRAME,name:this.cfg.IFRAME+(new Date).getTime(),frameBorder:"no",scrolling:"no",src:this._fixUrl(this._makeValue()),style:{visibility:"hidden",width:this._getOptWidth()+"px"}});E.on(this._iframe,"load",this._iframeOnLoad,this,!0);this._mock.appendChild(this._iframe);break;case "dom":var a=this._makeValue();AP.cache.xbox.DOMParent=
a.parentNode;this._mock.appendChild(a);E.onContentReady(this.cfg.MOCK,this._contentOnLoad,this,!0);break;case "string":this._mock.innerHTML+=this._makeValue(),E.onContentReady(this.cfg.MOCK,this._contentOnLoad,this,!0)}},renderMock:function(){D.get(this.cfg.MOCK)||(this._mock=Element.create("div",{id:this.cfg.MOCK,"class":this.cfg.MOCK_CLASS,style:{visibility:"hidden",display:""},appendTo:document.body}),this.options.border||(this._mock.style.border="none"),this.options.title&&""!==this.options.title&&
Element.create("div",{"class":"xbox-caption",innerHTML:this.options.title,appendTo:this._mock}),this._makeContent())},showMock:function(){D.setStyle(this._mock,"visibility","visible")},renderOverlay:function(){var a=document.body.scrollWidth>document.body.offsetWidth?document.body.scrollWidth:document.body.offsetWidth+50+"px",b=D.getDocumentHeight();D.get(this.cfg.OVERLAY)||(this._overlay=Element.create("div",{id:this.cfg.OVERLAY,"class":this.cfg.OVERLAY_BG,style:{height:b+"px",visibility:"hidden",
opacity:"0",filter:"alpha(opacity=0)","-moz-opacity":"0"},appendTo:document.body}));AP.fn.browser.msie6&&(this.options.noScroll||(a="100%"),D.setStyle(this.cfg.OVERLAY,"height",b),D.setStyle(this.cfg.OVERLAY,"width",a));D.get(this.cfg.IFRAME_FIX)||(this._overlay.innerHTML='<iframe id="'+this.cfg.IFRAME_FIX+'" style="width: '+a+"px; height:"+b+'px" src="javascript:\'\'"></iframe>');if(AP.env.browser.msie&&8>AP.env.browser.v||!0===AP.env.browser.mozilla)a=D.query(".alieditContainer"),0<a.length&&a.forEach(function(a){a.style.visibility=
"hidden";a.style.opacity="0";a.style.filter="alpha(opacity = 0)";AP.cache.hidePWDEdit=true});AP.env.browser.mozilla&&"1.9.1.9"===AP.env.browser.v&&(D.get(this.cfg.IFRAME_FIX).style.display="none")},showOverlay:function(){var a=this;D.setStyle(this.cfg.OVERLAY,"visibility","visible");var b=new U.Anim(this.cfg.OVERLAY,{opacity:{from:0,to:0.2}},0.3);AP.env.browser.msie&&9<=AP.env.browser.v&&b.onComplete.subscribe(function(){D.get(a.cfg.OVERLAY).style.opacity=0.2});"iframe"===this.options.type.toLowerCase()&&
b.onStart.subscribe(function(){a.showLoad()});b.animate()},hideOverlay:function(){E.removeListener(this.cfg.OVERLAY);var a=new U.Anim(this.cfg.OVERLAY,{opacity:{to:0}},0.2);a.onComplete.subscribe(function(){Element.remove(this.cfg.OVERLAY)});a.animate()},showLoad:function(){if(!D.get(this.cfg.LOAD)){var a=0.382*D.getViewportHeight();AP.fn.browser.msie6&&(a+=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop);Element.create("div",{id:this.cfg.LOAD,innerHTML:"<img src='"+
this.options.loadsrc+"' />",style:{top:a+"px",display:"block"},appendTo:document.body})}},hideLoad:function(){D.get(this.cfg.LOAD)&&Element.remove(this.cfg.LOAD)},show:function(){this.renderOverlay();this.renderMock();this.showOverlay.call(this);this.options.onShow&&this.options.onShow.call(this);this.options.onShowEvent&&this.options.onShowEvent.call(this);var a=D.query("#xbox-mock .alieditContainer");0<a.length&&a.forEach(function(a){a.style.visibility="visible";a.style.opacity="1";a.style.filter=
"alpha(opacity = 1)"})},hide:a,fire:function(a,b){var f=b||this;AP.cache.xbox.fireObject=a;f.show.call(f,a,f);a&&E.preventDefault(a)}});AP.widget.xBox=b;AP.widget.xBox.hide=a})();
AP.widget.xTab={show:function(a){"string"==typeof a&&(a=D.get(a));a.style.display=a.$oldDisplay||"block"},hide:function(a){"string"==typeof a&&(a=D.get(a));var b=D.getStyle(a,"display");"none"!=b&&(a.$oldDisplay=b);a.style.display="none"},switchTab:function(a,b,e){"string"==typeof a&&(a=D.get(a));var g=a.getElementsByTagName("a"),f=-1<document.location.hash.indexOf("#")&&""!==document.location.hash.split("#")[1]?!0:!1,e="onmouseover"==e?"onmouseover":"onclick",d=document.location.hash.split("#")[1]||
"",h=g[b];if(f)try{var j=D.query("a[href=#"+d+"]",a);0<j.length&&(h=j[0],log(h))}catch(k){log(k)}D.addClass(h.parentNode,"current");for(j=0;j<g.length;j++){var l=D.get(g[j].hash.replace("#","")),n=g[j].hash.replace("#","");f&&0<D.query("a[href=#"+d+"]",a).length?n!==d&&AP.widget.xTab.hide(l):j!=b&&AP.widget.xTab.hide(l);g[j][e]=g[j].onfucs=function(){if(this!=h)return D.addClass(this.parentNode,"current"),AP.widget.xTab.show(D.get(this.hash.replace("#",""))),D.removeClass(h.parentNode,"current"),
AP.widget.xTab.hide(D.get(h.hash.replace("#",""))),h=this,!1}}}};Object.extend=function(a,b){for(property in b)a[property]=b[property];return a};String.prototype.isFloat=function(){return/^[\d]+\.[\d]+$/.test(this.toString())};String.prototype.isInt=function(){return/^[\d]+$/.test(this.toString())};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};Number.prototype.isFloat=function(){return/^[\d]+\.[\d]+$/.test(this.toString())};Number.prototype.isInt=function(){return/^[\d]+$/.test(this.toString())};
AP.widget.PopBase=function(){var a=YAHOO.util.Dom,b={};return{init:function(a){b=Object.extend({box_id:"PopPayment",box_class:"pop"},a||{});this.container=null;this.makePopup()},makePopup:function(){this.container||(this.container=Element.create("div",{id:b.box_id,"class":"pop pop-square pop-square-cue"}),this.container.innerHTML='<div class="pop-container" id="PopContainerBody"></div><div class="pop-shadow" style="height:28px"></div><div class="pop-angle"></div>',a.addClass(this.container,b.box_class),
a.setStyles(this.container,{width:"185px"}),this.hidden(),document.body.appendChild(this.container))},resetWidth:function(b){a.setStyles(this.container,{width:b})},setPosition:function(b){a.setXY(this.container,b)},show:function(){this.container&&a.setStyles(this.container,{display:"block"})},hidden:function(){this.container&&a.setStyles(this.container,{display:"none"})},buildUI:function(a){this.container.appendChild(a)}}}();
AP.widget.AAPayment=function(){var a=YAHOO.util.Dom,b=YAHOO.util.Event,e=AP.widget.PopBase,g=[],f,d,h,j,k,l,n=!0;_getPreviousValue=function(a){var a=g.indexOf(a),b=0<=a-1?g[a-1]:null;return null!=b&&!D.hasClass(b.parentNode.parentNode,"fm-error")?g[a-1].value:""};var o=function(){b.addListener(document.body,"click",function(){n||e.hidden()})};return{init:function(a){_options=Object.extend({box_container:"container",box_total_money:"totalMoney",box_total_person:"totalPerson",box_add_person:"addPerson"},
a||{});o();k=D.get(_options.box_container);h=D.get(_options.box_total_person);d=D.get(_options.box_total_money);_submit_form=D.get("AAPaymentForm");b.addListener(d,"focus",function(){e.hidden();this.countTotalMoney();d.select();var a=d.parentNode.parentNode;D.addClass(d.parentNode,"fm-focus");D.removeClass(a,"fm-error");D.setStyles(j,{display:"none"});D.query(".fm-explain",a).length&&a.removeChild(D.query(".fm-explain",a)[0])},"",this);b.addListener(d,"keydown",this.killEnter,d,this);b.addListener(d,
"keyup",this.checkTotalMoney,d,this);b.addListener(d,"blur",function(){D.removeClass(d.parentNode,"fm-focus")})},validate:function(){if(g.length)g.forEach(function(a){a.value.length||this.showError("\u91d1\u989d\u6216\u516c\u5f0f\u4e0d\u80fd\u4e3a\u7a7a\u3002\u5982\uff1a20\u6216100/5\u3002",a)},this);else if(!D.get("cannotEmpty")){var a=Element.create("li",{appendTo:D.get("payers"),id:"cannotEmpty"}),b=Element.create("span",{appendTo:a});D.setStyles(D.get("payers"),{height:"auto"});b.innerHTML="\u5fc5\u987b\u6dfb\u52a0\u4e00\u4e2a\u8054\u7cfb\u4eba\u8d26\u53f7\u3002";
D.addClass(a,"fm-error");D.addClass(b,"fm-explain")}},generateData:function(){partern=/(.*)\[.*\](.*)/;D.query("#payers li").forEach(function(a,b){var d=a.getElementsByTagName("label")[0].getAttribute("rel");Element.create("input",{type:"hidden",name:"full_name[]",value:partern.exec(d)[1],appendTo:a});Element.create("input",{type:"hidden",name:"email[]",value:partern.exec(d)[2].trim(),appendTo:a});Element.create("input",{type:"hidden",name:"amount[]",value:a.getElementsByTagName("input")[0].value,
appendTo:a});Element.create("input",{type:"hidden",name:"row_no[]",value:b+1,appendTo:a})})},hasPersonAppend:function(a){var b=!1;g.forEach(function(d){d.id=="user_"+a&&(b=!0)});return b},isFull:function(a,b){if(30<=g.length){if(b)return D.get("user_"+a.id)&&D.get("user_"+a.id).focus(),30<=g.length;var d=D.getElementsByClassName("contact_"+a.id);if(d[0].checked)for(var e=0;e<d.length;e++)d[e].checked="",D.removeClass(d[e].parentNode,"current"),g.remove(d[e]);else return this.deletePerson(null,D.get("user_"+
a.id)),!0}return 30<=g.length},resetPayerStyle:function(){var b=D.query("#payers div");D.get("cannotEmpty")&&D.get("cannotEmpty").parentNode.removeChild(D.get("cannotEmpty"));6<=g.length||4<=b.length?(log(0),a.setStyles(D.get("payers"),{height:"230px"})):0>=D.query("#payers li").length?(log(1),a.setStyles(D.get("payers"),{"line-height":"0"})):(log(2),a.setStyles(D.get("payers"),{height:"auto"}))},addPerson:function(d,e,f){D.get("customPerson").value="";if(!this.isFull(e,f))if(this.hasPersonAppend(e.id)&&
!f)input=D.get("user_"+e.id),this.deletePerson(d,input);else{if(f){if(D.get("user_"+e.id)){D.get("user_"+e.id).focus();return}d=D.getElementsByClassName("contact_"+e.id);if(d.length)for(f=0;f<d.length;f++)d[f].checked="checked",D.addClass(d[f].parentNode,"current")}n=!0;d=Element.create("li");f=e.real_name==e.nick_name||"\u8bf7\u8f93\u5165\u8054\u7cfb\u4eba\u59d3\u540d"==e.nick_name||!e.nick_name.trim().length?Element.create("label",{title:e.real_name+" "+e.account}):Element.create("label",{title:e.real_name+
" ["+e.nick_name+"] "+e.account});f.setAttribute("rel",e.real_name+" ["+e.nick_name+"] "+e.account);var h=Element.create("span"),g=Element.create("input",{type:"text",id:"user_"+e.id,autocomplete:"off"}),j=Element.create("a",{title:"\u5220\u9664"});a.addClass(g,"i-text i-prize");a.addClass(j,"ico ico-del");real_name=8<e.real_name.len()?e.real_name.brief(8)+"..":e.real_name;account=16<e.account.len()?e.account.brief(16)+"..":e.account;f.innerHTML="<em>"+real_name+"</em> ("+account+")";h.innerHTML=
"&nbsp;\u5143";b.addListener(j,"click",this.deletePerson,g,this);h.insertBefore(g,h.firstChild);d.appendChild(f);d.appendChild(h);d.appendChild(j);k.appendChild(d);g.focus();this.updateMoneyInputs(g);this.bindEvent(g);this.buildPop(g);g.value=_getPreviousValue(g);this.countTotalMoney(g.value);this.countTotalPerson();this.resetPayerStyle();this.showPop(null,g)}},updateMoneyInputs:function(a){g.push(a)},getUsersLen:function(){return g.length},deletePerson:function(a,b){g.remove(b);b.parentNode.parentNode.parentNode.removeChild(b.parentNode.parentNode);
this.countTotalMoney(this.fomatValue(b.value));this.countTotalPerson();this.cannelChoose(b);this.resetPayerStyle();e.hidden()},cannelChoose:function(b){for(var b=a.getElementsByClassName("contact_"+b.id.replace("user_","")),d=0;d<b.length;d++)b[d].checked="",a.removeClass(b[d].parentNode,"current")},bindEvent:function(a){b.addListener(a,"blur",this.countMoney,a,this);b.addListener(a,"focus",this.showPop,a,this);b.addListener(a,"focus",this.resetInput,a,this);b.addListener(a,"keydown",this.killEnter,
a,this)},resetInput:function(a,b){b.select();D.addClass(b.parentNode,"fm-focus");this.resetError(b)},killEnter:function(a,b){var a=window.event||arguments.callee.caller.arguments[0],d=a.keyCode||a.which||a.charCode;String.fromCharCode(d);if(!(48<=d&&57>=d||95<d&&106>d)&&!(9==d||8==d||37==d||39==d||229==d)&&!(191==d||190==d||111==d||144==d||110==d||46==d))13==d&&(d=g.indexOf(l)>=g.length-1?0:g.indexOf(l)+1,log(d),g[d].focus()),d=a||window.event,d.preventDefault?d.preventDefault():d.returnValue=!1},
buildPop:function(a){e.container||(f=Element.create("div"),f.innerHTML="\u91d1\u989d\u6216\u516c\u5f0f\u3002\u5982\uff1a20\u6216100/5\u3002",null==e.container&&(e.init(),e.buildUI(f)),document.getElementById("PopContainerBody").appendChild(f),this.buildTotalDom(),this.showPop(null,a))},buildTotalDom:function(){j=Element.create("span");_reset_money=Element.create("input",{type:"button",value:"\u786e\u5b9a"});_cannel_btn=Element.create("input",{type:"button",value:"\u6062\u590d"});D.addClass(_reset_money,
"btn-fixed");D.addClass(_cannel_btn,"btn-fixed");a.setStyles(j,{display:"none"});j.appendChild(_reset_money);j.appendChild(_cannel_btn);a.getElementsByClassName("com-contacts-sum")[0].appendChild(j);b.addListener(_reset_money,"click",this.resetMoney,"",this);b.addListener(_cannel_btn,"click",function(){this.resetError(d);this.countTotalMoney();D.setStyles(j,{display:"none"})},"",this)},resetMoney:function(){n=!1;D.setStyles(j,{display:"none"});if(d.value.isInt()||d.value.isFloat())if(parseFloat(d.value)>
2E3*parseFloat(g.length))this.showError("\u603b\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc7"+2E3*parseFloat(g.length)+"\u3002",d,"span");else{var a=parseFloat(d.value)/parseFloat(g.length);g.forEach(function(b){b.value=this.fixMoney(a);this.resetError(b)},this);this.countTotalMoney();this.resetError(d)}else this.showError("\u5fc5\u987b\u8f93\u5165\u6570\u5b57",d,"span")},innerMoney:function(){},showPop:function(b,d){n=!0;1==g.length?e.show():e.hidden();l=d;var f=a.getX(d),h=a.getY(d)+parseInt(D.getStyle(d,
"height").replace("px",""))+6;e.setPosition([f,h])},hasBlankInput:function(){var a=!1,b=0;g.forEach(function(d){if(!d.value.trim().length||d.value==_error_info)b+=1,2<=b&&(a=!0)});return a},countTotalPerson:function(){var b=a.getElementsByClassName("com-contacts-sum")[0];g.length?a.removeClass(b,"fn-hide"):a.addClass(b,"fn-hide");h.innerHTML=g.length},countTotalMoney:function(){var a=0;g.forEach(function(b){a=D.hasClass(b.parentNode.parentNode,"fm-error")?a+0:a+100*this.fomatValue(b.value)},this);
d.value=this.fixMoney(a/100)},checkTotalMoney:function(){D.setStyles(j,{display:""});this.resetError(d,"span")},fomatValue:function(a){return a.isInt()||a.isFloat()?parseFloat(a):0},countMoney:function(a,b){D.removeClass(b.parentNode,"fm-focus");n=!1;var e=b.value;if(/^(([\d]+.{0,1}[\d]+)|[\d]+)\/[\d]+$/.test(e)){var f=e.split("/")[0],h=e.split("/")[1],e=this.fixMoney(parseFloat(f)/parseInt(h));if(0>=h){this.showError("\u516c\u5f0f\u51fa\u9519\uff01\u8bf7\u8f93\u5165\u91d1\u989d\u6216\u516c\u5f0f\u3002\u5982\uff1a20\u6216100/5\u3002",
b);return}if(0==parseFloat(e)){b.value="";return}if(2E3<parseFloat(e)){this.showError("\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc72000\u3002",b);return}b.value=e;this.resetError(b)}else if(e.isInt()||e.isFloat()){if(0==parseFloat(e)){b.value="";return}if(2E3<parseFloat(e)){this.showError("\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc72000\u3002",b);return}b.value=this.fixMoney(new Number(e));this.resetError(b)}else e.trim().length&&this.showError("\u516c\u5f0f\u51fa\u9519\uff01\u8bf7\u8f93\u5165\u91d1\u989d\u6216\u516c\u5f0f\u3002\u5982\uff1a20\u6216100/5\u3002",
b);this.resetError(d,"span");this.countTotalMoney()},keyupHandle:function(a,b){b.value=b.value.replace(/[^(\d|\.|^\/)]/g,"")},showError:function(b,d,e){e||(e="div");D.addClass(d.parentNode.parentNode,"fm-error");var f=a.getElementsByClassName("fm-explain",e,d.parentNode.parentNode),d=f.length?f[0]:Element.create(e,{appendTo:d.parentNode.parentNode});d.innerHTML=b;D.addClass(d,"fm-explain");this.resetPayerStyle()},resetError:function(b,d){d||(d="div");D.removeClass(b.parentNode.parentNode,"fm-error");
a.getElementsByClassName("fm-explain",d,b.parentNode.parentNode).length&&a.getElementsByClassName("fm-explain",d,b.parentNode.parentNode)[0].parentNode.removeChild(a.getElementsByClassName("fm-explain",d,b.parentNode.parentNode)[0])},fixMoney:function(a){var b=a.toString().split(".");return 1<b.length&&2<b[1].length?(b="0"==b[0].toString()?b[1].charAt(0)+b[1].charAt(1):b[0].toString()+b[1].charAt(0)+b[1].charAt(1),b=parseInt(b)+1,(b/100).toFixed(2)):a.toFixed(2)}}}();
AP.widget.addContacts=new AP.Class({initialize:function(){this.target=D.get("addAnthor");this.editContent=D.get("editContent");this.confirmContent=D.get("confirmContent");this.firstPerson=D.get("firstPerson");this.items=[this.firstPerson.parentNode.parentNode.parentNode];AP.widget.formInputStyle.init(this.firstPerson);E.on(this.firstPerson,"blur",this.validateAccount,this.firstPerson,this);E.on(this.firstPerson,"focus",function(a,b){var e=b.parentNode.parentNode.parentNode;D.query(".fm-explain",e).length&&
(D.removeClass(e,"fm-error"),e.removeChild(D.query(".fm-explain",e)[0]))},this.firstPerson,"");this.togon=!1;this.validated=!0;this.up_target=null;E.on(this.target,"click",this.addPerson,"",this);E.on(this.target,"mouseover",function(){this.togon=!0},"",this);E.on(this.target,"mouseout",function(){this.togon=!1},"",this)},addPerson:function(){var a=D.query(".contacts-item")[0].getElementsByTagName("span")[0];a&&1>=this.items.length&&(a=a.getElementsByTagName("a")[0])&&D.hasClass(a,"fn-hide")&&D.removeClass(a,
"fn-hide");a=this.getCreateEditItem();this.editContent.appendChild(a[0]);this.items.push(a[0]);this.targgleDEL();this.targgleADD();E.on(a[1],"click",this.delPerson,a[1],this);E.on(a[2],"focus",function(a,e){var g=e.parentNode.parentNode.parentNode;if(D.query(".fm-explain",g).length){D.removeClass(g,"fm-error");g.removeChild(D.query(".fm-explain",g)[0])}},a[2],"");E.on(a[2],"blur",this.validateAccount,a[2],this);AP.widget.formInputStyle.init(a[2]);D.addClass(this.confirmContent,"fn-hide");D.removeClass(this.editContent,
"fn-hide");D.removeClass(D.get("submitButtom"),"fn-hide");D.addClass(D.get("confirmButtom"),"fn-hide");a[2].select();!this.validated&&!D.query(".fm-explain",this.up_target).length&&(this.up_target.appendChild(this.getCreateErrorInfo()),D.addClass(this.up_target,"fm-error"))},delPerson:function(a,b){var e=this.getDelItemIndex(b);this.editContent.removeChild(this.items[e]);this.items.remove(this.items[e]);this.targgleDEL();this.targgleADD()},targgleDEL:function(){if(1>=this.items.length){var a=this.items[0].getElementsByTagName("div")[0],
b=a.getElementsByTagName("span");b.length&&a.removeChild(b[0])}else a=this.items[0].getElementsByTagName("div"),b=a[0].getElementsByTagName("span"),b.length||(b=this.getCreateDel(),Element.create("span",{append:b,appendTo:a[0]}),E.on(b,"click",this.delPerson,b,this))},targgleADD:function(){this.items.length>=this.leftcount?(D.addClass(this.target,"fn-hide"),E.removeListener(this.target,"click")):(D.removeClass(this.target,"fn-hide"),E.removeListener(this.target,"click"),E.on(this.target,"click",this.addPerson,
"",this))},validateAccount:function(a,b){var e=/^1\d{10}$/,g=b.parentNode.parentNode.parentNode;if(/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(b.value.trim())||e.test(b.value.trim())||0>=b.value.trim().length)D.query(".fm-explain",g).length&&(g.removeChild(D.query(".fm-explain",g)[0]),D.removeClass(g,"fm-error")),this.validated=!0;else{if(!this.togon){if(D.query(".fm-explain",g).length)return;g.appendChild(this.getCreateErrorInfo());D.addClass(g,"fm-error");return!1}this.validated=
!1;this.up_target=g}},getDelItemIndex:function(a){return this.items.indexOf(a.parentNode.parentNode.parentNode)},getCreateErrorInfo:function(){return Element.create("div",{innerHTML:"Email\u5730\u5740\u6216\u8005\u624b\u673a\u53f7\u7801\u683c\u5f0f\u6709\u8bef\u3002","class":"fm-explain"})},getCreateEditItem:function(){var a=Element.create("li",{"class":"edit"}),b=Element.create("div",{"class":"contacts-item",appendTo:a}),e=this.getCreateInput();Element.create("label",{append:e,appendTo:b});var g=
this.getCreateDel();Element.create("span",{append:g,appendTo:b});return[a,g,e]},getCreateInput:function(){return Element.create("input",{"class":"i-text",type:"text"})},getCreateDel:function(){return Element.create("a",{href:"javascript:void(0)",innerHTML:"\u5220\u9664"})}});
AP.widget.confirmContacts=AP.widget.addContacts.extend({initialize:function(a){this.leftcount=parseInt(a);this.parent();this.submitBtn=D.get("submitPerson");this.confirmBtn=D.get("confirmPerson");this.invalidate_users=[];this.validate_users=[];E.on(this.submitBtn,"click",this.submitConfirm,this.submitBtn,this);E.on(this.confirmBtn,"click",this.addContacts,this.confirmBtn,this);E.on(D.get("continueAdd"),"click",this.addAgain,"",this)},addContacts:function(){if(this.checkIsAllMobile()){var a=new AP.core.api("user/contacts/addToGroups",
{onAPISuccess:this.addSuccess,method:"POST"},this),b=[],e=[];this.validate_users.forEach(function(a){b.push(a.logonId)});D.query("#chooseGroups a").forEach(function(a){D.hasClass(a,"selected")&&e.push(a.getAttribute("rel"))});this.join_groups=e;this.validate_users.length?a.call({logonIds:b.join(","),groupIds:e.join(",")}):(D.addClass(D.query(".com-add-contacts")[0],"fn-hide"),D.removeClass(D.get("addSuccess"),"fn-hide"),D.get("topTitle").innerHTML="\u9080\u8bf7\u8054\u7cfb\u4eba",D.addClass(D.get("tipInfo"),
"fn-hide"),this.buildInviteDom())}},addAgain:function(){this.items=[];D.addClass(D.get("addSuccess"),"fn-hide");D.addClass(this.confirmContent,"fn-hide");D.addClass(D.get("confirmButtom"),"fn-hide");D.removeClass(this.editContent,"fn-hide");D.removeClass(D.get("submitButtom"),"fn-hide");D.get("topTitle").innerHTML="\u6dfb\u52a0\u8054\u7cfb\u4eba";D.removeClass(D.get("tipInfo"),"fn-hide");D.removeClass(D.query(".com-add-contacts",D.get("container"))[0],"fn-hide");D.get("editContent").innerHTML="";
this.addPerson()},addSuccess:function(a,b){b=b[0];D.addClass(D.query(".com-add-contacts")[0],"fn-hide");D.removeClass(D.get("addSuccess"),"fn-hide");D.get("topTitle").innerHTML="\u9080\u8bf7\u8054\u7cfb\u4eba";D.addClass(D.get("tipInfo"),"fn-hide");window.parent.mytip.show(b.msg);if(this.invalidate_users.length){var e=0;this.invalidate_users.forEach(function(a){/^1\d{10}$/.test(a.logonId)||(e+=1)});0<e?this.buildInviteDom():(window.parent.location.href="index.htm",self.parent.AP.widget.xBox.hide())}else window.parent.location.href=
"index.htm",self.parent.AP.widget.xBox.hide()},buildInviteDom:function(){D.get("invalidateUserNum").innerHTML=this.invalidate_users.length;var a='<table><thead><tr><th class="first"><span>\u5bf9\u65b9\u540d\u79f0</span></th><th class="last"><span>\u9080\u8bf7\u65b9\u5f0f</span> </th></tr></thead><tbody>{body}</tbody></table>',b="";this.invalidate_users.forEach(function(a){/^1\d{10}$/.test(a.logonId)||(30<a.logonId.length?(a=a.logonId.split("@"),17<a[0].length&&(a[0]=a[0].substr(0,14)+"..."),12<a[0].length&&
(a[1]=a[0].substr(0,9)+"..."),a=a[0]+"@"+a[1]):a=a.logonId,b+="<tr><td>"+a+'</td><td class="last"><a href="javascript:void(0)" class="invite" rel="email" title="'+a+'">\u53d1\u9001\u90ae\u4ef6\u9080\u8bf7</a><span class="m-success fn-hide"></span></td></tr>')});a=a.replace("{body}",b);D.get("invalidateUserBody").innerHTML=a;this.sendInvite()},sendInvite:function(){D.query(".invite").forEach(function(a){E.on(a,"click",function(){(new AP.core.api("user/contacts/inviteContact",{onAPISuccess:function(b,
e){D.addClass(a,"fn-hide");var g=D.query(".m-success",a.parentNode)[0];g.innerHTML=e[0].msg;D.removeClass(g,"fn-hide")},onAPIFailure:function(b,e){D.addClass(a,"fn-hide");var g=D.query(".m-success",a.parentNode)[0];g.innerHTML=e[0].msg;D.removeClass(g,"m-success");D.removeClass(g,"fn-hide");D.addClass(g,"m-error")},method:"POST"})).call({logonId:a.title,type:a.getAttribute("rel"),cgIds:this.join_groups.join(",")})},a,this)},this)},submitConfirm:function(){this.validatorLength()&&!this.hasError()&&
(this.validateUsers(),this.showSubmitBtn())},validatorLength:function(){var a=0;this.items.forEach(function(b){b.getElementsByTagName("input")[0].value.trim()&&(a+=1)});return a},showSubmitBtn:function(){this.items.length<this.leftcount&&(D.removeClass(this.target,"fn-hide"),E.removeListener(this.target,"click"),E.on(this.target,"click",this.addPerson,"",this))},showConfirmContent:function(){D.addClass(this.editContent,"fn-hide");D.addClass(D.get("submitButtom"),"fn-hide");D.removeClass(this.confirmContent,
"fn-hide");D.removeClass(D.get("confirmButtom"),"fn-hide")},hasError:function(){return D.query("#editContent .fm-error").length},deleteItems:function(a,b){var e=this.confirmItems.indexOf(b.parentNode.parentNode.parentNode),g=this.confirmItems[e],e=this.items[e],f=e.getElementsByTagName("input")[0];this.items.remove(e);this.confirmItems.remove(g);g.parentNode.removeChild(g);e.parentNode.removeChild(e);this.validate_users.forEach(function(a){a.logonId==f.value&&this.validate_users.remove(a)},this);
this.invalidate_users.forEach(function(a){a.logonId==f.value&&this.invalidate_users.remove(a)},this);this.targgleCDEL();this.targgleADD()},targgleCDEL:function(){if(1>=this.confirmItems.length){var a=this.confirmItems[0].getElementsByTagName("div")[0],b=a.getElementsByTagName("span")[0],a=D.query(".delete",a);a.length&&b.removeChild(a[0])}else a=this.confirmItems[0].getElementsByTagName("div"),a[0].getElementsByTagName("span")},deleteBlankItem:function(){for(var a=[],b=0;b<this.items.length;b++){var e=
this.items[b];e.getElementsByTagName("input")[0].value.trim().length||(this.editContent.removeChild(e),a.push(this.items[b]))}a.forEach(function(a){this.items.remove(a)},this);if((a=D.query(".contacts-item")[0].getElementsByTagName("span")[0])&&1>=this.items.length)(a=a.getElementsByTagName("a")[0])&&D.addClass(a,"fn-hide")},uniqueItems:function(){var a=[];this.items.forEach(function(b){a.push(b)});for(var b=0;b<a.length;b++)for(var e=b+1;e<a.length;e++){var g=a[e].getElementsByTagName("input")[0].value.trim(),
f=a[b].getElementsByTagName("input")[0].value.trim();if(g==f)try{a[e].parentNode.removeChild(a[e]),this.items.remove(a[e])}catch(d){}}this.targgleDEL()},validateUsers:function(){this.uniqueItems();this.deleteBlankItem();var a=[];this.invalidate_users=[];this.items.forEach(function(b){a.push(b.getElementsByTagName("input")[0].value)});(new AP.core.api("user/contacts/getValidateUsers",{onAPISuccess:this.buildConfirm,method:"POST"},this)).call({account:a.join(",")})},buildConfirm:function(a,b){b=b[0];
if(!this.isValidateFalse(b)){this.showConfirmContent();this.confirmContent.innerHTML="";this.confirmItems=[];this.users=b.users;b.users.forEach(function(a){a=this.getCreateConfirmItem(a);this.confirmItems.push(a[0]);this.confirmContent.appendChild(a[0]);E.on(a[1],"click",this.showEdit,a[1],this);E.on(a[2],"click",this.deleteItems,a[2],this)},this);if(1>=this.items.length){var e=D.query(".delete",this.confirmItems[0]),g=D.query(".contacts-item",this.confirmItems[0])[0].getElementsByTagName("span")[0];
e.length&&g.removeChild(e[0])}this.checkIsAllMobile()}},checkIsAllMobile:function(){var a=0,b=0;if(0>=this.validate_users.length){this.invalidate_users.forEach(function(e){/^1\d{10}$/.test(e.logonId)?a+=1:b+=1});if(0==b&&0<a)return D.removeClass(this.confirmBtn.parentNode,"btn-ok"),D.addClass(this.confirmBtn.parentNode,"btn-ok-disabled"),!1;D.addClass(this.confirmBtn.parentNode,"btn-ok");D.removeClass(this.confirmBtn.parentNode,"btn-ok-disabled")}D.addClass(this.confirmBtn.parentNode,"btn-ok");D.removeClass(this.confirmBtn.parentNode,
"btn-ok-disabled");return!0},isValidateFalse:function(a){var b=!1;a.users.forEach(function(a){if(!a.validateResult&&("ERROR.CONTACTS.NOTALLOW_ADD"==a.failedReason||"ERROR.CONTACTS.ADDED"==a.failedReason||/^1\d{10}$/.test(a.logonId)))b=!0,this.items.forEach(function(b){D.query("input",b)[0].value.trim()==a.logonId&&(/^1\d{10}$/.test(a.logonId)&&"ERROR.CONTACTS.ADDED"!=a.failedReason?"ERROR.CONTACTS.NOTALLOW_ADD"==a.failedReason?this.getCreateError(b,a.failedReasonDes):this.getCreateError(b,"\u5bf9\u65b9\u624b\u673a\u53f7\u4e0d\u662f\u652f\u4ed8\u5b9d\u4f1a\u5458\uff0c\u4e0d\u80fd\u6dfb\u52a0\u3002"):
this.getCreateError(b,a.failedReasonDes))},this)},this);return b},showEdit:function(a,b){var e=this.items[this.confirmItems.indexOf(b.parentNode.parentNode.parentNode)].getElementsByTagName("input")[0];D.removeClass(this.editContent,"fn-hide");D.removeClass(D.get("submitButtom"),"fn-hide");D.addClass(this.confirmContent,"fn-hide");D.addClass(D.get("confirmButtom"),"fn-hide");e.focus()},getCreateConfirmItem:function(a){var b=Element.create("li"),e=Element.create("div",{"class":"contacts-item",appendTo:b});
if(30<a.logonId.length){var g=a.logonId.split("@");17<g[0].length&&(g[0]=g[0].substr(0,14)+"...");12<g[0].length&&(g[1]=g[0].substr(0,9)+"...");g=g[0]+"@"+g[1]}else g=a.logonId;a.validateResult?Element.create("label",{innerHTML:a.realName+" ("+g+")",appendTo:e,title:a.logonId}):Element.create("label",{innerHTML:g,appendTo:e,title:a.logonId});g=Element.create("span",{appendTo:e});e=Element.create("a",{href:"javascript:void(0)",appendTo:g,innerHTML:"\u4fee\u6539"});g=Element.create("a",{href:"javascript:void(0)",
appendTo:g,innerHTML:"\u5220\u9664","class":"delete"});a.validateResult?this.validate_users.push(a):(this.invalidate_users.push(a),Element.create("div",{innerHTML:a.failedReasonDes,appendTo:b,"class":"fm-explain"}),D.addClass(b,"fm-message current"));return[b,e,g]},getCreateError:function(a,b){var e=Element.create("div",{innerHTML:b,appendTo:a,"class":"fm-explain"});D.addClass(a,"fm-error");return e},newAPI:function(a,b){return new AP.core.api(a,{onAPISuccess:b})}});
AP.widget.appendToGroup=new AP.Class({initialize:function(a){D.query("#chooseGroups a").forEach(function(a){E.on(a,"click",this.changeStatus,a,this)},this);E.on(D.get("createGroupBtn"),"click",function(a){D.addClass(D.get("createGroupBtn").parentNode,"fn-hide");D.removeClass(D.get("createGroupContainer"),"fn-hide");AP.widget.formInputStyle.init(D.get("groupTxt"));D.get("groupTxt").value.trim().length||(D.get("groupTxt").value="\u672a\u547d\u540d\u5206\u7ec4");D.get("groupTxt").focus();D.get("groupTxt").select();
E.preventDefault(a)},"",this);E.on(D.get("cannelChoose"),"click",function(a){D.removeClass(D.get("createGroupBtn").parentNode,"fn-hide");D.addClass(D.get("createGroupContainer"),"fn-hide");E.preventDefault(a)});E.on(D.get("createBtn"),"click",this.createGroup,"",this);E.on(D.get("groupTxt"),"blur",function(a){"groupTxt"!=E.getTarget(a).id&&!this.value.trim().length&&(this.value="\u672a\u547d\u540d\u5206\u7ec4")});E.on(D.get("groupTxt"),"focus",function(){var a=D.query(".fm-explain",this.parentNode)[0];
D.removeClass(this.parentNode,"fm-error");a.innerHTML="\u6700\u591a10\u4e2a\u5b57\u3002"});this.options=this.setOptions(a);this.completeEvent=new U.CustomEvent("completeEvent");this.completeEvent.subscribe(this.options.completeEvent,this,!0)},setOptions:function(a){return AP.hashExtend({completeEvent:function(){}},a||{})},createGroup:function(){if(D.get("groupTxt").value.trim().length){var a={onAPISuccess:this.innerNewTag,onAPIFailure:this.createGroupFail,method:"POST"};this.options.apiUrl&&AP.hashExtend(a,
{api_url:this.options.apiUrl,format:"jsonp"});(new AP.core.api("user/contacts/createGroup",a,this)).call({groupName:D.get("groupTxt").value,_input_charset:"utf-8"})}},createGroupFail:function(a,b){var e=D.get("groupTxt").parentNode;D.query(".fm-explain",e)[0].innerHTML=b[0].msg;D.addClass(e,"fm-error")},innerNewTag:function(a,b){var e=Element.create("a",{appendTo:D.get("chooseGroups"),"class":"selected",rel:b[0].result.id});Element.create("span",{innerHTML:b[0].result.name,appendTo:e});E.on(e,"click",
this.changeStatus,e,this);D.get("groupTxt").value="";D.removeClass(D.get("createGroupBtn").parentNode,"fn-hide");D.addClass(D.get("createGroupContainer"),"fn-hide");10<=parseInt(b[0].groupCount)&&D.addClass(D.query(".p-add-grounp")[0],"fn-hide");this.completeEvent.fire(b)},changeStatus:function(a,b){D.hasClass(b,"selected")?D.removeClass(b,"selected"):D.addClass(b,"selected");E.preventDefault(a)}});
AP.widget.autoMatchContacts=function(){var a=D.get("ipt-search-key"),b=!1;E.on(a,"focus",function(){this.value==_("search_from_contacts")&&(this.value="",this.select());D.removeClass(a,"i-text-gray")},"","");E.on(a,"blur",function(d){E.getTarget(d);b||this.value!=_("search_from_contacts")&&this.value.trim().length||(this.value=_("search_from_contacts"),D.addClass(a,"i-text-gray"))},"","");E.on(D.get("J_SearchResult"),"click",function(){a.value.trim().length&&a.value.trim()!=_("search_from_contacts")&&
D.get("search-contact").submit()});E.on(D.get("autoCompleteContainer"),"mouseover",function(){b=!0});E.on(D.get("autoCompleteContainer"),"mouseout",function(){b=!1});E.on(D.get("J_SearchResult"),"mouseover",function(){b=!0});E.on(D.get("J_SearchResult"),"mouseout",function(){b=!1});var e=new YAHOO.util.XHRDataSource("/user/contacts/searchResult.json");e.responseType=YAHOO.util.XHRDataSource.TYPE_JSON;e.connMethodPost=!0;e.maxCacheEntries=60;e.responseSchema={resultsList:"result",fields:["contactLogonId",
"contactNickName","ownerCardNo","contactRealName"]};var g=e.sendRequest;e.sendRequest=function(a,b,e){if(-1===a.indexOf("ctoken=")){var f=YAHOO.util.Cookie.get("ctoken");f&&(a="ctoken="+encodeURIComponent(f)+"&"+a)}g.call(this,a,b,e)};var f=new YAHOO.widget.AutoComplete("ipt-search-key","autoCompleteContainer",e);f.queryDelay=0.5;f.queryDelay=0;f.resultTypeList=!1;f.autoHighlight=!1;f.generateRequest=function(a){return"keyword="+a};f.formatResult=function(a){var b=D.query("#autoCompleteContainer ul")[0];
D.setStyle(b,"width","174px");D.setStyles(b,{display:""});b=a.contactNickName?a.contactNickName:"";if(a.contactRealName){var e=a.contactRealName;8<e.len()&&(e=e.brief(8)+"..")}else e="";a=a.contactLogonId;16<a.len()&&(a=a.brief(16)+"..");return'<span title="'+b+'" rel="'+a+'">'+e+"("+a+")</span>"};f.itemSelectEvent.subscribe(function(){D.get("search-contact").submit()});f.dataErrorEvent.subscribe(function(){var a=D.query("#autoCompleteContainer ul")[0];D.setStyles(a,{display:"none"})});return{oDS:e,
oAC:f}};
AP.widget.appendContacts=function(){var a=YAHOO.util.Event;_target_btn=_require_fields=_request_url=null;var b=function(){for(var a=_require_fields.length,b=0;b<_require_fields.length;b++)_require_fields[b].checked||a--;return a},e=function(){if(b()){for(var a="",d=0;d<_require_fields.length;d++)_require_fields[d].checked&&(a+="emails="+_require_fields[d].value+"&");AP.ajax.asyncRequest("POST",_request_url,f,a)}},g=function(){D.removeClass(_target_btn.parentNode,"btn-ok-disabled");D.addClass(_target_btn.parentNode,"btn-ok");
a.addListener(_target_btn,"mouseout",function(){this.parentNode.className="btn btn-ok"});a.addListener(_target_btn,"mouseover",function(){this.parentNode.className="btn btn-ok-hover"})},f={success:function(a){a=a.responseText.split(",");try{D.get("addWaiting")&&D.get("addWaiting").parentNode.removeChild(D.get("addWaiting")),D.get("addSuccessBox")&&D.removeClass(D.get("addSuccessBox"),"fn-hide"),D.get("addSuccessNum")&&(D.get("addSuccessNum").innerHTML=a[1])}catch(b){log(b)}}},d=function(){b()?g():
(_target_btn.parentNode.setAttribute("onmouseout",""),_target_btn.parentNode.setAttribute("onmouseover",""),a.removeListener(_target_btn,"mouseout"),a.removeListener(_target_btn,"mouseover"),D.removeClass(_target_btn.parentNode,"btn-ok"),D.addClass(_target_btn.parentNode,"btn-ok-disabled"))};return{init:function(b,f,g){_request_url=g;_target_btn=b;_require_fields=f;a.addListener(_target_btn,"click",e);for(b=0;b<_require_fields.length;b++)_require_fields[b].checked="checked",a.addListener(_require_fields[b],
"click",d)}}}();
AP.widget.choosePerson=function(){var a=YAHOO.util.Dom,b=YAHOO.util.Event,e=null,g=null,f=null,d=null,h=null,j=null,k=null,l=null,n=function(){var a=h.value.trim();if(!a.length||D.hasClass(h.parentNode,"fm-error")||"\u4ece\u6211\u7684\u8054\u7cfb\u4eba\u4e2d\u6dfb\u52a0"==d.innerHTML)D.hasClass(h.parentNode,"fm-error")&&"\u5173\u95ed\u8054\u7cfb\u4eba"==d.innerHTML?D.addClass(f,"fn-hide"):D.hasClass(f,"fn-hide")?D.removeClass(f,"fn-hide"):D.addClass(f,"fn-hide"),D.hasClass(f,"fn-hide")?d.innerHTML=
"\u4ece\u6211\u7684\u8054\u7cfb\u4eba\u4e2d\u6dfb\u52a0":d.innerHTML="\u5173\u95ed\u8054\u7cfb\u4eba";else{if(a==k)q();else{null!=j&&(j.checked="",D.removeClass(j.parentNode,"current"));var b;a:{for(b=0;b<_contacts.length;b++)for(var e=0;e<_contacts[b].users.length;e++)if(a==_contacts[b].users[e].account){b=_contacts[b].users[e];break a}b=!1}b?m(b):AP.ajax.asyncRequest("POST",l,o,"email="+a+"&row_no=1")}D.hasClass(D.get("personWaiting"),"fn-hide")&&D.addClass(f,"fn-hide")}},o={success:function(a){a=
a.responseText.split(",");m(0==a[1].length?{real_name:"",account:h.value}:{real_name:a[1],account:h.value})}},q=function(){a.addClass(e,"fn-hide");a.removeClass(e,"fm-error");a.removeClass(g,"fn-hide")},m=function(a){var d=Element.create("span"),e=Element.create("a",{href:"javascript:void(0);"});d.innerHTML="<em>"+a.real_name+"</em> ("+a.account+")&nbsp;&nbsp;";e.innerHTML="\u91cd\u65b0\u9009\u62e9\u8054\u7cfb\u4eba";k=h.value=a.account;g.innerHTML="";g.appendChild(d);g.appendChild(e);b.addListener(e,
"click",r,a,this);q();try{D.get("contact_"+a.id).checked="checked",j=D.get("contact_"+a.id),D.addClass(j.parentNode,"current")}catch(s){}D.hasClass(D.get("personWaiting"),"fn-hide")&&D.addClass(f,"fn-hide");return[d,e]},r=function(){a.addClass(g,"fn-hide");a.removeClass(e,"fn-hide");a.removeClass(f,"fn-hide");d.innerHTML="\u5173\u95ed\u8054\u7cfb\u4eba";D.removeClass(D.getAncestorByClassName(h,"fm-item"),"fm-error")};return{init:function(k,v){e=D.get("personWaiting");g=D.get("personEditing");f=D.get("personContact");
h=D.get("personInput");d=D.get("extendContacts");l=v;_contacts=k;b.addListener(D.get("closeContacts"),"click",function(){d.innerHTML="\u5173\u95ed\u8054\u7cfb\u4eba";n();a.addClass(f,"fn-hide")});b.addListener(d,"click",n)},addPerson:function(b,d){null!=j&&(j.checked="",D.removeClass(j.parentNode,"current"));m(d);a.addClass(f,"fn-hide");a.addClass(e,"fn-hide");a.removeClass(e,"fm-error");a.removeClass(g,"fn-hide")}}}();
AP.widget.buildGroupDom=new AP.Class({render:function(){},setHTML:function(){return html=""},getElements:function(){this.body=D.query(".c-group-all")[0];this.head=D.query(".c-group-select-title")[0]},show:function(){D.removeClass(this.container,"fn-hide")},hidden:function(){D.addClass(this.container,"fn-hide")}});
AP.widget.viewChoosedGroup=AP.widget.buildGroupDom.extend({initialize:function(a){this.render();this.getElements();a.forEach(function(a){E.on(a,"click",this.viewGroup,a,this)},this);this.current_el=null;this.tripdown=new AP.widget.tipdone;document.body.appendChild(this.container)},render:function(){this.container||(this.container=Element.create("div",{"class":"c-group-select fn-hide"}),this.container.innerHTML=this.setHTML(),document.body.appendChild(this.container))},setHTML:function(){D.addClass(this.container,
"view-group-contanier");return html='<div class="c-group-select-container  view-group-contanier"><div class="c-group-select-content"><div class="c-group-all"></div></div><div class="c-group-select-title mid"></div></div>'},setHead:function(){this.head.innerHTML="\u5206\u7ec4\uff1a";var a=Element.create("a",{innerHTML:"\u5173\u95ed\u67e5\u770b",appendTo:this.head});E.on(a,"click",this.hidden,a,this);E.on(a,"click",function(){this.showBottomGroup()},a,this)},viewGroup:function(a,b){null!=this.current_el&&
this.showBottomGroup();this.current_el=b;this.setHead();this.innerData(b);this.show();this.position(b);this.hiddenBottomGroup(b);E.preventDefault(a)},hiddenBottomGroup:function(a){a=a.parentNode.getElementsByTagName("span")[0];D.addClass(a,"fn-hide")},showBottomGroup:function(){var a=this.current_el.parentNode.getElementsByTagName("span")[0];D.removeClass(a,"fn-hide")},innerData:function(a){var b=this.getChoosedData(a);this.num=0;this.body.innerHTML="";b.forEach(function(e,g){36<=this.num&&(this.num=
0);var f=10<e.name.escapeHTML().unescapeHTML().length?e.name.escapeHTML().unescapeHTML().substr(0,7).escapeHTML()+"...":e.name;this.getCreateTag(e);this.num+=f.escapeHTML().unescapeHTML().len();g<b.length-1&&!D.hasClass(a,"view-choose-group")&&36>this.num&&this.getCreateEm()},this)},getCreateTag:function(a){var b=a.name.escapeHTML().unescapeHTML(),e=-1<b.indexOf("&amp;")||-1<b.indexOf("&gt;")||-1<b.indexOf("&lt;")||-1<b.indexOf("&quot;")?b.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,
"<").replace(/&quot;/g,'"'):b;10<b.length&&(e=e.substr(0,7).escapeHTML()+"..");a=Element.create("a",{title:a.name,appendTo:this.body,rel:a.id,href:"index_group.htm?src=contactGroup&groupId="+a.id});Element.create("span",{innerHTML:e,appendTo:a});return a},getCreateEm:function(){},getChoosedData:function(a){a.parentNode.getAttribute("rel")?(a=AP.cache.usergroups[a.parentNode.getAttribute("rel")],void 0===a&&(a=[])):a=[];return a},position:function(a){var b=D.getRegion(this.container),b=b.right-b.left-
193,b=D.getX(a)-110-b,a=D.getY(a)+19;D.setXY(this.container,[b,a]);this.show()},show:function(){D.removeClass(this.container,"fn-hide");D.addClass(D.query(".edit-group-contanier")[0],"fn-hide")}});
AP.widget.tagChooseGroup=AP.widget.viewChoosedGroup.extend({initialize:function(a,b){this.groups=b;this.parent(a);this.body.id="chooseGroupTag"},render:function(){this.container||(this.container=Element.create("div",{"class":"c-group-select fn-hide"}),this.container.innerHTML=this.setHTML(),document.body.appendChild(this.container))},getElements:function(){this.body=D.query(".edit-group-body")[0];this.head=D.query(".edit-group-head")[0];E.on(D.query(".new-group-tag")[0],"click",function(a){D.addClass(D.get("newGroupAction"),
"fn-hide");D.removeClass(D.get("newGroupButton"),"fn-hide");D.get("groupTxt").value.trim().length||(D.get("groupTxt").value="\u672a\u547d\u540d\u5206\u7ec4");D.get("groupTxt").select();E.preventDefault(a)},"",this);E.on(D.get("createBtn"),"click",this.createGroup,"",this);E.on(D.get("cannelBtn"),"click",function(a){D.removeClass(D.get("newGroupAction"),"fn-hide");D.addClass(D.get("newGroupButton"),"fn-hide");E.preventDefault(a)},"",this);E.on(D.get("saveGroupBtn"),this.save,"",this);AP.widget.formInputStyle.init(D.get("groupTxt"));
D.query(".create-group-btn",this.container).forEach(function(a){E.on(a,"click",this.save,"",this)},this);D.query(".cannel_choose",this.container).forEach(function(a){E.on(a,"click",this.cannelChoose,"",this)},this);E.on(D.get("groupTxt"),"focus",function(){D.query(".fm-explain",this.parent)[0].innerHTML="\u6700\u591a10\u4e2a\u5b57\u3002"})},createGroup:function(){D.get("groupTxt").value.trim().length&&(new AP.core.api("user/contacts/createGroup",{onAPISuccess:this.innerNewTag,onAPIFailure:this.createGroupFail,
method:"POST"},this)).call({groupName:D.get("groupTxt").value})},innerNewTag:function(a,b){this.num+=b[0].result.name.escapeHTML().unescapeHTML().len();40<=this.num?(this.getCreateTag(b[0].result,!0),this.num=0):(this.getCreateEm(),this.getCreateTag(b[0].result,!0));10<=parseInt(b[0].groupCount)&&D.addClass(D.query(".new-group-tag")[0],"fn-hide");this.groups.push(b[0].result);D.removeClass(D.get("newGroupAction"),"fn-hide");D.addClass(D.get("newGroupButton"),"fn-hide");D.get("groupTxt").value=""},
createGroupFail:function(a,b){var b=b[0],e=D.get("groupTxt").parentNode;D.addClass(e,"fm-error");D.query(".fm-explain",e)[0].innerHTML=b.msg},cannelChoose:function(){D.query("#chooseGroupTag a").forEach(function(a){D.removeClass(a,"selected")})},setHTML:function(){D.addClass(this.container,"edit-group-contanier");return html='<div class="c-group-select-container"><div class="c-group-select-title edit-group-head"></div><div class="c-group-select-content"><div class="c-group-all edit-group-body"></div><div class="c-group-select-action ft-right" id="newGroupAction">'+
(10<=this.groups.length?"":'<a class="fn-left new-group-tag" href="#">\u65b0\u5efa\u5206\u7ec4</a>')+'<input value="\u4fdd\u5b58" type="button" class="btn-2cn create-group-btn"> <a href="javascript:void(0)" class="cannel_choose">[\u6e05\u7a7a\u9009\u62e9]</a></div><div class="c-group-select-action fn-hide" id="newGroupButton"><ul id="createGroup" class="fm-input fm-add-group"><li class="fm-item"><input id="groupTxt" class="i-text i-text-s" maxlength="10" value="\u672a\u547d\u540d\u5206\u7ec4"/> <input id="createBtn" class="btn-2cn" type="button" value="\u521b\u5efa"> <a href="#" id="cannelBtn">\u53d6\u6d88</a><div class="fm-explain">\u6700\u591a10\u4e2a\u5b57\u3002</div></li></ul><div class="c-group-save"><input value="\u4fdd\u5b58" type="button" class="btn-2cn create-group-btn"> <a href="javascript:void(0)" class="cannel_choose">[\u6e05\u7a7a\u9009\u62e9]</a></div></div></div></div>'},
setHead:function(){this.head.innerHTML="\u5206\u7ec4\uff1a  ";var a=Element.create("a",{innerHTML:"\u53d6\u6d88",appendTo:this.head});E.on(a,"click",this.hidden,"",this);E.on(a,"click",function(){this.showBottomGroup()},"",this)},save:function(){D.hasClass(D.get("newGroupButton"),"fn-hide")?this.saveContactHandle():(new AP.core.api("user/contacts/createGroup",{onAPISuccess:this.groupCreateOk,onAPIFailure:this.createGroupFail,method:"POST"},this)).call({groupName:D.get("groupTxt").value})},groupCreateOk:function(a,
b){this.innerNewTag(a,b);this.saveContactHandle()},saveContactHandle:function(){var a=this.getChoosedTags();if(D.hasClass(this.current_el,"save-contact")){var b=new AP.core.api("user/contacts/addSingleContact",{onAPISuccess:this.saveContactOK,onAPIFailure:this.systemException,method:"POST"},this);b.call({groupIds:a,logonId:D.query(".account",this.current_el.parentNode.parentNode)[0].title})}else b=new AP.core.api("user/contacts/changeUserGroup",{onAPISuccess:this.addContactOK,method:"POST",cache:!1},
this),b.call({groupIds:a,logonIds:D.query(".account",this.current_el.parentNode.parentNode)[0].title});this.hidden()},systemException:function(a,b){b[0].msg&&new AP.widget.errorXbox({error_info:b[0].msg,url_info:'<a href="/user/contacts/index.htm">\u8fd4\u56de\u6211\u7684\u8054\u7cfb\u4eba </a>'})},saveContactOK:function(a,b){this.showBottomGroup();this.changeText(b);b=b[0];this.current_el.innerHTML="[\u4fee\u6539]";mytip.show(b.msg);D.removeClass(this.current_el,"ico-plus");D.removeClass(this.current_el,
"save-contact");var e=D.query(".J_item",this.current_el.parentNode.parentNode.parentNode)[0],g=[];b.contactGroupList.forEach(function(a){g.push({name:a.name.escapeHTML(),id:a.id})});var f="user_"+b.crmUserId;this.current_el.parentNode.setAttribute("rel",f);AP.cache.usergroups[f]=g;e.disabled="";e.id="contacts_item_"+b.crmUserId;D.addClass(e,"J_item");var f=D.query("label",this.current_el.parentNode.parentNode.parentNode)[0],d=D.query(".nickname_edit",this.current_el.parentNode.parentNode.parentNode)[0],
h=D.query(".delete",this.current_el.parentNode.parentNode.parentNode)[0];f.setAttribute("for",e.id);D.removeClass(h,"fn-hide");D.removeClass(d,"fn-hide")},addContactOK:function(a,b){this.showBottomGroup();this.changeText(b);mytip.show("\u4fee\u6539\u5206\u7ec4\u6210\u529f\u3002")},changeText:function(a){var b=this.current_el.parentNode.getElementsByTagName("span")[0];html=[];var e=[];a[0].contactGroupList.forEach(function(a){e.push({name:a.name.escapeHTML(),id:a.id})});var g=this.current_el.parentNode.getAttribute("rel");
AP.cache.usergroups[g]=e;var f=0,d=0;a[0].contactGroupList.forEach(function(a,b){if(10<=f||2<b)return!1;d=b+1;var e=f;f+=a.name.escapeHTML().unescapeHTML().length;e=10<f?a.name.escapeHTML().substring(0,10-e).escapeHTML()+"...":a.name.escapeHTML();html.push('<a href="index_group.htm?src=contactGroup&groupId='+a.id+'" title="'+e.escapeHTML().unescapeHTML()+'">'+e+"</a>")});3<a[0].contactGroupList.length?(b.innerHTML="\u5206\u7ec4\uff1a"+html.join("\uff0c")+" \u7b49"+a[0].contactGroupList.length+"\u4e2a",
g=D.query(".view-choose-group",this.current_el.parentNode)[0],D.removeClass(g,"fn-hide")):0==a[0].contactGroupList.length?(g=D.query(".view-choose-group",this.current_el.parentNode)[0],b.innerHTML="\u5206\u7ec4\uff1a\u65e0",D.addClass(g,"fn-hide")):(g=D.query(".view-choose-group",this.current_el.parentNode)[0],d<a[0].contactGroupList.length?(b.innerHTML="\u5206\u7ec4\uff1a"+html.join("\uff0c")+" \u7b49"+a[0].contactGroupList.length+"\u4e2a",D.removeClass(g,"fn-hide")):(b.innerHTML="\u5206\u7ec4\uff1a"+
html.join("\uff0c"),D.addClass(g,"fn-hide")))},changeStatus:function(a,b){D.hasClass(b,"selected")?D.removeClass(b,"selected"):D.addClass(b,"selected");E.preventDefault(a)},getChoosedTags:function(){var a=[];D.query("#chooseGroupTag a").forEach(function(b){D.hasClass(b,"selected")&&a.push(b.getAttribute("rel"))});return a.join(",")},innerData:function(a){var b="[]"==a.parentNode.getAttribute("rel")?[]:this.getChoosedData(a),e=[],g=this.groups;this.num=0;this.body.innerHTML="";b.forEach(function(a){e.push(a.id.toString())});
g.forEach(function(b,d){36<=this.num&&(this.num=0);e.has(b.id.toString())?this.getCreateTag(b,!0):this.getCreateTag(b);this.num+=b.name.escapeHTML().unescapeHTML().len();d<g.length-1&&(D.hasClass(a,"view-choose-group")?this.body.appendChild(document.createTextNode("\uff0c")):36>this.num&&this.getCreateEm())},this)},position:function(a){var b=D.getRegion(a).right-373,a=D.getY(a)+23;D.setXY(this.container,[b,a]);this.show()},getCreateTag:function(a,b){var e=-1<a.name.indexOf("&amp;")||-1<a.name.indexOf("&gt;")||
-1<a.name.indexOf("&lt;")||-1<a.name.indexOf("&quot;")?a.name.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"'):a.name;10<a.name.escapeHTML().unescapeHTML().length&&(e=e.substring(0,7)+"..");e="<span>"+e.escapeHTML()+"</span>";e=b?Element.create("a",{title:a.name,innerHTML:e,appendTo:this.body,"class":"selected",rel:a.id,href:"#"}):Element.create("a",{title:a.name,innerHTML:e,appendTo:this.body,rel:a.id,href:"#"});E.on(e,"click",this.changeStatus,e,this)},show:function(){D.removeClass(D.get("newGroupAction"),
"fn-hide");D.addClass(D.get("newGroupButton"),"fn-hide");D.removeClass(this.container,"fn-hide");D.addClass(D.query(".view-group-contanier")[0],"fn-hide")}});
AP.widget.contactsPayer=function(){var a=YAHOO.util.Dom,b=YAHOO.util.Event,e,g=null,f,d=function(d,e){var g=d.real_name==d.nick_name||"\u8bf7\u8f93\u5165\u8054\u7cfb\u4eba\u59d3\u540d"==d.nick_name?Element.create("li",{title:d.real_name+" "+d.account}):Element.create("li",{title:d.real_name+" ["+d.nick_name+"] "+d.account}),k=Element.create("input",{type:"checkbox",id:"contact_"+d.id+"_"+e,value:d.real_name+"|"+d.nick_name+"|"+d.account+"|"+d.id});D.addClass(k,"contact_"+d.id);real_name=8<d.real_name.len()?
d.real_name.brief(8)+"..":d.real_name;account=16<d.account.len()?d.account.brief(18)+"..":d.account;g.innerHTML='<label for="contact_'+d.id+"_"+e+'"><em>'+real_name+"</em> ("+account+")</label>";g.insertBefore(k,g.firstChild);b.addListener(g,"mouseover",function(){a.addClass(this,"hover")});b.addListener(g,"mouseout",function(){a.removeClass(this,"hover")});b.addListener(k,"click",f.addPerson,d,f);b.addListener(k,"click",_changeChooseStatus);b.addListener(k,"click",function(){h(this);D.get("customPerson").value=
"";var b=a.getElementsByClassName("fm-explain","div",D.get("customAddPerson-error").parentNode)[0];b.innerHTML="\u652f\u4ed8\u5b9d\u8d26\u6237\u540d\u662fEmail\u5730\u5740\u6216\u8005\u624b\u673a\u53f7\u7801\u3002";a.removeClass(b.parentNode,"fm-error");a.removeClass(D.get("customPerson").parentNode,"fm-hover")});return g},h=function(b){var d=a.getElementsByClassName(b.className);if(b.checked)for(b=0;b<d.length;b++)a.addClass(d[b].parentNode,"current"),d[b].checked="checked";else for(b=0;b<d.length;b++)a.removeClass(d[b].parentNode,
"current"),d[b].checked=""},j=function(b){var e=document.createElement("div"),f=document.createElement("ul");b.forEach(function(a,b){var e=d(a,b);f.appendChild(e)});a.addClass(e,"fn-overflow");e.appendChild(f);return e},k=function(a){var b=Element.create("h3");b.innerHTML='<span class="switch">'+a.name+"<em>("+a.user_num+")</em></span>";return b},l=function(a){e.length?e.forEach(function(b){var d=Element.create("div"),e=k(b),b=j(b.users);D.addClass(d,"com-mycontacts-group");d.appendChild(e);d.appendChild(b);
d.appendChild(n());a.appendChild(d)},this):D.get("myContacts").innerHTML='<div class="com-mycontacts-empty">\u60a8\u8fd8\u6ca1\u6709\u8054\u7cfb\u4eba\uff0c\u8bf7\u76f4\u63a5\u624b\u52a8\u8f93\u5165\u3002</div>'};_changeChooseStatus=function(){for(var d=this.parentNode.parentNode.parentNode.parentNode,e=0,f=d.getElementsByTagName("input"),d=a.getElementsByClassName("action","div",d)[0].getElementsByTagName("a")[0],h=0;h<f.length;h++)f[h].checked&&(e+=1);e==f.length?(d.innerHTML="\u53d6\u6d88\u5168\u9009",
b.removeListener(d,"click"),b.addListener(d,"click",q)):(d.innerHTML="\u5168\u9009",b.removeListener(d,"click"),b.addListener(d,"click",o))};var n=function(){var a=Element.create("div"),d=Element.create("a",{href:"javascript:void(0);"});d.innerHTML="\u5168\u9009";D.addClass(a,"action");b.addListener(d,"click",o);a.appendChild(d);return a},o=function(){D.get("customPerson")&&(D.get("customPerson").value="");if(!(30<=_payment_obj.getUsersLen())){m(this);b.removeListener(this,"click");b.addListener(this,
"click",q);for(var a=this.parentNode.parentNode.getElementsByTagName("input"),d=0;d<a.length&&!(30<=_payment_obj.getUsersLen());d++){var e={real_name:a[d].value.split("|")[0],nick_name:a[d].value.split("|")[1],account:a[d].value.split("|")[2],id:a[d].value.split("|")[3]};a[d].checked="checked";h(a[d]);_payment_obj.addPerson("",e,!0)}}},q=function(a){m(this);b.removeListener(this,"click");b.addListener(this,"click",o);for(var d=this.parentNode.parentNode.getElementsByTagName("input"),e=0;e<d.length;e++)if(d[e].checked){var f=
D.get("user_"+d[e].value.split("|")[3]);_payment_obj.deletePerson(a,f)}},m=function(a){"\u5168\u9009"==a.innerHTML?a.innerHTML="\u53d6\u6d88\u5168\u9009":a.innerHTML="\u5168\u9009"},r=function(){a.getElementsByClassName("tab-node").forEach(function(d){b.addListener(d,"click",function(){a.hasClass(d,"current")||t(d,"current")},d)})},t=function(b,d){a.getElementsByClassName("tab-node").forEach(function(b){c=document.getElementById(b.id.replace("Tab",""));a.hasClass(b,d)?a.removeClass(b,d):a.addClass(b,
d);a.hasClass(b,d)?a.removeClass(c,"fn-hide"):a.addClass(c,"fn-hide")})};return{init:function(a){f=a.call_obj;r()},appendContacts:function(a){var b=document.getElementById(a.append_box);e=a.contacts;a.has_group?l(b):b.appendChild(j(e))},markGiftUser:function(){d=function(d){var e=d.real_name==d.nick_name||"\u8bf7\u8f93\u5165\u8054\u7cfb\u4eba\u59d3\u540d"==d.nick_name?Element.create("li",{title:d.real_name+" "+d.account}):Element.create("li",{title:d.real_name+" ["+d.nick_name+"] "+d.account}),h=
Element.create("input",{type:"radio",id:"contact_"+d.id,name:"contact"});e.innerHTML='<label for="contact_'+d.id+'"><em>'+d.real_name+"</em> ("+d.account+")</label>";e.insertBefore(h,e.firstChild);b.addListener(h,"click",f.addPerson,d,f);b.addListener(e,"mouseover",function(){a.addClass(this,"hover")});b.addListener(e,"mouseout",function(){a.removeClass(this,"hover")});b.addListener(h,"click",function(){null!=g&&a.removeClass(g,"current");a.addClass(this.parentNode,"current");g=this.parentNode});
return e};l=function(a){e.forEach(function(b){var d=Element.create("div"),e=k(b),b=j(b.users);D.addClass(d,"com-mycontacts-group");d.appendChild(e);d.appendChild(b);a.appendChild(d)},this)}}}}();
AP.widget.CustomAddPerson=function(){var a=YAHOO.util.Dom,b=YAHOO.util.Event,e=null,g=null,f=null,d=null,h=null,j=null,k=function(){var a=D.get("customPerson").value;a.trim().length&&(d==a?o("\u4e0d\u80fd\u6dfb\u52a0\u81ea\u5df1\u7684\u5e10\u53f7"):l(a)?_payment_obj.addPerson("",l(a),!0):AP.ajax.asyncRequest("POST",e,n,"email="+a+"&row_no=1"))},l=function(a){for(var b=0;b<j.length;b++)for(var d=0;d<j[b].users.length;d++)if(j[b].users[d].account==a)return j[b].users[d];return!1},n={success:function(a){a=
a.responseText.split(",");0==a[1].length?o("\u8f93\u5165\u7684\u7528\u6237\u4e0d\u5b58\u5728"):(person={real_name:a[1],id:D.get("customPerson").value,account:D.get("customPerson").value,nick_name:""},_payment_obj.addPerson("",person,!0),D.get("customPerson").value="")}},o=function(b){var d=a.getElementsByClassName("fm-explain","div",D.get("customAddPerson-error").parentNode)[0];d.innerHTML=b;a.addClass(d.parentNode,"fm-error")},q=function(){D.get("customPerson").select();var b=a.getElementsByClassName("fm-explain",
"div",D.get("customAddPerson-error").parentNode)[0];b.innerHTML="\u652f\u4ed8\u5b9d\u8d26\u6237\u540d\u662fEmail\u5730\u5740\u6216\u8005\u624b\u673a\u53f7\u7801\u3002";a.removeClass(b.parentNode,"fm-error");a.removeClass(D.get("customPerson").parentNode,"fm-hover");a.addClass(D.get("customPerson").parentNode,"fm-focus")},m=function(b){for(var d=D.get("autoCompleteContainer").getElementsByTagName("ul")[0].getElementsByTagName("li"),e=[],f=0;f<d.length;f++)"none"!=a.getStyle(d[f],"display")&&e.push(d[f]);
for(f=0;f<e.length;f++)if(e[f]==b)return f};_uniqueResult=function(a){for(var b=0;b<a.length;b++)for(var d=b+1;d<a.length;d++)a[b].account==a[d].account&&a.remove(a[d]);return a};var r=function(a){var a=window.event||arguments.callee.caller.arguments[0],b=a.keyCode||a.which||a.charCode;String.fromCharCode(b);13==b&&(b=a||window.event,b.preventDefault?b.preventDefault():b.returnValue=!1)};return{init:function(a){e=a.request_url;_payment_obj=a.payment_obj;d=a.currentUser;j=a.datasource;g=D.get(a.require_field);
this.autoComplete(a.datasource);E.on(g,"focus",function(){D.removeClass(D.getAncestorByClassName(g,"fm-item"),"fm-error")});null!=e&&(f=D.get(a.trigger),b.on(f,"click",k,"",this),b.on(D.get("customPerson"),"focus",q),b.on(D.get("customPerson"),"keydown",r),b.on(D.get("customPerson"),"blur",function(){D.removeClass(this.parentNode,"fm-focus")}),b.on(D.get("customPerson"),"mouseover",function(){D.hasClass(this.parentNode,"fm-focus")||D.addClass(this.parentNode,"fm-hover")}),b.on(D.get("customPerson"),
"mouseout",function(){D.hasClass(this.parentNode,"fm-focus")||D.removeClass(this.parentNode,"fm-hover")}))},buildData:function(a){var b=[];a.forEach(function(a){a.users.forEach(function(a){var d={};real_name=8<a.real_name.len()?a.real_name.brief(8)+"..":a.real_name;account=16<a.account.len()?a.account.brief(16)+"..":a.account;d.context=real_name+" ("+account+")";d.id=a.id;d.account=a.account;d.nick_name=a.nick_name;d.real_name=a.real_name;b.push(d)})});return b},autoComplete:function(a){a=this.buildData(a);
a=new YAHOO.util.LocalDataSource(a);a.responseSchema={fields:["context","id","account","nick_name","real_name"]};YAHOO.widget.AutoComplete.prototype.filterResults=this.filterResults;YAHOO.widget.AutoComplete.prototype._onContainerClick=this.onContainerClick;YAHOO.widget.AutoComplete.prototype._updateValue=this.enterHandle;a=new YAHOO.widget.AutoComplete(g,"autoCompleteContainer",a);a.prehighlightClassName="yui-ac-prehighlight";a.useShadow=!1;a.animVert=!1;E.on(f,"click",function(){"\u8bf7\u8f93\u5165\u5bf9\u65b9\u7684\u652f\u4ed8\u5b9d\u8d26\u6237"==
this.value?this.value="":AP.fn.regExp.email.test(this.value)||alert("error2")})},enterHandle:function(a){if(!this.suppressInputUpdate){var b=this._elTextbox;"textarea"==b.type&&(b.scrollTop=b.scrollHeight);var d=b.value.length;this._selectText(b,d,d);this._elCurListItem=a;a=m(a);a=h[a];g.value="";_payment_obj.addPerson("",a,!0)}},onContainerClick:function(b,d){if(D.get("customAddPerson-error")){var e=a.getElementsByClassName("fm-explain","div",D.get("customAddPerson-error").parentNode)[0];e.innerHTML=
"\u652f\u4ed8\u5b9d\u8d26\u6237\u540d\u662fEmail\u5730\u5740\u6216\u8005\u624b\u673a\u53f7\u7801\u3002";a.removeClass(e.parentNode,"fm-error")}for(var e=YAHOO.util.Event.getTarget(b),f=e.nodeName.toLowerCase(),k=m(e),k=h[k];e&&"table"!=f;){switch(f){case "body":return;case "li":d._toggleHighlight(e,"to");d._selectItem(e);g.value="";_payment_obj.addPerson("",k,!0);return}(e=e.parentNode)&&(f=e.nodeName.toLowerCase())}},filterResults:function(a,b,d,e){if(a&&""!==a){for(var d=YAHOO.widget.AutoComplete._cloneObject(d),
f=e.scope,b=d.results,e=[],g=this.queryMatchCase||f.queryMatchCase,f=this.queryMatchContains||f.queryMatchContains,k=2;k<this.responseSchema.fields.length;k++)for(var j=b.length-1;0<=j;j--){var m=b[j],l=null;YAHOO.lang.isString(m)?l=m:YAHOO.lang.isArray(m)?l=m[0]:this.responseSchema.fields?l=m[this.responseSchema.fields[k].key||this.responseSchema.fields[k]]:this.key&&(l=m[this.key]);YAHOO.lang.isString(l)&&(l=g?l.indexOf(decodeURIComponent(a)):l.toLowerCase().indexOf(decodeURIComponent(a).toLowerCase()),
(!f&&0===l||f&&-1<l)&&e.unshift(m))}d.results=_uniqueResult(e);h=_uniqueResult(e)}return d}}}();
AP.widget.nickname=function(a){function b(){h.value=h.value.trim();showElement([h,j,k],!1);var b=new AP.core.api("user/contacts/editNickName",{onAPISuccess:q,onAPIFailure:o,method:"POST"},this),d=D.query(".J_item",h.parentNode.parentNode.parentNode)[0].id.replace("contacts_item_","");h.value=h.value.substr(0,10);b.call({nickName:h.value,crmUserId:d});showElement(a);D.removeClass(a.parentNode,"modify")}var e=a.parentNode;"SPAN"==e.nodeName&&(e=a.parentNode.parentNode);var g=D.getElementsBy(function(a){return D.hasClass(a,
"truename")},"span",e)[0],f=D.getElementsBy(function(a){return D.hasClass(a,"mark")},"span",e)[0],d=D.getElementsBy(function(a){return D.hasClass(a,"nickname")},"span",e)[0],h=D.getElementsBy(function(a){return D.hasClass(a,"input")},"",e)[0],j=D.getElementsBy(function(a){return D.hasClass(a,"save")},"",e)[0],k=D.getElementsBy(function(a){return D.hasClass(a,"cancel")},"",e)[0],l=D.hasClass(a,"addNickname")?a:null,n=D.hasClass(a,"modifyNickname")?a:null;D.query("#myContacts li").forEach(function(a){E.on(a,
"mouseover",function(b){target=E.getTarget(b);b=D.query("input",a);b.length&&(b=D.query("input",a)[0]);if(D.query(".addNickname",a).length&&D.hasClass(b,"fn-hide")){D.removeClass(D.query(".addNickname",a)[0],"fn-hide");D.removeClass(D.query(".delete",a)[0],"fn-hide")}else D.addClass(D.query(".addNickname",a)[0],"fn-hide");if(D.query(".modifyNickname",a).length&&D.hasClass(b,"fn-hide")){D.removeClass(D.query(".delete",a)[0],"fn-hide");D.removeClass(D.query(".modifyNickname",a)[0],"fn-hide")}else D.addClass(D.query(".modifyNickname",
a)[0],"fn-hide")},a,this);E.on(a,"mouseout",function(b){target=E.getTarget(b);if(D.query(".addNickname",a).length){D.addClass(D.query(".delete",a)[0],"fn-hide");D.addClass(D.query(".addNickname",a)[0],"fn-hide")}if(D.query(".modifyNickname",a).length){D.addClass(D.query(".delete",a)[0],"fn-hide");D.addClass(D.query(".modifyNickname",a)[0],"fn-hide")}},"",this)});E.addListener(a,"click",function(b){showElement([h,j,k]);showElement(a,false);D.addClass(a.parentNode,"modify");if(d){showElement(d,false);
showElement(f,false);h.value=h.value.trim().length>10?h.value.trim().replace("...",""):d.innerHTML.trim().unescapeHTML()}else h.value="";D.addClass(h.parentNode,"fm-focus");h.select();E.preventDefault(b);E.stopEvent(b)});var o=function(a,b){showElement([h,j,k],false);showElement(d);showElement(f);showElement(n?n:l);E.preventDefault(a);D.removeClass(k.parentNode,"modify");b&&new AP.widget.errorXbox({error_info:b[0].msg,url_info:'<a href="/user/contacts/index.htm">\u8fd4\u56de\u6211\u7684\u8054\u7cfb\u4eba </a>'})};
E.addListener(j,"click",function(){b()});E.on(h,"keydown",function(a){if(a.keyCode==13){b();E.stopEvent(a);h.blur()}});var q=function(){if(d==null)var a="";else{a=d.innerHTML;h.value==d.innerHTML&&(a="")}if(h.value!=""&&h.value!=a){if(n)d.innerHTML=h.value.escapeHTML();else{f=Element.create("span");D.addClass(d,"mark");f.innerHTML="&nbsp;-&nbsp;";D.insertAfter(f,g);d=Element.create("span");D.addClass(d,"nickname");d.innerHTML=h.value.escapeHTML();D.insertAfter(d,f);n=l;l=null;D.replaceClass(n,"addNickname",
"modifyNickname");n.innerHTML="[\u4fee\u6539\u6635\u79f0]"}showElement(d);showElement(f)}else{log("1");if(n){l=n;n=null;D.replaceClass(l,"modifyNickname","addNickname");l.innerHTML="[\u6dfb\u52a0\u6635\u79f0]";e.removeChild(d);e.removeChild(f);f=d=null}h.value=""}};E.addListener(k,"click",o)};
AP.widget.autoScroll=function(a,b,e,g){this.obj=document.getElementById(a);this.box=document.getElementById(b);this.style=this.obj.style;this.defaultHeight=g;this.scrollUp=doScrollUp;this.stopScroll=!1;this.obj.innerHTML+=this.obj.innerHTML;this.curLineHeight=0;this.lineHeight=e;this.curStopTime=0;this.stopTime=300;this.speed=10;this.style.marginTop=e+"px";this.object=a+"Object";eval(this.object+"=this");setInterval(this.object+".scrollUp()",10);this.obj.onmouseover=new Function(this.object+".stopScroll=true");
this.obj.onmouseout=new Function(this.object+".stopScroll=false")};function doScrollUp(){!0!=this.stopScroll&&(this.curLineHeight>=this.lineHeight?(this.curStopTime+=1,this.curStopTime>=this.stopTime&&(this.curStopTime=this.curLineHeight=0)):(this.curLineHeight+=10,this.style.marginTop=parseInt(this.style.marginTop)-10+"px",-parseInt(this.style.marginTop)>=this.defaultHeight&&(this.style.marginTop=0)))}
AP.widget.autoTab=function(){var a=[],b=[],e=!1,g=0,f,d,h,j=function(d){if(d.innerHTML)for(var e=0;e<a.length;e++)if(a[e]==d){d=e;break}D.removeClass(a[g],"current");AP.widget.xTab.hide(b[g]);D.addClass(a[d],"current");AP.widget.xTab.show(b[d]);g=d};return{setAutoKey:function(a){e=a},init:function(e){h=e||{};if(!h.name||!h.mainId||!h.menuId||!h.contentId)return!1;h.defaultTab?g=h.defaultTab:h.defaultTab=0;h.timer||(h.timer=5E3);h.delay||(h.delay=50);D.get(h.mainId).onmouseover=D.get(h.mainId).onfocus=
function(){eval(h.name+".setAutoKey(true)")};D.get(h.mainId).onmouseout=function(){eval(h.name+".setAutoKey(false)")};for(var j=D.get(h.menuId),e=D.get(h.contentId),n=0;n<j.childNodes.length;n++)1===j.childNodes[n].nodeType&&(D.removeClass(j.childNodes[n],"current"),j.childNodes[n].onmouseover=j.childNodes[n].onfocus=function(){f=this;d=setTimeout(h.name+".switchTo()",h.delay)},j.childNodes[n].onmouseout=function(){clearTimeout(d)},a[a.length]=j.childNodes[n]);for(j=0;j<e.childNodes.length;j++)1===
e.childNodes[j].nodeType&&(AP.widget.xTab.hide(e.childNodes[j]),b[b.length]=e.childNodes[j]);D.addClass(a[h.defaultTab],"current");AP.widget.xTab.show(b[h.defaultTab]);setInterval(h.name+".autoSwitch()",h.timer);return!0},autoSwitch:function(){if(e)return!1;j((g+1)%a.length);return!0},switchTo:function(){j(f)}}};
AP.widget.dropDown=new AP.Class({initialize:function(a,b){this.targets=a;this.options=this.setOptions(b);this.tmp=null;this.tag=!1;this.targets.forEach(function(a){this.bindEvents(a,this.getDrop(a))},this);this.onTargetClickEvent=new U.CustomEvent("onTargetClickEvent");this.onHiddenClickEvent=new U.CustomEvent("onhiddenEvent");this.onTargetClickEvent.subscribe(this.options.targetClick,this,!0);this.onHiddenClickEvent.subscribe(this.options.hideEvent,this,!0)},setOptions:function(a){return AP.hashExtend({isposition:!1,
offset:[0,0],styles:{},targetClick:function(){},hideEvent:function(){},mousehandle:!1,outcontent:!1,iframe:!1},a||{})},getDrop:function(a){if(this.options.outcontent){if(D.get("J_"+a.id+"_Box"))return D.get("J_"+a.id+"_Box");if(D.get(a.id+"Extend")){var b=D.get(a.id+"Extend"),e=b.cloneNode(!0);e.id="J_"+a.id+"_Box";b.parentNode.removeChild(b);document.body.appendChild(e);return e}throw"function getDrop not retrun any dropbox";}return D.get(a.id+"Extend")},bindEvents:function(a,b){this.options.mousehandle?
(E.on(a,"mouseover",this.show,a,this),E.on(a,"mouseout",this.hide,b,this)):(E.on(a,"click",this.taggleShow,a,this),E.on(a,"mouseover",this.setTagTrue,a,this),E.on(a,"mouseout",this.setTagFalse,a,this),E.on(b,"mouseover",this.setTagTrue,b,this),E.on(b,"mouseout",this.setTagFalse,b,this),E.on(document.body,"click",this.bodyClick,b,this))},bodyClick:function(a,b){this.tag||this.hide(a,b)},setTagTrue:function(){this.tag=!0},setTagFalse:function(){this.tag=!1},taggleShow:function(a,b){D.hasClass(this.getDrop(b),
"fn-hide")?this.show(!1,b):this.hide(!1,this.getDrop(b));E.preventDefault(a)},show:function(a,b){var e=this.getDrop(b);this.current_target=b;this.tmp&&this.hide(a,this.tmp);this.tmp=e;this.options.isposition&&(this.setPosition(this.current_target,e),E.on(window,"resize",function(){this.setPosition(this.current_target,e)},"",this));D.removeClass(e,"fn-hide");AP.env.browser.msie6&&this.options.iframe&&this.iframeCfg(e);this.onTargetClickEvent.fire(this.current_target)},iframeCfg:function(a){if(!D.query("iframe",
a).length){var b=Element.create("iframe");b.src="javascript:false;";var e=D.getStyle(a,"width"),g=D.getStyle(a.firstChild,"height");D.setStyle(b,"opacity","0");D.setStyle(b,"width",e);D.setStyle(b,"height",g);a.appendChild(b)}},setPosition:function(a,b){D.setStyles(b,{position:"absolute","z-index":"900"});D.setStyles(b,this.options.styles);var e=D.getRegion(a);D.setStyles(b,{left:e.left+this.options.offset[0]+"px",top:e.bottom+this.options.offset[1]+"px"})},hide:function(a,b){D.addClass(b,"fn-hide");
this.onHiddenClickEvent.fire()}});
AP.widget.jointDropDown=AP.widget.dropDown.extend({initialize:function(a,b){this.extend_id=b.extend_id;this.parent(a,b)},getDrop:function(){return D.get(this.extend_id)},taggleShow:function(a,b){var e=this.getDrop(b);this.current_target=b;this.show(e);this.setPosition(b,e);E.preventDefault(a)},show:function(a){this.tmp&&this.hide(this.tmp);this.tmp=a;this.options.isposition&&(this.setPosition(this.current_target,a),E.on(window,"resize",function(){this.setPosition(this.current_target,a)},"",this));
this.onTargetClickEvent.fire(this.current_target,a)},bodyClick:function(){}});
AP.pk.pa.animDropDown=AP.widget.dropDown.extend({bindEvents:function(a,b){this.parent(a,b);this.options.mousehandle&&(E.on(this.options.animTarget,"mouseout",this.hide,b,this),E.on(this.options.animTarget,"mouseover",this.show,a,this))},setOptions:function(a){return AP.hashExtend({isposition:!1,offset:[0,0],styles:{},targetClick:function(){},hideEvent:function(){},mousehandle:!1,outcontent:!1,animTarget:D.get("J-nav-sub-life")},a||{})},show:function(a,b){this.hideTimer&&window.clearTimeout(this.hideTimer);
var e=this.getDrop(b);this.current_target=b;this.options.isposition&&(E.on(window,"resize",function(){this.setPosition(this.current_target,e)},"",this),this.setPosition(this.current_target,e));D.removeClass(e,"fn-hide");this.dropboxOffsetHeight||(this.dropboxOffsetHeight=e.offsetHeight);(new YAHOO.util.Anim(this.options.animTarget,{top:{to:0}},0.3,YAHOO.util.Easing.easeNone)).animate();this.onTargetClickEvent.fire(this.current_target)},hide:function(a,b){D.get(b.id.replace("Extend",""));var e=new YAHOO.util.Anim(this.options.animTarget,
{top:{to:-this.dropboxOffsetHeight}},0.3,YAHOO.util.Easing.easeNone);this.hideTimer&&window.clearTimeout(this.hideTimer);this.hideTimer=window.setTimeout(function(){e.animate()},300);var g=this;e.onComplete.subscribe(function(){parseInt(g.options.animTarget.style.top)==-g.dropboxOffsetHeight&&(D.addClass(b,"fn-hide"),g.onHiddenClickEvent.fire())})},setPosition:function(a,b){D.setStyles(b,{position:"absolute","z-index":"900"});D.setStyles(b,this.options.styles);var e=D.getRegion(a);AP.fn.browser.msie?
D.setStyles(b,{left:e.left+this.options.offset[0]-2+"px",top:e.bottom+this.options.offset[1]-2+"px"}):D.setStyles(b,{left:e.left+this.options.offset[0]+"px",top:e.bottom+this.options.offset[1]+"px"})}});
AP.widget.tipdone=new AP.Class({setOptions:function(a){return AP.hashExtend({timeout:5},a||{})},initialize:function(a){this.options=this.setOptions(a)},remove:function(){var a=D.query(".tip-done")[0];a&&a.parentNode.removeChild(a)},show:function(a){this.remove();a=this.createDom(a);D.setStyle(a,"left",(document.documentElement.clientWidth-a.offsetWidth)/2+"px");this.position(a);this.scollChange(a);this.timeout&&clearTimeout(this.timeout);this.timeout=setTimeout(this.remove,5E3)},scollChange:function(a){E.on(window,
"scroll",function(){this.position(a)},"",this)},position:function(a){D.setStyle(a,"top",document.documentElement.scrollTop+"px")},getTip:function(){return D.query(".tip-done")[0]},createDom:function(a){html='<div class="container">'+a+"</div>";return Element.create("div",{innerHTML:html,appendTo:document.body,"class":"tip-done"})}});
AP.widget.combo=function(){var a=function(a){a=D.get(a);this.value=(document.all?a.getAttributeNode("value").specified:a.hasAttribute("value"))?a.value:a.text;this.text=a.text;this.url=a.getAttribute(b.linkAttributeName);this.selected=a.selected;this.el=a},b={linkAttributeName:"data-link",comboClass:"com-popmenu",titleClass:"com-popmenu-arrow",hiddenClass:"fn-hide",activateEvent:"click"},e=[],g,f=0,d=function(){D.addClass(b.transform,b.hiddenClass);for(var d=0;d<b.transform.options.length;d++)e[d]=
new a(b.transform.options[d]),e[d].selected&&(f=d);g=document.createElement("div");D.addClass(g,b.comboClass);var j=document.createElement("a");D.addClass(j,b.titleClass);j.innerHTML=b.title;var k=document.createElement("ul");D.addClass(k,b.hiddenClass);for(d=0;d<e.length;d++)k.innerHTML+='<li><a href="'+(e[d].url?e[d].url:"#")+'" value="'+e[d].value+'">'+e[d].text+"</a></li>";g.appendChild(j);g.appendChild(k);E.on(j,b.activateEvent,function(a){D.removeClass(k,b.hiddenClass);E.preventDefault(a)});
E.on([k,j],"mouseover",function(){AP.cache._mouseout_=!1});E.on([k,j],"mouseout",function(){AP.cache._mouseout_=!0;var a=this==j?k:this;setTimeout(function(){AP.cache._mouseout_&&D.addClass(a,b.hiddenClass)},600)});D.getElementsBy(function(){return!0},"a",k,function(a){E.on(a,"click",function(d){for(var f=0;f<e.length;f++)if(e[f].text==a.innerHTML){b.transform.options[f].selected=!0;if(e[f].url)window.location.href=e[f].url;else if(b.onselect)b.onselect(e[f]);D.addClass(k,b.hiddenClass);break}E.preventDefault(d)})});
if(b.onselect)b.onselect(e[f])};return{init:function(a){var a=a||{},e;for(e in a)b[e]=a[e];if(!b.transform)return!1;b.transform=D.get(b.transform);b.title=b.title?b.title:b.transform.getAttribute("title");b.wrapMethod?g=b.wrapMethod.call(this,b):d();D.insertBefore(g,b.transform);if(b.onwrap)b.onwrap(g);return!0},getCombo:function(){return g}}};
AP.pk.pa.counter=function(a){var b=this,e=[],g;this.type=["sms","phone","email"];this.btnDisable="btn-normal-disabled";this.btnAble="btn-normal";this.sec=AP.cache.countdown=60;this.count=a.count||60;this.action=a.action||!1;this.text={sms:["\u91cd\u53d1\u77ed\u4fe1\u6821\u9a8c\u7801","\u91cd\u65b0\u83b7\u53d6\u77ed\u4fe1"],phone:["\u8bed\u97f3\u83b7\u53d6\u6821\u9a8c\u7801","\u4f7f\u7528\u8bed\u97f3\u83b7\u53d6","\u514d\u8d39\u8bed\u97f3\u83b7\u53d6\u6821\u9a8c\u7801"],email:["\u70b9\u51fb\u91cd\u65b0\u53d1\u9001\u90ae\u4ef6",
"\u91cd\u65b0\u53d1\u9001\u90ae\u4ef6"]};this.setMobile=function(a){this.mobilePhone=a};this.initType=function(){this.type.forEach(function(b){a.hasOwnProperty(b)&&e.push(b)});return e};this.setCount=function(a){b.sec=AP.cache.countdown=a};this.encode=function(a){return!/^([0-9]+)[0-9]{4}([0-9]{4})/g.test(a)?a:a.replace(/^([0-9]+)[0-9]{4}([0-9]{4})/g,"$1****$2")};this.getLink=function(a){return 1==parseInt(a)?'\uff08<a href="/user/mobile/modifyMobile.htm">\u4fee\u6539\u53f7\u7801</a>\uff09':0==parseInt(a)?
'\uff08<a href="/user/mobile/bindMobile.htm">\u4fee\u6539\u53f7\u7801</a>\uff09':""};this.updateText=function(b){var d;"phone"===b?d='<p class="t-explain">\u652f\u4ed8\u5b9d\u5411\u60a8\u7684\u624b\u673a\uff1a'+this.encode(this.mobilePhone)+(a.noChangeLink?"":this.getLink(a.isBind))+'\u62e8\u6253\u7535\u8bdd\u5e76\u64ad\u62a5\u6821\u9a8c\u7801\u3002<p class="t-explain"><em>\u6765\u7535\u53f7\u7801\uff1a057126883721\uff0c057185020555\u3002</em>\u5982\u679c2\u5206\u949f\u5185\u6ca1\u63a5\u5230\u8bed\u97f3\u6821\u9a8c\u7801\u7535\u8bdd\uff0c\u8bf7\u70b9\u51fb\u6309\u94ae\u91cd\u65b0\u83b7\u53d6\u3002</p>':
"sms"===b?d='<p class="t-explain"><em>6\u4f4d\u6570\u5b57\u6821\u9a8c\u7801\u77ed\u4fe1</em>\u5df2\u7ecf\u514d\u8d39\u53d1\u9001\u5230\u60a8\u7684\u624b\u673a\uff1a'+this.encode(this.mobilePhone)+(a.noChangeLink?"":this.getLink(a.isBind))+'\u3002</p><p class="t-explain">\u5982\u679c1\u5206\u949f\u5185\u6ca1\u6709\u6536\u5230\u6821\u9a8c\u7801\u77ed\u4fe1\uff0c\u8bf7\u70b9\u51fb\u6309\u94ae\u91cd\u65b0\u83b7\u53d6\u3002</p>':"email"===b&&(d='<p class="t-explain">\u8bf7\u8fdb\u5165\u90ae\u7bb1\u67e5\u6536\u90ae\u4ef6\uff0c\u82e5\u65e0\u6cd5\u6536\u5230\u90ae\u4ef6\uff0c\u8bf7\u70b9\u51fb\u91cd\u65b0\u53d1\u9001\u90ae\u4ef6\u3002<a href="emailChange.htm">\u4fee\u6539Email</a></p>');
D.get(a.txtId).innerHTML=a.text||d};this.countdown=function(e){null!==this.sec&&(0===this.sec?(this.countDownUI(e,!1),D.get(a.txtId).innerHTML=g,D.addClass(D.get(a[e]+"-notice"),"fn-hide"),this.sec=AP.cache.countdown):(this.countDownUI(e,!0),this.sec--,clearTimeout(AP.cache.countTimer),AP.cache.countTimer=setTimeout(function(){b.countdown(e)},1E3)))};this.countDownUI=function(f,d){d=!0===d||!1;e.forEach(function(e){var f=D.get(a[e]);f.parentNode.className=d?b.btnDisable:b.btnAble;f.disabled=d;f.value=
d?"\uff08"+b.sec+"\u79d2\u540e\uff09"+b.text[e][1]:b.text[e][0]})};this.request=function(e){var d="",h,e=e+"-"+(a.status||"");switch(e){case "email-":d="user/loginName/resendEmail";h={resendType:a.emailType};break;case "email-emailChangeActiveOnSelfhelpprod":d="selfhelp/loginName/resendEmail";h={resendType:a.emailType};break;case "email-activate":d="user/reg/resendEmailToActivate";h={email:a.emailAddress};break;case "phone-bindMobile":d="user/mobile/resendIvrAckCodeToBind";h={mobilePhone:a.mobilePhone};
break;case "phone-unbindMobile":d="user/mobile/resendIvrAckCodeToUnBind";h={mobilePhone:a.mobilePhone};break;case "sms-activate":d="user/reg/resendSmsAckCodeToActivate";h={mobilePhone:a.mobilePhone};break;case "sms-bindMobile":d="user/mobile/resendSmsAckCodeToBind";h={mobilePhone:a.mobilePhone};break;case "sms-unbindMobile":d="user/mobile/resendSmsAckCodeToUnBind";h={mobilePhone:a.mobilePhone};break;case "sms-openMobileSwitch":d="user/mobile/resendSmsAckCodeOpenMobileSwitch";h={businessType:a.businessType,
mobilePhone:a.mobilePhone};break;case "phone-openMobileSwitch":d="user/mobile/resendSmsAckCodeOpenMobileSwitchIVR";h={businessType:a.businessType,mobilePhone:a.mobilePhone};break;case "sms-modifyMobile":d="user/mobile/resendSmsAckCodeToModify";h={mobilePhone:a.mobilePhone};break;case "sms-newModifyMobile":d="user/mobile/resendSmsAckCodeToNewModify";h={mobilePhone:a.mobilePhone};break;case "sms-":d="user/mobile/resendSmsAckCode";h="undefined"==typeof a.smsParams?{businessType:a.businessType,businessId:a.businessId}:
{businessType:a.businessType,businessId:a.businessId,smsParams:a.smsParams};break;case "phone-":d="user/mobile/resendIvrAckCode";h={businessType:a.businessType,businessId:a.businessId};break;case "sms-revokeCert":d="cert/resendSmsAckCodeToRevoke";h={mobilePhone:a.mobilePhone};break;case "sms-updateCert":d="cert/resendSmsAckCodeToUpdate";h={mobilePhone:a.mobilePhone,AckCodeId:a.businessId};break;case "sms-scBindMobile":d="sc/mobile/resendSmsAckCodeToBind";h={mobilePhone:a.mobilePhone};break;case "phone-scBindMobile":d=
"sc/mobile/resendIvrAckCodeToBind";h={mobilePhone:a.mobilePhone};break;case "sms-stopConvoy":d="sc/mobile/resendSmsAckCodeToStopConvoy";h={mobilePhone:a.mobilePhone};break;case "sms-setConvoyLimit":d="sc/mobile/resendSmsAckCodeToSetConvoyLimit";h={mobilePhone:a.mobilePhone};break;case "phone-stopConvoy":d="sc/mobile/resendIvrAckCodeToStopConvoy";h={mobilePhone:a.mobilePhone};break;case "phone-setConvoyLimit":d="sc/mobile/resendIvrAckCodeToSetConvoyLimit";h={mobilePhone:a.mobilePhone};break;case "sms-sendSMS":d=
"sc/mobile/resendIvrAckCodeToStopConvoy";h={mobilePhone:b.mobilePhone};break;case "sms-revokeOtpByMobile":d="sc/mobile/reSendSmsAckCodeForRevokeOtp";h={mobilePhone:a.mobilePhone};break;case "sms-applyOtpMobile":d="sc/mobile/reSendSmsAckCodeForApplyOtp";h={mobilePhone:a.mobilePhone};break;case "sms-bindThirdMobile":d="sc/mobile/reSendSmsAckCodeForBindThird";h={mobilePhone:a.mobilePhone};break;case "sms-activateUkeyMobile":d="sc/mobile/reSendSmsAckCodeForActivateUkey";h={mobilePhone:a.mobilePhone};
break;case "sms-certBindMobile":d="sc/mobile/reSendSmsAckCodeForBindMobile";h={mobilePhone:a.mobilePhone};break;case "phone-certBindMobile":d="sc/mobile/reSendIvrAckCodeForBindMobile";h={mobilePhone:a.mobilePhone};break;case "sms-certApplyCert":d="sc/mobile/reSendSmsAckCodeForApplyCert";h={mobilePhone:a.mobilePhone};break;case "phone-certApplyCert":d="sc/mobile/reSendIvrAckCodeForApplyCert";h={mobilePhone:a.mobilePhone};break;case "sms-installByMobile":d="sc/mobile/reSendSmsAckCodeForInstallCert";
h={mobilePhone:a.mobilePhone};break;case "sms-revokeByMobile":d="sc/mobile/reSendSmsAckCodeForRevokeCert";h={mobilePhone:a.mobilePhone};break;case "sms-security":d="standard/payment/sendAckCodeSms";h={requestId:a.businessId};break;case "phone-security":d="standard/payment/sendAckCodeIvr";h={requestId:a.businessId};break;case "phone-loginFind":d="user/pwdFind/resendQVoiceAckCode";h={logonId:a.logonId};break;case "sms-loginFind":d="user/pwdFind/resendQSmsAckCode";h={logonId:a.logonId};break;case "phone-payFind":d=
"user/pwdFind/resendPVoiceAckCode";h={logonId:a.logonId};break;case "sms-payFind":d="user/pwdFind/resendPSmsAckCode";h={logonId:a.logonId};break;case "email-loginFind":d="user/pwdFind/resendQEmail";h={logonId:a.logonId,method:a.emailType,email:a.emailAddress};break;case "email-payFind":d="user/pwdFind/resendPEmail";h={logonId:a.logonId,method:a.emailType,email:a.emailAddress};break;case "sms-modifyEmailAcct":d="user/loginName/unlongin/changeEmailResendAckCode";h={logonId:a.logonId,mobilePhone:a.mobilePhone};
break;case "email-modifyEmailAcct":d="user/loginName/unlongin/changeEmailResendEmail";h={logonId:a.logonId};break;case "phone-loginFindSelfHelp":d="selfhelp/pwdFind/resendQVoiceAckCode";h={logonId:a.logonId};break;case "sms-loginFindSelfHelp":d="selfhelp/pwdFind/resendQSmsAckCode";h={logonId:a.logonId};break;case "phone-payFindSelfHelp":d="selfhelp/pwdFind/resendPVoiceAckCode";h={logonId:a.logonId};break;case "sms-payFindSelfHelp":d="selfhelp/pwdFind/resendPSmsAckCode";h={logonId:a.logonId};break;
case "email-loginFindSelfHelp":d="selfhelp/pwdFind/resendQEmail";h={logonId:a.logonId,method:a.emailType,email:a.emailAddress};break;case "email-payFindSelfHelp":d="selfhelp/pwdFind/resendPEmail";h={logonId:a.logonId,method:a.emailType,email:a.emailAddress};break;case "sms-modifyEmailAcctSelfHelp":d="selfhelp/loginName/unlongin/changeEmailResendAckCode";h={logonId:a.logonId,mobilePhone:a.mobilePhone};break;case "email-modifyEmailAcctSelfHelp":d="selfhelp/loginName/unlongin/changeEmailResendEmail";
h={logonId:a.logonId};break;case "sms-modifyEmailAcctOnSelfhelpprod":d="selfhelp/loginName/unlongin/changeEmailResendAckCode";h={logonId:a.logonId,mobilePhone:a.mobilePhone};break;case "email-modifyEmailAcctOnSelfhelpprod":d="selfhelp/loginName/unlongin/changeEmailResendEmail";h={logonId:a.logonId};break;case "sms-snsCheckCodeQ":d="sns/reSendCheckCode";h={mobile:a.mobilePhone,isSendAgain:"true"};break;case "phone-couponValiCode":d="coupon/mobile/resendIvrAckCode";h={mobilePhone:a.mobilePhone,businessId:a.businessId,
businessType:a.businessType,resultCode:a.resultCode};break;case "sms-couponValiCode":d="coupon/mobile/resendSmsAckCode";h={mobilePhone:a.mobilePhone,businessId:a.businessId,businessType:a.businessType,resultCode:a.resultCode};break;case "sms-lifeGetCheckCodeQ":d="life/mobile/getCheckCodeQ";h={mobile:a.mobilePhone};break;case "sms-aaCheckCodeQ":d="transfer/mobile/getCheckCodeQ";h={mobile:a.mobilePhone,isSendAgain:"true"};break;case "sms-fundpayCheckCode":d="trade/account/sendSMSCode";break;case "phone-fundpayCheckCode":d=
"trade/account/sendIVRCode";break;case "sms-airmng-security":d="/security/9002/900203/product.json";h={mobilePhone:a.mobilePhone,templateId:a.businessId};break;case "phone-airmng-security":d="/security/9002/900203/product.json";h={mobilePhone:a.mobilePhone,templateId:a.businessId};break;case "email-messageResendEmail":d="messager/channel/modifyEmail/resendEmail";h={};break;case "sms-morderprod":d="order/validateCode";h={action:"sendMobileValidateCode",mobile:a.mobilePhone};break;case "phone-morderprod":d=
"order/validateCode";h={action:"sendIvrValidateCode",mobile:a.mobilePhone};break;case "sms-authcenterQ":d="login/mobile/getCheckCodeQ";h={mobile:a.mobilePhone};break;case "sms-katongQReg":d="user/reg/resendSmsAckCodeToActivate";h={mobilePhone:a.mobilePhone};break;case "phone-katongQReg":d="user/reg/mobile/resendIvrAckCodeToActivate";h={mobilePhone:a.mobilePhone};break;case "sms-acCheckCodeQ":d="transfer/mobile/getAcCheckCodeQ";h={mobile:a.mobilePhone,isSendAgain:"true"};break;case "sms-directpay":d=
"directpay/mobile/getCheckCodeQ";h={mobile:a.mobilePhone,isSendAgain:"true"};break;case "sms-selfhelpTask":d="task/mobileChange/resendSmsAckCode";h={mobilePhone:a.mobilePhone,cardNo:a.businessId};break;case "phone-selfhelpTask":d="task/mobileChange/resendPhoneAckCode",h={mobilePhone:a.mobilePhone,cardNo:a.businessId}}var g=a.domain&&-1<a.domain.indexOf(".alipay.")?a.domain:AP.PageVar.app_domain;"undefined"!=typeof a.resend_ackcode_url&&(d=a.resend_ackcode_url,h=a.params,h.type=e,g="");d&&(new AP.core.api(d,
{api_url:g,method:"POST",cache:!1,format:"jsonp",onAPISuccess:function(){}},this)).call(h)};this.fireEvent=function(e,d){"phone"===d?b.setCount(120):b.setCount(60);if(a.beforeCountEvent&&!1==a.beforeCountEvent.call(b))return!1;b.countdown(a[d]);b.request(d);a.noUpdateText||b.updateText(d);D.get(a[d]+"-notice")&&D.addClass(a[d]+"-notice","fn-hide")};this.init=function(a){g=D.get(a.txtId)&&D.get(a.txtId).innerHTML||"";this.setMobile(a.mobilePhone);this.request=a.request||this.request;this.initType();
e.forEach(function(d){D.get(a[d]).disabled=!1;E.on(a[d],"click",b.fireEvent,d,this);"phone"===d&&(E.on(a[d],"mouseover",function(){D.removeClass(a[d]+"-notice","fn-hide")}),E.on(a[d],"mouseout",function(){D.addClass(a[d]+"-notice","fn-hide")}));if("sms"===d||"email"===d)b.setCount(60),(!a.auto||!1==a.auto)&&b.countdown(d)})};this.fire=function(a){["sms","phone","email"].has(a)&&b.countdown(a)};this.restart=function(f,d){this.sec=60;AP.cache.countdown=60;clearTimeout(AP.cache.countTimer);e.forEach(function(d){var e=
D.get(a[d]);e.parentNode.className=b.btnAble;e.disabled=!1;e.value=b.text[d][0]});b.fireEvent(f,d)};this.init(a)};
AP.widget.confirmBox=new AP.Class({initialize:function(a){this.widget=a.widget||D.get("deletebox");this.confirm=a.confirm||D.getElementsByClassName("confirm","input",this.widget)[0];this.cancel=a.cancel||D.getElementsByClassName("cancel","input",this.widget)[0];this.triggers=a.triggers||D.getElementsByClassName("delete");this.triggers.length||(this.triggers=[this.triggers]);this.positionAdjust=a.positionAdjust||[0,0];this.fireType=a.fireType||"click";a.preventDefault=a.preventDefault||!1;if(!a.preventDefault)try{this.triggers.forEach(function(b){E.on(b,
this.fireType,a.onCall||this.onCall,b,this)},this)}catch(b){E.on(this.triggers,this.fireType,a.onCall||this.onCall,"",this)}E.on(this.confirm,"click",a.onConfirm||this.onConfirm,this.data||"",this);E.on(this.cancel,"click",a.onCancel||this.onCancel,this.data||"",this)},showElement:function(a,b){b?D.removeClass(a,"fn-hide"):D.addClass(a,"fn-hide")},onConfirm:function(){this.showElement(this.widget,!1);this.currentDelete=null},onCancel:function(){this.showElement(this.widget,!1);this.currentDelete=
null},onCall:function(a,b,e){this.data=e||"";this.showElement(this.widget,!0);D.setXY(this.widget,this.getPosition(b));this.currentDelete=b;this.cancel.focus();E.preventDefault(a)},getPosition:function(a){return[D.getXY(a)[0]+this.positionAdjust[0],D.getXY(a)[1]+this.positionAdjust[1]]},addTrigger:function(a){a.forEach(function(a){E.on(a,this.fireType,this.onCall,a,this)},this)}});
AP.pk.pa.highlight=new AP.Class({setOptions:function(a){return AP.hashExtend({target:"faq",warnClass:"m-warn",iconClass:"m-cue",duartion:1,scrollPage:!0,autoShow:!0,originalColor:"#FFF"},a||{})},initialize:function(a){this._options=this.setOptions(a);this.icons=D.query("."+this._options.iconClass,D.get(this._options.target));this._options.autoShow&&this.show()},show:function(){this.animation()},animation:function(){var a=new YAHOO.util.ColorAnim(this._options.target,{backgroundColor:{to:"#FFFFA4"}},
this._options.duartion),b=new YAHOO.util.ColorAnim(this._options.target,{backgroundColor:{to:this._options.originalColor}},this._options.duartion);this.changeIcon();a.animate();a.onComplete.subscribe(function(){b.animate()});var e=this;b.onComplete.subscribe(function(){e.changeIcon("done")},e);this._options.scrollPage&&AP.util.scrollPage(this._options.target,1)},changeIcon:function(a){"done"==a?this.icons.forEach(function(a){D.replaceClass(a,this._options.warnClass,this._options.iconClass)},this):
this.icons.forEach(function(a){D.replaceClass(a,this._options.iconClass,this._options.warnClass)},this)}});
AP.pk.pa.searchBox=new AP.Class({setOptions:function(){return AP.hashExtend({textDefaultClass:"i-text-gray",textDefaultExplain:"data-explain"})},initialize:function(a,b){this.form=a;this.input=D.query("input[type='text']",a)[0];this.options=this.setOptions(b);this.defaultText=this.input.getAttribute(this.options.textDefaultExplain);this.bindEvents()},bindEvents:function(){this.blur();E.on(this.input,"focus",this.focus,"",this);E.on(this.input,"blur",this.blur,"",this);E.on(this.form,"submit",function(a){(""==
this.input.value.trim()||this.input.value.trim()==this.defaultText)&&E.preventDefault(a)},{},this)},focus:function(){this.input.value.trim()==this.defaultText&&(this.input.value="");D.removeClass(this.input,this.options.textDefaultClass)},blur:function(){if(""==this.input.value.trim()||this.input.value.trim()==this.defaultText)this.input.value=this.defaultText,D.addClass(this.input,this.options.textDefaultClass)}});
AP.widget.popNotice=new AP.Class({setOptions:function(a){return AP.hashExtend({pop_class:"pop-info",pop_id:"J_popContainer",message:"no message",click:!1,offset:[0,0],customEvent:!1,styles:{},onshow:function(){},onhide:function(){}},a||{})},initialize:function(a,b){this.options=this.setOptions(b);this.current_el=null;D.get("J_popContainer")?(this.pop=D.get("J_popContainer"),this.pop_b=D.get("J_popBottom")):(this.pop=this.getBuildDom(),this.pop_b=this.getBuildBottomEl());this.bodyBindEvent();this.setStyles(this.options.styles);
a&&this.bindEvents(a);this.targets=a;this.onShowEvent=new U.CustomEvent("onShowEvent");this.onHideEvent=new U.CustomEvent("onHideEvent");this.onShowEvent.subscribe(this.options.onshow,this,!0);this.onHideEvent.subscribe(this.options.onhide,this,!0)},bindEvents:function(a){this.options.customEvent||(a.forEach(function(a){if(this.options.click)E.on(a,"click",this.show,a,this);else E.on(a,"mouseover",this.show,a,this),E.on(a,"mouseout",this.mouseHiddenEvent,a,this)},this),this.options.click||(E.on(this.pop,
"mouseout",this.mouseHiddenEvent,"",this),E.on(this.pop_b,"mouseout",this.mouseHiddenEvent,"",this)))},mouseHiddenEvent:function(a){try{E.getTarget(a);var b=E.getRelatedTarget(a);if(D.query("*",this.pop).contains(b)||b==this.pop||b==this.current_el||b==this.pop_b)return}catch(e){}this.hide()},setPosition:function(a){var b=D.getRegion(this.pop),e=b.bottom-b.top,b=b.right-b.left,g=D.getRegion(a),a=g.left+this.options.offset[0],g=g.top-e-3;D.setStyles(this.pop_b,{height:e+5+"px",width:b+"px"});D.setXY(this.pop,
[a,g]);D.setXY(this.pop_b,[a,g])},show:function(a,b){this.current_el=b;null===D.get("J_popContainer")&&(this.pop=this.getBuildDom(),this.pop_b=this.getBuildBottomEl(),this.setStyles(this.options.styles));D.removeClass(this.pop,"fn-hide");D.removeClass(this.pop_b,"fn-hide");this.options.click||(E.on(this.pop,"mouseout",this.mouseHiddenEvent,"",this),E.on(this.pop_b,"mouseout",this.mouseHiddenEvent,"",this));this.innerMessage();this.setPosition(b);this.onShowEvent.fire({trigger:b,pop:this.pop})},innerMessage:function(){var a=
D.query(".pop_extend_txt",this.current_el).length?D.query(".pop_extend_txt",this.current_el)[0]:D.query(".pop_extend_txt",this.current_el.parentNode)[0],a=a?a.innerHTML:this.options.message;D.query(".container",this.pop)[0].innerHTML=a},bodyBindEvent:function(){E.on(document.body,"click",function(a){var b=E.getTarget(a),e=!1;D.query("*",this.pop).forEach(function(a){a==b&&(e=!0)});b.parentNode==this.pop||b==this.current_el||e||this.hide(a)},"",this)},hide:function(){if(this.options.click)D.addClass(this.pop,
"fn-hide"),D.addClass(this.pop_b,"fn-hide");else{try{this.pop.parentNode.removeChild(this.pop)}catch(a){}try{this.pop_b.parentNode.removeChild(this.pop_b)}catch(b){}}this.onHideEvent.fire()},setStyles:function(a){0<D.query(".container",this.pop).length&&D.setStyles(D.query(".container",this.pop)[0],a)},getBuildDom:function(){var a=Element.create("div",{innerHTML:'<div class="container"></div><div style="left: 20px;" class="angle"/>',appendTo:document.body,id:this.options.pop_id,"class":"fn-hide"});
D.addClass(a,this.options.pop_class);return a},getBuildBottomEl:function(){var a=Element.create("div",{appendTo:document.body,id:"J_popBottom","class":"fn-hide"});D.setStyles(a,{position:"absolute","z-index":"488"});return a}});
AP.widget.seniorPop=AP.widget.popNotice.extend({show:function(a,b,e){null===D.get("J_popContainer")&&(this.pop=this.getBuildDom(),this.pop_b=this.getBuildBottomEl(),this.setStyles(this.options.styles));D.removeClass(this.pop,"fn-hide");D.removeClass(this.pop_b,"fn-hide");this.current_el=b;e=e||{};e.hideAngle?this.hideAngle():this.showAngle();this.options.click||(E.on(this.pop,"mouseout",this.mouseHiddenEvent,"",this),E.on(this.pop_b,"mouseout",this.mouseHiddenEvent,"",this));this.innerMessage();this.setPosition(b,
e);this.onShowEvent.fire({trigger:b,pop:this.pop})},hideAngle:function(){D.addClass(D.query(".angle",this.pop)[0],"fn-hidden")},showAngle:function(){D.removeClass(D.query(".angle",this.pop)[0],"fn-hidden")},setPosition:function(a,b){var e=D.getRegion(this.pop),g=D.getRegion(a),e=b.center?this.remoteCenter(e):this.remoteXY(e,g);D.setXY(this.pop,e);D.setXY(this.pop_b,e)},remoteCenter:function(a){var b=a.bottom-a.top,a=a.right-a.left,e=D.getViewportWidth(),g=D.getViewportHeight();return[e/2-a/2,g/2-
b/2]},remoteXY:function(a,b){var e=a.bottom-a.top,g=a.right-a.left,f=b.left+this.options.offset[0],d=b.top-e-3;this.setStyles(this.options.styles);D.removeClass(D.query(".angle",this.pop)[0],"angle-top");D.setStyles(D.query(".angle",this.pop)[0],{left:"20px",right:"auto"});e>b.top-D.getDocumentScrollTop()&&(d=b.bottom+10,D.addClass(D.query(".angle",this.pop)[0],"angle-top"));f+g>D.getViewportWidth()&&(D.setStyles(D.query(".angle",this.pop)[0],{left:"auto",right:"20px"}),f=b.right-g-this.options.offset[0]);
D.setStyles(this.pop_b,{height:e+5+"px",width:g+"px"});return[f,d]}});
AP.widget.errorXbox=new AP.Class({initialize:function(a){this.error_info=a.error_info;this.url_info=a.url_info;this.xbox=new AP.widget.xBox({type:"dom",value:"#errorXbox",width:500,height:100});AP.cache.xnumber?AP.cache.xnumber++:AP.cache.xnumber=1;this.build()},build:function(){this.buildHTML();this.xbox.fire();this.getElements();this.buildClose();this.counter()},getElements:function(){this.xbox_container=D.get("errorXbox");this.close_el=D.get("J_xbox_colse");this.url_container=D.query(".n-explain",
this.xbox_container)[0]},buildClose:function(){E.on(this.close_el,"click",function(a){AP.widget.xBox.hide();E.preventDefault(a)},"",this)},counter:function(){if(!D.query("a",this.url_container).length){var a=this,b=10;a.close_el.setAttribute("xnumber",AP.cache.xnumber);window.setInterval(function(){b-=1;a.close_el.innerHTML=b+"\u79d2\u540e\u81ea\u52a8\u5173\u95ed";0>=b&&AP.cache.xnumber==parseInt(a.close_el.getAttribute("xnumber"))&&(AP.widget.xBox.hide(),b=10)},1E3)}},buildHTML:function(){var a=
D.get("errorXboxContainer");a&&a.parentNode.removeChild(a);var a=Element.create("div",{"class":"fn-hide",id:"errorXboxContainer"}),b;b='<div class="container-xbox" id="errorXbox"><div class="no-title"><a class="xbox-close-link" id="J_xbox_colse" href="#">\u5173\u95ed</a></div><div class="notice n-error-xbox"><h3>{error_info}</h3><p class="n-explain">{url_info}</p></div></div>'.replace("{error_info}",this.error_info);b=b.replace("{url_info}",this.url_info);a.innerHTML=b;document.body.appendChild(a)}});
AP.widget.Editable=new AP.Class({setOptions:function(a){return AP.hashExtend({edit_type:"input",edit_target:null,class_edit:"",class_cannel:"",class_focus:"",default_txt:"\u70b9\u51fb\u6dfb\u52a0\u5185\u5bb9",defalut_show:!0},a||{})},initialize:function(a,b){this.options=this.setOptions(b);this.bindTargetEvents(a);this.onSaveButtonClickEvent=new U.CustomEvent("onSaveButtonClickEvent");b.saveEvent&&this.onSaveButtonClickEvent.subscribe(b.saveEvent,this,!0)},bindTargetEvents:function(a){a.forEach(function(a){this.options.defalut_show?
a=D.query(".J_editable_target",a.parentNode)[0]:(E.on(a,"mouseover",this.onMouseOverEvent,a,this),E.on(a,"mouseout",this.onMouseOutEvent,a,this));E.on(a,"click",this.onClickEvent,a,this)},this)},onMouseOverEvent:function(a,b){if(this.options.edit_target){var e=this.getEditTarget(b);D.removeClass(e,"fn-hide")}else D.addClass(b,this.options.class_focus)},onMouseOutEvent:function(a,b){if(this.options.edit_target){var e=this.getEditTarget(b);D.addClass(e,"fn-hide")}else D.removeClass(b,this.options.class_focus)},
onClickEvent:function(a,b){this.current_target=b;var e=b.parentNode.getAttribute("rel");(this.options.edit_target&&D.hasClass(b,"J_editable_target")||!this.options.edit_target)&&this.showEditable(b);D.query("input[type=text]",b.parentNode.parentNode)[0].value=e;E.preventDefault(a)},onSaveEvent:function(a,b){this.onSaveButtonClickEvent.fire(b);E.preventDefault(a)},onCannelEvent:function(a,b){this.hideEditable(b);E.preventDefault(a)},getEditTarget:function(a){var b=D.query(".J_editable_target",a)[0];
b||(b=this.BuildTargetButton(),a.appendChild(b));return b},getEditableTarget:function(a){var b=a.parentNode.parentNode;D.hasClass(b,"J_editable")?a=a.parentNode:(a=D.query(".J_editable",b)[0])||(a=this.BuildEditableDom(b));return a},showEditable:function(a){var b=this.getEditableTarget(a);D.removeClass(b,"fn-hide");D.addClass(a.parentNode,"fn-hide");D.query("input[type=text]",b)[0].select()},hideEditable:function(a){var b=this.getEditableTarget(a),a=D.query(":first",a.parentNode.parentNode);D.removeClass(a,
"fn-hide");D.addClass(b,"fn-hide")},BuildEditableDom:function(a){var b=Element.create("span",{"class":"J_editable fn-hide"}),e=this.BuildEditInputDom(),g=this.BuildSaveButton(),f=this.BuildCannelButton();AP.widget.formInputStyle.init(e);b.appendChild(e);b.appendChild(g);b.appendChild(f);a.appendChild(b);return b},BuildEditInputDom:function(){var a=this.options.edit_type;return a=Element.create(a,{"class":"i-text",value:this.current_target.parentNode.getAttribute("rel"),type:"text",maxLength:"10"})},
BuildSaveButton:function(){var a=Element.create("input",{type:"button",value:"\u4fdd\u5b58","class":"btn-2cn"});E.on(a,"click",this.onSaveEvent,a,this);return a},BuildCannelButton:function(){var a=Element.create("a",{innerHTML:"\u53d6\u6d88",href:"#"});E.on(a,"click",this.onCannelEvent,a,this);return a},BuildTargetButton:function(){var a=Element.create("a",{innerHTML:this.options.edit_target,"class":"fn-hide J_editable_target",href:"#"});E.on(a,"click",this.onClickEvent,a,this);return a}});
AP.widget.reviewCardID=new AP.Class({setOptions:function(a){return AP.hashExtend({blurCustomEvent:function(){}},a||{})},initialize:function(a,b){this.targets=a;E.on(this.targets,"focus",this.focusEvent,"",this);E.on(this.targets,"blur",this.blurEvent,"",this);E.on(this.targets,"keyup",this.keyupEvent,"",this);a.forEach(function(a){this.getSplitCardID(a.value)},this);this.options=b||{};this.options=this.setOptions(this.options);this.blurCustomEvent=new U.CustomEvent("blurCustomEvent");this.blurCustomEvent.subscribe(this.options.blurCustomEvent,
this,!0);this.buidDom()},focusEvent:function(a){a=E.getTarget(a);this.createIframe(a);this.reviewCardID(a)},blurEvent:function(a){a=E.getTarget(a);a.value=this.getSplitCardID(a.value);this.hide();this.blurCustomEvent.fire(a)},keyupEvent:function(a){this.reviewCardID(E.getTarget(a))},reviewCardID:function(a){a.value.trimAll().length?(this.numberBox.innerHTML=this.getSplitCardID(a.value),this.show(a)):this.hide()},getSplitCardID:function(a){var a=a.trimAll().split(""),b="";a.forEach(function(a,g){b+=
a;0==(g+1)%4&&(b+=" ")});return b},setExplain:function(){return!1},position:function(a){var b=D.getRegion(this.container),a=D.getRegion(a);D.setXY(this.container,[a.left,a.top-(b.bottom-b.top)])},createIframe:function(a){if(!D.query("iframe",this.container).length){var b=Element.create("iframe");b.src="javascript:false;";var e=D.getRegion(a),a=e.right-e.left+"px",e=e.bottom-e.top+"px";D.setStyle(b,"opacity","0");D.setStyle(b,"width",a);D.setStyle(b,"height",e);D.setStyle(b,"position","absolute");
D.setStyle(b,"top","-5px");D.setStyle(b,"left","-5px");D.setStyle(b,"z-index","0");this.outBox.appendChild(b)}},show:function(a){D.removeClass(this.container,"fn-hide");this.position(a)},hide:function(){D.addClass(this.container,"fn-hide")},buidDom:function(){this.numberBox=this.getCreateNumberDom();this.explainBox=this.getCreateExplainDom();this.outBox=this.getCreateBoxDom();this.container=Element.create("div",{"class":"bank-card-review fn-hide"});this.outBox.appendChild(this.numberBox);this.container.appendChild(this.outBox);
D.setStyles(this.container,{position:"absolute"});document.body.appendChild(this.container)},getCreateBoxDom:function(){var a=Element.create("div");D.setStyles(a,{position:"relative"});return a},getCreateNumberDom:function(){var a=Element.create("div",{"class":"cardid"});D.setStyle(a,"font-size","18px");D.setStyle(a,"font-family","tahoma");return a},getCreateExplainDom:function(){return Element.create("div",{"class":"explain-info"})}});
AP.widget.formInputStyle=function(){var a=function(a){E.on(a,"focus",function(){D.removeClass(this.parentNode,"fm-hover");D.removeClass(this.parentNode,"fm-error");D.addClass(this.parentNode,"fm-focus")});E.on(a,"mouseover",function(){D.addClass(this.parentNode,"fm-hover")});E.on(a,"mouseout",function(){D.removeClass(this.parentNode,"fm-hover")});E.on(a,"blur",function(){D.removeClass(this.parentNode,"fm-hover");D.removeClass(this.parentNode,"fm-focus")})};return{init:function(b){a(b)}}}();
AP.widget.autoFontsize=new AP.Class({setOptions:function(a){return AP.hashExtend({minSize:12,target:D.query(".aside-amount em")[0],maxWidth:106},a||{})},initialize:function(a){this.options=this.setOptions(a);this.options.target.constructor==Array?this.options.target.forEach(function(a){this.resize(a)},this):this.resize(this.options.target)},resize:function(a){for(var b=parseInt(D.getStyle(a,"fontSize"));a.offsetWidth>this.options.maxWidth&&!(--b<this.options.minSize);)D.setStyle(a,"fontSize",b+"px");
this.resizeComplete()},resizeComplete:function(){}});
AP.pk.pa.asidePortrait=function(){function a(){D.removeClass(d.container,"fn-hide");d.ul.className="hover";d.pointer.className="ico-angleR";d.pointer.title="\u5c55\u5f00"}function b(a){("hover"==d.ul.className||!0==a)&&D.addClass(d.container,"fn-hide")}function e(){E.on(d.my,"mouseover",a);E.on([d.pointer,D.query("li",d.ul)],"click",function(a){"ico-angleR"==d.pointer.className?(D.removeClass(d.container,"fn-hide"),d.ul.className="expand",d.pointer.className="ico-angleL",d.pointer.title="\u5173\u95ed",
"undefined"!=typeof Tracker&&Tracker.click("aside-portrait-expand")):b(!0);E.stopEvent(a)});E.on(document.body,"click",function(){"ico-angleL"==d.pointer.className&&b(!0)});E.on([d.ul,d.pointer],"mouseout",function(){d.timer=setTimeout(b,100)});E.on([d.ul,d.pointer],"mouseover",function(){clearTimeout(d.timer)});if(2<D.query("li",d.ul).length)E.on(D.query("li",d.ul)[1],"click",g,{type:"old"})}function g(a,b){var e=D.get("JAsideMultiAccTrigger").getAttribute("data-host");(new AP.core.api("user/modiPortraitUrl",
{onAPISuccess:f,api_url:e,method:"POST",format:"jsonp"})).call({type:b.type});d.my.src=D.query("img",D.query("li",d.ul)[1])[0].src;E.preventDefault(a)}function f(a,b){var e=D.query("img",d.ul);e[0].src=AP.fn.url.imgTfs+"/"+b[0].cur;log(e[0].width,e[0].height);b[0].old?2==D.query("li",d.ul).length?(e=document.createElement("li"),e.innerHTML='<a href="#"><img height="54" width="54" alt="\u4e0a\u6b21\u5934\u50cf" src="'+AP.fn.url.imgTfs+"/"+b[0].old+'" /></a>',D.insertAfter(e,D.query("li",d.ul)[0]),
E.on(e,"click",g,{type:"old"})):e[1].src=AP.fn.url.imgTfs+"/"+b[0].old:3==D.query("li",d.ul).length&&d.ul.removeChild(D.query("li",d.ul)[1]);d.my.src=AP.fn.url.imgTfs+"/"+b[0].cur;D.query("img."+d.curUserPicClass,D.get("container")).forEach(function(a){a.src=AP.fn.url.imgTfs+"/"+b[0].cur})}var d;return{init:function(a){d=AP.hashExtend({my:D.get("J_portrait"),container:D.get("J_aside_portraits"),pointer:{},ul:D.query("ul",D.get("J_aside_portraits"))[0],timer:{},curUserPicClass:"J_portrait"},a||{});
d.my&&d.container&&(d.pointer=Element.create("span",{"class":"ico-angleR",title:"\u5c55\u5f00",appendTo:d.container}),e())},renew:function(){var a=D.get("JAsideMultiAccTrigger").getAttribute("data-host");(new AP.core.api("user/getPortraitUrl",{onAPISuccess:f,api_url:a,method:"POST",format:"jsonp"})).call({get:"all"})}}}();
AP.pk.pa.remindScene=function(){var a={listContainer:"J_asidemlist",totalNum:0,canDelTotalNum:0,totalPages:1,currentPage:1,onePage:10,pre:{},next:{}},b,e,g,f,d,h,j=function(a){var b=D.query("a",a)[0],d=D.query(".ico-del-aside",a)[0];E.on(a,"mouseover",function(a,b){D.addClass(b,"hover")},a);E.on(a,"mouseout",function(a,b){D.removeClass(b,"hover")},a);E.on(d,"click",k,a);if("REMIND"==b.type)E.on(b,"click",k,a)},k=function(a,b){var d=D.query(".ico-del-aside",b)[0].href.toQueryParams().delId,e=D.get("J_aside_acctname")?
D.get("J_aside_acctname").getAttribute("data-host"):AP.PageVar.app_domain;try{(new AP.core.api("home/statusbar/deleteRemindScene",{onAPISuccess:function(){l(b)},api_url:e,method:"POST",format:"jsonp"})).call({id:d})}catch(f){log(f)}"undefined"!=typeof Tracker&&Tracker.click("aside-reminddel");E.getTarget(a).type||E.stopEvent(a)},l=function(d){var e={height:{to:0},opacity:{to:0}};AP.fn.browser.msie&&(e={opacity:{to:0}});e=new YAHOO.util.Anim(d,e,0.3);e.animate();e.onComplete.subscribe(function(){a.canDelTotalNum--;
a.totalNum--;0==a.totalNum&&D.addClass(D.query(".aside-main",D.get("aside"))[0],"aside-notice-hide");log(a.totalNum,b.length);if(1<a.totalPages){var e=b.indexOf(d.parentNode.lastChild);e<a.totalNum&&d.parentNode.appendChild(b[e+1])}m();b.remove(d);d.parentNode.removeChild(d)})},n=function(){g=D.query("ul",D.get(a.listContainer))[0];D.addClass(g,"fn-hide");var e=D.query(".aside-page a",D.get("aside"));a.pre=e[0];a.next=e[1];E.on(a.pre,"click",function(b){o(a.currentPage-1);E.preventDefault(b)});E.on(a.next,
"click",function(b){o(a.currentPage+1);E.preventDefault(b)});D.removeClass(a.next,"fn-hide");d=document.createElement("ul");h=document.createElement("ul");f=Element.create("div",{style:{width:"500px"},appendTo:D.get(a.listContainer)});b.forEach(function(b,e){e<a.onePage&&d.appendChild(b)});f.appendChild(d);f.appendChild(h)},o=function(e){"undefined"!=typeof Tracker&&Tracker.click("aside-remindpage");e>a.currentPage&&(D.query("li",h).forEach(function(a){g.appendChild(a)}),b.forEach(function(b,d){parseInt(d/
a.onePage)==e-1&&h.appendChild(b)}),q("next"));e<a.currentPage&&(D.query("li",d).forEach(function(a){g.appendChild(a)}),b.forEach(function(b,f){parseInt(f/a.onePage)==e-1&&d.appendChild(b)}),q("pre"));a.currentPage=e},q=function(a){a=new YAHOO.util.Anim(f,"next"==a?{marginLeft:{from:0,to:-222}}:{marginLeft:{from:-222,to:0}},0.3,YAHOO.util.Easing.easeOut);a.animate();a.onComplete.subscribe(function(){m()})},m=function(){a.totalPages=Math.ceil(a.totalNum/a.onePage);1==a.totalPages&&a.currentPage<a.totalPages+
1?(D.removeClass(D.get(a.listContainer),"maxheight"),D.addClass([a.pre,a.next],"fn-hide")):1==a.currentPage?(D.addClass(a.pre,"fn-hide"),D.removeClass(a.next,"fn-hide")):a.currentPage>a.totalPages-1?(D.addClass(a.next,"fn-hide"),D.removeClass(a.pre,"fn-hide")):(D.removeClass(a.pre,"fn-hide"),D.removeClass(a.next,"fn-hide"));D.get("J_aside_current_page").innerHTML=a.currentPage;D.get("J_aside_total_page").innerHTML=a.totalPages};return{init:function(d){AP.fn.apply(a,d);D.get(a.listContainer)&&(b=D.query("li",
D.get(a.listContainer)),e=D.query("a.ico-del-aside",D.get(a.listContainer)),a.canDelTotalNum=e.length,a.totalNum=b.length,a.totalPages=Math.ceil(a.totalNum/a.onePage),D.get("J_aside_total_page").innerHTML=a.totalPages,b.forEach(function(a){j(a)}),1<a.totalPages&&n())},gotoPage:function(a){o(a)}}}();
AP.pk.pa.switchAcct=AP.widget.dropDown.extend({initialize:function(a,b){this.parent(a,b);this.acctListsDone=!1},getAcctListsDone:function(){new AP.widget.xBox({el:D.query(".aside-accounts li:not(.selected)"),type:"iframe",value:function(a){return a.firstChild.href+"&goto="+parent.location.href},width:400,height:224,modal:!0,hasHead:!1,fixed:!1,autoFitPosition:!1});this.acctListsDone=!0},getAcctLists:function(a){var b=this,e=D.get("JAsideMultiAccTrigger")?D.get("JAsideMultiAccTrigger").getAttribute("data-host"):
AP.PageVar.app_domain;(new AP.core.api("home/statusbar/getRelativeAccounts",{onAPISuccess:function(e,f){if("ok"==f[0].stat){for(var d=f[0].accts,h=D.query("li a",a)[0].href,j=0;j<d.length;j++)a.innerHTML+='<li><a title="'+d[j]+'" href="'+h+d[j]+'">'+AP.util.handleLongEmail(d[j],16,11)+"</a></li>";10<D.query("li",a).length&&D.addClass(a,"maxheight");E.on(D.query("li",a)[0],"click",function(a){E.preventDefault(a)});E.on(D.query("li",a),"click",function(){D.addClass(a,"fn-hide")});b.getAcctListsDone()}},
api_url:e,method:"POST",format:"jsonp"})).call()},bindEvents:function(a,b){this.parent(a,b);E.on(a,"click",function(){this.acctListsDone||this.getAcctLists(b);"undefined"!=typeof Tracker&&Tracker.click("aside-switchaccount")},b,this)}});AP.pk.pa.asideAmountFontsize=AP.widget.autoFontsize.extend({resizeComplete:function(){D.removeClass(D.query(".aside-amount",D.get("aside"))[0],"fn-hidden");"undefined"!=typeof Tracker&&Tracker.click("aside-amountresize")}});
AP.pk.pa.aside={initialize:function(){if((this.aside=D.get("aside"))&&D.hasClass(this.aside,"new-aside")){if(D.query(".aside-bar",D.get("aside"))[0]){this.asideBar=D.query(".aside-bar",D.get("aside"))[0];this.bindEvents();var a=D.query("dt",this.asideBar)[0];if(!AP.fn.browser.msie||""==a.innerHTML)a.innerHTML="\u67e5\u770b\u8d26\u6237\u4fe1\u606f";D.removeClass(a,"fn-hide");this.stat=0;this.asideRegion=D.getRegion(this.aside);this.pwSwitch("hide");this.asyncLoading=!1}this.loadAsideContainer();1<
this.asideContainer.length&&this.initComponents()}},sendTrack:function(a){"undefined"!=typeof Tracker&&Tracker.click(a)},loadAsideContainer:function(){this.asideContainer=D.query("#aside>div",D.get("content")).concat(D.query("#aside>iframe",D.get("content")))},endAsynLoading:function(){this.asyncLoading=!1},setCookie:function(a,b){var e=new Date;e.setTime(e.getTime()+1296E6);document.cookie=a+"="+escape(b)+";expires="+e.toGMTString()},getCookie:function(a){a=document.cookie.match(RegExp("(^| )"+a+
"=([^;]*)(;|$)"));return null!=a?unescape(a[2]):null},syncLoadCallback:function(a){var a=a.replace(/\r\n/gi,""),a=a.replace(/\n/gi,""),a=a.replace(/'/gi,'"'),b,e=-1<a.indexOf("iframe")?!1:!0;e?b=/(<div class=\"aside-head\".*)<\/div>.*<div class=\"aside-widget/gi:(b=/(<div class=\"aside-login\".*)<\/div>.*<div class=\"aside-widget/gi,D.removeClass(this.aside,"new-aside"));if(b=b.exec(a)){var g=document.createElement("div");g.className="J-asyncload hasSecurityLevel aside-main "+(-1<a.indexOf("aside-notice-hide")?
" aside-notice-hide":"");g.innerHTML=b[1];D.insertBefore(g,this.asideBar);this.loadAsideContainer();e&&this.initComponents();this.expandAnim()}this.endAsynLoading()},syncLoadAJAX:function(){this.asyncLoading=!0;var a=this;YAHOO.util.Connect.asyncRequest("GET","/tile/service/home:aside.tile?isExpandAside=true&referPage="+location.href+"&r="+ +new Date,{success:function(b){a.syncLoadCallback.call(a,b.responseText)}})},syncLoadJSONP:function(){this.asyncLoading=!0;var a=this;(new AP.core.api("/json/remoteTile/home:newAside.json?referPage="+
location.href,{onAPISuccess:function(b,e){a.syncLoadCallback.call(a,e[0].jrtContent)},api_url:araleConfig.asideServer,method:"GET",format:"jsonp"})).call()},asyncLoad:function(){"undefined"!=typeof araleConfig&&araleConfig.asideServer?this.syncLoadJSONP():this.syncLoadAJAX()},bindEvents:function(){E.on(this.asideBar,"click",function(){D.query(".aside-main",D.get("aside")).length||D.query(".J-asyncload",D.get("aside")).length||this.asyncLoading?this.expandAnim():this.asyncLoad()},{},this);E.on(document.body,
"click",function(a){1==this.stat&&this.checkFoldable(a)&&(this.pwSwitch("hide"),this.foldAnim())},{},this)},foldAnim:function(){var a=new YAHOO.util.Anim("aside",{width:{form:235,to:30}},0.3,YAHOO.util.Easing.easeIn);a.animate();var b=this;a.onComplete.subscribe(function(){b.asideContainer.forEach(function(a){a==b.asideBar?D.removeClass(a,"fn-hide"):D.addClass(a,"fn-hide")},b);b.stat=0},b)},expandAnim:function(){this.asideContainer.forEach(function(a){a==this.asideBar?D.addClass(a,"fn-hide"):D.removeClass(a,
"fn-hide")},this);if(AP.fn.browser.msie6&&-1==this.aside.innerHTML.indexOf("<IFRAME")){var a=document.createElement("div");a.className="aside-layer-bg";a.innerHTML='<iframe src="javascript:\'\'" scrolling="no" height="900" frameborder="0"></iframe>';this.aside.appendChild(a)}a=new YAHOO.util.Anim("aside",{width:{form:0,to:235}},0.3,YAHOO.util.Easing.easeOut);a.animate();var b=this;a.onComplete.subscribe(function(){b.stat=1;b.pwSwitch("show");b.autoFontsizeDone||(b.autoFontsizeDone=new AP.pk.pa.asideAmountFontsize)},
b);this.sendTrack("aside-expand")},checkFoldable:function(a){return!AP.fn.eInRegion(D.getRegion(this.aside),a)&&!AP.fn.eInRegion(D.getRegion("J_mypop"),a)},pwSwitch:function(a){if(window.asideLoginIframe)try{"hide"==a?(D.addClass(window.asideLoginIframe.document.getElementsByTagName("embed")[0],"fn-hide"),D.addClass(window.asideLoginIframe.document.getElementsByTagName("object")[0],"fn-hide")):(D.removeClass(window.asideLoginIframe.document.getElementsByTagName("object")[0],"fn-hide"),D.removeClass(window.asideLoginIframe.document.getElementsByTagName("embed")[0],
"fn-hide"))}catch(b){log(b)}},reChargeBindPhone:function(){var a=D.get("reChargeXbox"),b=D.query(".btn-addfunds")[0],e=this;if(a&&b){var g="reChargeXboxShowTimes"+a.getAttribute("data"),f=new AP.widget.xBox({type:"dom",value:function(){return a},modal:!0,fixed:!1}),d=parseInt(this.getCookie(g)||1);E.on(b,"click",function(a){E.preventDefault(a);3>=d?(f.fire(),d++,e.setCookie(g,d)):window.open(b.getAttribute("href"))});E.on(a,"click",function(a){var b=a.target;D.hasClass(b,"reload-method")&&(E.preventDefault(a),
AP.widget.xBox.hide(),window.location.href=b.getAttribute("href"))});E.on(D.query(".xbox-close"),"click",function(a){E.preventDefault(a);AP.widget.xBox.hide()})}},initComponents:function(){var a=D.query(".user-status li",D.get("aside"));new AP.widget.seniorPop(D.query("em.ico-vip"),{offset:[-6,0]});var b=this;new AP.widget.seniorPop(a,{offset:[-16,0],onshow:function(){b.sendTrack("aside-"+this.current_el.className.substring(8))}});var a=D.get("asideAccountName"),e=a.innerHTML;e.substring(4,5)&&(e=
e.substring(0,4)+"...",a.innerHTML=e,new AP.widget.seniorPop(D.query("#aside .aside-account-info-name"),{offset:[-6,0]}));D.removeClass(a,"fn-hide");D.hasClass(D.query(".aside-amount",D.get("aside"))[0],"fn-hidden")&&new AP.pk.pa.asideAmountFontsize;AP.pk.pa.asidePortrait.init();D.hasClass("JAsideMultiAccTrigger","aside-account-multi")&&(new AP.pk.pa.switchAcct(D.query("#JAsideMultiAccTrigger")),D.get("JAsideMultiAccTrigger").title="\u5207\u6362\u767b\u5f55\u8d26\u6237");new AP.widget.xBox({el:D.query(".aside-portraits li:contains("+
_("upload")+") a",D.get("aside"))[0],type:"iframe",value:function(a){return a.href},modal:!0,fixed:!1});D.query("#aside .aside-widget a").forEach(function(a){if(a.href.indexOf("uisrc=")==-1)a.href=a.href+"&uisrc=aside";a.href=a.href+("&ref="+location.href)});this.reChargeBindPhone()}};var AcValidataor=function(a){this.init(a);this.run()};
AcValidataor.prototype={init:function(a){for(var b in a)this[b]=a[b]},beforeClick:function(){},run:function(){var a=this;a.form=D.get("form");a.explain=D.get(a.explainId);a.cardNum=D.get(a.inputId);a.explainItem=D.getAncestorByClassName(a.explain,a.fmItemId);var b=a.edit=AlieditControl.getAliedit(a.form);if(AlieditControl){var e=function(){try{a.edit[0].PasswordMode=0}catch(b){setTimeout(function(){e()},500)}};e()}E.on(this.btnId,"click",function(e){D.removeClass(a.explainItem,a.warnCls);D.removeClass(a.explainItem,
a.errorCls);if(b)a.editControl=a.edit[0];else{var f=D.getAncestorByClassName(a,"ui-btn");D.removeClass(f,"ui-btn-ok");D.addClass(f,"ui-btn-cancel");a.disabled=!0}f=(f=D.get("J-userBankCard-N"))&&f.checked||!1;!1!==a.beforeClick(e,a.form)&&!f&&(new AP.core.api("fund/paydirect/checkCard",{onAPISuccess:function(b,e){a.cardNum.value=a.editControl.TextData;if("applyFastPayment"===e[0]["goto"]){a.form.target="_top";a.form.action="/fund/paydirect/applyFastPayment.htm";var f=D.query("input[name='institutionShortName']:first",
a.explainItem);0<f.length&&(f[0].value=e[0].institutionShortName)}a.form.submit()},onAPIFailure:function(b,e){e[0].mark?(D.addClass(a.explainItem,a.warnCls),a.explain.innerHTML=e[0].msg+'<a href="https://www.alipay.com/static/bank/index.htm" target="_blank" seed="link-suported-bank">'+e[0].supportUrl+"</a>"):(D.addClass(a.explainItem,a.errorCls),a.explain.innerHTML=e[0].msg)},method:"POST"})).call({cardNo:a.editControl.TextData});E.preventDefault(e)})}};
(function(){var a=function(a){a.sort();for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a},b=function(a,b,e){a=a.join(", .");background=['background-image:url("',b,'");'].join("");style=[".",a," {text-indent: -9999px; ",background,"} "].join("");e.push(style)},e=function(a,b,e){b=["background-position: 0px -",b,"px; "].join("");a=[".",a," {",b,"} "].join("");e.push(a)},g=function(a){var b=document.createElement("style"),a=document.createTextNode(a);b.type="text/css";b.className="iconStyle";
b.styleSheet?b.styleSheet.cssText=a.nodeValue:b.appendChild(a);document.getElementsByTagName("head")[0].appendChild(b)};AP.widget.icons=function(f){var d=[],h=[],j=D.query("span.icon, a.icon",f.context||document);AP.cache.iconCache||(AP.cache.iconCache=[]);for(var k=0;k<j.length;k++){var l=j[k].className.split(" ");if(1<l.length&&(l=l.slice(-1)[0])&&-1===AP.cache.iconCache.indexOf(l))d.push(l),a(d)}d.sort();if(d.length){a(AP.cache.iconCache.concat(d));k=d.join(",");f=f.combo_url+"&t="+k;b(d,f,h);
for(k=0;k<d.length;k++)e(d[k+1],36*(k+1),h);g(h.join("\n"));d=new Image;E.on(d,"onerror",function(){});d.src=f}}})();AP.PageVar=AP.PageVar||{};if(!AP.PageVar.reset_domain)try{var _ADOMAIN=document.domain.split("."),_SDOMAIN=_ADOMAIN[_ADOMAIN.length-2]+"."+_ADOMAIN[_ADOMAIN.length-1];document.domain=_SDOMAIN}catch(e$$125){}
E.onDOMReady(function(){function a(){var a=D.getViewportHeight(),b=D.get("container").offsetHeight,d=D.getY("content");b<a+d&&(D.get("container").style.height=a+d+"px");window.scroll(0,d)}if((D.get("viewFaq")||D.get("view-faq"))&&D.get("faq"))AP.widget.highligthFaq=new AP.pk.pa.highlight({autoShow:!1}),E.on(["viewFaq","view-faq"],"click",function(a){AP.widget.highligthFaq.show();"undefined"!=typeof Tracker&&Tracker.click("pa-viewfaq");E.preventDefault(a)});try{AP.util.inputHack()}catch(b){}try{AP.pk.pa.aside.initialize()}catch(e){log(e)}D.get("faqsearch")&&
new AP.pk.pa.searchBox(D.get("faqsearch"));D.get("asidesearch")&&new AP.pk.pa.searchBox(D.get("asidesearch"));D.get("error404search")&&new AP.pk.pa.searchBox(D.get("error404search"));(0<D.query(".J-scroll-to-title").length||0<D.query(".aside-bar",D.get("aside")).length&&0<D.query(".title a.cancel",D.get("main")).length)&&a();E.on(D.query(".J-scroll-to-top"),"click",function(b){a();E.preventDefault(b)});0<D.query(".J-scroll-to-top",D.get("faq")).length&&D.getDocumentHeight()==D.getViewportHeight()&&
D.addClass(D.query(".J-scroll-to-top",D.get("faq"))[0],"fn-hide");E.on(D.query(".title a.return",D.get("content"))[0],"click",function(a){"undefined"!=typeof Tracker&&Tracker.click("pa-return");if(""==E.getTarget(a).href||E.getTarget(a).href==window.location.href||E.getTarget(a).href==window.location.href+"#")history.go(-1),E.preventDefault(a)});1==history.length+(AP.fn.browser.msie?1:0)&&0<D.query(".title a.action",D.get("content")).length&&-1==location.href.indexOf("_xbox")&&D.addClass(D.query(".title a.action",
D.get("content"))[0],"fn-hide");D.hasClass(document.body,"xbox")&&self.parent===self&&D.query(".xbox-close-link").length&&D.addClass(D.query(".xbox-close-link")[0],"fn-hide");if(D.query(".switch-lang").length){var g=window.location.host.match(/^[-a-zA-Z0-9]+(\..+)/)[1]||".alipay.com";D.query(".switch-lang").forEach(function(a){E.on(a,"click",function(){YAHOO.util.Cookie.set("_lang",a.getAttribute("data-lang"),{path:"/",domain:g,expires:new Date("April 14, 5262")});setTimeout(function(){window.location.reload()},
10)})})}try{(function(){var a=D.query("input:text").concat(D.query("textarea")),b=a.length;if(!(1>b))for(var d=0;d<b;d++)if(0<a[d].offsetHeight&&D.hasClass(a[d],"J-autofocus")&&!D.hasClass(a[d].parentNode,"fm-error")){window.setTimeout(function(){a[d].focus();a[d].select()},200);D.hasClass(a[d].parentNode,"fm-item")&&D.addClass(a[d].parentNode,"fm-focus");break}})()}catch(f){}AP.widget.scrollToAnchor=function(){var a=window.location.href,b=/[?|&]anchor=([^&]*)/;if(b.test(a)&&(a=b.exec(a)[1],D.get(a)||
D.get("J_"+a)))a=D.get(a)?D.get(a):D.get("J_"+a),AP.util.scrollPage(a,1)}();D.get("J-nav-life")&&D.get("J-nav-lifeExtend")&&(new AP.pk.pa.animDropDown(D.query("#J-nav-life"),{isposition:!0,offset:[3,-7],mousehandle:!0,targetClick:function(){AP.pk.pa.aside.pwSwitch("hide")},hideEvent:function(){AP.pk.pa.aside.pwSwitch("show")}}),E.on("J-nav-life","mouseover",function(){"undefined"!=typeof Tracker&&Tracker.click("pa-showlifenav")}));if(D.get("J-nav-life"))E.on("J-nav-life","click",function(a){E.stopEvent(a)});
var d=D.query(".nav-master-life.current",D.get("nav")).length?D.query(".nav-master",D.get("nav")):D.query(".nav-master:not(li.nav-master-life)",D.get("nav")),h=0,j;d.length&&(d.forEach(function(a,b){h=D.hasClass(a,"current")?b:h;E.on(a,"mouseover",function(){j&&clearTimeout(j);j=setTimeout(function(){for(var b=0;b<d.length;b++)D.removeClass(d[b],"current");D.addClass(a,"current")},200)})}),E.on("nav","mouseout",function(){j&&clearTimeout(j);j=setTimeout(function(){for(var a=0;a<d.length;a++)D.removeClass(d[a],
"current");D.addClass(d[h],"current")},200)}),D.addClass(D.query(".nav-master-a",d[h])[0],"nav-master-a-hover"));new AP.widget.xBox({el:D.query(".J-feedback"),type:"iframe",value:function(a){return a.href},modal:!0,fixed:!1,width:485})});