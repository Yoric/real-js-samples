webpackJsonp([43],{1252:function(t,e,o){t.exports={controllerViews:{FollowCluster:o(2191),FollowContent:o(1426)},stores:{StorylinesStore:o(1609),FollowContentStore:o(1403)}}},1403:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(o(11));e.default=(0,o(298).createImmutableStore)({storeName:"FollowContentStore",statics:{handlers:{SET_CONTENT_FOLLOW_STATE:"setContentState"}},initialize:function(){this._state=n.default.fromJS({knownContentState:{}})},setContentState:function(t){if(t){var e=t.uuids||[],o=t.followedContent||[],s=t.overrideState,l=n.default.Map(),i=this;e.forEach(function(t){var e;e=-1!==o.indexOf(t)||!s&&i._state.getIn(["knownContentState",t])?1:0,l=l.set(t,e)}),i.setState(i._state.set("knownContentState",i._state.get("knownContentState").merge(l)),null,{type:"SET_CONTENT_FOLLOW_STATE",uuids:e,action:t.action})}},getContentState:function(t){return this._state.getIn(["knownContentState",t])||0},getContentStateMap:function(){return this._state.get("knownContentState")}}),t.exports=e.default},1426:function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=n(o(8)),l=n(o(1214)),i=n(o(19)),a=n(o(1403)),r=n(o(1215)),u=n(o(0)),d=n(o(1)),c=n(o(4)),f=n(o(1427)),p=(0,c.default)({displayName:"FollowContent",autobind:!1,mixins:[i.default],statics:{componentConfig:{name:"componentFollow"},storeListeners:[a.default]},contextTypes:{session:u.default.object},propTypes:{afterClick:u.default.func,buttonSize:u.default.number,category:u.default.string,className:u.default.string,colors:u.default.object,componentConfig:u.default.object,enableHoverColor:u.default.bool,enableHoverColorTransition:u.default.bool,enableRoundShape:u.default.bool,enableTooltip:u.default.bool,openDirection:u.default.oneOf(["left","right","up","down"]),fromSlingstone:u.default.bool,iconClasses:u.default.string,iconSize:u.default.number,intl:o(36).intlShape,overrideTooltipClasses:u.default.string,persistTooltip:u.default.bool,uuid:u.default.string.isRequired,ylkData:u.default.object},getDefaultProps:function(){return{category:"",className:"",colors:{initial:"#c8c8cc",hovered:"#ff333a",selected:"#ff4d53"},enableHoverColor:!1,enableHoverColorTransition:!1,enableTooltip:!1,enableRoundShape:!1,buttonSize:40,iconClasses:"",iconSize:15,overrideTooltipClasses:"",persistTooltip:!1,openDirection:"left",ylkData:{}}},getInitialState:function(){return this.followContentStore=this.getStore(a.default),{contentState:this.followContentStore.getContentState(this.props.uuid),hover:this.props.persistTooltip}},onChange:function(){this._updateContentState(this.props.uuid)},shouldComponentUpdate:function(t,e){return this.state.hover!==e.hover||this.state.contentState!==e.contentState},componentWillReceiveProps:function(t){this.props.uuid!==t.uuid&&this._updateContentState(t.uuid)},componentWillMount:function(){var t=this,e=t.constructor.prototype;t.onChange=e.onChange.bind(t),t.handleClick=e.handleClick.bind(t),(t.props.enableHoverColor||t.props.enableTooltip)&&(t.onMouseEnter=e.onMouseEnter.bind(t),t.onMouseLeave=e.onMouseLeave.bind(t))},handleClick:function(t){t.preventDefault(),this.executeAction(f.default,{uuid:this.props.uuid,state:this.state.contentState,category:this.props.category,fromSlingstone:this.props.fromSlingstone,config:this.props.componentConfig||{}})},onMouseEnter:function(){this.setState({hover:!0})},onMouseLeave:function(){this.setState({hover:!1}),this.props.afterClick&&this.props.afterClick()},shouldSetupMouseListeners:function(){return!this.props.persistTooltip&&(this.props.enableHoverColor||this.props.enableTooltip)},render:function(){var t=this.props.openDirection,e={"aria-label":this._getButtonText(),className:(0,s.default)(this.props.className,"NoJs_D(n) Bd(0) M(0) P(0) Va(m)",{"desktop_W(100%) Pos(r)":this.props.enableTooltip&&"down"!==t,"Trs(hoverColorTransition) Cur(p)":this.props.enableHoverColorTransition,"Bdrs(50%)":this.props.enableRoundShape}),style:this._getStyle(),href:"#",i13nModel:Object.assign({},this.props.ylkData,{dcl:this.state.contentState?"pos-neu":"neu-pos",elm:"like",itc:1,slk:"like"}),onClick:this.handleClick};return this.shouldSetupMouseListeners()&&(e.onMouseEnter=this.onMouseEnter,e.onMouseLeave=this.onMouseLeave),this.props.uuid&&!this.context.session.isLightWeightBrowser?d.default.createElement(o(29).I13nButton,e,this._renderIcon(),this._renderTooltip()):null},_getButtonText:function(){var t;return t="1"!==this.context.session.dimensions.authed?"SIGN_IN_TO_LIKE":this.state.contentState?"UNDO":"LIKE_THIS_TOPIC",this.props.intl.formatMessage({id:t})},_getStyle:function(){var t;return this.props.enableRoundShape&&(t={},t.height=t.width=this.props.buttonSize+"px",t.backgroundColor=this.props.enableHoverColor&&this.state.hover?this.props.colors.hovered:this.props.colors.selected),t},_renderIcon:function(){var t=this.state.contentState||this.state.hover?this.props.colors.hovered||this.props.colors.selected:this.props.colors.initial;return this.props.enableRoundShape&&(t=this.props.colors.initial),d.default.createElement(o(34).Icon,{asset:this.state.contentState?r.default:l.default,className:this.props.iconClasses,color:t,height:this.props.iconSize})},_renderTooltip:function(){var t=this.props.openDirection;if(this.props.enableTooltip&&this.state.hover){var e=this.props.overrideTooltipClasses||(0,s.default)("Bdc($c-fuji-grey-c) Bds(s) Bdw(1px) Bdrs(3px) Bgc(#fff)","Bxsh(followContentTooltipBxsh) C($c-fuji-red-2-b) Fz(13px)","Lh(14px) Pos(a) Px(14px) Py(8px) Whs(nw) Z(3)",{"Start(0) T(26px)":"down"===t,"B(0) End(36px)":"left"===t});return d.default.createElement("b",{className:e},this._getButtonText())}},_updateContentState:function(t){this.setState({contentState:this.followContentStore.getContentState(t)})}});e.default=(0,o(36).injectIntl)(p),t.exports=e.default},1427:function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function s(t,e,o){e=e||{};var n={uuid:e.uuid,curState:e.state?1:0,fromSlingstone:e.fromSlingstone};if(n.uuid){if(void 0===n.fromSlingstone){var s=(e.category||"").split(":")[0];n.fromSlingstone=d[s]||!1}var c=t.session&&t.session.dimensions?t.session.dimensions.authed:"0",f=t.localStorage;if(f)if("1"!==c){var p=+new Date;f.setItem(r,{uuid:n.uuid,fromSlingstone:n.fromSlingstone,expiry:p+a});var h=e.config&&e.config.loginBaseUrl||"https://login.yahoo.com/config/login";window.location=h+"?.done="+window.location.href}else{var S=t.getStore(i.default),g=S.getGUID(),C=f.getItem(u)||{},m={},v=Object.keys(C);C[g]&&C[g][n.uuid]&&n.curState?delete C[g][n.uuid]:(v.length>19&&delete C[g][v[0]],C=(0,l.default)(C,[g,n.uuid],!n.curState)),m[g]=Object.assign({},C[g]),f.setItem(u,m);var w={action:"set",uuids:[n.uuid],followedContent:n.curState?[]:[n.uuid],overrideState:!0};t.dispatch("SET_CONTENT_FOLLOW_STATE",w)}o&&o()}else t.logger.warn("setContentState did not recieve a uuid"),o&&o()}Object.defineProperty(e,"__esModule",{value:!0});var l=n(o(195)),i=n(o(92)),a=18e4,r="followed-content-login",u="followed-content-signedin",d={"":!0,WIKIID:!0,YCT:!0,YMEDIA:!0,YPROP:!0};s.displayName="setContentState",e.default=s,t.exports=e.default},1609:function(t,e,o){"use strict";t.exports=o(20)({storeName:"StorylinesStore",statics:{handlers:{GET_STORY_LINES_COUNT_SUCCESS:"setUpdatedStorylinesCount",GET_STORY_LINES_DATA_SUCCESS:"setStorylines",UPDATE_CLUSTER_SUCCESS:"handleUpdate",UPDATE_CLUSTER_FAILURE:"handleFallbackUpdate",UPDATE_CLUSTER_SIGNED_OUT:"handleFallbackUpdate",UPDATE_CLUSTER_COUNT:"setStorylineCount"}},initialize:function(){this._state={storylines:{following:[],followable:[]},updatedStorylinesCount:0,storylinesStale:!0}},isStale:function(){return this._state.storylinesStale},setStorylines:function(t){var e=this;t&&t.data&&(e._state.storylines=t.data.storylines,e._state.updatedStorylinesCount=t.data.updatedStorylinesCount,e._state.storylinesStale=!1,e.emitChange())},getStorylines:function(){return this._state.storylines},getStoryline:function(t){var e,o=this.getStorylines()||{},n=[].concat(o.following).concat(o.followable),s=function(e){return e.followId===t};return t&&(e=n.filter(s)[0]),e},getStorylineState:function(t){var e=this.getStoryline(t);return e?!e.upsell:void 0},setUpdatedStorylinesCount:function(t){var e=t?t.data:void 0;"number"==typeof e&&e!==this._state.updatedStorylinesCount&&(this._state.updatedStorylinesCount=e,e>0&&(this._state.storylinesStale=!0),this.emitChange())},setStorylineCount:function(t){var e=this,o=t.data.followId,n=t.data.count,s=e.getStoryline(o);s&&s.count!==n&&(s.count=n,e._settleStorylineCount())},getUpdatedStorylinesCount:function(){return this._state.updatedStorylinesCount},handleUpdate:function(t){var e=this,o=t.followId,n=t.follow||!1,s=e.getStoryline(o),l=n?"followable":"following",i=n?"following":"followable";s&&(s.upsell=!n,s.count=n?Math.max(1,s.count):s.count,e._addStoryline(s,i),e._removeStoryline(o,l),e._settleStorylineCount())},handleFallbackUpdate:function(t){var e=this;e.handleUpdate(t),e._persistInLocalStorage()},getStorylinesArticles:function(t){var e=[],o=this.getStorylines()||{},n=function(t){return t.article};return o.following&&(e=e.concat(o.following.map(n))),o.followable&&(e=e.concat(o.followable.map(n))),e.slice(0,t||e.length)},_persistInLocalStorage:function(){var t=this,e=t.getContext(),o=t.getStorylines()||{},n=o.following||[],s=n.map(function(t){return t.followId});e&&e.localStorage&&e.localStorage.setItem("storylines-followed",s)},_updateLocalStorageTimestamp:function(){var t=this,e=t.getContext();e&&e.localStorage&&e.localStorage.setItem("storylines-timestamp",Math.floor(Date.now()/1e3))},_removeStoryline:function(t,e){var o=this,n=o.getStorylines()||{};t&&e&&n[e]&&(n[e]=n[e].filter(function(e){return e.followId!==t}),o.setStorylines({data:{storylines:n,updatedStorylinesCount:o.getUpdatedStorylinesCount()}}))},_addStoryline:function(t,e){var o=this,n=o.getStorylines(),s=o._isValidStoryline(t),l=function(e){return e.followId===t.followId};s&&e&&n[e]&&!n[e].filter(l).length&&(n[e].unshift(t),o.setStorylines({data:{storylines:n,updatedStorylinesCount:o.getUpdatedStorylinesCount()}}))},_settleStorylineCount:function(){var t=this,e=t.getStorylines().following,o=0;e.forEach(function(t){o+=t.count>0?1:0}),t.getUpdatedStorylinesCount()!==o&&(t._state.updatedStorylinesCount=o,t.emitChange())},_isValidStoryline:function(t){return"number"==typeof t.count&&"string"==typeof t.followId&&"string"==typeof t.name&&"string"==typeof t.status&&"boolean"==typeof t.upsell&&"object"==typeof t.article&&"string"==typeof t.article.link&&"string"==typeof t.article.published}})},1656:function(t,e){if(void 0===o)var o={};o["watchlist-added"]={name:"watchlist-added",height:48,width:48,path:"M35.53 43.496c-.294 0-.587-.074-.852-.22l-10.68-5.946-10.678 5.945c-.607.34-1.35.288-1.907-.132-.553-.414-.81-1.12-.653-1.795l2.685-11.688-9.292-8.565c-.515-.476-.7-1.212-.464-1.874.23-.66.834-1.117 1.534-1.163l12.252-.802 4.905-11.68c.274-.65.913-1.074 1.618-1.074.704 0 1.34.423 1.614 1.075l4.908 11.68 12.25.805c.703.046 1.308.503 1.542 1.165.232.662.05 1.4-.465 1.874l-9.295 8.564 2.688 11.688c.154.673-.103 1.38-.657 1.793-.31.235-.68.35-1.054.35"},void 0!==t&&t.exports&&(t.exports=o["watchlist-added"])},1657:function(t,e){if(void 0===o)var o={};o.star={name:"star",height:24,width:24,path:"M8.485 7.83l-6.515.21c-.887.028-1.3 1.117-.66 1.732l4.99 4.78-1.414 6.124c-.2 1.14.767 1.49 1.262 1.254l5.87-3.22 5.788 3.22c.48.228 1.464-.097 1.26-1.254l-1.33-6.124 4.962-4.78c.642-.615.228-1.704-.658-1.732l-6.486-.21-2.618-6.22c-.347-.815-1.496-.813-1.84.003L8.486 7.83zm7.06 6.05l1.11 5.11-4.63-2.576L7.33 18.99l1.177-5.103-4.088-3.91 5.41-.18 2.19-5.216 2.19 5.216 5.395.18-4.06 3.903z"},void 0!==t&&t.exports&&(t.exports=o.star)},2191:function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=n(o(8)),l=n(o(19)),i=n(o(1609)),a=n(o(0)),r=n(o(1)),u=n(o(4)),d=n(o(2192)),c=n(o(1657)),f=n(o(1656)),p=(0,u.default)({displayName:"FollowCluster",autobind:!1,mixins:[l.default],statics:{componentConfig:{name:"componentFollow"},storeListeners:[i.default]},propTypes:{className:a.default.string,followId:a.default.string.isRequired,intl:o(36).intlShape,showFollowTreatment:a.default.bool,title:a.default.string.isRequired,userFollowing:a.default.bool.isRequired,view:a.default.oneOf(["","breakingNews","featured"])},getInitialState:function(){return this._getState()},onChange:function(){this.setState(this._getState())},getDefaultProps:function(){return{className:"Py(12px) Ta(c)",followId:"",title:"",view:"",userFollowing:!1}},shouldComponentUpdate:function(t,e){return this.state.userFollowing!==e.userFollowing||this.state.mouseOverButton!==e.mouseOverButton},componentWillMount:function(){var t=this,e=t.constructor.prototype;t.onChange=e.onChange.bind(t),t.handleClick=e.handleClick.bind(t),t.props.enableHoverColor&&(t.handleMouseEnter=e.handleMouseEnter.bind(t),t.handleMouseLeave=e.handleMouseLeave.bind(t))},handleClick:function(t){t.preventDefault(),this.executeAction(d.default,{follow:!this.state.userFollowing,followId:this.props.followId,showFollowTreatment:this.props.showFollowTreatment})},handleMouseEnter:function(){this.setState({mouseOverButton:!0})},handleMouseLeave:function(){this.setState({mouseOverButton:!1})},generateDefault:function(){var t,e=this,n=e.state.mouseOverButton,l=e.state.userFollowing,i=e._getButtonText(),a=!n&&l?"#000":"#fff",u=(0,s.default)("Px(8px) Py(2px) Pos(r) Z(2) O(0) Whs(nw) Miw(100px)","Fw(b) Fz(13px) Lh(20px) Bd Bdw(2px) Bds(s) Bdrs(3px) Bxz(bb)",{"Bdc(#ffb700)":l||n,"Bdc(#fff)":!l&&!n,"C(#ffb700)":l||n,"C(#fff)":!l&&!n}),d=e.attachRequiredEventHandlers({className:u,model:e._getI13nModel(),title:i});return l||n?(a="#ffb700",t=f.default):(a="#fff",t=c.default),r.default.createElement("div",{className:e.props.className},r.default.createElement("div",{className:"Tt(c) Fz(13px) Pb(6px) Px(20px) Fw(b) C(#fff)"},e.props.title),r.default.createElement(o(29).I13nButton,d,r.default.createElement(o(34).Icon,{asset:t,className:"D(ib) Mend(4px)",color:a,height:18,style:{verticalAlign:"text-bottom"},width:18}),r.default.createElement("span",null,i)))},generateFeatured:function(){var t,e,n=this,s=n.state.mouseOverButton,l=n.state.userFollowing,i=n._getButtonText();l||s?(e="#ffb700",t=f.default):(e="#959595",t=c.default);var a=n.attachRequiredEventHandlers({className:"P(0) Pos(r) Z(2) O(0) Bd(0) Whs(nw) Lh(20px) Fz(13px)",model:n._getI13nModel(),title:i});return r.default.createElement("div",{className:n.props.className},r.default.createElement(o(29).I13nButton,a,r.default.createElement(o(34).Icon,{asset:t,className:"Fl(end)",color:e,height:18,width:18}),r.default.createElement("span",{className:"Mend(4px) C(#959595)"},i)))},generateBreakingNews:function(){var t,e,n=this,s=n.state.mouseOverButton,l=n.state.userFollowing,i=n._getButtonText();e=s&&l?"#bcbcbc":"#fff",t=l&&!s||!l&&s?f.default:c.default;var a=n.attachRequiredEventHandlers({className:"P(0) Pos(r) Z(2) O(0) Bd(0) Whs(nw) Lh(20px) Fz(13px) Fw(b)",model:n._getI13nModel(),style:{color:e},title:i});return r.default.createElement("div",{className:n.props.className},r.default.createElement(o(29).I13nButton,a,r.default.createElement(o(34).Icon,{asset:t,className:"Fl(start) Mend(4px) Mt(2px)",color:e,height:15,width:15}),r.default.createElement("span",null,i)))},attachRequiredEventHandlers:function(t){var e=this;return"pending"!==e.state.userFollowing&&(t.onClick=e.handleClick),e.props.enableHoverColor&&(t.onMouseEnter=e.handleMouseEnter,t.onMouseLeave=e.handleMouseLeave),t},render:function(){var t=this,e=t.props;return"featured"===e.view?t.generateFeatured():"breakingNews"===e.view?t.generateBreakingNews():t.generateDefault()},_getButtonText:function(){var t;return t=this.state.userFollowing?this.state.mouseOverButton?"UNFOLLOW":"FOLLOWING":"FOLLOW",this.props.intl.formatMessage({id:t})},_getI13nModel:function(){return{elm:"btn",slk:this.state.userFollowing?"unfollow":"follow",itc:1}},_getState:function(){var t=this.props.followId,e=this.getStore(i.default),o=e.getStorylineState(t);return{userFollowing:void 0!==o?o:this.props.userFollowing,mouseOverButton:!!this.state&&this.state.mouseOverButton}}});e.default=(0,o(36).injectIntl)(p),t.exports=e.default},2192:function(t,e,o){"use strict";function n(t,e){t&&e&&e.follow&&e.showFollowTreatment&&(t.dispatch("SHOW_MOBILE_HEADER",{showHeader:!0}),t.dispatch("ON_STREAM_FOLLOW",{followAnimation:!0}))}t.exports=function(t,e,o){var s=t.localStorage,l=t.session&&t.session.dimensions?t.session.dimensions.authed:0,i=0===parseInt(l,10);if(!e)return t.logger.warn("setClusterState did not recieve a payload"),o&&o();i?(s?(t.dispatch("UPDATE_CLUSTER_SIGNED_OUT",e),n(t,e)):t.dispatch("UPDATE_CLUSTER_FAILURE",e),o&&o()):t.service.update("storylines.setClusterState",null,e,function(s,l){s&&!l?t.dispatch("UPDATE_CLUSTER_FAILURE",e):(t.dispatch("UPDATE_CLUSTER_SUCCESS",e),n(t,e)),o&&o(s,l)})}}});