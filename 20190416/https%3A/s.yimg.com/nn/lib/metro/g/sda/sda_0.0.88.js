YUI.add("type_sda",function(a){a.namespace("My.Extensions.Sda");var m="#my-adsLREC2-config",b="#my-adsLREC2",p="#my-adsMAST",d="#sticky-lrec2-footer",g="fetch_selective_ad",r=window.DARLA||null,o="LREC2",k="LREC3",n="LREC4",h="MON2",f=false,j=1000,l="hlAdsAll",q="",e="2023538075",c=100;function i(){var s=this;YMedia.after("appletsinit",function(t){s.init();});}i.prototype.init=function(){var u=this;var t=a.one(m);if(!t){return;}var x=t.getData("config");if(!x){return;}try{lrec2PositionMeta=a.JSON.parse(x);}catch(w){return;}b="#my-ads"+lrec2PositionMeta.pos;this.container=a.one(b);this.streamRestoreState=false;if(!this.container||!r){return;}var v=a.one("body");var y=v&&!!v.one("#bbnavdetect");v.plug(a.Plugin.ScrollInfo);this.scrollInfo=v.scrollInfo;this.scrollevent=this.scrollInfo.on("scroll",a.bind(this.VisibleLREC2Ads,this,true),this);if(y){a.Global.on("stream:normal-load",function(){u.addAutoEvent();u.registerTabswitch();u.registerScrollRotate();u.VisibleLREC2Ads();});a.Global.on("stream:restore-state",function(){if(u.isNodeInViewport(b)){var z=true;u.fetchDarlaAd(z);}},u);}else{setTimeout(function(){u.addAutoEvent();u.registerTabswitch();u.registerScrollRotate();u.VisibleLREC2Ads();},300);}var s=t.getData("offset");c=s&&parseInt(s,10)||c;};i.prototype.isNodeInViewport=function(s){var t=this.scrollInfo.getOnscreenNodes(s,c);if(a.one("html").hasClass("Reader-open")&&!a.one("html").hasClass("Reader-closed")){return false;}return !t.isEmpty();},i.prototype.VisibleLREC2Ads=function(){if(this.isNodeInViewport(b)){this.fetchDarlaAd();if(this.scrollevent){this.scrollevent.detach();this.scrollevent=null;}}};i.prototype.registerTabswitch=function(){var z=this;var v=a.one(m);var u=v.getData("tabswitchrotate");u=u&&parseInt(u,10)||0;var w=u>0;if(!w){return;}var A=Date.now||function(){return new Date().getTime();};var y=A();var x=a.Af&&a.Af.PageViz&&a.Af.PageViz.isHidden()||false;function s(){if(!x){y=A();x=true;}}function t(){if(window.disableAdboost){return;}var C=A();if(C-y<u){return;}if(a.Af&&a.Af.PageViz&&a.Af.PageViz.isHidden()){x=true;return;}x=false;if(!window._darlaAutoEvt){window._darlaAutoEvt=z.getAutoEvent();}var E=[].concat(a.Object.keys(window._darlaAutoEvt.ps),"MON");var B=[];if(!window.DARLA||window.DARLA.inProgress()){return;}a.Array.each(E,function(G){if(B.indexOf(G)<0){var H=window.DARLA.posSettings(G);if(H){if(z.isNodeInViewport("#"+H.dest)){var F=a.one("#"+H.dest);if(F&&F.get("offsetHeight")>1){B.push(G);}}}}});if(B.length>0){var D={ps:B.join(","),name:"tabswitch",sp:window._darlaAutoEvt.sp,sa:window._darlaAutoEvt.sa+" "+(window.customSiteAttr||""),ssl:window._darlaAutoEvt.ssl,secure:window._darlaAutoEvt.secure,ref:window.location.href,npv:1,property:"fp",ult:window._darlaAutoEvt.ult,experience:window._darlaAutoEvt.experience};window.DARLA.add(D);window.DARLA.event("tabswitch");}}a.on("blur",s,window);a.on("focus",t,window);if(a.Af&&a.Af.PageViz){a.Af.PageViz.on("visible",t,z);a.Af.PageViz.on("hidden",s,z);}},i.prototype.registerScrollRotate=function(){var u=this;var t=a.one(m);var z=t.getData("scrollrotate");var w=t.getData("lrec2SelectiveEnabled")==="1",z=z&&parseInt(z,10)||0;var v=z>0;if(!v){return;}var s=0;var x=0;function y(){s++;if(s-x<z){return;}if(!window._darlaAutoEvt){window._darlaAutoEvt=u.getAutoEvent();}var B=w?["LREC3","LREC4","MON2"]:[];var D=[].concat(a.Object.keys(window._darlaAutoEvt.ps),["MON"],B);var A=[];if(!window.DARLA||window.DARLA.inProgress()){return;}a.Array.each(D,function(F){if(A.indexOf(F)<0){var G=window.DARLA.posSettings(F);if(G){if(u.isNodeInViewport("#"+G.dest)){var E=a.one("#"+G.dest);if(E&&E.get("offsetHeight")>1){A.push(F);}}}}});if(A.length>0){x=s;var C={ps:A.join(","),name:"scrollrotate",sp:window._darlaAutoEvt.sp,sa:window._darlaAutoEvt.sa+" "+(window.customSiteAttr||""),ssl:window._darlaAutoEvt.ssl,secure:window._darlaAutoEvt.secure,ref:window.location.href,npv:1,property:"fp",ult:window._darlaAutoEvt.ult,experience:window._darlaAutoEvt.experience};window.DARLA.add(C);window.DARLA.event("scrollrotate");}}window.sdaAvpCallback=y;},i.prototype.addAutoEvent=function(){var t=this;var s=a.one(m);var u=s.getData("autorotate")==="1";if(!u){return;}if(window.DARLA&&window.DARLA.inProgress()){setTimeout(function(){t.addAutoEvent();},500);}else{window._darlaAutoEvt=t.getAutoEvent();if(window.DARLA&&window._darlaAutoEvt){window.DARLA.add(window._darlaAutoEvt);}}},i.prototype.getAutoEvent=function(){var s={pg:{property:"fp",test:window.Af.context.bucket,intl:window.Af.context.region,rid:window.Af.context.rid,device:window.Af.context.device}},v='Y-BUCKET="'+window.Af.context.bucket+'"',E=(window.location.protocol==="http:")?0:1,B=a.one(m),L=B.getData("disablerotation")==="1",x=B.getData("lrec4enabled")==="1",F=B.getData("mon2Enabled")==="1",G=B.getData("autoeventrt"),t=B.getData("mastrt"),H=B.getData("lrecrt"),w=B.getData("ldrbrt"),K=B.getData("defaultrt"),D=B.getData("currentpos"),I={},z=B.getData("lrec2SelectiveEnabled")==="1",u,C="",A=e;if(window.facCustomTimout&&window.facCustomTimout>0){v+=" ctout="+window.facCustomTimout;}if(window.flSAKey&&"undefined"!==window.flInstalled){v+=" "+window.flSAKey+"="+window.flInstalled;}if(window.segBlob){var J="";var M="";for(var y in window.segBlob){if(window.segBlob.hasOwnProperty(y)){J+=M+y+":"+window.segBlob[y];M=";";}}v+=' rs="'+J+'"';}if(window.YAHOO&&window.YAHOO.i13n){C=window.YAHOO.i13n.currentSID||"";A=window.YAHOO.i13n.SPACEID||e;}if(!L){I[D]={autoIV:1,autoMax:25,autoRT:K};if(x){I.LREC4={autoIV:1,autoMax:25,autoRT:K};}if(F){I.MON2={autoIV:1,autoMax:25,autoRT:K};}}if(t&&a.Array.indexOf(window.pageloadNonCollapsedAds||[],"MAST")>=0){I.MAST={autoIV:1,autoMax:25,autoRT:t};}if(w&&a.Array.indexOf(window.pageloadNonCollapsedAds||[],"LDRB")>=0){I.LDRB={autoIV:1,autoMax:25,autoRT:w};}if(H&&a.Array.indexOf(window.pageloadNonCollapsedAds||[],"LREC")>=0){I.LREC={autoIV:1,autoMax:25,autoRT:H};}u={ps:I,name:"AUTO",sp:A,autoStart:1,autoMax:25,autoRT:G,autoIV:1,autoDDG:1,ssl:E,secure:1,ref:window.location.href,npv:1,property:"fp",ult:s,experience:{pt:"index",pd:"modal",rid:window.Af.context.rid,sid:C,bucket:window.Af.context.bucket}};if(bucketSAEnabled){u.sa=v;}return u;},i.prototype.fetchAdLater=function(v){var u=this;var s=0;var t=setInterval(function(){if(s>20){clearInterval(t);return;}if(!r.inProgress()){clearInterval(t);u.fetchDarlaAd(v);}s++;},500);},i.prototype.fetchDarlaAd=function(J){var M,O,F,s,ab,V,A=this,E,x=false,Q=false,C=false,T=a.one(m),L=T.getData("config"),y=T.getData("lrec4pos")||"LREC4",N=T.getData("mon2pos")||"MON2",v=a.one("#my-adsLREC3")&&a.one("#my-adsLREC3").getData("config"),W=a.one("#my-ads"+y)&&a.one("#my-ads"+y).getData("config"),H=a.one("#my-ads"+N)&&a.one("#my-ads"+N).getData("config"),G={pos:"LREC2",clean:"my-adsLREC2",dest:"my-adsLREC2-iframe",metaSize:true,w:300,h:250,supports:false},w={pos:"LREC3",clean:"my-adsLREC3",dest:"my-adsLREC3-iframe",metaSize:true,w:300,h:250,supports:false},X={pos:y,clean:"my-ads"+y,dest:"my-ads"+y+"-iframe",metaSize:true,w:300,h:250,supports:false},R={pos:N,clean:"my-ads"+N,dest:"my-ads"+N+"-iframe",metaSize:true,w:300,h:600,supports:false},D={pg:{property:"fp",test:window.Af.context.bucket,intl:window.Af.context.region,rid:window.Af.context.rid,device:window.Af.context.device}},S='Y-BUCKET="'+window.Af.context.bucket+'"',z=(window.location.protocol==="http:")?0:1,I,K=a.one(m).getData("lrec2SelectiveEnabled")==="1",t="",Z=e;ab=T.getData("autoeventrt");if(ab){ab=parseInt(ab,10);}if(window.facCustomTimout&&window.facCustomTimout>0){S+=" ctout="+window.facCustomTimout;}if(window.flSAKey&&"undefined"!==window.flInstalled){S+=" "+window.flSAKey+"="+window.flInstalled;}if(window.segBlob){var B="";var P="";for(var aa in window.segBlob){if(window.segBlob.hasOwnProperty(aa)){B+=P+aa+":"+window.segBlob[aa];P=";";}}S+=' rs="'+B+'"';}if(window.YAHOO&&window.YAHOO.i13n){t=window.YAHOO.i13n.currentSID||"";Z=window.YAHOO.i13n.SPACEID||e;}if(L){G=a.JSON.parse(L);o=G.pos;}if(W){X=a.JSON.parse(W);n=X.pos;}if(H){R=a.JSON.parse(H);h=R.pos;}G.id=o;x=T.getData("autorotate")==="1";F=g+"_"+o.toLowerCase();C=T.getData("lrec4enabled")==="1";mon2Enabled=T.getData("mon2enabled")==="1";E=o;if(C){E=E+","+n;}if(mon2Enabled){E=E+","+h;}M={ps:E,name:F,sp:Z,ssl:z,secure:1,ref:window.location.href,npv:1,property:"fp",ult:D,experience:{pt:"index",pd:"modal",rid:window.Af.context.rid,sid:t,bucket:window.Af.context.bucket}};if(bucketSAEnabled){M.sa=S;}var Y=C?[X,G]:[G];if(mon2Enabled){Y.push(R);}if(r.inProgress()){var U=r.inProgress();if(U&&U===l){r.abort();r.add(M);r.addPos(Y);r.event(F);}else{this.fetchAdLater(J);return;}}else{if(K){r.add(M);r.addPos([Y]);r.event(F);}}V=A.getAutoEvent();if(x){r.add(V);}if(!r.isAutoOn()){r.startAuto();}var u=function(){if(r.inProgress()){var ac=r.inProgress();if(ac&&ac===l){r.abort();}else{return;}}f=true;if(A.scrollevent){A.scrollevent.detach();A.scrollevent=null;}if(x){r.add(V);if(!r.isAutoOn()){r.startAuto();}}q="";var ae=false;var ad=document.getElementById("my-adsMON2");ae=ad&&ad.className.indexOf("D-n")===-1;if(A.isNodeInViewport(d)){if((mon2Enabled&&!ae)||!mon2Enabled){q=q?q+","+o:o;}if(mon2Enabled&&ae){q=q?q+","+h:h;}else{if((C&&!ae)||!mon2Enabled){q=q?q+","+n:n;}}}if(q){M.ps=q;r.add(M);r.event(F);}};a.Af.Event.on("modal:hide",u);};i.prototype.destructor=function(){};a.My.Extensions.Sda.init=new i();},"0.0.1",{requires:["node-scroll-info","json-parse"]});/* Copyright (c) 2019, Yahoo! Inc.  All rights reserved. */
