!function(t,e,i,s){function r(t){setTimeout(t,0)}function n(t,e){if(q){var i=j.console;i&&(e&&i[e]?i[e]("HVT : ",t):i.trace?i.trace("HVT : ",t):i.log&&i.log("HVT : ",t))}}function a(t){n(t+" >> http://dev.hypers.com.cn/tracker/video/debug.html","error")}function o(){var t;try{t=j.top.document.referrer}catch(i){n(i);try{t=j.parent.document.referrer}catch(i){n(i),t=e.referrer}}return t}function h(t,i){var r,n=c(),a=e.getElementsByTagName("head")[0];j[n]=function(){i.apply(j,arguments),a.removeChild(r),j[n]=s},t+="&jsonp="+n,r=e.createElement("script"),r.type="text/javascript",r.charset="utf-8",r.src=t,a.insertBefore(r,a.firstChild)}function c(){for(;;){var t=Math.random().toString(36).toUpperCase();if(t=/[A-Z][A-Z0-9]{7}/.exec(t))return t[0]}}function l(){}function u(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent("on"+e,i)}function d(t,e,i){t.addEventListener?t.removeEventListener(e,i):t.detachEvent("on"+e,i)}function _(t,e){var i,s={};for(i in t)t.hasOwnProperty(i)&&(s[e+i]=t[i]);return s}function f(t){var e,i,r=[];for(e in t)if(t.hasOwnProperty(e)){if(i=t[e],i===s||""===i)continue;p(i)||(i=[i]);for(var n=0;n<i.length;n++)r.push(e.toLowerCase()+"="+encodeURIComponent(i[n]))}return r.join("&")}function p(t){return"[object Array]"===Object.prototype.toString.call(t)}function v(t,e,i){if(p(e)){t=t||[];for(var s=0;s<e.length;s++)i&&null!==e[s]&&"object"==typeof e[s]?t[s]=v(t[s],e[s],!0):t[s]=e[s]}else{t=t||{};for(var r in e)i&&null!==e[r]&&"object"==typeof e[r]?t[r]=v(t[r],e[r],!0):t[r]=e[r]}return t}var g,m,y,b,T,w,k="//t.hypers.com/hva/storage.swf",M="//t.hypers.com/hva/storage.html",I="//t.hypers.com/hvt",S="_hid",x="1.7.1",F="1.0.1",B="HyperVideoAnalyticsObjects",j=t,q=!!(j._tracker_debug||location.search.indexOf("_tracker_debug")>-1);w={},function(i){function s(e,i){function s(t,e){switch(t){case"onecall":if(!_[e])return;_[e].apply(j,[].slice.call(arguments,2)),_[e]=null;break;case"load":h._inited=!0,clearTimeout(h._tid),clearTimeout(h._tid2),u(),n("FlashStorage loaded");break;default:h._inited=!1,d(),n("Flash Error:"+e)}}if(!o())return r(i);var h=this,u=function(){i(h),u=d=l},d=function(){i(),u=d=l,h.destroy(),n("FlashStorage failed")};e+="#";var _=this._callbackMap={},f=this._proxyFn=c();t[f]=function(){var e=arguments;r(function(){s.apply(t,e)})},this._swf=a(e,f),this._tid=setTimeout(function(){h._inited||d()},3e3),this._tid2=setTimeout(function(){h._inited||"undefined"!=typeof h._swf.Play||d()},100)}function a(t,i){var s=e.createElement("div");return s.setAttribute("style","display:block;position:absolute;left:0;top:0;border:none;width:0;padding:0"),s.innerHTML='<object onerror="'+i+'" id="'+c()+'" data="'+t+'"  type="application/x-shockwave-flash" width="10" height="10"><param name="movie" value="'+t+'" /><param name="wmode" value="transparent" /><param name="version" value="10" /><param name="allowScriptAccess" value="always" /><param name="flashvars" value="jsproxyfunction='+i+'" /></object>',r(function(){e.body.insertBefore(s,e.body.firstChild)}),s.firstChild}function o(){var e=0;try{var i=t.navigator.plugins["Shockwave Flash"]||t.ActiveXObject;i?(e=i.description||new i("ShockwaveFlash.ShockwaveFlash").GetVariable("$version"),e=+((e+"").match(/\d+/g)||[0])[0]):e=0}catch(s){n("Flash not available:"+s.message,"error")}return e>=10}i.exports={create:function(t,e){return new s(t,e)},_Class:s},s.prototype={_inited:!1,get:function(t,e){this._sendMsg(e,"jGetItem",t)},set:function(t,e,i){this._sendMsg(i,"jSetItem",t,e)},destroy:function(){this._proxyFn&&t[this._proxyFn]&&(t[this._proxyFn]=l),this._callbackMap={},this._sendMsg=l;var e=this._swf;if(e){var i=e.parentNode;i.removeChild(e),i.parentNode.removeChild(i),this._swf=null}clearTimeout(this._tid),clearTimeout(this._tid2),this.destroy=l},_sendMsg:function(t,e,i,s){t=t||l;var r=c(),n=arguments.length,a=this._swf;this._callbackMap[r]=t,2==n?a[e](r):3==n?a[e](i,r):a[e](i,s+"",r)}}}(w),g=w.exports,w={},function(i){function s(e,i){function s(t){var e=(t.data+"").split("#"),i=e[0],s=e[1];s===p&&("loaded"===i?(d._inited=!0,clearTimeout(v),n("IFrameStorage loaded"),r(_)):d._onMessage(i))}if(!a())return r(i);var h,d=this,_=function(){i(d),h.onerror=h.onabort=_=f=l},f=function(){i(),_=f=l,d.destroy()};u(t,"message",s),this._msgHandler=s;var p=this._id=c(),v=setTimeout(function(){d._inited||f()},3e3);this._tid=v,this._iframe=h=o(e,p),h.onerror=h.onabort=function(){r(f),n("IFrameStorage error or aborted")}}function a(){try{if(t.postMessage&&t.localStorage){var e=t.localStorage,i=c();return e.setItem(i,i),e.removeItem(i),!0}}catch(s){n("IFrame not available:"+s.message,"error")}return!1}function o(t,i){var s=e.createElement("iframe");return s.style.display="none",s.src=t+"#"+i,r(function(){e.body.appendChild(s,e.body.firstChild)}),s}i.exports={create:function(t,e){return new s(t,e)},_Class:s},s.prototype={_inited:!1,_onMessage:l,get:function(t,e){this._sendMsg(e,"getItem",t)},set:function(t,e,i){this._sendMsg(i,"setItem",t,e)},destroy:function(){this.destroy=this._sendMsg=l,clearTimeout(this._tid);var e=this._iframe;e&&(d(t,"message",this._msgHandler),setTimeout(function(){e.parentNode.removeChild(e)},100))},_sendMsg:function(t,e,i,s){var a=this;if(this._onMessage!==l)return void(this._tid=setTimeout(function(){a._sendMsg(t,e,i,s)},300*Math.random()|0));this._onMessage=function(e){a._onMessage=l,r(function(){t(e)})};try{this._iframe.contentWindow.postMessage([e,i,s].join("#"),"*")}catch(o){n("IFrame postMessage error:"+o.message,"error"),this._onMessage=l,t()}}}}(w),m=w.exports,w={},function(t){function e(t,e){function r(t){if(t)u.push(t),_++;else if(d++,d===c)return n("All storages failed"),h();d+_===c&&e(o)}var a=[],o=this,h=function(){e(),h=e=l,o.destroy()};t.disable_flash||a.push([i,t.swf_url]),t.disable_iframe||a.push([s,t.iframe_url]);var c=a.length;if(!c)return n("All storages disabled"),void h();this._createdStores=[];for(var u=this._availStores=[],d=0,_=0,f=0;c>f;f++){var p=a[f],v=p[0],g=p[1];this._createdStores.push(v.create(g,r))}}var i=g,s=m,r="___";t.exports={create:function(t,i){return new e(t,i)},_Class:e},e.prototype={get:function(t,e){function i(t){for(var i,s=0;s<t.length;s++){var n=t[s];if(n){if(n=n.split(r),n.length<2){i=n[0];break}(!i||i[0]>n[0])&&(i=n[1])}}e(i)}this._call("get",[t],i)},set:function(t,e,i){e=(+new Date).toString(36)+r+e,this._call("set",[t,e],i)},destroy:function(){var t=this._createdStores;if(t)for(var e=0;e<t.length;e++)t[e].destroy();this._availStores=this._createdStores=null,this.destroy=l,this._call=l},_call:function(t,e,i){function s(t){t&&"undefined"!=t&&n.push(t),a--,!a&&i&&i(n)}var r=this._availStores,n=[],a=r.length;e.push(s);for(var o=0;a>o;o++)r[o][t].apply(r[o],e)}}}(w),y=w.exports,w={},function(t){function u(t){if(this._trackers={},t&&t.length)for(var e=0;e<t.length;e++)this.push(t[e])}function d(t,e,i){function s(t){t?(r._storage=t,t.get(e.storage_id,function(i){i?(n("Got hid from cache:"+i),r._hid=i,t.set(e.storage_id,i,l),r._afterReady()):r._sendFirstTrack()})):r._sendFirstTrack()}var r=this;this._queue=[],this._ua=t,this._options={},this.name=i,this._settings=e=v({api_url:I,with_ref:!0,disable_flash:!0,disable_iframe:!0,force_ssl:!1,storage_id:S,swf_url:k,iframe_url:M,name:i},e||{});var o=e.force_ssl,h=e.api_url;h=m(h,o),~h.indexOf("?")||(h+="?");var c=h.slice(-1);return"?"!==c&&"&"!==c&&(h+="&"),e.api_url=h,t&&"string"==typeof t?void b.create({swf_url:e.swf_url,iframe_url:e.iframe_url,disable_flash:e.disable_flash,disable_iframe:e.disable_iframe},s):a(23001)}function p(t,e){t.get_progress||(t.get_progress=l);var i=t.heart_beat_interval;if(null!=i&&(1>+i||(0|i)!=i))return a(23006);this._interval=1e3*(i||30),this._getProgress=t.get_progress,this._parentTracker=e;var s=t.onHeartBeat;s&&(s._disposable_=!1);var r=this;this._sendHeartBeat=function(){r.spendMs+=g()-r._lastBeatTime,r._lastBeatTime=g(),r._send("heart_beat",s)}}function g(){return T}function m(t,e){return/^http/.test(t)||(t=location.protocol+t),e&&(t=t.replace(/^http:/,"https:")),t}t.exports=u;var b=y;u.prototype={push:function(t){if(t=[].slice.apply(t),t.length){var e,i="default";if(e=t[0].split("."),2===e.length?(i=e[0],e=e[1]):e=e[0],"create"===e&&(i=(t[2]||{}).name||i),"create"===e)return void(this._trackers[i]=new d(t[1],t[2],i));var s=this._trackers[i];if(!s)return void n("Tracker "+i+" is undefined");if(!s[e])return void n("Tracker method "+i+"."+e+" is undefined");if("destroy"===e)return s.destroy(),void delete this._trackers[i];t.shift(),t.unshift(e),s.invoke(t)}}},d.prototype={_storage:null,_disabled:!1,invoke:function(t){var e=t.shift();this[e].apply(this,t)},isDisabled:function(){return j._hvt_disable||j["_hvt_disable_"+this.name]||this._disabled},enable:function(){this._disabled=!1},disable:function(){this._disabled=!0},destroy:function(){this._ready?(this.disable(),this._storage&&this._storage.destroy(),this._autoTracker&&this._autoTracker.destroy(),this._sendTrack=this.destroy=l):this._pendingDestroy=!0},init:function(t,i,s){return t.type?("auto"===t.type&&(this._autoTracker=new p(t,this)),this._options=v({title:e.title,url:location.href},i),void(this._settings.with_ref&&(this._options.ref=o()))):a(23002)},set:function(t){v(this._options,t,!0)},send:function(t,e,i,r){if("start"===t)this._options.upid=c();else if("action"===t){t="act";var n=e,o=i;if(!n||"string"!=typeof n)return a(23005);i=r,e={act_name:n,params:o}}else if("end"!==t){if(!e)return a(23003);if(e.spend=+e.spend,isNaN(e.spend)||!isFinite(e.spend))return a(23003)}e=e||{},e.type=t,i&&i._disposable_===s&&(i._disposable_=!0),this._sendTrack(e,i)},auto_track:function(t,e){return this._autoTracker?void this._autoTracker[t](e):a(23007)},_sendTrack:function(t,s){var r=this;t=v(v({},this._options,!0),t,!0),t.title=(t.title||e.title).slice(0,200);var n=_(t.params||{},"p_");delete t.params;var o=t.info;if(delete t.info,!o.v_id)return a(23004);var h=t.api_version||x;delete t.api_version;var c={};v(c,t),v(c,n),v(c,o),v(c,{_ua:this._ua,v:h,sv:F,sr:j.screen.width+"x"+j.screen.height,sd:j.screen.colorDepth,lang:i.language||i.userLanguage,"char":e.characterSet||e.charset}),c.len=c.len&&1e3*c.len,c.progress=c.progress&&1e3*c.progress,c.spend=c.spend&&1e3*c.spend,r.isDisabled()||this._enqueue(c,s||l)},_enqueue:function(t,e){this._queue.push([t,e])},_afterReady:function(){this._ready=!0,this._enqueue=this._sendIt;for(var t=this._queue.slice(),e=0;e<t.length;e++)this._sendIt(t[e][0],t[e][1]);this._queue=null,this._pendingDestroy&&this.destroy()},_sendFirstTrack:function(){function t(t){var e=function(e,s){i._hid=e,n("Got hid from first track:"+e),i._storage?i._storage.set(i._settings.storage_id,e,function(){i._afterReady()}):i._afterReady(),t(e,s)};return e._disposable_=t._disposable_,e}var e=this._queue,i=this;if(e.length)e=e.shift(),this._sendIt(e[0],t(e[1]));else{var s=this._enqueue;this._enqueue=function(e,r){i._enqueue=s,i._sendIt(e,t(r))}}},_sendIt:function(t,e){var i=this._settings;t.has_cache=!!this._storage,t[i.storage_id]=this._hid,t=f(t);var s=i.api_url+t;h(s,function(t){e(t,s)})}},p.prototype={spendMs:0,_tid:0,_lastBeatTime:0,start:function(t){clearInterval(this._tid),this._tid=setInterval(this._sendHeartBeat,this._interval),this._lastBeatTime=g(),this._send("start",t)},pause:function(t){clearInterval(this._tid),this._lastBeatTime&&(this.spendMs+=g()-this._lastBeatTime,this._lastBeatTime=0),t&&r(t)},resume:function(t){clearInterval(this._tid),this._tid=setInterval(this._sendHeartBeat,this._interval),this._lastBeatTime=g(),t&&r(t)},end:function(t){clearInterval(this._tid),this._lastBeatTime&&(this.spendMs+=g()-this._lastBeatTime,this._lastBeatTime=0),this._send("end",t)},destroy:function(){clearInterval(this._tid),this.destroy=this._send=l},_send:function(t,e){var i={progress:this._getProgress(),spend:Math.ceil(this.spendMs/1e3)};this._parentTracker.send(t,i,e)}};var T=+new Date;setInterval(function(){T+=1e3},1e3)}(w),b=w.exports,w={},function(t){for(var e=b,i=j[B]=j[B]||["_hvt"],s=0;s<i.length;s++){var r=i[s];j[r]._version_=F,j[r].q&&j[r].q instanceof e||(j[r].q=new e(j[r].q))}}(w),T=w.exports}(window,document,navigator);