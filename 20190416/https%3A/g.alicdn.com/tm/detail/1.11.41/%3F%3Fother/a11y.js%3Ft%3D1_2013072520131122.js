KISSY.add("malldetail/other/a11y",function(e,t,n,a,o){var i=e.all,r=a.instance(),l=function(){};l.prototype={"constructor":l,"init":function(){n.attr("#J_DetailMeta","role","form"),n.attr("#mainwrap","role","main"),n.attr("#footer,#page-footer","role","contentinfo"),n.attr("#J_DcShopArchive","role","complementary")}};var c=function(){};c.prototype={"constructor":c,"init":function(){var e=n.query("#J_UlThumb img");n.attr(e,"alt","\u5546\u54c1\u9884\u89c8\u56fe")}};var s=function(){};s.prototype={"constructor":s,"init":function(){var e=n.query("textarea.ks-datalazyload");n.attr(e,"tabindex","-1")}};var d=function(){};d.prototype={"constructor":d,"select":function(e,t){if(t){var a=n.text(e)||null;a&&n.attr(e,"aria-label",a+"\uff0c\u5df2\u9009\u62e9")}else n.removeAttr(e,"aria-label")},"init":function(){var t=this,a=n.query(".tb-sku","#detail"),o=n.query("ul.J_TSaleProp li,ul.tm-relate-list li,ul.serviceList li,ul li.j_CateTab,ul.j_Area li,ul li[data-planid]",a),i=n.query("a,span[title]",o);n.attr(i,"role","button"),n.attr(i,"tabindex","0"),r.onChange(["selectedSkuProp","skuPropSelectivity","thirdPartyInventory"],function(a){e.each(i,function(e){var o=n.parent(e,function(e){return!0}),i=o&&o.getAttribute("data-value")?o.getAttribute("data-value"):"",l=i.split(":");l[1]?(a[l[0]]==l[1]?t.select(e,!0):t.select(e,!1),r.canSelectSkuProp(i,"",function(t){t<=0?n.attr(e,"aria-disabled",!0):n.removeAttr(e,"aria-disabled")})):n.hasClass(o,"tm-relate-current")||n.hasClass(o,"tb-selected")?t.select(e,!0):t.select(e,!1),n.hasClass(e,"wt-area-name")&&n.attr(e,"aria-haspopup",!0)})})}};var u=function(){};u.prototype={"init":function(){var t=n.query(".tb-sku","#detail"),a=n.query("ul.serviceList",t),o=n.query("li",a),i=n.query("a",o),l=function(t){e.each(i,function(e){var a=n.parent(e,function(e){return!!e.getAttribute("data-value")}),o=a?a.getAttribute("data-value"):"";if(t&&t[o]&&t[o].checked||n.hasClass(a,"tb-selected")){var i=n.text(e)||null;i&&n.attr(e,"aria-label",i+"\uff0c\u5df2\u9009\u62e9")}else n.removeAttr(e,"aria-label")})};l(),r.onChange(["cacheSelectedService","currentService"],function(e){e&&l(e)})}};var m=function(){};m.prototype={"constructor":m,"init":function(){i(".tb-action a").attr("role","button")}};var p=function(){};p.prototype={"constructor":p,"init":function(){setTimeout(function(){try{var e=i('#J_TabBar li[role="tab"]');e.each(function(e,t){n.prop(this,"index",t)});var a=i("#J_TabBar li.tm-selected").item(0).prop("index");t.delegate(document,"keydown","#J_TabBar",function(n){function o(){a++,a==e.length&&(a=0),e[a]&&(t.fire(e[a],"click"),e[a].focus())}function r(){a--,-1==a&&(a=e.length-1),e[a]&&(t.fire(e[a],"click"),e[a].focus())}var l=n.keyCode;switch(a=i("#J_TabBar li.tm-selected").item(0).prop("index"),l){case 37:case 38:r(),n.preventDefault(),n.stopPropagation();break;case 39:case 40:o()}})}catch(o){}},1e3)}};var f=function(t){var n=0,a={"objs":[]};this.config=e.mix(a,t),this.keyCount=function(){return++n}};return f.prototype={"init":function(){this.initEvent(),this.load(this.config)},"load":function(e){if(e&&e.objs)for(var t=e.objs,n=0;n<t.length;n++)try{t[n].init()}catch(a){}},"initEvent":function(){var e=this,n=function(a){9==a.keyCode&&e.keyCount()>2&&(t.detach("body","keyup",n),window.goldlog&&goldlog.record("/tmalldetail.a11y.tab","CLK","","H47671267"))};t.delegate(document,"keydown","[role=button],[role=tab]",function(e){32!=e.keyCode&&13!=e.keyCode||(e.preventDefault(),e.target.click())}),t.on("body","keyup",n)}},new f({"objs":[new d,new m,new u,new s,new c,new l,new p]})},{"requires":["event","dom","detail-model/product","ua"]});