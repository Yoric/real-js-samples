KISSY.add("malldetail/other/mainBody",function(e,t,a,n,i,o){return{"init":function(r){codeTrack("view.mainBody.init","view.main.init");var l=window,c=l.g_config,d=this,s=r.product;e.mix(d,r),s.onLoad("config",function(t){if(!t||!t.detail||!1!==t.detail.showCartRecommend){var a=null;s.onChange(["tradeResult","itemDO"],function(n,i){n&&!n.level&&e.use("malldetail/recommend/basketrecommend,malldetail/recommend/basketrecommend.css",function(e,n){a&&clearTimeout(a),a=setTimeout(function(){n.load(null,null,i.categoryId,t)},2500)})})}});var u=t.get("#J_SaleCombo");u&&TShop.addLazyCallback(u,function(){s.onLoad(["comboList","currentAmountRestrict","gateway","itemDO"],function(t,a,n,i){r.onComboListReady&&r.onComboListReady(t),t&&!i.isHotItem&&(a&&0===a.amountCanBuy||n&&n.trade&&"umpkey"in n.trade.addToCart||e.use("malldetail/body/combo",function(e,t){t.init({"product":s,"el":u})}))})});var m=t.get("#J_LadeMap");m&&TShop.addLazyCallback(m,function(){codeTrack("mod.ladeMap.init","view.mainBody.init"),s.onLoad(["itemDO"],function(e){m.innerHTML='<iframe src="//map.'+(TShop.isDaily()?"daily.taobao.net":"taobao.com")+"/item/index.htm?itemid="+e.itemId+'" scrolling="no" frameborder="0" marginheight="0" marginwidth="0" width="100%" height="100%"></iframe>',codeTrack("mod.ladeMap.show","mod.ladeMap.init")})});var p=t.get("#promote");p&&s.onLoad("mdskip",function(a){a.defaultModel.itemPriceResultDO.hideMeal?t.hide(p):TShop.addLazyCallback(p,function(){s.onLoad(["meal","currentAmountRestrict"],function(a,n){if(!a||n&&0==n.amountCanBuy)return void t.addClass(p,"hidden");e.use("malldetail/sku/promotion,malldetail/sku/promotion.css",function(e,t){t.init({"el":p,"data":a})})})})});var f=t.get("#J_Shoppromotions");f&&TShop.addLazyCallback(f,function(){s.onLoad("Extension",function(e){var a=e&&e.shopPromotionDO;(a=a&&!1!==a.success&&a.shopPromotion?a.shopPromotion:null)&&(t.html("#J_Shoppromotions",a),codeTrack("mod.shopPromotion.old","view.mainBody.init"))})});var h=t.get("#J_BrandAttr");!l.g_config.offlineShop&&h&&TShop.addLazyCallback(t.parent(h),function(){s.onLoad("config",function(t){var a=t&&t.itemDO;a&&a.brandId&&e.use("malldetail/body/brand,mui/brandbar/brandbar.css",function(e,n){n.init(e.mix({"product":s,"config":t,"el":h},a))})})});var v=t.get("#J_youpin");TShop.addLazyCallback(v,function(){e.use("malldetail/tabbar/youpin",function(e,t){t.init({"container":v})})}),s.onLoad("itemDO",function(n){if(n.baikeId){var o=t.get("#J_AttrList");if(o){var r=t.create('<div class="tb-validity" style="height:48px;line-height:48px;border-bottom:1px solid #d7d7d7; border-top:0; margin-top:0"><img src="//img-tmdetail.alicdn.com/tps/i2/T1uyf4FMBaXXceU5Yh-48-48.png" style="vertical-align:middle;" width="48" height="48">\u5546\u54c1\u5177\u6709: <a href="//baike.taobao.com/view.htm?id='+n.baikeId+'" target="_blank">\u5316\u5986\u54c1\u6279\u51c6\u6587\u53f7</a> \uff0c\u7b26\u5408\u56fd\u5bb6\u98df\u54c1\u836f\u54c1\u76d1\u7ba1\u5c40\u5316\u5986\u54c1\u6ce8\u518c\u8981\u6c42\u3002 </div>');t.prepend(r,o)}}if(n.isNewProGroup){if(n.newProGroup&&0!=n.newProGroup.length||n.attachImgUrl&&0!=n.attachImgUrl.length){var l=t.get("#J_standardAttrs");l&&TShop.addLazyCallback(l,function(){e.use("malldetail/tabbar/standardAttr",function(e,t){t.init({"parentEl":l,"itemDO":n})})})}}else{var c=n.tagPicUrl,l=t.get("#J_AttrList p.attr-list-hd");c&&l&&TShop.addLazyCallback(l,function(){e.use("malldetail/tabbar/tabbarAttr",function(e,t){t.init({"tagPicUrl":c,"parentEl":l})})})}a.on(".tm-MRswitchAttrs","click",function(e){codeTrack("mod.tabbarAttr.switch","view.mainBody.init"),e.preventDefault(),i.switchTo("J_Attrs"),TShop.sendAtpanel("tmalldetail.10.17")})}),a.delegate("#mainwrap","click",".J_DeliveryService",function(e){codeTrack("mod.dianbaobao.J_DeliveryService","view.mainBody.init"),e.preventDefault();var a=t.test(e.target,".J_DeliveryService")?e.target:t.parent(e.target,".J_DeliveryService"),n=t.attr(a,"href");i.switchTo("J_ServiceTab"),t.scrollTop(t.offset("#J_ServiceTab").top),setTimeout(function(){t.offset(n)&&(t.scrollIntoView(n),t.scrollTop(t.offset(n).top-40)),TShop.refreshLazy()},0)}),TShop.addLazyCallback(t.get(".tm-home-info"),function(){e.use("malldetail/css/detail-home.css")}),TShop.addLazyCallback(t.get(".tm-home-des"),function(){e.use("malldetail/css/detail-home.css")}),s.onLoad(["trade","config"],function(e,a){!e||1!=a.tradeType&&3!=a.tradeType||(codeTrack("mod.dianbaobao.init","view.mainBody.init"),t.hide("#dianbaobao"))});var g=t.get("#trydetail");if(g&&TShop.addLazyCallback(g,function(){e.use("malldetail/tabbar/try",function(e,t){t.init({"container":g})})}),a.delegate(t.get("#mall-banner .tm-3c-des"),"click","a",function(){return i.switchTo("J_ServiceTab"),t.scrollTop(t.offset("#J_ServiceTab").top),!1}),s.onLoad(["config"],function(a){var n=t.get(".content","#description");!n||a.detail&&!1===a.detail.showDesc||o.init({"el":n,"product":s,"cdn75":a.detail.cdn75,"success":function(a){r.onDescReady&&r.onDescReady(a),s.onLoad("model",function(a){var n=a.detailPageTipsDO;n&&n.jhs99&&e.getScript("//www.tmall.com/market/chaoshi/j99.php",function(){var e=window.tempActImage;if(e){var a=t.create(e);t.append(a,"#J_TmpActBanner")}})})}})}),s.onLoad(["config","bucketId"],function(a,i){function o(){codeTrack("mod.xinde.init","view.mainBody.init");var t=(c.isDaily?"//g-assets.daily.taobao.net/":"//g.alicdn.com/")+"tm/beauty/"+r+"/seed.js";e.getScript(t,{"success":function(){e.use("beauty/dtlentry",function(e,t){s.onLoad(["itemDO"],function(e){t.init({"container":l,"itemId":e.itemId}),codeTrack("mod.xinde.show","mod.xinde.init")})})}})}var r=window.g_config.beautyVesion||"1.4.1";if(a.tag&&a.tag.isShowMeiliXinde&&n.bucketStat(i,window.g_config.beautyBucketTestIdArray)){var l=t.create('<div id="J_DtlentryBox" class="visabeauty"></div>');TShop.addLazyCallback(l,o),t.insertBefore(l,"#description")}}),s.onLoad(["config"],function(a){function n(t){e.use("ajax",function(e,a){s.onLoad(["itemDO","config"],function(e,n){a.jsonp(n.url.extMdskip+"/extension/query_ecity_service.htm",{"itemId":e.itemId},t)})})}function i(){l||(l=!0,codeTrack("mod.faq3c.init","view.mainBody.init"),n(function(e){e&&!1!==e.isSuccess&&(t.html(o,'<div class="tmP3ct"><h2>\u5e97\u94fa\u670d\u52a1\u8be6\u60c5</h2></div>'+(e.apprService||"")),t.html(r,'<div class="tmP3ct"><h2>\u5e38\u89c1\u95ee\u9898</h2></div>'+(e.freqQuestion||"")),codeTrack("mod.faq3c.show","mod.faq3c.init"))}))}if(a.detail&&!0===a.detail.isShowEcityDesc){var o=t.create('<div id="J_ShopService" class="pledge3c"></div>'),r=t.create('<div id="J_Faq" class="pledge3c"></div>'),l=!1;TShop.addLazyCallback(o,i),TShop.addLazyCallback(r,i),t.insertBefore(o,"#J_Detail"),t.insertBefore(r,"#J_Detail")}}),s.onLoad(["config","itemDO"],function(t,a){t.detail&&t.detail.showFushiPoiInfo&&e.use("malldetail/other/store",function(e,t){t.init(a)})}),s.onLoad(["config"],function(t){var a=t.valFlashUrl;a&&e.use("malldetail/other/flashplayer",function(e){e.TmdFlv.init(a)})}),e.log("TMDLOG:itemDesc-domready","info"),!c.offlineShop){var b=!1,y=!1,k=t.get("#J_TabRecommends");k&&s.onLoad(["config","bucketId"],function(a,n){if(!1!==a.detail.showAlbumRecommend&&a.tagsId&&e.inArray("11650",a.tagsId.split(","))){var i=t.create('<div id="J_AlbumRecommends"><h4 class="hd hidden">\u54c1\u724c\u4e13\u8f91</h4><div class="album-hd hidden"><s></s><span>\u8d2d\u7269\u65b0\u98ce\u5c1a\uff0c\u7cbe\u5f69\u6a71\u7a97\u901b\u4e0d\u505c</span></div><div class="albumPanel tm-clear"></div></div>');t.insertBefore(i,k),e.use("malldetail/body/album.css"),TShop.addLazyCallback(i,function(){e.use("malldetail/body/album",function(e,n){s.onLoad("itemDO",function(e){n.init({"itemDO":e,"shopId":a.rstShopId,"el":t.get(".albumPanel",i),"onLoad":function(e){e&&e.list&&e.list.length&&(t.removeClass(t.get("h4.hd",i),"hidden"),t.removeClass(t.get("div.album-hd",i),"hidden"))}})})})})}else!1!==a.detail.showTabbarRecommend?TShop.addLazyCallback(k,function(){b=!0,e.use("malldetail/recommend/waterfall,waterfall,malldetail/recommend/waterfall.css",function(e,t){t.init({"config":r,"rstShopId":a.rstShopId,"isTwView":a.isTwView||a.isWorldView,"itemDO":a.itemDO})})}):t.hide(k)})}TShop.addLazyCallback("#J_Reviews",function(){s.onChange("reviewCount",function(a){null!=a.rateTotal&&e.each(t.query("#J_Reviews em.J_ReviewsCount"),function(e){e.innerHTML=a.rateTotal,t.show(e)})}),e.use("malldetail/tabbar/reviewsTmall",function(e,a){a.init(e.mix({"product":s,"switchTab":function(e){i.switchTo(e),i.scrollIntoView()}},d.reviewConfig)),s.onLoad("config",function(a){!a||!1===a.detail.showTabbarRecommend||t.hasClass("html","TMDrate")||"J_Reviews"!=i.curIndex()||b||(y=!0,e.use("malldetail/recommend/tabbar",function(e,n){n.onHtml(function(e){function a(){"description"==i.curIndex()?(t.hide(n),t.removeClass("#J_Reviews","j_hideReviews2Recommend")):(t.show(n),t.addClass("#J_Reviews","j_hideReviews2Recommend"))}var n=t.create(e);t.append(n,"#J_Reviews"),TShop.sendAcAtpanel("1.gif",{"com":"02","apply":"detail","cod":"2.1.1","uid":"","ver":"","ip":"","other":""}),codeTrack("info.review.recommend","view.mainBody.init"),a()},{"rstShopId":a.rstShopId,"itemDO":a.itemDO})}))})})});var S=t.get("#J_DealRecord");S&&s.onLoad(["bucketId"],function(t){n.bucketStat(t,c.monthlySalesBucketTestIdArray)||TShop.addLazyCallback(S,function(){e.use("malldetail/tabbar/DealRecord",function(e,t){t.init({"onPagerClick":function(){i&&"J_DealRecord"==i.curIndex()?TShop.sendAtpanel("tmalldetail.3.1"):TShop.sendAtpanel("tmalldetail.3.6")},"onRender":function(){i&&"description"==i.curIndex()&&TShop.sendAcAtpanel("tmalldetail.4.2")},"product":s})})})});var T=e.get("#J_Attrs");T&&TShop.addLazyCallback(T,function(){function t(e){/standard=1/.test(location.search)?s.onLoad("spuMaintainer",e):e(null)}t(function(t){t&&e.use("malldetail/tabbar/Attrs",function(e,a){a.init({"el":T,"maintainer":t})})})});var _=e.get("#J_AfterSales");_&&TShop.addLazyCallback(_,function(){e.use("malldetail/tabbar/AfterSales",function(e,t){t.init()})}),TShop.addLazyCallback("#J_SellerInfo",function(t){e.use("malldetail/tabbar/SellerInfo",function(e,a){a.init({"element":t,"product":s,"success":function(){"description"==i.curIndex()&&TShop.sendAcAtpanel("tmalldetail.4.10")}})})});var w=e.get("#J_TabBar");i.init({"ulNode":w,"contEl":(t.get("#detail")||{}).parentNode,"success":r.onTabBarReady,"product":s}),TShop.addLazyCallback("#J_QualificationTab",function(t){e.use("malldetail/tabbar/qualification",function(e,a){TShop.sendAtpanel("tmalldetail.40.1"),a.init({"el":t,"product":s})})}),i.onSwitch(function(){setTimeout(function(){TShop.refreshLazy()},4)})},"switchTab":function(e){i.switchTo(e),i.scrollIntoView()}}},{"requires":["dom","event","malldetail/common/util","malldetail/tabbar/tabbar","malldetail/other/itemDesc"]});