KISSY.add("mui/mallbar/index",function(a,e,t,i,l,r,m,n,o,s,b,d,_,c,u){var p=window.location.href.indexOf("mbar-mock-bubble=1")>-1,E=['<div class="mui-mbar-plugin {5} mui-mbar-plugin-{0}">','<div class="mui-mbar-plugin-hd">','<a target="{3}" href="{2}" target="_blank" class="mui-mbar-plugin-hd-title {4}">{1}</a>',' <div class="mui-mbar-plugin-hd-tip"></div>',' <div class="mui-mbar-plugin-cover"></div>','<div class="mui-mbar-plugin-hd-close mui-mbar-iconfont">&#xe61b;</div>',"</div>",'<div class="mui-mbar-plugin-bd"><div class="mui-mbar-plugin-load"></div></div>',"</div>"].join(""),T=['<div class="mui-mbar-tab mui-mbar-tab-{2} {4}" style="top:{1}px;">',"{9}",'<div class="mui-mbar-tab-logo mui-mbar-tab-logo-{2}">{7}</div>','<div class="mui-mbar-tab-txt">{3}</div>','<div class="mui-mbar-tab-new" style="display:{5};"></div>','<div class="mui-mbar-tab-sup"></div>','<div class="mui-mbar-tab-tip">{0}<div class="mui-mbar-arr mui-mbar-tab-tip-arr">\u25c6</div></div>','<div class="mui-mbar-arr mui-mbar-tab-logo-arr {8}">\u25c6</div>',"</div>"].join(""),f=(['<div class="mui-mbar-tab-sup-bg">','<div class="mui-mbar-tab-sup-bd">{0}</div>',"</div>"].join(""),['<div class="mui-mbar-tab-bubble mui-mbar-tab-bubble-{0}"><div class="mui-mbar-tab-bubble-bd"></div></div>'].join("")),B=['<div class="mui-mbar-mini">','  <div class="mui-mbar-mini-avatar-def"></div>','  <div class="mui-mbar-mini-mask"></div>','  <div class="mui-mbar-tab-sup"></div>',"</div>",'<div class="mui-mbar-mini-logo"></div>'].join(""),A=[],I=!0,g=!1,O=function(e){var t=parseFloat(a.version);if(_.log("Kissy \u7248\u672c\u68c0\u6d4b\uff1a",a.version,t),!(t<1.3)){var i=this;e=e||{},e.shopConfig=e.shopConfig||window.shop_config,e.gConfig=window.g_config;var l=a.one(document.body)||document.getElementsByTagName("body");if(l&&l.length>0&&(l=a.one(l[0])),e.container=e.container?a.one(e.container):l,!e.container)return void _.log(d.M.B);O.superclass.constructor.call(i,e),i.init()}};return O.ATTRS={"oldIndex":{"value":-1}},a.extend(O,e,{"init":function(){var e=this,t=a.all(_.fm('<div id="J_MUIMallbar" class="mui-mbar-outer j_Mallbar_{0}"><div class="mui-mbar"></div></div>',d.VER)).appendTo(e.get(d.K.CONTAINER));e.set(d.K.ROOT,a.one(".mui-mbar")),e.set(d.K.ROOT_OUTER,t),e.set(d.K.ITEMS,{});var i=new c;e.set(d.K.MODEL,i),i.on(d.E.AFTER_BAR_CHANGE,function(a){_.log(a.type),e.navHeight={},_.getStaticConf({"cb":function(a){_.log("getStaticConf",a),a.topAddHeight&&e.set("topAddHeight",a.topAddHeight),a.notWideTab&&e.set("notWideTab",a.notWideTab);var t=i.get(d.K.TIMESTAMP)||"",l=!1,r=!1;a.tag201511Time&&a.tag201511Time.e&&(l=t>a.tag201511Time.s&&t<a.tag201511Time.e),a.channelTime&&a.channelTime.e&&(r=t>a.channelTime.s&&t<a.channelTime.e),e.tag201511Time=l,e.channelRecommend=r,e.navNarrow=a.navNarrow||"",e.navWideLittle=a.navWideLittle||"",e.navWideBig=a.navWideBig||"",e.navHeight=a.navHeight||{},e.navTopColor=a.navTopColor||"";var m="";if(!!window.g_config&&(m=window.g_config.shopId||""),a.bubbleBlacklist&&a.bubbleBlacklist.length)for(var n=a.bubbleBlacklist.length,o=a.bubbleBlacklist,s=0;s<n;s++)m==o[s]&&e.set("notWideTab",1);e.initBar()}})}),i.getBar({"shopId":e.get(d.K.SHOP_CONFIG)?"1":"","gConfig":e.get(d.K.G_CONFIG),"mallbar":e}),_.getStaticConf({"cb":function(a){var t=a.firstBubbleWaitTime||3;setTimeout(function(){_.log("::mallbar.js::\u9996\u6b21\u6c14\u6ce1\u5df2\u7ecf\u6536\u96c6\u5b8c\u6210"),e.firstBubble()},1e3*t)}})},"initBar":function(){function e(){a.each(I,function(a){a.fire(d.E.VISIBILITY_CHANGE,{"visible":!1})})}function t(){function e(){a.one(".mui-mbar").one(".mui-mbar-tabs").removeClass("mui-mbar-tabs-wide");var e=i.get("offsetYCustom")||0,t=a.one(".mui-mbar-tabs-narrow")||"";if(t){var l=t.one(".mui-mbar-tab-logo-nav-top");if(l){e<(i.navHeight.n||0)?l.css("background-image","none"):a.UA.ie<8||!!i.navNarrow&&l.css("background-image","url("+i.navNarrow+")")}}var r=a.one(".mui-mbar").one(".mui-mbar-tabs-top-wide");!!r&&r.css("height","0px")}function t(){if(i.get("notWideTab"))return void e();a.one(".mui-mbar").one(".mui-mbar-tabs").addClass("mui-mbar-tabs-wide"),i.get("offsetYCustom");var t=a.one(".mui-mbar-tabs-narrow")||"";if(t){var l=t.one(".mui-mbar-tab-logo-nav-top");if(l){var r=i.navHeight.wl||0,m=i.navHeight.wb||0;E<r?l.css("background-image","none"):E>r&&E<m?!!i.navWideLittle&&l.css("background-image","url("+i.navWideLittle+")"):!!i.navWideBig&&l.css("background-image","url("+i.navWideBig+")")}}var n=a.one(".mui-mbar").one(".mui-mbar-tabs-top-wide"),o=i.get("baseY")||0;!!n&&n.css("height",o+"px")}_.log("onresize");var l=(a.DOM.viewportWidth(),a.DOM.viewportHeight());c.height(l),b.height(l),M.height(l),D.height(l),w.height(l),a.each(w.all(".mui-mbar-plugin"),function(e){e=a.one(e),e.height(l);var t=e.one(".mui-mbar-plugin-hd");e.one(".mui-mbar-plugin-bd").height(l-t.height())});var r=0;a.each(s.l,function(a,e){if(!a.custom&&!a.bottom&&a.on&&!a.defaultHide){var t=I[a.id].get(d.K.TAB);r+=t.height()+(2*a.margin||0)}});var u=0;a.one(".mui-mbar-tabs-narrow")&&(u=i.get("topAddHeight")||50);var p=(l-r)/2+u,E=p,T=0;for(m=0,n=s.l.length;m<n;++m){o=s.l[m];var f=I[o.id],B=f.get(d.K.TAB),A=o.margin||0;if(o.custom){if(E-=A,E-=B.height(),B.css("position","absolute"),B.css("top",E+"px"),"nav"==o.id&&E>0){var g=a.one(".mui-mbar-tabs-narrow")||"";if(g){var O=g.one(".mui-mbar-tab-logo-nav-top");i.set("offsetYCustom",E),O&&(O.css("height",E+"px"),O.css("top",-E+"px"))}}}else o.bottom?(T+=A,B.removeAttr("style"),B.css("bottom",T+"px"),B.css("position","absolute"),T+=B.height()):"prof"==o.id?(p<35&&(p=35),B.css("margin",p+"px 0 0px")):B.css("margin",A+"px 0");f.resetBubble()}i.set("baseY",p),i.isMiniWidth()||W.forceMallBarMini?(a.one(".mui-mbar").one(".mui-mbar-tabs")&&e(),i.fire(d.E.STATUS_CHANGE,{"status":d.S.MINI}),k&&(_.sendLog(d.ARR.S1_DEFAULT),k=!1)):(a.DOM.viewportWidth()<1380?e():a.UA.ie<8?e():t(),i.fire(d.E.STATUS_CHANGE,{"status":d.S.STANDARD})),i.isMiniWidth()&&(!V&&Math.random()<d.SAM_PV&&_.sendLog(d.ARR.EXP1),V=!0)}var i=this;if(!i.get(d.K.INITED)){i.set(d.K.INITED,!0);var m,n,o,s=i.get(d.K.MODEL).get(d.K.BAR),b=i.get(d.K.ROOT),c=i.get(d.K.ROOT_OUTER),p=i.get(d.K.MODEL),A=p.get(d.K.USERINFO),I=i.get(d.K.ITEMS);_.log("::after bucket::",s.l);var O=[];for(O.push('<div class="mui-mbar-plugins">'),m=0,n=s.l.length;m<n;++m){o=s.l[m];var C=0===o.u.indexOf("//");O.push(_.fm(E,o.id,o.n,o.u,C?"_blank":"_self",C?"":"mui-mbar-plugin-hd-title-txt",o.tms?"mui-mbar-plugin-tms":""))}O.push("</div>");var h="mui-mbar-tabs-narrow";for(O.push('<div class="mui-mbar-tabs  '+h+'">'),m=0,n=s.l.length;m<n;++m)o=s.l[m],O.push(_.fm(f,o.id));for(O.push('<div class="mui-mbar-tabs-mask">'),O.push('<div class="mui-mbar-tabs-top-wide"><div class="mui-mbar-tab-top-left"></div></div>'),m=0,n=s.l.length;m<n;++m){o=s.l[m];var v="",R="";"nav"==o.id&&(R='<div class="mui-mbar-tab-logo-nav-top" '+(i.navTopColor?'style="background-color:'+i.navTopColor+'"':"")+"></div>");var L="";o.specail&&(L="mui-mbar-tab-logo-arr-show"),O.push(_.fm(T,o.n,0,o.id,o.nick,o.custom?"mui-mbar-tab-custom":"",o.isNew?"block":"none",o.text?o.text:"",v,L,R))}O.push("</div>"),O.push("</div>"),O.push(B),b.html(O.join(""));var S,N,U=a.one(window),P=(b.one(".mui-mbar-mini"),b.one(".mui-mbar-mini-logo")),M=b.one(".mui-mbar-tabs"),D=b.one(".mui-mbar-tabs-mask"),w=b.one(".mui-mbar-plugins"),F=M.all(".mui-mbar-tab");for(m=0,n=F.length;m<n;++m){var G=a.one(F[m]),y=s.l[m];I[y.id]=new u({"mallbar":i,"index":m,"data":y,"tab":G,"bubble":b.one(".mui-mbar-tab-bubble-"+y.id),"plugin":w.one(".mui-mbar-plugin-"+y.id)}),d.P.CART===y.id&&(S=I[y.id].get(d.K.TAB)),d.P.TOP===y.id&&(N=I[y.id].get(d.K.TAB)),r.ie&&6===r.ie&&y.ie6Tab&&G.one(".mui-mbar-tab-logo").css({"backgroundImage":_.fm("url({0})",y.ie6Tab)})}i.on(d.E.STATUS_CHANGE,function(t){_.log("::status change::",t.status);var r=t.status;if(i.get(d.K.STATUS)!==r){var m=i.get(d.K.STATUS);switch(i.set(d.K.STATUS,r),r){case d.S.MINI:b.removeClass("mui-mbar-status-standard"),b.removeClass("mui-mbar-status-expand"),b.addClass("mui-mbar-status-mini"),l(b,{"right":-b.width()+"px"},.2,d.EASE).run(),S&&l(S,{"left":"-35px"},.2,d.EASE).run(),l(N,{"left":"-35px"},.2,d.EASE).run(),i.fire(d.E.SUPTIP_CHANGE),e(),P.css("visibility","hidden"),d.S.STANDARD===m&&_.sendLog(d.ARR.S21);break;case d.S.STANDARD:b.addClass("mui-mbar-status-standard"),b.removeClass("mui-mbar-status-expand"),b.removeClass("mui-mbar-status-mini"),l(b,{"right":-b.width()+M.width()+"px"},.2,d.EASE).run(),S&&l(S,{"left":"0px"},.2,d.EASE).run(),l(N,{"left":"0px"},.2,d.EASE).run(),P.css("visibility","hidden"),e(),d.S.MINI===m&&_.sendLog(d.ARR.S12),d.S.EXPAND===m&&_.sendLog(d.ARR.S32);break;case d.S.EXPAND:b.removeClass("mui-mbar-status-standard"),b.removeClass("mui-mbar-status-mini"),b.addClass("mui-mbar-status-expand"),l(b,{"right":"0px"},.31,d.EASE).run(),S&&l(S,{"left":"0px"},.31,d.EASE).run(),l(N,{"left":"0px"},.31,d.EASE).run(),P.css("visibility","visible"),g=!0}if(i.broadcast(d.E.MALLBAR_STATUS_CHANGE,{"status":r}),!t.noToClose){var n=i.get(d.K.ITEMS);n&&a.each(n,function(a){var e=a.get(d.K.BUBBLE);!!e&&e.hide()})}}}),i.on(d.E.SUPTIP_CHANGE,function(a){});var H=function(a){var e,t=i.get(d.K.STATUS);switch(t){case d.S.MINI:e=d.S.STANDARD,_.sendLog(d.ARR.S12_ACTIVE);break;case d.S.STANDARD:e=d.S.MINI,_.sendLog(d.ARR.S21_ACTIVE);break;case d.S.EXPAND:i.isMiniWidth()?(e=d.S.MINI,_.sendLog(d.ARR.S31_ACTIVE)):(e=d.S.STANDARD,_.sendLog(d.ARR.S32_ACTIVE))}i.fire(d.E.STATUS_CHANGE,{"status":e})};P.on("click",H),i.on(d.E.PAGE_VISIBILITY_CHANGE,function(e){if(e.pageVisible&&A.isLogin&&d.S.BAR_NO_MSG!==s.s&&!(d.SAMPLING<Math.random())){var t=[];a.each(I,function(a,e){t.push(e)}),_.getStaticConf({"cb":function(e){e.notGetMessageWarn||_.ajax({"url":_.fm(d.URL.GET_MSG),"jsonpCallback":"__mallbarGetMessageWarn","data":{"id":t.join(",")},"success":function(e){if(e){var t=e.s;t!==d.S.BAR_SUCCESS&&t!==d.S.BAR_NOT_LOGIN&&t!==d.S.BAR_NO_MSG||a.each(e.q,function(a){var e=I[a.id];e&&e.fire(d.E.SUPTIP_CHANGE,{"show":a.m>0})})}}})}})}}),r.ie&&r.ie<7&&(U.on("scroll",function(){c.css("top",U.scrollTop()+"px")}),c.css("top",U.scrollTop()+"px")),b.on("click",function(a){a.stopPropagation()});var K=a.one(document);K.on("click",function(a){_.log("document click"),d.S.EXPAND===i.get(d.K.STATUS)&&i.fire(d.E.STATUS_CHANGE,{"status":i.isMiniWidth()?d.S.MINI:d.S.STANDARD})});var x=0,W=i.get(d.K.G_CONFIG);K.on("mousemove",a.buffer(function(e){if(i.isMiniWidth()||W.forceMallBarMini){var t=a.DOM.viewportWidth()-e.pageX+K.scrollLeft(),l=i.get(d.K.STATUS),r=t<=d.MINI_HIT_WIDTH;r&&d.S.MINI===l&&(_.sendLog(d.ARR.S12_USER_TRIGGER),i.fire(d.E.STATUS_CHANGE,{"status":d.S.STANDARD})),x=r}},300)),b.on("mouseleave",a.buffer(function(){if(i.isMiniWidth()||W.forceMallBarMini){var a=i.get(d.K.STATUS);d.S.STANDARD===a&&i.fire(d.E.STATUS_CHANGE,{"status":d.S.MINI})}})),U.on("focus",a.buffer(function(a){i.broadcast(d.E.PAGE_VISIBILITY_CHANGE,{"pageVisible":!0})},d.COMMON_DELAY,i)),U.on("blur",a.buffer(function(a){i.broadcast(d.E.PAGE_VISIBILITY_CHANGE,{"pageVisible":!1})},d.COMMON_DELAY,i));var V=!1,k=!0;t(),"hidden"===b.css("visibility")&&b.css("visibility","visible");var Y={"w":a.DOM.viewportWidth(),"h":a.DOM.viewportHeight()};U.on("resize",a.buffer(function(e){_.log(e.type,Y);var l={"w":a.DOM.viewportWidth(),"h":a.DOM.viewportHeight()},r=!0;Y.h===l.h&&Y.w!==l.w&&d.S.EXPAND===i.get(d.K.STATUS)&&(r=!1),Y=l,r&&t()},d.COMMON_DELAY,i));var X=a.one("body");X.delegate("click",".mui-favor-add",function(e){var t=a.one(e.currentTarget).attr("data-itemId");i._addFavor(t,e),e.halt()}),X.delegate("click",".mui-favor-delete",function(e){var t=a.one(e.currentTarget).attr("data-itemId");i._deleteFavor(t),e.halt()}),Math.random()<d.SAM_PV&&_.sendLog(d.ARR.PV),i.get(d.K.LOADED)&&setTimeout(function(){i.get(d.K.LOADED)(i)},10)}},"addFavor":function(a){_.log("::mallbar addFavor::start");var e=a.favorAd||"",t=a.itemId||"",i={},l=a.callback||"",r=a.e||"";if(t){i={"sellerId":a.sellerId||"","categoryId":a.categoryId||""};var m=this;m.get(d.K.MODEL).get(d.K.USERINFO).isLogin&&new s({"url":d.URL.FAVORITE_ITEM,"scriptCharset":"gbk","dataType":"jsonp","type":"GET","data":{"itemId":t,"favorite":"1","_tb_token_":m.get("token")||""},"success":function(a){1==a.s&&m.driving({"type":"favor","e":r,"bubble":!0,"callback":l,"id":t,"params":i,"favorAd":e,"speed":2})},"error":function(){}})}},"_addFavor":function(a,e,t){var i=this;TB.Global.loginStatusReady(function(l){new s({"url":d.URL.FAVORITE_ITEM,"scriptCharset":"gbk","dataType":"jsonp","type":"GET","data":{"itemId":a,"favorite":"1","_tb_token_":l.tbToken},"success":function(a){1==a.s&&i.driving({"type":"favor","e":e,"speed":2,"bubble":!0,"callback":t})},"error":function(){}})})},"_deleteFavor":function(a,e){TB.Global.loginStatusReady(function(t){new s({"url":d.URL.FAVORITE_ITEM,"dataType":"jsonp","scriptCharset":"gbk","type":"GET","data":{"itemId":a,"favorite":"0","_tb_token_":t.tbToken},"success":function(a){1==a.s&&e()},"error":function(){}})})},"getCueMsgInfo":function(e){var t=this;if(this.cueMsgCallbacks=this.cueMsgCallbacks||[],this.cueMsgCallbacks.push(e),this.sendCueMsg)t.cueMsgData&&a.each(t.cueMsgCallbacks,function(a){a(t.cueMsgData)});else{t.sendCueMsg=!0;var i=t.get("sellerId"),l=t.get("itemId"),r=t.get("brandId"),m=t.get("category"),n=t.get("bizId");_.getStaticConf({"cb":function(e){e.notGetCueMsgInfo||_.ajax({"url":d.URL.GET_PLUGIN_ASSET_TIP,"data":{"sellerId":i,"itemId":l,"brandId":r,"frontEndCatId":m,"bizId":n},"timeout":4,"scriptCharset":"gbk","jsonpCallback":"__mallbarCueAssetMsg","success":function(e){t.cueMsgData=e,a.each(t.cueMsgCallbacks,function(t){a.isFunction(t)&&t(e)});var i=[],l="";!!e.vip&&(i=e.vip.va||[]),e.vip&&e.vip.vp&&(l=e.vip.vp.b||""),t.set("profList",i),t.set("currentProf",l),t.cueMsgCallbacks=[]},"error":function(){}})}})}},"isMiniWidth":function(){return a.DOM.viewportWidth()<1260},"broadcast":function(e,t){var i=this;i.fire(e,t);var l=i.get(d.K.ITEMS);a.each(l,function(a){a.fire(e,t)})},"toggle":function(a){var e=a.obj;l(e,{"right":a.expand?0:-e.outerWidth()+"px"},a.duration||.3,a.easing||d.EASE,function(){a.cb&&a.cb()}).run()},"isValid":function(e){var t=!1;return e=e.toUpperCase(),a.each(d.P,function(a,i){if(e===i)return t=!0,!1}),t},"collapse":function(a){var e=this;_.log("mallbar collapse",a),a=a||{};var t=d.S.MINI===a.status?d.S.MINI:d.S.STANDARD;e.fire(d.E.STATUS_CHANGE,{"status":t})},"expand":function(a){var e=this;_.log("mallbar expand",a),a=a||{};var t=a.type.toUpperCase();if(e.isValid(t)){var i=e.get(d.K.ITEMS)[d.P[t]];return i&&i.expand()}},"getPoint":function(a){var e=this;_.log("mallbar getPoint",a),a=a||{};var t=a.type.toUpperCase();if(!e.isValid(t))return null;"BRAND"==t&&(e.get(d.K.ITEMS)[d.P[t]]?t="BRAND":e.get(d.K.ITEMS).my1111&&(d.P.BRAND="my1111"));var i=e.get(d.K.ITEMS)[d.P[t]];return i?i.getPoint():null},"_bubbleTips":function(e){function t(e){var t=new b(['<div class="mui-mbar-bubble mui-mbar-bubble-recommend mui-mbar-bubble-recommend-cart" >','<div class="mui-mbar-arr mui-mbar-bubble-recommend-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-prof-login-close"></div>','<div class="mui-mbar-bubble-recommend-bd">','<div class="mui-mbar-bubble-recommend-content-head"><span class="mui-mbar-iconfont mui-mbar-bubble-recom-hd-logo">&#xe60c;</span>','<div class="mui-mbar-bubble-recom-hd-p">','<p class="mui-mbar-bubble-recom-hd-p-1"><b>\u6210\u529f\u52a0\u5165\u8d2d\u7269\u8f66\uff01</b>{{#if showNum}}\u5df2\u6709<span>{{cartNum}}</span>\u4eba\u52a0\u5165\u8d2d\u7269\u8f66\uff0c\u8fd8\u4e0d\u5feb\u62a2\uff01{{/if}}</p>','<p class="mui-mbar-bubble-recom-hd-p-2">\u60a8\u53ef\u4ee5<a href="//cart.tmall.com?scm=1048.1.12.2" target="_blank">\u53bb\u8d2d\u7269\u8f66\u7ed3\u7b97</a>{{#if goRoom}}{{/if}}\uff0c\u6216\u5148\u4f7f\u7528<a class="mui-mbar-bubble-recom-red" href="//www.tmall.com/wow/portal/act/app-download?scm=1048.1.12.11" target="_blank" >\u5929\u732bAPP</a>{{downloadWords}}<a href="//www.tmall.com/wow/portal/act/app-download?scm=1048.1.12.8" target="_blank" class="mui-mbar-bubble-recom-download">\u7acb\u5373\u4e0b\u8f7d\u5929\u732bAPP</a></p>',"</div>","</div>",'<div class="mui-mbar-bubble-recommend-content-blow">','<p class="mui-mbar-bubble-recom-bd-p">\u8fbe\u4eba\u7684\u8d2d\u7269\u8f66\u91cc\u90fd\u6709\u5565 </p>','<div class="mui-mbar-recom-list-slide mui-mbar-recom-list-slide-cart">','<div class="mui-mbar-recom-list-slide-cont mui-mbar-recom-list-slide-cont-cart">',"{{#each data}}",'<div class="mui-mbar-bubble-recom-list-item mui-mbar-bubble-recom-list-item-cart">','<a target="_blank" href="{{itemUrl}}">                        <img src="{{pictUrl}}_120x120" width="120" height="120"/>                        <p class="mui-mbar-bubble-recom-list-item-price" title="&yen;{{promotionPrice}}">&yen;{{promotionPrice}}</p>                         <span class="mui-mbarp-11-flag bottom {{isTm11}}"></span>                    </a>',"</div>","{{/each}}",'</div><span class="mui-mbar-iconfont mui-mbar-recom-list-slide-prev mui-mbar-recom-list-slide-prev-cart">&#xe60d;</span><span class="mui-mbar-iconfont mui-mbar-recom-list-slide-next mui-mbar-recom-list-slide-next-cart">&#xe60e;</span></div>',"</div>","</div>","</div>"].join("")),l=new b(['<div class="mui-mbar-bubble mui-mbar-bubble-recommend mui-mbar-bubble-recommend-favor{{#if favorAd}} mui-mbar-bubble-recommend-favor-ad {{/if}}" >','<div class="mui-mbar-arr mui-mbar-bubble-recommend-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-prof-login-close"></div>','<div class="mui-mbar-bubble-recommend-bd">','<div class="mui-mbar-bubble-recommend-content-head"><span class="mui-mbar-iconfont mui-mbar-bubble-recom-hd-logo">&#xe60c;</span>','<div class="mui-mbar-bubble-recom-hd-p">','<p class="mui-mbar-bubble-recom-hd-p-1"><b>\u6210\u529f\u52a0\u5165\u6536\u85cf\u5939\uff01</b></p>','<p class="mui-mbar-bubble-recom-hd-p-2">\u60a8\u53ef\u4ee5<a href="//favorite.taobao.com/item_collect.htm?scm=1048.1.12.1" target="_blank">\u67e5\u770b\u6536\u85cf\u5939</a>{{#if goRoom}}{{/if}}\uff0c\u6216\u5148\u4f7f\u7528<a class="mui-mbar-bubble-recom-red" href="//www.tmall.com/wow/portal/act/app-download?scm=1048.1.12.10" target="_blank" >\u5929\u732bAPP</a>{{downloadWords}}<a href="//www.tmall.com/wow/portal/act/app-download?scm=1048.1.12.9" target="_blank" class="mui-mbar-bubble-recom-download">\u7acb\u5373\u4e0b\u8f7d\u5929\u732bAPP</a></p>',"</div>","","</div>",'<div class="mui-mbar-bubble-recommend-content-blow">','<p class="mui-mbar-bubble-recom-bd-p">\u770b\u770b\u5927\u5bb6\u90fd\u6536\u85cf\u4e86\u5565 </p>','<div class="mui-mbar-recom-list-slide mui-mbar-recom-list-slide-favor">','<div class="mui-mbar-recom-list-slide-cont mui-mbar-recom-list-slide-cont-favor">',"{{#each data}}",'<div class="mui-mbar-bubble-recom-list-item mui-mbar-bubble-recom-list-item-favor">','<a target="_blank" href="{{itemUrl}}">                        <img src="{{pictUrl}}_120x120" width="120" height="120" alt="{{itemTitle}}"/>                        <p title="&yen;{{promotionPrice}}">&yen;{{promotionPrice}}</p>                        <span class="mui-mbarp-11-flag bottom {{isTm11}}"></span>                    </a>',"</div>","{{/each}}",'</div><span class="mui-mbar-iconfont mui-mbar-recom-list-slide-prev mui-mbar-recom-list-slide-prev-favor">&#xe60d;</span><span class="mui-mbar-iconfont mui-mbar-recom-list-slide-next mui-mbar-recom-list-slide-next-favor">&#xe60e;</span></div>','{{#if favorAd}} <div class=" mui-mbar-bubble-recommend-favor-ad-cont" > {{/if}}',"{favorAdHtml}","{{#if favorAd}} </div> {{/if}}","</div>","</div>","</div>"].join("")),r=e.id||"",m=e.item,n=e.type,o="",s="",c={};if(_.log("obj",e),"CART"==n||"FAVOR"==n){var u=window.g_config||{},p=u.isInternational||"";if("CART"==n){if(o=d.URL.GET_MBAR_ADD_CART_RECOMMEND,s="_mallbarCartBubbleRecommend",!e.params)return;var E=e.params;c={"itemId":E.itemId||"","sellerId":E.sellerId||"","categoryId":E.categoryId||""},!!p&&(c.tag="13186")}if("FAVOR"==n){o=d.URL.GET_MBAR_ADD_FAVOR_RECOMMEND,s="_mallbarFavorBubbleRecommend";var E=e.params||{};c={"itemId":r,"sellerId":E.sellerId||"","categoryId":E.categoryId||""},!!p&&(c.tag="13186")}_.ajax({"url":o,"jsonpCallback":s,"dataType":"jsonp","data":c,"timeout":5,"success":function(r){if(r){var o="";_.getStaticConf({"cb":function(s){var b=i.get(d.K.MODEL).get(d.K.TIMESTAMP);if(s.bubbleShowGo11){var c=s.bubbleShowGo11,u=c.s?c.s:"",p=c.e?c.e:"";b>u&&b<p&&(r.goRoom=!0)}if(s.bubbleShowCharge){var c=s.bubbleShowCharge,u=c.s?c.s:"",p=c.e?c.e:"";b>u&&b<p&&(r.goAsset=!0)}if(r.showNum=!0,s.notCartBubbleNum&&(r.showNum=!1),r.downloadWords="\u9886\u53d6\u6700\u9ad810\u5143\u65e0\u95e8\u69db\u5238",!!s.downloadWords&&(r.downloadWords=s.downloadWords),"CART"==n){if(!r.data||!r.data.length)return;(!r.cartNum||r.cartNum<1)&&(r.showNum=!1),a.each(r.data,function(a,e){a.tag201511&&i.tag201511Time?r.data[e].isTm11="":r.data[e].isTm11="hidden"}),o=t.render(r),r.tab="cart"}if("FAVOR"==n){if(!r.data||!r.data.length)return;e.favorAd&&(r.favorAd=!0),a.each(r.data,function(a,e){a.tag201511&&i.tag201511Time?r.data[e].isTm11="":r.data[e].isTm11="hidden"}),o=l.render(r).replace("{favorAdHtml}",e.favorAd),r.tab="favor"}m.fire(d.E.BUBBLE_CHANGE,{"show":!0,"html":o,"customConentType":3,"isCustomContent":!0,"isNotTabFire":!0,"bubbleType":0,"isToForever":!0,"showed":function(){!!r.exposureParam&&_.sendLog(r.exposureParam),!!r.acurl&&_.sendLog(r.acurl),_.sendLog(d.ARR["MBAR_RECOMMEND_BUBBLE_"+n]),a.config({"modules":{"mui/slider/base":{"requires":["node","json","event","anim","ua","mui/slider/slide-util","mui/slider/kissy2yui"]},"mui/slider/index":{"requires":["mui/slider/base"]},"mui/slider/kissy2yui":{"requires":["node","event"]},"mui/slider/slide-util":{"requires":["node","json","event"]}},"packages":{"mui/slider":{"debug":!0,"ignorePackageNameInUri":!0,"version":"3.0.1","path":"//g.alicdn.com/mui/slider/3.0.1/"}}}),a.use("mui/slider/",function(a,e){var t=new e(a.one(".mui-mbar-recom-list-slide-"+r.tab),{"effect":"hSlide","autoSlide":!1,"contentClass":"mui-mbar-recom-list-slide-cont-"+r.tab,"pannelClass":"mui-mbar-bubble-recom-list-item-"+r.tab,"carousel":!0,"colspan":4,"speed":500});a.one(".mui-mbar-recom-list-slide-prev-"+r.tab).on("click",function(){t.previous()}),a.one(".mui-mbar-recom-list-slide-next-"+r.tab).on("click",function(){t.next()})})},"colsedClicked":function(){var e=a.one(".mui-mbar-bubble mui-mbar-bubble-recommend");!!e&&a.DOM.remove(e)}})}})}},"error":function(){}})}}var i=this;_.log("mallbar favor or cart bubble",e),e=e||{};var l=e.type.toUpperCase();if(i.isValid(l)&&("FAVOR"==l||"CART"==l)){var r=i.get(d.K.ITEMS)[d.P[l]];e.bubble===undefined||e.bubble;r&&(e.item=r,_.getStaticConf({"cb":function(a){(!a.notFavorDefaultBubble&&"FAVOR"==l||!a.notCartDefaultBubble&&"CART"==l||p)&&t(e)}}))}},"onFinish":function(e){function t(a){var t=d.ARR.BRAND_FLY_BUB_SHOW,l=d.ARR.BRAND_FLY_BUB_CLICK,r="",m=i.get(d.K.ITEMS)[d.P.BRAND];r=e.id?_.fm(['<div class="mui-mbar-bubble mui-mbarp-brand-success-bubble">','<div class="mui-mbar-arr mui-mbarp-brand-success-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-brand-success-close"><a class="j_BubbleLink " target="_blank" href="//mybrand.tmall.com/brandInfo.htm?brandId={0}&scm={1}"></a></div>'].join(""),a,d.SCM.BRAND_FLY_BUB_LINK):['<div class="mui-mbar-bubble mui-mbarp-brand-success-bubble">','<div class="mui-mbar-arr mui-mbarp-brand-success-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-brand-success-close"></div>'].join(""),m.fire(d.E.BUBBLE_CHANGE,{"show":!0,"html":r,"customContentType":3,"bubbleType":1,"showDelay":10,"showed":function(){_.sendLog(t)},"clicked":function(){_.sendLog(l)}})}var i=this;_.log("mallbar onFinish",e),e=e||{};var l=e.type.toUpperCase();if(i.isValid(l)&&"FAVOR"!=l&&"CART"!=l){var r=i.get(d.K.ITEMS)[d.P[l]],m=e.bubble===undefined||e.bubble;if(r)if(r.fire(d.E.FLYIN_END),m)r.fire(d.E.BUBBLE_CHANGE,{"show":!1,"cb":function(){var i="",m="",n="",o={},s=!0;switch(l){case"BRAND":t(e.id),s=!1;break;case"ASSET":m=d.ARR.COUPON_FLY_BUB_SHOW,n=d.ARR.COUPON_FLY_BUB_CLICK,i='<span class="mui-mbar-bubble-em">\u4f18\u60e0\u5238\u9886\u53d6\u6210\u529f</span><br><p class="mui-mbar-bubble-href"><a>\u7acb\u5373\u67e5\u770b</a></p>';break;case"BONUS":m=d.ARR.BONUS_FLY_BUB_SHOW,n=d.ARR.BONUS_FLY_BUB_CLICK,i='<span class="mui-mbar-bubble-em">\u7ea2\u5305\u9886\u53d6\u6210\u529f\uff01</span><br>\u7ea2\u5305\u4f1a\u572824\u5c0f\u65f6\u5230\u8d26\uff0c\u67e5\u770b\u6211\u5df2\u9886\u7528\u7684\u7ea2\u5305\uff01';break;case"GUESS_POINT":case"SIGN_POINT":m=d.ARR.POINT_SHOW,n=d.ARR.POINT_BUB_CLICK,i='<span class="mui-mbar-bubble-em">\u5929\u732b\u79ef\u5206\u9886\u53d6\u6210\u529f\uff01</span><br><p class="mui-mbar-bubble-href"><a class="j_BubbleLink " target="_blank" href="//vip.tmall.com/vip/index.htm?scm=1048.1.3.27">\u53bb\u770b\u770b\u79ef\u5206</a></p>';break;case"GET_COUPON":m=d.ARR.GET_COUPON_BUB_SHOW,n=d.ARR.GET_COUPON_BUB_CLICK,i='<span class="mui-mbar-bubble-em">\u4f18\u60e0\u5238\u9886\u53d6\u6210\u529f</span><br><p class="mui-mbar-bubble-href"><a class="j_BubbleLink " target="_blank" href="//mybrand.tmall.com/myCoupon.html?scm=1048.1.3.28">\u53bb\u770b\u770b\u4f18\u60e0\u5238</a></p>';break;case"FOOT":m=d.ARR.FOOT_FLY_BUB_SHOW,n=d.ARR.FOOT_FLY_BUB_CLICK,i='<span class="mui-mbar-bubble-em">\u60a8\u9489\u4f4f\u7684\u5546\u54c1\u5728\u8fd9\u91cc\u54e6\uff01</span><br><p class="mui-mbar-bubble-href"><a>\u53bb\u770b\u770b</a></p>',o.height="110px";break;case"FAVOR":s=!1;break;case"DELETE_FAVOR":m=d.ARR.DELETE_FAVOR_FLY_BUB_SHOW,n=d.ARR.DELETE_FAVOR_FLY_BUB_CLICK,i='<span class="mui-mbar-bubble-em">\u53d6\u6d88\u6536\u85cf\u6210\u529f\uff01</span><br><p class="mui-mbar-bubble-href"><a>\u53bb\u770b\u770b</a></p>';break;case"CART":s=!1}s&&r.fire(d.E.BUBBLE_CHANGE,a.mix(o,{"show":!0,"html":i,"customConentType":1,"isNotTabFire":!1,"showDelay":10,"hideDelay":e.hideDelay===undefined?"":e.hideDelay,"showed":function(a){m&&_.sendLog(m);var e=a.one(".j_BubbleLink");e&&(e.on("click",function(a){switch(l){case"BRAND":_.sendLog(d.ARR.BRAND_FLY_BUB_LINK_CLICK);break;case"GET_COUPON":_.sendLog(d.ARR.GET_COUPON_BUB_LINK_CLICK);break;case"SIGN_POINT":case"GUESS_POINT":_.sendLog(d.ARR.POINT_BUB_LINK_CLICK)}a.stopPropagation()}),_.getStaticConf({"cb":function(a){a.brandBubUrl&&e.attr("href",a.brandBubUrl)}}))},"clicked":function(){n&&_.sendLog(n)}}))}});else{var n="",o="";switch(l){case"BRAND":n=d.ARR.BRAND_FLY_BUB_SHOW,o=d.ARR.BRAND_FLY_BUB_CLICK;break;case"ASSET":n=d.ARR.COUPON_FLY_BUB_SHOW,o=d.ARR.COUPON_FLY_BUB_CLICK;break;case"BONUS":n=d.ARR.BONUS_FLY_BUB_SHOW,o=d.ARR.BONUS_FLY_BUB_CLICK;break;case"GUESS_POINT":case"SIGN_POINT":n=d.ARR.POINT_SHOW,o=d.ARR.POINT_BUB_CLICK;break;case"GET_COUPON":n=d.ARR.GET_COUPON_BUB_SHOW,o=d.ARR.GET_COUPON_BUB_CLICK;break;case"FOOT":n=d.ARR.FOOT_FLY_BUB_SHOW,o=d.ARR.FOOT_FLY_BUB_CLICK}n&&_.sendLog(n),o&&_.sendLog(o)}}},"fly":function(e){var t=this,i=e.type.toUpperCase();if(t.isValid(i)){var r=t.getPoint({"type":i});if(r){var m,o=e.flyer,s=e.start,b=e.target,_=e.unAnim,c=e.speed?e.speed:1.16,u=e.bubble===undefined||e.bubble,p=e.hideDelay?e.hideDelay:"",E={"left":r.x,"top":r.y}||n.offset(b),T=6!=a.UA.ie,f=e.targetOffset||{"left":0,"top":0},B=e.flyerOffset||{"left":0,"top":0},A=e.flyerResize||{"x":16,"y":16},I=-1;t._bubbleTips({"type":i,"id":e.id,"params":e.params,"favorAd":e.favorAd,"bubble":u,"hideDelay":p});var g=function(){function r(){if(n.hide(o),"FAVOR"==i)return void(e.complete&&e.complete());n.css(s,T),n.show(s),l(s,{"opacity":1},.1,"easeOut",function(){l(s,c,1,"easeOut",function(){n.hide(s),t.onFinish({"type":i,"id":e.id,"params":e.params,"favorAd":e.favorAd,"bubble":u,"hideDelay":p}),e.complete&&e.complete()}).run()}).run()}var m=6==a.UA.ie,s=t._popEl,b=a.UA.webkit,_=b?2:0,c={"opacity":0,"top":E.top-8-35-_+(m?n.scrollTop():0)+"px"},T={"position":m?"absolute":"fixed","opacity":0,"left":E.left-8-_+(m?n.scrollLeft():0)+"px","top":E.top-8-_+(m?n.scrollTop():0)+"px"};if(!s){var f,B=t.get(d.K.ITEMS);B&&(f=B[e.type])&&(f=f.get(d.K.POBJ),f.fire(d.E.DATA_CHANGE)),s=t._popEl=n.create("<div>1</div>",{"css":a.mix({"display":"none","textAlign":"center","backgroundColor":"#b3000e","color":"#ffffff","zIndex":1000001},b?{"width":"20px","height":"20px","borderRadius":"10px","color":"#ffffff","lineHeight":"20px","fontSize":"12px","transform":"scale(0.8)","WebkitTransform":"scale(0.8)"}:{"width":"16px","height":"16px","borderRadius":"8px","lineHeight":"16px","fontSize":"10px"})}),n.append(s,document.body)}m?r():l(o,{"opacity":0},.8,"easeOut",r).run()};A&&(m={"x":n.width(o),"y":n.height(o)}),n.append(o,document.body),n.css(o,{"position":T?"fixed":"absolute","zIndex":1e6}),T?(s={"left":s.left-n.scrollLeft(),"top":s.top-n.scrollTop()},b&&(E={"left":parseFloat(n.css(b,"left")),"top":parseFloat(n.css(b,"top"))})):b?E=n.offset(b):(E.left+=n.scrollLeft(),E.top+=n.scrollTop()),E.top+=f.top-4;var O=T?0:n.scrollTop(),C=Math.min(s.top,E.top)-Math.abs(s.left-E.left)*(1/3);C<O&&(s.left==E.left&&(C=E.top),C=Math.min(O,Math.min(s.top,E.top))),c=6==a.UA.ie?c:c/2;var h=Math.sqrt(Math.pow(s.top-E.top,2)+Math.pow(s.left-E.left,2)),v=Math.ceil(Math.min(Math.max(Math.log(h)/.05-75,30),100)/c),R=s.top==C?0:-Math.sqrt((E.top-C)/(s.top-C)),L=(R*s.left-E.left)/(R-1),S=E.left==L?0:(E.top-C)/Math.pow(E.left-L,2);if(o.fadeIn(),A&&(m={"x":n.width(o),"y":n.height(o)}),_)g();else var N=setInterval(function(){++I;var a=s.left+(E.left-s.left)*I/v,e=0==S?s.top+(E.top-s.top)*I/v:S*Math.pow(a-L,2)+C,t={"left":a,"top":e};if(A){var i=v/2,l=A.x-(A.x-m.x)*Math.cos(I<i?0:(I-i)/(v-i)*Math.PI/2),r=A.y-(A.y-m.y)*Math.cos(I<i?0:(I-i)/(v-i)*Math.PI/2);n.css(o,{"width":l+"px","height":r+"px","font-size":Math.min(l,r)+"px"}),B.left=-l/2,B.top=-r/2}n.css(o,{"left":t.left+B.left+"px","top":t.top+B.top+"px"}),0==I&&n.show(o),I==v&&(clearInterval(N),g())},16)}}},"driving":function(e){function t(e,t){var i="";return a.each(t,function(a){if(a.id==e)return i=a.name,!0}),i}_.log("driving\u65b9\u6cd5\u4f20\u5165\u53c2\u6570\uff1a",e);var i=this,l=[{"id":"asset","name":"&#xe606;"},{"id":"get_coupon","name":"&#xe606;"},{"id":"brand","name":"&#xe600;"},{"id":"guess_point","name":"&#xf000a;"},{"id":"sign_point","name":"&#xf000a;"},{"id":"foot","name":"&#xe607;"},{"id":"favor","name":"&#xe607;"}];if(e){var r,m,n;if(r=e.e,m=e.type||a.one(r.target).attr("data-type"),!r||!m)return;"brand"==m&&(i.get(d.K.ITEMS)[m]?m="brand":d.P.BRAND="my1111");var o=r.target,s=a.DOM;n=e.callback||"";var b;if(e.flyer){var c=e.width?e.width:50,u=e.height?e.height:50,p=a.UA.ie<9,E="";E=p?'<img width="{2}" height="{3}" src="{4}"/>':'<div class="mui-mbar-pan" style="border-radius: 50%; -webkit-border-radius: 50%; width: {2}px; height: {3}px; background:{4}; background-size: 100%;"></div>',b=a.one(E.replace("{2}",c).replace("{3}",u).replace("{4}",p?e.flyer:"url("+e.flyer+")")).appendTo(document.getElementsByTagName("body")[0])}else b=a.one('<div class="mui-mbar-pan mui-mbar-{0}-pan">{3}</div>'.replace("{0}",t(m,l)?m:"default").replace("{3}",t(m,l)?t(m,l):"")).appendTo(document.getElementsByTagName("body")[0]);if("cart"!=m&&(r.pageX=s.offset(o).left+(s.width(o)-b.width())/2,r.pageY=s.offset(o).top-b.height()/2),b.css({"left":r.pageX-s.scrollLeft(),"top":r.pageY-s.scrollTop()}),"cart"!=m&&"favor"!=m||(e.bubble=e.bubble===undefined||e.bubble),"cart"==m){var T,f=i.get(d.K.ITEMS);f&&(T=f.cart)&&(T=T.get(d.K.POBJ),T.fire("addCartItem"))}var B,A;b&&b.width?(B=r.pageX+b.width()/2,A=r.pageY+b.height()/2):(B=r.pageX,A=r.pageY),this.fly({"id":e.id||e.itemId||"","type":m,"flyer":b,"start":{"left":B,"top":A},"target":e.target?e.target:null,"unAnim":e.unAnim||!1,"bubble":!1!==e.bubble||e.bubble,"speed":e.speed?e.speed:1.16,"hideDelay":e.hideDelay?e.hideDelay:"","params":e.params||"","favorAd":e.favorAd||"","complete":function(){"function"==typeof n&&n()}})}},"bubble":function(a){var e=this;a=a||{},a.show="undefined"==typeof a.show?a.show=!0:a.show,a.tab=a.tab||"PROF",a.title=a.title||"",a.content=a.content||"",a.isCustomContent=!!a.isCustomContent;var t=a.customContentType||2;"undefined"==typeof a.bubbleType&&(a.bubbleType=1),"undefined"==typeof a.isNotTabFire&&(a.isNotTabFire=!0);var i={"PROF":1,"CART":2,"ASSET":3,"BRAND":4,"PROMOTION":5},l=e.get(d.K.ITEMS)[d.P[a.tab]];if(l){if(a.show){if(_.log("isMallbarExpend",g),I){var r={"tab":a.tab,"id":a.flag||i[a.tab],"item":l,"opt":a};return void A.push(r)}if(!g&&!a.first)return}a.show&&"PROF"==a.tab&&l.get("pluginObj").fire(d.E.PROF_HIDE),l.fire(d.E.BUBBLE_CHANGE,{"show":a.show,"html":a.content,"height":a.height||"","showDelay":500,"contentTitle":a.title,"bubbleType":a.bubbleType,"customContentType":t,"isNotTabFire":a.isNotTabFire,"hideDelay":a.hideDelay||"","showDelay":a.showDelay,"dismiss":a.dismiss||"","showed":a.showed||"","clicked":a.clicked||"","arrClicked":a.arrClicked||"","arrShowed":a.arrShowed||"","colsedClicked":a.colsedClicked||""})}},"firstBubble":function(){var a=this;if(I=!1,_.log("arrBubble",A),A&&A.length){for(var e=0,t={},i=A.length,l=0;l<i;l++)for(e=l;e<i;e++)A[l].id>A[e].id&&(t=A[l],A[l]=A[e],A[e]=t);_.log("arrBubble sort",A);var r=A[0].opt;if(r.showTwo&&A[1]){var m=A[1].opt;m.first=!0;var n=r.dismiss||"";r.dismiss=function(){!!n&&n(),a.bubble(m)}}r&&(r.first=!0,a.bubble(r)),A=[]}},"openFavorRecommend":function(a){var e=this;if(a){e.set("favorRec",a);var t=e.get(d.K.ITEMS).favor,i=t.get(d.K.POBJ);t.get(d.K.EXPAND)?i.fire("visibilityChange",{"visible":!0}):e.expand({"type":"favor"})}}}),O},{"requires":["base","event","node","anim","ua","swf","dom","cookie","ajax","xtemplate","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/model","mui/mallbar/mallbar-item","mui/mallbar/mallbar.css","mui/mallbar/mallbar-tab.css","mui/mallbar/mallbar-guide","mui/mallbar/plugin-prof","mui/mallbar/plugin-asset","mui/mallbar/plugin-brand","mui/mallbar/plugin-live","mui/mallbar/plugin-foot","mui/mallbar/plugin-top","mui/mallbar/plugin-ue","mui/mallbar/plugin-qrcode","mui/mallbar/plugin-favor","mui/mallbar/plugin-charge","mui/mallbar/plugin-cart","mui/mallbar/plugin-nav","mui/mallbar/plugin-worth"]});KISSY.add("mui/mallbar/conf",function(a){var _=location.href,l=_.indexOf("mbar-debug=1")>-1,t=(_.indexOf("mbar-debug-tms=1"),_.indexOf("mbar-debug-log=1")>-1),m=window.TB,E=m&&m.globalToolFn&&a.isFunction(m.globalToolFn.isDaily)?m.globalToolFn.isDaily():location.hostname.indexOf(".net")>=0||location.hostname.indexOf(".com.hk")>=0,B="//gm.mmstat.com";return{"VER":"3.2.4","DEBUG":l,"DEBUG_LOG":t,"IS_DAILY":E,"SKIN":"mui-mbar-d11","TAB_W":50,"MINI_HIT_WIDTH":50,"TAB_W_C":100,"ZINDEX":999999,"SAMPLING":.005,"SAM_PV":.001,"EASE":"easeOut","BUBBLE_PAD":5,"COMMON_DELAY":100,"TIMEOUT_TOP":5e3,"TIMEOUT_STORAGE":3e3,"DEGRADE":-99,"BUBBLE_HIDE_DELAY":12e3,"AVATAR":E?"//wsapi.jianghu.daily.taobao.net/avatar/getAvatar.do?userId={0}&width={1}&height={1}&type=ww":"//wwc.alicdn.com/avatar/getAvatar.do?userId={0}&width={1}&height={1}&type=ww","CAT":"//img.alicdn.com/tps/i4/T1VaaiFdpdXXXtxVjX.swf","AR":B,"CK_USED":"_mr","NO_IMG":"//img.alicdn.com/tps/i1/T1aYCaFaVcXXX6DYsb-100-100.gif","STORAGE_PROXY":"//www.tmall.com/go/act/storage-proxy.php","DOMAIN":E?".tmall.net":".tmall.com","RECOMMEND_APPID":"03159","ARR":{"S1_DEFAULT":B+"/tmallbrand.999.102","S12":B+"/tmallbrand.99.1","S21":B+"/tmallbrand.99.2","S12_ACTIVE":B+"/tmallbrand.99.48","S21_ACTIVE":B+"/tmallbrand.99.49","S32_ACTIVE":B+"/tmallbrand.99.70","S31_ACTIVE":B+"/tmallbrand.99.71","S32":B+"/tmallbrand.99.9","S12_USER_TRIGGER":B+"/tmallbrand.99.113","S21_ICON_CLOSE":B+"/tmallbrand.99.114","QRCODE":B+"/tmallbrand.99.66","PROF":B+"/tmallbrand.99.3","PROF_LOGIN":B+"/tmallbrand.99.62","PROF_BUB_SHOW":B+"/tmallbrand.99.19","PROF_BUB_CLICK":B+"/tmallbrand.99.20","PROF_BUB_LINK_CLICK":B+"/tmallbrand.99.21","PROF_BUB_T0_SHOW":B+"/tmallbrand.99.89","PROF_BUB_T0_CLICK":B+"/tmallbrand.99.90","ASSETS_TAB_CLICK":B+"/tmallbrand.99.116","COUPON_AVAILABLE_SHOW":B+"/tmallbrand.99.7","COUPON_AVAILABLE_CLICK":B+"/tmallbrand.99.10","COUPON_MEMBER_BUBBLE_A_SHOW":B+"/tmallbrand.99.85","COUPON_MEMBER_BUBBLE_A_CLICK":B+"/tmallbrand.99.86","COUPON_MEMBER_BUBBLE_B_SHOW":B+"/tmallbrand.99.87","COUPON_MEMBER_BUBBLE_B_CLICK":B+"/tmallbrand.99.88","COUPON_7_SHOW":B+"/tmallbrand.99.13","COUPON_1_SHOW":B+"/tmallbrand.99.14","COUPON_7_CLICK":B+"/tmallbrand.99.15","COUPON_1_CLICK":B+"/tmallbrand.99.16","COUPON_COULD_SHOW":B+"/tmallbrand.99.59","COUPON_COULD_CLICK":B+"/tmallbrand.99.58","COUPON_FLY_BUB_SHOW":B+"/tmallbrand.99.26","COUPON_FLY_BUB_CLICK":B+"/tmallbrand.99.27","BONUS_FLY_BUB_SHOW":B+"/tmallbrand.99.28","BONUS_FLY_BUB_CLICK":B+"/tmallbrand.99.29","BONUS_AVAILABLE_BUB_SHOW":B+"/tmallbrand.99.30","BONUS_AVAILABLE_BUB_CLICK":B+"/tmallbrand.99.31","POINT_SHOW":B+"/tmallbrand.99.64","POINT_BUB_CLICK":B+"/tmallbrand.99.63","POINT_BUB_LINK_CLICK":B+"/tmallbrand.99.67","GET_COUPON_BUB_SHOW":B+"/tmallbrand.99.65","GET_COUPON_BUB_CLICK":B+"/tmallbrand.99.68","GET_COUPON_BUB_LINK_CLICK":B+"/tmallbrand.99.69","BRAND_FLY_BUB_SHOW":B+"/tmallbrand.99.23","BRAND_FLY_BUB_CLICK":B+"/tmallbrand.99.24","BRAND_FLY_BUB_LINK_CLICK":B+"/tmallbrand.99.25","LIVE_SHOW":B+"/tmallbrand.99.8","LIVE_CLICK":B+"/tmallbrand.99.11","LIVE_BUB_LINK_CLICK":B+"/tmallbrand.99.22","FOOT_BUBBLE":B+"/tmallbrand.99.17","FOOT_BUBBLE_CLICK":B+"/tmallbrand.99.18","FOOT_FLY_BUB_SHOW":B+"/tmallbrand.99.32","FOOT_FLY_BUB_CLICK":B+"/tmallbrand.99.33","FOOT_PIN_ITEM":B+"/tmallbrand.99.40","FOOT_DELETE_ITEM":B+"/tmallbrand.99.41","FOOT_CLEAR_HISTORY":B+"/tmallbrand.99.42","FOOT_UNPIN_ITEM":B+"/tmallbrand.99.43","CAL_REMIND":B+"/tmallbrand.99.53","CAL_BUB_SHOW":B+"/tmallbrand.99.54","CAL_BUB_CLICK":B+"/tmallbrand.99.55","CAL_BUB_LINK_CLICK":B+"/tmallbrand.99.57","CAL_DATE":B+"/tmallbrand.99.56","BACKTOP_CLICK":B+"/tmallbrand.99.115","PV":B+"/tmallbrand.999.1","LOGIN1":B+"/tmallbrand.999.2","LOGIN2":B+"/tmallbrand.999.3","RETINA":B+"/tmallbrand.999.4","FOOT_MORE_CLICK":B+"/tmallbrand.999.9","EXP1":B+"/tmallbrand.999.11","EXP2":B+"/tmallbrand.999.12","EXP3":B+"/tmallbrand.999.13","TIME1s":B+"/tmallbrand.999.14","TIME1m":B+"/tmallbrand.999.15","TIME1h":B+"/tmallbrand.999.16","TIME1d":B+"/tmallbrand.999.17","INCOGNITO":B+"/tmallbrand.999.18","CLEAR":B+"/tmallbrand.999.19","EXP7":B+"/tmallbrand.999.20","FAVOR_TO_MATCH":B+"/tmallbrand.99.77","FAVOR_TO_FX":B+"/tmallbrand.99.78","FAVOR_DELETE":B+"/tmallbrand.99.79","FAVOR_BACK":B+"/tmallbrand.99.80","FAVOR_CATE_CHECK":B+"/tmallbrand.99.81","FOOT_ADD_FAVOR":B+"/tmallbrand.99.82","PROMOTION_SHOW":B+"/tmallbrand.99.84","CART_TAB_CLICK":B+"/tmallbrand.99.101","CART_TAB_CLICK_DOWN":B+"/tmallbrand.99.102","PROMOTION_BUBBLE_SHOW":B+"/tmallbrand.99.91","PROMOTION_BUBBLE_CLICK":B+"/tmallbrand.99.92","LIVE_SHOP_CHAT_BUBBLE_SHOW":B+"/tmallbrand.99.121","LIVE_CHAT_BUBBLE_CLICK_TO_WW":B+"/tmallbrand.99.122","LIVE_CHAT_BUBBLE_CLICK_TO_LIVE":B+"/tmallbrand.99.123","QRCODE_BUBBLE_NO_LOGIN_QRCODE_SHOW":B+"/tmallbrand.99.124","QRCODE_BUBBLE_TUSER_QRCODE_SHOW":B+"/tmallbrand.99.125","QRCODE_BUBBLE_TUSER_QRCODE_CLICK":B+"/tmallbrand.99.126","ADD_FAVOR_FLY_BUB_SHOW":B+"/tmallbrand.99.127","ADD_FAVOR_FLY_BUB_CLICK":B+"/tmallbrand.99.128","DELETE_FAVOR_FLY_BUB_SHOW":B+"/tmallbrand.99.129","DELETE_FAVOR_FLY_BUB_CLICK":B+"/tmallbrand.99.130","MBAR_RECOMMEND_BUBBLE_CART":B+"/tmallbrand.99.131","MBAR_RECOMMEND_BUBBLE_FAVOR":B+"/tmallbrand.99.132","LIVE_EXPEND_TO_WW":B+"/tmallbrand.99.134","TMALLBAO_BUBBLE_SHOW":B+"/tmallbrand.99.135","TMALLBAO_BUBBLE_CLICK":B+"/tmallbrand.99.136","HB201611_BUBBLE_SHOW":B+"/tmallbrand.99.186","HB201611_BUBBLE_CLICK":B+"/tmallbrand.99.187","WORTH_BUBBLE_SHOW":B+"/tmallbrand.99.138","WORTH_BUBBLE_CLICK":B+"/tmallbrand.99.139","LIVE_BUBBLE_CLOSE_BOTTON_CLICK":B+"/tmallbrand.99.140","PROF_VIP_BUBBLE_DEFAULT_SHOW":B+"/tmallbrand.99.141","PROF_VIP_BUBBLE_DEFAULT_CLICK":B+"/tmallbrand.99.142","PROF_VIP_BUBBLE_SHOP_SHOW":B+"/tmallbrand.99.143","PROF_VIP_BUBBLE_SHOP_CLICK":B+"/tmallbrand.99.144","PROF_VIP_BUBBLE_DETAIL_SHOW":B+"/tmallbrand.99.145","PROF_VIP_BUBBLE_DETAIL_CLICK":B+"/tmallbrand.99.146","PROF_VIP_ACTIVATE_BUTTON":B+"/tmallbrand.99.147","PROF_VIP_ACTIVATE_SHOW":B+"/tmallbrand.99.148","PROF_VIP_ACTIVATE_SUCCESS":B+"/tmallbrand.99.149","PROF_VIP_COUPON_RENEWAL":B+"/tmallbrand.99.150","PROF_VIP_ITEM_RENEWAL":B+"/tmallbrand.99.151","PROF_VIP_BRAND_RENEWAL":B+"/tmallbrand.99.152","BRAND_MZ_TRY_BUBBLE_SHOW_DETAIL":B+"/tmallbrand.99.156","BRAND_MZ_TRY_BUBBLE_CLICK_DETAIL":B+"/tmallbrand.99.157","BRAND_MZ_TRY_BUBBLE_SHOW_SHOP":B+"/tmallbrand.99.158","BRAND_MZ_TRY_BUBBLE_CLICK_SHOP":B+"/tmallbrand.99.159","BRAND_MZ_TRY_BUBBLE_SHOW_LIST":B+"/tmallbrand.99.160","BRAND_MZ_TRY_BUBBLE_CLICK_LIST":B+"/tmallbrand.99.161","BRAND_MZ_TRY_BUBBLE_SHOW":B+"/tmallbrand.99.162","BRAND_MZ_TRY_BUBBLE_CLICK":B+"/tmallbrand.99.163","BRAND_MZ_TRY_BUBBLE_SHOW_ALL":B+"/tmallbrand.99.164","BRAND_MZ_TRY_BUBBLE_CLICK_ALL":B+"/tmallbrand.99.165","PROF_CHANNLE_BUBBLE_SHOW_BABY":B+"/tmallbrand.99.170","PROF_CHANNLE_BUBBLE_CLICK_BABY":B+"/tmallbrand.99.171","PROF_VIP_CHANGE_PROF":B+"/tmallbrand.99.166","PROF_VIP_MUYING_NEXT5Z":B+"/tmallbrand.99.167","PROF_VIP_MUYING_NEXT9Y":B+"/tmallbrand.99.168","PROF_VIP_MUYING_EDIT_BABYPLAN":B+"/tmallbrand.99.169","QRCODE_BUBBLE_NEW_QRCODE_SHOW":B+"/tmallbrand.99.172","QRCODE_BUBBLE_NEW_QRCODE_CLICK":B+"/tmallbrand.99.173","QRCODE_BUBBLE_OLD_QRCODE_SHOW":B+"/tmallbrand.99.174","QRCODE_BUBBLE_OLD_QRCODE_CLICK":B+"/tmallbrand.99.175","QRCODE_DEFAULT_BUBBLE_SHOW":B+"/tmallbrand.99.176","QRCODE_DEFAULT_BUBBLE_CLICK":B+"/tmallbrand.99.177","PROF_VIP_ACT_RENEWAL":B+"/tmallbrand.99.178","BRAND_BRAND_VIP_BUBBLE_SHOW":B+"/tmallbrand.99.179","BRAND_BRAND_VIP_BUBBLE_CLICK":B+"/tmallbrand.99.180","WORTH_BUBBLE_BIZ_SHOW":B+"/tmallbrand.99.181","WORTH_BUBBLE_BIZ_CLICK":B+"/tmallbrand.99.182","QRCODE_PUBLIC_BUBBLE_SHOW":B+"/tmallbrand.99.183","WORTH_TAB_EXPAND":B+"/tmallbrand.99.184"},"PE":{},"SCM":{"PROF":"1048.1.2.2","LIVE":"1048.1.5.2","LIVE_BUB_LINK":"1048.1.5.3","BRAND_FLY_BUB_LINK":"1048.1.4.15","CAL_ACT":"1048.1.10.2","FAVOR_ITEM":"1048.1.11.1"},"URL":{"GET_BAR":E?"//bar.daily.tmall.net/getMallBar.htm?shopId={0}&v={1}&bizId={2}&sellerId={3}&itemId={4}":"//bar.tmall.com/getMallBar.htm?shopId={0}&v={1}&bizId={2}&sellerId={3}&itemId={4}","GET_MSG":E?"//bar.daily.tmall.net/getMessageWarn.htm":"//bar.tmall.com/getMessageWarn.htm","GET_PLUGIN_EXAMPLE":"example.do","GEI_PLUGIN_PROF":E?"//bar.daily.tmall.net/getMyInfo.htm":"//bar.tmall.com/getMyInfo.htm","GET_PLUGIN_ASSET":E?"//bar.daily.tmall.net/getMyAssets.htm":"//bar.tmall.com/getMyAssets.htm","GET_PLUGIN_ASSET_COUPON_DUE_TIP":E?"//bar.daily.tmall.net/cueCouponInfo.htm":"//bar.tmall.com/cueCouponInfo.htm","GET_PLUGIN_ASSET_COUPON_DISABLE_TIP":E?"//bar.daily.tmall.net/disableCouponInfo.htm":"//bar.tmall.com/disableCouponInfo.htm","GET_PLUGIN_ASSET_TIP":E?"//bar.daily.tmall.net/cueAssetMsg.htm":"//bar.tmall.com/cueAssetMsg.htm","GET_PLUGIN_MEMBER_RIGHT":E?"//bar.daily.tmall.net/getMemberRight.htm":"//bar.tmall.com/getMemberRight.htm","GET_PLUGIN_BRAND":"brand.do","GET_PLUGIN_GET_BRAND":E?"//mybrand.daily.tmall.net/ajax/mybrands/getMallBarMyBrands.htm?type=2":"//mybrand.tmall.com/ajax/mybrands/getMallBarMyBrands.htm?type=2","GET_PLUGIN_LIVE":E?"//tmm.daily.taobao.net/messagebox/readRadiateMsg.do":"//tmm.taobao.com/messagebox/readRadiateMsg.do?mconf=1","GET_PLUGIN_LIVE_TIP":E?"//bar.daily.tmall.net/getActiveMessage.htm":"//bar.tmall.com/getActiveMessage.htm","GET_PLUGIN_FOOT_ITEMS":E?"//bar.daily.tmall.net/getItemList.htm":"//bar.tmall.com/getItemList.htm","GET_PLUGIN_FOOT_ITEMS2":E?"//bar.daily.tmall.net/getItemList.htm":"//bar.tmall.com/getItemList.htm","GET_PLUGIN_FOOT_PINITEM":E?"//bar.daily.tmall.net/pinItem.htm":"//bar.tmall.com/pinItem.htm","GET_CALENDAR":E?"//tmsprepub.alicdn.com/go/act/getcalendar.php?date={0}":"//www.tmall.com/go/act/getcalendar.php?date={0}","GET_CONF":l?"data/mallbar-conf.js":E?"//tms.taobao.com/go/act/mallbar-conf.php":"//www.tmall.com/go/act/mallbar-conf.php","GEI_PUSH_ITEMS":E?"//110.75.14.52/recommend.htm":"//ald.taobao.com/recommend.htm","GET_PLUGIN_ASSET_OBTAIN_COUPON_LIST":E?"//bar.daily.tmall.net/cueAssetMsg.htm":"//bar.tmall.com/cueAssetMsg.htm","GET_PLUGIN_ASSET_OBTAIN_COUPON":E?"//bar.daily.tmall.net/obtainCoupon.htm":"//bar.tmall.com/obtainCoupon.htm","GET_PLUGIN_FAVOR_INFO":E?"//bar.daily.tmall.net/getCollectInfo.htm":"//bar.tmall.com/getCollectInfo.htm","GET_PLUGIN_FAVOR_FX":"//ald.taobao.com/recommend.htm?appId=03276","GET_PLUGIN_FAVOR_MATCH":"//ald.taobao.com/recommend.htm?appId=03278","FAVORITE_ITEM":E?"//bar.daily.tmall.net/favorite/favoriteItem.htm":"//bar.tmall.com/favorite/favoriteItem.htm","GET_PLUGIN_PROF_QUERY_T0_USER":E?"//bar.daily.tmall.net/activate/queryT0User.htm":"//bar.tmall.com/activate/queryT0User.htm","GET_PLUGIN_PROF_SET_T0_USER":E?"//bar.daily.tmall.net/activate/setT0User.htm":"//bar.tmall.com/activate/setT0User.htm","GET_PLUGIN_WORTH_RECOMMEND":"//ald.taobao.com/recommend.htm?appId=03343","GET_PLUGIN_WORTH_LISTS":"//ald.taobao.com/recommend.htm?appId=03342","GET_PLUGIN_LIVE_SHOP_INFO":E?"//bar.daily.tmall.net/wwDataSet.htm":"//bar.tmall.com/wwDataSet.htm","GET_MBAR_ADD_FAVOR_RECOMMEND":"//aldcdn.tmall.com/recommend.htm?appId=03136","GET_MBAR_ADD_CART_RECOMMEND":"//aldcdn.tmall.com/recommend.htm?appId=03348","GET_SHOP_CARD":E?"//neo.daily.tmall.net/shopcard/showMyCards.do":"//neo.tmall.com/shopcard/showMyCards.do","GET_CLOSE_SALE_NUM":E?"//bar.daily.tmall.net/closeSaleNum.htm":"//bar.tmall.com/closeSaleNum.htm"},"P":{"PROF":"prof","ASSET":"asset","GET_COUPON":"asset","BONUS":"asset","GUESS_POINT":"asset","SIGN_POINT":"asset","BRAND":"brand","LIVE":"live","FOOT":"foot","CAL":"cal","TRIP":"trip","CART":"cart","NAV":" nav","QRCODE":"qrcode","TOP":"top","UE":"ue","CHARGE":"charge","FAVOR":"favor","PROMOTION":"promotion","WORTH":"worth","MY1111":"my1111"},"E":{"AFTER_BAR_CHANGE":"afterBarChange","MALLBAR_STATUS_CHANGE":"mallbarStatusChange","STATUS_CHANGE":"statusChange","SUPTIP_CHANGE":"suptipChange","BUBBLE_CHANGE":"bubbleChange","PAGE_VISIBILITY_CHANGE":"pageVisibilityChange","VISIBILITY_CHANGE":"visibilityChange","DATA_CHANGE":"dataChange","FLYIN_END":"flyinEnd","ERROR":"error","LOGIN":"login","LOGIN_SUCCESS":"loginSuccess","AFTER_EXPAND_CHANGE":"afterExpandChange","AFTER_TITLE_CHANGE":"afterTitleChange","PROF_CHANGE":"profChange","QRCODE_CHANGE":"qrcodeChange","ON_LOAD":"onLoad","PROF_HIDE":"hideProf","RIGHT_TAB_ITEM_CLICK":"rightTabItemClick"},"K":{"BAR":"bar","USERINFO":"userinfo","STATIC_CONF":"staticConf","TIMESTAMP":"timestamp","ACCESSED":"__mallbar_accessed","FRM_INIT":"mui/mallbar/frm/init","FRM_USERINFO":"mui/mallbar/frm/userinfo","FRM_ACCESS":"mui/mallbar/frm/access","FRM_STATUS":"mui/mallbar/frm/status","FRM_CART":"mui/mallbar/frm/cart","IFRAME":"iframe","XD":"xd","XD_TIMEOUT":"xdTimeout","IFRAME_TIMEOUT":"iframeTimeout","PROXY":"proxy","CALLBACK_LIST":"callbackList","CACHED_ACTION_LIST":"cachedActionList","PROXY_READY":"proxyReady","INITED":"inited","CONTAINER":"container","G_CONFIG":"gConfig","SHOP_CONFIG":"shopConfig","ITEMS":"items","MODEL":"model","ROOT":"root","ROOT_OUTER":"rootOuter","STATUS":"status","OLD_INDEX":"oldIndex","LOADED":"loaded","MALLBAR":"mallbar","MALLBAR_ITEM":"mallbarItem","TIP_CONTAINER":"tipContainer","TAB":"tab","TITLE":"title","INDEX":"index","BUBBLE":"bubble","PLUGIN":"plugin","SCR":"scr","EXPAND":"expand","POBJ":"pluginObj","PG_FISRT_VISIBLE":"pgFirstVisible","DATA":"data","SHOW_SUPTIP":"showSuptip","SUPTIP_NUM":"suptipNum","BUBBLE_TYPE":"bubbleType","SHOW_BUBBLE":"showBubble","NOT_TO_SUPTIP":"notToSuptip","COUPON_ANCHOR":"anchor","ADD_CART_ITEM":"addCartItem"},"B":{"FOREVER":1},"S":{"MINI":1,"STANDARD":2,"EXPAND":3,"SCREEN":4,"BAR_NO_MSG":-4,"BAR_NOT_LOGIN":-2,"BAR_SUCCESS":1},"C":{"TAB_HIGHLIGHT":"mui-mbar-tab-hover","TABS_SHADOW":"mui-mbar-tabs-shadow","MINI_CLOSE":"mui-mbar-mini-logo-close","CAT_LEFT":"mui-mbar-cat-left","SCALE_DOWN":"mui-mbar-plugin-scaleDown"},"M":{"B":"\u672c\u9875\u9762\u4e0d\u652f\u6301\u5de5\u5177\u680f","T":"\u63d2\u4ef6\u7c7b\u578b\u53ea\u652f\u6301\uff1abrand\u3001asset\u3001prof\u3001live\u3001foot"},"U":{"PROF_INTERACT":"//1111.tmall.com","ETC":{"DAILY":"//pre-wormhole.tmall.com/wh/fragment/tmbase/mallbar_3_2_16","STB":"//fragment.tmall.com/tmbase/mallbar_3_2_16","PRE":"//pre-wormhole.tmall.com/wh/fragment/tmbase/mallbar_3_2_16","ONLINE":"//fragment.tmall.com/tmbase/mallbar_3_2_16"},"QR":"//gtd.alicdn.com/tps/i1/TB1DV.LGXXXXXXgXFXXszjdGpXX-140-140.png","WW_MODULE":"//g.alicdn.com/aliww/ww/tlight/base.js"},"T":{"NUMLEV":13}}});KISSY.add("mui/mallbar/util",function(a,e,i,t,o,r,n,s){var m=/(\/\/.+?)(\?(.*?))?(#(.*?))?$/,l={"log":function(){n.DEBUG_LOG&&window.console&&window.console.log&&window.console.log.apply&&window.console.log.apply(window.console,arguments)},"fm":function(){if(0==arguments.length)return"";if(1==arguments.length)return arguments[0];var a,e=arguments[0];for(a=1;a<arguments.length;++a){var i=new RegExp("\\{"+(a-1)+"\\}","g");e=e.replace(i,arguments[a])}return e},"segment":function(a){var e={"url":"","qs":"","hash":""};if(!a)return e;a+="";var i=m.exec(a);return i?(e.url=i[1]?i[1]:"",e.qs=i[3]?i[3]:"",e.hash=i[5]?i[5]:"",e):e}},c=l;c.getViewportWidth=function(){var a=document.documentElement;return window.innerWidth||a&&a.clientWidth||document.body.clientWidth},c.getViewportHeight=function(){var a=document.documentElement;return window.innerHeight||a&&a.clientHeight||document.body.clientHeight},c.getViewportSize=function(){return{"w":c.getViewportWidth(),"h":c.getViewportHeight()}},c.sendLog=function(a){if(a){var e="__mbar_"+ +new Date+Math.random(),i=new Image;window[e]=i,i.src=c.fm("{0}{1}r{2}=1",a,a.indexOf("?")>-1?"&":"?",+new Date),i.onload=function(){window[e]=null}}};var u,b=[];c.getStaticConf=function(e){if(u)return void(e.cb&&e.cb(u));e.cb&&b.push(e.cb),e.url&&c.ajax({"url":e.url,"jsonpCallback":"__mallbarGetConf","scriptCharset":"gbk","error":function(a){c.log("__mallbarGetConf error\uff1a",a)},"success":function(e){c.log("__mallbarGetConf",e),e&&(u=e,a.each(b,function(a){a(e)}),b=[])}})},c.ajax=function(e){var i=e.success,t=e.complete;if(location.href.indexOf("mbar-local=1")>-1&&n.DEBUG&&e.url.indexOf("mconf")>=0){e.type="get",e.dataType="script";var o="",r=e.url;if(e.url.indexOf("?")>=0){var s=e.url.split("?");r=s[0],o=s[1]}var m=r.substring(r.lastIndexOf("/")+1,r.lastIndexOf(".")>=0?r.lastIndexOf("."):r.length);r=c.fm("data/{0}.js{1}",m,o?"?"+o:""),e.url=e._mockUrl?e._mockUrl:r,e.success=function(){i&&i(exports.response)}}else e.type=e.type||"get",e.dataType=e.dataType||"jsonp",e.success=function(a){i&&i(a)};var l=e.url.lastIndexOf("?")>-1;e.url=c.fm("{0}{1}_input_charset=UTF-8",e.url,l?"&":"?"),e.timeout=e.timeout||5,e.error=e.error||function(a){c.log("U.ajax error: ",a)};var u=window.g_config||{};e.data=e.data||{},e.data.bizInfo=[u.bizId||"",u.sysId||"",u.devId||"pc"].join("."),e.complete=function(a){t&&t(a)},e.scriptCharset="gbk",a.ajax(e)},c.deepMerge=function(e,i){return a.isObject(e)&&a.isObject(i)?(a.each(i,function(i,t){a.isObject(e[t])?c.deepMerge(e[t],i):e[t]=i}),e):e},c.noScroll=function(a){a&&t.on(a,"mousewheel",function(a){var e=a.delta,i=this.scrollTop;(e>0&&0===i||e<0&&i+o.outerHeight(this)>=this.scrollHeight)&&a.halt()})};var d=/^(\d+?)-(\d+?)-(\d+?) (\d+?):(\d+?):(\d+?)$/,p=/^(\d+?)-(\d+?)-(\d+?)$/;c.getDateStr=function(a){return a=a instanceof Date?a:new Date(a),c.fm("{0}-{1}-{2}",a.getFullYear(),a.getMonth()+1,a.getDate())},c.parseDate=function(a){var e;return(e=d.exec(a))?new Date(e[1],parseInt(e[2],10)-1,e[3],e[4],e[5],e[6]):(e=p.exec(a),e?new Date(e[1],parseInt(e[2],10)-1,e[3]):null)},c.addSCM=function(a,e){var i=c.segment(a);return i.qs=c.fm("?{0}{1}scm={2}",i.qs,i.qs?"&":"",e),c.fm("{0}{1}{2}",i.url,i.qs,i.hash?"#"+i.hash:"")},c.replaceSCM=function(a,e){return-1===a.indexOf("?")?a+"?scm="+e:a.replace(/\bscm=[\d\.]+&?/i,"")+"&scm="+e};var f=/^(\d+)\.(\d+)\.(\d+)$/;return c.compareVersion=function(a,e){return f.test(a)&&f.test(e)?(a=f.exec(a),e=f.exec(e),a=100*parseInt(a[1],10)+10*parseInt(a[2],10)+parseInt(a[3],10),e=100*parseInt(e[1],10)+10*parseInt(e[2],10)+parseInt(e[3],10),a===e?0:a<e?-1:a>e?1:void 0):-2},c.sub=function(a,e){var i=/[^\x00-\xff]/g;if(a.replace(i,"mm").length<=e)return a;e-=3;for(var t=Math.floor(e/2),o=t;o<a.length;o++)if(a.substr(0,o).replace(i,"mm").length>=e)return a.substr(0,o)+"...";return a},c.getSysId=function(){var a="",e=1==window.g_config.appId,i="list"==window.g_config.sysId,t=2==window.g_config.appId||7==window.g_config.appId;return!!i&&(a="list"),!!e&&(a="detail"),!!t&&(a="shop"),a},c},{"requires":["cookie","ajax","event","dom","ua","mui/mallbar/conf","mui/minilogin/index"]});window.MLoginTimer=0,window.MLoginShow=0,KISSY.add("mui/minilogin/index",function(o,e,n){function i(o){var e=document.createElement("a");return e.href=o,e.hostname===location.hostname}var t,a=function(o){var e=location.hostname.split(".");return e.splice(e.length-o>0?e.length-o:0,o).join(".")}(2),l=location.hostname.indexOf(".net")>=0||location.hostname.indexOf(".com.hk")>=0,c=l?"daily.taobao.net":"taobao.com",r=l?"daily.tmall.net":"tmall.com",m=l?"daily.tmall.com.hk":"tmall.hk",d="assets_css=3.0.10/login_pc.css",s="//login."+c+"/member/login.jhtml?style=miniall&newMini2=true&enup=true&from=tmall&allp="+escape(d),w=window.location.protocol,g={"check":!0,"needRedirect":!1,"sub":!1,"proxy":{"tmall":w+"//vip."+r+"/miniLoginProxy.htm","hk":w+"//www."+m+"/loginproxy.htm","yao":w+"//yao.95095.com/go/rgn/95095/loginproxy.php","etao":w+"//vip.daily.tmall.net/miniLoginProxy.htm","liangxinyao":w+"//alihealthyao.liangxinyao.com/markets/lxyao/proxy"}},h={"show":function(e,n){window.goldlog&&window.goldlog.send("//log.mmstat.com/tmallmember.9.2",{}),h.Analytics.MLstar=1*new Date;var i=this;"function"!=typeof e&&(n=e,e=null),n=o.merge(g,n);var t=new Date;t.setDate(t.getDate()-1),document.cookie="cookie2=;expires="+t.toGMTString()+";path=/;domain=.tmall.com",!1===n.check?this._show(e,n):this._check(function(t){h.Analytics.MLcheckStar=1*new Date,t?(window.MLoginShow<=1&&!o.UA.mobile&&window.TB&&TB.Global&&TB.Global.updateLoginInfo(),e&&e(),window.MLoginShow+=1):i._show(e,n)},n)},"_checkPage":function(){return window.TB&&window.TB.userInfo&&window.TB.userInfo.isLogin},"_check":function(e,n){h.Analytics.MLcheckStar=1*new Date;var i=this,t=n.checkTimeout||5,a=!1,l=o.later(function(){a||e(i._checkPage()),l&&l.cancel()},1e3*t);return n&&n.checkApi&&-1==n.checkApi.indexOf(".tmall.")&&(n.checkApi=undefined),o.io({"type":"get","url":n.checkApi?n.checkApi:"//miaoxin."+r+"/member/user_login_info2.do","success":function(o){if(h.Analytics.MLcheckEnd=1*new Date,o=o||{},1111==o.status)return a=!0,void e(i._checkPage());a=!0,e(o.login)},"error":function(){a=!0,e(i._checkPage())},"timeout":t,"dataType":"jsonp","charset":"utf-8","cache":!1,"headers":{"X-Requested-With":!1}})},"_show":function(n,l){if(h.Analytics.MLshowStar=1*new Date,window.MLoginTimer+=1,l.insert&&(window.MLoginTimer=0),!(window.MLoginTimer>1)){var r,m=s,d="",w=window.location.hostname,g="";if(o.UA.mobile)return d=window.location.href,m="//login."+c+"/member/login.jhtml?redirectURL="+encodeURIComponent(d),window.location.href=m,window.MLoginTimer=0,!1;if(l.needRedirect){var u=l.redirectUrl?l.redirectUrl:location.href.split("#")[0];m+="&full_redirect=true&tpl_redirect_url="+encodeURIComponent(u)}else r="g_tml_callbak"+(new Date).getTime(),window[r]=function(){var o=window.TB||{};t&&t.hide(),o&&o.Global&&o.Global.updateLoginInfo(),window.MLoginTimer=0,window.MLoginShow+=1,n&&n.apply(this,arguments);try{delete window[r]}catch(e){}},l.proxyURL?d+=l.proxyURL:w.indexOf(".hk")>=0?d+=l.proxy.hk:w.indexOf("95095.com")>=0?d+=l.proxy.yao:w.indexOf("95095.daily.etao.net")>=0?d+=l.proxy.etao:w.indexOf("liangxinyao.com")>=0?d+=l.proxy.liangxinyao:d+=l.proxy.tmall,d+=(d.indexOf("?")>0?"&":"?")+"callback="+r,i(d)||document.domain===a||(document.domain=a),i(d)&&document.domain===location.hostname&&(d+="&nsdomain=true"),m+="&full_redirect=false&tpl_redirect_url="+encodeURIComponent(d);if(l.sub&&(m+="&sub=true"),window.g_config&&window.g_config.moduleTimeStamp&&window.g_config.moduleTimeStamp.minilogin&&(m+="&t="+window.g_config.moduleTimeStamp.minilogin),g='<iframe class="j_minilogin_iframe" style="background: rgb(250, 250, 250);" width="350" scrolling="no" height="400" frameborder="no" src="'+m+'"></iframe>',l.insert)return void o.all(l.insert).append(g);t=new e({"width":350,"height":436,"bodyContent":g,"mask":!0,"showCat":!0,"zIndex":999999,"align":{"points":["cc","cc"]}}),t.render(),t.show();var f=o.version.indexOf("1.3")>=0,p=o.all(f?t.__attrVals.el:t.$el),y=f?".mui-stdmod-body":".mui-dialog-body",k=f?".mui-ext-close":".mui-dialog-close",x=p.all(".j_minilogin_iframe");x.parent(y).style("background-color","#FAFAFA"),h.Analytics.MLshowEnd=1*new Date;x.parent(".mui-dialog").addClass("my-minilogin-dialog"),p.all(k).on("click",function(){l.closeCallback&&l.closeCallback(),window.MLoginTimer=0,t.destroy()}),x.on("load",function(){h.Analytics.MLloaded=1*new Date,h.sendTrack()})}},"Analytics":{},"sendTrack":function(){if(window.performance&&(!window.performance||window.performance.getEntriesByType)){for(var o,e=0,n=window.performance.getEntriesByType("resource");e<n.length;e++)if("iframe"==n[e].initiatorType&&n[e].name.indexOf("https://login.taobao.com/member/login.jhtml")>=0){o=n[e];break}if(o){var i=[];for(var t in o)i.push(t+"="+("name"==t?"//login.taobao.com":o[t]));for(var t in h.Analytics)i.push(t+"="+h.Analytics[t]);i.push("MLtype=minilogin");var a=["[uhttp://login.tmall.com/track/0.2.0/]","[r10]"].join(""),l=document.cookie.match(/_nk_\=([^\;]*); /),c=l&&l[1]||"",r="//gm.mmstat.com/ued.1.1.2?type=9&id=jstracker&v=0.02&nick="+encodeURIComponent(c)+"&msg="+a+escape(i.join("&"));(new Image).src=r}}}};return h},{"requires":["mui/overlay/dialog","io","mui/minilogin/index.css"]});KISSY.add("mui/overlay/dialog",function(e,t){function i(t){var n=this;n.config=e.merge(i.Config,t);n.config.elCls=n.config.elCls||"";n.config.elCls+=n.config.skin?" mui-dialog-"+n.config.skin:"";if(n.config.mask){n.config.elCls+=" mui-dialog-hasmask"}i.superclass.constructor.call(this,n.config);var s=true;function o(){var t=n.get("el"),i=e.UA.ie<8?"style='height:expression(this.parentNode.clientHeight);'":"";t.append("<div class='mui-dialog-skin' "+i+"></div>"+(n.config.showCat?"<i class='mui-dialog-cat'></i>":""));s=false}n.on("afterRenderUI",function(){o()});if(n.get("initRender")){n.render()}}i.Config={prefixCls:"mui-",showCat:true,zIndex:99999,initRender:false};e.extend(i,t.Dialog);e.augment(i,{setBodyContent:function(e){var t=this;t.set("bodyContent",e);t.render()},setHeaderContent:function(e){var t=this;t.set("headerContent",e);t.render()},setFooterContent:function(e){var t=this;t.set("footerContent",e);t.render()}});if(e.version.match(/^1\.[123]/)){e.getScript(location.protocol+"//g.alicdn.com/mui/overlay/1.0.6/overlay.css")}return i},{requires:["overlay","mui/overlay/overlay.css","mui/button/btn.css","mui/button/btn-tb.css","mui/msg/msg.css"]});KISSY.add("mui/mallbar/model",function(a,e,t,i,n,r){var o=window.location.href.indexOf("mbar-mock-20141111=1")>-1,l=function(a){var e=this;a=a||{},l.superclass.constructor.call(e,a),e.init()};return a.extend(l,a.Base,{"init":function(){},"isAccessed":function(){var a=t.get(i.CK_USED);return n.log("used",a,t),"1"===a},"setAccessed":function(){t.set(i.CK_USED,"1",2147483647/86400,i.DOMAIN,"/")},"getServerTime":function(){var a=this,e=a.get(i.K.TIMESTAMP);return e?new Date(e):new Date},"getUid":function(a){var e=this;a=a||e.get(i.K.USERINFO);var t="";try{a&&a.memberInfo&&(t=a.memberInfo.cookies.unb.value)}catch(r){n.log("getUid error",r)}return t},"getBar":function(e){function t(t){clearTimeout(b),n.log("\u5df2\u83b7\u53d6\u7528\u6237\u6570\u636e memberInfoReady",t),m.set(i.K.USERINFO,t),r.set({"k":i.K.FRM_USERINFO,"v":""}),t.isLogin&&Math.random()<i.SAM_PV&&n.sendLog(i.ARR.LOGIN1),window.shop_config?e.sellerNickName=window.shop_config.user_nick||"":e.sellerNickName=e.gConfig.sellerNickName||"",n.log("\u5f00\u59cb\u83b7\u53d6\u6846\u67b6\u6570\u636e",e),n.ajax({"url":n.fm(i.URL.GET_BAR,e.shopId||e.gConfig.shopId||"",i.VER,e.gConfig.bizId||"",e.gConfig.sellerId||"",e.gConfig.itemId||""),"data":{"sellerNickName":decodeURIComponent(e.sellerNickName)},"scriptCharset":"gbk","jsonpCallback":"__mallbarGetMallBar","success":function(t){if(n.log("\u5df2\u83b7\u53d6\u6846\u67b6\u6570\u636e",t),t){t.t&&m.set(i.K.TIMESTAMP,t.t);var l=t.s;l!==i.S.BAR_SUCCESS&&l!==i.S.BAR_NOT_LOGIN&&l!==i.S.BAR_NO_MSG||(l===i.S.BAR_SUCCESS&&Math.random()<i.SAM_PV&&n.sendLog(i.ARR.LOGIN2),n.getStaticConf({"url":i.U.ETC[t.l.toUpperCase()],"cb":function(l){if(l.l&&l.l.length){var s=[];a.each(l.l,function(a){var t=o&&a.specail;if(a.on&&(!a.since||n.compareVersion(i.VER,a.since)>=0)||t){if("chaoshi"===e.gConfig.bizId&&a.id===i.P.CART)return;a.m=0,s.push(a)}}),s.length&&(t.l=s,a.each(t.q,function(e){a.each(t.l,function(a){if(a.id===e.id)return a.m=e.m,!1})}),r.set({"k":i.K.FRM_INIT,"success":function(){n.log("\u5408\u5e76\u540e\u7684\u6846\u67b6\u6570\u636e",t),m.set(i.K.BAR,t)}}))}}}))}},"error":function(t){n.log("\u83b7\u53d6\u6846\u67b6\u6570\u636e\u5931\u8d25",t),n.getStaticConf({"url":i.U.ETC.ONLINE,"cb":function(r){if(t=t||{},r.l&&r.l.length){var o=[];a.each(r.l,function(a){if(a.on&&(!a.since||n.compareVersion(i.VER,a.since)>=0)){if("chaoshi"===e.gConfig.bizId&&a.id===i.P.CART)return;a.m=0,o.push(a)}}),o.length&&m.set(i.K.BAR,{"l":o})}}})}})}function l(a){s=!0,a=a||d,n.log("\u8d85\u65f6\u5f02\u5e38\u6216\u65e0\u540a\u9876",a),t(a)}var m=this,s=!1,b=0,c=e.mallbar||null,d={"isLogin":!0,"nick":"","memberInfo":{"isLogin":!0,"availablePoints":-99,"activeStatus":-99,"cookies":{"unb":{"value":""}}}};n.log("\u5f00\u59cb\u83b7\u53d6\u7528\u6237\u6570\u636e");var u=window.TB;if(u&&u.Global&&u.Global.loginStatusReady&&u.Global.memberInfoReady){var _={};b=setTimeout(function(){var e=n.deepMerge(a.clone(d),e);n.log("timeout enter",e),l(e)},i.TIMEOUT_TOP),u.Global.loginStatusReady(function(a){n.log("loginStatusReady",a),_=a,c.set("token",a.tbToken),a.isLogin?u.Global.memberInfoReady(function(a){if(s)return void n.log("timeout quit",a);t(a)}):t(a)})}else l();var g=c.get(i.K.SHOP_CONFIG)||c.get(i.K.G_CONFIG)||{},f="",p="",T="",E="",A="",h="";window.g_config&&window.g_config.itemId&&(f=window.g_config.itemId),p=g.userId||g.sellerId||"",T=g.shopId?g.shopId:"";var I=a.one(".j_CollectBrand");I&&(A=I.attr("data-brandId")||"");var v=a.one("#J_CrumbSearchForm"),B=v&&v.one('input[name="cat"]');if(B&&(E=B.val()),!E){E=(a.unparam(n.segment(location.href).qs)||{}).cat||""}window.g_config&&(h=window.g_config.bizId?window.g_config.bizId:""),c.set("itemId",f),c.set("sellerId",p),c.set("shopId",T),c.set("brandId",A),c.set("category",E),c.set("bizId",h),setTimeout(function(){window.devicePixelRatio>1&&Math.random()<i.SAM_PV&&n.sendLog(i.ARR.RETINA)},3e3)}}),l},{"requires":["base","cookie","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store"]});KISSY.add("mui/mallbar/store",function(a,e,i,t){if(window.__MUI_STORAGE)return window.__MUI_STORAGE;var o;return window.TB&&TB.Global&&TB.Global.storage?(o=TB.Global.storage,i.log("TB.Global.storage",o)):(o=new t,i.log("mallbar storage",o)),window.__MUI_STORAGE=o,o},{"requires":["mui/mallbar/conf","mui/mallbar/util","mui/storage/index"]});KISSY.add("mui/storage/index",function(e,t,n,r,o,a){var i={};var c=0;var s=function(t){var n=this;t=t||{};t.token=+new Date+o.getRndStr(8);var a=t.proxy||r.PROXY;switch(a){case"tmall":a=r.PROXY_TMALL;break;case"taobao":a=r.PROXY_TAOBAO;break;case"common":a=r.PROXY;break}a=o.fm("{0}{1}{2}={3}",a,a.indexOf("?")>-1?"&":"?",r.XD_TOKEN,t.token);t.proxy=a;t.prefix=t.prefix||"";n._opt=e.merge(i,t);n.init()};e.augment(s,{init:function(){var t=this;t.setConf(r.K.CALLBACK_LIST,{});t.setConf(r.K.CACHED_ACTION_LIST,[]);t.setConf(r.K.PROXY_READY,false);var n=t.getConf(r.K.CALLBACK_LIST);var i=t.getConf(r.K.CACHED_ACTION_LIST);var s=document.createElement("iframe");var u=s.style;u.display="none";var f=-1;function d(u){var f=new a({target:s.contentWindow,token:t.getConf(r.K.TOKEN),iframeTimeout:u,timeout:t.getConf(r.K.XD_TIMEOUT),receive:function(e){var t=n[e.c];if(t){t(e.v);try{delete n[e.c]}catch(r){}}}});t.setConf(r.K.XD,f);function d(){t.setConf(r.K.PROXY_READY,true);e.each(i,function(e){f.send(e,"*")});t.setConf(r.K.CACHED_ACTION_LIST,[]);var n=t.getConf(r.K.ONLOAD);n&&n()}if(u){d()}else{if(window.postMessage){var l=false;var m=0;var _=setInterval(function(){++m;o.log(m,l);if(l||m>30){clearInterval(_);d();return}var e="token"+ ++c;n[e]=function(e){l=!!e};f.send({m:"connect",c:e},"*",true)},50)}else{setTimeout(d,600)}}}f=setTimeout(function(){f=0;d(true)},t.getConf(r.K.IFRAME_TIMEOUT)||r.TIMEOUT_STORAGE);function l(e){o.log("storage proxy loaded");clearTimeout(f);if(!f){return}d(false)}if(s.attachEvent){s.attachEvent("onload",l)}else{s.onload=l}s.src=t.getConf(r.K.PROXY);document.body.appendChild(s)},send:function(t){var n=this;var o=n.getConf(r.K.CALLBACK_LIST);var a=n.getConf(r.K.CACHED_ACTION_LIST);var i=n.getConf(r.K.PROXY_READY);var s=n.getConf(r.K.PREFIX);t.p=s;if(e.isFunction(t.success)){var u="token"+ ++c;t.c=u;o[u]=t.success;try{delete t.success}catch(f){}}if(!i){a.push(t);return}var d=n.getConf(r.K.XD);d&&d.send(t)},get:function(e){e=e||{};e.m="get";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_GET)},set:function(e){e=e||{};e.m="set";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_SET)},remove:function(e){e=e||{};e.m="remove";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_RM)},clear:function(e){e=e||{};e.m="clear";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_CL)},getConf:function(e){return this._opt[e]},setConf:function(e,t){this._opt[e]=t}});return s},{requires:["event","json","mui/storage/conf","mui/storage/util","mui/storage/xd"]});KISSY.add("mui/storage/conf",function(){var e=location.href.indexOf("if-debug=1")>-1;var t=location.href.indexOf("if-debug-log=1")>-1;var r="//gm.mmstat.com";var n="//log.mmstat.com/ued.1.1.2?type=9&_gm:id=storage&v=1.1";var a={DEBUG:e,DEBUG_LOG:t,SAM_PV:1/1e3,TIMEOUT_STORAGE:3*1e3,PROXY:e?"//pre-wormhole.tmall.com/wow/tmbase/act/storage-proxy-3-0-4":"//pages.tmall.com/wow/tmbase/act/storage-proxy-3-0-4",PROXY_TMALL:e?"//pre-wormhole.tmall.com/wow/tmbase/act/storage-proxy-3-0-4":"//pages.tmall.com/wow/tmbase/act/storage-proxy-3-0-4",PROXY_TAOBAO:e?"//pre-wormhole.tmall.com/wow/tmbase/act/storage-proxy-3-0-4":"//pages.tmall.com/wow/tmbase/act/storage-proxy-3-0-4",XD_TOKEN:"__mui_xd_token",UID_FROM:"__mui_xd_from",UID_TO:"__mui_xd_to",M:{G:n+"&t=g",P:n+"&t=p"},ARR:{ST_SET:r+"/tmallbrand.999.5",ST_GET:r+"/tmallbrand.999.6",ST_RM:r+"/tmallbrand.999.7",ST_CL:r+"/tmallbrand.999.8",ST_TMO:r+"/tmallbrand.999.10"},K:{ONLOAD:"onload",PROXY:"proxy",PREFIX:"prefix",XD_TIMEOUT:"xdTimeout",IFRAME_TIMEOUT:"iframeTimeout",IFRAME:"iframe",TOKEN:"token",XD:"xd",CALLBACK_LIST:"callbackList",CACHED_ACTION_LIST:"cachedActionList",PROXY_READY:"proxyReady"}};return a});KISSY.add("mui/storage/util",function(e,t){var n={log:function(){if(!t.DEBUG_LOG){return}if(window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,arguments)}},fm:function(){if(arguments.length==0){return""}else if(arguments.length==1){return arguments[0]}var e=arguments[0],t;for(t=1;t<arguments.length;++t){var n=new RegExp("\\{"+(t-1)+"\\}","g");e=e.replace(n,arguments[t])}return e}};var r=n;r.sendLog=function(e){r.send(r.fm(t.M.G,encodeURIComponent(location.href)));r.send(e)};r.send=function(e){if(!e){return}var t="__st_"+ +new Date+Math.random();var n=new Image;window[t]=n;n.src=r.fm("{0}{1}r{2}=1",e,e.indexOf("?")>-1?"&":"?",+new Date);n.onload=function(){window[t]=null}};var o="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";r.getRndStr=function(e){var t=[];var n=o.length,r;for(var a=0;a<e;++a){r=o.charAt(Math.floor(Math.random()*n));t.push(r)}return t.join("")};return r},{requires:["mui/storage/conf"]});KISSY.add("mui/storage/xd",function(e,t,n,r,a,o){var i=0;var s=document.domain;var u="receive";var c="token";var f="target";var m="timeout";var d="iframeTimeout";var l=10;var v=10;var g=3*1e3;var _="_name_store_";var p=window;var h=p.postMessage;var O={};var T=[];function w(){if(h){if(p.addEventListener){addEventListener("message",A,false)}else if(p.attachEvent){attachEvent("onmessage",A)}}else{I.onMessage(A)}}var I={uid:0,hid:-1,q:[],tm:0,postMessage:function(e,t,n){var r=++I.uid;var a=I.q;var i={name:+new Date+""+r+"^"+s+"&"+t,uid:r,target:e};a.push(i);if(!I.tm){I.tm=setInterval(function(){var e=I.q;if(e.length===0||e[0].uid===I.hid){return}var t=e[0];I.hid=t.uid;o.setItem(_,name)},v)}},onMessage:function(e){var t="";var n=/^(\d+?)\^(.+?)&(.*?)$/;function r(){var r=o.getItem(_);if(r!==t){I.q.shift();t=r;var a=n.exec(r);if(!a){return}var i={origin:a[2],data:a[3]};e&&e(i)}}setInterval(r,l)}};function A(t){var a={};try{a=n.parse(t.data)}catch(o){return}var i=a[r.XD_TOKEN];e.each(T,function(e){if(i===e.get(c)&&r.UID_FROM in a&&r.UID_TO in a){var t=a[r.UID_TO];if(t){var n=O[t];clearTimeout(n);O[t]=0;if(!n){return}}e.get(u)(a)}})}w();function E(e){var t=this;t._opt=e;T.push(t)}e.augment(E,{send:function(t,o,u){if(!e.isObject(t)){return}var l=this;var v=l.get(f);var _=l.get(m)||g;var p=++i;o=o||"*";t[r.XD_TOKEN]=l.get(c);t[r.UID_TO]=t[r.UID_FROM]||0;t[r.UID_FROM]=u?0:p;var T=n.stringify(t);function w(){h&&I.q.shift();var e={};e.origin="*";var a={};a.c=t.c||"";a[r.XD_TOKEN]=t[r.XD_TOKEN]||"";a[r.UID_FROM]=0;a[r.UID_TO]=0;e.data=n.stringify(a);A(e)}if(!u){O[p]=setTimeout(function(){a.log(s,"timeout",p);O[p]=0;w();Math.random()<r.SAM_PV&&a.sendLog(r.ARR.ST_TMO)},_)}if(l.get(d)){w()}else{if(h){v.postMessage(T,o)}else{I.postMessage(v,T,o)}}},get:function(e){return this._opt[e]},set:function(e,t){this._opt[e]=t}});return E},{requires:["event","json","mui/storage/conf","mui/storage/util","mui/storage/name"]});KISSY.add("mui/storage/name",function(e){var t=window;var n="nameStorage:";var r=/^([^=]+)(?:=(.*))?$/;var o="?";var a="=";var i="&";var c=encodeURIComponent;var u=decodeURIComponent;var f={};var s;var d={};var l={};(function g(e){if(e&&e.indexOf(n)===0){var t=e.split(/[:?]/);t.shift();s=u(t.shift())||"";var o=t.join("");var a=o.split(i);for(var c=0,d,l,m,v=a.length;c<v;c++){d=a[c].match(r);if(!d||!d[1]){continue}l=u(d[1]);m=u(d[2])||"";f[l]=m}}else{s=e||""}})(t.name);l.setItem=function(e,t){if(!e||"undefined"===typeof t){return}f[e]=String(t);m()};l.getItem=function(e){return f.hasOwnProperty(e)?f[e]:null};l.removeItem=function(e){if(!f.hasOwnProperty(e)){return}f[e]=null;delete f[e];m()};l.clear=function(){f={};m()};l.valueOf=function(){return f};l.toString=function(){var e=t.name;return e.indexOf(n)===0?e:n+e};function m(){var e=[];var r=true;var u;for(var d in f){if(!f.hasOwnProperty(d)){continue}r=false;u=f[d]||"";e.push(c(d)+a+c(u))}t.name=r?s:n+c(s)+o+e.join(i)}function v(e,t,n){if(!e){return}if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,function(t){n.call(e,t)})}}v(t,"beforeunload",function(){m()});return l});KISSY.add("mui/mallbar/mallbar-item",function(a,e,t,i,n,r,l,o,m,s){var b=['<div class="mui-mbar-bubble">','<div class="mui-mbar-arr mui-mbar-bubble-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbar-bubble-close-bg"></div>','<div class="mui-mbar-bubble-bd">{0}</div>',"</div>"].join(""),c=['<div class="mui-mbar-tab-sup-bg">','<div class="mui-mbar-tab-sup-bd">{0}</div>',"</div>"].join(""),d=new r(['<div class="mui-mbar-dialog">','<div class="mui-mbar-dialog-mask"></div>','<div class="mui-mbar-dialog-bd">','  <div class="mui-mbar-dialog-tip">{{{tip}}}</div>','  <div class="mui-mbar-dialog-btn"><div class="mui-mbar-dialog-btn-txt mui-mbar-dialog-yes">\u786e\u5b9a</div></div>','   {{#if dialogType===2}}<div class="mui-mbar-dialog-btn"><div class="mui-mbar-dialog-btn-txt mui-mbar-dialog-no">\u53d6\u6d88</div></div>{{/if}}',"</div>","</div>"].join("")),u=function(a){var e=this;u.superclass.constructor.call(e,a),e.init()};return u.ATTRS={"showBubble":{"value":!1},"expand":{"value":!1},"pgFirstVisible":{"value":!0},"suptipNum":{"value":0}},a.extend(u,e,{"init":function(){var e=this,t=e.get(o.K.MALLBAR),i=t.get(o.K.MODEL),r=i.get(o.K.USERINFO),l=t.get(o.K.ITEMS),d=e.get(o.K.DATA),u=e.get(o.K.PLUGIN),_=u.one(".mui-mbar-plugin-bd"),g=u.one(".mui-mbar-plugin-cover"),p=e.get(o.K.TAB),f=e.get(o.K.BUBBLE),T=f.one(".mui-mbar-tab-bubble-bd"),E=p.one(".mui-mbar-tab-sup"),A=p.one(".mui-mbar-tab-tip"),h=p.one(m.fm(".mui-mbar-tab-logo-{0}",d.id)),B=m.fm(".mui-mbar-tab-hover"),v=m.fm(".mui-mbar-tab-sel"),I=m.fm(".mui-mbar-tab-logo-{0}-sel",d.id),C=0;_.on("scroll",a.buffer(function(a){_.scrollTop()>0?g.css("visibility","visible"):g.css("visibility","hidden")},100)),!d.scroll&&m.noScroll(_),a.use(d.p,function(a,t){var i=new t({"mallbarItem":e,"container":_,"pluginHead":u.one(".mui-mbar-plugin-hd"),"tipContainer":u.one(".mui-mbar-plugin-hd-tip")});e.set(o.K.POBJ,i)}),u.one(".mui-mbar-plugin-hd-close").on("click",function(){t.fire(o.E.STATUS_CHANGE,{"status":o.S.STANDARD})});var O=0;p.on("mouseenter",function(){if(!a.one(".mui-mbar").one(".mui-mbar-tabs").hasClass("mui-mbar-tabs-wide")||!p.hasClass("mui-mbar-tab-custom")){if(p.addClass(B),d.noHover||e.get(o.K.SHOW_BUBBLE))return!0;O&&(O=0),O=setTimeout(function(){if(O){A.css({"right":"70px","opacity":0}),A.show();var a=p.width();n(A,{"right":a,"opacity":1},.3,"easeOut",function(){}).run()}},200)}}).on("mouseleave",function(){if(p.removeClass(B),d.noHover||e.get(o.K.SHOW_BUBBLE))return!0;O&&(O=0),n(A,{"right":"70px","opacity":0},.3,"easeIn",function(){A.hide()}).run()}).on("click",function(){function i(i){if(!d.noLogin&&!r.isLogin||i)return void e.fire(o.E.LOGIN);if(!d.noExpand){if(n&&n.disableExpand&&n.disableExpand())return void(o.S.MINI===t.get(o.K.STATUS)&&t.fire(o.E.STATUS_CHANGE,{"status":o.S.STANDARD}));p.fire("mouseout"),t.get(o.K.ROOT).width(u.width()+35),m.log(e.get(o.K.EXPAND));var s="";a.UA.firefox&&a.UA.firefox>0&&(s=a.one("#J_MUIMallbar").one("#J_MBarMiniCart")),e.get(o.K.EXPAND)?(s&&s.hide(),t.fire(o.E.STATUS_CHANGE,{"status":o.S.STANDARD})):(s&&s.show(),a.each(l,function(a){a.fire(o.E.VISIBILITY_CHANGE,{"visible":!1})}),e.fire(o.E.VISIBILITY_CHANGE,{"visible":!0}),t.fire(o.E.STATUS_CHANGE,{"status":o.S.EXPAND}),e.fire(o.E.BUBBLE_CHANGE,{"show":!1}),m.sendLog(d.arr))}}var n=e.get(o.K.POBJ);n&&n.needLogin?n.needLogin(i):i(!1)}),e.on(o.E.VISIBILITY_CHANGE,function(i){var r=e.get(o.K.EXPAND);u.css("zIndex",o.ZINDEX-2),p.removeClass(B);var l=p.one(".mui-mbar-tab-logo-arr")||"";if(l&&l.hasClass("mui-mbar-tab-logo-arr-show")&&l.hide(),i.visible){h.addClass(I),p.addClass(v),d.custom&&p.css("backgroundImage","none");var m=a.one("#J_MUIMallbar").one(".tm-mcHandler");!!m&&m.css("position","relative");var l=p.one(".mui-mbar-tab-logo-arr")||"";if(l&&l.hasClass("mui-mbar-tab-logo-arr-show")&&l.show(),!r){var s=t.get(o.K.OLD_INDEX);u.removeClass(o.C.SCALE_DOWN),u.css("top",0),u.css("zIndex",o.ZINDEX),u.css("visibility","visible");var b=e.get(o.K.INDEX);o.S.EXPAND===t.get(o.K.STATUS)&&-1!==s&&b!==s?(u.css("top",u.height()+"px"),n(u,{"top":"0"},.4,"easeOut").run()):a.each(t.get(o.K.ITEMS),function(a){var e=a.get(o.K.PLUGIN);e!==u&&e.css("visibility","hidden")})}!!m&&m.css("position","fixed")}else if(h.removeClass(I),p.removeClass(v),r){var s=e.get(o.K.INDEX);t.set(o.K.OLD_INDEX,s),u.css("zIndex",o.ZINDEX-1),o.S.EXPAND===t.get(o.K.STATUS)&&u.addClass(o.C.SCALE_DOWN)}e.set(o.K.EXPAND,i.visible)}),e.on(o.E.AFTER_EXPAND_CHANGE,function(a){var t=e.get(o.K.POBJ),i=a.newVal,n=e.get(o.K.PG_FISRT_VISIBLE);t&&t.fire(o.E.VISIBILITY_CHANGE,{"visible":i,"first":n}),n&&i&&e.set(o.K.PG_FISRT_VISIBLE,!1)}),e.on(o.E.SUPTIP_CHANGE,function(i){if(e.set(o.K.SHOW_SUPTIP,i.show),i.show){var n=1;n=a.isNumber(i.num)?i.num:e.get(o.K.SUPTIP_NUM)+1,e.set(o.K.SUPTIP_NUM,n),i.isCartNum?(n=Math.max(0,Math.min(999,n)),n>=100?E.parent().addClass("hundreds"):E.parent().removeClass("hundreds")):n>99&&(n="99"),E.html(m.fm(c,n)),E.show()}else e.set(o.K.SUPTIP_NUM,0),E.hide();var r=e.get(o.K.POBJ);r&&i.show&&r.fire(o.E.DATA_CHANGE),t.fire(o.E.SUPTIP_CHANGE)}),e.on(o.E.BUBBLE_CHANGE,function(i){function r(){var r=e.get(o.K.BUBBLE),c=r.one(".mui-mbar-tab-bubble-bd");if(C&&(clearTimeout(C),C=0),e.set(o.K.SHOW_BUBBLE,l),i.bubbleType&&e.set(o.K.BUBBLE_TYPE,i.bubbleType),l){var f=t.get(o.K.ITEMS);f&&a.each(f,function(a){var e=a.get(o.K.BUBBLE);!!e&&e.hide()});var T=t.get(o.K.STATUS);o.S.MINI===T&&t.fire(o.E.STATUS_CHANGE,{"status":o.S.STANDARD,"noToClose":!0}),o.B.FOREVER===i.bubbleType?s.set({"k":o.K.FRM_STATUS,"v":o.S.STANDARD}):C=setTimeout(function(){m.log("tmBubbleHide timeout"),e.fire(o.E.BUBBLE_CHANGE,{"show":!1,"timeout":!0,"cb":function(){i.dismiss&&i.dismiss(),s.get({"k":o.K.FRM_STATUS,"success":function(a){o.S.MINI===a&&t.fire(o.E.STATUS_CHANGE,{"status":o.S.MINI})}})}})},i.hideDelay||o.BUBBLE_HIDE_DELAY);var E=['<div class="mui-mbar-bubble mui-mbar-bubble-flexible">','<p class="mui-mbar-bubble-flexible-title">{0}</p>','<div class="mui-mbar-arr mui-mbar-bubble-flexible-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-prof-login-close"></div>','<div class="mui-mbar-bubble-flexible-bd">{1}</div>',"</div>"].join("");if(u||d?u&&!d&&(d=3):d=1,1==d)var A=m.fm(b,i.html);else if(2==d){var A=m.fm(E,i.contentTitle||"",i.html);i.height=i.height+40||"200px"}else if(3==d)var A=i.html;c.html(A);var h=c.one(".mui-mbar-bubble-close"),B=c.one(".mui-mbar-bubble");h&&h.on("click",function(a){i.colsedClicked&&i.colsedClicked(),a.stopPropagation(),e.fire(o.E.BUBBLE_CHANGE,{"show":!1})}),B&&i.height&&B.css("height",i.height),r.show(),n(r,{"opacity":1},.3,o.EASE,function(){i.cb&&i.cb()}).run(),r.detach("click");var v;r.on("click",function(e){if(i.isToForever&&C&&(clearTimeout(C),C=0),i.arrClicked&&m.sendLog(g+i.arrClicked),i.clicked&&i.clicked(),!_){var t=B.one("a");t?(v=t.attr("href"),a.isString(v)&&v.indexOf("//")>=0?(window.open(v),e.halt()):p.fire("click")):p.fire("click")}}),i.tabMouseleave&&(p.on("mouseleave",function(e){var t=a.one(e.toElement||e.relatedTarget);t&&(a.DOM.hasClass(t,"mui-mbar-tabs-shadow")||t.parent(".mui-mbar-tab-bubble")||(r.detach("click"),r.hide()))}),r.on("mouseleave",function(a){n(r,{"opacity":0},.1,o.EASE,function(){r.hide()}).run()})),e.resetBubble(),i.arrShowed&&m.sendLog(g+i.arrShowed),i.showed&&i.showed(r)}else n(r,{"opacity":0},.1,o.EASE,function(){r.hide(),i.cb&&i.cb()}).run()}var l=!!i.show,c=i.showDelay||1e3,d=i.customContentType?i.customContentType:"",u=!!i.isCustomContent,_=!!i.isNotTabFire,g="//gm.mmstat.com/";l!==e.set(o.K.SHOW_BUBBLE)&&(l&&o.S.EXPAND===t.get(o.K.STATUS)||m.getStaticConf({"cb":function(a){var e="";if(!!window.g_config&&(e=window.g_config.shopId||""),a.bubbleBlacklist&&a.bubbleBlacklist.length)for(var t=a.bubbleBlacklist.length,i=a.bubbleBlacklist,n=0;n<t;n++)if(e==i[n])return;l?setTimeout(r,c):r()}}))}),e.on(o.E.MALLBAR_STATUS_CHANGE,function(a){var t=a.status;o.B.FOREVER!==e.get(o.K.BUBBLE_TYPE)&&e.get(o.K.SHOW_BUBBLE)&&o.S.STANDARD!==t&&e.fire(o.E.BUBBLE_CHANGE,{"show":!1}),o.S.EXPAND!==t&&o.S.SCREEN!==t||e.get(o.K.EXPAND)?T.show():T.hide()}),e.on(o.E.ERROR,function(a){var e="\u554a\u54e6\uff0c\u597d\u50cf\u6709\u70b9\u95ee\u9898";a&&a.tip&&(e=a.tip),_.html('<div class="mui-mbar-plugin-err">'+e+"</div>")}),e.on(o.E.LOGIN,function(a){t.get(o.K.ITEMS)[o.P.PROF].get(o.K.POBJ).fire(o.E.PROF_CHANGE,{"toLogin":1,"pid":d.id,"success":a.success})}),e.on(o.E.FLYIN_END,function(a){var t=e.get(o.K.POBJ);t&&t.fire(o.E.DATA_CHANGE)}),e.on(o.E.PAGE_VISIBILITY_CHANGE,function(a){var t=e.get(o.K.POBJ);t&&t.fire(a.type,{"pageVisible":a.pageVisible})}),d.m>0&&e.fire(o.E.SUPTIP_CHANGE,{"show":!0,"num":d.m})},"getUserInfo":function(){return this.get(o.K.MALLBAR).get(o.K.MODEL).get(o.K.USERINFO)},"setUserInfo":function(a){var e=this,t=e.get(o.K.MALLBAR).get(o.K.MODEL).get(o.K.USERINFO);t=m.deepMerge(t,a),s.set({"k":o.K.FRM_USERINFO,"v":""})},"getUid":function(){return this.get(o.K.MALLBAR).get(o.K.MODEL).getUid()},"expand":function(){var a=this,e=a.get(o.K.TAB);a.get(o.K.EXPAND)||e.fire("click")},"getShopConfig":function(){return this.get(o.K.MALLBAR).get(o.K.SHOP_CONFIG)},"getGConfig":function(){return this.get(o.K.MALLBAR).get(o.K.G_CONFIG)},"resetBubble":function(){var a=this,e=a.get(o.K.TAB);a.get(o.K.BUBBLE).offset({"top":e.offset().top})},"getOrigin":function(){var e,t=this,i=t.get(o.K.MALLBAR),n=i.get(o.K.STATUS),r=i.get(o.K.ROOT),l=t.get(o.K.TAB),m=l.offset();return e=n==o.S.EXPAND?a.DOM.viewportWidth()-r.width():a.DOM.viewportWidth()-l.width(),{"x":e,"y":m.top-a.one(window).scrollTop()}},"getPoint":function(){var a=this,e=a.get(o.K.MALLBAR),t=a.get(o.K.TAB),i=a.getOrigin(),n={"x":t.width()/2+i.x,"y":t.width()/2+i.y};return o.S.MINI===e.get(o.K.STATUS)&&e.fire(o.E.STATUS_CHANGE,{"status":o.S.STANDARD}),n},"getServerTime":function(){return this.get(o.K.MALLBAR).get(o.K.MODEL).getServerTime()},"dialog":function(e){function t(a){r.remove(),e.callback&&e.callback(a)}var i=this,n=i.get(o.K.PLUGIN);n.append(a.all(d.render(e)));var r=n.one(".mui-mbar-dialog"),l=r.one(".mui-mbar-dialog-bd"),s=r.one(".mui-mbar-dialog-yes"),b=r.one(".mui-mbar-dialog-no");r.show(),r.width(n.width()),r.height(n.height()),l.css("top",(n.height()-l.height())/2+"px"),m.log(n.width(),n.height(),r.width(),r.height()),s.on("click",function(){t(!0)}),b&&b.on("click",function(){t(!1)})},"alert":function(a){var e=this;a.dialogType=1,e.dialog(a)},"confirm":function(a){var e=this;a.dialogType=2,e.dialog(a)},"getTabName":function(){var a=this,e=a.get(o.K.MALLBAR),t=e.get(o.K.MODEL),i=a.get(o.K.INDEX),n=t.get(o.K.BAR),r="";return!!n&&n.l&&(r=n.l[i].id),r}}),u},{"requires":["base","event","node","anim","xtemplate","mui/minilogin/index","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store"]});KISSY.add("mui/mallbar/mallbar-guide",function(a,t,e,i){var r,l,n=!1,o=function(t){var e=this;e.config=a.merge(o.config,t),e._init()};return o.config={"picBox":[{"src":"//gtd.alicdn.com/tps/i1/T11E.AFzxXXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i2/T15b3zFuVaXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T1mZonFvVeXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i4/T1zygsFp0dXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i1/T1Hf3tFzpcXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i2/T1zKAnFqJeXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i2/T1AvIuFuhcXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T1pHUAFDFXXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i4/T1tR3sFCNcXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i1/T1sKsrFx4dXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i2/T1z7crFw8dXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T1A0ZAFDBXXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i4/T1SpMBFABXXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i1/T1jrUAFEXXXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i2/T1NEUrFqXdXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T1WvIAFC4XXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i4/T1x5ZtFwRcXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i1/T17tsAFEdXXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T15cBaFTRXXXbw.PjB-284-35.png"}],"picBoxIE":[{"src":"//gtd.alicdn.com/tps/i1/T11E.AFzxXXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i2/T15b3zFuVaXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T1mZonFvVeXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i4/T1zygsFp0dXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i1/T1Hf3tFzpcXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i2/T1zKAnFqJeXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T15cBaFTRXXXbw.PjB-284-35.png"},{"src":"//gtd.alicdn.com/tps/i2/T1XTktFzlcXXa.AtHl-250-300.png"},{"src":"//gtd.alicdn.com/tps/i3/T1hHwvFrVcXXa.AtHl-250-300.png"}],"AnimateTimeLine":[{"lineName":"line-bent","startLine":{"X":"127","Y":"229","Cx1":"127","Cy1":"229","Cx2":"127","Cy2":"229","X2":"127","Y2":"229"},"animateTime":"0.5"},{"lineName":"line-stretch","startLine":{"X":"83","Y":"593","Cx1":"265","Cy1":"584","Cx2":"104","Cy2":"274","X2":"127","Y2":"229","X3":"67","Y3":"251"},"animateTime":"0.5"},{"lineName":"shake","startLine":{"X":"83","Y":"593","Cx1":"83","Cy1":"593","Cx2":"125","Cy2":"229","X2":"124","Y2":"232","X3":"251","Y3":"121"},"animateTime":"0.03"},{"lineName":"up-vertical","startLine":{"X":"83","Y":"593","Cx1":"83","Cy1":"593","Cx2":"125","Cy2":"229","X2":"124","Y2":"232","X3":"100","Y3":"121","M":"1.5"},"animateTime":"0.01"},{"lineName":"throw-out","startLine":{"X":"67","Y":"320","Cx1":"180","Cy1":"100","Cx2":"398","Cy2":"80","X2":"157","Y2":"113","M":"90","X5":"50"},"endLine":{"X":"432","Y":"69","Cx1":"300","Cy1":"100","Cx2":"500","Cy2":"180","X2":"324","Y2":"24","M":"120","X5":"110"},"animateTime":"1"}],"isMask":!1,"callback":!1},o.prototype={"_init":function(){var e=this;!(a.UA.ie<=8)?e._imagesLoad(e.config.picBox,function(){var i;i=e.config.isMask?'<div class="mui-mbar-animate-mask-bg"></div>':"";var l=[i,'<canvas width="300" height="600" id="J_animate-canvas" class="mui-mbar-animate-canvas mui-mbar-guide"></canvas>'].join("");t(l).appendTo(a.one("body")),r=a.get(".mui-mbar-animate-canvas").getContext("2d"),r.webkitImageSmoothingEnabled=!0,a.getScript("//g.alicdn.com/tm/act/1.10.36/??mazi/ShoppingCartAnimate/TweenLite.js",function(){e._catAnimate()})}):e._imagesLoad(e.config.picBoxIE,function(){var t;t=e.config.isMask?'<div class="mui-mbar-animate-mask-bg"></div>':"";var r=[t,'<div class="mui-mbar-animate-box mui-mbar-guide">','<img class="mui-mbar-animate-cat" src="//img.alicdn.com/tps/i3/T1ouJHXndmXXXXXXXX-1-1.gif" width="250" height="300" alt=""/>','<div class="mui-mbar-animate-buy"><img  src="//gtd.alicdn.com/tps/i3/T15cBaFTRXXXbw.PjB-284-35.png" width="284" height="35"/></div>',"<div>"].join("");a.one("body").append(r);var l=i.viewportWidth(),n=i.viewportHeight();a.one(".mui-mbar-animate-mask-bg")&&a.one(".mui-mbar-animate-mask-bg").css({"width":l+"px","height":n+"px"}),e._catAnimateIE()})},"_catAnimate":function(){var a=this,t=0,e=setInterval(function(){t<6?(r.clearRect(0,0,300,600),r.beginPath(),r.drawImage(a.config.picBox[18].Dom,15,566,284,35),r.drawImage(a.config.picBox[t].Dom,50,0,250,300)):(setTimeout(function(){r.clearRect(0,0,300,600),r.beginPath(),r.drawImage(a.config.picBox[18].Dom,15,566,284,35),setTimeout(function(){a._catPole(t)},0)},500),clearInterval(e)),t++},150)},"_catPole":function(a){var t=this,e=setInterval(function(){a<11?(r.clearRect(0,0,300,600),r.beginPath(),r.drawImage(t.config.picBox[18].Dom,15,566,284,35),r.drawImage(t.config.picBox[a].Dom,50,0,250,300)):(clearInterval(e),t._pushLineAnimate()),a++},100)},"_pushLineAnimate":function(){var t,e,i,l,n,o=this,m=0;r.lineWidth=1,t=o.config.AnimateTimeLine[m].startLine,e=o.config.AnimateTimeLine[m+1].startLine,l=o.config.AnimateTimeLine[m].animateTime,TweenLite.to(t,l,a.merge(e,{"onUpdate":function(){r.clearRect(0,0,300,600),r.beginPath(),r.moveTo(t.X,t.Y),r.bezierCurveTo(t.Cx1,t.Cy1,t.Cx2,t.Cy2,t.X2,t.Y2),r.stroke(),r.drawImage(o.config.picBox[18].Dom,15,566,284,35),r.drawImage(o.config.picBox[11].Dom,50,0,250,300)},"onComplete":function(){i=o.config.AnimateTimeLine[m+2].startLine,n=m+1,o._lineStraightenAnimate(e,i,n)}}))},"_lineStraightenAnimate":function(t,e,i){var l=this,o=l.config.AnimateTimeLine[i].animateTime;TweenLite.to(t,o,a.merge(e,{"onUpdate":function(){r.clearRect(0,0,300,600),r.beginPath(),r.moveTo(t.X,t.Y),r.bezierCurveTo(t.Cx1,t.Cy1,t.Cx2,t.Cy2,t.X2,t.Y2),r.stroke(),r.drawImage(l.config.picBox[18].Dom,15,566,284,35),r.drawImage(l.config.picBox[12].Dom,50,0,250,300)},"onComplete":function(){var a=0;n=!1,i+=1;var t=setInterval(function(){if(++a>5&&1==n)clearInterval(t),setTimeout(function(){l._upAnimate(i)},300);else{var r=l.config.AnimateTimeLine[i+1].startLine;l._shakeAnimate(e,r,i)}},200)}}))},"_shakeAnimate":function(t,e,i){var l=this,o=l.config.AnimateTimeLine[i].animateTime;TweenLite.to(t,o,a.merge(e,{"onUpdate":function(){r.clearRect(0,0,300,600),r.beginPath(),r.moveTo(t.X,t.Y),r.bezierCurveTo(t.X,t.Y,t.X2,t.Y2,t.X2,t.Y2),r.stroke(),r.drawImage(l.config.picBox[14].Dom,50,0,250,300),r.save(),r.rotate(1.5*Math.PI/180),r.drawImage(l.config.picBox[18].Dom,30,559,284,35),r.restore()},"onComplete":function(){TweenLite.to(e,o,a.merge(t,{"onUpdate":function(){r.clearRect(0,0,300,600),r.beginPath(),r.moveTo(t.X,t.Y),r.bezierCurveTo(t.X,t.Y,t.X2,t.Y2,t.X2,t.Y2),r.stroke(),r.drawImage(l.config.picBox[12].Dom,50,0,250,300),r.save(),r.rotate(Math.PI/180),r.drawImage(l.config.picBox[18].Dom,24,562,284,35),r.restore()},"onComplete":function(){n=!0}}))}}))},"_upAnimate":function(t){var e=this,i=e.config.AnimateTimeLine[t+1].startLine,l=e.config.AnimateTimeLine[t+2].startLine,n=e.config.AnimateTimeLine[t+1].animateTime;TweenLite.to(i,n,a.merge(l,{"onUpdate":function(){r.clearRect(0,0,300,600),r.beginPath(),r.moveTo(i.X,i.Y),r.bezierCurveTo(i.Cx1,i.Cy1,i.Cx2,i.Cy2,157,113),r.stroke(),r.drawImage(e.config.picBox[15].Dom,50,0,250,300),r.save(),r.translate(i.X,i.Y),r.rotate(i.M*Math.PI/180),r.drawImage(e.config.picBox[18].Dom,-81,0,284,35),r.restore()},"onComplete":function(){t+=2,e._throwAnimate(t)}}))},"_throwAnimate":function(t){var e=this,l=e.config.AnimateTimeLine[t].startLine,n=e.config.AnimateTimeLine[t].endLine,o=e.config.AnimateTimeLine[t].animateTime;TweenLite.to(l,o,a.merge(n,{"onUpdate":function(){r.clearRect(0,0,300,600),r.beginPath(),r.moveTo(l.X,l.Y),r.bezierCurveTo(l.Cx1,l.Cy1,l.Cx2,l.Cy2,324,24),r.stroke(),l.X5>90?r.drawImage(e.config.picBox[16].Dom,l.X5,0,250,300):r.drawImage(e.config.picBox[17].Dom,l.X5,0,250,300),r.save(),r.translate(l.X,l.Y),r.rotate(l.M*Math.PI/180),r.drawImage(e.config.picBox[18].Dom,-81,0,284,35),r.restore()},"onComplete":function(){r.clearRect(0,0,300,600),i.remove(".mui-mbar-animate-mask-bg"),i.remove(".mui-mbar-animate-canvas"),a.isFunction(e.config.callback)&&e.config.callback()}}))},"_catAnimateIE":function(){var t=this,e=0;l=a.one(".mui-mbar-animate-cat");var i=setInterval(function(){e<6?l.attr("src",t.config.picBox[e].src):(setTimeout(function(){t._buyAnimateIE()},500),clearInterval(i)),e++},150)},"_buyAnimateIE":function(){var t=this,e=a.one(".mui-mbar-animate-buy");l.attr("src",t.config.picBoxIE[8].src),e.stop().animate({"width":"34px","height":"34px","right":"100px"},.5,"elasticBoth",function(){l.attr("src",t.config.picBoxIE[7].src),e.stop().animate({"bottom":"334px","right":"110px"},1,"elasticIn",function(){l.attr("src",t.config.picBoxIE[8].src),setTimeout(function(){var i=setInterval(function(){if(parseInt(e.css("right"))>-250){var r=10;e.css("right",parseInt(e.css("right"))-r),l.css("right",parseInt(l.css("right"))-r)}else clearInterval(i),a.one(".mui-mbar-animate-mask-bg")&&a.one(".mui-mbar-animate-mask-bg").remove(),a.one(".mui-mbar-animate-box")&&a.one(".mui-mbar-animate-box").remove(),a.isFunction(t.config.callback)&&t.config.callback()},10)},500)})})},"_imagesLoad":function(a,t,e){var i=this;e=e||0,a[e]?i._imgLoad(a[e],function(){i._imagesLoad(a,t,e+1)}):t(e)},"_imgLoad":function(a,t){var e=new Image;if(e.src=a,e.complete)return a.Dom=e,void t();e.onload=function(){a.Dom=e,t()},e.src=a.src}},window.catAnimate=o,o},{"requires":["node","event","dom","mui/mallbar/mallbar-guide.css"]});KISSY.add("mui/mallbar/plugin-prof",function(a,e,i,t,o,n,s,r,m,l,c,u){function b(a,e,i){var t=i.split("@");k[t[1]][t[0]](a,e,i)}function d(){var a=y.parent(),e=a.outerWidth(),i=a.scrollTop();y.css({"width":e,"height":i+a.outerHeight(),"visibility":"visible"}),M.css({"left":(e-M.outerWidth())/2,"top":i+4*(t.viewportHeight()-M.outerHeight())/9})}function p(e){s({"url":Z+"/api/tmallEquityCoupon.do","dataType":"jsonp","data":a.merge({"_tb_token_":H,"isQuery":e.isQuery},q[e.id]),"complete":function(a){a=a||{};var i=a.status;if(200===i||612===i)e.success(a.data);else{if(401===i)return D.tryLogin();f(i)}},"timeout":5})}function f(a,e){var i="",t='<button data-action="closePopup@member">\u786e\u5b9a</button>';601===a?(i="\u5bf9\u4e0d\u8d77\uff0c\u60a8\u7684\u79ef\u5206\u4e0d\u591f\u5151\u6362\u6b64\u4f18\u60e0\u5238\uff0c\u9a6c\u4e0a\u53bb\u8d5a\u79ef\u5206\u5427\uff01",t='<button data-action="openVip@member">\u53bb\u8d5a\u79ef\u5206</button><button class="mui-mbarp-prof-minor" data-action="closePopup@member">\u518d\u901b\u4e00\u4e0b</button>'):610===a?(l.sendLog(m.ARR.PROF_VIP_ACTIVATE_BUTTON),i="\u55b5~ \u60a8\u5f53\u524d\u4e0d\u662f\u5929\u732b\u4f1a\u5458\uff0c\u8bf7\u5148\u6fc0\u6d3b\u518d\u8fdb\u884c\u5151\u6362",t='<button data="activateMember">\u7acb\u5373\u6fc0\u6d3b</button>'):611===a?i="\u5bf9\u4e0d\u8d77\uff0c\u60a8\u672a\u8fbe\u5230\u4e13\u4eab\u4eba\u7fa4\u6761\u4ef6\uff0c\u6682\u65f6\u65e0\u6cd5\u9886\u53d6\u5594T_T":621===a?i="\u55b5~ \u521a\u6709\u4eba\u5148\u60a8\u4e00\u6b65\uff0c\u62a2\u8d70\u6700\u540e\u4e00\u5f20\u4f18\u60e0\u5238\uff01":622===a?i="\u55b5~ \u8fd9\u5f20\u4f18\u60e0\u5238\u4e0d\u5b58\u5728\uff0c\u65e0\u6cd5\u9886\u53d6\u5594T_T":623===a?i="\u55b5~ \u8fd9\u5f20\u4f18\u60e0\u5238\u5df2\u7ecf\u88ab\u9886\u5149\u4e86\uff0c\u8bf7\u518d\u901b\u901b\u5427\uff01":624===a?i="\u60a8\u5728\u8be5\u5e97\u94fa\u9886\u7528\u5f20\u6570\u5df2\u8fbe\u5230\u4e0a\u9650\u54e6\uff0c\u4e0b\u6b21\u518d\u6765\u9886\u5427\uff01":500===a?(i="\u9886\u53d6\u4f18\u60e0\u5377\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01",e&&(i=e)):i="\u55b5~ \u5c0f\u732b\u5fd9\u4e0d\u8fc7\u6765\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01",D.showPopup({"body":i,"action":t})}function g(a){var e=a.sellerBaseInfoVO,i="",t="\u5151\u6362",o=e.couponPoint,n=e.couponValue;i+='<p><img src="'+D.formatImg(a.brandLogo,"_90x90.jpg")+'" width="90" height="45" /></p>',e.needFav?(i+="<p>\u60a8\u9700\u8981\u5173\u6ce8<strong>"+e.brandName+"</strong></p>",i+="<p>\u5e76\u4f7f\u7528"+o+"\u79ef\u5206\u5151\u6362"+n+"\u5143\u7684\u4f18\u60e0\u5238</p>",i+="<p>\u786e\u8ba4\u5151\u6362?</p>",t="\u5173\u6ce8\u5e76\u5151\u6362"):i+="<p>\u60a8\u5c06\u4f7f\u7528"+o+"\u79ef\u5206\u5151\u6362"+n+"\u5143\u7684\u4f18\u60e0\u5238\uff0c\u786e\u8ba4\u5151\u6362?</p>",D.showPopup({"body":i,"action":'<button data-fav="'+e.needFav+'" data-id="'+a.spreadId+'" data-action="finishCollectCoupon@member">'+t+'</button><button class="mui-mbarp-prof-cancel" data-action="closePopup@member">\u53d6\u6d88</button>'})}function d(){var a=y.parent(),e=a.outerWidth(),i=a.scrollTop();y.css({"width":e,"height":i+a.outerHeight(),"visibility":"visible"}),M.css({"left":(e-M.outerWidth())/2,"top":i+4*(t.viewportHeight()-M.outerHeight())/9})}function h(){U=!1,M.css("visibility","hidden"),y.css("visibility","hidden")}function v(a,e){var i='<div class="mui-mbarp-prof-user-new"><div class="mui-mbarp-avatar"><img src="'+a.avatar+'" width="56" height="56" /><a href="//i.taobao.com/user/baseInfoSet.htm?scm=1048.1.2.32" target="_blank">\u7f16\u8f91</a></div>';i+='<div class="mui-mbarp-meta">',i+='<p class="mui-mbarp-nick"><a href="//vip.tmall.com?scm=1048.1.2.31" target="_blank">Hi, '+a.nick+"</a></p>";var t="",o="",n="";switch(e.tag){case"10":t="\u6211\u662f",o='<span class="mui-mbarp-level-name">\u8d85\u7ea7\u4f1a\u5458</span>',n="mui-mbarp-level-crown-super";break;case"20":t="\u6211\u662f",o='<span class="mui-mbarp-level-name">APASS\u4f1a\u5458</span>',n="mui-mbarp-level-crown-apass";break;default:t="\u6b22\u8fce\u6765\u5230\u5929\u732b!"}return e.tag?(i+='<p class="mui-mbarp-level">'+t+o+"</p>",i+='<span class="mui-mbarp-prof-badge"><i class="mui-mbarp-level-crown '+n+'"></i></span>'):(l.sendLog(m.ARR.PROF_VIP_ACTIVATE_BUTTON),i+='<p class="mui-mbarp-level"><span class="active-member" data-action="activateMember@member">\u6fc0\u6d3b\u6210\u4e3a\u5929\u732b\u4f1a\u5458</span></p>'),i+="</div>",i+="</div>",i+='<img class="mui-mbarp-prof-privilege-img" width="225" data-cross="privilege" src="//img.alicdn.com/tfs/TB10yVqRXXXXXa4XVXXXXXXXXXX-450-286.jpg"/>'}function _(e){var i='<div class="mui-mbarp-prof-user"><div class="mui-mbarp-avatar"><img src="'+e.avatar+'" width="80" height="80" /><a href="//i.taobao.com/user/baseInfoSet.htm?scm=1048.1.2.32" target="_blank">\u7f16\u8f91</a></div>';i+='<div class="mui-mbarp-meta">',i+='<p class="mui-mbarp-nick"><a href="//vip.tmall.com?scm=1048.1.2.31" target="_blank">Hi, '+e.nick+"</a></p>";var t=e.level;t?(i+='<p class="mui-mbarp-level">\u60a8\u662f<strong>'+t+"</strong>\u5929\u732b\u4f1a\u5458</p>",i+='<span class="mui-mbarp-prof-badge">'+t+"</span>"):(l.sendLog(m.ARR.PROF_VIP_ACTIVATE_BUTTON),i+='<p class="mui-mbarp-level"><span data-action="activateMember@member">\u6fc0\u6d3b\u6210\u4e3a\u5929\u732b\u4f1a\u5458</span></p>',i+='<span class="mui-mbarp-prof-badge" style="font-size:16px">?</span>'),i+="</div>",i+="</div>";var o=e.privileges||[];o.length;i+='<div class="mui-mbarp-prof-privilege">',i+='<div class="mui-mbarp-prof-list-title"><i class="border-left"></i>\u4f1a\u5458\u6743\u76ca<i class="border-right"></i></div>',i+='<div class="mui-mbarp-prof-list">';var n=["brand","ftry"];return a.each(o,function(a){var e=a.name;n.indexOf(e)>-1||(i+='<div class="mui-mbarp-prof-item'+(a.enable?" mui-mbarp-prof-item-enable":"")+'">',i+='<div class="mui-mbarp-prof-symbol">&#xe'+G[e]+";</div>",i+='<div class="mui-mbarp-prof-title" title="'+a.title+'">'+a.title+"</div>",i+="</div>")}),i+="</div>",i+="</div>"}function A(a,e){var i="";return D.loopList(a,V,function(a){var e="",t=a.face;50<=t&&t<100?e="mui-mbarp-prof-item-yellow":t>=100&&(e="mui-mbarp-prof-item-red");var o=a.spreadId;q[o]={"id":o,"sellerId":a.sellerId,"brandId":a.brandId,"point":a.point,"level":a.level,"startTime":R(a.from),"endTime":R(a.to)},i+='<div id="J_ProfCoupon_'+o+'" class="mui-mbarp-prof-item '+e+'">',i+='<div class="mui-mbarp-prof-pbt"></div>',i+='<div class="mui-mbarp-prof-inner">',i+='<div class="mui-mbarp-prof-phead">',i+='<div class="mui-mbarp-prof-pleft">',i+='<p class="mui-mbarp-prof-shop"><a href="'+a.shopUrl+'" title="'+a.shopName+'" target="_blank">'+a.shopName+"</a></p>",i+='<p class="mui-mbarp-prof-price"><span class="mui-mbarp-prof-rmb">&yen;</span><strong>'+D.formatPrice(a.face,!0)+"</strong></p>",i+="</div>",i+='<div class="mui-mbarp-prof-pright">',i+="<p>\u6709\u6548\u671f</p>";var n=S(a.from,a.to);i+="<p>"+n.from+"</p>",i+="<p>"+n.to+"</p>",i+="</div>",i+="</div>",i+='<a data-action="collectCoupon2@member" data-id="'+o+'" data-brandlogo="'+a.brandLogo+'" data-url="'+a.couponUrl+'" class="mui-mbarp-prof-paction">',a.fulfill?i+="\u6ee1"+D.formatPrice(a.fulfill,!0)+"\u5143\u4f7f\u7528":i+="\u65e0\u4f7f\u7528\u95e8\u69db",i+=" ",a.point?i+=a.point+"\u79ef\u5206\u9886\u53d6":i+="\u514d\u8d39\u9886\u53d6",i+="</a>",i+="</div>",i+='<div class="mui-mbarp-prof-pbb"></div>',i+="</div>"}),e?i:E("coupon",i,{"isShowRenewal":a.length>V})}function I(a,e){var i="";return D.loopList(a,j,function(a){i+='<a data-action="clickFilter@member" class="mui-mbarp-prof-item" title="'+a.title+'" href="'+a.itemUrl+'" target="_blank">',i+='<div class="mui-mbarp-prof-img"><img src="'+D.formatImg(a.pic,"_60x60.jpg")+'" width="60" height="60" /></div>',i+='<div class="mui-mbarp-prof-meta">',i+='<p class="mui-mbarp-prof-title" title="'+a.title+'">'+a.title+"</p>",i+='<p class="mui-mbarp-prof-macket-price"><span class="mui-mbarp-prof-rmb">&yen;</span>'+D.formatPrice(a.origin)+"</p>",a.price?i+='<p class="mui-mbarp-prof-price">\u4e13\u4eab\u4ef7<span class="mui-mbarp-prof-rmb">&yen;</span>'+D.formatPrice(a.price)+"</p>":i+='<p class="mui-mbarp-prof-price">\u70b9\u51fb\u67e5\u770b\u4e13\u5c5e\u4ef7</p>',i+="</div>",i+="</a>"}),e?i:E("item",i,{"isShowRenewal":a.length>j})}function C(a,e){var i="";return D.loopList(a,X,function(a){i+='<a data-action="clickFilter@member" class="mui-mbarp-prof-item" title="'+a.title+'" href="'+a.url+'" target="_blank">',i+='<div class="mui-mbarp-prof-img"><p class="mui-mbarp-prof-title" title="'+a.title+'">'+a.title+'</p><img src="'+D.formatImg(a.pic,"_400x400q75.jpg")+'" width="200" height="200" /></div>',i+="</a>"}),e?i:E("act",i,{"isShowRenewal":a.length>X})}function T(a,e){var i="";return D.loopList(a,Y,function(a){i+='<a data-action="clickFilter@member" title="'+a.brandName+'" class="mui-mbarp-prof-item" href="'+a.url+'" target="_blank">',i+='<div class="mui-mbarp-prof-img"><img src="'+D.formatImg(a.pic,"_90x90.jpg")+'" width="90" height="45"/></div>';var e=a.delivery;i+='<div class="mui-mbarp-prof-desc">\u6b63\u5728'+("\u4f18\u60e0\u5238"===e?"\u53d1\u653e":"\u8fdb\u884c")+":<strong>"+a.target+"\u4e13\u4eab</strong><span>"+e+"</span></div>",i+="</a>"}),e?i:E("brand",i,{"isShowRenewal":a.length>Y,"forceSpace":!0})}function E(a,e,i){if(!e)return i.forceSpace?'<div class="mui-mbarp-prof-space"></div>':"";i=i||{};var t='<div class="mui-mbarp-prof-block mui-mbarp-prof-member-'+a+'" data-name="'+a+'"><div class="mui-mbarp-prof-header">';return i.isShowRenewal&&(t+='<span class="mui-mbarp-prof-renewal" data-action="renewal@member">\u6362\u4e00\u6279</span>'),z.empty?t+='<span class="mui-mbarp-prof-block-title" data-name="'+a+'">'+Q[a].def+"</span>":t+=L(a,z.level),t+='</div><div class="mui-mbarp-prof-list">'+e+"</div></div>"}function B(a){var e=z.level;a.parent("div.mui-mbar-plugin-prof").all("span.mui-mbarp-prof-user-level").html(e),a.all("span.mui-mbarp-prof-block-title").each(function(a){a.html(L(a.attr("data-name"),e))})}function L(a,e){return Q[a].member}function R(a){var e=new Date(a-0);return[e.getFullYear(),"/",e.getMonth()+1,"/",e.getDate()," ",e.getHours(),":",e.getMinutes(),":",e.getSeconds()].join("")}function S(a,e){a=new Date(a-0),e=new Date(e-0);var i=a.getFullYear()-2e3,t=O(a.getMonth()+1),o=O(a.getDate()),n=a.getHours(),s=a.getMinutes(),r=a.getSeconds(),m=e.getFullYear()-2e3,l=O(e.getMonth()+1),c=O(e.getDate()),u=e.getHours(),b=e.getMinutes(),d=e.getSeconds(),p=i+"."+t+"."+o,f=m+"."+l+"."+c;return 0===n+s+r&&23===u&&59===b&&59===d?{"from":p,"to":f}:{"from":p+" "+O(n)+":"+O(s),"to":f+" "+O(u)+":"+O(b)}}function O(a){return(a<10?"0":"")+a}function w(){try{TB.Global.updateLoginInfo()}catch(a){}}function N(a){var e=a.mod;return'<div class="mui-mbarp-prof-item mui-mbarp-prof-tab-'+e+'" data-mod="'+e+'">'+a.title.replace("{level}",'<span class="mui-mbarp-prof-user-level"></span>')+"</div>"}var M,y,U;r.show||(r=new r);var P={"baby":{"title":"\u6bcd\u5a74\u7279\u6743","mod":"muying"}},k={},D={"tryLogin":function(){var a=this.mallbar;a.collapse(1),r.show(function(){W=!0,a.expand({"type":"prof"})},{"needRedirect":!1,"check":!1})},"activateMember":function(){a.use("mui/tobetmaller/index",function(a,e){var i=D.mallbar;i.collapse(1),e.config({"success":function(){l.sendLog(m.ARR.PROF_VIP_ACTIVATE_SUCCESS),W=!0,w(),i.expand({"type":"prof"})}}),l.sendLog(m.ARR.PROF_VIP_ACTIVATE_SHOW),e.show()})},"mustActivate":function(a){return!this.isMember&&(a.preventDefault(),l.sendLog(m.ARR.PROF_VIP_ACTIVATE_BUTTON),this.showPopup({"body":"\u60a8\u8fd8\u4e0d\u662f\u5929\u732b\u4f1a\u5458\uff0c\u6682\u65f6\u65e0\u6cd5\u4eab\u53d7\u6b64\u7279\u6743","action":'<button data-action="activateMember@member">\u7acb\u5373\u6fc0\u6d3b</button><button class="mui-mbarp-prof-cancel" data-action="closePopup@member">\u53d6\u6d88</button>'}),!0)},"showPopup":function(e){var i='<div class="mui-mbarp-prof-body">';a.isString(e)?i+=e+"</div>":(i+=e.body+"</div>",i+='<div class="mui-mbarp-prof-action">'+e.action+"</div>"),M.html(i),M.css("visibility","visible"),U=!0,d()},"hidePopup":function(){U=!1,M.css("visibility","hidden"),y.css("visibility","hidden")},"loopList":function(e,i,t){var o=a.isArray(e)?e.length:0,n=function(a){return!a||a._looped},s=[],r=0;t=a.isFunction(t)?t:function(){};for(var m=0;m<o;m++){var l=e[m];if(!n(l)&&(t(l),s.push(l),l._looped=!0,++r>=i))return s}return o>i&&(r=i-r,a.each(e,function(a){a&&(r>0?(t(a),s.push(a),r--):a._looped=!1)})),s},"formatPrice":function(e,i){return a.isNumber(e)||(e-=0),i&&(e/=100),e.toFixed(2)},"formatImg":function(a,e){return a=a||"",e&&(a=a.replace(/_(\d+x\d+|sum|m|b|300|q\d+)(q\d+)?\.jpg$/,"")+e),a},"bindMagnify":function(e,i){e&&e.length&&(i=a.merge({"trigger":".mui-mbarp-prof-img","root":".mui-mbarp-prof-item","img":"img"},i),e.all(i.trigger).on("mouseenter",function(){var a=t.parent(this,i.root),e=t.get("div.mui-mbarp-prof-magnify",a);if(!e){var o=t.get(i.img,this).src;e=t.create('<div class="mui-mbarp-prof-magnify"></div>',{"html":'<img src="'+D.formatImg(o,"_210x210.jpg")+'" width="198" />'}),t.append(e,a)}t.addClass(a,"mui-mbarp-prof-magnify-open")}).on("mouseleave",function(){var a=t.parent(this,i.root);t.removeClass(a,"mui-mbarp-prof-magnify-open")}))},"replaceSCM":function(a,e){return-1===a.indexOf("?")?a+"?scm="+e:a.replace(/\bscm=[\d\.]+&?/i,"")+"&scm="+e}},x=new u(['<div class="mui-mbarp-prof-tip mui-mbarp-prof-tip-login"></div>','<a class="mui-mbarp-prof-login-close"></a>','<div class="mui-mbar-arr mui-mbarp-prof-arr mui-mbarp-prof-arr-login">\u25c6</div>'].join("")),K="mui-mbarp-prof-tip",F=160,H="";TB.Global.loginStatusReady(function(a){H=a.tbToken});var G={"birthday":"60c","returned":"60e","brand":"602","ftry":"600","fenqi":"606","speedReturned":"60a","wuyou":"604","firstSerive":"608"},j=2,X=2,V=2,Y=4,W=!0,z={"empty":!0},J={},q={},Q={"coupon":{"def":"\u4f18\u60e0\u5238","member":"\u4e13\u4eab\u4f18\u60e0\u5238"},"brand":{"def":"\u54c1\u724c\u7279\u6743","member":"\u4e13\u4eab\u54c1\u724c\u7279\u6743"},"item":{"def":"\u4f18\u60e0\u5546\u54c1","member":"\u4e13\u4eab\u4f18\u60e0\u5546\u54c1"},"act":{"def":"\u4f18\u60e0\u4f1a\u573a","member":"\u4e13\u4eab\u4f18\u60e0\u4f1a\u573a"}};a.config({"modules":{"mui/tobetmaller/index":{"requires":["mui/overlay/dialog"]}},"packages":{"mui/tobetmaller":{"debug":!0,"ignorePackageNameInUri":!0,"version":"3.0.5","path":"//g.alicdn.com/mui/tobetmaller/3.0.5/","group":"tm"}}});var Z="//equity."+(m.IS_DAILY?"daily.tmall.net":"vip.tmall.com"),$=function(a){var e=this;$.superclass.constructor.call(e,a),D.mallbar=e.get(m.K.MALLBAR_ITEM).get(m.K.MALLBAR),k.member=e,e.init()};return a.extend($,i,{"init":function(){function e(){if(p.isLogin){var e=n.getUid();if(e){var i=l.fm(m.AVATAR,e,F),t=new Image;t.onload=function(e){u.one(".mui-mbar-tab-logo-prof-def").hide(),a.one(l.fm('<div class="mui-mbar-tab-logo-prof-nick-bd"><img class="mui-mbar-tab-logo-prof-nick" src="{0}" /></div>',i)).insertBefore(f)},a.one(l.fm('<div class="mui-mbar-tab-logo-prof-def"></div>')).insertBefore(f),t.src=i}}}function i(){o.on(m.E.PROF_CHANGE,function(i){var u=c.one(".mui-mbar-tab-logo-"+i.pid),b=a.DOM.height(u),f=parseFloat(u.parent().offset().top-t.scrollTop())+b/3.8;if(a.DOM.viewportHeight()-f<452?(f=f-272+b+1,d.addClass("mui-mbarp-prof-bottom-arrow")):d.removeClass("mui-mbarp-prof-bottom-arrow"),u&&(d.css({"top":f}),m.P.CART===i.pid&&m.S.MINI===s.get(m.K.STATUS)?d.css({"left":-u.parent().width()+"px"}):d.css({"left":0})),i.toLogin||!p.isLogin){d.html(x.render());var g=d.one(".mui-mbarp-prof-login-close");d.one(".mui-mbarp-prof-tip").on("mouseleave",function(e){var i=a.one(e.toElement||e.relatedTarget);i&&(t.hasClass(i,"mui-mbar-tabs-shadow")||i.parent(".mui-mbarp-prof")||d.hide())}),g.on("click",function(a){d.hide()}),r.show(function(){d.hide(),TB.Global.loginStatusReady(function(a){TB.Global.memberInfoReady(function(a){l.log("minilogin memberInfoReady",a),p=l.deepMerge(p,a),p.isLogin=!0,n.setUserInfo(p),i.success&&i.success(),s.broadcast(m.E.LOGIN_SUCCESS),e(),m.P.PROF===i.pid&&o.fire(m.E.PROF_CHANGE,{"pid":m.P.PROF}),p.isLogin&&s.expand({"type":i.pid})})})},{"insert":"."+K,"needRedirect":!1,"check":!1}),l.sendLog(m.ARR.PROF_LOGIN),d.show()}else"none"===d.css("display")&&l.sendLog(m.ARR.PROF)})}var o=this,n=o.mallbarItem=o.get(m.K.MALLBAR_ITEM),s=n.get(m.K.MALLBAR),c=s.get(m.K.ROOT),u=n.get(m.K.TAB),d=a.all('<div class="mui-mbarp-prof"></div>').appendTo(c),p=n.getUserInfo();o.userInfo=p,this.prof=d,o.itemId=s.get("itemId")||"",o.sellerId=s.get("sellerId")||"",o.shopId=s.get("shopId")||"",o.bizId=s.get("bizId")||"";var f=u.one(".mui-mbar-tab-tip");e(),u.on("mouseleave",function(e){var i=a.one(e.toElement||e.relatedTarget);i&&(t.hasClass(i,"mui-mbar-tabs-shadow")||i.parent(".mui-mbarp-prof")||d.hide())}),i(),o.showBubble();var g=!0;o.on(m.E.VISIBILITY_CHANGE,function(a){a.visible&&g&&o.showContent(),a.visible||h()}),o.on(m.E.DATA_CHANGE,function(a){g=!0,W=!0,n.get(m.K.EXPAND)&&o.showContent()}),o.get(m.K.CONTAINER).on("click",function(a){for(var e=a.target;;){if(e===this)return;var i=t.attr(e,"data-cross");if(i&&"privilege"===i)return o.showPrivilegeCross(e);var n=t.attr(e,"data-action");if("^"===n)return;if(n)return b(e,a,n);if(!e||!e.parentNode)return;e=e.parentNode}})},"showPrivilegeCross":function(e){var i=this,t=a.Env.mods;if(window.feloader)window.location.href="//vip.tmall.com";else{if(!t["mui/mobilecross"]){var o="3.0.0";a.config({"modules":{"mui/mobilecross":{"path":"//g.alicdn.com/mui/mobilecross/"+o+"/mobilecross.js"},"mui/mobilecross/mobilecross.css":{"path":"//g.alicdn.com/mui/mobilecross/"+o+"/mobilecross.css"}}})}a.use("mui/mobilecross",function(a,t){!!t&&t.cross({"params":{"url":"//market.m.taobao.com/apps/market/m-vip/index.html?wh_weex=true"},"relEl":e,"resource":16,"text":"\u55b5~\u4e3b\u4eba\uff0c\u5feb\u6765\u4eab\u53d7\u4f60\u7684\u4f1a\u5458\u7279\u6743>>","type":"link","tips":"\u55b5~\u7a7f\u8d8a\u6210\u529f\uff01\u770b\u770b\u4f60\u7684\u624b\u673a\u6d88\u606f\uff0c\u53bb\u5929\u732bAPP\u4eab\u53d7\u7279\u6743\u5427\uff01","mmstat":"vip_ticket","token":i.userInfo.tbToken||"","success":function(){}})})}},"showBubble":function(){function e(a){c.get({"k":"mui/mbarp/prof/detailVipBubble/"+r.getUid()+"/"+s.shopId,"success":function(e){if(!e){var i={"nick":s.nick||"","specialClass":"mui-mbarp-prof-vip-bubble-detail","showTwo":!0,"discribe":"\u8be5\u5e97\u94fa\u6709\u65e0\u95e8\u69db\u4f18\u60e0</br>\u5238\u53ef\u9886\uff01","showArr":m.ARR.PROF_VIP_BUBBLE_DETAIL_SHOW,"clickArr":m.ARR.PROF_VIP_BUBBLE_DETAIL_CLICK};i.rmb='<p class="mui-mbarp-prof-vip-bubble-p3" ><span >\uffe5</span><span class="mui-mbarp-prof-vip-bubble-rmb">'+a.bm.n+"</span></p>",a.bm.s?i.action=a.bm.s+"\u79ef\u5206\u9886\u53d6":i.action="\u7acb\u5373\u9886\u53d6",i.clicked=function(){c.set({"k":"mui/mbarp/prof/detailVipBubble/"+r.getUid()+"/"+s.shopId,"v":1,"expires":1})},o(i)}}})}function i(e){var i={};c.get({"k":"mui/mbarp/prof/shopVipBubble/"+r.getUid()+"/"+s.shopId,"success":function(t){if(!t){var n=a.one("#shopExtra");!!n&&(e.bm.t=n.one(".slogo-shopname").one("strong").html()||""),e.bm.t&&(i={"nick":s.nick||"","specialClass":"mui-mbarp-prof-vip-bubble-shop","discribe":'<span title="'+e.bm.t+'">'+l.sub(e.bm.t,18)+"</span></br> \u4e3a\u60a8\u51c6\u5907\u4e86\u4e13\u5c5e\u7279\u6743\uff01","action":"\u7acb\u5373\u67e5\u770b","showArr":m.ARR.PROF_VIP_BUBBLE_SHOP_SHOW,"clickArr":m.ARR.PROF_VIP_BUBBLE_SHOP_CLICK},i.clicked=function(){c.set({"k":"mui/mbarp/prof/shopVipBubble/"+r.getUid()+"/"+s.shopId,"v":1,"expires":1})},o(i))}}})}function t(){}function o(e){var i='<div class="mui-mbarp-prof-vip-bubble mui-mbar-bubble {specialClass}"><div class="mui-mbar-arr mui-mbar-bubble-arr mui-mbar-asset-member-bubble-arr">\u25c6</div><div class="mui-mbarp-asset-member-bubble-top"></div><div class="mui-mbarp-prof-vip-bubble-content"><p class="mui-mbarp-prof-vip-bubble-p1"> Hi\uff0c{nick}</p><p class="mui-mbarp-prof-vip-bubble-p2"> {discribe}</p>{rmb}<p class="mui-mbarp-prof-vip-bubble-action"><a>{action}</a></p></div><div class="mui-mbarp-asset-member-bubble-bottom"></div></div>',t=a.substitute(i,e);u.bubble({"show":!0,"content":t,"customContentType":3,"bubbleType":0,"isNotTabFire":!1,"tab":"PROF","flag":e.flag||"","showTwo":e.showTwo||"","showed":function(){l.sendLog(e.showArr),!!e.showed&&e.showed()},"clicked":function(){l.sendLog(e.clickArr),!!e.clicked&&e.clicked()}})}function n(e){e.b=e.b||"",e.m=e.m||"",c.get({"k":"mui/mbarp/prof/"+e.b+"/"+e.f+"/"+r.getUid(),"success":function(i){if(!i){u.set("currentProf",e.b),u.set("specialMark",e.m),e.u||(!!s.userInfo.nick&&(s.nick=l.sub(s.userInfo.nick,13)),e.u=s.nick||""),e.a||(e.a="\u7acb\u5373\u67e5\u770b");var t="";if(!!e.b&&(t=t.toUpperCase()),e.h3&&e.h3)if("shop"==e.h3){var o=a.one("#shopExtra");!!o&&(e.h3=o.one(".slogo-shopname").one("strong").html()||"")}else e.h3.indexOf("_")&&(e.h3=e.h3.substring(e.h3.indexOf("_")+1));var n=a.substitute('<div class="mui-mbarp-prof-vip-bubble mui-mbar-bubble mui-mbarp-prof-channel-bubble"><div class="mui-mbar-arr mui-mbar-bubble-arr mui-mbar-asset-member-bubble-arr">\u25c6</div><div class="mui-mbarp-asset-member-bubble-top"></div><div class="mui-mbarp-prof-vip-bubble-content"><p > Hi\uff0c{u}</p><p > {h1}</p><p > {h2}</p><p class="mui-mbarp-prof-channel-bubble-h3"> {h3}</p><p class="mui-mbarp-prof-vip-bubble-action "><a>{a}</a></p></div><div class="mui-mbarp-asset-member-bubble-bottom"></div></div>',e);u.bubble({"show":!0,"content":n,"customContentType":3,"bubbleType":0,"isNotTabFire":!1,"tab":"PROF","flag":e.flag||"1.2","showTwo":1,"showed":function(){l.sendLog(m.ARR.PROF_CHANNLE_BUBBLE_SHOW_BABY)},"clicked":function(){c.set({"k":"mui/mbarp/prof/"+e.b+"/"+e.f+"/"+r.getUid(),"v":1,"expires":1}),l.sendLog(m.ARR.PROF_CHANNLE_BUBBLE_CLICK_BABY)}})}}})}var s=this,r=s.mallbarItem=s.get(m.K.MALLBAR_ITEM),u=r.get(m.K.MALLBAR),b=l.getSysId();s.isDetail="detail"==b,s.isShop="shop"==b;var d=s.userInfo.memberInfo.activeStatus||"";s.nick="",!!s.userInfo.nick&&(s.nick=l.sub(s.userInfo.nick,13)),s.userInfo.isLogin&&u.getCueMsgInfo(function(a){a&&(a.bm&&(a.bm.v||a.bm.n)?s.isShop&&a.bm.v?i(a):s.isDetail&&a.bm.n?e(a):a.vip&&a.vip.vp?n(a.vip.vp):d>0&&t():a.vip&&a.vip.vp?n(a.vip.vp):d>0&&t())})},"showContent":function(){if(W){W=!1;var e=this,i=e.get(m.K.CONTAINER),t=D.mallbar.get("profList")||[],o=D.mallbar.get("currentProf");D.profNum=t.length;var n=N({"mod":"member","title":"\u4e13\u4eab\u7279\u6743"});D.profNum&&a.each(t,function(a){var e=P[a];e&&(n+=N(e))}),o=o in P?P[o].mod:"member",i.html('<div class="mui-mbarp-prof-user-wrap"></div><div class="mui-mbarp-prof-panels"></div><div class="mui-mbarp-prof-mask"></div><div class="mui-mbarp-prof-popup"></div>'),M=i.one("div.mui-mbarp-prof-popup"),y=i.one("div.mui-mbarp-prof-mask"),M.parent().on("scroll",function(){U&&d()}),s({"url":"//vip."+(m.IS_DAILY?"daily.tmall.net":"tmall.com")+"/api/vip/user.do","dataType":"jsonp","complete":function(a){if(a=a||{},200===a.status)if(a=a.data,a.isLogin){z=a,D.isMember=!!a.level;var t="";t=e.userInfo&&e.userInfo.tag?v(a,e.userInfo):_(a),i.one("div.mui-mbarp-prof-user-wrap").html(t),B(i)}else D.tryLogin()},"timeout":5});var r=(i.one("div.mui-mbarp-prof-tabs"),i.one("div.mui-mbarp-prof-panels"));D.mallbar.channelRecommend&&e.loadUserProf2(r)}},"loadUserProf2":function(e){if(!e.data("loaded")){var i=this;i.userInfo,i.sellerId,D.mallbar;e.data("loaded",!0),e.addClass("mui-mbarp-prof-loading"),s({"url":"//ald.taobao.com/recommend.htm?appId=05110&personalHallCount=2","dataType":"jsonp","jsonpCallback":"channelRecommend","timeout":5,"success":function(i){if(i=i||{},e.removeClass("mui-mbarp-prof-loading"),i.data&&i.data.length>0){l.sendLog(i.exposureParam);var t='<p class="mui-mbarp-prof-recommend-title">\u9002\u5408\u4f60\u7684\u4f1a\u573a\u63a8\u8350</p>';a.each(i.data,function(e){e.action=l.replaceSCM(e.action,"1048.1.2.35"),t+=a.substitute('<a class="mui-mbarp-prof-recommend" href="{action}" target="_blank"><img src="{imgUrl}"></a>',e)}),e.html(t)}else e.html('<div class="mui-mbarp-prof-load-error">\u55b5~ \u8fd8\u6ca1\u6709\u63a8\u8350\u4fe1\u606f </div>')},"error":function(){e.html('<div class="mui-mbarp-prof-load-error">\u55b5~ \u5c0f\u732b\u5fd9\u4e0d\u8fc7\u6765\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01</div>')}})}},"loadUserProf":function(e){if(!e.data("loaded")){var i=this;e.data("loaded",!0),e.addClass("mui-mbarp-prof-loading");var t=(D.mallbar,"item-2-5,coupon-2-5,brand-4-5"),o=i.sellerId;o&&(t="item-6-8,coupon-6-8",j=6,V=6),s({"url":Z+"/api/recommendEquity.do?param="+t+"&sellerId="+o+"&bizId="+i.bizId,"dataType":"jsonp","complete":function(i){if(i=i||{},e.removeClass("mui-mbarp-prof-loading"),200===i.status)if(J=a.merge({"coupon":[],"item":[],"brand":[]},i.data),J.coupon.length||J.item.length||J.brand.length){e.html(A(J.coupon)+I(J.item)+T(J.brand));try{l.sendLog(J.brand[0].exposureParam)}catch(t){}try{l.sendLog(J.coupon[0].exposureParam)}catch(t){}try{l.sendLog(J.item[0].exposureParam)}catch(t){}try{l.sendLog(J.act[0].exposureParam)}catch(t){}B(e),D.bindMagnify(e.one("div.mui-mbarp-prof-item"))}else e.html(D.profNum>1?'<div class="mui-mbarp-prof-load-error">\u55b5~ \u8fd8\u6ca1\u6709\u7279\u6743\u4fe1\u606f </div>':"");else e.html('<div class="mui-mbarp-prof-load-error">\u55b5~ \u5c0f\u732b\u5fd9\u4e0d\u8fc7\u6765\u4e86\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01</div>')},"timeout":5})}},"activateMember":function(){D.activateMember()},"clickFilter":function(a,e){D.mustActivate(e)},"togglePriv":function(a){t.toggleClass(t.parent(a,".mui-mbarp-prof-privilege"),"mui-mbarp-prof-privilege-collapse")},"renewal":function(a){var e=t.parent(a,"div.mui-mbarp-prof-block");if(e){var i=t.attr(e,"data-name"),n=J[i].data;if(n&&n.length){var s;"coupon"===i?(l.sendLog(m.ARR.PROF_VIP_COUPON_RENEWAL),s=A(n,!0)):"item"===i?(l.sendLog(m.ARR.PROF_VIP_ITEM_RENEWAL),s=I(n,!0)):"brand"===i?(l.sendLog(m.ARR.PROF_VIP_BRAND_RENEWAL),s=T(n,!0)):"act"===i&&(l.sendLog(m.ARR.PROF_VIP_ACT_RENEWAL),s=C(n,!0));var r=t.get("div.mui-mbarp-prof-list",e),c=o.one(r);"item"===i&&c.all("div.mui-mbarp-prof-img").detach("mouseenter").detach("mouseleave"),r.innerHTML=s,"item"===i&&D.bindMagnify(c)}}},"openVip":function(){window.open("//vip.tmall.com/?spm=3700.7045653.0.0.T0qI3H&signIn=true&scm=1048.1.2.23","_blank")},"collectCoupon":function(a,e){D.mustActivate(e)||e&&"A"===e.target.nodeName||p({"me":this,"id":t.attr(a,"data-id"),"isQuery":!0,"success":function(e){e.brandLogo=t.attr(a,"data-brandlogo"),g(e)}})},"collectCoupon2":function(a,e){var i=this;if(!D.mustActivate(e)){var o=t.attr(a,"data-id")||"",n=t.attr(a,"data-url");n+="&_tb_token_="+H,s({"url":n,"dataType":"jsonp","success":function(a,t,n){if(a&&a.success){D.mallbar.driving({"type":"asset","e":e,"bubble":!0,"callback":function(){setTimeout(function(){w(),i.removeAndUpdateCoupon(o),D.hidePopup()},500)}}),D.showPopup('<div class="mui-mbarp-prof-collect-success">\u606d\u559c\u60a8\uff0c\u5151\u6362\u6210\u529f\u4e86!</div>')}else a.errorMsg?f(500,a.errorMsg):f(500)}})}},"removeAndUpdateCoupon":function(e){var i=t.get("#J_ProfCoupon_"+e),o={},n=t.parent(i);t.remove(i),t.children(n,function(a){o[t.attr(a,"data-id")]=!0});var s=[],r=!1;a.each(J.coupon.data,function(a){var i=""+a.spreadId;if(i==e)return void(r=!0);i in o&&(a._looped=!1),s.push(a)}),J.coupon.data=s,s.length||t.remove(t.parent(n)),s.length<=V&&t.remove(t.get("span.mui-mbarp-prof-renewal",t.parent(n))),this.renewal(n)},"closePopup":function(){D.hidePopup()},"finishCollectCoupon":function(a,e){var i=this,o=t.attr(a,"data-id");if("true"===t.attr(a,"data-fav")){var n=q[o];return s({"url":Z+"/api/fav_brand.do","data":{"type":"fav","brandId":n.brandId,"_tb_token_":H},"dataType":"jsonp","complete":function(o){o=o||{};var n=o.status;return 200===n?(t.attr(a,"data-fav",""),i.finishCollectCoupon(a,e)):401===n?D.tryLogin():void D.showPopup({"body":"\u5173\u6ce8\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~","action":'<button data-action="closePopup@member">\u786e\u5b9a</button>'})},"timeout":5})}p({"me":i,"id":o,"isQuery":!1,"success":function(){D.mallbar.driving({"type":"asset","e":e,"bubble":!0,"callback":function(){setTimeout(function(){w(),i.removeAndUpdateCoupon(o),D.hidePopup()},500)}}),D.showPopup('<div class="mui-mbarp-prof-collect-success">\u606d\u559c\u60a8\uff0c\u5151\u6362\u6210\u529f\u4e86!</div>')}})}}),$},{"requires":["cookie","base","dom","node","event","ajax","mui/minilogin/index","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","xtemplate","mui/mallbar/plugin-prof.css"]});KISSY.add("mui/mallbar/plugin-asset",function(a,e,t,i,s,n,o,r,m,l,c){function u(e){var t=a.one(e.currentTarget),i=t.parent().one(".mui-mbarp-asset-coupon-item-region-tip");i.show();var s=i[0].offsetWidth,n=Math.min(64,s/2-4),o=Math.max(6,70-s+n+8);i[0].style.left=o+"px",i[0].children[0].style.left=n+"px"}function b(e){a.one(e.currentTarget).parent().one(".mui-mbarp-asset-coupon-item-region-tip").hide()}function d(a,e){if(a)return-1==a.indexOf("?")?a+="?scm="+e:a+="&scm="+e,a}var p=(window.location.href.indexOf("mock-tmallbao=1"),function(a){var e=this;p.superclass.constructor.call(e,a),e.init()});return a.extend(p,e,{"init":function(){function e(){s.bubbled||(s.bubbled=!0,t(),s.getPluginAssetTip())}function t(){var a=s.get(r.K.MALLBAR_ITEM),e=a.get(r.K.MALLBAR),t=e.get("model").get("bar");t.popo&&i(t.popo.image,t.popo.url)}function i(a,e){var t=new Image,i=28,s=n.get(r.K.MALLBAR),o=['<div class="mui-mbar-bubble mui-mbar-bubble-flexible mui-mbar-bubble-custom"',' style="cursor: pointer; right:',i,"px; width: ",0,'px;">','<div class="mui-mbar-arr mui-mbar-bubble-flexible-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-prof-login-close"></div>','<div class="mui-mbar-bubble-flexible-bd">',0,"</div></div>"],m={"show":!0,"flag":.09,"bubbleType":1,"first":1,"customContentType":3},l=["asset","cart","favor","prof","qrcode","brand"];e&&l.indexOf(e.toLowerCase())>-1&&(m.tab=e.toUpperCase(),m.isNotTabFire=!1),t.onload=function(){o[4]=t.width,!m.tab&&e?o[9]=['<a href="',e,'" target="_blank">',t.outerHTML,"</a>"].join(""):o[9]=t.outerHTML,m.height=t.height,m.content=o.join(""),s.bubble(m)},t.src=a}var s=this,n=s.mallbarItem=s.get(r.K.MALLBAR_ITEM),o=s.userInfo=n.getUserInfo();s.token="";var l=m.getSysId();s.isList="list"==l,s.isDetail="detail"==l,s.isShop="shop"==l,s.bubbled=!1;var c=n.get(r.K.MALLBAR);if(s.itemId=c.get("itemId")||"",s.sellerId=c.get("sellerId")||"",s.shopId=c.get("shopId")||"",o.isLogin){var u=a.unparam(window.location.search.substr(1));u&&Number(u.gap);e()}s.set("isDataChange",!0),s.on(r.E.VISIBILITY_CHANGE,function(a){a.visible&&s.get("isDataChange")&&s._getAssetData()}),n.on(r.E.LOGIN_SUCCESS,function(a){m.log(a.type),e()}),s.on(r.E.DATA_CHANGE,function(a){s.set("isDataChange",!0),n.get(r.K.EXPAND)&&s._getAssetData()});var b=s.get("mallbarItem").get("tab"),d=a.one(".mui-mbar");b.on("click",function(){d.hasClass("mui-mbar-status-expand")&&m.sendLog(r.ARR.ASSETS_TAB_CLICK)})},"_getCouldCoupon":function(){var e=this,t=(e.mallbarItem,a.one("#mbarCouponAnchorCouldCoupon"));t&&(t.hide(),m.ajax({"url":r.URL.GET_PLUGIN_ASSET_OBTAIN_COUPON_LIST,"dataType":"jsonp","data":{"sellerId":e.sellerId,"itemId":e.itemId},"timeout":5,"success":function(n){function o(t){function s(t){a.one(".j_mui-mbarp-asset-cur-coupon").all(".mui-mbarp-asset-coupon-item").each(function(s,r){if(0==r)return a.one(".j_pushShopItems")?e.isDetail||"0"!=t?i(a.one(s),{"height":"90px"},b,p,function(){o()}).run():i(a.one(".j_pushShopItems"),{"height":"0px"},b,p,function(){a.one(".j_pushShopItems").css("overflow","hidden").insertAfter(a.one(s)),i(a.one(s),{"height":"90px"},b,p,function(){l(),o()}).run()}).run():i(a.one(s),{"height":"90px"},b,p,function(){e.isDetail||(a.one('<div class="mui-mbarp-asset-shop-push-items j_pushShopItems" style="height:0; overflow: hidden; zoom: 1px;"></div>').appendTo(a.one(".j_mui-mbarp-asset-cur-coupon")),"0"==t&&(e._getPullItems(),l(),n())),o()}).run(),!1})}function n(){var t=a.one("#mbarCouponAnchorAbleCoupon"),s=e.get(r.K.CONTAINER);if(t){var n=a.all(t).getDOMNode().offsetTop;i(s,{"scrollTop":n},.5).run(),e.set(r.K.COUPON_ANCHOR,"")}}function o(){var e=!1;a.one(".j_mui-mbarp-asset-could-coupon").all("a").each(function(t){0!=parseInt(a.one(t).css("height"))&&(e=!0)}),e?a.one("#mbarCouponAnchorCouldCoupon").show():a.one("#mbarCouponAnchorCouldCoupon").hide()}function l(){i(a.one(".j_pushShopItems"),{"height":"265px"},2,p,function(){a.one(".j_pushShopItems").css("overflow","visible")}).run()}var c;c=a.one(t.currentTarget).hasClass(".mui-mbarp-asset-coupon-item")?a.one(t.currentTarget):a.one(t.target).parent(".mui-mbarp-asset-coupon-item");var b=.5,d=.5,p=r.EASE;m.ajax({"url":r.URL.GET_PLUGIN_ASSET_OBTAIN_COUPON,"data":{"sellerId":e.sellerId,"spreadId":c.attr("data-activeId"),"_tb_token_":e.token},"success":function(t){"-2"!=t.s&&("-1"==t.s?(c.attr("data-stretch","0"),t.m.length<12?c.one(".j_couldCouponFailMsg").css("line-height","48px"):c.one(".j_couldCouponFailMsg").css("padding-top","9px"),c.one(".j_couldCouponFailMsg").html(t.m),i(c.one(".j_couldCouponFail"),{"right":"0px"},d,p,function(){c.one(".j_couldPullBd").one(".mui-mbarp-asset-coupon-now-area-bg").hide(),c.one(".j_couldPullBd").one(".mui-mbarp-asset-coupon-fail-area-bg").css("width","198px")}).run(),i(c.one(".j_couldPullBd"),{"right":"0px"},d,p).run(),i(c.one(".j_couldPullAct"),{"right":"187px"},d-6e-5,p).run()):"1"==t.s&&(c.one(".mui-mbarp-asset-coupon-could-act").css("top","18px"),c.one(".j_couldActIcon").html("&#xe605;").show(),c.one(".j_couldActVal").next().hide(),c.one(".j_couldActVal").html("\u5df2\u9886").css("margin-top","0px"),i(c,{"height":"0px"},b,p,function(){c.hide(),n();var t={};t.d=c.attr("data-d"),t.u=c.attr("data-u"),t.s="20"+c.attr("data-s"),t.l="20"+c.attr("data-l"),t.t=c.attr("data-t"),t.n=c.attr("data-n"),t.c=c.attr("data-c"),t.f=!("false"==c.attr("data-f")),t.nt=c.attr("data-nt"),t.i=c.attr("data-i");var o=e._couponTemp.render(t);a.one(o).prependTo(a.one(".j_mui-mbarp-asset-cur-coupon")),a.one("#mbarCouponAnchorAbleCoupon")?s(t.i):(a.all(u.render()).insertBefore(a.one(".j_mui-mbarp-asset-cur-coupon")),i(a.one("#mbarCouponAnchorAbleCoupon"),{"height":"18px"},.1,p,function(){s(t.i)}).run())}).run()))}})}if(200===n.s&&n.oci){e.token=n.t;var c=n.oci.c;if("0"!=c.length){t.html("\u5f53\u524d\u5e97\u94fa\u6709\u53ef\u9886\u4f18\u60e0\u5238\u54e6").show();var u=new l(['<div class="mui-mbarp-asset-coupon-title" style="height:0px" id="mbarCouponAnchorAbleCoupon">',"\u5f53\u524d\u5e97\u94fa\u53ef\u7528\u4f18\u60e0\u5238","</div>"].join("")),b=['<a class="mui-mbarp-asset-coupon-item mui-mbarp-asset-coupon-{{#if d>=0&&d<=20}}blue{{/if}}{{#if d>20&&d<=50}}red{{/if}}{{#if d>50}}yellow{{/if}} ','{{#if a>1}}mui-mbarp-asset-coupon-{{#if d>=0&&d<=20}}blue{{/if}}{{#if d>20&&d<=50}}red{{/if}}{{#if d>50}}yellow{{/if}}-multi{{/if}}" href="javascript:;"',' data-s="{{s}}" data-l="{{l}}" data-activeId="{{sid}}" data-c="{{c}}" data-stretch="1" data-u="#" data-d="{{d}}" data-t="\u6709\u6548\u671f" data-n="{{n}}" data-nt="{{nts}}"  data-f="{{f}}" data-i={{i}}',">",'<div class="mui-mbarp-asset-coupon-border-top"></div>','<div class="mui-mbarp-asset-coupon-item-content">','<p class="mui-mbarp-asset-coupon-item-hd">','<span class="mui-mbarp-asset-coupon-item-name" title="{{n}}"> ',"{{#if f}}",'<span class="mui-mbarp-asset-tmgj-flag "> </span>',"{{/if}}","{{nt}}</span>","</p>",'<div class="mui-mbarp-asset-coupon-item-bd mui-mbarp-clearfix">','<div class="mui-mbarp-asset-coupon-item-bd-right mui-mbarp-asset-coupon-item-bd-right-could">',"<p>{{s}}</p>","<p>&nbsp;{{l}}</p>","</div>",'<div class="mui-mbarp-asset-bonus-item-left">','<p class="mui-mbarp-asset-coupon-item-rmb mui-mbarp-asset-coupon-item-rmb-could" {{#if i===1}}style="height:25px!important"{{/if}}>','{{currencyUnit||"\uffe5"}}<span class="mui-mbarp-asset-coupon-item-rmb-rmb">',"{{d}}</span>","</p>",'<p class="mui-mbarp-asset-coupon-item-condition">\u6ee1{{c}}\u4f7f\u7528{{#if (!siteRegionName||siteRegionName==="\u5168\u56fd")&&i===1}}</br>(\u90e8\u5206\u5546\u54c1){{/if}}</p>','{{#if siteRegionName&&siteRegionName!=="\u5168\u56fd"}}','<p class="mui-mbarp-asset-coupon-item-region" title="{{siteRegionName}}">\u9650\u533a\u57df\u4f7f\u7528<i class="mui-mbarp-asset-coupon-item-region-icon">&#xe622;</i></p>','<div class="mui-mbarp-asset-coupon-item-region-tip"> {{siteRegionName}}<div class="mui-mbarp-asset-coupon-item-region-tip-arr">\u25c6</div></div>',"{{/if}}","{{#if channel===3}}",'<p class="mui-mbarp-asset-coupon-item-channel">\u624b\u673a\u5929\u732b\u4e13\u4eab</p>',"{{/if}}","{{#if channel===2}}",'<p class="mui-mbarp-asset-coupon-item-channel">\u65e0\u7ebf\u4e13\u4eab</p>',"{{/if}}","</div>","</div>","</div>",'<div class="mui-mbarp-asset-coupon-border-bottom"></div>','<div class="mui-mbarp-asset-coupon-could-act j_couldPull j_couldPullAct">','<div class="mui-mbarp-asset-coupon-could-act-icon j_couldActIcon mui-mbarp-asset-hide"></div>','<span class="mui-mbarp-asset-coupon-could-act-val j_couldActVal">\u7acb\u5373\u9886\u53d6</span>','<div class="mui-mbarp-asset-coupon-could-act-icon"><img src="//gtd.alicdn.com/tps/i4/T19yeaFDVfXXa94Hfd-32-32.png" width="16" height="16"/></div>',"</div>",'<div class="mui-mbarp-asset-coupon-could-act-fail j_couldCouponFail">','<div class="mui-mbarp-asset-could-act-fail-icon"><img src="//img.alicdn.com/tps/i4/T1UWUoFz4aXXXuPRLc-28-28.png" width="14"></div>','<div class="mui-mbarp-asset-could-act-fail-msg j_couldCouponFailMsg"></div>',"</div>",'<div class="mui-mbarp-asset-coupon-could-area j_couldPull j_couldPullBd">','<div class="mui-mbarp-asset-coupon-now-area-bg"></div>','<div class="mui-mbarp-asset-coupon-fail-area-bg"></div>',"</div>","</a>"],d=new l(['<div class="mui-mbarp-asset-coupon-bd j_mui-mbarp-asset-could-coupon">',"{{#each c}}",b.join(""),"{{/each}}","</div>"].join(""));if(m.log("::\u53ef\u9886\u53d6\u7684\u4f18\u60e0\u5238::",c),c&&c.length>0){if(!c[0].s)return;a.one(".mui-mbar-asset-no-coupon")&&a.one(".mui-mbar-asset-no-coupon").css("visibility","hidden"),a.each(c,function(a){var e=/^\d{2}/;a.s=a.s.replace(e,""),a.l=a.l.replace(e,""),a.nt=a.n,a.nts=a.n,a.f&&(a.nts=m.sub(a.n,14),a.nt=m.sub(a.n,19))}),a.one("#mbarCouponAnchorCouldCoupon")&&(a.DOM.insertAfter(a.DOM.create(d.render(n.oci)),a.one("#mbarCouponAnchorCouldCoupon")),a.one("#mbarCouponAnchorCouldCoupon").show()),s.delegate(".j_mui-mbarp-asset-could-coupon","mouseenter",".mui-mbarp-asset-coupon-item",function(e){var t=a.one(e.currentTarget);"1"==t.attr("data-stretch")&&(i(t.one(".j_couldPullBd"),{"right":"-183px"},.1,r.EASE).run(),i(t.one(".mui-mbarp-asset-coupon-could-act"),{"right":"8px"},.1,r.EASE).run())}),s.delegate(".j_mui-mbarp-asset-could-coupon","mouseleave",".mui-mbarp-asset-coupon-item",function(e){var t=a.one(e.currentTarget);"1"==t.attr("data-stretch")&&(i(t.one(".j_couldPullBd"),{"right":"-198px"},.1,r.EASE).run(),i(t.one(".mui-mbarp-asset-coupon-could-act"),{"right":"0px"},.1,r.EASE).run())}),s.delegate(".j_mui-mbarp-asset-could-coupon","click",".mui-mbarp-asset-coupon-item",function(a){a.halt(),o(a)}),s.delegate(".mui-mbarp-asset-wrap","click",".j_couldPull",function(a){a.halt(),o(a)}),s.delegate(".j_mui-mbarp-asset-could-coupon","click",".j_couldCouponFail",function(e){a.one(e.currentTarget).parent(".mui-mbarp-asset-coupon-item").slideUp(.5),e.halt()})}}}},"error":function(){}}))},"_getPullItems":function(){var e=this,t=(e.mallbarItem,a.one("#mbarCouponAnchorAbleCoupon"));e.isDetail?a.one(".j_pushShopItems")&&a.one(".j_pushShopItems").css("height","0px"):t&&(t.html("\u5f53\u524d\u5e97\u94fa\u53ef\u7528\u4f18\u60e0\u5238:"),m.ajax({"url":r.URL.GEI_PUSH_ITEMS,"dataType":"jsonp","data":{"appId":r.RECOMMEND_APPID,"shopId":e.shopId},"timeout":5,"success":function(t){var n=new l(['<img src="{{acurl}}" class="mui-mbarp-asset-hide" /><div class="mui-mbarp-asset-shop-push-tip">\u63a8\u8350\u4ee5\u4e0b\u4eba\u6c14\u5b9d\u8d1d\u4eab\u7528\u4f18\u60e0\u5238\uff1a</div>',"<ul>","{{#each d}}",'<li class="mui-mbarp-asset-shop-push-item mui-mbarp-asset-shop-push-item{{xindex}}" data-url="{{linkUrl}}">','<a href="{{linkUrl}}" target="_blank">','   <div class="mui-mbarp-asset-shop-push-wrap">','       <span class="mui-mbarp-asset-shop-push-describe"><span class="mui-mbarp-asset-shop-push-a" title="{{title}}" target="_blank">{{title}}</span></span>','       <span class="mui-mbarp-asset-shop-push-price">\uffe5<b>{{price}}</b></span>','       <span class="mui-mbarp-asset-shop-push-sales">\u5df2\u552e\u51fa<b>{{sales}}</b>\u4ef6</span>',"   </div>",'   <div class="mui-mbarp-asset-hide mui-mbarp-asset-shop-push-166pic-arr"></div>','   <div class="mui-mbarp-asset-hide mui-mbarp-asset-shop-push-166pic"><img title="{{title}}" src="{{pic}}" width="198" height="198" style=""/></div>','   <img class="mui-mbarp-asset-shop-push-60pic" alt="{{title}}" src="{{pic}}" width="60" height="60"/>',"</a>","</li>","{{/each}}","</ul>",'<div class="mui-mbarp-clearfix mui-mbarp-asset-push-items-bg"></div>'].join(""));t.d&&t.d.length>0?(a.one(".j_pushShopItems")&&a.DOM.append(a.DOM.create(n.render(t)),a.one(".j_pushShopItems")),a.all(".mui-mbarp-asset-shop-push-item").each(function(e){s.delegate(document,"mouseover",".mui-mbarp-asset-shop-push-60pic",function(e){var t=a.one(e.target).prev(),i=a.one(e.target).parent().one(".mui-mbarp-asset-shop-push-166pic-arr");t.css({"display":"block"}),i.css({"display":"block"})}),s.delegate(document,"mouseout",".mui-mbarp-asset-shop-push-60pic",function(e){var t=a.one(e.target).prev(),i=a.one(e.target).parent().one(".mui-mbarp-asset-shop-push-166pic-arr");t.css({"display":"none"}),i.css({"display":"none"})}),a.one(e).one("div.mui-mbarp-asset-hide").on("mouseout",function(e){var t=a.one(e.target).parent().one(".mui-mbarp-asset-shop-push-166pic-arr");a.one(e.target).css({"display":"none"}),t.css({"display":"none"})})}),s.delegate(".j_mui-mbarp-asset-cur-coupon","click",".mui-mbarp-asset-coupon-item",function(t){if(!e.isDetail){var s=a.one(".j_pushShopItems"),n=a.one(t.target).parent(".mui-mbarp-asset-coupon-item").next();if(n&&n.hasClass("j_pushShopItems"))return;i(s,{"height":"0px"},.5,r.EASE,function(){m.log("i try clone"),s.css("height","0px").insertAfter(a.one(t.target).parent(".mui-mbarp-asset-coupon-item")),i(s,{"height":"265px"},2,r.EASE,function(){s.css("overflow","visible")}).run()}).run()}}),a.one(".mui-mbarp-asset-shop-push-items").show()):a.one(".j_pushShopItems").hide()},"error":function(){a.one(".mui-mbarp-asset-shop-push-items").hide()}}))},"_getAssetData":function(){var e=this,t=e.mallbarItem,i=t.get(r.K.MALLBAR);e._initHuaBei(),m.ajax({"url":r.URL.GET_PLUGIN_ASSET,"data":{"sellerId":e.sellerId,"itemId":e.itemId},"timeout":4,"jsonpCallback":"__mallbarGetMyAssets","success":function(n){return m.log(n),401==n.s?void t.fire(r.E.LOGIN,{"success":function(){e.set("isDataChange",!0),t.get(r.K.EXPAND)&&e._getAssetData()}}):200!==n.s?void t.fire(r.E.ERROR):void(n&&m.getStaticConf({"cb":function(t){var o=i.get(r.K.MODEL).get(r.K.TIMESTAMP);n.assetActBannerList=t.assetActBannerList||"";var l=[];n.banner&&n.banner.length&&(a.each(n.banner,function(a){l.push({"url":a.url,"pic":a.image})}),n.assetActBannerList=l.concat(n.assetActBannerList)),e.assetTips=t.assetTips||"",n.cashCardBanner=t.cashCardBanner||"",n.inShowTime=o>t.closedStartShow&&o<t.closedEndTime,n.inActiveTime=o>t.closedStartTime&&o<t.closedEndTime,m.log("::plugin asset::\u8d44\u4ea7\u4e2d\u5c55\u793a\u4f18\u5148\u8d2d\u4e70\u8d77\u59cb\u65f6\u95f4",t.closedStartShow,t.closedStartTime,t.closedEndTime,n.inShowTime,n.inActiveTime);var c=function(){if(e._render(n),e._getCouldCoupon(),n&&n.d&&n.d.c&&n.d.c.l&&n.d.c.l.length){var a=n.d.c.l.length;n.d.c.l[a-1].i||e._getPullItems()}e.set("isDataChange",!1),s.undelegate(".mui-mbarp-asset-coupon","mouseenter",".mui-mbarp-asset-coupon-item-region",u),s.delegate(".mui-mbarp-asset-coupon","mouseenter",".mui-mbarp-asset-coupon-item-region",u),s.undelegate(".mui-mbarp-asset-coupon","mouseleave",".mui-mbarp-asset-coupon-item-region",b),s.delegate(".mui-mbarp-asset-coupon","mouseleave",".mui-mbarp-asset-coupon-item-region",b)};n.notNeedShopCard=!0;var d=function(){n.notNeedShopCard?c():m.ajax({"url":r.URL.GET_SHOP_CARD,"data":{"sellerId":e.sellerId,"itemId":e.itemId},"timeout":4,"jsonpCallback":"__mallbarGetShopCard","success":function(a){m.log("\u5e97\u94fa\u5361\u5185\u5bb9",a),a.success&&(n.shopCard=a.model),c()},"error":function(){c()}})};if(n.inShowTime){4==(e.userInfo.memberInfo.activeStatus||0)?i.get("closeSaleNum")?d():m.ajax({"url":r.URL.GET_CLOSE_SALE_NUM,"timeout":4,"data":{"itemId":i.get("itemId")},"jsonpCallback":"__mallbarGetCloseSaleNum","success":function(a){200==a.s&&a.pec&&a.pec>0?(i.set("closeSaleNum",a.pec),d()):d()}}):d()}else d()}}))},"error":function(){t.fire(r.E.ERROR)}})},"renderCouldCoupon":function(a){var e,t=this,i=t.mallbarItem,s=i.get(r.K.MALLBAR);e=t._assetCouponBubbleTPL('<div class="mui-mbar-assets-disable-bubble mui-mbarp-assets-disable-bubble-couldCoupon" >\u8be5\u5e97\u94fa\u53ef\u9886\u4f18\u60e0\u5238<p class="mui-mbarp-asset-couldCouponBubble-click"><a>\u7acb\u5373\u9886\u53d6</a></p></div>'),t.token=a.t,s.bubble({"show":!0,"content":new l(e).render(),"customContentType":3,"isNotTabFire":!1,"bubbleType":0,"tab":"ASSET","dismiss":function(){t.handleAbleBonusBubble()},"showed":function(){m.sendLog(r.ARR.COUPON_COULD_SHOW)},"clicked":function(){t.set(r.K.COUPON_ANCHOR,"mbarCouponAnchorCouldCoupon"),m.sendLog(r.ARR.COUPON_COULD_CLICK)}})},"renderExpCoupon":function(e){var t=this,i="",s=t.handleExpCoupon(e),n=!1,o={};if(1==s.n){var c=s.d[0];c.isShow?c.lastDay&&0==c.lastShow&&(n=!0):n=!0;var u=new Date(s.d[0].t);s.deadline=t.dateFormat(u,"yyyy-MM-dd"),i='<div class="j_Asset_Bubble"><div class="mui-mbar-assets-disable-bubble">{{n}}\u5f20\u4f18\u60e0\u5238\u4e8e<br/>{{deadline}}\u8fc7\u671f</br>\u4ef7\u503c \uffe5{{t}}\u5143</div><p class="mui-mbar-bubble-href"><a>\u7acb\u5373\u67e5\u770b</a></p></div>',o.height="120px"}else i='<div class="j_Asset_Bubble"><div class="mui-mbar-assets-disable-bubble">{{n}}\u5f20\u4f18\u60e0\u5238\u5373\u5c06\u8fc7\u671f</br>\u603b\u4ef7\u503c \uffe5{{t}}\u5143</div><p class="mui-mbar-bubble-href"><a>\u7acb\u5373\u67e5\u770b</a></p></div>',o.height="100px";if(a.each(s.d,function(a){return a.isShow?a.lastDay&&0==a.lastShow?(n=!0,!1):void 0:(n=!0,!1)}),!n)return void t.getPluginAssetTip();t.mallbarItem.fire(r.E.BUBBLE_CHANGE,a.mix(o,{"show":!0,"html":new l(i).render(s),"dismiss":function(){t.getPluginAssetTip()},"showed":function(){m.sendLog(r.ARR.COUPON_7_SHOW)},"clicked":function(){t.set(r.K.COUPON_ANCHOR,"mbarCouponAnchorExpCoupon"),m.sendLog(r.ARR.COUPON_7_CLICK)}}))},"dateFormat":function(a,e){var t={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),"S":a.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e},"handleExpCoupon":function(a){var e=this,t={},i=e.mallbarItem;return a.isServer&&(a.server.serverSince=1*new Date),e.handleExpServiceData(a,t),c.set({"k":"mui/mallbar/asset/"+i.getUid(),"v":a.isServer?a.server:a.local,"success":function(a){}}),t},"handleExpServiceData":function(e,t){var i=this,s=1*new Date,n=e.server,o=e.local;o&&o.d&&(o.d=a.filter(o.d,function(e){if(n&&n.d){var t=!1;return a.each(n.d,function(a){if(a.i==e.i)return t=!0,!1}),t}return!0})),n?(a.each(n.d,function(e){o&&a.each(o.d,function(t){t.i==e.i&&a.mix(e,t)})}),a.mix(t,a.clone(n))):o&&a.mix(t,a.clone(o));var r=n||o;a.each(r.d,function(a,e){i.dateFormat(new Date(a.t),"yyyy-MM-dd")==i.dateFormat(new Date(s),"yyyy-MM-dd")?(t.d[e].lastDay=!0,a.isShow=!0,a.lastShow=!0):a.isShow=!0})},"getPluginAssetTip":function(){var a=this;a.mallbarItem.get(r.K.MALLBAR).getCueMsgInfo(function(e){return 200==e.s&&(a.token=e.t,e.b&&e.b.c>0&&"0.0"!==e.b.a?void a.handleAbleBonusBubble(e):e.m&&e.m.t?void(e.m.p&&2!=e.m.p&&a.handleMemberCouponBubble(e)):e.uci&&e.uci.d&&e.uci.d.length>0?void a.handleAbleCouponBubble(e):void(e.oci&&e.oci.c&&e.oci.c.length>0&&a.renderCouldCoupon(e)))})},"handleAbleBonusBubble":function(a){var e=this,t=e.mallbarItem,i=t.get(r.K.MALLBAR);a&&c.get({"k":"mui/mallbar/asset/ableBonus/"+t.getUid(),"success":function(s){if(s&&s.isShow){if(a.m&&a.m.t)return void(a.m.p&&2!=a.m.p&&e.handleMemberCouponBubble(a));if(a.uci&&a.uci.d&&a.uci.d.length>0)return void e.handleAbleCouponBubble(a);a.oci&&a.oci.d&&a.oci.d.length>0&&e.renderCouldCoupon(a)}else{var n=["<div>","\u60a8\u5171\u6709{{c}}\u4e2a\u7ea2\u5305\u53ef\u7528","</div>","<div>","\u603b\u91d1\u989d{{a}}\u5143","</div>"].join(""),o=new l(n).render(a.b);i.bubble({"show":!0,"content":o,"customContentType":1,"isNotTabFire":!1,"bubbleType":0,"tab":"ASSET","showed":function(){m.sendLog(r.ARR.BONUS_AVAILABLE_BUB_SHOW)},"dismiss":function(){e.handleAbleCouponBubble(a)},"clicked":function(){m.sendLog(r.ARR.BONUS_AVAILABLE_BUB_CLICK)}}),c.set({"k":"mui/mallbar/asset/ableBonus/"+t.getUid(),"v":{"isShow":!0}})}}})},"handleAbleCouponBubble":function(e){var t=this,i=t.mallbarItem,s=i.get(r.K.MALLBAR);if(!(a.isUndefined(e.uci)||e.uci.d&&0==e.uci.d.length)){var n=function(e){var t=e[0]?e[0]:e.data,i=t.d;if(0!=i.length){var s="",n='<div class="mui-mbarp-asset-ableCouponBubble-content mui-mbar-bubble">';return n+='<div class="mui-mbar-arr mui-mbar-bubble-arr">\u25c6</div>',n+='<div class="mui-mbarp-asset-bubble-top"></div>',a.each(i,function(a,e){var t=a.d;if(0===e)return n+='<div class="mui-mbarp-asset-ableCouponBubble-'+s+"_small mui-mbarp-asset-ableCouponBubble-"+s+"_big mui-mbarp-asset-ableCouponBubble-zindex-"+e+' mui-mbarp-asset-ableCouponBubble">',n+='<p class="mui-mbarp-asset-ableCouponBubble-title mui-mbarp-asset-ableCouponBubble-title-denomination">\u60a8\u6709'+i.length+'\u5f20\u4f18\u60e0\u5238</p><p class="mui-mbarp-asset-ableCouponBubble-trmb">',void(n+='<span class="mui-mbarp-asset-memberCouponBubble-rmb_icon">\uffe5</span><span class="mui-mbarp-asset-ableCouponBubble-rmb">'+t+'</span></p><p class="mui-mbarp-asset-ableCouponBubble-now_use"><a>\u7acb\u5373\u4f7f\u7528</a></p></div>')}),n+='<div class="mui-mbarp-asset-bubble-bottom"></div>',n+="</div>"}},o=new l(n).render(e.uci);s.bubble({"show":!0,"content":o,"customContentType":3,"bubbleType":r.B.FOREVER,"isNotTabFire":!1,"tab":"ASSET","showed":function(){m.sendLog(r.ARR.COUPON_AVAILABLE_SHOW)},"clicked":function(){t.set(r.K.COUPON_ANCHOR,"mbarCouponAnchorAbleCoupon"),m.sendLog(r.ARR.COUPON_AVAILABLE_CLICK)}})}},"handleMemberCouponBubble":function(e){var t=this,i=t.mallbarItem,s=i.get(r.K.MALLBAR);if(!a.isUndefined(e.m)){var n="",o='<div class="mui-mbarp-asset-memberCouponBubble-content mui-mbar-bubble"><div class="mui-mbar-arr mui-mbar-bubble-arr mui-mbar-asset-member-bubble-arr">\u25c6</div><div class="mui-mbarp-asset-member-bubble-top"></div><div class="mui-mbarp-asset-memberCouponBubble-zindex-0 mui-mbarp-asset-memberCouponBubble"> <p class="mui-mbarp-asset-memberCouponBubble-title mui-mbarp-asset-memberCouponBubble-title-denomination">{{#if v}}<i class="mui-mbar-iconfont mui-mbarp-asset-memberCouponBubble-heart">&#xe600;</i>{{/if}}{{t}}</p><p class="mui-mbarp-asset-memberCouponBubble-trmb">{{#if rt===2}}<span class="mui-mbarp-asset-memberCouponBubble-rmb_icon">\uffe5</span><span class="mui-mbarp-asset-memberCouponBubble-rmb">{{m}}</span><span>\u73b0\u91d1\u5238</span></p>{{/if}}{{#if rt===1}}{{b}}\u6298\u6263</p>{{/if}}{{#if rt===3}}{{b}}\u8bd5\u7528</p>{{/if}}';o+='<p class="mui-mbarp-asset-memberCouponBubble-now_use"><a>{{a}}</a></p><div class="mui-mbarp-asset-member-bubble-bottom"></div></div>',n=o;var c=new l(n).render(e.m);s.bubble({"show":!0,"content":c,"customContentType":3,"bubbleType":r.B.FOREVER,"isNotTabFire":!1,"tab":"ASSET","showed":function(){m.sendLog(r.ARR.COUPON_MEMBER_BUBBLE_A_SHOW)},"clicked":function(){t.set(r.K.COUPON_ANCHOR,"mbarCouponAnchorAbleCoupon"),m.sendLog(r.ARR.COUPON_MEMBER_BUBBLE_A_CLICK)}})}},"_renderShopCard":function(e){var t="";return a.each(e,function(e,i){i>2||(e.moneyBase?(e.moneyBase=parseInt(e.moneyBase,10)/100,e.moneyExtra=parseInt(e.moneyExtra,10)/100,e.hidden=""):e.hidden="hidden",e.balance=(parseInt(e.balance,10)/100).toFixed(2),t+=a.substitute('<li class="mui-mbarp-asset-shop-card-item mui-mbarp-asset-shop-card-item-{categoryTag}">                <a class="mui-mbarp-asset-shop-card-link" href="//{shopUrl}" target="_blank">                <h4>{shopTitle}</h4>                <p><em>\u4f59\u989d\uff1a<span class="mui-price-font">&yen;</span><span class="mui-mbarp-asset-shop-cart-balance">{balance}</span></em></p>                <p>\u8fdb\u5e97\u901b\u901b&gt;</p>                </a>                <a class="mui-mbarp-asset-shop-card-link-charge {hidden}" href="//shopcard.tmall.com/?sellerId={sellerId}&campaignId={campaignId}">\u5145{moneyBase}\u9001{moneyExtra}&gt;</a>                </li>',e))}),t='<div class="mui-mbarp-asset-shop-cart-cont">                     <div class="mui-mbarp-asset-shop-cart-title">\u6211\u7684\u5e97\u94fa\u5361\uff1a</div>                     <ul class="mui-mbarp-asset-shop-cart-list">'+t+'</ul><a class="mui-mbar-more mui-mbar-asset-more" href="https://hongbao.alipay.com/coupon/index.htm?scm=1048.1.3.4&sign_from=3000&sign_account_no={{alipayId}}" target="_blank">\u67e5\u770b\u66f4\u591a<b></b></a></div>'},"_renderCashCoupon":function(e){var t=this,i="";if(e&&e.length>0){i="<div class='mui-mbarp-asset-cash-title'>\u8d2d\u7269\u5238 <a href='//pages.tmall.com/wow/jifen/act/guize?scm=1048.1.3.32' target='_blank'><i class='mui-mbar-iconfont mui-mbarp-asset-question'>&#xe620;</i>\u4f7f\u7528\u89c4\u5219</a></div>";a.each(e,function(e){if(e.cls="",e.dilatable=e.dilatable?'<i class="mui-mbarp-asset-cash-dilatable-icon"></i>':"",e.condition="",e.c&&(e.condition+="<p class='mui-mbarp-asset-cash-condition'>\u6ee1"+e.c+"\u5143\u4f7f\u7528</p>"),(e.isMulti||e.isCross)&&(e.condition="",e.isMulti&&(e.condition+=" <p class='mui-mbarp-asset-cash-multi mui-mbarp-asset-cash-p'><i>&#xe623;</i>"+e.isMulti+"</p>"),e.isCross&&(e.condition+=" <p class='mui-mbarp-asset-cash-cross  mui-mbarp-asset-cash-p'><i>&#xe624;</i>"+e.isCross+"</p>")),"\u5373\u5c06\u8fc7\u671f"==e.t){var s=t._getDiffDay(e.l);e.cls+="mui-mbarp-asset-cash-countdown ",e.html="<p  class='mui-mbarp-asset-cash-count'><i class='mui-mbarp-asset-cash-count-icon'>&#xe621;</i>"+s+"\u540e<span class='mui-mbarp-asset-cash-count-timeout'>\u8fc7\u671f</span></p>"}else{var n=e.l?e.l.substr(0,10):"",o=e.s?e.s.substr(0,10):"";e.html="<p class='mui-mbarp-asset-cash-date '>\u6709\u6548\u671f</br>"+o+"</br>-"+n+"</p>"}i+=a.substitute("<div class='mui-mbarp-asset-cash-item {cls}'>                    <div class='mui-mbarp-asset-cash-left'>                    {dilatable}                    <p class='mui-mbarp-asset-cash-money'><i>&yen;</i>{d}</p>                   {condition}                    </div>                    <div class='mui-mbarp-asset-cash-right'>                    {html}                    </div>                    </div>",e)}),i+='<a class="mui-mbar-more mui-mbar-asset-more" href="//taoquan.taobao.com/framework/got_bonus.htm?tabIndex=44&scm=1048.1.3.34" target="_blank">\u67e5\u770b\u66f4\u591a<b></b></a>'}return i},"_renderCash11Coupon":function(e){var t="",i=e.sca,s="",n="";i&&i.tu&&(s=m.replaceSCM(i.tu,"1048.1.3.35")),i&&i.mu&&(n=m.replaceSCM(i.mu,"1048.1.3.37"));var o=e.sc;if(i&&i.bg&&o&&o.length>0){t="<div class='mui-mbarp-asset-cash-title'>"+i.n+"\u8d2d\u7269\u5238 <a href='"+s+"' target='_blank'><i class='mui-mbar-iconfont mui-mbarp-asset-question'>&#xe620;</i>\u4f7f\u7528\u89c4\u5219</a></div>";var r;r=i.text&&i.time?"<div class='mui-mbarp-asset-201611cash-item' style='background-image: url("+i.bg+")'>                      <div class='top'>                      <p class='money'><i>&yen;</i>{d}</p>                      </div>                      <div class='bottom'>                      <p class='text'>"+i.text+"</p>                      <p class='date'>\u6709\u6548\u671f\uff1a"+i.time+"</p>                      </div>                      </div>":"<div class='mui-mbarp-asset-11cash-item' style='background-image: url("+i.bg+")'>                      <div class='left'>                      <p class='money'><i>&yen;</i>{d}</p>                      </div>                      <div class='right'>                      <p class='date '>\u6709\u6548\u671f</br>{s}</br>-{l}</p>                      </div>                      </div>",a.each(o,function(e){t+=a.substitute(r,e)}),t+='<a class="mui-mbar-more mui-mbar-asset-more" href="'+n+'" target="_blank">\u67e5\u770b\u66f4\u591a<b></b></a>'}return t},"_render":function(e){function t(a,e){var t="";return t+=['<div class="mui-mbarp-asset-wrap">',p.join(""),v.join(""),C.join(""),g.join(""),f.join(""),E,I,'<div class="mui-mbarp-asset-coupon">',"{{#with c}}"].join(""),e||a?(t+=['<div class="mui-mbarp-asset-line-h"></div>','<div class="mui-mbarp-asset-coupon-title" id="mbarCouponAnchorAbleCoupon">',"\u53ef\u7528\u4f18\u60e0\u5238","</div>",'<div class="mui-mbarp-asset-coupon-bd j_mui-mbarp-asset-cur-coupon">'].join(""),a&&(t+=["{{#each m}}",_,"{{/each}}"].join("")),e&&(t+=["{{#each l}}",h.join(""),"{{/each}}"].join("")),t+='<div class="mui-mbarp-asset-shop-push-items j_pushShopItems"></div>'):t+='<div class="mui-mbarp-asset-coupon-bd j_mui-mbarp-asset-cur-coupon">',t+=["</div>",'<div class="mui-mbarp-asset-coupon-title" id="mbarCouponAnchorCouldCoupon">&nbsp;',"</div>","{{#if j_len}}",'<div class="mui-mbarp-asset-coupon-title" id="mbarCouponAnchorExpCoupon">',"\u5373\u5c06\u8fc7\u671f\u4f18\u60e0\u5238","</div>","{{/if}}",'<div class="mui-mbarp-asset-coupon-bd j_mui-mbarp-asset-exp-coupon">',"{{#each j}}",h.join(""),"{{/each}}","{{#if j_len}}",'<a class="mui-mbar-more mui-mbar-asset-more" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1048.1.3.16#failcoupon" target="_blank">',"\u67e5\u770b\u66f4\u591a<b></b>","</a>","{{/if}}","</div>","{{#if o_len}}",'<div class="mui-mbarp-asset-coupon-title">',"\u6211\u9886\u53d6\u7684\u4f18\u60e0\u5238","</div>","{{/if}}",'<div class="mui-mbarp-asset-coupon-bd j_mui-mbarp-asset-oth-coupon">',"{{#each o}}","{{#if xindex<10}}",h.join(""),"{{/if}}","{{/each}}","{{#if o_len}}",'<a class="mui-mbar-more mui-mbar-asset-more" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1048.1.3.17" target="_blank">',"\u67e5\u770b\u66f4\u591a<b></b>","</a>","{{/if}}","</div>","{{#if g_len}}",'<div class="mui-mbarp-asset-coupon-title">',"\u5546\u5bb6\u8d60\u9001\u7684\u4f18\u60e0\u5238","</div>","{{/if}}",'<div class="mui-mbarp-asset-coupon-bd j_mui-mbarp-asset-oth-coupon">',"{{#each g}}","{{#if xindex<3}}",h.join(""),"{{/if}}","{{/each}}","{{#if g_len}}",'<a class="mui-mbar-more mui-mbar-asset-more" href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1048.1.3.6" target="_blank">',"\u67e5\u770b\u66f4\u591a<b></b>","</a>","{{/if}}","</div>","{{/with}}","</div>","</div>"].join("")}var i=this,s=i.mallbarItem=i.get(r.K.MALLBAR_ITEM),n=s.get(r.K.MALLBAR),o=i.get(r.K.CONTAINER),c=e.d;c.alipayId=e.alipayId?e.alipayId:"",l.addCommand("formatInteral",function(a,e){return i._formatInteral(e.fn(a))});var u=['<a href="//taoquan.taobao.com/framework/got_bonus.htm?tabIndex=44&scm=1048.1.3.33" target="_blank">','<div class="mui-mbarp-asset-item-wrap mui-mbarp-asset-shop-card-wrap">','<div class="value">',e.d.c.ca?e.d.c.ca:"-","</div>",'<div class="text">',"\u8d2d\u7269\u5238","</div>","</div>","</a>"].join("");e.d.c.sca&&e.d.c.sca.n&&e.d.c.sca.mu&&(u=['<a href="',m.replaceSCM(e.d.c.sca.mu,"1048.1.3.36"),'" target="_blank">','<div class="mui-mbarp-asset-item-wrap mui-mbarp-asset-shop-card-wrap">','<div class="value">',e.d.c.sca.av?"&yen"+e.d.c.sca.av:"-","</div>",'<div class="text">',e.d.c.sca.n,"</br>\u8d2d\u7269\u5238","</div>","</div>","</a>"].join(""));var b=['<a href="//f.alipay.com/moonlight/channel.htm?scm=1048.1.3.38" target="_blank" id="J_MallbarHB">','<div class="mui-mbarp-asset-item-wrap mui-mbarp-asset-hua-wrap ',"mui-mbarp-asset-three-wrap",'">','<div class="value">',"-","</div>",'<div class="text">\u82b1\u5457</div>',"</div>","</a>","</div>"].join(""),p=['<div class="mui-mbarp-asset-overview mui-mbarp-clearfix">','<a href="//vip.tmall.com/point/all?scm=1048.1.3.19" target="_blank">','<div class="mui-mbarp-asset-item-wrap mui-mbarp-asset-top-block mui-mbarp-asset-integral-wrap">','<div class="mui-mbarp-asset-coupon-value">',i.getIntegral(),"</div>",'<div class="mui-mbarp-asset-coupon-text">\u79ef\u5206</div>',"</div>","</a>",'<a href="//taoquan.taobao.com/framework/got_bonus.htm?scm=1048.1.3.18" target="_blank">','<div class="mui-mbarp-asset-item-wrap mui-mbarp-asset-top-block mui-mbarp-asset-coupon-wrap">','<div class="mui-mbarp-asset-coupon-value">',"{{#with c}}{{a}}{{/with}}","</div>",'<div class="mui-mbarp-asset-coupon-text">\u4f18\u60e0\u5238</div>',"</div>","</a>",'<a href="https://marketingop.taobao.com/cashHongbao.htm?scm=1048.1.3.39" target="_blank">','<div class="mui-mbarp-asset-item-wrap mui-mbarp-asset-top-block mui-mbarp-asset-bonus-wrap">','<div class="mui-mbarp-asset-bonus-value">',"{{#with cashRed}}",'<span class="mui-mbarp-asset-bonus-yen">&yen;</span>',"{{#if d}}{{d}}{{/if}}","{{^if d}}0{{/if}}","{{/with}}","</div>",'<div class="mui-mbarp-asset-bonus-text">\u7ea2\u5305({{#with cashRed}}{{a}}{{/with}})</div>',"</div>","</a>",'<a href="https://hongbao.alipay.com/coupon/index.htm?scm=1048.1.3.20&sign_from=3000&sign_account_no={{alipayId}}" target="_blank">','<div class="mui-mbarp-asset-item-wrap mui-mbarp-asset-bonus-wrap with-border-right">','<div class="value">',"{{#with b}}",'<span class="mui-mbarp-asset-bonus-yen">&yen;</span>',"{{#if d}}{{d}}{{/if}}","{{^if d}}0{{/if}}","{{/with}}","</div>",'<div class="text">\u652f\u4ed8\u5b9d</br>\u7ea2\u5305({{#with b}}{{a}}{{/with}})</div>',"</div>","</a>",u,b,"{{#with p}}{{#if e}}",'<div class="mui-mbarp-asset-tips">',"{{#formatInteral}}{{e}}{{/formatInteral}}\u5929\u732b\u79ef\u5206\u4e8e{{d}}\u8fc7\u671f",'<span class="mui-mbarp-assets-tips-arrow">\u25c6</span>',"</div>","{{/if}}{{/with}}","<p>"+i.assetTips+"</p>"],g=["{{#if cashRed.l.length}}","<div class='mui-mbarp-asset-cash-title'>\u7ea2\u5305 </div>","{{/if}}",'<div class="mui-mbarp-asset-bonus">',"{{#with cashRed}}","{{#each l}}","{{#if xindex<3}}",'<a href="https://marketingop.taobao.com/cashHongbao.htm?scm=1048.1.3.39" target="_blank">','<div class="mui-mbarp-asset-bonus-item tm-bonus-item mui-mbarp-clearfix">','<div class="mui-mbarp-asset-tm-bonus-item-right">','<p class="mui-mbarp-asset-bonus-item-rmb">&yen;<span class="rmb">{{sp}}</span></p>','<p class="text" title="{{rule||source}}">{{rule||source}}</p>','<p class="date">\u6709\u6548\u671f\uff1a{{s}}</p>','<p class="date-end">~ {{l}}</p>',"</div>","</div>","</a>","{{/if}}","{{/each}}","{{/with}}","{{#with cashRed}}","{{#if a>0}}",'<a class="mui-mbar-more mui-mbar-asset-more" href="https://marketingop.taobao.com/cashHongbao.htm?scm=1048.1.3.39" target="_blank">',"\u67e5\u770b\u66f4\u591a<b></b>","</a>","{{/if}}","{{/with}}","</div>"],f=["{{#if b.l.length}}","<div class='mui-mbarp-asset-cash-title'>\u652f\u4ed8\u5b9d\u7ea2\u5305 </div>","{{/if}}",'<div class="mui-mbarp-asset-bonus">',"{{#with b}}","{{#each l}}","{{#if xindex<3}}",'<a href="https://hongbao.alipay.com/coupon/index.htm?scm=1048.1.3.4&sign_from=3000&sign_account_no={{alipayId}}" target="_blank">','<div class="mui-mbarp-asset-bonus-item mui-mbarp-clearfix">','<div class="mui-mbarp-asset-bonus-item-left">','<p class="mui-mbarp-asset-bonus-item-rmb">&yen;<span class="rmb">{{d}}</span></p>','<p class="mui-mbarp-asset-coupon-item-surplus">\u5269\u4f59\uff1a<span class="yen">&yen;</span>{{sp}}</p>',"</div>",'<div class="mui-mbarp-asset-bonus-item-right">',"<p>\u6709\u6548\u671f</p>","<p>{{s}}</p>","<p>-&nbsp;{{l}}</p>","</div>","</div>","</a>","{{/if}}","{{/each}}","{{/with}}","{{#with b}}","{{#if a>0}}",'<a class="mui-mbar-more mui-mbar-asset-more" href="https://hongbao.alipay.com/coupon/index.htm?scm=1048.1.3.4&sign_from=3000&sign_account_no={{alipayId}}" target="_blank">',"\u67e5\u770b\u66f4\u591a<b></b>","</a>","{{/if}}","{{/with}}","</div>"],h=['<a class="mui-mbarp-asset-coupon-item mui-mbarp-asset-coupon-{{#if d>=0&&d<=20}}blue{{/if}}{{#if d>20&&d<=50}}red{{/if}}{{#if d>50}}yellow{{/if}} ','{{#if a>1}}mui-mbarp-asset-coupon-{{#if d>=0&&d<=20}}blue{{/if}}{{#if d>20&&d<=50}}red{{/if}}{{#if d>50}}yellow{{/if}}-multi{{/if}}" href="{{^if curCoupon}}{{u}}" target="_blank"{{else}}javascript:;"{{/if}}>','<div class="mui-mbarp-asset-coupon-border-top"></div>','<div class="mui-mbarp-asset-coupon-item-content">','<p class="mui-mbarp-asset-coupon-item-hd">','<span class="mui-mbarp-asset-coupon-item-tips ','{{#if t==="\u5373\u5c06\u8fc7\u671f"}}mui-mbarp-asset-coupon-item-tips-will_expire{{/if}}" >','{{#if t==="\u5373\u5c06\u8fc7\u671f"}}',"<span >","<b>{{diffDay}}</b>\u540e\u8fc7\u671f</span>","{{else}}","{{t}}{{/if}}","</span>",'<span class="mui-mbarp-asset-coupon-item-name" title="{{n}}"> ',"{{#if f}}",'<span class="mui-mbarp-asset-tmgj-flag "> </span>',"{{/if}}","{{nt}}</span>","</p>",'<div class="mui-mbarp-asset-coupon-item-bd mui-mbarp-clearfix">','<div class="mui-mbarp-asset-coupon-item-bd-right">','{{#if t==="\u5373\u5c06\u8fc7\u671f"}}'," ","{{else}}","<p>{{s}}</p>","<p>-&nbsp;{{l}}</p>","{{/if}}","</div>",'<div class="mui-mbarp-asset-bonus-item-left">','<p class="mui-mbarp-asset-coupon-item-rmb">','{{currencyUnit||"\uffe5"}}<span class="mui-mbarp-asset-coupon-item-rmb-rmb ','{{#if d>999}}mui-mbarp-asset-coupon-item-rmb-demotion{{/if}}">{{d}}</span>','{{#if a>1}} <span class="mui-mbarp-asset-coupon-x">x</span> <span class="mui-mbarp-asset-coupon-item-rmb-multi">{{a}}\u5f20</span>{{/if}}',"</p>",'<p class="mui-mbarp-asset-coupon-item-condition">\u6ee1{{c}}\u4f7f\u7528{{#if (!siteRegionName||siteRegionName==="\u5168\u56fd")&&i===1}}</br>(\u90e8\u5206\u5546\u54c1\u53ef\u7528){{/if}}</p>','{{#if siteRegionName&&siteRegionName!=="\u5168\u56fd"}}','<p class="mui-mbarp-asset-coupon-item-region" title="{{siteRegionName}}">\u9650\u533a\u57df\u4f7f\u7528<i class="mui-mbarp-asset-coupon-item-region-icon">&#xe622;</i></p>','<div class="mui-mbarp-asset-coupon-item-region-tip"> {{siteRegionName}}<div class="mui-mbarp-asset-coupon-item-region-tip-arr">\u25c6</div></div>',"{{/if}}","{{#if channel===3}}",'<p class="mui-mbarp-asset-coupon-item-channel">\u624b\u673a\u5929\u732b\u4e13\u4eab</p>',"{{/if}}","{{#if channel===2}}",'<p class="mui-mbarp-asset-coupon-item-channel">\u65e0\u7ebf\u4e13\u4eab</p>',"{{/if}}","</div>","</div>","</div>",'<div class="mui-mbarp-asset-coupon-border-bottom"></div>',"</a>"],_=['<a class="mui-mbarp-asset-coupon-item mui-mbarp-asset-member-coupon-item " href="javascript:;">','<p class="mui-mbarp-asset-member-coupon-item-title">{{n}}</p>','<p class="mui-mbarp-asset-member-coupon-item-iconp" ><span class="mui-mbarp-asset-member-coupon-item-icon">',"{{#if v}}",'<i class="mui-mbar-iconfont mui-mbarp-asset-memberCouponBubble-heart">&#xe600;</i>',"{{/if}}","{{r}}</span></p>",'<p class="mui-mbarp-asset-member-coupon-item-trmb" title="\uffe5{{cm}}\u73b0\u91d1\u5238"><span class="mui-mbarp-asset-member-coupon-item-rmb">\uffe5</span> <span class="mui-mbarp-asset-member-coupon-item-rmbn">{{cm}}</span><span>\u73b0\u91d1\u5238</span></p>','<p class="mui-mbarp-asset-member-coupon-item-time">\u6d3b\u52a8\u65f6\u95f4:{{t}}</p>',"</a>",'<div class="mui-mbarp-asset-coupon-border-bottom mui-mbarp-asset-member-coupon-item-border">',"</div>"].join(""),v=[];if(e.assetActBannerList&&e.assetActBannerList.length>0){var A=['<div class="mui-mbarp-asset-tmall-bao"><a class="mui-mbarp-asset-tmall-bao-link" href="{url}" target="_blank">','<img src="{pic}"/>',"</a></div>"].join("");a.each(e.assetActBannerList,function(e){e.url=m.replaceSCM(e.url,"1048.1.3.29"),v.push(a.substitute(A,e))})}var C=[];e.cashCardBanner&&(i.cashCardBanner=e.cashCardBanner,C=['<div class="mui-mbarp-asset-tmall-bao mui-mbar-cashcard-get">','<img src="'+e.cashCardBanner+'"/>',"</div>"]);n.get("closeSaleNum");e.inShowTime;var T="";!e.notNeedShopCard&&e.shopCard&&e.shopCard.list&&(T=i._renderShopCard(e.shopCard.list));var I="",E="";c&&c.c&&c.c.c&&(I=i._renderCashCoupon(c.c.c)),c&&c.c&&c.c.sca&&c.c.sc&&(E=i._renderCash11Coupon(c.c));var B="";if(0==c.c.l.length&&0==c.c.j.length&&0==c.c.o.length&&0==c.c.m)B=['<div class="mui-mbarp-asset-wrap">',p.join(""),v.join(""),C.join(""),g.join(""),f.join(""),E,I,T,'<div class="mui-mbarp-asset-coupon-bd j_mui-mbarp-asset-cur-coupon">',"</div>",'<div class="mui-mbarp-asset-coupon-title" id="mbarCouponAnchorCouldCoupon">&nbsp;',"</div>",'<h2 class="mui-mbar-asset-no-coupon">\u55b5\uff01\u4f60\u8fd8\u6ca1\u9886\u53d6\u8fc7\u5929\u732b\u4f18\u60e0\u5238\uff01<br />\u5feb\u53bb\u9886\u53d6\u5427\uff01</h2>',"</div>"];else{a.each(c.c.l,function(a){a.u=d(a.u,"1048.1.3.2"),a.curCoupon=!0,a.diffDay=i._getDiffDay(a.l),a.nt=a.n,a.f&&(a.nt=m.sub(a.n,14))}),a.each(c.c.j,function(a){a.u=d(a.u,"1048.1.3.5"),a.diffDay=i._getDiffDay(a.l),a.nt=a.n,a.f&&(a.nt=m.sub(a.n,19))}),a.each(c.c.o,function(a){a.u=d(a.u,"1048.1.3.3"),a.diffDay=i._getDiffDay(a.l),a.nt=a.n,a.f&&(a.nt=m.sub(a.n,14))}),a.each(c.c.g,function(a){a.u=d(a.u,"1048.1.3.6"),a.diffDay=i._getDiffDay(a.l),a.nt=a.n,a.f&&(a.nt=m.sub(a.n,14))}),a.each(c.c.m,function(a){a.u=d(a.u,"1048.1.3.6"),a.diffDay=i._getDiffDay(a.l)});B=t(c.c.m?c.c.m.length:0,c.c.l?c.c.l.length:0)}c.b&&(c.b_l_len=0,a.each(c.b,function(a,e){"number"!=typeof a&&"l"==e&&(c.b_l_len=a.length)})),c.c&&(c.j_len=0,c.o_len=0,c.l_len=0,c.g_len=0,c.m_len=0,c.ableShow=0,a.each(c.c,function(a,e){if("number"!=typeof a)switch(e){case"j":c.j_len=a.length;break;case"l":c.l_len=a.length;break;case"o":c.o_len=a.length;break;case"g":c.g_len=a.length;break;case"m":c.m_len=a.length}})),a.isArray(B)&&(B=B.join("")),c.cashRed&&c.cashRed.l&&c.cashRed.l.length&&a.each(c.cashRed.l,function(a){a.s=a.s.slice(2),a.l=a.l.slice(2)});var L=new l(B).render(c);o.html(L),i._initGetCashCardEvent();var S=a.one("#"+i.get(r.K.COUPON_ANCHOR));if(S){var O=S.offset().top-S.height()-10-a.one(window).scrollTop();o.scrollTop(O),i.set(r.K.COUPON_ANCHOR,"")}var R=o.one(".mui-mbar-asset-no-coupon");R&&m.getStaticConf({"cb":function(a){a.showZeroCoupon&&R.html(m.fm('{0} <a class="mui-mbarp-asset-getCoupon" href="{1}" target="_blank">\u7acb\u5373\u9886\u53d6</a>',a.zeroCouponTxt,a.zeroCouponUrl))}})},"cutStr":function(a,e){return a?(a=a.replace(/<a[^>]*?>([\w\W]+)<\/a>/gi,"$1"),a.length<=e?a:a.substr(0,e)+"..."):""},"getIntegral":function(){var e=this,t=e.get(r.K.MALLBAR_ITEM),i=t.getUserInfo(),s=i.memberInfo.availablePoints;return s=a.isNumber(s)?s:r.DEGRADE,s==r.DEGRADE?"-":e._formatInteral(s)},"now":function(){return this.get(r.K.MALLBAR_ITEM).getServerTime()},"_getDiffDay":function(a){if(a){var e,t,i,s,n=this;if(e=a.replace(/\./g,"/"),t=new Date(e),i=new Date(n.dateFormat(n.now(),"yyyy/MM/dd")),(s=parseInt(Math.abs(t-i)/1e3/60/60/24,10))>0)return s+1+"\u5929";var o=parseInt(Math.abs(t-n.now())/1e3/60/60)+1,r="\u7a0d";return o>0&&(r=o+"\u5c0f\u65f6"),r}},"_formatInteral":function(a){if("NaN"==typeof(a=Number(a)))throw Error("\u53c2\u6570\u7c7b\u578b\u9519\u8bef\uff0c\u8bf7\u4f20\u5165\u6570\u503c\u7c7b\u578b\u7684\u53c2\u6570");return a>=1e6?parseInt(a/1e6,10)+"00\u4e07+":a>=1e7?parseInt(a/1e7,10)+"000\u4e07+":a},"_couponTemp":new l(['<a style="height:0; overflow: hidden;" class="mui-mbarp-asset-coupon-item mui-mbarp-asset-coupon-{{#if d>=0&&d<=20}}blue{{/if}}{{#if d>20&&d<=50}}red{{/if}}{{#if d>50}}yellow{{/if}} ','{{#if a>1}}mui-mbarp-asset-coupon-{{#if d>=0&&d<=20}}blue{{/if}}{{#if d>20&&d<=50}}red{{/if}}{{#if d>50}}yellow{{/if}}-multi{{/if}}" href="javascript:;" >','<div class="mui-mbarp-asset-coupon-border-top"></div>','<div class="mui-mbarp-asset-coupon-item-content">','<p class="mui-mbarp-asset-coupon-item-hd">','<span class="mui-mbarp-asset-coupon-item-tips ">',"{{t}}</span>",'<span class="mui-mbarp-asset-coupon-item-name" title="{{n}}">',"{{#if f}}",'<span class="mui-mbarp-asset-tmgj-flag "> </span>',"{{/if}}","{{nt}}</span>","</p>",'<div class="mui-mbarp-asset-coupon-item-bd mui-mbarp-clearfix">','<div class="mui-mbarp-asset-coupon-item-bd-right">',"<p>{{s}}</p>","<p>-&nbsp;{{l}}</p>","</div>",'<div class="mui-mbarp-asset-bonus-item-left">','<p class="mui-mbarp-asset-coupon-item-rmb">','{{currencyUnit||"\uffe5"}}<span class="mui-mbarp-asset-coupon-item-rmb-rmb ','{{#if d>999}}mui-mbarp-asset-coupon-item-rmb-demotion{{/if}}">{{d}}</span>','{{#if a>1}} <span class="mui-mbarp-asset-coupon-x">x</span> <span class="mui-mbarp-asset-coupon-item-rmb-multi">{{a}}\u5f20</span>{{/if}}',"</p>",'<p class="mui-mbarp-asset-coupon-item-condition">\u6ee1{{c}}\u4f7f\u7528{{#if (!siteRegionName||siteRegionName==="\u5168\u56fd")&&i===1}}</br>(\u90e8\u5206\u5546\u54c1\u53ef\u7528){{/if}}</p>','{{#if siteRegionName&&siteRegionName!=="\u5168\u56fd"}}','<p class="mui-mbarp-asset-coupon-item-region" title="{{siteRegionName}}">\u9650\u533a\u57df\u4f7f\u7528<i class="mui-mbarp-asset-coupon-item-region-icon">&#xe622;</i></p>','<div class="mui-mbarp-asset-coupon-item-region-tip"> {{siteRegionName}}<div class="mui-mbarp-asset-coupon-item-region-tip-arr">\u25c6</div></div>',"{{/if}}","{{#if channel===3}}",'<p class="mui-mbarp-asset-coupon-item-channel">\u624b\u673a\u5929\u732b\u4e13\u4eab</p>',"{{/if}}","{{#if channel===2}}",'<p class="mui-mbarp-asset-coupon-item-channel">\u65e0\u7ebf\u4e13\u4eab</p>',"{{/if}}","</div>","</div>","</div>",'<div class="mui-mbarp-asset-coupon-border-bottom"></div>',"</a>"].join("")),"_assetCouponBubbleTPL":function(a){var e;return e='<div class="j_Asset_Bubble mui-mbarp-asset-coludCouponBubble-content mui-mbar-bubble">',e+='<div class="mui-mbar-arr mui-mbar-bubble-arr">\u25c6</div>',e+='<div class="mui-mbar-bubble-close"></div>',e+='<div class="mui-mbarp-asset-bubble-top"></div>',e+=a,e+='<div class="mui-mbarp-asset-bubble-bottom"></div>',e+="</div>"},"_initHuaBei":function(){var a=this;m.getStaticConf({"cb":function(e){a.hbWord=e.hbWord||"\u82b1\u5457",a._ajaxHuaBei()}})},"_ajaxHuaBei":function(){var e=this,t=(e.mallbarItem=e.get(r.K.MALLBAR_ITEM),e.get(r.K.CONTAINER));a.getScript("//g.alicdn.com/mtb/lib-mtop/2.4.11/mtop.js",{"success":function(){lib.mtop.config.prefix="h5api",lib.mtop.config.subDomain="m",lib.mtop.config.mainDomain="tmall.com",lib.mtop.request({"api":"com.taobao.mtop.login.getClientTrustLoginUrl","v":"1.0","dataType":"jsonp","ecode":"1","isSec":"1","data":{"redirectUrl":"https://huabei.alipay.com/wap/moonlight/sign.htm","to":"alipay"}},function(i){var s=i.data.trustLoginUrl,r=new n(s).getQuery().get(),l="https://pcreditweb.alipay.com/h5/ajax/openapi/taobao/queryHuabei.json";l+="?_args=",l+=o.stringify([{"bizScenario":"tmall-mallbar"}]),l+="&token=",l+=r.token,l+="&domain=",l+=r.domain,l+="&actionType=",l+=r.actionType,m.ajax({"url":l,"timeout":4,"jsonpCallback":"__mallbarGetHuaBei","success":function(i){if(i&&i.success&&i.extInfos){var s=i;s.extInfos&&"F"==s.extInfos.signed?a.available("J_MallbarHB",function(){var a='<span class="mui-mbarp-hb-tip">\u5f00\u901a&nbsp'+e.hbWord+"</span>";t.one(".mui-mbarp-asset-hua-wrap").one(".value").html(a)}):s.extInfos&&"T"==s.extInfos.signed&&a.available("J_MallbarHB",function(){var a='<span class="mui-mbarp-asset-bonus-yen">\xa5</span>'+s.extInfos.availableAmount;t.one(".mui-mbarp-asset-hua-wrap").one(".value").html(a)})}},"error":function(){}})})}})},"_initGetCashCardEvent":function(){var e=this,t=e.mallbarItem=e.get(r.K.MALLBAR_ITEM),i=t.get(r.K.MALLBAR),s=e.get(r.K.CONTAINER);e.cashCardBanner&&(a.config({"packages":{"mui/zebra-guaguaka-detail-pc":{"debug":!0,"ignorePackageNameInUri":!0,"version":"3.0.12","path":"//g.alicdn.com/mui/zebra-guaguaka-detail-pc/3.0.12/","group":"tm"}}}),a.getScript("//g.alicdn.com/mtb/lib-mtop/1.6.4/mtop.js"),s.delegate("click",".mui-mbar-cashcard-get",function(){a.use("mui/zebra-guaguaka-detail-pc/index-pc,mui/zebra-guaguaka-detail-pc/index-pc.css",function(a,e){new e;i.collapse({"status":2})})}))}}),p},{"requires":["base","node","anim","event","uri","json","mui/mallbar/conf","mui/mallbar/util","xtemplate","mui/mallbar/store","mui/mallbar/plugin-asset.css"]});KISSY.add("mui/mallbar/plugin-brand",function(a,e,t,i,s,n){var o=function(a){var e=this;e.showCoupon=!1,o.superclass.constructor.call(e,a),e.init()},r='<a class="mui-mbar-brand-more" href="//mybrand.tmall.com/?scm=1048.1.4.26" target="_blank">\u67e5\u770b\u66f4\u591a<b></b></a>';return a.extend(o,e,{"init":function(){function e(){c.get(i.K.DATA);p=!1,n()}function n(){s.ajax({"url":"//ald.taobao.com/recommend.htm?appId=201509140","data":{},"jsonpCallback":"_mallbarBrandInfo","timeout":4,"success":function(e){function n(e){var i=e.data,n=i.length;return html="",a.each(i,function(i,o){o==n-1&&(i.lastItem=!0),e.flag&&(i[e.flag]=!0),i.url=s.replaceSCM(i.url,e.shop),i.logo=i.logo+"_180x90",i.items&&a.each(i.items,function(a,t){i.items[t].isOdd=""+t%2,i.items[t].url=s.replaceSCM(i.items[t].url,e.item),i.items[t].img=i.items[t].img+"_100x100",i.items[t].tag201511=a.tag201511&&b.tag201511Time}),html+=new t(d).render(i)}),html}var o="",l="",u="",d=['<div class="item">','<img class="logo" src="{{logo}}">','<a class="shop" href="{{url}}" target="_blank">\u8fdb\u5165\u5e97\u94fa</a>','<div class="goodsList">',"{{#each items}}",'<a class="goods border-{{isOdd}}" href="{{url}}" target="_blank">','<img src="{{img}}">','<p class="price" title="&yen;{{price}}">&yen;{{price}}</p>',"{{#if tag201511}}",'<span class="mui-mbarp-11-flag top"></span>',"{{/if}}","</a>","{{/each}}","</div>","</div>","{{#if !lastItem}}",'<div class="mui-mbarp-brand-line"></div>',"{{/if}}"].join("");if(!e)return c.fire(i.E.ERROR);if(!!e.acurl&&s.sendLog(e.acurl),!e.follow&&!e.rec)return c.fire(i.E.ERROR);if(e.follow&&e.follow.length>0){var g=e.follow;u=['<div class="mui-mbarp-brand-my mui-mbarp-brand-block">','<p class="title"></p>','<div class="mui-mbarp-brand-line-first"></div>'].join(""),u+=n({"data":g,"flag":"my","shop":"1048.1.4.22","item":"1048.1.4.23"}),u+="</div>",e.rec&&e.rec.length||(u+=r)}if(e.rec&&e.rec.length>0){var f=e.rec;l=['<div class="mui-mbarp-brand-recommend mui-mbarp-brand-block">','<p class="title">\u731c\u4f60\u559c\u6b22\u7684\u54c1\u724c</p>','<div class="mui-mbarp-brand-line-first"></div>'].join(""),l+=n({"data":f,"flag":"rec","shop":"1048.1.4.24","item":"1048.1.4.25"}),l+="</div>",l+=r}o=u+l,m.html(o),p=!1},"jsonpCallback":"__mallbarBrand","error":function(){c.fire(i.E.ERROR)}})}function o(){c.get(i.K.MALLBAR).getCueMsgInfo(function(e){if(a.log(e),200!=e.s)return!1;l.token=e.t,e.bmc&&e.bmc.u?(e.bmc.action=e.bmc.a||"\u7acb\u5373\u67e5\u770b",e.bmc.word=e.bmc.t||"",e.bmc.url=e.bmc.u,l.handBrandMemberBubble(e.bmc)):e.mz&&e.mz.url&&l.handTryBubble(e.mz)})}var l=this;l.isAjaxMemberRight=!1;var m=l.get(i.K.CONTAINER),c=l.mallbarItem=l.get(i.K.MALLBAR_ITEM),u=s.getSysId();l.isList="list"==u,l.isDetail="detail"==u,l.isShop="shop"==u,l.isAjaxMemberRight=l.isList;var b=c.get(i.K.MALLBAR);l.brandId=b.get("brandId")||"";var d=l.userInfo=c.getUserInfo();l.token="",l.bubbled=!1,d.isLogin?o():c.on(i.E.LOGIN_SUCCESS,function(a){s.log(a.type),o()});var p=!0;l.on(i.E.VISIBILITY_CHANGE,function(a){a.visible&&p&&(c.fire(i.E.SUPTIP_CHANGE,{"show":!1}),e())}),l.on(i.E.DATA_CHANGE,function(a){p=!0,c.get(i.K.EXPAND)&&e()})},"handTryBubble":function(a){var e=this;if(a.url){var t={},n=s.getSysId();a=a||{},a.word="\u5feb\u6765\u9886\u53d6\u60a8\u7684\u4e13\u5c5e\u8bd5\u7528\u88c5\u54e6\uff01",a.action="\u7acb\u5373\u67e5\u770b",t.data=a,t.scm="1048.1.4.20",t.key="mui/mbarp/brand/mz/tryBubble",t.flag=5.2,t.show=function(){s.sendLog(i.ARR["BRAND_MZ_TRY_BUBBLE_SHOW"+(n?"_"+n.toUpperCase():"")]),s.sendLog(i.ARR.BRAND_MZ_TRY_BUBBLE_SHOW_ALL)},t.click=function(){s.sendLog(i.ARR["BRAND_MZ_TRY_BUBBLE_CLICK"+(n?"_"+n.toUpperCase():"")]),s.sendLog(i.ARR.BRAND_MZ_TRY_BUBBLE_CLICK_ALL)},e.handleBubble(t)}},"handBrandMemberBubble":function(a){var e=this,t={};a.url&&(t.data=a,t.scm="1048.1.4.20",t.key="mui/mbarp/brand/bm/brandMemberBubble",t.flag=5.2,e.handleBubble(t))},"handleBubble":function(e){var t=e.data||{},o='<div class="mui-mbarp-brand-mz-bubble mui-mbar-bubble"><div class="mui-mbar-arr mui-mbar-bubble-arr ">\u25c6</div><div class="mui-mbarp-asset-bubble-top"></div><div class="mui-mbarp-brand-mz-bubble-content"><p> Hi\uff0c{nick}</p><p> {word}</p><p class="mui-mbarp-brand-mz-bubble-click"><a href="{url}" target="_blank">{action}</a></p></div><div class="mui-mbarp-asset-bubble-bottom"></div></div>',r=this,l=r.mallbarItem,m=l.get(i.K.MALLBAR),c=l.getUserInfo();t.nick="",!!c.nick&&(t.nick=s.sub(c.nick,13)),t.url=s.addSCM(t.url,e.scm);var u=a.substitute(o,t);n.get({"k":e.key+l.getUid(),"success":function(a){a||m.bubble({"show":!0,"content":u,"customContentType":3,"bubbleType":0,"isNotTabFire":!1,"tab":"BRAND","flag":e.flag,"showed":function(){e.show&&e.show(),s.sendLog(i.ARR.BRAND_BRAND_VIP_BUBBLE_SHOW)},"clicked":function(){e.click&&e.click(),s.sendLog(i.ARR.BRAND_BRAND_VIP_BUBBLE_CLICK),l.fire(i.E.BUBBLE_CHANGE,{"show":!1}),n.set({"k":e.key+l.getUid(),"v":1,"expires":1})}})}})}}),o},{"requires":["base","xtemplate","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","mui/mallbar/plugin-brand.css"]});KISSY.add("mui/mallbar/plugin-live",function(a,e,t,i,n,o,s,r,m){var l=(window.location.href.indexOf("mbar-debug=1"),function(a){var e=this;l.superclass.constructor.call(e,a),e.init()}),c=['<div class="mui-mbarp-live-msgs"></div>','<div class="mui-mbarp-live-load"></div>','<div class="mui-mbarp-live-more"><span class="mui-mbarp-live-add">+</span>\u67e5\u770b\u66f4\u591a<span class="mui-mbar-iconfont"></span></div>','<div class="mui-mbarp-live-more-nomsg">\u55b5\uff0c\u5df2\u7ecf\u662f\u6700\u540e\u7684\u6d88\u606f\u54af\uff01\uff01</div>'].join(""),u="mui/mallbar/live/show",b="",d=new n(["{{#each msgs}}",'<div class="mui-mbarp-live-msg {{#if d11}}mui-mbarp-live-msg-d11{{/if}}">',"  {{#if src}}",'  {{#if link}}<a target="_blank" href="{{link}}">{{/if}}','  <img class="mui-mbarp-live-img" src="{{src}}" title="{{desc}}"/>',"  {{#if link}}</a>{{/if}}","  {{/if}}",'  <div class="mui-mbarp-live-title {{#if src===""&&d11}}mui-mbarp-live-title-noimg{{/if}}">','    <a class="mui-mbarp-live-title-h" target="{{#if link}}_blank{{else}}_self{{/if}}" href="{{#if link}}{{link}}{{else}}javascript:;{{/if}}" title="{{t}}"> {{title}} </a>','    {{#if content}}<div class="mui-mbarp-live-content">{{{content}}}</div>{{/if}}',"  </div>","</div>","{{/each}}"].join("")),p=new n(["{{#each msgs}}",'<div class="mui-mbarp-live-msg-small"><a href="{{link}}" ><img src="{{src}}" class="mui-mbarp-live-msg-small-img"><div class="mui-mbarp-live-msg-small-desc"><p class="mui-mbarp-live-msg-small-title" title="{{title}}">{{title}}</p><p class="mui-mbarp-live-small-content" title="{{content}}">{{content}}</p></div></a></div>',"{{/each}}"].join("")),f=new n(['<div class="mui-mbar-bubble mui-mbarp-bubble-live-act">','<div class="mui-mbar-arr mui-mbarp-bubble-live-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-live-bubble-act-close"></div>','<div class="mui-mbarp-bubble-live-act-bd">',"  {{#if i}}",'  {{#if u}}<a target="_blank" href="{{u}}">{{/if}}','  <img class="mui-mbarp-live-bubble-img" src="{{i}}" title="{{t}}"/>',"  {{#if u}}</a>{{/if}}","  {{/if}}",'  <div class="mui-mbarp-live-msg-bubble-act-title  {{#if i===""&&d11}}mui-mbarp-live-msg-bub-title-noimg{{/if}}">','    {{#if u}}<a target="_blank" href="{{u}}" title="{{t}}">{{/if}}',"    {{title}} ","    {{#if u}}</a>{{/if}}","  </div>","</div>","</div>","</div>"].join("")),g=!0;return a.extend(l,e,{"init":function(){var a=this;r.getStaticConf({"cb":function(e){var t=a.get(s.K.CONTAINER),i=a.get(s.K.MALLBAR_ITEM),n=i.get(s.K.MALLBAR),o=i.get(s.K.TAB),r=o.one(".mui-mbar-tab-sup");a.tip=r;var m=i.getUserInfo(),l=i.get(s.K.DATA),c=n.get(s.K.MODEL),u=(c.get(s.K.BAR),o.one(".mui-mbar-tab-logo")),b=i.get(s.K.DATA),d=o.one(".mui-mbar-tab-tip"),p=o.one(".mui-mbar-tab-tip-arr"),f=o.one(".mui-mbar-tab-logo-arr");b&&(b.logo&&u.css(KISSY.UA.ie&&KISSY.UA.ie<9?{"filter":"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.logo+"',sizingMethod='scale')"}:{"background-image":"url("+b.logo+")","background-size":"100%"}),b.bgColor&&(o.css("background-color",b.bgColor),d.css("background-color",b.bgColor),p.css("color",b.bgColor),f.css("color",b.bgColor))),t.html('<div class="mui-mbarp-live-wrap"><div class="mui-mbarp-live-broadcast"></div><div class="mui-mbarp-live-tab-content-live"></div></div>'),(!m.isLogin||m.isLogin&&l.m>0)&&a._showActbubble(e),a.on(s.E.VISIBILITY_CHANGE,function(e){e.visible&&g&&(i.fire(s.E.SUPTIP_CHANGE,{"show":!1}),a._showTabLive(),g=!1)}),a.on(s.E.DATA_CHANGE,function(e){g=!0,i.get(s.K.EXPAND)&&a._showTabLive()})}})},"_showActbubble":function(e){var t=this,i=t.get(s.K.MALLBAR_ITEM),n=i.get(s.K.MALLBAR);r.ajax({"url":s.URL.GET_PLUGIN_LIVE_TIP,"timeout":4,"jsonpCallback":"__mallbarGetActiveMessage","success":function(t){if(1!==t.s||!t.t||!t.id)return void r.log("\u8bf7\u6c42\u6c14\u6ce1\u65f6\u670d\u52a1\u5668\u8fd4\u56de\u6709\u95ee\u9898");var i=t.id+"";m.get({"k":u,"success":function(o){var l=!1,c=e.liveBubMax;"object"!=typeof o&&(o={},m.set({"k":u,"v":o})),a.each(o,function(a,e){if(e===i&&a>=c)return l=!0,!1}),l||(t.d11=e.isLiveD11,t.title=t.t,t.u=t.u?r.addSCM(t.u,s.SCM.LIVE_BUB_LINK):"",n.bubble({"show":!0,"content":f.render(t),"customContentType":3,"bubbleType":0,"flag":4.3,"isNotTabFire":!1,"tab":"LIVE","hideDelay":e.liveBubDur?1e3*e.liveBubDur:s.BUBBLE_HIDE_DELAY,"showed":function(e){o=o||{},o[i]=o[i]||0,o[i]+=1,m.set({"k":u,"v":o}),a.each(e.all("a"),function(e){a.one(e).on("click",function(a){r.sendLog(s.ARR.LIVE_BUB_LINK_CLICK),o=o||{},o[i]=c||0,m.set({"k":u,"v":o}),a.stopPropagation()})}),r.sendLog(s.ARR.LIVE_SHOW)},"clicked":function(){o=o||{},o[i]=c||0,m.set({"k":u,"v":o}),r.sendLog(s.ARR.LIVE_CLICK)},"dismiss":function(){},"colsedClicked":function(){r.sendLog(s.ARR.LIVE_BUBBLE_CLOSE_BOTTON_CLICK),o=o||{},o[i]=c||0,m.set({"k":u,"v":o})}}))}})},"error":function(){r.log("\u8bf7\u6c42\u6c14\u6ce1\u65f6\u670d\u52a1\u5668\u8d85\u65f6\u6216\u9519\u8bef")}})},"_showTabLive":function(){var a=this,e=a.get(s.K.CONTAINER);e.one(".mui-mbarp-live-tab-content-live").html(c),a.getBroadcastTip(),a._getLiveData(),a.initBroadcastAnim(),e.one(".mui-mbarp-live-more").on("click",function(){a.getBroadcastTip(),a._getLiveData(),r.sendLog(s.ARR.FOOT_MORE_CLICK)})},"_getLiveData":function(){var e=this,t=e.get(s.K.CONTAINER),i=t.one(".mui-mbarp-live-msgs"),n=t.one(".mui-mbarp-live-more"),o=t.one(".mui-mbarp-live-more-nomsg"),m=t.one(".mui-mbarp-live-load");e.get(s.K.MALLBAR_ITEM),n.hide(),m.show(),r.ajax({"url":s.URL.GET_PLUGIN_LIVE,"data":{"pageSize":10,"lastId":b},"timeout":4,"jsonpCallback":"__mallbarReadRadiateMsg","success":function(t){return m.hide(),n.show(),r.log("lastId",b),"E01"==t.errorCode?void e.noMsg():"E00"==t.errorCode||b?t.msgs&&t.msgs.length?void r.getStaticConf({"cb":function(n){a.each(t.msgs,function(a,e){a.d11=n.isLiveD11;var t=r.parseDate(a.date);if(a.date=r.fm("{0}\u6708{1}\u65e5\u7ed3\u675f",t.getMonth()+1,t.getDate()),a.t=a.title,a.link="",a.src="",a.desc="",a.extras.pics.length>0){var i=a.extras.pics[0];a.link=i.link?r.addSCM(i.link,s.SCM.LIVE):"",a.src=i.src,a.desc=i.desc||i.t}});var o="";if(b)o=p.render(t),b=t.msgs[t.msgs.length-1].id;else{b=t.msgs[t.msgs.length-1].id;var m=t.msgs,l=m.splice(0,2);o=d.render({"msgs":l})+p.render({"msgs":m})}i.append(o),e.fixArrow(i)}}):(!b&&e.noMsg(),void(b&&(n.hide(),o.show()))):void e.noMsg()},"error":function(){r.log("\u76f4\u64ad\u95f4\u6570\u636e\u8bf7\u6c42\u8d85\u65f6\u6216\u9519\u8bef"),m.hide(),n.show(),b||e.noMsg()}})},"noMsg":function(){a.one(".mui-mbarp-live-tab-content-live").html('<h2 class="mui-mbarp-live-nomsg">\u55b5\uff01\u60a8\u6ca1\u6709\u65b0\u6d88\u606f\u54e6\uff01</h2>')},"fixArrow":function(a){},"toStr":function(a,e){return e=e||Number.MAX_VALUE,a?(a=a.replace(/<a[^>]*?>([\w\W]+)<\/a>/gi,""),a.length<=e?a:a.substr(0,e)):""},"dateToTips":function(a){if(!a)return"\u5df2\u7ed3\u675f";var e=this,t=e.get(s.K.MALLBAR_ITEM),i=t.getServerTime();!!i&&(i=1*new Date(i));var n=1*new Date(a);return i>n?"\u5df2\u7ed3\u675f":parseInt((n-i)/1e3/60/60/24)+1+"\u5929\u540e\u7ed3\u675f"},"getBroadcastTip":function(){var e=this,t=e.get(s.K.CONTAINER),i=t.one(".mui-mbarp-live-broadcast");r.ajax({"url":"//ald.taobao.com/recommend.htm?appId=201509294","timeout":4,"jsonpCallback":"__mallbarBroadcastMsg","success":function(t){if(!!t.exposureParam&&r.sendLog(t.exposureParam),t.data&&t.data.length>0&&t.data[0].text){var n=t.data[0],o=a.substitute('<span class="icon">&#xe61e;</span><span class="content"><em class="words"> {text}</em></span>',n);i.html(o),e.initBroadcastAnim()}},"error":function(){}})},"initBroadcastAnim":function(){function e(){n.animate({"left":-s},{"duration":4*(r+1),"complete":function(){n.css("left",o),e()}})}var t=a.one(".mui-mbarp-live-broadcast");if(t){var i=t.one(".content"),n=t.one(".words"),o=i?i.width():0,s=n?n.width():0;if(s>o){var r=s/o;n.animate({"left":-s},{"duration":4*r,"complete":function(){n.css("left",o),e()}})}}}}),l},{"requires":["base","node","event","xtemplate","anim","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","cookie","json","mui/mallbar/plugin-live.css"]});KISSY.add("mui/mallbar/plugin-foot",function(a,e,t,i,n,o,s,r,m,l){var c=function(a){var e=this;c.superclass.constructor.call(e,a),e.init()},u="\u55b5\uff01\u770b\u8fc7\u7684\u60a8\u53ef\u80fd\u9519\u8fc7\u4e86\uff01\u8fd9\u91cc\u5e2e\u60a8\u8bb0\u5f55\u60a8\u67e5\u770b\u8fc7\u7684\u5b9d\u8d1d\u3002\u8fd9\u6b21\u522b\u518d\u9519\u8fc7\u4e86\u54e6\uff01";return a.extend(c,e,{"init":function(){function e(){l.get({"k":"mui/mallbar/foot/historynum","success":function(a){var e;window.location.href;e=a||[];var t=e.length;if(!(t>=O)){var i;if(window.g_config&&window.g_config.itemId&&(i=window.g_config.itemId),i){for(var n=!1,o=0;o<e.length;o++)if(i==e[o]){n=!0;break}if(n)return;e.push(i),t++,t!=S&&t!=O||(m.log("GTE firstBubbleTipCount and Bubble it"),B.fire(r.E.BUBBLE_CHANGE,{"show":!0,"customContentType":1,"bubbleType":0,"isNotTabFire":!1,"html":"\u55b5\uff0c\u60a8\u770b\u8fc7\u7684\u5546\u54c1\u53ef\u4ee5\u5728\u8fd9\u91cc\u627e\u5230\u54e6\uff1a\uff09","showed":function(){m.sendLog(r.ARR.FOOT_BUBBLE)},"clicked":function(){m.sendLog(r.ARR.FOOT_BUBBLE_CLICK)}})),l.set({"k":"mui/mallbar/foot/historynum","v":e,"success":function(){}})}}}})}function t(){E.html('<div id="J_MuiMbarHistoryBd" class="mui-mbar-foot-hisbd"><div class="mui-mbar-foot-hmask"></div></div>'),a.one("#J_MuiMbarHistoryBd").parent(".mui-mbar-plugin-bd").css({"overflow-x":"hidden"}),m.log("Foot Visible"),l.get({"k":"mui/mallbar/foot/blacklist","success":function(a){a&&(M=a),c()}})}function o(){var e=a.one("#J_MuiMbarHistoryBd"),t=e.parent(".mui-mbar-plugin-bd").height(),i=a.one("#J_MuiMbarPinBd").height();e.height(t-i)}function c(){N=0,R=B.getUserInfo(),m.log("updateContent",+new Date),new i({"url":r.URL.GET_PLUGIN_FOOT_ITEMS,"dataType":"jsonp","scriptCharset":"gbk","jsonpCallback":"__mallbarFootGetHistory","data":{"type":1,"t":+new Date},"timeout":5,"success":d,"error":function(){B.fire(r.E.ERROR)}})}function b(e){m.sendLog(r.ARR.FOOT_UNPIN_ITEM),e.preventDefault();var t=e.target;n.detach(e.target,"click");var o=a.one(e.target).parent(".j_mui-mbar-foot-psitem"),s=o.attr("data-itemid");new i({"dataType":"jsonp","scriptCharset":"gbk","jsonpCallback":"__mallbarFootUnpinItem","url":r.URL.GET_PLUGIN_FOOT_PINITEM,"data":{"_tb_token_":C,"pin":0,"itemId":s,"t":+new Date},"timeout":5,"success":function(e){if(C=e.t,-2==e.s)return B.fire(r.E.LOGIN);if(-1==e.s)return a.one(t).on("click",b),void f(3);m.log("Unpin Successful");for(var i=a.one(o.parent(".mui-mbar-foot-pslist")),n=o.parent(".mui-mbar-foot-pslist").all(".mui-mbar-foot-psitem"),s=n.length,l=0;l<n.length&&o[0]!=n[l];)l++;for(var c=parseInt(o.css("left")),u=parseInt(o.css("top")),d=l+1;d<n.length;d++){var p=a.one(n[d]),g=parseInt(p.css("left")),h=parseInt(p.css("top"));T?p.css({"left":c,"top":u}):p.animate({"left":c,"top":u},.5,"easeOut",function(){var a=p,e=a.css("z-index");e=100==e?99:100,a.css({"z-index":e})}),c=g,u=h}var v=s-1,_=Math.ceil(v/2),A=_*X;T||i.animate({"height":A},.5,"easeOut");var I=a.one(".mui-mbar-foot-pstatn");if(I&&I.length>0){var E=parseInt(I.html()),L=E-1;I.html(L)}T?o.remove():o.fadeOut(.3,function(){o.remove()})},"error":function(){a.one(t).on("click",b),f(3)}})}function d(e){if(m.log("::foot refreshHistory::",+new Date),C=e.t,m.log(e),-2==e.s)return B.fire(r.E.LOGIN);var t=(e.c,e.l);if(t&&t.length>0){for(var i='  <div class="mui-mbar-foot-hhead">    <p class="mui-mbar-foot-hstat j_mui-mbar-foot-hstat" href="#"><span class="mui-mbar-foot-hstatn">{{HITEMCOUNT}}</span>\u4ef6\u5546\u54c1</p>    <a class="j_mui-mbar-foot-hclear mui-mbar-foot-hclear" href="#">\u6e05\u7a7a</a>  </div><div class="mui-mbar-foot-history j_mui-mbar-foot-history">',o=0;o<t.length;o++)category=t[o],i+=A(category);if(i+="</div>",i=i.replace("{{HITEMCOUNT}}",N),0==N)return void a.one("#J_MuiMbarHistoryBd").prepend(m.fm('<div class="mui-mbar-foot-nohis"></div><p class="mui-mbar-foot-nohhint">{0}</p><div class="mui-mbar-foot-hmask"></div>',u));a.one("#J_MuiMbarHistoryBd").prepend(i),a.all(".j_mui-mbar-foot-hpin").on("click",g),a.all(".j_mui-mbar-foot-hclose").on("click",function(e){m.sendLog(r.ARR.FOOT_DELETE_ITEM),e.preventDefault(),n.detach(e.target,"click"),v(a.one(e.target).parent(".j_mui-mbar-foot-hsitem").attr("data-itemid")),_(e)}),a.one(".j_mui-mbar-foot-hclear").on("click",function(a){a.preventDefault(),f(0)}),T&&(a.all(".mui-mbar-foot-hsitem").on("mouseover",function(e){var t=a.one(this);t.one(".mui-mbar-foot-hsibg").show(),t.one(".mui-mbar-foot-hpin").show(),t.one(".mui-mbar-foot-hclose").show()}),a.all(".mui-mbar-foot-hsitem").on("mouseout",function(e){var t=a.one(this);t.one(".mui-mbar-foot-hsibg").hide(),t.one(".mui-mbar-foot-hpin").hide(),t.one(".mui-mbar-foot-hclose").hide()}))}else a.one("#J_MuiMbarHistoryBd").prepend(m.fm('<div class="mui-mbar-foot-nohis"></div><p class="mui-mbar-foot-nohhint">{0}</p><div class="mui-mbar-foot-hmask"></div>',u))}function p(){m.sendLog(r.ARR.FOOT_CLEAR_HISTORY),m.log("Clear All Items");for(var e=[],t=a.all(".mui-mbar-foot-hsitem"),i=0;i<t.length;i++)e.push(a.one(t[i]).attr("data-itemid"));v(e);var n=a.one("#J_MuiMbarHistoryBd").children();n.fadeOut(1,function(){n.remove(),a.one("#J_MuiMbarHistoryBd").prepend(m.fm('<div class="mui-mbar-foot-nohis" style="display:none;"> </div><p class="mui-mbar-foot-nohhint" style="display:none">{0}</p><div class="mui-mbar-foot-hmask"></div>',u)),a.one(".mui-mbar-foot-nohis").fadeIn(.5),a.one(".mui-mbar-foot-nohhint").fadeIn(.5)})}function f(e){if(e!==undefined){if(0==e){var t=a.one(".mui-mbar-plugin-foot"),i=t.one("#J_mui-mbar-foot-dclear");if(i&&i.length>0)return void i.show();t.append(Y);var i=t.one("#J_mui-mbar-foot-dclear");i.show(),i.one(".mui-mbar-foot-dco").on("click",function(e){e.preventDefault(),p(),c=a.one(".mui-mbar-foot-mask"),c&&c.hide(),i.hide()}),i.one(".mui-mbar-foot-dcc").on("click",function(e){e.preventDefault(),c=a.one(".mui-mbar-foot-mask"),c&&c.hide(),i.hide()})}else if(1==e){var t=a.one(".mui-mbar-plugin-foot"),n=t.one("#J_mui-mbar-foot-dos");if(n&&n.length>0)return void n.show();t.append(z);var n=t.one("#J_mui-mbar-foot-dos");n.show(),n.one(".mui-mbar-foot-doc").on("click",function(e){e.preventDefault(),c=a.one(".mui-mbar-foot-mask"),c&&c.hide(),n.hide()})}else if(2==e){var t=a.one(".mui-mbar-plugin-foot"),o=t.one("#J_mui-mbar-foot-dpf");if(o&&o.length>0)return void o.show();t.append(J);var o=t.one("#J_mui-mbar-foot-dpf");o.show(),o.one(".mui-mbar-foot-dpc").on("click",function(e){e.preventDefault(),c=a.one(".mui-mbar-foot-mask"),c&&c.hide(),o.hide()})}else if(3==e){var t=a.one(".mui-mbar-plugin-foot"),s=t.one("#J_mui-mbar-foot-dupf");if(s&&s.length>0)return void s.show();t.append(q);var s=t.one("#J_mui-mbar-foot-dupf");s.show(),s.one(".mui-mbar-foot-dupc").on("click",function(e){e.preventDefault(),c=a.one(".mui-mbar-foot-mask"),c&&c.hide(),s.hide()})}else if(4==e){var r=a.one(".mui-mbar-foot-hsitem");if(!(r&&r.length>0))return;var t=a.one(".mui-mbar-plugin-foot"),m=t.one("#J_mui-mbar-foot-dpt");if(m&&m.length>0)return void m.show();t.append(Z);var m=t.one("#J_mui-mbar-foot-dpt");m.show(),r.one(".mui-mbar-foot-hsibg").show(),r.one(".mui-mbar-foot-hpin").show(),r.one(".mui-mbar-foot-hclose").show(),m.one(".mui-mbar-foot-dptc").on("click",function(e){e.preventDefault(),c=a.one(".mui-mbar-foot-mask"),c&&c.hide(),m.hide(),r.one(".mui-mbar-foot-hsibg").attr("style",""),r.one(".mui-mbar-foot-hpin").attr("style",""),r.one(".mui-mbar-foot-hclose").attr("style",""),l.set({"k":"mui/mallbar/foot/first","v":1,"success":function(){}})})}var t=a.one(".mui-mbar-plugin-foot"),c=t.one(".mui-mbar-foot-mask");if(!c||c.length<=0){t.append('<div class="mui-mbar-foot-mask"></div>');var c=t.one(".mui-mbar-foot-mask")}c.css({"height":t.height()}),c.show()}}function g(e){if(m.sendLog(r.ARR.FOOT_PIN_ITEM),e.preventDefault(),!w){var s=e.target;n.detach(e.target,"click"),m.log("Pin Item"),m.log(e.target);var l=a.one(e.target).parent(".mui-mbar-foot-hsitem"),c=l.attr("data-itemid");new i({"url":r.URL.GET_PLUGIN_FOOT_PINITEM,"scriptCharset":"gbk","jsonpCallback":"__mallbarFootPinItem","data":{"_tb_token_":C,"pin":1,"itemId":c,"t":+new Date},"dataType":"jsonp","timeout":5,"success":function(i){if(C=i.t,-2==i.s)return B.fire(r.E.LOGIN);if(-1==i.s)return a.one(s).on("click",g),m.log("Pin Fail"),void f(2);if(!W)return void t();w=!0,a.one("#J_MuiMbarPinBd").show(),m.log("Pin Successful");var n=l.offset(),u=a.one(".mui-mbar-foot-pslist"),d=u.offset(),p=n.top-a.one(window).scrollTop(),v=n.left-a.one(".mui-mbar").offset().left-a.one(window).scrollLeft()-35,A=99999999999999,I=l.one("img").attr("src"),T=l.one(".mui-mbar-foot-hdtxt").html(),E=l.children(".mui-mbar-foot-hprice").html(),L=l.one(".mui-mbar-foot-hprice").attr("href"),R=L.split("?"),S=R[0],O=R[1],N="";if(O){var M=a.unparam(O);M.acm="03200.1003.1.1",M.scm="1048.1.6.3";N=S+"?"+a.param(M)}else N=S+"?acm=03200.1003.1.1&scm=1048.1.6.3";var y='<div class="mui-mbar-foot-psia mui-mbar-foot-psitem j_mui-mbar-foot-psitem" style="top:'+p+"px;left:"+v+"px;z-index:"+A+';" data-itemid="'+c+'">  <a class="mui-mbar-foot-psilink" target="_blank" href="'+N+'"><img src="'+I+'" alt="'+T+'" width="90" height="90" /></a>  <a target="_blank" href="'+N+'" class="mui-mbar-foot-pprice" style="display:none;">'+E+'</a>  <s class="mui-mbar-foot-ppin j_mui-mbar-foot-ppin" title="\u5220\u9664" style="display:none;"></s>  <div class="mui-mbar-foot-pdesc">    <a target="_blank" href="'+N+'">'+T+"</a>  </div></div>";if(U)if(0==a.one("#J_MuiMbarPinBd").height())a.one("#J_MuiMbarPinBd").animate({"height":156},.3,"easeOut",function(){o()}),d.top-=156;else{var D=a.one(".j_mui-mbar-foot-pfbtn");D.removeClass("mui-mbar-foot-pfold"),D.addClass("mui-mbar-foot-punfold")}U=!1,a.one(".mui-mbar-plugin-foot").prepend(y);var P=a.one(".mui-mbar-foot-psia");P.one(".j_mui-mbar-foot-ppin").on("click",b),m.log("aniItem width:"+P.width()+" height: "+P.height()),P.animate({"left":v+20,"top":p-20},.5,"easeIn",function(){P.animate({"left":d.left-a.one(".mui-mbar").offset().left+K-a.one(window).scrollLeft()-35,"top":d.top+F-a.one(window).scrollTop()},1,"easeIn",function(){u.prepend(P),P.one(".mui-mbar-foot-ppin").fadeIn(.5),P.one(".mui-mbar-foot-pprice").fadeIn(.5),w=!1,P.removeClass("mui-mbar-foot-psia"),P.css({"left":K,"top":F,"z-index":100})})}),h(),l.fadeOut(1.5),setTimeout(function(){_(e)},1500);var x=a.one(".mui-mbar-foot-pstatn");if(x&&x.length>0){var k=parseInt(x.html()),G=k+1;x.html(G)}var H=a.one(".mui-mbar-foot-pinhint");H&&(H.removeClass(".mui-mbar-foot-pinhint"),H.addClass(".mui-mbar-foot-pinohint"))},"error":function(){a.one(s).on("click",g),m.log("Pin Fail"),f(2)}})}}function h(){var e=a.one(".mui-mbar-foot-pslist"),t=e.all(".mui-mbar-foot-psitem"),i=t.length,n=Math.floor(i/2),o=i%2,s=X*(n+1);if(T||e.height(s),t&&t.length>0)for(var r=K+o*j,m=F+n*X,l=i-1;l>=0;l--){var c=a.one(t[l]);c.animate({"left":r,"top":m},.5,"easeOut",function(){var a=c,e=a.css("z-index");e=100==e?99:100,a.css({"z-index":e})}),r=parseInt(c.css("left")),m=parseInt(c.css("top"))}else var s=X*(n+1)}function v(a){l.get({"k":"mui/mallbar/foot/blacklist","success":function(e){if(e){var t;"object"==typeof a&&a instanceof Array?t=e.concat(a):(e.push(a),t=e),l.set({"k":"mui/mallbar/foot/blacklist","v":t,"success":function(a){m.log("Update foot/blacklist")}})}else{var t;t="object"==typeof a&&a instanceof Array?a:[a],l.set({"k":"mui/mallbar/foot/blacklist","v":t,"success":function(a){m.log("New mbar_plugin_foot_storage")}})}}})}function _(e){m.log("Delete Item"),m.log(e.target);for(var t=a.one(e.target).parent(".mui-mbar-foot-hsitem"),i=(t.attr("data-itemid"),a.one(t.parent(".mui-mbar-foot-hslist"))),n=t.parent(".mui-mbar-foot-hslist").children(".mui-mbar-foot-hsitem"),o=n.length,s=0;s<o&&t[0]!=n[s];)s++;for(var r=parseInt(t.css("left")),l=parseInt(t.css("top")),c=s+1;c<n.length;c++){var u=a.one(n[c]),b=parseInt(u.css("left")),d=parseInt(u.css("top"));T?u.css({"left":r,"top":l}):u.animate({"left":r,"top":l},.5,"easeOut",function(){var a=u,e=a.css("z-index");e=100==e?99:100,a.css({"z-index":e})}),r=b,l=d}var p=a.one(".mui-mbar-foot-hstatn");if(p&&p.length>0){var f=parseInt(p.html()),g=f-1;p.html(g)}if(1==o){var h=t.parent(".mui-mbar-foot-hsection"),v=h,_=a.all(".mui-mbar-foot-hsection");if(_&&1==_.length){var A=a.one("#J_MuiMbarHistoryBd").children();v=A}return void(v&&v.fadeOut(1,function(){v.remove();var e=a.all(".mui-mbar-foot-hsection");if(!(e&&e.length>0)){a.one("#J_MuiMbarHistoryBd").prepend('<div class="mui-mbar-foot-nohis" style="display:none;"></div><p class="mui-mbar-foot-nohhint" style="display:none">\u55b5\uff01\u770b\u8fc7\u7684\u60a8\u53ef\u80fd\u9519\u8fc7\u4e86\uff01\u8fd9\u91cc\u5e2e\u60a8\u8bb0\u5f55\u60a8\u67e5\u770b\u8fc7\u7684\u5b9d\u8d1d\u3002\u8fd9\u6b21\u522b\u518d\u9519\u8fc7\u4e86\u54e6\uff01</p><div class="mui-mbar-foot-hmask"></div>');a.one(".mui-mbar-foot-nohis").fadeIn(.5),a.one(".mui-mbar-foot-nohhint").fadeIn(.5)}}))}var C=o-1,I=Math.ceil(C/2),E=I*H;T?i.height(E):i.animate({"height":E},.5,"easeOut"),T?t.remove():t.fadeOut(.3,function(){t.remove()})}function A(e){for(var t=V[e.n],i=e.d,n=i.length,o='<div class="mui-mbar-foot-hsection">  <div class="mui-mbar-foot-hstitle">    <p>'+t+'</p>    <s></s>  </div><div class="mui-mbar-foot-hslist j_mui-mbar-foot-hslist" style="height:{{LISTHEIGHT}}px;">',s=0,r=0;r<n;r++){for(var m=i[r],l=!1,c=0;c<M.length;c++)if(""+m.itemId==M[c]){l=!0;break}if(!l){var u=Math.floor(s/2),b=s%2,d=0==b?100:99,p=k+u*H,f=x+b*G,g=m.url.split("?"),h=g[0],v=g[1],_="";if(v){var A=a.unparam(v);A.acm="03200.1003.1.1",A.scm="1003.3.03200.0";_=h+"?"+a.param(A)}else _=h+"?acm=03200.1003.1.1&scm=1003.3.03200.0";m.tag201511=m.tag201511&&L.tag201511Time,o+='<div class="mui-mbar-foot-hsitem j_mui-mbar-foot-hsitem" style="top:'+p+"px;left:"+f+"px;z-index:"+d+';" data-itemid="'+m.itemId+'"><div class="mui-mbar-foot-hsibg"></div>  <a class="mui-mbar-foot-hsilink" href="'+_+'" target="_blank"><img src="'+m.img+'_90x90.jpg" alt="'+m.desc+'" width="90" height="90"/></a>  <a href="'+_+'" target="_blank" class="mui-mbar-foot-hprice" title="&yen;'+m.price+'">\uffe5'+m.price+"</a>"+(m.tag201511?'<span class="mui-mbarp-11-flag"></span>':"")+'  <s class="mui-mbar-foot-hpin mui-mbarp-foot-favor-cancel" title="\u52a0\u5165\u6536\u85cf"></s>  <s class="mui-mbar-foot-hclose j_mui-mbar-foot-hclose" title="\u5220\u9664\u8bb0\u5f55"></s>  <div class="mui-mbar-foot-hdesc">    <a href="'+_+'" target="_blank" class="mui-mbar-foot-hdtxt">'+m.desc+"</a>  </div></div>",N++,s++}}if(0==s)return"";o+="</div></div>";var C=Math.ceil(s/2)*H;return o=o.replace("{{LISTHEIGHT}}",+C)}var C,I=this,T=6==s.ie||7==s.ie,E=I.get(r.K.CONTAINER),B=I.get(r.K.MALLBAR_ITEM),L=B.get(r.K.MALLBAR),R=B.getUserInfo(),S=(r.IS_DAILY,10),O=30,N=0,w=!1,M=[],U=!1,y=!1,D=!1,P=!1,x=7,k=7,K=20,F=18,G=96,H=120,j=105,X=120,V=["\u4eca\u5929","1\u5929\u524d","2\u5929\u524d","1\u5468\u524d"],R=B.getUserInfo(),W=R.isLogin,Y=a.one(' <div id="J_mui-mbar-foot-dclear" class="mui-mbar-foot-dialog"> <p class="mui-mbar-foot-dtitle">\u55b5~\u786e\u5b9a\u8981\u6e05\u7a7a\u6211\u770b\u8fc7\u7684\uff1f</p> <p class="mui-mbar-foot-dhint">\u6ce8\uff1a\u60a8\u9489\u4f4f\u7684\u5546\u54c1\u4e0d\u4f1a\u88ab\u6e05\u7a7a</p> <div class="mui-mbar-foot-dbtns"> <a class="mui-mbar-foot-dco" href="#">\u786e\u5b9a</a> <a class="mui-mbar-foot-dcc" href="#">\u53d6\u6d88</a> </div> </div> '),z=a.one(' <div id="J_mui-mbar-foot-dos" class="mui-mbar-foot-dialog"> <p class="mui-mbar-foot-dtitle">\u55b5\uff0c\u60a8\u5df2\u7ecf\u9489\u6ee1\u4e86~~</p> <p class="mui-mbar-foot-dhint">\u6ce8\uff1a\u60a8\u6700\u591a\u53ef\u4ee5\u9489100\u4ef6\u5546\u54c1</p> <div class="mui-mbar-foot-dbtns"> <a class="mui-mbar-foot-doc" href="#">\u6211\u77e5\u9053\u4e86</a> </div> </div> '),J=a.one(' <div id="J_mui-mbar-foot-dpf" class="mui-mbar-foot-dialog"> <p class="mui-mbar-foot-dtitle">\u55b5\uff0c\u6ca1\u9489\u4e0a~~</p> <p class="mui-mbar-foot-dhint">\u6ce8\uff1a\u8bf7\u7a0d\u540e\u518d\u8bd5\u54e6\uff1a\uff09</p> <div class="mui-mbar-foot-dbtns"> <a class="mui-mbar-foot-dpc" href="#">\u6211\u77e5\u9053\u4e86</a> </div> </div> '),q=a.one(' <div id="J_mui-mbar-foot-dupf" class="mui-mbar-foot-dialog"> <p class="mui-mbar-foot-dtitle">\u55b5\uff0c\u5220\u9664\u5931\u8d25\u4e86~~</p> <p class="mui-mbar-foot-dhint">\u6ce8\uff1a\u8bf7\u7a0d\u540e\u518d\u8bd5\u54e6\uff1a\uff09</p> <div class="mui-mbar-foot-dbtns"> <a class="mui-mbar-foot-dupc" href="#">\u6211\u77e5\u9053\u4e86</a> </div> </div> '),Z=a.one(' <div id="J_mui-mbar-foot-dpt" class="mui-mbar-foot-dialog mui-mbar-foot-dptd"> <s class="outer-tri"></s>  <s class="shinning-pin"></s> <p class="mui-mbar-foot-dpthint">\u55b5~~\u60a8\u53ef\u4ee5\u5bf9\u91cd\u70b9\u5173\u6ce8\u7684\u5546\u54c1\u4f7f\u7528\u9489\u4f4f\uff0c\u7cfb\u7edf\u4f1a\u4e00\u76f4\u4fdd\u7559\u4f4f\u8be5\u5546\u54c1\u7684\u770b\u8fc7\u8bb0\u5f55\uff01\u9489\u4f4f\u7684\u5546\u54c1\u4e5f\u4f1a\u540c\u65f6\u52a0\u5165\u60a8\u7684\u6536\u85cf\u5939\u54e6\uff1a\uff09</p><div class="mui-mbar-foot-dbtns"> <a class="mui-mbar-foot-dptc" href="#">\u6211\u77e5\u9053\u4e86</a> </div> </div> ');e(),I.on(r.E.VISIBILITY_CHANGE,function(e){if(e.visible&&(y=!0,setTimeout(function(){y=!1},100),t()),e.first){var i=B.get(r.K.MALLBAR);E.delegate("click",".mui-mbarp-foot-favor-cancel",function(e){var t=a.one(e.currentTarget).parent(".mui-mbar-foot-hsitem"),n=t.attr("data-itemId");i._addFavor(n,e),m.sendLog(r.ARR.FOOT_ADD_FAVOR),e.halt()})}}),I.on(r.E.DATA_CHANGE,function(a){m.log("Plugin",a.type),B.get(r.K.EXPAND)&&t()}),I.on(r.E.PAGE_VISIBILITY_CHANGE,function(a){if(!P){B.get(r.K.EXPAND)&&a.pageVisible&&!y&&t()}}),B.on(r.E.LOGIN_SUCCESS,function(){D=!0})}}),c},{"requires":["base","node","ajax","event","anim","ua","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","mui/mallbar/plugin-foot.css"]});KISSY.add("mui/mallbar/plugin-top",function(a,e,i,t,o,n,s){var r=function(a){var e=this;r.superclass.constructor.call(e,a),e.init()};return a.extend(r,e,{"init":function(){function e(e,i,t,o){t?a.one(window).animate({"scrollLeft":e,"scrollTop":i},t/1e3,o):window.scrollTo(e,i)}var i=this,t=i.get(o.K.MALLBAR_ITEM),s=t.get(o.K.TAB),r=a.one(window);r.on("scroll",a.buffer(function(a){r.scrollTop()>0?s.fadeIn(.2):s.fadeOut(.1)},100)),r.fire("scroll"),s.on("click",function(){n.log("top click"),n.sendLog(o.ARR.BACKTOP_CLICK),e(0,0,300,"ease")})}}),r},{"requires":["base","node","event","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","mui/mallbar/plugin-top.css"]});KISSY.add("mui/mallbar/plugin-ue",function(a,e,i,t,o,n,r){var s=function(a){var e=this;s.superclass.constructor.call(e,a),e.init()};return a.extend(s,e,{"init":function(){var e=this,i=e.get(o.K.MALLBAR_ITEM),t=i.get(o.K.TAB),n="http://ur.taobao.com/survey/view.htm?id=",r=i.getGConfig();if(r.ueId||r.ueUrl){r.ueUrl?n=r.ueUrl:n+=r.ueId,a.one(".mui-mbar-tab-ue").show(),a.all("<style>.mui-mbar .mui-mbar-tab-ue {display:block}</style>").appendTo("head");t.one(".mui-mbar-tab-logo-ue").append('<a style="display:block;width: 35px;height: 35px;overflow: hidden;text-indent: -40px" href="'+n+'">UE</a>');t.one(".mui-mbar-tab-tip").html('<a target="_blank" style="color:#fff;" href="'+n+'">\u7528\u6237\u53cd\u9988</a>')}}}),s},{"requires":["base","node","event","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","mui/mallbar/plugin-ue.css"]});KISSY.add("mui/mallbar/plugin-qrcode",function(a,e,i,t,o,n,s,r,m,l){var c=encodeURIComponent("https://img.alicdn.com/tfs/TB1BANKRpXXXXbbXpXXXXXXXXXX-68-68.png"),u="//gcodex.alicdn.com/qrcode.do?size=175&biz_code=tmallpc&logo_url="+c+"&content=",b="//img.alicdn.com/tfs/TB1GPVXRpXXXXXsapXXXXXXXXXX-175-175.jpg",d="http://m.laiwang.com/wow/portal/act/app-download",p=new l(['<div class="mui-mbarp-qrcode-tip" style="background-image:url({{qrcodeBg}})">','   <div class="mui-mbarp-qrcode-hd mui-mbarp-qrcode-hd-d">','       <img src="{{qrcodeImg}}" />',"   </div>",'   <div class="mui-mbarp-qrcode-bd ">','       <img src="{{qrcodeDesc}}" />',"   </div>","</div>",'<div class="mui-mbar-arr mui-mbarp-qrcode-arr " style="color:{{qrcodeArr}}">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-qrcode-bubble-close"></div>'].join("")),f=(['<div class="mui-mbar-bubble mui-mbarp-bubble-qrcode-cross" >','<div class="mui-mbar-arr mui-mbarp-bubble-cross-arr">\u25c6</div>',"</div>"].join(""),function(a){var e=this;f.superclass.constructor.call(e,a),e.init()});return a.extend(f,e,{"init":function(){function e(a){var e=['<div class="mui-mbar-bubble mui-mbarp-qrcode-bubble mui-mbarp-qrcode-bubble-{0}">','<div class="mui-mbar-arr mui-mbarp-qrcode-bubble-arr mui-mbarp-qrcode-bubble-arr-red">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-qrcode-bubble-close"></div>',"{1}","</div>"].join("");a.n?t(e,a):a.f?o(e,a):c()}function t(e,i){var t={};t.html=r.fm(e,"new",""),t.clicked=function(){r.sendLog(s.ARR.QRCODE_BUBBLE_NEW_QRCODE_CLICK),a.use("mui/mobilecross",function(a,e){var i=h.get("bubble");!!e&&e.cross({"params":{"url":"http://vip.tmall.com/mobile/home/mainPage.htm"},"itemImg":"//img.alicdn.com/tps/i3/TB1RZ2.HXXXXXXWXVXXhoVtWXXX-175-176.png","relEl":i,"resource":16,"text":"\u55b5~\u6536\u523010\u5143\u65b0\u4eba\u4f18\u60e0\u5238\uff08\u5929\u732b\u8d85\u5e02\uff09\u4e00\u679a\uff0c\u70b9\u51fb\u83b7\u53d6\uff01","type":"link","tips":"\u55b5~\u65b0\u4eba\u4f18\u60e0\u5238\u5df2\u7ecf\u98de\u5411\u60a8\u7684\u624b\u673a\uff0c\u5feb\u53bb\u67e5\u770b\u5427\uff01","mmstat":"vip_ticket","token":TB.userInfo.tbToken||"","success":function(){}})})},t.showed=function(){r.sendLog(s.ARR.QRCODE_BUBBLE_NEW_QRCODE_SHOW)},l(t)}function o(e,i){var t={};t.html=r.fm(e,"lottery",""),t.clicked=function(){r.sendLog(s.ARR.QRCODE_BUBBLE_OLD_QRCODE_CLICK),a.use("mui/mobilecross",function(a,e){var t=h.get("bubble");!!e&&e.cross({"params":{"url":"http://chaoshi.tmall.com/wap/oclottery/oclottery.htm"},"itemImg":"//img.alicdn.com/tps/TB1MB5PJVXXXXcZXFXXXXXXXXXX-175-176.jpg","relEl":t,"resource":17,"text":"\u55b5~\u4e3b\u4eba\u8fd8\u6709"+i.f+"\u5c40\u7ffb\u724c\u62bd\u5956\u672a\u4f7f\u7528\uff0c\u8d76\u7d27\u4f7f\u7528100%\u4e2d\u5956\uff01","type":"link","tips":"\u55b5~\u7a7f\u8d8a\u6210\u529f\uff01\u53ef\u4ee5\u6109\u5feb\u7684\u53bb\u624b\u673a\u62bd\u5956\u4e86\uff0c100%\u4e2d\u5956\u54df\uff01","token":TB.userInfo.tbToken||"","mmstat":"vip_lottery","success":function(){}})})},t.showed=function(){r.sendLog(s.ARR.QRCODE_BUBBLE_OLD_QRCODE_SHOW)},l(t)}function n(){window.g_config&&window.g_config.itemId&&window.g_config.itemId;var e=['<div class="mui-mbar-bubble mui-mbarp-qrcode-bubble mui-mbarp-qrcode-bubble-2">','<div class="mui-mbar-arr mui-mbarp-qrcode-bubble-arr">\u25c6</div>','<div class="mui-mbar-bubble-close mui-mbarp-qrcode-bubble-close"></div>',"</div>"].join(""),i={};A.isLogin?(i.html=e,i.height=175,i.clicked=function(){r.sendLog(s.ARR.QRCODE_BUBBLE_TUSER_QRCODE_CLICK),a.use("mui/mobilecross",function(a,e){var i=h.get("bubble"),t=a.DOM.attr(a.one("#J_ImgBooth"),"src");!!e&&e.cross({"params":{"itemId":v.get("itemId")},"itemImg":t,"relEl":i,"resource":13,"text":"\u55b5~\u6536\u5230\u7a7f\u8d8a\u800c\u6765\u7684\u5b9d\u8d1d\u4e00\u679a\uff0c\u624b\u673a\u4e0b\u5355\uff0c\u4e13\u4eab\u552e\u540e\u65e0\u5fe7\uff01","type":"item","tips":"\u55b5~\u5b9d\u8d1d\u5df2\u7a7f\u8d8a\uff0c\u4f7f\u7528\u624b\u673a\u5929\u732b\u6210\u529f\u4e0b\u5355\u4e13\u4eab\u552e\u540e\u65e0\u5fe7\uff01","mmstat":"prime_across","token":TB.userInfo.tbToken||"","success":function(){}})})},i.showed=function(){r.sendLog(s.ARR.QRCODE_BUBBLE_TUSER_QRCODE_SHOW)},l(i)):c()}function l(a){a.notNeedBubble||v.bubble({"show":!0,"flag":.6,"content":a.html,"customContentType":3,"bubbleType":a.bubbleType?0:1,"height":a.height||175,"tab":"QRCODE","isNotTabFire":!0,"showed":a.showed||"","clicked":a.clicked||"","dismiss":a.dismiss}),I.on("mouseenter",function(){g.mallbarItem.fire(s.E.BUBBLE_CHANGE,{"show":!0,"html":a.html,"showDelay":500,"customContentType":3,"bubbleType":1,"height":a.height,"tab":"QRCODE","isNotTabFire":!0,"tabMouseleave":!0,"showed":function(){},"clicked":a.clicked||""})})}function c(){var a=window.g_config||{};a.mallbarQrcode&&a.mallbarQrcode.notBubble&&(g.qrcodeBubbleOpen=!1),g.isDetail&&TShop?TShop.onProduct(function(a){a.onLoad(["itemPrice"],function(a){a.hasTmallappProm&&g.isTMSource&&(g.qrcodeDesc=g.qrcodeDescSpecial,g.renderTpl=!0),f(1)})}):f(4.5)}function f(e){function t(){if(g.qrcodeBubbleOpen){var a="mui/mbarp/qrcode/public/bubble/"+h.getUid();m.get({"k":a,"success":function(a){a||v.bubble({"show":!0,"content":"","customContentType":3,"flag":e,"height":0,"bubbleType":0,"tab":"QRCODE","isNotTabFire":!0,"showed":function(){r.sendLog(s.ARR.QRCODE_PUBLIC_BUBBLE_SHOW),g.fire(s.E.QRCODE_CHANGE),o()},"clicked":function(){},"dismiss":function(){}})}})}}function o(){I.on("mouseenter",A).on("mouseleave",function(){I.detach("mouseenter",A)})}var n="";if(g.isShop){var l=g.shopConfig=h.getShopConfig()||h.getGConfig()||{};g.sellerId=l.userId||l.sellerId,!!l.shopId&&(g.shopId=l.shopId),(g.shopId||g.sellerId)&&(n=d+"?iframe=1&a=1&biz=tmall&mmstat=mbar_shop&type=shop&key="+(g.shopId?g.shopId:""),g.qrcodeSrc=u+encodeURIComponent(n))}if(g.isList){var c=a.unparam(r.segment(location.href).qs)||{};n=d+"?mmstat=mbar_list&type=list&key="+c.q,g.qrcodeSrc=u+encodeURIComponent(n)}if(g.isDetail){var b="";window.g_config&&window.g_config.itemId&&(b=window.g_config.itemId),b&&(n=d+"?mmstat=mbar_detail&type=detail&key="+b,g.qrcodeSrc=u+encodeURIComponent(n))}C.html(p.render(g)),C.hide(),a.one(document).on("click",function(a){C.hide()}),v.on(s.E.MALLBAR_STATUS_CHANGE,function(a){C.hide()}),g.on(s.E.QRCODE_CHANGE,function(a){if(a.pid){var e=_.one(".mui-mbar-tab-logo-"+a.pid);e&&C.css({"top":e.parent().css("top")})}else C.css({"top":I.css("top")});if(s.S.STANDARD===v.get(s.K.STATUS)){if("none"===C.css("display")&&r.sendLog(s.ARR.QRCODE),g.renderTpl){var i='<img src="'+g.qrcodeSrc+'" width="140" height="140"/>';C.one(".mui-mbarp-qrcode-hd").html(i),g.renderTpl=!1}C.show()}});var f=!1;I.on("mouseenter",function(e){f=!0,a.later(function(){f&&g.fire(s.E.QRCODE_CHANGE)},400)}).on("mouseleave",function(e){f=!1;var t=a.one(e.toElement||e.relatedTarget);t&&(i.hasClass(t,"mui-mbar-tabs-shadow")||t.parent(".mui-mbarp-qrcode")||C.hide())}).on("click",function(){if("none"===C.css("display")&&r.sendLog(s.ARR.QRCODE),g.renderTpl){var a='<img src="'+g.qrcodeSrc+'" width="140" height="140"/>';C.one(".mui-mbarp-qrcode-hd").html(a),g.renderTpl=!1}C.show()}),t();var A=function(){var a="mui/mbarp/qrcode/public/bubble/"+h.getUid();m.set({"k":a,"v":1,"expires":1})}}var g=this,h=g.mallbarItem=g.get(s.K.MALLBAR_ITEM),v=h.get(s.K.MALLBAR),_=v.get(s.K.ROOT),A=h.getUserInfo(),I=h.get(s.K.TAB),C=a.all('<div class="mui-mbarp-qrcode"></div>').appendTo(_);g.renderTpl=!1,g.qrcodeSrc="";var T=r.getSysId();g.isDetail="detail"==T,g.isList="list"==T,g.isShop="shop"==T,g.isHalfSale=window.g_config.is1111HalfPriceItem,(g.isDetail||g.isList||g.isShop)&&(g.renderTpl=!0);var E=(A.memberInfo.activeStatus,A.isLogin);r.getStaticConf({"cb":function(i){g.needCrossBubble=i.needCrossBubble||"";var t=i.primeStartTime||"",o=(i.primeEndTime,v.get(s.K.MODEL).get(s.K.TIMESTAMP)),m=window.g_config.mallbarQrcode,l=v.get(s.K.MODEL).get(s.K.BAR).prompt;if(l&&"string"==typeof l)try{l=JSON.parse(l)}catch(I){l=null}var u=g.isCustomQrcode=!!(l&&l.length||m),d="#FF0036",p="//img.alicdn.com/tfs/TB1uwIcRXXXXXXsaXXXXXXXXXXX-154-207.png";u?(g.renderTpl=!1,r.log("isCustomQrcode",u,l,m),m?(r.log("use mallbarGConf"),g.qrcodeDesc=m.qrcodeDesc||"",g.qrcodeDescSpecial=m.qrcodeDescSpecial||"",g.qrcodeImg=m.qrcodeImg||"",g.qrcodeBg=m.qrcodeBg||p,g.qrcodeArr=m.qrcodeArr||d):l&&l.length&&(l=l[0],r.log("use mallbarServerConf"),g.qrcodeDesc=l.qrcodeDesc||"",g.qrcodeDescSpecial=l.qrcodeDescSpecial||"",g.qrcodeImg=l.qrcodeImg||b,g.qrcodeBg=l.qrcodeBg||p,g.qrcodeArr=l.qrcodeArr||d,l.source&&"TM"===l.source&&(g.isTMSource=!0))):(g.qrcodeDesc=i.qrcodeDescNew||"//img.alicdn.com/tps/i3/TB1Er8WLVXXXXcIXXXXKBJEFXXX-135-45.png",g.qrcodeDescSpecial=i.qrcodeDescSpecial||"//img.alicdn.com/tps/i1/TB1seitLVXXXXa.XFXXKBJEFXXX-135-45.png",g.qrcodeImg=i.qrcodeImg||b,g.qrcodeBg=i.qrcodeBg||p,g.qrcodeArr=i.qrcodeArr||d,g.isTMSource=!0);var f="1446307200000",h="1447257600000";if(i.qrcodeBubble){var _=i.qrcodeBubble;!!_.s&&(f=_.s),!!_.e&&(h=_.e)}if((o>f&&o<h||!i.qrcodeBubbleClose)&&(g.notQrcodeBubble||(g.qrcodeBubbleOpen=!0)),E&&!window.feloader){if(!a.Env.mods["mui/mobilecross"]){var A=i.mobilecrossVersion||"3.0.0";a.config({"modules":{"mui/mobilecross":{"path":"//g.alicdn.com/mui/mobilecross/"+A+"/mobilecross.js"},"mui/mobilecross/mobilecross.css":{"path":"//g.alicdn.com/mui/mobilecross/"+A+"/mobilecross.css"}}})}v.getCueMsgInfo(function(a){if(200!=a.s)return void c();a.co&&a.co.pr?o>=t?n():c():a.co&&(a.co.n||a.co.f)?e(a.co):c()})}else c()}})}}),f},{"requires":["base","dom","node","event","mui/minilogin/index","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","xtemplate","mui/mallbar/plugin-qrcode.css"]});KISSY.add("mui/mallbar/plugin-favor",function(a,e,t,i,n,s,o){var r="401",m=function(a){return a.replace(/\.jpg_.+\.jpg/,".jpg")},l=function(a){var e=this;l.superclass.constructor.call(e,a),e.init()},c=[1,2,3,4],u=0;return a.extend(l,e,{"_itemListCache":{},"init":function(){var e=this,t=this,i=(e.get(s.K.CONTAINER),e.get(s.K.TIP_CONTAINER),e.get(s.K.MALLBAR_ITEM)),n=i.get(s.K.MALLBAR);e.mallbar=n||"",i.get(s.K.BUBBLE),o.log(i,this),this._initBind(),this._initDOMBind(),a.later(function(){t._initRecommandDetail()},10)},"_initDOMBind":function(){var e=this,t=this.get(s.K.MALLBAR_ITEM),i=t.get(s.K.MALLBAR),n=this._pluginContainer=this._pluginContainer||a.one(".mui-mbar-plugin-favor");n.delegate("click",".mui-mbarp-favor-cancel",function(t){var n=a.one(t.currentTarget).parent("li");n.animate({"opacity":0,"width":0},{"duration":.5,"easing":"easeOut","complete":function(){n.remove(),e._isDataChange=!0}});var r=a.one(t.currentTarget).attr("data-itemId");i._deleteFavor(r,function(){}),o.sendLog(s.ARR.FAVOR_DELETE),t.preventDefault()}),n.delegate("mouseenter",".mui-mbarp-favor-item",function(e){a.one(e.currentTarget).addClass("mui-mbarp-favor-item-hover")}),n.delegate("mouseleave",".mui-mbarp-favor-item",function(e){a.one(e.currentTarget).removeClass("mui-mbarp-favor-item-hover")}),n.delegate("mouseenter mouseleave",".mui-mbarp-favor-item-sale",function(e){a.one(e.currentTarget).toggleClass("mui-mbarp-favor-item-sale-hover")}),this._bindDetail(),this._initBindCateCheck()},"_initBind":function(){var a=this;this.on("visibilityChange",function(e){var t=a.mallbar.get("favorRec");if(t)return a.renderSingleRecommend(t),void a.mallbar.set("favorRec",{});e.visible&&e.first||a.notGetFavorList?a._initContainer():!e.visible&&a._isDataChange&&(a._isDataChange=!1,a._initContainer())}),this.on(s.E.DATA_CHANGE,function(e){o.log("Plugin",e.type),a._initContainer()})},"_initContainer":function(){var e=this;e.notGetFavorList=!1,a.later(function(){e._initFavorList()},10)},"_initRecommandDetail":function(){var e=this;(this._pluginContainer||a.one(".mui-mbar-plugin-favor")).append('<div class="mui-mbarp-favor-detail">            <div class="mui-mbarp-favor-detail-hd">                <h2>\u642d\u914d/\u540c\u6b3e</h2>                <span class="mui-mbarp-favor-detail-back">\u6211\u7684\u6536\u85cf</span>            </div>            <div class="mui-mbarp-favor-detail-bd">                <div class="mui-mbarp-favor-item-b">                </div>                <div class="mui-mbarp-favor-recommand-box">                    <ul class="mui-mbarp-favor-recommand-tab">                        <li class="mui-mbarp-favor-recommand-tab-item mui-mbarp-favor-recommand-tab-item-match" data-type="match">\u627e\u642d\u914d<b></b></li>                        <li class="mui-mbarp-favor-recommand-tab-item mui-mbarp-favor-recommand-tab-item-fx" data-type="fx">\u627e\u540c\u6b3e<b></b></li>                    </ul>                    <div class="mui-mbar-favor-recommand-content mui-mbar-favor-recommand-content-match"></div>                    <div class="mui-mbar-favor-recommand-content mui-mbar-favor-recommand-content-fx"></div>                </div>            </div>        </div>'),a.later(function(){e._initDetailBind()},10)},"_initDetailBind":function(){var e=this._favorDetail=a.one(".mui-mbarp-favor-detail");e&&o.noScroll(e.one(".mui-mbarp-favor-detail-bd"));var t=this._favorTabItems=a.all(".mui-mbarp-favor-recommand-tab-item"),i=this._favorTabContents=a.all(".mui-mbar-favor-recommand-content"),n=this;e.delegate("click",".mui-mbarp-favor-detail-back",function(a){n._switchBackToList(),o.sendLog(s.ARR.FAVOR_BACK),a.halt()}),e.delegate("click",".mui-mbarp-favor-recommand-tab-item",function(e){var n=a.one(e.currentTarget);t.removeClass("mui-mbarp-favor-recommand-tab-item-sellected"),n.addClass("mui-mbarp-favor-recommand-tab-item-sellected");var s=n.attr("data-type"),o=a.one(".mui-mbar-favor-recommand-content-"+s);i.hide(),o.show(),e.halt()})},"_initFavorList":function(){var a=this.get(s.K.MALLBAR_ITEM),e=(a.get(s.K.MALLBAR),a.get(s.K.TAB),this.get(s.K.CONTAINER)),t=this;new n({"dataType":"jsonp","scriptCharset":"gbk","type":"GET","url":s.URL.GET_PLUGIN_FAVOR_INFO,"success":function(i){o.log("::favorList::",i),i.success&&i.status!=r?i.itemInfo&&i.cateInfo.length>1?(i.cateInfo&&i.cateInfo.length>0&&"\u53cc11\u5546\u54c1"==i.cateInfo[0].cateName&&i.cateInfo[0].number>0&&(t.tag20151111=!0,e.hide()),i.cateInfo&&t._initCateBox(i.cateInfo),t._initItemListInner(i.itemInfo)):a.fire(s.E.ERROR,{"tip":"\u54a6\uff0c\u4eb2\u8fd8\u6ca1\u6709\u6536\u85cf\u8fc7\u5546\u54c1\u54e6\uff01"}):(i.status,a.fire(s.E.ERROR))},"error":function(){a.fire(s.E.ERROR)}})},"_initCateBox":function(e){var t=this.get(s.K.CONTAINER),i='<div class="mui-mbarp-favor-cate-trigger"><span>{cate}</span><i class="mui-mbar-iconfont ">&#xe60a;</i><div class="mui-mbarp-favor-cate-cont"><ul>{content}</ul></div></div>',n=[],o=a.one(".mui-mbarp-favor-cate-trigger");if(a.each(e,function(e,t){n.push(a.substitute('<li class="mui-mbarp-favor-cate-item" data-cateId="{cateId}" data-cataName="{cateName}"><a target="_blank" href="javascript:void(0);">{cateName}({number})</a></li>',e))}),o)o.one("ul").html(n.join(""));else{var r={};r.cate="\u5168\u90e8",e.length>0&&"\u53cc11\u5546\u54c1"==e[0].cateName&&e[0].number>0&&(r.cate="\u53cc11\u5546\u54c1"),r.content=n.join(""),i=a.substitute(i,r),a.one(".mui-mbar-plugin-favor").one(".mui-mbar-plugin-bd"),t.html(i),a.later(function(){o=a.one(".mui-mbarp-favor-cate-trigger"),o.on("mouseenter mouseleave",function(){o.toggleClass("mui-mbarp-favor-cate-trigger-hover")})},10)}},"_initBindCateCheck":function(){var e=this;this._pluginContainer.delegate("click",".mui-mbarp-favor-cate-item",function(t){var i=a.one(t.currentTarget);i.addClass("mui-mbar-favor-cate-item-sellected").siblings().removeClass("mui-mbar-favor-cate-item-sellected");var n=i.attr("data-cateId"),r=".mui-mbarp-favor-item-"+n;e._itemListAll=a.all(".mui-mbarp-favor-item");var m=i.attr("data-cataName"),l=a.one(".mui-mbarp-favor-cate-trigger");if(!!l&&l.one("span").html(m),e._timeList.hide(),"\u53cc11\u5546\u54c1"==m){var c=".mui-mbarp-favor-item-tag2015111";e._itemListAll.hide(),a.all(c).show(),e._timeList.each(function(a){a.all(c).length>0&&a.show()})}else n?(e._itemListAll.hide(),a.all(r).show(),e._timeList.each(function(a){a.all(r).length>0&&a.show()})):(a.all(".mui-mbarp-favor-item").show(),e._timeList.show());o.sendLog(s.ARR.FAVOR_CATE_CHECK),t.halt()})},"_getPicHost":function(){var a=u++;return a>3&&(a=0),"//gtms0"+c[a]+".alicdn.com/tps/"},"_initItemListInner":function(e){var t=this,i=["lastWeek","oneWeekAgo","oneMonthAgo","twoMonthAgo"],n={"lastWeek":"\u6700\u8fd1\u4e03\u5929","oneWeekAgo":"\u4e00\u5468\u524d","oneMonthAgo":"\u4e00\u4e2a\u6708\u524d","twoMonthAgo":"\u4e24\u4e2a\u6708\u524d"},s=[];a.each(i,function(a,i){e[a].desc=n[a],e[a].name=a,s.push(t._renderSingleTime(e[a]))}),this._renderItemList(s.join(""))},"_renderItemList":function(e){var t=this,i=this.get(s.K.CONTAINER),n='<div class="mui-mbarp-favor-list"><i></i>{{content}}<p class="mui-mbarp-favor-see-more"><a target="_blank" href="//shoucang.taobao.com/item_collect.htm">\u67e5\u770b\u5168\u90e8</a></p></div>'.replace("{{content}}",e);i.append(n),a.later(function(){if(t._timeList=a.all(".mui-mbarp-favor-item-time"),t._itemListAll=a.all(".mui-mbarp-favor-item"),t.tag20151111){t._timeList.hide();var e=".mui-mbarp-favor-item-tag2015111";t._itemListAll.hide(),a.all(e).show(),t._timeList.each(function(a){a.all(e).length>0&&a.show()}),i.show()}},10)},"_bindDetail":function(){var a=this;this._pluginContainer.delegate("click",".mui-mbarp-favor-to-detail",function(e){a._toItemDetail(e)})},"_toItemDetail":function(e){var t=a.one(e.currentTarget),i=t.parent(".mui-mbarp-favor-item"),n=t.attr("data-type"),r=i.attr("data-itemId"),m=this._itemListCache[r];m.recommandType=n,"match"==n?o.sendLog(s.ARR.FAVOR_TO_MATCH):o.sendLog(s.ARR.FAVOR_TO_FX),this._initItemDetail(m),this._switchToFavorDetail(i),e.halt()},"_switchToFavorDetail":function(e){var i=e.attr("data-itemId"),n=this._itemListCache[i];if(n.itemPicBig=n.itemPic+"_240x240.jpg",!(a.UA.ie<9)){var s='<img class="mui-mbarp-favor-flayer" src="'+n.itemPicBig+'"/>',o=e.offset(),r=this._pluginContainer;o.top=o.top-a.one(window).scrollTop(),o.left=o.left-r.offset().left;var m={"left":0,"top":40};s=t(s),s.css(o),r.append(s),s.animate({"left":m.left,"top":m.top,"width":235,"height":235},{"duration":.3,"easing":"easeOut","complete":function(){s.animate({"opacity":0},{"duration":.2,"easing":"easeOut","complete":function(){s.remove()}})}})}(this._favorDetail||a.one(".mui-mbarp-favor-detail")).animate({"right":0},{"duration":.3,"easing":"easeOut"})},"_switchBackToList":function(){this.notGetFavorList&&this._initContainer(),(this._favorDetail||a.one(".mui-mbarp-favor-detail")).animate({"right":-235},{"duration":.3,"easing":"easeOut"})},"_initItemDetail":function(a){o.log("::to item Detail::",a),this._initFavorDetailBig(a),this._initRecommandList(a)},"_initFavorDetailBig":function(e){var t=this,i=t.mallbar||{},n='<a target="_blank" href="{itemUrl}" class="mui-mbarp-favor-detail-big">                    <img src="{itemPicBig}" width="235" height="235"/>                    <p class="mui-text-overflow"><span class="mui-mbarp-11-flag-span {isTm11}"></span>            {itemTitle}</p>               </a>';e.tag201511&&i.tag201511Time?e.isTm11="":e.isTm11="hidden",e.itemPicBig=e.itemPic+"_240x240.jpg";var s=a.substitute(n,e);this._favorItemBigCont||(this._favorItemBigCont=a.one(".mui-mbarp-favor-item-b")),this._favorItemBigCont.html(s)},"_initRecommandList":function(e){this._tabItemMatch=this._tabItemMatch||a.one(".mui-mbarp-favor-recommand-tab-item-match"),this._tabItemFx=this._tabItemFx||a.one(".mui-mbarp-favor-recommand-tab-item-fx"),this._tabContentMatch=this._tabContentMatch||a.one(".mui-mbar-favor-recommand-content-match"),this._tabContentFx=this._tabContentFx||a.one(".mui-mbar-favor-recommand-content-fx"),"match"==e.recommandType?(this._tabItemMatch.addClass("mui-mbarp-favor-recommand-tab-item-sellected"),this._tabItemFx.removeClass("mui-mbarp-favor-recommand-tab-item-sellected")):(this._tabItemMatch.removeClass("mui-mbarp-favor-recommand-tab-item-sellected"),this._tabItemFx.addClass("mui-mbarp-favor-recommand-tab-item-sellected")),this._favorTabContents.html(""),this._initTabContent("match",e),this._initTabContent("fx",e)},"_initTabContent":function(e,t){var i,r,l=this,c=l.mallbar||{};"match"==e?(i=this._tabContentMatch,r=s.URL.GET_PLUGIN_FAVOR_MATCH):(i=this._tabContentFx,r=s.URL.GET_PLUGIN_FAVOR_FX),new n({"url":r,"dataType":"jsonp","type":"GET","scriptCharset":"gbk","data":{"itemId":t.itemId,"categoryId":t.categoryId||"","sellerId":t.sellerId||""},"success":function(n){o.log("::favor item recommand::",n);var s=[];n&&n.data&&n.data.length&&(s.push("<ul>"),a.each(n.data,function(e,t){t>11||(e.tag201511&&c.tag201511Time?e.isTm11="":e.isTm11="hidden",e.picUrl=m(e.picUrl)+"_100x100.jpg",s.push(a.substitute('<li class="mui-mbarp-favor-recommand-item">                <a target="_blank" href="{itemUrl}">                    <img src="{picUrl}" width="100" height="100"/>                    <p class="price" title="&yen;{promotionPrice}"><span class="mui-price-font">&yen;</span>{promotionPrice}</p>                    <span class="mui-mbarp-11-flag top {isTm11}"></span>                </a></li>',e)))}),s.push("</ul>"),i.html(s.join("")),e==t.recommandType&&(l._favorTabContents.hide(),i.show()),n.exposureParam&&o.sendLog(n.exposureParam))},"error":function(a){}})},"_renderSingleTime":function(e){var t=this,i=t.mallbar||"";if(e.length){var n=[];return n.push('<div class="mui-mbarp-favor-item-time mui-mbarp-favor-item-list-'+e.name+'">'),n.push('<div class="mui-mbarp-favor-item-time-box"><span class="mui-mbarp-favor-item-time-info">'+e.desc+"</span></div>"),n.push('<div class="mui-mbarp-favor-item-list mui-fix-float">'),a.each(e,function(o,r){r%20==0&&n.push("<ul>"),o.isOdd=""+r%2,t._itemListCache[o.itemId]=o,o.itemUrl=o.itemUrl+"&scm="+s.SCM.FAVOR_ITEM,o.itemPic&&o.itemPrice&&(o.itemPic=m(o.itemPic),o.priceDown>0?o.isDown="":o.isDown="hidden",o.tag201511&&(o.tagClass="mui-mbarp-favor-item-tag2015111"),o.tag201511&&i.tag201511Time?o.isTm11="":o.isTm11="hidden",o.itemPicSmall=o.itemPic+"_100x100.jpg",n.push(a.substitute('<li class="mui-mbarp-favor-item mui-mbarp-favor-item-{cateFrontId} mui-mbarp-favor-item-index-{isOdd} {tagClass}" data-itemId="{itemId}" data-sellerId="{sellerId}" data-categoryId="{categoryId}">                <a target="_blank" href="{itemUrl}">                    <img src="{itemPicSmall}" width="100" height="100"/>                    <div class="mui-mbarp-favor-item-info">                        <em class="mui-mbarp-favor-item-sale {isDown}">                            <div class="mui-mbarp-favor-item-sale-info">                                <div class="mui-mbarp-favor-item-sale-info-cont">                                    <b></b>                                    <p>\u6bd4\u6536\u85cf\u65f6\u76f4\u964d\uff1a<span class="mui-price-font">&yen;{priceDown}</span></p>                                    <p>\u52a0\u5165\u6536\u85cf\u65f6\u4ef7\u683c\uff1a<span class="mui-price-font">&yen;{itemCollectPrice}</span></p>                                </div>                            </div>                        </em>                        <span class="mui-price-font" title="&yen;{itemPrice}">&yen;{itemPrice}</span>                    </div>                    <div class="mui-mbarp-favor-item-relation">                        <span class="mui-mbarp-favor-item-match mui-mbarp-favor-to-detail" data-type="match">\u627e\u642d\u914d</span>                        <span class="mui-mbarp-favor-item-fx mui-mbarp-favor-to-detail" data-type="fx">\u627e\u540c\u6b3e</span>                    </div>                    <span class="mui-mbarp-favor-cancel mui-favor-delete" title="\u53d6\u6d88\u6536\u85cf" data-itemId="{itemId}"></span>                   <span class="mui-mbarp-11-flag top {isTm11}"></span>                </a>                </li>',o))),r%20!=19&&r+1!=e.length||n.push("</ul>")}),n.push("</div></div>"),n.join("")}return""},"renderSingleRecommend":function(e){if(e&&e.item){var t=e.type||"fx",i=e.item;i.recommandType=t,this.notGetFavorList=!0,this._initItemDetail(i),(this._favorDetail||a.one(".mui-mbarp-favor-detail")).css({"right":"0px"})}}}),l},{"requires":["base","node","event","ajax","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/plugin-favor.css"]});KISSY.add("mui/mallbar/plugin-charge",function(a,e,i,t,s,n){var o=function(a){var e=this;o.superclass.constructor.call(e,a),e.init()};return a.extend(o,e,{"init":function(){var e=this,i=e.get(s.K.MALLBAR_ITEM),t=i.get(s.K.MALLBAR),n=e.get(s.K.CONTAINER),o=i.get(s.K.TAB);"mallfp"==t.get(s.K.G_CONFIG).bizId&&o.show(),e.on("visibilityChange",function(e){e.visible&&e.first&&a.use("mui/chongzhi/index",function(a,e){n.html('<div id="J_MbarPhoneCharge" class="mui-mbar-plugin-phone-charge"></div><div id="J_MbarDianquanCharge" class="mui-mbar-plugin-dianquan-charge"></div>'),setTimeout(function(){var i=a.one("#J_MbarPhoneCharge");i&&e(i)},0)})})}}),o},{"requires":["base","node","event","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/plugin-charge.css"]});KISSY.add("mui/mallbar/plugin-cart",function(a,e,i,t,s,n,o,r,l){var m=function(a){var e=this;m.superclass.constructor.call(e,a),e.init()};return a.extend(m,e,{"init":function(){var e=this,i=e.get(s.K.CONTAINER),t=e.get(s.K.MALLBAR_ITEM),o=t.get(s.K.MALLBAR),m=t.get(s.K.TAB),c=t.getUserInfo(),u=a.all('<div class="mui-mbarp-tab-cart-border "></div>').appendTo(m);m.on("mouseenter",function(){u.hide()}).on("mouseleave",function(){t.get(s.K.EXPAND)||u.show()}),c.isLogin||(m.one(".mui-mbar-tab-logo-cart").addClass(".mui-mbar-tab-logo-nologin-cart"),m.one(".mui-mbarp-tab-cart-border").addClass("mui-mbarp-tab-cart-border-nologin"),m.addClass("mui-mbar-tab-cart-nologin")),o.on(s.E.MALLBAR_STATUS_CHANGE,function(a){s.S.STANDARD===a.status?u.show():u.hide()}),t.on(s.E.LOGIN_SUCCESS,function(a){m.one(".mui-mbar-tab-logo-cart").removeClass(".mui-mbar-tab-logo-nologin-cart"),m.one(".mui-mbarp-tab-cart-border").removeClass("mui-mbarp-tab-cart-border-nologin"),m.removeClass("mui-mbar-tab-cart-nologin"),e._updateMiniCartNum(function(){})}),l.set("_mallbarItem",t),l.set("_mallbarConf",s),e._bindCartModel(),e._bindResize(),e._updateMiniCartNum(),e.on("visibilityChange",function(a){if(a.visible?u.hide():u.show(),a.visible&&a.first?(i.html('<div class="mui-mbarp-cart-wrap"><div id="J_MBarMiniCart" class="mui-mbarp-cart-bd"></div></div>'),r.init("#J_MBarMiniCart")):a.visible&&(r.strectch(),e._resize()),a.visible){o.get("isBucket10")?n.sendLog(s.ARR.CART_TAB_CLICK_DOWN):n.sendLog(s.ARR.CART_TAB_CLICK);0==(e.total||0)&&l.record("tmalljy.2.5?action=open-with-size-zero")}}),e._contentReady(".tm-mcCartBtn",function(){a.one(".tm-mcCartBtn").text("\u67e5\u770b\u5168\u90e8")}),e.on("addCartItem",function(){e._updateMiniCartNum()}),e.fire(s.E.ADD_CART_ITEM)},"_contentReady":function(e,i){var t=!1;setTimeout(function(){t=!0},5e3),setTimeout(function(){var s=a.one(e);s&&s.children()?i():t||setTimeout(arguments.callee,50)},50)},"_bindCartModel":function(){var a=this,e=a.get(s.K.MALLBAR_ITEM);l.on("numChange",function(a){var i=e.getUserInfo();if(!i.isLogin)return void e.fire("suptipChange",{"show":!1});if(i&&i.isMallSeller)return void e.fire("suptipChange",{"show":!0,"num":0});var t=l.get("totalSize");"number"==typeof t&&"-1"!=t&&e.fire("suptipChange",{"show":!0,"num":t,"isCartNum":!0})}),l.on("numChangeCheckCount",function(){var a=e.getUserInfo();if(!a.isLogin)return void e.fire("suptipChange",{"show":!1});if(a&&a.isMallSeller)return void e.fire("suptipChange",{"show":!0,"num":0});var i=l.get("__totalCount__");"number"==typeof i&&"-1"!=i&&e.fire("suptipChange",{"show":!0,"num":i,"isCartNum":!0})}),l.on("mallBarMiniCartNum",function(i){var t=i.data,s=t.callback,n=l.getNum("total");a.total=n;var o=e.getUserInfo();if(!o.isLogin)return void e.fire("suptipChange",{"show":!1});o&&o.isMallSeller?e.fire("suptipChange",{"show":!0,"num":0}):e.fire("suptipChange",{"show":!0,"num":n,"isCartNum":!0}),s&&s(!o.isLogin&&0===n)})},"needLogin":function(a){a()},"disableExpand":function(){var a=this,e=a.get(s.K.MALLBAR_ITEM),i=e.getUserInfo();return!(!i||!i.isMallSeller)&&(n.sendLog("//log.mmstat.com/tmalljy.2.5?action=openmini_v101"),e.fire(s.E.BUBBLE_CHANGE,{"show":!0,"customContentType":1,"bubbleType":0,"showDelay":100,"html":"\u60a8\u662f\u5929\u732b\u5356\u5bb6\uff0c\u4e0d\u80fd\u4f7f\u7528\u8d2d\u7269\u8f66"}),!0)},"_bindResize":function(){var e=this,t=e.get(s.K.MALLBAR_ITEM),n=t.get(s.K.MALLBAR);i.delegate(document,"renderMiniCartList","#J_MBarMiniCart",function(){e._resize()}),i.delegate(document,"miniCartEmpty","#J_MBarMiniCart",function(){a.later(function(){n.collapse({"status":2})},2e3)})},"_bindScroll":function(){var e=a.one(".mui-mbar-plugin-cart").one(".mui-mbar-plugin-bd");i.on(e,"scroll",a.buffer(function(i){var t=a.one(".mui-mbar-plugin-cart").one(".tm-mcHandler"),s=a.one(".mui-mbar-plugin-cart").one(".tm-mcTop"),n=e.height();t.css({"position":"absolute","top":i.currentTarget.scrollTop+n-85}),s.css({"position":"absolute","top":i.currentTarget.scrollTop})},8>t.ie?150:-1))},"_resize":function(){function e(){a.one(".tm-mcListBox").css({"padding-bottom":"0px"})}e();var i=a.one(".mui-mbar-plugin-cart"),t=i.one(".mui-mbar-plugin-bd"),s=i.one(".tm-mcHandler"),n=(i.one(".tm-mcTop"),i.height()),o=a.one(".mui-mbarp-cart-bd").innerHeight(),r=s.height()+15;t.height(n),o>=n-r?l.get("quickSettlement")&&a.one(".tm-mcListBox").css({"padding-bottom":r}):e()},"_updateMiniCartNum":function(e){var i=this,n=(6==t.ie||t.ie,i.get(s.K.MALLBAR_ITEM)),o=(n.get(s.K.MALLBAR),function(i){var t=i.uid,s="TCART_234_"+t+"_q",n=function(i){i=i||{};var t=a.isNumber(i[s]);l.setNum({"normal":t?l.formatNum(i[s]):0,"invalid":0}),l.fire("mallBarMiniCartNum",{"data":{"callback":e}})};t?l.xhr({"api":"num","data":{"keys":s},"complete":n}):n()});TB.Global.loginStatusReady(function(e){if(e.isLogin){var i=a.later(o,5e3);TB.Global.memberInfoReady(function(a){i.cancel();var e=a.memberInfo;o({"uid":e.cookies&&e.cookies.unb?e.cookies.unb.value:""})})}else o({"uid":e.trackId})})}}),m},{"requires":["base","event","ua","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","mui/minicart/minicart","mui/minicart/model","mui/mallbar/plugin-cart.css"]});KISSY.add("mui/mallbar/plugin-nav",function(a,e,i,t,o,n,s,r){var m=(['<img class="mui-mbarp-nav-logo mui-mbarp-nav-logo-anim" src="{0}" />'].join(""),function(a){var e=this;m.superclass.constructor.call(e,a),e.init()});return a.extend(m,e,{"init":function(){function a(){i.one(".mui-mbarp-nav-bd").height(i.height())}var e=this,i=e.get(n.K.CONTAINER),t=e.get(n.K.MALLBAR_ITEM),o=t.get(n.K.TAB),r=o.one(".mui-mbar-tab-txt"),m=o.one(".mui-mbar-tab-tip"),l=o.one(".mui-mbar-tab-tip-arr"),c=o.one(".mui-mbar-tab-logo-nav"),u=t.get("data"),b=(t.get(n.K.MALLBAR),o.one(".mui-mbar-tab-logo-nav-top"));e.on(n.E.VISIBILITY_CHANGE,function(e){e.visible&&e.first&&s.getStaticConf({"cb":function(e){i.html(s.fm('<iframe src="{0}" class="mui-mbarp-nav-bd" frameborder="0"></iframe>',e.navUrl||n.U.NAV_TMS)),a()}}),a()});var d="//1111.tmall.com";u&&(u.logo&&c.css(KISSY.UA.ie&&KISSY.UA.ie<9?{"filter":"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+u.logo+"',sizingMethod='scale')"}:{"background-image":"url("+u.logo+")","background-size":"100%"}),u.bgColor&&(o.css("background-color",u.bgColor),m.css("background-color",u.bgColor),l.css("color",u.bgColor)),u.txtColor&&(r.css("color",u.txtColor),m.css("color",u.txtColor)),b&&u.topBgColor&&b.css("background-color",u.topBgColor),u.link&&o.on("click",function(a){var e=window.g_config||{};return"mui-mbar-tab-logo-nav-top"==a.target.className?void window.open(s.replaceSCM(u.topLink||d,"1048.1.7.8")):e.mallbarTaobao?void window.open(s.replaceSCM(u.taobaoLink||"//world.taobao.com/markets/all/15s11/main","1048.1.7.7")):void window.open(s.replaceSCM(u.link||d,"1048.1.7.4"))}))}}),m},{"requires":["base","node","ua","event","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","mui/mallbar/plugin-nav.css"]});KISSY.add("mui/mallbar/plugin-worth",function(a,e,i,t,o,n,r,s){var m=function(a){var e=this;m.superclass.constructor.call(e,a),e.init()};return a.extend(m,e,{"init":function(){function e(){n.getStaticConf({"cb":function(a){var e=h.one(".mui-mbar-tab-logo-worth");a.worthTabLogo&&e.append(n.fm('<img width="35" heigth="30" src="{0}" />',a.worthTabLogo)),a.worthMore&&(d.moreUrl=n.replaceSCM(a.worthMore,"1048.1.13.6")),a.worthBizBubble&&i()}})}function i(){d.isDetail||d.isShop||(A.isLogin?r.get({"k":"mui/mbarp/worth/biz/bubble/"+f.getUid(),"success":function(a){a||t(2,"biz")}}):t(4.4,"biz"))}function t(a,e){var i=['<div class="mui-mbar-bubble mui-mbarp-bubble-worth" >','<div class="mui-mbar-arr mui-mbarp-bubble-worth-arr">\u25c6</div>',"</div>"].join(""),t=['<div class="mui-mbar-bubble mui-mbarp-bubble-worth-biz" >','<div class="mui-mbar-arr mui-mbarp-bubble-worth-arr-biz">\u25c6</div>',"</div>"].join(""),s=i,m="mui/mbarp/worth/bubble/"+f.getUid(),l="WORTH_BUBBLE_SHOW",c="WORTH_BUBBLE_CLICK";"biz"==e&&(s=t,m="mui/mbarp/worth/biz/bubble/"+f.getUid(),l="WORTH_BUBBLE_BIZ_SHOW",c="WORTH_BUBBLE_BIZ_CLICK"),g.bubble({"show":!0,"content":s,"customContentType":3,"flag":a,"height":77,"bubbleType":0,"tab":"WORTH","isNotTabFire":!0,"showed":function(){n.sendLog(o.ARR[l]),A.isLogin&&r.set({"k":m,"v":1,"expires":1})},"clicked":function(){!!h&&h.fire("click"),n.sendLog(o.ARR[c])},"dismiss":function(){}})}function m(){p.html('<div class="mui-mbarp-worth-recommend"></div><div class="mui-mbarp-worth-guess"></div><a class="mui-mbarp-worth-more" target="_blank" href="//www.tmall.com/wow/portal/act/worth-to-buy?scm=1048.1.13.6"><span class="icon">+</span>\u67e5\u770b\u66f4\u591a</span></a>'),d.isDetail?l():c(),u(),b()}function l(){var e='<li class="mui-mbarp-worth-recommand-item">                <a target="_blank" href="{{itemUrl}}">                    <img src="{{itemPic}}_100x100" width="100" height="100"/>                    <p title="&yen;{{itemPrice}}">&yen;{{itemPrice}}</p>                    {{#if tag201511}}<span class="mui-mbarp-11-flag worth"></span>{{/if}}                </a></li>',i=g.get("itemId")||"",t=g.get("sellerId")||"",o="";window.g_config&&window.g_config.categoryId&&(o=window.g_config.categoryId);var r="";n.ajax({"url":"//bar.tmall.com/getSimilarItems.htm","jsonpCallback":"_mallbarWorthRecommend","dataType":"jsonp","data":{"sellerId":t,"nid":i,"categoryId":o},"timeout":5,"success":function(i){if(i){var t=p.one(".mui-mbarp-worth-recommend"),o=i.l||"";o&&o.length>0&&(r+='<p class="mui-mbarp-worth-recommend-hd">\u76f8\u4f3c\u5546\u54c1\u63a8\u8350</p><ul class="mui-mbarp-worth-recommend-ul">',a.each(o,function(a){a.tag201511=a.tag201511&&g.tag201511Time,a.itemUrl=n.replaceSCM(a.itemUrl,"1048.1.13.3"),r+=new s(e).render(a)}),r+="</ul>",t.html(r),!!i.exposureParam&&n.sendLog(i.exposureParam))}},"error":function(){}})}function c(){var e='<li class="mui-mbarp-worth-recommand-item">                <a target="_blank" href="{{url}}">                    <img src="{{picUrl}}_100x100" width="100" height="100"/>                    <p title="&yen;{{wapFinalPrice}}">&yen;{{wapFinalPrice}}</p>                    {{#if tag201511}}<span class="mui-mbarp-11-flag worth"></span>{{/if}}                   <span class="rank">{{index}}</span>                 </a></li>',i="";window.g_config&&window.g_config.cat_rt&&(i=window.g_config.cat_rt);var t="";n.ajax({"url":"//ald.taobao.com/recommend.htm?appId=07011"+(i?"&catId="+i:""),"jsonpCallback":"_mallbarWorthRecommend","dataType":"jsonp","timeout":5,"success":function(i){if(i){var o=p.one(".mui-mbarp-worth-recommend"),r=i.data||[];(r=r[0]||{})&&r.items&&r.items.length>0&&(t+='<p class="mui-mbarp-worth-recommend-hd">'+r.catName+'\u6392\u884c\u699c</p><ul class="mui-mbarp-worth-recommend-ul">',a.each(r.items,function(a,i){a.index=i+1,a.tag201511=a.tag201511&&g.tag201511Time,a.itemUrl=n.replaceSCM(a.url,"1048.1.13.2"),t+=new s(e).render(a)}),t+="</ul>",o.html(t),!!i.exposureParam&&n.sendLog(i.exposureParam))}},"error":function(){}})}function u(){var a=p.one(".mui-mbarp-worth-guess"),e='<li class="mui-mbarp-worth-recommand-item">                <a target="_blank" href="{{itemUrl}}">                    <img src="{{imgUrl}}" width="100" height="100"/>                    <p title="&yen;{{price}}">&yen;{{price}}</p>                     {{#if tag201511}}<span class="mui-mbarp-11-flag worth"></span>{{/if}}                </a>                </li>',i="";n.ajax({"url":"//ald.taobao.com/recommend.htm?appID=2015101022","dataType":"jsonp","jsonpCallback":"_mallbarWorthLists","data":"","timeout":5,"success":function(t){if(t.data&&t.data.length>0){for(var o=t.data,r=o.length,m="<ul>",l="<ul>",c=0;c<2;c++)o[c].tag201511=o[c].tag201511&&g.tag201511Time,o[c].itemUrl=n.replaceSCM(o[c].itemUrl,"1048.1.13.4"),m+=new s(e).render(o[c]);if(m+="</ul>",r>2)for(var c=2;c<r;c++)o[c].tag201511=o[c].tag201511&&g.tag201511Time,o[c].itemUrl=n.replaceSCM(o[c].itemUrl,"1048.1.13.4"),l+=new s(e).render(o[c]);l+="</ul>",i='<p class="mui-mbarp-worth-recommend-hd">\u731c\u4f60\u559c\u6b22</p><div class="mui-mbarp-worth-guess-top">'+m+'</div><div class="mui-mbarp-worth-guess-banner" id="J_WorthGuessBanner"></div><div class="mui-mbarp-worth-guess-bottom">'+l+"</div>",a.html(i),p.one(".mui-mbarp-worth-more").attr("href",d.moreUrl),p.one(".mui-mbarp-worth-more").addClass("show")}}})}function b(){g&&!g.channelRecommend||n.ajax({"url":"//ald.taobao.com/recommend.htm?appId=05110&personalHallCount=1","dataType":"jsonp","jsonpCallback":"_mallbarWorthBanner","data":"","timeout":5,"success":function(e){if(!!e.exposureParam&&n.sendLog(e.exposureParam),e.data&&e.data.length>0){var i=e.data[0];i.action=n.replaceSCM(i.action,"1048.1.13.5");var t='<a class="mui-mbarp-worth-recommend-banner" href="'+i.action+'" target="_blank"><img src="'+i.imgUrl+'"></a>';a.available("#J_WorthGuessBanner",function(){a.one("#J_WorthGuessBanner").html(t)})}}})}var d=this,p=d.get(o.K.CONTAINER),f=d.mallbarItem=d.get(o.K.MALLBAR_ITEM),g=f.get(o.K.MALLBAR),h=f.get(o.K.TAB),v=h.one(".mui-mbar-tab-sup");d.tip=v,d.get("pluginHead"),d.isDownShelf=!1;var _=n.getSysId();d.isDetail="detail"==_,d.isShop="shop"==_;var A=f.getUserInfo(),I=h.one(".mui-mbar-tab-logo"),C=f.get("data"),T=h.one(".mui-mbar-tab-tip"),E=h.one(".mui-mbar-tab-tip-arr"),B=h.one(".mui-mbar-tab-logo-arr");C&&(C.logo&&I.css(KISSY.UA.ie&&KISSY.UA.ie<9?{"filter":"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+C.logo+"',sizingMethod='scale')"}:{"background-image":"url("+C.logo+")","background-size":"100%"}),C.bgColor&&(h.css("background-color",C.bgColor),T.css("background-color",C.bgColor),E.css("color",C.bgColor),B.css("color",C.bgColor))),e();var L=!0;d.on(o.E.VISIBILITY_CHANGE,function(a){d.tip.hide(),a.visible&&L&&m(),L=!1}),d.on(o.E.DATA_CHANGE,function(a){L=!0,f.get(o.K.EXPAND)&&(d.tip.hide(),m())});var R=window.TShop;R&&R.onProduct&&R.onProduct(function(a){a.onLoad("isDownShelf",function(a){a&&(d.isDownShelf=!0,n.getStaticConf({"cb":function(a){var e=g.get(o.K.MODEL).get(o.K.TIMESTAMP);if(d.isDetail){var i=a.handleDownShelfTime||{},r=i.s?i.s:"1",s=i.e?i.e:"1447257600000";if(A.isLogin&&e>r&&e<s){var l="";if(!!window.g_config&&(l=window.g_config.sellerId||""),a.worthBlacklist=a.worthBlacklist||["217101303","700459267","196993935","352469034","2064892827","470168984","1114511827","1714128138","2616970884","1917047079","2037040441","263680407"],a.worthBlacklist&&a.worthBlacklist.length)for(var c=a.worthBlacklist.length,u=a.worthBlacklist,b=0;b<c;b++)l==u[b]&&(d.notNeedExpand=!0);d.notNeedExpand?t(2):(m(),L=!1,!!h&&h.fire("click"),n.sendLog(o.ARR.WORTH_TAB_EXPAND))}else t(2)}}}))})})}}),m},{"requires":["base","node","event","mui/mallbar/conf","mui/mallbar/util","mui/mallbar/store","xtemplate","mui/mallbar/plugin-worth.css"]});