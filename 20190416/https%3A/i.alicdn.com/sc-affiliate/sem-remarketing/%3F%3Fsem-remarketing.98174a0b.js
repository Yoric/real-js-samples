(function(){var e=function(){var e={},t={exports:e};(function(e,t){var require={resolve:function(e){return r+"/"+e}};var r=e.location.protocol+"//i.alicdn.com",a=require.resolve("sc-affiliate/sem-remarketing/proxy.8144c682.html?iframe_delete=true"),n="//offer.alibaba.com/product/fetchSiteTag.jsonp";var o=e.SEMR={_postData:{},_bindEvent:function(e,t,r){if(e.addEventListener){e.addEventListener(t,r,false)}else if(e.attachEvent){e.attachEvent("on"+t,r)}},_initIframeProxy:function(){var e=document,t=e.body||e.documentElement,r="sem-remarketing",n=r,o=e.getElementById(r);if(o&&o.nodeType){return}o=e.createElement("iframe");o.id=r;o.name=n;o.style.display="none";o.style.visibility="hidden";o.src=a;t.appendChild(o)},_isEmptyObject:function(e){for(var t in e){return false}return true},_isP4P:function(){return/s=p/.test(location.href)},_isWap:function(){return(e.$client&&e.$client.client)!==t},_log:function(t){if(e.console&&e.console.log){e.console.log(t)}o._sendDomdot("26131","error="+t)},_send:function(){var t=e.SEM_REMARKETING_CONFIG||{},r=e.SEM_REMARKETING_DATA||{};if(t.sent){return false}if(o._isEmptyObject(r)){return false}t.sent=true;e.SEM_REMARKETING_CONFIG=t;r.isP4P=o._isP4P();r.pageDevice=o._isWap()?"Mobile":"PC";if(r.categoryId){r.categoryId=r.categoryId.split(",")[0]}if(r.productId){r.productId=r.productId.split(",")[0]}if(r.pageCate){r.pageCate=r.pageCate.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}if(r.pageName){r.pageName=r.pageName.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}var a={timeout:1e3*20,url:n,callback:"callback",data:{siteName:r.siteName||"",pageFrom:r.pageType||"",pageInfo:JSON.stringify(r),language:r.pageLanguage||""},success:function(e){if(!e||!e.success||!e.result){return false}var t=[].concat(e.result);if(t.length>0){o._postData=t;o._initIframeProxy();o._sendDomdot("26131","success")}},fail:function(e){o._log("SEMRSE-01-02")}};o._sendJsonp(a);o._sendDomdot("26131","initialization")},_sendByIframeProxy:function(t){if(t.origin!=r){return false}var a=t.data;if(typeof a!=="string"){return false}var n,i;var s=[];try{if(typeof a.split==="function"){s=a.split(":")}else if(typeof String.prototype.split==="function"){s=String.prototype.split.call(a,":")}if(Object.prototype.toString.call(s)==="[object Array]"){n=s[0];i=s[1]||""}}catch(t){console.error("sem-remarketing _sendByIframeProxy error:",t);e._WPO&&e._WPO.error("sem-remarketing _sendByIframeProxy error",a)}if(n=="ready"){var c=JSON.stringify(o._postData);if(t.source&&t.source.postMessage){t.source.postMessage(c,r)}}else if(n=="error"){o._log(i)}else if(n=="complete"){o._sendDomdot("26254",i)}},_sendDomdot:function(t,r){var a=e.SEM_REMARKETING_DATA&&e.SEM_REMARKETING_DATA.pageType,n={ext:"event="+a+"|"+r,mn:"sem"};if(e.dmtrack&&e.dmtrack.dotstat&&e.dmtrack_pageid&&t){e.dmtrack.dotstat(t,n)}},_sendJsonp:function(t){t=t||{};if(!t.url||!t.callback){throw new Error("params error!")}var r=t.data[t.callback]="jsonp_"+new Date*1+""+Math.ceil(Math.random()*1e5),a=o._toQueryString(t.data,"&"),n=document.createElement("script"),i=document.getElementsByTagName("head")[0];i.appendChild(n);e[r]=function(a){i.removeChild(n);clearTimeout(n.timer);e[r]=function(){};t.success&&t.success(a)};n.src=t.url+"?"+a;if(t.timeout){n.timer=setTimeout(function(){e[r]=function(){};i.removeChild(n);t.fail&&t.fail({message:"overtime"})},t.timeout)}},_toQueryString:function(e,t){var r,a,n=[];if(!e){return""}for(r in e){a=e[r]||"";n.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}return n.join(t||"&")}};try{if(e.postMessage){o._bindEvent(e,"message",o._sendByIframeProxy);var i=e.SEM_REMARKETING_CONFIG||{};if(i.runtime=="async"){o._send()}else{c(e,o._send.bind(o))}}else{o._log("SEMRSE-01-01")}}catch(s){o._log("SEMRSE-01-00")}function c(e,t){var r=false,a=true,n=e.document,o=n.documentElement,i=n.addEventListener,s=i?"addEventListener":"attachEvent",c=i?"removeEventListener":"detachEvent",l=i?"":"on",f=function(a){if(a.type=="readystatechange"&&n.readyState!="complete")return;(a.type=="load"?e:n)[c](l+a.type,f,false);if(!r&&(r=true))t.call(e,a.type||a)},d=function(){try{o.doScroll("left")}catch(e){setTimeout(d,50);return}f("poll")};if(n.readyState=="complete"){t.call(e,"lazy")}else{if(!i&&o.doScroll){try{a=!e.frameElement}catch(u){}if(a)d()}n[s](l+"DOMContentLoaded",f,false);n[s](l+"readystatechange",f,false);e[s](l+"load",f,false)}}})(window);return t.exports}()})();;
