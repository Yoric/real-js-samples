!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={logInfo:function(e,t,n){},logWarning:console.warn.bind(console),logError:console.error.bind(console)};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a=n(0);function o(e,t,n,r){return e.open(t).then(function(e){return c(e,n,r)})}function c(e,t,n){return e.match(t).then(function(e){return null!=e?n?e.json():e.text():Promise.resolve(null)})}function i(e){var t=e.split("/");return t[t.length-1]}t.cacheMatchIgnoreSearchOption={ignoreSearch:!0},t.matchCache=function(e,t){if(null==e)throw new Error("cacheName can't be null");return t.keys().then(function(n){var r=n.filter(function(t){return t==e});return 1==r.length?t.open(r[0]):Promise.resolve(null)})},t.cacheResource=function(e,t,n){if(t.ok)return n.put(e.toLowerCase(),t);var r=new Error("Unexpected resource status");return r.resource=e,r.status=t.status,Promise.reject(r)},t.updateCache=function(e,t,n,r){return e.open(t).then(function(e){return e.put(n,new Response(r))})},t.tryRespondFromCache=function(e,t){return e.match(t.toLowerCase())},t.tryRespondFromCaches=function(e,t,n,r){return t.reduce(function(t,a){return t.then(function(t){return null!=t?t:e.open(a).then(function(e){return e.match(n.toLowerCase(),r)})})},Promise.resolve(null))},t.getCachedUrls=function(e,t){return Promise.all(t.map(function(t){return e.open(t).then(function(e){return e.keys()})})).then(function(e){for(var t=[],n=0;n<e.length;++n){var r=e[n];if(null!=r)for(var a=0;a<r.length;++a)null!=r[a]&&t.push(r[a].url)}return t})},t.getAllNonNullValuesFromCache=function(e,t){var n=null;return e.open(t).then(function(e){return n=e,e.keys()}).then(function(e){return function(e,t){return Promise.all(t.map(function(t){return e.match(t).then(function(e){return null!=e?e.text():Promise.resolve(null)})})).then(function(e){return e.filter(function(e){return null!=e})})}(n,e)})},t.getJSONValue=function(e,t,n){return o(e,t,n,!0)},t.getJSONValueFromCache=function(e,t){return c(e,t,!0)},t.getTextValue=function(e,t,n){return o(e,t,n,!1)},t.deleteKey=function(e,t,n){return e.open(t).then(function(e){return a.default.logInfo("[SW] Deleteting cache:",n),e.delete(n)})},t.addJSONValue=function(e,t,n,r){return e.open(t).then(function(e){return e.put(n,new Response(JSON.stringify(r)))})},t.clearAllCaches=function(e,t,n){var r=null;return e.keys().then(function(o){return null!=n&&(o=o.filter(function(e){return n.indexOf(e)<0})),o=o.filter(function(e){return 0==e.indexOf(t+"_")}),r=o,Promise.all(o.map(function(t){return a.default.logInfo("[SW] Deleteting cache:",t),e.delete(t)}))}).then(function(e){return Promise.resolve(r)})},t.generateMetadataKey=function(e){return r.default.metadataKeyPrefix+e},t.extractKey=i,t.extractKeys=function(e){return e.map(function(e){return i(e)})},t.getResourcesCacheNameSignature=function(e,t,n,r){return e+"_"+t+"_"+n+"_"+r},t.getMetadataCacheName=function(e,t){return e+"_"+t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.Scope=function(t){if(null==e.scope&&null!=t.registration){var n=new URL(t.registration.scope).pathname.split("/");n.length>=2&&n[1].length>0?e.scope=n[1]:e.scope="root"}return e.scope},e}();r.activeCachesCacheNameSuffix="active_caches",r.swMetadataCacheSuffix="metadata_cache",r.versionKeyName="version",r.swVersion=1,r.cacheVersion=1,r.supportedVdir={owa:1},r.defaultVdir="owa",r.javascriptRedirect="<!DOCTYPE html><html><head><script type='text/javascript'>window.location.replace('#path#' + window.location.hash);<\/script></head><body></body></html>",r.metadataKeyPrefix="https://metadata/",r.resourceCachingRequestHeader="x-sw-cache",r.bootCacheHeader="x-boot-manifest",r.languageHeader="x-user-language",r.darkModeHeader="x-darkMode",r.scope=null,t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall"}(t.Action||(t.Action={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),a=n(0),o=function(){function e(e){this.windowObj=e}return e.prototype.handleCacheEvent=function(e,t){var n={targetClient:e,messageType:r.ServiceWorkerMessageType.CacheProgress,cacheMessage:t};this.postMessage(n)},e.prototype.handleErrorEvent=function(e,t){var n={targetClient:e,messageType:r.ServiceWorkerMessageType.Error,error:t};this.postMessage(n)},e.prototype.postMessage=function(e){this.windowObj.clients.matchAll().then(function(t){for(var n=0;n<t.length;++n)try{t[n].postMessage(e)}catch(e){a.default.logWarning("[SW] Error while postMessage to clients",e)}})},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),a=n(2),o=n(7),c=n(8),i=n(1),s=n(4),u=n(14),h=i.getMetadataCacheName(a.default.Scope(self),a.default.activeCachesCacheNameSuffix),l=i.getMetadataCacheName(a.default.Scope(self),a.default.swMetadataCacheSuffix),d=a.default.Scope(self),f=new u.default(caches,h),p=new o.default(caches,location,h,f),g=new c.default(caches,self,l,h,d,f),v=new s.default(self);new r.default(self,caches,{swVersion:a.default.swVersion,cacheVersion:a.default.cacheVersion},p,g,l,d,v,f).start()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(2),o=n(1),c=n(3),i=function(){function e(e,t,n,r,a,o,c,i,s){this.queue=new Array,this.caches=t,this.windowObj=e,this.versionMetadata=n,this.fetchManager=r,this.cacheManager=a,this.swMetadataCacheName=o,this.scopeName=c,this.serviceWorkerEventSubscriber=i,this.cachedRequestMap=s}return Object.defineProperty(e.prototype,"CachedVersionMetadata",{set:function(e){this.cachedVersionMetadata=e},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.windowObj.addEventListener("install",this.onInstall.bind(this),!1),this.windowObj.addEventListener("activate",this.onActivate.bind(this),!1),this.windowObj.addEventListener("fetch",this.onFetch.bind(this),!1),this.windowObj.addEventListener("message",this.onMessage.bind(this),!1),this.windowObj.addEventListener("error",this.onError.bind(this),!1),this.cachedRequestMap.update()},e.prototype.onInstall=function(e){var t=this;r.default.logInfo("SW OnInstall"),e.waitUntil(Promise.resolve().then(function(e){return t.getCachedVersionMetadata()}).then(function(e){return t.cachedVersionMetadata=e,null==e||t.versionMetadata.swVersion!=e.swVersion?t.windowObj.skipWaiting():Promise.resolve(null)}).catch(function(e){return r.default.logError("[SW] Error while onInstall event:",e),t.windowObj.skipWaiting()}))},e.prototype.onActivate=function(e){var t=this;r.default.logInfo("SW OnActivate"),e.waitUntil(this.windowObj.clients.claim()),e.waitUntil(Promise.resolve().then(function(e){return t.upgradeCacheSchema()}).catch(function(e){return r.default.logError("[SW] Error while onActivate event:",e),Promise.resolve(null)}))},e.prototype.onFetch=function(e){this.fetchManager.handleFetchEvent(e)},e.prototype.onMessage=function(e){if(r.default.logInfo("SW Received Message",e.data),null!=e.data){var t=e.data;t.action!=c.Action.Install&&t.action!=c.Action.UnInstall||null==t.source||this.cacheManager.queueAction(t.source.toLowerCase(),t)}},e.prototype.onError=function(e){var t=null;if(null!=e.error)t={name:e.error.name,message:e.error.message,stack:e.error.stack};else{var n=e.filename+":colno="+e.colno+":lineno="+e.lineno;t={name:"",message:e.message,stack:n}}r.default.logWarning("[SW] Unhandled error, message: ",t.message," stack: ",t.stack),this.serviceWorkerEventSubscriber.handleErrorEvent("global",t)},e.prototype.upgradeCacheSchema=function(){var e=this;return null==this.cachedVersionMetadata||this.cachedVersionMetadata.cacheVersion!=this.versionMetadata.cacheVersion?(r.default.logInfo("[SW] Upgrading cache schema"),o.clearAllCaches(this.caches,this.scopeName,[this.swMetadataCacheName]).then(function(t){return o.addJSONValue(e.caches,e.swMetadataCacheName,o.generateMetadataKey(a.default.versionKeyName),e.versionMetadata)})):o.addJSONValue(this.caches,this.swMetadataCacheName,o.generateMetadataKey(a.default.versionKeyName),this.versionMetadata)},e.prototype.getCachedVersionMetadata=function(){return o.getJSONValue(this.caches,this.swMetadataCacheName,o.generateMetadataKey(a.default.versionKeyName))},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),a=n(1),o=n(0),c={bo:1,ac:1,bfs:1,authredirect:1,layout:1,flights:1,minus:1,plus:1,animation:1,ver:1,cver:1,forcebo:1,cdn:1,vc:1,allow:1,offline:1,ispopout:1,debugjs:1,culture:1,cvero:1,ae:1,gulp:1,branch:1,features:1,version:1,livepersonacardversionoverride:1,midgardtestendpoint:1,popoutv2:1},i=[".","@","deeplink"],s=new Headers;s.append("Content-Type","text/html");var u={status:200,headers:s},h=function(){function e(e,t,n,r){this.resourcesRegex=new RegExp(/\.(js|eot|ttf|woff|aspx|css|png|gif|ico|svg|jpeg)/i),this.caches=e,this.location=t,this.activeCachesCacheName=n,this.cachedRequestMap=r}return e.prototype.handleFetchEvent=function(e){var t=this;"GET"==e.request.method&&0==e.request.url.indexOf("https")&&this.supportedFetchRoute(e.request)&&e.respondWith(Promise.resolve(e).then(function(e){return t.handleGetResourceFetch(e)}).then(function(n){return null!=n?(o.default.logInfo("[SW] Fetched ",n.url," from cache."),Promise.resolve(n)):t.fetchFromServer(e.request)}).catch(function(n){return t.fetchFromServer(e.request)}))},e.prototype.supportedFetchRoute=function(e){return"navigate"==e.mode||this.cachedRequestMap.has(e.url.toLowerCase())&&this.resourcesRegex.test(e.url)},e.prototype.fetchFromServer=function(e){return fetch(e)},e.prototype.handleGetResourceFetch=function(e){return"navigate"==e.request.mode?this.handleNavigationFetch(e):a.tryRespondFromCache(this.caches,e.request.url)},e.prototype.handleNavigationFetch=function(e){var t,n=this,o=new URL(e.request.url);return this.checkIfRequestIsForWebsiteRoot(o)?Promise.resolve(this.sendJavascriptRedirect("/"+r.default.defaultVdir+"/")):null!=(t=this.tryGetRequestPathWithTrailingSlash(o))?Promise.resolve(this.sendJavascriptRedirect(t)):this.shouldIgnoreSearchParams(o.search)?a.getAllNonNullValuesFromCache(this.caches,this.activeCachesCacheName).then(function(e){if(0==e.length)return Promise.resolve(null);var t=n.getNavigationLookupUrlToMatch(o);return a.tryRespondFromCaches(n.caches,e,t)}):Promise.resolve(null)},e.prototype.checkIfRequestIsForWebsiteRoot=function(e){return"/"==e.pathname&&""==e.search},e.prototype.tryGetRequestPathWithTrailingSlash=function(e){var t=e.pathname.split("/");if(2==t.length&&""==t[0]){var n=t[1].toLowerCase();if(1==r.default.supportedVdir[n])return"/"+n+"/"+e.search}return null},e.prototype.getNavigationLookupUrlToMatch=function(e){for(var t=null,n=0;n<i.length;++n)if(-1!=e.pathname.indexOf(i[n])){t=e.origin+e.pathname;break}if(null==t){var r=e.pathname.split("/");t=r.length<3||3===r.length&&""===r[2]?e.origin+e.pathname:null!=r[1]&&""!=r[1].trim()?e.origin+"/"+r[1]+"/":e.origin+e.pathname}return t},e.prototype.sendJavascriptRedirect=function(e){var t=r.default.javascriptRedirect.replace("#path#",encodeURI(e));return new Response(t,u)},e.prototype.shouldIgnoreSearchParams=function(e){if(0==e.length)return!0;for(var t=e.substr(1).split("&").map(function(e){return e.split("=")[0]}),n=0;n<t.length;++n)if(1==c[t[n].toLowerCase()])return!1;return!0},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),a=n(1),o=n(3),c=n(0),i=n(11),s=n(4),u=function(){function e(e,t,n,r,a,o){this.cacheInstaller={},this.pendingTasks={},this.activeTasks={},this.caches=e,this.windowObj=t,this.scopeName=a,this.swMetadataCache=n,this.activeCachesCacheName=r,this.cachedRequestMap=o}return Object.defineProperty(e.prototype,"CacheIntallers",{get:function(){return this.cacheInstaller},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ActiveTask",{get:function(){return this.activeTasks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PendingTask",{get:function(){return this.pendingTasks},enumerable:!0,configurable:!0}),e.prototype.queueAction=function(e,t){this.pendingTasks[e]=t,this.executePendingAction(e)},e.prototype.executePendingAction=function(e){var t=this;null==this.activeTasks[e]&&null!=this.pendingTasks[e]&&(this.activeTasks[e]=this.pendingTasks[e],delete this.pendingTasks[e],this.cleanupOldCaches().then(function(n){n?t.activeTasks[e].action==o.Action.Install?t.install(e,t.activeTasks[e].bootResourcesOnly,t.activeTasks[e].language,t.activeTasks[e].darkMode,t.activeTasks[e].manifestUrl):t.activeTasks[e].action==o.Action.UnInstall&&t.uninstall(e):(t.createCacheEventAggregator(e).onCleanupError("Failed to clean stale cache."),t.onTaskDone(e))}))},e.prototype.install=function(e,t,n,r,a){var o=this;this.cacheInstaller[e]=this.createCacheInstaller(e,t,n,r,a),Promise.resolve().then(function(t){return o.cacheInstaller[e].install()}).then(function(t){o.onTaskDone(e)}).catch(function(t){c.default.logError("Error while installing cache: ",t),o.onTaskDone(e)})},e.prototype.uninstall=function(e){var t=this,n=a.generateMetadataKey(e),r=this.createCacheEventAggregator(e);Promise.resolve().then(function(e){return a.getTextValue(t.caches,t.activeCachesCacheName,n)}).then(function(e){return c.default.logInfo("[SW] Removing cache:",e),t.caches.delete(e)}).then(function(e){return a.deleteKey(t.caches,t.activeCachesCacheName,n)}).then(function(n){r.onObsolete(),t.onTaskDone(e)}).catch(function(n){c.default.logError("Error while uninstalling cache: ",n),r.onError(n.message,null,null,n.stack,null),t.onTaskDone(e)})},e.prototype.onTaskDone=function(e){var t=this;delete this.cacheInstaller[e],delete this.activeTasks[e],this.windowObj.setTimeout(function(){t.executePendingAction(e)},0),this.cachedRequestMap.update()},e.prototype.nudgePendingActions=function(){var e=this;Object.keys(this.pendingTasks).map(function(t){return e.windowObj.setTimeout(function(){e.executePendingAction(t)},0)})},e.prototype.cleanupOldCaches=function(){var e=this;return Promise.resolve().then(function(t){return a.getAllNonNullValuesFromCache(e.caches,e.activeCachesCacheName)}).then(function(t){return t=[e.activeCachesCacheName,e.swMetadataCache].concat(t),a.clearAllCaches(e.caches,e.scopeName,t)}).then(function(t){return e.createCacheEventAggregator("global").onCleanupSuceeded(t),Promise.resolve(!0)}).catch(function(t){return c.default.logWarning("[SW] Cache cleanup failed",t),e.createCacheEventAggregator("global").onCleanupError("Failed to clean stale caches"),Promise.resolve(!1)})},e.prototype.createCacheInstaller=function(e,t,n,a,o){return new r.default(this.caches,e,this.createCacheEventAggregator(e),t,n,a,o,this.scopeName,this.activeCachesCacheName)},e.prototype.createCacheEventAggregator=function(e){var t=new s.default(this.windowObj);return new i.default(t,e)},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n(2),o=n(1),c=n(10),i=new Headers;i.append(a.default.resourceCachingRequestHeader,"1");var s={credentials:"same-origin",redirect:"manual",headers:i},u={credentials:"same-origin",redirect:"manual",mode:"cors"},h={credentials:"same-origin",redirect:"manual"},l=function(){function e(e,t,n,r,a,o,c,i,s){this.manifestFetchRetryCount=1,this.caches=e,this.cacheNameGroup=t.toLowerCase(),this.cacheEventAggregator=n,this.bootResourcesOnly=r,this.darkMode=o,this.language=a,this.manifestUrl=c.toLowerCase(),this.scopeName=i,this.activeCachesCacheName=s}return Object.defineProperty(e.prototype,"Manifest",{get:function(){return this.manifest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ManifestFetchRetryCount",{get:function(){return this.manifestFetchRetryCount},enumerable:!0,configurable:!0}),e.prototype.install=function(){var e=this;return r.default.logInfo("[SW] Install Cache Group "+this.cacheNameGroup),this.setCurrentInstalledCacheName().then(function(t){return e.fetchManifestFromServer()}).then(function(t){return e.getUpdatedManifestResources(t)}).then(function(t){return e.populateCache(t)}).then(function(t){return e.updateCurrentCacheName()}).catch(function(t){return e.handleCacheInstallError(t)})},e.prototype.setCurrentInstalledCacheName=function(){var e=this,t=o.generateMetadataKey(this.cacheNameGroup);return o.getTextValue(this.caches,this.activeCachesCacheName,t).then(function(t){return e.currentInstalledCacheName=t,Promise.resolve(e.currentInstalledCacheName)})},e.prototype.fetchManifestFromServer=function(){var e=this;r.default.logInfo("[SW] Fetching manifest"),this.cacheEventAggregator.onChecking();var t=this.bootResourcesOnly?"1":"0",n=new Headers;return n.append(a.default.bootCacheHeader,t),null!=this.language&&n.append(a.default.languageHeader,this.language),null!=this.darkMode&&n.append(a.default.darkModeHeader,this.darkMode?"1":"0"),h.headers=n,this.fetchFromServer(this.manifestUrl,h).then(function(t){if(t.ok)return r.default.logInfo("[SW] Fetched manifest."),t.json().then(function(t){return e.manifest=t,t});var n=new Error("Manifest fetch failed");return n.resource=e.manifestUrl,n.status=t.status,Promise.reject(n)}).catch(function(t){return e.manifestFetchFailed(t)})},e.prototype.manifestFetchFailed=function(e){return r.default.logWarning("[SW] Fetch manifest failed: ",e,"retryCount:",this.manifestFetchRetryCount),this.manifestFetchRetryCount>=3?Promise.reject(e):(++this.manifestFetchRetryCount,r.default.logWarning("[SW] Fetch manifest retry:",this.manifestFetchRetryCount),this.fetchManifestFromServer())},e.prototype.getUpdatedManifestResources=function(e){var t=this;return r.default.logInfo("[SW] Checking for update."),this.installingCacheNameSignature=o.getResourcesCacheNameSignature(this.scopeName,this.cacheNameGroup,e.cacheVersion,e.cacheHash),Promise.resolve().then(function(e){return t.readCachedManifest(t.installingCacheNameSignature)}).then(function(n){return null!=n?(r.default.logInfo("[SW] No Update."),Promise.resolve([])):(r.default.logInfo("[SW] Update Found."),t.cacheEventAggregator.onDownloading(),Promise.resolve(t.getResourceList(e)))}).catch(function(n){return r.default.logError("[SW] Failed to check manifest for updates: ",t.installingCacheNameSignature,"Error: ",n),t.cacheEventAggregator.onDownloading(),Promise.resolve(t.getResourceList(e))})},e.prototype.readCachedManifest=function(e){var t=this;return o.matchCache(e,this.caches).then(function(e){return null!=e?o.getJSONValueFromCache(e,o.generateMetadataKey(t.manifestUrl)):Promise.resolve(null)})},e.prototype.updateCurrentCacheName=function(){var e=this;return o.updateCache(this.caches,this.activeCachesCacheName,o.generateMetadataKey(this.cacheNameGroup),this.installingCacheNameSignature).then(function(t){return null!=e.currentInstalledCacheName&&e.currentInstalledCacheName!=e.installingCacheNameSignature?e.cacheEventAggregator.onUpdateReady(e.manifest.cacheVersion):null==e.currentInstalledCacheName?e.cacheEventAggregator.onCached(e.manifest.cacheVersion):e.cacheEventAggregator.onNoUpdate(e.manifest.cacheVersion),Promise.resolve()}).catch(function(e){var t=new Error("Updating Current Cache Name failed: "+e.message);return Promise.reject(t)})},e.prototype.populateCache=function(e){var t=this;return this.caches.open(this.installingCacheNameSignature).then(function(n){return t.fetchAndCacheResources(e,n).then(function(){return t.updateManifestEntry(n)})}).catch(function(e){return r.default.logWarning("[SW] Error occurred while caching resources:",e),t.caches.delete(t.installingCacheNameSignature).then(function(t){return Promise.reject(e)}).catch(function(t){return r.default.logWarning("[SW] Error occurred while cache rollback:",t),Promise.reject(e)})})},e.prototype.updateManifestEntry=function(e){return o.cacheResource(o.generateMetadataKey(this.manifestUrl),new Response(JSON.stringify(this.manifest),{status:200}),e).catch(function(e){var t=new Error("Updating Current Manifest failed: "+e.message);return Promise.reject(t)})},e.prototype.fetchAndCacheResources=function(e,t){var n=this,a=e.map(function(e){return r.default.logInfo("[SW] Caching resource: ",e),n.fetchAndCacheResourceInternal(e,t,0)});return Promise.all(a)},e.prototype.validatePayload=function(e){if(!e.ok){var t=new Error("Error while fecthing a resource.");return t.status=e.status,t.resource=e.url,Promise.reject(t)}switch(r.default.logWarning("[SW] Resource: ",e.url,", fetched."),e.type){case"basic":case"default":case"cors":var n=e.clone();return n.blob().then(function(t){if(0===t.size){r.default.logWarning("[SW] Resource: ",n.url," is not valid, it has length 0.");var a=new Error("Resource with content length 0.");return a.resource=n.url,a.errorType=c.ErrorType.ResourceNotValid,Promise.reject(a)}return r.default.logInfo("[SW] Resource: ",n.url,"is valid."),Promise.resolve(e)}).catch(function(e){return e.errorType!==c.ErrorType.ResourceNotValid&&r.default.logError("[SW] Failed to verify resource size: ",n.url,", Error: ",e),Promise.reject(e)});default:return r.default.logWarning("[SW] Resource: ",e.url,", cannot be validated."),Promise.resolve(e)}},e.prototype.fetchAndCacheResourceInternal=function(e,t,n){var a=this,i=e.dynamicResource?s:u;return this.fetchFromServer(e.request,i).then(this.validatePayload).then(function(n){return o.cacheResource(e.request,n,t)}).then(function(t){return a.cacheEventAggregator.onProgress(e.request)}).catch(function(o){return 2==n&&o.errorType===c.ErrorType.ResourceNotValid?(r.default.logError("[SW] Gave up on resource: ",e.request,", the resource wasn't valid."),Promise.resolve()):2==n?(r.default.logError("[SW] Failed to cache resource: ",e.request,", Error: ",o),o.resource||(o.resource=e.request),Promise.reject(o)):(++n,r.default.logWarning("[SW] Retrying resource: ",e.request," retry:",n),a.fetchAndCacheResourceInternal(e,t,n))})},e.prototype.handleCacheInstallError=function(e){var t=null!=this.manifest?this.manifest.cacheVersion:null;return r.default.logError("[SW] Error occurred while installing cache:",e,"cache version:",t),this.cacheEventAggregator.onError(e.message,e.resource,e.status,e.stack,t),null!=this.currentInstalledCacheName?this.cacheEventAggregator.onIdle():this.cacheEventAggregator.onUnCached(t),Promise.reject(e)},e.prototype.fetchFromServer=function(e,t){return fetch(e,t)},e.prototype.getResourceList=function(e){var t=e.dynamicFiles.map(function(e){return{request:e,dynamicResource:!0}}),n=e.staticFiles.map(function(e){return{request:e,dynamicResource:!1}});return t.concat(n)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Generic=0]="Generic",e[e.ResourceNotValid=1]="ResourceNotValid"}(t.ErrorType||(t.ErrorType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),a=function(){function e(e,t){this.cacheEventSubscriber=e,this.cacheGroup=t}return e.prototype.onChecking=function(){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.Checking})},e.prototype.onDownloading=function(){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.Downloading})},e.prototype.onProgress=function(e){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.Progress,resource:e})},e.prototype.onError=function(e,t,n,a,o){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.Error,error:e,cacheVersion:o,resource:t,status:n,stack:a})},e.prototype.onCleanupSuceeded=function(e){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.CleanupSuceeded,cachesCleaned:e})},e.prototype.onCleanupError=function(e){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.CleanupError,error:e})},e.prototype.onCached=function(e){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.Cached,cacheVersion:e})},e.prototype.onNoUpdate=function(e){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.NoUpdate,cacheVersion:e})},e.prototype.onObsolete=function(){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.Obsolete})},e.prototype.onUpdateReady=function(e){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.UpdateReady,cacheVersion:e})},e.prototype.onIdle=function(){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.Idle})},e.prototype.onUnCached=function(e){this.cacheEventSubscriber.handleCacheEvent(this.cacheGroup,{cacheEvent:r.CacheEventType.UnCached,cacheVersion:e})},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded"}(t.CacheEventType||(t.CacheEventType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error"}(t.ServiceWorkerMessageType||(t.ServiceWorkerMessageType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=n(0),o=function(){function e(e,t){this.caches=e,this.activeCachesCacheName=t,this.map=new Map,this.status=0}return Object.defineProperty(e.prototype,"Status",{get:function(){return this.status},enumerable:!0,configurable:!0}),e.prototype.update=function(){this.updatePending=!0,this.tryUpdate()},e.prototype.has=function(e){return 2!=this.Status||this.map.has(e)},e.prototype.tryUpdate=function(){var e=this;if(1!=this.status&&this.updatePending)return this.status=1,this.updatePending=!1,r.getAllNonNullValuesFromCache(this.caches,this.activeCachesCacheName).then(function(t){return r.getCachedUrls(e.caches,t)}).then(function(t){e.map.clear(),t.forEach(function(t){return e.map.set(t,!0)}),e.onUpdateDone()}).catch(function(t){a.default.logWarning("[SW] Error while updating cached request map,",t),e.onUpdateFailed()})},e.prototype.onUpdateDone=function(){this.status=2,this.updatePending&&this.tryUpdate()},e.prototype.onUpdateFailed=function(){this.status=0},e}();t.default=o}]);