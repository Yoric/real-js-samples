KISSY.add("jbc/lazyload/1.1.7/index",function(t,e,a,n,o,r){function i(a,n,o){a.style.display=b,a.className="";var r=e.create("<div>");a.parentNode.insertBefore(r,a);var i=a.value;if(t.isFunction(o)){var s=o({type:"textarea",elem:a,value:i});s&&(i=s)}e.html(r,i,n)}function s(e,a){var n,o;return(n=e.id)||(n=e.id=t.guid("ks-lazyload")),(o=a.ksLazyloadId)||(o=a.ksLazyloadId=t.guid("ks-lazyload")),n+o}function c(t){return t._ks_lazy_width?t._ks_lazy_width:t._ks_lazy_width=e.outerWidth(t)}function l(t){return t._ks_lazy_height?t._ks_lazy_height:t._ks_lazy_height=e.outerHeight(t)}function u(t,a,n){if(!t.offsetWidth)return!1;var o,r=e.offset(t),i=!0,s=r.left,u=r.top,f={left:s,top:u,right:s+c(t),bottom:u+l(t)};return o=d(a,f),o&&n&&(i=d(n,f)),i&&o}function d(t,e){var a={};return a.top=Math.max(t.top,e.top),a.bottom=Math.min(t.bottom,e.bottom),a.left=Math.max(t.left,e.left),a.right=Math.min(t.right,e.right),a.bottom>=a.top&&a.right>=a.left}function f(e,a){var n=this;if(!(n instanceof f))return new f(e,a);var o=e;t.isPlainObject(o)||(o=a||{},e&&(o.container=e)),f.superclass.constructor.call(n,o),n._callbacks={},n._containerIsNotDocument=9!=n.get("container").nodeType,n._images=[],n._textareas=[],n._initLoadEvent()}function g(a,n,o,r){"img-src"===n&&(n="img"),t.isArray(a)||(a=[e.get(a)]);var s=o||h+p,c=o||v+p;t.each(a,function(t){var a=e.nodeName(t);"img"==n?"img"==a?z(t,s,r):e.query("img",t).each(function(t){z(t,s,r)}):"textarea"==a?e.hasClass(t,c)&&i(t,!0,r):e.query("textarea."+c,t).each(function(t){i(t,!0,r)})})}var m=t.Env.host,_=m.document,h="data-ks-lazyload",v="ks-datalazyload",p="-custom",y="default",b="none",w="scroll",A="touchmove",x="resize",k=100,I=this.name,S=function(t){return(~t.indexOf("alicdn.com")||~t.indexOf("taobaocdn.com"))&&(~t.indexOf(".jpg")||~t.indexOf(".png"))&&(t+="_.webp"),t},z=function(e,a,n){function o(t){e.src!=t&&(e.src=t),e.removeAttribute(a)}a=a||h;var r=e.getAttribute(a),i={type:"img",elem:e,src:r},s=!t.isFunction(n)||n(i)!==!1;s&&i.src&&(f.webp?t.use(new t.Uri(I).resolve("./plugin/webp").toString(),function(){WebP.isSupport(function(t){o(t?S(i.src):i.src)})}):o(i.src))};return f.ATTRS={diff:{value:y},placeholder:{value:"//g.alicdn.com/s.gif"},execScript:{value:!0},container:{setter:function(a){return a=a||_,t.isWindow(a)?a=a.document:(a=e.get(a),"body"==e.nodeName(a)&&(a=a.ownerDocument)),a},valueFn:function(){return _}},autoDestroy:{value:!0},onStart:{vaule:null},scrollBuffer:{value:!0}},t.extend(f,n,{_filterItems:function(){var a=this,n=a.userConfig,o=a.get("container"),r=[],i=[],s=[o];t.isArray(n.container)&&(a._backCompact=1,s=n.container),t.each(s,function(n){r=r.concat(t.filter(e.query("img",n),a._filterImg,a)),i=i.concat(e.query("textarea."+v,n))}),a._images=r,a._textareas=i},_filterImg:function(t){var e=this,a=e.get("placeholder");return t.getAttribute(h)?(t.src||(t.src=a),!0):r},_initLoadEvent:function(){function e(){a._filterItems(),a._isLoadAllLazyElements()||t.ready(i),a.resume()}var a=this,n=new Image,o=a.get("placeholder"),r=a.get("autoDestroy"),i=function(){a._loadItems(),r&&a._isLoadAllLazyElements()&&a.destroy()},s=k;a._loadFn=this.get("scrollBuffer")?t.buffer(i,s,a):i,n.complete?e():n.onload=e,n.src=o},refresh:function(){this._loadFn()},_loadItems:function(){var t,e,a=this,n=a.get("container");(!a._containerIsNotDocument||n.offsetWidth)&&(e=a._getBoundingRect(),!a._backCompact&&a._containerIsNotDocument&&(t=a._getBoundingRect(a.get("container"))),a._loadImgs(e,t),a._loadTextAreas(e,t),a._fireCallbacks(e,t))},_loadImgs:function(e,a){var n=this;n._images=t.filter(n._images,function(t){return u(t,e,a)?z(t,r,n.get("onStart")):!0},n)},_loadTextAreas:function(e,a){var n=this,o=n.get("execScript");n._textareas=t.filter(n._textareas,function(t){return u(t,e,a)?i(t,o,n.get("onStart")):!0},n)},_fireCallbacks:function(e,a){var n=this,o=n._callbacks;t.each(o,function(t,n){var r=t.el,i=!1,s=t.fn;u(r,e,a)&&(i=s.call(r)),i!==!1&&delete o[n]})},addCallback:function(t,a){var n=this,o=n._callbacks;t=e.get(t),o[s(t,a)]={el:e.get(t),fn:a},n._loadFn()},removeCallback:function(t,a){var n=this._callbacks;t=e.get(t),delete n[s(t,a)]},getElements:function(){return{images:this._images,textareas:this._textareas}},addElements:function(a){"string"==typeof a?a=e.query(a):t.isArray(a)||(a=[a]);var n=this,o=n._images||[],r=n._textareas||[];t.each(a,function(e){var a=e.nodeName.toLowerCase();"img"==a?t.inArray(e,o)||o.push(e):"textarea"==a&&(t.inArray(e,r)||r.push(e))}),n._images=o,n._textareas=r},removeElements:function(a){"string"==typeof a?a=e.query(a):t.isArray(a)||(a=[a]);var n=this,o=[],r=[];t.each(n._images,function(e){t.inArray(e,a)||o.push(e)}),t.each(n._textareas,function(e){t.inArray(e,a)||r.push(e)}),n._images=o,n._textareas=r},_getBoundingRect:function(a){var n,o,i,s;if(a!==r){n=e.outerHeight(a),o=e.outerWidth(a);var c=e.offset(a);i=c.left,s=c.top}else n=e.viewportHeight(),o=e.viewportWidth(),i=e.scrollLeft(),s=e.scrollTop();var l=this.get("diff"),u=l===y?o:l,d=0,f=u,g=l===y?n:l,m=0,_=g,h=i+o,v=s+n;return t.isObject(l)&&(d=l.left||0,f=l.right||0,m=l.top||0,_=l.bottom||0),i-=d,h+=f,s-=m,v+=_,{left:i,top:s,right:h,bottom:v}},_isLoadAllLazyElements:function(){var e=this;return e._images.length+e._textareas.length+(t.isEmptyObject(e._callbacks)?0:1)==0},pause:function(){var t=this,e=t._loadFn;if(!t._destroyed&&(a.remove(m,w,e),a.remove(m,A,e),a.remove(m,x,e),e.stop&&e.stop(),t._containerIsNotDocument)){var n=t.get("container");a.remove(n,w,e),a.remove(n,A,e)}},resume:function(){var t=this,e=t._loadFn;if(!t._destroyed&&(a.on(m,w,e),a.on(m,A,e),a.on(m,x,e),t._containerIsNotDocument)){var n=t.get("container");a.on(n,w,e),a.on(n,A,e)}},destroy:function(){var e=this;e.pause(),e._callbacks={},e._images=[],e._textareas=[],t.log("datalazyload is destroyed!"),e.fire("destroy"),e._destroyed=1}}),f.loadCustomLazyData=g,f.webp=!0,t.DataLazyload=f,f},{requires:["dom","event","base","./plugin/webp"]}),KISSY.add("jbc/lazyload/1.1.7/plugin/webp",function(){return function(){function t(t){if(!window.chrome&&!window.opera)return void t(!1);var a=window.localStorage&&window.localStorage.getItem("webpsupport");return null!==a?void t("true"===a):void e(function(e){window.localStorage&&window.localStorage.setItem("webpsupport",e),t(e)})}function e(t){var e=new Image;e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",e.onload=e.onerror=function(){t(2===e.width&&2===e.height)}}this.WebP||(this.WebP={},WebP.isSupport=function(e){return e?void 0===WebP._isSupport?void t(function(t){e(WebP._isSupport=t)}):void e(WebP._isSupport):void 0})}(),window.WebP},{attach:!1,requires:[]}),KISSY.config("modules",{"jbc/lazyload/1.1.7/index":{requires:["dom","event","base","./plugin/webp"]}});