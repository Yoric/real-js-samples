var mcl;(function(n){function bt(n,i,r,u){t&&(y=n,w=i,f=r,p=u,vt())}function rt(n){var t,r;ct||(c&&(t=function(n,t){var i,r;n?(Log.Log("Success","Geolocation","GetEditLocationBox",!1),i=sj_ce("div"),t.appendTo(i),r=_ge("usrlc_cntr"),r&&r.parentElement.appendChild(i)):Log.Log("Fail","Geolocation","GetEditLocationBox",!1)},sj_ajax(c,{callback:t})),ct=!0);r=u(h,l(),a());pt("POPCK");i("POPLOC",r);i("POPBLOC","1");c?sj_evt.fire("ShowPeriodicPopup"):sj_evt.fire("PeriodicPopup"+n)}function yt(n,t){var r=_d.getElementsByClassName("sw_detect"),u=_ge("wpc_chlocpoptxt"+t),f,i;u&&r&&(f=u.getElementsByTagName("a")[r.length>0?1:0],sa_cl(f,"b_hide",n));i=_ge("usrlc_ft"+t);i&&sa_cl(i,"b_hide",!n)}function kt(n,i,r,u,f,c,l,a,v,y,p,w,it,rt,ut,ft,et,ot,ht,ct,vt,yt,pt){if(e=a,o=l,k=v,d=y,g=p,nt=ut,h=w,tt=it,s=ct,st=vt,b=sj_cook.areCookiesAccessible(),pt=pt,t){var wt=_ge("ulpop");if(wt&&wt.parentNode){if(ft)return;wt.parentNode.style.display="none"}lt.push(new at(!0,n,!0,i,r,u,c,-1,!1,f,rt,et,ot,!1,ht,yt))}}function dt(n,r,f,e,o,s){var h,c;s&&(h=_ge(s+"geopop"),h.parentNode.style.display="none");i("POPBLOC","0");n?(e=encodeURIComponent(e),c=u(nt,r,f,e,l(),a()),i("DEFLOC",c),location.href=t(location.href,"form","GEOPOP")):o&&i("POPBLOC","1");n||pt("POPCL")}function gt(n,i,r,u,f,l,a,v,y,p,w,it,rt,ut,ft,et,st,ht){e=a;o=l;k=v;d=y;nt=ut;g=p;h=w;tt=it;ot=!rt;b=sj_cook.areCookiesAccessible();s=st;c=ht;t&&lt.push(new at(n,i,!1,r,!1,0,f,-1,it,u,rt,0,!1,ft,et,!1))}function i(n,t){sj_cook.set(ht,n,t,!0,"/")}function pt(n){var r=sj_cook.get(ht,n),t=1;r!==null&&(t=parseInt(r),t++);i(n,t.toString());Log.Log(n,"Geolocation","CountIncremented",!1,"count",t.toString())}function l(){var n=new Date;return r(n.getUTCFullYear()%100)+r(n.getUTCMonth()+1)+r(n.getUTCDate())}function a(){var n=new Date;return r(n.getUTCHours())+r(n.getUTCMinutes())+r(n.getUTCSeconds())}function r(n){return n>9?n.toString():"0"+n}function u(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return n.replace(/{(\d+)}/g,function(n,t){return typeof i[t]!="undefined"?i[t]:n})}var v=8001,ut=8002,t=typeof UrlLib=="undefined"?null:UrlLib.AddParam,y,p,w,f,ft,b=!1,e,o,et="MONITR",k,d,s,g,nt,h,tt=!1,ot=!0,st=!1,ht="SRCHHPGUSR",ct=!1,wt=!1,c="",lt=n.changeLoc=[],at=function(){function n(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.showErrorBelowLocation=n;this.id=t;this.truncateCordinates=r;this.disableRefresh=u;this.timeDelayForLocationFetch=f;this.timeOutForGPS=e;this.timeTaken=o;this.showFetchHint=s;this.maxAge=h;this.showPeriodicPopUp=c;this.delayforPopup=l;this.markPopupShown=a;this.setCookieAtClientAndRefresh=v;this.popupIdPrefix=y;this.isImplicitQuery=p;var w=this;i?sj_evt.bind("onP1",function(){w.initPopUp()}):(this.bindClicks("sw_detectloc"+w.id,"ChLocDetect"+w.id),w.showPeriodicPopUp?(sj_evt.bind("ChLocDetect"+w.id,function(){rt(w.popupIdPrefix)}),sj_evt.bind("GpsLink"+w.id,function(){w.getGpsLocation()})):sj_evt.bind("ChLocDetect"+w.id,function(){w.getGpsLocation()}))}return n.prototype.getGpsLocation=function(){var n=this,r;navigator.geolocation?(n.timeTaken=(new Date).getTime(),n.showFetchHint&&(r=_ge("wpc_chlocOtherr"+n.id),r&&sa_cl(r,"b_hide",!0),yt(!0,n.id)),navigator.geolocation.getCurrentPosition(function(r){var f=sj_gx(),y=n.truncateCordinates?r.coords.latitude.toFixed(3):r.coords.latitude,p=n.truncateCordinates?r.coords.longitude.toFixed(3):r.coords.longitude,c,h;n.timeTaken=(new Date).getTime()-n.timeTaken;Log.Log("SuccessGet","Geolocation","timeToSuccess",!1,"timeTaken",n.timeTaken.toString(),"LocationTime",r.timestamp.toString(),"accuracy",r.coords.accuracy.toString());e||n.setCookieAtClientAndRefresh?(c=u(g,r.coords.latitude,r.coords.longitude,"",r.coords.accuracy,l(),a()),i("LOC",c),Log.Log("SuccessSet","Geolocation","CookieSetAtClient",!1),n.setCookieAtClientAndRefresh&&(location.href=t(location.href,"form","GEOTRI"))):(h=u(d,y,p,r.coords.accuracy,_G.IG,s),o&&(h=t(h,"FORM",et)),location.href.indexOf("mobile=1")!==-1&&t(h,"mobile","1"),n.isImplicitQuery&&(h=t(h,"isImplicit","1")),f.open("GET",h,!0),f.onreadystatechange=function(){f.readyState==4&&(f.status==200&&(f.responseText=="Ok"||f.responseText=="OkRefresh")?(Log.Log("Success","Geolocation","Detect",!1),n.disableRefresh&&f.responseText!=="OkRefresh"||(location.href=t(location.href,"form","GEOTRI"))):(n.timeTaken=(new Date).getTime()-n.timeTaken,it({code:v},n)))},f.send())},function(t){n.timeTaken=(new Date).getTime()-n.timeTaken;it(t,n)},{timeout:n.timeOutForGPS,maximumAge:n.maxAge})):it({code:ut},n);st&&i("FIRST","0")},n.prototype.bindClicks=function(n,t){var i,r;if(_d.getElementsByClassName&&(i=_d.getElementsByClassName(n),i!=null))for(r=0;r<i.length;r++)sj_be(i[r],"click",function(n){return function(){sj_evt.fire(t,i[n])}}(r))},n.prototype.initPopUp=function(){var i,r,n,t;if(b){if(i=_ge("ulpop"),i&&(r=i.getAttribute("u")),r){if(n=r.split("|"),n.length!==4)return;w=n[0];y=n[1];f=n[2];p=n[3];ft=_G.refPage}t=this;t.timeDelayForLocationFetch>0?setTimeout(function(){t.getGpsLocation()},t.timeDelayForLocationFetch):t.getGpsLocation()}},n}(),it=function(n,r){var w,b,p,d,c,y;if(_w&&_w.ShowLocationAlert&&alert("Error code:"+n.code),r.showPeriodicPopUp&&n.code===n.PERMISSION_DENIED&&(r.delayforPopup>0?setTimeout(function(){rt(r.popupIdPrefix)},r.delayforPopup):rt(r.popupIdPrefix)),r.markPopupShown&&n.code===n.PERMISSION_DENIED&&i("POPBLOC","1"),r.showFetchHint)switch(n.code){case n.PERMISSION_DENIED:case n.POSITION_UNAVAILABLE:case n.TIMEOUT:case v:yt(!1,r.id)}switch(n.code){case n.PERMISSION_DENIED:ot&&(sa_cl(_ge("wpc_chlocpoperr"+r.id),"b_hide",!1),r.showErrorBelowLocation?(w=_d.getElementsByClassName("sw_detect"),_ge("wpc_chlocpoptxt"+r.id)&&(b=_ge("wpc_chlocpoptxt"+r.id).getElementsByTagName("a")[w.length>0?1:0],sa_cl(b,"b_hide",!0))):sa_cl(_ge("wpc_chlocpoptxt"+r.id),"b_hide",!0));Log.Log("Warning","Geolocation","getCurrentPosition",!1,"Code",n&&n.code?n.code:"","timetaken",r.timeTaken.toString());break;case n.POSITION_UNAVAILABLE:case n.TIMEOUT:case v:p=_ge("wpc_chlocOtherr"+r.id);tt&&p&&sa_cl(p,"b_hide",!1);case ut:Log.Log("Warning","Geolocation","getCurrentPosition",!1,"Code",n&&n.code?n.code:"","timetaken",r.timeTaken.toString());break;default:Log.Log("Warning","Geolocation","getCurrentPosition_Unknown",!1,"Code",n&&n.code?n.code:"timetaken",r.timeTaken.toString())}e||r.setCookieAtClientAndRefresh?(d=u(h,l(),a()),i("BLOC",d)):wt&&sj_cook.get("SRCHHPGUSR","LOC")!=null||(c=sj_gx(),y=u(k,_G.IG,s),o&&(y=t(y,"FORM",et)),c.open("GET",y,!0),c.onreadystatechange=function(){if(c.readyState==4){var n="Block",t="Geolocation";c.status==200&&c.responseText=="Ok"?Log.Log("Success",t,n,!1):Log.Log("Warning",t,n,!1,"Code",c.status.toString())}},c.send());f?vt():ft&&window.location.reload(!0)},vt=function(){var n="Popup",i="Geolocation",u=confirm(f),r;Log.Log(n,i,"SetDefaultLocationPrompt",!1);r=y;u?Log.Log(n,i,"UserAccepted",!1):(r=t(p,"GUID",w),Log.Log(n,i,"UserDeclined",!1));location.href=r};n.showPopup=bt;n.init=kt;n.periodicPopupProcessed=dt;n.initialize=gt})(mcl||(mcl={}))