ATInternet.YouTube=ATInternet.YouTube||{},ATInternet.YouTube.Callbacks=ATInternet.YouTube.Callbacks||{},ATInternet.YouTube.PlayerObjectList=[],ATInternet.YouTube.deletePlayerList=function(){for(var e=0;e<ATInternet.YouTube.PlayerObjectList.length;e++)delete ATInternet.YouTube.PlayerObjectList[e];ATInternet.YouTube.PlayerObjectList=[]},ATInternet.Tracker.Plugins.YouTube=function(e){"use strict";var t=this,a=function(e){var t;return t=!(e.oldIndex===e.newIndex||null===e.action||"stop"===e.action)},n=function(e,t){e.oldIndex=e.newIndex;var a=e.getPlaylist();null!==a?e.newIndex=e.getPlaylistIndex():e.newIndex=0,e.oldState=e.newState,e.newState=t,e.currentIndex=e.newIndex};e.youTube={},e.youTube.getFlashPlayer=function(e){var t=null;"function"!=typeof document.getElementById&&(document.getElementById=function(e){return document.all[e]});for(var a=document.getElementsByTagName("EMBED"),n=0;n<a.length;n++)if(a[n].id===e){t=a[n];break}return t||(t=document.getElementById(e)),t},e.youTube.init=function(e){e&&ATInternet.YouTube.PlayerObjectList.push(new r(e))};var r=function(t){if(t.mediaList){var a=this;a.player=t,a.player.currentIndex=0,a.player.oldIndex=0,a.player.newIndex=0,a.player.oldState=YT.PlayerState.UNSTARTED,a.player.newState=YT.PlayerState.UNSTARTED,a.player.action=null,a.player.currentMedia=null,a.player.isBuffering=!1,a.player.hit=function(){var t=this;if(null===t.currentMedia){var a=t.getPlaylist();if(null!==a){for(var n=a[t.currentIndex],r=0;r<t.mediaList.length;r++)if(n===t.mediaList[r].id){t.currentMedia=t.mediaList[r];break}}else t.currentMedia=t.mediaList[0]}null!==t.currentMedia&&(e.richMedia.add(t.currentMedia),e.richMedia.send({action:t.action,playerId:t.currentMedia.playerId,mediaLabel:t.currentMedia.mediaLabel,isBuffering:t.isBuffering})),t.oldIndex!==t.newIndex&&(t.currentMedia=null),t.isBuffering=!1},a.addListeners()}};r.prototype.addListeners=function(){var e=this,t=function(t){e.fire(t)};"string"==typeof e.player.id?(ATInternet.YouTube.Callbacks[e.player.id]=t,e.player.addEventListener("onStateChange","ATInternet.YouTube.Callbacks."+e.player.id)):e.player.addEventListener("onStateChange",function(e){t(e.data)})},r.prototype.fire=function(e){var t=this.player,r=!1;switch(n(t,e),t.oldState+"."+t.newState){case YT.PlayerState.ENDED+"."+YT.PlayerState.BUFFERING:case YT.PlayerState.PAUSED+"."+YT.PlayerState.BUFFERING:t.action="play",t.isBuffering=!0,r=!0;break;case YT.PlayerState.UNSTARTED+"."+YT.PlayerState.PLAYING:case YT.PlayerState.ENDED+"."+YT.PlayerState.PLAYING:case YT.PlayerState.PAUSED+"."+YT.PlayerState.PLAYING:t.action="play",r=!0;break;case YT.PlayerState.BUFFERING+"."+YT.PlayerState.PLAYING:t.action="info",r=!0;break;case YT.PlayerState.PLAYING+"."+YT.PlayerState.BUFFERING:t.action="info",t.isBuffering=!0,r=!0;break;case YT.PlayerState.PLAYING+"."+YT.PlayerState.PAUSED:case YT.PlayerState.BUFFERING+"."+YT.PlayerState.PAUSED:t.action="pause",r=!0;break;case YT.PlayerState.PLAYING+"."+YT.PlayerState.ENDED:case YT.PlayerState.PAUSED+"."+YT.PlayerState.ENDED:case YT.PlayerState.BUFFERING+"."+YT.PlayerState.ENDED:t.action="stop",r=!0;break;case YT.PlayerState.UNSTARTED+"."+YT.PlayerState.BUFFERING:t.newState=YT.PlayerState.ENDED}var l=a(t);l&&(t.currentIndex=t.oldIndex,t.oldState=YT.PlayerState.ENDED,t.newState=YT.PlayerState.ENDED,t.action="stop",t.isBuffering=!1,r=!0),r&&t.hit()},t._initPlayerProperties=n,t._forceStopAction=a,t.PlayerObject=r},ATInternet.Tracker.addPlugin("YouTube");