define(["jquery","util/uri","counters","util/find-event-target","jquery.placeholder"],function(a,b,c,d){"use strict";var e={pageScrollStart:6855953,feedNextPieceLoad:6855985,multipostLayerOpen:6856001,commentClick:6856010,likeClick:6856019},f={alert:".l-loginform-alert",form:{form:"[name=Auth]",login:"[name=Login]",password:"[name=Password]",submit:".loginform_row_label_submit"}},g=function(){a("input[name=Login]").placeholder()},h=function(){a(f.alert).removeClass("l-loginform-alert__show")},i=function(){this.find(f.alert).addClass("l-loginform-alert__show"),setTimeout(h,5e3)},j=function(a){return a.indexOf("@gmail.com")!==-1},k=function(a){var b=a.find(f.form.login).val(),c=a.find(f.form.password).val(),d=a.find(f.form.login).attr("placeholder");return b.length>0&&(c.length>0||j(b))&&d!==b},l=function(a,b){var c=a.find(b.login),d=a.find(b.submit);0===c.val().length?c.focus():d.focus()},m=function(a,b){var c=a.find(b.login),d=c.closest(".l-loginform_row"),e=a.find(b.password).closest(".l-loginform_row");c.on("input propertychange",function(){var a=c.val(),b=!j(a),f=!(a.indexOf("@")===-1);e.toggle(b),d.toggleClass("no-domain-select",f)})},n=function(a){d(a,'.b-history-event__community-suggest_head[data-type="channel-promo"] a')||d(a,".b-history-event__channel-promo a")?_gaq.push(["_trackEvent","VideoChannels","Click","Click on the link videochannels"]):d(a,'.b-history-event__game-promo[data-type="game-promo"] a')?_gaq.push(["_trackEvent","Games","Click","Click on the link games"]):d(a,".b-history-event__game-promo a")?_gaq.push(["_trackEvent","MarketingPromo","Click","Click on the link MarketingPromo"]):d(a,".b-history-event__event-text2")?_gaq.push(["_trackEvent","Community","Click","Click on the link community"]):d(a,".l-loginform_footer .ui-button-main")?(_gaq.push(["_trackEvent","LoginButton","Click","Click on the link LoginButton"]),c.myrb(e.multipostLayerOpen)):d(a,".ui-button-register")?_gaq.push(["_trackEvent","RegisterNow","Click","Click on the link RegisterNow"]):d(a,".l-loginform-row_label_lostpass")?_gaq.push(["_trackEvent","LostPassword","Click","Click on the link LostPassword"]):d(a,".portal-menu__logo__link")?_gaq.push(["_trackEvent","Logo","Click","Click on the link Logo"]):d(a,".b-comments__history-button")?(_gaq.push(["_trackEvent","CommentButton","Click","Click on the link CommentButton"]),c.myrb(e.commentClick)):d(a,".b-like")&&(_gaq.push(["_trackEvent","LikeButton","Click","Click on the link LikeButton"]),c.myrb(e.likeClick))},o=function(b){var c=b,d=69,h=a(window);c.find(f.form.form).on("submit",function(a){k(c)||(a.preventDefault(),i.call(c))}),g(),l(c,f.form),m(c,f.form),h.on("scroll",function a(){var b=!!(h.scrollTop()>d);if(c.toggleClass("fixed",b).css("marginLeft",b?-h.scrollLeft():0),b&&!a.counted){a.counted=!0;var f=new Image;f.src="//rs.mail.ru/sb"+e.pageScrollStart+".gif"}}).on("click",n.bind(this))};return{create:function(){return{onLoad:function(a){o(a)},onUnload:function(){return!1}}}}});