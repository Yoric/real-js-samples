"use strict";var auth={"currentPage":null,"pages":{"SignUp":1,"Login":2,"AddLogin":3,"Password":4},"getSsrc":function(t){var a=$('#login-form input[name="ssrc"]'),e=void 0;return a&&1===a.length&&(e=a.val()),e||(e=t),e},"init":function(t){auth.currentPage=t;var a=[],e=[],n=[],o=[],i=null,s=null,r=null,c=null,u=function(t,a){var e=t.closest(".js-auth-item");e.addClass("has-error"),e.find(".js-alert-icon").removeClass("d-none"),e.find(".js-error-message").removeClass("d-none").append(a)},p=function(t){var a=t.closest(".js-auth-item");a.removeClass("has-error"),a.find(".js-alert-icon").addClass("d-none"),a.find(".js-error-message").addClass("d-none").empty()};if($("#openid-buttons").on("click","[data-provider]",function(a){t===auth.pages.Login&&StackExchange.using("gps",function(){StackExchange.gps.track("login.start",{"tid":StackExchange.options.user.tid},!0)});var e=$(this).data("provider");if(e){var n=!1;t===auth.pages.SignUp&&(StackExchange.using("gps",function(){StackExchange.gps.track("signup.start",{"openid_provider":e,"location":auth.getSsrc("signup_page"),"tid":StackExchange.options.user.tid},!0)}),n=!0),auth.signin($(this),a,n)}}),t===auth.pages.SignUp){var f=$("#se-login-fields");$(f).on("keyup","input[name=password],input[name=display-name],input[name=email]",function(t){var a=$(t.target);if(!a.data("entered")){var e="signup."+a.attr("name").replace("display-","")+".entered";StackExchange.using("gps",function(){StackExchange.gps.track(e,{},!0)}),a.data("entered",!0),StackExchange.options.mustTrackSignupStartForResearchRecruitment&&!f.data("entered")&&($.ajax("/urr/signup-start"),f.data("entered",!0))}}),$("#se-login-fields").on("click","#submit-button",function(){StackExchange.using("gps",function(){StackExchange.gps.track("signup.se.click",{},!0)})}),$(".js-terms").on("click","a[name=privacy],a[name=tos]",function(t){var a=$(t.target),e="signup."+a.attr("name")+".click";StackExchange.using("gps",function(){StackExchange.gps.track(e,{},!0)})}),$(".js-redirects").on("click","a[name=login],a[name=talent]",function(t){var a=$(t.target),e="signup."+a.attr("name")+"_redirect";StackExchange.using("gps",function(){StackExchange.gps.track(e,{},!0)})})}var g=$('<p class="s-input-message fc-red-500"></p>').text("Caps lock is on"),d=$(".js-password"),l=!1;d.keypress(function(t){var a=String.fromCharCode(t.which),e=/[a-z]/i.test(a);if(e){var n=a==a.toUpperCase();l=n&&!t.shiftKey}var o=document.msCapsLockWarningOff===!1,i=o;l&&!i?d.after(g):g.remove()}),d.find("input").blur(function(){g.remove()});var h=!1,m=!1;$("#login-form input").blur(function(a){t===auth.pages.SignUp&&(""==$(a.target).val()||h||(StackExchange.gps.track("signup.start",{"openid_provider":"Stack Exchange","location":auth.getSsrc("signup_page"),"tid":StackExchange.options.user.tid},!0),h=!0)),t===auth.pages.Login&&(""==$(a.target).val()||m||(StackExchange.gps.track("login.start",{"tid":StackExchange.options.user.tid},!0),m=!0))}),$("#login-form input[type='text'], #login-form input[type='password'], #login-form input[type='email']").keypress(function(a){return 13===a.which?($("#submit-button").is(":hidden")||t===auth.pages.AddLogin?$("#login-form").submit():$("#login-form #submit-button").click(),a.preventDefault(),!1):void 0});var v=function(t,a){if(t.length>0){if(null!=a){for(var e=!0,n=0;n<t.length;n++)if(t[n].message==a.message){e=!1;break}t[0].changed=e}return t[0]}},b=function(t){null!=t&&t.changed&&u(t.attachTo,t.message)},k=function(){b(i),b(s),b(c),b(r)},x=function(){a=[],e=[],n=[],o=[],i=null,s=null,r=null,c=null,$(".js-auth-item").removeClass("has-error"),$(".js-alert-icon").addClass("d-none"),$(".js-error-message").addClass("d-none").empty()},y=function(t,a,e){for(var n="all"===a,o=0;o<t.length&&(t[o].id!=a&&!n||(t.splice(o,1),n));o++);e&&p(e)},w=StackExchange.Auth.addOrUpdateError,S=function(a){var n=$("input[name = 'password']"),o=0===$.trim(n.val()).length;if(o&&!a?w(e,{"id":"pw-empty","index":0,"attachTo":n,"message":"Password cannot be empty."}):y(e,"pw-empty",n),t===auth.pages.SignUp||t===auth.pages.Password){StackExchange.Auth.passwordStrengthValidation(n,e,y);var i=$.trim(n.val()),s=$('input[name="password2"]');if(s.length){var r=$.trim(s.val());0===r.length?w(e,{"id":"pw-empty2","index":3,"attachTo":s,"message":"Password confirmation cannot be empty."}):y(e,"pw-empty2",s),r.length>0&&i!==r?w(e,{"id":"pw-match","index":4,"attachTo":s,"message":"The passwords do not match."}):y(e,"pw-match",s)}if(StackExchange.settings.accounts.currentPasswordRequiredForChangingStackIdPassword){var c=$('input[name="currentpassword"]');if(c.length){var u=$.trim(c.val());0===u.length?w(e,{"id":"curpw-empty","index":0,"attachTo":c,"message":"Current password cannot be empty."}):y(e,"curpw-empty",c)}}}},_=function(){var t=$("input[name='email']"),e=0===$.trim(t.val()).length;e?w(a,{"id":"em-empty","index":0,"attachTo":t,"message":"Email cannot be empty."}):y(a,"em-empty",t)},E=function(){var t=$("#no-captcha-here iframe").length>0,a=$(".js-catpcha-error-container");if(t){var e=grecaptcha.getResponse().length>0;e?y(o,"cp",a):w(o,{"id":"cp","index":0,"attachTo":a,"message":"CAPTCHA response required."})}},q=function(){var t=$.trim($("input[name='email']").val()).toUpperCase(),a=$("input[name='display-name']"),e=$.trim(a.val()).toUpperCase();t===e&&""!=t?w(n,{"id":"nm","index":0,"attachTo":a,"message":"Name and email address must be different. If you don't want to enter a name, just leave it blank.","faileType":"name_email_same"}):y(n,"nm",a)},T=function(){return S(),t===auth.pages.SignUp&&(q(),E()),t!=auth.pages.Password&&_(),i=v(a,i),s=v(e,s),r=v(n,r),c=v(o,c),null==i&&null==s&&null==r&&null==c},C=!0;$("#login-form #submit-button").click(function(e){var n={"isSignup":t===auth.pages.SignUp,"isLogin":t===auth.pages.Login,"isPassword":t===auth.pages.Password,"isAddLogin":t===auth.pages.AddLogin};return x(),$("#login-form input").each(function(t,a){var e=$(a).attr("name");e&&(e=e.replace(/(\W|_)/gi,""),n[e]=$(a).val())}),$.ajax({"url":"/users/login-or-signup/validation/track","data":n,"type":"POST","complete":function(){var e=T();return C&&($("#login-form input").blur(function(){if(T(),t===auth.pages.SignUp){var e=$("#login-form input[name='email']"),n=$.trim(e.val());y(a,"em-ajax"),$.ajax({"type":"POST","url":"/users/signup/email/validate","data":{"email":n},"success":function(n){t!==auth.pages.AddLogin&&(n.IsValid?i=null:(w(a,{"id":"em-ajax","index":1,"attachTo":e,"message":n.ErrorMessage}),i=v(a,i)))},"complete":function(){k()}})}else k()}),C=!1),e?($("#login-form").submit(),void 0):(k(),void 0)}}),e.preventDefault(),!1}),$("#se-pw-reset").submit(function(t){x();var a=T();return a||(k(),t.preventDefault()),a})},"removeAllErrors":function(){},"signin":function(t,a,e){function n(t,a){var e="users_login";auth.currentPage===auth.pages.SignUp&&(e="signup_page",a||StackExchange.using("gps",function(){StackExchange.gps.track("signup.start",{"openid_provider":t,"location":auth.getSsrc(e),"tid":StackExchange.options.user.tid},!0)}),t&&StackExchange.using("gps",function(){StackExchange.gps.track("signup.openid.click",{"openid_provider":t,"location":e},!0)})),t&&StackExchange.using("gps",function(){StackExchange.gps.track("openid.click",{"openid_provider":t,"location":e},!0)})}function o(t){var a={"name":t.data("provider")};return t.data("oauthserver")&&(a.oauth_server=t.data("oauthserver")),t.data("oauthversion")&&(a.oauth_version=t.attr("data-oauthversion")),a}var i=t.data?o(t):t;if(i){if("stack_exchange"===i.name)return n("Stack Exchange",e),void 0;n(i.name.replace(/_/g," "),e),"2.0"===i.oauth_version&&this.setOAuthInfo(i.oauth_version,i.oauth_server),$("#login-form").submit()}},"setOAuthInfo":function(t,a){$("#oauth_version").val(t),$("#oauth_server").val(a)}};