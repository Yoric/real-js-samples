(function(){function h(e){var t=/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/;return t.test(e)}function p(e){var t=document.createElement("a");t.href=e;var n=function(){var e=t.search.substr(1),n=e.split("&"),r={};return n.forEach(function(e,t){var e=e.split("="),n=e[0];r[n]=e[1]}),r},r=function(){var e=t.hash.substr(1),n=e.split("#");return n};return{protocol:t.protocol.replace(":",""),hostname:t.hostname,port:t.port,path:t.pathname,query:n(),params:r()}}function d(e){e=e||[];var t=$("#searchList-tpl").html(),n="";f=[];for(var r=0;r<e.length;r++){var i=e[r],s=Handlebars.compile(t),o=s(i);n+=o}$(".virus-search-err").remove();var u=$(".virus-feedback");e.length?(u.show(),$(".virus-search-list").show(),$(".virus-search-table").html("<table>"+n+"</table>")):($(".virus-search-table").html('<p style="font-size:18px;color:#fff;padding:20px;border-bottom:1px solid #087cd4">\u672a\u627e\u5230\u641c\u7d22\u7ed3\u679c</p>'),$(".virus-search-list").show(),u.hide())}function v(e){var t=$("#search-ext-input").val().toLowerCase();if($("#search-ext-btn").hasClass("disabled"))return;typeof e=="string"&&(t=e,$("#search-ext-input").val(t));if(t==""){$(".virus-search-list").hide(),$(".virus-search-err").length>0&&$(".virus-search-err").remove(),$(".table-box").after('<p class="virus-search-err">\u8bf7\u5148\u8f93\u5165\u8981\u67e5\u627e\u7684\u5185\u5bb9</p>');return}if(t.substring(0,1)=="."){var n=t.length;t=t.substring(1,n)}$.ajax({url:"http://inf.safe.360.cn/lesuo/search",type:"GET",data:{kw:t}}).done(function(e){d(e.data)})}function g(e){var t=function(e){if($(e.target).is("#search-ext-input"))return;$("#virus-keyword").hide(),$(e.target).is("#virus-keyword li")&&($("#search-ext-input").val($(e.target).text()),v())},n=function(e){$("#virus-keyword").show()};$("#virus-keyword").show(0,function(){$(window.document).off("click",t).on("click",t),$("#search-ext-input").off("click",n).on("click",n)})}function y(e,t){var n=$(".timeline .content"),r=parseInt(n.css("left"))||0;if(e==="left"){if(r+43>0)return;n.css("left",r+43+"px")}else{if(r-43<-473)return;n.css("left",r-43+"px")}}function b(e){function u(e){e==1&&($("#search-ext-input").val(""),$(".varus-search-file").show(),$(".file-loadding").show(),$("#search-ext-btn").addClass("disabled")),e==2&&($(".file-loadding").hide(),$(".file-list").show(),$("#search-file-btn").val("")),e==3&&($("#search-ext-btn").removeClass("disabled"),$(".varus-search-file").hide(),$(".file-loadding").hide(),$(".file-list").hide(),$("#search-file-btn").val(""))}var t=e.target.files,n=$("#formFileUpLoad"),r=n.attr("action");if(!t)return;if(t.length>3){alert("\u6700\u591a\u4e0a\u4f203\u4e2a\u6587\u4ef6");return}var i=w(t);if(i.length>0){var s=new FormData;for(var o=0;o<i.length;o++)s.append("file[]",i[o]);u(1),$.ajax({url:r,type:"POST",data:s,contentType:!1,processData:!1}).done(function(e){if(e.errno==0){var t=e.data[0].filename_list,n=[],r=e.data[0].hit_list;for(var i=0;i<t.length;i++){var s=t[i];n.push("<p>"+s+'<span class="file-close"></span></p>')}d(r),$(".file-list").html(n),u(2)}else $(".virus-search-list").hide(),$(".virus-search-err").length>0&&$(".virus-search-err").remove(),$(".table-box").after('<p class="virus-search-err">'+e.errmsg+"</p>"),u(3)}).fail(function(e){u(3)})}$(".table-box").on("click",".file-close",function(){$(this).parent("p").remove(),$(".file-list").find("p").length<1&&u(3)})}function w(e){var t=[];for(var n=0,r;r=e[n];n++)r.size>=5242880?alert('\u60a8\u8fd9\u4e2a\u6587\u4ef6"'+r.name+'"\u5e94\u5c0f\u4e8e5M'):t.push(r);return t}function E(){var e=$(".information ul"),t=[],n=[],r=0,i=$("#newsList-tpl").html();for(var s in VirusNews){r++;if(VirusNews[s].info_content!=""){var o=VirusNews[s].info_content.split("|");r==1&&(o.length<=3?VirusNews[s].news_list=o:VirusNews[s].news_list=o.slice(0,3));if(r==2||r==3)o.length<=1?VirusNews[s].news_list=o:VirusNews[s].news_list=o.slice(0,1);r<=2&&(VirusNews[s].news_show="show")}VirusNews[s].list_num=r,t.push(VirusNews[s])}for(var u=0;u<t.length;u++){var a=t[u],f=Handlebars.compile(i),l=f(a);n+=l}e.html(n),$(".information-more a").on("click",function(t){t.preventDefault(),e.find("li").show(),$(this).hide()})}function T(){var e=$("#shareWeibo"),t=e.find("textarea"),n=e.find(".error");$(".share-weibo-btn").on("click",function(e){e.preventDefault();if(t.val()){n.hide();var r=$(this).data("share"),i=x[r],s={};s.pic="http://p0.ssl.qhimg.com/d/inn/d91ad0db/lesuobingdu.jpg",s.title="#\u52d2\u7d22\u75c5\u6bd2\u5468\u5e74\u7eaa#@360\u5b89\u5168\u536b\u58eb",s.url=S,s.text=t.val(),console.log(s);var o=i.replace(/\!\!([a-z]+)\!\!/g,function(e,t){return encodeURIComponent(s[t])});window.open(o)}else n.show()}),t.on("change blur keyup",function(){t.val()?n.hide():n.show()})}var e="http://down.360safe.com/inst.exe",t="\u6587\u6863\u536b\u58eb\u5df2\u652f\u6301\u89e3\u5bc6\u672c\u7c7b\u578b\uff0c\u8bf7\u4e0b\u8f7d\u6587\u6863\u536b\u58eb",n=["\u5b89\u5168\u536b\u58eb\u5df2\u652f\u6301\u89e3\u5bc6\uff0c\u8bf7\u70b9\u51fb\u4e0b\u8f7d\u5b89\u5168\u536b\u58eb\uff0c\u5e76\u4f7f\u7528\u529f\u80fd\u5927\u5168\u4e2d\u7684\u201c\u6587\u6863\u89e3\u5bc6\u201d\u529f\u80fd"],r="\u6587\u6863\u536b\u58eb\u6b63\u5728\u652f\u6301\uff0c\u8bf7\u5148\u4e0b\u8f7d\u4ee5\u4e0b\u7b2c\u4e09\u65b9\u5de5\u5177\uff1a",i=["\u6587\u6863\u536b\u58eb\u6b63\u5728\u652f\u6301\uff0c\u8bf7\u5148\u4e0b\u8f7d\u4ee5\u4e0b\u7b2c\u4e09\u65b9\u5de5\u5177\uff1a"],s=["\u76ee\u524d\u6682\u65f6\u65e0\u6cd5\u89e3\u5bc6"],o={},u=[],a=[],f=[],l=/[^a-zA-Z0-9_]{1}/g,c=$("#table-line-tpl").html(),m=p(window.location.href).query.virname;m&&(v(decodeURI(m)),window.location.hash="#virusSearch"),Function.prototype.bind||(Function.prototype.bind=function(e){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(r.prototype=this.prototype),i.prototype=new r,i}),window.registerBtn=function(){$("#search-ext-btn").off("click").on("click",v),$("#search-ext-input").off("keydown").on("keydown",function(e){e.keyCode===13&&(v(),$("#virus-keyword").hide())}),$("#search-ext-input").off("focus").on("focus",g),$(".left-bar img").off("click").on("click",y.bind(null,"left")),$(".right-bar img").off("click").on("click",y.bind(null,"right")),$("#search-file-btn").off("change").on("change",b),$(".tool-btn").on("click",function(e){e.preventDefault()})},window.registerBtn(),$(".btn-wdws").hover(function(){$(this).find(".down-pop").show()},function(){$(this).find(".down-pop").hide()}),E(),$(window).scroll(function(){var e=$(document).scrollTop(),t=$(".wrap").find(".floor"),n=$(".tool-bar"),r,i=n.find(".cur");t.each(function(t,n){var i=$(this).offset().top;if(!(e>i-100))return!1;r="#"+$(this).attr("id")}),e>=$(document).height()-$(window).height()?(i.removeClass("cur"),n.find("[href=#gamesite]").parent("li").addClass("cur")):r&&i.attr("href")!=r&&(i.removeClass("cur"),n.find("[href="+r+"]").parent("li").addClass("cur"))});var S=window.location.href,x={qzone:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=!!url!!&title=!!title!!&pics=!!pic!!&summary=!!text!!",weibo:"http://service.weibo.com/share/share.php?url=!!url!!&appkey=&title=!!text!!%20!!title!!&pic=!!pic!!&language=zh_cn"};$(".share a").on("click",function(e){e.preventDefault();if(!!$(this).hasClass("weixin"))return!1;var t=$(this).attr("class"),n=x[t],r=$(".content-text"),i={};i.pic="http://p0.ssl.qhimg.com/d/inn/d91ad0db/lesuobingdu.jpg",i.title="#360\u5b89\u5168\u536b\u58eb#",i.url=S,i.text="\u4ed4\u7ec6\u6d4f\u89c8\u8fc7360\u5b89\u5168\u536b\u58eb\u7684\u52d2\u7d22\u75c5\u6bd2\u4e13\u9898\u9875\u540e\uff0c\u53d1\u73b0\u4e86\u5b89\u5168\u536b\u58eb\u80fd\u63d0\u4f9b\u514d\u8d39\u7684\u75c5\u6bd2\u9632\u62a4\u548c\u6587\u4ef6\u89e3\u5bc6\uff0c\u540c\u65f6\u6709\u5168\u7403\u89c4\u6a21\u6700\u5927\u7684\u52d2\u7d22\u75c5\u6bd2\u89e3\u5bc6\u5e93\u641c\u7d22\u5f15\u64ce\uff0c\u611f\u89c9\u53ea\u8981\u6709\u5b89\u5168\u536b\u58eb\u5728\uff0c\u52d2\u7d22\u75c5\u6bd2\u5c31\u65e0\u94b1\u53ef\u8d5a\u4e86\uff0c\u624b\u52a8\u70b9\u8d5e\uff01";var s=n.replace(/\!\!([a-z]+)\!\!/g,function(e,t){return encodeURIComponent(i[t])});window.open(s)}),$("#qrcode").qrcode({width:128,height:128,render:document.createElement("canvas").getContext?"canvas":"table",text:S}),T(),$(".tool-btn").on("mouseenter",function(){var e=$(this).parents(".tool-bar");e.css({width:"270px"}),e.find(".tool-box").show()}),$(".tool-bar").on("mouseleave",function(){$(this).css({width:"auto"}).find(".tool-box").hide()}),$(".share .weixin").hover(function(){$(this).parents(".tool-bar").find(".weixin-box").show()},function(){$(this).parents(".tool-bar").find(".weixin-box").hide()})})();