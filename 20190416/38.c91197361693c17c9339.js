(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{1415:function(t,n,e){},1416:function(t,n){},1417:function(t,n,e){"use strict";var i=Object.prototype.hasOwnProperty;function o(t,n){return Array.isArray(t)?function(t,n){for(var e,i="",r="",a=Array.isArray(n),s=0;s<t.length;s++)(e=o(t[s]))&&(a&&n[s]&&(e=l(e)),i=i+r+e,r=" ");return i}(t,n):t&&"object"==typeof t?function(t){var n="",e="";for(var o in t)o&&t[o]&&i.call(t,o)&&(n=n+e+o,e=" ");return n}(t):t||""}function r(t){if(!t)return"";if("object"==typeof t){var n="";for(var e in t)i.call(t,e)&&(n=n+e+":"+t[e]+";");return n}return t+""}function a(t,n,e,i){return!1!==n&&null!=n&&(n||"class"!==t&&"style"!==t)?!0===n?" "+(i?t:t+'="'+t+'"'):("function"==typeof n.toJSON&&(n=n.toJSON()),"string"==typeof n||(n=JSON.stringify(n),e||-1===n.indexOf('"'))?(e&&(n=l(n))," "+t+'="'+n+'"'):" "+t+"='"+n.replace(/'/g,"&#39;")+"'"):""}n.merge=function t(n,e){if(1===arguments.length){for(var i=n[0],o=1;o<n.length;o++)i=t(i,n[o]);return i}for(var a in e)if("class"===a){var s=n[a]||[];n[a]=(Array.isArray(s)?s:[s]).concat(e[a]||[])}else if("style"===a){var s=r(n[a]);s=s&&";"!==s[s.length-1]?s+";":s;var l=r(e[a]);l=l&&";"!==l[l.length-1]?l+";":l,n[a]=s+l}else n[a]=e[a];return n},n.classes=o,n.style=r,n.attr=a,n.attrs=function(t,n){var e="";for(var s in t)if(i.call(t,s)){var l=t[s];if("class"===s){l=o(l),e=a(s,l,!1,n)+e;continue}"style"===s&&(l=r(l)),e+=a(s,l,!1,n)}return e};var s=/["&<>]/;function l(t){var n=""+t,e=s.exec(n);if(!e)return t;var i,o,r,a="";for(i=e.index,o=0;i<n.length;i++){switch(n.charCodeAt(i)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}o!==i&&(a+=n.substring(o,i)),o=i+1,a+=r}return o!==i?a+n.substring(o,i):a}n.escape=l,n.rethrow=function t(n,i,o,r){if(!(n instanceof Error))throw n;if(!("undefined"==typeof window&&i||r))throw n.message+=" on line "+o,n;try{r=r||e(1416).readFileSync(i,"utf8")}catch(e){t(n,null,o)}var a=3,s=r.split("\n"),l=Math.max(o-a,0),c=Math.min(s.length,o+a);var a=s.slice(l,c).map(function(t,n){var e=n+l+1;return(e==o?"  > ":"    ")+e+"| "+t}).join("\n");n.path=i;n.message=(i||"Pug")+":"+o+"\n"+a+"\n\n"+n.message;throw n}},1418:function(t,n,e){var i=e(1417);t.exports=function(t){var n,e="",o={},r=t||{};return function(t,r,a,s,l,c,u,h){o.MsgContent=n=function(){this&&this.block,this&&this.attributes,e=e+"<div"+(i.attr("class",i.classes(["gift-content","v-bottom","border-box","p-relative",{"no-tail-icon":!(u&&!s&&l)}],[!1,!1,!1,!1,!0]),!1,!0)+i.attr("style",i.style("background:"+t+"; color:"+h+";"),!0,!0))+'><div class="cntr"><div class="msg-content dp-i-block">'+(null==(n=c)?"":n)+"</div>",u&&!s&&l&&(e=e+'<span class="tail-icon dp-i-block v-top bg-cover"'+i.attr("style",i.style("background-image:url("+u+")"),!0,!0)+"></span>"),e+="</div></div>"},e+='<div class="announcement-wrapper clearfix no-select">',a&&(e=e+"<div"+(i.attr("class",i.classes(["gift-prefix","v-bottom","head-icon","bg-cover",r],[!1,!1,!1,!1,!0]),!1,!0)+i.attr("style",i.style("background-image:url("+a+")"),!0,!0))+"></div>"),!s&&l?(e=e+"<a"+i.attr("href",l,!0,!0)+' target="_blank">',o.MsgContent(),e+="</a>"):o.MsgContent(),e+="</div>"}.call(this,"bgColor"in r?r.bgColor:"undefined"!=typeof bgColor?bgColor:void 0,"bigIconClassName"in r?r.bigIconClassName:"undefined"!=typeof bigIconClassName?bigIconClassName:void 0,"headIcon"in r?r.headIcon:"undefined"!=typeof headIcon?headIcon:void 0,"isSelf"in r?r.isSelf:"undefined"!=typeof isSelf?isSelf:void 0,"linkUrl"in r?r.linkUrl:"undefined"!=typeof linkUrl?linkUrl:void 0,"messageHtml"in r?r.messageHtml:"undefined"!=typeof messageHtml?messageHtml:void 0,"tailIcon"in r?r.tailIcon:"undefined"!=typeof tailIcon?tailIcon:void 0,"textColor"in r?r.textColor:"undefined"!=typeof textColor?textColor:void 0),e}},1593:function(t,n,e){"use strict";e.r(n);var i=e(14),o=e.n(i),r=e(42),a=e.n(r),s=e(8),l=e.n(s),c=e(1418),u=e.n(c);e(1415);var h=e(373),p=e(792),m=e(31),d=e(396),f=e(403);e.d(n,"DanmakuAnnouncementController",function(){return g});var v=function(t,n,e,i){return new(e||(e=l.a))(function(o,r){function a(t){try{l(i.next(t))}catch(t){r(t)}}function s(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){t.done?o(t.value):new e(function(n){n(t.value)}).then(a,s)}l((i=i.apply(t,n||[])).next())})},y=Object(m.c)("danmaku-announcement/core"),g=function(){function t(n){var e=this;a()(this,t),this.initialized=!1,this.parentDom=null,this.positionCtnr=null,this.wrapperDom=null,this.announcementQueue=[],this.animationEndName="",this.animationTimeout=null,this.isShowingAnnouncement=!1,this.startCallback=null,this.endCallback=null,n&&this.init(n),h.default.$on("livePlayer:operableElementChange",function(){e.isShowingAnnouncement&&e.animationEnd()}),this.onBlockEffect()}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.prepareAnnouncementDom=function(){var t=this;y(this.parentDom.getBoundingClientRect(),this.startCallback,this.endCallback),this.wrapperDom||(this.wrapperDom=document.createElement("div"),this.wrapperDom.style.position="absolute",this.wrapperDom.style.top="0",this.wrapperDom.style.willChange="left",this.wrapperDom.style.transform="translateZ(0)",this.wrapperDom.style.whiteSpace="nowrap",this.wrapperDom.style.fontSize="0",this.wrapperDom.style.display="inline-block",this.wrapperDom.style.zIndex="2",this.wrapperDom.addEventListener(this.animationEndName,this.animationEnd.bind(this)),this.wrapperDom.addEventListener("click",function(){t.announcementQueue[0].clickReport()})),this.positionCtnr.appendChild(this.wrapperDom)},t.prototype.animationEnd=function(){clearTimeout(this.animationTimeout),this.wrapperDom.style.transition="",this.announcementQueue.splice(0,1),this.announcementQueue.length?(this.setAnnouncementDom(),setTimeout(this.startAnnouncementAnimation.bind(this),100)):(this.positionCtnr.removeChild(this.wrapperDom),this.isShowingAnnouncement=!1,this.endCallback&&this.endCallback())},t.prototype.setAnnouncementDom=function(){var t=this.announcementQueue[0];t.showReport(),this.wrapperDom.innerHTML=function(t){try{return u()(t)}catch(t){return""}}(t),y(this.wrapperDom,this.wrapperDom.scrollWidth),this.wrapperDom.style.left="100%"},t.prototype.startAnnouncementAnimation=function(){var t=this,n=Date.now()-this.announcementQueue[0].createAt,e=this.announcementQueue[0].msgType===p.a.giftLottery;if(n>3e5&&e)return this.animationEnd();var i=(this.positionCtnr.clientWidth+this.wrapperDom.clientWidth+10)/(this.announcementQueue.length<5?90:120);y(i,this.positionCtnr.clientWidth,this.wrapperDom.clientWidth),this.animationTimeout=setTimeout(function(){return t.animationEnd()},1e3*i+1e4),this.wrapperDom.style.transition="left "+i+"s linear",this.wrapperDom.style.left="-"+this.wrapperDom.scrollWidth+"px"},t.prototype.displayAnnouncement=function(){this.initialized&&!this.isShowingAnnouncement&&(this.isShowingAnnouncement=!0,this.startCallback&&this.startCallback(),this.prepareAnnouncementDom(),this.setAnnouncementDom(),setTimeout(this.startAnnouncementAnimation.bind(this),100))},t.prototype.init=function(t){if(!this.initialized){var n,e,i=t.parentElement,o=t.onAnnouncementElementShow,r=t.onAnnouncementElementHide;this.setStartCallback(o),this.setEndCallback(r),this.animationEndName=(n=document.createElement("div").style,e=["transition","OTransition","MozTransition","WebkitTransition"],{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",MozTransition:"transitionend"}[function(){for(var t=0,i=e.length,o=void 0;t<i;t++)if(void 0!==n[o=e[t]])return o;return!1}()]),i&&this.bindDom(i)}},t.prototype.bindDom=function(t){this.positionCtnr||(this.positionCtnr=document.createElement("div"),this.positionCtnr.style.position="absolute",this.positionCtnr.style.top="0",this.positionCtnr.style.left="0",this.positionCtnr.style.width="100%",this.positionCtnr.style.overflow="hidden",this.positionCtnr.style.height="100px"),this.parentDom?(this.parentDom.removeChild(this.positionCtnr),this.parentDom=t,this.parentDom.appendChild(this.positionCtnr)):(this.parentDom=t,this.parentDom.appendChild(this.positionCtnr),this.initialized=!0),this.announcementQueue.length&&this.displayAnnouncement()},t.prototype.showAnnouncement=function(t){t.createAt=Date.now(),y(t),this.announcementQueue.push(t),this.displayAnnouncement()},t.prototype.setStartCallback=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.startCallback=t},t.prototype.setEndCallback=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.endCallback=t},t.prototype.onBlockEffect=function(){var t=this;d.a.onBlockEffect(function(n){var e=n.type,i=n.isBlock;return v(t,void 0,void 0,o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.indexOf(f.a.Notice)<0)){t.next=2;break}return t.abrupt("return");case 2:i&&(y("当前公告处于屏蔽状态，立即隐藏播放器跑马灯公告并清空队列"),this.announcementQueue.splice(0,this.announcementQueue.length),this.wrapperDom&&this.animationEnd());case 3:case"end":return t.stop()}},t,this)}))})},t}();g.instance=null}}]);