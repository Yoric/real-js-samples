(function($,window){if(!window.mug){window.mug={};}mug.viewer=mug.viewer||{};mug.viewer.util=mug.viewer.util||{};var _util=mug.viewer.util;mug.viewer.util.prepareCommentRotateUI=function(){var elCmt=$(".reply_item");if(elCmt.length>0&&!$(elCmt).hasClass("on")){elCmt.hide();elCmt.removeClass("on");var elC=elCmt[0];$(elC).css("display","block");$(elC).addClass("on");}};mug.viewer.util.runCommentRotateUi=function(clipNo){var elCmt=$(".reply_item");var elCmtLen=elCmt.length;if(elCmtLen>0){var idx=0;if(!!window.__cmtRotateTimer__){return;}if(!$(elCmt).hasClass("on")){var elC=elCmt[idx++];if(!!elC){$(elC).css("display","block");$(elC).addClass("on");}}window.__cmtRotateTimer__=setInterval(function(){if(clipNo!=10000){return;}elCmt=$(".reply_item");if(!elCmt[idx]){idx=0;}if($(elCmt[idx]).css("display")!="none"){idx++;}var elC=elCmt[idx++];if(!!elC){elCmt.hide();elCmt.removeClass("on");$(elC).css("display","block");$(elC).addClass("on");}},3000);}};mug.viewer.util.shrinkMoreTag=function(){$(".sect_tag_area").removeClass("is_expend");$(".editor_card_section .dim_bg").hide();};mug.viewer.util.handleMoreTagButton=function(){var $moreBt=$("button.__more_tag");if($moreBt.length==0){return;}else{if($moreBt.attr("data-event")==="true"){var expanded=$(".sect_tag_area").hasClass("is_expend");if(expanded){mug.viewer.util.shrinkMoreTag();}else{}return;}}var $tagArea=$("div.tag_area");if($tagArea.length&&$tagArea.height()>29){$moreBt.on("click",function(ev){ev.preventDefault();ev.stopPropagation();$(".sect_tag_area").toggleClass("is_expend");$(".editor_card_section .dim_bg").toggle();});$moreBt.attr("data-event","true");}else{$moreBt.hide();}};mug.viewer.util.onLastCard=function(clipNo){if(clipNo==9999){var elSectWrap=$(".editor_card_section .sect_inner_wrap");var spotOuterHeight=elSectWrap.outerHeight();var spotOuterWidth=$(document.body).width();var innerHeightLimit=0;if(spotOuterWidth<=320){innerHeightLimit=126;}else{if(spotOuterWidth<=767){innerHeightLimit=146;}else{innerHeightLimit=219;}}if(spotOuterHeight<innerHeightLimit){$(".editor_card_section.as_card_top_type").addClass("as_short");}mug.viewer.util.handleMoreTagButton();}else{if(clipNo==10000){mug.viewer.util.runCommentRotateUi(clipNo);}}var elCardSect=$(".editor_card_section .dim_bg");if(!!elCardSect.length&&!!elCardSect.hasEventListener&&!elCardSect.hasEventListener("touchstart")){elCardSect.on("touchstart",function(e){e.preventDefault();});}mug.viewer.util.adjustSeriesViewIndex();};mug.viewer.util.adjustSeriesViewIndex=function(){var maxIdx=0;$(".series_list .no").each(function(i,v){var idx=v.innerHTML||"";if(idx.length>maxIdx){maxIdx=idx.length;}});if(maxIdx==3){$(".series_list").addClass("numlength3");}else{if(maxIdx>=4){$(".series_list").addClass("numlength4");}else{}}};var _htExtraInfo=window._htExtraInfo=null;var _isRequesting=true;var _displayedLayer={};var contentAlertLayerHtml='<div class="dim on as_transparent __nextAlert" onclick="mug.viewer.util.closeNextAlert();return false;" ></div><div class="popup_layer layer_post_next __nextAlert">\n<div class="cont_area">\n<strong class="navication {=seriesClass}">{=seriesTitle} 포스트입니다.</strong>\n<div class="cont">\n<strong><span class="ell">{=volumeTitle}</span></strong>\n<div class="thumb"><img src="{=imageUrl}" width="54" height="54" onerror="this.onerror=null; jQuery(this).remove();" alt=""></div>\n</div>\n</div>\n<div class="btn_area">\n<a href="#" onclick="{=cancelNclick}mug.viewer.util.closeNextAlert();return false;" class="btn">취소</a>\n<a href="/viewer/postView.nhn?memberNo={=memberNo}&volumeNo={=volumeNo}" onclick="{=viewNclick}" class="btn">보기</a>\n</div>\n</div>\n';mug.viewer.util._showNextPrevAlert=function(htVolumeMap){if(!!_isRequesting){return;}htVolumeMap=htVolumeMap||{};$(".__nextAlert").remove();var seriesTitle=htVolumeMap.seriesTitle,volumeTitle=htVolumeMap.volumeTitle;var seriesClass="";var label=htVolumeMap.label||"다음";if(htVolumeMap.isNextSeriesVolumeHead===true){label="첫";}if(!!seriesTitle){seriesTitle="이 시리즈의 "+label;seriesClass="as_series";}else{seriesTitle=label;}var authorNo=htVolumeMap.authorNo,volumeNo=htVolumeMap.volumeNo;if(!authorNo||!volumeNo){return;}if(!!_displayedLayer[volumeNo]){return;}if(typeof htVolumeMap.swipeNclick==="function"){htVolumeMap.swipeNclick();}var imageUrl=htVolumeMap.imageUrl;var html=contentAlertLayerHtml.replace("{=seriesTitle}",seriesTitle);html=html.replace("{=volumeTitle}",volumeTitle);html=html.replace("{=memberNo}",authorNo);html=html.replace("{=volumeNo}",volumeNo);html=html.replace("{=imageUrl}",imageUrl);html=html.replace("{=seriesClass}",seriesClass);html=html.replace("{=cancelNclick}",htVolumeMap.cancelNclick||"");html=html.replace("{=viewNclick}",htVolumeMap.viewNclick||"");$(document.body).append(html);if(!mug.$.UserAgent.isMobile){$("div.layer_post_next").addClass("as_fixed");}_displayedLayer[volumeNo]=true;};mug.viewer.util.showNextAlertAndGo=function(){_htExtraInfo=_htExtraInfo||{};_util._showNextPrevAlert({seriesTitle:_htExtraInfo.seriesTitle,volumeTitle:_htExtraInfo.nextVolumeTitle,imageUrl:_htExtraInfo.nextImageUrl,authorNo:_htExtraInfo.nextVolumeAuthorNo,volumeNo:_htExtraInfo.nextVolumeNo,isNextSeriesVolumeHead:_htExtraInfo.isNextSeriesVolumeHead,label:"다음",swipeNclick:function(){mug.common.nclick($("#cont").get(0),"end.swinext");},cancelNclick:"mug.common.nclick(this, 'end.nextcancel');",viewNclick:"mug.common.nclick(this, 'end.nextok');"});};mug.viewer.util.showPrevAlertAndGo=function(htVolumeMap){_htExtraInfo=_htExtraInfo||{};_util._showNextPrevAlert({seriesTitle:_htExtraInfo.seriesTitle,volumeTitle:_htExtraInfo.prevVolumeTitle,imageUrl:_htExtraInfo.prevImageUrl,authorNo:_htExtraInfo.prevVolumeAuthorNo,volumeNo:_htExtraInfo.prevVolumeNo,label:"이전",swipeNclick:function(){mug.common.nclick($("#cont").get(0),"end.swiprev");},cancelNclick:"mug.common.nclick(this, 'end.prevcancel');",viewNclick:"mug.common.nclick(this, 'end.prevok');"});};mug.viewer.util.closeNextAlert=function(){$(".__nextAlert").remove();};mug.viewer.util.lazyLoadExtraInfo=function(authorNo,volumeNo){if(_htExtraInfo===null||!_htExtraInfo.seriesNo){$.ajax({url:"/viewer/getExtraInfo.nhn",dataType:"json",data:{volumeNo:volumeNo,authorNo:authorNo},success:function(resultJson){window._htExtraInfo=_htExtraInfo=resultJson||{};_updateUI(_htExtraInfo);_isRequesting=false;},error:function(){_htExtraInfo=null;_isRequesting=false;}});}return _htExtraInfo;};function _updateUI(ht){var commentCount="";if(!!ht.commentCount&&parseInt(ht.commentCount)>0){commentCount="<em>"+mug.common.numberFormat(ht.commentCount)+"</em>";}$(".__comment_count").html(commentCount);}mug.viewer.util.setNextAlertOnScrollEnd=function(){if(!mug.$.UserAgent.isMobile){return;}var isInapp=mug.$.UserAgent.isInapp;var android4=/Android 4/g.test(window.navigator.userAgent);var ios=/OS ([0-9]+)_([0-9])/g.test(window.navigator.userAgent);var se3table=$(".se_table").length;if((ios||android4)&&se3table){return;}var isCard=__templateType__<4;var el=$("#cont").get(0);var hammer=new Hammer(el).on("panend",function(ev){if(!!ev&&!!ev.target){var parents=$(ev.target).parents();for(var i=0;i<parents.length;++i){if(parents[i].className.indexOf("__se_360vr")!==-1){return;}}}var baseAngle=null;var distance=null;if(ev.direction==Hammer.DIRECTION_LEFT){var angle=ev.angle;distance=ev.distance;baseAngle=Math.abs(180-Math.abs(angle));}else{if(ev.direction==Hammer.DIRECTION_RIGHT){var angle=ev.angle;distance=ev.distance;baseAngle=Math.abs(angle);}}if(ev.direction==Hammer.DIRECTION_LEFT&&distance!=null&&distance>=90&&baseAngle!=null&&baseAngle<=20){if(isInapp&&isCard&&__viewer.clipNo<10000){return;}mug.viewer.util.showNextAlertAndGo();}else{if(ev.direction==Hammer.DIRECTION_RIGHT&&distance!=null&&distance>=90&&baseAngle!=null&&baseAngle<=20){if(isInapp&&isCard&&__viewer.isInAppFirstClip!=true){return;}mug.viewer.util.showPrevAlertAndGo();}}});window.__hammer=hammer;};mug.viewer.protectPost=mug.viewer.util.protectPost=function(param){var protectType=param||"0";if(protectType=="1"){if(mug.$.UserAgent.isMobile){$(document.body).css({"-webkit-user-select":"none","-moz-user-select":"none"});}window.oncontextmenu=function(event){var e=event||window.event,el=e.target||e.srcElement,sTagName=el.tagName||"";return/(?:textarea|input)/i.test(sTagName);};new Hammer(document.body).on("panend",function(ev){});window.__protectPost=true;}};mug.viewer.util.checkLikeBtns=function(fOnFinish){var refId=null;refId=setInterval(function(){var elBtnLikeEnd=$(".__viewer_footer .u_likeit_list_btn ._cnt");var elLikeItBtnMore=$("._likeit_btn_more");var elLikeItBtnHeart=$(".u_likeit_list_btn");function checkBtn(elBtnLikeEnd,bShowZero){elLikeItBtnHeart.hasClass("on")?elLikeItBtnHeart.attr("aria-pressed","true"):elLikeItBtnHeart.attr("aria-pressed","false");if(!!elBtnLikeEnd.length){setTimeout(function(){clearInterval(refId);if(!!fOnFinish){fOnFinish();}},500);var nLikeCount=parseInt(elBtnLikeEnd.html());if(isNaN(nLikeCount)){if(!!bShowZero){elBtnLikeEnd.html(0);elBtnLikeEnd.show();}else{elBtnLikeEnd.hide();}elLikeItBtnMore.hide();}else{if(nLikeCount>0||!!bShowZero){elBtnLikeEnd.show();elLikeItBtnMore.show();}else{elBtnLikeEnd.hide();elLikeItBtnMore.hide();}}}}checkBtn(elBtnLikeEnd,false);$(".sect_search_post_wrap .u_likeit_list_module ._cnt").each(function(i,v){checkBtn($(v),true);});},50);setTimeout(function(){clearInterval(refId);},600);};})(jQuery,window);
if(!window.mug){mug={};}(function($,window,document){mug.viewer=mug.viewer||{};mug.viewer.templateType={SCROLL:0,SLIDE:1,LINK:2,MORE:3,SIMPLE:4,SIMPLE_TEXT:5,UGC_SIMPLE:6,UGC_CARD:7};mug.viewer.templateTypeName={0:"SCROLL",1:"SLIDE",2:"LINK",3:"MORE",4:"SIMPLE",5:"SIMPLE_TEXT",6:"UGC_SIMPLE",7:"UGC_CARD"};mug.viewer.clip={CLIP_NO_COVER:0,CLIP_NO_TOC:1};mug.viewer.util=mug.viewer.util||{};mug.viewer.util.findClipNoFromLocationHash=function(){var targetClipNo=mug.common.util.getLocationHashMap().clipNo;if(!!targetClipNo){return targetClipNo;}return null;};mug.viewer.util.isPC=function(){return !mug.$.UserAgent.isMobile;};mug.viewer.util.moveLast=function(){};})(jQuery,window,document);function unescapeScriptTags(html){html=html||"";return html.replace(/<!--script/g,"<script").replace(/<\/script-->/g,"<\/script>");}
(function($,window,document){if(!window.mug){mug={};}mug.viewer=mug.viewer||{};mug.viewer.se3=mug.viewer.se3||{};mug.viewer.se3.CommonViewer=mug.viewer.se3.CommonViewer||{};var execOnLoad=function(ht){ht=ht||{};var sLikeDomain=ht.sLikeDomain,authorNo=ht.authorNo,volumeNo=ht.volumeNo;mug.common.Sharer.init();try{!nhn.LikeIt.list.instance&&nhn.LikeIt.list.util.init({sId:"POST",sDomain:sLikeDomain,bMobile:true,sTemplate:"<span class='u_ico'></span><em class='u_cnt _cnt'>좋아요</em>",sMaxCount:"9,999+",bZeroText:true,bHideZeroCount:false,sReplaceZeroCount:"좋아요",oPreHandler:function(event){if(!!window.__volumeMetaJson&&"BLIND"==window.__volumeMetaJson.volumeStatusType){alert("비공개 포스트는 좋아요를 할 수 없습니다.");return false;}return true;},oPostHandler:function(bAdd,oRes){mug.viewer.util.checkLikeBtns(window.__fnOnLastPage);},sCountCallbackYn:"Y"});mug.viewer.util.checkLikeBtns(window.__fnOnLastPage);mug.viewer.util.lazyLoadExtraInfo(authorNo,volumeNo);}catch(e){alert(e.message);}};function showToastOnLoad(htData){htData=htData||{};var sViewType=htData.sViewType||"v";var cache=mug.common.util.getLocalCache();if(sViewType==cache.get("toastType")){return;}cache.set("toastType",sViewType);var elToast=$(".__toast_"+sViewType);elToast.fadeIn(700,function(){setTimeout(function(){elToast.fadeOut(700);},1500);});}mug.viewer.se3.CommonViewer={execOnLoad:execOnLoad,showToastOnLoad:showToastOnLoad};function _openNewWindow(sUrl){try{if(mug.$.UserAgent.isInapp){location.href=sUrl;return;}else{window.open(sUrl);}}catch(e){alert(e.message);}}function _openNewWindowForIE(sUrl){if(!__isIE__||mug.$.UserAgent.isInapp){_openNewWindow(sUrl);return;}try{window.open=function(sUrl){var form=document.createElement("form");form.setAttribute("target","_blank");form.setAttribute("action",sUrl);var _params=__parseingQueryString(sUrl);Object.keys(_params).forEach(function(key){var hiddenField=document.createElement("input");hiddenField.setAttribute("type","hidden");hiddenField.setAttribute("name",key);hiddenField.setAttribute("value",_params[key]);form.appendChild(hiddenField);});document.body.appendChild(form);form.submit();};window.open(sUrl);}catch(e){alert(e.message);}}function __parseingQueryString(sUrl){var queryString=sUrl.substring(sUrl.indexOf("?")+1);if(queryString.indexOf("=")==-1){return{};}var params={},queries,temp,i,l;queryString.split("&").forEach(function(part){temp=part.split("=");params[temp[0]]=temp[1];});return params;}var LocationGallery=eg.Class({construct:function(){},callMap:function(lat,lng,bDomestic,locationId,sEncodedTitle){if(bDomestic){if(mug.$.UserAgent.isMobile){_openNewWindow("http://m.map.naver.com/?dlevel=10&lat="+lat+"&lng="+lng);}else{sEncodedTitle=sEncodedTitle||"";locationId=locationId||"";if(sEncodedTitle!=""){_openNewWindow("http://map.naver.com/?dlevel=10&lat="+lat+"&lng="+lng+"&mapmode=0&pinType=site&enc=&title="+sEncodedTitle);}else{if(locationId.indexOf("SE_")>-1){locationId="";}_openNewWindow("http://map.naver.com/?dlevel=10&lat="+lat+"&lng="+lng+"&mapmode=0&pinId="+locationId+"&pinType=site&enc=");}}}else{_openNewWindow("https://maps.google.co.kr/maps?ie=UTF-8&q="+lat+","+lng);}},callMapApp:function(lat,lng,bDomestic,placeTitle){if(bDomestic){if(mug.$.UserAgent.osName=="Android"){this._callAndroidNaverMapApp(lat,lng,placeTitle);}else{if(mug.$.UserAgent.osName=="Ios"){this._callAppleNaverMapApp(lat,lng,placeTitle);}}}else{if(mug.$.UserAgent.osName=="Android"){this._callAndroidGoogleApp(lat,lng);}else{if(mug.$.UserAgent.osName=="Ios"){this._callAppleMap(lat,lng);}}}},_launchApp:function(sUrl){location.href=sUrl;},_callAppleNaverMapApp:function(lat,lng,placeTitle){var appLink="navermaps://?"+this._getNaverMapQueryString(lat,lng,placeTitle);location.href=appLink;setTimeout(function(){location.href="itms-appss://itunes.apple.com/app/id311867728?mt=8";},1500);},_callAndroidNaverMapApp:function(lat,lng,placeTitle){var appLink="intent://?"+this._getNaverMapQueryString(lat,lng,placeTitle)+"#Intent;scheme=navermaps;action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=com.nhn.android.nmap;end";location.href=appLink;},_callAndroidGoogleApp:function(lat,lng){var sScheme="geo:"+lat+","+lng;appLink="intent://#Intent;scheme="+sScheme+";action=android.intent.action.VIEW;category=android.intent.category.BROWSABLE;package=com.google.android.apps.maps;end";location.href=appLink;},_callAppleMap:function(lat,lng){var appLink="http://maps.apple.com/?ll="+lat+","+lng;location.href=appLink;},_getNaverMapQueryString:function(lat,lng,title,sPlaceId){var htParam={};if(typeof sPlaceId!="undefined"&&sPlaceId!=""){htParam={menu:"location",pinType:"spot",pinId:sPlaceId};}else{htParam={menu:"location2",pinType:"point",};}htParam.lat=lat;htParam.lng=lng;htParam.title=title;return $H(htParam).toQueryString();}});function initViewer(){}function __openImageView(htData){if(mug.$.UserAgent.isInapp){var welImg=$("#"+htData.imgId);var attachId=!!welImg.length?welImg.attr("data-attachment-id"):"";var scheme="postapp://image/view?src="+encodeURIComponent(htData.src)+"&data-image-id="+attachId;mug.common.util.execAppUrl(scheme);}else{_openNewWindow("/viewer/image.nhn?src="+encodeURIComponent(htData.src));}}window.__openImageView=__openImageView;function __checkAppVerOver210(version){if(!version){return false;}var v=version.split(".");if(v.length<3){return false;}if(v[0]>2||(v[0]==2&&v[1]>2)){return true;}if(v.length==3){return(v[0]==2&&v[1]==2&&v[2]>1);}else{return(v[0]==2&&v[1]==2&&v[2]>=1);}}function execSe3CommonModules(htData){htData=htData||{};var sStickerDomain=htData.sStickerDomain;se.module.onLinkResolver({img:{isStop:true,callback:function(htData){var linkUse=htData.linkUse||"";var linkUrl=htData.link||"";if(linkUse=="true"&&linkUrl!=""){_openNewWindowForIE(linkUrl);return;}var buttonHtml='<button class="btn_extnd" type="button">이미지 확대보기</button>';var welImage=$("#"+htData.imgId);var attachId=!!welImage.length?welImage.attr("data-attachment-id"):"";attachId=attachId||"";if(attachId==""){return;}if(__templateType__==mug.viewer.templateType.UGC_SIMPLE){if(!!welImage.length){var welButton=welImage.parent().find(".btn_extnd");var htmlBtContained=welImage.parent().html()+buttonHtml;if(!!welButton.length){welButton.remove();}else{welImage.parent().html(htmlBtContained);var welImg=$("#"+htData.imgId);var welBtn=welImg.parent().find(".btn_extnd");if(!!welBtn.length){welBtn.on("click",function(evt){__openImageView(htData);evt.preventDefault();});}else{}}}}else{if(!!welImage){var welButton=welImage.parent().next();if(!!welButton.length){welButton.remove();}else{welImage.parent().after(buttonHtml);var welImg=$("#"+htData.imgId);var welBtn=welImg.parent().next();if(!!welBtn.length){welBtn.on("click",function(evt){__openImageView(htData);evt.preventDefault();});}else{}}}}}},map:{isStop:true,callback:function(htData){var searchEngine=htData.searchEngine||"";var locationType=searchEngine.toUpperCase()=="NAVER"?"LM":"FM";var queryString="locationId="+htData.locationId+"&locationType="+locationType+"&longitude="+htData.longitude+"&latitude="+htData.latitude+"&title="+encodeURIComponent(htData.title)+"&markers="+htData.markerLongitude+","+htData.markerLatitude;var fnGoPlacePage=function(htData){location.href=("/location/locationGallery.nhn?"+queryString);};var fnGoApp=function(htData){new LocationGallery().callMapApp(htData.latitude,htData.longitude,searchEngine.toUpperCase()=="NAVER",htData.title);};var fnGoWeb=function(htData){var didSearch=htData.didSearch||"";didSearch=didSearch.toString();var encodedTitle;if(didSearch=="false"){encodedTitle=encodeURIComponent(htData.title);}else{encodedTitle="";}new LocationGallery().callMap(htData.latitude,htData.longitude,searchEngine.toUpperCase()=="NAVER",htData.locationId,encodedTitle);};if("button"==htData.eventTarget){if(searchEngine.toUpperCase()=="GOOGLE"){fnGoWeb(htData);}else{if(mug.$.UserAgent.isMobile){if(mug.$.UserAgent.isInapp){fnGoApp(htData);}else{fnGoApp(htData);}}else{fnGoWeb(htData);}}}else{if("placeDesc"==htData.eventTarget){fnGoPlacePage(htData);}else{fnGoPlacePage(htData);}}}},sticker:{isStop:true,callback:function(htData){var linkUrl="";var linkUse=false;var isNotApp=!mug.$.UserAgent.isInapp;var isInAppVersionOver210=mug.$.UserAgent.isInapp&&__checkAppVerOver210(mug.$.UserAgent.appVer);if(isNotApp||isInAppVersionOver210){linkUse=true;linkUrl=sStickerDomain+"/sticker/detail/code/"+htData.packCode+"?navigationType=push";}if(linkUse){_openNewWindow(linkUrl);return;}}}});}window.execSe3CommonModules=execSe3CommonModules;function setFollowStatus(bIsFollowed){if(bIsFollowed===true){$(".__followAnchor").hide();$(".__unfollowAnchor").show();}else{$(".__followAnchor").show();$(".__unfollowAnchor").hide();}if(!!window.refreshFollowBtnsForSE3){window.refreshFollowBtnsForSE3(bIsFollowed);}}window.setFollowStatus=setFollowStatus;mug.viewer.se3.VerticalViewer=eg.Class({fixMenubarElements:function(){this._welDocBody=$(document.body);this._welHeader=$("#header");this._welFooter=$(".__viewer_footer");if(!this._welHeader.length){return;}var fnHeaderEffectorMap={fadeOut:$.proxy(function(){var thiz=this;this._welHeader.fadeOut(150,function(){thiz._bHeaderShowed=false;});},this),fadeIn:$.proxy(function(){var thiz=this;this._welHeader.fadeIn(150,function(){thiz._bHeaderShowed=true;});},this)};var fnShowMenu=$.proxy(function(){if(this._bHeaderShowed){return;}fnHeaderEffectorMap.fadeIn();},this);var fnHideMenu=this.fnHideMenubar=$.proxy(function(){if(!this._bHeaderShowed){return;}fnHeaderEffectorMap.fadeOut();!!window.__closeOverflowMenu&&__closeOverflowMenu();},this);if(!this._welHeader.length){return;}if(this._welDocBody.hasClass("a")||this._welDocBody.hasClass("s")){this._bIsFixedHeaderSupported=true;}var welViewerCont=$(this._getViewerContainerElement());if(this._bIsFixedHeaderSupported){if(this._bFixMenubarEventBinded){return;}var elCt=this._getViewerContainerElement();if(this._nHeaderHeight<=0){this._nHeaderHeight=this._welHeader.height();}this._bHeaderShowed=true;var bIsIos=eg.agent().os.name=="ios";var nLastScrollTop=0;var fnScroll=$.proxy(function(we){if(!this._bIsFixedHeaderSupported){return;}if(bIsIos&&!!window.__endOfScroll&&window.__endOfScroll=="true"){return;}var nScrolltop=$(window).scrollTop();if(nLastScrollTop==0||nScrolltop==0||nScrolltop==nLastScrollTop){nLastScrollTop=nScrolltop;return;}else{if(nScrolltop>nLastScrollTop){if(nScrolltop<=43){return;}fnHideMenu();}else{if(nScrolltop<23){return;}fnShowMenu();}}nLastScrollTop=nScrolltop;if(nLastScrollTop==0){fnShowMenu();this._bNeedTopFocusing=true;}else{this._bNeedTopFocusing=false;}if(bIsIos){var scrollPos=$(window).height()+nScrolltop+50;if($(document).height()<=(scrollPos)){window.__endOfScroll="true";setTimeout(function(){window.__endOfScroll=null;},1000);}}},this);$(window).on("scroll",fnScroll);this._bFixMenubarEventBinded=true;}else{this._bHeaderShowed=false;this._welHeader.show();welViewerCont.css("padding-top",this._welHeader.height()+"px");}}});})(jQuery,window,document);
(function($,window){if(!window.mug){mug={};}mug.viewer=mug.viewer||{};mug.viewer.se3=mug.viewer.se3||{};mug.viewer.se3.SimpleViewer={};window.__templateType__=mug.viewer.templateType.UGC_SIMPLE;window.mug=window.mug||{};mug.viewer=mug.viewer||{};mug.viewer.util=mug.viewer.util||{};mug.viewer.util.setViewerFontSize=function(sFontSize){window.se.module.changeDocFontSize(sFontSize);};window.ViewerFont={sizeUpFont:function(){if(this.fontSize==="1"){return;}this._setFontSize("1");},sizeDownFont:function(){if(this.fontSize==="0"){return;}this._setFontSize("0");},_setFontSize:function(sFontSize){this.fontSize=sFontSize;window.se.module.changeDocFontSize(sFontSize);var localCache=mug.common.util.getLocalCache();localCache.set("viewer_fontSizeType",sFontSize);this._setEnabledFontBt();},_configureFontEnv:function(){var localCacheFontSizeType=mug.common.util.getLocalCache().get("viewer_fontSizeType");var defaultFontSizeType=0;var fontSizeType=localCacheFontSizeType==null?defaultFontSizeType:localCacheFontSizeType;this._setEnabledFontBt();},_setEnabledFontBt:function(){if(mug.$.UserAgent.isInapp){return;}var cachedType=mug.common.util.getLocalCache().get("viewer_fontSizeType")||"0";var welSizeUp=$("a.__viewer_size_up_font");var welSizeDown=$("a.__viewer_size_down_font");if(cachedType==="0"){this.fontSize="0";welSizeUp.addClass("on");welSizeDown.removeClass("on");}else{this.fontSize="1";welSizeUp.removeClass("on");welSizeDown.addClass("on");}}};window.__viewer=ViewerFont;function fillClipContent(){var clipContent=$("#__clipContent").text();clipContent=unescapeScriptTags(clipContent);$("#__tmp_clipContent").replaceWith(clipContent);$("#__clipContent").remove();}function initViewer(htParam){fillClipContent();var localCacheFontSizeType=mug.common.util.getLocalCache().get("viewer_fontSizeType");var defaultFontSizeType=0;var fontSizeType=localCacheFontSizeType==null?defaultFontSizeType:localCacheFontSizeType;if(fontSizeType==1){$(".__se_component_area").addClass("se_fs_lv1");}else{if(fontSizeType==0){$(".__se_component_area").removeClass("se_fs_lv1");}}htParam=htParam||{};var protectType=htParam.protectType;var deviceType=htParam.deviceType;var sImageThumbnailType=deviceType==="mobile"?"w800_q75":"w1200";var stickerDomain=htParam.stickerDomain;var isViewRestrictionLayer=htParam.isViewRestrictionLayer;var volumeNo=htParam.volumeNo;var authorNo=htParam.authorNo;var statUrl=htParam.statUrl;var isAuthorSelf=htParam.isAuthorSelf;mug.viewer.protectPost(protectType);mug.contents.util.lazyLoadImages();SE_INIT({SERVICE_ID:"post",DEVICE_TYPE:deviceType,IMAGE_THUMBNAIL_TYPE:sImageThumbnailType,SERVICE_INAPP:mug.$.UserAgent.isInapp,MODULE_INJECTION_DATA:{VIDEO:{ALLOW_SHARE_BUTTON_ALL:{hasLink:__volumeMetaJson.volumeStatusType=="PUBLISHED"}}},fBeforeLoad:function(){window.scrollTo(0,1);mug.viewer.se3.CommonViewer.showToastOnLoad({sViewType:"v"});},fAfterLoad:function(){se.module.onEventByType("v1_audio",{create:function(oEvent){var oPlayer=oEvent.player;oPlayer.on({play:function(e){console.log("play",e);var sRawId=$(e.target).closest(".se_editArea").attr("id");var audioId="";$(".__se_module_data").each(function(){$(this);if(sRawId==JSON.parse($(this).attr("data-module")).id){audioId=JSON.parse($(this).attr("data-module")).data.audioId;console.log(audioId);}});$.ajax({url:"sendAudioPlayLog.nhn",method:"post",data:{audioId:audioId,volumeNo:volumeNo,authorNo:authorNo,audioQuality:"96"},dataType:"json",success:$.proxy(function(json){},this),error:function(res){}});}});}});execSe3CommonModules({sStickerDomain:stickerDomain,authorNo:authorNo,volumeNo:volumeNo});}});ViewerFont._configureFontEnv();if(isViewRestrictionLayer==="true"){setTimeout(function(){location.href="/viewer/restrictionPost.nhn?volumeNo="+volumeNo+"&memberNo="+authorNo;},1000);}var SimpleViewer=eg.Class.extend(mug.viewer.se3.VerticalViewer,{elContainer:null,clipNo:0,construct:function(initParams){},_getViewerContainerElement:function(){return $("#cont").get(0);},run:function(){this.fixMenubarElements();$(window).trigger("viewerLoad");mug.viewer.util.checkLikeBtns();mug.viewer.util.lazyLoadExtraInfo(authorNo,volumeNo);setTimeout(mug.viewer.util.setNextAlertOnScrollEnd,1000);}});var o=new SimpleViewer();o.run();if(mug.$.UserAgent.isInapp&&isAuthorSelf=="true"){var elSe3Statbtn=$(".__se3_stat_btn");if(!!elSe3Statbtn&&elSe3Statbtn.length>0){elSe3Statbtn.attr("href",statUrl);elSe3Statbtn.show();}}}mug.viewer.se3.SimpleViewer.init=function(htParam){$(window).load(function(){initViewer(htParam);});};})(jQuery,window);
if(!window.mug){mug={};}mug.viewer=mug.viewer||{};mug.viewer.se3=mug.viewer.se3||{};mug.viewer.se3.PcCardViewer={};mug.viewer.se3.PcCardViewer.init=function(htParam){htParam=htParam||{};var isInapp=htParam.bIsInapp,isViewRestrictionLayer=htParam.bIsViewRtLayer,volumeNo=htParam.nVolumeNo,authorNo=htParam.nAuthorNo,sLikeDomain=htParam.sLikeDomain,sStickerDomain=htParam.sStickerDomain,protectType=htParam.sProtectType;mug.viewer.se3.CommonViewer.isVerticalMode=true;(function($,document){function fillClipContent(){var clipContent=jQuery("#__clipContent").text();clipContent=unescapeScriptTags(clipContent);try{$("#__tmp_clipContent").replaceWith(clipContent);}catch(e){console.log(e.message);}$("#__clipContent").remove();}function initViewer(){fillClipContent();var sDeviceType=mug.$.UserAgent.isMobile?"mobile":"desktop";var sImageThumbnailType=sDeviceType==="mobile"?"w800_q75":"w1200";SE_INIT({SERVICE_ID:"post",VIEWER_TYPE:"card",DEVICE_TYPE:sDeviceType,IMAGE_THUMBNAIL_TYPE:sImageThumbnailType,SERVICE_INAPP:isInapp,MODULE_INJECTION_DATA:{VIDEO:{ALLOW_SHARE_BUTTON_ALL:{hasLink:__volumeMetaJson.volumeStatusType=="PUBLISHED"}}},fBeforeLoad:function(){window.scrollTo(0,1);},fAfterLoad:function(){se.module.onEventByType("v1_audio",{create:function(oEvent){var oPlayer=oEvent.player;oPlayer.on({play:function(e){console.log("play",e);var sRawId=$(e.target).closest(".se_editArea").attr("id");var audioId="";$(".__se_module_data").each(function(){$(this);if(sRawId==JSON.parse($(this).attr("data-module")).id){audioId=JSON.parse($(this).attr("data-module")).data.audioId;console.log(audioId);}});$.ajax({url:"sendAudioPlayLog.nhn",method:"post",data:{audioId:audioId,volumeNo:volumeNo,authorNo:authorNo,audioQuality:"96"},dataType:"json",success:$.proxy(function(json){},this),error:function(res){}});}});}});execSe3CommonModules({sStickerDomain:sStickerDomain,authorNo:authorNo,volumeNo:volumeNo});setTimeout(mug.viewer.util.setNextAlertOnScrollEnd,1000);}});if(!!isViewRestrictionLayer){setTimeout(function(){location.href="/viewer/restrictionPost.nhn?volumeNo="+volumeNo+"&memberNo="+authorNo;},500);}mug.viewer.protectPost(protectType);$(".go_end").hide();mug.contents.util.lazyLoadImages();$(".se_card_content").each(function(index,el){var el=$(el);var h=el.height();if(parseInt(h)<739){el.height(739);el.attr("style","height:739px");}});mug.viewer.se3.CommonViewer.execOnLoad({sLikeDomain:sLikeDomain,authorNo:authorNo,volumeNo:volumeNo});mug.viewer.se3.CommonViewer.showToastOnLoad({sViewType:"v"});function initLikeListBtn(){var elLikeItCount=$("#btn_like_end ._cnt");var elLikeItBtnMore=$("#likeit_btn_more");if(!elLikeItCount.length||!elLikeItBtnMore.length){return;}var count=elLikeItCount.text();if(count=="좋아요"){elLikeItBtnMore.css("display","none");}else{elLikeItBtnMore.css("display","inline-block");}}window.initLikeListBtn=initLikeListBtn;var refId=null;var elBtnLikeEnd=$("#btn_like_end");if(!!elBtnLikeEnd.length){refId=setInterval(function(){var welBtn=$("#btn_like_end");if(!!welBtn.length&&welBtn.attr("data-likeit")==1){initLikeListBtn();clearInterval(refId);}},20);}$(window).trigger("viewerLoad");}$(window).load(function(){initViewer();});})(jQuery,document);};
(function($,document,window){if(!window.mug){mug={};}mug.viewer=mug.viewer||{};mug.viewer.se3=mug.viewer.se3||{};mug.viewer.se3.MobileCardViewer={};mug.viewer.se3.MobileCardViewer.init=function(htParam){htParam=htParam||{};var isInapp=htParam.bIsInapp,volumeMetaJson=htParam.volumeMetaJson,clipNoToIndex=htParam.clipNoToIndex,indexToClipNoList=htParam.indexToClipNoList,indexToClipNo=htParam.indexToClipNo,cardGridData=htParam.cardGridData,nStartIndex=htParam.nStartIndex,nVolumeNo=htParam.nVolumeNo,nAuthorNo=htParam.nAuthorNo,bIsSoundPostEdit=htParam.bIsSoundPostEdit,isSoundPlatformSupported=htParam.isSoundPlatformSupported,isViewRestrictionLayer=htParam.isViewRestrictionLayer,protectType=htParam.protectType,bHasCompelVertical=htParam.bHasCompelVertical||false,sLikeDomain=htParam.sLikeDomain,sStickerDomain=htParam.sStickerDomain,searchKeyword=htParam.searchKeyword,searchRank=htParam.searchRank,feedRecommendType=htParam.feedRecommendType,mainMenu=htParam.mainMenu,viewType=htParam.viewType;mug.viewer.se3.CommonViewer.isVerticalMode=false;$(window).load(function(){var bHasHeader=isInapp?false:true;var bIsIos=mug.$.UserAgent.osName=="Ios";var sDeviceType=mug.$.UserAgent.isMobile?"mobile":"desktop";var sImageThumbnailType=sDeviceType==="mobile"?"w800_q75":"w1200";if(isInapp&&bIsIos){$(".btn_gnb_prev").hide();}var elSoundPlayInfo=$(".__sound_play_info_div");var elHeader=$("#header");window.__volumeMetaJson=volumeMetaJson;var htNextVolume={volumeNo:volumeMetaJson.nextVolumeNo,authorNo:volumeMetaJson.nextVolumeAuthorNo};var htPrevVolume={volumeNo:volumeMetaJson.prevVolumeNo,authorNo:volumeMetaJson.prevVolumeAuthorNo};cardGridData.push({profileCard:true,profileImage:__authorImageSrc,cardIndex:indexToClipNoList.length-2,type:"profile",cardNo:indexToClipNoList.length-1,layout:"profile",text:__authorName});window.cardGridData=cardGridData;var sViewerUrl=mug.config.DOMAIN+"/viewer/postView.nhn?volumeNo="+nVolumeNo+"&memberNo="+nAuthorNo;var oInfiniteGrid=null;var fnStopHandler=function(e){return false;};function getCardHtmlList(){var ret=[];$("[data-type='text/post-clip-content']").each(function(idx,el){var jEl=$(el);var contentVal=el.value||el.innerHTML||"";if(parseInt(jEl.attr("data-clipNo"))<9999){contentVal=unescapeScriptTags(contentVal);}ret.push(contentVal);jEl.remove();});return ret;}var cardHtmlListJson=getCardHtmlList();window.cardHtmlListJson=cardHtmlListJson;function fnOnPageExcludeLast(){$(".__viewer_footer").removeClass("as_editor");}function fnOnLastPage(){var isVert=mug.viewer.se3.CommonViewer.isVerticalMode;if(window.__currentClipNo__<9999&&!isVert){return;}var elprev=$(".se_card_last a.btn_prev");var elNext=$(".se_card_last a.btn_next");if(elprev.length>0||elNext.length>0){elprev.unbind("click");elNext.unbind("click");elprev.on("click",fnStopHandler);elNext.on("click",fnStopHandler);}var elLikeCnt=$("span.post_like_cnt");if(elLikeCnt.length>0){var cnt=null;try{cnt=parseInt($(".btn_like em._cnt").text());if(isNaN(cnt)){cnt=0;}}catch(e){cnt=0;}if(cnt>0){$("a.post_like_stat").show();}else{$("a.post_like_stat").hide();}elLikeCnt.text(cnt);}$(".__viewer_footer").addClass("as_editor");if(isVert){setTimeout(function(){mug.viewer.util.onLastCard(9999);mug.viewer.util.runCommentRotateUi(10000);},1000);}else{setTimeout(function(){window.__currentClipNo__&&mug.viewer.util.onLastCard(__currentClipNo__);},500);}patronInit();}window.__fnOnLastPage=fnOnLastPage;function checkTopBtn(pageNo){if(pageNo==0){jQuery(".btn_flw").css("visibility","hidden");}else{jQuery(".btn_flw").css("visibility","");}}var oCard;SE_INIT({SERVICE_ID:"post",VIEWER_TYPE:"card",DEVICE_TYPE:sDeviceType,IMAGE_THUMBNAIL_TYPE:sImageThumbnailType,SERVICE_INAPP:isInapp,MODULE_INJECTION_DATA:{VIDEO:{ALLOW_SHARE_BUTTON_ALL:{hasLink:__volumeMetaJson.volumeStatusType=="PUBLISHED"}}},CARD_DATA:cardHtmlListJson,CARD_LIST:{data:cardGridData,element:jQuery(".se_card_fullArea"),create:function(cardInfiniteList){window.__cardInfiniteList=cardInfiniteList;cardInfiniteList.on("click",function(e){try{var destIdx=e.cardIndex||0;__oCard.moveTo(destIdx);}catch(e){console.log(e);}finally{mug.common.nclick(e.event.currentTarget,"men.cardthumb");if(mug.common.Sharer.getPostAppVersion()<23){closeCardGrid({appScheme:true});}else{closeCardGrid({appScheme:false});}}$("ul li p.title .ell").hide().show(0);$(".as_writer .cont_type .ell").hide().show(0);$(".as_writer ul li .tit").hide().show(0);});function closeCardGrid(htData){htData=htData||{};!!window.__cardInfiniteList&&__cardInfiniteList.hide();if(isInapp&&!!htData.appScheme){location.href="postapp://ugcViewerCardsLayer?show=false";}}window.__closeCardGrid=window.closeCardGrid=closeCardGrid;},show:function(){if(isInapp){location.href="postapp://ugcViewerCardsLayer?show=true";}},onHide:function(){}},fAfterLoad:function(){oCard=new se.module.Card.View({element:$jq("#se_card_end_wrap"),data:cardHtmlListJson,startIndex:nStartIndex,hasHeader:bHasHeader,hasCompelVertical:bHasCompelVertical,flickingDisable:!!bIsSoundPostEdit?true:false,inapp:isInapp,horizontalCall:{beforeFlickStart:function(data){mug.viewer.util.shrinkMoreTag();window.data=data;window.__se3_beforeIdx=window.__se3_beforeIdx||0;if(!!data.isLastCard){mug.viewer.util.showNextAlertAndGo();}else{if(typeof data.cardIndex=="undefined"&&__se3_beforeIdx==0&&!data.isLastCard){mug.viewer.util.showPrevAlertAndGo();}}if(data.cardIndex!=undefined){window.__se3_beforeIdx=data.cardIndex;}},flickEnd:function(data){fnOnAfterMove(data);},moveTo:function(data){fnOnAfterMove(data);},click:function(){},rotate:function(data){fnOnAfterMove(data);}},verticalCall:{click:function(){}},fnCreateViewer:function(htData){var sViewType="h";if(htData.verticalMode===true){sViewType="v";mug.viewer.se3.CommonViewer.isVerticalMode=true;var o=new VerticalCardViewer();o.run();}else{htData.verticalMode=false;}if(isInapp){if(sViewType=="v"){setTimeout(function(){location.href="postapp://ugcViewerSelectedPage?index=1";},1);}else{}}else{mug.viewer.se3.CommonViewer.showToastOnLoad({sViewType:sViewType});}var nStartClipNo=indexToClipNo[nStartIndex];var elSeriesBt=$(".btn_t1.__series");if(nStartClipNo==0&&!htData.verticalMode){elSeriesBt.hide();elHeader.removeClass("sub");}else{if(nStartClipNo>=9999){elSoundPlayInfo.hide();}elSeriesBt.show();elHeader.addClass("sub");}checkTopBtn(nStartClipNo);if(nStartClipNo>=9999||htData.verticalMode){fnOnLastPage();if(nStartClipNo==9999||nStartClipNo==10000){this.enableFixHeaderVisible(true);}}else{fnOnPageExcludeLast();}window.__currentClipNo__=parseInt(nStartClipNo);}});se.module.onEventByType("v1_audio",{create:function(oEvent){var oPlayer=oEvent.player;oPlayer.on({play:function(e){console.log("play",e);var sRawId=$(e.target).closest(".se_editArea").attr("id");var audioId="";$(".__se_module_data").each(function(){$(this);if(sRawId==JSON.parse($(this).attr("data-module")).id){audioId=JSON.parse($(this).attr("data-module")).data.audioId;console.log(audioId);}});$.ajax({url:"sendAudioPlayLog.nhn",method:"post",data:{audioId:audioId,volumeNo:volumeNo,authorNo:authorNo,audioQuality:"96"},dataType:"json",success:$.proxy(function(json){},this),error:function(res){}});}});}});window.__oCard=oCard;var fnOnAfterMove=function(data){var destClipNo=indexToClipNo[data.cardIndex];var elSeriesBt=$(".btn_t1.__series");var isLast=destClipNo==9999||destClipNo==10000;var isFirst=data.isCover||data.cardIndex==0;if(isFirst){elCardPager.hide();elSeriesBt.hide();elHeader.removeClass("sub");}else{elCardPager.show();elSeriesBt.show();if(isLast){oCard.enableFixHeaderVisible(true);}else{oCard.disableFixHeaderVisible();}elHeader.addClass("sub");}window.__currentClipNo__=parseInt(destClipNo);if(__bIEVerLessThan10__){var locationHash="#clipNo="+destClipNo;location.replace(location.pathname+location.search+locationHash);}else{mug.common.util.replaceUrl(sViewerUrl+"&clipNo="+destClipNo);}if(!!window.refreshFollowBtnsForSE3){window.refreshFollowBtnsForSE3();}$(".btn_page_list .current").text(data.cardIndex);mug.contents.util.lazyLoadImages();if(window.__currentClipNo__==10000){}else{clearInterval(window.__cmtRotateTimer__);window.__cmtRotateTimer__=null;}if(destClipNo>9000){fnOnLastPage();}else{fnOnPageExcludeLast();}if(!!window.__soundViewer){if(isSoundPlatformSupported=="true"&&!window.__autoPagingEvent&&window.__soundViewer.getHasRecordAudio()){window.__soundViewer.changeAudioCurrentTime();}window.__autoPagingEvent=false;if(isSoundPlatformSupported=="true"&&window.__soundViewer.getHasRecordAudio()){window.__soundViewer.changeAudioTimeText();}if(isSoundPlatformSupported=="true"&&destClipNo>=9999){window.__soundViewer.soundPause();}}if(!!elSoundPlayInfo){if(destClipNo>=9999){elSoundPlayInfo.fadeOut("fast");}else{if(!elSoundPlayInfo.is(":visible")){elSoundPlayInfo.fadeIn("fast");}}}mug.viewer.util.prepareCommentRotateUI();checkTopBtn(destClipNo);if(isInapp){location.href="postapp://ugcViewerSelectedPage?index="+data.cardIndex;return;}};$(".card_pager .current").text(nStartIndex);$(".__cnt_total").text(cardHtmlListJson.length-1);var elCardPager=$(".card_pager");if(parseInt(nStartIndex,10)<1){elCardPager.hide();}else{elCardPager.show();}mug.contents.util.lazyLoadImages();execSe3CommonModules({sStickerDomain:sStickerDomain,authorNo:nAuthorNo,volumeNo:nVolumeNo});if(!bHasHeader){$("#header").hide();}else{$("#header").show();}$(window).trigger("viewerLoad");if(!bIsSoundPostEdit){asyncGetLastPage();}}});window.mug=window.mug||{};mug.viewer=mug.viewer||{};mug.viewer.util=mug.viewer.util||{};mug.viewer.util.moveLast=function(){if(!__oCard){return;}__oCard.moveTo(cardHtmlListJson.length-2);};mug.viewer.util.moveFirst=function(){if(!__oCard){return;}__oCard.moveTo(0);};mug.viewer.util.moveNext=function(){if(!__oCard){return;}};$(".card_pager .btn_page_list").click(function(){$(this).attr("aria-expanded",(!$(this).attr("aria-expanded")=="true").toString());if(!!window.__cardInfiniteList){__cardInfiniteList.show();}});if(!!isViewRestrictionLayer){setTimeout(function(){location.href="/viewer/restrictionPost.nhn?volumeNo="+nVolumeNo+"&memberNo="+nAuthorNo;},500);}mug.viewer.protectPost(protectType);mug.viewer.se3.CommonViewer.execOnLoad({sLikeDomain:sLikeDomain,authorNo:nAuthorNo,volumeNo:nVolumeNo});function asyncGetLastPage(){$.ajax({url:"getLastOfCard.nhn",dataType:"html",data:{volumeNo:nVolumeNo,memberNo:nAuthorNo,searchKeyword:searchKeyword,searchRank:searchRank,mainMenu:mainMenu,vType:viewType},success:function(resultHtml){if(mug.common.isDev()){console.log("asyncGet success!!");}var lastCardList=resultHtml.split("<!--DELIMITER-SE3_MOBILE_CARD_LAST-->");window.lastCardList=lastCardList;var total=cardHtmlListJson.length;if(lastCardList.length==2){var elLast1=$("<div></div>");elLast1.html(lastCardList[0]);var nLast1Idx=total-2;elLast1.children().attr("data-index",nLast1Idx);window.elLast1=elLast1;__oCard.updateCardData(nLast1Idx,elLast1.html());var elLast2=$("<div></div>");elLast2.html(lastCardList[1]);var nLast2Idx=total-1;elLast2.children().attr("data-index",nLast2Idx);window.elLast2=elLast2;__oCard.updateCardData(nLast2Idx,elLast2.html());mug.viewer.util.prepareCommentRotateUI();fnOnLastPage();if(!!window.refreshFollowBtnsForSE3){window.refreshFollowBtnsForSE3();}}},error:function(resp){console.log(resp);}});}});var VerticalCardViewer=eg.Class.extend(mug.viewer.se3.VerticalViewer,{construct:function(initParams){this.vType="vertical";},_getViewerContainerElement:function(){return $("#cont");},run:function(){this.fixMenubarElements();$(window).trigger("viewerLoad");$(".__unfollowAnchor").hide();$(".__followAnchor").hide();setTimeout(mug.viewer.util.setNextAlertOnScrollEnd,1000);}});function initTopPostForLastPage(){(function($,window){var sPostContKey=".se_card_last .__post_container";var sNextBtKey=".se_card_last .btn_next";var sPrevBtKey=".se_card_last .btn_prev";var elPosts=$(sPostContKey);var nPostsCount=elPosts.length;var nMaxIdx=nPostsCount-1;var nVisibleIdx=0;function initAuthorOtherPosts(){elPosts.each(function(idx){if(nPostsCount>2){nVisibleIdx=1;}if(idx==nVisibleIdx){$(this).show();}else{}});}function hideAll(){$(sPostContKey).hide();}var elLinks=$(".se_card_last .history .link");if(elLinks.length>0){$(elLinks[0]).show();}else{$(".se_card_last .history").hide();}function __showPrevPost(){if(nVisibleIdx>0){hideAll();nVisibleIdx--;$($(sPostContKey)[nVisibleIdx]).show();}checkPageButtons();}function __showNextPost(){if(nVisibleIdx<nMaxIdx){hideAll();nVisibleIdx++;$($(sPostContKey)[nVisibleIdx]).show();}checkPageButtons();}function showNextBt(){$(sNextBtKey).show();}function showPrevBt(){$(sPrevBtKey).show();}function hideNextBt(){$(sNextBtKey).hide();}function hidePrevBt(){$(sPrevBtKey).hide();}function checkPageButtons(){if(nPostsCount<=1){hidePrevBt();hideNextBt();}else{if($($(sPostContKey)[nVisibleIdx]).next(".__post_container").length>0){showNextBt();}else{hideNextBt();}if($($(sPostContKey)[nVisibleIdx]).prev(".__post_container").length>0){showPrevBt();}else{hidePrevBt();}}}window.__showPrevPost=__showPrevPost;window.__showNextPost=__showNextPost;initAuthorOtherPosts();$(window).load(function(){checkPageButtons();});})(jQuery,window);}initTopPostForLastPage();};function patronInit(){var elPatron=$("#patron_wrapper");if(elPatron.length<1){return;}var elPatCnt=$("div.u_patron_entry");if(elPatCnt.length>0){return;}var seriesNo=__volumeMetaJson.seriesNo;patron.init({serviceCode:"post",categoryId:"s",productId:seriesNo,useServiceCss:true,uiType:"typeA",wrapper:document.getElementById("patron_wrapper"),defaultLocale:"en_US",serviceLocale:"ko_KR",buttonLabel:"",patronButtonReady:function(){}});}})(jQuery,document,window);
var SoundPlatformSE3=function(options){var options=options||{};var oCard=null;var flip=null;var eventList=null;var mobileUrl=null;var authorNo=null;var volumeNo=null;var indexToClipNo=null;var clipNoToIndex=null;var playTimeSec=null;var bgmAudio=null;var recordAudio=null;var soundPlayInfoPlayTimeString=null;var effectAudioList=null;var elVerticalCard=jQuery(".se_card");var currentPageEvent={index:0,time:0};var nextPageEventTime=0;var repeatList={};var firstPageEvent=null;var secondPageEvent=null;var soundBtnEl=null;var conversionSecond=1000;var totalClipLength=0;var horizontalBeforeIndex=0;var scrollTime=0;var maxPageFlipIndex=0;var scrollMoveTime=1000;var recordedAudioId=null;var recordedAudioQuality=null;function load(){oCard=window.__oCard;flip=options.flip=="true";eventList=options.eventList||[];mobileUrl=options.mobileUrl;authorNo=options.authorNo;volumeNo=options.volumeNo;indexToClipNo=options.indexToClipNo||{};clipNoToIndex=options.clipNoToIndex||{};playTimeSec=options.playTimeSec;bgmAudio=new Audio(options.bgmPlayUrl);recordAudio=new Audio(options.recordPlayUrl);soundPlayInfoPlayTimeString=options.soundPlayInfoPlayTimeString;effectAudioList=options.effectPlayUrlList;recordedAudioId=options.recordedAudioId;recordedAudioQuality=options.recordedAudioQuality;hasRecordAudio=false;hasBgmAudio=false;if(recordAudio.getAttribute("src")!=""){hasRecordAudio=true;}if(bgmAudio.getAttribute("src")!=""){hasBgmAudio=true;}isLoaded=true;maxPageFlipIndex=getMaxPageFlipIndex();}function moveNext(page){if(!flip){if(scrollTime+2000>new Date().getTime()){window.__autoPagingEvent=false;return;}var scrollAmount=0;if(page>=1&&!!elVerticalCard){scrollAmount=jQuery(elVerticalCard[page-1]).offset().top+jQuery(elVerticalCard[page-1]).height()-20;}jQuery("html, body").animate({scrollTop:scrollAmount},{duration:scrollMoveTime,complete:function(){setTimeout(function(){window.__autoPagingEvent=false;},100);}});}else{var currentIndex=getIndex();if(page==currentIndex+1){oCard.getInstance().moveNext();}else{oCard.getInstance().moveTo(page);}}}function getHasRecordAudio(){return hasRecordAudio;}function isPlaying(){return !recordAudio.paused;}function startRepeat(el){var repeatHandle=setInterval(el.bind(this),50);repeatList[el]=repeatHandle;}function stopRepeat(el){if(repeatList[el]!=null){clearInterval(repeatList[el]);repeatList[el]=null;}}function audioSoundPlayAndPause(){if((hasRecordAudio&&recordAudio.paused)||(hasBgmAudio&&bgmAudio.paused)){if(hasRecordAudio&&getIndex()<=totalClipLength-1){soundPlay();if(recordAudio.currentTime==0&&getIndex()!=0){setTimeout(changeAudioCurrentTime.bind(this),2000);}}else{soundPlay();}}else{soundPause();}}function getIndex(){if(flip){return oCard.getInstance().getCurrentCard().cardIndex;}else{var currentPos=jQuery(document).scrollTop();var i;for(i=0;i<elVerticalCard.length;i++){scrollAmount=jQuery(elVerticalCard[i]).offset().top+elVerticalCard.first().height()-200;if(scrollAmount>currentPos){break;}}return i;}}function soundPause(){jQuery(".sound_platform").removeClass("play");bgmAudio.pause();recordAudio.pause();stopRepeat(eventControl);if(flip){stopRepeat(changeAudioTimeText);}}function soundPlay(){jQuery(".sound_platform").addClass("play");if(hasBgmAudio){bgmAudio.play();}if(hasRecordAudio){recordAudio.play();var moveTo=getIndex();if(maxPageFlipIndex<getIndex()){if(maxPageFlipIndex>0){moveTo=maxPageFlipIndex;}else{moveTo=1;}}if(!flip){scrollTime=0;startRepeat(eventControl);window.__autoPagingEvent=true;}else{startRepeat(eventControl);}if(!flip||getIndex()!=moveTo){moveNext(moveTo);}startRepeat(changeAudioTimeText);jQuery.ajax({url:"sendAudioPlayLog.nhn",method:"post",data:{audioId:recordedAudioId,volumeNo:volumeNo,authorNo:authorNo,audioQuality:recordedAudioQuality},dataType:"json",success:function(result){},error:function(result){}});}}function getLeadingZerosTime(num){return(num<10)?("0"+num):num;}function changeAudioTimeText(){var currentTime=0;var soundMin=getLeadingZerosTime(parseInt(recordAudio.currentTime/60));var soundSec=getLeadingZerosTime(parseInt(recordAudio.currentTime)%60);soundBtnEl.childNodes[0].nodeValue=soundMin+":"+soundSec;}function changeAudioCurrentTime(){if(getIndex()==0){recordAudio.currentTime=0;currentPageEvent={index:0,time:0};if(eventList.length>0){nextPageEventTime=eventList[0].time;}return;}var currentPageIndex=getIndex();if(totalClipLength<=currentPageIndex){recordAudio.currentTime=0;soundPause();return;}for(var index=0;index<eventList.length;index++){var isCurrentPageEvent=(currentPageIndex==eventList[index].pageIndex)?true:false;if(eventList[index].typeName=="page"&&isCurrentPageEvent){if(!isNaN(recordAudio.duration)){recordAudio.currentTime=eventList[index].time/conversionSecond;}if(eventList[index+1]!=null){currentPageEvent.index=index+1;currentPageEvent.time=eventList[index+1].time;}else{currentPageEvent.time=0;nextPageEventTime=0;}if(eventList[index+2]!=null){nextPageEventTime=eventList[index+2].time;}else{nextPageEventTime=0;}return;}}}function getMaxPageFlipIndex(){var lastPageIndex=0;for(i=0;i<eventList.length;i++){if(eventList[i].typeName=="page"&&eventList[i].pageIndex>lastPageIndex){lastPageIndex=eventList[i].pageIndex;}}return lastPageIndex;}function eventControl(){var currentTime=recordAudio.currentTime;if(currentTime>playTimeSec){soundPause();if(!isNaN(bgmAudio.duration)){bgmAudio.currentTime=0;}recordAudio.currentTime=0;if(eventList!=""){nextPageEventTime=eventList[0].time;}if(totalClipLength-1==getIndex()){moveNext(clipNoToIndex["9999"]);}return;}var event=eventList[currentPageEvent.index];if(event&&(currentTime*conversionSecond)>event.time&&currentPageEvent.time!=nextPageEventTime){if(event.typeName=="page"){if(flip||totalClipLength>getIndex()){window.__autoPagingEvent=true;moveNext(event.pageIndex);}}else{if(event.typeName=="effect"){effectAudioList[event.effectId].play();}}if(eventList[currentPageEvent.index+1]==null){currentPageEvent.time=0;nextPageEventTime=0;currentPageEvent.index=0;}else{currentPageEvent.index+=1;currentPageEvent.time=eventList[currentPageEvent.index].time;if(eventList[currentPageEvent.index+1]==null){nextPageEventTime=0;}else{nextPageEventTime=eventList[currentPageEvent.index+1].time;}}}}function increasePlayCount(){var ajaxParams={volumeNo:volumeNo,volumeAuthorNo:authorNo,voiceAuthorNo:authorNo};if(hasRecordAudio){var playUrl=mobileUrl+"/viewer/increaseAutoPlayCount.nhn";jQuery.ajax({url:playUrl,type:"POST",data:ajaxParams});}if(bgmAudio.getAttribute("src")!=""){var bgmUrl=mobileUrl+"/viewer/increaseBgmPlayCount.nhn";jQuery.ajax({url:bgmUrl,type:"POST",data:ajaxParams});}}function setAudioVolumeSize(){bgmAudio.volume=0.6;if(hasRecordAudio){bgmAudio.volume=0.2;}}function setEffectAudioList(){for(key in effectAudioList){var effectAudio=new Audio(effectAudioList[key]);effectAudio.volume=0.5;effectAudio.id=key;effectAudioList[key]=effectAudio;}}function setSoundPlatformAudioController(){bgmAudio.loop=true;soundBtnEl=document.getElementById("soundPlayBtn");setAudioVolumeSize();if(hasRecordAudio){if(flip){totalClipLength=window.__volumeMetaJson.clips.length;}else{totalClipLength=elVerticalCard.length;}if(eventList!=""){if(eventList[0].time==0){eventList[0].time=1;}nextPageEventTime=eventList[0].time;}setEffectAudioList();}if(getIndex()>0){moveNext(0);}if(!flip&&getIndex()>0){setTimeout(function(){audioSoundPlayAndPause();},scrollMoveTime);}else{audioSoundPlayAndPause();}increasePlayCount();}function scroll(amount){var index=getIndex();if(!window.__autoPagingEvent){scrollTime=new Date().getTime();}if(horizontalBeforeIndex!=index){horizontalBeforeIndex=index;if(!window.__autoPagingEvent&&hasRecordAudio){changeAudioCurrentTime();}}}return{load:load,setSoundPlatformAudioController:setSoundPlatformAudioController,audioSoundPlayAndPause:audioSoundPlayAndPause,changeAudioCurrentTime:changeAudioCurrentTime,changeAudioTimeText:changeAudioTimeText,soundPause:soundPause,getHasRecordAudio:getHasRecordAudio,scroll:scroll};};
