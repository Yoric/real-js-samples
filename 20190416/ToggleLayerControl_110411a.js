/*
 * 2011.01.31
 */
nhn.ToggleLayerControl=$Class({bCursorOver:false,bBlockReOpen:false,oElement:null,sElementID:"",nEffectTime:0,oPreviousBaseElement:null,wfCheckLayerEvent:null,wfMouseOverEvent:null,wfMouseOutEvent:null,$init:function(b){this.oOptions={bAutoAdjusting:false,onShow:function(c){},onHide:function(c){},sToggleClassName:"_toggle"};for(var a in b){this.oOptions[a]=b[a];}},getRealPosition:function(b){var c=b;var a={top:0,left:0};for(b=c;b;b=b.offsetParent){a.top+=b.offsetTop;a.left+=b.offsetLeft;}for(b=c.parentNode;b;b=b.parentNode){if(b.tagName.toLowerCase()=="body"){return a;}a.top-=b.scrollTop||0;a.left-=b.scrollLeft||0;}return a;},show:function(j,f,b,a,e,i){if(this.oElement==null||this.sElementID!=j||this.oPreviousBaseElement!=f){this.bBlockReOpen=false;}this.sElementID=j;this.oElement=$Element(j);this.nEffectTime=i;if(this.bBlockReOpen==false){if(f){this.oPreviousBaseElement=f;this.oElement.css({position:"absolute",zIndex:"10000"});var c=$Element(f).offset();var d=this.oElement.$value();if(!e){if(b||a){e=5;}else{e=7;
}}if(this.oOptions.bAutoAdjusting){this.oElement.show();if(e<5){var h=c.top-document.body.scrollTop;if(e==3||e==4){h+=f.offsetHeight;}if(h<d.offsetHeight){switch(e){case 1:e=7;break;case 2:e=8;break;case 3:e=5;break;case 4:e=6;break;}}}else{var g=document.body.clientHeight-c.top+document.body.scrollTop;if(e==7||e==8){g-=f.offsetHeight;}if(g<d.offsetHeight){switch(e){case 5:e=3;break;case 6:e=4;break;case 7:e=1;break;case 8:e=2;break;}}}this.oElement.hide();}b=b?(c.top+b):c.top;a=a?(c.left+a):c.left;if(this.nEffectTime){this.oElement.appear(this.nEffectTime);}else{this.oElement.show();}switch(e){case 1:b=b-d.offsetHeight;break;case 2:b=b-d.offsetHeight;a=a-(d.offsetWidth-f.offsetWidth);break;case 3:b=b-d.offsetHeight+f.offsetHeight;break;case 4:b=b-d.offsetHeight+f.offsetHeight;a=a-(d.offsetWidth-f.offsetWidth);break;case 5:break;case 6:a=a-(d.offsetWidth-f.offsetWidth);break;case 7:b=b+f.offsetHeight;break;case 8:b=b+f.offsetHeight;a=a-(d.offsetWidth-f.offsetWidth);break;default:break;}$Element(d).offset(b,a);
}else{if(b){if(b&&a){this.oElement.css({position:"absolute",zIndex:"10000",top:b+"px",left:a+"px"});}}if(this.nEffectTime){this.oElement.appear(this.nEffectTime);}else{this.oElement.show();}}this.wfMouseOverEvent=$Fn(this._onMouseOver,this).attach(this.oElement,"mouseover");this.wfMouseOutEvent=$Fn(this._onMouseOut,this).attach(this.oElement,"mouseout");this.wfCheckLayerEvent=$Fn(this._checkLayer,this).attach(document,"mousedown");this.oOptions.onShow(this.oElement);}},hide:function(a){if(a){this.oElement=$Element(a);}if(this.oElement){this.wfMouseOverEvent.detach(this.oElement,"mouseover");if(this.nEffectTime){this.oElement.disappear(this.nEffectTime);}else{this.oElement.hide();}this.wfMouseOutEvent.detach(this.oElement,"mouseout");this.wfCheckLayerEvent.detach(document,"mousedown");this.nEffectTime=0;this.bCursorOver=false;this.oOptions.onHide(this.oElement);this.oElement=null;}},toggle:function(a,b,c,d){if(this.sElementID!=""&&this.oPreviousBaseElement!=null&&this.oPreviousBaseElement!=b&&$(this.sElementID)!=null){$Element(this.sElementID).hide();
}if(!$Element(a).visible()){this.show(a,b,c,d);}else{this.hide();}},_checkLayer:function(a){var b=this.oOptions.sToggleClassName;if($Element(a.element).hasClass(b)){return;}if(this.bCursorOver==false){this.hide();this.bBlockReOpen=true;setTimeout($Fn(function(){this.bBlockReOpen=false;},this).bind(),300);}},_onMouseOver:function(){this.bCursorOver=true;},_onMouseOut:function(){this.bCursorOver=false;}});
