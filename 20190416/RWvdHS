// For license information, see `http://img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/launch-ENf7805d09fd1b455883333cdf34ee4ca2.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2019-04-03T05:02:59Z",environment:"production",turbineBuildDate:"2018-12-11T21:01:34Z",turbineVersion:"25.4.0"},dataElements:{},extensions:{core:{displayName:"Core",modules:{"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t,e,n,o){"use strict";var a,r,i,s=n("@adobe/reactor-document"),c=n("./helpers/decorateCode"),d=n("./helpers/loadCodeSequentially"),u=n("../../../node_modules/postscribe/dist/postscribe"),l=(a=function(t){u(s.body,t,{error:function(t){o.logger.error(t.msg)}})},r=[],i=function(){if(s.body)for(;r.length;)a(r.shift());else setTimeout(i,20)},function(t){r.push(t),i()}),p=function(){if(s.currentScript)return s.currentScript.async;for(var t=s.querySelectorAll("script"),e=0;e<t.length;e++){var n=t[e];if(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/.test(n.src))return n.async}return!0}();t.exports=function(t,e){var n={settings:t,event:e},o=n.settings.source;if(o)return n.settings.isExternal?d(o).then(function(t){t&&l(c(n,t))}):void(p||"loading"!==s.readyState?l(c(n,o)):s.write?s.write(c(n,o)):l(c(n,o)))}}},"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerLibraryLoadedTrigger(e)}}},"core/src/lib/events/pageBottom.js":{name:"page-bottom",displayName:"Page Bottom",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerPageBottomTrigger(e)}}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t){"use strict";t.exports=function(t,e){return t.source.call(e.element,e,e.target)}}},"core/src/lib/conditions/domain.js":{name:"domain",displayName:"Domain",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../../../node_modules/escape-string-regexp/index.js");t.exports=function(t){var e=o.location.hostname;return t.domains.some(function(t){return e.match(new RegExp("(^|\\.)"+a(t)+"$","i"))})}}},"core/src/lib/conditions/path.js":{name:"path",displayName:"Path Without Query String",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../helpers/textMatch");t.exports=function(t){var n=o.location.pathname;return t.paths.some(function(t){var e=t.valueIsRegex?new RegExp(t.value,"i"):t.value;return a(n,e)})}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(t,e,n,o){"use strict";var a=0,r=function(t){return t.settings.isExternal},i=function(t,e){return"<script>\n"+e+"\n</script>"},s=function(e,t){var n="__runScript"+ ++a;return _satellite[n]=function(t){t.call(e.event.element,e.event,e.event.target),delete _satellite[n]},'<script>_satellite["'+n+'"](function(event, target) {\n'+t+"\n});</script>"},c={javascript:function(t,e){return t.settings.global?i(t,e):s(t,e)},html:function(t,e){return r(t)?o.replaceTokens(e,t.event):e}};t.exports=function(t,e){return c[t.settings.language](t,e)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-promise"),a=n("./getSourceByUrl"),r=o.resolve();t.exports=function(e){var t=new o(function(n){var t=a(e);o.all([t,r]).then(function(t){var e=t[0];n(e)})});return r=t}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(n,o){!function a(t,e){"object"==typeof o&&"object"==typeof n?n.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof o?o.postscribe=e():t.postscribe=e()}(this,function(){return function(n){function o(t){if(a[t])return a[t].exports;var e=a[t]={exports:{},id:t,loaded:!1};return n[t].call(e.exports,e,e.exports,o),e.loaded=!0,e.exports}var a={};return o.m=n,o.c=a,o.p="",o(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var a=o(n(1));t.exports=a["default"]},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function d(){}function u(){var t=c.shift();if(t){var e=i.last(t);e.afterDequeue(),t.stream=r.apply(undefined,t),e.afterStreamStart()}}function r(t,e,o){function a(t){t=o.beforeWrite(t),g.write(t),o.afterWrite(t)}(g=new f["default"](t,o)).id=m++,g.name=o.name||g.id,l.streams[g.name]=g;var n=t.ownerDocument,r={close:n.close,open:n.open,write:n.write,writeln:n.writeln};p(n,{close:d,open:d,write:function s(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a(e.join(""))},writeln:function c(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return a(e.join("")+"\n")}});var i=g.win.onerror||d;return g.win.onerror=function(t,e,n){o.error({msg:t+" - "+e+": "+n}),i.apply(g.win,[t,e,n])},g.write(e,function(){p(n,r),g.win.onerror=i,o.done(),g=null,u()}),g}function l(t,e,n){if(i.isFunction(n))n={done:n};else if("clear"===n)return c=[],g=null,void(m=0);n=i.defaults(n,s);var o=[t=/^#/.test(t)?window.document.getElementById(t.substr(1)):t.jquery?t[0]:t,e,n];return t.postscribe={cancel:function a(){o.stream?o.stream.abort():o[1]=d}},n.beforeEnqueue(o),c.push(o),g||u(),t.postscribe}e.__esModule=!0;var p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};e["default"]=l;var f=a(n(2)),i=o(n(4)),s={afterAsync:d,afterDequeue:d,afterStreamStart:d,afterWrite:d,autoFix:!0,beforeEnqueue:d,beforeWriteToken:function T(t){return t},beforeWrite:function _(t){return t},done:d,error:function h(t){throw new Error(t.msg)},releaseAsync:!1},m=0,c=[],g=null;p(l,{streams:{},queue:c,WriteStream:f["default"]})},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){var n=x+e,o=t.getAttribute(n);return y.existy(o)?String(o):o}function M(t,e,n){var o=2<arguments.length&&n!==undefined?arguments[2]:null,a=x+e;y.existy(o)&&""!==o?t.setAttribute(a,o):t.removeAttribute(a)}e.__esModule=!0;var v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},D=a(n(3)),y=o(n(4)),L=!1,x="data-ps-",w="ps-style",R="ps-script",r=function(){function o(t,e){var n=1<arguments.length&&e!==undefined?arguments[1]:{};C(this,o),this.root=t,this.options=n,this.doc=t.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new D["default"]("",{autoFix:n.autoFix}),this.actuals=[t],this.proxyHistory="",this.proxyRoot=this.doc.createElement(t.nodeName),this.scriptStack=[],this.writeQueue=[],M(this.proxyRoot,"proxyof",0)}return o.prototype.write=function n(){var t;for((t=this.writeQueue).push.apply(t,arguments);!this.deferredRemote&&this.writeQueue.length;){var e=this.writeQueue.shift();y.isFunction(e)?this._callFunction(e):this._writeImpl(e)}},o.prototype._callFunction=function a(t){var e={type:"function",value:t.name||t.toString()};this._onScriptStart(e),t.call(this.win,this.doc),this._onScriptDone(e)},o.prototype._writeImpl=function r(t){this.parser.append(t);for(var e=void 0,n=void 0,o=void 0,a=[];(e=this.parser.readToken())&&!(n=y.isScript(e))&&!(o=y.isStyle(e));)(e=this.options.beforeWriteToken(e))&&a.push(e);0<a.length&&this._writeStaticTokens(a),n&&this._handleScriptToken(e),o&&this._handleStyleToken(e)},o.prototype._writeStaticTokens=function i(t){var e=this._buildChunk(t);return e.actual?(e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,L&&(e.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),L&&(e.actualInnerHTML=this.root.innerHTML),e):null},o.prototype._buildChunk=function u(t){for(var e=this.actuals.length,n=[],o=[],a=[],r=t.length,i=0;i<r;i++){var s=t[i],c=s.toString();if(n.push(c),s.attrs){if(!/^noscript$/i.test(s.tagName)){var d=e++;o.push(c.replace(/(\/?>)/," "+x+"id="+d+" $1")),s.attrs.id!==R&&s.attrs.id!==w&&a.push("atomicTag"===s.type?"":"<"+s.tagName+" "+x+"proxyof="+d+(s.unary?" />":">"))}}else o.push(c),a.push("endTag"===s.type?c:"")}return{tokens:t,raw:n.join(""),actual:o.join(""),proxy:a.join("")}},o.prototype._walkChunk=function s(){for(var t=void 0,e=[this.proxyRoot];y.existy(t=e.shift());){var n=1===t.nodeType;if(!n||!b(t,"proxyof")){n&&M(this.actuals[b(t,"id")]=t,"id");var o=t.parentNode&&b(t.parentNode,"proxyof");o&&this.actuals[o].appendChild(t)}e.unshift.apply(e,y.toArray(t.childNodes))}},o.prototype._handleScriptToken=function c(t){var e=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),t.src=t.attrs.src||t.attrs.SRC,(t=this.options.beforeWriteToken(t))&&(t.src&&this.scriptStack.length?this.deferredRemote=t:this._onScriptStart(t),this._writeScriptToken(t,function(){e._onScriptDone(t)}))},o.prototype._handleStyleToken=function d(t){var e=this.parser.clear();e&&this.writeQueue.unshift(e),t.type=t.attrs.type||t.attrs.TYPE||"text/css",(t=this.options.beforeWriteToken(t))&&this._writeStyleToken(t),e&&this.write()},o.prototype._writeStyleToken=function l(t){var e=this._buildStyle(t);this._insertCursor(e,w),t.content&&(e.styleSheet&&!e.sheet?e.styleSheet.cssText=t.content:e.appendChild(this.doc.createTextNode(t.content)))},o.prototype._buildStyle=function e(t){var n=this.doc.createElement(t.tagName);return n.setAttribute("type",t.type),y.eachKey(t.attrs,function(t,e){n.setAttribute(t,e)}),n},o.prototype._insertCursor=function p(t,e){this._writeImpl('<span id="'+e+'"/>');var n=this.doc.getElementById(e);n&&n.parentNode.replaceChild(t,n)},o.prototype._onScriptStart=function f(t){t.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(t)},o.prototype._onScriptDone=function m(t){t===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,t.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},o.prototype._writeScriptToken=function g(t,e){var n=this._buildScript(t),o=this._shouldRelease(n),a=this.options.afterAsync;t.src&&(n.src=t.src,this._scriptLoadHandler(n,o?a:function(){e(),a()}));try{this._insertCursor(n,R),n.src&&!o||e()}catch(r){this.options.error(r),e()}},o.prototype._buildScript=function T(t){var n=this.doc.createElement(t.tagName);return y.eachKey(t.attrs,function(t,e){n.setAttribute(t,e)}),t.content&&(n.text=t.content),n},o.prototype._scriptLoadHandler=function _(e,n){function o(){e=e.onload=e.onreadystatechange=e.onerror=null}function a(){o(),null!=n&&n(),n=null}function r(t){o(),i(t),null!=n&&n(),n=null}function t(t,e){var n=t["on"+e];null!=n&&(t["_on"+e]=n)}var i=this.options.error;t(e,"load"),t(e,"error"),v(e,{onload:function s(){if(e._onload)try{e._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){r({msg:"onload handler failed "+t+" @ "+e.src})}a()},onerror:function c(){if(e._onerror)try{e._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(t){return void r({msg:"onerror handler failed "+t+" @ "+e.src})}r({msg:"remote script failed "+e.src})},onreadystatechange:function d(){/^(loaded|complete)$/.test(e.readyState)&&a()}})},o.prototype._shouldRelease=function h(t){return!/^script$/i.test(t.nodeName)||!!(this.options.releaseAsync&&t.src&&t.hasAttribute("async"))},o}();e["default"]=r},function(n){!function o(t,e){n.exports=e()}(0,function(){return function(n){function o(t){if(a[t])return a[t].exports;var e=a[t]={exports:{},id:t,loaded:!1};return n[t].call(e.exports,e,e.exports,o),e.loaded=!0,e.exports}var a={};return o.m=n,o.c=a,o.p="",o(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var a=o(n(1));t.exports=a["default"]},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var l=a(n(2)),p=a(n(3)),f=o(n(6)),r=n(5),m={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},i=function(){function c(t,e){var n=this,o=0<arguments.length&&t!==undefined?arguments[0]:"",a=1<arguments.length&&e!==undefined?arguments[1]:{};u(this,c),this.stream=o;var r=!1,i={};for(var s in l)l.hasOwnProperty(s)&&(a.autoFix&&(i[s+"Fix"]=!0),r=r||i[s+"Fix"]);this._peekToken=r?(this._readToken=(0,f["default"])(this,i,function(){return n._readTokenImpl()}),(0,f["default"])(this,i,function(){return n._peekTokenImpl()})):(this._readToken=this._readTokenImpl,this._peekTokenImpl)}return c.prototype.append=function e(t){this.stream+=t},c.prototype.prepend=function n(t){this.stream=t+this.stream},c.prototype._readTokenImpl=function o(){var t=this._peekTokenImpl();if(t)return this.stream=this.stream.slice(t.length),t},c.prototype._peekTokenImpl=function a(){for(var t in m)if(m.hasOwnProperty(t)&&m[t].test(this.stream)){var e=p[t](this.stream);if(e)return"startTag"===e.type&&/script|style/i.test(e.tagName)?null:(e.text=this.stream.substr(0,e.length),e)}},c.prototype.peekToken=function t(){return this._peekToken()},c.prototype.readToken=function r(){return this._readToken()},c.prototype.readTokens=function i(t){for(var e=void 0;e=this.readToken();)if(t[e.type]&&!1===t[e.type](e))return},c.prototype.clear=function s(){var t=this.stream;return this.stream="",t},c.prototype.rest=function d(){return this.stream},c}();for(var s in(e["default"]=i).tokenToString=function(t){return t.toString()},i.escapeAttributes=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,r.escapeQuotes)(t[n],null));return e},i.supports=l)l.hasOwnProperty(s)&&(i.browserHasFlaw=i.browserHasFlaw||!l[s]&&s)},function(t,e){"use strict";var n=!(e.__esModule=!0),o=!1,a=window.document.createElement("div");try{var r="<P><I></P></I>";a.innerHTML=r,e.tagSoup=n=a.innerHTML!==r}catch(i){e.tagSoup=n=!1}try{a.innerHTML="<P><i><P></P></i></P>",e.selfClose=o=2===a.childNodes.length}catch(i){e.selfClose=o=!1}a=null,e.tagSoup=n,e.selfClose=o},function(t,e,n){"use strict";function o(t){var e=t.indexOf("-->");if(0<=e)return new u.CommentToken(t.substr(4,e-1),e+3)}function a(t){var e=t.indexOf("<");return new u.CharsToken(0<=e?e:t.length)}function r(t){var i,s,c;if(-1!==t.indexOf(">")){var e=t.match(l.startTag);if(e){var n=(i={},s={},c=e[2],e[2].replace(l.attr,function(t,e,n,o,a,r){n||o||a||r?arguments[5]?(i[arguments[5]]="",s[arguments[5]]=!0):i[e]=arguments[2]||arguments[3]||arguments[4]||l.fillAttr.test(e)&&e||"":i[e]="",c=c.replace(t,"")}),{v:new u.StartTagToken(e[1],e[0].length,i,s,!!e[3],c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===n?"undefined":d(n)))return n.v}}}function i(t){var e=r(t);if(e){var n=t.slice(e.length);if(n.match(new RegExp("</\\s*"+e.tagName+"\\s*>","i"))){var o=n.match(new RegExp("([\\s\\S]*?)</\\s*"+e.tagName+"\\s*>","i"));if(o)return new u.AtomicTagToken(e.tagName,o[0].length+e.length,e.attrs,e.booleanAttrs,o[1])}}}function s(t){var e=t.match(l.endTag);if(e)return new u.EndTagToken(e[1],e[0].length)}e.__esModule=!0;var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.comment=o,e.chars=a,e.startTag=r,e.atomicTag=i,e.endTag=s;var u=n(4),l={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(t,e,n){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e.EndTagToken=e.AtomicTagToken=e.StartTagToken=e.TagToken=e.CharsToken=e.CommentToken=e.Token=undefined;var c=n(5),o=e.Token=function o(t,e){s(this,o),this.type=t,this.length=e,this.text=""},a=(e.CommentToken=function(){function n(t,e){s(this,n),this.type="comment",this.length=e||(t?t.length:0),this.text="",this.content=t}return n.prototype.toString=function t(){return"<!--"+this.content},n}(),e.CharsToken=function(){function e(t){s(this,e),this.type="chars",this.length=t,this.text=""}return e.prototype.toString=function t(){return this.text},e}(),e.TagToken=function(){function r(t,e,n,o,a){s(this,r),this.type=t,this.length=n,this.text="",this.tagName=e,this.attrs=o,this.booleanAttrs=a,this.unary=!1,this.html5Unary=!1}return r.formatTag=function i(t,e){var n=1<arguments.length&&e!==undefined?arguments[1]:null,o="<"+t.tagName;for(var a in t.attrs)if(t.attrs.hasOwnProperty(a)){o+=" "+a;var r=t.attrs[a];"undefined"!=typeof t.booleanAttrs&&"undefined"!=typeof t.booleanAttrs[a]||(o+='="'+(0,c.escapeQuotes)(r)+'"')}return t.rest&&(o+=" "+t.rest),t.unary&&!t.html5Unary?o+="/>":o+=">",n!==undefined&&null!==n&&(o+=n+"</"+t.tagName+">"),o},r}());e.StartTagToken=function(){function i(t,e,n,o,a,r){s(this,i),this.type="startTag",this.length=e,this.text="",this.tagName=t,this.attrs=n,this.booleanAttrs=o,this.html5Unary=!1,this.unary=a,this.rest=r}return i.prototype.toString=function t(){return a.formatTag(this)},i}(),e.AtomicTagToken=function(){function r(t,e,n,o,a){s(this,r),this.type="atomicTag",this.length=e,this.text="",this.tagName=t,this.attrs=n,this.booleanAttrs=o,this.unary=!1,this.html5Unary=!1,this.content=a}return r.prototype.toString=function t(){return a.formatTag(this,this.content)},r}(),e.EndTagToken=function(){function n(t,e){s(this,n),this.type="endTag",this.length=e,this.text="",this.tagName=t}return n.prototype.toString=function t(){return"</"+this.tagName+">"},n}()},function(t,e){"use strict";function n(t,e){var n=1<arguments.length&&e!==undefined?arguments[1]:"";return t?t.replace(/([^"]*)"/g,function(t,e){return/\\/.test(e)?e+'"':e+'\\"'}):n}e.__esModule=!0,e.escapeQuotes=n},function(t,e){"use strict";function d(t){return t&&"startTag"===t.type&&(t.unary=o.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t}function u(t,e){var n=t.stream,o=d(e());return t.stream=n,o}function l(t,e){var n=e.pop();t.prepend("</"+n.tagName+">")}function p(){var t=[];return t.last=function(){return this[this.length-1]},t.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},t.containsTagName=function(t){for(var e,n=0;e=this[n];n++)if(e.tagName===t)return!0;return!1},t}function n(n,o,e){function a(){var t=u(n,e);t&&i[t.type]&&i[t.type](t)}var r=p(),i={startTag:function s(t){var e=t.tagName;"TR"===e.toUpperCase()&&r.lastTagNameEq("TABLE")?(n.prepend("<TBODY>"),a()):o.selfCloseFix&&f.test(e)&&r.containsTagName(e)?r.lastTagNameEq(e)?l(n,r):(n.prepend("</"+t.tagName+">"),a()):t.unary||r.push(t)},endTag:function c(t){r.last()?o.tagSoupFix&&!r.lastTagNameEq(t.tagName)?l(n,r):r.pop():o.tagSoupFix&&(e(),a())}};return function t(){return a(),d(e())}}e.__esModule=!0,e["default"]=n;var o=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,f=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])})},function(t,e){"use strict";function o(t){return null!=t}function n(t){return"function"==typeof t}function a(t,e,n){var o=void 0,a=t&&t.length||0;for(o=0;o<a;o++)e.call(n,t[o],o)}function r(t,e,n){for(var o in t)t.hasOwnProperty(o)&&e.call(n,o,t[o])}function i(n,t){return n=n||{},r(t,function(t,e){o(n[t])||(n[t]=e)}),n}function s(t){try{return Array.prototype.slice.call(t)}catch(o){var e=(n=[],a(t,function(t){n.push(t)}),{v:n});if("object"===(void 0===e?"undefined":p(e)))return e.v}var n}function c(t){return t[t.length-1]}function d(t,e){return!(!t||"startTag"!==t.type&&"atomicTag"!==t.type||!("tagName"in t)||!~t.tagName.toLowerCase().indexOf(e))}function u(t){return d(t,"script")}function l(t){return d(t,"style")}e.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.existy=o,e.isFunction=n,e.each=a,e.eachKey=r,e.defaults=i,e.toArray=s,e.last=c,e.isTag=d,e.isScript=u,e.isStyle=l}])})}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-load-script"),a=n("@adobe/reactor-promise"),r={},i={},s=function(t){return i[t]||(i[t]=o(t)),i[t]};_satellite.__registerScript=function(t,e){r[t]=e},t.exports=function(e){return r[e]?a.resolve(r[e]):new a(function(t){s(e).then(function(){t(r[e])},function(){t()})})}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-window"),a=n("@adobe/reactor-document"),r=-1!==o.navigator.appVersion.indexOf("MSIE 10"),i="WINDOW_LOADED",s="DOM_READY",c="PAGE_BOTTOM",d=[c,s,i],u=function(t,e){return{element:t,target:t,nativeEvent:e}},l={};d.forEach(function(t){l[t]=[]});var p=function(t,e){d.slice(0,m(t)+1).forEach(function(t){g(e,t)})},f=function(){return"complete"===a.readyState?i:"interactive"===a.readyState?r?null:s:void 0},m=function(t){return d.indexOf(t)},g=function(e,t){l[t].forEach(function(t){T(e,t)}),l[t]=[]},T=function(t,e){var n=e.trigger,o=e.syntheticEventFn;n(o?o(t):null)};o._satellite=o._satellite||{},o._satellite.pageBottom=p.bind(null,c),a.addEventListener("DOMContentLoaded",p.bind(null,s),!0),o.addEventListener("load",p.bind(null,i),!0),o.setTimeout(function(){var t=f();t&&p(t)},0),t.exports={registerLibraryLoadedTrigger:function(t){t()},registerPageBottomTrigger:function(t){l[c].push({trigger:t})},registerDomReadyTrigger:function(t){l[s].push({trigger:t,syntheticEventFn:u.bind(null,a)})},registerWindowLoadedTrigger:function(t){l[i].push({trigger:t,syntheticEventFn:u.bind(null,o)})}}}},"core/node_modules/escape-string-regexp/index.js":{script:function(t){"use strict";var e=/[|\\{}()[\]^$+*?.]/g;t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(e,"\\$&")}}},"core/src/lib/helpers/textMatch.js":{script:function(t){"use strict";t.exports=function(t,e){if(null==e)throw new Error("Illegal Argument: Pattern is not present");return null!=t&&("string"==typeof e?t===e:e instanceof RegExp&&e.test(t))}}}},hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/COdb619ef0f3bc48f09d9a4c3a5e66564d/PRb55c9879b37e451cb2349365f439f194/BLfd2f52d576ad4c35bb4557f4cb219fcc/hostedLibFiles/EP9f64ab5391d540b0bb8658a244bbeb36/"}},company:{orgId:"EA76ADE95776D2EC7F000101@AdobeOrg"},property:{name:"Store",settings:{domains:["microsoft.com"],undefinedVarsReturnEmpty:!1}},rules:[{id:"RLccb37cc0e2374906891741ffbc13a98f",name:"GBLDL",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-80}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n\tvar _TMDL = {\n\t\tbusgrp : [], \n\t\tcc : "Unknown",\n\t\tisprod : false,\n\t\tgeo : "",\n\t\thost : window.location.hostname.toLowerCase(),\n\t\titemprices : [],\n\t\tlineItems : [],\n\t\tll : "other",\n\t\tmuid : "",\n\t\tpagename : "other",\n\t\tpageName : "other",\n\t\tpageType : "other",\n\t\tpath : window.location.pathname.toLowerCase(),\n\t\tpids : [],\n\t\tpidsku : [],\n\t\tpnames : [],  \n\t\tprdCt : [],  \n\t\tprdFam : [],\n\t\tprdPrCat : [],  \n\t\tprdSecCat : [],  \n\t\tprdSubCat : [],  \n\t\tprdType : [],\n\t\tpT : "",\n\t\tpurchaseID : "",\n\t\tquantities : [],\n\t\treflc : "",\n\t\trevsumdiv : [],\n\t\tsales : [],\n\t\tskus : [],\n\t\ttotamount : 0,\n\t\ttotqty : 0,\n\t\tlogRuleCall : function (r,d,i) {\n\t\t\tif (typeof _TMutils ===\'object\') {\n\t\t\t_TMutils.logRuleCall(r,d,i);\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\t_satellite.logger.error("error in logging and no _satellite obj");\n\t\t\t\t} catch(_saterr) {}\n\t\t\t}\n\t\t},\n\t\tgetQSParam : function(arr,param2find) {\n\t\t\tvar n, \n\t\t\t\ti=0, \n\t\t\t\tj=arr.length, \n\t\t\t\tnvpair=[];\n\t\t\tfor (i=0; i < j; i++) {\n\t\t\t\tnvpair = arr[i].split("=");\n\t\t\t\tif (nvpair[0].toLowerCase()==param2find.toLowerCase() && nvpair[1]) { \n\t\t\t\t\treturn nvpair[1];\n\t\t\t\t} \n\t\t\t}\n\t\t\treturn "";\n\t\t},\n\t\treadCookie : function(name) {\n\t\t\tvar nameEQ = name + "=";\n\t\t\tvar ca = document.cookie.split(\';\');\n\t\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0)==\' \') c = c.substring(1,c.length);\n\t\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tcreateCookie : function(name,value,days) {\n\t\t\tvar expires = "";\n\t\t\tvar date;\n\t\t\tvar domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n\t\t\tif (days) {\n\t\t\t\tdate = new Date();\n\t\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\t\texpires = "; expires="+date.toGMTString();\n\t\t\t}\n\t\t\tdocument.cookie = name+"="+value+expires+domainstr;\n\t\t}\n\t};\n\n\tvar qs="",\n\t\tqsdecoded="",\n\t\tqs2="",\n\t\tqsarr=[],\n\t\tjsonstr="",\n\t\tjsonobj={},\n\t\tjsonstr,\n\t\tpt,\n\t\tpc,\n\t\tptlower,\n\t\t_pagetypemap = {}\n\t;\n\n\tif (document.referrer) {\n\t\treflc = document.referrer.toLowerCase();\n\t}\n\n\tqs = (window.location.search) ? window.location.search : "";\n\tif (qs.indexOf("?n=ensighten.html?")==0) {\n\t\tqs = qs.substring(17);\n\t}\n\tif (qs.indexOf("?")==0) {\n\t\tqs = qs.substring(1);\n\t}\n\tqs = qs.replace(/%20&%20/g,"%20%26%20");\n\tqs = qs.replace(/ & /g,"%20%26%20");\n\tqsarr=qs.split("&");\n\n\n\tif (~window.location.host.indexOf("compass-ssl.xboxlive.com") || ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {\n\t\t// top level params from iframe:  pN=cart&cl=en-US&market=US\n\t\t_TMDL.purchaseID = _TMDL.getQSParam(qsarr,"orderId") || _TMDL.getQSParam(qsarr,"id");\n\t\t_TMDL.muid = _TMDL.getQSParam(qsarr,"muid");\n\t\t_TMDL.pageName = _TMDL.getQSParam(qsarr,"pN");\n\t\t_TMDL.pageType = _TMDL.pageName;\n\t\t_TMDL.geo = _TMDL.getQSParam(qsarr,"market");\n\t\t_TMDL.ll = _TMDL.getQSParam(qsarr,"culture") || _TMDL.getQSParam(qsarr,"cl");\n\t\t_TMDL.totamount = _TMDL.getQSParam(qsarr,"totAmtWoTx");\n\t\tjsonstr = _TMDL.getQSParam(qsarr,"orderLineItems");\n\t\tif (~reflc.indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta")<0) { _TMDL.isprod=true;}\n\t\tif (!jsonstr) {\n\t\t\t_TMDL.logRuleCall("orderLineItems json missing");  \n\t\t} else {\t\n\t\t\ttry {\n\t\t\t\t\tif (jsonstr.indexOf("[")>-1) {\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20Dis/g,\'%20Dis\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/portable%2013%22%20/g,\'portable%2013%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20FHD/g,\'%20FHD\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20QHD/g,\'%20QHD\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%204K/g,\'%204K\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g,\'%22Samsung%2049%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%2F/g,\'%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/5%22%20%2F/g,\'5%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%223%2F4%22%20/g,\'%223%2F4%20\');  // 3/4" Major Nelson\t\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/15.6%22%20/g,\'15.6%20\');\t\t\t\t\t\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22/g,\'"\');\t\n\t\t\t\t\t\t_TMDL.lineItems = JSON.parse(jsonstr);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20Dis/g,\'%20Dis\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/portable%2013%22%20/g,\'portable%2013%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20FHD/g,\'%20FHD\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%20QHD/g,\'%20QHD\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g,\'%22Samsung%2049%20\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%204K/g,\'%204K\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%22%2F/g,\'%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/5%22%20%2F/g,\'5%2F\');\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/%223%2F4%22%20/g,\'%223%2F4%20\');  // 3/4" Major Nelson\t\n\t\t\t\t\t\tjsonstr = jsonstr.replace(/15.6%22%20/g,\'15.6%20\');\t\n\t\t\t\t\t\t_TMDL.lineItems = JSON.parse(decodeURIComponent(jsonstr));\n\t\t\t\t\t}\n\t\t\t} catch(jsonparseerr) {_TMDL.logRuleCall("jsonparse error",window.location.href.slice(255,510),window.location.href.slice(510,510+255));}\n\t\t}\n\t} else if (typeof _pageBITags == "object") {\n\t\t// consume _pageBITags object from the non-iframe pages (e.g. OneRF)\n\t\tpt = _pageBITags.pageTags;\n\t\tptlower = pt.pageType.toLowerCase();\n\n\t\t_TMDL.pageName = pt.pageName;\n\t\t_TMDL.ll = pt.mkt;\n\t\t_TMDL.lang = pt.mkt.split("-")[0];\n\t\t_TMDL.geo = pt.mkt.split("-")[1];\n\t\t_TMDL.pageType = pt.pageType;\n\t\tif (~window.location.host.toLowerCase().indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta")<0) { _TMDL.isprod=true;}\n\t\t\n\t\ttry {\n\t\t\t_TMDL.muid = _TMDL.readCookie("MUID");\n\t\t} catch(muiderr) {_TMDL.logRuleCall("muid err");  }\n\t\t\n\t\tif (~ptlower.indexOf("category")) {\n\t\t\t// CATEGORY PAGE\n\t\t\t// https://onestore-ppe.microsoft.com/en-sg/store/b/surface?icid=CNavDevicesSurface&setswitch=optimizely_disabled%3A1%2Censighten_disabled%3D0\n\t\t\t\n\t\t} else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && (typeof _pageBITags.pageContracts.ProductInfo == "object")) {\n\t\t\t// PDP PAGE\n\t\t\tpc = _pageBITags.pageContracts.ProductInfo;\n\t\t\t_TMDL.pids.push(pc.id);\n\t\t\t_TMDL.skus.push(pc.sku);\n\t\t\t_TMDL.pidsku.push(pc.id+"-"+pc.sku);\n\t\t\t_TMDL.prdCt.push(pc.prdCt);\n\t\t\t_TMDL.prdPrCat.push(pc.priCat);\n\t\t\t_TMDL.prdSecCat.push(pc.prdSecCat);\n\t\t\t_TMDL.prdSubCat.push(pc.prdSubCat);\n\t\t\t_TMDL.prdType.push(pc.family);\n\t\t\t_TMDL.pnames.push(pc.title);\t\n\t\t\t_TMDL.cc = pc.cur;\n\t\t\t_TMDL.quantities.push(1);\n\t\t\t_TMDL.sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice);\n\t\t\t_TMDL.quantities.push(1);\n\t\t\t_TMDL.itemprices.push(_TMDL.sales[0]);\n\t\t}\t\n\t}\n\n\ttry {\n\t\t// remap pagetypes\n\t\t_pagetypemap = {\n\t\t\t// old : new\n\t\t\t"pdp" : "detail",\n\t\t\t"product details" : "detail",\n\t\t\t"sfw-pdp-pagetemplate" : "detail",\n\t\t\t"sfw-category-pagetemplate" : "category",\n\t\t\t"onestore-shoppingcart-template" : "cart",\n\t\t\t"congrats" : "receipt"\n\t\t};\n\n\t\tif (_pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\t\t_TMDL.pageType = _pagetypemap[_TMDL.pageType.toLowerCase()];\n\t\t}\n\t\t\n\t\t_TMDL.pT=(_TMDL.pageType=="receipt")? "rP":_TMDL.pageType;\n\t\t\n\t\t// added 7/12/18 due to Convergence making category pagetype less reliable\n\t\tif (~window.location.pathname.indexOf("/b/") && window.location.pathname.indexOf("RETg7o")<0) {\n\t\t\t_TMDL.pageType="category";\n\t\t} \n\n\t} catch(err) {_TMDL.logRuleCall("pageTypeMapError",_TMDL.pageType);}\n\n\t//--------------------------------------------------------\n\t// create backwards compatible arrays from orderLineItems\n\t//--------------------------------------------------------\n\tvar temppname;\n\n\tfor (var i=0; i<_TMDL.lineItems.length;i++) {\n\t\ttemppname="";\n\t\t_TMDL.pids.push((_TMDL.lineItems[i].pId)?_TMDL.lineItems[i].pId:"");\n\t\t_TMDL.skus.push((_TMDL.lineItems[i].sku)?_TMDL.lineItems[i].sku:"");\n\t\ttry {\n\t\t\ttemppname = decodeURIComponent(_TMDL.lineItems[i].ti);\n\t\t} catch(pnameerr) {\n\t\t\ttemppname = (_TMDL.lineItems[i].ti) ? _TMDL.lineItems[i].ti:"" ;\n\t\t}\n\t\t_TMDL.pnames.push(temppname);  \n\n\t\t_TMDL.sales.push((_TMDL.lineItems[i].tot && typeof _TMDL.lineItems[i].txA !== \'undefined\' && typeof _TMDL.lineItems[i].q !== \'undefined\')? (_TMDL.lineItems[i].tot - (_TMDL.lineItems[i].q * _TMDL.lineItems[i].txA)) : _TMDL.lineItems[i].tot);\t\n\t\t_TMDL.prdPrCat.push((_TMDL.lineItems[i].pC)?_TMDL.lineItems[i].pC:"");\n\t\t_TMDL.prdFam.push((_TMDL.lineItems[i].pF)?_TMDL.lineItems[i].pF:"");\n\t\t_TMDL.prdType.push((_TMDL.lineItems[i].pT)?_TMDL.lineItems[i].pT:"");\n\t\t_TMDL.pidsku.push(_TMDL.pids[i]+"-"+_TMDL.skus[i]);\n\t\t_TMDL.quantities.push((_TMDL.lineItems[i].q) ? _TMDL.lineItems[i].q : 1);\n\t\t\n\t\tif (_TMDL.lineItems[i].cur) { \n\t\t\t_TMDL.cc = _TMDL.lineItems[i].cur;\n\t\t}\n\n\t\t_TMDL.totqty+=_TMDL.quantities[i];\n\t\t_TMDL.itemprices.push(_TMDL.sales[i]/_TMDL.quantities[i]);\n\t}\n\n\tvar missingCCpagetype="";\n\tif (_TMDL.cc=="Unknown" && ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com") ) {\n\t\tmissingCCpagetype = (~window.location.href.indexOf("pN=congrats"))?"receipt" : "cart";\n\t\t_TMDL.logRuleCall("missingCC"+missingCCpagetype+"_"+_TMDL.geo,window.location.href.slice(255,510),window.location.href.slice(510,510+255));\n\t}\n\n\tvar ccmap = {\n\t\t\'US\' : \'USD\',\n\t\t\'AU\' : \'AUD\',\n\t\t\'BR\' : \'BRL\',\n\t\t\'CA\' : \'CAD\',\n\t\t\'CH\' : \'CHF\',\n\t\t\'DK\' : \'DKK\',\n\t\t\'GB\' : \'GBP\',\n\t\t\'JP\' : \'JPY\',\n\t\t\'MX\' : \'MXN\',\n\t\t\'NO\' : \'NOK\',\n\t\t\'RU\' : \'RUB\',\n\t\t\'SE\' : \'SEK\',\t\n\t\t\'AT\' : \'EUR\',\t\n\t\t\'BE\' : \'EUR\',\t\n\t\t\'CY\' : \'EUR\',\t\n\t\t\'DE\' : \'EUR\',\t\n\t\t\'ES\' : \'EUR\',\t\n\t\t\'FI\' : \'EUR\',\n\t\t\'FR\' : \'EUR\',\t\n\t\t\'GR\' : \'EUR\',\n\t\t\'IR\' : \'EUR\',\n\t\t\'IT\' : \'EUR\',\t\n\t\t\'LU\' : \'EUR\',\n\t\t\'NL\' : \'EUR\',\t\n\t\t\'PT\' : \'EUR\',\n\t\t\'NEVERHIT\' : \'Unknown\'\n\t};\n\tif (_TMDL.cc=="Unknown" || _TMDL.cc=="") {\n\t\ttry {\n\t\t\tif (ccmap[_TMDL.geo.toUpperCase()]) {\n\t\t\t\t_TMDL.cc = ccmap[_TMDL.geo.toUpperCase()];\n\t\t\t}\n\t\t} catch(ccerr) {}\n\t} \n\tif (_TMDL.cc=="Unknown" && (window.location.href.indexOf(\'"EUR"\')>-1 || window.location.href.indexOf("%22EUR%22")>-1)) { \n\t\t_TMDL.cc="EUR"; \n\t}\n\n\t_TMDL.pagename = _TMDL.pageName; // backwards compatibility for some tags\n\n\t// make global for access in other tags\n\n\twindow._TMDL = window._TMDL || _TMDL;\n}\ncatch(err){console.log("DataLayer: "+err.message);}\n',language:"javascript"}}]},{id:"RLabc909371d7b4ce29ac27543d2fd8226",name:"ADHOCCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nADHOC CVF\n*/\ntry\n{\n\tvar geolc=_TMDL.geo.toLowerCase();\n\tvar adobedsp="";\n\tvar imgsrc="";\n\n\tif (_TMDL.isprod && _TMDL.pT=="rp")\n\t{\n\n\t\t// uses approach 2:  single pixel, concatenating the product IDs (rather than sending a separate pixel for each line\n\t\t// DE, FR, GB, US\n\t\tif (geolc=="de" || geolc=="fr" || geolc=="gb" || geolc=="us") {\n\t\t\tadobedsp="https://pixel.everesttech.net/px2/5584?px_evt=t&ev_"+_TMDL.pidsku.join("_")+"_count="+_TMDL.totqty\n\t\t\t\t+"&ev_"+_TMDL.pidsku.join("_")+"_revenue="+_TMDL.totamount\n\t\t\t\t+"&ev_transid="+_TMDL.purchaseID;\n\t\t\timgsrc=adobedsp;\n\t\t\tBootstrapper.imageRequest(adobedsp);\n\t\t}\n\t}\n\n\tvar twmarketMap = {\n\t"BE" : "o173t",\n\t"DK" : "nznex",\n\t"FI" : "nznez",\n\t"NO" : "nznf1",\n\t"SE" : "nznf3",\n\t"IT" : "o0287",\n\t"ES" : "o028a",\n\t"PT" : "o0289",\n\t"NL" : "nvq0j",\n\t"LU" : "o18ai"\n\t};\n\tvar twtagID="",twimg1="",twimg2="";\n\n\tif(_TMDL && twmarketMap[_TMDL.geo.toUpperCase()] ){twtagID = twmarketMap[_TMDL.geo.toUpperCase()];}\n\t\n\tif (twtagID && _TMDL.isprod && _TMDL.pT=="rp") \n\t{\n\t\ttwimg1 = "https://analytics.twitter.com/i/adsct?txn_id="+tagID+"&p_id=Twitter&tw_sale_amount="+_TMDL.totamount+"&tw_order_quantity=1";\n\t\ttwimg2 = "//t.co/i/adsct?txn_id="+tagID+"&p_id=Twitter&tw_sale_amount="+_TMDL.totamount+"&tw_order_quantity=1";\n\t\timgsrc=twimg1;\n\t\tBootstrapper.imageRequest(img1);\n\t\timgsrc=twimg2;\n\t\tBootstrapper.imageRequest(img2);\t\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("ADHOC CVF",err.message,imgsrc);}\n\t_satellite.logger.error("ADHOC CVF");\n}\n\n',language:"javascript"}}]},{id:"RL804049235a48433cb1e82263436fba08",name:"ADOBEDCORTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*  Adobe DCO Retargeting tag\n*/\n\ntry {\n\t// landing pages\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u="";\n\tvar lang = (_TMDL.ll.indexOf("-")>-1) ? _TMDL.ll.split("-")[0].toLowerCase() : "";\n\tvar utstring = "&ut1="+_TMDL.pidsku.join("%2C")+"&ut2="+lang+"&ut3="+_TMDL.geo.toLowerCase()+"&cachebuster="+rand;\n\n\tif (_TMDL.pT.indexOf("cart")<0 && _TMDL.pageType!==\'rP\' ) {\n\t\t// landing pages\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20114&ActionName=Microsoft_Store_RT_Pixel"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n\n\tif (~_TMDL.pT.indexOf("rP") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50081&ActionName=Microsoft_Store_Conv_Pixel&Revenue="+_TMDL.totamount+"&TransactionID="+_TMDL.purchaseID+"&Currency="+_TMDL.cc+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t} else if (~_TMDL.pageType.toLowerCase().indexOf("cart") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20132&ActionName=Microsoft_Store_Cart_Abandoner"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n} catch(err){\n\tif (_satellite) {\n\t  _satellite.logger.error("Adobe DCO Retargeting Error");\n\t  if (_TMutils){_TMutils.logRuleCall("Adobe DCO Retargeting",err.message,u);}\n\t} \n}\n',language:"javascript"}}]},{id:"RL5ef0cd39ea4f4db69746ce5af693e0f3",name:"AMOCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// AMOCV\n\ntry \n{\n\tvar marketMap = {\n\t\"TR\" : \"MEA_TR\",\n\t\"KE\" : \"MEA_KE\",\n\t\"ZA\" : \"MEA_ZA\",\n\t\"IL\" : \"MEA_IL\",\n\t\"AE\" : \"MEA_AE\",\n\t\"EG\" : \"MEA_EG\",\n\t\"SA\" : \"MEA_SA\",\n\t\"PK\" : \"MEA_PK\",\n\t\"NG\" : \"MEA_NG\",\n\t\"QA\" : \"MEA_QA\",\n\t\"KW\" : \"MEA_KW\",\n\t\"LE\" : \"MEA_LE\",\n\t\"ZW\" : \"MEA_ZW\",\n\t// phase 2 and 3\n\n\t'BE' : 'WE_BE',\n\t'CN' : 'APAC_CHINA',\n\t'CZ' : 'CEE_CZ',\n\t'GR' : 'WE_GR',\n\t'HU' : 'CEE_HU',\n\t'LU' : 'WE_LU',\n\t'NL' : 'WE_NL',\n\t'PL' : 'CEE_PL',\n\t'RO' : 'CEE_RO',\n\t'RU' : 'CEE_RU',\n\t'SK' : 'CEE_SK',\n\t'CL' : 'LATAM_CL',\n\t'CR' : 'LATAM_CR',\n\t'DK' : 'WE_DK',\n\t'FI' : 'WE_FI',\n\t'MX' : 'LATAM_MX',\n\t'NO' : 'WE_NO',\n\t'PE' : 'LATAM_PE',\n\t'PR' : 'LATAM_PR',\n\t'SE' : 'WE_SE',\n\t'TT' : 'LATAM_TT',\n\t'AR' : 'LATAM_AR',\n\t'AT' : 'WE_AT',\n\t'BR' : 'LATAM_BR',\n\t'CO' : 'LATAM_CO',\n\t'FR' : 'WE_FR',\n\t'ID' : 'APAC_ID',\n\t'IE' : 'WE_IE',\n\t'IT' : 'WE_IT',\n\t'MY' : 'SEA_MY',\n\t'PH' : 'SEA_PH',\n\t'PT' : 'WE_PT',\n\t'SG' : 'SEA_SG',\n\t'ES' : 'WE_ES',\n\t'CH' : 'WE_CH',\n\t'TH' : 'APAC_TH',\n\t'AU' : 'SEA_AU',\n\t'DE' : 'WE_DE',\n\t'IN' : 'INDIA_IN',\n\t'NZ' : 'SEA_NZ',\n\t'GB' : 'WE_GB',\n\t'CA' : 'NA_CA',\n\t'HK' : 'SEA_HK',\n\t'JP' : 'APAC_JP',\n\t'KR' : 'SEA_KO',\n\t'TW' : 'GCR_TW',\n\t'US' : 'NA_US',\n\n\t// added 2/28/18\n\t'AZ' : 'CEE_CZ',\n\t'BY' : 'CEE_CZ',\n\t'BG' : 'CEE_CZ',\n\t'HR' : 'CEE_CZ',\n\t'KZ' : 'CEE_CZ',\n\t'LV' : 'CEE_CZ',\n\t'SI' : 'CEE_CZ',\n\t'UA' : 'CEE_CZ',\n\t'EE' : 'CEE_CZ',\n\n\t// added 3/27/18\n\t'VN' : 'SEA_VN'\n\n\t};\n\n\tvar prefix=\"\",userid=\"4249\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tprefix = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {if (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"AMO CV\",err.message,\"No AMO GEO Match\");}}\n\n\t//var prefix = 'SEA_SG';  // hardcode for now until next wave of markets \n\n\tif ((_TMDL.geo).toUpperCase()==\"CN\") {userid=\"4559\";}\n\n\tvar imgurl=\"\",\n\ttotamount=0,\n\tdebugstring=\"\",\n\tcc=(_TMDL.cc)?_TMDL.cc.toLowerCase() : \"\",\n\tclvamount=0;\n\n\t//var skus2update=[[\"P2W-00004\",10],[\"QR2-00011\",10],[\"RU2-00004\",10],[\"6GQ-00364\",5],[\"QQ2-00031\",5],[\"6GQ-00241\",5],[\"AAA-04580\",5],[\"R4T-00009\",5],[\"R4T-00010\",5]]; // updated 11/17/15\n\tvar skus2update=[[\"P2W-00004\",1]];\n\n\tvar clvlineitem=0;\n\n\tfor (var i=0; i<_TMDL.sales.length;i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t\t// check for a match against the SKUs with a multiplier\n\t\tclvlineitem=parseFloat(_TMDL.sales[i]);\n\t\tfor (var j=0; j<skus2update.length; j++) {\t\t\t\n\t\t\tif (_TMDL.skus[i].toLowerCase()==skus2update[j][0].toLowerCase()) {\n\t\t\t\t// sku matches, update price by applying multiplier\n\t\t\t\t// multiplier is second item in the nested array\n\t\t\t\tclvlineitem = parseFloat(skus2update[j][1]*_TMDL.sales[i]);\n\t\t\t} \n\t\t}\n\t\tclvamount+=clvlineitem;\n\t}\n\n\t//---------------------------------------\n\t// added for Office CPA bidding 8/9/17\n\t//---------------------------------------\n\n\tvar ev_officeHomeAnnual=\"\",\n\t\tev_officePersonalAnnual=\"\",\n\t\tev_officeHomeStudent=\"\",\n\t\tev_officeHomeMonthly=\"\",\n\t\tev_officePersonalMonthly=\"\",\n\t\tev_officeOther=\"\";\n\n\tvar ev_officeHomeAnnual_rev=0,\n\t\tev_officePersonalAnnual_rev=0,\n\t\tev_officeHomeStudent_rev=0,\n\t\tev_officeHomeMonthly_rev=0,\n\t\tev_officePersonalMonthly_rev=0,\n\t\tev_officeOther_rev=0;\n\t\n\tvar otherSKUS=[\n\t['CFQ7TTC0K5F8'],\n\t['CFQ7TTC0K5FD'],\n\t['CFQ7TTC0K5FF'],\n\t['CFQ7TTC0K5BB'],\n\t['CFQ7TTC0K5BC'],\n\t['CFQ7TTC0K5BD'],\n\t['8N0LL43Q1H85'],\n\t['CFQ7TTC0K5DZ'],\n\t['CFQ7TTC0K5F2'],\n\t['CFQ7TTC0K5F3'],\n\t['CFQ7TTC0K5BH'],\n\t['CFQ7TTC0K5D6'],\n\t['CFQ7TTC0K5D7'],\n\t['CFQ7TTC0K5CD'],\n\t['CFQ7TTC0K5CF'],\n\t['CFQ7TTC0K5CP'],\n\t['CFQ7TTC0K5CS'],\n\t['CFQ7TTC0K5CT'],\n\t['CFQ7TTC0K5D0'],\n\t['CFQ7TTC0K5DN']\n\t];\n\n\tvar ps=\"\",officeCPAstring=\"\";\n\n\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\tif (_TMDL.pidsku.length > i) {\n\t\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\t\tif (ps==\"CFQ7TTC0K5DM-007R\" || ps==\"CFQ7TTC0K5DM-007W\"){\n\t\t\t\tev_officeHomeAnnual=1;\n\t\t\t\tev_officeHomeAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007R\" || ps==\"CFQ7TTC0K5BF-007V\"){\n\t\t\t\tev_officePersonalAnnual=1;\n\t\t\t\tev_officePersonalAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5FB-0002\" || ps==\"CFQ7TTC0K5FC-0002\" || ps==\"CFQ7TTC0K5FB-000D\" || ps==\"CFQ7TTC0K5FC-000C\") {\n\t\t\t\tev_officeHomeStudent=1;\t\t\n\t\t\t\tev_officeHomeStudent_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5DM-007P\" || ps==\"CFQ7TTC0K5DM-007V\"){\n\t\t\t\tev_officeHomeMonthly=1;\n\t\t\t\tev_officeHomeMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007Q\" || ps==\"CFQ7TTC0K5BF-007S\"){\n\t\t\t\tev_officePersonalMonthly=1;\t\t\t\n\t\t\t\tev_officePersonalMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t}\n\t\t}\n\t\tfor (var j=0; j<otherSKUS.length; j++) {                                \n\t\t\tif (_TMDL.pids[i].toLowerCase()==otherSKUS[j][0].toLowerCase()) { \n\t\t\t\tev_officeOther = 1;\n\t\t\t\tev_officeOther_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (ev_officeHomeAnnual) {\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual_rev=\"+ev_officeHomeAnnual_rev;\n\t}\n\tif (ev_officePersonalAnnual) {\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual_rev=\"+ev_officePersonalAnnual_rev;\n\t}\n\tif (ev_officeHomeStudent) {\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent_rev=\"+ev_officeHomeStudent_rev;\n\t}\n\tif (ev_officeHomeMonthly) {\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly_rev=\"+ev_officeHomeMonthly_rev;\n\t}\n\tif (ev_officePersonalMonthly) {\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly_rev=\"+ev_officePersonalMonthly_rev;\n\t}\n\tif (ev_officeOther) {\n\t\tofficeCPAstring+=\"&ev_officeOther=1\";\n\t\tofficeCPAstring+=\"&ev_officeOther_rev=\"+ev_officeOther_rev;\n\t}\n\n\t//---------------------------\n\t// end office CPA addition\n\t//---------------------------\n\n\tif (_TMDL.pageType==\"receipt\" && _TMDL.isprod) {\n\t\t//imgurl=\"//pixel.everesttech.net/px2/4249?px_evt=t&ev_\"+prefix+\"_order=1&ev_revenue=\"+totamount+\"&ev_\"+prefix+\"_revenue=\"+totamount+\"&ev_currency_code=\"+_TMDL.cc+\"&ev_transid=\"+_TMDL.purchaseID;\n\t\timgurl=\"https://pixel.everesttech.net/px2/\"+userid+\"?px_evt=t\"\n\t\t\t+\"&ev_order=1\"\n\t\t\t+\"&ev_revenue=\"+totamount\n\t\t\t+\"&ev_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_\"+cc+\"_currency_code=1\"\n\t\t\t+\"&ev_\"+prefix+\"_order=1\"\n\t\t\t+\"&ev_\"+prefix+\"_revenue=\"+totamount\n\t\t\t+\"&ev_\"+prefix+\"_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_transid=\"+_TMDL.purchaseID\n\t\t\t+officeCPAstring;\n\t}\n\n\t//SAMPLE:  http://pixel.everesttech.net/px2/4249?px_evt=t&ev_order=1&ev_revenue=2.38&ev_clv_revenue=2.38&ev_mkd_currency_code=1&ev_mea_tr_order=1&ev_mea_tr_revenue=2.38&ev_mea_tr_clv_revenue=2.38&ev_transid=test999999\n\n\tdebugstring=\"\"+totamount+\": \"+_TMDL.totamount+\"   clv: \"+clvamount;\n\n\tif (imgurl && prefix && _TMDL.isprod && _TMDL.pageType==\"receipt\") {\n\t\tBootstrapper.imageRequest(imgurl);\n\t\tif (_TMDL.logRuleCall) {\n\t\t\t_TMDL.logRuleCall(\"AMO\",debugstring,imgurl);\n\t\t}\n\t}\n} catch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"AMO CV\",err.message,imgurl);}\n\t_satellite.logger.error(\"AMO CV\");\t\n}\n\n\n",language:"javascript"}}]},{id:"RL7f37642c034b465ca3119a09379409d3",name:"BINGLPCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()||"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// BINGUET\ntry\n{\n\t(function (w, d, t, r, u) {\n\t\tvar f,\n\t\tn,\n\t\ti;\n\t\tw[u] = w[u] || [],\n\t\tf = function () {\n\t\t\tvar o = {\n\t\t\t\tti: "4000034", navTimingApi:true  // set navTimingApi flag\n\t\t\t};\n\t\t\to.q = w[u],\n\t\t\tw[u] = new UET(o),\n\t\t\tw[u].push("pageLoad")\n\t\t},\n\t\tn = d.createElement(t),\n\t\tn.src = r,\n\t\tn.async = 1,\n\t\tn.onload = n.onreadystatechange = function () {\n\t\t\tvar s = this.readyState;\n\t\t\ts && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null)\n\t\t},\n\t\ti = d.getElementsByTagName(t)[0],\n\t\ti.parentNode.insertBefore(n, i)\n\t})(window, document, "script", "//bat.bing.com/bat.js", "uetq");\n\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  // old : [new, eventname]\n\t  "home": ["home","page_view"],\n\t  "search": ["searchresults","view_search_results"],\n\t  "detail": ["product","view_item"],\n\t  "category": ["category","view_item_list"],\n\t  "checkout_shopping_cart": ["cart","add_to_cart"],\n\t  "cart": ["cart","add_to_cart"],\n\t  "list": ["category","view_item_list"],\n\t  "receipt": ["purchase","Purchase"]\n\t};\n\n\tvar lineitemObj={};\n\tvar itemsArray=[];\n\n\tvar tempobj = {};\n\tvar eventname="page_view";\n\n\tif (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()][0];\n\t\teventname = pagetypemap[_TMDL.pageType.toLowerCase()][1];\n\t}\n\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t  //TODO add name\n\t\titemsArray.push({\'id\' : _TMDL.pidsku[i], \'category\': (typeof _TMDL.dcmcat ==\'object\')?_TMDL.dcmcat[i]:\'\', \'price\' : _TMDL.sales[i], \'name\' : _TMDL.pnames[i]});\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t}\n    \n\tif (~window.location.pathname.indexOf("/b/")) {\n\t\tgoogpagetype="category";\n\t} else if (~window.location.pathname.indexOf("/p/")) {\n\t\tgoogpagetype="product";\n\t}\n    \n\twindow.uetq = window.uetq || [];\n\n\tif (_TMDL.pidsku.length > 0) {\n\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : "";\n\t\ttempobj.ecomm_pagetype = googpagetype;\n\t\t//tempobj.ecomm_items = itemsArray;\n\t\ttempobj.items = itemsArray;\n\t}\n\n\tif (~_TMDL.pageType.indexOf("cart") || ~_TMDL.pageType.indexOf("receipt")) {\n\t\ttempobj.currency = _TMDL.cc;\n\t\ttempobj.revenue_value = totamount;\n\t\ttempobj.transaction_id = _TMDL.purchaseID;\n\t}\n\n\twindow.uetq.push(\'event\',eventname, tempobj); \n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("BINGLPCVF",err.message,imgsrc1);}\n\t_satellite.logger.error("BINGLPCVF");\t\n}\n\n',language:"javascript"}}]},{id:"RLaf9c2d63cc344d11be5e7c911d43efe0",name:"DCMCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:"try\n{\n\tvar doFloodlights = function(debug) {\n\t\t_TMDL.dcmcat = [];\n\n\t\tvar pnames, pids, pidsku, sales, quantities, totqty, totamt;\n\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\t\tvar mc1 = \"\";\n\t\tvar floodlights = {};\n\n\n\t\tvar cartFloodlights = {\n\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=crtv_std\",\n\t\t\t\twindowssoftware : \"/src=8406727;type=wsft;cat=crtv_std\",\n\t\t\t\tothersoftware : \"/src=8406724;type=sftw;cat=crtv_std\",\n\t\t\t\tsurface : \"/src=8400690;type=surf;cat=crtv_std\",\n\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=crtv_std\",\n\t\t\t\txboxgames : \"exclude\",\n\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl;cat=crtv_std\",\n\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg;cat=crtv_std\",\n\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=crtv_std\",\n\t\t\t\thololens : \"/src=8391509;type=hll;cat=crtv_std\",\n\t\t\t\toffice : \"/src=8406097;type=ofco;cat=crtv_std\",\n\t\t\t\tminecraft : \"/src=8400687;type=mc;cat=crtv_std\",\n\t\t\t\tother : \"/src=8406157;type=stoth;cat=crtv_std\",\n\t\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg;cat=crtd_std\",\n\t\t\t\twinsoftdigital : \"/src=8406727;type=wsft;cat=pdv_dgtl\"\n\t\t};\n\n\t\tvar purchaseFloodlights = {\n\t\t\twindowsdevices : \"/src=8406115;type=wndv_sls;cat=pch_phy\",\n\t\t\twindowssoftware : \"/src=8406727;type=wsft_sls;cat=pch_phy\",\n\t\t\tothersoftware : \"/src=8406724;type=sftw_sls;cat=pch_phy\",\n\t\t\tsurface : \"/src=8400690;type=surf_sls;cat=pch_phy\",\n\t\t\txboxplatform : \"/src=8391491;type=xbxp_sls;cat=pch_phy\",\n\t\t\txboxgames : \"exclude\",\n\t\t\txboxdesignlabs : \"/src=8404966;type=xdl_sls;cat=pch_phy\",\n\t\t\txboxgamepass : \"/src=8406391;type=xgpg_sls;cat=pch_phy\",\n\t\t\txboxlive : \"/src=8391497;type=xlg_sale;cat=pch_phy\",\n\t\t\thololens : \"/src=8391509;type=hll_sls;cat=pch_phy\",\n\t\t\toffice : \"/src=8406097;type=ofco_sls;cat=pch_phy\",\n\t\t\tminecraft : \"/src=8400687;type=mc_sls;cat=pch_phy\",\n\t\t\tother : \"/src=8406157;type=stot_sl;cat=pch_phy\",\n\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg_sls;cat=pch_dgtl\",\n\t\t\twinsoftdigital : \"/src=8406727;type=wsft_sls;cat=pch_dgtl\"\n\t\t};\n\t\t\n\t\tvar categoryAmounts = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\t\t\n\t\tvar categoryOrders = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\n\t\tvar pidexclude = {\n\t\t\t\n\t\t};\n\t\tvar skulist = {\n\t\t\t\n\t\t};\n\t\t\n\t\tvar matchWindowBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"acer\",\n\t\t\t\t\"alienware\",\n\t\t\t\t\"asus\",\n\t\t\t\t\"cyberpowerpc\",\n\t\t\t\t\"dell\",\n\t\t\t\t\"hp\",\n\t\t\t\t\"huawei\",\n\t\t\t\t\"ibuypower\",\n\t\t\t\t\"lenovo\",\n\t\t\t\t\"linx\",\n\t\t\t\t\"logah\",\n\t\t\t\t\"millet\",\n\t\t\t\t\"razer\",\n\t\t\t\t\"porsche\",\n\t\t\t\t\"samsung\",\n\t\t\t\t\"toshiba\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\t\n\t\tvar matchXboxBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"forza\",\n\t\t\t\t\"call of duty\",\n\t\t\t\t\"tomb raider\",\n\t\t\t\t\"toy soldiers war chest\",\n\t\t\t\t\"red dead\",\n\t\t\t\t\"halo\",\n\t\t\t\t\"state of decay\",\n\t\t\t\t\"fifa\",\n\t\t\t\t\"sea of thieves\",\n\t\t\t\t\"fallout\",\n\t\t\t\t\"playerunknown\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\t// update pidlist\n\t\tvar pidlist={\n\t\t\t\n\t\t'D76QX4BZNWK4' : 'windowssoftware',\n\t\t'DF77X4D43RKT' : 'windowssoftware',\n\t\t'DG7GMGF0DS12' : 'windowssoftware',\n\t\t'DG7GMGF0DS1H' : 'windowssoftware',\n\t  'DG7GMGF0DT05' : 'windowssoftware',\n\t\t'DG7GMGF0DT06' : 'windowssoftware',\n\t\t\n\t\t'DG7GMGF0DST3' : 'othersoftware',\n\t\t'DG7GMGF0DST4' : 'othersoftware',\n\t\t'DG7GMGF0DST5' : 'othersoftware',\n\t\t'DG7GMGF0DST6' : 'othersoftware',\n\t\t'DG7GMGF0DWP2' : 'othersoftware',  // sql server\n\n\n\t\t'8MB6CR05S1QD' : 'xboxplatform',\n\t  '8W68VXXMN260' : 'xboxplatform', // forza\n\t\t'9NV34NLCLG81' : 'xboxplatform', // forza\n\t\t'8SVG47RPZDDN' : 'xboxplatform', \n\n\t\t'8MC6K8M228SK' : 'surface',\n\t\t'8MCPZJJCC98C' : 'surface',\n\t\t'8N1V4QJ3GQ5X' : 'surface',\n\t\t'8NKT9WTTRBJK' : 'surface',\n\t\t'8RKCLMWPW1PP' : 'surface',\n\t\t'8XCW9BBPVFV9' : 'surface',\n\t\t'907TDS4DGWWV' : 'surface',\n\t\t'90FC23DV6SNZ' : 'surface',\n\t\t'93LTM69S3RFF' : 'surface',\n\n\t\t'8XF18PQZ17TS' : 'hololens',\n\t\t'90MDTZVL02K9' : 'hololens',\n\t\t'944XGCF64Z5B' : 'hololens',\n\t\t\n\t\t'900WZDF9XJVG' : 'xboxdesignlabs',\n\t\t'93JLLWMDZ0V7' : 'xboxdesignlabs',\n\t\t'941H3FP99RM3' : 'xboxdesignlabs',\n\t\t'8TBJW32WJF8C' : 'xboxdesignlabs',\n\t\t'90T6CGN08P38' : 'xboxdesignlabs',\n\t\t'90K4SGTLSKML' : 'xboxdesignlabs',\n\t\t'8VK59S4SSLWD' : 'xboxdesignlabs',\n\t\t'8TVCQSJ7V6PT' : 'xboxdesignlabs',\n\t\t'8T07Q5SRTV11' : 'xboxdesignlabs',\n\t\t'8VKFWF7M03NJ' : 'xboxdesignlabs',\n\t\t'90GBR9CZBHJ9' : 'xboxdesignlabs',\n\t\t'9355VZP4KXB8' : 'xboxdesignlabs',\n\t\t'8QT59S4FDX8Z' : 'xboxdesignlabs',\n\t\t'936X3M90WS2S' : 'xboxdesignlabs', // configs\n\t\t'9102F5Z9J68L' : 'xboxdesignlabs', // configs\n\t\t'8ST76B99KP7D' : 'xboxdesignlabs', // configs\n\t\t'90SX28477R3L' : 'xboxdesignlabs', // configs\n\t\t\n\t\t'CFQ7TTC0K5ZM' : 'xboxlive',\n\t  'CFQ7TTC0K5DJ' : 'xboxlive',\n\t\t\n\t\t'CFQ7TTC0K5F8' : 'office',\n\t\t'CFQ7TTC0K5FD' : 'office',\n\t\t'CFQ7TTC0K5FF' : 'office',\n\t\t'CFQ7TTC0K5BB' : 'office',\n\t\t'CFQ7TTC0K5BC' : 'office',\n\t\t'CFQ7TTC0K5BD' : 'office',\n\t\t'8N0LL43Q1H85' : 'office',\n\t\t'CFQ7TTC0K5DZ' : 'office',\n\t\t'CFQ7TTC0K5F2' : 'office',\n\t\t'CFQ7TTC0K5F3' : 'office',\n\t\t'CFQ7TTC0K5BH' : 'office',\n\t\t'CFQ7TTC0K5D6' : 'office',\n\t\t'CFQ7TTC0K5D7' : 'office',\n\t\t'CFQ7TTC0K5CD' : 'office',\n\t\t'CFQ7TTC0K5CF' : 'office',\n\t\t'CFQ7TTC0K5CP' : 'office',\n\t\t'CFQ7TTC0K5CS' : 'office',\n\t\t'CFQ7TTC0K5CT' : 'office',\n\t\t'CFQ7TTC0K5D0' : 'office',\n\t\t'CFQ7TTC0K5DN' : 'office',\n\t\t'CFQ7TTC0K5DM' : 'office',\n\t\t'CFQ7TTC0K5BF' : 'office',\n\t\t'CFQ7TTC0K5FB' : 'office',\n\t\t'CFQ7TTC0K5FC' : 'office',\n\t\t'CFQ7TTC0K5D2' : 'office',  // project  4/2/18\n\t\t'CFQ7TTC0K5DB' : 'office',  // visio  4/2/18\n\t\t'CFQ7TTC0K5CW' : 'office',  // visio  4/2/18\n\n\t  '8V9DP4LNKNSZ' : 'surface',  // surface go added 7/10/18\n\t  \n\t\t// xbox games  9/27/18\n\t\t'8XMZ4ZZX5JT8' : 'xboxplatform',\n\t\t'8N4KPS2M97J6' : 'xboxplatform',\n\t\t'BTH9X5LM11MV' : 'xboxplatform',\n\t\t'8MSBS8Q55DBG' : 'xboxplatform',\n\t\t'BR8QZQXJVQD0' : 'xboxplatform',\n\n\t\t// 10/8/18\n\t\t'8Z1WM755TWGX' : 'xboxplatform', \n\t\t'C3C71TV51SQC' : 'xboxplatform', \n\t\t'8TSHP571GP11' : 'xboxplatform',\n\t\t'CFQ7TTC0K7Q8' : 'office',  \n\t\t'CFQ7TTC0K7DX' : 'office', \n\t\t'CFQ7TTC0K7C4' : 'office',\n\t\t'CFQ7TTC0K7C6' : 'office',\n\t\t'CFQ7TTC0K7C3' : 'office',\n\t\t'CFQ7TTC0K7C7' : 'office',\n\t\t'DG7GMGF0DW9S' : 'windowssoftware',\n\t\t'DG7GMGF0DS1G' : 'windowssoftware',\n\t\t'CFQ7TTC0K7CJ' : 'othersoftware',\n\t\t'CFQ7TTC0K7CH' : 'othersoftware',\n\t\t'CFQ7TTC0K7CF' : 'othersoftware',\n\t\t\n\t\t// 10/15/18\n\t\t'CFQ7TTC0K7C9': 'office',\n\t\t'CFQ7TTC0K7CG': 'office',\n\t\t'CFQ7TTC0K7CK': 'office',\n\t\t\n\t\t// 11/5/18\n\t\t'BPSWGQBW7R3G': 'xboxplatform', // red dead redemption 2\n\t\t'9NBLGGH4PBBM': 'xboxplatform', // Gears of War 4\n\t\t\n\t\t// 11/9/18\n\t\t'92594H05TKL3': 'xboxplatform', // fortnite bundle\n\t\t'8VDVCNF9F65W': 'xboxplatform', // playerunknowns battleground\n\t\t\n\t\t// 11/23/2018\n\t\t//'C0MN5DN8KR3F': 'xboxplatform', // playerunknowns full release\n\t\t'9PB2MZ1ZMB1S': 'winsoftdigital', // itunes\n\t\t'9WZDNCRFJ3TJ': 'winsoftdigital', // netflix\n\t\t'8NPV33DJ370P': 'xboxdesignlabs',\n\t\t'8Z1WFX3PP9BP': 'xboxdesignlabs',\n\t\t'8TN029PXKRTV': 'xboxdesignlabs',\n\t\t'8TMZXJV9D39G': 'xboxdesignlabs',\n\n\t\t// leave this as last\n\t\t'SHOULDNEVERMATCH' : 'pc'\n\t\t};\n\n\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\n\t\tif (_TMDL.pids) {\n\t\t\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t\t\t\tif (_TMDL.pids && _TMDL.pids[i] && pidexclude[_TMDL.pids[i]]) {\n\t\t\t\t\t// do nothing, not commissionable\n\t\t\t\t\t_TMDL.dcmcat[i]=\"excluded\";\n\t\t\t\t} else if (_TMDL.pidsku && _TMDL.pidsku[i] && skulist[_TMDL.pidsku[i]]) {\n\t\t\t\t\t// sku lookup based eventID\n\t\t\t\t\t_TMDL.dcmcat[i]=skulist[_TMDL.pidsku[i]];\n\t\t\t\t\tcategoryOrders[skulist[_TMDL.pidsku[i]]]++;\n\t\t\t\t\tcategoryAmounts[skulist[_TMDL.pidsku[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pids && _TMDL.pids[i] && pidlist[_TMDL.pids[i]]) {\n\t\t\t\t\t_TMDL.dcmcat[i]=pidlist[_TMDL.pids[i]];\n\t\t\t\t\tcategoryOrders[pidlist[_TMDL.pids[i]]]++;\n\t\t\t\t\tcategoryAmounts[pidlist[_TMDL.pids[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"surface\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"surface\";\n\t\t\t\t\tcategoryOrders[\"surface\"]++;\n\t\t\t\t\tcategoryAmounts[\"surface\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf(\"office\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"o365\"))) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"office\";\n\t\t\t\t\tcategoryOrders[\"office\"]++;\n\t\t\t\t\tcategoryAmounts[\"office\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"minecraft\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"minecraft\";\n\t\t\t\t\tcategoryOrders[\"minecraft\"]++;\n\t\t\t\t\tcategoryAmounts[\"minecraft\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\")) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchXboxBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchWindowBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"windowsdevices\";\n\t\t\t\t\tcategoryOrders[\"windowsdevices\"]++;\n\t\t\t\t\tcategoryAmounts[\"windowsdevices\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && ~_TMDL.prdType[i].toLowerCase().indexOf(\"game\") && (~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\") || matchXboxBrand(_TMDL.pnames[i]) || _TMDL.sales[i]>0)) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxdigitalgames\";\n\t\t\t\t\tcategoryOrders[\"xboxdigitalgames\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxdigitalgames\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && _TMDL.prdType[i].toLowerCase().indexOf(\"device\")<0 && _TMDL.prdType[i].toLowerCase().indexOf(\"pass\")<0) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"winsoftdigital\";\n\t\t\t\t\tcategoryOrders[\"winsoftdigital\"]++;\n\t\t\t\t\tcategoryAmounts[\"winsoftdigital\"]+=_TMDL.sales[i];\n\t\t\t\t} else {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"other\";\n\t\t\t\t\tcategoryOrders[\"other\"]++;\n\t\t\t\t\tcategoryAmounts[\"other\"]+=_TMDL.sales[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\ttry {\n\t\t\tif (_TMutils.readCookie(\"MC1\")) {\n\t\t\t\tmc1 = _TMutils.readCookie(\"MC1\").split(\"&\")[0].split(\"=\")[1]; //use in u58\n\t\t\t}\n\t\t} catch(mc1err) {}\t\n\n\t\t// set the floodlights based on the page\n\t\tif (_TMDL.pageType==\"receipt\" || _TMDL.pageType==\"congrats\") {\n\t\t\tfloodlights = purchaseFloodlights;\n\t\t} else if (~_TMDL.pageType.indexOf(\"cart\")) {\n\t\t\tfloodlights = cartFloodlights;\n\t\t}\n\t\t\n\t\t// iterate through line items\n\t\tfor (key in categoryOrders) {\n\t\t\tif (categoryOrders[key]>0 && floodlights[key] !== \"exclude\") {\t\t\n\t\t\t\tpnames=[]; pids=[]; pidsku=[]; sales=[]; quantities=[]; totqty=0; totamt=0;\n\t\t\t\tconsole.log(key,categoryOrders[key],categoryAmounts[key],\"\\n\"); // make sure formatted as xx.xx\n\n\t\t\t\tfor (var line=0; line < _TMDL.pids.length; line++) {\n\t\t\t\t\tif (_TMDL.dcmcat[line] == key) {\t\n\t\t\t\t\t\tpnames.push(_TMDL.pnames[line]);\n\t\t\t\t\t\tpids.push(_TMDL.pids[line]);\n\t\t\t\t\t\tpidsku.push(_TMDL.pidsku[line]);\n\t\t\t\t\t\tsales.push(_TMDL.sales[line]);\n\t\t\t\t\t\tquantities.push(_TMDL.quantities[line]);\n\t\t\t\t\t\ttotqty+=_TMDL.quantities[line];\n\t\t\t\t\t\ttotamt+=_TMDL.sales[line];\t\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity\"+floodlights[key]+\";qty=1;cost=\"+totamt+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t//+\";u5=\"+encodeURIComponent(document.referrer)\n\t\t\t\t\t+\";u25=\"+pids.join(\"_\")\n\t\t\t\t\t+\";u26=\"+encodeURIComponent(pnames.join(\"_\"))\n\t\t\t\t\t+\";u58=\"+mc1\n\t\t\t\t\t+\";u31=\"+_TMDL.cc+\";u32=\"+pids.join(\"_\")+\";u33=\"+pidsku.join(\"_\")+\";u34=\"+_TMDL.purchaseID+\";u35=\"+totqty\n\t\t\t\t\t+\";u39=\"+sales.join(\"_\")+\";u40=\"+quantities.join(\"_\")\n\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+_TMDL.purchaseID+\"?\";\n\t\t\t\timgsrc = imgsrc1;\n\t\t\t\tif (debug) {\n\t\t\t\t\tconsole.log(key,pnames.join(\"_\"),\"\\n\");\n\t\t\t\t\tconsole.log(imgsrc1,\"\\n\");\n\t\t\t\t} \n\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t}\n\t\t}\n\n\t};\n\n\tdoFloodlights(0);var imgsrc=\"\";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"DCM Cart and Purchase\",err.message,imgsrc);}\n\t_satellite.logger.error(\"DCM Cart and Purchase\");\n}\n",language:"javascript"}}]},{id:"RL00f45d772a4047669905d2c1257f796b",name:"DCMLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n\tvar doFloodlights = function(debug) {\n\t\ttry {\n\t\t\t_TMDL.dcmcat = [];\n\n\t\t\tvar imgsrc1,imgsrc2,imgsrc3,imgscr4;\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\t\t\tvar mc1 = "";\n\t\t\tvar pth = window.location.pathname.toLowerCase();\n\t\t\tvar pthmatch;\n\t\t\t\n\t\t\t// office and surface don\'t have the same structure for "cat" parameter\n\t\t\tvar landingpageCountFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_std",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_std",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_std",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_phy",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_std",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_std",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lpst_std",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "/src=8406157;type=stoth;cat=phy_std"\t\n\t\t\t};\n\n\t\t\tvar genericLandingpageFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=lp_std",\n\t\t\t\t\twindowssoftware : "exclude",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_std",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=lp_std",\n\t\t\t\t\txboxgames : "/src=8406391;type=xbxgms;cat=lp_std",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=lp_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=gplp_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=lp_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=lp_std",\n\t\t\t\t\toffice : "exclude",  // nonstandard\n\t\t\t\t\tminecraft : "/src=8400687;type=mc;cat=lp_std",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\t\t\t\n\t\t\tvar landingpageUniqueFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_uni",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_uni",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_uni",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_uni",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_uni",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_uni",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_uni",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_uni",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_uni",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lp_uni",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\t// only windowssoftware has a PrdCatVue tag (WindowsSoftware_GBL_PrdCatVue_Count_PhysicalStore)\n\t\t\tvar categoryFloodlights = {\n\t\t\t\t\twindowsdevices : "exclude",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=pdcv_phy",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "exclude",\n\t\t\t\t\txboxplatform : "exclude",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "exclude",\n\t\t\t\t\txboxgamepass : "exclude",\n\t\t\t\t\txboxlive : "exclude",\n\t\t\t\t\thololens : "exclude",\n\t\t\t\t\toffice : "exclude",\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\tvar pdpFloodlights = {\n\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=prdv_std",  // nonstandard\n\t\t\t\twindowssoftware : "/src=8406727;type=wsft_sls;cat=pdv_phy",\n\t\t\t\tothersoftware : "/src=8406724;type=sftw_sls;cat=pdv_phy",\n\t\t\t\tsurface : "/src=8400690;type=surf;cat=prdv_std",  // nonstandard\n\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=pdv_phy",\n\t\t\t\txboxgames : "xboxgames",\n\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl_sls;cat=pdv_phy",\n\t\t\t\txboxgamepass : "/src=8406391;type=xgpg_sls;cat=pdv_phy",\n\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=pdv_phy",\n\t\t\t\thololens : "/src=8391509;type=hll;cat=pdv_phy",\n\t\t\t\toffice : "/src=8406097;type=ofco;cat=prdv_std",  // nonstandard\n\t\t\t\tminecraft : "exclude",\n\t\t\t\tother : "exclude"\n\t\t\t};\n\t\t\t\n\t\t\tvar categoryCounts = {\n\t\t\t\twindowsdevices : 0,\n\t\t\t\twindowssoftware : 0,\n\t\t\t\tothersoftware : 0,\n\t\t\t\tsurface : 0,\n\t\t\t\txboxplatform : 0,\n\t\t\t\txboxgames : 0,\n\t\t\t\txboxdesignlabs : 0,\n\t\t\t\txboxgamepass : 0,\n\t\t\t\txboxlive : 0,\n\t\t\t\thololens : 0,\n\t\t\t\toffice : 0,\n\t\t\t\tminecraft : 0,\n\t\t\t\tother : 0\n\t\t\t};\n\t\t\t\n\t\t\tvar matchWindowBrand = function(pname) {\n\t\t\t\tvar brandnames = [\n\t\t\t\t\t["acer","windowsdevices"],\n\t\t\t\t\t["alienware","windowsdevices"],\n\t\t\t\t\t["asus","windowsdevices"],\n\t\t\t\t\t["cyberpowerpc","windowsdevices"],\n\t\t\t\t\t["dell","windowsdevices"],\n\t\t\t\t\t["hp","windowsdevices"],\n\t\t\t\t\t["huawei","windowsdevices"],\n\t\t\t\t\t["ibuypower","windowsdevices"],\n\t\t\t\t\t["lenovo","windowsdevices"],\n\t\t\t\t\t["linx","windowsdevices"],\n\t\t\t\t\t["logah","windowsdevices"],\n\t\t\t\t\t["millet","windowsdevices"],\n\t\t\t\t\t["porsche","windowsdevices"],\n\t\t\t\t\t["razer","windowsdevices"],\n\t\t\t\t\t["samsung","windowsdevices"],\n\t\t\t\t\t["toshiba","windowsdevices"],\n\t\t\t\t\t["/collections/laptops","windowsdevices"],\n\t\t\t\t\t["/store/b/pc","windowsdevices"],\t\t\n\t\t\t\t\t["/store/b/pc","windowsdevices"]\t\t\n\t\t\t\t];\n\t\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i][0])) {\n\t\t\t\t\t\tif (debug) { console.log("matched windows brand");}\n\t\t\t\t\t\treturn brandnames[i][1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\t// update pidlist\n\t\t\tvar pidlist={\n\t\t\t\t\n\t\t\t\'D76QX4BZNWK4\' : \'windowssoftware\',\n\t\t\t\'DF77X4D43RKT\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS12\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS1H\' : \'windowssoftware\',\n\t\t\t\n\t\t\t\'DG7GMGF0DST3\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST4\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST5\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST6\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DWP2\' : \'othersoftware\',  \n\n\n\t\t\t\'8MB6CR05S1QD\' : \'xboxplatform\',\n\n\t\t\t\'8MC6K8M228SK\' : \'surface\',\n\t\t\t\'8MCPZJJCC98C\' : \'surface\',\n\t\t\t\'8N1V4QJ3GQ5X\' : \'surface\',\n\t\t\t\'8NKT9WTTRBJK\' : \'surface\',\n\t\t\t\'8RKCLMWPW1PP\' : \'surface\',\n\t\t\t\'8XCW9BBPVFV9\' : \'surface\',\n\t\t\t\'907TDS4DGWWV\' : \'surface\',\n\t\t\t\'90FC23DV6SNZ\' : \'surface\',\n\t\t\t\'93LTM69S3RFF\' : \'surface\',\n\n\t\t\t\'8XF18PQZ17TS\' : \'hololens\',\n\t\t\t\'90MDTZVL02K9\' : \'hololens\',\n\t\t\t\'944XGCF64Z5B\' : \'hololens\',\n\t\t\t\n\t\t\t\'900WZDF9XJVG\' : \'xboxdesignlabs\',\n\t\t\t\'93JLLWMDZ0V7\' : \'xboxdesignlabs\',\n\t\t\t\'941H3FP99RM3\' : \'xboxdesignlabs\',\n\t\t\t\'8TBJW32WJF8C\' : \'xboxdesignlabs\',\n\t\t\t\'90T6CGN08P38\' : \'xboxdesignlabs\',\n\t\t\t\'90K4SGTLSKML\' : \'xboxdesignlabs\',\n\t\t\t\'8VK59S4SSLWD\' : \'xboxdesignlabs\',\n\t\t\t\'8TVCQSJ7V6PT\' : \'xboxdesignlabs\',\n\t\t\t\'8T07Q5SRTV11\' : \'xboxdesignlabs\',\n\t\t\t\'8VKFWF7M03NJ\' : \'xboxdesignlabs\',\n\t\t\t\'90GBR9CZBHJ9\' : \'xboxdesignlabs\',\n\t\t\t\'9355VZP4KXB8\' : \'xboxdesignlabs\',\n\t\t\t\'8QT59S4FDX8Z\' : \'xboxdesignlabs\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5ZM\' : \'xboxlive\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5F8\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BC\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BD\' : \'office\',\n\t\t\t\'8N0LL43Q1H85\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DZ\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F2\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F3\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BH\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D6\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D7\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CP\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CS\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CT\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D0\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DN\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DM\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FC\' : \'office\',\n\t\t\t\n\n\t\t\t\'BPSWGQBW7R3G\': \'xboxplatform\',\n\t\t\t\'9NBLGGH4PBBM\': \'xboxplatform\', \n\n\n\t\t\t\'SHOULDNEVERMATCH\' : \'pc\'\n\t\t\t};\n\n\t\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\t\n\t\t\tif ((~pth.indexOf("/d/") || ~pth.indexOf("/p/")) && _TMDL.pids && pidlist[_TMDL.pids[0]]) {\n\t\t\t\t// check pids for anything explicitly mapped\n\t\t\t\tcategoryCounts[pidlist[_TMDL.pids[0]]]++;\n\t\t\t\tif (debug) { console.log("matched PID", _TMDL.pids[0], pidlist[_TMDL.pids[0]]); }\n\t\t\t} else if (~pth.indexOf("surface") ) {\n\t\t\t\tcategoryCounts["surface"]++;\n\t\t\t} else if (~pth.indexOf("office") || ~pth.indexOf("o365")) {\n\t\t\t\tcategoryCounts["office"]++;\n\t\t\t} else if (~pth.indexOf("minecraft") ) {\n\t\t\t\tcategoryCounts["minecraft"]++;\n\t\t\t} else if (~pth.indexOf("xbox") ) {\n\t\t\t\tcategoryCounts["xboxplatform"]++;\n\t\t\t} else if (~pth.indexOf("hololens") ) {\n\t\t\t\tcategoryCounts["hololens"]++;\n\t\t\t} else {\n\t\t\t\tpthmatch = matchWindowBrand(pth);\n\t\t\t\tif (pthmatch) {\n\t\t\t\t\tcategoryCounts[pthmatch]++;\n\t\t\t\t} else {\n\t\t\t\t\t// TODO:  check if physical\n\t\t\t\t\tcategoryCounts["other"]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (_TMutils.readCookie("MC1")) {\n\t\t\t\t\tmc1 = _TMutils.readCookie("MC1").split("&")[0].split("=")[1]; //use in u58\n\t\t\t\t}\n\t\t\t} catch(mc1err) {}\t\n\n\n\t\t\t/* set the floodlights based on the page */\n\t\t\tif (_TMDL.pageType=="receipt" || _TMDL.pageType=="congrats") {\n\t\t\t\tfloodlights = purchaseFloodlights;\n\t\t\t} else if (~_TMDL.pageType.indexOf("cart")) {\n\t\t\t\tfloodlights = cartFloodlights;\n\t\t\t}\n\t\t\t\n\t\t\tif(debug) {\tconsole.log(categoryCounts); }\n\n\t\t\tfor (key in categoryCounts) {\n\n\t\t\t\tif (categoryCounts[key]>0) {\t\t\n\t\t\t\t\tif (debug) {console.log(key,categoryCounts[key],landingpageUniqueFloodlights[key],"\\n");}\n\t\t\t\t\n\t\t\t\t\t// Activity Name: Store_AllProd_GBL_LandingPageVue_Unique_\n\t\t\t\t\tif (landingpageUniqueFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+landingpageUniqueFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\n\t\t\t\t\t/* Activity name of this tag: Store_AllProd_GBL_LandingPageVue_Count_  */\n\t\t\t\t\tif (landingpageCountFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc2 = "https://ad.doubleclick.net/ddm/activity"+landingpageCountFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc2;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc2); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc2);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t/*  genericLandingpageFloodlights  */\n\t\t\t\t\tif (genericLandingpageFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+genericLandingpageFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (_TMDL.pageType=="detail" && (~_TMDL.prdType[0].toLowerCase().indexOf("device") || ~_TMDL.prdType[0].toLowerCase().indexOf("pass"))) {\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (pdpFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\t// Store_AllProd_GBL_PrdVue_Count_PhysicalStore\n\t\t\t\t\t\t\timgsrc3 = "https://ad.doubleclick.net/ddm/activity"+pdpFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames)+";u32="+_TMDL.pids+";u33="+_TMDL.pidsku+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a;\n\t\t\t\t\t\t\timgsrc = imgsrc3;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc3);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (~_TMDL.pageType.toLowerCase().indexOf("category") && ~window.location.pathname.indexOf("/b/")){\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (categoryFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\timgsrc4 = "https://ad.doubleclick.net/ddm/activity"+categoryFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\t\t\t\t\t\timgsrc = imgsrc4;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc4);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (debug) { console.log(_TMDL.dcmcat) ; }\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t} catch(flerr) {\n\t\t\t_TMutils.logRuleCall("DCMLP err",flerr.name,flerr.message);\n\t\t}\n\n\t};\n\n\n\tvar pth = window.location.pathname.toLowerCase();\n\tvar debug = ~window.location.href.indexOf("debug") ? 1 : 0;\n\n\n\n\t// -----------------------------------------\n\t//   previously separate digital pages tags\n\t// -----------------------------------------\n\n\tvar _getMetaValue = function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t};\n\t\t\n\tvar fireDCM = function(params) {\n\t\tvar a, imgsrc1, imgsrc2;\n\t\ta = "" + (Math.random() * 10000000000000);\n\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity/"+params+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t+";u20="+_TMDL.pidsku\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\timgsrc = imgsrc1;\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\tif (debug) {console.log(params);}\n\t};\n\n\tvar matchXboxBrand = function(pname) {\n\t\tvar brandnames = [\n\t\t\t"forza",\n\t\t\t"call of duty",\n\t\t\t"tomb raider",\n\t\t\t"toy soldiers war chest",\n\t\t\t"red dead"\n\t\t\t];\n\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar pdpname = (_TMDL.pnames.length>0 && ~_TMDL.pnames[0]) ? _TMDL.pnames[0].toLowerCase() : "";\n\tvar isPhysicalPage = (~pth.indexOf("/store/") && pth.indexOf("/p/")<0) || (~pth.indexOf("/p/") && _TMDL.prdType[0]!=="Apps" && _TMDL.prdType[0]!=="Games");\n\tvar\ta = "" + (Math.random() * 10000000000000);\n\tvar configdeviceurl="",buildyourbundleurl="";\n\tvar imgsrc="";\n\t\n\tif (isPhysicalPage) {doFloodlights(debug);}\n\n\tif (_TMDL.prdType=="Games" || _TMDL.prdType=="Passes" || _TMDL.prdType=="Apps") {\n\t\tif ( ~pth.indexOf("cfq7ttc0k5zm") || ~pth.indexOf("cfq7ttc0k5dj")) {\n\t\t\t// XboxLiveGold_GBL_PrdVue_Count_DigitalStore:  /src=8391497;type=xlg;cat=pdv_dgtl;\n\t\t\tfireDCM("src=8391497;type=xlg;cat=pdv_dgtl");  \n\t\t\t$(document).on(\'mousedown\',\'button#buttons_AddToCartButton, button[id*="BuyButton"], button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart");  // XboxLiveGold_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8391497;type=xlg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (\t( _TMDL.prdType=="Games" && (_getMetaValue("ms\\\\.prod_worksonxbox")=="true" || matchXboxBrand(pdpname))) || (pth.indexOf("xbox") > -1) || ~pdpname.indexOf("xbox") ) {\n\t\t\t//XboxGamePassGames_GBL_PrdVue_Count_DigitalStore:  /src=8406391;type=xgpg;cat=pdv_dgtl;\n\t\t\t//console.log("XboxGamePassGames_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406391;type=xgpg;cat=pdv_dgtl");\n\t\t\t$(document).on(\'mousedown\',\'button#buttons_AddToCartButton, button[id*="BuyButton"], button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //XboxGamePassGames_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406391;type=xgpg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (_TMDL.prdType=="Apps" || _TMDL.prdType=="Games") {\n\t\t\t//WindowsSoftware_GBL_PrdVue_Count_DigitalStore\n\t\t\t//console.log("WindowsSoftware_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406727;type=wsft;cat=pdv_dgtl");\n\t\t\t$(document).on(\'mousedown\',\'button#buttons_AddToCartButton, button[id*="BuyButton"], button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //WindowsSoftware_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406727;type=wsft;cat=crtd_std");\n\t\t\t});\n\t\t}\n\t}\n\n\n\t// Surface Configure Device tag as Surface Learn More  (request from Ahmed Homsi)\n\tif (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/p/")) {\n\n\t\tconfigdeviceurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n\t\t\t+";u25="+_TMDL.pids[0]\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+";u50=Configure%20now"\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\t\timgsrc = configdeviceurl;\n\n\t\t// Configure Now CTA\n\t\t$(document).on(\'mousedown\',\'button[id*="ConfigureDeviceButton"]\',\'\', function() {\n\t\t\tBootstrapper.imageRequest(configdeviceurl);\n\t\t});\n      \n      \tbuildyourbundleurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n    \t\t+_TMDL.geo\n    \t\t+";u2="+_TMDL.ll\n    \t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n    \t\t+";u25="+_TMDL.pids[0]\n    \t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n    \t\t+";u50=BuildYourBundle"\n    \t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\n    \t// BuildYourBundle CTA\n    \t$(document).on(\'mousedown\',\'button[id*="buttons_BuildABundleButton"]\',\'\', function() {\n    \t\tBootstrapper.imageRequest(buildyourbundleurl);\n    \t});\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("DCM LP",err.message,imgsrc);}\n\t_satellite.logger.error("DCM LP");\n}',language:"javascript"}}]},{id:"RLe4bf46206262423ba08c5a33f2719bc9",name:"DIGSHELL",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"\\/p\\/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\twindow.shell_Tracking = {\n\n\t\t_init: function () {\n\t\t\tshell_Tracking.hostname = window.location.hostname.replace(/\\.microsoft\\.com$/i, \'\');\n\t\t\tshell_Tracking.URI = window.location.pathname.toString();\n\t\t\t//setup page path dimensions\n\t\t\tshell_Tracking._getPath();\n\t\t},\n\n\t\t_getIsProd: function () {\n\t\t\tvar env = \'test\';\n\t\t\tif (shell_Tracking.hostname.match(/\\./g)) {\n\t\t\t\tenv = \'test\';\n\t\t\t\tshell_Tracking.env = \'test\';\n\t\t\t} else if (window.location.hostname.match(/\\.microsoft\\.com$/i)) {\n\t\t\t\tenv = \'\';\n\t\t\t\tshell_Tracking.env = \'prod\';\n\t\t\t\tshell_Tracking.hostname = \'onestore\';\n\t\t\t}\n\t\t\treturn env;\n\t\t},\n\n\t\t_getLocale: function () {\n\t\t\tshell_Tracking.locale = shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\tvar locale = shell_Tracking.locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t\treturn locale;\n\t\t},\n\n\t\t_removeLocale: function () {\n\t\t\tvar path = shell_Tracking.URI.replace(/^\\/..\\-..\\/?(.*)/i, \'$1\').toLowerCase();\n\t\t\treturn path;\n\t\t},\n\n\t\t_getPath: function () {\n\t\t\tvar path = shell_Tracking._removeLocale();\n\t\t\tpath = path.replace(/\\/$/, \'\').replace(/^\\//, \'\');\n\t\t\tshell_Tracking.path = path;\n\t\t},\n\n\t\t_onBeforePageView: function () {\n\t\t\t/*\n\t\t\tvar authCookie = shell_Tracking._getCookie(\'StoreMsaUser\');\n\t\t\tif (authCookie) {\n\t\t\t\tshell_Tracking.auth = \'y\';\n\t\t\t} else {\n\t\t\t\tshell_Tracking.auth = \'n\';\n\t\t\t}\n\t\t\t*/\n\t\t},\n\n\t\t_getCookie: function (name) {\n\t\t\tvar nameEQ = name + "=";\n\t\t\tvar ca = document.cookie.split(\';\');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == \' \') { c = c.substring(1, c.length); }\n\t\t\t\tif (c.indexOf(nameEQ) == 0) { return unescape(c.substring(nameEQ.length, c.length)); }\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\t_getMetaValue: function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t},\n\n\t\t_recordXboxDigitalPurchase: function (data) {\n\t\t\tvar worksonxbox = (shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox") || (window.location.pathname.indexOf("xbox") > -1)) ? true : false;\n\t\t\tvar pass_type = shell_Tracking._getMetaValue("ms\\\\.prod_pass_type");\n\t\t\tvar productFamily = shell_Tracking._getMetaValue("ms\\\\.prod_family");\n\t\t\tvar lcpath = window.location.pathname.toLowerCase();\n\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   \n\t\t\t// original floodlight\n\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=6952136;type=store00;cat=store00");  // added 6/26/17 -- keep as the generic version\n\n\t\t\t\n\t\t\t//xbox live gold : \n\t\t\t\t// \tCFQ7TTC0K5ZM -- physical\n\t\t\t\t// \tcfq7ttc0k5dj -- digital\n\t\t\t\t//   /src=8391497;type=xlg_sale;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t// games and gamepass:  //src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\n\n\n\t\t\tif (~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5zm") || ~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5dj")) {\n\t\t\t\t// XboxLiveGold_GBL_PchComplete_Transaction_DigitalStore:  src=8391497;type=xlg_sale;cat=pch_dgtl\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8391497;type=xlg_sale;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else if (~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k6l8") || (productFamily && productFamily.toLowerCase() == \'passes\' && pass_type && pass_type.toLowerCase() == \'xbox\') || (productFamily.toLowerCase() == \'games\' && (worksonxbox || ~lcpath.indexOf("xbox") || ~lcpath.indexOf("9n4km90ctzt6")) )) {\n\t\t\t\t//9n4km90ctzt6 is minecraft\n\t\t\t\t//XboxGamePassGames_GBL_PchComplete_Transaction_DigitalStore\t/src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg_sls;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:  src=8406157;type=stot_sl;cat=pch_dgtl\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:   src=8406727;type=wsft_sls;cat=pch_dgtl;  (CORRECT ONE)\n\t\t\t\t//Store-Other_GBL_PchComplete_Transaction_DigitalStore:  src=8406391;type=xgpg;cat=pdv_dgtl\n\t\t\t\t\n\t\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg;cat=pdv_dgtl");\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406727;type=wsft_sls;cat=pch_dgtl;");\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (typeof _TMDL.convcallbacks!==\'undefined\') {\n\t\t\t\t\tfor (var i=0; i< _TMDL.convcallbacks.length; i++) {\n\t\t\t\t\t\t_TMDL.convcallbacks[i](data,price,tax,data.orderId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch(callbackerr) {}\n\t\t\t\n\t\t},\n\t\t_dispatchDCMpurchase: function(worksonxbox,pass_type,productFamily,data,floodlightparams) {\n\t\t\t// added 6/26/17 -- this will be the older tag from before the DCM restructure\n\t\t\tvar a = "" + parseInt(1E5 * 1E4 * Math.random() * Math.random(),10)+ parseInt((Math.random() * 100000000),10);\n\t\t\t//var shell_locale = shell_Tracking.locale || shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\t//var geo = shell_locale.split("-")[1];\n\t\t   //var locale = shell_locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t   var title = data.lineItems[0].title;\n\t\t   var productType = data.lineItems[0].productType;\n\t\t   var productId = data.lineItems[0].productId;\n\t\t   var availabilityId = data.lineItems[0].availabilityId;\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   var currencyCode = data.lineItems[0].currencyCode;\n\t\t   //var paymentTypeEvent = \'\';\n\t\t\tvar url = "https://ad.doubleclick.net/ddm/activity/"+floodlightparams+";qty=1;cost="+price+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t //+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t //+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t +";u25="+productId\n\t\t\t\t +";u26="+encodeURIComponent(title)\n\t\t\t +";u30="+productType\n\t\t\t +";u31="+currencyCode\n\t\t\t +";u32="+productId\n\t\t\t +";u33="+productId\n\t\t\t +";u34="+data.orderId\n\t\t\t //+";u35="+_TMDL.totqty\n\t\t\t +";u35=1"\n\t\t\t +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+data.orderId;\n\n\t\t var px = new Image(1, 1);\n\t\t px.src = url;\n\t  },\n\t\t\n\t\t_dispatchGamePassGamesRT: function () {\n\t\t\tvar url = "https://www.facebook.com/tr?id=1218689904914212&ev=PageView&noscript=1";\n\t\t\tvar px = new Image(1, 1);\n\t\t\tpx.src = url;\n\t\t\tBootstrapper.imageRequest("https://googleads.g.doubleclick.net/pagead/viewthroughconversion/968413686/?value=0&guid=ON&script=0");\n\t\t\tBootstrapper.imageRequest("https://bat.bing.com/action/0?ti=4000034&Ver=2");\n\t\t},\n\n\t};\n\t\n\tvar url="";\n\tvar worksonxbox = shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox")=="true" || (window.location.pathname.toLowerCase().indexOf("xbox") > -1) || (_TMDL.pnames[0].toLowerCase().indexOf("xbox")>-1);\n\tvar type = $(\'meta[name="ms\\\\.prod_type"]\').attr(\'content\');\n\tvar pass_type = $(\'meta[name="ms\\\\.prod_pass_type"]\').attr(\'content\') || \'\';\n\tif (worksonxbox && type && (type.toLowerCase() == \'games\' || type.toLowerCase() == \'addons\') || (window.location.pathname.match(/\\/xbox$/i)) || (pass_type && pass_type.toLowerCase() == \'xbox\')) {\n\n\t\tshell_Tracking._init();\n\n\t\trequire([\'jquery\'], function ($) {\n\t\t\t$(\'document\').ready(function () {\n\t\t\t\ttry {\n\t\t\t\t\t//shell_Tracking._onBeforePageView();\n\t\t\t\t\t//shell_Tracking._recordOmniturePageView();\n\t\t\t\t\t//shell_Tracking._initClickTracking();\n\t\t\t\t} catch (ex) { }\n\t\t\t});\n\t\t});\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("DIGSHELL",err.message,url);}\n\t_satellite.logger.error("DIGSHELL");\t\n}\n\n',language:"javascript"}}]},{id:"RL0bcfb7ed292f400495880750aaae4dbc",name:"ENSSHIM",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-90}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,
source:'if (typeof Bootstrapper !== \'object\') {\n\twindow.Bootstrapper = {};\n\tBootstrapper.imageRequest = function(a) {var c=new Image(0,0);c.src=a;return c};\n\tBootstrapper.insertScript = function(a, c, d, h) {\n                var p = document.getElementsByTagName("script"), g;\n                h = void 0 !== h ? h : !0;\n                if (void 0 !== c ? c : 1)\n                    for (g = 0; g < p.length; g++)\n                        if (p[g].src === a && p[g].readyState && /loaded|complete/.test(p[g].readyState))\n                            return;\n                if (d) {\n                    d = 1 == d && "object" == typeof b.scDataObj ? b.scDataObj : d;\n                    e.rand = Math.random() * ("1E" + (10 * Math.random()).toFixed(0));\n                    c = window.location.href;\n                    "object" === typeof d && d.PageID && (c = d.PageID,\n                    delete d.PageID);\n                    if ("object" === typeof d)\n                        for (g in d) {\n                            g = ~c.indexOf("#") ? c.slice(c.indexOf("#"), c.length) : "";\n                            c = c.slice(0, g.length ? c.length - g.length : c.length);\n                            c += ~c.indexOf("?") ? "&" : "?";\n                            for (k in d)\n                                c += k + "=" + d[k] + "&";\n                            c = c.slice(0, -1) + g;\n                            break\n                        }\n                    a += "?";\n                    h && (a += "r=" + e.rand + "&");\n                    a += "ClientID=" + encodeURIComponent(e.options.clientId) + "&PageID=" + encodeURIComponent(c)\n                }\n                (function(a, c, b) {\n                    var d = c.head || c.getElementsByTagName("head");\n                    setTimeout(function() {\n                        if ("item"in d) {\n                            if (!d[0]) {\n                                setTimeout(arguments.callee, 25);\n                                return\n                            }\n                            d = d[0]\n                        }\n                        var a = c.createElement("script");\n                        a.src = b;\n                        a.onload = a.onerror = function() {\n                            this.addEventListener && (this.readyState = "loaded")\n                        }\n                        ;\n                        d.insertBefore(a, d.firstChild)\n                    }, 0)\n                }\n                )(window, document, a)\n            }\n            ;\n            Bootstrapper.loadScriptCallback = function(a, c, b) {\n                var d = document.getElementsByTagName("script"), e;\n                b = d[0];\n                for (e = 0; e < d.length; e++)\n                    if (d[e].src === a && d[e].readyState && /loaded|complete/.test(d[e].readyState))\n                        try {\n                            c()\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        } finally {\n                            return\n                        }\n                d = document.createElement("script");\n                d.type = "text/javascript";\n                d.async = !0;\n                d.src = a;\n                d.onerror = function() {\n                    this.addEventListener && (this.readyState = "loaded")\n                }\n                ;\n                d.onload = d.onreadystatechange = function() {\n                    if (!this.readyState || "complete" === this.readyState || "loaded" === this.readyState) {\n                        this.onload = this.onreadystatechange = null;\n                        this.addEventListener && (this.readyState = "loaded");\n                        try {\n                            c.call(this)\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        }\n                    }\n                }\n                ;\n                b.parentNode.insertBefore(d, b)\n            }\n            ;\n}\n\n\nwindow._TMutils = {\n\tgetQueryParam : function (p,url) {\n\t\t\t//var url = window.location.search,\n\t\t\tvar match;\n\t\t\tif (window.location.href.indexOf("#") !== -1) {\n\t\t\t\turl += "&" + window.location.href.split("#")[1]\n\t\t\t}\n\t\t\tmatch = new RegExp("[?&]" + p + "=([^&]*)", "i").exec(url);\n\t\t\treturn match ? IRF.util.safeDecodeURIComponent(match[1].replace(/\\+/g, " ")) : null\n\t},\n  readCookie : function(name) {\n\t\tvar nameEQ = name + "=";\n\t\tvar ca = document.cookie.split(\';\');\n\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\tvar c = ca[i];\n\t\t\twhile (c.charAt(0)==\' \') c = c.substring(1,c.length);\n\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t}\n\t\treturn null;\n\t},\n\tcreateCookie : function(name,value,days) {\n\t\tvar expires = "";\n\t\tvar date;\n\t\tvar domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n\t\tif (days) {\n\t\t\tdate = new Date();\n\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\texpires = "; expires="+date.toGMTString();\n\t\t}\n\t\tdocument.cookie = name+"="+value+expires+domainstr;\n\t},\n\tsafeDecodeURIComponent : function (s) {\n\t\tif (s) {\n\t\t\ts = s.replace(/%([EF][0-9A-F])%([89AB][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2, hex3) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 224;\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\tif (n1 == 0 && n2 < 32) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n3 = parseInt(hex3, 16) - 128;\n\t\t\t\t\tvar n = (n1 << 12) + (n2 << 6) + n3;\n\t\t\t\t\tif (n > 65535) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\treturn String.fromCharCode(n)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([CD][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 192;\n\t\t\t\t\tif (n1 < 2) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\treturn String.fromCharCode((n1 << 6) + n2)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([0-7][0-9A-F])/gi, function (code, hex) {\n\t\t\t\t\treturn String.fromCharCode(parseInt(hex, 16))\n\t\t\t\t});\n\t\t\ts = s.replace("+", " ")\n\t\t}\n\t\treturn s\n\t},\n\tlogRuleCall : function (ruleName,debugParams,imageURL) {\n\t\tvar pType = "other";var market = "en-us";var cookieMSFPC = "msfpc";\n\t\tvar ff2,ff3,ff4,ff5,ff6;ff2=ff3=ff4=ff5=ff6="";\n\t\tvar jsDomain = encodeURIComponent(window.location.hostname.toLowerCase());\n        if (typeof _TMDL == "object") {pType = _TMDL.pageType;market = _TMDL.ll;}\n        function impGuid() {var result,i,j;result="";\n            for (j = 0; j < 32; j++) {if (j == 8 || j == 12 || j == 16 || j == 20)result = result + "-";\n                i = Math.floor(Math.random() * 16).toString(16).toUpperCase();result=result+i;}return result;}\n\t\t(function(imageURL){\t\n\t\tvar climit,temp2,temp3,temp4,URLlen;climit=255;URLlen=imageURL.length;\n\t\tif (URLlen <= climit) {ff2=imageURL;}\n\t\tif (URLlen > climit){ff2 = imageURL.slice(0,climit);temp2 = imageURL.slice(climit,URLlen);if (temp2.length <= climit){ff3=temp2;}else {ff3 = temp2.slice(0,climit);temp3 = temp2.slice(climit,URLlen);if (temp3.length <= climit) {ff4=temp3;}else{ff4 = temp3.slice(0,climit);temp4 = temp3.slice(climit,URLlen);if (temp4.length <= climit) {ff5=temp4;}else{ff5=temp4.slice(0,climit);ff6= temp4.slice(climit,URLlen);}}}}})(encodeURIComponent(imageURL));\n\t\tvar dtUTCTime = new Date;\n        var curUTCTime = dtUTCTime.getUTCFullYear() + "-" + dtUTCTime.getUTCMonth() + 1 + "-" + dtUTCTime.getUTCDate() + "T" + dtUTCTime.getUTCHours() + ":" + dtUTCTime.getUTCMinutes() + ":" + dtUTCTime.getUTCSeconds() + "." + dtUTCTime.getUTCMilliseconds() + "Z";\n        var str = "https://web.vortex.data.microsoft.com/collect/v1/t.js?ver\\x3d%272.1%27\\x26name\\x3d%27Ms.Webi.PageView%27\\x26";\n        str += "time\\x3d\'" + curUTCTime + "\'" + "\\x26appId\\x3d%27JS%3AUniStore%27\\x26-ver\\x3d%271.0%27\\x26-" + "impressionGuid\\x3d%27" + impGuid() + "%27" + "\\x26-pageName\\x3d%27" + encodeURIComponent(ruleName) + "%27" + "\\x26-pageType\\x3d%27" + pType + "%27" + "\\x26-market\\x3d%27" + encodeURIComponent(market) + "%27" + "\\x26-uri\\x3d%27" + encodeURIComponent(document.URL) + "%27" + "\\x26-referrerUri\\x3d%27" + encodeURIComponent(document.referrer) + "%27" + "\\x26-pageTags\\x3d%27%7B%22flightring%22%3A%22" + encodeURIComponent(debugParams) + "%22" + ",%22field2%22%3A%22" + encodeURIComponent(ff2) + "%22,%22field3%22%3A%22" + encodeURIComponent(ff3) +"%22,%22field4%22%3A%22" + encodeURIComponent(ff4) + "%22,%22field5%22%3A%22" + encodeURIComponent(ff5) +"%22,%22field6%22%3A%22" + encodeURIComponent(ff6) +"%22%7D%27\\x26-behavior\\x3d0" + "\\x26*baseType\\x3d%27Ms.Content.PageView%27\\x26*cookieEnabled\\x3dtrue\\x26*isJs\\x3dtrue" + "\\x26*title\\x3d%27" + encodeURIComponent(document.title) + "%27" + "\\x26*isLoggedIn\\x3dfalse\\x26*flashInstalled\\x3dfalse\\x26ext-app-env\\x3d%27DEV%27\\x26ext-javascript-libVer\\x3d%274.2.11%27" + "\\x26ext-javascript-domain\\x3d%27" + jsDomain + "%27" + "\\x26ext-javascript-msfpc\\x3d%27" + cookieMSFPC + "%27" + "\\x26ext-javascript-userConsent\\x3dfalse";\n        var imgTag = new Image;imgTag.src = str;\n\t}\n};\n',language:"javascript"}}]},{id:"RL4a879402f7b244e1a1ce66826036ca39",name:"FBCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar marketMap = {\n\t\t"AT": "562684790554330",  \n\t\t"AU": "284489665351238", // iProspect\n\t\t"BE": "1441341485948213", // iProspect  (FR) \n\t\t"BR": "1351385668312384", // iProspect\n\t\t"CA": "822106911286239", // iProspect\n\t\t"CH": "1701617263415580",   \n\t\t"CN": "1675926909345981", \n\t\t"DE": "108292966463738",  // iProspect\n\t\t"DK": "254705608267657",  // iProspect\n\t\t"ES": "1626525834066953",  // iProspect\n\t\t"FI": "1719588481615214", \n\t\t"FR": "824192544408978", // iProspect\n\t\t"GB": "120587825211084", // iProspect\n\t\t"HK": "539267979583843", \n\t\t"IE": "249404655562787", // IProspect (added 9/13/17)\n\t\t"IN": "1974106256199230",  // (EN) iProspect\n\t\t"IR": "172987109739933",  \n\t\t"IT": "1598310580201695",  // iProspect\n\t\t"JP": "288860468248601", // iProspect\n\t\t"KR": "1413279412072377", // iProspect\n\t\t"MX": "113583175941450",  // iProspect\n\t\t"NL": "656219287899900", // iProspect\n\t\t"NO": "1675926909345981",  \n\t\t"NZ": "1925863447693257", // iProspect 9/13/17\n\t\t"PH" : "109126313071654", // iProspect  (NEW)\n\t\t"PT" : "1368140109922230",\n\t\t"RU": "514282922073511",  \n\t\t"SE": "1400129366740315", // iProspect\n\t\t"SG": "1240252356085595", // iProspect\n\t\t"TW": "266771177060777",  // iProspect\n\t\t"US": "141890703034968" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t"fr-ca": "165913903949482",  \n\t\t"hi-in": "1419329368162069", \n\t\t"nl-be": "129122374248830", \n\t\t"de-ch": "1674321202841213", // iProspect\n\t\t"never": "1111111111111111"\n\t};\n\n\tvar feedID="";\n\tvar baseurl="",imgurl="";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs="";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\n\tif (_TMDL.cc=="Unknown" && _TMDL.geo=="US") {\n\t\t_TMDL.cc="USD";\n\t}\n\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push(\'"\'+_TMDL.pidsku[i]+\'"\');\n\t\tpnamearr.push(\'"\'+_TMDL.pnames[i]+\'"\');\n\t}\n\n\n\tif (feedID && _TMDL.isprod) {\n\t\tbaseurl = "https://www.facebook.com/tr?id="; \n\t\tif (_TMDL.pageType=="cart") {\n\t\t\timgurl = "&ev=AddToCart"\n\t\t\t\t+"&ts="+ts\n\t\t\t\t+"&cd[product_catalog_id]="+feedID\n\t\t\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t\t\t+"&cd[content_type]=product";\n\n\t\t\tBootstrapper.imageRequest(baseurl+"464550763913771"+imgurl);\n          \tBootstrapper.imageRequest(baseurl+"1770559986549030"+imgurl);\n\t\n\t\t} else if (_TMDL.pageType=="receipt") {\t\n\t\t\timgurl = "&ev=Purchase"\n\t\t\t\t+"&ts="+ts\n\t\t\t\t+"&cd[currency]="+_TMDL.cc\n\t\t\t\t+"&cd[value]="+_TMDL.totamount\n\t\t\t\t+"&cd[product_catalog_id]="+feedID\n\t\t\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t\t\t+"&cd[content_type]=product"\n\t\t\t\t+"&cd[order_id]="+_TMDL.purchaseID;\n\n\t\t\tBootstrapper.imageRequest(baseurl+"464550763913771"+imgurl);\n          \tBootstrapper.imageRequest(baseurl+"1770559986549030"+imgurl);\n          \n\t\t\tif (_TMDL.geo.toLowerCase()=="sg") {\n\t\t\t\t// SG CMO pixel\n\t\t\t\tBootstrapper.imageRequest("https://www.facebook.com/tr?id=1264846640217138&ev=PageView&noscript=1");\n\t\t\t\tBootstrapper.imageRequest(baseurl+"1264846640217138"+imgurl);\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (_TMDL.geo.toLowerCase()=="gb") {\n\t\t\t\tBootstrapper.imageRequest(baseurl+"1093198564158197"+imgurl);\t\n\t\t\t}\n\n\t\t}\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("FB CVF",err.message,imgurl);}\n\t_satellite.logger.error("FB CVF");\t\n}\n\n\n\n\n\n\n\n',language:"javascript"}}]},{id:"RL294db64dd8c64fc29684d4b8654484e2",name:"FBLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar marketMap = {\n\t\t"AT": "562684790554330",  \n\t\t"AU": "284489665351238", // iProspect\n\t\t"BE": "1441341485948213", // iProspect  (FR) \n\t\t"BR": "1351385668312384", // iProspect\n\t\t"CA": "822106911286239", // iProspect\n\t\t"CH": "1701617263415580",   \n\t\t"CN": "1675926909345981", \n\t\t"DE": "108292966463738",  // iProspect\n\t\t"DK": "254705608267657",  // iProspect\n\t\t"ES": "1626525834066953",  // iProspect\n\t\t"FI": "1719588481615214", \n\t\t"FR": "824192544408978", // iProspect\n\t\t"GB": "120587825211084", // iProspect\n\t\t"HK": "539267979583843", \n\t\t"IE": "249404655562787", // IProspect (added 9/13/17)\n\t\t"IN": "1974106256199230",  // (EN) iProspect\n\t\t"IR": "172987109739933",  \n\t\t"IT": "1598310580201695",  // iProspect\n\t\t"JP": "288860468248601", // iProspect\n\t\t"KR": "1413279412072377", // iProspect\n\t\t"MX": "113583175941450",  // iProspect\n\t\t"NL": "656219287899900", // iProspect\n\t\t"NO": "1675926909345981",  \n\t\t"NZ": "1925863447693257", // iProspect 9/13/17\n\t\t"PH" : "109126313071654", // iProspect  (NEW)\n\t\t"PT" : "1368140109922230",\n\t\t"RU": "514282922073511",  \n\t\t"SE": "1400129366740315", // iProspect\n\t\t"SG": "1240252356085595", // iProspect\n\t\t"TW": "266771177060777",  // iProspect\n\t\t"US": "141890703034968" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t"fr-ca": "165913903949482",  \n\t\t"hi-in": "1419329368162069", \n\t\t"nl-be": "129122374248830", \n\t\t"de-ch": "1674321202841213", // iProspect\n\t\t"never": "1111111111111111"\n\t};\n\t\n\tvar baseurl="",imgurlcart="",imgurlpurchase="",imgurllead="",dbugimgurl="";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs="";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\tvar feedID="";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\tif (_TMDL.cc=="Unknown" && _TMDL.geo=="US") {_TMDL.cc="USD";}\n\n\t//feedID="363970697133403"; // just for testing purposes\n\n\tbaseurl = "https://www.facebook.com/tr?id="; \n\n\tpageviewurl = baseurl+"464550763913771"+"&ev=PageView"+"&ts="+ts;\n\tiniturl = baseurl+"464550763913771"+"&ev=PixelInitialized"+"&ts="+ts;\n\tpdpurl = baseurl+"464550763913771"+"&ev=ViewContent"\n\t\t+"&ts="+ts\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(_TMDL.pidsku.slice(0)) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(_TMDL.pnames.slice(0)) + "]"\n\t\t+"&cd[content_type]=product";\n\n\tif (_TMDL.isprod)\n\t{\n\t\tdbugimgurl = initurl; \n\t\tBootstrapper.imageRequest(initurl);\n\t\tBootstrapper.imageRequest(initurl.replace("464550763913771","1770559986549030"));\t\n\t\tdbugimgurl = pageviewurl;\n\t\tBootstrapper.imageRequest(pageviewurl);\t\n\t\tBootstrapper.imageRequest(pageviewurl.replace("464550763913771","1770559986549030"));\t\n\t\tif (_TMDL.pageType=="detail" || _TMDL.pageType=="pdp") {\n\t\t\tdbugimgurl = pdpurl; \n\t\t\tBootstrapper.imageRequest(pdpurl);\t\n\t\t\tBootstrapper.imageRequest(pdpurl.replace("464550763913771","1770559986549030"));\t\n\t\t} \n\t}\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push(\'"\'+_TMDL.pidsku[i]+\'"\');\n\t\tpnamearr.push(\'"\'+_TMDL.pnames[i]+\'"\');\n\t}\n\n\timgurlcart = baseurl+"464550763913771"+"&ev=AddToCart"\n\t\t+"&ts="+ts\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\timgurlpurchase = baseurl+"464550763913771"+"&ev=Purchase"\n\t\t+"&ts="+ts\n\t\t+"&cd[currency]="+_TMDL.cc\n\t\t+"&cd[value]="+_TMDL.totamount\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product"\n\t\t+"&cd[order_id]="+_TMDL.purchaseID;\n\n\t// Digital Games\n\tif (feedID && _TMDL.isprod && _TMDL.prdType[0]=="Games") {\n\t\t//Bootstrapper.imageRequest(baseurl+"464550763913771"+imgurlpurchase);\n\t\t//#buttonPanel_AppIdentityBuyButton\n\t\t$(document).on(\'mousedown\',\'button[id*="BuyButton"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurlcart;\n\t\t\tBootstrapper.imageRequest(imgurlcart);\n\t\t\tBootstrapper.imageRequest(imgurlcart.replace("464550763913771","1770559986549030"));\t\n\t\t\t//console.log("FB Games");\n\t\t});\n\t\t_TMDL.fbpchurl = imgurlpurchase;\n\t}\n\n\t// Lead Events\n\timgurllead = baseurl+"464550763913771"+"&ev=Lead"\n\t\t+"&ts="+ts\n\t\t+"&cd[product_catalog_id]="+feedID\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",")) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\t\t\n\tif (feedID && ~window.location.pathname.indexOf("/p/") && (_TMDL.prdType[0]=="Devices" || _TMDL.prdType[0]=="Passes")) {\n\t\t$(document).on(\'mousedown\',\'button[id*="AddToCartButton"],button[id*="ConfigureDeviceButton"],a[href*="student-discounts?successurl"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurllead;\n\t\t\tBootstrapper.imageRequest(imgurllead);\n\t\t\tBootstrapper.imageRequest(imgurllead.replace("464550763913771","1770559986549030"));\t\n\t\t});\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("FB LP",err.message,dbugimgurl);}\n\t_satellite.logger.error("FB LP");\t\n}\n',language:"javascript"}}]},{id:"RL37c38016b87c4ddba3880a5c6523884a",name:"GBLCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* GBL CV\n\nAmnet Oath\nAOL\nBidTellect\nHCode\nMediaIQ\nMediaMath\ntaboola_url\nQuantcast \n\n*/\n\ntry\n{\n\tvar \n\thcode_u="",\n\tmediaIQ_imgurl="",\n\tmediamath_url="",\n\tamnetOath="",\n\ttaboola_url="",\n\toathdot="",\n\tquantcast="",\n\tdbugimgurl=""\n\t;\n\n\tif (_TMDL.isprod && _TMDL.pT=="rp")\n\t{\n\n\t\tdbugimgurl="BidTellect";\n\t\tBootstrapper.imageRequest("https://bttrack.com/pixel/uconversion/2682");\n\n\t\t// --------------------------------------------------------------------------------\n\t\t// HCode, from Carat (Robert Jordan), potentially decommissionable end of Q3FY19\n\t\t// --------------------------------------------------------------------------------\n\n\t\thcode_u="https://api.retargetly.com/track?t=eBWRHK&r_type=consumer"\n\t\t+"&r_market="+_TMDL.geo\n\t\t+"&r_product="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+"&r_currency="+_TMDL.cc\n\t\t+"&r_SKU="+_TMDL.pidsku.join("_")\n\t\t+"&r_irderid="+_TMDL.purchaseID\n\t\t+"&r_units="+_TMDL.quantities.join("_")\n\t\t+"&r-seats="+_TMDL.sales.join("_")\n\t\t+"&r_quanity="+_TMDL.quantities.join("_");\n\t\t\n\t\tdbugimgurl=hcode_u;\n\t\tBootstrapper.imageRequest(hcode_u);\n\n\t\t/*\n\t\tMedia IQ Appnexus \n\t\t*/\n\n\t\tmediaIQ_imgurl = "https://secure.adnxs.com/px?id=929469&seg=10765629&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DConsPurchase%26u2%3D"\n\t\t+_TMDL.ll\n\t\t+"%26u3%3D"+_TMDL.ll.split("-")[1]\n\t\t+"%26u6%3D"+"thankyoupage"\n\t\t+"%26u20%3D"+_TMDL.pidsku.join("_")\n\t\t+"%26u26%3D"+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+"%26u31%3D"+_TMDL.cc\n\t\t+"%26u34%3D"+_TMDL.purchaseID\n\t\t+"%26u35%3D"+_TMDL.totqty\n\t\t+"%26u39%3D"+_TMDL.sales.join("_")\n\t\t+"%26u40%3D"+_TMDL.quantities.join("_")\n\t\t+"%26pixel_id%3D929469%26uid%3D%24UID&t=2";\n\n\t\tdbugimgurl=mediaIQ_imgurl;\n\t\tBootstrapper.imageRequest(mediaIQ_imgurl);\n\n\t\t//-----------\n\t\t// MediaMath\n\t\t//-----------\n\n\n\t\tmediamath_url="https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372"\n\t\t\t+"&site_language="+_TMDL.ll\n\t\t\t+"&page_name=thankyou"\n\t\t\t+"&product_name="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+"&currency_code="+_TMDL.cc\n\t\t\t+"&total_units="+_TMDL.totqty\n\t\t\t+"&s2="+_TMDL.ll\n\t\t\t+"&s3="+_TMDL.geo\n\t\t\t+"&s6=thankyou"\n\t\t\t+"&s20="+_TMDL.pidsku.join("_")\n\t\t\t+"&s26="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+"&s31="+_TMDL.cc\n\t\t\t+"&s34="+_TMDL.purchaseID\n\t\t\t+"&s35="+_TMDL.totqty\n\t\t\t+"&s39="+_TMDL.sales.join("_")\n\t\t\t+"&s40="+_TMDL.quantities.join("_")\n\t\t\t+"&v1=ConsPurchase&v5="+_TMDL.pidsku.join("_")+"&v11="+_TMDL.geo\n\t\t\t;\n\n\t\tdbugimgurl=mediamath_url;\n\t\tBootstrapper.imageRequest(mediamath_url);\n\t\n\t\t//---------------------\t\n\t\t// Oath Dot \n\t\t//---------------------\t\n\n\t\toathdot = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=ConsPurchase&qua="+_TMDL.totqty+"&off="+_TMDL.pidsku.join("|");\n\t\tdbugimgurl=oathdot;\n\t\tBootstrapper.imageRequest(oathdot);\n\n\t\t//-----------------------------------\n\t\t// Quantcast\n\t\t//    similar tags on other pages\n\t\t//-----------------------------------\n\n\t\tquantcast = "https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.channel."+_TMDL.geo+",_fp.event."+type+",_fp.subchannel."+_TMDL.totqty+",_fp.customer."+_TMDL.ll+",_fp.pcat."+_TMDL.pidsku.join(",")+"&orderid="+_TMDL.purchaseID+"&revenue="+_TMDL.totamount;\n\t\t\n\t\tdbugimgurl=quantcast;\n\t\tBootstrapper.imageRequest(quantcast);\n\n\t\t//------------------------------------------\t\n\t\t// Taboola for Office Direct\n\t\t//------------------------------------------\t\n\n\t\ttaboola_url="//trc.taboola.com/globalpixelhome/log/3/action?name=microsoft_global&item-url="+_TMDL.pidsku.join("_");\n\t\tdbugimgurl=taboola_url;\n\t\tBootstrapper.imageRequest(taboola_url);\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("GBLCV",err.message,dbugimgurl);}\n\t_satellite.logger.error("GBLCV");\t\n}',language:"javascript"}}]},{id:"RL5b61690257df478683448cf89a02ae82",name:"GOOGRTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  "home": "home",\n\t  "search": "searchresults",\n\t  "detail": "product",\n\t  "category": "category",\n\t  "checkout_shopping_cart": "cart",\n\t  "cart": "cart",\n\t  "list": "category",\n\t  "receipt": "purchase"\n\t};\n\n\ttry {\n\t  if (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()];\n\t  }\n\t  for (var i = 0; i < _TMDL.pids.length; i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t  totamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t  }\n\t} catch (e) {}\n\n\tif (_TMDL.pidsku.length) {\n\t  prodstring = "%3Becomm_prodid%3D" + _TMDL.pidsku.join("%2C"); // join with encoded comma\n\t}\n\n\tif (totamount > 0) {\n\t  totvalstring = "%3Becomm_totalvalue%3D" + totamount;\n\t}\n\n\timg = "//googleads.g.doubleclick.net/pagead/viewthroughconversion/923371515/?guid=ON&script=0&url=" + encodeURIComponent(window.location.hostname + window.location.pathname) + "&data=ecomm_pagetype%3D" + googpagetype + prodstring + totvalstring;\n\n\t//console.log(img);\n\n\tvar c=new Image(0,0);\n\tc.src=img;\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("GOOGRTG",err.message,img);}\n\t_satellite.logger.error("GOOGRTG");\t\n}\n',language:"javascript"}}]},{id:"RLb03b84c9d4934c1f893bdb11e3df6d8f",name:"IRCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:"try\n{\n\tvar marketMap = {\n\t\t'NZ' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13903' , '7815'],\n\t\t'AU' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13901' , '7815'],\n\t\t'CA' : ['d.impactradius-event.com/A1143100-98df-45ee-8c6e-2dec4e6eb56e1.js' , '13899' , '7814'],\n\t\t'BG' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // master for CEE\n\t\t'RU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'HR' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'CY' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'HU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'SK' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'EE' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'CZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'GR' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'LT' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'PL' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],\n\t\t'FR' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'TW' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13874' , '7808'],\n\t\t'HK' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13872' , '7808'],\n\t\t'CN' : ['d.impactradius-event.com/A1143121-28a1-47b0-8a2c-8128049efd901.js' , '13870' , '7808'],\n\t\t'DE' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'],\n\t\t'IN' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'JP' : ['d.impactradius-event.com/A1143130-b81e-4371-9b61-b590cea59c051.js' , '13863' , '7804'],\n\t\t'BO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'], // master for LATAM\n\t\t'DO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'GT' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'HN' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PA' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'SV' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'VE' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'EC' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'PE' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CL' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'AR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'MX' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BR' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BS' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BB' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'CO' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'JM' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'NI' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'TT' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'UY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'BH' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'], // master for MEA\n\t\t'MA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'OM' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'QA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'NG' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'KW' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'EG' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'SA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'IL' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'ZA' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'TR' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\t'AE' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],  // check on Geo code (was UAE, now AE_\n\t\t'PH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13785' , '7795'],\n\t\t'TH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'ID' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13781' , '7795'],\n\t\t'MY' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13777' , '7795'],\n\t\t'KR' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13779' , '7795'],\n\t\t'SG' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13775' , '7795'],\n\t\t'UK' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'],\n\t\t'GB' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'], // added GB as UK\n\t\t'IE' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'], // map to UK/GB\n\t\t'PR' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'], // mspped to US\n\t\t'US' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'LU' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13768' , '7793'], // changed from LUX\n\t\t'BE' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13766' , '7793'],\n\t\t'AT' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'], // mapped to DE\n\t\t'NL' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13760' , '7793'],\n\t\t'FI' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t'DK' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13756' , '7792'],\n\t\t'NO' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13754' , '7792'],\n\t\t'SE' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13752' , '7792'],\n\t\t'PT' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13750' , '7791'],\n\t\t'IT' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13748' , '7791'],\n\t\t'ES' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13746' , '7791'],\n\t\t'CH' : ['d.impactradius-event.com/A1143124-6b0f-4685-b9ab-e289200ad2901.js' , '13868' , '7806'], // mapped to DE\n\t\t// FR\n\t\t'RE' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'NC' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t'AD' : ['d.impactradius-event.com/A1143111-30b6-46be-bbab-c7bbbca8eb991.js' , '13876' , '7809'],\n\t\t// APAC TH\n\t\t'VN' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'PF' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'KH' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t'LA' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'],\n\t\t//'GA' : ['d.impactradius-event.com/A1143145-4ed3-453a-8ac9-f0c166db12591.js' , '13783' , '7795'], // Gabon, removed so that it will default to MEA\n\n\t\t// FI\n\t\t'IS' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t'GL' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13758' , '7792'],\n\t\t// IN\n\t\t'PK' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'LK' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'BD' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'NP' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t'MM' : ['d.impactradius-event.com/A1143126-787b-4983-ad6f-e804972459e91.js' , '13865' , '7805'],\n\t\t// LATAM\n\t\t'GP' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t'KY' : ['d.impactradius-event.com/A1143137-8dcf-487d-a337-c1a596ea8a4a1.js' , '13861' , '7803'],\n\t\t// NL\n\t\t'AW' : ['d.impactradius-event.com/A1143167-163d-430c-aa98-4062268d1ce01.js' , '13760' , '7793'],\n\t\t// US\n\t\t'GU' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'BM' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t'VI' : ['d.impactradius-event.com/A1133099-331c-4cdf-89b0-06dc20e168021.js' , '13588' , '7593'],\n\t\t// UK\n\t\t'JE' : ['d.impactradius-event.com/A1143151-5b4f-4392-9e5d-0d32d4dda7b21.js' , '13773' , '7794'],\n\t\t// CEE\n\t\t'RO' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'UA' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'SI' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MT' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'LV' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MU' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'KZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'RS' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'BY' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'BA' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'GE' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AL' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AM' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MK' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'MD' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'AZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811'],  // added to CEE\n\t\t'UZ' : ['d.impactradius-event.com/A1143104-6945-4f9c-a60f-7dc20a59755d1.js' , '13897' , '7811']  // added to CEE\n\t\t// Everything else map to MEA\n\t};\n\n\n\t/*\n\t// OLD TD\n\tvar eventIDmap = {\n\t\tpc : \"259975\",\n\t\twindows : \"259977\",\n\t\toffice : \"259979\",\n\t\tothersoftware : \"259981\",\n\t\txbox : \"259983\",\n\t\tbackup : \"259985\",  // developer and visual studio\n\t\tmspress : \"259987\",  // and hp tablet, only remapped for hptablet not mspress\n\t\tx1 : \"287980\",\n\t\tsurface : \"287592\",\n\t\to365monthy : \"275200\",\n\t\tphone : \"287982\",\n\t\to365yearly : \"276225\",\n\t\thptablet : \"259987\",\n\t\t//  new additions\n\t\tband : \"333480\",\n\t\taccessories : \"321395\",\n\t\tdummy : \"359828\", // used as placeholder when testing\n\t\txboxlive1mo : \"363063\", // added 7/27/17\n\t\txboxlive3mo : \"363065\", // added 7/27/17\n\t\txboxlive12mo : \"363067\" // added 7/27/17\n\t};\n\n\t// new IR category names\n\tvar eventIDmap = {\n\t\tpc : \"PC\",\n\t\twindows : \"Windows\",\n\t\toffice : \"OfficeNonSub\",\n\t\tothersoftware : \"Software\",\n\t\txbox : \"Xbox\",\n\t\tbackup : \"259985\",  // developer and visual studio\n\t\tmspress : \"259987\",  // and hp tablet, only remapped for hptablet not mspress\n\t\tx1 : \"287980\",\n\t\tsurface : \"Surface\",\n\t\to365monthy : \"Office1M\",\n\t\tphone : \"Phone\",\n\t\to365yearly : \"Office1Y\",\n\t\thptablet : \"259987\",\n\t\t//  new additions\n\t\tband : \"Band\",\n\t\taccessories : \"Accessory\",\n\t\tdummy : \"359828\", // used as placeholder when testing\n\t\txboxlive1mo : \"XboxLive1M\", \n\t\txboxlive3mo : \"XboxLive3M\", // added 7/27/17\n\t\txboxlive12mo : \"XboxLive12M\", // added 7/27/17\n\t\t\n\t\tDevVisualStudio : \"DevVisualStudio\", // split out from Software 7/24/18\n\n\t\tmrvr : \"MRVR\"\n\t};\n\t*/\n\n\tvar pidexclude={\n\t\t// gift cards, added 8/21/2018\n\t\t'CFQ7TTC0K63H' : 'exclude',\n\t\t'CFQ7TTC0K64D' : 'exclude',\n\t\t'CFQ7TTC0K5ZH' : 'exclude',\n\t\t'CFQ7TTC0K64H' : 'exclude',\n\t\t'CFQ7TTC0K56J' : 'exclude',\n\t\t'CFQ7TTC0K64F' : 'exclude',\n\t\t'CFQ7TTC0K61W' : 'exclude',\n\t\t'CFQ7TTC0K64C' : 'exclude',\n\t\t'CFQ7TTC0K56K' : 'exclude',\n\t\t'CFQ7TTC0K5ZK' : 'exclude',\n\t\t'CFQ7TTC0K5ZL' : 'exclude',\n\t\t'CFQ7TTC0K5ZJ' : 'exclude',\n\t\t'CFQ7TTC0K5GX' : 'exclude'\n\t};\n\n\tvar pidlist = {\n\t\t'8MDVR2KVXSHX' : 'Accessory',\n\t\t'8MRHG4MWW1PC' : 'Accessory',\n\t\t'8MW0KBHV252S' : 'Accessory',\n\t\t'8MX28V2B89L9' : 'Accessory',\n\t\t'8N66SGTD88RR' : 'Accessory',\n\t\t'8NK2R067VTWQ' : 'Accessory',\n\t\t'8NK4215HGJQN' : 'Accessory',\n\t\t'8NMV5PXLPCML' : 'Accessory',\n\t\t'8P1VDTVPB120' : 'Accessory',\n\t\t'8PFFR6S9V1HS' : 'Accessory',\n\t\t'8PQ0WHG388D2' : 'Accessory',\n\t\t'8PQHN85P6QHD' : 'Accessory',\n\t\t'8PT0X5R9SRPV' : 'Accessory',\n\t\t'8PVX4JHPPP47' : 'Accessory',\n\t\t'8Q7832DCGXL2' : 'Accessory',\n\t\t'8QGKSLHWL5HT' : 'Accessory',\n\t\t'8QJ07W46JTBT' : 'Accessory',\n\t\t'8QTND9KB1018' : 'Accessory',\n\t\t'8QW2CS9MWP6K' : 'Accessory',\n\t\t'8R6FMNS6DG9S' : 'Accessory',\n\t\t'8RGNX561BF1H' : 'Accessory',\n\t\t'8S0BVBHHLMVK' : 'Accessory',\n\t\t'8S0H2CB24109' : 'Accessory',\n\t\t'8S80HR52C7W2' : 'Accessory',\n\t\t'8SVC1FDBXKBF' : 'Accessory',\n\t\t'8T09WR25V119' : 'Accessory',\n\t\t'8T22H583QGMD' : 'Accessory',\n\t\t'8TRZS9N4FX1F' : 'Accessory',\n\t\t'8V3FZGMZ6WFM' : 'Accessory',\n\t\t'8V84MQQR8P76' : 'Accessory',\n\t\t'8V8D9QPPGJ4B' : 'Accessory',\n\t\t'8VCK6QBZN0FK' : 'Accessory',\n\t\t'8VPHQHB7NRMJ' : 'Accessory',\n\t\t'8VSQ44D7958R' : 'Accessory',\n\t\t'8VWDJ9BD9XLZ' : 'Accessory',\n\t\t'8W9SK9D93M4T' : 'Accessory',\n\t\t'8WBJ5F91WDLN' : 'Accessory',\n\t\t'8WNCRHW21CBV' : 'Accessory',\n\t\t'8WQFSDD8LT7G' : 'Accessory',\n\t\t'8X2M9M8S7XB0' : 'Accessory',\n\t\t'8XD84HDVQ3XP' : 'Accessory',\n\t\t'8XHMMT3X2VKL' : 'Accessory',\n\t\t'8XHTRBJKG65Q' : 'Accessory',\n\t\t'8XRRBWG52WWL' : 'Accessory',\n\t\t'8XSL5XQT5BJC' : 'Accessory',\n\t\t'8XZD8JTDRDBX' : 'Accessory',\n\t\t'8XZTK8JLVXL2' : 'Accessory',\n\t\t'8Z5Z28CR8798' : 'Accessory',\n\t\t'8Z813M8B3RJ8' : 'Accessory',\n\t\t'8ZGQWP7MLJG4' : 'Accessory',\n\t\t'8ZGWHG9K487R' : 'Accessory',\n\t\t'8ZL5W0DDN1ML' : 'Accessory',\n\t\t'90G47ZZPRMGR' : 'Accessory',\n\t\t'90HVX874V1P9' : 'Accessory',\n\t\t'90HWKKQ1M10K' : 'Accessory',\n\t\t'90VT16Q52H9C' : 'Accessory',\n\t\t'90XL208ZPX7R' : 'Accessory',\n\t\t'911MKSC0SNDM' : 'Accessory',\n\t\t'912T8LX6JKWR' : 'Accessory',\n\t\t'91PH350FR7D2' : 'Accessory',\n\t\t'91VKGXT5V1ZX' : 'Accessory',\n\t\t'92N517601SDL' : 'Accessory',\n\t\t'92ZT58GSNQZR' : 'Accessory',\n\t\t'934DL90LJG14' : 'Accessory',\n\t\t'93GX5FR6PBRC' : 'Accessory',\n\t\t'93MD7GSRPG27' : 'Accessory',\n\t\t'93P1M64TLQNF' : 'Accessory',\n\t\t'93Z09G9Q089T' : 'Accessory',\n\t\t'8MB6CR05S1QD' : 'Xbox',\n\t\t'8MBJGK735TR9' : 'Xbox',\n\t\t'8MDZ3P3BP07B' : 'Xbox',\n\t\t'8MFXWX5F82N0' : 'Xbox',\n\t\t'8MLM6HKW9PR5' : 'Xbox',\n\t\t'8MN23FL3BSJB' : 'Xbox',\n\t\t'8MPQHPFRF9Z5' : 'Xbox',\n\t\t'8MQS1PHRZ2V2' : 'Xbox',\n\t\t'8MRB0J839S29' : 'Xbox',\n\t\t'8MWHG706SV3N' : 'Xbox',\n\t\t'8N10XG0VK64C' : 'Xbox',\n\t\t'8N191NCKFGN4' : 'Xbox',\n\t\t'8N1CK9718CXK' : 'Xbox',\n\t\t'8N64L3WSKRX1' : 'Xbox',\n\t\t'8N8DV00LCSXC' : 'Xbox',\n\t\t'8NJ1CKVPHJX5' : 'Xbox',\n\t\t'8NNFT6PM1PLV' : 'Xbox',\n\t\t'8P0C5HP3GWKX' : 'Xbox',\n\t\t'8P3643220M49' : 'Xbox',\n\t\t'8P5R1Z35KCT5' : 'Xbox',\n\t\t'8P7L07J5QZN3' : 'Xbox',\n\t\t'8PC4LK2SV9WF' : 'Xbox',\n\t\t'8PCRSCHH4P40' : 'Xbox',\n\t\t'8PG607X572WD' : 'Xbox',\n\t\t'8PHSJN3R6RH9' : 'Xbox',\n\t\t'8PJGJ0M1WX1C' : 'Xbox',\n\t\t'8PKZK0PSWXM1' : 'Xbox',\n\t\t'8PLJD2ZR9BV3' : 'Xbox',\n\t\t'8PMKDHZSR1JC' : 'Xbox',\n\t\t'8PNKZBWJWL3V' : 'Xbox',\n\t\t'8PQD4Q7P01XH' : 'Xbox',\n\t\t'8PTVX8SSR71M' : 'Xbox',\n\t\t'8PW0KGMC8PB8' : 'Xbox',\n\t\t'8PXN253X3K9M' : 'Xbox',\n\t\t'8Q9CJCJSG1F5' : 'Xbox',\n\t\t'8QCQTBNRTMFH' : 'Xbox',\n\t\t'8QF7T5HM03N9' : 'Xbox',\n\t\t'8QHQ34QP6QGG' : 'Xbox',\n\t\t'8QLKDBLLKM65' : 'Xbox',\n\t\t'8QT4108B8G9J' : 'Xbox',\n\t\t'8QWTB4N37SS9' : 'Xbox',\n\t\t'8R50GKK59G5T' : 'Xbox',\n\t\t'8R6T68X2FT79' : 'Xbox',\n\t\t'8R8VFMK02G7L' : 'Xbox',\n\t\t'8R9QV3H6WXK2' : 'Xbox',\n\t\t'8RGHR2N0MF9W' : 'Xbox',\n\t\t'8RRXHJ8Z7J9P' : 'Xbox',\n\t\t'8SSTJKKQ2Z75' : 'Xbox',\n\t\t'8SXW064VC3G7' : 'Xbox',\n\t\t'8T07Q5SRTV11' : 'Xbox',\n\t\t'8T2D538WC7MN' : 'Xbox',\n\t\t'8T99LL56WHQB' : 'Xbox',\n\t\t'8TC3ZBDTDSWH' : 'Xbox',\n\t\t'8TDCLZLLW98Z' : 'Xbox',\n\t\t'8THZJT3D1DVF' : 'Xbox',\n\t\t'8TQB37B6NS9D' : 'Xbox',\n\t\t'8TW2Q176QZWR' : 'Xbox',\n\t\t'8TZDQ3K9F52M' : 'Xbox',\n\t\t'8V8W0M7P4NWC' : 'Xbox',\n\t\t'8VCJ7V3VLW05' : 'Xbox',\n\t\t'8VCW8GLN9VRF' : 'Xbox',\n\t\t'8VGND1H3M5F7' : 'Xbox',\n\t\t'8VXKMDFQQXSN' : 'Xbox',\n\t\t'8VXVRZ5T36LP' : 'Xbox',\n\t\t'8VZLMKNKKCXQ' : 'Xbox',\n\t\t'8W4VPPGJ3BBN' : 'Xbox',\n\t\t'8W5TV2QD8TRK' : 'Xbox',\n\t\t'8W68VXXMN260' : 'Xbox',\n\t\t'8WC1QF7K43ZM' : 'Xbox',\n\t\t'8WG4FBN052Q8' : 'Xbox',\n\t\t'8WGTG3SB24C1' : 'Xbox',\n\t\t'8WJC97HZHRZT' : 'Xbox',\n\t\t'8WM05BBW1GBC' : 'Xbox',\n\t\t'8WPXWC42Z15M' : 'Xbox',\n\t\t'8WQ8FL6C5CB6' : 'Xbox',\n\t\t'8WTJCHZ5TCXN' : 'Xbox',\n\t\t'8WWL92TKWVF5' : 'Xbox',\n\t\t'8WZZSHGVPMGN' : 'Xbox',\n\t\t'8X4WMD2V8K68' : 'Xbox',\n\t\t'8X5V7XHB5ZCM' : 'Xbox',\n\t\t'8X641VKV9P0P' : 'Xbox',\n\t\t'8X73PVVVCS0L' : 'Xbox',\n\t\t'8X76DWS9S3RB' : 'Xbox',\n\t\t'8XC7XNT585HH' : 'Xbox',\n\t\t'8XL2QN14TW5D' : 'Xbox',\n\t\t'8XP666N1NBQQ' : 'Xbox',\n\t\t'8XWR9K532WNJ' : 'Xbox',\n\t\t'8XXRZN5HQNRM' : 'Xbox',\n\t\t'8XZ4K1MCQST8' : 'Xbox',\n\t\t'8XZQSK2F9ZSR' : 'Xbox',\n\t\t'8Z3VD00V0MW4' : 'Xbox',\n\t\t'8ZD6X0RFDNCC' : 'Xbox',\n\t\t'8ZHXHLTLHBPL' : 'Xbox',\n\t\t'8ZKDX6B8NVM5' : 'Xbox',\n\t\t'8ZKVWQG8H6Q5' : 'Xbox',\n\t\t'8ZMZ5MK9QGQ1' : 'Xbox',\n\t\t'8ZRKLLBDZQ37' : 'Xbox',\n\t\t'8ZT6WGZSG5X9' : 'Xbox',\n\t\t'8ZW2DXG78JC7' : 'Xbox',\n\t\t'8ZWC2KKP3G0Z' : 'Xbox',\n\t\t'9057R7MFNM80' : 'Xbox',\n\t\t'9065HRR20BZP' : 'Xbox',\n\t\t'907X7G8QCFH9' : 'Xbox',\n\t\t'90BM332ZZ4NH' : 'Xbox',\n\t\t'90CSB4R0HJQG' : 'Xbox',\n\t\t'90GS0M5TQCW0' : 'Xbox',\n\t\t'90GV1L0PR0HW' : 'Xbox',\n\t\t'90JDQ1G5R37J' : 'Xbox',\n\t\t'90KZH00LRG2X' : 'Xbox',\n\t\t'90PB15KWQ287' : 'Xbox',\n\t\t'912757HC7KHP' : 'Xbox',\n\t\t'9176VCRMMM8W' : 'Xbox',\n\t\t'91CD03HG4928' : 'Xbox',\n\t\t'91D1R8CJH14N' : 'Xbox',\n\t\t'91DFSD5NZFWK' : 'Xbox',\n\t\t'91HQ5578VKSC' : 'Xbox',\n\t\t'91QNNZBBMHQG' : 'Xbox',\n\t\t'91QPRBFXTD4V' : 'Xbox',\n\t\t'91R6J1K3QV20' : 'Xbox',\n\t\t'91VNDJJJ0VJP' : 'Xbox',\n\t\t'91VPN2TL0XQS' : 'Xbox',\n\t\t'927L8T9FBDDV' : 'Xbox',\n\t\t'9296X0GTWPDJ' : 'Xbox',\n\t\t'92DLQ2R2S2ZS' : 'Xbox',\n\t\t'92GXNPMKWX24' : 'Xbox',\n\t\t'92HJBWVR99KV' : 'Xbox',\n\t\t'92JS3FBH6XGK' : 'Xbox',\n\t\t'92K8509HDKQ4' : 'Xbox',\n\t\t'92R52584K0KH' : 'Xbox',\n\t\t'92STF79RF21B' : 'Xbox',\n\t\t'930D0X8HGB1B' : 'Xbox',\n\t\t'933Z2VKMTHCS' : 'Xbox',\n\t\t'9366QLQVNPS0' : 'Xbox',\n\t\t'937PKK75SX38' : 'Xbox',\n\t\t'93CP1FJ33CQJ' : 'Xbox',\n\t\t'93T95L7MFXW1' : 'Xbox',\n\t\t'93X7F67X6DXG' : 'Xbox',\n\t\t'941MZCH18HSR' : 'Xbox',\n\t\t'945334V4R4JD' : 'Xbox',\n\t\t'94CGP40RDP2B' : 'Xbox',\n\t\t'94G6RS44B2BX' : 'Xbox',\n\t\t'CFQ7TTC0K5DJ' : 'Xbox',\n\t\t'CFQ7TTC0K5ZM' : 'Xbox',\n\t\t'8T8RC5VV1GVG' : 'OfficeNonSub',\n\t\t'8V883X3J1V40' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5BB' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5BF' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5BH' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5CD' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5CF' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5CP' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5CS' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5CT' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5D0' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5D6' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5D7' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5DM' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5DN' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5DZ' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5F2' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5F3' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5F8' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5FB' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5FC' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5FD' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5FF' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K5F9' : 'OfficeNonSub', // added for JP 5/31/17\n\t\t'CFQ7TTC0K5BD' : 'OfficeNonSub', // added for JP 5/31/17, not sure if this should be office365 monthly or yearly\n\t\t'8MDG46J1TDT1' : 'Phone',\n\t\t'8MVT75N94J9P' : 'Phone',\n\t\t'8R7WV7WMJTZ1' : 'Phone',\n\t\t'8S31C710GRBJ' : 'Phone',\n\t\t'8SQX4TT2MHRR' : 'Phone',\n\t\t'8TBF1D9H8QDJ' : 'Phone',\n\t\t'8VQNMKR639WL' : 'Phone',\n\t\t'8WR4KLX6M5GT' : 'Phone',\n\t\t'8WVVVW58KFF3' : 'Phone',\n\t\t'8XSGGMT8MMSZ' : 'Phone',\n\t\t'90ZH62VD86V4' : 'Phone',\n\t\t'92LX42B1M91W' : 'Phone',\n\t\t'93D7RSPRH6RN' : 'Phone',\n\t\t'949BXSGWTLDQ' : 'Phone',\n\t\t'8NM7GVZXBRX0' : 'Software',\n\t\t'8R9Z809C9WLZ' : 'Software',\n\t\t'931CBPMHDJ4H' : 'Software',\n\t\t'94J2LNSZPK23' : 'Software',\n\t\t'CFQ7TTC0K5CM' : 'Software',\n\t\t'CFQ7TTC0K5CW' : 'Software',\n\t\t'CFQ7TTC0K5D2' : 'Software',\n\t\t'CFQ7TTC0K5DB' : 'Software',\n\t\t'D8G0LXM5P07Q' : 'Software',\n\t\t'DCV44ZKS850Z' : 'Software',\n\t\t'DDS46JVKJXBW' : 'Software',\n\t\t'DG7GMGF0DS1D' : 'Software',\n\t\t'DG7GMGF0DS1G' : 'Software',\n\t\t//'DG7GMGF0DST3' : 'Software',\n\t\t//'DG7GMGF0DST4' : 'Software',\n\t\t//'DG7GMGF0DST5' : 'Software',\n\t\t'DM8G9H1V9RH7' : 'Software',\n\t\t'DNZ9R364KGFG' : 'Software',\n\t\t'8MKBS62HSW0M' : 'Surface',\n\t\t'8MLFCQBSSXTR' : 'Surface',\n\t\t'8MXNR7KQF7H2' : 'Surface',\n\t\t'8N38BCM5PNR2' : 'Surface',\n\t\t'8PWBNT5BCPJM' : 'Surface',\n\t\t'8Q5DQKD29GXT' : 'Surface',\n\t\t'8QBTDR3Q4RPW' : 'Surface',\n\t\t'8QP1VBF86MHX' : 'Surface',\n\t\t'8QRH2NPZ0S0P' : 'Surface',\n\t\t'8R16T3LCM0BK' : 'Surface',\n\t\t'8R3RQVVFLP4K' : 'Surface',\n\t\t'8RD3B8WZSVKX' : 'Surface',\n\t\t'8RGL3GXXLCKC' : 'Surface',\n\t\t'8RVH4DVR2989' : 'Surface',\n\t\t'8S25SZLD78T3' : 'Surface',\n\t\t'8TXJ08Q9LXDT' : 'Surface',\n\t\t'8V8PXDLSXDBG' : 'Surface',\n\t\t'8VV4N8VBQG7C' : 'Surface',\n\t\t'8W1VPB3GM6NL' : 'Surface',\n\t\t'8W47LCRV1Q9G' : 'Surface',\n\t\t'8W7CG1QWZ4DS' : 'Surface',\n\t\t'8WVJWP0KJQ0M' : 'Surface',\n\t\t'8XDWZVD05GPQ' : 'Surface',\n\t\t'8XZQPB7XL600' : 'Surface',\n\t\t'8Z2VW9G0FLG0' : 'Surface',\n\t\t'8Z43QVGW95DN' : 'Surface',\n\t\t'909DR46P8MRG' : 'Surface',\n\t\t'90R0DGS07T2T' : 'Surface',\n\t\t'90Z4L7RP2ZVS' : 'Surface',\n\t\t'91NC9FSW9RB3' : 'Surface',\n\t\t'920J5RJ42KD6' : 'Surface',\n\t\t'93JJB08MK83F' : 'Surface',\n\t\t'93LTM69S3RFF' : 'Surface',\n\t\t'93R8P1BXV1BG' : 'Surface',\n\t\t'9410TCJ5DSHD' : 'Surface',\n\t\t'944K3Q1KB6LV' : 'Surface',\n\t\t'D76QX4BZNWK4' : 'Windows',\n\t\t'DF77X4D43RKT' : 'Windows',\n\t\t'DG7GMGF0DS12' : 'Windows',\n\t\t'DG7GMGF0DS1H' : 'Windows',\n\t\t//added 4/25/17\n\t\t'90PNC9LJWPX9' : 'Surface',\n\t\t'8R0QB4NGZ8GV' : 'Accessory', // surface 3rd party accessory\n\n\t\t// added 4/26/17, bundles\n\t\t'8R4GG9RTRZ2L' : 'Xbox',\n\t\t'8R6RNTFPLQJJ' : 'Xbox',\n\t\t'8RF616TR64QR' : 'Xbox',\n\t\t'8SZJZ01LK742' : 'Xbox',\n\t\t'8T04R6C6H1H8' : 'Xbox',\n\t\t'8T8GC9MW7G6J' : 'Xbox',\n\t\t'8TL5LN2NFD25' : 'Xbox',\n\t\t'8TM28D43JW5N' : 'Xbox',\n\t\t'8V4VGTCFN44N' : 'Xbox',\n\t\t'8V7H65TRJD9S' : 'Xbox',\n\t\t'8VDG066Q15Z9' : 'Surface',\n\t\t'8W9M71DVDPPP' : 'Xbox',\n\t\t'8X1DNF5BG016' : 'Xbox',\n\t\t'8X1T2GPX0LDT' : 'Xbox',\n\t\t'8X376TL9350J' : 'Xbox',\n\t\t'8XCJ702GL1Z5' : 'Xbox',\n\t\t'8Z6M5JLHP61C' : 'Surface',\n\t\t'8ZRJF1W2WJ84' : 'Xbox',\n\t\t'9062VJP24FZ7' : 'Xbox',\n\t\t'90QT3N18ZJ74' : 'Xbox',\n\t\t'918RDHH8N7D8' : 'Surface',\n\t\t'91KPW7PHPT80' : 'Xbox',\n\t\t'91XMC0R70744' : 'Surface',\n\t\t'92KPW695TJVD' : 'Xbox',\n\t\t'92MPR4TC8BVG' : 'Xbox',\n\t\t'92T8XVN8SJ0Z' : 'Surface',\n\n\t\t// new surface 5/2/17\n\t\t'8S06C0T5R0RV' : 'Surface',\n\t\t'8NSQM9J0PCVR' : 'Surface',\n\t\t'8SK96FL578S0' : 'Surface',\n\t\t'90FC23DV6SNZ' : 'Surface',\n\t\t'8P5SV2RX3RN5' : 'Surface',\n\t\t'8MWHBV8QVSKR' : 'Surface',\n\n\t\t// added 5/9/17\n\t\t'8X1SVKCKX5S4' : 'Surface',\n\t\t'92KPHJ3H6X57' : 'Surface',\n\t\t'93Z5M39MNMDP' : 'Surface',\n\t\t'8XCW9BBPVFV9' : 'Surface',\n\n\t\t// added 5/23/17 (new Surface Pro)\n\t\t'8NKT9WTTRBJK' : 'Surface',\n\t\t'920K9Q46V4BZ' : 'Surface',\n\t\t'8ZL5C82QMG6B' : 'Surface',\n\t\t'91FBHVRNWC57' : 'Surface',\n\n\t\t// new xbox design labs, added 6/14/17\n\t\t'900WZDF9XJVG' : 'Xbox',\n\n\t\t// xbox design lab configurations (zero dollar)\n\t\t'90K4SGTLSKML' : 'Xbox',\n\t\t'941H3FP99RM3' : 'Xbox',\n\t\t'9102F5Z9J68L' : 'Xbox',\n\t\t'936X3M90WS2S' : 'Xbox',\n\t\t'90T6CGN08P38' : 'Xbox',\n\t\t'90SX28477R3L' : 'Xbox',\n\t\t'8ST76B99KP7D' : 'Xbox',\n\n\t\t// 8/18/17\n\t\t'8NGXSGCQR2VR' : 'Xbox',\n\t\t'903KM05BHRPF' : 'Xbox',\n\t\t'8ZJH508RNQL0' : 'Xbox',\n\t\t'8MH5XK4S0TV2' : 'Xbox',\n\n\t\t// 10/30/17\n\t\t'8MCPZJJCC98C' : 'Surface',\n\t\t'8X4HTZNFGG38' : 'Surface',\n\n\t\t// MVR added 3/8/18\n\t\t'8MCWCS13TM8B' : 'MRVR',\n\t\t'8MF600XNDWPN' : 'MRVR',\n\t\t'8MRJQSGXBL03' : 'MRVR',\n\t\t'8MT5WS8LGBWL' : 'MRVR',\n\t\t'8MVXT0N7Z7RS' : 'MRVR',\n\t\t'8N4DW97BS3RT' : 'MRVR',\n\t\t'8N5G0J1QF74B' : 'MRVR',\n\t\t'8N5SN73Q2XVG' : 'MRVR',\n\t\t'8NFF6MDNZDK8' : 'MRVR',\n\t\t'8NFWCHTN6KRG' : 'MRVR',\n\t\t'8NGVLHL26HZG' : 'MRVR',\n\t\t'8NQ96HPMRBMZ' : 'MRVR',\n\t\t'8P5RTQ3XRL51' : 'MRVR',\n\t\t'8P89JWDF7FZ2' : 'MRVR',\n\t\t'8PB4TWX13M2N' : 'MRVR',\n\t\t'8PWFJ5TW66PZ' : 'MRVR',\n\t\t'8Q60KWQJRH3D' : 'MRVR',\n\t\t'8Q760GT2XVP3' : 'MRVR',\n\t\t'8Q9ZWF7KRSTM' : 'MRVR',\n\t\t'8R3ZLSSLC93F' : 'MRVR',\n\t\t'8R47V6HZHGD2' : 'MRVR',\n\t\t'8R4BGM7D8X1W' : 'MRVR',\n\t\t'8RFXB1G4DX3L' : 'MRVR',\n\t\t'8RL9J3X12WL8' : 'MRVR',\n\t\t'8RT2C2GFDM92' : 'MRVR',\n\t\t'8RVDR2ZNJMRN' : 'MRVR',\n\t\t'8RWB5MRPWD3L' : 'MRVR',\n\t\t'8S9F8CZ9023M' : 'MRVR',\n\t\t'8SF3VB3QSRWV' : 'MRVR',\n\t\t'8SJQ8G8FP0J9' : 'MRVR',\n\t\t'8SJTPNQRZ3QJ' : 'MRVR',\n\t\t'8SVSH7ZNQDRS' : 'MRVR',\n\t\t'8T5HR2NS0MPH' : 'MRVR',\n\t\t'8T93MG7NHGKM' : 'MRVR',\n\t\t'8TPQV1LCWDND' : 'MRVR',\n\t\t'8TTSF1Q97HKP' : 'MRVR',\n\t\t'8TWC6WQ1PRMD' : 'MRVR',\n\t\t'8V1K94DLSKJG' : 'MRVR',\n\t\t'8V47TTDWLMB8' : 'MRVR',\n\t\t'8V7JRP0LH155' : 'MRVR',\n\t\t'8VBXJQN7QJ5G' : 'MRVR',\n\t\t'8VNT230LJXN3' : 'MRVR',\n\t\t'8VWPSNLWG94S' : 'MRVR',\n\t\t'8W8WHRMTBJL5' : 'MRVR',\n\t\t'8W91R774PDKK' : 'MRVR',\n\t\t'8WH8BBC8W5HG' : 'MRVR',\n\t\t'8WMS2XXWM80V' : 'MRVR',\n\t\t'8WP8D1KD1W47' : 'MRVR',\n\t\t'8WSPQPZZ1P5S' : 'MRVR',\n\t\t'8WZ5CWH91S0Q' : 'MRVR',\n\t\t'8XB9BQFM7LWN' : 'MRVR',\n\t\t'8XF18PQZ17TS' : 'MRVR',\n\t\t'8XZ64V5K2PWZ' : 'MRVR',\n\t\t'8XZD40V8M577' : 'MRVR',\n\t\t'8Z11F3MJN14F' : 'MRVR',\n\t\t'8Z883GH56Z4T' : 'MRVR',\n\t\t'8ZJ08W7F1MWG' : 'MRVR',\n\t\t'8ZK014ZWG895' : 'MRVR',\n\t\t'8ZMK1HPGF0J4' : 'MRVR',\n\t\t'9041XVVH1VXS' : 'MRVR',\n\t\t'908JH5NMTPRF' : 'MRVR',\n\t\t'90C3CLXGMGKQ' : 'MRVR',\n\t\t'90MDTZVL02K9' : 'MRVR',\n\t\t'918KGQN9T9XN' : 'MRVR',\n\t\t'91G0VKX90GBS' : 'MRVR',\n\t\t'91P0VC387FV4' : 'MRVR',\n\t\t'91THZQTVGSPF' : 'MRVR',\n\t\t'92511GRKS9D6' : 'MRVR',\n\t\t'92DCWZTW75GL' : 'MRVR',\n\t\t'92FHWTK1JJ17' : 'MRVR',\n\t\t'937R6K5MS9DS' : 'MRVR',\n\t\t'93NV9C29M3WD' : 'MRVR',\n\t\t'940BDL4WPGB3' : 'MRVR',\n\t\t'941NS3CPPC79' : 'MRVR',\n\t\t'944XGCF64Z5B' : 'MRVR',\n\t\t'947SZK5ZPN46' : 'MRVR',\n\n\t\t'8V9DP4LNKNSZ' : 'Surface',  // surface go added 7/10/18\n\n\t\t'DG7GMGF0DST4' : 'DevVisualStudio', // split out from Software 7/24/18\n\t\t'DG7GMGF0DST5' : 'DevVisualStudio', // split out from Software 7/24/18\n\n\t\t'8XQJKK3DD91B' : 'Surface', //Surface Laptop 2\n\t\t'8SBJXM0M58T4' : 'Surface', //Surface Studio 2\n\t\t'8XJQ3D3LRP0R' : 'Surface', //Surface Pro 6 for Business\n\t\t'8XLK0G60TLB6' : 'Surface', //Surface Laptop 2 for Business\n\t\t'8ZG5FH1FMDSR' : 'Surface', //Surface Studio 2 for Business\n\t\t'8ZCNC665SLQ5' : 'Surface', //Surface Pro 6 \n\n\t\t'CFQ7TTC0K7C8' : 'OfficeNonSub', // added 10/10/18\n\n\t\t// added 11/9/18\n\t\t'8VVRSLLG7Z3S' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K7C2' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K7C4' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K7C5' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K7C6' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K7C7' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K7CQ' : 'OfficeNonSub',\n\t\t'CFQ7TTC0K7DX' : 'OfficeNonSub',\n\n\t\t// leave this as last\n\t\t'SHOULDNEVERMATCH' : 'PC'\n\t};\n\n\tvar skulist = {\n\t\t'CFQ7TTC0K5DM-007P' : 'Office1M',\n\t\t'CFQ7TTC0K5BF-007Q' : 'Office1M',\n\t\t'CFQ7TTC0K5DM-007R' : 'Office1Y',\n\t\t'CFQ7TTC0K5BF-007R' : 'Office1Y',\n\t\t'CFQ7TTC0K5BF-00HK' : 'Office1Y', // prepaid\n\t\t'CFQ7TTC0K5BC-0004' : 'Office1Y',  // JP, added 5/23/17\n\t\t'CFQ7TTC0K5BC-0005' : 'Office1M', // JP, added 5/23/17\n\t\t'CFQ7TTC0K5ZM-7SR4' : 'XboxLive1M', // Xbox live 1 mo added 7/27/17\n\t\t'CFQ7TTC0K5ZM-0002' : 'XboxLive3M', // Xbox live 3 mo added 7/27/17\n\t\t'CFQ7TTC0K5ZM-0003' : 'XboxLive3M', // Xbox live 6 mo (mapped to 3 mo) added 7/27/17\n\t\t'CFQ7TTC0K5ZM-0004' : 'XboxLive12M', // Xbox live added 7/27/17\n\t\t'CFQ7TTC0K5DM-007V' : 'Office1Y',  // office 365 home in LATAM, corrected to Office1Y on 7/24/18\n\t\t'CFQ7TTC0K5DM-007W' : 'Office1Y',  // office 365 home in LATAM, added 9/18/17\n\t\t'CFQ7TTC0K5BF-007S' : 'Office1M',  // office 365 personal in LATAM, added 9/18/17\n\t\t'CFQ7TTC0K5BF-007V' : 'Office1Y',  // office 365 personal in LATAM, added 9/18/17\n\t\t'8T8RC5VV1GVG-0007' : 'Office1Y',  // added 7/24/18\n\n\n\t\t// added 11/9/18\n\t\t'8PC5BJBHN74P-8TGQ' : 'Office1Y',\n\t\t'8PC5BJBHN74P-M59H' : 'Office1Y',\n\t\t'8QT9Q4C6QQPS-H4WH' : 'Office1Y',\n\t\t'900RPBX20TS6-BXL1' : 'Office1Y',\n\t\t'94CM694VJ57P-FHNJ' : 'Office1Y',\n\n\t\t// added 12/3/18\n\t\t'900RPBX20TS6-4460' : 'Office1Y',\n\n\t\t// added 12/6/18\n\t\t'8T8RC5VV1GVG_B01P' : 'Office1Y',\n\t\t'8V883X3J1V40_2R7L' : 'Office1Y',\n\t\t'8V883X3J1V40_LSVH' : 'Office1Y',\n\t\t'8V883X3J1V40_98PG' : 'Office1Y',\n\t\t'CFQ7TTC0K5BD_0002' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_B2HB' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_L0SG' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_BWPG' : 'Office1Y',\n\t\t'8V883X3J1V40_9G9N' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_00VS' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_6921' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_7B2X' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_9KZ7' : 'Office1Y',\n\t\t'8T8RC5VV1GVG_GGHK' : 'Office1Y',\n\t\t'8V883X3J1V40_0002' : 'Office1Y',\n\t\t'8V883X3J1V40_0007' : 'Office1Y',\n\t\t'8V883X3J1V40_24HX' : 'Office1Y',\n\t\t'8V883X3J1V40_5P7L' : 'Office1Y',\n\t\t'8V883X3J1V40_9JL9' : 'Office1Y',\n\t\t'8V883X3J1V40_CMZS' : 'Office1Y',\n\t\t'8V883X3J1V40_FT4B' : 'Office1Y',\n\t\t'900RPBX20TS6_4460' : 'Office1Y',\n\n\t\t'NEVERMATCHZZ-ZZZZ' : 'PC' // added for convenience 9/18/17, keep as last line\n\t};\n\n\tvar cid=\"\"; // map based on geo and campaign\n\tvar irchannel=\"\";  // map based on geo\n\tvar anonarr = [];\n\tvar anonID = \"\";\n\tvar mapCat = function(pid,pidsku,pname,ptype) {\n\t\tif (pidexclude[pid]) {\n\t\t\tconsole.log(\"excluded \"+_TMDL.pids[i]);\n\t\t\treturn \"\";\n\t\t} else if (skulist[pidsku]) {\n\t\t\treturn skulist[pidsku];\n\t\t} else if (pidlist[pid]) {\n\t\t\treturn pidlist[pid];\n\t\t} else if (pname && ~pname.toLowerCase().indexOf(\"surface\") ) {\n\t\t\treturn \"Surface\";\n\t\t} else if (pname && ~pname.toLowerCase().indexOf(\"xbox\") ) {\n\t\t\treturn \"Xbox\";\n\t\t} else if (~ptype.toLowerCase().indexOf(\"app\") || ~ptype.toLowerCase().indexOf(\"game\") || ~ptype.toLowerCase().indexOf(\"durable\") || ~ptype.toLowerCase().indexOf(\"consumable\")) {\n\t\t\treturn \"App\";\n\t\t} else if (~ptype.toLowerCase().indexOf(\"book\")) {\n\t\t\treturn \"eBook\";\n\t\t} else if (~ptype.toLowerCase().indexOf(\"tv\")) {\n\t\t\treturn \"TV\";\n\t\t} else if (~ptype.toLowerCase().indexOf(\"movie\")) {\n\t\t\treturn \"Movie\";\n\t\t} else {\n\t\t\treturn \"PC\";\n\t\t}\n\t};\n\tvar lineItemStr=\"\";\n\tvar li=0; // line item number\n\tvar cat=\"\";\n\tvar totlines=0;\n\tvar u=\"\";\n\tvar ptype=\"\";\n\tvar hupurl=\"\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tirchannel = marketMap[(_TMDL.geo).toUpperCase()][1];\n\t\t\tcid = marketMap[(_TMDL.geo).toUpperCase()][2];\n\t\t}\n\t} catch(err) {}\n\n\tif (cid==\"\") {\n\t\t// map to MEA as catchall\n\t\t// 'BH' : ['d.impactradius-event.com/A1143144-62f4-44be-93a3-7c960374e2961.js' , '13816' , '7796'],\n\t\tirchannel = '13816';\n\t\tcid = '7796';\n\t}\n\n\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\t//\"&amt1=Item Sub Total&cat1=Item Category&sku1=Item SKU&qty1=Item Quantity&name1=Item Name\";\n\t\tli = i+1;\n\t\tptype=\"\";\n\t\ttry {\n\t\t\tif ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\")) {\n\t\t\t\tptype = _TMDL.prdType[i];\n\t\t\t}\n\t\t} catch(ptypeerr) {}\n\t\tcat = mapCat(_TMDL.pids[i],_TMDL.pidsku[i],_TMDL.pnames[i],ptype); // added ptype 12/3/18\n\t\tif (cat) {  // only emit if category matches (e.g. if not filtered)\n\t\t\ttotlines++;\n\t\t\tlineItemStr += ( \"&amt\"+li+\"=\"+_TMDL.sales[i]\n\t\t\t\t\t\t\t+\"&cat\"+li+\"=\"+cat\n\t\t\t\t\t\t\t+\"&sku\"+li+\"=\"+_TMDL.pidsku[i].replace(\"-\",\"_\")\n\t\t\t\t\t\t\t+\"&qty\"+li+\"=\"+_TMDL.quantities[i]\n\t\t\t\t\t\t\t+\"&name\"+li+\"=\"+encodeURIComponent(_TMDL.pnames[i])\n\t\t\t\t\t\t);\n\t\t}\n\t}\n\n\tu=\"https://microsoft.msafflnk.net/conv/?\"\n\t\t+\"irchannel=\"+irchannel\n\t\t+\"&cid=\"+cid\n\t\t+\"&oid=\"+_TMDL.purchaseID\n\t\t//+\"&custid=\"+anonID\n\t\t+\"&status=\"\n\t\t+\"&note=\"+_TMDL.geo\n\t\t+\"&custctry=\"+_TMDL.geo\n\t\t//+\"&custemail=\"\n\t\t+\"&currency=\"+_TMDL.cc\n\t\t//+\"&promocode=\"\n\t\t+lineItemStr;\n\n\tvar hupurl=\"\";\n\n\thupurl=\"https://microsoft.msafflnk.net/conv/?\"\n\t\t+\"irchannel=13588\"\n\t\t+\"&cid=9340\"\n\t\t+\"&oid=\"+_TMDL.purchaseID\n\t\t+\"&status=\"\n\t\t+\"&note=\"+_TMDL.geo\n\t\t+\"&custctry=\"+_TMDL.geo\n\t\t+\"&currency=\"+_TMDL.cc\n\t\t+lineItemStr;\n\n\tif (cid && _TMDL.geo.toUpperCase() !==\"RU\" && _TMDL.geo.toUpperCase() !==\"HK\" && lineItemStr) {\n\t\tdbugimgurl = u; \n\t\tBootstrapper.imageRequest(u);\n\t\tdbugimgurl = hupurl; \n\t\tBootstrapper.imageRequest(hupurl);\n\t\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"IRconversion_\"+_TMDL.geo+\"_\"+cid,\"\",\"\");}\n\t}\t\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"IRCV\",err.message,dbugimgurl);}\n\t_satellite.logger.error(\"IRCV\");\t\n}",
language:"javascript"}}]},{id:"RL60e8675a50d44653a6d76bbe604c1caa",name:"IRLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try\n{\n\tvar marketMap = {\n\t\t'NZ' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'AU' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'CA' : 'A1143100-98df-45ee-8c6e-2dec4e6eb56e1',\n\t\t'BG' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'RU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1', //added for CEE\n\t\t'HR' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'CY' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'HU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'SK' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'EE' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'CZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'GR' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'LT' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'PL' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',\n\t\t'FR' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'TW' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'HK' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'CN' : 'A1143121-28a1-47b0-8a2c-8128049efd901',\n\t\t'DE' : 'A1143124-6b0f-4685-b9ab-e289200ad2901',\n\t\t'IN' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'JP' : 'A1143130-b81e-4371-9b61-b590cea59c051',\n\t\t'BO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'DO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'GT' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'HN' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PA' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'SV' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'VE' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'EC' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'PE' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CL' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'AR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'MX' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',  // was MEX\n\t\t'BR' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BS' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BB' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'CO' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'JM' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'NI' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'TT' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'UY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'BH' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'MA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'OM' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'QA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'NG' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'KW' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'EG' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'SA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'IL' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'ZA' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'TR' : 'A1143144-62f4-44be-93a3-7c960374e2961',\n\t\t'AE' : 'A1143144-62f4-44be-93a3-7c960374e2961', // was UAE\n\t\t'PH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'TH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'ID' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'MY' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'KR' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'SG' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'GB' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t'UK' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t'PR' : 'A1133099-331c-4cdf-89b0-06dc20e168021', // map to US\n\t\t'US' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'LU' : 'A1143167-163d-430c-aa98-4062268d1ce01', // was LUX\n\t\t'BE' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'IE' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21', // map to GB/UK\n\t\t'AT' : 'A1143124-6b0f-4685-b9ab-e289200ad2901', // map to DE\n\t\t'NL' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'FI' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'DK' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'NO' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'SE' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'PT' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'IT' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'ES' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'CH' : 'A1143124-6b0f-4685-b9ab-e289200ad2901',  // map to DE\n\t\t// FR\n\t\t'RE' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'NC' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t'AD' : 'A1143111-30b6-46be-bbab-c7bbbca8eb991',\n\t\t// APAC TH\n\t\t'VN' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'PF' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'KH' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t'LA' : 'A1143145-4ed3-453a-8ac9-f0c166db12591',\n\t\t//'GA' : 'A1143145-4ed3-453a-8ac9-f0c166db12591', removed to map to MEA\n\n\t\t// FI\n\t\t'IS' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t'GL' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t// IN\n\t\t'PK' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'LK' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'BD' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'NP' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t'MM' : 'A1143126-787b-4983-ad6f-e804972459e91',\n\t\t// LATAM\n\t\t'GP' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t'KY' : 'A1143137-8dcf-487d-a337-c1a596ea8a4a1',\n\t\t// NL\n\t\t'AW' : 'A1143167-163d-430c-aa98-4062268d1ce01',\n\t\t// US\n\t\t'GU' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'BM' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t'VI' : 'A1133099-331c-4cdf-89b0-06dc20e168021',\n\t\t// UK\n\t\t'JE' : 'A1143151-5b4f-4392-9e5d-0d32d4dda7b21',\n\t\t// CEE\n\t\t'RO' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'UA' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'SI' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MT' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'LV' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MU' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'KZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'RS' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'BY' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'BA' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'GE' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AL' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AM' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MK' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'MD' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'AZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1',  // added to CEE\n\t\t'UZ' : 'A1143104-6945-4f9c-a60f-7dc20a59755d1'  // added to CEE\n\t\t// Everything else map to MEA\n\t};\n\n\tvar mapstring=\"\";\n\tvar u=\"\";\n\n\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){mapstring = marketMap[(_TMDL.geo).toUpperCase()];}\n\t\n\tif (mapstring==\"\") {\n\t\t// map to MEA as catchall\n\t\tmapstring = 'A1143144-62f4-44be-93a3-7c960374e2961';\n\t}\n\n\tu = \"https://d.impactradius-event.com/\"+mapstring+\".js\";\n\n\t(function (a, b, c, d, e, f, g) {\n\t\te['ire_o'] = c;\n\t\te[c] = e[c] || function () {\n\t\t\t(e[c].a = e[c].a || []).push(arguments);\n\t\t};\n\t\tf = d.createElement(b);\n\t\tg = d.getElementsByTagName(b)[0];\n\t\tf.async = 1;\n\t\tf.src = a;\n\t\tif (a) {\n\t\t\tg.parentNode.insertBefore(f, g);\n\t\t}\n\t})(u, 'script', 'ire', document, window);\n\n\tire('identify', {customerId: '', customerEmail: ''});\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"IRLP\",err.message,u);}\n\t_satellite.logger.error(\"IRLP\");\t\n}",language:"javascript"}}]},{id:"RLd8f2cc1b3c7942cd8016c9c927841162",name:"LINKEDIN",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nLinkedIn tag\n*/\ntry\n{\n\tvar c=new Image(0,0);\n\tc.src="https://dc.ads.linkedin.com/collect/?pid=7850&fmt=gif";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("LINKEDIN",err.message,c.src);}\n\t_satellite.logger.error("LINKEDIN");\t\n}\n',language:"javascript"}}]},{id:"RL254c089354a74298ae2263043a49482b",name:"OffAdobeCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* Office Adobe DCO CV\n*/\n\ntry\n{\n\tvar inScope=0;\n\tvar ps;\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u="";\n\tvar totunits = 0;\n\t//var lang = (_TMDL.ll.indexOf("-")>-1) ? _TMDL.ll.split("-")[0].toLowerCase() : "";\n\t//var utstring = "&ut1="+_TMDL.pidsku.join("%2C")+"&ut2="+lang+"&ut3="+_TMDL.geo.toLowerCase()+"&cachebuster="+rand;\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} \n\t}\n\n\tif (~_TMDL.pageType.indexOf("receipt") && _TMDL.isprod && inScope) {\n\t\t// purchase\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50106&ActionName=Microsoft_Store_Office_Conversion_Pixel"\n\t\t\t//+"&Revenue="+_TMDL.totamount  // updated by request from Carat (Robert Jordan) on 11/8/18\n\t\t\t+"&Revenue="+totunits\n\t\t\t+"&TransactionID="+_TMDL.purchaseID\n\t\t\t+"&Currency="+_TMDL.cc\n\t\t\t+"&cachebuster="+rand;\n\t\tBootstrapper.imageRequest(u); \n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffAdobeCV",err.message,u);}\n\t_satellite.logger.error("OffAdobeCV");\t\n}\n',language:"javascript"}}]},{id:"RL76a8462d758d4a46b290f35986c7b088",name:"OffAmobeeCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nOffice Amobee Turn CV\n*/\ntry\n{\n\tvar ps;\n\tvar inScope=0;\n\n\tvar u1="https://d.turn.com/r/dd/id/L21rdC84ODQvY2lkLzE3NDc0Nzk4MzYvdC8y/kv/"\n\t\t+"qty="+_TMDL.totqty\n\t\t+",langlocale="+_TMDL.ll\n\t\t+",currency="+_TMDL.cc\n\t\t+",liqty="+_TMDL.quantities.join("_")\n\t\t+",lirev="+_TMDL.sales.join("_")\n\t\t+",orderid="+_TMDL.purchaseID\n\t\t+",product="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+",conversio=ConsPurchase,market="+_TMDL.ll\n\t\t+",typg=congrats,offerid="+_TMDL.pidsku.join("_");\n\tdbugimgurl = u1;\n\tvar u2="https://r.turn.com/r/beacon?b2=BR7c3AESZXq9Insb7vIh5jSMguWT7u7Yff10h-EMyivou6cxrU_k3avmwgRgF-V1ngmFZWpmYYcTkFV2hicvfQ&cid="+_TMDL.cc+"&bprice="+_TMDL.totamount;\n\t\t\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t} \n\t}\n\n\tif (~_TMDL.pageType.indexOf("receipt") && _TMDL.isprod) {\n\t\tBootstrapper.imageRequest(u1); \n\t\tif (inScope==1) {dbugimgurl = u2;Bootstrapper.imageRequest(u2);}\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffAmoBeeCV",err.message,dbugimgurl);}\n\t_satellite.logger.error("OffAmoBeeCV");\t\n}\n',language:"javascript"}}]},{id:"RLff024ff211024496b1ca0dd8147087b9",name:"OffDCMCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* Office DCM CV\n*/\ntry\n{\n\tvar a, imgsrc1, ps;\n\tvar inScope=0;\n\n\tvar mc1 = "";\n\tif (_TMutils.readCookie("MC1")) {\n\t\tmc1 = _TMutils.readCookie("MC1").split("&")[0].split("=")[1]; //use in u58\n\t}\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t} \n\t}\n\n\tif ((_TMDL.pageType=="receipt" || _TMDL.pageType=="congrats") && _TMDL.isprod && inScope==1) {\n\t\ta = "" + (Math.random() * 10000000000000);\n\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity/src=6952136;type=store00;cat=zzzst0;qty=1;cost="+_TMDL.totamount+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t+";u25="+_TMDL.pids.join("_")\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+";u58="+mc1\n\t\t\t+";u31="+_TMDL.cc+";u32="+_TMDL.pids.join("_")+";u33="+_TMDL.pidsku.join("_")+";u34="+_TMDL.purchaseID+";u35="+_TMDL.totqty\n\t\t\t+";u39="+_TMDL.sales.join("_")+";u40="+_TMDL.quantities.join("_")\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+_TMDL.purchaseID+"?";\n\t\t//console.log(imgsrc1);\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\t// added 6/18/2018\n\t\tBootstrapper.imageRequest("//www.googleadservices.com/pagead/conversion/862646735/?value=1.00&currency_code=USD&label=KXsqCL2B2nEQz-OrmwM&uid=ON&script=0");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffDCMCV",err.message,imgsrc1);}\n\t_satellite.logger.error("OffDCMCV");\t\n}\n\n\n',language:"javascript"}}]},{id:"RL68ed140e62e94d2db9455a01d87bffcf",name:"OffTryCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nOfficeTrialCompletionPixels\n*/\ntry\n{\n\tvar inScope=0;\n\n\tvar MSFPC="";  \n\n\tvar skulist = {\n\t\t"cfq7ttc0k5bc-0003" : 1,\n\t\t"cfq7ttc0k5dm-007n" : 1,\n\t\t"cfq7ttc0k5dm-007q" : 1,\n\t\t"cfq7ttc0k5dm-007s" : 1,\n\t\t"cfq7ttc0k5dm-00hq" : 1,\n\t\t"cfq7ttc0k5dm-00hr" : 1\n\t};\n\n\tfor (var j = 0; j < _TMDL.pidsku.length; j++) {\n\t\tif (skulist[_TMDL.pidsku[j].toLowerCase()]==1) {\n\t\t\tinScope=1;\n\t\t}\n\t}\n\n\tif (inScope) {\n\t\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=tsu_uni;u17=OfficeConsumerTrial;u59=" + MSFPC + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=" + Math.random());\n\t\t//MediaMath\n\t\tBootstrapper.imageRequest("https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372&product_name=Office365HomeTrial&s26=Office365HomeTrial&v1=OfficeConsTrial");\n\t\t//Quantcast\n\t\tBootstrapper.imageRequest("https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.event.OfficeConsTrial,_fp.productname.Office365HomeTrial");\n\t\t//Bidtellect\n\t\tBootstrapper.imageRequest("https://bttrack.com/pixel/uconversion/2682");\n\t\t//Facebook\n\t\tBootstrapper.imageRequest("https://www.facebook.com/tr?id=535974873423448&ev=Lead&noscript=1");\n\t\t//Amobee\n\t\tBootstrapper.imageRequest("https://d.turn.com/r/dd/id/L21rdC84ODQvY2lkLzE3NDc0Nzk4MzYvdC8y/kv/orderid=[ORDER_ID],product=Office365HomeTrial,conversio=OfficeConsTrial,offerid=cfq7ttc0k5dm-007n");\n\t\tBootstrapper.imageRequest("https://r.turn.com/r/beacon?b2=UQ33J2E3GCSx7-KKGp5vpXBNpsaOMjkmcU2_M7zYy7_ou6cxrU_k3avmwgRgF-V19uqO5Y8wqz4CcEqYo96czw&cid=&bprice=");\n\t\t//MediaIQ\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=930630&seg=10824846&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DOfficeConsTrial%26pixel_id%3D930630%26uid%3D%24UID&t=2");\n\t\t//AMO\n\t\tBootstrapper.imageRequest("https://pixel.everesttech.net/px2/4249?px_evt=t&ev_officetrial=1");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffTryCV",err.message,err.stack);}\n\t_satellite.logger.error("OffTryCV");\t\n}',language:"javascript"}}]},{id:"RL965a35d2340a45cf8a1e1371d7deecb6",name:"PROMISECHAIN",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-100}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"sessionStorage.setItem('com.adobe.reactor.queue', false); ",language:"javascript"}}]},{id:"RL0753dd9e8d55496fbf22fe55e95dc7ca",name:"QuantcastLPandCT",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.pathname.toLowerCase().indexOf("pn=cart")||"www.microsoft.com"==window.location.host.toLowerCase()&&~window.location.pathname.toLowerCase().indexOf("/en-us/")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*  Quantcast\n*/\ntry\n{\n\tvar type = _TMDL.pageType;\n\tvar pt = _TMDL.pageType.toLowerCase();\n\tif (~pt.indexOf("home")|| ~window.location.pathname.indexOf("/home")) {\n\t\ttype = "home";\n\t} else if (~pt.indexOf("category") ) {\n\t\ttype = "category";\n\t} else if (~pt.indexOf("detail") || ~pt.indexOf("pdp")) {\n\t\ttype = "pdp";\n\t} else if (~pt.indexOf("collection")) {\n\t\ttype = "collection";\n\t} else if (~pt.indexOf("cart")) {\n\t\ttype = "cart";\n\t} else if (~pt.indexOf("congrats") || ~pt.indexOf("thankyou") || ~pt.indexOf("receipt")) {\n\t\ttype = "receipt";\n\t} else if (~pt.indexOf("list") || ~pt.indexOf("collection")) {\n\t\ttype = "list";\n\t} \n\n\tvar url = "https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.channel."+_TMDL.geo+",_fp.event."+type+",_fp.subchannel."+_TMDL.totqty+",_fp.customer."+_TMDL.ll+",_fp.pcat."+_TMDL.pidsku.join(",")+"&orderid="+_TMDL.purchaseID+"&revenue="+_TMDL.totamount;\n\tBootstrapper.imageRequest(url);\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("Quantcast",err.message,url);}\n\t_satellite.logger.error("Quantcast");\t\n}\n',language:"javascript"}}]},{id:"RLe2e52ddc2f2b453f97df5f594cfe3676",name:"XTAAMCVFSignals",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// AAM Image Pixel for Cart Flow\ntry\n{\n\tvar pn = _TMDL.pageName,extraSignals = "",imgurl="",_ts;\n\n\tif (pn == "receipt" || pn=="congrats") {\n\t\textraSignals = \t"&c_purchasepid="+encodeURIComponent(_TMDL.pids.join("|"))\n\t\t\t\t\t\t+"&c_purchasepidsku="+encodeURIComponent(_TMDL.pidsku.join("|"))\n\t\t\t\t\t\t+"&c_purchasepnames="+encodeURIComponent(_TMDL.pnames.join("|"))\n\t\t\t\t\t\t\n\t} else if (~pn.indexOf("interstitial") || ~pn.indexOf("cart")) {\n\t\textraSignals = \t"&c_cartpid="+encodeURIComponent(_TMDL.pids.join("|"))\n\t\t\t\t\t+"&c_cartpidsku="+encodeURIComponent(_TMDL.pidsku.join("|"))\n\t\t\t\t\t+"&c_cartpnames="+encodeURIComponent(_TMDL.pnames.join("|"));\n\t} \n\n\tif (extraSignals) {\n\t\t_ts= (new Date).getTime();\n\t\timgurl = "https://mscom.demdex.net/event?d_nsid=0&d_ld=_ts%3D"+_ts+"&d_rtbd=json&d_jsonv=1&d_dst=1"\n\t\t//+"&d_cb=demdexRequestCallback_0_1521748306026"\n\t\t+"&c_ms.siteorg=Retail&c_ms.sitename=Store"\n\t\t+"&c_ms.pagetype="+_TMDL.pageType\n\t\t+"&c_ms.sup_ln="+_TMDL.ll\n\t\t+extraSignals;\n\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("XTAAMCVG",err.message,imgurl);}\n\t_satellite.logger.error("XTAAMCVG");\t\n}',language:"javascript"}}]},{id:"RL35c9d842b8c242dd85f3bd50ba4395b4",name:"OFF_AMO_ADNXS_CV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* OFF_AMO_ADNXS_CV */\n\n\nvar isTrial=0;\nvar inScope=0;\nvar trialskus = {\n\t"cfq7ttc0k5bc-0003" : 1,\n\t"cfq7ttc0k5dm-007n" : 1,\n\t"cfq7ttc0k5dm-007q" : 1,\n\t"cfq7ttc0k5dm-007s" : 1,\n\t"cfq7ttc0k5dm-00hq" : 1,\n\t"cfq7ttc0k5dm-00hr" : 1\n};\n\nfor (var j = 0; j < _TMDL.pidsku.length; j++) {\n\tif (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf("office") || ~_TMDL.pnames[i].toLowerCase().indexOf("o365"))  && trialskus[_TMDL.pidsku[j].toLowerCase()]!==1) {\n\t\tinScope=1;\n\t}\n}\n\nvar amourl;\n\nif (inScope) {\n\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1089341&t=2");\n\t\n\tamourl = "https://pixel.everesttech.net/px2/5584?px_evt=t&ev_ConsPurchase=1"+\n\t\t"&ev_transaction_market_"+_TMDL.geo+"=1"+\n\t\t"&ev_items="+_TMDL.totqty+\n\t\t"&ev_currency_"+_TMDL.cc+"=1"+\n\t\t"&ev_revenue="+_TMDL.totamount+\n\t\t"&ev_transid="+_TMDL.purchaseID;\n\tBootstrapper.imageRequest(amourl);\n}\n\n\n',language:"javascript"}}]}]};var _satellite=function(){"use strict";function t(t,e){return t(e={exports:{}},e.exports),e.exports}function s(t){if(null===t||t===undefined)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function e(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(a){return!1}}function g(t,e){return Object.prototype.hasOwnProperty.call(t,e)}if(window.atob){var n={LOG:"log",INFO:"info",WARN:"warn",ERROR:"error"},o="\ud83d\ude80",a=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":o,r=!1,i=function(t){if(r&&window.console){var e=Array.prototype.slice.call(arguments,1);e.unshift(a),window.console[t].apply(window.console,e)}},c=i.bind(null,n.LOG),d=i.bind(null,n.INFO),u=i.bind(null,n.WARN),l=i.bind(null,n.ERROR),M={log:c,info:d,warn:u,error:l,get outputEnabled(){return r},set outputEnabled(t){r=t},createPrefixedLogger:function(t){var e="["+t+"]";return{log:c.bind(null,e),info:d.bind(null,e),warn:u.bind(null,e),error:l.bind(null,e)}}},p=function(a,r,i){var n,o,s,c,d=[],u=function(t,e,n){if(!a(e))return t;d.push(e);var o=r(e,n);return d.pop(),null==o&&i?"":o};return n=function(t,n){var e=/^%([^%]+)%$/.exec(t);return e?u(t,e[1],n):t.replace(/%(.+?)%/g,function(t,e){return u(t,e,n)})},o=function(t,e){for(var n={},o=Object.keys(t),a=0;a<o.length;a++){var r=o[a],i=t[r];n[r]=c(i,e)}return n},s=function(t,e){for(var n=[],o=0,a=t.length;o<a;o++)n.push(c(t[o],e));return n},c=function(t,e){return"string"==typeof t?n(t,e):Array.isArray(t)?s(t,e):"object"==typeof t&&null!==t?o(t,e):t},function(t,e){return 10<d.length?(M.error("Data element circular reference detected: "+d.join(" -> ")),t):c(t,e)}},f=function(a){return function(t,e){if("string"==typeof t)a[arguments[0]]=e;else if(arguments[0]){var n=arguments[0];for(var o in n)a[o]=n[o]}}},m=function(t){return"string"==typeof t?t.replace(/\s+/g," ").trim():t},T="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=t(function(o){!function(t){if("function"==typeof undefined&&undefined.amd&&(undefined(t),!0),o.exports=t(),!!0){var e=window.Cookies,n=window.Cookies=t();n.noConflict=function(){return window.Cookies=e,n}}}(function(){function T(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}function t(m){function g(t,e,n){var o;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(n=T({path:"/"},g.defaults,n)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*n.expires),n.expires=a}n.expires=n.expires?n.expires.toUTCString():"";try{o=JSON.stringify(e),/^[\{\[]/.test(o)&&(e=o)}catch(f){}e=m.write?m.write(e,t):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var r="";for(var i in n)n[i]&&(r+="; "+i,!0!==n[i]&&(r+="="+n[i]));return document.cookie=t+"="+e+r}t||(o={});for(var s=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,d=0;d<s.length;d++){var u=s[d].split("="),l=u.slice(1).join("=");'"'===l.charAt(0)&&(l=l.slice(1,-1));try{var p=u[0].replace(c,decodeURIComponent);if(l=m.read?m.read(l,p):m(l,p)||l.replace(c,decodeURIComponent),this.json)try{l=JSON.parse(l)}catch(f){}if(t===p){o=l;break}t||(o[p]=l)}catch(f){}}return o}}return(g.set=g).get=function(t){return g.call(g,t)},g.getJSON=function(){return g.apply({json:!0},[].slice.call(arguments))},g.defaults={},g.remove=function(t,e){g(t,"",T(e,{expires:-1}))},g.withConverter=t,g}return t(function(){})})}),h={get:_.get,set:_.set,remove:_.remove},C=window,b="com.adobe.reactor.",v=function(o,t){var a=b+(t||"");return{getItem:function(t){try{return C[o].getItem(a+t)}catch(e){return null}},setItem:function(t,e){try{return C[o].setItem(a+t,e),!0}catch(n){return!1}}}},D="_sdsat_",y="dataElements.",L="dataElementCookiesMigrated",x=v("localStorage"),w=v("sessionStorage",y),R=v("localStorage",y),S={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},A={},F=function(t){var e;try{e=JSON.stringify(t)}catch(n){}return e},P=function(t,e,n){var o;switch(e){case S.PAGEVIEW:return void(A[t]=n);case S.SESSION:return void((o=F(n))&&w.setItem(t,o));case S.VISITOR:return void((o=F(n))&&R.setItem(t,o))}},B=function(t,e){var n=h.get(D+t);n!==undefined&&P(t,e,n)},j={setValue:P,getValue:function(t,e){var n;switch(e){case S.PAGEVIEW:return A.hasOwnProperty(t)?A[t]:null;case S.SESSION:return null===(n=w.getItem(t))?n:JSON.parse(n);case S.VISITOR:return null===(n=R.getItem(t))?n:JSON.parse(n)}},migrateCookieData:function(e){x.getItem(L)||(Object.keys(e).forEach(function(t){B(t,e[t].storageDuration)}),x.setItem(L,!0))}},V=function(t,e,n,o){return"Failed to execute data element module "+t.modulePath+" for data element "+e+". "+n+(o?"\n"+o:"")},O=function(t){return t!==undefined&&null!==t},E=function(s,c,d,u){return function(t,e){var n=c(t);if(!n)return u?"":null;var o,a=n.storageDuration;try{o=s.getModuleExports(n.modulePath)}catch(i){return void M.error(V(n,t,i.message,i.stack))}if("function"==typeof o){var r;try{r=o(d(n.settings,e),e)}catch(i){return void M.error(V(n,t,i.message,i.stack))}return a&&(O(r)?j.setValue(t,a,r):r=j.getValue(t,a)),O(r)||(r=n.defaultValue||""),"string"==typeof r&&(n.cleanText&&(r=m(r)),n.forceLowerCase&&(r=r.toLowerCase())),r}M.error(V(n,t,"Module did not export a function."))}},k=function(t,e,n){var o={exports:{}};return t.call(o.exports,o,o.exports,e,n),o.exports},K=function(){var i={},n=function(t){var e=i[t];if(!e)throw new Error("Module "+t+" not found.");return e},t=function(){Object.keys(i).forEach(function(t){try{o(t)}catch(n){var e="Error initializing module "+t+". "+n.message+(n.stack?"\n"+n.stack:"");M.error(e)}})},o=function(t){var e=n(t);return e.hasOwnProperty("exports")||(e.exports=k(e.definition.script,e.require,e.turbine)),e.exports};return{registerModule:function(t,e,n,o,a){var r={definition:e,extensionName:n,require:o,turbine:a};r.require=o,i[t]=r},hydrateCache:t,getModuleExports:o,getModuleDefinition:function(t){return n(t).definition},getModuleExtensionName:function(t){return n(t).extensionName}}},X=function(n,o){return function(t){var e=t.split(".")[0];return Boolean(o(t)||"this"===e||"event"===e||"target"===e||n.hasOwnProperty(e))}},I={text:function(t){return t.textContent},cleanText:function(t){return m(t.textContent)}},N=function(t,e,n){for(var o,a=t,r=0,i=e.length;r<i;r++){if(null==a)return undefined;var s=e[r];if(n&&"@"===s.charAt(0)){var c=s.slice(1);a=I[c](a)}else if(a.getAttribute&&(o=s.match(/^getAttribute\((.+)\)$/))){var d=o[1];a=a.getAttribute(d)}else a=a[s]}return a},G=function(r,i,s){return function(t,e){var n;if(i(t))n=s(t,e);else{var o=t.split("."),a=o.shift();"this"===a?e&&(n=N(e.element,o,!0)):"event"===a?e&&(n=N(e,o)):"target"===a?e&&(n=N(e.target,o)):n=N(r[a],o)}return n}},Q=function(c,d){return function(t,e){var n=c[t];if(n){var o=n.modules;if(o)for(var a=Object.keys(o),r=0;r<a.length;r++){var i=a[r],s=o[i];if(s.shared&&s.name===e)return d.getModuleExports(i)}}}},W=function(t,e){return function(){return e?t(e):{}}},U=function(n,o){return function(t){if(o){var e=t.split(".");e.splice(e.length-1||1,0,"min"),t=e.join(".")}return n+t}},H=".js",Z=function(t){return t.substr(0,t.lastIndexOf("/"))},q=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},J=function(t,e){q(e,H)||(e+=H);var n=e.split("/"),o=Z(t).split("/");return n.forEach(function(t){t&&"."!==t&&(".."===t?o.length&&o.pop():o.push(t))}),o.join("/")},Y=document,$=t(function(m){!function(t){function o(){}function a(t,e){return function(){t.apply(e,arguments)}}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],l(t,this)}function i(o,a){for(;3===o._state;)o=o._value;0!==o._state?(o._handled=!0,r._immediateFn(function(){var t=1===o._state?a.onFulfilled:a.onRejected;if(null!==t){var e;try{e=t(o._value)}catch(n){return void c(a.promise,n)}s(a.promise,e)}else(1===o._state?s:c)(a.promise,o._value)})):o._deferreds.push(a)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void d(t);if("function"==typeof n)return void l(a(n,e),t)}t._state=1,t._value=e,d(t)}catch(o){c(t,o)}}function c(t,e){t._state=2,t._value=e,d(t)}function d(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,c(e,t))})}catch(o){if(n)return;n=!0,c(e,o)}}var e=setTimeout;r.prototype["catch"]=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var n=new this.constructor(o);return i(this,new u(t,e,n)),n},r.all=function(t){var c=Array.prototype.slice.call(t);return new r(function(a,r){function i(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void n.call(t,function(t){i(e,t)},r)}c[e]=t,0==--s&&a(c)}catch(o){r(o)}}if(0===c.length)return a([]);for(var s=c.length,t=0;t<c.length;t++)i(t,c[t])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(n){return new r(function(t,e){
e(n)})},r.race=function(a){return new r(function(t,e){for(var n=0,o=a.length;n<o;n++)a[n].then(t,e)})},r._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){e(t,0)},r._unhandledRejectionFn=function n(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function p(t){r._immediateFn=t},r._setUnhandledRejectionFn=function f(t){r._unhandledRejectionFn=t},m.exports?m.exports=r:t.Promise||(t.Promise=r)}(T)}),z=window.Promise||$,tt=function(n,o){return new z(function(e,t){"onload"in o?(o.onload=function(){e(o)},o.onerror=function(){t(new Error("Failed to load script "+n))}):"readyState"in o&&(o.onreadystatechange=function(){var t=o.readyState;"loaded"!==t&&"complete"!==t||(o.onreadystatechange=null,e(o))})})},et=function(t){var e=document.createElement("script");e.src=t,e.async=!0;var n=tt(t,e);return document.getElementsByTagName("head")[0].appendChild(e),n},nt=Object.getOwnPropertySymbols,ot=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable,rt=e()?Object.assign:function(t){for(var e,n,o=s(t),a=1;a<arguments.length;a++){for(var r in e=Object(arguments[a]))ot.call(e,r)&&(o[r]=e[r]);if(nt){n=nt(e);for(var i=0;i<n.length;i++)at.call(e,n[i])&&(o[n[i]]=e[n[i]])}}return o},it=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var r=/\+/g;t=t.split(e);var i=1e3;o&&"number"==typeof o.maxKeys&&(i=o.maxKeys);var s=t.length;0<i&&i<s&&(s=i);for(var c=0;c<s;++c){var d,u,l,p,f=t[c].replace(r,"%20"),m=f.indexOf(n);u=0<=m?(d=f.substr(0,m),f.substr(m+1)):(d=f,""),l=decodeURIComponent(d),p=decodeURIComponent(u),g(a,l)?Array.isArray(a[l])?a[l].push(p):a[l]=[a[l],p]:a[l]=p}return a},st=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},ct=function(n,o,a,t){return o=o||"&",a=a||"=",null===n&&(n=undefined),"object"==typeof n?Object.keys(n).map(function(t){var e=encodeURIComponent(st(t))+a;return Array.isArray(n[t])?n[t].map(function(t){return e+encodeURIComponent(st(t))}).join(o):e+encodeURIComponent(st(n[t]))}).join(o):t?encodeURIComponent(st(t))+a+encodeURIComponent(st(n)):""},dt=t(function(t,e){e.decode=e.parse=it,e.encode=e.stringify=ct}),ut="@adobe/reactor-",lt={cookie:h,document:Y,"load-script":et,"object-assign":rt,promise:z,"query-string":{parse:function(t){return"string"==typeof t&&(t=t.trim().replace(/^[?#&]/,"")),dt.parse(t)},stringify:function(t){return dt.stringify(t)}},window:C},pt=function(o){return function(t){if(0===t.indexOf(ut)){var e=t.substr(ut.length),n=lt[e];if(n)return n}if(0===t.indexOf("./")||0===t.indexOf("../"))return o(t);throw new Error('Cannot resolve module "'+t+'".')}},ft=function(t,i,s,c){var d=t.extensions,u=t.buildInfo,l=t.property.settings;if(d){var p=Q(d,i);Object.keys(d).forEach(function(o){var a=d[o],t=W(s,a.settings);if(a.modules){var e=M.createPrefixedLogger(a.displayName),n=U(a.hostedLibFilesBaseUrl,u.minified),r={buildInfo:u,getDataElementValue:c,getExtensionSettings:t,getHostedLibFileUrl:n,getSharedModule:p,logger:e,propertySettings:l,replaceTokens:s};Object.keys(a.modules).forEach(function(n){var t=a.modules[n],e=pt(function(t){var e=J(n,t);return i.getModuleExports(e)});i.registerModule(n,t,o,e,r)})}}),i.hydrateCache()}return i},mt=function(t,e,n,o,a){var r=M.createPrefixedLogger("Custom Script");t.track=function(t){M.log('"'+t+'" does not match any direct call identifiers.')},t.getVisitorId=function(){return null},t.property={name:e.property.name},t.company=e.company,t.buildInfo=e.buildInfo,t.logger=r,t.notify=function(t,e){switch(M.warn("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),e){case 3:r.info(t);break;case 4:r.warn(t);break;case 5:r.error(t);break;default:r.log(t)}},t.getVar=o,t.setVar=a,t.setCookie=function(t,e,n){var o="",a={};n&&(o=", { expires: "+n+" }",a.expires=n);var r='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+t+'", "'+e+'"'+o+").";M.warn(r),h.set(t,e,a)},t.readCookie=function(t){return M.warn('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+t+'").'),h.get(t)},t.removeCookie=function(t){M.warn('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+t+'").'),h.remove(t)},t.cookie=h,t.pageBottom=function(){},t.setDebug=n;var i=!1;Object.defineProperty(t,"_container",{get:function(){return i||(M.warn("_satellite._container may change at any time and should only be used for debugging."),i=!0),e}})},gt=function(t,e){return rt(e=e||{},t),e.hasOwnProperty("type")||Object.defineProperty(e,"type",{get:function(){return M.warn("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),e.$type}}),e},Tt=function(t){var n=[];return t.forEach(function(e){e.events&&e.events.forEach(function(t){n.push({rule:e,event:t})})}),n.sort(function(t,e){return t.event.ruleOrder-e.event.ruleOrder})},_t=!1,ht=function(o){return function(e,n){var t=o._monitors;t&&(_t||(M.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),_t=!0),t.forEach(function(t){t[e]&&t[e](n)}))}},Ct="Module did not export a function.",bt=function(r,i){return function(t,e,n){n=n||[];var o=r.getModuleExports(t.modulePath);if("function"!=typeof o)throw new Error(Ct);var a=i(t.settings||{},e);return o.bind(null,a).apply(null,n)}},Mt=v("localStorage"),vt=v("sessionStorage"),Dt=function(){return Boolean(Mt.getItem("queue")||vt.getItem("queue"))},yt=2e3,Lt=!1,xt=function(){Lt||(Lt=!0,M.warn("Rule queueing is only intended for testing purposes. Queueing behavior may be changed or removed at any time."))},wt=function(t,e,s,n){var r=z.resolve(),c=ht(t),d=bt(s,n),a=function(t){var e=s.getModuleDefinition(t.modulePath);return e&&e.displayName||t.modulePath},u=function(t,e,n,o){return"Failed to execute "+a(t)+" for "+e.name+" rule. "+n+(o?"\n"+o:"")},i=function(t,e,n){M.error(u(t,e,n.message,n.stack)),c("ruleActionFailed",{rule:e,action:t})},l=function(t,e,n){M.error(u(t,e,n.message,n.stack)),c("ruleConditionFailed",{rule:e,condition:t})},p=function(t,e){var n=a(t);M.log("Condition "+n+" for rule "+e.name+" not met."),c("ruleConditionFailed",{rule:e,condition:t})},f=function(t){M.log('Rule "'+t.name+'" fired.'),c("ruleCompleted",{rule:t})},m=function(t){return t||(t=new Error("The extension triggered an error, but no error information was provided.")),t instanceof Error||(t=new Error(String(t))),t},g=function(t,e){return e&&!t.negate||!e&&t.negate},T=function(e,a){e.conditions&&e.conditions.forEach(function(o){r=r.then(function(){var n;return new z(function(t,e){n=setTimeout(function(){e("A timeout occurred because the condition took longer than "+yt/1e3+" seconds to complete. ")},yt),z.resolve(d(o,a,[a])).then(t,e)})["catch"](function(t){return clearTimeout(n),t=m(t,o),l(o,e,t),z.reject(t)}).then(function(t){if(clearTimeout(n),!g(o,t))return p(o,e),z.reject()})})}),e.actions&&e.actions.forEach(function(o){r=r.then(function(){var n;return new z(function(t,e){n=setTimeout(function(){e("A timeout occurred because the action took longer than "+yt/1e3+" seconds to complete. ")},yt),z.resolve(d(o,a,[a])).then(t,e)}).then(function(){clearTimeout(n)})["catch"](function(t){return clearTimeout(n),t=m(t),i(o,e,t),z.reject(t)})})}),r=(r=r.then(function(){f(e)}))["catch"](function(){})},_=function(t,e){var n;if(t.conditions)for(var o=0;o<t.conditions.length;o++){n=t.conditions[o];try{var a=d(n,e,[e]);if(!g(n,a))return void p(n,t)}catch(r){return void l(n,t,r)}}h(t,e)},h=function(t,e){var n;if(t.actions){for(var o=0;o<t.actions.length;o++){n=t.actions[o];try{d(n,e,[e])}catch(a){return void i(n,t,a)}}f(t)}},C=!1,b=[],o=function(t){var e,n=t.rule,o=t.event;o.settings=o.settings||{};try{e=s.getModuleDefinition(o.modulePath).name;var a={$type:s.getModuleExtensionName(o.modulePath)+"."+e,$rule:{id:n.id,name:n.name}},r=function(t){if(C){c("ruleTriggered",{rule:n});var e=gt(a,t);Dt()?(xt(),T(n,e)):_(n,e)}else b.push(r.bind(null,t))};d(o,null,[r])}catch(i){M.error(u(o,n,i.message,i.stack))}};return Tt(e).forEach(o),C=!0,b.forEach(function(t){t()}),b=null,r},Rt="debug",St=window._satellite;if(St&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var At=St.container;delete St.container;var Ft=At.property.settings.undefinedVarsReturnEmpty,Pt=At.dataElements||{};j.migrateCookieData(Pt);var Bt,jt=function(t){return Pt[t]},Vt=K(),Ot=E(Vt,jt,function(){return Bt.apply(null,arguments)},Ft),Et={},kt=f(Et),Kt=X(Et,jt),Xt=G(Et,jt,Ot);Bt=p(Kt,Xt,Ft);var It=v("localStorage"),Nt=function(){return"true"===It.getItem(Rt)},Gt=function(t){It.setItem(Rt,t),M.outputEnabled=t};M.outputEnabled=Nt(),mt(St,At,Gt,Xt,kt),ft(At,Vt,Bt,Ot),wt(St,At.rules||[],Vt,Bt)}return St}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();